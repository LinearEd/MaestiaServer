PROGRAM  : Maestia.exe
FUNCTION : FUN_007d8480
ENTRY    : 007d8480
BODY     : [[007d8480, 007d866a]]

============================================================
DECOMPILED C CODE
============================================================

undefined4
FUN_007d8480(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
            undefined4 param_5,undefined4 param_6,undefined4 param_7)

{
  int iVar1;
  char cVar2;
  int *unaff_ESI;
  undefined1 *puStack_90;
  undefined1 *puStack_8c;
  undefined1 *puStack_88;
  undefined1 *puStack_84;
  undefined1 auStack_80 [8];
  undefined4 uStack_78;
  undefined4 uStack_74;
  int *piStack_70;
  int *piStack_6c;
  int *piStack_68;
  undefined1 local_50 [36];
  int local_2c [2];
  undefined1 local_24 [4];
  undefined1 local_1c [4];
  int local_18 [2];
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  puStack_c = &LAB_00b28f11;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_8 = 0;
  if (unaff_ESI[2] != 0) {
    piStack_68 = (int *)0x7d84c4;
    EnterCriticalSection((LPCRITICAL_SECTION)(unaff_ESI[2] + 4));
  }
  local_8._0_1_ = 1;
  piStack_68 = local_18;
  piStack_70 = (int *)0x7d84df;
  piStack_6c = unaff_ESI + 0x97;
  FUN_0044f270();
  iVar1 = unaff_ESI[0x99];
  local_8._0_1_ = 0;
  if (unaff_ESI[2] != 0) {
    piStack_68 = (int *)0x7d8501;
    LeaveCriticalSection((LPCRITICAL_SECTION)(unaff_ESI[2] + 4));
  }
  if (local_18[0] == iVar1) {
    FUN_0045f540();
    local_8._0_1_ = 2;
    FUN_0045f540();
    local_8._0_1_ = 3;
    piStack_68 = (int *)param_4;
    piStack_6c = (int *)param_3;
    piStack_70 = (int *)param_2;
    uStack_74 = param_1;
    uStack_78 = 0;
    puStack_88 = auStack_80;
    puStack_84 = local_24;
    puStack_8c = (undefined1 *)0x7d854a;
    FUN_00439f80();
    local_8._0_1_ = 4;
    puStack_90 = (undefined1 *)&puStack_88;
    puStack_8c = local_1c;
    FUN_00439f80();
    local_8._0_1_ = 5;
    FUN_00439f80(&puStack_90,&param_6);
    local_8._0_1_ = 3;
    cVar2 = (**(code **)(*unaff_ESI + 0xd4))();
    if (cVar2 == '\0') {
      local_8._0_1_ = 2;
      FUN_0043a010();
      local_8 = (uint)local_8._1_3_ << 8;
      FUN_0043a010();
      local_8 = 0xffffffff;
      FUN_0043a010();
      ExceptionList = local_10;
      return 0;
    }
    if (unaff_ESI[2] != 0) {
      piStack_68 = (int *)0x7d85dd;
      EnterCriticalSection((LPCRITICAL_SECTION)(unaff_ESI[2] + 4));
    }
    local_8._0_1_ = 7;
    piStack_68 = (int *)local_50;
    piStack_6c = (int *)0x7d85f4;
    piStack_68 = (int *)FUN_00460220();
    local_8._0_1_ = 8;
    piStack_6c = local_2c;
    uStack_74 = 0x7d8607;
    piStack_70 = unaff_ESI + 0x97;
    FUN_004604f0();
    local_8._0_1_ = 7;
    piStack_68 = (int *)0x7d8614;
    FUN_0045fde0();
    local_8._0_1_ = 3;
    if (unaff_ESI[2] != 0) {
      piStack_68 = (int *)0x7d8628;
      LeaveCriticalSection((LPCRITICAL_SECTION)(unaff_ESI[2] + 4));
    }
    *(undefined1 *)(unaff_ESI + 0x90) = 0;
    local_8._0_1_ = 2;
    FUN_0043a010();
    local_8 = (uint)local_8._1_3_ << 8;
    FUN_0043a010();
  }
  local_8 = 0xffffffff;
  FUN_0043a010();
  ExceptionList = local_10;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
007d8480 : PUSH EBP
007d8481 : MOV EBP,ESP
007d8483 : PUSH -0x1
007d8485 : PUSH 0xb28f11
007d848a : MOV EAX,FS:[0x0]
007d8490 : PUSH EAX
007d8491 : SUB ESP,0x44
007d8494 : PUSH EBX
007d8495 : PUSH EDI
007d8496 : MOV EAX,[0x00d66fa0]
007d849b : XOR EAX,EBP
007d849d : PUSH EAX
007d849e : LEA EAX,[EBP + -0xc]
007d84a1 : MOV FS:[0x0],EAX
007d84a7 : MOV dword ptr [EBP + -0x4],0x0
007d84ae : MOV EAX,dword ptr [ESI + 0x8]
007d84b1 : XOR BL,BL
007d84b3 : MOV dword ptr [EBP + -0x1c],ESI
007d84b6 : TEST EAX,EAX
007d84b8 : JZ 0x007d84c4
007d84ba : ADD EAX,0x4
007d84bd : PUSH EAX
007d84be : CALL dword ptr [0x00b85118]
007d84c4 : MOV byte ptr [EBP + -0x4],0x1
007d84c8 : MOV EAX,dword ptr [EBP + 0x20]
007d84cb : ADD EAX,0x4
007d84ce : PUSH EAX
007d84cf : LEA ECX,[EBP + -0x14]
007d84d2 : PUSH ECX
007d84d3 : LEA EDI,[ESI + 0x25c]
007d84d9 : PUSH EDI
007d84da : CALL 0x0044f270
007d84df : MOV EAX,dword ptr [ESI + 0x264]
007d84e5 : CMP dword ptr [EBP + -0x14],EAX
007d84e8 : JNZ 0x007d84ec
007d84ea : MOV BL,0x1
007d84ec : MOV byte ptr [EBP + -0x4],0x0
007d84f0 : MOV EAX,dword ptr [ESI + 0x8]
007d84f3 : TEST EAX,EAX
007d84f5 : JZ 0x007d8501
007d84f7 : ADD EAX,0x4
007d84fa : PUSH EAX
007d84fb : CALL dword ptr [0x00b8511c]
007d8501 : TEST BL,BL
007d8503 : JZ 0x007d8647
007d8509 : LEA ECX,[EBP + -0x18]
007d850c : CALL 0x0045f540
007d8511 : MOV byte ptr [EBP + -0x4],0x2
007d8515 : LEA ECX,[EBP + -0x20]
007d8518 : CALL 0x0045f540
007d851d : MOV BL,0x3
007d851f : MOV byte ptr [EBP + -0x4],BL
007d8522 : MOV EDX,dword ptr [EBP + 0x18]
007d8525 : MOV EAX,dword ptr [EBP + 0x14]
007d8528 : MOV ECX,dword ptr [EBP + 0x10]
007d852b : PUSH EDX
007d852c : MOV EDX,dword ptr [EBP + 0xc]
007d852f : PUSH EAX
007d8530 : MOV EAX,dword ptr [EBP + 0x8]
007d8533 : PUSH ECX
007d8534 : PUSH EDX
007d8535 : PUSH EAX
007d8536 : PUSH 0x0
007d8538 : SUB ESP,0x8
007d853b : MOV ECX,ESP
007d853d : MOV dword ptr [EBP + 0x18],ESP
007d8540 : LEA EDX,[EBP + -0x20]
007d8543 : PUSH EDX
007d8544 : PUSH ECX
007d8545 : CALL 0x00439f80
007d854a : MOV byte ptr [EBP + -0x4],0x4
007d854e : SUB ESP,0x8
007d8551 : MOV EAX,ESP
007d8553 : MOV dword ptr [EBP + 0x14],ESP
007d8556 : LEA ECX,[EBP + -0x18]
007d8559 : PUSH ECX
007d855a : PUSH EAX
007d855b : CALL 0x00439f80
007d8560 : MOV byte ptr [EBP + -0x4],0x5
007d8564 : SUB ESP,0x8
007d8567 : MOV EDX,ESP
007d8569 : MOV dword ptr [EBP + 0x10],ESP
007d856c : LEA EAX,[EBP + 0x1c]
007d856f : PUSH EAX
007d8570 : PUSH EDX
007d8571 : CALL 0x00439f80
007d8576 : MOV byte ptr [EBP + -0x4],0x6
007d857a : MOV EAX,dword ptr [ESI]
007d857c : MOV byte ptr [EBP + -0x4],BL
007d857f : MOV EDX,dword ptr [EAX + 0xd4]
007d8585 : MOV ECX,ESI
007d8587 : CALL EDX
007d8589 : TEST AL,AL
007d858b : JNZ 0x007d85c9
007d858d : MOV byte ptr [EBP + -0x4],0x2
007d8591 : LEA ECX,[EBP + -0x20]
007d8594 : CALL 0x0043a010
007d8599 : MOV byte ptr [EBP + -0x4],0x0
007d859d : LEA ECX,[EBP + -0x18]
007d85a0 : CALL 0x0043a010
007d85a5 : MOV dword ptr [EBP + -0x4],0xffffffff
007d85ac : LEA ECX,[EBP + 0x1c]
007d85af : CALL 0x0043a010
007d85b4 : XOR AL,AL
007d85b6 : MOV ECX,dword ptr [EBP + -0xc]
007d85b9 : MOV dword ptr FS:[0x0],ECX
007d85c0 : POP ECX
007d85c1 : POP EDI
007d85c2 : POP EBX
007d85c3 : MOV ESP,EBP
007d85c5 : POP EBP
007d85c6 : RET 0x1c
007d85c9 : MOV EAX,dword ptr [ESI + 0x8]
007d85cc : MOV dword ptr [EBP + 0x18],ESI
007d85cf : TEST EAX,EAX
007d85d1 : JZ 0x007d85dd
007d85d3 : ADD EAX,0x4
007d85d6 : PUSH EAX
007d85d7 : CALL dword ptr [0x00b85118]
007d85dd : MOV byte ptr [EBP + -0x4],0x7
007d85e1 : MOV ECX,dword ptr [EBP + 0x20]
007d85e4 : LEA EAX,[EBP + 0x1c]
007d85e7 : PUSH EAX
007d85e8 : LEA EDX,[EBP + -0x4c]
007d85eb : ADD ECX,0x4
007d85ee : PUSH EDX
007d85ef : CALL 0x00460220
007d85f4 : MOV byte ptr [EBP + -0x4],0x8
007d85f8 : MOV ECX,dword ptr [EDI + 0x8]
007d85fb : PUSH ECX
007d85fc : PUSH EAX
007d85fd : LEA EAX,[EBP + -0x28]
007d8600 : PUSH EAX
007d8601 : PUSH EDI
007d8602 : CALL 0x004604f0
007d8607 : MOV byte ptr [EBP + -0x4],0x7
007d860b : LEA ECX,[EBP + -0x4c]
007d860e : PUSH ECX
007d860f : CALL 0x0045fde0
007d8614 : MOV byte ptr [EBP + -0x4],BL
007d8617 : MOV EAX,dword ptr [ESI + 0x8]
007d861a : TEST EAX,EAX
007d861c : JZ 0x007d8628
007d861e : ADD EAX,0x4
007d8621 : PUSH EAX
007d8622 : CALL dword ptr [0x00b8511c]
007d8628 : MOV byte ptr [ESI + 0x240],0x0
007d862f : MOV byte ptr [EBP + -0x4],0x2
007d8633 : LEA ECX,[EBP + -0x20]
007d8636 : CALL 0x0043a010
007d863b : MOV byte ptr [EBP + -0x4],0x0
007d863f : LEA ECX,[EBP + -0x18]
007d8642 : CALL 0x0043a010
007d8647 : MOV dword ptr [EBP + -0x4],0xffffffff
007d864e : LEA ECX,[EBP + 0x1c]
007d8651 : CALL 0x0043a010
007d8656 : MOV AL,0x1
007d8658 : MOV ECX,dword ptr [EBP + -0xc]
007d865b : MOV dword ptr FS:[0x0],ECX
007d8662 : POP ECX
007d8663 : POP EDI
007d8664 : POP EBX
007d8665 : MOV ESP,EBP
007d8667 : POP EBP
007d8668 : RET 0x1c

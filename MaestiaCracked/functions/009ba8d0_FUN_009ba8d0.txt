PROGRAM  : Maestia.exe
FUNCTION : FUN_009ba8d0
ENTRY    : 009ba8d0
BODY     : [[009ba8d0, 009bab2b]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x009baae8) */

void FUN_009ba8d0(void)

{
  byte *pbVar1;
  short sVar2;
  wchar_t wVar3;
  byte bVar4;
  uint uVar5;
  int iVar7;
  wchar_t *pwVar8;
  ushort *in_ECX;
  ushort *puVar9;
  ushort *extraout_ECX;
  ushort *extraout_ECX_00;
  ushort *puVar10;
  uint uVar11;
  undefined1 *puVar12;
  ushort *local_a40;
  int local_a3c;
  byte local_a33;
  byte local_a32;
  byte local_a31;
  wchar_t local_a14;
  undefined1 local_a12 [2046];
  undefined1 local_214 [512];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  uint uVar6;
  
  puStack_c = &LAB_00b38edf;
  local_10 = ExceptionList;
  uVar5 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_8 = 0;
  local_a14 = L'\0';
  if ((in_ECX + 4 == (ushort *)0x0) || ((*in_ECX & 0x1fff) == 8)) {
    uVar11 = 0;
    puVar10 = (ushort *)0x0;
    bVar4 = local_a31;
  }
  else {
    uVar11 = (*in_ECX & 0x1fff) - 9;
    puVar10 = (ushort *)((int)in_ECX + 9);
    bVar4 = (byte)in_ECX[4];
  }
  uVar6 = (uint)bVar4;
  local_a3c = 0;
  puVar9 = in_ECX;
  local_14 = uVar5;
  if (uVar6 != 0) {
    do {
      if ((puVar10 == (ushort *)0x0) || (uVar11 < 2)) {
LAB_009ba9e4:
        uVar11 = 0;
        puVar10 = (ushort *)0x0;
      }
      else {
        local_a40 = (ushort *)(uint)*puVar10;
        puVar9 = local_a40;
        if ((puVar10 + 1 == (ushort *)0x0) || (uVar11 == 2)) goto LAB_009ba9e4;
        local_a33 = (byte)puVar10[1];
        uVar11 = uVar11 - 3;
        if ((((short *)((int)puVar10 + 3) == (short *)0x0) || (uVar11 < 2)) ||
           (sVar2 = *(short *)((int)puVar10 + 3), sVar2 < 0)) goto LAB_009ba9e4;
        iVar7 = (int)sVar2;
        puVar9 = (ushort *)(iVar7 + 2);
        if ((int)uVar11 < (int)puVar9) goto LAB_009ba9e4;
        pbVar1 = (byte *)((int)puVar10 + iVar7 + 5);
        iVar7 = uVar11 + (-2 - iVar7);
        if ((pbVar1 == (byte *)0x0) || (iVar7 == 0)) goto LAB_009ba9e4;
        local_a32 = *pbVar1;
        if ((pbVar1 + 1 == (byte *)0x0) || (iVar7 == 1)) goto LAB_009ba9e4;
        local_a31 = pbVar1[1];
        puVar9 = (ushort *)CONCAT31((int3)((uint)puVar9 >> 8),local_a31);
        uVar11 = iVar7 - 2;
        puVar10 = (ushort *)(pbVar1 + 2);
      }
      puVar12 = local_214;
      FUN_0041f000(puVar9,puVar12,uVar5);
      FUN_006ef920(puVar12);
      pwVar8 = &local_a14;
      do {
        wVar3 = *pwVar8;
        pwVar8 = pwVar8 + 1;
      } while (wVar3 != L'\0');
      wsprintfW((LPWSTR)(local_a12 + ((int)pwVar8 - (int)local_a12 >> 1) * 2 + -2),L"%d&%s&%d&%d&%d"
                ,(uint)local_a40 & 0xffff,local_214,(uint)local_a31,(uint)local_a32,(uint)local_a33)
      ;
      puVar9 = extraout_ECX;
      if (local_a3c != uVar6 - 1) {
        _wcscat_s(&local_a14,0x400,L"|");
        puVar9 = extraout_ECX_00;
      }
      local_a3c = local_a3c + 1;
    } while (local_a3c < (int)uVar6);
  }
  (**(code **)(**(int **)(*DAT_00da9894 + 0x114) + 4))
            (*(int **)(*DAT_00da9894 + 0x114),"OnUpdateRoomList","%d,%d,%d,%ls",(char)in_ECX[2],
             *(undefined1 *)((int)in_ECX + 7),*(undefined2 *)((int)in_ECX + 5),&local_a14);
  local_8 = 0xffffffff;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
009ba8d0 : PUSH EBP
009ba8d1 : MOV EBP,ESP
009ba8d3 : PUSH -0x1
009ba8d5 : PUSH 0xb38edf
009ba8da : MOV EAX,FS:[0x0]
009ba8e0 : PUSH EAX
009ba8e1 : SUB ESP,0xa34
009ba8e7 : MOV EAX,[0x00d66fa0]
009ba8ec : XOR EAX,EBP
009ba8ee : MOV dword ptr [EBP + -0x10],EAX
009ba8f1 : PUSH EBX
009ba8f2 : PUSH ESI
009ba8f3 : PUSH EDI
009ba8f4 : PUSH EAX
009ba8f5 : LEA EAX,[EBP + -0xc]
009ba8f8 : MOV FS:[0x0],EAX
009ba8fe : MOVZX EDI,word ptr [ECX]
009ba901 : AND EDI,0x1fff
009ba907 : XOR EDX,EDX
009ba909 : XOR EAX,EAX
009ba90b : MOV dword ptr [EBP + 0xfffff5c0],ECX
009ba911 : LEA ESI,[ECX + 0x8]
009ba914 : SUB EDI,0x8
009ba917 : MOV dword ptr [EBP + 0xfffff5ec],0x7
009ba921 : MOV dword ptr [EBP + 0xfffff5e8],EDX
009ba927 : MOV word ptr [EBP + 0xfffff5d8],AX
009ba92e : MOV dword ptr [EBP + -0x4],EDX
009ba931 : MOV word ptr [EBP + 0xfffff5f0],AX
009ba938 : CMP ESI,EDX
009ba93a : JZ 0x009ba947
009ba93c : CMP EDI,0x1
009ba93f : JC 0x009ba947
009ba941 : MOV AL,byte ptr [ESI]
009ba943 : DEC EDI
009ba944 : INC ESI
009ba945 : JMP 0x009ba951
009ba947 : MOV AL,byte ptr [EBP + 0xfffff5d3]
009ba94d : XOR EDI,EDI
009ba94f : XOR ESI,ESI
009ba951 : MOVZX EAX,AL
009ba954 : CMP EAX,EDX
009ba956 : MOV dword ptr [EBP + 0xfffff5c8],EDX
009ba95c : MOV dword ptr [EBP + 0xfffff5cc],EAX
009ba962 : JLE 0x009baa9f
009ba968 : TEST ESI,ESI
009ba96a : JZ 0x009ba9e2
009ba96c : CMP EDI,0x2
009ba96f : JC 0x009ba9e2
009ba971 : MOVZX ECX,word ptr [ESI]
009ba974 : SUB EDI,0x2
009ba977 : ADD ESI,0x2
009ba97a : MOV dword ptr [EBP + 0xfffff5c4],ECX
009ba980 : JZ 0x009ba9e2
009ba982 : CMP EDI,0x1
009ba985 : JC 0x009ba9e2
009ba987 : MOV DL,byte ptr [ESI]
009ba989 : DEC EDI
009ba98a : ADD ESI,0x1
009ba98d : MOV byte ptr [EBP + 0xfffff5d1],DL
009ba993 : JZ 0x009ba9e2
009ba995 : CMP EDI,0x2
009ba998 : JC 0x009ba9e2
009ba99a : MOVZX EAX,word ptr [ESI]
009ba99d : TEST AX,AX
009ba9a0 : JL 0x009ba9e2
009ba9a2 : CWDE
009ba9a3 : LEA ECX,[EAX + 0x2]
009ba9a6 : CMP EDI,ECX
009ba9a8 : JL 0x009ba9e2
009ba9aa : MOV EDX,0xfffffffe
009ba9af : SUB EDX,EAX
009ba9b1 : LEA EBX,[ESI + 0x2]
009ba9b4 : LEA ESI,[ESI + EAX*0x1 + 0x2]
009ba9b8 : ADD EDI,EDX
009ba9ba : TEST ESI,ESI
009ba9bc : JZ 0x009ba9e4
009ba9be : CMP EDI,0x1
009ba9c1 : JC 0x009ba9e4
009ba9c3 : MOV AL,byte ptr [ESI]
009ba9c5 : DEC EDI
009ba9c6 : ADD ESI,0x1
009ba9c9 : MOV byte ptr [EBP + 0xfffff5d2],AL
009ba9cf : JZ 0x009ba9e4
009ba9d1 : CMP EDI,0x1
009ba9d4 : JC 0x009ba9e4
009ba9d6 : MOV CL,byte ptr [ESI]
009ba9d8 : DEC EDI
009ba9d9 : MOV byte ptr [EBP + 0xfffff5d3],CL
009ba9df : INC ESI
009ba9e0 : JMP 0x009ba9e8
009ba9e2 : XOR EBX,EBX
009ba9e4 : XOR EDI,EDI
009ba9e6 : XOR ESI,ESI
009ba9e8 : LEA EDX,[EBP + 0xfffffdf0]
009ba9ee : PUSH EDX
009ba9ef : PUSH ECX
009ba9f0 : CALL 0x0041f000
009ba9f5 : ADD ESP,0x4
009ba9f8 : MOV ECX,EBX
009ba9fa : MOV EDX,EAX
009ba9fc : CALL 0x006ef920
009baa01 : LEA EAX,[EBP + 0xfffff5f0]
009baa07 : LEA EDX,[EAX + 0x2]
009baa0a : LEA EBX,[EBX]
009baa10 : MOV CX,word ptr [EAX]
009baa13 : ADD EAX,0x2
009baa16 : TEST CX,CX
009baa19 : JNZ 0x009baa10
009baa1b : MOVZX ECX,byte ptr [EBP + 0xfffff5d1]
009baa22 : PUSH ECX
009baa23 : MOVZX ECX,byte ptr [EBP + 0xfffff5d3]
009baa2a : SUB EAX,EDX
009baa2c : MOVZX EDX,byte ptr [EBP + 0xfffff5d2]
009baa33 : PUSH EDX
009baa34 : PUSH ECX
009baa35 : MOVZX ECX,word ptr [EBP + 0xfffff5c4]
009baa3c : LEA EDX,[EBP + 0xfffffdf0]
009baa42 : PUSH EDX
009baa43 : PUSH ECX
009baa44 : SAR EAX,0x1
009baa46 : LEA EDX,[EBP + EAX*0x2 + 0xfffff5f0]
009baa4d : PUSH 0xc8e4b8
009baa52 : PUSH EDX
009baa53 : CALL dword ptr [0x00b85434]
009baa59 : MOV EAX,dword ptr [EBP + 0xfffff5cc]
009baa5f : MOV EBX,dword ptr [EBP + 0xfffff5c8]
009baa65 : DEC EAX
009baa66 : ADD ESP,0x1c
009baa69 : CMP EBX,EAX
009baa6b : JZ 0x009baa86
009baa6d : PUSH 0xc8e4d8
009baa72 : LEA EAX,[EBP + 0xfffff5f0]
009baa78 : PUSH 0x400
009baa7d : PUSH EAX
009baa7e : CALL 0x006362c1
009baa83 : ADD ESP,0xc
009baa86 : INC EBX
009baa87 : CMP EBX,dword ptr [EBP + 0xfffff5cc]
009baa8d : MOV dword ptr [EBP + 0xfffff5c8],EBX
009baa93 : JL 0x009ba968
009baa99 : MOV ECX,dword ptr [EBP + 0xfffff5c0]
009baa9f : MOV EDX,dword ptr [0x00da9894]
009baaa5 : MOV EAX,dword ptr [EDX]
009baaa7 : MOV EAX,dword ptr [EAX + 0x114]
009baaad : MOV EDX,dword ptr [EAX]
009baaaf : MOV EDX,dword ptr [EDX + 0x4]
009baab2 : LEA ESI,[EBP + 0xfffff5f0]
009baab8 : PUSH ESI
009baab9 : MOVZX ESI,word ptr [ECX + 0x5]
009baabd : PUSH ESI
009baabe : MOVZX ESI,byte ptr [ECX + 0x7]
009baac2 : MOVZX ECX,byte ptr [ECX + 0x4]
009baac6 : PUSH ESI
009baac7 : PUSH ECX
009baac8 : PUSH 0xc8e4dc
009baacd : PUSH 0xc8e4ec
009baad2 : PUSH EAX
009baad3 : CALL EDX
009baad5 : ADD ESP,0x1c
009baad8 : MOV dword ptr [EBP + -0x4],0xffffffff
009baadf : CMP dword ptr [EBP + 0xfffff5ec],0x8
009baae6 : JC 0x009baaf3
009baae8 : MOV ECX,dword ptr [EBP + 0xfffff5d8]
009baaee : CALL 0x006f04e0
009baaf3 : XOR EAX,EAX
009baaf5 : MOV dword ptr [EBP + 0xfffff5ec],0x7
009baaff : MOV dword ptr [EBP + 0xfffff5e8],0x0
009bab09 : MOV word ptr [EBP + 0xfffff5d8],AX
009bab10 : MOV ECX,dword ptr [EBP + -0xc]
009bab13 : MOV dword ptr FS:[0x0],ECX
009bab1a : POP ECX
009bab1b : POP EDI
009bab1c : POP ESI
009bab1d : POP EBX
009bab1e : MOV ECX,dword ptr [EBP + -0x10]
009bab21 : XOR ECX,EBP
009bab23 : CALL 0x00633e6b
009bab28 : MOV ESP,EBP
009bab2a : POP EBP
009bab2b : RET

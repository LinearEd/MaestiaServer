PROGRAM  : Maestia.exe
FUNCTION : FUN_007471c0
ENTRY    : 007471c0
BODY     : [[007471c0, 007474e0]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x00747345) */
/* WARNING: Removing unreachable block (ram,0x00747293) */
/* WARNING: Removing unreachable block (ram,0x007472e3) */
/* WARNING: Removing unreachable block (ram,0x007473a7) */
/* WARNING: Removing unreachable block (ram,0x00747409) */
/* WARNING: Removing unreachable block (ram,0x00747410) */
/* WARNING: Removing unreachable block (ram,0x0074747a) */
/* WARNING: Removing unreachable block (ram,0x00747480) */

void FUN_007471c0(void)

{
  PRTL_CRITICAL_SECTION_DEBUG p_Var1;
  undefined4 *puVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  LPCRITICAL_SECTION unaff_EDI;
  PRTL_CRITICAL_SECTION_DEBUG p_Stack_24;
  PRTL_CRITICAL_SECTION_DEBUG local_20;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b188e1;
  local_14 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xffffffd0;
  ExceptionList = &local_14;
  EnterCriticalSection(unaff_EDI);
  local_c = 0;
  p_Var1 = unaff_EDI[1].DebugInfo;
  for (local_20 = unaff_EDI[2].DebugInfo;
      (p_Var1 != unaff_EDI[1].DebugInfo ||
      (local_20 !=
       (PRTL_CRITICAL_SECTION_DEBUG)((int)&(unaff_EDI[2].DebugInfo)->Type + unaff_EDI[2].LockCount))
      ); local_20 = (PRTL_CRITICAL_SECTION_DEBUG)((int)&local_20->Type + 1)) {
    uVar4 = (uint)local_20 >> 2;
    if (p_Var1 == (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
      iVar5 = 0;
    }
    else {
      iVar5._0_2_ = p_Var1->Type;
      iVar5._2_2_ = p_Var1->CreatorBackTraceIndex;
    }
    if (*(uint *)(iVar5 + 0x14) <= uVar4) {
      if (p_Var1 == (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
        iVar6 = 0;
      }
      else {
        iVar6._0_2_ = p_Var1->Type;
        iVar6._2_2_ = p_Var1->CreatorBackTraceIndex;
      }
      uVar4 = uVar4 - *(int *)(iVar6 + 0x14);
    }
    if (p_Var1 == (PRTL_CRITICAL_SECTION_DEBUG)0x0) {
      iVar7 = 0;
    }
    else {
      iVar7._0_2_ = p_Var1->Type;
      iVar7._2_2_ = p_Var1->CreatorBackTraceIndex;
    }
    puVar2 = *(undefined4 **)
              (*(int *)(*(int *)(iVar7 + 0x10) + uVar4 * 4) + ((uint)local_20 & 3) * 4);
    if (puVar2 != (undefined4 *)0x0) {
      (**(code **)*puVar2)(1);
    }
  }
  FUN_00476f00(uVar3);
  FUN_00458e80(&unaff_EDI[2].OwningThread);
  p_Stack_24 = unaff_EDI[2].LockSemaphore;
  if (unaff_EDI[3].LockCount != unaff_EDI[3].RecursionCount) {
    unaff_EDI[3].RecursionCount = unaff_EDI[3].LockCount;
  }
  FUN_00487720(unaff_EDI + 3,unaff_EDI[3].LockCount);
  unaff_EDI[3].LockSemaphore = (HANDLE)0x7;
  unaff_EDI[3].SpinCount = 8;
  FUN_00458e80(&unaff_EDI[4].RecursionCount);
  p_Stack_24 = unaff_EDI[4].OwningThread;
  if (unaff_EDI[5].DebugInfo != (PRTL_CRITICAL_SECTION_DEBUG)unaff_EDI[5].LockCount) {
    unaff_EDI[5].LockCount = (LONG)unaff_EDI[5].DebugInfo;
  }
  FUN_00487720(&unaff_EDI[4].SpinCount,unaff_EDI[5].DebugInfo);
  unaff_EDI[5].OwningThread = (HANDLE)0x7;
  unaff_EDI[5].LockSemaphore = &DAT_00000008;
  FUN_00458e80(&unaff_EDI[6].LockCount);
  p_Stack_24 = (PRTL_CRITICAL_SECTION_DEBUG)unaff_EDI[6].RecursionCount;
  if ((PRTL_CRITICAL_SECTION_DEBUG)unaff_EDI[6].SpinCount != unaff_EDI[7].DebugInfo) {
    unaff_EDI[7].DebugInfo = (PRTL_CRITICAL_SECTION_DEBUG)unaff_EDI[6].SpinCount;
  }
  FUN_00487720(&unaff_EDI[6].LockSemaphore,unaff_EDI[6].SpinCount);
  unaff_EDI[7].RecursionCount = 7;
  unaff_EDI[7].OwningThread = &DAT_00000008;
  FUN_00458e80(unaff_EDI + 8);
  p_Stack_24 = (PRTL_CRITICAL_SECTION_DEBUG)unaff_EDI[8].LockCount;
  if (unaff_EDI[8].LockSemaphore != (HANDLE)unaff_EDI[8].SpinCount) {
    unaff_EDI[8].SpinCount = (ULONG_PTR)unaff_EDI[8].LockSemaphore;
  }
  FUN_00487720(&unaff_EDI[8].OwningThread,unaff_EDI[8].LockSemaphore);
  unaff_EDI[9].LockCount = 7;
  unaff_EDI[9].RecursionCount = 8;
  FUN_00458e80(&unaff_EDI[0xb].LockSemaphore);
  p_Stack_24 = (PRTL_CRITICAL_SECTION_DEBUG)unaff_EDI[0xb].SpinCount;
  if ((HANDLE)unaff_EDI[0xc].RecursionCount != unaff_EDI[0xc].OwningThread) {
    unaff_EDI[0xc].OwningThread = (HANDLE)unaff_EDI[0xc].RecursionCount;
  }
  FUN_0044f580(&unaff_EDI[0xc].LockCount,unaff_EDI[0xc].RecursionCount,&p_Stack_24);
  unaff_EDI[0xc].SpinCount = 7;
  unaff_EDI[0xd].DebugInfo = (PRTL_CRITICAL_SECTION_DEBUG)0x8;
  FUN_00458e80(&unaff_EDI[9].SpinCount);
  p_Stack_24 = unaff_EDI[10].DebugInfo;
  if (unaff_EDI[10].OwningThread != unaff_EDI[10].LockSemaphore) {
    unaff_EDI[10].LockSemaphore = unaff_EDI[10].OwningThread;
  }
  FUN_0044f580(&unaff_EDI[10].RecursionCount,unaff_EDI[10].OwningThread,&p_Stack_24);
  unaff_EDI[0xb].DebugInfo = (PRTL_CRITICAL_SECTION_DEBUG)0x7;
  unaff_EDI[0xb].LockCount = 8;
  *(undefined1 *)((int)&unaff_EDI[0xf].LockCount + 3) = 0;
  local_c = 0xffffffff;
  LeaveCriticalSection(unaff_EDI);
  ExceptionList = local_14;
  return;
}



============================================================
DISASSEMBLY
============================================================
007471c0 : PUSH EBP
007471c1 : MOV EBP,ESP
007471c3 : AND ESP,0xfffffff8
007471c6 : PUSH -0x1
007471c8 : PUSH 0xb188e1
007471cd : MOV EAX,FS:[0x0]
007471d3 : PUSH EAX
007471d4 : SUB ESP,0x14
007471d7 : PUSH EBX
007471d8 : PUSH ESI
007471d9 : MOV EAX,[0x00d66fa0]
007471de : XOR EAX,ESP
007471e0 : PUSH EAX
007471e1 : LEA EAX,[ESP + 0x20]
007471e5 : MOV FS:[0x0],EAX
007471eb : PUSH EDI
007471ec : MOV dword ptr [ESP + 0x1c],EDI
007471f0 : CALL dword ptr [0x00b85118]
007471f6 : MOV dword ptr [ESP + 0x28],0x0
007471fe : MOV EAX,dword ptr [EDI + 0x30]
00747201 : MOV EBX,dword ptr [EDI + 0x18]
00747204 : LEA ESI,[EDI + 0x18]
00747207 : MOV ECX,EAX
00747209 : MOV dword ptr [ESP + 0x14],ECX
0074720d : LEA ECX,[ECX]
00747210 : MOV EAX,dword ptr [ESI + 0x1c]
00747213 : ADD EAX,dword ptr [ESI + 0x18]
00747216 : CMP EBX,dword ptr [ESI]
00747218 : JNZ 0x0074721e
0074721a : CMP ECX,EAX
0074721c : JZ 0x0074726b
0074721e : MOV EAX,ECX
00747220 : SHR EAX,0x2
00747223 : AND ECX,0x3
00747226 : TEST EBX,EBX
00747228 : JZ 0x0074722e
0074722a : MOV EDX,dword ptr [EBX]
0074722c : JMP 0x00747230
0074722e : XOR EDX,EDX
00747230 : CMP dword ptr [EDX + 0x14],EAX
00747233 : JA 0x00747242
00747235 : TEST EBX,EBX
00747237 : JZ 0x0074723d
00747239 : MOV EDX,dword ptr [EBX]
0074723b : JMP 0x0074723f
0074723d : XOR EDX,EDX
0074723f : SUB EAX,dword ptr [EDX + 0x14]
00747242 : TEST EBX,EBX
00747244 : JZ 0x0074724a
00747246 : MOV EDX,dword ptr [EBX]
00747248 : JMP 0x0074724c
0074724a : XOR EDX,EDX
0074724c : MOV EDX,dword ptr [EDX + 0x10]
0074724f : MOV EAX,dword ptr [EDX + EAX*0x4]
00747252 : MOV ECX,dword ptr [EAX + ECX*0x4]
00747255 : TEST ECX,ECX
00747257 : JZ 0x00747261
00747259 : MOV EDX,dword ptr [ECX]
0074725b : MOV EAX,dword ptr [EDX]
0074725d : PUSH 0x1
0074725f : CALL EAX
00747261 : INC dword ptr [ESP + 0x14]
00747265 : MOV ECX,dword ptr [ESP + 0x14]
00747269 : JMP 0x00747210
0074726b : CALL 0x00476f00
00747270 : LEA ECX,[EDI + 0x3c]
00747273 : PUSH ECX
00747274 : CALL 0x00458e80
00747279 : MOV ECX,dword ptr [EDI + 0x40]
0074727c : MOV ESI,dword ptr [EDI + 0x4c]
0074727f : LEA EAX,[EDI + 0x48]
00747282 : MOV dword ptr [ESP + 0x10],ECX
00747286 : MOV ECX,dword ptr [EAX + 0x8]
00747289 : CMP ESI,ECX
0074728b : JZ 0x007472a4
0074728d : MOV EDX,ECX
0074728f : CMP ECX,ECX
00747291 : JZ 0x007472a1
00747293 : MOV EBX,dword ptr [EDX]
00747295 : MOV dword ptr [ESI],EBX
00747297 : ADD EDX,0x4
0074729a : ADD ESI,0x4
0074729d : CMP EDX,ECX
0074729f : JNZ 0x00747293
007472a1 : MOV dword ptr [EAX + 0x8],ESI
007472a4 : MOV ECX,dword ptr [EAX + 0x4]
007472a7 : PUSH ECX
007472a8 : PUSH EAX
007472a9 : LEA ECX,[ESP + 0x18]
007472ad : CALL 0x00487720
007472b2 : LEA EDX,[EDI + 0x68]
007472b5 : PUSH EDX
007472b6 : MOV dword ptr [EDI + 0x58],0x7
007472bd : MOV dword ptr [EDI + 0x5c],0x8
007472c4 : CALL 0x00458e80
007472c9 : MOV ECX,dword ptr [EDI + 0x6c]
007472cc : MOV ESI,dword ptr [EDI + 0x78]
007472cf : LEA EAX,[EDI + 0x74]
007472d2 : MOV dword ptr [ESP + 0x10],ECX
007472d6 : MOV ECX,dword ptr [EAX + 0x8]
007472d9 : CMP ESI,ECX
007472db : JZ 0x007472f4
007472dd : MOV EDX,ECX
007472df : CMP ECX,ECX
007472e1 : JZ 0x007472f1
007472e3 : MOV EBX,dword ptr [EDX]
007472e5 : MOV dword ptr [ESI],EBX
007472e7 : ADD EDX,0x4
007472ea : ADD ESI,0x4
007472ed : CMP EDX,ECX
007472ef : JNZ 0x007472e3
007472f1 : MOV dword ptr [EAX + 0x8],ESI
007472f4 : MOV ECX,dword ptr [EAX + 0x4]
007472f7 : PUSH ECX
007472f8 : PUSH EAX
007472f9 : LEA ECX,[ESP + 0x18]
007472fd : CALL 0x00487720
00747302 : LEA EAX,[EDI + 0x94]
00747308 : PUSH EAX
00747309 : MOV dword ptr [EDI + 0x84],0x7
00747313 : MOV dword ptr [EDI + 0x88],0x8
0074731d : CALL 0x00458e80
00747322 : MOV ECX,dword ptr [EDI + 0x98]
00747328 : MOV ESI,dword ptr [EDI + 0xa4]
0074732e : LEA EAX,[EDI + 0xa0]
00747334 : MOV dword ptr [ESP + 0x10],ECX
00747338 : MOV ECX,dword ptr [EAX + 0x8]
0074733b : CMP ESI,ECX
0074733d : JZ 0x00747356
0074733f : MOV EDX,ECX
00747341 : CMP ECX,ECX
00747343 : JZ 0x00747353
00747345 : MOV EBX,dword ptr [EDX]
00747347 : MOV dword ptr [ESI],EBX
00747349 : ADD EDX,0x4
0074734c : ADD ESI,0x4
0074734f : CMP EDX,ECX
00747351 : JNZ 0x00747345
00747353 : MOV dword ptr [EAX + 0x8],ESI
00747356 : MOV ECX,dword ptr [EAX + 0x4]
00747359 : PUSH ECX
0074735a : PUSH EAX
0074735b : LEA ECX,[ESP + 0x18]
0074735f : CALL 0x00487720
00747364 : LEA ECX,[EDI + 0xc0]
0074736a : PUSH ECX
0074736b : MOV dword ptr [EDI + 0xb0],0x7
00747375 : MOV dword ptr [EDI + 0xb4],0x8
0074737f : CALL 0x00458e80
00747384 : MOV ECX,dword ptr [EDI + 0xc4]
0074738a : MOV ESI,dword ptr [EDI + 0xd0]
00747390 : LEA EAX,[EDI + 0xcc]
00747396 : MOV dword ptr [ESP + 0x10],ECX
0074739a : MOV ECX,dword ptr [EAX + 0x8]
0074739d : CMP ESI,ECX
0074739f : JZ 0x007473b8
007473a1 : MOV EDX,ECX
007473a3 : CMP ECX,ECX
007473a5 : JZ 0x007473b5
007473a7 : MOV EBX,dword ptr [EDX]
007473a9 : MOV dword ptr [ESI],EBX
007473ab : ADD EDX,0x4
007473ae : ADD ESI,0x4
007473b1 : CMP EDX,ECX
007473b3 : JNZ 0x007473a7
007473b5 : MOV dword ptr [EAX + 0x8],ESI
007473b8 : MOV ECX,dword ptr [EAX + 0x4]
007473bb : PUSH ECX
007473bc : PUSH EAX
007473bd : LEA ECX,[ESP + 0x18]
007473c1 : CALL 0x00487720
007473c6 : LEA EDX,[EDI + 0x118]
007473cc : PUSH EDX
007473cd : MOV dword ptr [EDI + 0xdc],0x7
007473d7 : MOV dword ptr [EDI + 0xe0],0x8
007473e1 : CALL 0x00458e80
007473e6 : MOV ECX,dword ptr [EDI + 0x11c]
007473ec : MOV ESI,dword ptr [EDI + 0x128]
007473f2 : LEA EAX,[EDI + 0x124]
007473f8 : MOV dword ptr [ESP + 0x10],ECX
007473fc : MOV ECX,dword ptr [EAX + 0x8]
007473ff : CMP ESI,ECX
00747401 : JZ 0x00747421
00747403 : MOV EDX,ECX
00747405 : CMP ECX,ECX
00747407 : JZ 0x0074741e
00747409 : LEA ESP,[ESP]
00747410 : MOV EBX,dword ptr [EDX]
00747412 : MOV dword ptr [ESI],EBX
00747414 : ADD EDX,0x4
00747417 : ADD ESI,0x4
0074741a : CMP EDX,ECX
0074741c : JNZ 0x00747410
0074741e : MOV dword ptr [EAX + 0x8],ESI
00747421 : MOV ECX,dword ptr [EAX + 0x4]
00747424 : LEA EDX,[ESP + 0x10]
00747428 : PUSH EDX
00747429 : PUSH ECX
0074742a : PUSH EAX
0074742b : MOV ECX,0x9
00747430 : CALL 0x0044f580
00747435 : LEA EAX,[EDI + 0xec]
0074743b : PUSH EAX
0074743c : MOV dword ptr [EDI + 0x134],0x7
00747446 : MOV dword ptr [EDI + 0x138],0x8
00747450 : CALL 0x00458e80
00747455 : MOV ECX,dword ptr [EDI + 0xf0]
0074745b : MOV EDX,dword ptr [EDI + 0xfc]
00747461 : LEA EAX,[EDI + 0xf8]
00747467 : MOV dword ptr [ESP + 0x10],ECX
0074746b : MOV ECX,dword ptr [EAX + 0x8]
0074746e : CMP EDX,ECX
00747470 : JZ 0x00747491
00747472 : MOV ESI,EDX
00747474 : MOV EDX,ECX
00747476 : CMP ECX,ECX
00747478 : JZ 0x0074748e
0074747a : LEA EBX,[EBX]
00747480 : MOV EBX,dword ptr [EDX]
00747482 : MOV dword ptr [ESI],EBX
00747484 : ADD EDX,0x4
00747487 : ADD ESI,0x4
0074748a : CMP EDX,ECX
0074748c : JNZ 0x00747480
0074748e : MOV dword ptr [EAX + 0x8],ESI
00747491 : MOV ECX,dword ptr [EAX + 0x4]
00747494 : LEA EDX,[ESP + 0x10]
00747498 : PUSH EDX
00747499 : PUSH ECX
0074749a : PUSH EAX
0074749b : MOV ECX,0x9
007474a0 : CALL 0x0044f580
007474a5 : MOV dword ptr [EDI + 0x108],0x7
007474af : MOV dword ptr [EDI + 0x10c],0x8
007474b9 : MOV byte ptr [EDI + 0x16f],0x0
007474c0 : MOV dword ptr [ESP + 0x28],0xffffffff
007474c8 : PUSH EDI
007474c9 : CALL dword ptr [0x00b8511c]
007474cf : MOV ECX,dword ptr [ESP + 0x20]
007474d3 : MOV dword ptr FS:[0x0],ECX
007474da : POP ECX
007474db : POP ESI
007474dc : POP EBX
007474dd : MOV ESP,EBP
007474df : POP EBP
007474e0 : RET

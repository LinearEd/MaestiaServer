PROGRAM  : Maestia.exe
FUNCTION : FUN_00427a20
ENTRY    : 00427a20
BODY     : [[00427a20, 00427b20]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00427a20(int param_1,uint param_2,uint param_3)

{
  uint uVar1;
  int in_ECX;
  int iVar2;
  
  if (*(uint *)(param_1 + 0x14) < param_2) {
    FUN_00622f07();
  }
  uVar1 = *(int *)(param_1 + 0x14) - param_2;
  if (uVar1 < param_3) {
    param_3 = uVar1;
  }
  uVar1 = *(uint *)(in_ECX + 0x14);
  if ((-uVar1 - 1 <= param_3) || (uVar1 + param_3 < uVar1)) {
    FUN_00622ecf();
  }
  if (param_3 != 0) {
    uVar1 = *(int *)(in_ECX + 0x14) + param_3;
    if (uVar1 == 0xffffffff) {
      FUN_00622ecf();
    }
    if (*(uint *)(in_ECX + 0x18) < uVar1) {
      FUN_00404ef0(uVar1,*(undefined4 *)(in_ECX + 0x14));
    }
    else if (uVar1 == 0) {
      *(undefined4 *)(in_ECX + 0x14) = 0;
      if (0xf < *(uint *)(in_ECX + 0x18)) {
        **(undefined1 **)(in_ECX + 4) = 0;
        return;
      }
      *(undefined1 *)(in_ECX + 4) = 0;
      return;
    }
    if (uVar1 != 0) {
      if (*(uint *)(param_1 + 0x18) < 0x10) {
        param_1 = param_1 + 4;
      }
      else {
        param_1 = *(int *)(param_1 + 4);
      }
      if (*(uint *)(in_ECX + 0x18) < 0x10) {
        iVar2 = in_ECX + 4;
      }
      else {
        iVar2 = *(int *)(in_ECX + 4);
      }
      _memcpy_s((void *)(*(int *)(in_ECX + 0x14) + iVar2),
                *(uint *)(in_ECX + 0x18) - *(int *)(in_ECX + 0x14),(void *)(param_1 + param_2),
                param_3);
      *(uint *)(in_ECX + 0x14) = uVar1;
      if (0xf < *(uint *)(in_ECX + 0x18)) {
        *(undefined1 *)(*(int *)(in_ECX + 4) + uVar1) = 0;
        return;
      }
      *(undefined1 *)(in_ECX + 4 + uVar1) = 0;
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00427a20 : PUSH EBP
00427a21 : MOV EBP,ESP
00427a23 : PUSH EBX
00427a24 : MOV EBX,dword ptr [EBP + 0xc]
00427a27 : PUSH ESI
00427a28 : PUSH EDI
00427a29 : MOV EDI,dword ptr [EBP + 0x8]
00427a2c : MOV ESI,ECX
00427a2e : CMP dword ptr [EDI + 0x14],EBX
00427a31 : JNC 0x00427a38
00427a33 : CALL 0x00622f07
00427a38 : MOV EAX,dword ptr [EDI + 0x14]
00427a3b : SUB EAX,EBX
00427a3d : MOV EBX,dword ptr [EBP + 0x10]
00427a40 : CMP EAX,EBX
00427a42 : CMOVC EBX,EAX
00427a45 : MOV EAX,dword ptr [ESI + 0x14]
00427a48 : OR ECX,0xffffffff
00427a4b : SUB ECX,EAX
00427a4d : CMP ECX,EBX
00427a4f : JBE 0x00427a58
00427a51 : LEA EDX,[EAX + EBX*0x1]
00427a54 : CMP EDX,EAX
00427a56 : JNC 0x00427a5d
00427a58 : CALL 0x00622ecf
00427a5d : TEST EBX,EBX
00427a5f : JBE 0x00427b18
00427a65 : MOV EDI,dword ptr [ESI + 0x14]
00427a68 : ADD EDI,EBX
00427a6a : CMP EDI,-0x2
00427a6d : JBE 0x00427a74
00427a6f : CALL 0x00622ecf
00427a74 : MOV EAX,dword ptr [ESI + 0x18]
00427a77 : CMP EAX,EDI
00427a79 : JNC 0x00427a9d
00427a7b : MOV EAX,dword ptr [ESI + 0x14]
00427a7e : PUSH EAX
00427a7f : PUSH EDI
00427a80 : MOV ECX,ESI
00427a82 : CALL 0x00404ef0
00427a87 : TEST EDI,EDI
00427a89 : JBE 0x00427b18
00427a8f : MOV EAX,dword ptr [EBP + 0x8]
00427a92 : CMP dword ptr [EAX + 0x18],0x10
00427a96 : JC 0x00427ac7
00427a98 : MOV EDX,dword ptr [EAX + 0x4]
00427a9b : JMP 0x00427aca
00427a9d : TEST EDI,EDI
00427a9f : JNZ 0x00427a89
00427aa1 : MOV dword ptr [ESI + 0x14],EDI
00427aa4 : CMP EAX,0x10
00427aa7 : JC 0x00427ab8
00427aa9 : MOV EAX,dword ptr [ESI + 0x4]
00427aac : POP EDI
00427aad : MOV byte ptr [EAX],0x0
00427ab0 : MOV EAX,ESI
00427ab2 : POP ESI
00427ab3 : POP EBX
00427ab4 : POP EBP
00427ab5 : RET 0xc
00427ab8 : LEA EAX,[ESI + 0x4]
00427abb : POP EDI
00427abc : MOV byte ptr [EAX],0x0
00427abf : MOV EAX,ESI
00427ac1 : POP ESI
00427ac2 : POP EBX
00427ac3 : POP EBP
00427ac4 : RET 0xc
00427ac7 : LEA EDX,[EAX + 0x4]
00427aca : MOV EAX,dword ptr [ESI + 0x18]
00427acd : CMP EAX,0x10
00427ad0 : JC 0x00427ad7
00427ad2 : MOV ECX,dword ptr [ESI + 0x4]
00427ad5 : JMP 0x00427ada
00427ad7 : LEA ECX,[ESI + 0x4]
00427ada : PUSH EBX
00427adb : MOV EBX,dword ptr [EBP + 0xc]
00427ade : MOV dword ptr [EBP + 0x8],ECX
00427ae1 : MOV ECX,dword ptr [ESI + 0x14]
00427ae4 : ADD EDX,EBX
00427ae6 : PUSH EDX
00427ae7 : MOV EDX,dword ptr [EBP + 0x8]
00427aea : SUB EAX,ECX
00427aec : PUSH EAX
00427aed : ADD ECX,EDX
00427aef : PUSH ECX
00427af0 : CALL 0x00633ea4
00427af5 : ADD ESP,0x10
00427af8 : CMP dword ptr [ESI + 0x18],0x10
00427afc : MOV dword ptr [ESI + 0x14],EDI
00427aff : JC 0x00427b11
00427b01 : MOV EAX,dword ptr [ESI + 0x4]
00427b04 : MOV byte ptr [EAX + EDI*0x1],0x0
00427b08 : POP EDI
00427b09 : MOV EAX,ESI
00427b0b : POP ESI
00427b0c : POP EBX
00427b0d : POP EBP
00427b0e : RET 0xc
00427b11 : LEA EAX,[ESI + 0x4]
00427b14 : MOV byte ptr [EAX + EDI*0x1],0x0
00427b18 : POP EDI
00427b19 : MOV EAX,ESI
00427b1b : POP ESI
00427b1c : POP EBX
00427b1d : POP EBP
00427b1e : RET 0xc

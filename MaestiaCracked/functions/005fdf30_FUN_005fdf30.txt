PROGRAM  : Maestia.exe
FUNCTION : FUN_005fdf30
ENTRY    : 005fdf30
BODY     : [[005fdf30, 005fe186]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005fdf30(void)

{
  int *piVar1;
  undefined4 *puVar2;
  float fVar3;
  float fVar4;
  int iVar5;
  int iVar6;
  uint uVar7;
  int in_ECX;
  uint uVar8;
  uint local_8;
  float local_4;
  
  FUN_005fa720((int *)(in_ECX + 0x7c),0,*(undefined4 *)(in_ECX + 0x7c),in_ECX + 0x30);
  fVar3 = *(float *)(in_ECX + 0xe0);
  if (*(float *)(in_ECX + 0xe0) < 0.0) {
    fVar3 = -fVar3;
  }
  fVar4 = *(float *)(in_ECX + 0xe8);
  if (*(float *)(in_ECX + 0xe8) < 0.0) {
    fVar4 = -fVar4;
  }
  if (fVar3 < fVar4) {
    fVar3 = fVar4;
  }
  *(float *)(in_ECX + 0xf0) = fVar3 * 1e-05;
  fVar3 = *(float *)(in_ECX + 0xe4);
  if (*(float *)(in_ECX + 0xe4) < 0.0) {
    fVar3 = -fVar3;
  }
  fVar4 = *(float *)(in_ECX + 0xec);
  if (*(float *)(in_ECX + 0xec) < 0.0) {
    fVar4 = -fVar4;
  }
  if (fVar3 < fVar4) {
    fVar3 = fVar4;
  }
  uVar8 = 0;
  local_8 = 0;
  *(float *)(in_ECX + 0xf4) = fVar3 * 1e-05;
  local_4 = -1e+30;
  if (*(int *)(in_ECX + 0x7c) != 0) {
    fVar3 = -1e+30;
    do {
      uVar7 = *(uint *)(*(int *)(*(int *)(in_ECX + 0x88) + (local_8 >> 10) * 4) +
                       (local_8 & 0x3ff) * 4);
      iVar5 = *(int *)(*(int *)(in_ECX + 0x3c) + (uVar7 >> 10) * 4);
      iVar6 = iVar5 + (uVar7 & 0x3ff) * 8;
      if (*(float *)(iVar5 + 4 + (uVar7 & 0x3ff) * 8) - fVar3 <= *(float *)(in_ECX + 0xf4)) {
        *(float *)(iVar6 + 4) = fVar3;
      }
      else {
        *(uint *)(*(int *)(*(int *)(in_ECX + 0x88) + (uVar8 >> 10) * 4) + (uVar8 & 0x3ff) * 4) =
             uVar7;
        fVar3 = *(float *)(iVar6 + 4);
        uVar8 = uVar8 + 1;
        local_4 = fVar3;
      }
      local_8 = local_8 + 1;
    } while (local_8 < *(uint *)(in_ECX + 0x7c));
  }
  if (uVar8 < *(uint *)(in_ECX + 0x7c)) {
    *(uint *)(in_ECX + 0x7c) = uVar8;
  }
  uVar8 = 0;
  if (*(int *)(in_ECX + 0x40) != 0) {
    do {
      FUN_005fc110((uVar8 & 0x3f) * 0x10 + *(int *)(*(int *)(in_ECX + 0x4c) + (uVar8 >> 6) * 4));
      uVar8 = uVar8 + 1;
    } while (uVar8 < *(uint *)(in_ECX + 0x40));
  }
  uVar8 = *(uint *)(in_ECX + 0x60);
  piVar1 = (int *)(in_ECX + 0x70);
  if (*(uint *)(in_ECX + 0x78) < uVar8) {
    FUN_00515cf0(*piVar1);
    iVar6 = uVar8 + 0x20;
    *(int *)(in_ECX + 0x78) = iVar6;
    if (iVar6 == 0) {
      iVar6 = 0;
    }
    else {
      local_4 = 1.86373e-43;
      iVar6 = FUN_00515d60(piVar1,iVar6 * 4,&local_4);
    }
    *piVar1 = iVar6;
  }
  uVar7 = 0;
  *(uint *)(in_ECX + 0x74) = uVar8;
  if (*(int *)(in_ECX + 0x60) != 0) {
    do {
      puVar2 = (undefined4 *)
               (*(int *)(*(int *)(in_ECX + 0x6c) + (uVar7 >> 6) * 4) + (uVar7 & 0x3f) * 0x38);
      uVar7 = uVar7 + 1;
      puVar2[1] = *(undefined4 *)
                   (*(int *)(*(int *)(in_ECX + 0x3c) + (*(uint *)*puVar2 >> 10) * 4) + 4 +
                   (*(uint *)*puVar2 & 0x3ff) * 8);
      *(undefined4 **)(*piVar1 + -4 + uVar7 * 4) = puVar2;
    } while (uVar7 < *(uint *)(in_ECX + 0x60));
  }
  FUN_005f92b0(piVar1,0,*(undefined4 *)(in_ECX + 0x74),&LAB_005f91a0);
  return;
}



============================================================
DISASSEMBLY
============================================================
005fdf30 : SUB ESP,0x8
005fdf33 : PUSH EBX
005fdf34 : PUSH EBP
005fdf35 : PUSH ESI
005fdf36 : MOV ESI,ECX
005fdf38 : PUSH EDI
005fdf39 : LEA EAX,[ESI + 0x30]
005fdf3c : PUSH EAX
005fdf3d : MOV EAX,dword ptr [ESI + 0x7c]
005fdf40 : LEA EBP,[ESI + 0x7c]
005fdf43 : PUSH EAX
005fdf44 : PUSH 0x0
005fdf46 : PUSH EBP
005fdf47 : CALL 0x005fa720
005fdf4c : FLDZ
005fdf4e : FCOM float ptr [ESI + 0xe0]
005fdf54 : ADD ESP,0x10
005fdf57 : FNSTSW AX
005fdf59 : FLD float ptr [ESI + 0xe0]
005fdf5f : TEST AH,0x41
005fdf62 : JNZ 0x005fdf66
005fdf64 : FCHS
005fdf66 : FSTP float ptr [ESP + 0x14]
005fdf6a : FCOM float ptr [ESI + 0xe8]
005fdf70 : FNSTSW AX
005fdf72 : FLD float ptr [ESI + 0xe8]
005fdf78 : TEST AH,0x41
005fdf7b : JNZ 0x005fdf7f
005fdf7d : FCHS
005fdf7f : FSTP float ptr [ESP + 0x10]
005fdf83 : FLD float ptr [ESP + 0x10]
005fdf87 : FLD float ptr [ESP + 0x14]
005fdf8b : FCOM
005fdf8d : FNSTSW AX
005fdf8f : TEST AH,0x5
005fdf92 : JP 0x005fdf98
005fdf94 : FSTP ST0
005fdf96 : JMP 0x005fdf9a
005fdf98 : FSTP ST1
005fdf9a : FSTP float ptr [ESP + 0x14]
005fdf9e : FLD float ptr [ESP + 0x14]
005fdfa2 : FLD double ptr [0x00b95730]
005fdfa8 : FMUL ST1
005fdfaa : FXCH
005fdfac : FSTP float ptr [ESI + 0xf0]
005fdfb2 : FXCH
005fdfb4 : FCOM float ptr [ESI + 0xe4]
005fdfba : FNSTSW AX
005fdfbc : FLD float ptr [ESI + 0xe4]
005fdfc2 : TEST AH,0x41
005fdfc5 : JNZ 0x005fdfc9
005fdfc7 : FCHS
005fdfc9 : FSTP float ptr [ESP + 0x14]
005fdfcd : FCOMP float ptr [ESI + 0xec]
005fdfd3 : FNSTSW AX
005fdfd5 : FLD float ptr [ESI + 0xec]
005fdfdb : TEST AH,0x41
005fdfde : JNZ 0x005fdfe2
005fdfe0 : FCHS
005fdfe2 : FSTP float ptr [ESP + 0x10]
005fdfe6 : FLD float ptr [ESP + 0x10]
005fdfea : FLD float ptr [ESP + 0x14]
005fdfee : FCOM
005fdff0 : FNSTSW AX
005fdff2 : TEST AH,0x5
005fdff5 : JP 0x005fdffb
005fdff7 : FSTP ST0
005fdff9 : JMP 0x005fdffd
005fdffb : FSTP ST1
005fdffd : FSTP float ptr [ESP + 0x14]
005fe001 : XOR EBX,EBX
005fe003 : XOR EDI,EDI
005fe005 : FMUL float ptr [ESP + 0x14]
005fe009 : MOV dword ptr [ESP + 0x10],EBX
005fe00d : FSTP float ptr [ESI + 0xf4]
005fe013 : FLD float ptr [0x00b9571c]
005fe019 : FSTP float ptr [ESP + 0x14]
005fe01d : CMP dword ptr [EBP],EBX
005fe020 : JBE 0x005fe0b1
005fe026 : FLD float ptr [ESP + 0x14]
005fe02a : MOV EAX,dword ptr [ESI + 0x88]
005fe030 : MOV ECX,EBX
005fe032 : SHR ECX,0xa
005fe035 : MOV EAX,dword ptr [EAX + ECX*0x4]
005fe038 : MOV EDX,EBX
005fe03a : AND EDX,0x3ff
005fe040 : MOV ECX,dword ptr [EAX + EDX*0x4]
005fe043 : MOV EAX,dword ptr [ESI + 0x3c]
005fe046 : MOV EDX,ECX
005fe048 : SHR EDX,0xa
005fe04b : MOV EDX,dword ptr [EAX + EDX*0x4]
005fe04e : MOV EBP,ECX
005fe050 : AND EBP,0x3ff
005fe056 : FLD float ptr [EDX + EBP*0x8 + 0x4]
005fe05a : LEA EDX,[EDX + EBP*0x8]
005fe05d : FSUB ST0,ST1
005fe05f : FLD float ptr [ESI + 0xf4]
005fe065 : FCOMPP
005fe067 : FNSTSW AX
005fe069 : TEST AH,0x5
005fe06c : JP 0x005fe09b
005fe06e : MOV EAX,dword ptr [ESI + 0x88]
005fe074 : FSTP ST0
005fe076 : MOV EBX,EDI
005fe078 : SHR EBX,0xa
005fe07b : MOV EAX,dword ptr [EAX + EBX*0x4]
005fe07e : MOV EBX,dword ptr [ESP + 0x10]
005fe082 : MOV EBP,EDI
005fe084 : AND EBP,0x3ff
005fe08a : MOV dword ptr [EAX + EBP*0x4],ECX
005fe08d : FLD float ptr [EDX + 0x4]
005fe090 : FSTP float ptr [ESP + 0x14]
005fe094 : INC EDI
005fe095 : FLD float ptr [ESP + 0x14]
005fe099 : JMP 0x005fe09e
005fe09b : FST float ptr [EDX + 0x4]
005fe09e : INC EBX
005fe09f : LEA EBP,[ESI + 0x7c]
005fe0a2 : MOV dword ptr [ESP + 0x10],EBX
005fe0a6 : CMP EBX,dword ptr [EBP]
005fe0a9 : JC 0x005fe02a
005fe0af : FSTP ST0
005fe0b1 : CMP EDI,dword ptr [EBP]
005fe0b4 : JNC 0x005fe0b9
005fe0b6 : MOV dword ptr [EBP],EDI
005fe0b9 : XOR EDI,EDI
005fe0bb : CMP dword ptr [ESI + 0x40],EDI
005fe0be : JBE 0x005fe0e1
005fe0c0 : MOV EDX,dword ptr [ESI + 0x4c]
005fe0c3 : MOV EAX,EDI
005fe0c5 : AND EAX,0x3f
005fe0c8 : MOV ECX,EDI
005fe0ca : SHR ECX,0x6
005fe0cd : SHL EAX,0x4
005fe0d0 : ADD EAX,dword ptr [EDX + ECX*0x4]
005fe0d3 : MOV ECX,ESI
005fe0d5 : PUSH EAX
005fe0d6 : CALL 0x005fc110
005fe0db : INC EDI
005fe0dc : CMP EDI,dword ptr [ESI + 0x40]
005fe0df : JC 0x005fe0c0
005fe0e1 : MOV EBX,dword ptr [ESI + 0x60]
005fe0e4 : CMP EBX,dword ptr [ESI + 0x78]
005fe0e7 : LEA EDI,[ESI + 0x70]
005fe0ea : JBE 0x005fe11c
005fe0ec : MOV ECX,dword ptr [EDI]
005fe0ee : PUSH ECX
005fe0ef : CALL 0x00515cf0
005fe0f4 : LEA EAX,[EBX + 0x20]
005fe0f7 : MOV dword ptr [EDI + 0x8],EAX
005fe0fa : TEST EAX,EAX
005fe0fc : JZ 0x005fe118
005fe0fe : ADD EAX,EAX
005fe100 : LEA EDX,[ESP + 0x14]
005fe104 : PUSH EDX
005fe105 : ADD EAX,EAX
005fe107 : PUSH EAX
005fe108 : PUSH EDI
005fe109 : MOV dword ptr [ESP + 0x20],0x85
005fe111 : CALL 0x00515d60
005fe116 : JMP 0x005fe11a
005fe118 : XOR EAX,EAX
005fe11a : MOV dword ptr [EDI],EAX
005fe11c : XOR EAX,EAX
005fe11e : MOV dword ptr [EDI + 0x4],EBX
005fe121 : CMP dword ptr [ESI + 0x60],EAX
005fe124 : JBE 0x005fe16b
005fe126 : MOV EBX,dword ptr [ESI + 0x6c]
005fe129 : MOV ECX,EAX
005fe12b : AND ECX,0x3f
005fe12e : LEA EBP,[ECX*0x8 + 0x0]
005fe135 : SUB EBP,ECX
005fe137 : MOV EDX,EAX
005fe139 : SHR EDX,0x6
005fe13c : MOV ECX,dword ptr [EBX + EDX*0x4]
005fe13f : LEA EDX,[ECX + EBP*0x8]
005fe142 : MOV ECX,dword ptr [EDX]
005fe144 : MOV ECX,dword ptr [ECX]
005fe146 : MOV EBP,dword ptr [ESI + 0x3c]
005fe149 : MOV EBX,ECX
005fe14b : SHR EBX,0xa
005fe14e : MOV EBX,dword ptr [EBP + EBX*0x4]
005fe152 : AND ECX,0x3ff
005fe158 : FLD float ptr [EBX + ECX*0x8 + 0x4]
005fe15c : INC EAX
005fe15d : FSTP float ptr [EDX + 0x4]
005fe160 : MOV ECX,dword ptr [EDI]
005fe162 : MOV dword ptr [ECX + EAX*0x4 + -0x4],EDX
005fe166 : CMP EAX,dword ptr [ESI + 0x60]
005fe169 : JC 0x005fe126
005fe16b : MOV EDX,dword ptr [EDI + 0x4]
005fe16e : PUSH 0x5f91a0
005fe173 : PUSH EDX
005fe174 : PUSH 0x0
005fe176 : PUSH EDI
005fe177 : CALL 0x005f92b0
005fe17c : ADD ESP,0x10
005fe17f : POP EDI
005fe180 : POP ESI
005fe181 : POP EBP
005fe182 : POP EBX
005fe183 : ADD ESP,0x8
005fe186 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00a58b80
ENTRY    : 00a58b80
BODY     : [[00a58b80, 00a58e13]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00a58b80(undefined4 param_1,uint param_2,int param_3,uint param_4)

{
  byte bVar1;
  char cVar2;
  ushort uVar3;
  int *piVar4;
  int *piVar5;
  byte *pbVar6;
  int iVar7;
  int in_ECX;
  char *pcVar8;
  bool bVar9;
  
  if ((DAT_017251d0 != 0) && (cVar2 = FUN_007cb1b0(param_1,param_3,param_4), cVar2 != '\0')) {
    return 1;
  }
  if (0x200 < param_2) {
    switch(param_2) {
    case 0x201:
      goto switchD_00a58d5d_caseD_201;
    case 0x202:
      if (*(int *)(in_ECX + 0x74) != 4) {
        return 0;
      }
      *(undefined4 *)(in_ECX + 0x20) = 0;
      *(uint *)(in_ECX + 0x24) = param_4 & 0xffff;
      return 0;
    default:
      return 0;
    case 0x20a:
      FUN_00a495c0();
      return 0;
    }
  }
  if (param_2 == 0x200) {
    if (*(int *)(in_ECX + 0x74) == 3) {
      return 0;
    }
    if (*(int *)(in_ECX + 0x74) != 4) {
      return 0;
    }
    FUN_00a49a30();
    return 0;
  }
  if (param_2 == 0x100) {
    cVar2 = FUN_00a49730(param_3);
    if (cVar2 != '\0') {
      return 0;
    }
    if (param_3 != 0x50) {
      return 0;
    }
    uVar3 = GetAsyncKeyState(0x11);
    if ((uVar3 & 0x8000) == 0) {
      return 0;
    }
    if (DAT_00da9b38 != 0) {
      FUN_0070bca0(DAT_00da9b38);
    }
    FUN_007f5970();
    return 0;
  }
  if ((param_2 != 0x101) && (param_2 != 0x105)) {
    return 0;
  }
  switch(*(undefined4 *)(in_ECX + 0x74)) {
  case 0:
    if (param_3 != 0xd) {
      return 0;
    }
    piVar5 = (int *)FUN_008eb390();
    goto LAB_00a58c04;
  case 1:
    if ((param_3 == 0xd) && (*(undefined4 **)(in_ECX + 0x38) != (undefined4 *)0x0)) {
      (**(code **)**(undefined4 **)(in_ECX + 0x38))("onEnter");
      return 0;
    }
    break;
  default:
    if (param_3 == 0x1b) {
      if (DAT_017251d4 == 0) {
        return 0;
      }
      if (*(char *)(DAT_017251d4 + 0x34) != '\x01') {
        return 0;
      }
      *(undefined4 *)(DAT_017251d4 + 0x30) = 2;
      return 0;
    }
  case 2:
    if (param_3 == 0xd) {
      piVar4 = (int *)FUN_008eb390();
      piVar5 = (int *)FUN_008eb470();
      if (piVar4 != (int *)0x0) {
        (**(code **)(*piVar4 + 0x3c))();
        return 0;
      }
LAB_00a58c04:
      if (piVar5 != (int *)0x0) {
        (**(code **)(*piVar5 + 0x3c))();
        return 0;
      }
    }
    break;
  case 4:
    if (param_3 == 0x1b) {
      FUN_00a58850();
      return 0;
    }
  }
  return 0;
switchD_00a58d5d_caseD_201:
  iVar7 = *(int *)(in_ECX + 0x74);
  if (iVar7 == 2) {
    return 0;
  }
  if (iVar7 == 3) {
    return 0;
  }
  if (iVar7 != 4) {
    return 0;
  }
  if (*(undefined4 **)(in_ECX + 0x48) == (undefined4 *)0x0) {
    return 0;
  }
  pbVar6 = (byte *)(**(code **)**(undefined4 **)(in_ECX + 0x48))("MyHitTest");
  pcVar8 = "false";
  do {
    bVar1 = *pbVar6;
    bVar9 = bVar1 < (byte)*pcVar8;
    if (bVar1 != *pcVar8) {
LAB_00a58dc0:
      iVar7 = (1 - (uint)bVar9) - (uint)(bVar9 != 0);
      goto LAB_00a58dc5;
    }
    if (bVar1 == 0) break;
    bVar1 = pbVar6[1];
    bVar9 = bVar1 < ((byte *)pcVar8)[1];
    if (bVar1 != ((byte *)pcVar8)[1]) goto LAB_00a58dc0;
    pbVar6 = pbVar6 + 2;
    pcVar8 = (char *)((byte *)pcVar8 + 2);
  } while (bVar1 != 0);
  iVar7 = 0;
LAB_00a58dc5:
  if (iVar7 != 0) {
    return 0;
  }
  *(uint *)(in_ECX + 0x24) = param_4 & 0xffff;
  *(undefined4 *)(in_ECX + 0x20) = 1;
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00a58b80 : PUSH EBP
00a58b81 : MOV EBP,ESP
00a58b83 : PUSH EBX
00a58b84 : PUSH ESI
00a58b85 : MOV ESI,dword ptr [EBP + 0xc]
00a58b88 : PUSH EDI
00a58b89 : MOV EDI,dword ptr [0x017251d0]
00a58b8f : MOV EBX,ECX
00a58b91 : TEST EDI,EDI
00a58b93 : JZ 0x00a58bb3
00a58b95 : MOV EAX,dword ptr [EBP + 0x14]
00a58b98 : MOV ECX,dword ptr [EBP + 0x10]
00a58b9b : MOV EDX,dword ptr [EBP + 0x8]
00a58b9e : PUSH EAX
00a58b9f : PUSH ECX
00a58ba0 : PUSH EDX
00a58ba1 : CALL 0x007cb1b0
00a58ba6 : TEST AL,AL
00a58ba8 : JZ 0x00a58bb3
00a58baa : POP EDI
00a58bab : POP ESI
00a58bac : MOV AL,0x1
00a58bae : POP EBX
00a58baf : POP EBP
00a58bb0 : RET 0x10
00a58bb3 : CMP ESI,0x200
00a58bb9 : JA 0x00a58d47
00a58bbf : JZ 0x00a58d1d
00a58bc5 : SUB ESI,0x100
00a58bcb : JZ 0x00a58ccd
00a58bd1 : SUB ESI,0x1
00a58bd4 : JZ 0x00a58bdf
00a58bd6 : SUB ESI,0x4
00a58bd9 : JNZ 0x00a58e0b
00a58bdf : MOV EAX,dword ptr [EBX + 0x74]
00a58be2 : CMP EAX,0x4
00a58be5 : JA 0x00a58c64
00a58be7 : JMP dword ptr [EAX*0x4 + 0xa58e14]
00a58bee : CMP dword ptr [EBP + 0x10],0xd
00a58bf2 : JNZ 0x00a58e0b
00a58bf8 : MOV EAX,[0x00da9894]
00a58bfd : MOV EAX,dword ptr [EAX]
00a58bff : CALL 0x008eb390
00a58c04 : TEST EAX,EAX
00a58c06 : JZ 0x00a58e0b
00a58c0c : MOV EDX,dword ptr [EAX]
00a58c0e : MOV ECX,EAX
00a58c10 : MOV EAX,dword ptr [EDX + 0x3c]
00a58c13 : CALL EAX
00a58c15 : POP EDI
00a58c16 : POP ESI
00a58c17 : XOR AL,AL
00a58c19 : POP EBX
00a58c1a : POP EBP
00a58c1b : RET 0x10
00a58c1e : CMP dword ptr [EBP + 0x10],0xd
00a58c22 : JNZ 0x00a58e0b
00a58c28 : MOV EBX,dword ptr [EBX + 0x38]
00a58c2b : TEST EBX,EBX
00a58c2d : JZ 0x00a58e0b
00a58c33 : MOV EDX,dword ptr [EBX]
00a58c35 : MOV EAX,dword ptr [EDX]
00a58c37 : PUSH 0xcc9dc4
00a58c3c : MOV ECX,EBX
00a58c3e : CALL EAX
00a58c40 : POP EDI
00a58c41 : POP ESI
00a58c42 : XOR AL,AL
00a58c44 : POP EBX
00a58c45 : POP EBP
00a58c46 : RET 0x10
00a58c49 : CMP dword ptr [EBP + 0x10],0x1b
00a58c4d : JNZ 0x00a58e0b
00a58c53 : LEA EDI,[EBX + -0x4]
00a58c56 : CALL 0x00a58850
00a58c5b : POP EDI
00a58c5c : POP ESI
00a58c5d : XOR AL,AL
00a58c5f : POP EBX
00a58c60 : POP EBP
00a58c61 : RET 0x10
00a58c64 : CMP dword ptr [EBP + 0x10],0x1b
00a58c68 : JNZ 0x00a58c91
00a58c6a : MOV EAX,[0x017251d4]
00a58c6f : TEST EAX,EAX
00a58c71 : JZ 0x00a58e0b
00a58c77 : CMP byte ptr [EAX + 0x34],0x1
00a58c7b : JNZ 0x00a58e0b
00a58c81 : POP EDI
00a58c82 : POP ESI
00a58c83 : MOV dword ptr [EAX + 0x30],0x2
00a58c8a : XOR AL,AL
00a58c8c : POP EBX
00a58c8d : POP EBP
00a58c8e : RET 0x10
00a58c91 : CMP dword ptr [EBP + 0x10],0xd
00a58c95 : JNZ 0x00a58e0b
00a58c9b : MOV ECX,dword ptr [0x00da9894]
00a58ca1 : MOV ESI,dword ptr [ECX]
00a58ca3 : MOV EAX,ESI
00a58ca5 : CALL 0x008eb390
00a58caa : MOV EDI,EAX
00a58cac : MOV EAX,ESI
00a58cae : CALL 0x008eb470
00a58cb3 : TEST EDI,EDI
00a58cb5 : JZ 0x00a58c04
00a58cbb : MOV EDX,dword ptr [EDI]
00a58cbd : MOV EAX,dword ptr [EDX + 0x3c]
00a58cc0 : MOV ECX,EDI
00a58cc2 : CALL EAX
00a58cc4 : POP EDI
00a58cc5 : POP ESI
00a58cc6 : XOR AL,AL
00a58cc8 : POP EBX
00a58cc9 : POP EBP
00a58cca : RET 0x10
00a58ccd : MOV EDI,dword ptr [EBP + 0x10]
00a58cd0 : PUSH EDI
00a58cd1 : LEA ESI,[EBX + -0x4]
00a58cd4 : CALL 0x00a49730
00a58cd9 : TEST AL,AL
00a58cdb : JNZ 0x00a58e0b
00a58ce1 : CMP EDI,0x50
00a58ce4 : JNZ 0x00a58e0b
00a58cea : PUSH 0x11
00a58cec : CALL dword ptr [0x00b8542c]
00a58cf2 : MOV ECX,0x8000
00a58cf7 : TEST CX,AX
00a58cfa : JZ 0x00a58e0b
00a58d00 : MOV EAX,[0x00da9b38]
00a58d05 : TEST EAX,EAX
00a58d07 : JZ 0x00a58d0f
00a58d09 : PUSH EAX
00a58d0a : CALL 0x0070bca0
00a58d0f : CALL 0x007f5970
00a58d14 : POP EDI
00a58d15 : POP ESI
00a58d16 : XOR AL,AL
00a58d18 : POP EBX
00a58d19 : POP EBP
00a58d1a : RET 0x10
00a58d1d : MOV EAX,dword ptr [EBX + 0x74]
00a58d20 : SUB EAX,0x3
00a58d23 : JZ 0x00a58e0b
00a58d29 : SUB EAX,0x1
00a58d2c : JNZ 0x00a58e0b
00a58d32 : MOVZX EDI,word ptr [EBP + 0x14]
00a58d36 : LEA ESI,[EBX + -0x4]
00a58d39 : CALL 0x00a49a30
00a58d3e : POP EDI
00a58d3f : POP ESI
00a58d40 : XOR AL,AL
00a58d42 : POP EBX
00a58d43 : POP EBP
00a58d44 : RET 0x10
00a58d47 : ADD ESI,0xfffffdff
00a58d4d : CMP ESI,0x9
00a58d50 : JA 0x00a58e0b
00a58d56 : MOVZX EDX,byte ptr [ESI + 0xa58e3c]
00a58d5d : JMP dword ptr [EDX*0x4 + 0xa58e28]
00a58d64 : MOV EAX,dword ptr [EBX + 0x74]
00a58d67 : SUB EAX,0x2
00a58d6a : JZ 0x00a58e0b
00a58d70 : SUB EAX,0x1
00a58d73 : JZ 0x00a58e0b
00a58d79 : SUB EAX,0x1
00a58d7c : JNZ 0x00a58e0b
00a58d82 : MOV ECX,dword ptr [EBX + 0x48]
00a58d85 : TEST ECX,ECX
00a58d87 : JZ 0x00a58e0b
00a58d8d : MOV EAX,dword ptr [ECX]
00a58d8f : MOV EDX,dword ptr [EAX]
00a58d91 : PUSH 0xcc9dcc
00a58d96 : CALL EDX
00a58d98 : MOV ECX,0xcc9dd8
00a58d9d : LEA ECX,[ECX]
00a58da0 : MOV DL,byte ptr [EAX]
00a58da2 : CMP DL,byte ptr [ECX]
00a58da4 : JNZ 0x00a58dc0
00a58da6 : TEST DL,DL
00a58da8 : JZ 0x00a58dbc
00a58daa : MOV DL,byte ptr [EAX + 0x1]
00a58dad : CMP DL,byte ptr [ECX + 0x1]
00a58db0 : JNZ 0x00a58dc0
00a58db2 : ADD EAX,0x2
00a58db5 : ADD ECX,0x2
00a58db8 : TEST DL,DL
00a58dba : JNZ 0x00a58da0
00a58dbc : XOR EAX,EAX
00a58dbe : JMP 0x00a58dc5
00a58dc0 : SBB EAX,EAX
00a58dc2 : SBB EAX,-0x1
00a58dc5 : TEST EAX,EAX
00a58dc7 : JNZ 0x00a58e0b
00a58dc9 : MOVZX EAX,word ptr [EBP + 0x14]
00a58dcd : POP EDI
00a58dce : MOV dword ptr [EBX + 0x24],EAX
00a58dd1 : POP ESI
00a58dd2 : MOV dword ptr [EBX + 0x20],0x1
00a58dd9 : XOR AL,AL
00a58ddb : POP EBX
00a58ddc : POP EBP
00a58ddd : RET 0x10
00a58de0 : CMP dword ptr [EBX + 0x74],0x4
00a58de4 : JNZ 0x00a58e0b
00a58de6 : MOVZX ECX,word ptr [EBP + 0x14]
00a58dea : POP EDI
00a58deb : POP ESI
00a58dec : MOV dword ptr [EBX + 0x20],0x0
00a58df3 : MOV dword ptr [EBX + 0x24],ECX
00a58df6 : XOR AL,AL
00a58df8 : POP EBX
00a58df9 : POP EBP
00a58dfa : RET 0x10
00a58dfd : MOV EAX,dword ptr [EBP + 0x10]
00a58e00 : SHR EAX,0x10
00a58e03 : LEA ESI,[EBX + -0x4]
00a58e06 : CALL 0x00a495c0
00a58e0b : POP EDI
00a58e0c : POP ESI
00a58e0d : XOR AL,AL
00a58e0f : POP EBX
00a58e10 : POP EBP
00a58e11 : RET 0x10

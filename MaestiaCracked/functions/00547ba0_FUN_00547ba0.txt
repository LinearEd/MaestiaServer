PROGRAM  : Maestia.exe
FUNCTION : FUN_00547ba0
ENTRY    : 00547ba0
BODY     : [[00547ba0, 00547d07]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00547ba0(undefined4 param_1,uint param_2)

{
  undefined4 *puVar1;
  int *piVar2;
  undefined4 *puVar3;
  int iVar4;
  int *in_ECX;
  int iVar5;
  int iVar6;
  float10 fVar7;
  longlong local_c;
  int *local_4;
  
  iVar5 = 0;
  if (param_2 == 0) {
    FUN_00546a20();
    return;
  }
  local_4 = in_ECX;
  if (param_2 < 8) {
    iVar6 = 8;
  }
  else {
    fVar7 = (float10)FUN_0063b270();
    local_c = (longlong)ROUND((float)fVar7 / 0.6931472 + 1.0);
    iVar6 = 1 << ((byte)local_c & 0x1f);
  }
  local_c = CONCAT44(local_c._4_4_,0x144);
  puVar3 = (undefined4 *)FUN_00515840(iVar6 * 0xc + 8,&local_c);
  *puVar3 = 0;
  puVar3[1] = iVar6 + -1;
  if (iVar6 != 0) {
    iVar4 = 0;
    do {
      *(undefined4 *)(iVar4 + 8 + (int)puVar3) = 0xfffffffe;
      iVar4 = iVar4 + 0xc;
      iVar6 = iVar6 + -1;
    } while (iVar6 != 0);
  }
  if (*in_ECX != 0) {
    iVar6 = *(int *)(*in_ECX + 4) + 1;
    do {
      puVar1 = (undefined4 *)(iVar5 + 8 + *in_ECX);
      if (*(int *)(iVar5 + 8 + *in_ECX) != -2) {
        FUN_005481a0(param_1,puVar1 + 1,puVar1[1]);
        piVar2 = (int *)puVar1[2];
        if ((piVar2 != (int *)0x0) && (*piVar2 = *piVar2 + -1, *piVar2 == 0)) {
          FUN_00500860();
          FUN_00515cf0(piVar2);
        }
        *puVar1 = 0xfffffffe;
        in_ECX = local_4;
      }
      iVar5 = iVar5 + 0xc;
      iVar6 = iVar6 + -1;
    } while (iVar6 != 0);
    FUN_00515cf0(*in_ECX);
  }
  *in_ECX = (int)puVar3;
  FUN_00546a20();
  return;
}



============================================================
DISASSEMBLY
============================================================
00547ba0 : SUB ESP,0xc
00547ba3 : MOV EAX,dword ptr [ESP + 0x14]
00547ba7 : PUSH EBX
00547ba8 : PUSH EDI
00547ba9 : XOR EBX,EBX
00547bab : MOV EDI,ECX
00547bad : MOV dword ptr [ESP + 0x10],EDI
00547bb1 : CMP EAX,EBX
00547bb3 : JNZ 0x00547bc2
00547bb5 : CALL 0x00546a20
00547bba : POP EDI
00547bbb : POP EBX
00547bbc : ADD ESP,0xc
00547bbf : RET 0x8
00547bc2 : PUSH ESI
00547bc3 : CMP EAX,0x8
00547bc6 : JNC 0x00547bcf
00547bc8 : MOV ESI,0x8
00547bcd : JMP 0x00547c34
00547bcf : DEC EAX
00547bd0 : MOV dword ptr [ESP + 0x20],EAX
00547bd4 : FILD dword ptr [ESP + 0x20]
00547bd8 : TEST EAX,EAX
00547bda : JGE 0x00547be2
00547bdc : FADD float ptr [0x00cdf0e0]
00547be2 : CALL 0x0063b270
00547be7 : FSTP float ptr [ESP + 0x20]
00547beb : FLD float ptr [ESP + 0x20]
00547bef : MOV ESI,0x1
00547bf4 : FDIV double ptr [0x00b85fe0]
00547bfa : FSTP float ptr [ESP + 0x20]
00547bfe : FLD float ptr [ESP + 0x20]
00547c02 : FADD double ptr [0x00cdf108]
00547c08 : FSTP float ptr [ESP + 0x20]
00547c0c : FLD float ptr [ESP + 0x20]
00547c10 : FNSTCW word ptr [ESP + 0x20]
00547c14 : MOVZX EAX,word ptr [ESP + 0x20]
00547c19 : OR EAX,0xc00
00547c1e : MOV dword ptr [ESP + 0xc],EAX
00547c22 : FLDCW word ptr [ESP + 0xc]
00547c26 : FISTP qword ptr [ESP + 0xc]
00547c2a : MOV CL,byte ptr [ESP + 0xc]
00547c2e : SHL ESI,CL
00547c30 : FLDCW word ptr [ESP + 0x20]
00547c34 : LEA EAX,[ESP + 0xc]
00547c38 : LEA ECX,[ESI + ESI*0x2]
00547c3b : LEA EDX,[ECX*0x4 + 0x8]
00547c42 : MOV ECX,dword ptr [ESP + 0x1c]
00547c46 : PUSH EAX
00547c47 : PUSH EDX
00547c48 : MOV dword ptr [ESP + 0x28],EBX
00547c4c : MOV dword ptr [ESP + 0x14],0x144
00547c54 : CALL 0x00515840
00547c59 : MOV dword ptr [ESP + 0x20],EAX
00547c5d : MOV dword ptr [EAX],EBX
00547c5f : MOV ECX,dword ptr [ESP + 0x20]
00547c63 : LEA EAX,[ESI + -0x1]
00547c66 : MOV dword ptr [ECX + 0x4],EAX
00547c69 : CMP ESI,EBX
00547c6b : JBE 0x00547c84
00547c6d : XOR EAX,EAX
00547c6f : NOP
00547c70 : MOV EDX,dword ptr [ESP + 0x20]
00547c74 : MOV dword ptr [EAX + EDX*0x1 + 0x8],0xfffffffe
00547c7c : ADD EAX,0xc
00547c7f : SUB ESI,0x1
00547c82 : JNZ 0x00547c70
00547c84 : MOV EAX,dword ptr [EDI]
00547c86 : CMP EAX,EBX
00547c88 : JZ 0x00547ce8
00547c8a : MOV EAX,dword ptr [EAX + 0x4]
00547c8d : PUSH EBP
00547c8e : LEA EBP,[EAX + 0x1]
00547c91 : MOV EAX,dword ptr [EDI]
00547c93 : CMP dword ptr [EBX + EAX*0x1 + 0x8],-0x2
00547c98 : LEA ESI,[EBX + EAX*0x1 + 0x8]
00547c9c : JZ 0x00547cd7
00547c9e : MOV ECX,dword ptr [ESI + 0x4]
00547ca1 : MOV EDX,dword ptr [ESP + 0x20]
00547ca5 : LEA EAX,[ESI + 0x4]
00547ca8 : PUSH ECX
00547ca9 : PUSH EAX
00547caa : PUSH EDX
00547cab : LEA ECX,[ESP + 0x30]
00547caf : CALL 0x005481a0
00547cb4 : MOV EDI,dword ptr [ESI + 0x8]
00547cb7 : TEST EDI,EDI
00547cb9 : JZ 0x00547ccd
00547cbb : ADD dword ptr [EDI],-0x1
00547cbe : JNZ 0x00547ccd
00547cc0 : MOV ECX,EDI
00547cc2 : CALL 0x00500860
00547cc7 : PUSH EDI
00547cc8 : CALL 0x00515cf0
00547ccd : MOV EDI,dword ptr [ESP + 0x18]
00547cd1 : MOV dword ptr [ESI],0xfffffffe
00547cd7 : ADD EBX,0xc
00547cda : SUB EBP,0x1
00547cdd : JNZ 0x00547c91
00547cdf : MOV EAX,dword ptr [EDI]
00547ce1 : PUSH EAX
00547ce2 : CALL 0x00515cf0
00547ce7 : POP EBP
00547ce8 : MOV ECX,dword ptr [ESP + 0x20]
00547cec : MOV dword ptr [EDI],ECX
00547cee : LEA ECX,[ESP + 0x20]
00547cf2 : MOV dword ptr [ESP + 0x20],0x0
00547cfa : CALL 0x00546a20
00547cff : POP ESI
00547d00 : POP EDI
00547d01 : POP EBX
00547d02 : ADD ESP,0xc
00547d05 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_00571aa0
ENTRY    : 00571aa0
BODY     : [[00571aa0, 00571b53]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00571aa0(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  LONG LVar2;
  GRefCountImpl *this;
  int in_ECX;
  uint uVar3;
  uint local_4;
  
  local_4 = 0;
  iVar1 = FUN_00515840(0x68,0);
  if (iVar1 == 0) {
    iVar1 = 0;
  }
  else {
    FUN_0051c480(param_2);
    iVar1 = FUN_0056eb10(&local_4,param_3,1,0);
    uVar3 = local_4 & 0xfffffffc;
    LVar2 = InterlockedExchangeAdd((LONG *)(uVar3 + 4),-1);
    if (LVar2 == 1) {
      FUN_00515cf0(uVar3);
    }
  }
  if (iVar1 != 0) {
    FUN_005271c0(param_1);
    this = (GRefCountImpl *)(**(code **)(*(int *)(in_ECX + 8) + 0xc))(0x17);
    if (this != (GRefCountImpl *)0x0) {
      GRefCountImpl::Release(this);
      FUN_00571350(iVar1);
      return;
    }
    FUN_0056a440(iVar1);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00571aa0 : PUSH ECX
00571aa1 : PUSH EBX
00571aa2 : PUSH ESI
00571aa3 : PUSH EDI
00571aa4 : XOR EBX,EBX
00571aa6 : MOV EDI,ECX
00571aa8 : PUSH EBX
00571aa9 : MOV dword ptr [ESP + 0x10],EBX
00571aad : MOV ECX,dword ptr [EDI + 0x14]
00571ab0 : PUSH 0x68
00571ab2 : CALL 0x00515840
00571ab7 : MOV ESI,EAX
00571ab9 : TEST ESI,ESI
00571abb : JZ 0x00571ae8
00571abd : MOV EAX,dword ptr [ESP + 0x18]
00571ac1 : PUSH EAX
00571ac2 : LEA ECX,[ESP + 0x10]
00571ac6 : CALL 0x0051c480
00571acb : MOV ECX,dword ptr [ESP + 0x1c]
00571acf : PUSH 0x0
00571ad1 : MOV EBX,0x1
00571ad6 : PUSH EBX
00571ad7 : PUSH ECX
00571ad8 : LEA EDX,[ESP + 0x18]
00571adc : PUSH EDX
00571add : MOV ECX,ESI
00571adf : CALL 0x0056eb10
00571ae4 : MOV ESI,EAX
00571ae6 : JMP 0x00571aea
00571ae8 : XOR ESI,ESI
00571aea : TEST BL,0x1
00571aed : JZ 0x00571b0d
00571aef : MOV EBX,dword ptr [ESP + 0xc]
00571af3 : AND EBX,0xfffffffc
00571af6 : PUSH -0x1
00571af8 : LEA EAX,[EBX + 0x4]
00571afb : PUSH EAX
00571afc : CALL dword ptr [0x00b851cc]
00571b02 : SUB EAX,0x1
00571b05 : JNZ 0x00571b0d
00571b07 : PUSH EBX
00571b08 : CALL 0x00515cf0
00571b0d : TEST ESI,ESI
00571b0f : JZ 0x00571b4d
00571b11 : MOV ECX,dword ptr [ESP + 0x14]
00571b15 : PUSH ECX
00571b16 : LEA ECX,[ESI + 0x2c]
00571b19 : CALL 0x005271c0
00571b1e : MOV EDX,dword ptr [EDI + 0x8]
00571b21 : MOV EAX,dword ptr [EDX + 0xc]
00571b24 : LEA ECX,[EDI + 0x8]
00571b27 : PUSH 0x17
00571b29 : CALL EAX
00571b2b : TEST EAX,EAX
00571b2d : JZ 0x00571b45
00571b2f : MOV ECX,EAX
00571b31 : CALL 0x004ff7e0
00571b36 : PUSH ESI
00571b37 : MOV ECX,EDI
00571b39 : CALL 0x00571350
00571b3e : POP EDI
00571b3f : POP ESI
00571b40 : POP EBX
00571b41 : POP ECX
00571b42 : RET 0xc
00571b45 : PUSH ESI
00571b46 : MOV ECX,EDI
00571b48 : CALL 0x0056a440
00571b4d : POP EDI
00571b4e : POP ESI
00571b4f : POP EBX
00571b50 : POP ECX
00571b51 : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_00a62b90
ENTRY    : 00a62b90
BODY     : [[00a62b90, 00a62bab] [00a62bb0, 00a62dec]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a62b90(int param_1)

{
  void *_Str;
  uint _Offset;
  long lVar1;
  void *_Str_00;
  long _Offset_00;
  FILE *unaff_ESI;
  int local_2c;
  long local_28;
  int local_24;
  int local_20;
  int local_1c;
  long local_18;
  uint local_14;
  undefined4 *local_10;
  long local_c;
  uint local_8;
  
  local_10 = *(undefined4 **)(param_1 + 0x3c);
  if (local_10 != *(undefined4 **)(param_1 + 0x40)) {
    do {
      _Str = (void *)*local_10;
      local_14 = 0x20101000;
      local_28 = _ftell(unaff_ESI);
      _fwrite(&local_14,4,1,unaff_ESI);
      local_18 = _ftell(unaff_ESI);
      _fwrite(&local_18,4,1,unaff_ESI);
      local_14 = 0x20101100;
      local_c = _ftell(unaff_ESI);
      _fwrite(&local_14,4,1,unaff_ESI);
      local_8 = _ftell(unaff_ESI);
      _fwrite(&local_8,4,1,unaff_ESI);
      _fwrite(_Str,2,1,unaff_ESI);
      local_14 = local_8;
      lVar1 = _ftell(unaff_ESI);
      _fseek(unaff_ESI,local_14,0);
      local_1c = lVar1 - local_c;
      _fwrite(&local_1c,4,1,unaff_ESI);
      _fseek(unaff_ESI,lVar1,0);
      local_14 = 0x20101101;
      local_c = _ftell(unaff_ESI);
      _fwrite(&local_14,4,1,unaff_ESI);
      local_8 = _ftell(unaff_ESI);
      _fwrite(&local_8,4,1,unaff_ESI);
      local_14 = (uint)*(ushort *)((int)_Str + 0x18);
      _fwrite(&local_14,2,1,unaff_ESI);
      if (*(uint *)((int)_Str + 0x1c) < 8) {
        _Str_00 = (void *)((int)_Str + 8);
      }
      else {
        _Str_00 = *(void **)((int)_Str + 8);
      }
      _fwrite(_Str_00,2,local_14 & 0xffff,unaff_ESI);
      local_14 = local_8;
      lVar1 = _ftell(unaff_ESI);
      _fseek(unaff_ESI,local_14,0);
      local_20 = lVar1 - local_c;
      _fwrite(&local_20,4,1,unaff_ESI);
      _fseek(unaff_ESI,lVar1,0);
      local_14 = 0x20101102;
      local_c = _ftell(unaff_ESI);
      _fwrite(&local_14,4,1,unaff_ESI);
      local_8 = _ftell(unaff_ESI);
      _fwrite(&local_8,4,1,unaff_ESI);
      _fwrite((ushort *)((int)_Str + 0x20),2,1,unaff_ESI);
      _fwrite(*(void **)((int)_Str + 0x24),4,(uint)*(ushort *)((int)_Str + 0x20),unaff_ESI);
      _Offset = local_8;
      lVar1 = _ftell(unaff_ESI);
      _fseek(unaff_ESI,_Offset,0);
      local_24 = lVar1 - local_c;
      _fwrite(&local_24,4,1,unaff_ESI);
      _fseek(unaff_ESI,lVar1,0);
      lVar1 = local_18;
      _Offset_00 = _ftell(unaff_ESI);
      _fseek(unaff_ESI,lVar1,0);
      local_2c = _Offset_00 - local_28;
      _fwrite(&local_2c,4,1,unaff_ESI);
      _fseek(unaff_ESI,_Offset_00,0);
      local_10 = local_10 + 1;
    } while (local_10 != *(undefined4 **)(param_1 + 0x40));
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00a62b90 : PUSH EBP
00a62b91 : MOV EBP,ESP
00a62b93 : SUB ESP,0x28
00a62b96 : MOV ECX,dword ptr [EBP + 0x8]
00a62b99 : MOV EAX,dword ptr [ECX + 0x3c]
00a62b9c : MOV dword ptr [EBP + -0xc],EAX
00a62b9f : CMP EAX,dword ptr [ECX + 0x40]
00a62ba2 : JZ 0x00a62de7
00a62ba8 : PUSH EBX
00a62ba9 : PUSH EDI
00a62baa : JMP 0x00a62bb3
00a62bb0 : MOV EAX,dword ptr [EBP + -0xc]
00a62bb3 : MOV EDI,dword ptr [EAX]
00a62bb5 : PUSH ESI
00a62bb6 : MOV dword ptr [EBP + -0x10],0x20101000
00a62bbd : CALL 0x0063751f
00a62bc2 : PUSH ESI
00a62bc3 : PUSH 0x1
00a62bc5 : MOV dword ptr [EBP + -0x24],EAX
00a62bc8 : LEA EAX,[EBP + -0x10]
00a62bcb : PUSH 0x4
00a62bcd : PUSH EAX
00a62bce : CALL 0x006376ef
00a62bd3 : PUSH ESI
00a62bd4 : CALL 0x0063751f
00a62bd9 : PUSH ESI
00a62bda : PUSH 0x1
00a62bdc : LEA ECX,[EBP + -0x14]
00a62bdf : PUSH 0x4
00a62be1 : PUSH ECX
00a62be2 : MOV dword ptr [EBP + -0x14],EAX
00a62be5 : CALL 0x006376ef
00a62bea : PUSH ESI
00a62beb : MOV dword ptr [EBP + -0x10],0x20101100
00a62bf2 : CALL 0x0063751f
00a62bf7 : PUSH ESI
00a62bf8 : PUSH 0x1
00a62bfa : LEA EDX,[EBP + -0x10]
00a62bfd : PUSH 0x4
00a62bff : PUSH EDX
00a62c00 : MOV dword ptr [EBP + -0x8],EAX
00a62c03 : CALL 0x006376ef
00a62c08 : PUSH ESI
00a62c09 : CALL 0x0063751f
00a62c0e : ADD ESP,0x40
00a62c11 : PUSH ESI
00a62c12 : PUSH 0x1
00a62c14 : MOV dword ptr [EBP + -0x4],EAX
00a62c17 : LEA EAX,[EBP + -0x4]
00a62c1a : PUSH 0x4
00a62c1c : PUSH EAX
00a62c1d : CALL 0x006376ef
00a62c22 : PUSH ESI
00a62c23 : PUSH 0x1
00a62c25 : PUSH 0x2
00a62c27 : PUSH EDI
00a62c28 : CALL 0x006376ef
00a62c2d : MOV ECX,dword ptr [EBP + -0x4]
00a62c30 : PUSH ESI
00a62c31 : MOV dword ptr [EBP + -0x10],ECX
00a62c34 : CALL 0x0063751f
00a62c39 : MOV EDX,dword ptr [EBP + -0x10]
00a62c3c : PUSH 0x0
00a62c3e : PUSH EDX
00a62c3f : PUSH ESI
00a62c40 : MOV EBX,EAX
00a62c42 : CALL 0x006377fb
00a62c47 : PUSH ESI
00a62c48 : PUSH 0x1
00a62c4a : MOV EAX,EBX
00a62c4c : SUB EAX,dword ptr [EBP + -0x8]
00a62c4f : LEA ECX,[EBP + -0x18]
00a62c52 : PUSH 0x4
00a62c54 : PUSH ECX
00a62c55 : MOV dword ptr [EBP + -0x18],EAX
00a62c58 : CALL 0x006376ef
00a62c5d : ADD ESP,0x40
00a62c60 : PUSH 0x0
00a62c62 : PUSH EBX
00a62c63 : PUSH ESI
00a62c64 : CALL 0x006377fb
00a62c69 : PUSH ESI
00a62c6a : MOV dword ptr [EBP + -0x10],0x20101101
00a62c71 : CALL 0x0063751f
00a62c76 : PUSH ESI
00a62c77 : PUSH 0x1
00a62c79 : LEA EDX,[EBP + -0x10]
00a62c7c : PUSH 0x4
00a62c7e : PUSH EDX
00a62c7f : MOV dword ptr [EBP + -0x8],EAX
00a62c82 : CALL 0x006376ef
00a62c87 : PUSH ESI
00a62c88 : CALL 0x0063751f
00a62c8d : PUSH ESI
00a62c8e : PUSH 0x1
00a62c90 : MOV dword ptr [EBP + -0x4],EAX
00a62c93 : LEA EAX,[EBP + -0x4]
00a62c96 : PUSH 0x4
00a62c98 : PUSH EAX
00a62c99 : CALL 0x006376ef
00a62c9e : MOVZX ECX,word ptr [EDI + 0x18]
00a62ca2 : PUSH ESI
00a62ca3 : PUSH 0x1
00a62ca5 : LEA EDX,[EBP + -0x10]
00a62ca8 : PUSH 0x2
00a62caa : PUSH EDX
00a62cab : MOV dword ptr [EBP + -0x10],ECX
00a62cae : CALL 0x006376ef
00a62cb3 : ADD ESP,0x44
00a62cb6 : CMP dword ptr [EDI + 0x1c],0x8
00a62cba : JC 0x00a62cc1
00a62cbc : MOV EAX,dword ptr [EDI + 0x8]
00a62cbf : JMP 0x00a62cc4
00a62cc1 : LEA EAX,[EDI + 0x8]
00a62cc4 : MOVZX ECX,word ptr [EBP + -0x10]
00a62cc8 : PUSH ESI
00a62cc9 : PUSH ECX
00a62cca : PUSH 0x2
00a62ccc : PUSH EAX
00a62ccd : CALL 0x006376ef
00a62cd2 : MOV EDX,dword ptr [EBP + -0x4]
00a62cd5 : PUSH ESI
00a62cd6 : MOV dword ptr [EBP + -0x10],EDX
00a62cd9 : CALL 0x0063751f
00a62cde : MOV EBX,EAX
00a62ce0 : MOV EAX,dword ptr [EBP + -0x10]
00a62ce3 : PUSH 0x0
00a62ce5 : PUSH EAX
00a62ce6 : PUSH ESI
00a62ce7 : CALL 0x006377fb
00a62cec : PUSH ESI
00a62ced : PUSH 0x1
00a62cef : MOV ECX,EBX
00a62cf1 : SUB ECX,dword ptr [EBP + -0x8]
00a62cf4 : LEA EDX,[EBP + -0x1c]
00a62cf7 : PUSH 0x4
00a62cf9 : PUSH EDX
00a62cfa : MOV dword ptr [EBP + -0x1c],ECX
00a62cfd : CALL 0x006376ef
00a62d02 : PUSH 0x0
00a62d04 : PUSH EBX
00a62d05 : PUSH ESI
00a62d06 : CALL 0x006377fb
00a62d0b : PUSH ESI
00a62d0c : MOV dword ptr [EBP + -0x10],0x20101102
00a62d13 : CALL 0x0063751f
00a62d18 : ADD ESP,0x40
00a62d1b : PUSH ESI
00a62d1c : PUSH 0x1
00a62d1e : MOV dword ptr [EBP + -0x8],EAX
00a62d21 : LEA EAX,[EBP + -0x10]
00a62d24 : PUSH 0x4
00a62d26 : PUSH EAX
00a62d27 : CALL 0x006376ef
00a62d2c : PUSH ESI
00a62d2d : CALL 0x0063751f
00a62d32 : PUSH ESI
00a62d33 : PUSH 0x1
00a62d35 : LEA ECX,[EBP + -0x4]
00a62d38 : PUSH 0x4
00a62d3a : PUSH ECX
00a62d3b : MOV dword ptr [EBP + -0x4],EAX
00a62d3e : CALL 0x006376ef
00a62d43 : PUSH ESI
00a62d44 : PUSH 0x1
00a62d46 : LEA EBX,[EDI + 0x20]
00a62d49 : PUSH 0x2
00a62d4b : PUSH EBX
00a62d4c : CALL 0x006376ef
00a62d51 : MOVZX EDX,word ptr [EBX]
00a62d54 : MOV EAX,dword ptr [EDI + 0x24]
00a62d57 : PUSH ESI
00a62d58 : PUSH EDX
00a62d59 : PUSH 0x4
00a62d5b : PUSH EAX
00a62d5c : CALL 0x006376ef
00a62d61 : MOV EBX,dword ptr [EBP + -0x4]
00a62d64 : ADD ESP,0x44
00a62d67 : PUSH ESI
00a62d68 : CALL 0x0063751f
00a62d6d : PUSH 0x0
00a62d6f : PUSH EBX
00a62d70 : PUSH ESI
00a62d71 : MOV EDI,EAX
00a62d73 : CALL 0x006377fb
00a62d78 : PUSH ESI
00a62d79 : PUSH 0x1
00a62d7b : MOV ECX,EDI
00a62d7d : SUB ECX,dword ptr [EBP + -0x8]
00a62d80 : LEA EDX,[EBP + -0x20]
00a62d83 : PUSH 0x4
00a62d85 : PUSH EDX
00a62d86 : MOV dword ptr [EBP + -0x20],ECX
00a62d89 : CALL 0x006376ef
00a62d8e : PUSH 0x0
00a62d90 : PUSH EDI
00a62d91 : PUSH ESI
00a62d92 : CALL 0x006377fb
00a62d97 : MOV EBX,dword ptr [EBP + -0x14]
00a62d9a : PUSH ESI
00a62d9b : CALL 0x0063751f
00a62da0 : PUSH 0x0
00a62da2 : PUSH EBX
00a62da3 : PUSH ESI
00a62da4 : MOV EDI,EAX
00a62da6 : CALL 0x006377fb
00a62dab : PUSH ESI
00a62dac : PUSH 0x1
00a62dae : MOV EAX,EDI
00a62db0 : SUB EAX,dword ptr [EBP + -0x24]
00a62db3 : LEA ECX,[EBP + -0x28]
00a62db6 : PUSH 0x4
00a62db8 : PUSH ECX
00a62db9 : MOV dword ptr [EBP + -0x28],EAX
00a62dbc : CALL 0x006376ef
00a62dc1 : ADD ESP,0x4c
00a62dc4 : PUSH 0x0
00a62dc6 : PUSH EDI
00a62dc7 : PUSH ESI
00a62dc8 : CALL 0x006377fb
00a62dcd : MOV EAX,dword ptr [EBP + -0xc]
00a62dd0 : MOV EDX,dword ptr [EBP + 0x8]
00a62dd3 : ADD EAX,0x4
00a62dd6 : ADD ESP,0xc
00a62dd9 : MOV dword ptr [EBP + -0xc],EAX
00a62ddc : CMP EAX,dword ptr [EDX + 0x40]
00a62ddf : JNZ 0x00a62bb0
00a62de5 : POP EDI
00a62de6 : POP EBX
00a62de7 : MOV ESP,EBP
00a62de9 : POP EBP
00a62dea : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_004604f0
ENTRY    : 004604f0
BODY     : [[004604f0, 00460529] [00460530, 004606be]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_004604f0(int param_1,int *param_2,int param_3,int *param_4)

{
  int *piVar1;
  int *piVar2;
  uint uVar3;
  uint uVar4;
  float fVar5;
  float fVar6;
  char cVar7;
  int iVar8;
  ushort *puVar9;
  int iVar10;
  ushort *puVar11;
  uint uVar12;
  int *piVar13;
  int iVar14;
  
  iVar10 = param_3;
  iVar8 = FUN_0044f3f0();
  piVar13 = *(int **)(*(int *)(param_1 + 0x14) + 4 + iVar8 * 4);
  piVar2 = *(int **)(*(int *)(param_1 + 0x14) + iVar8 * 4);
  iVar14 = iVar10;
  if (piVar13 != piVar2) {
    uVar3 = *(uint *)(iVar10 + 0x14);
    do {
      piVar13 = (int *)piVar13[1];
      uVar4 = piVar13[7];
      if ((uint)piVar13[8] < 8) {
        puVar9 = (ushort *)(piVar13 + 3);
      }
      else {
        puVar9 = (ushort *)piVar13[3];
      }
      uVar12 = uVar3;
      if (uVar4 <= uVar3) {
        uVar12 = uVar4;
      }
      if (*(uint *)(iVar10 + 0x18) < 8) {
        puVar11 = (ushort *)(param_3 + 4);
      }
      else {
        puVar11 = *(ushort **)(param_3 + 4);
      }
      for (; uVar12 != 0; uVar12 = uVar12 - 1) {
        if (*puVar11 != *puVar9) {
          uVar12 = (-(uint)(*puVar11 < *puVar9) & 0xfffffffe) + 1;
          if (uVar12 != 0) goto LAB_00460588;
          break;
        }
        puVar11 = puVar11 + 1;
        puVar9 = puVar9 + 1;
      }
      if (uVar4 <= uVar3) {
        uVar12 = (uint)(uVar3 != uVar4);
LAB_00460588:
        if (-1 < (int)uVar12) {
          cVar7 = FUN_0042be00();
          if (cVar7 == '\0') {
            if (param_4 != *(int **)(param_1 + 8)) {
              FUN_004606e0(&param_3,param_4);
            }
            *param_2 = (int)piVar13;
            *(undefined1 *)(param_2 + 1) = 0;
            return;
          }
          piVar13 = (int *)*piVar13;
          iVar14 = param_3;
          break;
        }
      }
      iVar14 = param_3;
    } while (piVar13 != piVar2);
  }
  if (param_4 == *(int **)(param_1 + 8)) {
    iVar10 = FUN_00460f20(piVar13,piVar13[1],iVar14);
    FUN_00460fe0();
    piVar13[1] = iVar10;
    **(int **)(iVar10 + 4) = iVar10;
    param_4 = (int *)piVar13[1];
  }
  else if (((param_4 != *(int **)(param_1 + 8)) && (piVar13 != param_4)) &&
          (piVar13 != (int *)*param_4)) {
    FUN_00460e20(piVar13,param_4,(int *)*param_4);
  }
  piVar1 = *(int **)(*(int *)(param_1 + 0x14) + iVar8 * 4);
  piVar2 = (int *)(*(int *)(param_1 + 0x14) + iVar8 * 4);
  while ((piVar13 == piVar1 && (*piVar2 = (int)param_4, iVar8 != 0))) {
    iVar8 = iVar8 + -1;
    piVar1 = *(int **)(*(int *)(param_1 + 0x14) + iVar8 * 4);
    piVar2 = (int *)(*(int *)(param_1 + 0x14) + iVar8 * 4);
  }
  fVar5 = (float)*(int *)(param_1 + 0xc);
  if (*(int *)(param_1 + 0xc) < 0) {
    fVar5 = fVar5 + 4.2949673e+09;
  }
  fVar6 = (float)*(int *)(param_1 + 0x24);
  if (*(int *)(param_1 + 0x24) < 0) {
    fVar6 = fVar6 + 4.2949673e+09;
  }
  if (*(float *)(param_1 + 0x28) < fVar5 / fVar6) {
    FUN_00460890();
  }
  *param_2 = (int)param_4;
  *(undefined1 *)(param_2 + 1) = 1;
  return;
}



============================================================
DISASSEMBLY
============================================================
004604f0 : PUSH EBP
004604f1 : MOV EBP,ESP
004604f3 : SUB ESP,0x14
004604f6 : PUSH EBX
004604f7 : PUSH ESI
004604f8 : MOV ESI,dword ptr [EBP + 0x8]
004604fb : PUSH EDI
004604fc : MOV EDI,dword ptr [EBP + 0x10]
004604ff : MOV EAX,EDI
00460501 : CALL 0x0044f3f0
00460506 : MOV ECX,dword ptr [ESI + 0x14]
00460509 : MOV EBX,dword ptr [ECX + EAX*0x4 + 0x4]
0046050d : MOV dword ptr [EBP + -0x10],EAX
00460510 : LEA EAX,[ECX + EAX*0x4]
00460513 : MOV EAX,dword ptr [EAX]
00460515 : MOV dword ptr [EBP + -0xc],EAX
00460518 : CMP EBX,EAX
0046051a : JZ 0x00460594
0046051c : MOV EDX,dword ptr [EDI + 0x14]
0046051f : MOV EAX,dword ptr [EDI + 0x18]
00460522 : MOV dword ptr [EBP + -0x4],EDX
00460525 : MOV dword ptr [EBP + -0x8],EAX
00460528 : JMP 0x00460533
00460530 : MOV EDX,dword ptr [EBP + -0x4]
00460533 : MOV EBX,dword ptr [EBX + 0x4]
00460536 : CMP dword ptr [EBX + 0x20],0x8
0046053a : MOV EDI,dword ptr [EBX + 0x1c]
0046053d : JC 0x00460544
0046053f : MOV EAX,dword ptr [EBX + 0xc]
00460542 : JMP 0x00460547
00460544 : LEA EAX,[EBX + 0xc]
00460547 : CMP EDX,EDI
00460549 : JC 0x0046054d
0046054b : MOV EDX,EDI
0046054d : CMP dword ptr [EBP + -0x8],0x8
00460551 : MOV ECX,dword ptr [EBP + 0x10]
00460554 : JC 0x0046055b
00460556 : MOV ECX,dword ptr [ECX + 0x4]
00460559 : JMP 0x0046055e
0046055b : ADD ECX,0x4
0046055e : TEST EDX,EDX
00460560 : JBE 0x00460578
00460562 : MOV SI,word ptr [ECX]
00460565 : CMP SI,word ptr [EAX]
00460568 : JNZ 0x004605d9
0046056a : ADD ECX,0x2
0046056d : ADD EAX,0x2
00460570 : SUB EDX,0x1
00460573 : JNZ 0x00460562
00460575 : MOV ESI,dword ptr [EBP + 0x8]
00460578 : MOV EAX,dword ptr [EBP + -0x4]
0046057b : CMP EAX,EDI
0046057d : JC 0x0046058c
0046057f : XOR ECX,ECX
00460581 : CMP EAX,EDI
00460583 : SETNZ CL
00460586 : MOV EAX,ECX
00460588 : TEST EAX,EAX
0046058a : JGE 0x004605ee
0046058c : CMP EBX,dword ptr [EBP + -0xc]
0046058f : JNZ 0x00460530
00460591 : MOV EDI,dword ptr [EBP + 0x10]
00460594 : MOV ECX,dword ptr [EBP + 0x14]
00460597 : CMP ECX,dword ptr [ESI + 0x8]
0046059a : JZ 0x00460628
004605a0 : CMP ECX,dword ptr [ESI + 0x8]
004605a3 : LEA EDX,[ESI + 0x4]
004605a6 : JZ 0x00460650
004605ac : MOV EAX,dword ptr [ECX]
004605ae : CMP EDX,EDX
004605b0 : JNZ 0x004605c2
004605b2 : CMP EBX,ECX
004605b4 : JZ 0x00460650
004605ba : CMP EBX,EAX
004605bc : JZ 0x00460650
004605c2 : PUSH EAX
004605c3 : PUSH ECX
004605c4 : PUSH EBX
004605c5 : MOV EDI,0x1
004605ca : MOV ESI,EDX
004605cc : CALL 0x00460e20
004605d1 : MOV ECX,dword ptr [EBP + 0x14]
004605d4 : MOV ESI,dword ptr [EBP + 0x8]
004605d7 : JMP 0x00460650
004605d9 : MOV DX,SI
004605dc : CMP DX,word ptr [EAX]
004605df : SBB EAX,EAX
004605e1 : AND EAX,0xfffffffe
004605e4 : ADD EAX,0x1
004605e7 : JZ 0x00460575
004605e9 : MOV ESI,dword ptr [EBP + 0x8]
004605ec : JMP 0x00460588
004605ee : MOV EAX,dword ptr [EBP + 0x10]
004605f1 : LEA ECX,[EBX + 0x8]
004605f4 : CALL 0x0042be00
004605f9 : TEST AL,AL
004605fb : JZ 0x00460601
004605fd : MOV EBX,dword ptr [EBX]
004605ff : JMP 0x00460591
00460601 : MOV EAX,dword ptr [EBP + 0x14]
00460604 : CMP EAX,dword ptr [ESI + 0x8]
00460607 : JZ 0x00460616
00460609 : PUSH EAX
0046060a : LEA EDX,[EBP + 0x10]
0046060d : PUSH EDX
0046060e : LEA EDI,[ESI + 0x4]
00460611 : CALL 0x004606e0
00460616 : MOV EAX,dword ptr [EBP + 0xc]
00460619 : MOV dword ptr [EAX],EBX
0046061b : MOV byte ptr [EAX + 0x4],0x0
0046061f : POP EDI
00460620 : POP ESI
00460621 : POP EBX
00460622 : MOV ESP,EBP
00460624 : POP EBP
00460625 : RET 0x10
00460628 : MOV EAX,dword ptr [EBX + 0x4]
0046062b : PUSH EDI
0046062c : PUSH EAX
0046062d : PUSH EBX
0046062e : CALL 0x00460f20
00460633 : LEA EDX,[ESI + 0x4]
00460636 : MOV ECX,0x1
0046063b : MOV EDI,EAX
0046063d : CALL 0x00460fe0
00460642 : MOV dword ptr [EBX + 0x4],EDI
00460645 : MOV ECX,dword ptr [EDI + 0x4]
00460648 : MOV dword ptr [ECX],EDI
0046064a : MOV ECX,dword ptr [EBX + 0x4]
0046064d : MOV dword ptr [EBP + 0x14],ECX
00460650 : MOV EAX,dword ptr [ESI + 0x14]
00460653 : MOV EDX,dword ptr [EBP + -0x10]
00460656 : CMP EBX,dword ptr [EAX + EDX*0x4]
00460659 : LEA EAX,[EAX + EDX*0x4]
0046065c : JNZ 0x00460678
0046065e : JMP 0x00460663
00460660 : MOV ECX,dword ptr [EBP + 0x14]
00460663 : MOV dword ptr [EAX],ECX
00460665 : TEST EDX,EDX
00460667 : JZ 0x00460675
00460669 : MOV ECX,dword ptr [ESI + 0x14]
0046066c : DEC EDX
0046066d : CMP EBX,dword ptr [ECX + EDX*0x4]
00460670 : LEA EAX,[ECX + EDX*0x4]
00460673 : JZ 0x00460660
00460675 : MOV ECX,dword ptr [EBP + 0x14]
00460678 : MOV EDX,dword ptr [ESI + 0xc]
0046067b : FILD dword ptr [ESI + 0xc]
0046067e : TEST EDX,EDX
00460680 : JGE 0x00460688
00460682 : FADD float ptr [0x00cdf0e0]
00460688 : MOV EAX,dword ptr [ESI + 0x24]
0046068b : FILD dword ptr [ESI + 0x24]
0046068e : TEST EAX,EAX
00460690 : JGE 0x00460698
00460692 : FADD float ptr [0x00cdf0e0]
00460698 : FDIVP
0046069a : FLD float ptr [ESI + 0x28]
0046069d : FXCH
0046069f : FCOMIP ST0,ST1
004606a1 : FSTP ST0
004606a3 : JBE 0x004606ad
004606a5 : CALL 0x00460890
004606aa : MOV ECX,dword ptr [EBP + 0x14]
004606ad : MOV EAX,dword ptr [EBP + 0xc]
004606b0 : POP EDI
004606b1 : POP ESI
004606b2 : MOV dword ptr [EAX],ECX
004606b4 : MOV byte ptr [EAX + 0x4],0x1
004606b8 : POP EBX
004606b9 : MOV ESP,EBP
004606bb : POP EBP
004606bc : RET 0x10

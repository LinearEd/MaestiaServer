PROGRAM  : Maestia.exe
FUNCTION : FUN_005af610
ENTRY    : 005af610
BODY     : [[005af610, 005af6c8]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005af610(int *param_1)

{
  int iVar1;
  uint uVar2;
  int in_ECX;
  uint uVar3;
  int *piVar4;
  int local_1c;
  int local_18;
  int local_14;
  uint local_10;
  int local_c;
  int *local_8;
  int local_4;
  
  local_14 = *param_1;
  local_10 = 0;
  local_1c = 0;
  local_18 = 0;
  if (param_1[1] != 0) {
    do {
      if ((*(char *)(local_14 + local_10) == '\0') || (*(char *)(local_14 + local_10) == ':'))
      break;
      local_10 = local_10 + 1;
    } while (local_10 < (uint)param_1[1]);
  }
  iVar1 = *(int *)(in_ECX + 4);
  piVar4 = (int *)0x0;
  if (*(int *)(iVar1 + 0x14) != 0) {
    local_8 = &local_14;
    local_4 = in_ECX + 0xc;
    local_c = iVar1;
    piVar4 = (int *)(**(code **)(**(int **)(iVar1 + 0x14) + 4))(&local_c);
  }
  uVar2 = param_1[1];
  uVar3 = local_10 + 1;
  if (uVar2 < local_10 + 1) {
    uVar3 = uVar2;
  }
  local_1c = *param_1 + uVar3;
  local_18 = uVar2 - uVar3;
  if (piVar4 != (int *)0x0) {
    if (local_18 != 0) {
      (**(code **)(*piVar4 + 8))(&local_1c);
    }
    FUN_005ae8a0(in_ECX,piVar4,1);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005af610 : SUB ESP,0x1c
005af613 : PUSH EBP
005af614 : MOV EBP,dword ptr [ESP + 0x24]
005af618 : MOV EDX,dword ptr [EBP]
005af61b : PUSH ESI
005af61c : MOV ESI,dword ptr [EBP + 0x4]
005af61f : XOR EAX,EAX
005af621 : PUSH EDI
005af622 : MOV EDI,ECX
005af624 : MOV dword ptr [ESP + 0xc],0x0
005af62c : MOV dword ptr [ESP + 0x10],0x0
005af634 : TEST ESI,ESI
005af636 : JBE 0x005af649
005af638 : MOV CL,byte ptr [EDX + EAX*0x1]
005af63b : TEST CL,CL
005af63d : JZ 0x005af649
005af63f : CMP CL,0x3a
005af642 : JZ 0x005af649
005af644 : INC EAX
005af645 : CMP EAX,ESI
005af647 : JC 0x005af638
005af649 : MOV dword ptr [ESP + 0x18],EAX
005af64d : MOV EAX,dword ptr [EDI + 0x4]
005af650 : XOR ESI,ESI
005af652 : MOV dword ptr [ESP + 0x14],EDX
005af656 : CMP dword ptr [EAX + 0x14],ESI
005af659 : JZ 0x005af681
005af65b : LEA ECX,[ESP + 0x14]
005af65f : MOV dword ptr [ESP + 0x20],ECX
005af663 : LEA EDX,[EDI + 0xc]
005af666 : MOV dword ptr [ESP + 0x24],EDX
005af66a : MOV dword ptr [ESP + 0x1c],EAX
005af66e : MOV EAX,dword ptr [EAX + 0x14]
005af671 : MOV EDX,dword ptr [EAX]
005af673 : MOV EDX,dword ptr [EDX + 0x4]
005af676 : LEA ECX,[ESP + 0x1c]
005af67a : PUSH ECX
005af67b : MOV ECX,EAX
005af67d : CALL EDX
005af67f : MOV ESI,EAX
005af681 : MOV EDX,dword ptr [ESP + 0x18]
005af685 : MOV EAX,dword ptr [EBP + 0x4]
005af688 : INC EDX
005af689 : CMP EAX,EDX
005af68b : JNC 0x005af68f
005af68d : MOV EDX,EAX
005af68f : MOV ECX,dword ptr [EBP]
005af692 : ADD ECX,EDX
005af694 : SUB EAX,EDX
005af696 : MOV dword ptr [ESP + 0xc],ECX
005af69a : MOV dword ptr [ESP + 0x10],EAX
005af69e : TEST ESI,ESI
005af6a0 : JZ 0x005af6c0
005af6a2 : TEST EAX,EAX
005af6a4 : JBE 0x005af6b4
005af6a6 : MOV EAX,dword ptr [ESI]
005af6a8 : MOV EDX,dword ptr [EAX + 0x8]
005af6ab : LEA ECX,[ESP + 0xc]
005af6af : PUSH ECX
005af6b0 : MOV ECX,ESI
005af6b2 : CALL EDX
005af6b4 : MOV ECX,dword ptr [EDI + 0x4]
005af6b7 : PUSH 0x1
005af6b9 : PUSH ESI
005af6ba : PUSH EDI
005af6bb : CALL 0x005ae8a0
005af6c0 : POP EDI
005af6c1 : POP ESI
005af6c2 : POP EBP
005af6c3 : ADD ESP,0x1c
005af6c6 : RET 0x4

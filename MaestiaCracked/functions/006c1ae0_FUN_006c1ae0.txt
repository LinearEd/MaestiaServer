PROGRAM  : Maestia.exe
FUNCTION : FUN_006c1ae0
ENTRY    : 006c1ae0
BODY     : [[006c1ae0, 006c1b09] [006c1b10, 006c1b39] [006c1b40, 006c1c14]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_006c1ae0(uint param_1,byte *param_2,uint param_3)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  int iVar15;
  int iVar16;
  int iVar17;
  uint uVar18;
  
  uVar2 = param_1 & 0xffff;
  param_1 = param_1 >> 0x10;
  if (param_2 == (byte *)0x0) {
    return 1;
  }
  while (param_3 != 0) {
    uVar1 = param_3;
    if (0x15af < param_3) {
      uVar1 = 0x15b0;
    }
    param_3 = param_3 - uVar1;
    if (0xf < (int)uVar1) {
      uVar18 = uVar1 >> 4;
      uVar1 = uVar1 + uVar18 * -0x10;
      do {
        iVar3 = uVar2 + *param_2;
        iVar4 = iVar3 + (uint)param_2[1];
        iVar5 = iVar4 + (uint)param_2[2];
        iVar6 = iVar5 + (uint)param_2[3];
        iVar7 = iVar6 + (uint)param_2[4];
        iVar8 = iVar7 + (uint)param_2[5];
        iVar9 = iVar8 + (uint)param_2[6];
        iVar10 = iVar9 + (uint)param_2[7];
        iVar11 = iVar10 + (uint)param_2[8];
        iVar12 = iVar11 + (uint)param_2[9];
        iVar13 = iVar12 + (uint)param_2[10];
        iVar14 = iVar13 + (uint)param_2[0xb];
        iVar15 = iVar14 + (uint)param_2[0xc];
        iVar16 = iVar15 + (uint)param_2[0xd];
        iVar17 = iVar16 + (uint)param_2[0xe];
        uVar2 = iVar17 + (uint)param_2[0xf];
        param_1 = param_1 + iVar3 + iVar4 + iVar5 + iVar6 + iVar7 + iVar8 + iVar9 + iVar10 + iVar11
                  + iVar12 + iVar13 + iVar14 + iVar15 + iVar16 + iVar17 + uVar2;
        param_2 = param_2 + 0x10;
        uVar18 = uVar18 - 1;
      } while (uVar18 != 0);
    }
    for (; uVar1 != 0; uVar1 = uVar1 - 1) {
      uVar2 = uVar2 + *param_2;
      param_2 = param_2 + 1;
      param_1 = param_1 + uVar2;
    }
    uVar2 = uVar2 % 0xfff1;
    param_1 = param_1 % 0xfff1;
  }
  return param_1 << 0x10 | uVar2;
}



============================================================
DISASSEMBLY
============================================================
006c1ae0 : PUSH ESI
006c1ae1 : MOV ESI,dword ptr [ESP + 0xc]
006c1ae5 : PUSH EDI
006c1ae6 : MOV EDI,dword ptr [ESP + 0xc]
006c1aea : MOVZX ECX,DI
006c1aed : SHR EDI,0x10
006c1af0 : TEST ESI,ESI
006c1af2 : JNZ 0x006c1afa
006c1af4 : POP EDI
006c1af5 : LEA EAX,[ESI + 0x1]
006c1af8 : POP ESI
006c1af9 : RET
006c1afa : PUSH EBX
006c1afb : MOV EBX,dword ptr [ESP + 0x18]
006c1aff : TEST EBX,EBX
006c1b01 : JBE 0x006c1c0a
006c1b07 : PUSH EBP
006c1b08 : JMP 0x006c1b10
006c1b10 : MOV EAX,EBX
006c1b12 : CMP EBX,0x15b0
006c1b18 : JC 0x006c1b1f
006c1b1a : MOV EAX,0x15b0
006c1b1f : SUB EBX,EAX
006c1b21 : CMP EAX,0x10
006c1b24 : JL 0x006c1bcb
006c1b2a : MOV EDX,EAX
006c1b2c : SHR EDX,0x4
006c1b2f : MOV EBP,EDX
006c1b31 : NEG EBP
006c1b33 : SHL EBP,0x4
006c1b36 : ADD EAX,EBP
006c1b38 : JMP 0x006c1b40
006c1b40 : MOVZX EBP,byte ptr [ESI]
006c1b43 : ADD ECX,EBP
006c1b45 : MOVZX EBP,byte ptr [ESI + 0x1]
006c1b49 : ADD EDI,ECX
006c1b4b : ADD ECX,EBP
006c1b4d : MOVZX EBP,byte ptr [ESI + 0x2]
006c1b51 : ADD EDI,ECX
006c1b53 : ADD ECX,EBP
006c1b55 : MOVZX EBP,byte ptr [ESI + 0x3]
006c1b59 : ADD EDI,ECX
006c1b5b : ADD ECX,EBP
006c1b5d : MOVZX EBP,byte ptr [ESI + 0x4]
006c1b61 : ADD EDI,ECX
006c1b63 : ADD ECX,EBP
006c1b65 : MOVZX EBP,byte ptr [ESI + 0x5]
006c1b69 : ADD EDI,ECX
006c1b6b : ADD ECX,EBP
006c1b6d : MOVZX EBP,byte ptr [ESI + 0x6]
006c1b71 : ADD EDI,ECX
006c1b73 : ADD ECX,EBP
006c1b75 : MOVZX EBP,byte ptr [ESI + 0x7]
006c1b79 : ADD EDI,ECX
006c1b7b : ADD ECX,EBP
006c1b7d : MOVZX EBP,byte ptr [ESI + 0x8]
006c1b81 : ADD EDI,ECX
006c1b83 : ADD ECX,EBP
006c1b85 : MOVZX EBP,byte ptr [ESI + 0x9]
006c1b89 : ADD EDI,ECX
006c1b8b : ADD ECX,EBP
006c1b8d : MOVZX EBP,byte ptr [ESI + 0xa]
006c1b91 : ADD EDI,ECX
006c1b93 : ADD ECX,EBP
006c1b95 : MOVZX EBP,byte ptr [ESI + 0xb]
006c1b99 : ADD EDI,ECX
006c1b9b : ADD ECX,EBP
006c1b9d : MOVZX EBP,byte ptr [ESI + 0xc]
006c1ba1 : ADD EDI,ECX
006c1ba3 : ADD ECX,EBP
006c1ba5 : MOVZX EBP,byte ptr [ESI + 0xd]
006c1ba9 : ADD EDI,ECX
006c1bab : ADD ECX,EBP
006c1bad : MOVZX EBP,byte ptr [ESI + 0xe]
006c1bb1 : ADD EDI,ECX
006c1bb3 : ADD ECX,EBP
006c1bb5 : MOVZX EBP,byte ptr [ESI + 0xf]
006c1bb9 : ADD EDI,ECX
006c1bbb : ADD ECX,EBP
006c1bbd : ADD EDI,ECX
006c1bbf : ADD ESI,0x10
006c1bc2 : SUB EDX,0x1
006c1bc5 : JNZ 0x006c1b40
006c1bcb : TEST EAX,EAX
006c1bcd : JZ 0x006c1bdd
006c1bcf : NOP
006c1bd0 : MOVZX EDX,byte ptr [ESI]
006c1bd3 : ADD ECX,EDX
006c1bd5 : INC ESI
006c1bd6 : ADD EDI,ECX
006c1bd8 : SUB EAX,0x1
006c1bdb : JNZ 0x006c1bd0
006c1bdd : MOV EAX,0x80078071
006c1be2 : MUL ECX
006c1be4 : SHR EDX,0xf
006c1be7 : IMUL EDX,EDX,-0xfff1
006c1bed : ADD ECX,EDX
006c1bef : MOV EAX,0x80078071
006c1bf4 : MUL EDI
006c1bf6 : SHR EDX,0xf
006c1bf9 : IMUL EDX,EDX,-0xfff1
006c1bff : ADD EDI,EDX
006c1c01 : TEST EBX,EBX
006c1c03 : JA 0x006c1b10
006c1c09 : POP EBP
006c1c0a : MOV EAX,EDI
006c1c0c : POP EBX
006c1c0d : SHL EAX,0x10
006c1c10 : POP EDI
006c1c11 : OR EAX,ECX
006c1c13 : POP ESI
006c1c14 : RET

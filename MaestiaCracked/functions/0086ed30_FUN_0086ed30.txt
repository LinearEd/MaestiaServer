PROGRAM  : Maestia.exe
FUNCTION : FUN_0086ed30
ENTRY    : 0086ed30
BODY     : [[0086ed30, 0086ee06] [0086ee10, 0086eee1]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0086ed30(int param_1)

{
  uint uVar1;
  undefined *puVar2;
  int iVar3;
  undefined4 uVar4;
  undefined1 auStack_64 [4];
  int local_60;
  undefined **local_5c;
  int *piStack_58;
  undefined2 uStack_50;
  undefined4 uStack_40;
  uint uStack_3c;
  undefined1 local_38 [4];
  undefined2 uStack_34;
  undefined4 uStack_24;
  uint uStack_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  int local_c;
  
  iVar3 = DAT_00d7c54c;
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b1beba;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_64;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xffffff90;
  ExceptionList = &local_14;
  local_60 = *(int *)(param_1 + 8);
  FUN_004437f0(&local_60);
  if (local_5c == *(undefined ***)(iVar3 + 0x44)) {
    puVar2 = (undefined *)0x0;
  }
  else {
    puVar2 = local_5c[4];
  }
  iVar3 = *(int *)(puVar2 + 300);
  if (iVar3 != 0) {
    FUN_00406460(&DAT_00c421b0);
    local_c = 0;
    local_60 = (**(code **)(*(int *)(iVar3 + 400) + 4))(uVar1);
    if (local_60 == 0) {
      local_c = 0xffffffff;
      if (7 < uStack_20) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      uStack_20 = 7;
      uStack_24 = 0;
      uStack_34 = 0;
    }
    else {
      do {
        iVar3 = FUN_004f5680();
        if (iVar3 == 0) break;
        uVar4 = FUN_00404350(iVar3 + 0x18);
        local_c._0_1_ = 1;
        FUN_00405eb0(uVar4,0,0xffffffff);
        local_c = (uint)local_c._1_3_ << 8;
        if (7 < uStack_3c) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        uStack_50 = 0;
        uStack_3c = 7;
        uStack_40 = 0;
        FUN_0070c1f0();
        (**(code **)(*DAT_017251ec + 4))(&local_5c,local_38);
        local_5c = &PTR_FUN_00cd4964;
        if (piStack_58 != (int *)0x0) {
          (**(code **)(*piStack_58 + 0x30))();
          piStack_58 = (int *)0x0;
        }
      } while (local_60 != 0);
      local_c = 0xffffffff;
      FUN_00406560();
    }
  }
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_64);
  return;
}



============================================================
DISASSEMBLY
============================================================
0086ed30 : PUSH EBP
0086ed31 : MOV EBP,ESP
0086ed33 : AND ESP,0xfffffff8
0086ed36 : PUSH -0x1
0086ed38 : PUSH 0xb1beba
0086ed3d : MOV EAX,FS:[0x0]
0086ed43 : PUSH EAX
0086ed44 : SUB ESP,0x50
0086ed47 : MOV EAX,[0x00d66fa0]
0086ed4c : XOR EAX,ESP
0086ed4e : MOV dword ptr [ESP + 0x48],EAX
0086ed52 : PUSH EBX
0086ed53 : PUSH ESI
0086ed54 : PUSH EDI
0086ed55 : MOV EAX,[0x00d66fa0]
0086ed5a : XOR EAX,ESP
0086ed5c : PUSH EAX
0086ed5d : LEA EAX,[ESP + 0x60]
0086ed61 : MOV FS:[0x0],EAX
0086ed67 : MOV EAX,dword ptr [EBP + 0x8]
0086ed6a : MOV ECX,dword ptr [EAX + 0x8]
0086ed6d : MOV ESI,dword ptr [0x00d7c54c]
0086ed73 : LEA EDX,[ESP + 0x14]
0086ed77 : MOV dword ptr [ESP + 0x14],ECX
0086ed7b : PUSH EDX
0086ed7c : LEA ECX,[ESI + 0x40]
0086ed7f : LEA EAX,[ESP + 0x1c]
0086ed83 : CALL 0x004437f0
0086ed88 : MOV ESI,dword ptr [ESI + 0x44]
0086ed8b : MOV EAX,dword ptr [ESP + 0x18]
0086ed8f : XOR EBX,EBX
0086ed91 : CMP EAX,ESI
0086ed93 : JZ 0x0086ed9a
0086ed95 : MOV EAX,dword ptr [EAX + 0x10]
0086ed98 : JMP 0x0086ed9c
0086ed9a : XOR EAX,EAX
0086ed9c : MOV ESI,dword ptr [EAX + 0x12c]
0086eda2 : CMP ESI,EBX
0086eda4 : JZ 0x0086eec2
0086edaa : PUSH 0xc421b0
0086edaf : LEA ECX,[ESP + 0x40]
0086edb3 : CALL 0x00406460
0086edb8 : MOV dword ptr [ESP + 0x68],EBX
0086edbc : MOV EAX,dword ptr [ESI + 0x190]
0086edc2 : MOV EDX,dword ptr [EAX + 0x4]
0086edc5 : LEA EDI,[ESI + 0x190]
0086edcb : MOV ECX,EDI
0086edcd : CALL EDX
0086edcf : MOV dword ptr [ESP + 0x14],EAX
0086edd3 : CMP EAX,EBX
0086edd5 : JNZ 0x0086ee10
0086edd7 : MOV dword ptr [ESP + 0x68],0xffffffff
0086eddf : CMP dword ptr [ESP + 0x54],0x8
0086ede4 : JC 0x0086edef
0086ede6 : MOV ECX,dword ptr [ESP + 0x40]
0086edea : CALL 0x006f04e0
0086edef : XOR EAX,EAX
0086edf1 : MOV dword ptr [ESP + 0x54],0x7
0086edf9 : MOV dword ptr [ESP + 0x50],EBX
0086edfd : MOV word ptr [ESP + 0x40],AX
0086ee02 : JMP 0x0086eec2
0086ee10 : LEA EDX,[ESP + 0x14]
0086ee14 : MOV EAX,EDI
0086ee16 : CALL 0x004f5680
0086ee1b : CMP EAX,EBX
0086ee1d : JZ 0x0086eeb1
0086ee23 : ADD EAX,0x18
0086ee26 : PUSH EAX
0086ee27 : LEA ESI,[ESP + 0x24]
0086ee2b : CALL 0x00404350
0086ee30 : ADD ESP,0x4
0086ee33 : MOV byte ptr [ESP + 0x68],0x1
0086ee38 : PUSH -0x1
0086ee3a : PUSH EBX
0086ee3b : PUSH EAX
0086ee3c : LEA ECX,[ESP + 0x48]
0086ee40 : CALL 0x00405eb0
0086ee45 : MOV byte ptr [ESP + 0x68],BL
0086ee49 : CMP dword ptr [ESP + 0x38],0x8
0086ee4e : JC 0x0086ee59
0086ee50 : MOV ECX,dword ptr [ESP + 0x24]
0086ee54 : CALL 0x006f04e0
0086ee59 : XOR ECX,ECX
0086ee5b : MOV word ptr [ESP + 0x24],CX
0086ee60 : LEA ECX,[ESP + 0x3c]
0086ee64 : MOV dword ptr [ESP + 0x38],0x7
0086ee6c : MOV dword ptr [ESP + 0x34],EBX
0086ee70 : CALL 0x0070c1f0
0086ee75 : MOV ECX,dword ptr [0x017251ec]
0086ee7b : MOV EDX,dword ptr [ECX]
0086ee7d : MOV EDX,dword ptr [EDX + 0x4]
0086ee80 : LEA EAX,[ESP + 0x3c]
0086ee84 : PUSH EAX
0086ee85 : LEA EAX,[ESP + 0x1c]
0086ee89 : PUSH EAX
0086ee8a : CALL EDX
0086ee8c : MOV ECX,dword ptr [ESP + 0x1c]
0086ee90 : MOV dword ptr [ESP + 0x18],0xcd4964
0086ee98 : CMP ECX,EBX
0086ee9a : JZ 0x0086eea7
0086ee9c : MOV EAX,dword ptr [ECX]
0086ee9e : MOV EDX,dword ptr [EAX + 0x30]
0086eea1 : CALL EDX
0086eea3 : MOV dword ptr [ESP + 0x1c],EBX
0086eea7 : CMP dword ptr [ESP + 0x14],EBX
0086eeab : JNZ 0x0086ee10
0086eeb1 : MOV dword ptr [ESP + 0x68],0xffffffff
0086eeb9 : LEA ECX,[ESP + 0x3c]
0086eebd : CALL 0x00406560
0086eec2 : MOV ECX,dword ptr [ESP + 0x60]
0086eec6 : MOV dword ptr FS:[0x0],ECX
0086eecd : POP ECX
0086eece : POP EDI
0086eecf : POP ESI
0086eed0 : POP EBX
0086eed1 : MOV ECX,dword ptr [ESP + 0x48]
0086eed5 : XOR ECX,ESP
0086eed7 : CALL 0x00633e6b
0086eedc : MOV ESP,EBP
0086eede : POP EBP
0086eedf : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_009e6380
ENTRY    : 009e6380
BODY     : [[009e6380, 009e6538] [009e6540, 009e667f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009e6380(void)

{
  wchar_t wVar1;
  uint uVar2;
  undefined4 uVar3;
  wchar_t *pwVar4;
  wchar_t *pwVar5;
  int iVar6;
  uint uVar7;
  uint local_28c;
  undefined1 local_288 [4];
  undefined2 local_284;
  undefined4 local_274;
  uint local_270;
  uint local_26c;
  undefined1 local_268 [32];
  undefined2 local_248;
  undefined4 local_238;
  uint local_234;
  undefined4 local_22c;
  uint local_21c;
  uint local_218;
  wchar_t local_214;
  undefined1 local_212 [510];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b67605;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  FUN_008b6ea0(local_268);
  local_218 = 7;
  local_21c = 0;
  local_22c = (wchar_t *)((uint)local_22c._2_2_ << 0x10);
  local_234 = 7;
  local_238 = 0;
  local_248 = 0;
  local_8._1_3_ = 0;
  local_8._0_1_ = 2;
  local_26c = 0;
  do {
    FUN_00406360(L"COMMAND",7);
    __itow_s(local_26c,&local_214,0x100,10);
    pwVar5 = &local_214;
    do {
      wVar1 = *pwVar5;
      pwVar5 = pwVar5 + 1;
    } while (wVar1 != L'\0');
    FUN_00404870(&local_214,(int)pwVar5 - (int)local_212 >> 1);
    local_270 = 7;
    local_274 = 0;
    local_284 = 0;
    FUN_00406360(L"COMMAND",7);
    local_8._0_1_ = 3;
    uVar3 = FUN_008b7710(local_288);
    local_8._0_1_ = 4;
    FUN_00405eb0(uVar3,0,0xffffffff);
    uVar2 = local_21c;
    local_8 = CONCAT31(local_8._1_3_,3);
    if (7 < local_28c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_28c = 7;
    local_8._0_1_ = 2;
    if (7 < local_270) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_270 = 7;
    local_274 = 0;
    local_284 = 0;
    uVar7 = local_21c;
    if (0xe < local_21c) {
      uVar7 = 0xf;
    }
    pwVar5 = local_22c;
    if (local_218 < 8) {
      pwVar5 = (wchar_t *)&local_22c;
    }
    pwVar4 = L"Error : ReadIni";
    for (; uVar7 != 0; uVar7 = uVar7 - 1) {
      if (*pwVar5 != *pwVar4) {
        uVar7 = (-(uint)((ushort)*pwVar5 < (ushort)*pwVar4) & 0xfffffffe) + 1;
        if (uVar7 != 0) goto LAB_009e6569;
        break;
      }
      pwVar5 = pwVar5 + 1;
      pwVar4 = pwVar4 + 1;
    }
    if (local_21c < 0xf) {
LAB_009e656d:
      if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
        pwVar5 = local_22c;
        if (local_218 < 8) {
          pwVar5 = (wchar_t *)&local_22c;
        }
        iVar6 = FUN_00405b70(pwVar5);
        if ((iVar6 != 0) || (uVar2 != 0)) {
          uVar3 = FUN_00838510();
          FUN_0083a480(uVar3);
        }
      }
    }
    else {
      uVar7 = (uint)(local_21c != 0xf);
LAB_009e6569:
      if (uVar7 != 0) goto LAB_009e656d;
    }
    local_26c = local_26c + 1;
    if (99 < local_26c) {
      local_8 = CONCAT31(local_8._1_3_,1);
      if (7 < local_234) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_234 = 7;
      local_238 = 0;
      local_248 = 0;
      local_8 = (uint)local_8._1_3_ << 8;
      if (7 < local_218) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_218 = 7;
      local_21c = 0;
      local_22c = (wchar_t *)((uint)local_22c & 0xffff0000);
      local_8 = 0xffffffff;
      FUN_008b6e30(local_268);
      ExceptionList = local_10;
      __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
      return;
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
009e6380 : PUSH EBP
009e6381 : MOV EBP,ESP
009e6383 : PUSH -0x1
009e6385 : PUSH 0xb67605
009e638a : MOV EAX,FS:[0x0]
009e6390 : PUSH EAX
009e6391 : SUB ESP,0x294
009e6397 : MOV EAX,[0x00d66fa0]
009e639c : XOR EAX,EBP
009e639e : MOV dword ptr [EBP + -0x10],EAX
009e63a1 : PUSH EBX
009e63a2 : PUSH ESI
009e63a3 : PUSH EDI
009e63a4 : PUSH EAX
009e63a5 : LEA EAX,[EBP + -0xc]
009e63a8 : MOV FS:[0x0],EAX
009e63ae : LEA EAX,[EBP + 0xfffffd9c]
009e63b4 : PUSH EAX
009e63b5 : CALL 0x008b6ea0
009e63ba : XOR EBX,EBX
009e63bc : MOV dword ptr [EBP + -0x4],EBX
009e63bf : MOV EDI,0x7
009e63c4 : XOR ECX,ECX
009e63c6 : MOV dword ptr [EBP + 0xfffffdec],EDI
009e63cc : MOV dword ptr [EBP + 0xfffffde8],EBX
009e63d2 : MOV word ptr [EBP + 0xfffffdd8],CX
009e63d9 : MOV byte ptr [EBP + -0x4],0x1
009e63dd : XOR EDX,EDX
009e63df : MOV dword ptr [EBP + 0xfffffdd0],EDI
009e63e5 : MOV dword ptr [EBP + 0xfffffdcc],EBX
009e63eb : MOV word ptr [EBP + 0xfffffdbc],DX
009e63f2 : MOV byte ptr [EBP + -0x4],0x2
009e63f6 : MOV dword ptr [EBP + 0xfffffd98],EBX
009e63fc : PUSH EDI
009e63fd : PUSH 0xc981bc
009e6402 : LEA ECX,[EBP + 0xfffffdb8]
009e6408 : CALL 0x00406360
009e640d : MOV ECX,dword ptr [EBP + 0xfffffd98]
009e6413 : PUSH 0xa
009e6415 : PUSH 0x100
009e641a : LEA EAX,[EBP + 0xfffffdf0]
009e6420 : PUSH EAX
009e6421 : PUSH ECX
009e6422 : CALL 0x0063706a
009e6427 : LEA EAX,[EBP + 0xfffffdf0]
009e642d : ADD ESP,0x10
009e6430 : LEA EDX,[EAX + 0x2]
009e6433 : MOV CX,word ptr [EAX]
009e6436 : ADD EAX,0x2
009e6439 : CMP CX,BX
009e643c : JNZ 0x009e6433
009e643e : SUB EAX,EDX
009e6440 : SAR EAX,0x1
009e6442 : PUSH EAX
009e6443 : LEA EDX,[EBP + 0xfffffdf0]
009e6449 : PUSH EDX
009e644a : LEA ESI,[EBP + 0xfffffdb8]
009e6450 : CALL 0x00404870
009e6455 : PUSH EDI
009e6456 : XOR EAX,EAX
009e6458 : PUSH 0xc981cc
009e645d : LEA ECX,[EBP + 0xfffffd7c]
009e6463 : MOV dword ptr [EBP + 0xfffffd94],EDI
009e6469 : MOV dword ptr [EBP + 0xfffffd90],EBX
009e646f : MOV word ptr [EBP + 0xfffffd80],AX
009e6476 : CALL 0x00406360
009e647b : MOV byte ptr [EBP + -0x4],0x3
009e647f : LEA ECX,[EBP + 0xfffffd7c]
009e6485 : PUSH ECX
009e6486 : MOV ECX,ESI
009e6488 : LEA ESI,[EBP + 0xfffffd60]
009e648e : LEA EDX,[EBP + 0xfffffd9c]
009e6494 : CALL 0x008b7710
009e6499 : MOV byte ptr [EBP + -0x4],0x4
009e649d : PUSH -0x1
009e649f : PUSH EBX
009e64a0 : PUSH EAX
009e64a1 : LEA ECX,[EBP + 0xfffffdd4]
009e64a7 : CALL 0x00405eb0
009e64ac : MOV byte ptr [EBP + -0x4],0x3
009e64b0 : MOV ESI,0x8
009e64b5 : CMP dword ptr [EBP + 0xfffffd78],ESI
009e64bb : JC 0x009e64c8
009e64bd : MOV ECX,dword ptr [EBP + 0xfffffd64]
009e64c3 : CALL 0x006f04e0
009e64c8 : XOR EDX,EDX
009e64ca : MOV dword ptr [EBP + 0xfffffd78],EDI
009e64d0 : MOV dword ptr [EBP + 0xfffffd74],EBX
009e64d6 : MOV word ptr [EBP + 0xfffffd64],DX
009e64dd : MOV byte ptr [EBP + -0x4],0x2
009e64e1 : CMP dword ptr [EBP + 0xfffffd94],ESI
009e64e7 : JC 0x009e64f4
009e64e9 : MOV ECX,dword ptr [EBP + 0xfffffd80]
009e64ef : CALL 0x006f04e0
009e64f4 : MOV ESI,dword ptr [EBP + 0xfffffde8]
009e64fa : XOR EAX,EAX
009e64fc : MOV dword ptr [EBP + 0xfffffd94],EDI
009e6502 : MOV dword ptr [EBP + 0xfffffd90],EBX
009e6508 : MOV word ptr [EBP + 0xfffffd80],AX
009e650f : MOV EDX,ESI
009e6511 : CMP ESI,0xf
009e6514 : JC 0x009e6519
009e6516 : LEA EDX,[EAX + 0xf]
009e6519 : CMP dword ptr [EBP + 0xfffffdec],0x8
009e6520 : MOV ECX,dword ptr [EBP + 0xfffffdd8]
009e6526 : JNC 0x009e652e
009e6528 : LEA ECX,[EBP + 0xfffffdd8]
009e652e : MOV EAX,0xc981dc
009e6533 : CMP EDX,EBX
009e6535 : JBE 0x009e655c
009e6537 : JMP 0x009e6540
009e6540 : MOV DI,word ptr [ECX]
009e6543 : CMP DI,word ptr [EAX]
009e6546 : JNZ 0x009e6662
009e654c : ADD ECX,0x2
009e654f : ADD EAX,0x2
009e6552 : SUB EDX,0x1
009e6555 : JNZ 0x009e6540
009e6557 : MOV EDI,0x7
009e655c : CMP ESI,0xf
009e655f : JC 0x009e656d
009e6561 : XOR EAX,EAX
009e6563 : CMP ESI,0xf
009e6566 : SETNZ AL
009e6569 : CMP EAX,EBX
009e656b : JZ 0x009e65c1
009e656d : MOV EAX,[0x017247d4]
009e6572 : CMP dword ptr [EAX + 0x4],EBX
009e6575 : JZ 0x009e65c1
009e6577 : CMP byte ptr [EAX + 0x8],BL
009e657a : JZ 0x009e65c1
009e657c : CMP dword ptr [EBP + 0xfffffdec],0x8
009e6583 : MOV EAX,dword ptr [EBP + 0xfffffdd8]
009e6589 : JNC 0x009e6591
009e658b : LEA EAX,[EBP + 0xfffffdd8]
009e6591 : PUSH EAX
009e6592 : XOR EDX,EDX
009e6594 : MOV ECX,0xcac440
009e6599 : CALL 0x00405b70
009e659e : ADD ESP,0x4
009e65a1 : CMP EAX,EBX
009e65a3 : JNZ 0x009e65b0
009e65a5 : XOR EAX,EAX
009e65a7 : CMP ESI,EBX
009e65a9 : SETNZ AL
009e65ac : CMP EAX,EBX
009e65ae : JZ 0x009e65c1
009e65b0 : CALL 0x00838510
009e65b5 : PUSH EAX
009e65b6 : LEA ECX,[EBP + 0xfffffdd4]
009e65bc : CALL 0x0083a480
009e65c1 : MOV EAX,dword ptr [EBP + 0xfffffd98]
009e65c7 : INC EAX
009e65c8 : MOV dword ptr [EBP + 0xfffffd98],EAX
009e65ce : CMP EAX,0x64
009e65d1 : JC 0x009e63fc
009e65d7 : MOV byte ptr [EBP + -0x4],0x1
009e65db : MOV ESI,0x8
009e65e0 : CMP dword ptr [EBP + 0xfffffdd0],ESI
009e65e6 : JC 0x009e65f3
009e65e8 : MOV ECX,dword ptr [EBP + 0xfffffdbc]
009e65ee : CALL 0x006f04e0
009e65f3 : XOR EDX,EDX
009e65f5 : MOV dword ptr [EBP + 0xfffffdd0],EDI
009e65fb : MOV dword ptr [EBP + 0xfffffdcc],EBX
009e6601 : MOV word ptr [EBP + 0xfffffdbc],DX
009e6608 : MOV byte ptr [EBP + -0x4],BL
009e660b : CMP dword ptr [EBP + 0xfffffdec],ESI
009e6611 : JC 0x009e661e
009e6613 : MOV ECX,dword ptr [EBP + 0xfffffdd8]
009e6619 : CALL 0x006f04e0
009e661e : XOR EAX,EAX
009e6620 : MOV dword ptr [EBP + 0xfffffdec],EDI
009e6626 : MOV dword ptr [EBP + 0xfffffde8],EBX
009e662c : MOV word ptr [EBP + 0xfffffdd8],AX
009e6633 : MOV dword ptr [EBP + -0x4],0xffffffff
009e663a : LEA ECX,[EBP + 0xfffffd9c]
009e6640 : PUSH ECX
009e6641 : CALL 0x008b6e30
009e6646 : MOV ECX,dword ptr [EBP + -0xc]
009e6649 : MOV dword ptr FS:[0x0],ECX
009e6650 : POP ECX
009e6651 : POP EDI
009e6652 : POP ESI
009e6653 : POP EBX
009e6654 : MOV ECX,dword ptr [EBP + -0x10]
009e6657 : XOR ECX,EBP
009e6659 : CALL 0x00633e6b
009e665e : MOV ESP,EBP
009e6660 : POP EBP
009e6661 : RET
009e6662 : MOV CX,DI
009e6665 : CMP CX,word ptr [EAX]
009e6668 : SBB EAX,EAX
009e666a : AND EAX,0xfffffffe
009e666d : INC EAX
009e666e : CMP EAX,EBX
009e6670 : JZ 0x009e6557
009e6676 : MOV EDI,0x7
009e667b : JMP 0x009e6569

PROGRAM  : Maestia.exe
FUNCTION : FUN_0052e440
ENTRY    : 0052e440
BODY     : [[0052e440, 0052e569]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0052e440(int param_1,char *param_2)

{
  char cVar1;
  char *pcVar2;
  int iVar3;
  int *piVar4;
  undefined1 *puStack_124;
  char *local_118;
  int local_114;
  undefined4 local_110;
  char *local_10c;
  undefined4 local_108;
  char local_104 [244];
  uint uStack_10;
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)&local_118;
  iVar3 = *(int *)(param_1 + 0xa0);
  if (iVar3 == 0) {
    puStack_124 = (undefined1 *)0x52e527;
    iVar3 = (**(code **)(**(int **)(param_1 + 0x74) + 0x94))();
    if (iVar3 == 0) goto LAB_0052e553;
    puStack_124 = (undefined1 *)0x52e538;
    piVar4 = (int *)(**(code **)(**(int **)(param_1 + 0x74) + 0x94))();
    iVar3 = *piVar4;
  }
  else {
    if (*(int *)(iVar3 + 4) == 0) goto LAB_0052e553;
    if (*(char *)(iVar3 + 10) == '\0') {
      puStack_124 = &stack0x0000000c;
      (**(code **)(**(int **)(iVar3 + 4) + 4))(0x20,param_2);
      __security_check_cookie(uStack_10 ^ (uint)&puStack_124);
      return;
    }
    pcVar2 = param_2;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    local_114 = (int)pcVar2 - (int)(param_2 + 1);
    if (param_2[local_114 + -1] == '\n') {
      local_114 = local_114 + -1;
    }
    local_118 = param_2;
    puStack_124 = (undefined1 *)(iVar3 + 0xc);
    local_10c = local_104;
    local_110 = 2;
    local_108 = 0x100;
    FUN_0052bbc0(&local_110,"{0} : {1}\n",&local_118);
    iVar3 = **(int **)(iVar3 + 4);
    param_2 = local_104;
  }
  puStack_124 = &stack0x0000000c;
  (**(code **)(iVar3 + 4))(0x20,param_2);
LAB_0052e553:
  __security_check_cookie(local_4 ^ (uint)&local_118);
  return;
}



============================================================
DISASSEMBLY
============================================================
0052e440 : SUB ESP,0x118
0052e446 : MOV EAX,[0x00d66fa0]
0052e44b : XOR EAX,ESP
0052e44d : MOV dword ptr [ESP + 0x114],EAX
0052e454 : PUSH ESI
0052e455 : PUSH EDI
0052e456 : MOV EDI,dword ptr [ESP + 0x124]
0052e45d : MOV ESI,dword ptr [EDI + 0xa0]
0052e463 : TEST ESI,ESI
0052e465 : JZ 0x0052e51a
0052e46b : CMP dword ptr [ESI + 0x4],0x0
0052e46f : JZ 0x0052e553
0052e475 : CMP byte ptr [ESI + 0xa],0x0
0052e479 : JZ 0x0052e4e7
0052e47b : MOV EDX,dword ptr [ESP + 0x128]
0052e482 : MOV EAX,EDX
0052e484 : LEA EDI,[EAX + 0x1]
0052e487 : MOV CL,byte ptr [EAX]
0052e489 : INC EAX
0052e48a : TEST CL,CL
0052e48c : JNZ 0x0052e487
0052e48e : SUB EAX,EDI
0052e490 : CMP byte ptr [EAX + EDX*0x1 + -0x1],0xa
0052e495 : JNZ 0x0052e498
0052e497 : DEC EAX
0052e498 : MOV dword ptr [ESP + 0x8],EDX
0052e49c : LEA EDX,[ESI + 0xc]
0052e49f : PUSH EDX
0052e4a0 : MOV dword ptr [ESP + 0x10],EAX
0052e4a4 : LEA EAX,[ESP + 0xc]
0052e4a8 : LEA ECX,[ESP + 0x20]
0052e4ac : PUSH EAX
0052e4ad : MOV dword ptr [ESP + 0x1c],ECX
0052e4b1 : LEA ECX,[ESP + 0x18]
0052e4b5 : PUSH 0xb8b328
0052e4ba : PUSH ECX
0052e4bb : MOV dword ptr [ESP + 0x20],0x2
0052e4c3 : MOV dword ptr [ESP + 0x28],0x100
0052e4cb : CALL 0x0052bbc0
0052e4d0 : MOV ECX,dword ptr [ESI + 0x4]
0052e4d3 : MOV EDX,dword ptr [ECX]
0052e4d5 : ADD ESP,0x10
0052e4d8 : LEA EAX,[ESP + 0x12c]
0052e4df : PUSH EAX
0052e4e0 : LEA EAX,[ESP + 0x20]
0052e4e4 : PUSH EAX
0052e4e5 : JMP 0x0052e54c
0052e4e7 : MOV ECX,dword ptr [ESI + 0x4]
0052e4ea : MOV EAX,dword ptr [ECX]
0052e4ec : MOV EAX,dword ptr [EAX + 0x4]
0052e4ef : LEA EDX,[ESP + 0x12c]
0052e4f6 : PUSH EDX
0052e4f7 : MOV EDX,dword ptr [ESP + 0x12c]
0052e4fe : PUSH EDX
0052e4ff : PUSH 0x20
0052e501 : CALL EAX
0052e503 : POP EDI
0052e504 : POP ESI
0052e505 : MOV ECX,dword ptr [ESP + 0x114]
0052e50c : XOR ECX,ESP
0052e50e : CALL 0x00633e6b
0052e513 : ADD ESP,0x118
0052e519 : RET
0052e51a : MOV ECX,dword ptr [EDI + 0x74]
0052e51d : MOV EDX,dword ptr [ECX]
0052e51f : MOV EAX,dword ptr [EDX + 0x94]
0052e525 : CALL EAX
0052e527 : TEST EAX,EAX
0052e529 : JZ 0x0052e553
0052e52b : MOV ECX,dword ptr [EDI + 0x74]
0052e52e : MOV EDX,dword ptr [ECX]
0052e530 : MOV EAX,dword ptr [EDX + 0x94]
0052e536 : CALL EAX
0052e538 : MOV EDX,dword ptr [EAX]
0052e53a : LEA ECX,[ESP + 0x12c]
0052e541 : PUSH ECX
0052e542 : MOV ECX,dword ptr [ESP + 0x12c]
0052e549 : PUSH ECX
0052e54a : MOV ECX,EAX
0052e54c : MOV EDX,dword ptr [EDX + 0x4]
0052e54f : PUSH 0x20
0052e551 : CALL EDX
0052e553 : MOV ECX,dword ptr [ESP + 0x11c]
0052e55a : POP EDI
0052e55b : POP ESI
0052e55c : XOR ECX,ESP
0052e55e : CALL 0x00633e6b
0052e563 : ADD ESP,0x118
0052e569 : RET

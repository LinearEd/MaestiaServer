PROGRAM  : Maestia.exe
FUNCTION : FUN_005f6fb0
ENTRY    : 005f6fb0
BODY     : [[005f6fb0, 005f70fa]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005f6fb0(int param_1,int param_2)

{
  uint *puVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  undefined4 uVar6;
  char cVar7;
  int iVar8;
  uint uVar9;
  byte bVar10;
  char cVar11;
  undefined4 *in_ECX;
  int iVar12;
  uint uVar13;
  int iVar14;
  
  iVar8 = param_2;
  iVar4 = *(int *)(param_1 + 0x1c);
  iVar5 = *(int *)(param_1 + 0x18);
  uVar6 = *in_ECX;
  bVar10 = (byte)uVar6;
  uVar13 = param_2 - iVar4 >> (bVar10 & 0x1f);
  iVar14 = param_1 + 0x20;
  uVar9 = FUN_005f6a30(iVar14,uVar13);
  puVar1 = (uint *)(iVar14 + (uVar13 >> 4) * 4);
  *puVar1 = *puVar1 & ~(3 << ((char)uVar13 * '\x02' & 0x1eU));
  uVar2 = uVar9 + uVar13;
  puVar1 = (uint *)(iVar14 + (uVar2 - 1 >> 4) * 4);
  *puVar1 = *puVar1 & ~(3 << ((char)(uVar2 - 1) * '\x02' & 0x1eU));
  iVar12 = uVar9 << (bVar10 & 0x1f);
  uVar3 = iVar12 + param_2;
  if ((uVar13 == 0) ||
     (cVar7 = '\x01',
     (*(uint *)(iVar14 + (uVar13 - 1 >> 4) * 4) >> ((char)(uVar13 - 1) * '\x02' & 0x1eU) & 3) != 0))
  {
    cVar7 = '\0';
  }
  if ((uVar3 < (uint)(iVar5 + iVar4)) &&
     ((*(uint *)(iVar14 + (uVar2 >> 4) * 4) >> ((char)uVar2 * '\x02' & 0x1eU) & 3) == 0)) {
    cVar11 = '\x01';
  }
  else {
    cVar11 = '\0';
  }
  param_2 = CONCAT31((int3)((uint)puVar1 >> 8),cVar11);
  if (uVar9 < 0x21) {
    *(short *)(iVar12 + -2 + iVar8) = (short)uVar9;
    *(short *)(iVar8 + 0xc) = (short)uVar9;
  }
  else {
    *(undefined2 *)(iVar12 + -2 + iVar8) = 0x21;
    *(undefined2 *)(iVar8 + 0xc) = 0x21;
    *(uint *)(iVar12 + -8 + iVar8) = uVar9;
    *(uint *)(iVar8 + 0x10) = uVar9;
  }
  *(int *)(iVar8 + 8) = param_1;
  if (cVar11 != '\0' || cVar7 != '\0') {
    FUN_005a8420(iVar8,uVar6,cVar7,param_2);
    return;
  }
  FUN_005a7f80(iVar8);
  return;
}



============================================================
DISASSEMBLY
============================================================
005f6fb0 : SUB ESP,0x10
005f6fb3 : PUSH EBX
005f6fb4 : PUSH EBP
005f6fb5 : MOV EBP,dword ptr [ESP + 0x20]
005f6fb9 : PUSH ESI
005f6fba : PUSH EDI
005f6fbb : MOV EDI,dword ptr [ESP + 0x24]
005f6fbf : MOV EAX,dword ptr [EDI + 0x1c]
005f6fc2 : MOV EBX,dword ptr [EDI + 0x18]
005f6fc5 : MOV dword ptr [ESP + 0x18],ECX
005f6fc9 : MOV ECX,dword ptr [ECX]
005f6fcb : MOV ESI,EBP
005f6fcd : SUB ESI,EAX
005f6fcf : SAR ESI,CL
005f6fd1 : ADD EDI,0x20
005f6fd4 : ADD EBX,EAX
005f6fd6 : MOV dword ptr [ESP + 0x14],ECX
005f6fda : PUSH ESI
005f6fdb : PUSH EDI
005f6fdc : CALL 0x005f6a30
005f6fe1 : MOV ECX,ESI
005f6fe3 : SHR ECX,0x4
005f6fe6 : LEA EDX,[EDI + ECX*0x4]
005f6fe9 : MOV dword ptr [ESP + 0x30],EDX
005f6fed : LEA ECX,[ESI + ESI*0x1]
005f6ff0 : AND ECX,0x1e
005f6ff3 : MOV EDX,0x3
005f6ff8 : SHL EDX,CL
005f6ffa : MOV ECX,dword ptr [ESP + 0x30]
005f6ffe : ADD ESP,0x8
005f7001 : NOT EDX
005f7003 : AND dword ptr [ECX],EDX
005f7005 : LEA ECX,[EAX + ESI*0x1]
005f7008 : MOV dword ptr [ESP + 0x1c],ECX
005f700c : DEC ECX
005f700d : MOV EDX,ECX
005f700f : SHR EDX,0x4
005f7012 : LEA EDX,[EDI + EDX*0x4]
005f7015 : MOV dword ptr [ESP + 0x28],EDX
005f7019 : ADD ECX,ECX
005f701b : AND ECX,0x1e
005f701e : MOV EDX,0x3
005f7023 : SHL EDX,CL
005f7025 : MOV ECX,dword ptr [ESP + 0x28]
005f7029 : NOT EDX
005f702b : AND dword ptr [ECX],EDX
005f702d : MOV ECX,dword ptr [ESP + 0x14]
005f7031 : MOV EDX,EAX
005f7033 : SHL EDX,CL
005f7035 : LEA ECX,[EDX + EBP*0x1]
005f7038 : CMP ECX,EBX
005f703a : SETC byte ptr [ESP + 0x28]
005f703f : TEST ESI,ESI
005f7041 : JZ 0x005f705e
005f7043 : DEC ESI
005f7044 : MOV EBX,ESI
005f7046 : SHR EBX,0x4
005f7049 : MOV EBX,dword ptr [EDI + EBX*0x4]
005f704c : LEA ECX,[ESI + ESI*0x1]
005f704f : AND ECX,0x1e
005f7052 : SHR EBX,CL
005f7054 : MOV byte ptr [ESP + 0x10],0x1
005f7059 : TEST BL,0x3
005f705c : JZ 0x005f7063
005f705e : MOV byte ptr [ESP + 0x10],0x0
005f7063 : CMP byte ptr [ESP + 0x28],0x0
005f7068 : JZ 0x005f7086
005f706a : MOV ECX,dword ptr [ESP + 0x1c]
005f706e : MOV ESI,ECX
005f7070 : SHR ESI,0x4
005f7073 : MOV EBX,dword ptr [EDI + ESI*0x4]
005f7076 : ADD ECX,ECX
005f7078 : AND ECX,0x1e
005f707b : SHR EBX,CL
005f707d : TEST BL,0x3
005f7080 : JNZ 0x005f7086
005f7082 : MOV CL,0x1
005f7084 : JMP 0x005f7088
005f7086 : XOR CL,CL
005f7088 : MOV byte ptr [ESP + 0x28],CL
005f708c : CMP EAX,0x21
005f708f : JNC 0x005f709c
005f7091 : MOV word ptr [EDX + EBP*0x1 + -0x2],AX
005f7096 : MOV word ptr [EBP + 0xc],AX
005f709a : JMP 0x005f70b1
005f709c : MOV ESI,0x21
005f70a1 : MOV word ptr [EDX + EBP*0x1 + -0x2],SI
005f70a6 : MOV word ptr [EBP + 0xc],SI
005f70aa : MOV dword ptr [EDX + EBP*0x1 + -0x8],EAX
005f70ae : MOV dword ptr [EBP + 0x10],EAX
005f70b1 : OR CL,byte ptr [ESP + 0x10]
005f70b5 : MOV EDX,dword ptr [ESP + 0x24]
005f70b9 : MOV dword ptr [EBP + 0x8],EDX
005f70bc : JZ 0x005f70e4
005f70be : MOV EAX,dword ptr [ESP + 0x28]
005f70c2 : MOV ECX,dword ptr [ESP + 0x10]
005f70c6 : MOV EDX,dword ptr [ESP + 0x14]
005f70ca : PUSH EAX
005f70cb : PUSH ECX
005f70cc : MOV ECX,dword ptr [ESP + 0x20]
005f70d0 : PUSH EDX
005f70d1 : PUSH EBP
005f70d2 : ADD ECX,0x8
005f70d5 : CALL 0x005a8420
005f70da : POP EDI
005f70db : POP ESI
005f70dc : POP EBP
005f70dd : POP EBX
005f70de : ADD ESP,0x10
005f70e1 : RET 0x8
005f70e4 : MOV ECX,dword ptr [ESP + 0x18]
005f70e8 : PUSH EBP
005f70e9 : ADD ECX,0x8
005f70ec : CALL 0x005a7f80
005f70f1 : POP EDI
005f70f2 : POP ESI
005f70f3 : POP EBP
005f70f4 : POP EBX
005f70f5 : ADD ESP,0x10
005f70f8 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_00406510
ENTRY    : 00406510
BODY     : [[00406510, 00406546] [00406548, 0040655e]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00406510(char param_1,int param_2)

{
  int in_ECX;
  
  if ((param_1 != '\0') && (7 < *(uint *)(in_ECX + 0x18))) {
    if (param_2 != 0) {
      _memcpy_s((undefined4 *)(in_ECX + 4),0x10,*(void **)(in_ECX + 4),param_2 * 2);
    }
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  *(int *)(in_ECX + 0x14) = param_2;
  *(undefined4 *)(in_ECX + 0x18) = 7;
  *(undefined2 *)(in_ECX + 4 + param_2 * 2) = 0;
  return;
}



============================================================
DISASSEMBLY
============================================================
00406510 : PUSH EBP
00406511 : MOV EBP,ESP
00406513 : CMP byte ptr [EBP + 0x8],0x0
00406517 : PUSH ESI
00406518 : PUSH EDI
00406519 : MOV EDI,dword ptr [EBP + 0xc]
0040651c : MOV ESI,ECX
0040651e : JZ 0x00406548
00406520 : CMP dword ptr [ESI + 0x18],0x8
00406524 : JC 0x00406548
00406526 : LEA EAX,[ESI + 0x4]
00406529 : PUSH EBX
0040652a : MOV EBX,dword ptr [EAX]
0040652c : TEST EDI,EDI
0040652e : JBE 0x00406540
00406530 : LEA ECX,[EDI + EDI*0x1]
00406533 : PUSH ECX
00406534 : PUSH EBX
00406535 : PUSH 0x10
00406537 : PUSH EAX
00406538 : CALL 0x00633ea4
0040653d : ADD ESP,0x10
00406540 : MOV ECX,EBX
00406542 : CALL 0x006f04e0
00406548 : MOV dword ptr [ESI + 0x14],EDI
0040654b : MOV dword ptr [ESI + 0x18],0x7
00406552 : XOR EDX,EDX
00406554 : MOV word ptr [ESI + EDI*0x2 + 0x4],DX
00406559 : POP EDI
0040655a : POP ESI
0040655b : POP EBP
0040655c : RET 0x8

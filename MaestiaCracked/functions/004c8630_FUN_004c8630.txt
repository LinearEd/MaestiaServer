PROGRAM  : Maestia.exe
FUNCTION : FUN_004c8630
ENTRY    : 004c8630
BODY     : [[004c8630, 004c8778] [004c877c, 004c878a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_004c8630(void)

{
  void *pvVar1;
  rsize_t _DstSize;
  uint uVar2;
  undefined4 *_Dst;
  int iVar3;
  int iVar4;
  uint uVar5;
  int unaff_ESI;
  undefined4 *puVar6;
  undefined4 *puVar7;
  uint local_8;
  
  uVar2 = *(uint *)(unaff_ESI + 0x14);
  local_8 = 1;
  if (uVar2 == 0x3333333) {
    uVar2 = FUN_00442c50();
  }
  uVar5 = uVar2 >> 1;
  if (uVar5 < 8) {
    uVar5 = 8;
  }
  else if (uVar5 < 2) goto LAB_004c8678;
  if (uVar2 <= 0x3333333 - uVar5) {
    local_8 = uVar5;
  }
LAB_004c8678:
  uVar2 = *(uint *)(unaff_ESI + 0x18);
  _Dst = (undefined4 *)FUN_004c1790();
  iVar4 = uVar2 * 4;
  pvVar1 = (void *)(*(int *)(unaff_ESI + 0x10) + iVar4);
  iVar3 = (*(int *)(unaff_ESI + 0x14) * 4 - (int)pvVar1) + *(int *)(unaff_ESI + 0x10) >> 2;
  puVar7 = _Dst + uVar2 + iVar3;
  if (iVar3 != 0) {
    _memmove_s(_Dst + uVar2,iVar3 * 4,pvVar1,iVar3 * 4);
  }
  if (local_8 < uVar2) {
    iVar3 = (int)(local_8 * 4) >> 2;
    if (iVar3 != 0) {
      _DstSize = iVar3 * 4;
      _memmove_s(puVar7,_DstSize,*(void **)(unaff_ESI + 0x10),_DstSize);
    }
    pvVar1 = (void *)(*(int *)(unaff_ESI + 0x10) + local_8 * 4);
    iVar4 = (*(int *)(unaff_ESI + 0x10) - (int)pvVar1) + iVar4 >> 2;
    puVar7 = _Dst + iVar4;
    uVar2 = local_8;
    if (iVar4 != 0) {
      _memmove_s(_Dst,iVar4 * 4,pvVar1,iVar4 * 4);
    }
  }
  else {
    iVar4 = iVar4 >> 2;
    puVar6 = puVar7 + iVar4;
    if (iVar4 != 0) {
      _memmove_s(puVar7,iVar4 * 4,*(void **)(unaff_ESI + 0x10),iVar4 * 4);
    }
    iVar4 = local_8 - uVar2;
    puVar7 = _Dst;
    if (iVar4 != 0) {
      for (; iVar4 != 0; iVar4 = iVar4 + -1) {
        *puVar6 = 0;
        puVar6 = puVar6 + 1;
      }
    }
  }
  if (uVar2 != 0) {
    for (; uVar2 != 0; uVar2 = uVar2 - 1) {
      *puVar7 = 0;
      puVar7 = puVar7 + 1;
    }
  }
  if (*(int *)(unaff_ESI + 0x10) == 0) {
    *(int *)(unaff_ESI + 0x14) = *(int *)(unaff_ESI + 0x14) + local_8;
    *(undefined4 **)(unaff_ESI + 0x10) = _Dst;
    return;
  }
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
004c8630 : PUSH EBP
004c8631 : MOV EBP,ESP
004c8633 : SUB ESP,0x10
004c8636 : MOV EAX,dword ptr [ESI + 0x14]
004c8639 : MOV ECX,0x3333333
004c863e : MOV EDX,0x1
004c8643 : SUB ECX,EAX
004c8645 : PUSH EBX
004c8646 : PUSH EDI
004c8647 : MOV dword ptr [EBP + -0x4],EDX
004c864a : CMP ECX,EDX
004c864c : JNC 0x004c8653
004c864e : CALL 0x00442c50
004c8653 : MOV ECX,EAX
004c8655 : SHR ECX,0x1
004c8657 : CMP ECX,0x8
004c865a : JNC 0x004c8663
004c865c : MOV ECX,0x8
004c8661 : JMP 0x004c8668
004c8663 : CMP ECX,0x1
004c8666 : JBE 0x004c8678
004c8668 : MOV EDI,0x3333333
004c866d : SUB EDI,ECX
004c866f : CMP EAX,EDI
004c8671 : JA 0x004c8678
004c8673 : MOV EDX,ECX
004c8675 : MOV dword ptr [EBP + -0x4],ECX
004c8678 : MOV EDI,dword ptr [ESI + 0x18]
004c867b : LEA ECX,[EAX + EDX*0x1]
004c867e : MOV dword ptr [EBP + -0xc],EDI
004c8681 : CALL 0x004c1790
004c8686 : MOV ECX,dword ptr [ESI + 0x10]
004c8689 : MOV dword ptr [EBP + -0x8],EAX
004c868c : ADD EDI,EDI
004c868e : ADD EDI,EDI
004c8690 : LEA EDX,[EDI + EAX*0x1]
004c8693 : MOV EAX,dword ptr [ESI + 0x14]
004c8696 : ADD EAX,EAX
004c8698 : LEA EBX,[ECX + EDI*0x1]
004c869b : ADD EAX,EAX
004c869d : SUB EAX,EBX
004c869f : ADD EAX,ECX
004c86a1 : SAR EAX,0x2
004c86a4 : LEA ECX,[EAX*0x4 + 0x0]
004c86ab : MOV dword ptr [EBP + -0x10],EBX
004c86ae : LEA EBX,[ECX + EDX*0x1]
004c86b1 : TEST EAX,EAX
004c86b3 : JBE 0x004c86c4
004c86b5 : MOV EAX,dword ptr [EBP + -0x10]
004c86b8 : PUSH ECX
004c86b9 : PUSH EAX
004c86ba : PUSH ECX
004c86bb : PUSH EDX
004c86bc : CALL 0x00634101
004c86c1 : ADD ESP,0x10
004c86c4 : MOV EDX,dword ptr [EBP + -0x4]
004c86c7 : MOV ECX,dword ptr [ESI + 0x10]
004c86ca : CMP dword ptr [EBP + -0xc],EDX
004c86cd : JA 0x004c8713
004c86cf : MOV EAX,ECX
004c86d1 : SUB EAX,ECX
004c86d3 : ADD EAX,EDI
004c86d5 : SAR EAX,0x2
004c86d8 : LEA EDI,[EAX*0x4 + 0x0]
004c86df : LEA EDX,[EDI + EBX*0x1]
004c86e2 : MOV dword ptr [EBP + -0x10],EDX
004c86e5 : TEST EAX,EAX
004c86e7 : JBE 0x004c86f5
004c86e9 : PUSH EDI
004c86ea : PUSH ECX
004c86eb : PUSH EDI
004c86ec : PUSH EBX
004c86ed : CALL 0x00634101
004c86f2 : ADD ESP,0x10
004c86f5 : MOV EDX,dword ptr [EBP + -0x4]
004c86f8 : MOV EBX,dword ptr [EBP + -0xc]
004c86fb : MOV ECX,EDX
004c86fd : SUB ECX,EBX
004c86ff : JZ 0x004c8708
004c8701 : MOV EDI,dword ptr [EBP + -0x10]
004c8704 : XOR EAX,EAX
004c8706 : STOSD.REP ES:EDI
004c8708 : TEST EBX,EBX
004c870a : JBE 0x004c876d
004c870c : MOV EDI,dword ptr [EBP + -0x8]
004c870f : MOV ECX,EBX
004c8711 : JMP 0x004c8769
004c8713 : LEA EAX,[EDX*0x4 + 0x0]
004c871a : SAR EAX,0x2
004c871d : TEST EAX,EAX
004c871f : JBE 0x004c8734
004c8721 : ADD EAX,EAX
004c8723 : ADD EAX,EAX
004c8725 : PUSH EAX
004c8726 : PUSH ECX
004c8727 : PUSH EAX
004c8728 : PUSH EBX
004c8729 : CALL 0x00634101
004c872e : MOV EDX,dword ptr [EBP + -0x4]
004c8731 : ADD ESP,0x10
004c8734 : MOV EAX,dword ptr [ESI + 0x10]
004c8737 : LEA EBX,[EAX + EDX*0x4]
004c873a : SUB EAX,EBX
004c873c : ADD EAX,EDI
004c873e : MOV EDI,dword ptr [EBP + -0x8]
004c8741 : SAR EAX,0x2
004c8744 : LEA ECX,[EAX*0x4 + 0x0]
004c874b : ADD EDI,ECX
004c874d : TEST EAX,EAX
004c874f : JBE 0x004c8763
004c8751 : MOV EAX,dword ptr [EBP + -0x8]
004c8754 : PUSH ECX
004c8755 : PUSH EBX
004c8756 : PUSH ECX
004c8757 : PUSH EAX
004c8758 : CALL 0x00634101
004c875d : MOV EDX,dword ptr [EBP + -0x4]
004c8760 : ADD ESP,0x10
004c8763 : TEST EDX,EDX
004c8765 : JBE 0x004c876d
004c8767 : MOV ECX,EDX
004c8769 : XOR EAX,EAX
004c876b : STOSD.REP ES:EDI
004c876d : MOV ECX,dword ptr [ESI + 0x10]
004c8770 : TEST ECX,ECX
004c8772 : JZ 0x004c877c
004c8774 : CALL 0x006f04e0
004c877c : MOV ECX,dword ptr [EBP + -0x8]
004c877f : ADD dword ptr [ESI + 0x14],EDX
004c8782 : POP EDI
004c8783 : MOV dword ptr [ESI + 0x10],ECX
004c8786 : POP EBX
004c8787 : MOV ESP,EBP
004c8789 : POP EBP
004c878a : RET

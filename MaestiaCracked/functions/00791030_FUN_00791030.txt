PROGRAM  : Maestia.exe
FUNCTION : FUN_00791030
ENTRY    : 00791030
BODY     : [[00791030, 00791185]]

============================================================
DECOMPILED C CODE
============================================================

void ** FUN_00791030(void)

{
  short sVar1;
  int iVar2;
  short *psVar3;
  void **ppvVar4;
  int iVar5;
  int unaff_ESI;
  undefined **local_21c [131];
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b36e7c;
  local_10 = ExceptionList;
  ppvVar4 = &local_10;
  if (unaff_ESI != 0) {
    iVar5 = (*(int *)(unaff_ESI + 600) - *(int *)(unaff_ESI + 0x254)) / 0x424;
    ExceptionList = ppvVar4;
    iVar2 = FUN_0047ec30(local_21c);
    local_8 = 0;
    psVar3 = (short *)(iVar2 + 8);
    do {
      sVar1 = *psVar3;
      psVar3 = psVar3 + 1;
    } while (sVar1 != 0);
    FUN_00406360((short *)(iVar2 + 8),(int)psVar3 - (iVar2 + 10) >> 1);
    local_8 = 0xffffffff;
    iVar2 = *(int *)(unaff_ESI + 0x248) - *(int *)(unaff_ESI + 0x244);
    ppvVar4 = (void **)(iVar2 * 0x7e07e07f);
    local_21c[0] = &PTR_FUN_00cd083c;
    if (iVar2 / 0x208 + (iVar2 >> 0x1f) != iVar2 >> 0x1f) {
      _rand();
      iVar2 = FUN_0047ebb0(unaff_ESI,local_21c);
      local_8 = 1;
      psVar3 = (short *)(iVar2 + 8);
      do {
        sVar1 = *psVar3;
        psVar3 = psVar3 + 1;
      } while (sVar1 != 0);
      ppvVar4 = (void **)FUN_00406360((short *)(iVar2 + 8),(int)psVar3 - (iVar2 + 10) >> 1);
    }
    local_8 = 0xffffffff;
    local_21c[0] = &PTR_FUN_00cd083c;
    if (iVar5 != 0) {
      iVar2 = 0;
      do {
        ppvVar4 = (void **)FUN_0047d4b0(*(int *)(unaff_ESI + 0x254) + iVar2);
        iVar2 = iVar2 + 0x424;
        iVar5 = iVar5 + -1;
      } while (iVar5 != 0);
    }
  }
  ExceptionList = local_10;
  return ppvVar4;
}



============================================================
DISASSEMBLY
============================================================
00791030 : PUSH EBP
00791031 : MOV EBP,ESP
00791033 : PUSH -0x1
00791035 : PUSH 0xb36e7c
0079103a : MOV EAX,FS:[0x0]
00791040 : PUSH EAX
00791041 : SUB ESP,0x20c
00791047 : PUSH EBX
00791048 : PUSH EDI
00791049 : MOV EAX,[0x00d66fa0]
0079104e : XOR EAX,EBP
00791050 : PUSH EAX
00791051 : LEA EAX,[EBP + -0xc]
00791054 : MOV FS:[0x0],EAX
0079105a : TEST ESI,ESI
0079105c : JZ 0x00791173
00791062 : MOV ECX,dword ptr [ESI + 0x258]
00791068 : SUB ECX,dword ptr [ESI + 0x254]
0079106e : MOV EAX,0x3dd38ff1
00791073 : IMUL ECX
00791075 : SAR EDX,0x8
00791078 : MOV EBX,EDX
0079107a : LEA EAX,[EBP + 0xfffffde8]
00791080 : SHR EBX,0x1f
00791083 : PUSH EAX
00791084 : MOV ECX,ESI
00791086 : ADD EBX,EDX
00791088 : CALL 0x0047ec30
0079108d : MOV dword ptr [EBP + -0x4],0x0
00791094 : LEA ECX,[EAX + 0x8]
00791097 : MOV EAX,ECX
00791099 : LEA EDX,[EAX + 0x2]
0079109c : LEA ESP,[ESP]
007910a0 : MOV DI,word ptr [EAX]
007910a3 : ADD EAX,0x2
007910a6 : TEST DI,DI
007910a9 : JNZ 0x007910a0
007910ab : SUB EAX,EDX
007910ad : SAR EAX,0x1
007910af : PUSH EAX
007910b0 : PUSH ECX
007910b1 : MOV ECX,dword ptr [EBP + 0x8]
007910b4 : ADD ECX,0x90
007910ba : CALL 0x00406360
007910bf : MOV dword ptr [EBP + -0x4],0xffffffff
007910c6 : MOV ECX,dword ptr [ESI + 0x248]
007910cc : SUB ECX,dword ptr [ESI + 0x244]
007910d2 : MOV EAX,0x7e07e07f
007910d7 : IMUL ECX
007910d9 : SAR EDX,0x8
007910dc : MOV EDI,EDX
007910de : SHR EDI,0x1f
007910e1 : ADD EDI,EDX
007910e3 : MOV dword ptr [EBP + 0xfffffde8],0xcd083c
007910ed : JZ 0x00791146
007910ef : CALL 0x00635d2f
007910f4 : XOR EDX,EDX
007910f6 : DIV EDI
007910f8 : MOV ECX,EDX
007910fa : LEA EDX,[EBP + 0xfffffde8]
00791100 : PUSH EDX
00791101 : PUSH ESI
00791102 : CALL 0x0047ebb0
00791107 : MOV dword ptr [EBP + -0x4],0x1
0079110e : LEA ECX,[EAX + 0x8]
00791111 : MOV EAX,ECX
00791113 : LEA EDI,[EAX + 0x2]
00791116 : MOV DX,word ptr [EAX]
00791119 : ADD EAX,0x2
0079111c : TEST DX,DX
0079111f : JNZ 0x00791116
00791121 : SUB EAX,EDI
00791123 : SAR EAX,0x1
00791125 : PUSH EAX
00791126 : PUSH ECX
00791127 : MOV ECX,dword ptr [EBP + 0x8]
0079112a : ADD ECX,0xac
00791130 : CALL 0x00406360
00791135 : MOV dword ptr [EBP + -0x4],0xffffffff
0079113c : MOV dword ptr [EBP + 0xfffffde8],0xcd083c
00791146 : TEST EBX,EBX
00791148 : JBE 0x00791173
0079114a : MOV EAX,dword ptr [EBP + 0x8]
0079114d : ADD EAX,0xc8
00791152 : MOV dword ptr [EBP + 0x8],EAX
00791155 : XOR EDI,EDI
00791157 : MOV ECX,dword ptr [ESI + 0x254]
0079115d : MOV EAX,dword ptr [EBP + 0x8]
00791160 : ADD ECX,EDI
00791162 : PUSH ECX
00791163 : CALL 0x0047d4b0
00791168 : ADD EDI,0x424
0079116e : SUB EBX,0x1
00791171 : JNZ 0x00791157
00791173 : MOV ECX,dword ptr [EBP + -0xc]
00791176 : MOV dword ptr FS:[0x0],ECX
0079117d : POP ECX
0079117e : POP EDI
0079117f : POP EBX
00791180 : MOV ESP,EBP
00791182 : POP EBP
00791183 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_006b8160
ENTRY    : 006b8160
BODY     : [[006b8160, 006b8283]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006b8160(uint *param_1)

{
  undefined4 uVar1;
  byte bVar2;
  short sVar3;
  short sVar4;
  ushort uVar5;
  ushort uVar6;
  uint uVar7;
  int iVar8;
  uint uVar9;
  uint uVar10;
  int iVar11;
  int unaff_EDI;
  int local_4;
  
  uVar1 = *(undefined4 *)(unaff_EDI + 0x1c);
  local_4 = 0;
  uVar7 = FUN_00687920();
  uVar10 = uVar7 & 0xff;
  *param_1 = uVar10;
  if (uVar10 == 0) {
    return -1;
  }
  if ((char)uVar7 < '\0') {
    uVar10 = FUN_00687920();
    uVar10 = uVar10 & 0xff | (uVar7 & 0x7f) << 8;
  }
  iVar8 = FUN_0068a220(uVar1,2,0,uVar10,0,&local_4);
  if (local_4 == 0) {
    iVar11 = 0;
    if (uVar10 != 0) {
      do {
        uVar9 = FUN_00687920();
        uVar7 = uVar9 & 0xff;
        if ((char)uVar9 < '\0') {
          sVar3 = FUN_00687940();
          *(short *)(iVar8 + iVar11 * 2) = sVar3;
          for (uVar9 = uVar9 & 0x7f; iVar11 = iVar11 + 1, uVar9 != 0; uVar9 = uVar9 - 1) {
            sVar4 = FUN_00687940();
            sVar3 = sVar3 + sVar4;
            *(short *)(iVar8 + iVar11 * 2) = sVar3;
          }
        }
        else {
          bVar2 = FUN_00687920();
          uVar5 = (ushort)bVar2;
          *(ushort *)(iVar8 + iVar11 * 2) = (ushort)bVar2;
          for (; iVar11 = iVar11 + 1, uVar7 != 0; uVar7 = uVar7 - 1) {
            uVar6 = FUN_00687920();
            uVar5 = uVar5 + (uVar6 & 0xff);
            *(ushort *)(iVar8 + iVar11 * 2) = uVar5;
          }
        }
      } while (iVar11 < (int)uVar10);
    }
    return iVar8;
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
006b8160 : SUB ESP,0x8
006b8163 : PUSH EBX
006b8164 : PUSH ESI
006b8165 : MOV ESI,dword ptr [EDI + 0x1c]
006b8168 : PUSH EDI
006b8169 : MOV dword ptr [ESP + 0x10],0x0
006b8171 : CALL 0x00687920
006b8176 : MOVZX EBX,AL
006b8179 : MOV EAX,dword ptr [ESP + 0x18]
006b817d : ADD ESP,0x4
006b8180 : MOV dword ptr [ESP + 0x8],EBX
006b8184 : MOV dword ptr [EAX],EBX
006b8186 : TEST EBX,EBX
006b8188 : JNZ 0x006b8193
006b818a : POP ESI
006b818b : OR EAX,0xffffffff
006b818e : POP EBX
006b818f : ADD ESP,0x8
006b8192 : RET
006b8193 : TEST BL,BL
006b8195 : JNS 0x006b81b1
006b8197 : PUSH EDI
006b8198 : CALL 0x00687920
006b819d : AND EBX,0x7f
006b81a0 : MOVZX ECX,AL
006b81a3 : SHL EBX,0x8
006b81a6 : ADD ESP,0x4
006b81a9 : OR ECX,EBX
006b81ab : MOV dword ptr [ESP + 0x8],ECX
006b81af : MOV EBX,ECX
006b81b1 : PUSH EBP
006b81b2 : LEA EDX,[ESP + 0x10]
006b81b6 : PUSH EDX
006b81b7 : PUSH 0x0
006b81b9 : PUSH EBX
006b81ba : PUSH 0x0
006b81bc : PUSH 0x2
006b81be : PUSH ESI
006b81bf : CALL 0x0068a220
006b81c4 : ADD ESP,0x18
006b81c7 : CMP dword ptr [ESP + 0x10],0x0
006b81cc : MOV EBP,EAX
006b81ce : JZ 0x006b81d9
006b81d0 : POP EBP
006b81d1 : POP ESI
006b81d2 : XOR EAX,EAX
006b81d4 : POP EBX
006b81d5 : ADD ESP,0x8
006b81d8 : RET
006b81d9 : XOR ESI,ESI
006b81db : TEST EBX,EBX
006b81dd : JLE 0x006b827b
006b81e3 : PUSH EDI
006b81e4 : CALL 0x00687920
006b81e9 : MOVZX EBX,AL
006b81ec : ADD ESP,0x4
006b81ef : PUSH EDI
006b81f0 : TEST BL,BL
006b81f2 : JNS 0x006b8233
006b81f4 : AND EBX,0x7f
006b81f7 : CALL 0x00687940
006b81fc : MOV word ptr [EBP + ESI*0x2],AX
006b8201 : MOVZX EAX,AX
006b8204 : ADD ESP,0x4
006b8207 : INC ESI
006b8208 : MOV dword ptr [ESP + 0x18],EAX
006b820c : TEST EBX,EBX
006b820e : JLE 0x006b8271
006b8210 : PUSH EDI
006b8211 : CALL 0x00687940
006b8216 : MOVZX ECX,AX
006b8219 : MOV EAX,dword ptr [ESP + 0x1c]
006b821d : ADD EAX,ECX
006b821f : MOV word ptr [EBP + ESI*0x2],AX
006b8224 : ADD ESP,0x4
006b8227 : INC ESI
006b8228 : SUB EBX,0x1
006b822b : MOV dword ptr [ESP + 0x18],EAX
006b822f : JNZ 0x006b8210
006b8231 : JMP 0x006b8271
006b8233 : CALL 0x00687920
006b8238 : MOVZX AX,AL
006b823c : MOVZX EDX,AX
006b823f : MOV word ptr [EBP + ESI*0x2],AX
006b8244 : ADD ESP,0x4
006b8247 : INC ESI
006b8248 : MOV dword ptr [ESP + 0x18],EDX
006b824c : TEST EBX,EBX
006b824e : JLE 0x006b8271
006b8250 : PUSH EDI
006b8251 : CALL 0x00687920
006b8256 : MOVZX ECX,AL
006b8259 : MOV EAX,dword ptr [ESP + 0x1c]
006b825d : ADD EAX,ECX
006b825f : MOV word ptr [EBP + ESI*0x2],AX
006b8264 : ADD ESP,0x4
006b8267 : INC ESI
006b8268 : SUB EBX,0x1
006b826b : MOV dword ptr [ESP + 0x18],EAX
006b826f : JNZ 0x006b8250
006b8271 : CMP ESI,dword ptr [ESP + 0xc]
006b8275 : JL 0x006b81e3
006b827b : MOV EAX,EBP
006b827d : POP EBP
006b827e : POP ESI
006b827f : POP EBX
006b8280 : ADD ESP,0x8
006b8283 : RET

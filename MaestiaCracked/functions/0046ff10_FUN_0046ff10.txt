PROGRAM  : Maestia.exe
FUNCTION : FUN_0046ff10
ENTRY    : 0046ff10
BODY     : [[0046ff10, 0047024b]]

============================================================
DECOMPILED C CODE
============================================================

byte FUN_0046ff10(int param_1)

{
  undefined1 uVar1;
  char cVar2;
  byte bVar3;
  uint uVar4;
  int *piVar5;
  undefined2 *puVar6;
  int in_ECX;
  int extraout_ECX;
  int iVar7;
  undefined4 extraout_EDX;
  int iVar8;
  int iVar9;
  int *piVar10;
  undefined1 local_a8 [4];
  int local_a4;
  undefined4 local_8c;
  undefined4 local_88;
  undefined2 local_84;
  undefined4 local_80;
  undefined4 local_7c;
  undefined2 local_78;
  undefined4 local_74;
  undefined4 local_70;
  undefined2 local_6c;
  undefined4 local_68;
  undefined4 local_64;
  undefined2 local_60;
  undefined4 local_5c;
  undefined4 local_58;
  undefined2 local_54;
  undefined4 local_50;
  undefined4 local_4c;
  undefined2 local_48;
  undefined4 local_44;
  undefined4 local_40;
  undefined2 local_3c;
  int local_30;
  int local_2c;
  int local_28;
  int local_24;
  undefined4 local_20;
  int local_1c;
  int local_18;
  byte local_11;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b82bfd;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_1c = *(int *)(in_ECX + 8);
  local_24 = *(int *)(in_ECX + 0xc);
  iVar8 = param_1 + 0xed8;
  bVar3 = 1;
  local_11 = 1;
  if ((0 < local_1c) && (local_24 != 0)) {
    local_88 = 10;
    local_84 = 3;
    local_7c = 10;
    local_70 = 10;
    local_68 = 10;
    local_40 = 10;
    local_8c = 0;
    local_80 = 8;
    local_78 = 4;
    local_74 = 9;
    local_6c = 4;
    local_64 = 0;
    local_60 = 4;
    local_5c = 0xb;
    local_58 = 0;
    local_54 = 4;
    local_50 = 0xc;
    local_4c = 0;
    local_48 = 4;
    local_44 = 0x11;
    local_3c = 0;
    local_2c = iVar8;
    uVar1 = FUN_004714e0(DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
    local_20 = CONCAT31(local_20._1_3_,uVar1);
    cVar2 = FUN_00471510();
    if (cVar2 != '\0') {
      uVar4 = (uint)((char)local_20 == '\0');
      *(uint *)(param_1 + 0xf30) = (uint)(uVar4 != 0) * 2 + 2;
      *(uint *)(param_1 + 0xeec) = uVar4;
      if ((uVar4 == 0) || (uVar4 == 1)) {
        piVar10 = *(int **)(in_ECX + 0xc);
        iVar7 = 0;
        iVar9 = *(int *)(in_ECX + 8);
        if (0 < *(int *)(in_ECX + 8)) {
          do {
            local_18 = iVar9;
            iVar9 = *piVar10;
            if (0 < iVar9) {
              piVar5 = (int *)(piVar10[1] + 8);
              do {
                iVar7 = iVar7 + *piVar5;
                piVar5 = piVar5 + 5;
                iVar9 = iVar9 + -1;
              } while (iVar9 != 0);
            }
            piVar10 = piVar10 + 0x10;
            local_18 = local_18 + -1;
            iVar9 = local_18;
          } while (local_18 != 0);
        }
        cVar2 = FUN_00471570(iVar7);
        if (cVar2 != '\0') {
          param_1 = param_1 + 0xdb8;
          local_30 = param_1;
          FUN_00471ba0(local_1c);
          local_28 = 0;
          if (0 < local_1c) {
            piVar10 = (int *)(local_24 + 0x14);
            do {
              cVar2 = FUN_00806e10();
              iVar9 = extraout_ECX;
              if (cVar2 != '\0') {
                bVar3 = FUN_00472020(extraout_ECX,extraout_EDX,iVar8,param_1,local_20);
                local_11 = local_11 & bVar3;
                FUN_0046fdb0(local_a8,piVar10[-1]);
                iVar9 = 0;
                local_8 = 0;
                if (0 < piVar10[-1]) {
                  puVar6 = (undefined2 *)(local_a4 + 0x2c);
                  local_18 = 0;
                  param_1 = 0;
                  iVar7 = 0;
                  do {
                    iVar8 = *piVar10;
                    *(undefined8 *)(puVar6 + -0x16) = *(undefined8 *)(iVar8 + iVar7);
                    *(undefined4 *)(puVar6 + -0x12) = *(undefined4 *)(iVar8 + iVar7 + 8);
                    iVar8 = piVar10[1];
                    if (iVar8 == 0) {
                      iVar8 = *piVar10;
                    }
                    *(undefined8 *)(puVar6 + -0x10) = *(undefined8 *)(iVar8 + iVar7);
                    *(undefined4 *)(puVar6 + -0xc) = *(undefined4 *)(iVar8 + iVar7 + 8);
                    iVar8 = piVar10[2];
                    *puVar6 = *(undefined2 *)(iVar8 + param_1);
                    *(undefined1 *)(puVar6 + 1) =
                         *(undefined1 *)((undefined2 *)(iVar8 + param_1) + 1);
                    if (piVar10[7] == 0) {
                      uVar1 = 0xff;
                    }
                    else {
                      uVar1 = *(undefined1 *)(piVar10[7] + iVar9);
                    }
                    *(undefined1 *)((int)puVar6 + 3) = uVar1;
                    *(undefined4 *)(puVar6 + -8) = *(undefined4 *)(piVar10[5] + iVar9 * 8);
                    *(undefined4 *)(puVar6 + -6) = *(undefined4 *)(piVar10[5] + 4 + iVar9 * 8);
                    if (piVar10[6] == 0) {
                      *(undefined4 *)(puVar6 + -2) = 0;
                      *(undefined4 *)(puVar6 + -4) = 0;
                    }
                    else {
                      *(undefined4 *)(puVar6 + -4) = *(undefined4 *)(piVar10[6] + iVar9 * 8);
                      *(undefined4 *)(puVar6 + -2) = *(undefined4 *)(piVar10[6] + 4 + iVar9 * 8);
                    }
                    iVar8 = piVar10[4];
                    puVar6[2] = *(undefined2 *)(iVar8 + param_1);
                    *(undefined1 *)(puVar6 + 3) =
                         *(undefined1 *)((undefined2 *)(iVar8 + param_1) + 1);
                    *(undefined1 *)((int)puVar6 + 7) = 0;
                    if (piVar10[9] == 0) {
                      *(undefined4 *)(puVar6 + -10) = 0;
                      *(undefined1 *)((int)puVar6 + 0xb) = 0;
                      *(undefined1 *)(puVar6 + 5) = 0;
                      *(undefined1 *)((int)puVar6 + 9) = 0;
                      *(undefined1 *)(puVar6 + 4) = 0;
                    }
                    else {
                      *(int *)(puVar6 + -10) = piVar10[8];
                      *(undefined4 *)(puVar6 + 4) = *(undefined4 *)(local_18 + piVar10[9]);
                    }
                    param_1 = param_1 + 3;
                    local_18 = local_18 + 6;
                    iVar9 = iVar9 + 1;
                    puVar6 = puVar6 + 0x1c;
                    iVar7 = iVar7 + 0xc;
                    iVar8 = local_2c;
                  } while (iVar9 < piVar10[-1]);
                }
                bVar3 = FUN_00472820(local_a4,piVar10[-1]);
                local_11 = local_11 & bVar3;
                local_8 = 0xffffffff;
                FUN_0046fe80(local_a8);
                iVar9 = local_28;
                param_1 = local_30;
              }
              local_28 = iVar9 + 1;
              piVar10 = piVar10 + 0x10;
            } while (local_28 < local_1c);
          }
        }
      }
    }
    bVar3 = FUN_004728f0();
    local_11 = local_11 & bVar3;
    bVar3 = FUN_004744b0();
    bVar3 = local_11 & bVar3;
  }
  ExceptionList = local_10;
  return bVar3;
}



============================================================
DISASSEMBLY
============================================================
0046ff10 : PUSH EBP
0046ff11 : MOV EBP,ESP
0046ff13 : PUSH -0x1
0046ff15 : PUSH 0xb82bfd
0046ff1a : MOV EAX,FS:[0x0]
0046ff20 : PUSH EAX
0046ff21 : SUB ESP,0x98
0046ff27 : PUSH EBX
0046ff28 : PUSH ESI
0046ff29 : PUSH EDI
0046ff2a : MOV EAX,[0x00d66fa0]
0046ff2f : XOR EAX,EBP
0046ff31 : PUSH EAX
0046ff32 : LEA EAX,[EBP + -0xc]
0046ff35 : MOV FS:[0x0],EAX
0046ff3b : MOV ESI,ECX
0046ff3d : MOV EDI,dword ptr [ESI + 0x8]
0046ff40 : MOV EBX,dword ptr [EBP + 0x8]
0046ff43 : MOV ECX,dword ptr [ESI + 0xc]
0046ff46 : ADD EBX,0xed8
0046ff4c : MOV AL,0x1
0046ff4e : MOV byte ptr [EBP + -0xd],AL
0046ff51 : MOV dword ptr [EBP + -0x18],EDI
0046ff54 : MOV dword ptr [EBP + -0x20],ECX
0046ff57 : MOV dword ptr [EBP + -0x28],EBX
0046ff5a : TEST EDI,EDI
0046ff5c : JLE 0x00470238
0046ff62 : TEST ECX,ECX
0046ff64 : JZ 0x00470238
0046ff6a : MOV EAX,0xa
0046ff6f : MOV EDX,0x3
0046ff74 : MOV dword ptr [EBP + 0xffffff7c],EAX
0046ff7a : MOV word ptr [EBP + -0x80],DX
0046ff7e : MOV EDX,0x4
0046ff83 : MOV dword ptr [EBP + -0x78],EAX
0046ff86 : MOV dword ptr [EBP + -0x6c],EAX
0046ff89 : MOV dword ptr [EBP + -0x64],EAX
0046ff8c : MOV dword ptr [EBP + -0x3c],EAX
0046ff8f : XOR EAX,EAX
0046ff91 : MOV dword ptr [EBP + 0xffffff78],0x0
0046ff9b : MOV dword ptr [EBP + -0x7c],0x8
0046ffa2 : MOV word ptr [EBP + -0x74],DX
0046ffa6 : MOV dword ptr [EBP + -0x70],0x9
0046ffad : MOV word ptr [EBP + -0x68],DX
0046ffb1 : MOV dword ptr [EBP + -0x60],0x0
0046ffb8 : MOV word ptr [EBP + -0x5c],DX
0046ffbc : MOV dword ptr [EBP + -0x58],0xb
0046ffc3 : MOV dword ptr [EBP + -0x54],0x0
0046ffca : MOV word ptr [EBP + -0x50],DX
0046ffce : MOV dword ptr [EBP + -0x4c],0xc
0046ffd5 : MOV dword ptr [EBP + -0x48],0x0
0046ffdc : MOV word ptr [EBP + -0x44],DX
0046ffe0 : MOV dword ptr [EBP + -0x40],0x11
0046ffe7 : MOV word ptr [EBP + -0x38],AX
0046ffeb : CALL 0x004714e0
0046fff0 : MOV byte ptr [EBP + -0x1c],AL
0046fff3 : LEA ECX,[EBP + 0xffffff78]
0046fff9 : MOV EAX,EBX
0046fffb : CALL 0x00471510
00470000 : TEST AL,AL
00470002 : JZ 0x00470222
00470008 : XOR EAX,EAX
0047000a : CMP byte ptr [EBP + -0x1c],AL
0047000d : SETZ AL
00470010 : XOR ECX,ECX
00470012 : TEST EAX,EAX
00470014 : SETNZ CL
00470017 : LEA ECX,[ECX + ECX*0x1 + 0x2]
0047001b : MOV dword ptr [EBX + 0x58],ECX
0047001e : MOV dword ptr [EBX + 0x14],EAX
00470021 : TEST EAX,EAX
00470023 : JZ 0x0047002e
00470025 : CMP EAX,0x1
00470028 : JNZ 0x00470222
0047002e : MOV EAX,dword ptr [ESI + 0x8]
00470031 : MOV ESI,dword ptr [ESI + 0xc]
00470034 : XOR ECX,ECX
00470036 : XOR EDX,EDX
00470038 : TEST EAX,EAX
0047003a : JLE 0x00470063
0047003c : MOV EDI,ESI
0047003e : MOV dword ptr [EBP + -0x14],EAX
00470041 : MOV ESI,dword ptr [EDI]
00470043 : ADD ECX,dword ptr [EDI + 0x10]
00470046 : TEST ESI,ESI
00470048 : JLE 0x0047005a
0047004a : MOV EAX,dword ptr [EDI + 0x4]
0047004d : ADD EAX,0x8
00470050 : ADD EDX,dword ptr [EAX]
00470052 : ADD EAX,0x14
00470055 : SUB ESI,0x1
00470058 : JNZ 0x00470050
0047005a : ADD EDI,0x40
0047005d : SUB dword ptr [EBP + -0x14],0x1
00470061 : JNZ 0x00470041
00470063 : PUSH EDX
00470064 : MOV ESI,EBX
00470066 : CALL 0x00471570
0047006b : TEST AL,AL
0047006d : JZ 0x00470222
00470073 : MOV EDI,dword ptr [EBP + 0x8]
00470076 : MOV EDX,dword ptr [EBP + -0x18]
00470079 : MOV ECX,dword ptr [EBP + -0x20]
0047007c : ADD EDI,0xdb8
00470082 : PUSH EDX
00470083 : MOV ESI,EDI
00470085 : MOV dword ptr [EBP + -0x2c],EDI
00470088 : CALL 0x00471ba0
0047008d : XOR ECX,ECX
0047008f : CMP dword ptr [EBP + -0x18],ECX
00470092 : MOV dword ptr [EBP + -0x24],ECX
00470095 : JLE 0x00470222
0047009b : MOV ESI,dword ptr [EBP + -0x20]
0047009e : ADD ESI,0x14
004700a1 : LEA EDX,[ESI + -0x14]
004700a4 : MOV EAX,EDX
004700a6 : CALL 0x00806e10
004700ab : TEST AL,AL
004700ad : JZ 0x00470212
004700b3 : MOV EAX,dword ptr [EBP + -0x1c]
004700b6 : PUSH EAX
004700b7 : PUSH EDI
004700b8 : PUSH EBX
004700b9 : PUSH EDX
004700ba : PUSH ECX
004700bb : CALL 0x00472020
004700c0 : MOV ECX,dword ptr [ESI + -0x4]
004700c3 : AND byte ptr [EBP + -0xd],AL
004700c6 : PUSH ECX
004700c7 : LEA EDX,[EBP + 0xffffff5c]
004700cd : PUSH EDX
004700ce : CALL 0x0046fdb0
004700d3 : XOR EDX,EDX
004700d5 : MOV dword ptr [EBP + -0x4],EDX
004700d8 : CMP dword ptr [ESI + -0x4],EDX
004700db : JLE 0x004701e4
004700e1 : MOV EAX,dword ptr [EBP + 0xffffff60]
004700e7 : XORPS XMM0,XMM0
004700ea : ADD EAX,0x2c
004700ed : MOV dword ptr [EBP + -0x14],EDX
004700f0 : MOV dword ptr [EBP + 0x8],EDX
004700f3 : XOR EBX,EBX
004700f5 : MOV ECX,dword ptr [ESI]
004700f7 : MOVQ XMM1,qword ptr [ECX + EBX*0x1]
004700fc : ADD ECX,EBX
004700fe : MOVQ qword ptr [EAX + -0x2c],XMM1
00470103 : MOV ECX,dword ptr [ECX + 0x8]
00470106 : MOV dword ptr [EAX + -0x24],ECX
00470109 : MOV ECX,dword ptr [ESI + 0x4]
0047010c : TEST ECX,ECX
0047010e : JNZ 0x00470112
00470110 : MOV ECX,dword ptr [ESI]
00470112 : MOVQ XMM1,qword ptr [ECX + EBX*0x1]
00470117 : ADD ECX,EBX
00470119 : MOVQ qword ptr [EAX + -0x20],XMM1
0047011e : MOV ECX,dword ptr [ECX + 0x8]
00470121 : MOV dword ptr [EAX + -0x18],ECX
00470124 : MOV ECX,dword ptr [ESI + 0x8]
00470127 : ADD ECX,dword ptr [EBP + 0x8]
0047012a : MOV DI,word ptr [ECX]
0047012d : MOV word ptr [EAX],DI
00470130 : MOV CL,byte ptr [ECX + 0x2]
00470133 : MOV byte ptr [EAX + 0x2],CL
00470136 : MOV EDI,dword ptr [ESI + 0x1c]
00470139 : TEST EDI,EDI
0047013b : JZ 0x00470143
0047013d : MOVZX ECX,byte ptr [EDI + EDX*0x1]
00470141 : JMP 0x00470148
00470143 : MOV ECX,0xff
00470148 : MOV byte ptr [EAX + 0x3],CL
0047014b : MOV ECX,dword ptr [ESI + 0x14]
0047014e : FLD float ptr [ECX + EDX*0x8]
00470151 : FSTP float ptr [EAX + -0x10]
00470154 : MOV ECX,dword ptr [ESI + 0x14]
00470157 : FLD float ptr [ECX + EDX*0x8 + 0x4]
0047015b : FSTP float ptr [EAX + -0xc]
0047015e : CMP dword ptr [ESI + 0x18],0x0
00470162 : JZ 0x00470179
00470164 : MOV ECX,dword ptr [ESI + 0x18]
00470167 : FLD float ptr [ECX + EDX*0x8]
0047016a : FSTP float ptr [EAX + -0x8]
0047016d : MOV ECX,dword ptr [ESI + 0x18]
00470170 : FLD float ptr [ECX + EDX*0x8 + 0x4]
00470174 : FSTP float ptr [EAX + -0x4]
00470177 : JMP 0x00470183
00470179 : MOVSS dword ptr [EAX + -0x4],XMM0
0047017e : MOVSS dword ptr [EAX + -0x8],XMM0
00470183 : MOV ECX,dword ptr [ESI + 0x10]
00470186 : ADD ECX,dword ptr [EBP + 0x8]
00470189 : MOV DI,word ptr [ECX]
0047018c : MOV word ptr [EAX + 0x4],DI
00470190 : MOV CL,byte ptr [ECX + 0x2]
00470193 : MOV byte ptr [EAX + 0x6],CL
00470196 : MOV byte ptr [EAX + 0x7],0x0
0047019a : CMP dword ptr [ESI + 0x24],0x0
0047019e : JZ 0x004701b4
004701a0 : FLD float ptr [ESI + 0x20]
004701a3 : MOV EDI,dword ptr [EBP + -0x14]
004701a6 : FSTP float ptr [EAX + -0x14]
004701a9 : MOV ECX,dword ptr [ESI + 0x24]
004701ac : MOV ECX,dword ptr [EDI + ECX*0x1]
004701af : MOV dword ptr [EAX + 0x8],ECX
004701b2 : JMP 0x004701c9
004701b4 : MOVSS dword ptr [EAX + -0x14],XMM0
004701b9 : MOV byte ptr [EAX + 0xb],0x0
004701bd : MOV byte ptr [EAX + 0xa],0x0
004701c1 : MOV byte ptr [EAX + 0x9],0x0
004701c5 : MOV byte ptr [EAX + 0x8],0x0
004701c9 : ADD dword ptr [EBP + 0x8],0x3
004701cd : ADD dword ptr [EBP + -0x14],0x6
004701d1 : INC EDX
004701d2 : ADD EAX,0x38
004701d5 : ADD EBX,0xc
004701d8 : CMP EDX,dword ptr [ESI + -0x4]
004701db : JL 0x004700f5
004701e1 : MOV EBX,dword ptr [EBP + -0x28]
004701e4 : MOV EDX,dword ptr [ESI + -0x4]
004701e7 : MOV EAX,dword ptr [EBP + 0xffffff60]
004701ed : PUSH EDX
004701ee : PUSH EAX
004701ef : MOV EDI,EBX
004701f1 : CALL 0x00472820
004701f6 : AND byte ptr [EBP + -0xd],AL
004701f9 : MOV dword ptr [EBP + -0x4],0xffffffff
00470200 : LEA ECX,[EBP + 0xffffff5c]
00470206 : PUSH ECX
00470207 : CALL 0x0046fe80
0047020c : MOV EDI,dword ptr [EBP + -0x2c]
0047020f : MOV ECX,dword ptr [EBP + -0x24]
00470212 : INC ECX
00470213 : ADD ESI,0x40
00470216 : CMP ECX,dword ptr [EBP + -0x18]
00470219 : MOV dword ptr [EBP + -0x24],ECX
0047021c : JL 0x004700a1
00470222 : MOV EDI,EBX
00470224 : CALL 0x004728f0
00470229 : AND byte ptr [EBP + -0xd],AL
0047022c : CALL 0x004744b0
00470231 : MOV CL,byte ptr [EBP + -0xd]
00470234 : AND CL,AL
00470236 : MOV AL,CL
00470238 : MOV ECX,dword ptr [EBP + -0xc]
0047023b : MOV dword ptr FS:[0x0],ECX
00470242 : POP ECX
00470243 : POP EDI
00470244 : POP ESI
00470245 : POP EBX
00470246 : MOV ESP,EBP
00470248 : POP EBP
00470249 : RET 0x4

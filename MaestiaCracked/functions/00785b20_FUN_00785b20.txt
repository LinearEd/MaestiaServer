PROGRAM  : Maestia.exe
FUNCTION : FUN_00785b20
ENTRY    : 00785b20
BODY     : [[00785b20, 00785cb9] [00785cc0, 00785cfc] [00785d00, 00785da5]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00785b20(undefined4 param_1,LPOVERLAPPED param_2,int param_3)

{
  undefined4 *puVar1;
  int *piVar2;
  int *piVar3;
  ULONG_PTR dwCompletionKey;
  uint uVar4;
  int iVar5;
  undefined4 uVar6;
  LONG *lpAddend;
  int *in_ECX;
  ULONG_PTR *pUVar7;
  int local_b4;
  LPCRITICAL_SECTION local_b0;
  char *local_ac;
  undefined4 local_a8;
  undefined **local_a4;
  undefined4 local_a0;
  undefined1 local_9c [136];
  void *local_14;
  undefined1 *puStack_10;
  int local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b193f5;
  local_14 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xffffff38;
  ExceptionList = &local_14;
  local_b0 = (LPCRITICAL_SECTION)(in_ECX + 0x54);
  local_a4 = (undefined **)0x0;
  local_ac = ".\\Terrain\\AvaQuadNode.cpp";
  local_a8 = 0x199;
  local_a0 = 1;
  FUN_006ef1a0(&local_b0);
  local_c = 0;
  if ((char)in_ECX[0x52] != '\0') {
    if (in_ECX[0x51] == 0) {
      iVar5 = FUN_006f0760(0x1d8,"",0,(DAT_01725270 >> 3 & 1) == 0,uVar4);
      local_c._0_1_ = 1;
      if (iVar5 == 0) {
        iVar5 = 0;
      }
      else {
        iVar5 = FUN_00484270(iVar5);
      }
      local_c = (uint)local_c._1_3_ << 8;
      in_ECX[0x51] = iVar5;
    }
    uVar6 = (**(code **)(*in_ECX + 8))(local_9c);
    puStack_10 = (undefined1 *)CONCAT31(puStack_10._1_3_,2);
    (**(code **)(*(int *)in_ECX[0x51] + 0x30))(uVar6);
    local_14 = (void *)((uint)local_14 & 0xffffff00);
    *(short *)(in_ECX[0x51] + 0x1d4) = (short)in_ECX[10];
    local_a4 = &PTR_FUN_00cd083c;
    (**(code **)(param_2->Internal + 0x10))(in_ECX[0x51],param_1,0);
  }
  if (param_3 == 2) {
    param_3 = FUN_007f2d40();
  }
  if (param_3 == 0) {
    local_c = 0xffffffff;
    if (local_a4 != (undefined **)0x0) {
      LeaveCriticalSection(local_b0);
      ExceptionList = local_14;
      return;
    }
  }
  else {
    if (in_ECX[3] != 0) {
      piVar2 = (int *)in_ECX[2];
      piVar3 = (int *)*piVar2;
      while (piVar3 != piVar2) {
        FUN_007fafe0(param_2);
        FUN_00430160();
        piVar2 = (int *)in_ECX[2];
      }
    }
    pUVar7 = (ULONG_PTR *)(in_ECX + 6);
    local_b4 = 4;
    do {
      dwCompletionKey = *pUVar7;
      if (dwCompletionKey != 0) {
        puVar1 = (undefined4 *)(DAT_017251ac + 0x4b4);
        if (*(int *)(DAT_017251ac + 0x4b4) == -1) {
          FUN_00785b20(param_1,param_2,param_3);
        }
        else {
          lpAddend = (LONG *)(DAT_017251ac + 0x4fc);
          *(undefined4 *)(dwCompletionKey + 0x168) = param_1;
          *(int *)(dwCompletionKey + 0x16c) = param_3;
          InterlockedIncrement(lpAddend);
          PostQueuedCompletionStatus((HANDLE)*puVar1,2,dwCompletionKey,param_2);
        }
      }
      pUVar7 = pUVar7 + 1;
      local_b4 = local_b4 + -1;
    } while (local_b4 != 0);
    local_c = 0xffffffff;
    if (local_a4 != (undefined **)0x0) {
      LeaveCriticalSection(local_b0);
    }
  }
  ExceptionList = local_14;
  return;
}



============================================================
DISASSEMBLY
============================================================
00785b20 : PUSH EBP
00785b21 : MOV EBP,ESP
00785b23 : AND ESP,0xfffffff8
00785b26 : PUSH -0x1
00785b28 : PUSH 0xb193f5
00785b2d : MOV EAX,FS:[0x0]
00785b33 : PUSH EAX
00785b34 : SUB ESP,0xa8
00785b3a : PUSH EBX
00785b3b : PUSH ESI
00785b3c : PUSH EDI
00785b3d : MOV EAX,[0x00d66fa0]
00785b42 : XOR EAX,ESP
00785b44 : PUSH EAX
00785b45 : LEA EAX,[ESP + 0xb8]
00785b4c : MOV FS:[0x0],EAX
00785b52 : MOV EBX,ECX
00785b54 : LEA ECX,[ESP + 0x1c]
00785b58 : LEA EAX,[EBX + 0x150]
00785b5e : XOR ESI,ESI
00785b60 : PUSH ECX
00785b61 : MOV dword ptr [ESP + 0x2c],ESI
00785b65 : MOV dword ptr [ESP + 0x20],EAX
00785b69 : MOV dword ptr [ESP + 0x24],0xc113d4
00785b71 : MOV dword ptr [ESP + 0x28],0x199
00785b79 : MOV dword ptr [ESP + 0x30],0x1
00785b81 : CALL 0x006ef1a0
00785b86 : MOV dword ptr [ESP + 0xc0],ESI
00785b8d : CMP byte ptr [EBX + 0x148],0x0
00785b94 : JZ 0x00785c4e
00785b9a : CMP dword ptr [EBX + 0x144],ESI
00785ba0 : JNZ 0x00785bef
00785ba2 : MOV EDX,dword ptr [0x01725270]
00785ba8 : SHR EDX,0x3
00785bab : MOV EAX,ESI
00785bad : AND EDX,0x1
00785bb0 : SETZ AL
00785bb3 : PUSH EAX
00785bb4 : PUSH ESI
00785bb5 : PUSH 0xbf1a4a
00785bba : PUSH 0x1d8
00785bbf : CALL 0x006f0760
00785bc4 : ADD ESP,0x10
00785bc7 : MOV dword ptr [ESP + 0x18],EAX
00785bcb : MOV byte ptr [ESP + 0xc0],0x1
00785bd3 : CMP EAX,ESI
00785bd5 : JZ 0x00785bdf
00785bd7 : PUSH EAX
00785bd8 : CALL 0x00484270
00785bdd : JMP 0x00785be1
00785bdf : XOR EAX,EAX
00785be1 : MOV byte ptr [ESP + 0xc0],0x0
00785be9 : MOV dword ptr [EBX + 0x144],EAX
00785bef : MOV EDX,dword ptr [EBX]
00785bf1 : MOV EDX,dword ptr [EDX + 0x8]
00785bf4 : LEA EAX,[ESP + 0x30]
00785bf8 : PUSH EAX
00785bf9 : MOV ECX,EBX
00785bfb : CALL EDX
00785bfd : MOV byte ptr [ESP + 0xc0],0x2
00785c05 : MOV ECX,dword ptr [EBX + 0x144]
00785c0b : MOV EDX,dword ptr [ECX]
00785c0d : PUSH EAX
00785c0e : MOV EAX,dword ptr [EDX + 0x30]
00785c11 : CALL EAX
00785c13 : MOV byte ptr [ESP + 0xc0],0x0
00785c1b : MOVZX EAX,word ptr [EBX + 0x28]
00785c1f : MOV ECX,dword ptr [EBX + 0x144]
00785c25 : MOV EDI,dword ptr [EBP + 0xc]
00785c28 : MOV word ptr [ECX + 0x1d4],AX
00785c2f : MOV EAX,dword ptr [EBP + 0x8]
00785c32 : MOV ECX,dword ptr [EBX + 0x144]
00785c38 : MOV EDX,dword ptr [EDI]
00785c3a : MOV EDX,dword ptr [EDX + 0x10]
00785c3d : PUSH ESI
00785c3e : PUSH EAX
00785c3f : PUSH ECX
00785c40 : MOV ECX,EDI
00785c42 : MOV dword ptr [ESP + 0x3c],0xcd083c
00785c4a : CALL EDX
00785c4c : JMP 0x00785c51
00785c4e : MOV EDI,dword ptr [EBP + 0xc]
00785c51 : CMP dword ptr [EBP + 0x10],0x2
00785c55 : JNZ 0x00785c65
00785c57 : MOV EDX,dword ptr [EBP + 0x8]
00785c5a : LEA EAX,[EBX + 0x3c]
00785c5d : CALL 0x007f2d40
00785c62 : MOV dword ptr [EBP + 0x10],EAX
00785c65 : CMP dword ptr [EBP + 0x10],ESI
00785c68 : JNZ 0x00785ca6
00785c6a : MOV dword ptr [ESP + 0xc0],0xffffffff
00785c75 : CMP dword ptr [ESP + 0x28],ESI
00785c79 : JZ 0x00785d8e
00785c7f : MOV EAX,dword ptr [ESP + 0x1c]
00785c83 : PUSH EAX
00785c84 : CALL dword ptr [0x00b8511c]
00785c8a : MOV dword ptr [ESP + 0x28],ESI
00785c8e : MOV ECX,dword ptr [ESP + 0xb8]
00785c95 : MOV dword ptr FS:[0x0],ECX
00785c9c : POP ECX
00785c9d : POP EDI
00785c9e : POP ESI
00785c9f : POP EBX
00785ca0 : MOV ESP,EBP
00785ca2 : POP EBP
00785ca3 : RET 0xc
00785ca6 : CMP dword ptr [EBX + 0xc],ESI
00785ca9 : JZ 0x00785cec
00785cab : MOV EAX,dword ptr [EBX + 0x8]
00785cae : MOV EDX,dword ptr [EAX]
00785cb0 : MOV dword ptr [ESP + 0x14],EDX
00785cb4 : CMP EDX,EAX
00785cb6 : JZ 0x00785cec
00785cb8 : JMP 0x00785cc0
00785cc0 : MOV EAX,dword ptr [EBP + 0x10]
00785cc3 : MOV ECX,dword ptr [EBP + 0x8]
00785cc6 : MOV ESI,dword ptr [EDX + 0x28]
00785cc9 : PUSH EDI
00785cca : MOV EDI,dword ptr [0x017251ac]
00785cd0 : CALL 0x007fafe0
00785cd5 : LEA EDX,[ESP + 0x14]
00785cd9 : CALL 0x00430160
00785cde : MOV EAX,dword ptr [EBX + 0x8]
00785ce1 : MOV EDX,dword ptr [ESP + 0x14]
00785ce5 : MOV EDI,dword ptr [EBP + 0xc]
00785ce8 : CMP EDX,EAX
00785cea : JNZ 0x00785cc0
00785cec : ADD EBX,0x18
00785cef : MOV dword ptr [ESP + 0x14],EBX
00785cf3 : MOV dword ptr [ESP + 0x18],0x4
00785cfb : JMP 0x00785d00
00785d00 : MOV ESI,dword ptr [EBX]
00785d02 : TEST ESI,ESI
00785d04 : JZ 0x00785d57
00785d06 : MOV EAX,[0x017251ac]
00785d0b : CMP dword ptr [EAX + 0x4b4],-0x1
00785d12 : LEA EBX,[EAX + 0x4b4]
00785d18 : JNZ 0x00785d2c
00785d1a : MOV ECX,dword ptr [EBP + 0x10]
00785d1d : MOV EDX,dword ptr [EBP + 0x8]
00785d20 : PUSH ECX
00785d21 : PUSH EDI
00785d22 : PUSH EDX
00785d23 : MOV ECX,ESI
00785d25 : CALL 0x00785b20
00785d2a : JMP 0x00785d57
00785d2c : MOV ECX,dword ptr [EBP + 0x8]
00785d2f : MOV EDX,dword ptr [EBP + 0x10]
00785d32 : ADD EAX,0x4fc
00785d37 : PUSH EAX
00785d38 : MOV dword ptr [ESI + 0x168],ECX
00785d3e : MOV dword ptr [ESI + 0x16c],EDX
00785d44 : CALL dword ptr [0x00b850dc]
00785d4a : MOV EAX,dword ptr [EBX]
00785d4c : PUSH EDI
00785d4d : PUSH ESI
00785d4e : PUSH 0x2
00785d50 : PUSH EAX
00785d51 : CALL dword ptr [0x00b85388]
00785d57 : MOV EBX,dword ptr [ESP + 0x14]
00785d5b : ADD EBX,0x4
00785d5e : SUB dword ptr [ESP + 0x18],0x1
00785d63 : MOV dword ptr [ESP + 0x14],EBX
00785d67 : JNZ 0x00785d00
00785d69 : MOV dword ptr [ESP + 0xc0],0xffffffff
00785d74 : CMP dword ptr [ESP + 0x28],0x0
00785d79 : JZ 0x00785d8e
00785d7b : MOV ECX,dword ptr [ESP + 0x1c]
00785d7f : PUSH ECX
00785d80 : CALL dword ptr [0x00b8511c]
00785d86 : MOV dword ptr [ESP + 0x28],0x0
00785d8e : MOV ECX,dword ptr [ESP + 0xb8]
00785d95 : MOV dword ptr FS:[0x0],ECX
00785d9c : POP ECX
00785d9d : POP EDI
00785d9e : POP ESI
00785d9f : POP EBX
00785da0 : MOV ESP,EBP
00785da2 : POP EBP
00785da3 : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_00442cc0
ENTRY    : 00442cc0
BODY     : [[00442cc0, 00442ddc] [00442de0, 00442dfa] [00442e3f, 00442eb8] [00442ed6, 00442f53]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00442cc0(uint param_1,int param_2)

{
  int iVar1;
  uint *puVar2;
  int iVar3;
  uint uVar4;
  undefined4 uVar5;
  undefined4 in_ECX;
  uint extraout_ECX;
  uint uStack_7c;
  uint local_64;
  uint local_60;
  undefined1 local_5c [68];
  uint local_18;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7b264;
  local_10 = ExceptionList;
  uStack_7c = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&uStack_7c;
  ExceptionList = &local_10;
  iVar3 = *(int *)(param_1 + 4);
  if (iVar3 == 0) {
    local_64 = 0;
  }
  else {
    local_64 = *(int *)(param_1 + 0xc) - iVar3 >> 6;
  }
  iVar1 = *(int *)(param_1 + 8);
  iVar3 = iVar1 - iVar3 >> 6;
  local_18 = uStack_7c;
  puVar2 = &uStack_7c;
  if (iVar3 == 0x3ffffff) {
    iVar3 = FUN_00452880();
    local_64 = extraout_ECX;
    puVar2 = (uint *)local_14;
  }
  local_14 = (undefined1 *)puVar2;
  uVar4 = iVar3 + 1;
  if (local_64 < uVar4) {
    if (0x3ffffff - (local_64 >> 1) < local_64) {
      local_64 = 0;
    }
    else {
      local_64 = local_64 + (local_64 >> 1);
    }
    if (local_64 < uVar4) {
      local_64 = uVar4;
    }
    iVar3 = FUN_0044ec30();
    local_8 = 0;
    FUN_00442c20(in_ECX);
    FUN_00443000(*(undefined4 *)(param_1 + 4),param_2);
    FUN_00443000(param_2,*(undefined4 *)(param_1 + 8));
    local_8 = 0xffffffff;
    if (*(int *)(param_1 + 4) != 0) {
      FUN_00442bb0();
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    *(uint *)(param_1 + 0xc) = local_64 * 0x40 + iVar3;
    *(int *)(param_1 + 8) =
         ((*(int *)(param_1 + 8) - *(int *)(param_1 + 4) >> 6) + 1) * 0x40 + iVar3;
    *(int *)(param_1 + 4) = iVar3;
  }
  else {
    if (iVar1 - param_2 >> 6 == 0) {
      FUN_00442f60(local_5c);
      local_8 = 2;
      FUN_00443000(param_2,*(undefined4 *)(param_1 + 8));
      local_8 = CONCAT31(local_8._1_3_,3);
      FUN_00442c20(local_5c);
      local_8 = 2;
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 0x40;
      FUN_00443180(*(int *)(param_1 + 8) + -0x40);
    }
    else {
      FUN_00442f60(local_5c);
      local_8 = 5;
      uVar5 = FUN_00443000(*(int *)(param_1 + 8) + -0x40,*(int *)(param_1 + 8));
      *(undefined4 *)(param_1 + 8) = uVar5;
      local_60 = param_1 & 0xffffff00;
      FUN_004431e0(param_2,local_60,local_60,local_60);
      FUN_00443180(param_2 + 0x40);
    }
    local_8 = 0xffffffff;
    FUN_004427d0(local_5c);
  }
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00442cc0 : PUSH EBP
00442cc1 : MOV EBP,ESP
00442cc3 : PUSH -0x1
00442cc5 : PUSH 0xb7b264
00442cca : MOV EAX,FS:[0x0]
00442cd0 : PUSH EAX
00442cd1 : SUB ESP,0x5c
00442cd4 : MOV EAX,[0x00d66fa0]
00442cd9 : XOR EAX,EBP
00442cdb : MOV dword ptr [EBP + -0x14],EAX
00442cde : PUSH EBX
00442cdf : PUSH ESI
00442ce0 : PUSH EDI
00442ce1 : PUSH EAX
00442ce2 : LEA EAX,[EBP + -0xc]
00442ce5 : MOV FS:[0x0],EAX
00442ceb : MOV dword ptr [EBP + -0x10],ESP
00442cee : MOV EBX,dword ptr [EBP + 0x8]
00442cf1 : MOV dword ptr [EBP + -0x5c],EBX
00442cf4 : MOV EDI,ECX
00442cf6 : MOV EDX,dword ptr [EBX + 0x4]
00442cf9 : TEST EDX,EDX
00442cfb : JNZ 0x00442d01
00442cfd : XOR ECX,ECX
00442cff : JMP 0x00442d0b
00442d01 : MOV EAX,dword ptr [EBX + 0xc]
00442d04 : SUB EAX,EDX
00442d06 : SAR EAX,0x6
00442d09 : MOV ECX,EAX
00442d0b : MOV ESI,dword ptr [EBX + 0x8]
00442d0e : MOV EAX,ESI
00442d10 : SUB EAX,EDX
00442d12 : SAR EAX,0x6
00442d15 : MOV EDX,0x3ffffff
00442d1a : SUB EDX,EAX
00442d1c : CMP EDX,0x1
00442d1f : JNC 0x00442d26
00442d21 : CALL 0x00452880
00442d26 : INC EAX
00442d27 : CMP ECX,EAX
00442d29 : JNC 0x00442e3f
00442d2f : MOV EDX,ECX
00442d31 : SHR EDX,0x1
00442d33 : MOV ESI,0x3ffffff
00442d38 : SUB ESI,EDX
00442d3a : CMP ESI,ECX
00442d3c : JNC 0x00442d47
00442d3e : XOR ESI,ESI
00442d40 : MOV dword ptr [EBP + -0x60],ESI
00442d43 : MOV ECX,ESI
00442d45 : JMP 0x00442d4e
00442d47 : ADD ECX,EDX
00442d49 : MOV dword ptr [EBP + -0x60],ECX
00442d4c : XOR ESI,ESI
00442d4e : CMP ECX,EAX
00442d50 : JNC 0x00442d57
00442d52 : MOV dword ptr [EBP + -0x60],EAX
00442d55 : MOV ECX,EAX
00442d57 : CALL 0x0044ec30
00442d5c : MOV dword ptr [EBP + -0x68],EAX
00442d5f : MOV ECX,dword ptr [EBP + 0xc]
00442d62 : SUB ECX,dword ptr [EBX + 0x4]
00442d65 : SAR ECX,0x6
00442d68 : MOV dword ptr [EBP + -0x5c],ECX
00442d6b : MOV dword ptr [EBP + -0x64],ESI
00442d6e : MOV dword ptr [EBP + -0x4],ESI
00442d71 : PUSH EDI
00442d72 : MOV EDI,ECX
00442d74 : SHL EDI,0x6
00442d77 : ADD EDI,EAX
00442d79 : MOV ESI,0x1
00442d7e : CALL 0x00442c20
00442d83 : MOV dword ptr [EBP + -0x64],ESI
00442d86 : MOV EAX,dword ptr [EBP + 0xc]
00442d89 : PUSH EAX
00442d8a : MOV ECX,dword ptr [EBX + 0x4]
00442d8d : PUSH ECX
00442d8e : MOV EDI,dword ptr [EBP + -0x68]
00442d91 : MOV EDX,EDI
00442d93 : CALL 0x00443000
00442d98 : MOV dword ptr [EBP + -0x64],0x2
00442d9f : MOV EDX,dword ptr [EBP + -0x5c]
00442da2 : INC EDX
00442da3 : SHL EDX,0x6
00442da6 : ADD EDX,EDI
00442da8 : MOV EAX,dword ptr [EBX + 0x8]
00442dab : PUSH EAX
00442dac : MOV ECX,dword ptr [EBP + 0xc]
00442daf : PUSH ECX
00442db0 : CALL 0x00443000
00442db5 : MOV dword ptr [EBP + -0x4],0xffffffff
00442dbc : MOV ECX,dword ptr [EBX + 0x8]
00442dbf : MOV EAX,dword ptr [EBX + 0x4]
00442dc2 : MOV ESI,ECX
00442dc4 : SUB ESI,EAX
00442dc6 : SAR ESI,0x6
00442dc9 : INC ESI
00442dca : TEST EAX,EAX
00442dcc : JZ 0x00442de0
00442dce : MOV EDI,ECX
00442dd0 : CALL 0x00442bb0
00442dd5 : MOV ECX,dword ptr [EBX + 0x4]
00442dd8 : CALL 0x006f04e0
00442de0 : MOV EAX,dword ptr [EBP + -0x60]
00442de3 : SHL EAX,0x6
00442de6 : ADD EAX,EDI
00442de8 : MOV dword ptr [EBX + 0xc],EAX
00442deb : SHL ESI,0x6
00442dee : ADD ESI,EDI
00442df0 : MOV dword ptr [EBX + 0x8],ESI
00442df3 : MOV dword ptr [EBX + 0x4],EDI
00442df6 : JMP 0x00442f36
00442e3f : SUB ESI,dword ptr [EBP + 0xc]
00442e42 : SAR ESI,0x6
00442e45 : CMP ESI,0x1
00442e48 : JNC 0x00442ed6
00442e4e : LEA EDX,[EBP + -0x58]
00442e51 : PUSH EDX
00442e52 : CALL 0x00442f60
00442e57 : MOV dword ptr [EBP + -0x4],0x2
00442e5e : MOV EAX,dword ptr [EBP + 0xc]
00442e61 : LEA EDX,[EAX + 0x40]
00442e64 : MOV ECX,dword ptr [EBX + 0x8]
00442e67 : PUSH ECX
00442e68 : PUSH EAX
00442e69 : CALL 0x00443000
00442e6e : MOV byte ptr [EBP + -0x4],0x3
00442e72 : MOV EDI,dword ptr [EBX + 0x8]
00442e75 : LEA EDX,[EBP + -0x58]
00442e78 : PUSH EDX
00442e79 : MOV EAX,EDI
00442e7b : SUB EAX,dword ptr [EBP + 0xc]
00442e7e : SAR EAX,0x6
00442e81 : MOV ESI,0x1
00442e86 : SUB ESI,EAX
00442e88 : CALL 0x00442c20
00442e8d : MOV dword ptr [EBP + -0x4],0x2
00442e94 : ADD dword ptr [EBX + 0x8],0x40
00442e98 : MOV EBX,dword ptr [EBX + 0x8]
00442e9b : LEA EAX,[EBX + -0x40]
00442e9e : PUSH EAX
00442e9f : LEA EDI,[EBP + -0x58]
00442ea2 : MOV EAX,dword ptr [EBP + 0xc]
00442ea5 : CALL 0x00443180
00442eaa : ADD ESP,0x4
00442ead : MOV dword ptr [EBP + -0x4],0xffffffff
00442eb4 : MOV ECX,EDI
00442eb6 : PUSH ECX
00442eb7 : JMP 0x00442f31
00442ed6 : LEA EAX,[EBP + -0x58]
00442ed9 : PUSH EAX
00442eda : CALL 0x00442f60
00442edf : MOV dword ptr [EBP + -0x4],0x5
00442ee6 : MOV ESI,dword ptr [EBX + 0x8]
00442ee9 : LEA EDI,[ESI + -0x40]
00442eec : PUSH ESI
00442eed : PUSH EDI
00442eee : MOV EDX,ESI
00442ef0 : CALL 0x00443000
00442ef5 : MOV dword ptr [EBX + 0x8],EAX
00442ef8 : MOV byte ptr [EBP + -0x5c],0x0
00442efc : MOV ECX,dword ptr [EBP + -0x5c]
00442eff : PUSH ECX
00442f00 : MOV EDX,dword ptr [EBP + -0x5c]
00442f03 : PUSH EDX
00442f04 : MOV EAX,dword ptr [EBP + -0x5c]
00442f07 : PUSH EAX
00442f08 : MOV ECX,dword ptr [EBP + 0xc]
00442f0b : PUSH ECX
00442f0c : MOV EAX,ESI
00442f0e : MOV ECX,EDI
00442f10 : CALL 0x004431e0
00442f15 : MOV EAX,dword ptr [EBP + 0xc]
00442f18 : LEA EDX,[EAX + 0x40]
00442f1b : PUSH EDX
00442f1c : LEA EDI,[EBP + -0x58]
00442f1f : CALL 0x00443180
00442f24 : ADD ESP,0x14
00442f27 : MOV dword ptr [EBP + -0x4],0xffffffff
00442f2e : MOV EAX,EDI
00442f30 : PUSH EAX
00442f31 : CALL 0x004427d0
00442f36 : MOV ECX,dword ptr [EBP + -0xc]
00442f39 : MOV dword ptr FS:[0x0],ECX
00442f40 : POP ECX
00442f41 : POP EDI
00442f42 : POP ESI
00442f43 : POP EBX
00442f44 : MOV ECX,dword ptr [EBP + -0x14]
00442f47 : XOR ECX,EBP
00442f49 : CALL 0x00633e6b
00442f4e : MOV ESP,EBP
00442f50 : POP EBP
00442f51 : RET 0x8

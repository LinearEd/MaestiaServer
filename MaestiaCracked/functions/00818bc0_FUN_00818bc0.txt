PROGRAM  : Maestia.exe
FUNCTION : FUN_00818bc0
ENTRY    : 00818bc0
BODY     : [[00818bc0, 00818c49] [00818c50, 00818d1e] [00818d20, 00819027]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */
/* WARNING: Removing unreachable block (ram,0x00818f5b) */
/* WARNING: Removing unreachable block (ram,0x00818fb6) */

void FUN_00818bc0(void)

{
  short sVar1;
  bool bVar2;
  char cVar3;
  int iVar4;
  short *psVar5;
  LPCWSTR **lpWideCharStr;
  int *in_ECX;
  int iVar6;
  int local_2270;
  int local_225c;
  int local_2258;
  undefined1 local_2234 [4];
  LPCWSTR *local_2230 [4];
  int local_2220;
  uint local_221c;
  short local_2218 [4096];
  CHAR local_218 [512];
  uint local_18;
  undefined4 uStack_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_00b489b5;
  local_10 = ExceptionList;
  uStack_14 = 0x818bdb;
  local_18 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_221c = 7;
  local_2220 = 0;
  local_2230[0] = (LPCWSTR *)((uint)local_2230[0] & 0xffff0000);
  local_8 = 1;
  do {
    iVar6 = 0;
    bVar2 = false;
LAB_00818c50:
    if (((uint)in_ECX[8] <= (uint)in_ECX[9]) ||
       (cVar3 = (**(code **)(*in_ECX + 0x1c))(), cVar3 == '\0')) {
      local_8 = 0xffffffff;
      if (7 < local_221c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
LAB_00818ffe:
      local_8 = 0xffffffff;
      local_2230[0] = (LPCWSTR *)((uint)local_2230[0] & 0xffff0000);
      local_2220 = 0;
      local_221c = 7;
      ExceptionList = local_10;
      __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
      return;
    }
    if (local_2270 == 0x5001) {
      FUN_0070d320();
      psVar5 = local_2218;
      do {
        sVar1 = *psVar5;
        psVar5 = psVar5 + 1;
      } while (sVar1 != 0);
      FUN_00406360();
      bVar2 = true;
      goto LAB_00818c50;
    }
    if (local_2270 != 0x5002) {
      if (local_2270 == 0x5003) {
        if (bVar2) {
          FUN_008018d0();
        }
        local_8 = 0xffffffff;
        if (7 < local_221c) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        goto LAB_00818ffe;
      }
      (**(code **)(*in_ECX + 0x24))();
      goto LAB_00818c50;
    }
    iVar4 = FUN_006f0760();
    local_8._0_1_ = 2;
    if (iVar4 == 0) {
      local_225c = 0;
    }
    else {
      local_225c = FUN_004540e0();
    }
    local_8 = CONCAT31(local_8._1_3_,1);
    (**(code **)(*in_ECX + 0xc))();
    iVar4 = 1;
    *(undefined4 *)(local_225c + 0xc) = 0;
    local_2258 = 1;
    while( true ) {
      do {
        FUN_0070d080();
        psVar5 = local_2218;
        do {
          sVar1 = *psVar5;
          psVar5 = psVar5 + 1;
        } while (sVar1 != 0);
        FUN_00406360();
        if (*(int *)(DAT_017248cc + 0x90) == iVar4) {
          FUN_004535b0();
          iVar4 = local_2258;
        }
        iVar6 = iVar6 + 1;
      } while (iVar6 < 6);
      iVar4 = iVar4 + 1;
      if (0xb < iVar4) break;
      iVar6 = 0;
      local_2258 = iVar4;
    }
    if (!bVar2) {
      FUN_008018d0();
    }
    FUN_0070cac0();
    FUN_00405eb0(local_2234,0,0xffffffff);
    local_8._1_3_ = (undefined3)((uint)local_8 >> 8);
    local_8._0_1_ = 1;
    FUN_00438060();
    local_8._0_1_ = 4;
    FUN_00452dc0();
    local_8._0_1_ = 5;
    FUN_0042f990();
    local_8._0_1_ = 4;
    FUN_0044cb00();
    local_8 = CONCAT31(local_8._1_3_,1);
    FUN_0044cb00();
    _setlocale(0,"Korean_Korea.949");
    lpWideCharStr = (LPCWSTR **)local_2230[0];
    if (local_221c < 8) {
      lpWideCharStr = local_2230;
    }
    WideCharToMultiByte(0,0x400,(LPCWSTR)lpWideCharStr,local_2220,local_218,0x200,(LPCSTR)0x0,
                        (LPBOOL)0x0);
    _setlocale(0,"");
    FUN_00406360();
    FUN_00406360();
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
00818bc0 : PUSH EBP
00818bc1 : MOV EBP,ESP
00818bc3 : PUSH -0x1
00818bc5 : PUSH 0xb489b5
00818bca : MOV EAX,FS:[0x0]
00818bd0 : PUSH EAX
00818bd1 : MOV EAX,0x22a8
00818bd6 : CALL 0x0063b780
00818bdb : MOV EAX,[0x00d66fa0]
00818be0 : XOR EAX,EBP
00818be2 : MOV dword ptr [EBP + -0x14],EAX
00818be5 : PUSH EBX
00818be6 : PUSH ESI
00818be7 : PUSH EDI
00818be8 : PUSH EAX
00818be9 : LEA EAX,[EBP + -0xc]
00818bec : MOV FS:[0x0],EAX
00818bf2 : MOV EAX,dword ptr [EBP + 0x8]
00818bf5 : MOV EDI,ECX
00818bf7 : MOV dword ptr [EBP + 0xffffdd9c],EAX
00818bfd : MOV EAX,0x7
00818c02 : XOR EBX,EBX
00818c04 : XOR ECX,ECX
00818c06 : MOV dword ptr [EBP + 0xffffdda4],EDI
00818c0c : MOV dword ptr [EBP + 0xffffdde8],EAX
00818c12 : MOV dword ptr [EBP + 0xffffdde4],EBX
00818c18 : MOV word ptr [EBP + 0xffffddd4],CX
00818c1f : MOV dword ptr [EBP + -0x4],EBX
00818c22 : XOR EDX,EDX
00818c24 : MOV dword ptr [EBP + 0xffffddcc],EAX
00818c2a : MOV dword ptr [EBP + 0xffffddc8],EBX
00818c30 : MOV word ptr [EBP + 0xffffddb8],DX
00818c37 : MOV byte ptr [EBP + -0x4],0x1
00818c3b : MOV dword ptr [EBP + 0xffffdda0],EBX
00818c41 : MOV byte ptr [EBP + 0xffffddb3],0x0
00818c48 : JMP 0x00818c50
00818c50 : MOV EAX,dword ptr [EDI + 0x24]
00818c53 : CMP EAX,dword ptr [EDI + 0x20]
00818c56 : JNC 0x00818fa5
00818c5c : MOV EDX,dword ptr [EDI]
00818c5e : MOV EDX,dword ptr [EDX + 0x1c]
00818c61 : LEA EAX,[EBP + 0xffffdd94]
00818c67 : PUSH EAX
00818c68 : MOV ECX,EDI
00818c6a : CALL EDX
00818c6c : TEST AL,AL
00818c6e : JZ 0x00818fa5
00818c74 : MOV EAX,dword ptr [EBP + 0xffffdd94]
00818c7a : SUB EAX,0x5001
00818c7f : JZ 0x00818ee2
00818c85 : SUB EAX,0x1
00818c88 : JZ 0x00818ca5
00818c8a : SUB EAX,0x1
00818c8d : JZ 0x00818f2e
00818c93 : MOV ECX,dword ptr [EBP + 0xffffdd98]
00818c99 : MOV EAX,dword ptr [EDI]
00818c9b : MOV EDX,dword ptr [EAX + 0x24]
00818c9e : PUSH ECX
00818c9f : MOV ECX,EDI
00818ca1 : CALL EDX
00818ca3 : JMP 0x00818c50
00818ca5 : MOV EAX,[0x01725270]
00818caa : SHR EAX,0x3
00818cad : MOV ECX,0x0
00818cb2 : AND EAX,0x1
00818cb5 : SETZ CL
00818cb8 : PUSH ECX
00818cb9 : PUSH EBX
00818cba : PUSH 0xbf1a4a
00818cbf : PUSH 0x10
00818cc1 : CALL 0x006f0760
00818cc6 : ADD ESP,0x10
00818cc9 : MOV dword ptr [EBP + 0xffffddac],EAX
00818ccf : MOV byte ptr [EBP + -0x4],0x2
00818cd3 : CMP EAX,EBX
00818cd5 : JZ 0x00818ce5
00818cd7 : PUSH EAX
00818cd8 : CALL 0x004540e0
00818cdd : MOV dword ptr [EBP + 0xffffdda8],EAX
00818ce3 : JMP 0x00818ceb
00818ce5 : MOV dword ptr [EBP + 0xffffdda8],EBX
00818ceb : MOV byte ptr [EBP + -0x4],0x1
00818cef : MOV EDX,dword ptr [EDI]
00818cf1 : MOV EDX,dword ptr [EDX + 0xc]
00818cf4 : PUSH 0x1
00818cf6 : PUSH 0x4
00818cf8 : LEA EAX,[EBP + 0xffffdda0]
00818cfe : PUSH EAX
00818cff : MOV ECX,EDI
00818d01 : CALL EDX
00818d03 : MOV EAX,dword ptr [EBP + 0xffffdda0]
00818d09 : MOV ECX,dword ptr [EBP + 0xffffdda8]
00818d0f : MOV ESI,0x1
00818d14 : MOV dword ptr [ECX + 0xc],EAX
00818d17 : MOV dword ptr [EBP + 0xffffddac],ESI
00818d1d : JMP 0x00818d22
00818d20 : XOR EBX,EBX
00818d22 : LEA EDX,[EBP + 0xffffddec]
00818d28 : PUSH EDX
00818d29 : CALL 0x0070d080
00818d2e : LEA EAX,[EBP + 0xffffddec]
00818d34 : LEA EDX,[EAX + 0x2]
00818d37 : MOV CX,word ptr [EAX]
00818d3a : ADD EAX,0x2
00818d3d : TEST CX,CX
00818d40 : JNZ 0x00818d37
00818d42 : SUB EAX,EDX
00818d44 : SAR EAX,0x1
00818d46 : PUSH EAX
00818d47 : LEA EAX,[EBP + 0xffffddec]
00818d4d : PUSH EAX
00818d4e : LEA ECX,[EBP + 0xffffddb4]
00818d54 : CALL 0x00406360
00818d59 : MOV ECX,dword ptr [0x017248cc]
00818d5f : CMP dword ptr [ECX + 0x90],ESI
00818d65 : JNZ 0x00818d86
00818d67 : MOV EDX,dword ptr [EBP + 0xffffdda8]
00818d6d : PUSH EBX
00818d6e : PUSH EDX
00818d6f : LEA ESI,[EBP + 0xffffddb4]
00818d75 : CALL 0x004535b0
00818d7a : MOV EDI,dword ptr [EBP + 0xffffdda4]
00818d80 : MOV ESI,dword ptr [EBP + 0xffffddac]
00818d86 : INC EBX
00818d87 : CMP EBX,0x6
00818d8a : JL 0x00818d22
00818d8c : INC ESI
00818d8d : CMP ESI,0xc
00818d90 : MOV dword ptr [EBP + 0xffffddac],ESI
00818d96 : JL 0x00818d20
00818d98 : CMP byte ptr [EBP + 0xffffddb3],0x0
00818d9f : JNZ 0x00818db4
00818da1 : MOV ESI,dword ptr [0x00da98e8]
00818da7 : PUSH 0xc2e780
00818dac : CALL 0x008018d0
00818db1 : ADD ESP,0x4
00818db4 : LEA ECX,[EBP + 0xffffddd0]
00818dba : CALL 0x0070cac0
00818dbf : MOV EAX,dword ptr [EBP + 0xffffdda8]
00818dc5 : PUSH EAX
00818dc6 : SUB ESP,0x1c
00818dc9 : MOV ECX,ESP
00818dcb : MOV dword ptr [EBP + 0xffffddac],ESP
00818dd1 : XOR EDX,EDX
00818dd3 : PUSH -0x1
00818dd5 : PUSH EDX
00818dd6 : LEA EAX,[EBP + 0xffffddd0]
00818ddc : MOV dword ptr [ECX + 0x18],0x7
00818de3 : MOV dword ptr [ECX + 0x14],0x0
00818dea : PUSH EAX
00818deb : MOV word ptr [ECX + 0x4],DX
00818def : CALL 0x00405eb0
00818df4 : MOV byte ptr [EBP + -0x4],0x3
00818df8 : MOV byte ptr [EBP + -0x4],0x1
00818dfc : LEA ESI,[EBP + 0xffffdd4c]
00818e02 : CALL 0x00438060
00818e07 : ADD ESP,0x20
00818e0a : MOV byte ptr [EBP + -0x4],0x4
00818e0e : LEA ECX,[EBP + 0xffffdd6c]
00818e14 : PUSH ECX
00818e15 : MOV EDI,EAX
00818e17 : CALL 0x00452dc0
00818e1c : MOV byte ptr [EBP + -0x4],0x5
00818e20 : MOV ECX,dword ptr [EBP + 0xffffdd9c]
00818e26 : LEA EDX,[EBP + 0xffffdd6c]
00818e2c : PUSH EDX
00818e2d : LEA EAX,[EBP + 0xffffdd8c]
00818e33 : PUSH EAX
00818e34 : ADD ECX,0x30
00818e37 : PUSH ECX
00818e38 : CALL 0x0042f990
00818e3d : MOV byte ptr [EBP + -0x4],0x4
00818e41 : LEA EDX,[EBP + 0xffffdd6c]
00818e47 : PUSH EDX
00818e48 : CALL 0x0044cb00
00818e4d : MOV byte ptr [EBP + -0x4],0x1
00818e51 : MOV EAX,ESI
00818e53 : PUSH EAX
00818e54 : CALL 0x0044cb00
00818e59 : PUSH 0xc2e79c
00818e5e : PUSH 0x0
00818e60 : CALL 0x0063a9d0
00818e65 : MOV EAX,dword ptr [EBP + 0xffffddd4]
00818e6b : ADD ESP,0x8
00818e6e : CMP dword ptr [EBP + 0xffffdde8],0x8
00818e75 : JNC 0x00818e7d
00818e77 : LEA EAX,[EBP + 0xffffddd4]
00818e7d : MOV EDX,dword ptr [EBP + 0xffffdde4]
00818e83 : PUSH 0x0
00818e85 : PUSH 0x0
00818e87 : PUSH 0x200
00818e8c : LEA ECX,[EBP + 0xfffffdec]
00818e92 : PUSH ECX
00818e93 : PUSH EDX
00818e94 : PUSH EAX
00818e95 : PUSH 0x400
00818e9a : PUSH 0x0
00818e9c : CALL dword ptr [0x00b85130]
00818ea2 : PUSH 0xbf1d8e
00818ea7 : PUSH 0x0
00818ea9 : CALL 0x0063a9d0
00818eae : ADD ESP,0x8
00818eb1 : PUSH 0x0
00818eb3 : PUSH 0xc2e7b0
00818eb8 : LEA ECX,[EBP + 0xffffddd0]
00818ebe : CALL 0x00406360
00818ec3 : PUSH 0x0
00818ec5 : PUSH 0xc2e7b4
00818eca : LEA ECX,[EBP + 0xffffddb4]
00818ed0 : CALL 0x00406360
00818ed5 : MOV EDI,dword ptr [EBP + 0xffffdda4]
00818edb : XOR EBX,EBX
00818edd : JMP 0x00818c41
00818ee2 : LEA EAX,[EBP + 0xffffddec]
00818ee8 : PUSH EAX
00818ee9 : MOV ECX,EDI
00818eeb : CALL 0x0070d320
00818ef0 : LEA EAX,[EBP + 0xffffddec]
00818ef6 : LEA EDX,[EAX + 0x2]
00818ef9 : LEA ESP,[ESP]
00818f00 : MOV CX,word ptr [EAX]
00818f03 : ADD EAX,0x2
00818f06 : CMP CX,BX
00818f09 : JNZ 0x00818f00
00818f0b : SUB EAX,EDX
00818f0d : SAR EAX,0x1
00818f0f : PUSH EAX
00818f10 : LEA ECX,[EBP + 0xffffddec]
00818f16 : PUSH ECX
00818f17 : LEA ECX,[EBP + 0xffffddd0]
00818f1d : CALL 0x00406360
00818f22 : MOV byte ptr [EBP + 0xffffddb3],0x1
00818f29 : JMP 0x00818c50
00818f2e : CMP byte ptr [EBP + 0xffffddb3],0x0
00818f35 : JZ 0x00818f4a
00818f37 : MOV ESI,dword ptr [0x00da98e8]
00818f3d : PUSH 0xc2e7b8
00818f42 : CALL 0x008018d0
00818f47 : ADD ESP,0x4
00818f4a : MOV byte ptr [EBP + -0x4],0x0
00818f4e : MOV ESI,0x8
00818f53 : CMP dword ptr [EBP + 0xffffddcc],ESI
00818f59 : JC 0x00818f66
00818f5b : MOV ECX,dword ptr [EBP + 0xffffddb8]
00818f61 : CALL 0x006f04e0
00818f66 : MOV EDI,0x7
00818f6b : XOR EDX,EDX
00818f6d : MOV dword ptr [EBP + 0xffffddcc],EDI
00818f73 : MOV dword ptr [EBP + 0xffffddc8],EBX
00818f79 : MOV word ptr [EBP + 0xffffddb8],DX
00818f80 : MOV dword ptr [EBP + -0x4],0xffffffff
00818f87 : CMP dword ptr [EBP + 0xffffdde8],ESI
00818f8d : JC 0x00818f9a
00818f8f : MOV ECX,dword ptr [EBP + 0xffffddd4]
00818f95 : CALL 0x006f04e0
00818f9a : XOR EAX,EAX
00818f9c : MOV word ptr [EBP + 0xffffddd4],AX
00818fa3 : JMP 0x00818ffe
00818fa5 : MOV byte ptr [EBP + -0x4],0x0
00818fa9 : MOV ESI,0x8
00818fae : CMP dword ptr [EBP + 0xffffddcc],ESI
00818fb4 : JC 0x00818fc1
00818fb6 : MOV ECX,dword ptr [EBP + 0xffffddb8]
00818fbc : CALL 0x006f04e0
00818fc1 : MOV EDI,0x7
00818fc6 : XOR ECX,ECX
00818fc8 : MOV dword ptr [EBP + 0xffffddcc],EDI
00818fce : MOV dword ptr [EBP + 0xffffddc8],EBX
00818fd4 : MOV word ptr [EBP + 0xffffddb8],CX
00818fdb : MOV dword ptr [EBP + -0x4],0xffffffff
00818fe2 : CMP dword ptr [EBP + 0xffffdde8],ESI
00818fe8 : JC 0x00818ff5
00818fea : MOV ECX,dword ptr [EBP + 0xffffddd4]
00818ff0 : CALL 0x006f04e0
00818ff5 : XOR EDX,EDX
00818ff7 : MOV word ptr [EBP + 0xffffddd4],DX
00818ffe : MOV dword ptr [EBP + 0xffffdde4],EBX
00819004 : MOV dword ptr [EBP + 0xffffdde8],EDI
0081900a : MOV ECX,dword ptr [EBP + -0xc]
0081900d : MOV dword ptr FS:[0x0],ECX
00819014 : POP ECX
00819015 : POP EDI
00819016 : POP ESI
00819017 : POP EBX
00819018 : MOV ECX,dword ptr [EBP + -0x14]
0081901b : XOR ECX,EBP
0081901d : CALL 0x00633e6b
00819022 : MOV ESP,EBP
00819024 : POP EBP
00819025 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_006e3810
ENTRY    : 006e3810
BODY     : [[006e3810, 006e3859] [006e3860, 006e38d5] [006e38e0, 006e397e] [006e3980, 006e3a1b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006e3810(int param_1,undefined4 *param_2)

{
  undefined2 uVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  uint uVar7;
  undefined2 *puVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  int iVar12;
  uint uVar13;
  undefined2 *puVar14;
  int iVar15;
  uint uStack_2c;
  undefined4 *local_1c;
  undefined4 *local_18;
  int local_c;
  
  iVar15 = *(int *)(param_1 + 0x44);
  iVar2 = *(int *)(param_1 + 0x148);
  uVar11 = *(int *)(param_1 + 0xe0) - 1;
  local_c = 0;
  if (0 < *(int *)(param_1 + 0x3c)) {
    local_1c = (undefined4 *)(iVar2 + 0x40);
    local_18 = param_2;
    do {
      iVar6 = (**(code **)(*(int *)(param_1 + 4) + 0x20))
                        (param_1,*local_1c,*(int *)(iVar2 + 8) * *(int *)(iVar15 + 0xc),
                         *(int *)(iVar15 + 0xc),1);
      if (*(uint *)(iVar2 + 8) < uVar11) {
        uStack_2c = *(uint *)(iVar15 + 0xc);
      }
      else {
        uStack_2c = *(uint *)(iVar15 + 0x20) % *(uint *)(iVar15 + 0xc);
        if (uStack_2c == 0) {
          uStack_2c = *(uint *)(iVar15 + 0xc);
        }
      }
      uVar3 = *(uint *)(iVar15 + 0x1c);
      uVar4 = *(uint *)(iVar15 + 8);
      uVar10 = uVar3 % uVar4;
      if (0 < (int)uVar10) {
        uVar10 = uVar4 - uVar10;
      }
      iVar12 = 0;
      if (0 < (int)uStack_2c) {
        do {
          iVar5 = *(int *)(iVar6 + iVar12 * 4);
          (**(code **)(*(int *)(param_1 + 0x158) + 4))
                    (param_1,iVar15,*local_18,iVar5,iVar12 * 8,0,uVar3);
          if (0 < (int)uVar10) {
            puVar14 = (undefined2 *)(iVar5 + uVar3 * 0x80);
            FUN_006d9620(puVar14,uVar10 << 7);
            uVar1 = puVar14[-0x40];
            uVar7 = uVar10;
            if (0 < (int)uVar10) {
              do {
                *puVar14 = uVar1;
                puVar14 = puVar14 + 0x40;
                uVar7 = uVar7 - 1;
              } while (uVar7 != 0);
            }
          }
          iVar12 = iVar12 + 1;
        } while (iVar12 < (int)uStack_2c);
      }
      if (*(uint *)(iVar2 + 8) == uVar11) {
        uVar7 = (uVar3 + uVar10) / uVar4;
        if ((int)uStack_2c < *(int *)(iVar15 + 0xc)) {
          uVar13 = uStack_2c;
          do {
            puVar14 = *(undefined2 **)(iVar6 + uVar13 * 4);
            iVar12 = *(int *)(iVar6 + -4 + uVar13 * 4);
            FUN_006d9620(puVar14,(uVar3 + uVar10) * 0x80);
            if (uVar7 != 0) {
              uStack_2c = uVar7;
              do {
                uVar1 = *(undefined2 *)(uVar4 * 0x80 + -0x80 + iVar12);
                puVar8 = puVar14;
                uVar9 = uVar4;
                if (0 < (int)uVar4) {
                  do {
                    *puVar8 = uVar1;
                    uVar9 = uVar9 - 1;
                    puVar8 = puVar8 + 0x40;
                  } while (uVar9 != 0);
                }
                puVar14 = puVar14 + uVar4 * 0x40;
                iVar12 = iVar12 + uVar4 * 0x80;
                uStack_2c = uStack_2c - 1;
              } while (uStack_2c != 0);
            }
            uVar13 = uVar13 + 1;
          } while ((int)uVar13 < *(int *)(iVar15 + 0xc));
        }
      }
      local_1c = local_1c + 1;
      local_18 = local_18 + 1;
      local_c = local_c + 1;
      iVar15 = iVar15 + 0x54;
    } while (local_c < *(int *)(param_1 + 0x3c));
  }
  FUN_006e3660();
  return;
}



============================================================
DISASSEMBLY
============================================================
006e3810 : SUB ESP,0x2c
006e3813 : MOV EAX,dword ptr [ESP + 0x30]
006e3817 : PUSH EBX
006e3818 : MOV EBX,dword ptr [EAX + 0xe0]
006e381e : PUSH ESI
006e381f : MOV ESI,dword ptr [EAX + 0x44]
006e3822 : PUSH EDI
006e3823 : MOV EDI,dword ptr [EAX + 0x148]
006e3829 : DEC EBX
006e382a : CMP dword ptr [EAX + 0x3c],0x0
006e382e : MOV dword ptr [ESP + 0x28],EDI
006e3832 : MOV dword ptr [ESP + 0x24],EBX
006e3836 : MOV dword ptr [ESP + 0x2c],0x0
006e383e : MOV dword ptr [ESP + 0x10],ESI
006e3842 : JLE 0x006e3a0d
006e3848 : MOV ECX,dword ptr [ESP + 0x40]
006e384c : LEA EDX,[EDI + 0x40]
006e384f : PUSH EBP
006e3850 : MOV dword ptr [ESP + 0x24],ECX
006e3854 : MOV dword ptr [ESP + 0x20],EDX
006e3858 : JMP 0x006e3868
006e3860 : MOV EDI,dword ptr [ESP + 0x2c]
006e3864 : MOV EBX,dword ptr [ESP + 0x28]
006e3868 : MOV ECX,dword ptr [ESI + 0xc]
006e386b : MOV EBP,dword ptr [EDI + 0x8]
006e386e : MOV EDX,dword ptr [EAX + 0x4]
006e3871 : IMUL EBP,ECX
006e3874 : MOV EDX,dword ptr [EDX + 0x20]
006e3877 : PUSH 0x1
006e3879 : PUSH ECX
006e387a : MOV ECX,dword ptr [ESP + 0x28]
006e387e : MOV ECX,dword ptr [ECX]
006e3880 : PUSH EBP
006e3881 : PUSH ECX
006e3882 : PUSH EAX
006e3883 : CALL EDX
006e3885 : ADD ESP,0x14
006e3888 : MOV ECX,EAX
006e388a : MOV dword ptr [ESP + 0x18],ECX
006e388e : CMP dword ptr [EDI + 0x8],EBX
006e3891 : JNC 0x006e389c
006e3893 : MOV EAX,dword ptr [ESI + 0xc]
006e3896 : MOV dword ptr [ESP + 0x10],EAX
006e389a : JMP 0x006e38b2
006e389c : MOV EDI,dword ptr [ESI + 0xc]
006e389f : MOV EAX,dword ptr [ESI + 0x20]
006e38a2 : XOR EDX,EDX
006e38a4 : DIV EDI
006e38a6 : MOV dword ptr [ESP + 0x10],EDX
006e38aa : TEST EDX,EDX
006e38ac : JNZ 0x006e38b2
006e38ae : MOV dword ptr [ESP + 0x10],EDI
006e38b2 : MOV EBX,dword ptr [ESI + 0x1c]
006e38b5 : MOV EBP,dword ptr [ESI + 0x8]
006e38b8 : XOR EDX,EDX
006e38ba : MOV EAX,EBX
006e38bc : DIV EBP
006e38be : MOV dword ptr [ESP + 0x1c],EBP
006e38c2 : MOV EDI,EDX
006e38c4 : TEST EDI,EDI
006e38c6 : JLE 0x006e38cc
006e38c8 : SUB EBP,EDI
006e38ca : MOV EDI,EBP
006e38cc : XOR EBP,EBP
006e38ce : CMP dword ptr [ESP + 0x10],EBP
006e38d2 : JLE 0x006e394c
006e38d4 : JMP 0x006e38e0
006e38e0 : MOV ESI,dword ptr [ECX + EBP*0x4]
006e38e3 : MOV EAX,dword ptr [ESP + 0x40]
006e38e7 : MOV ECX,dword ptr [EAX + 0x158]
006e38ed : PUSH EBX
006e38ee : PUSH 0x0
006e38f0 : LEA EDX,[EBP*0x8 + 0x0]
006e38f7 : PUSH EDX
006e38f8 : MOV EDX,dword ptr [ESP + 0x30]
006e38fc : MOV EDX,dword ptr [EDX]
006e38fe : PUSH ESI
006e38ff : PUSH EDX
006e3900 : MOV EDX,dword ptr [ESP + 0x28]
006e3904 : PUSH EDX
006e3905 : PUSH EAX
006e3906 : MOV EAX,dword ptr [ECX + 0x4]
006e3909 : CALL EAX
006e390b : ADD ESP,0x1c
006e390e : TEST EDI,EDI
006e3910 : JLE 0x006e393d
006e3912 : MOV ECX,EBX
006e3914 : MOV EDX,EDI
006e3916 : SHL ECX,0x7
006e3919 : SHL EDX,0x7
006e391c : ADD ESI,ECX
006e391e : PUSH EDX
006e391f : PUSH ESI
006e3920 : CALL 0x006d9620
006e3925 : MOVZX ECX,word ptr [ESI + -0x80]
006e3929 : ADD ESP,0x8
006e392c : TEST EDI,EDI
006e392e : JLE 0x006e393d
006e3930 : MOV EAX,EDI
006e3932 : MOV word ptr [ESI],CX
006e3935 : SUB ESI,-0x80
006e3938 : SUB EAX,0x1
006e393b : JNZ 0x006e3932
006e393d : MOV ECX,dword ptr [ESP + 0x18]
006e3941 : INC EBP
006e3942 : CMP EBP,dword ptr [ESP + 0x10]
006e3946 : JL 0x006e38e0
006e3948 : MOV ESI,dword ptr [ESP + 0x14]
006e394c : MOV EAX,dword ptr [ESP + 0x28]
006e3950 : MOV EDX,dword ptr [ESP + 0x2c]
006e3954 : CMP dword ptr [EDX + 0x8],EAX
006e3957 : JNZ 0x006e39e0
006e395d : ADD EBX,EDI
006e395f : XOR EDX,EDX
006e3961 : MOV EAX,EBX
006e3963 : DIV dword ptr [ESP + 0x1c]
006e3967 : MOV dword ptr [ESP + 0x38],EAX
006e396b : MOV EAX,dword ptr [ESP + 0x10]
006e396f : CMP EAX,dword ptr [ESI + 0xc]
006e3972 : MOV EBP,EAX
006e3974 : JGE 0x006e39e0
006e3976 : SHL EBX,0x7
006e3979 : MOV dword ptr [ESP + 0x34],EBX
006e397d : JMP 0x006e3984
006e3980 : MOV ECX,dword ptr [ESP + 0x18]
006e3984 : MOV EAX,dword ptr [ESP + 0x34]
006e3988 : MOV EDI,dword ptr [ECX + EBP*0x4]
006e398b : MOV EBX,dword ptr [ECX + EBP*0x4 + -0x4]
006e398f : PUSH EAX
006e3990 : PUSH EDI
006e3991 : CALL 0x006d9620
006e3996 : MOV EAX,dword ptr [ESP + 0x40]
006e399a : ADD ESP,0x8
006e399d : TEST EAX,EAX
006e399f : JBE 0x006e39da
006e39a1 : MOV EDX,dword ptr [ESP + 0x1c]
006e39a5 : SHL EDX,0x7
006e39a8 : MOV dword ptr [ESP + 0x10],EAX
006e39ac : LEA ESP,[ESP]
006e39b0 : MOV ECX,dword ptr [ESP + 0x1c]
006e39b4 : MOVZX ESI,word ptr [EDX + EBX*0x1 + -0x80]
006e39b9 : TEST ECX,ECX
006e39bb : JLE 0x006e39cb
006e39bd : MOV EAX,EDI
006e39bf : NOP
006e39c0 : MOV word ptr [EAX],SI
006e39c3 : SUB EAX,-0x80
006e39c6 : SUB ECX,0x1
006e39c9 : JNZ 0x006e39c0
006e39cb : ADD EDI,EDX
006e39cd : ADD EBX,EDX
006e39cf : SUB dword ptr [ESP + 0x10],0x1
006e39d4 : JNZ 0x006e39b0
006e39d6 : MOV ESI,dword ptr [ESP + 0x14]
006e39da : INC EBP
006e39db : CMP EBP,dword ptr [ESI + 0xc]
006e39de : JL 0x006e3980
006e39e0 : MOV EAX,dword ptr [ESP + 0x30]
006e39e4 : MOV ECX,0x4
006e39e9 : ADD dword ptr [ESP + 0x20],ECX
006e39ed : ADD dword ptr [ESP + 0x24],ECX
006e39f1 : MOV ECX,dword ptr [ESP + 0x40]
006e39f5 : INC EAX
006e39f6 : ADD ESI,0x54
006e39f9 : CMP EAX,dword ptr [ECX + 0x3c]
006e39fc : MOV dword ptr [ESP + 0x30],EAX
006e3a00 : MOV dword ptr [ESP + 0x14],ESI
006e3a04 : MOV EAX,ECX
006e3a06 : JL 0x006e3860
006e3a0c : POP EBP
006e3a0d : POP EDI
006e3a0e : POP ESI
006e3a0f : POP EBX
006e3a10 : ADD ESP,0x2c
006e3a13 : MOV dword ptr [ESP + 0x4],EAX
006e3a17 : JMP 0x006e3660

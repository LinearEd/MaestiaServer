PROGRAM  : Maestia.exe
FUNCTION : FUN_009b2070
ENTRY    : 009b2070
BODY     : [[009b2070, 009b2574]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009b2070(int *param_1,uint param_2)

{
  byte bVar1;
  byte bVar2;
  ushort uVar3;
  uint uVar4;
  int iVar5;
  undefined2 uVar6;
  uint uVar7;
  uint uVar8;
  int iVar9;
  undefined4 uVar10;
  int *piVar11;
  undefined4 ****ppppuVar12;
  int in_ECX;
  undefined1 local_178 [168];
  undefined1 local_d0 [28];
  undefined1 local_b4 [28];
  undefined1 local_98 [12];
  wchar_t *local_8c [4];
  wchar_t *local_7c;
  undefined4 local_78;
  int local_74;
  undefined4 ***local_70;
  uint local_6c;
  undefined4 ***local_64 [5];
  uint local_50;
  undefined4 ***local_48 [4];
  int local_38;
  uint local_34;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b5bad8;
  local_10 = ExceptionList;
  uVar7 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_78 = 0;
  local_18 = 7;
  local_1c = 0;
  local_2c = 0;
  local_74 = in_ECX;
  local_14 = uVar7;
  FUN_00406360(&DAT_00c8db8c,0);
  local_8 = 1;
  if (param_1 == (int *)0x0) {
    *(undefined4 *)(in_ECX + 0x18) = 7;
    *(undefined4 *)(in_ECX + 0x14) = 0;
    *(undefined2 *)(in_ECX + 4) = 0;
    FUN_00405eb0(local_30,0,0xffffffff);
    local_78 = 1;
    local_8 = local_8 & 0xffffff00;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    goto LAB_009b254f;
  }
  uVar4 = param_1[4];
  uVar8 = uVar4 >> 0x18;
  if (uVar8 == 6) {
    piVar11 = (int *)FUN_004049b0(uVar4,uVar7);
    if (piVar11 != (int *)0x0) {
      FUN_00824a20(DAT_0172491c,0);
      local_8._0_1_ = 6;
      local_8c[0] = L"#fff200";
      local_8c[1] = L"#4df99a";
      local_8c[2] = L"#28a1ff";
      local_8c[3] = L"#a53cff";
      local_7c = L"#ff8000";
      local_6c = 0;
      iVar9 = (**(code **)(*piVar11 + 0x3c))();
      if (iVar9 != 0) {
        FUN_0040e750(param_1,local_98);
        local_8 = CONCAT31(local_8._1_3_,7);
        local_70 = (undefined4 ***)(**(code **)(*param_1 + 0x20))();
        (**(code **)(*param_1 + 0x30))();
        uVar3 = *(ushort *)(piVar11 + 0x14);
        if (uVar3 < 3) {
          local_6c = FUN_009e7fa0(uVar3,local_70);
        }
        else {
          local_6c = (uint)uVar3;
        }
        local_8._0_1_ = 6;
        FUN_0040f3f0(local_98);
        if (4 < (int)local_6c) {
          local_6c = 4;
        }
      }
      if (param_2 == 0) {
        param_2 = (**(code **)(*param_1 + 0x40))();
        param_2 = param_2 & 0xffff;
      }
      if (1 < (int)param_2) {
        FUN_00406460(L"IDS_ITEM_COUNT");
        local_8._0_1_ = 8;
        iVar9 = FUN_0081d120(local_d0);
        local_8._0_1_ = 9;
        if (*(uint *)(iVar9 + 0x18) < 8) {
          iVar9 = iVar9 + 4;
        }
        else {
          iVar9 = *(int *)(iVar9 + 4);
        }
        FUN_00404750(iVar9,param_2);
        local_8._0_1_ = 0xb;
        FUN_00406560();
        local_8._0_1_ = 0xc;
        FUN_00406560();
        if (local_38 == 0) {
          ppppuVar12 = (undefined4 ****)local_64[0];
          if (local_50 < 8) {
            ppppuVar12 = local_64;
          }
          uVar10 = FUN_00404750(L"%s : %d",ppppuVar12,param_2);
          local_8._0_1_ = 0xd;
          FUN_00405eb0(uVar10,0,0xffffffff);
        }
        else {
          if (local_34 < 8) {
            local_48[0] = local_48;
          }
          ppppuVar12 = (undefined4 ****)local_64[0];
          if (local_50 < 8) {
            ppppuVar12 = local_64;
          }
          uVar10 = FUN_00404750(L"%s : %s",ppppuVar12,local_48[0]);
          local_8._0_1_ = 0xe;
          FUN_00405eb0(uVar10,0,0xffffffff);
        }
        local_8._0_1_ = 0xc;
        FUN_00406560();
        local_8._0_1_ = 6;
        FUN_00406560();
      }
      iVar9 = param_1[3];
      iVar5 = param_1[4];
      if (local_50 < 8) {
        local_70 = local_64;
      }
      else {
        local_70 = local_64[0];
      }
      uVar6 = (**(code **)(*param_1 + 0x40))();
      uVar10 = FUN_00404750(L"{type=1^name=%s^proto=%u^key=%u^color=%s^count=%d}",local_70,iVar5,
                            iVar9,local_8c[local_6c],uVar6);
      local_8._0_1_ = 0xf;
      FUN_00405eb0(uVar10,0,0xffffffff);
      local_8._0_1_ = 6;
      FUN_00406560();
      local_8 = CONCAT31(local_8._1_3_,1);
LAB_009b2507:
      FUN_00406560();
      in_ECX = local_74;
    }
  }
  else if (uVar8 == 7) {
    iVar9 = FUN_008413b0(uVar4,0xffffffff);
    if (iVar9 != 0) {
      bVar1 = *(byte *)(iVar9 + 8);
      bVar2 = *(byte *)(iVar9 + 9);
      FUN_00420660(iVar9,local_178);
      local_8._0_1_ = 2;
      FUN_00824120(DAT_0172491c);
      local_8._0_1_ = 4;
      FUN_00406560();
      if (local_34 < 8) {
        local_48[0] = local_48;
      }
      uVar10 = FUN_00404750(L"{type=5^name=%s^proto=%u^level=%d^color=#fff200}",local_48[0],
                            param_1[4],(ushort)bVar2 + (ushort)bVar1);
      local_8._0_1_ = 5;
      FUN_00405eb0(uVar10,0,0xffffffff);
      local_8._0_1_ = 4;
      FUN_00406560();
      local_8 = CONCAT31(local_8._1_3_,1);
      goto LAB_009b2507;
    }
  }
  else if (uVar8 == 0xf) {
    iVar9 = FUN_004049b0(uVar4,uVar7);
    if (iVar9 != 0) {
      FUN_00824a20(DAT_0172491c,0);
      local_8._0_1_ = 0x10;
      if (local_34 < 8) {
        local_48[0] = local_48;
      }
      uVar10 = FUN_00404750(L"{type=1^name=%s^proto=%u^key=%u^color=#ffc000}",local_48[0],param_1[4]
                            ,param_1[3]);
      local_8._0_1_ = 0x11;
      FUN_00405eb0(uVar10,0,0xffffffff);
      local_8._0_1_ = 0x10;
      FUN_00406560();
      local_8 = CONCAT31(local_8._1_3_,1);
      goto LAB_009b2507;
    }
  }
  else {
    FUN_00406460(L"Invalid Type");
    local_8._0_1_ = 0x12;
    if ((int *)*DAT_00da98e8 != (int *)0x0) {
      (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                (L"AvaGuiChatWindowMgr::MakeItemLinkString",0xbbf,local_b4);
    }
    local_8 = CONCAT31(local_8._1_3_,1);
    FUN_00406560();
  }
  *(undefined4 *)(in_ECX + 0x18) = 7;
  *(undefined4 *)(in_ECX + 0x14) = 0;
  *(undefined2 *)(in_ECX + 4) = 0;
  FUN_00405eb0(local_30,0,0xffffffff);
  local_78 = 1;
  local_8 = local_8 & 0xffffff00;
  if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
LAB_009b254f:
  local_2c = 0;
  local_78 = 1;
  local_18 = 7;
  local_1c = 0;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
009b2070 : PUSH EBP
009b2071 : MOV EBP,ESP
009b2073 : PUSH -0x1
009b2075 : PUSH 0xb5bad8
009b207a : MOV EAX,FS:[0x0]
009b2080 : PUSH EAX
009b2081 : SUB ESP,0x184
009b2087 : MOV EAX,[0x00d66fa0]
009b208c : XOR EAX,EBP
009b208e : MOV dword ptr [EBP + -0x10],EAX
009b2091 : PUSH EBX
009b2092 : PUSH ESI
009b2093 : PUSH EDI
009b2094 : PUSH EAX
009b2095 : LEA EAX,[EBP + -0xc]
009b2098 : MOV FS:[0x0],EAX
009b209e : MOV EBX,dword ptr [EBP + 0x8]
009b20a1 : XOR EDI,EDI
009b20a3 : MOV ESI,ECX
009b20a5 : MOV dword ptr [EBP + -0x74],EDI
009b20a8 : PUSH EDI
009b20a9 : XOR EAX,EAX
009b20ab : PUSH 0xc8db8c
009b20b0 : LEA ECX,[EBP + -0x2c]
009b20b3 : MOV dword ptr [EBP + -0x70],ESI
009b20b6 : MOV dword ptr [EBP + -0x14],0x7
009b20bd : MOV dword ptr [EBP + -0x18],EDI
009b20c0 : MOV word ptr [EBP + -0x28],AX
009b20c4 : CALL 0x00406360
009b20c9 : MOV dword ptr [EBP + -0x4],0x1
009b20d0 : CMP EBX,EDI
009b20d2 : JNZ 0x009b2117
009b20d4 : PUSH -0x1
009b20d6 : XOR ECX,ECX
009b20d8 : MOV EBX,0x7
009b20dd : MOV dword ptr [ESI + 0x18],EBX
009b20e0 : MOV dword ptr [ESI + 0x14],EDI
009b20e3 : PUSH EDI
009b20e4 : LEA EDX,[EBP + -0x2c]
009b20e7 : MOV word ptr [ESI + 0x4],CX
009b20eb : PUSH EDX
009b20ec : MOV ECX,ESI
009b20ee : CALL 0x00405eb0
009b20f3 : MOV dword ptr [EBP + -0x74],0x1
009b20fa : MOV byte ptr [EBP + -0x4],0x0
009b20fe : CMP dword ptr [EBP + -0x14],0x8
009b2102 : JC 0x009b210c
009b2104 : MOV ECX,dword ptr [EBP + -0x28]
009b2107 : CALL 0x006f04e0
009b210c : XOR EAX,EAX
009b210e : MOV word ptr [EBP + -0x28],AX
009b2112 : JMP 0x009b254f
009b2117 : MOV ECX,dword ptr [EBX + 0x10]
009b211a : MOV EAX,ECX
009b211c : SHR EAX,0x18
009b211f : MOVZX EAX,AL
009b2122 : SUB EAX,0x6
009b2125 : JZ 0x009b22a5
009b212b : SUB EAX,0x1
009b212e : JZ 0x009b21fc
009b2134 : SUB EAX,0x8
009b2137 : JZ 0x009b2185
009b2139 : PUSH 0xc8dc84
009b213e : LEA ECX,[EBP + 0xffffff50]
009b2144 : CALL 0x00406460
009b2149 : MOV byte ptr [EBP + -0x4],0x12
009b214d : MOV ECX,dword ptr [0x00da98e8]
009b2153 : MOV ECX,dword ptr [ECX]
009b2155 : CMP ECX,EDI
009b2157 : JZ 0x009b2171
009b2159 : MOV EDX,dword ptr [ECX]
009b215b : MOV EDX,dword ptr [EDX + 0x14]
009b215e : LEA EAX,[EBP + 0xffffff50]
009b2164 : PUSH EAX
009b2165 : PUSH 0xbbf
009b216a : PUSH 0xc8dd68
009b216f : CALL EDX
009b2171 : MOV byte ptr [EBP + -0x4],0x1
009b2175 : LEA ECX,[EBP + 0xffffff50]
009b217b : CALL 0x00406560
009b2180 : JMP 0x009b2511
009b2185 : PUSH ECX
009b2186 : CALL 0x004049b0
009b218b : ADD ESP,0x4
009b218e : CMP EAX,EDI
009b2190 : JZ 0x009b2511
009b2196 : LEA EDX,[EAX + 0x18]
009b2199 : MOV EAX,[0x0172491c]
009b219e : PUSH EDI
009b219f : PUSH EAX
009b21a0 : LEA ESI,[EBP + -0x48]
009b21a3 : CALL 0x00824a20
009b21a8 : MOV byte ptr [EBP + -0x4],0x10
009b21ac : CMP dword ptr [EBP + -0x30],0x8
009b21b0 : MOV EAX,dword ptr [EBX + 0xc]
009b21b3 : MOV EBX,dword ptr [EBX + 0x10]
009b21b6 : MOV ECX,dword ptr [EBP + -0x44]
009b21b9 : JNC 0x009b21be
009b21bb : LEA ECX,[EBP + -0x44]
009b21be : PUSH EAX
009b21bf : PUSH EBX
009b21c0 : PUSH ECX
009b21c1 : PUSH 0xc8dd08
009b21c6 : LEA ESI,[EBP + 0xfffffec4]
009b21cc : CALL 0x00404750
009b21d1 : ADD ESP,0x10
009b21d4 : MOV byte ptr [EBP + -0x4],0x11
009b21d8 : PUSH -0x1
009b21da : PUSH 0x0
009b21dc : PUSH EAX
009b21dd : LEA ECX,[EBP + -0x2c]
009b21e0 : CALL 0x00405eb0
009b21e5 : MOV byte ptr [EBP + -0x4],0x10
009b21e9 : MOV ECX,ESI
009b21eb : CALL 0x00406560
009b21f0 : MOV byte ptr [EBP + -0x4],0x1
009b21f4 : LEA ECX,[EBP + -0x48]
009b21f7 : JMP 0x009b2507
009b21fc : PUSH -0x1
009b21fe : PUSH ECX
009b21ff : MOV ECX,dword ptr [0x01724910]
009b2205 : CALL 0x008413b0
009b220a : CMP EAX,EDI
009b220c : JZ 0x009b2511
009b2212 : MOV CL,byte ptr [EAX + 0x8]
009b2215 : MOVZX DX,byte ptr [EAX + 0x9]
009b221a : MOVZX CX,CL
009b221e : ADD DX,CX
009b2221 : MOVZX ESI,DX
009b2224 : LEA EDX,[EBP + 0xfffffe8c]
009b222a : PUSH EDX
009b222b : PUSH EAX
009b222c : CALL 0x00420660
009b2231 : MOV byte ptr [EBP + -0x4],0x2
009b2235 : MOV ECX,dword ptr [0x0172491c]
009b223b : PUSH ECX
009b223c : MOV EDX,EAX
009b223e : LEA EDI,[EBP + -0x48]
009b2241 : CALL 0x00824120
009b2246 : MOV byte ptr [EBP + -0x4],0x4
009b224a : LEA ECX,[EBP + 0xfffffe8c]
009b2250 : CALL 0x00406560
009b2255 : CMP dword ptr [EBP + -0x30],0x8
009b2259 : MOV EBX,dword ptr [EBX + 0x10]
009b225c : MOV EAX,dword ptr [EBP + -0x44]
009b225f : JNC 0x009b2264
009b2261 : LEA EAX,[EBP + -0x44]
009b2264 : MOVZX EDX,SI
009b2267 : PUSH EDX
009b2268 : PUSH EBX
009b2269 : PUSH EAX
009b226a : PUSH 0xc8db90
009b226f : LEA ESI,[EBP + 0xffffff18]
009b2275 : CALL 0x00404750
009b227a : ADD ESP,0x10
009b227d : MOV byte ptr [EBP + -0x4],0x5
009b2281 : PUSH -0x1
009b2283 : PUSH 0x0
009b2285 : PUSH EAX
009b2286 : LEA ECX,[EBP + -0x2c]
009b2289 : CALL 0x00405eb0
009b228e : MOV byte ptr [EBP + -0x4],0x4
009b2292 : MOV ECX,ESI
009b2294 : CALL 0x00406560
009b2299 : MOV byte ptr [EBP + -0x4],0x1
009b229d : LEA ECX,[EBP + -0x48]
009b22a0 : JMP 0x009b2507
009b22a5 : PUSH ECX
009b22a6 : CALL 0x004049b0
009b22ab : MOV EDI,EAX
009b22ad : ADD ESP,0x4
009b22b0 : TEST EDI,EDI
009b22b2 : JZ 0x009b250f
009b22b8 : MOV EAX,[0x0172491c]
009b22bd : PUSH 0x0
009b22bf : LEA EDX,[EDI + 0x18]
009b22c2 : PUSH EAX
009b22c3 : LEA ESI,[EBP + -0x64]
009b22c6 : CALL 0x00824a20
009b22cb : MOV byte ptr [EBP + -0x4],0x6
009b22cf : MOV EDX,dword ptr [EDI]
009b22d1 : MOV EAX,dword ptr [EDX + 0x3c]
009b22d4 : MOV ECX,EDI
009b22d6 : MOV dword ptr [EBP + 0xffffff78],0xc8dbf4
009b22e0 : MOV dword ptr [EBP + 0xffffff7c],0xc8dc04
009b22ea : MOV dword ptr [EBP + -0x80],0xc8dc14
009b22f1 : MOV dword ptr [EBP + -0x7c],0xc8dc24
009b22f8 : MOV dword ptr [EBP + -0x78],0xc8dc34
009b22ff : MOV dword ptr [EBP + -0x68],0x0
009b2306 : CALL EAX
009b2308 : TEST EAX,EAX
009b230a : JZ 0x009b2376
009b230c : LEA ECX,[EBP + 0xffffff6c]
009b2312 : PUSH ECX
009b2313 : PUSH EBX
009b2314 : CALL 0x0040e750
009b2319 : MOV byte ptr [EBP + -0x4],0x7
009b231d : MOV EDX,dword ptr [EBX]
009b231f : MOV ESI,dword ptr [EAX + 0x8]
009b2322 : MOV EAX,dword ptr [EDX + 0x20]
009b2325 : MOV ECX,EBX
009b2327 : CALL EAX
009b2329 : MOV EDX,dword ptr [EBX]
009b232b : MOV dword ptr [EBP + -0x6c],EAX
009b232e : MOV EAX,dword ptr [EDX + 0x30]
009b2331 : MOV ECX,EBX
009b2333 : CALL EAX
009b2335 : MOVZX EAX,word ptr [EDI + 0x50]
009b2339 : CMP AX,0x2
009b233d : JA 0x009b2353
009b233f : MOV ECX,dword ptr [EBP + -0x6c]
009b2342 : PUSH ECX
009b2343 : PUSH EAX
009b2344 : MOV EAX,ESI
009b2346 : CALL 0x009e7fa0
009b234b : ADD ESP,0x8
009b234e : MOV dword ptr [EBP + -0x68],EAX
009b2351 : JMP 0x009b2359
009b2353 : MOVZX EDX,AX
009b2356 : MOV dword ptr [EBP + -0x68],EDX
009b2359 : MOV byte ptr [EBP + -0x4],0x6
009b235d : LEA EAX,[EBP + 0xffffff6c]
009b2363 : PUSH EAX
009b2364 : CALL 0x0040f3f0
009b2369 : CMP dword ptr [EBP + -0x68],0x5
009b236d : JL 0x009b2376
009b236f : MOV dword ptr [EBP + -0x68],0x4
009b2376 : MOV ESI,dword ptr [EBP + 0xc]
009b2379 : TEST ESI,ESI
009b237b : JNZ 0x009b238e
009b237d : MOV EDX,dword ptr [EBX]
009b237f : MOV EAX,dword ptr [EDX + 0x40]
009b2382 : MOV ECX,EBX
009b2384 : CALL EAX
009b2386 : MOVZX ECX,AX
009b2389 : MOV dword ptr [EBP + 0xc],ECX
009b238c : MOV ESI,ECX
009b238e : CMP ESI,0x1
009b2391 : JLE 0x009b2499
009b2397 : PUSH 0xc8dc44
009b239c : LEA ECX,[EBP + 0xffffff34]
009b23a2 : CALL 0x00406460
009b23a7 : MOV byte ptr [EBP + -0x4],0x8
009b23ab : MOV ECX,dword ptr [0x0172491c]
009b23b1 : LEA EDX,[EBP + 0xffffff34]
009b23b7 : PUSH EDX
009b23b8 : LEA EDI,[EBP + 0xfffffefc]
009b23be : CALL 0x0081d120
009b23c3 : MOV byte ptr [EBP + -0x4],0x9
009b23c7 : MOV EDI,0x8
009b23cc : CMP dword ptr [EAX + 0x18],EDI
009b23cf : JC 0x009b23d6
009b23d1 : MOV EAX,dword ptr [EAX + 0x4]
009b23d4 : JMP 0x009b23d9
009b23d6 : ADD EAX,0x4
009b23d9 : PUSH ESI
009b23da : PUSH EAX
009b23db : LEA ESI,[EBP + -0x48]
009b23de : CALL 0x00404750
009b23e3 : ADD ESP,0x8
009b23e6 : MOV byte ptr [EBP + -0x4],0xb
009b23ea : LEA ECX,[EBP + 0xfffffefc]
009b23f0 : CALL 0x00406560
009b23f5 : MOV byte ptr [EBP + -0x4],0xc
009b23f9 : LEA ECX,[EBP + 0xffffff34]
009b23ff : CALL 0x00406560
009b2404 : CMP dword ptr [EBP + -0x34],0x0
009b2408 : JNZ 0x009b2446
009b240a : MOV EAX,dword ptr [EBP + -0x60]
009b240d : CMP dword ptr [EBP + -0x4c],EDI
009b2410 : JNC 0x009b2415
009b2412 : LEA EAX,[EBP + -0x60]
009b2415 : MOV ECX,dword ptr [EBP + 0xc]
009b2418 : PUSH ECX
009b2419 : PUSH EAX
009b241a : PUSH 0xc8dc64
009b241f : LEA ESI,[EBP + 0xfffffee0]
009b2425 : CALL 0x00404750
009b242a : ADD ESP,0xc
009b242d : MOV byte ptr [EBP + -0x4],0xd
009b2431 : PUSH -0x1
009b2433 : PUSH 0x0
009b2435 : PUSH EAX
009b2436 : LEA ECX,[EBP + -0x64]
009b2439 : CALL 0x00405eb0
009b243e : MOV byte ptr [EBP + -0x4],0xc
009b2442 : MOV ECX,ESI
009b2444 : JMP 0x009b2488
009b2446 : MOV ECX,dword ptr [EBP + -0x44]
009b2449 : CMP dword ptr [EBP + -0x30],EDI
009b244c : JNC 0x009b2451
009b244e : LEA ECX,[EBP + -0x44]
009b2451 : MOV EAX,dword ptr [EBP + -0x60]
009b2454 : CMP dword ptr [EBP + -0x4c],EDI
009b2457 : JNC 0x009b245c
009b2459 : LEA EAX,[EBP + -0x60]
009b245c : PUSH ECX
009b245d : PUSH EAX
009b245e : PUSH 0xc8dc74
009b2463 : LEA ESI,[EBP + 0xfffffea8]
009b2469 : CALL 0x00404750
009b246e : ADD ESP,0xc
009b2471 : MOV byte ptr [EBP + -0x4],0xe
009b2475 : PUSH -0x1
009b2477 : PUSH 0x0
009b2479 : PUSH EAX
009b247a : LEA ECX,[EBP + -0x64]
009b247d : CALL 0x00405eb0
009b2482 : MOV byte ptr [EBP + -0x4],0xc
009b2486 : MOV ECX,ESI
009b2488 : CALL 0x00406560
009b248d : MOV byte ptr [EBP + -0x4],0x6
009b2491 : LEA ECX,[EBP + -0x48]
009b2494 : CALL 0x00406560
009b2499 : CMP dword ptr [EBP + -0x4c],0x8
009b249d : MOV ESI,dword ptr [EBX + 0xc]
009b24a0 : MOV EDI,dword ptr [EBX + 0x10]
009b24a3 : JC 0x009b24ad
009b24a5 : MOV EDX,dword ptr [EBP + -0x60]
009b24a8 : MOV dword ptr [EBP + -0x6c],EDX
009b24ab : JMP 0x009b24b3
009b24ad : LEA EAX,[EBP + -0x60]
009b24b0 : MOV dword ptr [EBP + -0x6c],EAX
009b24b3 : MOV EDX,dword ptr [EBX]
009b24b5 : MOV EAX,dword ptr [EDX + 0x40]
009b24b8 : MOV ECX,EBX
009b24ba : CALL EAX
009b24bc : MOV EDX,dword ptr [EBP + -0x68]
009b24bf : MOVZX ECX,AX
009b24c2 : MOV EAX,dword ptr [EBP + EDX*0x4 + 0xffffff78]
009b24c9 : PUSH ECX
009b24ca : MOV ECX,dword ptr [EBP + -0x6c]
009b24cd : PUSH EAX
009b24ce : PUSH ESI
009b24cf : PUSH EDI
009b24d0 : PUSH ECX
009b24d1 : PUSH 0xc8dca0
009b24d6 : LEA ESI,[EBP + 0xfffffe70]
009b24dc : CALL 0x00404750
009b24e1 : ADD ESP,0x18
009b24e4 : MOV byte ptr [EBP + -0x4],0xf
009b24e8 : PUSH -0x1
009b24ea : PUSH 0x0
009b24ec : PUSH EAX
009b24ed : LEA ECX,[EBP + -0x2c]
009b24f0 : CALL 0x00405eb0
009b24f5 : MOV byte ptr [EBP + -0x4],0x6
009b24f9 : MOV ECX,ESI
009b24fb : CALL 0x00406560
009b2500 : MOV byte ptr [EBP + -0x4],0x1
009b2504 : LEA ECX,[EBP + -0x64]
009b2507 : CALL 0x00406560
009b250c : MOV ESI,dword ptr [EBP + -0x70]
009b250f : XOR EDI,EDI
009b2511 : PUSH -0x1
009b2513 : PUSH EDI
009b2514 : LEA EAX,[EBP + -0x2c]
009b2517 : MOV EBX,0x7
009b251c : XOR EDX,EDX
009b251e : MOV dword ptr [ESI + 0x18],EBX
009b2521 : MOV dword ptr [ESI + 0x14],EDI
009b2524 : PUSH EAX
009b2525 : MOV ECX,ESI
009b2527 : MOV word ptr [ESI + 0x4],DX
009b252b : CALL 0x00405eb0
009b2530 : MOV dword ptr [EBP + -0x74],0x1
009b2537 : MOV byte ptr [EBP + -0x4],0x0
009b253b : CMP dword ptr [EBP + -0x14],0x8
009b253f : JC 0x009b2549
009b2541 : MOV ECX,dword ptr [EBP + -0x28]
009b2544 : CALL 0x006f04e0
009b2549 : XOR ECX,ECX
009b254b : MOV word ptr [EBP + -0x28],CX
009b254f : MOV dword ptr [EBP + -0x14],EBX
009b2552 : MOV dword ptr [EBP + -0x18],EDI
009b2555 : MOV EAX,ESI
009b2557 : MOV ECX,dword ptr [EBP + -0xc]
009b255a : MOV dword ptr FS:[0x0],ECX
009b2561 : POP ECX
009b2562 : POP EDI
009b2563 : POP ESI
009b2564 : POP EBX
009b2565 : MOV ECX,dword ptr [EBP + -0x10]
009b2568 : XOR ECX,EBP
009b256a : CALL 0x00633e6b
009b256f : MOV ESP,EBP
009b2571 : POP EBP
009b2572 : RET 0x8

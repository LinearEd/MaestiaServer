PROGRAM  : Maestia.exe
FUNCTION : FUN_00794380
ENTRY    : 00794380
BODY     : [[00794380, 007943c0]]

============================================================
DECOMPILED C CODE
============================================================

undefined * FUN_00794380(void)

{
  undefined *puVar1;
  int in_ECX;
  
  if (*(int *)(in_ECX + 0x18) == 0) {
    *(undefined4 *)(in_ECX + 0x14) = 1;
    puVar1 = (undefined *)WaitForSingleObject(*(HANDLE *)(in_ECX + 8),0xffffffff);
    ResetEvent(*(HANDLE *)(in_ECX + 8));
    *(undefined4 *)(in_ECX + 0x14) = 0;
    return puVar1;
  }
  return &DAT_00ff00ff;
}



============================================================
DISASSEMBLY
============================================================
00794380 : PUSH ESI
00794381 : MOV ESI,ECX
00794383 : MOV EAX,dword ptr [ESI + 0x18]
00794386 : TEST EAX,EAX
00794388 : JNZ 0x007943b8
0079438a : MOV ECX,dword ptr [ESI + 0x8]
0079438d : PUSH EDI
0079438e : PUSH -0x1
00794390 : PUSH ECX
00794391 : MOV dword ptr [ESI + 0x14],0x1
00794398 : CALL dword ptr [0x00b85100]
0079439e : MOV EDX,dword ptr [ESI + 0x8]
007943a1 : PUSH EDX
007943a2 : MOV EDI,EAX
007943a4 : CALL dword ptr [0x00b851dc]
007943aa : MOV EAX,EDI
007943ac : POP EDI
007943ad : MOV dword ptr [ESI + 0x14],0x0
007943b4 : POP ESI
007943b5 : RET 0x4
007943b8 : MOV EAX,0xff00ff
007943bd : POP ESI
007943be : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_00816fe0
ENTRY    : 00816fe0
BODY     : [[00816fe0, 00817038] [00817040, 00817385]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_00816fe0(undefined4 param_1)

{
  short sVar1;
  char cVar2;
  uint uVar3;
  undefined4 uVar4;
  short *psVar5;
  int *in_ECX;
  int iVar6;
  undefined1 local_4098 [8];
  undefined1 local_4090 [8];
  undefined1 local_4088 [4];
  undefined2 local_4084;
  undefined4 local_4074;
  uint local_4070;
  undefined2 local_4068;
  undefined4 local_4058;
  uint local_4054;
  uint local_4050;
  undefined4 local_404c;
  undefined4 local_4048;
  undefined4 local_4044;
  undefined2 local_4040 [2];
  undefined4 local_403c;
  int local_4038;
  undefined4 local_4034;
  uint local_4030;
  undefined4 local_402c;
  undefined2 local_4028 [2];
  int *local_4024;
  uint local_4020;
  int local_401c;
  short local_4018;
  undefined1 local_4016 [8190];
  short local_2018;
  undefined1 local_2016 [8190];
  uint local_18;
  undefined4 uStack_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3d112;
  local_10 = ExceptionList;
  uStack_14 = 0x816ffb;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_4034 = param_1;
  local_4030 = 0;
  local_4020 = 0;
  local_402c = 0;
  local_4024 = in_ECX;
  local_18 = uVar3;
  while (((uint)in_ECX[9] < (uint)in_ECX[8] &&
         (cVar2 = (**(code **)(*in_ECX + 0x1c))(&local_4048,uVar3), cVar2 != '\0'))) {
    switch(local_4048) {
    case 0x5061:
      (**(code **)(*in_ECX + 0xc))(&local_4030,2,1);
      local_401c = FUN_006f0760(0xc,"",0,(DAT_01725270 >> 3 & 1) == 0);
      local_8 = 0;
      if (local_401c == 0) {
        local_8 = 0xffffffff;
        local_402c = 0;
      }
      else {
        local_402c = FUN_00453410(local_401c);
        local_8 = 0xffffffff;
      }
      break;
    case 0x5062:
      (**(code **)(*in_ECX + 0xc))(&local_4020,2,1);
      break;
    case 0x5063:
      local_401c = 0;
      if ((short)local_4020 != 0) {
        do {
          local_4038 = FUN_006f0760(0x178,"",0,(DAT_01725270 >> 3 & 1) == 0);
          local_8 = 1;
          if (local_4038 == 0) {
            uVar4 = 0;
          }
          else {
            uVar4 = FUN_00705dd0(local_4038);
          }
          local_8 = 0xffffffff;
          (**(code **)(*in_ECX + 0xc))(local_4028,2,1);
          FUN_0070d320(&local_4018);
          iVar6 = 0;
          do {
            FUN_0070d320(&local_2018);
            psVar5 = &local_2018;
            local_4068 = 0;
            local_4054 = 7;
            local_4058 = 0;
            do {
              sVar1 = *psVar5;
              psVar5 = psVar5 + 1;
            } while (sVar1 != 0);
            FUN_00406360(&local_2018,(int)psVar5 - (int)local_2016 >> 1);
            local_8 = 2;
            FUN_00705fb0();
            local_8 = 0xffffffff;
            if (7 < local_4054) {
                    /* WARNING: Subroutine does not return */
              FUN_006f04e0();
            }
            iVar6 = iVar6 + 1;
            local_4054 = 7;
            local_4058 = 0;
            local_4068 = 0;
          } while (iVar6 < 0xc);
          psVar5 = &local_4018;
          local_4084 = 0;
          local_4070 = 7;
          local_4074 = 0;
          do {
            sVar1 = *psVar5;
            psVar5 = psVar5 + 1;
          } while (sVar1 != 0);
          FUN_00406360(&local_4018,(int)psVar5 - (int)local_4016 >> 1);
          local_8 = 3;
          FUN_00405eb0(local_4088,0,0xffffffff);
          local_8 = 0xffffffff;
          if (7 < local_4070) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          local_4084 = 0;
          local_4040[0] = local_4028[0];
          local_4070 = 7;
          local_4074 = 0;
          local_403c = uVar4;
          FUN_0041ed30(local_4098,local_4040);
          local_401c = local_401c + 1;
          in_ECX = local_4024;
        } while (local_401c < (int)(local_4020 & 0xffff));
      }
      local_4050 = local_4030 & 0xffff;
      local_404c = local_402c;
      FUN_00451e00(local_4090,&local_4050);
      break;
    case 0x5064:
      goto switchD_00817078_caseD_5064;
    default:
      (**(code **)(*in_ECX + 0x24))(local_4044);
    }
  }
switchD_00817078_caseD_5064:
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00816fe0 : PUSH EBP
00816fe1 : MOV EBP,ESP
00816fe3 : PUSH -0x1
00816fe5 : PUSH 0xb3d112
00816fea : MOV EAX,FS:[0x0]
00816ff0 : PUSH EAX
00816ff1 : MOV EAX,0x4088
00816ff6 : CALL 0x0063b780
00816ffb : MOV EAX,[0x00d66fa0]
00817000 : XOR EAX,EBP
00817002 : MOV dword ptr [EBP + -0x14],EAX
00817005 : PUSH EBX
00817006 : PUSH ESI
00817007 : PUSH EDI
00817008 : PUSH EAX
00817009 : LEA EAX,[EBP + -0xc]
0081700c : MOV FS:[0x0],EAX
00817012 : MOV EAX,dword ptr [EBP + 0x8]
00817015 : XOR EBX,EBX
00817017 : MOV EDI,ECX
00817019 : MOV dword ptr [EBP + 0xffffbfd0],EAX
0081701f : MOV dword ptr [EBP + 0xffffbfe0],EDI
00817025 : MOV dword ptr [EBP + 0xffffbfd4],EBX
0081702b : MOV dword ptr [EBP + 0xffffbfe4],EBX
00817031 : MOV dword ptr [EBP + 0xffffbfd8],EBX
00817037 : JMP 0x00817040
00817040 : MOV ECX,dword ptr [EDI + 0x24]
00817043 : CMP ECX,dword ptr [EDI + 0x20]
00817046 : JNC 0x00817368
0081704c : MOV EDX,dword ptr [EDI]
0081704e : MOV EDX,dword ptr [EDX + 0x1c]
00817051 : LEA EAX,[EBP + 0xffffbfbc]
00817057 : PUSH EAX
00817058 : MOV ECX,EDI
0081705a : CALL EDX
0081705c : TEST AL,AL
0081705e : JZ 0x00817368
00817064 : MOV EAX,dword ptr [EBP + 0xffffbfbc]
0081706a : ADD EAX,0xffffaf9f
0081706f : CMP EAX,0x3
00817072 : JA 0x00817353
00817078 : JMP dword ptr [EAX*0x4 + 0x817388]
0081707f : MOV EAX,dword ptr [EDI]
00817081 : MOV EDX,dword ptr [EAX + 0xc]
00817084 : PUSH 0x1
00817086 : PUSH 0x2
00817088 : LEA ECX,[EBP + 0xffffbfd4]
0081708e : PUSH ECX
0081708f : MOV ECX,EDI
00817091 : CALL EDX
00817093 : MOV EAX,[0x01725270]
00817098 : SHR EAX,0x3
0081709b : MOV ECX,0x0
008170a0 : AND EAX,0x1
008170a3 : SETZ CL
008170a6 : PUSH ECX
008170a7 : PUSH EBX
008170a8 : PUSH 0xbf1a4a
008170ad : PUSH 0xc
008170af : CALL 0x006f0760
008170b4 : ADD ESP,0x10
008170b7 : MOV dword ptr [EBP + 0xffffbfe8],EAX
008170bd : MOV dword ptr [EBP + -0x4],EBX
008170c0 : CMP EAX,EBX
008170c2 : JZ 0x008170dc
008170c4 : PUSH EAX
008170c5 : CALL 0x00453410
008170ca : MOV dword ptr [EBP + -0x4],0xffffffff
008170d1 : MOV dword ptr [EBP + 0xffffbfd8],EAX
008170d7 : JMP 0x00817040
008170dc : XOR EAX,EAX
008170de : MOV dword ptr [EBP + -0x4],0xffffffff
008170e5 : MOV dword ptr [EBP + 0xffffbfd8],EAX
008170eb : JMP 0x00817040
008170f0 : MOV EDX,dword ptr [EDI]
008170f2 : MOV EDX,dword ptr [EDX + 0xc]
008170f5 : PUSH 0x1
008170f7 : PUSH 0x2
008170f9 : LEA EAX,[EBP + 0xffffbfe4]
008170ff : PUSH EAX
00817100 : MOV ECX,EDI
00817102 : CALL EDX
00817104 : JMP 0x00817040
00817109 : XOR EAX,EAX
0081710b : MOV dword ptr [EBP + 0xffffbfe8],EBX
00817111 : CMP AX,word ptr [EBP + 0xffffbfe4]
00817118 : JNC 0x00817319
0081711e : MOV EDI,EDI
00817120 : MOV ECX,dword ptr [0x01725270]
00817126 : SHR ECX,0x3
00817129 : MOV EDX,0x0
0081712e : AND ECX,0x1
00817131 : SETZ DL
00817134 : PUSH EDX
00817135 : PUSH EBX
00817136 : PUSH 0xbf1a4a
0081713b : PUSH 0x178
00817140 : CALL 0x006f0760
00817145 : ADD ESP,0x10
00817148 : MOV dword ptr [EBP + 0xffffbfcc],EAX
0081714e : MOV dword ptr [EBP + -0x4],0x1
00817155 : CMP EAX,EBX
00817157 : JZ 0x00817163
00817159 : PUSH EAX
0081715a : CALL 0x00705dd0
0081715f : MOV ESI,EAX
00817161 : JMP 0x00817165
00817163 : XOR ESI,ESI
00817165 : MOV dword ptr [EBP + -0x4],0xffffffff
0081716c : MOV EAX,dword ptr [EDI]
0081716e : MOV EDX,dword ptr [EAX + 0xc]
00817171 : PUSH 0x1
00817173 : PUSH 0x2
00817175 : LEA ECX,[EBP + 0xffffbfdc]
0081717b : PUSH ECX
0081717c : MOV ECX,EDI
0081717e : CALL EDX
00817180 : LEA EAX,[EBP + 0xffffbfec]
00817186 : PUSH EAX
00817187 : MOV ECX,EDI
00817189 : CALL 0x0070d320
0081718e : XOR EDI,EDI
00817190 : LEA ECX,[EBP + 0xffffdfec]
00817196 : PUSH ECX
00817197 : MOV ECX,dword ptr [EBP + 0xffffbfe0]
0081719d : CALL 0x0070d320
008171a2 : XOR EDX,EDX
008171a4 : LEA EAX,[EBP + 0xffffdfec]
008171aa : MOV word ptr [EBP + 0xffffbf9c],DX
008171b1 : MOV dword ptr [EBP + 0xffffbfb0],0x7
008171bb : MOV dword ptr [EBP + 0xffffbfac],EBX
008171c1 : LEA EDX,[EAX + 0x2]
008171c4 : MOV CX,word ptr [EAX]
008171c7 : ADD EAX,0x2
008171ca : CMP CX,BX
008171cd : JNZ 0x008171c4
008171cf : SUB EAX,EDX
008171d1 : SAR EAX,0x1
008171d3 : PUSH EAX
008171d4 : LEA EAX,[EBP + 0xffffdfec]
008171da : PUSH EAX
008171db : LEA ECX,[EBP + 0xffffbf98]
008171e1 : CALL 0x00406360
008171e6 : MOV dword ptr [EBP + -0x4],0x2
008171ed : LEA ECX,[EBP + 0xffffbf98]
008171f3 : CALL 0x00705fb0
008171f8 : MOV dword ptr [EBP + -0x4],0xffffffff
008171ff : CMP dword ptr [EBP + 0xffffbfb0],0x8
00817206 : JC 0x00817213
00817208 : MOV ECX,dword ptr [EBP + 0xffffbf9c]
0081720e : CALL 0x006f04e0
00817213 : XOR ECX,ECX
00817215 : INC EDI
00817216 : CMP EDI,0xc
00817219 : MOV dword ptr [EBP + 0xffffbfb0],0x7
00817223 : MOV dword ptr [EBP + 0xffffbfac],EBX
00817229 : MOV word ptr [EBP + 0xffffbf9c],CX
00817230 : JL 0x00817190
00817236 : XOR EDX,EDX
00817238 : MOV EDI,0x7
0081723d : LEA EAX,[EBP + 0xffffbfec]
00817243 : MOV word ptr [EBP + 0xffffbf80],DX
0081724a : MOV dword ptr [EBP + 0xffffbf94],EDI
00817250 : MOV dword ptr [EBP + 0xffffbf90],EBX
00817256 : LEA EDX,[EAX + 0x2]
00817259 : LEA ESP,[ESP]
00817260 : MOV CX,word ptr [EAX]
00817263 : ADD EAX,0x2
00817266 : CMP CX,BX
00817269 : JNZ 0x00817260
0081726b : SUB EAX,EDX
0081726d : SAR EAX,0x1
0081726f : PUSH EAX
00817270 : LEA EAX,[EBP + 0xffffbfec]
00817276 : PUSH EAX
00817277 : LEA ECX,[EBP + 0xffffbf7c]
0081727d : CALL 0x00406360
00817282 : MOV dword ptr [EBP + -0x4],0x3
00817289 : PUSH -0x1
0081728b : PUSH EBX
0081728c : LEA ECX,[EBP + 0xffffbf7c]
00817292 : PUSH ECX
00817293 : MOV ECX,ESI
00817295 : CALL 0x00405eb0
0081729a : MOV dword ptr [EBP + -0x4],0xffffffff
008172a1 : CMP dword ptr [EBP + 0xffffbf94],0x8
008172a8 : JC 0x008172b5
008172aa : MOV ECX,dword ptr [EBP + 0xffffbf80]
008172b0 : CALL 0x006f04e0
008172b5 : MOV AX,word ptr [EBP + 0xffffbfdc]
008172bc : XOR EDX,EDX
008172be : LEA ECX,[EBP + 0xffffbfc4]
008172c4 : MOV word ptr [EBP + 0xffffbf80],DX
008172cb : PUSH ECX
008172cc : LEA EDX,[EBP + 0xffffbf6c]
008172d2 : MOV word ptr [EBP + 0xffffbfc4],AX
008172d9 : MOV EAX,dword ptr [EBP + 0xffffbfd8]
008172df : PUSH EDX
008172e0 : MOV dword ptr [EBP + 0xffffbf94],EDI
008172e6 : MOV dword ptr [EBP + 0xffffbf90],EBX
008172ec : MOV dword ptr [EBP + 0xffffbfc8],ESI
008172f2 : CALL 0x0041ed30
008172f7 : MOV EAX,dword ptr [EBP + 0xffffbfe8]
008172fd : MOVZX ECX,word ptr [EBP + 0xffffbfe4]
00817304 : MOV EDI,dword ptr [EBP + 0xffffbfe0]
0081730a : INC EAX
0081730b : CMP EAX,ECX
0081730d : MOV dword ptr [EBP + 0xffffbfe8],EAX
00817313 : JL 0x00817120
00817319 : MOVZX EDX,word ptr [EBP + 0xffffbfd4]
00817320 : MOV EAX,dword ptr [EBP + 0xffffbfd8]
00817326 : MOV dword ptr [EBP + 0xffffbfb8],EAX
0081732c : MOV EAX,dword ptr [EBP + 0xffffbfd0]
00817332 : LEA ECX,[EBP + 0xffffbfb4]
00817338 : MOV dword ptr [EBP + 0xffffbfb4],EDX
0081733e : PUSH ECX
0081733f : LEA EDX,[EBP + 0xffffbf74]
00817345 : PUSH EDX
00817346 : SUB EAX,-0x80
00817349 : CALL 0x00451e00
0081734e : JMP 0x00817040
00817353 : MOV ECX,dword ptr [EBP + 0xffffbfc0]
00817359 : MOV EAX,dword ptr [EDI]
0081735b : MOV EDX,dword ptr [EAX + 0x24]
0081735e : PUSH ECX
0081735f : MOV ECX,EDI
00817361 : CALL EDX
00817363 : JMP 0x00817040
00817368 : MOV ECX,dword ptr [EBP + -0xc]
0081736b : MOV dword ptr FS:[0x0],ECX
00817372 : POP ECX
00817373 : POP EDI
00817374 : POP ESI
00817375 : POP EBX
00817376 : MOV ECX,dword ptr [EBP + -0x14]
00817379 : XOR ECX,EBP
0081737b : CALL 0x00633e6b
00817380 : MOV ESP,EBP
00817382 : POP EBP
00817383 : RET 0x4

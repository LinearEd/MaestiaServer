PROGRAM  : Maestia.exe
FUNCTION : FUN_00591220
ENTRY    : 00591220
BODY     : [[00591220, 0059150d]]

============================================================
DECOMPILED C CODE
============================================================

bool FUN_00591220(int param_1,int *param_2,int *param_3,int param_4)

{
  int *piVar1;
  int iVar2;
  char cVar3;
  int iVar4;
  int iVar5;
  undefined4 uVar6;
  int *in_ECX;
  int iStack_1c;
  int *piStack_18;
  int iStack_14;
  undefined4 uStack_10;
  undefined4 uStack_c;
  undefined4 uStack_8;
  undefined4 uStack_4;
  
  piVar1 = param_3;
  cVar3 = FUN_0051d6b0(param_3,0);
  iVar5 = param_4;
  if (cVar3 != '\0') {
    iVar4 = FUN_00521500(piVar1);
    cVar3 = (**(code **)(*in_ECX + 0x100))(iVar4,iVar5,0);
    if (cVar3 != '\0') {
      return true;
    }
    if (iVar4 == 0x23) {
      iVar5 = FUN_00515840(0x44,0);
      if (iVar5 == 0) {
        iVar5 = 0;
      }
      else {
        uVar6 = (**(code **)(*in_ECX + 0x5c))();
        iVar5 = FUN_005c6940(uVar6,in_ECX);
      }
      FUN_005271c0(iVar5);
      if (iVar5 == 0) {
        return true;
      }
      FUN_00503db0();
      return true;
    }
    if ((iVar4 == 0x6b) && (-1 < in_ECX[0x68])) {
      (**(code **)(*in_ECX + 0x5c))();
      iVar5 = FUN_00525380("WIN 8,0,0,0",0xb,0);
      *(int *)(iVar5 + 8) = *(int *)(iVar5 + 8) + 1;
      param_1 = iVar5;
      FUN_004ffd40(&param_1);
      piVar1 = (int *)(iVar5 + 8);
      *piVar1 = *piVar1 + -1;
      if (*piVar1 == 0) {
        FUN_00525340();
      }
      return true;
    }
  }
  if (((param_1 != 0) && (*piVar1 == *(int *)(*(int *)(param_1 + 0x78) + 0x134))) ||
     ((param_2 != (int *)0x0 && (*piVar1 == *(int *)(*param_2 + 0x134))))) {
    FUN_005271c0(in_ECX[0x1b]);
    return true;
  }
  iVar4 = in_ECX[0x6a];
  if (iVar4 != 0) {
    iVar2 = *(int *)(iVar4 + 0x14);
    if (iVar2 != 0) {
      *(uint *)(iVar2 + 8) = *(int *)(iVar2 + 8) + 1U & 0x8fffffff;
    }
    param_4 = *(int *)(iVar4 + 0x14);
    if (param_4 != 0) {
      FUN_00503db0();
    }
    *(undefined4 *)(iVar4 + 0x14) = 0;
    param_3 = (int *)((uint)param_3 & 0xffffff00);
    if (((param_1 != 0) &&
        (cVar3 = (**(code **)(*(int *)(in_ECX[0x6a] + 0x10) + 0x10))(param_1,piVar1,iVar5),
        cVar3 != '\0')) ||
       ((param_2 != (int *)0x0 &&
        (cVar3 = (**(code **)(*(int *)(in_ECX[0x6a] + 0x10) + 0x2c))(param_2,piVar1,iVar5),
        cVar3 != '\0')))) {
      param_3 = (int *)CONCAT31(param_3._1_3_,1);
    }
    FUN_0058fe40(&iStack_1c,param_4);
    if (iStack_1c != 0) {
      FUN_00503db0();
    }
    if ((char)param_3 != '\0') {
      if (param_4 == 0) {
        return true;
      }
      FUN_00503db0();
      return true;
    }
    if (param_4 != 0) {
      FUN_00503db0();
    }
  }
  iVar4 = FUN_005ec5f0(in_ECX + 0x51,piVar1);
  if (iVar4 != 0) {
    FUN_00526c80(iVar4);
    return true;
  }
  iVar4 = in_ECX[0x1b];
  if (iVar4 != 0) {
    if ((param_1 != 0) &&
       (cVar3 = (**(code **)(*(int *)(iVar4 + 0x10) + 0x10))(param_1,piVar1,iVar5), cVar3 != '\0'))
    {
      return true;
    }
    if ((param_2 != (int *)0x0) &&
       (cVar3 = (**(code **)(*(int *)(iVar4 + 0x10) + 0x2c))(param_2,piVar1,iVar5), cVar3 != '\0'))
    {
      return true;
    }
  }
  iVar4 = FUN_00524bc0();
  if ((iVar4 != 0) && (**(char **)*piVar1 == '_')) {
    uStack_10 = 0;
    uStack_c = 0;
    uStack_8 = 0;
    uStack_4 = 0;
    piStack_18 = piVar1;
    iStack_14 = iVar5;
    FUN_0052a3c0(&param_1,&piStack_18);
    if ((char)param_1 != '\0') {
      return (char)param_1 == '\x01';
    }
  }
  return false;
}



============================================================
DISASSEMBLY
============================================================
00591220 : SUB ESP,0x1c
00591223 : PUSH EBX
00591224 : PUSH EBP
00591225 : PUSH ESI
00591226 : PUSH EDI
00591227 : MOV EDI,dword ptr [ESP + 0x38]
0059122b : PUSH 0x0
0059122d : PUSH EDI
0059122e : MOV ESI,ECX
00591230 : CALL 0x0051d6b0
00591235 : MOV EBX,dword ptr [ESP + 0x44]
00591239 : ADD ESP,0x8
0059123c : TEST AL,AL
0059123e : JZ 0x00591322
00591244 : PUSH EDI
00591245 : MOV ECX,ESI
00591247 : CALL 0x00521500
0059124c : PUSH 0x0
0059124e : MOV EBP,EAX
00591250 : MOV EAX,dword ptr [ESI]
00591252 : MOV EDX,dword ptr [EAX + 0x100]
00591258 : PUSH EBX
00591259 : PUSH EBP
0059125a : MOV ECX,ESI
0059125c : CALL EDX
0059125e : TEST AL,AL
00591260 : JNZ 0x00591316
00591266 : CMP EBP,0x23
00591269 : JZ 0x005912cf
0059126b : CMP EBP,0x6b
0059126e : JNZ 0x00591322
00591274 : CMP dword ptr [ESI + 0x1a0],0x0
0059127b : JL 0x00591322
00591281 : MOV EAX,dword ptr [ESI]
00591283 : MOV EDX,dword ptr [EAX + 0x5c]
00591286 : MOV ECX,ESI
00591288 : CALL EDX
0059128a : MOV EAX,dword ptr [EAX + 0x78]
0059128d : PUSH 0x0
0059128f : PUSH 0xb
00591291 : PUSH 0xb8e858
00591296 : LEA ECX,[EAX + 0x254]
0059129c : CALL 0x00525380
005912a1 : MOV ESI,EAX
005912a3 : INC dword ptr [ESI + 0x8]
005912a6 : LEA EAX,[ESP + 0x30]
005912aa : PUSH EAX
005912ab : MOV ECX,EBX
005912ad : MOV dword ptr [ESP + 0x34],ESI
005912b1 : CALL 0x004ffd40
005912b6 : ADD dword ptr [ESI + 0x8],-0x1
005912ba : JNZ 0x005912c3
005912bc : MOV ECX,ESI
005912be : CALL 0x00525340
005912c3 : POP EDI
005912c4 : POP ESI
005912c5 : POP EBP
005912c6 : MOV AL,0x1
005912c8 : POP EBX
005912c9 : ADD ESP,0x1c
005912cc : RET 0x10
005912cf : MOV ECX,dword ptr [ESP + 0x30]
005912d3 : MOV EDX,dword ptr [ECX + 0x78]
005912d6 : MOV ECX,dword ptr [EDX + 0x288]
005912dc : PUSH 0x0
005912de : PUSH 0x44
005912e0 : CALL 0x00515840
005912e5 : MOV EDI,EAX
005912e7 : TEST EDI,EDI
005912e9 : JZ 0x00591301
005912eb : MOV EAX,dword ptr [ESI]
005912ed : MOV EDX,dword ptr [EAX + 0x5c]
005912f0 : PUSH ESI
005912f1 : MOV ECX,ESI
005912f3 : CALL EDX
005912f5 : PUSH EAX
005912f6 : MOV ECX,EDI
005912f8 : CALL 0x005c6940
005912fd : MOV ESI,EAX
005912ff : JMP 0x00591303
00591301 : XOR ESI,ESI
00591303 : PUSH ESI
00591304 : MOV ECX,EBX
00591306 : CALL 0x005271c0
0059130b : TEST ESI,ESI
0059130d : JZ 0x00591316
0059130f : MOV ECX,ESI
00591311 : CALL 0x00503db0
00591316 : POP EDI
00591317 : POP ESI
00591318 : POP EBP
00591319 : MOV AL,0x1
0059131b : POP EBX
0059131c : ADD ESP,0x1c
0059131f : RET 0x10
00591322 : MOV EDX,dword ptr [ESP + 0x30]
00591326 : TEST EDX,EDX
00591328 : JZ 0x00591337
0059132a : MOV EAX,dword ptr [EDX + 0x78]
0059132d : MOV ECX,dword ptr [EDI]
0059132f : CMP ECX,dword ptr [EAX + 0x134]
00591335 : JZ 0x0059134b
00591337 : MOV EAX,dword ptr [ESP + 0x34]
0059133b : TEST EAX,EAX
0059133d : JZ 0x00591362
0059133f : MOV EAX,dword ptr [EAX]
00591341 : MOV ECX,dword ptr [EDI]
00591343 : CMP ECX,dword ptr [EAX + 0x134]
00591349 : JNZ 0x00591362
0059134b : MOV EDX,dword ptr [ESI + 0x6c]
0059134e : PUSH EDX
0059134f : MOV ECX,EBX
00591351 : CALL 0x005271c0
00591356 : POP EDI
00591357 : POP ESI
00591358 : POP EBP
00591359 : MOV AL,0x1
0059135b : POP EBX
0059135c : ADD ESP,0x1c
0059135f : RET 0x10
00591362 : MOV EBP,dword ptr [ESI + 0x1a8]
00591368 : TEST EBP,EBP
0059136a : JZ 0x00591436
00591370 : MOV EAX,dword ptr [EBP + 0x14]
00591373 : TEST EAX,EAX
00591375 : JZ 0x00591384
00591377 : MOV ECX,dword ptr [EAX + 0x8]
0059137a : INC ECX
0059137b : AND ECX,0x8fffffff
00591381 : MOV dword ptr [EAX + 0x8],ECX
00591384 : MOV EAX,dword ptr [EBP + 0x14]
00591387 : MOV ECX,EAX
00591389 : MOV dword ptr [ESP + 0x3c],EAX
0059138d : TEST ECX,ECX
0059138f : JZ 0x0059139a
00591391 : CALL 0x00503db0
00591396 : MOV EDX,dword ptr [ESP + 0x30]
0059139a : MOV dword ptr [EBP + 0x14],0x0
005913a1 : MOV byte ptr [ESP + 0x38],0x0
005913a6 : TEST EDX,EDX
005913a8 : JZ 0x005913c2
005913aa : MOV ECX,dword ptr [ESI + 0x1a8]
005913b0 : MOV EAX,dword ptr [ECX + 0x10]
005913b3 : PUSH EBX
005913b4 : ADD ECX,0x10
005913b7 : PUSH EDI
005913b8 : PUSH EDX
005913b9 : MOV EDX,dword ptr [EAX + 0x10]
005913bc : CALL EDX
005913be : TEST AL,AL
005913c0 : JNZ 0x005913e2
005913c2 : MOV EAX,dword ptr [ESP + 0x34]
005913c6 : TEST EAX,EAX
005913c8 : JZ 0x005913e7
005913ca : MOV ECX,dword ptr [ESI + 0x1a8]
005913d0 : MOV EDX,dword ptr [ECX + 0x10]
005913d3 : PUSH EBX
005913d4 : ADD ECX,0x10
005913d7 : PUSH EDI
005913d8 : PUSH EAX
005913d9 : MOV EAX,dword ptr [EDX + 0x2c]
005913dc : CALL EAX
005913de : TEST AL,AL
005913e0 : JZ 0x005913e7
005913e2 : MOV byte ptr [ESP + 0x38],0x1
005913e7 : MOV ECX,dword ptr [ESP + 0x3c]
005913eb : PUSH ECX
005913ec : MOV ECX,dword ptr [ESI + 0x1a8]
005913f2 : LEA EDX,[ESP + 0x14]
005913f6 : PUSH EDX
005913f7 : CALL 0x0058fe40
005913fc : MOV ECX,dword ptr [ESP + 0x10]
00591400 : TEST ECX,ECX
00591402 : JZ 0x00591409
00591404 : CALL 0x00503db0
00591409 : CMP byte ptr [ESP + 0x38],0x0
0059140e : MOV ECX,dword ptr [ESP + 0x3c]
00591412 : JZ 0x0059142d
00591414 : TEST ECX,ECX
00591416 : JZ 0x00591316
0059141c : CALL 0x00503db0
00591421 : POP EDI
00591422 : POP ESI
00591423 : POP EBP
00591424 : MOV AL,0x1
00591426 : POP EBX
00591427 : ADD ESP,0x1c
0059142a : RET 0x10
0059142d : TEST ECX,ECX
0059142f : JZ 0x00591436
00591431 : CALL 0x00503db0
00591436 : PUSH EDI
00591437 : LEA EAX,[ESI + 0x144]
0059143d : PUSH EAX
0059143e : LEA ECX,[ESI + 0xa8]
00591444 : CALL 0x005ec5f0
00591449 : TEST EAX,EAX
0059144b : JZ 0x00591461
0059144d : PUSH EAX
0059144e : MOV ECX,EBX
00591450 : CALL 0x00526c80
00591455 : POP EDI
00591456 : POP ESI
00591457 : POP EBP
00591458 : MOV AL,0x1
0059145a : POP EBX
0059145b : ADD ESP,0x1c
0059145e : RET 0x10
00591461 : MOV EBP,dword ptr [ESI + 0x6c]
00591464 : TEST EBP,EBP
00591466 : JZ 0x005914a4
00591468 : MOV EAX,dword ptr [ESP + 0x30]
0059146c : TEST EAX,EAX
0059146e : JZ 0x00591486
00591470 : MOV EDX,dword ptr [EBP + 0x10]
00591473 : PUSH EBX
00591474 : LEA ECX,[EBP + 0x10]
00591477 : PUSH EDI
00591478 : PUSH EAX
00591479 : MOV EAX,dword ptr [EDX + 0x10]
0059147c : CALL EAX
0059147e : TEST AL,AL
00591480 : JNZ 0x00591316
00591486 : MOV EAX,dword ptr [ESP + 0x34]
0059148a : TEST EAX,EAX
0059148c : JZ 0x005914a4
0059148e : MOV EDX,dword ptr [EBP + 0x10]
00591491 : PUSH EBX
00591492 : LEA ECX,[EBP + 0x10]
00591495 : PUSH EDI
00591496 : PUSH EAX
00591497 : MOV EAX,dword ptr [EDX + 0x2c]
0059149a : CALL EAX
0059149c : TEST AL,AL
0059149e : JNZ 0x00591316
005914a4 : MOV ECX,EDI
005914a6 : CALL 0x00524bc0
005914ab : TEST EAX,EAX
005914ad : JBE 0x00591502
005914af : MOV ECX,dword ptr [EDI]
005914b1 : MOV EDX,dword ptr [ECX]
005914b3 : CMP byte ptr [EDX],0x5f
005914b6 : JNZ 0x00591502
005914b8 : XOR EAX,EAX
005914ba : MOV dword ptr [ESP + 0x1c],EAX
005914be : MOV dword ptr [ESP + 0x20],EAX
005914c2 : MOV dword ptr [ESP + 0x24],EAX
005914c6 : MOV dword ptr [ESP + 0x28],EAX
005914ca : LEA EAX,[ESP + 0x14]
005914ce : PUSH EAX
005914cf : LEA ECX,[ESP + 0x34]
005914d3 : PUSH ECX
005914d4 : LEA ECX,[ESI + 0xcc]
005914da : MOV dword ptr [ESP + 0x1c],EDI
005914de : MOV dword ptr [ESP + 0x20],EBX
005914e2 : CALL 0x0052a3c0
005914e7 : MOV AL,byte ptr [ESP + 0x30]
005914eb : TEST AL,AL
005914ed : JZ 0x00591502
005914ef : POP EDI
005914f0 : XOR EDX,EDX
005914f2 : CMP AL,0x1
005914f4 : POP ESI
005914f5 : SETZ DL
005914f8 : POP EBP
005914f9 : MOV AL,DL
005914fb : POP EBX
005914fc : ADD ESP,0x1c
005914ff : RET 0x10
00591502 : POP EDI
00591503 : POP ESI
00591504 : POP EBP
00591505 : XOR AL,AL
00591507 : POP EBX
00591508 : ADD ESP,0x1c
0059150b : RET 0x10

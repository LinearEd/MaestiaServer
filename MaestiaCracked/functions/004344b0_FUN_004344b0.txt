PROGRAM  : Maestia.exe
FUNCTION : FUN_004344b0
ENTRY    : 004344b0
BODY     : [[004344b0, 004344ec] [004344f0, 00434516]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_004344b0(wchar_t *param_1)

{
  wchar_t wVar1;
  wchar_t *_Dest;
  undefined4 in_ECX;
  undefined4 in_EDX;
  ushort *unaff_ESI;
  
  *unaff_ESI = 0;
  _Dest = (wchar_t *)(unaff_ESI + 6);
  *(undefined1 *)(unaff_ESI + 1) = 0x46;
  *(undefined1 *)((int)unaff_ESI + 3) = 0x3c;
  *(undefined4 *)(unaff_ESI + 2) = in_ECX;
  *(undefined4 *)(unaff_ESI + 4) = in_EDX;
  _wcsncpy(_Dest,param_1,0xff);
  unaff_ESI[0x105] = 0;
  do {
    wVar1 = *_Dest;
    _Dest = _Dest + 1;
  } while (wVar1 != L'\0');
  *unaff_ESI = *unaff_ESI ^
               ((short)((int)_Dest - (int)(unaff_ESI + 7) >> 1) * 2 + 0xeU ^ *unaff_ESI) & 0x1fff;
  return;
}



============================================================
DISASSEMBLY
============================================================
004344b0 : PUSH EBP
004344b1 : MOV EBP,ESP
004344b3 : PUSH EDI
004344b4 : XOR EAX,EAX
004344b6 : MOV word ptr [ESI],AX
004344b9 : MOV EAX,dword ptr [EBP + 0x8]
004344bc : PUSH 0xff
004344c1 : PUSH EAX
004344c2 : LEA EDI,[ESI + 0xc]
004344c5 : PUSH EDI
004344c6 : MOV byte ptr [ESI + 0x2],0x46
004344ca : MOV byte ptr [ESI + 0x3],0x3c
004344ce : MOV dword ptr [ESI + 0x4],ECX
004344d1 : MOV dword ptr [ESI + 0x8],EDX
004344d4 : CALL 0x00634e39
004344d9 : ADD ESP,0xc
004344dc : XOR ECX,ECX
004344de : MOV EAX,EDI
004344e0 : MOV word ptr [EDI + 0x1fe],CX
004344e7 : LEA EDX,[EAX + 0x2]
004344ea : POP EDI
004344eb : JMP 0x004344f0
004344f0 : MOV CX,word ptr [EAX]
004344f3 : ADD EAX,0x2
004344f6 : TEST CX,CX
004344f9 : JNZ 0x004344f0
004344fb : SUB EAX,EDX
004344fd : SAR EAX,0x1
004344ff : LEA EDX,[EAX + EAX*0x1 + 0xe]
00434503 : XOR DX,word ptr [ESI]
00434506 : MOV EAX,0x1fff
0043450b : AND DX,AX
0043450e : XOR word ptr [ESI],DX
00434511 : MOV EAX,ESI
00434513 : POP EBP
00434514 : RET 0x4

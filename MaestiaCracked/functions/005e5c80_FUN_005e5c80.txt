PROGRAM  : Maestia.exe
FUNCTION : FUN_005e5c80
ENTRY    : 005e5c80
BODY     : [[005e5c80, 005e5d0b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005e5c80(void)

{
  undefined4 *puVar1;
  uint uVar2;
  LONG LVar3;
  int *in_ECX;
  int iVar4;
  int local_8;
  
  if (*in_ECX != 0) {
    iVar4 = 0;
    local_8 = *(int *)(*in_ECX + 4) + 1;
    do {
      puVar1 = (undefined4 *)(*in_ECX + 8 + iVar4);
      if (*(int *)(*in_ECX + 8 + iVar4) != -2) {
        uVar2 = puVar1[3];
        LVar3 = InterlockedExchangeAdd((LONG *)((uVar2 & 0xfffffffc) + 4),-1);
        if (LVar3 == 1) {
          FUN_00515cf0(uVar2 & 0xfffffffc);
        }
        uVar2 = puVar1[2];
        LVar3 = InterlockedExchangeAdd((LONG *)((uVar2 & 0xfffffffc) + 4),-1);
        if (LVar3 == 1) {
          FUN_00515cf0(uVar2 & 0xfffffffc);
        }
        *puVar1 = 0xfffffffe;
      }
      iVar4 = iVar4 + 0x18;
      local_8 = local_8 + -1;
    } while (local_8 != 0);
    FUN_00515cf0(*in_ECX);
    *in_ECX = 0;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005e5c80 : SUB ESP,0x8
005e5c83 : PUSH ESI
005e5c84 : MOV ESI,ECX
005e5c86 : MOV EAX,dword ptr [ESI]
005e5c88 : MOV dword ptr [ESP + 0x8],ESI
005e5c8c : TEST EAX,EAX
005e5c8e : JZ 0x005e5d07
005e5c90 : MOV EAX,dword ptr [EAX + 0x4]
005e5c93 : PUSH EBX
005e5c94 : MOV EBX,dword ptr [0x00b851cc]
005e5c9a : PUSH EBP
005e5c9b : XOR EBP,EBP
005e5c9d : INC EAX
005e5c9e : PUSH EDI
005e5c9f : MOV dword ptr [ESP + 0x10],EAX
005e5ca3 : MOV EAX,dword ptr [ESI]
005e5ca5 : CMP dword ptr [EAX + EBP*0x1 + 0x8],-0x2
005e5caa : LEA EDI,[EAX + EBP*0x1 + 0x8]
005e5cae : JZ 0x005e5cec
005e5cb0 : MOV ESI,dword ptr [EDI + 0xc]
005e5cb3 : AND ESI,0xfffffffc
005e5cb6 : PUSH -0x1
005e5cb8 : LEA ECX,[ESI + 0x4]
005e5cbb : PUSH ECX
005e5cbc : CALL EBX
005e5cbe : SUB EAX,0x1
005e5cc1 : JNZ 0x005e5cc9
005e5cc3 : PUSH ESI
005e5cc4 : CALL 0x00515cf0
005e5cc9 : MOV ESI,dword ptr [EDI + 0x8]
005e5ccc : AND ESI,0xfffffffc
005e5ccf : PUSH -0x1
005e5cd1 : LEA EDX,[ESI + 0x4]
005e5cd4 : PUSH EDX
005e5cd5 : CALL EBX
005e5cd7 : SUB EAX,0x1
005e5cda : JNZ 0x005e5ce2
005e5cdc : PUSH ESI
005e5cdd : CALL 0x00515cf0
005e5ce2 : MOV ESI,dword ptr [ESP + 0x14]
005e5ce6 : MOV dword ptr [EDI],0xfffffffe
005e5cec : ADD EBP,0x18
005e5cef : SUB dword ptr [ESP + 0x10],0x1
005e5cf4 : JNZ 0x005e5ca3
005e5cf6 : MOV EAX,dword ptr [ESI]
005e5cf8 : PUSH EAX
005e5cf9 : CALL 0x00515cf0
005e5cfe : POP EDI
005e5cff : POP EBP
005e5d00 : MOV dword ptr [ESI],0x0
005e5d06 : POP EBX
005e5d07 : POP ESI
005e5d08 : ADD ESP,0x8
005e5d0b : RET

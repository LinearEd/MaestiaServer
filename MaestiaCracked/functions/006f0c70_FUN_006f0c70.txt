PROGRAM  : Maestia.exe
FUNCTION : FUN_006f0c70
ENTRY    : 006f0c70
BODY     : [[006f0c70, 006f0d6c] [006f0d70, 006f0d9c]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_006f0c70(void)

{
  bool bVar1;
  bool bVar2;
  short sVar3;
  short *psVar4;
  int in_ECX;
  uint uVar5;
  short *psVar6;
  short local_2008;
  undefined1 local_2006 [8190];
  uint local_8;
  
  local_8 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  uVar5 = *(uint *)(in_ECX + 0x14);
  if ((uVar5 != 0) && (uVar5 < 0x1000)) {
    psVar4 = &local_2008;
    bVar1 = false;
    bVar2 = false;
    if (*(uint *)(in_ECX + 0x18) < 8) {
      psVar6 = (short *)(in_ECX + 4);
    }
    else {
      psVar6 = *(short **)(in_ECX + 4);
    }
joined_r0x006f0cc7:
    if (uVar5 != 0) {
      sVar3 = *psVar6;
      uVar5 = uVar5 - 1;
      if (sVar3 == 0) goto LAB_006f0d57;
      psVar6 = psVar6 + 1;
      if (sVar3 != 10) {
        if ((sVar3 != 0x20) && (sVar3 != 9)) {
          bVar2 = false;
          if ((((sVar3 == 0x2e) || (sVar3 == 0x3f)) || (sVar3 == 0x21)) ||
             ((sVar3 == 0x22 || (sVar3 == 0x27)))) {
            bVar1 = true;
          }
          else {
            bVar1 = false;
          }
          goto LAB_006f0d37;
        }
        if (!bVar2) {
          bVar2 = true;
LAB_006f0d37:
          *psVar4 = sVar3;
          psVar4 = psVar4 + 1;
        }
        goto joined_r0x006f0cc7;
      }
      if (!bVar1) {
        if (bVar2) goto joined_r0x006f0cc7;
        sVar3 = 0x20;
        bVar2 = true;
      }
      bVar1 = false;
      goto LAB_006f0d37;
    }
LAB_006f0d57:
    *psVar4 = 0;
    psVar4 = &local_2008;
    do {
      sVar3 = *psVar4;
      psVar4 = psVar4 + 1;
    } while (sVar3 != 0);
    FUN_00406360(&local_2008,(int)psVar4 - (int)local_2006 >> 1);
  }
  __security_check_cookie(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
006f0c70 : PUSH EBP
006f0c71 : MOV EBP,ESP
006f0c73 : MOV EAX,0x200c
006f0c78 : CALL 0x0063b780
006f0c7d : MOV EAX,[0x00d66fa0]
006f0c82 : XOR EAX,EBP
006f0c84 : MOV dword ptr [EBP + -0x4],EAX
006f0c87 : PUSH EBX
006f0c88 : MOV EBX,dword ptr [ECX + 0x14]
006f0c8b : MOV dword ptr [EBP + 0xffffdff4],ECX
006f0c91 : TEST EBX,EBX
006f0c93 : JZ 0x006f0d8e
006f0c99 : CMP EBX,0x1000
006f0c9f : JNC 0x006f0d8e
006f0ca5 : PUSH ESI
006f0ca6 : LEA EAX,[EBP + 0xffffdffc]
006f0cac : XOR ESI,ESI
006f0cae : XOR EDX,EDX
006f0cb0 : CMP dword ptr [ECX + 0x18],0x8
006f0cb4 : PUSH EDI
006f0cb5 : MOV dword ptr [EBP + 0xffffdff8],EAX
006f0cbb : JC 0x006f0cc2
006f0cbd : MOV EDI,dword ptr [ECX + 0x4]
006f0cc0 : JMP 0x006f0cc5
006f0cc2 : LEA EDI,[ECX + 0x4]
006f0cc5 : TEST EBX,EBX
006f0cc7 : JBE 0x006f0d57
006f0ccd : LEA ECX,[ECX]
006f0cd0 : MOVZX EAX,word ptr [EDI]
006f0cd3 : DEC EBX
006f0cd4 : TEST AX,AX
006f0cd7 : JZ 0x006f0d57
006f0cd9 : MOVZX EAX,AX
006f0cdc : ADD EDI,0x2
006f0cdf : CMP AX,0xa
006f0ce3 : JNZ 0x006f0cf7
006f0ce5 : TEST ESI,ESI
006f0ce7 : JNZ 0x006f0cf3
006f0ce9 : TEST EDX,EDX
006f0ceb : JNZ 0x006f0d4f
006f0ced : LEA EAX,[ESI + 0x20]
006f0cf0 : LEA EDX,[ESI + 0x1]
006f0cf3 : XOR ESI,ESI
006f0cf5 : JMP 0x006f0d37
006f0cf7 : CMP AX,0x20
006f0cfb : JZ 0x006f0d2e
006f0cfd : CMP AX,0x9
006f0d01 : JZ 0x006f0d2e
006f0d03 : XOR EDX,EDX
006f0d05 : CMP AX,0x2e
006f0d09 : JZ 0x006f0d27
006f0d0b : CMP AX,0x3f
006f0d0f : JZ 0x006f0d27
006f0d11 : CMP AX,0x21
006f0d15 : JZ 0x006f0d27
006f0d17 : CMP AX,0x22
006f0d1b : JZ 0x006f0d27
006f0d1d : CMP AX,0x27
006f0d21 : JZ 0x006f0d27
006f0d23 : XOR ESI,ESI
006f0d25 : JMP 0x006f0d37
006f0d27 : MOV ESI,0x1
006f0d2c : JMP 0x006f0d37
006f0d2e : TEST EDX,EDX
006f0d30 : JNZ 0x006f0d4f
006f0d32 : MOV EDX,0x1
006f0d37 : MOV ECX,dword ptr [EBP + 0xffffdff8]
006f0d3d : MOV word ptr [ECX],AX
006f0d40 : ADD ECX,0x2
006f0d43 : MOV dword ptr [EBP + 0xffffdff8],ECX
006f0d49 : MOV ECX,dword ptr [EBP + 0xffffdff4]
006f0d4f : TEST EBX,EBX
006f0d51 : JA 0x006f0cd0
006f0d57 : MOV EAX,dword ptr [EBP + 0xffffdff8]
006f0d5d : XOR EDX,EDX
006f0d5f : MOV word ptr [EAX],DX
006f0d62 : LEA EAX,[EBP + 0xffffdffc]
006f0d68 : LEA ESI,[EAX + 0x2]
006f0d6b : JMP 0x006f0d70
006f0d70 : MOV DX,word ptr [EAX]
006f0d73 : ADD EAX,0x2
006f0d76 : TEST DX,DX
006f0d79 : JNZ 0x006f0d70
006f0d7b : SUB EAX,ESI
006f0d7d : SAR EAX,0x1
006f0d7f : PUSH EAX
006f0d80 : LEA EDX,[EBP + 0xffffdffc]
006f0d86 : PUSH EDX
006f0d87 : CALL 0x00406360
006f0d8c : POP EDI
006f0d8d : POP ESI
006f0d8e : MOV ECX,dword ptr [EBP + -0x4]
006f0d91 : XOR ECX,EBP
006f0d93 : POP EBX
006f0d94 : CALL 0x00633e6b
006f0d99 : MOV ESP,EBP
006f0d9b : POP EBP
006f0d9c : RET

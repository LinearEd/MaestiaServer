PROGRAM  : Maestia.exe
FUNCTION : FUN_00663a10
ENTRY    : 00663a10
BODY     : [[00663a10, 00663aba]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00663a10(int param_1,int *param_2)

{
  int iVar1;
  undefined4 uVar2;
  void *local_c;
  undefined1 *puStack_8;
  undefined4 uStack_4;
  
  uStack_4 = 0xffffffff;
  puStack_8 = &LAB_00b0c77b;
  local_c = ExceptionList;
  uVar2 = 0;
  if (param_2 == (int *)0x0) {
    return 0x80004003;
  }
  ExceptionList = &local_c;
  iVar1 = (**(code **)(**(int **)(param_1 + 8) + 0x10))(DAT_00d66fa0 ^ (uint)&stack0xffffffe8);
  if (iVar1 == *(int *)(param_1 + 0xc)) {
    iVar1 = FUN_006f0300(0x14);
    uStack_4 = 0;
    if (iVar1 == 0) {
      iVar1 = 0;
    }
    else {
      iVar1 = FUN_00663980(*(undefined4 *)(param_1 + 8),param_1);
    }
    *param_2 = iVar1;
    if (iVar1 == 0) {
      uVar2 = 0x8007000e;
    }
  }
  else {
    *param_2 = 0;
    uVar2 = 0x80040203;
  }
  ExceptionList = local_c;
  return uVar2;
}



============================================================
DISASSEMBLY
============================================================
00663a10 : PUSH -0x1
00663a12 : PUSH 0xb0c77b
00663a17 : MOV EAX,FS:[0x0]
00663a1d : PUSH EAX
00663a1e : PUSH EBX
00663a1f : PUSH ESI
00663a20 : PUSH EDI
00663a21 : MOV EAX,[0x00d66fa0]
00663a26 : XOR EAX,ESP
00663a28 : PUSH EAX
00663a29 : LEA EAX,[ESP + 0x10]
00663a2d : MOV FS:[0x0],EAX
00663a33 : MOV EBX,dword ptr [ESP + 0x24]
00663a37 : XOR EDI,EDI
00663a39 : CMP EBX,EDI
00663a3b : JNZ 0x00663a57
00663a3d : MOV EAX,0x80004003
00663a42 : MOV ECX,dword ptr [ESP + 0x10]
00663a46 : MOV dword ptr FS:[0x0],ECX
00663a4d : POP ECX
00663a4e : POP EDI
00663a4f : POP ESI
00663a50 : POP EBX
00663a51 : ADD ESP,0xc
00663a54 : RET 0x8
00663a57 : MOV ESI,dword ptr [ESP + 0x20]
00663a5b : MOV ECX,dword ptr [ESI + 0x8]
00663a5e : MOV EAX,dword ptr [ECX]
00663a60 : MOV EDX,dword ptr [EAX + 0x10]
00663a63 : CALL EDX
00663a65 : CMP EAX,dword ptr [ESI + 0xc]
00663a68 : JZ 0x00663a73
00663a6a : MOV dword ptr [EBX],EDI
00663a6c : MOV EDI,0x80040203
00663a71 : JMP 0x00663aa4
00663a73 : PUSH 0x14
00663a75 : CALL 0x006f0300
00663a7a : ADD ESP,0x4
00663a7d : MOV dword ptr [ESP + 0x24],EAX
00663a81 : MOV dword ptr [ESP + 0x18],EDI
00663a85 : CMP EAX,EDI
00663a87 : JZ 0x00663a97
00663a89 : MOV ECX,dword ptr [ESI + 0x8]
00663a8c : PUSH ESI
00663a8d : PUSH ECX
00663a8e : MOV ECX,EAX
00663a90 : CALL 0x00663980
00663a95 : JMP 0x00663a99
00663a97 : XOR EAX,EAX
00663a99 : MOV dword ptr [EBX],EAX
00663a9b : CMP EAX,EDI
00663a9d : JNZ 0x00663aa4
00663a9f : MOV EDI,0x8007000e
00663aa4 : MOV EAX,EDI
00663aa6 : MOV ECX,dword ptr [ESP + 0x10]
00663aaa : MOV dword ptr FS:[0x0],ECX
00663ab1 : POP ECX
00663ab2 : POP EDI
00663ab3 : POP ESI
00663ab4 : POP EBX
00663ab5 : ADD ESP,0xc
00663ab8 : RET 0x8

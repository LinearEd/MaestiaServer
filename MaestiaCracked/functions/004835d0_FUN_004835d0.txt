PROGRAM  : Maestia.exe
FUNCTION : FUN_004835d0
ENTRY    : 004835d0
BODY     : [[004835d0, 0048371d]]

============================================================
DECOMPILED C CODE
============================================================

char FUN_004835d0(void)

{
  int *piVar1;
  char cVar2;
  int iVar3;
  LONG LVar4;
  int in_ECX;
  undefined4 *puVar5;
  undefined4 *puVar6;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b73ed8;
  local_10 = ExceptionList;
  if (*(char *)(in_ECX + 8) == '\0') {
    return '\x01';
  }
  ExceptionList = &local_10;
  iVar3 = (**(code **)(**(int **)(in_ECX + 0xf0) + 0xc))
                    (*(int **)(in_ECX + 0xf0),DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
  if (iVar3 != 0) {
    (**(code **)(**(int **)(in_ECX + 0xf0) + 0x104))(*(int **)(in_ECX + 0xf0),0,0);
    EnterCriticalSection((LPCRITICAL_SECTION)(in_ECX + 0x184));
    local_8 = 0;
    puVar5 = (undefined4 *)0x0;
    if (*(int *)(in_ECX + 0x180) != 0) {
      puVar5 = (undefined4 *)(*(int *)(in_ECX + 0x180) + -8);
    }
    while( true ) {
      puVar6 = puVar5;
      if (puVar6 == (undefined4 *)0x0) {
        puVar5 = (undefined4 *)0x0;
      }
      else {
        puVar5 = puVar6 + 2;
      }
      if (puVar5 == (undefined4 *)(in_ECX + 0x17c)) break;
      if (puVar6[3] == 0) {
        puVar5 = (undefined4 *)0x0;
      }
      else {
        puVar5 = (undefined4 *)(puVar6[3] + -8);
      }
      cVar2 = FUN_00484090();
      if (cVar2 != '\0') {
        piVar1 = (int *)puVar6[0x12];
        if (piVar1 != (int *)0x0) {
          (**(code **)(*piVar1 + 8))(piVar1);
          puVar6[0x12] = 0;
          FUN_00740690(1);
        }
        LVar4 = InterlockedExchangeAdd(puVar6 + 1,-1);
        if (LVar4 == 1) {
          (**(code **)*puVar6)(1);
        }
      }
    }
    local_8 = 0xffffffff;
    LeaveCriticalSection((LPCRITICAL_SECTION)(in_ECX + 0x184));
    FUN_00788460(1);
    ExceptionList = local_10;
    return (iVar3 == -0x7789f797) + '\x02';
  }
  ExceptionList = local_10;
  return '\0';
}



============================================================
DISASSEMBLY
============================================================
004835d0 : PUSH EBP
004835d1 : MOV EBP,ESP
004835d3 : PUSH -0x1
004835d5 : PUSH 0xb73ed8
004835da : MOV EAX,FS:[0x0]
004835e0 : PUSH EAX
004835e1 : SUB ESP,0x8
004835e4 : PUSH EBX
004835e5 : PUSH ESI
004835e6 : PUSH EDI
004835e7 : MOV EAX,[0x00d66fa0]
004835ec : XOR EAX,EBP
004835ee : PUSH EAX
004835ef : LEA EAX,[EBP + -0xc]
004835f2 : MOV FS:[0x0],EAX
004835f8 : MOV EBX,ECX
004835fa : CMP byte ptr [EBX + 0x8],0x0
004835fe : JNZ 0x00483617
00483600 : MOV EAX,0x1
00483605 : MOV ECX,dword ptr [EBP + -0xc]
00483608 : MOV dword ptr FS:[0x0],ECX
0048360f : POP ECX
00483610 : POP EDI
00483611 : POP ESI
00483612 : POP EBX
00483613 : MOV ESP,EBP
00483615 : POP EBP
00483616 : RET
00483617 : MOV EAX,dword ptr [EBX + 0xf0]
0048361d : MOV ECX,dword ptr [EAX]
0048361f : MOV EDX,dword ptr [ECX + 0xc]
00483622 : PUSH EAX
00483623 : CALL EDX
00483625 : XOR EDI,EDI
00483627 : MOV dword ptr [EBP + -0x14],EAX
0048362a : CMP EAX,EDI
0048362c : JNZ 0x00483642
0048362e : XOR EAX,EAX
00483630 : MOV ECX,dword ptr [EBP + -0xc]
00483633 : MOV dword ptr FS:[0x0],ECX
0048363a : POP ECX
0048363b : POP EDI
0048363c : POP ESI
0048363d : POP EBX
0048363e : MOV ESP,EBP
00483640 : POP EBP
00483641 : RET
00483642 : MOV EAX,dword ptr [EBX + 0xf0]
00483648 : MOV ECX,dword ptr [EAX]
0048364a : MOV EDX,dword ptr [ECX + 0x104]
00483650 : PUSH EDI
00483651 : PUSH EDI
00483652 : PUSH EAX
00483653 : CALL EDX
00483655 : LEA EAX,[EBX + 0x184]
0048365b : PUSH EAX
0048365c : MOV dword ptr [EBP + -0x10],EAX
0048365f : CALL dword ptr [0x00b85118]
00483665 : MOV dword ptr [EBP + -0x4],EDI
00483668 : MOV EAX,dword ptr [EBX + 0x180]
0048366e : CMP EAX,EDI
00483670 : JZ 0x00483675
00483672 : LEA EDI,[EAX + -0x8]
00483675 : TEST EDI,EDI
00483677 : JZ 0x0048367e
00483679 : LEA EAX,[EDI + 0x8]
0048367c : JMP 0x00483680
0048367e : XOR EAX,EAX
00483680 : LEA ECX,[EBX + 0x17c]
00483686 : CMP EAX,ECX
00483688 : JZ 0x004836df
0048368a : MOV EAX,dword ptr [EDI + 0xc]
0048368d : TEST EAX,EAX
0048368f : JZ 0x00483696
00483691 : LEA ESI,[EAX + -0x8]
00483694 : JMP 0x00483698
00483696 : XOR ESI,ESI
00483698 : MOV EAX,EDI
0048369a : CALL 0x00484090
0048369f : TEST AL,AL
004836a1 : JZ 0x004836db
004836a3 : MOV EAX,dword ptr [EDI + 0x48]
004836a6 : TEST EAX,EAX
004836a8 : JZ 0x004836c0
004836aa : MOV ECX,dword ptr [EAX]
004836ac : MOV EDX,dword ptr [ECX + 0x8]
004836af : PUSH EAX
004836b0 : CALL EDX
004836b2 : PUSH 0x1
004836b4 : MOV dword ptr [EDI + 0x48],0x0
004836bb : CALL 0x00740690
004836c0 : PUSH -0x1
004836c2 : LEA EAX,[EDI + 0x4]
004836c5 : PUSH EAX
004836c6 : CALL dword ptr [0x00b851cc]
004836cc : SUB EAX,0x1
004836cf : JNZ 0x004836db
004836d1 : MOV EDX,dword ptr [EDI]
004836d3 : MOV EAX,dword ptr [EDX]
004836d5 : PUSH 0x1
004836d7 : MOV ECX,EDI
004836d9 : CALL EAX
004836db : MOV EDI,ESI
004836dd : JMP 0x00483675
004836df : MOV dword ptr [EBP + -0x4],0xffffffff
004836e6 : MOV ECX,dword ptr [EBP + -0x10]
004836e9 : PUSH ECX
004836ea : CALL dword ptr [0x00b8511c]
004836f0 : PUSH 0x1
004836f2 : LEA ESI,[EBX + 0x19c]
004836f8 : CALL 0x00788460
004836fd : XOR EAX,EAX
004836ff : CMP dword ptr [EBP + -0x14],0x88760869
00483706 : SETZ AL
00483709 : ADD EAX,0x2
0048370c : MOV ECX,dword ptr [EBP + -0xc]
0048370f : MOV dword ptr FS:[0x0],ECX
00483716 : POP ECX
00483717 : POP EDI
00483718 : POP ESI
00483719 : POP EBX
0048371a : MOV ESP,EBP
0048371c : POP EBP
0048371d : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00aff6d0
ENTRY    : 00aff6d0
BODY     : [[00aff6d0, 00affb27] [00affb30, 00affc9d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00aff6d0(int param_1)

{
  WCHAR WVar1;
  undefined4 uVar2;
  ulonglong uVar3;
  size_t sVar4;
  int ctx;
  char cVar5;
  uint uVar6;
  int iVar7;
  uint8_t *puVar8;
  undefined4 uVar9;
  char *pcVar10;
  LPCWSTR pWVar11;
  int in_ECX;
  byte bVar12;
  LPCWSTR lpWideCharStr;
  int iVar13;
  int iVar14;
  size_t local_aac;
  uint8_t *local_aa8;
  int local_aa4;
  undefined **local_aa0;
  undefined1 local_a9c [1024];
  void *local_69c;
  undefined1 local_694 [4];
  undefined4 local_690;
  undefined4 local_680;
  uint local_67c;
  char local_678;
  undefined2 local_677;
  undefined2 local_675;
  undefined2 uStack_673;
  CHAR local_278 [256];
  undefined1 local_178 [256];
  uint8_t local_78 [13];
  undefined1 local_6b;
  undefined1 local_38 [16];
  undefined8 local_28;
  undefined8 local_20;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b6fe3f;
  local_10 = ExceptionList;
  uVar6 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_aa4 = param_1;
  local_18 = uVar6;
  if (*(char *)(in_ECX + 3) == '\x14') {
    _memset(&local_678,0,0x400);
    _memcpy(&local_678,(void *)(in_ECX + 5),(uint)*(byte *)(in_ECX + 4));
    (**(code **)(**(int **)(param_1 + 0x60) + 0x10))(CONCAT22(uStack_673,local_675),uVar6);
    (**(code **)(**(int **)(param_1 + 0x60) + 0x14))(CONCAT22(local_675,local_677));
    FUN_008018d0(L"[Clt] Connecting Login Server");
    if (*(int *)(DAT_00d7c550 + 0xd4) == 1) {
      local_aa0 = &PTR_FUN_00cdec98;
      _memset(local_a9c,0,0x400);
      local_69c = (void *)0x0;
      local_8 = 0;
      iVar7 = FUN_006ee890();
      ctx = local_aa4;
      iVar13 = 0;
      iVar14 = 0x11111111;
      if (iVar7 != 0) {
        iVar14 = *(int *)(iVar7 + 0x194);
        iVar13 = *(int *)(iVar7 + 0x198);
        if (iVar14 == 0 && iVar13 == 0) {
          iVar14 = 0x7087;
          iVar13 = 0;
        }
        if (iVar14 == 0 && iVar13 == 0) {
          iVar14 = 0x22222222;
          iVar13 = 0;
        }
        local_8 = local_8 & 0xffffff00;
        local_20 = CONCAT44(iVar7,&PTR_FUN_00cd083c);
      }
      iVar7 = *(int *)ThreadLocalStoragePointer;
      bVar12 = (byte)((ulonglong)(*(byte *)(iVar7 + 0x18) + 1) % 3);
      *(byte *)(iVar7 + 0x18) = bVar12;
      local_aa8 = (uint8_t *)((uint)bVar12 * 0x2000 + 0x122cb8 + iVar7);
      if (local_aa8 == (uint8_t *)0x0) {
        puVar8 = (uint8_t *)0x0;
      }
      else {
        local_aa8[0] = '\0';
        local_aa8[1] = '\0';
        local_aa8[2] = '\v';
        local_aa8[3] = '\x14';
        *(int *)(local_aa8 + 4) = iVar14;
        *(int *)(local_aa8 + 8) = iVar13;
        puVar8 = local_aa8;
      }
      local_8 = local_8 & 0xffffff00;
      FUN_00a0dd40(local_aa4,0xc,puVar8);
      if (*(char *)(DAT_017248c8 + 0x145) == '\x01') {
        local_20 = 0;
        cVar5 = FUN_004d65b0();
        if (cVar5 == '\0') {
          FUN_008018d0(L"Fail Connect Success \n");
          if (DAT_00d7c550 != 0) {
            FUN_00a560d0(DAT_00d7c550);
          }
        }
        else {
          FUN_008018d0(L"Send SPKUL_ACCOUNT_RQ_STEAM\n");
          local_aa8 = (uint8_t *)FUN_006f4590();
          local_8._0_1_ = 3;
          if (local_aa8 == (uint8_t *)0x0) {
            puVar8 = (uint8_t *)0x0;
          }
          else {
            puVar8 = (uint8_t *)FUN_00411e70(&local_678,local_aa4);
          }
          local_8 = (uint)local_8._1_3_ << 8;
          FUN_00a0dd40(ctx,0x410,puVar8);
        }
      }
      else {
        if (*(uint *)(DAT_00d7c550 + 0x10c) < 8) {
          iVar14 = DAT_00d7c550 + 0xf8;
        }
        else {
          iVar14 = *(int *)(DAT_00d7c550 + 0xf8);
        }
        if (*(uint *)(DAT_00d7c550 + 0xf0) < 8) {
          iVar13 = DAT_00d7c550 + 0xdc;
        }
        else {
          iVar13 = *(int *)(DAT_00d7c550 + 0xdc);
        }
        uVar9 = FUN_006ee3d0(iVar14);
        uVar9 = FUN_006ee3d0(iVar13,uVar9);
        FUN_00411b70(&DAT_00cb6038,uVar9);
        pcVar10 = &local_678;
        do {
          cVar5 = *pcVar10;
          pcVar10 = pcVar10 + 1;
        } while (cVar5 != '\0');
        local_aac = (int)pcVar10 - (int)&local_677;
        uVar9 = *(undefined4 *)(DAT_00d7c550 + 0xec);
        local_aa8 = *(uint8_t **)(DAT_00d7c550 + 0x108);
        (**(code **)(**(int **)(local_aa4 + 0x60) + 4))
                  (&local_678,local_aac,&local_678,&local_aac,0x400);
        sVar4 = local_aac;
        uVar2 = *(undefined4 *)(DAT_017248c8 + 0x150);
        bVar12 = (byte)((ulonglong)(*(byte *)(iVar7 + 0x18) + 1) % 3);
        *(byte *)(iVar7 + 0x18) = bVar12;
        puVar8 = (uint8_t *)((uint)bVar12 * 0x2000 + 0x122cb8 + iVar7);
        local_20 = CONCAT44(puVar8,(undefined4)local_20);
        if (puVar8 == (uint8_t *)0x0) {
          puVar8 = (uint8_t *)0x0;
        }
        else {
          puVar8[0] = '\0';
          puVar8[1] = '\0';
          puVar8[4] = (uint8_t)local_aac;
          puVar8[2] = '\v';
          puVar8[3] = '\x01';
          puVar8[5] = (uint8_t)uVar9;
          puVar8[6] = (uint8_t)local_aa8;
          puVar8[7] = (uint8_t)uVar2;
        }
        local_8 = local_8 & 0xffffff00;
        _memcpy(puVar8 + 8,&local_678,local_aac);
        iVar14 = FUN_00a0dd40(local_aa4,sVar4 + 8,puVar8);
        if (iVar14 != 0) {
          FUN_008018d0(L"Send SPKUL_ACCOUNT_RQ_IDPASS\n");
        }
      }
      local_8 = 0xffffffff;
      local_aa0 = &PTR_FUN_00cdec98;
      if (local_69c != (void *)0x0) {
        _free(local_69c);
      }
    }
    else {
      local_aa4 = 0x100;
      _memset(local_178,0,0x100);
      local_28 = 0;
      local_20 = 0;
      FUN_006eebe0(&local_aa4);
      FUN_00411140(local_38);
      FUN_004111f0(local_694);
      local_8 = 5;
      FUN_0070c170();
      iVar14 = 0;
      puVar8 = local_78;
      do {
        local_aa8 = puVar8;
        FUN_00422170(&DAT_00cb607c,*(undefined1 *)((int)&local_28 + iVar14));
        iVar14 = iVar14 + 1;
        puVar8 = puVar8 + 2;
      } while (iVar14 < 6);
      local_6b = 0;
      lpWideCharStr = local_690;
      if (local_67c < 8) {
        lpWideCharStr = (LPCWSTR)&local_690;
      }
      pWVar11 = lpWideCharStr;
      do {
        WVar1 = *pWVar11;
        pWVar11 = pWVar11 + 1;
      } while (WVar1 != L'\0');
      WideCharToMultiByte(0,0,lpWideCharStr,-1,local_278,
                          ((int)pWVar11 - (int)(lpWideCharStr + 1) >> 1) * 2 + 2,(LPCSTR)0x0,
                          (LPBOOL)0x0);
      iVar14 = *(int *)ThreadLocalStoragePointer;
      uVar3 = (ulonglong)(*(byte *)(iVar14 + 0x18) + 1) % 3;
      puVar8 = (uint8_t *)((int)uVar3 * 0x2000 + 0x122cb8 + iVar14);
      *(char *)(iVar14 + 0x18) = (char)uVar3;
      local_20 = CONCAT44(puVar8,(undefined4)local_20);
      local_8._0_1_ = 6;
      if (puVar8 == (uint8_t *)0x0) {
        puVar8 = (uint8_t *)0x0;
      }
      else {
        puVar8[0] = '\0';
        puVar8[1] = '\0';
        puVar8[2] = '\v';
        puVar8[3] = '\x04';
        _strncpy((char *)(puVar8 + 4),local_278,0x3f);
        puVar8[0x43] = '\0';
        _strncpy((char *)(puVar8 + 0x44),(char *)local_78,0xf);
        puVar8[0x53] = '\0';
      }
      local_8 = CONCAT31(local_8._1_3_,5);
      iVar14 = FUN_00a0dd40(param_1,0x54,puVar8);
      if (iVar14 != 0) {
        FUN_008018d0(L"Send SPKUL_ACCOUNT_RQ_PCAUTH: ComputerID %s, Mac %s\n",local_278,local_78);
      }
      local_8 = 0xffffffff;
      if (7 < local_67c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_67c = 7;
      local_680 = 0;
      local_690 = (LPCWSTR)((uint)local_690._2_2_ << 0x10);
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00aff6d0 : PUSH EBP
00aff6d1 : MOV EBP,ESP
00aff6d3 : PUSH -0x1
00aff6d5 : PUSH 0xb6fe3f
00aff6da : MOV EAX,FS:[0x0]
00aff6e0 : PUSH EAX
00aff6e1 : SUB ESP,0xaa0
00aff6e7 : MOV EAX,[0x00d66fa0]
00aff6ec : XOR EAX,EBP
00aff6ee : MOV dword ptr [EBP + -0x14],EAX
00aff6f1 : PUSH EBX
00aff6f2 : PUSH ESI
00aff6f3 : PUSH EDI
00aff6f4 : PUSH EAX
00aff6f5 : LEA EAX,[EBP + -0xc]
00aff6f8 : MOV FS:[0x0],EAX
00aff6fe : MOV EBX,dword ptr [EBP + 0x8]
00aff701 : MOV ESI,ECX
00aff703 : CMP byte ptr [ESI + 0x3],0x14
00aff707 : MOV dword ptr [EBP + 0xfffff560],EBX
00aff70d : JNZ 0x00affc7b
00aff713 : PUSH 0x400
00aff718 : XOR EDI,EDI
00aff71a : LEA EAX,[EBP + 0xfffff98c]
00aff720 : PUSH EDI
00aff721 : PUSH EAX
00aff722 : CALL 0x0063b700
00aff727 : MOVZX ECX,byte ptr [ESI + 0x4]
00aff72b : ADD ESP,0xc
00aff72e : PUSH ECX
00aff72f : ADD ESI,0x5
00aff732 : LEA EDX,[EBP + 0xfffff98c]
00aff738 : PUSH ESI
00aff739 : PUSH EDX
00aff73a : CALL 0x0063ae40
00aff73f : MOV ECX,dword ptr [EBX + 0x60]
00aff742 : MOV EAX,dword ptr [ECX]
00aff744 : MOV EDX,dword ptr [EBP + 0xfffff98f]
00aff74a : MOV EAX,dword ptr [EAX + 0x10]
00aff74d : ADD ESP,0xc
00aff750 : PUSH EDX
00aff751 : CALL EAX
00aff753 : MOV ECX,dword ptr [EBX + 0x60]
00aff756 : MOV EDX,dword ptr [ECX]
00aff758 : MOV EAX,dword ptr [EBP + 0xfffff98d]
00aff75e : MOV EDX,dword ptr [EDX + 0x14]
00aff761 : PUSH EAX
00aff762 : CALL EDX
00aff764 : MOV ESI,dword ptr [0x00da98e8]
00aff76a : PUSH 0xcb5f90
00aff76f : CALL 0x008018d0
00aff774 : MOV EAX,[0x00d7c550]
00aff779 : MOV EAX,dword ptr [EAX + 0xd4]
00aff77f : ADD ESP,0x4
00aff782 : CMP EAX,0x1
00aff785 : JNZ 0x00affaa0
00aff78b : PUSH 0x400
00aff790 : LEA ECX,[EBP + 0xfffff568]
00aff796 : PUSH EDI
00aff797 : PUSH ECX
00aff798 : MOV dword ptr [EBP + 0xfffff564],0xcdec98
00aff7a2 : CALL 0x0063b700
00aff7a7 : ADD ESP,0xc
00aff7aa : MOV dword ptr [EBP + 0xfffff968],EDI
00aff7b0 : MOV dword ptr [EBP + -0x4],EDI
00aff7b3 : LEA EDI,[EBP + 0xfffff564]
00aff7b9 : CALL 0x006ee890
00aff7be : XOR EBX,EBX
00aff7c0 : MOV EDI,0x11111111
00aff7c5 : TEST EAX,EAX
00aff7c7 : JZ 0x00aff807
00aff7c9 : MOV EDX,0xcd083c
00aff7ce : MOV dword ptr [EBP + -0x1c],EDX
00aff7d1 : MOV dword ptr [EBP + -0x18],EAX
00aff7d4 : MOV byte ptr [EBP + -0x4],0x1
00aff7d8 : MOV ECX,dword ptr [EAX + 0x194]
00aff7de : MOV EAX,dword ptr [EAX + 0x198]
00aff7e4 : MOV ESI,ECX
00aff7e6 : OR ESI,EAX
00aff7e8 : JNZ 0x00aff7f1
00aff7ea : MOV ECX,0x7087
00aff7ef : XOR EAX,EAX
00aff7f1 : MOV EDI,ECX
00aff7f3 : OR ECX,EAX
00aff7f5 : MOV EBX,EAX
00aff7f7 : JNZ 0x00aff800
00aff7f9 : MOV EDI,0x22222222
00aff7fe : XOR EBX,EBX
00aff800 : MOV byte ptr [EBP + -0x4],0x0
00aff804 : MOV dword ptr [EBP + -0x1c],EDX
00aff807 : MOV EDX,dword ptr FS:[0x2c]
00aff80e : MOV ESI,dword ptr [EDX]
00aff810 : MOVZX EAX,byte ptr [ESI + 0x18]
00aff814 : INC EAX
00aff815 : CDQ
00aff816 : MOV ECX,0x3
00aff81b : IDIV ECX
00aff81d : MOV byte ptr [ESI + 0x18],DL
00aff820 : MOVZX EDX,DL
00aff823 : SHL EDX,0xd
00aff826 : LEA EAX,[EDX + ESI*0x1 + 0x122cb8]
00aff82d : MOV dword ptr [EBP + 0xfffff55c],EAX
00aff833 : MOV byte ptr [EBP + -0x4],0x2
00aff837 : TEST EAX,EAX
00aff839 : JZ 0x00aff850
00aff83b : XOR ECX,ECX
00aff83d : MOV word ptr [EAX],CX
00aff840 : MOV byte ptr [EAX + 0x2],0xb
00aff844 : MOV byte ptr [EAX + 0x3],0x14
00aff848 : MOV dword ptr [EAX + 0x4],EDI
00aff84b : MOV dword ptr [EAX + 0x8],EBX
00aff84e : JMP 0x00aff852
00aff850 : XOR EAX,EAX
00aff852 : MOV byte ptr [EBP + -0x4],0x0
00aff856 : MOV EBX,dword ptr [EBP + 0xfffff560]
00aff85c : PUSH 0xc
00aff85e : PUSH EBX
00aff85f : MOV EDI,EAX
00aff861 : CALL 0x00a0dd40
00aff866 : MOV EDX,dword ptr [0x017248c8]
00aff86c : CMP byte ptr [EDX + 0x145],0x1
00aff873 : JNZ 0x00aff913
00aff879 : XOR EAX,EAX
00aff87b : MOV dword ptr [EBP + -0x1c],EAX
00aff87e : MOV dword ptr [EBP + -0x18],EAX
00aff881 : LEA ESI,[EBP + 0xfffff560]
00aff887 : LEA EAX,[EBP + 0xfffff98c]
00aff88d : LEA EDI,[EBP + -0x1c]
00aff890 : CALL 0x004d65b0
00aff895 : MOV ESI,dword ptr [0x00da98e8]
00aff89b : TEST AL,AL
00aff89d : JZ 0x00aff8ee
00aff89f : PUSH 0xcb5fcc
00aff8a4 : CALL 0x008018d0
00aff8a9 : ADD ESP,0x4
00aff8ac : CALL 0x006f4590
00aff8b1 : MOV dword ptr [EBP + 0xfffff55c],EAX
00aff8b7 : MOV byte ptr [EBP + -0x4],0x3
00aff8bb : TEST EAX,EAX
00aff8bd : JZ 0x00aff8d6
00aff8bf : MOV ECX,dword ptr [EBP + 0xfffff560]
00aff8c5 : PUSH ECX
00aff8c6 : LEA EDX,[EBP + 0xfffff98c]
00aff8cc : PUSH EDX
00aff8cd : MOV ECX,EDI
00aff8cf : CALL 0x00411e70
00aff8d4 : JMP 0x00aff8d8
00aff8d6 : XOR EAX,EAX
00aff8d8 : MOV byte ptr [EBP + -0x4],0x0
00aff8dc : PUSH 0x410
00aff8e1 : PUSH EBX
00aff8e2 : MOV EDI,EAX
00aff8e4 : CALL 0x00a0dd40
00aff8e9 : JMP 0x00affa73
00aff8ee : PUSH 0xcb6008
00aff8f3 : CALL 0x008018d0
00aff8f8 : MOV EAX,[0x00d7c550]
00aff8fd : ADD ESP,0x4
00aff900 : TEST EAX,EAX
00aff902 : JZ 0x00affa73
00aff908 : PUSH EAX
00aff909 : CALL 0x00a560d0
00aff90e : JMP 0x00affa73
00aff913 : MOV EAX,[0x00d7c550]
00aff918 : MOV EDX,0x8
00aff91d : CMP dword ptr [EAX + 0x10c],EDX
00aff923 : JC 0x00aff92d
00aff925 : MOV ECX,dword ptr [EAX + 0xf8]
00aff92b : JMP 0x00aff933
00aff92d : LEA ECX,[EAX + 0xf8]
00aff933 : CMP dword ptr [EAX + 0xf0],EDX
00aff939 : JC 0x00aff943
00aff93b : MOV EDI,dword ptr [EAX + 0xdc]
00aff941 : JMP 0x00aff949
00aff943 : LEA EDI,[EAX + 0xdc]
00aff949 : PUSH ECX
00aff94a : CALL 0x006ee3d0
00aff94f : ADD ESP,0x4
00aff952 : PUSH EAX
00aff953 : PUSH EDI
00aff954 : CALL 0x006ee3d0
00aff959 : ADD ESP,0x4
00aff95c : PUSH EAX
00aff95d : PUSH 0xcb6038
00aff962 : LEA EDX,[EBP + 0xfffff98c]
00aff968 : CALL 0x00411b70
00aff96d : LEA EAX,[EBP + 0xfffff98c]
00aff973 : ADD ESP,0xc
00aff976 : LEA ECX,[EAX + 0x1]
00aff979 : LEA ESP,[ESP]
00aff980 : MOV DL,byte ptr [EAX]
00aff982 : INC EAX
00aff983 : TEST DL,DL
00aff985 : JNZ 0x00aff980
00aff987 : MOV EDX,dword ptr [EBP + 0xfffff560]
00aff98d : SUB EAX,ECX
00aff98f : MOV ECX,dword ptr [0x00d7c550]
00aff995 : PUSH 0x400
00aff99a : MOV dword ptr [EBP + 0xfffff558],EAX
00aff9a0 : MOV EBX,dword ptr [ECX + 0xec]
00aff9a6 : MOV ECX,dword ptr [ECX + 0x108]
00aff9ac : LEA EDI,[EBP + 0xfffff558]
00aff9b2 : PUSH EDI
00aff9b3 : LEA EDI,[EBP + 0xfffff98c]
00aff9b9 : PUSH EDI
00aff9ba : MOV dword ptr [EBP + 0xfffff55c],ECX
00aff9c0 : MOV ECX,dword ptr [EDX + 0x60]
00aff9c3 : MOV EDX,dword ptr [ECX]
00aff9c5 : MOV EDX,dword ptr [EDX + 0x4]
00aff9c8 : PUSH EAX
00aff9c9 : MOV EAX,EDI
00aff9cb : PUSH EAX
00aff9cc : CALL EDX
00aff9ce : MOV EAX,[0x017248c8]
00aff9d3 : MOV ECX,dword ptr [EAX + 0x150]
00aff9d9 : MOVZX EAX,byte ptr [ESI + 0x18]
00aff9dd : INC EAX
00aff9de : CDQ
00aff9df : MOV EDI,0x3
00aff9e4 : IDIV EDI
00aff9e6 : MOV byte ptr [ESI + 0x18],DL
00aff9e9 : MOVZX EDX,DL
00aff9ec : SHL EDX,0xd
00aff9ef : LEA EAX,[EDX + ESI*0x1 + 0x122cb8]
00aff9f6 : MOV dword ptr [EBP + -0x18],EAX
00aff9f9 : MOV byte ptr [EBP + -0x4],0x4
00aff9fd : TEST EAX,EAX
00aff9ff : JZ 0x00affa2c
00affa01 : XOR EDX,EDX
00affa03 : MOV word ptr [EAX],DX
00affa06 : MOVZX EDX,byte ptr [EBP + 0xfffff558]
00affa0d : MOV byte ptr [EAX + 0x4],DL
00affa10 : MOVZX EDX,byte ptr [EBP + 0xfffff55c]
00affa17 : MOV byte ptr [EAX + 0x2],0xb
00affa1b : MOV byte ptr [EAX + 0x3],0x1
00affa1f : MOV byte ptr [EAX + 0x5],BL
00affa22 : MOV byte ptr [EAX + 0x6],DL
00affa25 : MOV byte ptr [EAX + 0x7],CL
00affa28 : MOV EDI,EAX
00affa2a : JMP 0x00affa2e
00affa2c : XOR EDI,EDI
00affa2e : MOV byte ptr [EBP + -0x4],0x0
00affa32 : MOV ESI,dword ptr [EBP + 0xfffff558]
00affa38 : PUSH ESI
00affa39 : LEA EAX,[EBP + 0xfffff98c]
00affa3f : PUSH EAX
00affa40 : LEA ECX,[EDI + 0x8]
00affa43 : PUSH ECX
00affa44 : CALL 0x0063ae40
00affa49 : MOV EDX,dword ptr [EBP + 0xfffff560]
00affa4f : ADD ESP,0xc
00affa52 : ADD ESI,0x8
00affa55 : PUSH ESI
00affa56 : PUSH EDX
00affa57 : CALL 0x00a0dd40
00affa5c : TEST EAX,EAX
00affa5e : JZ 0x00affa73
00affa60 : MOV ESI,dword ptr [0x00da98e8]
00affa66 : PUSH 0xcb6040
00affa6b : CALL 0x008018d0
00affa70 : ADD ESP,0x4
00affa73 : MOV dword ptr [EBP + -0x4],0xffffffff
00affa7a : MOV EAX,dword ptr [EBP + 0xfffff968]
00affa80 : MOV dword ptr [EBP + 0xfffff564],0xcdec98
00affa8a : TEST EAX,EAX
00affa8c : JZ 0x00affc7b
00affa92 : PUSH EAX
00affa93 : CALL 0x0063610d
00affa98 : ADD ESP,0x4
00affa9b : JMP 0x00affc7b
00affaa0 : PUSH 0x100
00affaa5 : LEA EAX,[EBP + 0xfffffe8c]
00affaab : PUSH EDI
00affaac : PUSH EAX
00affaad : MOV dword ptr [EBP + 0xfffff560],0x100
00affab7 : CALL 0x0063b700
00affabc : LEA ECX,[EBP + 0xfffff560]
00affac2 : ADD ESP,0xc
00affac5 : PXOR XMM0,XMM0
00affac9 : PUSH ECX
00affaca : LEA EDX,[EBP + -0x24]
00affacd : LEA ECX,[EBP + 0xfffffe8c]
00affad3 : MOVQ qword ptr [EBP + -0x24],XMM0
00affad8 : MOVQ qword ptr [EBP + -0x1c],XMM0
00affadd : CALL 0x006eebe0
00affae2 : MOV ECX,dword ptr [EBP + 0xfffff560]
00affae8 : LEA EDX,[EBP + -0x34]
00affaeb : ADD ESP,0x4
00affaee : PUSH EDX
00affaef : LEA EDX,[EBP + 0xfffffe8c]
00affaf5 : CALL 0x00411140
00affafa : LEA EAX,[EBP + 0xfffff970]
00affb00 : ADD ESP,0x4
00affb03 : PUSH EAX
00affb04 : LEA ECX,[EBP + -0x34]
00affb07 : CALL 0x004111f0
00affb0c : ADD ESP,0x4
00affb0f : MOV dword ptr [EBP + -0x4],0x5
00affb16 : LEA ECX,[EBP + 0xfffff970]
00affb1c : CALL 0x0070c170
00affb21 : XOR ESI,ESI
00affb23 : LEA EDI,[EBP + -0x74]
00affb26 : JMP 0x00affb30
00affb30 : MOVZX ECX,byte ptr [EBP + ESI*0x1 + -0x24]
00affb35 : PUSH ECX
00affb36 : PUSH 0xcb607c
00affb3b : LEA EAX,[EBP + 0xfffff55c]
00affb41 : MOV dword ptr [EBP + 0xfffff55c],EDI
00affb47 : CALL 0x00422170
00affb4c : INC ESI
00affb4d : ADD ESP,0x8
00affb50 : ADD EDI,0x2
00affb53 : CMP ESI,0x6
00affb56 : JL 0x00affb30
00affb58 : CMP dword ptr [EBP + 0xfffff988],0x8
00affb5f : MOV EDX,dword ptr [EBP + 0xfffff974]
00affb65 : MOV byte ptr [EBP + -0x67],0x0
00affb69 : JNC 0x00affb71
00affb6b : LEA EDX,[EBP + 0xfffff974]
00affb71 : MOV EAX,EDX
00affb73 : LEA ESI,[EAX + 0x2]
00affb76 : MOV CX,word ptr [EAX]
00affb79 : ADD EAX,0x2
00affb7c : TEST CX,CX
00affb7f : JNZ 0x00affb76
00affb81 : PUSH 0x0
00affb83 : SUB EAX,ESI
00affb85 : PUSH 0x0
00affb87 : SAR EAX,0x1
00affb89 : LEA EAX,[EAX + EAX*0x1 + 0x2]
00affb8d : PUSH EAX
00affb8e : LEA ECX,[EBP + 0xfffffd8c]
00affb94 : PUSH ECX
00affb95 : PUSH -0x1
00affb97 : PUSH EDX
00affb98 : PUSH 0x0
00affb9a : PUSH 0x0
00affb9c : CALL dword ptr [0x00b85130]
00affba2 : MOV EDX,dword ptr FS:[0x2c]
00affba9 : MOV ECX,dword ptr [EDX]
00affbab : MOVZX EAX,byte ptr [ECX + 0x18]
00affbaf : INC EAX
00affbb0 : CDQ
00affbb1 : MOV ESI,0x3
00affbb6 : IDIV ESI
00affbb8 : MOVZX EAX,DL
00affbbb : SHL EAX,0xd
00affbbe : LEA ESI,[EAX + ECX*0x1 + 0x122cb8]
00affbc5 : MOV byte ptr [ECX + 0x18],DL
00affbc8 : MOV dword ptr [EBP + -0x18],ESI
00affbcb : MOV byte ptr [EBP + -0x4],0x6
00affbcf : TEST ESI,ESI
00affbd1 : JZ 0x00affc11
00affbd3 : PUSH 0x3f
00affbd5 : LEA EDX,[EBP + 0xfffffd8c]
00affbdb : PUSH EDX
00affbdc : XOR ECX,ECX
00affbde : LEA EDI,[ESI + 0x4]
00affbe1 : PUSH EDI
00affbe2 : MOV word ptr [ESI],CX
00affbe5 : MOV byte ptr [ESI + 0x2],0xb
00affbe9 : MOV byte ptr [ESI + 0x3],0x4
00affbed : CALL 0x00636e50
00affbf2 : ADD ESP,0xc
00affbf5 : PUSH 0xf
00affbf7 : LEA EAX,[EBP + -0x74]
00affbfa : MOV byte ptr [EDI + 0x3f],0x0
00affbfe : PUSH EAX
00affbff : LEA EDI,[ESI + 0x44]
00affc02 : PUSH EDI
00affc03 : CALL 0x00636e50
00affc08 : ADD ESP,0xc
00affc0b : MOV byte ptr [EDI + 0xf],0x0
00affc0f : JMP 0x00affc13
00affc11 : XOR ESI,ESI
00affc13 : MOV byte ptr [EBP + -0x4],0x5
00affc17 : PUSH 0x54
00affc19 : PUSH EBX
00affc1a : MOV EDI,ESI
00affc1c : CALL 0x00a0dd40
00affc21 : TEST EAX,EAX
00affc23 : JZ 0x00affc43
00affc25 : MOV ESI,dword ptr [0x00da98e8]
00affc2b : LEA ECX,[EBP + -0x74]
00affc2e : PUSH ECX
00affc2f : LEA EDX,[EBP + 0xfffffd8c]
00affc35 : PUSH EDX
00affc36 : PUSH 0xcb6088
00affc3b : CALL 0x008018d0
00affc40 : ADD ESP,0xc
00affc43 : MOV dword ptr [EBP + -0x4],0xffffffff
00affc4a : CMP dword ptr [EBP + 0xfffff988],0x8
00affc51 : JC 0x00affc5e
00affc53 : MOV ECX,dword ptr [EBP + 0xfffff974]
00affc59 : CALL 0x006f04e0
00affc5e : XOR EAX,EAX
00affc60 : MOV dword ptr [EBP + 0xfffff988],0x7
00affc6a : MOV dword ptr [EBP + 0xfffff984],0x0
00affc74 : MOV word ptr [EBP + 0xfffff974],AX
00affc7b : MOV EAX,0x1
00affc80 : MOV ECX,dword ptr [EBP + -0xc]
00affc83 : MOV dword ptr FS:[0x0],ECX
00affc8a : POP ECX
00affc8b : POP EDI
00affc8c : POP ESI
00affc8d : POP EBX
00affc8e : MOV ECX,dword ptr [EBP + -0x14]
00affc91 : XOR ECX,EBP
00affc93 : CALL 0x00633e6b
00affc98 : MOV ESP,EBP
00affc9a : POP EBP
00affc9b : RET 0x4

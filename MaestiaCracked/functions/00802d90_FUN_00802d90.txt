PROGRAM  : Maestia.exe
FUNCTION : FUN_00802d90
ENTRY    : 00802d90
BODY     : [[00802d90, 00802f93]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x00802e1b) */

void FUN_00802d90(int param_1,uint param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  ushort *puVar3;
  ushort *puVar4;
  int iVar5;
  uint local_2c [2];
  LPCRITICAL_SECTION local_24;
  uint local_20;
  int local_1c;
  void *local_14;
  undefined1 *puStack_10;
  uint local_c;
  
  uVar1 = param_2;
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b3ccca;
  local_14 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xffffffc8;
  ExceptionList = &local_14;
  local_24 = (LPCRITICAL_SECTION)(param_1 + 0xb8);
  EnterCriticalSection(local_24);
  local_c = 0;
  if (uVar1 == 0) {
    iVar5 = *(int *)(param_1 + 0x58);
    if (iVar5 != *(int *)(param_1 + 0x5c)) {
      local_2c[0] = *(uint *)(param_3 + 0x14);
      local_20 = *(uint *)(param_3 + 0x18);
      do {
        if (local_20 < 8) {
          puVar3 = (ushort *)(param_3 + 4);
        }
        else {
          puVar3 = *(ushort **)(param_3 + 4);
        }
        uVar1 = *(uint *)(iVar5 + 0x14);
        uVar2 = uVar1;
        if (local_2c[0] <= uVar1) {
          uVar2 = local_2c[0];
        }
        if (*(uint *)(iVar5 + 0x18) < 8) {
          puVar4 = (ushort *)(iVar5 + 4);
        }
        else {
          puVar4 = *(ushort **)(iVar5 + 4);
        }
        for (; uVar2 != 0; uVar2 = uVar2 - 1) {
          if (*puVar4 != *puVar3) {
            uVar2 = (-(uint)(*puVar4 < *puVar3) & 0xfffffffe) + 1;
            if (uVar2 != 0) goto LAB_00802e5a;
            break;
          }
          puVar4 = puVar4 + 1;
          puVar3 = puVar3 + 1;
        }
        if (local_2c[0] <= uVar1) {
          uVar2 = (uint)(uVar1 != local_2c[0]);
LAB_00802e5a:
          if (uVar2 == 0) goto LAB_00802f79;
        }
        iVar5 = iVar5 + 0x1c;
      } while (iVar5 != *(int *)(param_1 + 0x5c));
    }
    FUN_00405ae0(param_3);
  }
  else {
    FUN_004437f0(&param_2);
    if (local_20 == *(uint *)(param_1 + 0x4c)) {
      local_1c = FUN_006f0760(0x10,"",0,(DAT_01725270 >> 3 & 1) == 0,uVar2);
      if (local_1c == 0) {
        local_1c = 0;
      }
      else {
        *(undefined4 *)(local_1c + 4) = 0;
        *(undefined4 *)(local_1c + 8) = 0;
        *(undefined4 *)(local_1c + 0xc) = 0;
      }
      local_c = local_c & 0xffffff00;
      local_20 = uVar1;
      FUN_00451e00(local_2c,&local_20);
    }
    FUN_00405ae0(param_3);
    *(undefined1 *)(param_1 + 0x94) = 0;
    FUN_00458b50(param_1 + 0x6c);
    local_20 = *(uint *)(param_1 + 0x70);
    FUN_004402f0();
    *(undefined4 *)(param_1 + 0x88) = 7;
    *(undefined4 *)(param_1 + 0x8c) = 8;
  }
LAB_00802f79:
  local_c = 0xffffffff;
  LeaveCriticalSection(local_24);
  ExceptionList = local_14;
  return;
}



============================================================
DISASSEMBLY
============================================================
00802d90 : PUSH EBP
00802d91 : MOV EBP,ESP
00802d93 : AND ESP,0xfffffff8
00802d96 : PUSH -0x1
00802d98 : PUSH 0xb3ccca
00802d9d : MOV EAX,FS:[0x0]
00802da3 : PUSH EAX
00802da4 : SUB ESP,0x18
00802da7 : PUSH EBX
00802da8 : PUSH ESI
00802da9 : PUSH EDI
00802daa : MOV EAX,[0x00d66fa0]
00802daf : XOR EAX,ESP
00802db1 : PUSH EAX
00802db2 : LEA EAX,[ESP + 0x28]
00802db6 : MOV FS:[0x0],EAX
00802dbc : MOV EBX,dword ptr [EBP + 0xc]
00802dbf : MOV ESI,dword ptr [EBP + 0x8]
00802dc2 : LEA EAX,[ESI + 0xb8]
00802dc8 : PUSH EAX
00802dc9 : MOV dword ptr [ESP + 0x1c],EAX
00802dcd : CALL dword ptr [0x00b85118]
00802dd3 : MOV dword ptr [ESP + 0x30],0x0
00802ddb : TEST EBX,EBX
00802ddd : JNZ 0x00802ea4
00802de3 : MOV EBX,dword ptr [ESI + 0x58]
00802de6 : CMP EBX,dword ptr [ESI + 0x5c]
00802de9 : JZ 0x00802e6b
00802def : MOV EAX,dword ptr [EBP + 0x10]
00802df2 : MOV ESI,dword ptr [EAX + 0x14]
00802df5 : MOV ECX,dword ptr [EAX + 0x18]
00802df8 : MOV dword ptr [ESP + 0x10],ESI
00802dfc : MOV dword ptr [ESP + 0x1c],ECX
00802e00 : JMP 0x00802e05
00802e02 : MOV EAX,dword ptr [EBP + 0x10]
00802e05 : CMP dword ptr [ESP + 0x1c],0x8
00802e0a : JC 0x00802e11
00802e0c : MOV EAX,dword ptr [EAX + 0x4]
00802e0f : JMP 0x00802e14
00802e11 : ADD EAX,0x4
00802e14 : MOV EDI,dword ptr [EBX + 0x14]
00802e17 : MOV ECX,EDI
00802e19 : CMP ECX,EDI
00802e1b : CMOVC EDI,ECX
00802e1e : MOV EDX,EDI
00802e20 : CMP EDI,ESI
00802e22 : JC 0x00802e26
00802e24 : MOV EDX,ESI
00802e26 : CMP dword ptr [EBX + 0x18],0x8
00802e2a : JC 0x00802e31
00802e2c : MOV ECX,dword ptr [EBX + 0x4]
00802e2f : JMP 0x00802e34
00802e31 : LEA ECX,[EBX + 0x4]
00802e34 : TEST EDX,EDX
00802e36 : JBE 0x00802e4f
00802e38 : MOV SI,word ptr [ECX]
00802e3b : CMP SI,word ptr [EAX]
00802e3e : JNZ 0x00802e7c
00802e40 : ADD ECX,0x2
00802e43 : ADD EAX,0x2
00802e46 : SUB EDX,0x1
00802e49 : JNZ 0x00802e38
00802e4b : MOV ESI,dword ptr [ESP + 0x10]
00802e4f : CMP EDI,ESI
00802e51 : JC 0x00802e5e
00802e53 : XOR EAX,EAX
00802e55 : CMP EDI,ESI
00802e57 : SETNZ AL
00802e5a : TEST EAX,EAX
00802e5c : JZ 0x00802e92
00802e5e : MOV EAX,dword ptr [EBP + 0x8]
00802e61 : ADD EBX,0x1c
00802e64 : CMP EBX,dword ptr [EAX + 0x5c]
00802e67 : JNZ 0x00802e02
00802e69 : MOV ESI,EAX
00802e6b : MOV EDX,dword ptr [EBP + 0x10]
00802e6e : PUSH EDX
00802e6f : LEA EAX,[ESI + 0x54]
00802e72 : CALL 0x00405ae0
00802e77 : JMP 0x00802f6c
00802e7c : MOV DX,SI
00802e7f : CMP DX,word ptr [EAX]
00802e82 : SBB EAX,EAX
00802e84 : AND EAX,0xfffffffe
00802e87 : ADD EAX,0x1
00802e8a : JZ 0x00802e4b
00802e8c : MOV ESI,dword ptr [ESP + 0x10]
00802e90 : JMP 0x00802e5a
00802e92 : MOV dword ptr [ESP + 0x30],0xffffffff
00802e9a : MOV ECX,dword ptr [ESP + 0x18]
00802e9e : PUSH ECX
00802e9f : JMP 0x00802f79
00802ea4 : LEA EAX,[EBP + 0xc]
00802ea7 : LEA EDI,[ESI + 0x48]
00802eaa : PUSH EAX
00802eab : LEA EAX,[ESP + 0x20]
00802eaf : MOV ECX,EDI
00802eb1 : CALL 0x004437f0
00802eb6 : MOV EAX,dword ptr [ESI + 0x4c]
00802eb9 : MOV ECX,dword ptr [ESP + 0x1c]
00802ebd : CMP ECX,EAX
00802ebf : JNZ 0x00802f24
00802ec1 : MOV ECX,dword ptr [0x01725270]
00802ec7 : SHR ECX,0x3
00802eca : MOV EDX,0x0
00802ecf : AND ECX,0x1
00802ed2 : SETZ DL
00802ed5 : XOR ESI,ESI
00802ed7 : PUSH EDX
00802ed8 : PUSH ESI
00802ed9 : PUSH 0xbf1a4a
00802ede : PUSH 0x10
00802ee0 : CALL 0x006f0760
00802ee5 : ADD ESP,0x10
00802ee8 : MOV dword ptr [ESP + 0x1c],EAX
00802eec : MOV byte ptr [ESP + 0x30],0x1
00802ef1 : CMP EAX,ESI
00802ef3 : JZ 0x00802f00
00802ef5 : MOV dword ptr [EAX + 0x4],ESI
00802ef8 : MOV dword ptr [EAX + 0x8],ESI
00802efb : MOV dword ptr [EAX + 0xc],ESI
00802efe : JMP 0x00802f02
00802f00 : XOR EAX,EAX
00802f02 : MOV byte ptr [ESP + 0x30],0x0
00802f07 : MOV ESI,EAX
00802f09 : MOV dword ptr [ESP + 0x20],EAX
00802f0d : LEA EAX,[ESP + 0x1c]
00802f11 : PUSH EAX
00802f12 : LEA ECX,[ESP + 0x14]
00802f16 : PUSH ECX
00802f17 : MOV EAX,EDI
00802f19 : MOV dword ptr [ESP + 0x24],EBX
00802f1d : CALL 0x00451e00
00802f22 : JMP 0x00802f27
00802f24 : MOV ESI,dword ptr [ECX + 0x10]
00802f27 : MOV EDX,dword ptr [EBP + 0x10]
00802f2a : PUSH EDX
00802f2b : MOV EAX,ESI
00802f2d : CALL 0x00405ae0
00802f32 : MOV EDI,dword ptr [EBP + 0x8]
00802f35 : LEA EAX,[EDI + 0x6c]
00802f38 : PUSH EAX
00802f39 : MOV byte ptr [EDI + 0x94],0x0
00802f40 : CALL 0x00458b50
00802f45 : MOV ECX,dword ptr [EDI + 0x70]
00802f48 : LEA ESI,[EDI + 0x78]
00802f4b : LEA EAX,[ESP + 0x1c]
00802f4f : MOV dword ptr [ESP + 0x1c],ECX
00802f53 : CALL 0x004402f0
00802f58 : MOV dword ptr [EDI + 0x88],0x7
00802f62 : MOV dword ptr [EDI + 0x8c],0x8
00802f6c : MOV dword ptr [ESP + 0x30],0xffffffff
00802f74 : MOV EDX,dword ptr [ESP + 0x18]
00802f78 : PUSH EDX
00802f79 : CALL dword ptr [0x00b8511c]
00802f7f : MOV ECX,dword ptr [ESP + 0x28]
00802f83 : MOV dword ptr FS:[0x0],ECX
00802f8a : POP ECX
00802f8b : POP EDI
00802f8c : POP ESI
00802f8d : POP EBX
00802f8e : MOV ESP,EBP
00802f90 : POP EBP
00802f91 : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_0061d820
ENTRY    : 0061d820
BODY     : [[0061d820, 0061d869] [0061d870, 0061daca] [0061dad0, 0061dc4a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0061d820(int *param_1,undefined4 param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  size_t _NumOfElements;
  int local_10;
  int local_c;
  int local_8;
  code *local_4;
  
  iVar1 = param_1[0x24];
  iVar4 = 0;
  *(undefined4 *)(iVar1 + 0x18) = 0;
  iVar3 = *param_1;
  _NumOfElements = 0;
  local_8 = 0;
  local_c = 0;
  local_4 = (code *)0x0;
  if ((*(byte *)(param_1 + 3) & 1) == 0) {
    if (iVar3 != 0) {
      *(undefined4 *)(iVar3 + 300) = *(undefined4 *)(iVar3 + 0x124);
    }
    while ((iVar3 = *param_1, iVar3 != 0 && (*(int *)(iVar3 + 300) != 0))) {
      local_10 = *(int *)(*(int *)(iVar3 + 300) + 0x130);
      if (local_10 == 0) goto LAB_0061d99d;
      *(undefined4 *)(iVar3 + 300) = **(undefined4 **)(iVar3 + 300);
      if ((*(byte *)(local_10 + 0x100) & 2) != 0) {
        *(int *)(*(int *)(iVar1 + 0x14) + _NumOfElements * 4) = local_10;
        _NumOfElements = _NumOfElements + 1;
      }
    }
    local_10 = 0;
  }
  else {
    if (iVar3 != 0) {
      *(undefined4 *)(iVar3 + 300) = *(undefined4 *)(iVar3 + 0x124);
    }
    while ((iVar3 = *param_1, iVar3 != 0 && (*(int *)(iVar3 + 300) != 0))) {
      local_10 = *(int *)(*(int *)(iVar3 + 300) + 0x130);
      if (local_10 == 0) goto LAB_0061d914;
      *(undefined4 *)(iVar3 + 300) = **(undefined4 **)(iVar3 + 300);
      if ((*(byte *)(local_10 + 0x100) & 2) != 0) {
        if ((*(byte *)(param_1 + 3) & 2) != 0) {
          *(float *)(local_10 + 700) =
               *(float *)(local_10 + 0x14c) * (float)param_1[0x16] +
               *(float *)(local_10 + 0x148) * (float)param_1[0x12] +
               *(float *)(local_10 + 0x144) * (float)param_1[0xe] +
               (float)param_1[10] * *(float *)(local_10 + 0x140);
        }
        *(int *)(*(int *)(iVar1 + 0x14) + _NumOfElements * 4) = local_10;
        _NumOfElements = _NumOfElements + 1;
      }
    }
    local_10 = 0;
LAB_0061d914:
    if ((*(byte *)(param_1 + 3) & 4) == 0) {
      _qsort(*(void **)(iVar1 + 0x14),_NumOfElements,4,(_PtFuncCompare *)&LAB_0061c5f0);
    }
    else {
      _qsort(*(void **)(iVar1 + 0x14),_NumOfElements,4,(_PtFuncCompare *)&LAB_0061c5b0);
    }
  }
LAB_0061d99d:
  if (param_1[0x19] != 0) {
    param_1[0x1e] = param_1[param_1[0x20] + 0x1a];
    local_8 = param_1[0x1e];
    param_1[0x1e] = local_8 + 0x20;
    param_1[0x20] = (param_1[0x20] + 1) % param_1[0x1f];
  }
  if (0 < (int)_NumOfElements) {
    do {
      local_10 = *(int *)(*(int *)(iVar1 + 0x14) + iVar4 * 4);
      FUN_0061d4c0(local_10);
      if (((*(byte *)(local_10 + 0x100) & 0x40) == 0) || (*(float *)(local_10 + 0x304) <= 0.0)) {
        if (*(int *)(local_10 + 0x270) != 0) {
          (**(code **)(local_10 + 0x270))(local_10,*(undefined4 *)(local_10 + 0x26c));
        }
        if (((*(byte *)(local_10 + 0x100) & 0x10) != 0) &&
           (*(int *)(*(int *)(local_10 + 0x104) + 0x120) == 0)) {
          FUN_00611d80(param_1,local_10);
          FUN_00611c30(&local_10);
        }
        local_c = local_c + 1;
      }
      iVar4 = iVar4 + 1;
    } while (iVar4 < (int)_NumOfElements);
  }
  if (param_1[0x19] != 0) {
    *(int *)(local_8 + 8) = local_c;
  }
  if ((param_1[3] & 0x10U) != 0) {
    iVar3 = 0;
    if ((param_1[3] & 4U) == 0) {
      _qsort(*(void **)(iVar1 + 0x1c),*(size_t *)(iVar1 + 0x18),4,(_PtFuncCompare *)&LAB_0061c670);
    }
    else {
      _qsort(*(void **)(iVar1 + 0x1c),*(size_t *)(iVar1 + 0x18),4,(_PtFuncCompare *)&LAB_0061c630);
    }
    iVar4 = 0;
    if (0 < *(int *)(iVar1 + 0x18)) {
      do {
        iVar2 = *(int *)(*(int *)(iVar1 + 0x1c) + iVar4 * 4);
        local_10 = *(int *)(iVar2 + 0x7c);
        *(undefined4 *)(iVar2 + 0x2c) = 0;
        if ((local_10 != iVar3) && (iVar3 = local_10, *(int *)(local_10 + 0x2b8) != 0)) {
          local_4 = *(code **)(local_10 + 0x2b8);
          (*local_4)(local_10,0);
        }
        if ((*(int *)(local_10 + 0x290) == 0) || ((*(byte *)(local_10 + 0x100) & 4) == 0)) {
          if ((*(int *)(local_10 + 0x280) != 0) && ((*(byte *)(local_10 + 0x100) & 4) != 0)) {
            (**(code **)(local_10 + 0x280))(local_10,iVar2);
          }
        }
        else {
          (**(code **)(local_10 + 0x290))(local_10,iVar2);
        }
        iVar4 = iVar4 + 1;
      } while (iVar4 < *(int *)(iVar1 + 0x18));
      if (local_4 != (code *)0x0) {
        (*local_4)(local_10,1);
      }
    }
    iVar1 = *param_1;
    if (iVar1 != 0) {
      *(undefined4 *)(iVar1 + 300) = *(undefined4 *)(iVar1 + 0x124);
    }
    while ((iVar1 = *param_1, iVar1 != 0 && (*(int *)(iVar1 + 300) != 0))) {
      local_10 = *(int *)(*(int *)(iVar1 + 300) + 0x130);
      if (local_10 == 0) goto LAB_0061dbee;
      *(undefined4 *)(iVar1 + 300) = **(undefined4 **)(iVar1 + 300);
      if ((((*(uint *)(local_10 + 0x100) & 2) != 0) && ((*(uint *)(local_10 + 0x100) & 0x10) != 0))
         && (*(int *)(*(int *)(local_10 + 0x104) + 0x120) == 0)) {
        FUN_00611d80(param_1,local_10);
        FUN_00611c30(&local_10);
      }
    }
    local_10 = 0;
  }
LAB_0061dbee:
  iVar1 = param_1[0x25];
  if (iVar1 != 0) {
    *(undefined4 *)(iVar1 + 300) = *(undefined4 *)(iVar1 + 0x124);
  }
  while (((iVar1 = param_1[0x25], iVar1 != 0 && (*(int *)(iVar1 + 300) != 0)) &&
         (iVar3 = *(int *)(*(int *)(iVar1 + 300) + 0x130), iVar3 != 0))) {
    *(undefined4 *)(iVar1 + 300) = **(undefined4 **)(iVar1 + 300);
    FUN_00616b30(iVar3,param_2);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
0061d820 : SUB ESP,0x10
0061d823 : PUSH EBP
0061d824 : MOV EBP,dword ptr [ESP + 0x18]
0061d828 : MOV EDX,dword ptr [EBP + 0x90]
0061d82e : PUSH ESI
0061d82f : XOR ESI,ESI
0061d831 : PUSH EDI
0061d832 : MOV dword ptr [ESP + 0xc],ESI
0061d836 : MOV dword ptr [EDX + 0x18],ESI
0061d839 : MOV EAX,dword ptr [EBP]
0061d83c : XOR EDI,EDI
0061d83e : TEST byte ptr [EBP + 0xc],0x1
0061d842 : MOV dword ptr [ESP + 0x20],EDX
0061d846 : MOV dword ptr [ESP + 0x14],ESI
0061d84a : MOV dword ptr [ESP + 0x10],ESI
0061d84e : MOV dword ptr [ESP + 0x18],ESI
0061d852 : JZ 0x0061d946
0061d858 : CMP EAX,ESI
0061d85a : JZ 0x0061d870
0061d85c : MOV ECX,dword ptr [EAX + 0x124]
0061d862 : MOV dword ptr [EAX + 0x12c],ECX
0061d868 : JMP 0x0061d870
0061d870 : MOV EAX,dword ptr [EBP]
0061d873 : CMP EAX,ESI
0061d875 : JZ 0x0061d910
0061d87b : MOV ECX,dword ptr [EAX + 0x12c]
0061d881 : CMP ECX,ESI
0061d883 : JZ 0x0061d910
0061d889 : MOV ECX,dword ptr [ECX + 0x130]
0061d88f : MOV dword ptr [ESP + 0xc],ECX
0061d893 : CMP ECX,ESI
0061d895 : JZ 0x0061d914
0061d897 : MOV ECX,dword ptr [EAX + 0x12c]
0061d89d : MOV ECX,dword ptr [ECX]
0061d89f : MOV dword ptr [EAX + 0x12c],ECX
0061d8a5 : MOV EAX,dword ptr [ESP + 0xc]
0061d8a9 : TEST byte ptr [EAX + 0x100],0x2
0061d8b0 : JZ 0x0061d870
0061d8b2 : TEST byte ptr [EBP + 0xc],0x2
0061d8b6 : JZ 0x0061d904
0061d8b8 : MOVSS XMM0,dword ptr [EAX + 0x14c]
0061d8c0 : MULSS XMM0,dword ptr [EBP + 0x58]
0061d8c5 : MOVSS XMM1,dword ptr [EAX + 0x148]
0061d8cd : MULSS XMM1,dword ptr [EBP + 0x48]
0061d8d2 : ADDSS XMM0,XMM1
0061d8d6 : MOVSS XMM1,dword ptr [EAX + 0x144]
0061d8de : MULSS XMM1,dword ptr [EBP + 0x38]
0061d8e3 : ADDSS XMM0,XMM1
0061d8e7 : MOVSS XMM1,dword ptr [EBP + 0x28]
0061d8ec : MULSS XMM1,dword ptr [EAX + 0x140]
0061d8f4 : ADDSS XMM0,XMM1
0061d8f8 : MOVSS dword ptr [EAX + 0x2bc],XMM0
0061d900 : MOV EAX,dword ptr [ESP + 0xc]
0061d904 : MOV ECX,dword ptr [EDX + 0x14]
0061d907 : MOV dword ptr [ECX + EDI*0x4],EAX
0061d90a : INC EDI
0061d90b : JMP 0x0061d870
0061d910 : MOV dword ptr [ESP + 0xc],ESI
0061d914 : TEST byte ptr [EBP + 0xc],0x4
0061d918 : JZ 0x0061d930
0061d91a : MOV EDX,dword ptr [EDX + 0x14]
0061d91d : PUSH 0x61c5b0
0061d922 : PUSH 0x4
0061d924 : PUSH EDI
0061d925 : PUSH EDX
0061d926 : CALL 0x00635ad0
0061d92b : ADD ESP,0x10
0061d92e : JMP 0x0061d99d
0061d930 : MOV EAX,dword ptr [EDX + 0x14]
0061d933 : PUSH 0x61c5f0
0061d938 : PUSH 0x4
0061d93a : PUSH EDI
0061d93b : PUSH EAX
0061d93c : CALL 0x00635ad0
0061d941 : ADD ESP,0x10
0061d944 : JMP 0x0061d99d
0061d946 : CMP EAX,ESI
0061d948 : JZ 0x0061d956
0061d94a : MOV ECX,dword ptr [EAX + 0x124]
0061d950 : MOV dword ptr [EAX + 0x12c],ECX
0061d956 : MOV EAX,dword ptr [EBP]
0061d959 : CMP EAX,ESI
0061d95b : JZ 0x0061d999
0061d95d : MOV ECX,dword ptr [EAX + 0x12c]
0061d963 : CMP ECX,ESI
0061d965 : JZ 0x0061d999
0061d967 : MOV ECX,dword ptr [ECX + 0x130]
0061d96d : MOV dword ptr [ESP + 0xc],ECX
0061d971 : CMP ECX,ESI
0061d973 : JZ 0x0061d99d
0061d975 : MOV ECX,dword ptr [EAX + 0x12c]
0061d97b : MOV ECX,dword ptr [ECX]
0061d97d : MOV dword ptr [EAX + 0x12c],ECX
0061d983 : MOV EAX,dword ptr [ESP + 0xc]
0061d987 : TEST byte ptr [EAX + 0x100],0x2
0061d98e : JZ 0x0061d956
0061d990 : MOV ECX,dword ptr [EDX + 0x14]
0061d993 : MOV dword ptr [ECX + EDI*0x4],EAX
0061d996 : INC EDI
0061d997 : JMP 0x0061d956
0061d999 : MOV dword ptr [ESP + 0xc],ESI
0061d99d : CMP dword ptr [EBP + 0x64],ESI
0061d9a0 : JZ 0x0061d9c7
0061d9a2 : MOV EAX,dword ptr [EBP + 0x80]
0061d9a8 : MOV EDX,dword ptr [EBP + EAX*0x4 + 0x68]
0061d9ac : INC EAX
0061d9ad : MOV dword ptr [EBP + 0x78],EDX
0061d9b0 : CDQ
0061d9b1 : IDIV dword ptr [EBP + 0x7c]
0061d9b4 : MOV EAX,dword ptr [EBP + 0x78]
0061d9b7 : MOV dword ptr [ESP + 0x14],EAX
0061d9bb : ADD EAX,0x20
0061d9be : MOV dword ptr [EBP + 0x78],EAX
0061d9c1 : MOV dword ptr [EBP + 0x80],EDX
0061d9c7 : CMP EDI,ESI
0061d9c9 : PUSH EBX
0061d9ca : JLE 0x0061da64
0061d9d0 : MOV BL,0x40
0061d9d2 : MOV EAX,dword ptr [ESP + 0x24]
0061d9d6 : MOV ECX,dword ptr [EAX + 0x14]
0061d9d9 : MOV EAX,dword ptr [ECX + ESI*0x4]
0061d9dc : PUSH EAX
0061d9dd : MOV dword ptr [ESP + 0x14],EAX
0061d9e1 : CALL 0x0061d4c0
0061d9e6 : MOV EAX,dword ptr [ESP + 0x14]
0061d9ea : ADD ESP,0x4
0061d9ed : TEST byte ptr [EAX + 0x100],BL
0061d9f3 : JZ 0x0061da06
0061d9f5 : MOVSS XMM0,dword ptr [EAX + 0x304]
0061d9fd : COMISS XMM0,dword ptr [0x00b9b0b4]
0061da04 : JA 0x0061da59
0061da06 : CMP dword ptr [EAX + 0x270],0x0
0061da0d : JZ 0x0061da29
0061da0f : FLD float ptr [EAX + 0x26c]
0061da15 : MOV EDX,dword ptr [EAX + 0x270]
0061da1b : PUSH ECX
0061da1c : FSTP float ptr [ESP]
0061da1f : PUSH EAX
0061da20 : CALL EDX
0061da22 : MOV EAX,dword ptr [ESP + 0x18]
0061da26 : ADD ESP,0x8
0061da29 : TEST byte ptr [EAX + 0x100],0x10
0061da30 : JZ 0x0061da55
0061da32 : MOV ECX,dword ptr [EAX + 0x104]
0061da38 : CMP dword ptr [ECX + 0x120],0x0
0061da3f : JNZ 0x0061da55
0061da41 : PUSH EAX
0061da42 : PUSH EBP
0061da43 : CALL 0x00611d80
0061da48 : LEA EDX,[ESP + 0x18]
0061da4c : PUSH EDX
0061da4d : CALL 0x00611c30
0061da52 : ADD ESP,0xc
0061da55 : INC dword ptr [ESP + 0x14]
0061da59 : INC ESI
0061da5a : CMP ESI,EDI
0061da5c : JL 0x0061d9d2
0061da62 : XOR ESI,ESI
0061da64 : CMP dword ptr [EBP + 0x64],ESI
0061da67 : JZ 0x0061da74
0061da69 : MOV EAX,dword ptr [ESP + 0x14]
0061da6d : MOV ECX,dword ptr [ESP + 0x18]
0061da71 : MOV dword ptr [ECX + 0x8],EAX
0061da74 : MOV EAX,dword ptr [EBP + 0xc]
0061da77 : TEST AL,0x10
0061da79 : JZ 0x0061dbee
0061da7f : XOR EBX,EBX
0061da81 : TEST AL,0x4
0061da83 : JZ 0x0061da9f
0061da85 : MOV ESI,dword ptr [ESP + 0x24]
0061da89 : MOV EDX,dword ptr [ESI + 0x18]
0061da8c : MOV EAX,dword ptr [ESI + 0x1c]
0061da8f : PUSH 0x61c630
0061da94 : PUSH 0x4
0061da96 : PUSH EDX
0061da97 : PUSH EAX
0061da98 : CALL 0x00635ad0
0061da9d : JMP 0x0061dabb
0061da9f : MOV EAX,dword ptr [ESP + 0x24]
0061daa3 : MOV ECX,dword ptr [EAX + 0x18]
0061daa6 : MOV EDX,dword ptr [EAX + 0x1c]
0061daa9 : PUSH 0x61c670
0061daae : PUSH 0x4
0061dab0 : PUSH ECX
0061dab1 : PUSH EDX
0061dab2 : CALL 0x00635ad0
0061dab7 : MOV ESI,dword ptr [ESP + 0x34]
0061dabb : XOR EDI,EDI
0061dabd : ADD ESP,0x10
0061dac0 : CMP dword ptr [ESI + 0x18],EDI
0061dac3 : JLE 0x0061db6b
0061dac9 : JMP 0x0061dad2
0061dad0 : MOV ESI,ECX
0061dad2 : MOV EAX,dword ptr [ESI + 0x1c]
0061dad5 : MOV ESI,dword ptr [EAX + EDI*0x4]
0061dad8 : MOV EAX,dword ptr [ESI + 0x7c]
0061dadb : XORPS XMM0,XMM0
0061dade : MOVSS dword ptr [ESI + 0x2c],XMM0
0061dae3 : MOV dword ptr [ESP + 0x10],EAX
0061dae7 : CMP EAX,EBX
0061dae9 : JZ 0x0061db0c
0061daeb : CMP dword ptr [EAX + 0x2b8],0x0
0061daf2 : MOV EBX,EAX
0061daf4 : JZ 0x0061db0c
0061daf6 : MOV ECX,dword ptr [EAX + 0x2b8]
0061dafc : PUSH 0x0
0061dafe : PUSH EAX
0061daff : MOV dword ptr [ESP + 0x24],ECX
0061db03 : CALL ECX
0061db05 : MOV EAX,dword ptr [ESP + 0x18]
0061db09 : ADD ESP,0x8
0061db0c : CMP dword ptr [EAX + 0x290],0x0
0061db13 : JZ 0x0061db2a
0061db15 : TEST byte ptr [EAX + 0x100],0x4
0061db1c : JZ 0x0061db2a
0061db1e : MOV ECX,dword ptr [EAX + 0x290]
0061db24 : PUSH ESI
0061db25 : PUSH EAX
0061db26 : CALL ECX
0061db28 : JMP 0x0061db46
0061db2a : CMP dword ptr [EAX + 0x280],0x0
0061db31 : JZ 0x0061db4d
0061db33 : TEST byte ptr [EAX + 0x100],0x4
0061db3a : JZ 0x0061db4d
0061db3c : MOV EDX,dword ptr [EAX + 0x280]
0061db42 : PUSH ESI
0061db43 : PUSH EAX
0061db44 : CALL EDX
0061db46 : MOV EAX,dword ptr [ESP + 0x18]
0061db4a : ADD ESP,0x8
0061db4d : MOV ECX,dword ptr [ESP + 0x24]
0061db51 : INC EDI
0061db52 : CMP EDI,dword ptr [ECX + 0x18]
0061db55 : JL 0x0061dad0
0061db5b : MOV ECX,dword ptr [ESP + 0x1c]
0061db5f : TEST ECX,ECX
0061db61 : JZ 0x0061db6b
0061db63 : PUSH 0x1
0061db65 : PUSH EAX
0061db66 : CALL ECX
0061db68 : ADD ESP,0x8
0061db6b : MOV EAX,dword ptr [EBP]
0061db6e : TEST EAX,EAX
0061db70 : JZ 0x0061db80
0061db72 : MOV EDX,dword ptr [EAX + 0x124]
0061db78 : MOV dword ptr [EAX + 0x12c],EDX
0061db7e : MOV EDI,EDI
0061db80 : MOV EAX,dword ptr [EBP]
0061db83 : TEST EAX,EAX
0061db85 : JZ 0x0061dbe4
0061db87 : MOV ECX,dword ptr [EAX + 0x12c]
0061db8d : TEST ECX,ECX
0061db8f : JZ 0x0061dbe4
0061db91 : MOV ECX,dword ptr [ECX + 0x130]
0061db97 : MOV dword ptr [ESP + 0x10],ECX
0061db9b : TEST ECX,ECX
0061db9d : JZ 0x0061dbec
0061db9f : MOV ECX,dword ptr [EAX + 0x12c]
0061dba5 : MOV EDX,dword ptr [ECX]
0061dba7 : MOV dword ptr [EAX + 0x12c],EDX
0061dbad : MOV ECX,dword ptr [ESP + 0x10]
0061dbb1 : MOV EAX,dword ptr [ECX + 0x100]
0061dbb7 : TEST AL,0x2
0061dbb9 : JZ 0x0061db80
0061dbbb : TEST AL,0x10
0061dbbd : JZ 0x0061db80
0061dbbf : MOV EAX,dword ptr [ECX + 0x104]
0061dbc5 : CMP dword ptr [EAX + 0x120],0x0
0061dbcc : JNZ 0x0061db80
0061dbce : PUSH ECX
0061dbcf : PUSH EBP
0061dbd0 : CALL 0x00611d80
0061dbd5 : LEA ECX,[ESP + 0x18]
0061dbd9 : PUSH ECX
0061dbda : CALL 0x00611c30
0061dbdf : ADD ESP,0xc
0061dbe2 : JMP 0x0061db80
0061dbe4 : MOV dword ptr [ESP + 0x10],0x0
0061dbec : XOR ESI,ESI
0061dbee : MOV EAX,dword ptr [EBP + 0x94]
0061dbf4 : POP EBX
0061dbf5 : CMP EAX,ESI
0061dbf7 : JZ 0x0061dc05
0061dbf9 : MOV EDX,dword ptr [EAX + 0x124]
0061dbff : MOV dword ptr [EAX + 0x12c],EDX
0061dc05 : MOV EAX,dword ptr [EBP + 0x94]
0061dc0b : CMP EAX,ESI
0061dc0d : JZ 0x0061dc44
0061dc0f : MOV ECX,dword ptr [EAX + 0x12c]
0061dc15 : CMP ECX,ESI
0061dc17 : JZ 0x0061dc44
0061dc19 : MOV ECX,dword ptr [ECX + 0x130]
0061dc1f : CMP ECX,ESI
0061dc21 : JZ 0x0061dc44
0061dc23 : MOV EDX,dword ptr [EAX + 0x12c]
0061dc29 : FLD float ptr [ESP + 0x24]
0061dc2d : MOV EDX,dword ptr [EDX]
0061dc2f : PUSH ECX
0061dc30 : FSTP float ptr [ESP]
0061dc33 : PUSH ECX
0061dc34 : MOV dword ptr [EAX + 0x12c],EDX
0061dc3a : CALL 0x00616b30
0061dc3f : ADD ESP,0x8
0061dc42 : JMP 0x0061dc05
0061dc44 : POP EDI
0061dc45 : POP ESI
0061dc46 : POP EBP
0061dc47 : ADD ESP,0x10
0061dc4a : RET

PROGRAM  : Maestia.exe
FUNCTION : __wstrdate_s
ENTRY    : 0063e1e5
BODY     : [[0063e1e5, 0063e2a2]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    __wstrdate_s
   
   Library: Visual Studio 2008 Release */

errno_t __cdecl __wstrdate_s(wchar_t *_Buf,size_t _SizeInWords)

{
  int *piVar1;
  int iVar2;
  _SYSTEMTIME local_14;
  
  if ((_Buf == (wchar_t *)0x0) || (_SizeInWords == 0)) {
    piVar1 = __errno();
    iVar2 = 0x16;
  }
  else {
    *_Buf = L'\0';
    if (8 < _SizeInWords) {
      GetLocalTime(&local_14);
      _Buf[5] = L'/';
      _Buf[2] = L'/';
      _Buf[8] = L'\0';
      *_Buf = local_14.wMonth / 10 + L'0';
      _Buf[1] = local_14.wMonth % 10 + L'0';
      _Buf[3] = local_14.wDay / 10 + L'0';
      _Buf[4] = local_14.wDay % 10 + L'0';
      _Buf[6] = (short)(((ulonglong)local_14.wYear % 100) / 10) + L'0';
      _Buf[7] = (short)(((ulonglong)local_14.wYear % 100) % 10) + L'0';
      return 0;
    }
    piVar1 = __errno();
    iVar2 = 0x22;
  }
  *piVar1 = iVar2;
  __invalid_parameter(0,0,0,0,0);
  return iVar2;
}



============================================================
DISASSEMBLY
============================================================
0063e1e5 : MOV EDI,EDI
0063e1e7 : PUSH EBP
0063e1e8 : MOV EBP,ESP
0063e1ea : SUB ESP,0x10
0063e1ed : PUSH ESI
0063e1ee : MOV ESI,dword ptr [EBP + 0x8]
0063e1f1 : PUSH EDI
0063e1f2 : XOR EDI,EDI
0063e1f4 : CMP ESI,EDI
0063e1f6 : JZ 0x0063e1fd
0063e1f8 : CMP dword ptr [EBP + 0xc],EDI
0063e1fb : JA 0x0063e21d
0063e1fd : CALL 0x0063ab82
0063e202 : PUSH 0x16
0063e204 : POP ECX
0063e205 : PUSH EDI
0063e206 : PUSH EDI
0063e207 : PUSH EDI
0063e208 : PUSH EDI
0063e209 : PUSH EDI
0063e20a : MOV ESI,ECX
0063e20c : MOV dword ptr [EAX],ECX
0063e20e : CALL 0x006372b8
0063e213 : ADD ESP,0x14
0063e216 : MOV EAX,ESI
0063e218 : JMP 0x0063e29f
0063e21d : XOR EAX,EAX
0063e21f : CMP dword ptr [EBP + 0xc],0x9
0063e223 : MOV word ptr [ESI],AX
0063e226 : JNC 0x0063e231
0063e228 : CALL 0x0063ab82
0063e22d : PUSH 0x22
0063e22f : JMP 0x0063e204
0063e231 : PUSH EBX
0063e232 : LEA EAX,[EBP + -0x10]
0063e235 : PUSH EAX
0063e236 : CALL dword ptr [0x00b85154]
0063e23c : MOVZX EAX,word ptr [EBP + -0x10]
0063e240 : CDQ
0063e241 : PUSH 0x64
0063e243 : POP EBX
0063e244 : IDIV EBX
0063e246 : MOVZX ECX,word ptr [EBP + -0xe]
0063e24a : PUSH 0x2f
0063e24c : POP EAX
0063e24d : MOV word ptr [ESI + 0xa],AX
0063e251 : MOV word ptr [ESI + 0x4],AX
0063e255 : XOR EAX,EAX
0063e257 : MOV word ptr [ESI + 0x10],AX
0063e25b : MOV EAX,ECX
0063e25d : PUSH 0xa
0063e25f : POP ECX
0063e260 : MOVZX EDI,word ptr [EBP + -0xa]
0063e264 : MOV EBX,EDX
0063e266 : CDQ
0063e267 : IDIV ECX
0063e269 : ADD EAX,0x30
0063e26c : MOV word ptr [ESI],AX
0063e26f : ADD EDX,0x30
0063e272 : MOV word ptr [ESI + 0x2],DX
0063e276 : MOV EAX,EDI
0063e278 : CDQ
0063e279 : IDIV ECX
0063e27b : ADD EAX,0x30
0063e27e : MOV word ptr [ESI + 0x6],AX
0063e282 : ADD EDX,0x30
0063e285 : MOV word ptr [ESI + 0x8],DX
0063e289 : MOV EAX,EBX
0063e28b : CDQ
0063e28c : IDIV ECX
0063e28e : POP EBX
0063e28f : ADD EAX,0x30
0063e292 : ADD EDX,0x30
0063e295 : MOV word ptr [ESI + 0xc],AX
0063e299 : MOV word ptr [ESI + 0xe],DX
0063e29d : XOR EAX,EAX
0063e29f : POP EDI
0063e2a0 : POP ESI
0063e2a1 : LEAVE
0063e2a2 : RET

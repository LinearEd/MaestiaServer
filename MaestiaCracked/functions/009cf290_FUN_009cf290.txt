PROGRAM  : Maestia.exe
FUNCTION : FUN_009cf290
ENTRY    : 009cf290
BODY     : [[009cf290, 009cf3d3]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009cf290(int param_1,ushort *param_2)

{
  int *piVar1;
  char *pcVar2;
  int iVar3;
  undefined1 local_2c [10];
  undefined2 local_22;
  undefined2 local_20;
  undefined1 local_1e;
  int local_18;
  int local_14;
  int local_10;
  uint local_c;
  char local_5;
  
  iVar3 = (*param_2 & 0x1fff) - 5;
  pcVar2 = (char *)((int)param_2 + 5);
  local_14 = 0;
  if ((char)param_2[2] != '\0') {
    do {
      if ((pcVar2 == (char *)0x0) || (iVar3 == 0)) {
LAB_009cf2e9:
        iVar3 = 0;
        pcVar2 = (char *)0x0;
      }
      else {
        local_5 = *pcVar2;
        if (((ushort *)(pcVar2 + 1) == (ushort *)0x0) || (iVar3 - 1U < 2)) goto LAB_009cf2e9;
        local_c = (uint)*(ushort *)(pcVar2 + 1);
        iVar3 = iVar3 + -3;
        pcVar2 = pcVar2 + 3;
      }
      if ((local_5 != '\0') && (FUN_0041c060(&local_c), local_18 != DAT_017210c8)) {
        local_c = (uint)*(ushort *)(local_18 + 0xe);
      }
      FUN_0041c270(&local_c);
      if (local_10 == *(int *)(param_1 + 0x7c)) {
        local_22 = (undefined2)local_c;
        local_20 = 0;
        local_1e = 0;
        FUN_0041c1c0(local_2c,&local_22);
        piVar1 = (int *)FUN_0041c270(&local_c);
        local_10 = *piVar1;
      }
      if (local_5 == '\0') {
        if ((pcVar2 != (char *)0x0) && (iVar3 != 0)) {
          *(char *)(local_10 + 0xe) = *pcVar2;
          if ((pcVar2 + 1 != (char *)0x0) && (iVar3 != 1)) {
            iVar3 = iVar3 + -2;
            *(char *)(local_10 + 0xf) = pcVar2[1];
            pcVar2 = pcVar2 + 2;
            goto LAB_009cf3a0;
          }
        }
LAB_009cf39c:
        iVar3 = 0;
        pcVar2 = (char *)0x0;
      }
      else {
        if ((pcVar2 == (char *)0x0) || (iVar3 == 0)) goto LAB_009cf39c;
        iVar3 = iVar3 + -1;
        *(char *)(local_10 + 0x10) = *pcVar2;
        pcVar2 = pcVar2 + 1;
      }
LAB_009cf3a0:
      local_14 = local_14 + 1;
    } while (local_14 < (int)(uint)(byte)param_2[2]);
  }
  if ((uint)*(byte *)(param_1 + 0x84) != *(uint *)(param_1 + 0x74)) {
    FUN_009cec90((uint)*(byte *)(param_1 + 0x84));
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
009cf290 : PUSH EBP
009cf291 : MOV EBP,ESP
009cf293 : SUB ESP,0x2c
009cf296 : MOV EAX,dword ptr [EBP + 0xc]
009cf299 : PUSH EBX
009cf29a : PUSH ESI
009cf29b : PUSH EDI
009cf29c : MOVZX EDI,word ptr [EAX]
009cf29f : AND EDI,0x1fff
009cf2a5 : SUB EDI,0x5
009cf2a8 : CMP byte ptr [EAX + 0x4],0x0
009cf2ac : LEA ESI,[EAX + 0x5]
009cf2af : MOV dword ptr [EBP + -0x10],0x0
009cf2b6 : JBE 0x009cf3b6
009cf2bc : MOV EBX,dword ptr [EBP + 0x8]
009cf2bf : ADD EBX,0x78
009cf2c2 : TEST ESI,ESI
009cf2c4 : JZ 0x009cf2e9
009cf2c6 : CMP EDI,0x1
009cf2c9 : JC 0x009cf2e9
009cf2cb : MOV AL,byte ptr [ESI]
009cf2cd : DEC EDI
009cf2ce : ADD ESI,0x1
009cf2d1 : MOV byte ptr [EBP + -0x1],AL
009cf2d4 : JZ 0x009cf2e9
009cf2d6 : CMP EDI,0x2
009cf2d9 : JC 0x009cf2e9
009cf2db : MOVZX ECX,word ptr [ESI]
009cf2de : SUB EDI,0x2
009cf2e1 : MOV dword ptr [EBP + -0x8],ECX
009cf2e4 : ADD ESI,0x2
009cf2e7 : JMP 0x009cf2ed
009cf2e9 : XOR EDI,EDI
009cf2eb : XOR ESI,ESI
009cf2ed : CMP byte ptr [EBP + -0x1],0x0
009cf2f1 : JZ 0x009cf316
009cf2f3 : LEA EDX,[EBP + -0x8]
009cf2f6 : PUSH EDX
009cf2f7 : LEA EAX,[EBP + -0x14]
009cf2fa : MOV ECX,0x17210c4
009cf2ff : CALL 0x0041c060
009cf304 : MOV EAX,dword ptr [EBP + -0x14]
009cf307 : CMP EAX,dword ptr [0x017210c8]
009cf30d : JZ 0x009cf316
009cf30f : MOVZX EAX,word ptr [EAX + 0xe]
009cf313 : MOV dword ptr [EBP + -0x8],EAX
009cf316 : LEA ECX,[EBP + -0x8]
009cf319 : PUSH ECX
009cf31a : LEA EAX,[EBP + -0xc]
009cf31d : MOV ECX,EBX
009cf31f : CALL 0x0041c270
009cf324 : MOV EAX,dword ptr [EBP + -0xc]
009cf327 : MOV EDX,dword ptr [EBP + 0x8]
009cf32a : CMP EAX,dword ptr [EDX + 0x7c]
009cf32d : JNZ 0x009cf362
009cf32f : MOV AX,word ptr [EBP + -0x8]
009cf333 : MOV word ptr [EBP + -0x1e],AX
009cf337 : XOR EAX,EAX
009cf339 : LEA ECX,[EBP + -0x1e]
009cf33c : PUSH ECX
009cf33d : LEA EDX,[EBP + -0x28]
009cf340 : MOV word ptr [EBP + -0x1c],AX
009cf344 : MOV byte ptr [EBP + -0x1a],AL
009cf347 : PUSH EDX
009cf348 : MOV EAX,EBX
009cf34a : CALL 0x0041c1c0
009cf34f : LEA EAX,[EBP + -0x8]
009cf352 : PUSH EAX
009cf353 : LEA EAX,[EBP + -0x18]
009cf356 : MOV ECX,EBX
009cf358 : CALL 0x0041c270
009cf35d : MOV EAX,dword ptr [EAX]
009cf35f : MOV dword ptr [EBP + -0xc],EAX
009cf362 : CMP byte ptr [EBP + -0x1],0x0
009cf366 : JNZ 0x009cf38a
009cf368 : TEST ESI,ESI
009cf36a : JZ 0x009cf39c
009cf36c : CMP EDI,0x1
009cf36f : JC 0x009cf39c
009cf371 : MOV CL,byte ptr [ESI]
009cf373 : DEC EDI
009cf374 : ADD ESI,0x1
009cf377 : MOV byte ptr [EAX + 0xe],CL
009cf37a : JZ 0x009cf39c
009cf37c : CMP EDI,0x1
009cf37f : JC 0x009cf39c
009cf381 : MOV DL,byte ptr [ESI]
009cf383 : DEC EDI
009cf384 : MOV byte ptr [EAX + 0xf],DL
009cf387 : INC ESI
009cf388 : JMP 0x009cf3a0
009cf38a : TEST ESI,ESI
009cf38c : JZ 0x009cf39c
009cf38e : CMP EDI,0x1
009cf391 : JC 0x009cf39c
009cf393 : MOV CL,byte ptr [ESI]
009cf395 : DEC EDI
009cf396 : MOV byte ptr [EAX + 0x10],CL
009cf399 : INC ESI
009cf39a : JMP 0x009cf3a0
009cf39c : XOR EDI,EDI
009cf39e : XOR ESI,ESI
009cf3a0 : MOV EDX,dword ptr [EBP + 0xc]
009cf3a3 : MOV EAX,dword ptr [EBP + -0x10]
009cf3a6 : MOVZX ECX,byte ptr [EDX + 0x4]
009cf3aa : INC EAX
009cf3ab : CMP EAX,ECX
009cf3ad : MOV dword ptr [EBP + -0x10],EAX
009cf3b0 : JL 0x009cf2c2
009cf3b6 : MOV ECX,dword ptr [EBP + 0x8]
009cf3b9 : MOVZX EAX,byte ptr [ECX + 0x84]
009cf3c0 : CMP EAX,dword ptr [ECX + 0x74]
009cf3c3 : JZ 0x009cf3cb
009cf3c5 : PUSH EAX
009cf3c6 : CALL 0x009cec90
009cf3cb : POP EDI
009cf3cc : POP ESI
009cf3cd : POP EBX
009cf3ce : MOV ESP,EBP
009cf3d0 : POP EBP
009cf3d1 : RET 0x8

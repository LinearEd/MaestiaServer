PROGRAM  : Maestia.exe
FUNCTION : FUN_008fa020
ENTRY    : 008fa020
BODY     : [[008fa020, 008fa24c] [008fa250, 008fa349]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_008fa020(int param_1)

{
  wchar_t wVar1;
  undefined4 uVar2;
  uint uVar3;
  int iVar4;
  DWORD DVar5;
  uint uVar6;
  int iVar7;
  int iVar8;
  wchar_t ****_Src;
  undefined4 *puVar9;
  wchar_t *pwVar10;
  undefined4 *puVar11;
  uint local_806c;
  undefined1 local_8068 [4];
  undefined4 local_8064;
  int local_8054;
  uint local_8050;
  undefined1 local_804c [4];
  undefined4 local_8048;
  int local_8038;
  uint local_8034;
  undefined1 local_8030 [4];
  wchar_t ***local_802c [4];
  undefined4 local_801c;
  uint local_8018;
  wchar_t local_8014;
  undefined1 local_8012 [16382];
  wchar_t local_4014;
  undefined1 local_4012 [16382];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3563a;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  uVar2 = *(undefined4 *)(param_1 + 0x50);
  local_802c[0] = (wchar_t ***)((uint)local_802c[0] & 0xffff0000);
  local_8018 = 7;
  local_801c = 0;
  local_14 = uVar3;
  FUN_00405eb0(param_1 + 0x34,0,0xffffffff);
  local_8 = 0;
  iVar4 = FUN_009f2740(uVar2);
  if (iVar4 != 0) {
    DVar5 = timeGetTime();
    local_806c = DVar5 - *(int *)(iVar4 + 0xd8);
    uVar6 = FUN_009ea720(uVar3);
    if ((*(int *)(iVar4 + 0xd8) != 0) &&
       (iVar8 = *(int *)(iVar4 + 0xdc), iVar7 = FUN_009ea720(uVar3), iVar7 != iVar8)) {
      uVar6 = *(uint *)(iVar4 + 0xdc);
      uVar3 = FUN_009ea720();
      if (uVar6 < uVar3) {
        iVar4 = *(int *)(iVar4 + 0xdc);
        iVar8 = FUN_009ea720();
        local_806c = local_806c + (iVar4 - iVar8);
      }
    }
    if (local_806c < uVar6) {
      local_4014 = L'\0';
      _memset(local_4012,0,0x3ffe);
      _Src = (wchar_t ****)local_802c[0];
      if (local_8018 < 8) {
        _Src = local_802c;
      }
      _wcscpy_s(&local_4014,0x2000,(wchar_t *)_Src);
      FUN_0081cbe0(DAT_0172491c);
      local_8._0_1_ = 1;
      if (local_8054 == 0) {
        FUN_00405c00(local_8068);
      }
      FUN_0081cbe0(DAT_0172491c);
      local_8._0_1_ = 2;
      if (local_8038 == 0) {
        FUN_00405c00(local_804c);
      }
      local_8014 = L'\0';
      _memset(local_8012,0,0x3ffe);
      puVar9 = local_8048;
      if (local_8034 < 8) {
        puVar9 = &local_8048;
      }
      puVar11 = local_8064;
      if (local_8050 < 8) {
        puVar11 = &local_8064;
      }
      _swprintf_s(&local_8014,0x2000,L"@0%s : %d%s;",puVar11,(uVar6 - local_806c) / 1000,puVar9);
      _wcscat_s(&local_4014,0x2000,&local_8014);
      pwVar10 = &local_4014;
      do {
        wVar1 = *pwVar10;
        pwVar10 = pwVar10 + 1;
      } while (wVar1 != L'\0');
      FUN_00406360(&local_4014,(int)pwVar10 - (int)local_4012 >> 1);
      local_8 = CONCAT31(local_8._1_3_,1);
      if (7 < local_8034) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_8034 = 7;
      local_8038 = 0;
      local_8048 = (undefined4 *)((uint)local_8048._2_2_ << 0x10);
      local_8 = (uint)local_8._1_3_ << 8;
      if (7 < local_8050) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_8050 = 7;
      local_8054 = 0;
      local_8064 = (undefined4 *)((uint)local_8064._2_2_ << 0x10);
    }
    if (*(int *)(param_1 + 0x10) == 0) {
      *(undefined4 *)(param_1 + 0x10) = *(undefined4 *)(param_1 + 0x58);
    }
    FUN_008f9b20(local_8030,3,0);
  }
  local_8 = 0xffffffff;
  if (local_8018 < 8) {
    local_8018 = 7;
    local_801c = 0;
    local_802c[0] = (wchar_t ***)((uint)local_802c[0] & 0xffff0000);
    ExceptionList = local_10;
    __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
    return;
  }
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
008fa020 : PUSH EBP
008fa021 : MOV EBP,ESP
008fa023 : PUSH -0x1
008fa025 : PUSH 0xb3563a
008fa02a : MOV EAX,FS:[0x0]
008fa030 : PUSH EAX
008fa031 : MOV EAX,0x8060
008fa036 : CALL 0x0063b780
008fa03b : MOV EAX,[0x00d66fa0]
008fa040 : XOR EAX,EBP
008fa042 : MOV dword ptr [EBP + -0x10],EAX
008fa045 : PUSH EBX
008fa046 : PUSH ESI
008fa047 : PUSH EDI
008fa048 : PUSH EAX
008fa049 : LEA EAX,[EBP + -0xc]
008fa04c : MOV FS:[0x0],EAX
008fa052 : MOV EBX,dword ptr [EBP + 0x8]
008fa055 : MOV ESI,dword ptr [EBX + 0x50]
008fa058 : PUSH -0x1
008fa05a : XOR EDI,EDI
008fa05c : XOR ECX,ECX
008fa05e : LEA EAX,[EBX + 0x34]
008fa061 : PUSH EDI
008fa062 : MOV word ptr [EBP + 0xffff7fd8],CX
008fa069 : PUSH EAX
008fa06a : LEA ECX,[EBP + 0xffff7fd4]
008fa070 : MOV dword ptr [EBP + 0xffff7f94],EBX
008fa076 : MOV dword ptr [EBP + 0xffff7fec],0x7
008fa080 : MOV dword ptr [EBP + 0xffff7fe8],EDI
008fa086 : CALL 0x00405eb0
008fa08b : MOV dword ptr [EBP + -0x4],EDI
008fa08e : MOV ECX,dword ptr [0x017247f0]
008fa094 : PUSH ESI
008fa095 : CALL 0x009f2740
008fa09a : MOV ESI,EAX
008fa09c : CMP ESI,EDI
008fa09e : JZ 0x008fa2f8
008fa0a4 : CALL dword ptr [0x00b85598]
008fa0aa : SUB EAX,dword ptr [ESI + 0xd8]
008fa0b0 : MOV dword ptr [EBP + 0xffff7f98],EAX
008fa0b6 : CALL 0x009ea720
008fa0bb : CMP dword ptr [ESI + 0xd8],0x0
008fa0c2 : MOV EDI,EAX
008fa0c4 : JZ 0x008fa0fd
008fa0c6 : MOV EBX,dword ptr [ESI + 0xdc]
008fa0cc : CALL 0x009ea720
008fa0d1 : CMP EAX,EBX
008fa0d3 : JZ 0x008fa0f7
008fa0d5 : MOV EDI,dword ptr [ESI + 0xdc]
008fa0db : CALL 0x009ea720
008fa0e0 : CMP EAX,EDI
008fa0e2 : JBE 0x008fa0f7
008fa0e4 : MOV EBX,dword ptr [ESI + 0xdc]
008fa0ea : CALL 0x009ea720
008fa0ef : SUB EBX,EAX
008fa0f1 : ADD dword ptr [EBP + 0xffff7f98],EBX
008fa0f7 : MOV EBX,dword ptr [EBP + 0xffff7f94]
008fa0fd : CMP dword ptr [EBP + 0xffff7f98],EDI
008fa103 : JNC 0x008fa2d6
008fa109 : XOR EDX,EDX
008fa10b : PUSH 0x3ffe
008fa110 : PUSH EDX
008fa111 : LEA EAX,[EBP + 0xffffbff2]
008fa117 : PUSH EAX
008fa118 : MOV word ptr [EBP + 0xffffbff0],DX
008fa11f : CALL 0x0063b700
008fa124 : MOV EAX,dword ptr [EBP + 0xffff7fd8]
008fa12a : ADD ESP,0xc
008fa12d : CMP dword ptr [EBP + 0xffff7fec],0x8
008fa134 : JNC 0x008fa13c
008fa136 : LEA EAX,[EBP + 0xffff7fd8]
008fa13c : PUSH EAX
008fa13d : LEA ECX,[EBP + 0xffffbff0]
008fa143 : PUSH 0x2000
008fa148 : PUSH ECX
008fa149 : CALL 0x0063481b
008fa14e : MOV EDX,dword ptr [0x0172491c]
008fa154 : ADD ESP,0xc
008fa157 : PUSH EDX
008fa158 : MOV ECX,0xc61758
008fa15d : LEA ESI,[EBP + 0xffff7f9c]
008fa163 : CALL 0x0081cbe0
008fa168 : MOV byte ptr [EBP + -0x4],0x1
008fa16c : CMP dword ptr [EBP + 0xffff7fb0],0x0
008fa173 : JNZ 0x008fa182
008fa175 : MOV EAX,ESI
008fa177 : PUSH EAX
008fa178 : MOV EDX,0xc61764
008fa17d : CALL 0x00405c00
008fa182 : MOV ECX,dword ptr [0x0172491c]
008fa188 : PUSH ECX
008fa189 : MOV ECX,0xc6177c
008fa18e : LEA ESI,[EBP + 0xffff7fb8]
008fa194 : CALL 0x0081cbe0
008fa199 : MOV byte ptr [EBP + -0x4],0x2
008fa19d : CMP dword ptr [EBP + 0xffff7fcc],0x0
008fa1a4 : JNZ 0x008fa1b3
008fa1a6 : MOV EDX,ESI
008fa1a8 : PUSH EDX
008fa1a9 : MOV EDX,0xc61784
008fa1ae : CALL 0x00405c00
008fa1b3 : XOR EAX,EAX
008fa1b5 : PUSH 0x3ffe
008fa1ba : PUSH EAX
008fa1bb : LEA ECX,[EBP + 0xffff7ff2]
008fa1c1 : PUSH ECX
008fa1c2 : MOV word ptr [EBP + 0xffff7ff0],AX
008fa1c9 : CALL 0x0063b700
008fa1ce : MOV EAX,dword ptr [EBP + 0xffff7fbc]
008fa1d4 : MOV ESI,0x8
008fa1d9 : ADD ESP,0xc
008fa1dc : CMP dword ptr [EBP + 0xffff7fd0],ESI
008fa1e2 : JNC 0x008fa1ea
008fa1e4 : LEA EAX,[EBP + 0xffff7fbc]
008fa1ea : MOV ECX,dword ptr [EBP + 0xffff7fa0]
008fa1f0 : CMP dword ptr [EBP + 0xffff7fb4],ESI
008fa1f6 : JNC 0x008fa1fe
008fa1f8 : LEA ECX,[EBP + 0xffff7fa0]
008fa1fe : SUB EDI,dword ptr [EBP + 0xffff7f98]
008fa204 : PUSH EAX
008fa205 : MOV EAX,0x10624dd3
008fa20a : MUL EDI
008fa20c : SHR EDX,0x6
008fa20f : PUSH EDX
008fa210 : PUSH ECX
008fa211 : PUSH 0xc61794
008fa216 : LEA EDX,[EBP + 0xffff7ff0]
008fa21c : PUSH 0x2000
008fa221 : PUSH EDX
008fa222 : CALL 0x00635d51
008fa227 : LEA EAX,[EBP + 0xffff7ff0]
008fa22d : PUSH EAX
008fa22e : LEA ECX,[EBP + 0xffffbff0]
008fa234 : PUSH 0x2000
008fa239 : PUSH ECX
008fa23a : CALL 0x006362c1
008fa23f : LEA EAX,[EBP + 0xffffbff0]
008fa245 : ADD ESP,0x24
008fa248 : LEA EDX,[EAX + 0x2]
008fa24b : JMP 0x008fa250
008fa250 : MOV CX,word ptr [EAX]
008fa253 : ADD EAX,0x2
008fa256 : TEST CX,CX
008fa259 : JNZ 0x008fa250
008fa25b : SUB EAX,EDX
008fa25d : SAR EAX,0x1
008fa25f : PUSH EAX
008fa260 : LEA EDX,[EBP + 0xffffbff0]
008fa266 : PUSH EDX
008fa267 : LEA ECX,[EBP + 0xffff7fd4]
008fa26d : CALL 0x00406360
008fa272 : MOV byte ptr [EBP + -0x4],0x1
008fa276 : CMP dword ptr [EBP + 0xffff7fd0],ESI
008fa27c : JC 0x008fa289
008fa27e : MOV ECX,dword ptr [EBP + 0xffff7fbc]
008fa284 : CALL 0x006f04e0
008fa289 : XOR EAX,EAX
008fa28b : MOV EDI,0x7
008fa290 : MOV dword ptr [EBP + 0xffff7fd0],EDI
008fa296 : MOV dword ptr [EBP + 0xffff7fcc],0x0
008fa2a0 : MOV word ptr [EBP + 0xffff7fbc],AX
008fa2a7 : MOV byte ptr [EBP + -0x4],AL
008fa2aa : CMP dword ptr [EBP + 0xffff7fb4],ESI
008fa2b0 : JC 0x008fa2bd
008fa2b2 : MOV ECX,dword ptr [EBP + 0xffff7fa0]
008fa2b8 : CALL 0x006f04e0
008fa2bd : XOR ECX,ECX
008fa2bf : MOV dword ptr [EBP + 0xffff7fb4],EDI
008fa2c5 : MOV dword ptr [EBP + 0xffff7fb0],0x0
008fa2cf : MOV word ptr [EBP + 0xffff7fa0],CX
008fa2d6 : CMP dword ptr [EBX + 0x10],0x0
008fa2da : JNZ 0x008fa2e2
008fa2dc : MOV EDX,dword ptr [EBX + 0x58]
008fa2df : MOV dword ptr [EBX + 0x10],EDX
008fa2e2 : PUSH 0x0
008fa2e4 : PUSH 0x3
008fa2e6 : LEA EAX,[EBP + 0xffff7fd4]
008fa2ec : PUSH EAX
008fa2ed : XOR ECX,ECX
008fa2ef : MOV ESI,EBX
008fa2f1 : CALL 0x008f9b20
008fa2f6 : XOR EDI,EDI
008fa2f8 : MOV dword ptr [EBP + -0x4],0xffffffff
008fa2ff : CMP dword ptr [EBP + 0xffff7fec],0x8
008fa306 : JC 0x008fa313
008fa308 : MOV ECX,dword ptr [EBP + 0xffff7fd8]
008fa30e : CALL 0x006f04e0
008fa313 : XOR ECX,ECX
008fa315 : MOV dword ptr [EBP + 0xffff7fec],0x7
008fa31f : MOV dword ptr [EBP + 0xffff7fe8],EDI
008fa325 : MOV word ptr [EBP + 0xffff7fd8],CX
008fa32c : MOV ECX,dword ptr [EBP + -0xc]
008fa32f : MOV dword ptr FS:[0x0],ECX
008fa336 : POP ECX
008fa337 : POP EDI
008fa338 : POP ESI
008fa339 : POP EBX
008fa33a : MOV ECX,dword ptr [EBP + -0x10]
008fa33d : XOR ECX,EBP
008fa33f : CALL 0x00633e6b
008fa344 : MOV ESP,EBP
008fa346 : POP EBP
008fa347 : RET 0x4

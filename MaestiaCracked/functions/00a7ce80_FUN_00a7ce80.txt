PROGRAM  : Maestia.exe
FUNCTION : FUN_00a7ce80
ENTRY    : 00a7ce80
BODY     : [[00a7ce80, 00a7d219]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x00a7cffa) */

void FUN_00a7ce80(int param_1)

{
  undefined4 uVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  undefined1 auStack_134 [28];
  float fStack_118;
  undefined4 uStack_114;
  undefined1 auStack_110 [4];
  undefined2 uStack_10c;
  undefined4 uStack_fc;
  uint uStack_f8;
  undefined4 **appuStack_d4 [5];
  uint uStack_c0;
  undefined4 **appuStack_b8 [5];
  uint uStack_a4;
  undefined4 **appuStack_9c [5];
  uint uStack_88;
  uint local_84;
  void *local_4c;
  undefined1 *puStack_48;
  undefined4 uStack_44;
  
  uStack_44 = 0xffffffff;
  puStack_48 = &LAB_00b5163c;
  local_4c = ExceptionList;
  local_84 = DAT_00d66fa0 ^ (uint)auStack_134;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffec0;
  ExceptionList = &local_4c;
  iVar4 = *DAT_00da9894;
  if ((iVar4 != 0) && (*(int *)(iVar4 + 0x114) != 0)) {
    (**(code **)(**(int **)(iVar4 + 0x114) + 4))();
  }
  iVar3 = FUN_009f2a00();
  iVar4 = DAT_00d7c54c;
  if (iVar3 == 0) {
    FUN_00406460();
    uStack_44 = 0;
    if ((int *)*DAT_00da98e8 != (int *)0x0) {
      (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                (L"AvaGuiCraftIngredient::SetPremiumItem",0x140,auStack_110,uVar2);
    }
    uStack_44 = 0xffffffff;
    if (7 < uStack_f8) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    uStack_f8 = 7;
    uStack_fc = 0;
    uStack_10c = 0;
  }
  else {
    uStack_114 = *(undefined4 *)(iVar3 + 0x10);
    FUN_004437f0();
    uVar1 = DAT_0172491c;
    if (((fStack_118 != *(float *)(iVar4 + 0x44)) &&
        (iVar4 = *(int *)((int)fStack_118 + 0x10), iVar4 != 0)) &&
       (*(short *)(iVar4 + 0x180) == 0x26)) {
      *(undefined1 *)(param_1 + 0x38) = 1;
      FUN_00824a20(uVar1,0);
      uStack_44 = 1;
      fStack_118 = (float)(*(uint *)(iVar4 + 0x184) / 100);
      iVar4 = *(int *)(param_1 + 0x40);
      *(float *)(param_1 + 0x3c) =
           *(float *)(iVar4 + 0x18) + *(float *)(iVar4 + 0x14) + *(float *)(iVar4 + 0x10) +
           fStack_118;
      FUN_00406460();
      uStack_44._0_1_ = 2;
      iVar4 = FUN_0081d120();
      uStack_44._0_1_ = 3;
      if (*(uint *)(iVar4 + 0x18) < 8) {
        iVar4 = iVar4 + 4;
      }
      else {
        iVar4 = *(int *)(iVar4 + 4);
      }
      FUN_00404750(iVar4,(double)*(float *)(param_1 + 0x3c));
      uStack_44._0_1_ = 5;
      FUN_00406560();
      uStack_44._0_1_ = 6;
      FUN_00406560();
      FUN_00406460();
      uStack_44._0_1_ = 7;
      iVar4 = FUN_0081d120();
      uStack_44._0_1_ = 8;
      if (uStack_a4 < 8) {
        appuStack_b8[0] = appuStack_b8;
      }
      if (*(uint *)(iVar4 + 0x18) < 8) {
        iVar4 = iVar4 + 4;
      }
      else {
        iVar4 = *(int *)(iVar4 + 4);
      }
      FUN_00404750(L"%.1f%%  = %s %.1f%% + %s %.1f%%",(double)*(float *)(param_1 + 0x3c),iVar4,
                   (double)*(float *)(*(int *)(param_1 + 0x40) + 0x10),appuStack_b8[0],
                   (double)fStack_118);
      uStack_44._0_1_ = 10;
      FUN_00406560();
      uStack_44 = CONCAT31(uStack_44._1_3_,0xb);
      FUN_00406560();
      iVar4 = *DAT_00da9894;
      if ((iVar4 != 0) && (*(int *)(iVar4 + 0x114) != 0)) {
        if (uStack_c0 < 8) {
          appuStack_d4[0] = appuStack_d4;
        }
        if (uStack_88 < 8) {
          appuStack_9c[0] = appuStack_9c;
        }
        (**(code **)(**(int **)(iVar4 + 0x114) + 4))
                  (*(int **)(iVar4 + 0x114),"SetCraftResultSpecialCri","%ls,%ls",appuStack_9c[0],
                   appuStack_d4[0]);
      }
      uStack_44._0_1_ = 6;
      FUN_00406560();
      uStack_44 = CONCAT31(uStack_44._1_3_,1);
      FUN_00406560();
      uStack_44 = 0xffffffff;
      FUN_00406560();
    }
  }
  ExceptionList = local_4c;
  __security_check_cookie(local_84 ^ (uint)auStack_134);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a7ce80 : PUSH EBP
00a7ce81 : MOV EBP,ESP
00a7ce83 : AND ESP,0xffffffc0
00a7ce86 : PUSH -0x1
00a7ce88 : PUSH 0xb5163c
00a7ce8d : MOV EAX,FS:[0x0]
00a7ce93 : PUSH EAX
00a7ce94 : SUB ESP,0xe8
00a7ce9a : MOV EAX,[0x00d66fa0]
00a7ce9f : XOR EAX,ESP
00a7cea1 : MOV dword ptr [ESP + 0xb0],EAX
00a7cea8 : PUSH EBX
00a7cea9 : PUSH ESI
00a7ceaa : PUSH EDI
00a7ceab : MOV EAX,[0x00d66fa0]
00a7ceb0 : XOR EAX,ESP
00a7ceb2 : PUSH EAX
00a7ceb3 : LEA EAX,[ESP + 0xf8]
00a7ceba : MOV FS:[0x0],EAX
00a7cec0 : MOV EAX,[0x00da9894]
00a7cec5 : MOV EAX,dword ptr [EAX]
00a7cec7 : MOV EBX,dword ptr [EBP + 0x8]
00a7ceca : XOR ESI,ESI
00a7cecc : CMP EAX,ESI
00a7cece : JZ 0x00a7cef5
00a7ced0 : CMP dword ptr [EAX + 0x114],ESI
00a7ced6 : JZ 0x00a7cef5
00a7ced8 : MOV EAX,dword ptr [EAX + 0x114]
00a7cede : MOV ECX,dword ptr [EAX]
00a7cee0 : MOV EDX,dword ptr [ECX + 0x4]
00a7cee3 : PUSH 0x1
00a7cee5 : PUSH 0xc523bc
00a7ceea : PUSH 0xc523c0
00a7ceef : PUSH EAX
00a7cef0 : CALL EDX
00a7cef2 : ADD ESP,0x10
00a7cef5 : MOV EAX,dword ptr [EBX + 0x90]
00a7cefb : MOV ECX,dword ptr [0x017247f0]
00a7cf01 : PUSH EAX
00a7cf02 : CALL 0x009f2a00
00a7cf07 : CMP EAX,ESI
00a7cf09 : JNZ 0x00a7cf75
00a7cf0b : PUSH 0xc523d0
00a7cf10 : LEA ECX,[ESP + 0x38]
00a7cf14 : CALL 0x00406460
00a7cf19 : MOV dword ptr [ESP + 0x100],ESI
00a7cf20 : MOV ECX,dword ptr [0x00da98e8]
00a7cf26 : MOV ECX,dword ptr [ECX]
00a7cf28 : CMP ECX,ESI
00a7cf2a : JZ 0x00a7cf42
00a7cf2c : MOV EDX,dword ptr [ECX]
00a7cf2e : MOV EDX,dword ptr [EDX + 0x14]
00a7cf31 : LEA EAX,[ESP + 0x34]
00a7cf35 : PUSH EAX
00a7cf36 : PUSH 0x140
00a7cf3b : PUSH 0xc523f8
00a7cf40 : CALL EDX
00a7cf42 : MOV dword ptr [ESP + 0x100],0xffffffff
00a7cf4d : CMP dword ptr [ESP + 0x4c],0x8
00a7cf52 : JC 0x00a7cf5d
00a7cf54 : MOV ECX,dword ptr [ESP + 0x38]
00a7cf58 : CALL 0x006f04e0
00a7cf5d : XOR EAX,EAX
00a7cf5f : MOV dword ptr [ESP + 0x4c],0x7
00a7cf67 : MOV dword ptr [ESP + 0x48],ESI
00a7cf6b : MOV word ptr [ESP + 0x38],AX
00a7cf70 : JMP 0x00a7d1f4
00a7cf75 : MOV ECX,dword ptr [EAX + 0x10]
00a7cf78 : MOV EDI,dword ptr [0x00d7c54c]
00a7cf7e : LEA EDX,[ESP + 0x30]
00a7cf82 : MOV dword ptr [ESP + 0x30],ECX
00a7cf86 : PUSH EDX
00a7cf87 : LEA ECX,[EDI + 0x40]
00a7cf8a : LEA EAX,[ESP + 0x30]
00a7cf8e : CALL 0x004437f0
00a7cf93 : MOV EDI,dword ptr [EDI + 0x44]
00a7cf96 : MOV EAX,dword ptr [ESP + 0x2c]
00a7cf9a : CMP EAX,EDI
00a7cf9c : JZ 0x00a7d1f4
00a7cfa2 : MOV EDI,dword ptr [EAX + 0x10]
00a7cfa5 : CMP EDI,ESI
00a7cfa7 : JZ 0x00a7d1f4
00a7cfad : CMP word ptr [EDI + 0x180],0x26
00a7cfb5 : JNZ 0x00a7d1f4
00a7cfbb : MOV EAX,[0x0172491c]
00a7cfc0 : PUSH ESI
00a7cfc1 : LEA EDX,[EDI + 0x18]
00a7cfc4 : PUSH EAX
00a7cfc5 : LEA ESI,[ESP + 0x90]
00a7cfcc : MOV byte ptr [EBX + 0x38],0x1
00a7cfd0 : CALL 0x00824a20
00a7cfd5 : MOV dword ptr [ESP + 0x100],0x1
00a7cfe0 : MOV EAX,0x51eb851f
00a7cfe5 : MUL dword ptr [EDI + 0x184]
00a7cfeb : SHR EDX,0x5
00a7cfee : MOV dword ptr [ESP + 0x2c],EDX
00a7cff2 : FILD dword ptr [ESP + 0x2c]
00a7cff6 : TEST EDX,EDX
00a7cff8 : JGE 0x00a7d000
00a7cffa : FADD float ptr [0x00cdf0e0]
00a7d000 : MOV EAX,dword ptr [EBX + 0x40]
00a7d003 : FST float ptr [ESP + 0x2c]
00a7d007 : FLD float ptr [EAX + 0x18]
00a7d00a : PUSH 0xc52444
00a7d00f : FADD float ptr [EAX + 0x14]
00a7d012 : LEA ECX,[ESP + 0x38]
00a7d016 : FADD float ptr [EAX + 0x10]
00a7d019 : FADDP
00a7d01b : FSTP float ptr [EBX + 0x3c]
00a7d01e : CALL 0x00406460
00a7d023 : MOV byte ptr [ESP + 0x100],0x2
00a7d02b : LEA ECX,[ESP + 0x34]
00a7d02f : PUSH ECX
00a7d030 : MOV ECX,dword ptr [0x0172491c]
00a7d036 : LEA EDI,[ESP + 0x54]
00a7d03a : CALL 0x0081d120
00a7d03f : MOV byte ptr [ESP + 0x100],0x3
00a7d047 : CMP dword ptr [EAX + 0x18],0x8
00a7d04b : JC 0x00a7d052
00a7d04d : MOV EAX,dword ptr [EAX + 0x4]
00a7d050 : JMP 0x00a7d055
00a7d052 : ADD EAX,0x4
00a7d055 : MOVSS XMM0,dword ptr [EBX + 0x3c]
00a7d05a : SUB ESP,0x8
00a7d05d : CVTPS2PD XMM0,XMM0
00a7d060 : MOVSD qword ptr [ESP],XMM0
00a7d065 : PUSH EAX
00a7d066 : LEA ESI,[ESP + 0xb0]
00a7d06d : CALL 0x00404750
00a7d072 : ADD ESP,0xc
00a7d075 : MOV byte ptr [ESP + 0x100],0x5
00a7d07d : LEA ECX,[ESP + 0x50]
00a7d081 : CALL 0x00406560
00a7d086 : MOV byte ptr [ESP + 0x100],0x6
00a7d08e : LEA ECX,[ESP + 0x34]
00a7d092 : CALL 0x00406560
00a7d097 : PUSH 0xc52460
00a7d09c : LEA ECX,[ESP + 0x38]
00a7d0a0 : CALL 0x00406460
00a7d0a5 : MOV byte ptr [ESP + 0x100],0x7
00a7d0ad : MOV ECX,dword ptr [0x0172491c]
00a7d0b3 : LEA EDX,[ESP + 0x34]
00a7d0b7 : PUSH EDX
00a7d0b8 : LEA EDI,[ESP + 0x54]
00a7d0bc : CALL 0x0081d120
00a7d0c1 : MOV byte ptr [ESP + 0x100],0x8
00a7d0c9 : MOV ECX,dword ptr [ESP + 0x8c]
00a7d0d0 : MOV EDI,0x8
00a7d0d5 : CMP dword ptr [ESP + 0xa0],EDI
00a7d0dc : JNC 0x00a7d0e5
00a7d0de : LEA ECX,[ESP + 0x8c]
00a7d0e5 : CMP dword ptr [EAX + 0x18],EDI
00a7d0e8 : JC 0x00a7d0ef
00a7d0ea : MOV EAX,dword ptr [EAX + 0x4]
00a7d0ed : JMP 0x00a7d0f2
00a7d0ef : ADD EAX,0x4
00a7d0f2 : MOVSS XMM0,dword ptr [ESP + 0x2c]
00a7d0f8 : SUB ESP,0x8
00a7d0fb : CVTPS2PD XMM0,XMM0
00a7d0fe : MOVSD qword ptr [ESP],XMM0
00a7d103 : PUSH ECX
00a7d104 : MOV ECX,dword ptr [EBX + 0x40]
00a7d107 : MOVSS XMM0,dword ptr [ECX + 0x10]
00a7d10c : SUB ESP,0x8
00a7d10f : CVTPS2PD XMM0,XMM0
00a7d112 : MOVSD qword ptr [ESP],XMM0
00a7d117 : MOVSS XMM0,dword ptr [EBX + 0x3c]
00a7d11c : PUSH EAX
00a7d11d : SUB ESP,0x8
00a7d120 : CVTPS2PD XMM0,XMM0
00a7d123 : MOVSD qword ptr [ESP],XMM0
00a7d128 : PUSH 0xc524a0
00a7d12d : LEA ESI,[ESP + 0x90]
00a7d134 : CALL 0x00404750
00a7d139 : ADD ESP,0x24
00a7d13c : MOV byte ptr [ESP + 0x100],0xa
00a7d144 : LEA ECX,[ESP + 0x50]
00a7d148 : CALL 0x00406560
00a7d14d : MOV byte ptr [ESP + 0x100],0xb
00a7d155 : LEA ECX,[ESP + 0x34]
00a7d159 : CALL 0x00406560
00a7d15e : MOV EDX,dword ptr [0x00da9894]
00a7d164 : MOV EAX,dword ptr [EDX]
00a7d166 : TEST EAX,EAX
00a7d168 : JZ 0x00a7d1b8
00a7d16a : CMP dword ptr [EAX + 0x114],0x0
00a7d171 : JZ 0x00a7d1b8
00a7d173 : MOV EAX,dword ptr [EAX + 0x114]
00a7d179 : MOV EDX,dword ptr [ESP + 0x70]
00a7d17d : CMP dword ptr [ESP + 0x84],EDI
00a7d184 : JNC 0x00a7d18a
00a7d186 : LEA EDX,[ESP + 0x70]
00a7d18a : MOV ECX,dword ptr [ESP + 0xa8]
00a7d191 : CMP dword ptr [ESP + 0xbc],EDI
00a7d198 : JNC 0x00a7d1a1
00a7d19a : LEA ECX,[ESP + 0xa8]
00a7d1a1 : MOV ESI,dword ptr [EAX]
00a7d1a3 : PUSH EDX
00a7d1a4 : PUSH ECX
00a7d1a5 : PUSH 0xc524e0
00a7d1aa : PUSH 0xc524e8
00a7d1af : PUSH EAX
00a7d1b0 : MOV EAX,dword ptr [ESI + 0x4]
00a7d1b3 : CALL EAX
00a7d1b5 : ADD ESP,0x14
00a7d1b8 : MOV byte ptr [ESP + 0x100],0x6
00a7d1c0 : LEA ECX,[ESP + 0x6c]
00a7d1c4 : CALL 0x00406560
00a7d1c9 : MOV byte ptr [ESP + 0x100],0x1
00a7d1d1 : LEA ECX,[ESP + 0xa4]
00a7d1d8 : CALL 0x00406560
00a7d1dd : MOV dword ptr [ESP + 0x100],0xffffffff
00a7d1e8 : LEA ECX,[ESP + 0x88]
00a7d1ef : CALL 0x00406560
00a7d1f4 : MOV ECX,dword ptr [ESP + 0xf8]
00a7d1fb : MOV dword ptr FS:[0x0],ECX
00a7d202 : POP ECX
00a7d203 : POP EDI
00a7d204 : POP ESI
00a7d205 : POP EBX
00a7d206 : MOV ECX,dword ptr [ESP + 0xb0]
00a7d20d : XOR ECX,ESP
00a7d20f : CALL 0x00633e6b
00a7d214 : MOV ESP,EBP
00a7d216 : POP EBP
00a7d217 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_00520ab0
ENTRY    : 00520ab0
BODY     : [[00520ab0, 00520b0f]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_00520ab0(int *param_1,undefined1 *param_2)

{
  int iVar1;
  int *piVar2;
  uint in_EAX;
  int *in_ECX;
  
  piVar2 = param_1;
  if (*(int *)(*param_1 + 4) == 0) {
    in_EAX = FUN_00525a80();
  }
  if (*in_ECX != 0) {
    in_EAX = FUN_0051dc30(&param_1,*(uint *)(*piVar2 + 0xc) & *(uint *)(*in_ECX + 4));
    if ((-1 < (int)in_EAX) && (iVar1 = *in_ECX + (in_EAX * 3 + 3) * 4, in_EAX = 0, iVar1 != 0)) {
      if (param_2 != (undefined1 *)0x0) {
        *param_2 = *(undefined1 *)(iVar1 + 4);
      }
      return CONCAT31((int3)((uint)iVar1 >> 8),1);
    }
  }
  return in_EAX & 0xffffff00;
}



============================================================
DISASSEMBLY
============================================================
00520ab0 : PUSH ESI
00520ab1 : PUSH EDI
00520ab2 : MOV EDI,dword ptr [ESP + 0xc]
00520ab6 : MOV ESI,ECX
00520ab8 : MOV ECX,dword ptr [EDI]
00520aba : CMP dword ptr [ECX + 0x4],0x0
00520abe : MOV dword ptr [ESP + 0xc],EDI
00520ac2 : JNZ 0x00520ac9
00520ac4 : CALL 0x00525a80
00520ac9 : MOV ECX,dword ptr [ESI]
00520acb : TEST ECX,ECX
00520acd : JZ 0x00520b09
00520acf : MOV EAX,dword ptr [EDI]
00520ad1 : MOV EAX,dword ptr [EAX + 0xc]
00520ad4 : AND EAX,dword ptr [ECX + 0x4]
00520ad7 : LEA ECX,[ESP + 0xc]
00520adb : PUSH EAX
00520adc : PUSH ECX
00520add : MOV ECX,ESI
00520adf : CALL 0x0051dc30
00520ae4 : TEST EAX,EAX
00520ae6 : JL 0x00520b09
00520ae8 : LEA EDX,[EAX + EAX*0x2 + 0x3]
00520aec : MOV EAX,dword ptr [ESI]
00520aee : LEA EAX,[EAX + EDX*0x4]
00520af1 : TEST EAX,EAX
00520af3 : JZ 0x00520b09
00520af5 : MOV ECX,dword ptr [ESP + 0x10]
00520af9 : TEST ECX,ECX
00520afb : JZ 0x00520b02
00520afd : MOV DL,byte ptr [EAX + 0x4]
00520b00 : MOV byte ptr [ECX],DL
00520b02 : POP EDI
00520b03 : MOV AL,0x1
00520b05 : POP ESI
00520b06 : RET 0x8
00520b09 : POP EDI
00520b0a : XOR AL,AL
00520b0c : POP ESI
00520b0d : RET 0x8

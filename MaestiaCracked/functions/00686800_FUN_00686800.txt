PROGRAM  : Maestia.exe
FUNCTION : FUN_00686800
ENTRY    : 00686800
BODY     : [[00686800, 00686a03]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00686800(int param_1,int *param_2)

{
  undefined2 uVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  int iVar6;
  uint uVar7;
  int iVar8;
  uint local_8;
  int local_4;
  
  iVar2 = *(int *)(param_1 + 0x58);
  if ((*(byte *)(param_1 + 8) & 1) == 0) {
    *(undefined4 *)(iVar2 + 0xc) = 0;
    *(undefined4 *)(iVar2 + 0x18) = 0;
    *(undefined4 *)(iVar2 + 0x1c) = 0;
    *(undefined4 *)(iVar2 + 0x20) = 0;
    *(undefined4 *)(iVar2 + 0x24) = 0;
    *(undefined4 *)(iVar2 + 0x10) = 0x400000;
    *(undefined4 *)(iVar2 + 0x14) = 0x400000;
    return;
  }
  iVar6 = 0;
  uVar7 = 0;
  iVar8 = 0;
  local_8 = 0;
  switch(*param_2) {
  case 0:
    uVar7 = (uint)*(ushort *)(param_1 + 0x44);
    local_8 = uVar7;
    break;
  case 1:
    uVar7 = (int)*(short *)(param_1 + 0x46) - (int)*(short *)(param_1 + 0x48);
    local_8 = uVar7;
    break;
  case 2:
    uVar7 = *(int *)(param_1 + 0x40) - *(int *)(param_1 + 0x38);
    local_8 = *(int *)(param_1 + 0x3c) - *(int *)(param_1 + 0x34);
    break;
  case 3:
    uVar7 = (int)*(short *)(param_1 + 0x46) - (int)*(short *)(param_1 + 0x48);
    local_8 = (int)*(short *)(param_1 + 0x4c);
    break;
  case 4:
    *(int *)(iVar2 + 0x10) = param_2[1];
    iVar3 = param_2[2];
    *(int *)(iVar2 + 0x14) = iVar3;
    if (*(int *)(iVar2 + 0x10) == 0) {
      *(int *)(iVar2 + 0x10) = iVar3;
    }
    else if (iVar3 == 0) {
      *(int *)(iVar2 + 0x14) = *(int *)(iVar2 + 0x10);
    }
    goto LAB_00686954;
  default:
    goto switchD_00686830_default;
  }
  if ((int)local_8 < 0) {
    local_8 = -local_8;
  }
  if ((int)uVar7 < 0) {
    uVar7 = -uVar7;
  }
switchD_00686830_default:
  if (param_2[3] == 0) {
    iVar8 = param_2[1];
    local_4 = iVar8;
  }
  else {
    iVar8 = (param_2[3] * param_2[1] + 0x24) / 0x48;
    local_4 = param_2[1];
  }
  if (param_2[4] == 0) {
    iVar6 = param_2[2];
  }
  else {
    iVar6 = (param_2[2] * param_2[4] + 0x24) / 0x48;
  }
  if (local_4 == 0) {
    uVar5 = FUN_00685f30(iVar6,uVar7);
    *(undefined4 *)(iVar2 + 0x14) = uVar5;
    *(undefined4 *)(iVar2 + 0x10) = uVar5;
    iVar8 = FUN_00685d60(iVar6,local_8,uVar7);
  }
  else {
    iVar3 = FUN_00685f30(iVar8,local_8);
    *(int *)(iVar2 + 0x10) = iVar3;
    if (param_2[2] == 0) {
      *(int *)(iVar2 + 0x14) = iVar3;
      iVar6 = FUN_00685d60(iVar8,uVar7,local_8);
    }
    else {
      iVar4 = FUN_00685f30(iVar6,uVar7);
      *(int *)(iVar2 + 0x14) = iVar4;
      if (*param_2 == 3) {
        if (iVar3 < iVar4) {
          *(int *)(iVar2 + 0x14) = iVar3;
        }
        else {
          *(int *)(iVar2 + 0x10) = iVar4;
        }
      }
    }
  }
LAB_00686954:
  if (*param_2 != 0) {
    uVar1 = *(undefined2 *)(param_1 + 0x44);
    iVar8 = FUN_00685ea0(uVar1,*(undefined4 *)(iVar2 + 0x10));
    iVar6 = FUN_00685ea0(uVar1,*(undefined4 *)(iVar2 + 0x14));
  }
  *(short *)(iVar2 + 0xc) = (short)(iVar8 + 0x20 >> 6);
  *(short *)(iVar2 + 0xe) = (short)(iVar6 + 0x20 >> 6);
  FUN_00686710();
  return;
}



============================================================
DISASSEMBLY
============================================================
00686800 : MOV EAX,dword ptr [ESP + 0x4]
00686804 : SUB ESP,0x8
00686807 : PUSH ESI
00686808 : MOV ESI,dword ptr [EAX + 0x58]
0068680b : ADD ESI,0xc
0068680e : TEST byte ptr [EAX + 0x8],0x1
00686812 : JZ 0x006869e4
00686818 : MOV ECX,dword ptr [ESP + 0x14]
0068681c : MOV EDX,dword ptr [ECX]
0068681e : PUSH EBX
0068681f : PUSH EBP
00686820 : PUSH EDI
00686821 : XOR EBX,EBX
00686823 : XOR EBP,EBP
00686825 : XOR EDI,EDI
00686827 : MOV dword ptr [ESP + 0x10],EBX
0068682b : CMP EDX,0x4
0068682e : JA 0x00686853
00686830 : JMP dword ptr [EDX*0x4 + 0x686a04]
00686837 : MOVZX EBP,word ptr [EAX + 0x44]
0068683b : MOV dword ptr [ESP + 0x10],EBP
0068683f : MOV EAX,dword ptr [ESP + 0x10]
00686843 : TEST EAX,EAX
00686845 : JGE 0x0068684d
00686847 : NEG EAX
00686849 : MOV dword ptr [ESP + 0x10],EAX
0068684d : TEST EBP,EBP
0068684f : JGE 0x00686853
00686851 : NEG EBP
00686853 : MOV EAX,dword ptr [ECX + 0xc]
00686856 : TEST EAX,EAX
00686858 : JZ 0x006868d6
0068685a : MOV EDX,dword ptr [ECX + 0x4]
0068685d : IMUL EAX,EDX
00686860 : ADD EAX,0x24
00686863 : MOV dword ptr [ESP + 0x14],EDX
00686867 : MOV EDX,EAX
00686869 : MOV EAX,0x38e38e39
0068686e : IMUL EDX
00686870 : SAR EDX,0x4
00686873 : MOV EDI,EDX
00686875 : SHR EDI,0x1f
00686878 : ADD EDI,EDX
0068687a : JMP 0x006868dd
0068687c : MOVSX EDX,word ptr [EAX + 0x48]
00686880 : MOVSX EBP,word ptr [EAX + 0x46]
00686884 : SUB EBP,EDX
00686886 : JMP 0x0068683b
00686888 : MOV EDX,dword ptr [EAX + 0x3c]
0068688b : SUB EDX,dword ptr [EAX + 0x34]
0068688e : MOV EBP,dword ptr [EAX + 0x40]
00686891 : SUB EBP,dword ptr [EAX + 0x38]
00686894 : MOV dword ptr [ESP + 0x10],EDX
00686898 : JMP 0x0068683f
0068689a : MOVSX EDX,word ptr [EAX + 0x4c]
0068689e : MOVSX EBP,word ptr [EAX + 0x46]
006868a2 : MOV dword ptr [ESP + 0x10],EDX
006868a6 : MOVSX EDX,word ptr [EAX + 0x48]
006868aa : SUB EBP,EDX
006868ac : JMP 0x0068683f
006868ae : MOV EDX,dword ptr [ECX + 0x4]
006868b1 : MOV dword ptr [ESI + 0x4],EDX
006868b4 : MOV EBP,dword ptr [ESI + 0x4]
006868b7 : MOV EDX,dword ptr [ECX + 0x8]
006868ba : MOV dword ptr [ESI + 0x8],EDX
006868bd : TEST EBP,EBP
006868bf : JNZ 0x006868c9
006868c1 : MOV dword ptr [ESI + 0x4],EDX
006868c4 : JMP 0x00686954
006868c9 : TEST EDX,EDX
006868cb : JNZ 0x00686954
006868d1 : MOV dword ptr [ESI + 0x8],EBP
006868d4 : JMP 0x00686954
006868d6 : MOV EDI,dword ptr [ECX + 0x4]
006868d9 : MOV dword ptr [ESP + 0x14],EDI
006868dd : MOV EAX,dword ptr [ECX + 0x10]
006868e0 : TEST EAX,EAX
006868e2 : JZ 0x00686900
006868e4 : MOV EDX,dword ptr [ECX + 0x8]
006868e7 : IMUL EDX,EAX
006868ea : ADD EDX,0x24
006868ed : MOV EAX,0x38e38e39
006868f2 : IMUL EDX
006868f4 : SAR EDX,0x4
006868f7 : MOV EBX,EDX
006868f9 : SHR EBX,0x1f
006868fc : ADD EBX,EDX
006868fe : JMP 0x00686903
00686900 : MOV EBX,dword ptr [ECX + 0x8]
00686903 : CMP dword ptr [ESP + 0x14],0x0
00686908 : JZ 0x006869bd
0068690e : MOV EAX,dword ptr [ESP + 0x10]
00686912 : PUSH EAX
00686913 : PUSH EDI
00686914 : CALL 0x00685f30
00686919 : MOV ECX,dword ptr [ESP + 0x28]
0068691d : ADD ESP,0x8
00686920 : MOV dword ptr [ESI + 0x4],EAX
00686923 : CMP dword ptr [ECX + 0x8],0x0
00686927 : MOV dword ptr [ESP + 0x14],EAX
0068692b : JZ 0x006869a3
0068692d : PUSH EBP
0068692e : PUSH EBX
0068692f : CALL 0x00685f30
00686934 : MOV EDX,dword ptr [ESP + 0x28]
00686938 : ADD ESP,0x8
0068693b : MOV dword ptr [ESI + 0x8],EAX
0068693e : CMP dword ptr [EDX],0x3
00686941 : JNZ 0x0068694e
00686943 : MOV ECX,dword ptr [ESP + 0x14]
00686947 : CMP EAX,ECX
00686949 : JLE 0x0068699e
0068694b : MOV dword ptr [ESI + 0x8],ECX
0068694e : MOV ECX,EDX
00686950 : MOV EAX,dword ptr [ESP + 0x1c]
00686954 : CMP dword ptr [ECX],0x0
00686957 : JZ 0x0068697c
00686959 : MOVZX EBX,word ptr [EAX + 0x44]
0068695d : MOV EDX,dword ptr [ESI + 0x4]
00686960 : PUSH EDX
00686961 : PUSH EBX
00686962 : CALL 0x00685ea0
00686967 : MOV EDI,EAX
00686969 : MOV EAX,dword ptr [ESI + 0x8]
0068696c : PUSH EAX
0068696d : PUSH EBX
0068696e : CALL 0x00685ea0
00686973 : MOV EBX,EAX
00686975 : MOV EAX,dword ptr [ESP + 0x2c]
00686979 : ADD ESP,0x10
0068697c : ADD EDI,0x20
0068697f : SAR EDI,0x6
00686982 : ADD EBX,0x20
00686985 : MOV word ptr [ESI],DI
00686988 : SAR EBX,0x6
0068698b : MOV EDI,EAX
0068698d : MOV word ptr [ESI + 0x2],BX
00686991 : CALL 0x00686710
00686996 : POP EDI
00686997 : POP EBP
00686998 : POP EBX
00686999 : POP ESI
0068699a : ADD ESP,0x8
0068699d : RET
0068699e : MOV dword ptr [ESI + 0x4],EAX
006869a1 : JMP 0x0068694e
006869a3 : MOV dword ptr [ESI + 0x8],EAX
006869a6 : MOV EAX,dword ptr [ESP + 0x10]
006869aa : PUSH EAX
006869ab : PUSH EBP
006869ac : PUSH EDI
006869ad : CALL 0x00685d60
006869b2 : MOV ECX,dword ptr [ESP + 0x2c]
006869b6 : ADD ESP,0xc
006869b9 : MOV EBX,EAX
006869bb : JMP 0x00686950
006869bd : PUSH EBP
006869be : PUSH EBX
006869bf : CALL 0x00685f30
006869c4 : MOV ECX,dword ptr [ESP + 0x18]
006869c8 : PUSH EBP
006869c9 : PUSH ECX
006869ca : PUSH EBX
006869cb : MOV dword ptr [ESI + 0x8],EAX
006869ce : MOV dword ptr [ESI + 0x4],EAX
006869d1 : CALL 0x00685d60
006869d6 : MOV ECX,dword ptr [ESP + 0x34]
006869da : ADD ESP,0x14
006869dd : MOV EDI,EAX
006869df : JMP 0x00686950
006869e4 : XOR EAX,EAX
006869e6 : MOV dword ptr [ESI],EAX
006869e8 : MOV dword ptr [ESI + 0xc],EAX
006869eb : MOV dword ptr [ESI + 0x10],EAX
006869ee : MOV dword ptr [ESI + 0x14],EAX
006869f1 : MOV dword ptr [ESI + 0x18],EAX
006869f4 : MOV EAX,0x400000
006869f9 : MOV dword ptr [ESI + 0x4],EAX
006869fc : MOV dword ptr [ESI + 0x8],EAX
006869ff : POP ESI
00686a00 : ADD ESP,0x8
00686a03 : RET

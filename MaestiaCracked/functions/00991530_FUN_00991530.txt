PROGRAM  : Maestia.exe
FUNCTION : FUN_00991530
ENTRY    : 00991530
BODY     : [[00991530, 00991c08]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00991530(int param_1,undefined4 param_2)

{
  wchar_t wVar1;
  undefined1 uVar2;
  char cVar3;
  short sVar4;
  uint uVar5;
  undefined4 uVar6;
  int iVar7;
  wchar_t *pwVar8;
  int *in_ECX;
  wchar_t *pwVar9;
  wchar_t *pwVar10;
  int iVar11;
  bool bVar12;
  undefined1 local_70 [4];
  int local_6c;
  int local_68;
  undefined4 local_64;
  undefined1 local_60 [4];
  int local_5c;
  int local_58;
  undefined1 local_50 [4];
  undefined2 local_4c;
  undefined4 local_3c;
  uint local_38;
  undefined1 local_34 [4];
  undefined2 local_30;
  undefined4 local_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b68fa2;
  local_14 = ExceptionList;
  uVar5 = DAT_00d66fa0 ^ (uint)&stack0xffffff80;
  ExceptionList = &local_14;
  local_38 = 7;
  local_3c = 0;
  local_4c = 0;
  FUN_00406360(&DAT_00c84f3c,1);
  local_c = 0;
  uVar6 = FUN_00404350(param_2,uVar5);
  local_c._0_1_ = 1;
  FUN_0070cd60(local_60,uVar6,local_50,0);
  local_c = CONCAT31(local_c._1_3_,3);
  if (7 < local_1c) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_1c = 7;
  local_20 = 0;
  local_30 = 0;
  local_c._0_1_ = 4;
  if (7 < local_38) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_4c = 0;
  local_38 = 7;
  local_3c = 0;
  local_1c = 7;
  local_20 = 0;
  local_30 = 0;
  FUN_00406360(&DAT_00c84f40,1);
  local_c._0_1_ = 5;
  uVar6 = FUN_00403dd0(param_2);
  local_c._0_1_ = 6;
  FUN_0070cd60(local_70,uVar6,local_34,0);
  local_c = CONCAT31(local_c._1_3_,8);
  if (7 < local_38) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_38 = 7;
  local_3c = 0;
  local_4c = 0;
  local_c._0_1_ = 9;
  uVar2 = (undefined1)local_c;
  local_c._0_1_ = 9;
  if (7 < local_1c) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_1c = 7;
  uVar5 = *(uint *)(param_1 + 0x18);
  local_20 = 0;
  local_30 = 0;
  pwVar8 = (wchar_t *)(param_1 + 4);
  pwVar10 = pwVar8;
  if (7 < uVar5) {
    pwVar10 = *(wchar_t **)pwVar8;
  }
  pwVar9 = L"onInit";
  do {
    wVar1 = *pwVar10;
    bVar12 = (ushort)wVar1 < (ushort)*pwVar9;
    if (wVar1 != *pwVar9) {
LAB_009916d6:
      iVar7 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
      goto LAB_009916db;
    }
    if (wVar1 == L'\0') break;
    wVar1 = pwVar10[1];
    bVar12 = (ushort)wVar1 < (ushort)pwVar9[1];
    if (wVar1 != pwVar9[1]) goto LAB_009916d6;
    pwVar10 = pwVar10 + 2;
    pwVar9 = pwVar9 + 2;
  } while (wVar1 != L'\0');
  iVar7 = 0;
LAB_009916db:
  if (iVar7 == 0) {
    uVar6 = *(undefined4 *)(*(int *)(DAT_0172491c + 0x17c) + 0x16d8);
    FUN_0098e240();
    FUN_0098f140(in_ECX,uVar6);
  }
  else {
    pwVar10 = pwVar8;
    if (7 < uVar5) {
      pwVar10 = *(wchar_t **)pwVar8;
    }
    pwVar9 = L"close";
    do {
      wVar1 = *pwVar10;
      bVar12 = (ushort)wVar1 < (ushort)*pwVar9;
      if (wVar1 != *pwVar9) {
LAB_0099173e:
        iVar7 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
        goto LAB_00991743;
      }
      if (wVar1 == L'\0') break;
      wVar1 = pwVar10[1];
      bVar12 = (ushort)wVar1 < (ushort)pwVar9[1];
      if (wVar1 != pwVar9[1]) goto LAB_0099173e;
      pwVar10 = pwVar10 + 2;
      pwVar9 = pwVar9 + 2;
    } while (wVar1 != L'\0');
    iVar7 = 0;
LAB_00991743:
    if (iVar7 == 0) {
      (**(code **)(*in_ECX + 0x20))();
    }
    else {
      pwVar10 = pwVar8;
      if (7 < uVar5) {
        pwVar10 = *(wchar_t **)pwVar8;
      }
      pwVar9 = L"SelectJob";
      do {
        wVar1 = *pwVar10;
        bVar12 = (ushort)wVar1 < (ushort)*pwVar9;
        if (wVar1 != *pwVar9) {
LAB_0099178d:
          iVar7 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
          goto LAB_00991792;
        }
        if (wVar1 == L'\0') break;
        wVar1 = pwVar10[1];
        bVar12 = (ushort)wVar1 < (ushort)pwVar9[1];
        if (wVar1 != pwVar9[1]) goto LAB_0099178d;
        pwVar10 = pwVar10 + 2;
        pwVar9 = pwVar9 + 2;
      } while (wVar1 != L'\0');
      iVar7 = 0;
LAB_00991792:
      local_c._0_1_ = uVar2;
      if (iVar7 == 0) {
        iVar7 = local_58 - local_5c >> 0x1f;
        iVar11 = (local_58 - local_5c) / 0x1c + iVar7;
        if (iVar11 == iVar7) {
LAB_009917b9:
          local_c = CONCAT31(local_c._1_3_,4);
          FUN_004042c0();
          local_c = 0xffffffff;
          FUN_004042c0();
          ExceptionList = local_14;
          return;
        }
        if (iVar11 == iVar7) {
          iVar7 = 0;
        }
        else if (*(uint *)(local_5c + 0x18) < 8) {
          iVar7 = FUN_00634f4d(local_5c + 4);
        }
        else {
          iVar7 = FUN_00634f4d(*(undefined4 *)(local_5c + 4));
        }
        in_ECX[0xf] = iVar7;
        sVar4 = *(short *)(*(int *)(DAT_0172491c + 0x17c) + 0x16d8);
        switch(in_ECX[0xe]) {
        case 0:
          FUN_0098f140(in_ECX,(short)in_ECX[0xf] + 2);
          break;
        case 1:
          FUN_0098f140(in_ECX,(short)in_ECX[0xf] + 6);
          break;
        case 2:
          FUN_0098f140(in_ECX,(short)in_ECX[0xf] + 10);
          break;
        case 3:
          sVar4 = (short)in_ECX[0xf] + 0xe;
        default:
          FUN_0098f140(in_ECX,sVar4);
        }
      }
      else {
        pwVar10 = pwVar8;
        if (7 < uVar5) {
          pwVar10 = *(wchar_t **)pwVar8;
        }
        pwVar9 = L"SelectTribe";
        do {
          wVar1 = *pwVar10;
          bVar12 = (ushort)wVar1 < (ushort)*pwVar9;
          if (wVar1 != *pwVar9) {
LAB_009918d6:
            iVar7 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
            goto LAB_009918db;
          }
          if (wVar1 == L'\0') break;
          wVar1 = pwVar10[1];
          bVar12 = (ushort)wVar1 < (ushort)pwVar9[1];
          if (wVar1 != pwVar9[1]) goto LAB_009918d6;
          pwVar10 = pwVar10 + 2;
          pwVar9 = pwVar9 + 2;
        } while (wVar1 != L'\0');
        iVar7 = 0;
LAB_009918db:
        if (iVar7 == 0) {
          iVar7 = local_58 - local_5c >> 0x1f;
          iVar11 = (local_58 - local_5c) / 0x1c + iVar7;
          if (iVar11 == iVar7) goto LAB_009917b9;
          if (iVar11 == iVar7) {
            in_ECX[0xe] = 0;
          }
          else if (*(uint *)(local_5c + 0x18) < 8) {
            iVar7 = FUN_00634f4d(local_5c + 4);
            in_ECX[0xe] = iVar7;
          }
          else {
            iVar7 = FUN_00634f4d(*(undefined4 *)(local_5c + 4));
            in_ECX[0xe] = iVar7;
          }
        }
        else {
          pwVar10 = pwVar8;
          if (7 < uVar5) {
            pwVar10 = *(wchar_t **)pwVar8;
          }
          pwVar9 = L"SelectSkill";
          do {
            wVar1 = *pwVar10;
            bVar12 = (ushort)wVar1 < (ushort)*pwVar9;
            if (wVar1 != *pwVar9) {
LAB_00991986:
              iVar7 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
              goto LAB_0099198b;
            }
            if (wVar1 == L'\0') break;
            wVar1 = pwVar10[1];
            bVar12 = (ushort)wVar1 < (ushort)pwVar9[1];
            if (wVar1 != pwVar9[1]) goto LAB_00991986;
            pwVar10 = pwVar10 + 2;
            pwVar9 = pwVar9 + 2;
          } while (wVar1 != L'\0');
          iVar7 = 0;
LAB_0099198b:
          if (iVar7 == 0) {
            cVar3 = FUN_004014c0();
            if (cVar3 != '\0') goto LAB_009917b9;
            FUN_00990d30(in_ECX,local_6c);
          }
          else {
            pwVar10 = pwVar8;
            if (7 < uVar5) {
              pwVar10 = *(wchar_t **)pwVar8;
            }
            pwVar9 = L"FindHalidom";
            do {
              wVar1 = *pwVar10;
              bVar12 = (ushort)wVar1 < (ushort)*pwVar9;
              if (wVar1 != *pwVar9) {
LAB_009919ea:
                iVar7 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
                goto LAB_009919ef;
              }
              if (wVar1 == L'\0') break;
              wVar1 = pwVar10[1];
              bVar12 = (ushort)wVar1 < (ushort)pwVar9[1];
              if (wVar1 != pwVar9[1]) goto LAB_009919ea;
              pwVar10 = pwVar10 + 2;
              pwVar9 = pwVar9 + 2;
            } while (wVar1 != L'\0');
            iVar7 = 0;
LAB_009919ef:
            if (iVar7 == 0) {
              if ((uint)((local_68 - local_6c) / 0x1c) < 2) goto LAB_009917b9;
              uVar6 = 0;
              cVar3 = FUN_00403810();
              if (cVar3 == '\0') {
                cVar3 = FUN_00403810();
                if (cVar3 == '\0') {
                  cVar3 = FUN_00403810();
                  if (cVar3 != '\0') {
                    uVar6 = 2;
                  }
                }
                else {
                  uVar6 = 1;
                }
              }
              FUN_009904c0(uVar6,local_6c + 0x1c);
            }
            else {
              pwVar10 = pwVar8;
              if (7 < uVar5) {
                pwVar10 = *(wchar_t **)pwVar8;
              }
              pwVar9 = L"OnSkillTooltip";
              do {
                wVar1 = *pwVar10;
                bVar12 = (ushort)wVar1 < (ushort)*pwVar9;
                if (wVar1 != *pwVar9) {
LAB_00991aa6:
                  iVar7 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
                  goto LAB_00991aab;
                }
                if (wVar1 == L'\0') break;
                wVar1 = pwVar10[1];
                bVar12 = (ushort)wVar1 < (ushort)pwVar9[1];
                if (wVar1 != pwVar9[1]) goto LAB_00991aa6;
                pwVar10 = pwVar10 + 2;
                pwVar9 = pwVar9 + 2;
              } while (wVar1 != L'\0');
              iVar7 = 0;
LAB_00991aab:
              if (iVar7 == 0) {
                cVar3 = FUN_004014c0();
                if (cVar3 != '\0') goto LAB_009917b9;
                FUN_0098fd60(in_ECX,local_6c);
              }
              else {
                if (7 < uVar5) {
                  pwVar8 = *(wchar_t **)pwVar8;
                }
                pwVar10 = L"ViewHalidom";
                do {
                  wVar1 = *pwVar8;
                  bVar12 = (ushort)wVar1 < (ushort)*pwVar10;
                  if (wVar1 != *pwVar10) {
LAB_00991b0a:
                    iVar7 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
                    goto LAB_00991b0f;
                  }
                  if (wVar1 == L'\0') break;
                  wVar1 = pwVar8[1];
                  bVar12 = (ushort)wVar1 < (ushort)pwVar10[1];
                  if (wVar1 != pwVar10[1]) goto LAB_00991b0a;
                  pwVar8 = pwVar8 + 2;
                  pwVar10 = pwVar10 + 2;
                } while (wVar1 != L'\0');
                iVar7 = 0;
LAB_00991b0f:
                if (iVar7 == 0) {
                  if ((uint)((local_68 - local_6c) / 0x1c) < 2) goto LAB_009917b9;
                  uVar6 = 0;
                  cVar3 = FUN_00403810();
                  if (cVar3 == '\0') {
                    cVar3 = FUN_00403810();
                    if (cVar3 == '\0') {
                      cVar3 = FUN_00403810();
                      if (cVar3 != '\0') {
                        uVar6 = 2;
                      }
                    }
                    else {
                      uVar6 = 1;
                    }
                  }
                  FUN_0098f3c0(uVar6,local_6c + 0x1c);
                }
              }
            }
          }
        }
      }
    }
  }
  local_c = CONCAT31(local_c._1_3_,4);
  if (local_6c != 0) {
    FUN_00405450(in_ECX);
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_6c = 0;
  local_68 = 0;
  local_64 = 0;
  local_c = 0xffffffff;
  if (local_5c == 0) {
    ExceptionList = local_14;
    return;
  }
  FUN_00405450(in_ECX);
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
00991530 : PUSH EBP
00991531 : MOV EBP,ESP
00991533 : AND ESP,0xfffffff8
00991536 : PUSH -0x1
00991538 : PUSH 0xb68fa2
0099153d : MOV EAX,FS:[0x0]
00991543 : PUSH EAX
00991544 : SUB ESP,0x60
00991547 : PUSH EBX
00991548 : PUSH ESI
00991549 : PUSH EDI
0099154a : MOV EAX,[0x00d66fa0]
0099154f : XOR EAX,ESP
00991551 : PUSH EAX
00991552 : LEA EAX,[ESP + 0x70]
00991556 : MOV FS:[0x0],EAX
0099155c : MOV dword ptr [ESP + 0x10],ECX
00991560 : PUSH 0x1
00991562 : XOR EAX,EAX
00991564 : MOV EDI,0x7
00991569 : XOR ESI,ESI
0099156b : PUSH 0xc84f3c
00991570 : LEA ECX,[ESP + 0x3c]
00991574 : MOV dword ptr [ESP + 0x54],EDI
00991578 : MOV dword ptr [ESP + 0x50],ESI
0099157c : MOV word ptr [ESP + 0x40],AX
00991581 : CALL 0x00406360
00991586 : MOV dword ptr [ESP + 0x78],ESI
0099158a : MOV EBX,dword ptr [EBP + 0xc]
0099158d : PUSH EBX
0099158e : LEA ESI,[ESP + 0x54]
00991592 : CALL 0x00404350
00991597 : ADD ESP,0x4
0099159a : MOV byte ptr [ESP + 0x78],0x1
0099159f : PUSH 0x0
009915a1 : LEA ECX,[ESP + 0x38]
009915a5 : PUSH ECX
009915a6 : PUSH EAX
009915a7 : LEA EDX,[ESP + 0x30]
009915ab : PUSH EDX
009915ac : CALL 0x0070cd60
009915b1 : ADD ESP,0x10
009915b4 : MOV byte ptr [ESP + 0x78],0x3
009915b9 : CMP dword ptr [ESP + 0x68],0x8
009915be : JC 0x009915c9
009915c0 : MOV ECX,dword ptr [ESP + 0x54]
009915c4 : CALL 0x006f04e0
009915c9 : XOR EAX,EAX
009915cb : MOV dword ptr [ESP + 0x68],EDI
009915cf : MOV dword ptr [ESP + 0x64],0x0
009915d7 : MOV word ptr [ESP + 0x54],AX
009915dc : MOV byte ptr [ESP + 0x78],0x4
009915e1 : CMP dword ptr [ESP + 0x4c],0x8
009915e6 : JC 0x009915f1
009915e8 : MOV ECX,dword ptr [ESP + 0x38]
009915ec : CALL 0x006f04e0
009915f1 : XOR ECX,ECX
009915f3 : XOR EAX,EAX
009915f5 : PUSH 0x1
009915f7 : MOV word ptr [ESP + 0x3c],CX
009915fc : XOR EDX,EDX
009915fe : PUSH 0xc84f40
00991603 : LEA ECX,[ESP + 0x58]
00991607 : MOV dword ptr [ESP + 0x54],EDI
0099160b : MOV dword ptr [ESP + 0x50],EAX
0099160f : MOV dword ptr [ESP + 0x70],EDI
00991613 : MOV dword ptr [ESP + 0x6c],EAX
00991617 : MOV word ptr [ESP + 0x5c],DX
0099161c : CALL 0x00406360
00991621 : MOV byte ptr [ESP + 0x78],0x5
00991626 : PUSH EBX
00991627 : LEA ESI,[ESP + 0x38]
0099162b : CALL 0x00403dd0
00991630 : ADD ESP,0x4
00991633 : MOV byte ptr [ESP + 0x78],0x6
00991638 : PUSH 0x0
0099163a : LEA ECX,[ESP + 0x54]
0099163e : PUSH ECX
0099163f : PUSH EAX
00991640 : LEA EDX,[ESP + 0x20]
00991644 : PUSH EDX
00991645 : CALL 0x0070cd60
0099164a : ADD ESP,0x10
0099164d : MOV byte ptr [ESP + 0x78],0x8
00991652 : CMP dword ptr [ESP + 0x4c],0x8
00991657 : JC 0x00991662
00991659 : MOV ECX,dword ptr [ESP + 0x38]
0099165d : CALL 0x006f04e0
00991662 : XOR EBX,EBX
00991664 : XOR EAX,EAX
00991666 : MOV dword ptr [ESP + 0x4c],EDI
0099166a : MOV dword ptr [ESP + 0x48],EBX
0099166e : MOV word ptr [ESP + 0x38],AX
00991673 : MOV byte ptr [ESP + 0x78],0x9
00991678 : CMP dword ptr [ESP + 0x68],0x8
0099167d : JC 0x00991688
0099167f : MOV ECX,dword ptr [ESP + 0x54]
00991683 : CALL 0x006f04e0
00991688 : MOV EAX,dword ptr [EBP + 0x8]
0099168b : MOV dword ptr [ESP + 0x68],EDI
0099168f : MOV EDI,dword ptr [EAX + 0x18]
00991692 : XOR ECX,ECX
00991694 : MOV dword ptr [ESP + 0x64],EBX
00991698 : MOV word ptr [ESP + 0x54],CX
0099169d : LEA ESI,[EAX + 0x4]
009916a0 : CMP EDI,0x8
009916a3 : JC 0x009916a9
009916a5 : MOV EAX,dword ptr [ESI]
009916a7 : JMP 0x009916ab
009916a9 : MOV EAX,ESI
009916ab : MOV ECX,0xc84f44
009916b0 : MOV DX,word ptr [EAX]
009916b3 : CMP DX,word ptr [ECX]
009916b6 : JNZ 0x009916d6
009916b8 : CMP DX,BX
009916bb : JZ 0x009916d2
009916bd : MOV DX,word ptr [EAX + 0x2]
009916c1 : CMP DX,word ptr [ECX + 0x2]
009916c5 : JNZ 0x009916d6
009916c7 : ADD EAX,0x4
009916ca : ADD ECX,0x4
009916cd : CMP DX,BX
009916d0 : JNZ 0x009916b0
009916d2 : XOR EAX,EAX
009916d4 : JMP 0x009916db
009916d6 : SBB EAX,EAX
009916d8 : SBB EAX,-0x1
009916db : CMP EAX,EBX
009916dd : JNZ 0x00991708
009916df : MOV EDX,dword ptr [0x0172491c]
009916e5 : MOV EAX,dword ptr [EDX + 0x17c]
009916eb : MOV EDI,dword ptr [EAX + 0x16d8]
009916f1 : MOV ESI,dword ptr [ESP + 0x10]
009916f5 : MOV EAX,EDI
009916f7 : CALL 0x0098e240
009916fc : PUSH EDI
009916fd : PUSH ESI
009916fe : CALL 0x0098f140
00991703 : JMP 0x00991b8b
00991708 : CMP EDI,0x8
0099170b : JC 0x00991711
0099170d : MOV EAX,dword ptr [ESI]
0099170f : JMP 0x00991713
00991711 : MOV EAX,ESI
00991713 : MOV ECX,0xc84f54
00991718 : MOV DX,word ptr [EAX]
0099171b : CMP DX,word ptr [ECX]
0099171e : JNZ 0x0099173e
00991720 : CMP DX,BX
00991723 : JZ 0x0099173a
00991725 : MOV DX,word ptr [EAX + 0x2]
00991729 : CMP DX,word ptr [ECX + 0x2]
0099172d : JNZ 0x0099173e
0099172f : ADD EAX,0x4
00991732 : ADD ECX,0x4
00991735 : CMP DX,BX
00991738 : JNZ 0x00991718
0099173a : XOR EAX,EAX
0099173c : JMP 0x00991743
0099173e : SBB EAX,EAX
00991740 : SBB EAX,-0x1
00991743 : CMP EAX,EBX
00991745 : JNZ 0x00991757
00991747 : MOV ECX,dword ptr [ESP + 0x10]
0099174b : MOV EAX,dword ptr [ECX]
0099174d : MOV EDX,dword ptr [EAX + 0x20]
00991750 : CALL EDX
00991752 : JMP 0x00991b8b
00991757 : CMP EDI,0x8
0099175a : JC 0x00991760
0099175c : MOV EAX,dword ptr [ESI]
0099175e : JMP 0x00991762
00991760 : MOV EAX,ESI
00991762 : MOV ECX,0xc84f60
00991767 : MOV DX,word ptr [EAX]
0099176a : CMP DX,word ptr [ECX]
0099176d : JNZ 0x0099178d
0099176f : CMP DX,BX
00991772 : JZ 0x00991789
00991774 : MOV DX,word ptr [EAX + 0x2]
00991778 : CMP DX,word ptr [ECX + 0x2]
0099177c : JNZ 0x0099178d
0099177e : ADD EAX,0x4
00991781 : ADD ECX,0x4
00991784 : CMP DX,BX
00991787 : JNZ 0x00991767
00991789 : XOR EAX,EAX
0099178b : JMP 0x00991792
0099178d : SBB EAX,EAX
0099178f : SBB EAX,-0x1
00991792 : CMP EAX,EBX
00991794 : JNZ 0x00991899
0099179a : MOV ECX,dword ptr [ESP + 0x2c]
0099179e : MOV ESI,dword ptr [ESP + 0x28]
009917a2 : SUB ECX,ESI
009917a4 : MOV EAX,0x92492493
009917a9 : IMUL ECX
009917ab : ADD EDX,ECX
009917ad : SAR EDX,0x4
009917b0 : MOV EAX,EDX
009917b2 : SHR EAX,0x1f
009917b5 : ADD EAX,EDX
009917b7 : JNZ 0x009917ed
009917b9 : MOV byte ptr [ESP + 0x78],0x4
009917be : LEA ESI,[ESP + 0x14]
009917c2 : CALL 0x004042c0
009917c7 : MOV dword ptr [ESP + 0x78],0xffffffff
009917cf : LEA ESI,[ESP + 0x24]
009917d3 : CALL 0x004042c0
009917d8 : MOV ECX,dword ptr [ESP + 0x70]
009917dc : MOV dword ptr FS:[0x0],ECX
009917e3 : POP ECX
009917e4 : POP EDI
009917e5 : POP ESI
009917e6 : POP EBX
009917e7 : MOV ESP,EBP
009917e9 : POP EBP
009917ea : RET 0x8
009917ed : CMP EAX,EBX
009917ef : JBE 0x00991813
009917f1 : CMP dword ptr [ESI + 0x18],0x8
009917f5 : JC 0x00991805
009917f7 : MOV ESI,dword ptr [ESI + 0x4]
009917fa : PUSH ESI
009917fb : CALL 0x00634f4d
00991800 : ADD ESP,0x4
00991803 : JMP 0x00991815
00991805 : ADD ESI,0x4
00991808 : PUSH ESI
00991809 : CALL 0x00634f4d
0099180e : ADD ESP,0x4
00991811 : JMP 0x00991815
00991813 : XOR EAX,EAX
00991815 : MOV EDX,dword ptr [ESP + 0x10]
00991819 : MOV ECX,dword ptr [EDX + 0x38]
0099181c : MOV dword ptr [EDX + 0x3c],EAX
0099181f : MOV EAX,[0x0172491c]
00991824 : MOV EAX,dword ptr [EAX + 0x17c]
0099182a : MOVZX EAX,word ptr [EAX + 0x16d8]
00991831 : CMP ECX,0x3
00991834 : JA 0x0099188d
00991836 : JMP dword ptr [ECX*0x4 + 0x991c0c]
0099183d : MOV CX,word ptr [EDX + 0x3c]
00991841 : ADD CX,0x2
00991845 : MOVZX EAX,CX
00991848 : PUSH EAX
00991849 : PUSH EDX
0099184a : CALL 0x0098f140
0099184f : JMP 0x00991b8b
00991854 : MOV AX,word ptr [EDX + 0x3c]
00991858 : ADD AX,0x6
0099185c : MOVZX EAX,AX
0099185f : PUSH EAX
00991860 : PUSH EDX
00991861 : CALL 0x0098f140
00991866 : JMP 0x00991b8b
0099186b : MOV CX,word ptr [EDX + 0x3c]
0099186f : ADD CX,0xa
00991873 : MOVZX EAX,CX
00991876 : PUSH EAX
00991877 : PUSH EDX
00991878 : CALL 0x0098f140
0099187d : JMP 0x00991b8b
00991882 : MOV AX,word ptr [EDX + 0x3c]
00991886 : ADD AX,0xe
0099188a : MOVZX EAX,AX
0099188d : PUSH EAX
0099188e : PUSH EDX
0099188f : CALL 0x0098f140
00991894 : JMP 0x00991b8b
00991899 : CMP EDI,0x8
0099189c : JC 0x009918a2
0099189e : MOV EAX,dword ptr [ESI]
009918a0 : JMP 0x009918a4
009918a2 : MOV EAX,ESI
009918a4 : MOV ECX,0xc84f74
009918a9 : LEA ESP,[ESP]
009918b0 : MOV DX,word ptr [EAX]
009918b3 : CMP DX,word ptr [ECX]
009918b6 : JNZ 0x009918d6
009918b8 : CMP DX,BX
009918bb : JZ 0x009918d2
009918bd : MOV DX,word ptr [EAX + 0x2]
009918c1 : CMP DX,word ptr [ECX + 0x2]
009918c5 : JNZ 0x009918d6
009918c7 : ADD EAX,0x4
009918ca : ADD ECX,0x4
009918cd : CMP DX,BX
009918d0 : JNZ 0x009918b0
009918d2 : XOR EAX,EAX
009918d4 : JMP 0x009918db
009918d6 : SBB EAX,EAX
009918d8 : SBB EAX,-0x1
009918db : CMP EAX,EBX
009918dd : JNZ 0x0099194a
009918df : MOV ECX,dword ptr [ESP + 0x2c]
009918e3 : MOV ESI,dword ptr [ESP + 0x28]
009918e7 : SUB ECX,ESI
009918e9 : MOV EAX,0x92492493
009918ee : IMUL ECX
009918f0 : ADD EDX,ECX
009918f2 : SAR EDX,0x4
009918f5 : MOV EAX,EDX
009918f7 : SHR EAX,0x1f
009918fa : ADD EAX,EDX
009918fc : JZ 0x009917b9
00991902 : CMP EAX,EBX
00991904 : JBE 0x0099193c
00991906 : CMP dword ptr [ESI + 0x18],0x8
0099190a : JC 0x00991924
0099190c : MOV ESI,dword ptr [ESI + 0x4]
0099190f : PUSH ESI
00991910 : CALL 0x00634f4d
00991915 : MOV ECX,dword ptr [ESP + 0x14]
00991919 : ADD ESP,0x4
0099191c : MOV dword ptr [ECX + 0x38],EAX
0099191f : JMP 0x00991b8b
00991924 : ADD ESI,0x4
00991927 : PUSH ESI
00991928 : CALL 0x00634f4d
0099192d : MOV ECX,dword ptr [ESP + 0x14]
00991931 : ADD ESP,0x4
00991934 : MOV dword ptr [ECX + 0x38],EAX
00991937 : JMP 0x00991b8b
0099193c : MOV ECX,dword ptr [ESP + 0x10]
00991940 : XOR EAX,EAX
00991942 : MOV dword ptr [ECX + 0x38],EAX
00991945 : JMP 0x00991b8b
0099194a : CMP EDI,0x8
0099194d : JC 0x00991953
0099194f : MOV EAX,dword ptr [ESI]
00991951 : JMP 0x00991955
00991953 : MOV EAX,ESI
00991955 : MOV ECX,0xc84f8c
0099195a : LEA EBX,[EBX]
00991960 : MOV DX,word ptr [EAX]
00991963 : CMP DX,word ptr [ECX]
00991966 : JNZ 0x00991986
00991968 : CMP DX,BX
0099196b : JZ 0x00991982
0099196d : MOV DX,word ptr [EAX + 0x2]
00991971 : CMP DX,word ptr [ECX + 0x2]
00991975 : JNZ 0x00991986
00991977 : ADD EAX,0x4
0099197a : ADD ECX,0x4
0099197d : CMP DX,BX
00991980 : JNZ 0x00991960
00991982 : XOR EAX,EAX
00991984 : JMP 0x0099198b
00991986 : SBB EAX,EAX
00991988 : SBB EAX,-0x1
0099198b : CMP EAX,EBX
0099198d : JNZ 0x009919b4
0099198f : LEA EAX,[ESP + 0x14]
00991993 : CALL 0x004014c0
00991998 : TEST AL,AL
0099199a : JNZ 0x009917b9
009919a0 : MOV EDX,dword ptr [ESP + 0x18]
009919a4 : MOV EAX,dword ptr [ESP + 0x10]
009919a8 : PUSH EDX
009919a9 : PUSH EAX
009919aa : CALL 0x00990d30
009919af : JMP 0x00991b8b
009919b4 : CMP EDI,0x8
009919b7 : JC 0x009919bd
009919b9 : MOV EAX,dword ptr [ESI]
009919bb : JMP 0x009919bf
009919bd : MOV EAX,ESI
009919bf : MOV ECX,0xc84fa4
009919c4 : MOV DX,word ptr [EAX]
009919c7 : CMP DX,word ptr [ECX]
009919ca : JNZ 0x009919ea
009919cc : CMP DX,BX
009919cf : JZ 0x009919e6
009919d1 : MOV DX,word ptr [EAX + 0x2]
009919d5 : CMP DX,word ptr [ECX + 0x2]
009919d9 : JNZ 0x009919ea
009919db : ADD EAX,0x4
009919de : ADD ECX,0x4
009919e1 : CMP DX,BX
009919e4 : JNZ 0x009919c4
009919e6 : XOR EAX,EAX
009919e8 : JMP 0x009919ef
009919ea : SBB EAX,EAX
009919ec : SBB EAX,-0x1
009919ef : CMP EAX,EBX
009919f1 : JNZ 0x00991a70
009919f3 : MOV ESI,dword ptr [ESP + 0x1c]
009919f7 : MOV ECX,dword ptr [ESP + 0x18]
009919fb : SUB ESI,ECX
009919fd : MOV EAX,0x92492493
00991a02 : IMUL ESI
00991a04 : ADD EDX,ESI
00991a06 : SAR EDX,0x4
00991a09 : MOV EAX,EDX
00991a0b : SHR EAX,0x1f
00991a0e : ADD EAX,EDX
00991a10 : CMP EAX,0x2
00991a13 : JC 0x009917b9
00991a19 : MOV ESI,0xc84fbc
00991a1e : XOR EDI,EDI
00991a20 : CALL 0x00403810
00991a25 : TEST AL,AL
00991a27 : JNZ 0x00991a59
00991a29 : MOV ECX,dword ptr [ESP + 0x18]
00991a2d : MOV ESI,0xc84fcc
00991a32 : CALL 0x00403810
00991a37 : TEST AL,AL
00991a39 : JZ 0x00991a42
00991a3b : MOV EDI,0x1
00991a40 : JMP 0x00991a59
00991a42 : MOV ECX,dword ptr [ESP + 0x18]
00991a46 : MOV ESI,0xc84fd8
00991a4b : CALL 0x00403810
00991a50 : TEST AL,AL
00991a52 : JZ 0x00991a59
00991a54 : MOV EDI,0x2
00991a59 : MOV ECX,dword ptr [ESP + 0x18]
00991a5d : ADD ECX,0x1c
00991a60 : PUSH ECX
00991a61 : MOV ECX,dword ptr [ESP + 0x14]
00991a65 : PUSH EDI
00991a66 : CALL 0x009904c0
00991a6b : JMP 0x00991b8b
00991a70 : CMP EDI,0x8
00991a73 : JC 0x00991a79
00991a75 : MOV EAX,dword ptr [ESI]
00991a77 : JMP 0x00991a7b
00991a79 : MOV EAX,ESI
00991a7b : MOV ECX,0xc84fe4
00991a80 : MOV DX,word ptr [EAX]
00991a83 : CMP DX,word ptr [ECX]
00991a86 : JNZ 0x00991aa6
00991a88 : CMP DX,BX
00991a8b : JZ 0x00991aa2
00991a8d : MOV DX,word ptr [EAX + 0x2]
00991a91 : CMP DX,word ptr [ECX + 0x2]
00991a95 : JNZ 0x00991aa6
00991a97 : ADD EAX,0x4
00991a9a : ADD ECX,0x4
00991a9d : CMP DX,BX
00991aa0 : JNZ 0x00991a80
00991aa2 : XOR EAX,EAX
00991aa4 : JMP 0x00991aab
00991aa6 : SBB EAX,EAX
00991aa8 : SBB EAX,-0x1
00991aab : CMP EAX,EBX
00991aad : JNZ 0x00991ad4
00991aaf : LEA EAX,[ESP + 0x14]
00991ab3 : CALL 0x004014c0
00991ab8 : TEST AL,AL
00991aba : JNZ 0x009917b9
00991ac0 : MOV EDX,dword ptr [ESP + 0x18]
00991ac4 : MOV EAX,dword ptr [ESP + 0x10]
00991ac8 : PUSH EDX
00991ac9 : PUSH EAX
00991aca : CALL 0x0098fd60
00991acf : JMP 0x00991b8b
00991ad4 : CMP EDI,0x8
00991ad7 : JC 0x00991add
00991ad9 : MOV EAX,dword ptr [ESI]
00991adb : JMP 0x00991adf
00991add : MOV EAX,ESI
00991adf : MOV ECX,0xc85004
00991ae4 : MOV DX,word ptr [EAX]
00991ae7 : CMP DX,word ptr [ECX]
00991aea : JNZ 0x00991b0a
00991aec : CMP DX,BX
00991aef : JZ 0x00991b06
00991af1 : MOV DX,word ptr [EAX + 0x2]
00991af5 : CMP DX,word ptr [ECX + 0x2]
00991af9 : JNZ 0x00991b0a
00991afb : ADD EAX,0x4
00991afe : ADD ECX,0x4
00991b01 : CMP DX,BX
00991b04 : JNZ 0x00991ae4
00991b06 : XOR EAX,EAX
00991b08 : JMP 0x00991b0f
00991b0a : SBB EAX,EAX
00991b0c : SBB EAX,-0x1
00991b0f : CMP EAX,EBX
00991b11 : JNZ 0x00991b8b
00991b13 : MOV ESI,dword ptr [ESP + 0x1c]
00991b17 : MOV ECX,dword ptr [ESP + 0x18]
00991b1b : SUB ESI,ECX
00991b1d : MOV EAX,0x92492493
00991b22 : IMUL ESI
00991b24 : ADD EDX,ESI
00991b26 : SAR EDX,0x4
00991b29 : MOV EAX,EDX
00991b2b : SHR EAX,0x1f
00991b2e : ADD EAX,EDX
00991b30 : CMP EAX,0x2
00991b33 : JC 0x009917b9
00991b39 : MOV ESI,0xc8501c
00991b3e : XOR EDI,EDI
00991b40 : CALL 0x00403810
00991b45 : TEST AL,AL
00991b47 : JNZ 0x00991b79
00991b49 : MOV ECX,dword ptr [ESP + 0x18]
00991b4d : MOV ESI,0xc8502c
00991b52 : CALL 0x00403810
00991b57 : TEST AL,AL
00991b59 : JZ 0x00991b62
00991b5b : MOV EDI,0x1
00991b60 : JMP 0x00991b79
00991b62 : MOV ECX,dword ptr [ESP + 0x18]
00991b66 : MOV ESI,0xc85038
00991b6b : CALL 0x00403810
00991b70 : TEST AL,AL
00991b72 : JZ 0x00991b79
00991b74 : MOV EDI,0x2
00991b79 : MOV ECX,dword ptr [ESP + 0x18]
00991b7d : ADD ECX,0x1c
00991b80 : PUSH ECX
00991b81 : MOV ECX,dword ptr [ESP + 0x14]
00991b85 : PUSH EDI
00991b86 : CALL 0x0098f3c0
00991b8b : MOV byte ptr [ESP + 0x78],0x4
00991b90 : MOV EAX,dword ptr [ESP + 0x18]
00991b94 : CMP EAX,EBX
00991b96 : JZ 0x00991bb2
00991b98 : MOV EDX,dword ptr [ESP + 0x10]
00991b9c : MOV EDI,dword ptr [ESP + 0x1c]
00991ba0 : PUSH EDX
00991ba1 : CALL 0x00405450
00991ba6 : MOV ECX,dword ptr [ESP + 0x1c]
00991baa : ADD ESP,0x4
00991bad : CALL 0x006f04e0
00991bb2 : MOV dword ptr [ESP + 0x18],EBX
00991bb6 : MOV dword ptr [ESP + 0x1c],EBX
00991bba : MOV dword ptr [ESP + 0x20],EBX
00991bbe : MOV dword ptr [ESP + 0x78],0xffffffff
00991bc6 : MOV EAX,dword ptr [ESP + 0x28]
00991bca : CMP EAX,EBX
00991bcc : JZ 0x00991be8
00991bce : MOV ECX,dword ptr [ESP + 0x10]
00991bd2 : MOV EDI,dword ptr [ESP + 0x2c]
00991bd6 : PUSH ECX
00991bd7 : CALL 0x00405450
00991bdc : MOV ECX,dword ptr [ESP + 0x2c]
00991be0 : ADD ESP,0x4
00991be3 : CALL 0x006f04e0
00991be8 : MOV dword ptr [ESP + 0x28],EBX
00991bec : MOV dword ptr [ESP + 0x2c],EBX
00991bf0 : MOV dword ptr [ESP + 0x30],EBX
00991bf4 : MOV ECX,dword ptr [ESP + 0x70]
00991bf8 : MOV dword ptr FS:[0x0],ECX
00991bff : POP ECX
00991c00 : POP EDI
00991c01 : POP ESI
00991c02 : POP EBX
00991c03 : MOV ESP,EBP
00991c05 : POP EBP
00991c06 : RET 0x8

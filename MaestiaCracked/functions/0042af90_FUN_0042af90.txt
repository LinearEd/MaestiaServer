PROGRAM  : Maestia.exe
FUNCTION : FUN_0042af90
ENTRY    : 0042af90
BODY     : [[0042af90, 0042afe3]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0042af90(void)

{
  wchar_t wVar1;
  wchar_t *_Dest;
  wchar_t *in_ECX;
  ushort *unaff_ESI;
  
  _Dest = (wchar_t *)(unaff_ESI + 2);
  *unaff_ESI = 0;
  *(undefined1 *)(unaff_ESI + 1) = 0x3a;
  *(undefined1 *)((int)unaff_ESI + 3) = 0x5c;
  _wcsncpy(_Dest,in_ECX,0x27);
  unaff_ESI[0x29] = 0;
  do {
    wVar1 = *_Dest;
    _Dest = _Dest + 1;
  } while (wVar1 != L'\0');
  *unaff_ESI = *unaff_ESI ^
               ((short)((int)_Dest - (int)(unaff_ESI + 3) >> 1) * 2 + 6U ^ *unaff_ESI) & 0x1fff;
  return;
}



============================================================
DISASSEMBLY
============================================================
0042af90 : PUSH EDI
0042af91 : PUSH 0x27
0042af93 : PUSH ECX
0042af94 : XOR EAX,EAX
0042af96 : LEA EDI,[ESI + 0x4]
0042af99 : PUSH EDI
0042af9a : MOV word ptr [ESI],AX
0042af9d : MOV byte ptr [ESI + 0x2],0x3a
0042afa1 : MOV byte ptr [ESI + 0x3],0x5c
0042afa5 : CALL 0x00634e39
0042afaa : ADD ESP,0xc
0042afad : XOR EDX,EDX
0042afaf : MOV EAX,EDI
0042afb1 : MOV word ptr [EDI + 0x4e],DX
0042afb5 : LEA EDX,[EAX + 0x2]
0042afb8 : POP EDI
0042afb9 : LEA ESP,[ESP]
0042afc0 : MOV CX,word ptr [EAX]
0042afc3 : ADD EAX,0x2
0042afc6 : TEST CX,CX
0042afc9 : JNZ 0x0042afc0
0042afcb : SUB EAX,EDX
0042afcd : SAR EAX,0x1
0042afcf : LEA EAX,[EAX + EAX*0x1 + 0x6]
0042afd3 : XOR AX,word ptr [ESI]
0042afd6 : MOV ECX,0x1fff
0042afdb : AND AX,CX
0042afde : XOR word ptr [ESI],AX
0042afe1 : MOV EAX,ESI
0042afe3 : RET

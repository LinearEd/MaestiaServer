PROGRAM  : Maestia.exe
FUNCTION : FUN_00542560
ENTRY    : 00542560
BODY     : [[00542560, 00542877] [00542880, 00542f89] [00542f90, 00543292] [005432a0, 00543466] [00543470, 00543677] [00543680, 005438c9] [005438d0, 00543979] [00543980, 00543ec1]]

============================================================
DECOMPILED C CODE
============================================================

undefined4
FUN_00542560(ushort *param_1,int param_2,int *param_3,char param_4,char param_5,int param_6)

{
  short sVar1;
  ushort uVar2;
  char cVar3;
  ushort uVar4;
  int iVar5;
  undefined4 uVar6;
  undefined4 *puVar7;
  GRefCountNTSImpl *this;
  uint uVar8;
  int *piVar9;
  uint uVar10;
  int in_ECX;
  int iVar11;
  short *psVar12;
  undefined ***pppuVar13;
  int iVar14;
  undefined ***pppuVar15;
  uint uVar16;
  undefined4 uVar17;
  undefined4 uVar18;
  int local_3bc;
  undefined4 local_3b4;
  undefined4 local_3b0;
  int local_3ac;
  int local_3a8;
  undefined4 local_3a4;
  int *local_3a0;
  uint local_39c;
  int local_398;
  int *local_394;
  short *local_390;
  int local_38c;
  int local_388;
  undefined4 local_384;
  undefined4 local_380;
  int local_37c;
  undefined4 local_378;
  undefined1 local_372;
  undefined1 local_371;
  undefined4 local_370;
  undefined1 local_36a;
  undefined1 local_369;
  int *local_368;
  undefined4 local_364;
  ushort *local_360;
  ushort *local_35c;
  ushort *local_358;
  uint local_354;
  undefined1 local_350;
  undefined4 local_34c;
  undefined4 local_348;
  undefined4 local_344;
  undefined1 local_340;
  undefined4 local_33c;
  undefined4 local_338;
  undefined4 local_334;
  undefined4 local_330;
  undefined4 local_32c;
  undefined4 local_328;
  undefined4 local_324;
  undefined4 local_320;
  undefined4 local_31c;
  undefined4 local_318;
  undefined4 local_314;
  undefined4 local_310;
  undefined4 local_30c;
  undefined4 local_308;
  int local_304;
  undefined **local_300;
  undefined4 local_2fc;
  undefined1 local_2f8 [4];
  undefined4 local_2f4;
  undefined1 local_2f0 [8];
  int local_2e8;
  int *local_2e4;
  undefined4 local_2e0;
  undefined2 local_2dc;
  undefined2 local_2da;
  undefined1 local_2d8;
  uint local_2d6;
  short *local_2d0;
  int local_2cc;
  int local_2c8;
  undefined2 local_2c4 [2];
  undefined4 local_2c0;
  int local_2bc;
  uint local_2b8;
  int local_2b4;
  undefined4 local_2b0;
  undefined4 local_2ac;
  undefined2 local_2a8 [2];
  undefined4 local_2a4;
  undefined4 local_2a0;
  uint local_29c;
  undefined4 local_298;
  int local_294;
  int local_290;
  int local_28c;
  int local_288;
  undefined **local_284;
  undefined4 local_280;
  int local_26c;
  int *local_268;
  undefined4 local_264;
  undefined2 local_260;
  undefined2 local_25e;
  undefined1 local_25c;
  undefined2 local_25a;
  undefined **local_258 [6];
  undefined1 local_240 [44];
  undefined1 local_214 [24];
  undefined1 local_1fc [24];
  undefined1 local_1e4 [24];
  undefined1 local_1cc [84];
  undefined **local_178 [6];
  undefined1 local_160 [44];
  undefined1 local_134 [44];
  undefined1 local_108 [44];
  undefined1 local_dc [44];
  undefined1 local_b0 [44];
  undefined1 local_84 [44];
  undefined1 local_58 [88];
  
  local_3a0 = (int *)FUN_00515dd0(in_ECX);
  local_358 = param_1 + param_2;
  local_3ac = 0;
  local_3a8 = 0;
  local_3a4 = 0;
  local_364 = 0;
  local_35c = param_1;
  local_354 = 0;
  local_350 = 0;
  local_360 = param_1;
  if (param_1 < local_358) {
    local_354 = (uint)*param_1;
    local_35c = param_1 + 1;
  }
  local_340 = param_5 != '\0';
  local_34c = 0;
  local_348 = 0;
  local_344 = 0;
  iVar5 = *(int *)(in_ECX + 0x1c);
  local_2fc = 1;
  local_300 = &PTR_FUN_00b86530;
  local_37c = 0;
  local_398 = 0;
  local_36a = 0;
  local_394 = local_3a0;
  local_368 = local_3a0;
  FUN_0051c380(iVar5 + 8,*(undefined4 *)(iVar5 + 0xc));
  local_371 = 0;
  FUN_0051c380(iVar5 + 0x10,*(undefined4 *)(iVar5 + 0xc));
  if (*(int *)(iVar5 + 0x18) != 0) {
    piVar9 = (int *)(*(int *)(iVar5 + 0x18) + 4);
    *piVar9 = *piVar9 + 1;
  }
  local_2e8 = *(int *)(iVar5 + 0x18);
  piVar9 = *(int **)(iVar5 + 0x1c);
  if (piVar9 != (int *)0x0) {
    *piVar9 = *piVar9 + 1;
  }
  local_2e4 = *(int **)(iVar5 + 0x1c);
  local_2e0 = *(undefined4 *)(iVar5 + 0x20);
  local_2dc = *(undefined2 *)(iVar5 + 0x24);
  local_2da = *(undefined2 *)(iVar5 + 0x26);
  local_2d8 = *(undefined1 *)(iVar5 + 0x28);
  local_2d6 = CONCAT22(local_2d6._2_2_,*(undefined2 *)(iVar5 + 0x2a));
  FUN_0053c1c0(*(undefined4 *)(in_ECX + 0x18));
  if (((local_2d6 & 0x100) == 0) || (iVar5 = FUN_0051b1a0(), iVar5 == 0)) {
    FUN_0055e660(&DAT_00cca874,0xffffffff);
    FUN_0053f7c0(&local_300);
  }
  local_280 = 1;
  local_284 = &PTR_FUN_00b86530;
  local_372 = 0;
  FUN_0051c380(local_2f8,local_2f4);
  local_369 = 0;
  FUN_0051c380(local_2f0,local_2f4);
  if (local_2e8 != 0) {
    *(int *)(local_2e8 + 4) = *(int *)(local_2e8 + 4) + 1;
  }
  local_26c = local_2e8;
  if (local_2e4 != (int *)0x0) {
    *local_2e4 = *local_2e4 + 1;
  }
  local_268 = local_2e4;
  local_260 = local_2dc;
  local_264 = local_2e0;
  local_25e = local_2da;
  local_25c = local_2d8;
  local_25a = (undefined2)local_2d6;
  iVar5 = FUN_0053d5c0();
  if (iVar5 == 0x8000) {
LAB_00542806:
    FUN_0053f7c0(&local_300);
    if (*(int *)(in_ECX + 8) == 0) {
      uVar6 = FUN_00515dd0(in_ECX);
      puVar7 = (undefined4 *)FUN_00515840(0x50,0);
      if (puVar7 == (undefined4 *)0x0) {
        puVar7 = (undefined4 *)0x0;
      }
      else {
        *puVar7 = &PTR_FUN_00cd3f2c;
        puVar7[1] = 1;
        *puVar7 = &PTR_FUN_00b8670c;
        puVar7[2] = 0;
        puVar7[3] = 0;
        puVar7[6] = 1;
        puVar7[4] = 100;
        puVar7[5] = 100;
        puVar7[7] = uVar6;
        FUN_00504200(uVar6);
        *(undefined1 *)(puVar7 + 0x13) = 0;
      }
      if (*(GRefCountNTSImpl **)(in_ECX + 8) != (GRefCountNTSImpl *)0x0) {
        GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(in_ECX + 8));
      }
      *(undefined4 **)(in_ECX + 8) = puVar7;
    }
    pppuVar15 = local_258;
  }
  else {
    do {
      if (iVar5 == 1) break;
      if (4 < iVar5) {
        if (iVar5 != 0x8005) goto LAB_00542eaa;
LAB_00543a3d:
        puVar7 = (undefined4 *)0x0;
        local_370 = 0;
        local_378 = 0;
        if (iVar5 == 4) {
          if (local_3a8 != 0) {
            puVar7 = (undefined4 *)(local_3a8 * 0x54 + -0x54 + local_3ac);
          }
          FUN_0053dbc0(&local_370,&local_378);
        }
        else {
          if (((local_37c != 0) && (*(char *)(local_37c + 9) != '\0')) || (local_3a8 == 0))
          goto LAB_00542eaa;
          iVar11 = local_3a8 * 0x54;
          local_370 = *(undefined4 *)(iVar11 + -0x54 + local_3ac);
          local_378 = *(undefined4 *)(iVar11 + -0x50 + local_3ac);
          puVar7 = (undefined4 *)(iVar11 + -0x54 + local_3ac);
        }
        uVar17 = local_370;
        uVar6 = local_378;
        if (puVar7 != (undefined4 *)0x0) {
          iVar11 = FUN_0053c030(local_370,local_378,*puVar7,puVar7[1]);
          if (iVar11 == 0) {
LAB_00543b67:
            uVar2 = *(ushort *)((int)puVar7 + 0x52);
            iVar11 = puVar7[2];
            iVar14 = puVar7[3];
            uVar4 = uVar2 >> 0xb & 3;
            local_37c = iVar11;
            FUN_0053f990(local_3a8 + -1);
            if (iVar11 == 0) {
              if ((param_6 != 0) && ((uVar2 & 0x100) != 0)) {
                if (uVar4 == 1) goto LAB_00543bbd;
                if (uVar4 == 2) {
                  iVar5 = FUN_0053c470();
                  if (param_4 != '\0') {
                    uVar18 = 1;
                    uVar17 = 1;
                    uVar6 = FUN_0053b3c0(1,1);
                    FUN_00541fd0(uVar6,uVar17,uVar18);
                  }
                  FUN_00542320(iVar14,iVar5 - iVar14);
                }
              }
            }
            else if ((*(int *)(iVar11 + 4) == 6) ||
                    ((*(int *)(iVar11 + 4) == 7 && (local_398 = local_398 + -1, iVar5 != 0x8005))))
            {
LAB_00543bbd:
              if (param_4 != '\0') {
                uVar18 = 1;
                uVar17 = 1;
                uVar6 = FUN_0053b3c0(1,1);
                FUN_00541fd0(uVar6,uVar17,uVar18);
              }
            }
          }
          else {
            iVar11 = FUN_0053c670(uVar17,uVar6,&PTR_DAT_00b8bc88,0xd);
            if ((((iVar11 != 0) && (local_398 != 0)) &&
                ((*(int *)(iVar11 + 4) == 7 || (*(int *)(iVar11 + 4) == 6)))) && (local_3a8 != 0)) {
              do {
                iVar14 = *(int *)(local_3a8 * 0x54 + local_3ac + -0x4c);
                if ((iVar14 != 0) && (*(int *)(iVar11 + 4) == *(int *)(iVar14 + 4))) {
                  if (local_3a8 != 0) {
                    puVar7 = (undefined4 *)(local_3a8 * 0x54 + -0x54 + local_3ac);
                    goto LAB_00543b67;
                  }
                  break;
                }
                FUN_0053f990(local_3a8 + -1);
              } while (local_3a8 != 0);
              goto switchD_00542f57_caseD_2;
            }
          }
        }
        goto LAB_00542eaa;
      }
      if (iVar5 == 4) goto LAB_00543a3d;
      if (iVar5 != 2) {
        if (((iVar5 == 3) &&
            (cVar3 = FUN_0053dc30(&local_2d0,&local_29c), uVar10 = local_29c, psVar12 = local_2d0,
            cVar3 != '\0')) && (local_29c != 0)) {
          if (((param_5 != '\0') && (local_29c < 2)) && (*local_2d0 == 0x20)) {
            FUN_0053c2b0();
            iVar5 = FUN_0053b4b0();
            if (iVar5 == 0) goto LAB_00542eaa;
          }
          if (local_3a8 == 0) {
            FUN_00541ff0(psVar12,uVar10,1);
          }
          else {
            iVar11 = local_3a8 * 0x54 + -0x54 + local_3ac;
            iVar5 = iVar11 + 0x10;
            FUN_00541ed0(psVar12,uVar10,iVar5,iVar11 + 0x3c);
            FUN_00504700(iVar5);
          }
        }
        goto LAB_00542eaa;
      }
      FUN_0053db30(&local_380,&local_384);
      uVar17 = local_380;
      uVar6 = local_384;
      iVar5 = FUN_0053c670(local_380,local_384,&PTR_DAT_00b8bc88,0xd);
      iVar11 = local_3a8 + -1;
      local_37c = iVar5;
      if ((iVar5 != 0) && (*(char *)(iVar5 + 9) != '\0')) {
        iVar5 = *(int *)(iVar5 + 4);
        if (iVar5 != 2) {
          if (iVar5 == 5) {
            if (param_3 != (int *)0x0) {
              uVar6 = FUN_0053ba30(local_394);
              FUN_0053f4a0(uVar6);
              FUN_00502110();
              puVar7 = (undefined4 *)(param_3[1] * 0x2c + -0x2c + *param_3);
              iVar5 = FUN_0053c2b0();
              if (iVar5 == 0) {
                iVar5 = FUN_00540b60(local_258);
              }
              FUN_00504200(local_2f4);
              puVar7[9] = *(undefined4 *)(iVar5 + 0x20);
              cVar3 = FUN_0053d850(&local_310,&local_314);
              while (cVar3 != '\0') {
                iVar5 = FUN_0053c670(local_310,local_314,&PTR_s_ALIGN_00b8bb40,0x1b);
                if ((iVar5 != 0) && (cVar3 = FUN_0053d910(&local_3b0,&local_3b4), cVar3 != '\0')) {
                  switch(*(undefined4 *)(iVar5 + 4)) {
                  case 0xc:
                    iVar5 = FUN_0053c670(local_3b0,local_3b4,&PTR_s_ALIGN_00b8bb40,0x1b);
                    if (iVar5 != 0) {
                      iVar5 = *(int *)(iVar5 + 4);
                      if (iVar5 == 0xe) {
                        *(undefined1 *)(puVar7 + 10) = 0;
                      }
                      else if (iVar5 == 0x23) {
                        *(undefined1 *)(puVar7 + 10) = 2;
                      }
                      else if (iVar5 == 0x24) {
                        *(undefined1 *)(puVar7 + 10) = 1;
                      }
                    }
                    break;
                  case 0x13:
                    cVar3 = FUN_0053b640(&local_2c8,local_3b0,local_3b4);
                    if ((cVar3 != '\0') && (-1 < local_2c8)) {
                      puVar7[6] = local_2c8 * 0x14;
                    }
                    break;
                  case 0x15:
                    cVar3 = FUN_0053b640(&local_288,local_3b0,local_3b4);
                    if (cVar3 != '\0') {
                      puVar7[8] = local_288 * 0x14;
                    }
                    break;
                  case 0x16:
                    FUN_0051b8a0(local_3b0,local_3b4);
                    break;
                  case 0x1d:
                    FUN_0051b8a0(local_3b0,local_3b4);
                    break;
                  case 0x21:
                    cVar3 = FUN_0053b640(&local_294,local_3b0,local_3b4);
                    if (cVar3 != '\0') {
                      puVar7[7] = local_294 * 0x14;
                    }
                    break;
                  case 0x22:
                    cVar3 = FUN_0053b640(&local_28c,local_3b0,local_3b4);
                    if ((cVar3 != '\0') && (-1 < local_28c)) {
                      puVar7[5] = local_28c * 0x14;
                    }
                  }
                }
                cVar3 = FUN_0053d850(&local_310,&local_314);
              }
              iVar5 = FUN_0053b550(0x50,in_ECX);
              if (iVar5 == 0) {
                this = (GRefCountNTSImpl *)0x0;
              }
              else {
                this = (GRefCountNTSImpl *)FUN_0053c0e0();
              }
              FUN_0053b9c0(this);
              *(undefined4 *)(this + 0x18) = puVar7[5];
              *(undefined4 *)(this + 0x1c) = puVar7[6];
              *(undefined4 *)(this + 0x40) = puVar7[7];
              *(undefined4 *)(this + 0x44) = puVar7[8];
              FUN_0051bc20(puVar7 + 1);
              FUN_0051bc20(puVar7 + 3);
              this[0x4c] = *(GRefCountNTSImpl *)(puVar7 + 10);
              *(int *)(this + 4) = *(int *)(this + 4) + 1;
              if ((GRefCountNTSImpl *)*puVar7 != (GRefCountNTSImpl *)0x0) {
                GRefCountNTSImpl::Release((GRefCountNTSImpl *)*puVar7);
              }
              *puVar7 = this;
              if (iVar11 < 0) {
                pppuVar15 = &local_300;
                pppuVar13 = local_258;
              }
              else {
                iVar5 = iVar11 * 0x54 + local_3ac;
                pppuVar15 = (undefined ***)(iVar5 + 0x10);
                pppuVar13 = (undefined ***)(iVar5 + 0x3c);
              }
              cVar3 = FUN_0050a3a0();
              if (cVar3 != '\0') {
                FUN_0055e700(pppuVar15 + 4);
              }
              FUN_00540fa0(&DAT_00b8bb3c,1,1,local_240,pppuVar13);
              if ((GRefCountNTSImpl *)pppuVar15[6] != (GRefCountNTSImpl *)0x0) {
                GRefCountNTSImpl::Release((GRefCountNTSImpl *)pppuVar15[6]);
              }
              pppuVar15[6] = (undefined **)0x0;
              *(ushort *)((int)pppuVar15 + 0x2a) = *(ushort *)((int)pppuVar15 + 0x2a) | 0x200;
              FUN_0053f7c0(pppuVar15);
              GRefCountNTSImpl::Release(this);
              FUN_00504260();
            }
          }
          else if (iVar5 == 9) {
            FUN_00540fa0(&DAT_00b8bc84,1,1,*(undefined4 *)(in_ECX + 0x1c),
                         *(undefined4 *)(in_ECX + 0x18));
          }
          goto LAB_00542eaa;
        }
        goto LAB_00543bbd;
      }
      uVar18 = FUN_0053c470();
      uVar6 = FUN_0053e1a0(local_394,uVar17,uVar6,iVar5,0);
      FUN_0053f650(local_3a0,local_3a8 + 1);
      iVar14 = local_3ac;
      iVar5 = local_3a8 * 0x54 + -0x54 + local_3ac;
      if (iVar5 != 0) {
        FUN_0053e210(uVar6);
      }
      local_178[0] = &PTR_FUN_00b86064;
      FUN_0055e7c0();
      GRefCountImplCore::~GRefCountImplCore((GRefCountImplCore *)local_178);
      FUN_00504260();
      *(undefined4 *)(iVar5 + 0xc) = uVar18;
      if (iVar11 < 0) {
        FUN_00504700(&local_300);
        pppuVar15 = local_258;
      }
      else {
        iVar14 = iVar11 * 0x54 + iVar14;
        FUN_00504700(iVar14 + 0x10);
        pppuVar15 = (undefined ***)(iVar14 + 0x3c);
      }
      iVar11 = iVar5 + 0x3c;
      FUN_0055ee10(pppuVar15);
      if (local_37c == 0) {
        if ((param_6 != 0) && (iVar5 = FUN_0057df30(0,local_380,local_384), iVar5 != 0)) {
          uVar6 = FUN_0055f330(local_1fc,iVar5 + 0x2c);
          FUN_0055ee10(uVar6);
          FUN_005008c0();
          uVar6 = FUN_0055fca0(local_84,iVar5);
          FUN_00504700(uVar6);
LAB_00542ea1:
          FUN_00504260();
        }
        goto switchD_00542f57_caseD_2;
      }
      switch(*(undefined4 *)(local_37c + 4)) {
      case 0:
        cVar3 = FUN_0053d850(&local_334,&local_308);
        while (cVar3 != '\0') {
          iVar5 = FUN_0053c670(local_334,local_308,&PTR_s_ALIGN_00b8bb40,0x1b);
          if (((iVar5 != 0) && (cVar3 = FUN_0053d910(&local_2a0,&local_2c0), cVar3 != '\0')) &&
             (*(int *)(iVar5 + 4) == 0x14)) {
            FUN_0055e6b0(local_2a0,local_2c0);
            *(byte *)(in_ECX + 0x20) = *(byte *)(in_ECX + 0x20) | 1;
          }
          cVar3 = FUN_0053d850(&local_334,&local_308);
        }
        if (param_6 != 0) {
          iVar5 = FUN_0057dec0(0,&DAT_00b8653c,0xffffffff);
          if (iVar5 != 0) {
            uVar6 = FUN_0055fca0(local_160,iVar5);
            FUN_00504700(uVar6);
            FUN_00504260();
          }
          cVar3 = FUN_0050a3a0();
          if ((cVar3 != '\0') && (iVar5 = FUN_0057dec0(0,"a:link",0xffffffff), iVar5 != 0)) {
            uVar6 = FUN_0055fca0(local_108,iVar5);
            FUN_00504700(uVar6);
            goto LAB_00542ea1;
          }
        }
        break;
      case 1:
        FUN_0055fbc0(1);
        break;
      case 3:
        cVar3 = FUN_0053d850(&local_338,&local_31c);
        while (cVar3 != '\0') {
          iVar11 = FUN_0053c670(local_338,local_31c,&PTR_s_ALIGN_00b8bb40,0x1b);
          if ((iVar11 != 0) && (cVar3 = FUN_0053d910(&local_390,&local_388), cVar3 != '\0')) {
            switch(*(undefined4 *)(iVar11 + 4)) {
            case 0xd:
              if ((*local_390 == 0x23) &&
                 (cVar3 = FUN_0053bd50(&local_298,local_390 + 1,local_388 + -1), cVar3 != '\0')) {
                FUN_0053b2f0(local_298);
              }
              break;
            case 0x11:
              if ((*local_390 == 0x23) &&
                 (cVar3 = FUN_0053bd50(&local_2b8,local_390 + 1,local_388 + -1), cVar3 != '\0')) {
                *(uint *)(iVar5 + 0x30) =
                     *(uint *)(iVar5 + 0x30) ^ (*(uint *)(iVar5 + 0x30) ^ local_2b8) & 0xffffff;
                *(ushort *)(iVar5 + 0x3a) = *(ushort *)(iVar5 + 0x3a) | 1;
              }
              break;
            case 0x12:
              FUN_0055fa20(local_390,local_388);
              break;
            case 0x18:
              cVar3 = FUN_0053b640(&local_290,local_390,local_388);
              if ((cVar3 != '\0') && (-1 < local_290)) {
                if (local_290 == 0) {
                  *(byte *)(iVar5 + 0x38) = *(byte *)(iVar5 + 0x38) & 0xf7;
                  *(ushort *)(iVar5 + 0x3a) = *(ushort *)(iVar5 + 0x3a) & 0xff7f;
                }
                else {
                  FUN_0055e740(1);
                }
              }
              break;
            case 0x1b:
              cVar3 = FUN_0053b6d0(&local_2b0,local_390,local_388);
              if (cVar3 != '\0') {
                FUN_0053b940(local_2b0);
              }
              break;
            case 0x1e:
              cVar3 = FUN_0053b640(&local_304,local_390,local_388);
              if ((cVar3 != '\0') && (-1 < local_304)) {
                FUN_0053b960((float)local_304);
              }
            }
          }
          cVar3 = FUN_0053d850(&local_338,&local_31c);
        }
        break;
      case 4:
        FUN_0055fc30(1);
        break;
      case 6:
        *(ushort *)(iVar5 + 0x52) = *(ushort *)(iVar5 + 0x52) | 0x8080;
        iVar5 = FUN_0053c2b0();
        if (iVar5 == 0) {
          FUN_00540b60(iVar11);
        }
        else {
          iVar5 = FUN_0053b4b0();
          if (iVar5 != 0) {
            if (param_4 != '\0') {
              uVar18 = 1;
              uVar17 = 1;
              uVar6 = FUN_0053b3c0(1,1);
              FUN_00541fd0(uVar6,uVar17,uVar18);
            }
            FUN_0053c2b0();
          }
          iVar5 = iVar11;
          uVar6 = FUN_0053f720(iVar11);
          FUN_0053c230(uVar6,iVar5);
        }
        if ((param_6 == 0) || (iVar5 = FUN_0057df30(0,local_380,local_384), iVar5 == 0)) break;
        uVar6 = FUN_0055f330(local_214,iVar5 + 0x2c);
        FUN_0055ee10(uVar6);
        FUN_005008c0();
        uVar6 = FUN_0055fca0(local_58,iVar5);
        FUN_00504700(uVar6);
        FUN_00504260();
        uVar6 = FUN_0053f720(iVar11);
        FUN_0053c230(uVar6,iVar11);
        goto LAB_00542eaa;
      case 7:
        iVar5 = FUN_0053c2b0();
        if (iVar5 == 0) {
          FUN_00540b60(0);
        }
        else if (local_398 != 0) {
          if (param_4 != '\0') {
            uVar18 = 1;
            uVar17 = 1;
            uVar6 = FUN_0053b3c0(1,1);
            FUN_00541fd0(uVar6,uVar17,uVar18);
          }
          FUN_0053c2b0();
        }
        if ((param_6 != 0) && (iVar5 = FUN_0057df30(0,local_380,local_384), iVar5 != 0)) {
          uVar6 = FUN_0055f330(local_1cc,iVar5 + 0x2c);
          FUN_0055ee10(uVar6);
          FUN_005008c0();
          uVar6 = FUN_0055fca0(local_b0,iVar5);
          FUN_00504700(uVar6);
          FUN_00504260();
        }
        cVar3 = FUN_0053d850(&local_324,&local_33c);
        while (cVar3 != '\0') {
          iVar5 = FUN_0053c670(local_324,local_33c,&PTR_s_ALIGN_00b8bb40,0x1b);
          if ((iVar5 != 0) && (cVar3 = FUN_0053d910(&local_32c,&local_30c), cVar3 != '\0')) {
            if (*(int *)(iVar5 + 4) == 0xc) {
              iVar5 = FUN_0053c670(local_32c,local_30c,&PTR_s_ALIGN_00b8bb40,0x1b);
              if (iVar5 != 0) {
                switch(*(undefined4 *)(iVar5 + 4)) {
                case 0x23:
                  uVar6 = 0;
                  break;
                case 0x24:
                  uVar6 = 1;
                  break;
                case 0x25:
                  uVar6 = 3;
                  break;
                case 0x26:
                  uVar6 = 2;
                  break;
                default:
                  goto switchD_005433b0_default;
                }
                FUN_004ffe10(uVar6);
              }
            }
            else if (((*(int *)(iVar5 + 4) == 0x10) && (param_6 != 0)) &&
                    (iVar5 = FUN_0057df30(1,local_32c,local_30c), iVar5 != 0)) {
              uVar6 = FUN_0055f330(local_1e4,iVar5 + 0x2c);
              FUN_0055ee10(uVar6);
              FUN_005008c0();
              uVar6 = FUN_0055fca0(local_134,iVar5);
              FUN_00504700(uVar6);
              FUN_00504260();
            }
          }
switchD_005433b0_default:
          cVar3 = FUN_0053d850(&local_324,&local_33c);
        }
        iVar5 = FUN_0053b4b0();
        if (iVar5 == 0) {
          uVar6 = FUN_0053f720(iVar11);
          FUN_0053c230(uVar6,iVar11);
        }
        local_398 = local_398 + 1;
        goto LAB_00542eaa;
      case 8:
        cVar3 = FUN_0053d850(&local_318,&local_320);
        while (cVar3 != '\0') {
          iVar5 = FUN_0053c670(local_318,local_320,&PTR_s_ALIGN_00b8bb40,0x1b);
          if ((((iVar5 != 0) && (cVar3 = FUN_0053d910(&local_2a4,&local_2ac), cVar3 != '\0')) &&
              (*(int *)(iVar5 + 4) == 0x10)) &&
             ((param_6 != 0 && (iVar5 = FUN_0057df30(1,local_2a4,local_2ac), iVar5 != 0)))) {
            uVar6 = FUN_0055fca0(local_dc,iVar5);
            FUN_00504700(uVar6);
            FUN_00504260();
          }
          cVar3 = FUN_0053d850(&local_318,&local_320);
        }
        break;
      case 10:
        cVar3 = FUN_0053d850(&local_328,&local_330);
        while (cVar3 != '\0') {
          iVar11 = FUN_0053c670(local_328,local_330,&PTR_s_ALIGN_00b8bb40,0x1b);
          if ((iVar11 != 0) &&
             (cVar3 = FUN_0053d910(&local_38c,&local_39c), iVar14 = local_38c, uVar10 = local_39c,
             cVar3 != '\0')) {
            switch(*(undefined4 *)(iVar11 + 4)) {
            case 0xf:
              cVar3 = FUN_0053b640(&local_2cc,local_38c,local_39c);
              if ((cVar3 != '\0') && (-1 < local_2cc)) {
                *(ushort *)(iVar5 + 0x52) = *(ushort *)(iVar5 + 0x52) | 2;
                *(short *)(iVar5 + 0x48) = (short)local_2cc;
              }
              break;
            case 0x17:
              cVar3 = FUN_0053b640(local_2a8,local_38c,local_39c);
              if (cVar3 != '\0') {
                *(ushort *)(iVar5 + 0x52) = *(ushort *)(iVar5 + 0x52) | 4;
                *(undefined2 *)(iVar5 + 0x4a) = local_2a8[0];
              }
              break;
            case 0x19:
              cVar3 = FUN_0053b640(local_2c4,local_38c,local_39c);
              if (cVar3 != '\0') {
                *(ushort *)(iVar5 + 0x52) = *(ushort *)(iVar5 + 0x52) | 8;
                *(undefined2 *)(iVar5 + 0x4c) = local_2c4[0];
              }
              break;
            case 0x1a:
              cVar3 = FUN_0053b640(&local_2bc,local_38c,local_39c);
              if ((cVar3 != '\0') && (-1 < local_2bc)) {
                *(ushort *)(iVar5 + 0x52) = *(ushort *)(iVar5 + 0x52) | 0x10;
                *(short *)(iVar5 + 0x4e) = (short)local_2bc;
              }
              break;
            case 0x1c:
              cVar3 = FUN_0053b640(&local_2b4,local_38c,local_39c);
              if ((cVar3 != '\0') && (-1 < local_2b4)) {
                *(ushort *)(iVar5 + 0x52) = *(ushort *)(iVar5 + 0x52) | 0x20;
                *(short *)(iVar5 + 0x50) = (short)local_2b4;
              }
              break;
            case 0x20:
              uVar16 = 0;
              if (local_39c != 0) {
                do {
                  cVar3 = FUN_0053b570(*(undefined2 *)(iVar14 + uVar16 * 2));
                  if (cVar3 == '\0') break;
                  uVar16 = uVar16 + 1;
                } while (uVar16 < uVar10);
              }
              if (*(short *)(iVar14 + uVar16 * 2) == 0x5b) {
                uVar16 = uVar16 + 1;
              }
              iVar11 = 1;
              for (uVar8 = uVar16;
                  (uVar8 < uVar10 && (sVar1 = *(short *)(iVar14 + uVar8 * 2), sVar1 != 0x5d));
                  uVar8 = uVar8 + 1) {
                if (sVar1 == 0x2c) {
                  iVar11 = iVar11 + 1;
                }
              }
              FUN_0053b370(iVar11);
              local_3bc = 0;
              if (uVar16 < uVar10) {
LAB_00543890:
                if (*(short *)(iVar14 + uVar16 * 2) != 0x5d) {
                  iVar11 = 0;
                  for (; uVar16 < uVar10; uVar16 = uVar16 + 1) {
                    cVar3 = FUN_0053b5d0(*(undefined2 *)(iVar14 + uVar16 * 2));
                    if (cVar3 == '\0') goto joined_r0x005438c6;
                    iVar11 = (*(ushort *)(iVar14 + uVar16 * 2) - 0x30) + iVar11 * 10;
                  }
                  goto LAB_005438e6;
                }
                break;
              }
            }
          }
switchD_005436da_caseD_10:
          cVar3 = FUN_0053d850(&local_328,&local_330);
        }
        break;
      case 0xb:
        FUN_0055e720(1);
      }
switchD_00542f57_caseD_2:
LAB_00542eaa:
      iVar5 = FUN_0053d5c0();
    } while (iVar5 != 0x8000);
    if (local_3a8 == 0) goto LAB_00542806;
    piVar9 = (int *)(local_3a8 * 0x54 + -0x54 + local_3ac);
    local_394 = piVar9;
    FUN_0053f7c0(piVar9 + 4);
    if (*(int *)(in_ECX + 8) == 0) {
      uVar6 = FUN_00515dd0(in_ECX);
      puVar7 = (undefined4 *)FUN_00515840(0x50,0);
      if (puVar7 == (undefined4 *)0x0) {
        puVar7 = (undefined4 *)0x0;
      }
      else {
        *puVar7 = &PTR_FUN_00cd3f2c;
        puVar7[1] = 1;
        *puVar7 = &PTR_FUN_00b8670c;
        puVar7[2] = 0;
        puVar7[3] = 0;
        puVar7[4] = 100;
        puVar7[5] = 100;
        puVar7[6] = 1;
        puVar7[7] = uVar6;
        FUN_00504200(uVar6);
        *(undefined1 *)(puVar7 + 0x13) = 0;
      }
      if (*(GRefCountNTSImpl **)(in_ECX + 8) != (GRefCountNTSImpl *)0x0) {
        GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(in_ECX + 8));
      }
      *(undefined4 **)(in_ECX + 8) = puVar7;
      piVar9 = local_394;
    }
    pppuVar15 = (undefined ***)(piVar9 + 0xf);
  }
  uVar6 = FUN_00561090(pppuVar15);
  if (*(GRefCountNTSImpl **)(in_ECX + 0x18) != (GRefCountNTSImpl *)0x0) {
    GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(in_ECX + 0x18));
  }
  *(undefined4 *)(in_ECX + 0x18) = uVar6;
  iVar5 = *(int *)(in_ECX + 0x10) + -1;
  if ((((-1 < iVar5) && (iVar5 < *(int *)(in_ECX + 0x10))) &&
      (piVar9 = *(int **)(*(int *)(in_ECX + 0xc) + iVar5 * 4), piVar9 != (int *)0x0)) ||
     (piVar9 = (int *)FUN_00540b60(0), piVar9 != (int *)0x0)) {
    uVar10 = piVar9[1];
    if (uVar10 != 0) {
      if ((*piVar9 == 0) || (uVar10 <= uVar10 - 1)) {
        psVar12 = (short *)0x0;
      }
      else {
        psVar12 = (short *)(*piVar9 + (uVar10 - 1) * 2);
      }
      if ((*psVar12 == 0xd) || (*psVar12 == 10)) goto LAB_00543ceb;
    }
    FUN_005406c0(*(undefined4 *)(in_ECX + 8),*(undefined4 *)(in_ECX + 0x1c));
  }
LAB_00543ceb:
  iVar5 = *(int *)(in_ECX + 0x10) + -1;
  if (((-1 < iVar5) && (iVar5 < *(int *)(in_ECX + 0x10))) &&
     (piVar9 = *(int **)(*(int *)(in_ECX + 0xc) + iVar5 * 4), piVar9 != (int *)0x0)) {
    uVar10 = piVar9[1];
    if (uVar10 != 0) {
      if ((*piVar9 == 0) || (uVar10 <= uVar10 - 1)) {
        psVar12 = (short *)0x0;
      }
      else {
        psVar12 = (short *)(*piVar9 + (uVar10 - 1) * 2);
      }
      if (*psVar12 == 0) {
        uVar10 = uVar10 - 1;
      }
    }
    if (uVar10 == 0) {
      iVar5 = *(int *)(in_ECX + 0x10);
      while ((iVar5 = iVar5 + -1, -1 < iVar5 && (iVar5 < *(int *)(in_ECX + 0x10)))) {
        local_394 = *(int **)(*(int *)(in_ECX + 0xc) + iVar5 * 4);
        uVar10 = local_394[1];
        if (uVar10 != 0) {
          if ((*local_394 == 0) || (uVar10 <= uVar10 - 1)) {
            psVar12 = (short *)0x0;
          }
          else {
            psVar12 = (short *)(*local_394 + (uVar10 - 1) * 2);
          }
          if (*psVar12 == 0) {
            uVar10 = uVar10 - 1;
          }
        }
        if (1 < uVar10) break;
        if (*(int *)(in_ECX + 8) == 0) {
          uVar6 = FUN_00515dd0(in_ECX);
          puVar7 = (undefined4 *)FUN_00515840(0x50,0);
          if (puVar7 == (undefined4 *)0x0) {
            puVar7 = (undefined4 *)0x0;
          }
          else {
            *puVar7 = &PTR_FUN_00cd3f2c;
            puVar7[1] = 1;
            *puVar7 = &PTR_FUN_00b8670c;
            puVar7[2] = 0;
            puVar7[3] = 0;
            puVar7[4] = 100;
            puVar7[5] = 100;
            puVar7[6] = 1;
            puVar7[7] = uVar6;
            puVar7[8] = &PTR_FUN_00cd3f2c;
            puVar7[9] = 1;
            puVar7[8] = &PTR_FUN_00b86530;
            FUN_0051c350(uVar6);
            FUN_0051c350(uVar6);
            puVar7[0xe] = 0;
            puVar7[0xf] = 0;
            puVar7[0x10] = 0xff000000;
            *(undefined2 *)(puVar7 + 0x11) = 0;
            *(undefined2 *)((int)puVar7 + 0x46) = 0;
            *(undefined1 *)(puVar7 + 0x12) = 0;
            *(undefined2 *)((int)puVar7 + 0x4a) = 0;
            *(undefined1 *)(puVar7 + 0x13) = 0;
          }
          if (*(GRefCountNTSImpl **)(in_ECX + 8) != (GRefCountNTSImpl *)0x0) {
            GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(in_ECX + 8));
          }
          *(undefined4 **)(in_ECX + 8) = puVar7;
        }
        FUN_00540450(*(undefined4 *)(in_ECX + 8),&local_284,0,0xffffffff);
      }
    }
  }
  FUN_00504260();
  local_258[0] = &PTR_FUN_00b86064;
  FUN_0055e7c0();
  GRefCountImplCore::~GRefCountImplCore((GRefCountImplCore *)local_258);
  FUN_00504260();
  FUN_00515cf0(local_34c);
  iVar5 = local_3ac;
  FUN_0053f4d0(local_3ac,local_3a8);
  FUN_00515cf0(iVar5);
  return 1;
joined_r0x005438c6:
  while ((uVar16 < uVar10 &&
         (cVar3 = FUN_0053b570(*(undefined2 *)(iVar14 + uVar16 * 2)), cVar3 != '\0'))) {
    uVar16 = uVar16 + 1;
  }
LAB_005438e6:
  FUN_0055e7a0(local_3bc,iVar11);
  local_3bc = local_3bc + 1;
  if (*(short *)(iVar14 + uVar16 * 2) == 0x2c) {
    do {
      uVar16 = uVar16 + 1;
      if (uVar10 <= uVar16) goto switchD_005436da_caseD_10;
      cVar3 = FUN_0053b570(*(undefined2 *)(iVar14 + uVar16 * 2));
    } while (cVar3 != '\0');
  }
  if (uVar10 <= uVar16) goto switchD_005436da_caseD_10;
  goto LAB_00543890;
}



============================================================
DISASSEMBLY
============================================================
00542560 : SUB ESP,0x3c4
00542566 : PUSH EBX
00542567 : PUSH EBP
00542568 : PUSH ESI
00542569 : MOV EBP,ECX
0054256b : PUSH EDI
0054256c : PUSH EBP
0054256d : MOV dword ptr [ESP + 0x18],EBP
00542571 : CALL 0x00515dd0
00542576 : MOV ECX,dword ptr [ESP + 0x3dc]
0054257d : XOR EDI,EDI
0054257f : MOV dword ptr [ESP + 0x40],EAX
00542583 : MOV dword ptr [ESP + 0x34],EAX
00542587 : MOV dword ptr [ESP + 0x6c],EAX
0054258b : MOV EAX,dword ptr [ESP + 0x3d8]
00542592 : LEA ECX,[EAX + ECX*0x2]
00542595 : MOV dword ptr [ESP + 0x28],EDI
00542599 : MOV dword ptr [ESP + 0x2c],EDI
0054259d : MOV dword ptr [ESP + 0x30],EDI
005425a1 : MOV dword ptr [ESP + 0x70],EDI
005425a5 : MOV dword ptr [ESP + 0x78],EAX
005425a9 : MOV dword ptr [ESP + 0x7c],ECX
005425ad : MOV dword ptr [ESP + 0x80],EDI
005425b4 : MOV byte ptr [ESP + 0x84],0x0
005425bc : MOV dword ptr [ESP + 0x74],EAX
005425c0 : CMP EAX,ECX
005425c2 : JNC 0x005425d5
005425c4 : MOVZX EDX,word ptr [EAX]
005425c7 : ADD EAX,0x2
005425ca : MOV dword ptr [ESP + 0x80],EDX
005425d1 : MOV dword ptr [ESP + 0x78],EAX
005425d5 : CMP byte ptr [ESP + 0x3e8],0x0
005425dd : MOV dword ptr [ESP + 0x88],EDI
005425e4 : MOV dword ptr [ESP + 0x8c],EDI
005425eb : MOV dword ptr [ESP + 0x90],EDI
005425f2 : MOV byte ptr [ESP + 0x94],0x0
005425fa : MOV EBX,0x1
005425ff : JZ 0x00542608
00542601 : MOV byte ptr [ESP + 0x94],BL
00542608 : MOV ESI,dword ptr [EBP + 0x1c]
0054260b : MOV dword ptr [ESP + 0xd4],0xcd3f2c
00542616 : MOV dword ptr [ESP + 0xd8],EBX
0054261d : MOV dword ptr [ESP + 0xd4],0xb86530
00542628 : MOV EAX,dword ptr [ESI + 0xc]
0054262b : PUSH EAX
0054262c : LEA ECX,[ESI + 0x8]
0054262f : PUSH ECX
00542630 : LEA ECX,[ESP + 0xe4]
00542637 : MOV dword ptr [ESP + 0x60],EDI
0054263b : MOV dword ptr [ESP + 0x44],EDI
0054263f : MOV byte ptr [ESP + 0x72],0x0
00542644 : CALL 0x0051c380
00542649 : MOV EDX,dword ptr [ESI + 0xc]
0054264c : PUSH EDX
0054264d : LEA EAX,[ESI + 0x10]
00542650 : PUSH EAX
00542651 : LEA ECX,[ESP + 0xec]
00542658 : MOV byte ptr [ESP + 0x6b],0x0
0054265d : CALL 0x0051c380
00542662 : MOV EAX,dword ptr [ESI + 0x18]
00542665 : CMP EAX,EDI
00542667 : JZ 0x0054266c
00542669 : ADD dword ptr [EAX + 0x4],EBX
0054266c : MOV ECX,dword ptr [ESI + 0x18]
0054266f : MOV dword ptr [ESP + 0xec],ECX
00542676 : MOV EAX,dword ptr [ESI + 0x1c]
00542679 : CMP EAX,EDI
0054267b : JZ 0x0054267f
0054267d : ADD dword ptr [EAX],EBX
0054267f : MOV EDX,dword ptr [ESI + 0x1c]
00542682 : MOV dword ptr [ESP + 0xf0],EDX
00542689 : MOV EAX,dword ptr [ESI + 0x20]
0054268c : MOV dword ptr [ESP + 0xf4],EAX
00542693 : MOVZX ECX,word ptr [ESI + 0x24]
00542697 : MOV word ptr [ESP + 0xf8],CX
0054269f : MOV DX,word ptr [ESI + 0x26]
005426a3 : MOV word ptr [ESP + 0xfa],DX
005426ab : MOV AL,byte ptr [ESI + 0x28]
005426ae : MOV EDX,dword ptr [EBP + 0x18]
005426b1 : MOV byte ptr [ESP + 0xfc],AL
005426b8 : MOVZX ECX,word ptr [ESI + 0x2a]
005426bc : MOV word ptr [ESP + 0xfe],CX
005426c4 : PUSH EDX
005426c5 : LEA ECX,[ESP + 0x180]
005426cc : CALL 0x0053c1c0
005426d1 : TEST dword ptr [ESP + 0xfe],0x100
005426dc : JZ 0x005426ee
005426de : LEA ECX,[ESP + 0xe4]
005426e5 : CALL 0x0051b1a0
005426ea : TEST EAX,EAX
005426ec : JNZ 0x00542710
005426ee : PUSH -0x1
005426f0 : PUSH 0xcca874
005426f5 : LEA ECX,[ESP + 0xdc]
005426fc : CALL 0x0055e660
00542701 : LEA EAX,[ESP + 0xd4]
00542708 : PUSH EAX
00542709 : MOV ECX,EBP
0054270b : CALL 0x0053f7c0
00542710 : MOV ECX,dword ptr [ESP + 0xe0]
00542717 : PUSH ECX
00542718 : LEA EDX,[ESP + 0xe0]
0054271f : MOV dword ptr [ESP + 0x154],0xcd3f2c
0054272a : PUSH EDX
0054272b : LEA ECX,[ESP + 0x160]
00542732 : MOV dword ptr [ESP + 0x15c],EBX
00542739 : MOV dword ptr [ESP + 0x158],0xb86530
00542744 : MOV byte ptr [ESP + 0x6a],0x0
00542749 : CALL 0x0051c380
0054274e : MOV EAX,dword ptr [ESP + 0xe0]
00542755 : PUSH EAX
00542756 : LEA ECX,[ESP + 0xe8]
0054275d : PUSH ECX
0054275e : LEA ECX,[ESP + 0x168]
00542765 : MOV byte ptr [ESP + 0x73],0x0
0054276a : CALL 0x0051c380
0054276f : MOV EAX,dword ptr [ESP + 0xec]
00542776 : CMP EAX,EDI
00542778 : JZ 0x00542784
0054277a : ADD dword ptr [EAX + 0x4],EBX
0054277d : MOV EAX,dword ptr [ESP + 0xec]
00542784 : MOV dword ptr [ESP + 0x168],EAX
0054278b : MOV EAX,dword ptr [ESP + 0xf0]
00542792 : CMP EAX,EDI
00542794 : JZ 0x0054279f
00542796 : ADD dword ptr [EAX],EBX
00542798 : MOV EAX,dword ptr [ESP + 0xf0]
0054279f : MOV EDX,dword ptr [ESP + 0xf4]
005427a6 : MOV CX,word ptr [ESP + 0xfa]
005427ae : MOV dword ptr [ESP + 0x16c],EAX
005427b5 : MOVZX EAX,word ptr [ESP + 0xf8]
005427bd : MOV word ptr [ESP + 0x174],AX
005427c5 : MOVZX EAX,word ptr [ESP + 0xfe]
005427cd : MOV dword ptr [ESP + 0x170],EDX
005427d4 : MOV DL,byte ptr [ESP + 0xfc]
005427db : MOV word ptr [ESP + 0x176],CX
005427e3 : LEA ECX,[ESP + 0x6c]
005427e7 : MOV byte ptr [ESP + 0x178],DL
005427ee : MOV word ptr [ESP + 0x17a],AX
005427f6 : CALL 0x0053d5c0
005427fb : MOV dword ptr [ESP + 0x18],EAX
005427ff : CMP EAX,0x8000
00542804 : JNZ 0x00542884
00542806 : LEA EAX,[ESP + 0xd4]
0054280d : PUSH EAX
0054280e : MOV ECX,EBP
00542810 : CALL 0x0053f7c0
00542815 : XOR EBX,EBX
00542817 : CMP dword ptr [EBP + 0x8],EBX
0054281a : JNZ 0x00543c6d
00542820 : PUSH EBP
00542821 : CALL 0x00515dd0
00542826 : MOV EDI,EAX
00542828 : PUSH EBX
00542829 : PUSH 0x50
0054282b : MOV ECX,EDI
0054282d : CALL 0x00515840
00542832 : MOV ESI,EAX
00542834 : CMP ESI,EBX
00542836 : JZ 0x00543c5c
0054283c : MOV dword ptr [ESI],0xcd3f2c
00542842 : MOV ECX,0x1
00542847 : MOV dword ptr [ESI + 0x4],ECX
0054284a : MOV dword ptr [ESI],0xb8670c
00542850 : MOV dword ptr [ESI + 0x8],EBX
00542853 : MOV dword ptr [ESI + 0xc],EBX
00542856 : MOV EAX,0x64
0054285b : MOV dword ptr [ESI + 0x18],ECX
0054285e : PUSH EDI
0054285f : LEA ECX,[ESI + 0x20]
00542862 : MOV dword ptr [ESI + 0x10],EAX
00542865 : MOV dword ptr [ESI + 0x14],EAX
00542868 : MOV dword ptr [ESI + 0x1c],EDI
0054286b : CALL 0x00504200
00542870 : MOV byte ptr [ESI + 0x4c],BL
00542873 : JMP 0x00543c5e
00542880 : MOV EAX,dword ptr [ESP + 0x18]
00542884 : CMP EAX,0x1
00542887 : JZ 0x00542ec2
0054288d : CMP EAX,0x4
00542890 : JG 0x00543a32
00542896 : JZ 0x00543a3d
0054289c : SUB EAX,0x2
0054289f : JZ 0x00542956
005428a5 : SUB EAX,0x1
005428a8 : JNZ 0x00542eaa
005428ae : LEA ECX,[ESP + 0x138]
005428b5 : PUSH ECX
005428b6 : LEA EDX,[ESP + 0x108]
005428bd : PUSH EDX
005428be : LEA ECX,[ESP + 0x74]
005428c2 : CALL 0x0053dc30
005428c7 : TEST AL,AL
005428c9 : JZ 0x00542eaa
005428cf : MOV EDI,dword ptr [ESP + 0x138]
005428d6 : TEST EDI,EDI
005428d8 : JBE 0x00542eaa
005428de : CMP byte ptr [ESP + 0x3e8],0x0
005428e6 : MOV EBX,dword ptr [ESP + 0x104]
005428ed : JZ 0x00542910
005428ef : CMP EDI,0x1
005428f2 : JA 0x00542910
005428f4 : CMP word ptr [EBX],0x20
005428f8 : JNZ 0x00542910
005428fa : MOV ECX,EBP
005428fc : CALL 0x0053c2b0
00542901 : MOV ECX,EAX
00542903 : CALL 0x0053b4b0
00542908 : TEST EAX,EAX
0054290a : JBE 0x00542eaa
00542910 : MOV EAX,dword ptr [ESP + 0x2c]
00542914 : TEST EAX,EAX
00542916 : JBE 0x00542946
00542918 : MOV ECX,dword ptr [ESP + 0x28]
0054291c : IMUL EAX,EAX,0x54
0054291f : LEA EAX,[EAX + ECX*0x1 + -0x54]
00542923 : LEA ESI,[EAX + 0x10]
00542926 : ADD EAX,0x3c
00542929 : PUSH EAX
0054292a : PUSH ESI
0054292b : PUSH EDI
0054292c : PUSH EBX
0054292d : MOV ECX,EBP
0054292f : CALL 0x00541ed0
00542934 : PUSH ESI
00542935 : LEA ECX,[ESP + 0x154]
0054293c : CALL 0x00504700
00542941 : JMP 0x00542eaa
00542946 : PUSH 0x1
00542948 : PUSH EDI
00542949 : PUSH EBX
0054294a : MOV ECX,EBP
0054294c : CALL 0x00541ff0
00542951 : JMP 0x00542eaa
00542956 : LEA EDX,[ESP + 0x50]
0054295a : PUSH EDX
0054295b : LEA EAX,[ESP + 0x58]
0054295f : PUSH EAX
00542960 : LEA ECX,[ESP + 0x74]
00542964 : CALL 0x0053db30
00542969 : MOV EDI,dword ptr [ESP + 0x50]
0054296d : MOV EBX,dword ptr [ESP + 0x54]
00542971 : PUSH 0xd
00542973 : PUSH 0xb8bc88
00542978 : PUSH EDI
00542979 : PUSH EBX
0054297a : CALL 0x0053c670
0054297f : MOV ECX,dword ptr [ESP + 0x3c]
00542983 : MOV ESI,EAX
00542985 : DEC ECX
00542986 : ADD ESP,0x10
00542989 : MOV dword ptr [ESP + 0x58],ESI
0054298d : MOV dword ptr [ESP + 0x18],ECX
00542991 : TEST ESI,ESI
00542993 : JZ 0x00542d5d
00542999 : CMP byte ptr [ESI + 0x9],0x0
0054299d : JZ 0x00542d5d
005429a3 : MOV ESI,dword ptr [ESI + 0x4]
005429a6 : SUB ESI,0x2
005429a9 : JZ 0x00543bbd
005429af : SUB ESI,0x3
005429b2 : JZ 0x005429da
005429b4 : SUB ESI,0x4
005429b7 : JNZ 0x00542eaa
005429bd : MOV EDX,dword ptr [EBP + 0x18]
005429c0 : MOV EAX,dword ptr [EBP + 0x1c]
005429c3 : PUSH EDX
005429c4 : PUSH EAX
005429c5 : PUSH 0x1
005429c7 : PUSH 0x1
005429c9 : PUSH 0xb8bc84
005429ce : MOV ECX,EBP
005429d0 : CALL 0x00540fa0
005429d5 : JMP 0x00542eaa
005429da : CMP dword ptr [ESP + 0x3e0],0x0
005429e2 : JZ 0x00542eaa
005429e8 : MOV ECX,dword ptr [ESP + 0x40]
005429ec : PUSH ECX
005429ed : LEA ECX,[ESP + 0x3ac]
005429f4 : CALL 0x0053ba30
005429f9 : MOV ESI,dword ptr [ESP + 0x3e0]
00542a00 : PUSH EAX
00542a01 : MOV ECX,ESI
00542a03 : CALL 0x0053f4a0
00542a08 : LEA ECX,[ESP + 0x3a8]
00542a0f : CALL 0x00502110
00542a14 : MOV EDX,dword ptr [ESI + 0x4]
00542a17 : MOV EAX,dword ptr [ESI]
00542a19 : IMUL EDX,EDX,0x2c
00542a1c : MOV ECX,EBP
00542a1e : LEA EDI,[EDX + EAX*0x1 + -0x2c]
00542a22 : CALL 0x0053c2b0
00542a27 : MOV ESI,EAX
00542a29 : TEST ESI,ESI
00542a2b : JNZ 0x00542a3e
00542a2d : LEA ECX,[ESP + 0x17c]
00542a34 : PUSH ECX
00542a35 : MOV ECX,EBP
00542a37 : CALL 0x00540b60
00542a3c : MOV ESI,EAX
00542a3e : MOV EDX,dword ptr [ESP + 0xe0]
00542a45 : PUSH EDX
00542a46 : LEA ECX,[ESP + 0x198]
00542a4d : CALL 0x00504200
00542a52 : MOV EAX,dword ptr [ESI + 0x20]
00542a55 : LEA ECX,[ESP + 0xc0]
00542a5c : PUSH ECX
00542a5d : LEA EDX,[ESP + 0xc8]
00542a64 : PUSH EDX
00542a65 : LEA ECX,[ESP + 0x74]
00542a69 : MOV dword ptr [EDI + 0x24],EAX
00542a6c : CALL 0x0053d850
00542a71 : TEST AL,AL
00542a73 : JZ 0x00542c57
00542a79 : LEA ESP,[ESP]
00542a80 : MOV EAX,dword ptr [ESP + 0xc0]
00542a87 : MOV ECX,dword ptr [ESP + 0xc4]
00542a8e : PUSH 0x1b
00542a90 : PUSH 0xb8bb40
00542a95 : PUSH EAX
00542a96 : PUSH ECX
00542a97 : CALL 0x0053c670
00542a9c : MOV ESI,EAX
00542a9e : ADD ESP,0x10
00542aa1 : TEST ESI,ESI
00542aa3 : JZ 0x00542c36
00542aa9 : LEA EDX,[ESP + 0x20]
00542aad : PUSH EDX
00542aae : LEA EAX,[ESP + 0x28]
00542ab2 : PUSH EAX
00542ab3 : LEA ECX,[ESP + 0x74]
00542ab7 : CALL 0x0053d910
00542abc : TEST AL,AL
00542abe : JZ 0x00542c36
00542ac4 : MOV ESI,dword ptr [ESI + 0x4]
00542ac7 : LEA EAX,[ESI + -0xc]
00542aca : CMP EAX,0x16
00542acd : JA 0x00542c36
00542ad3 : MOVZX ECX,byte ptr [EAX + 0x543ee4]
00542ada : JMP dword ptr [ECX*0x4 + 0x543ec4]
00542ae1 : MOV EDX,dword ptr [ESP + 0x20]
00542ae5 : MOV EAX,dword ptr [ESP + 0x24]
00542ae9 : PUSH EDX
00542aea : PUSH EAX
00542aeb : LEA ECX,[EDI + 0x4]
00542aee : CALL 0x0051b8a0
00542af3 : JMP 0x00542c36
00542af8 : MOV ECX,dword ptr [ESP + 0x20]
00542afc : MOV EDX,dword ptr [ESP + 0x24]
00542b00 : PUSH ECX
00542b01 : PUSH EDX
00542b02 : LEA ECX,[EDI + 0xc]
00542b05 : CALL 0x0051b8a0
00542b0a : JMP 0x00542c36
00542b0f : MOV EAX,dword ptr [ESP + 0x20]
00542b13 : MOV ECX,dword ptr [ESP + 0x24]
00542b17 : PUSH 0x1b
00542b19 : PUSH 0xb8bb40
00542b1e : PUSH EAX
00542b1f : PUSH ECX
00542b20 : CALL 0x0053c670
00542b25 : ADD ESP,0x10
00542b28 : TEST EAX,EAX
00542b2a : JZ 0x00542c36
00542b30 : MOV EAX,dword ptr [EAX + 0x4]
00542b33 : SUB EAX,0xe
00542b36 : JZ 0x00542b58
00542b38 : SUB EAX,0x15
00542b3b : JZ 0x00542b4f
00542b3d : SUB EAX,0x1
00542b40 : JNZ 0x00542c36
00542b46 : MOV byte ptr [EDI + 0x28],0x1
00542b4a : JMP 0x00542c36
00542b4f : MOV byte ptr [EDI + 0x28],0x2
00542b53 : JMP 0x00542c36
00542b58 : MOV byte ptr [EDI + 0x28],0x0
00542b5c : JMP 0x00542c36
00542b61 : MOV EDX,dword ptr [ESP + 0x20]
00542b65 : MOV EAX,dword ptr [ESP + 0x24]
00542b69 : PUSH EDX
00542b6a : PUSH EAX
00542b6b : LEA ECX,[ESP + 0x150]
00542b72 : PUSH ECX
00542b73 : CALL 0x0053b640
00542b78 : ADD ESP,0xc
00542b7b : TEST AL,AL
00542b7d : JZ 0x00542c36
00542b83 : MOV EAX,dword ptr [ESP + 0x148]
00542b8a : TEST EAX,EAX
00542b8c : JL 0x00542c36
00542b92 : LEA EDX,[EAX + EAX*0x4]
00542b95 : ADD EDX,EDX
00542b97 : ADD EDX,EDX
00542b99 : MOV dword ptr [EDI + 0x14],EDX
00542b9c : JMP 0x00542c36
00542ba1 : MOV EAX,dword ptr [ESP + 0x20]
00542ba5 : MOV ECX,dword ptr [ESP + 0x24]
00542ba9 : PUSH EAX
00542baa : PUSH ECX
00542bab : LEA EDX,[ESP + 0x114]
00542bb2 : PUSH EDX
00542bb3 : CALL 0x0053b640
00542bb8 : ADD ESP,0xc
00542bbb : TEST AL,AL
00542bbd : JZ 0x00542c36
00542bbf : MOV EAX,dword ptr [ESP + 0x10c]
00542bc6 : TEST EAX,EAX
00542bc8 : JL 0x00542c36
00542bca : LEA EAX,[EAX + EAX*0x4]
00542bcd : ADD EAX,EAX
00542bcf : ADD EAX,EAX
00542bd1 : MOV dword ptr [EDI + 0x18],EAX
00542bd4 : JMP 0x00542c36
00542bd6 : MOV ECX,dword ptr [ESP + 0x20]
00542bda : MOV EDX,dword ptr [ESP + 0x24]
00542bde : PUSH ECX
00542bdf : PUSH EDX
00542be0 : LEA EAX,[ESP + 0x148]
00542be7 : PUSH EAX
00542be8 : CALL 0x0053b640
00542bed : ADD ESP,0xc
00542bf0 : TEST AL,AL
00542bf2 : JZ 0x00542c36
00542bf4 : MOV EAX,dword ptr [ESP + 0x140]
00542bfb : LEA ECX,[EAX + EAX*0x4]
00542bfe : ADD ECX,ECX
00542c00 : ADD ECX,ECX
00542c02 : MOV dword ptr [EDI + 0x1c],ECX
00542c05 : JMP 0x00542c36
00542c07 : MOV EDX,dword ptr [ESP + 0x20]
00542c0b : MOV EAX,dword ptr [ESP + 0x24]
00542c0f : PUSH EDX
00542c10 : PUSH EAX
00542c11 : LEA ECX,[ESP + 0x154]
00542c18 : PUSH ECX
00542c19 : CALL 0x0053b640
00542c1e : ADD ESP,0xc
00542c21 : TEST AL,AL
00542c23 : JZ 0x00542c36
00542c25 : MOV EAX,dword ptr [ESP + 0x14c]
00542c2c : LEA EDX,[EAX + EAX*0x4]
00542c2f : ADD EDX,EDX
00542c31 : ADD EDX,EDX
00542c33 : MOV dword ptr [EDI + 0x20],EDX
00542c36 : LEA EAX,[ESP + 0xc0]
00542c3d : PUSH EAX
00542c3e : LEA ECX,[ESP + 0xc8]
00542c45 : PUSH ECX
00542c46 : LEA ECX,[ESP + 0x74]
00542c4a : CALL 0x0053d850
00542c4f : TEST AL,AL
00542c51 : JNZ 0x00542a80
00542c57 : PUSH EBP
00542c58 : PUSH 0x50
00542c5a : CALL 0x0053b550
00542c5f : ADD ESP,0x8
00542c62 : TEST EAX,EAX
00542c64 : JZ 0x00542c71
00542c66 : MOV ECX,EAX
00542c68 : CALL 0x0053c0e0
00542c6d : MOV ESI,EAX
00542c6f : JMP 0x00542c73
00542c71 : XOR ESI,ESI
00542c73 : PUSH ESI
00542c74 : LEA ECX,[ESP + 0x198]
00542c7b : CALL 0x0053b9c0
00542c80 : MOV EDX,dword ptr [EDI + 0x14]
00542c83 : MOV dword ptr [ESI + 0x18],EDX
00542c86 : MOV EAX,dword ptr [EDI + 0x18]
00542c89 : MOV dword ptr [ESI + 0x1c],EAX
00542c8c : MOV ECX,dword ptr [EDI + 0x1c]
00542c8f : MOV dword ptr [ESI + 0x40],ECX
00542c92 : MOV EDX,dword ptr [EDI + 0x20]
00542c95 : LEA EAX,[EDI + 0x4]
00542c98 : PUSH EAX
00542c99 : LEA ECX,[ESI + 0x38]
00542c9c : MOV dword ptr [ESI + 0x44],EDX
00542c9f : CALL 0x0051bc20
00542ca4 : LEA ECX,[EDI + 0xc]
00542ca7 : PUSH ECX
00542ca8 : LEA ECX,[ESI + 0x3c]
00542cab : CALL 0x0051bc20
00542cb0 : MOV DL,byte ptr [EDI + 0x28]
00542cb3 : MOV byte ptr [ESI + 0x4c],DL
00542cb6 : INC dword ptr [ESI + 0x4]
00542cb9 : MOV ECX,dword ptr [EDI]
00542cbb : TEST ECX,ECX
00542cbd : JZ 0x00542cc4
00542cbf : CALL 0x004ff7c0
00542cc4 : MOV EAX,dword ptr [ESP + 0x18]
00542cc8 : MOV dword ptr [EDI],ESI
00542cca : TEST EAX,EAX
00542ccc : JL 0x00542cdf
00542cce : MOV ECX,dword ptr [ESP + 0x28]
00542cd2 : IMUL EAX,EAX,0x54
00542cd5 : ADD EAX,ECX
00542cd7 : LEA EDI,[EAX + 0x10]
00542cda : LEA EBX,[EAX + 0x3c]
00542cdd : JMP 0x00542ced
00542cdf : LEA EDI,[ESP + 0xd4]
00542ce6 : LEA EBX,[ESP + 0x17c]
00542ced : MOV ECX,EDI
00542cef : CALL 0x0050a3a0
00542cf4 : TEST AL,AL
00542cf6 : JZ 0x00542d08
00542cf8 : LEA EDX,[EDI + 0x10]
00542cfb : PUSH EDX
00542cfc : LEA ECX,[ESP + 0x198]
00542d03 : CALL 0x0055e700
00542d08 : PUSH EBX
00542d09 : LEA EAX,[ESP + 0x198]
00542d10 : PUSH EAX
00542d11 : PUSH 0x1
00542d13 : PUSH 0x1
00542d15 : PUSH 0xb8bb3c
00542d1a : MOV ECX,EBP
00542d1c : CALL 0x00540fa0
00542d21 : MOV ECX,dword ptr [EDI + 0x18]
00542d24 : TEST ECX,ECX
00542d26 : JZ 0x00542d2d
00542d28 : CALL 0x004ff7c0
00542d2d : MOV ECX,0x200
00542d32 : MOV dword ptr [EDI + 0x18],0x0
00542d39 : OR word ptr [EDI + 0x2a],CX
00542d3d : PUSH EDI
00542d3e : MOV ECX,EBP
00542d40 : CALL 0x0053f7c0
00542d45 : MOV ECX,ESI
00542d47 : CALL 0x004ff7c0
00542d4c : LEA ECX,[ESP + 0x194]
00542d53 : CALL 0x00504260
00542d58 : JMP 0x00542eaa
00542d5d : MOV ECX,EBP
00542d5f : CALL 0x0053c470
00542d64 : MOV EDX,dword ptr [ESP + 0x40]
00542d68 : PUSH 0x0
00542d6a : PUSH ESI
00542d6b : PUSH EDI
00542d6c : PUSH EBX
00542d6d : PUSH EDX
00542d6e : LEA ECX,[ESP + 0x234]
00542d75 : MOV EBP,EAX
00542d77 : CALL 0x0053e1a0
00542d7c : MOV ECX,dword ptr [ESP + 0x34]
00542d80 : MOV EBX,EAX
00542d82 : MOV EAX,dword ptr [ESP + 0x2c]
00542d86 : INC EAX
00542d87 : PUSH EAX
00542d88 : PUSH ECX
00542d89 : LEA ECX,[ESP + 0x30]
00542d8d : CALL 0x0053f650
00542d92 : MOV EDX,dword ptr [ESP + 0x2c]
00542d96 : MOV EDI,dword ptr [ESP + 0x28]
00542d9a : IMUL EDX,EDX,0x54
00542d9d : LEA ESI,[EDX + EDI*0x1 + -0x54]
00542da1 : TEST ESI,ESI
00542da3 : JZ 0x00542dad
00542da5 : PUSH EBX
00542da6 : MOV ECX,ESI
00542da8 : CALL 0x0053e210
00542dad : LEA ECX,[ESP + 0x25c]
00542db4 : MOV dword ptr [ESP + 0x25c],0xb86064
00542dbf : CALL 0x0055e7c0
00542dc4 : LEA ECX,[ESP + 0x25c]
00542dcb : CALL 0x004ff7b0
00542dd0 : LEA ECX,[ESP + 0x230]
00542dd7 : CALL 0x00504260
00542ddc : MOV EBX,dword ptr [ESP + 0x18]
00542de0 : MOV dword ptr [ESI + 0xc],EBP
00542de3 : TEST EBX,EBX
00542de5 : JL 0x00542e00
00542de7 : IMUL EBX,EBX,0x54
00542dea : ADD EBX,EDI
00542dec : LEA EAX,[EBX + 0x10]
00542def : LEA EDI,[ESI + 0x10]
00542df2 : PUSH EAX
00542df3 : MOV ECX,EDI
00542df5 : CALL 0x00504700
00542dfa : ADD EBX,0x3c
00542dfd : PUSH EBX
00542dfe : JMP 0x00542e1a
00542e00 : LEA ECX,[ESP + 0xd4]
00542e07 : LEA EDI,[ESI + 0x10]
00542e0a : PUSH ECX
00542e0b : MOV ECX,EDI
00542e0d : CALL 0x00504700
00542e12 : LEA EDX,[ESP + 0x17c]
00542e19 : PUSH EDX
00542e1a : ADD ESI,0x3c
00542e1d : MOV ECX,ESI
00542e1f : MOV dword ptr [ESP + 0x14],ESI
00542e23 : CALL 0x0055ee10
00542e28 : MOV EAX,dword ptr [ESP + 0x58]
00542e2c : TEST EAX,EAX
00542e2e : JNZ 0x00542f4b
00542e34 : CMP dword ptr [ESP + 0x3ec],EAX
00542e3b : JZ 0x00542ea6
00542e3d : MOV EAX,dword ptr [ESP + 0x50]
00542e41 : MOV ECX,dword ptr [ESP + 0x54]
00542e45 : PUSH EAX
00542e46 : PUSH ECX
00542e47 : MOV ECX,dword ptr [ESP + 0x3f4]
00542e4e : PUSH 0x0
00542e50 : CALL 0x0057df30
00542e55 : MOV EBX,EAX
00542e57 : TEST EBX,EBX
00542e59 : JZ 0x00542ea6
00542e5b : LEA EDX,[EBX + 0x2c]
00542e5e : PUSH EDX
00542e5f : LEA EAX,[ESP + 0x1dc]
00542e66 : PUSH EAX
00542e67 : MOV ECX,ESI
00542e69 : CALL 0x0055f330
00542e6e : PUSH EAX
00542e6f : MOV ECX,ESI
00542e71 : CALL 0x0055ee10
00542e76 : LEA ECX,[ESP + 0x1d8]
00542e7d : CALL 0x005008c0
00542e82 : PUSH EBX
00542e83 : LEA ECX,[ESP + 0x354]
00542e8a : PUSH ECX
00542e8b : MOV ECX,EDI
00542e8d : CALL 0x0055fca0
00542e92 : PUSH EAX
00542e93 : MOV ECX,EDI
00542e95 : CALL 0x00504700
00542e9a : LEA ECX,[ESP + 0x350]
00542ea1 : CALL 0x00504260
00542ea6 : MOV EBP,dword ptr [ESP + 0x14]
00542eaa : LEA ECX,[ESP + 0x6c]
00542eae : CALL 0x0053d5c0
00542eb3 : MOV dword ptr [ESP + 0x18],EAX
00542eb7 : CMP EAX,0x8000
00542ebc : JNZ 0x00542880
00542ec2 : MOV EAX,dword ptr [ESP + 0x2c]
00542ec6 : XOR EBX,EBX
00542ec8 : CMP EAX,EBX
00542eca : JBE 0x00542806
00542ed0 : MOV ECX,dword ptr [ESP + 0x28]
00542ed4 : IMUL EAX,EAX,0x54
00542ed7 : LEA ESI,[EAX + ECX*0x1 + -0x54]
00542edb : LEA EDX,[ESI + 0x10]
00542ede : PUSH EDX
00542edf : MOV ECX,EBP
00542ee1 : MOV dword ptr [ESP + 0x44],ESI
00542ee5 : CALL 0x0053f7c0
00542eea : CMP dword ptr [EBP + 0x8],EBX
00542eed : JNZ 0x00543c56
00542ef3 : PUSH EBP
00542ef4 : CALL 0x00515dd0
00542ef9 : MOV EDI,EAX
00542efb : PUSH EBX
00542efc : PUSH 0x50
00542efe : MOV ECX,EDI
00542f00 : CALL 0x00515840
00542f05 : MOV ESI,EAX
00542f07 : CMP ESI,EBX
00542f09 : JZ 0x00543c41
00542f0f : MOV dword ptr [ESI],0xcd3f2c
00542f15 : MOV EAX,0x1
00542f1a : MOV dword ptr [ESI + 0x4],EAX
00542f1d : MOV dword ptr [ESI],0xb8670c
00542f23 : MOV dword ptr [ESI + 0x8],EBX
00542f26 : MOV dword ptr [ESI + 0xc],EBX
00542f29 : MOV ECX,0x64
00542f2e : MOV dword ptr [ESI + 0x10],ECX
00542f31 : MOV dword ptr [ESI + 0x14],ECX
00542f34 : PUSH EDI
00542f35 : LEA ECX,[ESI + 0x20]
00542f38 : MOV dword ptr [ESI + 0x18],EAX
00542f3b : MOV dword ptr [ESI + 0x1c],EDI
00542f3e : CALL 0x00504200
00542f43 : MOV byte ptr [ESI + 0x4c],BL
00542f46 : JMP 0x00543c43
00542f4b : MOV EAX,dword ptr [EAX + 0x4]
00542f4e : CMP EAX,0xb
00542f51 : JA 0x00542ea6
00542f57 : JMP dword ptr [EAX*0x4 + 0x543efc]
00542f5e : LEA EDX,[ESP + 0xcc]
00542f65 : PUSH EDX
00542f66 : LEA EAX,[ESP + 0xa4]
00542f6d : PUSH EAX
00542f6e : LEA ECX,[ESP + 0x74]
00542f72 : CALL 0x0053d850
00542f77 : TEST AL,AL
00542f79 : JZ 0x0054300f
00542f7f : MOV EBX,dword ptr [ESP + 0x14]
00542f83 : MOV EBP,0x14
00542f88 : JMP 0x00542f90
00542f90 : MOV ECX,dword ptr [ESP + 0xcc]
00542f97 : MOV EDX,dword ptr [ESP + 0xa0]
00542f9e : PUSH 0x1b
00542fa0 : PUSH 0xb8bb40
00542fa5 : PUSH ECX
00542fa6 : PUSH EDX
00542fa7 : CALL 0x0053c670
00542fac : MOV ESI,EAX
00542fae : ADD ESP,0x10
00542fb1 : TEST ESI,ESI
00542fb3 : JZ 0x00542ff2
00542fb5 : LEA EAX,[ESP + 0x114]
00542fbc : PUSH EAX
00542fbd : LEA ECX,[ESP + 0x138]
00542fc4 : PUSH ECX
00542fc5 : LEA ECX,[ESP + 0x74]
00542fc9 : CALL 0x0053d910
00542fce : TEST AL,AL
00542fd0 : JZ 0x00542ff2
00542fd2 : CMP dword ptr [ESI + 0x4],EBP
00542fd5 : JNZ 0x00542ff2
00542fd7 : MOV EDX,dword ptr [ESP + 0x114]
00542fde : MOV EAX,dword ptr [ESP + 0x134]
00542fe5 : PUSH EDX
00542fe6 : PUSH EAX
00542fe7 : MOV ECX,EDI
00542fe9 : CALL 0x0055e6b0
00542fee : OR byte ptr [EBX + 0x20],0x1
00542ff2 : LEA ECX,[ESP + 0xcc]
00542ff9 : PUSH ECX
00542ffa : LEA EDX,[ESP + 0xa4]
00543001 : PUSH EDX
00543002 : LEA ECX,[ESP + 0x74]
00543006 : CALL 0x0053d850
0054300b : TEST AL,AL
0054300d : JNZ 0x00542f90
0054300f : CMP dword ptr [ESP + 0x3ec],0x0
00543017 : JZ 0x00542ea6
0054301d : MOV ECX,dword ptr [ESP + 0x3ec]
00543024 : PUSH -0x1
00543026 : PUSH 0xb8653c
0054302b : PUSH 0x0
0054302d : CALL 0x0057dec0
00543032 : TEST EAX,EAX
00543034 : JZ 0x0054305a
00543036 : PUSH EAX
00543037 : LEA EAX,[ESP + 0x278]
0054303e : PUSH EAX
0054303f : MOV ECX,EDI
00543041 : CALL 0x0055fca0
00543046 : PUSH EAX
00543047 : MOV ECX,EDI
00543049 : CALL 0x00504700
0054304e : LEA ECX,[ESP + 0x274]
00543055 : CALL 0x00504260
0054305a : MOV ECX,EDI
0054305c : CALL 0x0050a3a0
00543061 : TEST AL,AL
00543063 : JZ 0x00542ea6
00543069 : MOV ECX,dword ptr [ESP + 0x3ec]
00543070 : PUSH -0x1
00543072 : PUSH 0xb86534
00543077 : PUSH 0x0
00543079 : CALL 0x0057dec0
0054307e : TEST EAX,EAX
00543080 : JZ 0x00542ea6
00543086 : PUSH EAX
00543087 : LEA ECX,[ESP + 0x2d0]
0054308e : PUSH ECX
0054308f : MOV ECX,EDI
00543091 : CALL 0x0055fca0
00543096 : PUSH EAX
00543097 : MOV ECX,EDI
00543099 : CALL 0x00504700
0054309e : LEA ECX,[ESP + 0x2cc]
005430a5 : JMP 0x00542ea1
005430aa : MOV ESI,dword ptr [ESP + 0x14]
005430ae : MOV EBP,dword ptr [ESP + 0x10]
005430b2 : MOV EDX,0x8080
005430b7 : OR word ptr [EBP + 0x16],DX
005430bb : MOV ECX,ESI
005430bd : CALL 0x0053c2b0
005430c2 : MOV EBX,EAX
005430c4 : TEST EBX,EBX
005430c6 : JNZ 0x005430d4
005430c8 : PUSH EBP
005430c9 : MOV ECX,ESI
005430cb : CALL 0x00540b60
005430d0 : MOV EBX,EAX
005430d2 : JMP 0x00543115
005430d4 : MOV ECX,EBX
005430d6 : CALL 0x0053b4b0
005430db : TEST EAX,EAX
005430dd : JZ 0x00543105
005430df : CMP byte ptr [ESP + 0x3e4],0x0
005430e7 : JZ 0x005430fc
005430e9 : PUSH 0x1
005430eb : PUSH 0x1
005430ed : MOV ECX,ESI
005430ef : CALL 0x0053b3c0
005430f4 : PUSH EAX
005430f5 : MOV ECX,ESI
005430f7 : CALL 0x00541fd0
005430fc : MOV ECX,ESI
005430fe : CALL 0x0053c2b0
00543103 : MOV EBX,EAX
00543105 : PUSH EBP
00543106 : MOV ECX,ESI
00543108 : CALL 0x0053f720
0054310d : PUSH EAX
0054310e : MOV ECX,EBX
00543110 : CALL 0x0053c230
00543115 : CMP dword ptr [ESP + 0x3ec],0x0
0054311d : JZ 0x00542ea6
00543123 : MOV EAX,dword ptr [ESP + 0x50]
00543127 : MOV ECX,dword ptr [ESP + 0x54]
0054312b : PUSH EAX
0054312c : PUSH ECX
0054312d : MOV ECX,dword ptr [ESP + 0x3f4]
00543134 : PUSH 0x0
00543136 : CALL 0x0057df30
0054313b : MOV EBP,EAX
0054313d : TEST EBP,EBP
0054313f : JZ 0x00542ea6
00543145 : MOV ESI,dword ptr [ESP + 0x10]
00543149 : LEA EDX,[EBP + 0x2c]
0054314c : PUSH EDX
0054314d : LEA EAX,[ESP + 0x1c4]
00543154 : PUSH EAX
00543155 : MOV ECX,ESI
00543157 : CALL 0x0055f330
0054315c : PUSH EAX
0054315d : MOV ECX,ESI
0054315f : CALL 0x0055ee10
00543164 : LEA ECX,[ESP + 0x1c0]
0054316b : CALL 0x005008c0
00543170 : PUSH EBP
00543171 : LEA ECX,[ESP + 0x380]
00543178 : PUSH ECX
00543179 : MOV ECX,EDI
0054317b : CALL 0x0055fca0
00543180 : PUSH EAX
00543181 : MOV ECX,EDI
00543183 : CALL 0x00504700
00543188 : LEA ECX,[ESP + 0x37c]
0054318f : CALL 0x00504260
00543194 : MOV EBP,dword ptr [ESP + 0x14]
00543198 : PUSH ESI
00543199 : MOV ECX,EBP
0054319b : CALL 0x0053f720
005431a0 : PUSH EAX
005431a1 : MOV ECX,EBX
005431a3 : CALL 0x0053c230
005431a8 : JMP 0x00542eaa
005431ad : MOV EBP,dword ptr [ESP + 0x14]
005431b1 : MOV ECX,EBP
005431b3 : CALL 0x0053c2b0
005431b8 : MOV dword ptr [ESP + 0x18],EAX
005431bc : TEST EAX,EAX
005431be : JNZ 0x005431ca
005431c0 : PUSH EAX
005431c1 : MOV ECX,EBP
005431c3 : CALL 0x00540b60
005431c8 : JMP 0x005431f5
005431ca : CMP dword ptr [ESP + 0x3c],0x0
005431cf : JZ 0x005431f9
005431d1 : CMP byte ptr [ESP + 0x3e4],0x0
005431d9 : JZ 0x005431ee
005431db : PUSH 0x1
005431dd : PUSH 0x1
005431df : MOV ECX,EBP
005431e1 : CALL 0x0053b3c0
005431e6 : PUSH EAX
005431e7 : MOV ECX,EBP
005431e9 : CALL 0x00541fd0
005431ee : MOV ECX,EBP
005431f0 : CALL 0x0053c2b0
005431f5 : MOV dword ptr [ESP + 0x18],EAX
005431f9 : MOV ECX,dword ptr [ESP + 0x3ec]
00543200 : TEST ECX,ECX
00543202 : JZ 0x0054326c
00543204 : MOV EDX,dword ptr [ESP + 0x50]
00543208 : MOV EAX,dword ptr [ESP + 0x54]
0054320c : PUSH EDX
0054320d : PUSH EAX
0054320e : PUSH 0x0
00543210 : CALL 0x0057df30
00543215 : MOV ESI,EAX
00543217 : TEST ESI,ESI
00543219 : JZ 0x0054326c
0054321b : MOV EBX,dword ptr [ESP + 0x10]
0054321f : LEA ECX,[ESI + 0x2c]
00543222 : PUSH ECX
00543223 : LEA EDX,[ESP + 0x20c]
0054322a : PUSH EDX
0054322b : MOV ECX,EBX
0054322d : CALL 0x0055f330
00543232 : PUSH EAX
00543233 : MOV ECX,EBX
00543235 : CALL 0x0055ee10
0054323a : LEA ECX,[ESP + 0x208]
00543241 : CALL 0x005008c0
00543246 : PUSH ESI
00543247 : LEA EAX,[ESP + 0x328]
0054324e : PUSH EAX
0054324f : MOV ECX,EDI
00543251 : CALL 0x0055fca0
00543256 : PUSH EAX
00543257 : MOV ECX,EDI
00543259 : CALL 0x00504700
0054325e : LEA ECX,[ESP + 0x324]
00543265 : CALL 0x00504260
0054326a : JMP 0x00543270
0054326c : MOV EBX,dword ptr [ESP + 0x10]
00543270 : LEA ECX,[ESP + 0x98]
00543277 : PUSH ECX
00543278 : LEA EDX,[ESP + 0xb4]
0054327f : PUSH EDX
00543280 : LEA ECX,[ESP + 0x74]
00543284 : CALL 0x0053d850
00543289 : TEST AL,AL
0054328b : JZ 0x005433ed
00543291 : JMP 0x005432a0
005432a0 : MOV EAX,dword ptr [ESP + 0x98]
005432a7 : MOV ECX,dword ptr [ESP + 0xb0]
005432ae : PUSH 0x1b
005432b0 : PUSH 0xb8bb40
005432b5 : PUSH EAX
005432b6 : PUSH ECX
005432b7 : CALL 0x0053c670
005432bc : MOV ESI,EAX
005432be : ADD ESP,0x10
005432c1 : TEST ESI,ESI
005432c3 : JZ 0x005433cc
005432c9 : LEA EDX,[ESP + 0xc8]
005432d0 : PUSH EDX
005432d1 : LEA EAX,[ESP + 0xac]
005432d8 : PUSH EAX
005432d9 : LEA ECX,[ESP + 0x74]
005432dd : CALL 0x0053d910
005432e2 : TEST AL,AL
005432e4 : JZ 0x005433cc
005432ea : MOV ESI,dword ptr [ESI + 0x4]
005432ed : CMP ESI,0xc
005432f0 : JZ 0x00543382
005432f6 : CMP ESI,0x10
005432f9 : JNZ 0x005433cc
005432ff : CMP dword ptr [ESP + 0x3ec],0x0
00543307 : JZ 0x005433cc
0054330d : MOV ECX,dword ptr [ESP + 0xc8]
00543314 : MOV EDX,dword ptr [ESP + 0xa8]
0054331b : PUSH ECX
0054331c : MOV ECX,dword ptr [ESP + 0x3f0]
00543323 : PUSH EDX
00543324 : PUSH 0x1
00543326 : CALL 0x0057df30
0054332b : MOV ESI,EAX
0054332d : TEST ESI,ESI
0054332f : JZ 0x005433cc
00543335 : LEA EAX,[ESI + 0x2c]
00543338 : PUSH EAX
00543339 : LEA ECX,[ESP + 0x1f4]
00543340 : PUSH ECX
00543341 : MOV ECX,EBX
00543343 : CALL 0x0055f330
00543348 : PUSH EAX
00543349 : MOV ECX,EBX
0054334b : CALL 0x0055ee10
00543350 : LEA ECX,[ESP + 0x1f0]
00543357 : CALL 0x005008c0
0054335c : PUSH ESI
0054335d : LEA EDX,[ESP + 0x2a4]
00543364 : PUSH EDX
00543365 : MOV ECX,EDI
00543367 : CALL 0x0055fca0
0054336c : PUSH EAX
0054336d : MOV ECX,EDI
0054336f : CALL 0x00504700
00543374 : LEA ECX,[ESP + 0x2a0]
0054337b : CALL 0x00504260
00543380 : JMP 0x005433cc
00543382 : MOV EAX,dword ptr [ESP + 0xc8]
00543389 : MOV ECX,dword ptr [ESP + 0xa8]
00543390 : PUSH 0x1b
00543392 : PUSH 0xb8bb40
00543397 : PUSH EAX
00543398 : PUSH ECX
00543399 : CALL 0x0053c670
0054339e : ADD ESP,0x10
005433a1 : TEST EAX,EAX
005433a3 : JZ 0x005433cc
005433a5 : MOV EAX,dword ptr [EAX + 0x4]
005433a8 : ADD EAX,-0x23
005433ab : CMP EAX,0x3
005433ae : JA 0x005433cc
005433b0 : JMP dword ptr [EAX*0x4 + 0x543f2c]
005433b7 : PUSH 0x0
005433b9 : JMP 0x005433c5
005433bb : PUSH 0x1
005433bd : JMP 0x005433c5
005433bf : PUSH 0x3
005433c1 : JMP 0x005433c5
005433c3 : PUSH 0x2
005433c5 : MOV ECX,EBX
005433c7 : CALL 0x004ffe10
005433cc : LEA EDX,[ESP + 0x98]
005433d3 : PUSH EDX
005433d4 : LEA EAX,[ESP + 0xb4]
005433db : PUSH EAX
005433dc : LEA ECX,[ESP + 0x74]
005433e0 : CALL 0x0053d850
005433e5 : TEST AL,AL
005433e7 : JNZ 0x005432a0
005433ed : MOV ESI,dword ptr [ESP + 0x18]
005433f1 : MOV ECX,ESI
005433f3 : CALL 0x0053b4b0
005433f8 : TEST EAX,EAX
005433fa : JNZ 0x0054340c
005433fc : PUSH EBX
005433fd : MOV ECX,EBP
005433ff : CALL 0x0053f720
00543404 : PUSH EAX
00543405 : MOV ECX,ESI
00543407 : CALL 0x0053c230
0054340c : INC dword ptr [ESP + 0x3c]
00543410 : JMP 0x00542eaa
00543415 : PUSH 0x1
00543417 : MOV ECX,EDI
00543419 : CALL 0x0055fbc0
0054341e : JMP 0x00542ea6
00543423 : PUSH 0x1
00543425 : MOV ECX,EDI
00543427 : CALL 0x0055fc30
0054342c : JMP 0x00542ea6
00543431 : PUSH 0x1
00543433 : MOV ECX,EDI
00543435 : CALL 0x0055e720
0054343a : JMP 0x00542ea6
0054343f : LEA ECX,[ESP + 0xb8]
00543446 : PUSH ECX
00543447 : LEA EDX,[ESP + 0xa0]
0054344e : PUSH EDX
0054344f : LEA ECX,[ESP + 0x74]
00543453 : CALL 0x0053d850
00543458 : TEST AL,AL
0054345a : JZ 0x00542ea6
00543460 : MOV EBX,0x1
00543465 : JMP 0x00543470
00543470 : MOV EAX,dword ptr [ESP + 0xb8]
00543477 : MOV ECX,dword ptr [ESP + 0x9c]
0054347e : PUSH 0x1b
00543480 : PUSH 0xb8bb40
00543485 : PUSH EAX
00543486 : PUSH ECX
00543487 : CALL 0x0053c670
0054348c : MOV ESI,EAX
0054348e : ADD ESP,0x10
00543491 : TEST ESI,ESI
00543493 : JZ 0x0054362f
00543499 : LEA EDX,[ESP + 0x4c]
0054349d : PUSH EDX
0054349e : LEA EAX,[ESP + 0x48]
005434a2 : PUSH EAX
005434a3 : LEA ECX,[ESP + 0x74]
005434a7 : CALL 0x0053d910
005434ac : TEST AL,AL
005434ae : JZ 0x0054362f
005434b4 : MOV ESI,dword ptr [ESI + 0x4]
005434b7 : LEA EAX,[ESI + -0xd]
005434ba : CMP EAX,0x11
005434bd : JA 0x0054362f
005434c3 : MOVZX ECX,byte ptr [EAX + 0x543f58]
005434ca : JMP dword ptr [ECX*0x4 + 0x543f3c]
005434d1 : MOV EAX,dword ptr [ESP + 0x44]
005434d5 : CMP word ptr [EAX],0x23
005434d9 : JNZ 0x0054362f
005434df : MOV EDX,dword ptr [ESP + 0x4c]
005434e3 : DEC EDX
005434e4 : PUSH EDX
005434e5 : ADD EAX,0x2
005434e8 : PUSH EAX
005434e9 : LEA EAX,[ESP + 0x124]
005434f0 : PUSH EAX
005434f1 : CALL 0x0053bd50
005434f6 : ADD ESP,0xc
005434f9 : TEST AL,AL
005434fb : JZ 0x0054362f
00543501 : MOV ECX,dword ptr [EDI + 0x20]
00543504 : XOR ECX,dword ptr [ESP + 0x11c]
0054350b : AND ECX,0xffffff
00543511 : XOR dword ptr [EDI + 0x20],ECX
00543514 : OR word ptr [EDI + 0x2a],BX
00543518 : JMP 0x0054362f
0054351d : MOV EDX,dword ptr [ESP + 0x4c]
00543521 : MOV EAX,dword ptr [ESP + 0x44]
00543525 : PUSH EDX
00543526 : PUSH EAX
00543527 : MOV ECX,EDI
00543529 : CALL 0x0055fa20
0054352e : JMP 0x0054362f
00543533 : MOV ECX,dword ptr [ESP + 0x4c]
00543537 : MOV EDX,dword ptr [ESP + 0x44]
0054353b : PUSH ECX
0054353c : PUSH EDX
0054353d : LEA EAX,[ESP + 0xd8]
00543544 : PUSH EAX
00543545 : CALL 0x0053b640
0054354a : ADD ESP,0xc
0054354d : TEST AL,AL
0054354f : JZ 0x0054362f
00543555 : CMP dword ptr [ESP + 0xd0],0x0
0054355d : JL 0x0054362f
00543563 : FILD dword ptr [ESP + 0xd0]
0054356a : PUSH ECX
0054356b : MOV ECX,EDI
0054356d : FSTP float ptr [ESP]
00543570 : CALL 0x0053b960
00543575 : JMP 0x0054362f
0054357a : MOV ECX,dword ptr [ESP + 0x4c]
0054357e : MOV EDX,dword ptr [ESP + 0x44]
00543582 : PUSH ECX
00543583 : PUSH EDX
00543584 : LEA EAX,[ESP + 0x14c]
0054358b : PUSH EAX
0054358c : CALL 0x0053b640
00543591 : ADD ESP,0xc
00543594 : TEST AL,AL
00543596 : JZ 0x0054362f
0054359c : MOV EAX,dword ptr [ESP + 0x144]
005435a3 : TEST EAX,EAX
005435a5 : JL 0x0054362f
005435ab : JZ 0x005435b7
005435ad : PUSH EBX
005435ae : MOV ECX,EDI
005435b0 : CALL 0x0055e740
005435b5 : JMP 0x0054362f
005435b7 : AND byte ptr [EDI + 0x28],0xf7
005435bb : MOV ECX,0xff7f
005435c0 : AND word ptr [EDI + 0x2a],CX
005435c4 : JMP 0x0054362f
005435c6 : MOV EDX,dword ptr [ESP + 0x4c]
005435ca : MOV EAX,dword ptr [ESP + 0x44]
005435ce : PUSH EDX
005435cf : PUSH EAX
005435d0 : LEA ECX,[ESP + 0x12c]
005435d7 : PUSH ECX
005435d8 : CALL 0x0053b6d0
005435dd : ADD ESP,0xc
005435e0 : TEST AL,AL
005435e2 : JZ 0x0054362f
005435e4 : FLD float ptr [ESP + 0x124]
005435eb : PUSH ECX
005435ec : MOV ECX,EDI
005435ee : FSTP float ptr [ESP]
005435f1 : CALL 0x0053b940
005435f6 : JMP 0x0054362f
005435f8 : MOV EAX,dword ptr [ESP + 0x44]
005435fc : CMP word ptr [EAX],0x23
00543600 : JNZ 0x0054362f
00543602 : MOV EDX,dword ptr [ESP + 0x4c]
00543606 : DEC EDX
00543607 : PUSH EDX
00543608 : ADD EAX,0x2
0054360b : PUSH EAX
0054360c : LEA EAX,[ESP + 0x144]
00543613 : PUSH EAX
00543614 : CALL 0x0053bd50
00543619 : ADD ESP,0xc
0054361c : TEST AL,AL
0054361e : JZ 0x0054362f
00543620 : MOV ECX,dword ptr [ESP + 0x13c]
00543627 : PUSH ECX
00543628 : MOV ECX,EDI
0054362a : CALL 0x0053b2f0
0054362f : LEA EDX,[ESP + 0xb8]
00543636 : PUSH EDX
00543637 : LEA EAX,[ESP + 0xa0]
0054363e : PUSH EAX
0054363f : LEA ECX,[ESP + 0x74]
00543643 : CALL 0x0053d850
00543648 : TEST AL,AL
0054364a : JNZ 0x00543470
00543650 : JMP 0x00542ea6
00543655 : LEA ECX,[ESP + 0xa4]
0054365c : PUSH ECX
0054365d : LEA EDX,[ESP + 0xb0]
00543664 : PUSH EDX
00543665 : LEA ECX,[ESP + 0x74]
00543669 : CALL 0x0053d850
0054366e : TEST AL,AL
00543670 : JZ 0x00542ea6
00543676 : JMP 0x00543680
00543680 : MOV EAX,dword ptr [ESP + 0xa4]
00543687 : MOV ECX,dword ptr [ESP + 0xac]
0054368e : PUSH 0x1b
00543690 : PUSH 0xb8bb40
00543695 : PUSH EAX
00543696 : PUSH ECX
00543697 : CALL 0x0053c670
0054369c : MOV ESI,EAX
0054369e : ADD ESP,0x10
005436a1 : TEST ESI,ESI
005436a3 : JZ 0x00543925
005436a9 : LEA EDX,[ESP + 0x38]
005436ad : PUSH EDX
005436ae : LEA EAX,[ESP + 0x4c]
005436b2 : PUSH EAX
005436b3 : LEA ECX,[ESP + 0x74]
005436b7 : CALL 0x0053d910
005436bc : TEST AL,AL
005436be : JZ 0x00543925
005436c4 : MOV ESI,dword ptr [ESI + 0x4]
005436c7 : LEA EAX,[ESI + -0xf]
005436ca : CMP EAX,0x11
005436cd : JA 0x00543925
005436d3 : MOVZX ECX,byte ptr [EAX + 0x543f88]
005436da : JMP dword ptr [ECX*0x4 + 0x543f6c]
005436e1 : MOV EDX,dword ptr [ESP + 0x38]
005436e5 : MOV EAX,dword ptr [ESP + 0x48]
005436e9 : PUSH EDX
005436ea : PUSH EAX
005436eb : LEA ECX,[ESP + 0x134]
005436f2 : PUSH ECX
005436f3 : CALL 0x0053b640
005436f8 : ADD ESP,0xc
005436fb : TEST AL,AL
005436fd : JZ 0x00543925
00543703 : MOV EAX,dword ptr [ESP + 0x10]
00543707 : MOV DX,word ptr [ESP + 0x12c]
0054370f : OR word ptr [EAX + 0x16],0x4
00543714 : MOV word ptr [EAX + 0xe],DX
00543718 : JMP 0x00543925
0054371d : MOV EAX,dword ptr [ESP + 0x38]
00543721 : MOV ECX,dword ptr [ESP + 0x48]
00543725 : PUSH EAX
00543726 : PUSH ECX
00543727 : LEA EDX,[ESP + 0x110]
0054372e : PUSH EDX
0054372f : CALL 0x0053b640
00543734 : ADD ESP,0xc
00543737 : TEST AL,AL
00543739 : JZ 0x00543925
0054373f : MOV ECX,dword ptr [ESP + 0x108]
00543746 : TEST ECX,ECX
00543748 : JL 0x00543925
0054374e : MOV EAX,dword ptr [ESP + 0x10]
00543752 : OR word ptr [EAX + 0x16],0x2
00543757 : MOV word ptr [EAX + 0xc],CX
0054375b : JMP 0x00543925
00543760 : MOV EAX,dword ptr [ESP + 0x38]
00543764 : MOV ECX,dword ptr [ESP + 0x48]
00543768 : PUSH EAX
00543769 : PUSH ECX
0054376a : LEA EDX,[ESP + 0x118]
00543771 : PUSH EDX
00543772 : CALL 0x0053b640
00543777 : ADD ESP,0xc
0054377a : TEST AL,AL
0054377c : JZ 0x00543925
00543782 : MOV EAX,dword ptr [ESP + 0x10]
00543786 : MOV CX,word ptr [ESP + 0x110]
0054378e : OR word ptr [EAX + 0x16],0x8
00543793 : MOV word ptr [EAX + 0x10],CX
00543797 : JMP 0x00543925
0054379c : MOV EDX,dword ptr [ESP + 0x38]
005437a0 : MOV EAX,dword ptr [ESP + 0x48]
005437a4 : PUSH EDX
005437a5 : PUSH EAX
005437a6 : LEA ECX,[ESP + 0x120]
005437ad : PUSH ECX
005437ae : CALL 0x0053b640
005437b3 : ADD ESP,0xc
005437b6 : TEST AL,AL
005437b8 : JZ 0x00543925
005437be : MOV ECX,dword ptr [ESP + 0x118]
005437c5 : TEST ECX,ECX
005437c7 : JL 0x00543925
005437cd : MOV EAX,dword ptr [ESP + 0x10]
005437d1 : OR word ptr [EAX + 0x16],0x10
005437d6 : MOV word ptr [EAX + 0x12],CX
005437da : JMP 0x00543925
005437df : MOV EDX,dword ptr [ESP + 0x38]
005437e3 : MOV EAX,dword ptr [ESP + 0x48]
005437e7 : PUSH EDX
005437e8 : PUSH EAX
005437e9 : LEA ECX,[ESP + 0x128]
005437f0 : PUSH ECX
005437f1 : CALL 0x0053b640
005437f6 : ADD ESP,0xc
005437f9 : TEST AL,AL
005437fb : JZ 0x00543925
00543801 : MOV ECX,dword ptr [ESP + 0x120]
00543808 : TEST ECX,ECX
0054380a : JL 0x00543925
00543810 : MOV EAX,dword ptr [ESP + 0x10]
00543814 : OR word ptr [EAX + 0x16],0x20
00543819 : MOV word ptr [EAX + 0x14],CX
0054381d : JMP 0x00543925
00543822 : MOV EBP,dword ptr [ESP + 0x38]
00543826 : MOV EBX,dword ptr [ESP + 0x48]
0054382a : XOR ESI,ESI
0054382c : TEST EBP,EBP
0054382e : JBE 0x00543846
00543830 : MOVZX EDX,word ptr [EBX + ESI*0x2]
00543834 : PUSH EDX
00543835 : CALL 0x0053b570
0054383a : ADD ESP,0x4
0054383d : TEST AL,AL
0054383f : JZ 0x00543846
00543841 : INC ESI
00543842 : CMP ESI,EBP
00543844 : JC 0x00543830
00543846 : CMP word ptr [EBX + ESI*0x2],0x5b
0054384b : JNZ 0x0054384e
0054384d : INC ESI
0054384e : MOV EDX,0x1
00543853 : MOV EAX,ESI
00543855 : CMP ESI,EBP
00543857 : JNC 0x00543876
00543859 : LEA ESP,[ESP]
00543860 : MOVZX ECX,word ptr [EBX + EAX*0x2]
00543864 : CMP CX,0x5d
00543868 : JZ 0x00543876
0054386a : CMP CX,0x2c
0054386e : JNZ 0x00543871
00543870 : INC EDX
00543871 : INC EAX
00543872 : CMP EAX,EBP
00543874 : JC 0x00543860
00543876 : MOV ECX,dword ptr [ESP + 0x10]
0054387a : PUSH EDX
0054387b : CALL 0x0053b370
00543880 : MOV dword ptr [ESP + 0x18],0x0
00543888 : CMP ESI,EBP
0054388a : JNC 0x00543925
00543890 : CMP word ptr [EBX + ESI*0x2],0x5d
00543895 : JZ 0x00543925
0054389b : XOR EDI,EDI
0054389d : CMP ESI,EBP
0054389f : JNC 0x005438e6
005438a1 : MOVZX EAX,word ptr [EBX + ESI*0x2]
005438a5 : PUSH EAX
005438a6 : CALL 0x0053b5d0
005438ab : ADD ESP,0x4
005438ae : TEST AL,AL
005438b0 : JZ 0x005438c4
005438b2 : MOVZX EDX,word ptr [EBX + ESI*0x2]
005438b6 : INC ESI
005438b7 : LEA ECX,[EDI + EDI*0x4]
005438ba : LEA EDI,[EDX + ECX*0x2 + -0x30]
005438be : CMP ESI,EBP
005438c0 : JC 0x005438a1
005438c2 : JMP 0x005438e6
005438c4 : CMP ESI,EBP
005438c6 : JNC 0x005438e6
005438c8 : JMP 0x005438d0
005438d0 : MOVZX EAX,word ptr [EBX + ESI*0x2]
005438d4 : PUSH EAX
005438d5 : CALL 0x0053b570
005438da : ADD ESP,0x4
005438dd : TEST AL,AL
005438df : JZ 0x005438e6
005438e1 : INC ESI
005438e2 : CMP ESI,EBP
005438e4 : JC 0x005438d0
005438e6 : MOV ECX,dword ptr [ESP + 0x18]
005438ea : PUSH EDI
005438eb : PUSH ECX
005438ec : MOV ECX,dword ptr [ESP + 0x18]
005438f0 : CALL 0x0055e7a0
005438f5 : INC dword ptr [ESP + 0x18]
005438f9 : CMP word ptr [EBX + ESI*0x2],0x2c
005438fe : JNZ 0x0054391d
00543900 : INC ESI
00543901 : CMP ESI,EBP
00543903 : JNC 0x00543925
00543905 : MOVZX EDX,word ptr [EBX + ESI*0x2]
00543909 : PUSH EDX
0054390a : CALL 0x0053b570
0054390f : ADD ESP,0x4
00543912 : TEST AL,AL
00543914 : JZ 0x0054391d
00543916 : INC ESI
00543917 : CMP ESI,EBP
00543919 : JC 0x00543905
0054391b : JMP 0x00543925
0054391d : CMP ESI,EBP
0054391f : JC 0x00543890
00543925 : LEA EAX,[ESP + 0xa4]
0054392c : PUSH EAX
0054392d : LEA ECX,[ESP + 0xb0]
00543934 : PUSH ECX
00543935 : LEA ECX,[ESP + 0x74]
00543939 : CALL 0x0053d850
0054393e : TEST AL,AL
00543940 : JNZ 0x00543680
00543946 : JMP 0x00542ea6
0054394b : LEA EDX,[ESP + 0xb4]
00543952 : PUSH EDX
00543953 : LEA EAX,[ESP + 0xc0]
0054395a : PUSH EAX
0054395b : LEA ECX,[ESP + 0x74]
0054395f : CALL 0x0053d850
00543964 : TEST AL,AL
00543966 : JZ 0x00542ea6
0054396c : MOV EBX,dword ptr [ESP + 0x3ec]
00543973 : MOV EBP,0x10
00543978 : JMP 0x00543980
00543980 : MOV ECX,dword ptr [ESP + 0xb4]
00543987 : MOV EDX,dword ptr [ESP + 0xbc]
0054398e : PUSH 0x1b
00543990 : PUSH 0xb8bb40
00543995 : PUSH ECX
00543996 : PUSH EDX
00543997 : CALL 0x0053c670
0054399c : MOV ESI,EAX
0054399e : ADD ESP,0x10
005439a1 : TEST ESI,ESI
005439a3 : JZ 0x00543a0c
005439a5 : LEA EAX,[ESP + 0x128]
005439ac : PUSH EAX
005439ad : LEA ECX,[ESP + 0x134]
005439b4 : PUSH ECX
005439b5 : LEA ECX,[ESP + 0x74]
005439b9 : CALL 0x0053d910
005439be : TEST AL,AL
005439c0 : JZ 0x00543a0c
005439c2 : CMP dword ptr [ESI + 0x4],EBP
005439c5 : JNZ 0x00543a0c
005439c7 : TEST EBX,EBX
005439c9 : JZ 0x00543a0c
005439cb : MOV EDX,dword ptr [ESP + 0x128]
005439d2 : MOV EAX,dword ptr [ESP + 0x130]
005439d9 : PUSH EDX
005439da : PUSH EAX
005439db : PUSH 0x1
005439dd : MOV ECX,EBX
005439df : CALL 0x0057df30
005439e4 : TEST EAX,EAX
005439e6 : JZ 0x00543a0c
005439e8 : PUSH EAX
005439e9 : LEA ECX,[ESP + 0x2fc]
005439f0 : PUSH ECX
005439f1 : MOV ECX,EDI
005439f3 : CALL 0x0055fca0
005439f8 : PUSH EAX
005439f9 : MOV ECX,EDI
005439fb : CALL 0x00504700
00543a00 : LEA ECX,[ESP + 0x2f8]
00543a07 : CALL 0x00504260
00543a0c : LEA EDX,[ESP + 0xb4]
00543a13 : PUSH EDX
00543a14 : LEA EAX,[ESP + 0xc0]
00543a1b : PUSH EAX
00543a1c : LEA ECX,[ESP + 0x74]
00543a20 : CALL 0x0053d850
00543a25 : TEST AL,AL
00543a27 : JNZ 0x00543980
00543a2d : JMP 0x00542ea6
00543a32 : CMP EAX,0x8005
00543a37 : JNZ 0x00542eaa
00543a3d : XOR ESI,ESI
00543a3f : MOV dword ptr [ESP + 0x64],ESI
00543a43 : MOV dword ptr [ESP + 0x5c],ESI
00543a47 : CMP EAX,0x4
00543a4a : JNZ 0x00543a7c
00543a4c : MOV EAX,dword ptr [ESP + 0x2c]
00543a50 : CMP EAX,ESI
00543a52 : JBE 0x00543a5f
00543a54 : MOV ECX,dword ptr [ESP + 0x28]
00543a58 : IMUL EAX,EAX,0x54
00543a5b : LEA ESI,[EAX + ECX*0x1 + -0x54]
00543a5f : LEA EDX,[ESP + 0x5c]
00543a63 : PUSH EDX
00543a64 : LEA EAX,[ESP + 0x68]
00543a68 : PUSH EAX
00543a69 : LEA ECX,[ESP + 0x74]
00543a6d : CALL 0x0053dbc0
00543a72 : MOV EDI,dword ptr [ESP + 0x64]
00543a76 : MOV EBX,dword ptr [ESP + 0x5c]
00543a7a : JMP 0x00543ab8
00543a7c : MOV EAX,dword ptr [ESP + 0x58]
00543a80 : CMP EAX,ESI
00543a82 : JZ 0x00543a8e
00543a84 : CMP byte ptr [EAX + 0x9],0x0
00543a88 : JNZ 0x00542eaa
00543a8e : CMP dword ptr [ESP + 0x2c],0x0
00543a93 : JBE 0x00542eaa
00543a99 : MOV ECX,dword ptr [ESP + 0x2c]
00543a9d : MOV EDX,dword ptr [ESP + 0x28]
00543aa1 : IMUL ECX,ECX,0x54
00543aa4 : MOV EDI,dword ptr [ECX + EDX*0x1 + -0x54]
00543aa8 : MOV EBX,dword ptr [ECX + EDX*0x1 + -0x50]
00543aac : LEA ESI,[ECX + EDX*0x1 + -0x54]
00543ab0 : MOV dword ptr [ESP + 0x64],EDI
00543ab4 : MOV dword ptr [ESP + 0x5c],EBX
00543ab8 : TEST ESI,ESI
00543aba : JZ 0x00542eaa
00543ac0 : MOV EAX,dword ptr [ESI + 0x4]
00543ac3 : MOV ECX,dword ptr [ESI]
00543ac5 : PUSH EAX
00543ac6 : PUSH ECX
00543ac7 : PUSH EBX
00543ac8 : PUSH EDI
00543ac9 : CALL 0x0053c030
00543ace : ADD ESP,0x10
00543ad1 : TEST EAX,EAX
00543ad3 : JZ 0x00543b67
00543ad9 : PUSH 0xd
00543adb : PUSH 0xb8bc88
00543ae0 : PUSH EBX
00543ae1 : PUSH EDI
00543ae2 : CALL 0x0053c670
00543ae7 : MOV ESI,EAX
00543ae9 : ADD ESP,0x10
00543aec : TEST ESI,ESI
00543aee : JZ 0x00542eaa
00543af4 : CMP dword ptr [ESP + 0x3c],0x0
00543af9 : JZ 0x00542eaa
00543aff : MOV EAX,dword ptr [ESI + 0x4]
00543b02 : CMP EAX,0x7
00543b05 : JZ 0x00543b10
00543b07 : CMP EAX,0x6
00543b0a : JNZ 0x00542eaa
00543b10 : CMP dword ptr [ESP + 0x2c],0x0
00543b15 : JBE 0x00542eaa
00543b1b : MOV EAX,dword ptr [ESP + 0x2c]
00543b1f : NOP
00543b20 : MOV EDX,dword ptr [ESP + 0x28]
00543b24 : MOV ECX,EAX
00543b26 : IMUL ECX,ECX,0x54
00543b29 : LEA ECX,[ECX + EDX*0x1 + -0x54]
00543b2d : MOV ECX,dword ptr [ECX + 0x8]
00543b30 : TEST ECX,ECX
00543b32 : JZ 0x00543b3c
00543b34 : MOV EDI,dword ptr [ESI + 0x4]
00543b37 : CMP EDI,dword ptr [ECX + 0x4]
00543b3a : JZ 0x00543b54
00543b3c : DEC EAX
00543b3d : PUSH EAX
00543b3e : LEA ECX,[ESP + 0x2c]
00543b42 : CALL 0x0053f990
00543b47 : MOV EAX,dword ptr [ESP + 0x2c]
00543b4b : TEST EAX,EAX
00543b4d : JA 0x00543b20
00543b4f : JMP 0x00542ea6
00543b54 : TEST EAX,EAX
00543b56 : JBE 0x00542ea6
00543b5c : MOV EBP,dword ptr [ESP + 0x14]
00543b60 : IMUL EAX,EAX,0x54
00543b63 : LEA ESI,[EAX + EDX*0x1 + -0x54]
00543b67 : MOVZX EAX,word ptr [ESI + 0x52]
00543b6b : MOV EDX,dword ptr [ESP + 0x2c]
00543b6f : MOV EDI,dword ptr [ESI + 0x8]
00543b72 : MOV ESI,dword ptr [ESI + 0xc]
00543b75 : MOV EBX,EAX
00543b77 : SHR EAX,0xb
00543b7a : DEC EDX
00543b7b : AND EAX,0x3
00543b7e : SHR EBX,0x8
00543b81 : PUSH EDX
00543b82 : LEA ECX,[ESP + 0x2c]
00543b86 : AND BL,0x1
00543b89 : MOV dword ptr [ESP + 0x14],EAX
00543b8d : MOV dword ptr [ESP + 0x5c],EDI
00543b91 : CALL 0x0053f990
00543b96 : TEST EDI,EDI
00543b98 : JZ 0x00543be3
00543b9a : MOV EDI,dword ptr [EDI + 0x4]
00543b9d : SUB EDI,0x6
00543ba0 : JZ 0x00543bbd
00543ba2 : SUB EDI,0x1
00543ba5 : JNZ 0x00542eaa
00543bab : DEC dword ptr [ESP + 0x3c]
00543baf : CMP dword ptr [ESP + 0x18],0x8005
00543bb7 : JZ 0x00542eaa
00543bbd : CMP byte ptr [ESP + 0x3e4],0x0
00543bc5 : JZ 0x00542eaa
00543bcb : PUSH 0x1
00543bcd : PUSH 0x1
00543bcf : MOV ECX,EBP
00543bd1 : CALL 0x0053b3c0
00543bd6 : PUSH EAX
00543bd7 : MOV ECX,EBP
00543bd9 : CALL 0x00541fd0
00543bde : JMP 0x00542eaa
00543be3 : CMP dword ptr [ESP + 0x3ec],0x0
00543beb : JZ 0x00542eaa
00543bf1 : TEST BL,BL
00543bf3 : JZ 0x00542eaa
00543bf9 : MOV EAX,dword ptr [ESP + 0x10]
00543bfd : SUB EAX,0x1
00543c00 : JZ 0x00543bbd
00543c02 : SUB EAX,0x1
00543c05 : JNZ 0x00542eaa
00543c0b : MOV ECX,EBP
00543c0d : CALL 0x0053c470
00543c12 : CMP byte ptr [ESP + 0x3e4],0x0
00543c1a : MOV EDI,EAX
00543c1c : JZ 0x00543c31
00543c1e : PUSH 0x1
00543c20 : PUSH 0x1
00543c22 : MOV ECX,EBP
00543c24 : CALL 0x0053b3c0
00543c29 : PUSH EAX
00543c2a : MOV ECX,EBP
00543c2c : CALL 0x00541fd0
00543c31 : SUB EDI,ESI
00543c33 : PUSH EDI
00543c34 : PUSH ESI
00543c35 : MOV ECX,EBP
00543c37 : CALL 0x00542320
00543c3c : JMP 0x00542eaa
00543c41 : XOR ESI,ESI
00543c43 : MOV ECX,dword ptr [EBP + 0x8]
00543c46 : CMP ECX,EBX
00543c48 : JZ 0x00543c4f
00543c4a : CALL 0x004ff7c0
00543c4f : MOV dword ptr [EBP + 0x8],ESI
00543c52 : MOV ESI,dword ptr [ESP + 0x40]
00543c56 : ADD ESI,0x3c
00543c59 : PUSH ESI
00543c5a : JMP 0x00543c75
00543c5c : XOR ESI,ESI
00543c5e : MOV ECX,dword ptr [EBP + 0x8]
00543c61 : CMP ECX,EBX
00543c63 : JZ 0x00543c6a
00543c65 : CALL 0x004ff7c0
00543c6a : MOV dword ptr [EBP + 0x8],ESI
00543c6d : LEA EDX,[ESP + 0x17c]
00543c74 : PUSH EDX
00543c75 : MOV ECX,dword ptr [EBP + 0x8]
00543c78 : CALL 0x00561090
00543c7d : MOV ECX,dword ptr [EBP + 0x18]
00543c80 : MOV ESI,EAX
00543c82 : CMP ECX,EBX
00543c84 : JZ 0x00543c8b
00543c86 : CALL 0x004ff7c0
00543c8b : MOV dword ptr [EBP + 0x18],ESI
00543c8e : MOV ECX,dword ptr [EBP + 0x10]
00543c91 : LEA EAX,[ECX + -0x1]
00543c94 : CMP EAX,EBX
00543c96 : JL 0x00543ca6
00543c98 : CMP EAX,ECX
00543c9a : JGE 0x00543ca6
00543c9c : MOV ECX,dword ptr [EBP + 0xc]
00543c9f : MOV EAX,dword ptr [ECX + EAX*0x4]
00543ca2 : CMP EAX,EBX
00543ca4 : JNZ 0x00543cb2
00543ca6 : PUSH EBX
00543ca7 : MOV ECX,EBP
00543ca9 : CALL 0x00540b60
00543cae : CMP EAX,EBX
00543cb0 : JZ 0x00543ceb
00543cb2 : MOV ECX,dword ptr [EAX + 0x4]
00543cb5 : CMP ECX,EBX
00543cb7 : JBE 0x00543cdc
00543cb9 : MOV EDX,dword ptr [EAX]
00543cbb : LEA ESI,[ECX + -0x1]
00543cbe : CMP EDX,EBX
00543cc0 : JZ 0x00543ccb
00543cc2 : CMP ESI,ECX
00543cc4 : JNC 0x00543ccb
00543cc6 : LEA ECX,[EDX + ESI*0x2]
00543cc9 : JMP 0x00543ccd
00543ccb : XOR ECX,ECX
00543ccd : MOVZX ECX,word ptr [ECX]
00543cd0 : CMP CX,0xd
00543cd4 : JZ 0x00543ceb
00543cd6 : CMP CX,0xa
00543cda : JZ 0x00543ceb
00543cdc : MOV EDX,dword ptr [EBP + 0x1c]
00543cdf : MOV ECX,dword ptr [EBP + 0x8]
00543ce2 : PUSH EDX
00543ce3 : PUSH ECX
00543ce4 : MOV ECX,EAX
00543ce6 : CALL 0x005406c0
00543ceb : MOV ECX,dword ptr [EBP + 0x10]
00543cee : LEA EAX,[ECX + -0x1]
00543cf1 : CMP EAX,EBX
00543cf3 : JL 0x00543e53
00543cf9 : CMP EAX,ECX
00543cfb : JGE 0x00543e53
00543d01 : MOV EDX,dword ptr [EBP + 0xc]
00543d04 : MOV ECX,dword ptr [EDX + EAX*0x4]
00543d07 : CMP ECX,EBX
00543d09 : JZ 0x00543e53
00543d0f : MOV EAX,dword ptr [ECX + 0x4]
00543d12 : CMP EAX,EBX
00543d14 : JBE 0x00543d32
00543d16 : MOV ECX,dword ptr [ECX]
00543d18 : LEA EDX,[EAX + -0x1]
00543d1b : CMP ECX,EBX
00543d1d : JZ 0x00543d28
00543d1f : CMP EDX,EAX
00543d21 : JNC 0x00543d28
00543d23 : LEA ECX,[ECX + EDX*0x2]
00543d26 : JMP 0x00543d2a
00543d28 : XOR ECX,ECX
00543d2a : CMP word ptr [ECX],BX
00543d2d : JNZ 0x00543d30
00543d2f : DEC EAX
00543d30 : CMP EAX,EBX
00543d32 : JNZ 0x00543e53
00543d38 : MOV EDI,dword ptr [EBP + 0x10]
00543d3b : DEC EDI
00543d3c : CMP EDI,EBX
00543d3e : MOV dword ptr [ESP + 0x1c],EDI
00543d42 : JL 0x00543e53
00543d48 : CMP EDI,dword ptr [EBP + 0x10]
00543d4b : JGE 0x00543e53
00543d51 : MOV EAX,dword ptr [EBP + 0xc]
00543d54 : MOV EDX,dword ptr [EAX + EDI*0x4]
00543d57 : MOV EAX,dword ptr [EDX + 0x4]
00543d5a : MOV dword ptr [ESP + 0x40],EDX
00543d5e : CMP EAX,EBX
00543d60 : JBE 0x00543d7c
00543d62 : MOV ECX,dword ptr [EDX]
00543d64 : LEA ESI,[EAX + -0x1]
00543d67 : CMP ECX,EBX
00543d69 : JZ 0x00543d74
00543d6b : CMP ESI,EAX
00543d6d : JNC 0x00543d74
00543d6f : LEA ECX,[ECX + ESI*0x2]
00543d72 : JMP 0x00543d76
00543d74 : XOR ECX,ECX
00543d76 : CMP word ptr [ECX],BX
00543d79 : JNZ 0x00543d7c
00543d7b : DEC EAX
00543d7c : CMP EAX,0x1
00543d7f : JA 0x00543e53
00543d85 : CMP dword ptr [EBP + 0x8],EBX
00543d88 : JNZ 0x00543e38
00543d8e : PUSH EBP
00543d8f : CALL 0x00515dd0
00543d94 : MOV EDI,EAX
00543d96 : PUSH EBX
00543d97 : PUSH 0x50
00543d99 : MOV ECX,EDI
00543d9b : CALL 0x00515840
00543da0 : MOV ESI,EAX
00543da2 : CMP ESI,EBX
00543da4 : JZ 0x00543e1f
00543daa : MOV dword ptr [ESI],0xcd3f2c
00543db0 : MOV EAX,0x1
00543db5 : MOV dword ptr [ESI + 0x4],EAX
00543db8 : MOV dword ptr [ESI],0xb8670c
00543dbe : MOV dword ptr [ESI + 0x8],EBX
00543dc1 : MOV dword ptr [ESI + 0xc],EBX
00543dc4 : MOV ECX,0x64
00543dc9 : MOV dword ptr [ESI + 0x10],ECX
00543dcc : MOV dword ptr [ESI + 0x14],ECX
00543dcf : MOV dword ptr [ESI + 0x18],EAX
00543dd2 : MOV dword ptr [ESI + 0x1c],EDI
00543dd5 : MOV dword ptr [ESI + 0x20],0xcd3f2c
00543ddc : PUSH EDI
00543ddd : LEA ECX,[ESI + 0x28]
00543de0 : MOV dword ptr [ESI + 0x24],EAX
00543de3 : MOV dword ptr [ESI + 0x20],0xb86530
00543dea : CALL 0x0051c350
00543def : PUSH EDI
00543df0 : LEA ECX,[ESI + 0x30]
00543df3 : CALL 0x0051c350
00543df8 : MOV dword ptr [ESI + 0x38],EBX
00543dfb : MOV dword ptr [ESI + 0x3c],EBX
00543dfe : XOR EDX,EDX
00543e00 : XOR ECX,ECX
00543e02 : XOR EAX,EAX
00543e04 : MOV dword ptr [ESI + 0x40],0xff000000
00543e0b : MOV word ptr [ESI + 0x44],CX
00543e0f : MOV word ptr [ESI + 0x46],DX
00543e13 : MOV byte ptr [ESI + 0x48],DL
00543e16 : MOV word ptr [ESI + 0x4a],AX
00543e1a : MOV byte ptr [ESI + 0x4c],AL
00543e1d : JMP 0x00543e21
00543e1f : XOR ESI,ESI
00543e21 : MOV ECX,dword ptr [EBP + 0x8]
00543e24 : CMP ECX,EBX
00543e26 : JZ 0x00543e2d
00543e28 : CALL 0x004ff7c0
00543e2d : MOV EDX,dword ptr [ESP + 0x40]
00543e31 : MOV EDI,dword ptr [ESP + 0x1c]
00543e35 : MOV dword ptr [EBP + 0x8],ESI
00543e38 : MOV EAX,dword ptr [EBP + 0x8]
00543e3b : PUSH -0x1
00543e3d : PUSH EBX
00543e3e : LEA ECX,[ESP + 0x158]
00543e45 : PUSH ECX
00543e46 : PUSH EAX
00543e47 : MOV ECX,EDX
00543e49 : CALL 0x00540450
00543e4e : JMP 0x00543d3b
00543e53 : LEA ECX,[ESP + 0x150]
00543e5a : CALL 0x00504260
00543e5f : LEA ECX,[ESP + 0x17c]
00543e66 : MOV dword ptr [ESP + 0x17c],0xb86064
00543e71 : CALL 0x0055e7c0
00543e76 : LEA ECX,[ESP + 0x17c]
00543e7d : CALL 0x004ff7b0
00543e82 : LEA ECX,[ESP + 0xd4]
00543e89 : CALL 0x00504260
00543e8e : MOV ECX,dword ptr [ESP + 0x88]
00543e95 : PUSH ECX
00543e96 : CALL 0x00515cf0
00543e9b : MOV EDX,dword ptr [ESP + 0x2c]
00543e9f : MOV ESI,dword ptr [ESP + 0x28]
00543ea3 : PUSH EDX
00543ea4 : PUSH ESI
00543ea5 : CALL 0x0053f4d0
00543eaa : ADD ESP,0x8
00543ead : PUSH ESI
00543eae : CALL 0x00515cf0
00543eb3 : POP EDI
00543eb4 : POP ESI
00543eb5 : POP EBP
00543eb6 : MOV AL,0x1
00543eb8 : POP EBX
00543eb9 : ADD ESP,0x3c4
00543ebf : RET 0x18

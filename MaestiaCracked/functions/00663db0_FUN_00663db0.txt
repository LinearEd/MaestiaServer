PROGRAM  : Maestia.exe
FUNCTION : FUN_00663db0
ENTRY    : 00663db0
BODY     : [[00663db0, 00663e60]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00663db0(int param_1,int *param_2)

{
  int *piVar1;
  int iVar2;
  int *piVar3;
  short *psVar4;
  
  if (param_2 == (int *)0x0) {
    return 0x80004003;
  }
  if (*(int *)(param_1 + 0x1c) == 0) {
    iVar2 = 0;
  }
  else {
    iVar2 = *(int *)(param_1 + 0x1c) + 0xc;
  }
  *param_2 = iVar2;
  if (*(int *)(param_1 + 0x1c) != 0) {
    (**(code **)(*(int *)(*(int *)(param_1 + 0x1c) + 0xc) + 4))(*(int *)(param_1 + 0x1c) + 0xc);
  }
  psVar4 = *(short **)(param_1 + 8);
  if (psVar4 != (short *)0x0) {
    iVar2 = 0x80;
    piVar1 = param_2 + 2;
    while ((piVar3 = piVar1, iVar2 != -0x7fffff7e && (*psVar4 != 0))) {
      *(short *)piVar3 = *psVar4;
      psVar4 = psVar4 + 1;
      iVar2 = iVar2 + -1;
      piVar1 = (int *)((int)piVar3 + 2);
      if (iVar2 == 0) {
        *(short *)piVar3 = 0;
        param_2[1] = *(int *)(param_1 + 0x10);
        return 0;
      }
    }
    if (iVar2 == 0) {
      piVar3 = (int *)((int)piVar3 + -2);
    }
    *(short *)piVar3 = 0;
    param_2[1] = *(int *)(param_1 + 0x10);
    return 0;
  }
  *(undefined2 *)(param_2 + 2) = 0;
  param_2[1] = *(int *)(param_1 + 0x10);
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00663db0 : PUSH EBX
00663db1 : MOV EBX,dword ptr [ESP + 0xc]
00663db5 : TEST EBX,EBX
00663db7 : JNZ 0x00663dc2
00663db9 : MOV EAX,0x80004003
00663dbe : POP EBX
00663dbf : RET 0x8
00663dc2 : PUSH EDI
00663dc3 : MOV EDI,dword ptr [ESP + 0xc]
00663dc7 : MOV EAX,dword ptr [EDI + 0x1c]
00663dca : TEST EAX,EAX
00663dcc : JZ 0x00663dd3
00663dce : ADD EAX,0xc
00663dd1 : JMP 0x00663dd5
00663dd3 : XOR EAX,EAX
00663dd5 : MOV dword ptr [EBX],EAX
00663dd7 : CMP dword ptr [EDI + 0x1c],0x0
00663ddb : JZ 0x00663dec
00663ddd : MOV EAX,dword ptr [EDI + 0x1c]
00663de0 : MOV ECX,dword ptr [EAX + 0xc]
00663de3 : MOV EDX,dword ptr [ECX + 0x4]
00663de6 : ADD EAX,0xc
00663de9 : PUSH EAX
00663dea : CALL EDX
00663dec : MOV EDX,dword ptr [EDI + 0x8]
00663def : TEST EDX,EDX
00663df1 : JZ 0x00663e50
00663df3 : PUSH ESI
00663df4 : MOV ESI,0x80
00663df9 : LEA EAX,[EBX + 0x8]
00663dfc : LEA ESP,[ESP]
00663e00 : LEA ECX,[ESI + 0x7fffff7e]
00663e06 : TEST ECX,ECX
00663e08 : JZ 0x00663e36
00663e0a : MOVZX ECX,word ptr [EDX]
00663e0d : TEST CX,CX
00663e10 : JZ 0x00663e36
00663e12 : MOV word ptr [EAX],CX
00663e15 : ADD EAX,0x2
00663e18 : ADD EDX,0x2
00663e1b : SUB ESI,0x1
00663e1e : JNZ 0x00663e00
00663e20 : SUB EAX,0x2
00663e23 : XOR EDX,EDX
00663e25 : MOV word ptr [EAX],DX
00663e28 : MOV ECX,dword ptr [EDI + 0x10]
00663e2b : POP ESI
00663e2c : POP EDI
00663e2d : MOV dword ptr [EBX + 0x4],ECX
00663e30 : XOR EAX,EAX
00663e32 : POP EBX
00663e33 : RET 0x8
00663e36 : TEST ESI,ESI
00663e38 : JNZ 0x00663e3d
00663e3a : SUB EAX,0x2
00663e3d : XOR EDX,EDX
00663e3f : MOV word ptr [EAX],DX
00663e42 : MOV ECX,dword ptr [EDI + 0x10]
00663e45 : POP ESI
00663e46 : POP EDI
00663e47 : MOV dword ptr [EBX + 0x4],ECX
00663e4a : XOR EAX,EAX
00663e4c : POP EBX
00663e4d : RET 0x8
00663e50 : XOR EAX,EAX
00663e52 : MOV word ptr [EBX + 0x8],AX
00663e56 : MOV ECX,dword ptr [EDI + 0x10]
00663e59 : POP EDI
00663e5a : MOV dword ptr [EBX + 0x4],ECX
00663e5d : POP EBX
00663e5e : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_00689630
ENTRY    : 00689630
BODY     : [[00689630, 00689667] [00689670, 00689864]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00689630(undefined4 *param_1,undefined4 param_2,int param_3,int param_4,undefined4 param_5)

{
  int in_EAX;
  int iVar1;
  undefined1 *puVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int local_14;
  int local_10;
  int local_c;
  int local_8;
  undefined4 local_4;
  
  local_4 = *param_1;
  local_14 = 1;
  if ((in_EAX != -1) && (in_EAX != 0)) {
    return 1;
  }
  iVar6 = 0;
  iVar5 = 0;
  if (0 < param_4) {
    do {
      local_14 = FUN_006877c0(param_2,*(undefined4 *)(param_3 + iVar5 * 4));
      if (local_14 != 0) {
        return local_14;
      }
      iVar1 = FUN_00687bd0(param_2,&local_14);
      if (local_14 != 0) {
        return local_14;
      }
      iVar5 = iVar5 + 1;
      iVar6 = iVar6 + 6 + iVar1;
    } while (iVar5 < param_4);
  }
  puVar2 = (undefined1 *)FUN_00688c00(local_4,iVar6 + 2,&local_14);
  if (local_14 != 0) {
    return local_14;
  }
  iVar5 = 0;
  iVar1 = 6;
  *puVar2 = 0x80;
  puVar2[1] = 1;
  puVar2[2] = 0;
  puVar2[3] = 0;
  puVar2[4] = 0;
  puVar2[5] = 0;
  iVar6 = 2;
  local_8 = 1;
  local_c = 0;
  if (0 < param_4) {
    do {
      local_14 = FUN_006877c0(param_2,*(undefined4 *)(param_3 + local_c * 4));
      if (local_14 != 0) {
        FUN_00687f30(local_4,puVar2);
        return local_14;
      }
      local_10 = FUN_00687bd0(param_2,&local_14);
      if (local_14 != 0) {
        return local_14;
      }
      uVar3 = FUN_00687a80(param_2,&local_14);
      if (local_14 != 0) {
        return local_14;
      }
      local_10 = local_10 + -2;
      iVar4 = (int)(uVar3 & 0xffff) >> 8;
      if (iVar4 == local_8) {
        iVar5 = iVar5 + local_10;
      }
      else {
        puVar2[iVar6 + 1] = (char)((uint)iVar5 >> 8);
        puVar2[iVar6 + 2] = (char)((uint)iVar5 >> 0x10);
        puVar2[iVar6] = (char)iVar5;
        puVar2[iVar6 + 3] = (char)((uint)iVar5 >> 0x18);
        if (iVar4 == 5) break;
        puVar2[iVar1] = 0x80;
        puVar2[iVar1 + 1] = (char)((uVar3 & 0xffff) >> 8);
        iVar6 = iVar1 + 2;
        puVar2[iVar6] = 0;
        puVar2[iVar1 + 3] = 0;
        puVar2[iVar1 + 4] = 0;
        puVar2[iVar1 + 5] = 0;
        iVar1 = iVar1 + 6;
        iVar5 = local_10;
        local_8 = iVar4;
      }
      FUN_006888a0(param_2,puVar2 + iVar1,local_10);
      iVar1 = iVar1 + local_10;
      local_c = local_c + 1;
    } while (local_c < param_4);
  }
  puVar2[iVar1] = 0x80;
  puVar2[iVar1 + 1] = 3;
  puVar2[iVar6] = (char)iVar5;
  puVar2[iVar6 + 1] = (char)((uint)iVar5 >> 8);
  puVar2[iVar6 + 2] = (char)((uint)iVar5 >> 0x10);
  puVar2[iVar6 + 3] = (char)((uint)iVar5 >> 0x18);
  iVar6 = FUN_00689570(0,"type1",param_5);
  return iVar6;
}



============================================================
DISASSEMBLY
============================================================
00689630 : SUB ESP,0x14
00689633 : MOV ECX,dword ptr [ESP + 0x18]
00689637 : MOV EDX,dword ptr [ECX]
00689639 : MOV dword ptr [ESP],0x1
00689640 : MOV dword ptr [ESP + 0x10],EDX
00689644 : CMP EAX,-0x1
00689647 : JZ 0x00689656
00689649 : TEST EAX,EAX
0068964b : JZ 0x00689656
0068964d : MOV EAX,0x1
00689652 : ADD ESP,0x14
00689655 : RET
00689656 : PUSH EBX
00689657 : PUSH EBP
00689658 : MOV EBP,dword ptr [ESP + 0x2c]
0068965c : PUSH ESI
0068965d : PUSH EDI
0068965e : XOR EDI,EDI
00689660 : XOR ESI,ESI
00689662 : TEST EBP,EBP
00689664 : JLE 0x006896b3
00689666 : JMP 0x00689670
00689670 : MOV EAX,dword ptr [ESP + 0x30]
00689674 : MOV ECX,dword ptr [EAX + ESI*0x4]
00689677 : MOV EBX,dword ptr [ESP + 0x2c]
0068967b : PUSH ECX
0068967c : PUSH EBX
0068967d : CALL 0x006877c0
00689682 : ADD ESP,0x8
00689685 : MOV dword ptr [ESP + 0x10],EAX
00689689 : TEST EAX,EAX
0068968b : JNZ 0x00689843
00689691 : LEA EDX,[ESP + 0x10]
00689695 : PUSH EDX
00689696 : PUSH EBX
00689697 : CALL 0x00687bd0
0068969c : ADD ESP,0x8
0068969f : CMP dword ptr [ESP + 0x10],0x0
006896a4 : JNZ 0x00689859
006896aa : INC ESI
006896ab : CMP ESI,EBP
006896ad : LEA EDI,[EDI + EAX*0x1 + 0x6]
006896b1 : JL 0x00689670
006896b3 : MOV ECX,dword ptr [ESP + 0x20]
006896b7 : LEA EAX,[ESP + 0x10]
006896bb : PUSH EAX
006896bc : ADD EDI,0x2
006896bf : PUSH EDI
006896c0 : PUSH ECX
006896c1 : CALL 0x00688c00
006896c6 : ADD ESP,0xc
006896c9 : CMP dword ptr [ESP + 0x10],0x0
006896ce : MOV EDI,EAX
006896d0 : JNZ 0x00689859
006896d6 : XOR EBX,EBX
006896d8 : CMP dword ptr [ESP + 0x34],EBX
006896dc : MOV ESI,0x6
006896e1 : MOV byte ptr [EDI],0x80
006896e4 : MOV byte ptr [EDI + 0x1],0x1
006896e8 : MOV byte ptr [EDI + 0x2],0x0
006896ec : MOV byte ptr [EDI + 0x3],0x0
006896f0 : MOV byte ptr [EDI + 0x4],0x0
006896f4 : MOV byte ptr [EDI + 0x5],0x0
006896f8 : LEA EBP,[ESI + -0x4]
006896fb : MOV dword ptr [ESP + 0x1c],0x1
00689703 : MOV dword ptr [ESP + 0x18],EBX
00689707 : JLE 0x00689800
0068970d : LEA ECX,[ECX]
00689710 : MOV EDX,dword ptr [ESP + 0x30]
00689714 : MOV EAX,dword ptr [ESP + 0x18]
00689718 : MOV ECX,dword ptr [EDX + EAX*0x4]
0068971b : MOV EDX,dword ptr [ESP + 0x2c]
0068971f : PUSH ECX
00689720 : PUSH EDX
00689721 : CALL 0x006877c0
00689726 : ADD ESP,0x8
00689729 : MOV dword ptr [ESP + 0x10],EAX
0068972d : TEST EAX,EAX
0068972f : JNZ 0x0068984b
00689735 : MOV ECX,dword ptr [ESP + 0x2c]
00689739 : LEA EAX,[ESP + 0x10]
0068973d : PUSH EAX
0068973e : PUSH ECX
0068973f : CALL 0x00687bd0
00689744 : ADD ESP,0x8
00689747 : CMP dword ptr [ESP + 0x10],0x0
0068974c : MOV dword ptr [ESP + 0x14],EAX
00689750 : JNZ 0x00689859
00689756 : MOV EAX,dword ptr [ESP + 0x2c]
0068975a : LEA EDX,[ESP + 0x10]
0068975e : PUSH EDX
0068975f : PUSH EAX
00689760 : CALL 0x00687a80
00689765 : ADD ESP,0x8
00689768 : CMP dword ptr [ESP + 0x10],0x0
0068976d : MOVZX EAX,AX
00689770 : JNZ 0x00689859
00689776 : MOV ECX,dword ptr [ESP + 0x14]
0068977a : SUB ECX,0x2
0068977d : SAR EAX,0x8
00689780 : MOV dword ptr [ESP + 0x14],ECX
00689784 : CMP EAX,dword ptr [ESP + 0x1c]
00689788 : JNZ 0x0068978e
0068978a : ADD EBX,ECX
0068978c : JMP 0x006897d7
0068978e : MOV EDX,EBX
00689790 : SAR EDX,0x8
00689793 : MOV byte ptr [EDI + EBP*0x1 + 0x1],DL
00689797 : MOV EDX,EBX
00689799 : SAR EDX,0x10
0068979c : MOV byte ptr [EDI + EBP*0x1 + 0x2],DL
006897a0 : MOV EDX,EBX
006897a2 : SAR EDX,0x18
006897a5 : MOV byte ptr [EDI + EBP*0x1],BL
006897a8 : MOV byte ptr [EDI + EBP*0x1 + 0x3],DL
006897ac : CMP EAX,0x5
006897af : JZ 0x00689800
006897b1 : MOV byte ptr [ESI + EDI*0x1],0x80
006897b5 : MOV byte ptr [ESI + EDI*0x1 + 0x1],AL
006897b9 : INC ESI
006897ba : INC ESI
006897bb : MOV byte ptr [ESI + EDI*0x1],0x0
006897bf : MOV EBP,ESI
006897c1 : INC ESI
006897c2 : MOV byte ptr [ESI + EDI*0x1],0x0
006897c6 : INC ESI
006897c7 : MOV byte ptr [ESI + EDI*0x1],0x0
006897cb : INC ESI
006897cc : MOV byte ptr [ESI + EDI*0x1],0x0
006897d0 : MOV dword ptr [ESP + 0x1c],EAX
006897d4 : MOV EBX,ECX
006897d6 : INC ESI
006897d7 : PUSH ECX
006897d8 : MOV ECX,dword ptr [ESP + 0x30]
006897dc : LEA EAX,[ESI + EDI*0x1]
006897df : PUSH EAX
006897e0 : PUSH ECX
006897e1 : CALL 0x006888a0
006897e6 : MOV EAX,dword ptr [ESP + 0x24]
006897ea : ADD ESI,dword ptr [ESP + 0x20]
006897ee : INC EAX
006897ef : ADD ESP,0xc
006897f2 : CMP EAX,dword ptr [ESP + 0x34]
006897f6 : MOV dword ptr [ESP + 0x18],EAX
006897fa : JL 0x00689710
00689800 : MOV EDX,dword ptr [ESP + 0x38]
00689804 : MOV byte ptr [ESI + EDI*0x1],0x80
00689808 : MOV byte ptr [ESI + EDI*0x1 + 0x1],0x3
0068980d : PUSH EDX
0068980e : MOV EDX,dword ptr [ESP + 0x2c]
00689812 : INC ESI
00689813 : MOV EAX,EBX
00689815 : MOV ECX,EBX
00689817 : SAR EAX,0x8
0068981a : SAR ECX,0x10
0068981d : MOV byte ptr [EDI + EBP*0x1],BL
00689820 : MOV byte ptr [EDI + EBP*0x1 + 0x1],AL
00689824 : MOV byte ptr [EDI + EBP*0x1 + 0x2],CL
00689828 : PUSH 0xbd8508
0068982d : SAR EBX,0x18
00689830 : PUSH 0x0
00689832 : LEA EAX,[ESI + 0x1]
00689835 : MOV ECX,EDI
00689837 : MOV byte ptr [EDI + EBP*0x1 + 0x3],BL
0068983b : CALL 0x00689570
00689840 : ADD ESP,0xc
00689843 : POP EDI
00689844 : POP ESI
00689845 : POP EBP
00689846 : POP EBX
00689847 : ADD ESP,0x14
0068984a : RET
0068984b : MOV EDX,dword ptr [ESP + 0x20]
0068984f : PUSH EDI
00689850 : PUSH EDX
00689851 : CALL 0x00687f30
00689856 : ADD ESP,0x8
00689859 : MOV EAX,dword ptr [ESP + 0x10]
0068985d : POP EDI
0068985e : POP ESI
0068985f : POP EBP
00689860 : POP EBX
00689861 : ADD ESP,0x14
00689864 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_006ceb00
ENTRY    : 006ceb00
BODY     : [[006ceb00, 006ceca5]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006ceb00(int param_1,int param_2,int param_3,int param_4)

{
  void *_Dst;
  char *_Source;
  undefined4 uVar1;
  char *_Dest;
  int local_8;
  
  if (((param_1 != 0) && (param_2 != 0)) && (param_4 != 0)) {
    _Dst = (void *)FUN_006cef50(param_1,(*(int *)(param_2 + 0xc0) + param_4) * 0x14);
    if (_Dst == (void *)0x0) {
      FUN_006c24c0(param_1,"Out of memory while processing unknown chunk.");
    }
    else {
      _memcpy(_Dst,*(void **)(param_2 + 0xbc),*(int *)(param_2 + 0xc0) * 0x14);
      FUN_006ceee0(param_1,*(undefined4 *)(param_2 + 0xbc));
      *(undefined4 *)(param_2 + 0xbc) = 0;
      for (local_8 = 0; local_8 < param_4; local_8 = local_8 + 1) {
        _Dest = (char *)((int)_Dst + local_8 * 0x14 + *(int *)(param_2 + 0xc0) * 0x14);
        _Source = (char *)(local_8 * 0x14 + param_3);
        _strncpy(_Dest,_Source,5);
        uVar1 = FUN_006cef50(param_1,*(undefined4 *)(_Source + 0xc));
        *(undefined4 *)(_Dest + 8) = uVar1;
        if (*(int *)(_Dest + 8) == 0) {
          FUN_006c24c0(param_1,"Out of memory processing unknown chunk.");
        }
        else {
          _memcpy(*(void **)(_Dest + 8),*(void **)(_Source + 8),*(size_t *)(_Source + 0xc));
          *(undefined4 *)(_Dest + 0xc) = *(undefined4 *)(_Source + 0xc);
          _Dest[0x10] = (char)*(undefined4 *)(param_1 + 0x68);
        }
      }
      *(void **)(param_2 + 0xbc) = _Dst;
      *(int *)(param_2 + 0xc0) = *(int *)(param_2 + 0xc0) + param_4;
      *(uint *)(param_2 + 0xb8) = *(uint *)(param_2 + 0xb8) | 0x200;
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
006ceb00 : PUSH EBP
006ceb01 : MOV EBP,ESP
006ceb03 : SUB ESP,0x10
006ceb06 : CMP dword ptr [EBP + 0x8],0x0
006ceb0a : JZ 0x006ceb18
006ceb0c : CMP dword ptr [EBP + 0xc],0x0
006ceb10 : JZ 0x006ceb18
006ceb12 : CMP dword ptr [EBP + 0x14],0x0
006ceb16 : JNZ 0x006ceb1d
006ceb18 : JMP 0x006ceca2
006ceb1d : MOV EAX,dword ptr [EBP + 0xc]
006ceb20 : MOV ECX,dword ptr [EAX + 0xc0]
006ceb26 : ADD ECX,dword ptr [EBP + 0x14]
006ceb29 : IMUL ECX,ECX,0x14
006ceb2c : PUSH ECX
006ceb2d : MOV EDX,dword ptr [EBP + 0x8]
006ceb30 : PUSH EDX
006ceb31 : CALL 0x006cef50
006ceb36 : ADD ESP,0x8
006ceb39 : MOV dword ptr [EBP + -0x8],EAX
006ceb3c : CMP dword ptr [EBP + -0x8],0x0
006ceb40 : JNZ 0x006ceb58
006ceb42 : PUSH 0xbedf6c
006ceb47 : MOV EAX,dword ptr [EBP + 0x8]
006ceb4a : PUSH EAX
006ceb4b : CALL 0x006c24c0
006ceb50 : ADD ESP,0x8
006ceb53 : JMP 0x006ceca2
006ceb58 : MOV ECX,dword ptr [EBP + 0xc]
006ceb5b : MOV EDX,dword ptr [ECX + 0xc0]
006ceb61 : IMUL EDX,EDX,0x14
006ceb64 : PUSH EDX
006ceb65 : MOV EAX,dword ptr [EBP + 0xc]
006ceb68 : MOV ECX,dword ptr [EAX + 0xbc]
006ceb6e : PUSH ECX
006ceb6f : MOV EDX,dword ptr [EBP + -0x8]
006ceb72 : PUSH EDX
006ceb73 : CALL 0x0063ae40
006ceb78 : ADD ESP,0xc
006ceb7b : MOV EAX,dword ptr [EBP + 0xc]
006ceb7e : MOV ECX,dword ptr [EAX + 0xbc]
006ceb84 : PUSH ECX
006ceb85 : MOV EDX,dword ptr [EBP + 0x8]
006ceb88 : PUSH EDX
006ceb89 : CALL 0x006ceee0
006ceb8e : ADD ESP,0x8
006ceb91 : MOV EAX,dword ptr [EBP + 0xc]
006ceb94 : MOV dword ptr [EAX + 0xbc],0x0
006ceb9e : MOV dword ptr [EBP + -0x4],0x0
006ceba5 : JMP 0x006cebb0
006ceba7 : MOV ECX,dword ptr [EBP + -0x4]
006cebaa : ADD ECX,0x1
006cebad : MOV dword ptr [EBP + -0x4],ECX
006cebb0 : MOV EDX,dword ptr [EBP + -0x4]
006cebb3 : CMP EDX,dword ptr [EBP + 0x14]
006cebb6 : JGE 0x006cec69
006cebbc : MOV EAX,dword ptr [EBP + 0xc]
006cebbf : MOV ECX,dword ptr [EAX + 0xc0]
006cebc5 : IMUL ECX,ECX,0x14
006cebc8 : ADD ECX,dword ptr [EBP + -0x8]
006cebcb : MOV EDX,dword ptr [EBP + -0x4]
006cebce : IMUL EDX,EDX,0x14
006cebd1 : ADD ECX,EDX
006cebd3 : MOV dword ptr [EBP + -0xc],ECX
006cebd6 : MOV EAX,dword ptr [EBP + -0x4]
006cebd9 : IMUL EAX,EAX,0x14
006cebdc : ADD EAX,dword ptr [EBP + 0x10]
006cebdf : MOV dword ptr [EBP + -0x10],EAX
006cebe2 : PUSH 0x5
006cebe4 : MOV ECX,dword ptr [EBP + -0x10]
006cebe7 : PUSH ECX
006cebe8 : MOV EDX,dword ptr [EBP + -0xc]
006cebeb : PUSH EDX
006cebec : CALL 0x00636e50
006cebf1 : ADD ESP,0xc
006cebf4 : MOV EAX,dword ptr [EBP + -0x10]
006cebf7 : MOV ECX,dword ptr [EAX + 0xc]
006cebfa : PUSH ECX
006cebfb : MOV EDX,dword ptr [EBP + 0x8]
006cebfe : PUSH EDX
006cebff : CALL 0x006cef50
006cec04 : ADD ESP,0x8
006cec07 : MOV ECX,dword ptr [EBP + -0xc]
006cec0a : MOV dword ptr [ECX + 0x8],EAX
006cec0d : MOV EDX,dword ptr [EBP + -0xc]
006cec10 : CMP dword ptr [EDX + 0x8],0x0
006cec14 : JNZ 0x006cec29
006cec16 : PUSH 0xbedf44
006cec1b : MOV EAX,dword ptr [EBP + 0x8]
006cec1e : PUSH EAX
006cec1f : CALL 0x006c24c0
006cec24 : ADD ESP,0x8
006cec27 : JMP 0x006cec64
006cec29 : MOV ECX,dword ptr [EBP + -0x10]
006cec2c : MOV EDX,dword ptr [ECX + 0xc]
006cec2f : PUSH EDX
006cec30 : MOV EAX,dword ptr [EBP + -0x10]
006cec33 : MOV ECX,dword ptr [EAX + 0x8]
006cec36 : PUSH ECX
006cec37 : MOV EDX,dword ptr [EBP + -0xc]
006cec3a : MOV EAX,dword ptr [EDX + 0x8]
006cec3d : PUSH EAX
006cec3e : CALL 0x0063ae40
006cec43 : ADD ESP,0xc
006cec46 : MOV ECX,dword ptr [EBP + -0xc]
006cec49 : MOV EDX,dword ptr [EBP + -0x10]
006cec4c : MOV EAX,dword ptr [EDX + 0xc]
006cec4f : MOV dword ptr [ECX + 0xc],EAX
006cec52 : MOV ECX,dword ptr [EBP + 0x8]
006cec55 : MOV EDX,dword ptr [ECX + 0x68]
006cec58 : AND EDX,0xff
006cec5e : MOV EAX,dword ptr [EBP + -0xc]
006cec61 : MOV byte ptr [EAX + 0x10],DL
006cec64 : JMP 0x006ceba7
006cec69 : MOV ECX,dword ptr [EBP + 0xc]
006cec6c : MOV EDX,dword ptr [EBP + -0x8]
006cec6f : MOV dword ptr [ECX + 0xbc],EDX
006cec75 : MOV EAX,dword ptr [EBP + 0xc]
006cec78 : MOV ECX,dword ptr [EAX + 0xc0]
006cec7e : ADD ECX,dword ptr [EBP + 0x14]
006cec81 : MOV EDX,dword ptr [EBP + 0xc]
006cec84 : MOV dword ptr [EDX + 0xc0],ECX
006cec8a : MOV EAX,dword ptr [EBP + 0xc]
006cec8d : MOV ECX,dword ptr [EAX + 0xb8]
006cec93 : OR ECX,0x200
006cec99 : MOV EDX,dword ptr [EBP + 0xc]
006cec9c : MOV dword ptr [EDX + 0xb8],ECX
006ceca2 : MOV ESP,EBP
006ceca4 : POP EBP
006ceca5 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_0052a190
ENTRY    : 0052a190
BODY     : [[0052a190, 0052a2f6]]

============================================================
DECOMPILED C CODE
============================================================

undefined1 FUN_0052a190(int param_1,int *param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  int *piVar2;
  char cVar3;
  undefined1 uVar4;
  int iVar5;
  int iVar6;
  int *in_ECX;
  undefined1 local_10 [4];
  int local_c;
  
  iVar5 = param_1;
  iVar1 = param_1 + 0x78;
  if (*param_2 != *(int *)(*(int *)(param_1 + 0x78) + 0x11c)) {
    if (((*(char *)(in_ECX[8] + 0x2a4) == '\x01') &&
        (*param_2 == *(int *)(*(int *)(param_1 + 0x78) + 0x120))) &&
       (iVar6 = (**(code **)(**(int **)(param_1 + 0x74) + 0x40))(), iVar6 != 0)) {
      uVar4 = FUN_00526120(iVar5);
      FUN_0052a160(uVar4);
    }
    uVar4 = FUN_00552480(iVar1,param_2,param_3,param_4);
    return uVar4;
  }
  cVar3 = FUN_00526120(param_1);
  *(char *)(in_ECX[8] + 0x2a4) = (cVar3 == '\0') + '\x01';
  if (*(char *)(in_ECX[8] + 0x2a4) == '\x01') {
    iVar5 = FUN_00525380("3.1.82",6,0);
    *(int *)(iVar5 + 8) = *(int *)(iVar5 + 8) + 1;
    local_10[0] = 5;
    *(int *)(iVar5 + 8) = *(int *)(iVar5 + 8) + 1;
    local_c = iVar5;
    FUN_00500670(iVar1,"gfxVersion",local_10);
    FUN_00526bc0();
    piVar2 = (int *)(iVar5 + 8);
    *piVar2 = *piVar2 + -1;
    iVar5 = param_1;
    if (*piVar2 == 0) {
      FUN_00525340();
      iVar5 = param_1;
    }
  }
  else {
    param_1 = FUN_00525380("gfxVersion",10,0);
    *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 1;
    (**(code **)(*in_ECX + 0x18))(iVar1,&param_1);
    *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + -1;
    if (*(int *)(param_1 + 8) == 0) {
      FUN_00525340();
    }
  }
  local_10[0] = 10;
  uVar4 = FUN_005520e0(iVar5,param_2,local_10,param_4);
  FUN_00526bc0();
  return uVar4;
}



============================================================
DISASSEMBLY
============================================================
0052a190 : SUB ESP,0x10
0052a193 : PUSH EBX
0052a194 : PUSH EBP
0052a195 : PUSH ESI
0052a196 : PUSH EDI
0052a197 : MOV EDI,dword ptr [ESP + 0x24]
0052a19b : MOV EAX,dword ptr [EDI + 0x78]
0052a19e : MOV ESI,ECX
0052a1a0 : MOV ECX,dword ptr [ESP + 0x28]
0052a1a4 : MOV ECX,dword ptr [ECX]
0052a1a6 : LEA EBP,[EDI + 0x78]
0052a1a9 : CMP ECX,dword ptr [EAX + 0x11c]
0052a1af : JNZ 0x0052a29d
0052a1b5 : MOV ECX,dword ptr [ESP + 0x2c]
0052a1b9 : PUSH EDI
0052a1ba : CALL 0x00526120
0052a1bf : TEST AL,AL
0052a1c1 : MOV EAX,dword ptr [ESI + 0x20]
0052a1c4 : SETZ DL
0052a1c7 : INC DL
0052a1c9 : MOV byte ptr [EAX + 0x2a4],DL
0052a1cf : MOV EAX,dword ptr [ESI + 0x20]
0052a1d2 : MOV EBX,0x1
0052a1d7 : PUSH 0x0
0052a1d9 : LEA ECX,[EAX + 0x254]
0052a1df : CMP byte ptr [EAX + 0x2a4],BL
0052a1e5 : JNZ 0x0052a263
0052a1e7 : PUSH 0x6
0052a1e9 : PUSH 0xb8b1fc
0052a1ee : CALL 0x00525380
0052a1f3 : LEA ECX,[ESP + 0x10]
0052a1f7 : PUSH ECX
0052a1f8 : MOV EDI,EAX
0052a1fa : ADD dword ptr [EDI + 0x8],EBX
0052a1fd : PUSH 0xb8b1f0
0052a202 : MOV byte ptr [ESP + 0x18],0x5
0052a207 : MOV dword ptr [ESP + 0x1c],EDI
0052a20b : ADD dword ptr [EDI + 0x8],EBX
0052a20e : PUSH EBP
0052a20f : MOV ECX,ESI
0052a211 : CALL 0x00500670
0052a216 : LEA ECX,[ESP + 0x10]
0052a21a : CALL 0x00526bc0
0052a21f : ADD dword ptr [EDI + 0x8],-0x1
0052a223 : JNZ 0x0052a22c
0052a225 : MOV ECX,EDI
0052a227 : CALL 0x00525340
0052a22c : MOV EDI,dword ptr [ESP + 0x24]
0052a230 : MOV EAX,dword ptr [ESP + 0x30]
0052a234 : MOV EDX,dword ptr [ESP + 0x28]
0052a238 : PUSH EAX
0052a239 : LEA ECX,[ESP + 0x14]
0052a23d : PUSH ECX
0052a23e : PUSH EDX
0052a23f : PUSH EDI
0052a240 : MOV ECX,ESI
0052a242 : MOV byte ptr [ESP + 0x20],0xa
0052a247 : CALL 0x005520e0
0052a24c : LEA ECX,[ESP + 0x10]
0052a250 : MOV BL,AL
0052a252 : CALL 0x00526bc0
0052a257 : POP EDI
0052a258 : POP ESI
0052a259 : POP EBP
0052a25a : MOV AL,BL
0052a25c : POP EBX
0052a25d : ADD ESP,0x10
0052a260 : RET 0x10
0052a263 : PUSH 0xa
0052a265 : PUSH 0xb8b1f0
0052a26a : CALL 0x00525380
0052a26f : MOV dword ptr [ESP + 0x24],EAX
0052a273 : ADD dword ptr [EAX + 0x8],EBX
0052a276 : MOV EDX,dword ptr [ESI]
0052a278 : MOV EDX,dword ptr [EDX + 0x18]
0052a27b : LEA EAX,[ESP + 0x24]
0052a27f : PUSH EAX
0052a280 : PUSH EBP
0052a281 : MOV ECX,ESI
0052a283 : CALL EDX
0052a285 : MOV EAX,dword ptr [ESP + 0x24]
0052a289 : DEC dword ptr [EAX + 0x8]
0052a28c : MOV ECX,EAX
0052a28e : ADD EAX,0x8
0052a291 : CMP dword ptr [EAX],0x0
0052a294 : JNZ 0x0052a230
0052a296 : CALL 0x00525340
0052a29b : JMP 0x0052a230
0052a29d : MOV EDX,dword ptr [ESI + 0x20]
0052a2a0 : CMP byte ptr [EDX + 0x2a4],0x1
0052a2a7 : JNZ 0x0052a2d6
0052a2a9 : CMP ECX,dword ptr [EAX + 0x120]
0052a2af : JNZ 0x0052a2d6
0052a2b1 : MOV ECX,dword ptr [EDI + 0x74]
0052a2b4 : MOV EAX,dword ptr [ECX]
0052a2b6 : MOV EDX,dword ptr [EAX + 0x40]
0052a2b9 : CALL EDX
0052a2bb : MOV EBX,EAX
0052a2bd : TEST EBX,EBX
0052a2bf : JZ 0x0052a2d6
0052a2c1 : MOV ECX,dword ptr [ESP + 0x2c]
0052a2c5 : PUSH EDI
0052a2c6 : CALL 0x00526120
0052a2cb : MOVZX EAX,AL
0052a2ce : PUSH EAX
0052a2cf : MOV ECX,EBX
0052a2d1 : CALL 0x0052a160
0052a2d6 : MOV ECX,dword ptr [ESP + 0x30]
0052a2da : MOV EDX,dword ptr [ESP + 0x2c]
0052a2de : MOV EAX,dword ptr [ESP + 0x28]
0052a2e2 : PUSH ECX
0052a2e3 : PUSH EDX
0052a2e4 : PUSH EAX
0052a2e5 : PUSH EBP
0052a2e6 : MOV ECX,ESI
0052a2e8 : CALL 0x00552480
0052a2ed : POP EDI
0052a2ee : POP ESI
0052a2ef : POP EBP
0052a2f0 : POP EBX
0052a2f1 : ADD ESP,0x10
0052a2f4 : RET 0x10

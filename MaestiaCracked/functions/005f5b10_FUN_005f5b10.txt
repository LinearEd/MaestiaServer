PROGRAM  : Maestia.exe
FUNCTION : FUN_005f5b10
ENTRY    : 005f5b10
BODY     : [[005f5b10, 005f5c3b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005f5b10(int param_1,int param_2,uint param_3)

{
  uint uVar1;
  uint *puVar2;
  int iVar3;
  char cVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  undefined4 *in_ECX;
  uint uVar8;
  char cVar9;
  
  iVar5 = param_1;
  iVar7 = *(int *)(param_1 + 0x1c);
  uVar6 = param_2 - iVar7 >> ((byte)*in_ECX & 0x1f);
  iVar3 = *(int *)(param_1 + 0x18);
  uVar8 = param_3 >> ((byte)*in_ECX & 0x1f);
  puVar2 = (uint *)(param_1 + 0x20 + (uVar6 >> 5) * 4);
  *puVar2 = *puVar2 & ~(1 << ((byte)uVar6 & 0x1f));
  uVar1 = uVar8 + uVar6;
  puVar2 = (uint *)(param_1 + 0x20 + (uVar1 - 1 >> 5) * 4);
  *puVar2 = *puVar2 & ~(1 << ((byte)(uVar1 - 1) & 0x1f));
  if ((uVar6 == 0) ||
     (cVar4 = '\x01',
     (*(uint *)(param_1 + 0x20 + (uVar6 - 1 >> 5) * 4) & 1 << ((byte)(uVar6 - 1) & 0x1f)) != 0)) {
    cVar4 = '\0';
  }
  if ((param_3 + param_2 < (uint)(iVar3 + iVar7)) &&
     ((*(uint *)(param_1 + 0x20 + (uVar1 >> 5) * 4) & 1 << ((byte)uVar1 & 0x1f)) == 0)) {
    cVar9 = '\x01';
  }
  else {
    cVar9 = '\0';
  }
  iVar7 = uVar8 << ((byte)*in_ECX & 0x1f);
  param_1 = CONCAT31((int3)((uint)puVar2 >> 8),cVar9);
  if (uVar8 < 0x21) {
    *(short *)(iVar7 + -2 + param_2) = (short)uVar8;
    *(short *)(param_2 + 0xc) = (short)uVar8;
  }
  else {
    *(undefined2 *)(iVar7 + -2 + param_2) = 0x21;
    *(undefined2 *)(param_2 + 0xc) = 0x21;
    *(uint *)(iVar7 + -8 + param_2) = uVar8;
    *(uint *)(param_2 + 0x10) = uVar8;
  }
  *(int *)(param_2 + 8) = iVar5;
  if (cVar9 != '\0' || cVar4 != '\0') {
    FUN_005a8420(param_2,*in_ECX,cVar4,param_1);
    return;
  }
  FUN_005a7f80(param_2);
  return;
}



============================================================
DISASSEMBLY
============================================================
005f5b10 : PUSH ECX
005f5b11 : PUSH EBX
005f5b12 : MOV dword ptr [ESP + 0x4],ECX
005f5b16 : MOV ECX,dword ptr [ECX]
005f5b18 : PUSH EBP
005f5b19 : MOV EBP,dword ptr [ESP + 0x14]
005f5b1d : PUSH ESI
005f5b1e : MOV ESI,dword ptr [ESP + 0x14]
005f5b22 : MOV EDX,dword ptr [ESI + 0x1c]
005f5b25 : MOV EAX,EBP
005f5b27 : SUB EAX,EDX
005f5b29 : SAR EAX,CL
005f5b2b : PUSH EDI
005f5b2c : MOV EDI,dword ptr [ESI + 0x18]
005f5b2f : ADD EDI,EDX
005f5b31 : MOV EDX,dword ptr [ESP + 0x20]
005f5b35 : SHR EDX,CL
005f5b37 : MOV ECX,EAX
005f5b39 : SHR ECX,0x5
005f5b3c : LEA ECX,[ESI + ECX*0x4 + 0x20]
005f5b40 : MOV dword ptr [ESP + 0x18],ECX
005f5b44 : MOV ECX,EAX
005f5b46 : AND ECX,0x1f
005f5b49 : MOV EBX,0x1
005f5b4e : SHL EBX,CL
005f5b50 : MOV ECX,dword ptr [ESP + 0x18]
005f5b54 : NOT EBX
005f5b56 : AND dword ptr [ECX],EBX
005f5b58 : LEA ECX,[EDX + EAX*0x1]
005f5b5b : MOV dword ptr [ESP + 0x1c],ECX
005f5b5f : DEC ECX
005f5b60 : MOV EBX,ECX
005f5b62 : SHR EBX,0x5
005f5b65 : LEA EBX,[ESI + EBX*0x4 + 0x20]
005f5b69 : MOV dword ptr [ESP + 0x18],EBX
005f5b6d : AND ECX,0x1f
005f5b70 : MOV EBX,0x1
005f5b75 : SHL EBX,CL
005f5b77 : MOV ECX,dword ptr [ESP + 0x18]
005f5b7b : NOT EBX
005f5b7d : AND dword ptr [ECX],EBX
005f5b7f : MOV ECX,dword ptr [ESP + 0x20]
005f5b83 : ADD ECX,EBP
005f5b85 : CMP ECX,EDI
005f5b87 : SETC BL
005f5b8a : TEST EAX,EAX
005f5b8c : JZ 0x005f5ba9
005f5b8e : DEC EAX
005f5b8f : MOV ECX,EAX
005f5b91 : AND ECX,0x1f
005f5b94 : MOV EDI,0x1
005f5b99 : SHL EDI,CL
005f5b9b : SHR EAX,0x5
005f5b9e : MOV byte ptr [ESP + 0x20],0x1
005f5ba3 : TEST dword ptr [ESI + EAX*0x4 + 0x20],EDI
005f5ba7 : JZ 0x005f5bae
005f5ba9 : MOV byte ptr [ESP + 0x20],0x0
005f5bae : TEST BL,BL
005f5bb0 : JZ 0x005f5bcf
005f5bb2 : MOV EAX,dword ptr [ESP + 0x1c]
005f5bb6 : MOV ECX,EAX
005f5bb8 : AND ECX,0x1f
005f5bbb : MOV EDI,0x1
005f5bc0 : SHL EDI,CL
005f5bc2 : SHR EAX,0x5
005f5bc5 : TEST dword ptr [ESI + EAX*0x4 + 0x20],EDI
005f5bc9 : JNZ 0x005f5bcf
005f5bcb : MOV BL,0x1
005f5bcd : JMP 0x005f5bd1
005f5bcf : XOR BL,BL
005f5bd1 : MOV EDI,dword ptr [ESP + 0x10]
005f5bd5 : MOV ECX,dword ptr [EDI]
005f5bd7 : MOV EAX,EDX
005f5bd9 : SHL EAX,CL
005f5bdb : MOV byte ptr [ESP + 0x18],BL
005f5bdf : CMP EDX,0x21
005f5be2 : JNC 0x005f5bef
005f5be4 : MOV word ptr [EAX + EBP*0x1 + -0x2],DX
005f5be9 : MOV word ptr [EBP + 0xc],DX
005f5bed : JMP 0x005f5c04
005f5bef : MOV ECX,0x21
005f5bf4 : MOV word ptr [EAX + EBP*0x1 + -0x2],CX
005f5bf9 : MOV word ptr [EBP + 0xc],CX
005f5bfd : MOV dword ptr [EAX + EBP*0x1 + -0x8],EDX
005f5c01 : MOV dword ptr [EBP + 0x10],EDX
005f5c04 : OR BL,byte ptr [ESP + 0x20]
005f5c08 : MOV dword ptr [EBP + 0x8],ESI
005f5c0b : JZ 0x005f5c2b
005f5c0d : MOV EDX,dword ptr [ESP + 0x18]
005f5c11 : MOV EAX,dword ptr [ESP + 0x20]
005f5c15 : MOV ECX,dword ptr [EDI]
005f5c17 : PUSH EDX
005f5c18 : PUSH EAX
005f5c19 : PUSH ECX
005f5c1a : PUSH EBP
005f5c1b : LEA ECX,[EDI + 0x8]
005f5c1e : CALL 0x005a8420
005f5c23 : POP EDI
005f5c24 : POP ESI
005f5c25 : POP EBP
005f5c26 : POP EBX
005f5c27 : POP ECX
005f5c28 : RET 0xc
005f5c2b : PUSH EBP
005f5c2c : LEA ECX,[EDI + 0x8]
005f5c2f : CALL 0x005a7f80
005f5c34 : POP EDI
005f5c35 : POP ESI
005f5c36 : POP EBP
005f5c37 : POP EBX
005f5c38 : POP ECX
005f5c39 : RET 0xc

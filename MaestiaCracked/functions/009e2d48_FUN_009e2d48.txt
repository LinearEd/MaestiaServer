PROGRAM  : Maestia.exe
FUNCTION : FUN_009e2d48
ENTRY    : 009e2d48
BODY     : [[009e2d48, 009e2ec1] [009e2f7b, 009e2f98]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009e2d48(void)

{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  int *piVar4;
  int iVar5;
  uint uVar6;
  uint unaff_EBP;
  
code_r0x009e2d48:
  do {
    *(undefined4 *)(unaff_EBP - 100) = 0;
    iVar2 = *(int *)(unaff_EBP - 0x68);
    piVar4 = (int *)FUN_00413b60(unaff_EBP - 100);
    iVar5 = *piVar4;
    *(int *)(unaff_EBP - 100) = iVar5;
    if (iVar5 == *(int *)(iVar2 + 0x2c)) {
      iVar5 = FUN_006f0760(0x10,"",0,(DAT_01725270 >> 3 & 1) == 0);
      *(int *)(unaff_EBP - 0x6c) = iVar5;
      *(undefined1 *)(unaff_EBP - 4) = 0x1c;
      iVar2 = 0;
      if (iVar5 != 0) {
        *(undefined4 *)(iVar5 + 4) = 0;
        *(undefined4 *)(iVar5 + 8) = 0;
        *(undefined4 *)(iVar5 + 0xc) = 0;
        iVar2 = iVar5;
      }
      *(undefined1 *)(unaff_EBP - 4) = 0x12;
      FUN_00449610();
      *(undefined2 *)(unaff_EBP - 0x90) = 2;
      *(int *)(unaff_EBP - 0x8c) = iVar2;
      FUN_0041ed30(unaff_EBP - 0x114,unaff_EBP - 0x90);
    }
    else if (*(int *)(iVar5 + 0x10) == 0) {
      iVar2 = *(int *)(unaff_EBP - 0x5c);
      if (iVar2 != 0) {
LAB_009e2e87:
        FUN_00414770(iVar2);
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
    }
    else {
      *(undefined4 *)(unaff_EBP - 0x58) = 0;
      if (*(int *)(*(int *)(iVar5 + 0x10) + 8) - *(int *)(*(int *)(iVar5 + 0x10) + 4) >> 2 != 0) {
        do {
          iVar1 = *(int *)(unaff_EBP - 0x58);
          iVar2 = *(int *)(unaff_EBP - 0x30);
          if (*(uint *)(unaff_EBP - 0x1c) < 8) {
            iVar2 = unaff_EBP - 0x30;
          }
          iVar2 = FUN_00405bb0(iVar2);
          if ((iVar2 == 0) &&
             (*(uint *)(*(int *)(*(int *)(*(int *)(iVar5 + 0x10) + 4) + iVar1 * 4) + 0x24) ==
              (uint)*(ushort *)(*(int *)(unaff_EBP - 0x60) + 6))) {
            if (*(int *)(unaff_EBP - 0x5c) == 0) goto LAB_009e2e94;
            iVar2 = *(int *)(unaff_EBP - 0x5c);
            goto LAB_009e2e87;
          }
          uVar6 = *(int *)(unaff_EBP - 0x58) + 1;
          *(uint *)(unaff_EBP - 0x58) = uVar6;
        } while (uVar6 < (uint)(*(int *)(*(int *)(iVar5 + 0x10) + 8) -
                                *(int *)(*(int *)(iVar5 + 0x10) + 4) >> 2));
      }
      FUN_00449610();
    }
LAB_009e2e94:
    *(undefined4 *)(unaff_EBP - 4) = 0xffffffff;
    if (7 < *(uint *)(unaff_EBP - 0x1c)) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    *(undefined4 *)(unaff_EBP - 0x1c) = 7;
    *(undefined4 *)(unaff_EBP - 0x20) = 0;
    *(undefined2 *)(unaff_EBP - 0x30) = 0;
    do {
      while( true ) {
        do {
          do {
            do {
              if (*(int *)(unaff_EBP - 0x7c) == 0) {
                ExceptionList = *(void **)(unaff_EBP - 0xc);
                __security_check_cookie(*(uint *)(unaff_EBP - 0x18) ^ unaff_EBP);
                return;
              }
            } while (DAT_017247ac == 0);
            *(undefined4 *)(unaff_EBP - 0x54) = 0;
            FUN_00404160(unaff_EBP - 0x7c,unaff_EBP - 0x5c,unaff_EBP - 0x54);
            iVar2 = *(int *)(unaff_EBP - 0x54);
          } while ((iVar2 == 0) || (*(short *)(iVar2 + 4) != 0x6600));
          piVar4 = *(int **)(iVar2 + 0xf0);
          *(int **)(unaff_EBP - 0x60) = piVar4;
        } while (piVar4 == (int *)0x0);
        if ((char)piVar4[0x10] != '\x02') break;
        FUN_0040eef0(*(int *)(unaff_EBP - 0x54) + 0x18);
        *(undefined4 *)(unaff_EBP - 4) = 0;
        FUN_00824120(DAT_0172491c);
        *(undefined1 *)(unaff_EBP - 4) = 2;
        if (7 < *(uint *)(unaff_EBP - 0xc0)) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        *(undefined4 *)(unaff_EBP - 0xc0) = 7;
        *(undefined4 *)(unaff_EBP - 0xc4) = 0;
        *(undefined2 *)(unaff_EBP - 0xd4) = 0;
        *(undefined4 *)(unaff_EBP - 0x58) = 0;
        *(undefined4 *)(unaff_EBP - 0x5c) = 0;
        *(undefined1 *)(unaff_EBP - 4) = 3;
        iVar2 = FUN_006f0300(0x28);
        *(int *)(unaff_EBP - 0x60) = iVar2;
        *(undefined1 *)(unaff_EBP - 4) = 4;
        if (iVar2 == 0) {
          iVar2 = 0;
        }
        else {
          iVar2 = FUN_00419170(iVar2,*(undefined2 *)(*(int *)(unaff_EBP - 0x54) + 6),
                               unaff_EBP - 0x50,*(undefined2 *)((int)piVar4 + 6));
        }
        *(undefined1 *)(unaff_EBP - 4) = 3;
        *(int *)(unaff_EBP - 0x58) = iVar2;
        iVar5 = FUN_006f0300(0x28);
        *(int *)(unaff_EBP - 0x60) = iVar5;
        *(undefined1 *)(unaff_EBP - 4) = 5;
        if (iVar5 == 0) {
          *(undefined4 *)(unaff_EBP - 0x54) = 0;
        }
        else {
          uVar3 = FUN_00419170(iVar5,*(undefined2 *)(*(int *)(unaff_EBP - 0x54) + 6),
                               unaff_EBP - 0x50,*(undefined2 *)((int)piVar4 + 6));
          *(undefined4 *)(unaff_EBP - 0x54) = uVar3;
        }
        *(undefined1 *)(unaff_EBP - 4) = 3;
        *(undefined4 *)(unaff_EBP - 0x5c) = *(undefined4 *)(unaff_EBP - 0x54);
        *(undefined4 *)(unaff_EBP - 4) = 2;
        *(undefined4 *)(unaff_EBP - 0x60) = 1;
        iVar5 = *(int *)(unaff_EBP - 0x68);
        FUN_00413b60(unaff_EBP - 0x60);
        if (*(int *)(unaff_EBP - 0x80) == *(int *)(iVar5 + 0x2c)) {
          *(undefined4 *)(unaff_EBP - 0x74) = 0;
          *(undefined1 *)(unaff_EBP - 4) = 8;
          iVar5 = FUN_006f0300(0x10);
          *(int *)(unaff_EBP - 0x60) = iVar5;
          *(undefined1 *)(unaff_EBP - 4) = 9;
          iVar2 = 0;
          if (iVar5 != 0) {
            *(undefined4 *)(iVar5 + 4) = 0;
            *(undefined4 *)(iVar5 + 8) = 0;
            *(undefined4 *)(iVar5 + 0xc) = 0;
            iVar2 = iVar5;
          }
          *(undefined1 *)(unaff_EBP - 4) = 8;
          *(int *)(unaff_EBP - 0x74) = iVar2;
          *(undefined4 *)(unaff_EBP - 4) = 2;
          FUN_00449610();
          *(undefined2 *)(unaff_EBP - 0xa0) = 1;
          *(int *)(unaff_EBP - 0x9c) = iVar2;
          FUN_0041ed30(unaff_EBP - 0x104,unaff_EBP - 0xa0);
          FUN_009e285c();
          return;
        }
        if (*(int *)(*(int *)(unaff_EBP - 0x80) + 0x10) != 0) {
          FUN_00449610();
          FUN_009e285c();
          return;
        }
        if (iVar2 != 0) {
          FUN_00414770(iVar2);
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        *(undefined4 *)(unaff_EBP - 0x60) = 0;
        piVar4 = (int *)FUN_00413b60(unaff_EBP - 0x60);
        iVar2 = *piVar4;
        *(int *)(unaff_EBP - 0x80) = iVar2;
        if (iVar2 == *(int *)(*(int *)(unaff_EBP - 0x68) + 0x2c)) {
          *(undefined4 *)(unaff_EBP - 0x70) = 0;
          *(undefined1 *)(unaff_EBP - 4) = 0xc;
          iVar5 = FUN_006f0300(0x10);
          *(int *)(unaff_EBP - 0x60) = iVar5;
          *(undefined1 *)(unaff_EBP - 4) = 0xd;
          iVar2 = 0;
          if (iVar5 != 0) {
            *(undefined4 *)(iVar5 + 4) = 0;
            *(undefined4 *)(iVar5 + 8) = 0;
            *(undefined4 *)(iVar5 + 0xc) = 0;
            iVar2 = iVar5;
          }
          *(undefined1 *)(unaff_EBP - 4) = 0xc;
          *(int *)(unaff_EBP - 0x70) = iVar2;
          *(undefined4 *)(unaff_EBP - 4) = 2;
          FUN_00449610();
          *(undefined2 *)(unaff_EBP - 0x98) = 0;
          *(int *)(unaff_EBP - 0x94) = iVar2;
          FUN_0041ed30(unaff_EBP - 0x10c,unaff_EBP - 0x98);
          FUN_009e29a4();
          return;
        }
        if (*(int *)(iVar2 + 0x10) != 0) {
          FUN_00449610();
          FUN_009e29a4();
          return;
        }
        if (*(int *)(unaff_EBP - 0x54) != 0) {
          FUN_00414770(*(int *)(unaff_EBP - 0x54));
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        *(undefined4 *)(unaff_EBP - 4) = 0xffffffff;
        if (7 < *(uint *)(unaff_EBP - 0x38)) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        *(undefined4 *)(unaff_EBP - 0x38) = 7;
        *(undefined4 *)(unaff_EBP - 0x3c) = 0;
        *(undefined2 *)(unaff_EBP - 0x4c) = 0;
      }
    } while (((char)piVar4[0x10] != '\x03') && (iVar2 = (**(code **)(*piVar4 + 0x3c))(), iVar2 == 0)
            );
    FUN_0040eef0(piVar4 + 6);
    *(undefined4 *)(unaff_EBP - 4) = 0x10;
    FUN_00824120(DAT_0172491c);
    *(undefined1 *)(unaff_EBP - 4) = 0x12;
    if (7 < *(uint *)(unaff_EBP - 0xdc)) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    *(undefined4 *)(unaff_EBP - 0xdc) = 7;
    *(undefined4 *)(unaff_EBP - 0xe0) = 0;
    *(undefined2 *)(unaff_EBP - 0xf0) = 0;
    *(undefined4 *)(unaff_EBP - 0x58) = 0;
    *(undefined4 *)(unaff_EBP - 0x5c) = 0;
    *(undefined1 *)(unaff_EBP - 4) = 0x13;
    iVar2 = FUN_006f0300(0x28);
    *(int *)(unaff_EBP - 0x6c) = iVar2;
    *(undefined1 *)(unaff_EBP - 4) = 0x14;
    if (iVar2 == 0) {
      iVar2 = 0;
    }
    else {
      iVar2 = FUN_00419170(iVar2,*(undefined2 *)(*(int *)(unaff_EBP - 0x54) + 6),unaff_EBP - 0x34,
                           *(undefined2 *)((int)piVar4 + 6));
    }
    *(undefined1 *)(unaff_EBP - 4) = 0x13;
    *(int *)(unaff_EBP - 0x58) = iVar2;
    iVar5 = FUN_006f0300(0x28);
    *(int *)(unaff_EBP - 0x6c) = iVar5;
    *(undefined1 *)(unaff_EBP - 4) = 0x15;
    if (iVar5 == 0) {
      uVar3 = 0;
    }
    else {
      uVar3 = FUN_00419170(iVar5,*(undefined2 *)(*(int *)(unaff_EBP - 0x54) + 6),unaff_EBP - 0x34,
                           *(undefined2 *)((int)piVar4 + 6));
    }
    *(undefined1 *)(unaff_EBP - 4) = 0x13;
    *(undefined4 *)(unaff_EBP - 0x5c) = uVar3;
    *(undefined4 *)(unaff_EBP - 4) = 0x12;
    *(undefined4 *)(unaff_EBP - 0x54) = 2;
    iVar5 = *(int *)(unaff_EBP - 0x68);
    FUN_00413b60(unaff_EBP - 0x54);
    iVar1 = *(int *)(unaff_EBP - 100);
    if (iVar1 == *(int *)(iVar5 + 0x2c)) {
      *(undefined4 *)(unaff_EBP - 0x78) = 0;
      *(undefined1 *)(unaff_EBP - 4) = 0x18;
      iVar5 = FUN_006f0300(0x10);
      *(int *)(unaff_EBP - 0x6c) = iVar5;
      *(undefined1 *)(unaff_EBP - 4) = 0x19;
      iVar2 = 0;
      if (iVar5 != 0) {
        *(undefined4 *)(iVar5 + 4) = 0;
        *(undefined4 *)(iVar5 + 8) = 0;
        *(undefined4 *)(iVar5 + 0xc) = 0;
        iVar2 = iVar5;
      }
      *(undefined1 *)(unaff_EBP - 4) = 0x18;
      *(int *)(unaff_EBP - 0x78) = iVar2;
      *(undefined4 *)(unaff_EBP - 4) = 0x12;
      FUN_00449610();
      *(undefined2 *)(unaff_EBP - 0x88) = 2;
      *(int *)(unaff_EBP - 0x84) = iVar2;
      FUN_0041ed30(unaff_EBP - 0xfc,unaff_EBP - 0x88);
      FUN_009e2d48();
      return;
    }
    if (*(int *)(iVar1 + 0x10) != 0) {
      *(undefined4 *)(unaff_EBP - 0x54) = 0;
      if (*(int *)(*(int *)(iVar1 + 0x10) + 8) - *(int *)(*(int *)(iVar1 + 0x10) + 4) >> 2 == 0) {
LAB_009e2d17:
        FUN_00449610();
        FUN_009e2d48();
        return;
      }
      while( true ) {
        iVar5 = *(int *)(unaff_EBP - 0x54);
        iVar2 = *(int *)(unaff_EBP - 0x30);
        if (*(uint *)(unaff_EBP - 0x1c) < 8) {
          iVar2 = unaff_EBP - 0x30;
        }
        iVar2 = FUN_00405bb0(iVar2);
        if ((iVar2 == 0) &&
           (*(uint *)(*(int *)(*(int *)(*(int *)(iVar1 + 0x10) + 4) + iVar5 * 4) + 0x24) ==
            (uint)*(ushort *)(*(int *)(unaff_EBP - 0x60) + 6))) break;
        uVar6 = *(int *)(unaff_EBP - 0x54) + 1;
        *(uint *)(unaff_EBP - 0x54) = uVar6;
        if ((uint)(*(int *)(*(int *)(iVar1 + 0x10) + 8) - *(int *)(*(int *)(iVar1 + 0x10) + 4) >> 2)
            <= uVar6) goto LAB_009e2d17;
      }
      if (*(int *)(unaff_EBP - 0x58) != 0) {
        FUN_00414770(*(undefined4 *)(unaff_EBP - 0x58));
        goto LAB_009e2d43;
      }
      goto code_r0x009e2d48;
    }
    if (iVar2 != 0) {
      FUN_00414770(iVar2);
LAB_009e2d43:
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
009e2d48 : MOV dword ptr [EBP + -0x64],0x0
009e2d4f : MOV EDI,dword ptr [EBP + -0x68]
009e2d52 : LEA EBX,[EDI + 0x28]
009e2d55 : LEA EAX,[EBP + -0x64]
009e2d58 : PUSH EAX
009e2d59 : LEA EAX,[EBP + 0xffffff5c]
009e2d5f : MOV ECX,EBX
009e2d61 : CALL 0x00413b60
009e2d66 : MOV ESI,dword ptr [EAX]
009e2d68 : MOV dword ptr [EBP + -0x64],ESI
009e2d6b : CMP ESI,dword ptr [EDI + 0x2c]
009e2d6e : JNZ 0x009e2de7
009e2d70 : MOV ECX,dword ptr [0x01725270]
009e2d76 : SHR ECX,0x3
009e2d79 : AND ECX,0x1
009e2d7c : MOV EDX,0x0
009e2d81 : SETZ DL
009e2d84 : PUSH EDX
009e2d85 : XOR ESI,ESI
009e2d87 : PUSH ESI
009e2d88 : PUSH 0xbf1a4a
009e2d8d : PUSH 0x10
009e2d8f : CALL 0x006f0760
009e2d94 : ADD ESP,0x10
009e2d97 : MOV dword ptr [EBP + -0x6c],EAX
009e2d9a : MOV byte ptr [EBP + -0x4],0x1c
009e2d9e : CMP EAX,ESI
009e2da0 : JZ 0x009e2dad
009e2da2 : MOV dword ptr [EAX + 0x4],ESI
009e2da5 : MOV dword ptr [EAX + 0x8],ESI
009e2da8 : MOV dword ptr [EAX + 0xc],ESI
009e2dab : MOV ESI,EAX
009e2dad : MOV byte ptr [EBP + -0x4],0x12
009e2db1 : LEA EDI,[EBP + -0x5c]
009e2db4 : MOV EDX,ESI
009e2db6 : CALL 0x00449610
009e2dbb : MOV EAX,0x2
009e2dc0 : MOV word ptr [EBP + 0xffffff70],AX
009e2dc7 : MOV dword ptr [EBP + 0xffffff74],ESI
009e2dcd : LEA ECX,[EBP + 0xffffff70]
009e2dd3 : PUSH ECX
009e2dd4 : LEA EDX,[EBP + 0xfffffeec]
009e2dda : PUSH EDX
009e2ddb : MOV EAX,EBX
009e2ddd : CALL 0x0041ed30
009e2de2 : JMP 0x009e2e94
009e2de7 : CMP dword ptr [ESI + 0x10],0x0
009e2deb : JZ 0x009e2e80
009e2df1 : MOV dword ptr [EBP + -0x58],0x0
009e2df8 : MOV EAX,dword ptr [ESI + 0x10]
009e2dfb : MOV ECX,dword ptr [EAX + 0x8]
009e2dfe : SUB ECX,dword ptr [EAX + 0x4]
009e2e01 : SAR ECX,0x2
009e2e04 : TEST ECX,ECX
009e2e06 : JBE 0x009e2e68
009e2e08 : MOV EBX,dword ptr [EBP + -0x58]
009e2e0b : ADD EBX,EBX
009e2e0d : ADD EBX,EBX
009e2e0f : MOV EDX,dword ptr [ESI + 0x10]
009e2e12 : MOV EAX,dword ptr [EDX + 0x4]
009e2e15 : ADD EAX,EBX
009e2e17 : MOV ECX,dword ptr [EAX]
009e2e19 : ADD ECX,0x4
009e2e1c : CMP dword ptr [EBP + -0x1c],0x8
009e2e20 : MOV EAX,dword ptr [EBP + -0x30]
009e2e23 : JNC 0x009e2e28
009e2e25 : LEA EAX,[EBP + -0x30]
009e2e28 : PUSH EAX
009e2e29 : MOV EDI,dword ptr [EBP + -0x20]
009e2e2c : MOV EAX,dword ptr [ECX + 0x14]
009e2e2f : CALL 0x00405bb0
009e2e34 : TEST EAX,EAX
009e2e36 : JNZ 0x009e2e4d
009e2e38 : MOV EAX,dword ptr [ESI + 0x10]
009e2e3b : MOV ECX,dword ptr [EAX + 0x4]
009e2e3e : MOV EDX,dword ptr [ECX + EBX*0x1]
009e2e41 : MOV EAX,dword ptr [EBP + -0x60]
009e2e44 : MOVZX ECX,word ptr [EAX + 0x6]
009e2e48 : CMP dword ptr [EDX + 0x24],ECX
009e2e4b : JZ 0x009e2e75
009e2e4d : MOV ECX,dword ptr [EBP + -0x58]
009e2e50 : INC ECX
009e2e51 : MOV dword ptr [EBP + -0x58],ECX
009e2e54 : MOV EAX,dword ptr [ESI + 0x10]
009e2e57 : MOV EDX,dword ptr [EAX + 0x8]
009e2e5a : SUB EDX,dword ptr [EAX + 0x4]
009e2e5d : SAR EDX,0x2
009e2e60 : CMP ECX,EDX
009e2e62 : JC 0x009e2e08
009e2e64 : XOR AL,AL
009e2e66 : JNZ 0x009e2e75
009e2e68 : LEA EDI,[EBP + -0x5c]
009e2e6b : MOV EDX,dword ptr [ESI + 0x10]
009e2e6e : CALL 0x00449610
009e2e73 : JMP 0x009e2e94
009e2e75 : CMP dword ptr [EBP + -0x5c],0x0
009e2e79 : JZ 0x009e2e94
009e2e7b : MOV ESI,dword ptr [EBP + -0x5c]
009e2e7e : JMP 0x009e2e87
009e2e80 : MOV ESI,dword ptr [EBP + -0x5c]
009e2e83 : TEST ESI,ESI
009e2e85 : JZ 0x009e2e94
009e2e87 : PUSH ESI
009e2e88 : CALL 0x00414770
009e2e8d : MOV ECX,ESI
009e2e8f : CALL 0x006f04e0
009e2e94 : MOV dword ptr [EBP + -0x4],0xffffffff
009e2e9b : CMP dword ptr [EBP + -0x1c],0x8
009e2e9f : JC 0x009e2ea9
009e2ea1 : MOV ECX,dword ptr [EBP + -0x30]
009e2ea4 : CALL 0x006f04e0
009e2ea9 : MOV dword ptr [EBP + -0x1c],0x7
009e2eb0 : MOV dword ptr [EBP + -0x20],0x0
009e2eb7 : XOR EAX,EAX
009e2eb9 : MOV word ptr [EBP + -0x30],AX
009e2ebd : JMP 0x009e25c5
009e2f7b : MOV ECX,dword ptr [EBP + -0xc]
009e2f7e : MOV dword ptr FS:[0x0],ECX
009e2f85 : POP ECX
009e2f86 : POP EDI
009e2f87 : POP ESI
009e2f88 : POP EBX
009e2f89 : MOV ECX,dword ptr [EBP + -0x18]
009e2f8c : XOR ECX,EBP
009e2f8e : CALL 0x00633e6b
009e2f93 : MOV ESP,EBP
009e2f95 : POP EBP
009e2f96 : RET 0x4

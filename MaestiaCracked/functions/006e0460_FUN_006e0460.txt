PROGRAM  : Maestia.exe
FUNCTION : FUN_006e0460
ENTRY    : 006e0460
BODY     : [[006e0460, 006e048c] [006e0490, 006e04fc] [006e0500, 006e0584]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006e0460(int param_1,int param_2,undefined4 *param_3,int *param_4)

{
  int iVar1;
  undefined1 *puVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  byte *pbVar7;
  int iVar8;
  byte *pbVar9;
  int local_c;
  
  iVar1 = *param_4;
  iVar3 = 0;
  if (0 < *(int *)(param_1 + 0x114)) {
    do {
      local_c = 0;
      do {
        pbVar7 = (byte *)*param_3;
        if (local_c == 0) {
          pbVar9 = (byte *)param_3[-1];
        }
        else {
          pbVar9 = (byte *)param_3[1];
        }
        puVar2 = *(undefined1 **)(iVar1 + iVar3 * 4);
        iVar3 = iVar3 + 1;
        iVar8 = (uint)*pbVar7 * 3 + (uint)*pbVar9;
        iVar4 = (uint)pbVar7[1] * 3 + (uint)pbVar9[1];
        *puVar2 = (char)(iVar8 * 4 + 8 >> 4);
        puVar2[1] = (char)(iVar8 * 3 + 7 + iVar4 >> 4);
        pbVar9 = pbVar9 + 2;
        pbVar7 = pbVar7 + 2;
        for (iVar6 = *(int *)(param_2 + 0x28) + -2; puVar2 = puVar2 + 2, iVar6 != 0;
            iVar6 = iVar6 + -1) {
          iVar5 = (uint)*pbVar7 * 3 + (uint)*pbVar9;
          *puVar2 = (char)(iVar4 * 3 + 8 + iVar8 >> 4);
          puVar2[1] = (char)(iVar4 * 3 + 7 + iVar5 >> 4);
          pbVar9 = pbVar9 + 1;
          pbVar7 = pbVar7 + 1;
          iVar8 = iVar4;
          iVar4 = iVar5;
        }
        *puVar2 = (char)(iVar4 * 3 + 8 + iVar8 >> 4);
        puVar2[1] = (char)(iVar4 * 4 + 7 >> 4);
        local_c = local_c + 1;
      } while (local_c < 2);
      param_3 = param_3 + 1;
    } while (iVar3 < *(int *)(param_1 + 0x114));
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
006e0460 : SUB ESP,0x10
006e0463 : MOV EAX,dword ptr [ESP + 0x20]
006e0467 : MOV ECX,dword ptr [EAX]
006e0469 : MOV EDX,dword ptr [ESP + 0x14]
006e046d : XOR EAX,EAX
006e046f : CMP dword ptr [EDX + 0x114],EAX
006e0475 : MOV dword ptr [ESP + 0xc],ECX
006e0479 : JLE 0x006e0581
006e047f : PUSH EBX
006e0480 : PUSH EBP
006e0481 : PUSH ESI
006e0482 : MOV ESI,dword ptr [ESP + 0x28]
006e0486 : PUSH EDI
006e0487 : MOV dword ptr [ESP + 0x30],ESI
006e048b : JMP 0x006e0490
006e0490 : XOR ECX,ECX
006e0492 : MOV dword ptr [ESP + 0x14],ECX
006e0496 : MOV EBP,dword ptr [ESI]
006e0498 : TEST ECX,ECX
006e049a : JNZ 0x006e04a1
006e049c : MOV EDI,dword ptr [ESI + -0x4]
006e049f : JMP 0x006e04a4
006e04a1 : MOV EDI,dword ptr [ESI + 0x4]
006e04a4 : MOVZX ESI,byte ptr [EBP]
006e04a8 : MOVZX EDX,byte ptr [EDI]
006e04ab : MOV ECX,dword ptr [ESP + 0x1c]
006e04af : MOV ECX,dword ptr [ECX + EAX*0x4]
006e04b2 : MOV EBX,dword ptr [ESP + 0x28]
006e04b6 : INC EAX
006e04b7 : INC EBP
006e04b8 : MOV dword ptr [ESP + 0x18],EAX
006e04bc : MOVZX EAX,byte ptr [EBP]
006e04c0 : LEA ESI,[ESI + ESI*0x2]
006e04c3 : ADD ESI,EDX
006e04c5 : MOVZX EDX,byte ptr [EDI + 0x1]
006e04c9 : INC EDI
006e04ca : LEA EAX,[EAX + EAX*0x2]
006e04cd : ADD EAX,EDX
006e04cf : LEA EDX,[ESI*0x4 + 0x8]
006e04d6 : SAR EDX,0x4
006e04d9 : MOV byte ptr [ECX],DL
006e04db : LEA EDX,[EAX + ESI*0x2]
006e04de : LEA EDX,[ESI + EDX*0x1 + 0x7]
006e04e2 : INC ECX
006e04e3 : SAR EDX,0x4
006e04e6 : MOV byte ptr [ECX],DL
006e04e8 : MOV EBX,dword ptr [EBX + 0x28]
006e04eb : INC EDI
006e04ec : INC EBP
006e04ed : INC ECX
006e04ee : SUB EBX,0x2
006e04f1 : MOV EDX,ESI
006e04f3 : MOV ESI,EAX
006e04f5 : MOV dword ptr [ESP + 0x10],EBX
006e04f9 : JZ 0x006e0533
006e04fb : JMP 0x006e0500
006e0500 : MOVZX EAX,byte ptr [EBP]
006e0504 : MOVZX EBX,byte ptr [EDI]
006e0507 : LEA EAX,[EAX + EAX*0x2]
006e050a : ADD EAX,EBX
006e050c : LEA EBX,[ESI + ESI*0x2]
006e050f : LEA EDX,[EBX + EDX*0x1 + 0x8]
006e0513 : SAR EDX,0x4
006e0516 : MOV byte ptr [ECX],DL
006e0518 : LEA EDX,[ESI + ESI*0x2]
006e051b : LEA EDX,[EDX + EAX*0x1 + 0x7]
006e051f : INC ECX
006e0520 : SAR EDX,0x4
006e0523 : MOV byte ptr [ECX],DL
006e0525 : INC EDI
006e0526 : INC EBP
006e0527 : INC ECX
006e0528 : SUB dword ptr [ESP + 0x10],0x1
006e052d : MOV EDX,ESI
006e052f : MOV ESI,EAX
006e0531 : JNZ 0x006e0500
006e0533 : MOV ESI,dword ptr [ESP + 0x30]
006e0537 : LEA EDX,[EDX + EAX*0x2]
006e053a : LEA EDX,[EAX + EDX*0x1 + 0x8]
006e053e : LEA EAX,[EAX*0x4 + 0x7]
006e0545 : SAR EDX,0x4
006e0548 : SAR EAX,0x4
006e054b : MOV byte ptr [ECX],DL
006e054d : MOV byte ptr [ECX + 0x1],AL
006e0550 : MOV ECX,dword ptr [ESP + 0x14]
006e0554 : MOV EAX,dword ptr [ESP + 0x18]
006e0558 : INC ECX
006e0559 : CMP ECX,0x2
006e055c : MOV dword ptr [ESP + 0x14],ECX
006e0560 : JL 0x006e0496
006e0566 : MOV ECX,dword ptr [ESP + 0x24]
006e056a : ADD ESI,0x4
006e056d : CMP EAX,dword ptr [ECX + 0x114]
006e0573 : MOV dword ptr [ESP + 0x30],ESI
006e0577 : JL 0x006e0490
006e057d : POP EDI
006e057e : POP ESI
006e057f : POP EBP
006e0580 : POP EBX
006e0581 : ADD ESP,0x10
006e0584 : RET

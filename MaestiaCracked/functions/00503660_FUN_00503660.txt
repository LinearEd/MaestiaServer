PROGRAM  : Maestia.exe
FUNCTION : FUN_00503660
ENTRY    : 00503660
BODY     : [[00503660, 005036f8]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00503660(undefined4 *param_1,int param_2)

{
  byte bVar1;
  int iVar2;
  int iVar3;
  int *in_ECX;
  byte *pbVar4;
  int iVar5;
  byte *pbVar6;
  int *piVar7;
  bool bVar8;
  
  iVar2 = *in_ECX;
  piVar7 = (int *)(param_2 * 0x10 + 8 + iVar2);
  if ((*(int *)(param_2 * 0x10 + 8 + iVar2) == -2) || (iVar3 = param_2, piVar7[1] != param_2)) {
    return -1;
  }
  do {
    if (piVar7[1] == param_2) {
      pbVar6 = (byte *)((*(uint *)*param_1 & 0xfffffffc) + 8);
      pbVar4 = (byte *)((piVar7[2] & 0xfffffffcU) + 8);
      do {
        bVar1 = *pbVar4;
        bVar8 = bVar1 < *pbVar6;
        if (bVar1 != *pbVar6) {
LAB_005036c8:
          iVar5 = (1 - (uint)bVar8) - (uint)(bVar8 != 0);
          goto LAB_005036cd;
        }
        if (bVar1 == 0) break;
        bVar1 = pbVar4[1];
        bVar8 = bVar1 < pbVar6[1];
        if (bVar1 != pbVar6[1]) goto LAB_005036c8;
        pbVar4 = pbVar4 + 2;
        pbVar6 = pbVar6 + 2;
      } while (bVar1 != 0);
      iVar5 = 0;
LAB_005036cd:
      if (iVar5 == 0) {
        return iVar3;
      }
    }
    iVar3 = *piVar7;
    if (iVar3 == -1) {
      return -1;
    }
    piVar7 = (int *)(iVar3 * 0x10 + 8 + iVar2);
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
00503660 : MOV ECX,dword ptr [ECX]
00503662 : PUSH EBP
00503663 : MOV EBP,dword ptr [ESP + 0xc]
00503667 : MOV EDX,EBP
00503669 : SHL EDX,0x4
0050366c : CMP dword ptr [EDX + ECX*0x1 + 0x8],-0x2
00503671 : PUSH ESI
00503672 : LEA ESI,[EDX + ECX*0x1 + 0x8]
00503676 : MOV EAX,EBP
00503678 : MOV dword ptr [ESP + 0x10],ECX
0050367c : JZ 0x005036f1
0050367e : CMP dword ptr [ESI + 0x4],EBP
00503681 : JNZ 0x005036f1
00503683 : PUSH EDI
00503684 : MOV EDI,dword ptr [ESP + 0x10]
00503688 : PUSH EBX
00503689 : LEA ESP,[ESP]
00503690 : CMP dword ptr [ESI + 0x4],EBP
00503693 : JNZ 0x005036d5
00503695 : MOV ECX,dword ptr [EDI]
00503697 : MOV EDX,dword ptr [ECX]
00503699 : MOV ECX,dword ptr [ESI + 0x8]
0050369c : AND EDX,0xfffffffc
0050369f : AND ECX,0xfffffffc
005036a2 : ADD EDX,0x8
005036a5 : ADD ECX,0x8
005036a8 : MOV BL,byte ptr [ECX]
005036aa : CMP BL,byte ptr [EDX]
005036ac : JNZ 0x005036c8
005036ae : TEST BL,BL
005036b0 : JZ 0x005036c4
005036b2 : MOV BL,byte ptr [ECX + 0x1]
005036b5 : CMP BL,byte ptr [EDX + 0x1]
005036b8 : JNZ 0x005036c8
005036ba : ADD ECX,0x2
005036bd : ADD EDX,0x2
005036c0 : TEST BL,BL
005036c2 : JNZ 0x005036a8
005036c4 : XOR ECX,ECX
005036c6 : JMP 0x005036cd
005036c8 : SBB ECX,ECX
005036ca : SBB ECX,-0x1
005036cd : TEST ECX,ECX
005036cf : JZ 0x005036ea
005036d1 : MOV ECX,dword ptr [ESP + 0x18]
005036d5 : MOV EAX,dword ptr [ESI]
005036d7 : CMP EAX,-0x1
005036da : JZ 0x005036e7
005036dc : MOV EDX,EAX
005036de : SHL EDX,0x4
005036e1 : LEA ESI,[EDX + ECX*0x1 + 0x8]
005036e5 : JMP 0x00503690
005036e7 : OR EAX,0xffffffff
005036ea : POP EBX
005036eb : POP EDI
005036ec : POP ESI
005036ed : POP EBP
005036ee : RET 0x8
005036f1 : POP ESI
005036f2 : OR EAX,0xffffffff
005036f5 : POP EBP
005036f6 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_0078f8c0
ENTRY    : 0078f8c0
BODY     : [[0078f8c0, 0078fa39]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_0078f8c0(int param_1)

{
  int *piVar1;
  uint uVar2;
  int iVar3;
  int in_ECX;
  undefined1 local_38 [28];
  undefined **local_1c;
  int *local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4be29;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if ((*(int *)(in_ECX + 0x14) == 0) || (iVar3 = FUN_00405bb0(&DAT_00c13a3c), iVar3 == 0)) {
    FUN_008018d0(L"[AvaSubMesh::ReplaceDiffuseTexPtr] strTex is Null",uVar2);
    ExceptionList = local_10;
    return 0;
  }
  iVar3 = FUN_007cf910(DAT_017251c8,&local_1c,in_ECX,*(undefined1 *)(param_1 + 0x128));
  local_8 = 0;
  piVar1 = *(int **)(param_1 + 0x14);
  if (piVar1 != *(int **)(iVar3 + 4)) {
    if (piVar1 != (int *)0x0) {
      (**(code **)(*piVar1 + 0x30))();
    }
    if (*(int *)(iVar3 + 4) != 0) {
      InterlockedIncrement((LONG *)(*(int *)(iVar3 + 4) + 0x2c));
    }
    *(undefined4 *)(param_1 + 0x14) = *(undefined4 *)(iVar3 + 4);
  }
  local_8 = 0xffffffff;
  local_1c = &PTR_FUN_00cd4964;
  if (local_18 != (int *)0x0) {
    (**(code **)(*local_18 + 0x30))();
    local_18 = (int *)0x0;
  }
  if (*(int *)(param_1 + 0x14) == 0) {
    FUN_00406460(L"null.bmp");
    local_8 = 1;
    FUN_007cf910(DAT_017251c8,&local_1c,local_38,*(undefined1 *)(param_1 + 0x128));
    local_8._0_1_ = 2;
    FUN_00463a60();
    local_8 = CONCAT31(local_8._1_3_,1);
    local_1c = &PTR_FUN_00cd4964;
    if (local_18 != (int *)0x0) {
      (**(code **)(*local_18 + 0x30))();
      local_18 = (int *)0x0;
    }
    local_8 = 0xffffffff;
    FUN_00406560();
    if (*(int *)(param_1 + 0x14) == 0) {
      ExceptionList = local_10;
      return 0;
    }
    ExceptionList = local_10;
    return 1;
  }
  ExceptionList = local_10;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
0078f8c0 : PUSH EBP
0078f8c1 : MOV EBP,ESP
0078f8c3 : PUSH -0x1
0078f8c5 : PUSH 0xb4be29
0078f8ca : MOV EAX,FS:[0x0]
0078f8d0 : PUSH EAX
0078f8d1 : SUB ESP,0x28
0078f8d4 : PUSH EBX
0078f8d5 : PUSH ESI
0078f8d6 : PUSH EDI
0078f8d7 : MOV EAX,[0x00d66fa0]
0078f8dc : XOR EAX,EBP
0078f8de : PUSH EAX
0078f8df : LEA EAX,[EBP + -0xc]
0078f8e2 : MOV FS:[0x0],EAX
0078f8e8 : MOV ESI,ECX
0078f8ea : MOV EBX,dword ptr [EBP + 0x8]
0078f8ed : MOV EAX,dword ptr [ESI + 0x14]
0078f8f0 : TEST EAX,EAX
0078f8f2 : JZ 0x0078fa11
0078f8f8 : PUSH 0xc13a3c
0078f8fd : XOR EDI,EDI
0078f8ff : CALL 0x00405bb0
0078f904 : TEST EAX,EAX
0078f906 : JZ 0x0078fa11
0078f90c : MOV AL,byte ptr [EBX + 0x128]
0078f912 : MOV byte ptr [EBP + 0x8],AL
0078f915 : MOV ECX,dword ptr [EBP + 0x8]
0078f918 : MOV EAX,[0x017251c8]
0078f91d : PUSH ECX
0078f91e : PUSH ESI
0078f91f : LEA EDX,[EBP + -0x18]
0078f922 : PUSH EDX
0078f923 : PUSH EAX
0078f924 : CALL 0x007cf910
0078f929 : MOV ESI,EAX
0078f92b : MOV dword ptr [EBP + -0x4],EDI
0078f92e : MOV EAX,dword ptr [ESI + 0x4]
0078f931 : MOV ECX,dword ptr [EBX + 0x14]
0078f934 : LEA EDI,[EBX + 0x10]
0078f937 : CMP ECX,EAX
0078f939 : JZ 0x0078f95d
0078f93b : TEST ECX,ECX
0078f93d : JZ 0x0078f946
0078f93f : MOV EDX,dword ptr [ECX]
0078f941 : MOV EAX,dword ptr [EDX + 0x30]
0078f944 : CALL EAX
0078f946 : MOV EAX,dword ptr [ESI + 0x4]
0078f949 : TEST EAX,EAX
0078f94b : JZ 0x0078f957
0078f94d : ADD EAX,0x2c
0078f950 : PUSH EAX
0078f951 : CALL dword ptr [0x00b850dc]
0078f957 : MOV ECX,dword ptr [ESI + 0x4]
0078f95a : MOV dword ptr [EDI + 0x4],ECX
0078f95d : MOV dword ptr [EBP + -0x4],0xffffffff
0078f964 : MOV ECX,dword ptr [EBP + -0x14]
0078f967 : MOV dword ptr [EBP + -0x18],0xcd4964
0078f96e : TEST ECX,ECX
0078f970 : JZ 0x0078f980
0078f972 : MOV EDX,dword ptr [ECX]
0078f974 : MOV EAX,dword ptr [EDX + 0x30]
0078f977 : CALL EAX
0078f979 : MOV dword ptr [EBP + -0x14],0x0
0078f980 : CMP dword ptr [EBX + 0x14],0x0
0078f984 : JNZ 0x0078f9fb
0078f986 : PUSH 0xc13adc
0078f98b : LEA ECX,[EBP + -0x34]
0078f98e : CALL 0x00406460
0078f993 : MOV dword ptr [EBP + -0x4],0x1
0078f99a : MOV CL,byte ptr [EBX + 0x128]
0078f9a0 : MOV byte ptr [EBP + 0x8],CL
0078f9a3 : MOV EDX,dword ptr [EBP + 0x8]
0078f9a6 : PUSH EDX
0078f9a7 : MOV EDX,dword ptr [0x017251c8]
0078f9ad : LEA EAX,[EBP + -0x34]
0078f9b0 : PUSH EAX
0078f9b1 : LEA ECX,[EBP + -0x18]
0078f9b4 : PUSH ECX
0078f9b5 : PUSH EDX
0078f9b6 : CALL 0x007cf910
0078f9bb : MOV byte ptr [EBP + -0x4],0x2
0078f9bf : MOV ESI,EAX
0078f9c1 : CALL 0x00463a60
0078f9c6 : MOV byte ptr [EBP + -0x4],0x1
0078f9ca : MOV ECX,dword ptr [EBP + -0x14]
0078f9cd : MOV dword ptr [EBP + -0x18],0xcd4964
0078f9d4 : TEST ECX,ECX
0078f9d6 : JZ 0x0078f9e6
0078f9d8 : MOV EAX,dword ptr [ECX]
0078f9da : MOV EDX,dword ptr [EAX + 0x30]
0078f9dd : CALL EDX
0078f9df : MOV dword ptr [EBP + -0x14],0x0
0078f9e6 : MOV dword ptr [EBP + -0x4],0xffffffff
0078f9ed : LEA ECX,[EBP + -0x34]
0078f9f0 : CALL 0x00406560
0078f9f5 : CMP dword ptr [EBX + 0x14],0x0
0078f9f9 : JZ 0x0078fa24
0078f9fb : MOV AL,0x1
0078f9fd : MOV ECX,dword ptr [EBP + -0xc]
0078fa00 : MOV dword ptr FS:[0x0],ECX
0078fa07 : POP ECX
0078fa08 : POP EDI
0078fa09 : POP ESI
0078fa0a : POP EBX
0078fa0b : MOV ESP,EBP
0078fa0d : POP EBP
0078fa0e : RET 0x4
0078fa11 : MOV ESI,dword ptr [0x00da98e8]
0078fa17 : PUSH 0xc13ba8
0078fa1c : CALL 0x008018d0
0078fa21 : ADD ESP,0x4
0078fa24 : XOR AL,AL
0078fa26 : MOV ECX,dword ptr [EBP + -0xc]
0078fa29 : MOV dword ptr FS:[0x0],ECX
0078fa30 : POP ECX
0078fa31 : POP EDI
0078fa32 : POP ESI
0078fa33 : POP EBX
0078fa34 : MOV ESP,EBP
0078fa36 : POP EBP
0078fa37 : RET 0x4

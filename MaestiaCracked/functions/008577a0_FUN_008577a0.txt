PROGRAM  : Maestia.exe
FUNCTION : FUN_008577a0
ENTRY    : 008577a0
BODY     : [[008577a0, 00857b70]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008577a0(int param_1,char param_2)

{
  int *piVar1;
  uint uVar2;
  undefined4 uVar3;
  int iVar4;
  DWORD DVar5;
  int iVar6;
  int in_ECX;
  undefined4 *puVar7;
  undefined1 local_84 [4];
  undefined2 local_80;
  undefined4 local_70;
  uint local_6c;
  undefined1 local_68 [28];
  undefined1 local_4c [4];
  undefined4 local_48;
  undefined4 local_38;
  uint local_34;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1bad6;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar6 = *(int *)(DAT_0172491c + 0x17c);
  local_14 = uVar2;
  if (iVar6 == 0) {
    FUN_00406460(L"Failed Get MyCharacter");
    local_8 = 0;
    if ((int *)*DAT_00da98e8 != (int *)0x0) {
      (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                (L"AvaPlayerCharacter::SetAFKStatus",0x1fdf,local_30,uVar2);
    }
    local_8 = 0xffffffff;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c = 0;
  }
  else {
    *(char *)(param_1 + 0x1abf) = param_2;
    if (param_2 == '\0') {
      if (in_ECX == *(int *)(iVar6 + 4)) {
        FUN_00406460(L"IDS_AFK_END");
        local_8 = 0xe;
        piVar1 = *(int **)(*DAT_00da9894 + 0x1a8);
        uVar3 = FUN_0081d120(local_68);
        local_8._0_1_ = 0xf;
        (**(code **)(*piVar1 + 0x44))(uVar3,0x10);
        local_8 = CONCAT31(local_8._1_3_,0xe);
        FUN_00406560();
        local_8 = 0xffffffff;
        FUN_00406560();
        FUN_0096af80();
        *(undefined4 *)(param_1 + 0x1ac0) = 0;
      }
      iVar6 = *(int *)(param_1 + 0x3f8);
      if (iVar6 != 0) {
        uVar3 = *(undefined4 *)(param_1 + 0x42c);
        FUN_00405eb0(param_1 + 0xc,0,0xffffffff);
        *(undefined4 *)(iVar6 + 500) = uVar3;
      }
    }
    else {
      if (in_ECX == *(int *)(iVar6 + 4)) {
        *(undefined4 *)(DAT_00da93ec + 0x598) = 0;
        FUN_00406460(&DAT_00c3fed4);
        local_8 = 1;
        if (*(int *)(param_1 + 0x1ad8) != 0) {
          if (*(uint *)(param_1 + 0x1adc) < 8) {
            iVar4 = param_1 + 0x1ac8;
          }
          else {
            iVar4 = *(int *)(param_1 + 0x1ac8);
          }
          uVar3 = FUN_00404750(L"\'%s\'",iVar4);
          local_8._0_1_ = 2;
          FUN_00405eb0(uVar3,0,0xffffffff);
          local_8 = CONCAT31(local_8._1_3_,1);
          FUN_00406560();
        }
        FUN_00406460(L"IDS_AFK_INFO");
        local_8._0_1_ = 3;
        iVar4 = FUN_0081d120(local_84);
        local_8._0_1_ = 4;
        puVar7 = local_48;
        if (local_34 < 8) {
          puVar7 = &local_48;
        }
        if (*(uint *)(iVar6 + 0x24) < 8) {
          iVar6 = iVar6 + 0x10;
        }
        else {
          iVar6 = *(int *)(iVar6 + 0x10);
        }
        if (*(uint *)(iVar4 + 0x18) < 8) {
          iVar4 = iVar4 + 4;
        }
        else {
          iVar4 = *(int *)(iVar4 + 4);
        }
        FUN_00404750(iVar4,iVar6,puVar7);
        local_8._0_1_ = 6;
        FUN_00406560();
        local_8._0_1_ = 7;
        FUN_00406560();
        (**(code **)(**(int **)(*DAT_00da9894 + 0x1a8) + 0x44))(local_68,0x10);
        DVar5 = timeGetTime();
        *(DWORD *)(param_1 + 0x1ac0) = DVar5;
        local_8 = CONCAT31(local_8._1_3_,1);
        FUN_00406560();
        local_8 = 0xffffffff;
        FUN_00406560();
      }
      FUN_00406460(L"IDS_CHAT_AFK");
      local_8 = 8;
      iVar6 = FUN_0081d120(local_4c);
      local_8._0_1_ = 9;
      if (*(uint *)(iVar6 + 0x18) < 8) {
        iVar6 = iVar6 + 4;
      }
      else {
        iVar6 = *(int *)(iVar6 + 4);
      }
      FUN_00404750(L" < %s >",iVar6);
      local_8 = CONCAT31(local_8._1_3_,0xb);
      if (7 < local_6c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_6c = 7;
      local_70 = 0;
      local_80 = 0;
      local_8._0_1_ = 0xc;
      if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_48 = (undefined4 *)((uint)local_48._2_2_ << 0x10);
      local_34 = 7;
      local_38 = 0;
      uVar3 = FUN_00403450(local_84,local_30);
      local_8._0_1_ = 0xd;
      FUN_00405eb0(uVar3,0,0xffffffff);
      local_8 = CONCAT31(local_8._1_3_,0xc);
      if (7 < local_6c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_6c = 7;
      iVar6 = *(int *)(param_1 + 0x3f8);
      local_70 = 0;
      local_80 = 0;
      if (iVar6 != 0) {
        uVar3 = *(undefined4 *)(param_1 + 0x42c);
        FUN_00405eb0(local_30,0,0xffffffff);
        *(undefined4 *)(iVar6 + 500) = uVar3;
      }
      local_8 = 0xffffffff;
      if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_18 = 7;
      local_1c = 0;
      local_2c = 0;
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008577a0 : PUSH EBP
008577a1 : MOV EBP,ESP
008577a3 : PUSH -0x1
008577a5 : PUSH 0xb1bad6
008577aa : MOV EAX,FS:[0x0]
008577b0 : PUSH EAX
008577b1 : SUB ESP,0x94
008577b7 : MOV EAX,[0x00d66fa0]
008577bc : XOR EAX,EBP
008577be : MOV dword ptr [EBP + -0x10],EAX
008577c1 : PUSH EBX
008577c2 : PUSH ESI
008577c3 : PUSH EDI
008577c4 : PUSH EAX
008577c5 : LEA EAX,[EBP + -0xc]
008577c8 : MOV FS:[0x0],EAX
008577ce : MOV AL,byte ptr [EBP + 0xc]
008577d1 : MOV EDX,dword ptr [0x0172491c]
008577d7 : MOV ESI,dword ptr [EDX + 0x17c]
008577dd : MOV EBX,dword ptr [EBP + 0x8]
008577e0 : XOR EDI,EDI
008577e2 : MOV dword ptr [EBP + 0xffffff7c],ESI
008577e8 : CMP ESI,EDI
008577ea : JNZ 0x00857846
008577ec : PUSH 0xc3fe60
008577f1 : LEA ECX,[EBP + -0x2c]
008577f4 : CALL 0x00406460
008577f9 : MOV dword ptr [EBP + -0x4],EDI
008577fc : MOV EAX,[0x00da98e8]
00857801 : MOV ECX,dword ptr [EAX]
00857803 : CMP ECX,EDI
00857805 : JZ 0x0085781c
00857807 : MOV EDX,dword ptr [ECX]
00857809 : MOV EDX,dword ptr [EDX + 0x14]
0085780c : LEA EAX,[EBP + -0x2c]
0085780f : PUSH EAX
00857810 : PUSH 0x1fdf
00857815 : PUSH 0xc3fe90
0085781a : CALL EDX
0085781c : MOV dword ptr [EBP + -0x4],0xffffffff
00857823 : CMP dword ptr [EBP + -0x14],0x8
00857827 : JC 0x00857831
00857829 : MOV ECX,dword ptr [EBP + -0x28]
0085782c : CALL 0x006f04e0
00857831 : XOR EAX,EAX
00857833 : MOV dword ptr [EBP + -0x14],0x7
0085783a : MOV dword ptr [EBP + -0x18],EDI
0085783d : MOV word ptr [EBP + -0x28],AX
00857841 : JMP 0x00857b53
00857846 : MOV byte ptr [EBX + 0x1abf],AL
0085784c : TEST AL,AL
0085784e : JZ 0x00857ab2
00857854 : MOV EAX,dword ptr [ESI + 0x4]
00857857 : CMP ECX,EAX
00857859 : JNZ 0x0085798f
0085785f : MOV ECX,dword ptr [0x00da93ec]
00857865 : MOV dword ptr [ECX + 0x598],EDI
0085786b : PUSH 0xc3fed4
00857870 : LEA ECX,[EBP + -0x48]
00857873 : CALL 0x00406460
00857878 : MOV dword ptr [EBP + -0x4],0x1
0085787f : CMP dword ptr [EBX + 0x1ad8],EDI
00857885 : JZ 0x008578d1
00857887 : CMP dword ptr [EBX + 0x1adc],0x8
0085788e : JC 0x00857898
00857890 : MOV EAX,dword ptr [EBX + 0x1ac8]
00857896 : JMP 0x0085789e
00857898 : LEA EAX,[EBX + 0x1ac8]
0085789e : PUSH EAX
0085789f : PUSH 0xc3fed8
008578a4 : LEA ESI,[EBP + -0x80]
008578a7 : CALL 0x00404750
008578ac : ADD ESP,0x8
008578af : MOV byte ptr [EBP + -0x4],0x2
008578b3 : PUSH -0x1
008578b5 : PUSH 0x0
008578b7 : PUSH EAX
008578b8 : LEA ECX,[EBP + -0x48]
008578bb : CALL 0x00405eb0
008578c0 : MOV byte ptr [EBP + -0x4],0x1
008578c4 : MOV ECX,ESI
008578c6 : CALL 0x00406560
008578cb : MOV ESI,dword ptr [EBP + 0xffffff7c]
008578d1 : PUSH 0xc3fee4
008578d6 : LEA ECX,[EBP + -0x80]
008578d9 : CALL 0x00406460
008578de : MOV byte ptr [EBP + -0x4],0x3
008578e2 : MOV ECX,dword ptr [0x0172491c]
008578e8 : LEA EDX,[EBP + -0x80]
008578eb : PUSH EDX
008578ec : LEA EDI,[EBP + 0xffffff60]
008578f2 : CALL 0x0081d120
008578f7 : MOV byte ptr [EBP + -0x4],0x4
008578fb : MOV ECX,dword ptr [EBP + -0x44]
008578fe : MOV EDI,0x8
00857903 : CMP dword ptr [EBP + -0x30],EDI
00857906 : JNC 0x0085790b
00857908 : LEA ECX,[EBP + -0x44]
0085790b : CMP dword ptr [ESI + 0x24],EDI
0085790e : JC 0x00857915
00857910 : MOV ESI,dword ptr [ESI + 0x10]
00857913 : JMP 0x00857918
00857915 : ADD ESI,0x10
00857918 : CMP dword ptr [EAX + 0x18],EDI
0085791b : JC 0x00857922
0085791d : MOV EAX,dword ptr [EAX + 0x4]
00857920 : JMP 0x00857925
00857922 : ADD EAX,0x4
00857925 : PUSH ECX
00857926 : PUSH ESI
00857927 : PUSH EAX
00857928 : LEA ESI,[EBP + -0x64]
0085792b : CALL 0x00404750
00857930 : ADD ESP,0xc
00857933 : MOV byte ptr [EBP + -0x4],0x6
00857937 : LEA ECX,[EBP + 0xffffff60]
0085793d : CALL 0x00406560
00857942 : MOV byte ptr [EBP + -0x4],0x7
00857946 : LEA ECX,[EBP + -0x80]
00857949 : CALL 0x00406560
0085794e : MOV EAX,[0x00da9894]
00857953 : MOV EAX,dword ptr [EAX]
00857955 : MOV ECX,dword ptr [EAX + 0x1a8]
0085795b : MOV EDX,dword ptr [ECX]
0085795d : MOV EDX,dword ptr [EDX + 0x44]
00857960 : PUSH 0x10
00857962 : MOV EAX,ESI
00857964 : PUSH EAX
00857965 : CALL EDX
00857967 : CALL dword ptr [0x00b85598]
0085796d : MOV dword ptr [EBX + 0x1ac0],EAX
00857973 : MOV byte ptr [EBP + -0x4],0x1
00857977 : MOV ECX,ESI
00857979 : CALL 0x00406560
0085797e : MOV dword ptr [EBP + -0x4],0xffffffff
00857985 : LEA ECX,[EBP + -0x48]
00857988 : CALL 0x00406560
0085798d : JMP 0x00857994
0085798f : MOV EDI,0x8
00857994 : PUSH 0xc3ff00
00857999 : LEA ECX,[EBP + -0x48]
0085799c : CALL 0x00406460
008579a1 : MOV dword ptr [EBP + -0x4],EDI
008579a4 : MOV ECX,dword ptr [0x0172491c]
008579aa : LEA EAX,[EBP + -0x48]
008579ad : PUSH EAX
008579ae : LEA EDI,[EBP + -0x80]
008579b1 : CALL 0x0081d120
008579b6 : MOV byte ptr [EBP + -0x4],0x9
008579ba : MOV EDI,0x8
008579bf : CMP dword ptr [EAX + 0x18],EDI
008579c2 : JC 0x008579c9
008579c4 : MOV EAX,dword ptr [EAX + 0x4]
008579c7 : JMP 0x008579cc
008579c9 : ADD EAX,0x4
008579cc : PUSH EAX
008579cd : PUSH 0xc3ff1c
008579d2 : LEA ESI,[EBP + -0x2c]
008579d5 : CALL 0x00404750
008579da : ADD ESP,0x8
008579dd : MOV byte ptr [EBP + -0x4],0xb
008579e1 : CMP dword ptr [EBP + -0x68],EDI
008579e4 : JC 0x008579ee
008579e6 : MOV ECX,dword ptr [EBP + -0x7c]
008579e9 : CALL 0x006f04e0
008579ee : MOV ESI,0x7
008579f3 : XOR EDI,EDI
008579f5 : XOR ECX,ECX
008579f7 : MOV dword ptr [EBP + -0x68],ESI
008579fa : MOV dword ptr [EBP + -0x6c],EDI
008579fd : MOV word ptr [EBP + -0x7c],CX
00857a01 : MOV byte ptr [EBP + -0x4],0xc
00857a05 : CMP dword ptr [EBP + -0x30],0x8
00857a09 : JC 0x00857a13
00857a0b : MOV ECX,dword ptr [EBP + -0x44]
00857a0e : CALL 0x006f04e0
00857a13 : XOR EDX,EDX
00857a15 : LEA EAX,[EBP + -0x2c]
00857a18 : MOV word ptr [EBP + -0x44],DX
00857a1c : PUSH EAX
00857a1d : LEA EDX,[EBP + -0x80]
00857a20 : LEA ECX,[EBX + 0xc]
00857a23 : PUSH EDX
00857a24 : MOV dword ptr [EBP + -0x30],ESI
00857a27 : MOV dword ptr [EBP + -0x34],EDI
00857a2a : CALL 0x00403450
00857a2f : ADD ESP,0x8
00857a32 : MOV byte ptr [EBP + -0x4],0xd
00857a36 : PUSH -0x1
00857a38 : PUSH EDI
00857a39 : PUSH EAX
00857a3a : LEA ECX,[EBP + -0x2c]
00857a3d : CALL 0x00405eb0
00857a42 : MOV byte ptr [EBP + -0x4],0xc
00857a46 : CMP dword ptr [EBP + -0x68],0x8
00857a4a : JC 0x00857a54
00857a4c : MOV ECX,dword ptr [EBP + -0x7c]
00857a4f : CALL 0x006f04e0
00857a54 : MOV dword ptr [EBP + -0x68],ESI
00857a57 : MOV ESI,dword ptr [EBX + 0x3f8]
00857a5d : XOR EAX,EAX
00857a5f : MOV dword ptr [EBP + -0x6c],EDI
00857a62 : MOV word ptr [EBP + -0x7c],AX
00857a66 : CMP ESI,EDI
00857a68 : JZ 0x00857a88
00857a6a : MOV EBX,dword ptr [EBX + 0x42c]
00857a70 : PUSH -0x1
00857a72 : PUSH EDI
00857a73 : LEA ECX,[EBP + -0x2c]
00857a76 : PUSH ECX
00857a77 : LEA ECX,[ESI + 0x1d8]
00857a7d : CALL 0x00405eb0
00857a82 : MOV dword ptr [ESI + 0x1f4],EBX
00857a88 : MOV dword ptr [EBP + -0x4],0xffffffff
00857a8f : CMP dword ptr [EBP + -0x14],0x8
00857a93 : JC 0x00857a9d
00857a95 : MOV ECX,dword ptr [EBP + -0x28]
00857a98 : CALL 0x006f04e0
00857a9d : XOR EDX,EDX
00857a9f : MOV dword ptr [EBP + -0x14],0x7
00857aa6 : MOV dword ptr [EBP + -0x18],EDI
00857aa9 : MOV word ptr [EBP + -0x28],DX
00857aad : JMP 0x00857b53
00857ab2 : MOV ESI,dword ptr [ESI + 0x4]
00857ab5 : CMP ECX,ESI
00857ab7 : JNZ 0x00857b2a
00857ab9 : PUSH 0xc3ff2c
00857abe : LEA ECX,[EBP + -0x64]
00857ac1 : CALL 0x00406460
00857ac6 : MOV dword ptr [EBP + -0x4],0xe
00857acd : MOV EAX,[0x00da9894]
00857ad2 : MOV EAX,dword ptr [EAX]
00857ad4 : MOV ESI,dword ptr [EAX + 0x1a8]
00857ada : LEA ECX,[EBP + -0x64]
00857add : PUSH ECX
00857ade : MOV ECX,dword ptr [0x0172491c]
00857ae4 : LEA EDI,[EBP + 0xffffff60]
00857aea : CALL 0x0081d120
00857aef : MOV byte ptr [EBP + -0x4],0xf
00857af3 : MOV EDX,dword ptr [ESI]
00857af5 : PUSH 0x10
00857af7 : PUSH EAX
00857af8 : MOV EAX,dword ptr [EDX + 0x44]
00857afb : MOV ECX,ESI
00857afd : CALL EAX
00857aff : MOV byte ptr [EBP + -0x4],0xe
00857b03 : MOV ECX,EDI
00857b05 : CALL 0x00406560
00857b0a : MOV dword ptr [EBP + -0x4],0xffffffff
00857b11 : LEA ECX,[EBP + -0x64]
00857b14 : CALL 0x00406560
00857b19 : CALL 0x0096af80
00857b1e : MOV dword ptr [EBX + 0x1ac0],0x0
00857b28 : XOR EDI,EDI
00857b2a : MOV ESI,dword ptr [EBX + 0x3f8]
00857b30 : CMP ESI,EDI
00857b32 : JZ 0x00857b53
00857b34 : MOV EDI,dword ptr [EBX + 0x42c]
00857b3a : PUSH -0x1
00857b3c : PUSH 0x0
00857b3e : ADD EBX,0xc
00857b41 : PUSH EBX
00857b42 : LEA ECX,[ESI + 0x1d8]
00857b48 : CALL 0x00405eb0
00857b4d : MOV dword ptr [ESI + 0x1f4],EDI
00857b53 : MOV ECX,dword ptr [EBP + -0xc]
00857b56 : MOV dword ptr FS:[0x0],ECX
00857b5d : POP ECX
00857b5e : POP EDI
00857b5f : POP ESI
00857b60 : POP EBX
00857b61 : MOV ECX,dword ptr [EBP + -0x10]
00857b64 : XOR ECX,EBP
00857b66 : CALL 0x00633e6b
00857b6b : MOV ESP,EBP
00857b6d : POP EBP
00857b6e : RET 0x8

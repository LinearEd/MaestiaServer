PROGRAM  : Maestia.exe
FUNCTION : FUN_00409ca0
ENTRY    : 00409ca0
BODY     : [[00409ca0, 00409e1e] [00409e30, 00409eb9] [00409ec0, 00409f7a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00409ca0(uint param_1,undefined8 *param_2,undefined8 *param_3)

{
  int iVar1;
  uint *puVar2;
  int iVar3;
  uint uVar4;
  undefined4 uVar5;
  undefined8 *puVar6;
  uint in_ECX;
  int extraout_ECX;
  int iVar7;
  undefined8 *puVar8;
  undefined8 *puVar9;
  uint uStack_40;
  undefined8 local_30;
  undefined1 local_28;
  int local_24;
  undefined4 local_20;
  int local_1c;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  iVar1 = param_1;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7c880;
  local_10 = ExceptionList;
  uStack_40 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&uStack_40;
  ExceptionList = &local_10;
  iVar3 = *(int *)(param_1 + 4);
  if (iVar3 == 0) {
    param_1 = 0;
  }
  else {
    param_1 = (*(int *)(param_1 + 0xc) - iVar3) / 9;
  }
  if (in_ECX != 0) {
    iVar7 = *(int *)(iVar1 + 8);
    iVar3 = (iVar7 - iVar3) / 9;
    puVar2 = &uStack_40;
    if (0x1c71c71cU - iVar3 < in_ECX) {
      iVar3 = FUN_00452880();
      iVar7 = extraout_ECX;
      puVar2 = (uint *)local_14;
    }
    local_14 = (undefined1 *)puVar2;
    uVar4 = iVar3 + in_ECX;
    if (param_1 < uVar4) {
      if (0x1c71c71c - (param_1 >> 1) < param_1) {
        param_1 = 0;
      }
      else {
        param_1 = param_1 + (param_1 >> 1);
      }
      if (param_1 < uVar4) {
        param_1 = uVar4;
      }
      local_1c = FUN_0040c280();
      local_24 = ((int)param_2 - *(int *)(iVar1 + 4)) / 9;
      local_8 = 0;
      FUN_0040b920(param_3);
      iVar3 = local_1c;
      local_20 = 1;
      FUN_0040c250(*(undefined4 *)(iVar1 + 4),param_2);
      local_20 = 2;
      FUN_0040c250(param_2,*(undefined4 *)(iVar1 + 8));
      local_8 = 0xffffffff;
      if (*(int *)(iVar1 + 4) == 0) {
        *(uint *)(iVar1 + 0xc) = iVar3 + param_1 * 9;
        *(uint *)(iVar1 + 8) =
             iVar3 + (in_ECX + (*(int *)(iVar1 + 8) - *(int *)(iVar1 + 4)) / 9) * 9;
        *(int *)(iVar1 + 4) = iVar3;
        ExceptionList = local_10;
        return;
      }
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    if ((uint)((iVar7 - (int)param_2) / 9) < in_ECX) {
      local_30 = *param_3;
      local_28 = *(undefined1 *)(param_3 + 1);
      FUN_0040c250(param_2,iVar7);
      local_8 = 2;
      FUN_0040b920(&local_30);
      *(int *)(iVar1 + 8) = *(int *)(iVar1 + 8) + in_ECX * 9;
      puVar9 = (undefined8 *)(*(int *)(iVar1 + 8) + in_ECX * -9);
      if (param_2 != puVar9) {
        do {
          *param_2 = local_30;
          *(undefined1 *)(param_2 + 1) = local_28;
          param_2 = (undefined8 *)((int)param_2 + 9);
        } while (param_2 != puVar9);
        ExceptionList = local_10;
        return;
      }
    }
    else {
      local_30 = *param_3;
      local_28 = *(undefined1 *)(param_3 + 1);
      iVar3 = in_ECX * 9;
      puVar9 = (undefined8 *)(iVar7 + in_ECX * -9);
      uVar5 = FUN_0040c250(puVar9,iVar7);
      *(undefined4 *)(iVar1 + 8) = uVar5;
      if (param_2 != puVar9) {
        puVar8 = (undefined8 *)(iVar3 + (int)puVar9);
        do {
          puVar6 = (undefined8 *)((int)puVar9 + -9);
          *(undefined8 *)((int)puVar8 + -9) = *puVar6;
          *(undefined1 *)((int)puVar8 + -1) = *(undefined1 *)((int)puVar9 + -1);
          puVar9 = puVar6;
          puVar8 = (undefined8 *)((int)puVar8 + -9);
        } while (puVar6 != param_2);
      }
      puVar9 = param_2;
      if (param_2 != (undefined8 *)(iVar3 + (int)param_2)) {
        do {
          *puVar9 = local_30;
          *(undefined1 *)(puVar9 + 1) = local_28;
          puVar9 = (undefined8 *)((int)puVar9 + 9);
        } while (puVar9 != (undefined8 *)(iVar3 + (int)param_2));
      }
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00409ca0 : PUSH EBP
00409ca1 : MOV EBP,ESP
00409ca3 : PUSH -0x1
00409ca5 : PUSH 0xb7c880
00409caa : MOV EAX,FS:[0x0]
00409cb0 : PUSH EAX
00409cb1 : SUB ESP,0x20
00409cb4 : PUSH EBX
00409cb5 : PUSH ESI
00409cb6 : PUSH EDI
00409cb7 : MOV EAX,[0x00d66fa0]
00409cbc : XOR EAX,EBP
00409cbe : PUSH EAX
00409cbf : LEA EAX,[EBP + -0xc]
00409cc2 : MOV FS:[0x0],EAX
00409cc8 : MOV dword ptr [EBP + -0x10],ESP
00409ccb : MOV ESI,ECX
00409ccd : MOV EBX,dword ptr [EBP + 0x8]
00409cd0 : MOV EDI,dword ptr [EBX + 0x4]
00409cd3 : TEST EDI,EDI
00409cd5 : JNZ 0x00409cdc
00409cd7 : MOV dword ptr [EBP + 0x8],EDI
00409cda : JMP 0x00409cf4
00409cdc : MOV ECX,dword ptr [EBX + 0xc]
00409cdf : SUB ECX,EDI
00409ce1 : MOV EAX,0x38e38e39
00409ce6 : IMUL ECX
00409ce8 : SAR EDX,0x1
00409cea : MOV EAX,EDX
00409cec : SHR EAX,0x1f
00409cef : ADD EAX,EDX
00409cf1 : MOV dword ptr [EBP + 0x8],EAX
00409cf4 : TEST ESI,ESI
00409cf6 : JZ 0x00409f67
00409cfc : MOV ECX,dword ptr [EBX + 0x8]
00409cff : MOV EDX,ECX
00409d01 : SUB EDX,EDI
00409d03 : MOV EAX,0x38e38e39
00409d08 : IMUL EDX
00409d0a : SAR EDX,0x1
00409d0c : MOV EAX,EDX
00409d0e : SHR EAX,0x1f
00409d11 : ADD EAX,EDX
00409d13 : MOV EDX,0x1c71c71c
00409d18 : SUB EDX,EAX
00409d1a : CMP EDX,ESI
00409d1c : JNC 0x00409d23
00409d1e : CALL 0x00452880
00409d23 : ADD EAX,ESI
00409d25 : MOV EDX,dword ptr [EBP + 0x8]
00409d28 : CMP EDX,EAX
00409d2a : JNC 0x00409e30
00409d30 : MOV ECX,EDX
00409d32 : SHR ECX,0x1
00409d34 : MOV EDI,0x1c71c71c
00409d39 : SUB EDI,ECX
00409d3b : CMP EDI,EDX
00409d3d : JNC 0x00409d4b
00409d3f : MOV dword ptr [EBP + 0x8],0x0
00409d46 : MOV EDX,dword ptr [EBP + 0x8]
00409d49 : JMP 0x00409d50
00409d4b : ADD EDX,ECX
00409d4d : MOV dword ptr [EBP + 0x8],EDX
00409d50 : CMP EDX,EAX
00409d52 : JNC 0x00409d59
00409d54 : MOV dword ptr [EBP + 0x8],EAX
00409d57 : MOV EDX,EAX
00409d59 : MOV ECX,EDX
00409d5b : CALL 0x0040c280
00409d60 : MOV EDI,EAX
00409d62 : MOV dword ptr [EBP + -0x18],EDI
00409d65 : MOV ECX,dword ptr [EBP + 0xc]
00409d68 : SUB ECX,dword ptr [EBX + 0x4]
00409d6b : MOV EAX,0x38e38e39
00409d70 : IMUL ECX
00409d72 : SAR EDX,0x1
00409d74 : MOV EAX,EDX
00409d76 : SHR EAX,0x1f
00409d79 : ADD EAX,EDX
00409d7b : MOV dword ptr [EBP + -0x20],EAX
00409d7e : MOV dword ptr [EBP + -0x4],0x0
00409d85 : MOV ECX,dword ptr [EBP + 0x10]
00409d88 : PUSH ECX
00409d89 : LEA EDI,[EDI + EAX*0x8]
00409d8c : ADD EDI,EAX
00409d8e : CALL 0x0040b920
00409d93 : MOV dword ptr [EBP + -0x1c],0x1
00409d9a : MOV EDX,dword ptr [EBP + 0xc]
00409d9d : PUSH EDX
00409d9e : MOV EAX,dword ptr [EBX + 0x4]
00409da1 : PUSH EAX
00409da2 : MOV EDI,dword ptr [EBP + -0x18]
00409da5 : MOV EDX,EDI
00409da7 : CALL 0x0040c250
00409dac : MOV dword ptr [EBP + -0x1c],0x2
00409db3 : MOV ECX,dword ptr [EBP + -0x20]
00409db6 : LEA EAX,[ECX + ESI*0x1]
00409db9 : LEA EDX,[EDI + EAX*0x8]
00409dbc : ADD EDX,EAX
00409dbe : MOV EAX,dword ptr [EBX + 0x8]
00409dc1 : PUSH EAX
00409dc2 : MOV ECX,dword ptr [EBP + 0xc]
00409dc5 : PUSH ECX
00409dc6 : CALL 0x0040c250
00409dcb : MOV dword ptr [EBP + -0x4],0xffffffff
00409dd2 : MOV ECX,dword ptr [EBX + 0x4]
00409dd5 : MOV EDX,dword ptr [EBX + 0x8]
00409dd8 : SUB EDX,ECX
00409dda : MOV EAX,0x38e38e39
00409ddf : IMUL EDX
00409de1 : SAR EDX,0x1
00409de3 : MOV EAX,EDX
00409de5 : SHR EAX,0x1f
00409de8 : ADD EAX,EDX
00409dea : ADD ESI,EAX
00409dec : TEST ECX,ECX
00409dee : JZ 0x00409df5
00409df0 : CALL 0x006f04e0
00409df5 : MOV EAX,dword ptr [EBP + 0x8]
00409df8 : LEA ECX,[EDI + EAX*0x8]
00409dfb : ADD ECX,EAX
00409dfd : MOV dword ptr [EBX + 0xc],ECX
00409e00 : LEA EDX,[EDI + ESI*0x8]
00409e03 : ADD EDX,ESI
00409e05 : MOV dword ptr [EBX + 0x8],EDX
00409e08 : MOV dword ptr [EBX + 0x4],EDI
00409e0b : MOV ECX,dword ptr [EBP + -0xc]
00409e0e : MOV dword ptr FS:[0x0],ECX
00409e15 : POP ECX
00409e16 : POP EDI
00409e17 : POP ESI
00409e18 : POP EBX
00409e19 : MOV ESP,EBP
00409e1b : POP EBP
00409e1c : RET 0xc
00409e30 : MOV EDX,ECX
00409e32 : MOV EDI,dword ptr [EBP + 0xc]
00409e35 : SUB EDX,EDI
00409e37 : MOV EAX,0x38e38e39
00409e3c : IMUL EDX
00409e3e : SAR EDX,0x1
00409e40 : MOV EAX,EDX
00409e42 : SHR EAX,0x1f
00409e45 : ADD EAX,EDX
00409e47 : PUSH ECX
00409e48 : CMP EAX,ESI
00409e4a : JNC 0x00409eea
00409e50 : MOV EAX,dword ptr [EBP + 0x10]
00409e53 : MOVQ XMM0,qword ptr [EAX]
00409e57 : MOVQ qword ptr [EBP + -0x2c],XMM0
00409e5c : MOV DL,byte ptr [EAX + 0x8]
00409e5f : MOV byte ptr [EBP + -0x24],DL
00409e62 : LEA EAX,[ESI + ESI*0x8]
00409e65 : MOV dword ptr [EBP + 0x10],EAX
00409e68 : LEA EDX,[EAX + EDI*0x1]
00409e6b : PUSH EDI
00409e6c : CALL 0x0040c250
00409e71 : MOV dword ptr [EBP + -0x4],0x2
00409e78 : MOV EDI,dword ptr [EBX + 0x8]
00409e7b : LEA EAX,[EBP + -0x2c]
00409e7e : PUSH EAX
00409e7f : MOV ECX,EDI
00409e81 : SUB ECX,dword ptr [EBP + 0xc]
00409e84 : MOV EAX,0x38e38e39
00409e89 : IMUL ECX
00409e8b : SAR EDX,0x1
00409e8d : MOV ECX,EDX
00409e8f : SHR ECX,0x1f
00409e92 : ADD ECX,EDX
00409e94 : SUB ESI,ECX
00409e96 : CALL 0x0040b920
00409e9b : MOV dword ptr [EBP + -0x4],0xffffffff
00409ea2 : MOV EAX,dword ptr [EBP + 0x10]
00409ea5 : ADD dword ptr [EBX + 0x8],EAX
00409ea8 : MOV EBX,dword ptr [EBX + 0x8]
00409eab : SUB EBX,EAX
00409ead : MOV EAX,dword ptr [EBP + 0xc]
00409eb0 : CMP EAX,EBX
00409eb2 : JZ 0x00409f67
00409eb8 : JMP 0x00409ec0
00409ec0 : MOVQ XMM0,qword ptr [EBP + -0x2c]
00409ec5 : MOVQ qword ptr [EAX],XMM0
00409ec9 : MOV DL,byte ptr [EBP + -0x24]
00409ecc : MOV byte ptr [EAX + 0x8],DL
00409ecf : ADD EAX,0x9
00409ed2 : CMP EAX,EBX
00409ed4 : JNZ 0x00409ec0
00409ed6 : MOV ECX,dword ptr [EBP + -0xc]
00409ed9 : MOV dword ptr FS:[0x0],ECX
00409ee0 : POP ECX
00409ee1 : POP EDI
00409ee2 : POP ESI
00409ee3 : POP EBX
00409ee4 : MOV ESP,EBP
00409ee6 : POP EBP
00409ee7 : RET 0xc
00409eea : MOV EDI,dword ptr [EBP + 0x10]
00409eed : MOVQ XMM0,qword ptr [EDI]
00409ef1 : MOVQ qword ptr [EBP + -0x2c],XMM0
00409ef6 : MOV AL,byte ptr [EDI + 0x8]
00409ef9 : MOV byte ptr [EBP + -0x24],AL
00409efc : LEA EDI,[ESI + ESI*0x8]
00409eff : MOV ESI,ECX
00409f01 : SUB ESI,EDI
00409f03 : PUSH ESI
00409f04 : MOV EDX,ECX
00409f06 : CALL 0x0040c250
00409f0b : MOV dword ptr [EBX + 0x8],EAX
00409f0e : MOV EAX,ESI
00409f10 : MOV ECX,dword ptr [EBP + 0xc]
00409f13 : MOV ESI,ECX
00409f15 : CMP ECX,EAX
00409f17 : JZ 0x00409f3b
00409f19 : LEA ECX,[EDI + EAX*0x1]
00409f1c : LEA ESP,[ESP]
00409f20 : SUB EAX,0x9
00409f23 : SUB ECX,0x9
00409f26 : MOVQ XMM0,qword ptr [EAX]
00409f2a : MOVQ qword ptr [ECX],XMM0
00409f2e : MOV DL,byte ptr [EAX + 0x8]
00409f31 : MOV byte ptr [ECX + 0x8],DL
00409f34 : CMP EAX,ESI
00409f36 : JNZ 0x00409f20
00409f38 : MOV ECX,dword ptr [EBP + 0xc]
00409f3b : MOV EAX,ECX
00409f3d : LEA EDX,[EDI + ECX*0x1]
00409f40 : CMP ECX,EDX
00409f42 : JZ 0x00409f67
00409f44 : MOVQ XMM0,qword ptr [EBP + -0x2c]
00409f49 : LEA ESP,[ESP]
00409f50 : MOVQ qword ptr [EAX],XMM0
00409f54 : MOV CL,byte ptr [EBP + -0x24]
00409f57 : MOV byte ptr [EAX + 0x8],CL
00409f5a : ADD EAX,0x9
00409f5d : MOV EDX,dword ptr [EBP + 0xc]
00409f60 : LEA ECX,[EDI + EDX*0x1]
00409f63 : CMP EAX,ECX
00409f65 : JNZ 0x00409f50
00409f67 : MOV ECX,dword ptr [EBP + -0xc]
00409f6a : MOV dword ptr FS:[0x0],ECX
00409f71 : POP ECX
00409f72 : POP EDI
00409f73 : POP ESI
00409f74 : POP EBX
00409f75 : MOV ESP,EBP
00409f77 : POP EBP
00409f78 : RET 0xc

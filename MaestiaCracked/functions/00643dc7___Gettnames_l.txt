PROGRAM  : Maestia.exe
FUNCTION : __Gettnames_l
ENTRY    : 00643dc7
BODY     : [[00643dc7, 00643f04] [00643f08, 00643f3d] [00643f41, 00643f9d] [00643fa1, 00643fd6] [00643fda, 0064401e] [00644022, 00644058] [0064405c, 00644092] [00644096, 006440cc] [006440d0, 00644106] [0064410a, 0064411d]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    __Gettnames_l
   
   Library: Visual Studio 2008 Release */

void * __Gettnames_l(localeinfo_struct *param_1)

{
  void *_Src;
  undefined4 *puVar1;
  size_t sVar2;
  size_t sVar3;
  size_t sVar4;
  size_t sVar5;
  void *_Dst;
  errno_t eVar6;
  int iVar7;
  int iVar8;
  char *pcVar9;
  int local_28 [2];
  int local_20;
  char local_1c;
  size_t local_18;
  undefined4 *local_14;
  undefined4 *local_10;
  size_t local_c;
  undefined4 *local_8;
  
  iVar8 = 0;
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_28,param_1);
  _Src = *(void **)(local_28[0] + 0xd4);
  local_8 = (undefined4 *)0x0;
  do {
    iVar7 = (int)local_8 * 4;
    local_18 = _strlen(*(char **)(iVar7 + 0x1c + (int)_Src));
    sVar2 = _strlen(*(char **)(iVar7 + (int)_Src));
    local_8 = (undefined4 *)((int)local_8 + 1);
    iVar8 = sVar2 + iVar8 + 2 + local_18;
  } while (local_8 < 7);
  local_14 = (undefined4 *)((int)_Src + 0x38);
  local_10 = (undefined4 *)0xc;
  do {
    puVar1 = local_14;
    local_18 = _strlen((char *)local_14[0xc]);
    sVar2 = _strlen((char *)*puVar1);
    local_14 = local_14 + 1;
    local_10 = (undefined4 *)((int)local_10 + -1);
    iVar8 = sVar2 + iVar8 + 2 + local_18;
  } while (local_10 != (undefined4 *)0x0);
  sVar2 = _strlen(*(char **)((int)_Src + 0x9c));
  sVar3 = _strlen(*(char **)((int)_Src + 0x98));
  sVar4 = _strlen(*(char **)((int)_Src + 0xa0));
  sVar5 = _strlen(*(char **)((int)_Src + 0xa4));
  local_c = _strlen(*(char **)((int)_Src + 0xa8));
  local_c = sVar3 + iVar8 + sVar2 + sVar4 + sVar5 + 0xbd + local_c;
  _Dst = __malloc_crt(local_c);
  if (_Dst != (void *)0x0) {
    pcVar9 = (char *)((int)_Dst + 0xb8);
    _memcpy(_Dst,_Src,0xb8);
    local_8 = (undefined4 *)0x0;
    local_10 = (undefined4 *)((int)_Src + 0x1c);
    local_14 = (undefined4 *)((int)_Dst - (int)_Src);
    do {
      *(char **)((int)_Dst + (int)local_8 * 4) = pcVar9;
      eVar6 = _strcpy_s(pcVar9,(int)_Dst + (local_c - (int)pcVar9),(char *)local_10[-7]);
      if (eVar6 != 0) {
                    /* WARNING: Subroutine does not return */
        __invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
      }
      sVar2 = _strlen(pcVar9);
      pcVar9 = pcVar9 + sVar2 + 1;
      *(char **)((int)local_14 + (int)local_10) = pcVar9;
      eVar6 = _strcpy_s(pcVar9,(int)_Dst + (local_c - (int)pcVar9),(char *)*local_10);
      if (eVar6 != 0) {
                    /* WARNING: Subroutine does not return */
        __invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
      }
      sVar2 = _strlen(pcVar9);
      local_8 = (undefined4 *)((int)local_8 + 1);
      local_10 = local_10 + 1;
      pcVar9 = pcVar9 + sVar2 + 1;
    } while (local_8 < 7);
    local_8 = (undefined4 *)((int)_Dst + 0x68);
    local_10 = (undefined4 *)((int)_Src + 0x38);
    local_18 = 0xc;
    do {
      *(char **)((int)local_10 + (int)local_14) = pcVar9;
      eVar6 = _strcpy_s(pcVar9,(int)_Dst + (local_c - (int)pcVar9),(char *)*local_10);
      if (eVar6 != 0) {
                    /* WARNING: Subroutine does not return */
        __invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
      }
      sVar2 = _strlen(pcVar9);
      pcVar9 = pcVar9 + sVar2 + 1;
      *local_8 = pcVar9;
      eVar6 = _strcpy_s(pcVar9,(int)_Dst + (local_c - (int)pcVar9),(char *)local_10[0xc]);
      if (eVar6 != 0) {
                    /* WARNING: Subroutine does not return */
        __invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
      }
      sVar2 = _strlen(pcVar9);
      local_10 = local_10 + 1;
      local_8 = local_8 + 1;
      local_18 = local_18 + -1;
      pcVar9 = pcVar9 + sVar2 + 1;
    } while (local_18 != 0);
    *(char **)((int)_Dst + 0x98) = pcVar9;
    eVar6 = _strcpy_s(pcVar9,(int)_Dst + (local_c - (int)pcVar9),*(char **)((int)_Src + 0x98));
    if (eVar6 != 0) {
                    /* WARNING: Subroutine does not return */
      __invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
    }
    sVar2 = _strlen(pcVar9);
    pcVar9 = pcVar9 + sVar2 + 1;
    *(char **)((int)_Dst + 0x9c) = pcVar9;
    eVar6 = _strcpy_s(pcVar9,(int)_Dst + (local_c - (int)pcVar9),*(char **)((int)_Src + 0x9c));
    if (eVar6 != 0) {
                    /* WARNING: Subroutine does not return */
      __invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
    }
    sVar2 = _strlen(pcVar9);
    pcVar9 = pcVar9 + sVar2 + 1;
    *(char **)((int)_Dst + 0xa0) = pcVar9;
    eVar6 = _strcpy_s(pcVar9,(int)_Dst + (local_c - (int)pcVar9),*(char **)((int)_Src + 0xa0));
    if (eVar6 != 0) {
                    /* WARNING: Subroutine does not return */
      __invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
    }
    sVar2 = _strlen(pcVar9);
    pcVar9 = pcVar9 + sVar2 + 1;
    *(char **)((int)_Dst + 0xa4) = pcVar9;
    eVar6 = _strcpy_s(pcVar9,(int)_Dst + (local_c - (int)pcVar9),*(char **)((int)_Src + 0xa4));
    if (eVar6 != 0) {
                    /* WARNING: Subroutine does not return */
      __invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
    }
    sVar2 = _strlen(pcVar9);
    pcVar9 = pcVar9 + sVar2 + 1;
    *(char **)((int)_Dst + 0xa8) = pcVar9;
    eVar6 = _strcpy_s(pcVar9,(int)_Dst + (local_c - (int)pcVar9),*(char **)((int)_Src + 0xa8));
    if (eVar6 != 0) {
                    /* WARNING: Subroutine does not return */
      __invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
    }
  }
  if (local_1c != '\0') {
    *(uint *)(local_20 + 0x70) = *(uint *)(local_20 + 0x70) & 0xfffffffd;
  }
  return _Dst;
}



============================================================
DISASSEMBLY
============================================================
00643dc7 : MOV EDI,EDI
00643dc9 : PUSH EBP
00643dca : MOV EBP,ESP
00643dcc : SUB ESP,0x24
00643dcf : PUSH EBX
00643dd0 : PUSH ESI
00643dd1 : PUSH EDI
00643dd2 : PUSH dword ptr [EBP + 0x8]
00643dd5 : LEA ECX,[EBP + -0x24]
00643dd8 : XOR EDI,EDI
00643dda : CALL 0x00637880
00643ddf : MOV EAX,dword ptr [EBP + -0x24]
00643de2 : MOV ESI,dword ptr [EAX + 0xd4]
00643de8 : MOV dword ptr [EBP + -0x4],EDI
00643deb : MOV EBX,dword ptr [EBP + -0x4]
00643dee : SHL EBX,0x2
00643df1 : PUSH dword ptr [EBX + ESI*0x1 + 0x1c]
00643df5 : CALL 0x00640960
00643dfa : PUSH dword ptr [EBX + ESI*0x1]
00643dfd : MOV dword ptr [EBP + -0x14],EAX
00643e00 : CALL 0x00640960
00643e05 : ADD EAX,EDI
00643e07 : INC dword ptr [EBP + -0x4]
00643e0a : CMP dword ptr [EBP + -0x4],0x7
00643e0e : POP ECX
00643e0f : POP ECX
00643e10 : MOV ECX,dword ptr [EBP + -0x14]
00643e13 : LEA EDI,[EAX + ECX*0x1 + 0x2]
00643e17 : JC 0x00643deb
00643e19 : LEA EAX,[ESI + 0x38]
00643e1c : MOV dword ptr [EBP + -0x10],EAX
00643e1f : MOV dword ptr [EBP + -0xc],0xc
00643e26 : MOV EBX,dword ptr [EBP + -0x10]
00643e29 : PUSH dword ptr [EBX + 0x30]
00643e2c : CALL 0x00640960
00643e31 : PUSH dword ptr [EBX]
00643e33 : MOV dword ptr [EBP + -0x14],EAX
00643e36 : CALL 0x00640960
00643e3b : ADD dword ptr [EBP + -0x10],0x4
00643e3f : POP ECX
00643e40 : POP ECX
00643e41 : MOV ECX,dword ptr [EBP + -0x14]
00643e44 : ADD EAX,EDI
00643e46 : DEC dword ptr [EBP + -0xc]
00643e49 : LEA EDI,[EAX + ECX*0x1 + 0x2]
00643e4d : JNZ 0x00643e26
00643e4f : PUSH dword ptr [ESI + 0x9c]
00643e55 : CALL 0x00640960
00643e5a : PUSH dword ptr [ESI + 0x98]
00643e60 : MOV EBX,EAX
00643e62 : CALL 0x00640960
00643e67 : PUSH dword ptr [ESI + 0xa0]
00643e6d : ADD EAX,EDI
00643e6f : LEA EDI,[EAX + EBX*0x1 + 0x2]
00643e73 : CALL 0x00640960
00643e78 : PUSH dword ptr [ESI + 0xa4]
00643e7e : LEA EDI,[EDI + EAX*0x1 + 0x1]
00643e82 : CALL 0x00640960
00643e87 : PUSH dword ptr [ESI + 0xa8]
00643e8d : LEA EDI,[EDI + EAX*0x1 + 0x1]
00643e91 : CALL 0x00640960
00643e96 : LEA EAX,[EDI + EAX*0x1 + 0xb9]
00643e9d : PUSH EAX
00643e9e : MOV dword ptr [EBP + -0x8],EAX
00643ea1 : CALL 0x0064255f
00643ea6 : MOV EBX,EAX
00643ea8 : ADD ESP,0x18
00643eab : TEST EBX,EBX
00643ead : JZ 0x0064410a
00643eb3 : PUSH 0xb8
00643eb8 : PUSH ESI
00643eb9 : PUSH EBX
00643eba : LEA EDI,[EBX + 0xb8]
00643ec0 : CALL 0x0063ae40
00643ec5 : AND dword ptr [EBP + -0x4],0x0
00643ec9 : LEA EAX,[ESI + 0x1c]
00643ecc : MOV dword ptr [EBP + -0x10],EBX
00643ecf : ADD ESP,0xc
00643ed2 : SUB dword ptr [EBP + -0x10],ESI
00643ed5 : MOV dword ptr [EBP + -0xc],EAX
00643ed8 : MOV EAX,dword ptr [EBP + -0x4]
00643edb : MOV dword ptr [EBX + EAX*0x4],EDI
00643ede : MOV EAX,dword ptr [EBP + -0xc]
00643ee1 : PUSH dword ptr [EAX + -0x1c]
00643ee4 : MOV EAX,EBX
00643ee6 : SUB EAX,EDI
00643ee8 : ADD EAX,dword ptr [EBP + -0x8]
00643eeb : PUSH EAX
00643eec : PUSH EDI
00643eed : CALL 0x00638300
00643ef2 : ADD ESP,0xc
00643ef5 : TEST EAX,EAX
00643ef7 : JZ 0x00643f08
00643ef9 : XOR EAX,EAX
00643efb : PUSH EAX
00643efc : PUSH EAX
00643efd : PUSH EAX
00643efe : PUSH EAX
00643eff : PUSH EAX
00643f00 : CALL 0x00637169
00643f08 : PUSH EDI
00643f09 : CALL 0x00640960
00643f0e : MOV ECX,dword ptr [EBP + -0x10]
00643f11 : LEA EDI,[EDI + EAX*0x1 + 0x1]
00643f15 : MOV EAX,dword ptr [EBP + -0xc]
00643f18 : MOV dword ptr [ECX + EAX*0x1],EDI
00643f1b : PUSH dword ptr [EAX]
00643f1d : MOV EAX,EBX
00643f1f : SUB EAX,EDI
00643f21 : ADD EAX,dword ptr [EBP + -0x8]
00643f24 : PUSH EAX
00643f25 : PUSH EDI
00643f26 : CALL 0x00638300
00643f2b : ADD ESP,0x10
00643f2e : TEST EAX,EAX
00643f30 : JZ 0x00643f41
00643f32 : XOR EAX,EAX
00643f34 : PUSH EAX
00643f35 : PUSH EAX
00643f36 : PUSH EAX
00643f37 : PUSH EAX
00643f38 : PUSH EAX
00643f39 : CALL 0x00637169
00643f41 : PUSH EDI
00643f42 : CALL 0x00640960
00643f47 : INC dword ptr [EBP + -0x4]
00643f4a : ADD dword ptr [EBP + -0xc],0x4
00643f4e : CMP dword ptr [EBP + -0x4],0x7
00643f52 : POP ECX
00643f53 : LEA EDI,[EDI + EAX*0x1 + 0x1]
00643f57 : JC 0x00643ed8
00643f5d : LEA EAX,[EBX + 0x68]
00643f60 : MOV dword ptr [EBP + -0x4],EAX
00643f63 : LEA EAX,[ESI + 0x38]
00643f66 : MOV dword ptr [EBP + -0xc],EAX
00643f69 : MOV dword ptr [EBP + -0x14],0xc
00643f70 : JMP 0x00643f75
00643f72 : MOV EAX,dword ptr [EBP + -0xc]
00643f75 : MOV ECX,dword ptr [EBP + -0x10]
00643f78 : MOV dword ptr [EAX + ECX*0x1],EDI
00643f7b : PUSH dword ptr [EAX]
00643f7d : MOV EAX,EBX
00643f7f : SUB EAX,EDI
00643f81 : ADD EAX,dword ptr [EBP + -0x8]
00643f84 : PUSH EAX
00643f85 : PUSH EDI
00643f86 : CALL 0x00638300
00643f8b : ADD ESP,0xc
00643f8e : TEST EAX,EAX
00643f90 : JZ 0x00643fa1
00643f92 : XOR EAX,EAX
00643f94 : PUSH EAX
00643f95 : PUSH EAX
00643f96 : PUSH EAX
00643f97 : PUSH EAX
00643f98 : PUSH EAX
00643f99 : CALL 0x00637169
00643fa1 : PUSH EDI
00643fa2 : CALL 0x00640960
00643fa7 : LEA EDI,[EDI + EAX*0x1 + 0x1]
00643fab : MOV EAX,dword ptr [EBP + -0x4]
00643fae : MOV dword ptr [EAX],EDI
00643fb0 : MOV EAX,dword ptr [EBP + -0xc]
00643fb3 : PUSH dword ptr [EAX + 0x30]
00643fb6 : MOV EAX,EBX
00643fb8 : SUB EAX,EDI
00643fba : ADD EAX,dword ptr [EBP + -0x8]
00643fbd : PUSH EAX
00643fbe : PUSH EDI
00643fbf : CALL 0x00638300
00643fc4 : ADD ESP,0x10
00643fc7 : TEST EAX,EAX
00643fc9 : JZ 0x00643fda
00643fcb : XOR EAX,EAX
00643fcd : PUSH EAX
00643fce : PUSH EAX
00643fcf : PUSH EAX
00643fd0 : PUSH EAX
00643fd1 : PUSH EAX
00643fd2 : CALL 0x00637169
00643fda : PUSH EDI
00643fdb : CALL 0x00640960
00643fe0 : ADD dword ptr [EBP + -0xc],0x4
00643fe4 : ADD dword ptr [EBP + -0x4],0x4
00643fe8 : DEC dword ptr [EBP + -0x14]
00643feb : POP ECX
00643fec : LEA EDI,[EDI + EAX*0x1 + 0x1]
00643ff0 : JNZ 0x00643f72
00643ff2 : MOV EAX,EBX
00643ff4 : SUB EAX,EDI
00643ff6 : ADD EAX,dword ptr [EBP + -0x8]
00643ff9 : MOV dword ptr [EBX + 0x98],EDI
00643fff : PUSH dword ptr [ESI + 0x98]
00644005 : PUSH EAX
00644006 : PUSH EDI
00644007 : CALL 0x00638300
0064400c : ADD ESP,0xc
0064400f : TEST EAX,EAX
00644011 : JZ 0x00644022
00644013 : XOR EAX,EAX
00644015 : PUSH EAX
00644016 : PUSH EAX
00644017 : PUSH EAX
00644018 : PUSH EAX
00644019 : PUSH EAX
0064401a : CALL 0x00637169
00644022 : PUSH EDI
00644023 : CALL 0x00640960
00644028 : LEA EDI,[EDI + EAX*0x1 + 0x1]
0064402c : MOV EAX,EBX
0064402e : SUB EAX,EDI
00644030 : ADD EAX,dword ptr [EBP + -0x8]
00644033 : MOV dword ptr [EBX + 0x9c],EDI
00644039 : PUSH dword ptr [ESI + 0x9c]
0064403f : PUSH EAX
00644040 : PUSH EDI
00644041 : CALL 0x00638300
00644046 : ADD ESP,0x10
00644049 : TEST EAX,EAX
0064404b : JZ 0x0064405c
0064404d : XOR EAX,EAX
0064404f : PUSH EAX
00644050 : PUSH EAX
00644051 : PUSH EAX
00644052 : PUSH EAX
00644053 : PUSH EAX
00644054 : CALL 0x00637169
0064405c : PUSH EDI
0064405d : CALL 0x00640960
00644062 : LEA EDI,[EDI + EAX*0x1 + 0x1]
00644066 : MOV EAX,EBX
00644068 : SUB EAX,EDI
0064406a : ADD EAX,dword ptr [EBP + -0x8]
0064406d : MOV dword ptr [EBX + 0xa0],EDI
00644073 : PUSH dword ptr [ESI + 0xa0]
00644079 : PUSH EAX
0064407a : PUSH EDI
0064407b : CALL 0x00638300
00644080 : ADD ESP,0x10
00644083 : TEST EAX,EAX
00644085 : JZ 0x00644096
00644087 : XOR EAX,EAX
00644089 : PUSH EAX
0064408a : PUSH EAX
0064408b : PUSH EAX
0064408c : PUSH EAX
0064408d : PUSH EAX
0064408e : CALL 0x00637169
00644096 : PUSH EDI
00644097 : CALL 0x00640960
0064409c : LEA EDI,[EDI + EAX*0x1 + 0x1]
006440a0 : MOV EAX,EBX
006440a2 : SUB EAX,EDI
006440a4 : ADD EAX,dword ptr [EBP + -0x8]
006440a7 : MOV dword ptr [EBX + 0xa4],EDI
006440ad : PUSH dword ptr [ESI + 0xa4]
006440b3 : PUSH EAX
006440b4 : PUSH EDI
006440b5 : CALL 0x00638300
006440ba : ADD ESP,0x10
006440bd : TEST EAX,EAX
006440bf : JZ 0x006440d0
006440c1 : XOR EAX,EAX
006440c3 : PUSH EAX
006440c4 : PUSH EAX
006440c5 : PUSH EAX
006440c6 : PUSH EAX
006440c7 : PUSH EAX
006440c8 : CALL 0x00637169
006440d0 : PUSH EDI
006440d1 : CALL 0x00640960
006440d6 : LEA EAX,[EDI + EAX*0x1 + 0x1]
006440da : MOV ECX,EBX
006440dc : SUB ECX,EAX
006440de : ADD ECX,dword ptr [EBP + -0x8]
006440e1 : MOV dword ptr [EBX + 0xa8],EAX
006440e7 : PUSH dword ptr [ESI + 0xa8]
006440ed : PUSH ECX
006440ee : PUSH EAX
006440ef : CALL 0x00638300
006440f4 : ADD ESP,0x10
006440f7 : TEST EAX,EAX
006440f9 : JZ 0x0064410a
006440fb : XOR EAX,EAX
006440fd : PUSH EAX
006440fe : PUSH EAX
006440ff : PUSH EAX
00644100 : PUSH EAX
00644101 : PUSH EAX
00644102 : CALL 0x00637169
0064410a : CMP byte ptr [EBP + -0x18],0x0
0064410e : JZ 0x00644117
00644110 : MOV EAX,dword ptr [EBP + -0x1c]
00644113 : AND dword ptr [EAX + 0x70],0xfffffffd
00644117 : POP EDI
00644118 : POP ESI
00644119 : MOV EAX,EBX
0064411b : POP EBX
0064411c : LEAVE
0064411d : RET

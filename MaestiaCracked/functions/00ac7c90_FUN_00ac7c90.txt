PROGRAM  : Maestia.exe
FUNCTION : FUN_00ac7c90
ENTRY    : 00ac7c90
BODY     : [[00ac7c90, 00ac7f9b] [00ac7f9e, 00ac8004]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00ac7c90(int param_1)

{
  char cVar1;
  int iVar2;
  int iVar3;
  LPCWSTR ***lpFileName;
  LPCVOID lpBuffer;
  uint local_a0;
  DWORD local_9c [2];
  undefined2 local_94;
  undefined4 local_84;
  uint local_80;
  DWORD local_7c;
  int local_78;
  int local_74;
  undefined1 *local_70;
  undefined1 local_69;
  LPCWSTR **local_64 [4];
  undefined4 local_54;
  uint local_50;
  uint local_48;
  undefined4 local_38;
  uint local_34;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b469fd;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_2c = 0;
  local_74 = param_1;
  local_18 = 7;
  local_1c = 0;
  FUN_00406360();
  local_8 = 0;
  FUN_0041d740();
  local_8._0_1_ = 1;
  iVar2 = FUN_00405bb0();
  local_69 = iVar2 == 0;
  local_8._0_1_ = 0;
  if (7 < local_80) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_94 = 0;
  local_80 = 7;
  local_84 = 0;
  FUN_00406360();
  local_70 = &stack0xffffff1c;
  FUN_00405eb0(local_30,0,0xffffffff);
  iVar2 = local_74;
  local_8 = (uint)local_8._1_3_ << 8;
  cVar1 = FUN_00ac6380(local_74);
  if (cVar1 == '\0') {
    FUN_00ac5bc0();
    local_8 = 0xffffffff;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c = 0;
  }
  else {
    FUN_00403510();
    local_8._0_1_ = 3;
    FUN_008b6db0();
    local_8._0_1_ = 4;
    FUN_00403510();
    local_8._0_1_ = 5;
    FUN_00403510();
    local_8 = CONCAT31(local_8._1_3_,7);
    if (7 < local_80) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_80 = 7;
    local_84 = 0;
    local_94 = 0;
    local_8._0_1_ = 8;
    if (7 < local_a0) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    iVar3 = InternetOpenA();
    *(int *)(iVar2 + 0x7c) = iVar3;
    if (iVar3 == 0) {
      FUN_00ac5bc0();
      local_8 = CONCAT31(local_8._1_3_,3);
      if (7 < local_50) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_50 = 7;
      local_54 = 0;
      local_64[0] = (LPCWSTR **)((uint)local_64[0] & 0xffff0000);
      local_8 = (uint)local_8._1_3_ << 8;
      if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_34 = 7;
      local_38 = 0;
      local_48 = local_48 & 0xffff0000;
      local_8 = 0xffffffff;
      if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_18 = 7;
      local_1c = 0;
      local_2c = 0;
    }
    else {
      iVar2 = InternetOpenUrlW();
      if (iVar2 != 0) {
        lpFileName = (LPCWSTR ***)local_64[0];
        if (local_50 < 8) {
          lpFileName = local_64;
        }
        local_70 = CreateFileW((LPCWSTR)lpFileName,0x40000000,0,(LPSECURITY_ATTRIBUTES)0x0,2,0x80,
                               (HANDLE)0x0);
        if (local_70 == (undefined1 *)0xffffffff) {
          InternetCloseHandle();
        }
        else {
          lpBuffer = (LPCVOID)0x0;
          do {
            InternetQueryDataAvailable();
            if (local_78 != 0) {
              lpBuffer = (LPCVOID)FUN_006f0760();
            }
            InternetReadFile();
            WriteFile(local_70,lpBuffer,local_7c,local_9c,(LPOVERLAPPED)0x0);
            if (lpBuffer != (LPCVOID)0x0) {
                    /* WARNING: Subroutine does not return */
              FUN_006f04e0();
            }
          } while (local_7c != 0);
          CloseHandle(local_70);
          InternetCloseHandle();
          FUN_00ac5e40();
        }
      }
      FUN_00ac5bc0();
      local_8._0_1_ = 3;
      FUN_00406560();
      local_8 = (uint)local_8._1_3_ << 8;
      FUN_00406560();
      local_8 = 0xffffffff;
      FUN_00406560();
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00ac7c90 : PUSH EBP
00ac7c91 : MOV EBP,ESP
00ac7c93 : PUSH -0x1
00ac7c95 : PUSH 0xb469fd
00ac7c9a : MOV EAX,FS:[0x0]
00ac7ca0 : PUSH EAX
00ac7ca1 : SUB ESP,0xa8
00ac7ca7 : MOV EAX,[0x00d66fa0]
00ac7cac : XOR EAX,EBP
00ac7cae : MOV dword ptr [EBP + -0x10],EAX
00ac7cb1 : PUSH EBX
00ac7cb2 : PUSH ESI
00ac7cb3 : PUSH EDI
00ac7cb4 : PUSH EAX
00ac7cb5 : LEA EAX,[EBP + -0xc]
00ac7cb8 : MOV FS:[0x0],EAX
00ac7cbe : MOV EAX,dword ptr [EBP + 0x8]
00ac7cc1 : XOR EBX,EBX
00ac7cc3 : XOR ECX,ECX
00ac7cc5 : PUSH EBX
00ac7cc6 : MOV word ptr [EBP + -0x28],CX
00ac7cca : MOV ESI,0x7
00ac7ccf : PUSH 0xc94aa4
00ac7cd4 : LEA ECX,[EBP + -0x2c]
00ac7cd7 : MOV dword ptr [EBP + -0x70],EAX
00ac7cda : MOV dword ptr [EBP + -0x14],ESI
00ac7cdd : MOV dword ptr [EBP + -0x18],EBX
00ac7ce0 : CALL 0x00406360
00ac7ce5 : MOV dword ptr [EBP + -0x4],EBX
00ac7ce8 : MOV EAX,[0x017248c8]
00ac7ced : LEA EDX,[EBP + 0xffffff6c]
00ac7cf3 : PUSH EDX
00ac7cf4 : PUSH EAX
00ac7cf5 : CALL 0x0041d740
00ac7cfa : MOV ECX,EAX
00ac7cfc : MOV byte ptr [EBP + -0x4],0x1
00ac7d00 : MOV EAX,dword ptr [ECX + 0x14]
00ac7d03 : PUSH 0xc94bb8
00ac7d08 : LEA EDI,[ESI + -0x3]
00ac7d0b : CALL 0x00405bb0
00ac7d10 : TEST EAX,EAX
00ac7d12 : SETZ byte ptr [EBP + -0x65]
00ac7d16 : MOV byte ptr [EBP + -0x4],BL
00ac7d19 : CMP dword ptr [EBP + -0x7c],0x8
00ac7d1d : JC 0x00ac7d2a
00ac7d1f : MOV ECX,dword ptr [EBP + 0xffffff70]
00ac7d25 : CALL 0x006f04e0
00ac7d2a : XOR ECX,ECX
00ac7d2c : MOV word ptr [EBP + 0xffffff70],CX
00ac7d33 : MOV dword ptr [EBP + -0x7c],ESI
00ac7d36 : MOV dword ptr [EBP + -0x80],EBX
00ac7d39 : LEA ECX,[EBP + -0x2c]
00ac7d3c : CMP byte ptr [EBP + -0x65],BL
00ac7d3f : JZ 0x00ac7d4a
00ac7d41 : PUSH 0x32
00ac7d43 : PUSH 0xc94bc8
00ac7d48 : JMP 0x00ac7d51
00ac7d4a : PUSH 0x3a
00ac7d4c : PUSH 0xc94c30
00ac7d51 : CALL 0x00406360
00ac7d56 : SUB ESP,0x1c
00ac7d59 : MOV ECX,ESP
00ac7d5b : MOV dword ptr [EBP + -0x6c],ESP
00ac7d5e : PUSH -0x1
00ac7d60 : PUSH EBX
00ac7d61 : LEA EAX,[EBP + -0x2c]
00ac7d64 : XOR EDX,EDX
00ac7d66 : MOV dword ptr [ECX + 0x18],ESI
00ac7d69 : MOV dword ptr [ECX + 0x14],EBX
00ac7d6c : PUSH EAX
00ac7d6d : MOV word ptr [ECX + 0x4],DX
00ac7d71 : CALL 0x00405eb0
00ac7d76 : MOV byte ptr [EBP + -0x4],0x2
00ac7d7a : MOV EDI,dword ptr [EBP + -0x70]
00ac7d7d : PUSH EDI
00ac7d7e : MOV byte ptr [EBP + -0x4],BL
00ac7d81 : CALL 0x00ac6380
00ac7d86 : CMP AL,BL
00ac7d88 : JNZ 0x00ac7db5
00ac7d8a : CALL 0x00ac5bc0
00ac7d8f : MOV dword ptr [EBP + -0x4],0xffffffff
00ac7d96 : CMP dword ptr [EBP + -0x14],0x8
00ac7d9a : JC 0x00ac7da4
00ac7d9c : MOV ECX,dword ptr [EBP + -0x28]
00ac7d9f : CALL 0x006f04e0
00ac7da4 : XOR ECX,ECX
00ac7da6 : MOV dword ptr [EBP + -0x14],ESI
00ac7da9 : MOV dword ptr [EBP + -0x18],EBX
00ac7dac : MOV word ptr [EBP + -0x28],CX
00ac7db0 : JMP 0x00ac7fe7
00ac7db5 : LEA EDX,[EBP + -0x48]
00ac7db8 : PUSH EDX
00ac7db9 : MOV EDX,0xc94ca8
00ac7dbe : LEA ECX,[EBP + -0x2c]
00ac7dc1 : CALL 0x00403510
00ac7dc6 : ADD ESP,0x4
00ac7dc9 : MOV byte ptr [EBP + -0x4],0x3
00ac7dcd : MOV ECX,dword ptr [0x017248c8]
00ac7dd3 : LEA EAX,[EBP + 0xffffff4c]
00ac7dd9 : PUSH EAX
00ac7dda : PUSH ECX
00ac7ddb : CALL 0x008b6db0
00ac7de0 : MOV byte ptr [EBP + -0x4],0x4
00ac7de4 : LEA EDX,[EBP + 0xffffff6c]
00ac7dea : PUSH EDX
00ac7deb : MOV EDX,0xc94cf8
00ac7df0 : MOV ECX,EAX
00ac7df2 : CALL 0x00403510
00ac7df7 : MOV byte ptr [EBP + -0x4],0x5
00ac7dfb : LEA ECX,[EBP + -0x64]
00ac7dfe : PUSH ECX
00ac7dff : MOV EDX,0xc94cd0
00ac7e04 : MOV ECX,EAX
00ac7e06 : CALL 0x00403510
00ac7e0b : ADD ESP,0x8
00ac7e0e : MOV byte ptr [EBP + -0x4],0x7
00ac7e12 : CMP dword ptr [EBP + -0x7c],0x8
00ac7e16 : JC 0x00ac7e23
00ac7e18 : MOV ECX,dword ptr [EBP + 0xffffff70]
00ac7e1e : CALL 0x006f04e0
00ac7e23 : XOR EDX,EDX
00ac7e25 : MOV dword ptr [EBP + -0x7c],ESI
00ac7e28 : MOV dword ptr [EBP + -0x80],EBX
00ac7e2b : MOV word ptr [EBP + 0xffffff70],DX
00ac7e32 : MOV byte ptr [EBP + -0x4],0x8
00ac7e36 : CMP dword ptr [EBP + 0xffffff64],0x8
00ac7e3d : JC 0x00ac7e4a
00ac7e3f : MOV ECX,dword ptr [EBP + 0xffffff50]
00ac7e45 : CALL 0x006f04e0
00ac7e4a : PUSH EBX
00ac7e4b : PUSH EBX
00ac7e4c : PUSH EBX
00ac7e4d : PUSH 0x1
00ac7e4f : XOR EAX,EAX
00ac7e51 : PUSH 0xbf26a3
00ac7e56 : MOV dword ptr [EBP + 0xffffff64],ESI
00ac7e5c : MOV dword ptr [EBP + 0xffffff60],EBX
00ac7e62 : MOV word ptr [EBP + 0xffffff50],AX
00ac7e69 : CALL dword ptr [0x00b85554]
00ac7e6f : MOV dword ptr [EDI + 0x7c],EAX
00ac7e72 : CMP EAX,EBX
00ac7e74 : JNZ 0x00ac7ede
00ac7e76 : CALL 0x00ac5bc0
00ac7e7b : MOV byte ptr [EBP + -0x4],0x3
00ac7e7f : MOV EDI,0x8
00ac7e84 : CMP dword ptr [EBP + -0x4c],EDI
00ac7e87 : JC 0x00ac7e91
00ac7e89 : MOV ECX,dword ptr [EBP + -0x60]
00ac7e8c : CALL 0x006f04e0
00ac7e91 : XOR ECX,ECX
00ac7e93 : MOV dword ptr [EBP + -0x4c],ESI
00ac7e96 : MOV dword ptr [EBP + -0x50],EBX
00ac7e99 : MOV word ptr [EBP + -0x60],CX
00ac7e9d : MOV byte ptr [EBP + -0x4],BL
00ac7ea0 : CMP dword ptr [EBP + -0x30],EDI
00ac7ea3 : JC 0x00ac7ead
00ac7ea5 : MOV ECX,dword ptr [EBP + -0x44]
00ac7ea8 : CALL 0x006f04e0
00ac7ead : XOR EDX,EDX
00ac7eaf : MOV dword ptr [EBP + -0x30],ESI
00ac7eb2 : MOV dword ptr [EBP + -0x34],EBX
00ac7eb5 : MOV word ptr [EBP + -0x44],DX
00ac7eb9 : MOV dword ptr [EBP + -0x4],0xffffffff
00ac7ec0 : CMP dword ptr [EBP + -0x14],EDI
00ac7ec3 : JC 0x00ac7ecd
00ac7ec5 : MOV ECX,dword ptr [EBP + -0x28]
00ac7ec8 : CALL 0x006f04e0
00ac7ecd : XOR EAX,EAX
00ac7ecf : MOV dword ptr [EBP + -0x14],ESI
00ac7ed2 : MOV dword ptr [EBP + -0x18],EBX
00ac7ed5 : MOV word ptr [EBP + -0x28],AX
00ac7ed9 : JMP 0x00ac7fe7
00ac7ede : CMP dword ptr [EBP + -0x30],0x8
00ac7ee2 : MOV ECX,dword ptr [EBP + -0x44]
00ac7ee5 : JNC 0x00ac7eea
00ac7ee7 : LEA ECX,[EBP + -0x44]
00ac7eea : PUSH EBX
00ac7eeb : PUSH 0x84000000
00ac7ef0 : PUSH EBX
00ac7ef1 : PUSH EBX
00ac7ef2 : PUSH ECX
00ac7ef3 : PUSH EAX
00ac7ef4 : CALL dword ptr [0x00b85550]
00ac7efa : MOV EDI,EAX
00ac7efc : CMP EDI,EBX
00ac7efe : JZ 0x00ac7fbc
00ac7f04 : CMP dword ptr [EBP + -0x4c],0x8
00ac7f08 : MOV EAX,dword ptr [EBP + -0x60]
00ac7f0b : JNC 0x00ac7f10
00ac7f0d : LEA EAX,[EBP + -0x60]
00ac7f10 : PUSH EBX
00ac7f11 : PUSH 0x80
00ac7f16 : PUSH 0x2
00ac7f18 : PUSH EBX
00ac7f19 : PUSH EBX
00ac7f1a : PUSH 0x40000000
00ac7f1f : PUSH EAX
00ac7f20 : CALL dword ptr [0x00b85164]
00ac7f26 : MOV dword ptr [EBP + -0x6c],EAX
00ac7f29 : CMP EAX,-0x1
00ac7f2c : JNZ 0x00ac7f3d
00ac7f2e : MOV ECX,dword ptr [EBP + -0x70]
00ac7f31 : MOV EDX,dword ptr [ECX + 0x78]
00ac7f34 : PUSH EDX
00ac7f35 : CALL dword ptr [0x00b8558c]
00ac7f3b : JMP 0x00ac7fbc
00ac7f3d : XOR ESI,ESI
00ac7f3f : NOP
00ac7f40 : PUSH EBX
00ac7f41 : PUSH EBX
00ac7f42 : LEA EAX,[EBP + -0x74]
00ac7f45 : PUSH EAX
00ac7f46 : PUSH EDI
00ac7f47 : CALL dword ptr [0x00b8554c]
00ac7f4d : MOV EAX,dword ptr [EBP + -0x74]
00ac7f50 : CMP EAX,EBX
00ac7f52 : JZ 0x00ac7f6d
00ac7f54 : PUSH EBX
00ac7f55 : PUSH 0x175
00ac7f5a : PUSH 0xc94cfc
00ac7f5f : PUSH EAX
00ac7f60 : CALL 0x006f0760
00ac7f65 : MOV ESI,EAX
00ac7f67 : MOV EAX,dword ptr [EBP + -0x74]
00ac7f6a : ADD ESP,0x10
00ac7f6d : LEA ECX,[EBP + -0x78]
00ac7f70 : PUSH ECX
00ac7f71 : PUSH EAX
00ac7f72 : PUSH ESI
00ac7f73 : PUSH EDI
00ac7f74 : CALL dword ptr [0x00b85590]
00ac7f7a : MOV EAX,dword ptr [EBP + -0x78]
00ac7f7d : MOV ECX,dword ptr [EBP + -0x6c]
00ac7f80 : PUSH EBX
00ac7f81 : LEA EDX,[EBP + 0xffffff68]
00ac7f87 : PUSH EDX
00ac7f88 : PUSH EAX
00ac7f89 : PUSH ESI
00ac7f8a : PUSH ECX
00ac7f8b : CALL dword ptr [0x00b851c0]
00ac7f91 : CMP ESI,EBX
00ac7f93 : JZ 0x00ac7f9e
00ac7f95 : MOV ECX,ESI
00ac7f97 : CALL 0x006f04e0
00ac7f9e : CMP dword ptr [EBP + -0x78],EBX
00ac7fa1 : JNZ 0x00ac7f40
00ac7fa3 : MOV EDX,dword ptr [EBP + -0x6c]
00ac7fa6 : PUSH EDX
00ac7fa7 : CALL dword ptr [0x00b85104]
00ac7fad : PUSH EDI
00ac7fae : CALL dword ptr [0x00b8558c]
00ac7fb4 : MOV ECX,dword ptr [EBP + -0x70]
00ac7fb7 : CALL 0x00ac5e40
00ac7fbc : CALL 0x00ac5bc0
00ac7fc1 : MOV byte ptr [EBP + -0x4],0x3
00ac7fc5 : LEA ECX,[EBP + -0x64]
00ac7fc8 : CALL 0x00406560
00ac7fcd : MOV byte ptr [EBP + -0x4],BL
00ac7fd0 : LEA ECX,[EBP + -0x48]
00ac7fd3 : CALL 0x00406560
00ac7fd8 : MOV dword ptr [EBP + -0x4],0xffffffff
00ac7fdf : LEA ECX,[EBP + -0x2c]
00ac7fe2 : CALL 0x00406560
00ac7fe7 : MOV ECX,dword ptr [EBP + -0xc]
00ac7fea : MOV dword ptr FS:[0x0],ECX
00ac7ff1 : POP ECX
00ac7ff2 : POP EDI
00ac7ff3 : POP ESI
00ac7ff4 : POP EBX
00ac7ff5 : MOV ECX,dword ptr [EBP + -0x10]
00ac7ff8 : XOR ECX,EBP
00ac7ffa : CALL 0x00633e6b
00ac7fff : MOV ESP,EBP
00ac8001 : POP EBP
00ac8002 : RET 0x4

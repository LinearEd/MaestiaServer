PROGRAM  : Maestia.exe
FUNCTION : FUN_00a6f150
ENTRY    : 00a6f150
BODY     : [[00a6f150, 00a6f2ac] [00a6f2b0, 00a6f5bc]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */
/* WARNING: Type propagation algorithm not settling */

void FUN_00a6f150(int param_1)

{
  short sVar1;
  undefined1 uVar2;
  short *psVar3;
  undefined4 *puVar4;
  int iVar5;
  wchar_t *******pppppppwVar6;
  undefined4 in_ECX;
  int iVar7;
  int in_EDX;
  undefined4 uVar8;
  undefined1 local_20d0 [4];
  undefined2 local_20cc;
  undefined4 local_20bc;
  uint local_20b8;
  int local_20b4;
  undefined1 local_20b0 [4];
  undefined4 local_20ac;
  undefined4 local_209c;
  uint local_2098;
  char local_2091;
  uint local_2070;
  uint local_206c;
  undefined1 local_2034 [4];
  wchar_t *******local_2030 [4];
  int local_2020;
  uint local_201c;
  short local_2018;
  undefined1 local_2016 [8190];
  uint local_18;
  undefined4 uStack_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b44381;
  local_10 = ExceptionList;
  uStack_14 = 0xa6f16b;
  local_18 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  FUN_0070d390(local_18);
  local_8._0_1_ = 0;
  local_8._1_3_ = 0;
  if (in_EDX == 0) {
    FUN_00406460(&PTR_LAB_00c43fcc);
    local_8._0_1_ = 1;
    FUN_0070d850(in_ECX,local_20b0,0,0);
    local_8._0_1_ = 0;
    if (7 < local_2098) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_2098 = 7;
    local_209c = 0;
    local_20ac = (undefined4 *)((uint)local_20ac._2_2_ << 0x10);
  }
  else {
    FUN_00802fa0();
  }
  if (local_2070 == 0) {
    FUN_0070d4c0();
  }
  else {
    psVar3 = &local_2018;
    for (iVar7 = 0x800; iVar7 != 0; iVar7 = iVar7 + -1) {
      psVar3[0] = 0;
      psVar3[1] = 0;
      psVar3 = psVar3 + 2;
    }
    local_201c = 7;
    local_2020 = 0;
    local_2030[0] = (wchar_t *******)((uint)local_2030[0] & 0xffff0000);
    local_8._0_1_ = 2;
    local_20b4 = param_1 + 0xc;
    local_2091 = '\0';
    FUN_00405eb0(in_ECX,0,0xffffffff);
    *(undefined4 *)(param_1 + 0x28) = 0;
    *(undefined4 *)(param_1 + 0x2c) = 0;
    *(undefined4 *)(param_1 + 0x34) = 0;
    *(undefined4 *)(param_1 + 0x30) = 0;
    FUN_00406360(&DAT_00c43fd4,0);
    *(undefined4 *)(param_1 + 0x54) = 0;
    if (local_206c < local_2070) {
      do {
        psVar3 = &local_2018;
        for (iVar7 = 0x800; iVar7 != 0; iVar7 = iVar7 + -1) {
          psVar3[0] = 0;
          psVar3[1] = 0;
          psVar3 = psVar3 + 2;
        }
        FUN_0070d000(&local_2018);
        psVar3 = &local_2018;
        do {
          sVar1 = *psVar3;
          psVar3 = psVar3 + 1;
        } while (sVar1 != 0);
        FUN_00406360(&local_2018,(int)psVar3 - (int)local_2016 >> 1);
        local_2098 = 7;
        local_209c = 0;
        local_20ac = (undefined4 *)((uint)local_20ac & 0xffff0000);
        FUN_00406360(L" \t\n\r",4);
        local_8._0_1_ = 3;
        puVar4 = local_20ac;
        if (local_2098 < 8) {
          puVar4 = &local_20ac;
        }
        uVar8 = 0xffffffff;
        iVar7 = FUN_00412be0(puVar4,local_209c);
        FUN_00405e10(iVar7 + 1,uVar8);
        puVar4 = local_20ac;
        if (local_2098 < 8) {
          puVar4 = &local_20ac;
        }
        uVar8 = FUN_00412db0(puVar4,local_209c);
        FUN_00405e10(0,uVar8);
        local_8._0_1_ = 2;
        uVar2 = (undefined1)local_8;
        local_8._0_1_ = 2;
        if (7 < local_2098) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        *(int *)(param_1 + 0x28) = *(int *)(param_1 + 0x28) + 1;
        local_2098 = 7;
        local_209c = 0;
        local_20ac = (undefined4 *)((uint)local_20ac & 0xffff0000);
        if (local_2020 != 0) {
          pppppppwVar6 = local_2030[0];
          if (local_201c < 8) {
            pppppppwVar6 = (wchar_t *******)local_2030;
          }
          iVar5 = _wcsncmp((wchar_t *)pppppppwVar6,L"//",2);
          iVar7 = local_2020;
          uVar2 = (undefined1)local_8;
          if (iVar5 != 0) {
            if (local_2091 == '\0') {
              local_2091 = FUN_00a6efa0(local_2034);
              uVar2 = (undefined1)local_8;
            }
            else {
              pppppppwVar6 = local_2030[0];
              if (local_201c < 8) {
                pppppppwVar6 = (wchar_t *******)local_2030;
              }
              iVar5 = FUN_00405b70(pppppppwVar6);
              if (((iVar5 != 0) || (iVar7 == 0)) || (iVar7 != 1)) {
                FUN_00406460(L"Wrong open brace");
                local_8._0_1_ = 4;
                FUN_00a6e600(local_20d0);
                local_8._0_1_ = 2;
                if (7 < local_20b8) {
                    /* WARNING: Subroutine does not return */
                  FUN_006f04e0();
                }
                local_20b8 = 7;
                local_20bc = 0;
                local_20cc = 0;
              }
              local_2091 = '\0';
              uVar2 = (undefined1)local_8;
            }
          }
        }
        local_8._0_1_ = uVar2;
      } while (local_206c < local_2070);
    }
    FUN_0070d4c0();
    if (*(int *)(param_1 + 0x2c) != 0) {
      FUN_00406460(L"Unexpected end of file.");
      local_8._0_1_ = 5;
      FUN_00a6e600(local_20d0);
      local_8._0_1_ = 2;
      if (7 < local_20b8) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_20b8 = 7;
      local_20bc = 0;
      local_20cc = 0;
    }
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_201c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_201c = 7;
    local_2020 = 0;
    local_2030[0] = (wchar_t *******)((uint)local_2030[0] & 0xffff0000);
  }
  local_8 = 0xffffffff;
  FUN_0070d710();
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a6f150 : PUSH EBP
00a6f151 : MOV EBP,ESP
00a6f153 : PUSH -0x1
00a6f155 : PUSH 0xb44381
00a6f15a : MOV EAX,FS:[0x0]
00a6f160 : PUSH EAX
00a6f161 : MOV EAX,0x20c0
00a6f166 : CALL 0x0063b780
00a6f16b : MOV EAX,[0x00d66fa0]
00a6f170 : XOR EAX,EBP
00a6f172 : MOV dword ptr [EBP + -0x14],EAX
00a6f175 : PUSH EBX
00a6f176 : PUSH ESI
00a6f177 : PUSH EDI
00a6f178 : PUSH EAX
00a6f179 : LEA EAX,[EBP + -0xc]
00a6f17c : MOV FS:[0x0],EAX
00a6f182 : MOV EBX,dword ptr [EBP + 0x8]
00a6f185 : MOV ESI,ECX
00a6f187 : LEA ECX,[EBP + 0xffffdf74]
00a6f18d : MOV EDI,EDX
00a6f18f : CALL 0x0070d390
00a6f194 : MOV dword ptr [EBP + -0x4],0x0
00a6f19b : TEST EDI,EDI
00a6f19d : JZ 0x00a6f1b3
00a6f19f : LEA EAX,[EBP + 0xffffdf74]
00a6f1a5 : PUSH EAX
00a6f1a6 : PUSH EDI
00a6f1a7 : MOV EDX,ESI
00a6f1a9 : CALL 0x00802fa0
00a6f1ae : ADD ESP,0x8
00a6f1b1 : JMP 0x00a6f213
00a6f1b3 : PUSH 0xc43fcc
00a6f1b8 : LEA ECX,[EBP + 0xffffdf54]
00a6f1be : CALL 0x00406460
00a6f1c3 : MOV byte ptr [EBP + -0x4],0x1
00a6f1c7 : PUSH 0x0
00a6f1c9 : PUSH 0x0
00a6f1cb : LEA ECX,[EBP + 0xffffdf54]
00a6f1d1 : PUSH ECX
00a6f1d2 : PUSH ESI
00a6f1d3 : LEA EAX,[EBP + 0xffffdf74]
00a6f1d9 : CALL 0x0070d850
00a6f1de : MOV byte ptr [EBP + -0x4],0x0
00a6f1e2 : CMP dword ptr [EBP + 0xffffdf6c],0x8
00a6f1e9 : JC 0x00a6f1f6
00a6f1eb : MOV ECX,dword ptr [EBP + 0xffffdf58]
00a6f1f1 : CALL 0x006f04e0
00a6f1f6 : XOR EDX,EDX
00a6f1f8 : MOV dword ptr [EBP + 0xffffdf6c],0x7
00a6f202 : MOV dword ptr [EBP + 0xffffdf68],0x0
00a6f20c : MOV word ptr [EBP + 0xffffdf58],DX
00a6f213 : CMP dword ptr [EBP + 0xffffdf94],0x0
00a6f21a : JNZ 0x00a6f22c
00a6f21c : LEA ECX,[EBP + 0xffffdf74]
00a6f222 : CALL 0x0070d4c0
00a6f227 : JMP 0x00a6f58d
00a6f22c : XOR EAX,EAX
00a6f22e : MOVZX EDX,AX
00a6f231 : MOV EAX,EDX
00a6f233 : SHL EDX,0x10
00a6f236 : OR EAX,EDX
00a6f238 : MOV ECX,0x800
00a6f23d : LEA EDI,[EBP + 0xffffdfec]
00a6f243 : STOSD.REP ES:EDI
00a6f245 : XOR EDI,EDI
00a6f247 : XOR EAX,EAX
00a6f249 : MOV dword ptr [EBP + 0xffffdfe8],0x7
00a6f253 : MOV dword ptr [EBP + 0xffffdfe4],EDI
00a6f259 : MOV word ptr [EBP + 0xffffdfd4],AX
00a6f260 : MOV byte ptr [EBP + -0x4],0x2
00a6f264 : PUSH -0x1
00a6f266 : PUSH EDI
00a6f267 : LEA ECX,[EBX + 0xc]
00a6f26a : PUSH ESI
00a6f26b : MOV byte ptr [EBP + 0xffffdf73],AL
00a6f271 : MOV dword ptr [EBP + 0xffffdf50],ECX
00a6f277 : CALL 0x00405eb0
00a6f27c : PUSH EDI
00a6f27d : PUSH 0xc43fd4
00a6f282 : LEA ECX,[EBX + 0x38]
00a6f285 : MOV dword ptr [EBX + 0x28],EDI
00a6f288 : MOV dword ptr [EBX + 0x2c],EDI
00a6f28b : MOV dword ptr [EBX + 0x34],EDI
00a6f28e : MOV dword ptr [EBX + 0x30],EDI
00a6f291 : CALL 0x00406360
00a6f296 : MOV ECX,dword ptr [EBP + 0xffffdf98]
00a6f29c : MOV dword ptr [EBX + 0x54],EDI
00a6f29f : CMP ECX,dword ptr [EBP + 0xffffdf94]
00a6f2a5 : JNC 0x00a6f4f2
00a6f2ab : JMP 0x00a6f2b0
00a6f2b0 : XOR EAX,EAX
00a6f2b2 : MOVZX EDX,AX
00a6f2b5 : MOV EAX,EDX
00a6f2b7 : SHL EDX,0x10
00a6f2ba : OR EAX,EDX
00a6f2bc : MOV ECX,0x800
00a6f2c1 : LEA EDI,[EBP + 0xffffdfec]
00a6f2c7 : STOSD.REP ES:EDI
00a6f2c9 : LEA EAX,[EBP + 0xffffdfec]
00a6f2cf : PUSH EAX
00a6f2d0 : LEA EDI,[EBP + 0xffffdf74]
00a6f2d6 : CALL 0x0070d000
00a6f2db : LEA EAX,[EBP + 0xffffdfec]
00a6f2e1 : LEA EDX,[EAX + 0x2]
00a6f2e4 : MOV CX,word ptr [EAX]
00a6f2e7 : ADD EAX,0x2
00a6f2ea : TEST CX,CX
00a6f2ed : JNZ 0x00a6f2e4
00a6f2ef : SUB EAX,EDX
00a6f2f1 : SAR EAX,0x1
00a6f2f3 : PUSH EAX
00a6f2f4 : LEA ECX,[EBP + 0xffffdfec]
00a6f2fa : PUSH ECX
00a6f2fb : LEA ECX,[EBP + 0xffffdfd0]
00a6f301 : CALL 0x00406360
00a6f306 : PUSH 0x4
00a6f308 : XOR EDX,EDX
00a6f30a : XOR ESI,ESI
00a6f30c : PUSH 0xc43fd8
00a6f311 : LEA ECX,[EBP + 0xffffdf54]
00a6f317 : MOV dword ptr [EBP + 0xffffdf6c],0x7
00a6f321 : MOV dword ptr [EBP + 0xffffdf68],ESI
00a6f327 : MOV word ptr [EBP + 0xffffdf58],DX
00a6f32e : CALL 0x00406360
00a6f333 : MOV byte ptr [EBP + -0x4],0x3
00a6f337 : CMP dword ptr [EBP + 0xffffdf6c],0x8
00a6f33e : MOV EAX,dword ptr [EBP + 0xffffdf58]
00a6f344 : JNC 0x00a6f34c
00a6f346 : LEA EAX,[EBP + 0xffffdf58]
00a6f34c : MOV ECX,dword ptr [EBP + 0xffffdf68]
00a6f352 : PUSH -0x1
00a6f354 : PUSH ECX
00a6f355 : PUSH EAX
00a6f356 : LEA EDI,[EBP + 0xffffdfd0]
00a6f35c : CALL 0x00412be0
00a6f361 : INC EAX
00a6f362 : PUSH EAX
00a6f363 : MOV ECX,EDI
00a6f365 : CALL 0x00405e10
00a6f36a : MOV EAX,dword ptr [EBP + 0xffffdf58]
00a6f370 : MOV EDI,0x8
00a6f375 : CMP dword ptr [EBP + 0xffffdf6c],EDI
00a6f37b : JNC 0x00a6f383
00a6f37d : LEA EAX,[EBP + 0xffffdf58]
00a6f383 : MOV EDX,dword ptr [EBP + 0xffffdf68]
00a6f389 : PUSH EDX
00a6f38a : PUSH EAX
00a6f38b : XOR EDX,EDX
00a6f38d : LEA EAX,[EBP + 0xffffdfd0]
00a6f393 : CALL 0x00412db0
00a6f398 : PUSH EAX
00a6f399 : PUSH ESI
00a6f39a : LEA ECX,[EBP + 0xffffdfd0]
00a6f3a0 : CALL 0x00405e10
00a6f3a5 : MOV byte ptr [EBP + -0x4],0x2
00a6f3a9 : CMP dword ptr [EBP + 0xffffdf6c],EDI
00a6f3af : JC 0x00a6f3bc
00a6f3b1 : MOV ECX,dword ptr [EBP + 0xffffdf58]
00a6f3b7 : CALL 0x006f04e0
00a6f3bc : INC dword ptr [EBX + 0x28]
00a6f3bf : XOR EAX,EAX
00a6f3c1 : MOV dword ptr [EBP + 0xffffdf6c],0x7
00a6f3cb : MOV dword ptr [EBP + 0xffffdf68],ESI
00a6f3d1 : MOV word ptr [EBP + 0xffffdf58],AX
00a6f3d8 : CMP dword ptr [EBP + 0xffffdfe4],ESI
00a6f3de : JZ 0x00a6f4de
00a6f3e4 : MOV EAX,dword ptr [EBP + 0xffffdfd4]
00a6f3ea : CMP dword ptr [EBP + 0xffffdfe8],EDI
00a6f3f0 : JNC 0x00a6f3f8
00a6f3f2 : LEA EAX,[EBP + 0xffffdfd4]
00a6f3f8 : PUSH 0x2
00a6f3fa : PUSH 0xc43fe4
00a6f3ff : PUSH EAX
00a6f400 : CALL 0x006380ac
00a6f405 : ADD ESP,0xc
00a6f408 : TEST EAX,EAX
00a6f40a : JZ 0x00a6f4de
00a6f410 : CMP byte ptr [EBP + 0xffffdf73],0x0
00a6f417 : JZ 0x00a6f4ca
00a6f41d : MOV EDI,dword ptr [EBP + 0xffffdfe4]
00a6f423 : MOV EDX,EDI
00a6f425 : CMP EDI,0x1
00a6f428 : JC 0x00a6f42f
00a6f42a : MOV EDX,0x1
00a6f42f : CMP dword ptr [EBP + 0xffffdfe8],0x8
00a6f436 : MOV EAX,dword ptr [EBP + 0xffffdfd4]
00a6f43c : JNC 0x00a6f444
00a6f43e : LEA EAX,[EBP + 0xffffdfd4]
00a6f444 : PUSH EAX
00a6f445 : MOV ECX,0xc43fec
00a6f44a : CALL 0x00405b70
00a6f44f : ADD ESP,0x4
00a6f452 : CMP EAX,ESI
00a6f454 : JNZ 0x00a6f467
00a6f456 : CMP EDI,0x1
00a6f459 : JC 0x00a6f467
00a6f45b : XOR EAX,EAX
00a6f45d : CMP EDI,0x1
00a6f460 : SETNZ AL
00a6f463 : CMP EAX,ESI
00a6f465 : JZ 0x00a6f4c1
00a6f467 : PUSH 0xc43ff0
00a6f46c : LEA ECX,[EBP + 0xffffdf34]
00a6f472 : CALL 0x00406460
00a6f477 : MOV byte ptr [EBP + -0x4],0x4
00a6f47b : LEA ECX,[EBP + 0xffffdf34]
00a6f481 : PUSH ECX
00a6f482 : MOV ECX,dword ptr [EBP + 0xffffdf50]
00a6f488 : CALL 0x00a6e600
00a6f48d : ADD ESP,0x4
00a6f490 : MOV byte ptr [EBP + -0x4],0x2
00a6f494 : CMP dword ptr [EBP + 0xffffdf4c],0x8
00a6f49b : JC 0x00a6f4a8
00a6f49d : MOV ECX,dword ptr [EBP + 0xffffdf38]
00a6f4a3 : CALL 0x006f04e0
00a6f4a8 : XOR EDX,EDX
00a6f4aa : MOV dword ptr [EBP + 0xffffdf4c],0x7
00a6f4b4 : MOV dword ptr [EBP + 0xffffdf48],ESI
00a6f4ba : MOV word ptr [EBP + 0xffffdf38],DX
00a6f4c1 : MOV byte ptr [EBP + 0xffffdf73],0x0
00a6f4c8 : JMP 0x00a6f4de
00a6f4ca : LEA EAX,[EBP + 0xffffdfd0]
00a6f4d0 : PUSH EAX
00a6f4d1 : MOV ECX,EBX
00a6f4d3 : CALL 0x00a6efa0
00a6f4d8 : MOV byte ptr [EBP + 0xffffdf73],AL
00a6f4de : MOV ECX,dword ptr [EBP + 0xffffdf98]
00a6f4e4 : CMP ECX,dword ptr [EBP + 0xffffdf94]
00a6f4ea : JC 0x00a6f2b0
00a6f4f0 : XOR EDI,EDI
00a6f4f2 : LEA ECX,[EBP + 0xffffdf74]
00a6f4f8 : CALL 0x0070d4c0
00a6f4fd : CMP dword ptr [EBX + 0x2c],EDI
00a6f500 : JZ 0x00a6f55c
00a6f502 : PUSH 0xc44014
00a6f507 : LEA ECX,[EBP + 0xffffdf34]
00a6f50d : CALL 0x00406460
00a6f512 : MOV byte ptr [EBP + -0x4],0x5
00a6f516 : MOV ECX,dword ptr [EBP + 0xffffdf50]
00a6f51c : LEA EDX,[EBP + 0xffffdf34]
00a6f522 : PUSH EDX
00a6f523 : CALL 0x00a6e600
00a6f528 : ADD ESP,0x4
00a6f52b : MOV byte ptr [EBP + -0x4],0x2
00a6f52f : CMP dword ptr [EBP + 0xffffdf4c],0x8
00a6f536 : JC 0x00a6f543
00a6f538 : MOV ECX,dword ptr [EBP + 0xffffdf38]
00a6f53e : CALL 0x006f04e0
00a6f543 : XOR EAX,EAX
00a6f545 : MOV dword ptr [EBP + 0xffffdf4c],0x7
00a6f54f : MOV dword ptr [EBP + 0xffffdf48],EDI
00a6f555 : MOV word ptr [EBP + 0xffffdf38],AX
00a6f55c : MOV byte ptr [EBP + -0x4],0x0
00a6f560 : CMP dword ptr [EBP + 0xffffdfe8],0x8
00a6f567 : JC 0x00a6f574
00a6f569 : MOV ECX,dword ptr [EBP + 0xffffdfd4]
00a6f56f : CALL 0x006f04e0
00a6f574 : XOR ECX,ECX
00a6f576 : MOV dword ptr [EBP + 0xffffdfe8],0x7
00a6f580 : MOV dword ptr [EBP + 0xffffdfe4],EDI
00a6f586 : MOV word ptr [EBP + 0xffffdfd4],CX
00a6f58d : MOV dword ptr [EBP + -0x4],0xffffffff
00a6f594 : LEA ECX,[EBP + 0xffffdf74]
00a6f59a : CALL 0x0070d710
00a6f59f : MOV ECX,dword ptr [EBP + -0xc]
00a6f5a2 : MOV dword ptr FS:[0x0],ECX
00a6f5a9 : POP ECX
00a6f5aa : POP EDI
00a6f5ab : POP ESI
00a6f5ac : POP EBX
00a6f5ad : MOV ECX,dword ptr [EBP + -0x14]
00a6f5b0 : XOR ECX,EBP
00a6f5b2 : CALL 0x00633e6b
00a6f5b7 : MOV ESP,EBP
00a6f5b9 : POP EBP
00a6f5ba : RET 0x4

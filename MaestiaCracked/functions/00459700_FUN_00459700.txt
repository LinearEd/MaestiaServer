PROGRAM  : Maestia.exe
FUNCTION : FUN_00459700
ENTRY    : 00459700
BODY     : [[00459700, 00459746]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_00459700(int param_1,undefined4 *param_2,void *param_3,void *param_4)

{
  rsize_t _DstSize;
  int iVar1;
  
  *param_2 = param_3;
  if (param_3 != param_4) {
    iVar1 = *(int *)(param_1 + 8) - (int)param_4 >> 2;
    _DstSize = iVar1 * 4;
    if (0 < iVar1) {
      _memmove_s(param_3,_DstSize,param_4,_DstSize);
    }
    *(void **)(param_1 + 8) = (void *)(_DstSize + (int)param_3);
  }
  return param_2;
}



============================================================
DISASSEMBLY
============================================================
00459700 : PUSH EBP
00459701 : MOV EBP,ESP
00459703 : MOV EDX,dword ptr [EBP + 0x10]
00459706 : MOV EAX,dword ptr [EBP + 0xc]
00459709 : PUSH EBX
0045970a : MOV EBX,dword ptr [EBP + 0x8]
0045970d : PUSH ESI
0045970e : MOV ESI,dword ptr [EBP + 0x14]
00459711 : MOV dword ptr [EAX],EDX
00459713 : CMP EDX,ESI
00459715 : JZ 0x00459741
00459717 : MOV EAX,dword ptr [EBX + 0x8]
0045971a : SUB EAX,ESI
0045971c : SAR EAX,0x2
0045971f : LEA ECX,[EAX*0x4 + 0x0]
00459726 : PUSH EDI
00459727 : LEA EDI,[ECX + EDX*0x1]
0045972a : TEST EAX,EAX
0045972c : JLE 0x0045973a
0045972e : PUSH ECX
0045972f : PUSH ESI
00459730 : PUSH ECX
00459731 : PUSH EDX
00459732 : CALL 0x00634101
00459737 : ADD ESP,0x10
0045973a : MOV EAX,dword ptr [EBP + 0xc]
0045973d : MOV dword ptr [EBX + 0x8],EDI
00459740 : POP EDI
00459741 : POP ESI
00459742 : POP EBX
00459743 : POP EBP
00459744 : RET 0x10

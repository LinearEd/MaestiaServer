PROGRAM  : Maestia.exe
FUNCTION : FUN_00677870
ENTRY    : 00677870
BODY     : [[00677870, 006779a7] [006779b0, 00677d22]]

============================================================
DECOMPILED C CODE
============================================================

undefined1 FUN_00677870(int *param_1,int param_2,int param_3)

{
  int *piVar1;
  int *piVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  short sVar6;
  int iVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  int iVar12;
  int iVar13;
  short sVar14;
  short sVar15;
  uint *puVar16;
  bool bVar17;
  int iVar18;
  int local_5c;
  undefined4 local_1c;
  int local_10;
  short sVar7;
  
  bVar17 = *(char *)(param_3 + 0x25) == '\0';
  piVar2 = (int *)((int)param_1 + param_2);
  FUN_00558a00();
  param_2._0_1_ = 0;
  while (param_1 < piVar2) {
    iVar3 = *param_1;
    piVar1 = param_1 + 4;
    FUN_00553650();
    uVar9 = param_1[3];
    sVar14 = (short)(uVar9 >> 0x10);
    if (bVar17) {
      iVar8 = (int)((sVar14 * -0x100 - ((uVar9 & 0xffff) >> 8)) * 4) / 0xf0;
      iVar18 = (int)(((short)((uint)param_1[2] >> 0x10) * 0x100 + ((param_1[2] & 0xffffU) >> 8)) * 4
                    ) / 0xf0;
    }
    else {
      iVar18 = (uVar9 & 0xffff) * -0x14;
      iVar8 = ((int)(iVar18 + (iVar18 >> 0x1f & 0xffffU)) >> 0x10) + sVar14 * -0x14;
      iVar18 = ((int)((param_1[2] & 0xffffU) * 0x14) >> 0x10) +
               (short)((uint)param_1[2] >> 0x10) * 0x14;
    }
    FUN_00555690(iVar18,iVar8,0);
    for (; piVar1 < (int *)(iVar3 + (int)param_1);
        piVar1 = piVar1 + (uint)*(ushort *)((int)piVar1 + 2) * 2 + 1) {
      if (((short)*piVar1 == 1) && (local_5c = 0, *(short *)((int)piVar1 + 2) != 0)) {
        puVar16 = (uint *)(piVar1 + 1);
        do {
          uVar9 = puVar16[1];
          sVar14 = (short)(uVar9 >> 0x10);
          if (bVar17) {
            iVar8 = (int)((sVar14 * -0x100 - ((uVar9 & 0xffff) >> 8)) * 4) / 0xf0;
            iVar18 = (int)(((short)(*puVar16 >> 0x10) * 0x100 + ((*puVar16 & 0xffff) >> 8)) * 4) /
                     0xf0;
          }
          else {
            iVar18 = (uVar9 & 0xffff) * -0x14;
            iVar8 = ((int)(iVar18 + (iVar18 >> 0x1f & 0xffffU)) >> 0x10) + sVar14 * -0x14;
            iVar18 = ((int)((*puVar16 & 0xffff) * 0x14) >> 0x10) + (short)(*puVar16 >> 0x10) * 0x14;
          }
          FUN_00559cb0(iVar18,iVar8);
          local_5c = local_5c + 1;
          puVar16 = puVar16 + 2;
        } while (local_5c < (int)(uint)*(ushort *)((int)piVar1 + 2));
      }
      if ((short)*piVar1 == 2) {
        uVar9 = (uint)*(ushort *)((int)piVar1 + 2);
        local_5c = 0;
        if (uVar9 != 1 && -1 < (int)(uVar9 - 1)) {
          puVar16 = (uint *)(piVar1 + 3);
          do {
            uVar4 = puVar16[-2];
            uVar5 = puVar16[-1];
            uVar10 = *puVar16;
            uVar11 = puVar16[1];
            if (local_5c < (int)(uVar9 - 2)) {
              uVar10 = (int)(uVar10 + uVar4) / 2;
              uVar11 = (int)(uVar11 + uVar5) / 2;
            }
            sVar14 = (short)(uVar11 >> 0x10);
            sVar6 = (short)(uVar10 >> 0x10);
            sVar7 = (short)(uVar5 >> 0x10);
            sVar15 = (short)(uVar4 >> 0x10);
            if (bVar17) {
              iVar12 = (int)((sVar14 * -0x100 - ((uVar11 & 0xffff) >> 8)) * 4) / 0xf0;
              iVar18 = (int)((((uVar10 & 0xffff) >> 8) + sVar6 * 0x100) * 4) / 0xf0;
              iVar13 = (int)((sVar7 * -0x100 - ((uVar5 & 0xffff) >> 8)) * 4) / 0xf0;
              iVar8 = (int)((((uVar4 & 0xffff) >> 8) + sVar15 * 0x100) * 4) / 0xf0;
            }
            else {
              iVar18 = (uVar11 & 0xffff) * -0x14;
              iVar12 = ((int)(iVar18 + (iVar18 >> 0x1f & 0xffffU)) >> 0x10) + sVar14 * -0x14;
              iVar18 = ((int)((uVar10 & 0xffff) * 0x14) >> 0x10) + sVar6 * 0x14;
              iVar8 = (uVar5 & 0xffff) * -0x14;
              iVar13 = ((int)(iVar8 + (iVar8 >> 0x1f & 0xffffU)) >> 0x10) + sVar7 * -0x14;
              iVar8 = ((int)((uVar4 & 0xffff) * 0x14) >> 0x10) + sVar15 * 0x14;
            }
            FUN_00559cd0(iVar8,iVar13,iVar18,iVar12);
            uVar9 = (uint)*(ushort *)((int)piVar1 + 2);
            local_5c = local_5c + 1;
            puVar16 = puVar16 + 2;
          } while (local_5c < (int)(uVar9 - 1));
        }
      }
    }
    param_1 = (int *)((int)param_1 + *param_1);
    if (local_10 != 0) {
      FUN_00559d00();
      if (local_10 != 0) {
        FUN_005551b0(param_3 + 0x28,param_3 + 0x34);
      }
      param_2._0_1_ = 1;
    }
  }
  FUN_00515cf0(local_1c);
  return (undefined1)param_2;
}



============================================================
DISASSEMBLY
============================================================
00677870 : SUB ESP,0x60
00677873 : MOV ECX,dword ptr [ESP + 0x6c]
00677877 : MOV EAX,dword ptr [ESP + 0x68]
0067787b : CMP byte ptr [ECX + 0x25],0x0
0067787f : PUSH EBX
00677880 : PUSH ESI
00677881 : MOV ESI,dword ptr [ESP + 0x6c]
00677885 : PUSH EDI
00677886 : LEA EDI,[ESI + EAX*0x1]
00677889 : MOV EBX,ESI
0067788b : LEA ECX,[ESP + 0x34]
0067788f : MOV dword ptr [ESP + 0x18],EBX
00677893 : MOV dword ptr [ESP + 0x20],EDI
00677897 : SETNZ byte ptr [ESP + 0x70]
0067789c : CALL 0x00558a00
006778a1 : MOV byte ptr [ESP + 0x74],0x0
006778a6 : CMP ESI,EDI
006778a8 : JNC 0x00677d0c
006778ae : PUSH EBP
006778af : NOP
006778b0 : MOV EDI,dword ptr [EBX]
006778b2 : ADD EDI,EBX
006778b4 : LEA EBP,[EBX + 0x10]
006778b7 : LEA ECX,[ESP + 0x38]
006778bb : MOV dword ptr [ESP + 0x18],EDI
006778bf : MOV dword ptr [ESP + 0x10],EBP
006778c3 : CALL 0x00553650
006778c8 : MOV dword ptr [ESP + 0x38],0x1
006778d0 : MOV dword ptr [ESP + 0x3c],0x0
006778d8 : MOV EAX,dword ptr [EBX + 0xc]
006778db : MOV EDX,EAX
006778dd : SHR EDX,0x10
006778e0 : CMP byte ptr [ESP + 0x74],0x0
006778e5 : PUSH 0x0
006778e7 : JZ 0x0067793d
006778e9 : MOVSX EDX,DX
006778ec : LEA EDX,[EDX + EDX*0x4]
006778ef : ADD EDX,EDX
006778f1 : ADD EDX,EDX
006778f3 : MOV ESI,EDX
006778f5 : MOVZX EDX,AX
006778f8 : MOV ECX,dword ptr [EBX + 0x8]
006778fb : MOV EAX,EDX
006778fd : NEG EAX
006778ff : ADD EAX,EAX
00677901 : ADD EAX,EAX
00677903 : SUB EAX,EDX
00677905 : ADD EAX,EAX
00677907 : ADD EAX,EAX
00677909 : CDQ
0067790a : AND EDX,0xffff
00677910 : ADD EAX,EDX
00677912 : SAR EAX,0x10
00677915 : SUB EAX,ESI
00677917 : PUSH EAX
00677918 : MOV EAX,ECX
0067791a : SHR EAX,0x10
0067791d : CWDE
0067791e : LEA ESI,[EAX + EAX*0x4]
00677921 : MOVZX EAX,CX
00677924 : LEA EAX,[EAX + EAX*0x4]
00677927 : ADD EAX,EAX
00677929 : ADD EAX,EAX
0067792b : CDQ
0067792c : AND EDX,0xffff
00677932 : ADD EAX,EDX
00677934 : SAR EAX,0x10
00677937 : LEA ECX,[EAX + ESI*0x4]
0067793a : PUSH ECX
0067793b : JMP 0x00677995
0067793d : MOVSX ECX,DX
00677940 : SHL ECX,0x8
00677943 : MOV EDX,ECX
00677945 : MOVZX ECX,AX
00677948 : SHR ECX,0x8
0067794b : MOV ESI,dword ptr [EBX + 0x8]
0067794e : NEG ECX
00677950 : SUB ECX,EDX
00677952 : ADD ECX,ECX
00677954 : ADD ECX,ECX
00677956 : MOV EAX,0x88888889
0067795b : IMUL ECX
0067795d : ADD EDX,ECX
0067795f : SAR EDX,0x7
00677962 : MOV EAX,EDX
00677964 : SHR EAX,0x1f
00677967 : ADD EAX,EDX
00677969 : MOV ECX,ESI
0067796b : SHR ECX,0x10
0067796e : MOVSX ECX,CX
00677971 : MOVZX EDX,SI
00677974 : SHR EDX,0x8
00677977 : SHL ECX,0x8
0067797a : ADD ECX,EDX
0067797c : PUSH EAX
0067797d : ADD ECX,ECX
0067797f : ADD ECX,ECX
00677981 : MOV EAX,0x88888889
00677986 : IMUL ECX
00677988 : ADD EDX,ECX
0067798a : SAR EDX,0x7
0067798d : MOV EAX,EDX
0067798f : SHR EAX,0x1f
00677992 : ADD EAX,EDX
00677994 : PUSH EAX
00677995 : LEA ECX,[ESP + 0x44]
00677999 : CALL 0x00555690
0067799e : CMP EBP,EDI
006779a0 : JNC 0x00677cca
006779a6 : JMP 0x006779b4
006779b0 : MOV EBP,dword ptr [ESP + 0x10]
006779b4 : CMP word ptr [EBP],0x1
006779b9 : JNZ 0x00677ab4
006779bf : XOR ECX,ECX
006779c1 : MOV dword ptr [ESP + 0x14],0x0
006779c9 : CMP CX,word ptr [EBP + 0x2]
006779cd : JNC 0x00677ab4
006779d3 : LEA ESI,[EBP + 0x4]
006779d6 : MOV EAX,dword ptr [ESI + 0x4]
006779d9 : MOV EDX,EAX
006779db : SHR EDX,0x10
006779de : CMP byte ptr [ESP + 0x74],0x0
006779e3 : JZ 0x00677a38
006779e5 : MOVSX EDX,DX
006779e8 : LEA EDX,[EDX + EDX*0x4]
006779eb : ADD EDX,EDX
006779ed : ADD EDX,EDX
006779ef : MOV EDI,EDX
006779f1 : MOVZX EDX,AX
006779f4 : MOV ECX,dword ptr [ESI]
006779f6 : MOV EAX,EDX
006779f8 : NEG EAX
006779fa : ADD EAX,EAX
006779fc : ADD EAX,EAX
006779fe : SUB EAX,EDX
00677a00 : ADD EAX,EAX
00677a02 : ADD EAX,EAX
00677a04 : CDQ
00677a05 : AND EDX,0xffff
00677a0b : ADD EAX,EDX
00677a0d : SAR EAX,0x10
00677a10 : SUB EAX,EDI
00677a12 : PUSH EAX
00677a13 : MOV EAX,ECX
00677a15 : SHR EAX,0x10
00677a18 : CWDE
00677a19 : LEA EDI,[EAX + EAX*0x4]
00677a1c : MOVZX EAX,CX
00677a1f : LEA EAX,[EAX + EAX*0x4]
00677a22 : ADD EAX,EAX
00677a24 : ADD EAX,EAX
00677a26 : CDQ
00677a27 : AND EDX,0xffff
00677a2d : ADD EAX,EDX
00677a2f : SAR EAX,0x10
00677a32 : LEA ECX,[EAX + EDI*0x4]
00677a35 : PUSH ECX
00677a36 : JMP 0x00677a8f
00677a38 : MOVSX ECX,DX
00677a3b : SHL ECX,0x8
00677a3e : MOV EDX,ECX
00677a40 : MOVZX ECX,AX
00677a43 : SHR ECX,0x8
00677a46 : MOV EDI,dword ptr [ESI]
00677a48 : NEG ECX
00677a4a : SUB ECX,EDX
00677a4c : ADD ECX,ECX
00677a4e : ADD ECX,ECX
00677a50 : MOV EAX,0x88888889
00677a55 : IMUL ECX
00677a57 : ADD EDX,ECX
00677a59 : SAR EDX,0x7
00677a5c : MOV EAX,EDX
00677a5e : SHR EAX,0x1f
00677a61 : ADD EAX,EDX
00677a63 : MOV ECX,EDI
00677a65 : SHR ECX,0x10
00677a68 : MOVSX ECX,CX
00677a6b : MOVZX EDX,DI
00677a6e : SHR EDX,0x8
00677a71 : SHL ECX,0x8
00677a74 : ADD ECX,EDX
00677a76 : PUSH EAX
00677a77 : ADD ECX,ECX
00677a79 : ADD ECX,ECX
00677a7b : MOV EAX,0x88888889
00677a80 : IMUL ECX
00677a82 : ADD EDX,ECX
00677a84 : SAR EDX,0x7
00677a87 : MOV EAX,EDX
00677a89 : SHR EAX,0x1f
00677a8c : ADD EAX,EDX
00677a8e : PUSH EAX
00677a8f : LEA ECX,[ESP + 0x40]
00677a93 : CALL 0x00559cb0
00677a98 : MOV EAX,dword ptr [ESP + 0x14]
00677a9c : MOVZX ECX,word ptr [EBP + 0x2]
00677aa0 : INC EAX
00677aa1 : ADD ESI,0x8
00677aa4 : CMP EAX,ECX
00677aa6 : MOV dword ptr [ESP + 0x14],EAX
00677aaa : JL 0x006779d6
00677ab0 : MOV EDI,dword ptr [ESP + 0x18]
00677ab4 : CMP word ptr [EBP],0x2
00677ab9 : JNZ 0x00677cb6
00677abf : MOVZX EAX,word ptr [EBP + 0x2]
00677ac3 : LEA EDX,[EAX + -0x1]
00677ac6 : MOV dword ptr [ESP + 0x14],0x0
00677ace : TEST EDX,EDX
00677ad0 : JLE 0x00677cb6
00677ad6 : LEA EBX,[EBP + 0xc]
00677ad9 : LEA ESP,[ESP]
00677ae0 : MOV EDI,dword ptr [EBX + -0x8]
00677ae3 : MOV EBP,dword ptr [EBX + -0x4]
00677ae6 : MOV ESI,dword ptr [EBX]
00677ae8 : MOV ECX,dword ptr [EBX + 0x4]
00677aeb : ADD EAX,-0x2
00677aee : CMP dword ptr [ESP + 0x14],EAX
00677af2 : MOV dword ptr [ESP + 0x30],EDI
00677af6 : MOV dword ptr [ESP + 0x34],EBP
00677afa : MOV dword ptr [ESP + 0x28],ESI
00677afe : MOV dword ptr [ESP + 0x2c],ECX
00677b02 : JGE 0x00677b20
00677b04 : LEA EAX,[ESI + EDI*0x1]
00677b07 : CDQ
00677b08 : SUB EAX,EDX
00677b0a : SAR EAX,0x1
00677b0c : MOV ESI,EAX
00677b0e : LEA EAX,[ECX + EBP*0x1]
00677b11 : CDQ
00677b12 : SUB EAX,EDX
00677b14 : SAR EAX,0x1
00677b16 : MOV ECX,EAX
00677b18 : MOV dword ptr [ESP + 0x28],ESI
00677b1c : MOV dword ptr [ESP + 0x2c],ECX
00677b20 : CMP byte ptr [ESP + 0x74],0x0
00677b25 : JZ 0x00677bde
00677b2b : MOV EAX,ECX
00677b2d : SAR EAX,0x10
00677b30 : CWDE
00677b31 : LEA EDX,[EAX + EAX*0x4]
00677b34 : ADD EDX,EDX
00677b36 : ADD EDX,EDX
00677b38 : MOV EAX,EDX
00677b3a : MOV dword ptr [ESP + 0x20],EAX
00677b3e : MOVZX ECX,CX
00677b41 : MOV EAX,ECX
00677b43 : NEG EAX
00677b45 : ADD EAX,EAX
00677b47 : ADD EAX,EAX
00677b49 : SUB EAX,ECX
00677b4b : ADD EAX,EAX
00677b4d : ADD EAX,EAX
00677b4f : CDQ
00677b50 : MOV ECX,dword ptr [ESP + 0x20]
00677b54 : AND EDX,0xffff
00677b5a : ADD EAX,EDX
00677b5c : SAR EAX,0x10
00677b5f : SUB EAX,ECX
00677b61 : PUSH EAX
00677b62 : MOV EAX,ESI
00677b64 : SAR EAX,0x10
00677b67 : CWDE
00677b68 : LEA ECX,[EAX + EAX*0x4]
00677b6b : MOVZX EAX,SI
00677b6e : LEA EAX,[EAX + EAX*0x4]
00677b71 : ADD EAX,EAX
00677b73 : ADD EAX,EAX
00677b75 : CDQ
00677b76 : AND EDX,0xffff
00677b7c : ADD EAX,EDX
00677b7e : SAR EAX,0x10
00677b81 : LEA EDX,[EAX + ECX*0x4]
00677b84 : MOV EAX,EBP
00677b86 : SHR EAX,0x10
00677b89 : CWDE
00677b8a : LEA ECX,[EAX + EAX*0x4]
00677b8d : ADD ECX,ECX
00677b8f : ADD ECX,ECX
00677b91 : MOV ESI,ECX
00677b93 : MOVZX ECX,BP
00677b96 : MOV EAX,ECX
00677b98 : NEG EAX
00677b9a : ADD EAX,EAX
00677b9c : ADD EAX,EAX
00677b9e : SUB EAX,ECX
00677ba0 : ADD EAX,EAX
00677ba2 : ADD EAX,EAX
00677ba4 : PUSH EDX
00677ba5 : CDQ
00677ba6 : AND EDX,0xffff
00677bac : ADD EAX,EDX
00677bae : SAR EAX,0x10
00677bb1 : SUB EAX,ESI
00677bb3 : PUSH EAX
00677bb4 : MOV EDX,EDI
00677bb6 : SHR EDX,0x10
00677bb9 : MOVSX EAX,DX
00677bbc : LEA ECX,[EAX + EAX*0x4]
00677bbf : MOVZX EAX,DI
00677bc2 : LEA EAX,[EAX + EAX*0x4]
00677bc5 : ADD EAX,EAX
00677bc7 : ADD EAX,EAX
00677bc9 : CDQ
00677bca : AND EDX,0xffff
00677bd0 : ADD EAX,EDX
00677bd2 : SAR EAX,0x10
00677bd5 : LEA EDX,[EAX + ECX*0x4]
00677bd8 : PUSH EDX
00677bd9 : JMP 0x00677c82
00677bde : MOVZX EAX,CX
00677be1 : MOVSX ECX,word ptr [ESP + 0x2e]
00677be6 : NEG ECX
00677be8 : SHL ECX,0x8
00677beb : SHR EAX,0x8
00677bee : SUB ECX,EAX
00677bf0 : ADD ECX,ECX
00677bf2 : ADD ECX,ECX
00677bf4 : MOV EAX,0x88888889
00677bf9 : IMUL ECX
00677bfb : ADD EDX,ECX
00677bfd : SAR EDX,0x7
00677c00 : MOV ECX,EDX
00677c02 : SHR ECX,0x1f
00677c05 : ADD ECX,EDX
00677c07 : MOVSX EDX,word ptr [ESP + 0x2a]
00677c0c : PUSH ECX
00677c0d : SHL EDX,0x8
00677c10 : MOVZX ECX,SI
00677c13 : SHR ECX,0x8
00677c16 : ADD ECX,EDX
00677c18 : ADD ECX,ECX
00677c1a : ADD ECX,ECX
00677c1c : MOV EAX,0x88888889
00677c21 : IMUL ECX
00677c23 : ADD EDX,ECX
00677c25 : MOVSX ECX,word ptr [ESP + 0x3a]
00677c2a : SAR EDX,0x7
00677c2d : MOV EAX,EDX
00677c2f : SHR EAX,0x1f
00677c32 : ADD EAX,EDX
00677c34 : NEG ECX
00677c36 : SHL ECX,0x8
00677c39 : PUSH EAX
00677c3a : MOVZX EDX,BP
00677c3d : SHR EDX,0x8
00677c40 : SUB ECX,EDX
00677c42 : ADD ECX,ECX
00677c44 : ADD ECX,ECX
00677c46 : MOV EAX,0x88888889
00677c4b : IMUL ECX
00677c4d : ADD EDX,ECX
00677c4f : SAR EDX,0x7
00677c52 : MOV EAX,EDX
00677c54 : SHR EAX,0x1f
00677c57 : ADD EAX,EDX
00677c59 : MOVSX EDX,word ptr [ESP + 0x3a]
00677c5e : MOVZX ECX,DI
00677c61 : SHL EDX,0x8
00677c64 : SHR ECX,0x8
00677c67 : ADD ECX,EDX
00677c69 : PUSH EAX
00677c6a : ADD ECX,ECX
00677c6c : ADD ECX,ECX
00677c6e : MOV EAX,0x88888889
00677c73 : IMUL ECX
00677c75 : ADD EDX,ECX
00677c77 : SAR EDX,0x7
00677c7a : MOV EAX,EDX
00677c7c : SHR EAX,0x1f
00677c7f : ADD EAX,EDX
00677c81 : PUSH EAX
00677c82 : LEA ECX,[ESP + 0x48]
00677c86 : CALL 0x00559cd0
00677c8b : MOV EDX,dword ptr [ESP + 0x10]
00677c8f : MOVZX EAX,word ptr [EDX + 0x2]
00677c93 : MOV ECX,dword ptr [ESP + 0x14]
00677c97 : INC ECX
00677c98 : LEA EDX,[EAX + -0x1]
00677c9b : ADD EBX,0x8
00677c9e : CMP ECX,EDX
00677ca0 : MOV dword ptr [ESP + 0x14],ECX
00677ca4 : JL 0x00677ae0
00677caa : MOV EBX,dword ptr [ESP + 0x1c]
00677cae : MOV EBP,dword ptr [ESP + 0x10]
00677cb2 : MOV EDI,dword ptr [ESP + 0x18]
00677cb6 : MOVZX EAX,word ptr [EBP + 0x2]
00677cba : LEA EAX,[EBP + EAX*0x8 + 0x4]
00677cbe : MOV dword ptr [ESP + 0x10],EAX
00677cc2 : CMP EAX,EDI
00677cc4 : JC 0x006779b0
00677cca : ADD EBX,dword ptr [EBX]
00677ccc : CMP dword ptr [ESP + 0x60],0x0
00677cd1 : MOV dword ptr [ESP + 0x1c],EBX
00677cd5 : JZ 0x00677d01
00677cd7 : LEA ECX,[ESP + 0x38]
00677cdb : CALL 0x00559d00
00677ce0 : CMP dword ptr [ESP + 0x60],0x0
00677ce5 : JZ 0x00677cfc
00677ce7 : MOV EAX,dword ptr [ESP + 0x7c]
00677ceb : LEA ECX,[EAX + 0x34]
00677cee : PUSH ECX
00677cef : ADD EAX,0x28
00677cf2 : PUSH EAX
00677cf3 : LEA ECX,[ESP + 0x40]
00677cf7 : CALL 0x005551b0
00677cfc : MOV byte ptr [ESP + 0x78],0x1
00677d01 : CMP EBX,dword ptr [ESP + 0x24]
00677d05 : JC 0x006778b0
00677d0b : POP EBP
00677d0c : MOV EDX,dword ptr [ESP + 0x50]
00677d10 : PUSH EDX
00677d11 : CALL 0x00515cf0
00677d16 : MOV AL,byte ptr [ESP + 0x74]
00677d1a : POP EDI
00677d1b : POP ESI
00677d1c : POP EBX
00677d1d : ADD ESP,0x60
00677d20 : RET 0xc

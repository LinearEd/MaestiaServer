PROGRAM  : Maestia.exe
FUNCTION : FUN_0069e710
ENTRY    : 0069e710
BODY     : [[0069e710, 0069e961]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_0069e710(int *param_1,int param_2,int param_3,int param_4)

{
  void *pvVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  void *pvVar5;
  size_t _Size;
  void *local_30;
  void *local_2c;
  int local_28;
  int *local_24;
  int local_20;
  void *local_1c;
  void *local_18;
  int local_14;
  undefined4 local_10;
  undefined4 local_c;
  int local_8;
  undefined4 local_4;
  
  FUN_0069d500(param_1,&local_1c);
  if (local_14 != 0) {
    iVar3 = 0;
    local_28 = 1;
    local_30 = local_1c;
    local_2c = local_18;
    iVar2 = local_14;
    if (*(int *)(param_2 + 8) == 7) {
      iVar2 = *param_1;
      local_24 = (int *)param_1[2];
      *param_1 = (int)local_1c + 1;
      param_1[2] = (int)local_18 + -1;
      FUN_0069d500(param_1,&local_10);
      *param_1 = iVar2;
      param_1[2] = (int)local_24;
      iVar2 = local_8;
    }
    if (iVar2 == 3) {
      if (param_4 == 0) {
        return 3;
      }
      local_30 = (void *)((int)local_1c + 1);
      local_18 = (void *)((int)local_18 + -1);
      local_28 = param_4;
      iVar3 = 1;
      local_2c = local_18;
      if (param_4 == 0) {
        return 0;
      }
    }
    local_24 = (int *)(param_3 + iVar3 * 4);
    pvVar5 = local_18;
    do {
      piVar4 = (int *)(*local_24 + *(int *)(param_2 + 0x10));
      FUN_0069d110();
      switch(*(undefined4 *)(param_2 + 8)) {
      case 1:
        iVar2 = FUN_0069d6f0();
        pvVar5 = local_2c;
        break;
      case 2:
        iVar2 = FUN_0069e260();
        break;
      case 3:
        iVar2 = FUN_0069e290(&local_30,pvVar5,0);
        break;
      case 4:
        iVar2 = FUN_0069e290(&local_30,pvVar5,3);
        break;
      case 5:
      case 6:
        iVar2 = param_1[4];
        pvVar1 = local_2c;
        if (local_30 < local_2c) {
          if (local_14 == 4) {
            iVar3 = -1;
          }
          else {
            if (local_14 != 2) {
              return 3;
            }
            iVar3 = -2;
          }
          _Size = (int)pvVar5 + (iVar3 - (int)local_30);
          pvVar5 = (void *)((int)local_30 + 1);
          local_30 = pvVar5;
          if (*piVar4 != 0) {
            FUN_00687f30(iVar2,*piVar4);
            *piVar4 = 0;
          }
          pvVar1 = (void *)FUN_00688c00(iVar2,_Size + 1,&local_20);
          if (local_20 != 0) {
            return local_20;
          }
          _memcpy(pvVar1,pvVar5,_Size);
          *(undefined1 *)((int)pvVar1 + _Size) = 0;
          *piVar4 = (int)pvVar1;
          pvVar1 = local_2c;
        }
        goto LAB_0069e8db;
      case 7:
        iVar2 = FUN_0069e620(&local_30,pvVar5,4,&local_10,0);
        if (-1 < iVar2) {
          iVar2 = FUN_00685c70(local_10);
          *piVar4 = iVar2;
          iVar2 = FUN_00685c70(local_c);
          piVar4[1] = iVar2;
          iVar2 = FUN_00685c70(local_8);
          piVar4[2] = iVar2;
          iVar2 = FUN_00685c70(local_4);
          piVar4[3] = iVar2;
          pvVar1 = pvVar5;
          goto LAB_0069e8db;
        }
      default:
        goto switchD_0069e7f2_default;
      }
      pvVar1 = pvVar5;
      if (*(char *)(param_2 + 0x14) == '\x01') {
        *(char *)piVar4 = (char)iVar2;
      }
      else if (*(char *)(param_2 + 0x14) == '\x02') {
        *(short *)piVar4 = (short)iVar2;
      }
      else {
        *piVar4 = iVar2;
      }
LAB_0069e8db:
      local_28 = local_28 + -1;
      local_24 = local_24 + 1;
      pvVar5 = pvVar1;
      if (local_28 == 0) {
        return 0;
      }
    } while( true );
  }
switchD_0069e7f2_default:
  return 3;
}



============================================================
DISASSEMBLY
============================================================
0069e710 : SUB ESP,0x30
0069e713 : PUSH EBX
0069e714 : MOV EBX,dword ptr [ESP + 0x38]
0069e718 : PUSH EBP
0069e719 : PUSH ESI
0069e71a : PUSH EDI
0069e71b : LEA EAX,[ESP + 0x24]
0069e71f : PUSH EAX
0069e720 : PUSH EBX
0069e721 : CALL 0x0069d500
0069e726 : MOV EAX,dword ptr [ESP + 0x34]
0069e72a : ADD ESP,0x8
0069e72d : TEST EAX,EAX
0069e72f : JZ 0x0069e955
0069e735 : MOV ECX,dword ptr [ESP + 0x48]
0069e739 : MOV EDI,dword ptr [ESP + 0x24]
0069e73d : MOV ESI,dword ptr [ESP + 0x28]
0069e741 : XOR EBP,EBP
0069e743 : CMP dword ptr [ECX + 0x8],0x7
0069e747 : MOV dword ptr [ESP + 0x18],0x1
0069e74f : MOV dword ptr [ESP + 0x10],EDI
0069e753 : MOV dword ptr [ESP + 0x14],ESI
0069e757 : JNZ 0x0069e795
0069e759 : MOV EAX,dword ptr [ESP + 0x44]
0069e75d : MOV EBX,dword ptr [EBX]
0069e75f : MOV EDX,dword ptr [EAX + 0x8]
0069e762 : LEA ECX,[EDI + 0x1]
0069e765 : MOV dword ptr [EAX],ECX
0069e767 : LEA ECX,[ESP + 0x30]
0069e76b : MOV dword ptr [ESP + 0x1c],EDX
0069e76f : PUSH ECX
0069e770 : LEA EDX,[ESI + -0x1]
0069e773 : PUSH EAX
0069e774 : MOV dword ptr [EAX + 0x8],EDX
0069e777 : CALL 0x0069d500
0069e77c : MOV EAX,dword ptr [ESP + 0x4c]
0069e780 : MOV EDX,dword ptr [ESP + 0x24]
0069e784 : ADD ESP,0x8
0069e787 : CMP dword ptr [ESP + 0x38],0x3
0069e78c : MOV dword ptr [EAX],EBX
0069e78e : MOV dword ptr [EAX + 0x8],EDX
0069e791 : JZ 0x0069e79a
0069e793 : JMP 0x0069e7c1
0069e795 : CMP EAX,0x3
0069e798 : JNZ 0x0069e7c1
0069e79a : MOV EAX,dword ptr [ESP + 0x50]
0069e79e : TEST EAX,EAX
0069e7a0 : JZ 0x0069e955
0069e7a6 : INC EDI
0069e7a7 : DEC ESI
0069e7a8 : MOV dword ptr [ESP + 0x18],EAX
0069e7ac : MOV EBP,0x1
0069e7b1 : MOV dword ptr [ESP + 0x10],EDI
0069e7b5 : MOV dword ptr [ESP + 0x14],ESI
0069e7b9 : TEST EAX,EAX
0069e7bb : JBE 0x0069e8f7
0069e7c1 : MOV EAX,dword ptr [ESP + 0x4c]
0069e7c5 : LEA EBP,[EAX + EBP*0x4]
0069e7c8 : MOV dword ptr [ESP + 0x1c],EBP
0069e7cc : LEA ESP,[ESP]
0069e7d0 : MOV EBP,dword ptr [EBP]
0069e7d3 : MOV EBX,dword ptr [ESP + 0x48]
0069e7d7 : ADD EBP,dword ptr [EBX + 0x10]
0069e7da : MOV EAX,ESI
0069e7dc : LEA EDI,[ESP + 0x10]
0069e7e0 : CALL 0x0069d110
0069e7e5 : MOV EAX,dword ptr [EBX + 0x8]
0069e7e8 : DEC EAX
0069e7e9 : CMP EAX,0x6
0069e7ec : JA 0x0069e955
0069e7f2 : JMP dword ptr [EAX*0x4 + 0x69e964]
0069e7f9 : LEA EBX,[ESP + 0x10]
0069e7fd : CALL 0x0069d6f0
0069e802 : MOV ESI,dword ptr [ESP + 0x14]
0069e806 : JMP 0x0069e837
0069e808 : PUSH 0x0
0069e80a : LEA ECX,[ESP + 0x14]
0069e80e : PUSH ESI
0069e80f : PUSH ECX
0069e810 : CALL 0x0069e290
0069e815 : ADD ESP,0xc
0069e818 : JMP 0x0069e837
0069e81a : PUSH 0x3
0069e81c : LEA EDX,[ESP + 0x14]
0069e820 : PUSH ESI
0069e821 : PUSH EDX
0069e822 : CALL 0x0069e290
0069e827 : ADD ESP,0xc
0069e82a : JMP 0x0069e837
0069e82c : MOV EAX,ESI
0069e82e : LEA EBX,[ESP + 0x10]
0069e832 : CALL 0x0069e260
0069e837 : MOV ECX,dword ptr [ESP + 0x48]
0069e83b : MOVZX ECX,byte ptr [ECX + 0x14]
0069e83f : SUB ECX,0x1
0069e842 : JZ 0x0069e85a
0069e844 : SUB ECX,0x1
0069e847 : JZ 0x0069e851
0069e849 : MOV dword ptr [EBP],EAX
0069e84c : JMP 0x0069e8db
0069e851 : MOV word ptr [EBP],AX
0069e855 : JMP 0x0069e8db
0069e85a : MOV byte ptr [EBP],AL
0069e85d : JMP 0x0069e8db
0069e85f : MOV EDX,dword ptr [ESP + 0x44]
0069e863 : MOV EBX,dword ptr [EDX + 0x10]
0069e866 : MOV EDI,ESI
0069e868 : MOV ESI,dword ptr [ESP + 0x10]
0069e86c : SUB EDI,ESI
0069e86e : CMP ESI,dword ptr [ESP + 0x14]
0069e872 : JNC 0x0069e8d7
0069e874 : MOV EAX,dword ptr [ESP + 0x2c]
0069e878 : CMP EAX,0x4
0069e87b : JNZ 0x0069e881
0069e87d : DEC EDI
0069e87e : INC ESI
0069e87f : JMP 0x0069e88d
0069e881 : CMP EAX,0x2
0069e884 : JNZ 0x0069e955
0069e88a : INC ESI
0069e88b : SUB EDI,EAX
0069e88d : MOV EAX,dword ptr [EBP]
0069e890 : MOV dword ptr [ESP + 0x10],ESI
0069e894 : TEST EAX,EAX
0069e896 : JZ 0x0069e8a9
0069e898 : PUSH EAX
0069e899 : PUSH EBX
0069e89a : CALL 0x00687f30
0069e89f : ADD ESP,0x8
0069e8a2 : MOV dword ptr [EBP],0x0
0069e8a9 : LEA EAX,[ESP + 0x20]
0069e8ad : PUSH EAX
0069e8ae : LEA ECX,[EDI + 0x1]
0069e8b1 : PUSH ECX
0069e8b2 : PUSH EBX
0069e8b3 : CALL 0x00688c00
0069e8b8 : MOV EBX,EAX
0069e8ba : MOV EAX,dword ptr [ESP + 0x2c]
0069e8be : ADD ESP,0xc
0069e8c1 : TEST EAX,EAX
0069e8c3 : JNZ 0x0069e8f9
0069e8c5 : PUSH EDI
0069e8c6 : PUSH ESI
0069e8c7 : PUSH EBX
0069e8c8 : CALL 0x0063ae40
0069e8cd : MOV byte ptr [EBX + EDI*0x1],0x0
0069e8d1 : ADD ESP,0xc
0069e8d4 : MOV dword ptr [EBP],EBX
0069e8d7 : MOV ESI,dword ptr [ESP + 0x14]
0069e8db : MOV EAX,dword ptr [ESP + 0x18]
0069e8df : MOV EBP,dword ptr [ESP + 0x1c]
0069e8e3 : DEC EAX
0069e8e4 : ADD EBP,0x4
0069e8e7 : MOV dword ptr [ESP + 0x18],EAX
0069e8eb : MOV dword ptr [ESP + 0x1c],EBP
0069e8ef : TEST EAX,EAX
0069e8f1 : JA 0x0069e7d0
0069e8f7 : XOR EAX,EAX
0069e8f9 : POP EDI
0069e8fa : POP ESI
0069e8fb : POP EBP
0069e8fc : POP EBX
0069e8fd : ADD ESP,0x30
0069e900 : RET
0069e901 : PUSH 0x0
0069e903 : LEA EDX,[ESP + 0x34]
0069e907 : PUSH EDX
0069e908 : PUSH 0x4
0069e90a : LEA EAX,[ESP + 0x1c]
0069e90e : PUSH ESI
0069e90f : PUSH EAX
0069e910 : CALL 0x0069e620
0069e915 : ADD ESP,0x14
0069e918 : TEST EAX,EAX
0069e91a : JL 0x0069e955
0069e91c : MOV ECX,dword ptr [ESP + 0x30]
0069e920 : PUSH ECX
0069e921 : CALL 0x00685c70
0069e926 : MOV EDX,dword ptr [ESP + 0x38]
0069e92a : PUSH EDX
0069e92b : MOV dword ptr [EBP],EAX
0069e92e : CALL 0x00685c70
0069e933 : MOV dword ptr [EBP + 0x4],EAX
0069e936 : MOV EAX,dword ptr [ESP + 0x40]
0069e93a : PUSH EAX
0069e93b : CALL 0x00685c70
0069e940 : MOV ECX,dword ptr [ESP + 0x48]
0069e944 : PUSH ECX
0069e945 : MOV dword ptr [EBP + 0x8],EAX
0069e948 : CALL 0x00685c70
0069e94d : ADD ESP,0x10
0069e950 : MOV dword ptr [EBP + 0xc],EAX
0069e953 : JMP 0x0069e8db
0069e955 : POP EDI
0069e956 : POP ESI
0069e957 : POP EBP
0069e958 : MOV EAX,0x3
0069e95d : POP EBX
0069e95e : ADD ESP,0x30
0069e961 : RET

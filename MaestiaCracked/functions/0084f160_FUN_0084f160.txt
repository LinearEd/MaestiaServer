PROGRAM  : Maestia.exe
FUNCTION : FUN_0084f160
ENTRY    : 0084f160
BODY     : [[0084f160, 0084f423]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0084f160(int param_1,char param_2)

{
  char cVar1;
  uint uVar2;
  int iVar3;
  undefined4 ****ppppuVar4;
  undefined1 local_90 [28];
  undefined4 local_74;
  uint local_70;
  int local_6c;
  undefined1 local_68 [20];
  int local_54;
  undefined1 local_4c [4];
  undefined4 ***local_48 [4];
  int local_38;
  uint local_34;
  undefined1 local_30 [4];
  undefined4 ***local_2c [4];
  int local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  iVar3 = DAT_00d7c54c;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4418d;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_70 = (uint)(param_2 == '\0');
  local_74 = *(undefined4 *)(param_1 + 0x28);
  local_14 = uVar2;
  FUN_004437f0(&local_74);
  if ((local_6c != *(int *)(iVar3 + 0x44)) && (*(int *)(local_6c + 0x10) != 0)) {
    FUN_00404350(*(int *)(local_6c + 0x10) + 400,uVar2);
    local_8 = 0;
    ppppuVar4 = (undefined4 ****)local_48[0];
    if (local_34 < 8) {
      ppppuVar4 = local_48;
    }
    iVar3 = FUN_00405b70(ppppuVar4);
    if ((iVar3 == 0) && (local_38 == 0)) {
      local_8 = 0xffffffff;
      if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_34 = 7;
      local_38 = 0;
      local_48[0] = (undefined4 ***)((uint)local_48[0] & 0xffff0000);
    }
    else {
      local_18 = 7;
      local_1c = 0;
      local_2c[0] = (undefined4 ***)((uint)local_2c[0] & 0xffff0000);
      FUN_00405eb0(local_4c,0,0xffffffff);
      local_8 = CONCAT31(local_8._1_3_,1);
      local_6c = 0x2e;
      iVar3 = FUN_00407cc0(&local_6c,1);
      if (iVar3 != -1) {
        FUN_00405e10(iVar3,local_1c - iVar3);
        FUN_00404980(local_30);
      }
      iVar3 = *(int *)(param_1 + 0x58 + local_70 * 4);
      if (iVar3 == 0) {
        FUN_008018d0(L"Righthand weapon dummy name wrong !! Create Righthane Node Failed");
      }
      else {
        cVar1 = FUN_007d97d0(iVar3);
        if (cVar1 != '\0') {
          FUN_00405660(local_30);
          local_8 = CONCAT31(local_8._1_3_,3);
          local_6c = 0x2e;
          iVar3 = FUN_00407cc0(&local_6c,1);
          if (iVar3 != -1) {
            FUN_00405e10(iVar3,local_54 - iVar3);
            FUN_00404980(local_68);
          }
          FUN_0084ca50(param_1);
          cVar1 = FUN_0084e730(param_1,local_68);
          if (cVar1 == '\0') {
            local_8._0_1_ = 1;
            FUN_00406560();
            local_8 = (uint)local_8._1_3_ << 8;
            FUN_00406560();
            local_8 = 0xffffffff;
            FUN_00406560();
          }
          else {
            FUN_0084d400();
            local_8._0_1_ = 1;
            FUN_00406560();
            local_8 = (uint)local_8._1_3_ << 8;
            FUN_00406560();
            local_8 = 0xffffffff;
            FUN_00406560();
          }
          goto LAB_0084f406;
        }
        ppppuVar4 = (undefined4 ****)local_2c[0];
        if (local_18 < 8) {
          ppppuVar4 = local_2c;
        }
        FUN_008018d0(L"AttachSkeleton Fail %s",ppppuVar4);
        FUN_00406460(L"AttachSkeleton Fail");
        local_8._0_1_ = 2;
        if ((int *)*DAT_00da98e8 != (int *)0x0) {
          (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                    (L"AvaPlayerPart::SetPartsEnchantData",0x28c,local_90);
        }
        local_8 = CONCAT31(local_8._1_3_,1);
        FUN_00406560();
      }
      local_8 = local_8 & 0xffffff00;
      FUN_00406560();
      local_8 = 0xffffffff;
      FUN_00406560();
    }
  }
LAB_0084f406:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0084f160 : PUSH EBP
0084f161 : MOV EBP,ESP
0084f163 : PUSH -0x1
0084f165 : PUSH 0xb4418d
0084f16a : MOV EAX,FS:[0x0]
0084f170 : PUSH EAX
0084f171 : SUB ESP,0x80
0084f177 : MOV EAX,[0x00d66fa0]
0084f17c : XOR EAX,EBP
0084f17e : MOV dword ptr [EBP + -0x10],EAX
0084f181 : PUSH EBX
0084f182 : PUSH ESI
0084f183 : PUSH EDI
0084f184 : PUSH EAX
0084f185 : LEA EAX,[EBP + -0xc]
0084f188 : MOV FS:[0x0],EAX
0084f18e : MOV EBX,dword ptr [EBP + 0x8]
0084f191 : XOR EDI,EDI
0084f193 : CMP byte ptr [EBP + 0xc],0x0
0084f197 : MOV dword ptr [EBP + -0x6c],EDI
0084f19a : JNZ 0x0084f1a3
0084f19c : MOV dword ptr [EBP + -0x6c],0x1
0084f1a3 : MOV EAX,dword ptr [EBX + 0x28]
0084f1a6 : MOV ESI,dword ptr [0x00d7c54c]
0084f1ac : LEA ECX,[EBP + -0x70]
0084f1af : MOV dword ptr [EBP + -0x70],EAX
0084f1b2 : PUSH ECX
0084f1b3 : LEA ECX,[ESI + 0x40]
0084f1b6 : LEA EAX,[EBP + -0x68]
0084f1b9 : CALL 0x004437f0
0084f1be : MOV ESI,dword ptr [ESI + 0x44]
0084f1c1 : MOV EAX,dword ptr [EBP + -0x68]
0084f1c4 : CMP EAX,ESI
0084f1c6 : JZ 0x0084f237
0084f1c8 : MOV EAX,dword ptr [EAX + 0x10]
0084f1cb : CMP EAX,EDI
0084f1cd : JZ 0x0084f237
0084f1cf : ADD EAX,0x190
0084f1d4 : PUSH EAX
0084f1d5 : LEA ESI,[EBP + -0x48]
0084f1d8 : CALL 0x00404350
0084f1dd : ADD ESP,0x4
0084f1e0 : MOV dword ptr [EBP + -0x4],EDI
0084f1e3 : MOV EAX,dword ptr [EBP + -0x44]
0084f1e6 : MOV ESI,0x8
0084f1eb : CMP dword ptr [EBP + -0x30],ESI
0084f1ee : JNC 0x0084f1f3
0084f1f0 : LEA EAX,[EBP + -0x44]
0084f1f3 : PUSH EAX
0084f1f4 : XOR EDX,EDX
0084f1f6 : MOV ECX,0xc3cd20
0084f1fb : CALL 0x00405b70
0084f200 : ADD ESP,0x4
0084f203 : CMP EAX,EDI
0084f205 : JNZ 0x0084f23e
0084f207 : XOR EAX,EAX
0084f209 : CMP dword ptr [EBP + -0x34],EDI
0084f20c : SETNZ AL
0084f20f : CMP EAX,EDI
0084f211 : JNZ 0x0084f23e
0084f213 : MOV dword ptr [EBP + -0x4],0xffffffff
0084f21a : CMP dword ptr [EBP + -0x30],ESI
0084f21d : JC 0x0084f227
0084f21f : MOV ECX,dword ptr [EBP + -0x44]
0084f222 : CALL 0x006f04e0
0084f227 : XOR EDX,EDX
0084f229 : MOV dword ptr [EBP + -0x30],0x7
0084f230 : MOV dword ptr [EBP + -0x34],EDI
0084f233 : MOV word ptr [EBP + -0x44],DX
0084f237 : XOR AL,AL
0084f239 : JMP 0x0084f406
0084f23e : PUSH -0x1
0084f240 : PUSH EDI
0084f241 : LEA ECX,[EBP + -0x48]
0084f244 : XOR EAX,EAX
0084f246 : PUSH ECX
0084f247 : LEA ECX,[EBP + -0x2c]
0084f24a : MOV dword ptr [EBP + -0x14],0x7
0084f251 : MOV dword ptr [EBP + -0x18],EDI
0084f254 : MOV word ptr [EBP + -0x28],AX
0084f258 : CALL 0x00405eb0
0084f25d : MOV byte ptr [EBP + -0x4],0x1
0084f261 : PUSH 0x1
0084f263 : LEA EDX,[EBP + -0x68]
0084f266 : PUSH EDX
0084f267 : OR ECX,0xffffffff
0084f26a : LEA EDI,[EBP + -0x2c]
0084f26d : MOV dword ptr [EBP + -0x68],0x2e
0084f274 : CALL 0x00407cc0
0084f279 : CMP EAX,-0x1
0084f27c : JZ 0x0084f299
0084f27e : MOV ECX,dword ptr [EBP + -0x18]
0084f281 : SUB ECX,EAX
0084f283 : PUSH ECX
0084f284 : PUSH EAX
0084f285 : MOV ECX,EDI
0084f287 : CALL 0x00405e10
0084f28c : MOV EDX,EDI
0084f28e : PUSH EDX
0084f28f : MOV EDX,0xc3cd24
0084f294 : CALL 0x00404980
0084f299 : MOV ESI,dword ptr [EBP + -0x6c]
0084f29c : MOV EAX,dword ptr [EBX + ESI*0x4 + 0x58]
0084f2a0 : TEST EAX,EAX
0084f2a2 : JNZ 0x0084f2d9
0084f2a4 : MOV ESI,dword ptr [0x00da98e8]
0084f2aa : PUSH 0xc3cd30
0084f2af : CALL 0x008018d0
0084f2b4 : ADD ESP,0x4
0084f2b7 : MOV byte ptr [EBP + -0x4],0x0
0084f2bb : LEA ECX,[EBP + -0x2c]
0084f2be : CALL 0x00406560
0084f2c3 : MOV dword ptr [EBP + -0x4],0xffffffff
0084f2ca : LEA ECX,[EBP + -0x48]
0084f2cd : CALL 0x00406560
0084f2d2 : XOR AL,AL
0084f2d4 : JMP 0x0084f406
0084f2d9 : PUSH EAX
0084f2da : LEA ECX,[EBP + -0x2c]
0084f2dd : CALL 0x007d97d0
0084f2e2 : TEST AL,AL
0084f2e4 : JNZ 0x0084f351
0084f2e6 : CMP dword ptr [EBP + -0x14],0x8
0084f2ea : MOV EAX,dword ptr [EBP + -0x28]
0084f2ed : JNC 0x0084f2f2
0084f2ef : LEA EAX,[EBP + -0x28]
0084f2f2 : MOV ESI,dword ptr [0x00da98e8]
0084f2f8 : PUSH EAX
0084f2f9 : PUSH 0xc3cdb4
0084f2fe : CALL 0x008018d0
0084f303 : ADD ESP,0x8
0084f306 : PUSH 0xc3cde4
0084f30b : LEA ECX,[EBP + 0xffffff74]
0084f311 : CALL 0x00406460
0084f316 : MOV byte ptr [EBP + -0x4],0x2
0084f31a : MOV EAX,[0x00da98e8]
0084f31f : MOV ECX,dword ptr [EAX]
0084f321 : TEST ECX,ECX
0084f323 : JZ 0x0084f33d
0084f325 : MOV EDX,dword ptr [ECX]
0084f327 : MOV EDX,dword ptr [EDX + 0x14]
0084f32a : LEA EAX,[EBP + 0xffffff74]
0084f330 : PUSH EAX
0084f331 : PUSH 0x28c
0084f336 : PUSH 0xc3ce18
0084f33b : CALL EDX
0084f33d : MOV byte ptr [EBP + -0x4],0x1
0084f341 : LEA ECX,[EBP + 0xffffff74]
0084f347 : CALL 0x00406560
0084f34c : JMP 0x0084f2b7
0084f351 : LEA EAX,[EBP + -0x2c]
0084f354 : PUSH EAX
0084f355 : LEA ECX,[EBP + -0x64]
0084f358 : CALL 0x00405660
0084f35d : MOV byte ptr [EBP + -0x4],0x3
0084f361 : PUSH 0x1
0084f363 : LEA ECX,[EBP + -0x68]
0084f366 : PUSH ECX
0084f367 : OR ECX,0xffffffff
0084f36a : LEA EDI,[EBP + -0x64]
0084f36d : MOV dword ptr [EBP + -0x68],0x2e
0084f374 : CALL 0x00407cc0
0084f379 : OR EDI,0xffffffff
0084f37c : CMP EAX,EDI
0084f37e : JZ 0x0084f39d
0084f380 : MOV EDX,dword ptr [EBP + -0x50]
0084f383 : SUB EDX,EAX
0084f385 : PUSH EDX
0084f386 : PUSH EAX
0084f387 : LEA ECX,[EBP + -0x64]
0084f38a : CALL 0x00405e10
0084f38f : LEA EAX,[EBP + -0x64]
0084f392 : PUSH EAX
0084f393 : MOV EDX,0xc3ce0c
0084f398 : CALL 0x00404980
0084f39d : PUSH EBX
0084f39e : CALL 0x0084ca50
0084f3a3 : LEA ECX,[EBP + -0x64]
0084f3a6 : PUSH ECX
0084f3a7 : PUSH EBX
0084f3a8 : CALL 0x0084e730
0084f3ad : TEST AL,AL
0084f3af : JNZ 0x0084f3d8
0084f3b1 : MOV byte ptr [EBP + -0x4],0x1
0084f3b5 : LEA ECX,[EBP + -0x64]
0084f3b8 : CALL 0x00406560
0084f3bd : MOV byte ptr [EBP + -0x4],0x0
0084f3c1 : LEA ECX,[EBP + -0x2c]
0084f3c4 : CALL 0x00406560
0084f3c9 : MOV dword ptr [EBP + -0x4],EDI
0084f3cc : LEA ECX,[EBP + -0x48]
0084f3cf : CALL 0x00406560
0084f3d4 : XOR AL,AL
0084f3d6 : JMP 0x0084f406
0084f3d8 : MOV EDX,ESI
0084f3da : MOV ECX,EBX
0084f3dc : CALL 0x0084d400
0084f3e1 : MOV byte ptr [EBP + -0x4],0x1
0084f3e5 : LEA ECX,[EBP + -0x64]
0084f3e8 : CALL 0x00406560
0084f3ed : MOV byte ptr [EBP + -0x4],0x0
0084f3f1 : LEA ECX,[EBP + -0x2c]
0084f3f4 : CALL 0x00406560
0084f3f9 : MOV dword ptr [EBP + -0x4],EDI
0084f3fc : LEA ECX,[EBP + -0x48]
0084f3ff : CALL 0x00406560
0084f404 : MOV AL,0x1
0084f406 : MOV ECX,dword ptr [EBP + -0xc]
0084f409 : MOV dword ptr FS:[0x0],ECX
0084f410 : POP ECX
0084f411 : POP EDI
0084f412 : POP ESI
0084f413 : POP EBX
0084f414 : MOV ECX,dword ptr [EBP + -0x10]
0084f417 : XOR ECX,EBP
0084f419 : CALL 0x00633e6b
0084f41e : MOV ESP,EBP
0084f420 : POP EBP
0084f421 : RET 0x8

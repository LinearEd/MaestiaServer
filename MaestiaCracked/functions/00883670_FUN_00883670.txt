PROGRAM  : Maestia.exe
FUNCTION : FUN_00883670
ENTRY    : 00883670
BODY     : [[00883670, 00883b82]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00883670(int param_1)

{
  short sVar1;
  uint uVar2;
  char cVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  undefined4 uVar7;
  int *piVar8;
  undefined1 *in_ECX;
  int local_f4;
  int local_f0;
  int local_ec [2];
  int local_e4;
  undefined1 local_c4 [28];
  undefined1 local_a8 [28];
  undefined1 local_8c [84];
  undefined1 local_38 [28];
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b5f786;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)&local_f4;
  ExceptionList = &local_14;
  uVar7 = *(undefined4 *)(in_ECX + 0xc);
  local_e4 = param_1;
  local_ec[0] = DAT_00da93ec;
  iVar4 = FUN_00a1a840(uVar7);
  if ((iVar4 == 0) && (iVar4 = FUN_00a1a6d0(uVar7), iVar4 == 0)) {
    iVar4 = FUN_00a1a780(uVar7);
  }
  local_ec[0] = *(int *)(in_ECX + 0x10);
  local_f4 = DAT_00da93ec;
  iVar5 = FUN_00a1a840(local_ec[0]);
  if ((iVar5 == 0) && (iVar5 = FUN_00a1a6d0(local_ec[0]), iVar5 == 0)) {
    iVar5 = FUN_00a1a780(local_ec[0]);
  }
  if (iVar4 == 0) goto LAB_00883b5d;
  if (*(int *)(*DAT_00da9894 + 0x2a0) != 0) {
    FUN_009abc00(*(undefined4 *)(*DAT_00da9894 + 0x2a0),in_ECX);
  }
  cVar3 = FUN_00882380(*(undefined4 *)(in_ECX + 0xc));
  if (((((cVar3 == '\0') && (cVar3 = FUN_00882380(*(undefined4 *)(in_ECX + 0x10)), cVar3 == '\0'))
       && (cVar3 = FUN_008822f0(*(undefined4 *)(in_ECX + 0xc)), cVar3 == '\0')) &&
      ((cVar3 = FUN_008822f0(*(undefined4 *)(in_ECX + 0x10)), cVar3 == '\0' ||
       (*(int *)(in_ECX + 0xc) != *(int *)(*(int *)(DAT_0172491c + 0x17c) + 4))))) ||
     ((DAT_017248cc == 0 || (cVar3 = FUN_00881fd0(), cVar3 == '\0')))) goto LAB_00883b5d;
  if (iVar5 != 0) {
    if (*(char *)(DAT_00da93ec + 0x1d5) == '\0') {
      FUN_00405eb0(iVar5 + 0xc,0,0xffffffff);
    }
    else {
      FUN_00405c00(in_ECX + 0x1c);
    }
  }
  if (*(int *)(in_ECX + 0x68) == 0x17) {
    in_ECX[0x55] = 1;
  }
  uVar2 = *(uint *)(in_ECX + 4);
  uVar6 = uVar2 >> 0x18;
  if (uVar6 == 6) {
    iVar4 = FUN_004049b0(uVar2);
    if (iVar4 != 0) {
      uVar7 = FUN_00824a20(DAT_0172491c,0);
      local_c = 6;
      FUN_00405d70(uVar7);
      goto LAB_00883ad0;
    }
  }
  else if (uVar6 == 7) {
    iVar4 = FUN_004049b0(uVar2);
    if (iVar4 != 0) {
      cVar3 = (char)(uVar2 >> 0x10);
      if ((cVar3 != '\n') && (cVar3 != '\x14')) {
        *(undefined4 *)(in_ECX + 0x68) = 1;
      }
      uVar7 = FUN_00824a20(DAT_0172491c,0);
      local_c = 0;
      FUN_00405d70(uVar7);
      goto LAB_00883ad0;
    }
  }
  else if ((uVar6 == 0x14) && (local_ec[0] = FUN_004049b0(uVar2), local_ec[0] != 0)) {
    uVar7 = FUN_00824a20(DAT_0172491c,0);
    local_c = 1;
    FUN_00405d70(uVar7);
    local_c = 0xffffffff;
    FUN_00406560();
    FUN_00406460(&DAT_00c45310);
    local_c = 2;
    if (*(short *)(local_ec[0] + 0x14e) != 0) {
      local_f4 = 0x28;
      iVar4 = FUN_00407c10(&local_f4,1);
      local_f4 = 0x29;
      iVar5 = FUN_00407c10(&local_f4,1);
      if ((iVar4 != -1) && (iVar5 != -1)) {
        FUN_00405e10(iVar4,iVar5);
      }
    }
    cVar3 = FUN_009a0960(local_38);
    if (cVar3 != '\0') {
      FUN_00403510(local_a8);
      local_c._0_1_ = 3;
      FUN_00403450(local_c4,local_38);
      local_c._0_1_ = 4;
      uVar7 = FUN_00403510(local_8c);
      local_c._0_1_ = 5;
      FUN_00405d70(uVar7);
      local_c._0_1_ = 4;
      FUN_00406560();
      local_c._0_1_ = 3;
      FUN_00406560();
      local_c = CONCAT31(local_c._1_3_,2);
      FUN_00406560();
      in_ECX[0x54] = 1;
    }
    sVar1 = *(short *)(in_ECX + 6);
    if (sVar1 == 0x143e) {
      local_c = 0xffffffff;
      FUN_00406560();
      goto LAB_00883b5d;
    }
    if (sVar1 == 0x1410) {
      *in_ECX = *(undefined1 *)(local_ec[0] + 0x1ba);
    }
    else if (sVar1 == 0x1435) {
      *in_ECX = *(undefined1 *)(local_ec[0] + 0x198);
    }
LAB_00883ad0:
    local_c = 0xffffffff;
    FUN_00406560();
  }
  iVar4 = local_e4;
  local_f4 = *(int *)(in_ECX + 0xc);
  piVar8 = (int *)FUN_004437f0(&local_f4);
  if (*piVar8 == *(int *)(iVar4 + 0x30)) {
    iVar4 = 0;
  }
  else {
    iVar4 = *(int *)(*piVar8 + 0x10);
  }
  if (iVar4 == 0) {
    local_f4 = FUN_006f0300(0x28);
    local_c = 7;
    if (local_f4 == 0) {
      iVar4 = 0;
    }
    else {
      iVar4 = FUN_00882410(local_f4);
    }
    local_c = 0xffffffff;
    local_f4 = *(int *)(in_ECX + 0xc);
    local_f0 = iVar4;
    FUN_00451e00(local_ec,&local_f4);
  }
  FUN_008831b0(iVar4);
LAB_00883b5d:
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)&local_f4);
  return;
}



============================================================
DISASSEMBLY
============================================================
00883670 : PUSH EBP
00883671 : MOV EBP,ESP
00883673 : AND ESP,0xfffffff8
00883676 : PUSH -0x1
00883678 : PUSH 0xb5f786
0088367d : MOV EAX,FS:[0x0]
00883683 : PUSH EAX
00883684 : SUB ESP,0xe0
0088368a : MOV EAX,[0x00d66fa0]
0088368f : XOR EAX,ESP
00883691 : MOV dword ptr [ESP + 0xd8],EAX
00883698 : PUSH EBX
00883699 : PUSH ESI
0088369a : PUSH EDI
0088369b : MOV EAX,[0x00d66fa0]
008836a0 : XOR EAX,ESP
008836a2 : PUSH EAX
008836a3 : LEA EAX,[ESP + 0xf0]
008836aa : MOV FS:[0x0],EAX
008836b0 : MOV EAX,dword ptr [EBP + 0x8]
008836b3 : MOV EDI,ECX
008836b5 : MOV ESI,dword ptr [EDI + 0xc]
008836b8 : MOV ECX,dword ptr [0x00da93ec]
008836be : PUSH ESI
008836bf : MOV dword ptr [ESP + 0x24],EAX
008836c3 : MOV dword ptr [ESP + 0x1c],ECX
008836c7 : CALL 0x00a1a840
008836cc : MOV EBX,EAX
008836ce : TEST EBX,EBX
008836d0 : JNZ 0x008836ee
008836d2 : MOV ECX,dword ptr [ESP + 0x18]
008836d6 : PUSH ESI
008836d7 : CALL 0x00a1a6d0
008836dc : MOV EBX,EAX
008836de : TEST EBX,EBX
008836e0 : JNZ 0x008836ee
008836e2 : MOV ECX,dword ptr [ESP + 0x18]
008836e6 : PUSH ESI
008836e7 : CALL 0x00a1a780
008836ec : MOV EBX,EAX
008836ee : MOV EAX,dword ptr [EDI + 0x10]
008836f1 : MOV ECX,dword ptr [0x00da93ec]
008836f7 : PUSH EAX
008836f8 : MOV dword ptr [ESP + 0x14],ECX
008836fc : MOV dword ptr [ESP + 0x1c],EAX
00883700 : CALL 0x00a1a840
00883705 : MOV ESI,EAX
00883707 : TEST ESI,ESI
00883709 : JNZ 0x0088372f
0088370b : MOV ECX,dword ptr [ESP + 0x18]
0088370f : PUSH ECX
00883710 : MOV ECX,dword ptr [ESP + 0x14]
00883714 : CALL 0x00a1a6d0
00883719 : MOV ESI,EAX
0088371b : TEST ESI,ESI
0088371d : JNZ 0x0088372f
0088371f : MOV EDX,dword ptr [ESP + 0x18]
00883723 : MOV ECX,dword ptr [ESP + 0x10]
00883727 : PUSH EDX
00883728 : CALL 0x00a1a780
0088372d : MOV ESI,EAX
0088372f : TEST EBX,EBX
00883731 : JZ 0x00883b5d
00883737 : MOV EAX,[0x00da9894]
0088373c : MOV EAX,dword ptr [EAX]
0088373e : CMP dword ptr [EAX + 0x2a0],0x0
00883745 : JZ 0x00883754
00883747 : MOV EAX,dword ptr [EAX + 0x2a0]
0088374d : PUSH EDI
0088374e : PUSH EAX
0088374f : CALL 0x009abc00
00883754 : MOV ECX,dword ptr [EDI + 0xc]
00883757 : PUSH ECX
00883758 : CALL 0x00882380
0088375d : TEST AL,AL
0088375f : JNZ 0x008837a4
00883761 : MOV EDX,dword ptr [EDI + 0x10]
00883764 : PUSH EDX
00883765 : CALL 0x00882380
0088376a : TEST AL,AL
0088376c : JNZ 0x008837a4
0088376e : MOV EAX,dword ptr [EDI + 0xc]
00883771 : PUSH EAX
00883772 : CALL 0x008822f0
00883777 : TEST AL,AL
00883779 : JNZ 0x008837a4
0088377b : MOV ECX,dword ptr [EDI + 0x10]
0088377e : PUSH ECX
0088377f : CALL 0x008822f0
00883784 : TEST AL,AL
00883786 : JZ 0x00883b5d
0088378c : MOV EDX,dword ptr [0x0172491c]
00883792 : MOV EAX,dword ptr [EDX + 0x17c]
00883798 : MOV EAX,dword ptr [EAX + 0x4]
0088379b : CMP dword ptr [EDI + 0xc],EAX
0088379e : JNZ 0x00883b5d
008837a4 : CMP dword ptr [0x017248cc],0x0
008837ab : JZ 0x00883b5d
008837b1 : MOV ECX,EDI
008837b3 : CALL 0x00881fd0
008837b8 : TEST AL,AL
008837ba : JZ 0x00883b5d
008837c0 : TEST ESI,ESI
008837c2 : JZ 0x008837ef
008837c4 : MOV EAX,[0x00da93ec]
008837c9 : CMP byte ptr [EAX + 0x1d5],0x0
008837d0 : LEA ECX,[EDI + 0x1c]
008837d3 : JZ 0x008837e2
008837d5 : PUSH ECX
008837d6 : MOV EDX,0xc4530c
008837db : CALL 0x00405c00
008837e0 : JMP 0x008837ef
008837e2 : PUSH -0x1
008837e4 : PUSH 0x0
008837e6 : ADD ESI,0xc
008837e9 : PUSH ESI
008837ea : CALL 0x00405eb0
008837ef : CMP dword ptr [EDI + 0x68],0x17
008837f3 : JNZ 0x008837f9
008837f5 : MOV byte ptr [EDI + 0x55],0x1
008837f9 : MOV ESI,dword ptr [EDI + 0x4]
008837fc : MOV EAX,ESI
008837fe : SHR EAX,0x18
00883801 : MOVZX EAX,AL
00883804 : SUB EAX,0x6
00883807 : JZ 0x00883a8b
0088380d : MOV EBX,0x1
00883812 : SUB EAX,EBX
00883814 : JZ 0x00883a2d
0088381a : SUB EAX,0xd
0088381d : JNZ 0x00883ad5
00883823 : PUSH ESI
00883824 : CALL 0x004049b0
00883829 : ADD ESP,0x4
0088382c : MOV dword ptr [ESP + 0x18],EAX
00883830 : TEST EAX,EAX
00883832 : JZ 0x00883ad5
00883838 : LEA EDX,[EAX + 0x18]
0088383b : MOV EAX,[0x0172491c]
00883840 : PUSH 0x0
00883842 : PUSH EAX
00883843 : LEA ESI,[ESP + 0x2c]
00883847 : CALL 0x00824a20
0088384c : MOV dword ptr [ESP + 0xf8],EBX
00883853 : LEA EBX,[EDI + 0x38]
00883856 : PUSH EAX
00883857 : MOV ECX,EBX
00883859 : CALL 0x00405d70
0088385e : MOV dword ptr [ESP + 0xf8],0xffffffff
00883869 : MOV ECX,ESI
0088386b : CALL 0x00406560
00883870 : PUSH 0xc45310
00883875 : LEA ECX,[ESP + 0xd0]
0088387c : CALL 0x00406460
00883881 : MOV dword ptr [ESP + 0xf8],0x2
0088388c : MOV ECX,dword ptr [ESP + 0x18]
00883890 : CMP word ptr [ECX + 0x14e],0x0
00883898 : JZ 0x008838df
0088389a : PUSH 0x1
0088389c : LEA EDX,[ESP + 0x14]
008838a0 : PUSH EDX
008838a1 : XOR EAX,EAX
008838a3 : MOV EDX,EBX
008838a5 : MOV dword ptr [ESP + 0x18],0x28
008838ad : CALL 0x00407c10
008838b2 : MOV ESI,EAX
008838b4 : PUSH 0x1
008838b6 : LEA EAX,[ESP + 0x14]
008838ba : PUSH EAX
008838bb : XOR EAX,EAX
008838bd : MOV EDX,EBX
008838bf : MOV dword ptr [ESP + 0x18],0x29
008838c7 : CALL 0x00407c10
008838cc : CMP ESI,-0x1
008838cf : JZ 0x008838df
008838d1 : CMP EAX,-0x1
008838d4 : JZ 0x008838df
008838d6 : PUSH EAX
008838d7 : PUSH ESI
008838d8 : MOV ECX,EBX
008838da : CALL 0x00405e10
008838df : MOV ECX,dword ptr [0x00da9894]
008838e5 : MOV EAX,dword ptr [ECX]
008838e7 : MOV EAX,dword ptr [EAX + 0x130]
008838ed : TEST EAX,EAX
008838ef : JZ 0x008838f4
008838f1 : MOV EAX,dword ptr [EAX + 0x3c]
008838f4 : MOV ECX,dword ptr [ESP + 0x18]
008838f8 : MOVZX ESI,word ptr [ECX + 0x6]
008838fc : LEA EDX,[ESP + 0xcc]
00883903 : PUSH EDX
00883904 : MOV EDX,EAX
00883906 : CALL 0x009a0960
0088390b : TEST AL,AL
0088390d : JZ 0x008839a9
00883913 : LEA EDX,[ESP + 0x5c]
00883917 : PUSH EDX
00883918 : MOV EDX,0xc45318
0088391d : MOV ECX,EBX
0088391f : CALL 0x00403510
00883924 : ADD ESP,0x4
00883927 : MOV byte ptr [ESP + 0xf8],0x3
0088392f : LEA ECX,[ESP + 0xcc]
00883936 : PUSH ECX
00883937 : LEA EDX,[ESP + 0x44]
0088393b : PUSH EDX
0088393c : MOV ECX,EAX
0088393e : CALL 0x00403450
00883943 : MOV byte ptr [ESP + 0x100],0x4
0088394b : LEA ECX,[ESP + 0x80]
00883952 : PUSH ECX
00883953 : MOV EDX,0xc45314
00883958 : MOV ECX,EAX
0088395a : CALL 0x00403510
0088395f : ADD ESP,0xc
00883962 : MOV byte ptr [ESP + 0xf8],0x5
0088396a : PUSH EAX
0088396b : MOV ECX,EBX
0088396d : CALL 0x00405d70
00883972 : MOV byte ptr [ESP + 0xf8],0x4
0088397a : LEA ECX,[ESP + 0x78]
0088397e : CALL 0x00406560
00883983 : MOV byte ptr [ESP + 0xf8],0x3
0088398b : LEA ECX,[ESP + 0x40]
0088398f : CALL 0x00406560
00883994 : MOV byte ptr [ESP + 0xf8],0x2
0088399c : LEA ECX,[ESP + 0x5c]
008839a0 : CALL 0x00406560
008839a5 : MOV byte ptr [EDI + 0x54],0x1
008839a9 : MOVZX EAX,word ptr [EDI + 0x6]
008839ad : MOV EDX,0x143e
008839b2 : CMP AX,DX
008839b5 : JNZ 0x008839d3
008839b7 : MOV dword ptr [ESP + 0xf8],0xffffffff
008839c2 : LEA ECX,[ESP + 0xcc]
008839c9 : CALL 0x00406560
008839ce : JMP 0x00883b5d
008839d3 : MOV ECX,0x1410
008839d8 : CMP AX,CX
008839db : JNZ 0x00883a00
008839dd : MOV EDX,dword ptr [ESP + 0x18]
008839e1 : MOV AL,byte ptr [EDX + 0x1ba]
008839e7 : MOV byte ptr [EDI],AL
008839e9 : MOV dword ptr [ESP + 0xf8],0xffffffff
008839f4 : LEA ECX,[ESP + 0xcc]
008839fb : JMP 0x00883ad0
00883a00 : MOV ECX,0x1435
00883a05 : CMP AX,CX
00883a08 : JNZ 0x00883a16
00883a0a : MOV EDX,dword ptr [ESP + 0x18]
00883a0e : MOV AL,byte ptr [EDX + 0x198]
00883a14 : MOV byte ptr [EDI],AL
00883a16 : MOV dword ptr [ESP + 0xf8],0xffffffff
00883a21 : LEA ECX,[ESP + 0xcc]
00883a28 : JMP 0x00883ad0
00883a2d : PUSH ESI
00883a2e : CALL 0x004049b0
00883a33 : ADD ESP,0x4
00883a36 : TEST EAX,EAX
00883a38 : JZ 0x00883ad5
00883a3e : MOV ECX,ESI
00883a40 : SHR ECX,0x10
00883a43 : CMP CL,0xa
00883a46 : JZ 0x00883a50
00883a48 : CMP CL,0x14
00883a4b : JZ 0x00883a50
00883a4d : MOV dword ptr [EDI + 0x68],EBX
00883a50 : MOV ECX,dword ptr [0x0172491c]
00883a56 : PUSH 0x0
00883a58 : LEA EDX,[EAX + 0x18]
00883a5b : PUSH ECX
00883a5c : LEA ESI,[ESP + 0x9c]
00883a63 : CALL 0x00824a20
00883a68 : MOV dword ptr [ESP + 0xf8],0x0
00883a73 : PUSH EAX
00883a74 : LEA ECX,[EDI + 0x38]
00883a77 : CALL 0x00405d70
00883a7c : MOV dword ptr [ESP + 0xf8],0xffffffff
00883a87 : MOV ECX,ESI
00883a89 : JMP 0x00883ad0
00883a8b : PUSH ESI
00883a8c : CALL 0x004049b0
00883a91 : ADD ESP,0x4
00883a94 : TEST EAX,EAX
00883a96 : JZ 0x00883ad5
00883a98 : LEA EDX,[EAX + 0x18]
00883a9b : MOV EAX,[0x0172491c]
00883aa0 : PUSH 0x0
00883aa2 : PUSH EAX
00883aa3 : LEA ESI,[ESP + 0xb8]
00883aaa : CALL 0x00824a20
00883aaf : MOV dword ptr [ESP + 0xf8],0x6
00883aba : PUSH EAX
00883abb : LEA ECX,[EDI + 0x38]
00883abe : CALL 0x00405d70
00883ac3 : MOV dword ptr [ESP + 0xf8],0xffffffff
00883ace : MOV ECX,ESI
00883ad0 : CALL 0x00406560
00883ad5 : MOV ESI,dword ptr [ESP + 0x20]
00883ad9 : MOV ECX,dword ptr [EDI + 0xc]
00883adc : LEA EDX,[ESP + 0x10]
00883ae0 : MOV dword ptr [ESP + 0x10],ECX
00883ae4 : LEA EBX,[ESI + 0x2c]
00883ae7 : PUSH EDX
00883ae8 : LEA EAX,[ESP + 0x24]
00883aec : MOV ECX,EBX
00883aee : CALL 0x004437f0
00883af3 : MOV EAX,dword ptr [EAX]
00883af5 : CMP EAX,dword ptr [ESI + 0x30]
00883af8 : JZ 0x00883aff
00883afa : MOV EAX,dword ptr [EAX + 0x10]
00883afd : JMP 0x00883b01
00883aff : XOR EAX,EAX
00883b01 : MOV ESI,EAX
00883b03 : TEST EAX,EAX
00883b05 : JNZ 0x00883b57
00883b07 : PUSH 0x28
00883b09 : CALL 0x006f0300
00883b0e : ADD ESP,0x4
00883b11 : MOV dword ptr [ESP + 0x10],EAX
00883b15 : MOV dword ptr [ESP + 0xf8],0x7
00883b20 : TEST EAX,EAX
00883b22 : JZ 0x00883b2c
00883b24 : PUSH EAX
00883b25 : CALL 0x00882410
00883b2a : JMP 0x00883b2e
00883b2c : XOR EAX,EAX
00883b2e : MOV dword ptr [ESP + 0xf8],0xffffffff
00883b39 : MOV ECX,dword ptr [EDI + 0xc]
00883b3c : MOV ESI,EAX
00883b3e : MOV dword ptr [ESP + 0x14],EAX
00883b42 : LEA EDX,[ESP + 0x10]
00883b46 : PUSH EDX
00883b47 : LEA EAX,[ESP + 0x1c]
00883b4b : PUSH EAX
00883b4c : MOV EAX,EBX
00883b4e : MOV dword ptr [ESP + 0x18],ECX
00883b52 : CALL 0x00451e00
00883b57 : PUSH ESI
00883b58 : CALL 0x008831b0
00883b5d : MOV ECX,dword ptr [ESP + 0xf0]
00883b64 : MOV dword ptr FS:[0x0],ECX
00883b6b : POP ECX
00883b6c : POP EDI
00883b6d : POP ESI
00883b6e : POP EBX
00883b6f : MOV ECX,dword ptr [ESP + 0xd8]
00883b76 : XOR ECX,ESP
00883b78 : CALL 0x00633e6b
00883b7d : MOV ESP,EBP
00883b7f : POP EBP
00883b80 : RET 0x4

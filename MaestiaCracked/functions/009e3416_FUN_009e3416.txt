PROGRAM  : Maestia.exe
FUNCTION : FUN_009e3416
ENTRY    : 009e3416
BODY     : [[009e3416, 009e3527] [009e35b8, 009e3612]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x009e3254) */

void FUN_009e3416(void)

{
  undefined4 uVar1;
  uint uVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  int iVar5;
  int *piVar6;
  int iVar7;
  undefined4 *puVar8;
  int iVar9;
  int *piVar10;
  uint uVar11;
  uint unaff_EBP;
  int unaff_EDI;
  
  do {
    *(undefined4 *)(unaff_EBP - 0x4c) = 0;
    iVar7 = *(int *)(unaff_EBP - 0x3c);
    piVar6 = (int *)FUN_00413b60(unaff_EBP - 0x4c);
    iVar9 = *piVar6;
    *(int *)(unaff_EBP - 0x4c) = iVar9;
    if (iVar9 == *(int *)(iVar7 + 0x20)) {
      *(undefined4 *)(unaff_EBP - 0x60) = 0;
      *(undefined1 *)(unaff_EBP - 4) = 0xc;
      iVar7 = FUN_006f0300(0x10);
      *(int *)(unaff_EBP - 0x38) = iVar7;
      *(undefined1 *)(unaff_EBP - 4) = 0xd;
      if (iVar7 == 0) {
        iVar7 = 0;
      }
      else {
        *(undefined4 *)(iVar7 + 4) = 0;
        *(undefined4 *)(iVar7 + 8) = 0;
        *(undefined4 *)(iVar7 + 0xc) = 0;
      }
      *(undefined1 *)(unaff_EBP - 4) = 0xc;
      *(int *)(unaff_EBP - 0x60) = iVar7;
      *(undefined4 *)(unaff_EBP - 4) = 2;
      iVar9 = *(int *)(iVar7 + 4);
      if ((iVar9 == 0) ||
         ((uint)(*(int *)(iVar7 + 0xc) - iVar9 >> 2) <= (uint)(*(int *)(iVar7 + 8) - iVar9 >> 2))) {
        FUN_0042fe80(iVar7,*(undefined4 *)(iVar7 + 8),unaff_EBP - 0x40);
      }
      else {
        piVar6 = *(int **)(iVar7 + 8);
        iVar9 = 1;
        piVar10 = piVar6;
        do {
          *piVar10 = unaff_EDI;
          iVar9 = iVar9 + -1;
          piVar10 = piVar10 + 1;
        } while (iVar9 != 0);
        *(int **)(iVar7 + 8) = piVar6 + 1;
      }
      *(undefined2 *)(unaff_EBP - 0x74) = 0;
      *(int *)(unaff_EBP - 0x70) = iVar7;
      FUN_0041ed30(unaff_EBP - 0xf8,unaff_EBP - 0x74);
      *(undefined2 *)(unaff_EBP - 0x84) = 0;
      *(undefined4 *)(unaff_EBP - 0x80) = 0xffffffff;
      *(undefined2 *)(unaff_EBP - 0xbc) = 0;
      *(undefined8 *)(unaff_EBP - 0xb8) = *(undefined8 *)(unaff_EBP - 0x84);
      *(undefined4 *)(unaff_EBP - 0xb0) = 0xffffffff;
      FUN_00414ca0(unaff_EBP - 0xf0,unaff_EBP - 0xbc);
      FUN_009e3613();
      return;
    }
    iVar7 = *(int *)(iVar9 + 0x10);
    if (iVar7 != 0) {
      piVar6 = *(int **)(iVar7 + 8);
      iVar9 = *(int *)(iVar7 + 4);
      if ((iVar9 != 0) &&
         ((uint)((int)piVar6 - iVar9 >> 2) < (uint)(*(int *)(iVar7 + 0xc) - iVar9 >> 2))) {
        iVar9 = 1;
        piVar10 = piVar6;
        do {
          *piVar10 = unaff_EDI;
          iVar9 = iVar9 + -1;
          piVar10 = piVar10 + 1;
        } while (iVar9 != 0);
        *(int **)(iVar7 + 8) = piVar6 + 1;
        FUN_009e3613();
        return;
      }
      FUN_0042fe80(iVar7,piVar6,unaff_EBP - 0x40);
      FUN_009e3613();
      return;
    }
    if (unaff_EDI != 0) {
      FUN_00414770(unaff_EDI);
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    *(undefined4 *)(unaff_EBP - 4) = 0xffffffff;
    if (7 < *(uint *)(unaff_EBP - 0x1c)) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    *(undefined4 *)(unaff_EBP - 0x1c) = 7;
    *(undefined4 *)(unaff_EBP - 0x20) = 0;
    *(undefined2 *)(unaff_EBP - 0x30) = 0;
    *(int *)(unaff_EBP - 0x54) = *(int *)(unaff_EBP - 0x54) + 1;
    iVar7 = *(int *)(unaff_EBP - 0x54);
    while( true ) {
      if (0xfffe < iVar7) {
        ExceptionList = *(void **)(unaff_EBP - 0xc);
        __security_check_cookie(*(uint *)(unaff_EBP - 0x18) ^ unaff_EBP);
        return;
      }
      piVar6 = (int *)FUN_00703c00(0x600);
      if ((piVar6 != (int *)0x0) && (*(char *)((int)piVar6 + 5) == '\x06')) break;
      *(int *)(unaff_EBP - 0x54) = *(int *)(unaff_EBP - 0x54) + 1;
      iVar7 = *(int *)(unaff_EBP - 0x54);
    }
    FUN_0040eef0(piVar6 + 6);
    *(undefined4 *)(unaff_EBP - 4) = 0;
    FUN_00824120(DAT_0172491c);
    *(undefined1 *)(unaff_EBP - 4) = 2;
    if (7 < *(uint *)(unaff_EBP - 0xc0)) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    *(undefined4 *)(unaff_EBP - 0xc0) = 7;
    iVar9 = 0;
    *(undefined4 *)(unaff_EBP - 0xc4) = 0;
    *(undefined2 *)(unaff_EBP - 0xd4) = 0;
    *(undefined4 *)(unaff_EBP - 0x44) = 0;
    *(undefined4 *)(unaff_EBP - 0x40) = 0;
    *(undefined1 *)(unaff_EBP - 4) = 3;
    iVar7 = FUN_006f0300(0x30);
    *(int *)(unaff_EBP - 0x50) = iVar7;
    *(undefined1 *)(unaff_EBP - 4) = 4;
    if (iVar7 == 0) {
      uVar4 = 0;
    }
    else {
      uVar4 = FUN_004191e0(iVar7,*(undefined2 *)((int)piVar6 + 6),unaff_EBP - 0x34);
    }
    *(undefined1 *)(unaff_EBP - 4) = 3;
    *(undefined4 *)(unaff_EBP - 0x44) = uVar4;
    iVar7 = FUN_006f0300(0x30);
    *(int *)(unaff_EBP - 0x50) = iVar7;
    *(undefined1 *)(unaff_EBP - 4) = 5;
    if (iVar7 != 0) {
      iVar9 = FUN_004191e0(iVar7,*(undefined2 *)((int)piVar6 + 6),unaff_EBP - 0x34);
    }
    *(undefined1 *)(unaff_EBP - 4) = 3;
    *(int *)(unaff_EBP - 0x40) = iVar9;
    *(undefined4 *)(unaff_EBP - 4) = 2;
    *(uint *)(unaff_EBP - 0x58) = (uint)*(ushort *)(piVar6 + 1);
    iVar7 = **(int **)(*(int *)(unaff_EBP - 0x3c) + 0x68);
    *(int *)(unaff_EBP - 0x50) = iVar7;
    iVar5 = (**(code **)(*piVar6 + 0x3c))();
    if (iVar5 != 0) {
      iVar5 = (**(code **)(*piVar6 + 0x68))();
      if (iVar5 == 0) {
        uVar11 = piVar6[99];
        if (((uVar11 >> 6 & 1) == 0) && ((uVar11 >> 10 & 1) == 0)) {
          if ((((((uVar11 >> 0xe & 1) == 0) && ((uVar11 >> 0xf & 1) == 0)) &&
               ((uVar11 >> 0x10 & 1) == 0)) &&
              (((uVar11 >> 0x11 & 1) == 0 && ((uVar11 >> 0x12 & 1) == 0)))) &&
             ((uVar11 >> 0x13 & 1) == 0)) {
            uVar11 = FUN_006fec70();
            *(uint *)(iVar9 + 0x28) = uVar11 & 0xff;
          }
          else {
            *(undefined4 *)(unaff_EBP - 0x58) = 0x8c;
            *(undefined4 *)(iVar9 + 0x28) = 0xe;
          }
        }
        else {
          *(undefined4 *)(iVar9 + 0x28) = 6;
        }
      }
      else {
        *(uint *)(iVar9 + 0x24) = (uint)*(byte *)(piVar6 + 0xa2);
      }
    }
    unaff_EDI = *(int *)(unaff_EBP - 0x40);
    if (iVar7 != *(int *)(*(int *)(unaff_EBP - 0x3c) + 0x68)) {
      do {
        if ((*(short *)(unaff_EBP - 0x58) == *(short *)(iVar7 + 0x10)) &&
           (((iVar9 = (**(code **)(*piVar6 + 0x3c))(), iVar9 == 0 ||
             ((*(int *)(unaff_EDI + 0x24) != -1 &&
              (*(int *)(iVar7 + 0x14) == *(int *)(unaff_EDI + 0x24))))) ||
            ((*(int *)(unaff_EDI + 0x28) != -1 &&
             (*(int *)(iVar7 + 0x18) == *(int *)(unaff_EDI + 0x28))))))) {
          uVar11 = (uint)*(ushort *)(iVar7 + 0xc);
          *(uint *)(unaff_EBP - 0x48) = uVar11;
          goto LAB_009e3257;
        }
        FUN_004192a0();
        iVar7 = *(int *)(unaff_EBP - 0x50);
      } while (iVar7 != *(int *)(*(int *)(unaff_EBP - 0x3c) + 0x68));
    }
    uVar4 = *(undefined4 *)(unaff_EDI + 0x28);
    uVar1 = *(undefined4 *)(unaff_EDI + 0x24);
    *(undefined2 *)(unaff_EBP - 0xa8) = *(undefined2 *)(unaff_EBP - 0x58);
    *(undefined4 *)(unaff_EBP - 0xa4) = uVar1;
    uVar2 = *(uint *)(unaff_EBP - 100);
    uVar11 = uVar2 & 0xffff;
    *(uint *)(unaff_EBP - 0x48) = uVar11;
    *(uint *)(unaff_EBP - 100) = uVar2 + 1;
    *(short *)(unaff_EBP - 0x98) = (short)uVar2;
    *(undefined8 *)(unaff_EBP - 0x94) = *(undefined8 *)(unaff_EBP - 0xa8);
    *(undefined4 *)(unaff_EBP - 0x8c) = uVar4;
    FUN_00414ca0(unaff_EBP - 0xe0,unaff_EBP - 0x98);
LAB_009e3257:
    iVar7 = *(int *)(unaff_EBP - 0x3c);
    FUN_00413b60(unaff_EBP - 0x48);
    if (*(int *)(unaff_EBP - 0x4c) == *(int *)(iVar7 + 0x20)) {
      *(undefined4 *)(unaff_EBP - 0x5c) = 0;
      *(undefined1 *)(unaff_EBP - 4) = 8;
      iVar7 = FUN_006f0300(0x10);
      *(int *)(unaff_EBP - 0x38) = iVar7;
      *(undefined1 *)(unaff_EBP - 4) = 9;
      if (iVar7 == 0) {
        iVar7 = 0;
      }
      else {
        *(undefined4 *)(iVar7 + 4) = 0;
        *(undefined4 *)(iVar7 + 8) = 0;
        *(undefined4 *)(iVar7 + 0xc) = 0;
      }
      *(undefined1 *)(unaff_EBP - 4) = 8;
      *(int *)(unaff_EBP - 0x5c) = iVar7;
      *(undefined4 *)(unaff_EBP - 4) = 2;
      iVar9 = *(int *)(iVar7 + 4);
      if ((iVar9 == 0) ||
         ((uint)(*(int *)(iVar7 + 0xc) - iVar9 >> 2) <= (uint)(*(int *)(iVar7 + 8) - iVar9 >> 2))) {
        FUN_0042fe80(iVar7,*(undefined4 *)(iVar7 + 8),unaff_EBP - 0x44);
      }
      else {
        puVar3 = *(undefined4 **)(iVar7 + 8);
        iVar9 = 1;
        uVar4 = *(undefined4 *)(unaff_EBP - 0x44);
        puVar8 = puVar3;
        do {
          *puVar8 = uVar4;
          iVar9 = iVar9 + -1;
          puVar8 = puVar8 + 1;
        } while (iVar9 != 0);
        *(undefined4 **)(iVar7 + 8) = puVar3 + 1;
      }
      *(short *)(unaff_EBP - 0x6c) = (short)uVar11;
      *(int *)(unaff_EBP - 0x68) = iVar7;
      FUN_0041ed30(unaff_EBP - 0xe8,unaff_EBP - 0x6c);
      FUN_009e3416();
      return;
    }
    iVar7 = *(int *)(*(int *)(unaff_EBP - 0x4c) + 0x10);
    if (iVar7 != 0) {
      puVar3 = *(undefined4 **)(iVar7 + 8);
      iVar9 = *(int *)(iVar7 + 4);
      if ((iVar9 != 0) &&
         ((uint)((int)puVar3 - iVar9 >> 2) < (uint)(*(int *)(iVar7 + 0xc) - iVar9 >> 2))) {
        iVar9 = 1;
        uVar4 = *(undefined4 *)(unaff_EBP - 0x44);
        puVar8 = puVar3;
        do {
          *puVar8 = uVar4;
          iVar9 = iVar9 + -1;
          puVar8 = puVar8 + 1;
        } while (iVar9 != 0);
        *(undefined4 **)(iVar7 + 8) = puVar3 + 1;
        FUN_009e3416();
        return;
      }
      FUN_0042fe80(iVar7,puVar3,unaff_EBP - 0x44);
      FUN_009e3416();
      return;
    }
    if (*(int *)(unaff_EBP - 0x44) != 0) {
      FUN_00414770(*(int *)(unaff_EBP - 0x44));
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
009e3416 : XOR EBX,EBX
009e3418 : MOV dword ptr [EBP + -0x4c],EBX
009e341b : LEA ECX,[EBP + -0x4c]
009e341e : PUSH ECX
009e341f : MOV ESI,dword ptr [EBP + -0x3c]
009e3422 : LEA ECX,[ESI + 0x1c]
009e3425 : LEA EAX,[EBP + 0xffffff78]
009e342b : CALL 0x00413b60
009e3430 : MOV EAX,dword ptr [EAX]
009e3432 : MOV dword ptr [EBP + -0x4c],EAX
009e3435 : CMP EAX,dword ptr [ESI + 0x20]
009e3438 : JNZ 0x009e35b8
009e343e : MOV dword ptr [EBP + -0x60],EBX
009e3441 : MOV byte ptr [EBP + -0x4],0xc
009e3445 : PUSH 0x10
009e3447 : CALL 0x006f0300
009e344c : ADD ESP,0x4
009e344f : MOV dword ptr [EBP + -0x38],EAX
009e3452 : MOV byte ptr [EBP + -0x4],0xd
009e3456 : CMP EAX,EBX
009e3458 : JZ 0x009e3465
009e345a : MOV dword ptr [EAX + 0x4],EBX
009e345d : MOV dword ptr [EAX + 0x8],EBX
009e3460 : MOV dword ptr [EAX + 0xc],EBX
009e3463 : JMP 0x009e3467
009e3465 : XOR EAX,EAX
009e3467 : MOV byte ptr [EBP + -0x4],0xc
009e346b : MOV EBX,EAX
009e346d : MOV dword ptr [EBP + -0x60],EBX
009e3470 : MOV dword ptr [EBP + -0x4],0x2
009e3477 : MOV ESI,dword ptr [EAX + 0x4]
009e347a : MOV ECX,dword ptr [EAX + 0x8]
009e347d : SUB ECX,ESI
009e347f : SAR ECX,0x2
009e3482 : TEST ESI,ESI
009e3484 : JZ 0x009e34b2
009e3486 : MOV EDX,dword ptr [EAX + 0xc]
009e3489 : SUB EDX,ESI
009e348b : SAR EDX,0x2
009e348e : CMP ECX,EDX
009e3490 : JNC 0x009e34b2
009e3492 : MOV EAX,dword ptr [EAX + 0x8]
009e3495 : MOV ECX,0x1
009e349a : MOV EDX,EAX
009e349c : LEA ESP,[ESP]
009e34a0 : MOV dword ptr [EDX],EDI
009e34a2 : DEC ECX
009e34a3 : ADD EDX,0x4
009e34a6 : TEST ECX,ECX
009e34a8 : JA 0x009e34a0
009e34aa : ADD EAX,0x4
009e34ad : MOV dword ptr [EBX + 0x8],EAX
009e34b0 : JMP 0x009e34c0
009e34b2 : MOV ECX,dword ptr [EAX + 0x8]
009e34b5 : LEA EDX,[EBP + -0x40]
009e34b8 : PUSH EDX
009e34b9 : PUSH ECX
009e34ba : PUSH EAX
009e34bb : CALL 0x0042fe80
009e34c0 : XOR EAX,EAX
009e34c2 : MOV word ptr [EBP + -0x74],AX
009e34c6 : MOV dword ptr [EBP + -0x70],EBX
009e34c9 : LEA ECX,[EBP + -0x74]
009e34cc : PUSH ECX
009e34cd : LEA EDX,[EBP + 0xffffff08]
009e34d3 : PUSH EDX
009e34d4 : MOV ESI,dword ptr [EBP + -0x3c]
009e34d7 : LEA EAX,[ESI + 0x1c]
009e34da : CALL 0x0041ed30
009e34df : XOR EAX,EAX
009e34e1 : MOV word ptr [EBP + 0xffffff7c],AX
009e34e8 : OR EAX,0xffffffff
009e34eb : MOV dword ptr [EBP + -0x80],EAX
009e34ee : XOR ECX,ECX
009e34f0 : MOV word ptr [EBP + 0xffffff44],CX
009e34f7 : MOVQ XMM0,qword ptr [EBP + 0xffffff7c]
009e34ff : MOVQ qword ptr [EBP + 0xffffff48],XMM0
009e3507 : MOV dword ptr [EBP + 0xffffff50],EAX
009e350d : LEA EDX,[EBP + 0xffffff44]
009e3513 : PUSH EDX
009e3514 : LEA EAX,[EBP + 0xffffff10]
009e351a : PUSH EAX
009e351b : LEA EAX,[ESI + 0x64]
009e351e : CALL 0x00414ca0
009e3523 : JMP 0x009e3613
009e35b8 : MOV ESI,dword ptr [EAX + 0x10]
009e35bb : CMP ESI,EBX
009e35bd : JZ 0x009e3602
009e35bf : MOV EBX,dword ptr [ESI + 0x8]
009e35c2 : MOV EDX,dword ptr [ESI + 0x4]
009e35c5 : MOV EAX,EBX
009e35c7 : SUB EAX,EDX
009e35c9 : SAR EAX,0x2
009e35cc : TEST EDX,EDX
009e35ce : JZ 0x009e35f5
009e35d0 : MOV ECX,dword ptr [ESI + 0xc]
009e35d3 : SUB ECX,EDX
009e35d5 : SAR ECX,0x2
009e35d8 : CMP EAX,ECX
009e35da : JNC 0x009e35f5
009e35dc : MOV EAX,0x1
009e35e1 : MOV ECX,EBX
009e35e3 : MOV dword ptr [ECX],EDI
009e35e5 : DEC EAX
009e35e6 : ADD ECX,0x4
009e35e9 : TEST EAX,EAX
009e35eb : JA 0x009e35e3
009e35ed : ADD EBX,0x4
009e35f0 : MOV dword ptr [ESI + 0x8],EBX
009e35f3 : JMP 0x009e3613
009e35f5 : LEA EAX,[EBP + -0x40]
009e35f8 : PUSH EAX
009e35f9 : PUSH EBX
009e35fa : PUSH ESI
009e35fb : CALL 0x0042fe80
009e3600 : JMP 0x009e3613
009e3602 : CMP EDI,EBX
009e3604 : JZ 0x009e3613
009e3606 : PUSH EDI
009e3607 : CALL 0x00414770
009e360c : MOV ECX,EDI
009e360e : CALL 0x006f04e0

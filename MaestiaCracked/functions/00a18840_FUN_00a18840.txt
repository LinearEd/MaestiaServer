PROGRAM  : Maestia.exe
FUNCTION : FUN_00a18840
ENTRY    : 00a18840
BODY     : [[00a18840, 00a18979]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a18840(int *param_1,undefined4 param_2)

{
  int *piVar1;
  int iVar2;
  uint uVar3;
  int *piVar4;
  int *piVar5;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b0de58;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  iVar2 = (**(code **)(*param_1 + 0x1c))(DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
  if (iVar2 == 2) {
    uVar3 = 0;
    piVar5 = param_1 + 0xad;
    do {
      if ((uVar3 < 2) && (*piVar5 != 0)) {
        *(undefined4 *)(*piVar5 + 0x1bc) = param_2;
      }
      uVar3 = uVar3 + 1;
      piVar5 = piVar5 + 1;
    } while ((int)uVar3 < 2);
  }
  iVar2 = (**(code **)(*param_1 + 0x44))();
  if (iVar2 != 0) {
    iVar2 = (**(code **)(*param_1 + 0x48))();
    piVar5 = (int *)**(int **)(iVar2 + 8);
    iVar2 = (**(code **)(*param_1 + 0x48))();
    if (piVar5 != *(int **)(iVar2 + 8)) {
      do {
        piVar1 = (int *)piVar5[9];
        if (piVar1 != (int *)0x0) {
          iVar2 = (**(code **)(*piVar1 + 0x1c))();
          if (iVar2 == 2) {
            if (piVar1[2] != 0) {
              EnterCriticalSection((LPCRITICAL_SECTION)(piVar1[2] + 4));
            }
            if ((piVar1[99] != 0) && (piVar4 = *(int **)piVar1[0x62], piVar4 != (int *)piVar1[0x62])
               ) {
              do {
                if (piVar4[9] != 0) {
                  *(undefined4 *)(piVar4[9] + 0x1bc) = param_2;
                }
                piVar4 = (int *)*piVar4;
              } while (piVar4 != (int *)piVar1[0x62]);
            }
            local_8 = 0xffffffff;
            if (piVar1[2] != 0) {
              LeaveCriticalSection((LPCRITICAL_SECTION)(piVar1[2] + 4));
            }
          }
          else {
            (**(code **)(*piVar1 + 0x1c))();
          }
        }
        piVar5 = (int *)*piVar5;
        iVar2 = (**(code **)(*param_1 + 0x48))();
      } while (piVar5 != (int *)*(int *)(iVar2 + 8));
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00a18840 : PUSH EBP
00a18841 : MOV EBP,ESP
00a18843 : PUSH -0x1
00a18845 : PUSH 0xb0de58
00a1884a : MOV EAX,FS:[0x0]
00a18850 : PUSH EAX
00a18851 : PUSH EBX
00a18852 : PUSH ESI
00a18853 : PUSH EDI
00a18854 : MOV EAX,[0x00d66fa0]
00a18859 : XOR EAX,EBP
00a1885b : PUSH EAX
00a1885c : LEA EAX,[EBP + -0xc]
00a1885f : MOV FS:[0x0],EAX
00a18865 : MOV EBX,dword ptr [EBP + 0x8]
00a18868 : MOV EAX,dword ptr [EBX]
00a1886a : MOV EDX,dword ptr [EAX + 0x1c]
00a1886d : MOV ECX,EBX
00a1886f : CALL EDX
00a18871 : CMP EAX,0x2
00a18874 : JNZ 0x00a1889d
00a18876 : XOR EAX,EAX
00a18878 : LEA EDX,[EBX + 0x2b4]
00a1887e : MOV EDI,EDI
00a18880 : CMP EAX,0x1
00a18883 : JA 0x00a18894
00a18885 : MOV ECX,dword ptr [EDX]
00a18887 : TEST ECX,ECX
00a18889 : JZ 0x00a18894
00a1888b : MOV ESI,dword ptr [EBP + 0xc]
00a1888e : MOV dword ptr [ECX + 0x1bc],ESI
00a18894 : INC EAX
00a18895 : ADD EDX,0x4
00a18898 : CMP EAX,0x2
00a1889b : JL 0x00a18880
00a1889d : MOV EAX,dword ptr [EBX]
00a1889f : MOV EDX,dword ptr [EAX + 0x44]
00a188a2 : MOV ECX,EBX
00a188a4 : CALL EDX
00a188a6 : TEST EAX,EAX
00a188a8 : JZ 0x00a18966
00a188ae : MOV EAX,dword ptr [EBX]
00a188b0 : MOV EDX,dword ptr [EAX + 0x48]
00a188b3 : MOV ECX,EBX
00a188b5 : CALL EDX
00a188b7 : MOV EAX,dword ptr [EAX + 0x8]
00a188ba : MOV EDI,dword ptr [EAX]
00a188bc : MOV EAX,dword ptr [EBX]
00a188be : MOV EDX,dword ptr [EAX + 0x48]
00a188c1 : MOV ECX,EBX
00a188c3 : CALL EDX
00a188c5 : CMP EDI,dword ptr [EAX + 0x8]
00a188c8 : JZ 0x00a18966
00a188ce : MOV EDI,EDI
00a188d0 : MOV ESI,dword ptr [EDI + 0x24]
00a188d3 : TEST ESI,ESI
00a188d5 : JZ 0x00a18952
00a188d7 : MOV EAX,dword ptr [ESI]
00a188d9 : MOV EDX,dword ptr [EAX + 0x1c]
00a188dc : MOV ECX,ESI
00a188de : CALL EDX
00a188e0 : CMP EAX,0x2
00a188e3 : JNZ 0x00a18949
00a188e5 : MOV EAX,dword ptr [ESI + 0x8]
00a188e8 : MOV dword ptr [EBP + 0x8],ESI
00a188eb : TEST EAX,EAX
00a188ed : JZ 0x00a188f9
00a188ef : ADD EAX,0x4
00a188f2 : PUSH EAX
00a188f3 : CALL dword ptr [0x00b85118]
00a188f9 : MOV dword ptr [EBP + -0x4],0x0
00a18900 : CMP dword ptr [ESI + 0x18c],0x0
00a18907 : JZ 0x00a1892f
00a18909 : MOV ECX,dword ptr [ESI + 0x188]
00a1890f : MOV EAX,dword ptr [ECX]
00a18911 : CMP EAX,ECX
00a18913 : JZ 0x00a1892f
00a18915 : MOV ECX,dword ptr [EAX + 0x24]
00a18918 : TEST ECX,ECX
00a1891a : JZ 0x00a18925
00a1891c : MOV EDX,dword ptr [EBP + 0xc]
00a1891f : MOV dword ptr [ECX + 0x1bc],EDX
00a18925 : MOV EAX,dword ptr [EAX]
00a18927 : CMP EAX,dword ptr [ESI + 0x188]
00a1892d : JNZ 0x00a18915
00a1892f : MOV dword ptr [EBP + -0x4],0xffffffff
00a18936 : MOV ESI,dword ptr [ESI + 0x8]
00a18939 : TEST ESI,ESI
00a1893b : JZ 0x00a18952
00a1893d : ADD ESI,0x4
00a18940 : PUSH ESI
00a18941 : CALL dword ptr [0x00b8511c]
00a18947 : JMP 0x00a18952
00a18949 : MOV EAX,dword ptr [ESI]
00a1894b : MOV EDX,dword ptr [EAX + 0x1c]
00a1894e : MOV ECX,ESI
00a18950 : CALL EDX
00a18952 : MOV EAX,dword ptr [EBX]
00a18954 : MOV EDX,dword ptr [EAX + 0x48]
00a18957 : MOV EDI,dword ptr [EDI]
00a18959 : MOV ECX,EBX
00a1895b : CALL EDX
00a1895d : CMP EDI,dword ptr [EAX + 0x8]
00a18960 : JNZ 0x00a188d0
00a18966 : MOV ECX,dword ptr [EBP + -0xc]
00a18969 : MOV dword ptr FS:[0x0],ECX
00a18970 : POP ECX
00a18971 : POP EDI
00a18972 : POP ESI
00a18973 : POP EBX
00a18974 : MOV ESP,EBP
00a18976 : POP EBP
00a18977 : RET 0x8

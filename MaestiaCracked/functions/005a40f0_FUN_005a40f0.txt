PROGRAM  : Maestia.exe
FUNCTION : FUN_005a40f0
ENTRY    : 005a40f0
BODY     : [[005a40f0, 005a41d9] [005a41e0, 005a4233]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005a40f0(undefined4 param_1,uint *param_2,uint param_3)

{
  uint *puVar1;
  uint *puVar2;
  int *piVar3;
  int iVar4;
  uint uVar5;
  int *in_ECX;
  uint uVar6;
  int iVar7;
  
  piVar3 = (int *)*in_ECX;
  if (piVar3 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar3 * 5) <= piVar3[1] * 4 + 4U) goto LAB_005a412a;
    iVar7 = piVar3[1] * 2 + 2;
  }
  FUN_005a3d60(param_1,iVar7);
LAB_005a412a:
  piVar3 = (int *)*in_ECX;
  param_3 = param_3 & piVar3[1];
  *piVar3 = *piVar3 + 1;
  iVar7 = *in_ECX;
  iVar4 = *(int *)(iVar7 + 8 + param_3 * 0x14);
  puVar1 = (uint *)(iVar7 + 8 + param_3 * 0x14);
  if (iVar4 == -2) {
    *puVar1 = 0xffffffff;
    puVar1[2] = *param_2;
    puVar1[3] = param_2[1];
    puVar1[4] = param_2[2];
    puVar1[1] = param_3;
    return;
  }
  uVar6 = param_3;
  do {
    uVar6 = uVar6 + 1 & *(uint *)(iVar7 + 4);
  } while (*(int *)(iVar7 + 8 + uVar6 * 0x14) != -2);
  piVar3 = (int *)(iVar7 + 8 + uVar6 * 0x14);
  uVar5 = puVar1[1];
  if (uVar5 == param_3) {
    if (piVar3 != (int *)0x0) {
      *piVar3 = iVar4;
      piVar3[1] = puVar1[1];
      piVar3[2] = puVar1[2];
      piVar3[3] = puVar1[3];
      piVar3[4] = puVar1[4];
    }
    puVar1[2] = *param_2;
    puVar1[3] = param_2[1];
    puVar1[4] = param_2[2];
    *puVar1 = uVar6;
    puVar1[1] = param_3;
    return;
  }
  puVar2 = (uint *)(iVar7 + 8 + uVar5 * 0x14);
  for (uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x14); uVar5 != param_3;
      uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x14)) {
    uVar5 = *puVar2;
    puVar2 = (uint *)(iVar7 + 8 + uVar5 * 0x14);
  }
  if (piVar3 != (int *)0x0) {
    *piVar3 = iVar4;
    piVar3[1] = puVar1[1];
    piVar3[2] = puVar1[2];
    piVar3[3] = puVar1[3];
    piVar3[4] = puVar1[4];
  }
  *puVar2 = uVar6;
  puVar1[2] = *param_2;
  puVar1[3] = param_2[1];
  puVar1[4] = param_2[2];
  *puVar1 = 0xffffffff;
  puVar1[1] = param_3;
  return;
}



============================================================
DISASSEMBLY
============================================================
005a40f0 : PUSH EBP
005a40f1 : PUSH ESI
005a40f2 : MOV ESI,ECX
005a40f4 : MOV EAX,dword ptr [ESI]
005a40f6 : TEST EAX,EAX
005a40f8 : JNZ 0x005a4103
005a40fa : MOV EAX,dword ptr [ESP + 0xc]
005a40fe : PUSH 0x8
005a4100 : PUSH EAX
005a4101 : JMP 0x005a4125
005a4103 : MOV ECX,dword ptr [EAX + 0x4]
005a4106 : LEA EDX,[ECX*0x4 + 0x4]
005a410d : MOV ECX,dword ptr [EAX]
005a410f : LEA ECX,[ECX + ECX*0x4]
005a4112 : CMP ECX,EDX
005a4114 : JBE 0x005a412a
005a4116 : MOV EDX,dword ptr [EAX + 0x4]
005a4119 : MOV ECX,dword ptr [ESP + 0xc]
005a411d : LEA EAX,[EDX + EDX*0x1 + 0x2]
005a4121 : PUSH EAX
005a4122 : PUSH ECX
005a4123 : MOV ECX,ESI
005a4125 : CALL 0x005a3d60
005a412a : MOV EAX,dword ptr [ESI]
005a412c : MOV ECX,dword ptr [ESP + 0x14]
005a4130 : AND ECX,dword ptr [EAX + 0x4]
005a4133 : INC dword ptr [EAX]
005a4135 : MOV ESI,dword ptr [ESI]
005a4137 : LEA EDX,[ECX + ECX*0x4]
005a413a : MOV EBP,dword ptr [ESI + EDX*0x4 + 0x8]
005a413e : LEA EAX,[ESI + EDX*0x4 + 0x8]
005a4142 : CMP EBP,-0x2
005a4145 : JNZ 0x005a416a
005a4147 : MOV EDX,dword ptr [ESP + 0x10]
005a414b : MOV dword ptr [EAX],0xffffffff
005a4151 : MOV ESI,dword ptr [EDX]
005a4153 : MOV dword ptr [EAX + 0x8],ESI
005a4156 : MOV ESI,dword ptr [EDX + 0x4]
005a4159 : MOV dword ptr [EAX + 0xc],ESI
005a415c : MOV EDX,dword ptr [EDX + 0x8]
005a415f : POP ESI
005a4160 : MOV dword ptr [EAX + 0x10],EDX
005a4163 : MOV dword ptr [EAX + 0x4],ECX
005a4166 : POP EBP
005a4167 : RET 0xc
005a416a : PUSH EDI
005a416b : MOV EDI,dword ptr [ESI + 0x4]
005a416e : MOV EDX,ECX
005a4170 : PUSH EBX
005a4171 : INC EDX
005a4172 : AND EDX,EDI
005a4174 : LEA EBX,[EDX + EDX*0x4]
005a4177 : CMP dword ptr [ESI + EBX*0x4 + 0x8],-0x2
005a417c : JNZ 0x005a4171
005a417e : LEA EDI,[EDX + EDX*0x4]
005a4181 : LEA EBX,[ESI + EDI*0x4 + 0x8]
005a4185 : MOV EDI,dword ptr [EAX + 0x4]
005a4188 : CMP EDI,ECX
005a418a : JNZ 0x005a41cb
005a418c : TEST EBX,EBX
005a418e : JZ 0x005a41aa
005a4190 : MOV dword ptr [EBX],EBP
005a4192 : MOV ESI,dword ptr [EAX + 0x4]
005a4195 : MOV dword ptr [EBX + 0x4],ESI
005a4198 : MOV ESI,dword ptr [EAX + 0x8]
005a419b : MOV dword ptr [EBX + 0x8],ESI
005a419e : MOV ESI,dword ptr [EAX + 0xc]
005a41a1 : MOV dword ptr [EBX + 0xc],ESI
005a41a4 : MOV ESI,dword ptr [EAX + 0x10]
005a41a7 : MOV dword ptr [EBX + 0x10],ESI
005a41aa : MOV ESI,dword ptr [ESP + 0x18]
005a41ae : MOV EDI,dword ptr [ESI]
005a41b0 : MOV dword ptr [EAX + 0x8],EDI
005a41b3 : MOV EDI,dword ptr [ESI + 0x4]
005a41b6 : MOV dword ptr [EAX + 0xc],EDI
005a41b9 : MOV ESI,dword ptr [ESI + 0x8]
005a41bc : POP EBX
005a41bd : POP EDI
005a41be : MOV dword ptr [EAX + 0x10],ESI
005a41c1 : POP ESI
005a41c2 : MOV dword ptr [EAX],EDX
005a41c4 : MOV dword ptr [EAX + 0x4],ECX
005a41c7 : POP EBP
005a41c8 : RET 0xc
005a41cb : LEA EDI,[EDI + EDI*0x4]
005a41ce : CMP dword ptr [ESI + EDI*0x4 + 0x8],ECX
005a41d2 : LEA EDI,[ESI + EDI*0x4 + 0x8]
005a41d6 : JZ 0x005a41ef
005a41d8 : JMP 0x005a41e0
005a41e0 : MOV EDI,dword ptr [EDI]
005a41e2 : LEA EDI,[EDI + EDI*0x4]
005a41e5 : CMP dword ptr [ESI + EDI*0x4 + 0x8],ECX
005a41e9 : LEA EDI,[ESI + EDI*0x4 + 0x8]
005a41ed : JNZ 0x005a41e0
005a41ef : TEST EBX,EBX
005a41f1 : JZ 0x005a420d
005a41f3 : MOV dword ptr [EBX],EBP
005a41f5 : MOV ESI,dword ptr [EAX + 0x4]
005a41f8 : MOV dword ptr [EBX + 0x4],ESI
005a41fb : MOV ESI,dword ptr [EAX + 0x8]
005a41fe : MOV dword ptr [EBX + 0x8],ESI
005a4201 : MOV ESI,dword ptr [EAX + 0xc]
005a4204 : MOV dword ptr [EBX + 0xc],ESI
005a4207 : MOV ESI,dword ptr [EAX + 0x10]
005a420a : MOV dword ptr [EBX + 0x10],ESI
005a420d : MOV dword ptr [EDI],EDX
005a420f : MOV EDX,dword ptr [ESP + 0x18]
005a4213 : MOV ESI,dword ptr [EDX]
005a4215 : MOV dword ptr [EAX + 0x8],ESI
005a4218 : MOV ESI,dword ptr [EDX + 0x4]
005a421b : POP EBX
005a421c : MOV dword ptr [EAX + 0xc],ESI
005a421f : MOV EDX,dword ptr [EDX + 0x8]
005a4222 : POP EDI
005a4223 : POP ESI
005a4224 : MOV dword ptr [EAX + 0x10],EDX
005a4227 : MOV dword ptr [EAX],0xffffffff
005a422d : MOV dword ptr [EAX + 0x4],ECX
005a4230 : POP EBP
005a4231 : RET 0xc

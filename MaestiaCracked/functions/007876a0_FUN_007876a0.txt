PROGRAM  : Maestia.exe
FUNCTION : FUN_007876a0
ENTRY    : 007876a0
BODY     : [[007876a0, 00787823]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_007876a0(int param_1,int param_2,int param_3,uint param_4)

{
  char cVar1;
  int *piVar2;
  uint uVar3;
  uint uVar4;
  int *in_ECX;
  int iVar5;
  
  if ((in_ECX[9] != 0) && (*(int *)(in_ECX[9] + 0xf0) != 0)) {
    (**(code **)(*in_ECX + 0x3c))();
    in_ECX[10] = param_1;
    in_ECX[0xb] = param_2;
    in_ECX[0xc] = param_4;
    *(undefined1 *)(in_ECX + 8) = 1;
    piVar2 = *(int **)(in_ECX[9] + 0xf0);
    cVar1 = *(char *)(in_ECX[9] + 0x28a);
    iVar5 = param_4 + 1;
    uVar3 = (**(code **)(*piVar2 + 0x5c))
                      (piVar2,param_1,param_2,iVar5,-(uint)(cVar1 != '\0') & 0x200,0x1c,
                       cVar1 == '\0',in_ECX + 0x12,0);
    piVar2 = *(int **)(in_ECX[9] + 0xf0);
    cVar1 = *(char *)(in_ECX[9] + 0x28a);
    uVar4 = (**(code **)(*piVar2 + 0x5c))
                      (piVar2,param_1 >> 1,param_2 >> 1,iVar5,-(uint)(cVar1 != '\0') & 0x200,0x1c,
                       cVar1 == '\0',in_ECX + 0x14,0);
    piVar2 = *(int **)(in_ECX[9] + 0xf0);
    cVar1 = *(char *)(in_ECX[9] + 0x28a);
    param_4 = (**(code **)(*piVar2 + 0x5c))
                        (piVar2,param_1 >> 1,param_2 >> 1,iVar5,-(uint)(cVar1 != '\0') & 0x200,0x1c,
                         cVar1 == '\0',in_ECX + 0x15,0);
    param_4 = uVar3 | uVar4 | param_4;
    if (param_3 == 1) {
      *(undefined1 *)(in_ECX + 0x13) = 1;
      piVar2 = *(int **)(in_ECX[9] + 0xf0);
      cVar1 = *(char *)(in_ECX[9] + 0x28a);
      uVar3 = (**(code **)(*piVar2 + 0x5c))
                        (piVar2,param_1,param_2,iVar5,-(uint)(cVar1 != '\0') & 0x200,0x1c,
                         cVar1 == '\0',in_ECX + 0x16,0);
      param_4 = param_4 | uVar3;
    }
    else {
      *(undefined1 *)(in_ECX + 0x13) = 0;
    }
    if (param_4 == 0) {
      return 1;
    }
    (**(code **)(*in_ECX + 0x3c))();
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
007876a0 : PUSH EBP
007876a1 : MOV EBP,ESP
007876a3 : SUB ESP,0x8
007876a6 : PUSH ESI
007876a7 : MOV ESI,ECX
007876a9 : MOV EAX,dword ptr [ESI + 0x24]
007876ac : TEST EAX,EAX
007876ae : JZ 0x00787812
007876b4 : CMP dword ptr [EAX + 0xf0],0x0
007876bb : JZ 0x00787812
007876c1 : MOV EAX,dword ptr [ESI]
007876c3 : MOV EDX,dword ptr [EAX + 0x3c]
007876c6 : PUSH EBX
007876c7 : PUSH EDI
007876c8 : CALL EDX
007876ca : MOV EAX,dword ptr [EBP + 0x8]
007876cd : MOV ECX,dword ptr [EBP + 0xc]
007876d0 : MOV EDI,dword ptr [EBP + 0x14]
007876d3 : MOV dword ptr [ESI + 0x28],EAX
007876d6 : MOV EAX,dword ptr [ESI + 0x24]
007876d9 : PUSH 0x0
007876db : MOV dword ptr [ESI + 0x2c],ECX
007876de : MOV dword ptr [ESI + 0x30],EDI
007876e1 : MOV byte ptr [ESI + 0x20],0x1
007876e5 : MOV ECX,dword ptr [EAX + 0xf0]
007876eb : MOV AL,byte ptr [EAX + 0x28a]
007876f1 : MOV EDX,dword ptr [ECX]
007876f3 : LEA EBX,[ESI + 0x48]
007876f6 : PUSH EBX
007876f7 : XOR EBX,EBX
007876f9 : INC EDI
007876fa : TEST AL,AL
007876fc : SETZ BL
007876ff : MOVZX EAX,AL
00787702 : NEG EAX
00787704 : SBB EAX,EAX
00787706 : AND EAX,0x200
0078770b : PUSH EBX
0078770c : MOV EBX,dword ptr [EBP + 0xc]
0078770f : PUSH 0x1c
00787711 : PUSH EAX
00787712 : MOV EAX,dword ptr [EBP + 0x8]
00787715 : PUSH EDI
00787716 : PUSH EBX
00787717 : PUSH EAX
00787718 : PUSH ECX
00787719 : MOV ECX,dword ptr [EDX + 0x5c]
0078771c : CALL ECX
0078771e : MOV EDX,dword ptr [EBP + 0x8]
00787721 : MOV dword ptr [EBP + 0x14],EAX
00787724 : MOV EAX,dword ptr [ESI + 0x24]
00787727 : MOV ECX,dword ptr [EAX + 0xf0]
0078772d : MOV AL,byte ptr [EAX + 0x28a]
00787733 : SAR EDX,0x1
00787735 : PUSH 0x0
00787737 : MOV dword ptr [EBP + -0x8],ECX
0078773a : MOV dword ptr [EBP + -0x4],EDX
0078773d : MOV EDX,dword ptr [ECX]
0078773f : LEA ECX,[ESI + 0x50]
00787742 : PUSH ECX
00787743 : XOR ECX,ECX
00787745 : SAR EBX,0x1
00787747 : TEST AL,AL
00787749 : SETZ CL
0078774c : MOVZX EAX,AL
0078774f : NEG EAX
00787751 : SBB EAX,EAX
00787753 : AND EAX,0x200
00787758 : PUSH ECX
00787759 : MOV ECX,dword ptr [EBP + -0x4]
0078775c : PUSH 0x1c
0078775e : PUSH EAX
0078775f : MOV EAX,dword ptr [EBP + -0x8]
00787762 : PUSH EDI
00787763 : PUSH EBX
00787764 : PUSH ECX
00787765 : MOV ECX,dword ptr [EDX + 0x5c]
00787768 : PUSH EAX
00787769 : CALL ECX
0078776b : OR dword ptr [EBP + 0x14],EAX
0078776e : MOV EAX,dword ptr [ESI + 0x24]
00787771 : MOV ECX,dword ptr [EAX + 0xf0]
00787777 : MOV EDX,dword ptr [ECX]
00787779 : MOV AL,byte ptr [EAX + 0x28a]
0078777f : MOV dword ptr [EBP + -0x8],ECX
00787782 : LEA ECX,[ESI + 0x54]
00787785 : PUSH 0x0
00787787 : PUSH ECX
00787788 : XOR ECX,ECX
0078778a : TEST AL,AL
0078778c : SETZ CL
0078778f : MOVZX EAX,AL
00787792 : PUSH ECX
00787793 : MOV ECX,dword ptr [EBP + -0x4]
00787796 : NEG EAX
00787798 : PUSH 0x1c
0078779a : SBB EAX,EAX
0078779c : AND EAX,0x200
007877a1 : PUSH EAX
007877a2 : MOV EAX,dword ptr [EBP + -0x8]
007877a5 : PUSH EDI
007877a6 : PUSH EBX
007877a7 : PUSH ECX
007877a8 : MOV ECX,dword ptr [EDX + 0x5c]
007877ab : PUSH EAX
007877ac : CALL ECX
007877ae : OR dword ptr [EBP + 0x14],EAX
007877b1 : CMP dword ptr [EBP + 0x10],0x1
007877b5 : JNZ 0x007877fd
007877b7 : MOV EAX,dword ptr [ESI + 0x24]
007877ba : PUSH 0x0
007877bc : MOV byte ptr [ESI + 0x4c],0x1
007877c0 : MOV ECX,dword ptr [EAX + 0xf0]
007877c6 : MOV AL,byte ptr [EAX + 0x28a]
007877cc : MOV EDX,dword ptr [ECX]
007877ce : LEA EBX,[ESI + 0x58]
007877d1 : PUSH EBX
007877d2 : XOR EBX,EBX
007877d4 : TEST AL,AL
007877d6 : SETZ BL
007877d9 : MOVZX EAX,AL
007877dc : NEG EAX
007877de : SBB EAX,EAX
007877e0 : AND EAX,0x200
007877e5 : PUSH EBX
007877e6 : PUSH 0x1c
007877e8 : PUSH EAX
007877e9 : MOV EAX,dword ptr [EBP + 0xc]
007877ec : PUSH EDI
007877ed : PUSH EAX
007877ee : MOV EAX,dword ptr [EBP + 0x8]
007877f1 : PUSH EAX
007877f2 : PUSH ECX
007877f3 : MOV ECX,dword ptr [EDX + 0x5c]
007877f6 : CALL ECX
007877f8 : OR dword ptr [EBP + 0x14],EAX
007877fb : JMP 0x00787801
007877fd : MOV byte ptr [ESI + 0x4c],0x0
00787801 : CMP dword ptr [EBP + 0x14],0x0
00787805 : POP EDI
00787806 : POP EBX
00787807 : JZ 0x0078781b
00787809 : MOV EDX,dword ptr [ESI]
0078780b : MOV EAX,dword ptr [EDX + 0x3c]
0078780e : MOV ECX,ESI
00787810 : CALL EAX
00787812 : XOR AL,AL
00787814 : POP ESI
00787815 : MOV ESP,EBP
00787817 : POP EBP
00787818 : RET 0x10
0078781b : MOV AL,0x1
0078781d : POP ESI
0078781e : MOV ESP,EBP
00787820 : POP EBP
00787821 : RET 0x10

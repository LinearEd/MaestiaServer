PROGRAM  : Maestia.exe
FUNCTION : FUN_00a288f0
ENTRY    : 00a288f0
BODY     : [[00a288f0, 00a28a13] [00a28a16, 00a28a4a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a288f0(void)

{
  rsize_t _DstSize;
  bool bVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int *_Dst;
  int unaff_EDI;
  int *local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b39465;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if (unaff_EDI == 0) {
    iVar2 = 0;
  }
  else {
    iVar2 = unaff_EDI + 0x18;
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(iVar2 + 4));
  local_8 = 0;
  if (((*(int *)(unaff_EDI + 0xa0) - *(int *)(unaff_EDI + 0x9c) & 0xfffffffcU) != 0) &&
     (_Dst = *(int **)(unaff_EDI + 0x9c), _Dst != *(int **)(unaff_EDI + 0xa0))) {
    local_18 = _Dst + 1;
    do {
      iVar4 = *(int *)(*_Dst + 8);
      bVar1 = false;
      if ((((iVar4 != -1) && (iVar3 = FUN_00a1a840(iVar4), iVar3 == 0)) &&
          (iVar3 = FUN_00a1a6d0(iVar4), iVar3 == 0)) && (iVar4 = FUN_00a1a780(iVar4), iVar4 == 0)) {
        bVar1 = true;
      }
      iVar4 = *_Dst;
      if (*(int *)(iVar4 + 4) == 0) {
LAB_00a289d5:
        if (bVar1) goto LAB_00a289db;
        _Dst = _Dst + 1;
        local_18 = local_18 + 1;
      }
      else {
        FUN_00a6b960(*(int *)(iVar4 + 4));
        iVar4 = *_Dst;
        iVar5 = *(int *)(*(int *)(iVar4 + 4) + 0x3c) - *(int *)(*(int *)(iVar4 + 4) + 0x38);
        iVar3 = iVar5 >> 0x1f;
        if (iVar5 / 0xc + iVar3 != iVar3) goto LAB_00a289d5;
LAB_00a289db:
        iVar3 = *(int *)(unaff_EDI + 0xa0) - (int)local_18 >> 2;
        if (0 < iVar3) {
          _DstSize = iVar3 * 4;
          _memmove_s(_Dst,_DstSize,local_18,_DstSize);
        }
        *(int *)(unaff_EDI + 0xa0) = *(int *)(unaff_EDI + 0xa0) + -4;
        FUN_0040eab0();
        if (iVar4 != 0) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
      }
    } while (_Dst != *(int **)(unaff_EDI + 0xa0));
  }
  local_8 = 0xffffffff;
  LeaveCriticalSection((LPCRITICAL_SECTION)(iVar2 + 4));
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00a288f0 : PUSH EBP
00a288f1 : MOV EBP,ESP
00a288f3 : PUSH -0x1
00a288f5 : PUSH 0xb39465
00a288fa : MOV EAX,FS:[0x0]
00a28900 : PUSH EAX
00a28901 : SUB ESP,0x10
00a28904 : PUSH EBX
00a28905 : PUSH ESI
00a28906 : MOV EAX,[0x00d66fa0]
00a2890b : XOR EAX,EBP
00a2890d : PUSH EAX
00a2890e : LEA EAX,[EBP + -0xc]
00a28911 : MOV FS:[0x0],EAX
00a28917 : TEST EDI,EDI
00a28919 : JZ 0x00a28920
00a2891b : LEA EAX,[EDI + 0x18]
00a2891e : JMP 0x00a28922
00a28920 : XOR EAX,EAX
00a28922 : LEA ESI,[EAX + 0x4]
00a28925 : PUSH ESI
00a28926 : MOV dword ptr [EBP + -0x1c],EAX
00a28929 : MOV dword ptr [EBP + -0x18],ESI
00a2892c : CALL dword ptr [0x00b85118]
00a28932 : MOV dword ptr [EBP + -0x4],0x0
00a28939 : MOV EAX,dword ptr [EDI + 0xa0]
00a2893f : SUB EAX,dword ptr [EDI + 0x9c]
00a28945 : TEST EAX,0xfffffffc
00a2894a : JZ 0x00a28a2c
00a28950 : MOV EBX,dword ptr [EDI + 0x9c]
00a28956 : MOV EAX,dword ptr [EDI + 0xa0]
00a2895c : CMP EBX,EAX
00a2895e : JZ 0x00a28a2c
00a28964 : LEA ECX,[EBX + 0x4]
00a28967 : MOV dword ptr [EBP + -0x14],ECX
00a2896a : LEA EBX,[EBX]
00a28970 : MOV EDX,dword ptr [EBX]
00a28972 : MOV ESI,dword ptr [EDX + 0x8]
00a28975 : MOV byte ptr [EBP + -0xd],0x0
00a28979 : CMP ESI,-0x1
00a2897c : JZ 0x00a289a6
00a2897e : PUSH ESI
00a2897f : MOV ECX,EDI
00a28981 : CALL 0x00a1a840
00a28986 : TEST EAX,EAX
00a28988 : JNZ 0x00a289a6
00a2898a : PUSH ESI
00a2898b : MOV ECX,EDI
00a2898d : CALL 0x00a1a6d0
00a28992 : TEST EAX,EAX
00a28994 : JNZ 0x00a289a6
00a28996 : PUSH ESI
00a28997 : MOV ECX,EDI
00a28999 : CALL 0x00a1a780
00a2899e : TEST EAX,EAX
00a289a0 : JNZ 0x00a289a6
00a289a2 : MOV byte ptr [EBP + -0xd],0x1
00a289a6 : MOV ESI,dword ptr [EBX]
00a289a8 : MOV EAX,dword ptr [ESI + 0x4]
00a289ab : TEST EAX,EAX
00a289ad : JZ 0x00a289d5
00a289af : PUSH EAX
00a289b0 : CALL 0x00a6b960
00a289b5 : MOV ESI,dword ptr [EBX]
00a289b7 : MOV EAX,dword ptr [ESI + 0x4]
00a289ba : MOV ECX,dword ptr [EAX + 0x3c]
00a289bd : SUB ECX,dword ptr [EAX + 0x38]
00a289c0 : ADD EAX,0x34
00a289c3 : MOV EAX,0x2aaaaaab
00a289c8 : IMUL ECX
00a289ca : SAR EDX,0x1
00a289cc : MOV EAX,EDX
00a289ce : SHR EAX,0x1f
00a289d1 : ADD EAX,EDX
00a289d3 : JZ 0x00a289db
00a289d5 : CMP byte ptr [EBP + -0xd],0x0
00a289d9 : JZ 0x00a28a16
00a289db : MOV EAX,dword ptr [EDI + 0xa0]
00a289e1 : MOV ECX,dword ptr [EBP + -0x14]
00a289e4 : SUB EAX,ECX
00a289e6 : SAR EAX,0x2
00a289e9 : TEST EAX,EAX
00a289eb : JLE 0x00a289fd
00a289ed : ADD EAX,EAX
00a289ef : ADD EAX,EAX
00a289f1 : PUSH EAX
00a289f2 : PUSH ECX
00a289f3 : PUSH EAX
00a289f4 : PUSH EBX
00a289f5 : CALL 0x00634101
00a289fa : ADD ESP,0x10
00a289fd : ADD dword ptr [EDI + 0xa0],-0x4
00a28a04 : CALL 0x0040eab0
00a28a09 : TEST ESI,ESI
00a28a0b : JZ 0x00a28a1d
00a28a0d : MOV ECX,ESI
00a28a0f : CALL 0x006f04e0
00a28a16 : ADD EBX,0x4
00a28a19 : ADD dword ptr [EBP + -0x14],0x4
00a28a1d : CMP EBX,dword ptr [EDI + 0xa0]
00a28a23 : JNZ 0x00a28970
00a28a29 : MOV ESI,dword ptr [EBP + -0x18]
00a28a2c : MOV dword ptr [EBP + -0x4],0xffffffff
00a28a33 : PUSH ESI
00a28a34 : CALL dword ptr [0x00b8511c]
00a28a3a : MOV ECX,dword ptr [EBP + -0xc]
00a28a3d : MOV dword ptr FS:[0x0],ECX
00a28a44 : POP ECX
00a28a45 : POP ESI
00a28a46 : POP EBX
00a28a47 : MOV ESP,EBP
00a28a49 : POP EBP
00a28a4a : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_005e2170
ENTRY    : 005e2170
BODY     : [[005e2170, 005e22f0]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005e2170(undefined4 param_1,uint param_2)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  int iVar4;
  int *in_ECX;
  int iVar5;
  int iVar6;
  int iVar7;
  float10 fVar8;
  longlong local_c;
  int *local_4;
  
  iVar7 = 0;
  if (param_2 == 0) {
    FUN_005e11e0();
    return;
  }
  local_4 = in_ECX;
  if (param_2 < 8) {
    iVar6 = 8;
  }
  else {
    fVar8 = (float10)FUN_0063b270();
    local_c = (longlong)ROUND((float)fVar8 / 0.6931472 + 1.0);
    iVar6 = 1 << ((byte)local_c & 0x1f);
  }
  local_c = CONCAT44(local_c._4_4_,2);
  puVar3 = (undefined4 *)FUN_00515d60(param_1,iVar6 * 0x14 + 8,&local_c);
  *puVar3 = 0;
  puVar3[1] = iVar6 + -1;
  if (iVar6 != 0) {
    iVar4 = 0;
    do {
      *(undefined4 *)(iVar4 + 8 + (int)puVar3) = 0xfffffffe;
      iVar4 = iVar4 + 0x14;
      iVar6 = iVar6 + -1;
    } while (iVar6 != 0);
  }
  if (*in_ECX != 0) {
    iVar6 = *(int *)(*in_ECX + 4) + 1;
    do {
      puVar2 = (undefined4 *)(iVar7 + 8 + *in_ECX);
      if (*(int *)(iVar7 + 8 + *in_ECX) != -2) {
        iVar4 = 4;
        iVar5 = 0x1505;
        do {
          iVar1 = iVar4 + -1;
          iVar4 = iVar4 + -1;
          iVar5 = iVar5 * 0x1003f + (uint)*(byte *)(iVar1 + (int)(puVar2 + 2));
        } while (iVar4 != 0);
        FUN_005e3e70(param_1,puVar2 + 2,iVar5);
        if ((puVar2[3] == 0) && (puVar2[4] != 0)) {
          FUN_00524240();
        }
        *puVar2 = 0xfffffffe;
        in_ECX = local_4;
      }
      iVar7 = iVar7 + 0x14;
      iVar6 = iVar6 + -1;
    } while (iVar6 != 0);
    FUN_00515cf0(*in_ECX);
  }
  *in_ECX = (int)puVar3;
  FUN_005e11e0();
  return;
}



============================================================
DISASSEMBLY
============================================================
005e2170 : SUB ESP,0xc
005e2173 : MOV EAX,dword ptr [ESP + 0x14]
005e2177 : PUSH EBP
005e2178 : PUSH EDI
005e2179 : XOR EDI,EDI
005e217b : MOV EBP,ECX
005e217d : MOV dword ptr [ESP + 0x10],EBP
005e2181 : CMP EAX,EDI
005e2183 : JNZ 0x005e2192
005e2185 : CALL 0x005e11e0
005e218a : POP EDI
005e218b : POP EBP
005e218c : ADD ESP,0xc
005e218f : RET 0x8
005e2192 : PUSH ESI
005e2193 : CMP EAX,0x8
005e2196 : JNC 0x005e219f
005e2198 : MOV ESI,0x8
005e219d : JMP 0x005e2204
005e219f : DEC EAX
005e21a0 : MOV dword ptr [ESP + 0x20],EAX
005e21a4 : FILD dword ptr [ESP + 0x20]
005e21a8 : TEST EAX,EAX
005e21aa : JGE 0x005e21b2
005e21ac : FADD float ptr [0x00cdf0e0]
005e21b2 : CALL 0x0063b270
005e21b7 : FSTP float ptr [ESP + 0x20]
005e21bb : FLD float ptr [ESP + 0x20]
005e21bf : MOV ESI,0x1
005e21c4 : FDIV double ptr [0x00b85fe0]
005e21ca : FSTP float ptr [ESP + 0x20]
005e21ce : FLD float ptr [ESP + 0x20]
005e21d2 : FADD double ptr [0x00cdf108]
005e21d8 : FSTP float ptr [ESP + 0x20]
005e21dc : FLD float ptr [ESP + 0x20]
005e21e0 : FNSTCW word ptr [ESP + 0x20]
005e21e4 : MOVZX EAX,word ptr [ESP + 0x20]
005e21e9 : OR EAX,0xc00
005e21ee : MOV dword ptr [ESP + 0xc],EAX
005e21f2 : FLDCW word ptr [ESP + 0xc]
005e21f6 : FISTP qword ptr [ESP + 0xc]
005e21fa : MOV CL,byte ptr [ESP + 0xc]
005e21fe : SHL ESI,CL
005e2200 : FLDCW word ptr [ESP + 0x20]
005e2204 : LEA EAX,[ESP + 0xc]
005e2208 : PUSH EAX
005e2209 : MOV EAX,dword ptr [ESP + 0x20]
005e220d : LEA ECX,[ESI + ESI*0x4]
005e2210 : LEA EDX,[ECX*0x4 + 0x8]
005e2217 : PUSH EDX
005e2218 : PUSH EAX
005e2219 : MOV dword ptr [ESP + 0x2c],EDI
005e221d : MOV dword ptr [ESP + 0x18],0x2
005e2225 : CALL 0x00515d60
005e222a : MOV dword ptr [ESP + 0x20],EAX
005e222e : MOV dword ptr [EAX],EDI
005e2230 : MOV EDX,dword ptr [ESP + 0x20]
005e2234 : LEA ECX,[ESI + -0x1]
005e2237 : MOV dword ptr [EDX + 0x4],ECX
005e223a : CMP ESI,EDI
005e223c : JBE 0x005e2254
005e223e : XOR EAX,EAX
005e2240 : MOV ECX,dword ptr [ESP + 0x20]
005e2244 : MOV dword ptr [EAX + ECX*0x1 + 0x8],0xfffffffe
005e224c : ADD EAX,0x14
005e224f : SUB ESI,0x1
005e2252 : JNZ 0x005e2240
005e2254 : MOV EAX,dword ptr [EBP]
005e2257 : CMP EAX,EDI
005e2259 : JZ 0x005e22d0
005e225b : MOV EAX,dword ptr [EAX + 0x4]
005e225e : PUSH EBX
005e225f : LEA EBX,[EAX + 0x1]
005e2262 : MOV EDX,dword ptr [EBP]
005e2265 : CMP dword ptr [EDI + EDX*0x1 + 0x8],-0x2
005e226a : LEA ESI,[EDI + EDX*0x1 + 0x8]
005e226e : JZ 0x005e22be
005e2270 : LEA EDX,[ESI + 0x8]
005e2273 : MOV EAX,0x4
005e2278 : MOV ECX,0x1505
005e227d : LEA ECX,[ECX]
005e2280 : MOVZX EBP,byte ptr [EAX + EDX*0x1 + -0x1]
005e2285 : IMUL ECX,ECX,0x1003f
005e228b : DEC EAX
005e228c : ADD ECX,EBP
005e228e : TEST EAX,EAX
005e2290 : JA 0x005e2280
005e2292 : MOV EAX,dword ptr [ESP + 0x20]
005e2296 : PUSH ECX
005e2297 : PUSH EDX
005e2298 : PUSH EAX
005e2299 : LEA ECX,[ESP + 0x30]
005e229d : CALL 0x005e3e70
005e22a2 : CMP dword ptr [ESI + 0xc],0x0
005e22a6 : JNZ 0x005e22b4
005e22a8 : MOV ECX,dword ptr [ESI + 0x10]
005e22ab : TEST ECX,ECX
005e22ad : JZ 0x005e22b4
005e22af : CALL 0x00524240
005e22b4 : MOV EBP,dword ptr [ESP + 0x18]
005e22b8 : MOV dword ptr [ESI],0xfffffffe
005e22be : ADD EDI,0x14
005e22c1 : SUB EBX,0x1
005e22c4 : JNZ 0x005e2262
005e22c6 : MOV ECX,dword ptr [EBP]
005e22c9 : PUSH ECX
005e22ca : CALL 0x00515cf0
005e22cf : POP EBX
005e22d0 : MOV EDX,dword ptr [ESP + 0x20]
005e22d4 : LEA ECX,[ESP + 0x20]
005e22d8 : MOV dword ptr [EBP],EDX
005e22db : MOV dword ptr [ESP + 0x20],0x0
005e22e3 : CALL 0x005e11e0
005e22e8 : POP ESI
005e22e9 : POP EDI
005e22ea : POP EBP
005e22eb : ADD ESP,0xc
005e22ee : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_0070b3f0
ENTRY    : 0070b3f0
BODY     : [[0070b3f0, 0070b706]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0070b3f0(undefined4 param_1,undefined4 param_2,int param_3)

{
  short sVar1;
  uint uVar2;
  int iVar3;
  short *psVar4;
  int in_ECX;
  LPCRITICAL_SECTION local_468;
  char *local_464;
  undefined4 local_460;
  int local_45c;
  undefined4 local_458;
  int local_454;
  undefined4 local_450;
  undefined2 local_448;
  undefined4 local_438;
  uint local_434;
  undefined2 local_42c;
  undefined4 local_41c;
  uint local_418;
  short local_414;
  undefined1 local_412 [1022];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b269f8;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_450 = param_1;
  local_468 = (LPCRITICAL_SECTION)(in_ECX + 8);
  local_454 = param_3;
  local_45c = 0;
  local_464 = ".\\MoLog.cpp";
  local_460 = 0x1fe;
  local_458 = 1;
  local_14 = uVar2;
  FUN_006ef1a0(&local_468);
  local_8 = 0;
  FUN_0070b300(1);
  local_448 = 0;
  local_434 = 7;
  local_438 = 0;
  FUN_00406360(L"----------------------[Error]----------------------",0x33);
  local_8._0_1_ = 1;
  FUN_0070ac20(uVar2);
  local_8._0_1_ = 0;
  if (7 < local_434) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_434 = 7;
  local_438 = 0;
  local_448 = 0;
  FUN_0070b300(1);
  FUN_0040e4a0(L"Function: %s, Line: %d",local_450,param_2);
  psVar4 = &local_414;
  local_42c = 0;
  local_418 = 7;
  local_41c = 0;
  do {
    sVar1 = *psVar4;
    psVar4 = psVar4 + 1;
  } while (sVar1 != 0);
  FUN_00406360(&local_414,(int)psVar4 - (int)local_412 >> 1);
  local_8._0_1_ = 2;
  FUN_0070ac20();
  local_8._0_1_ = 0;
  if (7 < local_418) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_418 = 7;
  local_41c = 0;
  local_42c = 0;
  FUN_0070b300(1);
  if (*(uint *)(local_454 + 0x18) < 8) {
    iVar3 = local_454 + 4;
  }
  else {
    iVar3 = *(int *)(local_454 + 4);
  }
  FUN_0040e4a0(L"Desc: %s",iVar3);
  psVar4 = &local_414;
  local_42c = 0;
  local_418 = 7;
  local_41c = 0;
  do {
    sVar1 = *psVar4;
    psVar4 = psVar4 + 1;
  } while (sVar1 != 0);
  FUN_00406360(&local_414,(int)psVar4 - (int)local_412 >> 1);
  local_8._0_1_ = 3;
  FUN_0070ac20();
  local_8._0_1_ = 0;
  if (7 < local_418) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_418 = 7;
  local_41c = 0;
  local_42c = 0;
  FUN_0070b300(1);
  local_434 = 7;
  local_438 = 0;
  local_448 = 0;
  FUN_00406360(L"---------------------------------------------------",0x33);
  local_8._0_1_ = 4;
  FUN_0070ac20();
  local_8 = (uint)local_8._1_3_ << 8;
  if (7 < local_434) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_434 = 7;
  local_438 = 0;
  local_448 = 0;
  FUN_0070b300(1);
  local_8 = 0xffffffff;
  if (local_45c != 0) {
    LeaveCriticalSection(local_468);
    local_45c = 0;
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0070b3f0 : PUSH EBP
0070b3f1 : MOV EBP,ESP
0070b3f3 : PUSH -0x1
0070b3f5 : PUSH 0xb269f8
0070b3fa : MOV EAX,FS:[0x0]
0070b400 : PUSH EAX
0070b401 : SUB ESP,0x458
0070b407 : MOV EAX,[0x00d66fa0]
0070b40c : XOR EAX,EBP
0070b40e : MOV dword ptr [EBP + -0x10],EAX
0070b411 : PUSH EBX
0070b412 : PUSH ESI
0070b413 : PUSH EDI
0070b414 : PUSH EAX
0070b415 : LEA EAX,[EBP + -0xc]
0070b418 : MOV FS:[0x0],EAX
0070b41e : MOV EAX,dword ptr [EBP + 0x8]
0070b421 : MOV EDI,ECX
0070b423 : MOV ECX,dword ptr [EBP + 0x10]
0070b426 : MOV dword ptr [EBP + 0xfffffbb4],EAX
0070b42c : LEA EAX,[EBP + 0xfffffb9c]
0070b432 : LEA EDX,[EDI + 0x8]
0070b435 : XOR EBX,EBX
0070b437 : PUSH EAX
0070b438 : MOV dword ptr [EBP + 0xfffffbb0],ECX
0070b43e : MOV dword ptr [EBP + 0xfffffba8],EBX
0070b444 : MOV dword ptr [EBP + 0xfffffb9c],EDX
0070b44a : MOV dword ptr [EBP + 0xfffffba0],0xbfd130
0070b454 : MOV dword ptr [EBP + 0xfffffba4],0x1fe
0070b45e : MOV dword ptr [EBP + 0xfffffbac],0x1
0070b468 : CALL 0x006ef1a0
0070b46d : MOV dword ptr [EBP + -0x4],EBX
0070b470 : PUSH 0x1
0070b472 : MOV ESI,EDI
0070b474 : CALL 0x0070b300
0070b479 : XOR ECX,ECX
0070b47b : PUSH 0x33
0070b47d : MOV word ptr [EBP + 0xfffffbbc],CX
0070b484 : PUSH 0xbfd150
0070b489 : LEA ECX,[EBP + 0xfffffbb8]
0070b48f : MOV dword ptr [EBP + 0xfffffbd0],0x7
0070b499 : MOV dword ptr [EBP + 0xfffffbcc],EBX
0070b49f : CALL 0x00406360
0070b4a4 : MOV byte ptr [EBP + -0x4],0x1
0070b4a8 : LEA ESI,[EBP + 0xfffffbb8]
0070b4ae : MOV EAX,EDI
0070b4b0 : CALL 0x0070ac20
0070b4b5 : MOV byte ptr [EBP + -0x4],BL
0070b4b8 : CMP dword ptr [EBP + 0xfffffbd0],0x8
0070b4bf : JC 0x0070b4cc
0070b4c1 : MOV ECX,dword ptr [EBP + 0xfffffbbc]
0070b4c7 : CALL 0x006f04e0
0070b4cc : XOR EDX,EDX
0070b4ce : PUSH 0x1
0070b4d0 : MOV ESI,EDI
0070b4d2 : MOV dword ptr [EBP + 0xfffffbd0],0x7
0070b4dc : MOV dword ptr [EBP + 0xfffffbcc],EBX
0070b4e2 : MOV word ptr [EBP + 0xfffffbbc],DX
0070b4e9 : CALL 0x0070b300
0070b4ee : MOV EAX,dword ptr [EBP + 0xc]
0070b4f1 : MOV ECX,dword ptr [EBP + 0xfffffbb4]
0070b4f7 : PUSH EAX
0070b4f8 : PUSH ECX
0070b4f9 : PUSH 0xbfd1b8
0070b4fe : LEA EDX,[EBP + 0xfffffbf0]
0070b504 : CALL 0x0040e4a0
0070b509 : ADD ESP,0xc
0070b50c : XOR EDX,EDX
0070b50e : LEA EAX,[EBP + 0xfffffbf0]
0070b514 : MOV word ptr [EBP + 0xfffffbd8],DX
0070b51b : MOV dword ptr [EBP + 0xfffffbec],0x7
0070b525 : MOV dword ptr [EBP + 0xfffffbe8],EBX
0070b52b : LEA EDX,[EAX + 0x2]
0070b52e : MOV EDI,EDI
0070b530 : MOV CX,word ptr [EAX]
0070b533 : ADD EAX,0x2
0070b536 : CMP CX,BX
0070b539 : JNZ 0x0070b530
0070b53b : SUB EAX,EDX
0070b53d : SAR EAX,0x1
0070b53f : PUSH EAX
0070b540 : LEA EAX,[EBP + 0xfffffbf0]
0070b546 : PUSH EAX
0070b547 : LEA ECX,[EBP + 0xfffffbd4]
0070b54d : CALL 0x00406360
0070b552 : MOV byte ptr [EBP + -0x4],0x2
0070b556 : LEA ESI,[EBP + 0xfffffbd4]
0070b55c : MOV EAX,EDI
0070b55e : CALL 0x0070ac20
0070b563 : MOV byte ptr [EBP + -0x4],BL
0070b566 : CMP dword ptr [EBP + 0xfffffbec],0x8
0070b56d : JC 0x0070b57a
0070b56f : MOV ECX,dword ptr [EBP + 0xfffffbd8]
0070b575 : CALL 0x006f04e0
0070b57a : XOR ECX,ECX
0070b57c : PUSH 0x1
0070b57e : MOV ESI,EDI
0070b580 : MOV dword ptr [EBP + 0xfffffbec],0x7
0070b58a : MOV dword ptr [EBP + 0xfffffbe8],EBX
0070b590 : MOV word ptr [EBP + 0xfffffbd8],CX
0070b597 : CALL 0x0070b300
0070b59c : MOV EAX,dword ptr [EBP + 0xfffffbb0]
0070b5a2 : CMP dword ptr [EAX + 0x18],0x8
0070b5a6 : JC 0x0070b5ad
0070b5a8 : MOV EAX,dword ptr [EAX + 0x4]
0070b5ab : JMP 0x0070b5b0
0070b5ad : ADD EAX,0x4
0070b5b0 : PUSH EAX
0070b5b1 : PUSH 0xbfd13c
0070b5b6 : LEA EDX,[EBP + 0xfffffbf0]
0070b5bc : CALL 0x0040e4a0
0070b5c1 : ADD ESP,0x8
0070b5c4 : XOR EDX,EDX
0070b5c6 : LEA EAX,[EBP + 0xfffffbf0]
0070b5cc : MOV word ptr [EBP + 0xfffffbd8],DX
0070b5d3 : MOV dword ptr [EBP + 0xfffffbec],0x7
0070b5dd : MOV dword ptr [EBP + 0xfffffbe8],EBX
0070b5e3 : LEA EDX,[EAX + 0x2]
0070b5e6 : MOV CX,word ptr [EAX]
0070b5e9 : ADD EAX,0x2
0070b5ec : CMP CX,BX
0070b5ef : JNZ 0x0070b5e6
0070b5f1 : SUB EAX,EDX
0070b5f3 : SAR EAX,0x1
0070b5f5 : PUSH EAX
0070b5f6 : LEA EAX,[EBP + 0xfffffbf0]
0070b5fc : PUSH EAX
0070b5fd : LEA ECX,[EBP + 0xfffffbd4]
0070b603 : CALL 0x00406360
0070b608 : MOV byte ptr [EBP + -0x4],0x3
0070b60c : LEA ESI,[EBP + 0xfffffbd4]
0070b612 : MOV EAX,EDI
0070b614 : CALL 0x0070ac20
0070b619 : MOV byte ptr [EBP + -0x4],BL
0070b61c : CMP dword ptr [EBP + 0xfffffbec],0x8
0070b623 : JC 0x0070b630
0070b625 : MOV ECX,dword ptr [EBP + 0xfffffbd8]
0070b62b : CALL 0x006f04e0
0070b630 : XOR ECX,ECX
0070b632 : PUSH 0x1
0070b634 : MOV ESI,EDI
0070b636 : MOV dword ptr [EBP + 0xfffffbec],0x7
0070b640 : MOV dword ptr [EBP + 0xfffffbe8],EBX
0070b646 : MOV word ptr [EBP + 0xfffffbd8],CX
0070b64d : CALL 0x0070b300
0070b652 : PUSH 0x33
0070b654 : XOR EDX,EDX
0070b656 : PUSH 0xbfd1e8
0070b65b : LEA ECX,[EBP + 0xfffffbb8]
0070b661 : MOV dword ptr [EBP + 0xfffffbd0],0x7
0070b66b : MOV dword ptr [EBP + 0xfffffbcc],EBX
0070b671 : MOV word ptr [EBP + 0xfffffbbc],DX
0070b678 : CALL 0x00406360
0070b67d : MOV byte ptr [EBP + -0x4],0x4
0070b681 : LEA ESI,[EBP + 0xfffffbb8]
0070b687 : MOV EAX,EDI
0070b689 : CALL 0x0070ac20
0070b68e : MOV byte ptr [EBP + -0x4],BL
0070b691 : CMP dword ptr [EBP + 0xfffffbd0],0x8
0070b698 : JC 0x0070b6a5
0070b69a : MOV ECX,dword ptr [EBP + 0xfffffbbc]
0070b6a0 : CALL 0x006f04e0
0070b6a5 : XOR EAX,EAX
0070b6a7 : PUSH 0x1
0070b6a9 : MOV ESI,EDI
0070b6ab : MOV dword ptr [EBP + 0xfffffbd0],0x7
0070b6b5 : MOV dword ptr [EBP + 0xfffffbcc],EBX
0070b6bb : MOV word ptr [EBP + 0xfffffbbc],AX
0070b6c2 : CALL 0x0070b300
0070b6c7 : MOV dword ptr [EBP + -0x4],0xffffffff
0070b6ce : CMP dword ptr [EBP + 0xfffffba8],EBX
0070b6d4 : JZ 0x0070b6e9
0070b6d6 : MOV ECX,dword ptr [EBP + 0xfffffb9c]
0070b6dc : PUSH ECX
0070b6dd : CALL dword ptr [0x00b8511c]
0070b6e3 : MOV dword ptr [EBP + 0xfffffba8],EBX
0070b6e9 : MOV ECX,dword ptr [EBP + -0xc]
0070b6ec : MOV dword ptr FS:[0x0],ECX
0070b6f3 : POP ECX
0070b6f4 : POP EDI
0070b6f5 : POP ESI
0070b6f6 : POP EBX
0070b6f7 : MOV ECX,dword ptr [EBP + -0x10]
0070b6fa : XOR ECX,EBP
0070b6fc : CALL 0x00633e6b
0070b701 : MOV ESP,EBP
0070b703 : POP EBP
0070b704 : RET 0xc

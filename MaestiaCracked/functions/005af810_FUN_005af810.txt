PROGRAM  : Maestia.exe
FUNCTION : FUN_005af810
ENTRY    : 005af810
BODY     : [[005af810, 005af96d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005af810(undefined4 param_1,uint param_2)

{
  undefined4 *puVar1;
  int iVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  int iVar5;
  int *in_ECX;
  int iVar6;
  int iVar7;
  int iVar8;
  float10 fVar9;
  longlong local_c;
  int *local_4;
  
  iVar8 = 0;
  if (param_2 == 0) {
    FUN_005af2f0();
    return;
  }
  local_4 = in_ECX;
  if (param_2 < 8) {
    iVar7 = 8;
  }
  else {
    fVar9 = (float10)FUN_0063b270();
    local_c = (longlong)ROUND((float)fVar9 / 0.6931472 + 1.0);
    iVar7 = 1 << ((byte)local_c & 0x1f);
  }
  local_c = CONCAT44(local_c._4_4_,2);
  puVar4 = (undefined4 *)FUN_00515840(iVar7 * 0x14 + 8,&local_c);
  *puVar4 = 0;
  puVar4[1] = iVar7 + -1;
  if (iVar7 != 0) {
    iVar5 = 0;
    do {
      *(undefined4 *)(iVar5 + 8 + (int)puVar4) = 0xfffffffe;
      iVar5 = iVar5 + 0x14;
      iVar7 = iVar7 + -1;
    } while (iVar7 != 0);
  }
  if (*in_ECX != 0) {
    iVar7 = *(int *)(*in_ECX + 4) + 1;
    do {
      puVar3 = (undefined4 *)(iVar8 + 8 + *in_ECX);
      if (*(int *)(iVar8 + 8 + *in_ECX) != -2) {
        puVar1 = puVar3 + 2;
        iVar5 = 4;
        iVar6 = 0x1505;
        do {
          iVar2 = iVar5 + -1;
          iVar5 = iVar5 + -1;
          iVar6 = iVar6 * 0x1003f + (uint)*(byte *)(iVar2 + (int)puVar1);
        } while (iVar5 != 0);
        FUN_005b0060(param_1,puVar1,iVar6);
        *puVar3 = 0xfffffffe;
        in_ECX = local_4;
      }
      iVar8 = iVar8 + 0x14;
      iVar7 = iVar7 + -1;
    } while (iVar7 != 0);
    FUN_00515cf0(*in_ECX);
  }
  *in_ECX = (int)puVar4;
  return;
}



============================================================
DISASSEMBLY
============================================================
005af810 : SUB ESP,0xc
005af813 : MOV EAX,dword ptr [ESP + 0x14]
005af817 : PUSH EBP
005af818 : PUSH EDI
005af819 : XOR EDI,EDI
005af81b : MOV EBP,ECX
005af81d : MOV dword ptr [ESP + 0x10],EBP
005af821 : CMP EAX,EDI
005af823 : JNZ 0x005af832
005af825 : CALL 0x005af2f0
005af82a : POP EDI
005af82b : POP EBP
005af82c : ADD ESP,0xc
005af82f : RET 0x8
005af832 : PUSH ESI
005af833 : CMP EAX,0x8
005af836 : JNC 0x005af83f
005af838 : MOV ESI,0x8
005af83d : JMP 0x005af8a4
005af83f : DEC EAX
005af840 : MOV dword ptr [ESP + 0x20],EAX
005af844 : FILD dword ptr [ESP + 0x20]
005af848 : TEST EAX,EAX
005af84a : JGE 0x005af852
005af84c : FADD float ptr [0x00cdf0e0]
005af852 : CALL 0x0063b270
005af857 : FSTP float ptr [ESP + 0x20]
005af85b : FLD float ptr [ESP + 0x20]
005af85f : MOV ESI,0x1
005af864 : FDIV double ptr [0x00b85fe0]
005af86a : FSTP float ptr [ESP + 0x20]
005af86e : FLD float ptr [ESP + 0x20]
005af872 : FADD double ptr [0x00cdf108]
005af878 : FSTP float ptr [ESP + 0x20]
005af87c : FLD float ptr [ESP + 0x20]
005af880 : FNSTCW word ptr [ESP + 0x20]
005af884 : MOVZX EAX,word ptr [ESP + 0x20]
005af889 : OR EAX,0xc00
005af88e : MOV dword ptr [ESP + 0xc],EAX
005af892 : FLDCW word ptr [ESP + 0xc]
005af896 : FISTP qword ptr [ESP + 0xc]
005af89a : MOV CL,byte ptr [ESP + 0xc]
005af89e : SHL ESI,CL
005af8a0 : FLDCW word ptr [ESP + 0x20]
005af8a4 : LEA EAX,[ESP + 0xc]
005af8a8 : LEA ECX,[ESI + ESI*0x4]
005af8ab : LEA EDX,[ECX*0x4 + 0x8]
005af8b2 : MOV ECX,dword ptr [0x00d73250]
005af8b8 : PUSH EAX
005af8b9 : PUSH EDX
005af8ba : MOV dword ptr [ESP + 0x28],EDI
005af8be : MOV dword ptr [ESP + 0x14],0x2
005af8c6 : CALL 0x00515840
005af8cb : MOV dword ptr [ESP + 0x20],EAX
005af8cf : MOV dword ptr [EAX],EDI
005af8d1 : MOV ECX,dword ptr [ESP + 0x20]
005af8d5 : LEA EAX,[ESI + -0x1]
005af8d8 : MOV dword ptr [ECX + 0x4],EAX
005af8db : CMP ESI,EDI
005af8dd : JBE 0x005af8f5
005af8df : XOR EAX,EAX
005af8e1 : MOV EDX,dword ptr [ESP + 0x20]
005af8e5 : MOV dword ptr [EAX + EDX*0x1 + 0x8],0xfffffffe
005af8ed : ADD EAX,0x14
005af8f0 : SUB ESI,0x1
005af8f3 : JNZ 0x005af8e1
005af8f5 : MOV EAX,dword ptr [EBP]
005af8f8 : CMP EAX,EDI
005af8fa : JZ 0x005af95e
005af8fc : MOV EAX,dword ptr [EAX + 0x4]
005af8ff : PUSH EBX
005af900 : LEA EBX,[EAX + 0x1]
005af903 : MOV EAX,dword ptr [EBP]
005af906 : CMP dword ptr [EDI + EAX*0x1 + 0x8],-0x2
005af90b : LEA ESI,[EDI + EAX*0x1 + 0x8]
005af90f : JZ 0x005af94c
005af911 : LEA EDX,[ESI + 0x8]
005af914 : MOV EAX,0x4
005af919 : MOV ECX,0x1505
005af91e : MOV EDI,EDI
005af920 : MOVZX EBP,byte ptr [EAX + EDX*0x1 + -0x1]
005af925 : IMUL ECX,ECX,0x1003f
005af92b : DEC EAX
005af92c : ADD ECX,EBP
005af92e : TEST EAX,EAX
005af930 : JA 0x005af920
005af932 : PUSH ECX
005af933 : MOV ECX,dword ptr [ESP + 0x24]
005af937 : PUSH EDX
005af938 : PUSH ECX
005af939 : LEA ECX,[ESP + 0x30]
005af93d : CALL 0x005b0060
005af942 : MOV EBP,dword ptr [ESP + 0x18]
005af946 : MOV dword ptr [ESI],0xfffffffe
005af94c : ADD EDI,0x14
005af94f : SUB EBX,0x1
005af952 : JNZ 0x005af903
005af954 : MOV EDX,dword ptr [EBP]
005af957 : PUSH EDX
005af958 : CALL 0x00515cf0
005af95d : POP EBX
005af95e : MOV EAX,dword ptr [ESP + 0x20]
005af962 : POP ESI
005af963 : POP EDI
005af964 : MOV dword ptr [EBP],EAX
005af967 : POP EBP
005af968 : ADD ESP,0xc
005af96b : RET 0x8

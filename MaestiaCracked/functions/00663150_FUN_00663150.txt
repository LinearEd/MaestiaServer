PROGRAM  : Maestia.exe
FUNCTION : FUN_00663150
ENTRY    : 00663150
BODY     : [[00663150, 00663332]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_00663150(int *param_1,int *param_2)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  uint uVar3;
  undefined4 *puVar4;
  int iVar5;
  int unaff_EBX;
  int *piVar6;
  int iVar7;
  uint uVar8;
  int *piVar9;
  uint uVar10;
  
  iVar7 = 0;
  if (param_1 == (int *)0x0) {
    return 1;
  }
  puVar1 = (undefined4 *)*param_1;
  piVar9 = param_2;
  uVar3 = (**(code **)(*param_2 + 0x1c))(param_2,*puVar1,puVar1[1],puVar1[2],puVar1[3]);
  if (unaff_EBX != 0) {
    puVar1 = (undefined4 *)*param_1;
    uVar3 = (**(code **)(*param_2 + 0xc))
                      (param_2,*puVar1,puVar1[1],puVar1[2],puVar1[3],param_1[1],param_1[2]);
    if ((-1 < (int)uVar3) && (uVar10 = 0, param_1[3] != 0)) {
      while( true ) {
        iVar5 = param_1[4];
        puVar1 = *(undefined4 **)(iVar5 + iVar7 + 0x14);
        puVar4 = (undefined4 *)(iVar5 + iVar7);
        puVar2 = (undefined4 *)*param_1;
        uVar3 = (**(code **)(*param_2 + 0x14))
                          (param_2,*puVar2,puVar2[1],puVar2[2],puVar2[3],*puVar4,puVar4[1],puVar4[2]
                           ,*(undefined4 *)(iVar5 + 0xc + iVar7),
                           *(undefined4 *)(iVar5 + 0x10 + iVar7),*puVar1,puVar1[1],puVar1[2],
                           puVar1[3],*(undefined4 *)(iVar5 + iVar7 + 0x18));
        if ((int)uVar3 < 0) break;
        iVar5 = param_1[4];
        uVar8 = 0;
        piVar6 = param_2;
        if (*(int *)(iVar7 + 0x1c + iVar5) != 0) {
          do {
            param_2 = piVar9;
            piVar9 = (int *)(*(int *)(iVar7 + 0x20 + iVar5) + uVar8 * 8);
            puVar1 = (undefined4 *)piVar9[1];
            puVar2 = (undefined4 *)*piVar9;
            puVar4 = (undefined4 *)*param_1;
            piVar9 = param_2;
            uVar3 = (**(code **)(*piVar6 + 0x18))
                              (param_2,*puVar4,puVar4[1],puVar4[2],puVar4[3],
                               *(undefined4 *)(iVar7 + iVar5),*puVar2,puVar2[1],puVar2[2],puVar2[3],
                               *puVar1,puVar1[1],puVar1[2],puVar1[3]);
            if ((int)uVar3 < 0) goto LAB_0066331e;
            iVar5 = param_1[4];
            uVar8 = uVar8 + 1;
            piVar6 = param_2;
          } while (uVar8 < *(uint *)(iVar7 + 0x1c + iVar5));
        }
        uVar10 = uVar10 + 1;
        iVar7 = iVar7 + 0x24;
        if ((uint)param_1[3] <= uVar10) break;
      }
    }
  }
LAB_0066331e:
  return -(uint)(uVar3 != 0x80070002) & uVar3;
}



============================================================
DISASSEMBLY
============================================================
00663150 : PUSH ECX
00663151 : PUSH EBX
00663152 : PUSH EBP
00663153 : PUSH ESI
00663154 : PUSH EDI
00663155 : MOV EDI,dword ptr [ESP + 0x18]
00663159 : XOR ESI,ESI
0066315b : CMP EDI,ESI
0066315d : JNZ 0x0066316a
0066315f : LEA EAX,[ESI + 0x1]
00663162 : POP EDI
00663163 : POP ESI
00663164 : POP EBP
00663165 : POP EBX
00663166 : POP ECX
00663167 : RET 0xc
0066316a : MOV EAX,dword ptr [EDI]
0066316c : MOV EBP,dword ptr [EAX]
0066316e : MOV EBX,dword ptr [ESP + 0x1c]
00663172 : MOV EDX,dword ptr [EBX]
00663174 : SUB ESP,0x10
00663177 : MOV ECX,ESP
00663179 : MOV dword ptr [ECX],EBP
0066317b : MOV EBP,dword ptr [EAX + 0x4]
0066317e : MOV dword ptr [ECX + 0x4],EBP
00663181 : MOV EBP,dword ptr [EAX + 0x8]
00663184 : MOV EAX,dword ptr [EAX + 0xc]
00663187 : MOV dword ptr [ECX + 0x8],EBP
0066318a : MOV dword ptr [ECX + 0xc],EAX
0066318d : MOV ECX,dword ptr [EDX + 0x1c]
00663190 : PUSH EBX
00663191 : CALL ECX
00663193 : MOV ECX,EAX
00663195 : CMP dword ptr [ESP + 0x20],ESI
00663199 : JZ 0x0066331e
0066319f : MOV EAX,dword ptr [EDI + 0x8]
006631a2 : MOV ECX,dword ptr [EDI + 0x4]
006631a5 : MOV EDX,dword ptr [EBX]
006631a7 : PUSH EAX
006631a8 : MOV EAX,dword ptr [EDI]
006631aa : MOV EBP,dword ptr [EAX]
006631ac : PUSH ECX
006631ad : SUB ESP,0x10
006631b0 : MOV ECX,ESP
006631b2 : MOV dword ptr [ECX],EBP
006631b4 : MOV EBP,dword ptr [EAX + 0x4]
006631b7 : MOV dword ptr [ECX + 0x4],EBP
006631ba : MOV EBP,dword ptr [EAX + 0x8]
006631bd : MOV EAX,dword ptr [EAX + 0xc]
006631c0 : MOV dword ptr [ECX + 0x8],EBP
006631c3 : MOV dword ptr [ECX + 0xc],EAX
006631c6 : MOV ECX,dword ptr [EDX + 0xc]
006631c9 : PUSH EBX
006631ca : CALL ECX
006631cc : MOV ECX,EAX
006631ce : CMP ECX,ESI
006631d0 : JL 0x0066331e
006631d6 : MOV dword ptr [ESP + 0x20],ESI
006631da : CMP dword ptr [EDI + 0xc],ESI
006631dd : JBE 0x0066331e
006631e3 : MOV EDX,dword ptr [EDI + 0x10]
006631e6 : LEA ECX,[EDX + ESI*0x1]
006631e9 : MOV EAX,EDX
006631eb : MOV EDX,dword ptr [ECX + 0x18]
006631ee : PUSH EDX
006631ef : MOV EDX,dword ptr [ECX + 0x14]
006631f2 : MOV dword ptr [ESP + 0x1c],EDX
006631f6 : MOV EDX,dword ptr [EDX]
006631f8 : SUB ESP,0x10
006631fb : MOV ECX,ESP
006631fd : MOV dword ptr [ECX],EDX
006631ff : MOV EDX,dword ptr [ESP + 0x2c]
00663203 : MOV EDX,dword ptr [EDX + 0x4]
00663206 : MOV dword ptr [ECX + 0x4],EDX
00663209 : MOV EDX,dword ptr [ESP + 0x2c]
0066320d : MOV EDX,dword ptr [EDX + 0x8]
00663210 : MOV dword ptr [ECX + 0x8],EDX
00663213 : MOV EDX,dword ptr [ESP + 0x2c]
00663217 : MOV EDX,dword ptr [EDX + 0xc]
0066321a : MOV dword ptr [ECX + 0xc],EDX
0066321d : MOV ECX,dword ptr [EAX + ESI*0x1 + 0x10]
00663221 : MOV EDX,dword ptr [EAX + ESI*0x1 + 0xc]
00663225 : MOV EBP,dword ptr [EBX]
00663227 : ADD EAX,ESI
00663229 : PUSH ECX
0066322a : MOV ECX,dword ptr [EAX + 0x8]
0066322d : PUSH EDX
0066322e : MOV EDX,dword ptr [EAX + 0x4]
00663231 : MOV EAX,dword ptr [EAX]
00663233 : PUSH ECX
00663234 : PUSH EDX
00663235 : PUSH EAX
00663236 : MOV EAX,dword ptr [EDI]
00663238 : MOV EDX,dword ptr [EAX]
0066323a : SUB ESP,0x10
0066323d : MOV ECX,ESP
0066323f : MOV dword ptr [ECX],EDX
00663241 : MOV EDX,dword ptr [EAX + 0x4]
00663244 : MOV dword ptr [ECX + 0x4],EDX
00663247 : MOV EDX,dword ptr [EAX + 0x8]
0066324a : MOV EAX,dword ptr [EAX + 0xc]
0066324d : MOV dword ptr [ECX + 0x8],EDX
00663250 : MOV dword ptr [ECX + 0xc],EAX
00663253 : MOV ECX,dword ptr [EBP + 0x14]
00663256 : PUSH EBX
00663257 : CALL ECX
00663259 : MOV ECX,EAX
0066325b : TEST ECX,ECX
0066325d : JL 0x0066331e
00663263 : MOV EDX,dword ptr [EDI + 0x10]
00663266 : XOR EAX,EAX
00663268 : MOV dword ptr [ESP + 0x18],EAX
0066326c : CMP dword ptr [ESI + EDX*0x1 + 0x1c],EAX
00663270 : JBE 0x00663309
00663276 : MOV ECX,dword ptr [ESI + EDX*0x1 + 0x20]
0066327a : MOV EBP,dword ptr [EBX]
0066327c : LEA EAX,[ECX + EAX*0x8]
0066327f : MOV dword ptr [ESP + 0x10],EAX
00663283 : MOV EAX,dword ptr [EAX + 0x4]
00663286 : MOV EBX,dword ptr [EAX]
00663288 : SUB ESP,0x10
0066328b : MOV ECX,ESP
0066328d : MOV dword ptr [ECX],EBX
0066328f : MOV EBX,dword ptr [EAX + 0x4]
00663292 : MOV dword ptr [ECX + 0x4],EBX
00663295 : MOV EBX,dword ptr [EAX + 0x8]
00663298 : MOV EAX,dword ptr [EAX + 0xc]
0066329b : MOV dword ptr [ECX + 0x8],EBX
0066329e : MOV dword ptr [ECX + 0xc],EAX
006632a1 : MOV ECX,dword ptr [ESP + 0x20]
006632a5 : MOV EAX,dword ptr [ECX]
006632a7 : MOV EBX,dword ptr [EAX]
006632a9 : SUB ESP,0x10
006632ac : MOV ECX,ESP
006632ae : MOV dword ptr [ECX],EBX
006632b0 : MOV EBX,dword ptr [EAX + 0x4]
006632b3 : MOV dword ptr [ECX + 0x4],EBX
006632b6 : MOV EBX,dword ptr [EAX + 0x8]
006632b9 : MOV EAX,dword ptr [EAX + 0xc]
006632bc : MOV dword ptr [ECX + 0x8],EBX
006632bf : MOV EBX,dword ptr [ESP + 0x3c]
006632c3 : MOV dword ptr [ECX + 0xc],EAX
006632c6 : MOV ECX,dword ptr [ESI + EDX*0x1]
006632c9 : MOV EAX,dword ptr [EDI]
006632cb : MOV EDX,dword ptr [EAX]
006632cd : PUSH ECX
006632ce : SUB ESP,0x10
006632d1 : MOV ECX,ESP
006632d3 : MOV dword ptr [ECX],EDX
006632d5 : MOV EDX,dword ptr [EAX + 0x4]
006632d8 : MOV dword ptr [ECX + 0x4],EDX
006632db : MOV EDX,dword ptr [EAX + 0x8]
006632de : MOV EAX,dword ptr [EAX + 0xc]
006632e1 : MOV dword ptr [ECX + 0x8],EDX
006632e4 : MOV dword ptr [ECX + 0xc],EAX
006632e7 : MOV ECX,dword ptr [EBP + 0x18]
006632ea : PUSH EBX
006632eb : CALL ECX
006632ed : MOV ECX,EAX
006632ef : TEST ECX,ECX
006632f1 : JL 0x0066331e
006632f3 : MOV EAX,dword ptr [ESP + 0x18]
006632f7 : MOV EDX,dword ptr [EDI + 0x10]
006632fa : INC EAX
006632fb : MOV dword ptr [ESP + 0x18],EAX
006632ff : CMP EAX,dword ptr [ESI + EDX*0x1 + 0x1c]
00663303 : JC 0x00663276
00663309 : MOV EAX,dword ptr [ESP + 0x20]
0066330d : INC EAX
0066330e : ADD ESI,0x24
00663311 : MOV dword ptr [ESP + 0x20],EAX
00663315 : CMP EAX,dword ptr [EDI + 0xc]
00663318 : JC 0x006631e3
0066331e : MOV EAX,ECX
00663320 : SUB EAX,0x80070002
00663325 : POP EDI
00663326 : NEG EAX
00663328 : POP ESI
00663329 : SBB EAX,EAX
0066332b : POP EBP
0066332c : AND EAX,ECX
0066332e : POP EBX
0066332f : POP ECX
00663330 : RET 0xc

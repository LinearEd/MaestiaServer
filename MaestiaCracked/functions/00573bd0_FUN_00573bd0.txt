PROGRAM  : Maestia.exe
FUNCTION : FUN_00573bd0
ENTRY    : 00573bd0
BODY     : [[00573bd0, 00573e5f]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x00573c76) */
/* WARNING: Removing unreachable block (ram,0x00573cf6) */
/* WARNING: Removing unreachable block (ram,0x00573cfa) */
/* WARNING: Removing unreachable block (ram,0x00573d06) */
/* WARNING: Removing unreachable block (ram,0x00573d55) */

void FUN_00573bd0(GRefCountNTSImpl *param_1)

{
  uint uVar1;
  int *piVar2;
  GRefCountNTSImpl *pGVar3;
  GRefCountNTSImpl *pGVar4;
  int iVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  int *in_ECX;
  uint uVar8;
  uint uVar9;
  GRefCountNTSImpl *pGVar10;
  uint uVar11;
  uint uStack_30;
  GRefCountNTSImpl *pGStack_28;
  uint uStack_c;
  
  pGVar10 = param_1;
  iVar5 = (**(code **)(*(int *)(param_1 + 0x68) + 8))();
  if ((iVar5 != 2) || (iVar5 = FUN_0054ed10(), *(int *)(iVar5 + 0x1a0) < 0)) {
    uStack_30 = 0;
    if (in_ECX[0x2a4] != 0) {
      uStack_c = 0;
      uVar6 = (**(code **)(*in_ECX + 0xd8))();
      uVar9 = 0;
      uVar7 = (**(code **)(*in_ECX + 0xd8))();
      pGStack_28 = (GRefCountNTSImpl *)0x0;
      for (pGVar10 = param_1; pGVar10 != (GRefCountNTSImpl *)0x0;
          pGVar10 = *(GRefCountNTSImpl **)(pGVar10 + 0x20)) {
        uVar11 = uStack_c + 1;
        if (uStack_c <= uVar11) {
          FUN_0056c290(uVar6,(uVar11 >> 2) + uVar11);
        }
        piVar2 = (int *)(uVar11 * 4 + -4);
        if (piVar2 != (int *)0x0) {
          *piVar2 = (int)pGVar10;
        }
        uStack_c = uVar11;
        pGStack_28 = pGVar10;
      }
      uVar11 = in_ECX[0x2a4];
      if (uVar11 != 0) {
        do {
          if (*(GRefCountNTSImpl **)(in_ECX[0x2a3] + uStack_30 * 4) == param_1) {
            FUN_00515cf0(0);
            FUN_00515cf0(0);
            return;
          }
          if (uVar9 == 0) {
            FUN_0056c290(uVar7,0);
          }
          pGVar4 = *(GRefCountNTSImpl **)(in_ECX[0x2a3] + uStack_30 * 4);
          uVar9 = 0;
          pGVar10 = (GRefCountNTSImpl *)0x0;
          while (pGVar3 = pGVar4, pGVar3 != (GRefCountNTSImpl *)0x0) {
            uVar1 = uVar9 + 1;
            if (uVar9 <= uVar1) {
              FUN_0056c290(uVar7,(uVar1 >> 2) + uVar1);
            }
            piVar2 = (int *)(uVar1 * 4 + -4);
            if (piVar2 != (int *)0x0) {
              *piVar2 = (int)pGVar3;
            }
            uVar9 = uVar1;
            pGVar10 = pGVar3;
            pGVar4 = *(GRefCountNTSImpl **)(pGVar3 + 0x20);
          }
          uVar8 = uVar9;
          uVar1 = uStack_c;
          if (pGVar10 == pGStack_28) {
            do {
              uVar1 = uVar1 - 1;
              if (((int)uVar1 < 0) || (uVar8 = uVar8 - 1, (int)uVar8 < 0)) goto LAB_00573e32;
            } while (*(int *)(uVar1 * 4) == *(int *)(uVar8 * 4));
            if (*(int *)(*(int *)(uVar1 * 4) + 0x14) < *(int *)(*(int *)(uVar8 * 4) + 0x14)) break;
          }
          else if (*(int *)(pGStack_28 + 0x1a0) < *(int *)(pGVar10 + 0x1a0)) break;
LAB_00573e32:
          uStack_30 = uStack_30 + 1;
        } while (uStack_30 < uVar11);
      }
      FUN_00515cf0(0);
      FUN_00515cf0(0);
      pGVar10 = param_1;
    }
    if (pGVar10 != (GRefCountNTSImpl *)0x0) {
      *(int *)(pGVar10 + 4) = *(int *)(pGVar10 + 4) + 1;
    }
    param_1 = pGVar10;
    FUN_00570b10(uStack_30,&param_1);
    if (pGVar10 != (GRefCountNTSImpl *)0x0) {
      GRefCountNTSImpl::Release(pGVar10);
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00573bd0 : SUB ESP,0x30
00573bd3 : PUSH EBX
00573bd4 : MOV EBX,dword ptr [ESP + 0x38]
00573bd8 : MOV EAX,dword ptr [EBX + 0x68]
00573bdb : MOV EDX,dword ptr [EAX + 0x8]
00573bde : PUSH ESI
00573bdf : LEA ESI,[EBX + 0x68]
00573be2 : PUSH EDI
00573be3 : MOV EDI,ECX
00573be5 : MOV ECX,ESI
00573be7 : MOV dword ptr [ESP + 0x10],EDI
00573beb : CALL EDX
00573bed : CMP EAX,0x2
00573bf0 : JNZ 0x00573c06
00573bf2 : MOV ECX,ESI
00573bf4 : CALL 0x0054ed10
00573bf9 : CMP dword ptr [EAX + 0x1a0],0x0
00573c00 : JGE 0x00573e1b
00573c06 : XOR ESI,ESI
00573c08 : PUSH EBP
00573c09 : MOV dword ptr [ESP + 0x10],ESI
00573c0d : CMP dword ptr [EDI + 0xa90],ESI
00573c13 : JBE 0x00573def
00573c19 : MOV EAX,dword ptr [EDI]
00573c1b : MOV EDX,dword ptr [EAX + 0xd8]
00573c21 : MOV ECX,EDI
00573c23 : MOV dword ptr [ESP + 0x30],ESI
00573c27 : MOV dword ptr [ESP + 0x34],ESI
00573c2b : MOV dword ptr [ESP + 0x38],ESI
00573c2f : CALL EDX
00573c31 : MOV dword ptr [ESP + 0x3c],EAX
00573c35 : MOV EAX,dword ptr [EDI]
00573c37 : MOV EDX,dword ptr [EAX + 0xd8]
00573c3d : XOR EBX,EBX
00573c3f : XOR EBP,EBP
00573c41 : MOV ECX,EDI
00573c43 : MOV dword ptr [ESP + 0x20],EBP
00573c47 : MOV dword ptr [ESP + 0x24],EBX
00573c4b : MOV dword ptr [ESP + 0x28],EBX
00573c4f : CALL EDX
00573c51 : MOV EDI,dword ptr [ESP + 0x44]
00573c55 : MOV dword ptr [ESP + 0x2c],EAX
00573c59 : MOV dword ptr [ESP + 0x18],EBX
00573c5d : TEST EDI,EDI
00573c5f : JZ 0x00573cbb
00573c61 : MOV ESI,dword ptr [ESP + 0x34]
00573c65 : INC ESI
00573c66 : CMP ESI,dword ptr [ESP + 0x34]
00573c6a : JNC 0x00573c7e
00573c6c : MOV EAX,dword ptr [ESP + 0x38]
00573c70 : SHR EAX,0x1
00573c72 : CMP ESI,EAX
00573c74 : JNC 0x00573c9a
00573c76 : MOV ECX,dword ptr [ESP + 0x3c]
00573c7a : PUSH ESI
00573c7b : PUSH ECX
00573c7c : JMP 0x00573c91
00573c7e : CMP ESI,dword ptr [ESP + 0x38]
00573c82 : JC 0x00573c9a
00573c84 : MOV EAX,dword ptr [ESP + 0x3c]
00573c88 : MOV EDX,ESI
00573c8a : SHR EDX,0x2
00573c8d : ADD EDX,ESI
00573c8f : PUSH EDX
00573c90 : PUSH EAX
00573c91 : LEA ECX,[ESP + 0x38]
00573c95 : CALL 0x0056c290
00573c9a : MOV ECX,dword ptr [ESP + 0x30]
00573c9e : LEA EAX,[ECX + ESI*0x4 + -0x4]
00573ca2 : MOV dword ptr [ESP + 0x34],ESI
00573ca6 : TEST EAX,EAX
00573ca8 : JZ 0x00573cac
00573caa : MOV dword ptr [EAX],EDI
00573cac : MOV dword ptr [ESP + 0x18],EDI
00573cb0 : MOV EDI,dword ptr [EDI + 0x20]
00573cb3 : TEST EDI,EDI
00573cb5 : JNZ 0x00573c61
00573cb7 : MOV ESI,dword ptr [ESP + 0x30]
00573cbb : MOV EDI,dword ptr [ESP + 0x14]
00573cbf : MOV EAX,dword ptr [EDI + 0xa90]
00573cc5 : MOV dword ptr [ESP + 0x1c],EAX
00573cc9 : TEST EAX,EAX
00573ccb : JBE 0x00573ddb
00573cd1 : MOV EDX,dword ptr [EDI + 0xa8c]
00573cd7 : MOV EAX,dword ptr [ESP + 0x10]
00573cdb : MOV ECX,dword ptr [ESP + 0x44]
00573cdf : CMP dword ptr [EDX + EAX*0x4],ECX
00573ce2 : JZ 0x00573e4a
00573ce8 : TEST EBX,EBX
00573cea : JBE 0x00573d10
00573cec : TEST dword ptr [ESP + 0x28],0xfffffffe
00573cf4 : JBE 0x00573d2b
00573cf6 : TEST EBP,EBP
00573cf8 : JZ 0x00573d06
00573cfa : PUSH EBP
00573cfb : CALL 0x00515cf0
00573d00 : XOR EBP,EBP
00573d02 : MOV dword ptr [ESP + 0x20],EBP
00573d06 : MOV dword ptr [ESP + 0x28],0x0
00573d0e : JMP 0x00573d2b
00573d10 : CMP dword ptr [ESP + 0x28],0x0
00573d15 : JA 0x00573d2b
00573d17 : MOV EDX,dword ptr [ESP + 0x2c]
00573d1b : PUSH 0x0
00573d1d : PUSH EDX
00573d1e : LEA ECX,[ESP + 0x28]
00573d22 : CALL 0x0056c290
00573d27 : MOV EBP,dword ptr [ESP + 0x20]
00573d2b : MOV ECX,dword ptr [EDI + 0xa8c]
00573d31 : MOV EDX,dword ptr [ESP + 0x10]
00573d35 : MOV EDI,dword ptr [ECX + EDX*0x4]
00573d38 : XOR EBX,EBX
00573d3a : XOR EAX,EAX
00573d3c : MOV dword ptr [ESP + 0x24],EBX
00573d40 : TEST EDI,EDI
00573d42 : JZ 0x00573d9a
00573d44 : LEA ESI,[EBX + 0x1]
00573d47 : CMP ESI,EBX
00573d49 : JNC 0x00573d5d
00573d4b : MOV EAX,dword ptr [ESP + 0x28]
00573d4f : SHR EAX,0x1
00573d51 : CMP ESI,EAX
00573d53 : JNC 0x00573d7d
00573d55 : MOV ECX,dword ptr [ESP + 0x2c]
00573d59 : PUSH ESI
00573d5a : PUSH ECX
00573d5b : JMP 0x00573d70
00573d5d : CMP ESI,dword ptr [ESP + 0x28]
00573d61 : JC 0x00573d7d
00573d63 : MOV EAX,dword ptr [ESP + 0x2c]
00573d67 : MOV EDX,ESI
00573d69 : SHR EDX,0x2
00573d6c : ADD EDX,ESI
00573d6e : PUSH EDX
00573d6f : PUSH EAX
00573d70 : LEA ECX,[ESP + 0x28]
00573d74 : CALL 0x0056c290
00573d79 : MOV EBP,dword ptr [ESP + 0x20]
00573d7d : LEA EAX,[EBP + ESI*0x4 + -0x4]
00573d81 : MOV EBX,ESI
00573d83 : MOV dword ptr [ESP + 0x24],EBX
00573d87 : TEST EAX,EAX
00573d89 : JZ 0x00573d8d
00573d8b : MOV dword ptr [EAX],EDI
00573d8d : MOV EAX,EDI
00573d8f : MOV EDI,dword ptr [EDI + 0x20]
00573d92 : TEST EDI,EDI
00573d94 : JNZ 0x00573d44
00573d96 : MOV ESI,dword ptr [ESP + 0x30]
00573d9a : MOV ECX,dword ptr [ESP + 0x18]
00573d9e : CMP EAX,ECX
00573da0 : JNZ 0x00573e24
00573da6 : MOV EAX,dword ptr [ESP + 0x34]
00573daa : ADD EAX,-0x1
00573dad : LEA ECX,[EBX + -0x1]
00573db0 : JS 0x00573e32
00573db6 : TEST ECX,ECX
00573db8 : JL 0x00573e32
00573dbe : MOV EDX,dword ptr [ESI + EAX*0x4]
00573dc1 : CMP EDX,dword ptr [EBP + ECX*0x4]
00573dc5 : JNZ 0x00573dcf
00573dc7 : DEC EAX
00573dc8 : DEC ECX
00573dc9 : TEST EAX,EAX
00573dcb : JGE 0x00573db6
00573dcd : JMP 0x00573e32
00573dcf : MOV ECX,dword ptr [EBP + ECX*0x4]
00573dd3 : MOV EAX,dword ptr [EDX + 0x14]
00573dd6 : CMP EAX,dword ptr [ECX + 0x14]
00573dd9 : JGE 0x00573e32
00573ddb : PUSH EBP
00573ddc : CALL 0x00515cf0
00573de1 : PUSH ESI
00573de2 : CALL 0x00515cf0
00573de7 : MOV EDI,dword ptr [ESP + 0x14]
00573deb : MOV EBX,dword ptr [ESP + 0x44]
00573def : TEST EBX,EBX
00573df1 : JZ 0x00573df6
00573df3 : INC dword ptr [EBX + 0x4]
00573df6 : MOV ECX,dword ptr [ESP + 0x10]
00573dfa : LEA EAX,[ESP + 0x44]
00573dfe : PUSH EAX
00573dff : PUSH ECX
00573e00 : LEA ECX,[EDI + 0xa8c]
00573e06 : MOV dword ptr [ESP + 0x4c],EBX
00573e0a : CALL 0x00570b10
00573e0f : TEST EBX,EBX
00573e11 : JZ 0x00573e1a
00573e13 : MOV ECX,EBX
00573e15 : CALL 0x004ff7c0
00573e1a : POP EBP
00573e1b : POP EDI
00573e1c : POP ESI
00573e1d : POP EBX
00573e1e : ADD ESP,0x30
00573e21 : RET 0x4
00573e24 : MOV EDX,dword ptr [EAX + 0x1a0]
00573e2a : CMP EDX,dword ptr [ECX + 0x1a0]
00573e30 : JG 0x00573ddb
00573e32 : MOV EAX,dword ptr [ESP + 0x10]
00573e36 : INC EAX
00573e37 : MOV dword ptr [ESP + 0x10],EAX
00573e3b : CMP EAX,dword ptr [ESP + 0x1c]
00573e3f : JNC 0x00573ddb
00573e41 : MOV EDI,dword ptr [ESP + 0x14]
00573e45 : JMP 0x00573cd1
00573e4a : PUSH EBP
00573e4b : CALL 0x00515cf0
00573e50 : PUSH ESI
00573e51 : CALL 0x00515cf0
00573e56 : POP EBP
00573e57 : POP EDI
00573e58 : POP ESI
00573e59 : POP EBX
00573e5a : ADD ESP,0x30
00573e5d : RET 0x4

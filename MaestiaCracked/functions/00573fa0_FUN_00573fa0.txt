PROGRAM  : Maestia.exe
FUNCTION : FUN_00573fa0
ENTRY    : 00573fa0
BODY     : [[00573fa0, 005741b9] [005741c0, 005742f9]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00573fa0(int param_1,byte param_2)

{
  byte *pbVar1;
  undefined1 *puVar2;
  byte bVar3;
  int iVar4;
  uint uVar5;
  undefined4 *puVar6;
  int in_ECX;
  undefined4 *puVar7;
  int *piVar8;
  uint uVar9;
  byte *local_10;
  undefined4 local_c;
  int local_8;
  int local_4;
  
  local_10 = (byte *)(in_ECX + 4);
  local_c = 0xffffffff;
  bVar3 = *local_10;
  iVar4 = 1;
  if ((bVar3 & 0x80) != 0) {
    iVar4 = 5;
  }
  *(uint *)(param_1 + 0x40) = (uint)CONCAT11(*(undefined1 *)(in_ECX + 5 + iVar4),local_10[iVar4]);
  local_8 = iVar4 + 2;
  if ((bVar3 & 2) != 0) {
    *(byte *)(param_1 + 0x4b) = *(byte *)(param_1 + 0x4b) | 2;
    puVar2 = (undefined1 *)(in_ECX + 5 + local_8);
    pbVar1 = local_10 + local_8;
    local_8 = iVar4 + 4;
    *(uint *)(param_1 + 0x44) = (uint)CONCAT11(*puVar2,*pbVar1);
  }
  local_4 = 0;
  if ((bVar3 & 4) != 0) {
    *(byte *)(param_1 + 0x4b) = *(byte *)(param_1 + 0x4b) | 4;
    FUN_0053a210(param_1 + 0x24);
  }
  if ((bVar3 & 8) != 0) {
    *(byte *)(param_1 + 0x4b) = *(byte *)(param_1 + 0x4b) | 8;
    FUN_0053a570(param_1 + 4);
  }
  if ((bVar3 & 0x10) != 0) {
    *(byte *)(param_1 + 0x4b) = *(byte *)(param_1 + 0x4b) | 0x10;
    if (local_4 != 0) {
      local_8 = local_8 + 1;
    }
    local_4 = 0;
    iVar4 = local_8 + 1;
    pbVar1 = local_10 + local_8;
    local_8 = local_8 + 2;
    *(float *)(param_1 + 0x3c) = (float)CONCAT11(local_10[iVar4],*pbVar1) / 65535.0;
  }
  if ((bVar3 & 0x20) == 0) {
    *(undefined4 *)(param_1 + 0x50) = 0;
  }
  else {
    if (local_4 != 0) {
      local_8 = local_8 + 1;
    }
    *(int *)(param_1 + 0x50) = local_8 + 4 + in_ECX;
    do {
      local_4 = 0;
      pbVar1 = local_10 + local_8;
      local_8 = local_8 + 1;
    } while (*pbVar1 != 0);
  }
  if ((bVar3 & 0x40) != 0) {
    *(byte *)(param_1 + 0x4b) = *(byte *)(param_1 + 0x4b) | 0x40;
    if (local_4 != 0) {
      local_8 = local_8 + 1;
    }
    local_4 = 0;
    iVar4 = local_8 + 1;
    pbVar1 = local_10 + local_8;
    local_8 = local_8 + 2;
    *(ushort *)(param_1 + 0x48) = CONCAT11(local_10[iVar4],*pbVar1);
  }
  piVar8 = (int *)0x0;
  if (((bVar3 & 0x80) != 0) && (piVar8 = *(int **)(in_ECX + 5), piVar8 == (int *)0x0)) {
    if (local_4 != 0) {
      local_8 = local_8 + 1;
    }
    local_4 = 0;
    if (param_2 < 6) {
      local_8 = local_8 + 4;
    }
    else {
      local_8 = local_8 + 6;
    }
    FUN_00515dd0(in_ECX);
    piVar8 = (int *)FUN_00515840(0xc,0);
    if (piVar8 == (int *)0x0) {
      piVar8 = (int *)0x0;
    }
    else {
      *piVar8 = 0;
      piVar8[1] = 0;
      piVar8[2] = 0;
    }
    while( true ) {
      if (local_4 != 0) {
        local_8 = local_8 + 1;
      }
      local_4 = 0;
      if (param_2 < 6) {
        uVar5 = (uint)CONCAT11(local_10[local_8 + 1],local_10[local_8]);
        local_8 = local_8 + 2;
      }
      else {
        uVar5 = CONCAT31(CONCAT21(CONCAT11(local_10[local_8 + 3],local_10[local_8 + 2]),
                                  local_10[local_8 + 1]),local_10[local_8]);
        local_8 = local_8 + 4;
      }
      if (uVar5 == 0) break;
      FUN_00515dd0(in_ECX);
      puVar6 = (undefined4 *)FUN_00515840(0x14,0);
      puVar7 = (undefined4 *)0x0;
      if (puVar6 != (undefined4 *)0x0) {
        *puVar6 = 0;
        puVar6[1] = 0;
        *(undefined2 *)(puVar6 + 2) = 0;
        *(undefined1 *)((int)puVar6 + 10) = 0;
        *(undefined1 *)((int)puVar6 + 0xb) = 0xff;
        *(undefined1 *)(puVar6 + 3) = 0;
        *(undefined1 *)((int)puVar6 + 0xd) = 0;
        puVar6[4] = 0;
        puVar7 = puVar6;
      }
      FUN_0056bd40(&local_10,uVar5);
      uVar5 = piVar8[1] + 1;
      if (uVar5 < (uint)piVar8[1]) {
        uVar9 = uVar5;
        if (uVar5 < (uint)piVar8[2] >> 1) {
LAB_00574296:
          FUN_0056c310(piVar8,uVar9);
        }
      }
      else if ((uint)piVar8[2] <= uVar5) {
        uVar9 = (uVar5 >> 2) + uVar5;
        goto LAB_00574296;
      }
      puVar6 = (undefined4 *)(*piVar8 + -4 + uVar5 * 4);
      piVar8[1] = uVar5;
      if (puVar6 != (undefined4 *)0x0) {
        *puVar6 = puVar7;
      }
    }
    *(int **)(in_ECX + 5) = piVar8;
  }
  *(int **)(param_1 + 0x4c) = piVar8;
  *(undefined4 *)(param_1 + 0x54) = 0;
  if ((bVar3 >> 1 & 1) == 0) {
    if ((bVar3 & 1) != 0) {
      *(undefined4 *)(param_1 + 0x54) = 1;
    }
  }
  else if ((bVar3 & 1) != 0) {
    *(undefined4 *)(param_1 + 0x54) = 2;
    return;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00573fa0 : SUB ESP,0x18
00573fa3 : PUSH EBX
00573fa4 : XOR EBX,EBX
00573fa6 : MOV dword ptr [ESP + 0x8],ECX
00573faa : ADD ECX,0x4
00573fad : MOV dword ptr [ESP + 0x14],EBX
00573fb1 : MOV dword ptr [ESP + 0xc],ECX
00573fb5 : MOV dword ptr [ESP + 0x10],0xffffffff
00573fbd : MOV dword ptr [ESP + 0x18],EBX
00573fc1 : MOV DL,byte ptr [ECX]
00573fc3 : PUSH EBP
00573fc4 : MOV byte ptr [ESP + 0xa],DL
00573fc8 : PUSH ESI
00573fc9 : MOV EAX,0x1
00573fce : AND DL,0x80
00573fd1 : PUSH EDI
00573fd2 : MOV dword ptr [ESP + 0x20],EAX
00573fd6 : MOV byte ptr [ESP + 0x13],DL
00573fda : JZ 0x00573fe5
00573fdc : MOV EAX,0x5
00573fe1 : MOV dword ptr [ESP + 0x20],EAX
00573fe5 : MOV EBP,dword ptr [ESP + 0x2c]
00573fe9 : XOR ESI,ESI
00573feb : MOV dword ptr [ESP + 0x24],ESI
00573fef : MOVZX DX,byte ptr [ECX + EAX*0x1 + 0x1]
00573ff5 : MOVZX DI,byte ptr [ECX + EAX*0x1]
00573ffa : SHL DX,0x8
00573ffe : OR DX,DI
00574001 : MOVZX EDX,DX
00574004 : MOVZX EDX,DX
00574007 : MOV dword ptr [EBP + 0x40],EDX
0057400a : MOV DL,byte ptr [ESP + 0x12]
0057400e : ADD EAX,0x2
00574011 : MOV dword ptr [ESP + 0x20],EAX
00574015 : TEST DL,0x2
00574018 : JZ 0x00574048
0057401a : OR byte ptr [EBP + 0x4b],0x2
0057401e : MOV dword ptr [ESP + 0x24],ESI
00574022 : MOVZX DX,byte ptr [ECX + EAX*0x1 + 0x1]
00574028 : MOVZX DI,byte ptr [ECX + EAX*0x1]
0057402d : SHL DX,0x8
00574031 : OR DX,DI
00574034 : MOVZX EDX,DX
00574037 : MOVZX EDX,DX
0057403a : ADD EAX,0x2
0057403d : MOV dword ptr [EBP + 0x44],EDX
00574040 : MOV DL,byte ptr [ESP + 0x12]
00574044 : MOV dword ptr [ESP + 0x20],EAX
00574048 : TEST DL,0x4
0057404b : JZ 0x0057406e
0057404d : OR byte ptr [EBP + 0x4b],0x4
00574051 : LEA EAX,[EBP + 0x24]
00574054 : PUSH EAX
00574055 : LEA ECX,[ESP + 0x1c]
00574059 : CALL 0x0053a210
0057405e : MOV ESI,dword ptr [ESP + 0x24]
00574062 : MOV EAX,dword ptr [ESP + 0x20]
00574066 : MOV ECX,dword ptr [ESP + 0x18]
0057406a : MOV DL,byte ptr [ESP + 0x12]
0057406e : TEST DL,0x8
00574071 : JZ 0x00574094
00574073 : OR byte ptr [EBP + 0x4b],0x8
00574077 : LEA ECX,[EBP + 0x4]
0057407a : PUSH ECX
0057407b : LEA ECX,[ESP + 0x1c]
0057407f : CALL 0x0053a570
00574084 : MOV ESI,dword ptr [ESP + 0x24]
00574088 : MOV EAX,dword ptr [ESP + 0x20]
0057408c : MOV ECX,dword ptr [ESP + 0x18]
00574090 : MOV DL,byte ptr [ESP + 0x12]
00574094 : TEST DL,0x10
00574097 : JZ 0x005740e0
00574099 : OR byte ptr [EBP + 0x4b],0x10
0057409d : CMP ESI,EBX
0057409f : JZ 0x005740a6
005740a1 : INC EAX
005740a2 : MOV dword ptr [ESP + 0x20],EAX
005740a6 : XOR ESI,ESI
005740a8 : MOV dword ptr [ESP + 0x24],ESI
005740ac : MOVZX DX,byte ptr [ECX + EAX*0x1 + 0x1]
005740b2 : MOVZX DI,byte ptr [ECX + EAX*0x1]
005740b7 : SHL DX,0x8
005740bb : OR DX,DI
005740be : MOVZX EDX,DX
005740c1 : MOVZX EDX,DX
005740c4 : MOV dword ptr [ESP + 0x2c],EDX
005740c8 : MOV DL,byte ptr [ESP + 0x12]
005740cc : ADD EAX,0x2
005740cf : FILD dword ptr [ESP + 0x2c]
005740d3 : MOV dword ptr [ESP + 0x20],EAX
005740d7 : FDIV double ptr [0x00b8d220]
005740dd : FSTP float ptr [EBP + 0x3c]
005740e0 : TEST DL,0x20
005740e3 : JZ 0x00574118
005740e5 : CMP ESI,EBX
005740e7 : JZ 0x005740ee
005740e9 : INC EAX
005740ea : MOV dword ptr [ESP + 0x20],EAX
005740ee : MOV EDX,dword ptr [ESP + 0x14]
005740f2 : LEA EDX,[EAX + EDX*0x1 + 0x4]
005740f6 : MOV dword ptr [EBP + 0x50],EDX
005740f9 : LEA ESP,[ESP]
00574100 : XOR ESI,ESI
00574102 : MOV dword ptr [ESP + 0x24],ESI
00574106 : MOV DL,byte ptr [ECX + EAX*0x1]
00574109 : INC EAX
0057410a : MOV dword ptr [ESP + 0x20],EAX
0057410e : TEST DL,DL
00574110 : JNZ 0x00574100
00574112 : MOV DL,byte ptr [ESP + 0x12]
00574116 : JMP 0x0057411b
00574118 : MOV dword ptr [EBP + 0x50],EBX
0057411b : TEST DL,0x40
0057411e : JZ 0x0057414f
00574120 : OR byte ptr [EBP + 0x4b],0x40
00574124 : CMP ESI,EBX
00574126 : JZ 0x0057412d
00574128 : INC EAX
00574129 : MOV dword ptr [ESP + 0x20],EAX
0057412d : XOR ESI,ESI
0057412f : MOV dword ptr [ESP + 0x24],ESI
00574133 : MOVZX DI,byte ptr [ECX + EAX*0x1 + 0x1]
00574139 : MOVZX CX,byte ptr [ECX + EAX*0x1]
0057413e : SHL DI,0x8
00574142 : OR DI,CX
00574145 : MOVZX ECX,DI
00574148 : ADD EAX,0x2
0057414b : MOV word ptr [EBP + 0x48],CX
0057414f : XOR EDI,EDI
00574151 : CMP byte ptr [ESP + 0x13],BL
00574155 : JZ 0x005742bd
0057415b : MOV ECX,dword ptr [ESP + 0x14]
0057415f : MOV EDI,dword ptr [ECX + 0x5]
00574162 : CMP EDI,EBX
00574164 : JNZ 0x005742bd
0057416a : CMP ESI,EBX
0057416c : JZ 0x0057416f
0057416e : INC EAX
0057416f : ADD EAX,0x2
00574172 : CMP byte ptr [ESP + 0x30],0x6
00574177 : MOV dword ptr [ESP + 0x24],EBX
0057417b : SETNC DL
0057417e : MOV byte ptr [ESP + 0x30],DL
00574182 : TEST DL,DL
00574184 : JZ 0x0057418b
00574186 : ADD EAX,0x4
00574189 : JMP 0x0057418e
0057418b : ADD EAX,0x2
0057418e : PUSH ECX
0057418f : MOV dword ptr [ESP + 0x24],EAX
00574193 : CALL 0x00515dd0
00574198 : PUSH EBX
00574199 : PUSH 0xc
0057419b : MOV ECX,EAX
0057419d : CALL 0x00515840
005741a2 : CMP EAX,EBX
005741a4 : JZ 0x005741b2
005741a6 : MOV dword ptr [EAX],EBX
005741a8 : MOV dword ptr [EAX + 0x4],EBX
005741ab : MOV dword ptr [EAX + 0x8],EBX
005741ae : MOV EDI,EAX
005741b0 : JMP 0x005741c0
005741b2 : XOR EDI,EDI
005741b4 : JMP 0x005741c0
005741b6 : XOR EBX,EBX
005741b8 : JMP 0x005741c0
005741c0 : MOV ECX,dword ptr [ESP + 0x20]
005741c4 : CMP dword ptr [ESP + 0x24],EBX
005741c8 : JZ 0x005741cf
005741ca : INC ECX
005741cb : MOV dword ptr [ESP + 0x20],ECX
005741cf : CMP byte ptr [ESP + 0x30],0x0
005741d4 : MOV dword ptr [ESP + 0x24],EBX
005741d8 : JZ 0x00574207
005741da : MOV EDX,dword ptr [ESP + 0x18]
005741de : MOVZX EAX,byte ptr [EDX + ECX*0x1 + 0x3]
005741e3 : MOVZX ESI,byte ptr [EDX + ECX*0x1 + 0x2]
005741e8 : SHL EAX,0x8
005741eb : OR EAX,ESI
005741ed : MOVZX ESI,byte ptr [EDX + ECX*0x1 + 0x1]
005741f2 : MOVZX EDX,byte ptr [EDX + ECX*0x1]
005741f6 : SHL EAX,0x8
005741f9 : OR EAX,ESI
005741fb : SHL EAX,0x8
005741fe : OR EAX,EDX
00574200 : ADD ECX,0x4
00574203 : MOV ESI,EAX
00574205 : JMP 0x00574226
00574207 : MOV EAX,dword ptr [ESP + 0x18]
0057420b : MOVZX DX,byte ptr [EAX + ECX*0x1 + 0x1]
00574211 : MOVZX AX,byte ptr [EAX + ECX*0x1]
00574216 : SHL DX,0x8
0057421a : OR DX,AX
0057421d : MOVZX EAX,DX
00574220 : ADD ECX,0x2
00574223 : MOVZX ESI,AX
00574226 : MOV dword ptr [ESP + 0x20],ECX
0057422a : MOV ECX,dword ptr [ESP + 0x14]
0057422e : CMP ESI,EBX
00574230 : JZ 0x005742b6
00574236 : PUSH ECX
00574237 : CALL 0x00515dd0
0057423c : PUSH EBX
0057423d : PUSH 0x14
0057423f : MOV ECX,EAX
00574241 : CALL 0x00515840
00574246 : CMP EAX,EBX
00574248 : JZ 0x00574267
0057424a : XOR EDX,EDX
0057424c : MOV dword ptr [EAX],EBX
0057424e : MOV dword ptr [EAX + 0x4],EBX
00574251 : MOV word ptr [EAX + 0x8],DX
00574255 : MOV byte ptr [EAX + 0xa],DL
00574258 : MOV byte ptr [EAX + 0xb],0xff
0057425c : MOV byte ptr [EAX + 0xc],DL
0057425f : MOV byte ptr [EAX + 0xd],DL
00574262 : MOV dword ptr [EAX + 0x10],EBX
00574265 : MOV EBX,EAX
00574267 : PUSH ESI
00574268 : LEA EAX,[ESP + 0x1c]
0057426c : PUSH EAX
0057426d : MOV ECX,EBX
0057426f : CALL 0x0056bd40
00574274 : MOV ESI,dword ptr [EDI + 0x4]
00574277 : INC ESI
00574278 : CMP ESI,dword ptr [EDI + 0x4]
0057427b : JNC 0x00574289
0057427d : MOV ECX,dword ptr [EDI + 0x8]
00574280 : SHR ECX,0x1
00574282 : CMP ESI,ECX
00574284 : JNC 0x0057429e
00574286 : PUSH ESI
00574287 : JMP 0x00574296
00574289 : CMP ESI,dword ptr [EDI + 0x8]
0057428c : JC 0x0057429e
0057428e : MOV EDX,ESI
00574290 : SHR EDX,0x2
00574293 : ADD EDX,ESI
00574295 : PUSH EDX
00574296 : PUSH EDI
00574297 : MOV ECX,EDI
00574299 : CALL 0x0056c310
0057429e : MOV EAX,dword ptr [EDI]
005742a0 : LEA EAX,[EAX + ESI*0x4 + -0x4]
005742a4 : MOV dword ptr [EDI + 0x4],ESI
005742a7 : TEST EAX,EAX
005742a9 : JZ 0x005741b6
005742af : MOV dword ptr [EAX],EBX
005742b1 : JMP 0x005741b6
005742b6 : MOV DL,byte ptr [ESP + 0x12]
005742ba : MOV dword ptr [ECX + 0x5],EDI
005742bd : MOV AL,DL
005742bf : SHR AL,0x1
005742c1 : AND AL,0x1
005742c3 : AND DL,0x1
005742c6 : MOV dword ptr [EBP + 0x4c],EDI
005742c9 : MOV dword ptr [EBP + 0x54],EBX
005742cc : TEST AL,AL
005742ce : JZ 0x005742e5
005742d0 : TEST DL,DL
005742d2 : JZ 0x005742f0
005742d4 : POP EDI
005742d5 : POP ESI
005742d6 : MOV dword ptr [EBP + 0x54],0x2
005742dd : POP EBP
005742de : POP EBX
005742df : ADD ESP,0x18
005742e2 : RET 0x8
005742e5 : TEST DL,DL
005742e7 : JZ 0x005742f0
005742e9 : MOV dword ptr [EBP + 0x54],0x1
005742f0 : POP EDI
005742f1 : POP ESI
005742f2 : POP EBP
005742f3 : POP EBX
005742f4 : ADD ESP,0x18
005742f7 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_0099b250
ENTRY    : 0099b250
BODY     : [[0099b250, 0099b325] [0099b32b, 0099b449]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0099b250(int param_1,ushort *param_2)

{
  ushort uVar1;
  uint uVar2;
  int *piVar3;
  int iVar4;
  ushort *puVar5;
  ushort *puVar6;
  ushort *puVar7;
  uint uVar8;
  undefined1 local_30 [8];
  int local_28;
  int *local_24;
  int local_20;
  int local_1c;
  int local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b60b4a;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar4 = *(int *)(param_1 + 4);
  uVar8 = (*param_2 & 0x1fff) - 6;
  FUN_00401c00(*(undefined4 *)(*(int *)(iVar4 + 4) + 4));
  *(int *)(*(int *)(iVar4 + 4) + 4) = *(int *)(iVar4 + 4);
  *(undefined4 *)(iVar4 + 8) = 0;
  *(undefined4 *)*(undefined4 *)(iVar4 + 4) = *(undefined4 *)(iVar4 + 4);
  local_1c = 0;
  *(int *)(*(int *)(iVar4 + 4) + 8) = *(int *)(iVar4 + 4);
  puVar6 = param_2 + 3;
  if (param_2[2] != 0) {
    do {
      local_18 = FUN_006f0760(0x68,"",0,(DAT_01725270 >> 3 & 1) == 0,uVar2);
      local_8 = 0;
      if (local_18 == 0) {
        piVar3 = (int *)0x0;
      }
      else {
        piVar3 = (int *)FUN_00412470(local_18);
      }
      local_8 = 0xffffffff;
      puVar7 = puVar6;
      if (puVar6 == (ushort *)0x0) {
LAB_0099b311:
        if (piVar3 != (int *)0x0) {
LAB_0099b319:
          FUN_00411330(piVar3);
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
      }
      else {
        if (uVar8 < 4) {
          local_14 = 0;
          puVar7 = (ushort *)0x0;
          uVar8 = 0;
          goto LAB_0099b311;
        }
        uVar8 = uVar8 - 4;
        *piVar3 = *(int *)puVar6;
        puVar7 = (ushort *)0x0;
        if (puVar6 + 2 == (ushort *)0x0) goto LAB_0099b311;
        if (((uVar8 < 2) || (uVar1 = puVar6[2], (short)uVar1 < 0)) ||
           (iVar4 = (int)(short)uVar1, (int)uVar8 < iVar4 + 2)) {
          local_14 = 0;
          FUN_00411330(piVar3);
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_14 = uVar8 + (-2 - iVar4);
        puVar7 = (ushort *)((int)puVar6 + iVar4 + 6);
        if (puVar7 == (ushort *)0x0) goto LAB_0099b319;
        puVar5 = puVar6 + 3;
        do {
          uVar1 = *puVar5;
          puVar5 = puVar5 + 1;
        } while (uVar1 != 0);
        FUN_00406360(puVar6 + 3,(int)puVar5 - (int)(puVar6 + 4) >> 1);
        local_18 = *piVar3;
        *(undefined2 *)(piVar3 + 2) = 1;
        *(undefined2 *)(piVar3 + 6) = 1;
        piVar3[3] = 0;
        *(undefined1 *)((int)piVar3 + 10) = 1;
        piVar3[1] = 1;
        iVar4 = *(int *)(param_1 + 4);
        FUN_004437f0(&local_18);
        uVar8 = local_14;
        if (local_20 == *(int *)(iVar4 + 4)) {
          local_28 = local_18;
          local_24 = piVar3;
          FUN_00451e00(local_30,&local_28);
          uVar8 = local_14;
        }
      }
      local_1c = local_1c + 1;
      puVar6 = puVar7;
    } while (local_1c < (int)(uint)param_2[2]);
  }
  FUN_0099aee0();
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
0099b250 : PUSH EBP
0099b251 : MOV EBP,ESP
0099b253 : PUSH -0x1
0099b255 : PUSH 0xb60b4a
0099b25a : MOV EAX,FS:[0x0]
0099b260 : PUSH EAX
0099b261 : SUB ESP,0x24
0099b264 : PUSH EBX
0099b265 : PUSH ESI
0099b266 : PUSH EDI
0099b267 : MOV EAX,[0x00d66fa0]
0099b26c : XOR EAX,EBP
0099b26e : PUSH EAX
0099b26f : LEA EAX,[EBP + -0xc]
0099b272 : MOV FS:[0x0],EAX
0099b278 : MOV EAX,dword ptr [EBP + 0xc]
0099b27b : MOVZX EDI,word ptr [EAX]
0099b27e : LEA EBX,[EAX + 0x6]
0099b281 : MOV EAX,dword ptr [EBP + 0x8]
0099b284 : MOV ESI,dword ptr [EAX + 0x4]
0099b287 : MOV ECX,dword ptr [ESI + 0x4]
0099b28a : MOV EDX,dword ptr [ECX + 0x4]
0099b28d : AND EDI,0x1fff
0099b293 : PUSH EDX
0099b294 : MOV ECX,ESI
0099b296 : SUB EDI,0x6
0099b299 : CALL 0x00401c00
0099b29e : MOV EAX,dword ptr [ESI + 0x4]
0099b2a1 : MOV dword ptr [EAX + 0x4],EAX
0099b2a4 : MOV EAX,dword ptr [ESI + 0x4]
0099b2a7 : XOR ECX,ECX
0099b2a9 : MOV dword ptr [ESI + 0x8],ECX
0099b2ac : MOV dword ptr [EAX],EAX
0099b2ae : MOV ESI,dword ptr [ESI + 0x4]
0099b2b1 : MOV dword ptr [EBP + -0x18],ECX
0099b2b4 : MOV ECX,dword ptr [EBP + 0xc]
0099b2b7 : XOR EAX,EAX
0099b2b9 : MOV dword ptr [ESI + 0x8],ESI
0099b2bc : CMP AX,word ptr [ECX + 0x4]
0099b2c0 : JNC 0x0099b40c
0099b2c6 : MOV EDX,dword ptr [0x01725270]
0099b2cc : SHR EDX,0x3
0099b2cf : MOV EAX,0x0
0099b2d4 : AND EDX,0x1
0099b2d7 : SETZ AL
0099b2da : PUSH EAX
0099b2db : PUSH 0x0
0099b2dd : PUSH 0xbf1a4a
0099b2e2 : PUSH 0x68
0099b2e4 : CALL 0x006f0760
0099b2e9 : ADD ESP,0x10
0099b2ec : MOV dword ptr [EBP + -0x14],EAX
0099b2ef : XOR ECX,ECX
0099b2f1 : MOV dword ptr [EBP + -0x4],ECX
0099b2f4 : CMP EAX,ECX
0099b2f6 : JZ 0x0099b304
0099b2f8 : PUSH EAX
0099b2f9 : CALL 0x00412470
0099b2fe : MOV ESI,EAX
0099b300 : XOR ECX,ECX
0099b302 : JMP 0x0099b306
0099b304 : XOR ESI,ESI
0099b306 : MOV dword ptr [EBP + -0x4],0xffffffff
0099b30d : CMP EBX,ECX
0099b30f : JNZ 0x0099b32b
0099b311 : CMP ESI,ECX
0099b313 : JZ 0x0099b3f6
0099b319 : PUSH ESI
0099b31a : CALL 0x00411330
0099b31f : MOV ECX,ESI
0099b321 : CALL 0x006f04e0
0099b32b : CMP EDI,0x4
0099b32e : JC 0x0099b42a
0099b334 : MOV EDX,dword ptr [EBX]
0099b336 : ADD EBX,0x4
0099b339 : SUB EDI,0x4
0099b33c : MOV dword ptr [ESI],EDX
0099b33e : CMP EBX,ECX
0099b340 : JZ 0x0099b311
0099b342 : CMP EDI,0x2
0099b345 : JC 0x0099b436
0099b34b : MOVZX EAX,word ptr [EBX]
0099b34e : CMP AX,CX
0099b351 : JL 0x0099b436
0099b357 : CWDE
0099b358 : LEA EDX,[EAX + 0x2]
0099b35b : CMP EDI,EDX
0099b35d : JL 0x0099b436
0099b363 : MOV ECX,0xfffffffe
0099b368 : SUB ECX,EAX
0099b36a : LEA EDX,[EBX + 0x2]
0099b36d : ADD EDI,ECX
0099b36f : LEA EBX,[EBX + EAX*0x1 + 0x2]
0099b373 : MOV dword ptr [EBP + -0x10],EDI
0099b376 : TEST EBX,EBX
0099b378 : JZ 0x0099b319
0099b37a : MOV EAX,EDX
0099b37c : LEA EDI,[EAX + 0x2]
0099b37f : NOP
0099b380 : MOV CX,word ptr [EAX]
0099b383 : ADD EAX,0x2
0099b386 : TEST CX,CX
0099b389 : JNZ 0x0099b380
0099b38b : SUB EAX,EDI
0099b38d : SAR EAX,0x1
0099b38f : PUSH EAX
0099b390 : PUSH EDX
0099b391 : LEA ECX,[ESI + 0x28]
0099b394 : CALL 0x00406360
0099b399 : MOV ECX,dword ptr [ESI]
0099b39b : MOV EDX,0x1
0099b3a0 : MOV EAX,EDX
0099b3a2 : MOV word ptr [ESI + 0x8],DX
0099b3a6 : MOV EDX,dword ptr [EBP + 0x8]
0099b3a9 : MOV word ptr [ESI + 0x18],AX
0099b3ad : MOV dword ptr [ESI + 0xc],0x0
0099b3b4 : MOV byte ptr [ESI + 0xa],0x1
0099b3b8 : MOV dword ptr [ESI + 0x4],0x1
0099b3bf : MOV EDI,dword ptr [EDX + 0x4]
0099b3c2 : LEA EAX,[EBP + -0x14]
0099b3c5 : MOV dword ptr [EBP + -0x14],ECX
0099b3c8 : PUSH EAX
0099b3c9 : LEA EAX,[EBP + -0x1c]
0099b3cc : MOV ECX,EDI
0099b3ce : CALL 0x004437f0
0099b3d3 : MOV ECX,dword ptr [EBP + -0x1c]
0099b3d6 : CMP ECX,dword ptr [EDI + 0x4]
0099b3d9 : JNZ 0x0099b3f3
0099b3db : MOV EDX,dword ptr [EBP + -0x14]
0099b3de : LEA EAX,[EBP + -0x24]
0099b3e1 : PUSH EAX
0099b3e2 : LEA ECX,[EBP + -0x2c]
0099b3e5 : PUSH ECX
0099b3e6 : MOV EAX,EDI
0099b3e8 : MOV dword ptr [EBP + -0x24],EDX
0099b3eb : MOV dword ptr [EBP + -0x20],ESI
0099b3ee : CALL 0x00451e00
0099b3f3 : MOV EDI,dword ptr [EBP + -0x10]
0099b3f6 : MOV EDX,dword ptr [EBP + 0xc]
0099b3f9 : MOV EAX,dword ptr [EBP + -0x18]
0099b3fc : MOVZX ECX,word ptr [EDX + 0x4]
0099b400 : INC EAX
0099b401 : CMP EAX,ECX
0099b403 : MOV dword ptr [EBP + -0x18],EAX
0099b406 : JL 0x0099b2c6
0099b40c : MOV EDI,dword ptr [EBP + 0x8]
0099b40f : XOR ECX,ECX
0099b411 : CALL 0x0099aee0
0099b416 : MOV ECX,dword ptr [EBP + -0xc]
0099b419 : MOV dword ptr FS:[0x0],ECX
0099b420 : POP ECX
0099b421 : POP EDI
0099b422 : POP ESI
0099b423 : POP EBX
0099b424 : MOV ESP,EBP
0099b426 : POP EBP
0099b427 : RET 0x8
0099b42a : MOV dword ptr [EBP + -0x10],ECX
0099b42d : XOR EBX,EBX
0099b42f : MOV EDI,ECX
0099b431 : JMP 0x0099b311
0099b436 : PUSH ESI
0099b437 : MOV dword ptr [EBP + -0x10],ECX
0099b43a : XOR EBX,EBX
0099b43c : MOV EDI,ECX
0099b43e : CALL 0x00411330
0099b443 : MOV ECX,ESI
0099b445 : CALL 0x006f04e0

PROGRAM  : Maestia.exe
FUNCTION : FUN_00590b70
ENTRY    : 00590b70
BODY     : [[00590b70, 00590d0a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00590b70(undefined4 param_1)

{
  char cVar1;
  uint uVar2;
  int iVar3;
  int *in_ECX;
  uint unaff_retaddr;
  uint uStack_8;
  byte bStack_4;
  
  (**(code **)(*in_ECX + 0x1c))(&DAT_00b8b8fc);
  uVar2 = FUN_0056aad0();
  uVar2 = uVar2 & 0xffff;
  cVar1 = FUN_0056ac00();
  uStack_8 = uVar2;
  iVar3 = FUN_0058c4d0((int *)(unaff_retaddr + 0x14),0,*(undefined4 *)(unaff_retaddr + 0x18),
                       &uStack_8,&LAB_00589b40);
  if ((((iVar3 == 0) ||
       (iVar3 = *(int *)(*(int *)(unaff_retaddr + 0x14) + -4 + iVar3 * 4),
       *(uint *)(iVar3 + 0xc) != uVar2)) || (iVar3 == 0)) || ((*(byte *)(iVar3 + 0x35) & 2) != 0)) {
    iVar3 = FUN_0058ff30(uVar2);
    *(char *)(iVar3 + 0x34) = cVar1;
    *(int **)(iVar3 + 0x30) = in_ECX;
    *(int **)(iVar3 + 0x2c) = in_ECX;
    *(int **)(iVar3 + 0x28) = in_ECX;
    *(int **)(iVar3 + 0x24) = in_ECX;
    *(int **)(iVar3 + 0x20) = in_ECX;
    *(int **)(iVar3 + 0x1c) = in_ECX;
    *(int **)(iVar3 + 0x18) = in_ECX;
    *(int **)(iVar3 + 0x14) = in_ECX;
    *(int **)(iVar3 + 0x10) = in_ECX;
    *(undefined4 *)(iVar3 + 8) = param_1;
    return;
  }
  if (cVar1 == '\x01') {
    (**(code **)(*in_ECX + 0x28))(&param_1);
    if ((unaff_retaddr & 4) != 0) {
      *(int **)(iVar3 + 0x14) = in_ECX;
    }
    if ((unaff_retaddr & 8) != 0) {
      *(int **)(iVar3 + 0x18) = in_ECX;
    }
    if ((unaff_retaddr & 0x20) != 0) {
      *(int **)(iVar3 + 0x1c) = in_ECX;
    }
    if ((char)unaff_retaddr < '\0') {
      *(int **)(iVar3 + 0x20) = in_ECX;
    }
    if ((unaff_retaddr & 1) != 0) {
      *(int **)(iVar3 + 0x24) = in_ECX;
    }
    if ((unaff_retaddr & 0x40) != 0) {
      *(int **)(iVar3 + 0x28) = in_ECX;
    }
    if ((unaff_retaddr & 0x10) != 0) {
      *(int **)(iVar3 + 0x2c) = in_ECX;
    }
    if ((unaff_retaddr & 2) != 0) {
      *(int **)(iVar3 + 0x30) = in_ECX;
    }
    return;
  }
  if (cVar1 != '\x02') {
    *(int **)(iVar3 + 0x30) = in_ECX;
    *(int **)(iVar3 + 0x2c) = in_ECX;
    *(int **)(iVar3 + 0x28) = in_ECX;
    *(int **)(iVar3 + 0x24) = in_ECX;
    *(int **)(iVar3 + 0x20) = in_ECX;
    *(int **)(iVar3 + 0x1c) = in_ECX;
    *(int **)(iVar3 + 0x18) = in_ECX;
    *(int **)(iVar3 + 0x14) = in_ECX;
    *(int **)(iVar3 + 0x10) = in_ECX;
    *(undefined4 *)(iVar3 + 8) = param_1;
    return;
  }
  if (*(char *)(iVar3 + 0x34) != '\0') {
    *(undefined1 *)(iVar3 + 0x34) = 2;
  }
  (**(code **)(*in_ECX + 0x28))(&stack0x00000000);
  if ((bStack_4 & 4) != 0) {
    *(int **)(iVar3 + 0x14) = in_ECX;
  }
  if ((bStack_4 & 8) != 0) {
    *(int **)(iVar3 + 0x18) = in_ECX;
  }
  if ((bStack_4 & 0x20) != 0) {
    *(int **)(iVar3 + 0x1c) = in_ECX;
  }
  if ((char)bStack_4 < '\0') {
    *(int **)(iVar3 + 0x20) = in_ECX;
  }
  if ((bStack_4 & 1) != 0) {
    *(int **)(iVar3 + 0x24) = in_ECX;
  }
  if ((bStack_4 & 0x40) != 0) {
    *(int **)(iVar3 + 0x28) = in_ECX;
  }
  if ((bStack_4 & 0x10) != 0) {
    *(int **)(iVar3 + 0x2c) = in_ECX;
  }
  if ((bStack_4 & 2) != 0) {
    *(int **)(iVar3 + 0x30) = in_ECX;
  }
  *(uint *)(iVar3 + 8) = unaff_retaddr;
  return;
}



============================================================
DISASSEMBLY
============================================================
00590b70 : SUB ESP,0x8
00590b73 : PUSH EBP
00590b74 : PUSH ESI
00590b75 : MOV ESI,ECX
00590b77 : MOV EAX,dword ptr [ESI]
00590b79 : MOV EDX,dword ptr [EAX + 0x1c]
00590b7c : PUSH EDI
00590b7d : PUSH 0xb8b8fc
00590b82 : CALL EDX
00590b84 : MOV ECX,ESI
00590b86 : CALL 0x0056aad0
00590b8b : MOV ECX,ESI
00590b8d : MOVZX EDI,AX
00590b90 : CALL 0x0056ac00
00590b95 : MOVZX EBP,DI
00590b98 : MOV EDI,dword ptr [ESP + 0x18]
00590b9c : PUSH 0x589b40
00590ba1 : ADD EDI,0x14
00590ba4 : LEA ECX,[ESP + 0x14]
00590ba8 : PUSH ECX
00590ba9 : MOV byte ptr [ESP + 0x17],AL
00590bad : MOV EAX,dword ptr [EDI + 0x4]
00590bb0 : PUSH EAX
00590bb1 : PUSH 0x0
00590bb3 : PUSH EDI
00590bb4 : MOV dword ptr [ESP + 0x24],EBP
00590bb8 : CALL 0x0058c4d0
00590bbd : ADD ESP,0x14
00590bc0 : TEST EAX,EAX
00590bc2 : JZ 0x00590bda
00590bc4 : MOV EDX,dword ptr [EDI]
00590bc6 : MOV EDI,dword ptr [EDX + EAX*0x4 + -0x4]
00590bca : DEC EAX
00590bcb : CMP dword ptr [EDI + 0xc],EBP
00590bce : JNZ 0x00590bda
00590bd0 : TEST EDI,EDI
00590bd2 : JZ 0x00590bda
00590bd4 : TEST byte ptr [EDI + 0x35],0x2
00590bd8 : JZ 0x00590c16
00590bda : MOV ECX,dword ptr [ESP + 0x18]
00590bde : PUSH EBP
00590bdf : CALL 0x0058ff30
00590be4 : MOV CL,byte ptr [ESP + 0xf]
00590be8 : MOV EDX,dword ptr [ESP + 0x1c]
00590bec : MOV byte ptr [EAX + 0x34],CL
00590bef : POP EDI
00590bf0 : MOV dword ptr [EAX + 0x30],ESI
00590bf3 : MOV dword ptr [EAX + 0x2c],ESI
00590bf6 : MOV dword ptr [EAX + 0x28],ESI
00590bf9 : MOV dword ptr [EAX + 0x24],ESI
00590bfc : MOV dword ptr [EAX + 0x20],ESI
00590bff : MOV dword ptr [EAX + 0x1c],ESI
00590c02 : MOV dword ptr [EAX + 0x18],ESI
00590c05 : MOV dword ptr [EAX + 0x14],ESI
00590c08 : MOV dword ptr [EAX + 0x10],ESI
00590c0b : POP ESI
00590c0c : MOV dword ptr [EAX + 0x8],EDX
00590c0f : POP EBP
00590c10 : ADD ESP,0x8
00590c13 : RET 0x8
00590c16 : MOVZX EAX,byte ptr [ESP + 0xf]
00590c1b : SUB EAX,0x1
00590c1e : JZ 0x00590cb8
00590c24 : SUB EAX,0x1
00590c27 : JZ 0x00590c54
00590c29 : MOV EAX,dword ptr [ESP + 0x1c]
00590c2d : MOV dword ptr [EDI + 0x30],ESI
00590c30 : MOV dword ptr [EDI + 0x2c],ESI
00590c33 : MOV dword ptr [EDI + 0x28],ESI
00590c36 : MOV dword ptr [EDI + 0x24],ESI
00590c39 : MOV dword ptr [EDI + 0x20],ESI
00590c3c : MOV dword ptr [EDI + 0x1c],ESI
00590c3f : MOV dword ptr [EDI + 0x18],ESI
00590c42 : MOV dword ptr [EDI + 0x14],ESI
00590c45 : MOV dword ptr [EDI + 0x10],ESI
00590c48 : MOV dword ptr [EDI + 0x8],EAX
00590c4b : POP EDI
00590c4c : POP ESI
00590c4d : POP EBP
00590c4e : ADD ESP,0x8
00590c51 : RET 0x8
00590c54 : CMP byte ptr [EDI + 0x34],0x0
00590c58 : JZ 0x00590c5e
00590c5a : MOV byte ptr [EDI + 0x34],0x2
00590c5e : MOV EDX,dword ptr [ESI]
00590c60 : MOV EDX,dword ptr [EDX + 0x28]
00590c63 : LEA EAX,[ESP + 0x18]
00590c67 : PUSH EAX
00590c68 : MOV ECX,ESI
00590c6a : CALL EDX
00590c6c : MOV AL,byte ptr [ESP + 0x18]
00590c70 : TEST AL,0x4
00590c72 : JZ 0x00590c77
00590c74 : MOV dword ptr [EDI + 0x14],ESI
00590c77 : TEST AL,0x8
00590c79 : JZ 0x00590c7e
00590c7b : MOV dword ptr [EDI + 0x18],ESI
00590c7e : TEST AL,0x20
00590c80 : JZ 0x00590c85
00590c82 : MOV dword ptr [EDI + 0x1c],ESI
00590c85 : TEST AL,AL
00590c87 : JNS 0x00590c8c
00590c89 : MOV dword ptr [EDI + 0x20],ESI
00590c8c : TEST AL,0x1
00590c8e : JZ 0x00590c93
00590c90 : MOV dword ptr [EDI + 0x24],ESI
00590c93 : TEST AL,0x40
00590c95 : JZ 0x00590c9a
00590c97 : MOV dword ptr [EDI + 0x28],ESI
00590c9a : TEST AL,0x10
00590c9c : JZ 0x00590ca1
00590c9e : MOV dword ptr [EDI + 0x2c],ESI
00590ca1 : TEST AL,0x2
00590ca3 : JZ 0x00590ca8
00590ca5 : MOV dword ptr [EDI + 0x30],ESI
00590ca8 : MOV EAX,dword ptr [ESP + 0x1c]
00590cac : MOV dword ptr [EDI + 0x8],EAX
00590caf : POP EDI
00590cb0 : POP ESI
00590cb1 : POP EBP
00590cb2 : ADD ESP,0x8
00590cb5 : RET 0x8
00590cb8 : MOV EDX,dword ptr [ESI]
00590cba : MOV EDX,dword ptr [EDX + 0x28]
00590cbd : LEA EAX,[ESP + 0x1c]
00590cc1 : PUSH EAX
00590cc2 : MOV ECX,ESI
00590cc4 : CALL EDX
00590cc6 : MOV AL,byte ptr [ESP + 0x1c]
00590cca : TEST AL,0x4
00590ccc : JZ 0x00590cd1
00590cce : MOV dword ptr [EDI + 0x14],ESI
00590cd1 : TEST AL,0x8
00590cd3 : JZ 0x00590cd8
00590cd5 : MOV dword ptr [EDI + 0x18],ESI
00590cd8 : TEST AL,0x20
00590cda : JZ 0x00590cdf
00590cdc : MOV dword ptr [EDI + 0x1c],ESI
00590cdf : TEST AL,AL
00590ce1 : JNS 0x00590ce6
00590ce3 : MOV dword ptr [EDI + 0x20],ESI
00590ce6 : TEST AL,0x1
00590ce8 : JZ 0x00590ced
00590cea : MOV dword ptr [EDI + 0x24],ESI
00590ced : TEST AL,0x40
00590cef : JZ 0x00590cf4
00590cf1 : MOV dword ptr [EDI + 0x28],ESI
00590cf4 : TEST AL,0x10
00590cf6 : JZ 0x00590cfb
00590cf8 : MOV dword ptr [EDI + 0x2c],ESI
00590cfb : TEST AL,0x2
00590cfd : JZ 0x00590d02
00590cff : MOV dword ptr [EDI + 0x30],ESI
00590d02 : POP EDI
00590d03 : POP ESI
00590d04 : POP EBP
00590d05 : ADD ESP,0x8
00590d08 : RET 0x8

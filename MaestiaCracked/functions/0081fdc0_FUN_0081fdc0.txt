PROGRAM  : Maestia.exe
FUNCTION : FUN_0081fdc0
ENTRY    : 0081fdc0
BODY     : [[0081fdc0, 0081fe44]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0081fdc0(int param_1,undefined4 param_2)

{
  LPCWSTR lpWideCharStr;
  int *piVar1;
  int in_ECX;
  CHAR local_10c [260];
  uint local_8;
  
  local_8 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  if (*(uint *)(param_1 + 0x18) < 8) {
    lpWideCharStr = (LPCWSTR)(param_1 + 4);
  }
  else {
    lpWideCharStr = *(LPCWSTR *)(param_1 + 4);
  }
  WideCharToMultiByte(0,0,lpWideCharStr,-1,local_10c,0x100,(LPCSTR)0x0,(LPBOOL)0x0);
  FUN_0081faa0();
  if (*(int *)(in_ECX + 0x154) == 0) {
    FUN_0081f9a0();
  }
  piVar1 = (int *)FUN_0081bf60();
  (**(code **)(*piVar1 + 0x1c))(local_10c,param_2);
  __security_check_cookie(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0081fdc0 : PUSH EBP
0081fdc1 : MOV EBP,ESP
0081fdc3 : SUB ESP,0x10c
0081fdc9 : MOV EAX,[0x00d66fa0]
0081fdce : XOR EAX,EBP
0081fdd0 : MOV dword ptr [EBP + -0x4],EAX
0081fdd3 : MOV EAX,dword ptr [EBP + 0x8]
0081fdd6 : CMP dword ptr [EAX + 0x18],0x8
0081fdda : PUSH EDI
0081fddb : MOV EDI,ECX
0081fddd : JC 0x0081fde4
0081fddf : MOV EAX,dword ptr [EAX + 0x4]
0081fde2 : JMP 0x0081fde7
0081fde4 : ADD EAX,0x4
0081fde7 : PUSH 0x0
0081fde9 : PUSH 0x0
0081fdeb : PUSH 0x100
0081fdf0 : LEA ECX,[EBP + 0xfffffef8]
0081fdf6 : PUSH ECX
0081fdf7 : PUSH -0x1
0081fdf9 : PUSH EAX
0081fdfa : PUSH 0x0
0081fdfc : PUSH 0x0
0081fdfe : CALL dword ptr [0x00b85130]
0081fe04 : CALL 0x0081faa0
0081fe09 : CMP dword ptr [EDI + 0x154],0x0
0081fe10 : JNZ 0x0081fe19
0081fe12 : MOV ECX,EDI
0081fe14 : CALL 0x0081f9a0
0081fe19 : MOV ECX,EDI
0081fe1b : CALL 0x0081bf60
0081fe20 : MOV ECX,dword ptr [EBP + 0xc]
0081fe23 : MOV EDX,dword ptr [EAX]
0081fe25 : MOV EDX,dword ptr [EDX + 0x1c]
0081fe28 : PUSH ECX
0081fe29 : LEA ECX,[EBP + 0xfffffef8]
0081fe2f : PUSH ECX
0081fe30 : MOV ECX,EAX
0081fe32 : CALL EDX
0081fe34 : MOV ECX,dword ptr [EBP + -0x4]
0081fe37 : XOR ECX,EBP
0081fe39 : POP EDI
0081fe3a : CALL 0x00633e6b
0081fe3f : MOV ESP,EBP
0081fe41 : POP EBP
0081fe42 : RET 0x8

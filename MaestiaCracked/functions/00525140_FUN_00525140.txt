PROGRAM  : Maestia.exe
FUNCTION : FUN_00525140
ENTRY    : 00525140
BODY     : [[00525140, 005251e8]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00525140(uint *param_1)

{
  uint *puVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  uint *puVar5;
  int *in_ECX;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  
  iVar2 = *in_ECX;
  if (iVar2 != 0) {
    uVar3 = *(uint *)(iVar2 + 4);
    uVar6 = *(uint *)(*param_1 + 0xc) & uVar3;
    puVar5 = (uint *)(iVar2 + 8 + uVar6 * 8);
    if ((*(int *)(iVar2 + 8 + uVar6 * 8) != -2) && ((*(uint *)(puVar5[1] + 0xc) & uVar3) == uVar6))
    {
      uVar4 = uVar6;
      uVar8 = 0xffffffff;
      while ((uVar7 = uVar4, (*(uint *)(puVar5[1] + 0xc) & uVar3) != uVar6 ||
             (puVar5[1] != *param_1))) {
        uVar4 = *puVar5;
        if (uVar4 == 0xffffffff) {
          return;
        }
        puVar5 = (uint *)(iVar2 + 8 + uVar4 * 8);
        uVar8 = uVar7;
      }
      uVar3 = *puVar5;
      if (uVar6 == uVar7) {
        if (uVar3 != 0xffffffff) {
          puVar1 = (uint *)(iVar2 + 8 + uVar3 * 8);
          *puVar5 = 0xfffffffe;
          *puVar5 = *puVar1;
          puVar5[1] = puVar1[1];
          puVar5 = puVar1;
        }
      }
      else {
        *(uint *)(iVar2 + 8 + uVar8 * 8) = uVar3;
      }
      *puVar5 = 0xfffffffe;
      *(int *)*in_ECX = *(int *)*in_ECX + -1;
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00525140 : SUB ESP,0x8
00525143 : PUSH EDI
00525144 : MOV EDI,dword ptr [ECX]
00525146 : MOV dword ptr [ESP + 0x8],ECX
0052514a : TEST EDI,EDI
0052514c : JZ 0x005251e2
00525152 : MOV EAX,dword ptr [ESP + 0x10]
00525156 : MOV EAX,dword ptr [EAX]
00525158 : MOV EDX,dword ptr [EAX + 0xc]
0052515b : PUSH EBX
0052515c : MOV EBX,dword ptr [EDI + 0x4]
0052515f : AND EDX,EBX
00525161 : CMP dword ptr [EDI + EDX*0x8 + 0x8],-0x2
00525166 : MOV dword ptr [ESP + 0x8],EAX
0052516a : LEA EAX,[EDI + EDX*0x8 + 0x8]
0052516e : JZ 0x005251e1
00525170 : MOV ECX,dword ptr [EAX + 0x4]
00525173 : MOV ECX,dword ptr [ECX + 0xc]
00525176 : AND ECX,EBX
00525178 : CMP ECX,EDX
0052517a : JNZ 0x005251e1
0052517c : PUSH EBP
0052517d : MOV dword ptr [ESP + 0x18],EDX
00525181 : OR EBP,0xffffffff
00525184 : PUSH ESI
00525185 : MOV ESI,dword ptr [EAX + 0x4]
00525188 : MOV ECX,dword ptr [ESI + 0xc]
0052518b : AND ECX,EBX
0052518d : CMP ECX,dword ptr [ESP + 0x1c]
00525191 : JNZ 0x00525199
00525193 : CMP ESI,dword ptr [ESP + 0x10]
00525197 : JZ 0x005251a8
00525199 : MOV EBP,EDX
0052519b : MOV EDX,dword ptr [EAX]
0052519d : CMP EDX,-0x1
005251a0 : JZ 0x005251df
005251a2 : LEA EAX,[EDI + EDX*0x8 + 0x8]
005251a6 : JMP 0x00525185
005251a8 : CMP dword ptr [ESP + 0x1c],EDX
005251ac : MOV EDX,dword ptr [EAX]
005251ae : JNZ 0x005251cd
005251b0 : CMP EDX,-0x1
005251b3 : JZ 0x005251d1
005251b5 : LEA EDX,[EDI + EDX*0x8 + 0x8]
005251b9 : MOV dword ptr [EAX],0xfffffffe
005251bf : MOV ECX,dword ptr [EDX]
005251c1 : MOV dword ptr [EAX],ECX
005251c3 : MOV ECX,dword ptr [EDX + 0x4]
005251c6 : MOV dword ptr [EAX + 0x4],ECX
005251c9 : MOV EAX,EDX
005251cb : JMP 0x005251d1
005251cd : MOV dword ptr [EDI + EBP*0x8 + 0x8],EDX
005251d1 : MOV dword ptr [EAX],0xfffffffe
005251d7 : MOV EAX,dword ptr [ESP + 0x14]
005251db : MOV EAX,dword ptr [EAX]
005251dd : DEC dword ptr [EAX]
005251df : POP ESI
005251e0 : POP EBP
005251e1 : POP EBX
005251e2 : POP EDI
005251e3 : ADD ESP,0x8
005251e6 : RET 0x4

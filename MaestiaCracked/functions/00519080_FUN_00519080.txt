PROGRAM  : Maestia.exe
FUNCTION : FUN_00519080
ENTRY    : 00519080
BODY     : [[00519080, 0051912c] [00519130, 00519326]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00519080(int param_1,uint param_2,int param_3,uint param_4,int param_5)

{
  byte *pbVar1;
  undefined1 *puVar2;
  uint in_EAX;
  uint uVar3;
  uint uVar4;
  int in_ECX;
  byte bVar5;
  int in_EDX;
  uint uVar6;
  uint unaff_EDI;
  uint local_8;
  
  uVar3 = in_EAX >> 3;
  param_2 = param_2 >> 3;
  if (in_EDX == 1) {
    if (param_3 == 9) {
      uVar6 = 0;
      uVar4 = 0;
      if (unaff_EDI != 0) {
        do {
          if (param_4 <= uVar4) break;
          *(undefined1 *)(uVar4 + in_ECX) = *(undefined1 *)(param_1 + 3 + uVar6);
          uVar4 = uVar4 + uVar3;
          uVar6 = uVar6 + param_2;
        } while (uVar6 < unaff_EDI);
      }
      return CONCAT31((int3)(uVar4 >> 8),1);
    }
    if (param_3 == 2) {
      uVar4 = 0;
      uVar6 = 0;
      if (unaff_EDI != 0) {
        do {
          if (param_4 <= uVar6) break;
          *(undefined1 *)(in_ECX + uVar6) = *(undefined1 *)(uVar4 + param_1);
          *(undefined1 *)(in_ECX + 1 + uVar6) = *(undefined1 *)(uVar4 + 1 + param_1);
          *(undefined1 *)(in_ECX + 2 + uVar6) = *(undefined1 *)(uVar4 + 2 + param_1);
          uVar6 = uVar6 + uVar3;
          uVar4 = uVar4 + param_2;
        } while (uVar4 < unaff_EDI);
      }
      return CONCAT31((int3)(uVar4 >> 8),1);
    }
  }
  else if (in_EDX == 2) {
    if (param_3 == 9) {
      uVar6 = 0;
      local_8 = 0;
      uVar4 = uVar3;
      if (unaff_EDI != 0) {
        do {
          uVar4 = local_8;
          if (param_4 <= local_8) break;
          *(char *)(local_8 + in_ECX) =
               (char)(((uint)*(byte *)(param_1 + 2 + uVar6) + (uint)*(byte *)(param_1 + 1 + uVar6) +
                      (uint)*(byte *)(param_1 + uVar6)) / 3);
          uVar4 = local_8 + uVar3;
          uVar6 = uVar6 + param_2;
          local_8 = uVar4;
        } while (uVar6 < unaff_EDI);
      }
      return CONCAT31((int3)(uVar4 >> 8),1);
    }
    if (param_3 == 1) {
      uVar6 = 0;
      uVar4 = 0;
      if (unaff_EDI != 0) {
        do {
          if (param_4 <= uVar4) break;
          *(undefined1 *)(uVar4 + in_ECX) = *(undefined1 *)(param_1 + uVar6);
          *(undefined1 *)(uVar4 + 1 + in_ECX) = *(undefined1 *)(param_1 + 1 + uVar6);
          *(undefined1 *)(uVar4 + 2 + in_ECX) = *(undefined1 *)(param_1 + 2 + uVar6);
          *(undefined1 *)(uVar4 + 3 + in_ECX) = 0xff;
          uVar4 = uVar4 + uVar3;
          uVar6 = uVar6 + param_2;
        } while (uVar6 < unaff_EDI);
      }
      return CONCAT31((int3)(uVar4 >> 8),1);
    }
  }
  else if (in_EDX == 100) {
    if (param_3 == 9) {
      uVar6 = 0;
      local_8 = 0;
      uVar4 = uVar3;
      if (unaff_EDI != 0) {
        do {
          uVar4 = local_8;
          if (param_4 <= local_8) break;
          pbVar1 = (byte *)(param_5 + 0xc + (uint)*(byte *)(param_1 + uVar6) * 4);
          if (*(char *)(param_5 + 8) == '\0') {
            bVar5 = (byte)(((uint)pbVar1[2] + (uint)pbVar1[1] + (uint)*pbVar1) / 3);
          }
          else {
            bVar5 = pbVar1[3];
          }
          *(byte *)(local_8 + in_ECX) = bVar5;
          uVar4 = local_8 + uVar3;
          uVar6 = uVar6 + param_2;
          local_8 = uVar4;
        } while (uVar6 < unaff_EDI);
      }
      return CONCAT31((int3)(uVar4 >> 8),1);
    }
    if ((param_3 == 2) || (param_3 == 1)) {
      uVar4 = 0;
      local_8 = 0;
      if (unaff_EDI != 0) {
        do {
          if (param_4 <= uVar4) break;
          puVar2 = (undefined1 *)(param_5 + 0xc + (uint)*(byte *)(local_8 + param_1) * 4);
          *(undefined1 *)(uVar4 + in_ECX) = *puVar2;
          *(undefined1 *)(uVar4 + 1 + in_ECX) = puVar2[1];
          *(undefined1 *)(uVar4 + 2 + in_ECX) = puVar2[2];
          if (param_3 == 1) {
            *(undefined1 *)(uVar4 + 3 + in_ECX) = puVar2[3];
          }
          uVar4 = uVar4 + uVar3;
          local_8 = local_8 + param_2;
        } while (local_8 < unaff_EDI);
      }
      return CONCAT31((int3)(uVar4 >> 8),1);
    }
  }
  else if (in_EDX == 9) {
    if (param_3 == 2) {
      uVar4 = 0;
      uVar6 = 0;
      if (unaff_EDI != 0) {
        do {
          if (param_4 <= uVar6) break;
          *(undefined1 *)(in_ECX + uVar6) = *(undefined1 *)(uVar4 + param_1);
          *(undefined1 *)(in_ECX + 1 + uVar6) = *(undefined1 *)(uVar4 + param_1);
          *(undefined1 *)(in_ECX + 2 + uVar6) = *(undefined1 *)(uVar4 + param_1);
          uVar6 = uVar6 + uVar3;
          uVar4 = uVar4 + param_2;
        } while (uVar4 < unaff_EDI);
      }
      return CONCAT31((int3)(uVar4 >> 8),1);
    }
    if (param_3 == 1) {
      uVar6 = 0;
      uVar4 = 0;
      if (unaff_EDI != 0) {
        do {
          if (param_4 <= uVar4) break;
          *(undefined1 *)(uVar4 + in_ECX) = 0xff;
          *(undefined1 *)(uVar4 + 1 + in_ECX) = 0xff;
          *(undefined1 *)(uVar4 + 2 + in_ECX) = 0xff;
          *(undefined1 *)(uVar4 + 3 + in_ECX) = *(undefined1 *)(param_1 + uVar6);
          uVar4 = uVar4 + uVar3;
          uVar6 = uVar6 + param_2;
        } while (uVar6 < unaff_EDI);
      }
      return CONCAT31((int3)(uVar4 >> 8),1);
    }
  }
  return (in_EAX >> 0xb) << 8;
}



============================================================
DISASSEMBLY
============================================================
00519080 : SUB ESP,0x8
00519083 : PUSH EBX
00519084 : MOV EBX,dword ptr [ESP + 0x14]
00519088 : PUSH EBP
00519089 : MOV EBP,dword ptr [ESP + 0x1c]
0051908d : SHR EAX,0x3
00519090 : SHR EBX,0x3
00519093 : PUSH ESI
00519094 : MOV ESI,dword ptr [ESP + 0x18]
00519098 : MOV dword ptr [ESP + 0x1c],EAX
0051909c : CMP EDX,0x1
0051909f : JNZ 0x00519113
005190a1 : CMP EBP,0x9
005190a4 : JNZ 0x005190d0
005190a6 : XOR EBP,EBP
005190a8 : XOR EAX,EAX
005190aa : TEST EDI,EDI
005190ac : JBE 0x005190c7
005190ae : MOV EDI,EDI
005190b0 : CMP EAX,dword ptr [ESP + 0x24]
005190b4 : JNC 0x005190c7
005190b6 : MOV DL,byte ptr [ESI + EBP*0x1 + 0x3]
005190ba : MOV byte ptr [EAX + ECX*0x1],DL
005190bd : ADD EAX,dword ptr [ESP + 0x1c]
005190c1 : ADD EBP,EBX
005190c3 : CMP EBP,EDI
005190c5 : JC 0x005190b0
005190c7 : POP ESI
005190c8 : POP EBP
005190c9 : MOV AL,0x1
005190cb : POP EBX
005190cc : ADD ESP,0x8
005190cf : RET
005190d0 : CMP EBP,0x2
005190d3 : JNZ 0x0051931e
005190d9 : XOR EAX,EAX
005190db : XOR EBP,EBP
005190dd : TEST EDI,EDI
005190df : JBE 0x0051910a
005190e1 : CMP EBP,dword ptr [ESP + 0x24]
005190e5 : JNC 0x0051910a
005190e7 : MOVZX EDX,byte ptr [EAX + ESI*0x1]
005190eb : MOV byte ptr [ECX + EBP*0x1],DL
005190ee : MOVZX EDX,byte ptr [EAX + ESI*0x1 + 0x1]
005190f3 : MOV byte ptr [ECX + EBP*0x1 + 0x1],DL
005190f7 : MOVZX EDX,byte ptr [EAX + ESI*0x1 + 0x2]
005190fc : MOV byte ptr [ECX + EBP*0x1 + 0x2],DL
00519100 : ADD EBP,dword ptr [ESP + 0x1c]
00519104 : ADD EAX,EBX
00519106 : CMP EAX,EDI
00519108 : JC 0x005190e1
0051910a : POP ESI
0051910b : POP EBP
0051910c : MOV AL,0x1
0051910e : POP EBX
0051910f : ADD ESP,0x8
00519112 : RET
00519113 : CMP EDX,0x2
00519116 : JNZ 0x005191bb
0051911c : CMP EBP,0x9
0051911f : JNZ 0x00519173
00519121 : XOR EBP,EBP
00519123 : MOV dword ptr [ESP + 0xc],EBP
00519127 : CMP EDI,EBP
00519129 : JBE 0x0051916a
0051912b : JMP 0x00519130
00519130 : MOV EAX,dword ptr [ESP + 0xc]
00519134 : CMP EAX,dword ptr [ESP + 0x24]
00519138 : JNC 0x0051916a
0051913a : MOVZX EAX,byte ptr [ESI + EBP*0x1 + 0x1]
0051913f : MOVZX EDX,byte ptr [ESI + EBP*0x1 + 0x2]
00519144 : ADD EDX,EAX
00519146 : MOVZX EAX,byte ptr [ESI + EBP*0x1]
0051914a : ADD EDX,EAX
0051914c : MOV EAX,0xaaaaaaab
00519151 : MUL EDX
00519153 : MOV EAX,dword ptr [ESP + 0xc]
00519157 : SHR EDX,0x1
00519159 : MOV byte ptr [EAX + ECX*0x1],DL
0051915c : ADD EAX,dword ptr [ESP + 0x1c]
00519160 : ADD EBP,EBX
00519162 : MOV dword ptr [ESP + 0xc],EAX
00519166 : CMP EBP,EDI
00519168 : JC 0x00519130
0051916a : POP ESI
0051916b : POP EBP
0051916c : MOV AL,0x1
0051916e : POP EBX
0051916f : ADD ESP,0x8
00519172 : RET
00519173 : CMP EBP,0x1
00519176 : JNZ 0x0051931e
0051917c : XOR EBP,EBP
0051917e : XOR EAX,EAX
00519180 : TEST EDI,EDI
00519182 : JBE 0x005191b2
00519184 : CMP EAX,dword ptr [ESP + 0x24]
00519188 : JNC 0x005191b2
0051918a : MOVZX EDX,byte ptr [ESI + EBP*0x1]
0051918e : MOV byte ptr [EAX + ECX*0x1],DL
00519191 : MOVZX EDX,byte ptr [ESI + EBP*0x1 + 0x1]
00519196 : MOV byte ptr [EAX + ECX*0x1 + 0x1],DL
0051919a : MOVZX EDX,byte ptr [ESI + EBP*0x1 + 0x2]
0051919f : MOV byte ptr [EAX + ECX*0x1 + 0x2],DL
005191a3 : MOV byte ptr [EAX + ECX*0x1 + 0x3],0xff
005191a8 : ADD EAX,dword ptr [ESP + 0x1c]
005191ac : ADD EBP,EBX
005191ae : CMP EBP,EDI
005191b0 : JC 0x00519184
005191b2 : POP ESI
005191b3 : POP EBP
005191b4 : MOV AL,0x1
005191b6 : POP EBX
005191b7 : ADD ESP,0x8
005191ba : RET
005191bb : CMP EDX,0x64
005191be : JNZ 0x005192a2
005191c4 : CMP EBP,0x9
005191c7 : JNZ 0x00519232
005191c9 : XOR EBP,EBP
005191cb : MOV dword ptr [ESP + 0xc],EBP
005191cf : CMP EDI,EBP
005191d1 : JBE 0x00519229
005191d3 : MOV EAX,dword ptr [ESP + 0xc]
005191d7 : CMP EAX,dword ptr [ESP + 0x24]
005191db : JNC 0x00519229
005191dd : MOVZX EAX,byte ptr [ESI + EBP*0x1]
005191e1 : MOV EDX,dword ptr [ESP + 0x28]
005191e5 : CMP byte ptr [EDX + 0x8],0x0
005191e9 : LEA EAX,[EDX + EAX*0x4 + 0xc]
005191ed : MOV dword ptr [ESP + 0x10],EAX
005191f1 : JZ 0x005191f8
005191f3 : MOV DL,byte ptr [EAX + 0x3]
005191f6 : JMP 0x00519214
005191f8 : MOVZX EDX,byte ptr [EAX + 0x2]
005191fc : MOVZX EAX,byte ptr [EAX + 0x1]
00519200 : ADD EDX,EAX
00519202 : MOV EAX,dword ptr [ESP + 0x10]
00519206 : MOVZX EAX,byte ptr [EAX]
00519209 : ADD EDX,EAX
0051920b : MOV EAX,0xaaaaaaab
00519210 : MUL EDX
00519212 : SHR EDX,0x1
00519214 : MOV EAX,dword ptr [ESP + 0xc]
00519218 : MOV byte ptr [EAX + ECX*0x1],DL
0051921b : ADD EAX,dword ptr [ESP + 0x1c]
0051921f : ADD EBP,EBX
00519221 : MOV dword ptr [ESP + 0xc],EAX
00519225 : CMP EBP,EDI
00519227 : JC 0x005191d3
00519229 : POP ESI
0051922a : POP EBP
0051922b : MOV AL,0x1
0051922d : POP EBX
0051922e : ADD ESP,0x8
00519231 : RET
00519232 : CMP EBP,0x2
00519235 : JZ 0x00519240
00519237 : CMP EBP,0x1
0051923a : JNZ 0x0051931e
00519240 : XOR EDX,EDX
00519242 : XOR EAX,EAX
00519244 : MOV dword ptr [ESP + 0xc],EDX
00519248 : TEST EDI,EDI
0051924a : JBE 0x00519299
0051924c : LEA ESP,[ESP]
00519250 : CMP EAX,dword ptr [ESP + 0x24]
00519254 : JNC 0x00519299
00519256 : CMP dword ptr [ESP + 0x20],0x1
0051925b : MOVZX EDX,byte ptr [EDX + ESI*0x1]
0051925f : MOV EBP,dword ptr [ESP + 0x28]
00519263 : LEA EBP,[EBP + EDX*0x4 + 0xc]
00519267 : MOVZX EDX,byte ptr [EBP]
0051926b : MOV byte ptr [EAX + ECX*0x1],DL
0051926e : MOVZX EDX,byte ptr [EBP + 0x1]
00519272 : MOV byte ptr [EAX + ECX*0x1 + 0x1],DL
00519276 : MOVZX EDX,byte ptr [EBP + 0x2]
0051927a : MOV byte ptr [EAX + ECX*0x1 + 0x2],DL
0051927e : JNZ 0x00519287
00519280 : MOV DL,byte ptr [EBP + 0x3]
00519283 : MOV byte ptr [EAX + ECX*0x1 + 0x3],DL
00519287 : MOV EDX,dword ptr [ESP + 0xc]
0051928b : ADD EAX,dword ptr [ESP + 0x1c]
0051928f : ADD EDX,EBX
00519291 : MOV dword ptr [ESP + 0xc],EDX
00519295 : CMP EDX,EDI
00519297 : JC 0x00519250
00519299 : POP ESI
0051929a : POP EBP
0051929b : MOV AL,0x1
0051929d : POP EBX
0051929e : ADD ESP,0x8
005192a1 : RET
005192a2 : CMP EDX,0x9
005192a5 : JNZ 0x0051931e
005192a7 : CMP EBP,0x2
005192aa : JNZ 0x005192e4
005192ac : XOR EAX,EAX
005192ae : XOR EBP,EBP
005192b0 : TEST EDI,EDI
005192b2 : JBE 0x005192db
005192b4 : CMP EBP,dword ptr [ESP + 0x24]
005192b8 : JNC 0x005192db
005192ba : MOVZX EDX,byte ptr [EAX + ESI*0x1]
005192be : MOV byte ptr [ECX + EBP*0x1],DL
005192c1 : MOVZX EDX,byte ptr [EAX + ESI*0x1]
005192c5 : MOV byte ptr [ECX + EBP*0x1 + 0x1],DL
005192c9 : MOVZX EDX,byte ptr [EAX + ESI*0x1]
005192cd : MOV byte ptr [ECX + EBP*0x1 + 0x2],DL
005192d1 : ADD EBP,dword ptr [ESP + 0x1c]
005192d5 : ADD EAX,EBX
005192d7 : CMP EAX,EDI
005192d9 : JC 0x005192b4
005192db : POP ESI
005192dc : POP EBP
005192dd : MOV AL,0x1
005192df : POP EBX
005192e0 : ADD ESP,0x8
005192e3 : RET
005192e4 : CMP EBP,0x1
005192e7 : JNZ 0x0051931e
005192e9 : XOR EBP,EBP
005192eb : XOR EAX,EAX
005192ed : TEST EDI,EDI
005192ef : JBE 0x00519315
005192f1 : MOV DL,0xff
005192f3 : CMP EAX,dword ptr [ESP + 0x24]
005192f7 : JNC 0x00519315
005192f9 : MOV byte ptr [EAX + ECX*0x1],DL
005192fc : MOV byte ptr [EAX + ECX*0x1 + 0x1],DL
00519300 : MOV byte ptr [EAX + ECX*0x1 + 0x2],DL
00519304 : MOV DL,byte ptr [ESI + EBP*0x1]
00519307 : MOV byte ptr [EAX + ECX*0x1 + 0x3],DL
0051930b : ADD EAX,dword ptr [ESP + 0x1c]
0051930f : ADD EBP,EBX
00519311 : CMP EBP,EDI
00519313 : JC 0x005192f1
00519315 : POP ESI
00519316 : POP EBP
00519317 : MOV AL,0x1
00519319 : POP EBX
0051931a : ADD ESP,0x8
0051931d : RET
0051931e : POP ESI
0051931f : POP EBP
00519320 : XOR AL,AL
00519322 : POP EBX
00519323 : ADD ESP,0x8
00519326 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_006ee890
ENTRY    : 006ee890
BODY     : [[006ee890, 006ee8fc] [006ee900, 006ee9a0]]

============================================================
DECOMPILED C CODE
============================================================

int * FUN_006ee890(void)

{
  char *_Dst;
  void *pvVar1;
  undefined4 uVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  int unaff_EDI;
  size_t local_8;
  
  pvVar1 = _malloc(0x288);
  _Dst = (char *)(unaff_EDI + 4);
  *(void **)(unaff_EDI + 0x404) = pvVar1;
  local_8 = 0x288;
  _strcpy_s(_Dst,0x400,"Success!");
  uVar2 = GetAdaptersInfo(*(undefined4 *)(unaff_EDI + 0x404),&local_8);
  switch(uVar2) {
  case 0:
    piVar5 = *(int **)(unaff_EDI + 0x404);
    piVar4 = piVar5;
    if (piVar5 != (int *)0x0) {
      do {
        piVar5 = (int *)*piVar5;
      } while (piVar5 != (int *)0x0);
      return piVar4;
    }
    break;
  case 0x32:
    _strcpy_s(_Dst,0x400,"The system not support GetAdaptersInfo API function!");
    return (int *)0x0;
  case 0x6f:
    _free(*(void **)(unaff_EDI + 0x404));
    *(undefined4 *)(unaff_EDI + 0x404) = 0;
    pvVar1 = _malloc(local_8);
    *(void **)(unaff_EDI + 0x404) = pvVar1;
    if (pvVar1 != (void *)0x0) {
      iVar3 = GetAdaptersInfo(pvVar1,&local_8);
      if (iVar3 == 0) {
        piVar5 = *(int **)(unaff_EDI + 0x404);
        piVar4 = piVar5;
        if (piVar5 == (int *)0x0) {
          return (int *)0x0;
        }
        do {
          piVar5 = (int *)*piVar5;
        } while (piVar5 != (int *)0x0);
        return piVar4;
      }
      FUN_004f85a0();
    }
  default:
    break;
  case 0xe8:
    _strcpy_s(_Dst,0x400,"No net device information!");
    return (int *)0x0;
  }
  return (int *)0x0;
}



============================================================
DISASSEMBLY
============================================================
006ee890 : PUSH EBP
006ee891 : MOV EBP,ESP
006ee893 : PUSH ECX
006ee894 : PUSH ESI
006ee895 : PUSH 0x288
006ee89a : CALL 0x00636043
006ee89f : PUSH 0xbf2b74
006ee8a4 : LEA ESI,[EDI + 0x4]
006ee8a7 : PUSH 0x400
006ee8ac : PUSH ESI
006ee8ad : MOV dword ptr [EDI + 0x404],EAX
006ee8b3 : MOV dword ptr [EBP + -0x4],0x288
006ee8ba : CALL 0x00638300
006ee8bf : MOV ECX,dword ptr [EDI + 0x404]
006ee8c5 : ADD ESP,0x10
006ee8c8 : LEA EAX,[EBP + -0x4]
006ee8cb : PUSH EAX
006ee8cc : PUSH ECX
006ee8cd : CALL 0x0067650e
006ee8d2 : CMP EAX,0xe8
006ee8d7 : JA 0x006ee99a
006ee8dd : MOVZX EDX,byte ptr [EAX + 0x6ee9b8]
006ee8e4 : JMP dword ptr [EDX*0x4 + 0x6ee9a4]
006ee8eb : MOV EAX,dword ptr [EDI + 0x404]
006ee8f1 : MOV ECX,EAX
006ee8f3 : TEST ECX,ECX
006ee8f5 : JZ 0x006ee99c
006ee8fb : JMP 0x006ee900
006ee900 : MOV ECX,dword ptr [ECX]
006ee902 : TEST ECX,ECX
006ee904 : JNZ 0x006ee900
006ee906 : POP ESI
006ee907 : MOV ESP,EBP
006ee909 : POP EBP
006ee90a : RET
006ee90b : PUSH 0xbf2b80
006ee910 : PUSH 0x400
006ee915 : PUSH ESI
006ee916 : CALL 0x00638300
006ee91b : ADD ESP,0xc
006ee91e : XOR EAX,EAX
006ee920 : POP ESI
006ee921 : MOV ESP,EBP
006ee923 : POP EBP
006ee924 : RET
006ee925 : PUSH 0xbf2b9c
006ee92a : PUSH 0x400
006ee92f : PUSH ESI
006ee930 : CALL 0x00638300
006ee935 : ADD ESP,0xc
006ee938 : XOR EAX,EAX
006ee93a : POP ESI
006ee93b : MOV ESP,EBP
006ee93d : POP EBP
006ee93e : RET
006ee93f : MOV EAX,dword ptr [EDI + 0x404]
006ee945 : PUSH EAX
006ee946 : CALL 0x0063610d
006ee94b : MOV ECX,dword ptr [EBP + -0x4]
006ee94e : PUSH ECX
006ee94f : MOV dword ptr [EDI + 0x404],0x0
006ee959 : CALL 0x00636043
006ee95e : ADD ESP,0x8
006ee961 : MOV dword ptr [EDI + 0x404],EAX
006ee967 : TEST EAX,EAX
006ee969 : JZ 0x006ee99a
006ee96b : LEA EDX,[EBP + -0x4]
006ee96e : PUSH EDX
006ee96f : PUSH EAX
006ee970 : CALL 0x0067650e
006ee975 : TEST EAX,EAX
006ee977 : JNZ 0x006ee990
006ee979 : MOV EAX,dword ptr [EDI + 0x404]
006ee97f : MOV ECX,EAX
006ee981 : TEST ECX,ECX
006ee983 : JZ 0x006ee99c
006ee985 : MOV ECX,dword ptr [ECX]
006ee987 : TEST ECX,ECX
006ee989 : JNZ 0x006ee985
006ee98b : POP ESI
006ee98c : MOV ESP,EBP
006ee98e : POP EBP
006ee98f : RET
006ee990 : MOV EAX,0xbf2bd4
006ee995 : CALL 0x004f85a0
006ee99a : XOR EAX,EAX
006ee99c : POP ESI
006ee99d : MOV ESP,EBP
006ee99f : POP EBP
006ee9a0 : RET

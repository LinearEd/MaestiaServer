PROGRAM  : Maestia.exe
FUNCTION : FUN_00812bb0
ENTRY    : 00812bb0
BODY     : [[00812bb0, 00812cd8]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x00812c05) */

void FUN_00812bb0(int param_1,ushort param_2)

{
  int iVar1;
  int *piVar2;
  uint uVar3;
  uint *local_c;
  int local_8;
  
  if (((*(int *)(param_1 + 0xf4) - *(int *)(param_1 + 0xf0) & 0xfffffffcU) == 0) ||
     (param_2 != *(ushort *)(param_1 + 0xfc))) {
    if (*(int *)(param_1 + 0xf0) != *(int *)(param_1 + 0xf4)) {
      *(int *)(param_1 + 0xf4) = *(int *)(param_1 + 0xf0);
    }
    *(ushort *)(param_1 + 0xfc) = param_2;
    local_8 = **(int **)(param_1 + 0x90);
    if ((int *)local_8 != *(int **)(param_1 + 0x90)) {
      do {
        local_c = *(uint **)(local_8 + 0x10);
        if ((((short)local_c[1] != 0) && (*local_c < 1000)) &&
           ((param_2 == 0 || ((local_c[2] == 0 || ((local_c[2] & (uint)param_2 * 2) != 0)))))) {
          iVar1 = *(int *)(param_1 + 0xf0);
          if (iVar1 == 0) {
            uVar3 = 0;
          }
          else {
            uVar3 = *(int *)(param_1 + 0xf8) - iVar1 >> 2;
          }
          piVar2 = *(int **)(param_1 + 0xf4);
          if ((uint)((int)piVar2 - iVar1 >> 2) < uVar3) {
            *piVar2 = (int)local_c;
            *(int **)(param_1 + 0xf4) = piVar2 + 1;
          }
          else {
            FUN_004d2c60(param_1 + 0xec,piVar2,&local_c);
          }
        }
        FUN_00416210();
      } while (local_8 != *(int *)(param_1 + 0x90));
    }
    FUN_004c0a80(*(int *)(param_1 + 0xf0),*(int *)(param_1 + 0xf4),
                 *(int *)(param_1 + 0xf4) - *(int *)(param_1 + 0xf0) >> 2,FUN_00812120);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00812bb0 : PUSH EBP
00812bb1 : MOV EBP,ESP
00812bb3 : MOV DX,word ptr [EBP + 0xc]
00812bb7 : SUB ESP,0xc
00812bba : PUSH EBX
00812bbb : MOV EBX,dword ptr [EBP + 0x8]
00812bbe : MOV EAX,dword ptr [EBX + 0xf4]
00812bc4 : SUB EAX,dword ptr [EBX + 0xf0]
00812bca : PUSH ESI
00812bcb : LEA ESI,[EBX + 0xec]
00812bd1 : PUSH EDI
00812bd2 : TEST EAX,0xfffffffc
00812bd7 : JZ 0x00812be6
00812bd9 : CMP DX,word ptr [EBX + 0xfc]
00812be0 : JZ 0x00812cd0
00812be6 : MOV EDI,dword ptr [ESI + 0x4]
00812be9 : MOV ECX,dword ptr [ESI + 0x8]
00812bec : CMP EDI,ECX
00812bee : JZ 0x00812c1b
00812bf0 : MOV EAX,ECX
00812bf2 : SUB EAX,ECX
00812bf4 : SAR EAX,0x2
00812bf7 : LEA EDX,[EAX*0x4 + 0x0]
00812bfe : LEA EBX,[EDX + EDI*0x1]
00812c01 : TEST EAX,EAX
00812c03 : JLE 0x00812c11
00812c05 : PUSH EDX
00812c06 : PUSH ECX
00812c07 : PUSH EDX
00812c08 : PUSH EDI
00812c09 : CALL 0x00634101
00812c0e : ADD ESP,0x10
00812c11 : MOV DX,word ptr [EBP + 0xc]
00812c15 : MOV dword ptr [ESI + 0x8],EBX
00812c18 : MOV EBX,dword ptr [EBP + 0x8]
00812c1b : MOV ECX,dword ptr [EBX + 0x90]
00812c21 : MOV word ptr [EBX + 0xfc],DX
00812c28 : MOV EAX,dword ptr [ECX]
00812c2a : MOV dword ptr [EBP + -0x4],EAX
00812c2d : CMP EAX,ECX
00812c2f : JZ 0x00812cad
00812c31 : JMP 0x00812c37
00812c33 : MOV DX,word ptr [EBP + 0xc]
00812c37 : MOV EDI,dword ptr [EAX + 0x10]
00812c3a : CMP word ptr [EDI + 0x4],0x0
00812c3f : MOV dword ptr [EBP + -0x8],EDI
00812c42 : JZ 0x00812c9a
00812c44 : CMP dword ptr [EDI],0x3e8
00812c4a : JNC 0x00812c9a
00812c4c : TEST DX,DX
00812c4f : JZ 0x00812c61
00812c51 : MOV EAX,dword ptr [EDI + 0x8]
00812c54 : TEST EAX,EAX
00812c56 : JZ 0x00812c61
00812c58 : MOVZX ECX,DX
00812c5b : ADD ECX,ECX
00812c5d : TEST EAX,ECX
00812c5f : JZ 0x00812c9a
00812c61 : MOV EDX,dword ptr [ESI + 0x4]
00812c64 : TEST EDX,EDX
00812c66 : JNZ 0x00812c6c
00812c68 : XOR EAX,EAX
00812c6a : JMP 0x00812c74
00812c6c : MOV EAX,dword ptr [ESI + 0xc]
00812c6f : SUB EAX,EDX
00812c71 : SAR EAX,0x2
00812c74 : MOV ECX,dword ptr [ESI + 0x8]
00812c77 : MOV EBX,ECX
00812c79 : SUB EBX,EDX
00812c7b : SAR EBX,0x2
00812c7e : CMP EBX,EAX
00812c80 : JNC 0x00812c8c
00812c82 : MOV dword ptr [ECX],EDI
00812c84 : ADD ECX,0x4
00812c87 : MOV dword ptr [ESI + 0x8],ECX
00812c8a : JMP 0x00812c97
00812c8c : LEA EDX,[EBP + -0x8]
00812c8f : PUSH EDX
00812c90 : PUSH ECX
00812c91 : PUSH ESI
00812c92 : CALL 0x004d2c60
00812c97 : MOV EBX,dword ptr [EBP + 0x8]
00812c9a : LEA EDX,[EBP + -0x4]
00812c9d : CALL 0x00416210
00812ca2 : MOV EAX,dword ptr [EBP + -0x4]
00812ca5 : CMP EAX,dword ptr [EBX + 0x90]
00812cab : JNZ 0x00812c33
00812cad : MOV EAX,dword ptr [EBX + 0xf4]
00812cb3 : MOV EBX,dword ptr [EBX + 0xf0]
00812cb9 : MOV ECX,EAX
00812cbb : SUB ECX,EBX
00812cbd : PUSH 0x812120
00812cc2 : SAR ECX,0x2
00812cc5 : PUSH ECX
00812cc6 : PUSH EAX
00812cc7 : PUSH EBX
00812cc8 : CALL 0x004c0a80
00812ccd : ADD ESP,0x10
00812cd0 : POP EDI
00812cd1 : POP ESI
00812cd2 : POP EBX
00812cd3 : MOV ESP,EBP
00812cd5 : POP EBP
00812cd6 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_00a0b670
ENTRY    : 00a0b670
BODY     : [[00a0b670, 00a0bcb4]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a0b670(undefined4 param_1,undefined4 param_2,int param_3)

{
  short sVar1;
  uint uVar2;
  short *psVar3;
  int iVar4;
  undefined4 uVar5;
  uint uVar6;
  LPCWSTR lpExistingFileName;
  LPCWSTR **pppWVar7;
  uint uVar8;
  uint uVar9;
  int extraout_EDX;
  short *psVar10;
  uint uVar11;
  uint uVar12;
  undefined4 *puVar13;
  undefined1 auStack_10c [3];
  char local_109;
  undefined1 local_108 [4];
  undefined2 local_104;
  undefined4 local_f4;
  uint local_f0;
  _SYSTEMTIME local_ec;
  int local_dc;
  int local_d8;
  short *local_d4;
  undefined2 local_cc;
  undefined4 local_bc;
  uint local_b8;
  undefined1 local_b4 [4];
  undefined2 local_b0;
  undefined4 local_a0;
  uint local_9c;
  LPCWSTR *local_94 [4];
  undefined4 local_84;
  uint local_80;
  undefined4 local_78;
  int local_68;
  uint local_64;
  undefined1 local_60 [4];
  undefined4 local_5c;
  undefined4 local_58;
  undefined1 local_38 [4];
  undefined2 local_34;
  undefined4 local_24;
  uint local_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b2f7ff;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_10c;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffee8;
  ExceptionList = &local_14;
  local_d8 = param_3;
  FUN_00a0efe0(local_60);
  local_c = 0;
  if (*(uint *)(extraout_EDX + 0x18) < 8) {
    psVar10 = (short *)(extraout_EDX + 4);
  }
  else {
    psVar10 = *(short **)(extraout_EDX + 4);
  }
  local_b0 = 0;
  local_d4 = psVar10 + 1;
  local_9c = 7;
  local_a0 = 0;
  psVar3 = psVar10;
  do {
    sVar1 = *psVar3;
    psVar3 = psVar3 + 1;
  } while (sVar1 != 0);
  FUN_00406360(psVar10,(int)psVar3 - (int)local_d4 >> 1);
  local_c._0_1_ = 1;
  local_109 = FUN_00a0f4c0(local_b4,param_1);
  local_c._0_1_ = 0;
  if (7 < local_9c) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_9c = 7;
  local_a0 = 0;
  local_b0 = 0;
  if (local_109 == '\0') goto LAB_00a0bc52;
  GetLocalTime(&local_ec);
  FUN_00404750(L"Dump_%d_%d_%d",local_ec.wYear,local_ec.wMonth,local_ec.wDay,uVar2);
  local_c._0_1_ = 2;
  local_9c = 7;
  local_a0 = 0;
  local_b0 = 0;
  FUN_00405eb0(&DAT_00d71c88,0,0xffffffff);
  local_c._0_1_ = 3;
  FUN_00a0f040(local_b4);
  local_c._0_1_ = 5;
  FUN_00406460(L"AvaGame.log");
  local_c._0_1_ = 6;
  FUN_00405c30(local_38,0,0xffffffff);
  puVar13 = local_78;
  if (local_64 < 8) {
    puVar13 = &local_78;
  }
  iVar4 = FUN_00405b70(puVar13);
  if ((iVar4 == 0) && (local_68 == 0)) {
    uVar5 = FUN_00403380(local_108,local_b4);
    local_c._0_1_ = 7;
    FUN_00405eb0(uVar5,0,0xffffffff);
    local_c._0_1_ = 6;
    if (7 < local_f0) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_f0 = 7;
    local_f4 = 0;
    local_104 = 0;
  }
  if (*(int *)(local_d8 + 0x14) != 0) {
    if (*(uint *)(local_d8 + 0x18) < 8) {
      iVar4 = local_d8 + 4;
    }
    else {
      iVar4 = *(int *)(local_d8 + 4);
    }
    FUN_00406460(iVar4);
    local_c._0_1_ = 8;
    FUN_00a0f1e0(local_60,local_108);
    local_c._0_1_ = 6;
    if (7 < local_f0) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_f0 = 7;
    local_f4 = 0;
    local_104 = 0;
  }
  if (*(int *)(local_dc + 0x14) == 0) {
LAB_00a0b9aa:
    puVar13 = DAT_00d71aa0;
    if (DAT_00d71ab4 < 8) {
      puVar13 = &DAT_00d71aa0;
    }
    uVar11 = (uint)local_ec.wSecond;
    uVar2 = (uint)local_ec.wMinute;
    uVar8 = (uint)local_ec.wHour;
    uVar12 = (uint)local_ec.wDay;
    uVar6 = (uint)local_ec.wMonth;
    uVar9 = (uint)local_ec.wYear;
    iVar4 = _rand();
    uVar5 = FUN_00404750(L"%s_%d_%d%d%d_%d%d%d_AvaGame.log",puVar13,iVar4,uVar9,uVar6,uVar12,uVar8,
                         uVar2,uVar11);
    local_c._0_1_ = 10;
    FUN_00405eb0(uVar5,0,0xffffffff);
    local_c._0_1_ = 6;
    if (7 < local_f0) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  else {
    if (*(uint *)(local_dc + 0x18) < 8) {
      iVar4 = local_dc + 4;
    }
    else {
      iVar4 = *(int *)(local_dc + 4);
    }
    FUN_00406460(iVar4);
    local_c._0_1_ = 9;
    FUN_00a0f1e0(local_60,local_108);
    local_c._0_1_ = 6;
    if (7 < local_f0) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_f0 = 7;
    local_f4 = 0;
    local_104 = 0;
    if (*(int *)(local_dc + 0x14) == 0) goto LAB_00a0b9aa;
    uVar5 = FUN_00406460(L"_AvaGame.log");
    local_c._0_1_ = 0xb;
    uVar5 = FUN_00403450(local_108,uVar5);
    local_c._0_1_ = 0xc;
    FUN_00405eb0(uVar5,0,0xffffffff);
    local_c = CONCAT31(local_c._1_3_,0xb);
    if (7 < local_f0) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_f0 = 7;
    local_f4 = 0;
    local_104 = 0;
    local_c._0_1_ = 6;
    if (7 < local_b8) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_b8 = 7;
    local_bc = 0;
    local_cc = 0;
  }
  local_c._0_1_ = 6;
  local_f0 = 7;
  local_f4 = 0;
  local_104 = 0;
  pppWVar7 = (LPCWSTR **)local_94[0];
  if (local_80 < 8) {
    pppWVar7 = local_94;
  }
  lpExistingFileName = DAT_00d71abc;
  if (DAT_00d71ad0 < 8) {
    lpExistingFileName = (LPCWSTR)&DAT_00d71abc;
  }
  CopyFileW(lpExistingFileName,(LPCWSTR)pppWVar7,0);
  pppWVar7 = (LPCWSTR **)local_94[0];
  if (local_80 < 8) {
    pppWVar7 = local_94;
  }
  FUN_00406460(pppWVar7);
  local_c._0_1_ = 0xd;
  FUN_00a0f1e0(local_60,local_108);
  local_c._0_1_ = 6;
  if (7 < local_f0) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_f0 = 7;
  local_f4 = 0;
  local_104 = 0;
  pppWVar7 = (LPCWSTR **)local_94[0];
  if (local_80 < 8) {
    pppWVar7 = local_94;
  }
  DeleteFileW((LPCWSTR)pppWVar7);
  local_c = CONCAT31(local_c._1_3_,5);
  if (7 < local_20) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_20 = 7;
  local_24 = 0;
  local_34 = 0;
  local_c = CONCAT31(local_c._1_3_,3);
  if (7 < local_64) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_64 = 7;
  local_68 = 0;
  local_78 = (undefined4 *)((uint)local_78._2_2_ << 0x10);
  local_c = CONCAT31(local_c._1_3_,2);
  if (7 < local_9c) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_9c = 7;
  local_a0 = 0;
  local_b0 = 0;
  local_c._0_1_ = 0;
  if (7 < local_80) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_80 = 7;
  local_84 = 0;
  local_94[0] = (LPCWSTR *)((uint)local_94[0] & 0xffff0000);
LAB_00a0bc52:
  local_c._0_1_ = 0;
  local_9c = 7;
  local_a0 = 0;
  local_b0 = 0;
  InternetCloseHandle(local_58);
  InternetCloseHandle(local_5c);
  local_58 = 0;
  local_5c = 0;
  local_c = 0xffffffff;
  FUN_00a0ef50();
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_10c);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a0b670 : PUSH EBP
00a0b671 : MOV EBP,ESP
00a0b673 : AND ESP,0xfffffff8
00a0b676 : PUSH -0x1
00a0b678 : PUSH 0xb2f7ff
00a0b67d : MOV EAX,FS:[0x0]
00a0b683 : PUSH EAX
00a0b684 : SUB ESP,0xf8
00a0b68a : MOV EAX,[0x00d66fa0]
00a0b68f : XOR EAX,ESP
00a0b691 : MOV dword ptr [ESP + 0xf0],EAX
00a0b698 : PUSH EBX
00a0b699 : PUSH ESI
00a0b69a : PUSH EDI
00a0b69b : MOV EAX,[0x00d66fa0]
00a0b6a0 : XOR EAX,ESP
00a0b6a2 : PUSH EAX
00a0b6a3 : LEA EAX,[ESP + 0x108]
00a0b6aa : MOV FS:[0x0],EAX
00a0b6b0 : MOV EAX,dword ptr [EBP + 0x10]
00a0b6b3 : MOV ESI,dword ptr [EBP + 0x8]
00a0b6b6 : MOV EDI,dword ptr [EBP + 0xc]
00a0b6b9 : MOV dword ptr [ESP + 0x44],EAX
00a0b6bd : LEA EAX,[ESP + 0xbc]
00a0b6c4 : PUSH EAX
00a0b6c5 : MOV dword ptr [ESP + 0x44],ECX
00a0b6c9 : CALL 0x00a0efe0
00a0b6ce : XOR EBX,EBX
00a0b6d0 : MOV dword ptr [ESP + 0x110],EBX
00a0b6d7 : CMP dword ptr [EDX + 0x18],0x8
00a0b6db : JC 0x00a0b6e2
00a0b6dd : MOV EDX,dword ptr [EDX + 0x4]
00a0b6e0 : JMP 0x00a0b6e5
00a0b6e2 : ADD EDX,0x4
00a0b6e5 : XOR ECX,ECX
00a0b6e7 : MOV EAX,EDX
00a0b6e9 : MOV word ptr [ESP + 0x6c],CX
00a0b6ee : LEA ECX,[EAX + 0x2]
00a0b6f1 : MOV dword ptr [ESP + 0x80],0x7
00a0b6fc : MOV dword ptr [ESP + 0x7c],EBX
00a0b700 : MOV dword ptr [ESP + 0x48],ECX
00a0b704 : MOV CX,word ptr [EAX]
00a0b707 : ADD EAX,0x2
00a0b70a : CMP CX,BX
00a0b70d : JNZ 0x00a0b704
00a0b70f : SUB EAX,dword ptr [ESP + 0x48]
00a0b713 : LEA ECX,[ESP + 0x68]
00a0b717 : SAR EAX,0x1
00a0b719 : PUSH EAX
00a0b71a : PUSH EDX
00a0b71b : CALL 0x00406360
00a0b720 : MOV byte ptr [ESP + 0x110],0x1
00a0b728 : PUSH ESI
00a0b729 : LEA EDX,[ESP + 0x6c]
00a0b72d : PUSH EDX
00a0b72e : MOV EDX,EDI
00a0b730 : LEA ECX,[ESP + 0xc4]
00a0b737 : CALL 0x00a0f4c0
00a0b73c : MOV byte ptr [ESP + 0x13],AL
00a0b740 : MOV byte ptr [ESP + 0x110],BL
00a0b747 : MOV EDI,0x8
00a0b74c : CMP dword ptr [ESP + 0x80],EDI
00a0b753 : JC 0x00a0b75e
00a0b755 : MOV ECX,dword ptr [ESP + 0x6c]
00a0b759 : CALL 0x006f04e0
00a0b75e : XOR EAX,EAX
00a0b760 : MOV dword ptr [ESP + 0x80],0x7
00a0b76b : MOV dword ptr [ESP + 0x7c],EBX
00a0b76f : MOV word ptr [ESP + 0x6c],AX
00a0b774 : CMP byte ptr [ESP + 0x13],BL
00a0b778 : JZ 0x00a0bc52
00a0b77e : LEA ECX,[ESP + 0x30]
00a0b782 : PUSH ECX
00a0b783 : CALL dword ptr [0x00b85154]
00a0b789 : MOVZX EDX,word ptr [ESP + 0x36]
00a0b78e : MOVZX EAX,word ptr [ESP + 0x32]
00a0b793 : MOVZX ECX,word ptr [ESP + 0x30]
00a0b798 : PUSH EDX
00a0b799 : PUSH EAX
00a0b79a : PUSH ECX
00a0b79b : PUSH 0xcab2c4
00a0b7a0 : LEA ESI,[ESP + 0x94]
00a0b7a7 : CALL 0x00404750
00a0b7ac : ADD ESP,0x10
00a0b7af : MOV byte ptr [ESP + 0x110],0x2
00a0b7b7 : PUSH -0x1
00a0b7b9 : PUSH EBX
00a0b7ba : XOR EDX,EDX
00a0b7bc : PUSH 0xd71c88
00a0b7c1 : LEA ECX,[ESP + 0x74]
00a0b7c5 : MOV dword ptr [ESP + 0x8c],0x7
00a0b7d0 : MOV dword ptr [ESP + 0x88],EBX
00a0b7d7 : MOV word ptr [ESP + 0x78],DX
00a0b7dc : CALL 0x00405eb0
00a0b7e1 : MOV byte ptr [ESP + 0x110],0x3
00a0b7e9 : LEA EAX,[ESP + 0x68]
00a0b7ed : PUSH EAX
00a0b7ee : LEA ESI,[ESP + 0xa4]
00a0b7f5 : LEA ECX,[ESP + 0xc0]
00a0b7fc : CALL 0x00a0f040
00a0b801 : MOV byte ptr [ESP + 0x110],0x5
00a0b809 : PUSH 0xcab2ec
00a0b80e : LEA ECX,[ESP + 0xe8]
00a0b815 : CALL 0x00406460
00a0b81a : MOV byte ptr [ESP + 0x110],0x6
00a0b822 : PUSH -0x1
00a0b824 : PUSH EBX
00a0b825 : LEA ECX,[ESP + 0xec]
00a0b82c : PUSH ECX
00a0b82d : MOV ECX,0xd71ab8
00a0b832 : CALL 0x00405c30
00a0b837 : MOV EAX,dword ptr [ESP + 0xa4]
00a0b83e : CMP dword ptr [ESP + 0xb8],EDI
00a0b845 : JNC 0x00a0b84e
00a0b847 : LEA EAX,[ESP + 0xa4]
00a0b84e : PUSH EAX
00a0b84f : XOR EDX,EDX
00a0b851 : MOV ECX,0xcab304
00a0b856 : CALL 0x00405b70
00a0b85b : ADD ESP,0x4
00a0b85e : CMP EAX,EBX
00a0b860 : JNZ 0x00a0b8cb
00a0b862 : XOR EAX,EAX
00a0b864 : CMP dword ptr [ESP + 0xb4],EBX
00a0b86b : SETNZ AL
00a0b86e : CMP EAX,EBX
00a0b870 : JNZ 0x00a0b8cb
00a0b872 : LEA EDX,[ESP + 0x68]
00a0b876 : PUSH EDX
00a0b877 : LEA EAX,[ESP + 0x18]
00a0b87b : PUSH EAX
00a0b87c : MOV EDX,0xcab308
00a0b881 : CALL 0x00403380
00a0b886 : ADD ESP,0x8
00a0b889 : MOV byte ptr [ESP + 0x110],0x7
00a0b891 : PUSH -0x1
00a0b893 : PUSH EBX
00a0b894 : PUSH EAX
00a0b895 : LEA ECX,[ESP + 0xac]
00a0b89c : CALL 0x00405eb0
00a0b8a1 : MOV byte ptr [ESP + 0x110],0x6
00a0b8a9 : CMP dword ptr [ESP + 0x2c],EDI
00a0b8ad : JC 0x00a0b8b8
00a0b8af : MOV ECX,dword ptr [ESP + 0x18]
00a0b8b3 : CALL 0x006f04e0
00a0b8b8 : XOR ECX,ECX
00a0b8ba : MOV dword ptr [ESP + 0x2c],0x7
00a0b8c2 : MOV dword ptr [ESP + 0x28],EBX
00a0b8c6 : MOV word ptr [ESP + 0x18],CX
00a0b8cb : MOV EAX,dword ptr [ESP + 0x44]
00a0b8cf : CMP dword ptr [EAX + 0x14],EBX
00a0b8d2 : JZ 0x00a0b936
00a0b8d4 : CMP dword ptr [EAX + 0x18],EDI
00a0b8d7 : JC 0x00a0b8de
00a0b8d9 : MOV EAX,dword ptr [EAX + 0x4]
00a0b8dc : JMP 0x00a0b8e1
00a0b8de : ADD EAX,0x4
00a0b8e1 : PUSH EAX
00a0b8e2 : LEA ECX,[ESP + 0x18]
00a0b8e6 : CALL 0x00406460
00a0b8eb : MOV byte ptr [ESP + 0x110],0x8
00a0b8f3 : LEA EDX,[ESP + 0x14]
00a0b8f7 : PUSH EDX
00a0b8f8 : LEA EAX,[ESP + 0xc0]
00a0b8ff : PUSH EAX
00a0b900 : LEA ECX,[ESP + 0xa8]
00a0b907 : CALL 0x00a0f1e0
00a0b90c : MOV byte ptr [ESP + 0x110],0x6
00a0b914 : CMP dword ptr [ESP + 0x2c],EDI
00a0b918 : JC 0x00a0b923
00a0b91a : MOV ECX,dword ptr [ESP + 0x18]
00a0b91e : CALL 0x006f04e0
00a0b923 : XOR ECX,ECX
00a0b925 : MOV dword ptr [ESP + 0x2c],0x7
00a0b92d : MOV dword ptr [ESP + 0x28],EBX
00a0b931 : MOV word ptr [ESP + 0x18],CX
00a0b936 : MOV ESI,dword ptr [ESP + 0x40]
00a0b93a : CMP dword ptr [ESI + 0x14],EBX
00a0b93d : JZ 0x00a0b9aa
00a0b93f : CMP dword ptr [ESI + 0x18],EDI
00a0b942 : JC 0x00a0b949
00a0b944 : MOV EAX,dword ptr [ESI + 0x4]
00a0b947 : JMP 0x00a0b94c
00a0b949 : LEA EAX,[ESI + 0x4]
00a0b94c : PUSH EAX
00a0b94d : LEA ECX,[ESP + 0x18]
00a0b951 : CALL 0x00406460
00a0b956 : MOV byte ptr [ESP + 0x110],0x9
00a0b95e : LEA EDX,[ESP + 0x14]
00a0b962 : PUSH EDX
00a0b963 : LEA EAX,[ESP + 0xc0]
00a0b96a : PUSH EAX
00a0b96b : LEA ECX,[ESP + 0xa8]
00a0b972 : CALL 0x00a0f1e0
00a0b977 : MOV byte ptr [ESP + 0x110],0x6
00a0b97f : CMP dword ptr [ESP + 0x2c],EDI
00a0b983 : JC 0x00a0b98e
00a0b985 : MOV ECX,dword ptr [ESP + 0x18]
00a0b989 : CALL 0x006f04e0
00a0b98e : XOR ECX,ECX
00a0b990 : MOV dword ptr [ESP + 0x2c],0x7
00a0b998 : MOV dword ptr [ESP + 0x28],EBX
00a0b99c : MOV word ptr [ESP + 0x18],CX
00a0b9a1 : CMP dword ptr [ESI + 0x14],EBX
00a0b9a4 : JNZ 0x00a0ba41
00a0b9aa : MOV ESI,dword ptr [0x00d71aa0]
00a0b9b0 : CMP dword ptr [0x00d71ab4],EDI
00a0b9b6 : JNC 0x00a0b9bd
00a0b9b8 : MOV ESI,0xd71aa0
00a0b9bd : MOVZX EDX,word ptr [ESP + 0x3c]
00a0b9c2 : MOVZX EAX,word ptr [ESP + 0x3a]
00a0b9c7 : MOVZX ECX,word ptr [ESP + 0x38]
00a0b9cc : PUSH EDX
00a0b9cd : MOVZX EDX,word ptr [ESP + 0x3a]
00a0b9d2 : PUSH EAX
00a0b9d3 : MOVZX EAX,word ptr [ESP + 0x3a]
00a0b9d8 : PUSH ECX
00a0b9d9 : MOVZX ECX,word ptr [ESP + 0x3c]
00a0b9de : PUSH EDX
00a0b9df : PUSH EAX
00a0b9e0 : PUSH ECX
00a0b9e1 : CALL 0x00635d2f
00a0b9e6 : PUSH EAX
00a0b9e7 : PUSH ESI
00a0b9e8 : PUSH 0xcab328
00a0b9ed : LEA ESI,[ESP + 0x38]
00a0b9f1 : CALL 0x00404750
00a0b9f6 : ADD ESP,0x24
00a0b9f9 : MOV byte ptr [ESP + 0x110],0xa
00a0ba01 : PUSH -0x1
00a0ba03 : PUSH EBX
00a0ba04 : PUSH EAX
00a0ba05 : LEA ECX,[ESP + 0x90]
00a0ba0c : CALL 0x00405eb0
00a0ba11 : MOV byte ptr [ESP + 0x110],0x6
00a0ba19 : CMP dword ptr [ESP + 0x2c],EDI
00a0ba1d : JC 0x00a0ba28
00a0ba1f : MOV ECX,dword ptr [ESP + 0x18]
00a0ba23 : CALL 0x006f04e0
00a0ba28 : MOV ESI,0x7
00a0ba2d : XOR EDX,EDX
00a0ba2f : MOV dword ptr [ESP + 0x2c],ESI
00a0ba33 : MOV dword ptr [ESP + 0x28],EBX
00a0ba37 : MOV word ptr [ESP + 0x18],DX
00a0ba3c : JMP 0x00a0bad0
00a0ba41 : PUSH 0xcab30c
00a0ba46 : LEA ECX,[ESP + 0x50]
00a0ba4a : CALL 0x00406460
00a0ba4f : MOV byte ptr [ESP + 0x110],0xb
00a0ba57 : PUSH EAX
00a0ba58 : LEA EAX,[ESP + 0x18]
00a0ba5c : PUSH EAX
00a0ba5d : MOV ECX,ESI
00a0ba5f : CALL 0x00403450
00a0ba64 : ADD ESP,0x8
00a0ba67 : MOV byte ptr [ESP + 0x110],0xc
00a0ba6f : PUSH -0x1
00a0ba71 : PUSH EBX
00a0ba72 : PUSH EAX
00a0ba73 : LEA ECX,[ESP + 0x90]
00a0ba7a : CALL 0x00405eb0
00a0ba7f : MOV byte ptr [ESP + 0x110],0xb
00a0ba87 : CMP dword ptr [ESP + 0x2c],EDI
00a0ba8b : JC 0x00a0ba96
00a0ba8d : MOV ECX,dword ptr [ESP + 0x18]
00a0ba91 : CALL 0x006f04e0
00a0ba96 : MOV ESI,0x7
00a0ba9b : XOR ECX,ECX
00a0ba9d : MOV dword ptr [ESP + 0x2c],ESI
00a0baa1 : MOV dword ptr [ESP + 0x28],EBX
00a0baa5 : MOV word ptr [ESP + 0x18],CX
00a0baaa : MOV byte ptr [ESP + 0x110],0x6
00a0bab2 : CMP dword ptr [ESP + 0x64],EDI
00a0bab6 : JC 0x00a0bac1
00a0bab8 : MOV ECX,dword ptr [ESP + 0x50]
00a0babc : CALL 0x006f04e0
00a0bac1 : XOR EDX,EDX
00a0bac3 : MOV dword ptr [ESP + 0x64],ESI
00a0bac7 : MOV dword ptr [ESP + 0x60],EBX
00a0bacb : MOV word ptr [ESP + 0x50],DX
00a0bad0 : MOV ECX,dword ptr [ESP + 0x88]
00a0bad7 : CMP dword ptr [ESP + 0x9c],EDI
00a0bade : JNC 0x00a0bae7
00a0bae0 : LEA ECX,[ESP + 0x88]
00a0bae7 : MOV EAX,[0x00d71abc]
00a0baec : CMP dword ptr [0x00d71ad0],EDI
00a0baf2 : JNC 0x00a0baf9
00a0baf4 : MOV EAX,0xd71abc
00a0baf9 : PUSH EBX
00a0bafa : PUSH ECX
00a0bafb : PUSH EAX
00a0bafc : CALL dword ptr [0x00b85158]
00a0bb02 : MOV EAX,dword ptr [ESP + 0x88]
00a0bb09 : CMP dword ptr [ESP + 0x9c],EDI
00a0bb10 : JNC 0x00a0bb19
00a0bb12 : LEA EAX,[ESP + 0x88]
00a0bb19 : PUSH EAX
00a0bb1a : LEA ECX,[ESP + 0x18]
00a0bb1e : CALL 0x00406460
00a0bb23 : MOV byte ptr [ESP + 0x110],0xd
00a0bb2b : LEA EAX,[ESP + 0x14]
00a0bb2f : PUSH EAX
00a0bb30 : LEA ECX,[ESP + 0xc0]
00a0bb37 : PUSH ECX
00a0bb38 : LEA ECX,[ESP + 0xa8]
00a0bb3f : CALL 0x00a0f1e0
00a0bb44 : MOV byte ptr [ESP + 0x110],0x6
00a0bb4c : CMP dword ptr [ESP + 0x2c],EDI
00a0bb50 : JC 0x00a0bb5b
00a0bb52 : MOV ECX,dword ptr [ESP + 0x18]
00a0bb56 : CALL 0x006f04e0
00a0bb5b : MOV EAX,dword ptr [ESP + 0x88]
00a0bb62 : XOR EDX,EDX
00a0bb64 : MOV dword ptr [ESP + 0x2c],ESI
00a0bb68 : MOV dword ptr [ESP + 0x28],EBX
00a0bb6c : MOV word ptr [ESP + 0x18],DX
00a0bb71 : CMP dword ptr [ESP + 0x9c],EDI
00a0bb78 : JNC 0x00a0bb81
00a0bb7a : LEA EAX,[ESP + 0x88]
00a0bb81 : PUSH EAX
00a0bb82 : CALL dword ptr [0x00b85124]
00a0bb88 : MOV byte ptr [ESP + 0x110],0x5
00a0bb90 : CMP dword ptr [ESP + 0xfc],EDI
00a0bb97 : JC 0x00a0bba5
00a0bb99 : MOV ECX,dword ptr [ESP + 0xe8]
00a0bba0 : CALL 0x006f04e0
00a0bba5 : XOR EAX,EAX
00a0bba7 : MOV dword ptr [ESP + 0xfc],ESI
00a0bbae : MOV dword ptr [ESP + 0xf8],EBX
00a0bbb5 : MOV word ptr [ESP + 0xe8],AX
00a0bbbd : MOV byte ptr [ESP + 0x110],0x3
00a0bbc5 : CMP dword ptr [ESP + 0xb8],EDI
00a0bbcc : JC 0x00a0bbda
00a0bbce : MOV ECX,dword ptr [ESP + 0xa4]
00a0bbd5 : CALL 0x006f04e0
00a0bbda : XOR ECX,ECX
00a0bbdc : MOV dword ptr [ESP + 0xb8],ESI
00a0bbe3 : MOV dword ptr [ESP + 0xb4],EBX
00a0bbea : MOV word ptr [ESP + 0xa4],CX
00a0bbf2 : MOV byte ptr [ESP + 0x110],0x2
00a0bbfa : CMP dword ptr [ESP + 0x80],EDI
00a0bc01 : JC 0x00a0bc0c
00a0bc03 : MOV ECX,dword ptr [ESP + 0x6c]
00a0bc07 : CALL 0x006f04e0
00a0bc0c : XOR EDX,EDX
00a0bc0e : MOV dword ptr [ESP + 0x80],ESI
00a0bc15 : MOV dword ptr [ESP + 0x7c],EBX
00a0bc19 : MOV word ptr [ESP + 0x6c],DX
00a0bc1e : MOV byte ptr [ESP + 0x110],BL
00a0bc25 : CMP dword ptr [ESP + 0x9c],EDI
00a0bc2c : JC 0x00a0bc3a
00a0bc2e : MOV ECX,dword ptr [ESP + 0x88]
00a0bc35 : CALL 0x006f04e0
00a0bc3a : XOR EAX,EAX
00a0bc3c : MOV dword ptr [ESP + 0x9c],ESI
00a0bc43 : MOV dword ptr [ESP + 0x98],EBX
00a0bc4a : MOV word ptr [ESP + 0x88],AX
00a0bc52 : MOV ECX,dword ptr [ESP + 0xc4]
00a0bc59 : MOV ESI,dword ptr [0x00b8558c]
00a0bc5f : PUSH ECX
00a0bc60 : CALL ESI
00a0bc62 : MOV EDX,dword ptr [ESP + 0xc0]
00a0bc69 : PUSH EDX
00a0bc6a : CALL ESI
00a0bc6c : MOV dword ptr [ESP + 0xc4],EBX
00a0bc73 : MOV dword ptr [ESP + 0xc0],EBX
00a0bc7a : MOV dword ptr [ESP + 0x110],0xffffffff
00a0bc85 : LEA ECX,[ESP + 0xbc]
00a0bc8c : CALL 0x00a0ef50
00a0bc91 : MOV ECX,dword ptr [ESP + 0x108]
00a0bc98 : MOV dword ptr FS:[0x0],ECX
00a0bc9f : POP ECX
00a0bca0 : POP EDI
00a0bca1 : POP ESI
00a0bca2 : POP EBX
00a0bca3 : MOV ECX,dword ptr [ESP + 0xf0]
00a0bcaa : XOR ECX,ESP
00a0bcac : CALL 0x00633e6b
00a0bcb1 : MOV ESP,EBP
00a0bcb3 : POP EBP
00a0bcb4 : RET

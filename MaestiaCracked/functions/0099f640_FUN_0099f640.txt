PROGRAM  : Maestia.exe
FUNCTION : FUN_0099f640
ENTRY    : 0099f640
BODY     : [[0099f640, 0099f742]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0099f640(void)

{
  int iVar1;
  undefined4 uVar2;
  int in_ECX;
  undefined4 uVar3;
  int unaff_EDI;
  undefined1 local_4c [4];
  undefined2 local_48;
  undefined4 local_38;
  uint local_34;
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b60c0f;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar1 = FUN_0099ef20(local_4c,*(undefined1 *)(in_ECX + 4),*(undefined4 *)(in_ECX + 5),local_14);
  local_8 = 0;
  if (*(uint *)(iVar1 + 0x18) < 8) {
    iVar1 = iVar1 + 4;
  }
  else {
    iVar1 = *(int *)(iVar1 + 4);
  }
  FUN_00404750(L"[%s]: {%s} %s...",in_ECX + 0x5f,iVar1,in_ECX + 0xd);
  local_8 = CONCAT31(local_8._1_3_,2);
  if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_34 = 7;
  local_38 = 0;
  local_48 = 0;
  if (*(char *)(unaff_EDI + 0x32) != '\0') {
    if ((*(int *)(unaff_EDI + 0x5c) - *(int *)(unaff_EDI + 0x58) & 0xfffffffcU) == 0) {
      uVar3 = 0;
      uVar2 = 0;
    }
    else {
      uVar3 = *(undefined4 *)(**(int **)(unaff_EDI + 0x58) + 8);
      uVar2 = *(undefined4 *)(**(int **)(unaff_EDI + 0x58) + 0xc);
    }
    FUN_0099edc0(unaff_EDI,1,uVar3,uVar2,1);
  }
  local_8 = 0xffffffff;
  if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_18 = 7;
  local_1c = 0;
  local_2c = 0;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0099f640 : PUSH EBP
0099f641 : MOV EBP,ESP
0099f643 : PUSH -0x1
0099f645 : PUSH 0xb60c0f
0099f64a : MOV EAX,FS:[0x0]
0099f650 : PUSH EAX
0099f651 : SUB ESP,0x3c
0099f654 : MOV EAX,[0x00d66fa0]
0099f659 : XOR EAX,EBP
0099f65b : MOV dword ptr [EBP + -0x10],EAX
0099f65e : PUSH ESI
0099f65f : PUSH EAX
0099f660 : LEA EAX,[EBP + -0xc]
0099f663 : MOV FS:[0x0],EAX
0099f669 : MOV ESI,ECX
0099f66b : MOV EAX,dword ptr [ESI + 0x5]
0099f66e : MOVZX ECX,byte ptr [ESI + 0x4]
0099f672 : PUSH EAX
0099f673 : PUSH ECX
0099f674 : LEA EDX,[EBP + -0x48]
0099f677 : PUSH EDX
0099f678 : CALL 0x0099ef20
0099f67d : ADD ESP,0xc
0099f680 : MOV dword ptr [EBP + -0x4],0x0
0099f687 : CMP dword ptr [EAX + 0x18],0x8
0099f68b : JC 0x0099f692
0099f68d : MOV EAX,dword ptr [EAX + 0x4]
0099f690 : JMP 0x0099f695
0099f692 : ADD EAX,0x4
0099f695 : LEA ECX,[ESI + 0xd]
0099f698 : PUSH ECX
0099f699 : PUSH EAX
0099f69a : ADD ESI,0x5f
0099f69d : PUSH ESI
0099f69e : PUSH 0xc88860
0099f6a3 : LEA ESI,[EBP + -0x2c]
0099f6a6 : CALL 0x00404750
0099f6ab : ADD ESP,0x10
0099f6ae : MOV byte ptr [EBP + -0x4],0x2
0099f6b2 : CMP dword ptr [EBP + -0x30],0x8
0099f6b6 : JC 0x0099f6c0
0099f6b8 : MOV ECX,dword ptr [EBP + -0x44]
0099f6bb : CALL 0x006f04e0
0099f6c0 : XOR EDX,EDX
0099f6c2 : MOV ESI,0x7
0099f6c7 : MOV dword ptr [EBP + -0x30],ESI
0099f6ca : MOV dword ptr [EBP + -0x34],0x0
0099f6d1 : MOV word ptr [EBP + -0x44],DX
0099f6d5 : CMP byte ptr [EDI + 0x32],DL
0099f6d8 : JZ 0x0099f704
0099f6da : MOV EAX,dword ptr [EDI + 0x5c]
0099f6dd : SUB EAX,dword ptr [EDI + 0x58]
0099f6e0 : TEST EAX,0xfffffffc
0099f6e5 : JNZ 0x0099f6ed
0099f6e7 : XOR ECX,ECX
0099f6e9 : XOR EAX,EAX
0099f6eb : JMP 0x0099f6f8
0099f6ed : MOV EAX,dword ptr [EDI + 0x58]
0099f6f0 : MOV EAX,dword ptr [EAX]
0099f6f2 : MOV ECX,dword ptr [EAX + 0x8]
0099f6f5 : MOV EAX,dword ptr [EAX + 0xc]
0099f6f8 : PUSH 0x1
0099f6fa : PUSH EAX
0099f6fb : PUSH ECX
0099f6fc : PUSH 0x1
0099f6fe : PUSH EDI
0099f6ff : CALL 0x0099edc0
0099f704 : MOV dword ptr [EBP + -0x4],0xffffffff
0099f70b : CMP dword ptr [EBP + -0x14],0x8
0099f70f : JC 0x0099f719
0099f711 : MOV ECX,dword ptr [EBP + -0x28]
0099f714 : CALL 0x006f04e0
0099f719 : XOR ECX,ECX
0099f71b : MOV dword ptr [EBP + -0x14],ESI
0099f71e : MOV dword ptr [EBP + -0x18],0x0
0099f725 : MOV word ptr [EBP + -0x28],CX
0099f729 : MOV ECX,dword ptr [EBP + -0xc]
0099f72c : MOV dword ptr FS:[0x0],ECX
0099f733 : POP ECX
0099f734 : POP ESI
0099f735 : MOV ECX,dword ptr [EBP + -0x10]
0099f738 : XOR ECX,EBP
0099f73a : CALL 0x00633e6b
0099f73f : MOV ESP,EBP
0099f741 : POP EBP
0099f742 : RET

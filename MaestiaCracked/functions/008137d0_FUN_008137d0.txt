PROGRAM  : Maestia.exe
FUNCTION : FUN_008137d0
ENTRY    : 008137d0
BODY     : [[008137d0, 0081399f]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_008137d0(int param_1)

{
  char cVar1;
  uint uVar2;
  LPCSTR pCVar3;
  int iVar4;
  LPCSTR in_ECX;
  undefined4 unaff_EDI;
  undefined1 local_203c [4];
  undefined2 local_2038;
  undefined4 local_2028;
  uint local_2024;
  int local_2020;
  int local_201c;
  undefined4 local_2018;
  WCHAR local_2014 [4096];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1a92b;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_201c = param_1;
  local_2018 = 0;
  local_14 = uVar2;
  _memset(local_2014,0,0x2000);
  pCVar3 = in_ECX;
  do {
    cVar1 = *pCVar3;
    pCVar3 = pCVar3 + 1;
  } while (cVar1 != '\0');
  iVar4 = MultiByteToWideChar(0x3b5,0,in_ECX,(int)(pCVar3 + (1 - (int)(in_ECX + 1))),local_2014,
                              0x400);
  if (iVar4 == 0) {
    FUN_00406460(L"MultiByteToWideChar");
    local_8 = 1;
    if ((int *)*DAT_00da98e8 != (int *)0x0) {
      (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                (L"AvaGameExcelData::GetStringFlashText",0x336,local_203c);
    }
    local_8 = local_8 & 0xffffff00;
    if (7 < local_2024) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0(uVar2);
    }
    local_2024 = 7;
    local_2028 = 0;
    local_2038 = 0;
    FUN_00406460(&DAT_00c2e3ac);
  }
  else {
    FUN_00406460(local_2014);
    local_8 = 2;
    FUN_0043acd0(local_201c + 0x48,&local_2020);
    local_8 = local_8 & 0xffffff00;
    if (7 < local_2024) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0(uVar2);
    }
    local_2038 = 0;
    local_2024 = 7;
    local_2028 = 0;
    if (local_2020 == *(int *)(local_201c + 0x4c)) {
      FUN_00406460(&DAT_00c2e3fc);
    }
    else {
      FUN_004541a0(unaff_EDI);
    }
  }
  local_8 = 0;
  local_2018 = 1;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008137d0 : PUSH EBP
008137d1 : MOV EBP,ESP
008137d3 : PUSH -0x1
008137d5 : PUSH 0xb1a92b
008137da : MOV EAX,FS:[0x0]
008137e0 : PUSH EAX
008137e1 : MOV EAX,0x2030
008137e6 : CALL 0x0063b780
008137eb : MOV EAX,[0x00d66fa0]
008137f0 : XOR EAX,EBP
008137f2 : MOV dword ptr [EBP + -0x10],EAX
008137f5 : PUSH EBX
008137f6 : PUSH ESI
008137f7 : PUSH EAX
008137f8 : LEA EAX,[EBP + -0xc]
008137fb : MOV FS:[0x0],EAX
00813801 : MOV EAX,dword ptr [EBP + 0x8]
00813804 : XOR EBX,EBX
00813806 : PUSH 0x2000
0081380b : MOV ESI,ECX
0081380d : LEA ECX,[EBP + 0xffffdff0]
00813813 : PUSH EBX
00813814 : PUSH ECX
00813815 : MOV dword ptr [EBP + 0xffffdfe8],EAX
0081381b : MOV dword ptr [EBP + 0xffffdfc4],EDI
00813821 : MOV dword ptr [EBP + 0xffffdfec],EBX
00813827 : CALL 0x0063b700
0081382c : MOV EAX,ESI
0081382e : ADD ESP,0xc
00813831 : LEA EDX,[EAX + 0x1]
00813834 : MOV CL,byte ptr [EAX]
00813836 : INC EAX
00813837 : CMP CL,BL
00813839 : JNZ 0x00813834
0081383b : PUSH 0x400
00813840 : SUB EAX,EDX
00813842 : LEA EDX,[EBP + 0xffffdff0]
00813848 : PUSH EDX
00813849 : INC EAX
0081384a : PUSH EAX
0081384b : PUSH ESI
0081384c : PUSH EBX
0081384d : PUSH 0x3b5
00813852 : CALL dword ptr [0x00b850e0]
00813858 : CMP EAX,EBX
0081385a : JNZ 0x008138e5
00813860 : PUSH 0xc2e384
00813865 : LEA ECX,[EBP + 0xffffdfc8]
0081386b : CALL 0x00406460
00813870 : MOV ESI,0x1
00813875 : MOV dword ptr [EBP + -0x4],ESI
00813878 : MOV EAX,[0x00da98e8]
0081387d : MOV ECX,dword ptr [EAX]
0081387f : CMP ECX,EBX
00813881 : JZ 0x0081389b
00813883 : MOV EDX,dword ptr [ECX]
00813885 : MOV EDX,dword ptr [EDX + 0x14]
00813888 : LEA EAX,[EBP + 0xffffdfc8]
0081388e : PUSH EAX
0081388f : PUSH 0x336
00813894 : PUSH 0xc2e3b0
00813899 : CALL EDX
0081389b : MOV byte ptr [EBP + -0x4],BL
0081389e : CMP dword ptr [EBP + 0xffffdfe0],0x8
008138a5 : JC 0x008138b2
008138a7 : MOV ECX,dword ptr [EBP + 0xffffdfcc]
008138ad : CALL 0x006f04e0
008138b2 : XOR EAX,EAX
008138b4 : PUSH 0xc2e3ac
008138b9 : MOV ECX,EDI
008138bb : MOV dword ptr [EBP + 0xffffdfe0],0x7
008138c5 : MOV dword ptr [EBP + 0xffffdfdc],EBX
008138cb : MOV word ptr [EBP + 0xffffdfcc],AX
008138d2 : CALL 0x00406460
008138d7 : MOV dword ptr [EBP + -0x4],EBX
008138da : MOV dword ptr [EBP + 0xffffdfec],ESI
008138e0 : JMP 0x00813981
008138e5 : LEA ECX,[EBP + 0xffffdff0]
008138eb : PUSH ECX
008138ec : LEA ECX,[EBP + 0xffffdfc8]
008138f2 : CALL 0x00406460
008138f7 : MOV dword ptr [EBP + -0x4],0x2
008138fe : MOV EAX,dword ptr [EBP + 0xffffdfe8]
00813904 : LEA EDX,[EBP + 0xffffdfe4]
0081390a : PUSH EDX
0081390b : ADD EAX,0x48
0081390e : PUSH EAX
0081390f : LEA ESI,[EBP + 0xffffdfc8]
00813915 : CALL 0x0043acd0
0081391a : MOV byte ptr [EBP + -0x4],BL
0081391d : CMP dword ptr [EBP + 0xffffdfe0],0x8
00813924 : JC 0x00813931
00813926 : MOV ECX,dword ptr [EBP + 0xffffdfcc]
0081392c : CALL 0x006f04e0
00813931 : MOV EDX,dword ptr [EBP + 0xffffdfe8]
00813937 : MOV EAX,dword ptr [EDX + 0x4c]
0081393a : XOR ECX,ECX
0081393c : MOV word ptr [EBP + 0xffffdfcc],CX
00813943 : MOV ECX,dword ptr [EBP + 0xffffdfe4]
00813949 : MOV dword ptr [EBP + 0xffffdfe0],0x7
00813953 : MOV dword ptr [EBP + 0xffffdfdc],EBX
00813959 : CMP ECX,EAX
0081395b : JNZ 0x0081396b
0081395d : PUSH 0xc2e3fc
00813962 : MOV ECX,EDI
00813964 : CALL 0x00406460
00813969 : JMP 0x00813974
0081396b : MOV ECX,dword ptr [ECX + 0x28]
0081396e : PUSH EDI
0081396f : CALL 0x004541a0
00813974 : MOV dword ptr [EBP + -0x4],EBX
00813977 : MOV dword ptr [EBP + 0xffffdfec],0x1
00813981 : MOV EAX,EDI
00813983 : MOV ECX,dword ptr [EBP + -0xc]
00813986 : MOV dword ptr FS:[0x0],ECX
0081398d : POP ECX
0081398e : POP ESI
0081398f : POP EBX
00813990 : MOV ECX,dword ptr [EBP + -0x10]
00813993 : XOR ECX,EBP
00813995 : CALL 0x00633e6b
0081399a : MOV ESP,EBP
0081399c : POP EBP
0081399d : RET 0x4

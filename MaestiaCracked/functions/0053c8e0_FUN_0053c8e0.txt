PROGRAM  : Maestia.exe
FUNCTION : FUN_0053c8e0
ENTRY    : 0053c8e0
BODY     : [[0053c8e0, 0053ca79]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0053c8e0(void)

{
  uint *puVar1;
  ushort *puVar2;
  int iVar3;
  uint uVar4;
  int in_ECX;
  uint uVar5;
  
  if (*(int *)(in_ECX + 4) == 7) {
    FUN_0053c7a0();
    puVar1 = (uint *)(in_ECX + 8);
    if (*(uint *)(in_ECX + 8) < *(uint *)(in_ECX + 0x10)) {
      do {
        uVar4 = *(uint *)(in_ECX + 0x14) & 0xffff;
        uVar5 = (uint)*(ushort *)(&DAT_00b87308 + (uVar4 >> 8) * 2);
        if ((uVar5 == 0) ||
           (((uVar5 != 1 &&
             ((1 << ((byte)uVar4 & 0xf) &
              (uint)*(ushort *)(&DAT_00b87308 + ((uVar4 >> 4 & 0xf) + uVar5) * 2)) == 0)) ||
            (*(uint *)(in_ECX + 0x14) == 0x3d)))) break;
        puVar2 = *(ushort **)(in_ECX + 0xc);
        *puVar1 = (uint)puVar2;
        if ((*(char *)(in_ECX + 0x18) == '\0') || (*puVar2 != 0x26)) {
          if (puVar2 < *(ushort **)(in_ECX + 0x10)) {
            *(uint *)(in_ECX + 0x14) = (uint)*puVar2;
            *(ushort **)(in_ECX + 0xc) = puVar2 + 1;
          }
        }
        else {
          FUN_0053bdd0();
        }
      } while (*puVar1 < *(uint *)(in_ECX + 0x10));
    }
    if (*(uint *)(in_ECX + 0x10) <= *puVar1) goto LAB_0053c982;
    iVar3 = *(int *)(in_ECX + 0x14);
    if (iVar3 == 0x3d) {
      FUN_0053c5c0();
      FUN_0053c7a0();
      *(undefined4 *)(in_ECX + 4) = 8;
    }
    else if ((iVar3 == 0x2f) || (iVar3 == 0x3e)) {
      *(undefined4 *)(in_ECX + 4) = 9;
    }
    else {
      *(undefined4 *)(in_ECX + 4) = 1;
    }
  }
  if (*(int *)(in_ECX + 4) != 8) {
    return;
  }
  iVar3 = *(int *)(in_ECX + 0x14);
  if ((iVar3 == 0x22) || (iVar3 == 0x27)) {
    puVar1 = (uint *)(in_ECX + 8);
    do {
      puVar2 = *(ushort **)(in_ECX + 0xc);
      *puVar1 = (uint)puVar2;
      if ((*(char *)(in_ECX + 0x18) == '\0') || (*puVar2 != 0x26)) {
        if (puVar2 < *(ushort **)(in_ECX + 0x10)) {
          *(uint *)(in_ECX + 0x14) = (uint)*puVar2;
          *(ushort **)(in_ECX + 0xc) = puVar2 + 1;
        }
      }
      else {
        FUN_0053bdd0();
      }
    } while ((*puVar1 < *(uint *)(in_ECX + 0x10)) && (*(int *)(in_ECX + 0x14) != iVar3));
    if (*puVar1 < *(uint *)(in_ECX + 0x10)) {
      puVar2 = *(ushort **)(in_ECX + 0xc);
      *puVar1 = (uint)puVar2;
      if ((*(char *)(in_ECX + 0x18) == '\0') || (*puVar2 != 0x26)) {
        if (puVar2 < *(ushort **)(in_ECX + 0x10)) {
          *(uint *)(in_ECX + 0x14) = (uint)*puVar2;
          *(ushort **)(in_ECX + 0xc) = puVar2 + 1;
        }
      }
      else {
        FUN_0053bdd0();
      }
      FUN_0053c7a0();
      if ((*(int *)(in_ECX + 0x14) != 0x3e) && (*(int *)(in_ECX + 0x14) != 0x2f)) {
        *(undefined4 *)(in_ECX + 4) = 7;
        return;
      }
      *(undefined4 *)(in_ECX + 4) = 9;
      return;
    }
  }
LAB_0053c982:
  *(undefined4 *)(in_ECX + 4) = 1;
  return;
}



============================================================
DISASSEMBLY
============================================================
0053c8e0 : PUSH ECX
0053c8e1 : PUSH EBX
0053c8e2 : PUSH ESI
0053c8e3 : PUSH EDI
0053c8e4 : MOV EDI,ECX
0053c8e6 : CMP dword ptr [EDI + 0x4],0x7
0053c8ea : JNZ 0x0053c9c7
0053c8f0 : CALL 0x0053c7a0
0053c8f5 : MOV EAX,dword ptr [EDI + 0x8]
0053c8f8 : CMP EAX,dword ptr [EDI + 0x10]
0053c8fb : LEA ESI,[EDI + 0x8]
0053c8fe : JNC 0x0053c97b
0053c900 : PUSH EBP
0053c901 : MOV EBX,dword ptr [EDI + 0x14]
0053c904 : MOVZX EAX,BX
0053c907 : MOV ECX,EAX
0053c909 : SHR ECX,0x8
0053c90c : MOVZX EDX,word ptr [ECX*0x2 + 0xb87308]
0053c914 : TEST EDX,EDX
0053c916 : JZ 0x0053c97a
0053c918 : CMP EDX,0x1
0053c91b : JZ 0x0053c943
0053c91d : MOV ECX,EAX
0053c91f : SHR EAX,0x4
0053c922 : AND EAX,0xf
0053c925 : AND ECX,0xf
0053c928 : ADD EAX,EDX
0053c92a : MOVZX EDX,word ptr [EAX*0x2 + 0xb87308]
0053c932 : MOV EBP,0x1
0053c937 : SHL EBP,CL
0053c939 : AND EBP,EDX
0053c93b : NEG EBP
0053c93d : SBB EBP,EBP
0053c93f : NEG EBP
0053c941 : JZ 0x0053c97a
0053c943 : CMP EBX,0x3d
0053c946 : JZ 0x0053c97a
0053c948 : CMP byte ptr [ESI + 0x10],0x0
0053c94c : MOV EAX,dword ptr [ESI + 0x4]
0053c94f : MOV dword ptr [ESI],EAX
0053c951 : JZ 0x0053c962
0053c953 : CMP word ptr [EAX],0x26
0053c957 : JNZ 0x0053c962
0053c959 : MOV ECX,ESI
0053c95b : CALL 0x0053bdd0
0053c960 : JMP 0x0053c973
0053c962 : CMP EAX,dword ptr [ESI + 0x8]
0053c965 : JNC 0x0053c973
0053c967 : MOVZX ECX,word ptr [EAX]
0053c96a : ADD EAX,0x2
0053c96d : MOV dword ptr [ESI + 0xc],ECX
0053c970 : MOV dword ptr [ESI + 0x4],EAX
0053c973 : MOV EDX,dword ptr [ESI]
0053c975 : CMP EDX,dword ptr [ESI + 0x8]
0053c978 : JC 0x0053c901
0053c97a : POP EBP
0053c97b : MOV EAX,dword ptr [ESI]
0053c97d : CMP EAX,dword ptr [ESI + 0x8]
0053c980 : JC 0x0053c98e
0053c982 : MOV dword ptr [EDI + 0x4],0x1
0053c989 : POP EDI
0053c98a : POP ESI
0053c98b : POP EBX
0053c98c : POP ECX
0053c98d : RET
0053c98e : MOV EAX,dword ptr [EDI + 0x14]
0053c991 : CMP EAX,0x3d
0053c994 : JNZ 0x0053c9ad
0053c996 : MOV ECX,ESI
0053c998 : CALL 0x0053c5c0
0053c99d : MOV ECX,EDI
0053c99f : CALL 0x0053c7a0
0053c9a4 : MOV dword ptr [EDI + 0x4],0x8
0053c9ab : JMP 0x0053c9c7
0053c9ad : CMP EAX,0x2f
0053c9b0 : JZ 0x0053c9c0
0053c9b2 : CMP EAX,0x3e
0053c9b5 : JZ 0x0053c9c0
0053c9b7 : MOV dword ptr [EDI + 0x4],0x1
0053c9be : JMP 0x0053c9c7
0053c9c0 : MOV dword ptr [EDI + 0x4],0x9
0053c9c7 : CMP dword ptr [EDI + 0x4],0x8
0053c9cb : JNZ 0x0053ca75
0053c9d1 : MOV EBX,dword ptr [EDI + 0x14]
0053c9d4 : CMP EBX,0x22
0053c9d7 : JZ 0x0053c9de
0053c9d9 : CMP EBX,0x27
0053c9dc : JNZ 0x0053c982
0053c9de : LEA ESI,[EDI + 0x8]
0053c9e1 : CMP byte ptr [ESI + 0x10],0x0
0053c9e5 : MOV EAX,dword ptr [ESI + 0x4]
0053c9e8 : MOV dword ptr [ESI],EAX
0053c9ea : JZ 0x0053c9fb
0053c9ec : CMP word ptr [EAX],0x26
0053c9f0 : JNZ 0x0053c9fb
0053c9f2 : MOV ECX,ESI
0053c9f4 : CALL 0x0053bdd0
0053c9f9 : JMP 0x0053ca0c
0053c9fb : CMP EAX,dword ptr [ESI + 0x8]
0053c9fe : JNC 0x0053ca0c
0053ca00 : MOVZX ECX,word ptr [EAX]
0053ca03 : ADD EAX,0x2
0053ca06 : MOV dword ptr [ESI + 0xc],ECX
0053ca09 : MOV dword ptr [ESI + 0x4],EAX
0053ca0c : MOV EDX,dword ptr [ESI]
0053ca0e : CMP EDX,dword ptr [ESI + 0x8]
0053ca11 : JNC 0x0053ca18
0053ca13 : CMP dword ptr [EDI + 0x14],EBX
0053ca16 : JNZ 0x0053c9e1
0053ca18 : MOV EAX,EDX
0053ca1a : CMP EAX,dword ptr [ESI + 0x8]
0053ca1d : JNC 0x0053c982
0053ca23 : CMP byte ptr [ESI + 0x10],0x0
0053ca27 : MOV EAX,dword ptr [ESI + 0x4]
0053ca2a : MOV dword ptr [ESI],EAX
0053ca2c : JZ 0x0053ca3d
0053ca2e : CMP word ptr [EAX],0x26
0053ca32 : JNZ 0x0053ca3d
0053ca34 : MOV ECX,ESI
0053ca36 : CALL 0x0053bdd0
0053ca3b : JMP 0x0053ca4e
0053ca3d : CMP EAX,dword ptr [ESI + 0x8]
0053ca40 : JNC 0x0053ca4e
0053ca42 : MOVZX ECX,word ptr [EAX]
0053ca45 : ADD EAX,0x2
0053ca48 : MOV dword ptr [ESI + 0xc],ECX
0053ca4b : MOV dword ptr [ESI + 0x4],EAX
0053ca4e : MOV ECX,EDI
0053ca50 : CALL 0x0053c7a0
0053ca55 : MOV EAX,dword ptr [EDI + 0x14]
0053ca58 : CMP EAX,0x3e
0053ca5b : JZ 0x0053ca6e
0053ca5d : CMP EAX,0x2f
0053ca60 : JZ 0x0053ca6e
0053ca62 : MOV dword ptr [EDI + 0x4],0x7
0053ca69 : POP EDI
0053ca6a : POP ESI
0053ca6b : POP EBX
0053ca6c : POP ECX
0053ca6d : RET
0053ca6e : MOV dword ptr [EDI + 0x4],0x9
0053ca75 : POP EDI
0053ca76 : POP ESI
0053ca77 : POP EBX
0053ca78 : POP ECX
0053ca79 : RET

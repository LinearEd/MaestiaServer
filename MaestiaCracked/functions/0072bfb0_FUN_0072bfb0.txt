PROGRAM  : Maestia.exe
FUNCTION : FUN_0072bfb0
ENTRY    : 0072bfb0
BODY     : [[0072bfb0, 0072c1f5]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0072bfb0(int param_1,int param_2)

{
  uint uVar1;
  int iVar2;
  int in_ECX;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 uVar3;
  int *unaff_EDI;
  ulonglong uVar4;
  uint uVar5;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3bb4a;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *unaff_EDI = in_ECX;
  uVar5 = uVar1;
  iVar2 = FUN_00612a40();
  unaff_EDI[1] = iVar2;
  unaff_EDI[0x18] = param_1;
  unaff_EDI[7] = param_2;
  FUN_00404350();
  local_8 = 0;
  FUN_0070c170(uVar5);
  iVar2 = FUN_00407c10(&DAT_00c02994,3);
  *(bool *)(unaff_EDI + 6) = iVar2 != -1;
  iVar2 = FUN_006143a0(*(undefined4 *)(unaff_EDI[1] + 0x128));
  if (iVar2 == 2) {
    uVar4 = FUN_006f0760(0x10,"",0,(DAT_01725270 >> 3 & 1) == 0);
    iVar2 = (int)uVar4;
    local_8 = CONCAT31(local_8._1_3_,1);
    if (iVar2 != 0) {
      uVar4 = FUN_0071a390(iVar2);
      goto LAB_0072c154;
    }
  }
  else {
    iVar2 = FUN_00613fa0(unaff_EDI[1]);
    if (iVar2 == 0) {
      uVar4 = FUN_006f0760(0x38,"",0,(DAT_01725270 >> 3 & 1) == 0);
      iVar2 = (int)uVar4;
      local_8 = CONCAT31(local_8._1_3_,2);
      if (iVar2 != 0) {
        uVar4 = FUN_007192c0(iVar2);
        goto LAB_0072c154;
      }
    }
    else if (iVar2 == 1) {
      uVar4 = FUN_006f0300(0x38);
      iVar2 = (int)uVar4;
      local_8 = CONCAT31(local_8._1_3_,3);
      if (iVar2 != 0) {
        uVar4 = FUN_00718060(iVar2);
        goto LAB_0072c154;
      }
    }
    else if (iVar2 == 2) {
      uVar4 = FUN_006f0300(0x38);
      iVar2 = (int)uVar4;
      local_8 = CONCAT31(local_8._1_3_,4);
      if (iVar2 != 0) {
        uVar4 = FUN_007170e0(iVar2);
        goto LAB_0072c154;
      }
    }
    else if (iVar2 == 3) {
      uVar4 = FUN_006f0300(0x3c);
      iVar2 = (int)uVar4;
      local_8 = CONCAT31(local_8._1_3_,5);
      if (iVar2 != 0) {
        uVar4 = FUN_00715f30(iVar2);
        goto LAB_0072c154;
      }
    }
    else {
      uVar4 = FUN_006f0300(0x38);
      iVar2 = (int)uVar4;
      local_8 = CONCAT31(local_8._1_3_,6);
      if (iVar2 != 0) {
        uVar4 = FUN_00715350(iVar2);
        goto LAB_0072c154;
      }
    }
  }
  iVar2 = (int)uVar4;
  uVar4 = uVar4 & 0xffffffff00000000;
LAB_0072c154:
  uVar3 = (undefined4)(uVar4 >> 0x20);
  local_8 = local_8 & 0xffffff00;
  unaff_EDI[4] = (int)uVar4;
  if ((int)uVar4 == 0) {
    if (*unaff_EDI != 0) {
      FUN_00611c30();
      *unaff_EDI = 0;
      uVar3 = extraout_EDX;
      if ((undefined4 *)unaff_EDI[4] != (undefined4 *)0x0) {
        (*(code *)**(undefined4 **)unaff_EDI[4])(1);
        uVar3 = extraout_EDX_00;
      }
      unaff_EDI[4] = 0;
    }
    local_8 = 0xffffffff;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  else {
    FUN_0072bf50();
    FUN_006131a0(*unaff_EDI);
    local_8 = 0xffffffff;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    uVar3 = 0;
  }
  local_8 = 0xffffffff;
  ExceptionList = local_10;
  __security_check_cookie(uVar1 ^ (uint)&stack0xfffffffc,uVar3,iVar2);
  return;
}



============================================================
DISASSEMBLY
============================================================
0072bfb0 : PUSH EBP
0072bfb1 : MOV EBP,ESP
0072bfb3 : PUSH -0x1
0072bfb5 : PUSH 0xb3bb4a
0072bfba : MOV EAX,FS:[0x0]
0072bfc0 : PUSH EAX
0072bfc1 : SUB ESP,0x24
0072bfc4 : MOV EAX,[0x00d66fa0]
0072bfc9 : XOR EAX,EBP
0072bfcb : MOV dword ptr [EBP + -0x10],EAX
0072bfce : PUSH EBX
0072bfcf : PUSH ESI
0072bfd0 : PUSH EAX
0072bfd1 : LEA EAX,[EBP + -0xc]
0072bfd4 : MOV FS:[0x0],EAX
0072bfda : MOV ESI,ECX
0072bfdc : PUSH ESI
0072bfdd : MOV dword ptr [EDI],ESI
0072bfdf : CALL 0x00612a40
0072bfe4 : MOV ECX,dword ptr [EBP + 0xc]
0072bfe7 : MOV dword ptr [EDI + 0x4],EAX
0072bfea : MOV EAX,dword ptr [EBP + 0x8]
0072bfed : PUSH ESI
0072bfee : LEA ESI,[EBP + -0x2c]
0072bff1 : MOV dword ptr [EDI + 0x60],EAX
0072bff4 : MOV dword ptr [EDI + 0x1c],ECX
0072bff7 : CALL 0x00404350
0072bffc : ADD ESP,0x8
0072bfff : XOR EBX,EBX
0072c001 : MOV dword ptr [EBP + -0x4],EBX
0072c004 : MOV ECX,ESI
0072c006 : CALL 0x0070c170
0072c00b : PUSH 0x3
0072c00d : PUSH 0xc02994
0072c012 : XOR EAX,EAX
0072c014 : MOV EDX,ESI
0072c016 : CALL 0x00407c10
0072c01b : CMP EAX,-0x1
0072c01e : MOV EAX,dword ptr [EDI + 0x4]
0072c021 : SETNZ DL
0072c024 : MOV byte ptr [EDI + 0x18],DL
0072c027 : MOV EAX,dword ptr [EAX + 0x128]
0072c02d : PUSH EAX
0072c02e : CALL 0x006143a0
0072c033 : ADD ESP,0x4
0072c036 : CMP EAX,0x2
0072c039 : JNZ 0x0072c079
0072c03b : MOV ECX,dword ptr [0x01725270]
0072c041 : SHR ECX,0x3
0072c044 : MOV EDX,EBX
0072c046 : AND ECX,0x1
0072c049 : SETZ DL
0072c04c : PUSH EDX
0072c04d : PUSH EBX
0072c04e : PUSH 0xbf1a4a
0072c053 : PUSH 0x10
0072c055 : CALL 0x006f0760
0072c05a : ADD ESP,0x10
0072c05d : MOV dword ptr [EBP + -0x30],EAX
0072c060 : MOV byte ptr [EBP + -0x4],0x1
0072c064 : CMP EAX,EBX
0072c066 : JZ 0x0072c152
0072c06c : PUSH EAX
0072c06d : MOV ECX,EDI
0072c06f : CALL 0x0071a390
0072c074 : JMP 0x0072c154
0072c079 : MOV EAX,dword ptr [EDI + 0x4]
0072c07c : PUSH EAX
0072c07d : CALL 0x00613fa0
0072c082 : ADD ESP,0x4
0072c085 : CMP EAX,EBX
0072c087 : JNZ 0x0072c0c7
0072c089 : MOV ECX,dword ptr [0x01725270]
0072c08f : SHR ECX,0x3
0072c092 : MOV EDX,EBX
0072c094 : AND ECX,0x1
0072c097 : SETZ DL
0072c09a : PUSH EDX
0072c09b : PUSH EBX
0072c09c : PUSH 0xbf1a4a
0072c0a1 : PUSH 0x38
0072c0a3 : CALL 0x006f0760
0072c0a8 : ADD ESP,0x10
0072c0ab : MOV dword ptr [EBP + -0x30],EAX
0072c0ae : MOV byte ptr [EBP + -0x4],0x2
0072c0b2 : CMP EAX,EBX
0072c0b4 : JZ 0x0072c152
0072c0ba : PUSH EAX
0072c0bb : MOV ECX,EDI
0072c0bd : CALL 0x007192c0
0072c0c2 : JMP 0x0072c154
0072c0c7 : CMP EAX,0x1
0072c0ca : JNZ 0x0072c0eb
0072c0cc : PUSH 0x38
0072c0ce : CALL 0x006f0300
0072c0d3 : ADD ESP,0x4
0072c0d6 : MOV dword ptr [EBP + -0x30],EAX
0072c0d9 : MOV byte ptr [EBP + -0x4],0x3
0072c0dd : CMP EAX,EBX
0072c0df : JZ 0x0072c152
0072c0e1 : PUSH EAX
0072c0e2 : MOV ECX,EDI
0072c0e4 : CALL 0x00718060
0072c0e9 : JMP 0x0072c154
0072c0eb : CMP EAX,0x2
0072c0ee : JNZ 0x0072c10f
0072c0f0 : PUSH 0x38
0072c0f2 : CALL 0x006f0300
0072c0f7 : ADD ESP,0x4
0072c0fa : MOV dword ptr [EBP + -0x30],EAX
0072c0fd : MOV byte ptr [EBP + -0x4],0x4
0072c101 : CMP EAX,EBX
0072c103 : JZ 0x0072c152
0072c105 : PUSH EAX
0072c106 : MOV ECX,EDI
0072c108 : CALL 0x007170e0
0072c10d : JMP 0x0072c154
0072c10f : CMP EAX,0x3
0072c112 : JNZ 0x0072c133
0072c114 : PUSH 0x3c
0072c116 : CALL 0x006f0300
0072c11b : ADD ESP,0x4
0072c11e : MOV dword ptr [EBP + -0x30],EAX
0072c121 : MOV byte ptr [EBP + -0x4],0x5
0072c125 : CMP EAX,EBX
0072c127 : JZ 0x0072c152
0072c129 : PUSH EAX
0072c12a : MOV ECX,EDI
0072c12c : CALL 0x00715f30
0072c131 : JMP 0x0072c154
0072c133 : PUSH 0x38
0072c135 : CALL 0x006f0300
0072c13a : ADD ESP,0x4
0072c13d : MOV dword ptr [EBP + -0x30],EAX
0072c140 : MOV byte ptr [EBP + -0x4],0x6
0072c144 : CMP EAX,EBX
0072c146 : JZ 0x0072c152
0072c148 : PUSH EAX
0072c149 : MOV ECX,EDI
0072c14b : CALL 0x00715350
0072c150 : JMP 0x0072c154
0072c152 : XOR EAX,EAX
0072c154 : MOV byte ptr [EBP + -0x4],BL
0072c157 : MOV dword ptr [EDI + 0x10],EAX
0072c15a : CMP EAX,EBX
0072c15c : JNZ 0x0072c19f
0072c15e : CMP dword ptr [EDI],EBX
0072c160 : JZ 0x0072c17f
0072c162 : PUSH EDI
0072c163 : CALL 0x00611c30
0072c168 : MOV ECX,dword ptr [EDI + 0x10]
0072c16b : ADD ESP,0x4
0072c16e : MOV dword ptr [EDI],EBX
0072c170 : CMP ECX,EBX
0072c172 : JZ 0x0072c17c
0072c174 : MOV EAX,dword ptr [ECX]
0072c176 : MOV EDX,dword ptr [EAX]
0072c178 : PUSH 0x1
0072c17a : CALL EDX
0072c17c : MOV dword ptr [EDI + 0x10],EBX
0072c17f : MOV dword ptr [EBP + -0x4],0xffffffff
0072c186 : CMP dword ptr [EBP + -0x14],0x8
0072c18a : JC 0x0072c194
0072c18c : MOV ECX,dword ptr [EBP + -0x28]
0072c18f : CALL 0x006f04e0
0072c194 : XOR EAX,EAX
0072c196 : MOV word ptr [EBP + -0x28],AX
0072c19a : OR EAX,0xffffffff
0072c19d : JMP 0x0072c1cf
0072c19f : MOV ESI,EDI
0072c1a1 : CALL 0x0072bf50
0072c1a6 : MOV ECX,dword ptr [EDI]
0072c1a8 : PUSH EDI
0072c1a9 : PUSH ECX
0072c1aa : CALL 0x006131a0
0072c1af : ADD ESP,0x8
0072c1b2 : MOV dword ptr [EBP + -0x4],0xffffffff
0072c1b9 : CMP dword ptr [EBP + -0x14],0x8
0072c1bd : JC 0x0072c1c7
0072c1bf : MOV ECX,dword ptr [EBP + -0x28]
0072c1c2 : CALL 0x006f04e0
0072c1c7 : XOR EDX,EDX
0072c1c9 : MOV word ptr [EBP + -0x28],DX
0072c1cd : XOR EAX,EAX
0072c1cf : MOV dword ptr [EBP + -0x18],EBX
0072c1d2 : MOV dword ptr [EBP + -0x14],0x7
0072c1d9 : MOV ECX,dword ptr [EBP + -0xc]
0072c1dc : MOV dword ptr FS:[0x0],ECX
0072c1e3 : POP ECX
0072c1e4 : POP ESI
0072c1e5 : POP EBX
0072c1e6 : MOV ECX,dword ptr [EBP + -0x10]
0072c1e9 : XOR ECX,EBP
0072c1eb : CALL 0x00633e6b
0072c1f0 : MOV ESP,EBP
0072c1f2 : POP EBP
0072c1f3 : RET 0x8

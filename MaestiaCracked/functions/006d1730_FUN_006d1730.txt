PROGRAM  : Maestia.exe
FUNCTION : FUN_006d1730
ENTRY    : 006d1730
BODY     : [[006d1730, 006d178e] [006d1791, 006d1867]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006d1730(int param_1,int param_2,int param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined1 local_1c [4];
  undefined1 local_18 [4];
  byte local_14;
  uint local_10;
  undefined4 local_c;
  uint local_8;
  
  local_10 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  if ((*(uint *)(param_1 + 0x68) & 1) == 0) {
    FUN_006c23a0(param_1,"Missing IHDR before oFFs");
  }
  else {
    if ((*(uint *)(param_1 + 0x68) & 4) != 0) {
      FUN_006c24c0(param_1,"Invalid oFFs after IDAT");
      FUN_006cf140(param_1,param_3);
      goto LAB_006d185a;
    }
    if ((param_2 != 0) && ((*(uint *)(param_2 + 8) & 0x100) != 0)) {
      FUN_006c24c0(param_1,"Duplicate oFFs chunk");
      FUN_006cf140(param_1,param_3);
      goto LAB_006d185a;
    }
  }
  if (param_3 == 9) {
    FUN_006cf100(param_1,local_1c,9);
    iVar1 = FUN_006cf140(param_1,0);
    if (iVar1 == 0) {
      local_c = FUN_006cf090(local_1c);
      uVar2 = FUN_006cf090(local_18);
      local_8 = (uint)local_14;
      FUN_006cdde0(param_1,param_2,local_c,uVar2,local_8);
    }
  }
  else {
    FUN_006c24c0(param_1,"Incorrect oFFs chunk length");
    FUN_006cf140(param_1,param_3);
  }
LAB_006d185a:
  __security_check_cookie(local_10 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
006d1730 : PUSH EBP
006d1731 : MOV EBP,ESP
006d1733 : SUB ESP,0x1c
006d1736 : MOV EAX,[0x00d66fa0]
006d173b : XOR EAX,EBP
006d173d : MOV dword ptr [EBP + -0xc],EAX
006d1740 : MOV EAX,dword ptr [EBP + 0x8]
006d1743 : MOV ECX,dword ptr [EAX + 0x68]
006d1746 : AND ECX,0x1
006d1749 : JNZ 0x006d175e
006d174b : PUSH 0xbeea88
006d1750 : MOV EDX,dword ptr [EBP + 0x8]
006d1753 : PUSH EDX
006d1754 : CALL 0x006c23a0
006d1759 : ADD ESP,0x8
006d175c : JMP 0x006d17ca
006d175e : MOV EAX,dword ptr [EBP + 0x8]
006d1761 : MOV ECX,dword ptr [EAX + 0x68]
006d1764 : AND ECX,0x4
006d1767 : JZ 0x006d1791
006d1769 : PUSH 0xbeea70
006d176e : MOV EDX,dword ptr [EBP + 0x8]
006d1771 : PUSH EDX
006d1772 : CALL 0x006c24c0
006d1777 : ADD ESP,0x8
006d177a : MOV EAX,dword ptr [EBP + 0x10]
006d177d : PUSH EAX
006d177e : MOV ECX,dword ptr [EBP + 0x8]
006d1781 : PUSH ECX
006d1782 : CALL 0x006cf140
006d1787 : ADD ESP,0x8
006d178a : JMP 0x006d185a
006d1791 : CMP dword ptr [EBP + 0xc],0x0
006d1795 : JZ 0x006d17ca
006d1797 : MOV EDX,dword ptr [EBP + 0xc]
006d179a : MOV EAX,dword ptr [EDX + 0x8]
006d179d : AND EAX,0x100
006d17a2 : JZ 0x006d17ca
006d17a4 : PUSH 0xbeea58
006d17a9 : MOV ECX,dword ptr [EBP + 0x8]
006d17ac : PUSH ECX
006d17ad : CALL 0x006c24c0
006d17b2 : ADD ESP,0x8
006d17b5 : MOV EDX,dword ptr [EBP + 0x10]
006d17b8 : PUSH EDX
006d17b9 : MOV EAX,dword ptr [EBP + 0x8]
006d17bc : PUSH EAX
006d17bd : CALL 0x006cf140
006d17c2 : ADD ESP,0x8
006d17c5 : JMP 0x006d185a
006d17ca : CMP dword ptr [EBP + 0x10],0x9
006d17ce : JZ 0x006d17f3
006d17d0 : PUSH 0xbeea3c
006d17d5 : MOV ECX,dword ptr [EBP + 0x8]
006d17d8 : PUSH ECX
006d17d9 : CALL 0x006c24c0
006d17de : ADD ESP,0x8
006d17e1 : MOV EDX,dword ptr [EBP + 0x10]
006d17e4 : PUSH EDX
006d17e5 : MOV EAX,dword ptr [EBP + 0x8]
006d17e8 : PUSH EAX
006d17e9 : CALL 0x006cf140
006d17ee : ADD ESP,0x8
006d17f1 : JMP 0x006d185a
006d17f3 : PUSH 0x9
006d17f5 : LEA ECX,[EBP + -0x18]
006d17f8 : PUSH ECX
006d17f9 : MOV EDX,dword ptr [EBP + 0x8]
006d17fc : PUSH EDX
006d17fd : CALL 0x006cf100
006d1802 : ADD ESP,0xc
006d1805 : PUSH 0x0
006d1807 : MOV EAX,dword ptr [EBP + 0x8]
006d180a : PUSH EAX
006d180b : CALL 0x006cf140
006d1810 : ADD ESP,0x8
006d1813 : TEST EAX,EAX
006d1815 : JZ 0x006d1819
006d1817 : JMP 0x006d185a
006d1819 : LEA ECX,[EBP + -0x18]
006d181c : PUSH ECX
006d181d : CALL 0x006cf090
006d1822 : ADD ESP,0x4
006d1825 : MOV dword ptr [EBP + -0x8],EAX
006d1828 : LEA EDX,[EBP + -0x14]
006d182b : PUSH EDX
006d182c : CALL 0x006cf090
006d1831 : ADD ESP,0x4
006d1834 : MOV dword ptr [EBP + -0x1c],EAX
006d1837 : MOVZX EAX,byte ptr [EBP + -0x10]
006d183b : MOV dword ptr [EBP + -0x4],EAX
006d183e : MOV ECX,dword ptr [EBP + -0x4]
006d1841 : PUSH ECX
006d1842 : MOV EDX,dword ptr [EBP + -0x1c]
006d1845 : PUSH EDX
006d1846 : MOV EAX,dword ptr [EBP + -0x8]
006d1849 : PUSH EAX
006d184a : MOV ECX,dword ptr [EBP + 0xc]
006d184d : PUSH ECX
006d184e : MOV EDX,dword ptr [EBP + 0x8]
006d1851 : PUSH EDX
006d1852 : CALL 0x006cdde0
006d1857 : ADD ESP,0x14
006d185a : MOV ECX,dword ptr [EBP + -0xc]
006d185d : XOR ECX,EBP
006d185f : CALL 0x00633e6b
006d1864 : MOV ESP,EBP
006d1866 : POP EBP
006d1867 : RET

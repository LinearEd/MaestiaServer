PROGRAM  : Maestia.exe
FUNCTION : FUN_00992980
ENTRY    : 00992980
BODY     : [[00992980, 00992f1f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00992980(void)

{
  byte bVar1;
  int *piVar2;
  int *piVar3;
  char cVar4;
  int iVar5;
  byte *pbVar6;
  int iVar7;
  undefined4 uVar8;
  int iVar9;
  int in_ECX;
  byte *pbVar10;
  uint uVar11;
  bool bVar12;
  undefined1 local_158 [28];
  uint local_13c;
  int local_138;
  DWORD local_134;
  undefined1 local_130 [28];
  undefined1 local_114 [256];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b2d54a;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(char *)(in_ECX + 8) == '\0') goto LAB_00992f04;
  iVar5 = *(int *)(*(int *)(in_ECX + 0x3c) + 0x14);
  if (((iVar5 < 0) ||
      (iVar5 = *(int *)(*(int *)(*(int *)(in_ECX + 0x3c) + 0x10) + iVar5 * 4), iVar5 == 0)) ||
     (piVar2 = *(int **)(iVar5 + 8), piVar2 == (int *)0x0)) goto LAB_00992f04;
  FUN_0097fa60(local_14);
  if ((uint)piVar2[4] >> 0x18 == 6) {
    iVar5 = FUN_004049b0(piVar2[4]);
    if (iVar5 == 0) goto LAB_00992f04;
    if (piVar2[10] == 0) {
      pbVar6 = &DAT_00c85408;
      local_114[0] = 0;
    }
    else {
      FUN_00992590(*(undefined4 *)(in_ECX + 4),*(undefined4 *)(piVar2[10] + 0x2c),local_114);
      piVar3 = *(int **)(*DAT_00da9894 + 0x114);
      local_134 = piVar2[4];
      iVar5 = *piVar3;
      cVar4 = (**(code **)(*piVar2 + 0x30))();
      pbVar6 = (byte *)(**(code **)(iVar5 + 4))
                                 (piVar3,"CheckAutoUseItem","%s,%d,%d",local_114,local_134,
                                  cVar4 != '\0');
    }
    pbVar10 = &DAT_00c85410;
    do {
      bVar1 = *pbVar6;
      bVar12 = bVar1 < *pbVar10;
      if (bVar1 != *pbVar10) {
LAB_00992ab1:
        iVar5 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
        goto LAB_00992ab6;
      }
      if (bVar1 == 0) break;
      bVar1 = pbVar6[1];
      bVar12 = bVar1 < pbVar10[1];
      if (bVar1 != pbVar10[1]) goto LAB_00992ab1;
      pbVar6 = pbVar6 + 2;
      pbVar10 = pbVar10 + 2;
    } while (bVar1 != 0);
    iVar5 = 0;
LAB_00992ab6:
    if (iVar5 != 0) {
      iVar5 = *DAT_00da9894;
      if ((iVar5 != 0) && (*(int *)(iVar5 + 0x114) != 0)) {
        piVar3 = *(int **)(iVar5 + 0x114);
        local_134 = (DWORD)*(ushort *)((int)piVar2 + 0x2e);
        local_13c = (uint)*(ushort *)(piVar2 + 0xb);
        local_138 = piVar2[4];
        iVar5 = *piVar3;
        cVar4 = (**(code **)(*piVar2 + 0x30))();
        (**(code **)(iVar5 + 4))
                  (piVar3,"OnAutoUseItem","%s,%d,%d,%d,%d",local_114,local_138,local_13c & 0xffff,
                   local_134 & 0xffff,cVar4 != '\0');
      }
      goto LAB_00992f04;
    }
  }
  iVar5 = piVar2[4];
  iVar7 = FUN_004049b0(iVar5);
  if (iVar7 == 0) {
LAB_00992c2c:
    if (((char)((uint)iVar5 >> 0x10) != 'I') || (*(char *)(DAT_00da93ec + 0x788) != '\x01')) {
      local_134 = timeGetTime();
      iVar5 = FUN_004049b0(piVar2[4]);
      if (((iVar5 != 0) && ((*(uint *)(iVar5 + 0x4c) & 0x200) != 0)) &&
         ((iVar5 = piVar2[9], iVar5 != 0 &&
          (iVar7 = *(int *)(iVar5 + 0xd8), iVar9 = FUN_009ea720(), local_134 < (uint)(iVar9 + iVar7)
          )))) {
        iVar5 = *(int *)(iVar5 + 0xd8);
        iVar7 = FUN_009ea720();
        uVar11 = (iVar7 + (iVar5 - local_134)) / 1000;
        if (uVar11 != 0) {
          FUN_00406460(L"IDS_ENABLE_RETAIN_ITEM");
          local_8 = 4;
          piVar2 = *(int **)(*DAT_00da9894 + 0x1a8);
          iVar5 = FUN_0081d120(local_158);
          local_8._0_1_ = 5;
          if (*(uint *)(iVar5 + 0x18) < 8) {
            iVar5 = iVar5 + 4;
          }
          else {
            iVar5 = *(int *)(iVar5 + 4);
          }
          uVar8 = FUN_00404750(iVar5,uVar11 / 0x3c + 1);
          local_8._0_1_ = 6;
          (**(code **)(*piVar2 + 0x44))(uVar8,3);
          local_8._0_1_ = 5;
          FUN_00406560();
          local_8 = CONCAT31(local_8._1_3_,4);
          goto LAB_00992bef;
        }
      }
      iVar5 = FUN_00703c00(0x600);
      if (iVar5 != 0) {
        local_138 = *(int *)(iVar5 + 0x170);
        iVar5 = piVar2[4];
        iVar7 = FUN_004049b0(iVar5);
        iVar5 = FUN_004049b0(iVar5);
        if (((iVar5 == 0) &&
            (((iVar7 == 0 || (*(int *)(iVar7 + 0x18c) == 0)) ||
             (*(short *)(*(int *)(iVar7 + 0x18c) + 4) != 0x72b)))) ||
           (((local_138 == 0 || (cVar4 = (**(code **)(*piVar2 + 0xa0))(), cVar4 != '\0')) ||
            (cVar4 = (**(code **)(*piVar2 + 0x30))(), cVar4 != '\0')))) {
          (**(code **)(*piVar2 + 0xb4))();
        }
        else {
          FUN_00406460(L"IDS_USE_LIMIT_TIME_LOOKCHANGE_ITEM_AND_VEHICLE_ITME_MSGBOX");
          local_8 = 7;
          FUN_0081d120(local_158);
          local_8 = CONCAT31(local_8._1_3_,9);
          FUN_00406560();
          iVar5 = FUN_008ede80(local_130,2);
          if (iVar5 != 0) {
            *(int **)(iVar5 + 0x6c) = piVar2;
            *(undefined4 *)(iVar5 + 0x70) = 1;
            if (*(code **)(iVar5 + 0x60) != (code *)0x0) {
              (**(code **)(iVar5 + 0x60))(1,iVar5);
            }
            *(code **)(iVar5 + 0x60) = FUN_00991c50;
          }
          local_8 = 0xffffffff;
          FUN_00406560();
        }
      }
      goto LAB_00992f04;
    }
    if (((DAT_0172491c == 0) || (*DAT_00da9894 == 0)) || (*(int *)(*DAT_00da9894 + 0x1a8) == 0))
    goto LAB_00992f04;
    FUN_00406460(L"IDS_MISMATCH_CHR_CLASS");
    local_8 = 2;
    piVar2 = *(int **)(*DAT_00da9894 + 0x1a8);
    uVar8 = FUN_0081d120(local_158);
    local_8._0_1_ = 3;
    (**(code **)(*piVar2 + 0x44))(uVar8,3);
    local_8 = CONCAT31(local_8._1_3_,2);
  }
  else {
    if (*(short *)(iVar7 + 0x180) != 0x2f) {
      if ((*(short *)(iVar7 + 0x180) == 0x1e) &&
         ((*(short *)(iVar7 + 0x182) == 1 || (*(short *)(iVar7 + 0x182) == 5)))) goto LAB_00992f04;
      goto LAB_00992c2c;
    }
    if (((DAT_0172491c == 0) || (*DAT_00da9894 == 0)) || (*(int *)(*DAT_00da9894 + 0x1a8) == 0))
    goto LAB_00992f04;
    FUN_00406460(L"IDS_MISMATCH_CHR_CLASS");
    local_8 = 0;
    piVar2 = *(int **)(*DAT_00da9894 + 0x1a8);
    uVar8 = FUN_0081d120(local_158);
    local_8._0_1_ = 1;
    (**(code **)(*piVar2 + 0x44))(uVar8,3);
    local_8 = (uint)local_8._1_3_ << 8;
  }
LAB_00992bef:
  FUN_00406560();
  local_8 = 0xffffffff;
  FUN_00406560();
LAB_00992f04:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00992980 : PUSH EBP
00992981 : MOV EBP,ESP
00992983 : PUSH -0x1
00992985 : PUSH 0xb2d54a
0099298a : MOV EAX,FS:[0x0]
00992990 : PUSH EAX
00992991 : SUB ESP,0x164
00992997 : MOV EAX,[0x00d66fa0]
0099299c : XOR EAX,EBP
0099299e : MOV dword ptr [EBP + -0x10],EAX
009929a1 : PUSH EBX
009929a2 : PUSH ESI
009929a3 : PUSH EDI
009929a4 : PUSH EAX
009929a5 : LEA EAX,[EBP + -0xc]
009929a8 : MOV FS:[0x0],EAX
009929ae : MOV ESI,ECX
009929b0 : MOV AL,byte ptr [ESI + 0x8]
009929b3 : TEST AL,AL
009929b5 : JZ 0x00992f04
009929bb : MOV EAX,dword ptr [ESI + 0x3c]
009929be : MOV ECX,dword ptr [EAX + 0x14]
009929c1 : TEST ECX,ECX
009929c3 : JL 0x00992f04
009929c9 : MOV EAX,dword ptr [EAX + 0x10]
009929cc : MOV ECX,dword ptr [EAX + ECX*0x4]
009929cf : TEST ECX,ECX
009929d1 : JZ 0x00992f04
009929d7 : MOV EBX,dword ptr [ECX + 0x8]
009929da : TEST EBX,EBX
009929dc : JZ 0x00992f04
009929e2 : MOV ECX,dword ptr [ESI + 0x4]
009929e5 : MOV ECX,dword ptr [ECX + 0x128]
009929eb : CALL 0x0097fa60
009929f0 : MOV EAX,dword ptr [EBX + 0x10]
009929f3 : SHR EAX,0x18
009929f6 : CMP EAX,0x6
009929f9 : JNZ 0x00992b49
009929ff : MOV EAX,dword ptr [EBX + 0x10]
00992a02 : PUSH EAX
00992a03 : CALL 0x004049b0
00992a08 : ADD ESP,0x4
00992a0b : TEST EAX,EAX
00992a0d : JZ 0x00992f04
00992a13 : MOV EAX,dword ptr [EBX + 0x28]
00992a16 : TEST EAX,EAX
00992a18 : JZ 0x00992a80
00992a1a : MOV EAX,dword ptr [EAX + 0x2c]
00992a1d : LEA EDX,[EBP + 0xfffffef0]
00992a23 : PUSH EDX
00992a24 : PUSH EAX
00992a25 : MOV EAX,dword ptr [ESI + 0x4]
00992a28 : PUSH EAX
00992a29 : CALL 0x00992590
00992a2e : MOV ECX,dword ptr [0x00da9894]
00992a34 : MOV EAX,dword ptr [ECX]
00992a36 : MOV EDI,dword ptr [EAX + 0x114]
00992a3c : MOV EDX,dword ptr [EBX + 0x10]
00992a3f : MOV EAX,dword ptr [EBX]
00992a41 : MOV ESI,dword ptr [EDI]
00992a43 : MOV dword ptr [EBP + 0xfffffed0],EDX
00992a49 : MOV EDX,dword ptr [EAX + 0x30]
00992a4c : ADD ESP,0xc
00992a4f : MOV ECX,EBX
00992a51 : ADD ESI,0x4
00992a54 : CALL EDX
00992a56 : MOV EDX,dword ptr [EBP + 0xfffffed0]
00992a5c : XOR ECX,ECX
00992a5e : TEST AL,AL
00992a60 : SETNZ CL
00992a63 : LEA EAX,[EBP + 0xfffffef0]
00992a69 : PUSH ECX
00992a6a : MOV ECX,dword ptr [ESI]
00992a6c : PUSH EDX
00992a6d : PUSH EAX
00992a6e : PUSH 0xc853e8
00992a73 : PUSH 0xc853f4
00992a78 : PUSH EDI
00992a79 : CALL ECX
00992a7b : ADD ESP,0x18
00992a7e : JMP 0x00992a8c
00992a80 : MOV EAX,0xc85408
00992a85 : MOV byte ptr [EBP + 0xfffffef0],0x0
00992a8c : MOV ESI,0xc85410
00992a91 : MOV CL,byte ptr [EAX]
00992a93 : CMP CL,byte ptr [ESI]
00992a95 : JNZ 0x00992ab1
00992a97 : TEST CL,CL
00992a99 : JZ 0x00992aad
00992a9b : MOV CL,byte ptr [EAX + 0x1]
00992a9e : CMP CL,byte ptr [ESI + 0x1]
00992aa1 : JNZ 0x00992ab1
00992aa3 : ADD EAX,0x2
00992aa6 : ADD ESI,0x2
00992aa9 : TEST CL,CL
00992aab : JNZ 0x00992a91
00992aad : XOR EAX,EAX
00992aaf : JMP 0x00992ab6
00992ab1 : SBB EAX,EAX
00992ab3 : SBB EAX,-0x1
00992ab6 : TEST EAX,EAX
00992ab8 : JZ 0x00992b49
00992abe : MOV EDX,dword ptr [0x00da9894]
00992ac4 : MOV EAX,dword ptr [EDX]
00992ac6 : TEST EAX,EAX
00992ac8 : JZ 0x00992f04
00992ace : CMP dword ptr [EAX + 0x114],0x0
00992ad5 : JZ 0x00992f04
00992adb : MOV EDI,dword ptr [EAX + 0x114]
00992ae1 : MOVZX EAX,word ptr [EBX + 0x2e]
00992ae5 : MOVZX ECX,word ptr [EBX + 0x2c]
00992ae9 : MOV EDX,dword ptr [EBX + 0x10]
00992aec : MOV ESI,dword ptr [EDI]
00992aee : MOV dword ptr [EBP + 0xfffffed0],EAX
00992af4 : MOV EAX,dword ptr [EBX]
00992af6 : MOV dword ptr [EBP + 0xfffffec8],ECX
00992afc : MOV dword ptr [EBP + 0xfffffecc],EDX
00992b02 : MOV EDX,dword ptr [EAX + 0x30]
00992b05 : MOV ECX,EBX
00992b07 : ADD ESI,0x4
00992b0a : CALL EDX
00992b0c : MOVZX EDX,word ptr [EBP + 0xfffffed0]
00992b13 : XOR ECX,ECX
00992b15 : TEST AL,AL
00992b17 : MOVZX EAX,word ptr [EBP + 0xfffffec8]
00992b1e : SETNZ CL
00992b21 : PUSH ECX
00992b22 : MOV ECX,dword ptr [EBP + 0xfffffecc]
00992b28 : PUSH EDX
00992b29 : PUSH EAX
00992b2a : MOV EAX,dword ptr [ESI]
00992b2c : PUSH ECX
00992b2d : LEA EDX,[EBP + 0xfffffef0]
00992b33 : PUSH EDX
00992b34 : PUSH 0xc85418
00992b39 : PUSH 0xc85428
00992b3e : PUSH EDI
00992b3f : CALL EAX
00992b41 : ADD ESP,0x20
00992b44 : JMP 0x00992f04
00992b49 : MOV ESI,dword ptr [EBX + 0x10]
00992b4c : PUSH ESI
00992b4d : CALL 0x004049b0
00992b52 : ADD ESP,0x4
00992b55 : TEST EAX,EAX
00992b57 : JZ 0x00992c2c
00992b5d : MOVZX ECX,word ptr [EAX + 0x180]
00992b64 : CMP CX,0x2f
00992b68 : JNZ 0x00992c0b
00992b6e : CMP dword ptr [0x0172491c],0x0
00992b75 : JZ 0x00992f04
00992b7b : MOV ECX,dword ptr [0x00da9894]
00992b81 : MOV EAX,dword ptr [ECX]
00992b83 : TEST EAX,EAX
00992b85 : JZ 0x00992f04
00992b8b : CMP dword ptr [EAX + 0x1a8],0x0
00992b92 : JZ 0x00992f04
00992b98 : PUSH 0xc85438
00992b9d : LEA ECX,[EBP + 0xfffffeac]
00992ba3 : CALL 0x00406460
00992ba8 : MOV dword ptr [EBP + -0x4],0x0
00992baf : MOV EDX,dword ptr [0x00da9894]
00992bb5 : MOV EAX,dword ptr [EDX]
00992bb7 : MOV ESI,dword ptr [EAX + 0x1a8]
00992bbd : MOV ECX,dword ptr [0x0172491c]
00992bc3 : LEA EAX,[EBP + 0xfffffeac]
00992bc9 : PUSH EAX
00992bca : LEA EDI,[EBP + 0xfffffed4]
00992bd0 : CALL 0x0081d120
00992bd5 : MOV byte ptr [EBP + -0x4],0x1
00992bd9 : MOV EDX,dword ptr [ESI]
00992bdb : PUSH 0x3
00992bdd : PUSH EAX
00992bde : MOV EAX,dword ptr [EDX + 0x44]
00992be1 : MOV ECX,ESI
00992be3 : CALL EAX
00992be5 : MOV byte ptr [EBP + -0x4],0x0
00992be9 : LEA ECX,[EBP + 0xfffffed4]
00992bef : CALL 0x00406560
00992bf4 : MOV dword ptr [EBP + -0x4],0xffffffff
00992bfb : LEA ECX,[EBP + 0xfffffeac]
00992c01 : CALL 0x00406560
00992c06 : JMP 0x00992f04
00992c0b : CMP CX,0x1e
00992c0f : JNZ 0x00992c2c
00992c11 : MOVZX EAX,word ptr [EAX + 0x182]
00992c18 : CMP AX,0x1
00992c1c : JZ 0x00992f04
00992c22 : CMP AX,0x5
00992c26 : JZ 0x00992f04
00992c2c : MOV EAX,ESI
00992c2e : SHR EAX,0x10
00992c31 : CMP AL,0x49
00992c33 : JNZ 0x00992cc7
00992c39 : MOV ECX,dword ptr [0x00da93ec]
00992c3f : CMP byte ptr [ECX + 0x788],0x1
00992c46 : JNZ 0x00992cc7
00992c48 : CMP dword ptr [0x0172491c],0x0
00992c4f : JZ 0x00992f04
00992c55 : MOV EDX,dword ptr [0x00da9894]
00992c5b : MOV EAX,dword ptr [EDX]
00992c5d : TEST EAX,EAX
00992c5f : JZ 0x00992f04
00992c65 : CMP dword ptr [EAX + 0x1a8],0x0
00992c6c : JZ 0x00992f04
00992c72 : PUSH 0xc85468
00992c77 : LEA ECX,[EBP + 0xfffffeac]
00992c7d : CALL 0x00406460
00992c82 : MOV dword ptr [EBP + -0x4],0x2
00992c89 : MOV EAX,[0x00da9894]
00992c8e : MOV EAX,dword ptr [EAX]
00992c90 : MOV ESI,dword ptr [EAX + 0x1a8]
00992c96 : LEA ECX,[EBP + 0xfffffeac]
00992c9c : PUSH ECX
00992c9d : MOV ECX,dword ptr [0x0172491c]
00992ca3 : LEA EDI,[EBP + 0xfffffed4]
00992ca9 : CALL 0x0081d120
00992cae : MOV byte ptr [EBP + -0x4],0x3
00992cb2 : MOV EDX,dword ptr [ESI]
00992cb4 : PUSH 0x3
00992cb6 : PUSH EAX
00992cb7 : MOV EAX,dword ptr [EDX + 0x44]
00992cba : MOV ECX,ESI
00992cbc : CALL EAX
00992cbe : MOV byte ptr [EBP + -0x4],0x2
00992cc2 : JMP 0x00992be9
00992cc7 : CALL dword ptr [0x00b85598]
00992ccd : MOV dword ptr [EBP + 0xfffffed0],EAX
00992cd3 : MOV EAX,dword ptr [EBX + 0x10]
00992cd6 : PUSH EAX
00992cd7 : CALL 0x004049b0
00992cdc : ADD ESP,0x4
00992cdf : TEST EAX,EAX
00992ce1 : JZ 0x00992ddb
00992ce7 : MOV ECX,dword ptr [EAX + 0x4c]
00992cea : AND ECX,0x200
00992cf0 : XOR EAX,EAX
00992cf2 : OR EAX,ECX
00992cf4 : JZ 0x00992ddb
00992cfa : MOV ESI,dword ptr [EBX + 0x24]
00992cfd : TEST ESI,ESI
00992cff : JZ 0x00992ddb
00992d05 : MOV EDI,dword ptr [ESI + 0xd8]
00992d0b : CALL 0x009ea720
00992d10 : ADD EAX,EDI
00992d12 : CMP EAX,dword ptr [EBP + 0xfffffed0]
00992d18 : JBE 0x00992ddb
00992d1e : MOV EDI,dword ptr [ESI + 0xd8]
00992d24 : CALL 0x009ea720
00992d29 : SUB EDI,dword ptr [EBP + 0xfffffed0]
00992d2f : MOV ECX,EAX
00992d31 : ADD ECX,EDI
00992d33 : MOV EAX,0x10624dd3
00992d38 : MUL ECX
00992d3a : MOV ESI,EDX
00992d3c : SHR ESI,0x6
00992d3f : TEST ESI,ESI
00992d41 : JBE 0x00992ddb
00992d47 : PUSH 0xc85498
00992d4c : LEA ECX,[EBP + 0xfffffeac]
00992d52 : CALL 0x00406460
00992d57 : MOV dword ptr [EBP + -0x4],0x4
00992d5e : MOV EDX,dword ptr [0x00da9894]
00992d64 : MOV EAX,dword ptr [EDX]
00992d66 : MOV EBX,dword ptr [EAX + 0x1a8]
00992d6c : MOV ECX,dword ptr [0x0172491c]
00992d72 : LEA EAX,[EBP + 0xfffffeac]
00992d78 : PUSH EAX
00992d79 : LEA EDI,[EBP + 0xfffffe90]
00992d7f : CALL 0x0081d120
00992d84 : MOV byte ptr [EBP + -0x4],0x5
00992d88 : CMP dword ptr [EAX + 0x18],0x8
00992d8c : JC 0x00992d93
00992d8e : MOV ECX,dword ptr [EAX + 0x4]
00992d91 : JMP 0x00992d96
00992d93 : LEA ECX,[EAX + 0x4]
00992d96 : MOV EAX,0x88888889
00992d9b : MUL ESI
00992d9d : SHR EDX,0x5
00992da0 : INC EDX
00992da1 : PUSH EDX
00992da2 : PUSH ECX
00992da3 : LEA ESI,[EBP + 0xfffffed4]
00992da9 : CALL 0x00404750
00992dae : ADD ESP,0x8
00992db1 : MOV byte ptr [EBP + -0x4],0x6
00992db5 : MOV EDX,dword ptr [EBX]
00992db7 : PUSH 0x3
00992db9 : PUSH EAX
00992dba : MOV EAX,dword ptr [EDX + 0x44]
00992dbd : MOV ECX,EBX
00992dbf : CALL EAX
00992dc1 : MOV byte ptr [EBP + -0x4],0x5
00992dc5 : MOV ECX,ESI
00992dc7 : CALL 0x00406560
00992dcc : MOV byte ptr [EBP + -0x4],0x4
00992dd0 : LEA ECX,[EBP + 0xfffffe90]
00992dd6 : JMP 0x00992bef
00992ddb : MOV EDI,dword ptr [EBX + 0x10]
00992dde : PUSH 0x600
00992de3 : CALL 0x00703c00
00992de8 : ADD ESP,0x4
00992deb : TEST EAX,EAX
00992ded : JZ 0x00992f04
00992df3 : MOV ECX,dword ptr [EAX + 0x170]
00992df9 : MOV ESI,dword ptr [EBX + 0x10]
00992dfc : PUSH ESI
00992dfd : MOV dword ptr [EBP + 0xfffffecc],ECX
00992e03 : CALL 0x004049b0
00992e08 : ADD ESP,0x4
00992e0b : PUSH ESI
00992e0c : MOV EDI,EAX
00992e0e : CALL 0x004049b0
00992e13 : ADD ESP,0x4
00992e16 : TEST EAX,EAX
00992e18 : JNZ 0x00992e3f
00992e1a : TEST EDI,EDI
00992e1c : JZ 0x00992ef8
00992e22 : MOV EDI,dword ptr [EDI + 0x18c]
00992e28 : TEST EDI,EDI
00992e2a : JZ 0x00992ef8
00992e30 : MOV EDX,0x72b
00992e35 : CMP word ptr [EDI + 0x4],DX
00992e39 : JNZ 0x00992ef8
00992e3f : CMP dword ptr [EBP + 0xfffffecc],0x0
00992e46 : JZ 0x00992ef8
00992e4c : MOV EAX,dword ptr [EBX]
00992e4e : MOV EDX,dword ptr [EAX + 0xa0]
00992e54 : MOV ECX,EBX
00992e56 : CALL EDX
00992e58 : TEST AL,AL
00992e5a : JNZ 0x00992ef8
00992e60 : MOV EAX,dword ptr [EBX]
00992e62 : MOV EDX,dword ptr [EAX + 0x30]
00992e65 : MOV ECX,EBX
00992e67 : CALL EDX
00992e69 : TEST AL,AL
00992e6b : JNZ 0x00992ef8
00992e71 : PUSH 0xc854c8
00992e76 : LEA ECX,[EBP + 0xfffffeac]
00992e7c : CALL 0x00406460
00992e81 : MOV dword ptr [EBP + -0x4],0x7
00992e88 : MOV ECX,dword ptr [0x0172491c]
00992e8e : LEA EAX,[EBP + 0xfffffeac]
00992e94 : PUSH EAX
00992e95 : LEA EDI,[EBP + 0xfffffed4]
00992e9b : CALL 0x0081d120
00992ea0 : MOV byte ptr [EBP + -0x4],0x9
00992ea4 : LEA ECX,[EBP + 0xfffffeac]
00992eaa : CALL 0x00406560
00992eaf : MOV ECX,dword ptr [0x00da9894]
00992eb5 : MOV ECX,dword ptr [ECX]
00992eb7 : PUSH 0x2
00992eb9 : MOV EDX,EDI
00992ebb : PUSH EDX
00992ebc : CALL 0x008ede80
00992ec1 : MOV ESI,EAX
00992ec3 : TEST ESI,ESI
00992ec5 : JZ 0x00992ee4
00992ec7 : MOV EAX,dword ptr [ESI + 0x60]
00992eca : MOV dword ptr [ESI + 0x6c],EBX
00992ecd : MOV dword ptr [ESI + 0x70],0x1
00992ed4 : TEST EAX,EAX
00992ed6 : JZ 0x00992edd
00992ed8 : PUSH ESI
00992ed9 : PUSH 0x1
00992edb : CALL EAX
00992edd : MOV dword ptr [ESI + 0x60],0x991c50
00992ee4 : MOV dword ptr [EBP + -0x4],0xffffffff
00992eeb : LEA ECX,[EBP + 0xfffffed4]
00992ef1 : CALL 0x00406560
00992ef6 : JMP 0x00992f04
00992ef8 : MOV EAX,dword ptr [EBX]
00992efa : MOV EDX,dword ptr [EAX + 0xb4]
00992f00 : MOV ECX,EBX
00992f02 : CALL EDX
00992f04 : MOV ECX,dword ptr [EBP + -0xc]
00992f07 : MOV dword ptr FS:[0x0],ECX
00992f0e : POP ECX
00992f0f : POP EDI
00992f10 : POP ESI
00992f11 : POP EBX
00992f12 : MOV ECX,dword ptr [EBP + -0x10]
00992f15 : XOR ECX,EBP
00992f17 : CALL 0x00633e6b
00992f1c : MOV ESP,EBP
00992f1e : POP EBP
00992f1f : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_009c2ab0
ENTRY    : 009c2ab0
BODY     : [[009c2ab0, 009c2b5d]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_009c2ab0(undefined4 *param_1)

{
  char cVar1;
  uint uVar2;
  char *pcVar3;
  char *in_ECX;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b220d3;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = &PTR_LAB_00ccc5f0;
  _eh_vector_constructor_iterator_(param_1 + 0x10c,0x2c,0x1a,FUN_0041dc20,FUN_0041da30);
  local_8 = 0;
  FUN_009c1dc0(uVar2);
  pcVar3 = in_ECX;
  do {
    cVar1 = *pcVar3;
    pcVar3 = pcVar3 + 1;
  } while (cVar1 != '\0');
  if ((uint)((int)pcVar3 - (int)(in_ECX + 1)) < 0x41) {
    _strcpy_s((char *)(param_1 + 2),0x40,in_ECX);
  }
  else {
    FUN_008018d0(L"Buffer Over Run !! AvaGuiCharacterBase::AvaGuiCharacterBase %s");
  }
  ExceptionList = local_10;
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
009c2ab0 : PUSH EBP
009c2ab1 : MOV EBP,ESP
009c2ab3 : PUSH -0x1
009c2ab5 : PUSH 0xb220d3
009c2aba : MOV EAX,FS:[0x0]
009c2ac0 : PUSH EAX
009c2ac1 : PUSH ESI
009c2ac2 : PUSH EDI
009c2ac3 : MOV EAX,[0x00d66fa0]
009c2ac8 : XOR EAX,EBP
009c2aca : PUSH EAX
009c2acb : LEA EAX,[EBP + -0xc]
009c2ace : MOV FS:[0x0],EAX
009c2ad4 : MOV ESI,ECX
009c2ad6 : MOV EDI,dword ptr [EBP + 0x8]
009c2ad9 : PUSH 0x41da30
009c2ade : PUSH 0x41dc20
009c2ae3 : PUSH 0x1a
009c2ae5 : PUSH 0x2c
009c2ae7 : LEA EAX,[EDI + 0x430]
009c2aed : PUSH EAX
009c2aee : MOV dword ptr [EDI],0xccc5f0
009c2af4 : CALL 0x0063619b
009c2af9 : MOV dword ptr [EBP + -0x4],0x0
009c2b00 : MOV ECX,EDI
009c2b02 : CALL 0x009c1dc0
009c2b07 : MOV EAX,ESI
009c2b09 : LEA EDX,[EAX + 0x1]
009c2b0c : LEA ESP,[ESP]
009c2b10 : MOV CL,byte ptr [EAX]
009c2b12 : INC EAX
009c2b13 : TEST CL,CL
009c2b15 : JNZ 0x009c2b10
009c2b17 : SUB EAX,EDX
009c2b19 : PUSH ESI
009c2b1a : CMP EAX,0x40
009c2b1d : JBE 0x009c2b34
009c2b1f : MOV ESI,dword ptr [0x00da98e8]
009c2b25 : PUSH 0xc8fa88
009c2b2a : CALL 0x008018d0
009c2b2f : ADD ESP,0x8
009c2b32 : JMP 0x009c2b42
009c2b34 : LEA EAX,[EDI + 0x8]
009c2b37 : PUSH 0x40
009c2b39 : PUSH EAX
009c2b3a : CALL 0x00638300
009c2b3f : ADD ESP,0xc
009c2b42 : MOV dword ptr [EBP + -0x4],0xffffffff
009c2b49 : MOV EAX,EDI
009c2b4b : MOV ECX,dword ptr [EBP + -0xc]
009c2b4e : MOV dword ptr FS:[0x0],ECX
009c2b55 : POP ECX
009c2b56 : POP EDI
009c2b57 : POP ESI
009c2b58 : MOV ESP,EBP
009c2b5a : POP EBP
009c2b5b : RET 0x4

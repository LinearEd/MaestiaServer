PROGRAM  : Maestia.exe
FUNCTION : FUN_005e5a70
ENTRY    : 005e5a70
BODY     : [[005e5a70, 005e5afe]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_005e5a70(undefined4 *param_1,int param_2)

{
  byte bVar1;
  int iVar2;
  int iVar3;
  int *in_ECX;
  byte *pbVar4;
  int iVar5;
  byte *pbVar6;
  int *piVar7;
  bool bVar8;
  
  iVar2 = *in_ECX;
  piVar7 = (int *)(iVar2 + 8 + param_2 * 0x18);
  if ((*(int *)(iVar2 + 8 + param_2 * 0x18) == -2) || (iVar3 = param_2, piVar7[1] != param_2)) {
    return -1;
  }
  do {
    if (piVar7[1] == param_2) {
      pbVar6 = (byte *)((*(uint *)*param_1 & 0xfffffffc) + 8);
      pbVar4 = (byte *)((piVar7[2] & 0xfffffffcU) + 8);
      do {
        bVar1 = *pbVar4;
        bVar8 = bVar1 < *pbVar6;
        if (bVar1 != *pbVar6) {
LAB_005e5ad0:
          iVar5 = (1 - (uint)bVar8) - (uint)(bVar8 != 0);
          goto LAB_005e5ad5;
        }
        if (bVar1 == 0) break;
        bVar1 = pbVar4[1];
        bVar8 = bVar1 < pbVar6[1];
        if (bVar1 != pbVar6[1]) goto LAB_005e5ad0;
        pbVar4 = pbVar4 + 2;
        pbVar6 = pbVar6 + 2;
      } while (bVar1 != 0);
      iVar5 = 0;
LAB_005e5ad5:
      if (iVar5 == 0) {
        return iVar3;
      }
    }
    iVar3 = *piVar7;
    if (iVar3 == -1) {
      return -1;
    }
    piVar7 = (int *)(iVar2 + 8 + iVar3 * 0x18);
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
005e5a70 : MOV ECX,dword ptr [ECX]
005e5a72 : PUSH ESI
005e5a73 : PUSH EDI
005e5a74 : MOV EDI,dword ptr [ESP + 0x10]
005e5a78 : LEA EDX,[EDI + EDI*0x2]
005e5a7b : CMP dword ptr [ECX + EDX*0x8 + 0x8],-0x2
005e5a80 : LEA ESI,[ECX + EDX*0x8 + 0x8]
005e5a84 : MOV EAX,EDI
005e5a86 : MOV dword ptr [ESP + 0x10],ECX
005e5a8a : JZ 0x005e5af7
005e5a8c : CMP dword ptr [ESI + 0x4],EDI
005e5a8f : JNZ 0x005e5af7
005e5a91 : PUSH EBP
005e5a92 : MOV EBP,dword ptr [ESP + 0x10]
005e5a96 : PUSH EBX
005e5a97 : CMP dword ptr [ESI + 0x4],EDI
005e5a9a : JNZ 0x005e5add
005e5a9c : MOV ECX,dword ptr [EBP]
005e5a9f : MOV EDX,dword ptr [ECX]
005e5aa1 : MOV ECX,dword ptr [ESI + 0x8]
005e5aa4 : AND EDX,0xfffffffc
005e5aa7 : AND ECX,0xfffffffc
005e5aaa : ADD EDX,0x8
005e5aad : ADD ECX,0x8
005e5ab0 : MOV BL,byte ptr [ECX]
005e5ab2 : CMP BL,byte ptr [EDX]
005e5ab4 : JNZ 0x005e5ad0
005e5ab6 : TEST BL,BL
005e5ab8 : JZ 0x005e5acc
005e5aba : MOV BL,byte ptr [ECX + 0x1]
005e5abd : CMP BL,byte ptr [EDX + 0x1]
005e5ac0 : JNZ 0x005e5ad0
005e5ac2 : ADD ECX,0x2
005e5ac5 : ADD EDX,0x2
005e5ac8 : TEST BL,BL
005e5aca : JNZ 0x005e5ab0
005e5acc : XOR ECX,ECX
005e5ace : JMP 0x005e5ad5
005e5ad0 : SBB ECX,ECX
005e5ad2 : SBB ECX,-0x1
005e5ad5 : TEST ECX,ECX
005e5ad7 : JZ 0x005e5af0
005e5ad9 : MOV ECX,dword ptr [ESP + 0x18]
005e5add : MOV EAX,dword ptr [ESI]
005e5adf : CMP EAX,-0x1
005e5ae2 : JZ 0x005e5aed
005e5ae4 : LEA EDX,[EAX + EAX*0x2]
005e5ae7 : LEA ESI,[ECX + EDX*0x8 + 0x8]
005e5aeb : JMP 0x005e5a97
005e5aed : OR EAX,0xffffffff
005e5af0 : POP EBX
005e5af1 : POP EBP
005e5af2 : POP EDI
005e5af3 : POP ESI
005e5af4 : RET 0x8
005e5af7 : POP EDI
005e5af8 : OR EAX,0xffffffff
005e5afb : POP ESI
005e5afc : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_00693f20
ENTRY    : 00693f20
BODY     : [[00693f20, 00693fc8] [00693fd0, 006941b8] [006941c0, 00694271]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00693f20(int param_1,int param_2)

{
  undefined1 *puVar1;
  undefined1 *puVar2;
  undefined1 *puVar3;
  int iVar4;
  undefined1 uVar5;
  undefined1 uVar6;
  undefined1 *puVar7;
  undefined1 *puVar8;
  uint uVar9;
  undefined1 *puVar10;
  undefined1 *puVar11;
  uint uVar12;
  undefined1 *puVar13;
  undefined1 *puVar14;
  int iVar15;
  uint uVar16;
  int iVar17;
  uint uVar18;
  int iVar19;
  uint local_28;
  uint local_24;
  uint uStack_20;
  
  puVar11 = (undefined1 *)(param_1 + 6);
  puVar14 = (undefined1 *)(param_1 + 7);
  puVar8 = (undefined1 *)(param_1 + 8);
  uVar9 = CONCAT31(CONCAT21(CONCAT11(*(undefined1 *)(param_1 + 2),*(undefined1 *)(param_1 + 3)),
                            *(undefined1 *)(param_1 + 4)),*(undefined1 *)(param_1 + 5));
  puVar7 = (undefined1 *)(param_1 + 9);
  iVar15 = CONCAT31(CONCAT21(CONCAT11(*puVar11,*puVar14),*puVar8),*puVar7);
  if ((*(uint *)(param_2 + 4) < param_1 + uVar9) || (uVar9 < iVar15 * 0xb + 10U)) {
    FUN_00686490(param_2,8);
  }
  local_24 = 1;
  for (; iVar15 != 0; iVar15 = iVar15 + -1) {
    puVar10 = puVar11 + 7;
    uVar18 = (uint)CONCAT21(CONCAT11(puVar14[3],puVar8[3]),puVar7[3]);
    puVar11 = puVar11 + 0xb;
    uVar16 = CONCAT31(CONCAT21(CONCAT11(*puVar10,puVar14[7]),puVar8[7]),puVar7[7]);
    puVar14 = puVar14 + 0xb;
    puVar8 = puVar8 + 0xb;
    puVar7 = puVar7 + 0xb;
    uVar12 = CONCAT31(CONCAT21(CONCAT11(*puVar11,*puVar14),*puVar8),*puVar7);
    if ((uVar9 <= uVar16) || (uVar9 <= uVar12)) {
      FUN_00686490(param_2,8);
    }
    if (uVar18 < local_24) {
      FUN_00686490(param_2,8);
    }
    local_24 = uVar18 + 1;
    if (uVar16 != 0) {
      puVar10 = (undefined1 *)(uVar16 + 4 + param_1);
      iVar19 = CONCAT31(CONCAT21(CONCAT11(*(undefined1 *)(uVar16 + param_1),
                                          *(undefined1 *)(uVar16 + 1 + param_1)),
                                 *(undefined1 *)(uVar16 + 2 + param_1)),puVar10[-1]);
      local_28 = 0;
      if (*(undefined1 **)(param_2 + 4) < puVar10 + iVar19 * 4) {
        FUN_00686490(param_2,8);
      }
      for (; iVar19 != 0; iVar19 = iVar19 + -1) {
        uVar18 = (uint)CONCAT21(CONCAT11(*puVar10,puVar10[1]),puVar10[2]);
        uVar16 = (byte)puVar10[3] + uVar18;
        puVar10 = puVar10 + 4;
        if (0x10ffff < uVar16) {
          FUN_00686490(param_2,8);
        }
        if (uVar18 < local_28) {
          FUN_00686490(param_2,8);
        }
        local_28 = uVar16 + 1;
      }
    }
    if (uVar12 != 0) {
      iVar4 = uVar12 + 4 + param_1;
      puVar10 = (undefined1 *)(iVar4 + -3);
      iVar19 = iVar4 + -2;
      puVar13 = (undefined1 *)(iVar4 + -1);
      iVar17 = CONCAT31(CONCAT21(CONCAT11(*(undefined1 *)(uVar12 + param_1),*puVar10),
                                 *(undefined1 *)(iVar4 + -2)),*(undefined1 *)(iVar4 + -1));
      uStack_20 = 0;
      if (*(uint *)(param_2 + 4) < (uint)(iVar4 + iVar17 * 4)) {
        FUN_00686490(param_2,8);
      }
      for (; iVar17 != 0; iVar17 = iVar17 + -1) {
        puVar1 = puVar10 + 3;
        puVar2 = (undefined1 *)(iVar19 + 3);
        puVar3 = puVar13 + 3;
        uVar5 = *(undefined1 *)(iVar19 + 5);
        iVar19 = iVar19 + 5;
        puVar10 = puVar10 + 5;
        puVar13 = puVar13 + 5;
        uVar6 = *puVar13;
        uVar12 = (uint)CONCAT21(CONCAT11(*puVar1,*puVar2),*puVar3);
        if (0x10ffff < uVar12) {
          FUN_00686490(param_2,8);
        }
        if (uVar12 < uStack_20) {
          FUN_00686490(param_2,8);
        }
        uStack_20 = uVar12 + 1;
        if ((0 < *(int *)(param_2 + 8)) &&
           (*(uint *)(param_2 + 0x50) <= (uint)CONCAT11(uVar5,uVar6))) {
          FUN_00686490(param_2,0x10);
        }
      }
    }
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00693f20 : SUB ESP,0x28
00693f23 : MOV EDX,dword ptr [ESP + 0x2c]
00693f27 : MOVZX ECX,byte ptr [EDX + 0x2]
00693f2b : LEA EAX,[EDX + 0x6]
00693f2e : PUSH EBX
00693f2f : PUSH EBP
00693f30 : PUSH ESI
00693f31 : MOVZX ESI,byte ptr [EAX + -0x3]
00693f35 : SHL ECX,0x8
00693f38 : OR ECX,ESI
00693f3a : MOVZX ESI,byte ptr [EAX + -0x2]
00693f3e : ADD EAX,0x4
00693f41 : SHL ECX,0x8
00693f44 : OR ECX,ESI
00693f46 : MOVZX ESI,byte ptr [EAX + -0x5]
00693f4a : LEA EBP,[EAX + -0x3]
00693f4d : LEA EBX,[EAX + -0x2]
00693f50 : SHL ECX,0x8
00693f53 : OR ECX,ESI
00693f55 : MOVZX ESI,byte ptr [EAX + -0x4]
00693f59 : PUSH EDI
00693f5a : LEA EDI,[EAX + -0x4]
00693f5d : DEC EAX
00693f5e : MOV dword ptr [ESP + 0x10],EAX
00693f62 : MOVZX EAX,byte ptr [EBP]
00693f66 : SHL ESI,0x8
00693f69 : OR ESI,EAX
00693f6b : MOVZX EAX,byte ptr [EBX]
00693f6e : SHL ESI,0x8
00693f71 : OR ESI,EAX
00693f73 : MOV EAX,dword ptr [ESP + 0x10]
00693f77 : MOVZX EAX,byte ptr [EAX]
00693f7a : SHL ESI,0x8
00693f7d : OR ESI,EAX
00693f7f : MOV EAX,dword ptr [ESP + 0x40]
00693f83 : MOV EAX,dword ptr [EAX + 0x4]
00693f86 : ADD EDX,ECX
00693f88 : MOV dword ptr [ESP + 0x30],ECX
00693f8c : CMP EDX,EAX
00693f8e : JA 0x00693f9c
00693f90 : MOV EDX,ESI
00693f92 : IMUL EDX,EDX,0xb
00693f95 : ADD EDX,0xa
00693f98 : CMP ECX,EDX
00693f9a : JNC 0x00693fab
00693f9c : MOV EAX,dword ptr [ESP + 0x40]
00693fa0 : PUSH 0x8
00693fa2 : PUSH EAX
00693fa3 : CALL 0x00686490
00693fa8 : ADD ESP,0x8
00693fab : MOV dword ptr [ESP + 0x14],0x1
00693fb3 : TEST ESI,ESI
00693fb5 : JBE 0x00694268
00693fbb : MOV ECX,dword ptr [ESP + 0x10]
00693fbf : MOV EAX,EBX
00693fc1 : MOV EDX,EDI
00693fc3 : MOV dword ptr [ESP + 0x20],ESI
00693fc7 : JMP 0x00693fdc
00693fd0 : MOV EAX,dword ptr [ESP + 0x28]
00693fd4 : MOV ECX,dword ptr [ESP + 0x2c]
00693fd8 : MOV EDX,dword ptr [ESP + 0x24]
00693fdc : MOVZX ESI,byte ptr [EAX + 0x3]
00693fe0 : MOVZX EDI,byte ptr [EBP + 0x3]
00693fe4 : ADD EBP,0x3
00693fe7 : MOVZX EBX,byte ptr [EBP + 0x4]
00693feb : ADD EAX,0x3
00693fee : ADD ECX,0x3
00693ff1 : SHL EDI,0x8
00693ff4 : OR EDI,ESI
00693ff6 : MOVZX ESI,byte ptr [ECX]
00693ff9 : ADD EDX,0x3
00693ffc : ADD EDX,0x4
00693fff : SHL EDI,0x8
00694002 : OR EDI,ESI
00694004 : MOVZX ESI,byte ptr [EDX]
00694007 : ADD EBP,0x4
0069400a : SHL ESI,0x8
0069400d : OR ESI,EBX
0069400f : MOVZX EBX,byte ptr [EAX + 0x4]
00694013 : ADD EAX,0x4
00694016 : SHL ESI,0x8
00694019 : OR ESI,EBX
0069401b : MOVZX EBX,byte ptr [ECX + 0x4]
0069401f : ADD ECX,0x4
00694022 : ADD EDX,0x4
00694025 : SHL ESI,0x8
00694028 : OR ESI,EBX
0069402a : MOVZX EBX,byte ptr [EDX]
0069402d : ADD EBP,0x4
00694030 : SHL EBX,0x8
00694033 : ADD EAX,0x4
00694036 : MOV dword ptr [ESP + 0x24],EDX
0069403a : MOVZX EDX,byte ptr [EBP]
0069403e : OR EBX,EDX
00694040 : MOV dword ptr [ESP + 0x28],EAX
00694044 : MOVZX EAX,byte ptr [EAX]
00694047 : ADD ECX,0x4
0069404a : SHL EBX,0x8
0069404d : OR EBX,EAX
0069404f : MOV EAX,dword ptr [ESP + 0x30]
00694053 : MOV dword ptr [ESP + 0x2c],ECX
00694057 : MOVZX ECX,byte ptr [ECX]
0069405a : SHL EBX,0x8
0069405d : OR EBX,ECX
0069405f : MOV dword ptr [ESP + 0x1c],EBP
00694063 : CMP ESI,EAX
00694065 : JNC 0x0069406b
00694067 : CMP EBX,EAX
00694069 : JC 0x0069407a
0069406b : MOV EDX,dword ptr [ESP + 0x40]
0069406f : PUSH 0x8
00694071 : PUSH EDX
00694072 : CALL 0x00686490
00694077 : ADD ESP,0x8
0069407a : CMP EDI,dword ptr [ESP + 0x14]
0069407e : JNC 0x0069408f
00694080 : MOV EAX,dword ptr [ESP + 0x40]
00694084 : PUSH 0x8
00694086 : PUSH EAX
00694087 : CALL 0x00686490
0069408c : ADD ESP,0x8
0069408f : INC EDI
00694090 : MOV dword ptr [ESP + 0x14],EDI
00694094 : TEST ESI,ESI
00694096 : JZ 0x0069414b
0069409c : MOV ECX,dword ptr [ESP + 0x3c]
006940a0 : MOVZX EDI,byte ptr [ESI + ECX*0x1]
006940a4 : MOVZX EDX,byte ptr [ESI + ECX*0x1 + 0x1]
006940a9 : MOVZX EAX,byte ptr [ESI + ECX*0x1 + 0x2]
006940ae : LEA ESI,[ESI + ECX*0x1 + 0x4]
006940b2 : MOVZX ECX,byte ptr [ESI + -0x1]
006940b6 : SHL EDI,0x8
006940b9 : OR EDI,EDX
006940bb : SHL EDI,0x8
006940be : OR EDI,EAX
006940c0 : MOV EAX,dword ptr [ESP + 0x40]
006940c4 : SHL EDI,0x8
006940c7 : OR EDI,ECX
006940c9 : MOV ECX,dword ptr [EAX + 0x4]
006940cc : LEA EDX,[ESI + EDI*0x4]
006940cf : MOV dword ptr [ESP + 0x10],0x0
006940d7 : CMP EDX,ECX
006940d9 : JBE 0x006940e6
006940db : PUSH 0x8
006940dd : PUSH EAX
006940de : CALL 0x00686490
006940e3 : ADD ESP,0x8
006940e6 : TEST EDI,EDI
006940e8 : JBE 0x0069414b
006940ea : MOV dword ptr [ESP + 0x18],EDI
006940ee : MOV EDI,EDI
006940f0 : MOVZX EDI,byte ptr [ESI]
006940f3 : MOVZX EDX,byte ptr [ESI + 0x1]
006940f7 : MOVZX EAX,byte ptr [ESI + 0x2]
006940fb : MOVZX EBP,byte ptr [ESI + 0x3]
006940ff : ADD ESI,0x3
00694102 : SHL EDI,0x8
00694105 : OR EDI,EDX
00694107 : SHL EDI,0x8
0069410a : OR EDI,EAX
0069410c : ADD EBP,EDI
0069410e : INC ESI
0069410f : CMP EBP,0x110000
00694115 : JC 0x00694126
00694117 : MOV ECX,dword ptr [ESP + 0x40]
0069411b : PUSH 0x8
0069411d : PUSH ECX
0069411e : CALL 0x00686490
00694123 : ADD ESP,0x8
00694126 : CMP EDI,dword ptr [ESP + 0x10]
0069412a : JNC 0x0069413b
0069412c : MOV EDX,dword ptr [ESP + 0x40]
00694130 : PUSH 0x8
00694132 : PUSH EDX
00694133 : CALL 0x00686490
00694138 : ADD ESP,0x8
0069413b : INC EBP
0069413c : SUB dword ptr [ESP + 0x18],0x1
00694141 : MOV dword ptr [ESP + 0x10],EBP
00694145 : JNZ 0x006940f0
00694147 : MOV EBP,dword ptr [ESP + 0x1c]
0069414b : TEST EBX,EBX
0069414d : JZ 0x0069425d
00694153 : MOV EAX,dword ptr [ESP + 0x3c]
00694157 : MOVZX ESI,byte ptr [EBX + EAX*0x1]
0069415b : LEA EAX,[EBX + EAX*0x1 + 0x4]
0069415f : MOVZX EDX,byte ptr [EAX + -0x2]
00694163 : LEA ECX,[EAX + -0x3]
00694166 : MOV dword ptr [ESP + 0x10],ECX
0069416a : MOVZX ECX,byte ptr [ECX]
0069416d : SHL ESI,0x8
00694170 : OR ESI,ECX
00694172 : MOVZX ECX,byte ptr [EAX + -0x1]
00694176 : LEA EDI,[EAX + -0x2]
00694179 : SHL ESI,0x8
0069417c : LEA EBX,[EAX + -0x1]
0069417f : OR ESI,EDX
00694181 : SHL ESI,0x8
00694184 : OR ESI,ECX
00694186 : LEA EDX,[EAX + ESI*0x4]
00694189 : MOV EAX,dword ptr [ESP + 0x40]
0069418d : MOV ECX,dword ptr [EAX + 0x4]
00694190 : MOV dword ptr [ESP + 0x18],0x0
00694198 : CMP EDX,ECX
0069419a : JBE 0x006941a7
0069419c : PUSH 0x8
0069419e : PUSH EAX
0069419f : CALL 0x00686490
006941a4 : ADD ESP,0x8
006941a7 : TEST ESI,ESI
006941a9 : JBE 0x0069425d
006941af : MOV EAX,dword ptr [ESP + 0x10]
006941b3 : MOV dword ptr [ESP + 0x10],ESI
006941b7 : JMP 0x006941c4
006941c0 : MOV EAX,dword ptr [ESP + 0x34]
006941c4 : MOVZX ESI,byte ptr [EAX + 0x3]
006941c8 : MOVZX EDX,byte ptr [EDI + 0x3]
006941cc : MOVZX ECX,byte ptr [EBX + 0x3]
006941d0 : ADD EAX,0x3
006941d3 : ADD EDI,0x3
006941d6 : SHL ESI,0x8
006941d9 : OR ESI,EDX
006941db : MOVZX DX,byte ptr [EDI + 0x2]
006941e0 : ADD EDI,0x2
006941e3 : ADD EBX,0x3
006941e6 : ADD EAX,0x2
006941e9 : ADD EBX,0x2
006941ec : SHL DX,0x8
006941f0 : MOV dword ptr [ESP + 0x34],EAX
006941f4 : MOVZX EAX,byte ptr [EBX]
006941f7 : SHL ESI,0x8
006941fa : MOVZX EBP,DX
006941fd : OR ESI,ECX
006941ff : OR EBP,EAX
00694201 : CMP ESI,0x110000
00694207 : JC 0x00694218
00694209 : MOV ECX,dword ptr [ESP + 0x40]
0069420d : PUSH 0x8
0069420f : PUSH ECX
00694210 : CALL 0x00686490
00694215 : ADD ESP,0x8
00694218 : CMP ESI,dword ptr [ESP + 0x18]
0069421c : JNC 0x0069422d
0069421e : MOV EDX,dword ptr [ESP + 0x40]
00694222 : PUSH 0x8
00694224 : PUSH EDX
00694225 : CALL 0x00686490
0069422a : ADD ESP,0x8
0069422d : MOV EAX,dword ptr [ESP + 0x40]
00694231 : MOV ECX,dword ptr [EAX + 0x8]
00694234 : INC ESI
00694235 : CMP ECX,0x1
00694238 : MOV dword ptr [ESP + 0x18],ESI
0069423c : JL 0x0069424e
0069423e : CMP EBP,dword ptr [EAX + 0x50]
00694241 : JC 0x0069424e
00694243 : PUSH 0x10
00694245 : PUSH EAX
00694246 : CALL 0x00686490
0069424b : ADD ESP,0x8
0069424e : SUB dword ptr [ESP + 0x10],0x1
00694253 : JNZ 0x006941c0
00694259 : MOV EBP,dword ptr [ESP + 0x1c]
0069425d : SUB dword ptr [ESP + 0x20],0x1
00694262 : JNZ 0x00693fd0
00694268 : POP EDI
00694269 : POP ESI
0069426a : POP EBP
0069426b : XOR EAX,EAX
0069426d : POP EBX
0069426e : ADD ESP,0x28
00694271 : RET

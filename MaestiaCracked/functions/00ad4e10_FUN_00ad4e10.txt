PROGRAM  : Maestia.exe
FUNCTION : FUN_00ad4e10
ENTRY    : 00ad4e10
BODY     : [[00ad4e10, 00ad5030]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00ad4e10(void)

{
  int *piVar1;
  uint uVar2;
  undefined4 uVar3;
  int in_ECX;
  undefined1 local_48 [28];
  undefined1 local_2c [28];
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  piVar1 = DAT_00da9894;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b25efa;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  switch(*(undefined1 *)(in_ECX + 3)) {
  case 2:
    if (*(int *)(*DAT_00da9894 + 0x138) != 0) {
      ExceptionList = &local_10;
      FUN_00904e70(*(undefined4 *)(in_ECX + 4));
    }
    break;
  case 4:
    if (*(int *)(*DAT_00da9894 + 0x138) != 0) {
      ExceptionList = &local_10;
      FUN_00904cb0(*(undefined4 *)(in_ECX + 4));
    }
    break;
  case 5:
    if (*(int *)(*DAT_00da9894 + 0x138) != 0) {
      ExceptionList = &local_10;
      *(bool *)(*(int *)(*DAT_00da9894 + 0x138) + 0x54) = *(int *)(in_ECX + 4) != 0;
      (**(code **)(**(int **)(*piVar1 + 0x138) + 0x18))(1,300,uVar2);
    }
    break;
  case 7:
    if ((*DAT_00da9894 != 0) && (*(int *)(*DAT_00da9894 + 0x138) != 0)) {
      ExceptionList = &local_10;
      FUN_00904bd0(*(undefined4 *)(in_ECX + 4));
    }
    break;
  case 0xff:
    if (*(int *)(in_ECX + 4) == 0x1501) {
      if (DAT_0172491c == 0) {
        return 1;
      }
      if (*DAT_00da9894 == 0) {
        return 1;
      }
      if (*(int *)(*DAT_00da9894 + 0x1a8) == 0) {
        return 1;
      }
      ExceptionList = &local_10;
      FUN_00406460(L"IDS_STORAGE_INVALID_NPC");
      local_8 = 0;
      piVar1 = *(int **)(*DAT_00da9894 + 0x1a8);
      uVar3 = FUN_0081d120(local_48);
      local_8._0_1_ = 1;
      (**(code **)(*piVar1 + 0x44))(uVar3,3);
      local_8 = (uint)local_8._1_3_ << 8;
      FUN_00406560();
    }
    else {
      if (*(int *)(in_ECX + 4) != 0x1502) {
        return 1;
      }
      if (DAT_0172491c == 0) {
        return 1;
      }
      if (*DAT_00da9894 == 0) {
        return 1;
      }
      if (*(int *)(*DAT_00da9894 + 0x1a8) == 0) {
        return 1;
      }
      ExceptionList = &local_10;
      FUN_00406460(L"IDS_STORAGE_NOT_ENOUGH_MONEY");
      local_8 = 2;
      piVar1 = *(int **)(*DAT_00da9894 + 0x1a8);
      uVar3 = FUN_0081d120(local_2c);
      local_8._0_1_ = 3;
      (**(code **)(*piVar1 + 0x44))(uVar3,3);
      local_8 = CONCAT31(local_8._1_3_,2);
      FUN_00406560();
    }
    local_8 = 0xffffffff;
    FUN_00406560();
  }
  ExceptionList = local_10;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
00ad4e10 : PUSH EBP
00ad4e11 : MOV EBP,ESP
00ad4e13 : PUSH -0x1
00ad4e15 : PUSH 0xb25efa
00ad4e1a : MOV EAX,FS:[0x0]
00ad4e20 : PUSH EAX
00ad4e21 : SUB ESP,0x70
00ad4e24 : PUSH ESI
00ad4e25 : PUSH EDI
00ad4e26 : MOV EAX,[0x00d66fa0]
00ad4e2b : XOR EAX,EBP
00ad4e2d : PUSH EAX
00ad4e2e : LEA EAX,[EBP + -0xc]
00ad4e31 : MOV FS:[0x0],EAX
00ad4e37 : MOVZX EAX,byte ptr [ECX + 0x3]
00ad4e3b : ADD EAX,-0x2
00ad4e3e : CMP EAX,0xfd
00ad4e43 : JA 0x00ad501b
00ad4e49 : MOVZX EAX,byte ptr [EAX + 0xad504c]
00ad4e50 : JMP dword ptr [EAX*0x4 + 0xad5034]
00ad4e57 : MOV EDX,dword ptr [0x00da9894]
00ad4e5d : MOV EAX,dword ptr [EDX]
00ad4e5f : MOV EAX,dword ptr [EAX + 0x138]
00ad4e65 : TEST EAX,EAX
00ad4e67 : JZ 0x00ad501b
00ad4e6d : CMP dword ptr [ECX + 0x4],0x0
00ad4e71 : PUSH 0x12c
00ad4e76 : SETNZ CL
00ad4e79 : MOV byte ptr [EAX + 0x54],CL
00ad4e7c : MOV EDX,dword ptr [EDX]
00ad4e7e : MOV ECX,dword ptr [EDX + 0x138]
00ad4e84 : MOV EAX,dword ptr [ECX]
00ad4e86 : MOV EDX,dword ptr [EAX + 0x18]
00ad4e89 : PUSH 0x1
00ad4e8b : CALL EDX
00ad4e8d : JMP 0x00ad501b
00ad4e92 : MOV EAX,[0x00da9894]
00ad4e97 : MOV EDX,dword ptr [EAX]
00ad4e99 : MOV ESI,dword ptr [EDX + 0x138]
00ad4e9f : TEST ESI,ESI
00ad4ea1 : JZ 0x00ad501b
00ad4ea7 : MOV EAX,dword ptr [ECX + 0x4]
00ad4eaa : PUSH EAX
00ad4eab : CALL 0x00904e70
00ad4eb0 : JMP 0x00ad501b
00ad4eb5 : MOV EDX,dword ptr [0x00da9894]
00ad4ebb : MOV EAX,dword ptr [EDX]
00ad4ebd : MOV EAX,dword ptr [EAX + 0x138]
00ad4ec3 : TEST EAX,EAX
00ad4ec5 : JZ 0x00ad501b
00ad4ecb : MOV ECX,dword ptr [ECX + 0x4]
00ad4ece : PUSH ECX
00ad4ecf : CALL 0x00904cb0
00ad4ed4 : JMP 0x00ad501b
00ad4ed9 : MOV EDX,dword ptr [0x00da9894]
00ad4edf : MOV EAX,dword ptr [EDX]
00ad4ee1 : TEST EAX,EAX
00ad4ee3 : JZ 0x00ad501b
00ad4ee9 : MOV EAX,dword ptr [EAX + 0x138]
00ad4eef : TEST EAX,EAX
00ad4ef1 : JZ 0x00ad501b
00ad4ef7 : MOV ECX,dword ptr [ECX + 0x4]
00ad4efa : PUSH ECX
00ad4efb : CALL 0x00904bd0
00ad4f00 : JMP 0x00ad501b
00ad4f05 : MOV ECX,dword ptr [ECX + 0x4]
00ad4f08 : SUB ECX,0x1501
00ad4f0e : JZ 0x00ad4f9f
00ad4f14 : SUB ECX,0x1
00ad4f17 : JNZ 0x00ad501b
00ad4f1d : CMP dword ptr [0x0172491c],ECX
00ad4f23 : JZ 0x00ad501b
00ad4f29 : MOV EDX,dword ptr [0x00da9894]
00ad4f2f : MOV EAX,dword ptr [EDX]
00ad4f31 : TEST EAX,EAX
00ad4f33 : JZ 0x00ad501b
00ad4f39 : CMP dword ptr [EAX + 0x1a8],ECX
00ad4f3f : JZ 0x00ad501b
00ad4f45 : PUSH 0xcb7ef4
00ad4f4a : LEA ECX,[EBP + -0x28]
00ad4f4d : CALL 0x00406460
00ad4f52 : MOV dword ptr [EBP + -0x4],0x2
00ad4f59 : MOV EAX,[0x00da9894]
00ad4f5e : MOV EAX,dword ptr [EAX]
00ad4f60 : MOV ESI,dword ptr [EAX + 0x1a8]
00ad4f66 : LEA ECX,[EBP + -0x28]
00ad4f69 : PUSH ECX
00ad4f6a : MOV ECX,dword ptr [0x0172491c]
00ad4f70 : LEA EDI,[EBP + -0x60]
00ad4f73 : CALL 0x0081d120
00ad4f78 : MOV byte ptr [EBP + -0x4],0x3
00ad4f7c : MOV EDX,dword ptr [ESI]
00ad4f7e : PUSH 0x3
00ad4f80 : PUSH EAX
00ad4f81 : MOV EAX,dword ptr [EDX + 0x44]
00ad4f84 : MOV ECX,ESI
00ad4f86 : CALL EAX
00ad4f88 : MOV byte ptr [EBP + -0x4],0x2
00ad4f8c : MOV ECX,EDI
00ad4f8e : CALL 0x00406560
00ad4f93 : MOV dword ptr [EBP + -0x4],0xffffffff
00ad4f9a : LEA ECX,[EBP + -0x28]
00ad4f9d : JMP 0x00ad5016
00ad4f9f : CMP dword ptr [0x0172491c],0x0
00ad4fa6 : JZ 0x00ad501b
00ad4fa8 : MOV ECX,dword ptr [0x00da9894]
00ad4fae : MOV EAX,dword ptr [ECX]
00ad4fb0 : TEST EAX,EAX
00ad4fb2 : JZ 0x00ad501b
00ad4fb4 : CMP dword ptr [EAX + 0x1a8],0x0
00ad4fbb : JZ 0x00ad501b
00ad4fbd : PUSH 0xcb7ec4
00ad4fc2 : LEA ECX,[EBP + -0x44]
00ad4fc5 : CALL 0x00406460
00ad4fca : MOV dword ptr [EBP + -0x4],0x0
00ad4fd1 : MOV EDX,dword ptr [0x00da9894]
00ad4fd7 : MOV EAX,dword ptr [EDX]
00ad4fd9 : MOV ESI,dword ptr [EAX + 0x1a8]
00ad4fdf : MOV ECX,dword ptr [0x0172491c]
00ad4fe5 : LEA EAX,[EBP + -0x44]
00ad4fe8 : PUSH EAX
00ad4fe9 : LEA EDI,[EBP + -0x7c]
00ad4fec : CALL 0x0081d120
00ad4ff1 : MOV byte ptr [EBP + -0x4],0x1
00ad4ff5 : MOV EDX,dword ptr [ESI]
00ad4ff7 : PUSH 0x3
00ad4ff9 : PUSH EAX
00ad4ffa : MOV EAX,dword ptr [EDX + 0x44]
00ad4ffd : MOV ECX,ESI
00ad4fff : CALL EAX
00ad5001 : MOV byte ptr [EBP + -0x4],0x0
00ad5005 : MOV ECX,EDI
00ad5007 : CALL 0x00406560
00ad500c : MOV dword ptr [EBP + -0x4],0xffffffff
00ad5013 : LEA ECX,[EBP + -0x44]
00ad5016 : CALL 0x00406560
00ad501b : MOV EAX,0x1
00ad5020 : MOV ECX,dword ptr [EBP + -0xc]
00ad5023 : MOV dword ptr FS:[0x0],ECX
00ad502a : POP ECX
00ad502b : POP EDI
00ad502c : POP ESI
00ad502d : MOV ESP,EBP
00ad502f : POP EBP
00ad5030 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00664610
ENTRY    : 00664610
BODY     : [[00664610, 0066466b]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00664610(int param_1)

{
  int *piVar1;
  int iVar2;
  int in_ECX;
  
  if (param_1 != in_ECX) {
    if (*(int *)(in_ECX + 0x40) != 0) {
      CoTaskMemFree(*(LPVOID *)(in_ECX + 0x44));
      *(undefined4 *)(in_ECX + 0x40) = 0;
      *(undefined4 *)(in_ECX + 0x44) = 0;
    }
    piVar1 = *(int **)(in_ECX + 0x3c);
    if (piVar1 != (int *)0x0) {
      (**(code **)(*piVar1 + 8))(piVar1);
      *(undefined4 *)(in_ECX + 0x3c) = 0;
    }
    iVar2 = FUN_00664540(in_ECX,param_1);
    if (iVar2 < 0) {
      return 0x8007000e;
    }
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00664610 : PUSH EBX
00664611 : MOV EBX,dword ptr [ESP + 0x8]
00664615 : PUSH ESI
00664616 : MOV ESI,ECX
00664618 : CMP EBX,ESI
0066461a : JZ 0x00664665
0066461c : CMP dword ptr [ESI + 0x40],0x0
00664620 : JZ 0x0066463a
00664622 : MOV EAX,dword ptr [ESI + 0x44]
00664625 : PUSH EAX
00664626 : CALL dword ptr [0x00b85770]
0066462c : MOV dword ptr [ESI + 0x40],0x0
00664633 : MOV dword ptr [ESI + 0x44],0x0
0066463a : MOV EAX,dword ptr [ESI + 0x3c]
0066463d : TEST EAX,EAX
0066463f : JZ 0x00664650
00664641 : MOV ECX,dword ptr [EAX]
00664643 : MOV EDX,dword ptr [ECX + 0x8]
00664646 : PUSH EAX
00664647 : CALL EDX
00664649 : MOV dword ptr [ESI + 0x3c],0x0
00664650 : PUSH EBX
00664651 : PUSH ESI
00664652 : CALL 0x00664540
00664657 : TEST EAX,EAX
00664659 : JGE 0x00664665
0066465b : POP ESI
0066465c : MOV EAX,0x8007000e
00664661 : POP EBX
00664662 : RET 0x4
00664665 : POP ESI
00664666 : XOR EAX,EAX
00664668 : POP EBX
00664669 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_009e5e60
ENTRY    : 009e5e60
BODY     : [[009e5e60, 009e5ec9] [009e5ed0, 009e5fa1]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009e5e60(void)

{
  WCHAR WVar1;
  WCHAR *pWVar2;
  undefined4 *puVar3;
  int iVar4;
  undefined4 uVar5;
  undefined4 local_22c;
  int local_21c;
  uint local_218;
  WCHAR local_214;
  undefined1 local_212 [510];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b67523;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  wsprintfW(&local_214,L"$setadminlevel %d",2,local_14);
  pWVar2 = &local_214;
  local_218 = 7;
  local_21c = 0;
  local_22c = (undefined4 *)((uint)local_22c._2_2_ << 0x10);
  do {
    WVar1 = *pWVar2;
    pWVar2 = pWVar2 + 1;
  } while (WVar1 != L'\0');
  FUN_00406360(&local_214,(int)pWVar2 - (int)local_212 >> 1);
  local_8 = 0;
  if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
    puVar3 = local_22c;
    if (local_218 < 8) {
      puVar3 = &local_22c;
    }
    iVar4 = FUN_00405b70(puVar3);
    if ((iVar4 != 0) || (local_21c != 0)) {
      uVar5 = FUN_00838510();
      FUN_0083a480(uVar5);
    }
  }
  local_8 = 0xffffffff;
  if (7 < local_218) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_218 = 7;
  local_21c = 0;
  local_22c = (undefined4 *)((uint)local_22c & 0xffff0000);
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
009e5e60 : PUSH EBP
009e5e61 : MOV EBP,ESP
009e5e63 : PUSH -0x1
009e5e65 : PUSH 0xb67523
009e5e6a : MOV EAX,FS:[0x0]
009e5e70 : PUSH EAX
009e5e71 : SUB ESP,0x220
009e5e77 : MOV EAX,[0x00d66fa0]
009e5e7c : XOR EAX,EBP
009e5e7e : MOV dword ptr [EBP + -0x10],EAX
009e5e81 : PUSH EAX
009e5e82 : LEA EAX,[EBP + -0xc]
009e5e85 : MOV FS:[0x0],EAX
009e5e8b : PUSH 0x2
009e5e8d : LEA EAX,[EBP + 0xfffffdf0]
009e5e93 : PUSH 0xc98308
009e5e98 : PUSH EAX
009e5e99 : CALL dword ptr [0x00b85434]
009e5e9f : ADD ESP,0xc
009e5ea2 : XOR ECX,ECX
009e5ea4 : LEA EAX,[EBP + 0xfffffdf0]
009e5eaa : MOV dword ptr [EBP + 0xfffffdec],0x7
009e5eb4 : MOV dword ptr [EBP + 0xfffffde8],0x0
009e5ebe : MOV word ptr [EBP + 0xfffffdd8],CX
009e5ec5 : LEA EDX,[EAX + 0x2]
009e5ec8 : JMP 0x009e5ed0
009e5ed0 : MOV CX,word ptr [EAX]
009e5ed3 : ADD EAX,0x2
009e5ed6 : TEST CX,CX
009e5ed9 : JNZ 0x009e5ed0
009e5edb : SUB EAX,EDX
009e5edd : SAR EAX,0x1
009e5edf : PUSH EAX
009e5ee0 : LEA EDX,[EBP + 0xfffffdf0]
009e5ee6 : PUSH EDX
009e5ee7 : LEA ECX,[EBP + 0xfffffdd4]
009e5eed : CALL 0x00406360
009e5ef2 : MOV dword ptr [EBP + -0x4],0x0
009e5ef9 : MOV EAX,[0x017247d4]
009e5efe : CMP dword ptr [EAX + 0x4],0x0
009e5f02 : JZ 0x009e5f51
009e5f04 : CMP byte ptr [EAX + 0x8],0x0
009e5f08 : JZ 0x009e5f51
009e5f0a : CMP dword ptr [EBP + 0xfffffdec],0x8
009e5f11 : MOV EAX,dword ptr [EBP + 0xfffffdd8]
009e5f17 : JNC 0x009e5f1f
009e5f19 : LEA EAX,[EBP + 0xfffffdd8]
009e5f1f : PUSH EAX
009e5f20 : XOR EDX,EDX
009e5f22 : MOV ECX,0xcac440
009e5f27 : CALL 0x00405b70
009e5f2c : ADD ESP,0x4
009e5f2f : TEST EAX,EAX
009e5f31 : JNZ 0x009e5f40
009e5f33 : CMP dword ptr [EBP + 0xfffffde8],EAX
009e5f39 : SETNZ AL
009e5f3c : TEST EAX,EAX
009e5f3e : JZ 0x009e5f51
009e5f40 : CALL 0x00838510
009e5f45 : PUSH EAX
009e5f46 : LEA ECX,[EBP + 0xfffffdd4]
009e5f4c : CALL 0x0083a480
009e5f51 : MOV dword ptr [EBP + -0x4],0xffffffff
009e5f58 : CMP dword ptr [EBP + 0xfffffdec],0x8
009e5f5f : JC 0x009e5f6c
009e5f61 : MOV ECX,dword ptr [EBP + 0xfffffdd8]
009e5f67 : CALL 0x006f04e0
009e5f6c : XOR EAX,EAX
009e5f6e : MOV dword ptr [EBP + 0xfffffdec],0x7
009e5f78 : MOV dword ptr [EBP + 0xfffffde8],0x0
009e5f82 : MOV word ptr [EBP + 0xfffffdd8],AX
009e5f89 : MOV ECX,dword ptr [EBP + -0xc]
009e5f8c : MOV dword ptr FS:[0x0],ECX
009e5f93 : POP ECX
009e5f94 : MOV ECX,dword ptr [EBP + -0x10]
009e5f97 : XOR ECX,EBP
009e5f99 : CALL 0x00633e6b
009e5f9e : MOV ESP,EBP
009e5fa0 : POP EBP
009e5fa1 : RET

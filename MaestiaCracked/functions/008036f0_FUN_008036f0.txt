PROGRAM  : Maestia.exe
FUNCTION : FUN_008036f0
ENTRY    : 008036f0
BODY     : [[008036f0, 00803ac7]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008036f0(int param_1,undefined4 param_2)

{
  char cVar1;
  uint uVar2;
  undefined4 uVar3;
  undefined4 ****ppppuVar4;
  int *in_ECX;
  int iVar5;
  undefined1 auStack_94 [3];
  char cStack_91;
  undefined1 local_90 [4];
  undefined2 uStack_8c;
  undefined4 uStack_7c;
  uint uStack_78;
  int local_74;
  undefined1 auStack_70 [4];
  undefined2 uStack_6c;
  undefined4 uStack_5c;
  uint uStack_58;
  undefined1 local_54 [4];
  undefined4 ***local_50 [4];
  uint local_40;
  uint local_3c;
  undefined1 auStack_38 [4];
  undefined2 uStack_34;
  undefined4 uStack_24;
  uint uStack_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  int local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b438e7;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_94;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xffffff60;
  ExceptionList = &local_14;
  local_50[0] = (undefined4 ***)((uint)local_50[0] & 0xffff0000);
  local_74 = param_1;
  local_3c = 7;
  local_40 = 0;
  FUN_00405eb0(param_2,0,0xffffffff);
  local_c = 0;
  if (*(char *)(param_1 + 100) == '\0') {
    cVar1 = FUN_00803030(local_54);
    if (cVar1 == '\0') goto LAB_008037dd;
    local_c = 0xffffffff;
    if (7 < local_3c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0(uVar2);
    }
    local_50[0] = (undefined4 ***)((uint)local_50[0] & 0xffff0000);
  }
  else {
    cVar1 = FUN_00803490(param_1,local_54);
    if (cVar1 == '\0') {
LAB_008037dd:
      if (DAT_00da98e4 == '\0') {
        FUN_00406460(&PTR_LAB_00c28b18);
        local_c._0_1_ = 1;
        cStack_91 = (**(code **)(*in_ECX + 4))(local_54,local_90);
        local_c._0_1_ = 0;
        if (7 < uStack_78) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        uStack_78 = 7;
        uStack_7c = 0;
        uStack_8c = 0;
        if (cStack_91 != '\0') {
          local_c = 0xffffffff;
          FUN_00406560();
          goto LAB_00803aa5;
        }
        FUN_00406460(&DAT_00c28b20);
        iVar5 = *(int *)(param_1 + 0x58);
        if (iVar5 != *(int *)(param_1 + 0x5c)) {
          do {
            local_c._0_1_ = 2;
            FUN_00401440();
            uVar3 = FUN_00403450(auStack_70,local_54);
            local_c._0_1_ = 3;
            FUN_00405eb0(uVar3,0,0xffffffff);
            local_c._0_1_ = 2;
            if (7 < uStack_58) {
                    /* WARNING: Subroutine does not return */
              FUN_006f04e0();
            }
            uStack_6c = 0;
            uStack_58 = 7;
            uStack_5c = 0;
            uStack_78 = 7;
            uStack_7c = 0;
            uStack_8c = 0;
            FUN_00406360(&PTR_LAB_00c28b24,2);
            local_c._0_1_ = 4;
            cVar1 = (**(code **)(*in_ECX + 4))(auStack_38,local_90);
            local_c._0_1_ = 2;
            if (7 < uStack_78) {
                    /* WARNING: Subroutine does not return */
              FUN_006f04e0();
            }
            uStack_78 = 7;
            uStack_7c = 0;
            uStack_8c = 0;
            if (cVar1 != '\0') {
              local_c = (uint)local_c._1_3_ << 8;
              if (7 < uStack_20) {
                    /* WARNING: Subroutine does not return */
                FUN_006f04e0();
              }
              uStack_20 = 7;
              uStack_24 = 0;
              uStack_34 = 0;
              local_c = 0xffffffff;
              if (7 < local_3c) {
                    /* WARNING: Subroutine does not return */
                FUN_006f04e0();
              }
              local_50[0] = (undefined4 ***)((uint)local_50[0] & 0xffff0000);
              goto LAB_00803a9d;
            }
            iVar5 = iVar5 + 0x1c;
          } while (iVar5 != *(int *)(local_74 + 0x5c));
        }
        local_c = (uint)local_c._1_3_ << 8;
        if (7 < uStack_20) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        uStack_20 = 7;
        uStack_24 = 0;
        uStack_34 = 0;
      }
      uVar2 = local_40;
      ppppuVar4 = (undefined4 ****)local_50[0];
      if (local_3c < 8) {
        ppppuVar4 = local_50;
      }
      iVar5 = FUN_00405b70(ppppuVar4);
      if (((iVar5 == 0) && (10 < uVar2)) && (uVar2 == 0xb)) {
        local_c = 0xffffffff;
        if (7 < local_3c) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
      }
      else {
        local_c = 0xffffffff;
        if (7 < local_3c) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
      }
      local_50[0] = (undefined4 ***)((uint)local_50[0] & 0xffff0000);
    }
    else {
      local_c = 0xffffffff;
      if (7 < local_3c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0(uVar2);
      }
      local_50[0] = (undefined4 ***)((uint)local_50[0] & 0xffff0000);
    }
  }
LAB_00803a9d:
  local_c = 0xffffffff;
  local_40 = 0;
  local_3c = 7;
LAB_00803aa5:
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_94);
  return;
}



============================================================
DISASSEMBLY
============================================================
008036f0 : PUSH EBP
008036f1 : MOV EBP,ESP
008036f3 : AND ESP,0xfffffff8
008036f6 : PUSH -0x1
008036f8 : PUSH 0xb438e7
008036fd : MOV EAX,FS:[0x0]
00803703 : PUSH EAX
00803704 : SUB ESP,0x80
0080370a : MOV EAX,[0x00d66fa0]
0080370f : XOR EAX,ESP
00803711 : MOV dword ptr [ESP + 0x78],EAX
00803715 : PUSH EBX
00803716 : PUSH ESI
00803717 : PUSH EDI
00803718 : MOV EAX,[0x00d66fa0]
0080371d : XOR EAX,ESP
0080371f : PUSH EAX
00803720 : LEA EAX,[ESP + 0x90]
00803727 : MOV FS:[0x0],EAX
0080372d : MOV EAX,dword ptr [EBP + 0xc]
00803730 : MOV EBX,dword ptr [EBP + 0x8]
00803733 : MOV ESI,ECX
00803735 : PUSH -0x1
00803737 : XOR EDI,EDI
00803739 : XOR ECX,ECX
0080373b : PUSH EDI
0080373c : MOV word ptr [ESP + 0x5c],CX
00803741 : PUSH EAX
00803742 : LEA ECX,[ESP + 0x5c]
00803746 : MOV dword ptr [ESP + 0x3c],EBX
0080374a : MOV dword ptr [ESP + 0x74],0x7
00803752 : MOV dword ptr [ESP + 0x70],EDI
00803756 : CALL 0x00405eb0
0080375b : MOV dword ptr [ESP + 0x98],EDI
00803762 : CMP byte ptr [EBX + 0x64],0x0
00803766 : JZ 0x008037a2
00803768 : LEA EDX,[ESP + 0x50]
0080376c : PUSH EDX
0080376d : PUSH EBX
0080376e : MOV ECX,ESI
00803770 : CALL 0x00803490
00803775 : TEST AL,AL
00803777 : JZ 0x008037dd
00803779 : MOV dword ptr [ESP + 0x98],0xffffffff
00803784 : CMP dword ptr [ESP + 0x68],0x8
00803789 : JC 0x00803794
0080378b : MOV ECX,dword ptr [ESP + 0x54]
0080378f : CALL 0x006f04e0
00803794 : XOR EAX,EAX
00803796 : MOV word ptr [ESP + 0x54],AX
0080379b : MOV AL,0x1
0080379d : JMP 0x00803a99
008037a2 : LEA ECX,[ESP + 0x50]
008037a6 : PUSH ECX
008037a7 : MOV ECX,ESI
008037a9 : MOV EDX,EBX
008037ab : CALL 0x00803030
008037b0 : TEST AL,AL
008037b2 : JZ 0x008037dd
008037b4 : MOV dword ptr [ESP + 0x98],0xffffffff
008037bf : CMP dword ptr [ESP + 0x68],0x8
008037c4 : JC 0x008037cf
008037c6 : MOV ECX,dword ptr [ESP + 0x54]
008037ca : CALL 0x006f04e0
008037cf : XOR EDX,EDX
008037d1 : MOV word ptr [ESP + 0x54],DX
008037d6 : MOV AL,0x1
008037d8 : JMP 0x00803a99
008037dd : CMP byte ptr [0x00da98e4],0x0
008037e4 : JNZ 0x00803a0d
008037ea : PUSH 0xc28b18
008037ef : LEA ECX,[ESP + 0x18]
008037f3 : CALL 0x00406460
008037f8 : MOV byte ptr [ESP + 0x98],0x1
00803800 : MOV EAX,dword ptr [ESI]
00803802 : MOV EAX,dword ptr [EAX + 0x4]
00803805 : LEA ECX,[ESP + 0x14]
00803809 : PUSH ECX
0080380a : LEA EDX,[ESP + 0x54]
0080380e : PUSH EDX
0080380f : MOV ECX,ESI
00803811 : CALL EAX
00803813 : MOV byte ptr [ESP + 0x13],AL
00803817 : MOV byte ptr [ESP + 0x98],0x0
0080381f : CMP dword ptr [ESP + 0x2c],0x8
00803824 : JC 0x0080382f
00803826 : MOV ECX,dword ptr [ESP + 0x18]
0080382a : CALL 0x006f04e0
0080382f : XOR ECX,ECX
00803831 : MOV dword ptr [ESP + 0x2c],0x7
00803839 : MOV dword ptr [ESP + 0x28],EDI
0080383d : MOV word ptr [ESP + 0x18],CX
00803842 : CMP byte ptr [ESP + 0x13],CL
00803846 : JZ 0x00803863
00803848 : MOV dword ptr [ESP + 0x98],0xffffffff
00803853 : LEA ECX,[ESP + 0x50]
00803857 : CALL 0x00406560
0080385c : MOV AL,0x1
0080385e : JMP 0x00803aa5
00803863 : PUSH 0xc28b20
00803868 : LEA ECX,[ESP + 0x70]
0080386c : CALL 0x00406460
00803871 : MOV byte ptr [ESP + 0x98],0x2
00803879 : MOV EDI,dword ptr [EBX + 0x58]
0080387c : CMP EDI,dword ptr [EBX + 0x5c]
0080387f : JZ 0x00803964
00803885 : LEA EAX,[ESP + 0x6c]
00803889 : CALL 0x00401440
0080388e : LEA EDX,[ESP + 0x50]
00803892 : PUSH EDX
00803893 : LEA EAX,[ESP + 0x38]
00803897 : PUSH EAX
00803898 : MOV ECX,EDI
0080389a : CALL 0x00403450
0080389f : ADD ESP,0x8
008038a2 : MOV byte ptr [ESP + 0x98],0x3
008038aa : PUSH -0x1
008038ac : XOR EBX,EBX
008038ae : PUSH EBX
008038af : PUSH EAX
008038b0 : LEA ECX,[ESP + 0x78]
008038b4 : CALL 0x00405eb0
008038b9 : MOV byte ptr [ESP + 0x98],0x2
008038c1 : CMP dword ptr [ESP + 0x4c],0x8
008038c6 : JC 0x008038d1
008038c8 : MOV ECX,dword ptr [ESP + 0x38]
008038cc : CALL 0x006f04e0
008038d1 : XOR ECX,ECX
008038d3 : MOV EAX,0x7
008038d8 : PUSH 0x2
008038da : MOV word ptr [ESP + 0x3c],CX
008038df : XOR EDX,EDX
008038e1 : PUSH 0xc28b24
008038e6 : LEA ECX,[ESP + 0x1c]
008038ea : MOV dword ptr [ESP + 0x54],EAX
008038ee : MOV dword ptr [ESP + 0x50],EBX
008038f2 : MOV dword ptr [ESP + 0x34],EAX
008038f6 : MOV dword ptr [ESP + 0x30],EBX
008038fa : MOV word ptr [ESP + 0x20],DX
008038ff : CALL 0x00406360
00803904 : MOV byte ptr [ESP + 0x98],0x4
0080390c : MOV EAX,dword ptr [ESI]
0080390e : MOV EAX,dword ptr [EAX + 0x4]
00803911 : LEA ECX,[ESP + 0x14]
00803915 : PUSH ECX
00803916 : LEA EDX,[ESP + 0x70]
0080391a : PUSH EDX
0080391b : MOV ECX,ESI
0080391d : CALL EAX
0080391f : MOV BL,AL
00803921 : MOV byte ptr [ESP + 0x98],0x2
00803929 : CMP dword ptr [ESP + 0x2c],0x8
0080392e : JC 0x00803939
00803930 : MOV ECX,dword ptr [ESP + 0x18]
00803934 : CALL 0x006f04e0
00803939 : XOR ECX,ECX
0080393b : MOV dword ptr [ESP + 0x2c],0x7
00803943 : MOV dword ptr [ESP + 0x28],0x0
0080394b : MOV word ptr [ESP + 0x18],CX
00803950 : TEST BL,BL
00803952 : JNZ 0x008039a4
00803954 : MOV EDX,dword ptr [ESP + 0x30]
00803958 : ADD EDI,0x1c
0080395b : CMP EDI,dword ptr [EDX + 0x5c]
0080395e : JNZ 0x00803885
00803964 : MOV byte ptr [ESP + 0x98],0x0
0080396c : MOV EBX,0x8
00803971 : CMP dword ptr [ESP + 0x84],EBX
00803978 : JC 0x00803983
0080397a : MOV ECX,dword ptr [ESP + 0x70]
0080397e : CALL 0x006f04e0
00803983 : XOR EDX,EDX
00803985 : MOV dword ptr [ESP + 0x84],0x7
00803990 : MOV dword ptr [ESP + 0x80],0x0
0080399b : MOV word ptr [ESP + 0x70],DX
008039a0 : XOR EDI,EDI
008039a2 : JMP 0x00803a12
008039a4 : MOV byte ptr [ESP + 0x98],0x0
008039ac : CMP dword ptr [ESP + 0x84],0x8
008039b4 : JC 0x008039bf
008039b6 : MOV ECX,dword ptr [ESP + 0x70]
008039ba : CALL 0x006f04e0
008039bf : XOR EAX,EAX
008039c1 : MOV dword ptr [ESP + 0x84],0x7
008039cc : MOV dword ptr [ESP + 0x80],0x0
008039d7 : MOV word ptr [ESP + 0x70],AX
008039dc : MOV dword ptr [ESP + 0x98],0xffffffff
008039e7 : CMP dword ptr [ESP + 0x68],0x8
008039ec : JC 0x008039f7
008039ee : MOV ECX,dword ptr [ESP + 0x54]
008039f2 : CALL 0x006f04e0
008039f7 : XOR ECX,ECX
008039f9 : MOV dword ptr [ESP + 0x64],0x0
00803a01 : MOV word ptr [ESP + 0x54],CX
00803a06 : MOV AL,0x1
00803a08 : JMP 0x00803a9d
00803a0d : MOV EBX,0x8
00803a12 : MOV ESI,dword ptr [ESP + 0x64]
00803a16 : MOV EDX,ESI
00803a18 : CMP ESI,0xb
00803a1b : JC 0x00803a22
00803a1d : MOV EDX,0xb
00803a22 : MOV EAX,dword ptr [ESP + 0x54]
00803a26 : CMP dword ptr [ESP + 0x68],EBX
00803a2a : JNC 0x00803a30
00803a2c : LEA EAX,[ESP + 0x54]
00803a30 : PUSH EAX
00803a31 : MOV ECX,0xc28b2c
00803a36 : CALL 0x00405b70
00803a3b : ADD ESP,0x4
00803a3e : CMP EAX,EDI
00803a40 : JNZ 0x00803a76
00803a42 : CMP ESI,0xb
00803a45 : JC 0x00803a76
00803a47 : XOR EAX,EAX
00803a49 : CMP ESI,0xb
00803a4c : SETNZ AL
00803a4f : CMP EAX,EDI
00803a51 : JNZ 0x00803a76
00803a53 : MOV dword ptr [ESP + 0x98],0xffffffff
00803a5e : CMP dword ptr [ESP + 0x68],EBX
00803a62 : JC 0x00803a6d
00803a64 : MOV ECX,dword ptr [ESP + 0x54]
00803a68 : CALL 0x006f04e0
00803a6d : XOR EAX,EAX
00803a6f : MOV word ptr [ESP + 0x54],AX
00803a74 : JMP 0x00803a97
00803a76 : MOV dword ptr [ESP + 0x98],0xffffffff
00803a81 : CMP dword ptr [ESP + 0x68],EBX
00803a85 : JC 0x00803a90
00803a87 : MOV ECX,dword ptr [ESP + 0x54]
00803a8b : CALL 0x006f04e0
00803a90 : XOR ECX,ECX
00803a92 : MOV word ptr [ESP + 0x54],CX
00803a97 : XOR AL,AL
00803a99 : MOV dword ptr [ESP + 0x64],EDI
00803a9d : MOV dword ptr [ESP + 0x68],0x7
00803aa5 : MOV ECX,dword ptr [ESP + 0x90]
00803aac : MOV dword ptr FS:[0x0],ECX
00803ab3 : POP ECX
00803ab4 : POP EDI
00803ab5 : POP ESI
00803ab6 : POP EBX
00803ab7 : MOV ECX,dword ptr [ESP + 0x78]
00803abb : XOR ECX,ESP
00803abd : CALL 0x00633e6b
00803ac2 : MOV ESP,EBP
00803ac4 : POP EBP
00803ac5 : RET 0x8

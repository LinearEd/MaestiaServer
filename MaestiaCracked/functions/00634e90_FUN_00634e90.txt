PROGRAM  : Maestia.exe
FUNCTION : FUN_00634e90
ENTRY    : 00634e90
BODY     : [[00634e90, 00634f15] [006387f0, 006387f4]]

============================================================
DECOMPILED C CODE
============================================================

uint * FUN_00634e90(uint *param_1,char *param_2)

{
  char *pcVar1;
  char *pcVar2;
  char cVar3;
  uint *puVar4;
  uint uVar5;
  char cVar6;
  uint uVar7;
  char *pcVar8;
  uint uVar9;
  uint *puVar10;
  
  cVar3 = *param_2;
  if (cVar3 == '\0') {
    return param_1;
  }
  if (param_2[1] == '\0') {
    while (((uint)param_1 & 3) != 0) {
      uVar5 = *param_1;
      if ((char)uVar5 == cVar3) {
        return param_1;
      }
      param_1 = (uint *)((int)param_1 + 1);
      if ((char)uVar5 == '\0') {
        return (uint *)0x0;
      }
    }
    while( true ) {
      while( true ) {
        uVar5 = *param_1;
        uVar9 = uVar5 ^ CONCAT22(CONCAT11(cVar3,cVar3),CONCAT11(cVar3,cVar3));
        uVar7 = uVar5 ^ 0xffffffff ^ uVar5 + 0x7efefeff;
        puVar10 = param_1 + 1;
        if (((uVar9 ^ 0xffffffff ^ uVar9 + 0x7efefeff) & 0x81010100) != 0) break;
        param_1 = puVar10;
        if ((uVar7 & 0x81010100) != 0) {
          if ((uVar7 & 0x1010100) != 0) {
            return (uint *)0x0;
          }
          if ((uVar5 + 0x7efefeff & 0x80000000) == 0) {
            return (uint *)0x0;
          }
        }
      }
      uVar5 = *param_1;
      if ((char)uVar5 == cVar3) {
        return param_1;
      }
      if ((char)uVar5 == '\0') {
        return (uint *)0x0;
      }
      cVar6 = (char)(uVar5 >> 8);
      if (cVar6 == cVar3) {
        return (uint *)((int)param_1 + 1);
      }
      if (cVar6 == '\0') {
        return (uint *)0x0;
      }
      cVar6 = (char)(uVar5 >> 0x10);
      if (cVar6 == cVar3) {
        return (uint *)((int)param_1 + 2);
      }
      if (cVar6 == '\0') break;
      cVar6 = (char)(uVar5 >> 0x18);
      if (cVar6 == cVar3) {
        return (uint *)((int)param_1 + 3);
      }
      param_1 = puVar10;
      if (cVar6 == '\0') {
        return (uint *)0x0;
      }
    }
    return (uint *)0x0;
  }
  do {
    cVar6 = (char)*param_1;
    do {
      while (puVar10 = param_1, param_1 = (uint *)((int)puVar10 + 1), cVar6 != cVar3) {
        if (cVar6 == '\0') {
          return (uint *)0x0;
        }
        cVar6 = *(char *)param_1;
      }
      cVar6 = *(char *)param_1;
      pcVar8 = param_2;
      puVar4 = puVar10;
    } while (cVar6 != param_2[1]);
    do {
      if (pcVar8[2] == '\0') {
        return puVar10;
      }
      if (*(char *)((int)puVar4 + 2) != pcVar8[2]) break;
      pcVar1 = pcVar8 + 3;
      if (*pcVar1 == '\0') {
        return puVar10;
      }
      pcVar2 = (char *)((int)puVar4 + 3);
      pcVar8 = pcVar8 + 2;
      puVar4 = (uint *)((int)puVar4 + 2);
    } while (*pcVar1 == *pcVar2);
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
00634e90 : MOV ECX,dword ptr [ESP + 0x8]
00634e94 : PUSH EDI
00634e95 : PUSH EBX
00634e96 : PUSH ESI
00634e97 : MOV DL,byte ptr [ECX]
00634e99 : MOV EDI,dword ptr [ESP + 0x10]
00634e9d : TEST DL,DL
00634e9f : JZ 0x00634f10
00634ea1 : MOV DH,byte ptr [ECX + 0x1]
00634ea4 : TEST DH,DH
00634ea6 : JZ 0x00634efd
00634ea8 : MOV ESI,EDI
00634eaa : MOV ECX,dword ptr [ESP + 0x14]
00634eae : MOV AL,byte ptr [EDI]
00634eb0 : ADD ESI,0x1
00634eb3 : CMP AL,DL
00634eb5 : JZ 0x00634ece
00634eb7 : TEST AL,AL
00634eb9 : JZ 0x00634ec8
00634ebb : MOV AL,byte ptr [ESI]
00634ebd : ADD ESI,0x1
00634ec0 : CMP AL,DL
00634ec2 : JZ 0x00634ece
00634ec4 : TEST AL,AL
00634ec6 : JNZ 0x00634ebb
00634ec8 : POP ESI
00634ec9 : POP EBX
00634eca : POP EDI
00634ecb : XOR EAX,EAX
00634ecd : RET
00634ece : MOV AL,byte ptr [ESI]
00634ed0 : ADD ESI,0x1
00634ed3 : CMP AL,DH
00634ed5 : JNZ 0x00634ec0
00634ed7 : LEA EDI,[ESI + -0x1]
00634eda : MOV AH,byte ptr [ECX + 0x2]
00634edd : TEST AH,AH
00634edf : JZ 0x00634f09
00634ee1 : MOV AL,byte ptr [ESI]
00634ee3 : ADD ESI,0x2
00634ee6 : CMP AL,AH
00634ee8 : JNZ 0x00634ea8
00634eea : MOV AL,byte ptr [ECX + 0x3]
00634eed : TEST AL,AL
00634eef : JZ 0x00634f09
00634ef1 : MOV AH,byte ptr [ESI + -0x1]
00634ef4 : ADD ECX,0x2
00634ef7 : CMP AL,AH
00634ef9 : JZ 0x00634eda
00634efb : JMP 0x00634ea8
00634efd : XOR EAX,EAX
00634eff : POP ESI
00634f00 : POP EBX
00634f01 : POP EDI
00634f02 : MOV AL,DL
00634f04 : JMP 0x00638806
00634f09 : LEA EAX,[EDI + -0x1]
00634f0c : POP ESI
00634f0d : POP EBX
00634f0e : POP EDI
00634f0f : RET
00634f10 : MOV EAX,EDI
00634f12 : POP ESI
00634f13 : POP EBX
00634f14 : POP EDI
00634f15 : RET
006387f0 : LEA EAX,[EDX + -0x1]
006387f3 : POP EBX
006387f4 : RET

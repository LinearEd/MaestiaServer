PROGRAM  : Maestia.exe
FUNCTION : FUN_005f5fe0
ENTRY    : 005f5fe0
BODY     : [[005f5fe0, 005f61cd]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_005f5fe0(int param_1,uint param_2)

{
  int *piVar1;
  uint uVar2;
  uint uVar3;
  undefined4 uVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  undefined4 *puVar8;
  byte bVar9;
  undefined4 *in_ECX;
  uint uVar10;
  uint uVar11;
  int unaff_EBP;
  uint uVar12;
  undefined4 *_Dst;
  size_t unaff_retaddr;
  uint uStack_4;
  
  uVar6 = param_2;
  if (param_2 < (uint)in_ECX[4]) {
    uVar6 = in_ECX[4];
  }
  if ((undefined4 *)in_ECX[0xb] == in_ECX + 9) {
    param_2 = in_ECX[2];
  }
  else {
    param_2 = 0;
  }
  uVar2 = in_ECX[0x14];
  uVar12 = uVar6;
  if (uVar6 < uVar2) {
    uVar12 = uVar2;
  }
  uVar10 = in_ECX[5];
  if (uVar10 < uVar12) {
    uVar12 = uVar10;
  }
  uVar11 = -(uint)(uVar10 < uVar6) & uVar6;
  uVar10 = -(uint)(uVar12 < uVar2) & uVar2;
  if (uVar11 <= uVar10) {
    uVar11 = 0;
  }
  uVar3 = in_ECX[1];
  iVar7 = (**(code **)(*(int *)*in_ECX + 4))
                    (((((uVar11 + param_2 + param_1 + -1 + uVar6 & ~(uVar6 - 1)) - 1) + uVar3) /
                     uVar3) * uVar3 + uVar10 + -1 + uVar2 & ~(uVar2 - 1),uVar12);
  if (iVar7 != 0) {
    _Dst = (undefined4 *)(iVar7 + -1 + uVar2 & ~(uVar2 - 1));
    if (unaff_retaddr != 0) {
      _memset(_Dst,0,unaff_retaddr);
      _Dst[2] = 0;
      uStack_4 = 0;
      if (in_ECX[3] != 0) {
        puVar8 = _Dst + 9;
        do {
          puVar8[2] = _Dst;
          uVar4 = in_ECX[10];
          puVar8[1] = in_ECX + 9;
          *puVar8 = uVar4;
          *(undefined4 **)(in_ECX[10] + 8) = puVar8 + -1;
          in_ECX[10] = puVar8 + -1;
          uStack_4 = uStack_4 + 1;
          puVar8 = puVar8 + 8;
        } while (uStack_4 < (uint)in_ECX[3]);
      }
      uVar4 = in_ECX[7];
      piVar1 = in_ECX + 7;
      _Dst[1] = piVar1;
      *_Dst = uVar4;
      *(undefined4 **)(*piVar1 + 4) = _Dst;
      *piVar1 = (int)_Dst;
    }
    iVar5 = in_ECX[0xb];
    *(undefined4 *)(*(int *)(iVar5 + 4) + 8) = *(undefined4 *)(iVar5 + 8);
    *(undefined4 *)(*(int *)(iVar5 + 8) + 4) = *(undefined4 *)(iVar5 + 4);
    piVar1 = (int *)(*(int *)(iVar5 + 0xc) + 8);
    *piVar1 = *piVar1 + 1;
    *(size_t *)(iVar5 + 0x10) = unaff_retaddr + (int)_Dst;
    *(uint *)(iVar5 + 0x14) = (unaff_EBP + iVar7 & ~(uVar2 - 1)) - (unaff_retaddr + (int)_Dst);
    *(undefined4 *)(iVar5 + 0x18) = 0;
    if ((uVar12 & 0xffff0000) == 0) {
      if ((uVar12 & 0xff00) == 0) {
        bVar9 = *(byte *)((int)&PTR_DAT_00b94fc8 + (uVar12 & 0xff));
      }
      else {
        bVar9 = *(char *)((int)&PTR_DAT_00b94fc8 + (uVar12 >> 8 & 0xff)) + 8;
      }
    }
    else if ((uVar12 & 0xff000000) == 0) {
      bVar9 = *(char *)((int)&PTR_DAT_00b94fc8 + (uVar12 >> 0x10 & 0xff)) + 0x10;
    }
    else {
      bVar9 = *(char *)((int)&PTR_DAT_00b94fc8 + (uVar12 >> 0x18)) + 0x18;
    }
    *(ushort *)(iVar5 + 0x1c) = (ushort)bVar9;
    *(short *)(iVar5 + 0x1e) = (short)_Dst - (short)iVar7;
    FUN_005f5d60(iVar5);
    FUN_005aba30(iVar5);
    in_ECX[0x12] = in_ECX[0x12] + unaff_EBP;
    return 1;
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
005f5fe0 : MOV EAX,dword ptr [ESP + 0x8]
005f5fe4 : SUB ESP,0xc
005f5fe7 : PUSH EBX
005f5fe8 : PUSH EBP
005f5fe9 : MOV EBX,ECX
005f5feb : MOV ECX,dword ptr [EBX + 0x10]
005f5fee : PUSH ESI
005f5fef : PUSH EDI
005f5ff0 : CMP EAX,ECX
005f5ff2 : JNC 0x005f5ff6
005f5ff4 : MOV EAX,ECX
005f5ff6 : LEA ECX,[EBX + 0x24]
005f5ff9 : CMP dword ptr [ECX + 0x8],ECX
005f5ffc : JNZ 0x005f6007
005f5ffe : MOV ECX,dword ptr [EBX + 0x8]
005f6001 : MOV dword ptr [ESP + 0x24],ECX
005f6005 : JMP 0x005f600f
005f6007 : MOV dword ptr [ESP + 0x24],0x0
005f600f : MOV ESI,dword ptr [EBX + 0x50]
005f6012 : MOV EBP,EAX
005f6014 : CMP EAX,ESI
005f6016 : JNC 0x005f601a
005f6018 : MOV EBP,ESI
005f601a : MOV ECX,dword ptr [EBX + 0x14]
005f601d : CMP EBP,ECX
005f601f : JBE 0x005f6023
005f6021 : MOV EBP,ECX
005f6023 : CMP ECX,EAX
005f6025 : SBB EDX,EDX
005f6027 : AND EDX,EAX
005f6029 : CMP EBP,ESI
005f602b : SBB ECX,ECX
005f602d : AND ECX,ESI
005f602f : MOV dword ptr [ESP + 0x10],ECX
005f6033 : CMP EDX,ECX
005f6035 : JA 0x005f6039
005f6037 : XOR EDX,EDX
005f6039 : MOV EDI,dword ptr [ESP + 0x24]
005f603d : MOV ECX,dword ptr [EBX + 0x4]
005f6040 : ADD EDX,EDI
005f6042 : ADD EDX,dword ptr [ESP + 0x20]
005f6046 : PUSH EBP
005f6047 : LEA EDX,[EDX + EAX*0x1 + -0x1]
005f604b : DEC EAX
005f604c : NOT EAX
005f604e : AND EDX,EAX
005f6050 : LEA EAX,[EDX + ECX*0x1 + -0x1]
005f6054 : XOR EDX,EDX
005f6056 : DIV ECX
005f6058 : IMUL EAX,ECX
005f605b : ADD EAX,dword ptr [ESP + 0x14]
005f605f : LEA ECX,[ESI + -0x1]
005f6062 : LEA EAX,[EAX + ESI*0x1 + -0x1]
005f6066 : NOT ECX
005f6068 : AND EAX,ECX
005f606a : MOV ECX,dword ptr [EBX]
005f606c : MOV EDX,dword ptr [ECX]
005f606e : MOV dword ptr [ESP + 0x14],EAX
005f6072 : PUSH EAX
005f6073 : MOV EAX,dword ptr [EDX + 0x4]
005f6076 : CALL EAX
005f6078 : MOV dword ptr [ESP + 0x14],EAX
005f607c : TEST EAX,EAX
005f607e : JZ 0x005f61c2
005f6084 : MOV EDX,dword ptr [ESP + 0x10]
005f6088 : LEA ECX,[ESI + -0x1]
005f608b : NOT ECX
005f608d : LEA EDI,[EAX + ESI*0x1 + -0x1]
005f6091 : ADD EDX,EAX
005f6093 : AND EDX,ECX
005f6095 : AND EDI,ECX
005f6097 : MOV ECX,dword ptr [ESP + 0x24]
005f609b : XOR ESI,ESI
005f609d : MOV dword ptr [ESP + 0x18],EDX
005f60a1 : CMP ECX,ESI
005f60a3 : JZ 0x005f6101
005f60a5 : PUSH ECX
005f60a6 : PUSH ESI
005f60a7 : PUSH EDI
005f60a8 : CALL 0x0063b700
005f60ad : ADD ESP,0xc
005f60b0 : MOV dword ptr [EDI + 0x8],ESI
005f60b3 : MOV dword ptr [ESP + 0x20],ESI
005f60b7 : CMP dword ptr [EBX + 0xc],ESI
005f60ba : JBE 0x005f60eb
005f60bc : LEA EAX,[EDI + 0x24]
005f60bf : NOP
005f60c0 : MOV dword ptr [EAX + 0x8],EDI
005f60c3 : MOV EDX,dword ptr [EBX + 0x28]
005f60c6 : LEA ECX,[EBX + 0x24]
005f60c9 : MOV dword ptr [EAX + 0x4],ECX
005f60cc : MOV dword ptr [EAX],EDX
005f60ce : MOV ESI,dword ptr [ECX + 0x4]
005f60d1 : LEA EDX,[EAX + -0x4]
005f60d4 : MOV dword ptr [ESI + 0x8],EDX
005f60d7 : MOV dword ptr [ECX + 0x4],EDX
005f60da : MOV ECX,dword ptr [ESP + 0x20]
005f60de : INC ECX
005f60df : ADD EAX,0x20
005f60e2 : MOV dword ptr [ESP + 0x20],ECX
005f60e6 : CMP ECX,dword ptr [EBX + 0xc]
005f60e9 : JC 0x005f60c0
005f60eb : MOV ECX,dword ptr [EBX + 0x1c]
005f60ee : LEA EAX,[EBX + 0x1c]
005f60f1 : MOV dword ptr [EDI + 0x4],EAX
005f60f4 : MOV dword ptr [EDI],ECX
005f60f6 : MOV EDX,dword ptr [EAX]
005f60f8 : MOV dword ptr [EDX + 0x4],EDI
005f60fb : MOV dword ptr [EAX],EDI
005f60fd : MOV EAX,dword ptr [ESP + 0x14]
005f6101 : MOV ESI,dword ptr [EBX + 0x2c]
005f6104 : MOV ECX,dword ptr [ESI + 0x4]
005f6107 : MOV EDX,dword ptr [ESI + 0x8]
005f610a : MOV dword ptr [ECX + 0x8],EDX
005f610d : MOV ECX,dword ptr [ESI + 0x8]
005f6110 : MOV EDX,dword ptr [ESI + 0x4]
005f6113 : MOV dword ptr [ECX + 0x4],EDX
005f6116 : MOV ECX,dword ptr [ESI + 0xc]
005f6119 : INC dword ptr [ECX + 0x8]
005f611c : MOV ECX,dword ptr [ESP + 0x24]
005f6120 : MOV EDX,dword ptr [ESP + 0x18]
005f6124 : ADD ECX,EDI
005f6126 : SUB EDX,ECX
005f6128 : MOV dword ptr [ESI + 0x10],ECX
005f612b : MOV dword ptr [ESI + 0x14],EDX
005f612e : MOV dword ptr [ESI + 0x18],0x0
005f6135 : TEST EBP,0xffff0000
005f613b : JZ 0x005f6167
005f613d : TEST EBP,0xff000000
005f6143 : JZ 0x005f6153
005f6145 : SHR EBP,0x18
005f6148 : MOV CL,byte ptr [EBP + 0xb94fc8]
005f614e : ADD CL,0x18
005f6151 : JMP 0x005f618f
005f6153 : SHR EBP,0x10
005f6156 : AND EBP,0xff
005f615c : MOV CL,byte ptr [EBP + 0xb94fc8]
005f6162 : ADD CL,0x10
005f6165 : JMP 0x005f618f
005f6167 : TEST EBP,0xff00
005f616d : JZ 0x005f6183
005f616f : SHR EBP,0x8
005f6172 : AND EBP,0xff
005f6178 : MOV CL,byte ptr [EBP + 0xb94fc8]
005f617e : ADD CL,0x8
005f6181 : JMP 0x005f618f
005f6183 : AND EBP,0xff
005f6189 : MOV CL,byte ptr [EBP + 0xb94fc8]
005f618f : MOVZX DX,CL
005f6193 : SUB EDI,EAX
005f6195 : PUSH ESI
005f6196 : LEA ECX,[EBX + 0x44]
005f6199 : MOV word ptr [ESI + 0x1c],DX
005f619d : MOV word ptr [ESI + 0x1e],DI
005f61a1 : CALL 0x005f5d60
005f61a6 : PUSH ESI
005f61a7 : LEA ECX,[EBX + 0x4c]
005f61aa : CALL 0x005aba30
005f61af : MOV EAX,dword ptr [ESP + 0x10]
005f61b3 : ADD dword ptr [EBX + 0x48],EAX
005f61b6 : POP EDI
005f61b7 : POP ESI
005f61b8 : POP EBP
005f61b9 : MOV AL,0x1
005f61bb : POP EBX
005f61bc : ADD ESP,0xc
005f61bf : RET 0x8
005f61c2 : POP EDI
005f61c3 : POP ESI
005f61c4 : POP EBP
005f61c5 : XOR AL,AL
005f61c7 : POP EBX
005f61c8 : ADD ESP,0xc
005f61cb : RET 0x8

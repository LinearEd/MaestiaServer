PROGRAM  : Maestia.exe
FUNCTION : FUN_00a5eb80
ENTRY    : 00a5eb80
BODY     : [[00a5eb80, 00a5ed59]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a5eb80(void)

{
  char cVar1;
  code *pcVar2;
  undefined4 in_ECX;
  int unaff_EDI;
  uint local_7c;
  int local_78 [2];
  int local_70;
  int local_6c [22];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3b86f;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(int *)(unaff_EDI + 4) == 0) goto LAB_00a5ed3f;
  FUN_0070d390(local_14);
  local_8 = 0;
  FUN_00406460(&PTR_LAB_00c0102c);
  local_8._0_1_ = 1;
  cVar1 = FUN_0070d790(in_ECX);
  local_8 = (uint)local_8._1_3_ << 8;
  if (7 < local_7c) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  if (cVar1 != '\0') {
    (**(code **)(local_6c[0] + 0x1c))(local_78);
    if (((local_78[0] == -0x63d7253f) &&
        ((**(code **)(local_6c[0] + 0xc))(&local_70,4,1), local_70 == -0x56e3f9af)) &&
       ((**(code **)(local_6c[0] + 0x1c))(local_78), local_78[0] == -0x63d7544f)) {
      (**(code **)(local_6c[0] + 0xc))(&local_70,4,1);
      (**(code **)(local_6c[0] + 0x1c))(local_78);
      (**(code **)(local_6c[0] + 0xc))(unaff_EDI + 0x40,4,1);
      (**(code **)(local_6c[0] + 0x1c))(local_78);
      if (local_78[0] == -0x63d7698f) {
        FUN_00a5e500(local_6c,0);
      }
      (**(code **)(local_6c[0] + 0x1c))(local_78);
      if (local_78[0] != -0x63d7253f) {
        (**(code **)(local_6c[0] + 8))();
        goto LAB_00a5ec41;
      }
      (**(code **)(local_6c[0] + 0xc))(&local_70,4,1);
      pcVar2 = *(code **)(local_6c[0] + 8);
      if (local_70 == -0x56e3f9ae) {
        (*pcVar2)();
        local_8 = 0xffffffff;
        FUN_0070d710();
        goto LAB_00a5ed3f;
      }
    }
    else {
      pcVar2 = *(code **)(local_6c[0] + 8);
    }
    (*pcVar2)();
  }
LAB_00a5ec41:
  local_8 = 0xffffffff;
  FUN_0070d710();
LAB_00a5ed3f:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a5eb80 : PUSH EBP
00a5eb81 : MOV EBP,ESP
00a5eb83 : PUSH -0x1
00a5eb85 : PUSH 0xb3b86f
00a5eb8a : MOV EAX,FS:[0x0]
00a5eb90 : PUSH EAX
00a5eb91 : SUB ESP,0x88
00a5eb97 : MOV EAX,[0x00d66fa0]
00a5eb9c : XOR EAX,EBP
00a5eb9e : MOV dword ptr [EBP + -0x10],EAX
00a5eba1 : PUSH EBX
00a5eba2 : PUSH ESI
00a5eba3 : PUSH EAX
00a5eba4 : LEA EAX,[EBP + -0xc]
00a5eba7 : MOV FS:[0x0],EAX
00a5ebad : CMP dword ptr [EDI + 0x4],0x0
00a5ebb1 : MOV ESI,ECX
00a5ebb3 : JZ 0x00a5ec50
00a5ebb9 : LEA ECX,[EBP + -0x68]
00a5ebbc : CALL 0x0070d390
00a5ebc1 : MOV dword ptr [EBP + -0x4],0x0
00a5ebc8 : PUSH 0xc0102c
00a5ebcd : LEA ECX,[EBP + 0xffffff70]
00a5ebd3 : CALL 0x00406460
00a5ebd8 : MOV byte ptr [EBP + -0x4],0x1
00a5ebdc : PUSH ESI
00a5ebdd : LEA EAX,[EBP + 0xffffff70]
00a5ebe3 : LEA ESI,[EBP + -0x68]
00a5ebe6 : CALL 0x0070d790
00a5ebeb : MOV BL,AL
00a5ebed : MOV byte ptr [EBP + -0x4],0x0
00a5ebf1 : CMP dword ptr [EBP + -0x78],0x8
00a5ebf5 : JC 0x00a5ec02
00a5ebf7 : MOV ECX,dword ptr [EBP + 0xffffff74]
00a5ebfd : CALL 0x006f04e0
00a5ec02 : XOR EAX,EAX
00a5ec04 : MOV dword ptr [EBP + -0x78],0x7
00a5ec0b : MOV dword ptr [EBP + -0x7c],0x0
00a5ec12 : MOV word ptr [EBP + 0xffffff74],AX
00a5ec19 : TEST BL,BL
00a5ec1b : JZ 0x00a5ec41
00a5ec1d : MOV EDX,dword ptr [EBP + -0x68]
00a5ec20 : MOV EAX,dword ptr [EDX + 0x1c]
00a5ec23 : LEA ECX,[EBP + -0x74]
00a5ec26 : PUSH ECX
00a5ec27 : LEA ECX,[EBP + -0x68]
00a5ec2a : CALL EAX
00a5ec2c : MOV EDX,dword ptr [EBP + -0x68]
00a5ec2f : MOV ESI,0x9c28dac1
00a5ec34 : CMP dword ptr [EBP + -0x74],ESI
00a5ec37 : JZ 0x00a5ec57
00a5ec39 : MOV EAX,dword ptr [EDX + 0x8]
00a5ec3c : LEA ECX,[EBP + -0x68]
00a5ec3f : CALL EAX
00a5ec41 : MOV dword ptr [EBP + -0x4],0xffffffff
00a5ec48 : LEA ECX,[EBP + -0x68]
00a5ec4b : CALL 0x0070d710
00a5ec50 : XOR AL,AL
00a5ec52 : JMP 0x00a5ed3f
00a5ec57 : MOV EAX,dword ptr [EDX + 0xc]
00a5ec5a : PUSH 0x1
00a5ec5c : PUSH 0x4
00a5ec5e : LEA ECX,[EBP + -0x6c]
00a5ec61 : PUSH ECX
00a5ec62 : LEA ECX,[EBP + -0x68]
00a5ec65 : CALL EAX
00a5ec67 : CMP dword ptr [EBP + -0x6c],0xa91c0651
00a5ec6e : MOV EDX,dword ptr [EBP + -0x68]
00a5ec71 : JNZ 0x00a5ec39
00a5ec73 : MOV EAX,dword ptr [EDX + 0x1c]
00a5ec76 : LEA ECX,[EBP + -0x74]
00a5ec79 : PUSH ECX
00a5ec7a : LEA ECX,[EBP + -0x68]
00a5ec7d : CALL EAX
00a5ec7f : CMP dword ptr [EBP + -0x74],0x9c28abb1
00a5ec86 : MOV EDX,dword ptr [EBP + -0x68]
00a5ec89 : JNZ 0x00a5ec39
00a5ec8b : MOV EAX,dword ptr [EDX + 0xc]
00a5ec8e : PUSH 0x1
00a5ec90 : PUSH 0x4
00a5ec92 : LEA ECX,[EBP + -0x6c]
00a5ec95 : PUSH ECX
00a5ec96 : LEA ECX,[EBP + -0x68]
00a5ec99 : CALL EAX
00a5ec9b : MOV EDX,dword ptr [EBP + -0x68]
00a5ec9e : MOV EAX,dword ptr [EDX + 0x1c]
00a5eca1 : LEA ECX,[EBP + -0x74]
00a5eca4 : PUSH ECX
00a5eca5 : LEA ECX,[EBP + -0x68]
00a5eca8 : CALL EAX
00a5ecaa : MOV EDX,dword ptr [EBP + -0x68]
00a5ecad : MOV EAX,dword ptr [EDX + 0xc]
00a5ecb0 : PUSH 0x1
00a5ecb2 : PUSH 0x4
00a5ecb4 : LEA ECX,[EDI + 0x40]
00a5ecb7 : PUSH ECX
00a5ecb8 : LEA ECX,[EBP + -0x68]
00a5ecbb : CALL EAX
00a5ecbd : MOV EDX,dword ptr [EBP + -0x68]
00a5ecc0 : MOV EAX,dword ptr [EDX + 0x1c]
00a5ecc3 : LEA ECX,[EBP + -0x74]
00a5ecc6 : PUSH ECX
00a5ecc7 : LEA ECX,[EBP + -0x68]
00a5ecca : CALL EAX
00a5eccc : CMP dword ptr [EBP + -0x74],0x9c289671
00a5ecd3 : JNZ 0x00a5ece2
00a5ecd5 : PUSH 0x0
00a5ecd7 : LEA ECX,[EBP + -0x68]
00a5ecda : PUSH ECX
00a5ecdb : MOV ECX,EDI
00a5ecdd : CALL 0x00a5e500
00a5ece2 : MOV EAX,dword ptr [EBP + -0x68]
00a5ece5 : LEA EDX,[EBP + -0x74]
00a5ece8 : PUSH EDX
00a5ece9 : MOV EDX,dword ptr [EAX + 0x1c]
00a5ecec : LEA ECX,[EBP + -0x68]
00a5ecef : CALL EDX
00a5ecf1 : LEA ECX,[EBP + -0x68]
00a5ecf4 : CMP dword ptr [EBP + -0x74],ESI
00a5ecf7 : JZ 0x00a5ed06
00a5ecf9 : MOV EAX,dword ptr [EBP + -0x68]
00a5ecfc : MOV EDX,dword ptr [EAX + 0x8]
00a5ecff : CALL EDX
00a5ed01 : JMP 0x00a5ec41
00a5ed06 : MOV EDX,dword ptr [EBP + -0x68]
00a5ed09 : PUSH 0x1
00a5ed0b : PUSH 0x4
00a5ed0d : LEA EAX,[EBP + -0x6c]
00a5ed10 : PUSH EAX
00a5ed11 : MOV EAX,dword ptr [EDX + 0xc]
00a5ed14 : CALL EAX
00a5ed16 : CMP dword ptr [EBP + -0x6c],0xa91c0652
00a5ed1d : MOV EDX,dword ptr [EBP + -0x68]
00a5ed20 : MOV EAX,dword ptr [EDX + 0x8]
00a5ed23 : LEA ECX,[EBP + -0x68]
00a5ed26 : JNZ 0x00a5ec3f
00a5ed2c : CALL EAX
00a5ed2e : MOV dword ptr [EBP + -0x4],0xffffffff
00a5ed35 : LEA ECX,[EBP + -0x68]
00a5ed38 : CALL 0x0070d710
00a5ed3d : MOV AL,0x1
00a5ed3f : MOV ECX,dword ptr [EBP + -0xc]
00a5ed42 : MOV dword ptr FS:[0x0],ECX
00a5ed49 : POP ECX
00a5ed4a : POP ESI
00a5ed4b : POP EBX
00a5ed4c : MOV ECX,dword ptr [EBP + -0x10]
00a5ed4f : XOR ECX,EBP
00a5ed51 : CALL 0x00633e6b
00a5ed56 : MOV ESP,EBP
00a5ed58 : POP EBP
00a5ed59 : RET

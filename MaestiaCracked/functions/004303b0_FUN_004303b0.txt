PROGRAM  : Maestia.exe
FUNCTION : FUN_004303b0
ENTRY    : 004303b0
BODY     : [[004303b0, 004303f9] [00430400, 00430474]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_004303b0(int param_1)

{
  short sVar1;
  short *psVar2;
  short *psVar3;
  undefined4 *in_ECX;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b778d3;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  psVar2 = (short *)*in_ECX;
  *(undefined4 *)(param_1 + 0x18) = 7;
  *(undefined4 *)(param_1 + 0x14) = 0;
  *(undefined2 *)(param_1 + 4) = 0;
  psVar3 = psVar2;
  do {
    sVar1 = *psVar3;
    psVar3 = psVar3 + 1;
  } while (sVar1 != 0);
  FUN_00406360(psVar2,(int)psVar3 - (int)(psVar2 + 1) >> 1);
  local_8 = 0;
  psVar2 = (short *)in_ECX[1];
  *(undefined4 *)(param_1 + 0x34) = 7;
  *(undefined4 *)(param_1 + 0x30) = 0;
  *(undefined2 *)(param_1 + 0x20) = 0;
  psVar3 = psVar2;
  do {
    sVar1 = *psVar3;
    psVar3 = psVar3 + 1;
  } while (sVar1 != 0);
  FUN_00406360(psVar2,(int)psVar3 - (int)(psVar2 + 1) >> 1);
  ExceptionList = local_10;
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
004303b0 : PUSH EBP
004303b1 : MOV EBP,ESP
004303b3 : PUSH -0x1
004303b5 : PUSH 0xb778d3
004303ba : MOV EAX,FS:[0x0]
004303c0 : PUSH EAX
004303c1 : PUSH ECX
004303c2 : PUSH ESI
004303c3 : PUSH EDI
004303c4 : MOV EAX,[0x00d66fa0]
004303c9 : XOR EAX,EBP
004303cb : PUSH EAX
004303cc : LEA EAX,[EBP + -0xc]
004303cf : MOV FS:[0x0],EAX
004303d5 : MOV EDI,ECX
004303d7 : MOV ESI,dword ptr [EBP + 0x8]
004303da : MOV ECX,dword ptr [EDI]
004303dc : XOR EAX,EAX
004303de : MOV dword ptr [ESI + 0x18],0x7
004303e5 : MOV dword ptr [ESI + 0x14],0x0
004303ec : MOV word ptr [ESI + 0x4],AX
004303f0 : MOV EAX,ECX
004303f2 : LEA EDX,[EAX + 0x2]
004303f5 : MOV dword ptr [EBP + -0x10],EDX
004303f8 : JMP 0x00430400
00430400 : MOV DX,word ptr [EAX]
00430403 : ADD EAX,0x2
00430406 : TEST DX,DX
00430409 : JNZ 0x00430400
0043040b : SUB EAX,dword ptr [EBP + -0x10]
0043040e : SAR EAX,0x1
00430410 : PUSH EAX
00430411 : PUSH ECX
00430412 : MOV ECX,ESI
00430414 : CALL 0x00406360
00430419 : MOV dword ptr [EBP + -0x4],0x0
00430420 : MOV EDX,dword ptr [EDI + 0x4]
00430423 : LEA ECX,[ESI + 0x1c]
00430426 : XOR EAX,EAX
00430428 : MOV dword ptr [ECX + 0x18],0x7
0043042f : MOV dword ptr [ECX + 0x14],0x0
00430436 : MOV word ptr [ECX + 0x4],AX
0043043a : MOV EAX,EDX
0043043c : LEA EDI,[EAX + 0x2]
0043043f : MOV dword ptr [EBP + -0x10],EDI
00430442 : MOV DI,word ptr [EAX]
00430445 : ADD EAX,0x2
00430448 : TEST DI,DI
0043044b : JNZ 0x00430442
0043044d : SUB EAX,dword ptr [EBP + -0x10]
00430450 : SAR EAX,0x1
00430452 : PUSH EAX
00430453 : PUSH EDX
00430454 : CALL 0x00406360
00430459 : MOV dword ptr [EBP + -0x4],0xffffffff
00430460 : MOV EAX,ESI
00430462 : MOV ECX,dword ptr [EBP + -0xc]
00430465 : MOV dword ptr FS:[0x0],ECX
0043046c : POP ECX
0043046d : POP EDI
0043046e : POP ESI
0043046f : MOV ESP,EBP
00430471 : POP EBP
00430472 : RET 0x4

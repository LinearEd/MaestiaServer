PROGRAM  : Maestia.exe
FUNCTION : FUN_007bcac0
ENTRY    : 007bcac0
BODY     : [[007bcac0, 007bcc1d]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x007bcb51) */

void FUN_007bcac0(int param_1,int param_2)

{
  int *piVar1;
  uint uVar2;
  ushort *puVar3;
  int iVar4;
  ushort *puVar5;
  uint uVar6;
  LPCRITICAL_SECTION local_28;
  char *local_24;
  undefined4 local_20;
  int local_1c;
  undefined4 local_18;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b109f2;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_28 = (LPCRITICAL_SECTION)(param_1 + 4);
  local_1c = 0;
  local_24 = ".\\mss\\AvaMssMgr.cpp";
  local_20 = 0x3f3;
  local_18 = 1;
  FUN_006ef1a0(&local_28);
  local_8 = 0;
  if ((*(int *)(param_1 + 0x20) != 0) &&
     (local_14 = *(int **)(param_1 + 0x40), local_14 != *(int **)(param_1 + 0x44))) {
    do {
      piVar1 = (int *)*local_14;
      if (*(uint *)(param_2 + 0x18) < 8) {
        puVar3 = (ushort *)(param_2 + 4);
      }
      else {
        puVar3 = *(ushort **)(param_2 + 4);
      }
      uVar2 = piVar1[10];
      uVar6 = *(uint *)(param_2 + 0x14);
      if (uVar2 < *(uint *)(param_2 + 0x14)) {
        uVar6 = uVar2;
      }
      if ((uint)piVar1[0xb] < 8) {
        puVar5 = (ushort *)(piVar1 + 6);
      }
      else {
        puVar5 = (ushort *)piVar1[6];
      }
      for (; uVar6 != 0; uVar6 = uVar6 - 1) {
        if (*puVar5 != *puVar3) {
          uVar6 = (-(uint)(*puVar5 < *puVar3) & 0xfffffffe) + 1;
          if (uVar6 != 0) goto LAB_007bcb9a;
          break;
        }
        puVar5 = puVar5 + 1;
        puVar3 = puVar3 + 1;
      }
      if (*(uint *)(param_2 + 0x14) <= uVar2) {
        uVar6 = (uint)(uVar2 != *(uint *)(param_2 + 0x14));
LAB_007bcb9a:
        if (((uVar6 == 0) && (*piVar1 != 0)) && (iVar4 = _AIL_sample_status_4(*piVar1), iVar4 == 4))
        {
          _AIL_end_sample_4(*piVar1);
        }
      }
      local_14 = local_14 + 1;
    } while (local_14 != *(int **)(param_1 + 0x44));
  }
  local_8 = 0xffffffff;
  if (local_1c != 0) {
    LeaveCriticalSection(local_28);
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
007bcac0 : PUSH EBP
007bcac1 : MOV EBP,ESP
007bcac3 : PUSH -0x1
007bcac5 : PUSH 0xb109f2
007bcaca : MOV EAX,FS:[0x0]
007bcad0 : PUSH EAX
007bcad1 : SUB ESP,0x18
007bcad4 : PUSH EBX
007bcad5 : PUSH ESI
007bcad6 : PUSH EDI
007bcad7 : MOV EAX,[0x00d66fa0]
007bcadc : XOR EAX,EBP
007bcade : PUSH EAX
007bcadf : LEA EAX,[EBP + -0xc]
007bcae2 : MOV FS:[0x0],EAX
007bcae8 : MOV EBX,dword ptr [EBP + 0xc]
007bcaeb : MOV ESI,dword ptr [EBP + 0x8]
007bcaee : LEA ECX,[EBP + -0x24]
007bcaf1 : LEA EAX,[ESI + 0x4]
007bcaf4 : XOR EDI,EDI
007bcaf6 : PUSH ECX
007bcaf7 : MOV dword ptr [EBP + -0x18],EDI
007bcafa : MOV dword ptr [EBP + -0x24],EAX
007bcafd : MOV dword ptr [EBP + -0x20],0xc18f5c
007bcb04 : MOV dword ptr [EBP + -0x1c],0x3f3
007bcb0b : MOV dword ptr [EBP + -0x14],0x1
007bcb12 : CALL 0x006ef1a0
007bcb17 : MOV dword ptr [EBP + -0x4],EDI
007bcb1a : CMP dword ptr [ESI + 0x20],EDI
007bcb1d : JZ 0x007bcbd5
007bcb23 : MOV EAX,dword ptr [ESI + 0x40]
007bcb26 : MOV dword ptr [EBP + -0x10],EAX
007bcb29 : CMP EAX,dword ptr [ESI + 0x44]
007bcb2c : JZ 0x007bcbd5
007bcb32 : JMP 0x007bcb37
007bcb34 : MOV EAX,dword ptr [EBP + -0x10]
007bcb37 : CMP dword ptr [EBX + 0x18],0x8
007bcb3b : MOV EDI,dword ptr [EAX]
007bcb3d : MOV EDX,dword ptr [EBX + 0x14]
007bcb40 : JC 0x007bcb47
007bcb42 : MOV EAX,dword ptr [EBX + 0x4]
007bcb45 : JMP 0x007bcb4a
007bcb47 : LEA EAX,[EBX + 0x4]
007bcb4a : MOV ESI,dword ptr [EDI + 0x28]
007bcb4d : MOV ECX,ESI
007bcb4f : CMP ECX,ESI
007bcb51 : CMOVC ESI,ECX
007bcb54 : CMP ESI,EDX
007bcb56 : JNC 0x007bcb5a
007bcb58 : MOV EDX,ESI
007bcb5a : CMP dword ptr [EDI + 0x2c],0x8
007bcb5e : JC 0x007bcb65
007bcb60 : MOV ECX,dword ptr [EDI + 0x18]
007bcb63 : JMP 0x007bcb68
007bcb65 : LEA ECX,[EDI + 0x18]
007bcb68 : TEST EDX,EDX
007bcb6a : JBE 0x007bcb8a
007bcb6c : LEA ESP,[ESP]
007bcb70 : MOV BX,word ptr [ECX]
007bcb73 : CMP BX,word ptr [EAX]
007bcb76 : JNZ 0x007bcc02
007bcb7c : ADD ECX,0x2
007bcb7f : ADD EAX,0x2
007bcb82 : SUB EDX,0x1
007bcb85 : JNZ 0x007bcb70
007bcb87 : MOV EBX,dword ptr [EBP + 0xc]
007bcb8a : MOV EAX,dword ptr [EBX + 0x14]
007bcb8d : CMP ESI,EAX
007bcb8f : JC 0x007bcbbe
007bcb91 : XOR EDX,EDX
007bcb93 : CMP ESI,EAX
007bcb95 : SETNZ DL
007bcb98 : MOV EAX,EDX
007bcb9a : TEST EAX,EAX
007bcb9c : JNZ 0x007bcbbe
007bcb9e : MOV EAX,dword ptr [EDI]
007bcba0 : TEST EAX,EAX
007bcba2 : JZ 0x007bcbbe
007bcba4 : PUSH EAX
007bcba5 : CALL dword ptr [0x00b85708]
007bcbab : CMP EAX,0x4
007bcbae : SETZ AL
007bcbb1 : TEST AL,AL
007bcbb3 : JZ 0x007bcbbe
007bcbb5 : MOV EAX,dword ptr [EDI]
007bcbb7 : PUSH EAX
007bcbb8 : CALL dword ptr [0x00b856f4]
007bcbbe : MOV EAX,dword ptr [EBP + -0x10]
007bcbc1 : MOV ECX,dword ptr [EBP + 0x8]
007bcbc4 : ADD EAX,0x4
007bcbc7 : MOV dword ptr [EBP + -0x10],EAX
007bcbca : CMP EAX,dword ptr [ECX + 0x44]
007bcbcd : JNZ 0x007bcb34
007bcbd3 : XOR EDI,EDI
007bcbd5 : MOV dword ptr [EBP + -0x4],0xffffffff
007bcbdc : CMP dword ptr [EBP + -0x18],EDI
007bcbdf : JZ 0x007bcbee
007bcbe1 : MOV EDX,dword ptr [EBP + -0x24]
007bcbe4 : PUSH EDX
007bcbe5 : CALL dword ptr [0x00b8511c]
007bcbeb : MOV dword ptr [EBP + -0x18],EDI
007bcbee : MOV ECX,dword ptr [EBP + -0xc]
007bcbf1 : MOV dword ptr FS:[0x0],ECX
007bcbf8 : POP ECX
007bcbf9 : POP EDI
007bcbfa : POP ESI
007bcbfb : POP EBX
007bcbfc : MOV ESP,EBP
007bcbfe : POP EBP
007bcbff : RET 0x8
007bcc02 : MOV CX,BX
007bcc05 : CMP CX,word ptr [EAX]
007bcc08 : SBB EAX,EAX
007bcc0a : AND EAX,0xfffffffe
007bcc0d : ADD EAX,0x1
007bcc10 : JZ 0x007bcb87
007bcc16 : MOV EBX,dword ptr [EBP + 0xc]
007bcc19 : JMP 0x007bcb9a

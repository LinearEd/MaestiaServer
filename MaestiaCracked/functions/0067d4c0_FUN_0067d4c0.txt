PROGRAM  : Maestia.exe
FUNCTION : FUN_0067d4c0
ENTRY    : 0067d4c0
BODY     : [[0067d4c0, 0067d627]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0067d4c0(uint param_1,uint param_2)

{
  ushort uVar1;
  undefined4 uVar2;
  LONG LVar3;
  int in_ECX;
  ushort uVar4;
  uint uVar5;
  undefined4 *puVar6;
  undefined *puVar7;
  uint local_14;
  void *local_10 [2];
  undefined4 local_8;
  uint local_4;
  
  uVar5 = param_2;
  FUN_0051c6b0(param_2);
  uVar1 = *(ushort *)(param_1 + 0x10);
  uVar4 = uVar1 & 0xfff;
  uVar2 = 0x1000000;
  local_8 = 0x1000000;
  if (uVar4 == 0x409) {
    uVar2 = 0x10000000;
    local_8 = 0x10000000;
  }
  if (uVar4 == 0x404) {
    uVar2 = 9;
    local_8 = 9;
  }
  if (uVar4 == 0x804) {
    uVar2 = 0x80000;
    local_8 = 0x80000;
  }
  if (uVar4 == 0x412) {
    uVar2 = 0x2000;
    local_8 = 0x2000;
  }
  if (uVar4 == 0x411) {
    uVar2 = 0x400;
    local_8 = 0x400;
  }
  *(undefined4 *)(in_ECX + 0x44) = uVar2;
  local_4 = (uint)uVar1;
  local_10[0] = (void *)FUN_00515840((*(uint *)(param_2 & 0xfffffffc) & 0x7fffffff) + 1,0);
  _memcpy(local_10[0],(uint *)(param_2 & 0xfffffffc) + 2,
          (*(uint *)(param_2 & 0xfffffffc) & 0x7fffffff) + 1);
  FUN_0067c610(local_10);
  puVar7 = &DAT_00bd6690;
  puVar6 = &param_1;
  FUN_0051c6b0(uVar5);
  uVar2 = FUN_0051c6e0(puVar6,puVar7);
  FUN_0051bd70(uVar2);
  uVar5 = param_1 & 0xfffffffc;
  LVar3 = InterlockedExchangeAdd((LONG *)(uVar5 + 4),-1);
  if (LVar3 == 1) {
    FUN_00515cf0(uVar5);
  }
  LVar3 = InterlockedExchangeAdd((LONG *)((local_14 & 0xfffffffc) + 4),-1);
  if (LVar3 == 1) {
    FUN_00515cf0(local_14 & 0xfffffffc);
  }
  *(int *)(in_ECX + 0x40) = *(int *)(in_ECX + 0x40) + 1;
  uVar5 = param_2 & 0xfffffffc;
  LVar3 = InterlockedExchangeAdd((LONG *)(uVar5 + 4),-1);
  if (LVar3 == 1) {
    FUN_00515cf0(uVar5);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
0067d4c0 : SUB ESP,0x14
0067d4c3 : PUSH EBX
0067d4c4 : PUSH ESI
0067d4c5 : MOV ESI,dword ptr [ESP + 0x24]
0067d4c9 : PUSH EDI
0067d4ca : MOV EDI,ECX
0067d4cc : PUSH ESI
0067d4cd : LEA ECX,[ESP + 0x2c]
0067d4d1 : CALL 0x0051c6b0
0067d4d6 : MOV ECX,dword ptr [ESP + 0x24]
0067d4da : MOVZX ECX,word ptr [ECX + 0x10]
0067d4de : MOV EDX,ECX
0067d4e0 : AND EDX,0xfff
0067d4e6 : MOV EBX,0x409
0067d4eb : MOV EAX,0x1000000
0067d4f0 : MOV dword ptr [ESP + 0x18],EAX
0067d4f4 : CMP DX,BX
0067d4f7 : JNZ 0x0067d502
0067d4f9 : MOV EAX,0x10000000
0067d4fe : MOV dword ptr [ESP + 0x18],EAX
0067d502 : MOV EBX,0x404
0067d507 : CMP DX,BX
0067d50a : JNZ 0x0067d515
0067d50c : MOV EAX,0x9
0067d511 : MOV dword ptr [ESP + 0x18],EAX
0067d515 : MOV EBX,0x804
0067d51a : CMP DX,BX
0067d51d : JNZ 0x0067d528
0067d51f : MOV EAX,0x80000
0067d524 : MOV dword ptr [ESP + 0x18],EAX
0067d528 : MOV EBX,0x412
0067d52d : CMP DX,BX
0067d530 : JNZ 0x0067d53b
0067d532 : MOV EAX,0x2000
0067d537 : MOV dword ptr [ESP + 0x18],EAX
0067d53b : MOV EBX,0x411
0067d540 : CMP DX,BX
0067d543 : JNZ 0x0067d54e
0067d545 : MOV EAX,0x400
0067d54a : MOV dword ptr [ESP + 0x18],EAX
0067d54e : MOV dword ptr [EDI + 0x44],EAX
0067d551 : MOV EAX,dword ptr [ESP + 0x28]
0067d555 : AND EAX,0xfffffffc
0067d558 : MOV EAX,dword ptr [EAX]
0067d55a : MOVZX EDX,CX
0067d55d : MOV ECX,dword ptr [0x00d73250]
0067d563 : AND EAX,0x7fffffff
0067d568 : PUSH 0x0
0067d56a : INC EAX
0067d56b : PUSH EAX
0067d56c : MOV dword ptr [ESP + 0x24],EDX
0067d570 : CALL 0x00515840
0067d575 : MOV ECX,dword ptr [ESP + 0x28]
0067d579 : AND ECX,0xfffffffc
0067d57c : MOV EDX,dword ptr [ECX]
0067d57e : AND EDX,0x7fffffff
0067d584 : INC EDX
0067d585 : PUSH EDX
0067d586 : ADD ECX,0x8
0067d589 : PUSH ECX
0067d58a : PUSH EAX
0067d58b : MOV dword ptr [ESP + 0x1c],EAX
0067d58f : CALL 0x0063ae40
0067d594 : ADD ESP,0xc
0067d597 : LEA EAX,[ESP + 0x10]
0067d59b : PUSH EAX
0067d59c : LEA ECX,[EDI + 0x4c]
0067d59f : CALL 0x0067c610
0067d5a4 : PUSH 0xbd6690
0067d5a9 : LEA ECX,[ESP + 0x28]
0067d5ad : PUSH ECX
0067d5ae : PUSH ESI
0067d5af : LEA ECX,[ESP + 0x18]
0067d5b3 : CALL 0x0051c6b0
0067d5b8 : MOV ECX,EAX
0067d5ba : CALL 0x0051c6e0
0067d5bf : PUSH EAX
0067d5c0 : LEA ECX,[EDI + 0x38]
0067d5c3 : CALL 0x0051bd70
0067d5c8 : MOV ESI,dword ptr [ESP + 0x24]
0067d5cc : MOV EBX,dword ptr [0x00b851cc]
0067d5d2 : AND ESI,0xfffffffc
0067d5d5 : PUSH -0x1
0067d5d7 : LEA EDX,[ESI + 0x4]
0067d5da : PUSH EDX
0067d5db : CALL EBX
0067d5dd : SUB EAX,0x1
0067d5e0 : JNZ 0x0067d5e8
0067d5e2 : PUSH ESI
0067d5e3 : CALL 0x00515cf0
0067d5e8 : MOV ESI,dword ptr [ESP + 0xc]
0067d5ec : AND ESI,0xfffffffc
0067d5ef : PUSH -0x1
0067d5f1 : LEA EAX,[ESI + 0x4]
0067d5f4 : PUSH EAX
0067d5f5 : CALL EBX
0067d5f7 : SUB EAX,0x1
0067d5fa : JNZ 0x0067d602
0067d5fc : PUSH ESI
0067d5fd : CALL 0x00515cf0
0067d602 : MOV ESI,dword ptr [ESP + 0x28]
0067d606 : INC dword ptr [EDI + 0x40]
0067d609 : AND ESI,0xfffffffc
0067d60c : PUSH -0x1
0067d60e : LEA ECX,[ESI + 0x4]
0067d611 : PUSH ECX
0067d612 : CALL EBX
0067d614 : SUB EAX,0x1
0067d617 : JNZ 0x0067d61f
0067d619 : PUSH ESI
0067d61a : CALL 0x00515cf0
0067d61f : POP EDI
0067d620 : POP ESI
0067d621 : POP EBX
0067d622 : ADD ESP,0x14
0067d625 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_00829410
ENTRY    : 00829410
BODY     : [[00829410, 00829741]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00829410(int param_1)

{
  int iVar1;
  DWORD DVar2;
  BOOL BVar3;
  
  FUN_008018d0(L"##############[AvaGame::ClearGame Start (logout %d, gotolobby %d, call depth %d)!!]##############"
               ,*(undefined1 *)(param_1 + 0x339),*(undefined1 *)(param_1 + 0x33a),DAT_017274f4);
  if (DAT_017274f4 != 0) {
    FUN_008018d0(L"[AvaGame::ClearGame Start] recursive call! skip!");
    return;
  }
  DAT_017274f4 = 1;
  if (*(char *)(param_1 + 0x339) == '\0') {
    DAT_00d70534 = 0;
  }
  if (((*DAT_00da9894 != 0) && (iVar1 = *(int *)(*DAT_00da9894 + 0x114), iVar1 != 0)) &&
     (*(int *)(iVar1 + 4) == 0)) {
    FUN_008018d0(L"[AvaGame::ClearGame] main flash loading failed");
    DAT_017274f4 = 0;
    return;
  }
  if (*(HANDLE *)(param_1 + 0x4ec) != (HANDLE)0x0) {
    DVar2 = WaitForSingleObject(*(HANDLE *)(param_1 + 0x4ec),100);
    if (DVar2 == 0) {
      BVar3 = CloseHandle(*(HANDLE *)(param_1 + 0x4ec));
      if (BVar3 == 0) {
        FUN_008018d0(L"PIXELTRACKING CloseHandle Error");
      }
    }
    *(undefined4 *)(param_1 + 0x4ec) = 0;
  }
  if (*(int *)(DAT_017251b8 + 0x54) != 0) {
    FUN_007f0900(DAT_017251b8);
  }
  FUN_007bda30();
  if (*(int *)(param_1 + 0x17c) != 0) {
    FUN_0088b060();
  }
  if ((*(int *)(param_1 + 0xdc) != 0) &&
     (iVar1 = *(int *)(*(int *)(param_1 + 0xdc) + 0x41c), iVar1 != 0)) {
    FUN_0087c380(iVar1,0);
  }
  iVar1 = *(int *)(param_1 + 0x94);
  *(undefined1 *)(iVar1 + 0x210) = 0;
  *(undefined1 *)(iVar1 + 0x211) = 0;
  *(undefined1 *)(iVar1 + 0x154) = 1;
  *(undefined1 *)(param_1 + 0x344) = 1;
  if (*(char *)(param_1 + 0x33a) == '\0') {
    FUN_00822ea0(1);
  }
  FUN_00846b00(param_1 + 0x188);
  FUN_008422d0(0xffffffff);
  *(undefined4 *)(param_1 + 200) = 0;
  *(undefined4 *)(param_1 + 0x164) = 0;
  *(undefined4 *)(param_1 + 0x374) = 0;
  *(undefined1 *)(param_1 + 0x4e4) = 0;
  *(undefined1 *)(param_1 + 0x342) = 0;
  if (param_1 != -0x510) {
    FUN_00828a60();
  }
  if (*(char *)(param_1 + 0x339) != '\0') {
    if (*(int **)(param_1 + 0xdc) != (int *)0x0) {
      (**(code **)(**(int **)(param_1 + 0xdc) + 8))(1);
      *(undefined4 *)(param_1 + 0xdc) = 0;
    }
    iVar1 = *(int *)(param_1 + 0x17c);
    if (iVar1 != 0) {
      (**(code **)(*(int *)(*(int *)(*(int *)(iVar1 + 0x138) + 4) + 0x138 + iVar1) + 0xc))(1);
      *(undefined4 *)(param_1 + 0x17c) = 0;
    }
    iVar1 = *(int *)(param_1 + 0x174);
    if (iVar1 != 0) {
      (**(code **)(*(int *)(*(int *)(*(int *)(iVar1 + 0x138) + 4) + 0x138 + iVar1) + 0xc))(1);
      *(undefined4 *)(param_1 + 0x174) = 0;
    }
    iVar1 = *(int *)(param_1 + 0x178);
    if (iVar1 != 0) {
      (**(code **)(*(int *)(*(int *)(*(int *)(iVar1 + 0x138) + 4) + 0x138 + iVar1) + 0xc))(1);
      *(undefined4 *)(param_1 + 0x178) = 0;
    }
    iVar1 = *(int *)(param_1 + 0x180);
    if (iVar1 != 0) {
      (**(code **)(*(int *)(*(int *)(*(int *)(iVar1 + 0x138) + 4) + 0x138 + iVar1) + 0xc))(1);
      *(undefined4 *)(param_1 + 0x180) = 0;
    }
    if (*(undefined4 **)(param_1 + 0x184) != (undefined4 *)0x0) {
      (**(code **)**(undefined4 **)(param_1 + 0x184))(1);
      *(undefined4 *)(param_1 + 0x184) = 0;
    }
    if (*(int *)(param_1 + 0x158) != 0) {
      *(undefined1 *)(*(int *)(param_1 + 0x158) + 8) = 1;
    }
    FUN_008018d0(L"##############[AvaGame::ClearGame End!!]##############");
    if (*(char *)(param_1 + 0x33a) == '\0') {
      FUN_00829050(param_1,2);
    }
    *(undefined1 *)(param_1 + 0x33a) = 0;
    *(undefined1 *)(param_1 + 0x339) = 0;
    *(undefined1 *)(param_1 + 0x344) = 0;
    DAT_017274f4 = 0;
    return;
  }
  if (*(int *)(param_1 + 0x148) != 0) {
    FUN_0089fce0();
  }
  *(undefined1 *)(param_1 + 0x343) = 1;
  FUN_0081f780();
  FUN_008018d0(L"##############[AvaGame::ClearGame End!!]##############");
  PostQuitMessage(0);
  DAT_017274f4 = 0;
  return;
}



============================================================
DISASSEMBLY
============================================================
00829410 : PUSH EBP
00829411 : MOV EBP,ESP
00829413 : MOV EAX,[0x017274f4]
00829418 : PUSH EBX
00829419 : MOV EBX,dword ptr [EBP + 0x8]
0082941c : MOVZX ECX,byte ptr [EBX + 0x33a]
00829423 : MOVZX EDX,byte ptr [EBX + 0x339]
0082942a : PUSH ESI
0082942b : MOV ESI,dword ptr [0x00da98e8]
00829431 : PUSH EDI
00829432 : PUSH EAX
00829433 : PUSH ECX
00829434 : PUSH EDX
00829435 : PUSH 0xc338d8
0082943a : CALL 0x008018d0
0082943f : XOR EDI,EDI
00829441 : ADD ESP,0x10
00829444 : CMP dword ptr [0x017274f4],EDI
0082944a : JZ 0x00829466
0082944c : MOV ESI,dword ptr [0x00da98e8]
00829452 : PUSH 0xc339c8
00829457 : CALL 0x008018d0
0082945c : ADD ESP,0x4
0082945f : POP EDI
00829460 : POP ESI
00829461 : POP EBX
00829462 : POP EBP
00829463 : RET 0x4
00829466 : CMP byte ptr [EBX + 0x339],0x0
0082946d : MOV dword ptr [0x017274f4],0x1
00829477 : JNZ 0x0082947f
00829479 : MOV dword ptr [0x00d70534],EDI
0082947f : MOV EAX,[0x00da9894]
00829484 : MOV EAX,dword ptr [EAX]
00829486 : CMP EAX,EDI
00829488 : JZ 0x008294b9
0082948a : MOV EAX,dword ptr [EAX + 0x114]
00829490 : CMP EAX,EDI
00829492 : JZ 0x008294b9
00829494 : CMP dword ptr [EAX + 0x4],EDI
00829497 : JNZ 0x008294b9
00829499 : MOV ESI,dword ptr [0x00da98e8]
0082949f : PUSH 0xc33a30
008294a4 : CALL 0x008018d0
008294a9 : ADD ESP,0x4
008294ac : MOV dword ptr [0x017274f4],EDI
008294b2 : POP EDI
008294b3 : POP ESI
008294b4 : POP EBX
008294b5 : POP EBP
008294b6 : RET 0x4
008294b9 : MOV EAX,dword ptr [EBX + 0x4ec]
008294bf : CMP EAX,EDI
008294c1 : JZ 0x008294fa
008294c3 : PUSH 0x64
008294c5 : PUSH EAX
008294c6 : CALL dword ptr [0x00b85100]
008294cc : TEST EAX,EAX
008294ce : JNZ 0x008294f4
008294d0 : MOV ECX,dword ptr [EBX + 0x4ec]
008294d6 : PUSH ECX
008294d7 : CALL dword ptr [0x00b85104]
008294dd : TEST EAX,EAX
008294df : JNZ 0x008294f4
008294e1 : MOV ESI,dword ptr [0x00da98e8]
008294e7 : PUSH 0xc33a90
008294ec : CALL 0x008018d0
008294f1 : ADD ESP,0x4
008294f4 : MOV dword ptr [EBX + 0x4ec],EDI
008294fa : MOV EAX,[0x017251b8]
008294ff : CMP dword ptr [EAX + 0x54],EDI
00829502 : JZ 0x0082950a
00829504 : PUSH EAX
00829505 : CALL 0x007f0900
0082950a : MOV EDI,dword ptr [0x01725208]
00829510 : CALL 0x007bda30
00829515 : MOV EDI,dword ptr [EBX + 0x17c]
0082951b : XOR ESI,ESI
0082951d : CMP EDI,ESI
0082951f : JZ 0x00829526
00829521 : CALL 0x0088b060
00829526 : MOV EAX,dword ptr [EBX + 0xdc]
0082952c : CMP EAX,ESI
0082952e : JZ 0x00829541
00829530 : MOV EAX,dword ptr [EAX + 0x41c]
00829536 : CMP EAX,ESI
00829538 : JZ 0x00829541
0082953a : PUSH ESI
0082953b : PUSH EAX
0082953c : CALL 0x0087c380
00829541 : MOV EAX,dword ptr [EBX + 0x94]
00829547 : MOV byte ptr [EAX + 0x210],0x0
0082954e : MOV byte ptr [EAX + 0x211],0x0
00829555 : MOV byte ptr [EAX + 0x154],0x1
0082955c : CMP byte ptr [EBX + 0x33a],0x0
00829563 : MOV byte ptr [EBX + 0x344],0x1
0082956a : JNZ 0x00829575
0082956c : PUSH 0x1
0082956e : MOV ECX,EBX
00829570 : CALL 0x00822ea0
00829575 : LEA EDX,[EBX + 0x188]
0082957b : PUSH EDX
0082957c : CALL 0x00846b00
00829581 : PUSH -0x1
00829583 : LEA ECX,[EBX + 0x1bc]
00829589 : CALL 0x008422d0
0082958e : LEA EDX,[EBX + 0x510]
00829594 : MOV dword ptr [EBX + 0xc8],ESI
0082959a : MOV dword ptr [EBX + 0x164],ESI
008295a0 : MOV dword ptr [EBX + 0x374],ESI
008295a6 : MOV byte ptr [EBX + 0x4e4],0x0
008295ad : MOV byte ptr [EBX + 0x342],0x0
008295b4 : CMP EDX,ESI
008295b6 : JZ 0x008295bf
008295b8 : MOV ECX,EBX
008295ba : CALL 0x00828a60
008295bf : CMP byte ptr [EBX + 0x339],0x0
008295c6 : JZ 0x008296f9
008295cc : MOV ECX,dword ptr [EBX + 0xdc]
008295d2 : CMP ECX,ESI
008295d4 : JZ 0x008295e5
008295d6 : MOV EAX,dword ptr [ECX]
008295d8 : MOV EDX,dword ptr [EAX + 0x8]
008295db : PUSH 0x1
008295dd : CALL EDX
008295df : MOV dword ptr [EBX + 0xdc],ESI
008295e5 : MOV EAX,dword ptr [EBX + 0x17c]
008295eb : CMP EAX,ESI
008295ed : JZ 0x0082960e
008295ef : MOV ECX,dword ptr [EAX + 0x138]
008295f5 : MOV EDX,dword ptr [ECX + 0x4]
008295f8 : LEA ECX,[EDX + EAX*0x1 + 0x138]
008295ff : MOV EAX,dword ptr [ECX]
00829601 : MOV EDX,dword ptr [EAX + 0xc]
00829604 : PUSH 0x1
00829606 : CALL EDX
00829608 : MOV dword ptr [EBX + 0x17c],ESI
0082960e : MOV EAX,dword ptr [EBX + 0x174]
00829614 : CMP EAX,ESI
00829616 : JZ 0x00829637
00829618 : MOV ECX,dword ptr [EAX + 0x138]
0082961e : MOV EDX,dword ptr [ECX + 0x4]
00829621 : LEA ECX,[EDX + EAX*0x1 + 0x138]
00829628 : MOV EAX,dword ptr [ECX]
0082962a : MOV EDX,dword ptr [EAX + 0xc]
0082962d : PUSH 0x1
0082962f : CALL EDX
00829631 : MOV dword ptr [EBX + 0x174],ESI
00829637 : MOV EAX,dword ptr [EBX + 0x178]
0082963d : CMP EAX,ESI
0082963f : JZ 0x00829660
00829641 : MOV ECX,dword ptr [EAX + 0x138]
00829647 : MOV EDX,dword ptr [ECX + 0x4]
0082964a : LEA ECX,[EDX + EAX*0x1 + 0x138]
00829651 : MOV EAX,dword ptr [ECX]
00829653 : MOV EDX,dword ptr [EAX + 0xc]
00829656 : PUSH 0x1
00829658 : CALL EDX
0082965a : MOV dword ptr [EBX + 0x178],ESI
00829660 : MOV EAX,dword ptr [EBX + 0x180]
00829666 : CMP EAX,ESI
00829668 : JZ 0x00829689
0082966a : MOV ECX,dword ptr [EAX + 0x138]
00829670 : MOV EDX,dword ptr [ECX + 0x4]
00829673 : LEA ECX,[EDX + EAX*0x1 + 0x138]
0082967a : MOV EAX,dword ptr [ECX]
0082967c : MOV EDX,dword ptr [EAX + 0xc]
0082967f : PUSH 0x1
00829681 : CALL EDX
00829683 : MOV dword ptr [EBX + 0x180],ESI
00829689 : MOV ECX,dword ptr [EBX + 0x184]
0082968f : CMP ECX,ESI
00829691 : JZ 0x008296a1
00829693 : MOV EAX,dword ptr [ECX]
00829695 : MOV EDX,dword ptr [EAX]
00829697 : PUSH 0x1
00829699 : CALL EDX
0082969b : MOV dword ptr [EBX + 0x184],ESI
008296a1 : MOV EAX,dword ptr [EBX + 0x158]
008296a7 : CMP EAX,ESI
008296a9 : JZ 0x008296af
008296ab : MOV byte ptr [EAX + 0x8],0x1
008296af : MOV ESI,dword ptr [0x00da98e8]
008296b5 : PUSH 0xc33ad0
008296ba : CALL 0x008018d0
008296bf : ADD ESP,0x4
008296c2 : CMP byte ptr [EBX + 0x33a],0x0
008296c9 : JNZ 0x008296d3
008296cb : PUSH 0x2
008296cd : PUSH EBX
008296ce : CALL 0x00829050
008296d3 : MOV byte ptr [EBX + 0x33a],0x0
008296da : MOV byte ptr [EBX + 0x339],0x0
008296e1 : MOV byte ptr [EBX + 0x344],0x0
008296e8 : MOV dword ptr [0x017274f4],0x0
008296f2 : POP EDI
008296f3 : POP ESI
008296f4 : POP EBX
008296f5 : POP EBP
008296f6 : RET 0x4
008296f9 : MOV EDI,dword ptr [EBX + 0x148]
008296ff : CMP EDI,ESI
00829701 : JZ 0x00829708
00829703 : CALL 0x0089fce0
00829708 : MOV ESI,EBX
0082970a : MOV byte ptr [EBX + 0x343],0x1
00829711 : CALL 0x0081f780
00829716 : MOV ESI,dword ptr [0x00da98e8]
0082971c : PUSH 0xc33b40
00829721 : CALL 0x008018d0
00829726 : ADD ESP,0x4
00829729 : PUSH 0x0
0082972b : CALL dword ptr [0x00b854a0]
00829731 : POP EDI
00829732 : POP ESI
00829733 : MOV dword ptr [0x017274f4],0x0
0082973d : POP EBX
0082973e : POP EBP
0082973f : RET 0x4

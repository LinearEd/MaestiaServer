PROGRAM  : Maestia.exe
FUNCTION : FUN_00a09100
ENTRY    : 00a09100
BODY     : [[00a09100, 00a091f8]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a09100(int param_1,int param_2)

{
  undefined4 uVar1;
  void *pvVar2;
  void **ppvVar3;
  uint uVar4;
  uint8_t *packet;
  int iVar5;
  byte bVar6;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  pvVar2 = ExceptionList;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4d040;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  if (param_2 != 0) {
    if (param_1 == 0) {
      iVar5 = *(int *)ThreadLocalStoragePointer;
      bVar6 = (byte)((ulonglong)(*(byte *)(iVar5 + 0x18) + 1) % 3);
      ExceptionList = &local_10;
      *(byte *)(iVar5 + 0x18) = bVar6;
      packet = (uint8_t *)((uint)bVar6 * 0x2000 + 0x122cb8 + iVar5);
      if (packet == (uint8_t *)0x0) {
        packet = (uint8_t *)0x0;
      }
      else {
        uVar1 = *(undefined4 *)(param_2 + 0xc);
        packet[0] = '\0';
        packet[1] = '\0';
        packet[2] = '6';
        packet[3] = 0xe1;
        *(undefined4 *)(packet + 4) = uVar1;
        packet[8] = '\x02';
      }
      local_8 = 0xffffffff;
      if (*(int *)(DAT_017247d4 + 4) == 0) {
        ExceptionList = pvVar2;
        return;
      }
      if (*(char *)(DAT_017247d4 + 8) == '\0') {
        ExceptionList = pvVar2;
        return;
      }
      iVar5 = FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),9,packet);
      ppvVar3 = ExceptionList;
      if (iVar5 == 0) {
        ExceptionList = local_10;
        return;
      }
    }
    else {
      ppvVar3 = &local_10;
      if (param_1 != 1) {
        return;
      }
    }
    ExceptionList = ppvVar3;
    if ((*DAT_00da9894 != 0) && (iVar5 = *(int *)(*DAT_00da9894 + 0x128), iVar5 != 0)) {
      FUN_0097fca0(iVar5);
      FUN_0097fa60(uVar4);
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00a09100 : PUSH EBP
00a09101 : MOV EBP,ESP
00a09103 : PUSH -0x1
00a09105 : PUSH 0xb4d040
00a0910a : MOV EAX,FS:[0x0]
00a09110 : PUSH EAX
00a09111 : PUSH ESI
00a09112 : PUSH EDI
00a09113 : MOV EAX,[0x00d66fa0]
00a09118 : XOR EAX,EBP
00a0911a : PUSH EAX
00a0911b : LEA EAX,[EBP + -0xc]
00a0911e : MOV FS:[0x0],EAX
00a09124 : MOV ESI,dword ptr [EBP + 0xc]
00a09127 : TEST ESI,ESI
00a09129 : JZ 0x00a091e6
00a0912f : MOV EAX,dword ptr [EBP + 0x8]
00a09132 : SUB EAX,0x0
00a09135 : JZ 0x00a09142
00a09137 : SUB EAX,0x1
00a0913a : JNZ 0x00a091e6
00a09140 : JMP 0x00a091b8
00a09142 : MOV EAX,FS:[0x2c]
00a09148 : MOV ECX,dword ptr [EAX]
00a0914a : MOVZX EAX,byte ptr [ECX + 0x18]
00a0914e : INC EAX
00a0914f : CDQ
00a09150 : MOV EDI,0x3
00a09155 : IDIV EDI
00a09157 : MOV byte ptr [ECX + 0x18],DL
00a0915a : MOVZX EDX,DL
00a0915d : SHL EDX,0xd
00a09160 : LEA EAX,[EDX + ECX*0x1 + 0x122cb8]
00a09167 : MOV dword ptr [EBP + 0xc],EAX
00a0916a : MOV dword ptr [EBP + -0x4],0x0
00a09171 : TEST EAX,EAX
00a09173 : JZ 0x00a0918e
00a09175 : MOV ECX,dword ptr [ESI + 0xc]
00a09178 : XOR EDX,EDX
00a0917a : MOV word ptr [EAX],DX
00a0917d : MOV byte ptr [EAX + 0x2],0x36
00a09181 : MOV byte ptr [EAX + 0x3],0xe1
00a09185 : MOV dword ptr [EAX + 0x4],ECX
00a09188 : MOV byte ptr [EAX + 0x8],0x2
00a0918c : JMP 0x00a09190
00a0918e : XOR EAX,EAX
00a09190 : MOV dword ptr [EBP + -0x4],0xffffffff
00a09197 : MOV EDX,dword ptr [0x017247d4]
00a0919d : MOV ECX,dword ptr [EDX + 0x4]
00a091a0 : TEST ECX,ECX
00a091a2 : JZ 0x00a091e6
00a091a4 : CMP byte ptr [EDX + 0x8],0x0
00a091a8 : JZ 0x00a091e6
00a091aa : PUSH 0x9
00a091ac : PUSH ECX
00a091ad : MOV EDI,EAX
00a091af : CALL 0x00a0dd40
00a091b4 : TEST EAX,EAX
00a091b6 : JZ 0x00a091e6
00a091b8 : MOV EAX,[0x00da9894]
00a091bd : MOV EAX,dword ptr [EAX]
00a091bf : TEST EAX,EAX
00a091c1 : JZ 0x00a091e6
00a091c3 : MOV EAX,dword ptr [EAX + 0x128]
00a091c9 : TEST EAX,EAX
00a091cb : JZ 0x00a091e6
00a091cd : PUSH EAX
00a091ce : CALL 0x0097fca0
00a091d3 : MOV ECX,dword ptr [0x00da9894]
00a091d9 : MOV EDX,dword ptr [ECX]
00a091db : MOV ECX,dword ptr [EDX + 0x128]
00a091e1 : CALL 0x0097fa60
00a091e6 : MOV ECX,dword ptr [EBP + -0xc]
00a091e9 : MOV dword ptr FS:[0x0],ECX
00a091f0 : POP ECX
00a091f1 : POP EDI
00a091f2 : POP ESI
00a091f3 : MOV ESP,EBP
00a091f5 : POP EBP
00a091f6 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_007f0900
ENTRY    : 007f0900
BODY     : [[007f0900, 007f0a11]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007f0900(int param_1)

{
  int *piVar1;
  DWORD DVar2;
  int *piVar3;
  int iVar4;
  undefined1 *puVar5;
  undefined1 auStack_10 [4];
  undefined1 auStack_c [8];
  
  piVar3 = (int *)**(int **)(param_1 + 0x50);
  if (piVar3 != *(int **)(param_1 + 0x50)) {
    do {
      piVar1 = *(int **)((int)piVar3 + 0x10);
      if (*(char *)(*(int *)(param_1 + 0x10) + 0x318) == '\0') {
        if (piVar1 != (int *)0x0) {
          (**(code **)(*piVar1 + 0xc))(1);
        }
        puVar5 = auStack_c;
LAB_007f09d0:
        piVar3 = (int *)FUN_0040f040(param_1 + 0x4c,puVar5,piVar3);
        piVar3 = (int *)*piVar3;
      }
      else {
        (**(code **)(*piVar1 + 0x34))();
        (**(code **)(**(int **)((int)piVar3 + 0x10) + 0x38))(0xffffffff);
        (**(code **)(**(int **)((int)piVar3 + 0x10) + 0x10))();
        iVar4 = *(int *)((int)piVar3 + 0x10);
        DVar2 = WaitForSingleObject(*(HANDLE *)(iVar4 + 4),0xffffffff);
        if (*(uint *)(iVar4 + 0x34) < 8) {
          iVar4 = iVar4 + 0x20;
        }
        else {
          iVar4 = *(int *)(iVar4 + 0x20);
        }
        FUN_008018d0(L"[AvaThreadControl::Terminate]: WaitFor Thread (%s) , Result(%d)",iVar4,DVar2)
        ;
        piVar1 = *(int **)((int)piVar3 + 0x10);
        if (piVar1[4] != 0) {
          if (piVar1 != (int *)0x0) {
            (**(code **)(*piVar1 + 0xc))(1);
          }
          puVar5 = auStack_10;
          goto LAB_007f09d0;
        }
        FUN_008018d0(L"[AvaLibMain::DetachAllBgLoader] BGLoader Not Exited");
      }
    } while (piVar3 != (int *)*(int *)(param_1 + 0x50));
  }
  FUN_00401c00(*(undefined4 *)(*(int *)(param_1 + 0x50) + 4));
  *(int *)(*(int *)(param_1 + 0x50) + 4) = *(int *)(param_1 + 0x50);
  *(undefined4 *)(param_1 + 0x54) = 0;
  *(undefined4 *)*(undefined4 *)(param_1 + 0x50) = *(undefined4 *)(param_1 + 0x50);
  *(int *)(*(int *)(param_1 + 0x50) + 8) = *(int *)(param_1 + 0x50);
  return;
}



============================================================
DISASSEMBLY
============================================================
007f0900 : PUSH EBP
007f0901 : MOV EBP,ESP
007f0903 : AND ESP,0xfffffff8
007f0906 : SUB ESP,0xc
007f0909 : PUSH EBX
007f090a : MOV EBX,dword ptr [EBP + 0x8]
007f090d : MOV EAX,dword ptr [EBX + 0x50]
007f0910 : PUSH ESI
007f0911 : PUSH EDI
007f0912 : MOV EDI,dword ptr [EAX]
007f0914 : CMP EDI,EAX
007f0916 : JZ 0x007f09e0
007f091c : LEA ESP,[ESP]
007f0920 : MOV EAX,dword ptr [EBX + 0x10]
007f0923 : CMP byte ptr [EAX + 0x318],0x0
007f092a : MOV ECX,dword ptr [EDI + 0x10]
007f092d : JZ 0x007f09b9
007f0933 : MOV EDX,dword ptr [ECX]
007f0935 : MOV EAX,dword ptr [EDX + 0x34]
007f0938 : CALL EAX
007f093a : MOV ECX,dword ptr [EDI + 0x10]
007f093d : MOV EDX,dword ptr [ECX]
007f093f : MOV EAX,dword ptr [EDX + 0x38]
007f0942 : PUSH -0x1
007f0944 : CALL EAX
007f0946 : MOV ECX,dword ptr [EDI + 0x10]
007f0949 : MOV EDX,dword ptr [ECX]
007f094b : MOV EAX,dword ptr [EDX + 0x10]
007f094e : CALL EAX
007f0950 : MOV ESI,dword ptr [EDI + 0x10]
007f0953 : MOV ECX,dword ptr [ESI + 0x4]
007f0956 : PUSH -0x1
007f0958 : PUSH ECX
007f0959 : CALL dword ptr [0x00b85100]
007f095f : CMP dword ptr [ESI + 0x34],0x8
007f0963 : JC 0x007f096a
007f0965 : MOV ESI,dword ptr [ESI + 0x20]
007f0968 : JMP 0x007f096d
007f096a : ADD ESI,0x20
007f096d : PUSH EAX
007f096e : PUSH ESI
007f096f : MOV ESI,dword ptr [0x00da98e8]
007f0975 : PUSH 0xc13788
007f097a : CALL 0x008018d0
007f097f : MOV ECX,dword ptr [EDI + 0x10]
007f0982 : ADD ESP,0xc
007f0985 : CMP dword ptr [ECX + 0x10],0x0
007f0989 : JZ 0x007f09a4
007f098b : TEST ECX,ECX
007f098d : JZ 0x007f0998
007f098f : MOV EDX,dword ptr [ECX]
007f0991 : MOV EAX,dword ptr [EDX + 0xc]
007f0994 : PUSH 0x1
007f0996 : CALL EAX
007f0998 : PUSH EDI
007f0999 : LEA ECX,[ESP + 0x14]
007f099d : PUSH ECX
007f099e : LEA EDX,[EBX + 0x4c]
007f09a1 : PUSH EDX
007f09a2 : JMP 0x007f09d0
007f09a4 : MOV ESI,dword ptr [0x00da98e8]
007f09aa : PUSH 0xc247e0
007f09af : CALL 0x008018d0
007f09b4 : ADD ESP,0x4
007f09b7 : JMP 0x007f09d7
007f09b9 : TEST ECX,ECX
007f09bb : JZ 0x007f09c6
007f09bd : MOV EAX,dword ptr [ECX]
007f09bf : MOV EDX,dword ptr [EAX + 0xc]
007f09c2 : PUSH 0x1
007f09c4 : CALL EDX
007f09c6 : PUSH EDI
007f09c7 : LEA EAX,[ESP + 0x18]
007f09cb : PUSH EAX
007f09cc : LEA ECX,[EBX + 0x4c]
007f09cf : PUSH ECX
007f09d0 : CALL 0x0040f040
007f09d5 : MOV EDI,dword ptr [EAX]
007f09d7 : CMP EDI,dword ptr [EBX + 0x50]
007f09da : JNZ 0x007f0920
007f09e0 : MOV EDX,dword ptr [EBX + 0x50]
007f09e3 : MOV EAX,dword ptr [EDX + 0x4]
007f09e6 : LEA ESI,[EBX + 0x4c]
007f09e9 : PUSH EAX
007f09ea : MOV ECX,ESI
007f09ec : CALL 0x00401c00
007f09f1 : MOV EAX,dword ptr [ESI + 0x4]
007f09f4 : MOV dword ptr [EAX + 0x4],EAX
007f09f7 : MOV EAX,dword ptr [ESI + 0x4]
007f09fa : MOV dword ptr [ESI + 0x8],0x0
007f0a01 : MOV dword ptr [EAX],EAX
007f0a03 : MOV ESI,dword ptr [ESI + 0x4]
007f0a06 : POP EDI
007f0a07 : MOV dword ptr [ESI + 0x8],ESI
007f0a0a : POP ESI
007f0a0b : POP EBX
007f0a0c : MOV ESP,EBP
007f0a0e : POP EBP
007f0a0f : RET 0x4

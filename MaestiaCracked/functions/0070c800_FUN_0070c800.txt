PROGRAM  : Maestia.exe
FUNCTION : FUN_0070c800
ENTRY    : 0070c800
BODY     : [[0070c800, 0070c8be]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0070c800(int param_1)

{
  wchar_t *_FullPath;
  wchar_t local_a20 [1024];
  wchar_t local_220 [128];
  wchar_t local_120 [128];
  wchar_t local_20 [6];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b177ee;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(uint *)(param_1 + 0x14) < 0x401) {
    if (*(uint *)(param_1 + 0x18) < 8) {
      _FullPath = (wchar_t *)(param_1 + 4);
    }
    else {
      _FullPath = *(wchar_t **)(param_1 + 4);
    }
    __wsplitpath(_FullPath,local_20,local_a20,local_120,local_220);
    FUN_00406460(local_120);
  }
  else {
    FUN_00406460(&DAT_00bfd654);
  }
  local_8 = 0;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0070c800 : PUSH EBP
0070c801 : MOV EBP,ESP
0070c803 : PUSH -0x1
0070c805 : PUSH 0xb177ee
0070c80a : MOV EAX,FS:[0x0]
0070c810 : PUSH EAX
0070c811 : SUB ESP,0xa18
0070c817 : MOV EAX,[0x00d66fa0]
0070c81c : XOR EAX,EBP
0070c81e : MOV dword ptr [EBP + -0x10],EAX
0070c821 : PUSH EAX
0070c822 : LEA EAX,[EBP + -0xc]
0070c825 : MOV FS:[0x0],EAX
0070c82b : MOV EAX,dword ptr [EBP + 0x8]
0070c82e : MOV dword ptr [EBP + 0xfffff5e0],0x0
0070c838 : CMP dword ptr [EAX + 0x14],0x400
0070c83f : MOV dword ptr [EBP + 0xfffff5dc],ESI
0070c845 : JBE 0x0070c855
0070c847 : PUSH 0xbfd654
0070c84c : MOV ECX,ESI
0070c84e : CALL 0x00406460
0070c853 : JMP 0x0070c893
0070c855 : CMP dword ptr [EAX + 0x18],0x8
0070c859 : JC 0x0070c860
0070c85b : MOV EAX,dword ptr [EAX + 0x4]
0070c85e : JMP 0x0070c863
0070c860 : ADD EAX,0x4
0070c863 : LEA ECX,[EBP + 0xfffffde4]
0070c869 : PUSH ECX
0070c86a : LEA EDX,[EBP + 0xfffffee4]
0070c870 : PUSH EDX
0070c871 : LEA ECX,[EBP + 0xfffff5e4]
0070c877 : PUSH ECX
0070c878 : LEA EDX,[EBP + -0x1c]
0070c87b : PUSH EDX
0070c87c : PUSH EAX
0070c87d : CALL 0x00636e00
0070c882 : ADD ESP,0x14
0070c885 : LEA EAX,[EBP + 0xfffffee4]
0070c88b : PUSH EAX
0070c88c : MOV ECX,ESI
0070c88e : CALL 0x00406460
0070c893 : MOV dword ptr [EBP + -0x4],0x0
0070c89a : MOV dword ptr [EBP + 0xfffff5e0],0x1
0070c8a4 : MOV EAX,ESI
0070c8a6 : MOV ECX,dword ptr [EBP + -0xc]
0070c8a9 : MOV dword ptr FS:[0x0],ECX
0070c8b0 : POP ECX
0070c8b1 : MOV ECX,dword ptr [EBP + -0x10]
0070c8b4 : XOR ECX,EBP
0070c8b6 : CALL 0x00633e6b
0070c8bb : MOV ESP,EBP
0070c8bd : POP EBP
0070c8be : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00587040
ENTRY    : 00587040
BODY     : [[00587040, 005872da]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00587040(int *param_1,int param_2,int param_3,undefined4 param_4,undefined4 param_5,
                 int param_6,int param_7,byte param_8)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int *local_14c;
  int local_148;
  int local_140 [80];
  
  if ((uint)(param_3 - param_2) < 2) {
    if (((param_8 & 2) == 0) && (param_6 != 0)) {
      FUN_00503db0();
    }
    if (((param_8 & 1) == 0) && (param_7 != 0)) {
      FUN_00503db0();
      return;
    }
    return;
  }
  local_14c = local_140;
  local_148 = param_3;
  do {
    while( true ) {
      iVar6 = param_2 + 1;
      iVar5 = param_2;
      if (local_148 - param_2 < 10) break;
      iVar5 = *param_1;
      uVar2 = *(undefined4 *)(iVar5 + param_2 * 4);
      iVar4 = (local_148 - param_2) / 2 + param_2;
      *(undefined4 *)(iVar5 + param_2 * 4) = *(undefined4 *)(iVar5 + iVar4 * 4);
      *(undefined4 *)(iVar5 + iVar4 * 4) = uVar2;
      iVar4 = local_148 + -1;
      iVar5 = FUN_005862d0(*(undefined4 *)(*param_1 + -4 + local_148 * 4),
                           *(undefined4 *)(*param_1 + iVar6 * 4));
      if (iVar5 < 0) {
        iVar5 = *param_1;
        uVar2 = *(undefined4 *)(iVar5 + iVar4 * 4);
        *(undefined4 *)(iVar5 + iVar4 * 4) = *(undefined4 *)(iVar5 + iVar6 * 4);
        *(undefined4 *)(iVar5 + iVar6 * 4) = uVar2;
      }
      iVar5 = FUN_005862d0(*(undefined4 *)(*param_1 + param_2 * 4),
                           *(undefined4 *)(*param_1 + iVar6 * 4));
      if (iVar5 < 0) {
        iVar5 = *param_1;
        uVar2 = *(undefined4 *)(iVar5 + param_2 * 4);
        *(undefined4 *)(iVar5 + param_2 * 4) = *(undefined4 *)(iVar5 + iVar6 * 4);
        *(undefined4 *)(iVar5 + iVar6 * 4) = uVar2;
      }
      iVar5 = FUN_005862d0(*(undefined4 *)(*param_1 + iVar4 * 4),
                           *(undefined4 *)(*param_1 + param_2 * 4));
      if (iVar5 < 0) {
        iVar5 = *param_1;
        uVar2 = *(undefined4 *)(iVar5 + iVar4 * 4);
        *(undefined4 *)(iVar5 + iVar4 * 4) = *(undefined4 *)(iVar5 + param_2 * 4);
        *(undefined4 *)(iVar5 + param_2 * 4) = uVar2;
      }
      while( true ) {
        do {
          iVar5 = iVar6 * 4;
          iVar6 = iVar6 + 1;
          iVar5 = FUN_005862d0(*(undefined4 *)(*param_1 + 4 + iVar5),
                               *(undefined4 *)(*param_1 + param_2 * 4));
        } while (iVar5 < 0);
        do {
          iVar5 = iVar4 * 4;
          iVar4 = iVar4 + -1;
          iVar5 = FUN_005862d0(*(undefined4 *)(*param_1 + param_2 * 4),
                               *(undefined4 *)(*param_1 + -4 + iVar5));
        } while (iVar5 < 0);
        iVar5 = *param_1;
        uVar2 = *(undefined4 *)(iVar5 + iVar4 * 4);
        if (iVar4 < iVar6) break;
        uVar3 = *(undefined4 *)(iVar5 + iVar6 * 4);
        *(undefined4 *)(iVar5 + iVar6 * 4) = uVar2;
        *(undefined4 *)(iVar5 + iVar4 * 4) = uVar3;
      }
      uVar3 = *(undefined4 *)(iVar5 + param_2 * 4);
      *(undefined4 *)(iVar5 + param_2 * 4) = uVar2;
      *(undefined4 *)(iVar5 + iVar4 * 4) = uVar3;
      if (local_148 - iVar6 < iVar4 - param_2) {
        *local_14c = param_2;
        local_14c[1] = iVar4;
        param_2 = iVar6;
        local_14c = local_14c + 2;
      }
      else {
        *local_14c = iVar6;
        local_14c[1] = local_148;
        local_14c = local_14c + 2;
        local_148 = iVar4;
      }
    }
    while (iVar4 = iVar6, iVar4 < local_148) {
      iVar6 = FUN_005862d0(*(undefined4 *)(*param_1 + iVar5 * 4 + 4),
                           *(undefined4 *)(*param_1 + iVar5 * 4));
      while (iVar6 < 0) {
        iVar6 = *param_1;
        uVar2 = *(undefined4 *)(iVar6 + 4 + iVar5 * 4);
        puVar1 = (undefined4 *)(iVar6 + iVar5 * 4);
        puVar1[1] = *(undefined4 *)(iVar6 + iVar5 * 4);
        *puVar1 = uVar2;
        if (iVar5 == param_2) break;
        iVar5 = iVar5 + -1;
        iVar6 = FUN_005862d0(*(undefined4 *)(*param_1 + iVar5 * 4 + 4),
                             *(undefined4 *)(*param_1 + iVar5 * 4));
      }
      iVar5 = iVar4;
      iVar6 = iVar4 + 1;
    }
    if (local_14c <= local_140) {
      if (((param_8 & 2) == 0) && (param_6 != 0)) {
        FUN_00503db0();
      }
      if ((param_8 & 1) != 0) {
        return;
      }
      if (param_7 == 0) {
        return;
      }
      FUN_00503db0();
      return;
    }
    param_2 = local_14c[-2];
    local_148 = local_14c[-1];
    local_14c = local_14c + -2;
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
00587040 : MOV EAX,dword ptr [ESP + 0xc]
00587044 : SUB ESP,0x14c
0058704a : PUSH EBP
0058704b : MOV EBP,dword ptr [ESP + 0x158]
00587052 : MOV ECX,EAX
00587054 : SUB ECX,EBP
00587056 : CMP ECX,0x2
00587059 : JNC 0x005870a9
0058705b : TEST byte ptr [ESP + 0x170],0x2
00587063 : JNZ 0x00587075
00587065 : MOV ECX,dword ptr [ESP + 0x168]
0058706c : TEST ECX,ECX
0058706e : JZ 0x00587075
00587070 : CALL 0x00503db0
00587075 : TEST byte ptr [ESP + 0x170],0x1
0058707d : MOV dword ptr [ESP + 0x168],0x0
00587088 : JNZ 0x005872d3
0058708e : MOV ECX,dword ptr [ESP + 0x16c]
00587095 : TEST ECX,ECX
00587097 : JZ 0x005872d3
0058709d : POP EBP
0058709e : ADD ESP,0x14c
005870a4 : JMP 0x00503db0
005870a9 : PUSH EBX
005870aa : PUSH ESI
005870ab : MOV ESI,dword ptr [ESP + 0x15c]
005870b2 : PUSH EDI
005870b3 : LEA ECX,[ESP + 0x1c]
005870b7 : MOV dword ptr [ESP + 0x14],EAX
005870bb : MOV dword ptr [ESP + 0x10],ECX
005870bf : NOP
005870c0 : MOV EDX,dword ptr [ESP + 0x14]
005870c4 : MOV EAX,EDX
005870c6 : SUB EAX,EBP
005870c8 : CMP EAX,0x9
005870cb : LEA EBX,[EBP + 0x1]
005870ce : JLE 0x00587211
005870d4 : MOV ECX,dword ptr [ESI]
005870d6 : CDQ
005870d7 : SUB EAX,EDX
005870d9 : MOV EDX,dword ptr [ECX + EBP*0x4]
005870dc : SAR EAX,0x1
005870de : ADD EAX,EBP
005870e0 : MOV EDI,dword ptr [ECX + EAX*0x4]
005870e3 : LEA EAX,[ECX + EAX*0x4]
005870e6 : MOV dword ptr [ECX + EBP*0x4],EDI
005870e9 : MOV EDI,dword ptr [ESP + 0x14]
005870ed : MOV dword ptr [EAX],EDX
005870ef : MOV EAX,dword ptr [ESI]
005870f1 : MOV ECX,dword ptr [EAX + EBX*0x4]
005870f4 : MOV EAX,dword ptr [EAX + EDI*0x4 + -0x4]
005870f8 : DEC EDI
005870f9 : PUSH ECX
005870fa : PUSH EAX
005870fb : LEA ECX,[ESP + 0x174]
00587102 : CALL 0x005862d0
00587107 : TEST EAX,EAX
00587109 : JGE 0x00587119
0058710b : MOV EAX,dword ptr [ESI]
0058710d : MOV EDX,dword ptr [EAX + EBX*0x4]
00587110 : MOV ECX,dword ptr [EAX + EDI*0x4]
00587113 : MOV dword ptr [EAX + EDI*0x4],EDX
00587116 : MOV dword ptr [EAX + EBX*0x4],ECX
00587119 : MOV EAX,dword ptr [ESI]
0058711b : MOV ECX,dword ptr [EAX + EBX*0x4]
0058711e : MOV EAX,dword ptr [EAX + EBP*0x4]
00587121 : PUSH ECX
00587122 : PUSH EAX
00587123 : LEA ECX,[ESP + 0x174]
0058712a : CALL 0x005862d0
0058712f : TEST EAX,EAX
00587131 : JGE 0x00587145
00587133 : MOV EAX,dword ptr [ESI]
00587135 : MOV ECX,dword ptr [EAX + EBP*0x4]
00587138 : MOV EDX,dword ptr [EAX + EBX*0x4]
0058713b : MOV dword ptr [EAX + EBP*0x4],EDX
0058713e : MOV dword ptr [ESP + 0x18],ECX
00587142 : MOV dword ptr [EAX + EBX*0x4],ECX
00587145 : MOV EAX,dword ptr [ESI]
00587147 : MOV ECX,dword ptr [EAX + EBP*0x4]
0058714a : MOV EAX,dword ptr [EAX + EDI*0x4]
0058714d : PUSH ECX
0058714e : PUSH EAX
0058714f : LEA ECX,[ESP + 0x174]
00587156 : CALL 0x005862d0
0058715b : TEST EAX,EAX
0058715d : JGE 0x00587170
0058715f : MOV EAX,dword ptr [ESI]
00587161 : MOV EDX,dword ptr [EAX + EBP*0x4]
00587164 : MOV ECX,dword ptr [EAX + EDI*0x4]
00587167 : MOV dword ptr [EAX + EDI*0x4],EDX
0058716a : MOV dword ptr [EAX + EBP*0x4],ECX
0058716d : LEA ECX,[ECX]
00587170 : MOV EAX,dword ptr [ESI]
00587172 : MOV ECX,dword ptr [EAX + EBP*0x4]
00587175 : MOV EAX,dword ptr [EAX + EBX*0x4 + 0x4]
00587179 : INC EBX
0058717a : PUSH ECX
0058717b : PUSH EAX
0058717c : LEA ECX,[ESP + 0x174]
00587183 : CALL 0x005862d0
00587188 : TEST EAX,EAX
0058718a : JL 0x00587170
0058718c : LEA ESP,[ESP]
00587190 : MOV EAX,dword ptr [ESI]
00587192 : MOV ECX,dword ptr [EAX + EDI*0x4 + -0x4]
00587196 : MOV EAX,dword ptr [EAX + EBP*0x4]
00587199 : DEC EDI
0058719a : PUSH ECX
0058719b : PUSH EAX
0058719c : LEA ECX,[ESP + 0x174]
005871a3 : CALL 0x005862d0
005871a8 : TEST EAX,EAX
005871aa : JL 0x00587190
005871ac : CMP EBX,EDI
005871ae : MOV EAX,dword ptr [ESI]
005871b0 : MOV EDX,dword ptr [EAX + EDI*0x4]
005871b3 : JG 0x005871c0
005871b5 : MOV ECX,dword ptr [EAX + EBX*0x4]
005871b8 : MOV dword ptr [EAX + EBX*0x4],EDX
005871bb : MOV dword ptr [EAX + EDI*0x4],ECX
005871be : JMP 0x00587170
005871c0 : MOV ECX,dword ptr [EAX + EBP*0x4]
005871c3 : MOV dword ptr [EAX + EBP*0x4],EDX
005871c6 : MOV dword ptr [EAX + EDI*0x4],ECX
005871c9 : MOV EAX,dword ptr [ESP + 0x14]
005871cd : MOV dword ptr [ESP + 0x18],ECX
005871d1 : MOV EDX,EAX
005871d3 : MOV ECX,EDI
005871d5 : SUB EDX,EBX
005871d7 : SUB ECX,EBP
005871d9 : CMP ECX,EDX
005871db : JLE 0x005871f6
005871dd : MOV EAX,dword ptr [ESP + 0x10]
005871e1 : ADD dword ptr [ESP + 0x10],0x8
005871e6 : MOV ECX,dword ptr [ESP + 0x10]
005871ea : MOV dword ptr [EAX],EBP
005871ec : MOV dword ptr [EAX + 0x4],EDI
005871ef : MOV EBP,EBX
005871f1 : JMP 0x005870c0
005871f6 : MOV ECX,dword ptr [ESP + 0x10]
005871fa : ADD dword ptr [ESP + 0x10],0x8
005871ff : MOV dword ptr [ECX],EBX
00587201 : MOV dword ptr [ECX + 0x4],EAX
00587204 : MOV ECX,dword ptr [ESP + 0x10]
00587208 : MOV dword ptr [ESP + 0x14],EDI
0058720c : JMP 0x005870c0
00587211 : CMP EBX,EDX
00587213 : MOV EDI,EBP
00587215 : JGE 0x00587274
00587217 : MOV EDX,dword ptr [ESI]
00587219 : MOV ECX,dword ptr [EDX + EDI*0x4]
0058721c : LEA EAX,[EDX + EDI*0x4]
0058721f : MOV EAX,dword ptr [EAX + 0x4]
00587222 : PUSH ECX
00587223 : PUSH EAX
00587224 : LEA ECX,[ESP + 0x174]
0058722b : CALL 0x005862d0
00587230 : TEST EAX,EAX
00587232 : JGE 0x00587267
00587234 : MOV EAX,dword ptr [ESI]
00587236 : MOV EDX,dword ptr [EAX + EDI*0x4]
00587239 : MOV ECX,dword ptr [EAX + EDI*0x4 + 0x4]
0058723d : LEA EAX,[EAX + EDI*0x4]
00587240 : MOV dword ptr [EAX + 0x4],EDX
00587243 : MOV dword ptr [EAX],ECX
00587245 : CMP EDI,EBP
00587247 : JZ 0x00587267
00587249 : MOV EAX,dword ptr [ESI]
0058724b : DEC EDI
0058724c : MOV ECX,dword ptr [EAX + EDI*0x4]
0058724f : LEA EAX,[EAX + EDI*0x4]
00587252 : MOV EAX,dword ptr [EAX + 0x4]
00587255 : PUSH ECX
00587256 : PUSH EAX
00587257 : LEA ECX,[ESP + 0x174]
0058725e : CALL 0x005862d0
00587263 : TEST EAX,EAX
00587265 : JL 0x00587234
00587267 : MOV EDI,EBX
00587269 : INC EBX
0058726a : CMP EBX,dword ptr [ESP + 0x14]
0058726e : JL 0x00587217
00587270 : MOV ECX,dword ptr [ESP + 0x10]
00587274 : LEA EDX,[ESP + 0x1c]
00587278 : CMP ECX,EDX
0058727a : JBE 0x0058728a
0058727c : MOV EBP,dword ptr [ECX + -0x8]
0058727f : MOV EAX,dword ptr [ECX + -0x4]
00587282 : SUB ECX,0x8
00587285 : JMP 0x005870b7
0058728a : TEST byte ptr [ESP + 0x17c],0x2
00587292 : POP EDI
00587293 : POP ESI
00587294 : POP EBX
00587295 : JNZ 0x005872a7
00587297 : MOV ECX,dword ptr [ESP + 0x168]
0058729e : TEST ECX,ECX
005872a0 : JZ 0x005872a7
005872a2 : CALL 0x00503db0
005872a7 : TEST byte ptr [ESP + 0x170],0x1
005872af : MOV dword ptr [ESP + 0x168],0x0
005872ba : JNZ 0x005872d3
005872bc : MOV ECX,dword ptr [ESP + 0x16c]
005872c3 : TEST ECX,ECX
005872c5 : JZ 0x005872d3
005872c7 : POP EBP
005872c8 : ADD ESP,0x14c
005872ce : JMP 0x00503db0
005872d3 : POP EBP
005872d4 : ADD ESP,0x14c
005872da : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_0055cf70
ENTRY    : 0055cf70
BODY     : [[0055cf70, 0055cfe2]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0055cf70(void)

{
  undefined4 *puVar1;
  LONG LVar2;
  int *in_ECX;
  int iVar3;
  uint uVar4;
  int local_8;
  
  if (*in_ECX != 0) {
    iVar3 = 0;
    local_8 = *(int *)(*in_ECX + 4) + 1;
    do {
      puVar1 = (undefined4 *)(iVar3 + 8 + *in_ECX);
      if (*(int *)(iVar3 + 8 + *in_ECX) != -2) {
        uVar4 = puVar1[2] & 0xfffffffc;
        LVar2 = InterlockedExchangeAdd((LONG *)(uVar4 + 4),-1);
        if (LVar2 == 1) {
          FUN_00515cf0(uVar4);
        }
        *puVar1 = 0xfffffffe;
      }
      iVar3 = iVar3 + 0xc;
      local_8 = local_8 + -1;
    } while (local_8 != 0);
    FUN_00515cf0(*in_ECX);
    *in_ECX = 0;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
0055cf70 : SUB ESP,0x8
0055cf73 : PUSH ESI
0055cf74 : MOV ESI,ECX
0055cf76 : MOV EAX,dword ptr [ESI]
0055cf78 : MOV dword ptr [ESP + 0x8],ESI
0055cf7c : TEST EAX,EAX
0055cf7e : JZ 0x0055cfde
0055cf80 : MOV EAX,dword ptr [EAX + 0x4]
0055cf83 : PUSH EBX
0055cf84 : PUSH EBP
0055cf85 : MOV EBP,dword ptr [0x00b851cc]
0055cf8b : XOR EBX,EBX
0055cf8d : INC EAX
0055cf8e : PUSH EDI
0055cf8f : MOV dword ptr [ESP + 0x10],EAX
0055cf93 : MOV EAX,dword ptr [ESI]
0055cf95 : CMP dword ptr [EBX + EAX*0x1 + 0x8],-0x2
0055cf9a : LEA EDI,[EBX + EAX*0x1 + 0x8]
0055cf9e : JZ 0x0055cfc3
0055cfa0 : MOV ESI,dword ptr [EDI + 0x8]
0055cfa3 : AND ESI,0xfffffffc
0055cfa6 : PUSH -0x1
0055cfa8 : LEA ECX,[ESI + 0x4]
0055cfab : PUSH ECX
0055cfac : CALL EBP
0055cfae : SUB EAX,0x1
0055cfb1 : JNZ 0x0055cfb9
0055cfb3 : PUSH ESI
0055cfb4 : CALL 0x00515cf0
0055cfb9 : MOV ESI,dword ptr [ESP + 0x14]
0055cfbd : MOV dword ptr [EDI],0xfffffffe
0055cfc3 : ADD EBX,0xc
0055cfc6 : SUB dword ptr [ESP + 0x10],0x1
0055cfcb : JNZ 0x0055cf93
0055cfcd : MOV EDX,dword ptr [ESI]
0055cfcf : PUSH EDX
0055cfd0 : CALL 0x00515cf0
0055cfd5 : POP EDI
0055cfd6 : POP EBP
0055cfd7 : MOV dword ptr [ESI],0x0
0055cfdd : POP EBX
0055cfde : POP ESI
0055cfdf : ADD ESP,0x8
0055cfe2 : RET

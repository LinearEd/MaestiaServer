PROGRAM  : Maestia.exe
FUNCTION : FUN_004809a0
ENTRY    : 004809a0
BODY     : [[004809a0, 00480a47]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_004809a0(uint *param_1)

{
  uint uVar1;
  int in_ECX;
  undefined1 local_138 [80];
  uint uStack_e8;
  byte bStack_b8;
  
  uVar1 = -(uint)(*(char *)(in_ECX + 0x289) != '\0') & 0xffff0000;
  *param_1 = uVar1 + 0x10104;
  param_1[2] = 0x36b;
  param_1[1] = 0x1b;
  if (*(char *)(in_ECX + 8) == '\0') {
    return uVar1 + 0x10100;
  }
  (**(code **)(**(int **)(in_ECX + 0xf0) + 0x1c))(*(int **)(in_ECX + 0xf0),local_138);
  if (*(char *)(in_ECX + 0x10) != '\0') {
    *param_1 = *param_1 | 0x1200;
  }
  if (0 < *(int *)(in_ECX + 0x14)) {
    *param_1 = *param_1 | 0x4000;
  }
  if (1 < *(int *)(in_ECX + 0x14)) {
    *param_1 = *param_1 | 0x88000;
  }
  if ((bStack_b8 & 0x48) != 0) {
    *param_1 = *param_1 | 0x2000;
  }
  *param_1 = *param_1 & 0xfffffcff;
  param_1[3] = uStack_e8;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
004809a0 : PUSH EBP
004809a1 : MOV EBP,ESP
004809a3 : AND ESP,0xfffffff8
004809a6 : SUB ESP,0x130
004809ac : PUSH ESI
004809ad : MOV ESI,dword ptr [EBP + 0x8]
004809b0 : PUSH EDI
004809b1 : MOV EDI,ECX
004809b3 : MOVZX EAX,byte ptr [EDI + 0x289]
004809ba : NEG EAX
004809bc : SBB EAX,EAX
004809be : AND EAX,0xffff0000
004809c3 : ADD EAX,0x10104
004809c8 : MOV dword ptr [ESI],EAX
004809ca : MOV dword ptr [ESI + 0x8],0x36b
004809d1 : MOV dword ptr [ESI + 0x4],0x1b
004809d8 : CMP byte ptr [EDI + 0x8],0x0
004809dc : JNZ 0x004809e8
004809de : XOR AL,AL
004809e0 : POP EDI
004809e1 : POP ESI
004809e2 : MOV ESP,EBP
004809e4 : POP EBP
004809e5 : RET 0x4
004809e8 : MOV EAX,dword ptr [EDI + 0xf0]
004809ee : MOV ECX,dword ptr [EAX]
004809f0 : LEA EDX,[ESP + 0x8]
004809f4 : PUSH EDX
004809f5 : PUSH EAX
004809f6 : MOV EAX,dword ptr [ECX + 0x1c]
004809f9 : CALL EAX
004809fb : CMP byte ptr [EDI + 0x10],0x0
004809ff : JZ 0x00480a07
00480a01 : OR dword ptr [ESI],0x1200
00480a07 : MOV EAX,0x1
00480a0c : CMP dword ptr [EDI + 0x14],EAX
00480a0f : JL 0x00480a17
00480a11 : OR dword ptr [ESI],0x4000
00480a17 : CMP dword ptr [EDI + 0x14],0x2
00480a1b : JL 0x00480a23
00480a1d : OR dword ptr [ESI],0x88000
00480a23 : TEST byte ptr [ESP + 0x90],0x48
00480a2b : JZ 0x00480a33
00480a2d : OR dword ptr [ESI],0x2000
00480a33 : MOV ECX,dword ptr [ESP + 0x60]
00480a37 : AND dword ptr [ESI],0xfffffcff
00480a3d : POP EDI
00480a3e : MOV dword ptr [ESI + 0xc],ECX
00480a41 : POP ESI
00480a42 : MOV ESP,EBP
00480a44 : POP EBP
00480a45 : RET 0x4

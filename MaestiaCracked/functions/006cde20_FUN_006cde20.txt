PROGRAM  : Maestia.exe
FUNCTION : FUN_006cde20
ENTRY    : 006cde20
BODY     : [[006cde20, 006ce05a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006cde20(int param_1,int param_2,char *param_3,undefined4 param_4,undefined4 param_5,
                 undefined1 param_6,int param_7,char *param_8,int param_9)

{
  size_t sVar1;
  undefined4 uVar2;
  int local_c;
  
  if ((param_1 != 0) && (param_2 != 0)) {
    sVar1 = _strlen(param_3);
    uVar2 = FUN_006cef50(param_1,sVar1 + 1);
    *(undefined4 *)(param_2 + 0xa0) = uVar2;
    if (*(int *)(param_2 + 0xa0) == 0) {
      FUN_006c24c0(param_1,"Insufficient memory for pCAL purpose.");
    }
    else {
      _memcpy(*(void **)(param_2 + 0xa0),param_3,sVar1 + 1);
      *(undefined4 *)(param_2 + 0xa4) = param_4;
      *(undefined4 *)(param_2 + 0xa8) = param_5;
      *(undefined1 *)(param_2 + 0xb4) = param_6;
      *(undefined1 *)(param_2 + 0xb5) = (undefined1)param_7;
      sVar1 = _strlen(param_8);
      uVar2 = FUN_006cef50(param_1,sVar1 + 1);
      *(undefined4 *)(param_2 + 0xac) = uVar2;
      if (*(int *)(param_2 + 0xac) == 0) {
        FUN_006c24c0(param_1,"Insufficient memory for pCAL units.");
      }
      else {
        _memcpy(*(void **)(param_2 + 0xac),param_8,sVar1 + 1);
        uVar2 = FUN_006cef50(param_1,param_7 * 4 + 4);
        *(undefined4 *)(param_2 + 0xb0) = uVar2;
        if (*(int *)(param_2 + 0xb0) == 0) {
          FUN_006c24c0(param_1,"Insufficient memory for pCAL params.");
        }
        else {
          *(undefined4 *)(*(int *)(param_2 + 0xb0) + param_7 * 4) = 0;
          for (local_c = 0; local_c < param_7; local_c = local_c + 1) {
            sVar1 = _strlen(*(char **)(param_9 + local_c * 4));
            uVar2 = FUN_006cef50(param_1,sVar1 + 1);
            *(undefined4 *)(*(int *)(param_2 + 0xb0) + local_c * 4) = uVar2;
            if (*(int *)(*(int *)(param_2 + 0xb0) + local_c * 4) == 0) {
              FUN_006c24c0(param_1,"Insufficient memory for pCAL parameter.");
              return;
            }
            _memcpy(*(void **)(*(int *)(param_2 + 0xb0) + local_c * 4),
                    *(void **)(param_9 + local_c * 4),sVar1 + 1);
          }
          *(uint *)(param_2 + 8) = *(uint *)(param_2 + 8) | 0x400;
          *(uint *)(param_2 + 0xb8) = *(uint *)(param_2 + 0xb8) | 0x80;
        }
      }
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
006cde20 : PUSH EBP
006cde21 : MOV EBP,ESP
006cde23 : SUB ESP,0x8
006cde26 : CMP dword ptr [EBP + 0x8],0x0
006cde2a : JZ 0x006cde32
006cde2c : CMP dword ptr [EBP + 0xc],0x0
006cde30 : JNZ 0x006cde37
006cde32 : JMP 0x006ce057
006cde37 : MOV EAX,dword ptr [EBP + 0x10]
006cde3a : PUSH EAX
006cde3b : CALL 0x00640960
006cde40 : ADD ESP,0x4
006cde43 : ADD EAX,0x1
006cde46 : MOV dword ptr [EBP + -0x4],EAX
006cde49 : MOV ECX,dword ptr [EBP + -0x4]
006cde4c : PUSH ECX
006cde4d : MOV EDX,dword ptr [EBP + 0x8]
006cde50 : PUSH EDX
006cde51 : CALL 0x006cef50
006cde56 : ADD ESP,0x8
006cde59 : MOV ECX,dword ptr [EBP + 0xc]
006cde5c : MOV dword ptr [ECX + 0xa0],EAX
006cde62 : MOV EDX,dword ptr [EBP + 0xc]
006cde65 : CMP dword ptr [EDX + 0xa0],0x0
006cde6c : JNZ 0x006cde84
006cde6e : PUSH 0xbede58
006cde73 : MOV EAX,dword ptr [EBP + 0x8]
006cde76 : PUSH EAX
006cde77 : CALL 0x006c24c0
006cde7c : ADD ESP,0x8
006cde7f : JMP 0x006ce057
006cde84 : MOV ECX,dword ptr [EBP + -0x4]
006cde87 : PUSH ECX
006cde88 : MOV EDX,dword ptr [EBP + 0x10]
006cde8b : PUSH EDX
006cde8c : MOV EAX,dword ptr [EBP + 0xc]
006cde8f : MOV ECX,dword ptr [EAX + 0xa0]
006cde95 : PUSH ECX
006cde96 : CALL 0x0063ae40
006cde9b : ADD ESP,0xc
006cde9e : MOV EDX,dword ptr [EBP + 0xc]
006cdea1 : MOV EAX,dword ptr [EBP + 0x14]
006cdea4 : MOV dword ptr [EDX + 0xa4],EAX
006cdeaa : MOV ECX,dword ptr [EBP + 0xc]
006cdead : MOV EDX,dword ptr [EBP + 0x18]
006cdeb0 : MOV dword ptr [ECX + 0xa8],EDX
006cdeb6 : MOV EAX,dword ptr [EBP + 0xc]
006cdeb9 : MOV CL,byte ptr [EBP + 0x1c]
006cdebc : MOV byte ptr [EAX + 0xb4],CL
006cdec2 : MOV EDX,dword ptr [EBP + 0xc]
006cdec5 : MOV AL,byte ptr [EBP + 0x20]
006cdec8 : MOV byte ptr [EDX + 0xb5],AL
006cdece : MOV ECX,dword ptr [EBP + 0x24]
006cded1 : PUSH ECX
006cded2 : CALL 0x00640960
006cded7 : ADD ESP,0x4
006cdeda : ADD EAX,0x1
006cdedd : MOV dword ptr [EBP + -0x4],EAX
006cdee0 : MOV EDX,dword ptr [EBP + -0x4]
006cdee3 : PUSH EDX
006cdee4 : MOV EAX,dword ptr [EBP + 0x8]
006cdee7 : PUSH EAX
006cdee8 : CALL 0x006cef50
006cdeed : ADD ESP,0x8
006cdef0 : MOV ECX,dword ptr [EBP + 0xc]
006cdef3 : MOV dword ptr [ECX + 0xac],EAX
006cdef9 : MOV EDX,dword ptr [EBP + 0xc]
006cdefc : CMP dword ptr [EDX + 0xac],0x0
006cdf03 : JNZ 0x006cdf1b
006cdf05 : PUSH 0xbede34
006cdf0a : MOV EAX,dword ptr [EBP + 0x8]
006cdf0d : PUSH EAX
006cdf0e : CALL 0x006c24c0
006cdf13 : ADD ESP,0x8
006cdf16 : JMP 0x006ce057
006cdf1b : MOV ECX,dword ptr [EBP + -0x4]
006cdf1e : PUSH ECX
006cdf1f : MOV EDX,dword ptr [EBP + 0x24]
006cdf22 : PUSH EDX
006cdf23 : MOV EAX,dword ptr [EBP + 0xc]
006cdf26 : MOV ECX,dword ptr [EAX + 0xac]
006cdf2c : PUSH ECX
006cdf2d : CALL 0x0063ae40
006cdf32 : ADD ESP,0xc
006cdf35 : MOV EDX,dword ptr [EBP + 0x20]
006cdf38 : LEA EAX,[EDX*0x4 + 0x4]
006cdf3f : PUSH EAX
006cdf40 : MOV ECX,dword ptr [EBP + 0x8]
006cdf43 : PUSH ECX
006cdf44 : CALL 0x006cef50
006cdf49 : ADD ESP,0x8
006cdf4c : MOV EDX,dword ptr [EBP + 0xc]
006cdf4f : MOV dword ptr [EDX + 0xb0],EAX
006cdf55 : MOV EAX,dword ptr [EBP + 0xc]
006cdf58 : CMP dword ptr [EAX + 0xb0],0x0
006cdf5f : JNZ 0x006cdf77
006cdf61 : PUSH 0xbede0c
006cdf66 : MOV ECX,dword ptr [EBP + 0x8]
006cdf69 : PUSH ECX
006cdf6a : CALL 0x006c24c0
006cdf6f : ADD ESP,0x8
006cdf72 : JMP 0x006ce057
006cdf77 : MOV EDX,dword ptr [EBP + 0xc]
006cdf7a : MOV EAX,dword ptr [EDX + 0xb0]
006cdf80 : MOV ECX,dword ptr [EBP + 0x20]
006cdf83 : MOV dword ptr [EAX + ECX*0x4],0x0
006cdf8a : MOV dword ptr [EBP + -0x8],0x0
006cdf91 : JMP 0x006cdf9c
006cdf93 : MOV EDX,dword ptr [EBP + -0x8]
006cdf96 : ADD EDX,0x1
006cdf99 : MOV dword ptr [EBP + -0x8],EDX
006cdf9c : MOV EAX,dword ptr [EBP + -0x8]
006cdf9f : CMP EAX,dword ptr [EBP + 0x20]
006cdfa2 : JGE 0x006ce02f
006cdfa8 : MOV ECX,dword ptr [EBP + -0x8]
006cdfab : MOV EDX,dword ptr [EBP + 0x28]
006cdfae : MOV EAX,dword ptr [EDX + ECX*0x4]
006cdfb1 : PUSH EAX
006cdfb2 : CALL 0x00640960
006cdfb7 : ADD ESP,0x4
006cdfba : ADD EAX,0x1
006cdfbd : MOV dword ptr [EBP + -0x4],EAX
006cdfc0 : MOV ECX,dword ptr [EBP + -0x4]
006cdfc3 : PUSH ECX
006cdfc4 : MOV EDX,dword ptr [EBP + 0x8]
006cdfc7 : PUSH EDX
006cdfc8 : CALL 0x006cef50
006cdfcd : ADD ESP,0x8
006cdfd0 : MOV ECX,dword ptr [EBP + 0xc]
006cdfd3 : MOV EDX,dword ptr [ECX + 0xb0]
006cdfd9 : MOV ECX,dword ptr [EBP + -0x8]
006cdfdc : MOV dword ptr [EDX + ECX*0x4],EAX
006cdfdf : MOV EDX,dword ptr [EBP + 0xc]
006cdfe2 : MOV EAX,dword ptr [EDX + 0xb0]
006cdfe8 : MOV ECX,dword ptr [EBP + -0x8]
006cdfeb : CMP dword ptr [EAX + ECX*0x4],0x0
006cdfef : JNZ 0x006ce004
006cdff1 : PUSH 0xbedde4
006cdff6 : MOV EDX,dword ptr [EBP + 0x8]
006cdff9 : PUSH EDX
006cdffa : CALL 0x006c24c0
006cdfff : ADD ESP,0x8
006ce002 : JMP 0x006ce057
006ce004 : MOV EAX,dword ptr [EBP + -0x4]
006ce007 : PUSH EAX
006ce008 : MOV ECX,dword ptr [EBP + -0x8]
006ce00b : MOV EDX,dword ptr [EBP + 0x28]
006ce00e : MOV EAX,dword ptr [EDX + ECX*0x4]
006ce011 : PUSH EAX
006ce012 : MOV ECX,dword ptr [EBP + 0xc]
006ce015 : MOV EDX,dword ptr [ECX + 0xb0]
006ce01b : MOV EAX,dword ptr [EBP + -0x8]
006ce01e : MOV ECX,dword ptr [EDX + EAX*0x4]
006ce021 : PUSH ECX
006ce022 : CALL 0x0063ae40
006ce027 : ADD ESP,0xc
006ce02a : JMP 0x006cdf93
006ce02f : MOV EDX,dword ptr [EBP + 0xc]
006ce032 : MOV EAX,dword ptr [EDX + 0x8]
006ce035 : OR EAX,0x400
006ce03a : MOV ECX,dword ptr [EBP + 0xc]
006ce03d : MOV dword ptr [ECX + 0x8],EAX
006ce040 : MOV EDX,dword ptr [EBP + 0xc]
006ce043 : MOV EAX,dword ptr [EDX + 0xb8]
006ce049 : OR EAX,0x80
006ce04e : MOV ECX,dword ptr [EBP + 0xc]
006ce051 : MOV dword ptr [ECX + 0xb8],EAX
006ce057 : MOV ESP,EBP
006ce059 : POP EBP
006ce05a : RET

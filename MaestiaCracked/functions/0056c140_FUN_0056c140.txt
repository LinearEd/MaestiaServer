PROGRAM  : Maestia.exe
FUNCTION : FUN_0056c140
ENTRY    : 0056c140
BODY     : [[0056c140, 0056c263]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_0056c140(int *param_1,undefined4 param_2,int *param_3)

{
  int iVar1;
  short *psVar2;
  LONG LVar3;
  int iVar4;
  uint unaff_EBX;
  undefined4 unaff_retaddr;
  short *psVar5;
  
  iVar1 = (**(code **)(*param_1 + 0x18))();
  *param_3 = iVar1;
  if (iVar1 != 0) {
    FUN_0051b6e0();
    psVar2 = (short *)FUN_00515840(*param_3,0);
    (**(code **)(*param_1 + 0x28))(psVar2,*param_3);
    iVar1 = *param_3;
    if (*psVar2 == -0x101) {
      iVar1 = iVar1 / 2 + -1;
      iVar4 = 0;
      if (0 < iVar1) {
        do {
          iVar4 = iVar4 + 1;
        } while (iVar4 < iVar1);
      }
      FUN_0051b8a0(psVar2 + 1,iVar1);
    }
    else if (*psVar2 == -2) {
      iVar1 = iVar1 / 2 + -1;
      iVar4 = 0;
      psVar5 = psVar2 + 1;
      if (0 < iVar1) {
        do {
          psVar5[iVar4] = psVar5[iVar4] << 8 | (ushort)psVar5[iVar4] >> 8;
          iVar4 = iVar4 + 1;
        } while (iVar4 < iVar1);
      }
      FUN_0051b8a0(psVar5,iVar1);
    }
    else {
      psVar5 = psVar2;
      if ((((2 < iVar1) && ((char)*psVar2 == -0x11)) && (*(char *)((int)psVar2 + 1) == -0x45)) &&
         ((char)psVar2[1] == -0x41)) {
        iVar1 = iVar1 + -3;
        psVar5 = (short *)((int)psVar2 + 3);
      }
      FUN_0051b950(psVar5,iVar1);
    }
    FUN_00529470((uint *)(unaff_EBX & 0xfffffffc) + 2,*(uint *)(unaff_EBX & 0xfffffffc) & 0x7fffffff
                 ,unaff_retaddr);
    FUN_00515cf0(psVar2);
    LVar3 = InterlockedExchangeAdd((LONG *)((unaff_EBX & 0xfffffffc) + 4),-1);
    if (LVar3 == 1) {
      FUN_00515cf0(unaff_EBX & 0xfffffffc);
    }
    return 1;
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
0056c140 : PUSH EBX
0056c141 : MOV EBX,dword ptr [ESP + 0x8]
0056c145 : MOV EAX,dword ptr [EBX]
0056c147 : MOV EDX,dword ptr [EAX + 0x18]
0056c14a : PUSH EDI
0056c14b : MOV ECX,EBX
0056c14d : CALL EDX
0056c14f : MOV EDI,dword ptr [ESP + 0x14]
0056c153 : MOV dword ptr [EDI],EAX
0056c155 : TEST EAX,EAX
0056c157 : JNZ 0x0056c15e
0056c159 : POP EDI
0056c15a : XOR AL,AL
0056c15c : POP EBX
0056c15d : RET
0056c15e : PUSH ESI
0056c15f : LEA ECX,[ESP + 0x10]
0056c163 : CALL 0x0051b6e0
0056c168 : MOV EAX,dword ptr [EDI]
0056c16a : MOV ECX,dword ptr [0x00d73250]
0056c170 : PUSH 0x0
0056c172 : PUSH EAX
0056c173 : CALL 0x00515840
0056c178 : MOV ECX,dword ptr [EDI]
0056c17a : MOV ESI,EAX
0056c17c : MOV EAX,dword ptr [EBX]
0056c17e : MOV EDX,dword ptr [EAX + 0x28]
0056c181 : PUSH ECX
0056c182 : PUSH ESI
0056c183 : MOV ECX,EBX
0056c185 : CALL EDX
0056c187 : MOVZX ECX,word ptr [ESI]
0056c18a : MOV EAX,dword ptr [EDI]
0056c18c : MOV EDX,0xfeff
0056c191 : CMP CX,DX
0056c194 : JNZ 0x0056c1b7
0056c196 : CDQ
0056c197 : SUB EAX,EDX
0056c199 : SAR EAX,0x1
0056c19b : DEC EAX
0056c19c : XOR ECX,ECX
0056c19e : LEA EDI,[ESI + 0x2]
0056c1a1 : TEST EAX,EAX
0056c1a3 : JLE 0x0056c1aa
0056c1a5 : INC ECX
0056c1a6 : CMP ECX,EAX
0056c1a8 : JL 0x0056c1a5
0056c1aa : PUSH EAX
0056c1ab : PUSH EDI
0056c1ac : LEA ECX,[ESP + 0x18]
0056c1b0 : CALL 0x0051b8a0
0056c1b5 : JMP 0x0056c219
0056c1b7 : MOV EDX,0xfffe
0056c1bc : CMP CX,DX
0056c1bf : JNZ 0x0056c1ee
0056c1c1 : CDQ
0056c1c2 : SUB EAX,EDX
0056c1c4 : SAR EAX,0x1
0056c1c6 : DEC EAX
0056c1c7 : XOR ECX,ECX
0056c1c9 : LEA EBX,[ESI + 0x2]
0056c1cc : TEST EAX,EAX
0056c1ce : JLE 0x0056c1e1
0056c1d0 : MOV DX,word ptr [EBX + ECX*0x2]
0056c1d4 : ROL DX,0x8
0056c1d8 : MOV word ptr [EBX + ECX*0x2],DX
0056c1dc : INC ECX
0056c1dd : CMP ECX,EAX
0056c1df : JL 0x0056c1d0
0056c1e1 : PUSH EAX
0056c1e2 : PUSH EBX
0056c1e3 : LEA ECX,[ESP + 0x18]
0056c1e7 : CALL 0x0051b8a0
0056c1ec : JMP 0x0056c219
0056c1ee : CMP EAX,0x2
0056c1f1 : JLE 0x0056c20e
0056c1f3 : CMP byte ptr [ESI],0xef
0056c1f6 : JNZ 0x0056c20e
0056c1f8 : CMP byte ptr [ESI + 0x1],0xbb
0056c1fc : JNZ 0x0056c20e
0056c1fe : CMP byte ptr [ESI + 0x2],0xbf
0056c202 : JNZ 0x0056c20e
0056c204 : ADD EAX,-0x3
0056c207 : PUSH EAX
0056c208 : LEA EAX,[ESI + 0x3]
0056c20b : PUSH EAX
0056c20c : JMP 0x0056c210
0056c20e : PUSH EAX
0056c20f : PUSH ESI
0056c210 : LEA ECX,[ESP + 0x18]
0056c214 : CALL 0x0051b950
0056c219 : MOV EAX,dword ptr [ESP + 0x10]
0056c21d : MOV ECX,dword ptr [ESP + 0x14]
0056c221 : AND EAX,0xfffffffc
0056c224 : MOV EDX,dword ptr [EAX]
0056c226 : PUSH ECX
0056c227 : AND EDX,0x7fffffff
0056c22d : PUSH EDX
0056c22e : ADD EAX,0x8
0056c231 : PUSH EAX
0056c232 : CALL 0x00529470
0056c237 : ADD ESP,0xc
0056c23a : PUSH ESI
0056c23b : CALL 0x00515cf0
0056c240 : MOV ESI,dword ptr [ESP + 0x10]
0056c244 : AND ESI,0xfffffffc
0056c247 : PUSH -0x1
0056c249 : LEA EAX,[ESI + 0x4]
0056c24c : PUSH EAX
0056c24d : CALL dword ptr [0x00b851cc]
0056c253 : SUB EAX,0x1
0056c256 : JNZ 0x0056c25e
0056c258 : PUSH ESI
0056c259 : CALL 0x00515cf0
0056c25e : POP ESI
0056c25f : POP EDI
0056c260 : MOV AL,0x1
0056c262 : POP EBX
0056c263 : RET

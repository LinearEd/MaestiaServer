PROGRAM  : Maestia.exe
FUNCTION : FUN_009a3fb0
ENTRY    : 009a3fb0
BODY     : [[009a3fb0, 009a4317]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009a3fb0(int param_1,int param_2)

{
  int iVar1;
  int *piVar2;
  uint uVar3;
  undefined4 uVar4;
  int in_ECX;
  undefined1 local_c0 [28];
  undefined1 local_a4 [28];
  undefined1 local_88 [28];
  undefined1 local_6c [28];
  undefined1 local_50 [28];
  int local_34;
  undefined1 local_30 [28];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b6d06d;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_34 = param_2;
  local_14 = uVar3;
  if (param_1 == 0) goto LAB_009a42fa;
  switch(*(undefined4 *)(param_2 + 0x5c)) {
  case 1:
    if (*(int *)(param_2 + 0x60) != 0) {
      FUN_00406460(L"IDS_GUI_CANT_UPGRADE_EQUIP_ITEM");
      local_8 = 0;
      piVar2 = *(int **)(*(int *)(in_ECX + 4) + 0x1a8);
      uVar4 = FUN_0081d120(local_c0);
      local_8._0_1_ = 1;
      (**(code **)(*piVar2 + 0x44))(uVar4,3,uVar3);
      local_8 = (uint)local_8._1_3_ << 8;
      FUN_00406560();
      local_8 = 0xffffffff;
      FUN_00406560();
      FUN_0097fca0(param_2);
    }
    break;
  case 2:
    FUN_00406460(&DAT_00c88f70);
    local_8 = 2;
    if ((*(byte *)(param_1 + 0x120) & 1) == 0) {
      FUN_00406460(L"IDS_TRADEBINDITEM_DONT_ITEM");
      local_8._0_1_ = 3;
      FUN_0081d120(local_a4);
      local_8._0_1_ = 4;
      FUN_00405c00(local_30);
      local_8._0_1_ = 3;
      FUN_00406560();
    }
    else {
      FUN_00406460(L"IDS_TRADEBINDITEM_DONT_ITEM_EQUIPWINDOW");
      local_8._0_1_ = 5;
      FUN_0081d120(local_6c);
      local_8._0_1_ = 6;
      FUN_00405c00(local_30);
      local_8._0_1_ = 5;
      FUN_00406560();
    }
    local_8._0_1_ = 2;
    FUN_00406560();
    if (((DAT_0172491c != 0) && (iVar1 = *DAT_00da9894, iVar1 != 0)) &&
       (*(int *)(iVar1 + 0x1a8) != 0)) {
      piVar2 = *(int **)(iVar1 + 0x1a8);
      uVar4 = FUN_0081d120(local_30);
      local_8._0_1_ = 7;
      (**(code **)(*piVar2 + 0x44))(uVar4,3);
      local_8._0_1_ = 2;
      FUN_00406560();
    }
    FUN_0097fca0(param_2);
    FUN_0097fa60();
    local_8 = 0xffffffff;
    FUN_00406560();
    break;
  case 3:
    if (((DAT_0172491c != 0) && (*DAT_00da9894 != 0)) && (*(int *)(*DAT_00da9894 + 0x1a8) != 0)) {
      FUN_00406460(L"IDS_UNIDENTIFIED_NOT_BREAK_SEAL");
      local_8 = 8;
      piVar2 = *(int **)(*DAT_00da9894 + 0x1a8);
      uVar4 = FUN_0081d120(local_88);
      local_8._0_1_ = 9;
      (**(code **)(*piVar2 + 0x44))(uVar4,3);
      local_8 = CONCAT31(local_8._1_3_,8);
      FUN_00406560();
LAB_009a4258:
      local_8 = 0xffffffff;
      FUN_00406560();
    }
    goto LAB_009a4260;
  default:
    FUN_00ac4560(param_1,param_2);
    break;
  case 5:
    if (((DAT_0172491c != 0) && (*DAT_00da9894 != 0)) && (*(int *)(*DAT_00da9894 + 0x1a8) != 0)) {
      FUN_00406460(L"IDS_ITEMCRAFT_NOT_DECOMPOSE");
      local_8 = 10;
      piVar2 = *(int **)(*DAT_00da9894 + 0x1a8);
      uVar4 = FUN_0081d120(local_50);
      local_8._0_1_ = 0xb;
      (**(code **)(*piVar2 + 0x44))(uVar4,3);
      local_8 = CONCAT31(local_8._1_3_,10);
      FUN_00406560();
      goto LAB_009a4258;
    }
LAB_009a4260:
    FUN_0097fca0(local_34);
    FUN_0097fa60();
  }
LAB_009a42fa:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
009a3fb0 : PUSH EBP
009a3fb1 : MOV EBP,ESP
009a3fb3 : PUSH -0x1
009a3fb5 : PUSH 0xb6d06d
009a3fba : MOV EAX,FS:[0x0]
009a3fc0 : PUSH EAX
009a3fc1 : SUB ESP,0x158
009a3fc7 : MOV EAX,[0x00d66fa0]
009a3fcc : XOR EAX,EBP
009a3fce : MOV dword ptr [EBP + -0x10],EAX
009a3fd1 : PUSH EBX
009a3fd2 : PUSH ESI
009a3fd3 : PUSH EDI
009a3fd4 : PUSH EAX
009a3fd5 : LEA EAX,[EBP + -0xc]
009a3fd8 : MOV FS:[0x0],EAX
009a3fde : MOV ESI,dword ptr [EBP + 0x8]
009a3fe1 : MOV EBX,dword ptr [EBP + 0xc]
009a3fe4 : MOV EDI,ECX
009a3fe6 : MOV dword ptr [EBP + -0x30],EBX
009a3fe9 : TEST ESI,ESI
009a3feb : JNZ 0x009a3ff4
009a3fed : XOR AL,AL
009a3fef : JMP 0x009a42fa
009a3ff4 : MOV EAX,dword ptr [EBX + 0x5c]
009a3ff7 : DEC EAX
009a3ff8 : CMP EAX,0x4
009a3ffb : JA 0x009a42f3
009a4001 : JMP dword ptr [EAX*0x4 + 0x9a4318]
009a4008 : CMP dword ptr [EBX + 0x60],0x0
009a400c : JZ 0x009a3fed
009a400e : PUSH 0xc88f30
009a4013 : LEA ECX,[EBP + 0xffffff44]
009a4019 : CALL 0x00406460
009a401e : MOV dword ptr [EBP + -0x4],0x0
009a4025 : MOV EAX,dword ptr [EDI + 0x4]
009a4028 : MOV ESI,dword ptr [EAX + 0x1a8]
009a402e : LEA ECX,[EBP + 0xffffff44]
009a4034 : PUSH ECX
009a4035 : MOV ECX,dword ptr [0x0172491c]
009a403b : LEA EDI,[EBP + 0xffffff28]
009a4041 : CALL 0x0081d120
009a4046 : MOV byte ptr [EBP + -0x4],0x1
009a404a : MOV EDX,dword ptr [ESI]
009a404c : PUSH 0x3
009a404e : PUSH EAX
009a404f : MOV EAX,dword ptr [EDX + 0x44]
009a4052 : MOV ECX,ESI
009a4054 : CALL EAX
009a4056 : MOV byte ptr [EBP + -0x4],0x0
009a405a : MOV ECX,EDI
009a405c : CALL 0x00406560
009a4061 : MOV dword ptr [EBP + -0x4],0xffffffff
009a4068 : LEA ECX,[EBP + 0xffffff44]
009a406e : CALL 0x00406560
009a4073 : PUSH EBX
009a4074 : CALL 0x0097fca0
009a4079 : MOV AL,0x1
009a407b : JMP 0x009a42fa
009a4080 : PUSH 0xc88f70
009a4085 : LEA ECX,[EBP + -0x2c]
009a4088 : CALL 0x00406460
009a408d : MOV dword ptr [EBP + -0x4],0x2
009a4094 : TEST byte ptr [ESI + 0x120],0x1
009a409b : JNZ 0x009a4101
009a409d : PUSH 0xc88f74
009a40a2 : LEA ECX,[EBP + 0xffffff60]
009a40a8 : CALL 0x00406460
009a40ad : MOV byte ptr [EBP + -0x4],0x3
009a40b1 : LEA ECX,[EBP + 0xffffff60]
009a40b7 : PUSH ECX
009a40b8 : MOV ECX,dword ptr [0x0172491c]
009a40be : LEA EDI,[EBP + 0xfffffef0]
009a40c4 : CALL 0x0081d120
009a40c9 : MOV byte ptr [EBP + -0x4],0x4
009a40cd : CMP dword ptr [EAX + 0x18],0x8
009a40d1 : JC 0x009a40d8
009a40d3 : MOV EAX,dword ptr [EAX + 0x4]
009a40d6 : JMP 0x009a40db
009a40d8 : ADD EAX,0x4
009a40db : LEA EDX,[EBP + -0x2c]
009a40de : PUSH EDX
009a40df : MOV EDX,EAX
009a40e1 : CALL 0x00405c00
009a40e6 : MOV byte ptr [EBP + -0x4],0x3
009a40ea : LEA ECX,[EBP + 0xfffffef0]
009a40f0 : CALL 0x00406560
009a40f5 : MOV byte ptr [EBP + -0x4],0x2
009a40f9 : LEA ECX,[EBP + 0xffffff60]
009a40ff : JMP 0x009a415a
009a4101 : PUSH 0xc88fd0
009a4106 : LEA ECX,[EBP + -0x68]
009a4109 : CALL 0x00406460
009a410e : MOV byte ptr [EBP + -0x4],0x5
009a4112 : MOV ECX,dword ptr [0x0172491c]
009a4118 : LEA EAX,[EBP + -0x68]
009a411b : PUSH EAX
009a411c : LEA EDI,[EBP + 0xfffffeb8]
009a4122 : CALL 0x0081d120
009a4127 : MOV byte ptr [EBP + -0x4],0x6
009a412b : CMP dword ptr [EAX + 0x18],0x8
009a412f : JC 0x009a4136
009a4131 : MOV EAX,dword ptr [EAX + 0x4]
009a4134 : JMP 0x009a4139
009a4136 : ADD EAX,0x4
009a4139 : LEA ECX,[EBP + -0x2c]
009a413c : PUSH ECX
009a413d : MOV EDX,EAX
009a413f : CALL 0x00405c00
009a4144 : MOV byte ptr [EBP + -0x4],0x5
009a4148 : LEA ECX,[EBP + 0xfffffeb8]
009a414e : CALL 0x00406560
009a4153 : MOV byte ptr [EBP + -0x4],0x2
009a4157 : LEA ECX,[EBP + -0x68]
009a415a : CALL 0x00406560
009a415f : MOV ECX,dword ptr [0x0172491c]
009a4165 : TEST ECX,ECX
009a4167 : JZ 0x009a41ae
009a4169 : MOV EDX,dword ptr [0x00da9894]
009a416f : MOV EAX,dword ptr [EDX]
009a4171 : TEST EAX,EAX
009a4173 : JZ 0x009a41ae
009a4175 : CMP dword ptr [EAX + 0x1a8],0x0
009a417c : JZ 0x009a41ae
009a417e : MOV ESI,dword ptr [EAX + 0x1a8]
009a4184 : LEA EAX,[EBP + -0x2c]
009a4187 : PUSH EAX
009a4188 : LEA EDI,[EBP + 0xffffff0c]
009a418e : CALL 0x0081d120
009a4193 : MOV byte ptr [EBP + -0x4],0x7
009a4197 : MOV EDX,dword ptr [ESI]
009a4199 : PUSH 0x3
009a419b : PUSH EAX
009a419c : MOV EAX,dword ptr [EDX + 0x44]
009a419f : MOV ECX,ESI
009a41a1 : CALL EAX
009a41a3 : MOV byte ptr [EBP + -0x4],0x2
009a41a7 : MOV ECX,EDI
009a41a9 : CALL 0x00406560
009a41ae : PUSH EBX
009a41af : CALL 0x0097fca0
009a41b4 : MOV ECX,EBX
009a41b6 : CALL 0x0097fa60
009a41bb : MOV dword ptr [EBP + -0x4],0xffffffff
009a41c2 : LEA ECX,[EBP + -0x2c]
009a41c5 : CALL 0x00406560
009a41ca : MOV AL,0x1
009a41cc : JMP 0x009a42fa
009a41d1 : CMP dword ptr [0x0172491c],0x0
009a41d8 : JZ 0x009a4260
009a41de : MOV ECX,dword ptr [0x00da9894]
009a41e4 : MOV EAX,dword ptr [ECX]
009a41e6 : TEST EAX,EAX
009a41e8 : JZ 0x009a4260
009a41ea : CMP dword ptr [EAX + 0x1a8],0x0
009a41f1 : JZ 0x009a4260
009a41f3 : PUSH 0xc89020
009a41f8 : LEA ECX,[EBP + 0xffffff7c]
009a41fe : CALL 0x00406460
009a4203 : MOV EBX,0x8
009a4208 : MOV dword ptr [EBP + -0x4],EBX
009a420b : MOV EDX,dword ptr [0x00da9894]
009a4211 : MOV EAX,dword ptr [EDX]
009a4213 : MOV ESI,dword ptr [EAX + 0x1a8]
009a4219 : MOV ECX,dword ptr [0x0172491c]
009a421f : LEA EAX,[EBP + 0xffffff7c]
009a4225 : PUSH EAX
009a4226 : LEA EDI,[EBP + 0xfffffed4]
009a422c : CALL 0x0081d120
009a4231 : MOV byte ptr [EBP + -0x4],0x9
009a4235 : MOV EDX,dword ptr [ESI]
009a4237 : PUSH 0x3
009a4239 : PUSH EAX
009a423a : MOV EAX,dword ptr [EDX + 0x44]
009a423d : MOV ECX,ESI
009a423f : CALL EAX
009a4241 : MOV byte ptr [EBP + -0x4],BL
009a4244 : MOV ECX,EDI
009a4246 : CALL 0x00406560
009a424b : MOV dword ptr [EBP + -0x4],0xffffffff
009a4252 : LEA ECX,[EBP + 0xffffff7c]
009a4258 : CALL 0x00406560
009a425d : MOV EBX,dword ptr [EBP + -0x30]
009a4260 : PUSH EBX
009a4261 : CALL 0x0097fca0
009a4266 : MOV ECX,EBX
009a4268 : CALL 0x0097fa60
009a426d : MOV AL,0x1
009a426f : JMP 0x009a42fa
009a4274 : CMP dword ptr [0x0172491c],0x0
009a427b : JZ 0x009a4260
009a427d : MOV ECX,dword ptr [0x00da9894]
009a4283 : MOV EAX,dword ptr [ECX]
009a4285 : TEST EAX,EAX
009a4287 : JZ 0x009a4260
009a4289 : CMP dword ptr [EAX + 0x1a8],0x0
009a4290 : JZ 0x009a4260
009a4292 : PUSH 0xc89060
009a4297 : LEA ECX,[EBP + -0x4c]
009a429a : CALL 0x00406460
009a429f : MOV EBX,0xa
009a42a4 : MOV dword ptr [EBP + -0x4],EBX
009a42a7 : MOV EDX,dword ptr [0x00da9894]
009a42ad : MOV EAX,dword ptr [EDX]
009a42af : MOV ESI,dword ptr [EAX + 0x1a8]
009a42b5 : MOV ECX,dword ptr [0x0172491c]
009a42bb : LEA EAX,[EBP + -0x4c]
009a42be : PUSH EAX
009a42bf : LEA EDI,[EBP + 0xfffffe9c]
009a42c5 : CALL 0x0081d120
009a42ca : MOV byte ptr [EBP + -0x4],0xb
009a42ce : MOV EDX,dword ptr [ESI]
009a42d0 : PUSH 0x3
009a42d2 : PUSH EAX
009a42d3 : MOV EAX,dword ptr [EDX + 0x44]
009a42d6 : MOV ECX,ESI
009a42d8 : CALL EAX
009a42da : MOV byte ptr [EBP + -0x4],BL
009a42dd : MOV ECX,EDI
009a42df : CALL 0x00406560
009a42e4 : MOV dword ptr [EBP + -0x4],0xffffffff
009a42eb : LEA ECX,[EBP + -0x4c]
009a42ee : JMP 0x009a4258
009a42f3 : PUSH EBX
009a42f4 : PUSH ESI
009a42f5 : CALL 0x00ac4560
009a42fa : MOV ECX,dword ptr [EBP + -0xc]
009a42fd : MOV dword ptr FS:[0x0],ECX
009a4304 : POP ECX
009a4305 : POP EDI
009a4306 : POP ESI
009a4307 : POP EBX
009a4308 : MOV ECX,dword ptr [EBP + -0x10]
009a430b : XOR ECX,EBP
009a430d : CALL 0x00633e6b
009a4312 : MOV ESP,EBP
009a4314 : POP EBP
009a4315 : RET 0x8

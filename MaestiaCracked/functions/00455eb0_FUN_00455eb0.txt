PROGRAM  : Maestia.exe
FUNCTION : FUN_00455eb0
ENTRY    : 00455eb0
BODY     : [[00455eb0, 00455f19] [00455f20, 00455f83]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

uint * FUN_00455eb0(uint param_1)

{
  uint *puVar1;
  uint uVar2;
  uint extraout_EDX;
  size_t _Size;
  void *local_c;
  undefined1 *puStack_8;
  undefined4 uStack_4;
  
  uStack_4 = 0xffffffff;
  puStack_8 = &LAB_00b7277a;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  _Size = param_1 * 0x124 + 4;
  if (DAT_00da98c8 == (int *)0x0) {
    puVar1 = _malloc(_Size);
  }
  else {
    puVar1 = (uint *)(**(code **)(*DAT_00da98c8 + 4))(_Size,DAT_00d66fa0 ^ (uint)&stack0xffffffe0);
  }
  if (puVar1 == (uint *)0x0) {
    ExceptionList = local_c;
    return (uint *)0x0;
  }
  uVar2 = 0;
  *puVar1 = param_1;
  if (param_1 != 0) {
    do {
      uStack_4 = 0;
      if (puVar1 + 1 + uVar2 * 0x49 != (uint *)0x0) {
        FUN_00807100();
        uVar2 = extraout_EDX;
      }
      uVar2 = uVar2 + 1;
    } while (uVar2 < param_1);
  }
  _DAT_00da98cc = _DAT_00da98cc + _Size;
  _DAT_00da98d0 = _DAT_00da98d0 + 1;
  ExceptionList = local_c;
  return puVar1 + 1;
}



============================================================
DISASSEMBLY
============================================================
00455eb0 : PUSH -0x1
00455eb2 : PUSH 0xb7277a
00455eb7 : MOV EAX,FS:[0x0]
00455ebd : PUSH EAX
00455ebe : SUB ESP,0x8
00455ec1 : PUSH EBX
00455ec2 : PUSH ESI
00455ec3 : PUSH EDI
00455ec4 : MOV EAX,[0x00d66fa0]
00455ec9 : XOR EAX,ESP
00455ecb : PUSH EAX
00455ecc : LEA EAX,[ESP + 0x18]
00455ed0 : MOV FS:[0x0],EAX
00455ed6 : MOV EBX,dword ptr [ESP + 0x28]
00455eda : MOV ECX,dword ptr [0x00da98c8]
00455ee0 : MOV EDI,EBX
00455ee2 : IMUL EDI,EDI,0x124
00455ee8 : ADD EDI,0x4
00455eeb : PUSH EDI
00455eec : TEST ECX,ECX
00455eee : JZ 0x00455ef9
00455ef0 : MOV EAX,dword ptr [ECX]
00455ef2 : MOV EDX,dword ptr [EAX + 0x4]
00455ef5 : CALL EDX
00455ef7 : JMP 0x00455f01
00455ef9 : CALL 0x00636043
00455efe : ADD ESP,0x4
00455f01 : TEST EAX,EAX
00455f03 : JZ 0x00455f6f
00455f05 : XOR EDX,EDX
00455f07 : LEA ESI,[EAX + 0x4]
00455f0a : MOV dword ptr [EAX],EBX
00455f0c : MOV dword ptr [ESP + 0x10],ESI
00455f10 : MOV dword ptr [ESP + 0x28],EDX
00455f14 : TEST EBX,EBX
00455f16 : JBE 0x00455f4e
00455f18 : JMP 0x00455f20
00455f20 : MOV ECX,EDX
00455f22 : IMUL ECX,ECX,0x124
00455f28 : ADD ECX,ESI
00455f2a : MOV dword ptr [ESP + 0x14],ECX
00455f2e : MOV dword ptr [ESP + 0x20],0x0
00455f36 : JZ 0x00455f3d
00455f38 : CALL 0x00807100
00455f3d : MOV dword ptr [ESP + 0x20],0xffffffff
00455f45 : INC EDX
00455f46 : MOV dword ptr [ESP + 0x28],EDX
00455f4a : CMP EDX,EBX
00455f4c : JC 0x00455f20
00455f4e : ADD dword ptr [0x00da98cc],EDI
00455f54 : INC dword ptr [0x00da98d0]
00455f5a : MOV EAX,ESI
00455f5c : MOV ECX,dword ptr [ESP + 0x18]
00455f60 : MOV dword ptr FS:[0x0],ECX
00455f67 : POP ECX
00455f68 : POP EDI
00455f69 : POP ESI
00455f6a : POP EBX
00455f6b : ADD ESP,0x14
00455f6e : RET
00455f6f : XOR EAX,EAX
00455f71 : MOV ECX,dword ptr [ESP + 0x18]
00455f75 : MOV dword ptr FS:[0x0],ECX
00455f7c : POP ECX
00455f7d : POP EDI
00455f7e : POP ESI
00455f7f : POP EBX
00455f80 : ADD ESP,0x14
00455f83 : RET

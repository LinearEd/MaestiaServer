PROGRAM  : Maestia.exe
FUNCTION : FUN_008f9c50
ENTRY    : 008f9c50
BODY     : [[008f9c50, 008fa01f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008f9c50(int param_1,uint param_2,undefined4 param_3,undefined4 param_4)

{
  char cVar1;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  int in_ECX;
  int *piVar5;
  undefined4 ***pppuVar6;
  uint uVar7;
  undefined1 local_158 [196];
  undefined1 local_94 [28];
  undefined1 local_78 [28];
  int local_5c;
  int local_58;
  uint local_54;
  uint local_50;
  undefined1 local_4c [28];
  undefined1 local_30 [4];
  undefined4 **local_2c [4];
  int local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  iVar3 = DAT_00d7c54c;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b355f1;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_58 = param_1;
  if (in_ECX - 10U < 0x14) {
    if (*(int *)(*(int *)(DAT_0172491c + 0x17c) + 0x17f0) == 0) {
      param_2 = 0;
    }
    else {
      param_2 = *(uint *)(*(int *)(DAT_0172491c + 0x17c) + 0x16e8);
    }
  }
  local_50 = param_2;
  local_14 = uVar2;
  FUN_004437f0(&local_50);
  if ((local_54 != *(uint *)(iVar3 + 0x44)) && (*(int *)(local_54 + 0x10) != 0)) {
    local_54 = *(uint *)(*(int *)(local_54 + 0x10) + 0x18c);
    local_50 = 0;
    do {
      uVar7 = local_50;
      if (((((int)local_50 < 0xe) || (0x13 < (int)local_50)) && ((param_2 >> 0x10 & 0xff) != 0x33))
         && ((local_54 >> ((byte)local_50 & 0x1f) & 1) != 0)) {
        piVar5 = (int *)0x0;
        if (*(int *)(*DAT_00da9894 + 0x130) != 0) {
          piVar5 = *(int **)(*(int *)(*DAT_00da9894 + 0x130) + 0x3c);
        }
        local_5c = (**(code **)(*piVar5 + 0x98))(local_50 & 0xffff,uVar2);
        if ((local_5c != 0) && (piVar5 = *(int **)(local_5c + 8), piVar5 != (int *)0x0)) {
          cVar1 = FUN_009f2890();
          if (cVar1 == '\x01') {
            *(undefined1 *)(local_58 + 0x31) = 1;
            (**(code **)(*piVar5 + 0x58))(0);
          }
          FUN_00406460(&DAT_00c617b0);
          local_8 = 0;
          if (((*(byte *)(piVar5 + 0x48) & 0x30) != 0) ||
             (cVar1 = (**(code **)(*piVar5 + 0xa0))(), cVar1 != '\0')) {
            FUN_00406460(&DAT_00c617b4);
            local_8._0_1_ = 1;
            cVar1 = (**(code **)(*piVar5 + 0xa0))();
            if ((cVar1 != '\0') && (FUN_00a07c70(local_30), local_1c != 0)) {
              iVar3 = FUN_0081cbe0(DAT_0172491c);
              local_8._0_1_ = 2;
              pppuVar6 = (undefined4 ***)local_2c[0];
              if (local_18 < 8) {
                pppuVar6 = local_2c;
              }
              if (*(uint *)(iVar3 + 0x18) < 8) {
                iVar3 = iVar3 + 4;
              }
              else {
                iVar3 = *(int *)(iVar3 + 4);
              }
              uVar4 = FUN_00404750(L"\n`L@N%s %s\n",iVar3,pppuVar6);
              local_8._0_1_ = 3;
              FUN_00405c30(uVar4,0,0xffffffff);
              local_8._0_1_ = 2;
              FUN_00406560();
              local_8._0_1_ = 1;
              FUN_00406560();
            }
            iVar3 = FUN_004049b0(param_2);
            if (((*(byte *)(piVar5 + 0x48) & 0x30) == 0) &&
               ((iVar3 == 0 || ((*(uint *)(iVar3 + 0x4c) & 1) == 0)))) {
              FUN_00406460(L"IDS_ITEM_DURATION_TIMECHECK");
              local_8._0_1_ = 7;
              iVar3 = FUN_0081d120(local_94);
              local_8._0_1_ = 8;
              if (*(uint *)(iVar3 + 0x18) < 8) {
                iVar3 = iVar3 + 4;
              }
              else {
                iVar3 = *(int *)(iVar3 + 4);
              }
              uVar4 = FUN_00404750(L"`L@N%s\n",iVar3);
              local_8._0_1_ = 9;
              FUN_00405c30(uVar4,0,0xffffffff);
              local_8._0_1_ = 8;
              FUN_00406560();
              local_8._0_1_ = 7;
              FUN_00406560();
            }
            else {
              FUN_00406460(L"IDS_ITEM_GET_DURATION_TIMECHECK");
              local_8._0_1_ = 4;
              iVar3 = FUN_0081d120(local_78);
              local_8._0_1_ = 5;
              if (*(uint *)(iVar3 + 0x18) < 8) {
                iVar3 = iVar3 + 4;
              }
              else {
                iVar3 = *(int *)(iVar3 + 4);
              }
              uVar4 = FUN_00404750(L"`L@N%s\n",iVar3);
              local_8._0_1_ = 6;
              FUN_00405c30(uVar4,0,0xffffffff);
              local_8._0_1_ = 5;
              FUN_00406560();
              local_8._0_1_ = 4;
              FUN_00406560();
            }
            local_8._0_1_ = 1;
            FUN_00406560();
            local_8 = (uint)local_8._1_3_ << 8;
            FUN_00406560();
          }
          uVar4 = FUN_00403450(local_158,local_4c);
          local_8._0_1_ = 10;
          FUN_008f9b20(uVar4,1,param_4);
          local_8 = (uint)local_8._1_3_ << 8;
          FUN_00406560();
          local_8 = 0xffffffff;
          FUN_00406560();
          uVar7 = local_50;
        }
      }
      local_50 = uVar7 + 1;
    } while ((int)local_50 < 0x1e);
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008f9c50 : PUSH EBP
008f9c51 : MOV EBP,ESP
008f9c53 : PUSH -0x1
008f9c55 : PUSH 0xb355f1
008f9c5a : MOV EAX,FS:[0x0]
008f9c60 : PUSH EAX
008f9c61 : SUB ESP,0x14c
008f9c67 : MOV EAX,[0x00d66fa0]
008f9c6c : XOR EAX,EBP
008f9c6e : MOV dword ptr [EBP + -0x10],EAX
008f9c71 : PUSH EBX
008f9c72 : PUSH ESI
008f9c73 : PUSH EDI
008f9c74 : PUSH EAX
008f9c75 : LEA EAX,[EBP + -0xc]
008f9c78 : MOV FS:[0x0],EAX
008f9c7e : MOV EAX,dword ptr [EBP + 0x8]
008f9c81 : ADD ECX,-0xa
008f9c84 : MOV dword ptr [EBP + -0x54],EAX
008f9c87 : CMP ECX,0x13
008f9c8a : JA 0x008f9cae
008f9c8c : MOV EDX,dword ptr [0x0172491c]
008f9c92 : MOV EAX,dword ptr [EDX + 0x17c]
008f9c98 : CMP dword ptr [EAX + 0x17f0],0x0
008f9c9f : JZ 0x008f9ca9
008f9ca1 : MOV EAX,dword ptr [EAX + 0x16e8]
008f9ca7 : JMP 0x008f9cab
008f9ca9 : XOR EAX,EAX
008f9cab : MOV dword ptr [EBP + 0xc],EAX
008f9cae : MOV EAX,dword ptr [EBP + 0xc]
008f9cb1 : MOV ESI,dword ptr [0x00d7c54c]
008f9cb7 : LEA ECX,[EBP + -0x4c]
008f9cba : MOV dword ptr [EBP + -0x4c],EAX
008f9cbd : PUSH ECX
008f9cbe : LEA ECX,[ESI + 0x40]
008f9cc1 : LEA EAX,[EBP + -0x50]
008f9cc4 : CALL 0x004437f0
008f9cc9 : MOV ESI,dword ptr [ESI + 0x44]
008f9ccc : MOV EAX,dword ptr [EBP + -0x50]
008f9ccf : CMP EAX,ESI
008f9cd1 : JZ 0x008f9fff
008f9cd7 : MOV EAX,dword ptr [EAX + 0x10]
008f9cda : TEST EAX,EAX
008f9cdc : JZ 0x008f9fff
008f9ce2 : MOV EDX,dword ptr [EAX + 0x18c]
008f9ce8 : XOR EDI,EDI
008f9cea : MOV dword ptr [EBP + -0x50],EDX
008f9ced : MOV dword ptr [EBP + -0x4c],EDI
008f9cf0 : CMP EDI,0xe
008f9cf3 : JL 0x008f9cfe
008f9cf5 : CMP EDI,0x13
008f9cf8 : JLE 0x008f9ff2
008f9cfe : MOV EAX,dword ptr [EBP + 0xc]
008f9d01 : SHR EAX,0x10
008f9d04 : MOVZX EAX,AL
008f9d07 : CMP EAX,0x33
008f9d0a : JZ 0x008f9ff2
008f9d10 : MOV EDX,dword ptr [EBP + -0x50]
008f9d13 : MOVZX EAX,DI
008f9d16 : MOV CL,AL
008f9d18 : SHR EDX,CL
008f9d1a : AND EDX,0x1
008f9d1d : JZ 0x008f9ff2
008f9d23 : MOV ECX,dword ptr [0x00da9894]
008f9d29 : MOV ECX,dword ptr [ECX]
008f9d2b : MOV ECX,dword ptr [ECX + 0x130]
008f9d31 : TEST ECX,ECX
008f9d33 : JZ 0x008f9d38
008f9d35 : MOV ECX,dword ptr [ECX + 0x3c]
008f9d38 : MOV EDX,dword ptr [ECX]
008f9d3a : PUSH EAX
008f9d3b : MOV EAX,dword ptr [EDX + 0x98]
008f9d41 : CALL EAX
008f9d43 : MOV ESI,EAX
008f9d45 : MOV dword ptr [EBP + -0x58],ESI
008f9d48 : TEST ESI,ESI
008f9d4a : JZ 0x008f9ff2
008f9d50 : MOV EBX,dword ptr [ESI + 0x8]
008f9d53 : TEST EBX,EBX
008f9d55 : JZ 0x008f9ff2
008f9d5b : MOV EDI,dword ptr [EBX + 0x10]
008f9d5e : CALL 0x009f2890
008f9d63 : CMP AL,0x1
008f9d65 : JNZ 0x008f9d78
008f9d67 : MOV ECX,dword ptr [EBP + -0x54]
008f9d6a : MOV byte ptr [ECX + 0x31],AL
008f9d6d : MOV EDX,dword ptr [EBX]
008f9d6f : MOV EAX,dword ptr [EDX + 0x58]
008f9d72 : PUSH 0x0
008f9d74 : MOV ECX,EBX
008f9d76 : CALL EAX
008f9d78 : PUSH 0xc617b0
008f9d7d : LEA ECX,[EBP + -0x48]
008f9d80 : CALL 0x00406460
008f9d85 : MOV dword ptr [EBP + -0x4],0x0
008f9d8c : TEST byte ptr [EBX + 0x120],0x30
008f9d93 : JNZ 0x008f9da9
008f9d95 : MOV EDX,dword ptr [EBX]
008f9d97 : MOV EAX,dword ptr [EDX + 0xa0]
008f9d9d : MOV ECX,EBX
008f9d9f : CALL EAX
008f9da1 : TEST AL,AL
008f9da3 : JZ 0x008f9f9f
008f9da9 : PUSH 0xc617b4
008f9dae : LEA ECX,[EBP + -0x2c]
008f9db1 : CALL 0x00406460
008f9db6 : MOV byte ptr [EBP + -0x4],0x1
008f9dba : MOV EDX,dword ptr [EBX]
008f9dbc : MOV EAX,dword ptr [EDX + 0xa0]
008f9dc2 : MOV ECX,EBX
008f9dc4 : CALL EAX
008f9dc6 : TEST AL,AL
008f9dc8 : JZ 0x008f9e57
008f9dce : LEA ECX,[EBP + -0x2c]
008f9dd1 : PUSH ECX
008f9dd2 : MOV ECX,EBX
008f9dd4 : CALL 0x00a07c70
008f9dd9 : CMP dword ptr [EBP + -0x18],0x0
008f9ddd : JZ 0x008f9e57
008f9ddf : MOV EDX,dword ptr [0x0172491c]
008f9de5 : PUSH EDX
008f9de6 : MOV ECX,0xc617b8
008f9deb : LEA ESI,[EBP + 0xfffffec8]
008f9df1 : CALL 0x0081cbe0
008f9df6 : MOV byte ptr [EBP + -0x4],0x2
008f9dfa : MOV ECX,dword ptr [EBP + -0x28]
008f9dfd : MOV EDX,0x8
008f9e02 : CMP dword ptr [EBP + -0x14],EDX
008f9e05 : JNC 0x008f9e0a
008f9e07 : LEA ECX,[EBP + -0x28]
008f9e0a : CMP dword ptr [EAX + 0x18],EDX
008f9e0d : JC 0x008f9e14
008f9e0f : MOV EAX,dword ptr [EAX + 0x4]
008f9e12 : JMP 0x008f9e17
008f9e14 : ADD EAX,0x4
008f9e17 : PUSH ECX
008f9e18 : PUSH EAX
008f9e19 : PUSH 0xc617c4
008f9e1e : LEA ESI,[EBP + 0xffffff00]
008f9e24 : CALL 0x00404750
008f9e29 : ADD ESP,0xc
008f9e2c : MOV byte ptr [EBP + -0x4],0x3
008f9e30 : PUSH -0x1
008f9e32 : PUSH 0x0
008f9e34 : PUSH EAX
008f9e35 : LEA ECX,[EBP + -0x48]
008f9e38 : CALL 0x00405c30
008f9e3d : MOV byte ptr [EBP + -0x4],0x2
008f9e41 : MOV ECX,ESI
008f9e43 : CALL 0x00406560
008f9e48 : MOV byte ptr [EBP + -0x4],0x1
008f9e4c : LEA ECX,[EBP + 0xfffffec8]
008f9e52 : CALL 0x00406560
008f9e57 : MOV EAX,dword ptr [EBP + 0xc]
008f9e5a : PUSH EAX
008f9e5b : CALL 0x004049b0
008f9e60 : ADD ESP,0x4
008f9e63 : TEST byte ptr [EBX + 0x120],0x30
008f9e6a : JNZ 0x008f9f0d
008f9e70 : TEST EAX,EAX
008f9e72 : JZ 0x008f9e84
008f9e74 : MOV ECX,dword ptr [EAX + 0x4c]
008f9e77 : AND ECX,0x1
008f9e7a : XOR EAX,EAX
008f9e7c : OR EAX,ECX
008f9e7e : JNZ 0x008f9f0d
008f9e84 : PUSH 0xc61830
008f9e89 : LEA ECX,[EBP + 0xffffff70]
008f9e8f : CALL 0x00406460
008f9e94 : MOV byte ptr [EBP + -0x4],0x7
008f9e98 : LEA ECX,[EBP + 0xffffff70]
008f9e9e : PUSH ECX
008f9e9f : MOV ECX,dword ptr [0x0172491c]
008f9ea5 : LEA EDI,[EBP + 0xffffff38]
008f9eab : CALL 0x0081d120
008f9eb0 : MOV byte ptr [EBP + -0x4],0x8
008f9eb4 : CMP dword ptr [EAX + 0x18],0x8
008f9eb8 : JC 0x008f9ebf
008f9eba : MOV EAX,dword ptr [EAX + 0x4]
008f9ebd : JMP 0x008f9ec2
008f9ebf : ADD EAX,0x4
008f9ec2 : PUSH EAX
008f9ec3 : PUSH 0xc61868
008f9ec8 : LEA ESI,[EBP + 0xffffff54]
008f9ece : CALL 0x00404750
008f9ed3 : ADD ESP,0x8
008f9ed6 : MOV byte ptr [EBP + -0x4],0x9
008f9eda : PUSH -0x1
008f9edc : PUSH 0x0
008f9ede : PUSH EAX
008f9edf : LEA ECX,[EBP + -0x48]
008f9ee2 : CALL 0x00405c30
008f9ee7 : MOV byte ptr [EBP + -0x4],0x8
008f9eeb : MOV ECX,ESI
008f9eed : CALL 0x00406560
008f9ef2 : MOV byte ptr [EBP + -0x4],0x7
008f9ef6 : LEA ECX,[EBP + 0xffffff38]
008f9efc : CALL 0x00406560
008f9f01 : MOV byte ptr [EBP + -0x4],0x1
008f9f05 : LEA ECX,[EBP + 0xffffff70]
008f9f0b : JMP 0x008f9f8b
008f9f0d : PUSH 0xc617e0
008f9f12 : LEA ECX,[EBP + -0x74]
008f9f15 : CALL 0x00406460
008f9f1a : MOV byte ptr [EBP + -0x4],0x4
008f9f1e : MOV ECX,dword ptr [0x0172491c]
008f9f24 : LEA EDX,[EBP + -0x74]
008f9f27 : PUSH EDX
008f9f28 : LEA EDI,[EBP + 0xfffffee4]
008f9f2e : CALL 0x0081d120
008f9f33 : MOV byte ptr [EBP + -0x4],0x5
008f9f37 : CMP dword ptr [EAX + 0x18],0x8
008f9f3b : JC 0x008f9f42
008f9f3d : MOV EAX,dword ptr [EAX + 0x4]
008f9f40 : JMP 0x008f9f45
008f9f42 : ADD EAX,0x4
008f9f45 : PUSH EAX
008f9f46 : PUSH 0xc61820
008f9f4b : LEA ESI,[EBP + 0xffffff1c]
008f9f51 : CALL 0x00404750
008f9f56 : ADD ESP,0x8
008f9f59 : MOV byte ptr [EBP + -0x4],0x6
008f9f5d : PUSH -0x1
008f9f5f : PUSH 0x0
008f9f61 : PUSH EAX
008f9f62 : LEA ECX,[EBP + -0x48]
008f9f65 : CALL 0x00405c30
008f9f6a : MOV byte ptr [EBP + -0x4],0x5
008f9f6e : MOV ECX,ESI
008f9f70 : CALL 0x00406560
008f9f75 : MOV byte ptr [EBP + -0x4],0x4
008f9f79 : LEA ECX,[EBP + 0xfffffee4]
008f9f7f : CALL 0x00406560
008f9f84 : MOV byte ptr [EBP + -0x4],0x1
008f9f88 : LEA ECX,[EBP + -0x74]
008f9f8b : CALL 0x00406560
008f9f90 : MOV byte ptr [EBP + -0x4],0x0
008f9f94 : LEA ECX,[EBP + -0x2c]
008f9f97 : CALL 0x00406560
008f9f9c : MOV ESI,dword ptr [EBP + -0x58]
008f9f9f : LEA EAX,[EBP + -0x48]
008f9fa2 : PUSH EAX
008f9fa3 : LEA EDX,[EBP + 0xfffffeac]
008f9fa9 : LEA ECX,[ESI + 0x3c]
008f9fac : PUSH EDX
008f9fad : CALL 0x00403450
008f9fb2 : ADD ESP,0x8
008f9fb5 : MOV byte ptr [EBP + -0x4],0xa
008f9fb9 : MOV ECX,dword ptr [EBP + 0x14]
008f9fbc : MOV EDI,dword ptr [EBP + 0x10]
008f9fbf : MOV ESI,dword ptr [EBP + -0x54]
008f9fc2 : PUSH ECX
008f9fc3 : PUSH 0x1
008f9fc5 : PUSH EAX
008f9fc6 : MOV ECX,EDI
008f9fc8 : CALL 0x008f9b20
008f9fcd : INC EDI
008f9fce : MOV dword ptr [EBP + 0x10],EDI
008f9fd1 : MOV byte ptr [EBP + -0x4],0x0
008f9fd5 : LEA ECX,[EBP + 0xfffffeac]
008f9fdb : CALL 0x00406560
008f9fe0 : MOV dword ptr [EBP + -0x4],0xffffffff
008f9fe7 : LEA ECX,[EBP + -0x48]
008f9fea : CALL 0x00406560
008f9fef : MOV EDI,dword ptr [EBP + -0x4c]
008f9ff2 : INC EDI
008f9ff3 : CMP EDI,0x1d
008f9ff6 : MOV dword ptr [EBP + -0x4c],EDI
008f9ff9 : JLE 0x008f9cf0
008f9fff : MOV EAX,dword ptr [EBP + 0x10]
008fa002 : MOV ECX,dword ptr [EBP + -0xc]
008fa005 : MOV dword ptr FS:[0x0],ECX
008fa00c : POP ECX
008fa00d : POP EDI
008fa00e : POP ESI
008fa00f : POP EBX
008fa010 : MOV ECX,dword ptr [EBP + -0x10]
008fa013 : XOR ECX,EBP
008fa015 : CALL 0x00633e6b
008fa01a : MOV ESP,EBP
008fa01c : POP EBP
008fa01d : RET 0x10

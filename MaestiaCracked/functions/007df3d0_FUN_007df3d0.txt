PROGRAM  : Maestia.exe
FUNCTION : FUN_007df3d0
ENTRY    : 007df3d0
BODY     : [[007df3d0, 007df5bc] [007df5c0, 007df629] [007df630, 007df6ac]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_007df3d0(int param_1)

{
  int *piVar1;
  uint uVar2;
  code *pcVar3;
  int iVar4;
  int *piVar5;
  int *piVar6;
  float local_28;
  float local_24;
  float local_20;
  float local_1c;
  float local_18;
  float local_14;
  float local_10;
  float local_c;
  
  iVar4 = DAT_01725204;
  if ((*(int *)(param_1 + 0x2ad0) != 0) || (*(int *)(param_1 + 0x2adc) != 0)) {
    piVar1 = *(int **)(DAT_017251ac + 0x18);
    piVar5 = (int *)FUN_007bfd60();
    (**(code **)(*piVar1 + 0x15c))(piVar1,*(undefined4 *)(iVar4 + 0x1c4));
    (**(code **)(*piVar5 + 0xe8))(piVar5,"TerrainMark");
    DAT_00da98e5 = 1;
    _DAT_00da9a9c = piVar5;
    (**(code **)(*piVar5 + 0xfc))(piVar5,0,0);
    _DAT_00d6d25c = 0;
    DAT_00da98e6 = 1;
    _DAT_00da9aa0 = piVar5;
    (**(code **)(*piVar5 + 0x100))(piVar5,0);
    (**(code **)(*piVar1 + 0xe4))(piVar1,0xe,0);
    (**(code **)(*piVar1 + 0xe4))(piVar1,0x13,5);
    (**(code **)(*piVar1 + 0xe4))(piVar1,0x14,6);
    (**(code **)(*piVar1 + 0xe4))(piVar1,0x1b,1);
    (**(code **)(*piVar1 + 0xe4))(piVar1,0x16,1);
    uVar2 = *(uint *)(DAT_017251ac + 0x20c);
    local_18 = (float)(uVar2 >> 0x10 & 0xff) * 0.003921569;
    local_14 = (float)(uVar2 >> 8 & 0xff) * 0.003921569;
    local_10 = (float)(uVar2 & 0xff) * 0.003921569;
    local_c = (float)(uVar2 >> 0x18) * 0.003921569;
    local_28 = 1.0 / (*(float *)(DAT_017251ac + 0x218) - *(float *)(DAT_017251ac + 0x214));
    local_24 = local_28 * -1.0;
    local_28 = local_28 * *(float *)(DAT_017251ac + 0x218);
    local_1c = 1.0 / (*(float *)(param_1 + 0x1e4) - *(float *)(param_1 + 0x1e8));
    local_20 = -(local_1c * *(float *)(param_1 + 0x1e8));
    (**(code **)(*piVar5 + 0x50))(piVar5,"vFogColor",&local_18,0x10);
    (**(code **)(*piVar5 + 0x50))(piVar5,"vFogParam",&local_28,0x10);
    piVar6 = (int *)**(int **)(param_1 + 0x2acc);
    if (piVar6 != *(int **)(param_1 + 0x2acc)) {
      do {
        pcVar3 = *(code **)(*(int *)piVar6[2] + 0xc);
        ((int *)piVar6[2])[0x4430] = (int)piVar5;
        (*pcVar3)();
        piVar6 = (int *)*piVar6;
      } while (piVar6 != (int *)*(int *)(param_1 + 0x2acc));
    }
    DAT_00da98e6 = 0;
    (**(code **)(*piVar5 + 0x108))(piVar5);
    _DAT_00d6d25c = 1;
    DAT_00da98e6 = 1;
    _DAT_00da9aa0 = piVar5;
    (**(code **)(*piVar5 + 0x100))(piVar5,1);
    piVar6 = (int *)**(int **)(param_1 + 0x2ad8);
    if (piVar6 != *(int **)(param_1 + 0x2ad8)) {
      do {
        pcVar3 = *(code **)(*(int *)piVar6[2] + 0xc);
        ((int *)piVar6[2])[0x4430] = (int)piVar5;
        (*pcVar3)();
        piVar6 = (int *)*piVar6;
      } while (piVar6 != (int *)*(int *)(param_1 + 0x2ad8));
    }
    (**(code **)(*piVar1 + 0xe4))(piVar1,0x1b,0);
    (**(code **)(*piVar1 + 0xe4))(piVar1,0xe,1);
    (**(code **)(*piVar1 + 0xe4))(piVar1,0x16,3);
    DAT_00da98e6 = 0;
    (**(code **)(*piVar5 + 0x108))(piVar5);
    DAT_00da98e5 = 0;
    (**(code **)(*piVar5 + 0x10c))(piVar5);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
007df3d0 : PUSH EBP
007df3d1 : MOV EBP,ESP
007df3d3 : MOV EAX,dword ptr [EBP + 0x8]
007df3d6 : SUB ESP,0x28
007df3d9 : CMP dword ptr [EAX + 0x2ad0],0x0
007df3e0 : PUSH EBX
007df3e1 : PUSH ESI
007df3e2 : PUSH EDI
007df3e3 : JNZ 0x007df3f2
007df3e5 : CMP dword ptr [EAX + 0x2adc],0x0
007df3ec : JZ 0x007df6a4
007df3f2 : MOV EAX,[0x017251ac]
007df3f7 : MOV EBX,dword ptr [EAX + 0x18]
007df3fa : MOV ESI,dword ptr [0x01725204]
007df400 : XOR EAX,EAX
007df402 : CALL 0x007bfd60
007df407 : MOV EDX,dword ptr [ESI + 0x1c4]
007df40d : MOV ECX,dword ptr [EBX]
007df40f : PUSH EDX
007df410 : MOV EDI,EAX
007df412 : MOV EAX,dword ptr [ECX + 0x15c]
007df418 : PUSH EBX
007df419 : CALL EAX
007df41b : MOV ECX,dword ptr [EDI]
007df41d : MOV EDX,dword ptr [ECX + 0xe8]
007df423 : PUSH 0xc22d84
007df428 : PUSH EDI
007df429 : CALL EDX
007df42b : MOV EAX,dword ptr [EDI]
007df42d : MOV ECX,dword ptr [EAX + 0xfc]
007df433 : PUSH 0x0
007df435 : PUSH 0x0
007df437 : PUSH EDI
007df438 : MOV dword ptr [0x00da9a9c],EDI
007df43e : MOV byte ptr [0x00da98e5],0x1
007df445 : CALL ECX
007df447 : MOV EDX,dword ptr [EDI]
007df449 : MOV EAX,dword ptr [EDX + 0x100]
007df44f : PUSH 0x0
007df451 : PUSH EDI
007df452 : MOV dword ptr [0x00da9aa0],EDI
007df458 : MOV dword ptr [0x00d6d25c],0x0
007df462 : MOV byte ptr [0x00da98e6],0x1
007df469 : CALL EAX
007df46b : MOV ECX,dword ptr [EBX]
007df46d : MOV EDX,dword ptr [ECX + 0xe4]
007df473 : PUSH 0x0
007df475 : PUSH 0xe
007df477 : PUSH EBX
007df478 : CALL EDX
007df47a : MOV EAX,dword ptr [EBX]
007df47c : MOV ECX,dword ptr [EAX + 0xe4]
007df482 : PUSH 0x5
007df484 : PUSH 0x13
007df486 : PUSH EBX
007df487 : CALL ECX
007df489 : MOV EDX,dword ptr [EBX]
007df48b : MOV EAX,dword ptr [EDX + 0xe4]
007df491 : PUSH 0x6
007df493 : PUSH 0x14
007df495 : PUSH EBX
007df496 : CALL EAX
007df498 : MOV ECX,dword ptr [EBX]
007df49a : MOV EDX,dword ptr [ECX + 0xe4]
007df4a0 : PUSH 0x1
007df4a2 : PUSH 0x1b
007df4a4 : PUSH EBX
007df4a5 : CALL EDX
007df4a7 : MOV EAX,dword ptr [EBX]
007df4a9 : MOV ECX,dword ptr [EAX + 0xe4]
007df4af : PUSH 0x1
007df4b1 : PUSH 0x16
007df4b3 : PUSH EBX
007df4b4 : CALL ECX
007df4b6 : MOV ESI,dword ptr [0x017251ac]
007df4bc : MOV EAX,dword ptr [ESI + 0x20c]
007df4c2 : MOVSS XMM0,dword ptr [0x00cdf178]
007df4ca : MOV EDX,EAX
007df4cc : SHR EDX,0x10
007df4cf : MOVZX ECX,DL
007df4d2 : MOV EDX,EAX
007df4d4 : SHR EDX,0x8
007df4d7 : CVTSI2SS XMM1,ECX
007df4db : MULSS XMM1,XMM0
007df4df : MOVZX ECX,DL
007df4e2 : MOVSS dword ptr [EBP + -0x14],XMM1
007df4e7 : MOVZX EDX,AL
007df4ea : CVTSI2SS XMM1,ECX
007df4ee : MULSS XMM1,XMM0
007df4f2 : MOVSS dword ptr [EBP + -0x10],XMM1
007df4f7 : CVTSI2SS XMM1,EDX
007df4fb : MULSS XMM1,XMM0
007df4ff : MOVSS dword ptr [EBP + -0xc],XMM1
007df504 : SHR EAX,0x18
007df507 : CVTSI2SS XMM1,EAX
007df50b : MULSS XMM1,XMM0
007df50f : MOVSS dword ptr [EBP + -0x8],XMM1
007df514 : MOVSS XMM2,dword ptr [ESI + 0x218]
007df51c : MOVSS XMM0,dword ptr [ESI + 0x214]
007df524 : MOVSS XMM1,dword ptr [0x00c10fc4]
007df52c : MOV ESI,dword ptr [EBP + 0x8]
007df52f : MOVAPS XMM3,XMM2
007df532 : SUBSS XMM3,XMM0
007df536 : MOVAPS XMM0,XMM1
007df539 : DIVSS XMM0,XMM3
007df53d : MOVAPS XMM3,XMM0
007df540 : MULSS XMM0,dword ptr [0x00cdf0d0]
007df548 : MOVSS dword ptr [EBP + -0x20],XMM0
007df54d : MOVSS XMM0,dword ptr [ESI + 0x1e4]
007df555 : MULSS XMM3,XMM2
007df559 : MOVSS XMM2,dword ptr [ESI + 0x1e8]
007df561 : SUBSS XMM0,XMM2
007df565 : DIVSS XMM1,XMM0
007df569 : PUSH 0x10
007df56b : MOVAPS XMM0,XMM1
007df56e : LEA ECX,[EBP + -0x14]
007df571 : MULSS XMM0,XMM2
007df575 : XORPS XMM0,xmmword ptr [0x00cdf0c0]
007df57c : PUSH ECX
007df57d : MOVSS dword ptr [EBP + -0x24],XMM3
007df582 : MOVSS dword ptr [EBP + -0x1c],XMM0
007df587 : MOVSS dword ptr [EBP + -0x18],XMM1
007df58c : MOV EAX,dword ptr [EDI]
007df58e : MOV EDX,dword ptr [EAX + 0x50]
007df591 : PUSH 0xc22d90
007df596 : PUSH EDI
007df597 : CALL EDX
007df599 : MOV EAX,dword ptr [EDI]
007df59b : MOV EDX,dword ptr [EAX + 0x50]
007df59e : PUSH 0x10
007df5a0 : LEA ECX,[EBP + -0x24]
007df5a3 : PUSH ECX
007df5a4 : PUSH 0xc22d9c
007df5a9 : PUSH EDI
007df5aa : CALL EDX
007df5ac : MOV EAX,dword ptr [ESI + 0x2acc]
007df5b2 : MOV ECX,dword ptr [EAX]
007df5b4 : MOV dword ptr [EBP + 0x8],ECX
007df5b7 : CMP ECX,EAX
007df5b9 : JZ 0x007df5e3
007df5bb : JMP 0x007df5c3
007df5c0 : MOV ECX,dword ptr [EBP + 0x8]
007df5c3 : MOV ECX,dword ptr [ECX + 0x8]
007df5c6 : MOV EAX,dword ptr [ECX]
007df5c8 : MOV EDX,dword ptr [EAX + 0xc]
007df5cb : MOV dword ptr [ECX + 0x110c0],EDI
007df5d1 : CALL EDX
007df5d3 : MOV EAX,dword ptr [EBP + 0x8]
007df5d6 : MOV EAX,dword ptr [EAX]
007df5d8 : MOV dword ptr [EBP + 0x8],EAX
007df5db : CMP EAX,dword ptr [ESI + 0x2acc]
007df5e1 : JNZ 0x007df5c0
007df5e3 : MOV ECX,dword ptr [EDI]
007df5e5 : MOV EDX,dword ptr [ECX + 0x108]
007df5eb : PUSH EDI
007df5ec : MOV byte ptr [0x00da98e6],0x0
007df5f3 : CALL EDX
007df5f5 : MOV EAX,dword ptr [EDI]
007df5f7 : MOV ECX,dword ptr [EAX + 0x100]
007df5fd : PUSH 0x1
007df5ff : PUSH EDI
007df600 : MOV dword ptr [0x00da9aa0],EDI
007df606 : MOV dword ptr [0x00d6d25c],0x1
007df610 : MOV byte ptr [0x00da98e6],0x1
007df617 : CALL ECX
007df619 : MOV ECX,dword ptr [ESI + 0x2ad8]
007df61f : MOV EAX,dword ptr [ECX]
007df621 : MOV dword ptr [EBP + 0x8],EAX
007df624 : CMP EAX,ECX
007df626 : JZ 0x007df653
007df628 : JMP 0x007df633
007df630 : MOV EAX,dword ptr [EBP + 0x8]
007df633 : MOV ECX,dword ptr [EAX + 0x8]
007df636 : MOV EDX,dword ptr [ECX]
007df638 : MOV EAX,dword ptr [EDX + 0xc]
007df63b : MOV dword ptr [ECX + 0x110c0],EDI
007df641 : CALL EAX
007df643 : MOV ECX,dword ptr [EBP + 0x8]
007df646 : MOV EAX,dword ptr [ECX]
007df648 : MOV dword ptr [EBP + 0x8],EAX
007df64b : CMP EAX,dword ptr [ESI + 0x2ad8]
007df651 : JNZ 0x007df630
007df653 : MOV EDX,dword ptr [EBX]
007df655 : MOV EAX,dword ptr [EDX + 0xe4]
007df65b : PUSH 0x0
007df65d : PUSH 0x1b
007df65f : PUSH EBX
007df660 : CALL EAX
007df662 : MOV ECX,dword ptr [EBX]
007df664 : MOV EDX,dword ptr [ECX + 0xe4]
007df66a : PUSH 0x1
007df66c : PUSH 0xe
007df66e : PUSH EBX
007df66f : CALL EDX
007df671 : MOV EAX,dword ptr [EBX]
007df673 : MOV ECX,dword ptr [EAX + 0xe4]
007df679 : PUSH 0x3
007df67b : PUSH 0x16
007df67d : PUSH EBX
007df67e : CALL ECX
007df680 : MOV EDX,dword ptr [EDI]
007df682 : MOV EAX,dword ptr [EDX + 0x108]
007df688 : PUSH EDI
007df689 : MOV byte ptr [0x00da98e6],0x0
007df690 : CALL EAX
007df692 : MOV ECX,dword ptr [EDI]
007df694 : MOV EDX,dword ptr [ECX + 0x10c]
007df69a : PUSH EDI
007df69b : MOV byte ptr [0x00da98e5],0x0
007df6a2 : CALL EDX
007df6a4 : POP EDI
007df6a5 : POP ESI
007df6a6 : POP EBX
007df6a7 : MOV ESP,EBP
007df6a9 : POP EBP
007df6aa : RET 0x4

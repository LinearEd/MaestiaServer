PROGRAM  : Maestia.exe
FUNCTION : FUN_0052b6d0
ENTRY    : 0052b6d0
BODY     : [[0052b6d0, 0052b840]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0052b6d0(undefined4 param_1,uint param_2)

{
  int *piVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  int iVar4;
  int *in_ECX;
  int iVar5;
  int iVar6;
  float10 fVar7;
  longlong local_8;
  
  iVar5 = 0;
  if (param_2 == 0) {
    FUN_0054f5d0();
    return;
  }
  if (param_2 < 8) {
    iVar6 = 8;
  }
  else {
    fVar7 = (float10)FUN_0063b270();
    local_8 = (longlong)ROUND((float)fVar7 / 0.6931472 + 1.0);
    iVar6 = 1 << ((byte)local_8 & 0x1f);
  }
  local_8 = CONCAT44(local_8._4_4_,0x143);
  puVar3 = (undefined4 *)FUN_00515d60(param_1,iVar6 * 0x18 + 8,&local_8);
  *puVar3 = 0;
  puVar3[1] = iVar6 + -1;
  if (iVar6 != 0) {
    iVar4 = 0;
    do {
      *(undefined4 *)(iVar4 + 8 + (int)puVar3) = 0xfffffffe;
      iVar4 = iVar4 + 0x18;
      iVar6 = iVar6 + -1;
    } while (iVar6 != 0);
  }
  if (*in_ECX != 0) {
    iVar6 = *(int *)(*in_ECX + 4) + 1;
    do {
      puVar2 = (undefined4 *)(iVar5 + 8 + *in_ECX);
      if (*(int *)(iVar5 + 8 + *in_ECX) != -2) {
        FUN_0052c060(param_1,puVar2 + 1,*(undefined4 *)(puVar2[1] + 0xc));
        FUN_00526bc0();
        piVar1 = (int *)(puVar2[1] + 8);
        *piVar1 = *piVar1 + -1;
        if (*piVar1 == 0) {
          FUN_00525340();
        }
        *puVar2 = 0xfffffffe;
      }
      iVar5 = iVar5 + 0x18;
      iVar6 = iVar6 + -1;
    } while (iVar6 != 0);
    FUN_00515cf0(*in_ECX);
  }
  *in_ECX = (int)puVar3;
  FUN_0052aaa0();
  return;
}



============================================================
DISASSEMBLY
============================================================
0052b6d0 : SUB ESP,0xc
0052b6d3 : MOV EAX,dword ptr [ESP + 0x14]
0052b6d7 : PUSH EBX
0052b6d8 : PUSH EDI
0052b6d9 : XOR EBX,EBX
0052b6db : MOV EDI,ECX
0052b6dd : MOV dword ptr [ESP + 0x8],EDI
0052b6e1 : CMP EAX,EBX
0052b6e3 : JNZ 0x0052b6f2
0052b6e5 : CALL 0x0054f5d0
0052b6ea : POP EDI
0052b6eb : POP EBX
0052b6ec : ADD ESP,0xc
0052b6ef : RET 0x8
0052b6f2 : PUSH ESI
0052b6f3 : CMP EAX,0x8
0052b6f6 : JNC 0x0052b6ff
0052b6f8 : MOV ESI,0x8
0052b6fd : JMP 0x0052b764
0052b6ff : DEC EAX
0052b700 : MOV dword ptr [ESP + 0x20],EAX
0052b704 : FILD dword ptr [ESP + 0x20]
0052b708 : TEST EAX,EAX
0052b70a : JGE 0x0052b712
0052b70c : FADD float ptr [0x00cdf0e0]
0052b712 : CALL 0x0063b270
0052b717 : FSTP float ptr [ESP + 0x20]
0052b71b : FLD float ptr [ESP + 0x20]
0052b71f : MOV ESI,0x1
0052b724 : FDIV double ptr [0x00b85fe0]
0052b72a : FSTP float ptr [ESP + 0x20]
0052b72e : FLD float ptr [ESP + 0x20]
0052b732 : FADD double ptr [0x00cdf108]
0052b738 : FSTP float ptr [ESP + 0x20]
0052b73c : FLD float ptr [ESP + 0x20]
0052b740 : FNSTCW word ptr [ESP + 0x20]
0052b744 : MOVZX EAX,word ptr [ESP + 0x20]
0052b749 : OR EAX,0xc00
0052b74e : MOV dword ptr [ESP + 0x10],EAX
0052b752 : FLDCW word ptr [ESP + 0x10]
0052b756 : FISTP qword ptr [ESP + 0x10]
0052b75a : MOV CL,byte ptr [ESP + 0x10]
0052b75e : SHL ESI,CL
0052b760 : FLDCW word ptr [ESP + 0x20]
0052b764 : LEA EAX,[ESP + 0x10]
0052b768 : PUSH EAX
0052b769 : MOV EAX,dword ptr [ESP + 0x20]
0052b76d : LEA ECX,[ESI + ESI*0x2]
0052b770 : LEA EDX,[ECX*0x8 + 0x8]
0052b777 : PUSH EDX
0052b778 : PUSH EAX
0052b779 : MOV dword ptr [ESP + 0x2c],EBX
0052b77d : MOV dword ptr [ESP + 0x1c],0x143
0052b785 : CALL 0x00515d60
0052b78a : MOV dword ptr [ESP + 0x20],EAX
0052b78e : MOV dword ptr [EAX],EBX
0052b790 : MOV EDX,dword ptr [ESP + 0x20]
0052b794 : LEA ECX,[ESI + -0x1]
0052b797 : MOV dword ptr [EDX + 0x4],ECX
0052b79a : CMP ESI,EBX
0052b79c : JBE 0x0052b7b4
0052b79e : XOR EAX,EAX
0052b7a0 : MOV ECX,dword ptr [ESP + 0x20]
0052b7a4 : MOV dword ptr [EAX + ECX*0x1 + 0x8],0xfffffffe
0052b7ac : ADD EAX,0x18
0052b7af : SUB ESI,0x1
0052b7b2 : JNZ 0x0052b7a0
0052b7b4 : MOV EAX,dword ptr [EDI]
0052b7b6 : CMP EAX,EBX
0052b7b8 : JZ 0x0052b821
0052b7ba : MOV EAX,dword ptr [EAX + 0x4]
0052b7bd : PUSH EBP
0052b7be : LEA EBP,[EAX + 0x1]
0052b7c1 : JMP 0x0052b7c7
0052b7c3 : MOV EDI,dword ptr [ESP + 0x10]
0052b7c7 : MOV EDX,dword ptr [EDI]
0052b7c9 : CMP dword ptr [EBX + EDX*0x1 + 0x8],-0x2
0052b7ce : LEA EDI,[EBX + EDX*0x1 + 0x8]
0052b7d2 : JZ 0x0052b808
0052b7d4 : MOV EAX,dword ptr [EDI + 0x4]
0052b7d7 : MOV ECX,dword ptr [EAX + 0xc]
0052b7da : MOV EDX,dword ptr [ESP + 0x20]
0052b7de : LEA ESI,[EDI + 0x4]
0052b7e1 : PUSH ECX
0052b7e2 : PUSH ESI
0052b7e3 : PUSH EDX
0052b7e4 : LEA ECX,[ESP + 0x30]
0052b7e8 : CALL 0x0052c060
0052b7ed : LEA ECX,[ESI + 0x4]
0052b7f0 : CALL 0x00526bc0
0052b7f5 : MOV ECX,dword ptr [ESI]
0052b7f7 : ADD dword ptr [ECX + 0x8],-0x1
0052b7fb : JNZ 0x0052b802
0052b7fd : CALL 0x00525340
0052b802 : MOV dword ptr [EDI],0xfffffffe
0052b808 : ADD EBX,0x18
0052b80b : SUB EBP,0x1
0052b80e : JNZ 0x0052b7c3
0052b810 : MOV EAX,dword ptr [ESP + 0x10]
0052b814 : MOV ECX,dword ptr [EAX]
0052b816 : PUSH ECX
0052b817 : CALL 0x00515cf0
0052b81c : MOV EDI,dword ptr [ESP + 0x10]
0052b820 : POP EBP
0052b821 : MOV EDX,dword ptr [ESP + 0x20]
0052b825 : LEA ECX,[ESP + 0x20]
0052b829 : MOV dword ptr [EDI],EDX
0052b82b : MOV dword ptr [ESP + 0x20],0x0
0052b833 : CALL 0x0052aaa0
0052b838 : POP ESI
0052b839 : POP EDI
0052b83a : POP EBX
0052b83b : ADD ESP,0xc
0052b83e : RET 0x8

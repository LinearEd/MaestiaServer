PROGRAM  : Maestia.exe
FUNCTION : FUN_005250b0
ENTRY    : 005250b0
BODY     : [[005250b0, 0052513e]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_005250b0(undefined4 *param_1,uint param_2)

{
  undefined4 *puVar1;
  int iVar2;
  int *in_ECX;
  uint *puVar3;
  uint uVar4;
  
  iVar2 = *in_ECX;
  puVar3 = (uint *)(iVar2 + 8 + param_2 * 8);
  if ((*(int *)(iVar2 + 8 + param_2 * 8) != -2) &&
     (uVar4 = param_2, (*(uint *)(puVar3[1] + 0xc) & *(uint *)(iVar2 + 4)) == param_2)) {
    while ((puVar1 = (undefined4 *)puVar3[1], (puVar1[3] & *(uint *)(iVar2 + 4)) != param_2 ||
           ((puVar1[4] != param_1[2] ||
            (iVar2 = _strncmp((char *)*puVar1,(char *)*param_1,param_1[2]), iVar2 != 0))))) {
      uVar4 = *puVar3;
      if (uVar4 == 0xffffffff) {
        return 0xffffffff;
      }
      iVar2 = *in_ECX;
      puVar3 = (uint *)(iVar2 + 8 + uVar4 * 8);
    }
    return uVar4;
  }
  return 0xffffffff;
}



============================================================
DISASSEMBLY
============================================================
005250b0 : PUSH ECX
005250b1 : MOV EAX,dword ptr [ECX]
005250b3 : PUSH EBP
005250b4 : MOV EBP,dword ptr [ESP + 0x10]
005250b8 : CMP dword ptr [EAX + EBP*0x8 + 0x8],-0x2
005250bd : PUSH ESI
005250be : LEA ESI,[EAX + EBP*0x8 + 0x8]
005250c2 : PUSH EDI
005250c3 : MOV dword ptr [ESP + 0xc],ECX
005250c7 : MOV EDI,EBP
005250c9 : JZ 0x00525135
005250cb : MOV ECX,dword ptr [ESI + 0x4]
005250ce : MOV EDX,dword ptr [ECX + 0xc]
005250d1 : AND EDX,dword ptr [EAX + 0x4]
005250d4 : CMP EDX,EBP
005250d6 : JNZ 0x00525135
005250d8 : PUSH EBX
005250d9 : MOV EBX,dword ptr [ESP + 0x18]
005250dd : LEA ECX,[ECX]
005250e0 : MOV ECX,dword ptr [ESI + 0x4]
005250e3 : MOV EDX,dword ptr [ECX + 0xc]
005250e6 : AND EDX,dword ptr [EAX + 0x4]
005250e9 : CMP EDX,EBP
005250eb : JNZ 0x0052510d
005250ed : MOV EAX,dword ptr [EBX + 0x8]
005250f0 : CMP dword ptr [ECX + 0x10],EAX
005250f3 : JNZ 0x0052510d
005250f5 : MOV ECX,dword ptr [ECX]
005250f7 : PUSH EAX
005250f8 : MOV EAX,dword ptr [EBX]
005250fa : PUSH EAX
005250fb : PUSH ECX
005250fc : CALL 0x0063abcb
00525101 : ADD ESP,0xc
00525104 : TEST EAX,EAX
00525106 : SETZ AL
00525109 : TEST AL,AL
0052510b : JNZ 0x00525120
0052510d : MOV EDI,dword ptr [ESI]
0052510f : CMP EDI,-0x1
00525112 : JZ 0x0052512a
00525114 : MOV EDX,dword ptr [ESP + 0x10]
00525118 : MOV EAX,dword ptr [EDX]
0052511a : LEA ESI,[EAX + EDI*0x8 + 0x8]
0052511e : JMP 0x005250e0
00525120 : POP EBX
00525121 : MOV EAX,EDI
00525123 : POP EDI
00525124 : POP ESI
00525125 : POP EBP
00525126 : POP ECX
00525127 : RET 0x8
0052512a : POP EBX
0052512b : POP EDI
0052512c : POP ESI
0052512d : OR EAX,0xffffffff
00525130 : POP EBP
00525131 : POP ECX
00525132 : RET 0x8
00525135 : POP EDI
00525136 : POP ESI
00525137 : OR EAX,0xffffffff
0052513a : POP EBP
0052513b : POP ECX
0052513c : RET 0x8

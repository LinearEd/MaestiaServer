PROGRAM  : Maestia.exe
FUNCTION : FUN_008299d0
ENTRY    : 008299d0
BODY     : [[008299d0, 00829bb6]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008299d0(int param_1)

{
  undefined4 uVar1;
  int iVar2;
  char cVar3;
  int iVar4;
  int *piVar5;
  DWORD DVar6;
  int iVar7;
  undefined2 uVar8;
  
  FUN_008018d0(L"AvaGame::GotoCharacterList - start flow %d\n",*(undefined4 *)(param_1 + 0xc4));
  piVar5 = DAT_00da9894;
  uVar1 = DAT_00d72c20;
  if (*(int *)(param_1 + 0xc4) == 4) {
    uVar8 = 0;
    *(undefined1 *)(param_1 + 0x378) = 1;
    *(undefined1 *)(param_1 + 0x347) = 1;
    *(undefined1 *)(param_1 + 0x33a) = 1;
    *(undefined4 *)(param_1 + 0x33c) = uVar1;
    *(undefined1 *)(param_1 + 0x342) = 0;
    *(undefined1 *)(param_1 + 0x339) = 1;
    *(undefined1 *)(param_1 + 0x34b) = 0;
    *(undefined4 *)(param_1 + 0x164) = 0;
    iVar2 = DAT_017248d0;
    iVar4 = *piVar5;
    if (((iVar4 != 0) && (iVar7 = *(int *)(iVar4 + 300), iVar7 != 0)) &&
       (*(int *)(iVar7 + 0xc) != 0)) {
      if (iVar7 == 0) {
        iVar7 = 0;
      }
      else {
        iVar7 = *(int *)(iVar7 + 0xc);
      }
      if (*(int *)(iVar7 + 0x48) != 0) {
        if (*(int *)(iVar4 + 300) == 0) {
          iVar4 = 0;
        }
        else {
          iVar4 = *(int *)(*(int *)(iVar4 + 300) + 0xc);
        }
        uVar8 = *(undefined2 *)(*(int *)(iVar4 + 0x48) + 0x50);
      }
    }
    *(undefined2 *)(DAT_017248d0 + 0x24) = uVar8;
    cVar3 = FUN_008b18b0(iVar2);
    if (cVar3 != '\0') {
      FUN_008018d0(L"UserData file save..");
    }
    cVar3 = FUN_008b2600();
    if (cVar3 != '\0') {
      FUN_008018d0(L"GameOption file save..");
    }
    iVar4 = *(int *)(param_1 + 0x98);
    if (iVar4 != 0) {
      *(undefined8 *)(iVar4 + 0x10) = 0;
      *(undefined8 *)(iVar4 + 0x18) = 0x3f80000000000000;
    }
    piVar5 = (int *)FUN_007f91b0(*(undefined4 *)(DAT_0172491c + 0x90),param_1,1);
    *(int **)(param_1 + 0x370) = piVar5;
    if (piVar5 != (int *)0x0) {
      (**(code **)(*piVar5 + 0x14))(2);
      (**(code **)(**(int **)(param_1 + 0x370) + 0xc))(1);
      (**(code **)(**(int **)(param_1 + 0x370) + 0x2c))(0);
      DVar6 = timeGetTime();
      (**(code **)(**(int **)(param_1 + 0x370) + 0x30))(DVar6,1);
      (**(code **)(**(int **)(param_1 + 0x370) + 4))
                (*(int **)(param_1 + 0x370),"SetVersion",&DAT_00c33734,2);
    }
    FUN_00829410(param_1);
    FUN_008018d0(L"AvaGame::GotoCharacterList - done\n");
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
008299d0 : PUSH EBP
008299d1 : MOV EBP,ESP
008299d3 : AND ESP,0xfffffff8
008299d6 : SUB ESP,0x14
008299d9 : PUSH EBX
008299da : MOV EBX,dword ptr [EBP + 0x8]
008299dd : MOV EAX,dword ptr [EBX + 0xc4]
008299e3 : PUSH ESI
008299e4 : MOV ESI,dword ptr [0x00da98e8]
008299ea : PUSH EDI
008299eb : PUSH EAX
008299ec : PUSH 0xc33678
008299f1 : CALL 0x008018d0
008299f6 : ADD ESP,0x8
008299f9 : CMP dword ptr [EBX + 0xc4],0x4
00829a00 : JNZ 0x00829bae
00829a06 : MOVSS XMM0,dword ptr [0x00d72c20]
00829a0e : MOV ECX,dword ptr [0x00da9894]
00829a14 : XOR EDX,EDX
00829a16 : MOV byte ptr [EBX + 0x378],0x1
00829a1d : MOV byte ptr [EBX + 0x347],0x1
00829a24 : MOV byte ptr [EBX + 0x33a],0x1
00829a2b : MOVSS dword ptr [EBX + 0x33c],XMM0
00829a33 : MOV byte ptr [EBX + 0x342],0x0
00829a3a : MOV byte ptr [EBX + 0x339],0x1
00829a41 : MOV byte ptr [EBX + 0x34b],0x0
00829a48 : MOV dword ptr [EBX + 0x164],EDX
00829a4e : MOV EAX,dword ptr [ECX]
00829a50 : CMP EAX,EDX
00829a52 : JZ 0x00829a8b
00829a54 : MOV ECX,dword ptr [EAX + 0x12c]
00829a5a : CMP ECX,EDX
00829a5c : JZ 0x00829a8b
00829a5e : CMP dword ptr [ECX + 0xc],EDX
00829a61 : JZ 0x00829a8b
00829a63 : CMP ECX,EDX
00829a65 : JNZ 0x00829a6b
00829a67 : XOR ECX,ECX
00829a69 : JMP 0x00829a6e
00829a6b : MOV ECX,dword ptr [ECX + 0xc]
00829a6e : CMP dword ptr [ECX + 0x48],EDX
00829a71 : JZ 0x00829a8b
00829a73 : MOV EAX,dword ptr [EAX + 0x12c]
00829a79 : CMP EAX,EDX
00829a7b : JNZ 0x00829a81
00829a7d : XOR EAX,EAX
00829a7f : JMP 0x00829a84
00829a81 : MOV EAX,dword ptr [EAX + 0xc]
00829a84 : MOV EDX,dword ptr [EAX + 0x48]
00829a87 : MOVZX EDX,word ptr [EDX + 0x50]
00829a8b : MOV EAX,[0x017248d0]
00829a90 : PUSH EAX
00829a91 : MOV word ptr [EAX + 0x24],DX
00829a95 : CALL 0x008b18b0
00829a9a : TEST AL,AL
00829a9c : JZ 0x00829ab1
00829a9e : MOV ESI,dword ptr [0x00da98e8]
00829aa4 : PUSH 0xc336d0
00829aa9 : CALL 0x008018d0
00829aae : ADD ESP,0x4
00829ab1 : MOV EDI,dword ptr [0x017248cc]
00829ab7 : CALL 0x008b2600
00829abc : TEST AL,AL
00829abe : JZ 0x00829ad3
00829ac0 : MOV ESI,dword ptr [0x00da98e8]
00829ac6 : PUSH 0xc336fc
00829acb : CALL 0x008018d0
00829ad0 : ADD ESP,0x4
00829ad3 : MOV EAX,dword ptr [EBX + 0x98]
00829ad9 : TEST EAX,EAX
00829adb : JZ 0x00829b16
00829add : XORPS XMM0,XMM0
00829ae0 : MOVSS dword ptr [ESP + 0x10],XMM0
00829ae6 : MOVSS dword ptr [ESP + 0x14],XMM0
00829aec : MOVSS dword ptr [ESP + 0x18],XMM0
00829af2 : MOVSS XMM0,dword ptr [0x00c10fc4]
00829afa : MOVSS dword ptr [ESP + 0x1c],XMM0
00829b00 : MOVQ XMM0,qword ptr [ESP + 0x10]
00829b06 : MOVQ qword ptr [EAX + 0x10],XMM0
00829b0b : MOVQ XMM0,qword ptr [ESP + 0x18]
00829b11 : MOVQ qword ptr [EAX + 0x18],XMM0
00829b16 : MOV EAX,[0x0172491c]
00829b1b : MOV EAX,dword ptr [EAX + 0x90]
00829b21 : PUSH 0x1
00829b23 : PUSH EBX
00829b24 : PUSH EAX
00829b25 : MOV ECX,0xc3372c
00829b2a : CALL 0x007f91b0
00829b2f : MOV dword ptr [EBX + 0x370],EAX
00829b35 : TEST EAX,EAX
00829b37 : JZ 0x00829b95
00829b39 : MOV EDX,dword ptr [EAX]
00829b3b : MOV ECX,EAX
00829b3d : MOV EAX,dword ptr [EDX + 0x14]
00829b40 : PUSH 0x2
00829b42 : CALL EAX
00829b44 : MOV ECX,dword ptr [EBX + 0x370]
00829b4a : MOV EDX,dword ptr [ECX]
00829b4c : MOV EAX,dword ptr [EDX + 0xc]
00829b4f : PUSH 0x1
00829b51 : CALL EAX
00829b53 : MOV ECX,dword ptr [EBX + 0x370]
00829b59 : MOV EDX,dword ptr [ECX]
00829b5b : MOV EAX,dword ptr [EDX + 0x2c]
00829b5e : PUSH 0x0
00829b60 : CALL EAX
00829b62 : CALL dword ptr [0x00b85598]
00829b68 : MOV ECX,dword ptr [EBX + 0x370]
00829b6e : MOV EDX,dword ptr [ECX]
00829b70 : PUSH 0x1
00829b72 : PUSH EAX
00829b73 : MOV EAX,dword ptr [EDX + 0x30]
00829b76 : CALL EAX
00829b78 : MOV EAX,dword ptr [EBX + 0x370]
00829b7e : MOV ECX,dword ptr [EAX]
00829b80 : MOV EDX,dword ptr [ECX + 0x4]
00829b83 : PUSH 0x2
00829b85 : PUSH 0xc33734
00829b8a : PUSH 0xc33738
00829b8f : PUSH EAX
00829b90 : CALL EDX
00829b92 : ADD ESP,0x10
00829b95 : PUSH EBX
00829b96 : CALL 0x00829410
00829b9b : MOV ESI,dword ptr [0x00da98e8]
00829ba1 : PUSH 0xc33748
00829ba6 : CALL 0x008018d0
00829bab : ADD ESP,0x4
00829bae : POP EDI
00829baf : POP ESI
00829bb0 : POP EBX
00829bb1 : MOV ESP,EBP
00829bb3 : POP EBP
00829bb4 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_006983e0
ENTRY    : 006983e0
BODY     : [[006983e0, 00698543]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_006983e0(code *param_1,uint param_2,uint param_3)

{
  int *piVar1;
  uint uVar2;
  int in_EAX;
  int iVar3;
  uint uVar4;
  int *piVar5;
  int *piVar6;
  int *piVar7;
  undefined4 *unaff_EDI;
  uint local_8;
  
  piVar5 = (int *)unaff_EDI[0xb];
  piVar1 = (int *)unaff_EDI[0xe];
  iVar3 = piVar1[in_EAX * 2 + 1];
  if (((int)param_2 <= piVar1[1]) && (iVar3 <= (int)param_3)) {
    uVar4 = -unaff_EDI[1] & piVar1[1];
    if ((int)param_3 < (int)uVar4) {
      uVar4 = param_3;
    }
    local_8 = param_2;
    if (((int)param_2 <= iVar3) &&
       (local_8 = unaff_EDI[1] + -1 + iVar3 & -unaff_EDI[1], param_2 = local_8,
       (ushort)((ushort)iVar3 & *(short *)(unaff_EDI + 1) - 1U) == 0)) {
      if (*(char *)((int)unaff_EDI + 0x5b) != '\0') {
        piVar5 = piVar5 + -1;
        *(undefined1 *)((int)unaff_EDI + 0x5b) = 0;
      }
      *piVar5 = piVar1[in_EAX * 2];
      piVar5 = piVar5 + 1;
      param_2 = local_8 + unaff_EDI[1];
    }
    if (*(char *)((int)unaff_EDI + 0x5a) != '\0') {
      *(int *)(unaff_EDI[0x17] + 0x14) = (int)local_8 >> ((byte)*unaff_EDI & 0x1f);
      *(undefined1 *)((int)unaff_EDI + 0x5a) = 0;
    }
    if ((int)param_2 <= (int)uVar4) {
      piVar6 = piVar1;
      if ((int *)unaff_EDI[10] <= piVar5 + ((int)(uVar4 - param_2) >> ((byte)*unaff_EDI & 0x1f)) + 1
         ) {
        unaff_EDI[0xb] = piVar5;
        unaff_EDI[0xc] = 0x62;
        return CONCAT31((int3)((uint)(in_EAX * 8) >> 8),1);
      }
      do {
        if ((int)uVar4 < (int)param_2) break;
        *(undefined1 *)((int)unaff_EDI + 0x5b) = 0;
        uVar2 = piVar6[1];
        if ((int)param_2 < (int)uVar2) {
          iVar3 = uVar2 - piVar6[in_EAX * 2 + 1];
          if (iVar3 < (int)unaff_EDI[5]) {
            piVar7 = piVar6 + in_EAX * -2;
            *piVar5 = (int)((*piVar6 - piVar6[in_EAX * 2]) * (param_2 - piVar6[in_EAX * 2 + 1])) /
                      iVar3 + piVar6[in_EAX * 2];
            param_2 = param_2 + unaff_EDI[1];
            piVar5 = piVar5 + 1;
          }
          else {
            (*param_1)(piVar6);
            piVar7 = piVar6 + in_EAX * 2;
          }
        }
        else {
          if (uVar2 == param_2) {
            *(undefined1 *)((int)unaff_EDI + 0x5b) = 1;
            *piVar5 = *piVar6;
            piVar5 = piVar5 + 1;
            param_2 = param_2 + unaff_EDI[1];
          }
          piVar7 = piVar6 + in_EAX * -2;
        }
        piVar6 = piVar7;
      } while (piVar1 <= piVar7);
    }
  }
  unaff_EDI[0xe] = unaff_EDI[0xe] + in_EAX * -8;
  unaff_EDI[0xb] = piVar5;
  return in_EAX * 8 & 0xffffff00;
}



============================================================
DISASSEMBLY
============================================================
006983e0 : SUB ESP,0x10
006983e3 : PUSH EBX
006983e4 : MOV EBX,dword ptr [EDI + 0x2c]
006983e7 : ADD EAX,EAX
006983e9 : PUSH EBP
006983ea : MOV EBP,dword ptr [EDI + 0x38]
006983ed : ADD EAX,EAX
006983ef : PUSH ESI
006983f0 : MOV ESI,dword ptr [EBP + 0x4]
006983f3 : ADD EAX,EAX
006983f5 : CMP ESI,dword ptr [ESP + 0x24]
006983f9 : MOV ECX,dword ptr [EAX + EBP*0x1 + 0x4]
006983fd : MOV dword ptr [ESP + 0x10],EAX
00698401 : JL 0x00698535
00698407 : CMP ECX,dword ptr [ESP + 0x28]
0069840b : JG 0x00698535
00698411 : MOV EDX,dword ptr [EDI + 0x4]
00698414 : NEG EDX
00698416 : MOV dword ptr [ESP + 0x18],EDX
0069841a : AND EDX,ESI
0069841c : MOV ESI,dword ptr [ESP + 0x28]
00698420 : CMP EDX,ESI
00698422 : MOV dword ptr [ESP + 0xc],EDX
00698426 : JLE 0x0069842e
00698428 : MOV dword ptr [ESP + 0xc],ESI
0069842c : MOV EDX,ESI
0069842e : MOV ESI,dword ptr [ESP + 0x24]
00698432 : CMP ECX,ESI
00698434 : MOV dword ptr [ESP + 0x14],ESI
00698438 : JL 0x00698470
0069843a : MOV ESI,dword ptr [EDI + 0x4]
0069843d : MOV DX,word ptr [EDI + 0x4]
00698441 : LEA ESI,[ESI + ECX*0x1 + -0x1]
00698445 : AND ESI,dword ptr [ESP + 0x18]
00698449 : DEC DX
0069844b : MOV dword ptr [ESP + 0x14],ESI
0069844f : TEST CX,DX
00698452 : JNZ 0x0069846c
00698454 : CMP byte ptr [EDI + 0x5b],0x0
00698458 : JZ 0x00698461
0069845a : SUB EBX,0x4
0069845d : MOV byte ptr [EDI + 0x5b],0x0
00698461 : MOV ECX,dword ptr [EAX + EBP*0x1]
00698464 : MOV dword ptr [EBX],ECX
00698466 : ADD EBX,0x4
00698469 : ADD ESI,dword ptr [EDI + 0x4]
0069846c : MOV EDX,dword ptr [ESP + 0xc]
00698470 : CMP byte ptr [EDI + 0x5a],0x0
00698474 : JZ 0x0069848c
00698476 : MOV ECX,dword ptr [EDI]
00698478 : MOV EDX,dword ptr [ESP + 0x14]
0069847c : SAR EDX,CL
0069847e : MOV ECX,dword ptr [EDI + 0x5c]
00698481 : MOV dword ptr [ECX + 0x14],EDX
00698484 : MOV EDX,dword ptr [ESP + 0xc]
00698488 : MOV byte ptr [EDI + 0x5a],0x0
0069848c : CMP EDX,ESI
0069848e : JL 0x00698535
00698494 : MOV ECX,dword ptr [EDI]
00698496 : SUB EDX,ESI
00698498 : SAR EDX,CL
0069849a : LEA EDX,[EBX + EDX*0x4 + 0x4]
0069849e : CMP EDX,dword ptr [EDI + 0x28]
006984a1 : JC 0x006984b6
006984a3 : POP ESI
006984a4 : POP EBP
006984a5 : MOV dword ptr [EDI + 0x2c],EBX
006984a8 : MOV dword ptr [EDI + 0x30],0x62
006984af : MOV AL,0x1
006984b1 : POP EBX
006984b2 : ADD ESP,0x10
006984b5 : RET
006984b6 : MOV dword ptr [ESP + 0x18],EBP
006984ba : LEA EBX,[EBX]
006984c0 : CMP ESI,dword ptr [ESP + 0xc]
006984c4 : JG 0x00698535
006984c6 : MOV byte ptr [EDI + 0x5b],0x0
006984ca : MOV ECX,dword ptr [EBP + 0x4]
006984cd : CMP ECX,ESI
006984cf : JLE 0x0069851c
006984d1 : MOV EDX,dword ptr [EAX + EBP*0x1 + 0x4]
006984d5 : SUB ECX,EDX
006984d7 : CMP ECX,dword ptr [EDI + 0x14]
006984da : MOV dword ptr [ESP + 0x24],ECX
006984de : JL 0x006984f2
006984e0 : PUSH EBP
006984e1 : CALL dword ptr [ESP + 0x24]
006984e5 : MOV EAX,dword ptr [ESP + 0x14]
006984e9 : ADD ESP,0x4
006984ec : ADD EBP,dword ptr [ESP + 0x10]
006984f0 : JMP 0x0069852f
006984f2 : MOV ECX,dword ptr [EAX + EBP*0x1]
006984f5 : MOV EAX,dword ptr [EBP]
006984f8 : SUB EAX,ECX
006984fa : MOV ECX,ESI
006984fc : SUB ECX,EDX
006984fe : IMUL EAX,ECX
00698501 : CDQ
00698502 : IDIV dword ptr [ESP + 0x24]
00698506 : ADD EBX,0x4
00698509 : MOV EDX,EAX
0069850b : MOV EAX,dword ptr [ESP + 0x10]
0069850f : ADD EDX,dword ptr [EAX + EBP*0x1]
00698512 : SUB EBP,EAX
00698514 : MOV dword ptr [EBX + -0x4],EDX
00698517 : ADD ESI,dword ptr [EDI + 0x4]
0069851a : JMP 0x0069852f
0069851c : JNZ 0x0069852d
0069851e : MOV byte ptr [EDI + 0x5b],0x1
00698522 : MOV ECX,dword ptr [EBP]
00698525 : MOV dword ptr [EBX],ECX
00698527 : ADD EBX,0x4
0069852a : ADD ESI,dword ptr [EDI + 0x4]
0069852d : SUB EBP,EAX
0069852f : CMP EBP,dword ptr [ESP + 0x18]
00698533 : JNC 0x006984c0
00698535 : SUB dword ptr [EDI + 0x38],EAX
00698538 : POP ESI
00698539 : POP EBP
0069853a : MOV dword ptr [EDI + 0x2c],EBX
0069853d : XOR AL,AL
0069853f : POP EBX
00698540 : ADD ESP,0x10
00698543 : RET

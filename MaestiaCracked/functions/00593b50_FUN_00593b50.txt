PROGRAM  : Maestia.exe
FUNCTION : FUN_00593b50
ENTRY    : 00593b50
BODY     : [[00593b50, 00593cfa]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00593b50(void)

{
  uint uVar1;
  char cVar2;
  int iVar3;
  int in_ECX;
  uint uVar4;
  uint local_24;
  uint local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined2 local_8;
  undefined1 local_6;
  undefined1 local_5;
  undefined1 local_4;
  undefined1 local_3;
  
  local_10 = 1;
  local_c = 0;
  local_8 = 0;
  local_6 = 0;
  local_5 = 0xff;
  local_4 = 0;
  local_3 = 0;
  cVar2 = FUN_00520600(&local_10);
  if (cVar2 == '\0') {
    local_14 = local_14 & 0xffff0000;
    iVar3 = FUN_00571c40(5);
    *(undefined4 *)(iVar3 + 4) = 2;
    *(int *)(in_ECX + 4) = *(int *)(in_ECX + 4) + 1;
    if (*(GRefCountNTSImpl **)(iVar3 + 8) != (GRefCountNTSImpl *)0x0) {
      GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar3 + 8));
    }
    *(int *)(iVar3 + 8) = in_ECX;
    if (*(GRefCountNTSImpl **)(iVar3 + 0xc) != (GRefCountNTSImpl *)0x0) {
      GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar3 + 0xc));
    }
    *(undefined4 *)(iVar3 + 0xc) = 0;
    *(undefined4 *)(iVar3 + 0x10) = 1;
    *(undefined4 *)(iVar3 + 0x14) = 0;
    *(undefined4 *)(iVar3 + 0x18) = 0xff000000;
    *(uint *)(iVar3 + 0x1c) = local_14;
  }
  else {
    local_24 = local_24 & 0xffff0000;
    iVar3 = FUN_00571c40(4);
    *(undefined4 *)(iVar3 + 4) = 2;
    *(int *)(in_ECX + 4) = *(int *)(in_ECX + 4) + 1;
    if (*(GRefCountNTSImpl **)(iVar3 + 8) != (GRefCountNTSImpl *)0x0) {
      GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar3 + 8));
    }
    *(int *)(iVar3 + 8) = in_ECX;
    if (*(GRefCountNTSImpl **)(iVar3 + 0xc) != (GRefCountNTSImpl *)0x0) {
      GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar3 + 0xc));
    }
    *(undefined4 *)(iVar3 + 0xc) = 0;
    *(undefined4 *)(iVar3 + 0x10) = 1;
    *(undefined4 *)(iVar3 + 0x14) = 0;
    *(undefined4 *)(iVar3 + 0x18) = 0xff000000;
    *(uint *)(iVar3 + 0x1c) = local_24;
  }
  *(byte *)(in_ECX + 0x66) = *(byte *)(in_ECX + 0x66) | 0x20;
  FUN_0058c6c0(0);
  uVar1 = *(uint *)(*(int *)(in_ECX + 0xa0) + 0xa9c);
  uVar4 = 0;
  if (uVar1 != 0) {
    do {
      iVar3 = *(int *)(*(int *)(*(int *)(in_ECX + 0xa0) + 0xa98) + uVar4 * 4);
      if ((*(int *)(iVar3 + 0x1b8) == 0) ||
         (iVar3 = FUN_0051d0a0(*(undefined4 *)(iVar3 + 0xa0)), iVar3 == 0)) {
        iVar3 = 0;
      }
      else {
        iVar3 = FUN_0054ed10();
      }
      if (in_ECX == iVar3) {
        FUN_00593440(in_ECX);
      }
      uVar4 = uVar4 + 1;
    } while (uVar4 < uVar1);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00593b50 : SUB ESP,0x30
00593b53 : PUSH EBX
00593b54 : PUSH EBP
00593b55 : PUSH ESI
00593b56 : MOV ESI,ECX
00593b58 : PUSH EDI
00593b59 : XOR EBX,EBX
00593b5b : LEA ECX,[ESP + 0x30]
00593b5f : XOR EAX,EAX
00593b61 : PUSH ECX
00593b62 : MOV EBP,0x1
00593b67 : MOV ECX,ESI
00593b69 : MOV dword ptr [ESP + 0x34],EBP
00593b6d : MOV dword ptr [ESP + 0x38],EBX
00593b71 : MOV word ptr [ESP + 0x3c],AX
00593b76 : MOV byte ptr [ESP + 0x3e],BL
00593b7a : MOV byte ptr [ESP + 0x3f],0xff
00593b7f : MOV byte ptr [ESP + 0x40],BL
00593b83 : MOV byte ptr [ESP + 0x41],BL
00593b87 : CALL 0x00520600
00593b8c : TEST AL,AL
00593b8e : MOV EAX,dword ptr [ESI + 0xa0]
00593b94 : JZ 0x00593c0b
00593b96 : XOR EDX,EDX
00593b98 : PUSH 0x4
00593b9a : LEA ECX,[EAX + 0xa2c]
00593ba0 : MOV dword ptr [ESP + 0x14],EBP
00593ba4 : MOV dword ptr [ESP + 0x18],EBX
00593ba8 : MOV word ptr [ESP + 0x1c],DX
00593bad : MOV byte ptr [ESP + 0x1e],BL
00593bb1 : MOV byte ptr [ESP + 0x1f],0xff
00593bb6 : MOV byte ptr [ESP + 0x20],BL
00593bba : MOV byte ptr [ESP + 0x21],BL
00593bbe : CALL 0x00571c40
00593bc3 : MOV EDI,EAX
00593bc5 : MOV dword ptr [EDI + 0x4],0x2
00593bcc : ADD dword ptr [ESI + 0x4],EBP
00593bcf : MOV ECX,dword ptr [EDI + 0x8]
00593bd2 : CMP ECX,EBX
00593bd4 : JZ 0x00593bdb
00593bd6 : CALL 0x004ff7c0
00593bdb : MOV dword ptr [EDI + 0x8],ESI
00593bde : MOV ECX,dword ptr [EDI + 0xc]
00593be1 : CMP ECX,EBX
00593be3 : JZ 0x00593bea
00593be5 : CALL 0x004ff7c0
00593bea : MOV EAX,dword ptr [ESP + 0x10]
00593bee : MOV ECX,dword ptr [ESP + 0x14]
00593bf2 : MOV EDX,dword ptr [ESP + 0x18]
00593bf6 : MOV dword ptr [EDI + 0xc],EBX
00593bf9 : MOV dword ptr [EDI + 0x10],EAX
00593bfc : MOV EAX,dword ptr [ESP + 0x1c]
00593c00 : MOV dword ptr [EDI + 0x14],ECX
00593c03 : MOV dword ptr [EDI + 0x18],EDX
00593c06 : MOV dword ptr [EDI + 0x1c],EAX
00593c09 : JMP 0x00593c7e
00593c0b : XOR ECX,ECX
00593c0d : MOV word ptr [ESP + 0x28],CX
00593c12 : PUSH 0x5
00593c14 : LEA ECX,[EAX + 0xa2c]
00593c1a : MOV dword ptr [ESP + 0x24],EBP
00593c1e : MOV dword ptr [ESP + 0x28],EBX
00593c22 : MOV byte ptr [ESP + 0x2e],BL
00593c26 : MOV byte ptr [ESP + 0x2f],0xff
00593c2b : MOV byte ptr [ESP + 0x30],BL
00593c2f : MOV byte ptr [ESP + 0x31],BL
00593c33 : CALL 0x00571c40
00593c38 : MOV EDI,EAX
00593c3a : MOV dword ptr [EDI + 0x4],0x2
00593c41 : ADD dword ptr [ESI + 0x4],EBP
00593c44 : MOV ECX,dword ptr [EDI + 0x8]
00593c47 : CMP ECX,EBX
00593c49 : JZ 0x00593c50
00593c4b : CALL 0x004ff7c0
00593c50 : MOV dword ptr [EDI + 0x8],ESI
00593c53 : MOV ECX,dword ptr [EDI + 0xc]
00593c56 : CMP ECX,EBX
00593c58 : JZ 0x00593c5f
00593c5a : CALL 0x004ff7c0
00593c5f : MOV EDX,dword ptr [ESP + 0x20]
00593c63 : MOV EAX,dword ptr [ESP + 0x24]
00593c67 : MOV ECX,dword ptr [ESP + 0x28]
00593c6b : MOV dword ptr [EDI + 0xc],EBX
00593c6e : MOV dword ptr [EDI + 0x10],EDX
00593c71 : MOV EDX,dword ptr [ESP + 0x2c]
00593c75 : MOV dword ptr [EDI + 0x14],EAX
00593c78 : MOV dword ptr [EDI + 0x18],ECX
00593c7b : MOV dword ptr [EDI + 0x1c],EDX
00593c7e : OR byte ptr [ESI + 0x66],0x20
00593c82 : PUSH EBX
00593c83 : MOV ECX,ESI
00593c85 : CALL 0x0058c6c0
00593c8a : MOV EAX,dword ptr [ESI + 0xa0]
00593c90 : MOV EBP,dword ptr [EAX + 0xa9c]
00593c96 : XOR EDI,EDI
00593c98 : CMP EBP,EBX
00593c9a : JBE 0x00593cf3
00593c9c : LEA ESP,[ESP]
00593ca0 : MOV ECX,dword ptr [ESI + 0xa0]
00593ca6 : MOV EDX,dword ptr [ECX + 0xa98]
00593cac : MOV EAX,dword ptr [EDX + EDI*0x4]
00593caf : MOV ECX,dword ptr [EAX + 0x1b8]
00593cb5 : CMP ECX,EBX
00593cb7 : JZ 0x00593cd3
00593cb9 : MOV EAX,dword ptr [EAX + 0xa0]
00593cbf : PUSH EAX
00593cc0 : CALL 0x0051d0a0
00593cc5 : CMP EAX,EBX
00593cc7 : JZ 0x00593cd3
00593cc9 : LEA ECX,[EAX + 0x68]
00593ccc : CALL 0x0054ed10
00593cd1 : JMP 0x00593cd5
00593cd3 : XOR EAX,EAX
00593cd5 : CMP ESI,EAX
00593cd7 : JNZ 0x00593cee
00593cd9 : MOV ECX,dword ptr [ESI + 0xa0]
00593cdf : MOV EDX,dword ptr [ECX + 0xa98]
00593ce5 : MOV ECX,dword ptr [EDX + EDI*0x4]
00593ce8 : PUSH ESI
00593ce9 : CALL 0x00593440
00593cee : INC EDI
00593cef : CMP EDI,EBP
00593cf1 : JC 0x00593ca0
00593cf3 : POP EDI
00593cf4 : POP ESI
00593cf5 : POP EBP
00593cf6 : POP EBX
00593cf7 : ADD ESP,0x30
00593cfa : RET

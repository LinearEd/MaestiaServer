PROGRAM  : Maestia.exe
FUNCTION : FUN_009a1960
ENTRY    : 009a1960
BODY     : [[009a1960, 009a1b61]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009a1960(undefined4 param_1)

{
  int iVar1;
  char cVar2;
  uint uVar3;
  undefined4 uVar4;
  int *piVar5;
  int iVar6;
  uint local_38;
  undefined1 local_34 [4];
  undefined2 local_30;
  undefined4 local_20;
  uint local_1c;
  undefined4 local_18;
  undefined4 local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4118f;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar1 = *(int *)(*DAT_00da9894 + 0x40);
  piVar5 = (int *)0x0;
  iVar6 = 0;
  if (0 < iVar1) {
    do {
      piVar5 = (int *)FUN_008eb810(uVar3);
      if (((piVar5 != (int *)0x0) && ((char)piVar5[0x19] != '\0')) &&
         (cVar2 = (**(code **)(*piVar5 + 0x9c))(&local_18,&local_14), cVar2 != '\0')) break;
      iVar6 = iVar6 + 1;
    } while (iVar6 < iVar1);
  }
  if (iVar6 == iVar1) {
    local_1c = 7;
    local_20 = 0;
    local_30 = 0;
    FUN_00406360(L"IDS_ROOTING_NO_SLOT",0x13);
    local_8 = 0;
    piVar5 = *(int **)(*DAT_00da9894 + 0x1a8);
    uVar4 = FUN_0081d120(local_34);
    local_8._0_1_ = 1;
    (**(code **)(*piVar5 + 0x44))(uVar4,3);
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_38) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_8 = 0xffffffff;
    if (7 < local_1c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    ExceptionList = local_10;
    return;
  }
  if (piVar5 == (int *)0x0) {
    ExceptionList = local_10;
    return;
  }
  if ((DAT_0172491c == 0) || (iVar1 = *(int *)(DAT_0172491c + 0x17c), iVar1 == 0)) {
LAB_009a1b1d:
    FUN_008efa90(0,param_1,0,piVar5[0xb],local_18,local_14);
  }
  else {
    if ((short)param_1 == 0) {
      if ((*(int *)(iVar1 + 0x1858) == 0) || (*(int *)(iVar1 + 0x1750) == 0)) goto LAB_009a1b1d;
      uVar4 = 0x1a;
    }
    else {
      if ((((short)param_1 != 1) || (*(int *)(iVar1 + 0x185c) == 0)) ||
         (*(int *)(iVar1 + 0x1754) == 0)) goto LAB_009a1b1d;
      uVar4 = 0x1b;
    }
    FUN_008efa90(0,uVar4,0,piVar5[0xb],0xff,0xff);
    FUN_008efa90(0,param_1,0,piVar5[0xb],0xff,0xff);
  }
  (**(code **)**(undefined4 **)(*DAT_00da9894 + 0x114))("HideToolTip");
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
009a1960 : PUSH EBP
009a1961 : MOV EBP,ESP
009a1963 : PUSH -0x1
009a1965 : PUSH 0xb4118f
009a196a : MOV EAX,FS:[0x0]
009a1970 : PUSH EAX
009a1971 : SUB ESP,0x40
009a1974 : PUSH EBX
009a1975 : PUSH ESI
009a1976 : PUSH EDI
009a1977 : MOV EAX,[0x00d66fa0]
009a197c : XOR EAX,EBP
009a197e : PUSH EAX
009a197f : LEA EAX,[EBP + -0xc]
009a1982 : MOV FS:[0x0],EAX
009a1988 : MOV EAX,[0x00da9894]
009a198d : MOV EAX,dword ptr [EAX]
009a198f : MOV EBX,dword ptr [EAX + 0x40]
009a1992 : XOR ESI,ESI
009a1994 : XOR EDI,EDI
009a1996 : TEST EBX,EBX
009a1998 : JLE 0x009a19d2
009a199a : MOV ECX,dword ptr [0x00da9894]
009a19a0 : MOV EAX,dword ptr [ECX]
009a19a2 : MOV ECX,EDI
009a19a4 : CALL 0x008eb810
009a19a9 : MOV ESI,EAX
009a19ab : TEST ESI,ESI
009a19ad : JZ 0x009a19cd
009a19af : CMP byte ptr [ESI + 0x64],0x0
009a19b3 : JZ 0x009a19cd
009a19b5 : MOV EDX,dword ptr [ESI]
009a19b7 : MOV EDX,dword ptr [EDX + 0x9c]
009a19bd : LEA EAX,[EBP + -0x10]
009a19c0 : PUSH EAX
009a19c1 : LEA ECX,[EBP + -0x14]
009a19c4 : PUSH ECX
009a19c5 : MOV ECX,ESI
009a19c7 : CALL EDX
009a19c9 : TEST AL,AL
009a19cb : JNZ 0x009a19d2
009a19cd : INC EDI
009a19ce : CMP EDI,EBX
009a19d0 : JL 0x009a199a
009a19d2 : CMP EDI,EBX
009a19d4 : JNZ 0x009a1a8c
009a19da : PUSH 0x13
009a19dc : XOR EAX,EAX
009a19de : PUSH 0xc891a0
009a19e3 : LEA ECX,[EBP + -0x30]
009a19e6 : MOV dword ptr [EBP + -0x18],0x7
009a19ed : MOV dword ptr [EBP + -0x1c],0x0
009a19f4 : MOV word ptr [EBP + -0x2c],AX
009a19f8 : CALL 0x00406360
009a19fd : XOR EBX,EBX
009a19ff : MOV dword ptr [EBP + -0x4],EBX
009a1a02 : MOV ECX,dword ptr [0x00da9894]
009a1a08 : MOV EAX,dword ptr [ECX]
009a1a0a : MOV ECX,dword ptr [0x0172491c]
009a1a10 : MOV ESI,dword ptr [EAX + 0x1a8]
009a1a16 : LEA EDX,[EBP + -0x30]
009a1a19 : PUSH EDX
009a1a1a : LEA EDI,[EBP + -0x4c]
009a1a1d : CALL 0x0081d120
009a1a22 : MOV byte ptr [EBP + -0x4],0x1
009a1a26 : MOV EDX,dword ptr [ESI]
009a1a28 : PUSH 0x3
009a1a2a : PUSH EAX
009a1a2b : MOV EAX,dword ptr [EDX + 0x44]
009a1a2e : MOV ECX,ESI
009a1a30 : CALL EAX
009a1a32 : MOV byte ptr [EBP + -0x4],BL
009a1a35 : MOV ESI,0x8
009a1a3a : CMP dword ptr [EBP + -0x34],ESI
009a1a3d : JC 0x009a1a47
009a1a3f : MOV ECX,dword ptr [EBP + -0x48]
009a1a42 : CALL 0x006f04e0
009a1a47 : MOV EDI,0x7
009a1a4c : XOR ECX,ECX
009a1a4e : MOV dword ptr [EBP + -0x34],EDI
009a1a51 : MOV dword ptr [EBP + -0x38],EBX
009a1a54 : MOV word ptr [EBP + -0x48],CX
009a1a58 : MOV dword ptr [EBP + -0x4],0xffffffff
009a1a5f : CMP dword ptr [EBP + -0x18],ESI
009a1a62 : JC 0x009a1a6c
009a1a64 : MOV ECX,dword ptr [EBP + -0x2c]
009a1a67 : CALL 0x006f04e0
009a1a6c : XOR EDX,EDX
009a1a6e : MOV dword ptr [EBP + -0x18],EDI
009a1a71 : MOV dword ptr [EBP + -0x1c],EBX
009a1a74 : MOV word ptr [EBP + -0x2c],DX
009a1a78 : MOV ECX,dword ptr [EBP + -0xc]
009a1a7b : MOV dword ptr FS:[0x0],ECX
009a1a82 : POP ECX
009a1a83 : POP EDI
009a1a84 : POP ESI
009a1a85 : POP EBX
009a1a86 : MOV ESP,EBP
009a1a88 : POP EBP
009a1a89 : RET 0x4
009a1a8c : TEST ESI,ESI
009a1a8e : JZ 0x009a1b4e
009a1a94 : MOV EAX,[0x0172491c]
009a1a99 : TEST EAX,EAX
009a1a9b : JZ 0x009a1b1a
009a1a9d : MOV EAX,dword ptr [EAX + 0x17c]
009a1aa3 : TEST EAX,EAX
009a1aa5 : JZ 0x009a1b1a
009a1aa7 : MOV EDI,dword ptr [EBP + 0x8]
009a1aaa : TEST DI,DI
009a1aad : JNZ 0x009a1ac8
009a1aaf : CMP dword ptr [EAX + 0x1858],0x0
009a1ab6 : JZ 0x009a1b1d
009a1ab8 : CMP dword ptr [EAX + 0x1750],0x0
009a1abf : JZ 0x009a1b1d
009a1ac1 : MOV EAX,0x1a
009a1ac6 : JMP 0x009a1ae5
009a1ac8 : CMP DI,0x1
009a1acc : JNZ 0x009a1b1d
009a1ace : CMP dword ptr [EAX + 0x185c],0x0
009a1ad5 : JZ 0x009a1b1d
009a1ad7 : CMP dword ptr [EAX + 0x1754],0x0
009a1ade : JZ 0x009a1b1d
009a1ae0 : MOV EAX,0x1b
009a1ae5 : MOV ECX,dword ptr [ESI + 0x2c]
009a1ae8 : PUSH 0xff
009a1aed : PUSH 0xff
009a1af2 : PUSH ECX
009a1af3 : PUSH 0x0
009a1af5 : PUSH EAX
009a1af6 : PUSH 0x0
009a1af8 : CALL 0x008efa90
009a1afd : MOV EDX,dword ptr [ESI + 0x2c]
009a1b00 : PUSH 0xff
009a1b05 : PUSH 0xff
009a1b0a : PUSH EDX
009a1b0b : PUSH 0x0
009a1b0d : PUSH EDI
009a1b0e : PUSH 0x0
009a1b10 : CALL 0x008efa90
009a1b15 : ADD ESP,0x30
009a1b18 : JMP 0x009a1b36
009a1b1a : MOV EDI,dword ptr [EBP + 0x8]
009a1b1d : MOV EAX,dword ptr [EBP + -0x10]
009a1b20 : MOV ECX,dword ptr [EBP + -0x14]
009a1b23 : MOV EDX,dword ptr [ESI + 0x2c]
009a1b26 : PUSH EAX
009a1b27 : PUSH ECX
009a1b28 : PUSH EDX
009a1b29 : PUSH 0x0
009a1b2b : PUSH EDI
009a1b2c : PUSH 0x0
009a1b2e : CALL 0x008efa90
009a1b33 : ADD ESP,0x18
009a1b36 : MOV EAX,[0x00da9894]
009a1b3b : MOV ECX,dword ptr [EAX]
009a1b3d : MOV ECX,dword ptr [ECX + 0x114]
009a1b43 : MOV EDX,dword ptr [ECX]
009a1b45 : MOV EAX,dword ptr [EDX]
009a1b47 : PUSH 0xc891c8
009a1b4c : CALL EAX
009a1b4e : MOV ECX,dword ptr [EBP + -0xc]
009a1b51 : MOV dword ptr FS:[0x0],ECX
009a1b58 : POP ECX
009a1b59 : POP EDI
009a1b5a : POP ESI
009a1b5b : POP EBX
009a1b5c : MOV ESP,EBP
009a1b5e : POP EBP
009a1b5f : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_007fd150
ENTRY    : 007fd150
BODY     : [[007fd150, 007fd69a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007fd150(void)

{
  uint uVar1;
  uint uVar2;
  int in_ECX;
  wchar_t *pwVar3;
  undefined1 local_114 [28];
  undefined1 local_f8 [28];
  undefined1 local_dc [28];
  undefined1 local_c0 [28];
  undefined1 local_a4 [28];
  undefined1 local_88 [28];
  undefined1 local_6c [28];
  undefined1 local_50 [28];
  undefined1 local_34 [4];
  undefined2 local_30;
  undefined4 local_20;
  uint local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b29534;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  uVar2 = (uint)*(byte *)(in_ECX + 0xf1);
  local_18 = (uint)(*(ushort *)(in_ECX + 0xf0) & 0xff);
  *(uint *)(in_ECX + 0x160) = uVar2;
  *(uint *)(in_ECX + 0x164) = local_18;
  local_14 = local_18;
  FUN_008018d0(L"================================================",uVar1);
  FUN_008018d0(L"Checking Pixel Shader");
  FUN_008018d0(L"================================================");
  if (uVar2 != 1) {
    if (uVar2 == 2) {
      if ((short)local_14 == 0) {
        FUN_00406460(L"PS_2_0");
        local_8 = 5;
        FUN_00405eb0(local_c0,0,0xffffffff);
        local_8 = 0xffffffff;
        FUN_00406560();
        *(undefined2 *)(*(int *)(in_ECX + 0x17c) + 0x4c) = 0;
        *(undefined2 *)(*(int *)(in_ECX + 0x17c) + 0x4e) = 0;
        *(undefined2 *)(*(int *)(in_ECX + 0x17c) + 0x4a) = 0x20;
        FUN_008018d0(L"PIXEL Shader Version : PS_2_0");
        FUN_008018d0(L"Usable Constant Boolean Count : 0");
        FUN_008018d0(L"Usable Constant Int Count : 0");
        FUN_008018d0(L"Usable Constant Float Count : 32");
        ExceptionList = local_10;
        return;
      }
      FUN_00406460(L"PS_2_X");
      local_8 = 4;
      FUN_00405eb0(local_50,0,0xffffffff);
      local_8 = 0xffffffff;
      FUN_00406560();
      *(undefined2 *)(*(int *)(in_ECX + 0x17c) + 0x4c) = 0x10;
      *(undefined2 *)(*(int *)(in_ECX + 0x17c) + 0x4e) = 0x10;
      *(undefined2 *)(*(int *)(in_ECX + 0x17c) + 0x4a) = 0xe0;
      FUN_008018d0(L"PIXEL Shader Version : PS_2_X");
      FUN_008018d0(L"Usable Constant Boolean Count : 16");
      FUN_008018d0(L"Usable Constant Int Count : 16");
      FUN_008018d0(L"Usable Constant Float Count : 224");
      ExceptionList = local_10;
      return;
    }
    if (uVar2 != 3) {
      FUN_00406460(&DAT_00c276a4);
      local_8 = 8;
      FUN_00405eb0(local_34,0,0xffffffff);
      local_8 = 0xffffffff;
      if (local_1c < 8) {
        local_1c = 7;
        local_20 = 0;
        local_30 = 0;
        FUN_008018d0(L"Can\'t use Pixel Shader");
        ExceptionList = local_10;
        return;
      }
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    if ((short)local_14 == 0) {
      FUN_00406460(L"PS_3_0");
      local_8 = 7;
      FUN_00405eb0(local_88,0,0xffffffff);
      local_8 = 0xffffffff;
      FUN_00406560();
      pwVar3 = L"PIXEL Shader Version : PS_3_0";
    }
    else {
      FUN_00406460(L"PS_3_X");
      local_8 = 6;
      FUN_00405eb0(local_f8,0,0xffffffff);
      local_8 = 0xffffffff;
      FUN_00406560();
      pwVar3 = L"PIXEL Shader Version : PS_3_X";
    }
    FUN_008018d0(pwVar3);
    *(undefined2 *)(*(int *)(in_ECX + 0x17c) + 0x4c) = 0x10;
    *(undefined2 *)(*(int *)(in_ECX + 0x17c) + 0x4e) = 0x10;
    *(undefined2 *)(*(int *)(in_ECX + 0x17c) + 0x4a) = 0xe0;
    FUN_008018d0(L"Usable Constant Boolean Count : 16");
    FUN_008018d0(L"Usable Constant Int Count : 16");
    pwVar3 = L"Usable Constant Float Count : 224";
    goto LAB_007fd67b;
  }
  switch(local_18) {
  case 1:
    FUN_00406460(L"PS_1_1");
    local_8 = 0;
    FUN_00405eb0(local_6c,0,0xffffffff);
    local_8 = 0xffffffff;
    FUN_00406560();
    pwVar3 = L"PIXEL Shader Version : PS_1_1";
    break;
  case 2:
    FUN_00406460(L"PS_1_2");
    local_8 = 1;
    FUN_00405eb0(local_a4,0,0xffffffff);
    local_8 = 0xffffffff;
    FUN_00406560();
    pwVar3 = L"PIXEL Shader Version : PS_1_2";
    break;
  case 3:
    FUN_00406460(L"PS_1_3");
    local_8 = 2;
    FUN_00405eb0(local_dc,0,0xffffffff);
    local_8 = 0xffffffff;
    FUN_00406560();
    pwVar3 = L"PIXEL Shader Version : PS_1_3";
    break;
  case 4:
    FUN_00406460(L"PS_1_4");
    local_8 = 3;
    FUN_00405eb0(local_114,0,0xffffffff);
    local_8 = 0xffffffff;
    FUN_00406560();
    pwVar3 = L"PIXEL Shader Version : PS_1_4";
    break;
  default:
    goto switchD_007fd4fb_default;
  }
  FUN_008018d0(pwVar3);
switchD_007fd4fb_default:
  *(undefined2 *)(*(int *)(in_ECX + 0x17c) + 0x4c) = 0;
  *(undefined2 *)(*(int *)(in_ECX + 0x17c) + 0x4e) = 0;
  *(undefined2 *)(*(int *)(in_ECX + 0x17c) + 0x4a) = 8;
  FUN_008018d0(L"Usable Constant Boolean Count : 0",uVar1);
  FUN_008018d0(L"Usable Constant Int Count : 0");
  pwVar3 = L"Usable Constant Float Count : 8";
LAB_007fd67b:
  FUN_008018d0(pwVar3);
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
007fd150 : PUSH EBP
007fd151 : MOV EBP,ESP
007fd153 : PUSH -0x1
007fd155 : PUSH 0xb29534
007fd15a : MOV EAX,FS:[0x0]
007fd160 : PUSH EAX
007fd161 : SUB ESP,0x104
007fd167 : PUSH EBX
007fd168 : PUSH ESI
007fd169 : PUSH EDI
007fd16a : MOV EAX,[0x00d66fa0]
007fd16f : XOR EAX,EBP
007fd171 : PUSH EAX
007fd172 : LEA EAX,[EBP + -0xc]
007fd175 : MOV FS:[0x0],EAX
007fd17b : MOV EDI,ECX
007fd17d : MOVZX AX,byte ptr [EDI + 0xf1]
007fd185 : MOV CX,word ptr [EDI + 0xf0]
007fd18c : MOV ESI,dword ptr [0x00da98e8]
007fd192 : MOV EDX,0xff
007fd197 : MOVZX EAX,AX
007fd19a : AND CX,DX
007fd19d : MOVZX ECX,CX
007fd1a0 : MOVZX EBX,AX
007fd1a3 : MOVZX EAX,CX
007fd1a6 : PUSH 0xc27100
007fd1ab : MOV dword ptr [EBP + -0x10],ECX
007fd1ae : MOV dword ptr [EDI + 0x160],EBX
007fd1b4 : MOV dword ptr [EBP + -0x14],EAX
007fd1b7 : MOV dword ptr [EDI + 0x164],EAX
007fd1bd : CALL 0x008018d0
007fd1c2 : MOV ESI,dword ptr [0x00da98e8]
007fd1c8 : PUSH 0xc27164
007fd1cd : CALL 0x008018d0
007fd1d2 : MOV ESI,dword ptr [0x00da98e8]
007fd1d8 : PUSH 0xc27190
007fd1dd : CALL 0x008018d0
007fd1e2 : ADD ESP,0xc
007fd1e5 : SUB EBX,0x1
007fd1e8 : JZ 0x007fd4ee
007fd1ee : SUB EBX,0x1
007fd1f1 : JZ 0x007fd36d
007fd1f7 : SUB EBX,0x1
007fd1fa : JZ 0x007fd274
007fd1fc : PUSH 0xc276a4
007fd201 : LEA ECX,[EBP + -0x30]
007fd204 : CALL 0x00406460
007fd209 : MOV ESI,0x8
007fd20e : MOV dword ptr [EBP + -0x4],ESI
007fd211 : MOV EDI,dword ptr [EDI + 0x17c]
007fd217 : PUSH -0x1
007fd219 : PUSH 0x0
007fd21b : LEA EAX,[EBP + -0x30]
007fd21e : PUSH EAX
007fd21f : LEA ECX,[EDI + 0x28]
007fd222 : CALL 0x00405eb0
007fd227 : MOV dword ptr [EBP + -0x4],0xffffffff
007fd22e : CMP dword ptr [EBP + -0x18],ESI
007fd231 : JC 0x007fd23b
007fd233 : MOV ECX,dword ptr [EBP + -0x2c]
007fd236 : CALL 0x006f04e0
007fd23b : MOV ESI,dword ptr [0x00da98e8]
007fd241 : XOR ECX,ECX
007fd243 : PUSH 0xc27774
007fd248 : MOV dword ptr [EBP + -0x18],0x7
007fd24f : MOV dword ptr [EBP + -0x1c],0x0
007fd256 : MOV word ptr [EBP + -0x2c],CX
007fd25a : CALL 0x008018d0
007fd25f : ADD ESP,0x4
007fd262 : MOV ECX,dword ptr [EBP + -0xc]
007fd265 : MOV dword ptr FS:[0x0],ECX
007fd26c : POP ECX
007fd26d : POP EDI
007fd26e : POP ESI
007fd26f : POP EBX
007fd270 : MOV ESP,EBP
007fd272 : POP EBP
007fd273 : RET
007fd274 : CMP word ptr [EBP + -0x10],0x0
007fd279 : JBE 0x007fd2c4
007fd27b : PUSH 0xc2760c
007fd280 : LEA ECX,[EBP + 0xffffff0c]
007fd286 : CALL 0x00406460
007fd28b : MOV dword ptr [EBP + -0x4],0x6
007fd292 : MOV EAX,dword ptr [EDI + 0x17c]
007fd298 : PUSH -0x1
007fd29a : PUSH 0x0
007fd29c : LEA EDX,[EBP + 0xffffff0c]
007fd2a2 : PUSH EDX
007fd2a3 : LEA ECX,[EAX + 0x28]
007fd2a6 : CALL 0x00405eb0
007fd2ab : MOV dword ptr [EBP + -0x4],0xffffffff
007fd2b2 : LEA ECX,[EBP + 0xffffff0c]
007fd2b8 : CALL 0x00406560
007fd2bd : PUSH 0xc2761c
007fd2c2 : JMP 0x007fd30b
007fd2c4 : PUSH 0xc27658
007fd2c9 : LEA ECX,[EBP + 0xffffff7c]
007fd2cf : CALL 0x00406460
007fd2d4 : MOV dword ptr [EBP + -0x4],0x7
007fd2db : MOV EAX,dword ptr [EDI + 0x17c]
007fd2e1 : PUSH -0x1
007fd2e3 : PUSH 0x0
007fd2e5 : LEA ECX,[EBP + 0xffffff7c]
007fd2eb : PUSH ECX
007fd2ec : LEA ECX,[EAX + 0x28]
007fd2ef : CALL 0x00405eb0
007fd2f4 : MOV dword ptr [EBP + -0x4],0xffffffff
007fd2fb : LEA ECX,[EBP + 0xffffff7c]
007fd301 : CALL 0x00406560
007fd306 : PUSH 0xc27668
007fd30b : MOV ESI,dword ptr [0x00da98e8]
007fd311 : CALL 0x008018d0
007fd316 : MOV EDX,dword ptr [EDI + 0x17c]
007fd31c : MOV ESI,dword ptr [0x00da98e8]
007fd322 : MOV EAX,0x10
007fd327 : MOV word ptr [EDX + 0x4c],AX
007fd32b : MOV ECX,dword ptr [EDI + 0x17c]
007fd331 : MOV EDX,EAX
007fd333 : MOV word ptr [ECX + 0x4e],DX
007fd337 : MOV EAX,dword ptr [EDI + 0x17c]
007fd33d : ADD ESP,0x4
007fd340 : MOV ECX,0xe0
007fd345 : PUSH 0xc276a8
007fd34a : MOV word ptr [EAX + 0x4a],CX
007fd34e : CALL 0x008018d0
007fd353 : MOV ESI,dword ptr [0x00da98e8]
007fd359 : PUSH 0xc276f0
007fd35e : CALL 0x008018d0
007fd363 : PUSH 0xc27730
007fd368 : JMP 0x007fd67b
007fd36d : CMP word ptr [EBP + -0x10],0x0
007fd372 : JBE 0x007fd430
007fd378 : PUSH 0xc27420
007fd37d : LEA ECX,[EBP + -0x4c]
007fd380 : CALL 0x00406460
007fd385 : MOV dword ptr [EBP + -0x4],0x4
007fd38c : MOV EAX,dword ptr [EDI + 0x17c]
007fd392 : PUSH -0x1
007fd394 : PUSH 0x0
007fd396 : LEA EDX,[EBP + -0x4c]
007fd399 : PUSH EDX
007fd39a : LEA ECX,[EAX + 0x28]
007fd39d : CALL 0x00405eb0
007fd3a2 : MOV dword ptr [EBP + -0x4],0xffffffff
007fd3a9 : LEA ECX,[EBP + -0x4c]
007fd3ac : CALL 0x00406560
007fd3b1 : MOV EAX,dword ptr [EDI + 0x17c]
007fd3b7 : MOV ESI,dword ptr [0x00da98e8]
007fd3bd : MOV ECX,0x10
007fd3c2 : MOV word ptr [EAX + 0x4c],CX
007fd3c6 : MOV EDX,dword ptr [EDI + 0x17c]
007fd3cc : MOV EAX,ECX
007fd3ce : MOV word ptr [EDX + 0x4e],AX
007fd3d2 : MOV ECX,dword ptr [EDI + 0x17c]
007fd3d8 : MOV EDX,0xe0
007fd3dd : PUSH 0xc273a4
007fd3e2 : MOV word ptr [ECX + 0x4a],DX
007fd3e6 : CALL 0x008018d0
007fd3eb : MOV ESI,dword ptr [0x00da98e8]
007fd3f1 : PUSH 0xc27430
007fd3f6 : CALL 0x008018d0
007fd3fb : MOV ESI,dword ptr [0x00da98e8]
007fd401 : PUSH 0xc27478
007fd406 : CALL 0x008018d0
007fd40b : MOV ESI,dword ptr [0x00da98e8]
007fd411 : PUSH 0xc274b8
007fd416 : CALL 0x008018d0
007fd41b : ADD ESP,0x10
007fd41e : MOV ECX,dword ptr [EBP + -0xc]
007fd421 : MOV dword ptr FS:[0x0],ECX
007fd428 : POP ECX
007fd429 : POP EDI
007fd42a : POP ESI
007fd42b : POP EBX
007fd42c : MOV ESP,EBP
007fd42e : POP EBP
007fd42f : RET
007fd430 : PUSH 0xc274fc
007fd435 : LEA ECX,[EBP + 0xffffff44]
007fd43b : CALL 0x00406460
007fd440 : MOV dword ptr [EBP + -0x4],0x5
007fd447 : MOV EAX,dword ptr [EDI + 0x17c]
007fd44d : PUSH -0x1
007fd44f : PUSH 0x0
007fd451 : LEA ECX,[EBP + 0xffffff44]
007fd457 : PUSH ECX
007fd458 : LEA ECX,[EAX + 0x28]
007fd45b : CALL 0x00405eb0
007fd460 : MOV dword ptr [EBP + -0x4],0xffffffff
007fd467 : LEA ECX,[EBP + 0xffffff44]
007fd46d : CALL 0x00406560
007fd472 : MOV EDX,dword ptr [EDI + 0x17c]
007fd478 : MOV ESI,dword ptr [0x00da98e8]
007fd47e : XOR EAX,EAX
007fd480 : MOV word ptr [EDX + 0x4c],AX
007fd484 : MOV ECX,dword ptr [EDI + 0x17c]
007fd48a : XOR EDX,EDX
007fd48c : MOV word ptr [ECX + 0x4e],DX
007fd490 : MOV EAX,dword ptr [EDI + 0x17c]
007fd496 : MOV ECX,0x20
007fd49b : PUSH 0xc2750c
007fd4a0 : MOV word ptr [EAX + 0x4a],CX
007fd4a4 : CALL 0x008018d0
007fd4a9 : MOV ESI,dword ptr [0x00da98e8]
007fd4af : PUSH 0xc27548
007fd4b4 : CALL 0x008018d0
007fd4b9 : MOV ESI,dword ptr [0x00da98e8]
007fd4bf : PUSH 0xc2758c
007fd4c4 : CALL 0x008018d0
007fd4c9 : MOV ESI,dword ptr [0x00da98e8]
007fd4cf : PUSH 0xc275c8
007fd4d4 : CALL 0x008018d0
007fd4d9 : ADD ESP,0x10
007fd4dc : MOV ECX,dword ptr [EBP + -0xc]
007fd4df : MOV dword ptr FS:[0x0],ECX
007fd4e6 : POP ECX
007fd4e7 : POP EDI
007fd4e8 : POP ESI
007fd4e9 : POP EBX
007fd4ea : MOV ESP,EBP
007fd4ec : POP EBP
007fd4ed : RET
007fd4ee : MOV EAX,dword ptr [EBP + -0x14]
007fd4f1 : DEC EAX
007fd4f2 : CMP EAX,0x3
007fd4f5 : JA 0x007fd62f
007fd4fb : JMP dword ptr [EAX*0x4 + 0x7fd69c]
007fd502 : PUSH 0xc271f4
007fd507 : LEA ECX,[EBP + -0x68]
007fd50a : CALL 0x00406460
007fd50f : MOV dword ptr [EBP + -0x4],0x0
007fd516 : MOV EAX,dword ptr [EDI + 0x17c]
007fd51c : PUSH -0x1
007fd51e : PUSH 0x0
007fd520 : LEA EDX,[EBP + -0x68]
007fd523 : PUSH EDX
007fd524 : LEA ECX,[EAX + 0x28]
007fd527 : CALL 0x00405eb0
007fd52c : MOV dword ptr [EBP + -0x4],0xffffffff
007fd533 : LEA ECX,[EBP + -0x68]
007fd536 : CALL 0x00406560
007fd53b : PUSH 0xc27204
007fd540 : JMP 0x007fd621
007fd545 : PUSH 0xc27240
007fd54a : LEA ECX,[EBP + 0xffffff60]
007fd550 : CALL 0x00406460
007fd555 : MOV dword ptr [EBP + -0x4],0x1
007fd55c : MOV EAX,dword ptr [EDI + 0x17c]
007fd562 : PUSH -0x1
007fd564 : PUSH 0x0
007fd566 : LEA ECX,[EBP + 0xffffff60]
007fd56c : PUSH ECX
007fd56d : LEA ECX,[EAX + 0x28]
007fd570 : CALL 0x00405eb0
007fd575 : MOV dword ptr [EBP + -0x4],0xffffffff
007fd57c : LEA ECX,[EBP + 0xffffff60]
007fd582 : CALL 0x00406560
007fd587 : PUSH 0xc27250
007fd58c : JMP 0x007fd621
007fd591 : PUSH 0xc2728c
007fd596 : LEA ECX,[EBP + 0xffffff28]
007fd59c : CALL 0x00406460
007fd5a1 : MOV dword ptr [EBP + -0x4],0x2
007fd5a8 : MOV EAX,dword ptr [EDI + 0x17c]
007fd5ae : PUSH -0x1
007fd5b0 : PUSH 0x0
007fd5b2 : LEA EDX,[EBP + 0xffffff28]
007fd5b8 : PUSH EDX
007fd5b9 : LEA ECX,[EAX + 0x28]
007fd5bc : CALL 0x00405eb0
007fd5c1 : MOV dword ptr [EBP + -0x4],0xffffffff
007fd5c8 : LEA ECX,[EBP + 0xffffff28]
007fd5ce : CALL 0x00406560
007fd5d3 : PUSH 0xc2729c
007fd5d8 : JMP 0x007fd621
007fd5da : PUSH 0xc272d8
007fd5df : LEA ECX,[EBP + 0xfffffef0]
007fd5e5 : CALL 0x00406460
007fd5ea : MOV dword ptr [EBP + -0x4],0x3
007fd5f1 : MOV EAX,dword ptr [EDI + 0x17c]
007fd5f7 : PUSH -0x1
007fd5f9 : PUSH 0x0
007fd5fb : LEA ECX,[EBP + 0xfffffef0]
007fd601 : PUSH ECX
007fd602 : LEA ECX,[EAX + 0x28]
007fd605 : CALL 0x00405eb0
007fd60a : MOV dword ptr [EBP + -0x4],0xffffffff
007fd611 : LEA ECX,[EBP + 0xfffffef0]
007fd617 : CALL 0x00406560
007fd61c : PUSH 0xc272e8
007fd621 : MOV ESI,dword ptr [0x00da98e8]
007fd627 : CALL 0x008018d0
007fd62c : ADD ESP,0x4
007fd62f : MOV EDX,dword ptr [EDI + 0x17c]
007fd635 : MOV ESI,dword ptr [0x00da98e8]
007fd63b : XOR EAX,EAX
007fd63d : MOV word ptr [EDX + 0x4c],AX
007fd641 : MOV ECX,dword ptr [EDI + 0x17c]
007fd647 : XOR EDX,EDX
007fd649 : MOV word ptr [ECX + 0x4e],DX
007fd64d : MOV EAX,dword ptr [EDI + 0x17c]
007fd653 : MOV ECX,0x8
007fd658 : PUSH 0xc27360
007fd65d : MOV word ptr [EAX + 0x4a],CX
007fd661 : CALL 0x008018d0
007fd666 : MOV ESI,dword ptr [0x00da98e8]
007fd66c : PUSH 0xc27324
007fd671 : CALL 0x008018d0
007fd676 : PUSH 0xc273e0
007fd67b : MOV ESI,dword ptr [0x00da98e8]
007fd681 : CALL 0x008018d0
007fd686 : ADD ESP,0xc
007fd689 : MOV ECX,dword ptr [EBP + -0xc]
007fd68c : MOV dword ptr FS:[0x0],ECX
007fd693 : POP ECX
007fd694 : POP EDI
007fd695 : POP ESI
007fd696 : POP EBX
007fd697 : MOV ESP,EBP
007fd699 : POP EBP
007fd69a : RET

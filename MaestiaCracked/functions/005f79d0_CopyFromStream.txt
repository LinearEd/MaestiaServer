PROGRAM  : Maestia.exe
FUNCTION : CopyFromStream
ENTRY    : 005f79d0
BODY     : [[005f79d0, 005f7a05] [005f7a10, 005f7a75]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */
/* public: virtual int __thiscall GBufferedFile::CopyFromStream(class GFile *,int) */

int __thiscall GBufferedFile::CopyFromStream(GBufferedFile *this,GFile *param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  GBufferedFile *local_4008;
  undefined1 local_4004 [16384];
  uint local_4;
  
                    /* 0x1f79d0  69  ?CopyFromStream@GBufferedFile@@UAEHPAVGFile@@H@Z */
  local_4 = DAT_00d66fa0 ^ (uint)&local_4008;
  local_4008 = this;
  do {
    if (param_2 == 0) break;
    iVar3 = 0x4000;
    if (param_2 < 0x4001) {
      iVar3 = param_2;
    }
    iVar1 = (**(code **)(*(int *)param_1 + 0x28))(local_4004,iVar3);
    iVar2 = 0;
    if (0 < iVar1) {
      iVar2 = (**(code **)(*(int *)local_4008 + 0x24))(local_4004,iVar1);
    }
    param_2 = param_2 - iVar2;
  } while (iVar3 <= iVar2);
  iVar3 = __security_check_cookie(local_4 ^ (uint)&local_4008);
  return iVar3;
}



============================================================
DISASSEMBLY
============================================================
005f79d0 : MOV EAX,0x4008
005f79d5 : CALL 0x0063b780
005f79da : MOV EAX,[0x00d66fa0]
005f79df : XOR EAX,ESP
005f79e1 : MOV dword ptr [ESP + 0x4004],EAX
005f79e8 : PUSH EBX
005f79e9 : MOV EBX,dword ptr [ESP + 0x4010]
005f79f0 : PUSH EBP
005f79f1 : PUSH EDI
005f79f2 : MOV EDI,dword ptr [ESP + 0x401c]
005f79f9 : XOR EBP,EBP
005f79fb : MOV dword ptr [ESP + 0xc],ECX
005f79ff : TEST EDI,EDI
005f7a01 : JZ 0x005f7a72
005f7a03 : PUSH ESI
005f7a04 : JMP 0x005f7a10
005f7a10 : CMP EDI,0x4000
005f7a16 : MOV ESI,0x4000
005f7a1b : JG 0x005f7a1f
005f7a1d : MOV ESI,EDI
005f7a1f : MOV EAX,dword ptr [EBX]
005f7a21 : MOV EDX,dword ptr [EAX + 0x28]
005f7a24 : PUSH ESI
005f7a25 : LEA ECX,[ESP + 0x18]
005f7a29 : PUSH ECX
005f7a2a : MOV ECX,EBX
005f7a2c : CALL EDX
005f7a2e : MOV ECX,EAX
005f7a30 : XOR EAX,EAX
005f7a32 : TEST ECX,ECX
005f7a34 : JLE 0x005f7a49
005f7a36 : MOV EAX,dword ptr [ESP + 0x10]
005f7a3a : MOV EDX,dword ptr [EAX]
005f7a3c : MOV EDX,dword ptr [EDX + 0x24]
005f7a3f : PUSH ECX
005f7a40 : LEA ECX,[ESP + 0x18]
005f7a44 : PUSH ECX
005f7a45 : MOV ECX,EAX
005f7a47 : CALL EDX
005f7a49 : ADD EBP,EAX
005f7a4b : SUB EDI,EAX
005f7a4d : CMP EAX,ESI
005f7a4f : JL 0x005f7a55
005f7a51 : TEST EDI,EDI
005f7a53 : JNZ 0x005f7a10
005f7a55 : MOV EAX,EBP
005f7a57 : POP ESI
005f7a58 : MOV ECX,dword ptr [ESP + 0x4010]
005f7a5f : POP EDI
005f7a60 : POP EBP
005f7a61 : POP EBX
005f7a62 : XOR ECX,ESP
005f7a64 : CALL 0x00633e6b
005f7a69 : ADD ESP,0x4008
005f7a6f : RET 0x8
005f7a72 : MOV EAX,EBP
005f7a74 : JMP 0x005f7a58

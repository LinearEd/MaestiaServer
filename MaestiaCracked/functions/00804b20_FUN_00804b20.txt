PROGRAM  : Maestia.exe
FUNCTION : FUN_00804b20
ENTRY    : 00804b20
BODY     : [[00804b20, 00804c39] [00804c40, 00804d88]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00804b20(void)

{
  undefined1 uVar1;
  undefined1 uVar2;
  undefined1 uVar3;
  int iVar4;
  undefined4 uVar5;
  int iVar6;
  int iVar7;
  undefined4 *puVar8;
  int *unaff_EDI;
  undefined4 in_XMM0_Da;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined8 local_c;
  undefined4 local_4;
  
  if (unaff_EDI[2] + 0x14U <= (uint)unaff_EDI[1]) {
    iVar7 = unaff_EDI[3];
    uVar5 = FUN_004575f0();
    *(undefined4 *)(iVar7 + 0x28) = uVar5;
    FUN_00457650();
    *(undefined4 *)(iVar7 + 0x30) = in_XMM0_Da;
    FUN_00457650();
    *(undefined4 *)(iVar7 + 0x34) = in_XMM0_Da;
    FUN_00457650();
    *(undefined4 *)(iVar7 + 0x38) = in_XMM0_Da;
    uVar5 = FUN_004575f0();
    *(undefined4 *)(iVar7 + 0x2c) = uVar5;
    if (unaff_EDI[2] + 0x54U <= (uint)unaff_EDI[1]) {
      iVar7 = unaff_EDI[3];
      iVar6 = FUN_004575f0();
      *(bool *)(iVar7 + 0x40) = iVar6 != 0;
      uVar5 = FUN_004575f0();
      *(undefined4 *)(iVar7 + 0x44) = uVar5;
      puVar8 = (undefined4 *)(iVar7 + 0x78);
      iVar6 = 8;
      do {
        FUN_00457650();
        *puVar8 = in_XMM0_Da;
        puVar8 = puVar8 + 1;
        iVar6 = iVar6 + -1;
      } while (iVar6 != 0);
      if (DAT_00da98bf != *(char *)((int)unaff_EDI + 0x5e)) {
        *(float *)(iVar7 + 0x7c) = 1.0 - *(float *)(iVar7 + 0x7c);
        *(float *)(iVar7 + 0x84) = 1.0 - *(float *)(iVar7 + 0x84);
        *(float *)(iVar7 + 0x8c) = 1.0 - *(float *)(iVar7 + 0x8c);
        *(float *)(iVar7 + 0x94) = 1.0 - *(float *)(iVar7 + 0x94);
      }
      *(float *)(iVar7 + 0x98) = *(float *)(iVar7 + 0x80);
      *(float *)(iVar7 + 0x9c) = *(float *)(iVar7 + 0x8c);
      *(float *)(iVar7 + 0xa0) = *(float *)(iVar7 + 0x80) - *(float *)(iVar7 + 0x78);
      *(float *)(iVar7 + 0xa4) = *(float *)(iVar7 + 0x8c) - *(float *)(iVar7 + 0x84);
      puVar8 = (undefined4 *)(iVar7 + 0x4c);
      iVar7 = 4;
      do {
        iVar6 = unaff_EDI[2];
        iVar4 = *unaff_EDI;
        if ((char)unaff_EDI[0x17] == '\0') {
          unaff_EDI[2] = iVar6 + 4;
          local_18 = *(undefined4 *)(iVar4 + iVar6);
        }
        else {
          uVar1 = *(undefined1 *)(iVar4 + iVar6);
          unaff_EDI[2] = iVar6 + 1;
          uVar2 = *(undefined1 *)(iVar6 + 1 + iVar4);
          unaff_EDI[2] = iVar6 + 2;
          uVar3 = *(undefined1 *)(iVar6 + 2 + iVar4);
          unaff_EDI[2] = iVar6 + 3;
          local_18 = CONCAT31(CONCAT21(CONCAT11(uVar1,uVar2),uVar3),
                              *(undefined1 *)(iVar6 + 3 + iVar4));
          unaff_EDI[2] = iVar6 + 4;
        }
        puVar8[-1] = local_18;
        iVar6 = unaff_EDI[2];
        iVar4 = *unaff_EDI;
        if ((char)unaff_EDI[0x17] == '\0') {
          unaff_EDI[2] = iVar6 + 4;
          local_14 = *(undefined4 *)(iVar4 + iVar6);
        }
        else {
          uVar1 = *(undefined1 *)(iVar4 + iVar6);
          unaff_EDI[2] = iVar6 + 1;
          uVar2 = *(undefined1 *)(iVar6 + 1 + iVar4);
          unaff_EDI[2] = iVar6 + 2;
          uVar3 = *(undefined1 *)(iVar6 + 2 + iVar4);
          unaff_EDI[2] = iVar6 + 3;
          local_14 = CONCAT31(CONCAT21(CONCAT11(uVar1,uVar2),uVar3),
                              *(undefined1 *)(iVar6 + 3 + iVar4));
          unaff_EDI[2] = iVar6 + 4;
        }
        *puVar8 = local_14;
        iVar6 = unaff_EDI[2];
        iVar4 = *unaff_EDI;
        if ((char)unaff_EDI[0x17] == '\0') {
          unaff_EDI[2] = iVar6 + 4;
          local_10 = *(undefined4 *)(iVar4 + iVar6);
        }
        else {
          uVar1 = *(undefined1 *)(iVar4 + iVar6);
          unaff_EDI[2] = iVar6 + 1;
          uVar2 = *(undefined1 *)(iVar6 + 1 + iVar4);
          unaff_EDI[2] = iVar6 + 2;
          uVar3 = *(undefined1 *)(iVar6 + 2 + iVar4);
          unaff_EDI[2] = iVar6 + 3;
          local_10 = CONCAT31(CONCAT21(CONCAT11(uVar1,uVar2),uVar3),
                              *(undefined1 *)(iVar6 + 3 + iVar4));
          unaff_EDI[2] = iVar6 + 4;
        }
        puVar8[1] = local_10;
        FUN_00457770(puVar8[-1],*puVar8,puVar8[1]);
        *(undefined8 *)(puVar8 + -1) = local_c;
        puVar8[1] = local_4;
        puVar8 = puVar8 + 3;
        iVar7 = iVar7 + -1;
      } while (iVar7 != 0);
      return 1;
    }
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00804b20 : MOV ECX,dword ptr [EDI + 0x8]
00804b23 : ADD ECX,0x14
00804b26 : SUB ESP,0x18
00804b29 : XOR AL,AL
00804b2b : CMP ECX,dword ptr [EDI + 0x4]
00804b2e : JA 0x00804d85
00804b34 : PUSH ESI
00804b35 : MOV ESI,dword ptr [EDI + 0xc]
00804b38 : MOV EAX,EDI
00804b3a : ADD ESI,0x28
00804b3d : CALL 0x004575f0
00804b42 : MOV dword ptr [ESI],EAX
00804b44 : MOV EAX,EDI
00804b46 : CALL 0x00457650
00804b4b : MOV EAX,EDI
00804b4d : MOVSS dword ptr [ESI + 0x8],XMM0
00804b52 : CALL 0x00457650
00804b57 : MOV EAX,EDI
00804b59 : MOVSS dword ptr [ESI + 0xc],XMM0
00804b5e : CALL 0x00457650
00804b63 : MOV EAX,EDI
00804b65 : MOVSS dword ptr [ESI + 0x10],XMM0
00804b6a : CALL 0x004575f0
00804b6f : MOV dword ptr [ESI + 0x4],EAX
00804b72 : MOV EDX,dword ptr [EDI + 0x8]
00804b75 : ADD EDX,0x54
00804b78 : CMP EDX,dword ptr [EDI + 0x4]
00804b7b : JA 0x00804d82
00804b81 : MOV ESI,dword ptr [EDI + 0xc]
00804b84 : PUSH EBX
00804b85 : PUSH EBP
00804b86 : MOV EAX,EDI
00804b88 : ADD ESI,0x40
00804b8b : CALL 0x004575f0
00804b90 : TEST EAX,EAX
00804b92 : SETNZ AL
00804b95 : MOV byte ptr [ESI],AL
00804b97 : MOV EAX,EDI
00804b99 : CALL 0x004575f0
00804b9e : MOV dword ptr [ESI + 0x4],EAX
00804ba1 : LEA EBP,[ESI + 0x38]
00804ba4 : MOV EBX,0x8
00804ba9 : LEA ESP,[ESP]
00804bb0 : MOV EAX,EDI
00804bb2 : CALL 0x00457650
00804bb7 : MOVSS dword ptr [EBP],XMM0
00804bbc : ADD EBP,0x4
00804bbf : SUB EBX,0x1
00804bc2 : JNZ 0x00804bb0
00804bc4 : MOV CL,byte ptr [0x00da98bf]
00804bca : CMP CL,byte ptr [EDI + 0x5e]
00804bcd : JZ 0x00804c08
00804bcf : MOVSS XMM0,dword ptr [0x00c10fc4]
00804bd7 : MOVAPS XMM1,XMM0
00804bda : SUBSS XMM1,dword ptr [ESI + 0x3c]
00804bdf : MOVSS dword ptr [ESI + 0x3c],XMM1
00804be4 : MOVAPS XMM1,XMM0
00804be7 : SUBSS XMM1,dword ptr [ESI + 0x44]
00804bec : MOVSS dword ptr [ESI + 0x44],XMM1
00804bf1 : MOVAPS XMM1,XMM0
00804bf4 : SUBSS XMM1,dword ptr [ESI + 0x4c]
00804bf9 : SUBSS XMM0,dword ptr [ESI + 0x54]
00804bfe : MOVSS dword ptr [ESI + 0x4c],XMM1
00804c03 : MOVSS dword ptr [ESI + 0x54],XMM0
00804c08 : MOVSS XMM0,dword ptr [ESI + 0x40]
00804c0d : MOVSS XMM1,dword ptr [ESI + 0x4c]
00804c12 : MOVSS dword ptr [ESI + 0x58],XMM0
00804c17 : SUBSS XMM0,dword ptr [ESI + 0x38]
00804c1c : MOVSS dword ptr [ESI + 0x5c],XMM1
00804c21 : SUBSS XMM1,dword ptr [ESI + 0x44]
00804c26 : MOVSS dword ptr [ESI + 0x60],XMM0
00804c2b : MOVSS dword ptr [ESI + 0x64],XMM1
00804c30 : LEA EBP,[ESI + 0xc]
00804c33 : MOV EBX,0x4
00804c38 : JMP 0x00804c40
00804c40 : CMP byte ptr [EDI + 0x5c],0x0
00804c44 : MOV ECX,dword ptr [EDI + 0x8]
00804c47 : MOV EAX,dword ptr [EDI]
00804c49 : JZ 0x00804c82
00804c4b : MOVZX EDX,byte ptr [EAX + ECX*0x1]
00804c4f : INC ECX
00804c50 : MOV dword ptr [EDI + 0x8],ECX
00804c53 : MOV byte ptr [ESP + 0xf],DL
00804c57 : MOVZX EDX,byte ptr [ECX + EAX*0x1]
00804c5b : INC ECX
00804c5c : MOV dword ptr [EDI + 0x8],ECX
00804c5f : MOV byte ptr [ESP + 0xe],DL
00804c63 : MOVZX EDX,byte ptr [ECX + EAX*0x1]
00804c67 : INC ECX
00804c68 : MOV dword ptr [EDI + 0x8],ECX
00804c6b : MOV AL,byte ptr [ECX + EAX*0x1]
00804c6e : MOV byte ptr [ESP + 0xd],DL
00804c72 : MOV byte ptr [ESP + 0xc],AL
00804c76 : MOVSS XMM0,dword ptr [ESP + 0xc]
00804c7c : INC ECX
00804c7d : MOV dword ptr [EDI + 0x8],ECX
00804c80 : JMP 0x00804c8e
00804c82 : ADD EAX,ECX
00804c84 : ADD ECX,0x4
00804c87 : MOV dword ptr [EDI + 0x8],ECX
00804c8a : MOVSS XMM0,dword ptr [EAX]
00804c8e : MOVSS dword ptr [EBP + -0x4],XMM0
00804c93 : CMP byte ptr [EDI + 0x5c],0x0
00804c97 : MOV ECX,dword ptr [EDI + 0x8]
00804c9a : MOV EAX,dword ptr [EDI]
00804c9c : JZ 0x00804cd5
00804c9e : MOVZX EDX,byte ptr [EAX + ECX*0x1]
00804ca2 : INC ECX
00804ca3 : MOV dword ptr [EDI + 0x8],ECX
00804ca6 : MOV byte ptr [ESP + 0x13],DL
00804caa : MOVZX EDX,byte ptr [ECX + EAX*0x1]
00804cae : INC ECX
00804caf : MOV dword ptr [EDI + 0x8],ECX
00804cb2 : MOV byte ptr [ESP + 0x12],DL
00804cb6 : MOVZX EDX,byte ptr [ECX + EAX*0x1]
00804cba : INC ECX
00804cbb : MOV dword ptr [EDI + 0x8],ECX
00804cbe : MOV AL,byte ptr [ECX + EAX*0x1]
00804cc1 : MOV byte ptr [ESP + 0x11],DL
00804cc5 : MOV byte ptr [ESP + 0x10],AL
00804cc9 : MOVSS XMM0,dword ptr [ESP + 0x10]
00804ccf : INC ECX
00804cd0 : MOV dword ptr [EDI + 0x8],ECX
00804cd3 : JMP 0x00804ce1
00804cd5 : ADD EAX,ECX
00804cd7 : ADD ECX,0x4
00804cda : MOV dword ptr [EDI + 0x8],ECX
00804cdd : MOVSS XMM0,dword ptr [EAX]
00804ce1 : MOVSS dword ptr [EBP],XMM0
00804ce6 : CMP byte ptr [EDI + 0x5c],0x0
00804cea : MOV ECX,dword ptr [EDI + 0x8]
00804ced : MOV EAX,dword ptr [EDI]
00804cef : JZ 0x00804d28
00804cf1 : MOVZX EDX,byte ptr [EAX + ECX*0x1]
00804cf5 : INC ECX
00804cf6 : MOV dword ptr [EDI + 0x8],ECX
00804cf9 : MOV byte ptr [ESP + 0x17],DL
00804cfd : MOVZX EDX,byte ptr [ECX + EAX*0x1]
00804d01 : INC ECX
00804d02 : MOV dword ptr [EDI + 0x8],ECX
00804d05 : MOV byte ptr [ESP + 0x16],DL
00804d09 : MOVZX EDX,byte ptr [ECX + EAX*0x1]
00804d0d : INC ECX
00804d0e : MOV dword ptr [EDI + 0x8],ECX
00804d11 : MOV AL,byte ptr [ECX + EAX*0x1]
00804d14 : MOV byte ptr [ESP + 0x15],DL
00804d18 : MOV byte ptr [ESP + 0x14],AL
00804d1c : MOVSS XMM0,dword ptr [ESP + 0x14]
00804d22 : INC ECX
00804d23 : MOV dword ptr [EDI + 0x8],ECX
00804d26 : JMP 0x00804d34
00804d28 : ADD EAX,ECX
00804d2a : ADD ECX,0x4
00804d2d : MOV dword ptr [EDI + 0x8],ECX
00804d30 : MOVSS XMM0,dword ptr [EAX]
00804d34 : MOVSS dword ptr [EBP + 0x4],XMM0
00804d39 : FLD float ptr [EBP + 0x4]
00804d3c : SUB ESP,0xc
00804d3f : FSTP float ptr [ESP + 0x8]
00804d43 : LEA ESI,[ESP + 0x24]
00804d47 : FLD float ptr [EBP]
00804d4a : MOV EAX,EDI
00804d4c : FSTP float ptr [ESP + 0x4]
00804d50 : FLD float ptr [EBP + -0x4]
00804d53 : FSTP float ptr [ESP]
00804d56 : CALL 0x00457770
00804d5b : MOVQ XMM0,qword ptr [ESP + 0x18]
00804d61 : MOV ECX,dword ptr [ESP + 0x20]
00804d65 : MOVQ qword ptr [EBP + -0x4],XMM0
00804d6a : MOV dword ptr [EBP + 0x4],ECX
00804d6d : ADD EBP,0xc
00804d70 : SUB EBX,0x1
00804d73 : JNZ 0x00804c40
00804d79 : POP EBP
00804d7a : POP EBX
00804d7b : MOV AL,0x1
00804d7d : POP ESI
00804d7e : ADD ESP,0x18
00804d81 : RET
00804d82 : XOR AL,AL
00804d84 : POP ESI
00804d85 : ADD ESP,0x18
00804d88 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00542070
ENTRY    : 00542070
BODY     : [[00542070, 005422aa]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00542070(int *param_1,int param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  undefined4 uVar3;
  int iVar4;
  int *piVar5;
  short *psVar6;
  int unaff_EBX;
  uint uVar7;
  int *unaff_EBP;
  int unaff_ESI;
  uint unaff_retaddr;
  undefined4 uVar8;
  undefined4 uVar9;
  int iStack_4;
  
  if (param_3 == -1) {
    param_3 = FUN_0053c470();
  }
  uVar1 = param_3 - param_2;
  FUN_00541dc0();
  (**(code **)(*param_1 + 4))(param_2,uVar1,&DAT_00cca874);
  FUN_0053c2d0(&stack0xffffffec,param_2,&iStack_4);
  if (((unaff_EBP != (int *)0x0) && (-1 < unaff_EBX)) && (iVar4 = unaff_EBP[1], unaff_EBX < iVar4))
  {
    if (iStack_4 == 0) goto LAB_00542170;
    piVar5 = *(int **)(*unaff_EBP + unaff_EBX * 4);
    FUN_00540b60(piVar5[3]);
    uVar2 = piVar5[1];
    if (uVar2 != 0) {
      if ((*piVar5 == 0) || (uVar2 <= uVar2 - 1)) {
        psVar6 = (short *)0x0;
      }
      else {
        psVar6 = (short *)(*piVar5 + (uVar2 - 1) * 2);
      }
      if (*psVar6 == 0) {
        uVar2 = uVar2 - 1;
      }
    }
    uVar7 = uVar2 - iStack_4;
    if (uVar1 <= uVar2 - iStack_4) {
      uVar7 = uVar1;
    }
    uVar8 = 0;
    uVar2 = uVar7;
    uVar3 = FUN_0053f720(piVar5,iStack_4,0,uVar7);
    FUN_005408a0(uVar3,piVar5,iStack_4,uVar8,uVar2);
    iVar4 = unaff_EBP[1];
    unaff_retaddr = uVar1 - uVar7;
    while( true ) {
      if (unaff_EBX < iVar4) {
        unaff_EBX = unaff_EBX + 1;
      }
LAB_00542170:
      if (((unaff_EBX < 0) || (iVar4 <= unaff_EBX)) || (unaff_retaddr == 0)) goto LAB_005421e8;
      piVar5 = *(int **)(*unaff_EBP + unaff_EBX * 4);
      uVar1 = piVar5[1];
      if (uVar1 != 0) {
        if ((*piVar5 == 0) || (uVar1 <= uVar1 - 1)) {
          psVar6 = (short *)0x0;
        }
        else {
          psVar6 = (short *)(*piVar5 + (uVar1 - 1) * 2);
        }
        if (*psVar6 == 0) {
          uVar1 = uVar1 - 1;
        }
      }
      if (unaff_retaddr < uVar1) break;
      FUN_00540ca0(piVar5);
      unaff_retaddr = unaff_retaddr - uVar1;
      iVar4 = unaff_EBP[1];
    }
    iVar4 = *(int *)(*unaff_EBP + unaff_EBX * 4);
    FUN_00540b60(*(undefined4 *)(iVar4 + 0xc));
    uVar9 = 0;
    uVar8 = 0;
    uVar3 = FUN_0053f720(iVar4,0,0,unaff_retaddr);
    FUN_005408a0(uVar3,iVar4,uVar8,uVar9,unaff_retaddr);
  }
LAB_005421e8:
  iVar4 = param_1[4] + -1;
  if ((((-1 < iVar4) && (iVar4 < param_1[4])) &&
      (piVar5 = *(int **)(param_1[3] + iVar4 * 4), piVar5 != (int *)0x0)) &&
     (uVar1 = piVar5[1], uVar1 != 0)) {
    if ((*piVar5 == 0) || (uVar1 <= uVar1 - 1)) {
      psVar6 = (short *)0x0;
    }
    else {
      psVar6 = (short *)(*piVar5 + (uVar1 - 1) * 2);
    }
    if ((*psVar6 == 0xd) || (*psVar6 == 10)) {
      FUN_00540b60(piVar5[3]);
    }
  }
  iVar4 = param_1[4] + -1;
  if (((iVar4 < 0) || (param_1[4] <= iVar4)) ||
     (piVar5 = *(int **)(param_1[3] + iVar4 * 4), piVar5 == (int *)0x0)) {
    piVar5 = (int *)FUN_00540b60(0);
    if (piVar5 == (int *)0x0) goto LAB_00542293;
  }
  uVar1 = piVar5[1];
  if (uVar1 != 0) {
    if ((*piVar5 == 0) || (uVar1 <= uVar1 - 1)) {
      psVar6 = (short *)0x0;
    }
    else {
      psVar6 = (short *)(*piVar5 + (uVar1 - 1) * 2);
    }
    if ((*psVar6 == 0xd) || (*psVar6 == 10)) goto LAB_00542293;
  }
  FUN_005406c0(param_1[2],param_1[7]);
LAB_00542293:
  if ((*(byte *)(unaff_ESI + 0x20) & 1) != 0) {
    *(byte *)(param_1 + 8) = *(byte *)(param_1 + 8) | 1;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00542070 : SUB ESP,0xc
00542073 : MOV EAX,dword ptr [ESP + 0x18]
00542077 : PUSH EBX
00542078 : PUSH EBP
00542079 : PUSH ESI
0054207a : MOV EBX,ECX
0054207c : PUSH EDI
0054207d : MOV dword ptr [ESP + 0x10],EBX
00542081 : CMP EAX,-0x1
00542084 : JNZ 0x0054208b
00542086 : CALL 0x0053c470
0054208b : MOV EDI,dword ptr [ESP + 0x24]
0054208f : MOV EBP,dword ptr [ESP + 0x20]
00542093 : SUB EAX,EDI
00542095 : MOV ESI,EAX
00542097 : MOV ECX,EBP
00542099 : MOV dword ptr [ESP + 0x24],0x0
005420a1 : MOV dword ptr [ESP + 0x28],ESI
005420a5 : CALL 0x00541dc0
005420aa : MOV EAX,dword ptr [EBP]
005420ad : MOV EDX,dword ptr [EAX + 0x4]
005420b0 : PUSH 0xcca874
005420b5 : PUSH ESI
005420b6 : PUSH EDI
005420b7 : MOV ECX,EBP
005420b9 : CALL EDX
005420bb : LEA EAX,[ESP + 0x24]
005420bf : PUSH EAX
005420c0 : PUSH EDI
005420c1 : LEA ECX,[ESP + 0x1c]
005420c5 : PUSH ECX
005420c6 : MOV ECX,EBX
005420c8 : CALL 0x0053c2d0
005420cd : MOV EBX,dword ptr [ESP + 0x14]
005420d1 : TEST EBX,EBX
005420d3 : JZ 0x005421e8
005420d9 : MOV EDI,dword ptr [ESP + 0x18]
005420dd : TEST EDI,EDI
005420df : JL 0x005421e8
005420e5 : MOV EAX,dword ptr [EBX + 0x4]
005420e8 : CMP EDI,EAX
005420ea : JGE 0x005421e8
005420f0 : CMP dword ptr [ESP + 0x24],0x0
005420f5 : JZ 0x00542170
005420f7 : MOV EDX,dword ptr [EBX]
005420f9 : MOV EBX,dword ptr [EDX + EDI*0x4]
005420fc : MOV EAX,dword ptr [EBX + 0xc]
005420ff : PUSH EAX
00542100 : MOV ECX,EBP
00542102 : MOV dword ptr [ESP + 0x2c],EBX
00542106 : CALL 0x00540b60
0054210b : MOV dword ptr [ESP + 0x20],EAX
0054210f : MOV EAX,dword ptr [EBX + 0x4]
00542112 : TEST EAX,EAX
00542114 : JBE 0x00542131
00542116 : MOV EBX,dword ptr [EBX]
00542118 : LEA ECX,[EAX + -0x1]
0054211b : TEST EBX,EBX
0054211d : JZ 0x00542128
0054211f : CMP ECX,EAX
00542121 : JNC 0x00542128
00542123 : LEA ECX,[EBX + ECX*0x2]
00542126 : JMP 0x0054212a
00542128 : XOR ECX,ECX
0054212a : CMP word ptr [ECX],0x0
0054212e : JNZ 0x00542131
00542130 : DEC EAX
00542131 : SUB EAX,dword ptr [ESP + 0x24]
00542135 : MOV EBX,EAX
00542137 : CMP EBX,ESI
00542139 : JC 0x0054213d
0054213b : MOV EBX,ESI
0054213d : MOV EAX,dword ptr [ESP + 0x24]
00542141 : MOV ECX,dword ptr [ESP + 0x28]
00542145 : PUSH EBX
00542146 : PUSH 0x0
00542148 : PUSH EAX
00542149 : PUSH ECX
0054214a : MOV ECX,EBP
0054214c : CALL 0x0053f720
00542151 : MOV ECX,dword ptr [ESP + 0x30]
00542155 : PUSH EAX
00542156 : CALL 0x005408a0
0054215b : MOV EDX,dword ptr [ESP + 0x14]
0054215f : MOV EAX,dword ptr [EDX + 0x4]
00542162 : SUB ESI,EBX
00542164 : MOV dword ptr [ESP + 0x28],ESI
00542168 : MOV EBX,EDX
0054216a : CMP EDI,EAX
0054216c : JGE 0x00542170
0054216e : INC EDI
0054216f : NOP
00542170 : TEST EDI,EDI
00542172 : JL 0x005421e8
00542174 : CMP EDI,EAX
00542176 : JGE 0x005421e8
00542178 : CMP dword ptr [ESP + 0x28],0x0
0054217d : JBE 0x005421e8
0054217f : MOV EAX,dword ptr [EBX]
00542181 : MOV EAX,dword ptr [EAX + EDI*0x4]
00542184 : MOV ESI,dword ptr [EAX + 0x4]
00542187 : TEST ESI,ESI
00542189 : JBE 0x005421a6
0054218b : MOV ECX,dword ptr [EAX]
0054218d : LEA EDX,[ESI + -0x1]
00542190 : TEST ECX,ECX
00542192 : JZ 0x0054219d
00542194 : CMP EDX,ESI
00542196 : JNC 0x0054219d
00542198 : LEA ECX,[ECX + EDX*0x2]
0054219b : JMP 0x0054219f
0054219d : XOR ECX,ECX
0054219f : CMP word ptr [ECX],0x0
005421a3 : JNZ 0x005421a6
005421a5 : DEC ESI
005421a6 : CMP ESI,dword ptr [ESP + 0x28]
005421aa : JA 0x005421bd
005421ac : PUSH EAX
005421ad : MOV ECX,EBP
005421af : CALL 0x00540ca0
005421b4 : SUB dword ptr [ESP + 0x28],ESI
005421b8 : MOV EAX,dword ptr [EBX + 0x4]
005421bb : JMP 0x0054216a
005421bd : MOV ECX,dword ptr [EBX]
005421bf : MOV EDI,dword ptr [ECX + EDI*0x4]
005421c2 : MOV EAX,dword ptr [EDI + 0xc]
005421c5 : PUSH EAX
005421c6 : MOV ECX,EBP
005421c8 : CALL 0x00540b60
005421cd : MOV EDX,dword ptr [ESP + 0x28]
005421d1 : PUSH EDX
005421d2 : PUSH 0x0
005421d4 : PUSH 0x0
005421d6 : PUSH EDI
005421d7 : MOV ECX,EBP
005421d9 : MOV ESI,EAX
005421db : CALL 0x0053f720
005421e0 : PUSH EAX
005421e1 : MOV ECX,ESI
005421e3 : CALL 0x005408a0
005421e8 : MOV ECX,dword ptr [EBP + 0x10]
005421eb : LEA EAX,[ECX + -0x1]
005421ee : TEST EAX,EAX
005421f0 : JL 0x00542235
005421f2 : CMP EAX,ECX
005421f4 : JGE 0x00542235
005421f6 : MOV ECX,dword ptr [EBP + 0xc]
005421f9 : MOV EAX,dword ptr [ECX + EAX*0x4]
005421fc : TEST EAX,EAX
005421fe : JZ 0x00542235
00542200 : MOV ECX,dword ptr [EAX + 0x4]
00542203 : TEST ECX,ECX
00542205 : JBE 0x00542235
00542207 : MOV EDX,dword ptr [EAX]
00542209 : LEA ESI,[ECX + -0x1]
0054220c : TEST EDX,EDX
0054220e : JZ 0x00542219
00542210 : CMP ESI,ECX
00542212 : JNC 0x00542219
00542214 : LEA ECX,[EDX + ESI*0x2]
00542217 : JMP 0x0054221b
00542219 : XOR ECX,ECX
0054221b : MOVZX ECX,word ptr [ECX]
0054221e : CMP CX,0xd
00542222 : JZ 0x0054222a
00542224 : CMP CX,0xa
00542228 : JNZ 0x00542235
0054222a : MOV EDX,dword ptr [EAX + 0xc]
0054222d : PUSH EDX
0054222e : MOV ECX,EBP
00542230 : CALL 0x00540b60
00542235 : MOV ECX,dword ptr [EBP + 0x10]
00542238 : LEA EAX,[ECX + -0x1]
0054223b : TEST EAX,EAX
0054223d : JL 0x0054224d
0054223f : CMP EAX,ECX
00542241 : JGE 0x0054224d
00542243 : MOV ECX,dword ptr [EBP + 0xc]
00542246 : MOV EAX,dword ptr [ECX + EAX*0x4]
00542249 : TEST EAX,EAX
0054224b : JNZ 0x0054225a
0054224d : PUSH 0x0
0054224f : MOV ECX,EBP
00542251 : CALL 0x00540b60
00542256 : TEST EAX,EAX
00542258 : JZ 0x00542293
0054225a : MOV ECX,dword ptr [EAX + 0x4]
0054225d : TEST ECX,ECX
0054225f : JBE 0x00542284
00542261 : MOV EDX,dword ptr [EAX]
00542263 : LEA ESI,[ECX + -0x1]
00542266 : TEST EDX,EDX
00542268 : JZ 0x00542273
0054226a : CMP ESI,ECX
0054226c : JNC 0x00542273
0054226e : LEA ECX,[EDX + ESI*0x2]
00542271 : JMP 0x00542275
00542273 : XOR ECX,ECX
00542275 : MOVZX ECX,word ptr [ECX]
00542278 : CMP CX,0xd
0054227c : JZ 0x00542293
0054227e : CMP CX,0xa
00542282 : JZ 0x00542293
00542284 : MOV EDX,dword ptr [EBP + 0x1c]
00542287 : MOV ECX,dword ptr [EBP + 0x8]
0054228a : PUSH EDX
0054228b : PUSH ECX
0054228c : MOV ECX,EAX
0054228e : CALL 0x005406c0
00542293 : MOV EDX,dword ptr [ESP + 0x10]
00542297 : TEST byte ptr [EDX + 0x20],0x1
0054229b : JZ 0x005422a1
0054229d : OR byte ptr [EBP + 0x20],0x1
005422a1 : POP EDI
005422a2 : POP ESI
005422a3 : POP EBP
005422a4 : POP EBX
005422a5 : ADD ESP,0xc
005422a8 : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_00609b70
ENTRY    : 00609b70
BODY     : [[00609b70, 00609cb5]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00609b70(undefined4 param_1,uint *param_2,uint param_3)

{
  uint *puVar1;
  uint *puVar2;
  int *piVar3;
  int iVar4;
  uint uVar5;
  int *in_ECX;
  uint uVar6;
  int iVar7;
  
  piVar3 = (int *)*in_ECX;
  if (piVar3 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar3 * 5) <= piVar3[1] * 4 + 4U) goto LAB_00609baa;
    iVar7 = piVar3[1] * 2 + 2;
  }
  FUN_0060a090(param_1,iVar7);
LAB_00609baa:
  piVar3 = (int *)*in_ECX;
  param_3 = param_3 & piVar3[1];
  *piVar3 = *piVar3 + 1;
  iVar7 = *in_ECX;
  iVar4 = *(int *)(iVar7 + 8 + param_3 * 0x14);
  puVar1 = (uint *)(iVar7 + 8 + param_3 * 0x14);
  if (iVar4 == -2) {
    *puVar1 = 0xffffffff;
    puVar1[2] = *param_2;
    puVar1[3] = param_2[1];
    puVar1[4] = param_2[2];
    puVar1[1] = param_3;
    return;
  }
  uVar6 = param_3;
  do {
    uVar6 = uVar6 + 1 & *(uint *)(iVar7 + 4);
  } while (*(int *)(iVar7 + 8 + uVar6 * 0x14) != -2);
  uVar5 = puVar1[1];
  piVar3 = (int *)(iVar7 + 8 + uVar6 * 0x14);
  if (uVar5 == param_3) {
    if (piVar3 != (int *)0x0) {
      *piVar3 = iVar4;
      piVar3[1] = puVar1[1];
      piVar3[2] = puVar1[2];
      piVar3[3] = puVar1[3];
      piVar3[4] = puVar1[4];
    }
    puVar1[2] = *param_2;
    puVar1[3] = param_2[1];
    puVar1[4] = param_2[2];
    *puVar1 = uVar6;
    puVar1[1] = param_3;
    return;
  }
  puVar2 = (uint *)(iVar7 + 8 + uVar5 * 0x14);
  for (uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x14); uVar5 != param_3;
      uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x14)) {
    uVar5 = *puVar2;
    puVar2 = (uint *)(iVar7 + 8 + uVar5 * 0x14);
  }
  if (piVar3 != (int *)0x0) {
    *piVar3 = iVar4;
    piVar3[1] = puVar1[1];
    piVar3[2] = puVar1[2];
    piVar3[3] = puVar1[3];
    piVar3[4] = puVar1[4];
  }
  *puVar2 = uVar6;
  puVar1[2] = *param_2;
  puVar1[3] = param_2[1];
  puVar1[4] = param_2[2];
  *puVar1 = 0xffffffff;
  puVar1[1] = param_3;
  return;
}



============================================================
DISASSEMBLY
============================================================
00609b70 : PUSH EBP
00609b71 : PUSH ESI
00609b72 : MOV ESI,ECX
00609b74 : MOV EAX,dword ptr [ESI]
00609b76 : TEST EAX,EAX
00609b78 : JNZ 0x00609b83
00609b7a : MOV EAX,dword ptr [ESP + 0xc]
00609b7e : PUSH 0x8
00609b80 : PUSH EAX
00609b81 : JMP 0x00609ba5
00609b83 : MOV ECX,dword ptr [EAX + 0x4]
00609b86 : LEA EDX,[ECX*0x4 + 0x4]
00609b8d : MOV ECX,dword ptr [EAX]
00609b8f : LEA ECX,[ECX + ECX*0x4]
00609b92 : CMP ECX,EDX
00609b94 : JBE 0x00609baa
00609b96 : MOV EDX,dword ptr [EAX + 0x4]
00609b99 : MOV ECX,dword ptr [ESP + 0xc]
00609b9d : LEA EAX,[EDX + EDX*0x1 + 0x2]
00609ba1 : PUSH EAX
00609ba2 : PUSH ECX
00609ba3 : MOV ECX,ESI
00609ba5 : CALL 0x0060a090
00609baa : MOV EAX,dword ptr [ESI]
00609bac : MOV ECX,dword ptr [ESP + 0x14]
00609bb0 : AND ECX,dword ptr [EAX + 0x4]
00609bb3 : INC dword ptr [EAX]
00609bb5 : MOV ESI,dword ptr [ESI]
00609bb7 : LEA EDX,[ECX + ECX*0x4]
00609bba : MOV EBP,dword ptr [ESI + EDX*0x4 + 0x8]
00609bbe : LEA EAX,[ESI + EDX*0x4 + 0x8]
00609bc2 : CMP EBP,-0x2
00609bc5 : JNZ 0x00609bea
00609bc7 : MOV EDX,dword ptr [ESP + 0x10]
00609bcb : MOV dword ptr [EAX],0xffffffff
00609bd1 : MOV ESI,dword ptr [EDX]
00609bd3 : MOV dword ptr [EAX + 0x8],ESI
00609bd6 : MOV ESI,dword ptr [EDX + 0x4]
00609bd9 : MOV dword ptr [EAX + 0xc],ESI
00609bdc : MOV EDX,dword ptr [EDX + 0x8]
00609bdf : POP ESI
00609be0 : MOV dword ptr [EAX + 0x10],EDX
00609be3 : MOV dword ptr [EAX + 0x4],ECX
00609be6 : POP EBP
00609be7 : RET 0xc
00609bea : PUSH EDI
00609beb : MOV EDI,dword ptr [ESI + 0x4]
00609bee : MOV EDX,ECX
00609bf0 : PUSH EBX
00609bf1 : INC EDX
00609bf2 : AND EDX,EDI
00609bf4 : LEA EBX,[EDX + EDX*0x4]
00609bf7 : CMP dword ptr [ESI + EBX*0x4 + 0x8],-0x2
00609bfc : JNZ 0x00609bf1
00609bfe : MOV EBX,dword ptr [EAX + 0x4]
00609c01 : LEA EDI,[EDX + EDX*0x4]
00609c04 : LEA EDI,[ESI + EDI*0x4 + 0x8]
00609c08 : CMP EBX,ECX
00609c0a : JNZ 0x00609c4d
00609c0c : TEST EDI,EDI
00609c0e : JZ 0x00609c2c
00609c10 : MOV dword ptr [EDI],EBP
00609c12 : MOV ESI,dword ptr [EAX + 0x4]
00609c15 : MOV dword ptr [EDI + 0x4],ESI
00609c18 : LEA ESI,[EDI + 0x8]
00609c1b : MOV EDI,dword ptr [EAX + 0x8]
00609c1e : MOV dword ptr [ESI],EDI
00609c20 : MOV EDI,dword ptr [EAX + 0xc]
00609c23 : MOV dword ptr [ESI + 0x4],EDI
00609c26 : MOV EDI,dword ptr [EAX + 0x10]
00609c29 : MOV dword ptr [ESI + 0x8],EDI
00609c2c : MOV ESI,dword ptr [ESP + 0x18]
00609c30 : MOV EDI,dword ptr [ESI]
00609c32 : MOV dword ptr [EAX + 0x8],EDI
00609c35 : MOV EDI,dword ptr [ESI + 0x4]
00609c38 : MOV dword ptr [EAX + 0xc],EDI
00609c3b : MOV ESI,dword ptr [ESI + 0x8]
00609c3e : POP EBX
00609c3f : POP EDI
00609c40 : MOV dword ptr [EAX + 0x10],ESI
00609c43 : POP ESI
00609c44 : MOV dword ptr [EAX],EDX
00609c46 : MOV dword ptr [EAX + 0x4],ECX
00609c49 : POP EBP
00609c4a : RET 0xc
00609c4d : LEA EBX,[EBX + EBX*0x4]
00609c50 : CMP dword ptr [ESI + EBX*0x4 + 0x8],ECX
00609c54 : LEA EBX,[ESI + EBX*0x4 + 0x8]
00609c58 : JZ 0x00609c6f
00609c5a : LEA EBX,[EBX]
00609c60 : MOV EBX,dword ptr [EBX]
00609c62 : LEA EBX,[EBX + EBX*0x4]
00609c65 : CMP dword ptr [ESI + EBX*0x4 + 0x8],ECX
00609c69 : LEA EBX,[ESI + EBX*0x4 + 0x8]
00609c6d : JNZ 0x00609c60
00609c6f : TEST EDI,EDI
00609c71 : JZ 0x00609c8f
00609c73 : MOV dword ptr [EDI],EBP
00609c75 : MOV ESI,dword ptr [EAX + 0x4]
00609c78 : MOV dword ptr [EDI + 0x4],ESI
00609c7b : LEA ESI,[EDI + 0x8]
00609c7e : MOV EDI,dword ptr [EAX + 0x8]
00609c81 : MOV dword ptr [ESI],EDI
00609c83 : MOV EDI,dword ptr [EAX + 0xc]
00609c86 : MOV dword ptr [ESI + 0x4],EDI
00609c89 : MOV EDI,dword ptr [EAX + 0x10]
00609c8c : MOV dword ptr [ESI + 0x8],EDI
00609c8f : MOV dword ptr [EBX],EDX
00609c91 : MOV EDX,dword ptr [ESP + 0x18]
00609c95 : MOV ESI,dword ptr [EDX]
00609c97 : MOV dword ptr [EAX + 0x8],ESI
00609c9a : MOV ESI,dword ptr [EDX + 0x4]
00609c9d : POP EBX
00609c9e : MOV dword ptr [EAX + 0xc],ESI
00609ca1 : MOV EDX,dword ptr [EDX + 0x8]
00609ca4 : POP EDI
00609ca5 : POP ESI
00609ca6 : MOV dword ptr [EAX + 0x10],EDX
00609ca9 : MOV dword ptr [EAX],0xffffffff
00609caf : MOV dword ptr [EAX + 0x4],ECX
00609cb2 : POP EBP
00609cb3 : RET 0xc

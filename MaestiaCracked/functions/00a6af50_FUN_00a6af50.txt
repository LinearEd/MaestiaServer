PROGRAM  : Maestia.exe
FUNCTION : FUN_00a6af50
ENTRY    : 00a6af50
BODY     : [[00a6af50, 00a6b0f8]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a6af50(void)

{
  int iVar1;
  ulonglong uVar2;
  uint uVar3;
  uint8_t *puVar4;
  int in_ECX;
  byte bVar5;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4c587;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(char *)(in_ECX + 0x1abd) != '\0') {
    FUN_008018d0(L"Send to Server SPKUZ_SKILL_RQ_RESERVE_CAST_CANCEL",uVar3);
    iVar1 = *(int *)ThreadLocalStoragePointer;
    bVar5 = (byte)((ulonglong)(*(byte *)(iVar1 + 0x18) + 1) % 3);
    *(byte *)(iVar1 + 0x18) = bVar5;
    puVar4 = (uint8_t *)((uint)bVar5 * 0x2000 + 0x122cb8 + iVar1);
    if (puVar4 == (uint8_t *)0x0) {
      puVar4 = (uint8_t *)0x0;
    }
    else {
      puVar4[0] = '\0';
      puVar4[1] = '\0';
      puVar4[2] = ':';
      puVar4[3] = '\f';
    }
    local_8 = 0xffffffff;
    if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
      FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),4,puVar4);
    }
    *(undefined1 *)(in_ECX + 0x1abd) = 0;
  }
  if (*(char *)(in_ECX + 0x1abe) != '\0') {
    FUN_008018d0(L"Send to Server SPKUZ_CHARACTER_RQ_RESERVE_AUTO_ATTACK_CANCEL",uVar3);
    iVar1 = *(int *)ThreadLocalStoragePointer;
    uVar2 = (ulonglong)(*(byte *)(iVar1 + 0x18) + 1) % 3;
    puVar4 = (uint8_t *)((int)uVar2 * 0x2000 + 0x122cb8 + iVar1);
    *(char *)(iVar1 + 0x18) = (char)uVar2;
    if (puVar4 == (uint8_t *)0x0) {
      puVar4 = (uint8_t *)0x0;
    }
    else {
      puVar4[0] = '\0';
      puVar4[1] = '\0';
      puVar4[2] = '4';
      puVar4[3] = '&';
    }
    local_8 = 0xffffffff;
    if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
      FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),4,puVar4);
    }
    *(undefined1 *)(in_ECX + 0x1abe) = 0;
  }
  iVar1 = *(int *)(in_ECX + 1000);
  *(undefined4 *)(in_ECX + 0x1580) = *(undefined4 *)(iVar1 + 0x68);
  *(undefined4 *)(in_ECX + 0x1584) = *(undefined4 *)(iVar1 + 0x6c);
  *(undefined4 *)(in_ECX + 0x1588) = *(undefined4 *)(iVar1 + 0x70);
  FUN_00886930();
  if (*(char *)(in_ECX + 0x427) != '\0') {
    (**(code **)(**(int **)(*DAT_00da9894 + 0x144) + 0x18))(0,300);
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00a6af50 : PUSH EBP
00a6af51 : MOV EBP,ESP
00a6af53 : PUSH -0x1
00a6af55 : PUSH 0xb4c587
00a6af5a : MOV EAX,FS:[0x0]
00a6af60 : PUSH EAX
00a6af61 : PUSH ECX
00a6af62 : PUSH EBX
00a6af63 : PUSH ESI
00a6af64 : PUSH EDI
00a6af65 : MOV EAX,[0x00d66fa0]
00a6af6a : XOR EAX,EBP
00a6af6c : PUSH EAX
00a6af6d : LEA EAX,[EBP + -0xc]
00a6af70 : MOV FS:[0x0],EAX
00a6af76 : MOV EBX,ECX
00a6af78 : CMP byte ptr [EBX + 0x1abd],0x0
00a6af7f : JZ 0x00a6b007
00a6af85 : MOV ESI,dword ptr [0x00da98e8]
00a6af8b : PUSH 0xc41fd0
00a6af90 : CALL 0x008018d0
00a6af95 : MOV EAX,FS:[0x2c]
00a6af9b : MOV ECX,dword ptr [EAX]
00a6af9d : MOVZX EAX,byte ptr [ECX + 0x18]
00a6afa1 : INC EAX
00a6afa2 : CDQ
00a6afa3 : MOV ESI,0x3
00a6afa8 : IDIV ESI
00a6afaa : ADD ESP,0x4
00a6afad : MOV byte ptr [ECX + 0x18],DL
00a6afb0 : MOVZX EDX,DL
00a6afb3 : SHL EDX,0xd
00a6afb6 : LEA EAX,[EDX + ECX*0x1 + 0x122cb8]
00a6afbd : MOV dword ptr [EBP + -0x10],EAX
00a6afc0 : MOV dword ptr [EBP + -0x4],0x0
00a6afc7 : TEST EAX,EAX
00a6afc9 : JZ 0x00a6afda
00a6afcb : XOR ECX,ECX
00a6afcd : MOV word ptr [EAX],CX
00a6afd0 : MOV byte ptr [EAX + 0x2],0x3a
00a6afd4 : MOV byte ptr [EAX + 0x3],0xc
00a6afd8 : JMP 0x00a6afdc
00a6afda : XOR EAX,EAX
00a6afdc : MOV dword ptr [EBP + -0x4],0xffffffff
00a6afe3 : MOV EDX,dword ptr [0x017247d4]
00a6afe9 : MOV ECX,dword ptr [EDX + 0x4]
00a6afec : TEST ECX,ECX
00a6afee : JZ 0x00a6b000
00a6aff0 : CMP byte ptr [EDX + 0x8],0x0
00a6aff4 : JZ 0x00a6b000
00a6aff6 : PUSH 0x4
00a6aff8 : PUSH ECX
00a6aff9 : MOV EDI,EAX
00a6affb : CALL 0x00a0dd40
00a6b000 : MOV byte ptr [EBX + 0x1abd],0x0
00a6b007 : CMP byte ptr [EBX + 0x1abe],0x0
00a6b00e : JZ 0x00a6b097
00a6b014 : MOV ESI,dword ptr [0x00da98e8]
00a6b01a : PUSH 0xc42038
00a6b01f : CALL 0x008018d0
00a6b024 : MOV EDX,dword ptr FS:[0x2c]
00a6b02b : MOV ECX,dword ptr [EDX]
00a6b02d : MOVZX EAX,byte ptr [ECX + 0x18]
00a6b031 : INC EAX
00a6b032 : CDQ
00a6b033 : MOV ESI,0x3
00a6b038 : IDIV ESI
00a6b03a : ADD ESP,0x4
00a6b03d : MOVZX EAX,DL
00a6b040 : SHL EAX,0xd
00a6b043 : LEA EAX,[EAX + ECX*0x1 + 0x122cb8]
00a6b04a : MOV byte ptr [ECX + 0x18],DL
00a6b04d : MOV dword ptr [EBP + -0x10],EAX
00a6b050 : MOV dword ptr [EBP + -0x4],0x1
00a6b057 : TEST EAX,EAX
00a6b059 : JZ 0x00a6b06a
00a6b05b : XOR ECX,ECX
00a6b05d : MOV word ptr [EAX],CX
00a6b060 : MOV byte ptr [EAX + 0x2],0x34
00a6b064 : MOV byte ptr [EAX + 0x3],0x26
00a6b068 : JMP 0x00a6b06c
00a6b06a : XOR EAX,EAX
00a6b06c : MOV dword ptr [EBP + -0x4],0xffffffff
00a6b073 : MOV EDX,dword ptr [0x017247d4]
00a6b079 : MOV ECX,dword ptr [EDX + 0x4]
00a6b07c : TEST ECX,ECX
00a6b07e : JZ 0x00a6b090
00a6b080 : CMP byte ptr [EDX + 0x8],0x0
00a6b084 : JZ 0x00a6b090
00a6b086 : PUSH 0x4
00a6b088 : PUSH ECX
00a6b089 : MOV EDI,EAX
00a6b08b : CALL 0x00a0dd40
00a6b090 : MOV byte ptr [EBX + 0x1abe],0x0
00a6b097 : MOV EAX,dword ptr [EBX + 0x3e8]
00a6b09d : FLD float ptr [EAX + 0x68]
00a6b0a0 : ADD EAX,0x68
00a6b0a3 : FSTP float ptr [EBX + 0x1580]
00a6b0a9 : MOV ECX,EBX
00a6b0ab : FLD float ptr [EAX + 0x4]
00a6b0ae : FSTP float ptr [EBX + 0x1584]
00a6b0b4 : FLD float ptr [EAX + 0x8]
00a6b0b7 : FSTP float ptr [EBX + 0x1588]
00a6b0bd : CALL 0x00886930
00a6b0c2 : CMP byte ptr [EBX + 0x427],0x0
00a6b0c9 : JZ 0x00a6b0e7
00a6b0cb : MOV EDX,dword ptr [0x00da9894]
00a6b0d1 : MOV EAX,dword ptr [EDX]
00a6b0d3 : MOV ECX,dword ptr [EAX + 0x144]
00a6b0d9 : MOV EDX,dword ptr [ECX]
00a6b0db : MOV EAX,dword ptr [EDX + 0x18]
00a6b0de : PUSH 0x12c
00a6b0e3 : PUSH 0x0
00a6b0e5 : CALL EAX
00a6b0e7 : MOV ECX,dword ptr [EBP + -0xc]
00a6b0ea : MOV dword ptr FS:[0x0],ECX
00a6b0f1 : POP ECX
00a6b0f2 : POP EDI
00a6b0f3 : POP ESI
00a6b0f4 : POP EBX
00a6b0f5 : MOV ESP,EBP
00a6b0f7 : POP EBP
00a6b0f8 : RET

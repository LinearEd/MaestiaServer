PROGRAM  : Maestia.exe
FUNCTION : FUN_005f29a0
ENTRY    : 005f29a0
BODY     : [[005f29a0, 005f2a88]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005f29a0(uint *param_1)

{
  uint *puVar1;
  int iVar2;
  uint uVar3;
  char cVar4;
  int *in_ECX;
  uint uVar5;
  uint uVar6;
  uint *puVar7;
  uint local_8;
  
  iVar2 = *in_ECX;
  if (iVar2 != 0) {
    uVar5 = ((uint)(byte)(*(byte *)((int)param_1 + 0xb) ^ *(byte *)((int)param_1 + 10) ^
                          (byte)param_1[2] ^ *(byte *)((int)param_1 + 7) ^
                         *(byte *)((int)param_1 + 6)) ^ (uint)(ushort)param_1[1] ^ *param_1 >> 6 ^
             (uint)*(byte *)((int)param_1 + 9) * 2 ^ *param_1) & *(uint *)(iVar2 + 4);
    puVar7 = (uint *)(iVar2 + 8 + uVar5 * 0x18);
    if ((*(int *)(iVar2 + 8 + uVar5 * 0x18) != -2) && (puVar7[1] == uVar5)) {
      local_8 = 0xffffffff;
      uVar3 = uVar5;
      while ((uVar6 = uVar3, puVar7[1] != uVar5 || (cVar4 = FUN_00599050(param_1), cVar4 == '\0')))
      {
        uVar3 = *puVar7;
        if (uVar3 == 0xffffffff) {
          return;
        }
        puVar7 = (uint *)(iVar2 + 8 + uVar3 * 0x18);
        local_8 = uVar6;
      }
      if (uVar5 == uVar6) {
        if (*puVar7 != 0xffffffff) {
          puVar1 = (uint *)(iVar2 + 8 + *puVar7 * 0x18);
          *puVar7 = 0xfffffffe;
          FUN_005f1c00(puVar1);
          puVar7 = puVar1;
        }
      }
      else {
        *(uint *)(iVar2 + 8 + local_8 * 0x18) = *puVar7;
      }
      *puVar7 = 0xfffffffe;
      *(int *)*in_ECX = *(int *)*in_ECX + -1;
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005f29a0 : SUB ESP,0x8
005f29a3 : PUSH EBP
005f29a4 : MOV EBP,dword ptr [ECX]
005f29a6 : MOV dword ptr [ESP + 0x8],ECX
005f29aa : TEST EBP,EBP
005f29ac : JZ 0x005f2a82
005f29b2 : PUSH EBX
005f29b3 : MOV EBX,dword ptr [ESP + 0x14]
005f29b7 : MOVZX ECX,byte ptr [EBX + 0xa]
005f29bb : MOVZX EDX,byte ptr [EBX + 0x8]
005f29bf : MOV EAX,dword ptr [EBX]
005f29c1 : PUSH ESI
005f29c2 : MOVZX ESI,byte ptr [EBX + 0xb]
005f29c6 : XOR ESI,ECX
005f29c8 : MOVZX ECX,byte ptr [EBX + 0x7]
005f29cc : XOR ESI,EDX
005f29ce : MOVZX EDX,byte ptr [EBX + 0x6]
005f29d2 : XOR ESI,ECX
005f29d4 : MOVZX ECX,word ptr [EBX + 0x4]
005f29d8 : XOR ESI,EDX
005f29da : XOR ESI,ECX
005f29dc : MOVZX ECX,byte ptr [EBX + 0x9]
005f29e0 : MOV EDX,EAX
005f29e2 : SHR EDX,0x6
005f29e5 : XOR ESI,EDX
005f29e7 : ADD ECX,ECX
005f29e9 : XOR ESI,ECX
005f29eb : XOR ESI,EAX
005f29ed : AND ESI,dword ptr [EBP + 0x4]
005f29f0 : PUSH EDI
005f29f1 : LEA EDX,[ESI + ESI*0x2]
005f29f4 : CMP dword ptr [EBP + EDX*0x8 + 0x8],-0x2
005f29f9 : LEA EDI,[EBP + EDX*0x8 + 0x8]
005f29fd : JZ 0x005f2a7f
005f2a03 : CMP dword ptr [EDI + 0x4],ESI
005f2a06 : JNZ 0x005f2a7f
005f2a08 : MOV dword ptr [ESP + 0x1c],ESI
005f2a0c : MOV dword ptr [ESP + 0x10],0xffffffff
005f2a14 : MOV EAX,dword ptr [ESP + 0x1c]
005f2a18 : CMP dword ptr [EDI + 0x4],EAX
005f2a1b : JNZ 0x005f2a2a
005f2a1d : PUSH EBX
005f2a1e : LEA ECX,[EDI + 0x8]
005f2a21 : CALL 0x00599050
005f2a26 : TEST AL,AL
005f2a28 : JNZ 0x005f2a3e
005f2a2a : MOV dword ptr [ESP + 0x10],ESI
005f2a2e : MOV ESI,dword ptr [EDI]
005f2a30 : CMP ESI,-0x1
005f2a33 : JZ 0x005f2a7f
005f2a35 : LEA ECX,[ESI + ESI*0x2]
005f2a38 : LEA EDI,[EBP + ECX*0x8 + 0x8]
005f2a3c : JMP 0x005f2a14
005f2a3e : CMP dword ptr [ESP + 0x1c],ESI
005f2a42 : JNZ 0x005f2a64
005f2a44 : MOV EAX,dword ptr [EDI]
005f2a46 : CMP EAX,-0x1
005f2a49 : JZ 0x005f2a71
005f2a4b : LEA EDX,[EAX + EAX*0x2]
005f2a4e : LEA EBP,[EBP + EDX*0x8 + 0x8]
005f2a52 : PUSH EBP
005f2a53 : MOV ECX,EDI
005f2a55 : MOV dword ptr [EDI],0xfffffffe
005f2a5b : CALL 0x005f1c00
005f2a60 : MOV EDI,EBP
005f2a62 : JMP 0x005f2a71
005f2a64 : MOV EAX,dword ptr [ESP + 0x10]
005f2a68 : MOV ECX,dword ptr [EDI]
005f2a6a : LEA EAX,[EAX + EAX*0x2]
005f2a6d : MOV dword ptr [EBP + EAX*0x8 + 0x8],ECX
005f2a71 : MOV EDX,dword ptr [ESP + 0x14]
005f2a75 : MOV dword ptr [EDI],0xfffffffe
005f2a7b : MOV EAX,dword ptr [EDX]
005f2a7d : DEC dword ptr [EAX]
005f2a7f : POP EDI
005f2a80 : POP ESI
005f2a81 : POP EBX
005f2a82 : POP EBP
005f2a83 : ADD ESP,0x8
005f2a86 : RET 0x4

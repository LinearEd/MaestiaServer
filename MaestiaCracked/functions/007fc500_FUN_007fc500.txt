PROGRAM  : Maestia.exe
FUNCTION : FUN_007fc500
ENTRY    : 007fc500
BODY     : [[007fc500, 007fc68c]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007fc500(void)

{
  float fVar1;
  float *in_EAX;
  int iVar2;
  uint uVar3;
  int unaff_EDI;
  uint local_18;
  uint local_10;
  uint local_c;
  
  fVar1 = *in_EAX;
  if (fVar1 < 1.0) {
    if (0.0 < fVar1) {
      local_18 = (uint)(longlong)ROUND(fVar1 * 255.0 + DAT_00d72c24);
      uVar3 = local_18;
    }
    else {
      uVar3 = 0;
    }
  }
  else {
    uVar3 = 0xff;
  }
  fVar1 = in_EAX[1];
  if (fVar1 < 1.0) {
    if (0.0 < fVar1) {
      local_18 = (uint)(longlong)ROUND(fVar1 * 255.0 + DAT_00d72c24);
      local_c = local_18;
    }
    else {
      local_c = 0;
    }
  }
  else {
    local_c = 0xff;
  }
  fVar1 = in_EAX[2];
  if (fVar1 < 1.0) {
    if (0.0 < fVar1) {
      local_18 = (uint)(longlong)ROUND(fVar1 * 255.0 + DAT_00d72c24);
      local_10 = local_18;
    }
    else {
      local_10 = 0;
    }
  }
  else {
    local_10 = 0xff;
  }
  fVar1 = in_EAX[3];
  if (fVar1 < 1.0) {
    if (0.0 < fVar1) {
      local_18 = (uint)(longlong)ROUND(DAT_00d72c24 + fVar1 * 255.0);
    }
    else {
      local_18 = 0;
    }
  }
  else {
    local_18 = 0xff;
  }
  iVar2 = (**(code **)(**(int **)(unaff_EDI + 0x18) + 0xe4))
                    (*(int **)(unaff_EDI + 0x18),0x8b,
                     ((local_18 << 8 | uVar3) << 8 | local_c) << 8 | local_10);
  *(undefined8 *)(unaff_EDI + 0x1f8) = *(undefined8 *)in_EAX;
  *(undefined8 *)(unaff_EDI + 0x200) = *(undefined8 *)(in_EAX + 2);
  if (iVar2 < 0) {
    FUN_008018d0(L"AvaRender::SetGlobalAmbient1 (%d)",iVar2);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
007fc500 : PUSH EBP
007fc501 : MOV EBP,ESP
007fc503 : SUB ESP,0x14
007fc506 : MOVSS XMM1,dword ptr [0x00c10fc4]
007fc50e : FLD float ptr [0x00cdf130]
007fc514 : FLD float ptr [0x00d72c24]
007fc51a : XORPS XMM2,XMM2
007fc51d : PUSH EBX
007fc51e : PUSH ESI
007fc51f : MOV ESI,EAX
007fc521 : MOVSS XMM0,dword ptr [ESI]
007fc525 : XOR ECX,ECX
007fc527 : COMISS XMM0,XMM1
007fc52a : MOVSS dword ptr [EBP + -0xc],XMM0
007fc52f : MOV EBX,0xff
007fc534 : JC 0x007fc53a
007fc536 : MOV EDX,EBX
007fc538 : JMP 0x007fc565
007fc53a : COMISS XMM2,XMM0
007fc53d : JC 0x007fc543
007fc53f : XOR EDX,EDX
007fc541 : JMP 0x007fc565
007fc543 : FLD float ptr [EBP + -0xc]
007fc546 : FNSTCW word ptr [EBP + -0x2]
007fc549 : MOVZX EAX,word ptr [EBP + -0x2]
007fc54d : FMUL ST2
007fc54f : OR EAX,0xc00
007fc554 : MOV dword ptr [EBP + -0xc],EAX
007fc557 : FADD ST0,ST1
007fc559 : FLDCW word ptr [EBP + -0xc]
007fc55c : FISTP qword ptr [EBP + -0x14]
007fc55f : MOV EDX,dword ptr [EBP + -0x14]
007fc562 : FLDCW word ptr [EBP + -0x2]
007fc565 : MOVSS XMM0,dword ptr [ESI + 0x4]
007fc56a : COMISS XMM0,XMM1
007fc56d : MOVSS dword ptr [EBP + -0xc],XMM0
007fc572 : JC 0x007fc579
007fc574 : MOV dword ptr [EBP + -0x8],EBX
007fc577 : JMP 0x007fc5a8
007fc579 : COMISS XMM2,XMM0
007fc57c : JC 0x007fc583
007fc57e : MOV dword ptr [EBP + -0x8],ECX
007fc581 : JMP 0x007fc5a8
007fc583 : FLD float ptr [EBP + -0xc]
007fc586 : FNSTCW word ptr [EBP + -0x2]
007fc589 : MOVZX EAX,word ptr [EBP + -0x2]
007fc58d : FMUL ST2
007fc58f : OR EAX,0xc00
007fc594 : MOV dword ptr [EBP + -0xc],EAX
007fc597 : FADD ST0,ST1
007fc599 : FLDCW word ptr [EBP + -0xc]
007fc59c : FISTP qword ptr [EBP + -0x14]
007fc59f : MOV EAX,dword ptr [EBP + -0x14]
007fc5a2 : MOV dword ptr [EBP + -0x8],EAX
007fc5a5 : FLDCW word ptr [EBP + -0x2]
007fc5a8 : MOVSS XMM0,dword ptr [ESI + 0x8]
007fc5ad : COMISS XMM0,XMM1
007fc5b0 : MOVSS dword ptr [EBP + -0xc],XMM0
007fc5b5 : JC 0x007fc5bc
007fc5b7 : MOV dword ptr [EBP + -0xc],EBX
007fc5ba : JMP 0x007fc5eb
007fc5bc : COMISS XMM2,XMM0
007fc5bf : JC 0x007fc5c6
007fc5c1 : MOV dword ptr [EBP + -0xc],ECX
007fc5c4 : JMP 0x007fc5eb
007fc5c6 : FLD float ptr [EBP + -0xc]
007fc5c9 : FNSTCW word ptr [EBP + -0x2]
007fc5cc : MOVZX EAX,word ptr [EBP + -0x2]
007fc5d0 : FMUL ST2
007fc5d2 : OR EAX,0xc00
007fc5d7 : MOV dword ptr [EBP + -0xc],EAX
007fc5da : FADD ST0,ST1
007fc5dc : FLDCW word ptr [EBP + -0xc]
007fc5df : FISTP qword ptr [EBP + -0x14]
007fc5e2 : MOV EAX,dword ptr [EBP + -0x14]
007fc5e5 : MOV dword ptr [EBP + -0xc],EAX
007fc5e8 : FLDCW word ptr [EBP + -0x2]
007fc5eb : MOVSS XMM0,dword ptr [ESI + 0xc]
007fc5f0 : COMISS XMM0,XMM1
007fc5f3 : MOVSS dword ptr [EBP + -0x4],XMM0
007fc5f8 : JC 0x007fc602
007fc5fa : FSTP ST1
007fc5fc : MOV EAX,EBX
007fc5fe : FSTP ST0
007fc600 : JMP 0x007fc631
007fc602 : COMISS XMM2,XMM0
007fc605 : JC 0x007fc60f
007fc607 : FSTP ST1
007fc609 : XOR EAX,EAX
007fc60b : FSTP ST0
007fc60d : JMP 0x007fc631
007fc60f : FLD float ptr [EBP + -0x4]
007fc612 : FNSTCW word ptr [EBP + -0x2]
007fc615 : MOVZX EAX,word ptr [EBP + -0x2]
007fc619 : FMULP ST2
007fc61b : OR EAX,0xc00
007fc620 : MOV dword ptr [EBP + -0x10],EAX
007fc623 : FADDP
007fc625 : FLDCW word ptr [EBP + -0x10]
007fc628 : FISTP qword ptr [EBP + -0x14]
007fc62b : MOV EAX,dword ptr [EBP + -0x14]
007fc62e : FLDCW word ptr [EBP + -0x2]
007fc631 : MOV ECX,dword ptr [EDI + 0x18]
007fc634 : MOV EBX,dword ptr [ECX]
007fc636 : SHL EAX,0x8
007fc639 : OR EAX,EDX
007fc63b : SHL EAX,0x8
007fc63e : OR EAX,dword ptr [EBP + -0x8]
007fc641 : SHL EAX,0x8
007fc644 : OR EAX,dword ptr [EBP + -0xc]
007fc647 : PUSH EAX
007fc648 : PUSH 0x8b
007fc64d : PUSH ECX
007fc64e : MOV ECX,dword ptr [EBX + 0xe4]
007fc654 : CALL ECX
007fc656 : MOVQ XMM0,qword ptr [ESI]
007fc65a : MOVQ qword ptr [EDI + 0x1f8],XMM0
007fc662 : MOVQ XMM0,qword ptr [ESI + 0x8]
007fc667 : MOVQ qword ptr [EDI + 0x200],XMM0
007fc66f : TEST EAX,EAX
007fc671 : JGE 0x007fc687
007fc673 : MOV ESI,dword ptr [0x00da98e8]
007fc679 : PUSH EAX
007fc67a : PUSH 0xc27f68
007fc67f : CALL 0x008018d0
007fc684 : ADD ESP,0x8
007fc687 : POP ESI
007fc688 : POP EBX
007fc689 : MOV ESP,EBP
007fc68b : POP EBP
007fc68c : RET

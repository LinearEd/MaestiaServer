PROGRAM  : Maestia.exe
FUNCTION : FUN_004744b0
ENTRY    : 004744b0
BODY     : [[004744b0, 00474543]]

============================================================
DECOMPILED C CODE
============================================================

undefined1 FUN_004744b0(void)

{
  undefined1 uVar1;
  uint uVar2;
  int iVar3;
  int unaff_EDI;
  
  uVar2 = *(uint *)(unaff_EDI + 0x4c) / *(uint *)(unaff_EDI + 0x58);
  *(uint *)(unaff_EDI + 0x5c) = uVar2;
  uVar1 = FUN_00474430(*(undefined4 *)(unaff_EDI + 0x48),uVar2);
  if (*(char *)(unaff_EDI + 0x54) == '\0') {
    FUN_00455c80();
    *(undefined4 *)(unaff_EDI + 0x48) = 0;
    *(undefined4 *)(unaff_EDI + 0x50) = 0;
  }
  *(undefined4 *)(unaff_EDI + 0x4c) = 0;
  if (-1 < *(int *)(unaff_EDI + 100)) {
    iVar3 = *(int *)(unaff_EDI + 100) * 0x114;
    if ((&DAT_017212d0)[iVar3] != '\0') {
      (&DAT_017212d0)[iVar3] = 0;
      *(undefined4 *)(&DAT_017211cc + iVar3) = 0;
      (&DAT_017211d0)[iVar3] = 0;
      *(undefined4 *)(unaff_EDI + 100) = 0xffffffff;
      return uVar1;
    }
    FUN_00807d70("CSharedHeapBlock::Unlock() called when buffer was not locked");
    *(undefined4 *)(unaff_EDI + 100) = 0xffffffff;
  }
  return uVar1;
}



============================================================
DISASSEMBLY
============================================================
004744b0 : PUSH EBP
004744b1 : MOV EBP,ESP
004744b3 : SUB ESP,0x8
004744b6 : MOV EAX,dword ptr [EDI + 0x4c]
004744b9 : XOR EDX,EDX
004744bb : DIV dword ptr [EDI + 0x58]
004744be : MOV ECX,dword ptr [EDI + 0x48]
004744c1 : PUSH EBX
004744c2 : PUSH EAX
004744c3 : MOV dword ptr [EDI + 0x5c],EAX
004744c6 : PUSH ECX
004744c7 : LEA EAX,[EDI + 0x4]
004744ca : CALL 0x00474430
004744cf : XOR EBX,EBX
004744d1 : MOV byte ptr [EBP + -0x1],AL
004744d4 : CMP byte ptr [EDI + 0x54],BL
004744d7 : JNZ 0x004744ef
004744d9 : MOV EAX,dword ptr [EDI + 0x48]
004744dc : PUSH ESI
004744dd : LEA ESI,[EBP + -0x8]
004744e0 : MOV dword ptr [EBP + -0x8],EAX
004744e3 : CALL 0x00455c80
004744e8 : MOV dword ptr [EDI + 0x48],EBX
004744eb : MOV dword ptr [EDI + 0x50],EBX
004744ee : POP ESI
004744ef : MOV dword ptr [EDI + 0x4c],EBX
004744f2 : MOV EAX,dword ptr [EDI + 0x64]
004744f5 : CMP EAX,-0x1
004744f8 : JLE 0x0047453c
004744fa : IMUL EAX,EAX,0x114
00474500 : ADD EAX,0x17211c0
00474505 : CMP byte ptr [EAX + 0x110],BL
0047450b : JZ 0x00474528
0047450d : MOV byte ptr [EAX + 0x110],BL
00474513 : MOV dword ptr [EAX + 0xc],EBX
00474516 : MOV byte ptr [EAX + 0x10],BL
00474519 : MOV AL,byte ptr [EBP + -0x1]
0047451c : MOV dword ptr [EDI + 0x64],0xffffffff
00474523 : POP EBX
00474524 : MOV ESP,EBP
00474526 : POP EBP
00474527 : RET
00474528 : PUSH 0xcd4178
0047452d : CALL 0x00807d70
00474532 : ADD ESP,0x4
00474535 : MOV dword ptr [EDI + 0x64],0xffffffff
0047453c : MOV AL,byte ptr [EBP + -0x1]
0047453f : POP EBX
00474540 : MOV ESP,EBP
00474542 : POP EBP
00474543 : RET

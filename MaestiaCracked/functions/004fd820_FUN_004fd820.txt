PROGRAM  : Maestia.exe
FUNCTION : FUN_004fd820
ENTRY    : 004fd820
BODY     : [[004fd820, 004fd8ce]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_004fd820(int param_1)

{
  void *_Src;
  char cVar1;
  int iVar2;
  int in_ECX;
  int iVar3;
  undefined1 local_24 [32];
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)local_24;
  iVar2 = param_1 - *(int *)(in_ECX + 4) >> 5;
  cVar1 = FUN_004fc390();
  if (cVar1 != '\0') {
    if (1 < *(uint *)(in_ECX + 8)) {
      _memmove(local_24,(void *)(*(uint *)(in_ECX + 8) * 0x20 + -0x20 + *(int *)(in_ECX + 4)),0x20);
      iVar3 = iVar2 * 0x20;
      _Src = (void *)(iVar3 + *(int *)(in_ECX + 4));
      _memmove((void *)((int)_Src + 0x20),_Src,((*(int *)(in_ECX + 8) - iVar2) + -1) * 0x20);
      _memmove((void *)(*(int *)(in_ECX + 4) + iVar3),local_24,0x20);
    }
    __security_check_cookie(local_4 ^ (uint)local_24);
    return;
  }
  __security_check_cookie(local_4 ^ (uint)local_24);
  return;
}



============================================================
DISASSEMBLY
============================================================
004fd820 : SUB ESP,0x24
004fd823 : MOV EAX,[0x00d66fa0]
004fd828 : XOR EAX,ESP
004fd82a : MOV dword ptr [ESP + 0x20],EAX
004fd82e : MOV EAX,dword ptr [ESP + 0x28]
004fd832 : PUSH EBX
004fd833 : PUSH ESI
004fd834 : MOV ESI,ECX
004fd836 : SUB EAX,dword ptr [ESI + 0x4]
004fd839 : PUSH EDI
004fd83a : SAR EAX,0x5
004fd83d : MOV EDI,EDX
004fd83f : MOV EBX,EAX
004fd841 : CALL 0x004fc390
004fd846 : TEST AL,AL
004fd848 : JZ 0x004fd8b9
004fd84a : MOV EAX,dword ptr [ESI + 0x8]
004fd84d : CMP EAX,0x1
004fd850 : JBE 0x004fd89d
004fd852 : MOV ECX,dword ptr [ESI + 0x4]
004fd855 : SHL EAX,0x5
004fd858 : LEA EDX,[EAX + ECX*0x1 + -0x20]
004fd85c : PUSH 0x20
004fd85e : PUSH EDX
004fd85f : LEA EAX,[ESP + 0x14]
004fd863 : PUSH EAX
004fd864 : CALL 0x00636880
004fd869 : MOV EDX,dword ptr [ESI + 0x8]
004fd86c : MOV ECX,dword ptr [ESI + 0x4]
004fd86f : SUB EDX,EBX
004fd871 : DEC EDX
004fd872 : MOV EDI,EBX
004fd874 : SHL EDX,0x5
004fd877 : SHL EDI,0x5
004fd87a : LEA EAX,[EDI + ECX*0x1]
004fd87d : PUSH EDX
004fd87e : PUSH EAX
004fd87f : ADD EAX,0x20
004fd882 : PUSH EAX
004fd883 : CALL 0x00636880
004fd888 : MOV ECX,dword ptr [ESI + 0x4]
004fd88b : PUSH 0x20
004fd88d : LEA EAX,[ESP + 0x28]
004fd891 : PUSH EAX
004fd892 : ADD ECX,EDI
004fd894 : PUSH ECX
004fd895 : CALL 0x00636880
004fd89a : ADD ESP,0x24
004fd89d : MOV EAX,EBX
004fd89f : SHL EAX,0x5
004fd8a2 : ADD EAX,dword ptr [ESI + 0x4]
004fd8a5 : POP EDI
004fd8a6 : POP ESI
004fd8a7 : POP EBX
004fd8a8 : MOV ECX,dword ptr [ESP + 0x20]
004fd8ac : XOR ECX,ESP
004fd8ae : CALL 0x00633e6b
004fd8b3 : ADD ESP,0x24
004fd8b6 : RET 0x4
004fd8b9 : MOV ECX,dword ptr [ESP + 0x2c]
004fd8bd : POP EDI
004fd8be : POP ESI
004fd8bf : POP EBX
004fd8c0 : XOR ECX,ESP
004fd8c2 : XOR EAX,EAX
004fd8c4 : CALL 0x00633e6b
004fd8c9 : ADD ESP,0x24
004fd8cc : RET 0x4

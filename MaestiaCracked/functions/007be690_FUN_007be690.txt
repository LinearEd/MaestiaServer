PROGRAM  : Maestia.exe
FUNCTION : FUN_007be690
ENTRY    : 007be690
BODY     : [[007be690, 007be9be]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x007be824) */
/* WARNING: Removing unreachable block (ram,0x007be82c) */
/* WARNING: Removing unreachable block (ram,0x007be836) */
/* WARNING: Removing unreachable block (ram,0x007be86f) */
/* WARNING: Removing unreachable block (ram,0x007be883) */
/* WARNING: Removing unreachable block (ram,0x007be875) */

void FUN_007be690(int param_1)

{
  char cVar1;
  uint uVar2;
  int iVar3;
  int *in_ECX;
  LPCRITICAL_SECTION local_40;
  char *local_3c;
  undefined4 local_38;
  int local_34;
  undefined4 local_30;
  undefined8 local_2c;
  undefined8 local_24;
  undefined4 local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b284ad;
  local_14 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xffffffa8;
  ExceptionList = &local_14;
  local_40 = (LPCRITICAL_SECTION)(param_1 + 4);
  local_34 = 0;
  local_3c = ".\\mss\\AvaMssMgr.cpp";
  local_38 = 0x1e6;
  local_30 = 1;
  FUN_006ef1a0(&local_40);
  local_c = 0;
  if (*(int *)(param_1 + 0x20) == 0) {
    local_c = 0xffffffff;
    if (local_34 == 0) {
      ExceptionList = local_14;
      return;
    }
    LeaveCriticalSection(local_40);
    ExceptionList = local_14;
    return;
  }
  if (*(int *)(param_1 + 0xd4) == 0) {
    local_c = 0xffffffff;
    if (local_34 == 0) {
      ExceptionList = local_14;
      return;
    }
    LeaveCriticalSection(local_40);
    ExceptionList = local_14;
    return;
  }
  if (*(char *)(param_1 + 0xd8) == '\0') {
    local_c = 0xffffffff;
    if (local_34 == 0) {
      ExceptionList = local_14;
      return;
    }
    LeaveCriticalSection(local_40);
    ExceptionList = local_14;
    return;
  }
  if ((0 < in_ECX[8]) && ((*(int *)(param_1 + 0x44) - *(int *)(param_1 + 0x40) & 0xfffffffcU) != 0))
  {
    FUN_00464420();
    FUN_004647f0(&local_2c,*(undefined4 *)(param_1 + 0x40),*(undefined4 *)(param_1 + 0x44),local_2c,
                 local_24,local_1c,uVar2);
  }
  if (*(uint *)(param_1 + 0xc4) <= (uint)(*(int *)(param_1 + 0x44) - *(int *)(param_1 + 0x40) >> 2))
  {
    FUN_004648a0();
    if (*in_ECX < *(int *)(*(int *)(*(int *)(param_1 + 0x44) + -4) + 4)) goto LAB_007be999;
    FUN_00464590();
    FUN_00753ea0();
    cVar1 = FUN_007bd440();
    if (cVar1 == '\0') {
      FUN_00464400();
    }
  }
  iVar3 = FUN_007bd7e0(in_ECX + 1);
  if (iVar3 == 0) {
    (*(code *)PTR_FUN_00d6d23c)("(!)%s(%d)\n","AvaLib::AvaMssMgr::Play2DSound",0x21d);
  }
  else {
    iVar3 = FUN_007548e0(iVar3,*in_ECX,*(undefined4 *)(param_1 + 0x20),in_ECX + 1,
                         *(float *)(param_1 + 0x9c) * (float)in_ECX[10],in_ECX[0xb],in_ECX[0xc]);
    if (iVar3 == 1) {
      FUN_00449730();
    }
    else {
      cVar1 = FUN_007bd440();
      if (cVar1 == '\0') {
        FUN_00464400();
      }
    }
    if (*(char *)(param_1 + 0x1c) != '\0') {
      (*(code *)PTR_FUN_00d6d23c)();
    }
  }
LAB_007be999:
  local_c = 0xffffffff;
  FUN_006ef180();
  ExceptionList = local_14;
  return;
}



============================================================
DISASSEMBLY
============================================================
007be690 : PUSH EBP
007be691 : MOV EBP,ESP
007be693 : AND ESP,0xfffffff8
007be696 : PUSH -0x1
007be698 : PUSH 0xb284ad
007be69d : MOV EAX,FS:[0x0]
007be6a3 : PUSH EAX
007be6a4 : SUB ESP,0x38
007be6a7 : PUSH EBX
007be6a8 : PUSH ESI
007be6a9 : PUSH EDI
007be6aa : MOV EAX,[0x00d66fa0]
007be6af : XOR EAX,ESP
007be6b1 : PUSH EAX
007be6b2 : LEA EAX,[ESP + 0x48]
007be6b6 : MOV FS:[0x0],EAX
007be6bc : MOV EDI,ECX
007be6be : MOV EBX,dword ptr [EBP + 0x8]
007be6c1 : LEA ECX,[ESP + 0x1c]
007be6c5 : LEA EAX,[EBX + 0x4]
007be6c8 : XOR ESI,ESI
007be6ca : PUSH ECX
007be6cb : MOV dword ptr [ESP + 0x2c],ESI
007be6cf : MOV dword ptr [ESP + 0x20],EAX
007be6d3 : MOV dword ptr [ESP + 0x24],0xc18d4c
007be6db : MOV dword ptr [ESP + 0x28],0x1e6
007be6e3 : MOV dword ptr [ESP + 0x30],0x1
007be6eb : CALL 0x006ef1a0
007be6f0 : MOV dword ptr [ESP + 0x50],ESI
007be6f4 : CMP dword ptr [EBX + 0x20],ESI
007be6f7 : JNZ 0x007be72f
007be6f9 : MOV dword ptr [ESP + 0x50],0xffffffff
007be701 : CMP dword ptr [ESP + 0x28],ESI
007be705 : JZ 0x007be9aa
007be70b : MOV EDX,dword ptr [ESP + 0x1c]
007be70f : PUSH EDX
007be710 : CALL dword ptr [0x00b8511c]
007be716 : MOV dword ptr [ESP + 0x28],ESI
007be71a : MOV ECX,dword ptr [ESP + 0x48]
007be71e : MOV dword ptr FS:[0x0],ECX
007be725 : POP ECX
007be726 : POP EDI
007be727 : POP ESI
007be728 : POP EBX
007be729 : MOV ESP,EBP
007be72b : POP EBP
007be72c : RET 0x4
007be72f : CMP dword ptr [EBX + 0xd4],ESI
007be735 : JNZ 0x007be76d
007be737 : MOV dword ptr [ESP + 0x50],0xffffffff
007be73f : CMP dword ptr [ESP + 0x28],ESI
007be743 : JZ 0x007be9aa
007be749 : MOV EAX,dword ptr [ESP + 0x1c]
007be74d : PUSH EAX
007be74e : CALL dword ptr [0x00b8511c]
007be754 : MOV dword ptr [ESP + 0x28],ESI
007be758 : MOV ECX,dword ptr [ESP + 0x48]
007be75c : MOV dword ptr FS:[0x0],ECX
007be763 : POP ECX
007be764 : POP EDI
007be765 : POP ESI
007be766 : POP EBX
007be767 : MOV ESP,EBP
007be769 : POP EBP
007be76a : RET 0x4
007be76d : CMP byte ptr [EBX + 0xd8],0x0
007be774 : JNZ 0x007be7ac
007be776 : MOV dword ptr [ESP + 0x50],0xffffffff
007be77e : CMP dword ptr [ESP + 0x28],ESI
007be782 : JZ 0x007be9aa
007be788 : MOV ECX,dword ptr [ESP + 0x1c]
007be78c : PUSH ECX
007be78d : CALL dword ptr [0x00b8511c]
007be793 : MOV dword ptr [ESP + 0x28],ESI
007be797 : MOV ECX,dword ptr [ESP + 0x48]
007be79b : MOV dword ptr FS:[0x0],ECX
007be7a2 : POP ECX
007be7a3 : POP EDI
007be7a4 : POP ESI
007be7a5 : POP EBX
007be7a6 : MOV ESP,EBP
007be7a8 : POP EBP
007be7a9 : RET 0x4
007be7ac : MOV ECX,dword ptr [EDI + 0x20]
007be7af : CMP ECX,ESI
007be7b1 : JLE 0x007be891
007be7b7 : MOV EDX,dword ptr [EBX + 0x44]
007be7ba : SUB EDX,dword ptr [EBX + 0x40]
007be7bd : TEST EDX,0xfffffffc
007be7c3 : JZ 0x007be891
007be7c9 : PUSH ECX
007be7ca : LEA ECX,[ESP + 0x1c]
007be7ce : MOV dword ptr [ESP + 0x18],ESI
007be7d2 : MOV dword ptr [ESP + 0x1c],ESI
007be7d6 : PUSH ECX
007be7d7 : LEA EAX,[EDI + 0x4]
007be7da : LEA ECX,[ESP + 0x1c]
007be7de : LEA ESI,[ESP + 0x38]
007be7e2 : CALL 0x00464420
007be7e7 : MOV ECX,dword ptr [EBX + 0x44]
007be7ea : MOV EDX,dword ptr [EBX + 0x40]
007be7ed : MOVQ XMM0,qword ptr [ESP + 0x30]
007be7f3 : MOV ESI,dword ptr [ESP + 0x40]
007be7f7 : SUB ESP,0x14
007be7fa : MOV EAX,ESP
007be7fc : PUSH ECX
007be7fd : MOVQ qword ptr [EAX],XMM0
007be801 : MOVQ XMM0,qword ptr [ESP + 0x50]
007be807 : PUSH EDX
007be808 : LEA EDX,[ESP + 0x4c]
007be80c : MOVQ qword ptr [EAX + 0x8],XMM0
007be811 : PUSH EDX
007be812 : MOV dword ptr [EAX + 0x10],ESI
007be815 : CALL 0x004647f0
007be81a : ADD ESP,0x20
007be81d : CMP dword ptr [ESP + 0x14],0x0
007be822 : JZ 0x007be891
007be824 : MOV EAX,dword ptr [ESP + 0x18]
007be828 : TEST EAX,EAX
007be82a : JZ 0x007be891
007be82c : CMP dword ptr [EDI + 0x24],0x0
007be830 : JZ 0x007be999
007be836 : FLD float ptr [EDI + 0x2c]
007be839 : MOVSS XMM0,dword ptr [EBX + 0x9c]
007be841 : MULSS XMM0,dword ptr [EDI + 0x28]
007be846 : MOV ECX,dword ptr [EBX + 0x20]
007be849 : MOV EDX,dword ptr [EDI]
007be84b : PUSH 0x0
007be84d : SUB ESP,0x8
007be850 : FSTP float ptr [ESP + 0x4]
007be854 : MOVSS dword ptr [ESP],XMM0
007be859 : LEA ESI,[EDI + 0x4]
007be85c : PUSH ESI
007be85d : PUSH ECX
007be85e : PUSH EDX
007be85f : PUSH EAX
007be860 : CALL 0x007548e0
007be865 : CMP byte ptr [EBX + 0x1c],0x0
007be869 : JZ 0x007be999
007be86f : CMP dword ptr [ESI + 0x18],0x8
007be873 : JC 0x007be883
007be875 : MOV ESI,dword ptr [ESI + 0x4]
007be878 : PUSH ESI
007be879 : PUSH 0xc18d60
007be87e : JMP 0x007be990
007be883 : ADD ESI,0x4
007be886 : PUSH ESI
007be887 : PUSH 0xc18d60
007be88c : JMP 0x007be990
007be891 : MOV EAX,dword ptr [EBX + 0x44]
007be894 : SUB EAX,dword ptr [EBX + 0x40]
007be897 : SAR EAX,0x2
007be89a : CMP EAX,dword ptr [EBX + 0xc4]
007be8a0 : JC 0x007be8e8
007be8a2 : MOV EAX,dword ptr [EBX + 0x44]
007be8a5 : MOV ECX,dword ptr [EBX + 0x40]
007be8a8 : PUSH EAX
007be8a9 : PUSH ECX
007be8aa : MOV EAX,0x7bb0d0
007be8af : CALL 0x004648a0
007be8b4 : MOV EAX,dword ptr [EBX + 0x44]
007be8b7 : MOV ESI,dword ptr [EAX + -0x4]
007be8ba : MOV ECX,dword ptr [ESI + 0x4]
007be8bd : ADD ESP,0x8
007be8c0 : CMP ECX,dword ptr [EDI]
007be8c2 : JG 0x007be999
007be8c8 : LEA EAX,[EBX + 0x3c]
007be8cb : CALL 0x00464590
007be8d0 : CALL 0x00753ea0
007be8d5 : PUSH -0x5
007be8d7 : PUSH ESI
007be8d8 : MOV ECX,EBX
007be8da : CALL 0x007bd440
007be8df : TEST AL,AL
007be8e1 : JNZ 0x007be8e8
007be8e3 : CALL 0x00464400
007be8e8 : LEA EAX,[EDI + 0x4]
007be8eb : PUSH EAX
007be8ec : MOV ECX,EBX
007be8ee : MOV dword ptr [ESP + 0x1c],EAX
007be8f2 : CALL 0x007bd7e0
007be8f7 : MOV ESI,EAX
007be8f9 : MOV dword ptr [ESP + 0x14],ESI
007be8fd : TEST ESI,ESI
007be8ff : JNZ 0x007be91b
007be901 : PUSH 0x21d
007be906 : PUSH 0xc18d70
007be90b : PUSH 0xc18d90
007be910 : CALL dword ptr [0x00d6d23c]
007be916 : ADD ESP,0xc
007be919 : JMP 0x007be999
007be91b : MOV EDX,dword ptr [EDI + 0x30]
007be91e : FLD float ptr [EDI + 0x2c]
007be921 : MOVSS XMM0,dword ptr [EBX + 0x9c]
007be929 : MULSS XMM0,dword ptr [EDI + 0x28]
007be92e : MOV EAX,dword ptr [ESP + 0x18]
007be932 : MOV ECX,dword ptr [EBX + 0x20]
007be935 : PUSH EDX
007be936 : MOV EDX,dword ptr [EDI]
007be938 : SUB ESP,0x8
007be93b : FSTP float ptr [ESP + 0x4]
007be93f : MOVSS dword ptr [ESP],XMM0
007be944 : PUSH EAX
007be945 : PUSH ECX
007be946 : PUSH EDX
007be947 : PUSH ESI
007be948 : CALL 0x007548e0
007be94d : CMP EAX,0x1
007be950 : JNZ 0x007be960
007be952 : LEA EDI,[ESP + 0x14]
007be956 : LEA EDX,[EBX + 0x3c]
007be959 : CALL 0x00449730
007be95e : JMP 0x007be972
007be960 : PUSH EAX
007be961 : PUSH ESI
007be962 : MOV ECX,EBX
007be964 : CALL 0x007bd440
007be969 : TEST AL,AL
007be96b : JNZ 0x007be972
007be96d : CALL 0x00464400
007be972 : CMP byte ptr [EBX + 0x1c],0x0
007be976 : JZ 0x007be999
007be978 : MOV EAX,dword ptr [ESP + 0x18]
007be97c : CMP dword ptr [EAX + 0x18],0x8
007be980 : JC 0x007be987
007be982 : MOV EAX,dword ptr [EAX + 0x4]
007be985 : JMP 0x007be98a
007be987 : ADD EAX,0x4
007be98a : PUSH EAX
007be98b : PUSH 0xc18d9c
007be990 : CALL dword ptr [0x00d6d23c]
007be996 : ADD ESP,0x8
007be999 : MOV dword ptr [ESP + 0x50],0xffffffff
007be9a1 : LEA ESI,[ESP + 0x1c]
007be9a5 : CALL 0x006ef180
007be9aa : MOV ECX,dword ptr [ESP + 0x48]
007be9ae : MOV dword ptr FS:[0x0],ECX
007be9b5 : POP ECX
007be9b6 : POP EDI
007be9b7 : POP ESI
007be9b8 : POP EBX
007be9b9 : MOV ESP,EBP
007be9bb : POP EBP
007be9bc : RET 0x4

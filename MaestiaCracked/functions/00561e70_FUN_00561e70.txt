PROGRAM  : Maestia.exe
FUNCTION : FUN_00561e70
ENTRY    : 00561e70
BODY     : [[00561e70, 00561ec1]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00561e70(int *param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int *in_ECX;
  int *piVar3;
  
  iVar1 = *in_ECX;
  piVar3 = (int *)(param_2 * 0x10 + 8 + iVar1);
  if ((*(int *)(param_2 * 0x10 + 8 + iVar1) != -2) && (iVar2 = param_2, piVar3[1] == param_2)) {
    while ((piVar3[1] != param_2 || (piVar3[2] != *param_1))) {
      iVar2 = *piVar3;
      if (iVar2 == -1) {
        return -1;
      }
      piVar3 = (int *)(iVar2 * 0x10 + 8 + iVar1);
    }
    return iVar2;
  }
  return -1;
}



============================================================
DISASSEMBLY
============================================================
00561e70 : MOV EDX,dword ptr [ESP + 0x8]
00561e74 : PUSH ESI
00561e75 : MOV ESI,dword ptr [ECX]
00561e77 : MOV ECX,EDX
00561e79 : SHL ECX,0x4
00561e7c : CMP dword ptr [ECX + ESI*0x1 + 0x8],-0x2
00561e81 : LEA ECX,[ECX + ESI*0x1 + 0x8]
00561e85 : MOV EAX,EDX
00561e87 : JZ 0x00561ebb
00561e89 : CMP dword ptr [ECX + 0x4],EDX
00561e8c : JNZ 0x00561ebb
00561e8e : PUSH EDI
00561e8f : MOV EDI,dword ptr [ESP + 0xc]
00561e93 : PUSH EBX
00561e94 : CMP dword ptr [ECX + 0x4],EDX
00561e97 : JNZ 0x00561ea0
00561e99 : MOV EBX,dword ptr [ECX + 0x8]
00561e9c : CMP EBX,dword ptr [EDI]
00561e9e : JZ 0x00561eb5
00561ea0 : MOV EAX,dword ptr [ECX]
00561ea2 : CMP EAX,-0x1
00561ea5 : JZ 0x00561eb2
00561ea7 : MOV ECX,EAX
00561ea9 : SHL ECX,0x4
00561eac : LEA ECX,[ECX + ESI*0x1 + 0x8]
00561eb0 : JMP 0x00561e94
00561eb2 : OR EAX,0xffffffff
00561eb5 : POP EBX
00561eb6 : POP EDI
00561eb7 : POP ESI
00561eb8 : RET 0x8
00561ebb : OR EAX,0xffffffff
00561ebe : POP ESI
00561ebf : RET 0x8

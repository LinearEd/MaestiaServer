PROGRAM  : Maestia.exe
FUNCTION : FUN_00708d80
ENTRY    : 00708d80
BODY     : [[00708d80, 00708de8] [00708df0, 00708edc]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x00708e2d) */
/* WARNING: Removing unreachable block (ram,0x00708e30) */

void FUN_00708d80(undefined4 param_1)

{
  uint *puVar1;
  int iVar2;
  int iVar3;
  byte bVar4;
  byte bVar5;
  int *in_ECX;
  uint uVar6;
  int iVar7;
  byte *pbVar8;
  uint local_14;
  int local_10;
  
  FUN_00707fd0(param_1);
  uVar6 = 0;
  *(undefined2 *)(in_ECX + 0xc) = 0;
  iVar3 = 0;
  do {
    pbVar8 = (byte *)(iVar3 + in_ECX[3]);
    bVar4 = (byte)uVar6;
    uVar6 = uVar6 + 8;
    iVar3 = iVar3 + 1;
    *(ushort *)(in_ECX + 0xc) = *(ushort *)(in_ECX + 0xc) | (ushort)*pbVar8 << (bVar4 & 0x1f);
  } while (uVar6 < 0x10);
  iVar3 = 0;
  *(undefined2 *)((int)in_ECX + 0x32) = 0;
  uVar6 = 0;
  do {
    iVar2 = iVar3 + 2;
    bVar4 = (byte)uVar6;
    uVar6 = uVar6 + 8;
    iVar3 = iVar3 + 1;
    *(ushort *)((int)in_ECX + 0x32) =
         *(ushort *)((int)in_ECX + 0x32) | (ushort)*(byte *)(iVar2 + in_ECX[3]) << (bVar4 & 0x1f);
  } while (uVar6 < 0x10);
  iVar3 = 0;
  *(undefined2 *)(in_ECX + 0x11) = 0;
  uVar6 = 0;
  do {
    iVar2 = iVar3 + in_ECX[6] + -2;
    bVar4 = (byte)uVar6;
    uVar6 = uVar6 + 8;
    iVar3 = iVar3 + 1;
    *(ushort *)(in_ECX + 0x11) =
         *(ushort *)(in_ECX + 0x11) | (ushort)*(byte *)(iVar2 + in_ECX[3]) << (bVar4 & 0x1f);
  } while (uVar6 < 0x10);
  iVar3 = (int)(short)in_ECX[0x11] - (int)*(short *)((int)in_ECX + 0x32);
  if (in_ECX[0xe] != in_ECX[0xf]) {
    in_ECX[0xf] = in_ECX[0xe];
  }
  FUN_004d1a10(0,0);
  local_14 = 0;
  if (iVar3 != -1) {
    local_10 = 0;
    do {
      puVar1 = (uint *)(in_ECX[0xe] + local_14 * 8);
      iVar2 = local_10 + 4 + in_ECX[3];
      iVar7 = 0;
      *puVar1 = 0;
      uVar6 = 0;
      do {
        pbVar8 = (byte *)(iVar7 + iVar2);
        bVar4 = (byte)uVar6;
        uVar6 = uVar6 + 8;
        iVar7 = iVar7 + 1;
        *puVar1 = *puVar1 | (uint)*pbVar8 << (bVar4 & 0x1f);
      } while (uVar6 < 0x10);
      uVar6 = 0;
      puVar1[1] = 0;
      pbVar8 = (byte *)(iVar2 + 2);
      do {
        bVar4 = *pbVar8;
        bVar5 = (byte)uVar6;
        uVar6 = uVar6 + 8;
        pbVar8 = pbVar8 + 1;
        puVar1[1] = puVar1[1] | (uint)bVar4 << (bVar5 & 0x1f);
      } while (uVar6 < 0x20);
      local_14 = local_14 + 1;
      local_10 = local_10 + 6;
    } while (local_14 < iVar3 + 1U);
  }
  (**(code **)(*in_ECX + 0x10))();
  return;
}



============================================================
DISASSEMBLY
============================================================
00708d80 : PUSH EBP
00708d81 : MOV EBP,ESP
00708d83 : AND ESP,0xfffffff8
00708d86 : MOV EAX,dword ptr [EBP + 0x8]
00708d89 : SUB ESP,0xc
00708d8c : PUSH EBX
00708d8d : PUSH ESI
00708d8e : PUSH EDI
00708d8f : PUSH EAX
00708d90 : MOV ESI,ECX
00708d92 : CALL 0x00707fd0
00708d97 : XOR ECX,ECX
00708d99 : MOV word ptr [ESI + 0x30],CX
00708d9d : XOR EAX,EAX
00708d9f : NOP
00708da0 : MOV EDX,dword ptr [ESI + 0xc]
00708da3 : MOVZX DX,byte ptr [EAX + EDX*0x1]
00708da8 : SHL DX,CL
00708dab : ADD ECX,0x8
00708dae : INC EAX
00708daf : OR word ptr [ESI + 0x30],DX
00708db3 : CMP ECX,0x10
00708db6 : JC 0x00708da0
00708db8 : XOR EAX,EAX
00708dba : MOV word ptr [ESI + 0x32],AX
00708dbe : XOR ECX,ECX
00708dc0 : MOV EDX,dword ptr [ESI + 0xc]
00708dc3 : MOVZX DX,byte ptr [EAX + EDX*0x1 + 0x2]
00708dc9 : SHL DX,CL
00708dcc : ADD ECX,0x8
00708dcf : INC EAX
00708dd0 : OR word ptr [ESI + 0x32],DX
00708dd4 : CMP ECX,0x10
00708dd7 : JC 0x00708dc0
00708dd9 : MOV EDX,dword ptr [ESI + 0x18]
00708ddc : XOR EAX,EAX
00708dde : SUB EDX,0x2
00708de1 : MOV word ptr [ESI + 0x44],AX
00708de5 : XOR ECX,ECX
00708de7 : JMP 0x00708df0
00708df0 : MOV EBX,dword ptr [ESI + 0xc]
00708df3 : LEA EDI,[EAX + EDX*0x1]
00708df6 : MOVZX DI,byte ptr [EDI + EBX*0x1]
00708dfb : SHL DI,CL
00708dfe : ADD ECX,0x8
00708e01 : INC EAX
00708e02 : OR word ptr [ESI + 0x44],DI
00708e06 : CMP ECX,0x10
00708e09 : JC 0x00708df0
00708e0b : MOVSX ECX,word ptr [ESI + 0x32]
00708e0f : MOVSX EBX,word ptr [ESI + 0x44]
00708e13 : MOV EDI,dword ptr [ESI + 0x38]
00708e16 : MOV EDX,dword ptr [ESI + 0x3c]
00708e19 : LEA EAX,[ESI + 0x34]
00708e1c : SUB EBX,ECX
00708e1e : INC EBX
00708e1f : MOV dword ptr [ESP + 0x14],EBX
00708e23 : CMP EDI,EDX
00708e25 : JZ 0x00708e4a
00708e27 : MOV ECX,EDX
00708e29 : CMP EDX,EDX
00708e2b : JZ 0x00708e44
00708e2d : LEA ECX,[ECX]
00708e30 : MOV EAX,dword ptr [ECX]
00708e32 : MOV dword ptr [EDI],EAX
00708e34 : MOV EAX,dword ptr [ECX + 0x4]
00708e37 : MOV dword ptr [EDI + 0x4],EAX
00708e3a : ADD ECX,0x8
00708e3d : ADD EDI,0x8
00708e40 : CMP ECX,EDX
00708e42 : JNZ 0x00708e30
00708e44 : LEA EAX,[ESI + 0x34]
00708e47 : MOV dword ptr [EAX + 0x8],EDI
00708e4a : XOR EDX,EDX
00708e4c : XOR ECX,ECX
00708e4e : PUSH EDX
00708e4f : PUSH ECX
00708e50 : MOV ECX,EBX
00708e52 : CALL 0x004d1a10
00708e57 : XOR EAX,EAX
00708e59 : MOV dword ptr [ESP + 0xc],EAX
00708e5d : TEST EBX,EBX
00708e5f : JBE 0x00708ecb
00708e61 : XOR EDI,EDI
00708e63 : MOV dword ptr [ESP + 0x10],EDI
00708e67 : MOV EDX,dword ptr [ESI + 0x38]
00708e6a : MOV ECX,dword ptr [ESI + 0xc]
00708e6d : LEA EAX,[EDX + EAX*0x8]
00708e70 : LEA EDI,[EDI + ECX*0x1 + 0x4]
00708e74 : XOR EDX,EDX
00708e76 : MOV dword ptr [EAX],0x0
00708e7c : XOR ECX,ECX
00708e7e : MOV EDI,EDI
00708e80 : MOVZX EBX,byte ptr [EDX + EDI*0x1]
00708e84 : SHL EBX,CL
00708e86 : ADD ECX,0x8
00708e89 : INC EDX
00708e8a : OR dword ptr [EAX],EBX
00708e8c : CMP ECX,0x10
00708e8f : JC 0x00708e80
00708e91 : XOR ECX,ECX
00708e93 : MOV dword ptr [EAX + 0x4],ECX
00708e96 : LEA EDX,[EDI + 0x2]
00708e99 : LEA ESP,[ESP]
00708ea0 : MOVZX EDI,byte ptr [EDX]
00708ea3 : SHL EDI,CL
00708ea5 : ADD ECX,0x8
00708ea8 : INC EDX
00708ea9 : OR dword ptr [EAX + 0x4],EDI
00708eac : CMP ECX,0x20
00708eaf : JC 0x00708ea0
00708eb1 : MOV EAX,dword ptr [ESP + 0xc]
00708eb5 : MOV EDI,dword ptr [ESP + 0x10]
00708eb9 : INC EAX
00708eba : ADD EDI,0x6
00708ebd : MOV dword ptr [ESP + 0xc],EAX
00708ec1 : MOV dword ptr [ESP + 0x10],EDI
00708ec5 : CMP EAX,dword ptr [ESP + 0x14]
00708ec9 : JC 0x00708e67
00708ecb : MOV EAX,dword ptr [ESI]
00708ecd : MOV EDX,dword ptr [EAX + 0x10]
00708ed0 : MOV ECX,ESI
00708ed2 : CALL EDX
00708ed4 : POP EDI
00708ed5 : POP ESI
00708ed6 : POP EBX
00708ed7 : MOV ESP,EBP
00708ed9 : POP EBP
00708eda : RET 0x4

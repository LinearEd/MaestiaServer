PROGRAM  : Maestia.exe
FUNCTION : FUN_00831580
ENTRY    : 00831580
BODY     : [[00831580, 008318d3]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00831580(int param_1,int param_2)

{
  int *piVar1;
  int *piVar2;
  uint uVar3;
  undefined4 uVar4;
  int iVar5;
  wchar_t *****pppppwVar6;
  wchar_t *_Str1;
  int iVar7;
  short *psVar8;
  int unaff_ESI;
  undefined1 local_80 [4];
  undefined2 local_7c;
  undefined4 local_6c;
  uint local_68;
  int local_58;
  undefined1 local_4c [4];
  undefined2 local_48;
  int local_38;
  uint local_34;
  undefined1 local_30 [4];
  wchar_t ****local_2c [4];
  size_t local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = -1;
  puStack_c = &LAB_00b1670e;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_14 = uVar3;
  if (*(int *)(param_2 + 0x14) != 0) {
    local_58 = 0;
    local_18 = 7;
    local_1c = 0;
    local_2c[0] = (wchar_t ****)((uint)local_2c[0] & 0xffff0000);
    local_8 = 1;
    if (*(uint *)(param_2 + 0x18) < 8) {
      psVar8 = (short *)(param_2 + 4);
    }
    else {
      psVar8 = *(short **)(param_2 + 4);
    }
    if (*psVar8 == 0x24) {
      uVar4 = FUN_0040e420(param_2,local_80);
      local_8._0_1_ = 2;
      FUN_00405eb0(uVar4,0,0xffffffff);
      local_8 = CONCAT31(local_8._1_3_,1);
      if (7 < local_68) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0(uVar3);
      }
      local_68 = 7;
      local_6c = 0;
      local_7c = 0;
    }
    else {
      FUN_00405eb0(param_2,0,0xffffffff);
    }
    FUN_0070c170();
    pppppwVar6 = (wchar_t *****)local_2c[0];
    if (local_18 < 8) {
      pppppwVar6 = local_2c;
    }
    iVar5 = FUN_00405bb0(pppppwVar6);
    if (iVar5 == 0) {
      FUN_00405eb0(param_1 + 0x34,0,0xffffffff);
    }
    else {
      pppppwVar6 = (wchar_t *****)local_2c[0];
      if (local_18 < 8) {
        pppppwVar6 = local_2c;
      }
      iVar5 = FUN_00405bb0(pppppwVar6);
      if (iVar5 != 0) {
        *(undefined4 *)(param_1 + 0x30) = 0;
      }
    }
    FUN_00405eb0(local_30,0,0xffffffff);
    local_34 = 7;
    local_38 = 0;
    local_48 = 0;
    local_8._0_1_ = 3;
    piVar1 = *(int **)(param_1 + 4);
    piVar2 = (int *)*piVar1;
    iVar5 = local_58;
    while (piVar2 != piVar1) {
      pppppwVar6 = (wchar_t *****)local_2c[0];
      if (local_18 < 8) {
        pppppwVar6 = local_2c;
      }
      if ((uint)piVar2[9] < 8) {
        _Str1 = (wchar_t *)(piVar2 + 4);
      }
      else {
        _Str1 = (wchar_t *)piVar2[4];
      }
      iVar7 = _wcsncmp(_Str1,(wchar_t *)pppppwVar6,local_1c);
      local_58 = iVar5;
      if (iVar7 == 0) {
        if (local_38 == 0) {
          FUN_00405eb0(piVar2 + 3,0,0xffffffff);
        }
        local_58 = iVar5 + 1;
        if (iVar5 == *(int *)(param_1 + 0x30)) {
          *(int *)(param_1 + 0x30) = *(int *)(param_1 + 0x30) + 1;
          FUN_00405eb0(piVar2 + 3,0,0xffffffff);
          *(undefined4 *)(unaff_ESI + 0x18) = 7;
          *(undefined4 *)(unaff_ESI + 0x14) = 0;
          *(undefined2 *)(unaff_ESI + 4) = 0;
          FUN_00405eb0(piVar2 + 3,0,0xffffffff);
          local_8 = CONCAT31(local_8._1_3_,1);
          if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          local_34 = 7;
          local_38 = 0;
          local_48 = 0;
          local_8 = (uint)local_8._1_3_ << 8;
          if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          local_18 = 7;
          local_1c = 0;
          local_2c[0] = (wchar_t ****)((uint)local_2c[0] & 0xffff0000);
          goto LAB_008318b5;
        }
      }
      FUN_0044c190();
      iVar5 = local_58;
      piVar1 = *(int **)(param_1 + 4);
    }
    if (local_38 != 0) {
      *(undefined4 *)(param_1 + 0x30) = 0;
      FUN_00405eb0(local_4c,0,0xffffffff);
      *(undefined4 *)(unaff_ESI + 0x18) = 7;
      *(undefined4 *)(unaff_ESI + 0x14) = 0;
      *(undefined2 *)(unaff_ESI + 4) = 0;
      FUN_00405eb0(local_4c,0,0xffffffff);
      local_8 = CONCAT31(local_8._1_3_,1);
      if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_34 = 7;
      local_38 = 0;
      local_48 = 0;
      local_8 = (uint)local_8._1_3_ << 8;
      if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_18 = 7;
      local_1c = 0;
      local_2c[0] = (wchar_t ****)((uint)local_2c[0] & 0xffff0000);
      goto LAB_008318b5;
    }
    local_8 = CONCAT31(local_8._1_3_,1);
    if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_34 = 7;
    local_38 = 0;
    local_48 = 0;
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_1c = 0;
    local_2c[0] = (wchar_t ****)((uint)local_2c[0] & 0xffff0000);
    local_18 = 7;
  }
  *(undefined4 *)(unaff_ESI + 0x18) = 7;
  *(undefined4 *)(unaff_ESI + 0x14) = 0;
  *(undefined2 *)(unaff_ESI + 4) = 0;
  FUN_00405eb0(param_2,0,0xffffffff);
  local_8 = 0;
LAB_008318b5:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00831580 : PUSH EBP
00831581 : MOV EBP,ESP
00831583 : PUSH -0x1
00831585 : PUSH 0xb1670e
0083158a : MOV EAX,FS:[0x0]
00831590 : PUSH EAX
00831591 : SUB ESP,0x70
00831594 : MOV EAX,[0x00d66fa0]
00831599 : XOR EAX,EBP
0083159b : MOV dword ptr [EBP + -0x10],EAX
0083159e : PUSH EBX
0083159f : PUSH EDI
008315a0 : PUSH EAX
008315a1 : LEA EAX,[EBP + -0xc]
008315a4 : MOV FS:[0x0],EAX
008315aa : MOV EAX,dword ptr [EBP + 0xc]
008315ad : MOV EBX,dword ptr [EBP + 0x8]
008315b0 : XOR EDI,EDI
008315b2 : MOV dword ptr [EBP + -0x50],EDI
008315b5 : MOV dword ptr [EBP + -0x60],ESI
008315b8 : MOV dword ptr [EBP + -0x5c],EAX
008315bb : CMP dword ptr [EAX + 0x14],EDI
008315be : JZ 0x00831890
008315c4 : XOR ECX,ECX
008315c6 : MOV dword ptr [EBP + -0x54],EDI
008315c9 : MOV dword ptr [EBP + -0x14],0x7
008315d0 : MOV dword ptr [EBP + -0x18],EDI
008315d3 : MOV word ptr [EBP + -0x28],CX
008315d7 : MOV EDX,0x1
008315dc : MOV dword ptr [EBP + -0x4],EDX
008315df : CMP dword ptr [EAX + 0x18],0x8
008315e3 : JC 0x008315ea
008315e5 : MOV ECX,dword ptr [EAX + 0x4]
008315e8 : JMP 0x008315ed
008315ea : LEA ECX,[EAX + 0x4]
008315ed : CMP word ptr [ECX],0x24
008315f1 : JNZ 0x00831634
008315f3 : LEA ECX,[EBP + -0x7c]
008315f6 : PUSH ECX
008315f7 : PUSH EAX
008315f8 : OR ECX,0xffffffff
008315fb : CALL 0x0040e420
00831600 : MOV byte ptr [EBP + -0x4],0x2
00831604 : PUSH -0x1
00831606 : PUSH EDI
00831607 : PUSH EAX
00831608 : LEA ECX,[EBP + -0x2c]
0083160b : CALL 0x00405eb0
00831610 : MOV byte ptr [EBP + -0x4],0x1
00831614 : CMP dword ptr [EBP + -0x64],0x8
00831618 : JC 0x00831622
0083161a : MOV ECX,dword ptr [EBP + -0x78]
0083161d : CALL 0x006f04e0
00831622 : XOR EDX,EDX
00831624 : MOV dword ptr [EBP + -0x64],0x7
0083162b : MOV dword ptr [EBP + -0x68],EDI
0083162e : MOV word ptr [EBP + -0x78],DX
00831632 : JMP 0x00831640
00831634 : PUSH -0x1
00831636 : PUSH EDI
00831637 : PUSH EAX
00831638 : LEA ECX,[EBP + -0x2c]
0083163b : CALL 0x00405eb0
00831640 : LEA ECX,[EBP + -0x2c]
00831643 : CALL 0x0070c170
00831648 : CMP dword ptr [EBP + -0x14],0x8
0083164c : MOV EAX,dword ptr [EBP + -0x28]
0083164f : LEA ECX,[EBX + 0x50]
00831652 : MOV dword ptr [EBP + -0x58],ECX
00831655 : JNC 0x0083165a
00831657 : LEA EAX,[EBP + -0x28]
0083165a : MOV EDI,dword ptr [EBP + -0x18]
0083165d : PUSH EAX
0083165e : MOV EAX,dword ptr [ECX + 0x14]
00831661 : CALL 0x00405bb0
00831666 : TEST EAX,EAX
00831668 : JNZ 0x0083167d
0083166a : PUSH -0x1
0083166c : XOR EDI,EDI
0083166e : LEA EAX,[EBX + 0x34]
00831671 : PUSH EDI
00831672 : PUSH EAX
00831673 : LEA ECX,[EBP + -0x2c]
00831676 : CALL 0x00405eb0
0083167b : JMP 0x008316a1
0083167d : CMP dword ptr [EBP + -0x14],0x8
00831681 : MOV EAX,dword ptr [EBP + -0x28]
00831684 : LEA ECX,[EBX + 0x34]
00831687 : JNC 0x0083168c
00831689 : LEA EAX,[EBP + -0x28]
0083168c : MOV EDI,dword ptr [EBP + -0x18]
0083168f : PUSH EAX
00831690 : MOV EAX,dword ptr [ECX + 0x14]
00831693 : CALL 0x00405bb0
00831698 : XOR EDI,EDI
0083169a : TEST EAX,EAX
0083169c : JZ 0x008316a1
0083169e : MOV dword ptr [EBX + 0x30],EDI
008316a1 : PUSH -0x1
008316a3 : PUSH EDI
008316a4 : LEA EAX,[EBP + -0x2c]
008316a7 : PUSH EAX
008316a8 : LEA ECX,[EBX + 0x34]
008316ab : CALL 0x00405eb0
008316b0 : XOR ECX,ECX
008316b2 : MOV dword ptr [EBP + -0x30],0x7
008316b9 : MOV dword ptr [EBP + -0x34],EDI
008316bc : MOV word ptr [EBP + -0x44],CX
008316c0 : MOV byte ptr [EBP + -0x4],0x3
008316c4 : MOV EAX,dword ptr [EBX + 0x4]
008316c7 : MOV ECX,dword ptr [EAX]
008316c9 : MOV dword ptr [EBP + -0x4c],ECX
008316cc : CMP ECX,EAX
008316ce : JNZ 0x00831758
008316d4 : CMP dword ptr [EBP + -0x34],EDI
008316d7 : JZ 0x00831845
008316dd : MOV ECX,dword ptr [EBP + -0x58]
008316e0 : PUSH -0x1
008316e2 : PUSH EDI
008316e3 : LEA EAX,[EBP + -0x48]
008316e6 : PUSH EAX
008316e7 : MOV dword ptr [EBX + 0x30],EDI
008316ea : CALL 0x00405eb0
008316ef : PUSH -0x1
008316f1 : XOR ECX,ECX
008316f3 : MOV EBX,0x7
008316f8 : MOV dword ptr [ESI + 0x18],EBX
008316fb : MOV dword ptr [ESI + 0x14],EDI
008316fe : PUSH EDI
008316ff : LEA EDX,[EBP + -0x48]
00831702 : MOV word ptr [ESI + 0x4],CX
00831706 : PUSH EDX
00831707 : MOV ECX,ESI
00831709 : CALL 0x00405eb0
0083170e : MOV dword ptr [EBP + -0x50],0x1
00831715 : MOV byte ptr [EBP + -0x4],0x1
00831719 : CMP dword ptr [EBP + -0x30],0x8
0083171d : JC 0x00831727
0083171f : MOV ECX,dword ptr [EBP + -0x44]
00831722 : CALL 0x006f04e0
00831727 : XOR EAX,EAX
00831729 : MOV dword ptr [EBP + -0x30],EBX
0083172c : MOV dword ptr [EBP + -0x34],EDI
0083172f : MOV word ptr [EBP + -0x44],AX
00831733 : MOV byte ptr [EBP + -0x4],AL
00831736 : CMP dword ptr [EBP + -0x14],0x8
0083173a : JC 0x00831744
0083173c : MOV ECX,dword ptr [EBP + -0x28]
0083173f : CALL 0x006f04e0
00831744 : XOR ECX,ECX
00831746 : MOV dword ptr [EBP + -0x14],EBX
00831749 : MOV dword ptr [EBP + -0x18],EDI
0083174c : MOV word ptr [EBP + -0x28],CX
00831750 : JMP 0x008318b5
00831755 : MOV ECX,dword ptr [EBP + -0x4c]
00831758 : MOV EDX,dword ptr [EBP + -0x28]
0083175b : MOV EAX,0x8
00831760 : CMP dword ptr [EBP + -0x14],EAX
00831763 : JNC 0x00831768
00831765 : LEA EDX,[EBP + -0x28]
00831768 : CMP dword ptr [ECX + 0x24],EAX
0083176b : LEA EDI,[ECX + 0xc]
0083176e : JC 0x00831775
00831770 : MOV EAX,dword ptr [EDI + 0x4]
00831773 : JMP 0x00831778
00831775 : LEA EAX,[EDI + 0x4]
00831778 : MOV ECX,dword ptr [EBP + -0x18]
0083177b : PUSH ECX
0083177c : PUSH EDX
0083177d : PUSH EAX
0083177e : CALL 0x006380ac
00831783 : ADD ESP,0xc
00831786 : TEST EAX,EAX
00831788 : JNZ 0x008317a9
0083178a : CMP dword ptr [EBP + -0x34],EAX
0083178d : JNZ 0x0083179b
0083178f : PUSH -0x1
00831791 : PUSH EAX
00831792 : PUSH EDI
00831793 : LEA ECX,[EBP + -0x48]
00831796 : CALL 0x00405eb0
0083179b : MOV EAX,dword ptr [EBP + -0x54]
0083179e : MOV EDX,EAX
008317a0 : INC EAX
008317a1 : MOV dword ptr [EBP + -0x54],EAX
008317a4 : CMP EDX,dword ptr [EBX + 0x30]
008317a7 : JZ 0x008317c0
008317a9 : LEA EDX,[EBP + -0x4c]
008317ac : CALL 0x0044c190
008317b1 : MOV EAX,dword ptr [EBX + 0x4]
008317b4 : CMP dword ptr [EBP + -0x4c],EAX
008317b7 : JNZ 0x00831755
008317b9 : XOR EDI,EDI
008317bb : JMP 0x008316d4
008317c0 : INC dword ptr [EBX + 0x30]
008317c3 : MOV EBX,dword ptr [EBP + -0x4c]
008317c6 : MOV ECX,dword ptr [EBP + -0x58]
008317c9 : PUSH -0x1
008317cb : PUSH 0x0
008317cd : ADD EBX,0xc
008317d0 : PUSH EBX
008317d1 : CALL 0x00405eb0
008317d6 : XOR EAX,EAX
008317d8 : PUSH -0x1
008317da : PUSH EAX
008317db : MOV EDI,0x7
008317e0 : MOV dword ptr [ESI + 0x18],EDI
008317e3 : MOV dword ptr [ESI + 0x14],0x0
008317ea : PUSH EBX
008317eb : MOV ECX,ESI
008317ed : MOV word ptr [ESI + 0x4],AX
008317f1 : CALL 0x00405eb0
008317f6 : MOV dword ptr [EBP + -0x50],0x1
008317fd : MOV byte ptr [EBP + -0x4],0x1
00831801 : MOV EBX,0x8
00831806 : CMP dword ptr [EBP + -0x30],EBX
00831809 : JC 0x00831813
0083180b : MOV ECX,dword ptr [EBP + -0x44]
0083180e : CALL 0x006f04e0
00831813 : XOR ECX,ECX
00831815 : MOV dword ptr [EBP + -0x30],EDI
00831818 : MOV dword ptr [EBP + -0x34],0x0
0083181f : MOV word ptr [EBP + -0x44],CX
00831823 : MOV byte ptr [EBP + -0x4],CL
00831826 : CMP dword ptr [EBP + -0x14],EBX
00831829 : JC 0x00831833
0083182b : MOV ECX,dword ptr [EBP + -0x28]
0083182e : CALL 0x006f04e0
00831833 : XOR EDX,EDX
00831835 : MOV dword ptr [EBP + -0x14],EDI
00831838 : MOV dword ptr [EBP + -0x18],0x0
0083183f : MOV word ptr [EBP + -0x28],DX
00831843 : JMP 0x008318b5
00831845 : MOV byte ptr [EBP + -0x4],0x1
00831849 : MOV EBX,0x8
0083184e : CMP dword ptr [EBP + -0x30],EBX
00831851 : JC 0x0083185b
00831853 : MOV ECX,dword ptr [EBP + -0x44]
00831856 : CALL 0x006f04e0
0083185b : XOR EDX,EDX
0083185d : MOV dword ptr [EBP + -0x30],0x7
00831864 : MOV dword ptr [EBP + -0x34],EDI
00831867 : MOV word ptr [EBP + -0x44],DX
0083186b : MOV byte ptr [EBP + -0x4],DL
0083186e : CMP dword ptr [EBP + -0x14],EBX
00831871 : JC 0x0083187b
00831873 : MOV ECX,dword ptr [EBP + -0x28]
00831876 : CALL 0x006f04e0
0083187b : XOR EAX,EAX
0083187d : MOV dword ptr [EBP + -0x18],EDI
00831880 : MOV word ptr [EBP + -0x28],AX
00831884 : MOV EAX,dword ptr [EBP + -0x5c]
00831887 : MOV dword ptr [EBP + -0x14],0x7
0083188e : XOR EDI,EDI
00831890 : PUSH -0x1
00831892 : XOR ECX,ECX
00831894 : MOV dword ptr [ESI + 0x18],0x7
0083189b : MOV dword ptr [ESI + 0x14],EDI
0083189e : PUSH EDI
0083189f : MOV word ptr [ESI + 0x4],CX
008318a3 : PUSH EAX
008318a4 : MOV ECX,ESI
008318a6 : CALL 0x00405eb0
008318ab : MOV dword ptr [EBP + -0x4],EDI
008318ae : MOV dword ptr [EBP + -0x50],0x1
008318b5 : MOV EAX,ESI
008318b7 : MOV ECX,dword ptr [EBP + -0xc]
008318ba : MOV dword ptr FS:[0x0],ECX
008318c1 : POP ECX
008318c2 : POP EDI
008318c3 : POP EBX
008318c4 : MOV ECX,dword ptr [EBP + -0x10]
008318c7 : XOR ECX,EBP
008318c9 : CALL 0x00633e6b
008318ce : MOV ESP,EBP
008318d0 : POP EBP
008318d1 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_004fe140
ENTRY    : 004fe140
BODY     : [[004fe140, 004fe204]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

uint * FUN_004fe140(void)

{
  uint *puVar1;
  uint *puVar2;
  uint uVar3;
  size_t _Size;
  uint unaff_EDI;
  void *local_c;
  undefined1 *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00b71957;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  _Size = unaff_EDI * 0x20 + 4;
  if (DAT_00da98c8 == (int *)0x0) {
    puVar1 = _malloc(_Size);
  }
  else {
    puVar1 = (uint *)(**(code **)(*DAT_00da98c8 + 4))(_Size,DAT_00d66fa0 ^ (uint)&stack0xffffffe0);
  }
  if (puVar1 == (uint *)0x0) {
    ExceptionList = local_c;
    return (uint *)0x0;
  }
  uVar3 = 0;
  *puVar1 = unaff_EDI;
  if (unaff_EDI != 0) {
    do {
      puVar2 = puVar1 + 1 + uVar3 * 8;
      if (puVar2 != (uint *)0x0) {
        *(undefined1 *)(puVar2 + 7) = 0xff;
        *(undefined1 *)((int)puVar2 + 0x1d) = 0xff;
        *(undefined1 *)((int)puVar2 + 0x1e) = 0xff;
        *(undefined1 *)((int)puVar2 + 0x1f) = 0xff;
      }
      uVar3 = uVar3 + 1;
    } while (uVar3 < unaff_EDI);
  }
  _DAT_00da98cc = _DAT_00da98cc + _Size;
  _DAT_00da98d0 = _DAT_00da98d0 + 1;
  ExceptionList = local_c;
  return puVar1 + 1;
}



============================================================
DISASSEMBLY
============================================================
004fe140 : PUSH -0x1
004fe142 : PUSH 0xb71957
004fe147 : MOV EAX,FS:[0x0]
004fe14d : PUSH EAX
004fe14e : SUB ESP,0xc
004fe151 : PUSH EBX
004fe152 : PUSH ESI
004fe153 : MOV EAX,[0x00d66fa0]
004fe158 : XOR EAX,ESP
004fe15a : PUSH EAX
004fe15b : LEA EAX,[ESP + 0x18]
004fe15f : MOV FS:[0x0],EAX
004fe165 : MOV ECX,dword ptr [0x00da98c8]
004fe16b : MOV EBX,EDI
004fe16d : SHL EBX,0x5
004fe170 : ADD EBX,0x4
004fe173 : PUSH EBX
004fe174 : TEST ECX,ECX
004fe176 : JZ 0x004fe181
004fe178 : MOV EAX,dword ptr [ECX]
004fe17a : MOV EDX,dword ptr [EAX + 0x4]
004fe17d : CALL EDX
004fe17f : JMP 0x004fe189
004fe181 : CALL 0x00636043
004fe186 : ADD ESP,0x4
004fe189 : TEST EAX,EAX
004fe18b : JZ 0x004fe1f1
004fe18d : XOR EDX,EDX
004fe18f : LEA ESI,[EAX + 0x4]
004fe192 : MOV dword ptr [EAX],EDI
004fe194 : MOV dword ptr [ESP + 0x10],ESI
004fe198 : MOV dword ptr [ESP + 0xc],EDX
004fe19c : TEST EDI,EDI
004fe19e : JBE 0x004fe1d1
004fe1a0 : OR EAX,0xffffffff
004fe1a3 : MOV ECX,EDX
004fe1a5 : SHL ECX,0x5
004fe1a8 : ADD ECX,ESI
004fe1aa : MOV dword ptr [ESP + 0x14],ECX
004fe1ae : MOV dword ptr [ESP + 0x20],0x0
004fe1b6 : JZ 0x004fe1c4
004fe1b8 : MOV byte ptr [ECX + 0x1c],AL
004fe1bb : MOV byte ptr [ECX + 0x1d],AL
004fe1be : MOV byte ptr [ECX + 0x1e],AL
004fe1c1 : MOV byte ptr [ECX + 0x1f],AL
004fe1c4 : MOV dword ptr [ESP + 0x20],EAX
004fe1c8 : INC EDX
004fe1c9 : MOV dword ptr [ESP + 0xc],EDX
004fe1cd : CMP EDX,EDI
004fe1cf : JC 0x004fe1a3
004fe1d1 : ADD dword ptr [0x00da98cc],EBX
004fe1d7 : INC dword ptr [0x00da98d0]
004fe1dd : MOV EAX,ESI
004fe1df : MOV ECX,dword ptr [ESP + 0x18]
004fe1e3 : MOV dword ptr FS:[0x0],ECX
004fe1ea : POP ECX
004fe1eb : POP ESI
004fe1ec : POP EBX
004fe1ed : ADD ESP,0x18
004fe1f0 : RET
004fe1f1 : XOR EAX,EAX
004fe1f3 : MOV ECX,dword ptr [ESP + 0x18]
004fe1f7 : MOV dword ptr FS:[0x0],ECX
004fe1fe : POP ECX
004fe1ff : POP ESI
004fe200 : POP EBX
004fe201 : ADD ESP,0x18
004fe204 : RET

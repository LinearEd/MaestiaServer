PROGRAM  : Maestia.exe
FUNCTION : FUN_004ce4a0
ENTRY    : 004ce4a0
BODY     : [[004ce4a0, 004ce4e9] [004ce4f0, 004ce706]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_004ce4a0(int param_1)

{
  undefined4 uVar1;
  int in_EAX;
  int *piVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  int iVar6;
  uint _Size;
  undefined4 local_8;
  
  iVar6 = *(int *)(in_EAX + 0x448);
  if ((iVar6 == -3) || (iVar6 == -1)) {
    return -1;
  }
  if (iVar6 == 1) {
    return 0;
  }
  local_8 = param_1;
  *(int *)(in_EAX + 0x41c) = param_1;
  *(undefined4 *)(in_EAX + 0x420) = 0x1000;
  iVar6 = param_1;
  do {
    if (*(int *)(in_EAX + 0x458) != 0) {
      _Size = *(uint *)(in_EAX + 0x414);
      if (*(uint *)(in_EAX + 0x420) < *(uint *)(in_EAX + 0x414)) {
        _Size = *(uint *)(in_EAX + 0x420);
      }
      if (_Size != 0) {
        _memcpy(*(void **)(in_EAX + 0x41c),*(void **)(in_EAX + 0x410),_Size);
        *(int *)(in_EAX + 0x410) = *(int *)(in_EAX + 0x410) + _Size;
        *(int *)(in_EAX + 0x420) = *(int *)(in_EAX + 0x420) - _Size;
        local_8 = param_1 + _Size;
        *(int *)(in_EAX + 0x414) = *(int *)(in_EAX + 0x414) - _Size;
        *(int *)(in_EAX + 0x41c) = local_8;
      }
      if (*(int *)(in_EAX + 0x420) != 0) {
        iVar6 = FUN_004ce870(local_8);
        *(int *)(in_EAX + 0x420) = *(int *)(in_EAX + 0x420) - iVar6;
      }
      iVar6 = 0x1000 - *(int *)(in_EAX + 0x420);
      *(int *)(in_EAX + 0x418) = *(int *)(in_EAX + 0x418) + iVar6;
      *(int *)(in_EAX + 0x424) = *(int *)(in_EAX + 0x424) + iVar6;
      if (iVar6 == 0) {
        *(undefined4 *)(in_EAX + 0x454) = 1;
      }
      return iVar6;
    }
    if ((*(int *)(in_EAX + 0x414) == 0) && (*(int *)(in_EAX + 0x454) == 0)) {
      piVar2 = __errno();
      *piVar2 = 0;
      iVar3 = FUN_004ce870(*(undefined4 *)(in_EAX + 0x44c));
      *(int *)(in_EAX + 0x414) = iVar3;
      if (iVar3 == 0) {
        *(undefined4 *)(in_EAX + 0x454) = 1;
      }
      *(undefined4 *)(in_EAX + 0x410) = *(undefined4 *)(in_EAX + 0x44c);
    }
    iVar4 = FUN_00710080(in_EAX + 0x410,0);
    *(int *)(in_EAX + 0x448) = iVar4;
    iVar3 = iVar6;
    if (iVar4 == 1) {
      iVar3 = *(int *)(in_EAX + 0x41c);
      if (iVar6 == 0) {
        uVar5 = 0;
      }
      else {
        uVar5 = FUN_00712d10(iVar3 - iVar6);
      }
      *(undefined4 *)(in_EAX + 0x450) = uVar5;
      iVar6 = FUN_004ce8c0();
      if (iVar6 != *(int *)(in_EAX + 0x450)) {
        *(undefined4 *)(in_EAX + 0x448) = 0xfffffffd;
LAB_004ce619:
        if (iVar3 == 0) {
          uVar5 = 0;
        }
        else {
          uVar5 = FUN_00712d10(*(int *)(in_EAX + 0x41c) - iVar3);
        }
        *(undefined4 *)(in_EAX + 0x450) = uVar5;
        return 0x1000 - *(int *)(in_EAX + 0x420);
      }
      FUN_004ce8c0();
      FUN_004ce370();
      if (*(int *)(in_EAX + 0x448) != 0) goto LAB_004ce619;
      uVar5 = *(undefined4 *)(in_EAX + 0x424);
      uVar1 = *(undefined4 *)(in_EAX + 0x418);
      FUN_00710030(in_EAX + 0x410);
      *(undefined4 *)(in_EAX + 0x418) = uVar1;
      *(undefined4 *)(in_EAX + 0x424) = uVar5;
      uVar5 = FUN_00712ff0(0,0,0);
      *(undefined4 *)(in_EAX + 0x450) = uVar5;
    }
    if (((*(int *)(in_EAX + 0x448) != 0) || (*(int *)(in_EAX + 0x454) != 0)) ||
       (iVar6 = iVar3, *(int *)(in_EAX + 0x420) == 0)) goto LAB_004ce619;
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
004ce4a0 : PUSH EBP
004ce4a1 : MOV EBP,ESP
004ce4a3 : SUB ESP,0x8
004ce4a6 : PUSH EBX
004ce4a7 : MOV EBX,dword ptr [EBP + 0x8]
004ce4aa : PUSH ESI
004ce4ab : MOV ESI,EAX
004ce4ad : MOV EAX,dword ptr [ESI + 0x448]
004ce4b3 : CMP EAX,-0x3
004ce4b6 : JZ 0x004ce6fc
004ce4bc : CMP EAX,-0x1
004ce4bf : JZ 0x004ce6fc
004ce4c5 : CMP EAX,0x1
004ce4c8 : JNZ 0x004ce4d4
004ce4ca : POP ESI
004ce4cb : XOR EAX,EAX
004ce4cd : POP EBX
004ce4ce : MOV ESP,EBP
004ce4d0 : POP EBP
004ce4d1 : RET 0x4
004ce4d4 : MOV dword ptr [EBP + -0x4],EBX
004ce4d7 : MOV dword ptr [ESI + 0x41c],EBX
004ce4dd : MOV dword ptr [ESI + 0x420],0x1000
004ce4e7 : PUSH EDI
004ce4e8 : JMP 0x004ce4f0
004ce4f0 : CMP dword ptr [ESI + 0x458],0x0
004ce4f7 : JNZ 0x004ce642
004ce4fd : CMP dword ptr [ESI + 0x414],0x0
004ce504 : JNZ 0x004ce54d
004ce506 : CMP dword ptr [ESI + 0x454],0x0
004ce50d : JNZ 0x004ce54d
004ce50f : CALL 0x0063ab82
004ce514 : MOV dword ptr [EAX],0x0
004ce51a : MOV EAX,dword ptr [ESI + 0x44c]
004ce520 : PUSH EAX
004ce521 : MOV EAX,0x1000
004ce526 : MOV EDI,ESI
004ce528 : CALL 0x004ce870
004ce52d : MOV dword ptr [ESI + 0x414],EAX
004ce533 : TEST EAX,EAX
004ce535 : JNZ 0x004ce541
004ce537 : MOV dword ptr [ESI + 0x454],0x1
004ce541 : MOV ECX,dword ptr [ESI + 0x44c]
004ce547 : MOV dword ptr [ESI + 0x410],ECX
004ce54d : LEA EAX,[ESI + 0x410]
004ce553 : PUSH 0x0
004ce555 : PUSH EAX
004ce556 : CALL 0x00710080
004ce55b : ADD ESP,0x8
004ce55e : MOV dword ptr [ESI + 0x448],EAX
004ce564 : CMP EAX,0x1
004ce567 : JNZ 0x004ce5fa
004ce56d : MOV EDI,dword ptr [ESI + 0x41c]
004ce573 : MOV EAX,dword ptr [ESI + 0x450]
004ce579 : MOV ECX,EDI
004ce57b : SUB ECX,EBX
004ce57d : TEST EBX,EBX
004ce57f : JNZ 0x004ce585
004ce581 : XOR EAX,EAX
004ce583 : JMP 0x004ce590
004ce585 : PUSH ECX
004ce586 : MOV ECX,EBX
004ce588 : CALL 0x00712d10
004ce58d : ADD ESP,0x4
004ce590 : MOV dword ptr [ESI + 0x450],EAX
004ce596 : MOV EBX,EDI
004ce598 : CALL 0x004ce8c0
004ce59d : CMP EAX,dword ptr [ESI + 0x450]
004ce5a3 : JNZ 0x004ce636
004ce5a9 : CALL 0x004ce8c0
004ce5ae : CALL 0x004ce370
004ce5b3 : CMP dword ptr [ESI + 0x448],0x0
004ce5ba : JNZ 0x004ce619
004ce5bc : MOV EDX,dword ptr [ESI + 0x424]
004ce5c2 : MOV EDI,dword ptr [ESI + 0x418]
004ce5c8 : LEA EAX,[ESI + 0x410]
004ce5ce : PUSH EAX
004ce5cf : MOV dword ptr [EBP + -0x8],EDX
004ce5d2 : CALL 0x00710030
004ce5d7 : MOV EAX,dword ptr [EBP + -0x8]
004ce5da : PUSH 0x0
004ce5dc : PUSH 0x0
004ce5de : PUSH 0x0
004ce5e0 : MOV dword ptr [ESI + 0x418],EDI
004ce5e6 : MOV dword ptr [ESI + 0x424],EAX
004ce5ec : CALL 0x00712ff0
004ce5f1 : ADD ESP,0x10
004ce5f4 : MOV dword ptr [ESI + 0x450],EAX
004ce5fa : CMP dword ptr [ESI + 0x448],0x0
004ce601 : JNZ 0x004ce619
004ce603 : CMP dword ptr [ESI + 0x454],0x0
004ce60a : JNZ 0x004ce619
004ce60c : CMP dword ptr [ESI + 0x420],0x0
004ce613 : JNZ 0x004ce4f0
004ce619 : MOV ECX,dword ptr [ESI + 0x41c]
004ce61f : MOV EAX,dword ptr [ESI + 0x450]
004ce625 : SUB ECX,EBX
004ce627 : TEST EBX,EBX
004ce629 : JNZ 0x004ce6d7
004ce62f : XOR EAX,EAX
004ce631 : JMP 0x004ce6e2
004ce636 : MOV dword ptr [ESI + 0x448],0xfffffffd
004ce640 : JMP 0x004ce619
004ce642 : MOV EDI,dword ptr [ESI + 0x414]
004ce648 : MOV EAX,dword ptr [ESI + 0x420]
004ce64e : CMP EDI,EAX
004ce650 : CMOVA EDI,EAX
004ce653 : TEST EDI,EDI
004ce655 : JBE 0x004ce68e
004ce657 : MOV ECX,dword ptr [ESI + 0x410]
004ce65d : MOV EDX,dword ptr [ESI + 0x41c]
004ce663 : PUSH EDI
004ce664 : PUSH ECX
004ce665 : PUSH EDX
004ce666 : CALL 0x0063ae40
004ce66b : MOV EAX,dword ptr [EBP + 0x8]
004ce66e : ADD dword ptr [ESI + 0x410],EDI
004ce674 : SUB dword ptr [ESI + 0x420],EDI
004ce67a : ADD EAX,EDI
004ce67c : ADD ESP,0xc
004ce67f : SUB dword ptr [ESI + 0x414],EDI
004ce685 : MOV dword ptr [EBP + -0x4],EAX
004ce688 : MOV dword ptr [ESI + 0x41c],EAX
004ce68e : MOV EAX,dword ptr [ESI + 0x420]
004ce694 : TEST EAX,EAX
004ce696 : JBE 0x004ce6a9
004ce698 : MOV ECX,dword ptr [EBP + -0x4]
004ce69b : PUSH ECX
004ce69c : MOV EDI,ESI
004ce69e : CALL 0x004ce870
004ce6a3 : SUB dword ptr [ESI + 0x420],EAX
004ce6a9 : MOV EAX,0x1000
004ce6ae : SUB EAX,dword ptr [ESI + 0x420]
004ce6b4 : ADD dword ptr [ESI + 0x418],EAX
004ce6ba : ADD dword ptr [ESI + 0x424],EAX
004ce6c0 : TEST EAX,EAX
004ce6c2 : JNZ 0x004ce6ce
004ce6c4 : MOV dword ptr [ESI + 0x454],0x1
004ce6ce : POP EDI
004ce6cf : POP ESI
004ce6d0 : POP EBX
004ce6d1 : MOV ESP,EBP
004ce6d3 : POP EBP
004ce6d4 : RET 0x4
004ce6d7 : PUSH ECX
004ce6d8 : MOV ECX,EBX
004ce6da : CALL 0x00712d10
004ce6df : ADD ESP,0x4
004ce6e2 : MOV dword ptr [ESI + 0x450],EAX
004ce6e8 : MOV EAX,0x1000
004ce6ed : SUB EAX,dword ptr [ESI + 0x420]
004ce6f3 : POP EDI
004ce6f4 : POP ESI
004ce6f5 : POP EBX
004ce6f6 : MOV ESP,EBP
004ce6f8 : POP EBP
004ce6f9 : RET 0x4
004ce6fc : POP ESI
004ce6fd : OR EAX,0xffffffff
004ce700 : POP EBX
004ce701 : MOV ESP,EBP
004ce703 : POP EBP
004ce704 : RET 0x4

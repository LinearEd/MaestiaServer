PROGRAM  : Maestia.exe
FUNCTION : FUN_0067c040
ENTRY    : 0067c040
BODY     : [[0067c040, 0067c0f9] [0067c100, 0067c133]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0067c040(undefined4 param_1,undefined4 *param_2,uint param_3)

{
  uint *puVar1;
  int *piVar2;
  int iVar3;
  int *in_ECX;
  uint uVar4;
  uint uVar5;
  int iVar6;
  
  piVar2 = (int *)*in_ECX;
  if (piVar2 == (int *)0x0) {
    iVar6 = 8;
  }
  else {
    if ((uint)(*piVar2 * 5) <= piVar2[1] * 4 + 4U) goto LAB_0067c07a;
    iVar6 = piVar2[1] * 2 + 2;
  }
  FUN_0067c4c0(param_1,iVar6);
LAB_0067c07a:
  piVar2 = (int *)*in_ECX;
  param_3 = param_3 & piVar2[1];
  *piVar2 = *piVar2 + 1;
  iVar6 = *in_ECX;
  iVar3 = *(int *)(iVar6 + 8 + param_3 * 8);
  if (iVar3 == -2) {
    *(undefined4 *)(iVar6 + 8 + param_3 * 8) = 0xffffffff;
    *(undefined4 *)(iVar6 + 0xc + param_3 * 8) = *param_2;
    return;
  }
  uVar4 = param_3;
  do {
    uVar4 = uVar4 + 1 & *(uint *)(iVar6 + 4);
  } while (*(int *)(iVar6 + 8 + uVar4 * 8) != -2);
  uVar5 = *(uint *)(*(int *)(iVar6 + 0xc + param_3 * 8) + 0x10) & *(uint *)(iVar6 + 4);
  piVar2 = (int *)(iVar6 + 8 + uVar4 * 8);
  if (uVar5 == param_3) {
    if (piVar2 != (int *)0x0) {
      *piVar2 = iVar3;
      piVar2[1] = *(int *)(iVar6 + 0xc + param_3 * 8);
    }
    *(undefined4 *)(iVar6 + 0xc + param_3 * 8) = *param_2;
    *(uint *)(iVar6 + 8 + param_3 * 8) = uVar4;
    return;
  }
  puVar1 = (uint *)(iVar6 + 8 + uVar5 * 8);
  for (uVar5 = *(uint *)(iVar6 + 8 + uVar5 * 8); uVar5 != param_3;
      uVar5 = *(uint *)(iVar6 + 8 + uVar5 * 8)) {
    uVar5 = *puVar1;
    puVar1 = (uint *)(iVar6 + 8 + uVar5 * 8);
  }
  if (piVar2 != (int *)0x0) {
    *piVar2 = iVar3;
    piVar2[1] = *(int *)(iVar6 + 0xc + param_3 * 8);
  }
  *puVar1 = uVar4;
  *(undefined4 *)(iVar6 + 0xc + param_3 * 8) = *param_2;
  *(undefined4 *)(iVar6 + 8 + param_3 * 8) = 0xffffffff;
  return;
}



============================================================
DISASSEMBLY
============================================================
0067c040 : PUSH EBP
0067c041 : PUSH ESI
0067c042 : MOV ESI,ECX
0067c044 : MOV EAX,dword ptr [ESI]
0067c046 : TEST EAX,EAX
0067c048 : JNZ 0x0067c053
0067c04a : MOV EAX,dword ptr [ESP + 0xc]
0067c04e : PUSH 0x8
0067c050 : PUSH EAX
0067c051 : JMP 0x0067c075
0067c053 : MOV ECX,dword ptr [EAX + 0x4]
0067c056 : LEA EDX,[ECX*0x4 + 0x4]
0067c05d : MOV ECX,dword ptr [EAX]
0067c05f : LEA ECX,[ECX + ECX*0x4]
0067c062 : CMP ECX,EDX
0067c064 : JBE 0x0067c07a
0067c066 : MOV EDX,dword ptr [EAX + 0x4]
0067c069 : MOV ECX,dword ptr [ESP + 0xc]
0067c06d : LEA EAX,[EDX + EDX*0x1 + 0x2]
0067c071 : PUSH EAX
0067c072 : PUSH ECX
0067c073 : MOV ECX,ESI
0067c075 : CALL 0x0067c4c0
0067c07a : MOV EAX,dword ptr [ESI]
0067c07c : MOV ECX,dword ptr [ESP + 0x14]
0067c080 : AND ECX,dword ptr [EAX + 0x4]
0067c083 : INC dword ptr [EAX]
0067c085 : MOV EAX,dword ptr [ESI]
0067c087 : MOV EBP,dword ptr [EAX + ECX*0x8 + 0x8]
0067c08b : MOV ESI,0xfffffffe
0067c090 : CMP EBP,ESI
0067c092 : JNZ 0x0067c0ab
0067c094 : MOV EDX,dword ptr [ESP + 0x10]
0067c098 : MOV dword ptr [EAX + ECX*0x8 + 0x8],0xffffffff
0067c0a0 : MOV EDX,dword ptr [EDX]
0067c0a2 : POP ESI
0067c0a3 : MOV dword ptr [EAX + ECX*0x8 + 0xc],EDX
0067c0a7 : POP EBP
0067c0a8 : RET 0xc
0067c0ab : PUSH EDI
0067c0ac : MOV EDI,dword ptr [EAX + 0x4]
0067c0af : MOV EDX,ECX
0067c0b1 : INC EDX
0067c0b2 : AND EDX,EDI
0067c0b4 : CMP dword ptr [EAX + EDX*0x8 + 0x8],ESI
0067c0b8 : JNZ 0x0067c0b1
0067c0ba : MOV ESI,dword ptr [EAX + ECX*0x8 + 0xc]
0067c0be : MOV ESI,dword ptr [ESI + 0x10]
0067c0c1 : AND ESI,EDI
0067c0c3 : PUSH EBX
0067c0c4 : LEA EBX,[EAX + EDX*0x8 + 0x8]
0067c0c8 : CMP ESI,ECX
0067c0ca : JNZ 0x0067c0ee
0067c0cc : TEST EBX,EBX
0067c0ce : JZ 0x0067c0d9
0067c0d0 : MOV dword ptr [EBX],EBP
0067c0d2 : MOV ESI,dword ptr [EAX + ECX*0x8 + 0xc]
0067c0d6 : MOV dword ptr [EBX + 0x4],ESI
0067c0d9 : MOV ESI,dword ptr [ESP + 0x18]
0067c0dd : MOV ESI,dword ptr [ESI]
0067c0df : POP EBX
0067c0e0 : POP EDI
0067c0e1 : MOV dword ptr [EAX + ECX*0x8 + 0xc],ESI
0067c0e5 : POP ESI
0067c0e6 : MOV dword ptr [EAX + ECX*0x8 + 0x8],EDX
0067c0ea : POP EBP
0067c0eb : RET 0xc
0067c0ee : CMP dword ptr [EAX + ESI*0x8 + 0x8],ECX
0067c0f2 : LEA ESI,[EAX + ESI*0x8 + 0x8]
0067c0f6 : JZ 0x0067c10c
0067c0f8 : JMP 0x0067c100
0067c100 : MOV ESI,dword ptr [ESI]
0067c102 : CMP dword ptr [EAX + ESI*0x8 + 0x8],ECX
0067c106 : LEA ESI,[EAX + ESI*0x8 + 0x8]
0067c10a : JNZ 0x0067c100
0067c10c : TEST EBX,EBX
0067c10e : JZ 0x0067c119
0067c110 : MOV dword ptr [EBX],EBP
0067c112 : MOV EDI,dword ptr [EAX + ECX*0x8 + 0xc]
0067c116 : MOV dword ptr [EBX + 0x4],EDI
0067c119 : MOV dword ptr [ESI],EDX
0067c11b : MOV EDX,dword ptr [ESP + 0x18]
0067c11f : MOV EDX,dword ptr [EDX]
0067c121 : POP EBX
0067c122 : POP EDI
0067c123 : POP ESI
0067c124 : MOV dword ptr [EAX + ECX*0x8 + 0xc],EDX
0067c128 : MOV dword ptr [EAX + ECX*0x8 + 0x8],0xffffffff
0067c130 : POP EBP
0067c131 : RET 0xc

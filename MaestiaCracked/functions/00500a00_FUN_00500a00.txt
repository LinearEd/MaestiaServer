PROGRAM  : Maestia.exe
FUNCTION : FUN_00500a00
ENTRY    : 00500a00
BODY     : [[00500a00, 00500af5]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00500a00(void)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  GRefCountImpl *this;
  GRefCountImpl *this_00;
  int *in_ECX;
  
  iVar1 = *(int *)(in_ECX[0x28] + 0x118);
  if (iVar1 == 0) {
    iVar1 = FUN_005450a0();
    if ((*(byte *)(in_ECX[0x27] + 0x50) >> 3 & 1) != 0) {
      *(ushort *)(iVar1 + 0x68) = *(ushort *)(iVar1 + 0x68) | 1;
    }
    if ((*(byte *)(in_ECX[0x27] + 0x50) >> 5 & 1) != 0) {
      *(ushort *)(iVar1 + 0x68) = *(ushort *)(iVar1 + 0x68) | 2;
    }
    iVar2 = (**(code **)(*in_ECX + 0x40))();
    piVar3 = (int *)(*(code *)**(undefined4 **)(iVar2 + 8))();
    this = (GRefCountImpl *)(**(code **)(*piVar3 + 0xc))(0x18);
    if (this != (GRefCountImpl *)0x0) {
      GRefCountImpl::AddRef(this);
    }
    if (*(GRefCountImpl **)(iVar1 + 0xc) != (GRefCountImpl *)0x0) {
      GRefCountImpl::Release(*(GRefCountImpl **)(iVar1 + 0xc));
    }
    *(GRefCountImpl **)(iVar1 + 0xc) = this;
    iVar2 = (**(code **)(*in_ECX + 0x40))();
    piVar3 = (int *)(*(code *)**(undefined4 **)(iVar2 + 8))();
    this_00 = (GRefCountImpl *)(**(code **)(*piVar3 + 0xc))(0x19);
    if (this_00 != (GRefCountImpl *)0x0) {
      GRefCountImpl::AddRef(this_00);
    }
    if (*(GRefCountImpl **)(iVar1 + 0x10) != (GRefCountImpl *)0x0) {
      GRefCountImpl::Release(*(GRefCountImpl **)(iVar1 + 0x10));
    }
    *(GRefCountImpl **)(iVar1 + 0x10) = this_00;
    if ((*(byte *)((int)in_ECX + 0xc9) & 1) == 0) {
      *(ushort *)(iVar1 + 0x68) = *(ushort *)(iVar1 + 0x68) & 0xfffb;
    }
    else {
      *(ushort *)(iVar1 + 0x68) = *(ushort *)(iVar1 + 0x68) | 4;
    }
    if (this_00 != (GRefCountImpl *)0x0) {
      GRefCountImpl::Release(this_00);
    }
    if (this != (GRefCountImpl *)0x0) {
      GRefCountImpl::Release(this);
    }
  }
  return iVar1;
}



============================================================
DISASSEMBLY
============================================================
00500a00 : PUSH ESI
00500a01 : MOV ESI,ECX
00500a03 : MOV ECX,dword ptr [ESI + 0xa0]
00500a09 : MOV EAX,dword ptr [ECX + 0x118]
00500a0f : TEST EAX,EAX
00500a11 : JNZ 0x00500af4
00500a17 : PUSH EDI
00500a18 : CALL 0x005450a0
00500a1d : MOV EDI,EAX
00500a1f : MOV EAX,dword ptr [ESI + 0x9c]
00500a25 : MOV CL,byte ptr [EAX + 0x50]
00500a28 : SHR CL,0x3
00500a2b : TEST CL,0x1
00500a2e : JZ 0x00500a35
00500a30 : OR word ptr [EDI + 0x68],0x1
00500a35 : MOV EDX,dword ptr [ESI + 0x9c]
00500a3b : MOV AL,byte ptr [EDX + 0x50]
00500a3e : SHR AL,0x5
00500a41 : TEST AL,0x1
00500a43 : JZ 0x00500a4a
00500a45 : OR word ptr [EDI + 0x68],0x2
00500a4a : MOV EDX,dword ptr [ESI]
00500a4c : MOV EAX,dword ptr [EDX + 0x40]
00500a4f : PUSH EBX
00500a50 : MOV ECX,ESI
00500a52 : CALL EAX
00500a54 : MOV EDX,dword ptr [EAX + 0x8]
00500a57 : LEA ECX,[EAX + 0x8]
00500a5a : MOV EAX,dword ptr [EDX]
00500a5c : CALL EAX
00500a5e : MOV EDX,dword ptr [EAX]
00500a60 : MOV ECX,EAX
00500a62 : MOV EAX,dword ptr [EDX + 0xc]
00500a65 : PUSH 0x18
00500a67 : CALL EAX
00500a69 : MOV EBX,EAX
00500a6b : TEST EBX,EBX
00500a6d : JZ 0x00500a76
00500a6f : MOV ECX,EBX
00500a71 : CALL 0x00523dd0
00500a76 : MOV ECX,dword ptr [EDI + 0xc]
00500a79 : TEST ECX,ECX
00500a7b : JZ 0x00500a82
00500a7d : CALL 0x004ff7e0
00500a82 : MOV dword ptr [EDI + 0xc],EBX
00500a85 : MOV EDX,dword ptr [ESI]
00500a87 : MOV EAX,dword ptr [EDX + 0x40]
00500a8a : PUSH EBP
00500a8b : MOV ECX,ESI
00500a8d : CALL EAX
00500a8f : MOV EDX,dword ptr [EAX + 0x8]
00500a92 : LEA ECX,[EAX + 0x8]
00500a95 : MOV EAX,dword ptr [EDX]
00500a97 : CALL EAX
00500a99 : MOV EDX,dword ptr [EAX]
00500a9b : MOV ECX,EAX
00500a9d : MOV EAX,dword ptr [EDX + 0xc]
00500aa0 : PUSH 0x19
00500aa2 : CALL EAX
00500aa4 : MOV EBP,EAX
00500aa6 : TEST EBP,EBP
00500aa8 : JZ 0x00500ab1
00500aaa : MOV ECX,EBP
00500aac : CALL 0x00523dd0
00500ab1 : MOV ECX,dword ptr [EDI + 0x10]
00500ab4 : TEST ECX,ECX
00500ab6 : JZ 0x00500abd
00500ab8 : CALL 0x004ff7e0
00500abd : MOV dword ptr [EDI + 0x10],EBP
00500ac0 : TEST byte ptr [ESI + 0xc9],0x1
00500ac7 : JZ 0x00500ad0
00500ac9 : OR word ptr [EDI + 0x68],0x4
00500ace : JMP 0x00500ad9
00500ad0 : MOV ECX,0xfffb
00500ad5 : AND word ptr [EDI + 0x68],CX
00500ad9 : TEST EBP,EBP
00500adb : JZ 0x00500ae4
00500add : MOV ECX,EBP
00500adf : CALL 0x004ff7e0
00500ae4 : POP EBP
00500ae5 : TEST EBX,EBX
00500ae7 : JZ 0x00500af0
00500ae9 : MOV ECX,EBX
00500aeb : CALL 0x004ff7e0
00500af0 : POP EBX
00500af1 : MOV EAX,EDI
00500af3 : POP EDI
00500af4 : POP ESI
00500af5 : RET

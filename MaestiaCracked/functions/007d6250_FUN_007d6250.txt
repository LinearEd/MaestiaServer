PROGRAM  : Maestia.exe
FUNCTION : FUN_007d6250
ENTRY    : 007d6250
BODY     : [[007d6250, 007d6428]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_007d6250(undefined4 param_1,int *param_2,int param_3)

{
  int *piVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  uint uVar4;
  int iVar5;
  undefined4 uVar6;
  int *in_ECX;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b10188;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  if (*(char *)((int)in_ECX + 0x259) == '\0') {
    return 0;
  }
  ExceptionList = &local_10;
  if (*(char *)((int)in_ECX + 0x25a) != '\0') {
    if (param_3 == 2) {
      param_3 = FUN_007f2d40(uVar4);
    }
    if (param_3 == 0) {
      ExceptionList = local_10;
      return 0;
    }
  }
  if (*(char *)((int)in_ECX + 0x2bd) == '\0') {
    (**(code **)(*in_ECX + 0xe0))();
    if (in_ECX[2] != 0) {
      EnterCriticalSection((LPCRITICAL_SECTION)(in_ECX[2] + 4));
    }
    local_8 = 0;
    if ((char)in_ECX[0xaf] == '\0') {
      puVar2 = (undefined4 *)in_ECX[0x62];
      for (puVar3 = (undefined4 *)*puVar2; puVar3 != puVar2; puVar3 = (undefined4 *)*puVar3) {
        piVar1 = (int *)puVar3[9];
        if (*(char *)((int)piVar1 + 0x71) != '\0') {
          uVar6 = (**(code **)(*piVar1 + 4))();
          switch(uVar6) {
          case 1:
          case 2:
          case 8:
          case 0x12:
          case 0x13:
            iVar5 = 1;
            if (param_3 != 1) {
              (**(code **)(*piVar1 + 0x2c))();
              iVar5 = FUN_007f2d40();
            }
            if (iVar5 != 0) {
              (**(code **)(*param_2 + 0x10))(piVar1,param_1,1);
            }
          }
        }
      }
    }
    else {
      piVar1 = (int *)in_ECX[0xad];
      if ((piVar1 != (int *)0x0) && (*(char *)((int)piVar1 + 0x71) != '\0')) {
        if (param_3 != 1) {
          (**(code **)(*piVar1 + 0x2c))();
          param_3 = FUN_007f2d40(uVar4);
        }
        if (param_3 != 0) {
          (**(code **)(*param_2 + 0x10))(in_ECX[0xad],param_1,1);
        }
      }
      piVar1 = (int *)in_ECX[0xae];
      if ((piVar1 != (int *)0x0) && (*(char *)((int)piVar1 + 0x71) != '\0')) {
        iVar5 = 1;
        if (param_3 != 1) {
          (**(code **)(*piVar1 + 0x2c))();
          iVar5 = FUN_007f2d40();
        }
        if (iVar5 != 0) {
          (**(code **)(*param_2 + 0x10))(in_ECX[0xae],param_1,1);
        }
      }
    }
    local_8 = 0xffffffff;
    if (in_ECX[2] != 0) {
      LeaveCriticalSection((LPCRITICAL_SECTION)(in_ECX[2] + 4));
    }
  }
  ExceptionList = local_10;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
007d6250 : PUSH EBP
007d6251 : MOV EBP,ESP
007d6253 : PUSH -0x1
007d6255 : PUSH 0xb10188
007d625a : MOV EAX,FS:[0x0]
007d6260 : PUSH EAX
007d6261 : SUB ESP,0x8
007d6264 : PUSH EBX
007d6265 : PUSH ESI
007d6266 : PUSH EDI
007d6267 : MOV EAX,[0x00d66fa0]
007d626c : XOR EAX,EBP
007d626e : PUSH EAX
007d626f : LEA EAX,[EBP + -0xc]
007d6272 : MOV FS:[0x0],EAX
007d6278 : MOV EDI,ECX
007d627a : MOV AL,byte ptr [EDI + 0x259]
007d6280 : TEST AL,AL
007d6282 : JZ 0x007d62ae
007d6284 : CMP byte ptr [EDI + 0x25a],0x0
007d628b : MOV ESI,dword ptr [EBP + 0x10]
007d628e : MOV EBX,dword ptr [EBP + 0x8]
007d6291 : JZ 0x007d62c4
007d6293 : CMP ESI,0x2
007d6296 : JNZ 0x007d62aa
007d6298 : LEA EAX,[EDI + 0x1ac]
007d629e : MOV EDX,EBX
007d62a0 : CALL 0x007f2d40
007d62a5 : MOV dword ptr [EBP + 0x10],EAX
007d62a8 : MOV ESI,EAX
007d62aa : TEST ESI,ESI
007d62ac : JNZ 0x007d62c4
007d62ae : XOR AL,AL
007d62b0 : MOV ECX,dword ptr [EBP + -0xc]
007d62b3 : MOV dword ptr FS:[0x0],ECX
007d62ba : POP ECX
007d62bb : POP EDI
007d62bc : POP ESI
007d62bd : POP EBX
007d62be : MOV ESP,EBP
007d62c0 : POP EBP
007d62c1 : RET 0xc
007d62c4 : CMP byte ptr [EDI + 0x2bd],0x0
007d62cb : JNZ 0x007d6413
007d62d1 : MOV EAX,dword ptr [EDI]
007d62d3 : MOV EDX,dword ptr [EAX + 0xe0]
007d62d9 : MOV ECX,EDI
007d62db : CALL EDX
007d62dd : MOV EAX,dword ptr [EDI + 0x8]
007d62e0 : MOV dword ptr [EBP + -0x14],EDI
007d62e3 : TEST EAX,EAX
007d62e5 : JZ 0x007d62f1
007d62e7 : ADD EAX,0x4
007d62ea : PUSH EAX
007d62eb : CALL dword ptr [0x00b85118]
007d62f1 : MOV dword ptr [EBP + -0x4],0x0
007d62f8 : CMP byte ptr [EDI + 0x2bc],0x0
007d62ff : JZ 0x007d6391
007d6305 : MOV EAX,dword ptr [EDI + 0x2b4]
007d630b : TEST EAX,EAX
007d630d : JZ 0x007d6344
007d630f : CMP byte ptr [EAX + 0x71],0x0
007d6313 : JZ 0x007d6344
007d6315 : CMP ESI,0x1
007d6318 : JZ 0x007d632c
007d631a : MOV ECX,EAX
007d631c : MOV EAX,dword ptr [ECX]
007d631e : MOV EDX,dword ptr [EAX + 0x2c]
007d6321 : CALL EDX
007d6323 : MOV EDX,EBX
007d6325 : CALL 0x007f2d40
007d632a : MOV ESI,EAX
007d632c : TEST ESI,ESI
007d632e : JZ 0x007d6344
007d6330 : MOV ECX,dword ptr [EBP + 0xc]
007d6333 : MOV EAX,dword ptr [ECX]
007d6335 : MOV EDX,dword ptr [EDI + 0x2b4]
007d633b : MOV EAX,dword ptr [EAX + 0x10]
007d633e : PUSH 0x1
007d6340 : PUSH EBX
007d6341 : PUSH EDX
007d6342 : CALL EAX
007d6344 : MOV EAX,dword ptr [EDI + 0x2b8]
007d634a : TEST EAX,EAX
007d634c : JZ 0x007d63fb
007d6352 : CMP byte ptr [EAX + 0x71],0x0
007d6356 : JZ 0x007d63fb
007d635c : CMP ESI,0x1
007d635f : JZ 0x007d6373
007d6361 : MOV ECX,EAX
007d6363 : MOV EDX,dword ptr [ECX]
007d6365 : MOV EAX,dword ptr [EDX + 0x2c]
007d6368 : CALL EAX
007d636a : MOV EDX,EBX
007d636c : CALL 0x007f2d40
007d6371 : MOV ESI,EAX
007d6373 : TEST ESI,ESI
007d6375 : JZ 0x007d63fb
007d637b : MOV ECX,dword ptr [EBP + 0xc]
007d637e : MOV EDX,dword ptr [ECX]
007d6380 : MOV EAX,dword ptr [EDI + 0x2b8]
007d6386 : MOV EDX,dword ptr [EDX + 0x10]
007d6389 : PUSH 0x1
007d638b : PUSH EBX
007d638c : PUSH EAX
007d638d : CALL EDX
007d638f : JMP 0x007d63fb
007d6391 : MOV EAX,dword ptr [EDI + 0x188]
007d6397 : MOV EBX,dword ptr [EAX]
007d6399 : MOV dword ptr [EBP + -0x10],EAX
007d639c : CMP EBX,EAX
007d639e : JZ 0x007d63fb
007d63a0 : MOV ESI,dword ptr [EBX + 0x24]
007d63a3 : CMP byte ptr [ESI + 0x71],0x0
007d63a7 : JZ 0x007d63f4
007d63a9 : MOV EAX,dword ptr [ESI]
007d63ab : MOV EDX,dword ptr [EAX + 0x4]
007d63ae : MOV ECX,ESI
007d63b0 : CALL EDX
007d63b2 : DEC EAX
007d63b3 : CMP EAX,0x12
007d63b6 : JA 0x007d63f4
007d63b8 : MOVZX EAX,byte ptr [EAX + 0x7d6434]
007d63bf : JMP dword ptr [EAX*0x4 + 0x7d642c]
007d63c6 : MOV EAX,dword ptr [EBP + 0x10]
007d63c9 : CMP EAX,0x1
007d63cc : JZ 0x007d63df
007d63ce : MOV EDX,dword ptr [ESI]
007d63d0 : MOV EAX,dword ptr [EDX + 0x2c]
007d63d3 : MOV ECX,ESI
007d63d5 : CALL EAX
007d63d7 : MOV EDX,dword ptr [EBP + 0x8]
007d63da : CALL 0x007f2d40
007d63df : TEST EAX,EAX
007d63e1 : JZ 0x007d63f4
007d63e3 : MOV ECX,dword ptr [EBP + 0xc]
007d63e6 : MOV EAX,dword ptr [EBP + 0x8]
007d63e9 : MOV EDX,dword ptr [ECX]
007d63eb : MOV EDX,dword ptr [EDX + 0x10]
007d63ee : PUSH 0x1
007d63f0 : PUSH EAX
007d63f1 : PUSH ESI
007d63f2 : CALL EDX
007d63f4 : MOV EBX,dword ptr [EBX]
007d63f6 : CMP EBX,dword ptr [EBP + -0x10]
007d63f9 : JNZ 0x007d63a0
007d63fb : MOV dword ptr [EBP + -0x4],0xffffffff
007d6402 : MOV EDI,dword ptr [EDI + 0x8]
007d6405 : TEST EDI,EDI
007d6407 : JZ 0x007d6413
007d6409 : ADD EDI,0x4
007d640c : PUSH EDI
007d640d : CALL dword ptr [0x00b8511c]
007d6413 : MOV AL,0x1
007d6415 : MOV ECX,dword ptr [EBP + -0xc]
007d6418 : MOV dword ptr FS:[0x0],ECX
007d641f : POP ECX
007d6420 : POP EDI
007d6421 : POP ESI
007d6422 : POP EBX
007d6423 : MOV ESP,EBP
007d6425 : POP EBP
007d6426 : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : ___check_float_string
ENTRY    : 0064f028
BODY     : [[0064f028, 0064f07e]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    ___check_float_string
   
   Library: Visual Studio 2008 Release */

undefined4 ___check_float_string(size_t param_1,void *param_2,undefined4 *param_3)

{
  size_t _Count;
  void *pvVar1;
  size_t *unaff_ESI;
  undefined4 *unaff_EDI;
  
  _Count = *unaff_ESI;
  if (param_1 == _Count) {
    if ((void *)*unaff_EDI == param_2) {
      pvVar1 = __calloc_crt(_Count,2);
      *unaff_EDI = pvVar1;
      if (pvVar1 == (void *)0x0) {
        return 0;
      }
      *param_3 = 1;
      _memcpy((void *)*unaff_EDI,param_2,*unaff_ESI);
    }
    else {
      pvVar1 = __recalloc_crt((void *)*unaff_EDI,_Count,2);
      if (pvVar1 == (void *)0x0) {
        return 0;
      }
      *unaff_EDI = pvVar1;
    }
    *unaff_ESI = *unaff_ESI << 1;
  }
  return 1;
}



============================================================
DISASSEMBLY
============================================================
0064f028 : MOV EDI,EDI
0064f02a : PUSH EBP
0064f02b : MOV EBP,ESP
0064f02d : MOV EAX,dword ptr [ESI]
0064f02f : CMP dword ptr [EBP + 0x8],EAX
0064f032 : JNZ 0x0064f07a
0064f034 : MOV ECX,dword ptr [EDI]
0064f036 : PUSH 0x2
0064f038 : PUSH EAX
0064f039 : CMP ECX,dword ptr [EBP + 0xc]
0064f03c : JNZ 0x0064f069
0064f03e : CALL 0x006425a4
0064f043 : POP ECX
0064f044 : POP ECX
0064f045 : MOV dword ptr [EDI],EAX
0064f047 : TEST EAX,EAX
0064f049 : JNZ 0x0064f04f
0064f04b : XOR EAX,EAX
0064f04d : POP EBP
0064f04e : RET
0064f04f : MOV EAX,dword ptr [EBP + 0x10]
0064f052 : MOV dword ptr [EAX],0x1
0064f058 : PUSH dword ptr [ESI]
0064f05a : PUSH dword ptr [EBP + 0xc]
0064f05d : PUSH dword ptr [EDI]
0064f05f : CALL 0x0063ae40
0064f064 : ADD ESP,0xc
0064f067 : JMP 0x0064f078
0064f069 : PUSH ECX
0064f06a : CALL 0x0064263e
0064f06f : ADD ESP,0xc
0064f072 : TEST EAX,EAX
0064f074 : JZ 0x0064f04b
0064f076 : MOV dword ptr [EDI],EAX
0064f078 : SHL dword ptr [ESI],0x1
0064f07a : XOR EAX,EAX
0064f07c : INC EAX
0064f07d : POP EBP
0064f07e : RET

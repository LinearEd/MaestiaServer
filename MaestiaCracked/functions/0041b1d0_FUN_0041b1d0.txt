PROGRAM  : Maestia.exe
FUNCTION : FUN_0041b1d0
ENTRY    : 0041b1d0
BODY     : [[0041b1d0, 0041b2e2]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0041b1d0(int param_1,int param_2,undefined4 param_3)

{
  undefined2 *puVar1;
  int iVar2;
  code *pcVar3;
  void **ppvVar4;
  char cVar5;
  uint uVar6;
  int in_ECX;
  int iVar7;
  int iVar8;
  undefined4 in_stack_0000002c;
  undefined2 uStack00000030;
  undefined2 uStack00000032;
  code *in_stack_00000034;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  pcVar3 = in_stack_00000034;
  puStack_c = &LAB_00b794d4;
  uVar6 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_8 = 0;
  ppvVar4 = &local_10;
  local_10 = ExceptionList;
  while (ExceptionList = ppvVar4, param_2 < in_ECX) {
    iVar7 = (in_ECX + -1) / 2;
    iVar2 = iVar7 * 0x28;
    cVar5 = (*pcVar3)(iVar2 + param_1,&param_3,uVar6);
    if (cVar5 == '\0') break;
    iVar8 = iVar2 + param_1;
    puVar1 = (undefined2 *)(param_1 + in_ECX * 0x28);
    *puVar1 = *(undefined2 *)(iVar2 + param_1);
    puVar1[1] = *(undefined2 *)(iVar8 + 2);
    FUN_00405eb0(iVar8 + 4,0,0xffffffff);
    *(undefined4 *)(puVar1 + 0x10) = *(undefined4 *)(iVar8 + 0x20);
    puVar1[0x12] = *(undefined2 *)(iVar8 + 0x24);
    puVar1[0x13] = *(undefined2 *)(iVar8 + 0x26);
    ppvVar4 = ExceptionList;
    in_ECX = iVar7;
  }
  puVar1 = (undefined2 *)(param_1 + in_ECX * 0x28);
  *puVar1 = (undefined2)param_3;
  puVar1[1] = param_3._2_2_;
  FUN_00405eb0(&stack0x00000010,0,0xffffffff);
  *(undefined4 *)(puVar1 + 0x10) = in_stack_0000002c;
  puVar1[0x12] = uStack00000030;
  puVar1[0x13] = uStack00000032;
  local_8 = 0xffffffff;
  FUN_004427d0(&param_3);
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
0041b1d0 : PUSH EBP
0041b1d1 : MOV EBP,ESP
0041b1d3 : PUSH -0x1
0041b1d5 : PUSH 0xb794d4
0041b1da : MOV EAX,FS:[0x0]
0041b1e0 : PUSH EAX
0041b1e1 : PUSH ECX
0041b1e2 : PUSH EBX
0041b1e3 : PUSH ESI
0041b1e4 : PUSH EDI
0041b1e5 : MOV EAX,[0x00d66fa0]
0041b1ea : XOR EAX,EBP
0041b1ec : PUSH EAX
0041b1ed : LEA EAX,[EBP + -0xc]
0041b1f0 : MOV FS:[0x0],EAX
0041b1f6 : MOV EDI,ECX
0041b1f8 : MOV EAX,dword ptr [EBP + 0x38]
0041b1fb : MOV dword ptr [EBP + -0x10],EAX
0041b1fe : MOV dword ptr [EBP + -0x4],0x0
0041b205 : LEA EAX,[EDI + -0x1]
0041b208 : CDQ
0041b209 : SUB EAX,EDX
0041b20b : MOV EBX,EAX
0041b20d : SAR EBX,0x1
0041b20f : CMP dword ptr [EBP + 0xc],EDI
0041b212 : JGE 0x0041b283
0041b214 : MOV ECX,dword ptr [EBP + 0x8]
0041b217 : LEA ESI,[EBX + EBX*0x4]
0041b21a : ADD ESI,ESI
0041b21c : ADD ESI,ESI
0041b21e : LEA EDX,[EBP + 0x10]
0041b221 : ADD ESI,ESI
0041b223 : LEA EAX,[ESI + ECX*0x1]
0041b226 : PUSH EDX
0041b227 : PUSH EAX
0041b228 : CALL dword ptr [EBP + -0x10]
0041b22b : ADD ESP,0x8
0041b22e : TEST AL,AL
0041b230 : JZ 0x0041b283
0041b232 : MOV EAX,dword ptr [EBP + 0x8]
0041b235 : MOV DX,word ptr [ESI + EAX*0x1]
0041b239 : ADD ESI,EAX
0041b23b : LEA ECX,[EDI + EDI*0x4]
0041b23e : LEA EDI,[EAX + ECX*0x8]
0041b241 : PUSH -0x1
0041b243 : MOV word ptr [EDI],DX
0041b246 : MOVZX EAX,word ptr [ESI + 0x2]
0041b24a : PUSH 0x0
0041b24c : LEA ECX,[ESI + 0x4]
0041b24f : PUSH ECX
0041b250 : LEA ECX,[EDI + 0x4]
0041b253 : MOV word ptr [EDI + 0x2],AX
0041b257 : CALL 0x00405eb0
0041b25c : MOV EDX,dword ptr [ESI + 0x20]
0041b25f : MOV dword ptr [EDI + 0x20],EDX
0041b262 : MOVZX EAX,word ptr [ESI + 0x24]
0041b266 : MOV word ptr [EDI + 0x24],AX
0041b26a : MOV CX,word ptr [ESI + 0x26]
0041b26e : LEA EAX,[EBX + -0x1]
0041b271 : CDQ
0041b272 : SUB EAX,EDX
0041b274 : MOV word ptr [EDI + 0x26],CX
0041b278 : MOV EDI,EBX
0041b27a : SAR EAX,0x1
0041b27c : CMP dword ptr [EBP + 0xc],EDI
0041b27f : MOV EBX,EAX
0041b281 : JL 0x0041b214
0041b283 : MOV EAX,dword ptr [EBP + 0x8]
0041b286 : MOV CX,word ptr [EBP + 0x10]
0041b28a : LEA EDX,[EDI + EDI*0x4]
0041b28d : LEA ESI,[EAX + EDX*0x8]
0041b290 : PUSH -0x1
0041b292 : MOV word ptr [ESI],CX
0041b295 : MOV DX,word ptr [EBP + 0x12]
0041b299 : PUSH 0x0
0041b29b : LEA EAX,[EBP + 0x14]
0041b29e : PUSH EAX
0041b29f : LEA ECX,[ESI + 0x4]
0041b2a2 : MOV word ptr [ESI + 0x2],DX
0041b2a6 : CALL 0x00405eb0
0041b2ab : MOV ECX,dword ptr [EBP + 0x30]
0041b2ae : MOV dword ptr [ESI + 0x20],ECX
0041b2b1 : MOV DX,word ptr [EBP + 0x34]
0041b2b5 : MOV word ptr [ESI + 0x24],DX
0041b2b9 : MOV AX,word ptr [EBP + 0x36]
0041b2bd : MOV word ptr [ESI + 0x26],AX
0041b2c1 : MOV dword ptr [EBP + -0x4],0xffffffff
0041b2c8 : LEA ECX,[EBP + 0x10]
0041b2cb : PUSH ECX
0041b2cc : CALL 0x004427d0
0041b2d1 : MOV ECX,dword ptr [EBP + -0xc]
0041b2d4 : MOV dword ptr FS:[0x0],ECX
0041b2db : POP ECX
0041b2dc : POP EDI
0041b2dd : POP ESI
0041b2de : POP EBX
0041b2df : MOV ESP,EBP
0041b2e1 : POP EBP
0041b2e2 : RET

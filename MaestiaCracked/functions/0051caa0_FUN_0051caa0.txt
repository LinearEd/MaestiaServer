PROGRAM  : Maestia.exe
FUNCTION : FUN_0051caa0
ENTRY    : 0051caa0
BODY     : [[0051caa0, 0051caec]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_0051caa0(int param_1,int param_2,int param_3,undefined2 *param_4,code *param_5)

{
  int iVar1;
  char cVar2;
  int iVar3;
  
  iVar3 = param_3 - param_2;
  while (iVar1 = iVar3, 0 < iVar1) {
    iVar3 = iVar1 >> 1;
    cVar2 = (*param_5)(param_1 + (iVar3 + param_2) * 4,*param_4);
    if (cVar2 != '\0') {
      param_2 = iVar3 + param_2 + 1;
      iVar3 = iVar1 + (-1 - iVar3);
    }
  }
  return param_2;
}



============================================================
DISASSEMBLY
============================================================
0051caa0 : PUSH EBP
0051caa1 : MOV EBP,dword ptr [ESP + 0xc]
0051caa5 : PUSH EDI
0051caa6 : MOV EDI,dword ptr [ESP + 0x14]
0051caaa : SUB EDI,EBP
0051caac : TEST EDI,EDI
0051caae : JLE 0x0051cae8
0051cab0 : PUSH EBX
0051cab1 : PUSH ESI
0051cab2 : MOV EAX,dword ptr [ESP + 0x20]
0051cab6 : MOVZX ECX,word ptr [EAX]
0051cab9 : MOV EDX,dword ptr [ESP + 0x14]
0051cabd : MOV ESI,EDI
0051cabf : SAR ESI,0x1
0051cac1 : LEA EBX,[ESI + EBP*0x1]
0051cac4 : PUSH ECX
0051cac5 : LEA EAX,[EDX + EBX*0x4]
0051cac8 : PUSH EAX
0051cac9 : CALL dword ptr [ESP + 0x2c]
0051cacd : ADD ESP,0x8
0051cad0 : TEST AL,AL
0051cad2 : JZ 0x0051cae0
0051cad4 : OR ECX,0xffffffff
0051cad7 : SUB ECX,ESI
0051cad9 : LEA EBP,[EBX + 0x1]
0051cadc : ADD EDI,ECX
0051cade : JMP 0x0051cae2
0051cae0 : MOV EDI,ESI
0051cae2 : TEST EDI,EDI
0051cae4 : JG 0x0051cab2
0051cae6 : POP ESI
0051cae7 : POP EBX
0051cae8 : POP EDI
0051cae9 : MOV EAX,EBP
0051caeb : POP EBP
0051caec : RET

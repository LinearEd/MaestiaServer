PROGRAM  : Maestia.exe
FUNCTION : FUN_006bf3a0
ENTRY    : 006bf3a0
BODY     : [[006bf3a0, 006bf40f]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_006bf3a0(int param_1,char *param_2)

{
  FILE *_File;
  long lVar1;
  
  if (param_1 == 0) {
    return 0x28;
  }
  _File = _fopen(param_2,"rb");
  if (_File == (FILE *)0x0) {
    return 1;
  }
  _fseek(_File,0,2);
  lVar1 = _ftell(_File);
  *(long *)(param_1 + 4) = lVar1;
  _fseek(_File,0,0);
  *(FILE **)(param_1 + 0xc) = _File;
  *(char **)(param_1 + 0x10) = param_2;
  *(undefined4 *)(param_1 + 8) = 0;
  *(undefined1 **)(param_1 + 0x14) = &LAB_006bf370;
  *(code **)(param_1 + 0x18) = FUN_006bf350;
  return 0;
}



============================================================
DISASSEMBLY
============================================================
006bf3a0 : PUSH ESI
006bf3a1 : MOV ESI,dword ptr [ESP + 0x8]
006bf3a5 : TEST ESI,ESI
006bf3a7 : JNZ 0x006bf3ae
006bf3a9 : LEA EAX,[ESI + 0x28]
006bf3ac : POP ESI
006bf3ad : RET
006bf3ae : PUSH EBX
006bf3af : MOV EBX,dword ptr [ESP + 0x10]
006bf3b3 : PUSH EDI
006bf3b4 : PUSH 0xb903ac
006bf3b9 : PUSH EBX
006bf3ba : CALL 0x00638fa0
006bf3bf : MOV EDI,EAX
006bf3c1 : ADD ESP,0x8
006bf3c4 : TEST EDI,EDI
006bf3c6 : JNZ 0x006bf3cf
006bf3c8 : LEA EAX,[EDI + 0x1]
006bf3cb : POP EDI
006bf3cc : POP EBX
006bf3cd : POP ESI
006bf3ce : RET
006bf3cf : PUSH 0x2
006bf3d1 : PUSH 0x0
006bf3d3 : PUSH EDI
006bf3d4 : CALL 0x006377fb
006bf3d9 : PUSH EDI
006bf3da : CALL 0x0063751f
006bf3df : PUSH 0x0
006bf3e1 : PUSH 0x0
006bf3e3 : PUSH EDI
006bf3e4 : MOV dword ptr [ESI + 0x4],EAX
006bf3e7 : CALL 0x006377fb
006bf3ec : ADD ESP,0x1c
006bf3ef : MOV dword ptr [ESI + 0xc],EDI
006bf3f2 : POP EDI
006bf3f3 : MOV dword ptr [ESI + 0x10],EBX
006bf3f6 : POP EBX
006bf3f7 : MOV dword ptr [ESI + 0x8],0x0
006bf3fe : MOV dword ptr [ESI + 0x14],0x6bf370
006bf405 : MOV dword ptr [ESI + 0x18],0x6bf350
006bf40c : XOR EAX,EAX
006bf40e : POP ESI
006bf40f : RET

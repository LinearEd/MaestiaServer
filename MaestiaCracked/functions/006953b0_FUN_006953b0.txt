PROGRAM  : Maestia.exe
FUNCTION : FUN_006953b0
ENTRY    : 006953b0
BODY     : [[006953b0, 006955a8]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_006953b0(short param_1)

{
  undefined2 *puVar1;
  undefined4 uVar2;
  int iVar3;
  int in_EAX;
  undefined4 uVar4;
  undefined4 uVar5;
  int iVar6;
  code *pcVar7;
  undefined2 *puVar8;
  int iVar9;
  bool bVar10;
  uint local_14;
  int local_10;
  int local_c;
  int local_8;
  undefined4 local_4;
  
  uVar5 = *(undefined4 *)(in_EAX + 100);
  puVar1 = *(undefined2 **)(in_EAX + 0x168);
  local_c = -1;
  local_10 = -1;
  iVar9 = -1;
  local_8 = -1;
  bVar10 = false;
  puVar8 = puVar1;
  if (*(ushort *)(in_EAX + 0x158) != 0) {
    local_14 = (uint)*(ushort *)(in_EAX + 0x158);
    iVar6 = 0;
    do {
      iVar3 = local_10;
      if ((puVar8[3] == param_1) && (puVar8[4] != 0)) {
        switch(*puVar8) {
        case 0:
        case 2:
          local_8 = iVar6;
          break;
        case 1:
          iVar3 = iVar6;
          if ((puVar8[2] != 0) && (iVar3 = local_10, puVar8[1] == 0)) {
            local_c = iVar6;
          }
          break;
        case 3:
          if (((iVar9 == -1) || ((puVar8[2] & 0x3ff) == 9)) &&
             (((ushort)puVar8[1] < 2 || (puVar8[1] == 10)))) {
            bVar10 = (puVar8[2] & 0x3ff) == 9;
            iVar9 = iVar6;
          }
        }
      }
      local_10 = iVar3;
      iVar6 = iVar6 + 1;
      puVar8 = puVar8 + 10;
      local_14 = local_14 - 1;
    } while (local_14 != 0);
    local_14 = 0;
  }
  iVar6 = local_c;
  if (-1 < local_10) {
    iVar6 = local_10;
  }
  pcVar7 = (code *)0x0;
  if ((iVar9 < 0) || ((-1 < iVar6 && (!bVar10)))) {
    if (-1 < iVar6) {
      puVar8 = puVar1 + iVar6 * 10;
      pcVar7 = (code *)&LAB_00695340;
      goto LAB_006954ee;
    }
    if (local_8 < 0) goto LAB_006954ee;
    puVar8 = puVar1 + local_8 * 10;
  }
  else {
    puVar8 = puVar1 + iVar9 * 10;
    if ((1 < (ushort)puVar1[iVar9 * 10 + 1]) && (puVar1[iVar9 * 10 + 1] != 10)) goto LAB_006954ee;
  }
  pcVar7 = FUN_006952c0;
LAB_006954ee:
  if ((puVar8 == (undefined2 *)0x0) || (pcVar7 == (code *)0x0)) {
    return 0;
  }
  local_4 = uVar5;
  if (*(int *)(puVar8 + 8) == 0) {
    uVar2 = *(undefined4 *)(in_EAX + 0x16c);
    local_14 = 0;
    uVar4 = FUN_0068a220(uVar5,1,0,puVar8[4],0,&local_14);
    *(undefined4 *)(puVar8 + 8) = uVar4;
    if (((local_14 != 0) ||
        (local_14 = FUN_006877c0(uVar2,*(undefined4 *)(puVar8 + 6)), local_14 != 0)) ||
       (local_14 = FUN_006888a0(uVar2,*(undefined4 *)(puVar8 + 8),puVar8[4]), local_14 != 0)) {
      FUN_00687f30(uVar5,*(undefined4 *)(puVar8 + 8));
      *(undefined4 *)(puVar8 + 8) = 0;
      puVar8[4] = 0;
      return 0;
    }
  }
  uVar5 = (*pcVar7)(puVar8,uVar5);
  return uVar5;
}



============================================================
DISASSEMBLY
============================================================
006953b0 : SUB ESP,0x18
006953b3 : PUSH EBX
006953b4 : MOV EBX,EAX
006953b6 : MOV EAX,dword ptr [EBX + 0x64]
006953b9 : MOVZX ECX,word ptr [EBX + 0x158]
006953c0 : PUSH EBP
006953c1 : OR EDX,0xffffffff
006953c4 : PUSH ESI
006953c5 : MOV dword ptr [ESP + 0x20],EAX
006953c9 : MOV EAX,dword ptr [EBX + 0x168]
006953cf : XOR EBP,EBP
006953d1 : PUSH EDI
006953d2 : MOV dword ptr [ESP + 0x1c],EDX
006953d6 : MOV dword ptr [ESP + 0x18],EDX
006953da : MOV EDI,EDX
006953dc : MOV dword ptr [ESP + 0x20],EDX
006953e0 : MOV byte ptr [ESP + 0x13],0x0
006953e5 : MOV ESI,EAX
006953e7 : CMP BP,CX
006953ea : JNC 0x00695494
006953f0 : MOVZX ECX,CX
006953f3 : XOR EDX,EDX
006953f5 : MOV dword ptr [ESP + 0x14],ECX
006953f9 : LEA ESP,[ESP]
00695400 : MOV CX,word ptr [ESI + 0x6]
00695404 : CMP CX,word ptr [ESP + 0x2c]
00695409 : JNZ 0x00695481
0069540b : CMP word ptr [ESI + 0x8],0x0
00695410 : JBE 0x00695481
00695412 : MOVZX ECX,word ptr [ESI]
00695415 : CMP ECX,0x3
00695418 : JA 0x00695481
0069541a : JMP dword ptr [ECX*0x4 + 0x6955ac]
00695421 : MOV dword ptr [ESP + 0x20],EDX
00695425 : JMP 0x00695481
00695427 : CMP word ptr [ESI + 0x4],0x0
0069542c : JNZ 0x00695434
0069542e : MOV dword ptr [ESP + 0x18],EDX
00695432 : JMP 0x00695481
00695434 : CMP word ptr [ESI + 0x2],0x0
00695439 : JNZ 0x00695481
0069543b : MOV dword ptr [ESP + 0x1c],EDX
0069543f : JMP 0x00695481
00695441 : CMP EDI,-0x1
00695444 : JZ 0x00695458
00695446 : MOV CX,word ptr [ESI + 0x4]
0069544a : MOV EBP,0x3ff
0069544f : AND CX,BP
00695452 : CMP CX,0x9
00695456 : JNZ 0x00695481
00695458 : MOVZX ECX,word ptr [ESI + 0x2]
0069545c : TEST ECX,ECX
0069545e : JL 0x00695481
00695460 : CMP ECX,0x1
00695463 : JLE 0x0069546a
00695465 : CMP ECX,0xa
00695468 : JNZ 0x00695481
0069546a : MOV CX,word ptr [ESI + 0x4]
0069546e : MOV EDI,0x3ff
00695473 : AND CX,DI
00695476 : CMP CX,0x9
0069547a : SETZ byte ptr [ESP + 0x13]
0069547f : MOV EDI,EDX
00695481 : INC EDX
00695482 : ADD ESI,0x14
00695485 : SUB dword ptr [ESP + 0x14],0x1
0069548a : JNZ 0x00695400
00695490 : MOV EDX,dword ptr [ESP + 0x18]
00695494 : MOV ECX,dword ptr [ESP + 0x1c]
00695498 : TEST EDX,EDX
0069549a : JL 0x0069549e
0069549c : MOV ECX,EDX
0069549e : XOR EBP,EBP
006954a0 : TEST EDI,EDI
006954a2 : JL 0x006954ca
006954a4 : TEST ECX,ECX
006954a6 : JL 0x006954af
006954a8 : CMP byte ptr [ESP + 0x13],0x0
006954ad : JZ 0x006954ca
006954af : LEA EDX,[EDI + EDI*0x4]
006954b2 : MOVZX ECX,word ptr [EAX + EDX*0x4 + 0x2]
006954b7 : LEA ESI,[EAX + EDX*0x4]
006954ba : TEST ECX,ECX
006954bc : JL 0x006954ee
006954be : CMP ECX,0x1
006954c1 : JLE 0x006954e9
006954c3 : CMP ECX,0xa
006954c6 : JNZ 0x006954ee
006954c8 : JMP 0x006954e9
006954ca : TEST ECX,ECX
006954cc : JL 0x006954db
006954ce : LEA ECX,[ECX + ECX*0x4]
006954d1 : LEA ESI,[EAX + ECX*0x4]
006954d4 : MOV EBP,0x695340
006954d9 : JMP 0x006954ee
006954db : MOV ECX,dword ptr [ESP + 0x20]
006954df : TEST ECX,ECX
006954e1 : JL 0x006954ee
006954e3 : LEA EDX,[ECX + ECX*0x4]
006954e6 : LEA ESI,[EAX + EDX*0x4]
006954e9 : MOV EBP,0x6952c0
006954ee : TEST ESI,ESI
006954f0 : JZ 0x0069559f
006954f6 : TEST EBP,EBP
006954f8 : JZ 0x0069559f
006954fe : CMP dword ptr [ESI + 0x10],0x0
00695502 : JNZ 0x0069558c
00695508 : MOVZX ECX,word ptr [ESI + 0x8]
0069550c : MOV EDI,dword ptr [EBX + 0x16c]
00695512 : MOV EBX,dword ptr [ESP + 0x24]
00695516 : LEA EAX,[ESP + 0x14]
0069551a : PUSH EAX
0069551b : PUSH 0x0
0069551d : PUSH ECX
0069551e : PUSH 0x0
00695520 : PUSH 0x1
00695522 : PUSH EBX
00695523 : MOV dword ptr [ESP + 0x2c],0x0
0069552b : CALL 0x0068a220
00695530 : ADD ESP,0x18
00695533 : CMP dword ptr [ESP + 0x14],0x0
00695538 : MOV dword ptr [ESI + 0x10],EAX
0069553b : JNZ 0x0069556c
0069553d : MOV EDX,dword ptr [ESI + 0xc]
00695540 : PUSH EDX
00695541 : PUSH EDI
00695542 : CALL 0x006877c0
00695547 : ADD ESP,0x8
0069554a : MOV dword ptr [ESP + 0x14],EAX
0069554e : TEST EAX,EAX
00695550 : JNZ 0x0069556c
00695552 : MOVZX EAX,word ptr [ESI + 0x8]
00695556 : MOV ECX,dword ptr [ESI + 0x10]
00695559 : PUSH EAX
0069555a : PUSH ECX
0069555b : PUSH EDI
0069555c : CALL 0x006888a0
00695561 : ADD ESP,0xc
00695564 : MOV dword ptr [ESP + 0x14],EAX
00695568 : TEST EAX,EAX
0069556a : JZ 0x00695590
0069556c : MOV EDX,dword ptr [ESI + 0x10]
0069556f : PUSH EDX
00695570 : PUSH EBX
00695571 : CALL 0x00687f30
00695576 : ADD ESP,0x8
00695579 : XOR EAX,EAX
0069557b : POP EDI
0069557c : XOR ECX,ECX
0069557e : MOV dword ptr [ESI + 0x10],EAX
00695581 : MOV word ptr [ESI + 0x8],CX
00695585 : POP ESI
00695586 : POP EBP
00695587 : POP EBX
00695588 : ADD ESP,0x18
0069558b : RET
0069558c : MOV EBX,dword ptr [ESP + 0x24]
00695590 : PUSH EBX
00695591 : PUSH ESI
00695592 : CALL EBP
00695594 : ADD ESP,0x8
00695597 : POP EDI
00695598 : POP ESI
00695599 : POP EBP
0069559a : POP EBX
0069559b : ADD ESP,0x18
0069559e : RET
0069559f : POP EDI
006955a0 : POP ESI
006955a1 : POP EBP
006955a2 : XOR EAX,EAX
006955a4 : POP EBX
006955a5 : ADD ESP,0x18
006955a8 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00485d00
ENTRY    : 00485d00
BODY     : [[00485d00, 00485f36] [00485f39, 00485f58]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00485d00(int param_1,float param_2,int param_3,float param_4)

{
  char cVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  int *piVar5;
  int iVar6;
  int iVar7;
  float10 fVar8;
  float fVar9;
  float fVar10;
  undefined1 local_40 [4];
  int local_3c;
  int *local_38;
  int local_34;
  float local_30;
  undefined4 local_2c;
  float local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  int local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  iVar6 = param_1;
  puStack_c = &LAB_00b7f608;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_3c = 0;
  piVar5 = (int *)0x0;
  local_38 = (int *)0x0;
  local_34 = 0;
  local_8 = 0;
  uVar3 = (int)param_4 - param_3 >> 0x1f;
  local_14 = -1;
  if ((int)(((int)param_4 - param_3 ^ uVar3) - uVar3) < 2) {
    return -1;
  }
  iVar4 = *(int *)((int)param_2 + 4);
  local_18 = param_3 * 0xc;
  local_2c = *(undefined4 *)(iVar4 + 4 + local_18);
  local_28 = *(float *)(iVar4 + 8 + local_18);
  local_24 = 0;
  local_20 = 0;
  local_1c = 0;
  local_30 = *(float *)(iVar4 + local_18);
  param_1 = param_3;
  iVar4 = param_3;
  ExceptionList = &local_10;
  if (param_3 <= (int)param_4) {
    do {
      local_24 = *(undefined4 *)(*(int *)((int)param_2 + 4) + iVar4 * 0xc);
      iVar7 = *(int *)((int)param_2 + 4) + iVar4 * 0xc;
      local_20 = *(undefined4 *)(iVar7 + 4);
      local_1c = *(undefined4 *)(iVar7 + 8);
      param_1 = iVar4;
      cVar1 = FUN_00485f60(iVar6,&local_30,&local_24,*(undefined4 *)(iVar6 + 0x2eee0),
                           *(undefined4 *)(iVar6 + 0x2eee4));
      if (cVar1 != '\0') {
        if (local_3c == 0) {
          uVar3 = 0;
        }
        else {
          uVar3 = local_34 - local_3c >> 2;
        }
        if ((uint)((int)piVar5 - local_3c >> 2) < uVar3) {
          *piVar5 = iVar4;
          local_38 = piVar5 + 1;
          piVar5 = local_38;
        }
        else {
          FUN_00408c10(local_40,piVar5,1,&param_1);
          piVar5 = local_38;
        }
      }
      param_1 = iVar4 + 1;
      iVar4 = param_1;
    } while (param_1 <= (int)param_4);
  }
  iVar6 = (int)piVar5 - local_3c >> 2;
  param_4 = 9999999.0;
  if (1 < iVar6) {
    iVar4 = *(int *)((int)param_2 + 4);
    local_30 = *(float *)(iVar4 + local_18);
    iVar7 = 0;
    local_28 = *(float *)(iVar4 + 8 + local_18);
    param_1 = iVar6 + -1;
    if (-1 < param_1) {
      do {
        iVar6 = *(int *)(local_3c + iVar7 * 4);
        fVar9 = *(float *)(iVar4 + iVar6 * 0xc) - local_30;
        fVar10 = *(float *)(iVar4 + 8 + iVar6 * 0xc) - local_28;
        fVar8 = (float10)FUN_0040f460(fVar9 * fVar9 + fVar10 * fVar10,uVar2);
        param_2 = (float)fVar8;
        if (((fVar8 < (float10)param_4) && (param_2 != 0.0)) && (iVar7 != param_3 + 1)) {
          param_4 = param_2;
          local_14 = iVar6;
        }
        iVar7 = iVar7 + 1;
      } while (iVar7 <= param_1);
    }
  }
  local_8 = 0xffffffff;
  if (local_3c == 0) {
    ExceptionList = local_10;
    return local_14;
  }
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
00485d00 : PUSH EBP
00485d01 : MOV EBP,ESP
00485d03 : PUSH -0x1
00485d05 : PUSH 0xb7f608
00485d0a : MOV EAX,FS:[0x0]
00485d10 : PUSH EAX
00485d11 : SUB ESP,0x34
00485d14 : PUSH EBX
00485d15 : PUSH ESI
00485d16 : PUSH EDI
00485d17 : MOV EAX,[0x00d66fa0]
00485d1c : XOR EAX,EBP
00485d1e : PUSH EAX
00485d1f : LEA EAX,[EBP + -0xc]
00485d22 : MOV FS:[0x0],EAX
00485d28 : MOV EBX,dword ptr [EBP + 0x8]
00485d2b : XOR ECX,ECX
00485d2d : MOV dword ptr [EBP + -0x38],ECX
00485d30 : XOR EDI,EDI
00485d32 : MOV dword ptr [EBP + -0x34],EDI
00485d35 : MOV dword ptr [EBP + -0x30],ECX
00485d38 : MOV dword ptr [EBP + -0x4],ECX
00485d3b : MOV EAX,dword ptr [EBP + 0x14]
00485d3e : MOV ESI,dword ptr [EBP + 0x10]
00485d41 : SUB EAX,ESI
00485d43 : CDQ
00485d44 : XOR EAX,EDX
00485d46 : SUB EAX,EDX
00485d48 : CMP EAX,0x1
00485d4b : MOV dword ptr [EBP + -0x10],0xffffffff
00485d52 : JG 0x00485d7d
00485d54 : MOV dword ptr [EBP + -0x4],0xffffffff
00485d5b : XOR EAX,EAX
00485d5d : MOV dword ptr [EBP + -0x38],EAX
00485d60 : MOV dword ptr [EBP + -0x34],EAX
00485d63 : MOV dword ptr [EBP + -0x30],EAX
00485d66 : OR EAX,0xffffffff
00485d69 : MOV ECX,dword ptr [EBP + -0xc]
00485d6c : MOV dword ptr FS:[0x0],ECX
00485d73 : POP ECX
00485d74 : POP EDI
00485d75 : POP ESI
00485d76 : POP EBX
00485d77 : MOV ESP,EBP
00485d79 : POP EBP
00485d7a : RET 0x10
00485d7d : MOV EAX,dword ptr [EBP + 0xc]
00485d80 : XORPS XMM0,XMM0
00485d83 : MOV EAX,dword ptr [EAX + 0x4]
00485d86 : LEA EDX,[ESI + ESI*0x2]
00485d89 : ADD EDX,EDX
00485d8b : ADD EDX,EDX
00485d8d : MOVSS XMM1,dword ptr [EAX + EDX*0x1 + 0x4]
00485d93 : MOVSS XMM2,dword ptr [EAX + EDX*0x1 + 0x8]
00485d99 : ADD EAX,EDX
00485d9b : CMP ESI,dword ptr [EBP + 0x14]
00485d9e : MOVSS dword ptr [EBP + -0x20],XMM0
00485da3 : MOVSS dword ptr [EBP + -0x1c],XMM0
00485da8 : MOVSS dword ptr [EBP + -0x18],XMM0
00485dad : MOVSS XMM0,dword ptr [EAX]
00485db1 : MOV dword ptr [EBP + -0x14],EDX
00485db4 : MOVSS dword ptr [EBP + -0x2c],XMM0
00485db9 : MOVSS dword ptr [EBP + -0x28],XMM1
00485dbe : MOVSS dword ptr [EBP + -0x24],XMM2
00485dc3 : MOV dword ptr [EBP + 0x8],ESI
00485dc6 : JG 0x00485e6b
00485dcc : LEA ESP,[ESP]
00485dd0 : MOV EDX,dword ptr [EBP + 0xc]
00485dd3 : FLD float ptr [EBX + 0x2eee0]
00485dd9 : MOV EAX,dword ptr [EDX + 0x4]
00485ddc : LEA ECX,[ESI + ESI*0x2]
00485ddf : MOVSS XMM0,dword ptr [EAX + ECX*0x4]
00485de4 : LEA EAX,[EAX + ECX*0x4]
00485de7 : MOV ECX,dword ptr [EBX + 0x2eee4]
00485ded : PUSH ECX
00485dee : PUSH ECX
00485def : MOVSS dword ptr [EBP + -0x20],XMM0
00485df4 : FSTP float ptr [ESP]
00485df7 : MOVSS XMM0,dword ptr [EAX + 0x4]
00485dfc : MOVSS dword ptr [EBP + -0x1c],XMM0
00485e01 : MOVSS XMM0,dword ptr [EAX + 0x8]
00485e06 : LEA EDX,[EBP + -0x20]
00485e09 : PUSH EDX
00485e0a : LEA EAX,[EBP + -0x2c]
00485e0d : PUSH EAX
00485e0e : PUSH EBX
00485e0f : MOVSS dword ptr [EBP + -0x18],XMM0
00485e14 : CALL 0x00485f60
00485e19 : TEST AL,AL
00485e1b : JZ 0x00485e58
00485e1d : MOV ECX,dword ptr [EBP + -0x38]
00485e20 : TEST ECX,ECX
00485e22 : JNZ 0x00485e28
00485e24 : XOR EAX,EAX
00485e26 : JMP 0x00485e30
00485e28 : MOV EAX,dword ptr [EBP + -0x30]
00485e2b : SUB EAX,ECX
00485e2d : SAR EAX,0x2
00485e30 : MOV EDX,EDI
00485e32 : SUB EDX,ECX
00485e34 : SAR EDX,0x2
00485e37 : CMP EDX,EAX
00485e39 : JNC 0x00485e45
00485e3b : MOV dword ptr [EDI],ESI
00485e3d : ADD EDI,0x4
00485e40 : MOV dword ptr [EBP + -0x34],EDI
00485e43 : JMP 0x00485e58
00485e45 : LEA EAX,[EBP + 0x8]
00485e48 : PUSH EAX
00485e49 : PUSH 0x1
00485e4b : PUSH EDI
00485e4c : LEA ECX,[EBP + -0x3c]
00485e4f : PUSH ECX
00485e50 : CALL 0x00408c10
00485e55 : MOV EDI,dword ptr [EBP + -0x34]
00485e58 : INC ESI
00485e59 : CMP ESI,dword ptr [EBP + 0x14]
00485e5c : MOV dword ptr [EBP + 0x8],ESI
00485e5f : JLE 0x00485dd0
00485e65 : MOV ECX,dword ptr [EBP + -0x38]
00485e68 : MOV EDX,dword ptr [EBP + -0x14]
00485e6b : MOVSS XMM0,dword ptr [0x00cdf718]
00485e73 : SUB EDI,ECX
00485e75 : SAR EDI,0x2
00485e78 : MOV EAX,EDI
00485e7a : CMP EAX,0x1
00485e7d : MOVSS dword ptr [EBP + 0x14],XMM0
00485e82 : JLE 0x00485f25
00485e88 : MOV ESI,dword ptr [EBP + 0xc]
00485e8b : MOV EBX,dword ptr [ESI + 0x4]
00485e8e : MOVSS XMM0,dword ptr [EBX + EDX*0x1]
00485e93 : XOR EDI,EDI
00485e95 : MOVSS dword ptr [EBP + -0x2c],XMM0
00485e9a : MOVSS XMM0,dword ptr [EBX + EDX*0x1 + 0x8]
00485ea0 : ADD EAX,-0x1
00485ea3 : MOVSS dword ptr [EBP + -0x24],XMM0
00485ea8 : MOV dword ptr [EBP + 0x8],EAX
00485eab : JS 0x00485f25
00485ead : LEA ECX,[ECX]
00485eb0 : MOV ESI,dword ptr [ECX + EDI*0x4]
00485eb3 : LEA EDX,[ESI + ESI*0x2]
00485eb6 : MOVSS XMM0,dword ptr [EBX + EDX*0x4]
00485ebb : SUBSS XMM0,dword ptr [EBP + -0x2c]
00485ec0 : MOVSS XMM1,dword ptr [EBX + EDX*0x4 + 0x8]
00485ec6 : SUBSS XMM1,dword ptr [EBP + -0x24]
00485ecb : LEA EAX,[EBX + EDX*0x4]
00485ece : MOVAPS XMM2,XMM0
00485ed1 : MULSS XMM2,XMM0
00485ed5 : MOVAPS XMM0,XMM1
00485ed8 : MULSS XMM0,XMM1
00485edc : PUSH ECX
00485edd : ADDSS XMM2,XMM0
00485ee1 : MOVSS dword ptr [ESP],XMM2
00485ee6 : CALL 0x0040f460
00485eeb : FST float ptr [EBP + 0xc]
00485eee : FLD float ptr [EBP + 0x14]
00485ef1 : ADD ESP,0x4
00485ef4 : FCOMIP ST0,ST1
00485ef6 : FSTP ST0
00485ef8 : JBE 0x00485f1c
00485efa : MOVSS XMM0,dword ptr [EBP + 0xc]
00485eff : UCOMISS XMM0,dword ptr [0x00b9b0b4]
00485f06 : LAHF
00485f07 : TEST AH,0x44
00485f0a : JNP 0x00485f1c
00485f0c : MOV EAX,dword ptr [EBP + 0x10]
00485f0f : INC EAX
00485f10 : CMP EDI,EAX
00485f12 : JZ 0x00485f1c
00485f14 : MOV dword ptr [EBP + -0x10],ESI
00485f17 : MOVSS dword ptr [EBP + 0x14],XMM0
00485f1c : MOV ECX,dword ptr [EBP + -0x38]
00485f1f : INC EDI
00485f20 : CMP EDI,dword ptr [EBP + 0x8]
00485f23 : JLE 0x00485eb0
00485f25 : MOV dword ptr [EBP + -0x4],0xffffffff
00485f2c : XOR EAX,EAX
00485f2e : CMP ECX,EAX
00485f30 : JZ 0x00485f39
00485f32 : CALL 0x006f04e0
00485f39 : MOV dword ptr [EBP + -0x38],EAX
00485f3c : MOV dword ptr [EBP + -0x34],EAX
00485f3f : MOV dword ptr [EBP + -0x30],EAX
00485f42 : MOV EAX,dword ptr [EBP + -0x10]
00485f45 : MOV ECX,dword ptr [EBP + -0xc]
00485f48 : MOV dword ptr FS:[0x0],ECX
00485f4f : POP ECX
00485f50 : POP EDI
00485f51 : POP ESI
00485f52 : POP EBX
00485f53 : MOV ESP,EBP
00485f55 : POP EBP
00485f56 : RET 0x10

PROGRAM  : Maestia.exe
FUNCTION : FUN_0068c2b0
ENTRY    : 0068c2b0
BODY     : [[0068c2b0, 0068c4d0]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_0068c2b0(int param_1,undefined4 param_2,int *param_3)

{
  char cVar1;
  char cVar2;
  code *in_EAX;
  int iVar3;
  int iVar4;
  int iVar5;
  size_t sVar6;
  undefined1 *_Dst;
  int local_28;
  int local_24;
  size_t local_20;
  size_t local_1c;
  int local_18;
  int local_14;
  size_t local_10;
  int local_c;
  code *local_8;
  undefined4 local_4;
  
  local_4 = *(undefined4 *)(param_1 + 0x1c);
  iVar3 = 0;
  _Dst = (undefined1 *)0x0;
  local_28 = 0;
  if (in_EAX == (code *)0x0) {
    local_28 = 6;
  }
  else {
    local_20 = 0x400;
    _Dst = (undefined1 *)FUN_0068a220(local_4,1,0,0x400,0,&local_28);
    if (local_28 == 0) {
      iVar4 = 0;
      local_14 = 1;
      *_Dst = 0;
      local_24 = 0;
      local_1c = 0;
      local_c = 1;
      local_10 = 0;
      local_8 = in_EAX;
      do {
        local_18 = 0x100;
LAB_0068c336:
        sVar6 = local_1c;
        if (local_c != 0) {
          local_10 = FUN_006878c0(param_1,_Dst + local_1c,local_20 - local_1c);
          iVar3 = local_10 + sVar6;
          local_1c = 0;
          local_c = 0;
          local_24 = iVar3;
        }
        if (iVar3 <= iVar4) goto LAB_0068c3a1;
        iVar5 = iVar4;
        if ((char)_Dst[iVar4] != local_18) goto LAB_0068c387;
        iVar4 = iVar4 + 1;
      } while( true );
    }
  }
LAB_0068c4b8:
  FUN_00687f30(local_4,_Dst);
  return local_28;
LAB_0068c387:
  do {
    if ((_Dst[iVar5] == '\n') || (_Dst[iVar5] == '\r')) {
      if (iVar5 < iVar3) {
        cVar1 = _Dst[iVar5];
        _Dst[iVar5] = 0;
        cVar2 = _Dst[iVar4];
        if ((((cVar2 != '#') && (cVar2 != '\x1a')) && (iVar4 < iVar5)) &&
           (local_28 = (*local_8)(_Dst + iVar4,iVar5 - iVar4,local_14,&local_8,param_2),
           local_28 != 0)) goto LAB_0068c4ad;
        local_14 = local_14 + 1;
        _Dst[iVar5] = cVar1;
        iVar4 = iVar5 + 1;
        iVar3 = local_24;
        if (cVar1 == '\n') {
          local_18 = 0xd;
        }
        else {
          local_18 = (-(uint)(cVar1 != '\r') & 0xf6) + 10;
        }
        goto LAB_0068c336;
      }
      break;
    }
    iVar5 = iVar5 + 1;
  } while (iVar5 < iVar3);
LAB_0068c3a1:
  if (local_10 == 0) {
LAB_0068c4ad:
    *param_3 = local_14;
    goto LAB_0068c4b8;
  }
  if (iVar4 == 0) {
    if (0xffff < local_20) {
      local_28 = 6;
      goto LAB_0068c4b8;
    }
    sVar6 = local_20 * 2;
    _Dst = (undefined1 *)FUN_0068a220(local_4,1,local_20,sVar6,_Dst,&local_28);
    if (local_28 != 0) goto LAB_0068c4b8;
    local_1c = local_20;
    local_c = 1;
    local_20 = sVar6;
  }
  else {
    sVar6 = iVar3 - iVar4;
    local_10 = sVar6;
    _memcpy(_Dst,_Dst + iVar4,sVar6);
    local_24 = iVar3 - sVar6;
    iVar4 = 0;
    local_c = 1;
    iVar3 = local_24;
    local_1c = sVar6;
  }
  goto LAB_0068c336;
}



============================================================
DISASSEMBLY
============================================================
0068c2b0 : SUB ESP,0x28
0068c2b3 : PUSH EBX
0068c2b4 : PUSH ESI
0068c2b5 : MOV ESI,EAX
0068c2b7 : MOV EAX,dword ptr [ESP + 0x34]
0068c2bb : MOV EAX,dword ptr [EAX + 0x1c]
0068c2be : XOR EBX,EBX
0068c2c0 : PUSH EDI
0068c2c1 : XOR EDI,EDI
0068c2c3 : MOV dword ptr [ESP + 0x30],EAX
0068c2c7 : MOV dword ptr [ESP + 0xc],EBX
0068c2cb : CMP ESI,EBX
0068c2cd : JNZ 0x0068c2dc
0068c2cf : MOV dword ptr [ESP + 0xc],0x6
0068c2d7 : JMP 0x0068c4b8
0068c2dc : LEA ECX,[ESP + 0xc]
0068c2e0 : PUSH ECX
0068c2e1 : PUSH EBX
0068c2e2 : PUSH 0x400
0068c2e7 : PUSH EBX
0068c2e8 : PUSH 0x1
0068c2ea : PUSH EAX
0068c2eb : MOV dword ptr [ESP + 0x2c],0x400
0068c2f3 : CALL 0x0068a220
0068c2f8 : ADD ESP,0x18
0068c2fb : MOV EDI,EAX
0068c2fd : CMP dword ptr [ESP + 0xc],EBX
0068c301 : JNZ 0x0068c4b8
0068c307 : PUSH EBP
0068c308 : XOR EBP,EBP
0068c30a : XOR EAX,EAX
0068c30c : MOV dword ptr [ESP + 0x30],ESI
0068c310 : MOV dword ptr [ESP + 0x24],0x1
0068c318 : MOV byte ptr [EDI],BL
0068c31a : MOV dword ptr [ESP + 0x14],EBX
0068c31e : MOV dword ptr [ESP + 0x1c],EAX
0068c322 : MOV dword ptr [ESP + 0x2c],0x1
0068c32a : MOV dword ptr [ESP + 0x28],EAX
0068c32e : MOV dword ptr [ESP + 0x20],0x100
0068c336 : CMP dword ptr [ESP + 0x2c],0x0
0068c33b : JZ 0x0068c371
0068c33d : MOV ESI,dword ptr [ESP + 0x1c]
0068c341 : MOV EDX,dword ptr [ESP + 0x18]
0068c345 : MOV ECX,dword ptr [ESP + 0x3c]
0068c349 : SUB EDX,ESI
0068c34b : PUSH EDX
0068c34c : LEA EAX,[ESI + EDI*0x1]
0068c34f : PUSH EAX
0068c350 : PUSH ECX
0068c351 : CALL 0x006878c0
0068c356 : MOV dword ptr [ESP + 0x34],EAX
0068c35a : ADD EAX,ESI
0068c35c : MOV dword ptr [ESP + 0x20],EAX
0068c360 : MOV EBX,dword ptr [ESP + 0x20]
0068c364 : ADD ESP,0xc
0068c367 : XOR EAX,EAX
0068c369 : MOV dword ptr [ESP + 0x1c],EAX
0068c36d : MOV dword ptr [ESP + 0x2c],EAX
0068c371 : CMP EBP,EBX
0068c373 : MOV ESI,EBP
0068c375 : JGE 0x0068c3a1
0068c377 : MOVSX EDX,byte ptr [EDI + EBP*0x1]
0068c37b : LEA ECX,[EDI + EBP*0x1]
0068c37e : CMP EDX,dword ptr [ESP + 0x20]
0068c382 : JNZ 0x0068c387
0068c384 : INC EBP
0068c385 : JMP 0x0068c32e
0068c387 : MOV AL,byte ptr [ESI + EDI*0x1]
0068c38a : CMP AL,0xa
0068c38c : JZ 0x0068c399
0068c38e : CMP AL,0xd
0068c390 : JZ 0x0068c399
0068c392 : INC ESI
0068c393 : CMP ESI,EBX
0068c395 : JL 0x0068c387
0068c397 : JMP 0x0068c3a1
0068c399 : CMP ESI,EBX
0068c39b : JL 0x0068c42c
0068c3a1 : CMP dword ptr [ESP + 0x28],0x0
0068c3a6 : JZ 0x0068c4ad
0068c3ac : TEST EBP,EBP
0068c3ae : JNZ 0x0068c3fe
0068c3b0 : MOV EAX,dword ptr [ESP + 0x18]
0068c3b4 : CMP EAX,0x10000
0068c3b9 : JNC 0x0068c4a3
0068c3bf : MOV EDX,dword ptr [ESP + 0x34]
0068c3c3 : LEA ECX,[ESP + 0x10]
0068c3c7 : PUSH ECX
0068c3c8 : PUSH EDI
0068c3c9 : LEA ESI,[EAX + EAX*0x1]
0068c3cc : PUSH ESI
0068c3cd : PUSH EAX
0068c3ce : PUSH 0x1
0068c3d0 : PUSH EDX
0068c3d1 : CALL 0x0068a220
0068c3d6 : ADD ESP,0x18
0068c3d9 : MOV EDI,EAX
0068c3db : CMP dword ptr [ESP + 0x10],EBP
0068c3df : JNZ 0x0068c4b7
0068c3e5 : MOV EAX,dword ptr [ESP + 0x18]
0068c3e9 : MOV dword ptr [ESP + 0x1c],EAX
0068c3ed : MOV dword ptr [ESP + 0x18],ESI
0068c3f1 : MOV dword ptr [ESP + 0x2c],0x1
0068c3f9 : JMP 0x0068c336
0068c3fe : MOV ESI,EBX
0068c400 : SUB ESI,EBP
0068c402 : PUSH ESI
0068c403 : ADD EBP,EDI
0068c405 : PUSH EBP
0068c406 : PUSH EDI
0068c407 : MOV dword ptr [ESP + 0x34],ESI
0068c40b : CALL 0x0063ae40
0068c410 : SUB EBX,ESI
0068c412 : ADD ESP,0xc
0068c415 : MOV dword ptr [ESP + 0x1c],ESI
0068c419 : MOV dword ptr [ESP + 0x14],EBX
0068c41d : XOR EBP,EBP
0068c41f : MOV dword ptr [ESP + 0x2c],0x1
0068c427 : JMP 0x0068c336
0068c42c : MOVSX EBX,byte ptr [ESI + EDI*0x1]
0068c430 : MOV byte ptr [ESI + EDI*0x1],0x0
0068c434 : MOV AL,byte ptr [ECX]
0068c436 : CMP AL,0x23
0068c438 : JZ 0x0068c466
0068c43a : CMP AL,0x1a
0068c43c : JZ 0x0068c466
0068c43e : CMP ESI,EBP
0068c440 : JLE 0x0068c466
0068c442 : MOV EDX,dword ptr [ESP + 0x40]
0068c446 : PUSH EDX
0068c447 : MOV EDX,dword ptr [ESP + 0x28]
0068c44b : LEA EAX,[ESP + 0x34]
0068c44f : PUSH EAX
0068c450 : PUSH EDX
0068c451 : MOV EAX,ESI
0068c453 : SUB EAX,EBP
0068c455 : PUSH EAX
0068c456 : PUSH ECX
0068c457 : CALL dword ptr [ESP + 0x44]
0068c45b : ADD ESP,0x14
0068c45e : MOV dword ptr [ESP + 0x10],EAX
0068c462 : TEST EAX,EAX
0068c464 : JNZ 0x0068c4ad
0068c466 : INC dword ptr [ESP + 0x24]
0068c46a : MOV byte ptr [ESI + EDI*0x1],BL
0068c46d : LEA EBP,[ESI + 0x1]
0068c470 : CMP EBX,0xa
0068c473 : JNZ 0x0068c486
0068c475 : MOV EBX,dword ptr [ESP + 0x14]
0068c479 : MOV dword ptr [ESP + 0x20],0xd
0068c481 : JMP 0x0068c336
0068c486 : SUB EBX,0xd
0068c489 : NEG EBX
0068c48b : SBB EBX,EBX
0068c48d : AND EBX,0xf6
0068c493 : ADD EBX,0xa
0068c496 : MOV dword ptr [ESP + 0x20],EBX
0068c49a : MOV EBX,dword ptr [ESP + 0x14]
0068c49e : JMP 0x0068c336
0068c4a3 : MOV dword ptr [ESP + 0x10],0x6
0068c4ab : JMP 0x0068c4b7
0068c4ad : MOV ECX,dword ptr [ESP + 0x44]
0068c4b1 : MOV EDX,dword ptr [ESP + 0x24]
0068c4b5 : MOV dword ptr [ECX],EDX
0068c4b7 : POP EBP
0068c4b8 : MOV EAX,dword ptr [ESP + 0x30]
0068c4bc : PUSH EDI
0068c4bd : PUSH EAX
0068c4be : CALL 0x00687f30
0068c4c3 : MOV EAX,dword ptr [ESP + 0x14]
0068c4c7 : ADD ESP,0x8
0068c4ca : POP EDI
0068c4cb : POP ESI
0068c4cc : POP EBX
0068c4cd : ADD ESP,0x28
0068c4d0 : RET

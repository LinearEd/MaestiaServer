PROGRAM  : Maestia.exe
FUNCTION : FUN_00522070
ENTRY    : 00522070
BODY     : [[00522070, 00522196]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00522070(undefined4 param_1,uint *param_2,uint param_3)

{
  uint *puVar1;
  uint *puVar2;
  int *piVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  int *in_ECX;
  uint uVar7;
  
  FUN_00522340(param_1);
  piVar3 = (int *)*in_ECX;
  param_3 = param_3 & piVar3[1];
  *piVar3 = *piVar3 + 1;
  iVar4 = *in_ECX;
  iVar5 = *(int *)(iVar4 + 8 + param_3 * 0x24);
  puVar1 = (uint *)(iVar4 + 8 + param_3 * 0x24);
  if (iVar5 == -2) {
    *puVar1 = 0xffffffff;
    FUN_005213f0(param_2);
    puVar1[1] = param_3;
    return;
  }
  uVar7 = param_3;
  do {
    uVar7 = uVar7 + 1 & *(uint *)(iVar4 + 4);
  } while (*(int *)(iVar4 + 8 + uVar7 * 0x24) != -2);
  uVar6 = puVar1[1];
  piVar3 = (int *)(iVar4 + 8 + uVar7 * 0x24);
  if (uVar6 != param_3) {
    puVar2 = (uint *)(iVar4 + 8 + uVar6 * 0x24);
    for (uVar6 = *(uint *)(iVar4 + 8 + uVar6 * 0x24); uVar6 != param_3;
        uVar6 = *(uint *)(iVar4 + 8 + uVar6 * 0x24)) {
      uVar6 = *puVar2;
      puVar2 = (uint *)(iVar4 + 8 + uVar6 * 0x24);
    }
    if (piVar3 != (int *)0x0) {
      *piVar3 = iVar5;
      piVar3[1] = puVar1[1];
      FUN_005213f0(puVar1 + 2);
    }
    *puVar2 = uVar7;
    puVar1[2] = *param_2;
    puVar1[3] = param_2[1];
    puVar1[4] = param_2[2];
    puVar1[5] = param_2[3];
    FUN_0051f920(param_2 + 4);
    puVar1[1] = param_3;
    *puVar1 = 0xffffffff;
    return;
  }
  if (piVar3 != (int *)0x0) {
    *piVar3 = iVar5;
    piVar3[1] = puVar1[1];
    FUN_005213f0(puVar1 + 2);
  }
  puVar1[2] = *param_2;
  puVar1[3] = param_2[1];
  puVar1[4] = param_2[2];
  puVar1[5] = param_2[3];
  FUN_0051f920(param_2 + 4);
  *puVar1 = uVar7;
  puVar1[1] = param_3;
  return;
}



============================================================
DISASSEMBLY
============================================================
00522070 : MOV EAX,dword ptr [ESP + 0x4]
00522074 : PUSH ESI
00522075 : PUSH EDI
00522076 : PUSH EAX
00522077 : MOV ESI,ECX
00522079 : CALL 0x00522340
0052207e : MOV EAX,dword ptr [ESI]
00522080 : MOV EDI,dword ptr [ESP + 0x14]
00522084 : AND EDI,dword ptr [EAX + 0x4]
00522087 : INC dword ptr [EAX]
00522089 : MOV EAX,dword ptr [ESI]
0052208b : LEA ECX,[EDI + EDI*0x8]
0052208e : MOV EDX,dword ptr [EAX + ECX*0x4 + 0x8]
00522092 : LEA ESI,[EAX + ECX*0x4 + 0x8]
00522096 : CMP EDX,-0x2
00522099 : JNZ 0x005220b6
0052209b : MOV EDX,dword ptr [ESP + 0x10]
0052209f : PUSH EDX
005220a0 : LEA ECX,[ESI + 0x8]
005220a3 : MOV dword ptr [ESI],0xffffffff
005220a9 : CALL 0x005213f0
005220ae : MOV dword ptr [ESI + 0x4],EDI
005220b1 : POP EDI
005220b2 : POP ESI
005220b3 : RET 0xc
005220b6 : MOV ECX,dword ptr [EAX + 0x4]
005220b9 : PUSH EBX
005220ba : MOV EBX,EDI
005220bc : PUSH EBP
005220bd : LEA ECX,[ECX]
005220c0 : INC EBX
005220c1 : AND EBX,ECX
005220c3 : LEA EBP,[EBX + EBX*0x8]
005220c6 : CMP dword ptr [EAX + EBP*0x4 + 0x8],-0x2
005220cb : JNZ 0x005220c0
005220cd : MOV EBP,dword ptr [ESI + 0x4]
005220d0 : LEA ECX,[EBX + EBX*0x8]
005220d3 : LEA ECX,[EAX + ECX*0x4 + 0x8]
005220d7 : CMP EBP,EDI
005220d9 : JNZ 0x00522126
005220db : TEST ECX,ECX
005220dd : JZ 0x005220f3
005220df : MOV dword ptr [ECX],EDX
005220e1 : MOV EDX,dword ptr [ESI + 0x4]
005220e4 : LEA EAX,[ESI + 0x8]
005220e7 : MOV dword ptr [ECX + 0x4],EDX
005220ea : PUSH EAX
005220eb : ADD ECX,0x8
005220ee : CALL 0x005213f0
005220f3 : MOV EAX,dword ptr [ESP + 0x18]
005220f7 : MOV ECX,dword ptr [EAX]
005220f9 : MOV dword ptr [ESI + 0x8],ECX
005220fc : MOV EDX,dword ptr [EAX + 0x4]
005220ff : MOV dword ptr [ESI + 0xc],EDX
00522102 : MOV ECX,dword ptr [EAX + 0x8]
00522105 : MOV dword ptr [ESI + 0x10],ECX
00522108 : MOV EDX,dword ptr [EAX + 0xc]
0052210b : ADD EAX,0x10
0052210e : PUSH EAX
0052210f : LEA ECX,[ESI + 0x18]
00522112 : MOV dword ptr [ESI + 0x14],EDX
00522115 : CALL 0x0051f920
0052211a : POP EBP
0052211b : MOV dword ptr [ESI],EBX
0052211d : POP EBX
0052211e : MOV dword ptr [ESI + 0x4],EDI
00522121 : POP EDI
00522122 : POP ESI
00522123 : RET 0xc
00522126 : LEA EBP,[EBP + EBP*0x8]
0052212a : CMP dword ptr [EAX + EBP*0x4 + 0x8],EDI
0052212e : LEA EBP,[EAX + EBP*0x4 + 0x8]
00522132 : JZ 0x00522145
00522134 : MOV EBP,dword ptr [EBP]
00522137 : LEA EBP,[EBP + EBP*0x8]
0052213b : CMP dword ptr [EAX + EBP*0x4 + 0x8],EDI
0052213f : LEA EBP,[EAX + EBP*0x4 + 0x8]
00522143 : JNZ 0x00522134
00522145 : TEST ECX,ECX
00522147 : JZ 0x0052215d
00522149 : MOV dword ptr [ECX],EDX
0052214b : MOV EAX,dword ptr [ESI + 0x4]
0052214e : LEA EDX,[ESI + 0x8]
00522151 : MOV dword ptr [ECX + 0x4],EAX
00522154 : PUSH EDX
00522155 : ADD ECX,0x8
00522158 : CALL 0x005213f0
0052215d : MOV EAX,dword ptr [ESP + 0x18]
00522161 : MOV dword ptr [EBP],EBX
00522164 : MOV ECX,dword ptr [EAX]
00522166 : MOV dword ptr [ESI + 0x8],ECX
00522169 : MOV EDX,dword ptr [EAX + 0x4]
0052216c : MOV dword ptr [ESI + 0xc],EDX
0052216f : MOV ECX,dword ptr [EAX + 0x8]
00522172 : MOV dword ptr [ESI + 0x10],ECX
00522175 : MOV EDX,dword ptr [EAX + 0xc]
00522178 : ADD EAX,0x10
0052217b : PUSH EAX
0052217c : LEA ECX,[ESI + 0x18]
0052217f : MOV dword ptr [ESI + 0x14],EDX
00522182 : CALL 0x0051f920
00522187 : POP EBP
00522188 : POP EBX
00522189 : MOV dword ptr [ESI + 0x4],EDI
0052218c : POP EDI
0052218d : MOV dword ptr [ESI],0xffffffff
00522193 : POP ESI
00522194 : RET 0xc

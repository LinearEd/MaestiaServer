PROGRAM  : Maestia.exe
FUNCTION : FUN_007d7590
ENTRY    : 007d7590
BODY     : [[007d7590, 007d7853]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007d7590(undefined4 param_1,int param_2)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int *piVar3;
  int *piVar4;
  char cVar5;
  uint uVar6;
  int iVar7;
  int *in_ECX;
  uint uVar8;
  undefined **appuStack_9c [34];
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_00b28ced;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  uVar6 = (**(code **)(*in_ECX + 0x78))(DAT_00d66fa0 ^ (uint)&stack0xffffff48);
  uVar6 = uVar6 & 0xff;
  cVar5 = (**(code **)(*in_ECX + 0x7c))();
  if ((uVar6 != 0) || (cVar5 != '\0')) {
    if (param_2 != 1) {
      FUN_0043d910(appuStack_9c);
      uStack_c = 0;
      param_2 = FUN_007828a0(param_1,uVar6);
      uStack_c = 0xffffffff;
      appuStack_9c[0] = &PTR_FUN_00cd083c;
      if (param_2 == 0) {
        ExceptionList = local_14;
        return;
      }
    }
    if ((param_2 != 3) || (uVar6 != 0)) {
      if (in_ECX[2] != 0) {
        EnterCriticalSection((LPCRITICAL_SECTION)(in_ECX[2] + 4));
      }
      uStack_c = 1;
      puVar1 = (undefined4 *)in_ECX[0xe];
      for (puVar2 = (undefined4 *)*puVar1; puVar2 != puVar1; puVar2 = (undefined4 *)*puVar2) {
        if (((int *)puVar2[9])[1] == 0x12345678) {
          (**(code **)(*(int *)puVar2[9] + 0x8c))(param_1,param_2);
        }
        else {
          FUN_008018d0(L"AvaSceneNode::AddEntitiesShadowMapRecursive Invalid pNode !!");
        }
      }
      uStack_c = 0xffffffff;
      if (in_ECX[2] != 0) {
        LeaveCriticalSection((LPCRITICAL_SECTION)(in_ECX[2] + 4));
      }
      if (*(char *)((int)in_ECX + 0x2bd) == '\0') {
        if (in_ECX[2] != 0) {
          EnterCriticalSection((LPCRITICAL_SECTION)(in_ECX[2] + 4));
        }
        uStack_c = 2;
        if (((char)in_ECX[0xaf] == '\0') || (piVar4 = in_ECX + 0xad, piVar4 == (int *)0x0)) {
          puVar1 = (undefined4 *)in_ECX[0x62];
          for (puVar2 = (undefined4 *)*puVar1; puVar2 != puVar1; puVar2 = (undefined4 *)*puVar2) {
            piVar4 = (int *)puVar2[9];
            if ((*(char *)((int)piVar4 + 0x71) != '\0') &&
               (iVar7 = (**(code **)(*piVar4 + 4))(), iVar7 == 2)) {
              if (param_2 != 1) {
                uVar8 = uVar6;
                (**(code **)(*piVar4 + 0x2c))(uVar6);
                iVar7 = FUN_007828a0(param_1,uVar8);
                if (iVar7 == 0) goto LAB_007d7810;
              }
              FUN_00783520(param_1,piVar4,uVar6,param_2);
            }
LAB_007d7810:
          }
        }
        else {
          piVar3 = (int *)in_ECX[0xae];
          if ((piVar3 == (int *)0x0) || (*(char *)((int)piVar3 + 0x71) == '\0')) {
            piVar3 = (int *)*piVar4;
            if ((piVar3 != (int *)0x0) && (*(char *)((int)piVar3 + 0x71) != '\0')) {
              iVar7 = 1;
              if (param_2 != 1) {
                uVar8 = uVar6;
                (**(code **)(*piVar3 + 0x2c))(uVar6);
                iVar7 = FUN_007828a0(param_1,uVar8);
              }
              if (iVar7 != 0) {
                FUN_00783520(param_1,*piVar4,uVar6,param_2);
              }
            }
          }
          else {
            iVar7 = 1;
            if (param_2 != 1) {
              uVar8 = uVar6;
              (**(code **)(*piVar3 + 0x2c))(uVar6);
              iVar7 = FUN_007828a0(param_1,uVar8);
            }
            if (iVar7 != 0) {
              FUN_00783520(param_1,in_ECX[0xae],uVar6,param_2);
            }
          }
        }
        uStack_c = 0xffffffff;
        if (in_ECX[2] != 0) {
          LeaveCriticalSection((LPCRITICAL_SECTION)(in_ECX[2] + 4));
        }
      }
    }
  }
  ExceptionList = local_14;
  return;
}



============================================================
DISASSEMBLY
============================================================
007d7590 : PUSH EBP
007d7591 : MOV EBP,ESP
007d7593 : AND ESP,0xfffffff8
007d7596 : PUSH -0x1
007d7598 : PUSH 0xb28ced
007d759d : MOV EAX,FS:[0x0]
007d75a3 : PUSH EAX
007d75a4 : SUB ESP,0x98
007d75aa : PUSH EBX
007d75ab : PUSH ESI
007d75ac : PUSH EDI
007d75ad : MOV EAX,[0x00d66fa0]
007d75b2 : XOR EAX,ESP
007d75b4 : PUSH EAX
007d75b5 : LEA EAX,[ESP + 0xa8]
007d75bc : MOV FS:[0x0],EAX
007d75c2 : MOV EDI,ECX
007d75c4 : MOV EAX,dword ptr [EDI]
007d75c6 : MOV EDX,dword ptr [EAX + 0x78]
007d75c9 : CALL EDX
007d75cb : MOVZX ESI,AL
007d75ce : MOV EAX,dword ptr [EDI]
007d75d0 : MOV EDX,dword ptr [EAX + 0x7c]
007d75d3 : MOV ECX,EDI
007d75d5 : MOV dword ptr [ESP + 0x10],ESI
007d75d9 : CALL EDX
007d75db : MOVZX EAX,AL
007d75de : TEST ESI,ESI
007d75e0 : JNZ 0x007d75ea
007d75e2 : TEST EAX,EAX
007d75e4 : JZ 0x007d783c
007d75ea : MOV EBX,0x1
007d75ef : CMP dword ptr [EBP + 0xc],EBX
007d75f2 : JZ 0x007d7633
007d75f4 : LEA EAX,[ESP + 0x20]
007d75f8 : PUSH EAX
007d75f9 : MOV ECX,EDI
007d75fb : CALL 0x0043d910
007d7600 : MOV dword ptr [ESP + 0xb0],0x0
007d760b : MOV ECX,dword ptr [EBP + 0x8]
007d760e : PUSH ESI
007d760f : PUSH ECX
007d7610 : CALL 0x007828a0
007d7615 : MOV dword ptr [EBP + 0xc],EAX
007d7618 : MOV dword ptr [ESP + 0xb0],0xffffffff
007d7623 : MOV dword ptr [ESP + 0x20],0xcd083c
007d762b : TEST EAX,EAX
007d762d : JZ 0x007d783c
007d7633 : CMP dword ptr [EBP + 0xc],0x3
007d7637 : JNZ 0x007d7641
007d7639 : TEST ESI,ESI
007d763b : JZ 0x007d783c
007d7641 : MOV EAX,dword ptr [EDI + 0x8]
007d7644 : MOV dword ptr [ESP + 0x18],EDI
007d7648 : TEST EAX,EAX
007d764a : JZ 0x007d7656
007d764c : ADD EAX,0x4
007d764f : PUSH EAX
007d7650 : CALL dword ptr [0x00b85118]
007d7656 : MOV dword ptr [ESP + 0xb0],EBX
007d765d : MOV ESI,dword ptr [EDI + 0x38]
007d7660 : MOV EBX,dword ptr [ESI]
007d7662 : MOV dword ptr [ESP + 0x14],ESI
007d7666 : CMP EBX,ESI
007d7668 : JZ 0x007d76ad
007d766a : LEA EBX,[EBX]
007d7670 : MOV ECX,dword ptr [EBX + 0x24]
007d7673 : CMP dword ptr [ECX + 0x4],0x12345678
007d767a : JNZ 0x007d7690
007d767c : MOV EAX,dword ptr [EBP + 0xc]
007d767f : MOV EDX,dword ptr [ECX]
007d7681 : MOV EDX,dword ptr [EDX + 0x8c]
007d7687 : PUSH EAX
007d7688 : MOV EAX,dword ptr [EBP + 0x8]
007d768b : PUSH EAX
007d768c : CALL EDX
007d768e : JMP 0x007d76a7
007d7690 : MOV ESI,dword ptr [0x00da98e8]
007d7696 : PUSH 0xc20308
007d769b : CALL 0x008018d0
007d76a0 : MOV ESI,dword ptr [ESP + 0x18]
007d76a4 : ADD ESP,0x4
007d76a7 : MOV EBX,dword ptr [EBX]
007d76a9 : CMP EBX,ESI
007d76ab : JNZ 0x007d7670
007d76ad : MOV dword ptr [ESP + 0xb0],0xffffffff
007d76b8 : MOV EAX,dword ptr [EDI + 0x8]
007d76bb : TEST EAX,EAX
007d76bd : JZ 0x007d76c9
007d76bf : ADD EAX,0x4
007d76c2 : PUSH EAX
007d76c3 : CALL dword ptr [0x00b8511c]
007d76c9 : CMP byte ptr [EDI + 0x2bd],0x0
007d76d0 : JNZ 0x007d783c
007d76d6 : MOV EAX,dword ptr [EDI + 0x8]
007d76d9 : MOV dword ptr [ESP + 0x1c],EDI
007d76dd : TEST EAX,EAX
007d76df : JZ 0x007d76eb
007d76e1 : ADD EAX,0x4
007d76e4 : PUSH EAX
007d76e5 : CALL dword ptr [0x00b85118]
007d76eb : MOV dword ptr [ESP + 0xb0],0x2
007d76f6 : CMP byte ptr [EDI + 0x2bc],0x0
007d76fd : JZ 0x007d77af
007d7703 : LEA EBX,[EDI + 0x2b4]
007d7709 : TEST EBX,EBX
007d770b : JZ 0x007d77af
007d7711 : MOV ECX,dword ptr [EDI + 0x2b8]
007d7717 : MOV EDX,dword ptr [EBP + 0xc]
007d771a : MOV EAX,EDX
007d771c : TEST ECX,ECX
007d771e : JZ 0x007d7764
007d7720 : CMP byte ptr [ECX + 0x71],0x0
007d7724 : JZ 0x007d7764
007d7726 : MOV ESI,dword ptr [ESP + 0x10]
007d772a : CMP EDX,0x1
007d772d : JZ 0x007d7743
007d772f : MOV EAX,dword ptr [ECX]
007d7731 : MOV EDX,dword ptr [EAX + 0x2c]
007d7734 : PUSH ESI
007d7735 : CALL EDX
007d7737 : MOV ECX,dword ptr [EBP + 0x8]
007d773a : PUSH ECX
007d773b : CALL 0x007828a0
007d7740 : MOV EDX,dword ptr [EBP + 0xc]
007d7743 : TEST EAX,EAX
007d7745 : JZ 0x007d7820
007d774b : MOV EAX,dword ptr [EBP + 0x8]
007d774e : PUSH EDX
007d774f : MOV EDX,dword ptr [EDI + 0x2b8]
007d7755 : PUSH ESI
007d7756 : PUSH EDX
007d7757 : PUSH EAX
007d7758 : MOV EAX,ESI
007d775a : CALL 0x00783520
007d775f : JMP 0x007d7820
007d7764 : MOV ECX,dword ptr [EBX]
007d7766 : TEST ECX,ECX
007d7768 : JZ 0x007d7820
007d776e : CMP byte ptr [ECX + 0x71],0x0
007d7772 : JZ 0x007d7820
007d7778 : MOV ESI,dword ptr [ESP + 0x10]
007d777c : CMP EDX,0x1
007d777f : JZ 0x007d7795
007d7781 : MOV EDX,dword ptr [ECX]
007d7783 : MOV EAX,dword ptr [EDX + 0x2c]
007d7786 : PUSH ESI
007d7787 : CALL EAX
007d7789 : MOV ECX,dword ptr [EBP + 0x8]
007d778c : PUSH ECX
007d778d : CALL 0x007828a0
007d7792 : MOV EDX,dword ptr [EBP + 0xc]
007d7795 : TEST EAX,EAX
007d7797 : JZ 0x007d7820
007d779d : MOV EAX,dword ptr [EBP + 0x8]
007d77a0 : PUSH EDX
007d77a1 : MOV EDX,dword ptr [EBX]
007d77a3 : PUSH ESI
007d77a4 : PUSH EDX
007d77a5 : PUSH EAX
007d77a6 : MOV EAX,ESI
007d77a8 : CALL 0x00783520
007d77ad : JMP 0x007d7820
007d77af : MOV EAX,dword ptr [EDI + 0x188]
007d77b5 : MOV ECX,dword ptr [EAX]
007d77b7 : MOV dword ptr [ESP + 0x18],EAX
007d77bb : MOV dword ptr [ESP + 0x14],ECX
007d77bf : CMP ECX,EAX
007d77c1 : JZ 0x007d7820
007d77c3 : MOV ECX,dword ptr [ESP + 0x14]
007d77c7 : MOV ESI,dword ptr [ECX + 0x24]
007d77ca : CMP byte ptr [ESI + 0x71],0x0
007d77ce : JZ 0x007d7810
007d77d0 : MOV EDX,dword ptr [ESI]
007d77d2 : MOV EAX,dword ptr [EDX + 0x4]
007d77d5 : MOV ECX,ESI
007d77d7 : CALL EAX
007d77d9 : CMP EAX,0x2
007d77dc : JNZ 0x007d7810
007d77de : CMP dword ptr [EBP + 0xc],0x1
007d77e2 : MOV EBX,dword ptr [ESP + 0x10]
007d77e6 : JZ 0x007d77ff
007d77e8 : MOV EDX,dword ptr [ESI]
007d77ea : MOV EAX,dword ptr [EDX + 0x2c]
007d77ed : PUSH EBX
007d77ee : MOV ECX,ESI
007d77f0 : CALL EAX
007d77f2 : MOV ECX,dword ptr [EBP + 0x8]
007d77f5 : PUSH ECX
007d77f6 : CALL 0x007828a0
007d77fb : TEST EAX,EAX
007d77fd : JZ 0x007d7810
007d77ff : MOV EDX,dword ptr [EBP + 0xc]
007d7802 : MOV EAX,dword ptr [EBP + 0x8]
007d7805 : PUSH EDX
007d7806 : PUSH EBX
007d7807 : PUSH ESI
007d7808 : PUSH EAX
007d7809 : MOV EAX,EBX
007d780b : CALL 0x00783520
007d7810 : MOV ECX,dword ptr [ESP + 0x14]
007d7814 : MOV EAX,dword ptr [ECX]
007d7816 : MOV dword ptr [ESP + 0x14],EAX
007d781a : CMP EAX,dword ptr [ESP + 0x18]
007d781e : JNZ 0x007d77c3
007d7820 : MOV dword ptr [ESP + 0xb0],0xffffffff
007d782b : MOV EDI,dword ptr [EDI + 0x8]
007d782e : TEST EDI,EDI
007d7830 : JZ 0x007d783c
007d7832 : ADD EDI,0x4
007d7835 : PUSH EDI
007d7836 : CALL dword ptr [0x00b8511c]
007d783c : MOV ECX,dword ptr [ESP + 0xa8]
007d7843 : MOV dword ptr FS:[0x0],ECX
007d784a : POP ECX
007d784b : POP EDI
007d784c : POP ESI
007d784d : POP EBX
007d784e : MOV ESP,EBP
007d7850 : POP EBP
007d7851 : RET 0x8

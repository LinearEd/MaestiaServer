PROGRAM  : Maestia.exe
FUNCTION : FUN_00803490
ENTRY    : 00803490
BODY     : [[00803490, 008036e4]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x00803640) */
/* WARNING: Removing unreachable block (ram,0x008036ad) */
/* WARNING: Removing unreachable block (ram,0x0080367d) */
/* WARNING: Removing unreachable block (ram,0x0080360a) */

void FUN_00803490(int param_1,int param_2)

{
  LPCRITICAL_SECTION lpCriticalSection;
  int *piVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b43894;
  local_10 = ExceptionList;
  uVar5 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  FUN_00406360();
  local_8 = 0;
  lpCriticalSection = (LPCRITICAL_SECTION)(param_1 + 0xb8);
  EnterCriticalSection(lpCriticalSection);
  local_8._0_1_ = 1;
  if (*(char *)(param_1 + 0x94) == '\0') {
    piVar1 = *(int **)(param_1 + 0x4c);
    piVar2 = (int *)*piVar1;
    while (piVar2 != piVar1) {
      iVar3 = piVar2[3];
      iVar4 = piVar2[4];
      if (((iVar3 != 0) && (iVar4 != 0)) &&
         (iVar6 = *(int *)(iVar4 + 4), iVar6 != *(int *)(iVar4 + 8))) {
        do {
          FUN_00405eb0(iVar6,0,0xffffffff);
          local_8._0_1_ = 1;
          FUN_00a5fb10(iVar3);
          FUN_008022f0();
          iVar6 = iVar6 + 0x1c;
        } while (iVar6 != *(int *)(iVar4 + 8));
      }
      FUN_00416210();
      piVar1 = *(int **)(param_1 + 0x4c);
    }
    *(undefined1 *)(param_1 + 0x94) = 1;
  }
  FUN_00405eb0();
  local_8._0_1_ = 3;
  FUN_0070c1f0();
  FUN_0044f270();
  if ((param_2 != *(int *)(param_1 + 0x70)) && (*(int *)(param_2 + 0x40) != 0)) {
    if (*(int *)(param_2 + 0x44) != 0) {
      FUN_00449300();
      local_8 = (uint)local_8._1_3_ << 8;
      LeaveCriticalSection(lpCriticalSection);
      goto LAB_008036c7;
    }
    FUN_008018d0();
  }
  local_8 = (uint)local_8._1_3_ << 8;
  LeaveCriticalSection(lpCriticalSection);
LAB_008036c7:
  local_8 = 0xffffffff;
  ExceptionList = local_10;
  __security_check_cookie(uVar5 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00803490 : PUSH EBP
00803491 : MOV EBP,ESP
00803493 : PUSH -0x1
00803495 : PUSH 0xb43894
0080349a : MOV EAX,FS:[0x0]
008034a0 : PUSH EAX
008034a1 : SUB ESP,0x54
008034a4 : MOV EAX,[0x00d66fa0]
008034a9 : XOR EAX,EBP
008034ab : MOV dword ptr [EBP + -0x10],EAX
008034ae : PUSH EBX
008034af : PUSH ESI
008034b0 : PUSH EDI
008034b1 : PUSH EAX
008034b2 : LEA EAX,[EBP + -0xc]
008034b5 : MOV FS:[0x0],EAX
008034bb : MOV EAX,dword ptr [EBP + 0xc]
008034be : MOV EBX,dword ptr [EBP + 0x8]
008034c1 : XOR ESI,ESI
008034c3 : PUSH ESI
008034c4 : MOV dword ptr [EBP + -0x58],ECX
008034c7 : XOR EDX,EDX
008034c9 : PUSH 0xc28b44
008034ce : LEA ECX,[EBP + -0x48]
008034d1 : MOV dword ptr [EBP + -0x4c],EAX
008034d4 : MOV dword ptr [EBP + -0x30],0x7
008034db : MOV dword ptr [EBP + -0x34],ESI
008034de : MOV word ptr [EBP + -0x44],DX
008034e2 : CALL 0x00406360
008034e7 : MOV dword ptr [EBP + -0x4],ESI
008034ea : LEA EDI,[EBX + 0xb8]
008034f0 : PUSH EDI
008034f1 : MOV dword ptr [EBP + -0x50],EDI
008034f4 : CALL dword ptr [0x00b85118]
008034fa : MOV byte ptr [EBP + -0x4],0x1
008034fe : CMP byte ptr [EBX + 0x94],0x0
00803505 : JNZ 0x00803596
0080350b : MOV ECX,dword ptr [EBX + 0x4c]
0080350e : MOV EAX,dword ptr [ECX]
00803510 : MOV dword ptr [EBP + -0x54],EAX
00803513 : CMP EAX,ECX
00803515 : JZ 0x0080358f
00803517 : MOV ESI,dword ptr [EAX + 0xc]
0080351a : MOV EAX,dword ptr [EAX + 0x10]
0080351d : MOV dword ptr [EBP + -0x5c],EAX
00803520 : TEST ESI,ESI
00803522 : JZ 0x00803578
00803524 : TEST EAX,EAX
00803526 : JZ 0x00803578
00803528 : MOV EDI,dword ptr [EAX + 0x4]
0080352b : CMP EDI,dword ptr [EAX + 0x8]
0080352e : JZ 0x00803578
00803530 : SUB ESP,0x1c
00803533 : MOV ECX,ESP
00803535 : MOV dword ptr [EBP + -0x60],ESP
00803538 : XOR EAX,EAX
0080353a : PUSH -0x1
0080353c : PUSH EAX
0080353d : MOV dword ptr [ECX + 0x18],0x7
00803544 : MOV dword ptr [ECX + 0x14],0x0
0080354b : PUSH EDI
0080354c : MOV word ptr [ECX + 0x4],AX
00803550 : CALL 0x00405eb0
00803555 : MOV byte ptr [EBP + -0x4],0x2
00803559 : PUSH ESI
0080355a : MOV byte ptr [EBP + -0x4],0x1
0080355e : CALL 0x00a5fb10
00803563 : PUSH EDI
00803564 : PUSH EAX
00803565 : PUSH ESI
00803566 : MOV ECX,EBX
00803568 : CALL 0x008022f0
0080356d : MOV ECX,dword ptr [EBP + -0x5c]
00803570 : ADD EDI,0x1c
00803573 : CMP EDI,dword ptr [ECX + 0x8]
00803576 : JNZ 0x00803530
00803578 : LEA EDX,[EBP + -0x54]
0080357b : CALL 0x00416210
00803580 : MOV ECX,dword ptr [EBX + 0x4c]
00803583 : MOV EAX,dword ptr [EBP + -0x54]
00803586 : CMP EAX,ECX
00803588 : JNZ 0x00803517
0080358a : MOV EDI,dword ptr [EBP + -0x50]
0080358d : XOR ESI,ESI
0080358f : MOV byte ptr [EBX + 0x94],0x1
00803596 : MOV EAX,dword ptr [EBP + -0x4c]
00803599 : PUSH -0x1
0080359b : PUSH ESI
0080359c : XOR EDX,EDX
0080359e : PUSH EAX
0080359f : LEA ECX,[EBP + -0x2c]
008035a2 : MOV dword ptr [EBP + -0x14],0x7
008035a9 : MOV dword ptr [EBP + -0x18],ESI
008035ac : MOV word ptr [EBP + -0x28],DX
008035b0 : CALL 0x00405eb0
008035b5 : MOV byte ptr [EBP + -0x4],0x3
008035b9 : LEA ECX,[EBP + -0x2c]
008035bc : CALL 0x0070c1f0
008035c1 : LEA ECX,[EBP + -0x2c]
008035c4 : PUSH ECX
008035c5 : LEA EDX,[EBP + -0x4c]
008035c8 : PUSH EDX
008035c9 : LEA EAX,[EBX + 0x68]
008035cc : PUSH EAX
008035cd : CALL 0x0044f270
008035d2 : MOV EBX,dword ptr [EBX + 0x70]
008035d5 : MOV EAX,dword ptr [EBP + -0x4c]
008035d8 : CMP EAX,EBX
008035da : JZ 0x0080366f
008035e0 : CMP dword ptr [EAX + 0x40],ESI
008035e3 : JZ 0x0080366f
008035e9 : MOV EAX,dword ptr [EAX + 0x44]
008035ec : CMP EAX,ESI
008035ee : JZ 0x0080365c
008035f0 : MOV ESI,dword ptr [EBP + -0x58]
008035f3 : MOV EDI,EAX
008035f5 : CALL 0x00449300
008035fa : MOV BL,AL
008035fc : MOV byte ptr [EBP + -0x4],0x1
00803600 : MOV ESI,0x8
00803605 : CMP dword ptr [EBP + -0x14],ESI
00803608 : JC 0x00803612
0080360a : MOV ECX,dword ptr [EBP + -0x28]
0080360d : CALL 0x006f04e0
00803612 : XOR ECX,ECX
00803614 : MOV EDI,0x7
00803619 : MOV dword ptr [EBP + -0x14],EDI
0080361c : MOV dword ptr [EBP + -0x18],0x0
00803623 : MOV word ptr [EBP + -0x28],CX
00803627 : MOV byte ptr [EBP + -0x4],CL
0080362a : MOV EDX,dword ptr [EBP + -0x50]
0080362d : PUSH EDX
0080362e : CALL dword ptr [0x00b8511c]
00803634 : MOV dword ptr [EBP + -0x4],0xffffffff
0080363b : CMP dword ptr [EBP + -0x30],ESI
0080363e : JC 0x00803648
00803640 : MOV ECX,dword ptr [EBP + -0x44]
00803643 : CALL 0x006f04e0
00803648 : XOR EAX,EAX
0080364a : MOV word ptr [EBP + -0x44],AX
0080364e : MOV dword ptr [EBP + -0x30],EDI
00803651 : MOV dword ptr [EBP + -0x34],0x0
00803658 : MOV AL,BL
0080365a : JMP 0x008036c7
0080365c : MOV ESI,dword ptr [0x00da98e8]
00803662 : PUSH 0xc28b48
00803667 : CALL 0x008018d0
0080366c : ADD ESP,0x4
0080366f : MOV byte ptr [EBP + -0x4],0x1
00803673 : MOV ESI,0x8
00803678 : CMP dword ptr [EBP + -0x14],ESI
0080367b : JC 0x00803685
0080367d : MOV ECX,dword ptr [EBP + -0x28]
00803680 : CALL 0x006f04e0
00803685 : XOR EBX,EBX
00803687 : XOR ECX,ECX
00803689 : MOV dword ptr [EBP + -0x14],0x7
00803690 : MOV dword ptr [EBP + -0x18],EBX
00803693 : MOV word ptr [EBP + -0x28],CX
00803697 : MOV byte ptr [EBP + -0x4],BL
0080369a : PUSH EDI
0080369b : CALL dword ptr [0x00b8511c]
008036a1 : MOV dword ptr [EBP + -0x4],0xffffffff
008036a8 : CMP dword ptr [EBP + -0x30],ESI
008036ab : JC 0x008036b5
008036ad : MOV ECX,dword ptr [EBP + -0x44]
008036b0 : CALL 0x006f04e0
008036b5 : XOR EDX,EDX
008036b7 : MOV dword ptr [EBP + -0x30],0x7
008036be : MOV dword ptr [EBP + -0x34],EBX
008036c1 : MOV word ptr [EBP + -0x44],DX
008036c5 : XOR AL,AL
008036c7 : MOV ECX,dword ptr [EBP + -0xc]
008036ca : MOV dword ptr FS:[0x0],ECX
008036d1 : POP ECX
008036d2 : POP EDI
008036d3 : POP ESI
008036d4 : POP EBX
008036d5 : MOV ECX,dword ptr [EBP + -0x10]
008036d8 : XOR ECX,EBP
008036da : CALL 0x00633e6b
008036df : MOV ESP,EBP
008036e1 : POP EBP
008036e2 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_009a32b0
ENTRY    : 009a32b0
BODY     : [[009a32b0, 009a358f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009a32b0(int param_1,uint param_2)

{
  uint uVar1;
  uint uVar2;
  int *piVar3;
  int iVar4;
  undefined4 uVar5;
  int in_ECX;
  int iVar6;
  byte bVar7;
  undefined1 local_50 [28];
  undefined1 local_34 [32];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b63f7c;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  bVar7 = (byte)param_2;
  if (bVar7 == 0xb) {
    FUN_009a0380(DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
  }
  if ((in_ECX != 0) && (((0x13 < bVar7 && (bVar7 < 0x1e)) || (bVar7 == 0xb)))) {
    FUN_00a36c80(*(undefined4 *)(*(int *)(DAT_0172491c + 0x17c) + 4),param_2,in_ECX);
    iVar4 = *(int *)(DAT_0172491c + 0x17c);
    if (*(int *)(iVar4 + 0x181c) == 0) {
      iVar6 = 0;
    }
    else {
      iVar6 = *(int *)(iVar4 + 0x1714);
    }
    uVar1 = *(uint *)(iVar4 + 0x16e4);
    local_14 = uVar1;
    if (iVar6 != 0) {
      iVar4 = FUN_004049b0(iVar6);
      if (iVar4 != 0) {
        uVar2 = *(uint *)(iVar4 + 0x28c);
        iVar4 = FUN_00859cb0(param_2 & 0xff);
        if (((iVar4 == -1) || ((uVar2 >> ((byte)iVar4 & 0x1f) & 1) == 0)) || ((uVar1 & 0x800) == 0))
        {
          if (((bVar7 == 0xb) && ((uVar2 >> 2 & 1) != 0)) &&
             ((*(char *)(param_1 + 0x6f) == '\0' &&
              (((DAT_0172491c != 0 && (*DAT_00da9894 != 0)) &&
               (*(int *)(*DAT_00da9894 + 0x1a8) != 0)))))) {
            FUN_00406460(L"IDS_FULLBODY_HELMET_INVISIBLE");
            local_8 = 2;
            piVar3 = *(int **)(*DAT_00da9894 + 0x1a8);
            uVar5 = FUN_0081d120(local_34);
            local_8._0_1_ = 3;
            (**(code **)(*piVar3 + 0x44))(uVar5,3);
            local_8 = CONCAT31(local_8._1_3_,2);
            FUN_00406560();
            local_8 = 0xffffffff;
            FUN_00406560();
          }
        }
        else if (((DAT_0172491c != 0) && (*DAT_00da9894 != 0)) &&
                (*(int *)(*DAT_00da9894 + 0x1a8) != 0)) {
          FUN_00406460(L"IDS_LOOKCHANGE_CHECK_INVISIBLESLOT");
          local_8 = 0;
          piVar3 = *(int **)(*DAT_00da9894 + 0x1a8);
          uVar5 = FUN_0081d120(local_34);
          local_8._0_1_ = 1;
          (**(code **)(*piVar3 + 0x44))(uVar5,3);
          local_8 = (uint)local_8._1_3_ << 8;
          FUN_00406560();
          local_8 = 0xffffffff;
          FUN_00406560();
        }
      }
    }
    if (((*(char *)(param_1 + 0x6f) == '\0') && (bVar7 == 0x14)) &&
       ((DAT_0172491c != 0 && ((*DAT_00da9894 != 0 && (*(int *)(*DAT_00da9894 + 0x1a8) != 0)))))) {
      FUN_00406460(L"IDS_LOOKCHANGE_HELMET_INVISIBLE");
      local_8 = 4;
      piVar3 = *(int **)(*DAT_00da9894 + 0x1a8);
      uVar5 = FUN_0081d120(local_50);
      local_8._0_1_ = 5;
      (**(code **)(*piVar3 + 0x44))(uVar5,3);
      local_8 = CONCAT31(local_8._1_3_,4);
      FUN_00406560();
      local_8 = 0xffffffff;
      FUN_00406560();
    }
    if ((*DAT_00da9894 != 0) && (piVar3 = *(int **)(*DAT_00da9894 + 0x114), piVar3 != (int *)0x0)) {
      (**(code **)(*piVar3 + 4))
                (piVar3,"mc_characterInfo.SetLookVisibleMask",&DAT_00c89794,local_14);
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
009a32b0 : PUSH EBP
009a32b1 : MOV EBP,ESP
009a32b3 : PUSH -0x1
009a32b5 : PUSH 0xb63f7c
009a32ba : MOV EAX,FS:[0x0]
009a32c0 : PUSH EAX
009a32c1 : SUB ESP,0x7c
009a32c4 : PUSH EBX
009a32c5 : PUSH ESI
009a32c6 : PUSH EDI
009a32c7 : MOV EAX,[0x00d66fa0]
009a32cc : XOR EAX,EBP
009a32ce : PUSH EAX
009a32cf : LEA EAX,[EBP + -0xc]
009a32d2 : MOV FS:[0x0],EAX
009a32d8 : MOV ESI,ECX
009a32da : MOV EBX,dword ptr [EBP + 0xc]
009a32dd : CMP BL,0xb
009a32e0 : JNZ 0x009a32e7
009a32e2 : CALL 0x009a0380
009a32e7 : TEST ESI,ESI
009a32e9 : JZ 0x009a357c
009a32ef : CMP BL,0x14
009a32f2 : JC 0x009a32f9
009a32f4 : CMP BL,0x1d
009a32f7 : JBE 0x009a3302
009a32f9 : CMP BL,0xb
009a32fc : JNZ 0x009a357c
009a3302 : MOV EAX,[0x0172491c]
009a3307 : MOV EAX,dword ptr [EAX + 0x17c]
009a330d : MOV EAX,dword ptr [EAX + 0x4]
009a3310 : MOV ECX,dword ptr [0x00da93ec]
009a3316 : PUSH ESI
009a3317 : PUSH EBX
009a3318 : PUSH EAX
009a3319 : CALL 0x00a36c80
009a331e : MOV ECX,dword ptr [0x0172491c]
009a3324 : MOV EAX,dword ptr [ECX + 0x17c]
009a332a : CMP dword ptr [EAX + 0x181c],0x0
009a3331 : JZ 0x009a333b
009a3333 : MOV ECX,dword ptr [EAX + 0x1714]
009a3339 : JMP 0x009a333d
009a333b : XOR ECX,ECX
009a333d : MOV EDI,dword ptr [EAX + 0x16e4]
009a3343 : MOV dword ptr [EBP + -0x10],EDI
009a3346 : TEST ECX,ECX
009a3348 : JZ 0x009a34bd
009a334e : PUSH ECX
009a334f : CALL 0x004049b0
009a3354 : ADD ESP,0x4
009a3357 : TEST EAX,EAX
009a3359 : JZ 0x009a34bd
009a335f : MOV ESI,dword ptr [EAX + 0x28c]
009a3365 : MOVZX EDX,BL
009a3368 : PUSH EDX
009a3369 : CALL 0x00859cb0
009a336e : ADD ESP,0x4
009a3371 : CMP EAX,-0x1
009a3374 : JZ 0x009a3421
009a337a : MOV EDX,ESI
009a337c : MOV CL,AL
009a337e : SHR EDX,CL
009a3380 : AND EDX,0x1
009a3383 : JZ 0x009a3421
009a3389 : TEST EDI,0x800
009a338f : JZ 0x009a3421
009a3395 : CMP dword ptr [0x0172491c],0x0
009a339c : JZ 0x009a34bd
009a33a2 : MOV EAX,[0x00da9894]
009a33a7 : MOV EAX,dword ptr [EAX]
009a33a9 : TEST EAX,EAX
009a33ab : JZ 0x009a34bd
009a33b1 : CMP dword ptr [EAX + 0x1a8],0x0
009a33b8 : JZ 0x009a34bd
009a33be : PUSH 0xc89710
009a33c3 : LEA ECX,[EBP + -0x30]
009a33c6 : CALL 0x00406460
009a33cb : MOV dword ptr [EBP + -0x4],0x0
009a33d2 : MOV ECX,dword ptr [0x00da9894]
009a33d8 : MOV EAX,dword ptr [ECX]
009a33da : MOV ECX,dword ptr [0x0172491c]
009a33e0 : MOV ESI,dword ptr [EAX + 0x1a8]
009a33e6 : LEA EDX,[EBP + -0x30]
009a33e9 : PUSH EDX
009a33ea : LEA EDI,[EBP + -0x68]
009a33ed : CALL 0x0081d120
009a33f2 : MOV byte ptr [EBP + -0x4],0x1
009a33f6 : MOV EDX,dword ptr [ESI]
009a33f8 : PUSH 0x3
009a33fa : PUSH EAX
009a33fb : MOV EAX,dword ptr [EDX + 0x44]
009a33fe : MOV ECX,ESI
009a3400 : CALL EAX
009a3402 : MOV byte ptr [EBP + -0x4],0x0
009a3406 : MOV ECX,EDI
009a3408 : CALL 0x00406560
009a340d : MOV dword ptr [EBP + -0x4],0xffffffff
009a3414 : LEA ECX,[EBP + -0x30]
009a3417 : CALL 0x00406560
009a341c : JMP 0x009a34bd
009a3421 : CMP BL,0xb
009a3424 : JNZ 0x009a34bd
009a342a : SHR ESI,0x2
009a342d : AND ESI,0x1
009a3430 : JZ 0x009a34bd
009a3436 : MOV ECX,dword ptr [EBP + 0x8]
009a3439 : CMP byte ptr [ECX + 0x6f],0x0
009a343d : JNZ 0x009a34bd
009a343f : CMP dword ptr [0x0172491c],0x0
009a3446 : JZ 0x009a34bd
009a3448 : MOV EDX,dword ptr [0x00da9894]
009a344e : MOV EAX,dword ptr [EDX]
009a3450 : TEST EAX,EAX
009a3452 : JZ 0x009a34bd
009a3454 : CMP dword ptr [EAX + 0x1a8],0x0
009a345b : JZ 0x009a34bd
009a345d : PUSH 0xc89758
009a3462 : LEA ECX,[EBP + -0x30]
009a3465 : CALL 0x00406460
009a346a : MOV EBX,0x2
009a346f : MOV dword ptr [EBP + -0x4],EBX
009a3472 : MOV EAX,[0x00da9894]
009a3477 : MOV EAX,dword ptr [EAX]
009a3479 : MOV ESI,dword ptr [EAX + 0x1a8]
009a347f : LEA ECX,[EBP + -0x30]
009a3482 : PUSH ECX
009a3483 : MOV ECX,dword ptr [0x0172491c]
009a3489 : LEA EDI,[EBP + -0x68]
009a348c : CALL 0x0081d120
009a3491 : MOV byte ptr [EBP + -0x4],0x3
009a3495 : MOV EDX,dword ptr [ESI]
009a3497 : PUSH 0x3
009a3499 : PUSH EAX
009a349a : MOV EAX,dword ptr [EDX + 0x44]
009a349d : MOV ECX,ESI
009a349f : CALL EAX
009a34a1 : MOV byte ptr [EBP + -0x4],BL
009a34a4 : MOV ECX,EDI
009a34a6 : CALL 0x00406560
009a34ab : MOV dword ptr [EBP + -0x4],0xffffffff
009a34b2 : LEA ECX,[EBP + -0x30]
009a34b5 : CALL 0x00406560
009a34ba : MOV EBX,dword ptr [EBP + 0xc]
009a34bd : MOV ECX,dword ptr [EBP + 0x8]
009a34c0 : CMP byte ptr [ECX + 0x6f],0x0
009a34c4 : JNZ 0x009a354d
009a34ca : CMP BL,0x14
009a34cd : JNZ 0x009a354d
009a34cf : CMP dword ptr [0x0172491c],0x0
009a34d6 : JZ 0x009a354d
009a34d8 : MOV EDX,dword ptr [0x00da9894]
009a34de : MOV EAX,dword ptr [EDX]
009a34e0 : TEST EAX,EAX
009a34e2 : JZ 0x009a354d
009a34e4 : CMP dword ptr [EAX + 0x1a8],0x0
009a34eb : JZ 0x009a354d
009a34ed : PUSH 0xc89798
009a34f2 : LEA ECX,[EBP + -0x4c]
009a34f5 : CALL 0x00406460
009a34fa : MOV EBX,0x4
009a34ff : MOV dword ptr [EBP + -0x4],EBX
009a3502 : MOV EAX,[0x00da9894]
009a3507 : MOV EAX,dword ptr [EAX]
009a3509 : MOV ESI,dword ptr [EAX + 0x1a8]
009a350f : LEA ECX,[EBP + -0x4c]
009a3512 : PUSH ECX
009a3513 : MOV ECX,dword ptr [0x0172491c]
009a3519 : LEA EDI,[EBP + 0xffffff7c]
009a351f : CALL 0x0081d120
009a3524 : MOV byte ptr [EBP + -0x4],0x5
009a3528 : MOV EDX,dword ptr [ESI]
009a352a : PUSH 0x3
009a352c : PUSH EAX
009a352d : MOV EAX,dword ptr [EDX + 0x44]
009a3530 : MOV ECX,ESI
009a3532 : CALL EAX
009a3534 : MOV byte ptr [EBP + -0x4],BL
009a3537 : MOV ECX,EDI
009a3539 : CALL 0x00406560
009a353e : MOV dword ptr [EBP + -0x4],0xffffffff
009a3545 : LEA ECX,[EBP + -0x4c]
009a3548 : CALL 0x00406560
009a354d : MOV ECX,dword ptr [0x00da9894]
009a3553 : MOV EAX,dword ptr [ECX]
009a3555 : TEST EAX,EAX
009a3557 : JZ 0x009a357c
009a3559 : MOV EAX,dword ptr [EAX + 0x114]
009a355f : TEST EAX,EAX
009a3561 : JZ 0x009a357c
009a3563 : MOV ECX,dword ptr [EBP + -0x10]
009a3566 : MOV EDX,dword ptr [EAX]
009a3568 : MOV EDX,dword ptr [EDX + 0x4]
009a356b : PUSH ECX
009a356c : PUSH 0xc89794
009a3571 : PUSH 0xc897d8
009a3576 : PUSH EAX
009a3577 : CALL EDX
009a3579 : ADD ESP,0x10
009a357c : MOV ECX,dword ptr [EBP + -0xc]
009a357f : MOV dword ptr FS:[0x0],ECX
009a3586 : POP ECX
009a3587 : POP EDI
009a3588 : POP ESI
009a3589 : POP EBX
009a358a : MOV ESP,EBP
009a358c : POP EBP
009a358d : RET 0x8

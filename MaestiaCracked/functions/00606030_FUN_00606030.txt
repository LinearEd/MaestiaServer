PROGRAM  : Maestia.exe
FUNCTION : FUN_00606030
ENTRY    : 00606030
BODY     : [[00606030, 006062fb]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00606030(int param_1,int param_2)

{
  uint *puVar1;
  int *piVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  int iVar6;
  char cVar7;
  uint uVar8;
  int in_ECX;
  uint uVar9;
  float10 fVar10;
  uint local_2c;
  
  puVar1 = (uint *)(in_ECX + 0x2c);
  *puVar1 = 0;
  *(undefined1 *)(in_ECX + 0x3c) = 0;
  *(undefined4 *)(in_ECX + 0x40) = 0;
  *(undefined4 *)(in_ECX + 0x50) = 0;
  local_2c = 0;
  if (*(int *)(param_1 + 0x18) != 0) {
    do {
      piVar2 = (int *)(*(int *)(*(int *)(param_1 + 0x24) + (local_2c >> 6) * 4) +
                      (local_2c & 0x3f) * 0x18);
      if (((param_2 < 0) || (piVar2[5] == param_2)) && (piVar2[1] != 0)) {
        if (*puVar1 != 0) {
          fVar10 = (float10)FUN_0063bdc0();
          if ((float)fVar10 < 0.0001 != ((float)fVar10 == 0.0001)) {
            uVar9 = 1;
            if (1 < (uint)piVar2[1]) {
              do {
                iVar6 = *(int *)(*(int *)(*piVar2 + 0x14) + (piVar2[2] + uVar9 >> 8) * 4);
                uVar8 = piVar2[2] + uVar9 & 0xff;
                uVar4 = *(undefined4 *)(iVar6 + uVar8 * 8);
                uVar5 = *(undefined4 *)(iVar6 + uVar8 * 8 + 4);
                if (((1 < *puVar1) &&
                    (uVar8 = *puVar1 - 1,
                    cVar7 = FUN_005d78b0(*(int *)(*(int *)(in_ECX + 0x38) + (uVar8 >> 6) * 4) +
                                         (uVar8 & 0x3f) * 0xc), cVar7 == '\0')) && (*puVar1 != 0)) {
                  *puVar1 = *puVar1 - 1;
                }
                uVar8 = *puVar1 >> 6;
                if (*(uint *)(in_ECX + 0x30) <= uVar8) {
                  FUN_005d7920(uVar8);
                }
                puVar3 = (undefined4 *)
                         (*(int *)(*(int *)(in_ECX + 0x38) + uVar8 * 4) + (*puVar1 & 0x3f) * 0xc);
                *puVar3 = uVar4;
                puVar3[1] = uVar5;
                puVar3[2] = 0;
                *puVar1 = *puVar1 + 1;
                uVar9 = uVar9 + 1;
              } while (uVar9 < (uint)piVar2[1]);
            }
            goto LAB_006062c7;
          }
          FUN_005d7990(0);
          FUN_00605aa0();
          *puVar1 = 0;
          *(undefined1 *)(in_ECX + 0x3c) = 0;
        }
        uVar9 = 0;
        if (piVar2[1] != 0) {
          do {
            iVar6 = *(int *)(*(int *)(*piVar2 + 0x14) + (piVar2[2] + uVar9 >> 8) * 4);
            uVar8 = piVar2[2] + uVar9 & 0xff;
            uVar4 = *(undefined4 *)(iVar6 + uVar8 * 8);
            uVar5 = *(undefined4 *)(iVar6 + uVar8 * 8 + 4);
            if (((1 < *puVar1) &&
                (uVar8 = *puVar1 - 1,
                cVar7 = FUN_005d78b0(*(int *)(*(int *)(in_ECX + 0x38) + (uVar8 >> 6) * 4) +
                                     (uVar8 & 0x3f) * 0xc), cVar7 == '\0')) && (*puVar1 != 0)) {
              *puVar1 = *puVar1 - 1;
            }
            uVar8 = *puVar1 >> 6;
            if (*(uint *)(in_ECX + 0x30) <= uVar8) {
              FUN_005d7920(uVar8);
            }
            puVar3 = (undefined4 *)
                     (*(int *)(*(int *)(in_ECX + 0x38) + uVar8 * 4) + (*puVar1 & 0x3f) * 0xc);
            *puVar3 = uVar4;
            puVar3[1] = uVar5;
            puVar3[2] = 0;
            *puVar1 = *puVar1 + 1;
            uVar9 = uVar9 + 1;
          } while (uVar9 < (uint)piVar2[1]);
        }
      }
LAB_006062c7:
      local_2c = local_2c + 1;
    } while (local_2c < *(uint *)(param_1 + 0x18));
  }
  if (1 < *puVar1) {
    FUN_005d7990(0);
    FUN_00605aa0();
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00606030 : SUB ESP,0x30
00606033 : XOR EAX,EAX
00606035 : PUSH EBP
00606036 : MOV EBP,ECX
00606038 : MOV ECX,dword ptr [ESP + 0x38]
0060603c : PUSH ESI
0060603d : LEA ESI,[EBP + 0x2c]
00606040 : MOV dword ptr [ESI],EAX
00606042 : MOV byte ptr [ESI + 0x10],AL
00606045 : MOV dword ptr [EBP + 0x40],EAX
00606048 : MOV dword ptr [EBP + 0x50],EAX
0060604b : MOV dword ptr [ESP + 0x8],EBP
0060604f : MOV dword ptr [ESP + 0xc],EAX
00606053 : CMP dword ptr [ECX + 0x18],EAX
00606056 : JBE 0x006062df
0060605c : PUSH EBX
0060605d : PUSH EDI
0060605e : MOV EDI,EDI
00606060 : MOV ECX,dword ptr [ECX + 0x24]
00606063 : MOV EDX,EAX
00606065 : AND EAX,0x3f
00606068 : SHR EDX,0x6
0060606b : MOV ECX,dword ptr [ECX + EDX*0x4]
0060606e : LEA EAX,[EAX + EAX*0x2]
00606071 : LEA EDI,[ECX + EAX*0x8]
00606074 : MOV EAX,dword ptr [ESP + 0x48]
00606078 : TEST EAX,EAX
0060607a : JL 0x00606085
0060607c : CMP dword ptr [EDI + 0x14],EAX
0060607f : JNZ 0x006062c7
00606085 : CMP dword ptr [EDI + 0x4],0x0
00606089 : JZ 0x006062c7
0060608f : MOV EAX,dword ptr [ESI]
00606091 : TEST EAX,EAX
00606093 : JZ 0x00606201
00606099 : MOV ECX,dword ptr [EBP + 0x38]
0060609c : MOV EBX,dword ptr [EDI]
0060609e : MOV EBX,dword ptr [EBX + 0x14]
006060a1 : DEC EAX
006060a2 : MOV EDX,EAX
006060a4 : SHR EDX,0x6
006060a7 : MOV ECX,dword ptr [ECX + EDX*0x4]
006060aa : AND EAX,0x3f
006060ad : LEA EAX,[EAX + EAX*0x2]
006060b0 : LEA ECX,[ECX + EAX*0x4]
006060b3 : MOV EAX,dword ptr [EDI + 0x8]
006060b6 : MOV EDX,EAX
006060b8 : SHR EDX,0x8
006060bb : MOV EDX,dword ptr [EBX + EDX*0x4]
006060be : AND EAX,0xff
006060c3 : MOV EBX,dword ptr [EDX + EAX*0x8]
006060c6 : MOV EAX,dword ptr [EDX + EAX*0x8 + 0x4]
006060ca : MOV dword ptr [ESP + 0x20],EBX
006060ce : FLD float ptr [ESP + 0x20]
006060d2 : FSUB float ptr [ECX]
006060d4 : MOV dword ptr [ESP + 0x24],EAX
006060d8 : FSTP float ptr [ESP + 0x1c]
006060dc : FLD float ptr [ESP + 0x24]
006060e0 : FSUB float ptr [ECX + 0x4]
006060e3 : FSTP float ptr [ESP + 0x18]
006060e7 : FLD float ptr [ESP + 0x18]
006060eb : FLD float ptr [ESP + 0x1c]
006060ef : FMUL ST0
006060f1 : FLD ST1
006060f3 : FMULP ST2
006060f5 : FADDP
006060f7 : FSTP float ptr [ESP + 0x1c]
006060fb : FLD float ptr [ESP + 0x1c]
006060ff : CALL 0x0063bdc0
00606104 : FSTP float ptr [ESP + 0x1c]
00606108 : FLD float ptr [ESP + 0x1c]
0060610c : FCOMP double ptr [0x00b937f8]
00606112 : FNSTSW AX
00606114 : TEST AH,0x41
00606117 : JP 0x006061e7
0060611d : MOV EBX,0x1
00606122 : CMP dword ptr [EDI + 0x4],EBX
00606125 : JBE 0x006062c7
0060612b : FLDZ
0060612d : FSTP float ptr [ESP + 0x30]
00606131 : MOV EAX,dword ptr [EDI + 0x8]
00606134 : MOV EDX,dword ptr [EDI]
00606136 : MOV EDX,dword ptr [EDX + 0x14]
00606139 : ADD EAX,EBX
0060613b : MOV ECX,EAX
0060613d : SHR ECX,0x8
00606140 : MOV ECX,dword ptr [EDX + ECX*0x4]
00606143 : AND EAX,0xff
00606148 : FLD float ptr [ECX + EAX*0x8]
0060614b : LEA EAX,[ECX + EAX*0x8]
0060614e : MOV ECX,dword ptr [ESI]
00606150 : FSTP float ptr [ESP + 0x28]
00606154 : FLD float ptr [EAX + 0x4]
00606157 : FSTP float ptr [ESP + 0x2c]
0060615b : CMP ECX,0x1
0060615e : JBE 0x0060619f
00606160 : MOV EDX,dword ptr [ESI + 0xc]
00606163 : LEA EAX,[ECX + -0x1]
00606166 : MOV EBP,EAX
00606168 : AND EAX,0x3f
0060616b : LEA EAX,[EAX + EAX*0x2]
0060616e : SHR EBP,0x6
00606171 : MOV EBP,dword ptr [EDX + EBP*0x4]
00606174 : LEA EBP,[EBP + EAX*0x4]
00606178 : LEA EAX,[ECX + -0x2]
0060617b : MOV ECX,EAX
0060617d : SHR ECX,0x6
00606180 : MOV ECX,dword ptr [EDX + ECX*0x4]
00606183 : AND EAX,0x3f
00606186 : LEA EAX,[EAX + EAX*0x2]
00606189 : LEA ECX,[ECX + EAX*0x4]
0060618c : PUSH EBP
0060618d : CALL 0x005d78b0
00606192 : TEST AL,AL
00606194 : JNZ 0x0060619f
00606196 : MOV EAX,dword ptr [ESI]
00606198 : TEST EAX,EAX
0060619a : JZ 0x0060619f
0060619c : DEC EAX
0060619d : MOV dword ptr [ESI],EAX
0060619f : MOV EBP,dword ptr [ESI]
006061a1 : SHR EBP,0x6
006061a4 : CMP EBP,dword ptr [ESI + 0x4]
006061a7 : JC 0x006061b1
006061a9 : PUSH EBP
006061aa : MOV ECX,ESI
006061ac : CALL 0x005d7920
006061b1 : MOV EAX,dword ptr [ESI]
006061b3 : MOV EDX,dword ptr [ESI + 0xc]
006061b6 : MOV ECX,dword ptr [EDX + EBP*0x4]
006061b9 : MOV EDX,dword ptr [ESP + 0x28]
006061bd : AND EAX,0x3f
006061c0 : LEA EAX,[EAX + EAX*0x2]
006061c3 : LEA EAX,[ECX + EAX*0x4]
006061c6 : MOV ECX,dword ptr [ESP + 0x2c]
006061ca : MOV dword ptr [EAX],EDX
006061cc : MOV EDX,dword ptr [ESP + 0x30]
006061d0 : MOV dword ptr [EAX + 0x4],ECX
006061d3 : MOV dword ptr [EAX + 0x8],EDX
006061d6 : INC dword ptr [ESI]
006061d8 : INC EBX
006061d9 : CMP EBX,dword ptr [EDI + 0x4]
006061dc : JC 0x00606131
006061e2 : JMP 0x006062c3
006061e7 : PUSH 0x0
006061e9 : MOV ECX,ESI
006061eb : CALL 0x005d7990
006061f0 : MOV ECX,EBP
006061f2 : CALL 0x00605aa0
006061f7 : MOV dword ptr [ESI],0x0
006061fd : MOV byte ptr [ESI + 0x10],0x0
00606201 : XOR EBX,EBX
00606203 : CMP dword ptr [EDI + 0x4],EBX
00606206 : JBE 0x006062c7
0060620c : FLDZ
0060620e : FSTP float ptr [ESP + 0x3c]
00606212 : MOV EAX,dword ptr [EDI + 0x8]
00606215 : MOV EDX,dword ptr [EDI]
00606217 : MOV EDX,dword ptr [EDX + 0x14]
0060621a : ADD EAX,EBX
0060621c : MOV ECX,EAX
0060621e : SHR ECX,0x8
00606221 : MOV ECX,dword ptr [EDX + ECX*0x4]
00606224 : AND EAX,0xff
00606229 : FLD float ptr [ECX + EAX*0x8]
0060622c : LEA EAX,[ECX + EAX*0x8]
0060622f : MOV ECX,dword ptr [ESI]
00606231 : FSTP float ptr [ESP + 0x34]
00606235 : FLD float ptr [EAX + 0x4]
00606238 : FSTP float ptr [ESP + 0x38]
0060623c : CMP ECX,0x1
0060623f : JBE 0x00606280
00606241 : MOV EDX,dword ptr [ESI + 0xc]
00606244 : LEA EAX,[ECX + -0x1]
00606247 : MOV EBP,EAX
00606249 : AND EAX,0x3f
0060624c : LEA EAX,[EAX + EAX*0x2]
0060624f : SHR EBP,0x6
00606252 : MOV EBP,dword ptr [EDX + EBP*0x4]
00606255 : LEA EBP,[EBP + EAX*0x4]
00606259 : LEA EAX,[ECX + -0x2]
0060625c : MOV ECX,EAX
0060625e : SHR ECX,0x6
00606261 : MOV ECX,dword ptr [EDX + ECX*0x4]
00606264 : AND EAX,0x3f
00606267 : LEA EAX,[EAX + EAX*0x2]
0060626a : LEA ECX,[ECX + EAX*0x4]
0060626d : PUSH EBP
0060626e : CALL 0x005d78b0
00606273 : TEST AL,AL
00606275 : JNZ 0x00606280
00606277 : MOV EAX,dword ptr [ESI]
00606279 : TEST EAX,EAX
0060627b : JZ 0x00606280
0060627d : DEC EAX
0060627e : MOV dword ptr [ESI],EAX
00606280 : MOV EBP,dword ptr [ESI]
00606282 : SHR EBP,0x6
00606285 : CMP EBP,dword ptr [ESI + 0x4]
00606288 : JC 0x00606292
0060628a : PUSH EBP
0060628b : MOV ECX,ESI
0060628d : CALL 0x005d7920
00606292 : MOV EAX,dword ptr [ESI]
00606294 : MOV EDX,dword ptr [ESI + 0xc]
00606297 : MOV ECX,dword ptr [EDX + EBP*0x4]
0060629a : MOV EDX,dword ptr [ESP + 0x34]
0060629e : AND EAX,0x3f
006062a1 : LEA EAX,[EAX + EAX*0x2]
006062a4 : LEA EAX,[ECX + EAX*0x4]
006062a7 : MOV ECX,dword ptr [ESP + 0x38]
006062ab : MOV dword ptr [EAX],EDX
006062ad : MOV EDX,dword ptr [ESP + 0x3c]
006062b1 : MOV dword ptr [EAX + 0x4],ECX
006062b4 : MOV dword ptr [EAX + 0x8],EDX
006062b7 : INC dword ptr [ESI]
006062b9 : INC EBX
006062ba : CMP EBX,dword ptr [EDI + 0x4]
006062bd : JC 0x00606212
006062c3 : MOV EBP,dword ptr [ESP + 0x10]
006062c7 : MOV EAX,dword ptr [ESP + 0x14]
006062cb : MOV ECX,dword ptr [ESP + 0x44]
006062cf : INC EAX
006062d0 : MOV dword ptr [ESP + 0x14],EAX
006062d4 : CMP EAX,dword ptr [ECX + 0x18]
006062d7 : JC 0x00606060
006062dd : POP EDI
006062de : POP EBX
006062df : CMP dword ptr [ESI],0x1
006062e2 : JBE 0x006062f4
006062e4 : PUSH 0x0
006062e6 : MOV ECX,ESI
006062e8 : CALL 0x005d7990
006062ed : MOV ECX,EBP
006062ef : CALL 0x00605aa0
006062f4 : POP ESI
006062f5 : POP EBP
006062f6 : ADD ESP,0x30
006062f9 : RET 0x8

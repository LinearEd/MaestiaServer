PROGRAM  : Maestia.exe
FUNCTION : FUN_00577c40
ENTRY    : 00577c40
BODY     : [[00577c40, 005783a6]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00577c40(int param_1,int param_2,undefined4 param_3)

{
  char cVar1;
  GRefCountNTSImpl *pGVar2;
  LONG LVar3;
  int *piVar4;
  undefined4 uVar5;
  GRefCountImpl *this;
  int iVar6;
  GRefCountNTSImpl *pGVar7;
  int iVar8;
  int in_ECX;
  byte bVar9;
  uint uVar10;
  code *pcVar11;
  bool bVar12;
  int **ppiVar13;
  char *pcVar14;
  undefined1 *puVar15;
  uint local_58;
  GRefCountNTSImpl *local_54;
  uint local_50;
  int *local_4c;
  GRefCountNTSImpl *local_48;
  int local_44;
  uint uStack_40;
  GRefCountNTSImpl *local_3c;
  undefined4 uStack_38;
  uint uStack_34;
  undefined4 uStack_30;
  uint uStack_2c;
  uint uStack_28;
  uint local_24;
  int *piStack_20;
  undefined4 uStack_1c;
  undefined1 auStack_18 [12];
  undefined1 auStack_c [12];
  
  FUN_0051c600(param_1 + 0xc);
  FUN_0051b6e0();
  local_44 = *(int *)(param_2 + 0xc);
  local_24 = *(uint *)(*(int *)(*(int *)(in_ECX + 0x6c) + 0x1c) + 0x14);
  bVar9 = 0;
  local_48 = (GRefCountNTSImpl *)0x0;
  local_4c = (int *)0x0;
  local_54 = (GRefCountNTSImpl *)0x0;
  local_3c = (GRefCountNTSImpl *)0x0;
  if (*(int *)(param_1 + 0x14) == 0) {
    iVar8 = *(int *)(param_1 + 0x10);
    if (iVar8 == -1) goto LAB_00578363;
    iVar6 = FUN_0056b260(iVar8);
    if (iVar6 == 0) {
      iVar8 = FUN_0056b260(0);
      if (iVar8 != 0) {
        iVar8 = 0;
        goto LAB_00577d46;
      }
    }
    else {
LAB_00577d46:
      piVar4 = (int *)FUN_0056b260(iVar8);
      piVar4 = (int *)(**(code **)(*piVar4 + 0x48))();
      uVar10 = (**(code **)(*piVar4 + 0x2c))();
      bVar9 = (byte)(uVar10 >> 4) & 1;
    }
    FUN_00575ac0(*(undefined4 *)(param_1 + 0x10));
    uStack_38 = 0x40000;
  }
  else {
    pGVar2 = (GRefCountNTSImpl *)FUN_0051d0c0(in_ECX);
    local_48 = pGVar2;
    if (pGVar2 == (GRefCountNTSImpl *)0x0) {
LAB_00578363:
      pcVar11 = InterlockedExchangeAdd_exref;
      LVar3 = InterlockedExchangeAdd((LONG *)((local_50 & 0xfffffffc) + 4),-1);
      if (LVar3 == 1) {
        FUN_00515cf0(local_50 & 0xfffffffc);
      }
      uVar10 = local_58 & 0xfffffffc;
      iVar8 = uVar10 + 4;
      goto LAB_00578390;
    }
    *(int *)(pGVar2 + 4) = *(int *)(pGVar2 + 4) + 1;
    local_4c = *(int **)(pGVar2 + 0x20);
    if (local_4c == (int *)0x0) {
      GRefCountNTSImpl::Release(pGVar2);
      pcVar11 = InterlockedExchangeAdd_exref;
      LVar3 = InterlockedExchangeAdd((LONG *)((local_50 & 0xfffffffc) + 4),-1);
      if (LVar3 == 1) {
        FUN_00515cf0(local_50 & 0xfffffffc);
      }
      uVar10 = local_58 & 0xfffffffc;
      iVar8 = uVar10 + 4;
      goto LAB_00578390;
    }
    piVar4 = (int *)(**(code **)(*(int *)pGVar2 + 0x48))();
    uVar10 = (**(code **)(*piVar4 + 0x2c))();
    uStack_38 = *(undefined4 *)(pGVar2 + 0x10);
    bVar9 = (byte)(uVar10 >> 4) & 1;
  }
  uStack_30 = 0;
  if (bVar9 != 0) {
    uVar5 = FUN_0056b0d0();
    FUN_0051bc20(uVar5);
    uVar10 = uStack_34 & 0xfffffffc;
    LVar3 = InterlockedExchangeAdd((LONG *)(uVar10 + 4),-1);
    if (LVar3 == 1) {
      FUN_00515cf0(uVar10);
    }
  }
  iVar8 = FUN_0051b1a0();
  if (iVar8 == 0) {
    for (iVar8 = *(int *)(in_ECX + 0xb48); pGVar2 = local_3c, piVar4 = local_4c, pGVar7 = local_3c,
        iVar8 != 0; iVar8 = *(int *)(iVar8 + 4)) {
      if (*(int *)(param_1 + 0x10) == -1) {
LAB_0057809f:
        if (((*(int *)(param_1 + 0x14) != 0) &&
            (iVar6 = *(int *)(iVar8 + 0x10), *(int *)(iVar6 + 0x14) != 0)) &&
           (*(int *)(param_1 + 0x14) == *(int *)(iVar6 + 0x14))) {
          *(undefined1 *)(iVar6 + 100) = 1;
        }
      }
      else {
        iVar6 = *(int *)(*(int *)(iVar8 + 0x10) + 0x10);
        if (iVar6 == -1) goto LAB_0057809f;
        if (*(int *)(param_1 + 0x10) == iVar6) {
          *(undefined1 *)(*(int *)(iVar8 + 0x10) + 100) = 1;
        }
      }
    }
  }
  else {
    uStack_34 = uStack_34 & 0xffffff00;
    bVar12 = false;
    if ((*(char *)((local_58 & 0xfffffffc) + 8) == 'i') ||
       (*(char *)((local_58 & 0xfffffffc) + 8) == 'I')) {
      FUN_0051c8c0(&uStack_40);
      puVar15 = &DAT_00b86600;
      FUN_0051c730(&uStack_2c,0,6);
      cVar1 = FUN_004ffbc0(puVar15);
      LVar3 = InterlockedExchangeAdd((LONG *)((uStack_2c & 0xfffffffc) + 4),-1);
      if (LVar3 == 1) {
        FUN_00515cf0(uStack_2c & 0xfffffffc);
      }
      if (cVar1 == '\0') {
        puVar15 = &DAT_00b865f4;
        FUN_0051c730(&uStack_28,0,8);
        cVar1 = FUN_004ffbc0(puVar15);
        LVar3 = InterlockedExchangeAdd((LONG *)((uStack_28 & 0xfffffffc) + 4),-1);
        if (LVar3 == 1) {
          FUN_00515cf0(uStack_28 & 0xfffffffc);
        }
        if (cVar1 != '\0') goto LAB_00577e80;
      }
      else {
        uStack_34 = CONCAT31(uStack_34._1_3_,1);
LAB_00577e80:
        bVar12 = true;
      }
      LVar3 = InterlockedExchangeAdd((LONG *)((uStack_40 & 0xfffffffc) + 4),-1);
      if (LVar3 == 1) {
        FUN_00515cf0(uStack_40 & 0xfffffffc);
      }
      if (!bVar12) goto LAB_00577f83;
      this = (GRefCountImpl *)(**(code **)(*(int *)(*(int *)(in_ECX + 0x100) + 8) + 0xc))(5);
      iVar8 = local_44;
      iVar6 = FUN_00513f20((local_58 & 0xfffffffc) + 8,this,local_44,*(undefined4 *)(in_ECX + 0x14))
      ;
      if (iVar6 == 0) {
        pGVar7 = local_54;
        if (iVar8 != 0) {
          FUN_005134e0(iVar8 + 0xc,"LoadMovieImageCallback failed to load image \"%s\"\n",
                       (local_58 & 0xfffffffc) + 8);
          pGVar7 = local_54;
        }
      }
      else {
        pGVar7 = (GRefCountNTSImpl *)
                 FUN_0056b290(iVar6,uStack_34,(local_58 & 0xfffffffc) + 8,param_2);
        local_54 = pGVar7;
        FUN_00524240();
      }
      if (this != (GRefCountImpl *)0x0) {
        GRefCountImpl::Release(this);
      }
    }
    else {
LAB_00577f83:
      uVar10 = local_24 | 0x10001;
      if (*(char *)(param_1 + 0x18) != '\0') {
        uVar10 = local_24 | 0x210001;
      }
      iVar8 = FUN_0051b1a0();
      if (iVar8 == 0) {
LAB_00577fe9:
        FUN_00561320(3,&local_58,param_3);
        pGVar7 = (GRefCountNTSImpl *)FUN_00514460(param_2,auStack_c,uVar10,0,0);
        local_54 = pGVar7;
        FUN_00512c60();
        if (pGVar7 == (GRefCountNTSImpl *)0x0) {
          if ((local_44 != 0) && (*(char *)(param_1 + 0x18) == '\0')) {
            FUN_005134e0(local_44 + 0xc,"Error loading URL \"%s\"\n",(local_58 & 0xfffffffc) + 8);
          }
          goto LAB_00577f3d;
        }
      }
      else {
        FUN_00561320(3,&local_50,param_3);
        pGVar7 = (GRefCountNTSImpl *)FUN_00514460(param_2,auStack_18,uVar10,0,0);
        local_54 = pGVar7;
        FUN_00512c60();
        if (pGVar7 == (GRefCountNTSImpl *)0x0) goto LAB_00577fe9;
      }
      uStack_30 = *(undefined4 *)(*(int *)(*(int *)(*(int *)(pGVar7 + 0x1c) + 0xc) + 0x20) + 0x28);
    }
LAB_00577f3d:
    pGVar2 = local_3c;
    piVar4 = local_4c;
    if (pGVar7 != (GRefCountNTSImpl *)0x0) {
      iVar8 = FUN_00515840(0x1cc,0);
      piVar4 = local_4c;
      if (iVar8 == 0) {
        pGVar2 = (GRefCountNTSImpl *)0x0;
      }
      else {
        pGVar2 = (GRefCountNTSImpl *)
                 FUN_00595530(*(undefined4 *)(*(int *)(pGVar7 + 0x1c) + 0xc),pGVar7,in_ECX,local_4c,
                              uStack_38,1);
      }
    }
  }
  bVar12 = pGVar2 == (GRefCountNTSImpl *)0x0;
  if (*(int *)(param_1 + 0x10) == -1) {
    if (pGVar2 == (GRefCountNTSImpl *)0x0) {
      uVar5 = 0x10001;
      ppiVar13 = &piStack_20;
      (**(code **)(*piVar4 + 0x48))(ppiVar13,0x10001);
      FUN_00565f40(ppiVar13,uVar5);
      pGVar2 = (GRefCountNTSImpl *)(**(code **)(*piStack_20 + 0x24))(piVar4,uStack_38,uStack_1c);
      if (pGVar2 == (GRefCountNTSImpl *)0x0) goto LAB_00578194;
    }
    FUN_0051d570(in_ECX);
    pGVar7 = local_48;
    *(int *)(pGVar2 + 0x18) = *(int *)(local_48 + 0x18);
    *(int *)(pGVar2 + 0x14) = *(int *)(local_48 + 0x14);
    if ((*(uint *)(local_48 + 0x8c) >> 0xe & 1) == 0) {
      iVar8 = *(int *)(local_48 + 0x80);
      if ((iVar8 == 0) && (iVar8 = FUN_00520df0(), iVar8 == 0)) {
        iVar8 = (**(code **)(*(int *)pGVar7 + 0x58))();
        iVar8 = *(int *)(iVar8 + 0x78);
      }
      (**(code **)(*(int *)pGVar2 + 0x20))(iVar8 + 8);
    }
    (**(code **)(*piVar4 + 0x114))(pGVar7,pGVar2);
    FUN_00576ae0(pGVar2);
    FUN_0056afd0(in_ECX);
  }
  else {
    if (pGVar2 != (GRefCountNTSImpl *)0x0) {
      FUN_00590220(*(int *)(param_1 + 0x10));
      FUN_00574b60(*(undefined4 *)(param_1 + 0x10),pGVar2);
      *(uint *)(in_ECX + 0xb00) = *(uint *)(in_ECX + 0xb00) & 0xfffffeff;
      FUN_00576ae0(pGVar2);
    }
    if ((*(int *)(in_ECX + 0x68) == 0) && (local_44 != 0)) {
      FUN_005134e0(local_44 + 0xc,"_level0 unloaded - no further playback possible\n");
      if (pGVar2 != (GRefCountNTSImpl *)0x0) {
        GRefCountNTSImpl::Release(pGVar2);
      }
      if (pGVar7 != (GRefCountNTSImpl *)0x0) {
        FUN_00524240();
      }
      if (local_48 != (GRefCountNTSImpl *)0x0) {
        GRefCountNTSImpl::Release(local_48);
      }
      FUN_0045b730();
      FUN_0045b730();
      return;
    }
  }
LAB_00578194:
  uVar5 = (**(code **)(**(int **)(in_ECX + 0x68) + 0x5c))();
  piVar4 = (int *)FUN_00526fa0(uVar5);
  if (bVar12) {
    if (piVar4 != (int *)0x0) {
      iVar8 = FUN_0051b1a0();
      if (iVar8 == 0) {
        pcVar14 = "Unknown error";
      }
      else {
        pcVar14 = "URLNotFound";
      }
      (**(code **)(*piVar4 + 0x30))(uVar5,pGVar2,pcVar14,0);
    }
  }
  else {
    if (piVar4 != (int *)0x0) {
      (**(code **)(*piVar4 + 0x24))(uVar5,pGVar2);
      (**(code **)(*piVar4 + 0x34))(uVar5,pGVar2,uStack_38,uStack_38);
      (**(code **)(*piVar4 + 0x28))(uVar5,pGVar2,0);
    }
    FUN_0058eeb0();
    FUN_00575410();
    if (piVar4 != (int *)0x0) {
      (**(code **)(*piVar4 + 0x2c))(uVar5,pGVar2);
    }
  }
  iVar8 = FUN_0051b1a0();
  pGVar7 = local_48;
  if (iVar8 == 0) {
    if (local_48 != (GRefCountNTSImpl *)0x0) {
      GRefCountNTSImpl::Release(local_48);
    }
    FUN_0056b140(*(undefined4 *)(in_ECX + 0x14));
    pGVar7 = (GRefCountNTSImpl *)0x0;
  }
  if (pGVar2 != (GRefCountNTSImpl *)0x0) {
    GRefCountNTSImpl::Release(pGVar2);
  }
  if (local_54 != (GRefCountNTSImpl *)0x0) {
    FUN_00524240();
  }
  if (pGVar7 != (GRefCountNTSImpl *)0x0) {
    GRefCountNTSImpl::Release(pGVar7);
  }
  pcVar11 = InterlockedExchangeAdd_exref;
  LVar3 = InterlockedExchangeAdd((LONG *)((local_50 & 0xfffffffc) + 4),-1);
  if (LVar3 == 1) {
    FUN_00515cf0(local_50 & 0xfffffffc);
  }
  uVar10 = local_58 & 0xfffffffc;
  iVar8 = uVar10 + 4;
LAB_00578390:
  iVar8 = (*pcVar11)(iVar8,0xffffffff);
  if (iVar8 == 1) {
    FUN_00515cf0(uVar10);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00577c40 : SUB ESP,0x5c
00577c43 : PUSH EBX
00577c44 : PUSH EBP
00577c45 : PUSH ESI
00577c46 : MOV ESI,dword ptr [ESP + 0x6c]
00577c4a : PUSH EDI
00577c4b : LEA EAX,[ESI + 0xc]
00577c4e : MOV EBP,ECX
00577c50 : PUSH EAX
00577c51 : LEA ECX,[ESP + 0x18]
00577c55 : CALL 0x0051c600
00577c5a : LEA ECX,[ESP + 0x1c]
00577c5e : CALL 0x0051b6e0
00577c63 : MOV ECX,dword ptr [ESP + 0x74]
00577c67 : MOV EAX,dword ptr [EBP + 0x6c]
00577c6a : MOV EDX,dword ptr [ECX + 0xc]
00577c6d : MOV EAX,dword ptr [EAX + 0x1c]
00577c70 : MOV ECX,dword ptr [ESI + 0x14]
00577c73 : MOV EAX,dword ptr [EAX + 0x14]
00577c76 : XOR EDI,EDI
00577c78 : XOR BL,BL
00577c7a : MOV dword ptr [ESP + 0x24],EDI
00577c7e : MOV dword ptr [ESP + 0x20],EDI
00577c82 : MOV dword ptr [ESP + 0x28],EDX
00577c86 : MOV dword ptr [ESP + 0x48],EAX
00577c8a : MOV dword ptr [ESP + 0x18],EDI
00577c8e : MOV dword ptr [ESP + 0x30],EDI
00577c92 : CMP ECX,EDI
00577c94 : JZ 0x00577d1a
00577c9a : PUSH EBP
00577c9b : CALL 0x0051d0c0
00577ca0 : MOV ESI,EAX
00577ca2 : CMP ESI,EDI
00577ca4 : JZ 0x00577ca9
00577ca6 : INC dword ptr [ESI + 0x4]
00577ca9 : MOV dword ptr [ESP + 0x24],ESI
00577cad : CMP ESI,EDI
00577caf : JZ 0x00578363
00577cb5 : MOV EAX,dword ptr [ESI + 0x20]
00577cb8 : MOV dword ptr [ESP + 0x20],EAX
00577cbc : MOV ECX,ESI
00577cbe : CMP EAX,EDI
00577cc0 : JNZ 0x00577cf9
00577cc2 : CALL 0x004ff7c0
00577cc7 : MOV ESI,dword ptr [ESP + 0x1c]
00577ccb : MOV EDI,dword ptr [0x00b851cc]
00577cd1 : AND ESI,0xfffffffc
00577cd4 : PUSH -0x1
00577cd6 : LEA EAX,[ESI + 0x4]
00577cd9 : PUSH EAX
00577cda : CALL EDI
00577cdc : SUB EAX,0x1
00577cdf : JNZ 0x00577ce7
00577ce1 : PUSH ESI
00577ce2 : CALL 0x00515cf0
00577ce7 : MOV ESI,dword ptr [ESP + 0x14]
00577ceb : AND ESI,0xfffffffc
00577cee : PUSH -0x1
00577cf0 : LEA ECX,[ESI + 0x4]
00577cf3 : PUSH ECX
00577cf4 : JMP 0x00578390
00577cf9 : MOV EDX,dword ptr [ESI]
00577cfb : MOV EAX,dword ptr [EDX + 0x48]
00577cfe : CALL EAX
00577d00 : MOV EDX,dword ptr [EAX]
00577d02 : MOV ECX,EAX
00577d04 : MOV EAX,dword ptr [EDX + 0x2c]
00577d07 : CALL EAX
00577d09 : MOV ECX,dword ptr [ESI + 0x10]
00577d0c : MOV EBX,EAX
00577d0e : SHR EBX,0x4
00577d11 : AND BL,0x1
00577d14 : MOV dword ptr [ESP + 0x34],ECX
00577d18 : JMP 0x00577d7a
00577d1a : MOV EDI,dword ptr [ESI + 0x10]
00577d1d : CMP EDI,-0x1
00577d20 : JZ 0x00578363
00577d26 : PUSH EDI
00577d27 : MOV ECX,EBP
00577d29 : CALL 0x0056b260
00577d2e : MOV ECX,EBP
00577d30 : TEST EAX,EAX
00577d32 : JZ 0x00577d37
00577d34 : PUSH EDI
00577d35 : JMP 0x00577d46
00577d37 : PUSH 0x0
00577d39 : CALL 0x0056b260
00577d3e : TEST EAX,EAX
00577d40 : JZ 0x00577d65
00577d42 : PUSH 0x0
00577d44 : MOV ECX,EBP
00577d46 : CALL 0x0056b260
00577d4b : MOV EDX,dword ptr [EAX]
00577d4d : MOV ECX,EAX
00577d4f : MOV EAX,dword ptr [EDX + 0x48]
00577d52 : CALL EAX
00577d54 : MOV EDX,dword ptr [EAX]
00577d56 : MOV ECX,EAX
00577d58 : MOV EAX,dword ptr [EDX + 0x2c]
00577d5b : CALL EAX
00577d5d : MOV EBX,EAX
00577d5f : SHR EBX,0x4
00577d62 : AND BL,0x1
00577d65 : MOV ECX,dword ptr [ESI + 0x10]
00577d68 : PUSH ECX
00577d69 : MOV ECX,EBP
00577d6b : CALL 0x00575ac0
00577d70 : MOV dword ptr [ESP + 0x34],0x40000
00577d78 : XOR EDI,EDI
00577d7a : MOV dword ptr [ESP + 0x3c],EDI
00577d7e : TEST BL,BL
00577d80 : JZ 0x00577db7
00577d82 : LEA EDI,[ESP + 0x14]
00577d86 : LEA ESI,[ESP + 0x38]
00577d8a : CALL 0x0056b0d0
00577d8f : PUSH EAX
00577d90 : LEA ECX,[ESP + 0x20]
00577d94 : CALL 0x0051bc20
00577d99 : MOV ESI,dword ptr [ESP + 0x38]
00577d9d : AND ESI,0xfffffffc
00577da0 : PUSH -0x1
00577da2 : LEA EDX,[ESI + 0x4]
00577da5 : PUSH EDX
00577da6 : CALL dword ptr [0x00b851cc]
00577dac : ADD EAX,-0x1
00577daf : JNZ 0x00577db7
00577db1 : PUSH ESI
00577db2 : CALL 0x00515cf0
00577db7 : LEA ECX,[ESP + 0x14]
00577dbb : CALL 0x0051b1a0
00577dc0 : TEST EAX,EAX
00577dc2 : JZ 0x00578074
00577dc8 : MOV EAX,dword ptr [ESP + 0x14]
00577dcc : AND EAX,0xfffffffc
00577dcf : CMP byte ptr [EAX + 0x8],0x69
00577dd3 : MOV byte ptr [ESP + 0x38],0x0
00577dd8 : MOV byte ptr [ESP + 0x13],0x0
00577ddd : JZ 0x00577de9
00577ddf : CMP byte ptr [EAX + 0x8],0x49
00577de3 : JNZ 0x00577f83
00577de9 : LEA EAX,[ESP + 0x2c]
00577ded : PUSH EAX
00577dee : LEA ECX,[ESP + 0x18]
00577df2 : CALL 0x0051c8c0
00577df7 : PUSH 0xb86600
00577dfc : PUSH 0x6
00577dfe : PUSH 0x0
00577e00 : LEA ECX,[ESP + 0x4c]
00577e04 : PUSH ECX
00577e05 : LEA ECX,[ESP + 0x3c]
00577e09 : CALL 0x0051c730
00577e0e : MOV ECX,EAX
00577e10 : CALL 0x004ffbc0
00577e15 : MOV ESI,dword ptr [ESP + 0x40]
00577e19 : MOV EDI,dword ptr [0x00b851cc]
00577e1f : AND ESI,0xfffffffc
00577e22 : PUSH -0x1
00577e24 : LEA EDX,[ESI + 0x4]
00577e27 : PUSH EDX
00577e28 : MOV BL,AL
00577e2a : CALL EDI
00577e2c : ADD EAX,-0x1
00577e2f : JNZ 0x00577e37
00577e31 : PUSH ESI
00577e32 : CALL 0x00515cf0
00577e37 : TEST BL,BL
00577e39 : JZ 0x00577e42
00577e3b : MOV byte ptr [ESP + 0x38],0x1
00577e40 : JMP 0x00577e80
00577e42 : PUSH 0xb865f4
00577e47 : PUSH 0x8
00577e49 : PUSH 0x0
00577e4b : LEA EAX,[ESP + 0x50]
00577e4f : PUSH EAX
00577e50 : LEA ECX,[ESP + 0x3c]
00577e54 : CALL 0x0051c730
00577e59 : MOV ECX,EAX
00577e5b : CALL 0x004ffbc0
00577e60 : MOV ESI,dword ptr [ESP + 0x44]
00577e64 : AND ESI,0xfffffffc
00577e67 : PUSH -0x1
00577e69 : LEA ECX,[ESI + 0x4]
00577e6c : PUSH ECX
00577e6d : MOV BL,AL
00577e6f : CALL EDI
00577e71 : ADD EAX,-0x1
00577e74 : JNZ 0x00577e7c
00577e76 : PUSH ESI
00577e77 : CALL 0x00515cf0
00577e7c : TEST BL,BL
00577e7e : JZ 0x00577e85
00577e80 : MOV byte ptr [ESP + 0x13],0x1
00577e85 : MOV ESI,dword ptr [ESP + 0x2c]
00577e89 : AND ESI,0xfffffffc
00577e8c : PUSH -0x1
00577e8e : LEA EDX,[ESI + 0x4]
00577e91 : PUSH EDX
00577e92 : CALL EDI
00577e94 : ADD EAX,-0x1
00577e97 : JNZ 0x00577e9f
00577e99 : PUSH ESI
00577e9a : CALL 0x00515cf0
00577e9f : CMP byte ptr [ESP + 0x13],0x0
00577ea4 : JZ 0x00577f83
00577eaa : MOV ECX,dword ptr [EBP + 0x100]
00577eb0 : MOV EAX,dword ptr [ECX + 0x8]
00577eb3 : MOV EDX,dword ptr [EAX + 0xc]
00577eb6 : ADD ECX,0x8
00577eb9 : PUSH 0x5
00577ebb : CALL EDX
00577ebd : MOV ECX,dword ptr [EBP + 0x14]
00577ec0 : MOV EDI,dword ptr [ESP + 0x28]
00577ec4 : MOV ESI,EAX
00577ec6 : MOV EAX,dword ptr [ESP + 0x14]
00577eca : PUSH ECX
00577ecb : AND EAX,0xfffffffc
00577ece : PUSH EDI
00577ecf : ADD EAX,0x8
00577ed2 : PUSH ESI
00577ed3 : PUSH EAX
00577ed4 : CALL 0x00513f20
00577ed9 : MOV EBX,EAX
00577edb : ADD ESP,0x10
00577ede : TEST EBX,EBX
00577ee0 : JZ 0x00577f0e
00577ee2 : MOV EAX,dword ptr [ESP + 0x14]
00577ee6 : MOV ECX,dword ptr [ESP + 0x74]
00577eea : MOV EDX,dword ptr [ESP + 0x38]
00577eee : PUSH ECX
00577eef : AND EAX,0xfffffffc
00577ef2 : ADD EAX,0x8
00577ef5 : PUSH EAX
00577ef6 : PUSH EDX
00577ef7 : PUSH EBX
00577ef8 : MOV ECX,EBP
00577efa : CALL 0x0056b290
00577eff : MOV EDI,EAX
00577f01 : MOV ECX,EBX
00577f03 : MOV dword ptr [ESP + 0x18],EDI
00577f07 : CALL 0x00524240
00577f0c : JMP 0x00577f32
00577f0e : TEST EDI,EDI
00577f10 : JZ 0x00577f2e
00577f12 : MOV EAX,dword ptr [ESP + 0x14]
00577f16 : AND EAX,0xfffffffc
00577f19 : ADD EAX,0x8
00577f1c : PUSH EAX
00577f1d : PUSH 0xb8d408
00577f22 : ADD EDI,0xc
00577f25 : PUSH EDI
00577f26 : CALL 0x005134e0
00577f2b : ADD ESP,0xc
00577f2e : MOV EDI,dword ptr [ESP + 0x18]
00577f32 : TEST ESI,ESI
00577f34 : JZ 0x00577f3d
00577f36 : MOV ECX,ESI
00577f38 : CALL 0x004ff7e0
00577f3d : TEST EDI,EDI
00577f3f : JZ 0x00578216
00577f45 : MOV ECX,dword ptr [EBP + 0x14]
00577f48 : PUSH 0x0
00577f4a : PUSH 0x1cc
00577f4f : CALL 0x00515840
00577f54 : MOV ESI,dword ptr [ESP + 0x20]
00577f58 : TEST EAX,EAX
00577f5a : JZ 0x0057820d
00577f60 : PUSH 0x1
00577f62 : PUSH ECX
00577f63 : MOV ECX,dword ptr [ESP + 0x3c]
00577f67 : MOV EDX,ESP
00577f69 : PUSH ESI
00577f6a : MOV dword ptr [EDX],ECX
00577f6c : MOV EDX,dword ptr [EDI + 0x1c]
00577f6f : MOV EDX,dword ptr [EDX + 0xc]
00577f72 : PUSH EBP
00577f73 : PUSH EDI
00577f74 : PUSH EDX
00577f75 : MOV ECX,EAX
00577f77 : CALL 0x00595530
00577f7c : MOV EBX,EAX
00577f7e : JMP 0x005780c9
00577f83 : MOV ESI,dword ptr [ESP + 0x48]
00577f87 : MOV EAX,dword ptr [ESP + 0x70]
00577f8b : OR ESI,0x10001
00577f91 : CMP byte ptr [EAX + 0x18],0x0
00577f95 : JZ 0x00577f9d
00577f97 : OR ESI,0x200000
00577f9d : LEA ECX,[ESP + 0x1c]
00577fa1 : CALL 0x0051b1a0
00577fa6 : MOV EBX,dword ptr [ESP + 0x78]
00577faa : TEST EAX,EAX
00577fac : JBE 0x00577fe9
00577fae : PUSH EBX
00577faf : LEA ECX,[ESP + 0x20]
00577fb3 : PUSH ECX
00577fb4 : PUSH 0x3
00577fb6 : LEA ECX,[ESP + 0x60]
00577fba : CALL 0x00561320
00577fbf : MOV EAX,dword ptr [ESP + 0x74]
00577fc3 : PUSH 0x0
00577fc5 : PUSH 0x0
00577fc7 : PUSH ESI
00577fc8 : LEA EDX,[ESP + 0x60]
00577fcc : PUSH EDX
00577fcd : PUSH EAX
00577fce : CALL 0x00514460
00577fd3 : ADD ESP,0x14
00577fd6 : LEA ECX,[ESP + 0x54]
00577fda : MOV EDI,EAX
00577fdc : MOV dword ptr [ESP + 0x18],EAX
00577fe0 : CALL 0x00512c60
00577fe5 : TEST EDI,EDI
00577fe7 : JNZ 0x00578024
00577fe9 : PUSH EBX
00577fea : LEA ECX,[ESP + 0x18]
00577fee : PUSH ECX
00577fef : PUSH 0x3
00577ff1 : LEA ECX,[ESP + 0x6c]
00577ff5 : CALL 0x00561320
00577ffa : MOV EAX,dword ptr [ESP + 0x74]
00577ffe : PUSH 0x0
00578000 : PUSH 0x0
00578002 : PUSH ESI
00578003 : LEA EDX,[ESP + 0x6c]
00578007 : PUSH EDX
00578008 : PUSH EAX
00578009 : CALL 0x00514460
0057800e : MOV EDI,EAX
00578010 : ADD ESP,0x14
00578013 : LEA ECX,[ESP + 0x60]
00578017 : MOV dword ptr [ESP + 0x18],EDI
0057801b : CALL 0x00512c60
00578020 : TEST EDI,EDI
00578022 : JZ 0x00578039
00578024 : MOV EAX,dword ptr [EDI + 0x1c]
00578027 : MOV EAX,dword ptr [EAX + 0xc]
0057802a : MOV EAX,dword ptr [EAX + 0x20]
0057802d : MOV ECX,dword ptr [EAX + 0x28]
00578030 : MOV dword ptr [ESP + 0x3c],ECX
00578034 : JMP 0x00577f3d
00578039 : MOV ECX,dword ptr [ESP + 0x28]
0057803d : TEST ECX,ECX
0057803f : JZ 0x00577f3d
00578045 : MOV EDX,dword ptr [ESP + 0x70]
00578049 : CMP byte ptr [EDX + 0x18],0x0
0057804d : JNZ 0x00577f3d
00578053 : MOV EAX,dword ptr [ESP + 0x14]
00578057 : AND EAX,0xfffffffc
0057805a : ADD EAX,0x8
0057805d : PUSH EAX
0057805e : ADD ECX,0xc
00578061 : PUSH 0xb8d3f0
00578066 : PUSH ECX
00578067 : CALL 0x005134e0
0057806c : ADD ESP,0xc
0057806f : JMP 0x00577f3d
00578074 : MOV ECX,dword ptr [EBP + 0xb48]
0057807a : TEST ECX,ECX
0057807c : JZ 0x005780bf
0057807e : MOV EDI,dword ptr [ESP + 0x70]
00578082 : MOV ESI,dword ptr [EDI + 0x10]
00578085 : CMP ESI,-0x1
00578088 : JZ 0x0057809f
0057808a : MOV EDX,dword ptr [ECX + 0x10]
0057808d : MOV EAX,dword ptr [EDX + 0x10]
00578090 : CMP EAX,-0x1
00578093 : JZ 0x0057809f
00578095 : CMP ESI,EAX
00578097 : JNZ 0x005780b8
00578099 : MOV byte ptr [EDX + 0x64],0x1
0057809d : JMP 0x005780b8
0057809f : MOV EDX,dword ptr [EDI + 0x14]
005780a2 : TEST EDX,EDX
005780a4 : JZ 0x005780b8
005780a6 : MOV EAX,dword ptr [ECX + 0x10]
005780a9 : CMP dword ptr [EAX + 0x14],0x0
005780ad : JZ 0x005780b8
005780af : CMP EDX,dword ptr [EAX + 0x14]
005780b2 : JNZ 0x005780b8
005780b4 : MOV byte ptr [EAX + 0x64],0x1
005780b8 : MOV ECX,dword ptr [ECX + 0x4]
005780bb : TEST ECX,ECX
005780bd : JNZ 0x00578082
005780bf : MOV EBX,dword ptr [ESP + 0x30]
005780c3 : MOV EDI,EBX
005780c5 : MOV ESI,dword ptr [ESP + 0x20]
005780c9 : MOV EDX,dword ptr [ESP + 0x70]
005780cd : MOV EAX,dword ptr [EDX + 0x10]
005780d0 : TEST EBX,EBX
005780d2 : SETNZ byte ptr [ESP + 0x74]
005780d7 : CMP EAX,-0x1
005780da : JNZ 0x0057821f
005780e0 : TEST EBX,EBX
005780e2 : JNZ 0x00578122
005780e4 : PUSH ECX
005780e5 : MOV EAX,ESP
005780e7 : MOV dword ptr [EAX],0x10001
005780ed : MOV EDX,dword ptr [ESI]
005780ef : LEA EAX,[ESP + 0x50]
005780f3 : PUSH EAX
005780f4 : MOV EAX,dword ptr [EDX + 0x48]
005780f7 : MOV ECX,ESI
005780f9 : CALL EAX
005780fb : MOV ECX,EAX
005780fd : CALL 0x00565f40
00578102 : MOV ECX,dword ptr [ESP + 0x50]
00578106 : MOV EDX,dword ptr [ESP + 0x34]
0057810a : PUSH ECX
0057810b : PUSH ECX
0057810c : MOV EAX,ESP
0057810e : MOV dword ptr [EAX],EDX
00578110 : MOV ECX,dword ptr [ESP + 0x54]
00578114 : MOV EAX,dword ptr [ECX]
00578116 : MOV EDX,dword ptr [EAX + 0x24]
00578119 : PUSH ESI
0057811a : CALL EDX
0057811c : MOV EBX,EAX
0057811e : TEST EBX,EBX
00578120 : JZ 0x00578194
00578122 : PUSH EBP
00578123 : MOV ECX,EBX
00578125 : CALL 0x0051d570
0057812a : MOV EDI,dword ptr [ESP + 0x24]
0057812e : MOV EAX,dword ptr [EDI + 0x18]
00578131 : MOV dword ptr [EBX + 0x18],EAX
00578134 : MOV ECX,dword ptr [EDI + 0x14]
00578137 : MOV dword ptr [EBX + 0x14],ECX
0057813a : MOV EDX,dword ptr [EDI + 0x8c]
00578140 : SHR EDX,0xe
00578143 : TEST DL,0x1
00578146 : JNZ 0x00578176
00578148 : MOV EAX,dword ptr [EDI + 0x80]
0057814e : TEST EAX,EAX
00578150 : JNZ 0x00578169
00578152 : MOV ECX,EDI
00578154 : CALL 0x00520df0
00578159 : TEST EAX,EAX
0057815b : JNZ 0x00578169
0057815d : MOV EAX,dword ptr [EDI]
0057815f : MOV EDX,dword ptr [EAX + 0x58]
00578162 : MOV ECX,EDI
00578164 : CALL EDX
00578166 : MOV EAX,dword ptr [EAX + 0x78]
00578169 : MOV EDX,dword ptr [EBX]
0057816b : ADD EAX,0x8
0057816e : PUSH EAX
0057816f : MOV EAX,dword ptr [EDX + 0x20]
00578172 : MOV ECX,EBX
00578174 : CALL EAX
00578176 : MOV EDX,dword ptr [ESI]
00578178 : MOV EAX,dword ptr [EDX + 0x114]
0057817e : PUSH EBX
0057817f : PUSH EDI
00578180 : MOV ECX,ESI
00578182 : CALL EAX
00578184 : PUSH EBX
00578185 : MOV ECX,EBP
00578187 : CALL 0x00576ae0
0057818c : PUSH EBP
0057818d : MOV ECX,EBX
0057818f : CALL 0x0056afd0
00578194 : MOV ECX,dword ptr [EBP + 0x68]
00578197 : MOV EDX,dword ptr [ECX]
00578199 : MOV EAX,dword ptr [EDX + 0x5c]
0057819c : CALL EAX
0057819e : MOV ECX,dword ptr [ESP + 0x70]
005781a2 : MOV EDI,EAX
005781a4 : PUSH EDI
005781a5 : ADD ECX,0x1c
005781a8 : CALL 0x00526fa0
005781ad : CMP byte ptr [ESP + 0x74],0x0
005781b2 : MOV ESI,EAX
005781b4 : JZ 0x005782b6
005781ba : TEST ESI,ESI
005781bc : JZ 0x005781e7
005781be : MOV EDX,dword ptr [ESI]
005781c0 : MOV EAX,dword ptr [EDX + 0x24]
005781c3 : PUSH EBX
005781c4 : PUSH EDI
005781c5 : MOV ECX,ESI
005781c7 : CALL EAX
005781c9 : MOV EAX,dword ptr [ESP + 0x3c]
005781cd : MOV EDX,dword ptr [ESI]
005781cf : PUSH EAX
005781d0 : PUSH EAX
005781d1 : MOV EAX,dword ptr [EDX + 0x34]
005781d4 : PUSH EBX
005781d5 : PUSH EDI
005781d6 : MOV ECX,ESI
005781d8 : CALL EAX
005781da : MOV EDX,dword ptr [ESI]
005781dc : MOV EAX,dword ptr [EDX + 0x28]
005781df : PUSH 0x0
005781e1 : PUSH EBX
005781e2 : PUSH EDI
005781e3 : MOV ECX,ESI
005781e5 : CALL EAX
005781e7 : MOV ECX,EBX
005781e9 : CALL 0x0058eeb0
005781ee : MOV ECX,EBP
005781f0 : CALL 0x00575410
005781f5 : TEST ESI,ESI
005781f7 : JZ 0x005782e0
005781fd : MOV EDX,dword ptr [ESI]
005781ff : MOV EAX,dword ptr [EDX + 0x2c]
00578202 : PUSH EBX
00578203 : PUSH EDI
00578204 : MOV ECX,ESI
00578206 : CALL EAX
00578208 : JMP 0x005782e0
0057820d : XOR EAX,EAX
0057820f : MOV EBX,EAX
00578211 : JMP 0x005780c9
00578216 : MOV EBX,dword ptr [ESP + 0x30]
0057821a : JMP 0x005780c5
0057821f : TEST EBX,EBX
00578221 : JZ 0x0057824d
00578223 : PUSH EAX
00578224 : MOV ECX,EBX
00578226 : CALL 0x00590220
0057822b : MOV ECX,dword ptr [ESP + 0x70]
0057822f : MOV EDX,dword ptr [ECX + 0x10]
00578232 : PUSH EBX
00578233 : PUSH EDX
00578234 : MOV ECX,EBP
00578236 : CALL 0x00574b60
0057823b : AND dword ptr [EBP + 0xb00],0xfffffeff
00578245 : PUSH EBX
00578246 : MOV ECX,EBP
00578248 : CALL 0x00576ae0
0057824d : CMP dword ptr [EBP + 0x68],0x0
00578251 : JNZ 0x00578194
00578257 : CMP dword ptr [ESP + 0x28],0x0
0057825c : JZ 0x00578194
00578262 : MOV EAX,dword ptr [ESP + 0x28]
00578266 : ADD EAX,0xc
00578269 : PUSH 0xb8d3bc
0057826e : PUSH EAX
0057826f : CALL 0x005134e0
00578274 : ADD ESP,0x8
00578277 : TEST EBX,EBX
00578279 : JZ 0x00578282
0057827b : MOV ECX,EBX
0057827d : CALL 0x004ff7c0
00578282 : TEST EDI,EDI
00578284 : JZ 0x0057828d
00578286 : MOV ECX,EDI
00578288 : CALL 0x00524240
0057828d : MOV ECX,dword ptr [ESP + 0x24]
00578291 : TEST ECX,ECX
00578293 : JZ 0x0057829a
00578295 : CALL 0x004ff7c0
0057829a : LEA ECX,[ESP + 0x1c]
0057829e : CALL 0x0045b730
005782a3 : LEA ECX,[ESP + 0x14]
005782a7 : CALL 0x0045b730
005782ac : POP EDI
005782ad : POP ESI
005782ae : POP EBP
005782af : POP EBX
005782b0 : ADD ESP,0x5c
005782b3 : RET 0xc
005782b6 : TEST ESI,ESI
005782b8 : JZ 0x005782e0
005782ba : LEA ECX,[ESP + 0x14]
005782be : CALL 0x0051b1a0
005782c3 : MOV EDX,dword ptr [ESI]
005782c5 : TEST EAX,EAX
005782c7 : MOV EAX,dword ptr [EDX + 0x30]
005782ca : PUSH 0x0
005782cc : MOV ECX,ESI
005782ce : JZ 0x005782d7
005782d0 : PUSH 0xb8d298
005782d5 : JMP 0x005782dc
005782d7 : PUSH 0xb8d3ac
005782dc : PUSH EBX
005782dd : PUSH EDI
005782de : CALL EAX
005782e0 : LEA ECX,[ESP + 0x14]
005782e4 : CALL 0x0051b1a0
005782e9 : TEST EAX,EAX
005782eb : JNZ 0x0057830d
005782ed : MOV ECX,dword ptr [ESP + 0x24]
005782f1 : TEST ECX,ECX
005782f3 : JZ 0x005782fa
005782f5 : CALL 0x004ff7c0
005782fa : MOV ECX,dword ptr [EBP + 0x14]
005782fd : PUSH ECX
005782fe : LEA ECX,[EBP + 0xb2c]
00578304 : XOR ESI,ESI
00578306 : CALL 0x0056b140
0057830b : JMP 0x00578311
0057830d : MOV ESI,dword ptr [ESP + 0x24]
00578311 : TEST EBX,EBX
00578313 : JZ 0x0057831c
00578315 : MOV ECX,EBX
00578317 : CALL 0x004ff7c0
0057831c : MOV ECX,dword ptr [ESP + 0x18]
00578320 : TEST ECX,ECX
00578322 : JZ 0x00578329
00578324 : CALL 0x00524240
00578329 : TEST ESI,ESI
0057832b : JZ 0x00578334
0057832d : MOV ECX,ESI
0057832f : CALL 0x004ff7c0
00578334 : MOV ESI,dword ptr [ESP + 0x1c]
00578338 : MOV EDI,dword ptr [0x00b851cc]
0057833e : AND ESI,0xfffffffc
00578341 : PUSH -0x1
00578343 : LEA EDX,[ESI + 0x4]
00578346 : PUSH EDX
00578347 : CALL EDI
00578349 : SUB EAX,0x1
0057834c : JNZ 0x00578354
0057834e : PUSH ESI
0057834f : CALL 0x00515cf0
00578354 : MOV ESI,dword ptr [ESP + 0x14]
00578358 : AND ESI,0xfffffffc
0057835b : PUSH -0x1
0057835d : LEA EAX,[ESI + 0x4]
00578360 : PUSH EAX
00578361 : JMP 0x00578390
00578363 : MOV ESI,dword ptr [ESP + 0x1c]
00578367 : MOV EDI,dword ptr [0x00b851cc]
0057836d : AND ESI,0xfffffffc
00578370 : PUSH -0x1
00578372 : LEA ECX,[ESI + 0x4]
00578375 : PUSH ECX
00578376 : CALL EDI
00578378 : SUB EAX,0x1
0057837b : JNZ 0x00578383
0057837d : PUSH ESI
0057837e : CALL 0x00515cf0
00578383 : MOV ESI,dword ptr [ESP + 0x14]
00578387 : AND ESI,0xfffffffc
0057838a : PUSH -0x1
0057838c : LEA EDX,[ESI + 0x4]
0057838f : PUSH EDX
00578390 : CALL EDI
00578392 : SUB EAX,0x1
00578395 : JNZ 0x0057839d
00578397 : PUSH ESI
00578398 : CALL 0x00515cf0
0057839d : POP EDI
0057839e : POP ESI
0057839f : POP EBP
005783a0 : POP EBX
005783a1 : ADD ESP,0x5c
005783a4 : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_005b9070
ENTRY    : 005b9070
BODY     : [[005b9070, 005b9578] [005b9580, 005b96c1]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x005b91ac) */
/* WARNING: Removing unreachable block (ram,0x005b9264) */
/* WARNING: Removing unreachable block (ram,0x005b9213) */

void FUN_005b9070(int param_1,int param_2)

{
  uint uVar1;
  char cVar2;
  ushort *puVar3;
  int iVar4;
  int *piVar5;
  undefined4 uVar6;
  int iVar7;
  int in_ECX;
  void *pvVar8;
  undefined4 *puVar9;
  uint uVar10;
  int iVar11;
  uint uVar12;
  int iVar13;
  uint uVar14;
  undefined4 *puVar15;
  undefined4 *puVar16;
  undefined4 uVar17;
  uint uVar18;
  undefined4 local_94;
  undefined4 local_90;
  undefined4 local_8c;
  undefined4 local_88;
  undefined4 local_84;
  undefined4 local_80;
  undefined4 local_7c [8];
  undefined4 local_5c;
  ushort local_58;
  undefined4 local_54;
  undefined1 local_50;
  GRefCountNTSImpl *local_4c;
  GMatrix2D local_48 [56];
  undefined4 local_10;
  ushort local_c;
  undefined1 local_4;
  
  if (param_2 == 7) {
    GMatrix2D::SetIdentity((GMatrix2D *)&local_94);
    FUN_0059d080();
    local_5c = 0x40000;
    local_50 = 0;
    cVar2 = FUN_005b5b50(param_1,7);
    while (cVar2 != '\0') {
      uVar14 = 0;
      if (*(int *)(in_ECX + 0x1c) != 0) {
        puVar3 = (ushort *)(*(int *)(in_ECX + 0x18) + 0x40);
        do {
          if (local_58 < *puVar3) break;
          uVar14 = uVar14 + 1;
          puVar3 = puVar3 + 0x26;
        } while (uVar14 < *(uint *)(in_ECX + 0x1c));
      }
      uVar12 = *(uint *)(in_ECX + 0x1c);
      uVar10 = uVar12 + 1;
      if (uVar10 < uVar12) {
        iVar4 = uVar12 - uVar10;
        puVar15 = (undefined4 *)((iVar4 + uVar10) * 0x4c + -0x4c + *(int *)(in_ECX + 0x18));
        for (; iVar4 != 0; iVar4 = iVar4 + -1) {
          if ((GRefCountNTSImpl *)*puVar15 != (GRefCountNTSImpl *)0x0) {
            GRefCountNTSImpl::Release((GRefCountNTSImpl *)*puVar15);
          }
          puVar15 = puVar15 + -0x13;
        }
        if (uVar10 < *(uint *)(in_ECX + 0x20) >> 1) {
          FUN_005b5e70(in_ECX + 0x18,uVar10);
        }
      }
      else if (*(uint *)(in_ECX + 0x20) <= uVar10) {
        FUN_005b5e70(in_ECX + 0x18,(uVar10 >> 2) + uVar10);
      }
      *(uint *)(in_ECX + 0x1c) = uVar10;
      if (uVar12 < uVar10) {
        FUN_005b5e20(uVar12 * 0x4c + *(int *)(in_ECX + 0x18),uVar10 - uVar12);
      }
      if (uVar14 < *(int *)(in_ECX + 0x1c) - 1U) {
        pvVar8 = (void *)(*(int *)(in_ECX + 0x18) + uVar14 * 0x4c);
        _memmove((void *)((int)pvVar8 + 0x4c),pvVar8,
                 ((*(int *)(in_ECX + 0x1c) - uVar14) + -1) * 0x4c);
      }
      puVar15 = (undefined4 *)(uVar14 * 0x4c + *(int *)(in_ECX + 0x18));
      if (puVar15 != (undefined4 *)0x0) {
        *puVar15 = 0;
        puVar15[1] = local_94;
        puVar15[2] = local_90;
        puVar15[3] = local_8c;
        puVar15[4] = local_88;
        puVar15[5] = local_84;
        puVar15[6] = local_80;
        puVar9 = local_7c;
        puVar16 = puVar15 + 7;
        for (iVar4 = 8; iVar4 != 0; iVar4 = iVar4 + -1) {
          *puVar16 = *puVar9;
          puVar9 = puVar9 + 1;
          puVar16 = puVar16 + 1;
        }
        puVar15[0xf] = local_5c;
        *(ushort *)(puVar15 + 0x10) = local_58;
        puVar15[0x11] = local_54;
        *(undefined1 *)(puVar15 + 0x12) = local_50;
      }
      GMatrix2D::SetIdentity((GMatrix2D *)&local_94);
      FUN_0059d080();
      local_5c = 0x40000;
      local_50 = 0;
      cVar2 = FUN_005b5b50(param_1,7);
    }
    uVar14 = *(uint *)(in_ECX + 0x28);
    uVar10 = *(int *)(in_ECX + 0x28) + 1;
    FUN_005b8f40((int *)(in_ECX + 0x24),uVar10);
    if (uVar14 < uVar10) {
      iVar4 = uVar14 * 0x10 + *(int *)(in_ECX + 0x24);
      iVar11 = uVar10 - uVar14;
      if (iVar11 != 0) {
        puVar15 = (undefined4 *)(iVar4 + 0xc);
        do {
          if (iVar4 != 0) {
            puVar15[-2] = 0;
            puVar15[-1] = 0;
            *puVar15 = 0;
          }
          iVar4 = iVar4 + 0x10;
          puVar15 = puVar15 + 4;
          iVar11 = iVar11 + -1;
        } while (iVar11 != 0);
      }
    }
    iVar11 = FUN_00539ca0();
    iVar4 = *(int *)(param_1 + 0x314);
    if (iVar4 == 0) {
      iVar4 = param_1 + 0x28;
    }
    FUN_005b6620(iVar4,7,((*(int *)(iVar4 + 0x30) - *(int *)(iVar4 + 0x34)) - *(int *)(iVar4 + 0x2c)
                         ) + iVar11);
  }
  else {
    if (param_2 == 0x11) {
      piVar5 = *(int **)(*(int *)(param_1 + 0x10) + 0x34);
      if (piVar5 == (int *)0x0) {
        FUN_005b5790(param_1);
        FUN_005b5b20(param_1 + 0x14,
                     "GFxButtonCharacterDef::Read: Audio library is not set. Skipping sound definitions."
                    );
        return;
      }
      piVar5 = (int *)(**(code **)(*piVar5 + 8))();
      uVar6 = (**(code **)(*piVar5 + 4))(param_1);
      *(undefined4 *)(in_ECX + 0x10) = uVar6;
      return;
    }
    if (param_2 == 0x22) {
      cVar2 = FUN_00553200();
      *(bool *)(in_ECX + 0x14) = cVar2 != '\0';
      uVar14 = FUN_00500140();
      iVar4 = *(int *)(param_1 + 0x314);
      if (iVar4 == 0) {
        iVar4 = param_1 + 0x28;
      }
      iVar11 = *(int *)(iVar4 + 0x34);
      iVar13 = *(int *)(iVar4 + 0x30);
      local_4c = (GRefCountNTSImpl *)0x0;
      iVar4 = *(int *)(iVar4 + 0x2c);
      GMatrix2D::SetIdentity(local_48);
      FUN_0059d080();
      local_10 = 0x40000;
      local_4 = 0;
      cVar2 = FUN_005b5b50(param_1,0x22);
      if (cVar2 != '\0') {
        piVar5 = (int *)(in_ECX + 0x18);
        do {
          uVar10 = 0;
          if (*(int *)(in_ECX + 0x1c) != 0) {
            puVar3 = (ushort *)(*piVar5 + 0x40);
            uVar10 = 0;
            do {
              if (local_c < *puVar3) break;
              uVar10 = uVar10 + 1;
              puVar3 = puVar3 + 0x26;
            } while (uVar10 < *(uint *)(in_ECX + 0x1c));
          }
          uVar1 = *(uint *)(in_ECX + 0x1c);
          uVar12 = uVar1 + 1;
          if (uVar12 < uVar1) {
            iVar7 = uVar1 - uVar12;
            puVar15 = (undefined4 *)((iVar7 + uVar12) * 0x4c + -0x4c + *piVar5);
            for (; iVar7 != 0; iVar7 = iVar7 + -1) {
              if ((GRefCountNTSImpl *)*puVar15 != (GRefCountNTSImpl *)0x0) {
                GRefCountNTSImpl::Release((GRefCountNTSImpl *)*puVar15);
              }
              puVar15 = puVar15 + -0x13;
            }
            uVar18 = uVar12;
            if (uVar12 < *(uint *)(in_ECX + 0x20) >> 1) {
LAB_005b9488:
              FUN_005b5e70(piVar5,uVar18);
            }
          }
          else if (*(uint *)(in_ECX + 0x20) <= uVar12) {
            uVar18 = (uVar12 >> 2) + uVar12;
            goto LAB_005b9488;
          }
          *(uint *)(in_ECX + 0x1c) = uVar12;
          if (uVar1 < uVar12) {
            FUN_005b5e20(uVar1 * 0x4c + *piVar5,uVar12 - uVar1);
          }
          if (uVar10 < *(int *)(in_ECX + 0x1c) - 1U) {
            pvVar8 = (void *)(uVar10 * 0x4c + *piVar5);
            _memmove((void *)((int)pvVar8 + 0x4c),pvVar8,
                     ((*(int *)(in_ECX + 0x1c) - uVar10) + -1) * 0x4c);
          }
          if (uVar10 * 0x4c + *piVar5 != 0) {
            FUN_005b5ab0(&local_4c);
          }
          if (local_4c != (GRefCountNTSImpl *)0x0) {
            GRefCountNTSImpl::Release(local_4c);
          }
          local_4c = (GRefCountNTSImpl *)0x0;
          GMatrix2D::SetIdentity(local_48);
          FUN_0059d080();
          local_10 = 0x40000;
          local_4 = 0;
          cVar2 = FUN_005b5b50(param_1,0x22);
        } while (cVar2 != '\0');
      }
      if (local_4c != (GRefCountNTSImpl *)0x0) {
        GRefCountNTSImpl::Release(local_4c);
      }
      if ((uVar14 & 0xffff) != 0) {
        FUN_0053a190((iVar11 - iVar13) + iVar4 + -2 + (uVar14 & 0xffff));
        while( true ) {
          iVar4 = *(int *)(param_1 + 0x314);
          if (iVar4 == 0) {
            iVar4 = param_1 + 0x28;
          }
          *(undefined1 *)(iVar4 + 0x15) = 0;
          if (*(int *)(iVar4 + 0x30) - *(int *)(iVar4 + 0x2c) < 2) {
            FUN_00539fb0(2);
          }
          iVar11 = *(int *)(iVar4 + 0x2c);
          uVar10 = (uint)CONCAT11(*(undefined1 *)(*(int *)(iVar4 + 0x3c) + 1 + iVar11),
                                  *(undefined1 *)(*(int *)(iVar4 + 0x3c) + iVar11));
          *(int *)(iVar4 + 0x2c) = iVar11 + 2;
          iVar4 = FUN_00528f40();
          uVar14 = *(uint *)(in_ECX + 0x28);
          uVar12 = *(int *)(in_ECX + 0x28) + 1;
          FUN_005b8f40((int *)(in_ECX + 0x24),uVar12);
          if (uVar14 < uVar12) {
            iVar11 = uVar14 * 0x10 + *(int *)(in_ECX + 0x24);
            iVar13 = uVar12 - uVar14;
            if (iVar13 != 0) {
              puVar15 = (undefined4 *)(iVar11 + 0xc);
              do {
                if (iVar11 != 0) {
                  puVar15[-2] = 0;
                  puVar15[-1] = 0;
                  *puVar15 = 0;
                }
                iVar11 = iVar11 + 0x10;
                puVar15 = puVar15 + 4;
                iVar13 = iVar13 + -1;
              } while (iVar13 != 0);
            }
          }
          if (uVar10 == 0) {
            iVar11 = FUN_00539ca0();
            iVar13 = FUN_00528f40();
            iVar11 = iVar11 - iVar13;
          }
          else {
            iVar11 = uVar10 - 2;
          }
          uVar17 = 0x22;
          uVar6 = FUN_00500130(0x22,iVar11);
          FUN_005b6620(uVar6,uVar17,iVar11);
          if (uVar10 == 0) break;
          iVar11 = FUN_00539ca0();
          iVar13 = FUN_00528f40();
          if (iVar11 <= iVar13) {
            return;
          }
          FUN_0053a190(iVar4 + -2 + uVar10);
        }
      }
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005b9070 : SUB ESP,0xac
005b9076 : MOV EAX,dword ptr [ESP + 0xb4]
005b907d : PUSH EBX
005b907e : PUSH EBP
005b907f : PUSH ESI
005b9080 : MOV EBX,ECX
005b9082 : PUSH EDI
005b9083 : MOV dword ptr [ESP + 0x10],EBX
005b9087 : CMP EAX,0x7
005b908a : JNZ 0x005b931d
005b9090 : LEA ECX,[ESP + 0x28]
005b9094 : MOV dword ptr [ESP + 0x24],0x0
005b909c : CALL 0x00522b80
005b90a1 : LEA ECX,[ESP + 0x40]
005b90a5 : CALL 0x0059d080
005b90aa : MOV EAX,dword ptr [ESP + 0xc0]
005b90b1 : PUSH 0x7
005b90b3 : PUSH EAX
005b90b4 : LEA ECX,[ESP + 0x2c]
005b90b8 : MOV dword ptr [ESP + 0x68],0x40000
005b90c0 : MOV byte ptr [ESP + 0x74],0x0
005b90c5 : CALL 0x005b5b50
005b90ca : TEST AL,AL
005b90cc : JZ 0x005b925a
005b90d2 : XOR EDI,EDI
005b90d4 : CMP dword ptr [EBX + 0x1c],EDI
005b90d7 : JBE 0x005b90f2
005b90d9 : MOV EAX,dword ptr [EBX + 0x18]
005b90dc : MOV CX,word ptr [ESP + 0x64]
005b90e1 : ADD EAX,0x40
005b90e4 : CMP word ptr [EAX],CX
005b90e7 : JA 0x005b90f2
005b90e9 : INC EDI
005b90ea : ADD EAX,0x4c
005b90ed : CMP EDI,dword ptr [EBX + 0x1c]
005b90f0 : JC 0x005b90e4
005b90f2 : MOV EBP,dword ptr [EBX + 0x1c]
005b90f5 : LEA ECX,[EBX + 0x18]
005b90f8 : LEA ESI,[EBP + 0x1]
005b90fb : CMP ESI,EBP
005b90fd : JNC 0x005b92d1
005b9103 : MOV ECX,dword ptr [ESP + 0x10]
005b9107 : MOV EAX,EBP
005b9109 : SUB EAX,ESI
005b910b : LEA EDX,[EAX + ESI*0x1]
005b910e : IMUL EDX,EDX,0x4c
005b9111 : ADD ECX,0x18
005b9114 : MOV ECX,dword ptr [ECX]
005b9116 : LEA EBX,[EDX + ECX*0x1 + -0x4c]
005b911a : TEST EAX,EAX
005b911c : JBE 0x005b9137
005b911e : MOV dword ptr [ESP + 0x14],EAX
005b9122 : MOV ECX,dword ptr [EBX]
005b9124 : TEST ECX,ECX
005b9126 : JZ 0x005b912d
005b9128 : CALL 0x004ff7c0
005b912d : SUB EBX,0x4c
005b9130 : SUB dword ptr [ESP + 0x14],0x1
005b9135 : JNZ 0x005b9122
005b9137 : MOV EAX,dword ptr [ESP + 0x10]
005b913b : MOV EDX,dword ptr [EAX + 0x20]
005b913e : ADD EAX,0x18
005b9141 : SHR EDX,0x1
005b9143 : CMP ESI,EDX
005b9145 : JNC 0x005b9155
005b9147 : MOV ECX,dword ptr [ESP + 0x10]
005b914b : PUSH ESI
005b914c : ADD ECX,0x18
005b914f : PUSH ECX
005b9150 : CALL 0x005b5e70
005b9155 : MOV EBX,dword ptr [ESP + 0x10]
005b9159 : MOV dword ptr [EBX + 0x1c],ESI
005b915c : CMP ESI,EBP
005b915e : JBE 0x005b9172
005b9160 : SUB ESI,EBP
005b9162 : IMUL EBP,EBP,0x4c
005b9165 : ADD EBP,dword ptr [EBX + 0x18]
005b9168 : PUSH ESI
005b9169 : PUSH EBP
005b916a : CALL 0x005b5e20
005b916f : ADD ESP,0x8
005b9172 : MOV EAX,dword ptr [EBX + 0x1c]
005b9175 : LEA ECX,[EAX + -0x1]
005b9178 : CMP EDI,ECX
005b917a : JNC 0x005b919a
005b917c : MOV ECX,dword ptr [EBX + 0x18]
005b917f : SUB EAX,EDI
005b9181 : DEC EAX
005b9182 : MOV EDX,EDI
005b9184 : IMUL EAX,EAX,0x4c
005b9187 : IMUL EDX,EDX,0x4c
005b918a : ADD ECX,EDX
005b918c : PUSH EAX
005b918d : PUSH ECX
005b918e : ADD ECX,0x4c
005b9191 : PUSH ECX
005b9192 : CALL 0x00636880
005b9197 : ADD ESP,0xc
005b919a : IMUL EDI,EDI,0x4c
005b919d : ADD EDI,dword ptr [EBX + 0x18]
005b91a0 : MOV EAX,EDI
005b91a2 : JZ 0x005b920b
005b91a4 : MOV ECX,dword ptr [ESP + 0x24]
005b91a8 : TEST ECX,ECX
005b91aa : JZ 0x005b91b3
005b91ac : INC dword ptr [ECX + 0x4]
005b91af : MOV ECX,dword ptr [ESP + 0x24]
005b91b3 : MOV dword ptr [EAX],ECX
005b91b5 : FLD float ptr [ESP + 0x28]
005b91b9 : FSTP float ptr [EAX + 0x4]
005b91bc : LEA EDI,[EAX + 0x1c]
005b91bf : FLD float ptr [ESP + 0x2c]
005b91c3 : MOV ECX,0x8
005b91c8 : FSTP float ptr [EAX + 0x8]
005b91cb : LEA ESI,[ESP + 0x40]
005b91cf : FLD float ptr [ESP + 0x30]
005b91d3 : FSTP float ptr [EAX + 0xc]
005b91d6 : FLD float ptr [ESP + 0x34]
005b91da : FSTP float ptr [EAX + 0x10]
005b91dd : FLD float ptr [ESP + 0x38]
005b91e1 : FSTP float ptr [EAX + 0x14]
005b91e4 : FLD float ptr [ESP + 0x3c]
005b91e8 : FSTP float ptr [EAX + 0x18]
005b91eb : MOVSD.REP ES:EDI,ESI
005b91ed : MOV EDX,dword ptr [ESP + 0x60]
005b91f1 : MOV dword ptr [EAX + 0x3c],EDX
005b91f4 : MOV CX,word ptr [ESP + 0x64]
005b91f9 : MOV word ptr [EAX + 0x40],CX
005b91fd : MOV EDX,dword ptr [ESP + 0x68]
005b9201 : MOV dword ptr [EAX + 0x44],EDX
005b9204 : MOV CL,byte ptr [ESP + 0x6c]
005b9208 : MOV byte ptr [EAX + 0x48],CL
005b920b : MOV ECX,dword ptr [ESP + 0x24]
005b920f : TEST ECX,ECX
005b9211 : JZ 0x005b9218
005b9213 : CALL 0x004ff7c0
005b9218 : LEA ECX,[ESP + 0x28]
005b921c : MOV dword ptr [ESP + 0x24],0x0
005b9224 : CALL 0x00522b80
005b9229 : LEA ECX,[ESP + 0x40]
005b922d : CALL 0x0059d080
005b9232 : MOV EDX,dword ptr [ESP + 0xc0]
005b9239 : PUSH 0x7
005b923b : PUSH EDX
005b923c : LEA ECX,[ESP + 0x2c]
005b9240 : MOV dword ptr [ESP + 0x68],0x40000
005b9248 : MOV byte ptr [ESP + 0x74],0x0
005b924d : CALL 0x005b5b50
005b9252 : TEST AL,AL
005b9254 : JNZ 0x005b90d2
005b925a : MOV ECX,dword ptr [ESP + 0x24]
005b925e : XOR EBP,EBP
005b9260 : CMP ECX,EBP
005b9262 : JZ 0x005b9269
005b9264 : CALL 0x004ff7c0
005b9269 : MOV ESI,dword ptr [EBX + 0x28]
005b926c : MOV EDI,dword ptr [EBX + 0x28]
005b926f : INC ESI
005b9270 : ADD EBX,0x24
005b9273 : PUSH ESI
005b9274 : PUSH EBX
005b9275 : MOV ECX,EBX
005b9277 : CALL 0x005b8f40
005b927c : CMP ESI,EDI
005b927e : JBE 0x005b92a7
005b9280 : MOV EAX,EDI
005b9282 : SHL EAX,0x4
005b9285 : ADD EAX,dword ptr [EBX]
005b9287 : SUB ESI,EDI
005b9289 : JZ 0x005b92a7
005b928b : LEA ECX,[EAX + 0xc]
005b928e : MOV EDI,EDI
005b9290 : CMP EAX,EBP
005b9292 : JZ 0x005b929c
005b9294 : MOV dword ptr [ECX + -0x8],EBP
005b9297 : MOV dword ptr [ECX + -0x4],EBP
005b929a : MOV dword ptr [ECX],EBP
005b929c : ADD EAX,0x10
005b929f : ADD ECX,0x10
005b92a2 : SUB ESI,0x1
005b92a5 : JNZ 0x005b9290
005b92a7 : MOV ESI,dword ptr [ESP + 0xc0]
005b92ae : MOV ECX,dword ptr [ESI + 0x314]
005b92b4 : CMP ECX,EBP
005b92b6 : JNZ 0x005b92bb
005b92b8 : LEA ECX,[ESI + 0x28]
005b92bb : CALL 0x00539ca0
005b92c0 : MOV EDX,dword ptr [ESI + 0x314]
005b92c6 : LEA ECX,[ESI + 0x28]
005b92c9 : CMP EDX,EBP
005b92cb : JZ 0x005b92ed
005b92cd : MOV ECX,EDX
005b92cf : JMP 0x005b92f0
005b92d1 : CMP ESI,dword ptr [ECX + 0x8]
005b92d4 : JC 0x005b9159
005b92da : MOV EAX,ESI
005b92dc : SHR EAX,0x2
005b92df : ADD EAX,ESI
005b92e1 : PUSH EAX
005b92e2 : PUSH ECX
005b92e3 : CALL 0x005b5e70
005b92e8 : JMP 0x005b9159
005b92ed : LEA EDX,[ESI + 0x28]
005b92f0 : MOV ESI,dword ptr [ECX + 0x30]
005b92f3 : SUB ESI,dword ptr [ECX + 0x34]
005b92f6 : SUB ESI,dword ptr [ECX + 0x2c]
005b92f9 : MOV ECX,dword ptr [EBX]
005b92fb : ADD ESI,EAX
005b92fd : MOV EAX,dword ptr [EBX + 0x4]
005b9300 : PUSH ESI
005b9301 : PUSH 0x7
005b9303 : SHL EAX,0x4
005b9306 : PUSH EDX
005b9307 : LEA ECX,[EAX + ECX*0x1 + -0x10]
005b930b : CALL 0x005b6620
005b9310 : POP EDI
005b9311 : POP ESI
005b9312 : POP EBP
005b9313 : POP EBX
005b9314 : ADD ESP,0xac
005b931a : RET 0x8
005b931d : CMP EAX,0x11
005b9320 : JNZ 0x005b9378
005b9322 : MOV ESI,dword ptr [ESP + 0xc0]
005b9329 : MOV EDX,dword ptr [ESI + 0x10]
005b932c : MOV ECX,dword ptr [EDX + 0x34]
005b932f : TEST ECX,ECX
005b9331 : JZ 0x005b9354
005b9333 : MOV EAX,dword ptr [ECX]
005b9335 : MOV EDX,dword ptr [EAX + 0x8]
005b9338 : CALL EDX
005b933a : MOV EDX,dword ptr [EAX]
005b933c : MOV ECX,EAX
005b933e : MOV EAX,dword ptr [EDX + 0x4]
005b9341 : PUSH ESI
005b9342 : CALL EAX
005b9344 : POP EDI
005b9345 : POP ESI
005b9346 : POP EBP
005b9347 : MOV dword ptr [EBX + 0x10],EAX
005b934a : POP EBX
005b934b : ADD ESP,0xac
005b9351 : RET 0x8
005b9354 : PUSH ESI
005b9355 : CALL 0x005b5790
005b935a : PUSH 0xb90940
005b935f : ADD ESI,0x14
005b9362 : PUSH ESI
005b9363 : CALL 0x005b5b20
005b9368 : ADD ESP,0xc
005b936b : POP EDI
005b936c : POP ESI
005b936d : POP EBP
005b936e : POP EBX
005b936f : ADD ESP,0xac
005b9375 : RET 0x8
005b9378 : CMP EAX,0x22
005b937b : JNZ 0x005b9310
005b937d : MOV ESI,dword ptr [ESP + 0xc0]
005b9384 : MOV ECX,ESI
005b9386 : CALL 0x00553200
005b938b : TEST AL,AL
005b938d : SETNZ CL
005b9390 : MOV byte ptr [EBX + 0x14],CL
005b9393 : MOV ECX,ESI
005b9395 : CALL 0x00500140
005b939a : MOVZX ECX,AX
005b939d : MOV EAX,dword ptr [ESI + 0x314]
005b93a3 : MOV dword ptr [ESP + 0x20],ECX
005b93a7 : TEST EAX,EAX
005b93a9 : JNZ 0x005b93ae
005b93ab : LEA EAX,[ESI + 0x28]
005b93ae : MOV EDX,dword ptr [EAX + 0x34]
005b93b1 : SUB EDX,dword ptr [EAX + 0x30]
005b93b4 : MOV dword ptr [ESP + 0x70],0x0
005b93bc : ADD EDX,dword ptr [EAX + 0x2c]
005b93bf : LEA EAX,[EDX + ECX*0x1 + -0x2]
005b93c3 : LEA ECX,[ESP + 0x74]
005b93c7 : MOV dword ptr [ESP + 0x14],EAX
005b93cb : CALL 0x00522b80
005b93d0 : LEA ECX,[ESP + 0x8c]
005b93d7 : CALL 0x0059d080
005b93dc : PUSH 0x22
005b93de : PUSH ESI
005b93df : LEA ECX,[ESP + 0x78]
005b93e3 : MOV dword ptr [ESP + 0xb4],0x40000
005b93ee : MOV byte ptr [ESP + 0xc0],0x0
005b93f6 : CALL 0x005b5b50
005b93fb : TEST AL,AL
005b93fd : JZ 0x005b953a
005b9403 : ADD EBX,0x18
005b9406 : MOV ECX,dword ptr [ESP + 0x10]
005b940a : XOR EDI,EDI
005b940c : CMP dword ptr [ECX + 0x1c],EDI
005b940f : JBE 0x005b942e
005b9411 : MOV EAX,dword ptr [EBX]
005b9413 : MOV DX,word ptr [ESP + 0xb0]
005b941b : ADD EAX,0x40
005b941e : MOV EDI,EDI
005b9420 : CMP word ptr [EAX],DX
005b9423 : JA 0x005b942e
005b9425 : INC EDI
005b9426 : ADD EAX,0x4c
005b9429 : CMP EDI,dword ptr [ECX + 0x1c]
005b942c : JC 0x005b9420
005b942e : MOV EBP,dword ptr [EBX + 0x4]
005b9431 : LEA ESI,[EBP + 0x1]
005b9434 : CMP ESI,EBP
005b9436 : JNC 0x005b947b
005b9438 : MOV EDX,dword ptr [EBX]
005b943a : MOV EAX,EBP
005b943c : SUB EAX,ESI
005b943e : LEA ECX,[EAX + ESI*0x1]
005b9441 : IMUL ECX,ECX,0x4c
005b9444 : LEA ECX,[ECX + EDX*0x1 + -0x4c]
005b9448 : MOV dword ptr [ESP + 0x1c],ECX
005b944c : TEST EAX,EAX
005b944e : JBE 0x005b946f
005b9450 : MOV dword ptr [ESP + 0x18],EAX
005b9454 : MOV EDX,dword ptr [ESP + 0x1c]
005b9458 : MOV ECX,dword ptr [EDX]
005b945a : TEST ECX,ECX
005b945c : JZ 0x005b9463
005b945e : CALL 0x004ff7c0
005b9463 : SUB dword ptr [ESP + 0x1c],0x4c
005b9468 : SUB dword ptr [ESP + 0x18],0x1
005b946d : JNZ 0x005b9454
005b946f : MOV EAX,dword ptr [EBX + 0x8]
005b9472 : SHR EAX,0x1
005b9474 : CMP ESI,EAX
005b9476 : JNC 0x005b9490
005b9478 : PUSH ESI
005b9479 : JMP 0x005b9488
005b947b : CMP ESI,dword ptr [EBX + 0x8]
005b947e : JC 0x005b9490
005b9480 : MOV ECX,ESI
005b9482 : SHR ECX,0x2
005b9485 : ADD ECX,ESI
005b9487 : PUSH ECX
005b9488 : PUSH EBX
005b9489 : MOV ECX,EBX
005b948b : CALL 0x005b5e70
005b9490 : MOV dword ptr [EBX + 0x4],ESI
005b9493 : CMP ESI,EBP
005b9495 : JBE 0x005b94a8
005b9497 : SUB ESI,EBP
005b9499 : IMUL EBP,EBP,0x4c
005b949c : ADD EBP,dword ptr [EBX]
005b949e : PUSH ESI
005b949f : PUSH EBP
005b94a0 : CALL 0x005b5e20
005b94a5 : ADD ESP,0x8
005b94a8 : MOV EAX,dword ptr [EBX + 0x4]
005b94ab : LEA EDX,[EAX + -0x1]
005b94ae : CMP EDI,EDX
005b94b0 : JNC 0x005b94cf
005b94b2 : MOV EDX,dword ptr [EBX]
005b94b4 : SUB EAX,EDI
005b94b6 : DEC EAX
005b94b7 : MOV ECX,EDI
005b94b9 : IMUL EAX,EAX,0x4c
005b94bc : IMUL ECX,ECX,0x4c
005b94bf : ADD ECX,EDX
005b94c1 : PUSH EAX
005b94c2 : PUSH ECX
005b94c3 : ADD ECX,0x4c
005b94c6 : PUSH ECX
005b94c7 : CALL 0x00636880
005b94cc : ADD ESP,0xc
005b94cf : IMUL EDI,EDI,0x4c
005b94d2 : ADD EDI,dword ptr [EBX]
005b94d4 : JZ 0x005b94e2
005b94d6 : LEA EAX,[ESP + 0x70]
005b94da : PUSH EAX
005b94db : MOV ECX,EDI
005b94dd : CALL 0x005b5ab0
005b94e2 : MOV ECX,dword ptr [ESP + 0x70]
005b94e6 : TEST ECX,ECX
005b94e8 : JZ 0x005b94ef
005b94ea : CALL 0x004ff7c0
005b94ef : LEA ECX,[ESP + 0x74]
005b94f3 : MOV dword ptr [ESP + 0x70],0x0
005b94fb : CALL 0x00522b80
005b9500 : LEA ECX,[ESP + 0x8c]
005b9507 : CALL 0x0059d080
005b950c : MOV ECX,dword ptr [ESP + 0xc0]
005b9513 : PUSH 0x22
005b9515 : PUSH ECX
005b9516 : LEA ECX,[ESP + 0x78]
005b951a : MOV dword ptr [ESP + 0xb4],0x40000
005b9525 : MOV byte ptr [ESP + 0xc0],0x0
005b952d : CALL 0x005b5b50
005b9532 : TEST AL,AL
005b9534 : JNZ 0x005b9406
005b953a : MOV ECX,dword ptr [ESP + 0x70]
005b953e : TEST ECX,ECX
005b9540 : JZ 0x005b9547
005b9542 : CALL 0x004ff7c0
005b9547 : CMP dword ptr [ESP + 0x20],0x0
005b954c : JLE 0x005b9310
005b9552 : MOV ESI,dword ptr [ESP + 0xc0]
005b9559 : MOV ECX,dword ptr [ESI + 0x314]
005b955f : TEST ECX,ECX
005b9561 : JNZ 0x005b9566
005b9563 : LEA ECX,[ESI + 0x28]
005b9566 : MOV EDX,dword ptr [ESP + 0x14]
005b956a : PUSH EDX
005b956b : CALL 0x0053a190
005b9570 : MOV EBP,dword ptr [ESP + 0x10]
005b9574 : ADD EBP,0x24
005b9577 : JMP 0x005b9580
005b9580 : MOV EAX,dword ptr [ESI + 0x314]
005b9586 : TEST EAX,EAX
005b9588 : JNZ 0x005b958f
005b958a : ADD ESI,0x28
005b958d : JMP 0x005b9591
005b958f : MOV ESI,EAX
005b9591 : MOV EAX,dword ptr [ESI + 0x30]
005b9594 : SUB EAX,dword ptr [ESI + 0x2c]
005b9597 : MOV byte ptr [ESI + 0x15],0x0
005b959b : CMP EAX,0x2
005b959e : JGE 0x005b95a9
005b95a0 : PUSH 0x2
005b95a2 : MOV ECX,ESI
005b95a4 : CALL 0x00539fb0
005b95a9 : MOV EAX,dword ptr [ESI + 0x2c]
005b95ac : MOV ECX,dword ptr [ESI + 0x3c]
005b95af : MOVZX DX,byte ptr [ECX + EAX*0x1 + 0x1]
005b95b5 : MOV EBX,dword ptr [ESP + 0xc0]
005b95bc : ADD ECX,EAX
005b95be : MOVZX CX,byte ptr [ECX]
005b95c2 : SHL DX,0x8
005b95c6 : OR DX,CX
005b95c9 : MOVZX ECX,DX
005b95cc : ADD EAX,0x2
005b95cf : MOV dword ptr [ESI + 0x2c],EAX
005b95d2 : MOVZX ESI,CX
005b95d5 : MOV ECX,EBX
005b95d7 : MOV dword ptr [ESP + 0x18],ESI
005b95db : CALL 0x00528f40
005b95e0 : MOV EDI,dword ptr [EBP + 0x4]
005b95e3 : LEA EDX,[EAX + ESI*0x1 + -0x2]
005b95e7 : MOV EAX,dword ptr [ESP + 0x10]
005b95eb : MOV ESI,dword ptr [EAX + 0x28]
005b95ee : INC ESI
005b95ef : PUSH ESI
005b95f0 : PUSH EBP
005b95f1 : MOV ECX,EBP
005b95f3 : MOV dword ptr [ESP + 0x1c],EDX
005b95f7 : CALL 0x005b8f40
005b95fc : CMP ESI,EDI
005b95fe : JBE 0x005b962a
005b9600 : MOV EAX,EDI
005b9602 : SHL EAX,0x4
005b9605 : ADD EAX,dword ptr [EBP]
005b9608 : SUB ESI,EDI
005b960a : JZ 0x005b962a
005b960c : LEA ECX,[EAX + 0xc]
005b960f : XOR EDI,EDI
005b9611 : CMP EAX,EDI
005b9613 : JZ 0x005b961d
005b9615 : MOV dword ptr [ECX + -0x8],EDI
005b9618 : MOV dword ptr [ECX + -0x4],EDI
005b961b : MOV dword ptr [ECX],EDI
005b961d : ADD EAX,0x10
005b9620 : ADD ECX,0x10
005b9623 : SUB ESI,0x1
005b9626 : JNZ 0x005b9611
005b9628 : JMP 0x005b962c
005b962a : XOR EDI,EDI
005b962c : MOV EAX,dword ptr [ESP + 0x18]
005b9630 : CMP EAX,EDI
005b9632 : JZ 0x005b9639
005b9634 : LEA ESI,[EAX + -0x2]
005b9637 : JMP 0x005b9656
005b9639 : MOV ECX,dword ptr [EBX + 0x314]
005b963f : CMP ECX,EDI
005b9641 : JNZ 0x005b9646
005b9643 : LEA ECX,[EBX + 0x28]
005b9646 : CALL 0x00539ca0
005b964b : MOV ECX,EBX
005b964d : MOV ESI,EAX
005b964f : CALL 0x00528f40
005b9654 : SUB ESI,EAX
005b9656 : PUSH ESI
005b9657 : PUSH 0x22
005b9659 : MOV ECX,EBX
005b965b : CALL 0x00500130
005b9660 : MOV ECX,dword ptr [EBP + 0x4]
005b9663 : MOV EDX,dword ptr [EBP]
005b9666 : SHL ECX,0x4
005b9669 : PUSH EAX
005b966a : LEA ECX,[ECX + EDX*0x1 + -0x10]
005b966e : CALL 0x005b6620
005b9673 : CMP dword ptr [ESP + 0x18],EDI
005b9677 : JZ 0x005b9310
005b967d : MOV EAX,dword ptr [EBX + 0x314]
005b9683 : CMP EAX,EDI
005b9685 : JNZ 0x005b968a
005b9687 : LEA EAX,[EBX + 0x28]
005b968a : MOV ECX,EAX
005b968c : CALL 0x00539ca0
005b9691 : MOV ECX,EBX
005b9693 : MOV ESI,EAX
005b9695 : CALL 0x00528f40
005b969a : CMP EAX,ESI
005b969c : JGE 0x005b9310
005b96a2 : MOV EAX,dword ptr [EBX + 0x314]
005b96a8 : CMP EAX,EDI
005b96aa : JNZ 0x005b96af
005b96ac : LEA EAX,[EBX + 0x28]
005b96af : MOV ECX,dword ptr [ESP + 0x14]
005b96b3 : PUSH ECX
005b96b4 : MOV ECX,EAX
005b96b6 : CALL 0x0053a190
005b96bb : MOV ESI,EBX
005b96bd : JMP 0x005b9580

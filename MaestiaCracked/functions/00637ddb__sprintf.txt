PROGRAM  : Maestia.exe
FUNCTION : _sprintf
ENTRY    : 00637ddb
BODY     : [[00637ddb, 00637e57]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    _sprintf
   
   Library: Visual Studio 2008 Release */

int __cdecl _sprintf(char *_Dest,char *_Format,...)

{
  int *piVar1;
  int iVar2;
  FILE local_24;
  
  if ((_Format == (char *)0x0) || (_Dest == (char *)0x0)) {
    piVar1 = __errno();
    *piVar1 = 0x16;
    __invalid_parameter(0,0,0,0,0);
    iVar2 = -1;
  }
  else {
    local_24._base = _Dest;
    local_24._ptr = _Dest;
    local_24._cnt = 0x7fffffff;
    local_24._flag = 0x42;
    iVar2 = __output_l(&local_24,_Format,(_locale_t)0x0,&stack0x0000000c);
    local_24._cnt = local_24._cnt + -1;
    if (local_24._cnt < 0) {
      __flsbuf(0,&local_24);
    }
    else {
      *local_24._ptr = '\0';
    }
  }
  return iVar2;
}



============================================================
DISASSEMBLY
============================================================
00637ddb : MOV EDI,EDI
00637ddd : PUSH EBP
00637dde : MOV EBP,ESP
00637de0 : SUB ESP,0x20
00637de3 : PUSH EBX
00637de4 : XOR EBX,EBX
00637de6 : CMP dword ptr [EBP + 0xc],EBX
00637de9 : JNZ 0x00637e08
00637deb : CALL 0x0063ab82
00637df0 : PUSH EBX
00637df1 : PUSH EBX
00637df2 : PUSH EBX
00637df3 : PUSH EBX
00637df4 : PUSH EBX
00637df5 : MOV dword ptr [EAX],0x16
00637dfb : CALL 0x006372b8
00637e00 : ADD ESP,0x14
00637e03 : OR EAX,0xffffffff
00637e06 : JMP 0x00637e55
00637e08 : MOV EAX,dword ptr [EBP + 0x8]
00637e0b : CMP EAX,EBX
00637e0d : JZ 0x00637deb
00637e0f : PUSH ESI
00637e10 : MOV dword ptr [EBP + -0x18],EAX
00637e13 : MOV dword ptr [EBP + -0x20],EAX
00637e16 : LEA EAX,[EBP + 0x10]
00637e19 : PUSH EAX
00637e1a : PUSH EBX
00637e1b : PUSH dword ptr [EBP + 0xc]
00637e1e : LEA EAX,[EBP + -0x20]
00637e21 : PUSH EAX
00637e22 : MOV dword ptr [EBP + -0x1c],0x7fffffff
00637e29 : MOV dword ptr [EBP + -0x14],0x42
00637e30 : CALL 0x0064a9ad
00637e35 : ADD ESP,0x10
00637e38 : DEC dword ptr [EBP + -0x1c]
00637e3b : MOV ESI,EAX
00637e3d : JS 0x00637e46
00637e3f : MOV EAX,dword ptr [EBP + -0x20]
00637e42 : MOV byte ptr [EAX],BL
00637e44 : JMP 0x00637e52
00637e46 : LEA EAX,[EBP + -0x20]
00637e49 : PUSH EAX
00637e4a : PUSH EBX
00637e4b : CALL 0x00645eff
00637e50 : POP ECX
00637e51 : POP ECX
00637e52 : MOV EAX,ESI
00637e54 : POP ESI
00637e55 : POP EBX
00637e56 : LEAVE
00637e57 : RET

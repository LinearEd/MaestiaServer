PROGRAM  : Maestia.exe
FUNCTION : _store_winword
ENTRY    : 006445aa
BODY     : [[006445aa, 00644a0a]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe_16 replaced with injection: alloca_probe */
/* Library Function - Single Match
    int __cdecl _store_winword(struct localeinfo_struct *,int,struct tm const *,char * *,unsigned
   int *,struct __lc_time_data *)
   
   Library: Visual Studio 2008 Release */

int __cdecl
_store_winword(localeinfo_struct *param_1,int param_2,tm *param_3,char **param_4,uint *param_5,
              __lc_time_data *param_6)

{
  code cVar1;
  undefined4 *puVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  uint unaff_EBX;
  char **ppcVar6;
  __lc_time_data *unaff_ESI;
  uint *unaff_EDI;
  code *_Str1;
  code *pcVar7;
  char *pcVar8;
  char *pcVar9;
  short local_24;
  short local_22;
  undefined2 local_1e;
  undefined2 local_1c;
  undefined2 local_1a;
  undefined2 local_18;
  undefined2 local_16;
  int local_14;
  code *local_10;
  char **local_c;
  uint local_8;
  
  local_8 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  if (param_2 == 0) {
    _Str1 = (code *)param_6->ww_sdatefmt;
  }
  else if (param_2 == 1) {
    _Str1 = (code *)param_6->ww_ldatefmt;
  }
  else {
    _Str1 = (code *)param_6->ww_timefmt;
  }
  if (param_6->refcount != 1) {
    local_10 = GetDateFormatA_exref;
    if (param_2 == 2) {
      local_10 = GetTimeFormatA_exref;
    }
    local_24 = (short)param_3->tm_year + 0x76c;
    local_22 = (short)param_3->tm_mon + 1;
    local_1e = (undefined2)param_3->tm_mday;
    local_1c = (undefined2)param_3->tm_hour;
    local_1a = (undefined2)param_3->tm_min;
    local_18 = (undefined2)param_3->tm_sec;
    local_16 = 0;
    local_14 = (*local_10)(param_6->ww_caltype,0,&local_24,_Str1,0,0);
    if (local_14 != 0) {
      if ((int)(local_14 + 8U) < 0x401) {
        puVar2 = (undefined4 *)&stack0xffffffd0;
        ppcVar6 = (char **)&stack0xffffffd0;
        if (&stack0x00000000 != (undefined1 *)0x30) {
          unaff_EDI = (uint *)0xcccc;
LAB_0064468e:
          ppcVar6 = (char **)(puVar2 + 2);
        }
      }
      else {
        puVar2 = _malloc(local_14 + 8U);
        ppcVar6 = (char **)0x0;
        if (puVar2 != (undefined4 *)0x0) {
          *puVar2 = 0xdddd;
          goto LAB_0064468e;
        }
      }
      local_c = ppcVar6;
      if (ppcVar6 != (char **)0x0) {
        iVar3 = (*local_10)(param_6->ww_caltype,0,&local_24,_Str1,ppcVar6,local_14);
        while ((iVar3 = iVar3 + -1, 0 < iVar3 && (*param_5 != 0))) {
          local_14 = iVar3;
          **param_4 = *(char *)ppcVar6;
          *param_4 = *param_4 + 1;
          ppcVar6 = (char **)((int)ppcVar6 + 1);
          *param_5 = *param_5 - 1;
        }
        FUN_0040dc20(local_c);
LAB_006446e0:
        iVar3 = __security_check_cookie(local_8 ^ (uint)&stack0xfffffffc);
        return iVar3;
      }
    }
  }
  cVar1 = *_Str1;
joined_r0x006446f6:
  if ((cVar1 == (code)0x0) || (*param_5 == 0)) goto LAB_006446e0;
  local_c = (char **)0x0;
  local_10 = _Str1;
  uVar5 = 0;
  do {
    uVar4 = uVar5;
    local_10 = local_10 + 1;
    uVar5 = uVar4 + 1;
  } while (*local_10 == cVar1);
  iVar3 = (int)(char)cVar1;
  if (iVar3 < 0x65) {
    if (iVar3 == 100) {
      if (uVar4 == 0) {
        local_c = (char **)0x1;
      }
      else {
joined_r0x00644879:
        if ((uVar4 != 1) && (uVar4 != 2)) {
joined_r0x0064487f:
          if (uVar4 != 3) goto LAB_0064474a;
        }
      }
      goto LAB_006449e1;
    }
    if (iVar3 != 0x27) {
      if (iVar3 == 0x41) {
LAB_006447d2:
        iVar3 = ___ascii_stricmp((char *)_Str1,"am/pm");
        if (iVar3 == 0) {
          local_10 = _Str1 + 5;
        }
        else {
          iVar3 = ___ascii_stricmp((char *)_Str1,"a/p");
          if (iVar3 == 0) {
            local_10 = _Str1 + 3;
          }
        }
      }
      else if (iVar3 == 0x48) {
        if (uVar4 != 0) goto joined_r0x006449d1;
        local_c = (char **)0x1;
      }
      else {
        if (iVar3 != 0x4d) {
          if (iVar3 != 0x61) goto LAB_0064474a;
          goto LAB_006447d2;
        }
        if (uVar4 != 0) goto joined_r0x00644879;
        local_c = (char **)0x1;
      }
      goto LAB_006449e1;
    }
    _Str1 = _Str1 + uVar5;
    if ((uVar5 & 1) != 0) {
      cVar1 = *_Str1;
      if (cVar1 == (code)0x0) goto LAB_006446e0;
      do {
        if (*param_5 == 0) break;
        if (cVar1 == (code)0x27) {
          _Str1 = _Str1 + 1;
          break;
        }
        iVar3 = __isleadbyte_l((int)(char)cVar1,param_1);
        pcVar7 = _Str1;
        if ((iVar3 != 0) && (1 < *param_5)) {
          pcVar7 = _Str1 + 1;
          if (*pcVar7 == (code)0x0) goto LAB_006446e0;
          **param_4 = (char)*_Str1;
          *param_4 = *param_4 + 1;
          *param_5 = *param_5 - 1;
        }
        **param_4 = (char)*pcVar7;
        *param_4 = *param_4 + 1;
        _Str1 = pcVar7 + 1;
        *param_5 = *param_5 - 1;
        cVar1 = *_Str1;
      } while (cVar1 != (code)0x0);
    }
  }
  else {
    if (iVar3 == 0x68) {
      if (uVar4 == 0) {
        local_c = (char **)0x1;
      }
      else {
joined_r0x006449d1:
        if (uVar5 != 2) {
LAB_0064474a:
          iVar3 = __isleadbyte_l(iVar3,param_1);
          pcVar7 = _Str1;
          if ((iVar3 != 0) && (1 < *param_5)) {
            pcVar7 = _Str1 + 1;
            if (*pcVar7 == (code)0x0) goto LAB_006446e0;
            **param_4 = (char)*_Str1;
            *param_4 = *param_4 + 1;
            *param_5 = *param_5 - 1;
          }
          **param_4 = (char)*pcVar7;
          *param_4 = *param_4 + 1;
          *param_5 = *param_5 - 1;
          _Str1 = pcVar7 + 1;
          goto LAB_00644781;
        }
      }
    }
    else if (iVar3 == 0x6d) {
      if (uVar4 != 0) goto joined_r0x006449d1;
      local_c = (char **)0x1;
    }
    else if (iVar3 == 0x73) {
      if (uVar4 != 0) goto joined_r0x006449d1;
      local_c = (char **)0x1;
    }
    else {
      if (iVar3 == 0x74) {
        if (param_3->tm_hour < 0xc) {
          pcVar9 = param_6->ampm[0];
        }
        else {
          pcVar9 = param_6->ampm[1];
        }
        if ((uVar5 == 1) && (*param_5 != 0)) {
          iVar3 = __isleadbyte_l((int)*pcVar9,param_1);
          pcVar8 = pcVar9;
          if ((iVar3 != 0) && (1 < *param_5)) {
            pcVar8 = pcVar9 + 1;
            if (*pcVar8 == '\0') goto LAB_006446e0;
            **param_4 = *pcVar9;
            *param_4 = *param_4 + 1;
            *param_5 = *param_5 - 1;
          }
          **param_4 = *pcVar8;
          *param_4 = *param_4 + 1;
          *param_5 = *param_5 - 1;
          _Str1 = local_10;
          goto LAB_00644781;
        }
        while ((_Str1 = local_10, *pcVar9 != '\0' && (*param_5 != 0))) {
          iVar3 = __isleadbyte_l((int)*pcVar9,param_1);
          pcVar8 = pcVar9;
          if ((iVar3 != 0) && (1 < *param_5)) {
            pcVar8 = pcVar9 + 1;
            if (*pcVar8 == '\0') goto LAB_006446e0;
            **param_4 = *pcVar9;
            *param_4 = *param_4 + 1;
            *param_5 = *param_5 - 1;
          }
          **param_4 = *pcVar8;
          *param_4 = *param_4 + 1;
          pcVar9 = pcVar8 + 1;
          *param_5 = *param_5 - 1;
        }
        goto LAB_00644781;
      }
      if (iVar3 != 0x79) goto LAB_0064474a;
      if (uVar4 != 1) goto joined_r0x0064487f;
    }
LAB_006449e1:
    iVar3 = _expandtime(param_1,(char)param_5,(tm *)param_6,local_c,unaff_EDI,unaff_ESI,unaff_EBX);
    _Str1 = local_10;
    if (iVar3 == 0) goto LAB_006446e0;
  }
LAB_00644781:
  cVar1 = *_Str1;
  goto joined_r0x006446f6;
}



============================================================
DISASSEMBLY
============================================================
006445aa : MOV EDI,EDI
006445ac : PUSH EBP
006445ad : MOV EBP,ESP
006445af : SUB ESP,0x20
006445b2 : MOV EAX,[0x00d66fa0]
006445b7 : XOR EAX,EBP
006445b9 : MOV dword ptr [EBP + -0x4],EAX
006445bc : MOV EAX,dword ptr [EBP + 0xc]
006445bf : PUSH EBX
006445c0 : PUSH ESI
006445c1 : MOV ESI,dword ptr [EBP + 0x1c]
006445c4 : XOR EBX,EBX
006445c6 : SUB EAX,EBX
006445c8 : PUSH EDI
006445c9 : JZ 0x006445de
006445cb : DEC EAX
006445cc : JZ 0x006445d6
006445ce : MOV EDI,dword ptr [ESI + 0xa8]
006445d4 : JMP 0x006445e4
006445d6 : MOV EDI,dword ptr [ESI + 0xa4]
006445dc : JMP 0x006445e4
006445de : MOV EDI,dword ptr [ESI + 0xa0]
006445e4 : CMP dword ptr [ESI + 0xb0],0x1
006445eb : MOV EAX,dword ptr [EBP + 0x10]
006445ee : JZ 0x006446f2
006445f4 : CMP dword ptr [EBP + 0xc],0x2
006445f8 : MOV ECX,dword ptr [0x00b8528c]
006445fe : JNZ 0x00644606
00644600 : MOV ECX,dword ptr [0x00b85290]
00644606 : MOV EDX,0x76c
0064460b : ADD DX,word ptr [EAX + 0x14]
0064460f : PUSH EBX
00644610 : MOV word ptr [EBP + -0x20],DX
00644614 : MOV DX,word ptr [EAX + 0x10]
00644618 : INC DX
0064461a : MOV word ptr [EBP + -0x1e],DX
0064461e : MOV DX,word ptr [EAX + 0xc]
00644622 : MOV word ptr [EBP + -0x1a],DX
00644626 : MOV DX,word ptr [EAX + 0x8]
0064462a : MOV word ptr [EBP + -0x18],DX
0064462e : MOV DX,word ptr [EAX + 0x4]
00644632 : MOV AX,word ptr [EAX]
00644635 : MOV word ptr [EBP + -0x14],AX
00644639 : PUSH EBX
0064463a : XOR EAX,EAX
0064463c : PUSH EDI
0064463d : MOV word ptr [EBP + -0x12],AX
00644641 : LEA EAX,[EBP + -0x20]
00644644 : PUSH EAX
00644645 : PUSH EBX
00644646 : PUSH dword ptr [ESI + 0xac]
0064464c : MOV dword ptr [EBP + -0xc],ECX
0064464f : MOV word ptr [EBP + -0x16],DX
00644653 : CALL ECX
00644655 : MOV dword ptr [EBP + -0x10],EAX
00644658 : CMP EAX,EBX
0064465a : JZ 0x006446f2
00644660 : ADD EAX,0x8
00644663 : CMP EAX,0x400
00644668 : JG 0x0064467d
0064466a : CALL 0x0065bd80
0064466f : MOV EAX,ESP
00644671 : CMP EAX,EBX
00644673 : JZ 0x00644691
00644675 : MOV dword ptr [EAX],0xcccc
0064467b : JMP 0x0064468e
0064467d : PUSH EAX
0064467e : CALL 0x00636043
00644683 : POP ECX
00644684 : CMP EAX,EBX
00644686 : JZ 0x00644691
00644688 : MOV dword ptr [EAX],0xdddd
0064468e : ADD EAX,0x8
00644691 : MOV dword ptr [EBP + -0x8],EAX
00644694 : CMP EAX,EBX
00644696 : JZ 0x006446f2
00644698 : PUSH dword ptr [EBP + -0x10]
0064469b : MOV EBX,EAX
0064469d : PUSH EBX
0064469e : PUSH EDI
0064469f : LEA EAX,[EBP + -0x20]
006446a2 : PUSH EAX
006446a3 : PUSH 0x0
006446a5 : PUSH dword ptr [ESI + 0xac]
006446ab : CALL dword ptr [EBP + -0xc]
006446ae : DEC EAX
006446af : TEST EAX,EAX
006446b1 : JLE 0x006446d4
006446b3 : MOV ESI,dword ptr [EBP + 0x18]
006446b6 : MOV ECX,dword ptr [EBP + 0x14]
006446b9 : CMP dword ptr [ESI],0x0
006446bc : JBE 0x006446d4
006446be : MOV EDX,dword ptr [ECX]
006446c0 : MOV dword ptr [EBP + -0x10],EAX
006446c3 : MOV AL,byte ptr [EBX]
006446c5 : MOV byte ptr [EDX],AL
006446c7 : INC dword ptr [ECX]
006446c9 : MOV EAX,dword ptr [EBP + -0x10]
006446cc : INC EBX
006446cd : DEC dword ptr [ESI]
006446cf : DEC EAX
006446d0 : TEST EAX,EAX
006446d2 : JG 0x006446b9
006446d4 : PUSH dword ptr [EBP + -0x8]
006446d7 : CALL 0x0040dc20
006446dc : POP ECX
006446dd : XOR EAX,EAX
006446df : INC EAX
006446e0 : LEA ESP,[EBP + -0x2c]
006446e3 : POP EDI
006446e4 : POP ESI
006446e5 : POP EBX
006446e6 : MOV ECX,dword ptr [EBP + -0x4]
006446e9 : XOR ECX,EBP
006446eb : CALL 0x00633e6b
006446f0 : LEAVE
006446f1 : RET
006446f2 : MOV AL,byte ptr [EDI]
006446f4 : TEST AL,AL
006446f6 : JZ 0x006446dd
006446f8 : MOV EBX,dword ptr [EBP + 0x18]
006446fb : MOV ESI,dword ptr [EBP + 0x14]
006446fe : CMP dword ptr [EBX],0x0
00644701 : JZ 0x006446dd
00644703 : XOR EDX,EDX
00644705 : MOV dword ptr [EBP + -0x8],EDX
00644708 : MOV ECX,EDI
0064470a : INC ECX
0064470b : INC EDX
0064470c : CMP byte ptr [ECX],AL
0064470e : JZ 0x0064470a
00644710 : MOV dword ptr [EBP + -0xc],ECX
00644713 : MOVSX ECX,AL
00644716 : CMP ECX,0x64
00644719 : JG 0x006448a1
0064471f : JZ 0x00644873
00644725 : CMP ECX,0x27
00644728 : JZ 0x00644806
0064472e : CMP ECX,0x41
00644731 : JZ 0x006447d2
00644737 : CMP ECX,0x48
0064473a : JZ 0x006447ba
0064473c : CMP ECX,0x4d
0064473f : JZ 0x00644790
00644741 : CMP ECX,0x61
00644744 : JZ 0x006447d2
0064474a : PUSH dword ptr [EBP + 0x8]
0064474d : PUSH ECX
0064474e : CALL 0x006390f8
00644753 : POP ECX
00644754 : POP ECX
00644755 : TEST EAX,EAX
00644757 : JZ 0x00644776
00644759 : CMP dword ptr [EBX],0x1
0064475c : JBE 0x00644776
0064475e : LEA EAX,[EDI + 0x1]
00644761 : CMP byte ptr [EAX],0x0
00644764 : JZ 0x00644a04
0064476a : MOV DL,byte ptr [EDI]
0064476c : MOV ECX,dword ptr [ESI]
0064476e : MOV byte ptr [ECX],DL
00644770 : INC dword ptr [ESI]
00644772 : DEC dword ptr [EBX]
00644774 : MOV EDI,EAX
00644776 : MOV CL,byte ptr [EDI]
00644778 : MOV EAX,dword ptr [ESI]
0064477a : MOV byte ptr [EAX],CL
0064477c : INC dword ptr [ESI]
0064477e : INC EDI
0064477f : DEC dword ptr [EBX]
00644781 : MOV AL,byte ptr [EDI]
00644783 : TEST AL,AL
00644785 : JNZ 0x006446fe
0064478b : JMP 0x006446dd
00644790 : MOV EAX,EDX
00644792 : DEC EAX
00644793 : JZ 0x006447ac
00644795 : DEC EAX
00644796 : JZ 0x006447b3
00644798 : DEC EAX
00644799 : JZ 0x006447a5
0064479b : DEC EAX
0064479c : JNZ 0x0064474a
0064479e : MOV AL,0x42
006447a0 : JMP 0x006449e1
006447a5 : MOV AL,0x62
006447a7 : JMP 0x006449e1
006447ac : MOV dword ptr [EBP + -0x8],0x1
006447b3 : MOV AL,0x6d
006447b5 : JMP 0x006449e1
006447ba : MOV EAX,EDX
006447bc : DEC EAX
006447bd : JZ 0x006447c4
006447bf : DEC EAX
006447c0 : JZ 0x006447cb
006447c2 : JMP 0x0064474a
006447c4 : MOV dword ptr [EBP + -0x8],0x1
006447cb : MOV AL,0x48
006447cd : JMP 0x006449e1
006447d2 : PUSH 0xb9b9a4
006447d7 : PUSH EDI
006447d8 : CALL 0x0063b7ab
006447dd : POP ECX
006447de : POP ECX
006447df : TEST EAX,EAX
006447e1 : JNZ 0x006447e8
006447e3 : ADD EDI,0x5
006447e6 : JMP 0x006447fc
006447e8 : PUSH 0xb9b9a0
006447ed : PUSH EDI
006447ee : CALL 0x0063b7ab
006447f3 : POP ECX
006447f4 : POP ECX
006447f5 : TEST EAX,EAX
006447f7 : JNZ 0x006447ff
006447f9 : ADD EDI,0x3
006447fc : MOV dword ptr [EBP + -0xc],EDI
006447ff : MOV AL,0x70
00644801 : JMP 0x006449e1
00644806 : ADD EDI,EDX
00644808 : TEST DL,0x1
0064480b : JZ 0x00644781
00644811 : MOV AL,byte ptr [EDI]
00644813 : TEST AL,AL
00644815 : JZ 0x006446dd
0064481b : CMP dword ptr [EBX],0x0
0064481e : JZ 0x00644781
00644824 : CMP AL,0x27
00644826 : JZ 0x0064486d
00644828 : PUSH dword ptr [EBP + 0x8]
0064482b : MOVSX EAX,AL
0064482e : PUSH EAX
0064482f : CALL 0x006390f8
00644834 : POP ECX
00644835 : POP ECX
00644836 : TEST EAX,EAX
00644838 : JZ 0x00644857
0064483a : CMP dword ptr [EBX],0x1
0064483d : JBE 0x00644857
0064483f : LEA EAX,[EDI + 0x1]
00644842 : CMP byte ptr [EAX],0x0
00644845 : JZ 0x00644a04
0064484b : MOV DL,byte ptr [EDI]
0064484d : MOV ECX,dword ptr [ESI]
0064484f : MOV byte ptr [ECX],DL
00644851 : INC dword ptr [ESI]
00644853 : DEC dword ptr [EBX]
00644855 : MOV EDI,EAX
00644857 : MOV EAX,dword ptr [ESI]
00644859 : MOV CL,byte ptr [EDI]
0064485b : MOV byte ptr [EAX],CL
0064485d : INC dword ptr [ESI]
0064485f : INC EDI
00644860 : DEC dword ptr [EBX]
00644862 : MOV AL,byte ptr [EDI]
00644864 : TEST AL,AL
00644866 : JNZ 0x0064481b
00644868 : JMP 0x00644781
0064486d : INC EDI
0064486e : JMP 0x00644781
00644873 : MOV EAX,EDX
00644875 : DEC EAX
00644876 : JZ 0x00644893
00644878 : DEC EAX
00644879 : JZ 0x0064489a
0064487b : DEC EAX
0064487c : JZ 0x0064488c
0064487e : DEC EAX
0064487f : JNZ 0x0064474a
00644885 : MOV AL,0x41
00644887 : JMP 0x006449e1
0064488c : MOV AL,0x61
0064488e : JMP 0x006449e1
00644893 : MOV dword ptr [EBP + -0x8],0x1
0064489a : MOV AL,0x64
0064489c : JMP 0x006449e1
006448a1 : MOV EAX,ECX
006448a3 : SUB EAX,0x68
006448a6 : JZ 0x006449cb
006448ac : SUB EAX,0x5
006448af : JZ 0x006449b3
006448b5 : SUB EAX,0x6
006448b8 : JZ 0x0064499b
006448be : DEC EAX
006448bf : JZ 0x006448e6
006448c1 : SUB EAX,0x5
006448c4 : JNZ 0x0064474a
006448ca : MOV EAX,EDX
006448cc : DEC EAX
006448cd : DEC EAX
006448ce : JZ 0x006448df
006448d0 : DEC EAX
006448d1 : DEC EAX
006448d2 : JNZ 0x0064474a
006448d8 : MOV AL,0x59
006448da : JMP 0x006449e1
006448df : MOV AL,0x79
006448e1 : JMP 0x006449e1
006448e6 : MOV EAX,dword ptr [EBP + 0x10]
006448e9 : CMP dword ptr [EAX + 0x8],0xb
006448ed : MOV EAX,dword ptr [EBP + 0x1c]
006448f0 : JG 0x006448fa
006448f2 : MOV EDI,dword ptr [EAX + 0x98]
006448f8 : JMP 0x00644900
006448fa : MOV EDI,dword ptr [EAX + 0x9c]
00644900 : CMP EDX,0x1
00644903 : JNZ 0x00644993
00644909 : CMP dword ptr [EBX],0x0
0064490c : JBE 0x00644993
00644912 : MOVSX EAX,byte ptr [EDI]
00644915 : PUSH dword ptr [EBP + 0x8]
00644918 : PUSH EAX
00644919 : CALL 0x006390f8
0064491e : POP ECX
0064491f : POP ECX
00644920 : TEST EAX,EAX
00644922 : JZ 0x00644941
00644924 : CMP dword ptr [EBX],0x1
00644927 : JBE 0x00644941
00644929 : LEA EAX,[EDI + 0x1]
0064492c : CMP byte ptr [EAX],0x0
0064492f : JZ 0x00644a04
00644935 : MOV DL,byte ptr [EDI]
00644937 : MOV ECX,dword ptr [ESI]
00644939 : MOV byte ptr [ECX],DL
0064493b : INC dword ptr [ESI]
0064493d : DEC dword ptr [EBX]
0064493f : MOV EDI,EAX
00644941 : MOV EAX,dword ptr [ESI]
00644943 : MOV CL,byte ptr [EDI]
00644945 : MOV byte ptr [EAX],CL
00644947 : INC dword ptr [ESI]
00644949 : DEC dword ptr [EBX]
0064494b : JMP 0x006449fc
00644950 : CMP dword ptr [EBX],0x0
00644953 : JBE 0x006449fc
00644959 : PUSH dword ptr [EBP + 0x8]
0064495c : MOVSX EAX,AL
0064495f : PUSH EAX
00644960 : CALL 0x006390f8
00644965 : POP ECX
00644966 : POP ECX
00644967 : TEST EAX,EAX
00644969 : JZ 0x00644988
0064496b : CMP dword ptr [EBX],0x1
0064496e : JBE 0x00644988
00644970 : LEA EAX,[EDI + 0x1]
00644973 : CMP byte ptr [EAX],0x0
00644976 : JZ 0x00644a04
0064497c : MOV DL,byte ptr [EDI]
0064497e : MOV ECX,dword ptr [ESI]
00644980 : MOV byte ptr [ECX],DL
00644982 : INC dword ptr [ESI]
00644984 : DEC dword ptr [EBX]
00644986 : MOV EDI,EAX
00644988 : MOV CL,byte ptr [EDI]
0064498a : MOV EAX,dword ptr [ESI]
0064498c : MOV byte ptr [EAX],CL
0064498e : INC dword ptr [ESI]
00644990 : INC EDI
00644991 : DEC dword ptr [EBX]
00644993 : MOV AL,byte ptr [EDI]
00644995 : TEST AL,AL
00644997 : JNZ 0x00644950
00644999 : JMP 0x006449fc
0064499b : MOV EAX,EDX
0064499d : DEC EAX
0064499e : JZ 0x006449a8
006449a0 : DEC EAX
006449a1 : JZ 0x006449af
006449a3 : JMP 0x0064474a
006449a8 : MOV dword ptr [EBP + -0x8],0x1
006449af : MOV AL,0x53
006449b1 : JMP 0x006449e1
006449b3 : MOV EAX,EDX
006449b5 : DEC EAX
006449b6 : JZ 0x006449c0
006449b8 : DEC EAX
006449b9 : JZ 0x006449c7
006449bb : JMP 0x0064474a
006449c0 : MOV dword ptr [EBP + -0x8],0x1
006449c7 : MOV AL,0x4d
006449c9 : JMP 0x006449e1
006449cb : MOV EAX,EDX
006449cd : DEC EAX
006449ce : JZ 0x006449d8
006449d0 : DEC EAX
006449d1 : JZ 0x006449df
006449d3 : JMP 0x0064474a
006449d8 : MOV dword ptr [EBP + -0x8],0x1
006449df : MOV AL,0x49
006449e1 : PUSH dword ptr [EBP + -0x8]
006449e4 : MOV EDX,dword ptr [EBP + 0x10]
006449e7 : PUSH dword ptr [EBP + 0x1c]
006449ea : MOV ECX,ESI
006449ec : PUSH EBX
006449ed : PUSH dword ptr [EBP + 0x8]
006449f0 : CALL 0x006441c2
006449f5 : ADD ESP,0x10
006449f8 : TEST EAX,EAX
006449fa : JZ 0x00644a04
006449fc : MOV EDI,dword ptr [EBP + -0xc]
006449ff : JMP 0x00644781
00644a04 : XOR EAX,EAX
00644a06 : JMP 0x006446e0

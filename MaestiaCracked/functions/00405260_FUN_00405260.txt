PROGRAM  : Maestia.exe
FUNCTION : FUN_00405260
ENTRY    : 00405260
BODY     : [[00405260, 00405293] [00405295, 004052a9]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00405260(char param_1,rsize_t param_2)

{
  int in_ECX;
  
  if ((param_1 != '\0') && (0xf < *(uint *)(in_ECX + 0x18))) {
    if (param_2 != 0) {
      _memcpy_s((undefined4 *)(in_ECX + 4),0x10,*(void **)(in_ECX + 4),param_2);
    }
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  *(rsize_t *)(in_ECX + 0x14) = param_2;
  *(undefined4 *)(in_ECX + 0x18) = 0xf;
  *(undefined1 *)(in_ECX + 4 + param_2) = 0;
  return;
}



============================================================
DISASSEMBLY
============================================================
00405260 : PUSH EBP
00405261 : MOV EBP,ESP
00405263 : CMP byte ptr [EBP + 0x8],0x0
00405267 : PUSH ESI
00405268 : PUSH EDI
00405269 : MOV EDI,dword ptr [EBP + 0xc]
0040526c : MOV ESI,ECX
0040526e : JZ 0x00405295
00405270 : CMP dword ptr [ESI + 0x18],0x10
00405274 : JC 0x00405295
00405276 : LEA EAX,[ESI + 0x4]
00405279 : PUSH EBX
0040527a : MOV EBX,dword ptr [EAX]
0040527c : TEST EDI,EDI
0040527e : JBE 0x0040528d
00405280 : PUSH EDI
00405281 : PUSH EBX
00405282 : PUSH 0x10
00405284 : PUSH EAX
00405285 : CALL 0x00633ea4
0040528a : ADD ESP,0x10
0040528d : MOV ECX,EBX
0040528f : CALL 0x006f04e0
00405295 : MOV dword ptr [ESI + 0x14],EDI
00405298 : MOV dword ptr [ESI + 0x18],0xf
0040529f : MOV byte ptr [ESI + EDI*0x1 + 0x4],0x0
004052a4 : POP EDI
004052a5 : POP ESI
004052a6 : POP EBP
004052a7 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_009d427f
ENTRY    : 009d427f
BODY     : [[009d427f, 009d42ae] [009d4377, 009d439f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009d427f(void)

{
  undefined2 uVar1;
  ushort *puVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  undefined4 uVar6;
  ushort *puVar7;
  int iVar8;
  uint uVar9;
  undefined4 unaff_EBX;
  uint unaff_EBP;
  
  *(undefined4 *)(unaff_EBP - 4) = 0xffffffff;
  if (7 < *(uint *)(unaff_EBP - 0x18)) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  *(undefined4 *)(unaff_EBP - 0x18) = 7;
  *(undefined4 *)(unaff_EBP - 0x1c) = unaff_EBX;
  *(undefined2 *)(unaff_EBP - 0x2c) = 0;
  *(int *)(unaff_EBP - 0x60) = *(int *)(unaff_EBP - 0x60) + 1;
  iVar5 = *(int *)(unaff_EBP - 0x60);
  do {
    if (0xfffe < iVar5) {
      ExceptionList = *(void **)(unaff_EBP - 0xc);
      __security_check_cookie(*(uint *)(unaff_EBP - 0x14) ^ unaff_EBP);
      return;
    }
    piVar4 = (int *)FUN_00703c00(0x600);
    if ((piVar4 != (int *)0x0) && (iVar5 = piVar4[1], (char)((ushort)(short)iVar5 >> 8) == '\x06'))
    {
      uVar9 = piVar4[0x12];
      *(int *)(unaff_EBP - 100) = piVar4[0x13];
      if ((uVar9 & 0x40) == 0) {
        if ((uVar9 & 0x10) == 0) {
LAB_009d3d3a:
          FUN_0040eef0(piVar4 + 6);
          *(undefined4 *)(unaff_EBP - 4) = 0;
          FUN_00824120(DAT_0172491c);
          *(undefined1 *)(unaff_EBP - 4) = 2;
          if (7 < *(uint *)(unaff_EBP - 0x9c)) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          *(undefined4 *)(unaff_EBP - 0x9c) = 7;
          *(undefined4 *)(unaff_EBP - 0xa0) = 0;
          *(undefined2 *)(unaff_EBP - 0xb0) = 0;
          *(undefined4 *)(unaff_EBP - 0x48) = 0;
          *(undefined4 *)(unaff_EBP - 0x50) = 0;
          *(undefined4 *)(unaff_EBP - 0x4c) = 0;
          *(undefined1 *)(unaff_EBP - 4) = 3;
          iVar5 = FUN_006f0300(0x30);
          *(int *)(unaff_EBP - 0x3c) = iVar5;
          *(undefined1 *)(unaff_EBP - 4) = 4;
          if (iVar5 == 0) {
            uVar6 = 0;
          }
          else {
            iVar3 = piVar4[1];
            uVar1 = *(undefined2 *)((int)piVar4 + 6);
            iVar8 = unaff_EBP - 0x30;
            uVar6 = FUN_009d2a90(iVar8);
            uVar6 = FUN_0041bdf0(iVar5,CONCAT22((short)iVar3,uVar1),uVar6,iVar8);
          }
          *(undefined4 *)(unaff_EBP - 0x38) = uVar6;
          *(undefined1 *)(unaff_EBP - 4) = 3;
          *(undefined4 *)(unaff_EBP - 0x48) = uVar6;
          iVar5 = FUN_006f0300(0x30);
          *(int *)(unaff_EBP - 0x3c) = iVar5;
          *(undefined1 *)(unaff_EBP - 4) = 5;
          if (iVar5 == 0) {
            *(undefined4 *)(unaff_EBP - 0x40) = 0;
          }
          else {
            iVar3 = piVar4[1];
            uVar1 = *(undefined2 *)((int)piVar4 + 6);
            iVar8 = unaff_EBP - 0x30;
            uVar6 = FUN_009d2a90(iVar8);
            uVar6 = FUN_0041bdf0(iVar5,CONCAT22((short)iVar3,uVar1),uVar6,iVar8);
            *(undefined4 *)(unaff_EBP - 0x40) = uVar6;
          }
          *(undefined1 *)(unaff_EBP - 4) = 3;
          *(undefined4 *)(unaff_EBP - 0x50) = *(undefined4 *)(unaff_EBP - 0x40);
          iVar5 = FUN_006f0300(0x30);
          *(int *)(unaff_EBP - 100) = iVar5;
          *(undefined1 *)(unaff_EBP - 4) = 6;
          if (iVar5 == 0) {
            puVar7 = (ushort *)0x0;
            *(undefined4 *)(unaff_EBP - 0x3c) = 0;
          }
          else {
            iVar3 = piVar4[1];
            uVar1 = *(undefined2 *)((int)piVar4 + 6);
            iVar8 = unaff_EBP - 0x30;
            uVar6 = FUN_009d2a90(iVar8);
            puVar7 = (ushort *)FUN_0041bdf0(iVar5,CONCAT22((short)iVar3,uVar1),uVar6,iVar8);
            *(ushort **)(unaff_EBP - 0x3c) = puVar7;
          }
          *(undefined1 *)(unaff_EBP - 4) = 3;
          *(ushort **)(unaff_EBP - 0x4c) = puVar7;
          *(undefined4 *)(unaff_EBP - 4) = 2;
          iVar5 = (**(code **)(*piVar4 + 0x3c))();
          puVar2 = *(ushort **)(unaff_EBP - 0x38);
          if (iVar5 != 0) {
            *puVar7 = (ushort)*(byte *)(piVar4 + 0x10);
            *puVar2 = (ushort)*(byte *)(piVar4 + 0x10);
            **(ushort **)(unaff_EBP - 0x40) = (ushort)*(byte *)(piVar4 + 0x10);
          }
          *(ushort **)(unaff_EBP - 0x38) = puVar2 + 0x16;
          iVar5 = *(int *)(unaff_EBP - 0x44);
          FUN_004437f0(puVar2 + 0x16);
          if (*(int *)(unaff_EBP - 0x34) == *(int *)(iVar5 + 0x140)) {
            *(undefined4 *)(unaff_EBP - 0x5c) = 0;
            *(undefined1 *)(unaff_EBP - 4) = 9;
            iVar8 = FUN_006f0300(0x10);
            *(int *)(unaff_EBP - 100) = iVar8;
            *(undefined1 *)(unaff_EBP - 4) = 10;
            iVar5 = 0;
            if (iVar8 != 0) {
              *(undefined4 *)(iVar8 + 4) = 0;
              *(undefined4 *)(iVar8 + 8) = 0;
              *(undefined4 *)(iVar8 + 0xc) = 0;
              iVar5 = iVar8;
            }
            *(undefined1 *)(unaff_EBP - 4) = 9;
            *(int *)(unaff_EBP - 0x5c) = iVar5;
            *(undefined4 *)(unaff_EBP - 4) = 2;
            FUN_00449730();
            *(undefined4 *)(unaff_EBP - 0x70) = **(undefined4 **)(unaff_EBP - 0x38);
            *(int *)(unaff_EBP - 0x6c) = iVar5;
            FUN_00419ac0(unaff_EBP - 0xcc,unaff_EBP - 0x70);
            FUN_009d3fee();
            return;
          }
          if (*(int *)(*(int *)(unaff_EBP - 0x34) + 0x10) != 0) {
            FUN_00449730();
            FUN_009d3fee();
            return;
          }
          if (puVar2 != (ushort *)0x0) {
            FUN_00414770(puVar2);
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          iVar5 = *(int *)(unaff_EBP - 0x40);
          uVar9 = *(uint *)(iVar5 + 0x2c) >> 0x10 & 0xff;
          *(uint *)(unaff_EBP - 0x34) = uVar9;
          piVar4 = (int *)FUN_004437f0(unaff_EBP - 0x34);
          iVar8 = *piVar4;
          *(int *)(unaff_EBP - 0x34) = iVar8;
          if (iVar8 == *(int *)(*(int *)(unaff_EBP - 0x44) + 0x140)) {
            *(undefined4 *)(unaff_EBP - 0x58) = 0;
            *(undefined1 *)(unaff_EBP - 4) = 0xd;
            iVar8 = FUN_006f0300(0x10);
            *(int *)(unaff_EBP - 100) = iVar8;
            *(undefined1 *)(unaff_EBP - 4) = 0xe;
            iVar5 = 0;
            if (iVar8 != 0) {
              *(undefined4 *)(iVar8 + 4) = 0;
              *(undefined4 *)(iVar8 + 8) = 0;
              *(undefined4 *)(iVar8 + 0xc) = 0;
              iVar5 = iVar8;
            }
            *(undefined1 *)(unaff_EBP - 4) = 0xd;
            *(int *)(unaff_EBP - 0x58) = iVar5;
            *(undefined4 *)(unaff_EBP - 4) = 2;
            FUN_00449730();
            *(uint *)(unaff_EBP - 0x78) = uVar9;
            *(int *)(unaff_EBP - 0x74) = iVar5;
            FUN_00419ac0(unaff_EBP - 0xc4,unaff_EBP - 0x78);
            FUN_009d4136();
            return;
          }
          if (*(int *)(iVar8 + 0x10) != 0) {
            FUN_00449730();
            FUN_009d4136();
            return;
          }
          FUN_00414770(iVar5);
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        if ((short)iVar5 == 0x674) {
          iVar5 = FUN_004049b0(*(ushort *)((int)piVar4 + 6) | 0x6740000);
          if ((iVar5 != 0) && (*(short *)(iVar5 + 0x180) == 0x23)) goto LAB_009d3d3a;
        }
      }
    }
    *(int *)(unaff_EBP - 0x60) = *(int *)(unaff_EBP - 0x60) + 1;
    iVar5 = *(int *)(unaff_EBP - 0x60);
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
009d427f : MOV dword ptr [EBP + -0x4],0xffffffff
009d4286 : CMP dword ptr [EBP + -0x18],0x8
009d428a : JC 0x009d4294
009d428c : MOV ECX,dword ptr [EBP + -0x2c]
009d428f : CALL 0x006f04e0
009d4294 : MOV dword ptr [EBP + -0x18],0x7
009d429b : MOV dword ptr [EBP + -0x1c],EBX
009d429e : XOR ECX,ECX
009d42a0 : MOV word ptr [EBP + -0x2c],CX
009d42a4 : INC dword ptr [EBP + -0x60]
009d42a7 : MOV EDI,dword ptr [EBP + -0x60]
009d42aa : JMP 0x009d3cb0
009d4377 : INC dword ptr [EBP + -0x60]
009d437a : MOV EDI,dword ptr [EBP + -0x60]
009d437d : JMP 0x009d3cb0
009d4382 : MOV ECX,dword ptr [EBP + -0xc]
009d4385 : MOV dword ptr FS:[0x0],ECX
009d438c : POP ECX
009d438d : POP EDI
009d438e : POP ESI
009d438f : POP EBX
009d4390 : MOV ECX,dword ptr [EBP + -0x14]
009d4393 : XOR ECX,EBP
009d4395 : CALL 0x00633e6b
009d439a : MOV ESP,EBP
009d439c : POP EBP
009d439d : RET 0x4

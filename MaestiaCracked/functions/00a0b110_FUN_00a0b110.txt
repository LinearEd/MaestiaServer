PROGRAM  : Maestia.exe
FUNCTION : FUN_00a0b110
ENTRY    : 00a0b110
BODY     : [[00a0b110, 00a0b1b7]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00a0b110(void)

{
  int in_EAX;
  undefined4 *puVar1;
  wchar_t *_Filename;
  FILE *_File;
  
  if (DAT_00d71ae8 != 0) {
    puVar1 = DAT_00d71ad8;
    if (DAT_00d71aec < 8) {
      puVar1 = &DAT_00d71ad8;
    }
    FUN_00405b70(puVar1);
    if (*(uint *)(in_EAX + 0x18) < 8) {
      _Filename = (wchar_t *)(in_EAX + 4);
    }
    else {
      _Filename = *(wchar_t **)(in_EAX + 4);
    }
    _File = __wfopen(_Filename,L"wt");
    if (_File != (FILE *)0x0) {
      _fwprintf(_File,L"\n=============== [User Report] ===============\n");
      puVar1 = DAT_00d71ad8;
      if (DAT_00d71aec < 8) {
        puVar1 = &DAT_00d71ad8;
      }
      _fwprintf(_File,L"%s",puVar1);
      _fwprintf(_File,L"\n=============== [User Report] ===============\n");
      _fclose(_File);
    }
    return 1;
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00a0b110 : PUSH EBP
00a0b111 : MOV EBP,ESP
00a0b113 : PUSH ECX
00a0b114 : CMP dword ptr [0x00d71ae8],0x0
00a0b11b : PUSH ESI
00a0b11c : MOV ESI,EAX
00a0b11e : JZ 0x00a0b1b1
00a0b124 : CMP dword ptr [0x00d71aec],0x8
00a0b12b : MOV EAX,[0x00d71ad8]
00a0b130 : JNC 0x00a0b137
00a0b132 : MOV EAX,0xd71ad8
00a0b137 : PUSH EAX
00a0b138 : XOR EDX,EDX
00a0b13a : MOV ECX,0xcab524
00a0b13f : CALL 0x00405b70
00a0b144 : ADD ESP,0x4
00a0b147 : CMP dword ptr [ESI + 0x18],0x8
00a0b14b : JC 0x00a0b152
00a0b14d : MOV EAX,dword ptr [ESI + 0x4]
00a0b150 : JMP 0x00a0b155
00a0b152 : LEA EAX,[ESI + 0x4]
00a0b155 : PUSH 0xcab528
00a0b15a : PUSH EAX
00a0b15b : CALL 0x00636404
00a0b160 : MOV ESI,EAX
00a0b162 : ADD ESP,0x8
00a0b165 : TEST ESI,ESI
00a0b167 : JZ 0x00a0b1aa
00a0b169 : PUSH 0xcab530
00a0b16e : PUSH ESI
00a0b16f : CALL 0x006372ee
00a0b174 : MOV EAX,[0x00d71ad8]
00a0b179 : ADD ESP,0x8
00a0b17c : CMP dword ptr [0x00d71aec],0x8
00a0b183 : JNC 0x00a0b18a
00a0b185 : MOV EAX,0xd71ad8
00a0b18a : PUSH EAX
00a0b18b : PUSH 0xcab590
00a0b190 : PUSH ESI
00a0b191 : CALL 0x006372ee
00a0b196 : PUSH 0xcab598
00a0b19b : PUSH ESI
00a0b19c : CALL 0x006372ee
00a0b1a1 : PUSH ESI
00a0b1a2 : CALL 0x006366db
00a0b1a7 : ADD ESP,0x18
00a0b1aa : MOV AL,0x1
00a0b1ac : POP ESI
00a0b1ad : MOV ESP,EBP
00a0b1af : POP EBP
00a0b1b0 : RET
00a0b1b1 : XOR AL,AL
00a0b1b3 : POP ESI
00a0b1b4 : MOV ESP,EBP
00a0b1b6 : POP EBP
00a0b1b7 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_007d4530
ENTRY    : 007d4530
BODY     : [[007d4530, 007d46f4]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_007d4530(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  char cVar3;
  uint uVar4;
  int in_ECX;
  int iVar5;
  int iVar6;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b0f12a;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar5 = *(int *)(in_ECX + 0x238) - *(int *)(in_ECX + 0x234);
  iVar6 = iVar5 >> 0x1f;
  if (iVar5 / 0x178 + iVar6 == iVar6) {
    if (*(int *)(in_ECX + 8) != 0) {
      EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
    }
    local_8 = 0;
    puVar1 = *(undefined4 **)(in_ECX + 0x188);
    for (puVar2 = (undefined4 *)*puVar1; puVar2 != puVar1; puVar2 = (undefined4 *)*puVar2) {
      cVar3 = (**(code **)(*(int *)puVar2[9] + 0x50))(param_1,param_2,param_3,uVar4);
      if (cVar3 != '\0') {
        local_8 = 0xffffffff;
        if (*(int *)(in_ECX + 8) == 0) {
          ExceptionList = local_10;
          return in_ECX;
        }
        LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
        ExceptionList = local_10;
        return in_ECX;
      }
    }
    local_8 = 0xffffffff;
    if (*(int *)(in_ECX + 8) != 0) {
      LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
    }
    if (*(int *)(in_ECX + 8) != 0) {
      EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
    }
    local_8 = 1;
    puVar1 = *(undefined4 **)(in_ECX + 0x38);
    for (puVar2 = (undefined4 *)*puVar1; puVar2 != puVar1; puVar2 = (undefined4 *)*puVar2) {
      iVar6 = (**(code **)(*(int *)puVar2[9] + 0xc4))(param_1,param_2,param_3);
      if (iVar6 != 0) {
        local_8 = 0xffffffff;
        if (*(int *)(in_ECX + 8) != 0) {
          LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
        }
        ExceptionList = local_10;
        return iVar6;
      }
    }
    local_8 = 0xffffffff;
    if (*(int *)(in_ECX + 8) != 0) {
      LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
    }
  }
  else {
    iVar6 = *(int *)(in_ECX + 0x234);
    if (iVar6 != *(int *)(in_ECX + 0x238)) {
      do {
        cVar3 = FUN_0079ed20(iVar6 + 0xbc,param_3);
        if (cVar3 != '\0') {
          ExceptionList = local_10;
          return in_ECX;
        }
        iVar6 = iVar6 + 0x178;
      } while (iVar6 != *(int *)(in_ECX + 0x238));
    }
  }
  ExceptionList = local_10;
  return 0;
}



============================================================
DISASSEMBLY
============================================================
007d4530 : PUSH EBP
007d4531 : MOV EBP,ESP
007d4533 : PUSH -0x1
007d4535 : PUSH 0xb0f12a
007d453a : MOV EAX,FS:[0x0]
007d4540 : PUSH EAX
007d4541 : SUB ESP,0x8
007d4544 : PUSH EBX
007d4545 : PUSH ESI
007d4546 : PUSH EDI
007d4547 : MOV EAX,[0x00d66fa0]
007d454c : XOR EAX,EBP
007d454e : PUSH EAX
007d454f : LEA EAX,[EBP + -0xc]
007d4552 : MOV FS:[0x0],EAX
007d4558 : MOV EDI,ECX
007d455a : MOV ECX,dword ptr [EDI + 0x238]
007d4560 : SUB ECX,dword ptr [EDI + 0x234]
007d4566 : MOV EAX,0xae4c415d
007d456b : IMUL ECX
007d456d : ADD EDX,ECX
007d456f : SAR EDX,0x8
007d4572 : MOV EAX,EDX
007d4574 : SHR EAX,0x1f
007d4577 : ADD EAX,EDX
007d4579 : JZ 0x007d45be
007d457b : MOV ESI,dword ptr [EDI + 0x234]
007d4581 : CMP ESI,dword ptr [EDI + 0x238]
007d4587 : JZ 0x007d4683
007d458d : MOV EBX,dword ptr [EBP + 0x10]
007d4590 : MOV EDX,dword ptr [EBP + 0x8]
007d4593 : PUSH EBX
007d4594 : LEA ECX,[ESI + 0xbc]
007d459a : PUSH ECX
007d459b : MOV ECX,dword ptr [EBP + 0xc]
007d459e : CALL 0x0079ed20
007d45a3 : TEST AL,AL
007d45a5 : JNZ 0x007d46b1
007d45ab : ADD ESI,0x178
007d45b1 : CMP ESI,dword ptr [EDI + 0x238]
007d45b7 : JNZ 0x007d4590
007d45b9 : JMP 0x007d4683
007d45be : MOV EAX,dword ptr [EDI + 0x8]
007d45c1 : MOV dword ptr [EBP + -0x10],EDI
007d45c4 : TEST EAX,EAX
007d45c6 : JZ 0x007d45d2
007d45c8 : ADD EAX,0x4
007d45cb : PUSH EAX
007d45cc : CALL dword ptr [0x00b85118]
007d45d2 : MOV dword ptr [EBP + -0x4],0x0
007d45d9 : MOV EBX,dword ptr [EDI + 0x188]
007d45df : MOV ESI,dword ptr [EBX]
007d45e1 : CMP ESI,EBX
007d45e3 : JZ 0x007d4606
007d45e5 : PUSH dword ptr [EBP + 0x10]
007d45e8 : MOV ECX,dword ptr [ESI + 0x24]
007d45eb : PUSH dword ptr [EBP + 0xc]
007d45ee : MOV EDX,dword ptr [ECX]
007d45f0 : PUSH dword ptr [EBP + 0x8]
007d45f3 : MOV EAX,dword ptr [EDX + 0x50]
007d45f6 : CALL EAX
007d45f8 : TEST AL,AL
007d45fa : JNZ 0x007d4699
007d4600 : MOV ESI,dword ptr [ESI]
007d4602 : CMP ESI,EBX
007d4604 : JNZ 0x007d45e5
007d4606 : MOV dword ptr [EBP + -0x4],0xffffffff
007d460d : MOV EAX,dword ptr [EDI + 0x8]
007d4610 : TEST EAX,EAX
007d4612 : JZ 0x007d461e
007d4614 : ADD EAX,0x4
007d4617 : PUSH EAX
007d4618 : CALL dword ptr [0x00b8511c]
007d461e : MOV EAX,dword ptr [EDI + 0x8]
007d4621 : MOV dword ptr [EBP + -0x14],EDI
007d4624 : TEST EAX,EAX
007d4626 : JZ 0x007d4632
007d4628 : ADD EAX,0x4
007d462b : PUSH EAX
007d462c : CALL dword ptr [0x00b85118]
007d4632 : MOV dword ptr [EBP + -0x4],0x1
007d4639 : MOV EAX,dword ptr [EDI + 0x38]
007d463c : MOV ESI,dword ptr [EAX]
007d463e : MOV dword ptr [EBP + -0x10],EAX
007d4641 : CMP ESI,EAX
007d4643 : JZ 0x007d466b
007d4645 : MOV EAX,dword ptr [EBP + 0x10]
007d4648 : MOV ECX,dword ptr [ESI + 0x24]
007d464b : MOV EDX,dword ptr [ECX]
007d464d : MOV EDX,dword ptr [EDX + 0xc4]
007d4653 : PUSH EAX
007d4654 : MOV EAX,dword ptr [EBP + 0xc]
007d4657 : PUSH EAX
007d4658 : MOV EAX,dword ptr [EBP + 0x8]
007d465b : PUSH EAX
007d465c : CALL EDX
007d465e : MOV EBX,EAX
007d4660 : TEST EBX,EBX
007d4662 : JNZ 0x007d46c7
007d4664 : MOV ESI,dword ptr [ESI]
007d4666 : CMP ESI,dword ptr [EBP + -0x10]
007d4669 : JNZ 0x007d4645
007d466b : MOV dword ptr [EBP + -0x4],0xffffffff
007d4672 : MOV EDI,dword ptr [EDI + 0x8]
007d4675 : TEST EDI,EDI
007d4677 : JZ 0x007d4683
007d4679 : ADD EDI,0x4
007d467c : PUSH EDI
007d467d : CALL dword ptr [0x00b8511c]
007d4683 : XOR EAX,EAX
007d4685 : MOV ECX,dword ptr [EBP + -0xc]
007d4688 : MOV dword ptr FS:[0x0],ECX
007d468f : POP ECX
007d4690 : POP EDI
007d4691 : POP ESI
007d4692 : POP EBX
007d4693 : MOV ESP,EBP
007d4695 : POP EBP
007d4696 : RET 0xc
007d4699 : MOV dword ptr [EBP + -0x4],0xffffffff
007d46a0 : MOV EAX,dword ptr [EDI + 0x8]
007d46a3 : TEST EAX,EAX
007d46a5 : JZ 0x007d46b1
007d46a7 : ADD EAX,0x4
007d46aa : PUSH EAX
007d46ab : CALL dword ptr [0x00b8511c]
007d46b1 : MOV EAX,EDI
007d46b3 : MOV ECX,dword ptr [EBP + -0xc]
007d46b6 : MOV dword ptr FS:[0x0],ECX
007d46bd : POP ECX
007d46be : POP EDI
007d46bf : POP ESI
007d46c0 : POP EBX
007d46c1 : MOV ESP,EBP
007d46c3 : POP EBP
007d46c4 : RET 0xc
007d46c7 : MOV dword ptr [EBP + -0x4],0xffffffff
007d46ce : MOV EDI,dword ptr [EDI + 0x8]
007d46d1 : TEST EDI,EDI
007d46d3 : JZ 0x007d46df
007d46d5 : ADD EDI,0x4
007d46d8 : PUSH EDI
007d46d9 : CALL dword ptr [0x00b8511c]
007d46df : MOV EAX,EBX
007d46e1 : MOV ECX,dword ptr [EBP + -0xc]
007d46e4 : MOV dword ptr FS:[0x0],ECX
007d46eb : POP ECX
007d46ec : POP EDI
007d46ed : POP ESI
007d46ee : POP EBX
007d46ef : MOV ESP,EBP
007d46f1 : POP EBP
007d46f2 : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_0052d950
ENTRY    : 0052d950
BODY     : [[0052d950, 0052d9cc] [0052d9d0, 0052db5f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0052d950(undefined4 param_1,int param_2,undefined4 param_3,char *param_4)

{
  char cVar1;
  int iVar2;
  undefined4 uVar3;
  char *pcVar4;
  int *piVar5;
  char *pcVar6;
  undefined1 *puVar7;
  undefined1 auStack_14c [3];
  undefined1 uStack_149;
  int local_148;
  int local_144;
  char *local_140;
  undefined1 *local_13c;
  undefined4 local_138;
  int iStack_134;
  char *local_130;
  char *local_12c;
  undefined4 local_128;
  undefined1 local_124 [31];
  undefined1 uStack_105;
  undefined1 local_104 [256];
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)auStack_14c;
  local_128 = param_3;
  local_138 = param_1;
  local_130 = param_4;
  local_12c = param_4;
  do {
    cVar1 = *local_12c;
    local_12c = local_12c + 1;
  } while (cVar1 != '\0');
  local_12c = local_12c + (1 - (int)(param_4 + 1));
  if (param_2 != 0) {
    *(uint *)(param_2 + 8) = *(int *)(param_2 + 8) + 1U & 0x8fffffff;
  }
  local_148 = param_2;
  if (param_4 != (char *)0x0) {
    local_13c = &uStack_105;
    do {
      pcVar4 = local_130;
      iVar2 = FUN_00638800(param_4,0x2e);
      if (iVar2 == 0) {
        pcVar4 = pcVar4 + ((int)local_12c - (int)param_4);
        pcVar6 = (char *)0x0;
      }
      else {
        pcVar4 = (char *)((iVar2 - (int)param_4) + 1);
        pcVar6 = (char *)(iVar2 + 1);
      }
      if ((char *)0x100 < pcVar4) {
        pcVar4 = (char *)0x100;
      }
      local_140 = pcVar6;
      _memcpy(local_104,param_4,(size_t)(pcVar4 + -1));
      local_13c[(int)pcVar4] = 0;
      local_124[0] = 0;
      local_144 = FUN_00525530(local_104);
      *(int *)(local_144 + 8) = *(int *)(local_144 + 8) + 1;
      piVar5 = (int *)(local_148 + 0x10);
      cVar1 = (**(code **)(*(int *)(local_148 + 0x10) + 0x2c))(param_1,&local_144,local_124);
      if (cVar1 == '\0') {
        iVar2 = FUN_00515840(0x30,0);
        if (iVar2 == 0) {
          iVar2 = 0;
        }
        else {
          iVar2 = FUN_005511a0(param_1,local_128);
        }
        iStack_134 = *piVar5;
        puVar7 = &uStack_149;
        uStack_149 = 0;
        uVar3 = FUN_00526a90(iVar2);
        param_1 = local_138;
        (**(code **)(iStack_134 + 0x28))(local_138,&local_144,uVar3,puVar7);
        FUN_00526bc0();
      }
      else {
        iVar2 = FUN_00526fa0(0);
        if (iVar2 != 0) {
          *(uint *)(iVar2 + 8) = *(int *)(iVar2 + 8) + 1U & 0x8fffffff;
        }
      }
      if (iVar2 != 0) {
        *(uint *)(iVar2 + 8) = *(int *)(iVar2 + 8) + 1U & 0x8fffffff;
      }
      FUN_00503db0();
      *(int *)(local_144 + 8) = *(int *)(local_144 + 8) + -1;
      local_148 = iVar2;
      if (*(int *)(local_144 + 8) == 0) {
        FUN_00525340();
      }
      if (iVar2 != 0) {
        FUN_00503db0();
      }
      FUN_00526bc0();
      param_4 = pcVar6;
    } while (local_140 != (char *)0x0);
  }
  if (local_148 != 0) {
    FUN_00503db0();
  }
  __security_check_cookie(local_4 ^ (uint)auStack_14c);
  return;
}



============================================================
DISASSEMBLY
============================================================
0052d950 : SUB ESP,0x14c
0052d956 : MOV EAX,[0x00d66fa0]
0052d95b : XOR EAX,ESP
0052d95d : MOV dword ptr [ESP + 0x148],EAX
0052d964 : MOV EAX,dword ptr [ESP + 0x158]
0052d96b : PUSH EBX
0052d96c : MOV EBX,dword ptr [ESP + 0x154]
0052d973 : PUSH EBP
0052d974 : PUSH ESI
0052d975 : MOV ESI,dword ptr [ESP + 0x168]
0052d97c : MOV dword ptr [ESP + 0x30],EAX
0052d980 : MOV EAX,ESI
0052d982 : PUSH EDI
0052d983 : MOV EDI,dword ptr [ESP + 0x164]
0052d98a : MOV dword ptr [ESP + 0x24],EBX
0052d98e : MOV dword ptr [ESP + 0x2c],ESI
0052d992 : LEA EBP,[EAX + 0x1]
0052d995 : MOV CL,byte ptr [EAX]
0052d997 : INC EAX
0052d998 : TEST CL,CL
0052d99a : JNZ 0x0052d995
0052d99c : SUB EAX,EBP
0052d99e : INC EAX
0052d99f : MOV dword ptr [ESP + 0x30],EAX
0052d9a3 : MOV EBP,ESI
0052d9a5 : TEST EDI,EDI
0052d9a7 : JZ 0x0052d9b6
0052d9a9 : MOV ECX,dword ptr [EDI + 0x8]
0052d9ac : INC ECX
0052d9ad : AND ECX,0x8fffffff
0052d9b3 : MOV dword ptr [EDI + 0x8],ECX
0052d9b6 : MOV dword ptr [ESP + 0x14],EDI
0052d9ba : TEST ESI,ESI
0052d9bc : JZ 0x0052db3a
0052d9c2 : LEA EAX,[ESP + 0x58]
0052d9c6 : DEC EAX
0052d9c7 : MOV dword ptr [ESP + 0x20],EAX
0052d9cb : JMP 0x0052d9d4
0052d9d0 : MOV ESI,dword ptr [ESP + 0x2c]
0052d9d4 : PUSH 0x2e
0052d9d6 : PUSH EBP
0052d9d7 : CALL 0x00638800
0052d9dc : MOV EDI,EAX
0052d9de : ADD ESP,0x8
0052d9e1 : MOV dword ptr [ESP + 0x1c],EDI
0052d9e5 : TEST EDI,EDI
0052d9e7 : JZ 0x0052d9f5
0052d9e9 : MOV ESI,EDI
0052d9eb : SUB ESI,EBP
0052d9ed : INC ESI
0052d9ee : INC EDI
0052d9ef : MOV dword ptr [ESP + 0x1c],EDI
0052d9f3 : JMP 0x0052d9fb
0052d9f5 : SUB ESI,EBP
0052d9f7 : ADD ESI,dword ptr [ESP + 0x30]
0052d9fb : CMP ESI,0x100
0052da01 : JBE 0x0052da08
0052da03 : MOV ESI,0x100
0052da08 : LEA EDX,[ESI + -0x1]
0052da0b : PUSH EDX
0052da0c : LEA EAX,[ESP + 0x5c]
0052da10 : PUSH EBP
0052da11 : PUSH EAX
0052da12 : CALL 0x0063ae40
0052da17 : MOV EAX,dword ptr [EBX]
0052da19 : MOV ECX,dword ptr [ESP + 0x2c]
0052da1d : ADD ESP,0xc
0052da20 : ADD EAX,0x8
0052da23 : LEA EDX,[ESP + 0x58]
0052da27 : MOV byte ptr [ECX + ESI*0x1],0x0
0052da2b : PUSH EDX
0052da2c : LEA ECX,[EAX + 0x24c]
0052da32 : MOV EBP,EDI
0052da34 : MOV byte ptr [ESP + 0x3c],0x0
0052da39 : CALL 0x00525530
0052da3e : MOV ESI,dword ptr [ESP + 0x14]
0052da42 : MOV dword ptr [ESP + 0x18],EAX
0052da46 : INC dword ptr [EAX + 0x8]
0052da49 : MOV EAX,dword ptr [ESI + 0x10]
0052da4c : MOV EAX,dword ptr [EAX + 0x2c]
0052da4f : LEA ECX,[ESP + 0x38]
0052da53 : PUSH ECX
0052da54 : ADD ESI,0x10
0052da57 : LEA EDX,[ESP + 0x1c]
0052da5b : PUSH EDX
0052da5c : PUSH EBX
0052da5d : MOV ECX,ESI
0052da5f : CALL EAX
0052da61 : PUSH 0x0
0052da63 : TEST AL,AL
0052da65 : JZ 0x0052da85
0052da67 : LEA ECX,[ESP + 0x3c]
0052da6b : CALL 0x00526fa0
0052da70 : TEST EAX,EAX
0052da72 : JZ 0x0052da81
0052da74 : MOV ECX,dword ptr [EAX + 0x8]
0052da77 : INC ECX
0052da78 : AND ECX,0x8fffffff
0052da7e : MOV dword ptr [EAX + 0x8],ECX
0052da81 : MOV EDI,EAX
0052da83 : JMP 0x0052dae4
0052da85 : MOV EDX,dword ptr [EBX]
0052da87 : MOV ECX,dword ptr [EDX + 0x288]
0052da8d : PUSH 0x30
0052da8f : CALL 0x00515840
0052da94 : TEST EAX,EAX
0052da96 : JZ 0x0052daa7
0052da98 : MOV ECX,dword ptr [ESP + 0x34]
0052da9c : PUSH ECX
0052da9d : PUSH EBX
0052da9e : MOV ECX,EAX
0052daa0 : CALL 0x005511a0
0052daa5 : JMP 0x0052daa9
0052daa7 : XOR EAX,EAX
0052daa9 : MOV ECX,dword ptr [ESI]
0052daab : LEA EDX,[ESP + 0x13]
0052daaf : PUSH EDX
0052dab0 : MOV dword ptr [ESP + 0x2c],ECX
0052dab4 : PUSH EAX
0052dab5 : LEA ECX,[ESP + 0x50]
0052dab9 : MOV EDI,EAX
0052dabb : MOV byte ptr [ESP + 0x1b],0x0
0052dac0 : CALL 0x00526a90
0052dac5 : MOV EBX,dword ptr [ESP + 0x28]
0052dac9 : PUSH EAX
0052daca : LEA EAX,[ESP + 0x20]
0052dace : PUSH EAX
0052dacf : MOV EAX,dword ptr [ESP + 0x34]
0052dad3 : MOV EDX,dword ptr [EAX + 0x28]
0052dad6 : PUSH EBX
0052dad7 : MOV ECX,ESI
0052dad9 : CALL EDX
0052dadb : LEA ECX,[ESP + 0x48]
0052dadf : CALL 0x00526bc0
0052dae4 : TEST EDI,EDI
0052dae6 : JZ 0x0052daf4
0052dae8 : MOV EAX,dword ptr [EDI + 0x8]
0052daeb : INC EAX
0052daec : AND EAX,0x8fffffff
0052daf1 : MOV dword ptr [EDI + 0x8],EAX
0052daf4 : MOV ECX,dword ptr [ESP + 0x14]
0052daf8 : CALL 0x00503db0
0052dafd : MOV EAX,dword ptr [ESP + 0x18]
0052db01 : DEC dword ptr [EAX + 0x8]
0052db04 : MOV ECX,EAX
0052db06 : ADD EAX,0x8
0052db09 : CMP dword ptr [EAX],0x0
0052db0c : MOV dword ptr [ESP + 0x14],EDI
0052db10 : JNZ 0x0052db17
0052db12 : CALL 0x00525340
0052db17 : TEST EDI,EDI
0052db19 : JZ 0x0052db22
0052db1b : MOV ECX,EDI
0052db1d : CALL 0x00503db0
0052db22 : LEA ECX,[ESP + 0x38]
0052db26 : CALL 0x00526bc0
0052db2b : CMP dword ptr [ESP + 0x1c],0x0
0052db30 : JNZ 0x0052d9d0
0052db36 : MOV EDI,dword ptr [ESP + 0x14]
0052db3a : TEST EDI,EDI
0052db3c : JZ 0x0052db45
0052db3e : MOV ECX,EDI
0052db40 : CALL 0x00503db0
0052db45 : MOV ECX,dword ptr [ESP + 0x158]
0052db4c : MOV EAX,EDI
0052db4e : POP EDI
0052db4f : POP ESI
0052db50 : POP EBP
0052db51 : POP EBX
0052db52 : XOR ECX,ESP
0052db54 : CALL 0x00633e6b
0052db59 : ADD ESP,0x14c
0052db5f : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00723570
ENTRY    : 00723570
BODY     : [[00723570, 007235b8] [007235c0, 00723753]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00723570(int *param_1)

{
  short sVar1;
  char cVar2;
  uint uVar3;
  short *psVar4;
  int in_ECX;
  undefined1 auStack_24c [4];
  undefined4 uStack_248;
  uint local_244;
  undefined4 uStack_240;
  undefined1 auStack_23c [4];
  undefined2 uStack_238;
  undefined4 uStack_228;
  uint uStack_224;
  short sStack_220;
  undefined1 auStack_21e [514];
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_00b368f4;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_24c;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffda8;
  ExceptionList = &local_14;
LAB_007235c0:
  do {
    while( true ) {
      if (((uint)param_1[8] <= (uint)param_1[9]) ||
         (cVar2 = (**(code **)(*param_1 + 0x1c))(&local_244,uVar3), cVar2 == '\0'))
      goto LAB_0072372e;
      if (0x52 < local_244) break;
      if (local_244 == 0x52) {
        (**(code **)(*param_1 + 0xc))(in_ECX + 0x12,1,1);
      }
      else if (local_244 == 0x10) {
        FUN_0070d320(&sStack_220);
        psVar4 = &sStack_220;
        uStack_224 = 7;
        uStack_228 = 0;
        uStack_238 = 0;
        do {
          sVar1 = *psVar4;
          psVar4 = psVar4 + 1;
        } while (sVar1 != 0);
        FUN_00406360(&sStack_220,(int)psVar4 - (int)auStack_21e >> 1);
        uStack_c = 0;
        FUN_00405eb0(auStack_23c,0,0xffffffff);
        uStack_c = 0xffffffff;
        if (7 < uStack_224) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        uStack_224 = 7;
        uStack_228 = 0;
        uStack_238 = 0;
      }
      else if (local_244 == 0x13) {
        uStack_248 = 0xffffffff;
        (**(code **)(*param_1 + 0xc))(&uStack_248,4,1);
      }
      else if (local_244 == 0x51) {
        (**(code **)(*param_1 + 0xc))(in_ECX + 0x11,1,1);
      }
      else {
LAB_007236ef:
        (**(code **)(*param_1 + 0x24))(uStack_240);
      }
    }
    if (local_244 != 0x53) break;
    (**(code **)(*param_1 + 0xc))(in_ECX + 0x13,1,1);
  } while( true );
  if (local_244 != 0x61) {
    if (local_244 != 0x132) goto LAB_007236ef;
    goto LAB_0072372e;
  }
  cVar2 = FUN_004cd4c0(param_1);
  if (cVar2 == '\0') {
LAB_0072372e:
    ExceptionList = local_14;
    __security_check_cookie(local_1c ^ (uint)auStack_24c);
    return;
  }
  goto LAB_007235c0;
}



============================================================
DISASSEMBLY
============================================================
00723570 : PUSH EBP
00723571 : MOV EBP,ESP
00723573 : AND ESP,0xfffffff8
00723576 : PUSH -0x1
00723578 : PUSH 0xb368f4
0072357d : MOV EAX,FS:[0x0]
00723583 : PUSH EAX
00723584 : SUB ESP,0x238
0072358a : MOV EAX,[0x00d66fa0]
0072358f : XOR EAX,ESP
00723591 : MOV dword ptr [ESP + 0x230],EAX
00723598 : PUSH EBX
00723599 : PUSH ESI
0072359a : PUSH EDI
0072359b : MOV EAX,[0x00d66fa0]
007235a0 : XOR EAX,ESP
007235a2 : PUSH EAX
007235a3 : LEA EAX,[ESP + 0x248]
007235aa : MOV FS:[0x0],EAX
007235b0 : MOV ESI,dword ptr [EBP + 0x8]
007235b3 : MOV EDI,ECX
007235b5 : XOR EBX,EBX
007235b7 : JMP 0x007235c0
007235c0 : MOV EAX,dword ptr [ESI + 0x24]
007235c3 : CMP EAX,dword ptr [ESI + 0x20]
007235c6 : JNC 0x0072372c
007235cc : MOV EDX,dword ptr [ESI]
007235ce : MOV EDX,dword ptr [EDX + 0x1c]
007235d1 : LEA EAX,[ESP + 0x18]
007235d5 : PUSH EAX
007235d6 : MOV ECX,ESI
007235d8 : CALL EDX
007235da : TEST AL,AL
007235dc : JZ 0x00723712
007235e2 : MOV EAX,dword ptr [ESP + 0x18]
007235e6 : CMP EAX,0x52
007235e9 : JA 0x007236de
007235ef : JZ 0x007236c8
007235f5 : CMP EAX,0x10
007235f8 : JZ 0x00723637
007235fa : CMP EAX,0x13
007235fd : JZ 0x0072361b
007235ff : CMP EAX,0x51
00723602 : JNZ 0x007236ef
00723608 : MOV EAX,dword ptr [ESI]
0072360a : MOV EDX,dword ptr [EAX + 0xc]
0072360d : PUSH 0x1
0072360f : PUSH 0x1
00723611 : LEA ECX,[EDI + 0x11]
00723614 : PUSH ECX
00723615 : MOV ECX,ESI
00723617 : CALL EDX
00723619 : JMP 0x007235c0
0072361b : MOV EAX,dword ptr [ESI]
0072361d : MOV EDX,dword ptr [EAX + 0xc]
00723620 : PUSH 0x1
00723622 : PUSH 0x4
00723624 : LEA ECX,[ESP + 0x1c]
00723628 : PUSH ECX
00723629 : MOV ECX,ESI
0072362b : MOV dword ptr [ESP + 0x20],0xffffffff
00723633 : CALL EDX
00723635 : JMP 0x007235c0
00723637 : LEA EAX,[ESP + 0x3c]
0072363b : PUSH EAX
0072363c : MOV ECX,ESI
0072363e : CALL 0x0070d320
00723643 : XOR ECX,ECX
00723645 : LEA EAX,[ESP + 0x3c]
00723649 : MOV dword ptr [ESP + 0x38],0x7
00723651 : MOV dword ptr [ESP + 0x34],EBX
00723655 : MOV word ptr [ESP + 0x24],CX
0072365a : LEA EDX,[EAX + 0x2]
0072365d : LEA ECX,[ECX]
00723660 : MOV CX,word ptr [EAX]
00723663 : ADD EAX,0x2
00723666 : CMP CX,BX
00723669 : JNZ 0x00723660
0072366b : SUB EAX,EDX
0072366d : SAR EAX,0x1
0072366f : PUSH EAX
00723670 : LEA EDX,[ESP + 0x40]
00723674 : PUSH EDX
00723675 : LEA ECX,[ESP + 0x28]
00723679 : CALL 0x00406360
0072367e : MOV dword ptr [ESP + 0x250],EBX
00723685 : PUSH -0x1
00723687 : PUSH EBX
00723688 : LEA EAX,[ESP + 0x28]
0072368c : PUSH EAX
0072368d : LEA ECX,[EDI + 0x14]
00723690 : CALL 0x00405eb0
00723695 : MOV dword ptr [ESP + 0x250],0xffffffff
007236a0 : CMP dword ptr [ESP + 0x38],0x8
007236a5 : JC 0x007236b0
007236a7 : MOV ECX,dword ptr [ESP + 0x24]
007236ab : CALL 0x006f04e0
007236b0 : XOR ECX,ECX
007236b2 : MOV dword ptr [ESP + 0x38],0x7
007236ba : MOV dword ptr [ESP + 0x34],EBX
007236be : MOV word ptr [ESP + 0x24],CX
007236c3 : JMP 0x007235c0
007236c8 : MOV EDX,dword ptr [ESI]
007236ca : MOV EDX,dword ptr [EDX + 0xc]
007236cd : PUSH 0x1
007236cf : PUSH 0x1
007236d1 : LEA EAX,[EDI + 0x12]
007236d4 : PUSH EAX
007236d5 : MOV ECX,ESI
007236d7 : CALL EDX
007236d9 : JMP 0x007235c0
007236de : CMP EAX,0x53
007236e1 : JZ 0x00723716
007236e3 : CMP EAX,0x61
007236e6 : JZ 0x00723702
007236e8 : CMP EAX,0x132
007236ed : JZ 0x0072372c
007236ef : MOV ECX,dword ptr [ESP + 0x1c]
007236f3 : MOV EAX,dword ptr [ESI]
007236f5 : MOV EDX,dword ptr [EAX + 0x24]
007236f8 : PUSH ECX
007236f9 : MOV ECX,ESI
007236fb : CALL EDX
007236fd : JMP 0x007235c0
00723702 : PUSH ESI
00723703 : MOV ECX,EDI
00723705 : CALL 0x004cd4c0
0072370a : TEST AL,AL
0072370c : JNZ 0x007235c0
00723712 : XOR AL,AL
00723714 : JMP 0x0072372e
00723716 : MOV EAX,dword ptr [ESI]
00723718 : MOV EDX,dword ptr [EAX + 0xc]
0072371b : PUSH 0x1
0072371d : PUSH 0x1
0072371f : LEA ECX,[EDI + 0x13]
00723722 : PUSH ECX
00723723 : MOV ECX,ESI
00723725 : CALL EDX
00723727 : JMP 0x007235c0
0072372c : MOV AL,0x1
0072372e : MOV ECX,dword ptr [ESP + 0x248]
00723735 : MOV dword ptr FS:[0x0],ECX
0072373c : POP ECX
0072373d : POP EDI
0072373e : POP ESI
0072373f : POP EBX
00723740 : MOV ECX,dword ptr [ESP + 0x230]
00723747 : XOR ECX,ESP
00723749 : CALL 0x00633e6b
0072374e : MOV ESP,EBP
00723750 : POP EBP
00723751 : RET 0x4

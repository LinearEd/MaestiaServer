PROGRAM  : Maestia.exe
FUNCTION : FUN_005a5150
ENTRY    : 005a5150
BODY     : [[005a5150, 005a5298]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005a5150(undefined4 param_1,int *param_2,uint param_3)

{
  uint *puVar1;
  int *piVar2;
  int iVar3;
  uint *puVar4;
  uint uVar5;
  int *in_ECX;
  uint uVar6;
  int iVar7;
  
  piVar2 = (int *)*in_ECX;
  if (piVar2 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar2 * 5) <= piVar2[1] * 4 + 4U) goto LAB_005a518b;
    iVar7 = piVar2[1] * 2 + 2;
  }
  FUN_005a3d60(param_1,iVar7);
LAB_005a518b:
  piVar2 = (int *)*in_ECX;
  param_3 = param_3 & piVar2[1];
  *piVar2 = *piVar2 + 1;
  iVar7 = *in_ECX;
  iVar3 = *(int *)(iVar7 + 8 + param_3 * 0x14);
  puVar1 = (uint *)(iVar7 + 8 + param_3 * 0x14);
  if (iVar3 == -2) {
    *puVar1 = 0xffffffff;
    puVar4 = (uint *)*param_2;
    puVar1[2] = *puVar4;
    puVar1[3] = puVar4[1];
    puVar1[4] = *(uint *)param_2[1];
    puVar1[1] = param_3;
    return;
  }
  uVar6 = param_3;
  do {
    uVar6 = uVar6 + 1 & *(uint *)(iVar7 + 4);
  } while (*(int *)(iVar7 + 8 + uVar6 * 0x14) != -2);
  piVar2 = (int *)(iVar7 + 8 + uVar6 * 0x14);
  uVar5 = puVar1[1];
  if (uVar5 != param_3) {
    puVar4 = (uint *)(iVar7 + 8 + uVar5 * 0x14);
    for (uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x14); uVar5 != param_3;
        uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x14)) {
      uVar5 = *puVar4;
      puVar4 = (uint *)(iVar7 + 8 + uVar5 * 0x14);
    }
    if (piVar2 != (int *)0x0) {
      *piVar2 = iVar3;
      piVar2[1] = puVar1[1];
      piVar2[2] = puVar1[2];
      piVar2[3] = puVar1[3];
      piVar2[4] = puVar1[4];
    }
    *puVar4 = uVar6;
    puVar4 = (uint *)*param_2;
    puVar1[2] = *puVar4;
    puVar1[3] = puVar4[1];
    puVar1[4] = *(uint *)param_2[1];
    *puVar1 = 0xffffffff;
    puVar1[1] = param_3;
    return;
  }
  if (piVar2 != (int *)0x0) {
    *piVar2 = iVar3;
    piVar2[1] = puVar1[1];
    piVar2[2] = puVar1[2];
    piVar2[3] = puVar1[3];
    piVar2[4] = puVar1[4];
  }
  puVar4 = (uint *)*param_2;
  puVar1[2] = *puVar4;
  puVar1[3] = puVar4[1];
  puVar1[4] = *(uint *)param_2[1];
  *puVar1 = uVar6;
  puVar1[1] = param_3;
  return;
}



============================================================
DISASSEMBLY
============================================================
005a5150 : PUSH EBP
005a5151 : PUSH ESI
005a5152 : MOV ESI,ECX
005a5154 : MOV EAX,dword ptr [ESI]
005a5156 : PUSH EDI
005a5157 : TEST EAX,EAX
005a5159 : JNZ 0x005a5164
005a515b : MOV EAX,dword ptr [ESP + 0x10]
005a515f : PUSH 0x8
005a5161 : PUSH EAX
005a5162 : JMP 0x005a5186
005a5164 : MOV ECX,dword ptr [EAX + 0x4]
005a5167 : LEA EDX,[ECX*0x4 + 0x4]
005a516e : MOV ECX,dword ptr [EAX]
005a5170 : LEA ECX,[ECX + ECX*0x4]
005a5173 : CMP ECX,EDX
005a5175 : JBE 0x005a518b
005a5177 : MOV EDX,dword ptr [EAX + 0x4]
005a517a : MOV ECX,dword ptr [ESP + 0x10]
005a517e : LEA EAX,[EDX + EDX*0x1 + 0x2]
005a5182 : PUSH EAX
005a5183 : PUSH ECX
005a5184 : MOV ECX,ESI
005a5186 : CALL 0x005a3d60
005a518b : MOV EAX,dword ptr [ESI]
005a518d : MOV ECX,dword ptr [ESP + 0x18]
005a5191 : AND ECX,dword ptr [EAX + 0x4]
005a5194 : INC dword ptr [EAX]
005a5196 : MOV ESI,dword ptr [ESI]
005a5198 : LEA EDX,[ECX + ECX*0x4]
005a519b : MOV EBP,dword ptr [ESI + EDX*0x4 + 0x8]
005a519f : LEA EAX,[ESI + EDX*0x4 + 0x8]
005a51a3 : CMP EBP,-0x2
005a51a6 : JNZ 0x005a51d0
005a51a8 : MOV ESI,dword ptr [ESP + 0x14]
005a51ac : MOV dword ptr [EAX],0xffffffff
005a51b2 : MOV EDX,dword ptr [ESI]
005a51b4 : MOV EDI,dword ptr [EDX]
005a51b6 : MOV dword ptr [EAX + 0x8],EDI
005a51b9 : MOV EDX,dword ptr [EDX + 0x4]
005a51bc : MOV dword ptr [EAX + 0xc],EDX
005a51bf : MOV EDX,dword ptr [ESI + 0x4]
005a51c2 : MOV EDX,dword ptr [EDX]
005a51c4 : POP EDI
005a51c5 : POP ESI
005a51c6 : MOV dword ptr [EAX + 0x10],EDX
005a51c9 : MOV dword ptr [EAX + 0x4],ECX
005a51cc : POP EBP
005a51cd : RET 0xc
005a51d0 : MOV EDI,dword ptr [ESI + 0x4]
005a51d3 : MOV EDX,ECX
005a51d5 : PUSH EBX
005a51d6 : INC EDX
005a51d7 : AND EDX,EDI
005a51d9 : LEA EBX,[EDX + EDX*0x4]
005a51dc : CMP dword ptr [ESI + EBX*0x4 + 0x8],-0x2
005a51e1 : JNZ 0x005a51d6
005a51e3 : LEA EDI,[EDX + EDX*0x4]
005a51e6 : LEA EBX,[ESI + EDI*0x4 + 0x8]
005a51ea : MOV EDI,dword ptr [EAX + 0x4]
005a51ed : CMP EDI,ECX
005a51ef : JNZ 0x005a5234
005a51f1 : TEST EBX,EBX
005a51f3 : JZ 0x005a520f
005a51f5 : MOV dword ptr [EBX],EBP
005a51f7 : MOV ESI,dword ptr [EAX + 0x4]
005a51fa : MOV dword ptr [EBX + 0x4],ESI
005a51fd : MOV ESI,dword ptr [EAX + 0x8]
005a5200 : MOV dword ptr [EBX + 0x8],ESI
005a5203 : MOV ESI,dword ptr [EAX + 0xc]
005a5206 : MOV dword ptr [EBX + 0xc],ESI
005a5209 : MOV ESI,dword ptr [EAX + 0x10]
005a520c : MOV dword ptr [EBX + 0x10],ESI
005a520f : MOV EDI,dword ptr [ESP + 0x18]
005a5213 : MOV ESI,dword ptr [EDI]
005a5215 : MOV EBX,dword ptr [ESI]
005a5217 : MOV dword ptr [EAX + 0x8],EBX
005a521a : MOV ESI,dword ptr [ESI + 0x4]
005a521d : MOV dword ptr [EAX + 0xc],ESI
005a5220 : MOV ESI,dword ptr [EDI + 0x4]
005a5223 : MOV ESI,dword ptr [ESI]
005a5225 : POP EBX
005a5226 : MOV dword ptr [EAX + 0x10],ESI
005a5229 : POP EDI
005a522a : POP ESI
005a522b : MOV dword ptr [EAX],EDX
005a522d : MOV dword ptr [EAX + 0x4],ECX
005a5230 : POP EBP
005a5231 : RET 0xc
005a5234 : LEA EDI,[EDI + EDI*0x4]
005a5237 : CMP dword ptr [ESI + EDI*0x4 + 0x8],ECX
005a523b : LEA EDI,[ESI + EDI*0x4 + 0x8]
005a523f : JZ 0x005a5250
005a5241 : MOV EDI,dword ptr [EDI]
005a5243 : LEA EDI,[EDI + EDI*0x4]
005a5246 : CMP dword ptr [ESI + EDI*0x4 + 0x8],ECX
005a524a : LEA EDI,[ESI + EDI*0x4 + 0x8]
005a524e : JNZ 0x005a5241
005a5250 : TEST EBX,EBX
005a5252 : JZ 0x005a526e
005a5254 : MOV dword ptr [EBX],EBP
005a5256 : MOV ESI,dword ptr [EAX + 0x4]
005a5259 : MOV dword ptr [EBX + 0x4],ESI
005a525c : MOV ESI,dword ptr [EAX + 0x8]
005a525f : MOV dword ptr [EBX + 0x8],ESI
005a5262 : MOV ESI,dword ptr [EAX + 0xc]
005a5265 : MOV dword ptr [EBX + 0xc],ESI
005a5268 : MOV ESI,dword ptr [EAX + 0x10]
005a526b : MOV dword ptr [EBX + 0x10],ESI
005a526e : MOV ESI,dword ptr [ESP + 0x18]
005a5272 : MOV dword ptr [EDI],EDX
005a5274 : MOV EDX,dword ptr [ESI]
005a5276 : MOV EDI,dword ptr [EDX]
005a5278 : MOV dword ptr [EAX + 0x8],EDI
005a527b : MOV EDX,dword ptr [EDX + 0x4]
005a527e : MOV dword ptr [EAX + 0xc],EDX
005a5281 : MOV EDX,dword ptr [ESI + 0x4]
005a5284 : MOV EDX,dword ptr [EDX]
005a5286 : POP EBX
005a5287 : POP EDI
005a5288 : MOV dword ptr [EAX + 0x10],EDX
005a528b : POP ESI
005a528c : MOV dword ptr [EAX],0xffffffff
005a5292 : MOV dword ptr [EAX + 0x4],ECX
005a5295 : POP EBP
005a5296 : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_009f8bb0
ENTRY    : 009f8bb0
BODY     : [[009f8bb0, 009f8e13]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009f8bb0(int param_1)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  undefined4 *****pppppuVar4;
  short *psVar5;
  int local_74;
  int local_70;
  undefined1 local_69;
  undefined2 local_64;
  undefined4 local_54;
  uint local_50;
  undefined4 ****local_48 [4];
  undefined4 local_38;
  uint local_34;
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  iVar1 = DAT_00d7c54c;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b5dded;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_70 = *(int *)(param_1 + 0x10);
  local_14 = uVar2;
  FUN_004437f0(&local_70);
  if (((local_74 != *(int *)(iVar1 + 0x44)) && (iVar1 = *(int *)(local_74 + 0x10), iVar1 != 0)) &&
     ((uint)*(byte *)(iVar1 + 0x40) <= *(uint *)(*(int *)(DAT_0172491c + 0x17c) + 0xa0))) {
    local_69 = 0;
    local_70 = (**(code **)(*(int *)(iVar1 + 0x128) + 4))(uVar2);
    if (local_70 != 0) {
LAB_009f8c50:
      iVar3 = FUN_004f5680();
      if (iVar3 != 0) {
        FUN_00824a20(DAT_0172491c,0);
        local_8 = 0;
        for (psVar5 = *(short **)(iVar1 + 0x150); psVar5 != *(short **)(iVar1 + 0x154);
            psVar5 = psVar5 + 4) {
          if (*psVar5 == *(short *)(iVar3 + 6)) {
            if (*(int *)(psVar5 + 2) != 0) {
              psVar5 = *(short **)(iVar1 + 0x150);
              if (psVar5 == *(short **)(iVar1 + 0x154)) goto LAB_009f8d05;
              goto LAB_009f8cf0;
            }
            break;
          }
        }
        local_8 = 0xffffffff;
        if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_18 = 7;
        local_1c = 0;
        local_2c = 0;
      }
      goto LAB_009f8de9;
    }
  }
LAB_009f8df6:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
  while (psVar5 = psVar5 + 4, psVar5 != *(short **)(iVar1 + 0x154)) {
LAB_009f8cf0:
    if (*psVar5 == (short)*(undefined4 *)(*(int *)(DAT_0172491c + 0x17c) + 0x16d8)) {
      if (*(int *)(psVar5 + 2) != 0) {
        FUN_00824a20(DAT_0172491c,0);
        local_8._0_1_ = 1;
        FUN_00824a20(DAT_0172491c,0);
        local_8._0_1_ = 2;
        pppppuVar4 = (undefined4 *****)local_48[0];
        if (local_34 < 8) {
          pppppuVar4 = local_48;
        }
        iVar3 = FUN_00405bb0(pppppuVar4);
        if (iVar3 == 0) {
          local_69 = 1;
        }
        local_8 = CONCAT31(local_8._1_3_,1);
        if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_34 = 7;
        local_38 = 0;
        local_48[0] = (undefined4 ****)((uint)local_48[0] & 0xffff0000);
        local_8 = (uint)local_8._1_3_ << 8;
        if (7 < local_50) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_50 = 7;
        local_54 = 0;
        local_64 = 0;
        local_8 = 0xffffffff;
        if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        goto LAB_009f8de2;
      }
      break;
    }
  }
LAB_009f8d05:
  local_8 = 0xffffffff;
  if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
LAB_009f8de2:
  local_8 = 0xffffffff;
  local_18 = 7;
  local_2c = 0;
  local_1c = 0;
LAB_009f8de9:
  if (local_70 == 0) goto LAB_009f8df6;
  goto LAB_009f8c50;
}



============================================================
DISASSEMBLY
============================================================
009f8bb0 : PUSH EBP
009f8bb1 : MOV EBP,ESP
009f8bb3 : PUSH -0x1
009f8bb5 : PUSH 0xb5dded
009f8bba : MOV EAX,FS:[0x0]
009f8bc0 : PUSH EAX
009f8bc1 : SUB ESP,0x64
009f8bc4 : MOV EAX,[0x00d66fa0]
009f8bc9 : XOR EAX,EBP
009f8bcb : MOV dword ptr [EBP + -0x10],EAX
009f8bce : PUSH EBX
009f8bcf : PUSH ESI
009f8bd0 : PUSH EDI
009f8bd1 : PUSH EAX
009f8bd2 : LEA EAX,[EBP + -0xc]
009f8bd5 : MOV FS:[0x0],EAX
009f8bdb : MOV EAX,dword ptr [EBP + 0x8]
009f8bde : MOV ECX,dword ptr [EAX + 0x10]
009f8be1 : MOV ESI,dword ptr [0x00d7c54c]
009f8be7 : LEA EDX,[EBP + -0x6c]
009f8bea : MOV dword ptr [EBP + -0x6c],ECX
009f8bed : PUSH EDX
009f8bee : LEA ECX,[ESI + 0x40]
009f8bf1 : LEA EAX,[EBP + -0x70]
009f8bf4 : CALL 0x004437f0
009f8bf9 : MOV ESI,dword ptr [ESI + 0x44]
009f8bfc : MOV EAX,dword ptr [EBP + -0x70]
009f8bff : CMP EAX,ESI
009f8c01 : JZ 0x009f8c0a
009f8c03 : MOV EAX,dword ptr [EAX + 0x10]
009f8c06 : TEST EAX,EAX
009f8c08 : JNZ 0x009f8c11
009f8c0a : XOR AL,AL
009f8c0c : JMP 0x009f8df6
009f8c11 : MOV ECX,dword ptr [0x0172491c]
009f8c17 : MOV ECX,dword ptr [ECX + 0x17c]
009f8c1d : MOVZX EDX,byte ptr [EAX + 0x40]
009f8c21 : MOV ECX,dword ptr [ECX + 0xa0]
009f8c27 : CMP EDX,ECX
009f8c29 : JA 0x009f8c0a
009f8c2b : LEA EBX,[EAX + 0x128]
009f8c31 : MOV EAX,dword ptr [EBX]
009f8c33 : MOV EDX,dword ptr [EAX + 0x4]
009f8c36 : MOV ECX,EBX
009f8c38 : MOV byte ptr [EBP + -0x65],0x0
009f8c3c : CALL EDX
009f8c3e : MOV dword ptr [EBP + -0x6c],EAX
009f8c41 : TEST EAX,EAX
009f8c43 : JZ 0x009f8df3
009f8c49 : LEA ESP,[ESP]
009f8c50 : LEA EDX,[EBP + -0x6c]
009f8c53 : MOV EAX,EBX
009f8c55 : CALL 0x004f5680
009f8c5a : MOV EDI,EAX
009f8c5c : TEST EDI,EDI
009f8c5e : JZ 0x009f8de9
009f8c64 : MOV EAX,[0x0172491c]
009f8c69 : PUSH 0x0
009f8c6b : LEA EDX,[EDI + 0x18]
009f8c6e : PUSH EAX
009f8c6f : LEA ESI,[EBP + -0x2c]
009f8c72 : CALL 0x00824a20
009f8c77 : XOR ESI,ESI
009f8c79 : MOV dword ptr [EBP + -0x4],ESI
009f8c7c : MOV EAX,dword ptr [EBX + 0x28]
009f8c7f : MOV ECX,dword ptr [EBX + 0x2c]
009f8c82 : MOVZX EDX,word ptr [EDI + 0x6]
009f8c86 : CMP EAX,ECX
009f8c88 : JZ 0x009f8ca8
009f8c8a : LEA EBX,[EBX]
009f8c90 : CMP word ptr [EAX],DX
009f8c93 : JZ 0x009f8c9e
009f8c95 : ADD EAX,0x8
009f8c98 : CMP EAX,ECX
009f8c9a : JNZ 0x009f8c90
009f8c9c : JMP 0x009f8ca8
009f8c9e : MOV EAX,dword ptr [EAX + 0x4]
009f8ca1 : MOV dword ptr [EBP + -0x70],EAX
009f8ca4 : CMP EAX,ESI
009f8ca6 : JNZ 0x009f8cd2
009f8ca8 : MOV dword ptr [EBP + -0x4],0xffffffff
009f8caf : CMP dword ptr [EBP + -0x14],0x8
009f8cb3 : JC 0x009f8cbd
009f8cb5 : MOV ECX,dword ptr [EBP + -0x28]
009f8cb8 : CALL 0x006f04e0
009f8cbd : XOR ECX,ECX
009f8cbf : MOV dword ptr [EBP + -0x14],0x7
009f8cc6 : MOV dword ptr [EBP + -0x18],ESI
009f8cc9 : MOV word ptr [EBP + -0x28],CX
009f8ccd : JMP 0x009f8de9
009f8cd2 : MOV EAX,[0x0172491c]
009f8cd7 : MOV ECX,dword ptr [EAX + 0x17c]
009f8cdd : MOV ESI,dword ptr [ECX + 0x16d8]
009f8ce3 : MOV ECX,dword ptr [EBX + 0x28]
009f8ce6 : MOV EDX,dword ptr [EBX + 0x2c]
009f8ce9 : CMP ECX,EDX
009f8ceb : JZ 0x009f8d05
009f8ced : LEA ECX,[ECX]
009f8cf0 : CMP word ptr [ECX],SI
009f8cf3 : JZ 0x009f8cfe
009f8cf5 : ADD ECX,0x8
009f8cf8 : CMP ECX,EDX
009f8cfa : JNZ 0x009f8cf0
009f8cfc : JMP 0x009f8d05
009f8cfe : MOV EDI,dword ptr [ECX + 0x4]
009f8d01 : TEST EDI,EDI
009f8d03 : JNZ 0x009f8d2c
009f8d05 : MOV dword ptr [EBP + -0x4],0xffffffff
009f8d0c : CMP dword ptr [EBP + -0x14],0x8
009f8d10 : JC 0x009f8d1a
009f8d12 : MOV ECX,dword ptr [EBP + -0x28]
009f8d15 : CALL 0x006f04e0
009f8d1a : XOR EDX,EDX
009f8d1c : MOV dword ptr [EBP + -0x14],0x7
009f8d23 : MOV word ptr [EBP + -0x28],DX
009f8d27 : JMP 0x009f8de2
009f8d2c : MOV EDX,dword ptr [EBP + -0x70]
009f8d2f : PUSH 0x0
009f8d31 : ADD EDX,0x18
009f8d34 : PUSH EAX
009f8d35 : LEA ESI,[EBP + -0x64]
009f8d38 : CALL 0x00824a20
009f8d3d : MOV byte ptr [EBP + -0x4],0x1
009f8d41 : MOV EAX,[0x0172491c]
009f8d46 : PUSH 0x0
009f8d48 : LEA EDX,[EDI + 0x18]
009f8d4b : PUSH EAX
009f8d4c : LEA ESI,[EBP + -0x48]
009f8d4f : CALL 0x00824a20
009f8d54 : MOV byte ptr [EBP + -0x4],0x2
009f8d58 : MOV EAX,dword ptr [EBP + -0x44]
009f8d5b : MOV ESI,0x8
009f8d60 : CMP dword ptr [EBP + -0x30],ESI
009f8d63 : JNC 0x009f8d68
009f8d65 : LEA EAX,[EBP + -0x44]
009f8d68 : MOV EDI,dword ptr [EBP + -0x34]
009f8d6b : PUSH EAX
009f8d6c : MOV EAX,dword ptr [EBP + -0x50]
009f8d6f : LEA ECX,[EBP + -0x64]
009f8d72 : CALL 0x00405bb0
009f8d77 : TEST EAX,EAX
009f8d79 : JNZ 0x009f8d7f
009f8d7b : MOV byte ptr [EBP + -0x65],0x1
009f8d7f : MOV byte ptr [EBP + -0x4],0x1
009f8d83 : CMP dword ptr [EBP + -0x30],ESI
009f8d86 : JC 0x009f8d90
009f8d88 : MOV ECX,dword ptr [EBP + -0x44]
009f8d8b : CALL 0x006f04e0
009f8d90 : XOR ECX,ECX
009f8d92 : MOV EDI,0x7
009f8d97 : MOV dword ptr [EBP + -0x30],EDI
009f8d9a : MOV dword ptr [EBP + -0x34],0x0
009f8da1 : MOV word ptr [EBP + -0x44],CX
009f8da5 : MOV byte ptr [EBP + -0x4],CL
009f8da8 : CMP dword ptr [EBP + -0x4c],ESI
009f8dab : JC 0x009f8db5
009f8dad : MOV ECX,dword ptr [EBP + -0x60]
009f8db0 : CALL 0x006f04e0
009f8db5 : XOR EDX,EDX
009f8db7 : MOV dword ptr [EBP + -0x4c],EDI
009f8dba : MOV dword ptr [EBP + -0x50],0x0
009f8dc1 : MOV word ptr [EBP + -0x60],DX
009f8dc5 : MOV dword ptr [EBP + -0x4],0xffffffff
009f8dcc : CMP dword ptr [EBP + -0x14],ESI
009f8dcf : JC 0x009f8dd9
009f8dd1 : MOV ECX,dword ptr [EBP + -0x28]
009f8dd4 : CALL 0x006f04e0
009f8dd9 : XOR EAX,EAX
009f8ddb : MOV dword ptr [EBP + -0x14],EDI
009f8dde : MOV word ptr [EBP + -0x28],AX
009f8de2 : MOV dword ptr [EBP + -0x18],0x0
009f8de9 : CMP dword ptr [EBP + -0x6c],0x0
009f8ded : JNZ 0x009f8c50
009f8df3 : MOV AL,byte ptr [EBP + -0x65]
009f8df6 : MOV ECX,dword ptr [EBP + -0xc]
009f8df9 : MOV dword ptr FS:[0x0],ECX
009f8e00 : POP ECX
009f8e01 : POP EDI
009f8e02 : POP ESI
009f8e03 : POP EBX
009f8e04 : MOV ECX,dword ptr [EBP + -0x10]
009f8e07 : XOR ECX,EBP
009f8e09 : CALL 0x00633e6b
009f8e0e : MOV ESP,EBP
009f8e10 : POP EBP
009f8e11 : RET 0x4

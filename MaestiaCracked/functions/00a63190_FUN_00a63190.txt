PROGRAM  : Maestia.exe
FUNCTION : FUN_00a63190
ENTRY    : 00a63190
BODY     : [[00a63190, 00a633f4]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a63190(int param_1)

{
  short sVar1;
  uint uVar2;
  void **ppvVar3;
  uint uVar4;
  int iVar5;
  void *_Dst;
  short *psVar6;
  int *unaff_ESI;
  undefined2 *puVar7;
  undefined1 local_180 [80];
  int local_130;
  int local_12c;
  int local_128;
  undefined4 local_124;
  int local_120;
  int local_11c;
  uint local_118;
  short local_114;
  undefined1 local_112 [254];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3bbc3;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  puVar7 = (undefined2 *)0x0;
  local_14 = uVar4;
  ppvVar3 = &local_10;
  local_10 = ExceptionList;
  for (local_120 = param_1 + -8; ExceptionList = ppvVar3, 0 < local_120;
      local_120 = local_120 - local_12c) {
    local_128 = (**(code **)(*unaff_ESI + 0xc))(&local_130,4,1,uVar4);
    iVar5 = (**(code **)(*unaff_ESI + 0xc))(&local_12c,4,1);
    local_128 = local_128 + iVar5;
    if (local_130 == 0x20101100) {
      local_11c = FUN_006f0760(0x28,"",0,(DAT_01725270 >> 3 & 1) == 0);
      local_8 = 0;
      if (local_11c == 0) {
        puVar7 = (undefined2 *)0x0;
      }
      else {
        puVar7 = (undefined2 *)FUN_004c4590(local_11c);
      }
      local_8 = 0xffffffff;
      local_124 = 0;
      (**(code **)(*unaff_ESI + 0xc))(&local_124,2,1);
      *puVar7 = (undefined2)local_124;
    }
    else if (local_130 == 0x20101101) {
      local_118 = 0;
      (**(code **)(*unaff_ESI + 0xc))(&local_118,2,1);
      uVar2 = local_118;
      if ((short)local_118 != 0) {
        _memset(&local_114,0,0x100);
        (**(code **)(*unaff_ESI + 0xc))(&local_114,2,uVar2 & 0xffff);
        psVar6 = &local_114;
        do {
          sVar1 = *psVar6;
          psVar6 = psVar6 + 1;
        } while (sVar1 != 0);
        FUN_00406360(&local_114,(int)psVar6 - (int)local_112 >> 1);
      }
    }
    else if (local_130 == 0x20101102) {
      local_118 = 0;
      (**(code **)(*unaff_ESI + 0xc))(&local_118,2,1);
      (**(code **)(*unaff_ESI + 0xc))(local_180,4,local_118 & 0xffff);
      puVar7[0x10] = (short)local_118;
      _Dst = (void *)FUN_006f0760((local_118 & 0xffff) * 4,"",0,(DAT_01725270 >> 3 & 1) == 0);
      *(void **)(puVar7 + 0x12) = _Dst;
      _memcpy(_Dst,local_180,(local_118 & 0xffff) * 4);
    }
    else {
      (**(code **)(*unaff_ESI + 0x24))(local_12c);
    }
    ppvVar3 = ExceptionList;
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a63190 : PUSH EBP
00a63191 : MOV EBP,ESP
00a63193 : PUSH -0x1
00a63195 : PUSH 0xb3bbc3
00a6319a : MOV EAX,FS:[0x0]
00a631a0 : PUSH EAX
00a631a1 : SUB ESP,0x170
00a631a7 : MOV EAX,[0x00d66fa0]
00a631ac : XOR EAX,EBP
00a631ae : MOV dword ptr [EBP + -0x10],EAX
00a631b1 : PUSH EBX
00a631b2 : PUSH EDI
00a631b3 : PUSH EAX
00a631b4 : LEA EAX,[EBP + -0xc]
00a631b7 : MOV FS:[0x0],EAX
00a631bd : MOV EAX,dword ptr [EBP + 0x8]
00a631c0 : ADD EAX,-0x8
00a631c3 : XOR EBX,EBX
00a631c5 : XOR EDI,EDI
00a631c7 : CMP EAX,EBX
00a631c9 : MOV dword ptr [EBP + 0xfffffee4],EAX
00a631cf : JLE 0x00a633d6
00a631d5 : MOV EAX,dword ptr [ESI]
00a631d7 : MOV EDX,dword ptr [EAX + 0xc]
00a631da : PUSH 0x1
00a631dc : PUSH 0x4
00a631de : LEA ECX,[EBP + 0xfffffed4]
00a631e4 : PUSH ECX
00a631e5 : MOV ECX,ESI
00a631e7 : CALL EDX
00a631e9 : PUSH 0x1
00a631eb : MOV dword ptr [EBP + 0xfffffedc],EAX
00a631f1 : MOV EAX,dword ptr [ESI]
00a631f3 : MOV EDX,dword ptr [EAX + 0xc]
00a631f6 : PUSH 0x4
00a631f8 : LEA ECX,[EBP + 0xfffffed8]
00a631fe : PUSH ECX
00a631ff : MOV ECX,ESI
00a63201 : CALL EDX
00a63203 : ADD dword ptr [EBP + 0xfffffedc],EAX
00a63209 : MOV EAX,dword ptr [EBP + 0xfffffed4]
00a6320f : SUB EAX,0x20101100
00a63214 : JZ 0x00a63351
00a6321a : SUB EAX,0x1
00a6321d : JZ 0x00a632d1
00a63223 : SUB EAX,0x1
00a63226 : MOV EAX,dword ptr [ESI]
00a63228 : JZ 0x00a6323d
00a6322a : MOV ECX,dword ptr [EBP + 0xfffffed8]
00a63230 : MOV EDX,dword ptr [EAX + 0x24]
00a63233 : PUSH ECX
00a63234 : MOV ECX,ESI
00a63236 : CALL EDX
00a63238 : JMP 0x00a633bc
00a6323d : MOV EDX,dword ptr [EAX + 0xc]
00a63240 : PUSH 0x1
00a63242 : PUSH 0x2
00a63244 : LEA ECX,[EBP + 0xfffffeec]
00a6324a : PUSH ECX
00a6324b : MOV ECX,ESI
00a6324d : MOV dword ptr [EBP + 0xfffffeec],EBX
00a63253 : CALL EDX
00a63255 : MOVZX ECX,word ptr [EBP + 0xfffffeec]
00a6325c : MOV EAX,dword ptr [ESI]
00a6325e : MOV EAX,dword ptr [EAX + 0xc]
00a63261 : PUSH ECX
00a63262 : PUSH 0x4
00a63264 : LEA EDX,[EBP + 0xfffffe84]
00a6326a : PUSH EDX
00a6326b : MOV ECX,ESI
00a6326d : CALL EAX
00a6326f : MOV EAX,dword ptr [EBP + 0xfffffeec]
00a63275 : MOV word ptr [EDI + 0x20],AX
00a63279 : XOR ECX,ECX
00a6327b : MOVZX EAX,AX
00a6327e : MOV EDX,0x4
00a63283 : MUL EDX
00a63285 : SETO CL
00a63288 : MOV EDX,0x0
00a6328d : NEG ECX
00a6328f : OR EAX,ECX
00a63291 : MOV ECX,dword ptr [0x01725270]
00a63297 : SHR ECX,0x3
00a6329a : AND ECX,0x1
00a6329d : SETZ DL
00a632a0 : PUSH EDX
00a632a1 : PUSH EBX
00a632a2 : PUSH 0xbf1a4b
00a632a7 : PUSH EAX
00a632a8 : CALL 0x006f0760
00a632ad : MOVZX ECX,word ptr [EBP + 0xfffffeec]
00a632b4 : ADD ECX,ECX
00a632b6 : ADD ECX,ECX
00a632b8 : PUSH ECX
00a632b9 : LEA EDX,[EBP + 0xfffffe84]
00a632bf : PUSH EDX
00a632c0 : PUSH EAX
00a632c1 : MOV dword ptr [EDI + 0x24],EAX
00a632c4 : CALL 0x0063ae40
00a632c9 : ADD ESP,0x1c
00a632cc : JMP 0x00a633bc
00a632d1 : MOV EAX,dword ptr [ESI]
00a632d3 : MOV EDX,dword ptr [EAX + 0xc]
00a632d6 : PUSH 0x1
00a632d8 : PUSH 0x2
00a632da : LEA ECX,[EBP + 0xfffffeec]
00a632e0 : PUSH ECX
00a632e1 : MOV ECX,ESI
00a632e3 : MOV dword ptr [EBP + 0xfffffeec],EBX
00a632e9 : CALL EDX
00a632eb : MOV EBX,dword ptr [EBP + 0xfffffeec]
00a632f1 : TEST BX,BX
00a632f4 : JBE 0x00a633ba
00a632fa : PUSH 0x100
00a632ff : LEA EAX,[EBP + 0xfffffef0]
00a63305 : PUSH 0x0
00a63307 : PUSH EAX
00a63308 : CALL 0x0063b700
00a6330d : MOV EDX,dword ptr [ESI]
00a6330f : MOV EDX,dword ptr [EDX + 0xc]
00a63312 : ADD ESP,0xc
00a63315 : MOVZX EAX,BX
00a63318 : PUSH EAX
00a63319 : PUSH 0x2
00a6331b : LEA ECX,[EBP + 0xfffffef0]
00a63321 : PUSH ECX
00a63322 : MOV ECX,ESI
00a63324 : CALL EDX
00a63326 : LEA EAX,[EBP + 0xfffffef0]
00a6332c : LEA EDX,[EAX + 0x2]
00a6332f : NOP
00a63330 : MOV CX,word ptr [EAX]
00a63333 : ADD EAX,0x2
00a63336 : TEST CX,CX
00a63339 : JNZ 0x00a63330
00a6333b : SUB EAX,EDX
00a6333d : SAR EAX,0x1
00a6333f : PUSH EAX
00a63340 : LEA EAX,[EBP + 0xfffffef0]
00a63346 : PUSH EAX
00a63347 : LEA ECX,[EDI + 0x4]
00a6334a : CALL 0x00406360
00a6334f : JMP 0x00a633ba
00a63351 : MOV ECX,dword ptr [0x01725270]
00a63357 : SHR ECX,0x3
00a6335a : MOV EDX,0x0
00a6335f : AND ECX,0x1
00a63362 : SETZ DL
00a63365 : PUSH EDX
00a63366 : PUSH EBX
00a63367 : PUSH 0xbf1a4a
00a6336c : PUSH 0x28
00a6336e : CALL 0x006f0760
00a63373 : ADD ESP,0x10
00a63376 : MOV dword ptr [EBP + 0xfffffee8],EAX
00a6337c : MOV dword ptr [EBP + -0x4],EBX
00a6337f : CMP EAX,EBX
00a63381 : JZ 0x00a6338d
00a63383 : PUSH EAX
00a63384 : CALL 0x004c4590
00a63389 : MOV EDI,EAX
00a6338b : JMP 0x00a6338f
00a6338d : XOR EDI,EDI
00a6338f : MOV dword ptr [EBP + -0x4],0xffffffff
00a63396 : MOV EAX,dword ptr [ESI]
00a63398 : MOV EDX,dword ptr [EAX + 0xc]
00a6339b : PUSH 0x1
00a6339d : PUSH 0x2
00a6339f : LEA ECX,[EBP + 0xfffffee0]
00a633a5 : PUSH ECX
00a633a6 : MOV ECX,ESI
00a633a8 : MOV dword ptr [EBP + 0xfffffee0],EBX
00a633ae : CALL EDX
00a633b0 : MOV AX,word ptr [EBP + 0xfffffee0]
00a633b7 : MOV word ptr [EDI],AX
00a633ba : XOR EBX,EBX
00a633bc : MOV EAX,dword ptr [EBP + 0xfffffee4]
00a633c2 : SUB EAX,dword ptr [EBP + 0xfffffed8]
00a633c8 : CMP EAX,EBX
00a633ca : MOV dword ptr [EBP + 0xfffffee4],EAX
00a633d0 : JG 0x00a631d5
00a633d6 : MOV EAX,EDI
00a633d8 : MOV ECX,dword ptr [EBP + -0xc]
00a633db : MOV dword ptr FS:[0x0],ECX
00a633e2 : POP ECX
00a633e3 : POP EDI
00a633e4 : POP EBX
00a633e5 : MOV ECX,dword ptr [EBP + -0x10]
00a633e8 : XOR ECX,EBP
00a633ea : CALL 0x00633e6b
00a633ef : MOV ESP,EBP
00a633f1 : POP EBP
00a633f2 : RET 0x4

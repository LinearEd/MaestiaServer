PROGRAM  : Maestia.exe
FUNCTION : FUN_00530a70
ENTRY    : 00530a70
BODY     : [[00530a70, 00530ba5]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00530a70(int *param_1,int *param_2,int *param_3,undefined1 param_4)

{
  char cVar1;
  char *pcVar2;
  uint uVar3;
  int *piVar4;
  int iVar5;
  char *pcVar6;
  int *piVar7;
  int local_28;
  undefined4 local_24;
  undefined4 local_20;
  int local_1c;
  int local_18;
  byte local_14;
  undefined1 local_10 [16];
  
  piVar4 = param_2;
  local_24 = *(undefined4 *)(*param_2 + 0x288);
  local_20 = FUN_00530910(7);
  iVar5 = *param_3;
  piVar7 = param_3;
  while (iVar5 != 0) {
    uVar3 = (uint)param_2 >> 8;
    param_2 = (int *)CONCAT31((int3)uVar3,param_4);
    param_3 = piVar7;
    iVar5 = FUN_00515840(0x34,0);
    if (iVar5 == 0) {
      local_1c = 0;
    }
    else {
      local_1c = FUN_00568920(piVar4,local_20,piVar7[1]);
    }
    local_14 = 0;
    local_18 = 0;
    FUN_00526210(&local_1c);
    pcVar2 = (char *)*piVar7;
    pcVar6 = pcVar2;
    do {
      cVar1 = *pcVar6;
      pcVar6 = pcVar6 + 1;
    } while (cVar1 != '\0');
    local_28 = FUN_00525380(pcVar2,(int)pcVar6 - (int)(pcVar2 + 1),0);
    *(int *)(local_28 + 8) = *(int *)(local_28 + 8) + 1;
    (**(code **)(*param_1 + 0x28))(piVar4,&local_28,local_10,&param_2);
    *(int *)(local_28 + 8) = *(int *)(local_28 + 8) + -1;
    if (*(int *)(local_28 + 8) == 0) {
      FUN_00525340();
    }
    FUN_00526bc0();
    if (((local_14 & 2) == 0) && (local_1c != 0)) {
      FUN_00503db0();
    }
    local_1c = 0;
    if (((local_14 & 1) == 0) && (local_18 != 0)) {
      FUN_00503db0();
    }
    piVar7 = param_3 + 2;
    local_18 = 0;
    iVar5 = *piVar7;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00530a70 : SUB ESP,0x28
00530a73 : PUSH EBP
00530a74 : MOV EBP,dword ptr [ESP + 0x34]
00530a78 : MOV ECX,dword ptr [EBP]
00530a7b : MOV EAX,dword ptr [ECX + 0x288]
00530a81 : PUSH ESI
00530a82 : PUSH 0x7
00530a84 : MOV dword ptr [ESP + 0x10],EAX
00530a88 : CALL 0x00530910
00530a8d : MOV ESI,dword ptr [ESP + 0x3c]
00530a91 : CMP dword ptr [ESI],0x0
00530a94 : MOV dword ptr [ESP + 0x10],EAX
00530a98 : JZ 0x00530ba0
00530a9e : PUSH EBX
00530a9f : MOV EBX,dword ptr [ESP + 0x38]
00530aa3 : PUSH EDI
00530aa4 : JMP 0x00530aaa
00530aa6 : MOV ESI,dword ptr [ESP + 0x44]
00530aaa : MOV CL,byte ptr [ESP + 0x48]
00530aae : PUSH 0x0
00530ab0 : MOV byte ptr [ESP + 0x44],CL
00530ab4 : MOV ECX,dword ptr [ESP + 0x18]
00530ab8 : PUSH 0x34
00530aba : CALL 0x00515840
00530abf : TEST EAX,EAX
00530ac1 : JZ 0x00530ad6
00530ac3 : MOV EDX,dword ptr [ESI + 0x4]
00530ac6 : MOV ECX,dword ptr [ESP + 0x18]
00530aca : PUSH EDX
00530acb : PUSH ECX
00530acc : PUSH EBP
00530acd : MOV ECX,EAX
00530acf : CALL 0x00568920
00530ad4 : JMP 0x00530ad8
00530ad6 : XOR EAX,EAX
00530ad8 : LEA EDX,[ESP + 0x1c]
00530adc : PUSH EDX
00530add : LEA ECX,[ESP + 0x2c]
00530ae1 : MOV byte ptr [ESP + 0x28],0x0
00530ae6 : MOV dword ptr [ESP + 0x20],EAX
00530aea : MOV dword ptr [ESP + 0x24],0x0
00530af2 : CALL 0x00526210
00530af7 : MOV ESI,dword ptr [ESI]
00530af9 : MOV ECX,dword ptr [EBP]
00530afc : MOV EAX,ESI
00530afe : ADD ECX,0x8
00530b01 : LEA EDI,[EAX + 0x1]
00530b04 : MOV DL,byte ptr [EAX]
00530b06 : INC EAX
00530b07 : TEST DL,DL
00530b09 : JNZ 0x00530b04
00530b0b : SUB EAX,EDI
00530b0d : XOR EDI,EDI
00530b0f : PUSH EDI
00530b10 : PUSH EAX
00530b11 : PUSH ESI
00530b12 : ADD ECX,0x24c
00530b18 : CALL 0x00525380
00530b1d : LEA ECX,[ESP + 0x40]
00530b21 : PUSH ECX
00530b22 : LEA EDX,[ESP + 0x2c]
00530b26 : PUSH EDX
00530b27 : MOV dword ptr [ESP + 0x18],EAX
00530b2b : INC dword ptr [EAX + 0x8]
00530b2e : MOV EAX,dword ptr [EBX]
00530b30 : MOV EDX,dword ptr [EAX + 0x28]
00530b33 : LEA ECX,[ESP + 0x18]
00530b37 : PUSH ECX
00530b38 : PUSH EBP
00530b39 : MOV ECX,EBX
00530b3b : CALL EDX
00530b3d : MOV EAX,dword ptr [ESP + 0x10]
00530b41 : DEC dword ptr [EAX + 0x8]
00530b44 : MOV ECX,EAX
00530b46 : ADD EAX,0x8
00530b49 : CMP dword ptr [EAX],EDI
00530b4b : JNZ 0x00530b52
00530b4d : CALL 0x00525340
00530b52 : LEA ECX,[ESP + 0x28]
00530b56 : CALL 0x00526bc0
00530b5b : TEST byte ptr [ESP + 0x24],0x2
00530b60 : JNZ 0x00530b6f
00530b62 : MOV ECX,dword ptr [ESP + 0x1c]
00530b66 : CMP ECX,EDI
00530b68 : JZ 0x00530b6f
00530b6a : CALL 0x00503db0
00530b6f : TEST byte ptr [ESP + 0x24],0x1
00530b74 : MOV dword ptr [ESP + 0x1c],EDI
00530b78 : JNZ 0x00530b87
00530b7a : MOV ECX,dword ptr [ESP + 0x20]
00530b7e : CMP ECX,EDI
00530b80 : JZ 0x00530b87
00530b82 : CALL 0x00503db0
00530b87 : MOV EAX,dword ptr [ESP + 0x44]
00530b8b : ADD EAX,0x8
00530b8e : MOV dword ptr [ESP + 0x20],EDI
00530b92 : MOV dword ptr [ESP + 0x44],EAX
00530b96 : CMP dword ptr [EAX],EDI
00530b98 : JNZ 0x00530aa6
00530b9e : POP EDI
00530b9f : POP EBX
00530ba0 : POP ESI
00530ba1 : POP EBP
00530ba2 : ADD ESP,0x28
00530ba5 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_007030d0
ENTRY    : 007030d0
BODY     : [[007030d0, 00703471]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_007030d0(short param_1,ushort param_2)

{
  int iVar1;
  byte bVar2;
  byte bVar3;
  int *piVar4;
  uint uVar5;
  uint in_EAX;
  int iVar6;
  uint uVar7;
  float10 fVar8;
  float fVar9;
  double dVar10;
  float fVar11;
  byte local_55;
  int local_48;
  float local_44;
  
  iVar6 = DAT_00d7c54c;
  FUN_004437f0();
  if (local_48 == *(int *)(iVar6 + 0x44)) {
    return 0;
  }
  piVar4 = *(int **)(local_48 + 0x10);
  if (piVar4 == (int *)0x0) {
    return 0;
  }
  switch(in_EAX >> 0x10 & 0xff) {
  case 0xb:
  case 0xc:
    switch((char)piVar4[0xa2]) {
    case '\x01':
    case '\x03':
    case '\x04':
    case '\x06':
    case '\a':
switchD_0070314b_caseD_1:
      break;
    case '\x02':
    case '\x05':
    case '\b':
      break;
    default:
      goto switchD_0070312c_caseD_d;
    }
    break;
  default:
    goto switchD_0070312c_caseD_d;
  case 0x1e:
    uVar5 = piVar4[99];
    if ((((((uVar5 & 0x10) == 0) && ((uVar5 & 0x200) == 0)) && ((uVar5 & 4) == 0)) &&
        (((uVar5 & 0x100) == 0 && (-1 < (char)uVar5)))) && ((uVar5 & 0x20) == 0)) {
      if ((uVar5 & 2) != 0) goto switchD_0070314b_caseD_1;
      if ((((uVar5 & 0x200000) == 0) && ((uVar5 & 0x2000000) == 0)) &&
         (((uVar5 & 0x100000) == 0 && (((uVar5 & 0x400000) == 0 && ((uVar5 & 0x800000) == 0)))))) {
        uVar5 = uVar5 & 0x1000000;
        goto joined_r0x0070323b;
      }
    }
    break;
  case 0x32:
    if ((piVar4[99] & 0x40U) == 0) {
      uVar5 = piVar4[99] & 8;
joined_r0x0070323b:
      if (uVar5 == 0) {
        return 0;
      }
    }
    break;
  case 0x74:
    if ((piVar4[0x12] & 0x8000U) == 0) {
      return 0;
    }
    if (*(short *)((int)piVar4 + 0x182) == 1) {
      return 1;
    }
  }
  uVar5 = piVar4[0x14];
  local_55 = 0;
  bVar2 = 0;
  iVar6 = (**(code **)(*piVar4 + 0x3c))();
  if (iVar6 != 0) {
    iVar6 = FUN_004049b0();
    if (iVar6 == 0) {
      return 0;
    }
    local_55 = *(byte *)(iVar6 + 0x18);
    bVar2 = *(byte *)(iVar6 + 0x19);
  }
  iVar6 = FUN_004049b0();
  if (iVar6 != 0) {
    iVar1 = *(byte *)(piVar4 + 0x10) - 0x28;
    uVar7 = iVar1 / 10;
    uVar7 = ((int)uVar7 < 0) - 1 & uVar7;
    if (0 < iVar1) {
      uVar7 = uVar7 + ((uint)*(byte *)(piVar4 + 0x10) % 10 != 0);
    }
    if (6 < (int)uVar7) {
      uVar7 = 6;
    }
    bVar3 = *(byte *)(uVar7 + 0x18 + iVar6);
    fVar9 = 1.0;
    if (local_55 == 0) {
      fVar11 = 1.0;
    }
    else {
      fVar11 = (float)local_55 * 0.01;
    }
    if (bVar2 != 0) {
      fVar9 = (float)bVar2 * 0.01;
    }
    if (1 < uVar5) {
      FUN_0041ebe0();
    }
    if (param_1 == 0) {
      local_44 = 0.0;
    }
    else {
      local_44 = fVar9;
      FUN_004134f0();
    }
    dVar10 = (double)((float)bVar3 * fVar11 * fVar9);
    FUN_00702a50(dVar10);
    fVar8 = (float10)FUN_00425240();
    return (int)ROUND((float10)param_2 + fVar8 + (float10)dVar10 + (float10)local_44) & 0xffff;
  }
switchD_0070312c_caseD_d:
  return 0;
}



============================================================
DISASSEMBLY
============================================================
007030d0 : PUSH EBP
007030d1 : MOV EBP,ESP
007030d3 : AND ESP,0xffffffc0
007030d6 : SUB ESP,0x34
007030d9 : PUSH EBX
007030da : PUSH ESI
007030db : MOV ESI,dword ptr [0x00d7c54c]
007030e1 : PUSH EDI
007030e2 : MOV EDI,EAX
007030e4 : LEA EAX,[ESP + 0x3c]
007030e8 : PUSH EAX
007030e9 : LEA ECX,[ESI + 0x40]
007030ec : LEA EAX,[ESP + 0x3c]
007030f0 : MOV dword ptr [ESP + 0x40],EDI
007030f4 : CALL 0x004437f0
007030f9 : MOV EAX,dword ptr [ESP + 0x38]
007030fd : CMP EAX,dword ptr [ESI + 0x44]
00703100 : JZ 0x00703469
00703106 : MOV ESI,dword ptr [EAX + 0x10]
00703109 : TEST ESI,ESI
0070310b : JZ 0x00703469
00703111 : MOV ECX,EDI
00703113 : SHR ECX,0x10
00703116 : MOVZX EAX,CL
00703119 : ADD EAX,-0xb
0070311c : CMP EAX,0x69
0070311f : JA 0x00703469
00703125 : MOVZX EDX,byte ptr [EAX + 0x703488]
0070312c : JMP dword ptr [EDX*0x4 + 0x703474]
00703133 : MOVZX EAX,byte ptr [ESI + 0x288]
0070313a : DEC EAX
0070313b : CMP EAX,0x7
0070313e : JA 0x00703469
00703144 : MOVZX EAX,byte ptr [EAX + 0x7034fc]
0070314b : JMP dword ptr [EAX*0x4 + 0x7034f4]
00703152 : MOV EBX,0x1
00703157 : JMP 0x00703276
0070315c : MOV EAX,dword ptr [ESI + 0x18c]
00703162 : TEST AL,0x10
00703164 : JZ 0x00703170
00703166 : MOV EBX,0x3
0070316b : JMP 0x00703276
00703170 : TEST EAX,0x200
00703175 : JZ 0x00703181
00703177 : MOV EBX,0x3
0070317c : JMP 0x00703276
00703181 : TEST AL,0x4
00703183 : JZ 0x0070318f
00703185 : MOV EBX,0x4
0070318a : JMP 0x00703276
0070318f : TEST EAX,0x100
00703194 : JZ 0x007031a0
00703196 : MOV EBX,0x4
0070319b : JMP 0x00703276
007031a0 : TEST AL,AL
007031a2 : JNS 0x007031ae
007031a4 : MOV EBX,0x4
007031a9 : JMP 0x00703276
007031ae : TEST AL,0x20
007031b0 : JZ 0x007031bc
007031b2 : MOV EBX,0x4
007031b7 : JMP 0x00703276
007031bc : TEST AL,0x2
007031be : JZ 0x007031ca
007031c0 : MOV EBX,0x2
007031c5 : JMP 0x00703276
007031ca : TEST EAX,0x200000
007031cf : JZ 0x007031db
007031d1 : MOV EBX,0x3
007031d6 : JMP 0x00703276
007031db : TEST EAX,0x2000000
007031e0 : JZ 0x007031ec
007031e2 : MOV EBX,0x3
007031e7 : JMP 0x00703276
007031ec : TEST EAX,0x100000
007031f1 : JZ 0x007031fa
007031f3 : MOV EBX,0x4
007031f8 : JMP 0x00703276
007031fa : TEST EAX,0x400000
007031ff : JZ 0x00703208
00703201 : MOV EBX,0x4
00703206 : JMP 0x00703276
00703208 : TEST EAX,0x800000
0070320d : JZ 0x00703216
0070320f : MOV EBX,0x4
00703214 : JMP 0x00703276
00703216 : TEST EAX,0x1000000
0070321b : JZ 0x00703469
00703221 : MOV EBX,0x4
00703226 : JMP 0x00703276
00703228 : MOV EAX,dword ptr [ESI + 0x18c]
0070322e : TEST AL,0x40
00703230 : JZ 0x00703239
00703232 : MOV EBX,0x4
00703237 : JMP 0x00703276
00703239 : TEST AL,0x8
0070323b : JZ 0x00703469
00703241 : MOV EBX,0x4
00703246 : JMP 0x00703276
00703248 : MOV EAX,dword ptr [ESI + 0x48]
0070324b : AND EAX,0x8000
00703250 : XOR ECX,ECX
00703252 : OR EAX,ECX
00703254 : JZ 0x00703469
0070325a : MOV ECX,0x1
0070325f : CMP CX,word ptr [ESI + 0x182]
00703266 : JNZ 0x00703271
00703268 : MOV EAX,ECX
0070326a : POP EDI
0070326b : POP ESI
0070326c : POP EBX
0070326d : MOV ESP,EBP
0070326f : POP EBP
00703270 : RET
00703271 : MOV EBX,0x5
00703276 : MOV EDX,dword ptr [ESI + 0x50]
00703279 : MOV EAX,dword ptr [ESI]
0070327b : MOV dword ptr [ESP + 0x38],EDX
0070327f : MOV EDX,dword ptr [EAX + 0x3c]
00703282 : MOV ECX,ESI
00703284 : MOV byte ptr [ESP + 0x2b],0x0
00703289 : MOV byte ptr [ESP + 0x2c],0x0
0070328e : CALL EDX
00703290 : TEST EAX,EAX
00703292 : JZ 0x007032cb
00703294 : MOVZX EDX,byte ptr [ESP + 0x38]
00703299 : MOVZX AX,BL
0070329d : SHL AX,0x8
007032a1 : MOVZX ECX,AX
007032a4 : OR ECX,EDX
007032a6 : OR ECX,0xaa000000
007032ac : PUSH ECX
007032ad : CALL 0x004049b0
007032b2 : ADD ESP,0x4
007032b5 : TEST EAX,EAX
007032b7 : JZ 0x00703469
007032bd : MOV CL,byte ptr [EAX + 0x18]
007032c0 : MOV DL,byte ptr [EAX + 0x19]
007032c3 : MOV byte ptr [ESP + 0x2b],CL
007032c7 : MOV byte ptr [ESP + 0x2c],DL
007032cb : MOVZX EAX,BX
007032ce : OR EAX,0xa9000000
007032d3 : PUSH EAX
007032d4 : CALL 0x004049b0
007032d9 : MOV EBX,EAX
007032db : ADD ESP,0x4
007032de : TEST EBX,EBX
007032e0 : JZ 0x00703469
007032e6 : MOVZX EDI,byte ptr [ESI + 0x40]
007032ea : LEA ECX,[EDI + -0x28]
007032ed : MOV EAX,0x66666667
007032f2 : IMUL ECX
007032f4 : SAR EDX,0x2
007032f7 : MOV EAX,EDX
007032f9 : SHR EAX,0x1f
007032fc : ADD EAX,EDX
007032fe : MOV EDX,0x0
00703303 : SETS DL
00703306 : DEC EDX
00703307 : AND EDX,EAX
00703309 : MOV ESI,EDX
0070330b : TEST ECX,ECX
0070330d : JLE 0x00703321
0070330f : MOV EAX,EDI
00703311 : CDQ
00703312 : MOV ECX,0xa
00703317 : IDIV ECX
00703319 : NEG EDX
0070331b : SBB EDX,EDX
0070331d : NEG EDX
0070331f : ADD ESI,EDX
00703321 : CMP ESI,0x6
00703324 : JLE 0x0070332b
00703326 : MOV ESI,0x6
0070332b : MOV AL,byte ptr [ESP + 0x2b]
0070332f : MOVZX ESI,byte ptr [ESI + EBX*0x1 + 0x18]
00703334 : MOVSS XMM0,dword ptr [0x00c10fc4]
0070333c : MOVSS XMM2,dword ptr [0x00cdf23c]
00703344 : TEST AL,AL
00703346 : JZ 0x00703355
00703348 : MOVZX EDX,AL
0070334b : CVTSI2SS XMM1,EDX
0070334f : MULSS XMM1,XMM2
00703353 : JMP 0x00703358
00703355 : MOVAPS XMM1,XMM0
00703358 : MOV AL,byte ptr [ESP + 0x2c]
0070335c : MOVSS dword ptr [ESP + 0x30],XMM1
00703362 : TEST AL,AL
00703364 : JZ 0x00703371
00703366 : MOVZX EAX,AL
00703369 : CVTSI2SS XMM0,EAX
0070336d : MULSS XMM0,XMM2
00703371 : CMP dword ptr [ESP + 0x38],0x2
00703376 : MOVSS dword ptr [ESP + 0x2c],XMM0
0070337c : JC 0x007033ad
0070337e : CVTSI2SS XMM0,EDI
00703382 : MULSS XMM0,dword ptr [0x00cdf0f0]
0070338a : CALL 0x0041ebe0
0070338f : FMUL float ptr [0x00c18874]
00703395 : MOVSS XMM1,dword ptr [ESP + 0x30]
0070339b : MOVSS XMM0,dword ptr [ESP + 0x2c]
007033a1 : FMUL float ptr [0x00cdf23c]
007033a7 : FSTP float ptr [ESP + 0x38]
007033ab : JMP 0x007033b6
007033ad : XORPS XMM2,XMM2
007033b0 : MOVSS dword ptr [ESP + 0x38],XMM2
007033b6 : MOV AX,word ptr [EBP + 0x8]
007033ba : TEST AX,AX
007033bd : JZ 0x007033e3
007033bf : MOVSS XMM1,dword ptr [0x00cdf19c]
007033c7 : MOVZX ECX,AX
007033ca : CALL 0x004134f0
007033cf : MOVSS XMM1,dword ptr [ESP + 0x30]
007033d5 : MOVSS dword ptr [ESP + 0x3c],XMM0
007033db : MOVSS XMM0,dword ptr [ESP + 0x2c]
007033e1 : JMP 0x007033ec
007033e3 : XORPS XMM2,XMM2
007033e6 : MOVSS dword ptr [ESP + 0x3c],XMM2
007033ec : CVTSI2SS XMM2,ESI
007033f0 : MULSS XMM2,XMM1
007033f4 : MULSS XMM2,XMM0
007033f8 : SUB ESP,0x8
007033fb : CVTSS2SD XMM0,XMM2
007033ff : MOVSD qword ptr [ESP],XMM0
00703404 : CALL 0x00702a50
00703409 : MOVSD qword ptr [ESP + 0x38],XMM0
0070340f : FLD double ptr [ESP + 0x38]
00703413 : ADD ESP,0x4
00703416 : FSTP double ptr [ESP + 0x34]
0070341a : FLD float ptr [ESP + 0x3c]
0070341e : FSTP float ptr [ESP]
00703421 : CALL 0x00425240
00703426 : FADD double ptr [ESP + 0x34]
0070342a : MOVZX ECX,word ptr [EBP + 0xc]
0070342e : FNSTCW word ptr [ESP + 0x30]
00703432 : MOVZX EAX,word ptr [ESP + 0x30]
00703437 : FADD float ptr [ESP + 0x40]
0070343b : MOV dword ptr [ESP + 0x40],ECX
0070343f : ADD ESP,0x4
00703442 : FILD dword ptr [ESP + 0x3c]
00703446 : OR EAX,0xc00
0070344b : MOV dword ptr [ESP + 0x3c],EAX
0070344f : FADDP
00703451 : FLDCW word ptr [ESP + 0x3c]
00703455 : FISTP dword ptr [ESP + 0x3c]
00703459 : MOV AX,word ptr [ESP + 0x3c]
0070345e : FLDCW word ptr [ESP + 0x2c]
00703462 : POP EDI
00703463 : POP ESI
00703464 : POP EBX
00703465 : MOV ESP,EBP
00703467 : POP EBP
00703468 : RET
00703469 : POP EDI
0070346a : POP ESI
0070346b : XOR EAX,EAX
0070346d : POP EBX
0070346e : MOV ESP,EBP
00703470 : POP EBP
00703471 : RET

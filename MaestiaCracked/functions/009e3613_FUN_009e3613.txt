PROGRAM  : Maestia.exe
FUNCTION : FUN_009e3613
ENTRY    : 009e3613
BODY     : [[009e3613, 009e3646] [009e36f8, 009e3720]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x009e3254) */

void FUN_009e3613(void)

{
  undefined4 uVar1;
  uint uVar2;
  undefined4 *puVar3;
  int *piVar4;
  int iVar5;
  undefined4 uVar6;
  int iVar7;
  undefined4 *puVar8;
  int *piVar9;
  uint uVar10;
  uint unaff_EBP;
  int iVar11;
  
  do {
    *(undefined4 *)(unaff_EBP - 4) = 0xffffffff;
    if (7 < *(uint *)(unaff_EBP - 0x1c)) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    *(undefined4 *)(unaff_EBP - 0x1c) = 7;
    *(undefined4 *)(unaff_EBP - 0x20) = 0;
    *(undefined2 *)(unaff_EBP - 0x30) = 0;
    *(int *)(unaff_EBP - 0x54) = *(int *)(unaff_EBP - 0x54) + 1;
    iVar5 = *(int *)(unaff_EBP - 0x54);
    while( true ) {
      if (0xfffe < iVar5) {
        ExceptionList = *(void **)(unaff_EBP - 0xc);
        __security_check_cookie(*(uint *)(unaff_EBP - 0x18) ^ unaff_EBP);
        return;
      }
      piVar4 = (int *)FUN_00703c00(0x600);
      if ((piVar4 != (int *)0x0) && (*(char *)((int)piVar4 + 5) == '\x06')) break;
      *(int *)(unaff_EBP - 0x54) = *(int *)(unaff_EBP - 0x54) + 1;
      iVar5 = *(int *)(unaff_EBP - 0x54);
    }
    FUN_0040eef0(piVar4 + 6);
    *(undefined4 *)(unaff_EBP - 4) = 0;
    FUN_00824120(DAT_0172491c);
    *(undefined1 *)(unaff_EBP - 4) = 2;
    if (7 < *(uint *)(unaff_EBP - 0xc0)) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    *(undefined4 *)(unaff_EBP - 0xc0) = 7;
    iVar11 = 0;
    *(undefined4 *)(unaff_EBP - 0xc4) = 0;
    *(undefined2 *)(unaff_EBP - 0xd4) = 0;
    *(undefined4 *)(unaff_EBP - 0x44) = 0;
    *(undefined4 *)(unaff_EBP - 0x40) = 0;
    *(undefined1 *)(unaff_EBP - 4) = 3;
    iVar5 = FUN_006f0300(0x30);
    *(int *)(unaff_EBP - 0x50) = iVar5;
    *(undefined1 *)(unaff_EBP - 4) = 4;
    if (iVar5 == 0) {
      uVar6 = 0;
    }
    else {
      uVar6 = FUN_004191e0(iVar5,*(undefined2 *)((int)piVar4 + 6),unaff_EBP - 0x34);
    }
    *(undefined1 *)(unaff_EBP - 4) = 3;
    *(undefined4 *)(unaff_EBP - 0x44) = uVar6;
    iVar5 = FUN_006f0300(0x30);
    *(int *)(unaff_EBP - 0x50) = iVar5;
    *(undefined1 *)(unaff_EBP - 4) = 5;
    if (iVar5 != 0) {
      iVar11 = FUN_004191e0(iVar5,*(undefined2 *)((int)piVar4 + 6),unaff_EBP - 0x34);
    }
    *(undefined1 *)(unaff_EBP - 4) = 3;
    *(int *)(unaff_EBP - 0x40) = iVar11;
    *(undefined4 *)(unaff_EBP - 4) = 2;
    *(uint *)(unaff_EBP - 0x58) = (uint)*(ushort *)(piVar4 + 1);
    iVar5 = **(int **)(*(int *)(unaff_EBP - 0x3c) + 0x68);
    *(int *)(unaff_EBP - 0x50) = iVar5;
    iVar7 = (**(code **)(*piVar4 + 0x3c))();
    if (iVar7 != 0) {
      iVar7 = (**(code **)(*piVar4 + 0x68))();
      if (iVar7 == 0) {
        uVar10 = piVar4[99];
        if (((uVar10 >> 6 & 1) == 0) && ((uVar10 >> 10 & 1) == 0)) {
          if ((((((uVar10 >> 0xe & 1) == 0) && ((uVar10 >> 0xf & 1) == 0)) &&
               ((uVar10 >> 0x10 & 1) == 0)) &&
              (((uVar10 >> 0x11 & 1) == 0 && ((uVar10 >> 0x12 & 1) == 0)))) &&
             ((uVar10 >> 0x13 & 1) == 0)) {
            uVar10 = FUN_006fec70();
            *(uint *)(iVar11 + 0x28) = uVar10 & 0xff;
          }
          else {
            *(undefined4 *)(unaff_EBP - 0x58) = 0x8c;
            *(undefined4 *)(iVar11 + 0x28) = 0xe;
          }
        }
        else {
          *(undefined4 *)(iVar11 + 0x28) = 6;
        }
      }
      else {
        *(uint *)(iVar11 + 0x24) = (uint)*(byte *)(piVar4 + 0xa2);
      }
    }
    iVar11 = *(int *)(unaff_EBP - 0x40);
    if (iVar5 != *(int *)(*(int *)(unaff_EBP - 0x3c) + 0x68)) {
      do {
        if ((*(short *)(unaff_EBP - 0x58) == *(short *)(iVar5 + 0x10)) &&
           (((iVar7 = (**(code **)(*piVar4 + 0x3c))(), iVar7 == 0 ||
             ((*(int *)(iVar11 + 0x24) != -1 && (*(int *)(iVar5 + 0x14) == *(int *)(iVar11 + 0x24)))
             )) || ((*(int *)(iVar11 + 0x28) != -1 &&
                    (*(int *)(iVar5 + 0x18) == *(int *)(iVar11 + 0x28))))))) {
          uVar10 = (uint)*(ushort *)(iVar5 + 0xc);
          *(uint *)(unaff_EBP - 0x48) = uVar10;
          goto LAB_009e3257;
        }
        FUN_004192a0();
        iVar5 = *(int *)(unaff_EBP - 0x50);
      } while (iVar5 != *(int *)(*(int *)(unaff_EBP - 0x3c) + 0x68));
    }
    uVar6 = *(undefined4 *)(iVar11 + 0x28);
    uVar1 = *(undefined4 *)(iVar11 + 0x24);
    *(undefined2 *)(unaff_EBP - 0xa8) = *(undefined2 *)(unaff_EBP - 0x58);
    *(undefined4 *)(unaff_EBP - 0xa4) = uVar1;
    uVar2 = *(uint *)(unaff_EBP - 100);
    uVar10 = uVar2 & 0xffff;
    *(uint *)(unaff_EBP - 0x48) = uVar10;
    *(uint *)(unaff_EBP - 100) = uVar2 + 1;
    *(short *)(unaff_EBP - 0x98) = (short)uVar2;
    *(undefined8 *)(unaff_EBP - 0x94) = *(undefined8 *)(unaff_EBP - 0xa8);
    *(undefined4 *)(unaff_EBP - 0x8c) = uVar6;
    FUN_00414ca0(unaff_EBP - 0xe0,unaff_EBP - 0x98);
LAB_009e3257:
    iVar5 = *(int *)(unaff_EBP - 0x3c);
    FUN_00413b60(unaff_EBP - 0x48);
    if (*(int *)(unaff_EBP - 0x4c) == *(int *)(iVar5 + 0x20)) {
      *(undefined4 *)(unaff_EBP - 0x5c) = 0;
      *(undefined1 *)(unaff_EBP - 4) = 8;
      iVar5 = FUN_006f0300(0x10);
      *(int *)(unaff_EBP - 0x38) = iVar5;
      *(undefined1 *)(unaff_EBP - 4) = 9;
      if (iVar5 == 0) {
        iVar5 = 0;
      }
      else {
        *(undefined4 *)(iVar5 + 4) = 0;
        *(undefined4 *)(iVar5 + 8) = 0;
        *(undefined4 *)(iVar5 + 0xc) = 0;
      }
      *(undefined1 *)(unaff_EBP - 4) = 8;
      *(int *)(unaff_EBP - 0x5c) = iVar5;
      *(undefined4 *)(unaff_EBP - 4) = 2;
      iVar11 = *(int *)(iVar5 + 4);
      if ((iVar11 == 0) ||
         ((uint)(*(int *)(iVar5 + 0xc) - iVar11 >> 2) <= (uint)(*(int *)(iVar5 + 8) - iVar11 >> 2)))
      {
        FUN_0042fe80(iVar5,*(undefined4 *)(iVar5 + 8),unaff_EBP - 0x44);
      }
      else {
        puVar3 = *(undefined4 **)(iVar5 + 8);
        iVar11 = 1;
        uVar6 = *(undefined4 *)(unaff_EBP - 0x44);
        puVar8 = puVar3;
        do {
          *puVar8 = uVar6;
          iVar11 = iVar11 + -1;
          puVar8 = puVar8 + 1;
        } while (iVar11 != 0);
        *(undefined4 **)(iVar5 + 8) = puVar3 + 1;
      }
      *(short *)(unaff_EBP - 0x6c) = (short)uVar10;
      *(int *)(unaff_EBP - 0x68) = iVar5;
      FUN_0041ed30(unaff_EBP - 0xe8,unaff_EBP - 0x6c);
      FUN_009e3416();
      return;
    }
    iVar5 = *(int *)(*(int *)(unaff_EBP - 0x4c) + 0x10);
    if (iVar5 != 0) {
      puVar3 = *(undefined4 **)(iVar5 + 8);
      iVar11 = *(int *)(iVar5 + 4);
      if ((iVar11 != 0) &&
         ((uint)((int)puVar3 - iVar11 >> 2) < (uint)(*(int *)(iVar5 + 0xc) - iVar11 >> 2))) {
        iVar11 = 1;
        uVar6 = *(undefined4 *)(unaff_EBP - 0x44);
        puVar8 = puVar3;
        do {
          *puVar8 = uVar6;
          iVar11 = iVar11 + -1;
          puVar8 = puVar8 + 1;
        } while (iVar11 != 0);
        *(undefined4 **)(iVar5 + 8) = puVar3 + 1;
        FUN_009e3416();
        return;
      }
      FUN_0042fe80(iVar5,puVar3,unaff_EBP - 0x44);
      FUN_009e3416();
      return;
    }
    if (*(int *)(unaff_EBP - 0x44) != 0) {
      FUN_00414770(*(int *)(unaff_EBP - 0x44));
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    *(undefined4 *)(unaff_EBP - 0x4c) = 0;
    iVar5 = *(int *)(unaff_EBP - 0x3c);
    piVar4 = (int *)FUN_00413b60(unaff_EBP - 0x4c);
    iVar7 = *piVar4;
    *(int *)(unaff_EBP - 0x4c) = iVar7;
    if (iVar7 == *(int *)(iVar5 + 0x20)) {
      *(undefined4 *)(unaff_EBP - 0x60) = 0;
      *(undefined1 *)(unaff_EBP - 4) = 0xc;
      iVar5 = FUN_006f0300(0x10);
      *(int *)(unaff_EBP - 0x38) = iVar5;
      *(undefined1 *)(unaff_EBP - 4) = 0xd;
      if (iVar5 == 0) {
        iVar5 = 0;
      }
      else {
        *(undefined4 *)(iVar5 + 4) = 0;
        *(undefined4 *)(iVar5 + 8) = 0;
        *(undefined4 *)(iVar5 + 0xc) = 0;
      }
      *(undefined1 *)(unaff_EBP - 4) = 0xc;
      *(int *)(unaff_EBP - 0x60) = iVar5;
      *(undefined4 *)(unaff_EBP - 4) = 2;
      iVar7 = *(int *)(iVar5 + 4);
      if ((iVar7 == 0) ||
         ((uint)(*(int *)(iVar5 + 0xc) - iVar7 >> 2) <= (uint)(*(int *)(iVar5 + 8) - iVar7 >> 2))) {
        FUN_0042fe80(iVar5,*(undefined4 *)(iVar5 + 8),unaff_EBP - 0x40);
      }
      else {
        piVar4 = *(int **)(iVar5 + 8);
        iVar7 = 1;
        piVar9 = piVar4;
        do {
          *piVar9 = iVar11;
          iVar7 = iVar7 + -1;
          piVar9 = piVar9 + 1;
        } while (iVar7 != 0);
        *(int **)(iVar5 + 8) = piVar4 + 1;
      }
      *(undefined2 *)(unaff_EBP - 0x74) = 0;
      *(int *)(unaff_EBP - 0x70) = iVar5;
      FUN_0041ed30(unaff_EBP - 0xf8,unaff_EBP - 0x74);
      *(undefined2 *)(unaff_EBP - 0x84) = 0;
      *(undefined4 *)(unaff_EBP - 0x80) = 0xffffffff;
      *(undefined2 *)(unaff_EBP - 0xbc) = 0;
      *(undefined8 *)(unaff_EBP - 0xb8) = *(undefined8 *)(unaff_EBP - 0x84);
      *(undefined4 *)(unaff_EBP - 0xb0) = 0xffffffff;
      FUN_00414ca0(unaff_EBP - 0xf0,unaff_EBP - 0xbc);
      FUN_009e3613();
      return;
    }
    iVar5 = *(int *)(iVar7 + 0x10);
    if (iVar5 != 0) {
      piVar4 = *(int **)(iVar5 + 8);
      iVar7 = *(int *)(iVar5 + 4);
      if ((iVar7 != 0) &&
         ((uint)((int)piVar4 - iVar7 >> 2) < (uint)(*(int *)(iVar5 + 0xc) - iVar7 >> 2))) {
        iVar7 = 1;
        piVar9 = piVar4;
        do {
          *piVar9 = iVar11;
          iVar7 = iVar7 + -1;
          piVar9 = piVar9 + 1;
        } while (iVar7 != 0);
        *(int **)(iVar5 + 8) = piVar4 + 1;
        FUN_009e3613();
        return;
      }
      FUN_0042fe80(iVar5,piVar4,unaff_EBP - 0x40);
      FUN_009e3613();
      return;
    }
    if (iVar11 != 0) {
      FUN_00414770(iVar11);
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
009e3613 : MOV dword ptr [EBP + -0x4],0xffffffff
009e361a : CMP dword ptr [EBP + -0x1c],0x8
009e361e : JC 0x009e3628
009e3620 : MOV ECX,dword ptr [EBP + -0x30]
009e3623 : CALL 0x006f04e0
009e3628 : MOV dword ptr [EBP + -0x1c],0x7
009e362f : MOV dword ptr [EBP + -0x20],0x0
009e3636 : XOR ECX,ECX
009e3638 : MOV word ptr [EBP + -0x30],CX
009e363c : INC dword ptr [EBP + -0x54]
009e363f : MOV EDI,dword ptr [EBP + -0x54]
009e3642 : JMP 0x009e2fe3
009e36f8 : INC dword ptr [EBP + -0x54]
009e36fb : MOV EDI,dword ptr [EBP + -0x54]
009e36fe : JMP 0x009e2fe3
009e3703 : MOV ECX,dword ptr [EBP + -0xc]
009e3706 : MOV dword ptr FS:[0x0],ECX
009e370d : POP ECX
009e370e : POP EDI
009e370f : POP ESI
009e3710 : POP EBX
009e3711 : MOV ECX,dword ptr [EBP + -0x18]
009e3714 : XOR ECX,EBP
009e3716 : CALL 0x00633e6b
009e371b : MOV ESP,EBP
009e371d : POP EBP
009e371e : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_00551c10
ENTRY    : 00551c10
BODY     : [[00551c10, 00551e0c]]

============================================================
DECOMPILED C CODE
============================================================

undefined1 FUN_00551c10(int param_1,int param_2,int *param_3,undefined1 *param_4,char param_5)

{
  int *piVar1;
  undefined1 *puVar2;
  char cVar3;
  undefined1 uVar4;
  int in_ECX;
  uint unaff_EBX;
  int unaff_EBP;
  int unaff_ESI;
  int local_38;
  int local_34;
  byte local_30;
  int local_2c;
  int local_28;
  byte local_24;
  undefined1 local_20;
  undefined1 local_1f;
  char local_10 [16];
  
  piVar1 = param_3;
  local_20 = 0;
  local_1f = 0;
  local_10[0] = '\n';
  if (*(byte *)(param_2 + 4) < 7) {
    if (*(int *)(*param_3 + 4) == 0) {
      FUN_00525a80();
    }
    cVar3 = FUN_005508a0(&param_3,&local_20);
  }
  else {
    cVar3 = FUN_00550820(param_3,&local_20);
  }
  if (cVar3 != '\0') {
    FUN_005268b0(&local_20);
  }
  if (local_10[0] == '\n') {
    local_30 = 0;
    local_38 = 0;
    local_34 = 0;
    if (param_5 == '\0') {
      local_2c = *(int *)(in_ECX + 4);
      local_24 = 0;
      if (local_2c != 0) {
        *(int *)(local_2c + 8) = *(int *)(local_2c + 8) + 1;
        *(uint *)(local_2c + 8) = *(uint *)(local_2c + 8) & 0x8fffffff;
      }
      local_28 = 0;
      if (*(int *)(in_ECX + 8) != 0) {
        FUN_005686c0(*(int *)(in_ECX + 8),*(byte *)(in_ECX + 0xc) & 1);
      }
      FUN_00568a50(&local_2c);
      if (((local_24 & 2) == 0) && (local_2c != 0)) {
        FUN_00503db0();
      }
      local_2c = 0;
      if (((local_24 & 1) == 0) && (local_28 != 0)) {
        FUN_00503db0();
      }
    }
    else {
      FUN_00568a50(in_ECX + 0x10);
    }
    puVar2 = param_4;
    if (local_38 == 0) {
      FUN_00526400();
      *puVar2 = 0;
      if (*(int *)(param_1 + 0x14) != 0) {
        uVar4 = (**(code **)(*(int *)(*(int *)(param_1 + 0x14) + 0x10) + 0x2c))
                          (param_2,piVar1,puVar2);
        if (((unaff_EBX & 2) == 0) && (unaff_ESI != 0)) {
          FUN_00503db0();
        }
        if (((unaff_EBX & 1) == 0) && (unaff_EBP != 0)) {
          FUN_00503db0();
        }
        FUN_00526bc0();
        FUN_00526bc0();
        return uVar4;
      }
    }
    else {
      FUN_00526cd0(&local_38);
    }
    if (((local_30 & 2) == 0) && (local_38 != 0)) {
      FUN_00503db0();
    }
    local_38 = 0;
    if (((local_30 & 1) == 0) && (local_34 != 0)) {
      FUN_00503db0();
    }
  }
  else {
    FUN_005268b0(local_10);
  }
  FUN_00526bc0();
  FUN_00526bc0();
  return 1;
}



============================================================
DISASSEMBLY
============================================================
00551c10 : SUB ESP,0x38
00551c13 : MOV EAX,dword ptr [ESP + 0x40]
00551c17 : PUSH EBX
00551c18 : PUSH EBP
00551c19 : MOV EBP,dword ptr [ESP + 0x4c]
00551c1d : PUSH ESI
00551c1e : MOV ESI,dword ptr [ESP + 0x48]
00551c22 : MOV BL,0xa
00551c24 : ADD ESI,0x18
00551c27 : CMP byte ptr [EAX + 0x4],0x6
00551c2b : PUSH EDI
00551c2c : MOV EDI,ECX
00551c2e : MOV byte ptr [ESP + 0x28],0x0
00551c33 : MOV byte ptr [ESP + 0x29],0x0
00551c38 : MOV byte ptr [ESP + 0x38],BL
00551c3c : JBE 0x00551c4d
00551c3e : LEA ECX,[ESP + 0x28]
00551c42 : PUSH ECX
00551c43 : PUSH EBP
00551c44 : MOV ECX,ESI
00551c46 : CALL 0x00550820
00551c4b : JMP 0x00551c70
00551c4d : MOV ECX,dword ptr [EBP]
00551c50 : CMP dword ptr [ECX + 0x4],0x0
00551c54 : MOV dword ptr [ESP + 0x54],EBP
00551c58 : JNZ 0x00551c5f
00551c5a : CALL 0x00525a80
00551c5f : LEA EDX,[ESP + 0x28]
00551c63 : PUSH EDX
00551c64 : LEA EAX,[ESP + 0x58]
00551c68 : PUSH EAX
00551c69 : MOV ECX,ESI
00551c6b : CALL 0x005508a0
00551c70 : TEST AL,AL
00551c72 : JZ 0x00551c82
00551c74 : LEA ECX,[ESP + 0x28]
00551c78 : PUSH ECX
00551c79 : LEA ECX,[ESP + 0x3c]
00551c7d : CALL 0x005268b0
00551c82 : CMP byte ptr [ESP + 0x38],BL
00551c86 : JZ 0x00551c9b
00551c88 : MOV ECX,dword ptr [ESP + 0x58]
00551c8c : LEA EDX,[ESP + 0x38]
00551c90 : PUSH EDX
00551c91 : CALL 0x005268b0
00551c96 : JMP 0x00551def
00551c9b : XOR EBX,EBX
00551c9d : MOV byte ptr [ESP + 0x18],0x0
00551ca2 : MOV dword ptr [ESP + 0x10],EBX
00551ca6 : MOV dword ptr [ESP + 0x14],EBX
00551caa : CMP byte ptr [ESP + 0x5c],BL
00551cae : JZ 0x00551cbf
00551cb0 : ADD EDI,0x10
00551cb3 : PUSH EDI
00551cb4 : LEA ECX,[ESP + 0x14]
00551cb8 : CALL 0x00568a50
00551cbd : JMP 0x00551d33
00551cbf : MOV EAX,dword ptr [EDI + 0x4]
00551cc2 : MOV byte ptr [ESP + 0x24],BL
00551cc6 : MOV dword ptr [ESP + 0x1c],EAX
00551cca : CMP EAX,EBX
00551ccc : JZ 0x00551cda
00551cce : INC dword ptr [EAX + 0x8]
00551cd1 : ADD EAX,0x8
00551cd4 : AND dword ptr [EAX],0x8fffffff
00551cda : MOV EAX,dword ptr [EDI + 0x8]
00551cdd : MOV dword ptr [ESP + 0x20],EBX
00551ce1 : CMP EAX,EBX
00551ce3 : JZ 0x00551cf9
00551ce5 : MOV CL,byte ptr [EDI + 0xc]
00551ce8 : AND CL,0x1
00551ceb : MOVZX EDX,CL
00551cee : PUSH EDX
00551cef : PUSH EAX
00551cf0 : LEA ECX,[ESP + 0x24]
00551cf4 : CALL 0x005686c0
00551cf9 : LEA EAX,[ESP + 0x1c]
00551cfd : PUSH EAX
00551cfe : LEA ECX,[ESP + 0x14]
00551d02 : CALL 0x00568a50
00551d07 : TEST byte ptr [ESP + 0x24],0x2
00551d0c : JNZ 0x00551d1b
00551d0e : MOV ECX,dword ptr [ESP + 0x1c]
00551d12 : CMP ECX,EBX
00551d14 : JZ 0x00551d1b
00551d16 : CALL 0x00503db0
00551d1b : TEST byte ptr [ESP + 0x24],0x1
00551d20 : MOV dword ptr [ESP + 0x1c],EBX
00551d24 : JNZ 0x00551d33
00551d26 : MOV ECX,dword ptr [ESP + 0x20]
00551d2a : CMP ECX,EBX
00551d2c : JZ 0x00551d33
00551d2e : CALL 0x00503db0
00551d33 : CMP dword ptr [ESP + 0x10],EBX
00551d37 : JNZ 0x00551db5
00551d39 : MOV ESI,dword ptr [ESP + 0x58]
00551d3d : MOV ECX,ESI
00551d3f : CALL 0x00526400
00551d44 : MOV ECX,dword ptr [ESP + 0x4c]
00551d48 : MOV byte ptr [ESI],BL
00551d4a : MOV EAX,dword ptr [ECX + 0x14]
00551d4d : CMP EAX,EBX
00551d4f : JZ 0x00551dc3
00551d51 : MOV EDX,dword ptr [EAX + 0x10]
00551d54 : MOV EDX,dword ptr [EDX + 0x2c]
00551d57 : LEA ECX,[EAX + 0x10]
00551d5a : MOV EAX,dword ptr [ESP + 0x50]
00551d5e : PUSH ESI
00551d5f : PUSH EBP
00551d60 : PUSH EAX
00551d61 : CALL EDX
00551d63 : TEST byte ptr [ESP + 0x18],0x2
00551d68 : MOV BL,AL
00551d6a : JNZ 0x00551d79
00551d6c : MOV ECX,dword ptr [ESP + 0x10]
00551d70 : TEST ECX,ECX
00551d72 : JZ 0x00551d79
00551d74 : CALL 0x00503db0
00551d79 : XOR ESI,ESI
00551d7b : TEST byte ptr [ESP + 0x18],0x1
00551d80 : MOV dword ptr [ESP + 0x10],ESI
00551d84 : JNZ 0x00551d93
00551d86 : MOV ECX,dword ptr [ESP + 0x14]
00551d8a : CMP ECX,ESI
00551d8c : JZ 0x00551d93
00551d8e : CALL 0x00503db0
00551d93 : LEA ECX,[ESP + 0x38]
00551d97 : MOV dword ptr [ESP + 0x14],ESI
00551d9b : CALL 0x00526bc0
00551da0 : LEA ECX,[ESP + 0x28]
00551da4 : CALL 0x00526bc0
00551da9 : POP EDI
00551daa : POP ESI
00551dab : POP EBP
00551dac : MOV AL,BL
00551dae : POP EBX
00551daf : ADD ESP,0x38
00551db2 : RET 0x14
00551db5 : MOV ECX,dword ptr [ESP + 0x58]
00551db9 : LEA EAX,[ESP + 0x10]
00551dbd : PUSH EAX
00551dbe : CALL 0x00526cd0
00551dc3 : TEST byte ptr [ESP + 0x18],0x2
00551dc8 : JNZ 0x00551dd7
00551dca : MOV ECX,dword ptr [ESP + 0x10]
00551dce : CMP ECX,EBX
00551dd0 : JZ 0x00551dd7
00551dd2 : CALL 0x00503db0
00551dd7 : TEST byte ptr [ESP + 0x18],0x1
00551ddc : MOV dword ptr [ESP + 0x10],EBX
00551de0 : JNZ 0x00551def
00551de2 : MOV ECX,dword ptr [ESP + 0x14]
00551de6 : CMP ECX,EBX
00551de8 : JZ 0x00551def
00551dea : CALL 0x00503db0
00551def : LEA ECX,[ESP + 0x38]
00551df3 : CALL 0x00526bc0
00551df8 : LEA ECX,[ESP + 0x28]
00551dfc : CALL 0x00526bc0
00551e01 : POP EDI
00551e02 : POP ESI
00551e03 : POP EBP
00551e04 : MOV AL,0x1
00551e06 : POP EBX
00551e07 : ADD ESP,0x38
00551e0a : RET 0x14

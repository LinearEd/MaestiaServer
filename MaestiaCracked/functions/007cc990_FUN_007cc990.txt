PROGRAM  : Maestia.exe
FUNCTION : FUN_007cc990
ENTRY    : 007cc990
BODY     : [[007cc990, 007cc9ec] [007cc9f0, 007cca58]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_007cc990(ushort param_1)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  int in_ECX;
  ushort uVar3;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b0ee13;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if (*(int *)(in_ECX + 8) != 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  if ((uint)param_1 < *(uint *)(in_ECX + 0x3c)) {
    uVar3 = 0;
    for (puVar1 = (undefined4 *)**(undefined4 **)(in_ECX + 0x38);
        puVar1 != *(undefined4 **)(in_ECX + 0x38); puVar1 = (undefined4 *)*puVar1) {
      if (uVar3 == param_1) {
        uVar2 = puVar1[9];
        local_8 = 0xffffffff;
        if (*(int *)(in_ECX + 8) != 0) {
          LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
        }
        ExceptionList = local_10;
        return uVar2;
      }
      uVar3 = uVar3 + 1;
    }
  }
  local_8 = 0xffffffff;
  if (*(int *)(in_ECX + 8) != 0) {
    LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  ExceptionList = local_10;
  return 0;
}



============================================================
DISASSEMBLY
============================================================
007cc990 : PUSH EBP
007cc991 : MOV EBP,ESP
007cc993 : PUSH -0x1
007cc995 : PUSH 0xb0ee13
007cc99a : MOV EAX,FS:[0x0]
007cc9a0 : PUSH EAX
007cc9a1 : PUSH ECX
007cc9a2 : PUSH ESI
007cc9a3 : PUSH EDI
007cc9a4 : MOV EAX,[0x00d66fa0]
007cc9a9 : XOR EAX,EBP
007cc9ab : PUSH EAX
007cc9ac : LEA EAX,[EBP + -0xc]
007cc9af : MOV FS:[0x0],EAX
007cc9b5 : MOV ESI,ECX
007cc9b7 : MOV EAX,dword ptr [ESI + 0x8]
007cc9ba : MOV dword ptr [EBP + -0x10],ESI
007cc9bd : TEST EAX,EAX
007cc9bf : JZ 0x007cc9cb
007cc9c1 : ADD EAX,0x4
007cc9c4 : PUSH EAX
007cc9c5 : CALL dword ptr [0x00b85118]
007cc9cb : MOV dword ptr [EBP + -0x4],0x0
007cc9d2 : MOV DI,word ptr [EBP + 0x8]
007cc9d6 : MOV EAX,dword ptr [ESI + 0x3c]
007cc9d9 : MOVZX ECX,DI
007cc9dc : CMP ECX,EAX
007cc9de : JNC 0x007cc9fc
007cc9e0 : MOV ECX,dword ptr [ESI + 0x38]
007cc9e3 : MOV EAX,dword ptr [ECX]
007cc9e5 : XOR EDX,EDX
007cc9e7 : CMP EAX,ECX
007cc9e9 : JZ 0x007cc9fc
007cc9eb : JMP 0x007cc9f0
007cc9f0 : CMP DX,DI
007cc9f3 : JZ 0x007cca29
007cc9f5 : MOV EAX,dword ptr [EAX]
007cc9f7 : INC EDX
007cc9f8 : CMP EAX,ECX
007cc9fa : JNZ 0x007cc9f0
007cc9fc : MOV dword ptr [EBP + -0x4],0xffffffff
007cca03 : MOV ESI,dword ptr [ESI + 0x8]
007cca06 : TEST ESI,ESI
007cca08 : JZ 0x007cca14
007cca0a : ADD ESI,0x4
007cca0d : PUSH ESI
007cca0e : CALL dword ptr [0x00b8511c]
007cca14 : XOR EAX,EAX
007cca16 : MOV ECX,dword ptr [EBP + -0xc]
007cca19 : MOV dword ptr FS:[0x0],ECX
007cca20 : POP ECX
007cca21 : POP EDI
007cca22 : POP ESI
007cca23 : MOV ESP,EBP
007cca25 : POP EBP
007cca26 : RET 0x4
007cca29 : MOV EDI,dword ptr [EAX + 0x24]
007cca2c : MOV dword ptr [EBP + -0x4],0xffffffff
007cca33 : MOV ESI,dword ptr [ESI + 0x8]
007cca36 : TEST ESI,ESI
007cca38 : JZ 0x007cca44
007cca3a : ADD ESI,0x4
007cca3d : PUSH ESI
007cca3e : CALL dword ptr [0x00b8511c]
007cca44 : MOV EAX,EDI
007cca46 : MOV ECX,dword ptr [EBP + -0xc]
007cca49 : MOV dword ptr FS:[0x0],ECX
007cca50 : POP ECX
007cca51 : POP EDI
007cca52 : POP ESI
007cca53 : MOV ESP,EBP
007cca55 : POP EBP
007cca56 : RET 0x4

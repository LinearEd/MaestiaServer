PROGRAM  : Maestia.exe
FUNCTION : FUN_00a2af00
ENTRY    : 00a2af00
BODY     : [[00a2af00, 00a2b033]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a2af00(int param_1,undefined4 param_2,undefined1 param_3,undefined4 *param_4)

{
  undefined4 *puVar1;
  uint uVar2;
  undefined4 *puVar3;
  DWORD DVar4;
  int in_ECX;
  int iVar5;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b427b9;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (DAT_017247b8 == 0) {
    iVar5 = 0;
    local_14 = in_ECX;
  }
  else {
    local_14 = 0;
    FUN_00404400(&local_14);
    iVar5 = local_14;
    if ((local_14 != 0) && (*(int *)(local_14 + 0x18) != 0)) {
      FUN_00879de0(*(undefined4 *)(param_1 + 0x41c),param_4);
    }
  }
  puVar3 = (undefined4 *)FUN_006f0760(0x10,".\\Flow\\AvaGameZone.cpp",0x5afc,0,uVar2);
  if (puVar3 == (undefined4 *)0x0) {
    puVar3 = (undefined4 *)0x0;
  }
  else {
    *puVar3 = 0;
    *(undefined1 *)(puVar3 + 1) = 1;
    puVar3[2] = 0;
    puVar3[3] = 0;
  }
  local_8 = 0xffffffff;
  if (puVar3 != (undefined4 *)0x0) {
    *puVar3 = param_2;
    *(undefined1 *)(puVar3 + 1) = param_3;
    param_4 = puVar3;
    DVar4 = GetTickCount();
    puVar3[2] = DVar4;
    if (iVar5 == 0) {
      puVar3[3] = 2000;
    }
    else {
      puVar3[3] = *(undefined4 *)(iVar5 + 0x1c);
    }
    iVar5 = *(int *)(param_1 + 0x538);
    if (iVar5 == 0) {
      uVar2 = 0;
    }
    else {
      uVar2 = *(int *)(param_1 + 0x540) - iVar5 >> 2;
    }
    puVar1 = *(undefined4 **)(param_1 + 0x53c);
    if ((uint)((int)puVar1 - iVar5 >> 2) < uVar2) {
      *puVar1 = puVar3;
      *(undefined4 **)(param_1 + 0x53c) = puVar1 + 1;
    }
    else {
      FUN_0042fe80(param_1 + 0x534,puVar1,&param_4);
    }
    if (*(int *)(param_1 + 0xac) != 0) {
      FUN_0086d800();
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00a2af00 : PUSH EBP
00a2af01 : MOV EBP,ESP
00a2af03 : PUSH -0x1
00a2af05 : PUSH 0xb427b9
00a2af0a : MOV EAX,FS:[0x0]
00a2af10 : PUSH EAX
00a2af11 : PUSH ECX
00a2af12 : PUSH EBX
00a2af13 : PUSH ESI
00a2af14 : PUSH EDI
00a2af15 : MOV EAX,[0x00d66fa0]
00a2af1a : XOR EAX,EBP
00a2af1c : PUSH EAX
00a2af1d : LEA EAX,[EBP + -0xc]
00a2af20 : MOV FS:[0x0],EAX
00a2af26 : MOV ESI,ECX
00a2af28 : MOV ECX,dword ptr [0x017247b8]
00a2af2e : XOR EBX,EBX
00a2af30 : CMP ECX,EBX
00a2af32 : JNZ 0x00a2af38
00a2af34 : XOR EDI,EDI
00a2af36 : JMP 0x00a2af67
00a2af38 : LEA EAX,[EBP + -0x10]
00a2af3b : PUSH EAX
00a2af3c : MOV dword ptr [EBP + -0x10],EBX
00a2af3f : CALL 0x00404400
00a2af44 : MOV EAX,dword ptr [EBP + -0x10]
00a2af47 : MOV EDI,EAX
00a2af49 : CMP EAX,EBX
00a2af4b : JZ 0x00a2af67
00a2af4d : CMP dword ptr [EAX + 0x18],EBX
00a2af50 : JBE 0x00a2af67
00a2af52 : MOV ECX,dword ptr [EBP + 0x14]
00a2af55 : MOV EDX,dword ptr [EBP + 0x8]
00a2af58 : MOV EAX,dword ptr [EDX + 0x41c]
00a2af5e : PUSH ECX
00a2af5f : PUSH EAX
00a2af60 : MOV ECX,ESI
00a2af62 : CALL 0x00879de0
00a2af67 : PUSH EBX
00a2af68 : PUSH 0x5afc
00a2af6d : PUSH 0xcc5144
00a2af72 : PUSH 0x10
00a2af74 : CALL 0x006f0760
00a2af79 : ADD ESP,0x10
00a2af7c : MOV dword ptr [EBP + 0x14],EAX
00a2af7f : MOV dword ptr [EBP + -0x4],EBX
00a2af82 : CMP EAX,EBX
00a2af84 : JZ 0x00a2af96
00a2af86 : MOV dword ptr [EAX],EBX
00a2af88 : MOV byte ptr [EAX + 0x4],0x1
00a2af8c : MOV dword ptr [EAX + 0x8],EBX
00a2af8f : MOV dword ptr [EAX + 0xc],EBX
00a2af92 : MOV ESI,EAX
00a2af94 : JMP 0x00a2af98
00a2af96 : XOR ESI,ESI
00a2af98 : MOV dword ptr [EBP + -0x4],0xffffffff
00a2af9f : MOV dword ptr [EBP + 0x14],ESI
00a2afa2 : CMP ESI,EBX
00a2afa4 : JZ 0x00a2b020
00a2afa6 : MOV ECX,dword ptr [EBP + 0xc]
00a2afa9 : MOV DL,byte ptr [EBP + 0x10]
00a2afac : MOV dword ptr [ESI],ECX
00a2afae : MOV byte ptr [ESI + 0x4],DL
00a2afb1 : CALL dword ptr [0x00b850d8]
00a2afb7 : MOV dword ptr [ESI + 0x8],EAX
00a2afba : CMP EDI,EBX
00a2afbc : JZ 0x00a2afc6
00a2afbe : MOV EAX,dword ptr [EDI + 0x1c]
00a2afc1 : MOV dword ptr [ESI + 0xc],EAX
00a2afc4 : JMP 0x00a2afcd
00a2afc6 : MOV dword ptr [ESI + 0xc],0x7d0
00a2afcd : MOV EAX,dword ptr [EBP + 0x8]
00a2afd0 : MOV EDI,dword ptr [EAX + 0x538]
00a2afd6 : ADD EAX,0x534
00a2afdb : CMP EDI,EBX
00a2afdd : JNZ 0x00a2afe3
00a2afdf : XOR ECX,ECX
00a2afe1 : JMP 0x00a2afeb
00a2afe3 : MOV ECX,dword ptr [EAX + 0xc]
00a2afe6 : SUB ECX,EDI
00a2afe8 : SAR ECX,0x2
00a2afeb : MOV EDX,dword ptr [EAX + 0x8]
00a2afee : MOV EBX,EDX
00a2aff0 : SUB EBX,EDI
00a2aff2 : SAR EBX,0x2
00a2aff5 : CMP EBX,ECX
00a2aff7 : JNC 0x00a2b003
00a2aff9 : MOV dword ptr [EDX],ESI
00a2affb : ADD EDX,0x4
00a2affe : MOV dword ptr [EAX + 0x8],EDX
00a2b001 : JMP 0x00a2b00e
00a2b003 : LEA ECX,[EBP + 0x14]
00a2b006 : PUSH ECX
00a2b007 : PUSH EDX
00a2b008 : PUSH EAX
00a2b009 : CALL 0x0042fe80
00a2b00e : MOV EDX,dword ptr [EBP + 0x8]
00a2b011 : MOV EAX,dword ptr [EDX + 0xac]
00a2b017 : TEST EAX,EAX
00a2b019 : JZ 0x00a2b020
00a2b01b : CALL 0x0086d800
00a2b020 : MOV ECX,dword ptr [EBP + -0xc]
00a2b023 : MOV dword ptr FS:[0x0],ECX
00a2b02a : POP ECX
00a2b02b : POP EDI
00a2b02c : POP ESI
00a2b02d : POP EBX
00a2b02e : MOV ESP,EBP
00a2b030 : POP EBP
00a2b031 : RET 0x10

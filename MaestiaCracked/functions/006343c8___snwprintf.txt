PROGRAM  : Maestia.exe
FUNCTION : __snwprintf
ENTRY    : 006343c8
BODY     : [[006343c8, 0063449a]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    __snwprintf
   
   Library: Visual Studio 2008 Release */

int __cdecl __snwprintf(wchar_t *_Dest,size_t _Count,wchar_t *_Format,...)

{
  int *piVar1;
  int iVar2;
  FILE local_24;
  
  if (_Format == (wchar_t *)0x0) {
    piVar1 = __errno();
    *piVar1 = 0x16;
    __invalid_parameter(0,0,0,0,0);
    iVar2 = -1;
  }
  else if ((_Count == 0) || (_Dest != (wchar_t *)0x0)) {
    local_24._flag = 0x42;
    local_24._base = (char *)_Dest;
    local_24._ptr = (char *)_Dest;
    if (_Count < 0x40000000) {
      local_24._cnt = _Count * 2;
    }
    else {
      local_24._cnt = 0x7fffffff;
    }
    iVar2 = __woutput_l(&local_24,_Format,(_locale_t)0x0,&stack0x00000010);
    if (_Dest != (wchar_t *)0x0) {
      local_24._cnt = local_24._cnt + -1;
      if (local_24._cnt < 0) {
        __flsbuf(0,&local_24);
      }
      else {
        *local_24._ptr = 0;
        local_24._ptr = (char *)((int)local_24._ptr + 1);
      }
      local_24._cnt = local_24._cnt + -1;
      if (local_24._cnt < 0) {
        __flsbuf(0,&local_24);
      }
      else {
        *local_24._ptr = 0;
      }
    }
  }
  else {
    piVar1 = __errno();
    *piVar1 = 0x16;
    __invalid_parameter(0,0,0,0,0);
    iVar2 = -1;
  }
  return iVar2;
}



============================================================
DISASSEMBLY
============================================================
006343c8 : MOV EDI,EDI
006343ca : PUSH EBP
006343cb : MOV EBP,ESP
006343cd : SUB ESP,0x20
006343d0 : PUSH EBX
006343d1 : XOR EBX,EBX
006343d3 : CMP dword ptr [EBP + 0x10],EBX
006343d6 : JNZ 0x006343f8
006343d8 : CALL 0x0063ab82
006343dd : PUSH EBX
006343de : PUSH EBX
006343df : PUSH EBX
006343e0 : PUSH EBX
006343e1 : PUSH EBX
006343e2 : MOV dword ptr [EAX],0x16
006343e8 : CALL 0x006372b8
006343ed : ADD ESP,0x14
006343f0 : OR EAX,0xffffffff
006343f3 : JMP 0x00634498
006343f8 : MOV EAX,dword ptr [EBP + 0xc]
006343fb : PUSH ESI
006343fc : MOV ESI,dword ptr [EBP + 0x8]
006343ff : CMP EAX,EBX
00634401 : JZ 0x00634424
00634403 : CMP ESI,EBX
00634405 : JNZ 0x00634424
00634407 : CALL 0x0063ab82
0063440c : PUSH EBX
0063440d : PUSH EBX
0063440e : PUSH EBX
0063440f : PUSH EBX
00634410 : PUSH EBX
00634411 : MOV dword ptr [EAX],0x16
00634417 : CALL 0x006372b8
0063441c : ADD ESP,0x14
0063441f : OR EAX,0xffffffff
00634422 : JMP 0x00634497
00634424 : MOV dword ptr [EBP + -0x14],0x42
0063442b : MOV dword ptr [EBP + -0x18],ESI
0063442e : MOV dword ptr [EBP + -0x20],ESI
00634431 : CMP EAX,0x3fffffff
00634436 : JBE 0x00634441
00634438 : MOV dword ptr [EBP + -0x1c],0x7fffffff
0063443f : JMP 0x00634446
00634441 : ADD EAX,EAX
00634443 : MOV dword ptr [EBP + -0x1c],EAX
00634446 : PUSH EDI
00634447 : LEA EAX,[EBP + 0x14]
0063444a : PUSH EAX
0063444b : PUSH EBX
0063444c : PUSH dword ptr [EBP + 0x10]
0063444f : LEA EAX,[EBP + -0x20]
00634452 : PUSH EAX
00634453 : CALL 0x006460b5
00634458 : ADD ESP,0x10
0063445b : MOV EDI,EAX
0063445d : CMP ESI,EBX
0063445f : JZ 0x00634496
00634461 : DEC dword ptr [EBP + -0x1c]
00634464 : JS 0x00634470
00634466 : MOV EAX,dword ptr [EBP + -0x20]
00634469 : MOV byte ptr [EAX],BL
0063446b : INC dword ptr [EBP + -0x20]
0063446e : JMP 0x0063447c
00634470 : LEA EAX,[EBP + -0x20]
00634473 : PUSH EAX
00634474 : PUSH EBX
00634475 : CALL 0x00645eff
0063447a : POP ECX
0063447b : POP ECX
0063447c : DEC dword ptr [EBP + -0x1c]
0063447f : JS 0x00634488
00634481 : MOV EAX,dword ptr [EBP + -0x20]
00634484 : MOV byte ptr [EAX],BL
00634486 : JMP 0x00634494
00634488 : LEA EAX,[EBP + -0x20]
0063448b : PUSH EAX
0063448c : PUSH EBX
0063448d : CALL 0x00645eff
00634492 : POP ECX
00634493 : POP ECX
00634494 : MOV EAX,EDI
00634496 : POP EDI
00634497 : POP ESI
00634498 : POP EBX
00634499 : LEAVE
0063449a : RET

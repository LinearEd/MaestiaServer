PROGRAM  : Maestia.exe
FUNCTION : FUN_00428320
ENTRY    : 00428320
BODY     : [[00428320, 0042835b] [00428360, 00428475]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x0042837c) */

void FUN_00428320(int param_1,undefined4 *param_2,undefined4 *param_3)

{
  uint uVar1;
  int iVar2;
  ushort *puVar3;
  undefined4 *puVar4;
  int iVar5;
  ushort *puVar6;
  uint uVar7;
  undefined4 *puVar8;
  bool bVar9;
  
  iVar2 = (int)param_3;
  puVar4 = *(undefined4 **)(param_1 + 4);
  bVar9 = true;
  if (*(char *)((int)puVar4[1] + 0x29) == '\0') {
    uVar1 = *(uint *)((int)param_3 + 0x14);
    puVar8 = (undefined4 *)puVar4[1];
    do {
      puVar4 = puVar8;
      if ((uint)puVar4[9] < 8) {
        puVar3 = (ushort *)(puVar4 + 4);
      }
      else {
        puVar3 = (ushort *)puVar4[4];
      }
      uVar7 = puVar4[8];
      if (uVar1 < (uint)puVar4[8]) {
        uVar7 = uVar1;
      }
      if (*(uint *)((int)param_3 + 0x18) < 8) {
        puVar6 = (ushort *)((int)param_3 + 4);
      }
      else {
        puVar6 = *(ushort **)((int)param_3 + 4);
      }
      for (; uVar7 != 0; uVar7 = uVar7 - 1) {
        if (*puVar6 != *puVar3) {
          uVar7 = (-(uint)(*puVar6 < *puVar3) & 0xfffffffe) + 1;
          if (uVar7 != 0) goto LAB_004283d7;
          break;
        }
        puVar6 = puVar6 + 1;
        puVar3 = puVar3 + 1;
      }
      if (uVar1 < (uint)puVar4[8]) {
        uVar7 = 0xffffffff;
      }
      else {
        uVar7 = (uint)(uVar1 != puVar4[8]);
      }
LAB_004283d7:
      bVar9 = (int)uVar7 < 0;
      if (bVar9) {
        puVar8 = (undefined4 *)*puVar4;
      }
      else {
        puVar8 = (undefined4 *)puVar4[2];
      }
    } while (*(char *)((int)puVar8 + 0x29) == '\0');
  }
  param_3 = puVar4;
  if (bVar9) {
    if (puVar4 == (undefined4 *)**(int **)(param_1 + 4)) {
      bVar9 = true;
      goto LAB_00428411;
    }
    FUN_00428ba0();
  }
  puVar4 = param_3;
  if (*(uint *)(iVar2 + 0x18) < 8) {
    iVar5 = iVar2 + 4;
  }
  else {
    iVar5 = *(int *)(iVar2 + 4);
  }
  iVar5 = FUN_00405bb0(iVar5);
  if (-1 < iVar5) {
    *param_2 = puVar4;
    *(undefined1 *)(param_2 + 1) = 0;
    return;
  }
LAB_00428411:
  puVar4 = (undefined4 *)FUN_004284f0(&param_3,bVar9,iVar2);
  *param_2 = *puVar4;
  *(undefined1 *)(param_2 + 1) = 1;
  return;
}



============================================================
DISASSEMBLY
============================================================
00428320 : PUSH EBP
00428321 : MOV EBP,ESP
00428323 : SUB ESP,0x18
00428326 : PUSH EBX
00428327 : MOV EBX,dword ptr [EBP + 0x10]
0042832a : PUSH ESI
0042832b : PUSH EDI
0042832c : MOV EDI,dword ptr [EBP + 0x8]
0042832f : MOV EAX,dword ptr [EDI + 0x4]
00428332 : MOV ESI,dword ptr [EAX + 0x4]
00428335 : CMP byte ptr [ESI + 0x29],0x0
00428339 : MOV ECX,EAX
0042833b : MOV AL,0x1
0042833d : MOV dword ptr [EBP + -0x4],ECX
00428340 : MOV byte ptr [EBP + -0x8],AL
00428343 : JNZ 0x004283fa
00428349 : MOV EAX,dword ptr [EBX + 0x14]
0042834c : MOV EDX,dword ptr [EBX + 0x18]
0042834f : MOV ECX,EAX
00428351 : MOV dword ptr [EBP + -0x10],EAX
00428354 : MOV dword ptr [EBP + -0xc],ECX
00428357 : MOV dword ptr [EBP + -0x14],EDX
0042835a : JMP 0x00428363
00428360 : MOV ECX,dword ptr [EBP + -0xc]
00428363 : CMP dword ptr [ESI + 0x24],0x8
00428367 : MOV EDX,dword ptr [ESI + 0x20]
0042836a : MOV dword ptr [EBP + -0x4],ESI
0042836d : JC 0x00428374
0042836f : MOV EAX,dword ptr [ESI + 0x10]
00428372 : JMP 0x00428377
00428374 : LEA EAX,[ESI + 0x10]
00428377 : MOV EDI,dword ptr [EBP + -0x10]
0042837a : CMP ECX,EDI
0042837c : CMOVC EDI,ECX
0042837f : CMP EDI,EDX
00428381 : JNC 0x00428385
00428383 : MOV EDX,EDI
00428385 : CMP dword ptr [EBP + -0x14],0x8
00428389 : JC 0x00428390
0042838b : MOV ECX,dword ptr [EBX + 0x4]
0042838e : JMP 0x00428393
00428390 : LEA ECX,[EBX + 0x4]
00428393 : TEST EDX,EDX
00428395 : JBE 0x004283ad
00428397 : MOV BX,word ptr [ECX]
0042839a : CMP BX,word ptr [EAX]
0042839d : JNZ 0x004283b9
0042839f : ADD ECX,0x2
004283a2 : ADD EAX,0x2
004283a5 : SUB EDX,0x1
004283a8 : JNZ 0x00428397
004283aa : MOV EBX,dword ptr [EBP + 0x10]
004283ad : MOV EAX,dword ptr [ESI + 0x20]
004283b0 : CMP EDI,EAX
004283b2 : JNC 0x004283ce
004283b4 : OR EAX,0xffffffff
004283b7 : JMP 0x004283d7
004283b9 : MOV CX,BX
004283bc : CMP CX,word ptr [EAX]
004283bf : SBB EAX,EAX
004283c1 : AND EAX,0xfffffffe
004283c4 : ADD EAX,0x1
004283c7 : JZ 0x004283aa
004283c9 : MOV EBX,dword ptr [EBP + 0x10]
004283cc : JMP 0x004283d7
004283ce : XOR EDX,EDX
004283d0 : CMP EDI,EAX
004283d2 : SETNZ DL
004283d5 : MOV EAX,EDX
004283d7 : TEST EAX,EAX
004283d9 : SETL AL
004283dc : MOV byte ptr [EBP + -0x8],AL
004283df : TEST AL,AL
004283e1 : JZ 0x004283e7
004283e3 : MOV ESI,dword ptr [ESI]
004283e5 : JMP 0x004283ea
004283e7 : MOV ESI,dword ptr [ESI + 0x8]
004283ea : CMP byte ptr [ESI + 0x29],0x0
004283ee : JZ 0x00428360
004283f4 : MOV EDI,dword ptr [EBP + 0x8]
004283f7 : MOV ECX,dword ptr [EBP + -0x4]
004283fa : MOV ESI,ECX
004283fc : MOV dword ptr [EBP + 0x10],ESI
004283ff : TEST AL,AL
00428401 : JZ 0x00428432
00428403 : MOV EAX,dword ptr [EDI + 0x4]
00428406 : LEA EDX,[EBP + 0x10]
00428409 : CMP ECX,dword ptr [EAX]
0042840b : JNZ 0x0042842a
0042840d : PUSH EBX
0042840e : PUSH 0x1
00428410 : PUSH EDX
00428411 : CALL 0x004284f0
00428416 : MOV ECX,dword ptr [EAX]
00428418 : MOV EAX,dword ptr [EBP + 0xc]
0042841b : MOV dword ptr [EAX],ECX
0042841d : MOV byte ptr [EAX + 0x4],0x1
00428421 : POP EDI
00428422 : POP ESI
00428423 : POP EBX
00428424 : MOV ESP,EBP
00428426 : POP EBP
00428427 : RET 0xc
0042842a : CALL 0x00428ba0
0042842f : MOV ESI,dword ptr [EBP + 0x10]
00428432 : CMP dword ptr [EBX + 0x18],0x8
00428436 : MOV EDI,dword ptr [EBX + 0x14]
00428439 : LEA ECX,[ESI + 0xc]
0042843c : JC 0x00428443
0042843e : MOV EAX,dword ptr [EBX + 0x4]
00428441 : JMP 0x00428446
00428443 : LEA EAX,[EBX + 0x4]
00428446 : PUSH EAX
00428447 : MOV EAX,dword ptr [ECX + 0x14]
0042844a : CALL 0x00405bb0
0042844f : TEST EAX,EAX
00428451 : JGE 0x00428464
00428453 : MOV EDX,dword ptr [EBP + -0x8]
00428456 : MOV ECX,dword ptr [EBP + -0x4]
00428459 : MOV EDI,dword ptr [EBP + 0x8]
0042845c : PUSH EBX
0042845d : PUSH EDX
0042845e : LEA EAX,[EBP + 0x10]
00428461 : PUSH EAX
00428462 : JMP 0x00428411
00428464 : MOV EAX,dword ptr [EBP + 0xc]
00428467 : POP EDI
00428468 : MOV dword ptr [EAX],ESI
0042846a : POP ESI
0042846b : MOV byte ptr [EAX + 0x4],0x0
0042846f : POP EBX
00428470 : MOV ESP,EBP
00428472 : POP EBP
00428473 : RET 0xc

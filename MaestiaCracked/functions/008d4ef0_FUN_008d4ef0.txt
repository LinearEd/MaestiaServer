PROGRAM  : Maestia.exe
FUNCTION : FUN_008d4ef0
ENTRY    : 008d4ef0
BODY     : [[008d4ef0, 008d5169] [008d5170, 008d51d9]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008d4ef0(void)

{
  char cVar1;
  ushort *puVar2;
  int iVar3;
  int *piVar4;
  uint uVar5;
  int iVar6;
  uint *puVar7;
  int in_EDX;
  int *piVar8;
  int *piVar9;
  int local_48;
  uint *local_3c;
  int *local_38;
  char local_31;
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  puStack_c = &LAB_00b1d6a6;
  local_10 = ExceptionList;
  uVar5 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  piVar9 = (int *)**(int **)(in_EDX + 0x3c);
  local_38 = piVar9;
  local_14 = uVar5;
  if (piVar9 != *(int **)(in_EDX + 0x3c)) {
    do {
      local_8 = 0xffffffff;
      puVar2 = (ushort *)piVar9[4];
      if ((puVar2 != (ushort *)0x0) &&
         (piVar8 = *(int **)(puVar2 + 0x42), piVar8 != *(int **)(puVar2 + 0x44))) {
        local_18 = 7;
        local_1c = 0;
        local_2c = 0;
        FUN_00406360(&DAT_00c58714,0);
        local_8 = 0;
        if (10000 < *(ushort *)(*piVar8 + 0xe2)) {
          local_8 = 0xffffffff;
          if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0(uVar5);
          }
          local_18 = 7;
          local_1c = 0;
          local_2c = 0;
          break;
        }
        local_31 = '\0';
        if (piVar8 != *(int **)(puVar2 + 0x44)) {
          do {
            iVar3 = *piVar8;
            local_3c = (uint *)(*(ushort *)(iVar3 + 0x70) | 0x68e0000);
            FUN_004437f0(&local_3c);
            if (local_48 == *(int *)(DAT_00d7c54c + 0x44)) {
              iVar6 = 0;
            }
            else {
              iVar6 = *(int *)(local_48 + 0x10);
            }
            if ((((iVar3 != 0) && (iVar6 != 0)) &&
                ((cVar1 = *(char *)(iVar6 + 0x7e8), cVar1 == '\x05' || (cVar1 == '\x06')))) &&
               ((*(byte *)(iVar3 + 0x74) & 0x18) == 0)) {
              piVar9 = local_38;
              if (local_31 == '\x01') break;
              if (cVar1 == '\x05') {
                local_3c = (uint *)FUN_006f0760(0x28,".\\Gui\\AvaGuiPremiumShop.cpp",0x113d,0);
                local_8._0_1_ = 1;
                if (local_3c == (uint *)0x0) {
                  puVar7 = (uint *)0x0;
                }
                else {
                  puVar7 = (uint *)FUN_0042da30(local_3c);
                }
                local_8 = (uint)local_8._1_3_ << 8;
                *puVar7 = (uint)*puVar2;
                local_3c = puVar7;
                FUN_00405d70(puVar2 + 0x12);
                puVar7[8] = (uint)*(ushort *)(*piVar8 + 0x70);
                *(byte *)(puVar7 + 9) = *(byte *)(*piVar8 + 0x74) & 1;
              }
              else {
                if (cVar1 != '\x06') goto LAB_008d50f4;
                local_3c = (uint *)FUN_006f0760(0x28,".\\Gui\\AvaGuiPremiumShop.cpp",0x1148,0);
                local_8._0_1_ = 2;
                if (local_3c == (uint *)0x0) {
                  puVar7 = (uint *)0x0;
                }
                else {
                  puVar7 = (uint *)FUN_0042da30(local_3c);
                }
                local_8 = (uint)local_8._1_3_ << 8;
                *puVar7 = (uint)*puVar2;
                local_3c = puVar7;
                FUN_00405d70(puVar2 + 0x12);
                puVar7[8] = (uint)*(ushort *)(*piVar8 + 0x70);
                *(byte *)(puVar7 + 9) = *(byte *)(*piVar8 + 0x74) & 1;
              }
              FUN_004c05f0();
              local_31 = '\x01';
            }
LAB_008d50f4:
            piVar8 = piVar8 + 1;
            piVar9 = local_38;
          } while (piVar8 != *(int **)(puVar2 + 0x44));
        }
        local_8 = 0xffffffff;
        if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0(uVar5);
        }
        local_18 = 7;
        local_1c = 0;
        local_2c = 0;
      }
      if (*(char *)((int)piVar9 + 0x15) == '\0') {
        piVar8 = (int *)piVar9[2];
        if (*(char *)((int)piVar8 + 0x15) == '\0') {
          cVar1 = *(char *)(*piVar8 + 0x15);
          piVar9 = piVar8;
          piVar8 = (int *)*piVar8;
          while (local_38 = piVar9, cVar1 == '\0') {
            cVar1 = *(char *)(*piVar8 + 0x15);
            piVar9 = piVar8;
            piVar8 = (int *)*piVar8;
          }
        }
        else {
          cVar1 = *(char *)(piVar9[1] + 0x15);
          piVar4 = (int *)piVar9[1];
          piVar8 = piVar9;
          while ((piVar9 = piVar4, local_38 = piVar9, cVar1 == '\0' && (piVar8 == (int *)piVar9[2]))
                ) {
            cVar1 = *(char *)(piVar9[1] + 0x15);
            piVar4 = (int *)piVar9[1];
            piVar8 = piVar9;
          }
        }
      }
    } while (piVar9 != *(int **)(in_EDX + 0x3c));
  }
  local_8 = 0xffffffff;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008d4ef0 : PUSH EBP
008d4ef1 : MOV EBP,ESP
008d4ef3 : PUSH -0x1
008d4ef5 : PUSH 0xb1d6a6
008d4efa : MOV EAX,FS:[0x0]
008d4f00 : PUSH EAX
008d4f01 : SUB ESP,0x38
008d4f04 : MOV EAX,[0x00d66fa0]
008d4f09 : XOR EAX,EBP
008d4f0b : MOV dword ptr [EBP + -0x10],EAX
008d4f0e : PUSH EBX
008d4f0f : PUSH ESI
008d4f10 : PUSH EDI
008d4f11 : PUSH EAX
008d4f12 : LEA EAX,[EBP + -0xc]
008d4f15 : MOV FS:[0x0],EAX
008d4f1b : MOV EAX,dword ptr [EDX + 0x3c]
008d4f1e : MOV ESI,dword ptr [EAX]
008d4f20 : MOV dword ptr [EBP + -0x3c],EDX
008d4f23 : MOV dword ptr [EBP + -0x34],ESI
008d4f26 : CMP ESI,EAX
008d4f28 : JZ 0x008d51be
008d4f2e : MOV EDI,EDI
008d4f30 : MOV EDI,dword ptr [ESI + 0x10]
008d4f33 : MOV dword ptr [EBP + -0x40],EDI
008d4f36 : TEST EDI,EDI
008d4f38 : JZ 0x008d5132
008d4f3e : MOV EBX,dword ptr [EDI + 0x84]
008d4f44 : CMP EBX,dword ptr [EDI + 0x88]
008d4f4a : JZ 0x008d5132
008d4f50 : XOR EAX,EAX
008d4f52 : PUSH EAX
008d4f53 : PUSH 0xc58714
008d4f58 : LEA ECX,[EBP + -0x2c]
008d4f5b : MOV dword ptr [EBP + -0x14],0x7
008d4f62 : MOV dword ptr [EBP + -0x18],0x0
008d4f69 : MOV word ptr [EBP + -0x28],AX
008d4f6d : CALL 0x00406360
008d4f72 : MOV dword ptr [EBP + -0x4],0x0
008d4f79 : MOV ECX,dword ptr [EBX]
008d4f7b : MOV EDX,0x2710
008d4f80 : CMP word ptr [ECX + 0xe2],DX
008d4f87 : JA 0x008d5195
008d4f8d : MOV byte ptr [EBP + -0x2d],0x0
008d4f91 : CMP EBX,dword ptr [EDI + 0x88]
008d4f97 : JZ 0x008d5106
008d4f9d : LEA ECX,[ECX]
008d4fa0 : MOV ESI,dword ptr [EBX]
008d4fa2 : MOVZX EAX,word ptr [ESI + 0x70]
008d4fa6 : LEA ECX,[EBP + -0x38]
008d4fa9 : OR EAX,0x68e0000
008d4fae : PUSH ECX
008d4faf : MOV ECX,dword ptr [0x00d7c54c]
008d4fb5 : MOV dword ptr [EBP + -0x38],EAX
008d4fb8 : ADD ECX,0x40
008d4fbb : LEA EAX,[EBP + -0x44]
008d4fbe : CALL 0x004437f0
008d4fc3 : MOV EDX,dword ptr [0x00d7c54c]
008d4fc9 : MOV EAX,dword ptr [EDX + 0x44]
008d4fcc : MOV ECX,dword ptr [EBP + -0x44]
008d4fcf : CMP ECX,EAX
008d4fd1 : JZ 0x008d4fd8
008d4fd3 : MOV EAX,dword ptr [ECX + 0x10]
008d4fd6 : JMP 0x008d4fda
008d4fd8 : XOR EAX,EAX
008d4fda : TEST ESI,ESI
008d4fdc : JZ 0x008d50f4
008d4fe2 : TEST EAX,EAX
008d4fe4 : JZ 0x008d50f4
008d4fea : MOV AL,byte ptr [EAX + 0x7e8]
008d4ff0 : CMP AL,0x5
008d4ff2 : JZ 0x008d4ffc
008d4ff4 : CMP AL,0x6
008d4ff6 : JNZ 0x008d50f4
008d4ffc : TEST byte ptr [ESI + 0x74],0x18
008d5000 : JNZ 0x008d50f4
008d5006 : CMP byte ptr [EBP + -0x2d],0x1
008d500a : JZ 0x008d5103
008d5010 : MOVZX EAX,AL
008d5013 : SUB EAX,0x5
008d5016 : JZ 0x008d5084
008d5018 : SUB EAX,0x1
008d501b : JNZ 0x008d50f4
008d5021 : PUSH EAX
008d5022 : PUSH 0x1148
008d5027 : PUSH 0xc58750
008d502c : PUSH 0x28
008d502e : CALL 0x006f0760
008d5033 : ADD ESP,0x10
008d5036 : MOV dword ptr [EBP + -0x38],EAX
008d5039 : MOV byte ptr [EBP + -0x4],0x2
008d503d : TEST EAX,EAX
008d503f : JZ 0x008d504b
008d5041 : PUSH EAX
008d5042 : CALL 0x0042da30
008d5047 : MOV ESI,EAX
008d5049 : JMP 0x008d504d
008d504b : XOR ESI,ESI
008d504d : MOV byte ptr [EBP + -0x4],0x0
008d5051 : MOVZX EAX,word ptr [EDI]
008d5054 : ADD EDI,0x24
008d5057 : PUSH EDI
008d5058 : LEA ECX,[ESI + 0x4]
008d505b : MOV dword ptr [EBP + -0x38],ESI
008d505e : MOV dword ptr [ESI],EAX
008d5060 : CALL 0x00405d70
008d5065 : MOV ECX,dword ptr [EBX]
008d5067 : MOVZX EDX,word ptr [ECX + 0x70]
008d506b : MOV dword ptr [ESI + 0x20],EDX
008d506e : MOV EAX,dword ptr [EBX]
008d5070 : MOV CL,byte ptr [EAX + 0x74]
008d5073 : MOV EDX,dword ptr [EBP + -0x3c]
008d5076 : AND CL,0x1
008d5079 : MOV byte ptr [ESI + 0x24],CL
008d507c : ADD EDX,0x198
008d5082 : JMP 0x008d50e5
008d5084 : PUSH 0x0
008d5086 : PUSH 0x113d
008d508b : PUSH 0xc58718
008d5090 : PUSH 0x28
008d5092 : CALL 0x006f0760
008d5097 : ADD ESP,0x10
008d509a : MOV dword ptr [EBP + -0x38],EAX
008d509d : MOV byte ptr [EBP + -0x4],0x1
008d50a1 : TEST EAX,EAX
008d50a3 : JZ 0x008d50af
008d50a5 : PUSH EAX
008d50a6 : CALL 0x0042da30
008d50ab : MOV ESI,EAX
008d50ad : JMP 0x008d50b1
008d50af : XOR ESI,ESI
008d50b1 : MOV byte ptr [EBP + -0x4],0x0
008d50b5 : MOVZX EDX,word ptr [EDI]
008d50b8 : ADD EDI,0x24
008d50bb : PUSH EDI
008d50bc : LEA ECX,[ESI + 0x4]
008d50bf : MOV dword ptr [EBP + -0x38],ESI
008d50c2 : MOV dword ptr [ESI],EDX
008d50c4 : CALL 0x00405d70
008d50c9 : MOV EAX,dword ptr [EBX]
008d50cb : MOVZX ECX,word ptr [EAX + 0x70]
008d50cf : MOV dword ptr [ESI + 0x20],ECX
008d50d2 : MOV EDX,dword ptr [EBX]
008d50d4 : MOV AL,byte ptr [EDX + 0x74]
008d50d7 : MOV EDX,dword ptr [EBP + -0x3c]
008d50da : AND AL,0x1
008d50dc : MOV byte ptr [ESI + 0x24],AL
008d50df : ADD EDX,0x188
008d50e5 : LEA EDI,[EBP + -0x38]
008d50e8 : CALL 0x004c05f0
008d50ed : MOV EDI,dword ptr [EBP + -0x40]
008d50f0 : MOV byte ptr [EBP + -0x2d],0x1
008d50f4 : ADD EBX,0x4
008d50f7 : CMP EBX,dword ptr [EDI + 0x88]
008d50fd : JNZ 0x008d4fa0
008d5103 : MOV ESI,dword ptr [EBP + -0x34]
008d5106 : MOV dword ptr [EBP + -0x4],0xffffffff
008d510d : CMP dword ptr [EBP + -0x14],0x8
008d5111 : JC 0x008d511b
008d5113 : MOV ECX,dword ptr [EBP + -0x28]
008d5116 : CALL 0x006f04e0
008d511b : MOV EDX,dword ptr [EBP + -0x3c]
008d511e : XOR ECX,ECX
008d5120 : MOV dword ptr [EBP + -0x14],0x7
008d5127 : MOV dword ptr [EBP + -0x18],0x0
008d512e : MOV word ptr [EBP + -0x28],CX
008d5132 : CMP byte ptr [ESI + 0x15],0x0
008d5136 : JNZ 0x008d518a
008d5138 : MOV ECX,dword ptr [ESI + 0x8]
008d513b : CMP byte ptr [ECX + 0x15],0x0
008d513f : JNZ 0x008d515f
008d5141 : MOV EAX,dword ptr [ECX]
008d5143 : CMP byte ptr [EAX + 0x15],0x0
008d5147 : JNZ 0x008d515a
008d5149 : LEA ESP,[ESP]
008d5150 : MOV ECX,EAX
008d5152 : MOV EAX,dword ptr [ECX]
008d5154 : CMP byte ptr [EAX + 0x15],0x0
008d5158 : JZ 0x008d5150
008d515a : MOV dword ptr [EBP + -0x34],ECX
008d515d : JMP 0x008d5187
008d515f : MOV EAX,dword ptr [ESI + 0x4]
008d5162 : CMP byte ptr [EAX + 0x15],0x0
008d5166 : JNZ 0x008d5184
008d5168 : JMP 0x008d5173
008d5170 : MOV ESI,dword ptr [EBP + -0x34]
008d5173 : CMP ESI,dword ptr [EAX + 0x8]
008d5176 : JNZ 0x008d5184
008d5178 : MOV dword ptr [EBP + -0x34],EAX
008d517b : MOV EAX,dword ptr [EAX + 0x4]
008d517e : CMP byte ptr [EAX + 0x15],0x0
008d5182 : JZ 0x008d5170
008d5184 : MOV dword ptr [EBP + -0x34],EAX
008d5187 : MOV ESI,dword ptr [EBP + -0x34]
008d518a : CMP ESI,dword ptr [EDX + 0x3c]
008d518d : JNZ 0x008d4f30
008d5193 : JMP 0x008d51be
008d5195 : MOV dword ptr [EBP + -0x4],0xffffffff
008d519c : CMP dword ptr [EBP + -0x14],0x8
008d51a0 : JC 0x008d51aa
008d51a2 : MOV ECX,dword ptr [EBP + -0x28]
008d51a5 : CALL 0x006f04e0
008d51aa : XOR EDX,EDX
008d51ac : MOV dword ptr [EBP + -0x14],0x7
008d51b3 : MOV dword ptr [EBP + -0x18],0x0
008d51ba : MOV word ptr [EBP + -0x28],DX
008d51be : MOV ECX,dword ptr [EBP + -0xc]
008d51c1 : MOV dword ptr FS:[0x0],ECX
008d51c8 : POP ECX
008d51c9 : POP EDI
008d51ca : POP ESI
008d51cb : POP EBX
008d51cc : MOV ECX,dword ptr [EBP + -0x10]
008d51cf : XOR ECX,EBP
008d51d1 : CALL 0x00633e6b
008d51d6 : MOV ESP,EBP
008d51d8 : POP EBP
008d51d9 : RET

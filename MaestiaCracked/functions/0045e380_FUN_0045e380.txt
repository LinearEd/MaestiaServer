PROGRAM  : Maestia.exe
FUNCTION : FUN_0045e380
ENTRY    : 0045e380
BODY     : [[0045e380, 0045e488]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_0045e380(void)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  int iVar4;
  size_t _Size;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b713c8;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_01723364);
  local_8 = 0;
  puVar2 = DAT_01723380;
  if (DAT_01723380 == (undefined4 *)0x0) {
    _Size = DAT_01723384 * 0x110c4 + 4;
    puVar2 = _malloc(_Size);
    if (puVar2 != (undefined4 *)0x0) {
      _memset(puVar2,0,_Size);
      *puVar2 = DAT_0172337c;
      puVar3 = DAT_01723380;
      puVar1 = puVar2 + 1;
      iVar4 = DAT_01723384;
      DAT_0172337c = puVar2;
      do {
        DAT_01723380 = puVar1;
        *DAT_01723380 = puVar3;
        iVar4 = iVar4 + -1;
        puVar3 = DAT_01723380;
        puVar1 = DAT_01723380 + 0x4431;
      } while (iVar4 != 0);
    }
    puVar2 = DAT_01723380;
    if (DAT_01723380 == (undefined4 *)0x0) {
      local_8 = 0xffffffff;
      LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_01723364);
      ExceptionList = local_10;
      return (undefined4 *)0x0;
    }
  }
  DAT_01723380 = (undefined4 *)*puVar2;
  DAT_01723388 = DAT_01723388 + 1;
  local_8 = 0xffffffff;
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_01723364);
  ExceptionList = local_10;
  return puVar2;
}



============================================================
DISASSEMBLY
============================================================
0045e380 : PUSH EBP
0045e381 : MOV EBP,ESP
0045e383 : PUSH -0x1
0045e385 : PUSH 0xb713c8
0045e38a : MOV EAX,FS:[0x0]
0045e390 : PUSH EAX
0045e391 : PUSH ECX
0045e392 : PUSH ESI
0045e393 : PUSH EDI
0045e394 : MOV EAX,[0x00d66fa0]
0045e399 : XOR EAX,EBP
0045e39b : PUSH EAX
0045e39c : LEA EAX,[EBP + -0xc]
0045e39f : MOV FS:[0x0],EAX
0045e3a5 : PUSH 0x1723364
0045e3aa : MOV dword ptr [EBP + -0x10],0x1723360
0045e3b1 : CALL dword ptr [0x00b85118]
0045e3b7 : MOV dword ptr [EBP + -0x4],0x0
0045e3be : MOV EAX,[0x01723380]
0045e3c3 : TEST EAX,EAX
0045e3c5 : JNZ 0x0045e454
0045e3cb : MOV EDI,dword ptr [0x01723384]
0045e3d1 : IMUL EDI,EDI,0x110c4
0045e3d7 : ADD EDI,0x4
0045e3da : PUSH EDI
0045e3db : CALL 0x00636043
0045e3e0 : MOV ESI,EAX
0045e3e2 : ADD ESP,0x4
0045e3e5 : TEST ESI,ESI
0045e3e7 : JZ 0x0045e426
0045e3e9 : PUSH EDI
0045e3ea : PUSH 0x0
0045e3ec : PUSH ESI
0045e3ed : CALL 0x0063b700
0045e3f2 : MOV EAX,[0x0172337c]
0045e3f7 : MOV dword ptr [ESI],EAX
0045e3f9 : MOV EDX,dword ptr [0x01723384]
0045e3ff : MOV EAX,[0x01723380]
0045e404 : ADD ESP,0xc
0045e407 : MOV dword ptr [0x0172337c],ESI
0045e40d : LEA ECX,[ESI + 0x4]
0045e410 : MOV dword ptr [ECX],EAX
0045e412 : MOV EAX,ECX
0045e414 : ADD ECX,0x110c4
0045e41a : SUB EDX,0x1
0045e41d : JNZ 0x0045e410
0045e41f : MOV [0x01723380],EAX
0045e424 : JMP 0x0045e42b
0045e426 : MOV EAX,[0x01723380]
0045e42b : TEST EAX,EAX
0045e42d : JNZ 0x0045e454
0045e42f : MOV dword ptr [EBP + -0x4],0xffffffff
0045e436 : PUSH 0x1723364
0045e43b : CALL dword ptr [0x00b8511c]
0045e441 : XOR EAX,EAX
0045e443 : MOV ECX,dword ptr [EBP + -0xc]
0045e446 : MOV dword ptr FS:[0x0],ECX
0045e44d : POP ECX
0045e44e : POP EDI
0045e44f : POP ESI
0045e450 : MOV ESP,EBP
0045e452 : POP EBP
0045e453 : RET
0045e454 : MOV ECX,dword ptr [EAX]
0045e456 : INC dword ptr [0x01723388]
0045e45c : MOV ESI,EAX
0045e45e : MOV dword ptr [0x01723380],ECX
0045e464 : MOV dword ptr [EBP + -0x4],0xffffffff
0045e46b : PUSH 0x1723364
0045e470 : CALL dword ptr [0x00b8511c]
0045e476 : MOV EAX,ESI
0045e478 : MOV ECX,dword ptr [EBP + -0xc]
0045e47b : MOV dword ptr FS:[0x0],ECX
0045e482 : POP ECX
0045e483 : POP EDI
0045e484 : POP ESI
0045e485 : MOV ESP,EBP
0045e487 : POP EBP
0045e488 : RET

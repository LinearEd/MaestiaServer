PROGRAM  : Maestia.exe
FUNCTION : FUN_0051eee0
ENTRY    : 0051eee0
BODY     : [[0051eee0, 0051eff4]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0051eee0(undefined4 param_1,uint *param_2,uint param_3)

{
  uint *puVar1;
  uint *puVar2;
  uint *puVar3;
  int *piVar4;
  int iVar5;
  int *in_ECX;
  uint uVar6;
  uint uVar7;
  
  FUN_0051f8e0(param_1);
  piVar4 = (int *)*in_ECX;
  param_3 = param_3 & piVar4[1];
  *piVar4 = *piVar4 + 1;
  iVar5 = *in_ECX;
  puVar1 = (uint *)(iVar5 + 8 + param_3 * 0xc);
  if (*puVar1 == 0xfffffffe) {
    *puVar1 = 0xffffffff;
    uVar7 = *param_2;
    puVar1[1] = uVar7;
    piVar4 = (int *)(uVar7 + 8);
    *piVar4 = *piVar4 + 1;
    *(char *)(puVar1 + 2) = (char)param_2[1];
    return;
  }
  uVar7 = param_3;
  do {
    uVar7 = uVar7 + 1 & *(uint *)(iVar5 + 4);
  } while (*(int *)(iVar5 + 8 + uVar7 * 0xc) != -2);
  puVar2 = (uint *)(iVar5 + 8 + uVar7 * 0xc);
  uVar6 = *(uint *)(puVar1[1] + 0xc) & *(uint *)(iVar5 + 4);
  if (uVar6 == param_3) {
    if (puVar2 != (uint *)0x0) {
      *puVar2 = *puVar1;
      uVar6 = puVar1[1];
      puVar2[1] = uVar6;
      piVar4 = (int *)(uVar6 + 8);
      *piVar4 = *piVar4 + 1;
      *(char *)(puVar2 + 2) = (char)puVar1[2];
    }
    uVar6 = *param_2;
    piVar4 = (int *)(uVar6 + 8);
    *piVar4 = *piVar4 + 1;
    piVar4 = (int *)(puVar1[1] + 8);
    *piVar4 = *piVar4 + -1;
    if (*piVar4 == 0) {
      FUN_00525340();
    }
    puVar1[1] = uVar6;
    *(char *)(puVar1 + 2) = (char)param_2[1];
    *puVar1 = uVar7;
    return;
  }
  puVar3 = (uint *)(iVar5 + 8 + uVar6 * 0xc);
  for (uVar6 = *(uint *)(iVar5 + 8 + uVar6 * 0xc); uVar6 != param_3;
      uVar6 = *(uint *)(iVar5 + 8 + uVar6 * 0xc)) {
    uVar6 = *puVar3;
    puVar3 = (uint *)(iVar5 + 8 + uVar6 * 0xc);
  }
  if (puVar2 != (uint *)0x0) {
    *puVar2 = *puVar1;
    uVar6 = puVar1[1];
    puVar2[1] = uVar6;
    piVar4 = (int *)(uVar6 + 8);
    *piVar4 = *piVar4 + 1;
    *(char *)(puVar2 + 2) = (char)puVar1[2];
  }
  *puVar3 = uVar7;
  uVar7 = *param_2;
  piVar4 = (int *)(uVar7 + 8);
  *piVar4 = *piVar4 + 1;
  piVar4 = (int *)(puVar1[1] + 8);
  *piVar4 = *piVar4 + -1;
  if (*piVar4 == 0) {
    FUN_00525340();
  }
  puVar1[1] = uVar7;
  *(char *)(puVar1 + 2) = (char)param_2[1];
  *puVar1 = 0xffffffff;
  return;
}



============================================================
DISASSEMBLY
============================================================
0051eee0 : MOV EAX,dword ptr [ESP + 0x4]
0051eee4 : PUSH EBX
0051eee5 : PUSH ESI
0051eee6 : PUSH EAX
0051eee7 : MOV ESI,ECX
0051eee9 : CALL 0x0051f8e0
0051eeee : MOV ECX,dword ptr [ESI]
0051eef0 : MOV EAX,dword ptr [ESP + 0x14]
0051eef4 : AND EAX,dword ptr [ECX + 0x4]
0051eef7 : INC dword ptr [ECX]
0051eef9 : MOV ECX,dword ptr [ESI]
0051eefb : LEA EDX,[EAX + EAX*0x2]
0051eefe : LEA ESI,[ECX + EDX*0x4 + 0x8]
0051ef02 : MOV EDX,dword ptr [ESI]
0051ef04 : MOV EBX,0xfffffffe
0051ef09 : CMP EDX,EBX
0051ef0b : JNZ 0x0051ef2a
0051ef0d : MOV ECX,dword ptr [ESP + 0x10]
0051ef11 : MOV dword ptr [ESI],0xffffffff
0051ef17 : MOV EAX,dword ptr [ECX]
0051ef19 : MOV dword ptr [ESI + 0x4],EAX
0051ef1c : INC dword ptr [EAX + 0x8]
0051ef1f : MOV AL,byte ptr [ECX + 0x4]
0051ef22 : MOV byte ptr [ESI + 0x8],AL
0051ef25 : POP ESI
0051ef26 : POP EBX
0051ef27 : RET 0xc
0051ef2a : PUSH EBP
0051ef2b : MOV EBP,dword ptr [ECX + 0x4]
0051ef2e : PUSH EDI
0051ef2f : MOV EDI,EAX
0051ef31 : INC EDI
0051ef32 : AND EDI,EBP
0051ef34 : LEA EDX,[EDI + EDI*0x2]
0051ef37 : CMP dword ptr [ECX + EDX*0x4 + 0x8],EBX
0051ef3b : JNZ 0x0051ef31
0051ef3d : LEA EDX,[EDI + EDI*0x2]
0051ef40 : LEA EBX,[ECX + EDX*0x4 + 0x8]
0051ef44 : MOV EDX,dword ptr [ESI + 0x4]
0051ef47 : MOV EDX,dword ptr [EDX + 0xc]
0051ef4a : AND EDX,EBP
0051ef4c : CMP EDX,EAX
0051ef4e : JNZ 0x0051ef91
0051ef50 : TEST EBX,EBX
0051ef52 : JZ 0x0051ef67
0051ef54 : MOV EAX,dword ptr [ESI]
0051ef56 : MOV dword ptr [EBX],EAX
0051ef58 : MOV EAX,dword ptr [ESI + 0x4]
0051ef5b : MOV dword ptr [EBX + 0x4],EAX
0051ef5e : INC dword ptr [EAX + 0x8]
0051ef61 : MOV AL,byte ptr [ESI + 0x8]
0051ef64 : MOV byte ptr [EBX + 0x8],AL
0051ef67 : MOV EBP,dword ptr [ESP + 0x18]
0051ef6b : MOV EBX,dword ptr [EBP]
0051ef6e : INC dword ptr [EBX + 0x8]
0051ef71 : MOV ECX,dword ptr [ESI + 0x4]
0051ef74 : ADD dword ptr [ECX + 0x8],-0x1
0051ef78 : JNZ 0x0051ef7f
0051ef7a : CALL 0x00525340
0051ef7f : MOV dword ptr [ESI + 0x4],EBX
0051ef82 : MOV CL,byte ptr [EBP + 0x4]
0051ef85 : MOV byte ptr [ESI + 0x8],CL
0051ef88 : MOV dword ptr [ESI],EDI
0051ef8a : POP EDI
0051ef8b : POP EBP
0051ef8c : POP ESI
0051ef8d : POP EBX
0051ef8e : RET 0xc
0051ef91 : LEA EDX,[EDX + EDX*0x2]
0051ef94 : CMP dword ptr [ECX + EDX*0x4 + 0x8],EAX
0051ef98 : LEA EDX,[ECX + EDX*0x4 + 0x8]
0051ef9c : JZ 0x0051efaf
0051ef9e : MOV EDI,EDI
0051efa0 : MOV EDX,dword ptr [EDX]
0051efa2 : LEA EDX,[EDX + EDX*0x2]
0051efa5 : CMP dword ptr [ECX + EDX*0x4 + 0x8],EAX
0051efa9 : LEA EDX,[ECX + EDX*0x4 + 0x8]
0051efad : JNZ 0x0051efa0
0051efaf : TEST EBX,EBX
0051efb1 : JZ 0x0051efc6
0051efb3 : MOV EAX,dword ptr [ESI]
0051efb5 : MOV dword ptr [EBX],EAX
0051efb7 : MOV EAX,dword ptr [ESI + 0x4]
0051efba : MOV dword ptr [EBX + 0x4],EAX
0051efbd : INC dword ptr [EAX + 0x8]
0051efc0 : MOV AL,byte ptr [ESI + 0x8]
0051efc3 : MOV byte ptr [EBX + 0x8],AL
0051efc6 : MOV EBX,dword ptr [ESP + 0x18]
0051efca : MOV dword ptr [EDX],EDI
0051efcc : MOV EDI,dword ptr [EBX]
0051efce : INC dword ptr [EDI + 0x8]
0051efd1 : MOV ECX,dword ptr [ESI + 0x4]
0051efd4 : ADD dword ptr [ECX + 0x8],-0x1
0051efd8 : JNZ 0x0051efdf
0051efda : CALL 0x00525340
0051efdf : MOV dword ptr [ESI + 0x4],EDI
0051efe2 : MOV CL,byte ptr [EBX + 0x4]
0051efe5 : POP EDI
0051efe6 : MOV byte ptr [ESI + 0x8],CL
0051efe9 : POP EBP
0051efea : MOV dword ptr [ESI],0xffffffff
0051eff0 : POP ESI
0051eff1 : POP EBX
0051eff2 : RET 0xc

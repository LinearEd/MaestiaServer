PROGRAM  : Maestia.exe
FUNCTION : FUN_00a845d0
ENTRY    : 00a845d0
BODY     : [[00a845d0, 00a848fd]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a845d0(int param_1)

{
  undefined2 uVar1;
  int iVar2;
  int iVar3;
  undefined4 uVar4;
  uint8_t *puVar5;
  byte bVar6;
  int *piVar7;
  int iVar8;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3ec82;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if (*(int *)(*DAT_00da9894 + 0x1d4) == 0) {
    FUN_008018d0(L"AvaGuiPremiumShopBasket::CheckOnBuyEvent Premiumshop unvisible");
    ExceptionList = local_10;
    return;
  }
  if (*(uint *)(*(int *)(*DAT_00da9894 + 0x1d4) + 0x1b4) < *(uint *)(param_1 + 0x4c)) {
    FUN_008dcc20(DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
    ExceptionList = local_10;
    return;
  }
  iVar2 = *(int *)ThreadLocalStoragePointer;
  bVar6 = (byte)((ulonglong)(*(byte *)(iVar2 + 0x18) + 1) % 3);
  *(byte *)(iVar2 + 0x18) = bVar6;
  puVar5 = (uint8_t *)((uint)bVar6 * 0x2000 + 0x122cb8 + iVar2);
  if (puVar5 == (uint8_t *)0x0) {
    puVar5 = (uint8_t *)0x0;
  }
  else {
    iVar8 = *(int *)(param_1 + 0x44);
    iVar3 = *(int *)(param_1 + 0x40);
    puVar5[2] = ';';
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[3] = '-';
    puVar5[4] = (uint8_t)(iVar8 - iVar3 >> 2);
    puVar5[5] = '\x02';
  }
  local_8 = 0xffffffff;
  if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
    FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),6,puVar5);
  }
  piVar7 = *(int **)(param_1 + 0x40);
  iVar8 = DAT_017247d4;
  if (piVar7 != *(int **)(param_1 + 0x44)) {
    do {
      iVar3 = *(int *)(*DAT_00da9894 + 0x1d4);
      if (*(int *)(iVar3 + 0x1bc) == 0) {
        bVar6 = (byte)((ulonglong)(*(byte *)(iVar2 + 0x18) + 1) % 3);
        *(byte *)(iVar2 + 0x18) = bVar6;
        puVar5 = (uint8_t *)((uint)bVar6 * 0x2000 + 0x122cb8 + iVar2);
        if (puVar5 == (uint8_t *)0x0) {
LAB_00a8485b:
          puVar5 = (uint8_t *)0x0;
        }
        else {
          uVar4 = *(undefined4 *)(*piVar7 + 0x78);
          uVar1 = *(undefined2 *)(*piVar7 + 0xe4);
          puVar5[0] = '\0';
          iVar8 = DAT_017247d4;
          puVar5[1] = '\0';
          puVar5[2] = ';';
          puVar5[3] = '.';
          *(undefined2 *)(puVar5 + 4) = uVar1;
          puVar5[6] = 0xff;
          puVar5[7] = 0xff;
          puVar5[8] = 0xff;
          puVar5[9] = 0xff;
          *(undefined4 *)(puVar5 + 10) = uVar4;
          puVar5[0xe] = '\x01';
          puVar5[0xf] = '\0';
          puVar5[0x10] = '\0';
          puVar5[0x11] = '\0';
          puVar5[0x12] = '\x01';
        }
LAB_00a8485d:
        local_8 = 0xffffffff;
        if ((*(int *)(iVar8 + 4) != 0) && (*(char *)(iVar8 + 8) != '\0')) {
          FUN_00a0dd40(*(int *)(iVar8 + 4),0x13,puVar5);
          iVar8 = DAT_017247d4;
        }
      }
      else {
        if (*(int *)(iVar3 + 0x1bc) == 1) {
          bVar6 = (byte)((ulonglong)(*(byte *)(iVar2 + 0x18) + 1) % 3);
          *(byte *)(iVar2 + 0x18) = bVar6;
          puVar5 = (uint8_t *)((uint)bVar6 * 0x2000 + 0x122cb8 + iVar2);
          if (puVar5 == (uint8_t *)0x0) goto LAB_00a8485b;
          uVar4 = *(undefined4 *)(*piVar7 + 0x80);
          uVar1 = *(undefined2 *)(*piVar7 + 0xe4);
          puVar5[0] = '\0';
          iVar8 = DAT_017247d4;
          puVar5[1] = '\0';
          puVar5[2] = ';';
          puVar5[3] = '.';
          *(undefined2 *)(puVar5 + 4) = uVar1;
          puVar5[6] = 0xff;
          puVar5[7] = 0xff;
          puVar5[8] = 0xff;
          puVar5[9] = 0xff;
          *(undefined4 *)(puVar5 + 10) = uVar4;
          puVar5[0xe] = '\x01';
          puVar5[0xf] = '\0';
          puVar5[0x10] = '\0';
          puVar5[0x11] = '\0';
          puVar5[0x12] = '\x02';
          goto LAB_00a8485d;
        }
        if (*(int *)(iVar3 + 0x1bc) == 2) {
          bVar6 = (byte)((ulonglong)(*(byte *)(iVar2 + 0x18) + 1) % 3);
          *(byte *)(iVar2 + 0x18) = bVar6;
          puVar5 = (uint8_t *)((uint)bVar6 * 0x2000 + 0x122cb8 + iVar2);
          if (puVar5 == (uint8_t *)0x0) goto LAB_00a8485b;
          uVar4 = *(undefined4 *)(*piVar7 + 0x8c);
          uVar1 = *(undefined2 *)(*piVar7 + 0xe4);
          puVar5[0] = '\0';
          iVar8 = DAT_017247d4;
          puVar5[1] = '\0';
          puVar5[2] = ';';
          puVar5[3] = '.';
          *(undefined2 *)(puVar5 + 4) = uVar1;
          puVar5[6] = 0xff;
          puVar5[7] = 0xff;
          puVar5[8] = 0xff;
          puVar5[9] = 0xff;
          *(undefined4 *)(puVar5 + 10) = uVar4;
          puVar5[0xe] = '\x01';
          puVar5[0xf] = '\0';
          puVar5[0x10] = '\0';
          puVar5[0x11] = '\0';
          puVar5[0x12] = '\x03';
          goto LAB_00a8485d;
        }
      }
      piVar7 = piVar7 + 1;
    } while (piVar7 != *(int **)(param_1 + 0x44));
  }
  bVar6 = (byte)((ulonglong)(*(byte *)(iVar2 + 0x18) + 1) % 3);
  *(byte *)(iVar2 + 0x18) = bVar6;
  puVar5 = (uint8_t *)((uint)bVar6 * 0x2000 + 0x122cb8 + iVar2);
  if (puVar5 == (uint8_t *)0x0) {
    puVar5 = (uint8_t *)0x0;
  }
  else {
    puVar5[0] = '\0';
    puVar5[1] = '\0';
    puVar5[2] = ';';
    puVar5[3] = '/';
  }
  local_8 = 0xffffffff;
  if ((*(int *)(iVar8 + 4) != 0) && (*(char *)(iVar8 + 8) != '\0')) {
    FUN_00a0dd40(*(int *)(iVar8 + 4),4,puVar5);
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00a845d0 : PUSH EBP
00a845d1 : MOV EBP,ESP
00a845d3 : PUSH -0x1
00a845d5 : PUSH 0xb3ec82
00a845da : MOV EAX,FS:[0x0]
00a845e0 : PUSH EAX
00a845e1 : SUB ESP,0x8
00a845e4 : PUSH EBX
00a845e5 : PUSH ESI
00a845e6 : PUSH EDI
00a845e7 : MOV EAX,[0x00d66fa0]
00a845ec : XOR EAX,EBP
00a845ee : PUSH EAX
00a845ef : LEA EAX,[EBP + -0xc]
00a845f2 : MOV FS:[0x0],EAX
00a845f8 : MOV EAX,[0x00da9894]
00a845fd : MOV EAX,dword ptr [EAX]
00a845ff : MOV ECX,dword ptr [EAX + 0x1d4]
00a84605 : TEST ECX,ECX
00a84607 : JNZ 0x00a84630
00a84609 : MOV ESI,dword ptr [0x00da98e8]
00a8460f : PUSH 0xc560d8
00a84614 : CALL 0x008018d0
00a84619 : ADD ESP,0x4
00a8461c : MOV ECX,dword ptr [EBP + -0xc]
00a8461f : MOV dword ptr FS:[0x0],ECX
00a84626 : POP ECX
00a84627 : POP EDI
00a84628 : POP ESI
00a84629 : POP EBX
00a8462a : MOV ESP,EBP
00a8462c : POP EBP
00a8462d : RET 0x4
00a84630 : MOV EBX,dword ptr [EBP + 0x8]
00a84633 : MOV EAX,ECX
00a84635 : MOV EAX,dword ptr [EAX + 0x1b4]
00a8463b : CMP dword ptr [EBX + 0x4c],EAX
00a8463e : JBE 0x00a84659
00a84640 : CALL 0x008dcc20
00a84645 : MOV ECX,dword ptr [EBP + -0xc]
00a84648 : MOV dword ptr FS:[0x0],ECX
00a8464f : POP ECX
00a84650 : POP EDI
00a84651 : POP ESI
00a84652 : POP EBX
00a84653 : MOV ESP,EBP
00a84655 : POP EBP
00a84656 : RET 0x4
00a84659 : MOV ECX,dword ptr FS:[0x2c]
00a84660 : MOV ESI,dword ptr [ECX]
00a84662 : MOVZX EAX,byte ptr [ESI + 0x18]
00a84666 : INC EAX
00a84667 : CDQ
00a84668 : MOV ECX,0x3
00a8466d : IDIV ECX
00a8466f : MOV byte ptr [ESI + 0x18],DL
00a84672 : MOVZX EDX,DL
00a84675 : SHL EDX,0xd
00a84678 : LEA EAX,[EDX + ESI*0x1 + 0x122cb8]
00a8467f : MOV dword ptr [EBP + -0x10],EAX
00a84682 : MOV dword ptr [EBP + -0x4],0x0
00a84689 : TEST EAX,EAX
00a8468b : JZ 0x00a846ac
00a8468d : MOV ECX,dword ptr [EBX + 0x44]
00a84690 : SUB ECX,dword ptr [EBX + 0x40]
00a84693 : MOV byte ptr [EAX + 0x2],0x3b
00a84697 : SAR ECX,0x2
00a8469a : XOR EDX,EDX
00a8469c : MOV word ptr [EAX],DX
00a8469f : MOV byte ptr [EAX + 0x3],0x2d
00a846a3 : MOV byte ptr [EAX + 0x4],CL
00a846a6 : MOV byte ptr [EAX + 0x5],0x2
00a846aa : JMP 0x00a846ae
00a846ac : XOR EAX,EAX
00a846ae : MOV dword ptr [EBP + -0x4],0xffffffff
00a846b5 : MOV EDI,dword ptr [0x017247d4]
00a846bb : MOV ECX,dword ptr [EDI + 0x4]
00a846be : TEST ECX,ECX
00a846c0 : JZ 0x00a846db
00a846c2 : CMP byte ptr [EDI + 0x8],0x0
00a846c6 : JZ 0x00a846db
00a846c8 : PUSH 0x6
00a846ca : PUSH ECX
00a846cb : MOV EDI,EAX
00a846cd : CALL 0x00a0dd40
00a846d2 : MOV EDI,dword ptr [0x017247d4]
00a846d8 : MOV EBX,dword ptr [EBP + 0x8]
00a846db : MOV EAX,dword ptr [EBP + 0x8]
00a846de : MOV EBX,dword ptr [EBX + 0x40]
00a846e1 : MOV EAX,dword ptr [EAX + 0x44]
00a846e4 : CMP EBX,EAX
00a846e6 : JZ 0x00a84890
00a846ec : LEA ESP,[ESP]
00a846f0 : MOV ECX,dword ptr [0x00da9894]
00a846f6 : MOV EAX,dword ptr [ECX]
00a846f8 : MOV ECX,dword ptr [EAX + 0x1d4]
00a846fe : CMP dword ptr [ECX + 0x1bc],0x0
00a84705 : JNZ 0x00a84773
00a84707 : MOVZX EAX,byte ptr [ESI + 0x18]
00a8470b : INC EAX
00a8470c : CDQ
00a8470d : MOV ECX,0x3
00a84712 : IDIV ECX
00a84714 : MOV byte ptr [ESI + 0x18],DL
00a84717 : MOVZX EDX,DL
00a8471a : SHL EDX,0xd
00a8471d : LEA EAX,[EDX + ESI*0x1 + 0x122cb8]
00a84724 : MOV dword ptr [EBP + -0x10],EAX
00a84727 : MOV dword ptr [EBP + -0x4],0x1
00a8472e : TEST EAX,EAX
00a84730 : JZ 0x00a8485b
00a84736 : MOV ECX,dword ptr [EBX]
00a84738 : MOV EDX,dword ptr [ECX + 0x78]
00a8473b : MOVZX ECX,word ptr [ECX + 0xe4]
00a84742 : XOR EDI,EDI
00a84744 : MOV word ptr [EAX],DI
00a84747 : MOV EDI,dword ptr [0x017247d4]
00a8474d : MOV byte ptr [EAX + 0x2],0x3b
00a84751 : MOV byte ptr [EAX + 0x3],0x2e
00a84755 : MOV word ptr [EAX + 0x4],CX
00a84759 : MOV dword ptr [EAX + 0x6],0xffffffff
00a84760 : MOV dword ptr [EAX + 0xa],EDX
00a84763 : MOV dword ptr [EAX + 0xe],0x1
00a8476a : MOV byte ptr [EAX + 0x12],0x1
00a8476e : JMP 0x00a8485d
00a84773 : CMP dword ptr [ECX + 0x1bc],0x1
00a8477a : JNZ 0x00a847e8
00a8477c : MOVZX EAX,byte ptr [ESI + 0x18]
00a84780 : INC EAX
00a84781 : CDQ
00a84782 : MOV ECX,0x3
00a84787 : IDIV ECX
00a84789 : MOV byte ptr [ESI + 0x18],DL
00a8478c : MOVZX EDX,DL
00a8478f : SHL EDX,0xd
00a84792 : LEA EAX,[EDX + ESI*0x1 + 0x122cb8]
00a84799 : MOV dword ptr [EBP + -0x10],EAX
00a8479c : MOV dword ptr [EBP + -0x4],0x2
00a847a3 : TEST EAX,EAX
00a847a5 : JZ 0x00a8485b
00a847ab : MOV ECX,dword ptr [EBX]
00a847ad : MOV EDX,dword ptr [ECX + 0x80]
00a847b3 : MOVZX ECX,word ptr [ECX + 0xe4]
00a847ba : XOR EDI,EDI
00a847bc : MOV word ptr [EAX],DI
00a847bf : MOV EDI,dword ptr [0x017247d4]
00a847c5 : MOV byte ptr [EAX + 0x2],0x3b
00a847c9 : MOV byte ptr [EAX + 0x3],0x2e
00a847cd : MOV word ptr [EAX + 0x4],CX
00a847d1 : MOV dword ptr [EAX + 0x6],0xffffffff
00a847d8 : MOV dword ptr [EAX + 0xa],EDX
00a847db : MOV dword ptr [EAX + 0xe],0x1
00a847e2 : MOV byte ptr [EAX + 0x12],0x2
00a847e6 : JMP 0x00a8485d
00a847e8 : MOV EAX,ECX
00a847ea : CMP dword ptr [EAX + 0x1bc],0x2
00a847f1 : JNZ 0x00a84881
00a847f7 : MOVZX EAX,byte ptr [ESI + 0x18]
00a847fb : INC EAX
00a847fc : CDQ
00a847fd : MOV ECX,0x3
00a84802 : IDIV ECX
00a84804 : MOV byte ptr [ESI + 0x18],DL
00a84807 : MOVZX EDX,DL
00a8480a : SHL EDX,0xd
00a8480d : LEA EAX,[EDX + ESI*0x1 + 0x122cb8]
00a84814 : MOV dword ptr [EBP + -0x10],EAX
00a84817 : MOV dword ptr [EBP + -0x4],ECX
00a8481a : TEST EAX,EAX
00a8481c : JZ 0x00a8485b
00a8481e : MOV ECX,dword ptr [EBX]
00a84820 : MOV EDX,dword ptr [ECX + 0x8c]
00a84826 : MOVZX ECX,word ptr [ECX + 0xe4]
00a8482d : XOR EDI,EDI
00a8482f : MOV word ptr [EAX],DI
00a84832 : MOV EDI,dword ptr [0x017247d4]
00a84838 : MOV byte ptr [EAX + 0x2],0x3b
00a8483c : MOV byte ptr [EAX + 0x3],0x2e
00a84840 : MOV word ptr [EAX + 0x4],CX
00a84844 : MOV dword ptr [EAX + 0x6],0xffffffff
00a8484b : MOV dword ptr [EAX + 0xa],EDX
00a8484e : MOV dword ptr [EAX + 0xe],0x1
00a84855 : MOV byte ptr [EAX + 0x12],0x3
00a84859 : JMP 0x00a8485d
00a8485b : XOR EAX,EAX
00a8485d : MOV dword ptr [EBP + -0x4],0xffffffff
00a84864 : MOV ECX,dword ptr [EDI + 0x4]
00a84867 : TEST ECX,ECX
00a84869 : JZ 0x00a84881
00a8486b : CMP byte ptr [EDI + 0x8],0x0
00a8486f : JZ 0x00a84881
00a84871 : PUSH 0x13
00a84873 : PUSH ECX
00a84874 : MOV EDI,EAX
00a84876 : CALL 0x00a0dd40
00a8487b : MOV EDI,dword ptr [0x017247d4]
00a84881 : MOV EAX,dword ptr [EBP + 0x8]
00a84884 : ADD EBX,0x4
00a84887 : CMP EBX,dword ptr [EAX + 0x44]
00a8488a : JNZ 0x00a846f0
00a84890 : MOVZX EAX,byte ptr [ESI + 0x18]
00a84894 : INC EAX
00a84895 : CDQ
00a84896 : MOV ECX,0x3
00a8489b : IDIV ECX
00a8489d : MOV byte ptr [ESI + 0x18],DL
00a848a0 : MOVZX EDX,DL
00a848a3 : SHL EDX,0xd
00a848a6 : LEA EAX,[EDX + ESI*0x1 + 0x122cb8]
00a848ad : MOV dword ptr [EBP + 0x8],EAX
00a848b0 : MOV dword ptr [EBP + -0x4],0x4
00a848b7 : TEST EAX,EAX
00a848b9 : JZ 0x00a848ca
00a848bb : XOR ECX,ECX
00a848bd : MOV word ptr [EAX],CX
00a848c0 : MOV byte ptr [EAX + 0x2],0x3b
00a848c4 : MOV byte ptr [EAX + 0x3],0x2f
00a848c8 : JMP 0x00a848cc
00a848ca : XOR EAX,EAX
00a848cc : MOV dword ptr [EBP + -0x4],0xffffffff
00a848d3 : MOV ECX,dword ptr [EDI + 0x4]
00a848d6 : TEST ECX,ECX
00a848d8 : JZ 0x00a848ea
00a848da : CMP byte ptr [EDI + 0x8],0x0
00a848de : JZ 0x00a848ea
00a848e0 : PUSH 0x4
00a848e2 : PUSH ECX
00a848e3 : MOV EDI,EAX
00a848e5 : CALL 0x00a0dd40
00a848ea : MOV ECX,dword ptr [EBP + -0xc]
00a848ed : MOV dword ptr FS:[0x0],ECX
00a848f4 : POP ECX
00a848f5 : POP EDI
00a848f6 : POP ESI
00a848f7 : POP EBX
00a848f8 : MOV ESP,EBP
00a848fa : POP EBP
00a848fb : RET 0x4

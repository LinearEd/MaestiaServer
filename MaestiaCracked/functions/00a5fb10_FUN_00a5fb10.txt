PROGRAM  : Maestia.exe
FUNCTION : FUN_00a5fb10
ENTRY    : 00a5fb10
BODY     : [[00a5fb10, 00a5fd04]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00a5fb10(uint param_1,undefined4 param_2,undefined2 param_3)

{
  uint uVar1;
  int iVar2;
  undefined4 uVar3;
  int iVar4;
  undefined4 in_stack_0000001c;
  uint in_stack_00000020;
  undefined1 local_44 [4];
  undefined2 local_40;
  undefined4 local_30;
  uint local_2c;
  int local_28 [2];
  int local_20;
  int local_1c;
  undefined4 local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  puStack_c = &LAB_00b3ba21;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_14 = param_1;
  local_8 = 0;
  FUN_0070c1f0(DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
  local_20 = 0;
  local_1c = 0;
  local_18 = 0;
  local_8 = CONCAT31(local_8._1_3_,1);
  FUN_00413630();
  iVar4 = 0;
  do {
    iVar2 = FUN_00403c70(&DAT_00bfe3b4,1);
    if (iVar2 != iVar4) {
      if (iVar2 == -1) {
        uVar3 = FUN_0040e420(&param_2,local_44);
        local_8._0_1_ = 2;
        FUN_00405ae0(uVar3);
        local_8 = CONCAT31(local_8._1_3_,1);
        if (7 < local_2c) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_2c = 7;
        local_30 = 0;
        local_40 = 0;
        break;
      }
      uVar3 = FUN_0040e420(&param_2,local_44);
      local_8._0_1_ = 3;
      FUN_00405ae0(uVar3);
      local_8 = CONCAT31(local_8._1_3_,1);
      if (7 < local_2c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_2c = 7;
      local_30 = 0;
      local_40 = 0;
    }
    iVar4 = FUN_00412db0(&DAT_00c00e50,1);
  } while (iVar2 != -1);
  uVar1 = (local_1c - local_20) / 0x1c;
  iVar4 = *(int *)(local_14 + 4);
  if (1 < uVar1) {
    local_14 = 1;
    iVar2 = local_20;
    if (1 < uVar1) {
      while( true ) {
        iVar2 = iVar2 + 0x1c;
        FUN_0044f270(iVar4 + 4,local_28,iVar2);
        if (local_28[0] == *(int *)(iVar4 + 0xc)) break;
        iVar4 = *(int *)(local_28[0] + 0x24);
        if ((iVar4 == 0) || (local_14 = local_14 + 1, uVar1 <= local_14)) goto LAB_00a5fc78;
      }
      iVar4 = 0;
    }
LAB_00a5fc78:
    iVar2 = local_20;
    if (local_20 != local_1c) {
      FUN_00405450(local_28[0]);
      local_1c = iVar2;
    }
  }
  local_8 = local_8 & 0xffffff00;
  if (local_20 != 0) {
    FUN_00405450(local_28[0]);
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_20 = 0;
  local_1c = 0;
  local_18 = 0;
  local_8 = 0xffffffff;
  if (in_stack_00000020 < 8) {
    ExceptionList = local_10;
    return iVar4;
  }
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
00a5fb10 : PUSH EBP
00a5fb11 : MOV EBP,ESP
00a5fb13 : PUSH -0x1
00a5fb15 : PUSH 0xb3ba21
00a5fb1a : MOV EAX,FS:[0x0]
00a5fb20 : PUSH EAX
00a5fb21 : SUB ESP,0x34
00a5fb24 : PUSH EBX
00a5fb25 : PUSH ESI
00a5fb26 : PUSH EDI
00a5fb27 : MOV EAX,[0x00d66fa0]
00a5fb2c : XOR EAX,EBP
00a5fb2e : PUSH EAX
00a5fb2f : LEA EAX,[EBP + -0xc]
00a5fb32 : MOV FS:[0x0],EAX
00a5fb38 : MOV EAX,dword ptr [EBP + 0x8]
00a5fb3b : MOV dword ptr [EBP + -0x10],EAX
00a5fb3e : XOR EBX,EBX
00a5fb40 : MOV dword ptr [EBP + -0x4],EBX
00a5fb43 : LEA ECX,[EBP + 0xc]
00a5fb46 : CALL 0x0070c1f0
00a5fb4b : MOV dword ptr [EBP + -0x1c],EBX
00a5fb4e : MOV dword ptr [EBP + -0x18],EBX
00a5fb51 : MOV dword ptr [EBP + -0x14],EBX
00a5fb54 : MOV byte ptr [EBP + -0x4],0x1
00a5fb58 : LEA ECX,[EBP + -0x20]
00a5fb5b : CALL 0x00413630
00a5fb60 : XOR ESI,ESI
00a5fb62 : PUSH 0x1
00a5fb64 : PUSH 0xbfe3b4
00a5fb69 : MOV EDX,ESI
00a5fb6b : LEA EAX,[EBP + 0xc]
00a5fb6e : CALL 0x00403c70
00a5fb73 : MOV EDI,EAX
00a5fb75 : CMP EDI,ESI
00a5fb77 : JZ 0x00a5fbc0
00a5fb79 : LEA EDX,[EBP + -0x40]
00a5fb7c : PUSH EDX
00a5fb7d : LEA EAX,[EBP + 0xc]
00a5fb80 : PUSH EAX
00a5fb81 : MOV EDX,ESI
00a5fb83 : CMP EDI,-0x1
00a5fb86 : JZ 0x00a5fbdb
00a5fb88 : MOV ECX,EDI
00a5fb8a : SUB ECX,ESI
00a5fb8c : CALL 0x0040e420
00a5fb91 : MOV byte ptr [EBP + -0x4],0x3
00a5fb95 : PUSH EAX
00a5fb96 : LEA EAX,[EBP + -0x20]
00a5fb99 : CALL 0x00405ae0
00a5fb9e : MOV byte ptr [EBP + -0x4],0x1
00a5fba2 : CMP dword ptr [EBP + -0x28],0x8
00a5fba6 : JC 0x00a5fbb0
00a5fba8 : MOV ECX,dword ptr [EBP + -0x3c]
00a5fbab : CALL 0x006f04e0
00a5fbb0 : XOR ECX,ECX
00a5fbb2 : MOV dword ptr [EBP + -0x28],0x7
00a5fbb9 : MOV dword ptr [EBP + -0x2c],EBX
00a5fbbc : MOV word ptr [EBP + -0x3c],CX
00a5fbc0 : PUSH 0x1
00a5fbc2 : LEA EDX,[EDI + 0x1]
00a5fbc5 : PUSH 0xc00e50
00a5fbca : LEA EAX,[EBP + 0xc]
00a5fbcd : CALL 0x00412db0
00a5fbd2 : MOV ESI,EAX
00a5fbd4 : CMP EDI,-0x1
00a5fbd7 : JNZ 0x00a5fb62
00a5fbd9 : JMP 0x00a5fc12
00a5fbdb : OR ECX,0xffffffff
00a5fbde : CALL 0x0040e420
00a5fbe3 : MOV byte ptr [EBP + -0x4],0x2
00a5fbe7 : PUSH EAX
00a5fbe8 : LEA EAX,[EBP + -0x20]
00a5fbeb : CALL 0x00405ae0
00a5fbf0 : MOV byte ptr [EBP + -0x4],0x1
00a5fbf4 : CMP dword ptr [EBP + -0x28],0x8
00a5fbf8 : JC 0x00a5fc02
00a5fbfa : MOV ECX,dword ptr [EBP + -0x3c]
00a5fbfd : CALL 0x006f04e0
00a5fc02 : XOR ECX,ECX
00a5fc04 : MOV dword ptr [EBP + -0x28],0x7
00a5fc0b : MOV dword ptr [EBP + -0x2c],EBX
00a5fc0e : MOV word ptr [EBP + -0x3c],CX
00a5fc12 : MOV ECX,dword ptr [EBP + -0x18]
00a5fc15 : MOV EDI,dword ptr [EBP + -0x1c]
00a5fc18 : SUB ECX,EDI
00a5fc1a : MOV EAX,0x92492493
00a5fc1f : IMUL ECX
00a5fc21 : ADD EDX,ECX
00a5fc23 : SAR EDX,0x4
00a5fc26 : MOV ESI,EDX
00a5fc28 : SHR ESI,0x1f
00a5fc2b : ADD ESI,EDX
00a5fc2d : MOV EDX,dword ptr [EBP + -0x10]
00a5fc30 : MOV EBX,dword ptr [EDX + 0x4]
00a5fc33 : CMP ESI,0x1
00a5fc36 : JBE 0x00a5fc96
00a5fc38 : ADD EDI,0x1c
00a5fc3b : MOV dword ptr [EBP + -0x10],0x1
00a5fc42 : CMP ESI,0x1
00a5fc45 : JBE 0x00a5fc78
00a5fc47 : PUSH EDI
00a5fc48 : LEA EAX,[EBP + -0x24]
00a5fc4b : PUSH EAX
00a5fc4c : LEA ECX,[EBX + 0x4]
00a5fc4f : PUSH ECX
00a5fc50 : CALL 0x0044f270
00a5fc55 : MOV EBX,dword ptr [EBX + 0xc]
00a5fc58 : MOV EAX,dword ptr [EBP + -0x24]
00a5fc5b : CMP EAX,EBX
00a5fc5d : JZ 0x00a5fc76
00a5fc5f : MOV EBX,dword ptr [EAX + 0x24]
00a5fc62 : TEST EBX,EBX
00a5fc64 : JZ 0x00a5fc78
00a5fc66 : MOV EAX,dword ptr [EBP + -0x10]
00a5fc69 : INC EAX
00a5fc6a : ADD EDI,0x1c
00a5fc6d : MOV dword ptr [EBP + -0x10],EAX
00a5fc70 : CMP EAX,ESI
00a5fc72 : JC 0x00a5fc47
00a5fc74 : JMP 0x00a5fc78
00a5fc76 : XOR EBX,EBX
00a5fc78 : MOV EDX,dword ptr [EBP + -0x18]
00a5fc7b : CMP dword ptr [EBP + -0x1c],EDX
00a5fc7e : JZ 0x00a5fc96
00a5fc80 : MOV EAX,dword ptr [EBP + -0x24]
00a5fc83 : MOV ESI,dword ptr [EBP + -0x1c]
00a5fc86 : PUSH EAX
00a5fc87 : MOV EDI,EDX
00a5fc89 : MOV EAX,ESI
00a5fc8b : CALL 0x00405450
00a5fc90 : ADD ESP,0x4
00a5fc93 : MOV dword ptr [EBP + -0x18],ESI
00a5fc96 : MOV byte ptr [EBP + -0x4],0x0
00a5fc9a : CMP dword ptr [EBP + -0x1c],0x0
00a5fc9e : JZ 0x00a5fcbb
00a5fca0 : MOV ECX,dword ptr [EBP + -0x24]
00a5fca3 : MOV ESI,dword ptr [EBP + -0x1c]
00a5fca6 : MOV EDI,dword ptr [EBP + -0x18]
00a5fca9 : PUSH ECX
00a5fcaa : MOV EAX,ESI
00a5fcac : CALL 0x00405450
00a5fcb1 : ADD ESP,0x4
00a5fcb4 : MOV ECX,ESI
00a5fcb6 : CALL 0x006f04e0
00a5fcbb : XOR EAX,EAX
00a5fcbd : MOV dword ptr [EBP + -0x1c],EAX
00a5fcc0 : MOV dword ptr [EBP + -0x18],EAX
00a5fcc3 : MOV dword ptr [EBP + -0x14],EAX
00a5fcc6 : MOV dword ptr [EBP + -0x4],0xffffffff
00a5fccd : CMP dword ptr [EBP + 0x24],0x8
00a5fcd1 : JC 0x00a5fcdb
00a5fcd3 : MOV ECX,dword ptr [EBP + 0x10]
00a5fcd6 : CALL 0x006f04e0
00a5fcdb : XOR EDX,EDX
00a5fcdd : MOV dword ptr [EBP + 0x24],0x7
00a5fce4 : MOV dword ptr [EBP + 0x20],0x0
00a5fceb : MOV word ptr [EBP + 0x10],DX
00a5fcef : MOV EAX,EBX
00a5fcf1 : MOV ECX,dword ptr [EBP + -0xc]
00a5fcf4 : MOV dword ptr FS:[0x0],ECX
00a5fcfb : POP ECX
00a5fcfc : POP EDI
00a5fcfd : POP ESI
00a5fcfe : POP EBX
00a5fcff : MOV ESP,EBP
00a5fd01 : POP EBP
00a5fd02 : RET 0x20

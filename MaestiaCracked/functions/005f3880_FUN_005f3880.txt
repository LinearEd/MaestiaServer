PROGRAM  : Maestia.exe
FUNCTION : FUN_005f3880
ENTRY    : 005f3880
BODY     : [[005f3880, 005f3a16]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_005f3880(int *param_1)

{
  ushort uVar1;
  ushort uVar2;
  undefined2 uVar3;
  int iVar4;
  int *piVar5;
  undefined4 *puVar6;
  bool bVar7;
  int in_ECX;
  int iVar8;
  bool bVar9;
  undefined4 local_8;
  undefined4 local_4;
  
  iVar4 = param_1[7];
  iVar8 = param_1[4];
  bVar7 = true;
  if (iVar8 == iVar4 + 8) {
    iVar8 = param_1[3];
    bVar7 = false;
    if (iVar8 == iVar4 + 8) {
      return 0;
    }
  }
  piVar5 = *(int **)(iVar8 + 8);
  puVar6 = (undefined4 *)param_1[2];
  FUN_005f3670(param_1);
  uVar1 = *(ushort *)((int)param_1 + 0x22);
  uVar2 = *(ushort *)(param_1 + 9);
  *(int *)(*param_1 + 4) = param_1[1];
  *(int *)param_1[1] = *param_1;
  *(int *)(in_ECX + 0x38) = *(int *)(in_ECX + 0x38) + -1;
  if ((*(ushort *)(param_1 + 8) & 0x4000) == 0) {
    *(int *)(param_1[5] + 0x18) = param_1[6];
    *(int *)(param_1[6] + 0x14) = param_1[5];
  }
  *(int *)(param_1[3] + 0x10) = param_1[4];
  *(int *)(param_1[4] + 0xc) = param_1[3];
  *param_1 = *(int *)(in_ECX + 0x28);
  *(int **)(in_ECX + 0x28) = param_1;
  if (((*piVar5 == 0) && (piVar5[5] == 0)) &&
     (*(short *)((int)piVar5 + 0x1e) == *(short *)(iVar4 + 4))) {
    if (bVar7) {
      bVar9 = (uint)uVar2 + (uint)uVar1 == (uint)*(ushort *)(piVar5 + 6);
    }
    else {
      bVar9 = (uint)*(ushort *)(piVar5 + 7) + (uint)*(ushort *)(piVar5 + 6) == (uint)uVar1;
    }
    if (bVar9) {
      *puVar6 = *(undefined4 *)(in_ECX + 0x70);
      *(undefined4 **)(in_ECX + 0x70) = puVar6;
      if (bVar7) {
        *(ushort *)(piVar5 + 6) = uVar1;
      }
      *(ushort *)(piVar5 + 7) = (short)piVar5[7] + uVar2;
      goto LAB_005f39c3;
    }
  }
  puVar6[4] = piVar5;
  puVar6[5] = 0;
  puVar6[3] = iVar8;
  uVar3 = *(undefined2 *)(iVar4 + 4);
  local_8 = CONCAT22(*(undefined2 *)(iVar4 + 2),uVar1);
  puVar6[6] = local_8;
  local_4 = CONCAT22(uVar3,uVar2);
  puVar6[7] = local_4;
  *(undefined4 **)(iVar8 + 8) = puVar6;
LAB_005f39c3:
  if (bVar7) {
    *(ushort *)(iVar8 + 0x22) = uVar1;
  }
  *(short *)(iVar8 + 0x24) = *(short *)(iVar8 + 0x24) + uVar2;
  if ((*(ushort *)(iVar8 + 0x20) & 0x4000) != 0) {
    *(ushort *)(iVar8 + 0x20) = *(ushort *)(iVar8 + 0x20) & 0xbfff;
    *(undefined2 *)(iVar8 + 0x26) = 0;
    *(undefined4 *)(iVar8 + 0x18) = *(undefined4 *)(in_ECX + 0x54);
    *(int *)(iVar8 + 0x14) = in_ECX + 0x3c;
    *(int *)(*(int *)(in_ECX + 0x54) + 0x14) = iVar8;
    *(int *)(in_ECX + 0x54) = iVar8;
  }
  return iVar8;
}



============================================================
DISASSEMBLY
============================================================
005f3880 : SUB ESP,0x14
005f3883 : PUSH ESI
005f3884 : MOV ESI,dword ptr [ESP + 0x1c]
005f3888 : MOV EAX,dword ptr [ESI + 0x1c]
005f388b : PUSH EDI
005f388c : MOV EDI,dword ptr [ESI + 0x10]
005f388f : MOV dword ptr [ESP + 0x10],EAX
005f3893 : ADD EAX,0x8
005f3896 : MOV dword ptr [ESP + 0x14],ECX
005f389a : MOV byte ptr [ESP + 0x20],0x1
005f389f : CMP EDI,EAX
005f38a1 : JNZ 0x005f38b3
005f38a3 : MOV EDI,dword ptr [ESI + 0xc]
005f38a6 : MOV byte ptr [ESP + 0x20],0x0
005f38ab : CMP EDI,EAX
005f38ad : JZ 0x005f3a0d
005f38b3 : PUSH EBX
005f38b4 : MOV EBX,dword ptr [EDI + 0x8]
005f38b7 : PUSH EBP
005f38b8 : MOV EBP,dword ptr [ESI + 0x8]
005f38bb : PUSH ESI
005f38bc : CALL 0x005f3670
005f38c1 : MOVZX EAX,word ptr [ESI + 0x22]
005f38c5 : MOVZX ECX,word ptr [ESI + 0x24]
005f38c9 : MOV EDX,dword ptr [ESI]
005f38cb : MOV dword ptr [ESP + 0x10],EAX
005f38cf : MOV EAX,dword ptr [ESI + 0x4]
005f38d2 : MOV dword ptr [EDX + 0x4],EAX
005f38d5 : MOV EDX,dword ptr [ESI]
005f38d7 : MOV dword ptr [ESP + 0x14],ECX
005f38db : MOV ECX,dword ptr [ESI + 0x4]
005f38de : MOV dword ptr [ECX],EDX
005f38e0 : MOV ECX,dword ptr [ESP + 0x1c]
005f38e4 : DEC dword ptr [ECX + 0x38]
005f38e7 : MOV EAX,0x4000
005f38ec : TEST word ptr [ESI + 0x20],AX
005f38f0 : JNZ 0x005f3904
005f38f2 : MOV EDX,dword ptr [ESI + 0x14]
005f38f5 : MOV EAX,dword ptr [ESI + 0x18]
005f38f8 : MOV dword ptr [EDX + 0x18],EAX
005f38fb : MOV EDX,dword ptr [ESI + 0x18]
005f38fe : MOV EAX,dword ptr [ESI + 0x14]
005f3901 : MOV dword ptr [EDX + 0x14],EAX
005f3904 : MOV EDX,dword ptr [ESI + 0xc]
005f3907 : MOV EAX,dword ptr [ESI + 0x10]
005f390a : MOV dword ptr [EDX + 0x10],EAX
005f390d : MOV EDX,dword ptr [ESI + 0x10]
005f3910 : MOV EAX,dword ptr [ESI + 0xc]
005f3913 : MOV dword ptr [EDX + 0xc],EAX
005f3916 : MOV EDX,dword ptr [ECX + 0x28]
005f3919 : MOV dword ptr [ESI],EDX
005f391b : MOV dword ptr [ECX + 0x28],ESI
005f391e : CMP dword ptr [EBX],0x0
005f3921 : JNZ 0x005f397d
005f3923 : CMP dword ptr [EBX + 0x14],0x0
005f3927 : JNZ 0x005f397d
005f3929 : MOV AX,word ptr [EBX + 0x1e]
005f392d : MOV EDX,dword ptr [ESP + 0x18]
005f3931 : MOV ESI,dword ptr [ESP + 0x10]
005f3935 : CMP AX,word ptr [EDX + 0x4]
005f3939 : JNZ 0x005f3981
005f393b : CMP byte ptr [ESP + 0x28],0x0
005f3940 : MOVZX EDX,word ptr [EBX + 0x18]
005f3944 : JZ 0x005f3950
005f3946 : MOV EAX,dword ptr [ESP + 0x14]
005f394a : ADD EAX,ESI
005f394c : CMP EAX,EDX
005f394e : JMP 0x005f3958
005f3950 : MOVZX EAX,word ptr [EBX + 0x1c]
005f3954 : ADD EAX,EDX
005f3956 : CMP EAX,ESI
005f3958 : SETZ AL
005f395b : TEST AL,AL
005f395d : JZ 0x005f3981
005f395f : CMP byte ptr [ESP + 0x28],0x0
005f3964 : MOV EAX,dword ptr [ECX + 0x70]
005f3967 : MOV dword ptr [EBP],EAX
005f396a : MOV dword ptr [ECX + 0x70],EBP
005f396d : JZ 0x005f3973
005f396f : MOV word ptr [EBX + 0x18],SI
005f3973 : MOV EDX,dword ptr [ESP + 0x14]
005f3977 : ADD word ptr [EBX + 0x1c],DX
005f397b : JMP 0x005f39c3
005f397d : MOV ESI,dword ptr [ESP + 0x10]
005f3981 : MOV EAX,dword ptr [ESP + 0x18]
005f3985 : MOV dword ptr [EBP + 0x10],EBX
005f3988 : MOV dword ptr [EBP + 0x14],0x0
005f398f : MOV dword ptr [EBP + 0xc],EDI
005f3992 : MOV DX,word ptr [EAX + 0x2]
005f3996 : MOV AX,word ptr [EAX + 0x4]
005f399a : MOV word ptr [ESP + 0x1e],DX
005f399f : MOV EDX,dword ptr [ESP + 0x14]
005f39a3 : MOV word ptr [ESP + 0x22],AX
005f39a8 : MOV word ptr [ESP + 0x1c],SI
005f39ad : MOV EAX,dword ptr [ESP + 0x1c]
005f39b1 : MOV dword ptr [EBP + 0x18],EAX
005f39b4 : MOV word ptr [ESP + 0x20],DX
005f39b9 : MOV EAX,dword ptr [ESP + 0x20]
005f39bd : MOV dword ptr [EBP + 0x1c],EAX
005f39c0 : MOV dword ptr [EDI + 0x8],EBP
005f39c3 : CMP byte ptr [ESP + 0x28],0x0
005f39c8 : POP EBP
005f39c9 : POP EBX
005f39ca : JZ 0x005f39d0
005f39cc : MOV word ptr [EDI + 0x22],SI
005f39d0 : MOVZX EAX,word ptr [EDI + 0x20]
005f39d4 : ADD word ptr [EDI + 0x24],DX
005f39d8 : TEST EAX,0x4000
005f39dd : JZ 0x005f3a03
005f39df : XOR EDX,EDX
005f39e1 : AND EAX,0xbfff
005f39e6 : MOV word ptr [EDI + 0x20],AX
005f39ea : LEA EAX,[ECX + 0x3c]
005f39ed : MOV word ptr [EDI + 0x26],DX
005f39f1 : MOV ECX,dword ptr [EAX + 0x18]
005f39f4 : MOV dword ptr [EDI + 0x18],ECX
005f39f7 : MOV dword ptr [EDI + 0x14],EAX
005f39fa : MOV EDX,dword ptr [EAX + 0x18]
005f39fd : MOV dword ptr [EDX + 0x14],EDI
005f3a00 : MOV dword ptr [EAX + 0x18],EDI
005f3a03 : MOV EAX,EDI
005f3a05 : POP EDI
005f3a06 : POP ESI
005f3a07 : ADD ESP,0x14
005f3a0a : RET 0x4
005f3a0d : POP EDI
005f3a0e : XOR EAX,EAX
005f3a10 : POP ESI
005f3a11 : ADD ESP,0x14
005f3a14 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_00690950
ENTRY    : 00690950
BODY     : [[00690950, 00690ab0]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00690950(void)

{
  bool bVar1;
  bool bVar2;
  bool bVar3;
  int iVar4;
  int unaff_EBX;
  uint uVar5;
  int unaff_EDI;
  int local_10;
  int local_8;
  uint local_4;
  
  uVar5 = 0;
  bVar1 = false;
  bVar2 = false;
  bVar3 = false;
  if ((*(ushort *)(unaff_EBX + 4) != 0) &&
     ((uint)*(ushort *)(unaff_EBX + 4) * 0x10 + *(int *)(unaff_EBX + 0xc) + 0xc <=
      *(uint *)(unaff_EDI + 4))) {
    iVar4 = FUN_006877c0();
    if (iVar4 != 0) {
      return iVar4;
    }
    if (*(short *)(unaff_EBX + 4) != 0) {
      do {
        iVar4 = FUN_006889e0();
        if (iVar4 != 0) {
          return iVar4;
        }
        if (((*(uint *)(unaff_EDI + 4) < local_4 + local_8) && (local_10 != 0x676c7978)) &&
           (local_10 != 0x6c6f6378)) {
          return 2;
        }
        if ((local_10 == 0x68656164) || (local_10 == 0x62686564)) {
          bVar1 = true;
          if (local_4 < 0x36) {
            return 2;
          }
          iVar4 = FUN_006877c0();
          if (iVar4 != 0) {
            return iVar4;
          }
          iVar4 = FUN_00687bd0();
          if (iVar4 != 0x5f0f3cf5) {
            return 2;
          }
          iVar4 = FUN_006877c0();
          if (iVar4 != 0) {
            return iVar4;
          }
        }
        else if (local_10 == 0x53494e47) {
          bVar2 = true;
        }
        else if (local_10 == 0x4d455441) {
          bVar3 = true;
        }
        uVar5 = uVar5 + 1;
      } while (uVar5 < *(ushort *)(unaff_EBX + 4));
      if ((bVar1) || ((bVar2 && (bVar3)))) {
        return 0;
      }
    }
  }
  return 2;
}



============================================================
DISASSEMBLY
============================================================
00690950 : SUB ESP,0x20
00690953 : MOVZX EAX,word ptr [EBX + 0x4]
00690957 : PUSH EBP
00690958 : PUSH ESI
00690959 : MOV ESI,dword ptr [EBX + 0xc]
0069095c : XOR EBP,EBP
0069095e : ADD ESI,0xc
00690961 : MOV dword ptr [ESP + 0xc],EBP
00690965 : MOV dword ptr [ESP + 0x10],EBP
00690969 : MOV dword ptr [ESP + 0x14],EBP
0069096d : CMP AX,BP
00690970 : JZ 0x00690aa6
00690976 : MOVZX EAX,AX
00690979 : SHL EAX,0x4
0069097c : ADD EAX,ESI
0069097e : CMP EAX,dword ptr [EDI + 0x4]
00690981 : JA 0x00690aa6
00690987 : PUSH ESI
00690988 : PUSH EDI
00690989 : CALL 0x006877c0
0069098e : ADD ESP,0x8
00690991 : MOV dword ptr [ESP + 0x8],EAX
00690995 : CMP EAX,EBP
00690997 : JNZ 0x00690aab
0069099d : XOR ECX,ECX
0069099f : CMP CX,word ptr [EBX + 0x4]
006909a3 : JNC 0x00690aa6
006909a9 : ADD ESI,0x10
006909ac : LEA ESP,[ESP]
006909b0 : LEA EDX,[ESP + 0x18]
006909b4 : PUSH EDX
006909b5 : PUSH 0xbd9358
006909ba : PUSH EDI
006909bb : CALL 0x006889e0
006909c0 : ADD ESP,0xc
006909c3 : MOV dword ptr [ESP + 0x8],EAX
006909c7 : TEST EAX,EAX
006909c9 : JNZ 0x00690aab
006909cf : MOV ECX,dword ptr [ESP + 0x24]
006909d3 : MOV EDX,dword ptr [ESP + 0x20]
006909d7 : LEA EAX,[ECX + EDX*0x1]
006909da : CMP EAX,dword ptr [EDI + 0x4]
006909dd : MOV EAX,dword ptr [ESP + 0x18]
006909e1 : JBE 0x006909f5
006909e3 : CMP EAX,0x676c7978
006909e8 : JZ 0x006909f5
006909ea : CMP EAX,0x6c6f6378
006909ef : JNZ 0x00690aa6
006909f5 : CMP EAX,0x68656164
006909fa : JZ 0x00690a25
006909fc : CMP EAX,0x62686564
00690a01 : JZ 0x00690a25
00690a03 : CMP EAX,0x53494e47
00690a08 : JNZ 0x00690a14
00690a0a : MOV dword ptr [ESP + 0x10],0x1
00690a12 : JMP 0x00690a79
00690a14 : CMP EAX,0x4d455441
00690a19 : JNZ 0x00690a79
00690a1b : MOV dword ptr [ESP + 0x14],0x1
00690a23 : JMP 0x00690a79
00690a25 : MOV dword ptr [ESP + 0xc],0x1
00690a2d : CMP ECX,0x36
00690a30 : JC 0x00690aa6
00690a32 : ADD EDX,0xc
00690a35 : PUSH EDX
00690a36 : PUSH EDI
00690a37 : CALL 0x006877c0
00690a3c : ADD ESP,0x8
00690a3f : MOV dword ptr [ESP + 0x8],EAX
00690a43 : TEST EAX,EAX
00690a45 : JNZ 0x00690aab
00690a47 : LEA ECX,[ESP + 0x8]
00690a4b : PUSH ECX
00690a4c : PUSH EDI
00690a4d : CALL 0x00687bd0
00690a52 : MOV ECX,EAX
00690a54 : MOV EAX,dword ptr [ESP + 0x10]
00690a58 : ADD ESP,0x8
00690a5b : TEST EAX,EAX
00690a5d : JNZ 0x00690aab
00690a5f : CMP ECX,0x5f0f3cf5
00690a65 : JNZ 0x00690aa6
00690a67 : PUSH ESI
00690a68 : PUSH EDI
00690a69 : CALL 0x006877c0
00690a6e : ADD ESP,0x8
00690a71 : MOV dword ptr [ESP + 0x8],EAX
00690a75 : TEST EAX,EAX
00690a77 : JNZ 0x00690aab
00690a79 : MOVZX EDX,word ptr [EBX + 0x4]
00690a7d : INC EBP
00690a7e : ADD ESI,0x10
00690a81 : CMP EBP,EDX
00690a83 : JC 0x006909b0
00690a89 : CMP dword ptr [ESP + 0xc],0x0
00690a8e : JNZ 0x00690a9e
00690a90 : CMP dword ptr [ESP + 0x10],0x0
00690a95 : JZ 0x00690aa6
00690a97 : CMP dword ptr [ESP + 0x14],0x0
00690a9c : JZ 0x00690aa6
00690a9e : POP ESI
00690a9f : XOR EAX,EAX
00690aa1 : POP EBP
00690aa2 : ADD ESP,0x20
00690aa5 : RET
00690aa6 : MOV EAX,0x2
00690aab : POP ESI
00690aac : POP EBP
00690aad : ADD ESP,0x20
00690ab0 : RET

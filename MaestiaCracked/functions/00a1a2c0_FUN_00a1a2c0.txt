PROGRAM  : Maestia.exe
FUNCTION : FUN_00a1a2c0
ENTRY    : 00a1a2c0
BODY     : [[00a1a2c0, 00a1a393]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a1a2c0(undefined4 param_1,char param_2)

{
  int *piVar1;
  int iVar2;
  int *piVar3;
  uint uVar4;
  int unaff_ESI;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b0f81e;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(int *)(unaff_ESI + 0xac) != 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)(unaff_ESI + 0x1c));
    local_8 = 0;
    piVar1 = *(int **)(unaff_ESI + 0xe4);
    iVar2 = *(int *)(*(int *)(unaff_ESI + 0xac) + 4);
    piVar3 = (int *)*piVar1;
    while (piVar3 != piVar1) {
      piVar1 = (int *)piVar3[4];
      if (piVar1 != (int *)0x0) {
        if (param_2 == '\0') {
          if (piVar1[0x5b4] != iVar2) {
            (**(code **)(*piVar1 + 0x2d8))(param_1,uVar4);
          }
        }
        else if (piVar1[0x5b4] == iVar2) {
          (**(code **)(*piVar1 + 0x2d8))(param_1);
        }
      }
      FUN_00416210();
      piVar1 = *(int **)(unaff_ESI + 0xe4);
    }
    local_8 = 0xffffffff;
    LeaveCriticalSection((LPCRITICAL_SECTION)(unaff_ESI + 0x1c));
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00a1a2c0 : PUSH EBP
00a1a2c1 : MOV EBP,ESP
00a1a2c3 : PUSH -0x1
00a1a2c5 : PUSH 0xb0f81e
00a1a2ca : MOV EAX,FS:[0x0]
00a1a2d0 : PUSH EAX
00a1a2d1 : SUB ESP,0x8
00a1a2d4 : PUSH EBX
00a1a2d5 : PUSH EDI
00a1a2d6 : MOV EAX,[0x00d66fa0]
00a1a2db : XOR EAX,EBP
00a1a2dd : PUSH EAX
00a1a2de : LEA EAX,[EBP + -0xc]
00a1a2e1 : MOV FS:[0x0],EAX
00a1a2e7 : CMP dword ptr [ESI + 0xac],0x0
00a1a2ee : JZ 0x00a1a381
00a1a2f4 : LEA EAX,[ESI + 0x18]
00a1a2f7 : LEA EBX,[EAX + 0x4]
00a1a2fa : PUSH EBX
00a1a2fb : MOV dword ptr [EBP + -0x14],EAX
00a1a2fe : CALL dword ptr [0x00b85118]
00a1a304 : MOV dword ptr [EBP + -0x4],0x0
00a1a30b : MOV EAX,dword ptr [ESI + 0xac]
00a1a311 : MOV ECX,dword ptr [ESI + 0xe4]
00a1a317 : MOV EDI,dword ptr [EAX + 0x4]
00a1a31a : MOV EAX,dword ptr [ECX]
00a1a31c : MOV dword ptr [EBP + -0x10],EAX
00a1a31f : CMP EAX,ECX
00a1a321 : JZ 0x00a1a373
00a1a323 : MOV ECX,dword ptr [EAX + 0x10]
00a1a326 : TEST ECX,ECX
00a1a328 : JZ 0x00a1a35e
00a1a32a : CMP byte ptr [EBP + 0xc],0x0
00a1a32e : JZ 0x00a1a348
00a1a330 : CMP dword ptr [ECX + 0x16d0],EDI
00a1a336 : JNZ 0x00a1a35e
00a1a338 : MOV EDX,dword ptr [ECX]
00a1a33a : MOV EAX,dword ptr [EBP + 0x8]
00a1a33d : MOV EDX,dword ptr [EDX + 0x2d8]
00a1a343 : PUSH EAX
00a1a344 : CALL EDX
00a1a346 : JMP 0x00a1a35e
00a1a348 : CMP dword ptr [ECX + 0x16d0],EDI
00a1a34e : JZ 0x00a1a35e
00a1a350 : MOV EAX,dword ptr [ECX]
00a1a352 : MOV EDX,dword ptr [EBP + 0x8]
00a1a355 : MOV EAX,dword ptr [EAX + 0x2d8]
00a1a35b : PUSH EDX
00a1a35c : CALL EAX
00a1a35e : LEA EDX,[EBP + -0x10]
00a1a361 : CALL 0x00416210
00a1a366 : MOV ECX,dword ptr [ESI + 0xe4]
00a1a36c : MOV EAX,dword ptr [EBP + -0x10]
00a1a36f : CMP EAX,ECX
00a1a371 : JNZ 0x00a1a323
00a1a373 : MOV dword ptr [EBP + -0x4],0xffffffff
00a1a37a : PUSH EBX
00a1a37b : CALL dword ptr [0x00b8511c]
00a1a381 : MOV ECX,dword ptr [EBP + -0xc]
00a1a384 : MOV dword ptr FS:[0x0],ECX
00a1a38b : POP ECX
00a1a38c : POP EDI
00a1a38d : POP EBX
00a1a38e : MOV ESP,EBP
00a1a390 : POP EBP
00a1a391 : RET 0x8

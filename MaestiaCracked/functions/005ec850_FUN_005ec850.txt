PROGRAM  : Maestia.exe
FUNCTION : FUN_005ec850
ENTRY    : 005ec850
BODY     : [[005ec850, 005eca05]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005ec850(int *param_1)

{
  int *piVar1;
  uint uVar2;
  int *piVar3;
  int iVar4;
  int iVar5;
  int *piVar6;
  char cVar7;
  undefined4 uVar8;
  int *in_ECX;
  int local_30;
  uint local_2c;
  GMatrix2D aGStack_18 [24];
  
  piVar6 = param_1;
  piVar1 = *(int **)(*param_1 + 0xc);
  uVar2 = in_ECX[1];
  local_30 = 0;
  local_2c = 0;
  param_1 = (int *)0x0;
  if (uVar2 != 0) {
    do {
      piVar3 = *(int **)(*in_ECX + (int)param_1 * 4);
      if ((((-2 < piVar3[5]) && (cVar7 = (**(code **)(*piVar3 + 8))(), cVar7 != '\0')) &&
          (cVar7 = (**(code **)(*piVar3 + 0xa0))(), cVar7 == '\0')) &&
         ((*(byte *)((int)piVar3 + 0x66) & 2) == 0)) {
        if ((local_30 != 0) && ((int)local_2c < piVar3[5])) {
          local_30 = local_30 + -1;
          FUN_005ec4e0();
        }
        if (((uint)piVar6[0x15] < (uint)piVar6[0x14]) && (piVar6[0x13] == 0)) {
          iVar4 = piVar6[0x10];
          iVar5 = piVar6[0x11];
          piVar6[0x13] = 1;
          do {
            if ((uint)piVar6[0x14] < 0x41) {
              GMatrix2D::SetIdentity(aGStack_18);
              FUN_0051cdf0(aGStack_18);
              piVar6[0x10] = (int)aGStack_18;
              (**(code **)(*piVar1 + 0x6c))(2);
              (**(code **)(*(int *)piVar6[piVar6[0x14] + 0x15] + 0x60))(piVar6);
              (**(code **)(*piVar1 + 0x70))();
              piVar6[piVar6[0x14] + 0x15] = 0;
            }
            piVar6[0x14] = piVar6[0x14] + -1;
          } while ((uint)piVar6[0x15] < (uint)piVar6[0x14]);
          piVar6[0x13] = piVar6[0x13] + -1;
          piVar6[0x10] = iVar4;
          piVar6[0x11] = iVar5;
        }
        if (((short)piVar3[0x19] == 0) || (piVar6[0x13] != 0)) {
          iVar4 = *piVar1;
          uVar8 = (**(code **)(*piVar3 + 0xc))();
          (**(code **)(iVar4 + 0x2c))(uVar8);
          (**(code **)(*piVar3 + 0x60))(piVar6);
          (**(code **)(*piVar1 + 0x30))();
        }
        else {
          FUN_005ec460(piVar3);
          local_2c = (uint)*(ushort *)(piVar3 + 0x19);
          local_30 = local_30 + 1;
        }
      }
      param_1 = (int *)((int)param_1 + 1);
    } while (param_1 < uVar2);
    for (; local_30 != 0; local_30 = local_30 + -1) {
      FUN_005ec4e0();
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005ec850 : SUB ESP,0x30
005ec853 : PUSH ESI
005ec854 : MOV ESI,dword ptr [ESP + 0x38]
005ec858 : MOV EDX,dword ptr [ESI]
005ec85a : XOR EAX,EAX
005ec85c : PUSH EDI
005ec85d : MOV EDI,dword ptr [EDX + 0xc]
005ec860 : MOV EDX,dword ptr [ECX + 0x4]
005ec863 : MOV dword ptr [ESP + 0x10],ECX
005ec867 : MOV dword ptr [ESP + 0x8],EAX
005ec86b : MOV dword ptr [ESP + 0xc],EAX
005ec86f : MOV dword ptr [ESP + 0x3c],EAX
005ec873 : MOV dword ptr [ESP + 0x1c],EDX
005ec877 : CMP EDX,EAX
005ec879 : JBE 0x005ec9fe
005ec87f : PUSH EBX
005ec880 : PUSH EBP
005ec881 : JMP 0x005ec887
005ec883 : MOV ECX,dword ptr [ESP + 0x18]
005ec887 : MOV ECX,dword ptr [ECX]
005ec889 : MOV EBX,dword ptr [ECX + EAX*0x4]
005ec88c : OR EBP,0xffffffff
005ec88f : CMP dword ptr [EBX + 0x14],EBP
005ec892 : JL 0x005ec9d4
005ec898 : MOV EDX,dword ptr [EBX]
005ec89a : MOV EAX,dword ptr [EDX + 0x8]
005ec89d : MOV ECX,EBX
005ec89f : CALL EAX
005ec8a1 : TEST AL,AL
005ec8a3 : JZ 0x005ec9d4
005ec8a9 : MOV EDX,dword ptr [EBX]
005ec8ab : MOV EAX,dword ptr [EDX + 0xa0]
005ec8b1 : MOV ECX,EBX
005ec8b3 : CALL EAX
005ec8b5 : TEST AL,AL
005ec8b7 : JNZ 0x005ec9d4
005ec8bd : TEST byte ptr [EBX + 0x66],0x2
005ec8c1 : JNZ 0x005ec9d4
005ec8c7 : CMP dword ptr [ESP + 0x10],0x0
005ec8cc : JZ 0x005ec8e2
005ec8ce : MOV ECX,dword ptr [ESP + 0x14]
005ec8d2 : CMP dword ptr [EBX + 0x14],ECX
005ec8d5 : JLE 0x005ec8e2
005ec8d7 : DEC dword ptr [ESP + 0x10]
005ec8db : MOV ECX,ESI
005ec8dd : CALL 0x005ec4e0
005ec8e2 : MOV EDX,dword ptr [ESI + 0x50]
005ec8e5 : CMP EDX,dword ptr [ESI + 0x54]
005ec8e8 : JBE 0x005ec988
005ec8ee : CMP dword ptr [ESI + 0x4c],0x0
005ec8f2 : JNZ 0x005ec988
005ec8f8 : MOV EAX,dword ptr [ESI + 0x40]
005ec8fb : MOV ECX,dword ptr [ESI + 0x44]
005ec8fe : MOV dword ptr [ESP + 0x1c],EAX
005ec902 : MOV dword ptr [ESP + 0x20],ECX
005ec906 : MOV dword ptr [ESI + 0x4c],0x1
005ec90d : LEA ECX,[ECX]
005ec910 : MOV EAX,dword ptr [ESI + 0x50]
005ec913 : CMP EAX,0x40
005ec916 : JA 0x005ec96c
005ec918 : MOV EDX,dword ptr [ESI + EAX*0x4 + 0x54]
005ec91c : MOV EBP,dword ptr [EDX + 0x20]
005ec91f : LEA ECX,[ESP + 0x28]
005ec923 : CALL 0x00522b80
005ec928 : LEA EAX,[ESP + 0x28]
005ec92c : PUSH EAX
005ec92d : MOV ECX,EBP
005ec92f : CALL 0x0051cdf0
005ec934 : LEA ECX,[ESP + 0x28]
005ec938 : MOV dword ptr [ESI + 0x40],ECX
005ec93b : MOV EDX,dword ptr [EDI]
005ec93d : MOV EAX,dword ptr [EDX + 0x6c]
005ec940 : PUSH 0x2
005ec942 : MOV ECX,EDI
005ec944 : CALL EAX
005ec946 : MOV ECX,dword ptr [ESI + 0x50]
005ec949 : MOV ECX,dword ptr [ESI + ECX*0x4 + 0x54]
005ec94d : MOV EDX,dword ptr [ECX]
005ec94f : MOV EAX,dword ptr [EDX + 0x60]
005ec952 : PUSH ESI
005ec953 : CALL EAX
005ec955 : MOV EDX,dword ptr [EDI]
005ec957 : MOV EAX,dword ptr [EDX + 0x70]
005ec95a : MOV ECX,EDI
005ec95c : CALL EAX
005ec95e : MOV ECX,dword ptr [ESI + 0x50]
005ec961 : MOV dword ptr [ESI + ECX*0x4 + 0x54],0x0
005ec969 : OR EBP,0xffffffff
005ec96c : ADD dword ptr [ESI + 0x50],EBP
005ec96f : MOV EDX,dword ptr [ESI + 0x50]
005ec972 : CMP EDX,dword ptr [ESI + 0x54]
005ec975 : JA 0x005ec910
005ec977 : MOV EAX,dword ptr [ESP + 0x1c]
005ec97b : MOV ECX,dword ptr [ESP + 0x20]
005ec97f : ADD dword ptr [ESI + 0x4c],EBP
005ec982 : MOV dword ptr [ESI + 0x40],EAX
005ec985 : MOV dword ptr [ESI + 0x44],ECX
005ec988 : CMP word ptr [EBX + 0x64],0x0
005ec98d : JBE 0x005ec9ab
005ec98f : CMP dword ptr [ESI + 0x4c],0x0
005ec993 : JNZ 0x005ec9ab
005ec995 : PUSH EBX
005ec996 : MOV ECX,ESI
005ec998 : CALL 0x005ec460
005ec99d : MOVZX EDX,word ptr [EBX + 0x64]
005ec9a1 : INC dword ptr [ESP + 0x10]
005ec9a5 : MOV dword ptr [ESP + 0x14],EDX
005ec9a9 : JMP 0x005ec9d4
005ec9ab : MOV EAX,dword ptr [EBX]
005ec9ad : MOV EBP,dword ptr [EDI]
005ec9af : MOV EDX,dword ptr [EAX + 0xc]
005ec9b2 : MOV ECX,EBX
005ec9b4 : ADD EBP,0x2c
005ec9b7 : CALL EDX
005ec9b9 : PUSH EAX
005ec9ba : MOV EAX,dword ptr [EBP]
005ec9bd : MOV ECX,EDI
005ec9bf : CALL EAX
005ec9c1 : MOV EDX,dword ptr [EBX]
005ec9c3 : MOV EAX,dword ptr [EDX + 0x60]
005ec9c6 : PUSH ESI
005ec9c7 : MOV ECX,EBX
005ec9c9 : CALL EAX
005ec9cb : MOV EDX,dword ptr [EDI]
005ec9cd : MOV EAX,dword ptr [EDX + 0x30]
005ec9d0 : MOV ECX,EDI
005ec9d2 : CALL EAX
005ec9d4 : MOV EAX,dword ptr [ESP + 0x44]
005ec9d8 : INC EAX
005ec9d9 : MOV dword ptr [ESP + 0x44],EAX
005ec9dd : CMP EAX,dword ptr [ESP + 0x24]
005ec9e1 : JC 0x005ec883
005ec9e7 : CMP dword ptr [ESP + 0x10],0x0
005ec9ec : POP EBP
005ec9ed : POP EBX
005ec9ee : JBE 0x005ec9fe
005ec9f0 : MOV ECX,ESI
005ec9f2 : CALL 0x005ec4e0
005ec9f7 : SUB dword ptr [ESP + 0x8],0x1
005ec9fc : JNZ 0x005ec9f0
005ec9fe : POP EDI
005ec9ff : POP ESI
005eca00 : ADD ESP,0x30
005eca03 : RET 0x4

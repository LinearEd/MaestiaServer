PROGRAM  : Maestia.exe
FUNCTION : FUN_006d6290
ENTRY    : 006d6290
BODY     : [[006d6290, 006d6336]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_006d6290(int *param_1)

{
  int iVar1;
  byte bVar2;
  byte bVar3;
  undefined4 *puVar4;
  char cVar5;
  byte *pbVar6;
  int iVar7;
  
  puVar4 = (undefined4 *)param_1[6];
  iVar7 = puVar4[1];
  pbVar6 = (byte *)*puVar4;
  if (iVar7 == 0) {
    cVar5 = (*(code *)puVar4[3])(param_1);
    if (cVar5 == '\0') {
      return 0;
    }
    pbVar6 = (byte *)*puVar4;
    iVar7 = puVar4[1];
  }
  bVar2 = *pbVar6;
  iVar7 = iVar7 + -1;
  pbVar6 = pbVar6 + 1;
  if (iVar7 == 0) {
    cVar5 = (*(code *)puVar4[3])(param_1);
    if (cVar5 == '\0') {
      return 0;
    }
    pbVar6 = (byte *)*puVar4;
    iVar7 = puVar4[1];
  }
  bVar3 = *pbVar6;
  *(undefined4 *)(*param_1 + 0x14) = 0x5b;
  iVar1 = (uint)bVar2 * 0x100 + -2 + (uint)bVar3;
  *(int *)(*param_1 + 0x18) = param_1[0x5f];
  *(int *)(*param_1 + 0x1c) = iVar1;
  (**(code **)(*param_1 + 4))(param_1,1);
  *puVar4 = pbVar6 + 1;
  puVar4[1] = iVar7 + -1;
  if (0 < iVar1) {
    (**(code **)(param_1[6] + 0x10))(param_1,iVar1);
  }
  return 1;
}



============================================================
DISASSEMBLY
============================================================
006d6290 : PUSH EBX
006d6291 : PUSH EBP
006d6292 : PUSH ESI
006d6293 : MOV ESI,dword ptr [ESP + 0x10]
006d6297 : PUSH EDI
006d6298 : MOV EDI,dword ptr [ESI + 0x18]
006d629b : MOV EBP,dword ptr [EDI + 0x4]
006d629e : MOV EBX,dword ptr [EDI]
006d62a0 : TEST EBP,EBP
006d62a2 : JNZ 0x006d62bd
006d62a4 : MOV EAX,dword ptr [EDI + 0xc]
006d62a7 : PUSH ESI
006d62a8 : CALL EAX
006d62aa : ADD ESP,0x4
006d62ad : TEST AL,AL
006d62af : JNZ 0x006d62b8
006d62b1 : POP EDI
006d62b2 : POP ESI
006d62b3 : POP EBP
006d62b4 : XOR AL,AL
006d62b6 : POP EBX
006d62b7 : RET
006d62b8 : MOV EBX,dword ptr [EDI]
006d62ba : MOV EBP,dword ptr [EDI + 0x4]
006d62bd : MOVZX EAX,byte ptr [EBX]
006d62c0 : DEC EBP
006d62c1 : SHL EAX,0x8
006d62c4 : INC EBX
006d62c5 : MOV dword ptr [ESP + 0x14],EAX
006d62c9 : TEST EBP,EBP
006d62cb : JNZ 0x006d62e3
006d62cd : MOV ECX,dword ptr [EDI + 0xc]
006d62d0 : PUSH ESI
006d62d1 : CALL ECX
006d62d3 : ADD ESP,0x4
006d62d6 : TEST AL,AL
006d62d8 : JZ 0x006d62b1
006d62da : MOV EBX,dword ptr [EDI]
006d62dc : MOV EBP,dword ptr [EDI + 0x4]
006d62df : MOV EAX,dword ptr [ESP + 0x14]
006d62e3 : MOVZX EDX,byte ptr [EBX]
006d62e6 : MOV ECX,dword ptr [ESI]
006d62e8 : MOV dword ptr [ECX + 0x14],0x5b
006d62ef : MOV ECX,dword ptr [ESI + 0x17c]
006d62f5 : LEA EAX,[EAX + EDX*0x1 + -0x2]
006d62f9 : MOV EDX,dword ptr [ESI]
006d62fb : MOV dword ptr [EDX + 0x18],ECX
006d62fe : MOV EDX,dword ptr [ESI]
006d6300 : MOV dword ptr [EDX + 0x1c],EAX
006d6303 : MOV dword ptr [ESP + 0x14],EAX
006d6307 : MOV EAX,dword ptr [ESI]
006d6309 : MOV ECX,dword ptr [EAX + 0x4]
006d630c : PUSH 0x1
006d630e : PUSH ESI
006d630f : CALL ECX
006d6311 : MOV EAX,dword ptr [ESP + 0x1c]
006d6315 : INC EBX
006d6316 : DEC EBP
006d6317 : ADD ESP,0x8
006d631a : MOV dword ptr [EDI],EBX
006d631c : MOV dword ptr [EDI + 0x4],EBP
006d631f : TEST EAX,EAX
006d6321 : JLE 0x006d6330
006d6323 : MOV EDX,dword ptr [ESI + 0x18]
006d6326 : PUSH EAX
006d6327 : MOV EAX,dword ptr [EDX + 0x10]
006d632a : PUSH ESI
006d632b : CALL EAX
006d632d : ADD ESP,0x8
006d6330 : POP EDI
006d6331 : POP ESI
006d6332 : POP EBP
006d6333 : MOV AL,0x1
006d6335 : POP EBX
006d6336 : RET

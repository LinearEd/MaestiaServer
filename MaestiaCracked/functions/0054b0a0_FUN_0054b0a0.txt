PROGRAM  : Maestia.exe
FUNCTION : FUN_0054b0a0
ENTRY    : 0054b0a0
BODY     : [[0054b0a0, 0054b329] [0054b330, 0054b465]]

============================================================
DECOMPILED C CODE
============================================================

char FUN_0054b0a0(float param_1,float param_2,float *param_3)

{
  float fVar1;
  int *piVar2;
  char cVar3;
  int iVar4;
  uint uVar5;
  undefined4 uVar6;
  int iVar7;
  int in_ECX;
  uint uVar8;
  float fVar9;
  uint uVar10;
  undefined4 uVar11;
  char local_fd;
  uint local_fc;
  float local_f8;
  int *local_f4;
  int local_f0;
  undefined1 local_ec [12];
  GRefCountImpl *local_e0;
  int local_d0;
  uint local_cc;
  int *local_c8 [2];
  uint local_c0;
  undefined1 local_a4 [28];
  uint local_88;
  uint local_84;
  int *local_3c;
  GRefCountNTSImpl *local_38;
  undefined1 local_2c [44];
  
  if ((*(byte *)(in_ECX + 0x143) & 3) != 0) {
    FUN_00549ad0();
    *(byte *)(in_ECX + 0x143) = *(byte *)(in_ECX + 0x143) & 0xfc;
  }
  param_1 = param_1 - (*(float *)(in_ECX + 0x40) - *(float *)(in_ECX + 0xf4));
  fVar9 = *(float *)(in_ECX + 0x44);
  fVar1 = *(float *)(in_ECX + 0xf8);
  iVar4 = FUN_005993d0();
  local_f8 = (float)iVar4;
  if (iVar4 < 0) {
    local_f8 = local_f8 + 4.2949673e+09;
  }
  local_f8 = local_f8 + (param_2 - (fVar9 - fVar1));
  FUN_00599ff0(local_c8,local_f8);
  local_fd = '\0';
  if (((local_c8[0] == (int *)0x0) || ((uint)local_c8[0][1] <= local_c0)) || ((int)local_c0 < 0)) {
    return '\0';
  }
  piVar2 = *(int **)(*local_c8[0] + local_c0 * 4);
  fVar9 = (float)piVar2[3];
  if (fVar9 < param_1 != (fVar9 == param_1)) {
    if (*piVar2 < 0) {
      local_fc = (uint)*(ushort *)(piVar2 + 5);
    }
    else {
      local_fc = piVar2[5];
    }
    if (param_1 <= (float)(int)local_fc + fVar9) {
      local_f8 = (float)*(int *)(in_ECX + 0x50);
      if (*(int *)(in_ECX + 0x50) < 0) {
        local_f8 = local_f8 + 4.2949673e+09;
      }
      local_f8 = local_f8 + (param_1 - fVar9);
      uVar8 = 0;
      FUN_005461c0(&local_88);
      uVar10 = 0;
      while( true ) {
        if ((local_88 == 0) || (local_84 <= local_88)) goto LAB_0054b3f1;
        uVar5 = (uint)*(ushort *)(local_88 + 2);
        if ((*(byte *)(local_88 + 6) >> 6 & 1) != 0) {
          uVar5 = -uVar5;
        }
        uVar8 = uVar5 + uVar8;
        fVar9 = (float)(int)uVar8;
        if ((int)uVar8 < 0) {
          fVar9 = fVar9 + 4.2949673e+09;
        }
        if (local_f8 < fVar9) break;
        uVar10 = uVar10 + (*(ushort *)(local_88 + 4) >> 0xc);
        local_fc = uVar8;
        FUN_005443b0();
      }
      local_fd = -(*(char *)(local_88 + 6) >> 7);
      local_fc = uVar10;
      if ((local_fd != '\0') && (param_3 != (float *)0x0)) {
        *param_3 = 0.0;
        param_3[1] = 0.0;
        uVar8 = piVar2[2];
        if ((*piVar2 < 0) && (uVar8 = uVar8 & 0xffffff, uVar8 == 0xffffff)) {
          uVar8 = 0xffffffff;
        }
        local_f8 = (float)(uVar8 + uVar10);
        local_fc = 0;
        FUN_0053c2d0(&local_f4,local_f8,&local_fc);
        if (((local_f4 != (int *)0x0) && (-1 < local_f0)) && (local_f0 < local_f4[1])) {
          iVar4 = *(int *)(*local_f4 + local_f0 * 4);
          uVar11 = 0;
          uVar6 = FUN_0053e340(local_2c,local_fc,local_fc + 1);
          FUN_0053de80(uVar6,uVar11);
          FUN_00504260();
          FUN_0053cca0(local_ec);
          if (local_cc < *(uint *)(local_d0 + 4)) goto LAB_0054b330;
          goto LAB_0054b3d7;
        }
      }
      goto LAB_0054b3f1;
    }
  }
  return '\0';
LAB_0054b330:
  do {
    iVar7 = FUN_0053cdb0();
    fVar9 = (float)(*(int *)(iVar7 + 4) + *(int *)(iVar4 + 0x1c));
    iVar7 = FUN_0053cdb0();
    if (((*(ushort *)(*(int *)(iVar7 + 0xc) + 0x2a) & 0x100) == 0) ||
       (iVar7 = FUN_0051b1a0(), iVar7 == 0)) {
LAB_0054b3b2:
      if ((uint)local_f8 < (uint)fVar9) break;
      *param_3 = 0.0;
      param_3[1] = 0.0;
    }
    else {
      FUN_0053cdb0();
      cVar3 = FUN_004ffb70(local_a4);
      if (cVar3 == '\0') goto LAB_0054b3b2;
      if ((uint)((int)param_3[1] + (int)*param_3) < (uint)fVar9) {
        if ((uint)local_f8 < (uint)fVar9) break;
        *param_3 = fVar9;
        iVar7 = FUN_0053cdb0();
        param_3[1] = *(float *)(iVar7 + 8);
      }
      else {
        iVar7 = FUN_0053cdb0();
        param_3[1] = (float)((int)param_3[1] + *(int *)(iVar7 + 8));
      }
    }
    FUN_0053ce50();
  } while (local_cc < *(uint *)(local_d0 + 4));
LAB_0054b3d7:
  if (local_e0 != (GRefCountImpl *)0x0) {
    GRefCountImpl::Release(local_e0);
  }
  FUN_00504260();
LAB_0054b3f1:
  if (local_38 != (GRefCountNTSImpl *)0x0) {
    GRefCountNTSImpl::Release(local_38);
  }
  if ((local_3c != (int *)0x0) && (*local_3c = *local_3c + -1, *local_3c == 0)) {
    FUN_00500860();
    FUN_00515cf0(local_3c);
    return local_fd;
  }
  return local_fd;
}



============================================================
DISASSEMBLY
============================================================
0054b0a0 : SUB ESP,0x100
0054b0a6 : PUSH EBX
0054b0a7 : MOV EBX,ECX
0054b0a9 : TEST byte ptr [EBX + 0x143],0x3
0054b0b0 : PUSH ESI
0054b0b1 : JZ 0x0054b0bf
0054b0b3 : CALL 0x00549ad0
0054b0b8 : AND byte ptr [EBX + 0x143],0xfc
0054b0bf : FLD float ptr [ESP + 0x10c]
0054b0c6 : LEA ESI,[EBX + 0x28]
0054b0c9 : FLD float ptr [EBX + 0x40]
0054b0cc : MOV ECX,ESI
0054b0ce : FSUB float ptr [EBX + 0xf4]
0054b0d4 : FSUBP
0054b0d6 : FSTP float ptr [ESP + 0x10c]
0054b0dd : FLD float ptr [ESP + 0x110]
0054b0e4 : FLD float ptr [EBX + 0x44]
0054b0e7 : FSUB float ptr [EBX + 0xf8]
0054b0ed : FSUBP
0054b0ef : FSTP float ptr [ESP + 0x110]
0054b0f6 : CALL 0x005993d0
0054b0fb : MOV dword ptr [ESP + 0x10],EAX
0054b0ff : FILD dword ptr [ESP + 0x10]
0054b103 : TEST EAX,EAX
0054b105 : JGE 0x0054b10d
0054b107 : FADD float ptr [0x00cdf0e0]
0054b10d : FADD float ptr [ESP + 0x110]
0054b114 : PUSH ECX
0054b115 : LEA EAX,[ESP + 0x44]
0054b119 : MOV ECX,ESI
0054b11b : FSTP float ptr [ESP + 0x14]
0054b11f : FLD float ptr [ESP + 0x14]
0054b123 : FSTP float ptr [ESP]
0054b126 : PUSH EAX
0054b127 : CALL 0x00599ff0
0054b12c : MOV EAX,dword ptr [ESP + 0x40]
0054b130 : XOR DL,DL
0054b132 : MOV byte ptr [ESP + 0xb],DL
0054b136 : TEST EAX,EAX
0054b138 : JZ 0x0054b459
0054b13e : MOV ECX,dword ptr [ESP + 0x48]
0054b142 : CMP ECX,dword ptr [EAX + 0x4]
0054b145 : JNC 0x0054b459
0054b14b : TEST ECX,ECX
0054b14d : JL 0x0054b459
0054b153 : MOV EAX,dword ptr [EAX]
0054b155 : PUSH EBP
0054b156 : MOV EBP,dword ptr [EAX + ECX*0x4]
0054b159 : MOV EAX,dword ptr [EBP + 0xc]
0054b15c : MOV ECX,dword ptr [EBP]
0054b15f : MOV dword ptr [ESP + 0x10],EAX
0054b163 : FILD dword ptr [ESP + 0x10]
0054b167 : SHR ECX,0x1f
0054b16a : AND CL,0x1
0054b16d : FSTP float ptr [ESP + 0x14]
0054b171 : FLD float ptr [ESP + 0x110]
0054b178 : FLD float ptr [ESP + 0x14]
0054b17c : FCOM
0054b17e : FNSTSW AX
0054b180 : TEST AH,0x41
0054b183 : JP 0x0054b447
0054b189 : TEST CL,CL
0054b18b : JZ 0x0054b197
0054b18d : MOVZX ECX,word ptr [EBP + 0x14]
0054b191 : MOV dword ptr [ESP + 0x10],ECX
0054b195 : JMP 0x0054b19e
0054b197 : MOV EAX,dword ptr [EBP + 0x14]
0054b19a : MOV dword ptr [ESP + 0x10],EAX
0054b19e : FILD dword ptr [ESP + 0x10]
0054b1a2 : FADD ST0,ST1
0054b1a4 : FCOMP ST2
0054b1a6 : FNSTSW AX
0054b1a8 : TEST AH,0x1
0054b1ab : JNZ 0x0054b447
0054b1b1 : MOV ECX,dword ptr [EBX + 0x50]
0054b1b4 : FSUBP
0054b1b6 : FILD dword ptr [EBX + 0x50]
0054b1b9 : PUSH EDI
0054b1ba : TEST ECX,ECX
0054b1bc : JGE 0x0054b1c4
0054b1be : FADD float ptr [0x00cdf0e0]
0054b1c4 : FADDP
0054b1c6 : LEA EDX,[ESP + 0x88]
0054b1cd : PUSH EDX
0054b1ce : MOV ECX,EBP
0054b1d0 : FSTP float ptr [ESP + 0x1c]
0054b1d4 : XOR ESI,ESI
0054b1d6 : CALL 0x005461c0
0054b1db : XOR EDI,EDI
0054b1dd : LEA ECX,[ECX]
0054b1e0 : MOV ECX,dword ptr [ESP + 0x88]
0054b1e7 : TEST ECX,ECX
0054b1e9 : JZ 0x0054b3ed
0054b1ef : CMP ECX,dword ptr [ESP + 0x8c]
0054b1f6 : JNC 0x0054b3ed
0054b1fc : MOV AL,byte ptr [ECX + 0x6]
0054b1ff : SHR AL,0x6
0054b202 : TEST AL,0x1
0054b204 : MOVZX EAX,word ptr [ECX + 0x2]
0054b208 : JZ 0x0054b20c
0054b20a : NEG EAX
0054b20c : LEA EDX,[EAX + ESI*0x1]
0054b20f : MOV EAX,EDX
0054b211 : MOV dword ptr [ESP + 0x14],EAX
0054b215 : FILD dword ptr [ESP + 0x14]
0054b219 : TEST EAX,EAX
0054b21b : JGE 0x0054b223
0054b21d : FADD float ptr [0x00cdf0e0]
0054b223 : FLD float ptr [ESP + 0x18]
0054b227 : FCOMPP
0054b229 : FNSTSW AX
0054b22b : TEST AH,0x5
0054b22e : JNP 0x0054b249
0054b230 : MOVZX ECX,word ptr [ECX + 0x4]
0054b234 : SHR ECX,0xc
0054b237 : ADD EDI,ECX
0054b239 : LEA ECX,[ESP + 0x88]
0054b240 : MOV ESI,EDX
0054b242 : CALL 0x005443b0
0054b247 : JMP 0x0054b1e0
0054b249 : MOV CL,byte ptr [ECX + 0x6]
0054b24c : SHR CL,0x7
0054b24f : AND CL,0x1
0054b252 : MOV dword ptr [ESP + 0x14],EDI
0054b256 : MOV byte ptr [ESP + 0x13],CL
0054b25a : JZ 0x0054b3f1
0054b260 : MOV EDI,dword ptr [ESP + 0x11c]
0054b267 : TEST EDI,EDI
0054b269 : JZ 0x0054b3f1
0054b26f : XOR ESI,ESI
0054b271 : MOV dword ptr [EDI],ESI
0054b273 : MOV dword ptr [EDI + 0x4],ESI
0054b276 : MOV EDX,dword ptr [EBP]
0054b279 : MOV EAX,dword ptr [EBP + 0x8]
0054b27c : SHR EDX,0x1f
0054b27f : TEST DL,0x1
0054b282 : JZ 0x0054b293
0054b284 : AND EAX,0xffffff
0054b289 : CMP EAX,0xffffff
0054b28e : JNZ 0x0054b293
0054b290 : OR EAX,0xffffffff
0054b293 : MOV ECX,dword ptr [ESP + 0x14]
0054b297 : ADD EAX,ECX
0054b299 : MOV ECX,dword ptr [EBX + 0xc]
0054b29c : LEA EDX,[ESP + 0x14]
0054b2a0 : PUSH EDX
0054b2a1 : PUSH EAX
0054b2a2 : MOV dword ptr [ESP + 0x20],EAX
0054b2a6 : LEA EAX,[ESP + 0x24]
0054b2aa : PUSH EAX
0054b2ab : MOV dword ptr [ESP + 0x20],ESI
0054b2af : CALL 0x0053c2d0
0054b2b4 : MOV EAX,dword ptr [ESP + 0x1c]
0054b2b8 : CMP EAX,ESI
0054b2ba : JZ 0x0054b3ed
0054b2c0 : MOV ECX,dword ptr [ESP + 0x20]
0054b2c4 : TEST ECX,ECX
0054b2c6 : JL 0x0054b3ed
0054b2cc : CMP ECX,dword ptr [EAX + 0x4]
0054b2cf : JGE 0x0054b3ed
0054b2d5 : MOV EDX,dword ptr [EAX]
0054b2d7 : MOV EBP,dword ptr [EDX + ECX*0x4]
0054b2da : MOV EAX,dword ptr [ESP + 0x14]
0054b2de : XOR EBX,EBX
0054b2e0 : PUSH EBX
0054b2e1 : LEA ECX,[EAX + 0x1]
0054b2e4 : PUSH ECX
0054b2e5 : PUSH EAX
0054b2e6 : LEA EDX,[ESP + 0xf0]
0054b2ed : PUSH EDX
0054b2ee : MOV ECX,EBP
0054b2f0 : CALL 0x0053e340
0054b2f5 : PUSH EAX
0054b2f6 : LEA ECX,[ESP + 0x64]
0054b2fa : CALL 0x0053de80
0054b2ff : LEA ECX,[ESP + 0xe4]
0054b306 : CALL 0x00504260
0054b30b : LEA EAX,[ESP + 0x24]
0054b30f : PUSH EAX
0054b310 : MOV ECX,EBP
0054b312 : CALL 0x0053cca0
0054b317 : MOV ECX,dword ptr [ESP + 0x44]
0054b31b : MOV EDX,dword ptr [ESP + 0x40]
0054b31f : CMP ECX,dword ptr [EDX + 0x4]
0054b322 : JNC 0x0054b3d7
0054b328 : JMP 0x0054b330
0054b330 : LEA ECX,[ESP + 0x24]
0054b334 : CALL 0x0053cdb0
0054b339 : MOV ESI,dword ptr [EAX + 0x4]
0054b33c : ADD ESI,dword ptr [EBP + 0x1c]
0054b33f : LEA ECX,[ESP + 0x24]
0054b343 : CALL 0x0053cdb0
0054b348 : MOV EAX,dword ptr [EAX + 0xc]
0054b34b : MOV ECX,0x100
0054b350 : TEST word ptr [EAX + 0x2a],CX
0054b354 : JZ 0x0054b3b2
0054b356 : LEA ECX,[EAX + 0x10]
0054b359 : CALL 0x0051b1a0
0054b35e : TEST EAX,EAX
0054b360 : JZ 0x0054b3b2
0054b362 : LEA ECX,[ESP + 0x24]
0054b366 : CALL 0x0053cdb0
0054b36b : MOV ECX,dword ptr [EAX + 0xc]
0054b36e : LEA EDX,[ESP + 0x6c]
0054b372 : PUSH EDX
0054b373 : ADD ECX,0x10
0054b376 : CALL 0x004ffb70
0054b37b : TEST AL,AL
0054b37d : JZ 0x0054b3b2
0054b37f : MOV EAX,dword ptr [EDI + 0x4]
0054b382 : ADD EAX,dword ptr [EDI]
0054b384 : CMP EAX,ESI
0054b386 : JNC 0x0054b3a1
0054b388 : CMP ESI,dword ptr [ESP + 0x18]
0054b38c : JA 0x0054b3d7
0054b38e : LEA ECX,[ESP + 0x24]
0054b392 : MOV dword ptr [EDI],ESI
0054b394 : CALL 0x0053cdb0
0054b399 : MOV ECX,dword ptr [EAX + 0x8]
0054b39c : MOV dword ptr [EDI + 0x4],ECX
0054b39f : JMP 0x0054b3bd
0054b3a1 : LEA ECX,[ESP + 0x24]
0054b3a5 : CALL 0x0053cdb0
0054b3aa : MOV EDX,dword ptr [EAX + 0x8]
0054b3ad : ADD dword ptr [EDI + 0x4],EDX
0054b3b0 : JMP 0x0054b3bd
0054b3b2 : CMP ESI,dword ptr [ESP + 0x18]
0054b3b6 : JA 0x0054b3d7
0054b3b8 : MOV dword ptr [EDI],EBX
0054b3ba : MOV dword ptr [EDI + 0x4],EBX
0054b3bd : LEA ECX,[ESP + 0x24]
0054b3c1 : CALL 0x0053ce50
0054b3c6 : MOV EAX,dword ptr [ESP + 0x44]
0054b3ca : MOV ECX,dword ptr [ESP + 0x40]
0054b3ce : CMP EAX,dword ptr [ECX + 0x4]
0054b3d1 : JC 0x0054b330
0054b3d7 : MOV ECX,dword ptr [ESP + 0x30]
0054b3db : CMP ECX,EBX
0054b3dd : JZ 0x0054b3e4
0054b3df : CALL 0x004ff7e0
0054b3e4 : LEA ECX,[ESP + 0x5c]
0054b3e8 : CALL 0x00504260
0054b3ed : MOV CL,byte ptr [ESP + 0x13]
0054b3f1 : MOV EAX,dword ptr [ESP + 0xd8]
0054b3f8 : POP EDI
0054b3f9 : TEST EAX,EAX
0054b3fb : JZ 0x0054b408
0054b3fd : MOV ECX,EAX
0054b3ff : CALL 0x004ff7c0
0054b404 : MOV CL,byte ptr [ESP + 0xf]
0054b408 : MOV EAX,dword ptr [ESP + 0xd0]
0054b40f : TEST EAX,EAX
0054b411 : JZ 0x0054b439
0054b413 : DEC dword ptr [EAX]
0054b415 : MOV ESI,EAX
0054b417 : CMP dword ptr [ESI],0x0
0054b41a : JNZ 0x0054b439
0054b41c : MOV ECX,ESI
0054b41e : CALL 0x00500860
0054b423 : PUSH ESI
0054b424 : CALL 0x00515cf0
0054b429 : MOV AL,byte ptr [ESP + 0xf]
0054b42d : POP EBP
0054b42e : POP ESI
0054b42f : POP EBX
0054b430 : ADD ESP,0x100
0054b436 : RET 0xc
0054b439 : POP EBP
0054b43a : POP ESI
0054b43b : MOV AL,CL
0054b43d : POP EBX
0054b43e : ADD ESP,0x100
0054b444 : RET 0xc
0054b447 : POP EBP
0054b448 : FSTP ST1
0054b44a : POP ESI
0054b44b : FSTP ST0
0054b44d : MOV AL,DL
0054b44f : POP EBX
0054b450 : ADD ESP,0x100
0054b456 : RET 0xc
0054b459 : POP ESI
0054b45a : MOV AL,DL
0054b45c : POP EBX
0054b45d : ADD ESP,0x100
0054b463 : RET 0xc

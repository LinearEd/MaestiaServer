PROGRAM  : Maestia.exe
FUNCTION : FUN_00904a20
ENTRY    : 00904a20
BODY     : [[00904a20, 00904b8e]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00904a20(void)

{
  int *piVar1;
  int *in_ECX;
  uint local_38;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4a72b;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  piVar1 = (int *)(**(code **)(*in_ECX + 0x74))();
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 0x44))();
    local_18 = 7;
    local_1c = 0;
    local_2c = 0;
    local_8 = 0;
    (**(code **)(*in_ECX + 0x58))();
    FUN_00405eb0(local_30,0,0xffffffff);
    local_8 = local_8 & 0xffffff00;
    FUN_008f75f0();
    local_8._0_1_ = 2;
    FUN_00405eb0();
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_38) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    (**(code **)(**(int **)(*DAT_00da9894 + 0x114) + 4))();
    FUN_009048f0();
    local_8 = 0xffffffff;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c = 0;
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00904a20 : PUSH EBP
00904a21 : MOV EBP,ESP
00904a23 : PUSH -0x1
00904a25 : PUSH 0xb4a72b
00904a2a : MOV EAX,FS:[0x0]
00904a30 : PUSH EAX
00904a31 : SUB ESP,0x40
00904a34 : MOV EAX,[0x00d66fa0]
00904a39 : XOR EAX,EBP
00904a3b : MOV dword ptr [EBP + -0x10],EAX
00904a3e : PUSH EBX
00904a3f : PUSH ESI
00904a40 : PUSH EDI
00904a41 : PUSH EAX
00904a42 : LEA EAX,[EBP + -0xc]
00904a45 : MOV FS:[0x0],EAX
00904a4b : MOV EDI,dword ptr [EBP + 0xc]
00904a4e : MOV EBX,ECX
00904a50 : MOV ECX,dword ptr [EBP + 0x8]
00904a53 : MOV EAX,dword ptr [EBX]
00904a55 : MOV EDX,dword ptr [EAX + 0x74]
00904a58 : PUSH EDI
00904a59 : PUSH ECX
00904a5a : MOV ECX,EBX
00904a5c : CALL EDX
00904a5e : MOV ESI,EAX
00904a60 : TEST ESI,ESI
00904a62 : JZ 0x00904b71
00904a68 : MOV ECX,dword ptr [EBP + 0x10]
00904a6b : MOV EAX,dword ptr [ESI]
00904a6d : MOV EDX,dword ptr [EAX + 0x44]
00904a70 : PUSH ECX
00904a71 : MOV ECX,ESI
00904a73 : CALL EDX
00904a75 : MOVZX EAX,word ptr [EBP + 0x8]
00904a79 : MOVZX EDI,DI
00904a7c : LEA EDI,[EDI + EDI*0x4]
00904a7f : XOR ECX,ECX
00904a81 : XOR EDX,EDX
00904a83 : ADD EDI,EAX
00904a85 : MOV EAX,dword ptr [ESI + 0x10]
00904a88 : MOV dword ptr [EBP + -0x14],0x7
00904a8f : MOV dword ptr [EBP + -0x18],ECX
00904a92 : MOV word ptr [EBP + -0x28],DX
00904a96 : MOV dword ptr [EBP + -0x4],ECX
00904a99 : MOV EDX,dword ptr [EBX]
00904a9b : MOV EDX,dword ptr [EDX + 0x58]
00904a9e : LEA ECX,[EBP + -0x2c]
00904aa1 : PUSH ECX
00904aa2 : PUSH EAX
00904aa3 : MOV ECX,EBX
00904aa5 : CALL EDX
00904aa7 : SUB ESP,0x1c
00904aaa : MOV ECX,ESP
00904aac : MOV dword ptr [EBP + -0x30],ESP
00904aaf : XOR EAX,EAX
00904ab1 : PUSH -0x1
00904ab3 : PUSH EAX
00904ab4 : LEA EDX,[EBP + -0x2c]
00904ab7 : MOV dword ptr [ECX + 0x18],0x7
00904abe : MOV dword ptr [ECX + 0x14],0x0
00904ac5 : PUSH EDX
00904ac6 : MOV word ptr [ECX + 0x4],AX
00904aca : CALL 0x00405eb0
00904acf : MOV byte ptr [EBP + -0x4],0x1
00904ad3 : MOV byte ptr [EBP + -0x4],0x0
00904ad7 : LEA ECX,[EBP + -0x4c]
00904ada : CALL 0x008f75f0
00904adf : ADD ESP,0x1c
00904ae2 : MOV byte ptr [EBP + -0x4],0x2
00904ae6 : PUSH -0x1
00904ae8 : PUSH 0x0
00904aea : PUSH EAX
00904aeb : LEA ECX,[EBP + -0x2c]
00904aee : CALL 0x00405eb0
00904af3 : MOV byte ptr [EBP + -0x4],0x0
00904af7 : CMP dword ptr [EBP + -0x34],0x8
00904afb : JC 0x00904b05
00904afd : MOV ECX,dword ptr [EBP + -0x48]
00904b00 : CALL 0x006f04e0
00904b05 : MOV ECX,dword ptr [0x00da9894]
00904b0b : XOR EAX,EAX
00904b0d : MOV word ptr [EBP + -0x48],AX
00904b11 : PUSH EDI
00904b12 : MOV dword ptr [EBP + -0x34],0x7
00904b19 : MOV dword ptr [EBP + -0x38],0x0
00904b20 : MOV EAX,dword ptr [ECX]
00904b22 : MOV EAX,dword ptr [EAX + 0x114]
00904b28 : MOV EDX,dword ptr [EAX]
00904b2a : PUSH 0xc642e4
00904b2f : PUSH 0xc642e8
00904b34 : PUSH EAX
00904b35 : MOV EAX,dword ptr [EDX + 0x4]
00904b38 : CALL EAX
00904b3a : ADD ESP,0x10
00904b3d : PUSH EDI
00904b3e : LEA ECX,[EBP + -0x2c]
00904b41 : PUSH ECX
00904b42 : PUSH EBX
00904b43 : CALL 0x009048f0
00904b48 : MOV dword ptr [EBP + -0x4],0xffffffff
00904b4f : CMP dword ptr [EBP + -0x14],0x8
00904b53 : JC 0x00904b5d
00904b55 : MOV ECX,dword ptr [EBP + -0x28]
00904b58 : CALL 0x006f04e0
00904b5d : XOR EDX,EDX
00904b5f : MOV dword ptr [EBP + -0x14],0x7
00904b66 : MOV dword ptr [EBP + -0x18],0x0
00904b6d : MOV word ptr [EBP + -0x28],DX
00904b71 : MOV ECX,dword ptr [EBP + -0xc]
00904b74 : MOV dword ptr FS:[0x0],ECX
00904b7b : POP ECX
00904b7c : POP EDI
00904b7d : POP ESI
00904b7e : POP EBX
00904b7f : MOV ECX,dword ptr [EBP + -0x10]
00904b82 : XOR ECX,EBP
00904b84 : CALL 0x00633e6b
00904b89 : MOV ESP,EBP
00904b8b : POP EBP
00904b8c : RET 0xc

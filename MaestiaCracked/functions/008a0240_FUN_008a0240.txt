PROGRAM  : Maestia.exe
FUNCTION : FUN_008a0240
ENTRY    : 008a0240
BODY     : [[008a0240, 008a03a6]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008a0240(void)

{
  undefined4 uVar1;
  int iVar2;
  undefined4 *puVar3;
  int in_ECX;
  undefined4 extraout_EDX;
  undefined1 auStack_f0 [28];
  undefined4 uStack_d4;
  undefined4 uStack_d0;
  undefined1 *puStack_cc;
  undefined4 *puStack_c8;
  uint uStack_c4;
  undefined1 local_b0 [44];
  undefined4 local_84;
  undefined1 local_80 [44];
  undefined1 local_54 [8];
  undefined1 *local_4c;
  int local_48;
  int local_44;
  undefined2 local_40 [16];
  undefined1 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1c8ea;
  local_10 = ExceptionList;
  uStack_c4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  puStack_c8 = *(undefined4 **)(*(int *)(in_ECX + 100) + 4);
  puStack_cc = (undefined1 *)0x8a0284;
  local_44 = in_ECX;
  local_14 = uStack_c4;
  FUN_00435da0();
  *(int *)(*(int *)(in_ECX + 100) + 4) = *(int *)(in_ECX + 100);
  *(undefined4 *)(in_ECX + 0x68) = 0;
  *(undefined4 *)*(undefined4 *)(in_ECX + 100) = *(undefined4 *)(in_ECX + 100);
  *(int *)(*(int *)(in_ECX + 100) + 8) = *(int *)(in_ECX + 100);
  if (*(int *)(in_ECX + 0x44) != 0) {
    local_48 = **(int **)(in_ECX + 0x40);
    if ((int *)local_48 != *(int **)(in_ECX + 0x40)) {
      do {
        iVar2 = local_48;
        uVar1 = *(undefined4 *)(local_48 + 0x10);
        puStack_c8 = (undefined4 *)local_40;
        puStack_cc = (undefined1 *)0x8a02c2;
        FUN_00438ce0();
        local_8 = 0;
        local_20 = 0;
        local_1c = 1;
        local_18 = 0;
        puStack_c8 = (undefined4 *)0x8a02dc;
        local_40[0] = FUN_0089f620();
        puStack_c8 = (undefined4 *)0xffffffff;
        uStack_d4 = 0x8a02ec;
        uStack_d0 = uVar1;
        puStack_cc = (undefined1 *)extraout_EDX;
        FUN_00405eb0();
        uVar1 = *(undefined4 *)(iVar2 + 0xc);
        local_4c = auStack_f0;
        FUN_00435430(auStack_f0);
        local_8 = local_8 & 0xffffff00;
        puVar3 = (undefined4 *)FUN_00437ff0(uVar1);
        local_8._0_1_ = 2;
        local_84 = *puVar3;
        puStack_c8 = (undefined4 *)local_80;
        puStack_cc = (undefined1 *)0x8a032c;
        FUN_00435430();
        local_8._0_1_ = 4;
        puStack_c8 = &local_84;
        puStack_cc = local_54;
        uStack_d0 = 0x8a033f;
        FUN_00435d40();
        local_8._0_1_ = 2;
        puStack_c8 = (undefined4 *)local_80;
        puStack_cc = (undefined1 *)0x8a034c;
        FUN_004427d0();
        local_8 = (uint)local_8._1_3_ << 8;
        puStack_c8 = (undefined4 *)local_b0;
        puStack_cc = (undefined1 *)0x8a035c;
        FUN_004427d0();
        local_8 = 0xffffffff;
        puStack_c8 = (undefined4 *)local_40;
        puStack_cc = (undefined1 *)0x8a036c;
        FUN_004427d0();
        puStack_c8 = (undefined4 *)0x8a0374;
        FUN_00416210();
        in_ECX = local_44;
      } while (local_48 != *(int *)(local_44 + 0x40));
    }
    puStack_cc = (undefined1 *)0x8a038b;
    puStack_c8 = (undefined4 *)in_ECX;
    FUN_0089fe70();
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008a0240 : PUSH EBP
008a0241 : MOV EBP,ESP
008a0243 : PUSH -0x1
008a0245 : PUSH 0xb1c8ea
008a024a : MOV EAX,FS:[0x0]
008a0250 : PUSH EAX
008a0251 : SUB ESP,0xa4
008a0257 : MOV EAX,[0x00d66fa0]
008a025c : XOR EAX,EBP
008a025e : MOV dword ptr [EBP + -0x10],EAX
008a0261 : PUSH EBX
008a0262 : PUSH ESI
008a0263 : PUSH EDI
008a0264 : PUSH EAX
008a0265 : LEA EAX,[EBP + -0xc]
008a0268 : MOV FS:[0x0],EAX
008a026e : MOV EDI,ECX
008a0270 : MOV EAX,dword ptr [EDI + 0x64]
008a0273 : MOV ECX,dword ptr [EAX + 0x4]
008a0276 : LEA EBX,[EDI + 0x60]
008a0279 : PUSH ECX
008a027a : MOV ECX,EBX
008a027c : MOV dword ptr [EBP + -0x40],EDI
008a027f : CALL 0x00435da0
008a0284 : MOV EAX,dword ptr [EBX + 0x4]
008a0287 : MOV dword ptr [EAX + 0x4],EAX
008a028a : MOV EAX,dword ptr [EBX + 0x4]
008a028d : MOV dword ptr [EBX + 0x8],0x0
008a0294 : MOV dword ptr [EAX],EAX
008a0296 : MOV EAX,dword ptr [EBX + 0x4]
008a0299 : MOV dword ptr [EAX + 0x8],EAX
008a029c : CMP dword ptr [EDI + 0x44],0x0
008a02a0 : JZ 0x008a038b
008a02a6 : MOV EAX,dword ptr [EDI + 0x40]
008a02a9 : MOV ESI,dword ptr [EAX]
008a02ab : MOV dword ptr [EBP + -0x44],ESI
008a02ae : CMP ESI,EAX
008a02b0 : JZ 0x008a0385
008a02b6 : MOV EDI,dword ptr [ESI + 0x10]
008a02b9 : LEA EDX,[EBP + -0x3c]
008a02bc : PUSH EDX
008a02bd : CALL 0x00438ce0
008a02c2 : XOR EDX,EDX
008a02c4 : MOV dword ptr [EBP + -0x4],EDX
008a02c7 : MOV byte ptr [EBP + -0x1c],DL
008a02ca : MOV dword ptr [EBP + -0x18],0x1
008a02d1 : MOV dword ptr [EBP + -0x14],EDX
008a02d4 : MOV EAX,dword ptr [EDI + 0x28]
008a02d7 : CALL 0x0089f620
008a02dc : PUSH -0x1
008a02de : PUSH EDX
008a02df : PUSH EDI
008a02e0 : LEA ECX,[EBP + -0x38]
008a02e3 : MOV word ptr [EBP + -0x3c],AX
008a02e7 : CALL 0x00405eb0
008a02ec : MOV ESI,dword ptr [ESI + 0xc]
008a02ef : SUB ESP,0x2c
008a02f2 : MOV EAX,ESP
008a02f4 : MOV dword ptr [EBP + -0x48],ESP
008a02f7 : PUSH EAX
008a02f8 : LEA EDI,[EBP + -0x3c]
008a02fb : CALL 0x00435430
008a0300 : MOV byte ptr [EBP + -0x4],0x1
008a0304 : PUSH ESI
008a0305 : MOV byte ptr [EBP + -0x4],0x0
008a0309 : LEA ESI,[EBP + 0xffffff50]
008a030f : CALL 0x00437ff0
008a0314 : ADD ESP,0x30
008a0317 : MOV byte ptr [EBP + -0x4],0x2
008a031b : MOV ECX,dword ptr [EAX]
008a031d : LEA EDX,[EBP + -0x7c]
008a0320 : LEA EDI,[EAX + 0x4]
008a0323 : PUSH EDX
008a0324 : MOV dword ptr [EBP + -0x80],ECX
008a0327 : CALL 0x00435430
008a032c : MOV byte ptr [EBP + -0x4],0x4
008a0330 : LEA EAX,[EBP + -0x80]
008a0333 : PUSH EAX
008a0334 : LEA ECX,[EBP + -0x50]
008a0337 : PUSH ECX
008a0338 : MOV EAX,EBX
008a033a : CALL 0x00435d40
008a033f : MOV byte ptr [EBP + -0x4],0x2
008a0343 : LEA EDX,[EBP + -0x7c]
008a0346 : PUSH EDX
008a0347 : CALL 0x004427d0
008a034c : MOV byte ptr [EBP + -0x4],0x0
008a0350 : LEA EAX,[EBP + 0xffffff54]
008a0356 : PUSH EAX
008a0357 : CALL 0x004427d0
008a035c : MOV dword ptr [EBP + -0x4],0xffffffff
008a0363 : LEA ECX,[EBP + -0x3c]
008a0366 : PUSH ECX
008a0367 : CALL 0x004427d0
008a036c : LEA EDX,[EBP + -0x44]
008a036f : CALL 0x00416210
008a0374 : MOV ESI,dword ptr [EBP + -0x44]
008a0377 : MOV EDX,dword ptr [EBP + -0x40]
008a037a : CMP ESI,dword ptr [EDX + 0x40]
008a037d : JNZ 0x008a02b6
008a0383 : MOV EDI,EDX
008a0385 : PUSH EDI
008a0386 : CALL 0x0089fe70
008a038b : MOV ECX,dword ptr [EBP + -0xc]
008a038e : MOV dword ptr FS:[0x0],ECX
008a0395 : POP ECX
008a0396 : POP EDI
008a0397 : POP ESI
008a0398 : POP EBX
008a0399 : MOV ECX,dword ptr [EBP + -0x10]
008a039c : XOR ECX,EBP
008a039e : CALL 0x00633e6b
008a03a3 : MOV ESP,EBP
008a03a5 : POP EBP
008a03a6 : RET

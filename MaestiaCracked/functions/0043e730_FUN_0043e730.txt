PROGRAM  : Maestia.exe
FUNCTION : FUN_0043e730
ENTRY    : 0043e730
BODY     : [[0043e730, 0043e8d2]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0043e730(undefined4 *param_1,char param_2,undefined4 param_3)

{
  char cVar1;
  int *piVar2;
  int *piVar3;
  int iVar4;
  int *piVar5;
  int *piVar6;
  undefined4 *in_ECX;
  int *piVar7;
  int unaff_EDI;
  undefined1 local_58 [40];
  undefined1 local_30 [4];
  undefined1 local_2c;
  undefined4 local_1c;
  undefined4 local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7a1c8;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if (0x7ffffffd < *(uint *)(unaff_EDI + 8)) {
    local_18 = 0xf;
    local_1c = 0;
    local_2c = 0;
    FUN_00404b50("map/set<T> too long",0x13);
    local_8 = 0;
    FUN_00404af0(local_30);
                    /* WARNING: Subroutine does not return */
    __CxxThrowException_8(local_58,&DAT_00ced8cc);
  }
  piVar5 = (int *)FUN_0043e670(*(undefined4 *)(unaff_EDI + 4),in_ECX,*(undefined4 *)(unaff_EDI + 4),
                               param_3,0);
  *(int *)(unaff_EDI + 8) = *(int *)(unaff_EDI + 8) + 1;
  if (in_ECX == *(undefined4 **)(unaff_EDI + 4)) {
    (*(undefined4 **)(unaff_EDI + 4))[1] = piVar5;
    **(undefined4 **)(unaff_EDI + 4) = piVar5;
    *(int **)(*(int *)(unaff_EDI + 4) + 8) = piVar5;
  }
  else if (param_2 == '\0') {
    in_ECX[2] = piVar5;
    if (in_ECX == *(undefined4 **)(*(int *)(unaff_EDI + 4) + 8)) {
      *(int **)(*(int *)(unaff_EDI + 4) + 8) = piVar5;
    }
  }
  else {
    *in_ECX = piVar5;
    if (in_ECX == (undefined4 *)**(int **)(unaff_EDI + 4)) {
      **(int **)(unaff_EDI + 4) = (int)piVar5;
    }
  }
  cVar1 = *(char *)(piVar5[1] + 0xe);
  piVar7 = piVar5;
  while (cVar1 == '\0') {
    piVar6 = piVar7 + 1;
    piVar2 = (int *)*piVar6;
    piVar3 = (int *)piVar2[1];
    if (piVar2 == (int *)*piVar3) {
      iVar4 = piVar3[2];
      if (*(char *)(iVar4 + 0xe) == '\0') {
        *(undefined1 *)((int)piVar2 + 0xe) = 1;
        *(undefined1 *)(iVar4 + 0xe) = 1;
        *(undefined1 *)(*(int *)(*piVar6 + 4) + 0xe) = 0;
        piVar7 = *(int **)(*piVar6 + 4);
      }
      else {
        if (piVar7 == (int *)piVar2[2]) {
          FUN_0043de90(unaff_EDI);
          piVar7 = piVar2;
        }
        *(undefined1 *)(piVar7[1] + 0xe) = 1;
        *(undefined1 *)(*(int *)(piVar7[1] + 4) + 0xe) = 0;
        FUN_0043def0(unaff_EDI);
      }
    }
    else {
      iVar4 = *piVar3;
      if (*(char *)(iVar4 + 0xe) == '\0') {
        *(undefined1 *)((int)piVar2 + 0xe) = 1;
        *(undefined1 *)(iVar4 + 0xe) = 1;
        *(undefined1 *)(*(int *)(*piVar6 + 4) + 0xe) = 0;
        piVar7 = *(int **)(*piVar6 + 4);
      }
      else {
        if (piVar7 == (int *)*piVar2) {
          FUN_0043def0(unaff_EDI);
          piVar7 = piVar2;
        }
        *(undefined1 *)(piVar7[1] + 0xe) = 1;
        *(undefined1 *)(*(int *)(piVar7[1] + 4) + 0xe) = 0;
        FUN_0043de90(unaff_EDI);
      }
    }
    cVar1 = *(char *)(piVar7[1] + 0xe);
  }
  *(undefined1 *)(*(int *)(*(int *)(unaff_EDI + 4) + 4) + 0xe) = 1;
  *param_1 = piVar5;
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
0043e730 : PUSH EBP
0043e731 : MOV EBP,ESP
0043e733 : PUSH -0x1
0043e735 : PUSH 0xb7a1c8
0043e73a : MOV EAX,FS:[0x0]
0043e740 : PUSH EAX
0043e741 : SUB ESP,0x4c
0043e744 : PUSH EBX
0043e745 : PUSH ESI
0043e746 : MOV EAX,[0x00d66fa0]
0043e74b : XOR EAX,EBP
0043e74d : PUSH EAX
0043e74e : LEA EAX,[EBP + -0xc]
0043e751 : MOV FS:[0x0],EAX
0043e757 : MOV ESI,ECX
0043e759 : CMP dword ptr [EDI + 0x8],0x7ffffffe
0043e760 : JC 0x0043e79e
0043e762 : PUSH 0x13
0043e764 : XOR ESI,ESI
0043e766 : PUSH 0xcca4c4
0043e76b : LEA ECX,[EBP + -0x2c]
0043e76e : MOV dword ptr [EBP + -0x14],0xf
0043e775 : MOV dword ptr [EBP + -0x18],ESI
0043e778 : MOV byte ptr [EBP + -0x28],0x0
0043e77c : CALL 0x00404b50
0043e781 : MOV dword ptr [EBP + -0x4],ESI
0043e784 : LEA EAX,[EBP + -0x2c]
0043e787 : PUSH EAX
0043e788 : LEA ECX,[EBP + -0x54]
0043e78b : CALL 0x00404af0
0043e790 : PUSH 0xced8cc
0043e795 : LEA ECX,[EBP + -0x54]
0043e798 : PUSH ECX
0043e799 : CALL 0x006409eb
0043e79e : MOV EDX,dword ptr [EBP + 0x10]
0043e7a1 : MOV EAX,dword ptr [EDI + 0x4]
0043e7a4 : PUSH 0x0
0043e7a6 : PUSH EDX
0043e7a7 : PUSH EAX
0043e7a8 : PUSH ESI
0043e7a9 : PUSH EAX
0043e7aa : CALL 0x0043e670
0043e7af : MOV ECX,EAX
0043e7b1 : MOV EAX,dword ptr [EDI + 0x4]
0043e7b4 : MOV EBX,0x1
0043e7b9 : ADD dword ptr [EDI + 0x8],EBX
0043e7bc : MOV dword ptr [EBP + 0x10],ECX
0043e7bf : CMP ESI,EAX
0043e7c1 : JNZ 0x0043e7d3
0043e7c3 : MOV dword ptr [EAX + 0x4],ECX
0043e7c6 : MOV EAX,dword ptr [EDI + 0x4]
0043e7c9 : MOV dword ptr [EAX],ECX
0043e7cb : MOV EDX,dword ptr [EDI + 0x4]
0043e7ce : MOV dword ptr [EDX + 0x8],ECX
0043e7d1 : JMP 0x0043e7f4
0043e7d3 : CMP byte ptr [EBP + 0xc],0x0
0043e7d7 : JZ 0x0043e7e6
0043e7d9 : MOV dword ptr [ESI],ECX
0043e7db : MOV EAX,dword ptr [EDI + 0x4]
0043e7de : CMP ESI,dword ptr [EAX]
0043e7e0 : JNZ 0x0043e7f4
0043e7e2 : MOV dword ptr [EAX],ECX
0043e7e4 : JMP 0x0043e7f4
0043e7e6 : MOV dword ptr [ESI + 0x8],ECX
0043e7e9 : MOV EAX,dword ptr [EDI + 0x4]
0043e7ec : CMP ESI,dword ptr [EAX + 0x8]
0043e7ef : JNZ 0x0043e7f4
0043e7f1 : MOV dword ptr [EAX + 0x8],ECX
0043e7f4 : MOV EDX,dword ptr [ECX + 0x4]
0043e7f7 : CMP byte ptr [EDX + 0xe],0x0
0043e7fb : LEA EAX,[ECX + 0x4]
0043e7fe : MOV ESI,ECX
0043e800 : JNZ 0x0043e8b2
0043e806 : MOV ECX,dword ptr [EAX]
0043e808 : MOV EDX,dword ptr [ECX + 0x4]
0043e80b : CMP ECX,dword ptr [EDX]
0043e80d : JNZ 0x0043e859
0043e80f : MOV EDX,dword ptr [EDX + 0x8]
0043e812 : CMP byte ptr [EDX + 0xe],0x0
0043e816 : JNZ 0x0043e82e
0043e818 : MOV byte ptr [ECX + 0xe],BL
0043e81b : MOV byte ptr [EDX + 0xe],BL
0043e81e : MOV EDX,dword ptr [EAX]
0043e820 : MOV ECX,dword ptr [EDX + 0x4]
0043e823 : MOV byte ptr [ECX + 0xe],0x0
0043e827 : MOV EDX,dword ptr [EAX]
0043e829 : MOV ESI,dword ptr [EDX + 0x4]
0043e82c : JMP 0x0043e89f
0043e82e : CMP ESI,dword ptr [ECX + 0x8]
0043e831 : JNZ 0x0043e83b
0043e833 : PUSH EDI
0043e834 : MOV ESI,ECX
0043e836 : CALL 0x0043de90
0043e83b : MOV EAX,dword ptr [ESI + 0x4]
0043e83e : MOV byte ptr [EAX + 0xe],BL
0043e841 : MOV ECX,dword ptr [ESI + 0x4]
0043e844 : MOV EDX,dword ptr [ECX + 0x4]
0043e847 : MOV byte ptr [EDX + 0xe],0x0
0043e84b : MOV EAX,dword ptr [ESI + 0x4]
0043e84e : MOV ECX,dword ptr [EAX + 0x4]
0043e851 : PUSH EDI
0043e852 : CALL 0x0043def0
0043e857 : JMP 0x0043e89f
0043e859 : MOV EDX,dword ptr [EDX]
0043e85b : CMP byte ptr [EDX + 0xe],0x0
0043e85f : JNZ 0x0043e877
0043e861 : MOV byte ptr [ECX + 0xe],BL
0043e864 : MOV byte ptr [EDX + 0xe],BL
0043e867 : MOV EDX,dword ptr [EAX]
0043e869 : MOV ECX,dword ptr [EDX + 0x4]
0043e86c : MOV byte ptr [ECX + 0xe],0x0
0043e870 : MOV EDX,dword ptr [EAX]
0043e872 : MOV ESI,dword ptr [EDX + 0x4]
0043e875 : JMP 0x0043e89f
0043e877 : CMP ESI,dword ptr [ECX]
0043e879 : JNZ 0x0043e883
0043e87b : PUSH EDI
0043e87c : MOV ESI,ECX
0043e87e : CALL 0x0043def0
0043e883 : MOV EAX,dword ptr [ESI + 0x4]
0043e886 : MOV byte ptr [EAX + 0xe],BL
0043e889 : MOV ECX,dword ptr [ESI + 0x4]
0043e88c : MOV EDX,dword ptr [ECX + 0x4]
0043e88f : MOV byte ptr [EDX + 0xe],0x0
0043e893 : MOV EAX,dword ptr [ESI + 0x4]
0043e896 : MOV ECX,dword ptr [EAX + 0x4]
0043e899 : PUSH EDI
0043e89a : CALL 0x0043de90
0043e89f : MOV ECX,dword ptr [ESI + 0x4]
0043e8a2 : CMP byte ptr [ECX + 0xe],0x0
0043e8a6 : LEA EAX,[ESI + 0x4]
0043e8a9 : JZ 0x0043e806
0043e8af : MOV ECX,dword ptr [EBP + 0x10]
0043e8b2 : MOV EDX,dword ptr [EDI + 0x4]
0043e8b5 : MOV EAX,dword ptr [EDX + 0x4]
0043e8b8 : MOV byte ptr [EAX + 0xe],BL
0043e8bb : MOV EAX,dword ptr [EBP + 0x8]
0043e8be : MOV dword ptr [EAX],ECX
0043e8c0 : MOV ECX,dword ptr [EBP + -0xc]
0043e8c3 : MOV dword ptr FS:[0x0],ECX
0043e8ca : POP ECX
0043e8cb : POP ESI
0043e8cc : POP EBX
0043e8cd : MOV ESP,EBP
0043e8cf : POP EBP
0043e8d0 : RET 0xc

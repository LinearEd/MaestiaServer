PROGRAM  : Maestia.exe
FUNCTION : FUN_00530bb0
ENTRY    : 00530bb0
BODY     : [[00530bb0, 00530f05]]

============================================================
DECOMPILED C CODE
============================================================

undefined1 FUN_00530bb0(uint *param_1,int *param_2)

{
  int *piVar1;
  int *piVar2;
  int iVar3;
  uint *puVar4;
  char cVar5;
  undefined1 uVar6;
  int iVar7;
  undefined4 *puVar8;
  int in_ECX;
  int *piVar9;
  int unaff_ESI;
  int local_30;
  undefined4 uStack_2c;
  undefined1 local_28 [16];
  uint *local_18;
  undefined1 *local_14;
  int *local_10;
  undefined4 local_c;
  int local_8;
  undefined4 local_4;
  
  puVar4 = param_1;
  if (*(int *)(*param_1 + 0x10) == 0) {
    return 0;
  }
  iVar7 = *(int *)(*(int *)(in_ECX + 0x78) + 8);
  piVar1 = (int *)(in_ECX + 0x78);
  *(int *)(iVar7 + 8) = *(int *)(iVar7 + 8) + 1;
  iVar3 = *(int *)(*piVar1 + 8);
  piVar2 = (int *)(iVar3 + 8);
  *piVar2 = *piVar2 + 1;
  local_28[0] = 0;
  local_c = 0;
  local_8 = 0;
  local_14 = local_28;
  local_18 = param_1;
  local_10 = param_2;
  local_4 = 4;
  param_1 = (uint *)iVar3;
  local_30 = iVar7;
  cVar5 = FUN_0052e6a0(&local_18);
  if (cVar5 != '\0') {
    FUN_00526bc0();
    *(int *)((int)param_1 + 8) = *(int *)((int)param_1 + 8) + -1;
    if (*(int *)((int)param_1 + 8) == 0) {
      FUN_00525340();
    }
    piVar1 = (int *)(iVar7 + 8);
    *piVar1 = *piVar1 + -1;
    if (*piVar1 != 0) {
      return 1;
    }
    FUN_00525340();
    return 1;
  }
  cVar5 = FUN_0052a650(piVar1,puVar4,&local_30,&param_1);
  if (cVar5 != '\0') {
    iVar7 = FUN_0052add0(&local_30,4);
    if (iVar7 != 0) {
      uVar6 = (**(code **)(*(int *)(iVar7 + 0x68) + 0x2c))(piVar1,&param_1,local_28);
      FUN_00526bc0();
      *(int *)(local_8 + 8) = *(int *)(local_8 + 8) + -1;
      if (*(int *)(local_8 + 8) == 0) {
        FUN_00525340();
      }
      piVar1 = (int *)(unaff_ESI + 8);
      *piVar1 = *piVar1 + -1;
      if (*piVar1 == 0) {
        FUN_00525340();
      }
      return uVar6;
    }
    FUN_00526bc0();
    *(int *)((int)param_1 + 8) = *(int *)((int)param_1 + 8) + -1;
    if (*(int *)((int)param_1 + 8) == 0) {
      FUN_00525340();
    }
    piVar1 = (int *)(local_30 + 8);
    *piVar1 = *piVar1 + -1;
    if (*piVar1 != 0) {
      return 0;
    }
    FUN_00525340();
    return 0;
  }
  if (param_2 == (int *)0x0) {
LAB_00530d75:
    iVar7 = FUN_00530560(puVar4);
    if ((iVar7 == 0) &&
       ((*(int *)(in_ECX + 0x74) == 0 ||
        (cVar5 = (**(code **)(*(int *)(*(int *)(in_ECX + 0x74) + 0x68) + 0x2c))
                           (piVar1,puVar4,local_28), cVar5 == '\0')))) {
      if (*(byte *)(in_ECX + 0x7c) < 7) {
        if (*(int *)(*puVar4 + 4) == 0) {
          FUN_00525a80();
        }
        iVar7 = *piVar1;
        puVar8 = (undefined4 *)*puVar4;
        iVar3 = puVar8[1];
        if (((*(int *)(*(int *)(iVar7 + 0xf4) + 4) == iVar3) ||
            (*(int *)(*(int *)(iVar7 + 0x100) + 4) == iVar3)) ||
           (*(int *)(*(int *)(iVar7 + 0xfc) + 4) == iVar3)) goto LAB_00530dc0;
      }
      else {
        iVar7 = *piVar1;
        puVar8 = (undefined4 *)*puVar4;
        if (((*(undefined4 **)(iVar7 + 0xf4) == puVar8) ||
            (*(undefined4 **)(iVar7 + 0x100) == puVar8)) ||
           (*(undefined4 **)(iVar7 + 0xfc) == puVar8)) goto LAB_00530dc0;
      }
      if (*(char *)*puVar8 == '_') {
        uStack_2c = CONCAT31(uStack_2c._1_3_,6 < *(byte *)(in_ECX + 0x7c));
        param_2 = (int *)0x0;
        iVar7 = FUN_0056a360((char *)*puVar8,&param_2,uStack_2c);
        if (((iVar7 == -1) || ((char)*param_2 != '\0')) ||
           (iVar7 = (**(code **)(**(int **)(in_ECX + 0x74) + 0x50))(iVar7), iVar7 == 0))
        goto LAB_00530eab;
      }
      else {
LAB_00530eab:
        if ((*(int *)(*piVar1 + 0x2a0) == 0) ||
           (cVar5 = (**(code **)(*(int *)(*(int *)(*piVar1 + 0x2a0) + 0x10) + 0x2c))
                              (piVar1,puVar4,local_28), cVar5 == '\0')) {
          FUN_00526bc0();
          *(int *)((int)param_1 + 8) = *(int *)((int)param_1 + 8) + -1;
          if (*(int *)((int)param_1 + 8) == 0) {
            FUN_00525340();
          }
          piVar1 = (int *)(local_30 + 8);
          *piVar1 = *piVar1 + -1;
          if (*piVar1 == 0) {
            FUN_00525340();
          }
          return 0;
        }
      }
      FUN_00526bc0();
      *(int *)((int)param_1 + 8) = *(int *)((int)param_1 + 8) + -1;
      if (*(int *)((int)param_1 + 8) == 0) {
        FUN_00525340();
      }
      piVar1 = (int *)(local_30 + 8);
      *piVar1 = *piVar1 + -1;
      iVar7 = *piVar1;
      goto LAB_00530de7;
    }
  }
  else {
    iVar7 = param_2[1];
    piVar2 = param_2;
joined_r0x00530d31:
    iVar7 = iVar7 + -1;
    if (iVar7 < 0) goto LAB_00530d75;
    iVar3 = *(int *)(*piVar2 + iVar7 * 8);
    if (*(int *)(*piVar2 + 4 + iVar7 * 8) < 0) {
      if (iVar3 == 0) goto joined_r0x00530d31;
      piVar9 = (int *)(iVar3 + 0x10);
    }
    else {
      if (iVar3 == 0) goto joined_r0x00530d31;
      piVar9 = (int *)(iVar3 + 0x68);
    }
    if ((piVar9 == (int *)0x0) ||
       (cVar5 = (**(code **)(*piVar9 + 0x2c))(piVar1,puVar4,local_28), piVar2 = param_2,
       cVar5 == '\0')) goto joined_r0x00530d31;
  }
LAB_00530dc0:
  FUN_00526bc0();
  *(int *)((int)param_1 + 8) = *(int *)((int)param_1 + 8) + -1;
  if (*(int *)((int)param_1 + 8) == 0) {
    FUN_00525340();
  }
  piVar1 = (int *)(local_30 + 8);
  *piVar1 = *piVar1 + -1;
  iVar7 = *piVar1;
LAB_00530de7:
  if (iVar7 == 0) {
    FUN_00525340();
  }
  return 1;
}



============================================================
DISASSEMBLY
============================================================
00530bb0 : SUB ESP,0x30
00530bb3 : PUSH EBX
00530bb4 : MOV EBX,dword ptr [ESP + 0x38]
00530bb8 : MOV EAX,dword ptr [EBX]
00530bba : PUSH EBP
00530bbb : MOV EBP,ECX
00530bbd : XOR ECX,ECX
00530bbf : CMP dword ptr [EAX + 0x10],ECX
00530bc2 : JNZ 0x00530bce
00530bc4 : POP EBP
00530bc5 : XOR AL,AL
00530bc7 : POP EBX
00530bc8 : ADD ESP,0x30
00530bcb : RET 0x8
00530bce : MOV EDX,dword ptr [EBP + 0x78]
00530bd1 : PUSH ESI
00530bd2 : MOV ESI,dword ptr [EDX + 0x8]
00530bd5 : PUSH EDI
00530bd6 : LEA EDI,[EBP + 0x78]
00530bd9 : MOV EDX,0x1
00530bde : ADD dword ptr [ESI + 0x8],EDX
00530be1 : MOV EAX,dword ptr [EDI]
00530be3 : MOV EAX,dword ptr [EAX + 0x8]
00530be6 : MOV dword ptr [ESP + 0x44],EAX
00530bea : ADD dword ptr [EAX + 0x8],EDX
00530bed : MOV EAX,dword ptr [ESP + 0x48]
00530bf1 : MOV byte ptr [ESP + 0x18],CL
00530bf5 : MOV dword ptr [ESP + 0x34],ECX
00530bf9 : MOV dword ptr [ESP + 0x38],ECX
00530bfd : LEA ECX,[ESP + 0x28]
00530c01 : LEA EDX,[ESP + 0x18]
00530c05 : PUSH ECX
00530c06 : MOV ECX,EBP
00530c08 : MOV dword ptr [ESP + 0x14],ESI
00530c0c : MOV dword ptr [ESP + 0x2c],EBX
00530c10 : MOV dword ptr [ESP + 0x30],EDX
00530c14 : MOV dword ptr [ESP + 0x34],EAX
00530c18 : MOV dword ptr [ESP + 0x40],0x4
00530c20 : CALL 0x0052e6a0
00530c25 : TEST AL,AL
00530c27 : JZ 0x00530c65
00530c29 : LEA ECX,[ESP + 0x18]
00530c2d : CALL 0x00526bc0
00530c32 : MOV EAX,dword ptr [ESP + 0x44]
00530c36 : DEC dword ptr [EAX + 0x8]
00530c39 : MOV ECX,EAX
00530c3b : ADD EAX,0x8
00530c3e : CMP dword ptr [EAX],0x0
00530c41 : JNZ 0x00530c48
00530c43 : CALL 0x00525340
00530c48 : ADD dword ptr [ESI + 0x8],-0x1
00530c4c : JNZ 0x00530dee
00530c52 : MOV ECX,ESI
00530c54 : CALL 0x00525340
00530c59 : POP EDI
00530c5a : POP ESI
00530c5b : POP EBP
00530c5c : MOV AL,0x1
00530c5e : POP EBX
00530c5f : ADD ESP,0x30
00530c62 : RET 0x8
00530c65 : LEA EDX,[ESP + 0x44]
00530c69 : PUSH EDX
00530c6a : LEA EAX,[ESP + 0x14]
00530c6e : PUSH EAX
00530c6f : PUSH EBX
00530c70 : PUSH EDI
00530c71 : CALL 0x0052a650
00530c76 : ADD ESP,0x10
00530c79 : TEST AL,AL
00530c7b : JZ 0x00530d23
00530c81 : PUSH 0x4
00530c83 : LEA ECX,[ESP + 0x14]
00530c87 : PUSH ECX
00530c88 : MOV ECX,EBP
00530c8a : CALL 0x0052add0
00530c8f : TEST EAX,EAX
00530c91 : JNZ 0x00530cd1
00530c93 : LEA ECX,[ESP + 0x18]
00530c97 : CALL 0x00526bc0
00530c9c : MOV EAX,dword ptr [ESP + 0x44]
00530ca0 : DEC dword ptr [EAX + 0x8]
00530ca3 : MOV ECX,EAX
00530ca5 : ADD EAX,0x8
00530ca8 : CMP dword ptr [EAX],0x0
00530cab : JNZ 0x00530cb2
00530cad : CALL 0x00525340
00530cb2 : MOV ECX,dword ptr [ESP + 0x10]
00530cb6 : ADD dword ptr [ECX + 0x8],-0x1
00530cba : JNZ 0x00530efa
00530cc0 : CALL 0x00525340
00530cc5 : POP EDI
00530cc6 : POP ESI
00530cc7 : POP EBP
00530cc8 : XOR AL,AL
00530cca : POP EBX
00530ccb : ADD ESP,0x30
00530cce : RET 0x8
00530cd1 : MOV EDX,dword ptr [EAX + 0x68]
00530cd4 : MOV EDX,dword ptr [EDX + 0x2c]
00530cd7 : LEA ECX,[EAX + 0x68]
00530cda : LEA EAX,[ESP + 0x18]
00530cde : PUSH EAX
00530cdf : LEA EAX,[ESP + 0x48]
00530ce3 : PUSH EAX
00530ce4 : PUSH EDI
00530ce5 : CALL EDX
00530ce7 : LEA ECX,[ESP + 0x18]
00530ceb : MOV BL,AL
00530ced : CALL 0x00526bc0
00530cf2 : MOV EAX,dword ptr [ESP + 0x44]
00530cf6 : DEC dword ptr [EAX + 0x8]
00530cf9 : MOV ECX,EAX
00530cfb : ADD EAX,0x8
00530cfe : CMP dword ptr [EAX],0x0
00530d01 : JNZ 0x00530d08
00530d03 : CALL 0x00525340
00530d08 : MOV ECX,dword ptr [ESP + 0x10]
00530d0c : ADD dword ptr [ECX + 0x8],-0x1
00530d10 : JNZ 0x00530d17
00530d12 : CALL 0x00525340
00530d17 : POP EDI
00530d18 : POP ESI
00530d19 : POP EBP
00530d1a : MOV AL,BL
00530d1c : POP EBX
00530d1d : ADD ESP,0x30
00530d20 : RET 0x8
00530d23 : MOV EDX,dword ptr [ESP + 0x48]
00530d27 : TEST EDX,EDX
00530d29 : JZ 0x00530d75
00530d2b : MOV ESI,dword ptr [EDX + 0x4]
00530d2e : SUB ESI,0x1
00530d31 : JS 0x00530d75
00530d33 : MOV EAX,dword ptr [EDX]
00530d35 : MOV ECX,dword ptr [EAX + ESI*0x8 + 0x4]
00530d39 : LEA EAX,[EAX + ESI*0x8]
00530d3c : MOV EAX,dword ptr [EAX]
00530d3e : SHR ECX,0x1f
00530d41 : TEST CL,0x1
00530d44 : JZ 0x00530d4f
00530d46 : TEST EAX,EAX
00530d48 : JZ 0x00530d70
00530d4a : LEA ECX,[EAX + 0x10]
00530d4d : JMP 0x00530d56
00530d4f : TEST EAX,EAX
00530d51 : JZ 0x00530d70
00530d53 : LEA ECX,[EAX + 0x68]
00530d56 : TEST ECX,ECX
00530d58 : JZ 0x00530d70
00530d5a : MOV EDX,dword ptr [ECX]
00530d5c : MOV EDX,dword ptr [EDX + 0x2c]
00530d5f : LEA EAX,[ESP + 0x18]
00530d63 : PUSH EAX
00530d64 : PUSH EBX
00530d65 : PUSH EDI
00530d66 : CALL EDX
00530d68 : TEST AL,AL
00530d6a : JNZ 0x00530dc0
00530d6c : MOV EDX,dword ptr [ESP + 0x48]
00530d70 : SUB ESI,0x1
00530d73 : JNS 0x00530d33
00530d75 : PUSH EBX
00530d76 : MOV ECX,EBP
00530d78 : CALL 0x00530560
00530d7d : TEST EAX,EAX
00530d7f : JNZ 0x00530dc0
00530d81 : CMP dword ptr [EBP + 0x74],EAX
00530d84 : JZ 0x00530d9e
00530d86 : MOV EAX,dword ptr [EBP + 0x74]
00530d89 : LEA ECX,[EAX + 0x68]
00530d8c : MOV EAX,dword ptr [ECX]
00530d8e : MOV EAX,dword ptr [EAX + 0x2c]
00530d91 : LEA EDX,[ESP + 0x18]
00530d95 : PUSH EDX
00530d96 : PUSH EBX
00530d97 : PUSH EDI
00530d98 : CALL EAX
00530d9a : TEST AL,AL
00530d9c : JNZ 0x00530dc0
00530d9e : CMP byte ptr [EBP + 0x7c],0x6
00530da2 : JBE 0x00530dfa
00530da4 : MOV ECX,dword ptr [EDI]
00530da6 : MOV EAX,dword ptr [EBX]
00530da8 : CMP dword ptr [ECX + 0xf4],EAX
00530dae : JZ 0x00530dc0
00530db0 : CMP dword ptr [ECX + 0x100],EAX
00530db6 : JZ 0x00530dc0
00530db8 : CMP dword ptr [ECX + 0xfc],EAX
00530dbe : JNZ 0x00530e2f
00530dc0 : LEA ECX,[ESP + 0x18]
00530dc4 : CALL 0x00526bc0
00530dc9 : MOV EAX,dword ptr [ESP + 0x44]
00530dcd : DEC dword ptr [EAX + 0x8]
00530dd0 : MOV ECX,EAX
00530dd2 : ADD EAX,0x8
00530dd5 : CMP dword ptr [EAX],0x0
00530dd8 : JNZ 0x00530ddf
00530dda : CALL 0x00525340
00530ddf : MOV ECX,dword ptr [ESP + 0x10]
00530de3 : ADD dword ptr [ECX + 0x8],-0x1
00530de7 : JNZ 0x00530dee
00530de9 : CALL 0x00525340
00530dee : POP EDI
00530def : POP ESI
00530df0 : POP EBP
00530df1 : MOV AL,0x1
00530df3 : POP EBX
00530df4 : ADD ESP,0x30
00530df7 : RET 0x8
00530dfa : MOV ECX,dword ptr [EBX]
00530dfc : CMP dword ptr [ECX + 0x4],0x0
00530e00 : JNZ 0x00530e07
00530e02 : CALL 0x00525a80
00530e07 : MOV ECX,dword ptr [EDI]
00530e09 : MOV EAX,dword ptr [EBX]
00530e0b : MOV EDX,dword ptr [EAX + 0x4]
00530e0e : MOV ESI,dword ptr [ECX + 0xf4]
00530e14 : CMP dword ptr [ESI + 0x4],EDX
00530e17 : JZ 0x00530dc0
00530e19 : MOV ESI,dword ptr [ECX + 0x100]
00530e1f : CMP dword ptr [ESI + 0x4],EDX
00530e22 : JZ 0x00530dc0
00530e24 : MOV ECX,dword ptr [ECX + 0xfc]
00530e2a : CMP dword ptr [ECX + 0x4],EDX
00530e2d : JZ 0x00530dc0
00530e2f : MOV EDX,dword ptr [EAX]
00530e31 : CMP byte ptr [EDX],0x5f
00530e34 : JNZ 0x00530ea8
00530e36 : CMP byte ptr [EBP + 0x7c],0x6
00530e3a : MOV EAX,EDX
00530e3c : SETA CL
00530e3f : MOV byte ptr [ESP + 0x14],CL
00530e43 : MOV EDX,dword ptr [ESP + 0x14]
00530e47 : PUSH EDX
00530e48 : LEA ECX,[ESP + 0x4c]
00530e4c : PUSH ECX
00530e4d : PUSH EAX
00530e4e : MOV dword ptr [ESP + 0x54],0x0
00530e56 : CALL 0x0056a360
00530e5b : OR ESI,0xffffffff
00530e5e : ADD ESP,0xc
00530e61 : CMP EAX,ESI
00530e63 : JZ 0x00530eab
00530e65 : MOV EDX,dword ptr [ESP + 0x48]
00530e69 : CMP byte ptr [EDX],0x0
00530e6c : JNZ 0x00530eab
00530e6e : MOV ECX,dword ptr [EBP + 0x74]
00530e71 : MOV EDX,dword ptr [ECX]
00530e73 : PUSH EAX
00530e74 : MOV EAX,dword ptr [EDX + 0x50]
00530e77 : CALL EAX
00530e79 : TEST EAX,EAX
00530e7b : JZ 0x00530eab
00530e7d : LEA ECX,[ESP + 0x18]
00530e81 : CALL 0x00526bc0
00530e86 : MOV EAX,dword ptr [ESP + 0x44]
00530e8a : ADD dword ptr [EAX + 0x8],ESI
00530e8d : MOV ECX,EAX
00530e8f : ADD EAX,0x8
00530e92 : CMP dword ptr [EAX],0x0
00530e95 : JNZ 0x00530e9c
00530e97 : CALL 0x00525340
00530e9c : MOV ECX,dword ptr [ESP + 0x10]
00530ea0 : ADD dword ptr [ECX + 0x8],ESI
00530ea3 : JMP 0x00530de7
00530ea8 : OR ESI,0xffffffff
00530eab : MOV ECX,dword ptr [EDI]
00530ead : MOV EAX,dword ptr [ECX + 0x2a0]
00530eb3 : TEST EAX,EAX
00530eb5 : JZ 0x00530ecd
00530eb7 : MOV EDX,dword ptr [EAX + 0x10]
00530eba : MOV EDX,dword ptr [EDX + 0x2c]
00530ebd : LEA ECX,[EAX + 0x10]
00530ec0 : LEA EAX,[ESP + 0x18]
00530ec4 : PUSH EAX
00530ec5 : PUSH EBX
00530ec6 : PUSH EDI
00530ec7 : CALL EDX
00530ec9 : TEST AL,AL
00530ecb : JNZ 0x00530e7d
00530ecd : LEA ECX,[ESP + 0x18]
00530ed1 : CALL 0x00526bc0
00530ed6 : MOV EAX,dword ptr [ESP + 0x44]
00530eda : ADD dword ptr [EAX + 0x8],ESI
00530edd : MOV ECX,EAX
00530edf : ADD EAX,0x8
00530ee2 : CMP dword ptr [EAX],0x0
00530ee5 : JNZ 0x00530eec
00530ee7 : CALL 0x00525340
00530eec : MOV ECX,dword ptr [ESP + 0x10]
00530ef0 : ADD dword ptr [ECX + 0x8],ESI
00530ef3 : JNZ 0x00530efa
00530ef5 : CALL 0x00525340
00530efa : POP EDI
00530efb : POP ESI
00530efc : POP EBP
00530efd : XOR AL,AL
00530eff : POP EBX
00530f00 : ADD ESP,0x30
00530f03 : RET 0x8

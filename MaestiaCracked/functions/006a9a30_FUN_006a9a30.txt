PROGRAM  : Maestia.exe
FUNCTION : FUN_006a9a30
ENTRY    : 006a9a30
BODY     : [[006a9a30, 006a9ba3]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006a9a30(void)

{
  byte *pbVar1;
  int iVar2;
  int iVar3;
  byte *pbVar4;
  uint *puVar5;
  uint uVar6;
  int iVar7;
  int *unaff_EDI;
  int local_8;
  undefined4 local_4;
  
  iVar2 = *unaff_EDI;
  local_8 = 0;
  local_4 = *(undefined4 *)(iVar2 + 0x1c);
  iVar3 = 0;
  if ((unaff_EDI[2] != 0) && (unaff_EDI[6] == 0)) {
    uVar6 = (uint)*(byte *)(unaff_EDI + 3);
    iVar3 = unaff_EDI[2] + 1;
    iVar7 = uVar6 * iVar3;
    iVar3 = FUN_0068a220(local_4,4,0,iVar3,0,&local_8);
    unaff_EDI[6] = iVar3;
    if ((local_8 == 0) &&
       ((local_8 = FUN_006877c0(iVar2,unaff_EDI[1] + 3), local_8 == 0 &&
        (local_8 = FUN_00688900(iVar2,iVar7), local_8 == 0)))) {
      pbVar4 = *(byte **)(iVar2 + 0x20);
      puVar5 = (uint *)unaff_EDI[6];
      pbVar1 = pbVar4 + iVar7;
      if (uVar6 == 1) {
        for (; pbVar4 < pbVar1; pbVar4 = pbVar4 + 1) {
          *puVar5 = (uint)*pbVar4;
          puVar5 = puVar5 + 1;
        }
      }
      else if (uVar6 == 2) {
        for (; pbVar4 < pbVar1; pbVar4 = pbVar4 + 2) {
          *puVar5 = (uint)CONCAT11(*pbVar4,pbVar4[1]);
          puVar5 = puVar5 + 1;
        }
      }
      else if (uVar6 == 3) {
        for (; pbVar4 < pbVar1; pbVar4 = pbVar4 + 3) {
          *puVar5 = (int)CONCAT21(CONCAT11(*pbVar4,pbVar4[1]),pbVar4[2]);
          puVar5 = puVar5 + 1;
        }
      }
      else {
        for (; pbVar4 < pbVar1; pbVar4 = pbVar4 + 4) {
          *puVar5 = CONCAT31(CONCAT21(CONCAT11(*pbVar4,pbVar4[1]),pbVar4[2]),pbVar4[3]);
          puVar5 = puVar5 + 1;
        }
      }
      FUN_006889b0(iVar2);
      if (local_8 == 0) {
        return 0;
      }
    }
    FUN_00687f30(local_4,unaff_EDI[6]);
    unaff_EDI[6] = 0;
    iVar3 = local_8;
  }
  return iVar3;
}



============================================================
DISASSEMBLY
============================================================
006a9a30 : SUB ESP,0x8
006a9a33 : XOR EAX,EAX
006a9a35 : PUSH EBP
006a9a36 : MOV EBP,dword ptr [EDI]
006a9a38 : MOV dword ptr [ESP + 0x4],EAX
006a9a3c : MOV ECX,dword ptr [EBP + 0x1c]
006a9a3f : MOV dword ptr [ESP + 0x8],ECX
006a9a43 : MOV ECX,dword ptr [EDI + 0x8]
006a9a46 : TEST ECX,ECX
006a9a48 : JBE 0x006a9b9f
006a9a4e : CMP dword ptr [EDI + 0x18],EAX
006a9a51 : JNZ 0x006a9b9f
006a9a57 : MOV DL,byte ptr [EDI + 0xc]
006a9a5a : PUSH EBX
006a9a5b : PUSH ESI
006a9a5c : MOVZX EBX,DL
006a9a5f : LEA EDX,[ESP + 0xc]
006a9a63 : PUSH EDX
006a9a64 : LEA EAX,[ECX + 0x1]
006a9a67 : PUSH 0x0
006a9a69 : PUSH EAX
006a9a6a : MOV ESI,EBX
006a9a6c : PUSH 0x0
006a9a6e : IMUL ESI,EAX
006a9a71 : MOV EAX,dword ptr [ESP + 0x20]
006a9a75 : PUSH 0x4
006a9a77 : PUSH EAX
006a9a78 : CALL 0x0068a220
006a9a7d : ADD ESP,0x18
006a9a80 : CMP dword ptr [ESP + 0xc],0x0
006a9a85 : MOV dword ptr [EDI + 0x18],EAX
006a9a88 : JNZ 0x006a9b81
006a9a8e : MOV ECX,dword ptr [EDI + 0x4]
006a9a91 : ADD ECX,0x3
006a9a94 : PUSH ECX
006a9a95 : PUSH EBP
006a9a96 : CALL 0x006877c0
006a9a9b : ADD ESP,0x8
006a9a9e : MOV dword ptr [ESP + 0xc],EAX
006a9aa2 : TEST EAX,EAX
006a9aa4 : JNZ 0x006a9b81
006a9aaa : PUSH ESI
006a9aab : PUSH EBP
006a9aac : CALL 0x00688900
006a9ab1 : ADD ESP,0x8
006a9ab4 : MOV dword ptr [ESP + 0xc],EAX
006a9ab8 : TEST EAX,EAX
006a9aba : JNZ 0x006a9b81
006a9ac0 : MOV EAX,dword ptr [EBP + 0x20]
006a9ac3 : MOV ECX,dword ptr [EDI + 0x18]
006a9ac6 : LEA EDX,[EAX + ESI*0x1]
006a9ac9 : MOV ESI,EBX
006a9acb : SUB ESI,0x1
006a9ace : JZ 0x006a9b5f
006a9ad4 : SUB ESI,0x1
006a9ad7 : JZ 0x006a9b39
006a9ad9 : SUB ESI,0x1
006a9adc : JZ 0x006a9b12
006a9ade : CMP EAX,EDX
006a9ae0 : JNC 0x006a9b70
006a9ae6 : MOVZX EBX,byte ptr [EAX]
006a9ae9 : MOVZX ESI,byte ptr [EAX + 0x1]
006a9aed : SHL EBX,0x8
006a9af0 : OR ESI,EBX
006a9af2 : MOVZX EBX,byte ptr [EAX + 0x2]
006a9af6 : SHL ESI,0x8
006a9af9 : OR ESI,EBX
006a9afb : MOVZX EBX,byte ptr [EAX + 0x3]
006a9aff : SHL ESI,0x8
006a9b02 : OR ESI,EBX
006a9b04 : MOV dword ptr [ECX],ESI
006a9b06 : ADD EAX,0x4
006a9b09 : ADD ECX,0x4
006a9b0c : CMP EAX,EDX
006a9b0e : JC 0x006a9ae6
006a9b10 : JMP 0x006a9b70
006a9b12 : CMP EAX,EDX
006a9b14 : JNC 0x006a9b70
006a9b16 : MOVSX EBX,byte ptr [EAX]
006a9b19 : MOVZX ESI,byte ptr [EAX + 0x1]
006a9b1d : SHL EBX,0x8
006a9b20 : OR ESI,EBX
006a9b22 : MOVZX EBX,byte ptr [EAX + 0x2]
006a9b26 : SHL ESI,0x8
006a9b29 : OR ESI,EBX
006a9b2b : MOV dword ptr [ECX],ESI
006a9b2d : ADD EAX,0x3
006a9b30 : ADD ECX,0x4
006a9b33 : CMP EAX,EDX
006a9b35 : JC 0x006a9b16
006a9b37 : JMP 0x006a9b70
006a9b39 : CMP EAX,EDX
006a9b3b : JNC 0x006a9b70
006a9b3d : LEA ECX,[ECX]
006a9b40 : MOVZX SI,byte ptr [EAX]
006a9b44 : MOVZX EBX,byte ptr [EAX + 0x1]
006a9b48 : SHL SI,0x8
006a9b4c : MOVZX ESI,SI
006a9b4f : OR ESI,EBX
006a9b51 : MOV dword ptr [ECX],ESI
006a9b53 : ADD EAX,0x2
006a9b56 : ADD ECX,0x4
006a9b59 : CMP EAX,EDX
006a9b5b : JC 0x006a9b40
006a9b5d : JMP 0x006a9b70
006a9b5f : CMP EAX,EDX
006a9b61 : JNC 0x006a9b70
006a9b63 : MOVZX ESI,byte ptr [EAX]
006a9b66 : MOV dword ptr [ECX],ESI
006a9b68 : INC EAX
006a9b69 : ADD ECX,0x4
006a9b6c : CMP EAX,EDX
006a9b6e : JC 0x006a9b63
006a9b70 : PUSH EBP
006a9b71 : CALL 0x006889b0
006a9b76 : MOV EAX,dword ptr [ESP + 0x10]
006a9b7a : ADD ESP,0x4
006a9b7d : TEST EAX,EAX
006a9b7f : JZ 0x006a9b9d
006a9b81 : MOV EDX,dword ptr [EDI + 0x18]
006a9b84 : MOV EAX,dword ptr [ESP + 0x10]
006a9b88 : PUSH EDX
006a9b89 : PUSH EAX
006a9b8a : CALL 0x00687f30
006a9b8f : MOV EAX,dword ptr [ESP + 0x14]
006a9b93 : ADD ESP,0x8
006a9b96 : MOV dword ptr [EDI + 0x18],0x0
006a9b9d : POP ESI
006a9b9e : POP EBX
006a9b9f : POP EBP
006a9ba0 : ADD ESP,0x8
006a9ba3 : RET

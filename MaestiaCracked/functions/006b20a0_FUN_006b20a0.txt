PROGRAM  : Maestia.exe
FUNCTION : FUN_006b20a0
ENTRY    : 006b20a0
BODY     : [[006b20a0, 006b240f]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006b20a0(undefined4 param_1,undefined4 *param_2,int param_3)

{
  char cVar1;
  char cVar2;
  byte bVar3;
  short sVar4;
  int *piVar5;
  short sVar6;
  short sVar7;
  int iVar8;
  int iVar9;
  undefined4 uVar10;
  int iVar11;
  byte *pbVar12;
  byte *pbVar13;
  char *pcVar14;
  byte *pbVar15;
  char *pcVar16;
  bool bVar17;
  undefined4 *local_c;
  undefined4 local_8;
  undefined2 local_4;
  undefined2 local_2;
  
  *param_2 = 1;
  iVar8 = FUN_00686e00(param_2[0x18],"postscript-cmaps");
  param_2[0x78] = iVar8;
  iVar9 = FUN_00686de0(*(undefined4 *)(param_2[0x18] + 4),"psaux");
  param_2[0x79] = iVar9;
  uVar10 = FUN_00686de0(*(undefined4 *)(param_2[0x18] + 4),"pshinter");
  param_2[0x89] = uVar10;
  iVar11 = FUN_006b0dc0(param_2);
  if (iVar11 != 0) {
    return iVar11;
  }
  if (param_3 < 0) {
    return 0;
  }
  if (param_3 != 0) {
    return 6;
  }
  param_2[4] = param_2[0x67];
  param_2[1] = 0;
  param_2[2] = 0xa11;
  if (*(char *)(param_2 + 0x27) != '\0') {
    param_2[2] = 0xa15;
  }
  if (param_2[0x84] != 0) {
    param_2[2] = param_2[2] | 0x100;
  }
  pcVar16 = (char *)param_2[0x24];
  param_2[5] = pcVar16;
  param_2[6] = 0;
  if (pcVar16 == (char *)0x0) {
    if (param_2[0x5a] != 0) {
      param_2[5] = param_2[0x5a];
    }
  }
  else {
    pcVar14 = (char *)param_2[0x23];
    if (pcVar14 != (char *)0x0) {
      cVar1 = *pcVar14;
      while (cVar1 != '\0') {
        cVar2 = *pcVar16;
        if (cVar1 == cVar2) {
          pcVar16 = pcVar16 + 1;
LAB_006b218e:
          pcVar14 = pcVar14 + 1;
        }
        else {
          if ((cVar1 == ' ') || (cVar1 == '-')) goto LAB_006b218e;
          if ((cVar2 != ' ') && (cVar2 != '-')) {
            if (*pcVar16 == '\0') {
              param_2[6] = pcVar14;
            }
            goto LAB_006b21c6;
          }
          pcVar16 = pcVar16 + 1;
        }
        cVar1 = *pcVar14;
      }
      param_2[6] = "Regular";
    }
  }
LAB_006b21c6:
  if (param_2[6] == 0) {
    if (param_2[0x25] == 0) {
      param_2[6] = "Regular";
    }
    else {
      param_2[6] = param_2[0x25];
    }
  }
  param_2[3] = 0;
  if (param_2[0x26] != 0) {
    param_2[3] = 1;
  }
  pbVar13 = (byte *)param_2[0x25];
  if (pbVar13 != (byte *)0x0) {
    pbVar15 = &DAT_00bd91cc;
    pbVar12 = pbVar13;
    do {
      bVar3 = *pbVar12;
      bVar17 = bVar3 < *pbVar15;
      if (bVar3 != *pbVar15) {
LAB_006b2220:
        iVar11 = (1 - (uint)bVar17) - (uint)(bVar17 != 0);
        goto LAB_006b2225;
      }
      if (bVar3 == 0) break;
      bVar3 = pbVar12[1];
      bVar17 = bVar3 < pbVar15[1];
      if (bVar3 != pbVar15[1]) goto LAB_006b2220;
      pbVar12 = pbVar12 + 2;
      pbVar15 = pbVar15 + 2;
    } while (bVar3 != 0);
    iVar11 = 0;
LAB_006b2225:
    if (iVar11 != 0) {
      pcVar16 = "Black";
      do {
        bVar3 = *pbVar13;
        bVar17 = bVar3 < (byte)*pcVar16;
        if (bVar3 != *pcVar16) {
LAB_006b2250:
          iVar11 = (1 - (uint)bVar17) - (uint)(bVar17 != 0);
          goto LAB_006b2255;
        }
        if (bVar3 == 0) break;
        bVar3 = pbVar13[1];
        bVar17 = bVar3 < ((byte *)pcVar16)[1];
        if (bVar3 != ((byte *)pcVar16)[1]) goto LAB_006b2250;
        pbVar13 = pbVar13 + 2;
        pcVar16 = (char *)((byte *)pcVar16 + 2);
      } while (bVar3 != 0);
      iVar11 = 0;
LAB_006b2255:
      if (iVar11 != 0) goto LAB_006b225d;
    }
    param_2[3] = param_2[3] | 2;
  }
LAB_006b225d:
  param_2[7] = 0;
  param_2[8] = 0;
  param_2[0xd] = (int)*(short *)((int)param_2 + 0x1ca);
  param_2[0xe] = (int)*(short *)((int)param_2 + 0x1ce);
  param_2[0xf] = param_2[0x74] + 0xffff >> 0x10;
  param_2[0x10] = param_2[0x75] + 0xffff >> 0x10;
  if (*(short *)(param_2 + 0x11) == 0) {
    *(undefined2 *)(param_2 + 0x11) = 1000;
  }
  sVar6 = (short)(param_2[0x75] + 0xffff >> 0x10);
  sVar4 = *(short *)(param_2 + 0xe);
  sVar7 = (short)(((uint)*(ushort *)(param_2 + 0x11) * 0xc) / 10);
  *(short *)((int)param_2 + 0x4a) = sVar7;
  *(short *)((int)param_2 + 0x46) = sVar6;
  *(short *)(param_2 + 0x12) = sVar4;
  if ((int)sVar7 < (int)sVar6 - (int)sVar4) {
    *(short *)((int)param_2 + 0x4a) = sVar6 - sVar4;
  }
  *(undefined2 *)(param_2 + 0x13) = *(undefined2 *)(param_2 + 0xf);
  iVar11 = FUN_006b1460();
  if (iVar11 == 0) {
    *(undefined2 *)(param_2 + 0x13) = param_2._0_2_;
  }
  *(undefined2 *)((int)param_2 + 0x4e) = *(undefined2 *)((int)param_2 + 0x4a);
  *(undefined2 *)(param_2 + 0x14) = *(undefined2 *)((int)param_2 + 0x9e);
  *(undefined2 *)((int)param_2 + 0x52) = *(undefined2 *)(param_2 + 0x28);
  if ((iVar8 != 0) && (iVar9 != 0)) {
    piVar5 = *(int **)(iVar9 + 0x14);
    local_c = param_2;
    local_4 = 3;
    local_2 = 1;
    local_8 = 0x756e6963;
    FUN_0068a570(piVar5[3],0,&local_c,0);
    local_4 = 7;
    switch(param_2[0x5b]) {
    case 1:
      local_8 = 0x41444243;
      local_2 = 2;
      iVar8 = piVar5[2];
      break;
    case 2:
      local_8 = 0x41444f42;
      local_2 = 0;
      iVar8 = *piVar5;
      break;
    case 3:
      local_8 = 0x6c617431;
      local_2 = 3;
      iVar8 = piVar5[3];
      break;
    case 4:
      local_8 = 0x41444245;
      local_2 = 1;
      iVar8 = piVar5[1];
      break;
    default:
      goto switchD_006b2393_default;
    }
    if (iVar8 != 0) {
      FUN_0068a570(iVar8,0,&local_c,0);
    }
  }
switchD_006b2393_default:
  return 0;
}



============================================================
DISASSEMBLY
============================================================
006b20a0 : SUB ESP,0x14
006b20a3 : PUSH EBX
006b20a4 : PUSH EBP
006b20a5 : PUSH ESI
006b20a6 : MOV ESI,dword ptr [ESP + 0x28]
006b20aa : MOV EAX,dword ptr [ESI + 0x60]
006b20ad : PUSH 0xbd9890
006b20b2 : PUSH EAX
006b20b3 : MOV dword ptr [ESI],0x1
006b20b9 : CALL 0x00686e00
006b20be : MOV dword ptr [ESI + 0x1e0],EAX
006b20c4 : MOV dword ptr [ESP + 0x14],EAX
006b20c8 : MOV EAX,dword ptr [ESI + 0x60]
006b20cb : MOV ECX,dword ptr [EAX + 0x4]
006b20ce : PUSH 0xbe8af8
006b20d3 : PUSH ECX
006b20d4 : CALL 0x00686de0
006b20d9 : MOV EDX,dword ptr [ESI + 0x60]
006b20dc : MOV dword ptr [ESP + 0x20],EAX
006b20e0 : MOV dword ptr [ESI + 0x1e4],EAX
006b20e6 : MOV EAX,dword ptr [EDX + 0x4]
006b20e9 : PUSH 0xbd9944
006b20ee : PUSH EAX
006b20ef : CALL 0x00686de0
006b20f4 : PUSH ESI
006b20f5 : MOV dword ptr [ESI + 0x224],EAX
006b20fb : CALL 0x006b0dc0
006b2100 : MOV EBX,EAX
006b2102 : XOR EBP,EBP
006b2104 : ADD ESP,0x1c
006b2107 : CMP EBX,EBP
006b2109 : JNZ 0x006b2407
006b210f : MOV EAX,dword ptr [ESP + 0x2c]
006b2113 : CMP EAX,EBP
006b2115 : JL 0x006b2407
006b211b : JZ 0x006b212b
006b211d : POP ESI
006b211e : MOV EBX,0x6
006b2123 : POP EBP
006b2124 : MOV EAX,EBX
006b2126 : POP EBX
006b2127 : ADD ESP,0x14
006b212a : RET
006b212b : MOV ECX,dword ptr [ESI + 0x19c]
006b2131 : MOV dword ptr [ESI + 0x10],ECX
006b2134 : MOV dword ptr [ESI + 0x4],EBP
006b2137 : MOV dword ptr [ESI + 0x8],0xa11
006b213e : CMP byte ptr [ESI + 0x9c],0x0
006b2145 : JZ 0x006b214e
006b2147 : MOV dword ptr [ESI + 0x8],0xa15
006b214e : CMP dword ptr [ESI + 0x210],EBP
006b2154 : JZ 0x006b215d
006b2156 : OR dword ptr [ESI + 0x8],0x100
006b215d : MOV EDX,dword ptr [ESI + 0x90]
006b2163 : MOV EAX,EDX
006b2165 : PUSH EDI
006b2166 : MOV dword ptr [ESI + 0x14],EDX
006b2169 : MOV dword ptr [ESI + 0x18],EBP
006b216c : MOV EBX,0xbd91c4
006b2171 : CMP EAX,EBP
006b2173 : JZ 0x006b21b9
006b2175 : MOV ECX,dword ptr [ESI + 0x8c]
006b217b : MOV EDI,EAX
006b217d : CMP ECX,EBP
006b217f : JZ 0x006b21c6
006b2181 : MOV AL,byte ptr [ECX]
006b2183 : TEST AL,AL
006b2185 : JZ 0x006b2195
006b2187 : MOV DL,byte ptr [EDI]
006b2189 : CMP AL,DL
006b218b : JNZ 0x006b219a
006b218d : INC EDI
006b218e : INC ECX
006b218f : MOV AL,byte ptr [ECX]
006b2191 : TEST AL,AL
006b2193 : JNZ 0x006b2187
006b2195 : MOV dword ptr [ESI + 0x18],EBX
006b2198 : JMP 0x006b21c6
006b219a : CMP AL,0x20
006b219c : JZ 0x006b218e
006b219e : CMP AL,0x2d
006b21a0 : JZ 0x006b218e
006b21a2 : CMP DL,0x20
006b21a5 : JZ 0x006b21ac
006b21a7 : CMP DL,0x2d
006b21aa : JNZ 0x006b21af
006b21ac : INC EDI
006b21ad : JMP 0x006b218f
006b21af : CMP byte ptr [EDI],0x0
006b21b2 : JNZ 0x006b21c6
006b21b4 : MOV dword ptr [ESI + 0x18],ECX
006b21b7 : JMP 0x006b21c6
006b21b9 : MOV EAX,dword ptr [ESI + 0x168]
006b21bf : CMP EAX,EBP
006b21c1 : JZ 0x006b21c6
006b21c3 : MOV dword ptr [ESI + 0x14],EAX
006b21c6 : CMP dword ptr [ESI + 0x18],EBP
006b21c9 : JNZ 0x006b21dd
006b21cb : MOV EAX,dword ptr [ESI + 0x94]
006b21d1 : CMP EAX,EBP
006b21d3 : JZ 0x006b21da
006b21d5 : MOV dword ptr [ESI + 0x18],EAX
006b21d8 : JMP 0x006b21dd
006b21da : MOV dword ptr [ESI + 0x18],EBX
006b21dd : MOV dword ptr [ESI + 0xc],EBP
006b21e0 : CMP dword ptr [ESI + 0x98],EBP
006b21e6 : JZ 0x006b21ef
006b21e8 : MOV dword ptr [ESI + 0xc],0x1
006b21ef : MOV EDI,dword ptr [ESI + 0x94]
006b21f5 : CMP EDI,EBP
006b21f7 : JZ 0x006b225d
006b21f9 : MOV ECX,0xbd91cc
006b21fe : MOV EAX,EDI
006b2200 : MOV DL,byte ptr [EAX]
006b2202 : CMP DL,byte ptr [ECX]
006b2204 : JNZ 0x006b2220
006b2206 : TEST DL,DL
006b2208 : JZ 0x006b221c
006b220a : MOV DL,byte ptr [EAX + 0x1]
006b220d : CMP DL,byte ptr [ECX + 0x1]
006b2210 : JNZ 0x006b2220
006b2212 : ADD EAX,0x2
006b2215 : ADD ECX,0x2
006b2218 : TEST DL,DL
006b221a : JNZ 0x006b2200
006b221c : XOR EAX,EAX
006b221e : JMP 0x006b2225
006b2220 : SBB EAX,EAX
006b2222 : SBB EAX,-0x1
006b2225 : CMP EAX,EBP
006b2227 : JZ 0x006b2259
006b2229 : MOV ECX,0xbea1b0
006b222e : MOV EAX,EDI
006b2230 : MOV DL,byte ptr [EAX]
006b2232 : CMP DL,byte ptr [ECX]
006b2234 : JNZ 0x006b2250
006b2236 : TEST DL,DL
006b2238 : JZ 0x006b224c
006b223a : MOV DL,byte ptr [EAX + 0x1]
006b223d : CMP DL,byte ptr [ECX + 0x1]
006b2240 : JNZ 0x006b2250
006b2242 : ADD EAX,0x2
006b2245 : ADD ECX,0x2
006b2248 : TEST DL,DL
006b224a : JNZ 0x006b2230
006b224c : XOR EAX,EAX
006b224e : JMP 0x006b2255
006b2250 : SBB EAX,EAX
006b2252 : SBB EAX,-0x1
006b2255 : CMP EAX,EBP
006b2257 : JNZ 0x006b225d
006b2259 : OR dword ptr [ESI + 0xc],0x2
006b225d : MOV dword ptr [ESI + 0x1c],EBP
006b2260 : MOV dword ptr [ESI + 0x20],EBP
006b2263 : MOVSX EAX,word ptr [ESI + 0x1ca]
006b226a : MOV dword ptr [ESI + 0x34],EAX
006b226d : MOVSX ECX,word ptr [ESI + 0x1ce]
006b2274 : MOV dword ptr [ESI + 0x38],ECX
006b2277 : MOV EDX,dword ptr [ESI + 0x1d0]
006b227d : ADD EDX,0xffff
006b2283 : SHR EDX,0x10
006b2286 : MOV dword ptr [ESI + 0x3c],EDX
006b2289 : MOV EAX,dword ptr [ESI + 0x1d4]
006b228f : ADD EAX,0xffff
006b2294 : SHR EAX,0x10
006b2297 : MOV dword ptr [ESI + 0x40],EAX
006b229a : CMP word ptr [ESI + 0x44],BP
006b229e : JNZ 0x006b22a9
006b22a0 : MOV ECX,0x3e8
006b22a5 : MOV word ptr [ESI + 0x44],CX
006b22a9 : MOVZX ECX,AX
006b22ac : MOVZX EAX,word ptr [ESI + 0x44]
006b22b0 : MOVZX EDI,word ptr [ESI + 0x38]
006b22b4 : LEA EDX,[EAX + EAX*0x2]
006b22b7 : ADD EDX,EDX
006b22b9 : ADD EDX,EDX
006b22bb : MOV EAX,0x66666667
006b22c0 : IMUL EDX
006b22c2 : SAR EDX,0x2
006b22c5 : MOV EAX,EDX
006b22c7 : SHR EAX,0x1f
006b22ca : ADD EAX,EDX
006b22cc : MOVSX EDX,DI
006b22cf : MOVSX EBX,CX
006b22d2 : MOV word ptr [ESI + 0x4a],AX
006b22d6 : CWDE
006b22d7 : SUB EBX,EDX
006b22d9 : CMP EAX,EBX
006b22db : MOV word ptr [ESI + 0x46],CX
006b22df : MOV word ptr [ESI + 0x48],DI
006b22e3 : JGE 0x006b22eb
006b22e5 : SUB ECX,EDI
006b22e7 : MOV word ptr [ESI + 0x4a],CX
006b22eb : MOV CX,word ptr [ESI + 0x3c]
006b22ef : LEA EBX,[ESP + 0x2c]
006b22f3 : MOV word ptr [ESI + 0x4c],CX
006b22f7 : CALL 0x006b1460
006b22fc : MOV EBX,EAX
006b22fe : TEST EBX,EBX
006b2300 : JNZ 0x006b230d
006b2302 : MOV DX,word ptr [ESP + 0x2c]
006b2307 : MOV word ptr [ESI + 0x4c],DX
006b230b : JMP 0x006b230f
006b230d : XOR EBX,EBX
006b230f : MOV AX,word ptr [ESI + 0x4a]
006b2313 : MOV word ptr [ESI + 0x4e],AX
006b2317 : MOV CX,word ptr [ESI + 0x9e]
006b231e : MOV word ptr [ESI + 0x50],CX
006b2322 : MOV DX,word ptr [ESI + 0xa0]
006b2329 : MOV word ptr [ESI + 0x52],DX
006b232d : CMP dword ptr [ESP + 0x10],EBP
006b2331 : JZ 0x006b2406
006b2337 : MOV EAX,dword ptr [ESP + 0x14]
006b233b : TEST EAX,EAX
006b233d : JZ 0x006b2406
006b2343 : MOV EDI,dword ptr [EAX + 0x14]
006b2346 : PUSH 0x0
006b2348 : LEA EDX,[ESP + 0x1c]
006b234c : MOV EAX,0x3
006b2351 : MOV ECX,0x1
006b2356 : PUSH EDX
006b2357 : MOV dword ptr [ESP + 0x20],ESI
006b235b : MOV word ptr [ESP + 0x28],AX
006b2360 : MOV word ptr [ESP + 0x2a],CX
006b2365 : MOV dword ptr [ESP + 0x24],0x756e6963
006b236d : MOV EAX,dword ptr [EDI + 0xc]
006b2370 : PUSH 0x0
006b2372 : PUSH EAX
006b2373 : CALL 0x0068a570
006b2378 : MOV ESI,dword ptr [ESI + 0x16c]
006b237e : LEA EAX,[ESI + -0x1]
006b2381 : ADD ESP,0x10
006b2384 : MOV ECX,0x7
006b2389 : MOV word ptr [ESP + 0x20],CX
006b238e : CMP EAX,0x3
006b2391 : JA 0x006b2406
006b2393 : JMP dword ptr [EAX*0x4 + 0x6b2410]
006b239a : XOR EDX,EDX
006b239c : MOV dword ptr [ESP + 0x1c],0x41444f42
006b23a4 : MOV word ptr [ESP + 0x22],DX
006b23a9 : MOV EDI,dword ptr [EDI]
006b23ab : JMP 0x006b23f0
006b23ad : MOV EAX,0x1
006b23b2 : MOV dword ptr [ESP + 0x1c],0x41444245
006b23ba : MOV word ptr [ESP + 0x22],AX
006b23bf : MOV EDI,dword ptr [EDI + 0x4]
006b23c2 : JMP 0x006b23f0
006b23c4 : MOV ECX,0x2
006b23c9 : MOV dword ptr [ESP + 0x1c],0x41444243
006b23d1 : MOV word ptr [ESP + 0x22],CX
006b23d6 : MOV EDI,dword ptr [EDI + 0x8]
006b23d9 : JMP 0x006b23f0
006b23db : MOV EDX,0x3
006b23e0 : MOV dword ptr [ESP + 0x1c],0x6c617431
006b23e8 : MOV word ptr [ESP + 0x22],DX
006b23ed : MOV EDI,dword ptr [EDI + 0xc]
006b23f0 : TEST EDI,EDI
006b23f2 : JZ 0x006b2406
006b23f4 : PUSH 0x0
006b23f6 : LEA EAX,[ESP + 0x1c]
006b23fa : PUSH EAX
006b23fb : PUSH 0x0
006b23fd : PUSH EDI
006b23fe : CALL 0x0068a570
006b2403 : ADD ESP,0x10
006b2406 : POP EDI
006b2407 : POP ESI
006b2408 : POP EBP
006b2409 : MOV EAX,EBX
006b240b : POP EBX
006b240c : ADD ESP,0x14
006b240f : RET

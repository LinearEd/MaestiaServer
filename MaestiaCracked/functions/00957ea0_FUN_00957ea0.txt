PROGRAM  : Maestia.exe
FUNCTION : FUN_00957ea0
ENTRY    : 00957ea0
BODY     : [[00957ea0, 009580cc]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00957ea0(undefined4 param_1)

{
  uint uVar1;
  uint8_t *packet;
  int iVar2;
  undefined4 uVar3;
  int in_ECX;
  byte bVar4;
  uint local_70;
  undefined1 local_6c [4];
  undefined2 local_68;
  undefined4 local_58;
  uint local_54;
  uint8_t *local_50;
  undefined1 local_4c [4];
  undefined2 local_48;
  undefined4 local_38;
  uint local_34;
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_00b4aa5c;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar2 = *(int *)ThreadLocalStoragePointer;
  bVar4 = (byte)((ulonglong)(*(byte *)(iVar2 + 0x18) + 1) % 3);
  *(byte *)(iVar2 + 0x18) = bVar4;
  local_50 = (uint8_t *)((uint)bVar4 * 0x2000 + 0x122cb8 + iVar2);
  if (local_50 == (uint8_t *)0x0) {
    packet = (uint8_t *)0x0;
  }
  else {
    local_50[0] = '\0';
    local_50[1] = '\0';
    local_50[2] = '=';
    local_50[3] = '\x04';
    *(undefined4 *)(local_50 + 4) = param_1;
    packet = local_50;
  }
  local_8 = 0xffffffff;
  local_14 = uVar1;
  if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
    FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),8,packet);
  }
  iVar2 = FUN_00a1a840(param_1);
  if (iVar2 == 0) {
    FUN_008018d0(L"[AvaGuiPcTrade::OnMsgInvited] Invalid Inviter",uVar1);
  }
  else {
    *(undefined4 *)(in_ECX + 0x4c) = param_1;
    local_18 = 7;
    local_1c = 0;
    local_2c = 0;
    FUN_00405eb0(iVar2 + 0xc,0,0xffffffff);
    local_8 = 1;
    FUN_00406460(L"IDS_PCTRADE_INVITED");
    local_8._0_1_ = 2;
    uVar3 = FUN_0081d120(local_4c);
    local_8._0_1_ = 3;
    uVar3 = FUN_00403450(local_6c,uVar3);
    local_8._0_1_ = 4;
    FUN_00405eb0(uVar3,0,0xffffffff);
    local_8 = CONCAT31(local_8._1_3_,3);
    if (7 < local_54) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_54 = 7;
    local_58 = 0;
    local_68 = 0;
    local_8 = CONCAT31(local_8._1_3_,2);
    if (7 < local_70) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_8 = CONCAT31(local_8._1_3_,1);
    if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_48 = 0;
    local_34 = 7;
    local_38 = 0;
    iVar2 = FUN_008ede80(in_ECX + 0x58,2);
    if (iVar2 == 0) {
      local_8 = 0xffffffff;
      if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
    }
    else {
      if (*(code **)(iVar2 + 0x60) != (code *)0x0) {
        (**(code **)(iVar2 + 0x60))(1,iVar2);
      }
      *(code **)(iVar2 + 0x60) = FUN_00957b10;
      local_8 = 0xffffffff;
      if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
    }
    local_8 = 0xffffffff;
    local_2c = 0;
    local_1c = 0;
    local_18 = 7;
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00957ea0 : PUSH EBP
00957ea1 : MOV EBP,ESP
00957ea3 : PUSH -0x1
00957ea5 : PUSH 0xb4aa5c
00957eaa : MOV EAX,FS:[0x0]
00957eb0 : PUSH EAX
00957eb1 : SUB ESP,0x78
00957eb4 : MOV EAX,[0x00d66fa0]
00957eb9 : XOR EAX,EBP
00957ebb : MOV dword ptr [EBP + -0x10],EAX
00957ebe : PUSH EBX
00957ebf : PUSH ESI
00957ec0 : PUSH EDI
00957ec1 : PUSH EAX
00957ec2 : LEA EAX,[EBP + -0xc]
00957ec5 : MOV FS:[0x0],EAX
00957ecb : MOV EBX,dword ptr [EBP + 0x8]
00957ece : MOV EAX,FS:[0x2c]
00957ed4 : MOV ESI,ECX
00957ed6 : MOV ECX,dword ptr [EAX]
00957ed8 : MOVZX EAX,byte ptr [ECX + 0x18]
00957edc : INC EAX
00957edd : CDQ
00957ede : MOV EDI,0x3
00957ee3 : IDIV EDI
00957ee5 : MOV byte ptr [ECX + 0x18],DL
00957ee8 : MOVZX EDX,DL
00957eeb : SHL EDX,0xd
00957eee : LEA EAX,[EDX + ECX*0x1 + 0x122cb8]
00957ef5 : MOV dword ptr [EBP + -0x4c],EAX
00957ef8 : MOV dword ptr [EBP + -0x4],0x0
00957eff : TEST EAX,EAX
00957f01 : JZ 0x00957f15
00957f03 : XOR ECX,ECX
00957f05 : MOV word ptr [EAX],CX
00957f08 : MOV byte ptr [EAX + 0x2],0x3d
00957f0c : MOV byte ptr [EAX + 0x3],0x4
00957f10 : MOV dword ptr [EAX + 0x4],EBX
00957f13 : JMP 0x00957f17
00957f15 : XOR EAX,EAX
00957f17 : MOV dword ptr [EBP + -0x4],0xffffffff
00957f1e : MOV EDX,dword ptr [0x017247d4]
00957f24 : MOV ECX,dword ptr [EDX + 0x4]
00957f27 : TEST ECX,ECX
00957f29 : JZ 0x00957f3b
00957f2b : CMP byte ptr [EDX + 0x8],0x0
00957f2f : JZ 0x00957f3b
00957f31 : PUSH 0x8
00957f33 : PUSH ECX
00957f34 : MOV EDI,EAX
00957f36 : CALL 0x00a0dd40
00957f3b : MOV ECX,dword ptr [0x00da93ec]
00957f41 : PUSH EBX
00957f42 : CALL 0x00a1a840
00957f47 : TEST EAX,EAX
00957f49 : JNZ 0x00957f63
00957f4b : MOV ESI,dword ptr [0x00da98e8]
00957f51 : PUSH 0xc76468
00957f56 : CALL 0x008018d0
00957f5b : ADD ESP,0x4
00957f5e : JMP 0x009580af
00957f63 : XOR EDX,EDX
00957f65 : PUSH -0x1
00957f67 : MOV dword ptr [ESI + 0x4c],EBX
00957f6a : ADD EAX,0xc
00957f6d : PUSH EDX
00957f6e : MOV EBX,0x7
00957f73 : PUSH EAX
00957f74 : LEA ECX,[EBP + -0x2c]
00957f77 : MOV dword ptr [EBP + -0x14],EBX
00957f7a : MOV dword ptr [EBP + -0x18],0x0
00957f81 : MOV word ptr [EBP + -0x28],DX
00957f85 : CALL 0x00405eb0
00957f8a : MOV dword ptr [EBP + -0x4],0x1
00957f91 : PUSH 0xc764c4
00957f96 : LEA ECX,[EBP + -0x48]
00957f99 : CALL 0x00406460
00957f9e : MOV byte ptr [EBP + -0x4],0x2
00957fa2 : MOV ECX,dword ptr [0x0172491c]
00957fa8 : LEA EAX,[EBP + -0x48]
00957fab : PUSH EAX
00957fac : LEA EDI,[EBP + 0xffffff7c]
00957fb2 : CALL 0x0081d120
00957fb7 : MOV byte ptr [EBP + -0x4],0x3
00957fbb : PUSH EAX
00957fbc : LEA ECX,[EBP + -0x68]
00957fbf : PUSH ECX
00957fc0 : LEA ECX,[EBP + -0x2c]
00957fc3 : CALL 0x00403450
00957fc8 : ADD ESP,0x8
00957fcb : MOV byte ptr [EBP + -0x4],0x4
00957fcf : PUSH -0x1
00957fd1 : PUSH 0x0
00957fd3 : ADD ESI,0x58
00957fd6 : PUSH EAX
00957fd7 : MOV ECX,ESI
00957fd9 : CALL 0x00405eb0
00957fde : MOV byte ptr [EBP + -0x4],0x3
00957fe2 : MOV EDI,0x8
00957fe7 : CMP dword ptr [EBP + -0x50],EDI
00957fea : JC 0x00957ff4
00957fec : MOV ECX,dword ptr [EBP + -0x64]
00957fef : CALL 0x006f04e0
00957ff4 : XOR EDX,EDX
00957ff6 : MOV dword ptr [EBP + -0x50],EBX
00957ff9 : MOV dword ptr [EBP + -0x54],0x0
00958000 : MOV word ptr [EBP + -0x64],DX
00958004 : MOV byte ptr [EBP + -0x4],0x2
00958008 : CMP dword ptr [EBP + -0x6c],EDI
0095800b : JC 0x00958015
0095800d : MOV ECX,dword ptr [EBP + -0x80]
00958010 : CALL 0x006f04e0
00958015 : XOR EAX,EAX
00958017 : MOV dword ptr [EBP + -0x6c],EBX
0095801a : MOV dword ptr [EBP + -0x70],0x0
00958021 : MOV word ptr [EBP + -0x80],AX
00958025 : MOV byte ptr [EBP + -0x4],0x1
00958029 : CMP dword ptr [EBP + -0x30],EDI
0095802c : JC 0x00958036
0095802e : MOV ECX,dword ptr [EBP + -0x44]
00958031 : CALL 0x006f04e0
00958036 : MOV EDX,dword ptr [0x00da9894]
0095803c : XOR ECX,ECX
0095803e : PUSH 0x2
00958040 : MOV word ptr [EBP + -0x44],CX
00958044 : MOV dword ptr [EBP + -0x30],EBX
00958047 : MOV dword ptr [EBP + -0x34],0x0
0095804e : MOV ECX,dword ptr [EDX]
00958050 : PUSH ESI
00958051 : CALL 0x008ede80
00958056 : MOV ESI,EAX
00958058 : TEST ESI,ESI
0095805a : JNZ 0x00958078
0095805c : MOV dword ptr [EBP + -0x4],0xffffffff
00958063 : CMP dword ptr [EBP + -0x14],EDI
00958066 : JC 0x00958070
00958068 : MOV ECX,dword ptr [EBP + -0x28]
0095806b : CALL 0x006f04e0
00958070 : XOR EAX,EAX
00958072 : MOV word ptr [EBP + -0x28],AX
00958076 : JMP 0x009580a5
00958078 : MOV EAX,dword ptr [ESI + 0x60]
0095807b : TEST EAX,EAX
0095807d : JZ 0x00958084
0095807f : PUSH ESI
00958080 : PUSH 0x1
00958082 : CALL EAX
00958084 : MOV dword ptr [ESI + 0x60],0x957b10
0095808b : MOV dword ptr [EBP + -0x4],0xffffffff
00958092 : CMP dword ptr [EBP + -0x14],EDI
00958095 : JC 0x0095809f
00958097 : MOV ECX,dword ptr [EBP + -0x28]
0095809a : CALL 0x006f04e0
0095809f : XOR ECX,ECX
009580a1 : MOV word ptr [EBP + -0x28],CX
009580a5 : MOV dword ptr [EBP + -0x18],0x0
009580ac : MOV dword ptr [EBP + -0x14],EBX
009580af : MOV ECX,dword ptr [EBP + -0xc]
009580b2 : MOV dword ptr FS:[0x0],ECX
009580b9 : POP ECX
009580ba : POP EDI
009580bb : POP ESI
009580bc : POP EBX
009580bd : MOV ECX,dword ptr [EBP + -0x10]
009580c0 : XOR ECX,EBP
009580c2 : CALL 0x00633e6b
009580c7 : MOV ESP,EBP
009580c9 : POP EBP
009580ca : RET 0x4

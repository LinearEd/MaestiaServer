PROGRAM  : Maestia.exe
FUNCTION : FUN_008e4660
ENTRY    : 008e4660
BODY     : [[008e4660, 008e4a38]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x008e4959) */
/* WARNING: Removing unreachable block (ram,0x008e4a05) */
/* WARNING: Removing unreachable block (ram,0x008e49a0) */
/* WARNING: Removing unreachable block (ram,0x008e471f) */
/* WARNING: Removing unreachable block (ram,0x008e4852) */

void FUN_008e4660(void)

{
  int iVar1;
  int *piVar2;
  uint uVar3;
  int in_ECX;
  int *piVar4;
  uint local_74;
  uint local_54;
  int local_50;
  uint local_34;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b63916;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  FUN_008e4550();
  FUN_00406360();
  local_8 = 0;
  piVar4 = *(int **)(in_ECX + 0x50);
  if (piVar4 != *(int **)(in_ECX + 0x54)) {
    do {
      iVar1 = *piVar4;
      FUN_004437f0();
      if (local_50 != *(int *)(in_ECX + 200)) {
        *(undefined4 *)(iVar1 + 0x28) = *(undefined4 *)(local_50 + 0x10);
      }
      piVar4 = piVar4 + 1;
    } while (piVar4 != *(int **)(in_ECX + 0x54));
  }
  piVar4 = *(int **)(in_ECX + 0x50);
  piVar2 = *(int **)(in_ECX + 0x54);
  if (piVar4 != piVar2) {
    do {
      if (*(int *)(*piVar4 + 4) == *(int *)(in_ECX + 0x60)) break;
      piVar4 = piVar4 + 1;
    } while (piVar4 != piVar2);
    if (piVar4 != piVar2) {
      FUN_00405c30();
      FUN_00404870();
      FUN_00404750();
      local_8._0_1_ = 1;
      FUN_00405c30();
      local_8._0_1_ = 0;
      if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      FUN_00404870();
      FUN_00404870();
      FUN_00404870();
      FUN_00406360();
      local_8._0_1_ = 2;
      FUN_00405eb0(*piVar4 + 0x30,0,0xffffffff);
      local_8 = (uint)local_8._1_3_ << 8;
      FUN_008f7470();
      local_8._0_1_ = 4;
      FUN_00405c30();
      local_8._0_1_ = 0;
      FUN_00404870();
      FUN_00404750();
      local_8._0_1_ = 5;
      FUN_00405c30();
      local_8._0_1_ = 0;
      if (7 < local_54) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      FUN_00404870();
      FUN_00406360();
      local_8._0_1_ = 6;
      FUN_0081d120();
      local_8._0_1_ = 7;
      FUN_00404750();
      local_8._0_1_ = 8;
      FUN_00405c30();
      local_8 = CONCAT31(local_8._1_3_,6);
      if (7 < local_74) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_8 = (uint)local_8._1_3_ << 8;
      iVar1 = *DAT_00da9894;
      if ((iVar1 != 0) && (*(int *)(iVar1 + 0x114) != 0)) {
        (**(code **)(**(int **)(iVar1 + 0x114) + 4))();
      }
    }
  }
  local_8 = 0xffffffff;
  ExceptionList = local_10;
  __security_check_cookie(uVar3 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008e4660 : PUSH EBP
008e4661 : MOV EBP,ESP
008e4663 : PUSH -0x1
008e4665 : PUSH 0xb63916
008e466a : MOV EAX,FS:[0x0]
008e4670 : PUSH EAX
008e4671 : SUB ESP,0x7c
008e4674 : MOV EAX,[0x00d66fa0]
008e4679 : XOR EAX,EBP
008e467b : MOV dword ptr [EBP + -0x10],EAX
008e467e : PUSH EBX
008e467f : PUSH ESI
008e4680 : PUSH EDI
008e4681 : PUSH EAX
008e4682 : LEA EAX,[EBP + -0xc]
008e4685 : MOV FS:[0x0],EAX
008e468b : MOV ESI,ECX
008e468d : CALL 0x008e4550
008e4692 : XOR EDI,EDI
008e4694 : PUSH EDI
008e4695 : XOR EAX,EAX
008e4697 : PUSH 0xc590bc
008e469c : LEA ECX,[EBP + -0x2c]
008e469f : MOV dword ptr [EBP + -0x14],0x7
008e46a6 : MOV dword ptr [EBP + -0x18],EDI
008e46a9 : MOV word ptr [EBP + -0x28],AX
008e46ad : CALL 0x00406360
008e46b2 : MOV dword ptr [EBP + -0x4],EDI
008e46b5 : MOV EBX,dword ptr [ESI + 0x50]
008e46b8 : MOV EAX,dword ptr [ESI + 0x54]
008e46bb : CMP EBX,EAX
008e46bd : JZ 0x008e46f1
008e46bf : NOP
008e46c0 : MOV EDI,dword ptr [EBX]
008e46c2 : LEA ECX,[EDI + 0x1c]
008e46c5 : PUSH ECX
008e46c6 : LEA EAX,[EBP + -0x4c]
008e46c9 : LEA ECX,[ESI + 0xc4]
008e46cf : CALL 0x004437f0
008e46d4 : MOV EAX,dword ptr [ESI + 0xc8]
008e46da : MOV ECX,dword ptr [EBP + -0x4c]
008e46dd : CMP ECX,EAX
008e46df : JZ 0x008e46e7
008e46e1 : MOV EDX,dword ptr [ECX + 0x10]
008e46e4 : MOV dword ptr [EDI + 0x28],EDX
008e46e7 : ADD EBX,0x4
008e46ea : CMP EBX,dword ptr [ESI + 0x54]
008e46ed : JNZ 0x008e46c0
008e46ef : XOR EDI,EDI
008e46f1 : MOV EBX,dword ptr [ESI + 0x50]
008e46f4 : MOV EAX,dword ptr [ESI + 0x54]
008e46f7 : CMP EBX,EAX
008e46f9 : JZ 0x008e4712
008e46fb : MOV ESI,dword ptr [ESI + 0x60]
008e46fe : MOV EDI,EDI
008e4700 : MOV ECX,dword ptr [EBX]
008e4702 : CMP dword ptr [ECX + 0x4],ESI
008e4705 : JZ 0x008e470e
008e4707 : ADD EBX,0x4
008e470a : CMP EBX,EAX
008e470c : JNZ 0x008e4700
008e470e : CMP EBX,EAX
008e4710 : JNZ 0x008e4735
008e4712 : MOV dword ptr [EBP + -0x4],0xffffffff
008e4719 : CMP dword ptr [EBP + -0x14],0x8
008e471d : JC 0x008e4727
008e471f : MOV ECX,dword ptr [EBP + -0x28]
008e4722 : CALL 0x006f04e0
008e4727 : XOR EDX,EDX
008e4729 : MOV dword ptr [EBP + -0x18],EDI
008e472c : MOV word ptr [EBP + -0x28],DX
008e4730 : JMP 0x008e4a16
008e4735 : MOV EAX,dword ptr [EBX]
008e4737 : PUSH -0x1
008e4739 : ADD EAX,0x4c
008e473c : PUSH EDI
008e473d : PUSH EAX
008e473e : LEA ECX,[EBP + -0x2c]
008e4741 : CALL 0x00405c30
008e4746 : PUSH 0x1
008e4748 : PUSH 0xc590c0
008e474d : LEA ESI,[EBP + -0x2c]
008e4750 : CALL 0x00404870
008e4755 : MOV EAX,dword ptr [EBX]
008e4757 : MOV ECX,dword ptr [EAX + 0xc]
008e475a : PUSH ECX
008e475b : PUSH 0xc590c4
008e4760 : LEA ESI,[EBP + -0x48]
008e4763 : CALL 0x00404750
008e4768 : ADD ESP,0x8
008e476b : MOV byte ptr [EBP + -0x4],0x1
008e476f : PUSH -0x1
008e4771 : PUSH EDI
008e4772 : PUSH EAX
008e4773 : LEA ECX,[EBP + -0x2c]
008e4776 : CALL 0x00405c30
008e477b : MOV byte ptr [EBP + -0x4],0x0
008e477f : CMP dword ptr [EBP + -0x30],0x8
008e4783 : JC 0x008e478d
008e4785 : MOV ECX,dword ptr [EBP + -0x44]
008e4788 : CALL 0x006f04e0
008e478d : PUSH 0x1
008e478f : XOR EDX,EDX
008e4791 : PUSH 0xc590cc
008e4796 : LEA ESI,[EBP + -0x2c]
008e4799 : MOV dword ptr [EBP + -0x30],0x7
008e47a0 : MOV dword ptr [EBP + -0x34],EDI
008e47a3 : MOV word ptr [EBP + -0x44],DX
008e47a7 : CALL 0x00404870
008e47ac : MOV EAX,dword ptr [EBX]
008e47ae : CMP byte ptr [EAX + 0x18],0x0
008e47b2 : PUSH 0x1
008e47b4 : JZ 0x008e47bd
008e47b6 : PUSH 0xc590d0
008e47bb : JMP 0x008e47c2
008e47bd : PUSH 0xc590d4
008e47c2 : CALL 0x00404870
008e47c7 : PUSH 0x1
008e47c9 : PUSH 0xc590d8
008e47ce : LEA ESI,[EBP + -0x2c]
008e47d1 : CALL 0x00404870
008e47d6 : SUB ESP,0x1c
008e47d9 : MOV ECX,ESP
008e47db : MOV dword ptr [EBP + -0x4c],ESP
008e47de : PUSH EDI
008e47df : MOV ESI,0x7
008e47e4 : XOR EDX,EDX
008e47e6 : MOV dword ptr [ECX + 0x18],ESI
008e47e9 : MOV dword ptr [ECX + 0x14],EDI
008e47ec : PUSH 0xc590dc
008e47f1 : MOV word ptr [ECX + 0x4],DX
008e47f5 : CALL 0x00406360
008e47fa : MOV byte ptr [EBP + -0x4],0x2
008e47fe : MOV EAX,dword ptr [EBX]
008e4800 : SUB ESP,0x1c
008e4803 : MOV ECX,ESP
008e4805 : MOV dword ptr [EBP + -0x6c],ESP
008e4808 : PUSH -0x1
008e480a : ADD EAX,0x30
008e480d : PUSH EDI
008e480e : XOR EDX,EDX
008e4810 : MOV dword ptr [ECX + 0x18],ESI
008e4813 : MOV dword ptr [ECX + 0x14],EDI
008e4816 : PUSH EAX
008e4817 : MOV word ptr [ECX + 0x4],DX
008e481b : CALL 0x00405eb0
008e4820 : MOV byte ptr [EBP + -0x4],0x3
008e4824 : MOV byte ptr [EBP + -0x4],0x0
008e4828 : LEA EDI,[EBP + -0x48]
008e482b : CALL 0x008f7470
008e4830 : ADD ESP,0x38
008e4833 : MOV byte ptr [EBP + -0x4],0x4
008e4837 : PUSH -0x1
008e4839 : PUSH 0x0
008e483b : PUSH EAX
008e483c : LEA ECX,[EBP + -0x2c]
008e483f : CALL 0x00405c30
008e4844 : MOV byte ptr [EBP + -0x4],0x0
008e4848 : MOV EDI,0x8
008e484d : CMP dword ptr [EBP + -0x30],EDI
008e4850 : JC 0x008e485a
008e4852 : MOV ECX,dword ptr [EBP + -0x44]
008e4855 : CALL 0x006f04e0
008e485a : PUSH 0x1
008e485c : XOR EAX,EAX
008e485e : PUSH 0xc590e0
008e4863 : LEA ESI,[EBP + -0x2c]
008e4866 : MOV dword ptr [EBP + -0x30],0x7
008e486d : MOV dword ptr [EBP + -0x34],0x0
008e4874 : MOV word ptr [EBP + -0x44],AX
008e4878 : CALL 0x00404870
008e487d : MOV ECX,dword ptr [EBX]
008e487f : MOV EDX,dword ptr [ECX + 0x4]
008e4882 : PUSH EDX
008e4883 : PUSH 0xc590e4
008e4888 : LEA ESI,[EBP + -0x68]
008e488b : CALL 0x00404750
008e4890 : ADD ESP,0x8
008e4893 : MOV byte ptr [EBP + -0x4],0x5
008e4897 : PUSH -0x1
008e4899 : PUSH 0x0
008e489b : PUSH EAX
008e489c : LEA ECX,[EBP + -0x2c]
008e489f : CALL 0x00405c30
008e48a4 : MOV byte ptr [EBP + -0x4],0x0
008e48a8 : CMP dword ptr [EBP + -0x50],EDI
008e48ab : JC 0x008e48b5
008e48ad : MOV ECX,dword ptr [EBP + -0x64]
008e48b0 : CALL 0x006f04e0
008e48b5 : PUSH 0x1
008e48b7 : XOR EAX,EAX
008e48b9 : MOV EDI,0x7
008e48be : PUSH 0xc590ec
008e48c3 : LEA ESI,[EBP + -0x2c]
008e48c6 : MOV dword ptr [EBP + -0x50],EDI
008e48c9 : MOV dword ptr [EBP + -0x54],0x0
008e48d0 : MOV word ptr [EBP + -0x64],AX
008e48d4 : CALL 0x00404870
008e48d9 : XOR ECX,ECX
008e48db : PUSH 0x19
008e48dd : MOV word ptr [EBP + -0x44],CX
008e48e1 : PUSH 0xc590f0
008e48e6 : LEA ECX,[EBP + -0x48]
008e48e9 : MOV dword ptr [EBP + -0x30],EDI
008e48ec : MOV dword ptr [EBP + -0x34],0x0
008e48f3 : CALL 0x00406360
008e48f8 : MOV byte ptr [EBP + -0x4],0x6
008e48fc : MOV ECX,dword ptr [0x0172491c]
008e4902 : LEA EDX,[EBP + -0x48]
008e4905 : PUSH EDX
008e4906 : LEA EDI,[EBP + 0xffffff78]
008e490c : CALL 0x0081d120
008e4911 : MOV byte ptr [EBP + -0x4],0x7
008e4915 : MOV EDI,0x8
008e491a : CMP dword ptr [EAX + 0x18],EDI
008e491d : JC 0x008e4924
008e491f : MOV EAX,dword ptr [EAX + 0x4]
008e4922 : JMP 0x008e4927
008e4924 : ADD EAX,0x4
008e4927 : PUSH EAX
008e4928 : MOV EAX,dword ptr [EBX]
008e492a : MOV ECX,dword ptr [EAX + 0x28]
008e492d : PUSH ECX
008e492e : PUSH 0xc59124
008e4933 : LEA ESI,[EBP + -0x68]
008e4936 : CALL 0x00404750
008e493b : ADD ESP,0xc
008e493e : MOV byte ptr [EBP + -0x4],0x8
008e4942 : PUSH -0x1
008e4944 : XOR ESI,ESI
008e4946 : PUSH ESI
008e4947 : PUSH EAX
008e4948 : LEA ECX,[EBP + -0x2c]
008e494b : CALL 0x00405c30
008e4950 : MOV byte ptr [EBP + -0x4],0x7
008e4954 : CMP dword ptr [EBP + -0x50],EDI
008e4957 : JC 0x008e4961
008e4959 : MOV ECX,dword ptr [EBP + -0x64]
008e495c : CALL 0x006f04e0
008e4961 : XOR EDX,EDX
008e4963 : MOV dword ptr [EBP + -0x50],0x7
008e496a : MOV dword ptr [EBP + -0x54],ESI
008e496d : MOV word ptr [EBP + -0x64],DX
008e4971 : MOV byte ptr [EBP + -0x4],0x6
008e4975 : CMP dword ptr [EBP + -0x70],EDI
008e4978 : JC 0x008e4985
008e497a : MOV ECX,dword ptr [EBP + 0xffffff7c]
008e4980 : CALL 0x006f04e0
008e4985 : XOR EAX,EAX
008e4987 : MOV dword ptr [EBP + -0x70],0x7
008e498e : MOV dword ptr [EBP + -0x74],ESI
008e4991 : MOV word ptr [EBP + 0xffffff7c],AX
008e4998 : MOV byte ptr [EBP + -0x4],AL
008e499b : CMP dword ptr [EBP + -0x30],EDI
008e499e : JC 0x008e49a8
008e49a0 : MOV ECX,dword ptr [EBP + -0x44]
008e49a3 : CALL 0x006f04e0
008e49a8 : MOV EDX,dword ptr [0x00da9894]
008e49ae : XOR ECX,ECX
008e49b0 : MOV dword ptr [EBP + -0x30],0x7
008e49b7 : MOV dword ptr [EBP + -0x34],ESI
008e49ba : MOV word ptr [EBP + -0x44],CX
008e49be : MOV EAX,dword ptr [EDX]
008e49c0 : CMP EAX,ESI
008e49c2 : JZ 0x008e49f9
008e49c4 : CMP dword ptr [EAX + 0x114],ESI
008e49ca : JZ 0x008e49f9
008e49cc : MOV EAX,dword ptr [EAX + 0x114]
008e49d2 : MOV ECX,dword ptr [EBP + -0x28]
008e49d5 : CMP dword ptr [EBP + -0x14],EDI
008e49d8 : JNC 0x008e49dd
008e49da : LEA ECX,[EBP + -0x28]
008e49dd : MOV EDX,dword ptr [EAX]
008e49df : MOV EDX,dword ptr [EDX + 0x4]
008e49e2 : PUSH ECX
008e49e3 : MOV ECX,dword ptr [EBX]
008e49e5 : MOV ECX,dword ptr [ECX + 0x4]
008e49e8 : PUSH ECX
008e49e9 : PUSH 0xc59130
008e49ee : PUSH 0xc59138
008e49f3 : PUSH EAX
008e49f4 : CALL EDX
008e49f6 : ADD ESP,0x14
008e49f9 : MOV dword ptr [EBP + -0x4],0xffffffff
008e4a00 : CMP dword ptr [EBP + -0x14],EDI
008e4a03 : JC 0x008e4a0d
008e4a05 : MOV ECX,dword ptr [EBP + -0x28]
008e4a08 : CALL 0x006f04e0
008e4a0d : XOR EAX,EAX
008e4a0f : MOV dword ptr [EBP + -0x18],ESI
008e4a12 : MOV word ptr [EBP + -0x28],AX
008e4a16 : MOV dword ptr [EBP + -0x14],0x7
008e4a1d : MOV ECX,dword ptr [EBP + -0xc]
008e4a20 : MOV dword ptr FS:[0x0],ECX
008e4a27 : POP ECX
008e4a28 : POP EDI
008e4a29 : POP ESI
008e4a2a : POP EBX
008e4a2b : MOV ECX,dword ptr [EBP + -0x10]
008e4a2e : XOR ECX,EBP
008e4a30 : CALL 0x00633e6b
008e4a35 : MOV ESP,EBP
008e4a37 : POP EBP
008e4a38 : RET

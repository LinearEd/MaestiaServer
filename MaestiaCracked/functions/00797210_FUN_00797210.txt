PROGRAM  : Maestia.exe
FUNCTION : FUN_00797210
ENTRY    : 00797210
BODY     : [[00797210, 0079732a]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00797210(undefined4 param_1,int *param_2,int param_3)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int *piVar3;
  int iVar4;
  int in_ECX;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b0fea4;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if ((*(char *)(in_ECX + 0x2d4) != '\0') && (*(char *)(in_ECX + 0x259) != '\0')) {
    if (param_3 == 2) {
      param_3 = FUN_007f2d40(DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
    }
    if (param_3 != 0) {
      FUN_00796d90();
      if (*(int *)(in_ECX + 8) != 0) {
        EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
      }
      local_8 = 0;
      puVar1 = *(undefined4 **)(in_ECX + 0x188);
      for (puVar2 = (undefined4 *)*puVar1; puVar2 != puVar1; puVar2 = (undefined4 *)*puVar2) {
        piVar3 = (int *)puVar2[9];
        if (((piVar3 != (int *)0x0) && (iVar4 = (**(code **)(*piVar3 + 4))(), iVar4 == 0x14)) &&
           (*(char *)((int)piVar3 + 0x71) != '\0')) {
          iVar4 = param_3;
          if (param_3 == 2) {
            iVar4 = FUN_007f2d40();
          }
          if (iVar4 != 0) {
            (**(code **)(*param_2 + 0x10))(piVar3,param_1,0);
          }
        }
      }
      local_8 = 0xffffffff;
      if (*(int *)(in_ECX + 8) != 0) {
        LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
      }
      ExceptionList = local_10;
      return 1;
    }
  }
  ExceptionList = local_10;
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00797210 : PUSH EBP
00797211 : MOV EBP,ESP
00797213 : PUSH -0x1
00797215 : PUSH 0xb0fea4
0079721a : MOV EAX,FS:[0x0]
00797220 : PUSH EAX
00797221 : SUB ESP,0x8
00797224 : PUSH EBX
00797225 : PUSH ESI
00797226 : PUSH EDI
00797227 : MOV EAX,[0x00d66fa0]
0079722c : XOR EAX,EBP
0079722e : PUSH EAX
0079722f : LEA EAX,[EBP + -0xc]
00797232 : MOV FS:[0x0],EAX
00797238 : MOV ESI,ECX
0079723a : CMP byte ptr [ESI + 0x2d4],0x0
00797241 : JNZ 0x00797259
00797243 : XOR AL,AL
00797245 : MOV ECX,dword ptr [EBP + -0xc]
00797248 : MOV dword ptr FS:[0x0],ECX
0079724f : POP ECX
00797250 : POP EDI
00797251 : POP ESI
00797252 : POP EBX
00797253 : MOV ESP,EBP
00797255 : POP EBP
00797256 : RET 0xc
00797259 : CMP byte ptr [ESI + 0x259],0x0
00797260 : JZ 0x00797243
00797262 : CMP dword ptr [EBP + 0x10],0x2
00797266 : JNZ 0x00797279
00797268 : MOV EDX,dword ptr [EBP + 0x8]
0079726b : LEA EAX,[ESI + 0x1ac]
00797271 : CALL 0x007f2d40
00797276 : MOV dword ptr [EBP + 0x10],EAX
00797279 : CMP dword ptr [EBP + 0x10],0x0
0079727d : JZ 0x00797243
0079727f : CALL 0x00796d90
00797284 : MOV EAX,dword ptr [ESI + 0x8]
00797287 : MOV dword ptr [EBP + -0x14],ESI
0079728a : TEST EAX,EAX
0079728c : JZ 0x00797298
0079728e : ADD EAX,0x4
00797291 : PUSH EAX
00797292 : CALL dword ptr [0x00b85118]
00797298 : MOV dword ptr [EBP + -0x4],0x0
0079729f : MOV EAX,dword ptr [ESI + 0x188]
007972a5 : MOV EBX,dword ptr [EAX]
007972a7 : MOV dword ptr [EBP + -0x10],EAX
007972aa : CMP EBX,EAX
007972ac : JZ 0x007972fd
007972ae : MOV EDI,EDI
007972b0 : MOV EDI,dword ptr [EBX + 0x24]
007972b3 : TEST EDI,EDI
007972b5 : JZ 0x007972f6
007972b7 : MOV EAX,dword ptr [EDI]
007972b9 : MOV EDX,dword ptr [EAX + 0x4]
007972bc : MOV ECX,EDI
007972be : CALL EDX
007972c0 : CMP EAX,0x14
007972c3 : JNZ 0x007972f6
007972c5 : CMP byte ptr [EDI + 0x71],0x0
007972c9 : JZ 0x007972f6
007972cb : MOV EAX,dword ptr [EBP + 0x10]
007972ce : CMP EAX,0x2
007972d1 : JNZ 0x007972e1
007972d3 : MOV EDX,dword ptr [EBP + 0x8]
007972d6 : LEA EAX,[ESI + 0x1ac]
007972dc : CALL 0x007f2d40
007972e1 : TEST EAX,EAX
007972e3 : JZ 0x007972f6
007972e5 : MOV ECX,dword ptr [EBP + 0xc]
007972e8 : MOV EDX,dword ptr [EBP + 0x8]
007972eb : MOV EAX,dword ptr [ECX]
007972ed : MOV EAX,dword ptr [EAX + 0x10]
007972f0 : PUSH 0x0
007972f2 : PUSH EDX
007972f3 : PUSH EDI
007972f4 : CALL EAX
007972f6 : MOV EBX,dword ptr [EBX]
007972f8 : CMP EBX,dword ptr [EBP + -0x10]
007972fb : JNZ 0x007972b0
007972fd : MOV dword ptr [EBP + -0x4],0xffffffff
00797304 : MOV ESI,dword ptr [ESI + 0x8]
00797307 : TEST ESI,ESI
00797309 : JZ 0x00797315
0079730b : ADD ESI,0x4
0079730e : PUSH ESI
0079730f : CALL dword ptr [0x00b8511c]
00797315 : MOV AL,0x1
00797317 : MOV ECX,dword ptr [EBP + -0xc]
0079731a : MOV dword ptr FS:[0x0],ECX
00797321 : POP ECX
00797322 : POP EDI
00797323 : POP ESI
00797324 : POP EBX
00797325 : MOV ESP,EBP
00797327 : POP EBP
00797328 : RET 0xc

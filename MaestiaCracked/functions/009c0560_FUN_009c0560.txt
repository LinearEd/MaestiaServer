PROGRAM  : Maestia.exe
FUNCTION : FUN_009c0560
ENTRY    : 009c0560
BODY     : [[009c0560, 009c098e]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_009c0560(int *param_1)

{
  wchar_t wVar1;
  short sVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  short *psVar6;
  wchar_t *pwVar7;
  int in_ECX;
  int iVar8;
  uint *puVar9;
  uint *puVar10;
  uint *puVar11;
  tm local_415c;
  uint local_4138 [3];
  int *local_412c;
  int local_4128;
  int local_4124;
  uint *local_4120;
  undefined4 local_411c;
  wchar_t local_4118;
  undefined1 local_4116 [16382];
  short local_118 [128];
  uint local_18;
  undefined4 uStack_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b21bff;
  local_10 = ExceptionList;
  uStack_14 = 0x9c057b;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_18 = uVar4;
  ExceptionList = &local_10;
  local_412c = param_1;
  puVar9 = (uint *)(param_1 + 0x22a);
  puVar10 = (uint *)(in_ECX + 8);
  puVar11 = puVar9;
  for (iVar8 = 0x2d; iVar8 != 0; iVar8 = iVar8 + -1) {
    *puVar11 = *puVar10;
    puVar10 = puVar10 + 1;
    puVar11 = puVar11 + 1;
  }
  local_4118 = L'\0';
  local_4128 = 0;
  do {
    iVar8 = local_4128;
    pwVar7 = &local_4118;
    do {
      wVar1 = *pwVar7;
      pwVar7 = pwVar7 + 1;
    } while (wVar1 != L'\0');
    iVar5 = (int)pwVar7 - (int)local_4116 >> 1;
    uVar3 = *puVar9;
    local_4120 = puVar9;
    local_411c = iVar5;
    if (uVar3 == 0) {
      __snwprintf((wchar_t *)(local_4116 + iVar5 * 2 + -2),0x2000 - iVar5,L"-&",uVar4);
    }
    else if ((((local_4128 == 3) || (local_4128 == 6)) || (local_4128 == 4)) || (local_4128 == 0x18)
            ) {
      local_4138[1] = 0;
      local_4138[0] = uVar3;
      __localtime64_s(&local_415c,(__time64_t *)local_4138);
      __snwprintf((wchar_t *)(local_4116 + iVar5 * 2 + -2),0x2000 - iVar5,L"%d-%d-%d %d:%d&",
                  local_415c.tm_year + 0x76c,local_415c.tm_mon + 1,local_415c.tm_mday,
                  local_415c.tm_hour,local_415c.tm_min);
    }
    else if (((local_4128 == 1) || (local_4128 == 2)) ||
            ((local_4128 == 0xc || (local_4128 == 0x1b)))) {
      iVar8 = (int)(((ulonglong)uVar3 / 0xe10) % 0x18);
      local_4124 = (int)(((ulonglong)uVar3 / 0x3c) % 0x3c);
      local_118[0] = 0;
      if (uVar3 / 0x15180 != 0) {
        iVar5 = FUN_0081cbe0(DAT_0172491c);
        local_8 = 0;
        if (*(uint *)(iVar5 + 0x18) < 8) {
          iVar5 = iVar5 + 4;
        }
        else {
          iVar5 = *(int *)(iVar5 + 4);
        }
        FUN_0040e4a0(L"%d%s ",uVar3 / 0x15180,iVar5);
        local_8 = 0xffffffff;
        FUN_00406560();
      }
      if (iVar8 != 0) {
        psVar6 = local_118;
        do {
          sVar2 = *psVar6;
          psVar6 = psVar6 + 1;
        } while (sVar2 != 0);
        iVar5 = FUN_0081cbe0(DAT_0172491c);
        local_8 = 1;
        if (*(uint *)(iVar5 + 0x18) < 8) {
          iVar5 = iVar5 + 4;
        }
        else {
          iVar5 = *(int *)(iVar5 + 4);
        }
        FUN_0040e4a0(L"%d%s ",iVar8,iVar5);
        local_8 = 0xffffffff;
        FUN_00406560();
      }
      if (0 < local_4124) {
        psVar6 = local_118;
        do {
          sVar2 = *psVar6;
          psVar6 = psVar6 + 1;
        } while (sVar2 != 0);
        iVar8 = FUN_0081cbe0(DAT_0172491c);
        local_8 = 2;
        if (*(uint *)(iVar8 + 0x18) < 8) {
          iVar8 = iVar8 + 4;
        }
        else {
          iVar8 = *(int *)(iVar8 + 4);
        }
        FUN_0040e4a0(L"%d%s",local_4124,iVar8);
        local_8 = 0xffffffff;
        FUN_00406560();
      }
      if (local_118[0] == 0) {
        iVar8 = FUN_0081cbe0(DAT_0172491c);
        local_8 = 3;
        if (*(uint *)(iVar8 + 0x18) < 8) {
          iVar8 = iVar8 + 4;
        }
        else {
          iVar8 = *(int *)(iVar8 + 4);
        }
        FUN_0040e4a0(L"%d%s",*local_4120,iVar8);
        local_8 = 0xffffffff;
        FUN_00406560();
      }
      __snwprintf((wchar_t *)(local_4116 + local_411c * 2 + -2),0x2000 - local_411c,L"%s&",local_118
                 );
      puVar9 = local_4120;
      iVar8 = local_4128;
    }
    else {
      __snwprintf((wchar_t *)(local_4116 + iVar5 * 2 + -2),0x2000 - iVar5,L"%d&",uVar3);
    }
    local_4128 = iVar8 + 1;
    puVar9 = puVar9 + 1;
  } while (local_4128 < 0x2d);
  pwVar7 = &local_4118;
  do {
    wVar1 = *pwVar7;
    pwVar7 = pwVar7 + 1;
  } while (wVar1 != L'\0');
  iVar8 = (int)pwVar7 - (int)local_4116 >> 1;
  if (0 < iVar8) {
    *(undefined2 *)((int)&local_411c + iVar8 * 2 + 2) = 0;
  }
  local_4120 = puVar9;
  (**(code **)(*local_412c + 8))(&local_4118);
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
009c0560 : PUSH EBP
009c0561 : MOV EBP,ESP
009c0563 : PUSH -0x1
009c0565 : PUSH 0xb21bff
009c056a : MOV EAX,FS:[0x0]
009c0570 : PUSH EAX
009c0571 : MOV EAX,0x41c0
009c0576 : CALL 0x0063b780
009c057b : MOV EAX,[0x00d66fa0]
009c0580 : XOR EAX,EBP
009c0582 : MOV dword ptr [EBP + -0x14],EAX
009c0585 : PUSH EBX
009c0586 : PUSH ESI
009c0587 : PUSH EDI
009c0588 : PUSH EAX
009c0589 : LEA EAX,[EBP + -0xc]
009c058c : MOV FS:[0x0],EAX
009c0592 : MOV EAX,dword ptr [EBP + 0x8]
009c0595 : MOV ESI,ECX
009c0597 : MOV dword ptr [EBP + 0xffffbed8],EAX
009c059d : ADD EAX,0x8a8
009c05a2 : ADD ESI,0x8
009c05a5 : MOV ECX,0x2d
009c05aa : MOV EDI,EAX
009c05ac : MOVSD.REP ES:EDI,ESI
009c05ae : XOR ECX,ECX
009c05b0 : XOR EDI,EDI
009c05b2 : MOV word ptr [EBP + 0xffffbeec],CX
009c05b9 : MOV dword ptr [EBP + 0xffffbedc],EDI
009c05bf : MOV EBX,EAX
009c05c1 : MOV dword ptr [EBP + 0xffffbee4],EAX
009c05c7 : LEA EAX,[EBP + 0xffffbeec]
009c05cd : LEA EDX,[EAX + 0x2]
009c05d0 : MOV CX,word ptr [EAX]
009c05d3 : ADD EAX,0x2
009c05d6 : TEST CX,CX
009c05d9 : JNZ 0x009c05d0
009c05db : SUB EAX,EDX
009c05dd : SAR EAX,0x1
009c05df : MOV ESI,EAX
009c05e1 : MOV EAX,dword ptr [EBX]
009c05e3 : MOV dword ptr [EBP + 0xffffbee8],ESI
009c05e9 : TEST EAX,EAX
009c05eb : JZ 0x009c08fd
009c05f1 : CMP EDI,0x3
009c05f4 : JZ 0x009c0891
009c05fa : CMP EDI,0x6
009c05fd : JZ 0x009c0891
009c0603 : CMP EDI,0x4
009c0606 : JZ 0x009c0891
009c060c : CMP EDI,0x18
009c060f : JZ 0x009c0891
009c0615 : CMP EDI,0x1
009c0618 : JZ 0x009c064c
009c061a : CMP EDI,0x2
009c061d : JZ 0x009c064c
009c061f : CMP EDI,0xc
009c0622 : JZ 0x009c064c
009c0624 : CMP EDI,0x1b
009c0627 : JZ 0x009c064c
009c0629 : PUSH EAX
009c062a : MOV EDX,0x2000
009c062f : PUSH 0xc911c8
009c0634 : SUB EDX,ESI
009c0636 : PUSH EDX
009c0637 : LEA EAX,[EBP + ESI*0x2 + 0xffffbeec]
009c063e : PUSH EAX
009c063f : CALL 0x006343c8
009c0644 : ADD ESP,0x10
009c0647 : JMP 0x009c091a
009c064c : MOV ECX,EAX
009c064e : MOV EAX,0xc22e4507
009c0653 : MUL ECX
009c0655 : MOV EDI,EDX
009c0657 : MOV EAX,0x91a2b3c5
009c065c : MUL ECX
009c065e : MOV EAX,EDX
009c0660 : SHR EAX,0xb
009c0663 : XOR EDX,EDX
009c0665 : MOV EBX,0x18
009c066a : DIV EBX
009c066c : MOV EAX,0x88888889
009c0671 : SHR EDI,0x10
009c0674 : MOV EBX,EDX
009c0676 : MUL ECX
009c0678 : MOV EAX,EDX
009c067a : XOR EDX,EDX
009c067c : SHR EAX,0x5
009c067f : MOV ECX,0x3c
009c0684 : DIV ECX
009c0686 : MOV dword ptr [EBP + 0xffffbee0],EDX
009c068c : XOR EDX,EDX
009c068e : MOV word ptr [EBP + 0xfffffeec],DX
009c0695 : TEST EDI,EDI
009c0697 : JLE 0x009c06f1
009c0699 : MOV EAX,[0x0172491c]
009c069e : PUSH EAX
009c069f : MOV ECX,0xc91174
009c06a4 : LEA ESI,[EBP + 0xffffbe8c]
009c06aa : CALL 0x0081cbe0
009c06af : MOV dword ptr [EBP + -0x4],0x0
009c06b6 : CMP dword ptr [EAX + 0x18],0x8
009c06ba : JC 0x009c06c1
009c06bc : MOV EAX,dword ptr [EAX + 0x4]
009c06bf : JMP 0x009c06c4
009c06c1 : ADD EAX,0x4
009c06c4 : PUSH EAX
009c06c5 : PUSH EDI
009c06c6 : PUSH 0xc91178
009c06cb : LEA EDX,[EBP + 0xfffffeec]
009c06d1 : CALL 0x0040e4a0
009c06d6 : ADD ESP,0xc
009c06d9 : MOV dword ptr [EBP + -0x4],0xffffffff
009c06e0 : LEA ECX,[EBP + 0xffffbe8c]
009c06e6 : CALL 0x00406560
009c06eb : MOV ESI,dword ptr [EBP + 0xffffbee8]
009c06f1 : TEST EBX,EBX
009c06f3 : JLE 0x009c076b
009c06f5 : LEA EAX,[EBP + 0xfffffeec]
009c06fb : LEA EDX,[EAX + 0x2]
009c06fe : MOV EDI,EDI
009c0700 : MOV CX,word ptr [EAX]
009c0703 : ADD EAX,0x2
009c0706 : TEST CX,CX
009c0709 : JNZ 0x009c0700
009c070b : MOV ECX,dword ptr [0x0172491c]
009c0711 : SUB EAX,EDX
009c0713 : SAR EAX,0x1
009c0715 : PUSH ECX
009c0716 : MOV ECX,0xc91184
009c071b : LEA ESI,[EBP + 0xffffbe54]
009c0721 : MOV EDI,EAX
009c0723 : CALL 0x0081cbe0
009c0728 : MOV dword ptr [EBP + -0x4],0x1
009c072f : CMP dword ptr [EAX + 0x18],0x8
009c0733 : JC 0x009c073a
009c0735 : MOV EAX,dword ptr [EAX + 0x4]
009c0738 : JMP 0x009c073d
009c073a : ADD EAX,0x4
009c073d : PUSH EAX
009c073e : PUSH EBX
009c073f : PUSH 0xc9118c
009c0744 : LEA EDX,[EBP + EDI*0x2 + 0xfffffeec]
009c074b : CALL 0x0040e4a0
009c0750 : ADD ESP,0xc
009c0753 : MOV dword ptr [EBP + -0x4],0xffffffff
009c075a : LEA ECX,[EBP + 0xffffbe54]
009c0760 : CALL 0x00406560
009c0765 : MOV ESI,dword ptr [EBP + 0xffffbee8]
009c076b : CMP dword ptr [EBP + 0xffffbee0],0x0
009c0772 : JLE 0x009c07f1
009c0774 : LEA EAX,[EBP + 0xfffffeec]
009c077a : LEA EDX,[EAX + 0x2]
009c077d : LEA ECX,[ECX]
009c0780 : MOV CX,word ptr [EAX]
009c0783 : ADD EAX,0x2
009c0786 : TEST CX,CX
009c0789 : JNZ 0x009c0780
009c078b : SUB EAX,EDX
009c078d : MOV EDX,dword ptr [0x0172491c]
009c0793 : SAR EAX,0x1
009c0795 : PUSH EDX
009c0796 : MOV ECX,0xc91198
009c079b : LEA ESI,[EBP + 0xffffbe70]
009c07a1 : MOV EDI,EAX
009c07a3 : CALL 0x0081cbe0
009c07a8 : MOV dword ptr [EBP + -0x4],0x2
009c07af : CMP dword ptr [EAX + 0x18],0x8
009c07b3 : JC 0x009c07ba
009c07b5 : MOV EAX,dword ptr [EAX + 0x4]
009c07b8 : JMP 0x009c07bd
009c07ba : ADD EAX,0x4
009c07bd : PUSH EAX
009c07be : MOV EAX,dword ptr [EBP + 0xffffbee0]
009c07c4 : PUSH EAX
009c07c5 : PUSH 0xc911a0
009c07ca : LEA EDX,[EBP + EDI*0x2 + 0xfffffeec]
009c07d1 : CALL 0x0040e4a0
009c07d6 : ADD ESP,0xc
009c07d9 : MOV dword ptr [EBP + -0x4],0xffffffff
009c07e0 : LEA ECX,[EBP + 0xffffbe70]
009c07e6 : CALL 0x00406560
009c07eb : MOV ESI,dword ptr [EBP + 0xffffbee8]
009c07f1 : CMP word ptr [EBP + 0xfffffeec],0x0
009c07f9 : JNZ 0x009c085c
009c07fb : MOV ECX,dword ptr [0x0172491c]
009c0801 : PUSH ECX
009c0802 : MOV ECX,0xc911ac
009c0807 : LEA ESI,[EBP + 0xffffbe38]
009c080d : CALL 0x0081cbe0
009c0812 : MOV dword ptr [EBP + -0x4],0x3
009c0819 : CMP dword ptr [EAX + 0x18],0x8
009c081d : JC 0x009c0824
009c081f : MOV EAX,dword ptr [EAX + 0x4]
009c0822 : JMP 0x009c0827
009c0824 : ADD EAX,0x4
009c0827 : MOV EDX,dword ptr [EBP + 0xffffbee4]
009c082d : PUSH EAX
009c082e : MOV EAX,dword ptr [EDX]
009c0830 : PUSH EAX
009c0831 : PUSH 0xc911b4
009c0836 : LEA EDX,[EBP + 0xfffffeec]
009c083c : CALL 0x0040e4a0
009c0841 : ADD ESP,0xc
009c0844 : MOV dword ptr [EBP + -0x4],0xffffffff
009c084b : LEA ECX,[EBP + 0xffffbe38]
009c0851 : CALL 0x00406560
009c0856 : MOV ESI,dword ptr [EBP + 0xffffbee8]
009c085c : LEA ECX,[EBP + 0xfffffeec]
009c0862 : PUSH ECX
009c0863 : MOV EDX,0x2000
009c0868 : PUSH 0xc911c0
009c086d : SUB EDX,ESI
009c086f : PUSH EDX
009c0870 : LEA EAX,[EBP + ESI*0x2 + 0xffffbeec]
009c0877 : PUSH EAX
009c0878 : CALL 0x006343c8
009c087d : MOV EDI,dword ptr [EBP + 0xffffbedc]
009c0883 : MOV EBX,dword ptr [EBP + 0xffffbee4]
009c0889 : ADD ESP,0x10
009c088c : JMP 0x009c091a
009c0891 : LEA ECX,[EBP + 0xffffbecc]
009c0897 : PUSH ECX
009c0898 : LEA EDX,[EBP + 0xffffbea8]
009c089e : PUSH EDX
009c089f : MOV dword ptr [EBP + 0xffffbecc],EAX
009c08a5 : MOV dword ptr [EBP + 0xffffbed0],0x0
009c08af : CALL 0x00634f6e
009c08b4 : MOV EAX,dword ptr [EBP + 0xffffbeac]
009c08ba : MOV ECX,dword ptr [EBP + 0xffffbeb0]
009c08c0 : MOV EDX,dword ptr [EBP + 0xffffbeb4]
009c08c6 : PUSH EAX
009c08c7 : MOV EAX,dword ptr [EBP + 0xffffbeb8]
009c08cd : PUSH ECX
009c08ce : MOV ECX,dword ptr [EBP + 0xffffbebc]
009c08d4 : PUSH EDX
009c08d5 : INC EAX
009c08d6 : PUSH EAX
009c08d7 : ADD ECX,0x76c
009c08dd : PUSH ECX
009c08de : MOV EDX,0x2000
009c08e3 : PUSH 0xc91154
009c08e8 : SUB EDX,ESI
009c08ea : PUSH EDX
009c08eb : LEA EAX,[EBP + ESI*0x2 + 0xffffbeec]
009c08f2 : PUSH EAX
009c08f3 : CALL 0x006343c8
009c08f8 : ADD ESP,0x28
009c08fb : JMP 0x009c091a
009c08fd : MOV ECX,0x2000
009c0902 : PUSH 0xc911d0
009c0907 : SUB ECX,ESI
009c0909 : PUSH ECX
009c090a : LEA EDX,[EBP + ESI*0x2 + 0xffffbeec]
009c0911 : PUSH EDX
009c0912 : CALL 0x006343c8
009c0917 : ADD ESP,0xc
009c091a : INC EDI
009c091b : ADD EBX,0x4
009c091e : CMP EDI,0x2d
009c0921 : MOV dword ptr [EBP + 0xffffbedc],EDI
009c0927 : MOV dword ptr [EBP + 0xffffbee4],EBX
009c092d : JL 0x009c05c7
009c0933 : LEA EAX,[EBP + 0xffffbeec]
009c0939 : LEA EDX,[EAX + 0x2]
009c093c : LEA ESP,[ESP]
009c0940 : MOV CX,word ptr [EAX]
009c0943 : ADD EAX,0x2
009c0946 : TEST CX,CX
009c0949 : JNZ 0x009c0940
009c094b : SUB EAX,EDX
009c094d : SAR EAX,0x1
009c094f : TEST EAX,EAX
009c0951 : JLE 0x009c095d
009c0953 : XOR ECX,ECX
009c0955 : MOV word ptr [EBP + EAX*0x2 + 0xffffbeea],CX
009c095d : MOV ECX,dword ptr [EBP + 0xffffbed8]
009c0963 : MOV EDX,dword ptr [ECX]
009c0965 : MOV EDX,dword ptr [EDX + 0x8]
009c0968 : LEA EAX,[EBP + 0xffffbeec]
009c096e : PUSH EAX
009c096f : CALL EDX
009c0971 : MOV ECX,dword ptr [EBP + -0xc]
009c0974 : MOV dword ptr FS:[0x0],ECX
009c097b : POP ECX
009c097c : POP EDI
009c097d : POP ESI
009c097e : POP EBX
009c097f : MOV ECX,dword ptr [EBP + -0x14]
009c0982 : XOR ECX,EBP
009c0984 : CALL 0x00633e6b
009c0989 : MOV ESP,EBP
009c098b : POP EBP
009c098c : RET 0x4

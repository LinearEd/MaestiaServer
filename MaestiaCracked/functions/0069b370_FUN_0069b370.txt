PROGRAM  : Maestia.exe
FUNCTION : FUN_0069b370
ENTRY    : 0069b370
BODY     : [[0069b370, 0069b61a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0069b370(int *param_1,int param_2,int param_3,int param_4)

{
  undefined4 uVar1;
  int *piVar2;
  int iVar3;
  bool bVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  int local_c;
  int local_8;
  int local_4;
  
  uVar1 = *(undefined4 *)(param_3 * 0xcc + 200 + param_2);
  iVar6 = *(int *)(param_3 * 0xcc + 0xcc + param_2);
  if ((*(byte *)(param_1 + 4) & 8) != 0) {
    return;
  }
  iVar5 = FUN_00685ea0(*param_1,uVar1);
  uVar10 = iVar5 + iVar6;
  iVar6 = FUN_00685ea0(param_1[1],uVar1);
  if (param_3 == 0) {
    if (*(char *)(param_4 + 0x78) == '\0') {
LAB_0069b4f5:
      param_1[4] = param_1[4] | 8;
      param_1[2] = uVar10;
      param_1[3] = iVar6;
      return;
    }
    if (*(char *)(param_4 + 0x7a) == '\0') goto LAB_0069b3f1;
LAB_0069b510:
    bVar4 = true;
  }
  else {
    if (param_3 == 1) {
      if (*(char *)(param_4 + 0x79) == '\0') goto LAB_0069b4f5;
      if (*(char *)(param_4 + 0x7b) != '\0') goto LAB_0069b510;
    }
LAB_0069b3f1:
    bVar4 = false;
  }
  param_1[3] = iVar6;
  local_c = 0;
  local_8 = 0;
  local_4 = 0;
  if (param_3 == 1) {
    FUN_0069acc0(*param_1,&local_c);
  }
  if (local_c == 1) {
    local_4 = local_8 - iVar6;
LAB_0069b58e:
    param_1[2] = local_4;
  }
  else {
    if (local_c == 2) goto LAB_0069b58e;
    if (local_c == 3) {
      param_1[3] = local_8 - local_4;
      goto LAB_0069b58e;
    }
    piVar2 = (int *)param_1[5];
    iVar5 = iVar6 >> 1;
    if (piVar2 != (int *)0x0) {
      if ((*(byte *)(piVar2 + 4) & 8) == 0) {
        FUN_0069b370(piVar2,param_2,param_3,param_4);
      }
      iVar8 = piVar2[3];
      iVar3 = piVar2[2];
      iVar7 = FUN_00685ea0(((param_1[1] >> 1) + *param_1) - ((piVar2[1] >> 1) + *piVar2),uVar1);
      uVar10 = iVar7 + (((iVar8 >> 1) + iVar3) - iVar5);
    }
    param_1[2] = uVar10;
    param_1[3] = iVar6;
    uVar11 = uVar10;
    if (*(char *)(param_4 + 0x7c) != '\0') {
      if (iVar6 < 0x41) {
        if (iVar6 < 0x20) {
          if (iVar6 < 1) {
            uVar11 = uVar10 + 0x20 & 0xffffffc0;
          }
          else {
            uVar11 = iVar6 + 0x20 + uVar10 & 0xffffffc0;
            uVar9 = uVar10 + 0x20 & 0xffffffc0;
            iVar8 = uVar9 - uVar10;
            iVar5 = (uVar11 - iVar6) - uVar10;
            if (iVar8 < 0) {
              iVar8 = -iVar8;
            }
            if (iVar5 < 0) {
              iVar5 = -iVar5;
            }
            if (iVar8 <= iVar5) {
              uVar11 = uVar9;
            }
          }
        }
        else {
          iVar6 = 0x40;
          uVar11 = iVar5 + uVar10 & 0xffffffc0;
        }
      }
      else {
        iVar6 = FUN_0069b2d0(0);
      }
    }
    iVar5 = FUN_0069b340();
    param_1[2] = iVar5 + uVar11;
    param_1[3] = iVar6;
  }
  if (bVar4) {
    if (param_1[3] < 0x40) {
      uVar10 = 0x40;
    }
    else {
      uVar10 = param_1[3] + 0x20U & 0xffffffc0;
    }
    if (local_c == 1) {
      param_1[2] = local_8 - uVar10;
    }
    else if (local_c != 2) {
      if (local_c != 3) {
        iVar6 = (int)uVar10 >> 1;
        param_1[3] = uVar10;
        if ((uVar10 & 0x40) != 0) {
          param_1[4] = param_1[4] | 8;
          param_1[2] = ((iVar6 + param_1[2] & 0xffffffc0U) + 0x20) - iVar6;
          param_1[3] = uVar10;
          return;
        }
        param_1[4] = param_1[4] | 8;
        param_1[2] = (iVar6 + 0x20 + param_1[2] & 0xffffffc0U) - iVar6;
        param_1[3] = uVar10;
        return;
      }
      goto LAB_0069b60f;
    }
    param_1[3] = uVar10;
  }
LAB_0069b60f:
  param_1[4] = param_1[4] | 8;
  return;
}



============================================================
DISASSEMBLY
============================================================
0069b370 : SUB ESP,0x18
0069b373 : MOV ECX,dword ptr [ESP + 0x20]
0069b377 : PUSH EBX
0069b378 : PUSH ESI
0069b379 : MOV ESI,dword ptr [ESP + 0x2c]
0069b37d : MOV EAX,ESI
0069b37f : IMUL EAX,EAX,0xcc
0069b385 : MOV EBX,dword ptr [EAX + ECX*0x1 + 0xc8]
0069b38c : MOV EDX,dword ptr [EAX + ECX*0x1 + 0xcc]
0069b393 : LEA EAX,[EAX + ECX*0x1 + 0x4]
0069b397 : PUSH EDI
0069b398 : MOV EDI,dword ptr [ESP + 0x28]
0069b39c : TEST byte ptr [EDI + 0x10],0x8
0069b3a0 : MOV dword ptr [ESP + 0x14],EAX
0069b3a4 : MOV dword ptr [ESP + 0x10],EBX
0069b3a8 : MOV dword ptr [ESP + 0xc],EDX
0069b3ac : JNZ 0x0069b614
0069b3b2 : MOV EAX,dword ptr [EDI]
0069b3b4 : PUSH EBP
0069b3b5 : PUSH EBX
0069b3b6 : PUSH EAX
0069b3b7 : CALL 0x00685ea0
0069b3bc : MOV ECX,dword ptr [EDI + 0x4]
0069b3bf : MOV EBP,EAX
0069b3c1 : ADD EBP,dword ptr [ESP + 0x18]
0069b3c5 : PUSH EBX
0069b3c6 : PUSH ECX
0069b3c7 : CALL 0x00685ea0
0069b3cc : XOR EDX,EDX
0069b3ce : ADD ESP,0x10
0069b3d1 : MOV EBX,EAX
0069b3d3 : CMP ESI,EDX
0069b3d5 : JNZ 0x0069b4e3
0069b3db : MOV EAX,dword ptr [ESP + 0x38]
0069b3df : CMP byte ptr [EAX + 0x78],DL
0069b3e2 : JZ 0x0069b4f5
0069b3e8 : CMP byte ptr [EAX + 0x7a],DL
0069b3eb : JNZ 0x0069b510
0069b3f1 : MOV dword ptr [ESP + 0x2c],EDX
0069b3f5 : XOR ECX,ECX
0069b3f7 : MOV dword ptr [EDI + 0xc],EBX
0069b3fa : MOV dword ptr [ESP + 0x1c],EDX
0069b3fe : MOV dword ptr [ESP + 0x20],ECX
0069b402 : MOV dword ptr [ESP + 0x24],EDX
0069b406 : CMP ESI,0x1
0069b409 : JNZ 0x0069b432
0069b40b : MOV ECX,dword ptr [EDI]
0069b40d : MOV EAX,dword ptr [EDI + 0x4]
0069b410 : MOV ESI,dword ptr [ESP + 0x30]
0069b414 : LEA EDX,[ESP + 0x1c]
0069b418 : PUSH EDX
0069b419 : PUSH ECX
0069b41a : ADD EAX,ECX
0069b41c : ADD ESI,0x19c
0069b422 : CALL 0x0069acc0
0069b427 : MOV EDX,dword ptr [ESP + 0x2c]
0069b42b : MOV ECX,dword ptr [ESP + 0x28]
0069b42f : ADD ESP,0x8
0069b432 : MOV EAX,dword ptr [ESP + 0x1c]
0069b436 : SUB EAX,0x1
0069b439 : JZ 0x0069b58a
0069b43f : SUB EAX,0x1
0069b442 : JZ 0x0069b58e
0069b448 : SUB EAX,0x1
0069b44b : JZ 0x0069b581
0069b451 : MOV ESI,dword ptr [EDI + 0x14]
0069b454 : MOV dword ptr [ESP + 0x10],ESI
0069b458 : TEST ESI,ESI
0069b45a : JZ 0x0069b4ae
0069b45c : TEST byte ptr [ESI + 0x10],0x8
0069b460 : JNZ 0x0069b47a
0069b462 : MOV EAX,dword ptr [ESP + 0x38]
0069b466 : MOV ECX,dword ptr [ESP + 0x34]
0069b46a : MOV EDX,dword ptr [ESP + 0x30]
0069b46e : PUSH EAX
0069b46f : PUSH ECX
0069b470 : PUSH EDX
0069b471 : PUSH ESI
0069b472 : CALL 0x0069b370
0069b477 : ADD ESP,0x10
0069b47a : MOV ECX,dword ptr [ESI + 0x4]
0069b47d : MOV EAX,dword ptr [ESP + 0x10]
0069b481 : MOV EDX,dword ptr [ESP + 0x14]
0069b485 : SAR ECX,0x1
0069b487 : ADD ECX,dword ptr [ESI]
0069b489 : MOV ESI,dword ptr [ESI + 0xc]
0069b48c : SAR ESI,0x1
0069b48e : ADD ESI,dword ptr [EAX + 0x8]
0069b491 : MOV EAX,dword ptr [EDI + 0x4]
0069b494 : SAR EAX,0x1
0069b496 : ADD EAX,dword ptr [EDI]
0069b498 : PUSH EDX
0069b499 : SUB EAX,ECX
0069b49b : PUSH EAX
0069b49c : CALL 0x00685ea0
0069b4a1 : MOV EBP,EAX
0069b4a3 : MOV EAX,EBX
0069b4a5 : SAR EAX,0x1
0069b4a7 : SUB ESI,EAX
0069b4a9 : ADD ESP,0x8
0069b4ac : ADD EBP,ESI
0069b4ae : MOV ECX,dword ptr [ESP + 0x38]
0069b4b2 : MOV dword ptr [EDI + 0x8],EBP
0069b4b5 : MOV dword ptr [EDI + 0xc],EBX
0069b4b8 : CMP byte ptr [ECX + 0x7c],0x0
0069b4bc : JZ 0x0069b56a
0069b4c2 : CMP EBX,0x40
0069b4c5 : JG 0x0069b558
0069b4cb : CMP EBX,0x20
0069b4ce : JL 0x0069b51d
0069b4d0 : SAR EBX,0x1
0069b4d2 : ADD EBX,EBP
0069b4d4 : AND EBX,0xffffffc0
0069b4d7 : MOV EBP,EBX
0069b4d9 : MOV EBX,0x40
0069b4de : JMP 0x0069b56a
0069b4e3 : CMP ESI,0x1
0069b4e6 : JNZ 0x0069b3f1
0069b4ec : MOV EAX,dword ptr [ESP + 0x38]
0069b4f0 : CMP byte ptr [EAX + 0x79],DL
0069b4f3 : JNZ 0x0069b507
0069b4f5 : OR dword ptr [EDI + 0x10],0x8
0069b4f9 : MOV dword ptr [EDI + 0x8],EBP
0069b4fc : POP EBP
0069b4fd : MOV dword ptr [EDI + 0xc],EBX
0069b500 : POP EDI
0069b501 : POP ESI
0069b502 : POP EBX
0069b503 : ADD ESP,0x18
0069b506 : RET
0069b507 : CMP byte ptr [EAX + 0x7b],DL
0069b50a : JZ 0x0069b3f1
0069b510 : MOV dword ptr [ESP + 0x2c],0x1
0069b518 : JMP 0x0069b3f5
0069b51d : TEST EBX,EBX
0069b51f : JLE 0x0069b550
0069b521 : LEA ESI,[EBX + EBP*0x1 + 0x20]
0069b525 : LEA EDX,[EBP + 0x20]
0069b528 : AND ESI,0xffffffc0
0069b52b : AND EDX,0xffffffc0
0069b52e : MOV EAX,ESI
0069b530 : MOV ECX,EDX
0069b532 : SUB EAX,EBX
0069b534 : SUB ECX,EBP
0069b536 : SUB EAX,EBP
0069b538 : TEST ECX,ECX
0069b53a : JGE 0x0069b53e
0069b53c : NEG ECX
0069b53e : TEST EAX,EAX
0069b540 : JGE 0x0069b544
0069b542 : NEG EAX
0069b544 : CMP ECX,EAX
0069b546 : JG 0x0069b54c
0069b548 : MOV EBP,EDX
0069b54a : JMP 0x0069b56a
0069b54c : MOV EBP,ESI
0069b54e : JMP 0x0069b56a
0069b550 : ADD EBP,0x20
0069b553 : AND EBP,0xffffffc0
0069b556 : JMP 0x0069b56a
0069b558 : MOV ECX,dword ptr [ESP + 0x18]
0069b55c : PUSH 0x0
0069b55e : MOV EAX,EBX
0069b560 : CALL 0x0069b2d0
0069b565 : ADD ESP,0x4
0069b568 : MOV EBX,EAX
0069b56a : MOV EAX,EBX
0069b56c : MOV EDX,EBP
0069b56e : CALL 0x0069b340
0069b573 : MOV ECX,dword ptr [ESP + 0x20]
0069b577 : ADD EAX,EBP
0069b579 : MOV dword ptr [EDI + 0x8],EAX
0069b57c : MOV dword ptr [EDI + 0xc],EBX
0069b57f : JMP 0x0069b591
0069b581 : MOV EAX,ECX
0069b583 : SUB EAX,EDX
0069b585 : MOV dword ptr [EDI + 0xc],EAX
0069b588 : JMP 0x0069b58e
0069b58a : MOV EDX,ECX
0069b58c : SUB EDX,EBX
0069b58e : MOV dword ptr [EDI + 0x8],EDX
0069b591 : CMP dword ptr [ESP + 0x2c],0x0
0069b596 : JZ 0x0069b60f
0069b598 : MOV EDX,dword ptr [EDI + 0xc]
0069b59b : CMP EDX,0x40
0069b59e : MOV ESI,dword ptr [EDI + 0x8]
0069b5a1 : JGE 0x0069b5aa
0069b5a3 : MOV EDX,0x40
0069b5a8 : JMP 0x0069b5b0
0069b5aa : ADD EDX,0x20
0069b5ad : AND EDX,0xffffffc0
0069b5b0 : MOV EAX,dword ptr [ESP + 0x1c]
0069b5b4 : SUB EAX,0x1
0069b5b7 : JZ 0x0069b607
0069b5b9 : SUB EAX,0x1
0069b5bc : JZ 0x0069b60c
0069b5be : SUB EAX,0x1
0069b5c1 : JZ 0x0069b60f
0069b5c3 : MOV ECX,EDX
0069b5c5 : SAR ECX,0x1
0069b5c7 : MOV dword ptr [EDI + 0xc],EDX
0069b5ca : TEST DL,0x40
0069b5cd : JZ 0x0069b5ec
0069b5cf : LEA EAX,[ECX + ESI*0x1]
0069b5d2 : AND EAX,0xffffffc0
0069b5d5 : ADD EAX,0x20
0069b5d8 : SUB EAX,ECX
0069b5da : OR dword ptr [EDI + 0x10],0x8
0069b5de : POP EBP
0069b5df : MOV dword ptr [EDI + 0x8],EAX
0069b5e2 : MOV dword ptr [EDI + 0xc],EDX
0069b5e5 : POP EDI
0069b5e6 : POP ESI
0069b5e7 : POP EBX
0069b5e8 : ADD ESP,0x18
0069b5eb : RET
0069b5ec : LEA EAX,[ECX + ESI*0x1 + 0x20]
0069b5f0 : AND EAX,0xffffffc0
0069b5f3 : SUB EAX,ECX
0069b5f5 : OR dword ptr [EDI + 0x10],0x8
0069b5f9 : POP EBP
0069b5fa : MOV dword ptr [EDI + 0x8],EAX
0069b5fd : MOV dword ptr [EDI + 0xc],EDX
0069b600 : POP EDI
0069b601 : POP ESI
0069b602 : POP EBX
0069b603 : ADD ESP,0x18
0069b606 : RET
0069b607 : SUB ECX,EDX
0069b609 : MOV dword ptr [EDI + 0x8],ECX
0069b60c : MOV dword ptr [EDI + 0xc],EDX
0069b60f : OR dword ptr [EDI + 0x10],0x8
0069b613 : POP EBP
0069b614 : POP EDI
0069b615 : POP ESI
0069b616 : POP EBX
0069b617 : ADD ESP,0x18
0069b61a : RET

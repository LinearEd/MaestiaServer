PROGRAM  : Maestia.exe
FUNCTION : FUN_006bfd20
ENTRY    : 006bfd20
BODY     : [[006bfd20, 006bfe19] [006bfe20, 006bff4b] [006bff50, 006c00ec] [006c00f0, 006c01ad]]

============================================================
DECOMPILED C CODE
============================================================

undefined4
FUN_006bfd20(int *param_1,uint param_2,uint param_3,int param_4,int param_5,uint *param_6,
            uint *param_7,int param_8,uint *param_9,uint *param_10)

{
  uint uVar1;
  undefined4 uVar2;
  uint *puVar3;
  int *piVar4;
  uint uVar5;
  int iVar6;
  uint uVar7;
  uint uVar8;
  int iVar9;
  int iVar10;
  uint uVar11;
  undefined4 *puVar12;
  int iVar13;
  byte bVar14;
  uint uVar15;
  int iVar16;
  int iVar17;
  int iVar18;
  uint uVar19;
  uint uVar20;
  uint local_f8;
  uint local_f4;
  uint *local_f0;
  uint local_ec;
  uint *local_e4;
  uint local_dc;
  uint local_d8;
  int local_d4;
  undefined4 local_d0;
  uint local_bc [32];
  uint local_3c [15];
  
  uVar19 = 0;
  local_bc[0] = 0;
  local_bc[1] = 0;
  local_bc[2] = 0;
  local_bc[3] = 0;
  local_bc[4] = 0;
  local_bc[5] = 0;
  local_bc[6] = 0;
  local_bc[7] = 0;
  local_bc[8] = 0;
  local_bc[9] = 0;
  local_bc[10] = 0;
  local_bc[0xb] = 0;
  local_bc[0xc] = 0;
  local_bc[0xd] = 0;
  local_bc[0xe] = 0;
  local_bc[0xf] = 0;
  uVar20 = 0;
  piVar4 = param_1;
  uVar15 = param_2;
  do {
    local_bc[*piVar4] = local_bc[*piVar4] + 1;
    piVar4 = piVar4 + 1;
    uVar15 = uVar15 - 1;
  } while (uVar15 != 0);
  if (local_bc[0] == param_2) {
    *param_6 = 0;
    *param_7 = 0;
  }
  else {
    local_f4 = 1;
    do {
      if (local_bc[local_f4] != 0) break;
      local_f4 = local_f4 + 1;
    } while (local_f4 < 0x10);
    local_f8 = *param_7;
    if (*param_7 < local_f4) {
      local_f8 = local_f4;
    }
    uVar15 = 0xf;
    do {
      if (local_bc[uVar15] != 0) break;
      uVar15 = uVar15 - 1;
    } while (uVar15 != 0);
    if (uVar15 < local_f8) {
      local_f8 = uVar15;
    }
    *param_7 = local_f8;
    iVar17 = 1 << ((byte)local_f4 & 0x1f);
    for (uVar8 = local_f4; uVar8 < uVar15; uVar8 = uVar8 + 1) {
      if ((int)(iVar17 - local_bc[uVar8]) < 0) {
        return 0xfffffffd;
      }
      iVar17 = (iVar17 - local_bc[uVar8]) * 2;
    }
    iVar17 = iVar17 - local_bc[uVar15];
    if (iVar17 < 0) {
      return 0xfffffffd;
    }
    local_bc[uVar15] = local_bc[uVar15] + iVar17;
    iVar9 = 0;
    iVar16 = uVar15 - 1;
    local_bc[0x11] = 0;
    if (iVar16 != 0) {
      iVar10 = 0;
      do {
        iVar9 = iVar9 + *(int *)((int)local_bc + iVar10 + 4);
        iVar16 = iVar16 + -1;
        *(int *)((int)local_bc + iVar10 + 0x48) = iVar9;
        iVar10 = iVar10 + 4;
      } while (iVar16 != 0);
    }
    uVar8 = 0;
    do {
      iVar9 = *param_1;
      param_1 = param_1 + 1;
      if (iVar9 != 0) {
        uVar7 = local_bc[iVar9 + 0x10];
        param_10[uVar7] = uVar8;
        local_bc[iVar9 + 0x10] = uVar7 + 1;
      }
      uVar8 = uVar8 + 1;
    } while (uVar8 < param_2);
    uVar8 = local_bc[uVar15 + 0x10];
    iVar16 = -1;
    iVar9 = -local_f8;
    local_dc = 0;
    local_bc[0x10] = 0;
    local_e4 = param_10;
    local_3c[0] = 0;
    local_ec = 0;
    local_d8 = 0;
    if ((int)local_f4 <= (int)uVar15) {
      local_d4 = local_f4 - 1;
      local_f0 = local_bc + local_f4;
      do {
        uVar7 = *local_f0;
        uVar2 = local_d0;
        while (local_d0 = uVar2, uVar7 != 0) {
          local_d0._2_2_ = (undefined2)((uint)uVar2 >> 0x10);
          uVar1 = uVar7 - 1;
          iVar10 = iVar9 + local_f8;
          if (iVar10 < (int)local_f4) {
            iVar13 = iVar9 - local_f8;
            iVar18 = iVar16;
            do {
              iVar13 = iVar13 + local_f8;
              iVar9 = iVar9 + local_f8;
              iVar10 = iVar10 + local_f8;
              iVar16 = iVar18 + 1;
              uVar19 = uVar15 - iVar9;
              if (local_f8 < uVar15 - iVar9) {
                uVar19 = local_f8;
              }
              uVar11 = local_f4 - iVar9;
              uVar5 = 1 << ((byte)uVar11 & 0x1f);
              if ((uVar7 < uVar5) &&
                 (iVar6 = uVar5 + (-1 - uVar1), puVar3 = local_f0, uVar11 < uVar19)) {
                while (uVar11 = uVar11 + 1, uVar11 < uVar19) {
                  if ((uint)(iVar6 * 2) <= puVar3[1]) break;
                  iVar6 = iVar6 * 2 - puVar3[1];
                  puVar3 = puVar3 + 1;
                }
              }
              local_d8 = 1 << ((byte)uVar11 & 0x1f);
              uVar19 = local_d8 + *param_9;
              if (0x5a0 < uVar19) {
                return 0xfffffffd;
              }
              local_ec = param_8 + *param_9 * 8;
              *param_9 = uVar19;
              local_bc[iVar18 + 0x21] = local_ec;
              if (iVar16 == 0) {
                *param_6 = local_ec;
              }
              else {
                uVar5 = local_dc >> ((byte)iVar13 & 0x1f);
                uVar19 = local_bc[iVar18 + 0x20];
                local_d0._0_2_ = CONCAT11((undefined1)local_f8,(byte)uVar11);
                uVar20 = ((int)(local_ec - uVar19) >> 3) - uVar5;
                *(undefined4 *)(uVar19 + uVar5 * 8) = local_d0;
                local_bc[iVar18 + 0x11] = local_dc;
                *(uint *)(uVar19 + 4 + uVar5 * 8) = uVar20;
              }
              iVar18 = iVar16;
              uVar19 = local_dc;
            } while (iVar10 < (int)local_f4);
          }
          bVar14 = (byte)iVar9;
          if (local_e4 < param_10 + uVar8) {
            uVar20 = *local_e4;
            if (uVar20 < param_3) {
              local_d0._0_1_ = (-(uVar20 < 0x100) & 0xa0U) + 0x60;
            }
            else {
              iVar10 = (uVar20 - param_3) * 4;
              local_d0._0_1_ = *(char *)(iVar10 + param_5) + 'P';
              uVar20 = *(uint *)(iVar10 + param_4);
            }
            local_e4 = local_e4 + 1;
          }
          else {
            local_d0._0_1_ = -0x40;
          }
          local_d0 = CONCAT31(CONCAT21(local_d0._2_2_,(char)local_f4 - bVar14),(char)local_d0);
          iVar10 = 1 << ((char)local_f4 - bVar14 & 0x1f);
          uVar7 = uVar19 >> (bVar14 & 0x1f);
          if (uVar7 < local_d8) {
            puVar12 = (undefined4 *)(local_ec + uVar7 * 8);
            do {
              *puVar12 = local_d0;
              puVar12[1] = uVar20;
              uVar7 = uVar7 + iVar10;
              puVar12 = puVar12 + iVar10 * 2;
              uVar19 = local_dc;
            } while (uVar7 < local_d8);
          }
          uVar11 = 1 << ((byte)local_d4 & 0x1f);
          uVar7 = uVar19 & uVar11;
          while (uVar7 != 0) {
            uVar19 = uVar19 ^ uVar11;
            uVar11 = uVar11 >> 1;
            uVar7 = uVar19 & uVar11;
          }
          uVar19 = uVar19 ^ uVar11;
          iVar10 = iVar16;
          uVar7 = uVar1;
          local_dc = uVar19;
          uVar2 = local_d0;
          if (((1 << (bVar14 & 0x1f)) - 1U & uVar19) != local_bc[iVar16 + 0x10]) {
            do {
              iVar9 = iVar9 - local_f8;
              iVar16 = iVar10 + -1;
              iVar18 = iVar10 + 0xf;
              iVar10 = iVar16;
            } while (((1 << ((byte)iVar9 & 0x1f)) - 1U & uVar19) != local_bc[iVar18]);
          }
        }
        local_f0 = local_f0 + 1;
        local_d4 = local_d4 + 1;
        local_f4 = local_f4 + 1;
      } while ((int)local_f4 <= (int)uVar15);
    }
    if ((iVar17 != 0) && (uVar15 != 1)) {
      return 0xfffffffb;
    }
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
006bfd20 : SUB ESP,0xf8
006bfd26 : MOV EDX,dword ptr [ESP + 0x100]
006bfd2d : MOV EAX,dword ptr [ESP + 0xfc]
006bfd34 : PUSH EBX
006bfd35 : PUSH EBP
006bfd36 : MOV EBP,dword ptr [ESP + 0x11c]
006bfd3d : PUSH ESI
006bfd3e : XOR ESI,ESI
006bfd40 : PUSH EDI
006bfd41 : XOR EDI,EDI
006bfd43 : MOV dword ptr [ESP + 0x4c],ESI
006bfd47 : MOV dword ptr [ESP + 0x50],ESI
006bfd4b : MOV dword ptr [ESP + 0x54],ESI
006bfd4f : MOV dword ptr [ESP + 0x58],ESI
006bfd53 : MOV dword ptr [ESP + 0x5c],ESI
006bfd57 : MOV dword ptr [ESP + 0x60],ESI
006bfd5b : MOV dword ptr [ESP + 0x64],ESI
006bfd5f : MOV dword ptr [ESP + 0x68],ESI
006bfd63 : MOV dword ptr [ESP + 0x6c],ESI
006bfd67 : MOV dword ptr [ESP + 0x70],ESI
006bfd6b : MOV dword ptr [ESP + 0x74],ESI
006bfd6f : MOV dword ptr [ESP + 0x78],ESI
006bfd73 : MOV dword ptr [ESP + 0x7c],ESI
006bfd77 : MOV dword ptr [ESP + 0x80],ESI
006bfd7e : MOV dword ptr [ESP + 0x84],ESI
006bfd85 : MOV dword ptr [ESP + 0x88],ESI
006bfd8c : MOV EBX,EDX
006bfd8e : MOV EDI,EDI
006bfd90 : MOV ECX,dword ptr [EAX]
006bfd92 : INC dword ptr [ESP + ECX*0x4 + 0x4c]
006bfd96 : LEA ECX,[ESP + ECX*0x4 + 0x4c]
006bfd9a : ADD EAX,0x4
006bfd9d : SUB EBX,0x1
006bfda0 : JNZ 0x006bfd90
006bfda2 : CMP dword ptr [ESP + 0x4c],EDX
006bfda6 : JNZ 0x006bfdc1
006bfda8 : MOV EAX,dword ptr [ESP + 0x120]
006bfdaf : MOV dword ptr [EAX],ESI
006bfdb1 : MOV dword ptr [EBP],ESI
006bfdb4 : POP EDI
006bfdb5 : POP ESI
006bfdb6 : POP EBP
006bfdb7 : XOR EAX,EAX
006bfdb9 : POP EBX
006bfdba : ADD ESP,0xf8
006bfdc0 : RET
006bfdc1 : MOV EAX,dword ptr [EBP]
006bfdc4 : MOV dword ptr [ESP + 0x10],EAX
006bfdc8 : MOV ECX,0x1
006bfdcd : LEA ECX,[ECX]
006bfdd0 : CMP dword ptr [ESP + ECX*0x4 + 0x4c],ESI
006bfdd4 : JNZ 0x006bfddc
006bfdd6 : INC ECX
006bfdd7 : CMP ECX,0xf
006bfdda : JBE 0x006bfdd0
006bfddc : MOV EDX,ECX
006bfdde : MOV dword ptr [ESP + 0x14],EDX
006bfde2 : CMP EAX,ECX
006bfde4 : JNC 0x006bfdec
006bfde6 : MOV dword ptr [ESP + 0x10],ECX
006bfdea : MOV EAX,ECX
006bfdec : MOV EBX,0xf
006bfdf1 : CMP dword ptr [ESP + EBX*0x4 + 0x4c],ESI
006bfdf5 : JNZ 0x006bfdfc
006bfdf7 : SUB EBX,0x1
006bfdfa : JNZ 0x006bfdf1
006bfdfc : MOV dword ptr [ESP + 0x28],EBX
006bfe00 : CMP EAX,EBX
006bfe02 : JBE 0x006bfe0a
006bfe04 : MOV dword ptr [ESP + 0x10],EBX
006bfe08 : MOV EAX,EBX
006bfe0a : MOV dword ptr [EBP],EAX
006bfe0d : MOV EBP,0x1
006bfe12 : SHL EBP,CL
006bfe14 : CMP ECX,EBX
006bfe16 : JNC 0x006bfe31
006bfe18 : JMP 0x006bfe20
006bfe20 : SUB EBP,dword ptr [ESP + ECX*0x4 + 0x4c]
006bfe24 : JS 0x006bff3c
006bfe2a : INC ECX
006bfe2b : ADD EBP,EBP
006bfe2d : CMP ECX,EBX
006bfe2f : JC 0x006bfe20
006bfe31 : LEA ECX,[EBX*0x4 + 0x0]
006bfe38 : MOV dword ptr [ESP + 0x18],ECX
006bfe3c : MOV ECX,dword ptr [ESP + ECX*0x1 + 0x4c]
006bfe40 : SUB EBP,ECX
006bfe42 : MOV dword ptr [ESP + 0x44],EBP
006bfe46 : JS 0x006bff3c
006bfe4c : ADD ECX,EBP
006bfe4e : MOV EBP,dword ptr [ESP + 0x18]
006bfe52 : MOV dword ptr [ESP + EBP*0x1 + 0x4c],ECX
006bfe56 : XOR ECX,ECX
006bfe58 : SUB EBX,0x1
006bfe5b : MOV dword ptr [ESP + 0x90],ESI
006bfe62 : JZ 0x006bfe79
006bfe64 : XOR EBP,EBP
006bfe66 : ADD ECX,dword ptr [ESP + EBP*0x1 + 0x50]
006bfe6a : ADD EBP,0x4
006bfe6d : SUB EBX,0x1
006bfe70 : MOV dword ptr [ESP + EBP*0x1 + 0x90],ECX
006bfe77 : JNZ 0x006bfe66
006bfe79 : MOV EBP,dword ptr [ESP + 0x10c]
006bfe80 : XOR EBX,EBX
006bfe82 : MOV ECX,dword ptr [EBP]
006bfe85 : ADD EBP,0x4
006bfe88 : MOV dword ptr [ESP + 0x24],EBP
006bfe8c : CMP ECX,ESI
006bfe8e : JZ 0x006bfeb4
006bfe90 : MOV EDX,dword ptr [ESP + ECX*0x4 + 0x8c]
006bfe97 : MOV EBP,dword ptr [ESP + 0x130]
006bfe9e : LEA ECX,[ESP + ECX*0x4 + 0x8c]
006bfea5 : MOV dword ptr [EBP + EDX*0x4],EBX
006bfea9 : MOV EBP,dword ptr [ESP + 0x24]
006bfead : INC EDX
006bfeae : MOV dword ptr [ECX],EDX
006bfeb0 : MOV EDX,dword ptr [ESP + 0x14]
006bfeb4 : INC EBX
006bfeb5 : CMP EBX,dword ptr [ESP + 0x110]
006bfebc : JC 0x006bfe82
006bfebe : MOV ECX,dword ptr [ESP + 0x18]
006bfec2 : MOV ECX,dword ptr [ESP + ECX*0x1 + 0x8c]
006bfec9 : MOV EBX,EAX
006bfecb : MOV dword ptr [ESP + 0x110],ECX
006bfed2 : MOV ECX,dword ptr [ESP + 0x130]
006bfed9 : OR EBP,0xffffffff
006bfedc : NEG EBX
006bfede : CMP EDX,dword ptr [ESP + 0x28]
006bfee2 : MOV dword ptr [ESP + 0x2c],ESI
006bfee6 : MOV dword ptr [ESP + 0x8c],ESI
006bfeed : MOV dword ptr [ESP + 0x24],ECX
006bfef1 : MOV dword ptr [ESP + 0xcc],ESI
006bfef8 : MOV dword ptr [ESP + 0x1c],ESI
006bfefc : MOV dword ptr [ESP + 0x30],ESI
006bff00 : JG 0x006c0188
006bff06 : LEA ECX,[EDX + -0x1]
006bff09 : MOV dword ptr [ESP + 0x34],ECX
006bff0d : LEA ECX,[ESP + EDX*0x4 + 0x4c]
006bff11 : MOV dword ptr [ESP + 0x18],ECX
006bff15 : MOV ECX,dword ptr [ESP + 0x18]
006bff19 : MOV ECX,dword ptr [ECX]
006bff1b : MOV dword ptr [ESP + 0x20],ECX
006bff1f : TEST ECX,ECX
006bff21 : JZ 0x006c0170
006bff27 : DEC dword ptr [ESP + 0x20]
006bff2b : LEA ECX,[EBX + EAX*0x1]
006bff2e : CMP EDX,ECX
006bff30 : JLE 0x006c0057
006bff36 : MOV EDX,EBX
006bff38 : SUB EDX,EAX
006bff3a : JMP 0x006bff58
006bff3c : POP EDI
006bff3d : POP ESI
006bff3e : POP EBP
006bff3f : MOV EAX,0xfffffffd
006bff44 : POP EBX
006bff45 : ADD ESP,0xf8
006bff4b : RET
006bff50 : MOV EAX,dword ptr [ESP + 0x10]
006bff54 : MOV EDX,dword ptr [ESP + 0x40]
006bff58 : ADD EDX,EAX
006bff5a : ADD EBX,EAX
006bff5c : MOV dword ptr [ESP + 0x40],EDX
006bff60 : MOV EDX,dword ptr [ESP + 0x28]
006bff64 : ADD ECX,EAX
006bff66 : MOV EAX,dword ptr [ESP + 0x10]
006bff6a : INC EBP
006bff6b : SUB EDX,EBX
006bff6d : MOV dword ptr [ESP + 0x1c],EBP
006bff71 : MOV dword ptr [ESP + 0x48],ECX
006bff75 : CMP EDX,EAX
006bff77 : JBE 0x006bff7b
006bff79 : MOV EDX,EAX
006bff7b : MOV ECX,dword ptr [ESP + 0x14]
006bff7f : MOV ESI,dword ptr [ESP + 0x20]
006bff83 : SUB ECX,EBX
006bff85 : MOV EAX,0x1
006bff8a : SHL EAX,CL
006bff8c : INC ESI
006bff8d : CMP EAX,ESI
006bff8f : JBE 0x006bffbe
006bff91 : MOV EBP,dword ptr [ESP + 0x18]
006bff95 : OR ESI,0xffffffff
006bff98 : SUB ESI,dword ptr [ESP + 0x20]
006bff9c : ADD EAX,ESI
006bff9e : CMP ECX,EDX
006bffa0 : JNC 0x006bffba
006bffa2 : INC ECX
006bffa3 : CMP ECX,EDX
006bffa5 : JNC 0x006bffba
006bffa7 : MOV ESI,dword ptr [EBP + 0x4]
006bffaa : ADD EBP,0x4
006bffad : ADD EAX,EAX
006bffaf : CMP EAX,ESI
006bffb1 : JBE 0x006bffba
006bffb3 : INC ECX
006bffb4 : SUB EAX,ESI
006bffb6 : CMP ECX,EDX
006bffb8 : JC 0x006bffa7
006bffba : MOV EBP,dword ptr [ESP + 0x1c]
006bffbe : MOV EAX,dword ptr [ESP + 0x12c]
006bffc5 : MOV EAX,dword ptr [EAX]
006bffc7 : MOV EDX,0x1
006bffcc : SHL EDX,CL
006bffce : MOV dword ptr [ESP + 0x30],EDX
006bffd2 : ADD EDX,EAX
006bffd4 : CMP EDX,0x5a0
006bffda : JA 0x006bff3c
006bffe0 : MOV ESI,dword ptr [ESP + 0x128]
006bffe7 : LEA EAX,[ESI + EAX*0x8]
006bffea : MOV ESI,dword ptr [ESP + 0x12c]
006bfff1 : MOV dword ptr [ESI],EDX
006bfff3 : MOV ESI,dword ptr [ESP + 0x2c]
006bfff7 : MOV dword ptr [ESP + 0x1c],EAX
006bfffb : MOV dword ptr [ESP + EBP*0x4 + 0xcc],EAX
006c0002 : TEST EBP,EBP
006c0004 : JZ 0x006c0040
006c0006 : MOV EDI,dword ptr [ESP + 0x1c]
006c000a : MOV DL,byte ptr [ESP + 0x10]
006c000e : MOV byte ptr [ESP + 0x38],CL
006c0012 : MOV ECX,dword ptr [ESP + 0x40]
006c0016 : MOV EAX,ESI
006c0018 : SHR EAX,CL
006c001a : MOV ECX,dword ptr [ESP + EBP*0x4 + 0xc8]
006c0021 : SUB EDI,ECX
006c0023 : MOV byte ptr [ESP + 0x39],DL
006c0027 : MOV EDX,dword ptr [ESP + 0x38]
006c002b : SAR EDI,0x3
006c002e : SUB EDI,EAX
006c0030 : MOV dword ptr [ECX + EAX*0x8],EDX
006c0033 : MOV dword ptr [ESP + EBP*0x4 + 0x8c],ESI
006c003a : MOV dword ptr [ECX + EAX*0x8 + 0x4],EDI
006c003e : JMP 0x006c0049
006c0040 : MOV ECX,dword ptr [ESP + 0x120]
006c0047 : MOV dword ptr [ECX],EAX
006c0049 : MOV ECX,dword ptr [ESP + 0x48]
006c004d : CMP dword ptr [ESP + 0x14],ECX
006c0051 : JG 0x006bff50
006c0057 : MOV DL,byte ptr [ESP + 0x14]
006c005b : MOV ECX,dword ptr [ESP + 0x110]
006c0062 : MOV EAX,dword ptr [ESP + 0x130]
006c0069 : SUB DL,BL
006c006b : MOV byte ptr [ESP + 0x39],DL
006c006f : LEA EDX,[EAX + ECX*0x4]
006c0072 : MOV ECX,dword ptr [ESP + 0x24]
006c0076 : CMP ECX,EDX
006c0078 : JC 0x006c0081
006c007a : MOV byte ptr [ESP + 0x38],0xc0
006c007f : JMP 0x006c00cb
006c0081 : MOV EAX,dword ptr [ECX]
006c0083 : MOV EDX,dword ptr [ESP + 0x114]
006c008a : CMP EAX,EDX
006c008c : JNC 0x006c00a3
006c008e : CMP EAX,0x100
006c0093 : SBB DL,DL
006c0095 : AND DL,0xa0
006c0098 : ADD DL,0x60
006c009b : MOV byte ptr [ESP + 0x38],DL
006c009f : MOV EDI,EAX
006c00a1 : JMP 0x006c00c4
006c00a3 : SUB EAX,EDX
006c00a5 : MOV EDX,dword ptr [ESP + 0x11c]
006c00ac : ADD EAX,EAX
006c00ae : ADD EAX,EAX
006c00b0 : MOV DL,byte ptr [EAX + EDX*0x1]
006c00b3 : ADD DL,0x50
006c00b6 : MOV byte ptr [ESP + 0x38],DL
006c00ba : MOV EDX,dword ptr [ESP + 0x118]
006c00c1 : MOV EDI,dword ptr [EAX + EDX*0x1]
006c00c4 : ADD ECX,0x4
006c00c7 : MOV dword ptr [ESP + 0x24],ECX
006c00cb : MOV ECX,dword ptr [ESP + 0x14]
006c00cf : SUB ECX,EBX
006c00d1 : MOV EDX,0x1
006c00d6 : SHL EDX,CL
006c00d8 : MOV EAX,ESI
006c00da : MOV ECX,EBX
006c00dc : SHR EAX,CL
006c00de : CMP EAX,dword ptr [ESP + 0x30]
006c00e2 : JNC 0x006c010e
006c00e4 : MOV ECX,dword ptr [ESP + 0x1c]
006c00e8 : LEA ECX,[ECX + EAX*0x8]
006c00eb : JMP 0x006c00f0
006c00f0 : MOV ESI,dword ptr [ESP + 0x38]
006c00f4 : MOV dword ptr [ECX],ESI
006c00f6 : LEA ESI,[EDX*0x8 + 0x0]
006c00fd : MOV dword ptr [ECX + 0x4],EDI
006c0100 : ADD EAX,EDX
006c0102 : ADD ECX,ESI
006c0104 : CMP EAX,dword ptr [ESP + 0x30]
006c0108 : JC 0x006c00f0
006c010a : MOV ESI,dword ptr [ESP + 0x2c]
006c010e : MOV ECX,dword ptr [ESP + 0x34]
006c0112 : MOV EAX,0x1
006c0117 : SHL EAX,CL
006c0119 : TEST ESI,EAX
006c011b : JZ 0x006c0128
006c011d : LEA ECX,[ECX]
006c0120 : XOR ESI,EAX
006c0122 : SHR EAX,0x1
006c0124 : TEST ESI,EAX
006c0126 : JNZ 0x006c0120
006c0128 : MOV EDX,0x1
006c012d : MOV ECX,EBX
006c012f : SHL EDX,CL
006c0131 : XOR ESI,EAX
006c0133 : MOV dword ptr [ESP + 0x2c],ESI
006c0137 : DEC EDX
006c0138 : AND EDX,ESI
006c013a : CMP EDX,dword ptr [ESP + EBP*0x4 + 0x8c]
006c0141 : JZ 0x006c015d
006c0143 : SUB EBX,dword ptr [ESP + 0x10]
006c0147 : MOV EAX,0x1
006c014c : MOV ECX,EBX
006c014e : SHL EAX,CL
006c0150 : DEC EBP
006c0151 : DEC EAX
006c0152 : AND EAX,ESI
006c0154 : CMP EAX,dword ptr [ESP + EBP*0x4 + 0x8c]
006c015b : JNZ 0x006c0143
006c015d : CMP dword ptr [ESP + 0x20],0x0
006c0162 : MOV EAX,dword ptr [ESP + 0x10]
006c0166 : MOV EDX,dword ptr [ESP + 0x14]
006c016a : JNZ 0x006bff27
006c0170 : ADD dword ptr [ESP + 0x18],0x4
006c0175 : INC dword ptr [ESP + 0x34]
006c0179 : INC EDX
006c017a : CMP EDX,dword ptr [ESP + 0x28]
006c017e : MOV dword ptr [ESP + 0x14],EDX
006c0182 : JLE 0x006bff15
006c0188 : CMP dword ptr [ESP + 0x44],0x0
006c018d : JZ 0x006bfdb4
006c0193 : CMP dword ptr [ESP + 0x28],0x1
006c0198 : JZ 0x006bfdb4
006c019e : POP EDI
006c019f : POP ESI
006c01a0 : POP EBP
006c01a1 : MOV EAX,0xfffffffb
006c01a6 : POP EBX
006c01a7 : ADD ESP,0xf8
006c01ad : RET

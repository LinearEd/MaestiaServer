PROGRAM  : Maestia.exe
FUNCTION : FUN_00433070
ENTRY    : 00433070
BODY     : [[00433070, 00433231]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00433070(int param_1,int param_2,code *param_3,int *param_4,int param_5,undefined4 param_6,
                 undefined4 param_7)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  void **ppvVar3;
  char cVar4;
  uint uVar5;
  int iVar6;
  uint uVar7;
  int iVar8;
  undefined4 in_stack_0000003c;
  undefined1 in_stack_00000040;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_00b78e5a;
  uVar5 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_8 = 0;
  ppvVar3 = &local_10;
  local_10 = ExceptionList;
  while (ExceptionList = ppvVar3, param_2 < param_1) {
    iVar8 = (param_1 + -1) / 2;
    uVar7 = param_5 + iVar8;
    if (param_4 == (int *)0x0) {
      iVar6 = 0;
    }
    else {
      iVar6 = *param_4;
    }
    if (*(uint *)(iVar6 + 0x14) <= uVar7) {
      if (param_4 == (int *)0x0) {
        iVar6 = 0;
      }
      else {
        iVar6 = *param_4;
      }
      uVar7 = uVar7 - *(int *)(iVar6 + 0x14);
    }
    if (param_4 == (int *)0x0) {
      iVar6 = 0;
    }
    else {
      iVar6 = *param_4;
    }
    cVar4 = (*param_3)(*(undefined4 *)(*(int *)(iVar6 + 0x10) + uVar7 * 4),&param_6,uVar5);
    if (cVar4 == '\0') break;
    uVar7 = param_5 + iVar8;
    if (param_4 == (int *)0x0) {
      iVar6 = 0;
    }
    else {
      iVar6 = *param_4;
    }
    if (*(uint *)(iVar6 + 0x14) <= uVar7) {
      if (param_4 == (int *)0x0) {
        iVar6 = 0;
      }
      else {
        iVar6 = *param_4;
      }
      uVar7 = uVar7 - *(int *)(iVar6 + 0x14);
    }
    if (param_4 == (int *)0x0) {
      iVar6 = 0;
    }
    else {
      iVar6 = *param_4;
    }
    puVar1 = *(undefined4 **)(*(int *)(iVar6 + 0x10) + uVar7 * 4);
    uVar7 = param_5 + param_1;
    if (param_4 == (int *)0x0) {
      iVar6 = 0;
    }
    else {
      iVar6 = *param_4;
    }
    if (*(uint *)(iVar6 + 0x14) <= uVar7) {
      if (param_4 == (int *)0x0) {
        iVar6 = 0;
      }
      else {
        iVar6 = *param_4;
      }
      uVar7 = uVar7 - *(int *)(iVar6 + 0x14);
    }
    if (param_4 == (int *)0x0) {
      iVar6 = 0;
    }
    else {
      iVar6 = *param_4;
    }
    puVar2 = *(undefined4 **)(*(int *)(iVar6 + 0x10) + uVar7 * 4);
    *puVar2 = *puVar1;
    puVar2[1] = puVar1[1];
    FUN_00405eb0(puVar1 + 2,0,0xffffffff);
    puVar2[9] = puVar1[9];
    *(undefined1 *)(puVar2 + 10) = *(undefined1 *)(puVar1 + 10);
    ppvVar3 = ExceptionList;
    param_1 = iVar8;
  }
  uVar5 = param_5 + param_1;
  if (param_4 == (int *)0x0) {
    iVar8 = 0;
  }
  else {
    iVar8 = *param_4;
  }
  if (*(uint *)(iVar8 + 0x14) <= uVar5) {
    if (param_4 == (int *)0x0) {
      iVar8 = 0;
    }
    else {
      iVar8 = *param_4;
    }
    uVar5 = uVar5 - *(int *)(iVar8 + 0x14);
  }
  if (param_4 == (int *)0x0) {
    iVar8 = 0;
  }
  else {
    iVar8 = *param_4;
  }
  puVar1 = *(undefined4 **)(*(int *)(iVar8 + 0x10) + uVar5 * 4);
  *puVar1 = param_6;
  puVar1[1] = param_7;
  FUN_00405eb0(&stack0x00000020,0,0xffffffff);
  puVar1[9] = in_stack_0000003c;
  *(undefined1 *)(puVar1 + 10) = in_stack_00000040;
  local_8 = 0xffffffff;
  FUN_00401300(&param_6);
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00433070 : PUSH EBP
00433071 : MOV EBP,ESP
00433073 : PUSH -0x1
00433075 : PUSH 0xb78e5a
0043307a : MOV EAX,FS:[0x0]
00433080 : PUSH EAX
00433081 : SUB ESP,0x10
00433084 : PUSH EBX
00433085 : PUSH ESI
00433086 : PUSH EDI
00433087 : MOV EAX,[0x00d66fa0]
0043308c : XOR EAX,EBP
0043308e : PUSH EAX
0043308f : LEA EAX,[EBP + -0xc]
00433092 : MOV FS:[0x0],EAX
00433098 : MOV EAX,dword ptr [EBP + 0x10]
0043309b : MOV dword ptr [EBP + -0x10],EAX
0043309e : MOV dword ptr [EBP + -0x4],0x0
004330a5 : MOV ECX,dword ptr [EBP + 0x8]
004330a8 : LEA EAX,[ECX + -0x1]
004330ab : CDQ
004330ac : SUB EAX,EDX
004330ae : MOV EBX,EAX
004330b0 : SAR EBX,0x1
004330b2 : CMP dword ptr [EBP + 0xc],ECX
004330b5 : JGE 0x004331af
004330bb : MOV ECX,dword ptr [EBP + 0x18]
004330be : MOV EAX,dword ptr [EBP + 0x14]
004330c1 : MOV dword ptr [EBP + -0x14],ECX
004330c4 : ADD ECX,EBX
004330c6 : TEST EAX,EAX
004330c8 : JZ 0x004330ce
004330ca : MOV EDX,dword ptr [EAX]
004330cc : JMP 0x004330d0
004330ce : XOR EDX,EDX
004330d0 : CMP dword ptr [EDX + 0x14],ECX
004330d3 : JA 0x004330e2
004330d5 : TEST EAX,EAX
004330d7 : JZ 0x004330dd
004330d9 : MOV EDX,dword ptr [EAX]
004330db : JMP 0x004330df
004330dd : XOR EDX,EDX
004330df : SUB ECX,dword ptr [EDX + 0x14]
004330e2 : TEST EAX,EAX
004330e4 : JZ 0x004330ea
004330e6 : MOV EAX,dword ptr [EAX]
004330e8 : JMP 0x004330ec
004330ea : XOR EAX,EAX
004330ec : MOV EDX,dword ptr [EAX + 0x10]
004330ef : MOV EAX,dword ptr [EDX + ECX*0x4]
004330f2 : LEA ECX,[EBP + 0x1c]
004330f5 : PUSH ECX
004330f6 : PUSH EAX
004330f7 : CALL dword ptr [EBP + -0x10]
004330fa : ADD ESP,0x8
004330fd : TEST AL,AL
004330ff : JZ 0x004331af
00433105 : MOV EAX,dword ptr [EBP + 0x14]
00433108 : MOV ECX,dword ptr [EBP + 0x18]
0043310b : MOV dword ptr [EBP + -0x14],ECX
0043310e : LEA ESI,[ECX + EBX*0x1]
00433111 : TEST EAX,EAX
00433113 : JZ 0x00433119
00433115 : MOV EDX,dword ptr [EAX]
00433117 : JMP 0x0043311b
00433119 : XOR EDX,EDX
0043311b : CMP dword ptr [EDX + 0x14],ESI
0043311e : JA 0x0043312d
00433120 : TEST EAX,EAX
00433122 : JZ 0x00433128
00433124 : MOV EDX,dword ptr [EAX]
00433126 : JMP 0x0043312a
00433128 : XOR EDX,EDX
0043312a : SUB ESI,dword ptr [EDX + 0x14]
0043312d : TEST EAX,EAX
0043312f : JZ 0x00433135
00433131 : MOV EDX,dword ptr [EAX]
00433133 : JMP 0x00433137
00433135 : XOR EDX,EDX
00433137 : MOV EDX,dword ptr [EDX + 0x10]
0043313a : MOV EDI,dword ptr [EDX + ESI*0x4]
0043313d : MOV EDX,dword ptr [EBP + 0x8]
00433140 : MOV dword ptr [EBP + -0x14],ECX
00433143 : ADD ECX,EDX
00433145 : TEST EAX,EAX
00433147 : JZ 0x0043314d
00433149 : MOV EDX,dword ptr [EAX]
0043314b : JMP 0x0043314f
0043314d : XOR EDX,EDX
0043314f : CMP dword ptr [EDX + 0x14],ECX
00433152 : JA 0x00433161
00433154 : TEST EAX,EAX
00433156 : JZ 0x0043315c
00433158 : MOV EDX,dword ptr [EAX]
0043315a : JMP 0x0043315e
0043315c : XOR EDX,EDX
0043315e : SUB ECX,dword ptr [EDX + 0x14]
00433161 : TEST EAX,EAX
00433163 : JZ 0x00433169
00433165 : MOV EAX,dword ptr [EAX]
00433167 : JMP 0x0043316b
00433169 : XOR EAX,EAX
0043316b : MOV EAX,dword ptr [EAX + 0x10]
0043316e : MOV ESI,dword ptr [EAX + ECX*0x4]
00433171 : MOV ECX,dword ptr [EDI]
00433173 : PUSH -0x1
00433175 : MOV dword ptr [ESI],ECX
00433177 : MOV EDX,dword ptr [EDI + 0x4]
0043317a : PUSH 0x0
0043317c : LEA EAX,[EDI + 0x8]
0043317f : PUSH EAX
00433180 : LEA ECX,[ESI + 0x8]
00433183 : MOV dword ptr [ESI + 0x4],EDX
00433186 : CALL 0x00405eb0
0043318b : MOV ECX,dword ptr [EDI + 0x24]
0043318e : MOV dword ptr [ESI + 0x24],ECX
00433191 : MOV DL,byte ptr [EDI + 0x28]
00433194 : LEA EAX,[EBX + -0x1]
00433197 : MOV byte ptr [ESI + 0x28],DL
0043319a : CDQ
0043319b : MOV ECX,EBX
0043319d : SUB EAX,EDX
0043319f : SAR EAX,0x1
004331a1 : CMP dword ptr [EBP + 0xc],ECX
004331a4 : MOV dword ptr [EBP + 0x8],ECX
004331a7 : MOV EBX,EAX
004331a9 : JL 0x004330bb
004331af : MOV ECX,dword ptr [EBP + 0x18]
004331b2 : MOV EDX,dword ptr [EBP + 0x8]
004331b5 : MOV EAX,dword ptr [EBP + 0x14]
004331b8 : MOV dword ptr [EBP + -0x14],ECX
004331bb : ADD ECX,EDX
004331bd : TEST EAX,EAX
004331bf : JZ 0x004331c5
004331c1 : MOV EDX,dword ptr [EAX]
004331c3 : JMP 0x004331c7
004331c5 : XOR EDX,EDX
004331c7 : CMP dword ptr [EDX + 0x14],ECX
004331ca : JA 0x004331d9
004331cc : TEST EAX,EAX
004331ce : JZ 0x004331d4
004331d0 : MOV EDX,dword ptr [EAX]
004331d2 : JMP 0x004331d6
004331d4 : XOR EDX,EDX
004331d6 : SUB ECX,dword ptr [EDX + 0x14]
004331d9 : TEST EAX,EAX
004331db : JZ 0x004331e1
004331dd : MOV EAX,dword ptr [EAX]
004331df : JMP 0x004331e3
004331e1 : XOR EAX,EAX
004331e3 : MOV EAX,dword ptr [EAX + 0x10]
004331e6 : MOV ESI,dword ptr [EAX + ECX*0x4]
004331e9 : MOV ECX,dword ptr [EBP + 0x1c]
004331ec : PUSH -0x1
004331ee : MOV dword ptr [ESI],ECX
004331f0 : MOV EDX,dword ptr [EBP + 0x20]
004331f3 : PUSH 0x0
004331f5 : LEA EAX,[EBP + 0x24]
004331f8 : PUSH EAX
004331f9 : LEA ECX,[ESI + 0x8]
004331fc : MOV dword ptr [ESI + 0x4],EDX
004331ff : CALL 0x00405eb0
00433204 : MOV ECX,dword ptr [EBP + 0x40]
00433207 : MOV dword ptr [ESI + 0x24],ECX
0043320a : MOV DL,byte ptr [EBP + 0x44]
0043320d : MOV byte ptr [ESI + 0x28],DL
00433210 : MOV dword ptr [EBP + -0x4],0xffffffff
00433217 : LEA EAX,[EBP + 0x1c]
0043321a : PUSH EAX
0043321b : CALL 0x00401300
00433220 : MOV ECX,dword ptr [EBP + -0xc]
00433223 : MOV dword ptr FS:[0x0],ECX
0043322a : POP ECX
0043322b : POP EDI
0043322c : POP ESI
0043322d : POP EBX
0043322e : MOV ESP,EBP
00433230 : POP EBP
00433231 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_007fbbd0
ENTRY    : 007fbbd0
BODY     : [[007fbbd0, 007fbd93]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007fbbd0(int param_1)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  int unaff_EDI;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1a4ae;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if ((*(int *)(unaff_EDI + 0x180) != param_1) || (*(char *)(param_1 + 0x40) != '\0')) {
    *(int *)(unaff_EDI + 0x180) = param_1;
    iVar3 = *(int *)(param_1 + 4);
    *(int *)(unaff_EDI + 0x184) = iVar3;
    if ((*(int *)(iVar3 + 0x80) != 0) && (iVar1 = *(int *)(iVar3 + 0x84), iVar1 != 0)) {
      iVar3 = (**(code **)(**(int **)(unaff_EDI + 0x18) + 0x94))
                        (*(int **)(unaff_EDI + 0x18),0,*(int *)(iVar3 + 0x80),uVar2);
      if (iVar3 < 0) {
        uVar4 = FUN_00404750(L"SetRenderTarget Failed (%d)",iVar3);
        local_8 = 0;
        if ((int *)*DAT_00da98e8 != (int *)0x0) {
          (**(code **)(*(int *)*DAT_00da98e8 + 0x14))(L"AvaLib::AvaRender::SetViewport",0x4de,uVar4)
          ;
        }
        local_8 = 0xffffffff;
        FUN_00406560();
      }
      iVar3 = (**(code **)(**(int **)(unaff_EDI + 0x18) + 0x9c))(*(int **)(unaff_EDI + 0x18),iVar1);
      if (iVar3 < 0) {
        uVar4 = FUN_00404750(L"SetDepthStencilSurface Failed (%d)",iVar3);
        local_8 = 1;
        if ((int *)*DAT_00da98e8 != (int *)0x0) {
          (**(code **)(*(int *)*DAT_00da98e8 + 0x14))(L"AvaLib::AvaRender::SetViewport",0x4e3,uVar4)
          ;
        }
        local_8 = 0xffffffff;
        FUN_00406560();
      }
      iVar3 = *(int *)(unaff_EDI + 0x180);
      local_2c = *(undefined4 *)(iVar3 + 0x34);
      local_28 = *(undefined4 *)(iVar3 + 0x30);
      local_24 = *(undefined4 *)(iVar3 + 0x38);
      local_20 = *(undefined4 *)(iVar3 + 0x3c);
      local_1c = 0;
      local_18 = 0x3f800000;
      iVar3 = (**(code **)(**(int **)(unaff_EDI + 0x18) + 0xbc))
                        (*(int **)(unaff_EDI + 0x18),&local_2c);
      if (iVar3 < 0) {
        uVar4 = FUN_00404750(L"SetViewport Failed (%d)",iVar3);
        local_8 = 2;
        if ((int *)*DAT_00da98e8 != (int *)0x0) {
          (**(code **)(*(int *)*DAT_00da98e8 + 0x14))(L"AvaLib::AvaRender::SetViewport",0x4ef,uVar4)
          ;
        }
        local_8 = 0xffffffff;
        FUN_00406560();
      }
      *(undefined1 *)(*(int *)(unaff_EDI + 0x180) + 0x40) = 0;
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
007fbbd0 : PUSH EBP
007fbbd1 : MOV EBP,ESP
007fbbd3 : PUSH -0x1
007fbbd5 : PUSH 0xb1a4ae
007fbbda : MOV EAX,FS:[0x0]
007fbbe0 : PUSH EAX
007fbbe1 : SUB ESP,0x3c
007fbbe4 : PUSH EBX
007fbbe5 : PUSH ESI
007fbbe6 : MOV EAX,[0x00d66fa0]
007fbbeb : XOR EAX,EBP
007fbbed : PUSH EAX
007fbbee : LEA EAX,[EBP + -0xc]
007fbbf1 : MOV FS:[0x0],EAX
007fbbf7 : MOV EAX,dword ptr [EBP + 0x8]
007fbbfa : CMP dword ptr [EDI + 0x180],EAX
007fbc00 : JNZ 0x007fbc0c
007fbc02 : CMP byte ptr [EAX + 0x40],0x0
007fbc06 : JZ 0x007fbd81
007fbc0c : MOV dword ptr [EDI + 0x180],EAX
007fbc12 : MOV EAX,dword ptr [EAX + 0x4]
007fbc15 : MOV dword ptr [EDI + 0x184],EAX
007fbc1b : MOV ECX,dword ptr [EAX + 0x80]
007fbc21 : TEST ECX,ECX
007fbc23 : JZ 0x007fbd81
007fbc29 : MOV EBX,dword ptr [EAX + 0x84]
007fbc2f : TEST EBX,EBX
007fbc31 : JZ 0x007fbd81
007fbc37 : MOV EAX,dword ptr [EDI + 0x18]
007fbc3a : MOV EDX,dword ptr [EAX]
007fbc3c : PUSH ECX
007fbc3d : PUSH 0x0
007fbc3f : PUSH EAX
007fbc40 : MOV EAX,dword ptr [EDX + 0x94]
007fbc46 : CALL EAX
007fbc48 : TEST EAX,EAX
007fbc4a : JGE 0x007fbc91
007fbc4c : PUSH EAX
007fbc4d : PUSH 0xc27808
007fbc52 : LEA ESI,[EBP + -0x44]
007fbc55 : CALL 0x00404750
007fbc5a : ADD ESP,0x8
007fbc5d : MOV dword ptr [EBP + -0x4],0x0
007fbc64 : MOV ECX,dword ptr [0x00da98e8]
007fbc6a : MOV ECX,dword ptr [ECX]
007fbc6c : TEST ECX,ECX
007fbc6e : JZ 0x007fbc82
007fbc70 : MOV EDX,dword ptr [ECX]
007fbc72 : PUSH EAX
007fbc73 : MOV EAX,dword ptr [EDX + 0x14]
007fbc76 : PUSH 0x4de
007fbc7b : PUSH 0xc27840
007fbc80 : CALL EAX
007fbc82 : MOV dword ptr [EBP + -0x4],0xffffffff
007fbc89 : LEA ECX,[EBP + -0x44]
007fbc8c : CALL 0x00406560
007fbc91 : MOV EAX,dword ptr [EDI + 0x18]
007fbc94 : MOV ECX,dword ptr [EAX]
007fbc96 : MOV EDX,dword ptr [ECX + 0x9c]
007fbc9c : PUSH EBX
007fbc9d : PUSH EAX
007fbc9e : CALL EDX
007fbca0 : TEST EAX,EAX
007fbca2 : JGE 0x007fbce9
007fbca4 : PUSH EAX
007fbca5 : PUSH 0xc27880
007fbcaa : LEA ESI,[EBP + -0x44]
007fbcad : CALL 0x00404750
007fbcb2 : ADD ESP,0x8
007fbcb5 : MOV dword ptr [EBP + -0x4],0x1
007fbcbc : MOV ECX,dword ptr [0x00da98e8]
007fbcc2 : MOV ECX,dword ptr [ECX]
007fbcc4 : TEST ECX,ECX
007fbcc6 : JZ 0x007fbcda
007fbcc8 : MOV EDX,dword ptr [ECX]
007fbcca : PUSH EAX
007fbccb : MOV EAX,dword ptr [EDX + 0x14]
007fbcce : PUSH 0x4e3
007fbcd3 : PUSH 0xc278c8
007fbcd8 : CALL EAX
007fbcda : MOV dword ptr [EBP + -0x4],0xffffffff
007fbce1 : LEA ECX,[EBP + -0x44]
007fbce4 : CALL 0x00406560
007fbce9 : MOV EAX,dword ptr [EDI + 0x180]
007fbcef : MOV ECX,dword ptr [EAX + 0x34]
007fbcf2 : XORPS XMM0,XMM0
007fbcf5 : MOV dword ptr [EBP + -0x28],ECX
007fbcf8 : MOV EDX,dword ptr [EAX + 0x30]
007fbcfb : MOV dword ptr [EBP + -0x24],EDX
007fbcfe : MOV ECX,dword ptr [EAX + 0x38]
007fbd01 : MOV dword ptr [EBP + -0x20],ECX
007fbd04 : MOV EDX,dword ptr [EAX + 0x3c]
007fbd07 : MOV EAX,dword ptr [EDI + 0x18]
007fbd0a : MOV dword ptr [EBP + -0x1c],EDX
007fbd0d : MOVSS dword ptr [EBP + -0x18],XMM0
007fbd12 : MOVSS XMM0,dword ptr [0x00c10fc4]
007fbd1a : LEA EDX,[EBP + -0x28]
007fbd1d : MOVSS dword ptr [EBP + -0x14],XMM0
007fbd22 : MOV ECX,dword ptr [EAX]
007fbd24 : PUSH EDX
007fbd25 : PUSH EAX
007fbd26 : MOV EAX,dword ptr [ECX + 0xbc]
007fbd2c : CALL EAX
007fbd2e : TEST EAX,EAX
007fbd30 : JGE 0x007fbd77
007fbd32 : PUSH EAX
007fbd33 : PUSH 0xc27908
007fbd38 : LEA ESI,[EBP + -0x44]
007fbd3b : CALL 0x00404750
007fbd40 : ADD ESP,0x8
007fbd43 : MOV dword ptr [EBP + -0x4],0x2
007fbd4a : MOV ECX,dword ptr [0x00da98e8]
007fbd50 : MOV ECX,dword ptr [ECX]
007fbd52 : TEST ECX,ECX
007fbd54 : JZ 0x007fbd68
007fbd56 : MOV EDX,dword ptr [ECX]
007fbd58 : PUSH EAX
007fbd59 : MOV EAX,dword ptr [EDX + 0x14]
007fbd5c : PUSH 0x4ef
007fbd61 : PUSH 0xc27938
007fbd66 : CALL EAX
007fbd68 : MOV dword ptr [EBP + -0x4],0xffffffff
007fbd6f : LEA ECX,[EBP + -0x44]
007fbd72 : CALL 0x00406560
007fbd77 : MOV ECX,dword ptr [EDI + 0x180]
007fbd7d : MOV byte ptr [ECX + 0x40],0x0
007fbd81 : MOV ECX,dword ptr [EBP + -0xc]
007fbd84 : MOV dword ptr FS:[0x0],ECX
007fbd8b : POP ECX
007fbd8c : POP ESI
007fbd8d : POP EBX
007fbd8e : MOV ESP,EBP
007fbd90 : POP EBP
007fbd91 : RET 0x4

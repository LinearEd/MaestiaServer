PROGRAM  : Maestia.exe
FUNCTION : FUN_007d71d0
ENTRY    : 007d71d0
BODY     : [[007d71d0, 007d72fe] [007d7300, 007d73af]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007d71d0(int param_1)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  int in_ECX;
  int *piVar7;
  uint uVar8;
  undefined **local_38;
  int *local_34;
  int *local_2c;
  int *local_28;
  int *local_24;
  int local_20;
  int *local_1c;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b28c76;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_20 = in_ECX;
  if (*(int *)(in_ECX + 8) != 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  local_8 = 0;
  local_2c = *(int **)(in_ECX + 0x264);
  piVar7 = (int *)*local_2c;
  local_1c = piVar7;
  if (piVar7 != local_2c) {
    do {
      local_1c = piVar7;
      FUN_00439f80(&local_38,piVar7 + 9);
      local_8._0_1_ = 1;
      local_24 = local_34 + 0x1f;
      local_28 = local_34 + 0x1e;
      uVar8 = local_34[0x1f] - local_34[0x1e] >> 2;
      if ((uVar8 != 0) && (local_18 = 0, uVar8 != 0)) {
        do {
          iVar5 = *local_28;
          if ((uint)(*local_24 - iVar5 >> 2) <= local_18) {
                    /* WARNING: Subroutine does not return */
            FUN_0045cd70();
          }
          iVar1 = local_18 * 4;
          if ((*(int *)(iVar1 + iVar5) != 0) && (*(char *)(*(int *)(iVar1 + iVar5) + 0x19) != '\0'))
          {
            iVar4 = *(int *)(param_1 + 4);
            if (iVar4 == 0) {
              uVar6 = 0;
            }
            else {
              uVar6 = *(int *)(param_1 + 0xc) - iVar4 >> 2;
            }
            puVar2 = *(undefined4 **)(param_1 + 8);
            if ((uint)((int)puVar2 - iVar4 >> 2) < uVar6) {
              *puVar2 = *(undefined4 *)(iVar1 + iVar5);
              *(undefined4 **)(param_1 + 8) = puVar2 + 1;
            }
            else {
              FUN_0042fe80(param_1,puVar2,(undefined4 *)(iVar1 + iVar5));
            }
          }
          local_18 = local_18 + 1;
          piVar7 = local_1c;
        } while (local_18 < uVar8);
      }
      local_8 = (uint)local_8._1_3_ << 8;
      local_38 = &PTR_FUN_00cd4964;
      if (local_34 != (int *)0x0) {
        (**(code **)(*local_34 + 0x30))();
        local_34 = (int *)0x0;
      }
      piVar7 = (int *)*piVar7;
      in_ECX = local_20;
      local_1c = piVar7;
    } while (piVar7 != local_2c);
  }
  local_8 = 0xffffffff;
  if (*(int *)(in_ECX + 8) != 0) {
    LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  if (*(int *)(in_ECX + 8) != 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  local_8 = 3;
  puVar2 = *(undefined4 **)(in_ECX + 0x38);
  for (puVar3 = (undefined4 *)*puVar2; puVar3 != puVar2; puVar3 = (undefined4 *)*puVar3) {
    iVar5 = (**(code **)(*(int *)puVar3[9] + 0x1c))();
    if (iVar5 - 2U < 8) {
      FUN_007d71d0(param_1);
    }
  }
  local_8 = 0xffffffff;
  if (*(int *)(local_20 + 8) != 0) {
    LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(local_20 + 8) + 4));
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
007d71d0 : PUSH EBP
007d71d1 : MOV EBP,ESP
007d71d3 : PUSH -0x1
007d71d5 : PUSH 0xb28c76
007d71da : MOV EAX,FS:[0x0]
007d71e0 : PUSH EAX
007d71e1 : SUB ESP,0x28
007d71e4 : PUSH EBX
007d71e5 : PUSH ESI
007d71e6 : PUSH EDI
007d71e7 : MOV EAX,[0x00d66fa0]
007d71ec : XOR EAX,EBP
007d71ee : PUSH EAX
007d71ef : LEA EAX,[EBP + -0xc]
007d71f2 : MOV FS:[0x0],EAX
007d71f8 : MOV EDI,ECX
007d71fa : MOV dword ptr [EBP + -0x1c],EDI
007d71fd : MOV EAX,dword ptr [EDI + 0x8]
007d7200 : MOV dword ptr [EBP + -0x2c],EDI
007d7203 : TEST EAX,EAX
007d7205 : JZ 0x007d7211
007d7207 : ADD EAX,0x4
007d720a : PUSH EAX
007d720b : CALL dword ptr [0x00b85118]
007d7211 : MOV dword ptr [EBP + -0x4],0x0
007d7218 : MOV EAX,dword ptr [EDI + 0x264]
007d721e : MOV ESI,dword ptr [EAX]
007d7220 : MOV EBX,dword ptr [EBP + 0x8]
007d7223 : MOV dword ptr [EBP + -0x28],EAX
007d7226 : MOV dword ptr [EBP + -0x18],ESI
007d7229 : CMP ESI,EAX
007d722b : JNZ 0x007d72c3
007d7231 : MOV dword ptr [EBP + -0x4],0xffffffff
007d7238 : MOV EAX,dword ptr [EDI + 0x8]
007d723b : TEST EAX,EAX
007d723d : JZ 0x007d7249
007d723f : ADD EAX,0x4
007d7242 : PUSH EAX
007d7243 : CALL dword ptr [0x00b8511c]
007d7249 : MOV EAX,dword ptr [EDI + 0x8]
007d724c : MOV dword ptr [EBP + 0x8],EDI
007d724f : TEST EAX,EAX
007d7251 : JZ 0x007d725d
007d7253 : ADD EAX,0x4
007d7256 : PUSH EAX
007d7257 : CALL dword ptr [0x00b85118]
007d725d : MOV dword ptr [EBP + -0x4],0x3
007d7264 : MOV EDI,dword ptr [EDI + 0x38]
007d7267 : MOV ESI,dword ptr [EDI]
007d7269 : CMP ESI,EDI
007d726b : JZ 0x007d7291
007d726d : LEA ECX,[ECX]
007d7270 : MOV ECX,dword ptr [ESI + 0x24]
007d7273 : MOV EDX,dword ptr [ECX]
007d7275 : MOV EAX,dword ptr [EDX + 0x1c]
007d7278 : CALL EAX
007d727a : ADD EAX,-0x2
007d727d : CMP EAX,0x7
007d7280 : JA 0x007d728b
007d7282 : MOV ECX,dword ptr [ESI + 0x24]
007d7285 : PUSH EBX
007d7286 : CALL 0x007d71d0
007d728b : MOV ESI,dword ptr [ESI]
007d728d : CMP ESI,EDI
007d728f : JNZ 0x007d7270
007d7291 : MOV dword ptr [EBP + -0x4],0xffffffff
007d7298 : MOV ECX,dword ptr [EBP + -0x1c]
007d729b : MOV EAX,dword ptr [ECX + 0x8]
007d729e : TEST EAX,EAX
007d72a0 : JZ 0x007d72ac
007d72a2 : ADD EAX,0x4
007d72a5 : PUSH EAX
007d72a6 : CALL dword ptr [0x00b8511c]
007d72ac : MOV ECX,dword ptr [EBP + -0xc]
007d72af : MOV dword ptr FS:[0x0],ECX
007d72b6 : POP ECX
007d72b7 : POP EDI
007d72b8 : POP ESI
007d72b9 : POP EBX
007d72ba : MOV ESP,EBP
007d72bc : POP EBP
007d72bd : RET 0x4
007d72c0 : MOV ESI,dword ptr [EBP + -0x18]
007d72c3 : LEA EAX,[ESI + 0x24]
007d72c6 : PUSH EAX
007d72c7 : LEA ECX,[EBP + -0x34]
007d72ca : PUSH ECX
007d72cb : CALL 0x00439f80
007d72d0 : MOV byte ptr [EBP + -0x4],0x1
007d72d4 : MOV EAX,dword ptr [EBP + -0x30]
007d72d7 : MOV EDI,dword ptr [EAX + 0x7c]
007d72da : SUB EDI,dword ptr [EAX + 0x78]
007d72dd : LEA EDX,[EAX + 0x7c]
007d72e0 : ADD EAX,0x78
007d72e3 : SAR EDI,0x2
007d72e6 : MOV dword ptr [EBP + -0x20],EDX
007d72e9 : MOV dword ptr [EBP + -0x24],EAX
007d72ec : TEST EDI,EDI
007d72ee : JZ 0x007d7375
007d72f4 : XOR ECX,ECX
007d72f6 : MOV dword ptr [EBP + -0x14],ECX
007d72f9 : TEST EDI,EDI
007d72fb : JBE 0x007d7375
007d72fd : JMP 0x007d7306
007d7300 : MOV EDX,dword ptr [EBP + -0x20]
007d7303 : MOV EAX,dword ptr [EBP + -0x24]
007d7306 : MOV EDX,dword ptr [EDX]
007d7308 : MOV EAX,dword ptr [EAX]
007d730a : SUB EDX,EAX
007d730c : SAR EDX,0x2
007d730f : CMP EDX,ECX
007d7311 : JBE 0x007d73ab
007d7317 : LEA ESI,[ECX*0x4 + 0x0]
007d731e : CMP dword ptr [ESI + EAX*0x1],0x0
007d7322 : JZ 0x007d736a
007d7324 : MOV EDX,dword ptr [ESI + EAX*0x1]
007d7327 : CMP byte ptr [EDX + 0x19],0x0
007d732b : JZ 0x007d736a
007d732d : MOV ECX,dword ptr [EBX + 0x4]
007d7330 : ADD ESI,EAX
007d7332 : TEST ECX,ECX
007d7334 : JNZ 0x007d733a
007d7336 : XOR EAX,EAX
007d7338 : JMP 0x007d7342
007d733a : MOV EAX,dword ptr [EBX + 0xc]
007d733d : SUB EAX,ECX
007d733f : SAR EAX,0x2
007d7342 : MOV EDX,dword ptr [EBX + 0x8]
007d7345 : MOV EBX,EDX
007d7347 : SUB EBX,ECX
007d7349 : SAR EBX,0x2
007d734c : CMP EBX,EAX
007d734e : MOV EBX,dword ptr [EBP + 0x8]
007d7351 : JNC 0x007d735f
007d7353 : MOV EAX,dword ptr [ESI]
007d7355 : MOV dword ptr [EDX],EAX
007d7357 : ADD EDX,0x4
007d735a : MOV dword ptr [EBX + 0x8],EDX
007d735d : JMP 0x007d7367
007d735f : PUSH ESI
007d7360 : PUSH EDX
007d7361 : PUSH EBX
007d7362 : CALL 0x0042fe80
007d7367 : MOV ECX,dword ptr [EBP + -0x14]
007d736a : INC ECX
007d736b : MOV dword ptr [EBP + -0x14],ECX
007d736e : CMP ECX,EDI
007d7370 : JC 0x007d7300
007d7372 : MOV ESI,dword ptr [EBP + -0x18]
007d7375 : MOV byte ptr [EBP + -0x4],0x0
007d7379 : MOV ECX,dword ptr [EBP + -0x30]
007d737c : MOV dword ptr [EBP + -0x34],0xcd4964
007d7383 : TEST ECX,ECX
007d7385 : JZ 0x007d7395
007d7387 : MOV EDX,dword ptr [ECX]
007d7389 : MOV EAX,dword ptr [EDX + 0x30]
007d738c : CALL EAX
007d738e : MOV dword ptr [EBP + -0x30],0x0
007d7395 : MOV ESI,dword ptr [ESI]
007d7397 : MOV dword ptr [EBP + -0x18],ESI
007d739a : CMP ESI,dword ptr [EBP + -0x28]
007d739d : JNZ 0x007d72c0
007d73a3 : MOV EDI,dword ptr [EBP + -0x1c]
007d73a6 : JMP 0x007d7231
007d73ab : CALL 0x0045cd70

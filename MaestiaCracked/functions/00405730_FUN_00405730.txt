PROGRAM  : Maestia.exe
FUNCTION : FUN_00405730
ENTRY    : 00405730
BODY     : [[00405730, 004058b1] [004058b8, 004058e0] [00405936, 004059bb] [004059da, 00405a60]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00405730(int param_1,int param_2,undefined4 param_3)

{
  uint *puVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  undefined4 uVar5;
  int extraout_ECX;
  uint uStack_58;
  uint local_38;
  undefined1 local_34 [28];
  uint local_18;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7edb0;
  local_10 = ExceptionList;
  uStack_58 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&uStack_58;
  ExceptionList = &local_10;
  iVar2 = *(int *)(param_1 + 4);
  if (iVar2 == 0) {
    local_38 = 0;
  }
  else {
    local_38 = (*(int *)(param_1 + 0xc) - iVar2) / 0x1c;
  }
  iVar4 = *(int *)(param_1 + 8);
  iVar2 = (iVar4 - iVar2) / 0x1c;
  local_18 = uStack_58;
  puVar1 = &uStack_58;
  if (iVar2 == 0x9249249) {
    iVar2 = FUN_00429be0();
    iVar4 = extraout_ECX;
    puVar1 = (uint *)local_14;
  }
  local_14 = (undefined1 *)puVar1;
  uVar3 = iVar2 + 1;
  if (local_38 < uVar3) {
    if (0x9249249 - (local_38 >> 1) < local_38) {
      local_38 = 0;
    }
    else {
      local_38 = local_38 + (local_38 >> 1);
    }
    if (local_38 < uVar3) {
      local_38 = uVar3;
    }
    iVar4 = FUN_0043c030();
    iVar2 = *(int *)(param_1 + 4);
    local_8 = 0;
    FUN_00405420();
    FUN_00405630(*(undefined4 *)(param_1 + 4),iVar4);
    FUN_00405630(param_2,iVar4 + ((param_2 - iVar2) / 0x1c + 1) * 0x1c);
    local_8 = 0xffffffff;
    iVar2 = (*(int *)(param_1 + 8) - *(int *)(param_1 + 4)) / 0x1c + 1;
    if (*(int *)(param_1 + 4) != 0) {
      FUN_00405450(iVar2);
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    *(uint *)(param_1 + 0xc) = iVar4 + local_38 * 0x1c;
    *(int *)(param_1 + 8) = iVar4 + iVar2 * 0x1c;
    *(int *)(param_1 + 4) = iVar4;
  }
  else {
    iVar2 = iVar4 - param_2 >> 0x1f;
    if ((iVar4 - param_2) / 0x1c + iVar2 == iVar2) {
      FUN_00405660(param_3);
      local_8 = 2;
      FUN_00405630(param_2,param_2 + 0x1c);
      local_8 = CONCAT31(local_8._1_3_,3);
      FUN_00405420();
      local_8 = 2;
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 0x1c;
    }
    else {
      FUN_00405660(param_3);
      local_8 = 5;
      iVar4 = *(int *)(param_1 + 8);
      iVar2 = iVar4 + -0x1c;
      uVar5 = FUN_00405630(iVar2,iVar4);
      *(undefined4 *)(param_1 + 8) = uVar5;
      if (param_2 != iVar2) {
        iVar4 = iVar4 - iVar2;
        do {
          iVar2 = iVar2 + -0x1c;
          FUN_00405690(iVar4 + iVar2);
        } while (iVar2 != param_2);
      }
    }
    FUN_00405700(local_34);
    local_8 = 0xffffffff;
    FUN_00406560();
  }
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00405730 : PUSH EBP
00405731 : MOV EBP,ESP
00405733 : PUSH -0x1
00405735 : PUSH 0xb7edb0
0040573a : MOV EAX,FS:[0x0]
00405740 : PUSH EAX
00405741 : SUB ESP,0x38
00405744 : MOV EAX,[0x00d66fa0]
00405749 : XOR EAX,EBP
0040574b : MOV dword ptr [EBP + -0x14],EAX
0040574e : PUSH EBX
0040574f : PUSH ESI
00405750 : PUSH EDI
00405751 : PUSH EAX
00405752 : LEA EAX,[EBP + -0xc]
00405755 : MOV FS:[0x0],EAX
0040575b : MOV dword ptr [EBP + -0x10],ESP
0040575e : MOV EBX,dword ptr [EBP + 0x8]
00405761 : MOV dword ptr [EBP + -0x3c],EBX
00405764 : MOV EAX,dword ptr [EBP + 0x10]
00405767 : MOV dword ptr [EBP + -0x38],EAX
0040576a : MOV ESI,dword ptr [EBX + 0x4]
0040576d : TEST ESI,ESI
0040576f : JNZ 0x00405776
00405771 : MOV dword ptr [EBP + -0x34],ESI
00405774 : JMP 0x00405791
00405776 : MOV ECX,dword ptr [EBX + 0xc]
00405779 : SUB ECX,ESI
0040577b : MOV EAX,0x92492493
00405780 : IMUL ECX
00405782 : ADD EDX,ECX
00405784 : SAR EDX,0x4
00405787 : MOV EAX,EDX
00405789 : SHR EAX,0x1f
0040578c : ADD EAX,EDX
0040578e : MOV dword ptr [EBP + -0x34],EAX
00405791 : MOV ECX,dword ptr [EBX + 0x8]
00405794 : MOV EDI,ECX
00405796 : SUB EDI,ESI
00405798 : MOV EAX,0x92492493
0040579d : IMUL EDI
0040579f : ADD EDX,EDI
004057a1 : SAR EDX,0x4
004057a4 : MOV EAX,EDX
004057a6 : SHR EAX,0x1f
004057a9 : ADD EAX,EDX
004057ab : MOV EDX,0x9249249
004057b0 : SUB EDX,EAX
004057b2 : CMP EDX,0x1
004057b5 : JNC 0x004057bc
004057b7 : CALL 0x00429be0
004057bc : INC EAX
004057bd : MOV EDX,dword ptr [EBP + -0x34]
004057c0 : CMP EDX,EAX
004057c2 : JNC 0x00405936
004057c8 : MOV ECX,EDX
004057ca : SHR ECX,0x1
004057cc : MOV ESI,0x9249249
004057d1 : SUB ESI,ECX
004057d3 : CMP ESI,EDX
004057d5 : JNC 0x004057e0
004057d7 : XOR EDI,EDI
004057d9 : MOV dword ptr [EBP + -0x34],EDI
004057dc : MOV EDX,EDI
004057de : JMP 0x004057e7
004057e0 : ADD EDX,ECX
004057e2 : MOV dword ptr [EBP + -0x34],EDX
004057e5 : XOR EDI,EDI
004057e7 : CMP EDX,EAX
004057e9 : JNC 0x004057f0
004057eb : MOV dword ptr [EBP + -0x34],EAX
004057ee : MOV EDX,EAX
004057f0 : MOV ECX,EDX
004057f2 : CALL 0x0043c030
004057f7 : MOV ESI,EAX
004057f9 : MOV dword ptr [EBP + -0x44],ESI
004057fc : MOV ECX,dword ptr [EBP + 0xc]
004057ff : SUB ECX,dword ptr [EBX + 0x4]
00405802 : MOV EAX,0x92492493
00405807 : IMUL ECX
00405809 : ADD EDX,ECX
0040580b : SAR EDX,0x4
0040580e : MOV EAX,EDX
00405810 : SHR EAX,0x1f
00405813 : ADD EAX,EDX
00405815 : MOV dword ptr [EBP + -0x3c],EAX
00405818 : MOV dword ptr [EBP + -0x40],EDI
0040581b : MOV dword ptr [EBP + -0x4],EDI
0040581e : LEA ECX,[EAX*0x8 + 0x0]
00405825 : SUB ECX,EAX
00405827 : LEA EDI,[ESI + ECX*0x4]
0040582a : MOV EDX,dword ptr [EBP + -0x38]
0040582d : MOV ESI,0x1
00405832 : CALL 0x00405420
00405837 : MOV dword ptr [EBP + -0x40],ESI
0040583a : MOV EDI,dword ptr [EBP + -0x44]
0040583d : PUSH EDI
0040583e : MOV EDX,dword ptr [EBX + 0x4]
00405841 : PUSH EDX
00405842 : MOV EDX,dword ptr [EBP + 0xc]
00405845 : CALL 0x00405630
0040584a : MOV dword ptr [EBP + -0x40],0x2
00405851 : MOV EAX,dword ptr [EBP + -0x3c]
00405854 : INC EAX
00405855 : LEA ECX,[EAX*0x8 + 0x0]
0040585c : SUB ECX,EAX
0040585e : LEA EDX,[EDI + ECX*0x4]
00405861 : PUSH EDX
00405862 : MOV EAX,dword ptr [EBP + 0xc]
00405865 : PUSH EAX
00405866 : MOV EDX,dword ptr [EBX + 0x8]
00405869 : CALL 0x00405630
0040586e : MOV dword ptr [EBP + -0x4],0xffffffff
00405875 : MOV ECX,dword ptr [EBX + 0x8]
00405878 : MOV ESI,dword ptr [EBX + 0x4]
0040587b : SUB ECX,ESI
0040587d : MOV EAX,0x92492493
00405882 : IMUL ECX
00405884 : ADD EDX,ECX
00405886 : SAR EDX,0x4
00405889 : MOV ECX,EDX
0040588b : SHR ECX,0x1f
0040588e : LEA EDX,[EDX + ECX*0x1 + 0x1]
00405892 : MOV dword ptr [EBP + -0x38],EDX
00405895 : TEST ESI,ESI
00405897 : JZ 0x004058b8
00405899 : MOV EDX,dword ptr [EBP + -0x38]
0040589c : PUSH EDX
0040589d : MOV EDI,dword ptr [EBX + 0x8]
004058a0 : MOV EAX,ESI
004058a2 : CALL 0x00405450
004058a7 : ADD ESP,0x4
004058aa : MOV ECX,dword ptr [EBX + 0x4]
004058ad : CALL 0x006f04e0
004058b8 : MOV EAX,dword ptr [EBP + -0x34]
004058bb : LEA ECX,[EAX*0x8 + 0x0]
004058c2 : SUB ECX,EAX
004058c4 : LEA EAX,[EDI + ECX*0x4]
004058c7 : MOV dword ptr [EBX + 0xc],EAX
004058ca : LEA ECX,[EDX*0x8 + 0x0]
004058d1 : SUB ECX,EDX
004058d3 : LEA EDX,[EDI + ECX*0x4]
004058d6 : MOV dword ptr [EBX + 0x8],EDX
004058d9 : MOV dword ptr [EBX + 0x4],EDI
004058dc : JMP 0x00405a43
00405936 : SUB ECX,dword ptr [EBP + 0xc]
00405939 : MOV EAX,0x92492493
0040593e : IMUL ECX
00405940 : ADD EDX,ECX
00405942 : SAR EDX,0x4
00405945 : MOV ECX,EDX
00405947 : SHR ECX,0x1f
0040594a : ADD ECX,EDX
0040594c : CMP ECX,0x1
0040594f : JNC 0x004059da
00405955 : MOV EDX,dword ptr [EBP + -0x38]
00405958 : PUSH EDX
00405959 : LEA ECX,[EBP + -0x30]
0040595c : CALL 0x00405660
00405961 : MOV dword ptr [EBP + -0x4],0x2
00405968 : MOV EAX,dword ptr [EBP + 0xc]
0040596b : LEA ECX,[EAX + 0x1c]
0040596e : PUSH ECX
0040596f : PUSH EAX
00405970 : MOV EDX,dword ptr [EBX + 0x8]
00405973 : CALL 0x00405630
00405978 : MOV byte ptr [EBP + -0x4],0x3
0040597c : MOV EDI,dword ptr [EBX + 0x8]
0040597f : MOV ECX,EDI
00405981 : SUB ECX,dword ptr [EBP + 0xc]
00405984 : MOV EAX,0x92492493
00405989 : IMUL ECX
0040598b : ADD EDX,ECX
0040598d : SAR EDX,0x4
00405990 : MOV EAX,EDX
00405992 : SHR EAX,0x1f
00405995 : ADD EAX,EDX
00405997 : MOV ESI,0x1
0040599c : SUB ESI,EAX
0040599e : LEA EDX,[EBP + -0x30]
004059a1 : CALL 0x00405420
004059a6 : MOV dword ptr [EBP + -0x4],0x2
004059ad : ADD dword ptr [EBX + 0x8],0x1c
004059b1 : MOV EBX,dword ptr [EBX + 0x8]
004059b4 : LEA EDI,[EBX + -0x1c]
004059b7 : MOV EAX,dword ptr [EBP + 0xc]
004059ba : JMP 0x00405a28
004059da : MOV ECX,dword ptr [EBP + -0x38]
004059dd : PUSH ECX
004059de : LEA ECX,[EBP + -0x30]
004059e1 : CALL 0x00405660
004059e6 : MOV dword ptr [EBP + -0x4],0x5
004059ed : MOV EDI,dword ptr [EBX + 0x8]
004059f0 : LEA ESI,[EDI + -0x1c]
004059f3 : PUSH EDI
004059f4 : PUSH ESI
004059f5 : MOV EDX,EDI
004059f7 : CALL 0x00405630
004059fc : MOV dword ptr [EBX + 0x8],EAX
004059ff : MOV EAX,dword ptr [EBP + 0xc]
00405a02 : MOV EBX,EAX
00405a04 : CMP EAX,ESI
00405a06 : JZ 0x00405a25
00405a08 : SUB EDI,ESI
00405a0a : LEA EBX,[EBX]
00405a10 : SUB ESI,0x1c
00405a13 : LEA EDX,[EDI + ESI*0x1]
00405a16 : PUSH EDX
00405a17 : MOV ECX,ESI
00405a19 : CALL 0x00405690
00405a1e : CMP ESI,EBX
00405a20 : JNZ 0x00405a10
00405a22 : MOV EAX,dword ptr [EBP + 0xc]
00405a25 : LEA EDI,[EAX + 0x1c]
00405a28 : LEA ECX,[EBP + -0x30]
00405a2b : PUSH ECX
00405a2c : CALL 0x00405700
00405a31 : ADD ESP,0x4
00405a34 : MOV dword ptr [EBP + -0x4],0xffffffff
00405a3b : LEA ECX,[EBP + -0x30]
00405a3e : CALL 0x00406560
00405a43 : MOV ECX,dword ptr [EBP + -0xc]
00405a46 : MOV dword ptr FS:[0x0],ECX
00405a4d : POP ECX
00405a4e : POP EDI
00405a4f : POP ESI
00405a50 : POP EBX
00405a51 : MOV ECX,dword ptr [EBP + -0x14]
00405a54 : XOR ECX,EBP
00405a56 : CALL 0x00633e6b
00405a5b : MOV ESP,EBP
00405a5d : POP EBP
00405a5e : RET 0xc

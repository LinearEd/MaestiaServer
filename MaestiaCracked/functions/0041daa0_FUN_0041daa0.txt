PROGRAM  : Maestia.exe
FUNCTION : FUN_0041daa0
ENTRY    : 0041daa0
BODY     : [[0041daa0, 0041daf3]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0041daa0(void)

{
  wchar_t wVar1;
  wchar_t *_Dest;
  undefined4 in_ECX;
  wchar_t *in_EDX;
  ushort *unaff_ESI;
  
  _Dest = (wchar_t *)(unaff_ESI + 4);
  *unaff_ESI = 0;
  *(undefined1 *)(unaff_ESI + 1) = 0x34;
  *(undefined1 *)((int)unaff_ESI + 3) = 0x55;
  *(undefined4 *)(unaff_ESI + 2) = in_ECX;
  _wcsncpy(_Dest,in_EDX,0x27);
  unaff_ESI[0x2b] = 0;
  do {
    wVar1 = *_Dest;
    _Dest = _Dest + 1;
  } while (wVar1 != L'\0');
  *unaff_ESI = *unaff_ESI ^
               ((short)((int)_Dest - (int)(unaff_ESI + 5) >> 1) * 2 + 10U ^ *unaff_ESI) & 0x1fff;
  return;
}



============================================================
DISASSEMBLY
============================================================
0041daa0 : PUSH EDI
0041daa1 : PUSH 0x27
0041daa3 : PUSH EDX
0041daa4 : XOR EAX,EAX
0041daa6 : LEA EDI,[ESI + 0x8]
0041daa9 : PUSH EDI
0041daaa : MOV word ptr [ESI],AX
0041daad : MOV byte ptr [ESI + 0x2],0x34
0041dab1 : MOV byte ptr [ESI + 0x3],0x55
0041dab5 : MOV dword ptr [ESI + 0x4],ECX
0041dab8 : CALL 0x00634e39
0041dabd : ADD ESP,0xc
0041dac0 : XOR EAX,EAX
0041dac2 : MOV word ptr [EDI + 0x4e],AX
0041dac6 : MOV EAX,EDI
0041dac8 : LEA EDX,[EAX + 0x2]
0041dacb : POP EDI
0041dacc : LEA ESP,[ESP]
0041dad0 : MOV CX,word ptr [EAX]
0041dad3 : ADD EAX,0x2
0041dad6 : TEST CX,CX
0041dad9 : JNZ 0x0041dad0
0041dadb : SUB EAX,EDX
0041dadd : SAR EAX,0x1
0041dadf : LEA ECX,[EAX + EAX*0x1 + 0xa]
0041dae3 : XOR CX,word ptr [ESI]
0041dae6 : MOV EDX,0x1fff
0041daeb : AND CX,DX
0041daee : XOR word ptr [ESI],CX
0041daf1 : MOV EAX,ESI
0041daf3 : RET

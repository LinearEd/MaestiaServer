PROGRAM  : Maestia.exe
FUNCTION : FUN_006d7450
ENTRY    : 006d7450
BODY     : [[006d7450, 006d750e]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006d7450(int *param_1,int *param_2,void *param_3)

{
  undefined4 *puVar1;
  undefined4 *in_EAX;
  int iVar2;
  byte *pbVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  size_t _Size;
  
  if (*param_2 == 0) {
    iVar2 = FUN_006d9560(param_1);
    *param_2 = iVar2;
  }
  puVar1 = (undefined4 *)*param_2;
  *puVar1 = *in_EAX;
  puVar1[1] = in_EAX[1];
  puVar1[2] = in_EAX[2];
  puVar1[3] = in_EAX[3];
  *(undefined1 *)(puVar1 + 4) = *(undefined1 *)(in_EAX + 4);
  iVar7 = 0;
  iVar5 = 0;
  pbVar3 = (byte *)((int)in_EAX + 2);
  iVar4 = 0;
  iVar2 = 4;
  iVar6 = 0;
  do {
    iVar7 = iVar7 + (uint)pbVar3[-1];
    iVar4 = iVar4 + (uint)*pbVar3;
    iVar5 = iVar5 + (uint)pbVar3[1];
    iVar6 = iVar6 + (uint)pbVar3[2];
    pbVar3 = pbVar3 + 4;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  _Size = iVar7 + iVar6 + iVar5 + iVar4;
  if (((int)_Size < 1) || (0x100 < (int)_Size)) {
    *(undefined4 *)(*param_1 + 0x14) = 8;
    (**(code **)*param_1)(param_1);
  }
  _memcpy((void *)(*param_2 + 0x11),param_3,_Size);
  *(undefined1 *)(*param_2 + 0x111) = 0;
  return;
}



============================================================
DISASSEMBLY
============================================================
006d7450 : PUSH ESI
006d7451 : PUSH EDI
006d7452 : MOV EDI,dword ptr [ESP + 0x10]
006d7456 : CMP dword ptr [EDI],0x0
006d7459 : MOV ESI,EAX
006d745b : JNZ 0x006d746c
006d745d : MOV EAX,dword ptr [ESP + 0xc]
006d7461 : PUSH EAX
006d7462 : CALL 0x006d9560
006d7467 : ADD ESP,0x4
006d746a : MOV dword ptr [EDI],EAX
006d746c : MOV EAX,dword ptr [EDI]
006d746e : MOV ECX,dword ptr [ESI]
006d7470 : MOV dword ptr [EAX],ECX
006d7472 : MOV EDX,dword ptr [ESI + 0x4]
006d7475 : MOV dword ptr [EAX + 0x4],EDX
006d7478 : MOV ECX,dword ptr [ESI + 0x8]
006d747b : MOV dword ptr [EAX + 0x8],ECX
006d747e : MOV EDX,dword ptr [ESI + 0xc]
006d7481 : MOV dword ptr [EAX + 0xc],EDX
006d7484 : MOV CL,byte ptr [ESI + 0x10]
006d7487 : PUSH EBX
006d7488 : MOV byte ptr [EAX + 0x10],CL
006d748b : XOR EDI,EDI
006d748d : XOR EBX,EBX
006d748f : XOR EDX,EDX
006d7491 : LEA EAX,[ESI + 0x2]
006d7494 : PUSH EBP
006d7495 : XOR ECX,ECX
006d7497 : LEA ESI,[EDI + 0x4]
006d749a : LEA EBX,[EBX]
006d74a0 : MOVZX EBP,byte ptr [EAX + -0x1]
006d74a4 : ADD EDI,EBP
006d74a6 : MOVZX EBP,byte ptr [EAX]
006d74a9 : ADD ECX,EBP
006d74ab : MOVZX EBP,byte ptr [EAX + 0x1]
006d74af : ADD EDX,EBP
006d74b1 : MOVZX EBP,byte ptr [EAX + 0x2]
006d74b5 : ADD EBX,EBP
006d74b7 : ADD EAX,0x4
006d74ba : SUB ESI,0x1
006d74bd : JNZ 0x006d74a0
006d74bf : ADD EBX,EDX
006d74c1 : ADD EBX,ECX
006d74c3 : ADD EDI,EBX
006d74c5 : CMP EDI,0x1
006d74c8 : POP EBP
006d74c9 : POP EBX
006d74ca : JL 0x006d74d4
006d74cc : CMP EDI,0x100
006d74d2 : JLE 0x006d74eb
006d74d4 : MOV EAX,dword ptr [ESP + 0xc]
006d74d8 : MOV EDX,dword ptr [EAX]
006d74da : MOV dword ptr [EDX + 0x14],0x8
006d74e1 : MOV ECX,dword ptr [EAX]
006d74e3 : MOV EDX,dword ptr [ECX]
006d74e5 : PUSH EAX
006d74e6 : CALL EDX
006d74e8 : ADD ESP,0x4
006d74eb : MOV ESI,dword ptr [ESP + 0x10]
006d74ef : MOV EAX,dword ptr [ESP + 0x14]
006d74f3 : MOV ECX,dword ptr [ESI]
006d74f5 : PUSH EDI
006d74f6 : PUSH EAX
006d74f7 : ADD ECX,0x11
006d74fa : PUSH ECX
006d74fb : CALL 0x0063ae40
006d7500 : MOV EDX,dword ptr [ESI]
006d7502 : ADD ESP,0xc
006d7505 : POP EDI
006d7506 : MOV byte ptr [EDX + 0x111],0x0
006d750d : POP ESI
006d750e : RET

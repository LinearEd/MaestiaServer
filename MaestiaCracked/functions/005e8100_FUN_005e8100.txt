PROGRAM  : Maestia.exe
FUNCTION : FUN_005e8100
ENTRY    : 005e8100
BODY     : [[005e8100, 005e8249] [005e8250, 005e844b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005e8100(int param_1)

{
  int iVar1;
  size_t _Size;
  byte bVar2;
  uint uVar3;
  byte *pbVar4;
  byte *pbVar5;
  byte bVar6;
  uint uVar7;
  byte *pbVar8;
  uint uVar9;
  undefined1 *puVar10;
  byte *pbVar11;
  void *pvVar12;
  uint local_24;
  uint local_20;
  void *local_c;
  undefined4 local_8;
  undefined4 local_4;
  
  if (*(int *)(param_1 + 8) == 1) {
    iVar1 = *(int *)(param_1 + 0xc) * 4;
    _Size = iVar1 + 8;
    uVar9 = (*(int *)(param_1 + 0x10) + 2) * _Size;
    uVar7 = 0;
    local_c = (void *)0x0;
    local_8 = 0;
    local_4 = 0;
    FUN_005da1e0(&local_c,(uVar9 >> 2) + uVar9);
    pvVar12 = local_c;
    if (uVar9 == 0) {
      FUN_00515cf0(local_c);
      return;
    }
    _memset(local_c,0,_Size);
    _memset((void *)((*(int *)(param_1 + 0x10) + 1) * _Size + (int)pvVar12),0,_Size);
    if (*(int *)(param_1 + 0x10) != 0) {
      puVar10 = (undefined1 *)((int)pvVar12 + _Size * 2 + -4);
      do {
        _memcpy(puVar10 + (8 - _Size),
                (void *)(*(int *)(param_1 + 0x14) * uVar7 + *(int *)(param_1 + 0x18)),
                *(int *)(param_1 + 0xc) * 4);
        puVar10[7 - _Size] = 0;
        puVar10[6 - _Size] = 0;
        puVar10[5 - _Size] = 0;
        puVar10[4 - _Size] = 0;
        puVar10[3] = 0;
        puVar10[2] = 0;
        puVar10[1] = 0;
        *puVar10 = 0;
        uVar7 = uVar7 + 1;
        puVar10 = puVar10 + _Size;
        pvVar12 = local_c;
      } while (uVar7 < *(uint *)(param_1 + 0x10));
    }
    local_20 = 0;
    if (*(int *)(param_1 + 0x10) != 0) {
      pbVar4 = (byte *)((int)pvVar12 + 0xb);
      do {
        pbVar4 = pbVar4 + _Size;
        local_24 = 0;
        if (*(int *)(param_1 + 0xc) != 0) {
          pbVar8 = (byte *)(*(int *)(param_1 + 0x14) * local_20 + *(int *)(param_1 + 0x18) + 1);
          pbVar11 = pbVar4 + (-8 - _Size);
          pbVar5 = pbVar4;
          do {
            bVar2 = pbVar8[2];
            if (bVar2 < 0x10) {
              uVar7 = (uint)pbVar5[iVar1 + 4] + (uint)pbVar11[_Size] + (uint)pbVar11[8] +
                      (uint)pbVar11[4] + (uint)pbVar5[-4] + (uint)pbVar5[_Size] +
                      (uint)pbVar5[iVar1] + (uint)*pbVar5 + (uint)*pbVar11;
              if (uVar7 != 0) {
                uVar9 = (((uint)pbVar11[iVar1 + 5] + (uint)pbVar5[iVar1 + 1] + (uint)pbVar11[5] +
                          (uint)pbVar11[-3] + (uint)pbVar11[1] + (uint)pbVar5[-3] +
                          (uint)pbVar5[iVar1 + 5] + (uint)pbVar5[iVar1 + -3] + (uint)pbVar5[-7]) *
                        0x100) / uVar7;
                uVar3 = (((uint)pbVar11[iVar1 + 6] + (uint)pbVar5[iVar1 + 2] + (uint)pbVar11[6] +
                          (uint)pbVar11[-2] + (uint)pbVar11[2] + (uint)pbVar5[-6] + (uint)pbVar5[-2]
                          + (uint)pbVar5[iVar1 + 6] + (uint)pbVar5[iVar1 + -2]) * 0x100) / uVar7;
                uVar7 = (((uint)pbVar11[iVar1 + 7] + (uint)pbVar5[iVar1 + 3] + (uint)pbVar11[7] +
                          (uint)pbVar11[3] + (uint)pbVar11[-1] + (uint)pbVar5[-5] + (uint)pbVar5[-1]
                          + (uint)pbVar5[iVar1 + 7] + (uint)pbVar5[iVar1 + -1]) * 0x100) / uVar7;
                bVar2 = (byte)uVar9;
                if (0xff < uVar9) {
                  bVar2 = 0xff;
                }
                pbVar8[-1] = bVar2;
                if (0xff < uVar3) {
                  uVar3 = 0xff;
                }
                *pbVar8 = (byte)uVar3;
                if (0xff < uVar7) {
                  uVar7 = 0xff;
                }
                goto LAB_005e83f6;
              }
            }
            else {
              uVar7 = (uint)*(ushort *)(&DAT_00d65fd8 + (uint)bVar2 * 2);
              bVar6 = pbVar8[-1];
              if (bVar2 < pbVar8[-1]) {
                bVar6 = bVar2;
              }
              pbVar8[-1] = (byte)(bVar6 * uVar7 >> 8);
              bVar6 = *pbVar8;
              if (bVar2 < *pbVar8) {
                bVar6 = bVar2;
              }
              *pbVar8 = (byte)(bVar6 * uVar7 >> 8);
              if (pbVar8[1] <= bVar2) {
                bVar2 = pbVar8[1];
              }
              uVar7 = bVar2 * uVar7 >> 8;
LAB_005e83f6:
              pbVar8[1] = (byte)uVar7;
            }
            local_24 = local_24 + 1;
            pbVar11 = pbVar11 + 4;
            pbVar5 = pbVar5 + 4;
            pbVar8 = pbVar8 + 4;
            pvVar12 = local_c;
          } while (local_24 < *(uint *)(param_1 + 0xc));
        }
        local_20 = local_20 + 1;
      } while (local_20 < *(uint *)(param_1 + 0x10));
    }
    FUN_00515cf0(pvVar12);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005e8100 : SUB ESP,0x24
005e8103 : PUSH EBP
005e8104 : MOV EBP,dword ptr [ESP + 0x2c]
005e8108 : CMP dword ptr [EBP + 0x8],0x1
005e810c : JNZ 0x005e8447
005e8112 : PUSH EBX
005e8113 : PUSH ESI
005e8114 : MOV ESI,dword ptr [EBP + 0xc]
005e8117 : PUSH EDI
005e8118 : MOV EDI,dword ptr [EBP + 0x10]
005e811b : LEA ESI,[ESI*0x4 + 0x8]
005e8122 : ADD EDI,0x2
005e8125 : IMUL EDI,ESI
005e8128 : MOV EAX,EDI
005e812a : SHR EAX,0x2
005e812d : ADD EAX,EDI
005e812f : XOR EBX,EBX
005e8131 : PUSH EAX
005e8132 : LEA ECX,[ESP + 0x2c]
005e8136 : PUSH ECX
005e8137 : MOV dword ptr [ESP + 0x30],EBX
005e813b : MOV dword ptr [ESP + 0x34],EBX
005e813f : MOV dword ptr [ESP + 0x38],EBX
005e8143 : CALL 0x005da1e0
005e8148 : CMP EDI,EBX
005e814a : JNZ 0x005e815e
005e814c : MOV EDX,dword ptr [ESP + 0x28]
005e8150 : PUSH EDX
005e8151 : CALL 0x00515cf0
005e8156 : POP EDI
005e8157 : POP ESI
005e8158 : POP EBX
005e8159 : POP EBP
005e815a : ADD ESP,0x24
005e815d : RET
005e815e : MOV EDI,dword ptr [ESP + 0x28]
005e8162 : PUSH ESI
005e8163 : PUSH EBX
005e8164 : PUSH EDI
005e8165 : CALL 0x0063b700
005e816a : MOV EAX,dword ptr [EBP + 0x10]
005e816d : INC EAX
005e816e : IMUL EAX,ESI
005e8171 : PUSH ESI
005e8172 : ADD EAX,EDI
005e8174 : PUSH EBX
005e8175 : PUSH EAX
005e8176 : CALL 0x0063b700
005e817b : ADD ESP,0x18
005e817e : CMP dword ptr [EBP + 0x10],EBX
005e8181 : JBE 0x005e8226
005e8187 : MOV ECX,0x5
005e818c : SUB ECX,ESI
005e818e : MOV dword ptr [ESP + 0x14],ECX
005e8192 : MOV ECX,0x4
005e8197 : SUB ECX,ESI
005e8199 : MOV dword ptr [ESP + 0x10],ECX
005e819d : MOV ECX,0x3
005e81a2 : SUB ECX,ESI
005e81a4 : MOV dword ptr [ESP + 0x1c],ECX
005e81a8 : MOV EAX,0x6
005e81ad : SUB EAX,ESI
005e81af : MOV ECX,0x2
005e81b4 : SUB ECX,ESI
005e81b6 : LEA EDI,[EDI + ESI*0x2 + -0x4]
005e81ba : MOV dword ptr [ESP + 0x18],EAX
005e81be : MOV dword ptr [ESP + 0x20],ECX
005e81c2 : JMP 0x005e81c8
005e81c4 : MOV EAX,dword ptr [ESP + 0x18]
005e81c8 : MOV EDX,dword ptr [EBP + 0x14]
005e81cb : MOV ECX,dword ptr [EBP + 0xc]
005e81ce : IMUL EDX,EBX
005e81d1 : ADD EDX,dword ptr [EBP + 0x18]
005e81d4 : ADD ECX,ECX
005e81d6 : ADD ECX,ECX
005e81d8 : PUSH ECX
005e81d9 : PUSH EDX
005e81da : LEA EAX,[EAX + EDI*0x1 + 0x2]
005e81de : PUSH EAX
005e81df : CALL 0x0063ae40
005e81e4 : MOV ECX,dword ptr [ESP + 0x20]
005e81e8 : MOV EDX,dword ptr [ESP + 0x1c]
005e81ec : MOV EAX,dword ptr [ESP + 0x28]
005e81f0 : MOV byte ptr [ECX + EDI*0x1 + 0x2],0x0
005e81f5 : MOV ECX,dword ptr [ESP + 0x2c]
005e81f9 : MOV byte ptr [EDX + EDI*0x1 + 0x2],0x0
005e81fe : MOV byte ptr [EAX + EDI*0x1 + 0x2],0x0
005e8203 : MOV byte ptr [ECX + EDI*0x1 + 0x2],0x0
005e8208 : MOV byte ptr [EDI + 0x3],0x0
005e820c : MOV byte ptr [EDI + 0x2],0x0
005e8210 : MOV byte ptr [EDI + 0x1],0x0
005e8214 : MOV byte ptr [EDI],0x0
005e8217 : INC EBX
005e8218 : ADD ESP,0xc
005e821b : ADD EDI,ESI
005e821d : CMP EBX,dword ptr [EBP + 0x10]
005e8220 : JC 0x005e81c4
005e8222 : MOV EDI,dword ptr [ESP + 0x28]
005e8226 : XOR EAX,EAX
005e8228 : MOV dword ptr [ESP + 0x14],EAX
005e822c : CMP dword ptr [EBP + 0x10],EAX
005e822f : JBE 0x005e843e
005e8235 : MOV EDX,0xfffffff8
005e823a : LEA ECX,[EDI + ESI*0x1 + 0xb]
005e823e : SUB EDX,ESI
005e8240 : MOV dword ptr [ESP + 0x18],ECX
005e8244 : MOV dword ptr [ESP + 0x24],EDX
005e8248 : JMP 0x005e8250
005e8250 : MOV EBX,dword ptr [EBP + 0x14]
005e8253 : IMUL EBX,EAX
005e8256 : ADD EBX,dword ptr [EBP + 0x18]
005e8259 : CMP dword ptr [EBP + 0xc],0x0
005e825d : MOV dword ptr [ESP + 0x10],0x0
005e8265 : JBE 0x005e842a
005e826b : INC EBX
005e826c : LEA EDI,[EDX + ECX*0x1]
005e826f : NOP
005e8270 : MOV AL,byte ptr [EBX + 0x2]
005e8273 : CMP AL,0x10
005e8275 : JNC 0x005e83b1
005e827b : MOVZX EDX,byte ptr [EDI + ESI*0x1]
005e827f : MOVZX EBP,byte ptr [ECX + ESI*0x1 + -0x4]
005e8284 : MOVZX EAX,byte ptr [EDI + 0x8]
005e8288 : ADD EBP,EDX
005e828a : MOVZX EDX,byte ptr [EDI + 0x4]
005e828e : ADD EBP,EAX
005e8290 : MOVZX EAX,byte ptr [ECX + -0x4]
005e8294 : ADD EBP,EDX
005e8296 : MOVZX EDX,byte ptr [ECX + ESI*0x1]
005e829a : ADD EBP,EAX
005e829c : MOVZX EAX,byte ptr [ECX + ESI*0x1 + -0x8]
005e82a1 : ADD EBP,EDX
005e82a3 : MOVZX EDX,byte ptr [ECX]
005e82a6 : ADD EBP,EAX
005e82a8 : MOVZX EAX,byte ptr [EDI]
005e82ab : ADD EBP,EDX
005e82ad : ADD EBP,EAX
005e82af : JZ 0x005e83f9
005e82b5 : MOVZX EDX,byte ptr [ESI + ECX*0x1 + -0x7]
005e82ba : MOVZX EAX,byte ptr [EDI + ESI*0x1 + -0x3]
005e82bf : ADD EAX,EDX
005e82c1 : MOVZX EDX,byte ptr [EDI + 0x5]
005e82c5 : ADD EAX,EDX
005e82c7 : MOVZX EDX,byte ptr [EDI + -0x3]
005e82cb : ADD EAX,EDX
005e82cd : MOVZX EDX,byte ptr [EDI + 0x1]
005e82d1 : ADD EAX,EDX
005e82d3 : MOVZX EDX,byte ptr [ECX + -0x3]
005e82d7 : ADD EAX,EDX
005e82d9 : MOVZX EDX,byte ptr [ECX + ESI*0x1 + -0x3]
005e82de : ADD EAX,EDX
005e82e0 : MOVZX EDX,byte ptr [ECX + ESI*0x1 + -0xb]
005e82e5 : ADD EAX,EDX
005e82e7 : MOVZX EDX,byte ptr [ECX + -0x7]
005e82eb : ADD EAX,EDX
005e82ed : SHL EAX,0x8
005e82f0 : XOR EDX,EDX
005e82f2 : DIV EBP
005e82f4 : MOVZX EDX,byte ptr [ECX + ESI*0x1 + -0x6]
005e82f9 : MOV dword ptr [ESP + 0x20],EAX
005e82fd : MOVZX EAX,byte ptr [EDI + ESI*0x1 + -0x2]
005e8302 : ADD EAX,EDX
005e8304 : MOVZX EDX,byte ptr [EDI + 0x6]
005e8308 : ADD EAX,EDX
005e830a : MOVZX EDX,byte ptr [EDI + -0x2]
005e830e : ADD EAX,EDX
005e8310 : MOVZX EDX,byte ptr [EDI + 0x2]
005e8314 : ADD EAX,EDX
005e8316 : MOVZX EDX,byte ptr [ECX + -0x6]
005e831a : ADD EAX,EDX
005e831c : MOVZX EDX,byte ptr [ECX + -0x2]
005e8320 : ADD EAX,EDX
005e8322 : MOVZX EDX,byte ptr [ECX + ESI*0x1 + -0x2]
005e8327 : ADD EAX,EDX
005e8329 : MOVZX EDX,byte ptr [ECX + ESI*0x1 + -0xa]
005e832e : ADD EAX,EDX
005e8330 : SHL EAX,0x8
005e8333 : XOR EDX,EDX
005e8335 : DIV EBP
005e8337 : MOVZX EDX,byte ptr [ECX + ESI*0x1 + -0x5]
005e833c : MOV dword ptr [ESP + 0x1c],EAX
005e8340 : MOVZX EAX,byte ptr [EDI + ESI*0x1 + -0x1]
005e8345 : ADD EAX,EDX
005e8347 : MOVZX EDX,byte ptr [EDI + 0x7]
005e834b : ADD EAX,EDX
005e834d : MOVZX EDX,byte ptr [EDI + 0x3]
005e8351 : ADD EAX,EDX
005e8353 : MOVZX EDX,byte ptr [EDI + -0x1]
005e8357 : ADD EAX,EDX
005e8359 : MOVZX EDX,byte ptr [ECX + -0x5]
005e835d : ADD EAX,EDX
005e835f : MOVZX EDX,byte ptr [ECX + -0x1]
005e8363 : ADD EAX,EDX
005e8365 : MOVZX EDX,byte ptr [ECX + ESI*0x1 + -0x1]
005e836a : ADD EAX,EDX
005e836c : MOVZX EDX,byte ptr [ECX + ESI*0x1 + -0x9]
005e8371 : ADD EAX,EDX
005e8373 : XOR EDX,EDX
005e8375 : SHL EAX,0x8
005e8378 : DIV EBP
005e837a : MOV EBP,dword ptr [ESP + 0x20]
005e837e : MOV EDX,EBP
005e8380 : CMP EBP,0xff
005e8386 : JBE 0x005e838d
005e8388 : MOV EDX,0xff
005e838d : MOV byte ptr [EBX + -0x1],DL
005e8390 : MOV EDX,dword ptr [ESP + 0x1c]
005e8394 : CMP EDX,0xff
005e839a : JBE 0x005e83a1
005e839c : MOV EDX,0xff
005e83a1 : MOV byte ptr [EBX],DL
005e83a3 : CMP EAX,0xff
005e83a8 : JBE 0x005e83f6
005e83aa : MOV EAX,0xff
005e83af : JMP 0x005e83f6
005e83b1 : MOVZX EDX,AL
005e83b4 : MOVZX EBP,word ptr [EDX*0x2 + 0xd65fd8]
005e83bc : MOV DL,byte ptr [EBX + -0x1]
005e83bf : CMP DL,AL
005e83c1 : JBE 0x005e83c5
005e83c3 : MOV DL,AL
005e83c5 : MOVZX EDX,DL
005e83c8 : IMUL EDX,EBP
005e83cb : SHR EDX,0x8
005e83ce : MOV byte ptr [EBX + -0x1],DL
005e83d1 : MOV DL,byte ptr [EBX]
005e83d3 : CMP DL,AL
005e83d5 : JBE 0x005e83d9
005e83d7 : MOV DL,AL
005e83d9 : MOVZX EDX,DL
005e83dc : IMUL EDX,EBP
005e83df : SHR EDX,0x8
005e83e2 : MOV byte ptr [EBX],DL
005e83e4 : MOV DL,byte ptr [EBX + 0x1]
005e83e7 : CMP DL,AL
005e83e9 : JA 0x005e83ed
005e83eb : MOV AL,DL
005e83ed : MOVZX EAX,AL
005e83f0 : IMUL EAX,EBP
005e83f3 : SHR EAX,0x8
005e83f6 : MOV byte ptr [EBX + 0x1],AL
005e83f9 : MOV EAX,dword ptr [ESP + 0x10]
005e83fd : MOV EDX,dword ptr [ESP + 0x38]
005e8401 : INC EAX
005e8402 : ADD EDI,0x4
005e8405 : ADD ECX,0x4
005e8408 : ADD EBX,0x4
005e840b : MOV dword ptr [ESP + 0x10],EAX
005e840f : CMP EAX,dword ptr [EDX + 0xc]
005e8412 : JC 0x005e8270
005e8418 : MOV EDI,dword ptr [ESP + 0x28]
005e841c : MOV EAX,dword ptr [ESP + 0x14]
005e8420 : MOV ECX,dword ptr [ESP + 0x18]
005e8424 : MOV EBP,EDX
005e8426 : MOV EDX,dword ptr [ESP + 0x24]
005e842a : INC EAX
005e842b : ADD ECX,ESI
005e842d : MOV dword ptr [ESP + 0x14],EAX
005e8431 : MOV dword ptr [ESP + 0x18],ECX
005e8435 : CMP EAX,dword ptr [EBP + 0x10]
005e8438 : JC 0x005e8250
005e843e : PUSH EDI
005e843f : CALL 0x00515cf0
005e8444 : POP EDI
005e8445 : POP ESI
005e8446 : POP EBX
005e8447 : POP EBP
005e8448 : ADD ESP,0x24
005e844b : RET

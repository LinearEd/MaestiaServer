PROGRAM  : Maestia.exe
FUNCTION : FUN_00421570
ENTRY    : 00421570
BODY     : [[00421570, 004215c3]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00421570(void)

{
  wchar_t wVar1;
  wchar_t *_Dest;
  undefined1 in_CL;
  wchar_t *in_EDX;
  ushort *unaff_ESI;
  
  _Dest = (wchar_t *)(unaff_ESI + 2);
  *unaff_ESI = 0;
  *(undefined1 *)(unaff_ESI + 1) = 0x5f;
  *(undefined1 *)((int)unaff_ESI + 3) = 1;
  *(undefined1 *)(unaff_ESI + 0x2a) = in_CL;
  _wcsncpy(_Dest,in_EDX,0x27);
  unaff_ESI[0x29] = 0;
  do {
    wVar1 = *_Dest;
    _Dest = _Dest + 1;
  } while (wVar1 != L'\0');
  *unaff_ESI = *unaff_ESI ^
               ((short)((int)_Dest - (int)(unaff_ESI + 3) >> 1) * 2 + 7U ^ *unaff_ESI) & 0x1fff;
  return;
}



============================================================
DISASSEMBLY
============================================================
00421570 : PUSH EDI
00421571 : PUSH 0x27
00421573 : PUSH EDX
00421574 : XOR EAX,EAX
00421576 : LEA EDI,[ESI + 0x4]
00421579 : PUSH EDI
0042157a : MOV word ptr [ESI],AX
0042157d : MOV byte ptr [ESI + 0x2],0x5f
00421581 : MOV byte ptr [ESI + 0x3],0x1
00421585 : MOV byte ptr [ESI + 0x54],CL
00421588 : CALL 0x00634e39
0042158d : ADD ESP,0xc
00421590 : XOR EAX,EAX
00421592 : MOV word ptr [EDI + 0x4e],AX
00421596 : MOV EAX,EDI
00421598 : LEA EDX,[EAX + 0x2]
0042159b : POP EDI
0042159c : LEA ESP,[ESP]
004215a0 : MOV CX,word ptr [EAX]
004215a3 : ADD EAX,0x2
004215a6 : TEST CX,CX
004215a9 : JNZ 0x004215a0
004215ab : SUB EAX,EDX
004215ad : SAR EAX,0x1
004215af : LEA ECX,[EAX + EAX*0x1 + 0x7]
004215b3 : XOR CX,word ptr [ESI]
004215b6 : MOV EDX,0x1fff
004215bb : AND CX,DX
004215be : XOR word ptr [ESI],CX
004215c1 : MOV EAX,ESI
004215c3 : RET

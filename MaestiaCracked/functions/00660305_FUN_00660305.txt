PROGRAM  : Maestia.exe
FUNCTION : FUN_00660305
ENTRY    : 00660305
BODY     : [[00660305, 00660432] [00660436, 0066045e] [00660462, 00660c2b]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x00660843) */
/* WARNING: Removing unreachable block (ram,0x0066084d) */
/* WARNING: Removing unreachable block (ram,0x00660852) */

void FUN_00660305(int param_1,uint param_2,ushort param_3,int param_4,byte param_5,short *param_6)

{
  int iVar1;
  ushort *puVar2;
  int iVar3;
  bool bVar4;
  errno_t eVar5;
  uint uVar6;
  ushort uVar7;
  uint uVar8;
  ushort *puVar9;
  uint uVar10;
  ushort uVar11;
  ushort uVar12;
  ushort uVar13;
  char cVar14;
  uint uVar15;
  uint uVar16;
  short *psVar17;
  short *psVar18;
  short *psVar19;
  int iVar20;
  uint uVar21;
  uint uVar22;
  char *pcVar23;
  ushort *local_74;
  ushort *local_70;
  undefined *local_6c;
  ushort local_64;
  ushort *local_5c;
  int local_58;
  int local_54;
  short local_50;
  int local_4c;
  int local_48;
  int local_44;
  ushort local_40;
  undefined4 uStack_3e;
  ushort uStack_3a;
  int local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined2 local_2c;
  undefined1 uStack_2a;
  undefined1 uStack_29;
  undefined4 local_24;
  undefined4 uStack_20;
  ushort uStack_1c;
  undefined1 local_1a;
  byte bStack_19;
  byte local_14;
  undefined1 uStack_13;
  undefined4 uStack_12;
  undefined4 uStack_e;
  ushort uStack_a;
  uint local_8;
  
  uVar16 = CONCAT22(uStack_20._2_2_,(undefined2)uStack_20);
  uVar6 = CONCAT22(local_24._2_2_,(ushort)local_24);
  iVar20 = CONCAT22(uStack_3e._2_2_,(undefined2)uStack_3e);
  iVar1 = CONCAT22(uStack_3e._2_2_,(undefined2)uStack_3e);
  local_8 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_14 = (byte)param_1;
  uStack_13 = (undefined1)((uint)param_1 >> 8);
  uStack_12._0_2_ = (ushort)((uint)param_1 >> 0x10);
  uStack_12._2_2_ = (ushort)param_2;
  uVar10 = CONCAT22(uStack_12._2_2_,(ushort)uStack_12);
  uStack_e._0_2_ = (ushort)(param_2 >> 0x10);
  uStack_e._2_2_ = param_3;
  uVar8 = CONCAT22(param_3,(ushort)uStack_e);
  uVar21 = CONCAT22(param_3,(ushort)uStack_e);
  local_64 = param_3 & 0x8000;
  uVar11 = param_3 & 0x7fff;
  local_34 = 0xcccccccc;
  local_30 = 0xcccccccc;
  local_2c._0_1_ = 0xcc;
  local_2c._1_1_ = 0xcc;
  uStack_2a = 0xfb;
  uStack_29 = 0x3f;
  if (local_64 == 0) {
    *(undefined1 *)(param_6 + 1) = 0x20;
  }
  else {
    *(undefined1 *)(param_6 + 1) = 0x2d;
  }
  if ((((param_3 & 0x7fff) == 0) && (param_2 == 0)) && (param_1 == 0)) {
    *param_6 = 0;
    *(byte *)(param_6 + 1) = ((local_64 != 0x8000) - 1U & 0xd) + 0x20;
    *(undefined1 *)((int)param_6 + 3) = 1;
    *(undefined1 *)(param_6 + 2) = 0x30;
    *(undefined1 *)((int)param_6 + 5) = 0;
    iVar1 = iVar20;
    goto LAB_00660be0;
  }
  if (uVar11 == 0x7fff) {
    *param_6 = 1;
    if (((param_2 == 0x80000000) && (param_1 == 0)) || ((param_2 & 0x40000000) != 0)) {
      if ((local_64 == 0) || (param_2 != 0xc0000000)) {
        if ((param_2 != 0x80000000) || (param_1 != 0)) goto LAB_0066043c;
        pcVar23 = "1#INF";
      }
      else {
        if (param_1 != 0) {
LAB_0066043c:
          pcVar23 = "1#QNAN";
          goto LAB_00660441;
        }
        pcVar23 = "1#IND";
      }
      eVar5 = _strcpy_s((char *)(param_6 + 2),0x16,pcVar23);
      if (eVar5 != 0) {
                    /* WARNING: Subroutine does not return */
        __invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
      }
      *(undefined1 *)((int)param_6 + 3) = 5;
    }
    else {
      pcVar23 = "1#SNAN";
LAB_00660441:
      eVar5 = _strcpy_s((char *)(param_6 + 2),0x16,pcVar23);
      if (eVar5 != 0) {
                    /* WARNING: Subroutine does not return */
        __invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
      }
      *(undefined1 *)((int)param_6 + 3) = 6;
    }
    uVar8 = CONCAT22(uStack_e._2_2_,(ushort)uStack_e);
    uVar16 = CONCAT22(uStack_20._2_2_,(undefined2)uStack_20);
    uVar6 = CONCAT22(local_24._2_2_,(ushort)local_24);
    iVar1 = CONCAT22(uStack_3e._2_2_,(undefined2)uStack_3e);
    goto LAB_00660be0;
  }
  local_50 = (short)((((param_3 & 0x7fff) >> 8) + (param_2 >> 0x18) * 2) * 0x4d + -0x134312f4 +
                     (param_3 & 0x7fff) * 0x4d10 >> 0x10);
  local_24._0_2_ = 0;
  uVar15 = -(int)local_50;
  local_1a = (undefined1)uVar11;
  bStack_19 = (byte)(uVar11 >> 8);
  uStack_20._2_2_ = uStack_12._2_2_;
  uVar16 = CONCAT22(uStack_12._2_2_,(ushort)uStack_12);
  uStack_1c = (ushort)uStack_e;
  local_24._2_2_ = (ushort)param_1;
  uVar6 = param_1 << 0x10;
  local_6c = &DAT_00d68388;
  if (uVar15 != 0) {
    iVar1 = iVar20;
    uVar10 = uStack_12;
    uVar21 = uVar8;
    uVar6 = param_1 << 0x10;
    uVar16 = CONCAT22(uStack_12._2_2_,(ushort)uStack_12);
    if ((int)uVar15 < 0) {
      local_6c = &DAT_00d684e8;
      uVar15 = (int)local_50;
    }
joined_r0x006604cf:
    if (uVar15 != 0) {
      local_6c = local_6c + 0x54;
      uVar8 = uVar15 & 7;
      uVar15 = (int)uVar15 >> 3;
      if (uVar8 != 0) {
        puVar9 = (ushort *)(local_6c + uVar8 * 0xc);
        if (0x7fff < *puVar9) {
          local_40 = (ushort)*(undefined4 *)puVar9;
          uStack_3e._0_2_ = (undefined2)((uint)*(undefined4 *)puVar9 >> 0x10);
          puVar2 = puVar9 + 4;
          uStack_3e._2_2_ = (undefined2)*(undefined4 *)(puVar9 + 2);
          uStack_3a = (ushort)((uint)*(undefined4 *)(puVar9 + 2) >> 0x10);
          puVar9 = &local_40;
          local_38 = *(int *)puVar2;
          iVar1 = CONCAT22(uStack_3e._2_2_,(undefined2)uStack_3e) + -1;
          uStack_3e._0_2_ = (undefined2)iVar1;
          uStack_3e._2_2_ = (undefined2)((uint)iVar1 >> 0x10);
        }
        local_4c = 0;
        local_14 = 0;
        uStack_13 = 0;
        uStack_12._0_2_ = 0;
        uStack_12._2_2_ = 0;
        uVar10 = 0;
        uStack_e._0_2_ = 0;
        uStack_e._2_2_ = 0;
        uVar21 = 0;
        uStack_a = 0;
        uVar12 = (puVar9[5] ^ CONCAT11(bStack_19,local_1a)) & 0x8000;
        uVar13 = CONCAT11(bStack_19,local_1a) & 0x7fff;
        uVar7 = puVar9[5] & 0x7fff;
        uVar11 = uVar7 + uVar13;
        if (((uVar13 < 0x7fff) && (uVar7 < 0x7fff)) && (uVar11 < 0xbffe)) {
          if (0x3fbf < uVar11) {
            if (((uVar13 == 0) &&
                (uVar11 = uVar11 + 1,
                (CONCAT13(bStack_19,CONCAT12(local_1a,uStack_1c)) & 0x7fffffff) == 0)) &&
               ((uVar16 == 0 && (uVar6 == 0)))) {
              local_1a = 0;
              bStack_19 = 0;
              goto joined_r0x006604cf;
            }
            if ((((uVar7 != 0) || (uVar11 = uVar11 + 1, (*(uint *)(puVar9 + 4) & 0x7fffffff) != 0))
                || (*(int *)(puVar9 + 2) != 0)) || (*(int *)puVar9 != 0)) {
              local_58 = 0;
              psVar19 = (short *)((int)&uStack_12 + 2);
              local_44 = 5;
              do {
                local_54 = local_44;
                if (0 < local_44) {
                  local_74 = (ushort *)((int)&local_24 + local_58 * 2);
                  local_70 = puVar9 + 4;
                  do {
                    bVar4 = false;
                    uVar10 = *(uint *)(psVar19 + -2) + (uint)*local_74 * (uint)*local_70;
                    if ((uVar10 < *(uint *)(psVar19 + -2)) ||
                       (uVar10 < (uint)*local_74 * (uint)*local_70)) {
                      bVar4 = true;
                    }
                    *(uint *)(psVar19 + -2) = uVar10;
                    if (bVar4) {
                      *psVar19 = *psVar19 + 1;
                    }
                    local_74 = local_74 + 1;
                    local_70 = local_70 + -1;
                    local_54 = local_54 + -1;
                  } while (0 < local_54);
                }
                psVar19 = psVar19 + 1;
                local_58 = local_58 + 1;
                local_44 = local_44 + -1;
              } while (0 < local_44);
              uVar11 = uVar11 + 0xc002;
              if ((short)uVar11 < 1) {
LAB_00660683:
                uVar11 = uVar11 - 1;
                if ((short)uVar11 < 0) {
                  uVar10 = (uint)(ushort)-uVar11;
                  uVar11 = 0;
                  do {
                    if ((local_14 & 1) != 0) {
                      local_4c = local_4c + 1;
                    }
                    iVar3 = CONCAT22(uStack_a,uStack_e._2_2_);
                    uVar6 = CONCAT22((ushort)uStack_e,uStack_12._2_2_);
                    iVar20 = CONCAT22((ushort)uStack_e,uStack_12._2_2_);
                    uStack_e._2_2_ = (ushort)(CONCAT22(uStack_a,uStack_e._2_2_) >> 1);
                    uStack_a = uStack_a >> 1;
                    uStack_e._0_2_ = (ushort)uStack_e >> 1 | (ushort)((uint)(iVar3 << 0x1f) >> 0x10)
                    ;
                    uVar21 = CONCAT22((ushort)uStack_12,CONCAT11(uStack_13,local_14)) >> 1;
                    uStack_12._0_2_ =
                         (ushort)uStack_12 >> 1 | (ushort)((uint)(iVar20 << 0x1f) >> 0x10);
                    uVar10 = uVar10 - 1;
                    uStack_12._2_2_ = (ushort)(uVar6 >> 1);
                    local_14 = (byte)uVar21;
                    uStack_13 = (undefined1)(uVar21 >> 8);
                  } while (uVar10 != 0);
                  if (local_4c != 0) {
                    local_14 = local_14 | 1;
                  }
                }
              }
              else {
                do {
                  uVar13 = (ushort)uStack_e;
                  uVar7 = (ushort)uStack_12;
                  if ((uStack_a & 0x8000) != 0) break;
                  iVar20 = CONCAT22((ushort)uStack_12,CONCAT11(uStack_13,local_14)) << 1;
                  local_14 = (byte)iVar20;
                  uStack_13 = (undefined1)((uint)iVar20 >> 8);
                  uStack_12._0_2_ = (ushort)((uint)iVar20 >> 0x10);
                  iVar20 = CONCAT22((ushort)uStack_e,uStack_12._2_2_) * 2;
                  uStack_12._2_2_ = (ushort)iVar20 | uVar7 >> 0xf;
                  uStack_e._0_2_ = (ushort)((uint)iVar20 >> 0x10);
                  iVar20 = CONCAT22(uStack_a,uStack_e._2_2_) * 2;
                  uStack_e._2_2_ = (ushort)iVar20 | uVar13 >> 0xf;
                  uVar11 = uVar11 - 1;
                  uStack_a = (ushort)((uint)iVar20 >> 0x10);
                } while (0 < (short)uVar11);
                if ((short)uVar11 < 1) goto LAB_00660683;
              }
              if ((0x8000 < CONCAT11(uStack_13,local_14)) ||
                 (uVar21 = CONCAT22(uStack_e._2_2_,(ushort)uStack_e),
                 uVar10 = CONCAT22(uStack_12._2_2_,(ushort)uStack_12),
                 (CONCAT22((ushort)uStack_12,CONCAT11(uStack_13,local_14)) & 0x1ffff) == 0x18000)) {
                if (CONCAT22(uStack_12._2_2_,(ushort)uStack_12) == -1) {
                  uVar10 = 0;
                  if (CONCAT22(uStack_e._2_2_,(ushort)uStack_e) == -1) {
                    if (uStack_a == 0xffff) {
                      uStack_a = 0x8000;
                      uVar11 = uVar11 + 1;
                      uVar21 = 0;
                      uVar10 = 0;
                    }
                    else {
                      uStack_a = uStack_a + 1;
                      uVar21 = 0;
                      uVar10 = 0;
                    }
                  }
                  else {
                    uVar21 = CONCAT22(uStack_e._2_2_,(ushort)uStack_e) + 1;
                  }
                }
                else {
                  uVar10 = CONCAT22(uStack_12._2_2_,(ushort)uStack_12) + 1;
                  uVar21 = CONCAT22(uStack_e._2_2_,(ushort)uStack_e);
                }
              }
              if (uVar11 < 0x7fff) {
                bStack_19 = (byte)(uVar11 >> 8) | (byte)(uVar12 >> 8);
                local_24 = uVar10;
                uStack_20 = uVar21;
                uStack_1c = uStack_a;
                local_1a = (undefined1)uVar11;
                uVar6 = uVar10;
                uVar16 = uVar21;
              }
              else {
                uStack_20._0_2_ = 0;
                uStack_20._2_2_ = 0;
                local_24._0_2_ = 0;
                local_24._2_2_ = 0;
                iVar20 = ((uVar12 == 0) - 1 & 0x80000000) + 0x7fff8000;
                uStack_1c = (ushort)iVar20;
                local_1a = (undefined1)((uint)iVar20 >> 0x10);
                bStack_19 = (byte)((uint)iVar20 >> 0x18);
                uVar6 = 0;
                uVar16 = 0;
              }
              goto joined_r0x006604cf;
            }
          }
          uStack_1c = 0;
          local_1a = 0;
          bStack_19 = 0;
        }
        else {
          iVar20 = ((uVar12 == 0) - 1 & 0x80000000) + 0x7fff8000;
          uStack_1c = (ushort)iVar20;
          local_1a = (undefined1)((uint)iVar20 >> 0x10);
          bStack_19 = (byte)((uint)iVar20 >> 0x18);
        }
        uStack_20._0_2_ = 0;
        uStack_20._2_2_ = 0;
        local_24._0_2_ = 0;
        local_24._2_2_ = 0;
        uVar10 = 0;
        uVar21 = 0;
        uVar6 = 0;
        uVar16 = 0;
      }
      goto joined_r0x006604cf;
    }
  }
  uVar15 = CONCAT13(bStack_19,CONCAT12(local_1a,uStack_1c));
  uStack_12 = uVar10;
  uVar8 = uVar21;
  if (0x3ffe < (ushort)(uVar15 >> 0x10)) {
    local_50 = local_50 + 1;
    local_54 = 0;
    local_14 = 0;
    uStack_13 = 0;
    uStack_12._0_2_ = 0;
    uStack_12._2_2_ = 0;
    uStack_12 = 0;
    uStack_e._0_2_ = 0;
    uStack_e._2_2_ = 0;
    uVar8 = 0;
    uStack_a = 0;
    uVar10 = uVar15 >> 0x10 & 0x7fff;
    iVar20 = uVar10 + 0x3ffb;
    if (((ushort)uVar10 < 0x7fff) && ((ushort)iVar20 < 0xbffe)) {
      if (0x3fbf < (ushort)iVar20) {
        if (((((ushort)uVar10 == 0) &&
             (iVar20 = uVar10 + 0x3ffc,
             (CONCAT13(bStack_19,CONCAT12(local_1a,uStack_1c)) & 0x7fffffff) == 0)) && (uVar16 == 0)
            ) && (uVar6 == 0)) {
          local_1a = 0;
          bStack_19 = 0;
          goto LAB_00660a18;
        }
        local_58 = 0;
        psVar19 = (short *)((int)&uStack_12 + 2);
        local_44 = 5;
        do {
          local_4c = local_44;
          if (0 < local_44) {
            local_5c = &local_2c;
            puVar9 = (ushort *)((int)&local_24 + local_58 * 2);
            do {
              bVar4 = false;
              uVar10 = *(uint *)(psVar19 + -2) + (uint)*local_5c * (uint)*puVar9;
              if ((uVar10 < *(uint *)(psVar19 + -2)) || (uVar10 < (uint)*local_5c * (uint)*puVar9))
              {
                bVar4 = true;
              }
              *(uint *)(psVar19 + -2) = uVar10;
              if (bVar4) {
                *psVar19 = *psVar19 + 1;
              }
              local_5c = local_5c + -1;
              puVar9 = puVar9 + 1;
              local_4c = local_4c + -1;
            } while (0 < local_4c);
          }
          psVar19 = psVar19 + 1;
          local_58 = local_58 + 1;
          local_44 = local_44 + -1;
        } while (0 < local_44);
        iVar20 = iVar20 + 0xc002;
        if ((short)iVar20 < 1) {
LAB_00660911:
          uVar11 = (ushort)(iVar20 + 0xffff);
          if ((short)uVar11 < 0) {
            uVar10 = -(iVar20 + 0xffff);
            uVar6 = uVar10 & 0xffff;
            uVar11 = uVar11 + (short)uVar10;
            do {
              if ((local_14 & 1) != 0) {
                local_54 = local_54 + 1;
              }
              iVar3 = CONCAT22(uStack_a,uStack_e._2_2_);
              uVar10 = CONCAT22((ushort)uStack_e,uStack_12._2_2_);
              iVar20 = CONCAT22((ushort)uStack_e,uStack_12._2_2_);
              uStack_e._2_2_ = (ushort)(CONCAT22(uStack_a,uStack_e._2_2_) >> 1);
              uStack_a = uStack_a >> 1;
              uStack_e._0_2_ = (ushort)uStack_e >> 1 | (ushort)((uint)(iVar3 << 0x1f) >> 0x10);
              uVar21 = CONCAT22((ushort)uStack_12,CONCAT11(uStack_13,local_14)) >> 1;
              uStack_12._0_2_ = (ushort)uStack_12 >> 1 | (ushort)((uint)(iVar20 << 0x1f) >> 0x10);
              uVar6 = uVar6 - 1;
              uStack_12._2_2_ = (ushort)(uVar10 >> 1);
              local_14 = (byte)uVar21;
              uStack_13 = (undefined1)(uVar21 >> 8);
            } while (uVar6 != 0);
            if (local_54 != 0) {
              local_14 = local_14 | 1;
            }
          }
        }
        else {
          do {
            uVar7 = (ushort)uStack_e;
            uVar11 = (ushort)uStack_12;
            if ((short)uStack_a < 0) break;
            iVar3 = CONCAT22((ushort)uStack_12,CONCAT11(uStack_13,local_14)) << 1;
            local_14 = (byte)iVar3;
            uStack_13 = (undefined1)((uint)iVar3 >> 8);
            uStack_12._0_2_ = (ushort)((uint)iVar3 >> 0x10);
            iVar3 = CONCAT22((ushort)uStack_e,uStack_12._2_2_) * 2;
            uStack_12._2_2_ = (ushort)iVar3 | uVar11 >> 0xf;
            uStack_e._0_2_ = (ushort)((uint)iVar3 >> 0x10);
            iVar3 = CONCAT22(uStack_a,uStack_e._2_2_) * 2;
            uStack_e._2_2_ = (ushort)iVar3 | uVar7 >> 0xf;
            iVar20 = iVar20 + 0xffff;
            uStack_a = (ushort)((uint)iVar3 >> 0x10);
          } while (0 < (short)iVar20);
          uVar11 = (ushort)iVar20;
          if ((short)uVar11 < 1) goto LAB_00660911;
        }
        if ((0x8000 < CONCAT11(uStack_13,local_14)) ||
           (uVar8 = CONCAT22(uStack_e._2_2_,(ushort)uStack_e),
           uStack_12 = CONCAT22(uStack_12._2_2_,(ushort)uStack_12),
           (CONCAT22((ushort)uStack_12,CONCAT11(uStack_13,local_14)) & 0x1ffff) == 0x18000)) {
          if (CONCAT22(uStack_12._2_2_,(ushort)uStack_12) == -1) {
            uStack_12 = 0;
            if (CONCAT22(uStack_e._2_2_,(ushort)uStack_e) == -1) {
              if (uStack_a == 0xffff) {
                uStack_a = 0x8000;
                uVar11 = uVar11 + 1;
                uVar8 = 0;
                uStack_12 = 0;
              }
              else {
                uStack_a = uStack_a + 1;
                uVar8 = 0;
                uStack_12 = 0;
              }
            }
            else {
              uVar8 = CONCAT22(uStack_e._2_2_,(ushort)uStack_e) + 1;
            }
          }
          else {
            uStack_12 = CONCAT22(uStack_12._2_2_,(ushort)uStack_12) + 1;
            uVar8 = CONCAT22(uStack_e._2_2_,(ushort)uStack_e);
          }
        }
        if (uVar11 < 0x7fff) {
          bStack_19 = (byte)(uVar11 >> 8) | bStack_19 & 0x80;
          uStack_1c = uStack_a;
          local_1a = (undefined1)uVar11;
          uVar6 = uStack_12;
          uVar16 = uVar8;
        }
        else {
          iVar20 = (((bStack_19 & 0x80) == 0) - 1 & 0x80000000) + 0x7fff8000;
          uStack_1c = (ushort)iVar20;
          local_1a = (undefined1)((uint)iVar20 >> 0x10);
          bStack_19 = (byte)((uint)iVar20 >> 0x18);
          uVar6 = 0;
          uVar16 = 0;
        }
        goto LAB_00660a18;
      }
      iVar20 = 0;
    }
    else {
      iVar20 = (((bStack_19 & 0x80) == 0) - 1 & 0x80000000) + 0x7fff8000;
    }
    uStack_1c = (ushort)iVar20;
    local_1a = (undefined1)((uint)iVar20 >> 0x10);
    bStack_19 = (byte)((uint)iVar20 >> 0x18);
    uStack_12 = 0;
    uVar8 = 0;
    uVar6 = 0;
    uVar16 = 0;
  }
LAB_00660a18:
  *param_6 = local_50;
  if (((param_5 & 1) == 0) || (param_4 = param_4 + local_50, 0 < param_4)) {
    if (0x15 < param_4) {
      param_4 = 0x15;
    }
    iVar20 = (CONCAT13(bStack_19,CONCAT12(local_1a,uStack_1c)) >> 0x10) - 0x3ffe;
    local_1a = 0;
    bStack_19 = 0;
    local_48 = 8;
    uVar10 = uVar6;
    uVar21 = uVar16;
    do {
      uVar6 = uVar10 << 1;
      uVar16 = uVar21 * 2 | uVar10 >> 0x1f;
      iVar3 = CONCAT13(bStack_19,CONCAT12(local_1a,uStack_1c)) * 2;
      uStack_1c = (ushort)iVar3 | (ushort)(uVar21 >> 0x1f);
      local_48 = local_48 + -1;
      uStack_20._0_2_ = (undefined2)uVar16;
      uStack_20._2_2_ = (ushort)(uVar21 * 2 >> 0x10);
      local_1a = (undefined1)((uint)iVar3 >> 0x10);
      bStack_19 = (byte)((uint)iVar3 >> 0x18);
      uVar10 = uVar6;
      uVar21 = uVar16;
    } while (local_48 != 0);
    if ((iVar20 < 0) && (uVar21 = -iVar20 & 0xff, uVar21 != 0)) {
      do {
        iVar20 = CONCAT13(bStack_19,CONCAT12(local_1a,uStack_1c));
        uVar6 = CONCAT13(bStack_19,CONCAT12(local_1a,uStack_1c)) >> 1;
        uStack_1c = (ushort)uVar6;
        local_1a = (undefined1)(uVar6 >> 0x10);
        bStack_19 = bStack_19 >> 1;
        uVar15 = CONCAT22(uStack_20._2_2_,(undefined2)uStack_20) >> 1;
        uVar16 = uVar15 | iVar20 << 0x1f;
        uVar6 = uVar10 >> 1 | CONCAT22(uStack_20._2_2_,(undefined2)uStack_20) << 0x1f;
        uVar21 = uVar21 - 1;
        uStack_20._0_2_ = (undefined2)uVar15;
        uStack_20._2_2_ = (ushort)(uVar16 >> 0x10);
        local_24._0_2_ = (ushort)(uVar10 >> 1);
        local_24._2_2_ = (ushort)(uVar6 >> 0x10);
        uVar10 = CONCAT22(local_24._2_2_,(ushort)local_24);
      } while (0 < (int)uVar21);
    }
    psVar19 = param_6 + 2;
    psVar17 = psVar19;
    for (param_4 = param_4 + 1; 0 < param_4; param_4 = param_4 + -1) {
      uStack_20._2_2_ = (ushort)(uVar16 >> 0x10);
      uStack_20._0_2_ = (undefined2)uVar16;
      local_24._2_2_ = (ushort)(uVar6 >> 0x10);
      local_24._0_2_ = (ushort)uVar6;
      iVar1 = CONCAT22((undefined2)uStack_20,local_24._2_2_);
      local_38 = CONCAT13(bStack_19,CONCAT12(local_1a,uStack_1c));
      uVar21 = (CONCAT13(bStack_19,CONCAT12(local_1a,uStack_1c)) * 2 |
               (uint)(uStack_20._2_2_ >> 0xf)) * 2 | uVar16 * 2 >> 0x1f;
      uVar15 = (uVar16 * 2 | (uint)(local_24._2_2_ >> 0xf)) * 2 | (uVar6 << 1) >> 0x1f;
      uVar10 = uVar6 * 5;
      if ((uVar10 < uVar6 * 4) || (uVar22 = uVar15, uVar10 < uVar6)) {
        uVar22 = uVar15 + 1;
        bVar4 = false;
        if ((uVar22 < uVar15) || (uVar22 == 0)) {
          bVar4 = true;
        }
        if (bVar4) {
          uVar21 = uVar21 + 1;
        }
      }
      uVar15 = uVar16 + uVar22;
      if ((uVar15 < uVar22) || (uVar15 < uVar16)) {
        uVar21 = uVar21 + 1;
      }
      iVar20 = (uVar21 + local_38) * 2;
      uStack_1c = (ushort)iVar20 | (ushort)(uVar15 >> 0x1f);
      uVar6 = uVar6 * 10;
      local_1a = (undefined1)((uint)iVar20 >> 0x10);
      uVar16 = uVar15 * 2 | uVar10 >> 0x1f;
      *(char *)psVar17 = (char)((uint)iVar20 >> 0x18) + '0';
      psVar17 = (short *)((int)psVar17 + 1);
      bStack_19 = 0;
      local_40 = (ushort)local_24;
      uStack_3a = uStack_20._2_2_;
    }
    psVar18 = psVar17 + -1;
    if (*(char *)((int)psVar17 + -1) < '5') {
      for (; (psVar19 <= psVar18 && ((char)*psVar18 == '0')); psVar18 = (short *)((int)psVar18 + -1)
          ) {
      }
      if (psVar18 < psVar19) {
        *param_6 = 0;
        *(undefined1 *)((int)param_6 + 3) = 1;
        *(byte *)(param_6 + 1) = ((local_64 != 0x8000) - 1U & 0xd) + 0x20;
        *(char *)psVar19 = '0';
        *(undefined1 *)((int)param_6 + 5) = 0;
        goto LAB_00660be0;
      }
    }
    else {
      for (; (psVar19 <= psVar18 && ((char)*psVar18 == '9')); psVar18 = (short *)((int)psVar18 + -1)
          ) {
        *(char *)psVar18 = '0';
      }
      if (psVar18 < psVar19) {
        psVar18 = (short *)((int)psVar18 + 1);
        *param_6 = *param_6 + 1;
      }
      *(char *)psVar18 = (char)*psVar18 + '\x01';
    }
    cVar14 = ((char)psVar18 - (char)param_6) + -3;
    *(char *)((int)param_6 + 3) = cVar14;
    *(undefined1 *)(cVar14 + 4 + (int)param_6) = 0;
  }
  else {
    *param_6 = 0;
    *(undefined1 *)((int)param_6 + 3) = 1;
    *(byte *)(param_6 + 1) = ((local_64 != 0x8000) - 1U & 0xd) + 0x20;
    *(undefined1 *)(param_6 + 2) = 0x30;
    *(undefined1 *)((int)param_6 + 5) = 0;
  }
LAB_00660be0:
  uStack_3e = iVar1;
  local_24 = uVar6;
  uStack_20 = uVar16;
  uStack_e = uVar8;
  __security_check_cookie(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00660305 : MOV EDI,EDI
00660307 : PUSH EBP
00660308 : MOV EBP,ESP
0066030a : SUB ESP,0x74
0066030d : MOV EAX,[0x00d66fa0]
00660312 : XOR EAX,EBP
00660314 : MOV dword ptr [EBP + -0x4],EAX
00660317 : PUSH EBX
00660318 : MOV EBX,dword ptr [EBP + 0x1c]
0066031b : PUSH ESI
0066031c : PUSH EDI
0066031d : LEA ESI,[EBP + 0x8]
00660320 : LEA EDI,[EBP + -0x10]
00660323 : MOVSD ES:EDI,ESI
00660324 : MOVSD ES:EDI,ESI
00660325 : MOVSW ES:EDI,ESI
00660327 : MOV EAX,dword ptr [EBP + -0x8]
0066032a : MOV EDX,dword ptr [EBP + -0x8]
0066032d : MOV ECX,0x8000
00660332 : AND EAX,ECX
00660334 : MOV dword ptr [EBP + -0x60],EAX
00660337 : LEA EAX,[ECX + -0x1]
0066033a : AND EDX,EAX
0066033c : CMP word ptr [EBP + -0x60],0x0
00660341 : MOV dword ptr [EBP + -0x64],EBX
00660344 : MOV byte ptr [EBP + -0x30],0xcc
00660348 : MOV byte ptr [EBP + -0x2f],0xcc
0066034c : MOV byte ptr [EBP + -0x2e],0xcc
00660350 : MOV byte ptr [EBP + -0x2d],0xcc
00660354 : MOV byte ptr [EBP + -0x2c],0xcc
00660358 : MOV byte ptr [EBP + -0x2b],0xcc
0066035c : MOV byte ptr [EBP + -0x2a],0xcc
00660360 : MOV byte ptr [EBP + -0x29],0xcc
00660364 : MOV byte ptr [EBP + -0x28],0xcc
00660368 : MOV byte ptr [EBP + -0x27],0xcc
0066036c : MOV byte ptr [EBP + -0x26],0xfb
00660370 : MOV byte ptr [EBP + -0x25],0x3f
00660374 : MOV dword ptr [EBP + -0x74],0x1
0066037b : JZ 0x00660383
0066037d : MOV byte ptr [EBX + 0x2],0x2d
00660381 : JMP 0x00660387
00660383 : MOV byte ptr [EBX + 0x2],0x20
00660387 : MOV ESI,dword ptr [EBP + -0xc]
0066038a : MOV EDI,dword ptr [EBP + -0x10]
0066038d : TEST DX,DX
00660390 : JNZ 0x006603c3
00660392 : TEST ESI,ESI
00660394 : JNZ 0x006603c3
00660396 : TEST EDI,EDI
00660398 : JNZ 0x006603c3
0066039a : XOR EAX,EAX
0066039c : CMP word ptr [EBP + -0x60],CX
006603a0 : MOV word ptr [EBX],AX
006603a3 : SETNZ AL
006603a6 : DEC AL
006603a8 : AND AL,0xd
006603aa : ADD AL,0x20
006603ac : MOV byte ptr [EBX + 0x2],AL
006603af : MOV byte ptr [EBX + 0x3],0x1
006603b3 : MOV byte ptr [EBX + 0x4],0x30
006603b7 : MOV byte ptr [EBX + 0x5],0x0
006603bb : XOR EAX,EAX
006603bd : INC EAX
006603be : JMP 0x00660be0
006603c3 : CMP DX,AX
006603c6 : JNZ 0x0066046d
006603cc : XOR EAX,EAX
006603ce : INC EAX
006603cf : MOV word ptr [EBX],AX
006603d2 : MOV EAX,0x80000000
006603d7 : CMP ESI,EAX
006603d9 : JNZ 0x006603df
006603db : TEST EDI,EDI
006603dd : JZ 0x006603ee
006603df : TEST ESI,0x40000000
006603e5 : JNZ 0x006603ee
006603e7 : PUSH 0xba8ef0
006603ec : JMP 0x00660441
006603ee : CMP word ptr [EBP + -0x60],0x0
006603f3 : JZ 0x00660408
006603f5 : CMP ESI,0xc0000000
006603fb : JNZ 0x00660408
006603fd : TEST EDI,EDI
006603ff : JNZ 0x0066043c
00660401 : PUSH 0xba8ee8
00660406 : JMP 0x00660415
00660408 : CMP ESI,EAX
0066040a : JNZ 0x0066043c
0066040c : TEST EDI,EDI
0066040e : JNZ 0x0066043c
00660410 : PUSH 0xba8ee0
00660415 : LEA EAX,[EBX + 0x4]
00660418 : PUSH 0x16
0066041a : PUSH EAX
0066041b : CALL 0x00638300
00660420 : ADD ESP,0xc
00660423 : XOR ESI,ESI
00660425 : TEST EAX,EAX
00660427 : JZ 0x00660436
00660429 : PUSH ESI
0066042a : PUSH ESI
0066042b : PUSH ESI
0066042c : PUSH ESI
0066042d : PUSH ESI
0066042e : CALL 0x00637169
00660436 : MOV byte ptr [EBX + 0x3],0x5
0066043a : JMP 0x00660466
0066043c : PUSH 0xba8ed8
00660441 : LEA EAX,[EBX + 0x4]
00660444 : PUSH 0x16
00660446 : PUSH EAX
00660447 : CALL 0x00638300
0066044c : ADD ESP,0xc
0066044f : XOR ESI,ESI
00660451 : TEST EAX,EAX
00660453 : JZ 0x00660462
00660455 : PUSH ESI
00660456 : PUSH ESI
00660457 : PUSH ESI
00660458 : PUSH ESI
00660459 : PUSH ESI
0066045a : CALL 0x00637169
00660462 : MOV byte ptr [EBX + 0x3],0x6
00660466 : XOR EAX,EAX
00660468 : JMP 0x00660be0
0066046d : MOVZX ECX,DX
00660470 : MOV EBX,ECX
00660472 : IMUL ECX,ECX,0x4d10
00660478 : SHR EBX,0x8
0066047b : MOV EAX,ESI
0066047d : SHR EAX,0x18
00660480 : LEA EAX,[EBX + EAX*0x2]
00660483 : IMUL EAX,EAX,0x4d
00660486 : LEA EAX,[EAX + ECX*0x1 + 0xecbced0c]
0066048d : SAR EAX,0x10
00660490 : MOVZX EAX,AX
00660493 : XOR ECX,ECX
00660495 : MOVSX EBX,AX
00660498 : MOV word ptr [EBP + -0x20],CX
0066049c : MOV ECX,0xd683e8
006604a1 : NEG EBX
006604a3 : SUB ECX,0x60
006604a6 : MOV dword ptr [EBP + -0x4c],EAX
006604a9 : MOV word ptr [EBP + -0x16],DX
006604ad : MOV dword ptr [EBP + -0x1a],ESI
006604b0 : MOV dword ptr [EBP + -0x1e],EDI
006604b3 : MOV dword ptr [EBP + -0x68],ECX
006604b6 : TEST EBX,EBX
006604b8 : JZ 0x0066075b
006604be : JGE 0x006604cd
006604c0 : MOV EAX,0xd68548
006604c5 : NEG EBX
006604c7 : SUB EAX,0x60
006604ca : MOV dword ptr [EBP + -0x68],EAX
006604cd : TEST EBX,EBX
006604cf : JZ 0x0066075b
006604d5 : ADD dword ptr [EBP + -0x68],0x54
006604d9 : MOV ECX,EBX
006604db : AND ECX,0x7
006604de : SAR EBX,0x3
006604e1 : TEST ECX,ECX
006604e3 : JZ 0x00660751
006604e9 : IMUL ECX,ECX,0xc
006604ec : ADD ECX,dword ptr [EBP + -0x68]
006604ef : MOV EAX,ECX
006604f1 : MOV dword ptr [EBP + -0x44],ECX
006604f4 : MOV ECX,0x8000
006604f9 : CMP word ptr [EAX],CX
006604fc : JC 0x0066050f
006604fe : MOV ESI,EAX
00660500 : LEA EDI,[EBP + -0x3c]
00660503 : MOVSD ES:EDI,ESI
00660504 : MOVSD ES:EDI,ESI
00660505 : LEA EAX,[EBP + -0x3c]
00660508 : MOVSD ES:EDI,ESI
00660509 : DEC dword ptr [EBP + -0x3a]
0066050c : MOV dword ptr [EBP + -0x44],EAX
0066050f : XOR ECX,ECX
00660511 : MOV dword ptr [EBP + -0x48],ECX
00660514 : MOV dword ptr [EBP + -0x10],ECX
00660517 : MOV dword ptr [EBP + -0xc],ECX
0066051a : MOV dword ptr [EBP + -0x8],ECX
0066051d : MOVZX ECX,word ptr [EAX + 0xa]
00660521 : MOV EDX,ECX
00660523 : XOR EDX,dword ptr [EBP + -0x16]
00660526 : MOV ESI,0x7fff
0066052b : AND EDX,0x8000
00660531 : MOV dword ptr [EBP + -0x58],EDX
00660534 : MOV EDX,dword ptr [EBP + -0x16]
00660537 : AND EDX,ESI
00660539 : AND ECX,ESI
0066053b : LEA ESI,[ECX + EDX*0x1]
0066053e : MOVZX EDI,SI
00660541 : MOV ESI,0x7fff
00660546 : CMP DX,SI
00660549 : JNC 0x006607fc
0066054f : CMP CX,SI
00660552 : JNC 0x006607fc
00660558 : MOV ESI,0xbffd
0066055d : CMP DI,SI
00660560 : JA 0x006607fc
00660566 : MOV ESI,0x3fbf
0066056b : CMP DI,SI
0066056e : JA 0x00660580
00660570 : XOR ESI,ESI
00660572 : MOV dword ptr [EBP + -0x18],ESI
00660575 : MOV dword ptr [EBP + -0x1c],ESI
00660578 : MOV dword ptr [EBP + -0x20],ESI
0066057b : JMP 0x00660753
00660580 : XOR ESI,ESI
00660582 : CMP DX,SI
00660585 : JNZ 0x006605a6
00660587 : INC EDI
00660588 : TEST dword ptr [EBP + -0x18],0x7fffffff
0066058f : JNZ 0x006605a6
00660591 : CMP dword ptr [EBP + -0x1c],ESI
00660594 : JNZ 0x006605a6
00660596 : CMP dword ptr [EBP + -0x20],ESI
00660599 : JNZ 0x006605a6
0066059b : XOR EAX,EAX
0066059d : MOV word ptr [EBP + -0x16],AX
006605a1 : JMP 0x00660753
006605a6 : CMP CX,SI
006605a9 : JNZ 0x006605be
006605ab : INC EDI
006605ac : TEST dword ptr [EAX + 0x8],0x7fffffff
006605b3 : JNZ 0x006605be
006605b5 : CMP dword ptr [EAX + 0x4],ESI
006605b8 : JNZ 0x006605be
006605ba : CMP dword ptr [EAX],ESI
006605bc : JZ 0x00660572
006605be : AND dword ptr [EBP + -0x54],ESI
006605c1 : LEA ESI,[EBP + -0xc]
006605c4 : MOV dword ptr [EBP + -0x40],0x5
006605cb : MOV ECX,dword ptr [EBP + -0x54]
006605ce : MOV EDX,dword ptr [EBP + -0x40]
006605d1 : ADD ECX,ECX
006605d3 : MOV dword ptr [EBP + -0x50],EDX
006605d6 : TEST EDX,EDX
006605d8 : JLE 0x0066062f
006605da : LEA ECX,[EBP + ECX*0x1 + -0x20]
006605de : ADD EAX,0x8
006605e1 : MOV dword ptr [EBP + -0x70],ECX
006605e4 : MOV dword ptr [EBP + -0x6c],EAX
006605e7 : MOV EAX,dword ptr [EBP + -0x70]
006605ea : MOVZX ECX,word ptr [EAX]
006605ed : MOV EAX,dword ptr [EBP + -0x6c]
006605f0 : MOVZX EAX,word ptr [EAX]
006605f3 : MOV EDX,dword ptr [ESI + -0x4]
006605f6 : IMUL ECX,EAX
006605f9 : AND dword ptr [EBP + -0x5c],0x0
006605fd : LEA EAX,[EDX + ECX*0x1]
00660600 : CMP EAX,EDX
00660602 : JC 0x00660608
00660604 : CMP EAX,ECX
00660606 : JNC 0x0066060f
00660608 : MOV dword ptr [EBP + -0x5c],0x1
0066060f : CMP dword ptr [EBP + -0x5c],0x0
00660613 : MOV dword ptr [ESI + -0x4],EAX
00660616 : JZ 0x0066061b
00660618 : INC word ptr [ESI]
0066061b : ADD dword ptr [EBP + -0x70],0x2
0066061f : SUB dword ptr [EBP + -0x6c],0x2
00660623 : DEC dword ptr [EBP + -0x50]
00660626 : CMP dword ptr [EBP + -0x50],0x0
0066062a : JG 0x006605e7
0066062c : MOV EAX,dword ptr [EBP + -0x44]
0066062f : INC ESI
00660630 : INC ESI
00660631 : INC dword ptr [EBP + -0x54]
00660634 : DEC dword ptr [EBP + -0x40]
00660637 : CMP dword ptr [EBP + -0x40],0x0
0066063b : JG 0x006605cb
0066063d : ADD EDI,0xc002
00660643 : TEST DI,DI
00660646 : JLE 0x00660683
00660648 : TEST dword ptr [EBP + -0x8],0x80000000
0066064f : JNZ 0x0066067e
00660651 : MOV EAX,dword ptr [EBP + -0xc]
00660654 : MOV ECX,dword ptr [EBP + -0x10]
00660657 : SHL dword ptr [EBP + -0x10],0x1
0066065a : MOV EDX,EAX
0066065c : ADD EAX,EAX
0066065e : SHR ECX,0x1f
00660661 : OR EAX,ECX
00660663 : MOV dword ptr [EBP + -0xc],EAX
00660666 : MOV EAX,dword ptr [EBP + -0x8]
00660669 : SHR EDX,0x1f
0066066c : ADD EAX,EAX
0066066e : OR EAX,EDX
00660670 : ADD EDI,0xffff
00660676 : MOV dword ptr [EBP + -0x8],EAX
00660679 : TEST DI,DI
0066067c : JG 0x00660648
0066067e : TEST DI,DI
00660681 : JG 0x006606d0
00660683 : ADD EDI,0xffff
00660689 : TEST DI,DI
0066068c : JGE 0x006606d0
0066068e : MOV EAX,EDI
00660690 : NEG EAX
00660692 : MOVZX EAX,AX
00660695 : ADD EDI,EAX
00660697 : TEST byte ptr [EBP + -0x10],0x1
0066069b : JZ 0x006606a0
0066069d : INC dword ptr [EBP + -0x48]
006606a0 : MOV ECX,dword ptr [EBP + -0x8]
006606a3 : MOV ESI,dword ptr [EBP + -0xc]
006606a6 : MOV EDX,dword ptr [EBP + -0xc]
006606a9 : SHR dword ptr [EBP + -0x8],0x1
006606ac : SHL ECX,0x1f
006606af : SHR ESI,0x1
006606b1 : OR ESI,ECX
006606b3 : MOV ECX,dword ptr [EBP + -0x10]
006606b6 : SHL EDX,0x1f
006606b9 : SHR ECX,0x1
006606bb : OR ECX,EDX
006606bd : DEC EAX
006606be : MOV dword ptr [EBP + -0xc],ESI
006606c1 : MOV dword ptr [EBP + -0x10],ECX
006606c4 : JNZ 0x00660697
006606c6 : CMP dword ptr [EBP + -0x48],EAX
006606c9 : JZ 0x006606d0
006606cb : OR word ptr [EBP + -0x10],0x1
006606d0 : MOV EAX,0x8000
006606d5 : MOV ECX,EAX
006606d7 : CMP word ptr [EBP + -0x10],CX
006606db : JA 0x006606ee
006606dd : MOV ECX,dword ptr [EBP + -0x10]
006606e0 : AND ECX,0x1ffff
006606e6 : CMP ECX,0x18000
006606ec : JNZ 0x00660722
006606ee : CMP dword ptr [EBP + -0xe],-0x1
006606f2 : JNZ 0x0066071f
006606f4 : AND dword ptr [EBP + -0xe],0x0
006606f8 : CMP dword ptr [EBP + -0xa],-0x1
006606fc : JNZ 0x0066071a
006606fe : AND dword ptr [EBP + -0xa],0x0
00660702 : MOV ECX,0xffff
00660707 : CMP word ptr [EBP + -0x6],CX
0066070b : JNZ 0x00660714
0066070d : MOV word ptr [EBP + -0x6],AX
00660711 : INC EDI
00660712 : JMP 0x00660722
00660714 : INC word ptr [EBP + -0x6]
00660718 : JMP 0x00660722
0066071a : INC dword ptr [EBP + -0xa]
0066071d : JMP 0x00660722
0066071f : INC dword ptr [EBP + -0xe]
00660722 : MOV EAX,0x7fff
00660727 : CMP DI,AX
0066072a : JC 0x006607dc
00660730 : XOR EAX,EAX
00660732 : XOR ECX,ECX
00660734 : CMP word ptr [EBP + -0x58],AX
00660738 : MOV dword ptr [EBP + -0x1c],EAX
0066073b : SETZ CL
0066073e : MOV dword ptr [EBP + -0x20],EAX
00660741 : DEC ECX
00660742 : AND ECX,0x80000000
00660748 : ADD ECX,0x7fff8000
0066074e : MOV dword ptr [EBP + -0x18],ECX
00660751 : XOR ESI,ESI
00660753 : CMP EBX,ESI
00660755 : JNZ 0x006604d5
0066075b : MOV ECX,dword ptr [EBP + -0x18]
0066075e : SHR ECX,0x10
00660761 : MOV EDX,0x3fff
00660766 : MOV EAX,0x7fff
0066076b : CMP CX,DX
0066076e : JC 0x00660a18
00660774 : MOV EBX,dword ptr [EBP + -0x26]
00660777 : INC dword ptr [EBP + -0x4c]
0066077a : XOR EDX,EDX
0066077c : MOVZX ECX,CX
0066077f : MOV dword ptr [EBP + -0x50],EDX
00660782 : MOV dword ptr [EBP + -0x10],EDX
00660785 : MOV dword ptr [EBP + -0xc],EDX
00660788 : MOV dword ptr [EBP + -0x8],EDX
0066078b : MOV EDX,dword ptr [EBP + -0x26]
0066078e : XOR EBX,ECX
00660790 : AND ECX,EAX
00660792 : AND EDX,EAX
00660794 : AND EBX,0x8000
0066079a : MOV EDI,EAX
0066079c : LEA ESI,[EDX + ECX*0x1]
0066079f : MOV dword ptr [EBP + -0x5c],EBX
006607a2 : MOVZX ESI,SI
006607a5 : CMP CX,DI
006607a8 : JNC 0x006609fa
006607ae : CMP DX,AX
006607b1 : JNC 0x006609fa
006607b7 : MOV EAX,0xbffd
006607bc : CMP SI,AX
006607bf : JA 0x006609fa
006607c5 : MOV EAX,0x3fbf
006607ca : CMP SI,AX
006607cd : JA 0x0066081a
006607cf : XOR EAX,EAX
006607d1 : MOV dword ptr [EBP + -0x1c],EAX
006607d4 : MOV dword ptr [EBP + -0x20],EAX
006607d7 : JMP 0x00660a15
006607dc : MOV AX,word ptr [EBP + -0xe]
006607e0 : OR EDI,dword ptr [EBP + -0x58]
006607e3 : MOV word ptr [EBP + -0x20],AX
006607e7 : MOV EAX,dword ptr [EBP + -0xc]
006607ea : MOV dword ptr [EBP + -0x1e],EAX
006607ed : MOV EAX,dword ptr [EBP + -0x8]
006607f0 : MOV dword ptr [EBP + -0x1a],EAX
006607f3 : MOV word ptr [EBP + -0x16],DI
006607f7 : JMP 0x00660751
006607fc : XOR EAX,EAX
006607fe : XOR ESI,ESI
00660800 : CMP word ptr [EBP + -0x58],SI
00660804 : SETZ AL
00660807 : DEC EAX
00660808 : AND EAX,0x80000000
0066080d : ADD EAX,0x7fff8000
00660812 : MOV dword ptr [EBP + -0x18],EAX
00660815 : JMP 0x00660575
0066081a : XOR EAX,EAX
0066081c : CMP CX,AX
0066081f : JNZ 0x0066083e
00660821 : INC ESI
00660822 : TEST dword ptr [EBP + -0x18],0x7fffffff
00660829 : JNZ 0x0066083e
0066082b : CMP dword ptr [EBP + -0x1c],EAX
0066082e : JNZ 0x0066083e
00660830 : CMP dword ptr [EBP + -0x20],EAX
00660833 : JNZ 0x0066083e
00660835 : MOV word ptr [EBP + -0x16],AX
00660839 : JMP 0x00660a18
0066083e : CMP DX,AX
00660841 : JNZ 0x0066085b
00660843 : INC ESI
00660844 : TEST dword ptr [EBP + -0x28],0x7fffffff
0066084b : JNZ 0x0066085b
0066084d : CMP dword ptr [EBP + -0x2c],EAX
00660850 : JNZ 0x0066085b
00660852 : CMP dword ptr [EBP + -0x30],EAX
00660855 : JZ 0x006607d1
0066085b : MOV dword ptr [EBP + -0x54],EAX
0066085e : LEA EDI,[EBP + -0xc]
00660861 : MOV dword ptr [EBP + -0x40],0x5
00660868 : MOV EAX,dword ptr [EBP + -0x54]
0066086b : MOV ECX,dword ptr [EBP + -0x40]
0066086e : ADD EAX,EAX
00660870 : MOV dword ptr [EBP + -0x48],ECX
00660873 : TEST ECX,ECX
00660875 : JLE 0x006608c1
00660877 : LEA ECX,[EBP + -0x28]
0066087a : MOV dword ptr [EBP + -0x58],ECX
0066087d : LEA EAX,[EBP + EAX*0x1 + -0x20]
00660881 : MOV ECX,dword ptr [EBP + -0x58]
00660884 : MOVZX EDX,word ptr [EAX]
00660887 : MOVZX ECX,word ptr [ECX]
0066088a : AND dword ptr [EBP + -0x44],0x0
0066088e : IMUL ECX,EDX
00660891 : MOV EDX,dword ptr [EDI + -0x4]
00660894 : LEA EBX,[EDX + ECX*0x1]
00660897 : CMP EBX,EDX
00660899 : JC 0x0066089f
0066089b : CMP EBX,ECX
0066089d : JNC 0x006608a6
0066089f : MOV dword ptr [EBP + -0x44],0x1
006608a6 : CMP dword ptr [EBP + -0x44],0x0
006608aa : MOV dword ptr [EDI + -0x4],EBX
006608ad : JZ 0x006608b2
006608af : INC word ptr [EDI]
006608b2 : SUB dword ptr [EBP + -0x58],0x2
006608b6 : INC EAX
006608b7 : INC EAX
006608b8 : DEC dword ptr [EBP + -0x48]
006608bb : CMP dword ptr [EBP + -0x48],0x0
006608bf : JG 0x00660881
006608c1 : INC EDI
006608c2 : INC EDI
006608c3 : INC dword ptr [EBP + -0x54]
006608c6 : DEC dword ptr [EBP + -0x40]
006608c9 : CMP dword ptr [EBP + -0x40],0x0
006608cd : JG 0x00660868
006608cf : ADD ESI,0xc002
006608d5 : TEST SI,SI
006608d8 : JLE 0x00660911
006608da : MOV EDI,dword ptr [EBP + -0x8]
006608dd : TEST EDI,EDI
006608df : JS 0x0066090c
006608e1 : MOV EAX,dword ptr [EBP + -0xc]
006608e4 : MOV ECX,dword ptr [EBP + -0x10]
006608e7 : SHL dword ptr [EBP + -0x10],0x1
006608ea : MOV EDX,EAX
006608ec : ADD EAX,EAX
006608ee : SHR ECX,0x1f
006608f1 : OR EAX,ECX
006608f3 : MOV dword ptr [EBP + -0xc],EAX
006608f6 : SHR EDX,0x1f
006608f9 : LEA EAX,[EDI + EDI*0x1]
006608fc : OR EAX,EDX
006608fe : ADD ESI,0xffff
00660904 : MOV dword ptr [EBP + -0x8],EAX
00660907 : TEST SI,SI
0066090a : JG 0x006608da
0066090c : TEST SI,SI
0066090f : JG 0x0066095e
00660911 : ADD ESI,0xffff
00660917 : TEST SI,SI
0066091a : JGE 0x0066095e
0066091c : MOV EAX,ESI
0066091e : NEG EAX
00660920 : MOVZX EAX,AX
00660923 : ADD ESI,EAX
00660925 : TEST byte ptr [EBP + -0x10],0x1
00660929 : JZ 0x0066092e
0066092b : INC dword ptr [EBP + -0x50]
0066092e : MOV ECX,dword ptr [EBP + -0x8]
00660931 : MOV EDI,dword ptr [EBP + -0xc]
00660934 : MOV EDX,dword ptr [EBP + -0xc]
00660937 : SHR dword ptr [EBP + -0x8],0x1
0066093a : SHL ECX,0x1f
0066093d : SHR EDI,0x1
0066093f : OR EDI,ECX
00660941 : MOV ECX,dword ptr [EBP + -0x10]
00660944 : SHL EDX,0x1f
00660947 : SHR ECX,0x1
00660949 : OR ECX,EDX
0066094b : DEC EAX
0066094c : MOV dword ptr [EBP + -0xc],EDI
0066094f : MOV dword ptr [EBP + -0x10],ECX
00660952 : JNZ 0x00660925
00660954 : CMP dword ptr [EBP + -0x50],EAX
00660957 : JZ 0x0066095e
00660959 : OR word ptr [EBP + -0x10],0x1
0066095e : MOV EAX,0x8000
00660963 : MOV ECX,EAX
00660965 : CMP word ptr [EBP + -0x10],CX
00660969 : JA 0x0066097c
0066096b : MOV ECX,dword ptr [EBP + -0x10]
0066096e : AND ECX,0x1ffff
00660974 : CMP ECX,0x18000
0066097a : JNZ 0x006609b0
0066097c : CMP dword ptr [EBP + -0xe],-0x1
00660980 : JNZ 0x006609ad
00660982 : AND dword ptr [EBP + -0xe],0x0
00660986 : CMP dword ptr [EBP + -0xa],-0x1
0066098a : JNZ 0x006609a8
0066098c : AND dword ptr [EBP + -0xa],0x0
00660990 : MOV ECX,0xffff
00660995 : CMP word ptr [EBP + -0x6],CX
00660999 : JNZ 0x006609a2
0066099b : MOV word ptr [EBP + -0x6],AX
0066099f : INC ESI
006609a0 : JMP 0x006609b0
006609a2 : INC word ptr [EBP + -0x6]
006609a6 : JMP 0x006609b0
006609a8 : INC dword ptr [EBP + -0xa]
006609ab : JMP 0x006609b0
006609ad : INC dword ptr [EBP + -0xe]
006609b0 : MOV EAX,0x7fff
006609b5 : CMP SI,AX
006609b8 : JC 0x006609dd
006609ba : XOR EAX,EAX
006609bc : XOR ECX,ECX
006609be : CMP word ptr [EBP + -0x5c],AX
006609c2 : MOV dword ptr [EBP + -0x1c],EAX
006609c5 : SETZ CL
006609c8 : MOV dword ptr [EBP + -0x20],EAX
006609cb : DEC ECX
006609cc : AND ECX,0x80000000
006609d2 : ADD ECX,0x7fff8000
006609d8 : MOV dword ptr [EBP + -0x18],ECX
006609db : JMP 0x00660a18
006609dd : MOV AX,word ptr [EBP + -0xe]
006609e1 : OR ESI,dword ptr [EBP + -0x5c]
006609e4 : MOV word ptr [EBP + -0x20],AX
006609e8 : MOV EAX,dword ptr [EBP + -0xc]
006609eb : MOV dword ptr [EBP + -0x1e],EAX
006609ee : MOV EAX,dword ptr [EBP + -0x8]
006609f1 : MOV dword ptr [EBP + -0x1a],EAX
006609f4 : MOV word ptr [EBP + -0x16],SI
006609f8 : JMP 0x00660a18
006609fa : XOR EAX,EAX
006609fc : TEST BX,BX
006609ff : SETZ AL
00660a02 : AND dword ptr [EBP + -0x1c],0x0
00660a06 : DEC EAX
00660a07 : AND EAX,0x80000000
00660a0c : ADD EAX,0x7fff8000
00660a11 : AND dword ptr [EBP + -0x20],0x0
00660a15 : MOV dword ptr [EBP + -0x18],EAX
00660a18 : TEST byte ptr [EBP + 0x18],0x1
00660a1c : MOV EDX,dword ptr [EBP + -0x64]
00660a1f : MOV EAX,dword ptr [EBP + -0x4c]
00660a22 : MOV EDI,dword ptr [EBP + 0x14]
00660a25 : MOV word ptr [EDX],AX
00660a28 : JZ 0x00660a5c
00660a2a : CWDE
00660a2b : ADD EDI,EAX
00660a2d : TEST EDI,EDI
00660a2f : JG 0x00660a5c
00660a31 : XOR EAX,EAX
00660a33 : MOV word ptr [EDX],AX
00660a36 : MOV EAX,0x8000
00660a3b : CMP word ptr [EBP + -0x60],AX
00660a3f : MOV byte ptr [EDX + 0x3],0x1
00660a43 : SETNZ AL
00660a46 : DEC AL
00660a48 : AND AL,0xd
00660a4a : ADD AL,0x20
00660a4c : MOV byte ptr [EDX + 0x2],AL
00660a4f : MOV byte ptr [EDX + 0x4],0x30
00660a53 : MOV byte ptr [EDX + 0x5],0x0
00660a57 : JMP 0x006603bb
00660a5c : CMP EDI,0x15
00660a5f : JLE 0x00660a64
00660a61 : PUSH 0x15
00660a63 : POP EDI
00660a64 : MOV ESI,dword ptr [EBP + -0x18]
00660a67 : SHR ESI,0x10
00660a6a : SUB ESI,0x3ffe
00660a70 : XOR EAX,EAX
00660a72 : MOV word ptr [EBP + -0x16],AX
00660a76 : MOV dword ptr [EBP + -0x44],0x8
00660a7d : MOV EAX,dword ptr [EBP + -0x20]
00660a80 : MOV EBX,dword ptr [EBP + -0x1c]
00660a83 : MOV ECX,dword ptr [EBP + -0x1c]
00660a86 : SHL dword ptr [EBP + -0x20],0x1
00660a89 : SHR EAX,0x1f
00660a8c : ADD EBX,EBX
00660a8e : OR EBX,EAX
00660a90 : MOV EAX,dword ptr [EBP + -0x18]
00660a93 : SHR ECX,0x1f
00660a96 : ADD EAX,EAX
00660a98 : OR EAX,ECX
00660a9a : DEC dword ptr [EBP + -0x44]
00660a9d : MOV dword ptr [EBP + -0x1c],EBX
00660aa0 : MOV dword ptr [EBP + -0x18],EAX
00660aa3 : JNZ 0x00660a7d
00660aa5 : TEST ESI,ESI
00660aa7 : JGE 0x00660adb
00660aa9 : NEG ESI
00660aab : AND ESI,0xff
00660ab1 : JLE 0x00660adb
00660ab3 : MOV EAX,dword ptr [EBP + -0x18]
00660ab6 : MOV EBX,dword ptr [EBP + -0x1c]
00660ab9 : MOV ECX,dword ptr [EBP + -0x1c]
00660abc : SHR dword ptr [EBP + -0x18],0x1
00660abf : SHL EAX,0x1f
00660ac2 : SHR EBX,0x1
00660ac4 : OR EBX,EAX
00660ac6 : MOV EAX,dword ptr [EBP + -0x20]
00660ac9 : SHL ECX,0x1f
00660acc : SHR EAX,0x1
00660ace : OR EAX,ECX
00660ad0 : DEC ESI
00660ad1 : MOV dword ptr [EBP + -0x1c],EBX
00660ad4 : MOV dword ptr [EBP + -0x20],EAX
00660ad7 : TEST ESI,ESI
00660ad9 : JG 0x00660ab3
00660adb : LEA EAX,[EDI + 0x1]
00660ade : LEA EBX,[EDX + 0x4]
00660ae1 : MOV dword ptr [EBP + -0x40],EBX
00660ae4 : MOV dword ptr [EBP + -0x4c],EAX
00660ae7 : TEST EAX,EAX
00660ae9 : JLE 0x00660ba4
00660aef : MOV EDX,dword ptr [EBP + -0x20]
00660af2 : MOV EAX,dword ptr [EBP + -0x1c]
00660af5 : LEA ESI,[EBP + -0x20]
00660af8 : LEA EDI,[EBP + -0x3c]
00660afb : MOVSD ES:EDI,ESI
00660afc : MOVSD ES:EDI,ESI
00660afd : MOVSD ES:EDI,ESI
00660afe : SHL dword ptr [EBP + -0x20],0x1
00660b01 : MOV EDI,dword ptr [EBP + -0x20]
00660b04 : SHL dword ptr [EBP + -0x20],0x1
00660b07 : SHR EDX,0x1f
00660b0a : LEA ECX,[EAX + EAX*0x1]
00660b0d : OR ECX,EDX
00660b0f : MOV EDX,dword ptr [EBP + -0x18]
00660b12 : MOV ESI,EAX
00660b14 : SHR ESI,0x1f
00660b17 : ADD EDX,EDX
00660b19 : OR EDX,ESI
00660b1b : MOV EAX,ECX
00660b1d : LEA ESI,[ECX + ECX*0x1]
00660b20 : SHR EAX,0x1f
00660b23 : LEA ECX,[EDX + EDX*0x1]
00660b26 : MOV EDX,dword ptr [EBP + -0x3c]
00660b29 : SHR EDI,0x1f
00660b2c : OR ECX,EAX
00660b2e : MOV EAX,dword ptr [EBP + -0x20]
00660b31 : OR ESI,EDI
00660b33 : LEA EDI,[EDX + EAX*0x1]
00660b36 : CMP EDI,EAX
00660b38 : JC 0x00660b3e
00660b3a : CMP EDI,EDX
00660b3c : JNC 0x00660b56
00660b3e : LEA EAX,[ESI + 0x1]
00660b41 : XOR EDX,EDX
00660b43 : CMP EAX,ESI
00660b45 : JC 0x00660b4c
00660b47 : CMP EAX,0x1
00660b4a : JNC 0x00660b4f
00660b4c : XOR EDX,EDX
00660b4e : INC EDX
00660b4f : MOV ESI,EAX
00660b51 : TEST EDX,EDX
00660b53 : JZ 0x00660b56
00660b55 : INC ECX
00660b56 : MOV EAX,dword ptr [EBP + -0x38]
00660b59 : LEA EDX,[EAX + ESI*0x1]
00660b5c : MOV dword ptr [EBP + -0x44],EDX
00660b5f : CMP EDX,ESI
00660b61 : JC 0x00660b67
00660b63 : CMP EDX,EAX
00660b65 : JNC 0x00660b68
00660b67 : INC ECX
00660b68 : ADD ECX,dword ptr [EBP + -0x34]
00660b6b : SHR EDX,0x1f
00660b6e : ADD ECX,ECX
00660b70 : OR ECX,EDX
00660b72 : LEA ESI,[EDI + EDI*0x1]
00660b75 : MOV dword ptr [EBP + -0x20],ESI
00660b78 : MOV ESI,dword ptr [EBP + -0x44]
00660b7b : MOV dword ptr [EBP + -0x18],ECX
00660b7e : SHR ECX,0x18
00660b81 : ADD ESI,ESI
00660b83 : ADD CL,0x30
00660b86 : MOV EAX,EDI
00660b88 : SHR EAX,0x1f
00660b8b : OR ESI,EAX
00660b8d : MOV byte ptr [EBX],CL
00660b8f : INC EBX
00660b90 : DEC dword ptr [EBP + -0x4c]
00660b93 : CMP dword ptr [EBP + -0x4c],0x0
00660b97 : MOV dword ptr [EBP + -0x1c],ESI
00660b9a : MOV byte ptr [EBP + -0x15],0x0
00660b9e : JG 0x00660aef
00660ba4 : DEC EBX
00660ba5 : MOV AL,byte ptr [EBX]
00660ba7 : DEC EBX
00660ba8 : CMP AL,0x35
00660baa : JGE 0x00660bba
00660bac : MOV ECX,dword ptr [EBP + -0x40]
00660baf : JMP 0x00660bf5
00660bb1 : CMP byte ptr [EBX],0x39
00660bb4 : JNZ 0x00660bbf
00660bb6 : MOV byte ptr [EBX],0x30
00660bb9 : DEC EBX
00660bba : CMP EBX,dword ptr [EBP + -0x40]
00660bbd : JNC 0x00660bb1
00660bbf : MOV EAX,dword ptr [EBP + -0x64]
00660bc2 : CMP EBX,dword ptr [EBP + -0x40]
00660bc5 : JNC 0x00660bcb
00660bc7 : INC EBX
00660bc8 : INC word ptr [EAX]
00660bcb : INC byte ptr [EBX]
00660bcd : SUB BL,AL
00660bcf : SUB BL,0x3
00660bd2 : MOVSX ECX,BL
00660bd5 : MOV byte ptr [EAX + 0x3],BL
00660bd8 : MOV byte ptr [ECX + EAX*0x1 + 0x4],0x0
00660bdd : MOV EAX,dword ptr [EBP + -0x74]
00660be0 : MOV ECX,dword ptr [EBP + -0x4]
00660be3 : POP EDI
00660be4 : POP ESI
00660be5 : XOR ECX,EBP
00660be7 : POP EBX
00660be8 : CALL 0x00633e6b
00660bed : LEAVE
00660bee : RET
00660bef : CMP byte ptr [EBX],0x30
00660bf2 : JNZ 0x00660bf9
00660bf4 : DEC EBX
00660bf5 : CMP EBX,ECX
00660bf7 : JNC 0x00660bef
00660bf9 : MOV EAX,dword ptr [EBP + -0x64]
00660bfc : CMP EBX,ECX
00660bfe : JNC 0x00660bcd
00660c00 : XOR EDX,EDX
00660c02 : MOV word ptr [EAX],DX
00660c05 : MOV EDX,0x8000
00660c0a : CMP word ptr [EBP + -0x60],DX
00660c0e : MOV byte ptr [EAX + 0x3],0x1
00660c12 : SETNZ DL
00660c15 : DEC DL
00660c17 : AND DL,0xd
00660c1a : ADD DL,0x20
00660c1d : MOV byte ptr [EAX + 0x2],DL
00660c20 : MOV byte ptr [ECX],0x30
00660c23 : MOV byte ptr [EAX + 0x5],0x0
00660c27 : JMP 0x006603bb

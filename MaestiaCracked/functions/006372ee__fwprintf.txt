PROGRAM  : Maestia.exe
FUNCTION : _fwprintf
ENTRY    : 006372ee
BODY     : [[006372ee, 00637377]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4 */
/* WARNING: Function: __SEH_epilog4 replaced with injection: EH_epilog3 */
/* Library Function - Single Match
    _fwprintf
   
   Library: Visual Studio 2008 Release */

int __cdecl _fwprintf(FILE *_File,wchar_t *_Format,...)

{
  int *piVar1;
  int iVar2;
  int _Flag;
  
  if ((_File == (FILE *)0x0) || (_Format == (wchar_t *)0x0)) {
    piVar1 = __errno();
    *piVar1 = 0x16;
    __invalid_parameter(0,0,0,0,0);
    iVar2 = -1;
  }
  else {
    __lock_file(_File);
    _Flag = __stbuf(_File);
    iVar2 = __woutput_l(_File,_Format,(_locale_t)0x0,&stack0x0000000c);
    __ftbuf(_Flag,_File);
    FUN_00637378();
  }
  return iVar2;
}



============================================================
DISASSEMBLY
============================================================
006372ee : PUSH 0xc
006372f0 : PUSH 0xcecbb8
006372f5 : CALL 0x0064c228
006372fa : XOR EAX,EAX
006372fc : MOV EDI,dword ptr [EBP + 0x8]
006372ff : XOR ESI,ESI
00637301 : CMP EDI,ESI
00637303 : SETNZ AL
00637306 : CMP EAX,ESI
00637308 : JNZ 0x00637327
0063730a : CALL 0x0063ab82
0063730f : MOV dword ptr [EAX],0x16
00637315 : PUSH ESI
00637316 : PUSH ESI
00637317 : PUSH ESI
00637318 : PUSH ESI
00637319 : PUSH ESI
0063731a : CALL 0x006372b8
0063731f : ADD ESP,0x14
00637322 : OR EAX,0xffffffff
00637325 : JMP 0x00637372
00637327 : XOR EAX,EAX
00637329 : CMP dword ptr [EBP + 0xc],ESI
0063732c : SETNZ AL
0063732f : CMP EAX,ESI
00637331 : JZ 0x0063730a
00637333 : MOV dword ptr [EBP + 0x8],EDI
00637336 : PUSH EDI
00637337 : CALL 0x0063d990
0063733c : POP ECX
0063733d : MOV dword ptr [EBP + -0x4],ESI
00637340 : PUSH EDI
00637341 : CALL 0x006501d4
00637346 : MOV EBX,EAX
00637348 : LEA EAX,[EBP + 0x10]
0063734b : PUSH EAX
0063734c : PUSH ESI
0063734d : PUSH dword ptr [EBP + 0xc]
00637350 : PUSH EDI
00637351 : CALL 0x006460b5
00637356 : MOV dword ptr [EBP + -0x1c],EAX
00637359 : PUSH EDI
0063735a : PUSH EBX
0063735b : CALL 0x00650270
00637360 : ADD ESP,0x1c
00637363 : MOV dword ptr [EBP + -0x4],0xfffffffe
0063736a : CALL 0x00637378
0063736f : MOV EAX,dword ptr [EBP + -0x1c]
00637372 : CALL 0x0064c26d
00637377 : RET

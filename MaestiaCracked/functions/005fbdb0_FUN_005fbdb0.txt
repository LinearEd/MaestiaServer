PROGRAM  : Maestia.exe
FUNCTION : FUN_005fbdb0
ENTRY    : 005fbdb0
BODY     : [[005fbdb0, 005fbddc] [005fbde0, 005fbf52]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005fbdb0(uint param_1,uint param_2,int param_3,undefined4 param_4,undefined4 param_5)

{
  uint *puVar1;
  float *pfVar2;
  float fVar3;
  float fVar4;
  float fVar5;
  float fVar6;
  uint *puVar7;
  int in_ECX;
  uint uVar8;
  int iVar9;
  uint uVar10;
  uint uVar11;
  int *piVar12;
  uint uVar13;
  int *piVar14;
  uint local_54;
  int local_38 [5];
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  undefined4 local_4;
  
  uVar11 = *(uint *)(in_ECX + 0x50);
  puVar1 = (uint *)(in_ECX + 0x50);
  local_54 = 0;
  if (param_2 != 0) {
    do {
      uVar10 = param_1 + param_3;
      pfVar2 = (float *)(*(int *)(*(int *)(in_ECX + 0x3c) + (param_1 >> 10) * 4) +
                        (param_1 & 0x3ff) * 8);
      iVar9 = *(int *)(*(int *)(in_ECX + 0x3c) + (uVar10 >> 10) * 4);
      fVar3 = *(float *)(iVar9 + (uVar10 & 0x3ff) * 8);
      fVar4 = *pfVar2;
      fVar5 = *(float *)(iVar9 + (uVar10 & 0x3ff) * 8 + 4);
      uVar13 = *puVar1 >> 10;
      fVar6 = pfVar2[1];
      if (*(uint *)(in_ECX + 0x54) <= uVar13) {
        FUN_005fa1c0(uVar13);
      }
      puVar7 = (uint *)(*(int *)(*(int *)(in_ECX + 0x5c) + uVar13 * 4) + (*puVar1 & 0x3ff) * 0x10);
      *puVar7 = param_1;
      puVar7[1] = uVar10;
      puVar7[2] = (uint)((fVar3 - fVar4) / (fVar5 - fVar6));
      puVar7[3] = 0;
      *puVar1 = *puVar1 + 1;
      if (local_54 != 0) {
        uVar13 = *puVar1 - 1;
        uVar8 = *puVar1 - 2;
        *(uint *)(*(int *)(*(int *)(in_ECX + 0x5c) + (uVar8 >> 10) * 4) + 0xc +
                 (uVar8 & 0x3ff) * 0x10) =
             (uVar13 & 0x3ff) * 0x10 + *(int *)(*(int *)(in_ECX + 0x5c) + (uVar13 >> 10) * 4);
      }
      local_54 = local_54 + 1;
      param_1 = uVar10;
    } while (local_54 < param_2);
  }
  local_38[1] = 0;
  local_38[3] = 0;
  local_38[2] = 0;
  local_38[0] = (uVar11 & 0x3ff) * 0x10 + *(int *)(*(int *)(in_ECX + 0x5c) + (uVar11 >> 10) * 4);
  puVar1 = (uint *)(in_ECX + 0x60);
  local_38[4] = param_3;
  local_24 = param_4;
  uVar11 = *(uint *)(in_ECX + 0x60) >> 6;
  local_20 = param_5;
  local_1c = 0;
  local_18 = 0;
  local_14 = 0;
  local_10 = 0;
  local_c = 0;
  local_4 = 0;
  local_8 = 0xffffffff;
  if (*(uint *)(in_ECX + 100) <= uVar11) {
    FUN_005fa230(uVar11);
  }
  piVar12 = local_38;
  piVar14 = (int *)(*(int *)(*(int *)(in_ECX + 0x6c) + uVar11 * 4) + (*puVar1 & 0x3f) * 0x38);
  for (iVar9 = 0xe; iVar9 != 0; iVar9 = iVar9 + -1) {
    *piVar14 = *piVar12;
    piVar12 = piVar12 + 1;
    piVar14 = piVar14 + 1;
  }
  *puVar1 = *puVar1 + 1;
  return;
}



============================================================
DISASSEMBLY
============================================================
005fbdb0 : SUB ESP,0x54
005fbdb3 : PUSH EBX
005fbdb4 : MOV EDX,ECX
005fbdb6 : MOV EAX,dword ptr [EDX + 0x50]
005fbdb9 : PUSH ESI
005fbdba : LEA ESI,[EDX + 0x50]
005fbdbd : XOR ECX,ECX
005fbdbf : PUSH EDI
005fbdc0 : MOV dword ptr [ESP + 0x10],EDX
005fbdc4 : MOV dword ptr [ESP + 0x14],EAX
005fbdc8 : MOV dword ptr [ESP + 0xc],ECX
005fbdcc : CMP dword ptr [ESP + 0x68],ECX
005fbdd0 : JBE 0x005fbeb3
005fbdd6 : MOV EBX,dword ptr [ESP + 0x64]
005fbdda : PUSH EBP
005fbddb : JMP 0x005fbde0
005fbde0 : MOV EAX,dword ptr [EDX + 0x3c]
005fbde3 : MOV EBP,EBX
005fbde5 : ADD EBX,dword ptr [ESP + 0x70]
005fbde9 : MOV ECX,EBP
005fbdeb : SHR ECX,0xa
005fbdee : MOV ECX,dword ptr [EAX + ECX*0x4]
005fbdf1 : MOV EDX,EBP
005fbdf3 : AND EDX,0x3ff
005fbdf9 : LEA ECX,[ECX + EDX*0x8]
005fbdfc : MOV EDX,EBX
005fbdfe : SHR EDX,0xa
005fbe01 : MOV EAX,dword ptr [EAX + EDX*0x4]
005fbe04 : MOV EDI,EBX
005fbe06 : AND EDI,0x3ff
005fbe0c : FLD float ptr [EAX + EDI*0x8]
005fbe0f : LEA EAX,[EAX + EDI*0x8]
005fbe12 : FSUB float ptr [ECX]
005fbe14 : MOV EDI,dword ptr [ESI]
005fbe16 : FLD float ptr [EAX + 0x4]
005fbe19 : SHR EDI,0xa
005fbe1c : FSUB float ptr [ECX + 0x4]
005fbe1f : FDIVP
005fbe21 : FSTP float ptr [ESP + 0x24]
005fbe25 : CMP EDI,dword ptr [ESI + 0x4]
005fbe28 : JC 0x005fbe32
005fbe2a : PUSH EDI
005fbe2b : MOV ECX,ESI
005fbe2d : CALL 0x005fa1c0
005fbe32 : MOV EAX,dword ptr [ESI]
005fbe34 : MOV ECX,dword ptr [ESI + 0xc]
005fbe37 : MOV EDX,dword ptr [ESP + 0x14]
005fbe3b : AND EAX,0x3ff
005fbe40 : SHL EAX,0x4
005fbe43 : MOV dword ptr [ESP + 0x68],EAX
005fbe47 : MOV EAX,dword ptr [ECX + EDI*0x4]
005fbe4a : MOV ECX,dword ptr [ESP + 0x68]
005fbe4e : ADD EAX,ECX
005fbe50 : MOV ECX,dword ptr [ESP + 0x24]
005fbe54 : MOV dword ptr [EAX],EBP
005fbe56 : MOV dword ptr [EAX + 0x4],EBX
005fbe59 : MOV dword ptr [EAX + 0x8],ECX
005fbe5c : XOR ECX,ECX
005fbe5e : MOV dword ptr [EAX + 0xc],ECX
005fbe61 : INC dword ptr [ESI]
005fbe63 : CMP dword ptr [ESP + 0x10],ECX
005fbe67 : JZ 0x005fbe99
005fbe69 : MOV ECX,dword ptr [ESI]
005fbe6b : MOV EDI,dword ptr [EDX + 0x5c]
005fbe6e : LEA EAX,[ECX + -0x1]
005fbe71 : MOV EBP,EAX
005fbe73 : AND EAX,0x3ff
005fbe78 : SHR EBP,0xa
005fbe7b : ADD ECX,-0x2
005fbe7e : SHL EAX,0x4
005fbe81 : ADD EAX,dword ptr [EDI + EBP*0x4]
005fbe84 : MOV EBP,ECX
005fbe86 : SHR EBP,0xa
005fbe89 : MOV EDI,dword ptr [EDI + EBP*0x4]
005fbe8c : AND ECX,0x3ff
005fbe92 : SHL ECX,0x4
005fbe95 : MOV dword ptr [EDI + ECX*0x1 + 0xc],EAX
005fbe99 : MOV EAX,dword ptr [ESP + 0x10]
005fbe9d : INC EAX
005fbe9e : MOV dword ptr [ESP + 0x10],EAX
005fbea2 : CMP EAX,dword ptr [ESP + 0x6c]
005fbea6 : JC 0x005fbde0
005fbeac : MOV EAX,dword ptr [ESP + 0x18]
005fbeb0 : XOR ECX,ECX
005fbeb2 : POP EBP
005fbeb3 : MOV EDI,dword ptr [EDX + 0x5c]
005fbeb6 : FLDZ
005fbeb8 : MOV ESI,EAX
005fbeba : FST float ptr [ESP + 0x2c]
005fbebe : AND EAX,0x3ff
005fbec3 : FST float ptr [ESP + 0x34]
005fbec7 : SHL EAX,0x4
005fbeca : FSTP float ptr [ESP + 0x30]
005fbece : SHR ESI,0xa
005fbed1 : ADD EAX,dword ptr [EDI + ESI*0x4]
005fbed4 : MOV ESI,dword ptr [EDX + 0x60]
005fbed7 : MOV dword ptr [ESP + 0x28],EAX
005fbedb : MOV EAX,dword ptr [ESP + 0x6c]
005fbedf : LEA EBX,[EDX + 0x60]
005fbee2 : MOV dword ptr [ESP + 0x38],EAX
005fbee6 : MOV EAX,dword ptr [ESP + 0x70]
005fbeea : MOV dword ptr [ESP + 0x3c],EAX
005fbeee : MOV EAX,dword ptr [ESP + 0x74]
005fbef2 : SHR ESI,0x6
005fbef5 : MOV dword ptr [ESP + 0x40],EAX
005fbef9 : MOV dword ptr [ESP + 0x44],ECX
005fbefd : MOV dword ptr [ESP + 0x48],ECX
005fbf01 : MOV dword ptr [ESP + 0x4c],ECX
005fbf05 : MOV dword ptr [ESP + 0x50],ECX
005fbf09 : MOV dword ptr [ESP + 0x54],ECX
005fbf0d : MOV dword ptr [ESP + 0x5c],ECX
005fbf11 : MOV dword ptr [ESP + 0x58],0xffffffff
005fbf19 : CMP ESI,dword ptr [EBX + 0x4]
005fbf1c : JC 0x005fbf26
005fbf1e : PUSH ESI
005fbf1f : MOV ECX,EBX
005fbf21 : CALL 0x005fa230
005fbf26 : MOV EAX,dword ptr [EBX]
005fbf28 : MOV ECX,dword ptr [EBX + 0xc]
005fbf2b : AND EAX,0x3f
005fbf2e : LEA EDX,[EAX*0x8 + 0x0]
005fbf35 : SUB EDX,EAX
005fbf37 : MOV EAX,dword ptr [ECX + ESI*0x4]
005fbf3a : LEA EDI,[EAX + EDX*0x8]
005fbf3d : MOV ECX,0xe
005fbf42 : LEA ESI,[ESP + 0x28]
005fbf46 : MOVSD.REP ES:EDI,ESI
005fbf48 : INC dword ptr [EBX]
005fbf4a : POP EDI
005fbf4b : POP ESI
005fbf4c : POP EBX
005fbf4d : ADD ESP,0x54
005fbf50 : RET 0x14

PROGRAM  : Maestia.exe
FUNCTION : __cftoe2_l
ENTRY    : 006563c8
BODY     : [[006563c8, 006564c0] [006564c4, 00656536]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    __cftoe2_l
   
   Library: Visual Studio 2008 Release */

int __cftoe2_l(uint param_1,int param_2,int param_3,int *param_4,char param_5,
              localeinfo_struct *param_6)

{
  undefined1 *in_EAX;
  int *piVar1;
  errno_t eVar2;
  int iVar3;
  undefined1 *puVar4;
  undefined1 *puVar5;
  char *_Dst;
  int iVar6;
  int local_14 [2];
  int local_c;
  char local_8;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_14,param_6);
  if ((in_EAX == (undefined1 *)0x0) || (param_1 == 0)) {
    piVar1 = __errno();
    iVar6 = 0x16;
  }
  else {
    iVar6 = param_2;
    if (param_2 < 1) {
      iVar6 = 0;
    }
    if (iVar6 + 9U < param_1) {
      if (param_5 != '\0') {
        __shift();
      }
      puVar4 = in_EAX;
      if (*param_4 == 0x2d) {
        *in_EAX = 0x2d;
        puVar4 = in_EAX + 1;
      }
      puVar5 = puVar4;
      if (0 < param_2) {
        puVar5 = puVar4 + 1;
        *puVar4 = *puVar5;
        *puVar5 = *(undefined1 *)**(undefined4 **)(local_14[0] + 0xbc);
      }
      _Dst = puVar5 + (uint)(param_5 == '\0') + param_2;
      if (param_1 == 0xffffffff) {
        puVar4 = (undefined1 *)0xffffffff;
      }
      else {
        puVar4 = in_EAX + (param_1 - (int)_Dst);
      }
      eVar2 = _strcpy_s(_Dst,(rsize_t)puVar4,"e+000");
      if (eVar2 == 0) {
        if (param_3 != 0) {
          *_Dst = 'E';
        }
        if (*(char *)param_4[3] != '0') {
          iVar6 = param_4[1] + -1;
          if (iVar6 < 0) {
            iVar6 = -iVar6;
            _Dst[1] = '-';
          }
          if (99 < iVar6) {
            iVar3 = iVar6 / 100;
            iVar6 = iVar6 % 100;
            _Dst[2] = _Dst[2] + (char)iVar3;
          }
          if (9 < iVar6) {
            iVar3 = iVar6 / 10;
            iVar6 = iVar6 % 10;
            _Dst[3] = _Dst[3] + (char)iVar3;
          }
          _Dst[4] = _Dst[4] + (char)iVar6;
        }
        if (((DAT_00d7c368 & 1) != 0) && (_Dst[2] == '0')) {
          _memmove(_Dst + 2,_Dst + 3,3);
        }
        if (local_8 != '\0') {
          *(uint *)(local_c + 0x70) = *(uint *)(local_c + 0x70) & 0xfffffffd;
        }
        return 0;
      }
                    /* WARNING: Subroutine does not return */
      __invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
    }
    piVar1 = __errno();
    iVar6 = 0x22;
  }
  *piVar1 = iVar6;
  __invalid_parameter(0,0,0,0,0);
  if (local_8 != '\0') {
    *(uint *)(local_c + 0x70) = *(uint *)(local_c + 0x70) & 0xfffffffd;
  }
  return iVar6;
}



============================================================
DISASSEMBLY
============================================================
006563c8 : MOV EDI,EDI
006563ca : PUSH EBP
006563cb : MOV EBP,ESP
006563cd : SUB ESP,0x10
006563d0 : PUSH EBX
006563d1 : PUSH ESI
006563d2 : PUSH EDI
006563d3 : PUSH dword ptr [EBP + 0x1c]
006563d6 : LEA ECX,[EBP + -0x10]
006563d9 : MOV EBX,EAX
006563db : CALL 0x00637880
006563e0 : XOR ESI,ESI
006563e2 : CMP EBX,ESI
006563e4 : JNZ 0x00656411
006563e6 : CALL 0x0063ab82
006563eb : PUSH 0x16
006563ed : POP EDI
006563ee : PUSH ESI
006563ef : PUSH ESI
006563f0 : PUSH ESI
006563f1 : PUSH ESI
006563f2 : PUSH ESI
006563f3 : MOV dword ptr [EAX],EDI
006563f5 : CALL 0x006372b8
006563fa : ADD ESP,0x14
006563fd : CMP byte ptr [EBP + -0x4],0x0
00656401 : JZ 0x0065640a
00656403 : MOV EAX,dword ptr [EBP + -0x8]
00656406 : AND dword ptr [EAX + 0x70],0xfffffffd
0065640a : MOV EAX,EDI
0065640c : JMP 0x00656532
00656411 : CMP dword ptr [EBP + 0x8],ESI
00656414 : JBE 0x006563e6
00656416 : CMP dword ptr [EBP + 0xc],ESI
00656419 : JLE 0x00656420
0065641b : MOV EAX,dword ptr [EBP + 0xc]
0065641e : JMP 0x00656422
00656420 : XOR EAX,EAX
00656422 : ADD EAX,0x9
00656425 : CMP dword ptr [EBP + 0x8],EAX
00656428 : JA 0x00656433
0065642a : CALL 0x0063ab82
0065642f : PUSH 0x22
00656431 : JMP 0x006563ed
00656433 : CMP byte ptr [EBP + 0x18],0x0
00656437 : JZ 0x00656457
00656439 : MOV EDX,dword ptr [EBP + 0x14]
0065643c : XOR EAX,EAX
0065643e : CMP dword ptr [EBP + 0xc],ESI
00656441 : SETG AL
00656444 : XOR ECX,ECX
00656446 : CMP dword ptr [EDX],0x2d
00656449 : SETZ CL
0065644c : MOV EDI,EAX
0065644e : ADD ECX,EBX
00656450 : MOV EAX,ECX
00656452 : CALL 0x00656383
00656457 : MOV EDI,dword ptr [EBP + 0x14]
0065645a : CMP dword ptr [EDI],0x2d
0065645d : MOV ESI,EBX
0065645f : JNZ 0x00656467
00656461 : MOV byte ptr [EBX],0x2d
00656464 : LEA ESI,[EBX + 0x1]
00656467 : CMP dword ptr [EBP + 0xc],0x0
0065646b : JLE 0x00656485
0065646d : LEA EAX,[ESI + 0x1]
00656470 : MOV CL,byte ptr [EAX]
00656472 : MOV byte ptr [ESI],CL
00656474 : MOV ESI,EAX
00656476 : MOV EAX,dword ptr [EBP + -0x10]
00656479 : MOV EAX,dword ptr [EAX + 0xbc]
0065647f : MOV EAX,dword ptr [EAX]
00656481 : MOV AL,byte ptr [EAX]
00656483 : MOV byte ptr [ESI],AL
00656485 : XOR EAX,EAX
00656487 : CMP byte ptr [EBP + 0x18],AL
0065648a : SETZ AL
0065648d : ADD EAX,dword ptr [EBP + 0xc]
00656490 : ADD ESI,EAX
00656492 : CMP dword ptr [EBP + 0x8],-0x1
00656496 : JNZ 0x0065649d
00656498 : OR EBX,0xffffffff
0065649b : JMP 0x006564a2
0065649d : SUB EBX,ESI
0065649f : ADD EBX,dword ptr [EBP + 0x8]
006564a2 : PUSH 0xb9ca40
006564a7 : PUSH EBX
006564a8 : PUSH ESI
006564a9 : CALL 0x00638300
006564ae : ADD ESP,0xc
006564b1 : XOR EBX,EBX
006564b3 : TEST EAX,EAX
006564b5 : JZ 0x006564c4
006564b7 : PUSH EBX
006564b8 : PUSH EBX
006564b9 : PUSH EBX
006564ba : PUSH EBX
006564bb : PUSH EBX
006564bc : CALL 0x00637169
006564c4 : LEA ECX,[ESI + 0x2]
006564c7 : CMP dword ptr [EBP + 0x10],EBX
006564ca : JZ 0x006564cf
006564cc : MOV byte ptr [ESI],0x45
006564cf : MOV EAX,dword ptr [EDI + 0xc]
006564d2 : INC ESI
006564d3 : CMP byte ptr [EAX],0x30
006564d6 : JZ 0x00656506
006564d8 : MOV EAX,dword ptr [EDI + 0x4]
006564db : DEC EAX
006564dc : JNS 0x006564e3
006564de : NEG EAX
006564e0 : MOV byte ptr [ESI],0x2d
006564e3 : INC ESI
006564e4 : CMP EAX,0x64
006564e7 : JL 0x006564f3
006564e9 : CDQ
006564ea : PUSH 0x64
006564ec : POP EDI
006564ed : IDIV EDI
006564ef : ADD byte ptr [ESI],AL
006564f1 : MOV EAX,EDX
006564f3 : INC ESI
006564f4 : CMP EAX,0xa
006564f7 : JL 0x00656503
006564f9 : CDQ
006564fa : PUSH 0xa
006564fc : POP EDI
006564fd : IDIV EDI
006564ff : ADD byte ptr [ESI],AL
00656501 : MOV EAX,EDX
00656503 : ADD byte ptr [ESI + 0x1],AL
00656506 : TEST byte ptr [0x00d7c368],0x1
0065650d : JZ 0x00656523
0065650f : CMP byte ptr [ECX],0x30
00656512 : JNZ 0x00656523
00656514 : PUSH 0x3
00656516 : LEA EAX,[ECX + 0x1]
00656519 : PUSH EAX
0065651a : PUSH ECX
0065651b : CALL 0x00636880
00656520 : ADD ESP,0xc
00656523 : CMP byte ptr [EBP + -0x4],0x0
00656527 : JZ 0x00656530
00656529 : MOV EAX,dword ptr [EBP + -0x8]
0065652c : AND dword ptr [EAX + 0x70],0xfffffffd
00656530 : XOR EAX,EAX
00656532 : POP EDI
00656533 : POP ESI
00656534 : POP EBX
00656535 : LEAVE
00656536 : RET

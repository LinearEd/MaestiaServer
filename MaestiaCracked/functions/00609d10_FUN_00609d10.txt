PROGRAM  : Maestia.exe
FUNCTION : FUN_00609d10
ENTRY    : 00609d10
BODY     : [[00609d10, 00609e1f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00609d10(undefined4 param_1,undefined2 *param_2,uint param_3)

{
  uint *puVar1;
  uint *puVar2;
  int *piVar3;
  int iVar4;
  uint uVar5;
  int *in_ECX;
  uint uVar6;
  int iVar7;
  
  piVar3 = (int *)*in_ECX;
  if (piVar3 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar3 * 5) <= piVar3[1] * 4 + 4U) goto LAB_00609d4a;
    iVar7 = piVar3[1] * 2 + 2;
  }
  FUN_0060a200(param_1,iVar7);
LAB_00609d4a:
  piVar3 = (int *)*in_ECX;
  param_3 = param_3 & piVar3[1];
  *piVar3 = *piVar3 + 1;
  iVar7 = *in_ECX;
  iVar4 = *(int *)(iVar7 + 8 + param_3 * 0xc);
  puVar1 = (uint *)(iVar7 + 8 + param_3 * 0xc);
  if (iVar4 == -2) {
    *puVar1 = 0xffffffff;
    *(undefined2 *)(puVar1 + 2) = *param_2;
    puVar1[1] = param_3;
    return;
  }
  uVar6 = param_3;
  do {
    uVar6 = uVar6 + 1 & *(uint *)(iVar7 + 4);
  } while (*(int *)(iVar7 + 8 + uVar6 * 0xc) != -2);
  piVar3 = (int *)(iVar7 + 8 + uVar6 * 0xc);
  uVar5 = puVar1[1];
  if (uVar5 == param_3) {
    if (piVar3 != (int *)0x0) {
      *piVar3 = iVar4;
      piVar3[1] = puVar1[1];
      *(short *)(piVar3 + 2) = (short)puVar1[2];
    }
    *(undefined2 *)(puVar1 + 2) = *param_2;
    *puVar1 = uVar6;
    puVar1[1] = param_3;
    return;
  }
  puVar2 = (uint *)(iVar7 + 8 + uVar5 * 0xc);
  for (uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0xc); uVar5 != param_3;
      uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0xc)) {
    uVar5 = *puVar2;
    puVar2 = (uint *)(iVar7 + 8 + uVar5 * 0xc);
  }
  if (piVar3 != (int *)0x0) {
    *piVar3 = iVar4;
    piVar3[1] = puVar1[1];
    *(short *)(piVar3 + 2) = (short)puVar1[2];
  }
  *puVar2 = uVar6;
  *(undefined2 *)(puVar1 + 2) = *param_2;
  *puVar1 = 0xffffffff;
  puVar1[1] = param_3;
  return;
}



============================================================
DISASSEMBLY
============================================================
00609d10 : PUSH EBP
00609d11 : PUSH ESI
00609d12 : MOV ESI,ECX
00609d14 : MOV EAX,dword ptr [ESI]
00609d16 : TEST EAX,EAX
00609d18 : JNZ 0x00609d23
00609d1a : MOV EAX,dword ptr [ESP + 0xc]
00609d1e : PUSH 0x8
00609d20 : PUSH EAX
00609d21 : JMP 0x00609d45
00609d23 : MOV ECX,dword ptr [EAX + 0x4]
00609d26 : LEA EDX,[ECX*0x4 + 0x4]
00609d2d : MOV ECX,dword ptr [EAX]
00609d2f : LEA ECX,[ECX + ECX*0x4]
00609d32 : CMP ECX,EDX
00609d34 : JBE 0x00609d4a
00609d36 : MOV EDX,dword ptr [EAX + 0x4]
00609d39 : MOV ECX,dword ptr [ESP + 0xc]
00609d3d : LEA EAX,[EDX + EDX*0x1 + 0x2]
00609d41 : PUSH EAX
00609d42 : PUSH ECX
00609d43 : MOV ECX,ESI
00609d45 : CALL 0x0060a200
00609d4a : MOV ECX,dword ptr [ESI]
00609d4c : MOV EAX,dword ptr [ESP + 0x14]
00609d50 : AND EAX,dword ptr [ECX + 0x4]
00609d53 : INC dword ptr [ECX]
00609d55 : MOV ESI,dword ptr [ESI]
00609d57 : LEA EDX,[EAX + EAX*0x2]
00609d5a : MOV EBP,dword ptr [ESI + EDX*0x4 + 0x8]
00609d5e : LEA ECX,[ESI + EDX*0x4 + 0x8]
00609d62 : CMP EBP,-0x2
00609d65 : JNZ 0x00609d80
00609d67 : MOV EDX,dword ptr [ESP + 0x10]
00609d6b : MOV dword ptr [ECX],0xffffffff
00609d71 : MOV DX,word ptr [EDX]
00609d74 : POP ESI
00609d75 : MOV word ptr [ECX + 0x8],DX
00609d79 : MOV dword ptr [ECX + 0x4],EAX
00609d7c : POP EBP
00609d7d : RET 0xc
00609d80 : PUSH EDI
00609d81 : MOV EDI,dword ptr [ESI + 0x4]
00609d84 : MOV EDX,EAX
00609d86 : PUSH EBX
00609d87 : INC EDX
00609d88 : AND EDX,EDI
00609d8a : LEA EBX,[EDX + EDX*0x2]
00609d8d : CMP dword ptr [ESI + EBX*0x4 + 0x8],-0x2
00609d92 : JNZ 0x00609d87
00609d94 : LEA EDI,[EDX + EDX*0x2]
00609d97 : LEA EBX,[ESI + EDI*0x4 + 0x8]
00609d9b : MOV EDI,dword ptr [ECX + 0x4]
00609d9e : CMP EDI,EAX
00609da0 : JNZ 0x00609dcd
00609da2 : TEST EBX,EBX
00609da4 : JZ 0x00609db6
00609da6 : MOV dword ptr [EBX],EBP
00609da8 : MOV ESI,dword ptr [ECX + 0x4]
00609dab : MOV dword ptr [EBX + 0x4],ESI
00609dae : MOV SI,word ptr [ECX + 0x8]
00609db2 : MOV word ptr [EBX + 0x8],SI
00609db6 : MOV ESI,dword ptr [ESP + 0x18]
00609dba : MOV SI,word ptr [ESI]
00609dbd : POP EBX
00609dbe : POP EDI
00609dbf : MOV word ptr [ECX + 0x8],SI
00609dc3 : POP ESI
00609dc4 : MOV dword ptr [ECX],EDX
00609dc6 : MOV dword ptr [ECX + 0x4],EAX
00609dc9 : POP EBP
00609dca : RET 0xc
00609dcd : LEA EDI,[EDI + EDI*0x2]
00609dd0 : CMP dword ptr [ESI + EDI*0x4 + 0x8],EAX
00609dd4 : LEA EDI,[ESI + EDI*0x4 + 0x8]
00609dd8 : JZ 0x00609def
00609dda : LEA EBX,[EBX]
00609de0 : MOV EDI,dword ptr [EDI]
00609de2 : LEA EDI,[EDI + EDI*0x2]
00609de5 : CMP dword ptr [ESI + EDI*0x4 + 0x8],EAX
00609de9 : LEA EDI,[ESI + EDI*0x4 + 0x8]
00609ded : JNZ 0x00609de0
00609def : TEST EBX,EBX
00609df1 : JZ 0x00609e03
00609df3 : MOV dword ptr [EBX],EBP
00609df5 : MOV ESI,dword ptr [ECX + 0x4]
00609df8 : MOV dword ptr [EBX + 0x4],ESI
00609dfb : MOV SI,word ptr [ECX + 0x8]
00609dff : MOV word ptr [EBX + 0x8],SI
00609e03 : MOV dword ptr [EDI],EDX
00609e05 : MOV EDX,dword ptr [ESP + 0x18]
00609e09 : MOV DX,word ptr [EDX]
00609e0c : POP EBX
00609e0d : POP EDI
00609e0e : POP ESI
00609e0f : MOV word ptr [ECX + 0x8],DX
00609e13 : MOV dword ptr [ECX],0xffffffff
00609e19 : MOV dword ptr [ECX + 0x4],EAX
00609e1c : POP EBP
00609e1d : RET 0xc

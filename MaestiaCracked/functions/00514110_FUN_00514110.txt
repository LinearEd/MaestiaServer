PROGRAM  : Maestia.exe
FUNCTION : FUN_00514110
ENTRY    : 00514110
BODY     : [[00514110, 00514199]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00514110(GRefCountImpl *param_1,undefined4 param_2)

{
  int *piVar1;
  int iVar2;
  undefined4 *puVar3;
  undefined4 *in_ECX;
  
  *in_ECX = &PTR_FUN_00cd3f2c;
  *in_ECX = &PTR_FUN_00b86dd8;
  in_ECX[1] = 1;
  in_ECX[2] = param_2;
  in_ECX[3] = 0;
  *in_ECX = &PTR_FUN_00b86ff0;
  if (param_1 != (GRefCountImpl *)0x0) {
    GRefCountImpl::AddRef(param_1);
  }
  in_ECX[4] = param_1;
  iVar2 = *(int *)(param_1 + 0x3c);
  EnterCriticalSection((LPCRITICAL_SECTION)(iVar2 + 0x24));
  puVar3 = (undefined4 *)FUN_00515840(0xc,0);
  if (puVar3 == (undefined4 *)0x0) {
    puVar3 = (undefined4 *)0x0;
  }
  else {
    puVar3[2] = in_ECX;
  }
  piVar1 = (int *)(iVar2 + 0x1c);
  *puVar3 = *(undefined4 *)(iVar2 + 0x1c);
  puVar3[1] = piVar1;
  *(undefined4 **)(*piVar1 + 4) = puVar3;
  *piVar1 = (int)puVar3;
  LeaveCriticalSection((LPCRITICAL_SECTION)(iVar2 + 0x24));
  return;
}



============================================================
DISASSEMBLY
============================================================
00514110 : MOV EAX,dword ptr [ESP + 0x8]
00514114 : PUSH EBX
00514115 : PUSH ESI
00514116 : MOV ESI,ECX
00514118 : MOV dword ptr [ESI],0xcd3f2c
0051411e : PUSH EDI
0051411f : MOV EDI,dword ptr [ESP + 0x10]
00514123 : MOV dword ptr [ESI],0xb86dd8
00514129 : MOV dword ptr [ESI + 0x4],0x1
00514130 : MOV dword ptr [ESI + 0x8],EAX
00514133 : MOV dword ptr [ESI + 0xc],0x0
0051413a : MOV dword ptr [ESI],0xb86ff0
00514140 : TEST EDI,EDI
00514142 : JZ 0x0051414b
00514144 : MOV ECX,EDI
00514146 : CALL 0x00523dd0
0051414b : MOV ECX,EDI
0051414d : MOV dword ptr [ESI + 0x10],EDI
00514150 : MOV EDI,dword ptr [ECX + 0x3c]
00514153 : LEA EBX,[EDI + 0x24]
00514156 : PUSH EBX
00514157 : CALL dword ptr [0x00b85118]
0051415d : MOV ECX,dword ptr [0x00d73250]
00514163 : PUSH 0x0
00514165 : PUSH 0xc
00514167 : CALL 0x00515840
0051416c : TEST EAX,EAX
0051416e : JZ 0x00514177
00514170 : MOV dword ptr [EAX + 0x8],ESI
00514173 : MOV ECX,EAX
00514175 : JMP 0x00514179
00514177 : XOR ECX,ECX
00514179 : MOV EDX,dword ptr [EDI + 0x1c]
0051417c : LEA EAX,[EDI + 0x1c]
0051417f : MOV dword ptr [ECX],EDX
00514181 : MOV dword ptr [ECX + 0x4],EAX
00514184 : MOV EDX,dword ptr [EAX]
00514186 : MOV dword ptr [EDX + 0x4],ECX
00514189 : PUSH EBX
0051418a : MOV dword ptr [EAX],ECX
0051418c : CALL dword ptr [0x00b8511c]
00514192 : POP EDI
00514193 : MOV EAX,ESI
00514195 : POP ESI
00514196 : POP EBX
00514197 : RET 0x8

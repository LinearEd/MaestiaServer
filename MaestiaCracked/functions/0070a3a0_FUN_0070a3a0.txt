PROGRAM  : Maestia.exe
FUNCTION : FUN_0070a3a0
ENTRY    : 0070a3a0
BODY     : [[0070a3a0, 0070a584]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_0070a3a0(void)

{
  undefined4 uVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  uint in_ECX;
  undefined4 *puVar4;
  undefined4 local_50 [2];
  undefined8 local_48;
  undefined4 local_40;
  undefined4 local_3c;
  undefined8 local_38;
  DWORD local_30;
  LPCRITICAL_SECTION local_2c;
  char *local_28;
  undefined4 local_24;
  int local_20;
  void *local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b3b64f;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  if (DAT_00da9b31 == '\0') {
    uVar1 = FUN_006f0760();
    ExceptionList = local_14;
    return uVar1;
  }
  local_20 = 0;
  local_2c = (LPCRITICAL_SECTION)&DAT_00d722e4;
  local_28 = ".\\MoStreamUtil.cpp";
  local_24 = 0x1d;
  local_1c = (void *)0x1;
  FUN_006ef1a0(&local_2c);
  local_c = 0;
  puVar2 = (undefined4 *)DAT_017244e8[1];
  puVar4 = DAT_017244e8;
  if (*(char *)((int)DAT_017244e8[1] + 0x1d) == '\0') {
    do {
      if ((uint)puVar2[3] < in_ECX) {
        puVar3 = (undefined4 *)puVar2[2];
      }
      else {
        puVar3 = (undefined4 *)*puVar2;
        puVar4 = puVar2;
      }
      puVar2 = puVar3;
    } while (*(char *)((int)puVar3 + 0x1d) == '\0');
    if (puVar4 != DAT_017244e8) {
      local_48 = *(undefined8 *)(puVar4 + 4);
      _local_40 = CONCAT44(local_3c,puVar4[6]);
      FUN_004cf440(local_50,puVar4);
      local_38._0_4_ = GetTickCount();
      local_48 = CONCAT44(local_50[0],(undefined4)local_48);
      FUN_004cf800((int)&local_48 + 4);
      FUN_0070a170();
      local_14 = (void *)0xffffffff;
      if (local_28 != (char *)0x0) {
        LeaveCriticalSection(local_38._4_4_);
      }
      ExceptionList = local_1c;
      return local_50[0];
    }
  }
  uVar1 = FUN_006f0760();
  local_48 = CONCAT44(in_ECX,uVar1);
  local_30 = GetTickCount();
  _local_40 = CONCAT44(uVar1,local_40);
  local_38 = local_48;
  FUN_004cf800(&local_3c);
  DAT_00da9b40 = DAT_00da9b40 + in_ECX;
  FUN_0070a170();
  local_c = 0xffffffff;
  if (local_20 != 0) {
    LeaveCriticalSection(local_2c);
  }
  ExceptionList = local_14;
  return uVar1;
}



============================================================
DISASSEMBLY
============================================================
0070a3a0 : PUSH EBP
0070a3a1 : MOV EBP,ESP
0070a3a3 : AND ESP,0xfffffff8
0070a3a6 : PUSH -0x1
0070a3a8 : PUSH 0xb3b64f
0070a3ad : MOV EAX,FS:[0x0]
0070a3b3 : PUSH EAX
0070a3b4 : SUB ESP,0x40
0070a3b7 : PUSH EBX
0070a3b8 : PUSH ESI
0070a3b9 : PUSH EDI
0070a3ba : MOV EAX,[0x00d66fa0]
0070a3bf : XOR EAX,ESP
0070a3c1 : PUSH EAX
0070a3c2 : LEA EAX,[ESP + 0x50]
0070a3c6 : MOV FS:[0x0],EAX
0070a3cc : MOV ESI,ECX
0070a3ce : CMP byte ptr [0x00da9b31],0x0
0070a3d5 : JNZ 0x0070a40e
0070a3d7 : MOV EAX,[0x01725270]
0070a3dc : SHR EAX,0x3
0070a3df : MOV ECX,0x0
0070a3e4 : AND EAX,0x1
0070a3e7 : SETZ CL
0070a3ea : PUSH ECX
0070a3eb : PUSH 0x0
0070a3ed : PUSH 0xbf1a4b
0070a3f2 : PUSH ESI
0070a3f3 : CALL 0x006f0760
0070a3f8 : ADD ESP,0x10
0070a3fb : MOV ECX,dword ptr [ESP + 0x50]
0070a3ff : MOV dword ptr FS:[0x0],ECX
0070a406 : POP ECX
0070a407 : POP EDI
0070a408 : POP ESI
0070a409 : POP EBX
0070a40a : MOV ESP,EBP
0070a40c : POP EBP
0070a40d : RET
0070a40e : LEA EDX,[ESP + 0x38]
0070a412 : XOR EBX,EBX
0070a414 : PUSH EDX
0070a415 : MOV dword ptr [ESP + 0x48],EBX
0070a419 : MOV dword ptr [ESP + 0x3c],0xd722e4
0070a421 : MOV dword ptr [ESP + 0x40],0xbfcf04
0070a429 : MOV dword ptr [ESP + 0x44],0x1d
0070a431 : MOV dword ptr [ESP + 0x4c],0x1
0070a439 : CALL 0x006ef1a0
0070a43e : MOV dword ptr [ESP + 0x58],EBX
0070a442 : MOV EDX,dword ptr [0x017244e8]
0070a448 : MOV EAX,dword ptr [EDX + 0x4]
0070a44b : MOV ECX,EDX
0070a44d : CMP byte ptr [EAX + 0x1d],BL
0070a450 : JNZ 0x0070a46e
0070a452 : CMP dword ptr [EAX + 0xc],ESI
0070a455 : JNC 0x0070a45c
0070a457 : MOV EAX,dword ptr [EAX + 0x8]
0070a45a : JMP 0x0070a460
0070a45c : MOV ECX,EAX
0070a45e : MOV EAX,dword ptr [EAX]
0070a460 : CMP byte ptr [EAX + 0x1d],0x0
0070a464 : JZ 0x0070a452
0070a466 : CMP ECX,EDX
0070a468 : JNZ 0x0070a505
0070a46e : MOV EAX,[0x01725270]
0070a473 : SHR EAX,0x3
0070a476 : MOV ECX,0x0
0070a47b : AND EAX,0x1
0070a47e : SETZ CL
0070a481 : PUSH ECX
0070a482 : PUSH EBX
0070a483 : PUSH 0xbf1a4b
0070a488 : PUSH ESI
0070a489 : CALL 0x006f0760
0070a48e : MOV EBX,EAX
0070a490 : ADD ESP,0x10
0070a493 : MOV dword ptr [ESP + 0x1c],EBX
0070a497 : MOV dword ptr [ESP + 0x20],ESI
0070a49b : CALL dword ptr [0x00b850d8]
0070a4a1 : MOVQ XMM0,qword ptr [ESP + 0x1c]
0070a4a7 : LEA EDX,[ESP + 0x28]
0070a4ab : PUSH EDX
0070a4ac : LEA EDI,[ESP + 0x18]
0070a4b0 : MOV dword ptr [ESP + 0x2c],EBX
0070a4b4 : MOVQ qword ptr [ESP + 0x30],XMM0
0070a4ba : MOV dword ptr [ESP + 0x38],EAX
0070a4be : CALL 0x004cf800
0070a4c3 : ADD dword ptr [0x00da9b40],ESI
0070a4c9 : CALL 0x0070a170
0070a4ce : MOV dword ptr [ESP + 0x58],0xffffffff
0070a4d6 : CMP dword ptr [ESP + 0x44],0x0
0070a4db : JZ 0x0070a4f0
0070a4dd : MOV EAX,dword ptr [ESP + 0x38]
0070a4e1 : PUSH EAX
0070a4e2 : CALL dword ptr [0x00b8511c]
0070a4e8 : MOV dword ptr [ESP + 0x44],0x0
0070a4f0 : MOV EAX,EBX
0070a4f2 : MOV ECX,dword ptr [ESP + 0x50]
0070a4f6 : MOV dword ptr FS:[0x0],ECX
0070a4fd : POP ECX
0070a4fe : POP EDI
0070a4ff : POP ESI
0070a500 : POP EBX
0070a501 : MOV ESP,EBP
0070a503 : POP EBP
0070a504 : RET
0070a505 : MOV EDX,dword ptr [ECX + 0x18]
0070a508 : MOVQ XMM0,qword ptr [ECX + 0x10]
0070a50d : PUSH ECX
0070a50e : LEA EAX,[ESP + 0x18]
0070a512 : PUSH EAX
0070a513 : MOVQ qword ptr [ESP + 0x24],XMM0
0070a519 : MOV dword ptr [ESP + 0x2c],EDX
0070a51d : CALL 0x004cf440
0070a522 : CALL dword ptr [0x00b850d8]
0070a528 : MOV ESI,dword ptr [ESP + 0x1c]
0070a52c : MOVQ XMM0,qword ptr [ESP + 0x1c]
0070a532 : LEA ECX,[ESP + 0x28]
0070a536 : PUSH ECX
0070a537 : LEA EDI,[ESP + 0x18]
0070a53b : MOV dword ptr [ESP + 0x2c],ESI
0070a53f : MOVQ qword ptr [ESP + 0x30],XMM0
0070a545 : MOV dword ptr [ESP + 0x38],EAX
0070a549 : CALL 0x004cf800
0070a54e : CALL 0x0070a170
0070a553 : MOV dword ptr [ESP + 0x58],0xffffffff
0070a55b : CMP dword ptr [ESP + 0x44],EBX
0070a55f : JZ 0x0070a570
0070a561 : MOV EDX,dword ptr [ESP + 0x38]
0070a565 : PUSH EDX
0070a566 : CALL dword ptr [0x00b8511c]
0070a56c : MOV dword ptr [ESP + 0x44],EBX
0070a570 : MOV EAX,ESI
0070a572 : MOV ECX,dword ptr [ESP + 0x50]
0070a576 : MOV dword ptr FS:[0x0],ECX
0070a57d : POP ECX
0070a57e : POP EDI
0070a57f : POP ESI
0070a580 : POP EBX
0070a581 : MOV ESP,EBP
0070a583 : POP EBP
0070a584 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00575360
ENTRY    : 00575360
BODY     : [[00575360, 0057540e]]

============================================================
DECOMPILED C CODE
============================================================

int * FUN_00575360(void)

{
  int iVar1;
  int iVar2;
  int *in_ECX;
  int *piVar3;
  int *piVar4;
  int *piVar5;
  
  iVar1 = in_ECX[1];
  if (*(int *)(iVar1 + 0x48) != *in_ECX) {
    in_ECX[3] = 0;
    *in_ECX = *(int *)(iVar1 + 0x48);
  }
  iVar2 = in_ECX[3];
  piVar4 = (int *)0x0;
  do {
    if (5 < iVar2) {
LAB_005753f7:
      if (in_ECX[2] != 0) {
        FUN_00575210(in_ECX[2]);
      }
      in_ECX[2] = (int)piVar4;
      return piVar4;
    }
    iVar2 = in_ECX[3];
    piVar5 = *(int **)(iVar1 + iVar2 * 0xc);
    if (piVar5 != (int *)0x0) {
      piVar3 = (int *)0x0;
      piVar4 = piVar5;
      do {
        if (piVar4[0xf] == in_ECX[4]) {
          if (piVar3 == (int *)0x0) {
            *(int *)(iVar1 + iVar2 * 0xc) = *piVar4;
          }
          else {
            *piVar3 = *piVar4;
          }
          if (*piVar4 == 0) {
            *(int **)(in_ECX[1] + 8 + in_ECX[3] * 0xc) = piVar3;
          }
          piVar5 = (int *)(in_ECX[1] + 4 + in_ECX[3] * 0xc);
          if (piVar4 == *(int **)(in_ECX[1] + 4 + in_ECX[3] * 0xc)) {
            if (*piVar4 == 0) {
              *piVar5 = (int)piVar3;
            }
            else {
              *piVar5 = *piVar4;
            }
          }
          *piVar4 = 0;
          goto LAB_005753f7;
        }
        piVar5 = (int *)*piVar4;
        piVar3 = piVar4;
        piVar4 = piVar5;
      } while (piVar5 != (int *)0x0);
    }
    iVar2 = iVar2 + 1;
    in_ECX[3] = iVar2;
    piVar4 = piVar5;
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
00575360 : PUSH ESI
00575361 : PUSH EDI
00575362 : MOV EDI,ECX
00575364 : MOV EDX,dword ptr [EDI + 0x4]
00575367 : MOV EAX,dword ptr [EDX + 0x48]
0057536a : CMP EAX,dword ptr [EDI]
0057536c : JZ 0x0057537a
0057536e : MOV dword ptr [EDI + 0xc],0x0
00575375 : MOV ECX,dword ptr [EDX + 0x48]
00575378 : MOV dword ptr [EDI],ECX
0057537a : XOR ESI,ESI
0057537c : CMP dword ptr [EDI + 0xc],0x6
00575380 : JGE 0x005753f7
00575382 : PUSH EBX
00575383 : MOV EAX,dword ptr [EDI + 0xc]
00575386 : LEA ECX,[EAX + EAX*0x2]
00575389 : MOV ESI,dword ptr [EDX + ECX*0x4]
0057538c : XOR ECX,ECX
0057538e : TEST ESI,ESI
00575390 : JZ 0x005753a2
00575392 : MOV EBX,dword ptr [EDI + 0x10]
00575395 : CMP dword ptr [ESI + 0x3c],EBX
00575398 : JZ 0x005753ad
0057539a : MOV ECX,ESI
0057539c : MOV ESI,dword ptr [ESI]
0057539e : TEST ESI,ESI
005753a0 : JNZ 0x00575395
005753a2 : INC EAX
005753a3 : CMP EAX,0x6
005753a6 : MOV dword ptr [EDI + 0xc],EAX
005753a9 : JL 0x00575383
005753ab : JMP 0x005753f6
005753ad : TEST ECX,ECX
005753af : JNZ 0x005753bb
005753b1 : MOV EBX,dword ptr [ESI]
005753b3 : LEA EAX,[EAX + EAX*0x2]
005753b6 : MOV dword ptr [EDX + EAX*0x4],EBX
005753b9 : JMP 0x005753bf
005753bb : MOV EDX,dword ptr [ESI]
005753bd : MOV dword ptr [ECX],EDX
005753bf : CMP dword ptr [ESI],0x0
005753c2 : JNZ 0x005753d1
005753c4 : MOV EAX,dword ptr [EDI + 0xc]
005753c7 : MOV EDX,dword ptr [EDI + 0x4]
005753ca : LEA EAX,[EAX + EAX*0x2]
005753cd : MOV dword ptr [EDX + EAX*0x4 + 0x8],ECX
005753d1 : MOV EAX,dword ptr [EDI + 0xc]
005753d4 : MOV EDX,dword ptr [EDI + 0x4]
005753d7 : LEA EAX,[EAX + EAX*0x2]
005753da : CMP ESI,dword ptr [EDX + EAX*0x4 + 0x4]
005753de : LEA EAX,[EDX + EAX*0x4 + 0x4]
005753e2 : JNZ 0x005753f0
005753e4 : MOV EDX,dword ptr [ESI]
005753e6 : TEST EDX,EDX
005753e8 : JNZ 0x005753ee
005753ea : MOV dword ptr [EAX],ECX
005753ec : JMP 0x005753f0
005753ee : MOV dword ptr [EAX],EDX
005753f0 : MOV dword ptr [ESI],0x0
005753f6 : POP EBX
005753f7 : MOV EAX,dword ptr [EDI + 0x8]
005753fa : TEST EAX,EAX
005753fc : JZ 0x00575407
005753fe : MOV ECX,dword ptr [EDI + 0x4]
00575401 : PUSH EAX
00575402 : CALL 0x00575210
00575407 : MOV dword ptr [EDI + 0x8],ESI
0057540a : POP EDI
0057540b : MOV EAX,ESI
0057540d : POP ESI
0057540e : RET

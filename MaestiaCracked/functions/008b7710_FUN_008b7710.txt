PROGRAM  : Maestia.exe
FUNCTION : FUN_008b7710
ENTRY    : 008b7710
BODY     : [[008b7710, 008b789a]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Type propagation algorithm not settling */

void FUN_008b7710(int param_1)

{
  WCHAR WVar1;
  uint uVar2;
  LPCWSTR lpAppName;
  DWORD DVar3;
  WCHAR *pWVar4;
  int in_ECX;
  int iVar5;
  LPCWSTR lpKeyName;
  int in_EDX;
  LPCWSTR lpFileName;
  int unaff_ESI;
  undefined1 local_240 [4];
  undefined2 local_23c;
  undefined4 local_22c;
  uint local_228;
  WCHAR local_214;
  undefined1 local_212 [510];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1cde6;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  pWVar4 = &local_214;
  local_14 = uVar2;
  for (iVar5 = 0x80; iVar5 != 0; iVar5 = iVar5 + -1) {
    pWVar4[0] = L'\0';
    pWVar4[1] = L'\0';
    pWVar4 = pWVar4 + 2;
  }
  if (*(uint *)(in_EDX + 0x18) < 8) {
    lpFileName = (LPCWSTR)(in_EDX + 4);
  }
  else {
    lpFileName = *(LPCWSTR *)(in_EDX + 4);
  }
  if (*(uint *)(in_ECX + 0x18) < 8) {
    lpKeyName = (LPCWSTR)(in_ECX + 4);
  }
  else {
    lpKeyName = *(LPCWSTR *)(in_ECX + 4);
  }
  if (*(uint *)(param_1 + 0x18) < 8) {
    lpAppName = (LPCWSTR)(param_1 + 4);
  }
  else {
    lpAppName = *(LPCWSTR *)(param_1 + 4);
  }
  DVar3 = GetPrivateProfileStringW
                    (lpAppName,lpKeyName,L"Error : ReadIni",&local_214,0x100,lpFileName);
  if (DVar3 == 0) {
    FUN_00406460(L"INI read error");
    local_8 = 1;
    if ((int *)*DAT_00da98e8 != (int *)0x0) {
      (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                (L"AvaIniLoader::GetIniString",0xd5,local_240,uVar2);
    }
    local_8 = local_8 & 0xffffff00;
    if (7 < local_228) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_228 = 7;
    local_22c = 0;
    local_23c = 0;
  }
  pWVar4 = &local_214;
  *(undefined4 *)(unaff_ESI + 0x18) = 7;
  *(undefined4 *)(unaff_ESI + 0x14) = 0;
  *(undefined2 *)(unaff_ESI + 4) = 0;
  do {
    WVar1 = *pWVar4;
    pWVar4 = pWVar4 + 1;
  } while (WVar1 != L'\0');
  FUN_00406360(&local_214,(int)pWVar4 - (int)local_212 >> 1);
  local_8 = 0;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008b7710 : PUSH EBP
008b7711 : MOV EBP,ESP
008b7713 : PUSH -0x1
008b7715 : PUSH 0xb1cde6
008b771a : MOV EAX,FS:[0x0]
008b7720 : PUSH EAX
008b7721 : SUB ESP,0x230
008b7727 : MOV EAX,[0x00d66fa0]
008b772c : XOR EAX,EBP
008b772e : MOV dword ptr [EBP + -0x10],EAX
008b7731 : PUSH EBX
008b7732 : PUSH EDI
008b7733 : PUSH EAX
008b7734 : LEA EAX,[EBP + -0xc]
008b7737 : MOV FS:[0x0],EAX
008b773d : MOV EAX,dword ptr [EBP + 0x8]
008b7740 : MOV dword ptr [EBP + 0xfffffde8],EAX
008b7746 : XOR EAX,EAX
008b7748 : MOVZX EBX,AX
008b774b : MOV EAX,EBX
008b774d : SHL EBX,0x10
008b7750 : MOV dword ptr [EBP + 0xfffffde4],ECX
008b7756 : OR EAX,EBX
008b7758 : MOV dword ptr [EBP + 0xfffffdec],0x0
008b7762 : MOV ECX,0x80
008b7767 : LEA EDI,[EBP + 0xfffffdf0]
008b776d : STOSD.REP ES:EDI
008b776f : MOV EDI,0x8
008b7774 : MOV dword ptr [EBP + 0xfffffde0],ESI
008b777a : CMP dword ptr [EDX + 0x18],EDI
008b777d : JC 0x008b7784
008b777f : MOV EDX,dword ptr [EDX + 0x4]
008b7782 : JMP 0x008b7787
008b7784 : ADD EDX,0x4
008b7787 : MOV EAX,dword ptr [EBP + 0xfffffde4]
008b778d : CMP dword ptr [EAX + 0x18],EDI
008b7790 : JC 0x008b7797
008b7792 : MOV ECX,dword ptr [EAX + 0x4]
008b7795 : JMP 0x008b779a
008b7797 : LEA ECX,[EAX + 0x4]
008b779a : MOV EAX,dword ptr [EBP + 0xfffffde8]
008b77a0 : CMP dword ptr [EAX + 0x18],EDI
008b77a3 : JC 0x008b77aa
008b77a5 : MOV EAX,dword ptr [EAX + 0x4]
008b77a8 : JMP 0x008b77ad
008b77aa : ADD EAX,0x4
008b77ad : PUSH EDX
008b77ae : PUSH 0x100
008b77b3 : LEA EDX,[EBP + 0xfffffdf0]
008b77b9 : PUSH EDX
008b77ba : PUSH 0xc4caec
008b77bf : PUSH ECX
008b77c0 : PUSH EAX
008b77c1 : CALL dword ptr [0x00b851d0]
008b77c7 : MOV EDI,0x7
008b77cc : TEST EAX,EAX
008b77ce : JA 0x008b783a
008b77d0 : PUSH 0xc4cb0c
008b77d5 : LEA ECX,[EBP + 0xfffffdc4]
008b77db : CALL 0x00406460
008b77e0 : MOV dword ptr [EBP + -0x4],0x1
008b77e7 : MOV EAX,[0x00da98e8]
008b77ec : MOV ECX,dword ptr [EAX]
008b77ee : XOR EBX,EBX
008b77f0 : CMP ECX,EBX
008b77f2 : JZ 0x008b780c
008b77f4 : MOV EDX,dword ptr [ECX]
008b77f6 : MOV EDX,dword ptr [EDX + 0x14]
008b77f9 : LEA EAX,[EBP + 0xfffffdc4]
008b77ff : PUSH EAX
008b7800 : PUSH 0xd5
008b7805 : PUSH 0xc4cb2c
008b780a : CALL EDX
008b780c : MOV byte ptr [EBP + -0x4],BL
008b780f : CMP dword ptr [EBP + 0xfffffddc],0x8
008b7816 : JC 0x008b7823
008b7818 : MOV ECX,dword ptr [EBP + 0xfffffdc8]
008b781e : CALL 0x006f04e0
008b7823 : XOR EAX,EAX
008b7825 : MOV dword ptr [EBP + 0xfffffddc],EDI
008b782b : MOV dword ptr [EBP + 0xfffffdd8],EBX
008b7831 : MOV word ptr [EBP + 0xfffffdc8],AX
008b7838 : JMP 0x008b783c
008b783a : XOR EBX,EBX
008b783c : XOR ECX,ECX
008b783e : LEA EAX,[EBP + 0xfffffdf0]
008b7844 : MOV dword ptr [ESI + 0x18],EDI
008b7847 : MOV dword ptr [ESI + 0x14],EBX
008b784a : MOV word ptr [ESI + 0x4],CX
008b784e : LEA EDX,[EAX + 0x2]
008b7851 : MOV CX,word ptr [EAX]
008b7854 : ADD EAX,0x2
008b7857 : CMP CX,BX
008b785a : JNZ 0x008b7851
008b785c : SUB EAX,EDX
008b785e : SAR EAX,0x1
008b7860 : PUSH EAX
008b7861 : LEA EDX,[EBP + 0xfffffdf0]
008b7867 : PUSH EDX
008b7868 : MOV ECX,ESI
008b786a : CALL 0x00406360
008b786f : MOV dword ptr [EBP + -0x4],EBX
008b7872 : MOV dword ptr [EBP + 0xfffffdec],0x1
008b787c : MOV EAX,ESI
008b787e : MOV ECX,dword ptr [EBP + -0xc]
008b7881 : MOV dword ptr FS:[0x0],ECX
008b7888 : POP ECX
008b7889 : POP EDI
008b788a : POP EBX
008b788b : MOV ECX,dword ptr [EBP + -0x10]
008b788e : XOR ECX,EBP
008b7890 : CALL 0x00633e6b
008b7895 : MOV ESP,EBP
008b7897 : POP EBP
008b7898 : RET 0x4

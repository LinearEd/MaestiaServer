PROGRAM  : Maestia.exe
FUNCTION : FUN_005bf9f0
ENTRY    : 005bf9f0
BODY     : [[005bf9f0, 005bfadf]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005bf9f0(int param_1)

{
  int *piVar1;
  byte *pbVar2;
  char cVar3;
  undefined1 uVar4;
  int iVar5;
  LONG LVar6;
  undefined4 uVar7;
  uint local_4;
  
  cVar3 = FUN_00526030(0x29);
  if (cVar3 != '\0') {
    if ((*(int *)(param_1 + 8) != 0) && (*(int *)(param_1 + 8) != 0x10)) {
      if (*(int *)(param_1 + 0x1c) < 1) {
        uVar4 = 0;
      }
      else {
        uVar7 = *(undefined4 *)(param_1 + 0x18);
        FUN_00526260(0);
        uVar4 = FUN_00526120(uVar7);
      }
      FUN_005ed870(&local_4,uVar4);
      iVar5 = FUN_00525450((local_4 & 0xfffffffc) + 8,*(uint *)(local_4 & 0xfffffffc) & 0x7fffffff);
      *(int *)(iVar5 + 8) = *(int *)(iVar5 + 8) + 1;
      pbVar2 = *(byte **)(param_1 + 4);
      if (4 < *pbVar2) {
        FUN_00526400();
      }
      *pbVar2 = 5;
      *(int *)(pbVar2 + 4) = iVar5;
      *(int *)(iVar5 + 8) = *(int *)(iVar5 + 8) + 1;
      piVar1 = (int *)(iVar5 + 8);
      *piVar1 = *piVar1 + -1;
      if (*piVar1 == 0) {
        FUN_00525340();
      }
      LVar6 = InterlockedExchangeAdd((LONG *)((local_4 & 0xfffffffc) + 4),-1);
      if (LVar6 == 1) {
        FUN_00515cf0(local_4 & 0xfffffffc);
      }
    }
    return;
  }
  FUN_00526050("TextSnapshot",0,0);
  return;
}



============================================================
DISASSEMBLY
============================================================
005bf9f0 : SUB ESP,0x8
005bf9f3 : PUSH EDI
005bf9f4 : MOV EDI,dword ptr [ESP + 0x10]
005bf9f8 : PUSH 0x29
005bf9fa : MOV ECX,EDI
005bf9fc : CALL 0x00526030
005bfa01 : TEST AL,AL
005bfa03 : JNZ 0x005bfa1a
005bfa05 : PUSH 0x0
005bfa07 : PUSH 0x0
005bfa09 : PUSH 0xb8fd10
005bfa0e : MOV ECX,EDI
005bfa10 : CALL 0x00526050
005bfa15 : POP EDI
005bfa16 : ADD ESP,0x8
005bfa19 : RET
005bfa1a : MOV EAX,dword ptr [EDI + 0x8]
005bfa1d : TEST EAX,EAX
005bfa1f : JZ 0x005bfadb
005bfa25 : PUSH ESI
005bfa26 : LEA ESI,[EAX + -0x10]
005bfa29 : TEST ESI,ESI
005bfa2b : JZ 0x005bfada
005bfa31 : CMP dword ptr [EDI + 0x1c],0x0
005bfa35 : JLE 0x005bfa51
005bfa37 : MOV EAX,dword ptr [EDI + 0x18]
005bfa3a : PUSH EAX
005bfa3b : PUSH 0x0
005bfa3d : MOV ECX,EDI
005bfa3f : CALL 0x00526260
005bfa44 : MOV ECX,EAX
005bfa46 : CALL 0x00526120
005bfa4b : MOV byte ptr [ESP + 0x8],AL
005bfa4f : JMP 0x005bfa56
005bfa51 : MOV byte ptr [ESP + 0x8],0x0
005bfa56 : MOV ECX,dword ptr [ESP + 0x8]
005bfa5a : PUSH ECX
005bfa5b : LEA EDX,[ESP + 0x10]
005bfa5f : PUSH EDX
005bfa60 : LEA ECX,[ESI + 0x30]
005bfa63 : CALL 0x005ed870
005bfa68 : MOV EAX,dword ptr [EDI + 0x18]
005bfa6b : MOV EDX,dword ptr [EAX + 0x78]
005bfa6e : MOV EAX,dword ptr [ESP + 0xc]
005bfa72 : MOV ECX,EAX
005bfa74 : AND ECX,0xfffffffc
005bfa77 : MOV ECX,dword ptr [ECX]
005bfa79 : AND ECX,0x7fffffff
005bfa7f : AND EAX,0xfffffffc
005bfa82 : PUSH ECX
005bfa83 : ADD EAX,0x8
005bfa86 : PUSH EAX
005bfa87 : LEA ECX,[EDX + 0x254]
005bfa8d : CALL 0x00525450
005bfa92 : MOV ESI,EAX
005bfa94 : INC dword ptr [ESI + 0x8]
005bfa97 : MOV EDI,dword ptr [EDI + 0x4]
005bfa9a : CMP byte ptr [EDI],0x5
005bfa9d : JC 0x005bfaa6
005bfa9f : MOV ECX,EDI
005bfaa1 : CALL 0x00526400
005bfaa6 : MOV byte ptr [EDI],0x5
005bfaa9 : MOV dword ptr [EDI + 0x4],ESI
005bfaac : INC dword ptr [ESI + 0x8]
005bfaaf : ADD dword ptr [ESI + 0x8],-0x1
005bfab3 : JNZ 0x005bfabc
005bfab5 : MOV ECX,ESI
005bfab7 : CALL 0x00525340
005bfabc : MOV ESI,dword ptr [ESP + 0xc]
005bfac0 : AND ESI,0xfffffffc
005bfac3 : PUSH -0x1
005bfac5 : LEA EDX,[ESI + 0x4]
005bfac8 : PUSH EDX
005bfac9 : CALL dword ptr [0x00b851cc]
005bfacf : SUB EAX,0x1
005bfad2 : JNZ 0x005bfada
005bfad4 : PUSH ESI
005bfad5 : CALL 0x00515cf0
005bfada : POP ESI
005bfadb : POP EDI
005bfadc : ADD ESP,0x8
005bfadf : RET

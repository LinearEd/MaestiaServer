PROGRAM  : Maestia.exe
FUNCTION : ___InternalCxxFrameHandler
ENTRY    : 006436bc
BODY     : [[006436bc, 006437a1]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    ___InternalCxxFrameHandler
   
   Library: Visual Studio 2008 Release */

undefined4
___InternalCxxFrameHandler
          (EHExceptionRecord *param_1,EHRegistrationNode *param_2,_CONTEXT *param_3,void *param_4,
          _s_FuncInfo *param_5,int param_6,EHRegistrationNode *param_7,uchar param_8)

{
  _ptiddata p_Var1;
  undefined4 uVar2;
  
  p_Var1 = __getptd();
  if ((((*(int *)((p_Var1->_setloc_data)._cacheout + 0x27) != 0) || (*(int *)param_1 == -0x1f928c9d)
       ) || (*(int *)param_1 == -0x7fffffda)) ||
     (((param_5->magicNumber_and_bbtFlags & 0x1fffffff) < 0x19930522 ||
      ((param_5->EHFlags & 1) == 0)))) {
    if (((byte)param_1[4] & 0x66) == 0) {
      if ((param_5->nTryBlocks != 0) ||
         ((0x19930520 < (param_5->magicNumber_and_bbtFlags & 0x1fffffff) &&
          (param_5->pESTypeList != (ESTypeList *)0x0)))) {
        if ((*(int *)param_1 == -0x1f928c9d) &&
           (((2 < *(uint *)(param_1 + 0x10) && (0x19930522 < *(uint *)(param_1 + 0x14))) &&
            (*(code **)(*(int *)(param_1 + 0x1c) + 8) != (code *)0x0)))) {
          uVar2 = (**(code **)(*(int *)(param_1 + 0x1c) + 8))
                            (param_1,param_2,param_3,param_4,param_5,param_6,param_7,param_8);
          return uVar2;
        }
        FindHandler(param_1,param_2,param_3,param_4,param_5,param_8,param_6,param_7);
      }
    }
    else if ((param_5->maxState != 0) && (param_6 == 0)) {
      ___FrameUnwindToState(param_2,param_4,param_5,0xffffffff);
    }
  }
  return 1;
}



============================================================
DISASSEMBLY
============================================================
006436bc : MOV EDI,EDI
006436be : PUSH EBP
006436bf : MOV EBP,ESP
006436c1 : PUSH EBX
006436c2 : PUSH ESI
006436c3 : PUSH EDI
006436c4 : CALL 0x006458f6
006436c9 : CMP dword ptr [EAX + 0x20c],0x0
006436d0 : MOV EAX,dword ptr [EBP + 0x18]
006436d3 : MOV ECX,dword ptr [EBP + 0x8]
006436d6 : MOV EDI,0xe06d7363
006436db : MOV ESI,0x1fffffff
006436e0 : MOV EBX,0x19930522
006436e5 : JNZ 0x00643707
006436e7 : MOV EDX,dword ptr [ECX]
006436e9 : CMP EDX,EDI
006436eb : JZ 0x00643707
006436ed : CMP EDX,0x80000026
006436f3 : JZ 0x00643707
006436f5 : MOV EDX,dword ptr [EAX]
006436f7 : AND EDX,ESI
006436f9 : CMP EDX,EBX
006436fb : JC 0x00643707
006436fd : TEST byte ptr [EAX + 0x20],0x1
00643701 : JNZ 0x0064379a
00643707 : TEST byte ptr [ECX + 0x4],0x66
0064370b : JZ 0x00643730
0064370d : CMP dword ptr [EAX + 0x4],0x0
00643711 : JZ 0x0064379a
00643717 : CMP dword ptr [EBP + 0x1c],0x0
0064371b : JNZ 0x0064379a
0064371d : PUSH -0x1
0064371f : PUSH EAX
00643720 : PUSH dword ptr [EBP + 0x14]
00643723 : PUSH dword ptr [EBP + 0xc]
00643726 : CALL 0x00642be1
0064372b : ADD ESP,0x10
0064372e : JMP 0x0064379a
00643730 : CMP dword ptr [EAX + 0xc],0x0
00643734 : JNZ 0x00643748
00643736 : MOV EDX,dword ptr [EAX]
00643738 : AND EDX,ESI
0064373a : CMP EDX,0x19930521
00643740 : JC 0x0064379a
00643742 : CMP dword ptr [EAX + 0x1c],0x0
00643746 : JZ 0x0064379a
00643748 : CMP dword ptr [ECX],EDI
0064374a : JNZ 0x0064377e
0064374c : CMP dword ptr [ECX + 0x10],0x3
00643750 : JC 0x0064377e
00643752 : CMP dword ptr [ECX + 0x14],EBX
00643755 : JBE 0x0064377e
00643757 : MOV EDX,dword ptr [ECX + 0x1c]
0064375a : MOV EDX,dword ptr [EDX + 0x8]
0064375d : TEST EDX,EDX
0064375f : JZ 0x0064377e
00643761 : MOVZX ESI,byte ptr [EBP + 0x24]
00643765 : PUSH ESI
00643766 : PUSH dword ptr [EBP + 0x20]
00643769 : PUSH dword ptr [EBP + 0x1c]
0064376c : PUSH EAX
0064376d : PUSH dword ptr [EBP + 0x14]
00643770 : PUSH dword ptr [EBP + 0x10]
00643773 : PUSH dword ptr [EBP + 0xc]
00643776 : PUSH ECX
00643777 : CALL EDX
00643779 : ADD ESP,0x20
0064377c : JMP 0x0064379d
0064377e : PUSH dword ptr [EBP + 0x20]
00643781 : PUSH dword ptr [EBP + 0x1c]
00643784 : PUSH dword ptr [EBP + 0x24]
00643787 : PUSH EAX
00643788 : PUSH dword ptr [EBP + 0x14]
0064378b : PUSH dword ptr [EBP + 0x10]
0064378e : PUSH dword ptr [EBP + 0xc]
00643791 : PUSH ECX
00643792 : CALL 0x00643358
00643797 : ADD ESP,0x20
0064379a : XOR EAX,EAX
0064379c : INC EAX
0064379d : POP EDI
0064379e : POP ESI
0064379f : POP EBX
006437a0 : POP EBP
006437a1 : RET

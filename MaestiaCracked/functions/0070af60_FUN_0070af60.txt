PROGRAM  : Maestia.exe
FUNCTION : FUN_0070af60
ENTRY    : 0070af60
BODY     : [[0070af60, 0070b061]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_0070af60(int *param_1,wchar_t *param_2)

{
  wchar_t wVar1;
  uint uVar2;
  wchar_t *pwVar3;
  undefined1 local_2030 [4];
  undefined2 local_202c;
  undefined4 local_201c;
  uint local_2018;
  wchar_t local_2014;
  undefined1 local_2012 [8188];
  undefined2 local_16;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b175cf;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_14 = uVar2;
  __vsnwprintf(&local_2014,0x1000,param_2,&stack0x0000000c);
  local_16 = 0;
  local_201c = 0;
  pwVar3 = &local_2014;
  local_2018 = 7;
  local_202c = 0;
  do {
    wVar1 = *pwVar3;
    pwVar3 = pwVar3 + 1;
  } while (wVar1 != L'\0');
  FUN_00406360(&local_2014,(int)pwVar3 - (int)local_2012 >> 1);
  local_8 = 0;
  (**(code **)(*param_1 + 0x10))(local_2030,uVar2);
  local_8 = 0xffffffff;
  if (7 < local_2018) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_2018 = 7;
  local_201c = 0;
  local_202c = 0;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0070af60 : PUSH EBP
0070af61 : MOV EBP,ESP
0070af63 : PUSH -0x1
0070af65 : PUSH 0xb175cf
0070af6a : MOV EAX,FS:[0x0]
0070af70 : PUSH EAX
0070af71 : MOV EAX,0x2020
0070af76 : CALL 0x0063b780
0070af7b : MOV EAX,[0x00d66fa0]
0070af80 : XOR EAX,EBP
0070af82 : MOV dword ptr [EBP + -0x10],EAX
0070af85 : PUSH ESI
0070af86 : PUSH EAX
0070af87 : LEA EAX,[EBP + -0xc]
0070af8a : MOV FS:[0x0],EAX
0070af90 : MOV ECX,dword ptr [EBP + 0xc]
0070af93 : MOV ESI,dword ptr [EBP + 0x8]
0070af96 : LEA EAX,[EBP + 0x10]
0070af99 : PUSH EAX
0070af9a : PUSH ECX
0070af9b : LEA EDX,[EBP + 0xffffdff0]
0070afa1 : PUSH 0x1000
0070afa6 : PUSH EDX
0070afa7 : CALL 0x00639271
0070afac : XOR EAX,EAX
0070afae : ADD ESP,0x10
0070afb1 : MOV word ptr [EBP + -0x12],AX
0070afb5 : MOV dword ptr [EBP + 0xffffdfe8],EAX
0070afbb : XOR ECX,ECX
0070afbd : LEA EAX,[EBP + 0xffffdff0]
0070afc3 : MOV dword ptr [EBP + 0xffffdfec],0x7
0070afcd : MOV word ptr [EBP + 0xffffdfd8],CX
0070afd4 : LEA EDX,[EAX + 0x2]
0070afd7 : MOV CX,word ptr [EAX]
0070afda : ADD EAX,0x2
0070afdd : TEST CX,CX
0070afe0 : JNZ 0x0070afd7
0070afe2 : SUB EAX,EDX
0070afe4 : SAR EAX,0x1
0070afe6 : PUSH EAX
0070afe7 : LEA EDX,[EBP + 0xffffdff0]
0070afed : PUSH EDX
0070afee : LEA ECX,[EBP + 0xffffdfd4]
0070aff4 : CALL 0x00406360
0070aff9 : MOV dword ptr [EBP + -0x4],0x0
0070b000 : MOV EAX,dword ptr [ESI]
0070b002 : MOV EDX,dword ptr [EAX + 0x10]
0070b005 : LEA ECX,[EBP + 0xffffdfd4]
0070b00b : PUSH ECX
0070b00c : MOV ECX,ESI
0070b00e : CALL EDX
0070b010 : MOV dword ptr [EBP + -0x4],0xffffffff
0070b017 : CMP dword ptr [EBP + 0xffffdfec],0x8
0070b01e : JC 0x0070b02b
0070b020 : MOV ECX,dword ptr [EBP + 0xffffdfd8]
0070b026 : CALL 0x006f04e0
0070b02b : XOR EAX,EAX
0070b02d : MOV dword ptr [EBP + 0xffffdfec],0x7
0070b037 : MOV dword ptr [EBP + 0xffffdfe8],0x0
0070b041 : MOV word ptr [EBP + 0xffffdfd8],AX
0070b048 : MOV ECX,dword ptr [EBP + -0xc]
0070b04b : MOV dword ptr FS:[0x0],ECX
0070b052 : POP ECX
0070b053 : POP ESI
0070b054 : MOV ECX,dword ptr [EBP + -0x10]
0070b057 : XOR ECX,EBP
0070b059 : CALL 0x00633e6b
0070b05e : MOV ESP,EBP
0070b060 : POP EBP
0070b061 : RET

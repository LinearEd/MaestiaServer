PROGRAM  : Maestia.exe
FUNCTION : FUN_004faf70
ENTRY    : 004faf70
BODY     : [[004faf70, 004faff8]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_004faf70(undefined4 *param_1)

{
  uint uVar1;
  int iVar2;
  void *local_c;
  undefined1 *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_00b823e8;
  local_c = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffff0;
  ExceptionList = &local_c;
  *param_1 = &PTR_FUN_00cdf0a0;
  local_4 = 0;
  if (*(char *)(param_1 + 5) != '\0') {
    iVar2 = param_1[6] * 0x114;
    if ((&DAT_017212d0)[iVar2] == '\0') {
      FUN_00807d70("CSharedHeapBlock::Unlock() called when buffer was not locked",uVar1);
    }
    else {
      (&DAT_017212d0)[iVar2] = 0;
      *(undefined4 *)(&DAT_017211cc + iVar2) = 0;
      (&DAT_017211d0)[iVar2] = 0;
    }
  }
  local_4 = 0xffffffff;
  FUN_0046ee20();
  ExceptionList = local_c;
  return;
}



============================================================
DISASSEMBLY
============================================================
004faf70 : PUSH -0x1
004faf72 : PUSH 0xb823e8
004faf77 : MOV EAX,FS:[0x0]
004faf7d : PUSH EAX
004faf7e : PUSH ESI
004faf7f : MOV EAX,[0x00d66fa0]
004faf84 : XOR EAX,ESP
004faf86 : PUSH EAX
004faf87 : LEA EAX,[ESP + 0x8]
004faf8b : MOV FS:[0x0],EAX
004faf91 : MOV ESI,dword ptr [ESP + 0x18]
004faf95 : MOV dword ptr [ESI],0xcdf0a0
004faf9b : XOR ECX,ECX
004faf9d : MOV dword ptr [ESP + 0x10],ECX
004fafa1 : CMP byte ptr [ESI + 0x14],CL
004fafa4 : JZ 0x004fafd7
004fafa6 : MOV EAX,dword ptr [ESI + 0x18]
004fafa9 : IMUL EAX,EAX,0x114
004fafaf : ADD EAX,0x17211c0
004fafb4 : CMP byte ptr [EAX + 0x110],CL
004fafba : JZ 0x004fafca
004fafbc : MOV byte ptr [EAX + 0x110],CL
004fafc2 : MOV dword ptr [EAX + 0xc],ECX
004fafc5 : MOV byte ptr [EAX + 0x10],CL
004fafc8 : JMP 0x004fafd7
004fafca : PUSH 0xcd4178
004fafcf : CALL 0x00807d70
004fafd4 : ADD ESP,0x4
004fafd7 : MOV dword ptr [ESP + 0x10],0xffffffff
004fafdf : MOV ECX,ESI
004fafe1 : CALL 0x0046ee20
004fafe6 : MOV ECX,dword ptr [ESP + 0x8]
004fafea : MOV dword ptr FS:[0x0],ECX
004faff1 : POP ECX
004faff2 : POP ESI
004faff3 : ADD ESP,0xc
004faff6 : RET 0x4

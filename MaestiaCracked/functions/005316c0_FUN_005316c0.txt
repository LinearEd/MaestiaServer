PROGRAM  : Maestia.exe
FUNCTION : FUN_005316c0
ENTRY    : 005316c0
BODY     : [[005316c0, 0053180c] [00531810, 00531ad5]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005316c0(uint param_1)

{
  int *piVar1;
  byte *pbVar2;
  int iVar3;
  uint uVar4;
  undefined4 uVar5;
  int iVar6;
  undefined4 *puVar7;
  int *in_ECX;
  int *piVar8;
  uint uVar9;
  int iVar10;
  uint uVar11;
  int local_34;
  int local_30;
  uint local_2c;
  int *local_28;
  int local_24;
  uint local_20;
  int local_1c;
  int local_18;
  byte local_14;
  undefined1 local_10 [16];
  
  iVar3 = FUN_00515840(0x68,0);
  if (iVar3 == 0) {
    local_34 = 0;
  }
  else {
    local_34 = FUN_00569220(*in_ECX,param_1,in_ECX[5],0,in_ECX[8],1);
  }
  iVar3 = in_ECX[6];
  local_30 = FUN_00525530(in_ECX[2] + iVar3 + 3);
  *(int *)(local_30 + 8) = *(int *)(local_30 + 8) + 1;
  iVar3 = iVar3 + 4 + *(int *)(local_30 + 0x10);
  uVar4 = (uint)CONCAT11(*(undefined1 *)(in_ECX[2] + 1 + iVar3),*(undefined1 *)(in_ECX[2] + iVar3));
  param_1 = iVar3 + 2;
  if (uVar4 != 0) {
    piVar8 = (int *)(local_34 + 0x50);
    local_20 = uVar4;
    do {
      iVar3 = FUN_00525530(in_ECX[2] + param_1);
      *(int *)(iVar3 + 8) = *(int *)(iVar3 + 8) + 1;
      uVar4 = *(uint *)(local_34 + 0x54);
      uVar9 = *(int *)(local_34 + 0x54) + 1;
      local_2c = uVar4;
      if (uVar9 < uVar4) {
        local_24 = uVar4 - uVar9;
        if (local_24 != 0) {
          local_28 = (int *)(*piVar8 + (local_24 + uVar9) * 8 + -4);
          do {
            piVar1 = (int *)(*local_28 + 8);
            *piVar1 = *piVar1 + -1;
            if (*piVar1 == 0) {
              FUN_00525340();
              uVar4 = local_2c;
            }
            local_28 = local_28 + -2;
            local_24 = local_24 + -1;
          } while (local_24 != 0);
        }
        uVar11 = uVar9;
        if (uVar9 < *(uint *)(local_34 + 0x58) >> 1) {
LAB_005317ee:
          FUN_0052a990(piVar8,uVar11);
          uVar4 = local_2c;
        }
      }
      else if (*(uint *)(local_34 + 0x58) <= uVar9) {
        uVar11 = (uVar9 >> 2) + uVar9;
        goto LAB_005317ee;
      }
      *(uint *)(local_34 + 0x54) = uVar9;
      if (uVar4 < uVar9) {
        puVar7 = (undefined4 *)(*piVar8 + uVar4 * 8);
        for (iVar10 = uVar9 - uVar4; iVar10 != 0; iVar10 = iVar10 + -1) {
          if (puVar7 != (undefined4 *)0x0) {
            *puVar7 = *(undefined4 *)(local_34 + 0x5c);
            iVar6 = *(int *)(local_34 + 0x60);
            puVar7[1] = iVar6;
            piVar1 = (int *)(iVar6 + 8);
            *piVar1 = *piVar1 + 1;
          }
          puVar7 = puVar7 + 2;
        }
      }
      puVar7 = (undefined4 *)(*piVar8 + -8 + *(int *)(local_34 + 0x54) * 8);
      *puVar7 = 0;
      *(int *)(iVar3 + 8) = *(int *)(iVar3 + 8) + 1;
      piVar1 = (int *)(puVar7[1] + 8);
      *piVar1 = *piVar1 + -1;
      if (*piVar1 == 0) {
        FUN_00525340();
      }
      puVar7[1] = iVar3;
      piVar1 = (int *)(iVar3 + 8);
      *piVar1 = *piVar1 + -1;
      param_1 = param_1 + 1 + *(int *)(iVar3 + 0x10);
      if (*piVar1 == 0) {
        FUN_00525340();
      }
      local_20 = local_20 - 1;
    } while (local_20 != 0);
    local_20 = 0;
  }
  uVar4 = (uint)CONCAT11(*(undefined1 *)(in_ECX[2] + 1 + param_1),
                         *(undefined1 *)(in_ECX[2] + param_1));
  *(uint *)(local_34 + 0x4c) = uVar4;
  in_ECX[5] = in_ECX[5] + uVar4;
  local_14 = 0;
  *(uint *)(local_34 + 8) = *(int *)(local_34 + 8) + 1U & 0x8fffffff;
  local_18 = 0;
  iVar3 = *(int *)(*in_ECX + 0xcc);
  local_1c = local_34;
  if ((iVar3 != 0) && (iVar3 = *(int *)(*(int *)(*in_ECX + 200) + -4 + iVar3 * 4), iVar3 != 0)) {
    FUN_005686c0(iVar3,0);
  }
  FUN_00526210(&local_1c);
  if (*(int *)(local_30 + 0x10) != 0) {
    param_1 = param_1 & 0xffffff00;
    (**(code **)(*(int *)(*(int *)(*in_ECX + 0x74) + 0x68) + 0x28))
              (*in_ECX + 0x78,&local_30,local_10,&param_1);
  }
  iVar3 = FUN_00515840(0x50,0);
  if (iVar3 == 0) {
    local_20 = 0;
  }
  else {
    uVar5 = FUN_00530910(1);
    local_20 = FUN_00568ed0(*in_ECX + 0x78,uVar5,&local_1c,0);
  }
  iVar10 = *(int *)(*in_ECX + 0x78);
  iVar3 = *(int *)(iVar10 + 0x278);
  param_1 = 7;
  if (iVar3 == 0) {
LAB_005319b9:
    FUN_005307e0(iVar10 + 0x24);
    iVar3 = *(int *)(iVar10 + 0x278);
    if (iVar3 != 0) {
      uVar4 = 0x1505;
      iVar10 = 4;
      do {
        pbVar2 = &stack0x00000003 + iVar10;
        iVar10 = iVar10 + -1;
        uVar4 = uVar4 * 0x1003f + (uint)*pbVar2;
      } while (iVar10 != 0);
      iVar10 = FUN_0052bfd0(&param_1,*(uint *)(iVar3 + 4) & uVar4);
      if (((-1 < iVar10) && (iVar3 = iVar3 + (iVar10 * 3 + 3) * 4, iVar3 != 0)) &&
         (puVar7 = (undefined4 *)(iVar3 + 4), puVar7 != (undefined4 *)0x0)) goto LAB_00531a0c;
    }
    uVar5 = 0;
  }
  else {
    uVar4 = 0x1505;
    iVar6 = 4;
    do {
      pbVar2 = &stack0x00000003 + iVar6;
      iVar6 = iVar6 + -1;
      uVar4 = uVar4 * 0x1003f + (uint)*pbVar2;
    } while (iVar6 != 0);
    iVar6 = FUN_0052bfd0(&param_1,*(uint *)(iVar3 + 4) & uVar4);
    if (((iVar6 < 0) || (iVar3 = iVar3 + (iVar6 * 3 + 3) * 4, iVar3 == 0)) ||
       (puVar7 = (undefined4 *)(iVar3 + 4), puVar7 == (undefined4 *)0x0)) goto LAB_005319b9;
LAB_00531a0c:
    uVar5 = *puVar7;
  }
  FUN_00568840(*in_ECX + 0x78,uVar5);
  uVar4 = local_20;
  FUN_00568300(*in_ECX + 0x78,local_20);
  if (*(int *)(local_30 + 0x10) == 0) {
    iVar3 = *in_ECX;
    *(int *)(iVar3 + 8) = *(int *)(iVar3 + 8) + 0x10;
    if (*(uint *)(iVar3 + 0x10) <= *(uint *)(iVar3 + 8)) {
      FUN_00504050();
    }
    if (*(int *)(iVar3 + 8) != 0) {
      FUN_005266c0(local_10);
    }
  }
  if (uVar4 != 0) {
    FUN_00503db0();
  }
  FUN_00526bc0();
  if (((local_14 & 2) == 0) && (local_1c != 0)) {
    FUN_00503db0();
  }
  local_1c = 0;
  if (((local_14 & 1) == 0) && (local_18 != 0)) {
    FUN_00503db0();
  }
  piVar8 = (int *)(local_30 + 8);
  local_18 = 0;
  *piVar8 = *piVar8 + -1;
  if (*piVar8 == 0) {
    FUN_00525340();
  }
  FUN_00503db0();
  return;
}



============================================================
DISASSEMBLY
============================================================
005316c0 : SUB ESP,0x34
005316c3 : PUSH EBX
005316c4 : PUSH EBP
005316c5 : PUSH EDI
005316c6 : MOV EDI,ECX
005316c8 : MOV EAX,dword ptr [EDI]
005316ca : MOV ECX,dword ptr [EAX + 0x78]
005316cd : MOV ECX,dword ptr [ECX + 0x288]
005316d3 : XOR EBX,EBX
005316d5 : PUSH EBX
005316d6 : PUSH 0x68
005316d8 : CALL 0x00515840
005316dd : CMP EAX,EBX
005316df : JZ 0x00531703
005316e1 : MOV ECX,dword ptr [EDI + 0x20]
005316e4 : MOV EDX,dword ptr [EDI + 0x14]
005316e7 : PUSH 0x1
005316e9 : PUSH ECX
005316ea : MOV ECX,dword ptr [ESP + 0x4c]
005316ee : PUSH EBX
005316ef : PUSH EDX
005316f0 : MOV EDX,dword ptr [EDI]
005316f2 : PUSH ECX
005316f3 : PUSH EDX
005316f4 : MOV ECX,EAX
005316f6 : CALL 0x00569220
005316fb : MOV EBP,EAX
005316fd : MOV dword ptr [ESP + 0xc],EBP
00531701 : JMP 0x00531709
00531703 : MOV dword ptr [ESP + 0xc],EBX
00531707 : MOV EBP,EBX
00531709 : MOV EAX,dword ptr [EDI + 0x8]
0053170c : MOV ECX,dword ptr [EDI]
0053170e : MOV ECX,dword ptr [ECX + 0x78]
00531711 : PUSH ESI
00531712 : MOV ESI,dword ptr [EDI + 0x18]
00531715 : ADD ESI,0x3
00531718 : ADD EAX,ESI
0053171a : PUSH EAX
0053171b : ADD ECX,0x254
00531721 : CALL 0x00525530
00531726 : MOV dword ptr [ESP + 0x14],EAX
0053172a : INC dword ptr [EAX + 0x8]
0053172d : MOV EDX,dword ptr [ESP + 0x14]
00531731 : MOV EAX,dword ptr [EDX + 0x10]
00531734 : MOV ECX,dword ptr [EDI + 0x8]
00531737 : LEA ESI,[ESI + EAX*0x1 + 0x1]
0053173b : MOVZX EAX,byte ptr [ECX + ESI*0x1 + 0x1]
00531740 : MOVZX EDX,byte ptr [ECX + ESI*0x1]
00531744 : ADD ECX,ESI
00531746 : SHL EAX,0x8
00531749 : OR EAX,EDX
0053174b : ADD ESI,0x2
0053174e : CMP EAX,EBX
00531750 : MOV dword ptr [ESP + 0x48],ESI
00531754 : JLE 0x00531881
0053175a : ADD EBP,0x50
0053175d : MOV dword ptr [ESP + 0x24],EAX
00531761 : MOV EAX,dword ptr [EDI + 0x8]
00531764 : MOV ECX,dword ptr [EDI]
00531766 : MOV ECX,dword ptr [ECX + 0x78]
00531769 : ADD EAX,ESI
0053176b : PUSH EAX
0053176c : ADD ECX,0x254
00531772 : CALL 0x00525530
00531777 : MOV EDX,dword ptr [ESP + 0x10]
0053177b : MOV EBX,EAX
0053177d : INC dword ptr [EBX + 0x8]
00531780 : MOV ESI,dword ptr [EDX + 0x54]
00531783 : MOV EDX,dword ptr [EBP + 0x4]
00531786 : INC ESI
00531787 : MOV dword ptr [ESP + 0x18],EDX
0053178b : CMP ESI,EDX
0053178d : JNC 0x005317e1
0053178f : MOV ECX,dword ptr [EBP]
00531792 : MOV EAX,EDX
00531794 : SUB EAX,ESI
00531796 : MOV dword ptr [ESP + 0x20],EAX
0053179a : LEA EAX,[EAX + ESI*0x1]
0053179d : LEA EAX,[ECX + EAX*0x8 + -0x8]
005317a1 : JZ 0x005317d5
005317a3 : MOV ECX,dword ptr [ESP + 0x20]
005317a7 : ADD EAX,0x4
005317aa : MOV dword ptr [ESP + 0x1c],EAX
005317ae : MOV dword ptr [ESP + 0x20],ECX
005317b2 : MOV ECX,dword ptr [EAX]
005317b4 : ADD dword ptr [ECX + 0x8],-0x1
005317b8 : JNZ 0x005317c3
005317ba : CALL 0x00525340
005317bf : MOV EDX,dword ptr [ESP + 0x18]
005317c3 : MOV EAX,dword ptr [ESP + 0x1c]
005317c7 : SUB EAX,0x8
005317ca : SUB dword ptr [ESP + 0x20],0x1
005317cf : MOV dword ptr [ESP + 0x1c],EAX
005317d3 : JNZ 0x005317b2
005317d5 : MOV EAX,dword ptr [EBP + 0x8]
005317d8 : SHR EAX,0x1
005317da : CMP ESI,EAX
005317dc : JNC 0x005317fa
005317de : PUSH ESI
005317df : JMP 0x005317ee
005317e1 : CMP ESI,dword ptr [EBP + 0x8]
005317e4 : JC 0x005317fa
005317e6 : MOV ECX,ESI
005317e8 : SHR ECX,0x2
005317eb : ADD ECX,ESI
005317ed : PUSH ECX
005317ee : PUSH EBP
005317ef : MOV ECX,EBP
005317f1 : CALL 0x0052a990
005317f6 : MOV EDX,dword ptr [ESP + 0x18]
005317fa : MOV dword ptr [EBP + 0x4],ESI
005317fd : CMP ESI,EDX
005317ff : JBE 0x0053182a
00531801 : SUB ESI,EDX
00531803 : MOV EAX,dword ptr [EBP]
00531806 : LEA EAX,[EAX + EDX*0x8]
00531809 : JZ 0x0053182a
0053180b : JMP 0x00531810
00531810 : TEST EAX,EAX
00531812 : JZ 0x00531822
00531814 : MOV ECX,dword ptr [EBP + 0xc]
00531817 : MOV dword ptr [EAX],ECX
00531819 : MOV ECX,dword ptr [EBP + 0x10]
0053181c : MOV dword ptr [EAX + 0x4],ECX
0053181f : INC dword ptr [ECX + 0x8]
00531822 : ADD EAX,0x8
00531825 : SUB ESI,0x1
00531828 : JNZ 0x00531810
0053182a : MOV EDX,dword ptr [EBP + 0x4]
0053182d : MOV EAX,dword ptr [EBP]
00531830 : LEA ESI,[EAX + EDX*0x8 + -0x8]
00531834 : MOV dword ptr [ESI],0x0
0053183a : INC dword ptr [EBX + 0x8]
0053183d : MOV ECX,dword ptr [ESI + 0x4]
00531840 : ADD dword ptr [ECX + 0x8],-0x1
00531844 : JNZ 0x0053184b
00531846 : CALL 0x00525340
0053184b : MOV EAX,dword ptr [ESP + 0x48]
0053184f : MOV ECX,EBX
00531851 : MOV dword ptr [ESI + 0x4],EBX
00531854 : MOV EDX,dword ptr [ECX + 0x10]
00531857 : ADD dword ptr [EBX + 0x8],-0x1
0053185b : LEA ECX,[EAX + EDX*0x1 + 0x1]
0053185f : MOV dword ptr [ESP + 0x48],ECX
00531863 : JNZ 0x0053186c
00531865 : MOV ECX,EBX
00531867 : CALL 0x00525340
0053186c : SUB dword ptr [ESP + 0x24],0x1
00531871 : MOV ESI,dword ptr [ESP + 0x48]
00531875 : JNZ 0x00531761
0053187b : MOV EBP,dword ptr [ESP + 0x10]
0053187f : XOR EBX,EBX
00531881 : MOV EDX,dword ptr [EDI + 0x8]
00531884 : MOVZX EAX,byte ptr [EDX + ESI*0x1 + 0x1]
00531889 : LEA ECX,[EDX + ESI*0x1]
0053188c : MOVZX ECX,byte ptr [ECX]
0053188f : SHL EAX,0x8
00531892 : OR EAX,ECX
00531894 : MOV dword ptr [EBP + 0x4c],EAX
00531897 : ADD dword ptr [EDI + 0x14],EAX
0053189a : MOV byte ptr [ESP + 0x30],0x0
0053189f : MOV dword ptr [ESP + 0x28],EBP
005318a3 : MOV EDX,dword ptr [EBP + 0x8]
005318a6 : INC EDX
005318a7 : AND EDX,0x8fffffff
005318ad : MOV dword ptr [EBP + 0x8],EDX
005318b0 : MOV EAX,dword ptr [EDI]
005318b2 : MOV dword ptr [ESP + 0x2c],EBX
005318b6 : MOV ECX,dword ptr [EAX + 0xcc]
005318bc : CMP ECX,EBX
005318be : JBE 0x005318d9
005318c0 : MOV EAX,dword ptr [EAX + 0xc8]
005318c6 : MOV ECX,dword ptr [EAX + ECX*0x4 + -0x4]
005318ca : CMP ECX,EBX
005318cc : JZ 0x005318d9
005318ce : PUSH EBX
005318cf : PUSH ECX
005318d0 : LEA ECX,[ESP + 0x30]
005318d4 : CALL 0x005686c0
005318d9 : LEA ECX,[ESP + 0x28]
005318dd : PUSH ECX
005318de : LEA ECX,[ESP + 0x38]
005318e2 : CALL 0x00526210
005318e7 : MOV EDX,dword ptr [ESP + 0x14]
005318eb : CMP dword ptr [EDX + 0x10],EBX
005318ee : JZ 0x00531917
005318f0 : MOV EAX,dword ptr [EDI]
005318f2 : MOV ECX,dword ptr [EAX + 0x74]
005318f5 : LEA ESI,[ESP + 0x48]
005318f9 : PUSH ESI
005318fa : LEA ESI,[ESP + 0x38]
005318fe : PUSH ESI
005318ff : ADD ECX,0x68
00531902 : LEA ESI,[ESP + 0x1c]
00531906 : ADD EAX,0x78
00531909 : MOV byte ptr [ESP + 0x50],0x0
0053190e : MOV EDX,dword ptr [ECX]
00531910 : PUSH ESI
00531911 : PUSH EAX
00531912 : MOV EAX,dword ptr [EDX + 0x28]
00531915 : CALL EAX
00531917 : MOV ECX,dword ptr [EDI]
00531919 : MOV EDX,dword ptr [ECX + 0x78]
0053191c : MOV ECX,dword ptr [EDX + 0x288]
00531922 : PUSH EBX
00531923 : PUSH 0x50
00531925 : CALL 0x00515840
0053192a : MOV ESI,EAX
0053192c : CMP ESI,EBX
0053192e : JZ 0x00531956
00531930 : MOV EAX,dword ptr [EDI]
00531932 : MOV ECX,dword ptr [EAX + 0x78]
00531935 : PUSH 0x1
00531937 : CALL 0x00530910
0053193c : MOV ECX,dword ptr [EDI]
0053193e : PUSH EBX
0053193f : LEA EDX,[ESP + 0x2c]
00531943 : PUSH EDX
00531944 : ADD ECX,0x78
00531947 : PUSH EAX
00531948 : PUSH ECX
00531949 : MOV ECX,ESI
0053194b : CALL 0x00568ed0
00531950 : MOV dword ptr [ESP + 0x24],EAX
00531954 : JMP 0x0053195a
00531956 : MOV dword ptr [ESP + 0x24],EBX
0053195a : MOV EAX,dword ptr [EDI]
0053195c : MOV EBP,dword ptr [EAX + 0x78]
0053195f : MOV ESI,dword ptr [EBP + 0x278]
00531965 : LEA EBX,[EBP + 0x278]
0053196b : MOV dword ptr [ESP + 0x48],0x7
00531973 : TEST ESI,ESI
00531975 : JZ 0x005319b9
00531977 : MOV ECX,0x1505
0053197c : MOV EAX,0x4
00531981 : MOVZX EDX,byte ptr [ESP + EAX*0x1 + 0x47]
00531986 : IMUL ECX,ECX,0x1003f
0053198c : DEC EAX
0053198d : ADD ECX,EDX
0053198f : TEST EAX,EAX
00531991 : JA 0x00531981
00531993 : MOV EAX,dword ptr [ESI + 0x4]
00531996 : AND EAX,ECX
00531998 : PUSH EAX
00531999 : LEA ECX,[ESP + 0x4c]
0053199d : PUSH ECX
0053199e : MOV ECX,EBX
005319a0 : CALL 0x0052bfd0
005319a5 : TEST EAX,EAX
005319a7 : JL 0x005319b9
005319a9 : LEA EDX,[EAX + EAX*0x2 + 0x3]
005319ad : LEA EAX,[ESI + EDX*0x4]
005319b0 : TEST EAX,EAX
005319b2 : JZ 0x005319b9
005319b4 : ADD EAX,0x4
005319b7 : JNZ 0x00531a0c
005319b9 : LEA EAX,[EBP + 0x24]
005319bc : PUSH EAX
005319bd : MOV ECX,EBP
005319bf : CALL 0x005307e0
005319c4 : MOV ESI,dword ptr [EBX]
005319c6 : TEST ESI,ESI
005319c8 : JZ 0x00531a10
005319ca : MOV ECX,0x1505
005319cf : MOV EAX,0x4
005319d4 : MOVZX EDX,byte ptr [ESP + EAX*0x1 + 0x47]
005319d9 : IMUL ECX,ECX,0x1003f
005319df : DEC EAX
005319e0 : ADD ECX,EDX
005319e2 : TEST EAX,EAX
005319e4 : JA 0x005319d4
005319e6 : MOV EAX,dword ptr [ESI + 0x4]
005319e9 : AND EAX,ECX
005319eb : PUSH EAX
005319ec : LEA ECX,[ESP + 0x4c]
005319f0 : PUSH ECX
005319f1 : MOV ECX,EBX
005319f3 : CALL 0x0052bfd0
005319f8 : TEST EAX,EAX
005319fa : JL 0x00531a10
005319fc : LEA EDX,[EAX + EAX*0x2 + 0x3]
00531a00 : LEA EAX,[ESI + EDX*0x4]
00531a03 : TEST EAX,EAX
00531a05 : JZ 0x00531a10
00531a07 : ADD EAX,0x4
00531a0a : JZ 0x00531a10
00531a0c : MOV EAX,dword ptr [EAX]
00531a0e : JMP 0x00531a12
00531a10 : XOR EAX,EAX
00531a12 : MOV ECX,dword ptr [ESP + 0x28]
00531a16 : PUSH EAX
00531a17 : MOV EAX,dword ptr [EDI]
00531a19 : ADD EAX,0x78
00531a1c : PUSH EAX
00531a1d : CALL 0x00568840
00531a22 : MOV ECX,dword ptr [EDI]
00531a24 : MOV ESI,dword ptr [ESP + 0x24]
00531a28 : MOV EBX,dword ptr [ESP + 0x10]
00531a2c : ADD ECX,0x78
00531a2f : PUSH ESI
00531a30 : PUSH ECX
00531a31 : MOV ECX,EBX
00531a33 : CALL 0x00568300
00531a38 : MOV EDX,dword ptr [ESP + 0x14]
00531a3c : XOR EBP,EBP
00531a3e : CMP dword ptr [EDX + 0x10],EBP
00531a41 : JNZ 0x00531a6d
00531a43 : MOV EDI,dword ptr [EDI]
00531a45 : ADD dword ptr [EDI + 0x8],0x10
00531a49 : MOV EAX,dword ptr [EDI + 0x8]
00531a4c : ADD EDI,0x8
00531a4f : CMP EAX,dword ptr [EDI + 0x8]
00531a52 : JC 0x00531a5b
00531a54 : MOV ECX,EDI
00531a56 : CALL 0x00504050
00531a5b : MOV EDI,dword ptr [EDI]
00531a5d : CMP EDI,EBP
00531a5f : JZ 0x00531a6d
00531a61 : LEA EAX,[ESP + 0x34]
00531a65 : PUSH EAX
00531a66 : MOV ECX,EDI
00531a68 : CALL 0x005266c0
00531a6d : CMP ESI,EBP
00531a6f : JZ 0x00531a78
00531a71 : MOV ECX,ESI
00531a73 : CALL 0x00503db0
00531a78 : LEA ECX,[ESP + 0x34]
00531a7c : CALL 0x00526bc0
00531a81 : TEST byte ptr [ESP + 0x30],0x2
00531a86 : POP ESI
00531a87 : JNZ 0x00531a96
00531a89 : MOV ECX,dword ptr [ESP + 0x24]
00531a8d : CMP ECX,EBP
00531a8f : JZ 0x00531a96
00531a91 : CALL 0x00503db0
00531a96 : TEST byte ptr [ESP + 0x2c],0x1
00531a9b : MOV dword ptr [ESP + 0x24],EBP
00531a9f : JNZ 0x00531aae
00531aa1 : MOV ECX,dword ptr [ESP + 0x28]
00531aa5 : CMP ECX,EBP
00531aa7 : JZ 0x00531aae
00531aa9 : CALL 0x00503db0
00531aae : MOV EAX,dword ptr [ESP + 0x10]
00531ab2 : MOV ECX,EAX
00531ab4 : ADD EAX,0x8
00531ab7 : MOV dword ptr [ESP + 0x28],EBP
00531abb : DEC dword ptr [EAX]
00531abd : CMP dword ptr [EAX],EBP
00531abf : JNZ 0x00531ac6
00531ac1 : CALL 0x00525340
00531ac6 : MOV ECX,EBX
00531ac8 : CALL 0x00503db0
00531acd : POP EDI
00531ace : POP EBP
00531acf : POP EBX
00531ad0 : ADD ESP,0x34
00531ad3 : RET 0x4

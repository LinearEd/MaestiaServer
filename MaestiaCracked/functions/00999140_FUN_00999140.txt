PROGRAM  : Maestia.exe
FUNCTION : FUN_00999140
ENTRY    : 00999140
BODY     : [[00999140, 0099926a]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00999140(int param_1,int param_2)

{
  uint uVar1;
  undefined4 uVar2;
  int iVar3;
  short in_CX;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  puStack_c = &LAB_00b5b5ae;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_8 = 0;
  *(undefined4 *)(param_1 + 0x18) = 7;
  *(undefined4 *)(param_1 + 0x14) = 0;
  *(undefined2 *)(param_1 + 4) = 0;
  FUN_00406360(&DAT_00c875fc,0);
  local_8 = 0;
  if (in_CX == -4) {
    FUN_00406360(L"$login",6);
  }
  else if (in_CX == -1) {
    FUN_00406360(L"$unconnection",0xd);
  }
  else if ((in_CX == -3) || (param_2 == 0)) {
    FUN_00405c00(param_1);
  }
  else {
    iVar3 = FUN_00703c00(0x300,uVar1);
    if (iVar3 != 0) {
      uVar2 = FUN_00824a20(DAT_0172491c,0);
      local_8 = 1;
      FUN_00405d70(uVar2);
      local_8 = local_8 & 0xffffff00;
      FUN_00406560();
    }
  }
  iVar3 = FUN_00405bb0(&DAT_00c87650);
  if (iVar3 == 0) {
    FUN_00406360(L"$unconnection",0xd);
  }
  ExceptionList = local_10;
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
00999140 : PUSH EBP
00999141 : MOV EBP,ESP
00999143 : PUSH -0x1
00999145 : PUSH 0xb5b5ae
0099914a : MOV EAX,FS:[0x0]
00999150 : PUSH EAX
00999151 : SUB ESP,0x24
00999154 : PUSH EBX
00999155 : PUSH ESI
00999156 : PUSH EDI
00999157 : MOV EAX,[0x00d66fa0]
0099915c : XOR EAX,EBP
0099915e : PUSH EAX
0099915f : LEA EAX,[EBP + -0xc]
00999162 : MOV FS:[0x0],EAX
00999168 : MOV EDI,ECX
0099916a : XOR ESI,ESI
0099916c : MOV dword ptr [EBP + -0x4],ESI
0099916f : MOV EBX,dword ptr [EBP + 0x8]
00999172 : MOV dword ptr [EBP + -0x10],ESI
00999175 : PUSH ESI
00999176 : XOR EAX,EAX
00999178 : MOV dword ptr [EBX + 0x18],0x7
0099917f : MOV dword ptr [EBX + 0x14],ESI
00999182 : PUSH 0xc875fc
00999187 : MOV ECX,EBX
00999189 : MOV dword ptr [EBP + -0x14],EBX
0099918c : MOV word ptr [EBX + 0x4],AX
00999190 : CALL 0x00406360
00999195 : MOV dword ptr [EBP + -0x4],ESI
00999198 : MOV ECX,0xfffc
0099919d : MOV dword ptr [EBP + -0x10],0x1
009991a4 : CMP DI,CX
009991a7 : JNZ 0x009991b9
009991a9 : PUSH 0x6
009991ab : PUSH 0xc87600
009991b0 : MOV ECX,EBX
009991b2 : CALL 0x00406360
009991b7 : JMP 0x00999234
009991b9 : MOV EDX,0xffff
009991be : CMP DI,DX
009991c1 : JNZ 0x009991d3
009991c3 : PUSH 0xd
009991c5 : PUSH 0xc87610
009991ca : MOV ECX,EBX
009991cc : CALL 0x00406360
009991d1 : JMP 0x00999234
009991d3 : MOV EAX,0xfffd
009991d8 : CMP DI,AX
009991db : JNZ 0x009991e4
009991dd : MOV EDX,0xc8762c
009991e2 : JMP 0x0099922e
009991e4 : CMP dword ptr [EBP + 0xc],ESI
009991e7 : JZ 0x00999229
009991e9 : PUSH 0x300
009991ee : CALL 0x00703c00
009991f3 : ADD ESP,0x4
009991f6 : CMP EAX,ESI
009991f8 : JZ 0x00999234
009991fa : MOV ECX,dword ptr [0x0172491c]
00999200 : PUSH ESI
00999201 : LEA EDX,[EAX + 0x18]
00999204 : PUSH ECX
00999205 : LEA ESI,[EBP + -0x30]
00999208 : CALL 0x00824a20
0099920d : MOV dword ptr [EBP + -0x4],0x1
00999214 : PUSH EAX
00999215 : MOV ECX,EBX
00999217 : CALL 0x00405d70
0099921c : MOV byte ptr [EBP + -0x4],0x0
00999220 : MOV ECX,ESI
00999222 : CALL 0x00406560
00999227 : JMP 0x00999234
00999229 : MOV EDX,0xc87640
0099922e : PUSH EBX
0099922f : CALL 0x00405c00
00999234 : MOV EAX,dword ptr [EBX + 0x14]
00999237 : PUSH 0xc87650
0099923c : XOR EDI,EDI
0099923e : MOV ECX,EBX
00999240 : CALL 0x00405bb0
00999245 : TEST EAX,EAX
00999247 : JNZ 0x00999257
00999249 : PUSH 0xd
0099924b : PUSH 0xc87654
00999250 : MOV ECX,EBX
00999252 : CALL 0x00406360
00999257 : MOV EAX,EBX
00999259 : MOV ECX,dword ptr [EBP + -0xc]
0099925c : MOV dword ptr FS:[0x0],ECX
00999263 : POP ECX
00999264 : POP EDI
00999265 : POP ESI
00999266 : POP EBX
00999267 : MOV ESP,EBP
00999269 : POP EBP
0099926a : RET

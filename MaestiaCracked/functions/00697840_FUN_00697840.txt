PROGRAM  : Maestia.exe
FUNCTION : FUN_00697840
ENTRY    : 00697840
BODY     : [[00697840, 00697a02]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00697840(undefined4 param_1)

{
  undefined1 *puVar1;
  int *piVar2;
  undefined1 *puVar3;
  int iVar4;
  int iVar5;
  int in_ECX;
  uint uVar6;
  int iVar7;
  int iVar8;
  uint uVar9;
  uint local_10;
  
  piVar2 = (int *)(in_ECX + 0x31c);
  *piVar2 = 0;
  *(undefined4 *)(in_ECX + 800) = 0;
  *(undefined4 *)(in_ECX + 0x324) = 0;
  *(undefined4 *)(in_ECX + 0x328) = 0;
  *(undefined4 *)(in_ECX + 0x32c) = 0;
  *(undefined4 *)(in_ECX + 0x330) = 0;
  iVar4 = FUN_00690910();
  if (((iVar4 != 0) || (local_10 < 8)) ||
     (iVar4 = FUN_0068a1f0(param_1,local_10,piVar2), iVar4 != 0)) {
    return 8;
  }
  puVar3 = (undefined1 *)*piVar2;
  *(undefined1 **)(in_ECX + 800) = puVar3 + local_10;
  uVar9 = (uint)CONCAT11(puVar3[2],puVar3[3]);
  uVar6 = CONCAT31(CONCAT21(CONCAT11(puVar3[4],puVar3[5]),puVar3[6]),puVar3[7]);
  if (((CONCAT11(*puVar3,puVar3[1]) == 1) && (7 < uVar6)) &&
     ((uVar9 <= uVar6 - 8 >> 2 && (uVar6 + 1 <= local_10)))) {
    iVar7 = *piVar2 + 8;
    *(uint *)(in_ECX + 0x324) = *piVar2 + uVar6;
    iVar5 = 0;
    iVar8 = 0;
    iVar4 = iVar7 + uVar9 * 4;
    *(uint *)(in_ECX + 0x32c) = uVar9;
    *(uint *)(in_ECX + 0x328) = local_10 - uVar6;
    if (1 < uVar9) {
      local_10 = (uVar9 - 2 >> 1) + 1;
      do {
        puVar3 = (undefined1 *)(iVar7 + 7);
        iVar5 = iVar5 + (uint)CONCAT11(*(undefined1 *)(iVar7 + 2),*(undefined1 *)(iVar7 + 3)) * 10;
        puVar1 = (undefined1 *)(iVar7 + 6);
        iVar7 = iVar7 + 8;
        uVar9 = uVar9 - 2;
        local_10 = local_10 + -1;
        iVar8 = iVar8 + (uint)CONCAT11(*puVar1,*puVar3) * 10;
      } while (local_10 != 0);
    }
    if (uVar9 != 0) {
      iVar4 = iVar4 + (uint)CONCAT11(*(undefined1 *)(iVar7 + 2),*(undefined1 *)(iVar7 + 3)) * 10;
    }
    if ((uint)(iVar8 + iVar5 + iVar4) <= *piVar2 + uVar6) {
      *(undefined1 *)(in_ECX + 0x330) = 1;
      return 0;
    }
  }
  FUN_006888c0(param_1,piVar2);
  *piVar2 = 0;
  *(undefined4 *)(in_ECX + 800) = 0;
  *(undefined4 *)(in_ECX + 0x324) = 0;
  *(undefined4 *)(in_ECX + 0x328) = 0;
  *(undefined4 *)(in_ECX + 0x32c) = 0;
  *(undefined4 *)(in_ECX + 0x330) = 0;
  return 8;
}



============================================================
DISASSEMBLY
============================================================
00697840 : SUB ESP,0x10
00697843 : PUSH EBX
00697844 : XOR EAX,EAX
00697846 : PUSH ESI
00697847 : LEA ESI,[ECX + 0x31c]
0069784d : MOV dword ptr [ESI],EAX
0069784f : MOV dword ptr [ESI + 0x4],EAX
00697852 : MOV dword ptr [ESI + 0x8],EAX
00697855 : MOV dword ptr [ESI + 0xc],EAX
00697858 : PUSH EDI
00697859 : MOV EDI,dword ptr [ESP + 0x20]
0069785d : MOV dword ptr [ESI + 0x10],EAX
00697860 : MOV dword ptr [ESI + 0x14],EAX
00697863 : LEA EAX,[ESP + 0xc]
00697867 : PUSH EAX
00697868 : PUSH EDI
00697869 : PUSH 0x42444620
0069786e : PUSH ECX
0069786f : CALL 0x00690910
00697874 : ADD ESP,0x10
00697877 : TEST EAX,EAX
00697879 : JNZ 0x006979f7
0069787f : MOV EBX,dword ptr [ESP + 0xc]
00697883 : CMP EBX,0x8
00697886 : JC 0x006979f7
0069788c : PUSH ESI
0069788d : PUSH EBX
0069788e : PUSH EDI
0069788f : CALL 0x0068a1f0
00697894 : ADD ESP,0xc
00697897 : MOV dword ptr [ESP + 0x18],EAX
0069789b : TEST EAX,EAX
0069789d : JNZ 0x006979f7
006978a3 : MOV EDX,dword ptr [ESI]
006978a5 : LEA ECX,[EDX + EBX*0x1]
006978a8 : MOV dword ptr [ESI + 0x4],ECX
006978ab : MOVZX AX,byte ptr [EDX]
006978af : MOVZX ECX,byte ptr [EDX + 0x1]
006978b3 : ADD EDX,0x2
006978b6 : SHL AX,0x8
006978ba : ADD EDX,0x2
006978bd : MOVZX EAX,AX
006978c0 : OR EAX,ECX
006978c2 : MOVZX CX,byte ptr [EDX + -0x2]
006978c7 : SHL CX,0x8
006978cb : MOVZX EDI,CX
006978ce : MOVZX ECX,byte ptr [EDX + -0x1]
006978d2 : OR EDI,ECX
006978d4 : MOVZX ECX,byte ptr [EDX]
006978d7 : ADD EDX,0x4
006978da : SHL ECX,0x8
006978dd : PUSH EBP
006978de : MOVZX EBP,byte ptr [EDX + -0x3]
006978e2 : OR ECX,EBP
006978e4 : MOVZX EBP,byte ptr [EDX + -0x2]
006978e8 : MOVZX EDX,byte ptr [EDX + -0x1]
006978ec : SHL ECX,0x8
006978ef : OR ECX,EBP
006978f1 : SHL ECX,0x8
006978f4 : OR ECX,EDX
006978f6 : CMP EAX,0x1
006978f9 : JNZ 0x006979c9
006978ff : CMP ECX,0x8
00697902 : JC 0x006979c9
00697908 : LEA EAX,[ECX + -0x8]
0069790b : SHR EAX,0x2
0069790e : CMP EAX,EDI
00697910 : JC 0x006979c9
00697916 : LEA EDX,[ECX + 0x1]
00697919 : CMP EDX,EBX
0069791b : JA 0x006979c9
00697921 : MOV EDX,dword ptr [ESI]
00697923 : ADD EDX,ECX
00697925 : SUB EBX,ECX
00697927 : MOV ECX,dword ptr [ESI]
00697929 : ADD ECX,0x8
0069792c : MOV dword ptr [ESP + 0x18],EDX
00697930 : MOV dword ptr [ESI + 0x8],EDX
00697933 : XOR EAX,EAX
00697935 : XOR EBP,EBP
00697937 : CMP EDI,0x2
0069793a : LEA EDX,[ECX + EDI*0x4]
0069793d : MOV dword ptr [ESI + 0x10],EDI
00697940 : MOV dword ptr [ESI + 0xc],EBX
00697943 : MOV dword ptr [ESP + 0x14],EDX
00697947 : JL 0x00697993
00697949 : LEA EDX,[EDI + -0x2]
0069794c : SHR EDX,0x1
0069794e : INC EDX
0069794f : MOV dword ptr [ESP + 0x10],EDX
00697953 : MOVZX EDX,byte ptr [ECX + 0x2]
00697957 : MOVZX EBX,byte ptr [ECX + 0x3]
0069795b : SHL DX,0x8
0069795f : MOVZX EDX,DX
00697962 : OR EDX,EBX
00697964 : MOVZX EBX,byte ptr [ECX + 0x7]
00697968 : LEA EDX,[EDX + EDX*0x4]
0069796b : LEA EAX,[EAX + EDX*0x2]
0069796e : MOVZX EDX,byte ptr [ECX + 0x6]
00697972 : SHL DX,0x8
00697976 : MOVZX EDX,DX
00697979 : OR EDX,EBX
0069797b : LEA EDX,[EDX + EDX*0x4]
0069797e : ADD ECX,0x8
00697981 : SUB EDI,0x2
00697984 : SUB dword ptr [ESP + 0x10],0x1
00697989 : LEA EBP,[EBP + EDX*0x2]
0069798d : JNZ 0x00697953
0069798f : MOV EDX,dword ptr [ESP + 0x14]
00697993 : TEST EDI,EDI
00697995 : JBE 0x006979af
00697997 : MOVZX DI,byte ptr [ECX + 0x2]
0069799c : MOVZX ECX,byte ptr [ECX + 0x3]
006979a0 : SHL DI,0x8
006979a4 : MOVZX EDI,DI
006979a7 : OR EDI,ECX
006979a9 : LEA ECX,[EDI + EDI*0x4]
006979ac : LEA EDX,[EDX + ECX*0x2]
006979af : ADD EBP,EAX
006979b1 : ADD EBP,EDX
006979b3 : CMP EBP,dword ptr [ESP + 0x18]
006979b7 : JA 0x006979c9
006979b9 : MOV EAX,dword ptr [ESP + 0x1c]
006979bd : POP EBP
006979be : POP EDI
006979bf : MOV byte ptr [ESI + 0x14],0x1
006979c3 : POP ESI
006979c4 : POP EBX
006979c5 : ADD ESP,0x10
006979c8 : RET
006979c9 : MOV EDX,dword ptr [ESP + 0x24]
006979cd : PUSH ESI
006979ce : PUSH EDX
006979cf : CALL 0x006888c0
006979d4 : ADD ESP,0x8
006979d7 : XOR EAX,EAX
006979d9 : MOV dword ptr [ESI],EAX
006979db : MOV dword ptr [ESI + 0x4],EAX
006979de : MOV dword ptr [ESI + 0x8],EAX
006979e1 : MOV dword ptr [ESI + 0xc],EAX
006979e4 : POP EBP
006979e5 : MOV dword ptr [ESI + 0x10],EAX
006979e8 : POP EDI
006979e9 : MOV dword ptr [ESI + 0x14],EAX
006979ec : POP ESI
006979ed : MOV EAX,0x8
006979f2 : POP EBX
006979f3 : ADD ESP,0x10
006979f6 : RET
006979f7 : POP EDI
006979f8 : POP ESI
006979f9 : MOV EAX,0x8
006979fe : POP EBX
006979ff : ADD ESP,0x10
00697a02 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_006bf770
ENTRY    : 006bf770
BODY     : [[006bf770, 006bf8fc] [006bf900, 006bf9fe]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_006bf770(int *param_1,undefined1 *param_2,uint param_3)

{
  uint uVar1;
  int *piVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  uint uVar7;
  uint local_c;
  uint local_8;
  uint local_4;
  
  uVar4 = param_3;
  piVar2 = param_1;
  local_8 = param_1[0x11];
  uVar1 = param_1[0x10];
  local_4 = param_1[0x12];
  uVar7 = 0;
  local_c = uVar1;
  if (param_3 != 0) {
    iVar5 = *param_1;
    if (iVar5 == 0) {
      iVar5 = FUN_006877c0(param_1[0x29],2);
      if ((iVar5 == 0) && (iVar5 = FUN_006878c0(piVar2[0x29],&param_1,1), iVar5 == 1)) {
        uVar6 = (uint)param_1 & 0x1f;
        iVar5 = 1 << (sbyte)uVar6;
        piVar2[10] = uVar6;
        piVar2[0xb] = (uint)param_1 & 0x80;
        piVar2[0xc] = iVar5 + -0x100;
        if (uVar6 < 0x11) {
          piVar2[0xd] = 9;
          local_4 = 0;
          iVar3 = 0x100;
          piVar2[0xe] = (uint)(((uint)param_1 & 0x80) != 0);
          if (uVar6 < 10) {
            iVar3 = iVar5 + -0xff;
          }
          piVar2[0xf] = iVar3;
          local_c = FUN_006bf4e0();
          if (-1 < (int)local_c) {
            if (param_2 != (undefined1 *)0x0) {
              *param_2 = (char)local_c;
            }
            uVar7 = 1;
            local_8 = local_c;
            if (1 < uVar4) {
              *piVar2 = 1;
              goto LAB_006bf87b;
            }
            goto LAB_006bf9e1;
          }
        }
      }
LAB_006bf9da:
      local_c = uVar1;
      *piVar2 = 3;
    }
    else {
      if (iVar5 == 1) goto LAB_006bf87b;
      if (iVar5 == 2) {
        do {
          iVar5 = piVar2[0x17];
          while (iVar5 != 0) {
            piVar2[0x17] = piVar2[0x17] + -1;
            if (param_2 != (undefined1 *)0x0) {
              param_2[uVar7] = *(undefined1 *)(piVar2[0x17] + piVar2[0x16]);
            }
            uVar7 = uVar7 + 1;
            if (uVar7 == param_3) goto LAB_006bf9e1;
            iVar5 = piVar2[0x17];
          }
          if ((uint)piVar2[0xe] < (uint)piVar2[0xc]) {
            if (((uint)piVar2[0x15] <= (uint)piVar2[0xe]) &&
               (iVar5 = FUN_006bf610(), uVar1 = local_c, iVar5 < 0)) goto LAB_006bf9da;
            *(undefined2 *)(piVar2[0x13] + piVar2[0xe] * 2) = (undefined2)local_c;
            *(undefined1 *)(piVar2[0x14] + piVar2[0xe]) = (undefined1)local_8;
            piVar2[0xe] = piVar2[0xe] + 1;
          }
          local_c = local_4;
          *piVar2 = 1;
LAB_006bf87b:
          uVar4 = FUN_006bf4e0();
          uVar1 = local_c;
          if ((int)uVar4 < 0) goto LAB_006bf9da;
          if ((uVar4 == 0x100) && (piVar2[0xb] != 0)) {
            piVar2[0xe] = 0;
            *(undefined1 *)(piVar2 + 8) = 1;
            uVar4 = FUN_006bf4e0();
            if ((int)uVar4 < 0) goto LAB_006bf9da;
          }
          local_4 = uVar4;
          if (0xff < uVar4) {
            if ((uint)piVar2[0xe] <= uVar4 - 0x100) {
              if (((uint)piVar2[0x18] <= (uint)piVar2[0x17]) && (iVar5 = FUN_006bf5b0(), iVar5 < 0))
              goto LAB_006bf9da;
              *(undefined1 *)(piVar2[0x16] + piVar2[0x17]) = (undefined1)local_8;
              piVar2[0x17] = piVar2[0x17] + 1;
              uVar4 = local_c;
            }
            for (; 0xff < uVar4; uVar4 = (uint)*(ushort *)(piVar2[0x13] + -0x200 + uVar4 * 2)) {
              if (((uint)piVar2[0x18] <= (uint)piVar2[0x17]) && (iVar5 = FUN_006bf5b0(), iVar5 < 0))
              goto LAB_006bf9da;
              *(undefined1 *)(piVar2[0x16] + piVar2[0x17]) =
                   *(undefined1 *)(piVar2[0x14] + -0x100 + uVar4);
              piVar2[0x17] = piVar2[0x17] + 1;
            }
          }
          local_8 = uVar4;
          if (((uint)piVar2[0x18] <= (uint)piVar2[0x17]) && (iVar5 = FUN_006bf5b0(), iVar5 < 0))
          goto LAB_006bf9da;
          *(char *)(piVar2[0x16] + piVar2[0x17]) = (char)uVar4;
          piVar2[0x17] = piVar2[0x17] + 1;
          *piVar2 = 2;
        } while( true );
      }
    }
  }
LAB_006bf9e1:
  piVar2[0x11] = local_8;
  piVar2[0x10] = local_c;
  piVar2[0x12] = local_4;
  return uVar7;
}



============================================================
DISASSEMBLY
============================================================
006bf770 : SUB ESP,0xc
006bf773 : PUSH EBX
006bf774 : MOV EBX,dword ptr [ESP + 0x1c]
006bf778 : PUSH EBP
006bf779 : PUSH ESI
006bf77a : MOV ESI,dword ptr [ESP + 0x1c]
006bf77e : MOV EAX,dword ptr [ESI + 0x44]
006bf781 : MOV ECX,dword ptr [ESI + 0x40]
006bf784 : MOV EDX,dword ptr [ESI + 0x48]
006bf787 : XOR EBP,EBP
006bf789 : MOV dword ptr [ESP + 0x10],EAX
006bf78d : MOV dword ptr [ESP + 0xc],ECX
006bf791 : MOV dword ptr [ESP + 0x14],EDX
006bf795 : TEST EBX,EBX
006bf797 : JZ 0x006bf9e1
006bf79d : MOV EAX,dword ptr [ESI]
006bf79f : SUB EAX,EBP
006bf7a1 : PUSH EDI
006bf7a2 : JZ 0x006bf7be
006bf7a4 : MOV EDI,0x1
006bf7a9 : SUB EAX,EDI
006bf7ab : JZ 0x006bf87b
006bf7b1 : SUB EAX,EDI
006bf7b3 : JNZ 0x006bf9e0
006bf7b9 : JMP 0x006bf96d
006bf7be : MOV EAX,dword ptr [ESI + 0xa4]
006bf7c4 : PUSH 0x2
006bf7c6 : PUSH EAX
006bf7c7 : CALL 0x006877c0
006bf7cc : ADD ESP,0x8
006bf7cf : TEST EAX,EAX
006bf7d1 : JNZ 0x006bf9da
006bf7d7 : MOV EDX,dword ptr [ESI + 0xa4]
006bf7dd : PUSH 0x1
006bf7df : LEA ECX,[ESP + 0x24]
006bf7e3 : PUSH ECX
006bf7e4 : PUSH EDX
006bf7e5 : CALL 0x006878c0
006bf7ea : ADD ESP,0xc
006bf7ed : CMP EAX,0x1
006bf7f0 : JNZ 0x006bf9da
006bf7f6 : MOVZX EAX,byte ptr [ESP + 0x20]
006bf7fb : MOV ECX,EAX
006bf7fd : AND ECX,0x1f
006bf800 : MOV EDI,0x1
006bf805 : SHL EDI,CL
006bf807 : AND EAX,0x80
006bf80c : MOV dword ptr [ESI + 0x28],ECX
006bf80f : MOV dword ptr [ESI + 0x2c],EAX
006bf812 : ADD EDI,0xffffff00
006bf818 : MOV dword ptr [ESI + 0x30],EDI
006bf81b : CMP ECX,0x10
006bf81e : JA 0x006bf9da
006bf824 : XOR EDX,EDX
006bf826 : TEST EAX,EAX
006bf828 : SETNZ DL
006bf82b : MOV dword ptr [ESI + 0x34],0x9
006bf832 : MOV dword ptr [ESP + 0x18],EBP
006bf836 : MOV EAX,0x100
006bf83b : MOV dword ptr [ESI + 0x38],EDX
006bf83e : CMP ECX,0x9
006bf841 : JA 0x006bf846
006bf843 : LEA EAX,[EDI + 0x1]
006bf846 : MOV dword ptr [ESI + 0x3c],EAX
006bf849 : MOV EAX,ESI
006bf84b : CALL 0x006bf4e0
006bf850 : TEST EAX,EAX
006bf852 : JL 0x006bf9da
006bf858 : MOV ECX,dword ptr [ESP + 0x24]
006bf85c : MOV dword ptr [ESP + 0x14],EAX
006bf860 : MOV dword ptr [ESP + 0x10],EAX
006bf864 : TEST ECX,ECX
006bf866 : JZ 0x006bf86a
006bf868 : MOV byte ptr [ECX],AL
006bf86a : MOV EBP,0x1
006bf86f : CMP EBX,EBP
006bf871 : JBE 0x006bf9e0
006bf877 : MOV dword ptr [ESI],EBP
006bf879 : MOV EDI,EBP
006bf87b : MOV EAX,ESI
006bf87d : CALL 0x006bf4e0
006bf882 : TEST EAX,EAX
006bf884 : JL 0x006bf9da
006bf88a : MOV EBX,EAX
006bf88c : CMP EAX,0x100
006bf891 : JNZ 0x006bf8b5
006bf893 : CMP dword ptr [ESI + 0x2c],0x0
006bf897 : JZ 0x006bf8b5
006bf899 : MOV EAX,ESI
006bf89b : MOV dword ptr [ESI + 0x38],0x0
006bf8a2 : MOV byte ptr [ESI + 0x20],0x1
006bf8a6 : CALL 0x006bf4e0
006bf8ab : TEST EAX,EAX
006bf8ad : JL 0x006bf9da
006bf8b3 : MOV EBX,EAX
006bf8b5 : MOV dword ptr [ESP + 0x18],EAX
006bf8b9 : CMP EAX,0x100
006bf8be : JC 0x006bf93e
006bf8c0 : ADD EAX,0xffffff00
006bf8c5 : CMP EAX,dword ptr [ESI + 0x38]
006bf8c8 : JC 0x006bf8f3
006bf8ca : MOV EAX,dword ptr [ESI + 0x5c]
006bf8cd : CMP EAX,dword ptr [ESI + 0x60]
006bf8d0 : JC 0x006bf8df
006bf8d2 : CALL 0x006bf5b0
006bf8d7 : TEST EAX,EAX
006bf8d9 : JL 0x006bf9da
006bf8df : MOV EDX,dword ptr [ESI + 0x5c]
006bf8e2 : MOV ECX,dword ptr [ESI + 0x58]
006bf8e5 : MOV AL,byte ptr [ESP + 0x14]
006bf8e9 : MOV EBX,dword ptr [ESP + 0x10]
006bf8ed : MOV byte ptr [ECX + EDX*0x1],AL
006bf8f0 : ADD dword ptr [ESI + 0x5c],EDI
006bf8f3 : CMP EBX,0x100
006bf8f9 : JC 0x006bf93e
006bf8fb : JMP 0x006bf900
006bf900 : MOV ECX,dword ptr [ESI + 0x5c]
006bf903 : CMP ECX,dword ptr [ESI + 0x60]
006bf906 : JC 0x006bf915
006bf908 : CALL 0x006bf5b0
006bf90d : TEST EAX,EAX
006bf90f : JL 0x006bf9da
006bf915 : MOV EDX,dword ptr [ESI + 0x50]
006bf918 : MOV DL,byte ptr [EDX + EBX*0x1 + 0xffffff00]
006bf91f : MOV EAX,dword ptr [ESI + 0x58]
006bf922 : MOV ECX,dword ptr [ESI + 0x5c]
006bf925 : MOV byte ptr [EAX + ECX*0x1],DL
006bf928 : ADD dword ptr [ESI + 0x5c],EDI
006bf92b : MOV EAX,dword ptr [ESI + 0x4c]
006bf92e : MOVZX EBX,word ptr [EAX + EBX*0x2 + 0xfffffe00]
006bf936 : CMP EBX,0x100
006bf93c : JNC 0x006bf900
006bf93e : MOV ECX,dword ptr [ESI + 0x5c]
006bf941 : MOV dword ptr [ESP + 0x14],EBX
006bf945 : CMP ECX,dword ptr [ESI + 0x60]
006bf948 : JC 0x006bf957
006bf94a : CALL 0x006bf5b0
006bf94f : TEST EAX,EAX
006bf951 : JL 0x006bf9da
006bf957 : MOV EAX,dword ptr [ESI + 0x5c]
006bf95a : MOV EDX,dword ptr [ESI + 0x58]
006bf95d : MOV byte ptr [EDX + EAX*0x1],BL
006bf960 : ADD dword ptr [ESI + 0x5c],EDI
006bf963 : MOV EBX,dword ptr [ESP + 0x28]
006bf967 : MOV dword ptr [ESI],0x2
006bf96d : CMP dword ptr [ESI + 0x5c],0x0
006bf971 : JBE 0x006bf996
006bf973 : DEC dword ptr [ESI + 0x5c]
006bf976 : MOV ECX,dword ptr [ESP + 0x24]
006bf97a : MOV EAX,dword ptr [ESI + 0x5c]
006bf97d : TEST ECX,ECX
006bf97f : JZ 0x006bf98a
006bf981 : MOV EDX,dword ptr [ESI + 0x58]
006bf984 : MOV AL,byte ptr [EAX + EDX*0x1]
006bf987 : MOV byte ptr [ECX + EBP*0x1],AL
006bf98a : ADD EBP,EDI
006bf98c : CMP EBP,EBX
006bf98e : JZ 0x006bf9e0
006bf990 : CMP dword ptr [ESI + 0x5c],0x0
006bf994 : JA 0x006bf973
006bf996 : MOV EAX,dword ptr [ESI + 0x38]
006bf999 : CMP EAX,dword ptr [ESI + 0x30]
006bf99c : JNC 0x006bf9cb
006bf99e : CMP EAX,dword ptr [ESI + 0x54]
006bf9a1 : JC 0x006bf9ac
006bf9a3 : CALL 0x006bf610
006bf9a8 : TEST EAX,EAX
006bf9aa : JL 0x006bf9da
006bf9ac : MOV ECX,dword ptr [ESI + 0x38]
006bf9af : MOV EDX,dword ptr [ESI + 0x4c]
006bf9b2 : MOV AX,word ptr [ESP + 0x10]
006bf9b7 : MOV word ptr [EDX + ECX*0x2],AX
006bf9bb : MOV EDX,dword ptr [ESI + 0x38]
006bf9be : MOV ECX,dword ptr [ESI + 0x50]
006bf9c1 : MOV AL,byte ptr [ESP + 0x14]
006bf9c5 : MOV byte ptr [ECX + EDX*0x1],AL
006bf9c8 : ADD dword ptr [ESI + 0x38],EDI
006bf9cb : MOV ECX,dword ptr [ESP + 0x18]
006bf9cf : MOV dword ptr [ESP + 0x10],ECX
006bf9d3 : MOV dword ptr [ESI],EDI
006bf9d5 : JMP 0x006bf87b
006bf9da : MOV dword ptr [ESI],0x3
006bf9e0 : POP EDI
006bf9e1 : MOV EAX,dword ptr [ESP + 0x10]
006bf9e5 : MOV EDX,dword ptr [ESP + 0xc]
006bf9e9 : MOV ECX,dword ptr [ESP + 0x14]
006bf9ed : MOV dword ptr [ESI + 0x44],EAX
006bf9f0 : MOV dword ptr [ESI + 0x40],EDX
006bf9f3 : MOV dword ptr [ESI + 0x48],ECX
006bf9f6 : POP ESI
006bf9f7 : MOV EAX,EBP
006bf9f9 : POP EBP
006bf9fa : POP EBX
006bf9fb : ADD ESP,0xc
006bf9fe : RET

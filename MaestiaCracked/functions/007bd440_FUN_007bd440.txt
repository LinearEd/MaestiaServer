PROGRAM  : Maestia.exe
FUNCTION : FUN_007bd440
ENTRY    : 007bd440
BODY     : [[007bd440, 007bd594]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_007bd440(int *param_1,int param_2)

{
  int *piVar1;
  int iVar2;
  undefined4 uVar3;
  int in_ECX;
  undefined1 local_4c [32];
  LPCRITICAL_SECTION local_2c;
  char *local_28;
  undefined4 local_24;
  int local_20;
  undefined4 local_1c;
  undefined1 local_18 [8];
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  piVar1 = param_1;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b19d30;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_2c = (LPCRITICAL_SECTION)(in_ECX + 4);
  local_20 = 0;
  local_28 = ".\\mss\\AvaMssMgr.cpp";
  local_24 = 0x340;
  local_1c = 1;
  FUN_006ef1a0(&local_2c);
  local_8 = 0;
  if ((piVar1 != (int *)0x0) && (*(int *)(in_ECX + 0x20) != 0)) {
    if ((*piVar1 != 0) && (iVar2 = _AIL_sample_status_4(*piVar1), iVar2 == 4)) {
      _AIL_end_sample_4(*piVar1);
    }
    if ((piVar1[10] != 0) && ((param_2 == 1 || (param_2 == 2)))) {
      uVar3 = FUN_0043c130(local_4c,&param_1);
      local_8._0_1_ = 1;
      FUN_004645b0(in_ECX + 0x84,local_18,uVar3);
      local_8 = (uint)local_8._1_3_ << 8;
      FUN_0044cb00(local_4c);
      local_8 = 0xffffffff;
      if (local_20 != 0) {
        LeaveCriticalSection(local_2c);
      }
      ExceptionList = local_10;
      return 1;
    }
  }
  if (local_20 != 0) {
    local_8 = 0xffffffff;
    LeaveCriticalSection(local_2c);
  }
  ExceptionList = local_10;
  return 0;
}



============================================================
DISASSEMBLY
============================================================
007bd440 : PUSH EBP
007bd441 : MOV EBP,ESP
007bd443 : PUSH -0x1
007bd445 : PUSH 0xb19d30
007bd44a : MOV EAX,FS:[0x0]
007bd450 : PUSH EAX
007bd451 : SUB ESP,0x3c
007bd454 : PUSH EBX
007bd455 : PUSH ESI
007bd456 : PUSH EDI
007bd457 : MOV EAX,[0x00d66fa0]
007bd45c : XOR EAX,EBP
007bd45e : PUSH EAX
007bd45f : LEA EAX,[EBP + -0xc]
007bd462 : MOV FS:[0x0],EAX
007bd468 : MOV ESI,dword ptr [EBP + 0x8]
007bd46b : MOV EDI,ECX
007bd46d : LEA ECX,[EBP + -0x28]
007bd470 : LEA EAX,[EDI + 0x4]
007bd473 : XOR EBX,EBX
007bd475 : PUSH ECX
007bd476 : MOV dword ptr [EBP + -0x1c],EBX
007bd479 : MOV dword ptr [EBP + -0x28],EAX
007bd47c : MOV dword ptr [EBP + -0x24],0xc18ef8
007bd483 : MOV dword ptr [EBP + -0x20],0x340
007bd48a : MOV dword ptr [EBP + -0x18],0x1
007bd491 : CALL 0x006ef1a0
007bd496 : MOV dword ptr [EBP + -0x4],EBX
007bd499 : CMP ESI,EBX
007bd49b : JNZ 0x007bd4b6
007bd49d : MOV dword ptr [EBP + -0x4],0xffffffff
007bd4a4 : CMP dword ptr [EBP + -0x1c],EBX
007bd4a7 : JZ 0x007bd57f
007bd4ad : MOV EDX,dword ptr [EBP + -0x28]
007bd4b0 : PUSH EDX
007bd4b1 : JMP 0x007bd576
007bd4b6 : CMP dword ptr [EDI + 0x20],EBX
007bd4b9 : JNZ 0x007bd4d4
007bd4bb : MOV dword ptr [EBP + -0x4],0xffffffff
007bd4c2 : CMP dword ptr [EBP + -0x1c],EBX
007bd4c5 : JZ 0x007bd57f
007bd4cb : MOV EAX,dword ptr [EBP + -0x28]
007bd4ce : PUSH EAX
007bd4cf : JMP 0x007bd576
007bd4d4 : MOV EAX,dword ptr [ESI]
007bd4d6 : CMP EAX,EBX
007bd4d8 : JZ 0x007bd4f4
007bd4da : PUSH EAX
007bd4db : CALL dword ptr [0x00b85708]
007bd4e1 : CMP EAX,0x4
007bd4e4 : SETZ AL
007bd4e7 : CMP AL,BL
007bd4e9 : JZ 0x007bd4f4
007bd4eb : MOV ECX,dword ptr [ESI]
007bd4ed : PUSH ECX
007bd4ee : CALL dword ptr [0x00b856f4]
007bd4f4 : CMP dword ptr [ESI + 0x28],EBX
007bd4f7 : JZ 0x007bd566
007bd4f9 : MOV EAX,dword ptr [EBP + 0xc]
007bd4fc : CMP EAX,0x1
007bd4ff : JZ 0x007bd506
007bd501 : CMP EAX,0x2
007bd504 : JNZ 0x007bd566
007bd506 : LEA EDX,[EBP + 0x8]
007bd509 : PUSH EDX
007bd50a : LEA EAX,[EBP + -0x48]
007bd50d : LEA ECX,[ESI + 0x14]
007bd510 : PUSH EAX
007bd511 : CALL 0x0043c130
007bd516 : MOV byte ptr [EBP + -0x4],0x1
007bd51a : PUSH EAX
007bd51b : LEA ECX,[EBP + -0x14]
007bd51e : PUSH ECX
007bd51f : ADD EDI,0x84
007bd525 : PUSH EDI
007bd526 : CALL 0x004645b0
007bd52b : MOV byte ptr [EBP + -0x4],BL
007bd52e : LEA EDX,[EBP + -0x48]
007bd531 : PUSH EDX
007bd532 : CALL 0x0044cb00
007bd537 : MOV dword ptr [EBP + -0x4],0xffffffff
007bd53e : CMP dword ptr [EBP + -0x1c],EBX
007bd541 : JZ 0x007bd550
007bd543 : MOV EAX,dword ptr [EBP + -0x28]
007bd546 : PUSH EAX
007bd547 : CALL dword ptr [0x00b8511c]
007bd54d : MOV dword ptr [EBP + -0x1c],EBX
007bd550 : MOV AL,0x1
007bd552 : MOV ECX,dword ptr [EBP + -0xc]
007bd555 : MOV dword ptr FS:[0x0],ECX
007bd55c : POP ECX
007bd55d : POP EDI
007bd55e : POP ESI
007bd55f : POP EBX
007bd560 : MOV ESP,EBP
007bd562 : POP EBP
007bd563 : RET 0x8
007bd566 : MOV dword ptr [EBP + -0x4],0xffffffff
007bd56d : CMP dword ptr [EBP + -0x1c],EBX
007bd570 : JZ 0x007bd57f
007bd572 : MOV ECX,dword ptr [EBP + -0x28]
007bd575 : PUSH ECX
007bd576 : CALL dword ptr [0x00b8511c]
007bd57c : MOV dword ptr [EBP + -0x1c],EBX
007bd57f : XOR AL,AL
007bd581 : MOV ECX,dword ptr [EBP + -0xc]
007bd584 : MOV dword ptr FS:[0x0],ECX
007bd58b : POP ECX
007bd58c : POP EDI
007bd58d : POP ESI
007bd58e : POP EBX
007bd58f : MOV ESP,EBP
007bd591 : POP EBP
007bd592 : RET 0x8

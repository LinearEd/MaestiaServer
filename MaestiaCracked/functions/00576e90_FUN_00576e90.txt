PROGRAM  : Maestia.exe
FUNCTION : FUN_00576e90
ENTRY    : 00576e90
BODY     : [[00576e90, 005774ad]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00576e90(void)

{
  int *piVar1;
  int iVar2;
  int *piVar3;
  int *piVar4;
  GRefCountNTSImpl *pGVar5;
  uint *puVar6;
  undefined4 uVar7;
  int in_ECX;
  bool bVar8;
  int **ppiVar9;
  undefined4 uVar10;
  undefined4 uStack_14;
  int *piStack_c;
  int *piStack_8;
  undefined4 uStack_4;
  
  bVar8 = *(int *)(*(int *)(in_ECX + 0x14) + 0x28) == 1;
  if (*(char *)(*(int *)(in_ECX + 0x10) + 100) == '\0') {
    if (bVar8) {
      if ((*(int *)(in_ECX + 0x20) == 0) && (*(int *)(*(int *)(in_ECX + 0x10) + 0x14) != 0)) {
        iVar2 = FUN_0051d0c0(*(undefined4 *)(in_ECX + 0xc));
        if (iVar2 != 0) {
          *(int *)(iVar2 + 4) = *(int *)(iVar2 + 4) + 1;
        }
        if (*(GRefCountNTSImpl **)(in_ECX + 0x20) != (GRefCountNTSImpl *)0x0) {
          GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(in_ECX + 0x20));
        }
        *(int *)(in_ECX + 0x20) = iVar2;
        if (iVar2 == 0) {
          return 1;
        }
        *(undefined4 *)(in_ECX + 0x24) = *(undefined4 *)(iVar2 + 0x10);
      }
      piVar3 = (int *)FUN_0056b260(0);
      if (piVar3 == (int *)0x0) {
        return 1;
      }
      iVar2 = (**(code **)(*piVar3 + 0x5c))();
      piVar4 = (int *)FUN_00526fa0(iVar2);
      bVar8 = *(char *)(*(int *)(iVar2 + 0x78) + 0x2a4) == '\x01';
      piVar3 = *(int **)(*(int *)(in_ECX + 0x14) + 0x24);
      uStack_14 = CONCAT13(bVar8,(undefined3)uStack_14);
      if (piVar3 == (int *)0x0) {
        if (*(int *)(*(int *)(in_ECX + 0x10) + 0x14) == 0) {
          iVar2 = *(int *)(*(int *)(in_ECX + 0x10) + 0x10);
          if (iVar2 != -1) {
            iVar2 = FUN_0056b260(iVar2);
            if (iVar2 != 0) {
              *(int *)(iVar2 + 4) = *(int *)(iVar2 + 4) + 1;
            }
            if (*(GRefCountNTSImpl **)(in_ECX + 0x20) != (GRefCountNTSImpl *)0x0) {
              GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(in_ECX + 0x20));
            }
            *(int *)(in_ECX + 0x20) = iVar2;
          }
        }
        else {
          piVar3 = *(int **)(*(int *)(in_ECX + 0x20) + 0x20);
          if (piVar3 == (int *)0x0) {
            return 1;
          }
          uVar10 = 0x10001;
          ppiVar9 = &piStack_8;
          (**(code **)(*piVar3 + 0x48))(ppiVar9,0x10001);
          FUN_00565f40(ppiVar9,uVar10);
          pGVar5 = (GRefCountNTSImpl *)
                   (**(code **)(*piStack_8 + 0x24))(piVar3,*(undefined4 *)(in_ECX + 0x24),uStack_4);
          *(undefined4 *)(pGVar5 + 0x18) = *(undefined4 *)(*(int *)(in_ECX + 0x20) + 0x18);
          *(undefined4 *)(pGVar5 + 0x14) = *(undefined4 *)(*(int *)(in_ECX + 0x20) + 0x14);
          piVar1 = *(int **)(in_ECX + 0x20);
          if (((uint)piVar1[0x23] >> 0xe & 1) == 0) {
            iVar2 = piVar1[0x20];
            if ((iVar2 == 0) && (iVar2 = FUN_00520df0(), iVar2 == 0)) {
              iVar2 = (**(code **)(*piVar1 + 0x58))();
              iVar2 = *(int *)(iVar2 + 0x78);
            }
            (**(code **)(*(int *)pGVar5 + 0x20))(iVar2 + 8);
          }
          FUN_0051d570(*(undefined4 *)(in_ECX + 0xc));
          (**(code **)(*piVar3 + 0x110))(*(undefined4 *)(in_ECX + 0x20),pGVar5);
          *(int *)(pGVar5 + 4) = *(int *)(pGVar5 + 4) + 1;
          if (*(GRefCountNTSImpl **)(in_ECX + 0x20) != (GRefCountNTSImpl *)0x0) {
            GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(in_ECX + 0x20));
          }
          *(GRefCountNTSImpl **)(in_ECX + 0x20) = pGVar5;
          GRefCountNTSImpl::Release(pGVar5);
        }
        if ((*(int **)(in_ECX + 0x20) != (int *)0x0) && (piVar4 != (int *)0x0)) {
          uVar10 = (**(code **)(**(int **)(in_ECX + 0x20) + 0x5c))();
          (**(code **)(*piVar4 + 0x30))(uVar10,*(undefined4 *)(in_ECX + 0x20),"URLNotFound",0);
        }
        iVar2 = *(int *)(*(int *)(in_ECX + 0x10) + 0x10);
        if (iVar2 != -1) {
          FUN_00575ac0(iVar2);
        }
        return 1;
      }
      piStack_c = piVar4;
      if (*(char *)(in_ECX + 0x28) == '\0') {
        iVar2 = *(int *)(*(int *)(in_ECX + 0x10) + 0x10);
        piStack_c = (int *)0x0;
        if (iVar2 == -1) {
          if ((*(int *)(*(int *)(in_ECX + 0x10) + 0x14) != 0) &&
             (piStack_c = *(int **)(*(int *)(in_ECX + 0x20) + 0x20), piStack_c == (int *)0x0)) {
            return 1;
          }
        }
        else {
          FUN_00575ac0(iVar2);
          *(undefined4 *)(in_ECX + 0x24) = 0x40000;
        }
        iVar2 = FUN_00515840(0x1cc,0);
        if (iVar2 == 0) {
          pGVar5 = (GRefCountNTSImpl *)0x0;
        }
        else {
          pGVar5 = (GRefCountNTSImpl *)
                   FUN_00595530(*(undefined4 *)(piVar3[7] + 0xc),piVar3,
                                *(undefined4 *)(in_ECX + 0xc),piStack_c,
                                *(undefined4 *)(in_ECX + 0x24),1);
        }
        if (!bVar8) {
          *(uint *)(pGVar5 + 0x8c) = *(uint *)(pGVar5 + 0x8c) | 4;
        }
        if (*(int *)(*(int *)(in_ECX + 0x10) + 0x14) == 0) {
          FUN_00590220(*(undefined4 *)(*(int *)(in_ECX + 0x10) + 0x10));
          FUN_00574b60(*(undefined4 *)(*(int *)(in_ECX + 0x10) + 0x10),pGVar5);
          puVar6 = (uint *)(*(int *)(in_ECX + 0xc) + 0xb00);
          *puVar6 = *puVar6 & 0xfffffeff;
        }
        else {
          FUN_0051d570(*(undefined4 *)(in_ECX + 0xc));
          *(undefined4 *)(pGVar5 + 0x18) = *(undefined4 *)(*(int *)(in_ECX + 0x20) + 0x18);
          *(undefined4 *)(pGVar5 + 0x14) = *(undefined4 *)(*(int *)(in_ECX + 0x20) + 0x14);
          piVar1 = *(int **)(in_ECX + 0x20);
          if (((uint)piVar1[0x23] >> 0xe & 1) == 0) {
            iVar2 = piVar1[0x20];
            if ((iVar2 == 0) && (iVar2 = FUN_00520df0(), iVar2 == 0)) {
              iVar2 = (**(code **)(*piVar1 + 0x58))();
              iVar2 = *(int *)(iVar2 + 0x78);
            }
            (**(code **)(*(int *)pGVar5 + 0x20))(iVar2 + 8);
          }
          (**(code **)(*piStack_c + 0x114))(*(undefined4 *)(in_ECX + 0x20),pGVar5);
        }
        (**(code **)(*(int *)pGVar5 + 0x124))(1);
        *(int *)(pGVar5 + 4) = *(int *)(pGVar5 + 4) + 1;
        if (*(GRefCountNTSImpl **)(in_ECX + 0x20) != (GRefCountNTSImpl *)0x0) {
          GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(in_ECX + 0x20));
        }
        *(GRefCountNTSImpl **)(in_ECX + 0x20) = pGVar5;
        if (piVar4 != (int *)0x0) {
          piStack_c = (int *)(**(code **)(*(int *)pGVar5 + 0x5c))();
          (**(code **)(*piVar4 + 0x24))(piStack_c,*(undefined4 *)(in_ECX + 0x20));
          uVar10 = *(undefined4 *)(piVar3[7] + 0x80);
          *(undefined4 *)(in_ECX + 0x2c) = uVar10;
          (**(code **)(*piVar4 + 0x34))
                    (uStack_14,*(undefined4 *)(in_ECX + 0x20),uVar10,
                     *(undefined4 *)(*(int *)(*(int *)(piVar3[7] + 0xc) + 0x20) + 0x28));
        }
        *(undefined1 *)(in_ECX + 0x28) = 1;
        GRefCountNTSImpl::Release(pGVar5);
      }
      if ((*(int *)(in_ECX + 0x2c) != *(int *)(piVar3[7] + 0x80)) && (piVar4 != (int *)0x0)) {
        uVar7 = (**(code **)(**(int **)(in_ECX + 0x20) + 0x5c))();
        uVar10 = *(undefined4 *)(piVar3[7] + 0x80);
        *(undefined4 *)(in_ECX + 0x2c) = uVar10;
        (**(code **)(*piVar4 + 0x34))
                  (uVar7,*(undefined4 *)(in_ECX + 0x20),uVar10,
                   *(undefined4 *)(*(int *)(*(int *)(piVar3[7] + 0xc) + 0x20) + 0x28));
      }
      if (((bVar8) && (*(char *)(in_ECX + 0x30) == '\0')) &&
         ((*(uint *)(piVar3[7] + 0x74) & 0x100) != 0)) {
        iVar2 = *(int *)(*(int *)(in_ECX + 0x10) + 0x10);
        if (iVar2 == -1) {
          pGVar5 = (GRefCountNTSImpl *)FUN_0054ed10();
        }
        else {
          pGVar5 = (GRefCountNTSImpl *)FUN_0056b260(iVar2);
        }
        if (pGVar5 != (GRefCountNTSImpl *)0x0) {
          *(int *)(pGVar5 + 4) = *(int *)(pGVar5 + 4) + 1;
          (**(code **)(*(int *)pGVar5 + 0x124))(0);
          uVar10 = (**(code **)(*piVar3 + 0x14))();
          FUN_00589b70(piStack_c,uVar10);
          FUN_0058eeb0();
          FUN_00575410();
          if (piVar4 != (int *)0x0) {
            uVar10 = (**(code **)(*(int *)pGVar5 + 0x5c))();
            (**(code **)(*piVar4 + 0x2c))(uVar10,pGVar5);
          }
        }
        *(undefined1 *)(in_ECX + 0x30) = 1;
        if (pGVar5 != (GRefCountNTSImpl *)0x0) {
          GRefCountNTSImpl::Release(pGVar5);
        }
      }
      if (1 < ((byte)*(undefined4 *)(piVar3[7] + 0x74) & 3)) {
        if ((*(uint *)(piVar3[7] + 0x74) & 2) == 0) {
          if (piVar4 != (int *)0x0) {
            uVar10 = (**(code **)(**(int **)(in_ECX + 0x20) + 0x5c))();
            if (*(int *)(*(int *)(*(int *)(piVar3[7] + 0xc) + 0x20) + 0x74) == 4) {
              (**(code **)(*piVar4 + 0x30))(uVar10,*(undefined4 *)(in_ECX + 0x20),"Error",0);
              return 1;
            }
            (**(code **)(*piVar4 + 0x30))(uVar10,*(undefined4 *)(in_ECX + 0x20),"Canceled",0);
          }
        }
        else {
          iVar2 = *(int *)(*(int *)(in_ECX + 0x10) + 0x10);
          if (iVar2 == -1) {
            pGVar5 = (GRefCountNTSImpl *)FUN_0054ed10();
            if (pGVar5 != (GRefCountNTSImpl *)0x0) {
              *(int *)(pGVar5 + 4) = *(int *)(pGVar5 + 4) + 1;
            }
            FUN_00576ae0(*(undefined4 *)(in_ECX + 0x20));
          }
          else {
            pGVar5 = (GRefCountNTSImpl *)FUN_0056b260(iVar2);
            if (pGVar5 != (GRefCountNTSImpl *)0x0) {
              *(int *)(pGVar5 + 4) = *(int *)(pGVar5 + 4) + 1;
            }
          }
          if (pGVar5 != (GRefCountNTSImpl *)0x0) {
            if (!bVar8) {
              *(uint *)(pGVar5 + 0x8c) = *(uint *)(pGVar5 + 0x8c) & 0xfffffffb;
            }
            if (piVar4 != (int *)0x0) {
              uVar10 = (**(code **)(*(int *)pGVar5 + 0x5c))();
              (**(code **)(*piVar4 + 0x28))(uVar10,pGVar5,0);
            }
            if (*(char *)(in_ECX + 0x30) == '\0') {
              (**(code **)(*(int *)pGVar5 + 0x124))(0);
              uVar10 = (**(code **)(*piVar3 + 0x14))();
              FUN_00589b70(piStack_c,uVar10);
              FUN_0058eeb0();
              FUN_00575410();
              if (piVar4 != (int *)0x0) {
                uVar10 = (**(code **)(*(int *)pGVar5 + 0x5c))();
                (**(code **)(*piVar4 + 0x2c))(uVar10,pGVar5);
              }
            }
            *(undefined1 *)(in_ECX + 0x30) = 1;
            GRefCountNTSImpl::Release(pGVar5);
            return 1;
          }
        }
        return 1;
      }
    }
  }
  else if (bVar8) {
    return 1;
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00576e90 : SUB ESP,0x14
00576e93 : PUSH EBX
00576e94 : PUSH EBP
00576e95 : PUSH ESI
00576e96 : MOV ESI,ECX
00576e98 : MOV EAX,dword ptr [ESI + 0x14]
00576e9b : MOV EAX,dword ptr [EAX + 0x28]
00576e9e : CMP EAX,0x1
00576ea1 : MOV EAX,dword ptr [ESI + 0x10]
00576ea4 : SETZ CL
00576ea7 : CMP byte ptr [EAX + 0x64],0x0
00576eab : PUSH EDI
00576eac : JZ 0x00576ec0
00576eae : TEST CL,CL
00576eb0 : JZ 0x005774a4
00576eb6 : MOV AL,0x1
00576eb8 : POP EDI
00576eb9 : POP ESI
00576eba : POP EBP
00576ebb : POP EBX
00576ebc : ADD ESP,0x14
00576ebf : RET
00576ec0 : TEST CL,CL
00576ec2 : JZ 0x005774a4
00576ec8 : CMP dword ptr [ESI + 0x20],0x0
00576ecc : JNZ 0x00576f04
00576ece : MOV EAX,dword ptr [EAX + 0x14]
00576ed1 : TEST EAX,EAX
00576ed3 : JZ 0x00576f04
00576ed5 : MOV ECX,dword ptr [ESI + 0xc]
00576ed8 : PUSH ECX
00576ed9 : MOV ECX,EAX
00576edb : CALL 0x0051d0c0
00576ee0 : MOV EDI,EAX
00576ee2 : TEST EDI,EDI
00576ee4 : JZ 0x00576ee9
00576ee6 : INC dword ptr [EDI + 0x4]
00576ee9 : MOV ECX,dword ptr [ESI + 0x20]
00576eec : TEST ECX,ECX
00576eee : JZ 0x00576ef5
00576ef0 : CALL 0x004ff7c0
00576ef5 : MOV EAX,EDI
00576ef7 : MOV dword ptr [ESI + 0x20],EDI
00576efa : TEST EAX,EAX
00576efc : JZ 0x00576eb6
00576efe : MOV EAX,dword ptr [EAX + 0x10]
00576f01 : MOV dword ptr [ESI + 0x24],EAX
00576f04 : MOV ECX,dword ptr [ESI + 0xc]
00576f07 : PUSH 0x0
00576f09 : CALL 0x0056b260
00576f0e : TEST EAX,EAX
00576f10 : JZ 0x00576eb6
00576f12 : MOV EDX,dword ptr [EAX]
00576f14 : MOV ECX,EAX
00576f16 : MOV EAX,dword ptr [EDX + 0x5c]
00576f19 : CALL EAX
00576f1b : MOV ECX,dword ptr [ESI + 0x10]
00576f1e : MOV EDI,EAX
00576f20 : PUSH EDI
00576f21 : ADD ECX,0x1c
00576f24 : CALL 0x00526fa0
00576f29 : MOV EDI,dword ptr [EDI + 0x78]
00576f2c : CMP byte ptr [EDI + 0x2a4],0x1
00576f33 : MOV EBX,EAX
00576f35 : MOV EAX,dword ptr [ESI + 0x14]
00576f38 : MOV EBP,dword ptr [EAX + 0x24]
00576f3b : SETZ byte ptr [ESP + 0x13]
00576f40 : MOV dword ptr [ESP + 0x18],EBX
00576f44 : TEST EBP,EBP
00576f46 : JNZ 0x0057709d
00576f4c : MOV EAX,dword ptr [ESI + 0x10]
00576f4f : MOV ECX,dword ptr [EAX + 0x14]
00576f52 : TEST ECX,ECX
00576f54 : JZ 0x0057702f
00576f5a : MOV EAX,dword ptr [ESI + 0x20]
00576f5d : MOV EBP,dword ptr [EAX + 0x20]
00576f60 : TEST EBP,EBP
00576f62 : JZ 0x00576eb6
00576f68 : PUSH ECX
00576f69 : MOV EAX,ESP
00576f6b : MOV dword ptr [EAX],0x10001
00576f71 : MOV EDX,dword ptr [EBP]
00576f74 : MOV EAX,dword ptr [EDX + 0x48]
00576f77 : LEA ECX,[ESP + 0x20]
00576f7b : PUSH ECX
00576f7c : MOV ECX,EBP
00576f7e : CALL EAX
00576f80 : MOV ECX,EAX
00576f82 : CALL 0x00565f40
00576f87 : MOV ECX,dword ptr [ESP + 0x20]
00576f8b : MOV EDX,dword ptr [ESI + 0x24]
00576f8e : PUSH ECX
00576f8f : PUSH ECX
00576f90 : MOV EAX,ESP
00576f92 : MOV dword ptr [EAX],EDX
00576f94 : MOV ECX,dword ptr [ESP + 0x24]
00576f98 : MOV EAX,dword ptr [ECX]
00576f9a : MOV EDX,dword ptr [EAX + 0x24]
00576f9d : PUSH EBP
00576f9e : CALL EDX
00576fa0 : MOV EDI,EAX
00576fa2 : MOV EAX,dword ptr [ESI + 0x20]
00576fa5 : MOV ECX,dword ptr [EAX + 0x18]
00576fa8 : MOV dword ptr [EDI + 0x18],ECX
00576fab : MOV EDX,dword ptr [ESI + 0x20]
00576fae : MOV EAX,dword ptr [EDX + 0x14]
00576fb1 : MOV dword ptr [EDI + 0x14],EAX
00576fb4 : MOV EBX,dword ptr [ESI + 0x20]
00576fb7 : MOV ECX,dword ptr [EBX + 0x8c]
00576fbd : SHR ECX,0xe
00576fc0 : TEST CL,0x1
00576fc3 : JNZ 0x00576ff3
00576fc5 : MOV EAX,dword ptr [EBX + 0x80]
00576fcb : TEST EAX,EAX
00576fcd : JNZ 0x00576fe6
00576fcf : MOV ECX,EBX
00576fd1 : CALL 0x00520df0
00576fd6 : TEST EAX,EAX
00576fd8 : JNZ 0x00576fe6
00576fda : MOV EDX,dword ptr [EBX]
00576fdc : MOV EAX,dword ptr [EDX + 0x58]
00576fdf : MOV ECX,EBX
00576fe1 : CALL EAX
00576fe3 : MOV EAX,dword ptr [EAX + 0x78]
00576fe6 : MOV EDX,dword ptr [EDI]
00576fe8 : ADD EAX,0x8
00576feb : PUSH EAX
00576fec : MOV EAX,dword ptr [EDX + 0x20]
00576fef : MOV ECX,EDI
00576ff1 : CALL EAX
00576ff3 : MOV ECX,dword ptr [ESI + 0xc]
00576ff6 : PUSH ECX
00576ff7 : MOV ECX,EDI
00576ff9 : CALL 0x0051d570
00576ffe : MOV EDX,dword ptr [EBP]
00577001 : MOV EAX,dword ptr [ESI + 0x20]
00577004 : MOV EDX,dword ptr [EDX + 0x110]
0057700a : PUSH EDI
0057700b : PUSH EAX
0057700c : MOV ECX,EBP
0057700e : CALL EDX
00577010 : INC dword ptr [EDI + 0x4]
00577013 : MOV ECX,dword ptr [ESI + 0x20]
00577016 : TEST ECX,ECX
00577018 : JZ 0x0057701f
0057701a : CALL 0x004ff7c0
0057701f : MOV ECX,EDI
00577021 : MOV dword ptr [ESI + 0x20],EDI
00577024 : CALL 0x004ff7c0
00577029 : MOV EBX,dword ptr [ESP + 0x18]
0057702d : JMP 0x00577058
0057702f : MOV EAX,dword ptr [EAX + 0x10]
00577032 : CMP EAX,-0x1
00577035 : JZ 0x00577058
00577037 : MOV ECX,dword ptr [ESI + 0xc]
0057703a : PUSH EAX
0057703b : CALL 0x0056b260
00577040 : MOV EDI,EAX
00577042 : TEST EDI,EDI
00577044 : JZ 0x00577049
00577046 : INC dword ptr [EDI + 0x4]
00577049 : MOV ECX,dword ptr [ESI + 0x20]
0057704c : TEST ECX,ECX
0057704e : JZ 0x00577055
00577050 : CALL 0x004ff7c0
00577055 : MOV dword ptr [ESI + 0x20],EDI
00577058 : MOV ECX,dword ptr [ESI + 0x20]
0057705b : TEST ECX,ECX
0057705d : JZ 0x0057707f
0057705f : TEST EBX,EBX
00577061 : JZ 0x0057707f
00577063 : MOV EAX,dword ptr [ECX]
00577065 : MOV EDX,dword ptr [EAX + 0x5c]
00577068 : CALL EDX
0057706a : MOV ECX,dword ptr [ESI + 0x20]
0057706d : MOV EDX,dword ptr [EBX]
0057706f : MOV EDX,dword ptr [EDX + 0x30]
00577072 : PUSH 0x0
00577074 : PUSH 0xb8d298
00577079 : PUSH ECX
0057707a : PUSH EAX
0057707b : MOV ECX,EBX
0057707d : CALL EDX
0057707f : MOV EAX,dword ptr [ESI + 0x10]
00577082 : MOV EAX,dword ptr [EAX + 0x10]
00577085 : CMP EAX,-0x1
00577088 : JZ 0x00577093
0057708a : MOV ECX,dword ptr [ESI + 0xc]
0057708d : PUSH EAX
0057708e : CALL 0x00575ac0
00577093 : MOV AL,0x1
00577095 : POP EDI
00577096 : POP ESI
00577097 : POP EBP
00577098 : POP EBX
00577099 : ADD ESP,0x14
0057709c : RET
0057709d : CMP byte ptr [ESI + 0x28],0x0
005770a1 : JNZ 0x0057724f
005770a7 : MOV EAX,dword ptr [ESI + 0x10]
005770aa : MOV ECX,dword ptr [EAX + 0x10]
005770ad : MOV dword ptr [ESP + 0x18],0x0
005770b5 : CMP ECX,-0x1
005770b8 : JZ 0x005770cc
005770ba : PUSH ECX
005770bb : MOV ECX,dword ptr [ESI + 0xc]
005770be : CALL 0x00575ac0
005770c3 : MOV dword ptr [ESI + 0x24],0x40000
005770ca : JMP 0x005770e4
005770cc : CMP dword ptr [EAX + 0x14],0x0
005770d0 : JZ 0x005770e4
005770d2 : MOV EAX,dword ptr [ESI + 0x20]
005770d5 : MOV EAX,dword ptr [EAX + 0x20]
005770d8 : MOV dword ptr [ESP + 0x18],EAX
005770dc : TEST EAX,EAX
005770de : JZ 0x00576eb6
005770e4 : MOV ECX,dword ptr [ESI + 0xc]
005770e7 : MOV ECX,dword ptr [ECX + 0x14]
005770ea : PUSH 0x0
005770ec : PUSH 0x1cc
005770f1 : CALL 0x00515840
005770f6 : TEST EAX,EAX
005770f8 : JZ 0x00577120
005770fa : PUSH 0x1
005770fc : PUSH ECX
005770fd : MOV ECX,dword ptr [ESI + 0x24]
00577100 : MOV EDX,ESP
00577102 : MOV dword ptr [EDX],ECX
00577104 : MOV ECX,dword ptr [ESP + 0x20]
00577108 : MOV EDX,dword ptr [EBP + 0x1c]
0057710b : MOV EDX,dword ptr [EDX + 0xc]
0057710e : PUSH ECX
0057710f : MOV ECX,dword ptr [ESI + 0xc]
00577112 : PUSH ECX
00577113 : PUSH EBP
00577114 : PUSH EDX
00577115 : MOV ECX,EAX
00577117 : CALL 0x00595530
0057711c : MOV EDI,EAX
0057711e : JMP 0x00577122
00577120 : XOR EDI,EDI
00577122 : CMP byte ptr [ESP + 0x13],0x0
00577127 : JNZ 0x00577130
00577129 : OR dword ptr [EDI + 0x8c],0x4
00577130 : MOV EAX,dword ptr [ESI + 0x10]
00577133 : CMP dword ptr [EAX + 0x14],0x0
00577137 : MOV ECX,EDI
00577139 : JZ 0x005771b2
0057713b : MOV EDX,dword ptr [ESI + 0xc]
0057713e : PUSH EDX
0057713f : CALL 0x0051d570
00577144 : MOV EAX,dword ptr [ESI + 0x20]
00577147 : MOV ECX,dword ptr [EAX + 0x18]
0057714a : MOV dword ptr [EDI + 0x18],ECX
0057714d : MOV EDX,dword ptr [ESI + 0x20]
00577150 : MOV EAX,dword ptr [EDX + 0x14]
00577153 : MOV dword ptr [EDI + 0x14],EAX
00577156 : MOV EAX,dword ptr [ESI + 0x20]
00577159 : MOV ECX,dword ptr [EAX + 0x8c]
0057715f : SHR ECX,0xe
00577162 : MOV dword ptr [ESP + 0x14],EAX
00577166 : TEST CL,0x1
00577169 : JNZ 0x0057719d
0057716b : MOV EDX,EAX
0057716d : MOV EAX,dword ptr [EDX + 0x80]
00577173 : TEST EAX,EAX
00577175 : JNZ 0x00577190
00577177 : MOV ECX,EDX
00577179 : CALL 0x00520df0
0057717e : TEST EAX,EAX
00577180 : JNZ 0x00577190
00577182 : MOV ECX,dword ptr [ESP + 0x14]
00577186 : MOV EAX,dword ptr [ECX]
00577188 : MOV EDX,dword ptr [EAX + 0x58]
0057718b : CALL EDX
0057718d : MOV EAX,dword ptr [EAX + 0x78]
00577190 : MOV EDX,dword ptr [EDI]
00577192 : ADD EAX,0x8
00577195 : PUSH EAX
00577196 : MOV EAX,dword ptr [EDX + 0x20]
00577199 : MOV ECX,EDI
0057719b : CALL EAX
0057719d : MOV ECX,dword ptr [ESP + 0x18]
005771a1 : MOV EDX,dword ptr [ECX]
005771a3 : MOV EAX,dword ptr [ESI + 0x20]
005771a6 : MOV EDX,dword ptr [EDX + 0x114]
005771ac : PUSH EDI
005771ad : PUSH EAX
005771ae : CALL EDX
005771b0 : JMP 0x005771d9
005771b2 : MOV EAX,dword ptr [EAX + 0x10]
005771b5 : PUSH EAX
005771b6 : CALL 0x00590220
005771bb : MOV ECX,dword ptr [ESI + 0x10]
005771be : MOV EDX,dword ptr [ECX + 0x10]
005771c1 : MOV ECX,dword ptr [ESI + 0xc]
005771c4 : PUSH EDI
005771c5 : PUSH EDX
005771c6 : CALL 0x00574b60
005771cb : MOV EAX,dword ptr [ESI + 0xc]
005771ce : ADD EAX,0xb00
005771d3 : AND dword ptr [EAX],0xfffffeff
005771d9 : MOV EAX,dword ptr [EDI]
005771db : MOV EDX,dword ptr [EAX + 0x124]
005771e1 : PUSH 0x1
005771e3 : MOV ECX,EDI
005771e5 : CALL EDX
005771e7 : INC dword ptr [EDI + 0x4]
005771ea : MOV ECX,dword ptr [ESI + 0x20]
005771ed : TEST ECX,ECX
005771ef : JZ 0x005771f6
005771f1 : CALL 0x004ff7c0
005771f6 : MOV dword ptr [ESI + 0x20],EDI
005771f9 : TEST EBX,EBX
005771fb : JZ 0x00577244
005771fd : MOV ECX,EDI
005771ff : MOV EAX,dword ptr [ECX]
00577201 : MOV EDX,dword ptr [EAX + 0x5c]
00577204 : CALL EDX
00577206 : MOV ECX,dword ptr [ESI + 0x20]
00577209 : MOV EDX,dword ptr [EBX]
0057720b : MOV EDX,dword ptr [EDX + 0x24]
0057720e : PUSH ECX
0057720f : PUSH EAX
00577210 : MOV ECX,EBX
00577212 : MOV dword ptr [ESP + 0x20],EAX
00577216 : CALL EDX
00577218 : MOV EAX,dword ptr [EBP + 0x1c]
0057721b : MOV EAX,dword ptr [EAX + 0x80]
00577221 : MOV dword ptr [ESI + 0x2c],EAX
00577224 : MOV ECX,dword ptr [EBP + 0x1c]
00577227 : MOV ECX,dword ptr [ECX + 0xc]
0057722a : MOV ECX,dword ptr [ECX + 0x20]
0057722d : MOV ECX,dword ptr [ECX + 0x28]
00577230 : MOV EDX,dword ptr [EBX]
00577232 : MOV EDX,dword ptr [EDX + 0x34]
00577235 : PUSH ECX
00577236 : MOV ECX,dword ptr [ESP + 0x1c]
0057723a : PUSH EAX
0057723b : MOV EAX,dword ptr [ESI + 0x20]
0057723e : PUSH EAX
0057723f : PUSH ECX
00577240 : MOV ECX,EBX
00577242 : CALL EDX
00577244 : MOV ECX,EDI
00577246 : MOV byte ptr [ESI + 0x28],0x1
0057724a : CALL 0x004ff7c0
0057724f : MOV EAX,dword ptr [EBP + 0x1c]
00577252 : MOV EAX,dword ptr [EAX + 0x80]
00577258 : CMP dword ptr [ESI + 0x2c],EAX
0057725b : JZ 0x00577293
0057725d : TEST EBX,EBX
0057725f : JZ 0x00577293
00577261 : MOV ECX,dword ptr [ESI + 0x20]
00577264 : MOV EDX,dword ptr [ECX]
00577266 : MOV EAX,dword ptr [EDX + 0x5c]
00577269 : CALL EAX
0057726b : MOV ECX,dword ptr [EBP + 0x1c]
0057726e : MOV ECX,dword ptr [ECX + 0x80]
00577274 : MOV dword ptr [ESI + 0x2c],ECX
00577277 : MOV EDI,dword ptr [EBP + 0x1c]
0057727a : MOV EDI,dword ptr [EDI + 0xc]
0057727d : MOV EDI,dword ptr [EDI + 0x20]
00577280 : MOV EDI,dword ptr [EDI + 0x28]
00577283 : MOV EDX,dword ptr [EBX]
00577285 : MOV EDX,dword ptr [EDX + 0x34]
00577288 : PUSH EDI
00577289 : PUSH ECX
0057728a : MOV ECX,dword ptr [ESI + 0x20]
0057728d : PUSH ECX
0057728e : PUSH EAX
0057728f : MOV ECX,EBX
00577291 : CALL EDX
00577293 : CMP byte ptr [ESP + 0x13],0x0
00577298 : JZ 0x0057734f
0057729e : CMP byte ptr [ESI + 0x30],0x0
005772a2 : JNZ 0x0057734f
005772a8 : MOV EAX,dword ptr [EBP + 0x1c]
005772ab : MOV EAX,dword ptr [EAX + 0x74]
005772ae : TEST EAX,0x100
005772b3 : JZ 0x0057734f
005772b9 : MOV ECX,dword ptr [ESI + 0x10]
005772bc : MOV EAX,dword ptr [ECX + 0x10]
005772bf : CMP EAX,-0x1
005772c2 : JNZ 0x005772d1
005772c4 : MOV EAX,dword ptr [ESI + 0x20]
005772c7 : LEA ECX,[EAX + 0x68]
005772ca : CALL 0x0054ed10
005772cf : JMP 0x005772da
005772d1 : MOV ECX,dword ptr [ESI + 0xc]
005772d4 : PUSH EAX
005772d5 : CALL 0x0056b260
005772da : TEST EAX,EAX
005772dc : JZ 0x005772e1
005772de : INC dword ptr [EAX + 0x4]
005772e1 : MOV EDI,EAX
005772e3 : TEST EDI,EDI
005772e5 : JZ 0x00577340
005772e7 : MOV EDX,dword ptr [EDI]
005772e9 : MOV EAX,dword ptr [EDX + 0x124]
005772ef : PUSH 0x0
005772f1 : MOV ECX,EDI
005772f3 : CALL EAX
005772f5 : MOV EAX,dword ptr [EBP + 0x1c]
005772f8 : MOV ECX,dword ptr [EAX + 0x80]
005772fe : MOV EDX,dword ptr [EBP]
00577301 : MOV EAX,dword ptr [EDX + 0x14]
00577304 : MOV dword ptr [ESP + 0x18],ECX
00577308 : MOV ECX,EBP
0057730a : CALL EAX
0057730c : MOV ECX,dword ptr [ESP + 0x18]
00577310 : PUSH EAX
00577311 : PUSH ECX
00577312 : MOV ECX,EDI
00577314 : CALL 0x00589b70
00577319 : MOV ECX,EDI
0057731b : CALL 0x0058eeb0
00577320 : MOV ECX,dword ptr [ESI + 0xc]
00577323 : CALL 0x00575410
00577328 : TEST EBX,EBX
0057732a : JZ 0x00577340
0057732c : MOV EDX,dword ptr [EDI]
0057732e : MOV EAX,dword ptr [EDX + 0x5c]
00577331 : MOV ECX,EDI
00577333 : CALL EAX
00577335 : MOV EDX,dword ptr [EBX]
00577337 : PUSH EDI
00577338 : PUSH EAX
00577339 : MOV EAX,dword ptr [EDX + 0x2c]
0057733c : MOV ECX,EBX
0057733e : CALL EAX
00577340 : MOV byte ptr [ESI + 0x30],0x1
00577344 : TEST EDI,EDI
00577346 : JZ 0x0057734f
00577348 : MOV ECX,EDI
0057734a : CALL 0x004ff7c0
0057734f : MOV EAX,dword ptr [EBP + 0x1c]
00577352 : MOV ECX,dword ptr [EAX + 0x74]
00577355 : AND CL,0x3
00577358 : CMP CL,0x2
0057735b : JC 0x005774a4
00577361 : MOV EAX,dword ptr [EBP + 0x1c]
00577364 : MOV EDX,dword ptr [EAX + 0x74]
00577367 : TEST DL,0x2
0057736a : JZ 0x00577453
00577370 : MOV EAX,dword ptr [ESI + 0x10]
00577373 : MOV EAX,dword ptr [EAX + 0x10]
00577376 : CMP EAX,-0x1
00577379 : JNZ 0x0057739d
0057737b : MOV EAX,dword ptr [ESI + 0x20]
0057737e : LEA ECX,[EAX + 0x68]
00577381 : CALL 0x0054ed10
00577386 : TEST EAX,EAX
00577388 : JZ 0x0057738d
0057738a : INC dword ptr [EAX + 0x4]
0057738d : MOV ECX,dword ptr [ESI + 0x20]
00577390 : PUSH ECX
00577391 : MOV ECX,dword ptr [ESI + 0xc]
00577394 : MOV EDI,EAX
00577396 : CALL 0x00576ae0
0057739b : JMP 0x005773af
0057739d : MOV ECX,dword ptr [ESI + 0xc]
005773a0 : PUSH EAX
005773a1 : CALL 0x0056b260
005773a6 : TEST EAX,EAX
005773a8 : JZ 0x005773ad
005773aa : INC dword ptr [EAX + 0x4]
005773ad : MOV EDI,EAX
005773af : TEST EDI,EDI
005773b1 : JZ 0x0057749a
005773b7 : CMP byte ptr [ESP + 0x13],0x0
005773bc : JNZ 0x005773c5
005773be : AND dword ptr [EDI + 0x8c],0xfffffffb
005773c5 : TEST EBX,EBX
005773c7 : JZ 0x005773df
005773c9 : MOV EDX,dword ptr [EDI]
005773cb : MOV EAX,dword ptr [EDX + 0x5c]
005773ce : MOV ECX,EDI
005773d0 : CALL EAX
005773d2 : MOV EDX,dword ptr [EBX]
005773d4 : PUSH 0x0
005773d6 : PUSH EDI
005773d7 : PUSH EAX
005773d8 : MOV EAX,dword ptr [EDX + 0x28]
005773db : MOV ECX,EBX
005773dd : CALL EAX
005773df : CMP byte ptr [ESI + 0x30],0x0
005773e3 : JNZ 0x0057743e
005773e5 : MOV EDX,dword ptr [EDI]
005773e7 : MOV EAX,dword ptr [EDX + 0x124]
005773ed : PUSH 0x0
005773ef : MOV ECX,EDI
005773f1 : CALL EAX
005773f3 : MOV EAX,dword ptr [EBP + 0x1c]
005773f6 : MOV ECX,dword ptr [EAX + 0x80]
005773fc : MOV EDX,dword ptr [EBP]
005773ff : MOV EAX,dword ptr [EDX + 0x14]
00577402 : MOV dword ptr [ESP + 0x18],ECX
00577406 : MOV ECX,EBP
00577408 : CALL EAX
0057740a : MOV ECX,dword ptr [ESP + 0x18]
0057740e : PUSH EAX
0057740f : PUSH ECX
00577410 : MOV ECX,EDI
00577412 : CALL 0x00589b70
00577417 : MOV ECX,EDI
00577419 : CALL 0x0058eeb0
0057741e : MOV ECX,dword ptr [ESI + 0xc]
00577421 : CALL 0x00575410
00577426 : TEST EBX,EBX
00577428 : JZ 0x0057743e
0057742a : MOV EDX,dword ptr [EDI]
0057742c : MOV EAX,dword ptr [EDX + 0x5c]
0057742f : MOV ECX,EDI
00577431 : CALL EAX
00577433 : MOV EDX,dword ptr [EBX]
00577435 : PUSH EDI
00577436 : PUSH EAX
00577437 : MOV EAX,dword ptr [EDX + 0x2c]
0057743a : MOV ECX,EBX
0057743c : CALL EAX
0057743e : MOV ECX,EDI
00577440 : MOV byte ptr [ESI + 0x30],0x1
00577444 : CALL 0x004ff7c0
00577449 : MOV AL,0x1
0057744b : POP EDI
0057744c : POP ESI
0057744d : POP EBP
0057744e : POP EBX
0057744f : ADD ESP,0x14
00577452 : RET
00577453 : TEST EBX,EBX
00577455 : JZ 0x0057749a
00577457 : MOV ECX,dword ptr [ESI + 0x20]
0057745a : MOV EDX,dword ptr [ECX]
0057745c : MOV EAX,dword ptr [EDX + 0x5c]
0057745f : CALL EAX
00577461 : MOV ECX,dword ptr [EBP + 0x1c]
00577464 : MOV EDX,dword ptr [ECX + 0xc]
00577467 : MOV ECX,dword ptr [EDX + 0x20]
0057746a : MOV EDX,dword ptr [EBX]
0057746c : CMP dword ptr [ECX + 0x74],0x4
00577470 : MOV EDX,dword ptr [EDX + 0x30]
00577473 : MOV ECX,dword ptr [ESI + 0x20]
00577476 : PUSH 0x0
00577478 : JNZ 0x0057748f
0057747a : PUSH 0xb8d290
0057747f : PUSH ECX
00577480 : PUSH EAX
00577481 : MOV ECX,EBX
00577483 : CALL EDX
00577485 : MOV AL,0x1
00577487 : POP EDI
00577488 : POP ESI
00577489 : POP EBP
0057748a : POP EBX
0057748b : ADD ESP,0x14
0057748e : RET
0057748f : PUSH 0xb8d284
00577494 : PUSH ECX
00577495 : PUSH EAX
00577496 : MOV ECX,EBX
00577498 : CALL EDX
0057749a : MOV AL,0x1
0057749c : POP EDI
0057749d : POP ESI
0057749e : POP EBP
0057749f : POP EBX
005774a0 : ADD ESP,0x14
005774a3 : RET
005774a4 : POP EDI
005774a5 : POP ESI
005774a6 : POP EBP
005774a7 : XOR AL,AL
005774a9 : POP EBX
005774aa : ADD ESP,0x14
005774ad : RET

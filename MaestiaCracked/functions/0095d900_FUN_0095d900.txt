PROGRAM  : Maestia.exe
FUNCTION : FUN_0095d900
ENTRY    : 0095d900
BODY     : [[0095d900, 0095db3d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0095d900(int param_1,int param_2)

{
  short *psVar1;
  short *psVar2;
  short sVar3;
  ushort uVar4;
  ushort uVar5;
  uint uVar6;
  short *******pppppppsVar7;
  uint uVar8;
  short *******pppppppsVar9;
  int iVar10;
  int iVar11;
  int local_54;
  int local_50 [2];
  short ******local_48 [4];
  undefined4 local_38;
  uint local_34;
  short ******local_2c [4];
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  iVar10 = DAT_00d7c54c;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b53a32;
  local_10 = ExceptionList;
  uVar6 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_54 = param_1;
  local_14 = uVar6;
  FUN_004437f0(&local_54);
  iVar10 = *(int *)(iVar10 + 0x44);
  if (local_50[0] == iVar10) {
    iVar11 = 0;
  }
  else {
    iVar11 = *(int *)(local_50[0] + 0x10);
  }
  local_50[0] = param_2;
  FUN_004437f0(local_50);
  if (local_54 == iVar10) {
    iVar10 = 0;
  }
  else {
    iVar10 = *(int *)(local_54 + 0x10);
  }
  if (((((iVar11 != 0) && (iVar10 != 0)) &&
       ((uVar8 = *(uint *)(iVar11 + 0x48) & 0x400, uVar8 != 0 ||
        ((*(uint *)(iVar10 + 0x48) & 0x400) == 0)))) &&
      (((uVar8 == 0 || ((*(uint *)(iVar10 + 0x48) & 0x400) != 0)) &&
       (*(char *)(iVar11 + 0x40) == *(char *)(iVar10 + 0x40))))) &&
     (*(char *)(iVar11 + 0x41) == *(char *)(iVar10 + 0x41))) {
    FUN_00824a20(DAT_0172491c,0);
    local_8 = 0;
    FUN_00824a20(DAT_0172491c,0);
    local_8 = CONCAT31(local_8._1_3_,1);
    pppppppsVar7 = (short *******)local_2c[0];
    if (local_18 < 8) {
      pppppppsVar7 = local_2c;
    }
    psVar1 = (short *)((int)pppppppsVar7 + 2);
    do {
      sVar3 = *(short *)pppppppsVar7;
      pppppppsVar7 = (short *******)((int)pppppppsVar7 + 2);
    } while (sVar3 != 0);
    pppppppsVar9 = (short *******)local_48[0];
    if (local_34 < 8) {
      pppppppsVar9 = local_48;
    }
    psVar2 = (short *)((int)pppppppsVar9 + 2);
    do {
      sVar3 = *(short *)pppppppsVar9;
      pppppppsVar9 = (short *******)((int)pppppppsVar9 + 2);
    } while (sVar3 != 0);
    iVar10 = (int)pppppppsVar9 - (int)psVar2 >> 1;
    iVar11 = 0;
    if (0 < iVar10) {
      do {
        if ((int)pppppppsVar7 - (int)psVar1 >> 1 <= iVar11) break;
        pppppppsVar9 = (short *******)local_2c[0];
        if (local_18 < 8) {
          pppppppsVar9 = local_2c;
        }
        uVar4 = *(ushort *)((int)pppppppsVar9 + iVar11 * 2);
        pppppppsVar9 = (short *******)local_48[0];
        if (local_34 < 8) {
          pppppppsVar9 = local_48;
        }
        uVar5 = *(ushort *)((int)pppppppsVar9 + iVar11 * 2);
        if (uVar4 < uVar5) {
          local_8 = (uint)local_8._1_3_ << 8;
          FUN_00406560(uVar6);
          local_8 = 0xffffffff;
          FUN_00406560();
          goto LAB_0095db22;
        }
        if (uVar4 != uVar5) {
          local_8 = (uint)local_8._1_3_ << 8;
          FUN_00406560(uVar6);
          local_8 = 0xffffffff;
          FUN_00406560();
          goto LAB_0095db22;
        }
        iVar11 = iVar11 + 1;
      } while (iVar11 < iVar10);
    }
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_34 = 7;
    local_38 = 0;
    local_48[0] = (short ******)((uint)local_48[0] & 0xffff0000);
    local_8 = 0xffffffff;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c[0] = (short ******)((uint)local_2c[0] & 0xffff0000);
  }
LAB_0095db22:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0095d900 : PUSH EBP
0095d901 : MOV EBP,ESP
0095d903 : PUSH -0x1
0095d905 : PUSH 0xb53a32
0095d90a : MOV EAX,FS:[0x0]
0095d910 : PUSH EAX
0095d911 : SUB ESP,0x44
0095d914 : MOV EAX,[0x00d66fa0]
0095d919 : XOR EAX,EBP
0095d91b : MOV dword ptr [EBP + -0x10],EAX
0095d91e : PUSH EBX
0095d91f : PUSH ESI
0095d920 : PUSH EDI
0095d921 : PUSH EAX
0095d922 : LEA EAX,[EBP + -0xc]
0095d925 : MOV FS:[0x0],EAX
0095d92b : MOV EAX,dword ptr [EBP + 0x8]
0095d92e : MOV ESI,dword ptr [0x00d7c54c]
0095d934 : LEA ECX,[EBP + -0x50]
0095d937 : MOV dword ptr [EBP + -0x50],EAX
0095d93a : LEA EDI,[ESI + 0x40]
0095d93d : PUSH ECX
0095d93e : LEA EAX,[EBP + -0x4c]
0095d941 : MOV ECX,EDI
0095d943 : CALL 0x004437f0
0095d948 : MOV EBX,dword ptr [ESI + 0x44]
0095d94b : MOV EAX,dword ptr [EBP + -0x4c]
0095d94e : CMP EAX,EBX
0095d950 : JZ 0x0095d957
0095d952 : MOV ESI,dword ptr [EAX + 0x10]
0095d955 : JMP 0x0095d959
0095d957 : XOR ESI,ESI
0095d959 : MOV EDX,dword ptr [EBP + 0xc]
0095d95c : LEA EAX,[EBP + -0x4c]
0095d95f : PUSH EAX
0095d960 : LEA EAX,[EBP + -0x50]
0095d963 : MOV ECX,EDI
0095d965 : MOV dword ptr [EBP + -0x4c],EDX
0095d968 : CALL 0x004437f0
0095d96d : MOV EAX,dword ptr [EBP + -0x50]
0095d970 : CMP EAX,EBX
0095d972 : JZ 0x0095d979
0095d974 : MOV EDI,dword ptr [EAX + 0x10]
0095d977 : JMP 0x0095d97b
0095d979 : XOR EDI,EDI
0095d97b : TEST ESI,ESI
0095d97d : JZ 0x0095db20
0095d983 : TEST EDI,EDI
0095d985 : JZ 0x0095db20
0095d98b : MOV ECX,dword ptr [ESI + 0x48]
0095d98e : AND ECX,0x400
0095d994 : XOR EBX,EBX
0095d996 : MOV EDX,ECX
0095d998 : OR EDX,EBX
0095d99a : JNZ 0x0095d9ac
0095d99c : MOV EAX,dword ptr [EDI + 0x48]
0095d99f : AND EAX,0x400
0095d9a4 : OR EAX,EDX
0095d9a6 : JNZ 0x0095daf4
0095d9ac : OR ECX,EBX
0095d9ae : JZ 0x0095d9c2
0095d9b0 : MOV EAX,dword ptr [EDI + 0x48]
0095d9b3 : AND EAX,0x400
0095d9b8 : XOR ECX,ECX
0095d9ba : OR EAX,ECX
0095d9bc : JZ 0x0095db20
0095d9c2 : MOV AL,byte ptr [ESI + 0x40]
0095d9c5 : MOV CL,byte ptr [EDI + 0x40]
0095d9c8 : CMP AL,CL
0095d9ca : JNZ 0x0095db1e
0095d9d0 : MOV AL,byte ptr [ESI + 0x41]
0095d9d3 : MOV CL,byte ptr [EDI + 0x41]
0095d9d6 : CMP AL,CL
0095d9d8 : JNZ 0x0095db18
0095d9de : MOV EAX,[0x0172491c]
0095d9e3 : PUSH 0x0
0095d9e5 : LEA EDX,[ESI + 0x18]
0095d9e8 : PUSH EAX
0095d9e9 : LEA ESI,[EBP + -0x2c]
0095d9ec : CALL 0x00824a20
0095d9f1 : MOV dword ptr [EBP + -0x4],0x0
0095d9f8 : MOV ECX,dword ptr [0x0172491c]
0095d9fe : PUSH 0x0
0095da00 : LEA EDX,[EDI + 0x18]
0095da03 : PUSH ECX
0095da04 : LEA ESI,[EBP + -0x48]
0095da07 : CALL 0x00824a20
0095da0c : MOV byte ptr [EBP + -0x4],0x1
0095da10 : MOV EAX,dword ptr [EBP + -0x28]
0095da13 : MOV EDI,0x8
0095da18 : CMP dword ptr [EBP + -0x14],EDI
0095da1b : JNC 0x0095da20
0095da1d : LEA EAX,[EBP + -0x28]
0095da20 : LEA EDX,[EAX + 0x2]
0095da23 : MOV CX,word ptr [EAX]
0095da26 : ADD EAX,0x2
0095da29 : TEST CX,CX
0095da2c : JNZ 0x0095da23
0095da2e : MOV ECX,dword ptr [EBP + -0x44]
0095da31 : SUB EAX,EDX
0095da33 : SAR EAX,0x1
0095da35 : MOV EBX,EAX
0095da37 : MOV EAX,dword ptr [EBP + -0x30]
0095da3a : CMP EAX,EDI
0095da3c : JNC 0x0095da41
0095da3e : LEA ECX,[EBP + -0x44]
0095da41 : LEA ESI,[ECX + 0x2]
0095da44 : MOV DX,word ptr [ECX]
0095da47 : ADD ECX,0x2
0095da4a : TEST DX,DX
0095da4d : JNZ 0x0095da44
0095da4f : SUB ECX,ESI
0095da51 : SAR ECX,0x1
0095da53 : XOR EDX,EDX
0095da55 : TEST ECX,ECX
0095da57 : JLE 0x0095da93
0095da59 : LEA ESP,[ESP]
0095da60 : CMP EDX,EBX
0095da62 : JGE 0x0095da93
0095da64 : MOV ESI,dword ptr [EBP + -0x28]
0095da67 : CMP dword ptr [EBP + -0x14],EDI
0095da6a : JNC 0x0095da6f
0095da6c : LEA ESI,[EBP + -0x28]
0095da6f : MOVZX EDI,word ptr [ESI + EDX*0x2]
0095da73 : MOV ESI,dword ptr [EBP + -0x44]
0095da76 : CMP EAX,0x8
0095da79 : JNC 0x0095da7e
0095da7b : LEA ESI,[EBP + -0x44]
0095da7e : MOVZX ESI,word ptr [ESI + EDX*0x2]
0095da82 : CMP DI,SI
0095da85 : JC 0x0095dad9
0095da87 : JA 0x0095dafb
0095da89 : INC EDX
0095da8a : CMP EDX,ECX
0095da8c : MOV EDI,0x8
0095da91 : JL 0x0095da60
0095da93 : MOV byte ptr [EBP + -0x4],0x0
0095da97 : CMP dword ptr [EBP + -0x30],EDI
0095da9a : JC 0x0095daa4
0095da9c : MOV ECX,dword ptr [EBP + -0x44]
0095da9f : CALL 0x006f04e0
0095daa4 : MOV ESI,0x7
0095daa9 : XOR EBX,EBX
0095daab : XOR EDX,EDX
0095daad : MOV dword ptr [EBP + -0x30],ESI
0095dab0 : MOV dword ptr [EBP + -0x34],EBX
0095dab3 : MOV word ptr [EBP + -0x44],DX
0095dab7 : MOV dword ptr [EBP + -0x4],0xffffffff
0095dabe : CMP dword ptr [EBP + -0x14],EDI
0095dac1 : JC 0x0095dacb
0095dac3 : MOV ECX,dword ptr [EBP + -0x28]
0095dac6 : CALL 0x006f04e0
0095dacb : XOR EAX,EAX
0095dacd : MOV dword ptr [EBP + -0x14],ESI
0095dad0 : MOV dword ptr [EBP + -0x18],EBX
0095dad3 : MOV word ptr [EBP + -0x28],AX
0095dad7 : JMP 0x0095db20
0095dad9 : MOV byte ptr [EBP + -0x4],0x0
0095dadd : LEA ECX,[EBP + -0x48]
0095dae0 : CALL 0x00406560
0095dae5 : MOV dword ptr [EBP + -0x4],0xffffffff
0095daec : LEA ECX,[EBP + -0x2c]
0095daef : CALL 0x00406560
0095daf4 : MOV EAX,0x1
0095daf9 : JMP 0x0095db22
0095dafb : MOV byte ptr [EBP + -0x4],0x0
0095daff : LEA ECX,[EBP + -0x48]
0095db02 : CALL 0x00406560
0095db07 : MOV dword ptr [EBP + -0x4],0xffffffff
0095db0e : LEA ECX,[EBP + -0x2c]
0095db11 : CALL 0x00406560
0095db16 : JMP 0x0095db20
0095db18 : SBB EAX,EAX
0095db1a : NEG EAX
0095db1c : JMP 0x0095db22
0095db1e : JC 0x0095daf4
0095db20 : XOR EAX,EAX
0095db22 : MOV ECX,dword ptr [EBP + -0xc]
0095db25 : MOV dword ptr FS:[0x0],ECX
0095db2c : POP ECX
0095db2d : POP EDI
0095db2e : POP ESI
0095db2f : POP EBX
0095db30 : MOV ECX,dword ptr [EBP + -0x10]
0095db33 : XOR ECX,EBP
0095db35 : CALL 0x00633e6b
0095db3a : MOV ESP,EBP
0095db3c : POP EBP
0095db3d : RET

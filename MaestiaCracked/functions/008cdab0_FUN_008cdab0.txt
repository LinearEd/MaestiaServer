PROGRAM  : Maestia.exe
FUNCTION : FUN_008cdab0
ENTRY    : 008cdab0
BODY     : [[008cdab0, 008cdb27] [008cdb30, 008cddfc]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008cdab0(int param_1,int param_2)

{
  uint uVar1;
  int *piVar2;
  double dVar3;
  double dVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  uint uVar8;
  undefined4 uVar9;
  int iVar10;
  uint local_4c;
  undefined1 local_48 [4];
  undefined2 local_44;
  undefined4 local_34;
  uint local_30;
  undefined8 local_2c;
  uint local_24;
  int local_20;
  int local_1c;
  undefined4 *local_18;
  ushort *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b519af;
  local_10 = ExceptionList;
  uVar6 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(int *)(param_2 + 4) == 1) {
    *(undefined2 *)(param_1 + 0x84 + (uint)*(byte *)(param_2 + 10) * 2) = 1;
  }
  else {
    *(undefined2 *)(param_1 + 0x84 + (uint)*(byte *)(param_2 + 10) * 2) = 2;
  }
  local_14 = (ushort *)(param_2 + 0xb);
  local_18 = (undefined4 *)(param_2 + 0x19);
  local_20 = 7;
  do {
    iVar7 = FUN_00703c00(0xa801,uVar6);
    if (iVar7 != 0) {
      uVar8 = (uint)*(byte *)(iVar7 + 0x40);
      uVar1 = *(uint *)(param_1 + 0x80);
      iVar10 = (uVar8 * 100 + (uint)(*(byte *)(iVar7 + 0x41) >> 4)) * 100;
      local_2c = CONCAT44(iVar10,(undefined4)local_2c);
      local_24 = uVar8;
      if (*(byte *)(iVar7 + 0x40) < 4) {
        FUN_004437f0((int)&local_2c + 4);
        if (local_1c != *(int *)(param_1 + (uVar8 * 3 + 0x15) * 4)) {
          uVar9 = FUN_00824a20(DAT_0172491c,0);
          iVar5 = local_1c;
          local_8 = 1;
          FUN_00405eb0(uVar9,0,0xffffffff);
          local_8 = 0xffffffff;
          if (7 < local_4c) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          *(undefined4 *)(*(int *)(iVar5 + 0x10) + 0x30) = *local_18;
          *(uint *)(*(int *)(iVar5 + 0x10) + 4) = (uint)*local_14;
          *(uint *)(*(int *)(iVar5 + 0x10) + 0x28) = (uint)*(ushort *)(iVar7 + 0x46);
          *(uint *)(*(int *)(iVar5 + 0x10) + 0x24) = (uint)*(ushort *)(iVar7 + 0x44);
          *(uint *)(*(int *)(iVar5 + 0x10) + 0x2c) = (uint)*(ushort *)(iVar7 + 0x48);
          *(ushort *)(*(int *)(iVar5 + 0x10) + 0x34) = (ushort)*(byte *)(iVar7 + 0x42);
          *(undefined2 *)(*(int *)(iVar5 + 0x10) + 0x36) = *(undefined2 *)(iVar7 + 0x4c);
          local_4c = 7;
          if ((*(char *)(param_1 + 0x32) != '\0') &&
             (((uVar1 / 10000 & 0xffff) * 100 + (uVar1 % 10000) / 100) * 100 == iVar10)) {
            if ((*DAT_00da9894 != 0) &&
               (piVar2 = *(int **)(*DAT_00da9894 + 0x114), piVar2 != (int *)0x0)) {
              iVar7 = *(int *)(iVar5 + 0x10);
              if (*(uint *)(iVar7 + 0x20) < 8) {
                iVar7 = iVar7 + 0xc;
              }
              else {
                iVar7 = *(int *)(iVar7 + 0xc);
              }
              (**(code **)(*piVar2 + 4))(piVar2,"SetCraftTitle",&DAT_00c539e8,iVar7);
            }
            if ((*DAT_00da9894 != 0) &&
               (piVar2 = *(int **)(*DAT_00da9894 + 0x114), piVar2 != (int *)0x0)) {
              iVar7 = *(int *)(iVar5 + 0x10);
              dVar3 = (double)*(int *)(iVar7 + 0x30);
              if (*(int *)(iVar7 + 0x30) < 0) {
                dVar3 = dVar3 + 4294967296.0;
              }
              dVar4 = (double)*(int *)(iVar7 + 0x28);
              if (*(int *)(iVar7 + 0x28) < 0) {
                dVar4 = dVar4 + 4294967296.0;
              }
              local_2c = (longlong)ROUND((dVar3 / dVar4) * 100.0);
              (**(code **)(*piVar2 + 4))
                        (piVar2,"SetCraftProgress","%d, %d, %d",(undefined4)local_2c,
                         *(undefined4 *)(iVar7 + 0x30),*(undefined4 *)(iVar7 + 0x28));
            }
          }
        }
      }
      else {
        local_30 = 7;
        local_34 = 0;
        local_44 = 0;
        FUN_00406360(L"Buffer Over Run",0xf);
        local_8 = 0;
        if ((int *)*DAT_00da98e8 != (int *)0x0) {
          (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                    (L"AvaGuiCraft::ReceiveCraftInfo",0x2c5,local_48);
        }
        local_8 = 0xffffffff;
        if (7 < local_30) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_30 = 7;
        local_34 = 0;
        local_44 = 0;
      }
    }
    local_18 = local_18 + 1;
    local_14 = local_14 + 1;
    local_20 = local_20 + -1;
    if (local_20 == 0) {
      FUN_008cc030(*(undefined4 *)(param_1 + 0x80),0);
      ExceptionList = local_10;
      return;
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
008cdab0 : PUSH EBP
008cdab1 : MOV EBP,ESP
008cdab3 : PUSH -0x1
008cdab5 : PUSH 0xb519af
008cdaba : MOV EAX,FS:[0x0]
008cdac0 : PUSH EAX
008cdac1 : SUB ESP,0x54
008cdac4 : PUSH EBX
008cdac5 : PUSH ESI
008cdac6 : PUSH EDI
008cdac7 : MOV EAX,[0x00d66fa0]
008cdacc : XOR EAX,EBP
008cdace : PUSH EAX
008cdacf : LEA EAX,[EBP + -0xc]
008cdad2 : MOV FS:[0x0],EAX
008cdad8 : MOV EAX,dword ptr [EBP + 0xc]
008cdadb : CMP dword ptr [EAX + 0x4],0x1
008cdadf : MOV ESI,dword ptr [EBP + 0x8]
008cdae2 : JNZ 0x008cdafe
008cdae4 : MOVZX CX,byte ptr [EAX + 0xa]
008cdae9 : MOVZX ECX,CX
008cdaec : MOVZX EDX,CX
008cdaef : MOV ECX,0x1
008cdaf4 : MOV word ptr [ESI + EDX*0x2 + 0x84],CX
008cdafc : JMP 0x008cdb13
008cdafe : MOVZX DX,byte ptr [EAX + 0xa]
008cdb03 : MOVZX ECX,DX
008cdb06 : MOV EDX,0x2
008cdb0b : MOV word ptr [ESI + ECX*0x2 + 0x84],DX
008cdb13 : LEA ECX,[EAX + 0xb]
008cdb16 : ADD EAX,0x19
008cdb19 : MOV dword ptr [EBP + -0x10],ECX
008cdb1c : MOV dword ptr [EBP + -0x14],EAX
008cdb1f : MOV dword ptr [EBP + -0x1c],0x7
008cdb26 : JMP 0x008cdb30
008cdb30 : MOV EDX,dword ptr [EBP + -0x10]
008cdb33 : MOV DI,word ptr [EDX]
008cdb36 : PUSH 0xa801
008cdb3b : CALL 0x00703c00
008cdb40 : MOV EDI,EAX
008cdb42 : ADD ESP,0x4
008cdb45 : TEST EDI,EDI
008cdb47 : JZ 0x008cddc6
008cdb4d : MOVZX AX,byte ptr [EDI + 0x40]
008cdb52 : MOV DL,byte ptr [EDI + 0x41]
008cdb55 : MOVZX ECX,AX
008cdb58 : MOVZX ESI,CX
008cdb5b : SHR DL,0x4
008cdb5e : MOVZX AX,DL
008cdb62 : MOV EDX,dword ptr [EBP + 0x8]
008cdb65 : MOVZX EAX,AX
008cdb68 : MOV EBX,ESI
008cdb6a : IMUL EBX,EBX,0x64
008cdb6d : MOV dword ptr [EBP + -0x20],ECX
008cdb70 : MOVZX ECX,AX
008cdb73 : ADD EBX,ECX
008cdb75 : MOV ECX,dword ptr [EDX + 0x80]
008cdb7b : IMUL EBX,EBX,0x64
008cdb7e : MOV EAX,0xd1b71759
008cdb83 : MUL ECX
008cdb85 : SHR EDX,0xd
008cdb88 : MOVZX EAX,DX
008cdb8b : IMUL EDX,EDX,0x2710
008cdb91 : MOV dword ptr [EBP + 0xc],EAX
008cdb94 : SUB ECX,EDX
008cdb96 : MOV EAX,0x51eb851f
008cdb9b : MUL ECX
008cdb9d : MOVZX EAX,word ptr [EBP + 0xc]
008cdba1 : IMUL EAX,EAX,0x64
008cdba4 : SHR EDX,0x5
008cdba7 : MOVZX ECX,DX
008cdbaa : MOVZX ECX,CX
008cdbad : ADD EAX,ECX
008cdbaf : IMUL EAX,EAX,0x64
008cdbb2 : CMP word ptr [EBP + -0x20],0x4
008cdbb7 : MOV dword ptr [EBP + -0x24],EBX
008cdbba : MOV dword ptr [EBP + 0xc],EAX
008cdbbd : JC 0x008cdc2a
008cdbbf : PUSH 0xf
008cdbc1 : XOR EDX,EDX
008cdbc3 : MOV EDI,0x7
008cdbc8 : XOR ESI,ESI
008cdbca : PUSH 0xc5398c
008cdbcf : LEA ECX,[EBP + -0x44]
008cdbd2 : MOV dword ptr [EBP + -0x2c],EDI
008cdbd5 : MOV dword ptr [EBP + -0x30],ESI
008cdbd8 : MOV word ptr [EBP + -0x40],DX
008cdbdc : CALL 0x00406360
008cdbe1 : MOV dword ptr [EBP + -0x4],ESI
008cdbe4 : MOV EAX,[0x00da98e8]
008cdbe9 : MOV ECX,dword ptr [EAX]
008cdbeb : CMP ECX,ESI
008cdbed : JZ 0x008cdc04
008cdbef : MOV EDX,dword ptr [ECX]
008cdbf1 : MOV EDX,dword ptr [EDX + 0x14]
008cdbf4 : LEA EAX,[EBP + -0x44]
008cdbf7 : PUSH EAX
008cdbf8 : PUSH 0x2c5
008cdbfd : PUSH 0xc539ac
008cdc02 : CALL EDX
008cdc04 : MOV dword ptr [EBP + -0x4],0xffffffff
008cdc0b : CMP dword ptr [EBP + -0x2c],0x8
008cdc0f : JC 0x008cdc19
008cdc11 : MOV ECX,dword ptr [EBP + -0x40]
008cdc14 : CALL 0x006f04e0
008cdc19 : XOR EAX,EAX
008cdc1b : MOV dword ptr [EBP + -0x2c],EDI
008cdc1e : MOV dword ptr [EBP + -0x30],ESI
008cdc21 : MOV word ptr [EBP + -0x40],AX
008cdc25 : JMP 0x008cddc6
008cdc2a : MOV EAX,dword ptr [EBP + 0x8]
008cdc2d : LEA ECX,[EBP + -0x24]
008cdc30 : LEA EDX,[ESI + ESI*0x2]
008cdc33 : PUSH ECX
008cdc34 : LEA ECX,[EAX + EDX*0x4 + 0x50]
008cdc38 : LEA EAX,[EBP + -0x18]
008cdc3b : CALL 0x004437f0
008cdc40 : MOV EDX,dword ptr [EBP + 0x8]
008cdc43 : LEA ECX,[ESI + ESI*0x2 + 0x15]
008cdc47 : MOV EAX,dword ptr [EDX + ECX*0x4]
008cdc4a : CMP dword ptr [EBP + -0x18],EAX
008cdc4d : JZ 0x008cddc6
008cdc53 : MOV EAX,[0x0172491c]
008cdc58 : PUSH 0x0
008cdc5a : LEA EDX,[EDI + 0x18]
008cdc5d : PUSH EAX
008cdc5e : LEA ESI,[EBP + -0x60]
008cdc61 : CALL 0x00824a20
008cdc66 : MOV dword ptr [EBP + -0x4],0x1
008cdc6d : MOV ESI,dword ptr [EBP + -0x18]
008cdc70 : MOV ECX,dword ptr [ESI + 0x10]
008cdc73 : PUSH -0x1
008cdc75 : PUSH 0x0
008cdc77 : ADD ECX,0x8
008cdc7a : PUSH EAX
008cdc7b : CALL 0x00405eb0
008cdc80 : MOV dword ptr [EBP + -0x4],0xffffffff
008cdc87 : CMP dword ptr [EBP + -0x48],0x8
008cdc8b : JC 0x008cdc95
008cdc8d : MOV ECX,dword ptr [EBP + -0x5c]
008cdc90 : CALL 0x006f04e0
008cdc95 : MOV EDX,dword ptr [ESI + 0x10]
008cdc98 : MOV EAX,dword ptr [EBP + -0x14]
008cdc9b : XOR ECX,ECX
008cdc9d : MOV word ptr [EBP + -0x5c],CX
008cdca1 : MOV ECX,dword ptr [EAX]
008cdca3 : MOV dword ptr [EDX + 0x30],ECX
008cdca6 : MOV ECX,dword ptr [ESI + 0x10]
008cdca9 : MOV EDX,dword ptr [EBP + -0x10]
008cdcac : MOVZX EAX,word ptr [EDX]
008cdcaf : MOV dword ptr [ECX + 0x4],EAX
008cdcb2 : MOVZX EDX,word ptr [EDI + 0x46]
008cdcb6 : MOV EAX,dword ptr [ESI + 0x10]
008cdcb9 : MOV dword ptr [EAX + 0x28],EDX
008cdcbc : MOVZX ECX,word ptr [EDI + 0x44]
008cdcc0 : MOV EDX,dword ptr [ESI + 0x10]
008cdcc3 : MOV dword ptr [EDX + 0x24],ECX
008cdcc6 : MOVZX EAX,word ptr [EDI + 0x48]
008cdcca : MOV ECX,dword ptr [ESI + 0x10]
008cdccd : MOV dword ptr [ECX + 0x2c],EAX
008cdcd0 : MOVZX EDX,byte ptr [EDI + 0x42]
008cdcd4 : MOV EAX,dword ptr [ESI + 0x10]
008cdcd7 : MOV word ptr [EAX + 0x34],DX
008cdcdb : MOVZX EDX,word ptr [EDI + 0x4c]
008cdcdf : MOV ECX,dword ptr [ESI + 0x10]
008cdce2 : MOV EAX,dword ptr [EBP + 0x8]
008cdce5 : MOV word ptr [ECX + 0x36],DX
008cdce9 : CMP byte ptr [EAX + 0x32],0x0
008cdced : MOV dword ptr [EBP + -0x48],0x7
008cdcf4 : MOV dword ptr [EBP + -0x4c],0x0
008cdcfb : JZ 0x008cddc6
008cdd01 : CMP dword ptr [EBP + 0xc],EBX
008cdd04 : JNZ 0x008cddc6
008cdd0a : MOV ECX,dword ptr [0x00da9894]
008cdd10 : MOV EAX,dword ptr [ECX]
008cdd12 : TEST EAX,EAX
008cdd14 : JZ 0x008cdd4a
008cdd16 : MOV ECX,dword ptr [EAX + 0x114]
008cdd1c : TEST ECX,ECX
008cdd1e : JZ 0x008cdd4a
008cdd20 : MOV EAX,dword ptr [ESI + 0x10]
008cdd23 : ADD EAX,0x8
008cdd26 : CMP dword ptr [EAX + 0x18],0x8
008cdd2a : JC 0x008cdd31
008cdd2c : MOV EAX,dword ptr [EAX + 0x4]
008cdd2f : JMP 0x008cdd34
008cdd31 : ADD EAX,0x4
008cdd34 : MOV EDX,dword ptr [ECX]
008cdd36 : PUSH EAX
008cdd37 : MOV EAX,dword ptr [EDX + 0x4]
008cdd3a : PUSH 0xc539e8
008cdd3f : PUSH 0xc539ec
008cdd44 : PUSH ECX
008cdd45 : CALL EAX
008cdd47 : ADD ESP,0x10
008cdd4a : MOV ECX,dword ptr [0x00da9894]
008cdd50 : MOV EAX,dword ptr [ECX]
008cdd52 : TEST EAX,EAX
008cdd54 : JZ 0x008cddc6
008cdd56 : MOV ECX,dword ptr [EAX + 0x114]
008cdd5c : TEST ECX,ECX
008cdd5e : JZ 0x008cddc6
008cdd60 : MOV EAX,dword ptr [ESI + 0x10]
008cdd63 : MOV EDI,dword ptr [EAX + 0x28]
008cdd66 : MOV EDX,dword ptr [ECX]
008cdd68 : MOV ESI,EAX
008cdd6a : MOV EAX,dword ptr [EAX + 0x30]
008cdd6d : FILD dword ptr [ESI + 0x30]
008cdd70 : PUSH EDI
008cdd71 : PUSH EAX
008cdd72 : MOV EAX,dword ptr [ESI + 0x30]
008cdd75 : TEST EAX,EAX
008cdd77 : JGE 0x008cdd7f
008cdd79 : FADD double ptr [0x00cdf6f8]
008cdd7f : MOV EAX,dword ptr [ESI + 0x28]
008cdd82 : FILD dword ptr [ESI + 0x28]
008cdd85 : TEST EAX,EAX
008cdd87 : JGE 0x008cdd8f
008cdd89 : FADD double ptr [0x00cdf6f8]
008cdd8f : FDIVP
008cdd91 : FMUL double ptr [0x00cdf2a8]
008cdd97 : FNSTCW word ptr [EBP + 0xe]
008cdd9a : MOVZX EAX,word ptr [EBP + 0xe]
008cdd9e : OR EAX,0xc00
008cdda3 : MOV dword ptr [EBP + -0x24],EAX
008cdda6 : FLDCW word ptr [EBP + -0x24]
008cdda9 : FISTP qword ptr [EBP + -0x28]
008cddac : MOV EAX,dword ptr [EBP + -0x28]
008cddaf : PUSH EAX
008cddb0 : PUSH 0xc539fc
008cddb5 : PUSH 0xc53a08
008cddba : FLDCW word ptr [EBP + 0xe]
008cddbd : PUSH ECX
008cddbe : MOV ECX,dword ptr [EDX + 0x4]
008cddc1 : CALL ECX
008cddc3 : ADD ESP,0x18
008cddc6 : ADD dword ptr [EBP + -0x14],0x4
008cddca : ADD dword ptr [EBP + -0x10],0x2
008cddce : SUB dword ptr [EBP + -0x1c],0x1
008cddd2 : JNZ 0x008cdb30
008cddd8 : MOV ECX,dword ptr [EBP + 0x8]
008cdddb : MOV EDX,dword ptr [ECX + 0x80]
008cdde1 : PUSH 0x0
008cdde3 : PUSH EDX
008cdde4 : CALL 0x008cc030
008cdde9 : MOV ECX,dword ptr [EBP + -0xc]
008cddec : MOV dword ptr FS:[0x0],ECX
008cddf3 : POP ECX
008cddf4 : POP EDI
008cddf5 : POP ESI
008cddf6 : POP EBX
008cddf7 : MOV ESP,EBP
008cddf9 : POP EBP
008cddfa : RET 0x8

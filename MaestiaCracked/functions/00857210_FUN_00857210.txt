PROGRAM  : Maestia.exe
FUNCTION : FUN_00857210
ENTRY    : 00857210
BODY     : [[00857210, 00857604]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00857210(int param_1)

{
  code *pcVar1;
  int iVar2;
  byte bVar3;
  int *in_EAX;
  int iVar4;
  undefined4 uVar5;
  
  iVar2 = param_1;
  if (param_1 != 0) {
    in_EAX[1] = *(int *)(param_1 + 4);
    FUN_004044f0();
    FUN_0088b500();
    pcVar1 = *(code **)(*in_EAX + 8);
    in_EAX[0x5b6] = *(int *)(param_1 + 0x16d8);
    (*pcVar1)(*(undefined4 *)(param_1 + 0xa0));
    in_EAX[0x5a7] = *(int *)(param_1 + 0x169c);
    *(undefined2 *)(in_EAX + 0x5a6) = *(undefined2 *)(param_1 + 0x1698);
    *(undefined2 *)((int)in_EAX + 0x169a) = *(undefined2 *)(param_1 + 0x169a);
    if (*(int *)(param_1 + 0x18b4) == 0) {
      iVar4 = 0;
    }
    else {
      iVar4 = *(int *)(*(int *)(param_1 + 0x18b4) + 0x24);
    }
    if (in_EAX[0x62d] != 0) {
      if (iVar4 < 0) {
        iVar4 = 0;
      }
      else if (10 < iVar4) {
        iVar4 = 10;
      }
      *(int *)(in_EAX[0x62d] + 0x24) = iVar4;
    }
    if (*(int *)(param_1 + 0x18b4) == 0) {
      iVar4 = 0;
    }
    else {
      iVar4 = *(int *)(*(int *)(param_1 + 0x18b4) + 0x28);
    }
    if (in_EAX[0x62d] != 0) {
      if (iVar4 < 0) {
        iVar4 = 0;
      }
      else if (10 < iVar4) {
        iVar4 = 10;
      }
      *(int *)(in_EAX[0x62d] + 0x28) = iVar4;
    }
    if (*(int *)(param_1 + 0x18b4) == 0) {
      uVar5 = 0;
    }
    else {
      uVar5 = *(undefined4 *)(*(int *)(param_1 + 0x18b4) + 0x2c);
    }
    if (in_EAX[0x62d] != 0) {
      *(undefined4 *)(in_EAX[0x62d] + 0x2c) = uVar5;
      *(undefined4 *)(in_EAX[0x62d] + 0x30) = 0xffffcca6;
    }
    if (*(int *)(param_1 + 0x18b4) == 0) {
      uVar5 = 0;
    }
    else {
      uVar5 = *(undefined4 *)(*(int *)(param_1 + 0x18b4) + 0x30);
    }
    if (in_EAX[0x62d] != 0) {
      *(undefined4 *)(in_EAX[0x62d] + 0x30) = uVar5;
    }
    if (*(int *)(param_1 + 0x17f8) == 0) {
      iVar4 = 0;
    }
    else {
      iVar4 = *(int *)(param_1 + 0x16f0);
    }
    if (in_EAX[0x5fe] != 0) {
      in_EAX[0x5bc] = iVar4;
      *(int *)(in_EAX[0x5fe] + 0x28) = iVar4;
    }
    if (*(int *)(param_1 + 0x17f0) == 0) {
      uVar5 = 0;
    }
    else {
      uVar5 = *(undefined4 *)(param_1 + 0x16e8);
    }
    FUN_00856fb0(uVar5);
    if (*(int *)(param_1 + 0x17f4) == 0) {
      iVar4 = 0;
    }
    else {
      iVar4 = *(int *)(param_1 + 0x16ec);
    }
    if (in_EAX[0x5fd] != 0) {
      in_EAX[0x5bb] = iVar4;
      *(int *)(in_EAX[0x5fd] + 0x28) = iVar4;
    }
    if (*(int *)(param_1 + 0x1870) == 0) {
      uVar5 = 0;
    }
    else {
      uVar5 = *(undefined4 *)(param_1 + 0x1768);
    }
    FUN_00856ef0(uVar5);
    if (*(int *)(param_1 + 0x1804) == 0) {
      iVar4 = 0;
    }
    else {
      iVar4 = *(int *)(param_1 + 0x16fc);
    }
    if (in_EAX[0x601] != 0) {
      in_EAX[0x5bf] = iVar4;
      *(int *)(in_EAX[0x601] + 0x28) = iVar4;
    }
    if (*(int *)(param_1 + 0x180c) == 0) {
      iVar4 = 0;
    }
    else {
      iVar4 = *(int *)(param_1 + 0x1704);
    }
    if (in_EAX[0x603] != 0) {
      in_EAX[0x5c1] = iVar4;
      *(int *)(in_EAX[0x603] + 0x28) = iVar4;
    }
    if (*(int *)(param_1 + 0x1800) == 0) {
      iVar4 = 0;
    }
    else {
      iVar4 = *(int *)(param_1 + 0x16f8);
    }
    if (in_EAX[0x600] != 0) {
      in_EAX[0x5be] = iVar4;
      *(int *)(in_EAX[0x600] + 0x28) = iVar4;
    }
    if (*(int *)(param_1 + 0x1814) == 0) {
      iVar4 = 0;
    }
    else {
      iVar4 = *(int *)(param_1 + 0x170c);
    }
    if (in_EAX[0x605] != 0) {
      in_EAX[0x5c3] = iVar4;
      *(int *)(in_EAX[0x605] + 0x28) = iVar4;
    }
    if (*(int *)(param_1 + 0x1810) == 0) {
      iVar4 = 0;
    }
    else {
      iVar4 = *(int *)(param_1 + 0x1708);
    }
    if (in_EAX[0x604] != 0) {
      in_EAX[0x5c2] = iVar4;
      *(int *)(in_EAX[0x604] + 0x28) = iVar4;
    }
    if (*(int *)(param_1 + 0x1808) == 0) {
      iVar4 = 0;
    }
    else {
      iVar4 = *(int *)(param_1 + 0x1700);
    }
    if (in_EAX[0x602] != 0) {
      in_EAX[0x5c0] = iVar4;
      *(int *)(in_EAX[0x602] + 0x28) = iVar4;
    }
    if (*(int *)(param_1 + 0x1818) == 0) {
      iVar4 = 0;
    }
    else {
      iVar4 = *(int *)(param_1 + 0x1710);
    }
    if (in_EAX[0x606] != 0) {
      in_EAX[0x5c4] = iVar4;
      *(int *)(in_EAX[0x606] + 0x28) = iVar4;
    }
    if (*(int *)(param_1 + 0x17fc) == 0) {
      iVar4 = 0;
    }
    else {
      iVar4 = *(int *)(param_1 + 0x16f4);
    }
    if (in_EAX[0x5ff] != 0) {
      in_EAX[0x5bd] = iVar4;
      *(int *)(in_EAX[0x5ff] + 0x28) = iVar4;
    }
    if (*(int *)(param_1 + 0x181c) == 0) {
      iVar4 = 0;
    }
    else {
      iVar4 = *(int *)(param_1 + 0x1714);
    }
    if (in_EAX[0x607] != 0) {
      in_EAX[0x5c5] = iVar4;
      *(int *)(in_EAX[0x607] + 0x28) = iVar4;
    }
    in_EAX[0x5b9] = *(int *)(param_1 + 0x16e4);
    param_1 = 0;
    do {
      bVar3 = (char)param_1 + 0x14;
      if ((bVar3 < 0x21) && (*(int *)(iVar2 + 0x17f0 + (uint)bVar3 * 4) != 0)) {
        iVar4 = *(int *)(iVar2 + 0x16e8 + (uint)bVar3 * 4);
      }
      else {
        iVar4 = 0;
      }
      if (bVar3 < 0x21) {
        if (in_EAX[bVar3 + 0x5fc] != 0) {
          in_EAX[bVar3 + 0x5ba] = iVar4;
          *(int *)(in_EAX[bVar3 + 0x5fc] + 0x28) = iVar4;
        }
        if ((0x20 < bVar3) || (*(int *)(iVar2 + 0x17f0 + (uint)bVar3 * 4) == 0)) goto LAB_00857567;
        iVar4 = *(int *)(iVar2 + 0x176c + (uint)bVar3 * 4);
      }
      else {
LAB_00857567:
        iVar4 = 0;
      }
      if (bVar3 < 0x21) {
        if (in_EAX[bVar3 + 0x5fc] != 0) {
          in_EAX[bVar3 + 0x5db] = iVar4;
          *(int *)(in_EAX[bVar3 + 0x5fc] + 0x30) = iVar4;
        }
      }
      param_1 = param_1 + 1;
    } while (param_1 < 10);
    in_EAX[0x5a8] = *(int *)(iVar2 + 0x16a0);
    in_EAX[0x5a9] = *(int *)(iVar2 + 0x16a4);
    in_EAX[0x5aa] = *(int *)(iVar2 + 0x16a8);
    in_EAX[0x5ab] = *(int *)(iVar2 + 0x16ac);
    pcVar1 = *(code **)(*in_EAX + 0xc);
    *(undefined2 *)(in_EAX + 0x20) = *(undefined2 *)(iVar2 + 0x80);
    (*pcVar1)(*(undefined2 *)(iVar2 + 0x7c));
    if ((in_EAX[0x633] != 0) && (in_EAX[0x633] != 1)) {
      (**(code **)(*in_EAX + 0x2d8))(0);
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00857210 : PUSH EBP
00857211 : MOV EBP,ESP
00857213 : PUSH EBX
00857214 : MOV EBX,dword ptr [EBP + 0x8]
00857217 : PUSH ESI
00857218 : MOV ESI,EAX
0085721a : TEST EBX,EBX
0085721c : JZ 0x008575ff
00857222 : MOV EAX,dword ptr [EBX + 0x4]
00857225 : PUSH EDI
00857226 : LEA ECX,[EBX + 0xc]
00857229 : MOV EDI,ESI
0085722b : MOV dword ptr [ESI + 0x4],EAX
0085722e : CALL 0x004044f0
00857233 : MOV EAX,dword ptr [EBX + 0x8]
00857236 : CALL 0x0088b500
0085723b : MOV ECX,dword ptr [EBX + 0x16d8]
00857241 : MOV EDX,dword ptr [ESI]
00857243 : MOV EDX,dword ptr [EDX + 0x8]
00857246 : MOV dword ptr [ESI + 0x16d8],ECX
0085724c : MOV EAX,dword ptr [EBX + 0xa0]
00857252 : PUSH EAX
00857253 : MOV ECX,ESI
00857255 : CALL EDX
00857257 : MOV EAX,dword ptr [EBX + 0x169c]
0085725d : MOV dword ptr [ESI + 0x169c],EAX
00857263 : MOV CX,word ptr [EBX + 0x1698]
0085726a : MOV word ptr [ESI + 0x1698],CX
00857271 : MOV DX,word ptr [EBX + 0x169a]
00857278 : MOV word ptr [ESI + 0x169a],DX
0085727f : MOV EAX,dword ptr [EBX + 0x18b4]
00857285 : TEST EAX,EAX
00857287 : JZ 0x0085728e
00857289 : MOV EAX,dword ptr [EAX + 0x24]
0085728c : JMP 0x00857290
0085728e : XOR EAX,EAX
00857290 : MOV ECX,dword ptr [ESI + 0x18b4]
00857296 : TEST ECX,ECX
00857298 : JZ 0x008572af
0085729a : TEST EAX,EAX
0085729c : JGE 0x008572a2
0085729e : XOR EAX,EAX
008572a0 : JMP 0x008572ac
008572a2 : CMP EAX,0xb
008572a5 : JL 0x008572ac
008572a7 : MOV EAX,0xa
008572ac : MOV dword ptr [ECX + 0x24],EAX
008572af : MOV EAX,dword ptr [EBX + 0x18b4]
008572b5 : TEST EAX,EAX
008572b7 : JZ 0x008572be
008572b9 : MOV EAX,dword ptr [EAX + 0x28]
008572bc : JMP 0x008572c0
008572be : XOR EAX,EAX
008572c0 : MOV ECX,dword ptr [ESI + 0x18b4]
008572c6 : TEST ECX,ECX
008572c8 : JZ 0x008572df
008572ca : TEST EAX,EAX
008572cc : JGE 0x008572d2
008572ce : XOR EAX,EAX
008572d0 : JMP 0x008572dc
008572d2 : CMP EAX,0xb
008572d5 : JL 0x008572dc
008572d7 : MOV EAX,0xa
008572dc : MOV dword ptr [ECX + 0x28],EAX
008572df : MOV EAX,dword ptr [EBX + 0x18b4]
008572e5 : TEST EAX,EAX
008572e7 : JZ 0x008572ee
008572e9 : MOV ECX,dword ptr [EAX + 0x2c]
008572ec : JMP 0x008572f0
008572ee : XOR ECX,ECX
008572f0 : MOV EAX,dword ptr [ESI + 0x18b4]
008572f6 : TEST EAX,EAX
008572f8 : JZ 0x0085730a
008572fa : MOV dword ptr [EAX + 0x2c],ECX
008572fd : MOV EAX,dword ptr [ESI + 0x18b4]
00857303 : MOV dword ptr [EAX + 0x30],0xffffcca6
0085730a : MOV EAX,dword ptr [EBX + 0x18b4]
00857310 : TEST EAX,EAX
00857312 : JZ 0x00857319
00857314 : MOV ECX,dword ptr [EAX + 0x30]
00857317 : JMP 0x0085731b
00857319 : XOR ECX,ECX
0085731b : MOV EAX,dword ptr [ESI + 0x18b4]
00857321 : TEST EAX,EAX
00857323 : JZ 0x00857328
00857325 : MOV dword ptr [EAX + 0x30],ECX
00857328 : CMP dword ptr [EBX + 0x17f8],0x0
0085732f : JZ 0x00857339
00857331 : MOV ECX,dword ptr [EBX + 0x16f0]
00857337 : JMP 0x0085733b
00857339 : XOR ECX,ECX
0085733b : MOV EAX,dword ptr [ESI + 0x17f8]
00857341 : TEST EAX,EAX
00857343 : JZ 0x0085734e
00857345 : MOV dword ptr [ESI + 0x16f0],ECX
0085734b : MOV dword ptr [EAX + 0x28],ECX
0085734e : CMP dword ptr [EBX + 0x17f0],0x0
00857355 : JZ 0x0085735f
00857357 : MOV EAX,dword ptr [EBX + 0x16e8]
0085735d : JMP 0x00857361
0085735f : XOR EAX,EAX
00857361 : PUSH EAX
00857362 : CALL 0x00856fb0
00857367 : CMP dword ptr [EBX + 0x17f4],0x0
0085736e : JZ 0x00857378
00857370 : MOV ECX,dword ptr [EBX + 0x16ec]
00857376 : JMP 0x0085737a
00857378 : XOR ECX,ECX
0085737a : MOV EAX,dword ptr [ESI + 0x17f4]
00857380 : TEST EAX,EAX
00857382 : JZ 0x0085738d
00857384 : MOV dword ptr [ESI + 0x16ec],ECX
0085738a : MOV dword ptr [EAX + 0x28],ECX
0085738d : CMP dword ptr [EBX + 0x1870],0x0
00857394 : JZ 0x0085739e
00857396 : MOV EAX,dword ptr [EBX + 0x1768]
0085739c : JMP 0x008573a0
0085739e : XOR EAX,EAX
008573a0 : PUSH EAX
008573a1 : CALL 0x00856ef0
008573a6 : CMP dword ptr [EBX + 0x1804],0x0
008573ad : JZ 0x008573b7
008573af : MOV ECX,dword ptr [EBX + 0x16fc]
008573b5 : JMP 0x008573b9
008573b7 : XOR ECX,ECX
008573b9 : MOV EAX,dword ptr [ESI + 0x1804]
008573bf : TEST EAX,EAX
008573c1 : JZ 0x008573cc
008573c3 : MOV dword ptr [ESI + 0x16fc],ECX
008573c9 : MOV dword ptr [EAX + 0x28],ECX
008573cc : CMP dword ptr [EBX + 0x180c],0x0
008573d3 : JZ 0x008573dd
008573d5 : MOV ECX,dword ptr [EBX + 0x1704]
008573db : JMP 0x008573df
008573dd : XOR ECX,ECX
008573df : MOV EAX,dword ptr [ESI + 0x180c]
008573e5 : TEST EAX,EAX
008573e7 : JZ 0x008573f2
008573e9 : MOV dword ptr [ESI + 0x1704],ECX
008573ef : MOV dword ptr [EAX + 0x28],ECX
008573f2 : CMP dword ptr [EBX + 0x1800],0x0
008573f9 : JZ 0x00857403
008573fb : MOV ECX,dword ptr [EBX + 0x16f8]
00857401 : JMP 0x00857405
00857403 : XOR ECX,ECX
00857405 : MOV EAX,dword ptr [ESI + 0x1800]
0085740b : TEST EAX,EAX
0085740d : JZ 0x00857418
0085740f : MOV dword ptr [ESI + 0x16f8],ECX
00857415 : MOV dword ptr [EAX + 0x28],ECX
00857418 : CMP dword ptr [EBX + 0x1814],0x0
0085741f : JZ 0x00857429
00857421 : MOV ECX,dword ptr [EBX + 0x170c]
00857427 : JMP 0x0085742b
00857429 : XOR ECX,ECX
0085742b : MOV EAX,dword ptr [ESI + 0x1814]
00857431 : TEST EAX,EAX
00857433 : JZ 0x0085743e
00857435 : MOV dword ptr [ESI + 0x170c],ECX
0085743b : MOV dword ptr [EAX + 0x28],ECX
0085743e : CMP dword ptr [EBX + 0x1810],0x0
00857445 : JZ 0x0085744f
00857447 : MOV ECX,dword ptr [EBX + 0x1708]
0085744d : JMP 0x00857451
0085744f : XOR ECX,ECX
00857451 : MOV EAX,dword ptr [ESI + 0x1810]
00857457 : TEST EAX,EAX
00857459 : JZ 0x00857464
0085745b : MOV dword ptr [ESI + 0x1708],ECX
00857461 : MOV dword ptr [EAX + 0x28],ECX
00857464 : CMP dword ptr [EBX + 0x1808],0x0
0085746b : JZ 0x00857475
0085746d : MOV ECX,dword ptr [EBX + 0x1700]
00857473 : JMP 0x00857477
00857475 : XOR ECX,ECX
00857477 : MOV EAX,dword ptr [ESI + 0x1808]
0085747d : TEST EAX,EAX
0085747f : JZ 0x0085748a
00857481 : MOV dword ptr [ESI + 0x1700],ECX
00857487 : MOV dword ptr [EAX + 0x28],ECX
0085748a : CMP dword ptr [EBX + 0x1818],0x0
00857491 : JZ 0x0085749b
00857493 : MOV ECX,dword ptr [EBX + 0x1710]
00857499 : JMP 0x0085749d
0085749b : XOR ECX,ECX
0085749d : MOV EAX,dword ptr [ESI + 0x1818]
008574a3 : TEST EAX,EAX
008574a5 : JZ 0x008574b0
008574a7 : MOV dword ptr [ESI + 0x1710],ECX
008574ad : MOV dword ptr [EAX + 0x28],ECX
008574b0 : CMP dword ptr [EBX + 0x17fc],0x0
008574b7 : JZ 0x008574c1
008574b9 : MOV ECX,dword ptr [EBX + 0x16f4]
008574bf : JMP 0x008574c3
008574c1 : XOR ECX,ECX
008574c3 : MOV EAX,dword ptr [ESI + 0x17fc]
008574c9 : TEST EAX,EAX
008574cb : JZ 0x008574d6
008574cd : MOV dword ptr [ESI + 0x16f4],ECX
008574d3 : MOV dword ptr [EAX + 0x28],ECX
008574d6 : CMP dword ptr [EBX + 0x181c],0x0
008574dd : JZ 0x008574e7
008574df : MOV ECX,dword ptr [EBX + 0x1714]
008574e5 : JMP 0x008574e9
008574e7 : XOR ECX,ECX
008574e9 : MOV EAX,dword ptr [ESI + 0x181c]
008574ef : TEST EAX,EAX
008574f1 : JZ 0x008574fc
008574f3 : MOV dword ptr [ESI + 0x1714],ECX
008574f9 : MOV dword ptr [EAX + 0x28],ECX
008574fc : MOV ECX,dword ptr [EBX + 0x16e4]
00857502 : MOV dword ptr [ESI + 0x16e4],ECX
00857508 : MOV dword ptr [EBP + 0x8],0x0
0085750f : NOP
00857510 : MOV AL,byte ptr [EBP + 0x8]
00857513 : ADD AL,0x14
00857515 : CMP AL,0x21
00857517 : JNC 0x0085752f
00857519 : MOVZX ECX,AL
0085751c : CMP dword ptr [EBX + ECX*0x4 + 0x17f0],0x0
00857524 : JZ 0x0085752f
00857526 : MOV EDX,dword ptr [EBX + ECX*0x4 + 0x16e8]
0085752d : JMP 0x00857531
0085752f : XOR EDX,EDX
00857531 : CMP AL,0x21
00857533 : JNC 0x00857567
00857535 : MOVZX ECX,AL
00857538 : MOV EDI,dword ptr [ESI + ECX*0x4 + 0x17f0]
0085753f : TEST EDI,EDI
00857541 : JZ 0x0085754d
00857543 : MOV dword ptr [ESI + ECX*0x4 + 0x16e8],EDX
0085754a : MOV dword ptr [EDI + 0x28],EDX
0085754d : CMP AL,0x21
0085754f : JNC 0x00857567
00857551 : MOVZX ECX,AL
00857554 : CMP dword ptr [EBX + ECX*0x4 + 0x17f0],0x0
0085755c : JZ 0x00857567
0085755e : MOV EDI,dword ptr [EBX + ECX*0x4 + 0x176c]
00857565 : JMP 0x00857569
00857567 : XOR EDI,EDI
00857569 : CMP AL,0x21
0085756b : JNC 0x00857585
0085756d : MOVZX EAX,AL
00857570 : MOV ECX,dword ptr [ESI + EAX*0x4 + 0x17f0]
00857577 : TEST ECX,ECX
00857579 : JZ 0x00857585
0085757b : MOV dword ptr [ESI + EAX*0x4 + 0x176c],EDI
00857582 : MOV dword ptr [ECX + 0x30],EDI
00857585 : MOV EAX,dword ptr [EBP + 0x8]
00857588 : INC EAX
00857589 : CMP EAX,0xa
0085758c : MOV dword ptr [EBP + 0x8],EAX
0085758f : JL 0x00857510
00857595 : MOV EDX,dword ptr [EBX + 0x16a0]
0085759b : MOV dword ptr [ESI + 0x16a0],EDX
008575a1 : MOV EAX,dword ptr [EBX + 0x16a4]
008575a7 : MOV dword ptr [ESI + 0x16a4],EAX
008575ad : MOV ECX,dword ptr [EBX + 0x16a8]
008575b3 : MOV dword ptr [ESI + 0x16a8],ECX
008575b9 : MOV EDX,dword ptr [EBX + 0x16ac]
008575bf : MOV dword ptr [ESI + 0x16ac],EDX
008575c5 : MOV AX,word ptr [EBX + 0x80]
008575cc : MOV EDX,dword ptr [ESI]
008575ce : MOV EDX,dword ptr [EDX + 0xc]
008575d1 : MOV word ptr [ESI + 0x80],AX
008575d8 : MOVZX EAX,word ptr [EBX + 0x7c]
008575dc : PUSH EAX
008575dd : MOV ECX,ESI
008575df : CALL EDX
008575e1 : MOV EAX,dword ptr [ESI + 0x18cc]
008575e7 : POP EDI
008575e8 : TEST EAX,EAX
008575ea : JZ 0x008575ff
008575ec : CMP EAX,0x1
008575ef : JZ 0x008575ff
008575f1 : MOV EAX,dword ptr [ESI]
008575f3 : MOV EDX,dword ptr [EAX + 0x2d8]
008575f9 : PUSH 0x0
008575fb : MOV ECX,ESI
008575fd : CALL EDX
008575ff : POP ESI
00857600 : POP EBX
00857601 : POP EBP
00857602 : RET 0x4

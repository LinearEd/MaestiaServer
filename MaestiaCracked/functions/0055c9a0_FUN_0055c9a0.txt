PROGRAM  : Maestia.exe
FUNCTION : FUN_0055c9a0
ENTRY    : 0055c9a0
BODY     : [[0055c9a0, 0055c9ec] [0055c9f0, 0055ca8b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0055c9a0(undefined4 *param_1)

{
  undefined4 *puVar1;
  int iVar2;
  uint uVar3;
  char cVar4;
  uint uVar5;
  int *in_ECX;
  uint uVar6;
  uint uVar7;
  uint *puVar8;
  undefined4 local_4;
  
  if (*in_ECX != 0) {
    uVar5 = FUN_0055c430(*param_1);
    iVar2 = *in_ECX;
    uVar5 = *(uint *)(iVar2 + 4) & uVar5;
    puVar8 = (uint *)(iVar2 + 8 + uVar5 * 0xc);
    if ((*(int *)(iVar2 + 8 + uVar5 * 0xc) != -2) && (puVar8[1] == uVar5)) {
      uVar6 = 0xffffffff;
      uVar7 = uVar5;
      while( true ) {
        if (puVar8[1] == uVar5) {
          local_4 = *param_1;
          cVar4 = FUN_0055c310(&local_4);
          if (cVar4 != '\0') {
            if (uVar5 == uVar7) {
              uVar5 = *puVar8;
              if (uVar5 != 0xffffffff) {
                iVar2 = *in_ECX;
                *puVar8 = 0xfffffffe;
                puVar1 = (undefined4 *)(iVar2 + 8 + uVar5 * 0xc);
                *puVar8 = *(uint *)(iVar2 + 8 + uVar5 * 0xc);
                puVar8[1] = puVar1[1];
                puVar8[2] = puVar1[2];
                *puVar1 = 0xfffffffe;
                *(int *)*in_ECX = *(int *)*in_ECX + -1;
                return;
              }
            }
            else {
              *(uint *)(*in_ECX + 8 + uVar6 * 0xc) = *puVar8;
            }
            *puVar8 = 0xfffffffe;
            *(int *)*in_ECX = *(int *)*in_ECX + -1;
            return;
          }
        }
        uVar3 = *puVar8;
        if (uVar3 == 0xffffffff) break;
        puVar8 = (uint *)(*in_ECX + 8 + uVar3 * 0xc);
        uVar6 = uVar7;
        uVar7 = uVar3;
      }
      return;
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
0055c9a0 : SUB ESP,0x8
0055c9a3 : PUSH EBX
0055c9a4 : MOV EBX,ECX
0055c9a6 : CMP dword ptr [EBX],0x0
0055c9a9 : JZ 0x0055ca85
0055c9af : MOV EAX,dword ptr [ESP + 0x10]
0055c9b3 : MOV ECX,dword ptr [EAX]
0055c9b5 : PUSH ESI
0055c9b6 : PUSH EDI
0055c9b7 : PUSH ECX
0055c9b8 : LEA ECX,[ESP + 0x1c]
0055c9bc : CALL 0x0055c430
0055c9c1 : MOV ECX,dword ptr [EBX]
0055c9c3 : MOV ESI,dword ptr [ECX + 0x4]
0055c9c6 : AND ESI,EAX
0055c9c8 : LEA EDX,[ESI + ESI*0x2]
0055c9cb : CMP dword ptr [ECX + EDX*0x4 + 0x8],-0x2
0055c9d0 : LEA EDI,[ECX + EDX*0x4 + 0x8]
0055c9d4 : JZ 0x0055ca83
0055c9da : CMP dword ptr [EDI + 0x4],ESI
0055c9dd : JNZ 0x0055ca83
0055c9e3 : PUSH EBP
0055c9e4 : MOV dword ptr [ESP + 0x10],ESI
0055c9e8 : OR EBP,0xffffffff
0055c9eb : JMP 0x0055c9f0
0055c9f0 : MOV EAX,dword ptr [ESP + 0x10]
0055c9f4 : CMP dword ptr [EDI + 0x4],EAX
0055c9f7 : JNZ 0x0055ca14
0055c9f9 : MOV ECX,dword ptr [ESP + 0x1c]
0055c9fd : MOV EDX,dword ptr [ECX]
0055c9ff : LEA EAX,[ESP + 0x14]
0055ca03 : PUSH EAX
0055ca04 : LEA ECX,[EDI + 0x8]
0055ca07 : MOV dword ptr [ESP + 0x18],EDX
0055ca0b : CALL 0x0055c310
0055ca10 : TEST AL,AL
0055ca12 : JNZ 0x0055ca28
0055ca14 : MOV EBP,ESI
0055ca16 : MOV ESI,dword ptr [EDI]
0055ca18 : CMP ESI,-0x1
0055ca1b : JZ 0x0055ca82
0055ca1d : MOV EDX,dword ptr [EBX]
0055ca1f : LEA ECX,[ESI + ESI*0x2]
0055ca22 : LEA EDI,[EDX + ECX*0x4 + 0x8]
0055ca26 : JMP 0x0055c9f0
0055ca28 : CMP dword ptr [ESP + 0x10],ESI
0055ca2c : JNZ 0x0055ca6c
0055ca2e : MOV EAX,dword ptr [EDI]
0055ca30 : CMP EAX,-0x1
0055ca33 : JZ 0x0055ca78
0055ca35 : MOV ECX,dword ptr [EBX]
0055ca37 : MOV dword ptr [EDI],0xfffffffe
0055ca3d : LEA EAX,[EAX + EAX*0x2]
0055ca40 : MOV EDX,dword ptr [ECX + EAX*0x4 + 0x8]
0055ca44 : LEA EAX,[ECX + EAX*0x4 + 0x8]
0055ca48 : MOV dword ptr [EDI],EDX
0055ca4a : MOV ECX,dword ptr [EAX + 0x4]
0055ca4d : MOV dword ptr [EDI + 0x4],ECX
0055ca50 : MOV EDX,dword ptr [EAX + 0x8]
0055ca53 : MOV dword ptr [EDI + 0x8],EDX
0055ca56 : MOV EDI,EAX
0055ca58 : POP EBP
0055ca59 : MOV dword ptr [EDI],0xfffffffe
0055ca5f : MOV EAX,dword ptr [EBX]
0055ca61 : DEC dword ptr [EAX]
0055ca63 : POP EDI
0055ca64 : POP ESI
0055ca65 : POP EBX
0055ca66 : ADD ESP,0x8
0055ca69 : RET 0x4
0055ca6c : MOV ECX,dword ptr [EBX]
0055ca6e : MOV EDX,dword ptr [EDI]
0055ca70 : LEA EAX,[EBP + EBP*0x2]
0055ca74 : MOV dword ptr [ECX + EAX*0x4 + 0x8],EDX
0055ca78 : MOV dword ptr [EDI],0xfffffffe
0055ca7e : MOV EAX,dword ptr [EBX]
0055ca80 : DEC dword ptr [EAX]
0055ca82 : POP EBP
0055ca83 : POP EDI
0055ca84 : POP ESI
0055ca85 : POP EBX
0055ca86 : ADD ESP,0x8
0055ca89 : RET 0x4

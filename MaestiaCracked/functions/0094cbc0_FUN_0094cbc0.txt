PROGRAM  : Maestia.exe
FUNCTION : FUN_0094cbc0
ENTRY    : 0094cbc0
BODY     : [[0094cbc0, 0094cdef]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0094cbc0(int *param_1,undefined4 param_2)

{
  code *pcVar1;
  int *piVar2;
  uint uVar3;
  int iVar4;
  undefined4 uVar5;
  int *in_ECX;
  undefined4 ***pppuVar6;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  int iVar7;
  undefined1 local_58 [28];
  int local_3c;
  undefined4 local_38;
  int local_34 [2];
  undefined4 **local_2c [4];
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b5373b;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_38 = 0;
  local_14 = uVar3;
  FUN_00908130(in_ECX[0xf],param_2,param_1);
  iVar4 = param_1[9];
  if (iVar4 == 0) {
    local_34[0] = (uint)local_34[0]._1_3_ << 8;
  }
  else {
    local_34[0] = CONCAT31(local_34[0]._1_3_,*(undefined1 *)(iVar4 + 0xb1));
  }
  if (iVar4 == 0) {
    FUN_00406460(&DAT_00c72a98);
    local_8 = 0;
    local_38 = 1;
  }
  iVar7 = local_34[0];
  (**(code **)(*param_1 + 0xb0))();
  local_8 = 0xffffffff;
  if (iVar4 == 0) {
    local_38 = 0;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c[0] = (undefined4 **)((uint)local_2c[0] & 0xffff0000);
  }
  uVar5 = extraout_EDX;
  if (*(char *)((int)param_1 + 0xed) != '\0') {
    pcVar1 = *(code **)(*in_ECX + 0x18);
    *(undefined1 *)(in_ECX + 0x1d) = 1;
    (*pcVar1)(0,300);
    iVar4 = DAT_00d7c54c;
    local_34[0] = param_1[4];
    FUN_004437f0(local_34);
    uVar5 = extraout_EDX_00;
    if ((((local_3c != *(int *)(iVar4 + 0x44)) && (*(int *)(local_3c + 0x10) != 0)) &&
        (*DAT_00da9894 != 0)) && (*(int *)(*DAT_00da9894 + 0x1a8) != 0)) {
      FUN_00824a20(DAT_0172491c,0);
      local_8 = 1;
      FUN_008ece00(3);
      FUN_00406460(L"IDS_SUMMONPET_REGISTERED");
      local_8._0_1_ = 2;
      piVar2 = *(int **)(*DAT_00da9894 + 0x1a8);
      iVar4 = FUN_0081d120(local_58);
      local_8._0_1_ = 3;
      pppuVar6 = (undefined4 ***)local_2c[0];
      if (local_18 < 8) {
        pppuVar6 = local_2c;
      }
      if (*(uint *)(iVar4 + 0x18) < 8) {
        iVar4 = iVar4 + 4;
      }
      else {
        iVar4 = *(int *)(iVar4 + 4);
      }
      uVar5 = FUN_00404750(iVar4,pppuVar6);
      local_8._0_1_ = 4;
      (**(code **)(*piVar2 + 0x44))(uVar5,4);
      local_8._0_1_ = 3;
      FUN_00406560();
      local_8._0_1_ = 2;
      FUN_00406560();
      local_8 = CONCAT31(local_8._1_3_,1);
      FUN_00406560();
      local_8 = 0xffffffff;
      FUN_00406560();
      uVar5 = extraout_EDX_01;
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc,uVar5,iVar7,uVar3);
  return;
}



============================================================
DISASSEMBLY
============================================================
0094cbc0 : PUSH EBP
0094cbc1 : MOV EBP,ESP
0094cbc3 : PUSH -0x1
0094cbc5 : PUSH 0xb5373b
0094cbca : MOV EAX,FS:[0x0]
0094cbd0 : PUSH EAX
0094cbd1 : SUB ESP,0x80
0094cbd7 : MOV EAX,[0x00d66fa0]
0094cbdc : XOR EAX,EBP
0094cbde : MOV dword ptr [EBP + -0x10],EAX
0094cbe1 : PUSH EBX
0094cbe2 : PUSH ESI
0094cbe3 : PUSH EDI
0094cbe4 : PUSH EAX
0094cbe5 : LEA EAX,[EBP + -0xc]
0094cbe8 : MOV FS:[0x0],EAX
0094cbee : MOV ESI,dword ptr [EBP + 0x8]
0094cbf1 : MOV EAX,dword ptr [EBP + 0xc]
0094cbf4 : MOVZX EDX,word ptr [EBP + 0x10]
0094cbf8 : PUSH ESI
0094cbf9 : MOV EDI,ECX
0094cbfb : MOVZX ECX,word ptr [EBP + 0x14]
0094cbff : XOR EBX,EBX
0094cc01 : PUSH EAX
0094cc02 : MOV dword ptr [EBP + -0x34],EBX
0094cc05 : MOV EAX,dword ptr [EDI + 0x3c]
0094cc08 : PUSH EAX
0094cc09 : CALL 0x00908130
0094cc0e : MOV EAX,dword ptr [ESI + 0x24]
0094cc11 : TEST EAX,EAX
0094cc13 : JZ 0x0094cc20
0094cc15 : MOV CL,byte ptr [EAX + 0xb1]
0094cc1b : MOV byte ptr [EBP + -0x30],CL
0094cc1e : JMP 0x0094cc23
0094cc20 : MOV byte ptr [EBP + -0x30],BL
0094cc23 : TEST EAX,EAX
0094cc25 : JZ 0x0094cc2c
0094cc27 : ADD EAX,0x38
0094cc2a : JMP 0x0094cc48
0094cc2c : PUSH 0xc72a98
0094cc31 : LEA ECX,[EBP + -0x2c]
0094cc34 : CALL 0x00406460
0094cc39 : MOV dword ptr [EBP + -0x4],0x0
0094cc40 : MOV EBX,0x1
0094cc45 : MOV dword ptr [EBP + -0x34],EBX
0094cc48 : MOV ECX,dword ptr [EBP + -0x30]
0094cc4b : MOV EDX,dword ptr [ESI]
0094cc4d : MOV EDX,dword ptr [EDX + 0xb0]
0094cc53 : PUSH ECX
0094cc54 : MOV ECX,dword ptr [EBP + 0x10]
0094cc57 : PUSH EAX
0094cc58 : MOV EAX,dword ptr [EBP + 0x14]
0094cc5b : PUSH EAX
0094cc5c : PUSH ECX
0094cc5d : PUSH EDI
0094cc5e : MOV ECX,ESI
0094cc60 : CALL EDX
0094cc62 : MOV dword ptr [EBP + -0x4],0xffffffff
0094cc69 : TEST BL,0x1
0094cc6c : JZ 0x0094cc96
0094cc6e : AND EBX,0xfffffffe
0094cc71 : MOV dword ptr [EBP + -0x34],EBX
0094cc74 : CMP dword ptr [EBP + -0x14],0x8
0094cc78 : JC 0x0094cc82
0094cc7a : MOV ECX,dword ptr [EBP + -0x28]
0094cc7d : CALL 0x006f04e0
0094cc82 : XOR EAX,EAX
0094cc84 : MOV dword ptr [EBP + -0x14],0x7
0094cc8b : MOV dword ptr [EBP + -0x18],0x0
0094cc92 : MOV word ptr [EBP + -0x28],AX
0094cc96 : CMP byte ptr [ESI + 0xed],0x0
0094cc9d : JZ 0x0094cdd2
0094cca3 : MOV EDX,dword ptr [EDI]
0094cca5 : MOV EAX,dword ptr [EDX + 0x18]
0094cca8 : PUSH 0x12c
0094ccad : PUSH 0x0
0094ccaf : MOV ECX,EDI
0094ccb1 : MOV byte ptr [EDI + 0x74],0x1
0094ccb5 : CALL EAX
0094ccb7 : MOV ECX,dword ptr [ESI + 0x10]
0094ccba : MOV ESI,dword ptr [0x00d7c54c]
0094ccc0 : LEA EDX,[EBP + -0x30]
0094ccc3 : MOV dword ptr [EBP + -0x30],ECX
0094ccc6 : PUSH EDX
0094ccc7 : LEA ECX,[ESI + 0x40]
0094ccca : LEA EAX,[EBP + -0x38]
0094cccd : CALL 0x004437f0
0094ccd2 : MOV ESI,dword ptr [ESI + 0x44]
0094ccd5 : MOV EAX,dword ptr [EBP + -0x38]
0094ccd8 : CMP EAX,ESI
0094ccda : JZ 0x0094cdd2
0094cce0 : MOV EAX,dword ptr [EAX + 0x10]
0094cce3 : TEST EAX,EAX
0094cce5 : JZ 0x0094cdd2
0094cceb : MOV ECX,dword ptr [0x00da9894]
0094ccf1 : MOV ECX,dword ptr [ECX]
0094ccf3 : TEST ECX,ECX
0094ccf5 : JZ 0x0094cdd2
0094ccfb : CMP dword ptr [ECX + 0x1a8],0x0
0094cd02 : JZ 0x0094cdd2
0094cd08 : LEA EDX,[EAX + 0x18]
0094cd0b : MOV EAX,[0x0172491c]
0094cd10 : PUSH 0x0
0094cd12 : PUSH EAX
0094cd13 : LEA ESI,[EBP + -0x2c]
0094cd16 : CALL 0x00824a20
0094cd1b : MOV dword ptr [EBP + -0x4],0x1
0094cd22 : PUSH 0x3
0094cd24 : MOV EDI,ESI
0094cd26 : CALL 0x008ece00
0094cd2b : PUSH 0xc72a9c
0094cd30 : LEA ECX,[EBP + -0x54]
0094cd33 : CALL 0x00406460
0094cd38 : MOV byte ptr [EBP + -0x4],0x2
0094cd3c : MOV ECX,dword ptr [0x00da9894]
0094cd42 : MOV EAX,dword ptr [ECX]
0094cd44 : MOV ECX,dword ptr [0x0172491c]
0094cd4a : MOV EBX,dword ptr [EAX + 0x1a8]
0094cd50 : LEA EDX,[EBP + -0x54]
0094cd53 : PUSH EDX
0094cd54 : LEA EDI,[EBP + 0xffffff74]
0094cd5a : CALL 0x0081d120
0094cd5f : MOV byte ptr [EBP + -0x4],0x3
0094cd63 : MOV ECX,dword ptr [EBP + -0x28]
0094cd66 : MOV EDX,0x8
0094cd6b : CMP dword ptr [EBP + -0x14],EDX
0094cd6e : JNC 0x0094cd73
0094cd70 : LEA ECX,[EBP + -0x28]
0094cd73 : CMP dword ptr [EAX + 0x18],EDX
0094cd76 : JC 0x0094cd7d
0094cd78 : MOV EAX,dword ptr [EAX + 0x4]
0094cd7b : JMP 0x0094cd80
0094cd7d : ADD EAX,0x4
0094cd80 : PUSH ECX
0094cd81 : PUSH EAX
0094cd82 : LEA ESI,[EBP + -0x70]
0094cd85 : CALL 0x00404750
0094cd8a : ADD ESP,0x8
0094cd8d : MOV byte ptr [EBP + -0x4],0x4
0094cd91 : MOV EDX,dword ptr [EBX]
0094cd93 : PUSH 0x4
0094cd95 : PUSH EAX
0094cd96 : MOV EAX,dword ptr [EDX + 0x44]
0094cd99 : MOV ECX,EBX
0094cd9b : CALL EAX
0094cd9d : MOV byte ptr [EBP + -0x4],0x3
0094cda1 : MOV ECX,ESI
0094cda3 : CALL 0x00406560
0094cda8 : MOV byte ptr [EBP + -0x4],0x2
0094cdac : LEA ECX,[EBP + 0xffffff74]
0094cdb2 : CALL 0x00406560
0094cdb7 : MOV byte ptr [EBP + -0x4],0x1
0094cdbb : LEA ECX,[EBP + -0x54]
0094cdbe : CALL 0x00406560
0094cdc3 : MOV dword ptr [EBP + -0x4],0xffffffff
0094cdca : LEA ECX,[EBP + -0x2c]
0094cdcd : CALL 0x00406560
0094cdd2 : MOV ECX,dword ptr [EBP + -0xc]
0094cdd5 : MOV dword ptr FS:[0x0],ECX
0094cddc : POP ECX
0094cddd : POP EDI
0094cdde : POP ESI
0094cddf : POP EBX
0094cde0 : MOV ECX,dword ptr [EBP + -0x10]
0094cde3 : XOR ECX,EBP
0094cde5 : CALL 0x00633e6b
0094cdea : MOV ESP,EBP
0094cdec : POP EBP
0094cded : RET 0x10

PROGRAM  : Maestia.exe
FUNCTION : __strnicmp_l
ENTRY    : 0063b90b
BODY     : [[0063b90b, 0063b9fc]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    __strnicmp_l
   
   Library: Visual Studio 2008 Release */

int __cdecl __strnicmp_l(char *_Str1,char *_Str2,size_t _MaxCount,_locale_t _Locale)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  localeinfo_struct local_14;
  int local_c;
  char local_8;
  
  if (_MaxCount == 0) {
    iVar2 = 0;
  }
  else {
    _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)&local_14,_Locale);
    if ((_Str1 == (char *)0x0) || (_Str2 == (char *)0x0)) {
      piVar1 = __errno();
      *piVar1 = 0x16;
      __invalid_parameter(0,0,0,0,0);
      if (local_8 != '\0') {
        *(uint *)(local_c + 0x70) = *(uint *)(local_c + 0x70) & 0xfffffffd;
      }
      iVar2 = 0x7fffffff;
    }
    else if (_MaxCount < 0x80000000) {
      if ((local_14.locinfo)->lc_category[0].wlocale == (wchar_t *)0x0) {
        iVar2 = ___ascii_strnicmp(_Str1,_Str2,_MaxCount);
      }
      else {
        do {
          iVar2 = __tolower_l((uint)(byte)*_Str1,&local_14);
          _Str1 = _Str1 + 1;
          iVar3 = __tolower_l((uint)(byte)*_Str2,&local_14);
          _Str2 = (char *)((byte *)_Str2 + 1);
          _MaxCount = _MaxCount - 1;
          if ((_MaxCount == 0) || (iVar2 == 0)) break;
        } while (iVar2 == iVar3);
        iVar2 = iVar2 - iVar3;
      }
      if (local_8 != '\0') {
        *(uint *)(local_c + 0x70) = *(uint *)(local_c + 0x70) & 0xfffffffd;
      }
    }
    else {
      piVar1 = __errno();
      *piVar1 = 0x16;
      __invalid_parameter(0,0,0,0,0);
      if (local_8 != '\0') {
        *(uint *)(local_c + 0x70) = *(uint *)(local_c + 0x70) & 0xfffffffd;
      }
      iVar2 = 0x7fffffff;
    }
  }
  return iVar2;
}



============================================================
DISASSEMBLY
============================================================
0063b90b : MOV EDI,EDI
0063b90d : PUSH EBP
0063b90e : MOV EBP,ESP
0063b910 : SUB ESP,0x10
0063b913 : PUSH EBX
0063b914 : XOR EBX,EBX
0063b916 : PUSH ESI
0063b917 : PUSH EDI
0063b918 : CMP dword ptr [EBP + 0x10],EBX
0063b91b : JZ 0x0063b9f6
0063b921 : PUSH dword ptr [EBP + 0x14]
0063b924 : LEA ECX,[EBP + -0x10]
0063b927 : CALL 0x00637880
0063b92c : CMP dword ptr [EBP + 0x8],EBX
0063b92f : JNZ 0x0063b95f
0063b931 : CALL 0x0063ab82
0063b936 : PUSH EBX
0063b937 : PUSH EBX
0063b938 : PUSH EBX
0063b939 : PUSH EBX
0063b93a : PUSH EBX
0063b93b : MOV dword ptr [EAX],0x16
0063b941 : CALL 0x006372b8
0063b946 : ADD ESP,0x14
0063b949 : CMP byte ptr [EBP + -0x4],BL
0063b94c : JZ 0x0063b955
0063b94e : MOV EAX,dword ptr [EBP + -0x8]
0063b951 : AND dword ptr [EAX + 0x70],0xfffffffd
0063b955 : MOV EAX,0x7fffffff
0063b95a : JMP 0x0063b9f8
0063b95f : MOV EDI,dword ptr [EBP + 0xc]
0063b962 : CMP EDI,EBX
0063b964 : JZ 0x0063b931
0063b966 : MOV ESI,0x7fffffff
0063b96b : CMP dword ptr [EBP + 0x10],ESI
0063b96e : JBE 0x0063b998
0063b970 : CALL 0x0063ab82
0063b975 : PUSH EBX
0063b976 : PUSH EBX
0063b977 : PUSH EBX
0063b978 : PUSH EBX
0063b979 : PUSH EBX
0063b97a : MOV dword ptr [EAX],0x16
0063b980 : CALL 0x006372b8
0063b985 : ADD ESP,0x14
0063b988 : CMP byte ptr [EBP + -0x4],BL
0063b98b : JZ 0x0063b994
0063b98d : MOV EAX,dword ptr [EBP + -0x8]
0063b990 : AND dword ptr [EAX + 0x70],0xfffffffd
0063b994 : MOV EAX,ESI
0063b996 : JMP 0x0063b9f8
0063b998 : MOV EAX,dword ptr [EBP + -0x10]
0063b99b : CMP dword ptr [EAX + 0x14],EBX
0063b99e : JNZ 0x0063b9bd
0063b9a0 : PUSH dword ptr [EBP + 0x10]
0063b9a3 : PUSH EDI
0063b9a4 : PUSH dword ptr [EBP + 0x8]
0063b9a7 : CALL 0x00658a40
0063b9ac : ADD ESP,0xc
0063b9af : CMP byte ptr [EBP + -0x4],BL
0063b9b2 : JZ 0x0063b9f8
0063b9b4 : MOV ECX,dword ptr [EBP + -0x8]
0063b9b7 : AND dword ptr [ECX + 0x70],0xfffffffd
0063b9bb : JMP 0x0063b9f8
0063b9bd : MOV EAX,dword ptr [EBP + 0x8]
0063b9c0 : MOVZX EAX,byte ptr [EAX]
0063b9c3 : LEA ECX,[EBP + -0x10]
0063b9c6 : PUSH ECX
0063b9c7 : PUSH EAX
0063b9c8 : CALL 0x00637907
0063b9cd : INC dword ptr [EBP + 0x8]
0063b9d0 : MOV ESI,EAX
0063b9d2 : MOVZX EAX,byte ptr [EDI]
0063b9d5 : LEA ECX,[EBP + -0x10]
0063b9d8 : PUSH ECX
0063b9d9 : PUSH EAX
0063b9da : CALL 0x00637907
0063b9df : ADD ESP,0x10
0063b9e2 : INC EDI
0063b9e3 : DEC dword ptr [EBP + 0x10]
0063b9e6 : JZ 0x0063b9f0
0063b9e8 : CMP ESI,EBX
0063b9ea : JZ 0x0063b9f0
0063b9ec : CMP ESI,EAX
0063b9ee : JZ 0x0063b9bd
0063b9f0 : SUB ESI,EAX
0063b9f2 : MOV EAX,ESI
0063b9f4 : JMP 0x0063b9af
0063b9f6 : XOR EAX,EAX
0063b9f8 : POP EDI
0063b9f9 : POP ESI
0063b9fa : POP EBX
0063b9fb : LEAVE
0063b9fc : RET

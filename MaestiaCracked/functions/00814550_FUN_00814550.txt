PROGRAM  : Maestia.exe
FUNCTION : FUN_00814550
ENTRY    : 00814550
BODY     : [[00814550, 00814975]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_00814550(void)

{
  short sVar1;
  bool bVar2;
  char cVar3;
  short *psVar4;
  int *in_ECX;
  int local_2268;
  wchar_t local_2250 [256];
  undefined1 local_2050 [4];
  uint local_204c;
  undefined4 local_203c;
  uint local_2038;
  uint local_2030;
  undefined4 local_2020;
  uint local_201c;
  short local_2018 [4096];
  uint local_18;
  undefined4 uStack_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  puStack_c = &LAB_00b298de;
  local_10 = ExceptionList;
  uStack_14 = 0x81456b;
  local_18 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_2038 = 7;
  local_203c = 0;
  local_204c = local_204c & 0xffff0000;
  local_201c = 7;
  local_2020 = 0;
  local_2030 = local_2030 & 0xffff0000;
  local_8._0_1_ = 1;
  local_8._1_3_ = 0;
  bVar2 = false;
  while (((uint)in_ECX[9] < (uint)in_ECX[8] &&
         (cVar3 = (**(code **)(*in_ECX + 0x1c))(), cVar3 != '\0'))) {
    if (local_2268 == 0x2001) {
      FUN_0070d320();
      psVar4 = local_2018;
      do {
        sVar1 = *psVar4;
        psVar4 = psVar4 + 1;
      } while (sVar1 != 0);
      FUN_00406360();
      bVar2 = true;
    }
    else if (local_2268 == 0x2002) {
      FUN_0070d080();
      psVar4 = local_2018;
      do {
        sVar1 = *psVar4;
        psVar4 = psVar4 + 1;
      } while (sVar1 != 0);
      FUN_00406360();
      if (!bVar2) {
        _wcscpy_s(local_2250,0x100,L"");
        local_8._0_1_ = 2;
        FUN_0041f590();
        FUN_008018d0();
        local_8._0_1_ = 1;
      }
      FUN_00405eb0();
      local_8._0_1_ = 3;
      FUN_00405eb0(local_2050,0,0xffffffff);
      local_8._0_1_ = 1;
      FUN_0044dd20();
      local_8._0_1_ = 5;
      FUN_00416e00();
      local_8._0_1_ = 6;
      FUN_00414920();
      local_8._0_1_ = 5;
      FUN_0044ca10();
      local_8._0_1_ = 1;
      FUN_0044ca10();
      FUN_00406360();
      FUN_00406360();
      bVar2 = false;
    }
    else {
      if (local_2268 == 0x2003) {
        if (bVar2) {
          _wcscpy_s(local_2250,0x100,L"");
          local_8._0_1_ = 7;
          FUN_0041f590();
          FUN_008018d0();
        }
        local_8 = (uint)local_8._1_3_ << 8;
        if (7 < local_201c) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_201c = 7;
        local_2020 = 0;
        local_2030 = local_2030 & 0xffff0000;
        local_8 = 0xffffffff;
        if (7 < local_2038) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        goto LAB_00814952;
      }
      (**(code **)(*in_ECX + 0x24))();
    }
  }
  local_8 = (uint)local_8._1_3_ << 8;
  if (7 < local_201c) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_201c = 7;
  local_2020 = 0;
  local_2030 = local_2030 & 0xffff0000;
  local_8 = 0xffffffff;
  if (7 < local_2038) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
LAB_00814952:
  local_8 = 0xffffffff;
  local_201c = 7;
  local_2020 = 0;
  local_2038 = 7;
  local_204c = local_204c & 0xffff0000;
  local_203c = 0;
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00814550 : PUSH EBP
00814551 : MOV EBP,ESP
00814553 : PUSH -0x1
00814555 : PUSH 0xb298de
0081455a : MOV EAX,FS:[0x0]
00814560 : PUSH EAX
00814561 : MOV EAX,0x22d8
00814566 : CALL 0x0063b780
0081456b : MOV EAX,[0x00d66fa0]
00814570 : XOR EAX,EBP
00814572 : MOV dword ptr [EBP + -0x14],EAX
00814575 : PUSH EBX
00814576 : PUSH ESI
00814577 : PUSH EDI
00814578 : PUSH EAX
00814579 : LEA EAX,[EBP + -0xc]
0081457c : MOV FS:[0x0],EAX
00814582 : MOV EAX,dword ptr [EBP + 0x8]
00814585 : MOV EDI,ECX
00814587 : MOV dword ptr [EBP + 0xffffdda8],EAX
0081458d : MOV EAX,0x7
00814592 : XOR ESI,ESI
00814594 : XOR ECX,ECX
00814596 : MOV dword ptr [EBP + 0xffffdda4],EDI
0081459c : MOV dword ptr [EBP + 0xffffdfcc],EAX
008145a2 : MOV dword ptr [EBP + 0xffffdfc8],ESI
008145a8 : MOV word ptr [EBP + 0xffffdfb8],CX
008145af : MOV dword ptr [EBP + -0x4],ESI
008145b2 : XOR EDX,EDX
008145b4 : MOV dword ptr [EBP + 0xffffdfe8],EAX
008145ba : MOV dword ptr [EBP + 0xffffdfe4],ESI
008145c0 : MOV word ptr [EBP + 0xffffdfd4],DX
008145c7 : MOV byte ptr [EBP + -0x4],0x1
008145cb : XOR BL,BL
008145cd : LEA ECX,[ECX]
008145d0 : MOV EAX,dword ptr [EDI + 0x24]
008145d3 : CMP EAX,dword ptr [EDI + 0x20]
008145d6 : JNC 0x008148f0
008145dc : MOV EDX,dword ptr [EDI]
008145de : MOV EDX,dword ptr [EDX + 0x1c]
008145e1 : LEA EAX,[EBP + 0xffffdd9c]
008145e7 : PUSH EAX
008145e8 : MOV ECX,EDI
008145ea : CALL EDX
008145ec : TEST AL,AL
008145ee : JZ 0x008148f0
008145f4 : MOV EAX,dword ptr [EBP + 0xffffdd9c]
008145fa : SUB EAX,0x2001
008145ff : JZ 0x008147cc
00814605 : SUB EAX,0x1
00814608 : JZ 0x00814625
0081460a : SUB EAX,0x1
0081460d : JZ 0x0081480c
00814613 : MOV ECX,dword ptr [EBP + 0xffffdda0]
00814619 : MOV EAX,dword ptr [EDI]
0081461b : MOV EDX,dword ptr [EAX + 0x24]
0081461e : PUSH ECX
0081461f : MOV ECX,EDI
00814621 : CALL EDX
00814623 : JMP 0x008145d0
00814625 : LEA EAX,[EBP + 0xffffdfec]
0081462b : PUSH EAX
0081462c : CALL 0x0070d080
00814631 : LEA EAX,[EBP + 0xffffdfec]
00814637 : LEA EDX,[EAX + 0x2]
0081463a : LEA EBX,[EBX]
00814640 : MOV CX,word ptr [EAX]
00814643 : ADD EAX,0x2
00814646 : CMP CX,SI
00814649 : JNZ 0x00814640
0081464b : SUB EAX,EDX
0081464d : SAR EAX,0x1
0081464f : PUSH EAX
00814650 : LEA ECX,[EBP + 0xffffdfec]
00814656 : PUSH ECX
00814657 : LEA ECX,[EBP + 0xffffdfd0]
0081465d : CALL 0x00406360
00814662 : TEST BL,BL
00814664 : JNZ 0x008146df
00814666 : PUSH 0xcca49c
0081466b : LEA EDX,[EBP + 0xffffddb4]
00814671 : PUSH 0x100
00814676 : MOV EDI,0xcd083c
0081467b : PUSH EDX
0081467c : MOV dword ptr [EBP + 0xffffddac],EDI
00814682 : MOV dword ptr [EBP + 0xffffddb0],0xff
0081468c : CALL 0x0063481b
00814691 : ADD ESP,0xc
00814694 : MOV byte ptr [EBP + -0x4],0x2
00814698 : CMP dword ptr [EBP + 0xffffdfe8],0x8
0081469f : MOV EAX,dword ptr [EBP + 0xffffdfd4]
008146a5 : JNC 0x008146ad
008146a7 : LEA EAX,[EBP + 0xffffdfd4]
008146ad : PUSH EAX
008146ae : PUSH 0xc2e818
008146b3 : LEA ECX,[EBP + 0xffffddac]
008146b9 : CALL 0x0041f590
008146be : MOV ESI,dword ptr [0x00da98e8]
008146c4 : LEA EAX,[EBP + 0xffffddb4]
008146ca : PUSH EAX
008146cb : CALL 0x008018d0
008146d0 : ADD ESP,0xc
008146d3 : MOV byte ptr [EBP + -0x4],0x1
008146d7 : MOV dword ptr [EBP + 0xffffddac],EDI
008146dd : XOR ESI,ESI
008146df : SUB ESP,0x1c
008146e2 : MOV ECX,ESP
008146e4 : MOV dword ptr [EBP + 0xffffdd94],ESP
008146ea : PUSH -0x1
008146ec : PUSH ESI
008146ed : LEA EAX,[EBP + 0xffffdfd0]
008146f3 : MOV EDI,0x7
008146f8 : XOR EDX,EDX
008146fa : MOV dword ptr [ECX + 0x18],EDI
008146fd : MOV dword ptr [ECX + 0x14],ESI
00814700 : PUSH EAX
00814701 : MOV word ptr [ECX + 0x4],DX
00814705 : CALL 0x00405eb0
0081470a : MOV byte ptr [EBP + -0x4],0x3
0081470e : SUB ESP,0x1c
00814711 : MOV ECX,ESP
00814713 : MOV dword ptr [EBP + 0xffffdd98],ESP
00814719 : PUSH -0x1
0081471b : PUSH ESI
0081471c : LEA EAX,[EBP + 0xffffdfb4]
00814722 : XOR EDX,EDX
00814724 : MOV dword ptr [ECX + 0x18],EDI
00814727 : MOV dword ptr [ECX + 0x14],ESI
0081472a : PUSH EAX
0081472b : MOV word ptr [ECX + 0x4],DX
0081472f : CALL 0x00405eb0
00814734 : MOV byte ptr [EBP + -0x4],0x4
00814738 : MOV byte ptr [EBP + -0x4],0x1
0081473c : LEA ESI,[EBP + 0xffffdd1c]
00814742 : CALL 0x0044dd20
00814747 : ADD ESP,0x38
0081474a : MOV byte ptr [EBP + -0x4],0x5
0081474e : LEA ECX,[EBP + 0xffffdd54]
00814754 : PUSH ECX
00814755 : MOV EDI,EAX
00814757 : CALL 0x00416e00
0081475c : MOV byte ptr [EBP + -0x4],0x6
00814760 : MOV ECX,dword ptr [EBP + 0xffffdda8]
00814766 : LEA EDX,[EBP + 0xffffdd54]
0081476c : PUSH EDX
0081476d : LEA EAX,[EBP + 0xffffdd8c]
00814773 : PUSH EAX
00814774 : ADD ECX,0x24
00814777 : PUSH ECX
00814778 : CALL 0x00414920
0081477d : MOV byte ptr [EBP + -0x4],0x5
00814781 : LEA EDX,[EBP + 0xffffdd54]
00814787 : PUSH EDX
00814788 : CALL 0x0044ca10
0081478d : MOV byte ptr [EBP + -0x4],0x1
00814791 : MOV EAX,ESI
00814793 : PUSH EAX
00814794 : CALL 0x0044ca10
00814799 : PUSH 0x0
0081479b : PUSH 0xc2e8f8
008147a0 : LEA ECX,[EBP + 0xffffdfb4]
008147a6 : CALL 0x00406360
008147ab : PUSH 0x0
008147ad : PUSH 0xc2e8fc
008147b2 : LEA ECX,[EBP + 0xffffdfd0]
008147b8 : CALL 0x00406360
008147bd : MOV EDI,dword ptr [EBP + 0xffffdda4]
008147c3 : XOR BL,BL
008147c5 : XOR ESI,ESI
008147c7 : JMP 0x008145d0
008147cc : LEA ECX,[EBP + 0xffffdfec]
008147d2 : PUSH ECX
008147d3 : MOV ECX,EDI
008147d5 : CALL 0x0070d320
008147da : LEA EAX,[EBP + 0xffffdfec]
008147e0 : LEA EDX,[EAX + 0x2]
008147e3 : MOV CX,word ptr [EAX]
008147e6 : ADD EAX,0x2
008147e9 : CMP CX,SI
008147ec : JNZ 0x008147e3
008147ee : SUB EAX,EDX
008147f0 : SAR EAX,0x1
008147f2 : PUSH EAX
008147f3 : LEA EDX,[EBP + 0xffffdfec]
008147f9 : PUSH EDX
008147fa : LEA ECX,[EBP + 0xffffdfb4]
00814800 : CALL 0x00406360
00814805 : MOV BL,0x1
00814807 : JMP 0x008145d0
0081480c : TEST BL,BL
0081480e : JZ 0x0081488f
00814810 : PUSH 0xcca49c
00814815 : LEA EAX,[EBP + 0xffffddb4]
0081481b : PUSH 0x100
00814820 : MOV EDI,0xcd083c
00814825 : PUSH EAX
00814826 : MOV dword ptr [EBP + 0xffffddac],EDI
0081482c : MOV dword ptr [EBP + 0xffffddb0],0xff
00814836 : CALL 0x0063481b
0081483b : ADD ESP,0xc
0081483e : MOV byte ptr [EBP + -0x4],0x7
00814842 : MOV EAX,dword ptr [EBP + 0xffffdfb8]
00814848 : MOV EBX,0x8
0081484d : CMP dword ptr [EBP + 0xffffdfcc],EBX
00814853 : JNC 0x0081485b
00814855 : LEA EAX,[EBP + 0xffffdfb8]
0081485b : PUSH EAX
0081485c : PUSH 0xc2e900
00814861 : LEA ECX,[EBP + 0xffffddac]
00814867 : CALL 0x0041f590
0081486c : MOV ESI,dword ptr [0x00da98e8]
00814872 : LEA ECX,[EBP + 0xffffddb4]
00814878 : PUSH ECX
00814879 : CALL 0x008018d0
0081487e : ADD ESP,0xc
00814881 : MOV byte ptr [EBP + -0x4],0x1
00814885 : MOV dword ptr [EBP + 0xffffddac],EDI
0081488b : XOR ESI,ESI
0081488d : JMP 0x00814894
0081488f : MOV EBX,0x8
00814894 : MOV byte ptr [EBP + -0x4],0x0
00814898 : CMP dword ptr [EBP + 0xffffdfe8],EBX
0081489e : JC 0x008148ab
008148a0 : MOV ECX,dword ptr [EBP + 0xffffdfd4]
008148a6 : CALL 0x006f04e0
008148ab : MOV EDI,0x7
008148b0 : XOR EDX,EDX
008148b2 : MOV dword ptr [EBP + 0xffffdfe8],EDI
008148b8 : MOV dword ptr [EBP + 0xffffdfe4],ESI
008148be : MOV word ptr [EBP + 0xffffdfd4],DX
008148c5 : MOV dword ptr [EBP + -0x4],0xffffffff
008148cc : CMP dword ptr [EBP + 0xffffdfcc],EBX
008148d2 : JC 0x008148df
008148d4 : MOV ECX,dword ptr [EBP + 0xffffdfb8]
008148da : CALL 0x006f04e0
008148df : XOR EAX,EAX
008148e1 : MOV dword ptr [EBP + 0xffffdfcc],EDI
008148e7 : MOV word ptr [EBP + 0xffffdfb8],AX
008148ee : JMP 0x00814952
008148f0 : MOV byte ptr [EBP + -0x4],0x0
008148f4 : MOV EDI,0x8
008148f9 : CMP dword ptr [EBP + 0xffffdfe8],EDI
008148ff : JC 0x0081490c
00814901 : MOV ECX,dword ptr [EBP + 0xffffdfd4]
00814907 : CALL 0x006f04e0
0081490c : XOR ECX,ECX
0081490e : MOV dword ptr [EBP + 0xffffdfe8],0x7
00814918 : MOV dword ptr [EBP + 0xffffdfe4],ESI
0081491e : MOV word ptr [EBP + 0xffffdfd4],CX
00814925 : MOV dword ptr [EBP + -0x4],0xffffffff
0081492c : CMP dword ptr [EBP + 0xffffdfcc],EDI
00814932 : JC 0x0081493f
00814934 : MOV ECX,dword ptr [EBP + 0xffffdfb8]
0081493a : CALL 0x006f04e0
0081493f : XOR EDX,EDX
00814941 : MOV dword ptr [EBP + 0xffffdfcc],0x7
0081494b : MOV word ptr [EBP + 0xffffdfb8],DX
00814952 : MOV dword ptr [EBP + 0xffffdfc8],ESI
00814958 : MOV ECX,dword ptr [EBP + -0xc]
0081495b : MOV dword ptr FS:[0x0],ECX
00814962 : POP ECX
00814963 : POP EDI
00814964 : POP ESI
00814965 : POP EBX
00814966 : MOV ECX,dword ptr [EBP + -0x14]
00814969 : XOR ECX,EBP
0081496b : CALL 0x00633e6b
00814970 : MOV ESP,EBP
00814972 : POP EBP
00814973 : RET 0x4

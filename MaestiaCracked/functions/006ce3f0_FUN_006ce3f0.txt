PROGRAM  : Maestia.exe
FUNCTION : FUN_006ce3f0
ENTRY    : 006ce3f0
BODY     : [[006ce3f0, 006ce51b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006ce3f0(int param_1,int param_2,char *param_3,undefined1 param_4,void *param_5,
                 size_t param_6)

{
  size_t sVar1;
  char *_Dest;
  void *_Dst;
  
  if ((((param_1 != 0) && (param_2 != 0)) && (param_3 != (char *)0x0)) && (param_5 != (void *)0x0))
  {
    sVar1 = _strlen(param_3);
    _Dest = (char *)FUN_006cef50(param_1,sVar1 + 1);
    if (_Dest == (char *)0x0) {
      FUN_006c24c0(param_1,"Insufficient memory to process iCCP chunk.");
    }
    else {
      _strcpy(_Dest,param_3);
      _Dst = (void *)FUN_006cef50(param_1,param_6);
      if (_Dst == (void *)0x0) {
        FUN_006ceee0(param_1,_Dest);
        FUN_006c24c0(param_1,"Insufficient memory to process iCCP profile.");
      }
      else {
        _memcpy(_Dst,param_5,param_6);
        FUN_006ccba0(param_1,param_2,0x10,0);
        *(size_t *)(param_2 + 0xcc) = param_6;
        *(char **)(param_2 + 0xc4) = _Dest;
        *(void **)(param_2 + 200) = _Dst;
        *(undefined1 *)(param_2 + 0xd0) = param_4;
        *(uint *)(param_2 + 0xb8) = *(uint *)(param_2 + 0xb8) | 0x10;
        *(uint *)(param_2 + 8) = *(uint *)(param_2 + 8) | 0x1000;
      }
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
006ce3f0 : PUSH EBP
006ce3f1 : MOV EBP,ESP
006ce3f3 : SUB ESP,0x8
006ce3f6 : CMP dword ptr [EBP + 0x8],0x0
006ce3fa : JZ 0x006ce40e
006ce3fc : CMP dword ptr [EBP + 0xc],0x0
006ce400 : JZ 0x006ce40e
006ce402 : CMP dword ptr [EBP + 0x10],0x0
006ce406 : JZ 0x006ce40e
006ce408 : CMP dword ptr [EBP + 0x18],0x0
006ce40c : JNZ 0x006ce413
006ce40e : JMP 0x006ce518
006ce413 : MOV EAX,dword ptr [EBP + 0x10]
006ce416 : PUSH EAX
006ce417 : CALL 0x00640960
006ce41c : ADD ESP,0x4
006ce41f : ADD EAX,0x1
006ce422 : PUSH EAX
006ce423 : MOV ECX,dword ptr [EBP + 0x8]
006ce426 : PUSH ECX
006ce427 : CALL 0x006cef50
006ce42c : ADD ESP,0x8
006ce42f : MOV dword ptr [EBP + -0x8],EAX
006ce432 : CMP dword ptr [EBP + -0x8],0x0
006ce436 : JNZ 0x006ce44e
006ce438 : PUSH 0xbededc
006ce43d : MOV EDX,dword ptr [EBP + 0x8]
006ce440 : PUSH EDX
006ce441 : CALL 0x006c24c0
006ce446 : ADD ESP,0x8
006ce449 : JMP 0x006ce518
006ce44e : MOV EAX,dword ptr [EBP + 0x10]
006ce451 : PUSH EAX
006ce452 : MOV ECX,dword ptr [EBP + -0x8]
006ce455 : PUSH ECX
006ce456 : CALL 0x006d4a70
006ce45b : ADD ESP,0x8
006ce45e : MOV EDX,dword ptr [EBP + 0x1c]
006ce461 : PUSH EDX
006ce462 : MOV EAX,dword ptr [EBP + 0x8]
006ce465 : PUSH EAX
006ce466 : CALL 0x006cef50
006ce46b : ADD ESP,0x8
006ce46e : MOV dword ptr [EBP + -0x4],EAX
006ce471 : CMP dword ptr [EBP + -0x4],0x0
006ce475 : JNZ 0x006ce49a
006ce477 : MOV ECX,dword ptr [EBP + -0x8]
006ce47a : PUSH ECX
006ce47b : MOV EDX,dword ptr [EBP + 0x8]
006ce47e : PUSH EDX
006ce47f : CALL 0x006ceee0
006ce484 : ADD ESP,0x8
006ce487 : PUSH 0xbedeac
006ce48c : MOV EAX,dword ptr [EBP + 0x8]
006ce48f : PUSH EAX
006ce490 : CALL 0x006c24c0
006ce495 : ADD ESP,0x8
006ce498 : JMP 0x006ce518
006ce49a : MOV ECX,dword ptr [EBP + 0x1c]
006ce49d : PUSH ECX
006ce49e : MOV EDX,dword ptr [EBP + 0x18]
006ce4a1 : PUSH EDX
006ce4a2 : MOV EAX,dword ptr [EBP + -0x4]
006ce4a5 : PUSH EAX
006ce4a6 : CALL 0x0063ae40
006ce4ab : ADD ESP,0xc
006ce4ae : PUSH 0x0
006ce4b0 : PUSH 0x10
006ce4b2 : MOV ECX,dword ptr [EBP + 0xc]
006ce4b5 : PUSH ECX
006ce4b6 : MOV EDX,dword ptr [EBP + 0x8]
006ce4b9 : PUSH EDX
006ce4ba : CALL 0x006ccba0
006ce4bf : ADD ESP,0x10
006ce4c2 : MOV EAX,dword ptr [EBP + 0xc]
006ce4c5 : MOV ECX,dword ptr [EBP + 0x1c]
006ce4c8 : MOV dword ptr [EAX + 0xcc],ECX
006ce4ce : MOV EDX,dword ptr [EBP + 0xc]
006ce4d1 : MOV EAX,dword ptr [EBP + -0x8]
006ce4d4 : MOV dword ptr [EDX + 0xc4],EAX
006ce4da : MOV ECX,dword ptr [EBP + 0xc]
006ce4dd : MOV EDX,dword ptr [EBP + -0x4]
006ce4e0 : MOV dword ptr [ECX + 0xc8],EDX
006ce4e6 : MOV EAX,dword ptr [EBP + 0xc]
006ce4e9 : MOV CL,byte ptr [EBP + 0x14]
006ce4ec : MOV byte ptr [EAX + 0xd0],CL
006ce4f2 : MOV EDX,dword ptr [EBP + 0xc]
006ce4f5 : MOV EAX,dword ptr [EDX + 0xb8]
006ce4fb : OR EAX,0x10
006ce4fe : MOV ECX,dword ptr [EBP + 0xc]
006ce501 : MOV dword ptr [ECX + 0xb8],EAX
006ce507 : MOV EDX,dword ptr [EBP + 0xc]
006ce50a : MOV EAX,dword ptr [EDX + 0x8]
006ce50d : OR EAX,0x1000
006ce512 : MOV ECX,dword ptr [EBP + 0xc]
006ce515 : MOV dword ptr [ECX + 0x8],EAX
006ce518 : MOV ESP,EBP
006ce51a : POP EBP
006ce51b : RET

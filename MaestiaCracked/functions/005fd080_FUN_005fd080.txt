PROGRAM  : Maestia.exe
FUNCTION : FUN_005fd080
ENTRY    : 005fd080
BODY     : [[005fd080, 005fd0fb] [005fd100, 005fd2af]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005fd080(int param_1,uint param_2)

{
  uint *puVar1;
  undefined4 *puVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  undefined4 uVar7;
  uint uVar8;
  uint uVar9;
  int iVar10;
  int in_ECX;
  uint uVar11;
  uint uVar12;
  int local_1c;
  uint local_c;
  
  iVar3 = *(int *)(param_1 + 4);
  iVar4 = *(int *)(iVar3 + 0x14);
  iVar5 = *(int *)(iVar3 + 0x10);
  *(undefined4 *)(iVar3 + 0x14) = 0;
  uVar12 = *(uint *)(iVar4 + 0x10);
  uVar6 = *(uint *)(iVar4 + 0xc);
  local_1c = *(int *)(iVar4 + 0x14);
  local_c = *(uint *)(*(int *)(*(int *)(in_ECX + 0x150) + (uVar12 >> 4) * 4) + (uVar12 & 0xf) * 8);
  FUN_005fcb20(*(undefined4 *)(param_1 + 4),local_c);
  FUN_005fcb20(*(undefined4 *)(param_1 + 4),param_2);
  while (uVar8 = local_c, local_1c != 0) {
    local_1c = local_1c + -1;
    uVar11 = uVar12 >> 4;
    uVar9 = uVar12 & 0xf;
    uVar12 = uVar12 + 1;
    iVar3 = *(int *)(*(int *)(in_ECX + 0x150) + uVar11 * 4) + uVar9 * 8;
    local_c = uVar6;
    if (local_1c != 0) {
      local_c = *(uint *)(*(int *)(*(int *)(in_ECX + 0x150) + (uVar12 >> 4) * 4) +
                         (uVar12 & 0xf) * 8);
    }
    if (*(int *)(iVar3 + 4) == 0) {
      iVar10 = 0;
    }
    else {
      iVar10 = *(int *)(*(int *)(iVar3 + 4) + 0x10);
    }
    if (uVar8 != local_c) {
      if ((iVar10 != iVar5) || (*(int *)(iVar3 + 4) == 0)) {
        puVar1 = (uint *)(in_ECX + 0x154);
        uVar9 = *(uint *)(in_ECX + 0x154) >> 6;
        if (*(uint *)(in_ECX + 0x158) <= uVar9) {
          FUN_005fa3f0(uVar9);
        }
        puVar2 = (undefined4 *)
                 (*(int *)(*(int *)(in_ECX + 0x160) + uVar9 * 4) + (*puVar1 & 0x3f) * 0x18);
        *puVar2 = 0;
        puVar2[1] = 0xffffffff;
        puVar2[2] = 0xffffffff;
        puVar2[3] = 0xffffffff;
        puVar2[4] = iVar5;
        puVar2[5] = 0;
        *puVar1 = *puVar1 + 1;
        iVar10 = *(int *)(*(int *)(in_ECX + 0x160) + (*puVar1 - 1 >> 6) * 4) +
                 (*puVar1 - 1 & 0x3f) * 0x18;
        *(int *)(iVar3 + 4) = iVar10;
        if (uVar8 != 0xffffffff) {
          FUN_005fcb20(iVar10,uVar8 | 0x40000000);
        }
        if (local_c != 0xffffffff) {
          FUN_005fcb20(iVar10,local_c & 0xbfffffff);
        }
      }
      uVar7 = *(undefined4 *)(iVar3 + 4);
      if (param_2 != 0xffffffff) {
        FUN_005fcb20(uVar7,param_2 | 0x40000000);
        FUN_005fcb20(uVar7,param_2 & 0xbfffffff);
      }
    }
  }
  uVar12 = *(int *)(in_ECX + 0x134) - 1;
  if (iVar4 == *(int *)(*(int *)(in_ECX + 0x140) + (uVar12 >> 4) * 4) + (uVar12 & 0xf) * 0x1c) {
    if (*(uint *)(iVar4 + 0x10) < *(uint *)(in_ECX + 0x144)) {
      *(uint *)(in_ECX + 0x144) = *(uint *)(iVar4 + 0x10);
    }
    if (*(int *)(in_ECX + 0x134) != 0) {
      *(int *)(in_ECX + 0x134) = *(int *)(in_ECX + 0x134) + -1;
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005fd080 : SUB ESP,0x30
005fd083 : PUSH EBX
005fd084 : PUSH EBP
005fd085 : PUSH ESI
005fd086 : PUSH EDI
005fd087 : MOV EDI,dword ptr [ESP + 0x44]
005fd08b : MOV EAX,dword ptr [EDI + 0x4]
005fd08e : MOV EBP,dword ptr [EAX + 0x14]
005fd091 : MOV EBX,ECX
005fd093 : MOV ECX,dword ptr [EAX + 0x10]
005fd096 : MOV dword ptr [EAX + 0x14],0x0
005fd09d : MOV EAX,dword ptr [EDI + 0x4]
005fd0a0 : MOV EDX,dword ptr [EBP + 0x8]
005fd0a3 : MOV ESI,dword ptr [EBP + 0x10]
005fd0a6 : MOV dword ptr [ESP + 0x44],ECX
005fd0aa : MOV ECX,dword ptr [EBP + 0xc]
005fd0ad : MOV dword ptr [ESP + 0x18],EAX
005fd0b1 : MOV EAX,dword ptr [EBP + 0x14]
005fd0b4 : MOV dword ptr [ESP + 0x14],EDX
005fd0b8 : MOV dword ptr [ESP + 0x24],EAX
005fd0bc : MOV EAX,dword ptr [EBX + 0x150]
005fd0c2 : MOV dword ptr [ESP + 0x28],ECX
005fd0c6 : MOV EDX,ESI
005fd0c8 : SHR EDX,0x4
005fd0cb : MOV EDX,dword ptr [EAX + EDX*0x4]
005fd0ce : MOV ECX,ESI
005fd0d0 : AND ECX,0xf
005fd0d3 : MOV EAX,dword ptr [EDX + ECX*0x8]
005fd0d6 : PUSH EAX
005fd0d7 : MOV dword ptr [ESP + 0x38],EAX
005fd0db : MOV EAX,dword ptr [EDI + 0x4]
005fd0de : PUSH EAX
005fd0df : MOV ECX,EBX
005fd0e1 : MOV dword ptr [ESP + 0x18],EBP
005fd0e5 : CALL 0x005fcb20
005fd0ea : MOV EAX,dword ptr [ESP + 0x48]
005fd0ee : MOV ECX,dword ptr [EDI + 0x4]
005fd0f1 : PUSH EAX
005fd0f2 : PUSH ECX
005fd0f3 : MOV ECX,EBX
005fd0f5 : CALL 0x005fcb20
005fd0fa : JMP 0x005fd104
005fd100 : MOV EBP,dword ptr [ESP + 0x10]
005fd104 : CMP dword ptr [ESP + 0x24],0x0
005fd109 : JZ 0x005fd25c
005fd10f : MOV ECX,dword ptr [EBX + 0x150]
005fd115 : DEC dword ptr [ESP + 0x24]
005fd119 : MOV EBP,dword ptr [ESP + 0x34]
005fd11d : MOV EAX,ESI
005fd11f : MOV EDX,EAX
005fd121 : SHR EDX,0x4
005fd124 : MOV EDX,dword ptr [ECX + EDX*0x4]
005fd127 : AND EAX,0xf
005fd12a : INC ESI
005fd12b : CMP dword ptr [ESP + 0x24],0x0
005fd130 : LEA EDX,[EDX + EAX*0x8]
005fd133 : MOV dword ptr [ESP + 0x20],ESI
005fd137 : MOV dword ptr [ESP + 0x2c],EDX
005fd13b : JZ 0x005fd153
005fd13d : MOV EAX,ESI
005fd13f : SHR EAX,0x4
005fd142 : MOV ECX,dword ptr [ECX + EAX*0x4]
005fd145 : MOV EDI,ESI
005fd147 : AND EDI,0xf
005fd14a : MOV EAX,dword ptr [ECX + EDI*0x8]
005fd14d : MOV dword ptr [ESP + 0x34],EAX
005fd151 : JMP 0x005fd15b
005fd153 : MOV ECX,dword ptr [ESP + 0x28]
005fd157 : MOV dword ptr [ESP + 0x34],ECX
005fd15b : MOV EAX,dword ptr [EDX + 0x4]
005fd15e : TEST EAX,EAX
005fd160 : JZ 0x005fd167
005fd162 : MOV EAX,dword ptr [EAX + 0x10]
005fd165 : JMP 0x005fd169
005fd167 : XOR EAX,EAX
005fd169 : CMP EBP,dword ptr [ESP + 0x34]
005fd16d : JZ 0x005fd100
005fd16f : CMP EAX,dword ptr [ESP + 0x44]
005fd173 : JNZ 0x005fd17f
005fd175 : CMP dword ptr [EDX + 0x4],0x0
005fd179 : JNZ 0x005fd225
005fd17f : MOV EDI,dword ptr [EBX + 0x154]
005fd185 : LEA ESI,[EBX + 0x154]
005fd18b : SHR EDI,0x6
005fd18e : CMP EDI,dword ptr [ESI + 0x4]
005fd191 : JC 0x005fd19f
005fd193 : PUSH EDI
005fd194 : MOV ECX,ESI
005fd196 : CALL 0x005fa3f0
005fd19b : MOV EDX,dword ptr [ESP + 0x2c]
005fd19f : MOV EAX,dword ptr [ESI]
005fd1a1 : MOV ECX,dword ptr [ESI + 0xc]
005fd1a4 : MOV ECX,dword ptr [ECX + EDI*0x4]
005fd1a7 : AND EAX,0x3f
005fd1aa : LEA EAX,[EAX + EAX*0x2]
005fd1ad : LEA EAX,[ECX + EAX*0x8]
005fd1b0 : XOR ECX,ECX
005fd1b2 : MOV dword ptr [EAX],ECX
005fd1b4 : OR ECX,0xffffffff
005fd1b7 : MOV dword ptr [EAX + 0x4],ECX
005fd1ba : OR ECX,0xffffffff
005fd1bd : MOV dword ptr [EAX + 0x8],ECX
005fd1c0 : OR ECX,0xffffffff
005fd1c3 : MOV dword ptr [EAX + 0xc],ECX
005fd1c6 : MOV ECX,dword ptr [ESP + 0x44]
005fd1ca : MOV dword ptr [EAX + 0x10],ECX
005fd1cd : XOR ECX,ECX
005fd1cf : MOV dword ptr [EAX + 0x14],ECX
005fd1d2 : INC dword ptr [ESI]
005fd1d4 : MOV EAX,dword ptr [ESI]
005fd1d6 : MOV ESI,dword ptr [ESI + 0xc]
005fd1d9 : DEC EAX
005fd1da : MOV ECX,EAX
005fd1dc : SHR ECX,0x6
005fd1df : MOV ECX,dword ptr [ESI + ECX*0x4]
005fd1e2 : AND EAX,0x3f
005fd1e5 : LEA EAX,[EAX + EAX*0x2]
005fd1e8 : LEA ESI,[ECX + EAX*0x8]
005fd1eb : MOV dword ptr [EDX + 0x4],ESI
005fd1ee : CMP EBP,-0x1
005fd1f1 : JZ 0x005fd206
005fd1f3 : OR EBP,0x40000000
005fd1f9 : PUSH EBP
005fd1fa : PUSH ESI
005fd1fb : MOV ECX,EBX
005fd1fd : CALL 0x005fcb20
005fd202 : MOV EDX,dword ptr [ESP + 0x2c]
005fd206 : MOV EAX,dword ptr [ESP + 0x34]
005fd20a : CMP EAX,-0x1
005fd20d : JZ 0x005fd221
005fd20f : AND EAX,0xbfffffff
005fd214 : PUSH EAX
005fd215 : PUSH ESI
005fd216 : MOV ECX,EBX
005fd218 : CALL 0x005fcb20
005fd21d : MOV EDX,dword ptr [ESP + 0x2c]
005fd221 : MOV ESI,dword ptr [ESP + 0x20]
005fd225 : CMP dword ptr [ESP + 0x48],-0x1
005fd22a : MOV EBP,dword ptr [EDX + 0x4]
005fd22d : JZ 0x005fd100
005fd233 : MOV EDI,dword ptr [ESP + 0x48]
005fd237 : MOV EDX,EDI
005fd239 : OR EDX,0x40000000
005fd23f : PUSH EDX
005fd240 : PUSH EBP
005fd241 : MOV ECX,EBX
005fd243 : CALL 0x005fcb20
005fd248 : AND EDI,0xbfffffff
005fd24e : PUSH EDI
005fd24f : PUSH EBP
005fd250 : MOV ECX,EBX
005fd252 : CALL 0x005fcb20
005fd257 : JMP 0x005fd100
005fd25c : MOV EAX,dword ptr [EBX + 0x134]
005fd262 : MOV EDX,dword ptr [EBX + 0x140]
005fd268 : DEC EAX
005fd269 : MOV ECX,EAX
005fd26b : AND EAX,0xf
005fd26e : SHR ECX,0x4
005fd271 : LEA ESI,[EAX*0x8 + 0x0]
005fd278 : SUB ESI,EAX
005fd27a : MOV EAX,dword ptr [EDX + ECX*0x4]
005fd27d : LEA ECX,[EAX + ESI*0x4]
005fd280 : CMP EBP,ECX
005fd282 : JNZ 0x005fd2a6
005fd284 : MOV EBP,dword ptr [EBP + 0x10]
005fd287 : CMP EBP,dword ptr [EBX + 0x144]
005fd28d : JNC 0x005fd295
005fd28f : MOV dword ptr [EBX + 0x144],EBP
005fd295 : MOV EAX,dword ptr [EBX + 0x134]
005fd29b : TEST EAX,EAX
005fd29d : JZ 0x005fd2a6
005fd29f : DEC EAX
005fd2a0 : MOV dword ptr [EBX + 0x134],EAX
005fd2a6 : POP EDI
005fd2a7 : POP ESI
005fd2a8 : POP EBP
005fd2a9 : POP EBX
005fd2aa : ADD ESP,0x30
005fd2ad : RET 0x8

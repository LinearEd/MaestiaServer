PROGRAM  : Maestia.exe
FUNCTION : FUN_00570d50
ENTRY    : 00570d50
BODY     : [[00570d50, 00570e8d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00570d50(int param_1,uint param_2)

{
  uint uVar1;
  GRefCountNTSImpl *this;
  int *piVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  undefined4 uVar6;
  GRefCountImpl *this_00;
  undefined4 *in_ECX;
  
  uVar3 = param_2;
  in_ECX[3] = param_2;
  in_ECX[4] = param_1;
  in_ECX[1] = 0;
  in_ECX[2] = 0;
  *in_ECX = &PTR_FUN_00b8d1d8;
  in_ECX[5] = 0;
  in_ECX[6] = 0;
  in_ECX[8] = 0;
  in_ECX[9] = 0x10001;
  *(undefined1 *)(in_ECX + 10) = 0;
  in_ECX[0xb] = 0;
  *(undefined1 *)(in_ECX + 0xc) = 0;
  param_2 = param_2 & 0xffffff00;
  uVar1 = param_2;
  param_2._1_3_ = SUB43(uVar3,1);
  if (*(int *)(in_ECX[4] + 0x14) == 0) {
    iVar5 = *(int *)(in_ECX[4] + 0x10);
    if (iVar5 != -1) {
      iVar4 = FUN_0056b260(iVar5);
      if (iVar4 == 0) {
        iVar5 = FUN_0056b260(0);
        if (iVar5 == 0) goto LAB_00570e19;
        iVar5 = 0;
      }
      piVar2 = (int *)FUN_0056b260(iVar5);
      piVar2 = (int *)(**(code **)(*piVar2 + 0x48))();
      uVar3 = (**(code **)(*piVar2 + 0x2c))();
      param_2 = CONCAT31(param_2._1_3_,(char)(uVar3 >> 4)) & 0xffffff01;
      uVar1 = param_2;
    }
  }
  else {
    this = (GRefCountNTSImpl *)FUN_0051d0a0(in_ECX[3]);
    if (this != (GRefCountNTSImpl *)0x0) {
      *(int *)(this + 4) = *(int *)(this + 4) + 1;
      piVar2 = (int *)(**(code **)(*(int *)this + 0x48))();
      uVar3 = (**(code **)(*piVar2 + 0x2c))();
      param_2 = CONCAT31(param_2._1_3_,(char)(uVar3 >> 4)) & 0xffffff01;
      GRefCountNTSImpl::Release(this);
      uVar1 = param_2;
    }
  }
LAB_00570e19:
  param_2 = uVar1;
  iVar5 = FUN_00515840(0x2c,0);
  if (iVar5 == 0) {
    uVar6 = 0;
  }
  else {
    uVar6 = FUN_0056ec50(in_ECX[3],in_ECX[4] + 0xc,param_2,*(undefined1 *)(param_1 + 0x18));
  }
  if ((GRefCountImpl *)in_ECX[5] != (GRefCountImpl *)0x0) {
    GRefCountImpl::Release((GRefCountImpl *)in_ECX[5]);
  }
  in_ECX[5] = uVar6;
  this_00 = (GRefCountImpl *)(**(code **)(*(int *)(in_ECX[3] + 8) + 0xc))(0x17);
  (**(code **)(*(int *)this_00 + 4))(in_ECX[5]);
  GRefCountImpl::Release(this_00);
  return;
}



============================================================
DISASSEMBLY
============================================================
00570d50 : MOV EAX,dword ptr [ESP + 0x8]
00570d54 : PUSH EBX
00570d55 : XOR EBX,EBX
00570d57 : PUSH ESI
00570d58 : MOV ESI,ECX
00570d5a : MOV ECX,dword ptr [ESP + 0xc]
00570d5e : MOV dword ptr [ESI + 0xc],EAX
00570d61 : MOV dword ptr [ESI + 0x10],ECX
00570d64 : MOV dword ptr [ESI + 0x4],EBX
00570d67 : MOV dword ptr [ESI + 0x8],EBX
00570d6a : MOV dword ptr [ESI],0xb8d1d8
00570d70 : MOV dword ptr [ESI + 0x14],EBX
00570d73 : MOV dword ptr [ESI + 0x18],EBX
00570d76 : MOV dword ptr [ESI + 0x20],EBX
00570d79 : MOV dword ptr [ESI + 0x24],0x10001
00570d80 : MOV EAX,dword ptr [ESI + 0x10]
00570d83 : MOV byte ptr [ESI + 0x28],BL
00570d86 : MOV dword ptr [ESI + 0x2c],EBX
00570d89 : MOV byte ptr [ESI + 0x30],BL
00570d8c : MOV ECX,dword ptr [EAX + 0x14]
00570d8f : PUSH EDI
00570d90 : MOV byte ptr [ESP + 0x14],BL
00570d94 : CMP ECX,EBX
00570d96 : JZ 0x00570dce
00570d98 : MOV EDX,dword ptr [ESI + 0xc]
00570d9b : PUSH EDX
00570d9c : CALL 0x0051d0a0
00570da1 : MOV EDI,EAX
00570da3 : CMP EDI,EBX
00570da5 : JZ 0x00570e19
00570da7 : INC dword ptr [EDI + 0x4]
00570daa : MOV EAX,dword ptr [EDI]
00570dac : MOV EDX,dword ptr [EAX + 0x48]
00570daf : MOV ECX,EDI
00570db1 : CALL EDX
00570db3 : MOV EDX,dword ptr [EAX]
00570db5 : MOV ECX,EAX
00570db7 : MOV EAX,dword ptr [EDX + 0x2c]
00570dba : CALL EAX
00570dbc : SHR EAX,0x4
00570dbf : AND AL,0x1
00570dc1 : MOV ECX,EDI
00570dc3 : MOV byte ptr [ESP + 0x14],AL
00570dc7 : CALL 0x004ff7c0
00570dcc : JMP 0x00570e19
00570dce : PUSH EBP
00570dcf : MOV EBP,dword ptr [EAX + 0x10]
00570dd2 : CMP EBP,-0x1
00570dd5 : JZ 0x00570e18
00570dd7 : MOV EDI,dword ptr [ESI + 0xc]
00570dda : PUSH EBP
00570ddb : MOV ECX,EDI
00570ddd : CALL 0x0056b260
00570de2 : MOV ECX,EDI
00570de4 : TEST EAX,EAX
00570de6 : JZ 0x00570deb
00570de8 : PUSH EBP
00570de9 : JMP 0x00570df8
00570deb : PUSH EBX
00570dec : CALL 0x0056b260
00570df1 : TEST EAX,EAX
00570df3 : JZ 0x00570e18
00570df5 : PUSH EBX
00570df6 : MOV ECX,EDI
00570df8 : CALL 0x0056b260
00570dfd : MOV EDX,dword ptr [EAX]
00570dff : MOV ECX,EAX
00570e01 : MOV EAX,dword ptr [EDX + 0x48]
00570e04 : CALL EAX
00570e06 : MOV EDX,dword ptr [EAX]
00570e08 : MOV ECX,EAX
00570e0a : MOV EAX,dword ptr [EDX + 0x2c]
00570e0d : CALL EAX
00570e0f : SHR EAX,0x4
00570e12 : AND AL,0x1
00570e14 : MOV byte ptr [ESP + 0x18],AL
00570e18 : POP EBP
00570e19 : MOV ECX,dword ptr [0x00d73250]
00570e1f : PUSH EBX
00570e20 : PUSH 0x2c
00570e22 : CALL 0x00515840
00570e27 : CMP EAX,EBX
00570e29 : JZ 0x00570e4f
00570e2b : MOV ECX,dword ptr [ESP + 0x10]
00570e2f : MOVZX EDX,byte ptr [ECX + 0x18]
00570e33 : MOV ECX,dword ptr [ESP + 0x14]
00570e37 : PUSH EDX
00570e38 : MOV EDX,dword ptr [ESI + 0x10]
00570e3b : PUSH ECX
00570e3c : MOV ECX,dword ptr [ESI + 0xc]
00570e3f : ADD EDX,0xc
00570e42 : PUSH EDX
00570e43 : PUSH ECX
00570e44 : MOV ECX,EAX
00570e46 : CALL 0x0056ec50
00570e4b : MOV EDI,EAX
00570e4d : JMP 0x00570e51
00570e4f : XOR EDI,EDI
00570e51 : MOV ECX,dword ptr [ESI + 0x14]
00570e54 : CMP ECX,EBX
00570e56 : JZ 0x00570e5d
00570e58 : CALL 0x004ff7e0
00570e5d : MOV dword ptr [ESI + 0x14],EDI
00570e60 : MOV ECX,dword ptr [ESI + 0xc]
00570e63 : MOV EDX,dword ptr [ECX + 0x8]
00570e66 : MOV EAX,dword ptr [EDX + 0xc]
00570e69 : ADD ECX,0x8
00570e6c : PUSH 0x17
00570e6e : CALL EAX
00570e70 : MOV EDI,EAX
00570e72 : MOV EDX,dword ptr [EDI]
00570e74 : MOV EAX,dword ptr [ESI + 0x14]
00570e77 : MOV EDX,dword ptr [EDX + 0x4]
00570e7a : PUSH EAX
00570e7b : MOV ECX,EDI
00570e7d : CALL EDX
00570e7f : MOV ECX,EDI
00570e81 : CALL 0x004ff7e0
00570e86 : POP EDI
00570e87 : MOV EAX,ESI
00570e89 : POP ESI
00570e8a : POP EBX
00570e8b : RET 0x8

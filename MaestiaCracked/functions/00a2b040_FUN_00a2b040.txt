PROGRAM  : Maestia.exe
FUNCTION : FUN_00a2b040
ENTRY    : 00a2b040
BODY     : [[00a2b040, 00a2b2fa]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a2b040(int param_1,int param_2)

{
  ushort uVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  uint8_t *packet;
  int *piVar5;
  int local_48;
  int local_44;
  undefined4 *local_40;
  uint uStack_3c;
  int local_20;
  int local_1c;
  int local_18;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  iVar3 = param_2;
  iVar2 = DAT_00d7c54c;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b427ea;
  local_10 = ExceptionList;
  uStack_3c = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (param_2 != 0) {
    param_2 = *(undefined4 *)(param_2 + 0xc);
    local_40 = &param_2;
    local_44 = 0xa2b08e;
    FUN_004437f0();
    if ((local_14 != (undefined1 *)*(int *)(iVar2 + 0x44)) &&
       (local_14 = *(undefined1 **)((int)local_14 + 0x10), local_14 != (undefined1 *)0x0)) {
      if (local_14[0xa60] == '\0') {
        param_2 = *(undefined4 *)(iVar3 + 0x12);
        local_44 = 0xa2b0c9;
        local_40 = (undefined4 *)param_2;
        piVar4 = (int *)FUN_00a1a840();
        if (piVar4 == (int *)0x0) {
          local_40 = (undefined4 *)param_2;
          local_44 = 0xa2b0da;
          piVar4 = (int *)FUN_00a1a6d0();
          if (piVar4 == (int *)0x0) {
            local_40 = (undefined4 *)param_2;
            local_44 = 0xa2b0eb;
            piVar4 = (int *)FUN_00a1a780();
            if (piVar4 == (int *)0x0) {
              ExceptionList = local_10;
              return;
            }
          }
        }
        local_20 = 0;
        local_1c = 0;
        local_18 = 0;
        local_40 = *(undefined4 **)(param_1 + 0xc);
        local_44 = 0xa2b13d;
        FUN_007e9290();
        local_48 = local_20;
        local_44 = local_1c;
        local_40 = (undefined4 *)local_18;
        (**(code **)(*piVar4 + 0x39c))();
        if ((int *)piVar4[0xfa] != (int *)0x0) {
          (**(code **)(*(int *)piVar4[0xfa] + 0x68))(1,1);
        }
        if (piVar4 != *(int **)(param_1 + 0xac)) {
          ExceptionList = local_10;
          return;
        }
        packet = (uint8_t *)FUN_006f4590();
      }
      else {
        if (local_14[0xa60] != '\x01') {
          ExceptionList = local_10;
          return;
        }
        local_40 = (undefined4 *)0xa2b1b6;
        piVar4 = (int *)FUN_00a1ba80();
        if (piVar4 == (int *)0x0) {
          ExceptionList = local_10;
          return;
        }
        local_20 = 0;
        local_1c = 0;
        local_18 = 0;
        local_40 = *(undefined4 **)(param_1 + 0xc);
        local_44 = 0xa2b20b;
        FUN_007e9290();
        uVar1 = *(ushort *)(iVar3 + 0x10);
        param_2 = 0;
        if (uVar1 < 0x16) {
          param_2 = *(int *)(local_14 + (uint)uVar1 * 4 + 0xa64);
        }
        if (piVar4[0xfa] == 0) {
          local_48 = piVar4[0x69];
          local_44 = piVar4[0x6a];
          local_40 = (undefined4 *)piVar4[0x6b];
        }
        else {
          local_40 = (undefined4 *)0xa2b23b;
          piVar5 = (int *)FUN_007cc270();
          local_48 = *piVar5;
          local_44 = piVar5[1];
          local_40 = (undefined4 *)piVar5[2];
        }
        local_14 = (undefined1 *)&local_48;
        (**(code **)(*piVar4 + 0x39c))();
        FUN_00888970(&local_20,param_2);
        if (piVar4 != *(int **)(param_1 + 0xac)) {
          ExceptionList = local_10;
          return;
        }
        packet = (uint8_t *)FUN_006f4590();
      }
      if (packet == (uint8_t *)0x0) {
        packet = (uint8_t *)0x0;
      }
      else {
        packet[0] = '\0';
        packet[1] = '\0';
        packet[2] = '4';
        packet[3] = 0xeb;
      }
      local_8 = 0xffffffff;
      if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
        FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),4,packet);
      }
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00a2b040 : PUSH EBP
00a2b041 : MOV EBP,ESP
00a2b043 : PUSH -0x1
00a2b045 : PUSH 0xb427ea
00a2b04a : MOV EAX,FS:[0x0]
00a2b050 : PUSH EAX
00a2b051 : SUB ESP,0x1c
00a2b054 : PUSH EBX
00a2b055 : PUSH ESI
00a2b056 : PUSH EDI
00a2b057 : MOV EAX,[0x00d66fa0]
00a2b05c : XOR EAX,EBP
00a2b05e : PUSH EAX
00a2b05f : LEA EAX,[EBP + -0xc]
00a2b062 : MOV FS:[0x0],EAX
00a2b068 : MOV EBX,dword ptr [EBP + 0xc]
00a2b06b : TEST EBX,EBX
00a2b06d : JZ 0x00a2b2e7
00a2b073 : MOV EAX,dword ptr [EBX + 0xc]
00a2b076 : MOV ESI,dword ptr [0x00d7c54c]
00a2b07c : LEA ECX,[EBP + 0xc]
00a2b07f : MOV dword ptr [EBP + 0xc],EAX
00a2b082 : PUSH ECX
00a2b083 : LEA ECX,[ESI + 0x40]
00a2b086 : LEA EAX,[EBP + -0x10]
00a2b089 : CALL 0x004437f0
00a2b08e : MOV ESI,dword ptr [ESI + 0x44]
00a2b091 : MOV EAX,dword ptr [EBP + -0x10]
00a2b094 : CMP EAX,ESI
00a2b096 : JZ 0x00a2b2e7
00a2b09c : MOV EAX,dword ptr [EAX + 0x10]
00a2b09f : MOV dword ptr [EBP + -0x10],EAX
00a2b0a2 : TEST EAX,EAX
00a2b0a4 : JZ 0x00a2b2e7
00a2b0aa : MOV AL,byte ptr [EAX + 0xa60]
00a2b0b0 : TEST AL,AL
00a2b0b2 : JNZ 0x00a2b1a3
00a2b0b8 : MOV EAX,dword ptr [EBX + 0x12]
00a2b0bb : MOV EDI,dword ptr [EBP + 0x8]
00a2b0be : PUSH EAX
00a2b0bf : MOV ECX,EDI
00a2b0c1 : MOV dword ptr [EBP + 0xc],EAX
00a2b0c4 : CALL 0x00a1a840
00a2b0c9 : MOV ESI,EAX
00a2b0cb : TEST ESI,ESI
00a2b0cd : JNZ 0x00a2b0f5
00a2b0cf : MOV EDX,dword ptr [EBP + 0xc]
00a2b0d2 : PUSH EDX
00a2b0d3 : MOV ECX,EDI
00a2b0d5 : CALL 0x00a1a6d0
00a2b0da : MOV ESI,EAX
00a2b0dc : TEST ESI,ESI
00a2b0de : JNZ 0x00a2b0f5
00a2b0e0 : MOV EAX,dword ptr [EBP + 0xc]
00a2b0e3 : PUSH EAX
00a2b0e4 : MOV ECX,EDI
00a2b0e6 : CALL 0x00a1a780
00a2b0eb : MOV ESI,EAX
00a2b0ed : TEST ESI,ESI
00a2b0ef : JZ 0x00a2b2e7
00a2b0f5 : XORPS XMM0,XMM0
00a2b0f8 : MOVZX ECX,word ptr [EBX + 0x1a]
00a2b0fc : MOVZX EDX,word ptr [EBX + 0x1c]
00a2b100 : MOVZX EAX,word ptr [EBX + 0x1e]
00a2b104 : MOVSS dword ptr [EBP + -0x1c],XMM0
00a2b109 : MOVSS dword ptr [EBP + -0x18],XMM0
00a2b10e : MOVSS dword ptr [EBP + -0x14],XMM0
00a2b113 : CVTSI2SS XMM0,ECX
00a2b117 : MOV ECX,dword ptr [EDI + 0xc]
00a2b11a : CVTSI2SS XMM1,EDX
00a2b11e : PUSH ECX
00a2b11f : CVTSI2SS XMM2,EAX
00a2b123 : LEA EDX,[EBP + -0x1c]
00a2b126 : LEA ECX,[EBP + -0x28]
00a2b129 : MOVSS dword ptr [EBP + -0x28],XMM0
00a2b12e : MOVSS dword ptr [EBP + -0x24],XMM1
00a2b133 : MOVSS dword ptr [EBP + -0x20],XMM2
00a2b138 : CALL 0x007e9290
00a2b13d : MOVSS XMM0,dword ptr [EBP + -0x1c]
00a2b142 : MOV EDX,dword ptr [ESI]
00a2b144 : SUB ESP,0xc
00a2b147 : MOV EAX,ESP
00a2b149 : MOVSS dword ptr [EAX],XMM0
00a2b14d : MOVSS XMM0,dword ptr [EBP + -0x18]
00a2b152 : MOVSS dword ptr [EAX + 0x4],XMM0
00a2b157 : MOVSS XMM0,dword ptr [EBP + -0x14]
00a2b15c : MOVSS dword ptr [EAX + 0x8],XMM0
00a2b161 : MOV EAX,dword ptr [EDX + 0x39c]
00a2b167 : MOV ECX,ESI
00a2b169 : MOV dword ptr [EBP + 0x8],ESP
00a2b16c : CALL EAX
00a2b16e : MOV ECX,dword ptr [ESI + 0x3e8]
00a2b174 : TEST ECX,ECX
00a2b176 : JZ 0x00a2b183
00a2b178 : MOV EDX,dword ptr [ECX]
00a2b17a : MOV EAX,dword ptr [EDX + 0x68]
00a2b17d : PUSH 0x1
00a2b17f : PUSH 0x1
00a2b181 : CALL EAX
00a2b183 : CMP ESI,dword ptr [EDI + 0xac]
00a2b189 : JNZ 0x00a2b2e7
00a2b18f : CALL 0x006f4590
00a2b194 : MOV dword ptr [EBP + 0x8],EAX
00a2b197 : MOV dword ptr [EBP + -0x4],0x0
00a2b19e : JMP 0x00a2b2ae
00a2b1a3 : CMP AL,0x1
00a2b1a5 : JNZ 0x00a2b2e7
00a2b1ab : MOV ESI,dword ptr [EBX + 0x16]
00a2b1ae : MOV EDI,dword ptr [EBP + 0x8]
00a2b1b1 : CALL 0x00a1ba80
00a2b1b6 : MOV EDI,EAX
00a2b1b8 : TEST EDI,EDI
00a2b1ba : JZ 0x00a2b2e7
00a2b1c0 : XORPS XMM0,XMM0
00a2b1c3 : MOVZX EDX,word ptr [EBX + 0x1a]
00a2b1c7 : MOVZX EAX,word ptr [EBX + 0x1c]
00a2b1cb : MOVZX ECX,word ptr [EBX + 0x1e]
00a2b1cf : MOVSS dword ptr [EBP + -0x1c],XMM0
00a2b1d4 : MOVSS dword ptr [EBP + -0x18],XMM0
00a2b1d9 : MOVSS dword ptr [EBP + -0x14],XMM0
00a2b1de : CVTSI2SS XMM0,EDX
00a2b1e2 : MOV EDX,dword ptr [EBP + 0x8]
00a2b1e5 : CVTSI2SS XMM1,EAX
00a2b1e9 : MOV EAX,dword ptr [EDX + 0xc]
00a2b1ec : CVTSI2SS XMM2,ECX
00a2b1f0 : PUSH EAX
00a2b1f1 : LEA EDX,[EBP + -0x1c]
00a2b1f4 : LEA ECX,[EBP + -0x28]
00a2b1f7 : MOVSS dword ptr [EBP + -0x28],XMM0
00a2b1fc : MOVSS dword ptr [EBP + -0x24],XMM1
00a2b201 : MOVSS dword ptr [EBP + -0x20],XMM2
00a2b206 : CALL 0x007e9290
00a2b20b : MOVZX EAX,word ptr [EBX + 0x10]
00a2b20f : MOV dword ptr [EBP + 0xc],0x0
00a2b216 : CMP AX,0x16
00a2b21a : JNC 0x00a2b22c
00a2b21c : MOV EDX,dword ptr [EBP + -0x10]
00a2b21f : MOVZX ECX,AX
00a2b222 : MOV EAX,dword ptr [EDX + ECX*0x4 + 0xa64]
00a2b229 : MOV dword ptr [EBP + 0xc],EAX
00a2b22c : MOV ESI,dword ptr [EDI + 0x3e8]
00a2b232 : TEST ESI,ESI
00a2b234 : JZ 0x00a2b24b
00a2b236 : CALL 0x007cc270
00a2b23b : MOVSS XMM0,dword ptr [EAX]
00a2b23f : MOVSS XMM1,dword ptr [EAX + 0x4]
00a2b244 : MOVSS XMM2,dword ptr [EAX + 0x8]
00a2b249 : JMP 0x00a2b263
00a2b24b : MOVSS XMM0,dword ptr [EDI + 0x1a4]
00a2b253 : MOVSS XMM1,dword ptr [EDI + 0x1a8]
00a2b25b : MOVSS XMM2,dword ptr [EDI + 0x1ac]
00a2b263 : MOV EDX,dword ptr [EDI]
00a2b265 : SUB ESP,0xc
00a2b268 : MOV EAX,ESP
00a2b26a : MOVSS dword ptr [EAX],XMM0
00a2b26e : MOVSS dword ptr [EAX + 0x4],XMM1
00a2b273 : MOVSS dword ptr [EAX + 0x8],XMM2
00a2b278 : MOV EAX,dword ptr [EDX + 0x39c]
00a2b27e : MOV ECX,EDI
00a2b280 : MOV dword ptr [EBP + -0x10],ESP
00a2b283 : CALL EAX
00a2b285 : MOV ECX,dword ptr [EBP + 0xc]
00a2b288 : PUSH ECX
00a2b289 : LEA EDX,[EBP + -0x1c]
00a2b28c : PUSH EDX
00a2b28d : MOV EAX,EDI
00a2b28f : CALL 0x00888970
00a2b294 : MOV EAX,dword ptr [EBP + 0x8]
00a2b297 : CMP EDI,dword ptr [EAX + 0xac]
00a2b29d : JNZ 0x00a2b2e7
00a2b29f : CALL 0x006f4590
00a2b2a4 : MOV dword ptr [EBP + 0x8],EAX
00a2b2a7 : MOV dword ptr [EBP + -0x4],0x1
00a2b2ae : TEST EAX,EAX
00a2b2b0 : JZ 0x00a2b2c1
00a2b2b2 : XOR ECX,ECX
00a2b2b4 : MOV word ptr [EAX],CX
00a2b2b7 : MOV byte ptr [EAX + 0x2],0x34
00a2b2bb : MOV byte ptr [EAX + 0x3],0xeb
00a2b2bf : JMP 0x00a2b2c3
00a2b2c1 : XOR EAX,EAX
00a2b2c3 : MOV dword ptr [EBP + -0x4],0xffffffff
00a2b2ca : MOV EDX,dword ptr [0x017247d4]
00a2b2d0 : MOV ECX,dword ptr [EDX + 0x4]
00a2b2d3 : TEST ECX,ECX
00a2b2d5 : JZ 0x00a2b2e7
00a2b2d7 : CMP byte ptr [EDX + 0x8],0x0
00a2b2db : JZ 0x00a2b2e7
00a2b2dd : PUSH 0x4
00a2b2df : PUSH ECX
00a2b2e0 : MOV EDI,EAX
00a2b2e2 : CALL 0x00a0dd40
00a2b2e7 : MOV ECX,dword ptr [EBP + -0xc]
00a2b2ea : MOV dword ptr FS:[0x0],ECX
00a2b2f1 : POP ECX
00a2b2f2 : POP EDI
00a2b2f3 : POP ESI
00a2b2f4 : POP EBX
00a2b2f5 : MOV ESP,EBP
00a2b2f7 : POP EBP
00a2b2f8 : RET 0x8

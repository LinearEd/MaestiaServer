PROGRAM  : Maestia.exe
FUNCTION : FUN_006cecd0
ENTRY    : 006cecd0
BODY     : [[006cecd0, 006ced8e]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006cecd0(int param_1,code *param_2,undefined4 param_3)

{
  undefined1 local_294 [576];
  undefined4 local_54;
  uint local_10;
  size_t local_c;
  void *local_8;
  
  local_10 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  if (param_1 == 2) {
    local_c = 0x120;
  }
  else {
    if (param_1 != 1) goto LAB_006ced81;
    local_c = 0x27c;
  }
  if (param_2 == (code *)0x0) {
    local_8 = _malloc(local_c);
    if (local_8 != (void *)0x0) {
      _memset(local_8,0,local_c);
    }
  }
  else {
    local_54 = param_3;
    local_8 = (void *)(*param_2)(local_294,local_c);
    if (local_8 != (void *)0x0) {
      _memset(local_8,0,local_c);
    }
  }
LAB_006ced81:
  __security_check_cookie(local_10 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
006cecd0 : PUSH EBP
006cecd1 : MOV EBP,ESP
006cecd3 : SUB ESP,0x294
006cecd9 : MOV EAX,[0x00d66fa0]
006cecde : XOR EAX,EBP
006cece0 : MOV dword ptr [EBP + -0xc],EAX
006cece3 : CMP dword ptr [EBP + 0x8],0x2
006cece7 : JNZ 0x006cecf2
006cece9 : MOV dword ptr [EBP + -0x8],0x120
006cecf0 : JMP 0x006ced05
006cecf2 : CMP dword ptr [EBP + 0x8],0x1
006cecf6 : JNZ 0x006ced01
006cecf8 : MOV dword ptr [EBP + -0x8],0x27c
006cecff : JMP 0x006ced05
006ced01 : XOR EAX,EAX
006ced03 : JMP 0x006ced81
006ced05 : CMP dword ptr [EBP + 0xc],0x0
006ced09 : JZ 0x006ced57
006ced0b : LEA EAX,[EBP + 0xfffffd70]
006ced11 : MOV dword ptr [EBP + 0xfffffd6c],EAX
006ced17 : MOV ECX,dword ptr [EBP + 0xfffffd6c]
006ced1d : MOV EDX,dword ptr [EBP + 0x10]
006ced20 : MOV dword ptr [ECX + 0x240],EDX
006ced26 : MOV EAX,dword ptr [EBP + -0x8]
006ced29 : PUSH EAX
006ced2a : MOV ECX,dword ptr [EBP + 0xfffffd6c]
006ced30 : PUSH ECX
006ced31 : CALL dword ptr [EBP + 0xc]
006ced34 : ADD ESP,0x8
006ced37 : MOV dword ptr [EBP + -0x4],EAX
006ced3a : CMP dword ptr [EBP + -0x4],0x0
006ced3e : JZ 0x006ced52
006ced40 : MOV EDX,dword ptr [EBP + -0x8]
006ced43 : PUSH EDX
006ced44 : PUSH 0x0
006ced46 : MOV EAX,dword ptr [EBP + -0x4]
006ced49 : PUSH EAX
006ced4a : CALL 0x0063b700
006ced4f : ADD ESP,0xc
006ced52 : MOV EAX,dword ptr [EBP + -0x4]
006ced55 : JMP 0x006ced81
006ced57 : MOV ECX,dword ptr [EBP + -0x8]
006ced5a : PUSH ECX
006ced5b : CALL 0x00636043
006ced60 : ADD ESP,0x4
006ced63 : MOV dword ptr [EBP + -0x4],EAX
006ced66 : CMP dword ptr [EBP + -0x4],0x0
006ced6a : JZ 0x006ced7e
006ced6c : MOV EDX,dword ptr [EBP + -0x8]
006ced6f : PUSH EDX
006ced70 : PUSH 0x0
006ced72 : MOV EAX,dword ptr [EBP + -0x4]
006ced75 : PUSH EAX
006ced76 : CALL 0x0063b700
006ced7b : ADD ESP,0xc
006ced7e : MOV EAX,dword ptr [EBP + -0x4]
006ced81 : MOV ECX,dword ptr [EBP + -0xc]
006ced84 : XOR ECX,EBP
006ced86 : CALL 0x00633e6b
006ced8b : MOV ESP,EBP
006ced8d : POP EBP
006ced8e : RET

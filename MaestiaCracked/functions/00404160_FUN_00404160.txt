PROGRAM  : Maestia.exe
FUNCTION : FUN_00404160
ENTRY    : 00404160
BODY     : [[00404160, 004041eb]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00404160(int *param_1,undefined2 *param_2,int *param_3)

{
  int in_EAX;
  uint uVar1;
  int *piVar2;
  int *piVar3;
  int *piVar4;
  int iVar5;
  
  piVar4 = *(int **)(in_EAX + 0x20);
  if (piVar4 == (int *)0x0) {
    *param_1 = 0;
    return;
  }
  piVar2 = (int *)*param_1;
  if (piVar2 == (int *)0xffffffff) {
    uVar1 = 0;
    piVar3 = piVar4;
    if (*(uint *)(in_EAX + 0x24) != 0) {
      while (piVar2 = (int *)*piVar3, piVar2 == (int *)0x0) {
        uVar1 = uVar1 + 1;
        piVar3 = piVar3 + 1;
        if (*(uint *)(in_EAX + 0x24) <= uVar1) {
          *param_1 = 0;
          return;
        }
      }
    }
  }
  iVar5 = *piVar2;
  if (iVar5 == 0) {
    uVar1 = piVar2[1] + 1;
    if (uVar1 < *(uint *)(in_EAX + 0x24)) {
      piVar4 = piVar4 + uVar1;
      do {
        iVar5 = *piVar4;
        if (iVar5 != 0) break;
        uVar1 = uVar1 + 1;
        piVar4 = piVar4 + 1;
      } while (uVar1 < *(uint *)(in_EAX + 0x24));
    }
  }
  *param_1 = iVar5;
  iVar5 = piVar2[3];
  *param_2 = (short)piVar2[2];
  *param_3 = iVar5;
  return;
}



============================================================
DISASSEMBLY
============================================================
00404160 : PUSH EBP
00404161 : MOV EBP,ESP
00404163 : PUSH EBX
00404164 : PUSH EDI
00404165 : MOV EDI,EAX
00404167 : MOV EBX,dword ptr [EDI + 0x20]
0040416a : TEST EBX,EBX
0040416c : JNZ 0x00404179
0040416e : MOV EAX,dword ptr [EBP + 0x8]
00404171 : POP EDI
00404172 : MOV dword ptr [EAX],EBX
00404174 : POP EBX
00404175 : POP EBP
00404176 : RET 0xc
00404179 : MOV ECX,dword ptr [EBP + 0x8]
0040417c : MOV ECX,dword ptr [ECX]
0040417e : PUSH ESI
0040417f : CMP ECX,-0x1
00404182 : JNZ 0x004041aa
00404184 : MOV ESI,dword ptr [EDI + 0x24]
00404187 : XOR EAX,EAX
00404189 : TEST ESI,ESI
0040418b : JBE 0x004041aa
0040418d : MOV EDX,EBX
0040418f : NOP
00404190 : MOV ECX,dword ptr [EDX]
00404192 : TEST ECX,ECX
00404194 : JNZ 0x004041aa
00404196 : INC EAX
00404197 : ADD EDX,0x4
0040419a : CMP EAX,ESI
0040419c : JC 0x00404190
0040419e : MOV EDX,dword ptr [EBP + 0x8]
004041a1 : POP ESI
004041a2 : POP EDI
004041a3 : MOV dword ptr [EDX],ECX
004041a5 : POP EBX
004041a6 : POP EBP
004041a7 : RET 0xc
004041aa : MOV ESI,dword ptr [ECX]
004041ac : TEST ESI,ESI
004041ae : JNZ 0x004041ce
004041b0 : MOV EAX,dword ptr [ECX + 0x4]
004041b3 : MOV EDI,dword ptr [EDI + 0x24]
004041b6 : INC EAX
004041b7 : CMP EAX,EDI
004041b9 : JNC 0x004041ce
004041bb : LEA EDX,[EBX + EAX*0x4]
004041be : MOV EDI,EDI
004041c0 : MOV ESI,dword ptr [EDX]
004041c2 : TEST ESI,ESI
004041c4 : JNZ 0x004041ce
004041c6 : INC EAX
004041c7 : ADD EDX,0x4
004041ca : CMP EAX,EDI
004041cc : JC 0x004041c0
004041ce : MOV EAX,dword ptr [EBP + 0x8]
004041d1 : MOV dword ptr [EAX],ESI
004041d3 : MOV DX,word ptr [ECX + 0x8]
004041d7 : MOV EAX,dword ptr [EBP + 0xc]
004041da : MOV ECX,dword ptr [ECX + 0xc]
004041dd : POP ESI
004041de : MOV word ptr [EAX],DX
004041e1 : MOV EDX,dword ptr [EBP + 0x10]
004041e4 : POP EDI
004041e5 : MOV dword ptr [EDX],ECX
004041e7 : POP EBX
004041e8 : POP EBP
004041e9 : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_00ad9c80
ENTRY    : 00ad9c80
BODY     : [[00ad9c80, 00ad9e97]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00ad9c80(void)

{
  int *piVar1;
  undefined4 uVar2;
  int iVar3;
  int in_EDX;
  wchar_t *pwVar4;
  undefined1 local_868 [28];
  undefined1 local_84c [32];
  undefined2 local_82c;
  undefined4 local_81c;
  undefined4 local_818;
  wchar_t local_814 [1024];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b5e7d0;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  switch(*(undefined1 *)(in_EDX + 3)) {
  case 0xe:
    if ((*DAT_00da9894 == 0) || (*(int *)(*DAT_00da9894 + 0x1a8) == 0)) break;
    pwVar4 = local_814;
    for (iVar3 = 0x200; iVar3 != 0; iVar3 = iVar3 + -1) {
      pwVar4[0] = L'\0';
      pwVar4[1] = L'\0';
      pwVar4 = pwVar4 + 2;
    }
    _wcsncpy(local_814,(wchar_t *)(in_EDX + 5),(uint)*(byte *)(in_EDX + 4));
    FUN_00406460(local_814);
    local_8 = 0;
    (**(code **)(**(int **)(*DAT_00da9894 + 0x1a8) + 0x44))(local_868,0x11);
    goto LAB_00ad9e73;
  case 0x1c:
    if ((*DAT_00da9894 != 0) && (*(int *)(*DAT_00da9894 + 0x1d8) != 0)) {
      FUN_009ad140();
    }
    break;
  case 0x1d:
    if ((*DAT_00da9894 != 0) && (*(int *)(*DAT_00da9894 + 700) != 0)) {
      FUN_0096a000(local_14);
    }
    break;
  case 0xff:
    local_818 = 7;
    local_81c = 0;
    local_82c = 0;
    local_8 = 1;
    if ((((*(int *)(in_EDX + 4) == 1) && (DAT_0172491c != 0)) && (*DAT_00da9894 != 0)) &&
       (*(int *)(*DAT_00da9894 + 0x1a8) != 0)) {
      FUN_00406460(L"IDS_CHAT_CANT_ALLI_CHATTING_BY_LOUD");
      local_8._0_1_ = 2;
      piVar1 = *(int **)(*DAT_00da9894 + 0x1a8);
      uVar2 = FUN_0081d120(local_84c);
      local_8._0_1_ = 3;
      (**(code **)(*piVar1 + 0x44))(uVar2,3);
      local_8._0_1_ = 2;
      FUN_00406560();
      local_8 = CONCAT31(local_8._1_3_,1);
      FUN_00406560();
    }
LAB_00ad9e73:
    local_8 = 0xffffffff;
    FUN_00406560();
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00ad9c80 : PUSH EBP
00ad9c81 : MOV EBP,ESP
00ad9c83 : PUSH -0x1
00ad9c85 : PUSH 0xb5e7d0
00ad9c8a : MOV EAX,FS:[0x0]
00ad9c90 : PUSH EAX
00ad9c91 : SUB ESP,0x878
00ad9c97 : MOV EAX,[0x00d66fa0]
00ad9c9c : XOR EAX,EBP
00ad9c9e : MOV dword ptr [EBP + -0x10],EAX
00ad9ca1 : PUSH ESI
00ad9ca2 : PUSH EDI
00ad9ca3 : PUSH EAX
00ad9ca4 : LEA EAX,[EBP + -0xc]
00ad9ca7 : MOV FS:[0x0],EAX
00ad9cad : MOVZX EAX,byte ptr [EDX + 0x3]
00ad9cb1 : ADD EAX,-0xe
00ad9cb4 : CMP EAX,0xf1
00ad9cb9 : JA 0x00ad9e78
00ad9cbf : MOVZX EAX,byte ptr [EAX + 0xad9eac]
00ad9cc6 : JMP dword ptr [EAX*0x4 + 0xad9e98]
00ad9ccd : MOV ECX,dword ptr [0x00da9894]
00ad9cd3 : MOV EAX,dword ptr [ECX]
00ad9cd5 : TEST EAX,EAX
00ad9cd7 : JZ 0x00ad9e78
00ad9cdd : CMP dword ptr [EAX + 0x1a8],0x0
00ad9ce4 : JZ 0x00ad9e78
00ad9cea : XOR EAX,EAX
00ad9cec : MOVZX ESI,AX
00ad9cef : MOV EAX,ESI
00ad9cf1 : SHL ESI,0x10
00ad9cf4 : OR EAX,ESI
00ad9cf6 : MOV ECX,0x200
00ad9cfb : LEA EDI,[EBP + 0xfffff7f0]
00ad9d01 : STOSD.REP ES:EDI
00ad9d03 : MOVZX EAX,byte ptr [EDX + 0x4]
00ad9d07 : PUSH EAX
00ad9d08 : ADD EDX,0x5
00ad9d0b : PUSH EDX
00ad9d0c : LEA EDX,[EBP + 0xfffff7f0]
00ad9d12 : PUSH EDX
00ad9d13 : CALL 0x00634e39
00ad9d18 : ADD ESP,0xc
00ad9d1b : LEA EAX,[EBP + 0xfffff7f0]
00ad9d21 : PUSH EAX
00ad9d22 : LEA ECX,[EBP + 0xfffff79c]
00ad9d28 : CALL 0x00406460
00ad9d2d : MOV dword ptr [EBP + -0x4],0x0
00ad9d34 : MOV ECX,dword ptr [0x00da9894]
00ad9d3a : MOV EAX,dword ptr [ECX]
00ad9d3c : MOV ECX,dword ptr [EAX + 0x1a8]
00ad9d42 : MOV EDX,dword ptr [ECX]
00ad9d44 : MOV EDX,dword ptr [EDX + 0x44]
00ad9d47 : PUSH 0x11
00ad9d49 : LEA EAX,[EBP + 0xfffff79c]
00ad9d4f : PUSH EAX
00ad9d50 : CALL EDX
00ad9d52 : MOV dword ptr [EBP + -0x4],0xffffffff
00ad9d59 : LEA ECX,[EBP + 0xfffff79c]
00ad9d5f : JMP 0x00ad9e73
00ad9d64 : MOV EAX,[0x00da9894]
00ad9d69 : MOV EAX,dword ptr [EAX]
00ad9d6b : TEST EAX,EAX
00ad9d6d : JZ 0x00ad9e78
00ad9d73 : MOV ECX,dword ptr [EAX + 0x1d8]
00ad9d79 : TEST ECX,ECX
00ad9d7b : JZ 0x00ad9e78
00ad9d81 : MOV EAX,EDX
00ad9d83 : CALL 0x009ad140
00ad9d88 : JMP 0x00ad9e78
00ad9d8d : MOV ECX,dword ptr [0x00da9894]
00ad9d93 : MOV EAX,dword ptr [ECX]
00ad9d95 : TEST EAX,EAX
00ad9d97 : JZ 0x00ad9e78
00ad9d9d : CMP dword ptr [EAX + 0x2bc],0x0
00ad9da4 : JZ 0x00ad9e78
00ad9daa : MOV ECX,EDX
00ad9dac : CALL 0x0096a000
00ad9db1 : JMP 0x00ad9e78
00ad9db6 : XOR EAX,EAX
00ad9db8 : MOV dword ptr [EBP + 0xfffff7ec],0x7
00ad9dc2 : MOV dword ptr [EBP + 0xfffff7e8],0x0
00ad9dcc : MOV word ptr [EBP + 0xfffff7d8],AX
00ad9dd3 : MOV dword ptr [EBP + -0x4],0x1
00ad9dda : MOV EDX,dword ptr [EDX + 0x4]
00ad9ddd : SUB EDX,0x1
00ad9de0 : JNZ 0x00ad9e66
00ad9de6 : CMP dword ptr [0x0172491c],EDX
00ad9dec : JZ 0x00ad9e66
00ad9dee : MOV ECX,dword ptr [0x00da9894]
00ad9df4 : MOV EAX,dword ptr [ECX]
00ad9df6 : TEST EAX,EAX
00ad9df8 : JZ 0x00ad9e66
00ad9dfa : CMP dword ptr [EAX + 0x1a8],EDX
00ad9e00 : JZ 0x00ad9e66
00ad9e02 : PUSH 0xcb4258
00ad9e07 : LEA ECX,[EBP + 0xfffff7b8]
00ad9e0d : CALL 0x00406460
00ad9e12 : MOV byte ptr [EBP + -0x4],0x2
00ad9e16 : MOV EDX,dword ptr [0x00da9894]
00ad9e1c : MOV EAX,dword ptr [EDX]
00ad9e1e : MOV ESI,dword ptr [EAX + 0x1a8]
00ad9e24 : MOV ECX,dword ptr [0x0172491c]
00ad9e2a : LEA EAX,[EBP + 0xfffff7b8]
00ad9e30 : PUSH EAX
00ad9e31 : LEA EDI,[EBP + 0xfffff780]
00ad9e37 : CALL 0x0081d120
00ad9e3c : MOV byte ptr [EBP + -0x4],0x3
00ad9e40 : MOV EDX,dword ptr [ESI]
00ad9e42 : PUSH 0x3
00ad9e44 : PUSH EAX
00ad9e45 : MOV EAX,dword ptr [EDX + 0x44]
00ad9e48 : MOV ECX,ESI
00ad9e4a : CALL EAX
00ad9e4c : MOV byte ptr [EBP + -0x4],0x2
00ad9e50 : MOV ECX,EDI
00ad9e52 : CALL 0x00406560
00ad9e57 : MOV byte ptr [EBP + -0x4],0x1
00ad9e5b : LEA ECX,[EBP + 0xfffff7b8]
00ad9e61 : CALL 0x00406560
00ad9e66 : MOV dword ptr [EBP + -0x4],0xffffffff
00ad9e6d : LEA ECX,[EBP + 0xfffff7d4]
00ad9e73 : CALL 0x00406560
00ad9e78 : MOV EAX,0x1
00ad9e7d : MOV ECX,dword ptr [EBP + -0xc]
00ad9e80 : MOV dword ptr FS:[0x0],ECX
00ad9e87 : POP ECX
00ad9e88 : POP EDI
00ad9e89 : POP ESI
00ad9e8a : MOV ECX,dword ptr [EBP + -0x10]
00ad9e8d : XOR ECX,EBP
00ad9e8f : CALL 0x00633e6b
00ad9e94 : MOV ESP,EBP
00ad9e96 : POP EBP
00ad9e97 : RET

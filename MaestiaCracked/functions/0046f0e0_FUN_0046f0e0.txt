PROGRAM  : Maestia.exe
FUNCTION : FUN_0046f0e0
ENTRY    : 0046f0e0
BODY     : [[0046f0e0, 0046f1bc]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0046f0e0(int param_1,undefined4 param_2,undefined4 param_3,char param_4)

{
  char *_Size;
  char *_Src;
  char cVar1;
  undefined1 *puVar2;
  undefined4 *unaff_EDI;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_00b72181;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_8 = 1;
  *unaff_EDI = &PTR_FUN_00cd3f48;
  unaff_EDI[1] = 0;
  *(undefined1 *)(unaff_EDI + 2) = 0;
  _Src = (char *)(*(int *)(param_1 + 4) + 7 + param_1);
  if ((char *)(param_1 + 8U) <= _Src) {
    do {
      puVar2 = &param_4;
      if (param_4 != '\0') {
        cVar1 = param_4;
        do {
          if (*_Src == cVar1) {
            _Size = _Src + (-7 - param_1);
            if (_Size < (char *)0xff) {
              unaff_EDI[1] = _Size;
              *(char *)((int)unaff_EDI + (int)(_Size + 8)) = '\0';
            }
            else {
              unaff_EDI[1] = 0xff;
              *(undefined1 *)((int)unaff_EDI + 0x107) = 0;
            }
            _Src = (char *)(param_1 + 8);
            _memmove(unaff_EDI + 2,_Src,(size_t)_Size);
            break;
          }
          cVar1 = puVar2[1];
          puVar2 = puVar2 + 1;
        } while (cVar1 != '\0');
      }
      _Src = _Src + -1;
    } while ((char *)(param_1 + 8) <= _Src);
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
0046f0e0 : PUSH EBP
0046f0e1 : MOV EBP,ESP
0046f0e3 : PUSH -0x1
0046f0e5 : PUSH 0xb72181
0046f0ea : MOV EAX,FS:[0x0]
0046f0f0 : PUSH EAX
0046f0f1 : SUB ESP,0x8
0046f0f4 : PUSH EBX
0046f0f5 : PUSH ESI
0046f0f6 : MOV EAX,[0x00d66fa0]
0046f0fb : XOR EAX,EBP
0046f0fd : PUSH EAX
0046f0fe : LEA EAX,[EBP + -0xc]
0046f101 : MOV FS:[0x0],EAX
0046f107 : XOR EAX,EAX
0046f109 : MOV dword ptr [EBP + -0x4],EAX
0046f10c : MOV EBX,dword ptr [EBP + 0x8]
0046f10f : MOV dword ptr [EBP + -0x14],EDI
0046f112 : MOV dword ptr [EBP + -0x10],EAX
0046f115 : MOV ECX,0x1
0046f11a : MOV dword ptr [EBP + -0x4],ECX
0046f11d : MOV dword ptr [EDI],0xcd3f48
0046f123 : MOV dword ptr [EDI + 0x4],EAX
0046f126 : MOV byte ptr [EDI + 0x8],AL
0046f129 : MOV EAX,dword ptr [EBX + 0x4]
0046f12c : MOV dword ptr [EBP + -0x10],ECX
0046f12f : LEA EAX,[EAX + EBX*0x1 + 0x7]
0046f133 : LEA ECX,[EBX + 0x8]
0046f136 : CMP EAX,ECX
0046f138 : JC 0x0046f19d
0046f13a : LEA EBX,[EBX]
0046f140 : MOV CL,byte ptr [EBP + 0x14]
0046f143 : LEA ESI,[EBP + 0x14]
0046f146 : TEST CL,CL
0046f148 : JZ 0x0046f195
0046f14a : MOV DL,byte ptr [EAX]
0046f14c : LEA ESP,[ESP]
0046f150 : CMP DL,CL
0046f152 : JZ 0x0046f15e
0046f154 : MOV CL,byte ptr [ESI + 0x1]
0046f157 : INC ESI
0046f158 : TEST CL,CL
0046f15a : JNZ 0x0046f150
0046f15c : JMP 0x0046f195
0046f15e : SUB EAX,EBX
0046f160 : SUB EAX,0x7
0046f163 : CMP EAX,0xff
0046f168 : JNC 0x0046f174
0046f16a : MOV dword ptr [EDI + 0x4],EAX
0046f16d : MOV byte ptr [EDI + EAX*0x1 + 0x8],0x0
0046f172 : JMP 0x0046f182
0046f174 : MOV dword ptr [EDI + 0x4],0xff
0046f17b : MOV byte ptr [EDI + 0x107],0x0
0046f182 : PUSH EAX
0046f183 : LEA ESI,[EBX + 0x8]
0046f186 : LEA EAX,[EDI + 0x8]
0046f189 : PUSH ESI
0046f18a : PUSH EAX
0046f18b : CALL 0x00636880
0046f190 : ADD ESP,0xc
0046f193 : MOV EAX,ESI
0046f195 : DEC EAX
0046f196 : LEA ECX,[EBX + 0x8]
0046f199 : CMP EAX,ECX
0046f19b : JNC 0x0046f140
0046f19d : MOV byte ptr [EBP + -0x4],0x0
0046f1a1 : MOV dword ptr [EBP + 0xc],0xcd3f48
0046f1a8 : MOV EAX,EDI
0046f1aa : MOV ECX,dword ptr [EBP + -0xc]
0046f1ad : MOV dword ptr FS:[0x0],ECX
0046f1b4 : POP ECX
0046f1b5 : POP ESI
0046f1b6 : POP EBX
0046f1b7 : MOV ESP,EBP
0046f1b9 : POP EBP
0046f1ba : RET 0x10c

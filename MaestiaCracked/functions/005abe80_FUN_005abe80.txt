PROGRAM  : Maestia.exe
FUNCTION : FUN_005abe80
ENTRY    : 005abe80
BODY     : [[005abe80, 005abf71]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_005abe80(uint param_1,int *param_2)

{
  int *piVar1;
  int *piVar2;
  int *piVar3;
  uint uVar4;
  int iVar5;
  undefined4 *in_ECX;
  int iVar6;
  
  piVar3 = (int *)FUN_005ab7c0(param_2);
  uVar4 = 0;
  if ((((piVar3 != (int *)0x0) && (uVar4 = param_1, piVar3[8] == param_1)) && (piVar3 <= param_2))
     && (uVar4 = piVar3[9], param_2 < (int *)((uVar4 << ((byte)*in_ECX & 0x1f)) + (int)piVar3))) {
    in_ECX[5] = in_ECX[5] - uVar4;
    piVar1 = (int *)*piVar3;
    if (piVar1 == piVar3) {
      FUN_005ab630(piVar3);
    }
    else {
      piVar2 = (int *)piVar3[1];
      *piVar2 = (int)piVar1;
      piVar1[1] = (int)piVar2;
      FUN_005ab5d0(piVar3,piVar1);
    }
    FUN_005ab6e0(piVar3);
    uVar4 = ((piVar3[9] << ((byte)*in_ECX & 0x1f)) - (int)param_2) + (int)piVar3;
    if (piVar3 < param_2) {
      iVar6 = (int)param_2 - (int)piVar3 >> ((byte)*in_ECX & 0x1f);
      piVar3[8] = param_1;
      piVar3[9] = iVar6;
      *piVar3 = (int)piVar3;
      piVar3[1] = (int)piVar3;
      iVar5 = FUN_005ab560(piVar3);
      if (iVar5 != 0) {
        piVar3[1] = *(int *)(iVar5 + 4);
        *piVar3 = iVar5;
        *(int **)(iVar5 + 4) = piVar3;
        *(int **)piVar3[1] = piVar3;
      }
      FUN_005ab500(piVar3);
      in_ECX[5] = in_ECX[5] + iVar6;
      param_2[8] = param_1;
      param_2[9] = uVar4 >> ((byte)*in_ECX & 0x1f);
    }
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) - uVar4;
    return CONCAT31((int3)(uVar4 >> 8),1);
  }
  return uVar4 & 0xffffff00;
}



============================================================
DISASSEMBLY
============================================================
005abe80 : PUSH EBX
005abe81 : PUSH EBP
005abe82 : MOV EBP,dword ptr [ESP + 0x10]
005abe86 : PUSH ESI
005abe87 : MOV EBX,ECX
005abe89 : PUSH EDI
005abe8a : LEA EDI,[EBX + 0x10]
005abe8d : PUSH EBP
005abe8e : MOV ECX,EDI
005abe90 : CALL 0x005ab7c0
005abe95 : MOV ESI,EAX
005abe97 : TEST ESI,ESI
005abe99 : JZ 0x005abf69
005abe9f : MOV EAX,dword ptr [ESP + 0x14]
005abea3 : CMP dword ptr [ESI + 0x20],EAX
005abea6 : JNZ 0x005abf69
005abeac : CMP EBP,ESI
005abeae : JC 0x005abf69
005abeb4 : MOV EAX,dword ptr [ESI + 0x24]
005abeb7 : MOV ECX,dword ptr [EBX]
005abeb9 : MOV EDX,EAX
005abebb : SHL EDX,CL
005abebd : ADD EDX,ESI
005abebf : CMP EBP,EDX
005abec1 : JNC 0x005abf69
005abec7 : SUB dword ptr [EBX + 0x14],EAX
005abeca : MOV EAX,dword ptr [ESI]
005abecc : LEA ECX,[EBX + 0xc]
005abecf : CMP EAX,ESI
005abed1 : JZ 0x005abee4
005abed3 : MOV EDX,dword ptr [ESI + 0x4]
005abed6 : PUSH EAX
005abed7 : MOV dword ptr [EDX],EAX
005abed9 : PUSH ESI
005abeda : MOV dword ptr [EAX + 0x4],EDX
005abedd : CALL 0x005ab5d0
005abee2 : JMP 0x005abeea
005abee4 : PUSH ESI
005abee5 : CALL 0x005ab630
005abeea : PUSH ESI
005abeeb : MOV ECX,EDI
005abeed : CALL 0x005ab6e0
005abef2 : MOV ECX,dword ptr [EBX]
005abef4 : MOV EAX,dword ptr [ESI + 0x24]
005abef7 : SHL EAX,CL
005abef9 : SUB EAX,EBP
005abefb : ADD EAX,ESI
005abefd : MOV dword ptr [ESP + 0x18],EAX
005abf01 : CMP ESI,EBP
005abf03 : JNC 0x005abf59
005abf05 : MOV EAX,dword ptr [ESP + 0x14]
005abf09 : MOV EDI,EBP
005abf0b : SUB EDI,ESI
005abf0d : SAR EDI,CL
005abf0f : PUSH ESI
005abf10 : LEA ECX,[EBX + 0xc]
005abf13 : MOV dword ptr [ESI + 0x20],EAX
005abf16 : MOV dword ptr [ESI + 0x24],EDI
005abf19 : MOV dword ptr [ESI],ESI
005abf1b : MOV dword ptr [ESI + 0x4],ESI
005abf1e : CALL 0x005ab560
005abf23 : TEST EAX,EAX
005abf25 : JZ 0x005abf37
005abf27 : MOV ECX,dword ptr [EAX + 0x4]
005abf2a : MOV dword ptr [ESI + 0x4],ECX
005abf2d : MOV dword ptr [ESI],EAX
005abf2f : MOV dword ptr [EAX + 0x4],ESI
005abf32 : MOV EDX,dword ptr [ESI + 0x4]
005abf35 : MOV dword ptr [EDX],ESI
005abf37 : PUSH ESI
005abf38 : LEA ECX,[EBX + 0x10]
005abf3b : CALL 0x005ab500
005abf40 : ADD dword ptr [EBX + 0x14],EDI
005abf43 : MOV EAX,dword ptr [ESP + 0x14]
005abf47 : MOV EDX,dword ptr [ESP + 0x18]
005abf4b : MOV dword ptr [EBP + 0x20],EAX
005abf4e : MOV ECX,dword ptr [EBX]
005abf50 : MOV EAX,dword ptr [ESP + 0x18]
005abf54 : SHR EDX,CL
005abf56 : MOV dword ptr [EBP + 0x24],EDX
005abf59 : MOV ECX,dword ptr [ESP + 0x14]
005abf5d : SUB dword ptr [ECX + 0x14],EAX
005abf60 : POP EDI
005abf61 : POP ESI
005abf62 : POP EBP
005abf63 : MOV AL,0x1
005abf65 : POP EBX
005abf66 : RET 0x8
005abf69 : POP EDI
005abf6a : POP ESI
005abf6b : POP EBP
005abf6c : XOR AL,AL
005abf6e : POP EBX
005abf6f : RET 0x8

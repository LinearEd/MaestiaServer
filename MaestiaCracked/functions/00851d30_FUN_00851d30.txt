PROGRAM  : Maestia.exe
FUNCTION : FUN_00851d30
ENTRY    : 00851d30
BODY     : [[00851d30, 008520d0]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Type propagation algorithm not settling */

void FUN_00851d30(void)

{
  char cVar1;
  char cVar2;
  char cVar3;
  int iVar4;
  int *in_ECX;
  undefined4 uVar5;
  undefined4 *puVar6;
  undefined1 uStack_125;
  undefined4 uStack_124;
  undefined4 uStack_120;
  undefined4 uStack_11c;
  undefined4 uStack_118;
  float fStack_114;
  undefined4 uStack_110;
  float afStack_10c [2];
  int iStack_104;
  int iStack_100;
  int iStack_fc;
  undefined4 uStack_f8;
  float fStack_f4;
  undefined4 uStack_ec;
  undefined4 uStack_e8;
  undefined4 uStack_e4;
  undefined4 uStack_e0;
  undefined4 uStack_dc;
  undefined4 uStack_d8;
  undefined **appuStack_d4 [48];
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_00b48db1;
  local_14 = ExceptionList;
  cVar3 = *(char *)((int)in_ECX + 0x1ea1);
  uVar5 = 0;
  if ((cVar3 != '\0') && (*(char *)((int)in_ECX + 0x1ea2) != '\0')) {
    return;
  }
  cVar1 = (char)in_ECX[0x7a8];
  ExceptionList = &local_14;
  if (cVar1 == '\0') {
    if (*(char *)((int)in_ECX + 0x1ea3) == '\0') {
      if ((cVar3 != '\0') && (*(char *)((int)in_ECX + 0x1ea2) == '\0')) {
        uVar5 = 0x10e;
      }
      cVar2 = *(char *)((int)in_ECX + 0x1ea2);
      if (cVar2 != '\0') {
        if (cVar3 != '\0') goto LAB_00851e0c;
        uVar5 = 0x5a;
      }
      goto LAB_00851e08;
    }
    uVar5 = 0xb4;
    if ((cVar3 != '\0') && (*(char *)((int)in_ECX + 0x1ea2) == '\0')) {
      uVar5 = 0xe1;
    }
    cVar2 = *(char *)((int)in_ECX + 0x1ea2);
    if (cVar2 == '\0') goto LAB_00851e08;
    if (cVar3 == '\0') {
      uVar5 = 0x87;
      goto LAB_00851e08;
    }
LAB_00851e0c:
    if (cVar1 != '\0') goto LAB_00851e20;
    if (*(char *)((int)in_ECX + 0x1ea3) != '\0') goto LAB_00851e31;
LAB_00851e19:
    FUN_008594c0(in_ECX);
  }
  else {
    if ((cVar3 != '\0') && (*(char *)((int)in_ECX + 0x1ea2) == '\0')) {
      uVar5 = 0x13b;
    }
    cVar2 = *(char *)((int)in_ECX + 0x1ea2);
    if (cVar2 != '\0') {
      if (cVar3 != '\0') goto LAB_00851e0c;
      uVar5 = 0x2d;
    }
LAB_00851e08:
    if (cVar3 != '\0') goto LAB_00851e0c;
LAB_00851e20:
    if ((cVar2 == '\0') || (cVar1 != '\0')) {
      FUN_0079c580(DAT_00d66fa0 ^ (uint)&stack0xfffffec8);
    }
    else {
      if (*(char *)((int)in_ECX + 0x1ea3) != '\0') goto LAB_00851e19;
LAB_00851e31:
      FUN_008591a0(in_ECX);
    }
  }
  if ((char)in_ECX[0x7a9] == '\0') {
    if (*(char *)((int)in_ECX + 0x1ea5) == '\0') {
      *(undefined1 *)((int)in_ECX + 0x1625) = 0;
    }
    else {
      (**(code **)(*in_ECX + 0x4b4))(uVar5);
      *(undefined1 *)((int)in_ECX + 0x1625) = 2;
    }
  }
  else {
    (**(code **)(*in_ECX + 0x4b0))(uVar5);
    *(undefined1 *)((int)in_ECX + 0x1625) = 1;
  }
  if (((((char)in_ECX[0x7a8] != '\0') || (*(char *)((int)in_ECX + 0x1ea1) != '\0')) ||
      (*(char *)((int)in_ECX + 0x1ea2) != '\0')) || (*(char *)((int)in_ECX + 0x1ea3) != '\0')) {
    (**(code **)(*in_ECX + 0x4b8))(uVar5);
  }
  if (in_ECX[0x62a] != 0) {
    if (*(char *)(in_ECX[0x62a] + 0x20) == '\0') {
      puVar6 = &DAT_00d720f0;
    }
    else {
      cVar3 = FUN_00876040();
      if (cVar3 == '\0') {
        if (*(char *)(in_ECX[0x62a] + 0xec) == '\0') {
          if (*(int *)(in_ECX[0x62a] + 0x30) == 0) goto LAB_008520ab;
          iStack_104 = in_ECX[0x560];
          iStack_100 = in_ECX[0x561];
          iStack_fc = in_ECX[0x562];
          D3DXVec3Normalize(&iStack_104,&iStack_104);
          uStack_e0 = 0;
          uStack_dc = 0xbf800000;
          uStack_d8 = 0;
          iVar4 = FUN_007d5b60(appuStack_d4);
          uStack_118 = *(undefined4 *)(iVar4 + 0x20);
          uStack_110 = *(undefined4 *)(iVar4 + 0x28);
          uStack_c = 0xffffffff;
          fStack_114 = *(float *)(iVar4 + 0x24) + DAT_00d72c20;
          uStack_ec = 0;
          uStack_e8 = 0;
          uStack_e4 = 0;
          afStack_10c[1] = 0.0;
          appuStack_d4[0] = &PTR_FUN_00cd083c;
          fStack_f4 = 0.0;
          iVar4 = FUN_007e9d70(*(undefined4 *)(DAT_00da93ec + 0xc),&uStack_e0,&uStack_f8,&uStack_ec,
                               afStack_10c + 1);
          uStack_124 = 0;
          uStack_120 = 0;
          uStack_11c = 0;
          FUN_007e3cb0(*(undefined4 *)(in_ECX[0xfa] + 0x68),*(undefined4 *)(in_ECX[0xfa] + 0x70),
                       afStack_10c,&uStack_125,&uStack_124);
          if ((iVar4 == 0) || (fStack_f4 <= afStack_10c[0])) {
            D3DXVec3Normalize(&uStack_124,&uStack_124);
            puVar6 = &uStack_f8;
            FUN_00855280(&uStack_124);
          }
          else {
            puVar6 = &DAT_00d720f0;
          }
        }
        else {
          puVar6 = &DAT_00d720f0;
        }
      }
      else {
        puVar6 = &DAT_00d720f0;
      }
    }
    FUN_00856310(puVar6);
  }
LAB_008520ab:
  if (DAT_00da93ec != 0) {
    *(undefined1 *)(DAT_00da93ec + 0x520) = 0;
  }
  ExceptionList = local_14;
  return;
}



============================================================
DISASSEMBLY
============================================================
00851d30 : PUSH EBP
00851d31 : MOV EBP,ESP
00851d33 : AND ESP,0xfffffff8
00851d36 : PUSH -0x1
00851d38 : PUSH 0xb48db1
00851d3d : MOV EAX,FS:[0x0]
00851d43 : PUSH EAX
00851d44 : SUB ESP,0x118
00851d4a : PUSH EBX
00851d4b : PUSH ESI
00851d4c : PUSH EDI
00851d4d : MOV EAX,[0x00d66fa0]
00851d52 : XOR EAX,ESP
00851d54 : PUSH EAX
00851d55 : LEA EAX,[ESP + 0x128]
00851d5c : MOV FS:[0x0],EAX
00851d62 : MOV EBX,ECX
00851d64 : MOV CL,byte ptr [EBX + 0x1ea1]
00851d6a : XOR EDI,EDI
00851d6c : TEST CL,CL
00851d6e : JZ 0x00851d7d
00851d70 : CMP byte ptr [EBX + 0x1ea2],0x0
00851d77 : JNZ 0x008520bb
00851d7d : MOV DL,byte ptr [EBX + 0x1ea0]
00851d83 : TEST DL,DL
00851d85 : JZ 0x00851dae
00851d87 : TEST CL,CL
00851d89 : JZ 0x00851d99
00851d8b : CMP byte ptr [EBX + 0x1ea2],0x0
00851d92 : JNZ 0x00851d99
00851d94 : MOV EDI,0x13b
00851d99 : MOV AL,byte ptr [EBX + 0x1ea2]
00851d9f : TEST AL,AL
00851da1 : JZ 0x00851e08
00851da3 : TEST CL,CL
00851da5 : JNZ 0x00851e0c
00851da7 : MOV EDI,0x2d
00851dac : JMP 0x00851e08
00851dae : CMP byte ptr [EBX + 0x1ea3],0x0
00851db5 : JZ 0x00851de3
00851db7 : MOV EDI,0xb4
00851dbc : TEST CL,CL
00851dbe : JZ 0x00851dce
00851dc0 : CMP byte ptr [EBX + 0x1ea2],0x0
00851dc7 : JNZ 0x00851dce
00851dc9 : MOV EDI,0xe1
00851dce : MOV AL,byte ptr [EBX + 0x1ea2]
00851dd4 : TEST AL,AL
00851dd6 : JZ 0x00851e08
00851dd8 : TEST CL,CL
00851dda : JNZ 0x00851e0c
00851ddc : MOV EDI,0x87
00851de1 : JMP 0x00851e08
00851de3 : TEST CL,CL
00851de5 : JZ 0x00851df5
00851de7 : CMP byte ptr [EBX + 0x1ea2],0x0
00851dee : JNZ 0x00851df5
00851df0 : MOV EDI,0x10e
00851df5 : MOV AL,byte ptr [EBX + 0x1ea2]
00851dfb : TEST AL,AL
00851dfd : JZ 0x00851e08
00851dff : TEST CL,CL
00851e01 : JNZ 0x00851e0c
00851e03 : MOV EDI,0x5a
00851e08 : TEST CL,CL
00851e0a : JZ 0x00851e20
00851e0c : TEST DL,DL
00851e0e : JNZ 0x00851e20
00851e10 : PUSH EBX
00851e11 : CMP byte ptr [EBX + 0x1ea3],DL
00851e17 : JNZ 0x00851e31
00851e19 : CALL 0x008594c0
00851e1e : JMP 0x00851e43
00851e20 : TEST AL,AL
00851e22 : JZ 0x00851e38
00851e24 : TEST DL,DL
00851e26 : JNZ 0x00851e38
00851e28 : PUSH EBX
00851e29 : CMP byte ptr [EBX + 0x1ea3],DL
00851e2f : JNZ 0x00851e19
00851e31 : CALL 0x008591a0
00851e36 : JMP 0x00851e43
00851e38 : MOV ESI,dword ptr [EBX + 0x410]
00851e3e : CALL 0x0079c580
00851e43 : CMP byte ptr [EBX + 0x1ea4],0x0
00851e4a : JZ 0x00851e62
00851e4c : MOV EAX,dword ptr [EBX]
00851e4e : MOV EDX,dword ptr [EAX + 0x4b0]
00851e54 : PUSH EDI
00851e55 : MOV ECX,EBX
00851e57 : CALL EDX
00851e59 : MOV byte ptr [EBX + 0x1625],0x1
00851e60 : JMP 0x00851e88
00851e62 : CMP byte ptr [EBX + 0x1ea5],0x0
00851e69 : JZ 0x00851e81
00851e6b : MOV EAX,dword ptr [EBX]
00851e6d : MOV EDX,dword ptr [EAX + 0x4b4]
00851e73 : PUSH EDI
00851e74 : MOV ECX,EBX
00851e76 : CALL EDX
00851e78 : MOV byte ptr [EBX + 0x1625],0x2
00851e7f : JMP 0x00851e88
00851e81 : MOV byte ptr [EBX + 0x1625],0x0
00851e88 : CMP byte ptr [EBX + 0x1ea0],0x0
00851e8f : JNZ 0x00851eac
00851e91 : CMP byte ptr [EBX + 0x1ea1],0x0
00851e98 : JNZ 0x00851eac
00851e9a : CMP byte ptr [EBX + 0x1ea2],0x0
00851ea1 : JNZ 0x00851eac
00851ea3 : CMP byte ptr [EBX + 0x1ea3],0x0
00851eaa : JZ 0x00851eb9
00851eac : MOV EAX,dword ptr [EBX]
00851eae : MOV EDX,dword ptr [EAX + 0x4b8]
00851eb4 : PUSH EDI
00851eb5 : MOV ECX,EBX
00851eb7 : CALL EDX
00851eb9 : MOV EAX,dword ptr [EBX + 0x18a8]
00851ebf : TEST EAX,EAX
00851ec1 : JZ 0x008520ab
00851ec7 : CMP byte ptr [EAX + 0x20],0x0
00851ecb : JNZ 0x00851ed7
00851ecd : PUSH 0xd720f0
00851ed2 : JMP 0x008520a4
00851ed7 : MOV EAX,dword ptr [EBX + 0x138]
00851edd : MOV ECX,dword ptr [EAX + 0x4]
00851ee0 : LEA ESI,[EBX + 0x1c58]
00851ee6 : LEA EDI,[ECX + EBX*0x1 + 0x138]
00851eed : CALL 0x00876040
00851ef2 : TEST AL,AL
00851ef4 : JZ 0x00851f00
00851ef6 : PUSH 0xd720f0
00851efb : JMP 0x008520a4
00851f00 : MOV EAX,dword ptr [EBX + 0x18a8]
00851f06 : CMP byte ptr [EAX + 0xec],0x0
00851f0d : JZ 0x00851f19
00851f0f : PUSH 0xd720f0
00851f14 : JMP 0x008520a4
00851f19 : CMP dword ptr [EAX + 0x30],0x0
00851f1d : JZ 0x008520ab
00851f23 : MOVSS XMM0,dword ptr [EBX + 0x1580]
00851f2b : MOVSS XMM1,dword ptr [EBX + 0x1584]
00851f33 : MOVSS XMM2,dword ptr [EBX + 0x1588]
00851f3b : LEA EDX,[ESP + 0x38]
00851f3f : PUSH EDX
00851f40 : MOV EAX,EDX
00851f42 : PUSH EAX
00851f43 : MOVSS dword ptr [ESP + 0x40],XMM0
00851f49 : MOVSS dword ptr [ESP + 0x44],XMM1
00851f4f : MOVSS dword ptr [ESP + 0x48],XMM2
00851f55 : CALL 0x004ff722
00851f5a : XORPS XMM0,XMM0
00851f5d : MOVSS XMM1,dword ptr [0x00cdf0d0]
00851f65 : LEA ECX,[ESP + 0x68]
00851f69 : PUSH ECX
00851f6a : MOV ECX,dword ptr [EBX + 0x3e8]
00851f70 : MOVSS dword ptr [ESP + 0x60],XMM0
00851f76 : MOVSS dword ptr [ESP + 0x64],XMM1
00851f7c : MOVSS dword ptr [ESP + 0x68],XMM0
00851f82 : CALL 0x007d5b60
00851f87 : MOV dword ptr [ESP + 0x130],0x0
00851f92 : MOVSS XMM0,dword ptr [EAX + 0x20]
00851f97 : MOVSS XMM1,dword ptr [EAX + 0x24]
00851f9c : MOVSS XMM2,dword ptr [EAX + 0x28]
00851fa1 : MOVSS dword ptr [ESP + 0x24],XMM0
00851fa7 : MOVSS dword ptr [ESP + 0x28],XMM1
00851fad : MOVSS dword ptr [ESP + 0x2c],XMM2
00851fb3 : MOV dword ptr [ESP + 0x130],0xffffffff
00851fbe : MOVSS XMM0,dword ptr [ESP + 0x28]
00851fc4 : ADDSS XMM0,dword ptr [0x00d72c20]
00851fcc : MOV EDX,dword ptr [0x00da93ec]
00851fd2 : MOVSS dword ptr [ESP + 0x28],XMM0
00851fd8 : XORPS XMM0,XMM0
00851fdb : MOVSS dword ptr [ESP + 0x50],XMM0
00851fe1 : MOVSS dword ptr [ESP + 0x54],XMM0
00851fe7 : MOVSS dword ptr [ESP + 0x58],XMM0
00851fed : MOVSS dword ptr [ESP + 0x34],XMM0
00851ff3 : LEA ECX,[ESP + 0x34]
00851ff7 : PUSH ECX
00851ff8 : MOV dword ptr [ESP + 0x6c],0xcd083c
00852000 : MOV EAX,dword ptr [EDX + 0xc]
00852003 : LEA EDX,[ESP + 0x54]
00852007 : PUSH EDX
00852008 : LEA ECX,[ESP + 0x4c]
0085200c : PUSH ECX
0085200d : LEA EDX,[ESP + 0x68]
00852011 : PUSH EDX
00852012 : PUSH EAX
00852013 : LEA EDI,[ESP + 0x38]
00852017 : MOVSS dword ptr [ESP + 0x5c],XMM0
0085201d : CALL 0x007e9d70
00852022 : XORPS XMM0,XMM0
00852025 : LEA ECX,[ESP + 0x18]
00852029 : PUSH ECX
0085202a : LEA EDX,[ESP + 0x1b]
0085202e : PUSH EDX
0085202f : MOV EDX,dword ptr [0x00da93ec]
00852035 : LEA ECX,[ESP + 0x38]
00852039 : MOV ESI,EAX
0085203b : MOV EAX,dword ptr [EBX + 0x3e8]
00852041 : MOVSS dword ptr [ESP + 0x20],XMM0
00852047 : MOVSS dword ptr [ESP + 0x24],XMM0
0085204d : MOVSS dword ptr [ESP + 0x28],XMM0
00852053 : FLD float ptr [EAX + 0x70]
00852056 : MOV EDI,dword ptr [EDX + 0xc]
00852059 : PUSH ECX
0085205a : SUB ESP,0x8
0085205d : FSTP float ptr [ESP + 0x4]
00852061 : FLD float ptr [EAX + 0x68]
00852064 : FSTP float ptr [ESP]
00852067 : CALL 0x007e3cb0
0085206c : TEST ESI,ESI
0085206e : JZ 0x00852084
00852070 : MOVSS XMM0,dword ptr [ESP + 0x48]
00852076 : COMISS XMM0,dword ptr [ESP + 0x30]
0085207b : JBE 0x00852084
0085207d : PUSH 0xd720f0
00852082 : JMP 0x008520a4
00852084 : LEA EAX,[ESP + 0x18]
00852088 : PUSH EAX
00852089 : MOV ECX,EAX
0085208b : PUSH ECX
0085208c : CALL 0x004ff722
00852091 : LEA EDX,[ESP + 0x18]
00852095 : PUSH EDX
00852096 : LEA EDI,[ESP + 0x48]
0085209a : MOV EAX,EBX
0085209c : CALL 0x00855280
008520a1 : MOV EAX,EDI
008520a3 : PUSH EAX
008520a4 : MOV ESI,EBX
008520a6 : CALL 0x00856310
008520ab : MOV EAX,[0x00da93ec]
008520b0 : TEST EAX,EAX
008520b2 : JZ 0x008520bb
008520b4 : MOV byte ptr [EAX + 0x520],0x0
008520bb : MOV ECX,dword ptr [ESP + 0x128]
008520c2 : MOV dword ptr FS:[0x0],ECX
008520c9 : POP ECX
008520ca : POP EDI
008520cb : POP ESI
008520cc : POP EBX
008520cd : MOV ESP,EBP
008520cf : POP EBP
008520d0 : RET

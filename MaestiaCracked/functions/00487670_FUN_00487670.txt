PROGRAM  : Maestia.exe
FUNCTION : FUN_00487670
ENTRY    : 00487670
BODY     : [[00487670, 004876f2]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00487670(void)

{
  int *piVar1;
  int *_Memory;
  undefined4 *in_ECX;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_00b70ed8;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  *in_ECX = &PTR_FUN_00cd8068;
  local_8 = 0;
  _Memory = (int *)in_ECX[7];
  if (_Memory != (int *)0x0) {
    do {
      piVar1 = (int *)*_Memory;
      _free(_Memory);
      _Memory = piVar1;
    } while (piVar1 != (int *)0x0);
    in_ECX[7] = 0;
  }
  in_ECX[8] = 0;
  local_8 = 0xffffffff;
  *in_ECX = &PTR_FUN_00cdec94;
  DeleteCriticalSection((LPCRITICAL_SECTION)(in_ECX + 1));
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00487670 : PUSH EBP
00487671 : MOV EBP,ESP
00487673 : PUSH -0x1
00487675 : PUSH 0xb70ed8
0048767a : MOV EAX,FS:[0x0]
00487680 : PUSH EAX
00487681 : PUSH ECX
00487682 : PUSH ESI
00487683 : PUSH EDI
00487684 : MOV EAX,[0x00d66fa0]
00487689 : XOR EAX,EBP
0048768b : PUSH EAX
0048768c : LEA EAX,[EBP + -0xc]
0048768f : MOV FS:[0x0],EAX
00487695 : MOV EDI,ECX
00487697 : MOV dword ptr [EBP + -0x10],EDI
0048769a : MOV dword ptr [EDI],0xcd8068
004876a0 : MOV dword ptr [EBP + -0x4],0x0
004876a7 : MOV EAX,dword ptr [EDI + 0x1c]
004876aa : TEST EAX,EAX
004876ac : JZ 0x004876c4
004876ae : MOV EDI,EDI
004876b0 : MOV ESI,dword ptr [EAX]
004876b2 : PUSH EAX
004876b3 : CALL 0x0063610d
004876b8 : ADD ESP,0x4
004876bb : MOV EAX,ESI
004876bd : TEST ESI,ESI
004876bf : JNZ 0x004876b0
004876c1 : MOV dword ptr [EDI + 0x1c],ESI
004876c4 : MOV dword ptr [EDI + 0x20],0x0
004876cb : MOV dword ptr [EBP + -0x4],0xffffffff
004876d2 : MOV dword ptr [EDI],0xcdec94
004876d8 : ADD EDI,0x4
004876db : PUSH EDI
004876dc : CALL dword ptr [0x00b850fc]
004876e2 : MOV ECX,dword ptr [EBP + -0xc]
004876e5 : MOV dword ptr FS:[0x0],ECX
004876ec : POP ECX
004876ed : POP EDI
004876ee : POP ESI
004876ef : MOV ESP,EBP
004876f1 : POP EBP
004876f2 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00860040
ENTRY    : 00860040
BODY     : [[00860040, 008602bc] [008602c0, 008606f6]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00860040(int param_1)

{
  short *psVar1;
  short sVar2;
  uint uVar3;
  undefined4 uVar4;
  int iVar5;
  int iVar6;
  int *in_ECX;
  int iVar7;
  undefined8 uVar8;
  undefined1 auStack_7c [7];
  undefined1 local_75;
  int local_74;
  uint local_70;
  int local_6c;
  int iStack_68;
  int local_64 [2];
  undefined1 auStack_5c [4];
  int iStack_58;
  undefined2 local_34;
  undefined4 local_24;
  uint local_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  int local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b48f53;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_7c;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xffffff78;
  ExceptionList = &local_14;
  local_64[0] = in_ECX[0x5fc];
  FUN_00856fb0(param_1);
  local_70 = 0;
  *(undefined1 *)(in_ECX + 0x5a4) = 0;
  iVar6 = DAT_00d7c54c;
  if (param_1 == 0) {
    FUN_0084fb70(uVar3);
    iVar6 = DAT_00d7c54c;
    local_74 = in_ECX[2];
    in_ECX[0x69c] = 0;
    FUN_004437f0(&local_74);
    if (local_6c == *(int *)(iVar6 + 0x44)) {
      iVar6 = 0;
    }
    else {
      iVar6 = *(int *)(local_6c + 0x10);
    }
    if (*(int *)(iVar6 + 300) != 0) {
      local_74 = (**(code **)(*(int *)(*(int *)(iVar6 + 300) + 0x1f8) + 4))();
      while (local_74 != 0) {
        iVar6 = FUN_004f5680();
        sVar2 = *(short *)(iVar6 + 0x18);
        if ((((sVar2 == 3) || (sVar2 == 4)) || (sVar2 == 5)) || (sVar2 == 0xb)) {
          FUN_0088cc50(sVar2,iVar6);
        }
      }
    }
  }
  else {
    local_74 = param_1;
    FUN_004437f0(&local_74);
    if ((local_6c == *(int *)(iVar6 + 0x44)) ||
       (iVar6 = *(int *)(local_6c + 0x10), local_74 = iVar6, iVar6 == 0)) goto LAB_008606d7;
    local_70 = (uint)*(ushort *)(iVar6 + 0x28a);
    *(uint *)(local_64[0] + 0x160) = local_70;
    if ((*(uint *)(iVar6 + 0x4c) & 0x100000) != 0) {
      *(undefined1 *)(in_ECX + 0x5a4) = 1;
    }
    in_ECX[0x69c] = *(int *)(iVar6 + 0x29c);
    local_20 = 7;
    local_24 = 0;
    local_34 = 0;
    local_c = 0;
    local_6c = FUN_004049b0(*(undefined4 *)(in_ECX[0x616] + 0x28));
    if (local_6c == 0) {
      uVar4 = FUN_00404350(iVar6 + 400);
      local_c._0_1_ = 3;
      FUN_00405eb0(uVar4,0,0xffffffff);
      local_c._0_1_ = 0;
      FUN_00406560();
      uVar4 = FUN_00404350(iVar6 + 0x1d0);
      local_c._0_1_ = 4;
    }
    else {
      uVar4 = FUN_00404350(local_6c + 400);
      local_c._0_1_ = 1;
      FUN_00405eb0(uVar4,0,0xffffffff);
      local_c._0_1_ = 0;
      FUN_00406560();
      uVar4 = FUN_00404350(local_6c + 0x1d0);
      local_c._0_1_ = 2;
    }
    FUN_00405eb0(uVar4,0,0xffffffff);
    local_c = (uint)local_c._1_3_ << 8;
    FUN_00406560();
    if ((*(short *)(iVar6 + 0x28a) == 5) && (in_ECX[0x61c] != 0)) {
      FUN_0084faa0();
    }
    iVar6 = local_64[0];
    FUN_0084fb70();
    *(uint *)(iVar6 + 0x160) = local_70 & 0xffff;
    if ((char)in_ECX[0x5a4] == '\x01') {
      local_70 = 1;
    }
    FUN_0084fd30(local_70 & 0xffff);
    *(undefined1 *)(iVar6 + 0x1a8) = 0;
    if (*(int **)(iVar6 + 0x168) != (int *)0x0) {
      (**(code **)(**(int **)(iVar6 + 0x168) + 0x10))(0);
    }
    if (*(int **)(iVar6 + 0x16c) != (int *)0x0) {
      (**(code **)(**(int **)(iVar6 + 0x16c) + 0x10))(0);
    }
    local_64[0] = (**(code **)(*(int *)(local_74 + 0x210) + 4))();
    while (local_64[0] != 0) {
      iVar5 = FUN_004f5680();
      FUN_0088ccd0(*(undefined2 *)(iVar5 + 0x18),iVar5);
    }
    if (local_6c == 0) {
      (**(code **)(*in_ECX + 0x45c))(local_74,param_1,local_70);
    }
    FUN_0084c320((char)in_ECX[0x663]);
    if ((char)in_ECX[0x663] != '\0') {
      *(undefined1 *)(iVar6 + 0x1a8) = 0;
      if (*(int **)(iVar6 + 0x168) != (int *)0x0) {
        (**(code **)(**(int **)(iVar6 + 0x168) + 0x10))(0);
      }
      if (*(int **)(iVar6 + 0x16c) != (int *)0x0) {
        (**(code **)(**(int **)(iVar6 + 0x16c) + 0x10))(0);
      }
    }
    local_c = 0xffffffff;
    if (7 < local_20) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_20 = 7;
    local_24 = 0;
    local_34 = 0;
  }
  if ((char)in_ECX[0x5a4] == '\x01') {
    local_70 = 1;
  }
  if ((short)in_ECX[0x10f] == (short)local_70) goto LAB_008606d7;
  psVar1 = (short *)((int)in_ECX + 0x43a);
  *(short *)(in_ECX + 0x10f) = (short)local_70;
  if ((*(short *)((int)in_ECX + 0x43a) == 0) || (in_ECX[0x110] == 0)) goto LAB_008606d7;
  iVar6 = FUN_0088cdd0(psVar1,&local_75,0,0);
  local_74 = iVar6;
  FUN_00404a20(auStack_5c);
  local_c._0_1_ = 5;
  local_c._1_3_ = 0;
  if ((in_ECX[0x62a] == 0) || (*(char *)(in_ECX[0x62a] + 0x20) == '\0')) {
    if (iVar6 == 4) {
      FUN_00abdd00(&local_6c,local_70,*psVar1 + 1000,0);
      local_c._0_1_ = 8;
      FUN_00463a60();
      local_c._0_1_ = 5;
      FUN_0040ed80(&local_6c);
      if (iStack_58 != 0) goto LAB_00860626;
      FUN_00abdd00(&local_6c,local_70,*(undefined2 *)((int)in_ECX + 0x43a),0);
      local_c._0_1_ = 9;
      FUN_00463a60();
    }
    else {
      FUN_00abdd00(&local_6c,local_70,*psVar1,0);
      local_c._0_1_ = 10;
      FUN_00463a60();
    }
LAB_00860621:
    local_c._0_1_ = 5;
    FUN_0040ed80(&local_6c);
  }
  else {
    uVar8 = FUN_0083ac80();
    if ((short)uVar8 != 0) {
      *psVar1 = (short)uVar8;
      local_75 = 0;
      FUN_00abe000(&local_6c,*(undefined4 *)((int)((ulonglong)uVar8 >> 0x20) + 0x24),
                   (uint)uVar8 & 0xffff,(short)in_ECX[0x1f],1);
      local_c._0_1_ = 6;
      if (iStack_68 == 0) {
        FUN_00abe000(local_64,(short)in_ECX[0x10f],*psVar1,(short)in_ECX[0x1f],0);
        local_c._0_1_ = 7;
        FUN_00463a60();
        local_c._0_1_ = 6;
        FUN_0040ed80(local_64);
      }
      goto LAB_00860621;
    }
  }
LAB_00860626:
  iVar6 = 0;
  if (local_74 == 4) {
    iVar6 = 1;
  }
  else if (local_74 == 3) {
    iVar6 = 2;
  }
  iVar5 = in_ECX[0x104];
  local_6c = CONCAT31(local_6c._1_3_,*(undefined1 *)(iVar6 * 0x30 + 0xb0 + iVar5));
  iVar7 = (iVar6 * 3 + 9) * 0x10;
  local_64[0] = *(int *)(iVar7 + iVar5);
  FUN_0079d530(iVar5,auStack_5c,*(undefined2 *)((int)in_ECX + 0x43a),local_74,0,local_6c,0x3f800000,
               0x3f800000);
  *(int *)(in_ECX[0x104] + iVar7) = local_64[0];
  *(undefined1 *)(in_ECX[0x104] + 0xb6 + iVar6 * 0x30) = 1;
  (**(code **)(*(int *)in_ECX[0x104] + 0x10))();
  local_c = 0xffffffff;
  FUN_0040ed80(auStack_5c);
LAB_008606d7:
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_7c);
  return;
}



============================================================
DISASSEMBLY
============================================================
00860040 : PUSH EBP
00860041 : MOV EBP,ESP
00860043 : AND ESP,0xfffffff8
00860046 : PUSH -0x1
00860048 : PUSH 0xb48f53
0086004d : MOV EAX,FS:[0x0]
00860053 : PUSH EAX
00860054 : SUB ESP,0x68
00860057 : MOV EAX,[0x00d66fa0]
0086005c : XOR EAX,ESP
0086005e : MOV dword ptr [ESP + 0x60],EAX
00860062 : PUSH EBX
00860063 : PUSH ESI
00860064 : PUSH EDI
00860065 : MOV EAX,[0x00d66fa0]
0086006a : XOR EAX,ESP
0086006c : PUSH EAX
0086006d : LEA EAX,[ESP + 0x78]
00860071 : MOV FS:[0x0],EAX
00860077 : MOV EDI,dword ptr [EBP + 0x8]
0086007a : MOV EBX,ECX
0086007c : MOV EAX,dword ptr [EBX + 0x17f0]
00860082 : PUSH EDI
00860083 : MOV ESI,EBX
00860085 : MOV dword ptr [ESP + 0x2c],EAX
00860089 : CALL 0x00856fb0
0086008e : MOV dword ptr [ESP + 0x1c],0x0
00860096 : MOV byte ptr [EBX + 0x1690],0x0
0086009d : TEST EDI,EDI
0086009f : JZ 0x0086037a
008600a5 : MOV ESI,dword ptr [0x00d7c54c]
008600ab : LEA ECX,[ESP + 0x18]
008600af : PUSH ECX
008600b0 : LEA ECX,[ESI + 0x40]
008600b3 : LEA EAX,[ESP + 0x24]
008600b7 : MOV dword ptr [ESP + 0x1c],EDI
008600bb : CALL 0x004437f0
008600c0 : MOV ESI,dword ptr [ESI + 0x44]
008600c3 : MOV EAX,dword ptr [ESP + 0x20]
008600c7 : CMP EAX,ESI
008600c9 : JZ 0x008606d7
008600cf : MOV EDI,dword ptr [EAX + 0x10]
008600d2 : XOR ESI,ESI
008600d4 : MOV dword ptr [ESP + 0x18],EDI
008600d8 : CMP EDI,ESI
008600da : JZ 0x008606d7
008600e0 : MOVZX EAX,word ptr [EDI + 0x28a]
008600e7 : MOV EDX,dword ptr [ESP + 0x28]
008600eb : MOV dword ptr [ESP + 0x1c],EAX
008600ef : MOVZX EAX,AX
008600f2 : MOV dword ptr [EDX + 0x160],EAX
008600f8 : MOV ECX,dword ptr [EDI + 0x4c]
008600fb : AND ECX,0x100000
00860101 : XOR EAX,EAX
00860103 : OR EAX,ECX
00860105 : JZ 0x0086010e
00860107 : MOV byte ptr [EBX + 0x1690],0x1
0086010e : MOV EAX,dword ptr [EDI + 0x29c]
00860114 : MOV dword ptr [EBX + 0x1a70],EAX
0086011a : XOR EAX,EAX
0086011c : MOV dword ptr [ESP + 0x6c],0x7
00860124 : MOV dword ptr [ESP + 0x68],ESI
00860128 : MOV word ptr [ESP + 0x58],AX
0086012d : MOV dword ptr [ESP + 0x80],ESI
00860134 : MOV ECX,dword ptr [EBX + 0x1858]
0086013a : MOV EAX,dword ptr [ECX + 0x28]
0086013d : PUSH EAX
0086013e : CALL 0x004049b0
00860143 : ADD ESP,0x4
00860146 : CMP EAX,ESI
00860148 : MOV dword ptr [ESP + 0x20],EAX
0086014c : LEA ESI,[ESP + 0x38]
00860150 : JZ 0x008601a6
00860152 : ADD EAX,0x190
00860157 : PUSH EAX
00860158 : CALL 0x00404350
0086015d : ADD ESP,0x4
00860160 : MOV byte ptr [ESP + 0x80],0x1
00860168 : PUSH -0x1
0086016a : PUSH 0x0
0086016c : PUSH EAX
0086016d : LEA ECX,[ESP + 0x60]
00860171 : CALL 0x00405eb0
00860176 : MOV byte ptr [ESP + 0x80],0x0
0086017e : MOV ECX,ESI
00860180 : CALL 0x00406560
00860185 : MOV EDX,dword ptr [ESP + 0x20]
00860189 : ADD EDX,0x1d0
0086018f : PUSH EDX
00860190 : LEA ESI,[ESP + 0x3c]
00860194 : CALL 0x00404350
00860199 : ADD ESP,0x4
0086019c : MOV byte ptr [ESP + 0x80],0x2
008601a4 : JMP 0x008601f7
008601a6 : LEA EAX,[EDI + 0x190]
008601ac : PUSH EAX
008601ad : CALL 0x00404350
008601b2 : ADD ESP,0x4
008601b5 : MOV byte ptr [ESP + 0x80],0x3
008601bd : PUSH -0x1
008601bf : PUSH 0x0
008601c1 : PUSH EAX
008601c2 : LEA ECX,[ESP + 0x60]
008601c6 : CALL 0x00405eb0
008601cb : MOV byte ptr [ESP + 0x80],0x0
008601d3 : LEA ECX,[ESP + 0x38]
008601d7 : CALL 0x00406560
008601dc : LEA ECX,[EDI + 0x1d0]
008601e2 : PUSH ECX
008601e3 : LEA ESI,[ESP + 0x3c]
008601e7 : CALL 0x00404350
008601ec : ADD ESP,0x4
008601ef : MOV byte ptr [ESP + 0x80],0x4
008601f7 : MOV ECX,dword ptr [ESP + 0x28]
008601fb : PUSH -0x1
008601fd : PUSH 0x0
008601ff : PUSH EAX
00860200 : ADD ECX,0x170
00860206 : CALL 0x00405eb0
0086020b : MOV byte ptr [ESP + 0x80],0x0
00860213 : LEA ECX,[ESP + 0x38]
00860217 : CALL 0x00406560
0086021c : CMP word ptr [EDI + 0x28a],0x5
00860224 : JNZ 0x00860235
00860226 : MOV EDI,dword ptr [EBX + 0x1870]
0086022c : TEST EDI,EDI
0086022e : JZ 0x00860235
00860230 : CALL 0x0084faa0
00860235 : MOV ESI,dword ptr [ESP + 0x28]
00860239 : CALL 0x0084fb70
0086023e : MOVZX EAX,word ptr [ESP + 0x1c]
00860243 : MOV EDX,ESI
00860245 : MOV dword ptr [EDX + 0x160],EAX
0086024b : CMP byte ptr [EBX + 0x1690],0x1
00860252 : JNZ 0x0086025c
00860254 : MOV dword ptr [ESP + 0x1c],0x1
0086025c : MOVZX EAX,word ptr [ESP + 0x1c]
00860261 : PUSH EAX
00860262 : LEA EDI,[ESP + 0x58]
00860266 : MOV ESI,EDX
00860268 : CALL 0x0084fd30
0086026d : MOV EDI,ESI
0086026f : MOV ECX,dword ptr [EDI + 0x168]
00860275 : MOV byte ptr [EDI + 0x1a8],0x0
0086027c : TEST ECX,ECX
0086027e : JZ 0x00860289
00860280 : MOV EDX,dword ptr [ECX]
00860282 : MOV EAX,dword ptr [EDX + 0x10]
00860285 : PUSH 0x0
00860287 : CALL EAX
00860289 : MOV ECX,dword ptr [EDI + 0x16c]
0086028f : TEST ECX,ECX
00860291 : JZ 0x0086029c
00860293 : MOV EDX,dword ptr [ECX]
00860295 : MOV EAX,dword ptr [EDX + 0x10]
00860298 : PUSH 0x0
0086029a : CALL EAX
0086029c : MOV ESI,dword ptr [ESP + 0x18]
008602a0 : MOV EDX,dword ptr [ESI + 0x210]
008602a6 : MOV EAX,dword ptr [EDX + 0x4]
008602a9 : ADD ESI,0x210
008602af : MOV ECX,ESI
008602b1 : CALL EAX
008602b3 : MOV dword ptr [ESP + 0x28],EAX
008602b7 : TEST EAX,EAX
008602b9 : JZ 0x008602df
008602bb : JMP 0x008602c0
008602c0 : LEA EDX,[ESP + 0x28]
008602c4 : MOV EAX,ESI
008602c6 : CALL 0x004f5680
008602cb : MOVZX ECX,word ptr [EAX + 0x18]
008602cf : PUSH EAX
008602d0 : PUSH ECX
008602d1 : MOV EAX,EBX
008602d3 : CALL 0x0088ccd0
008602d8 : CMP dword ptr [ESP + 0x28],0x0
008602dd : JNZ 0x008602c0
008602df : CMP dword ptr [ESP + 0x20],0x0
008602e4 : JNZ 0x00860300
008602e6 : MOV EAX,dword ptr [ESP + 0x1c]
008602ea : MOV ECX,dword ptr [EBP + 0x8]
008602ed : MOV EDX,dword ptr [EBX]
008602ef : MOV EDX,dword ptr [EDX + 0x45c]
008602f5 : PUSH EAX
008602f6 : MOV EAX,dword ptr [ESP + 0x1c]
008602fa : PUSH ECX
008602fb : PUSH EAX
008602fc : MOV ECX,EBX
008602fe : CALL EDX
00860300 : MOVZX EAX,byte ptr [EBX + 0x198c]
00860307 : PUSH EAX
00860308 : CALL 0x0084c320
0086030d : CMP byte ptr [EBX + 0x198c],0x0
00860314 : JZ 0x00860343
00860316 : MOV ECX,dword ptr [EDI + 0x168]
0086031c : MOV byte ptr [EDI + 0x1a8],0x0
00860323 : TEST ECX,ECX
00860325 : JZ 0x00860330
00860327 : MOV EDX,dword ptr [ECX]
00860329 : MOV EAX,dword ptr [EDX + 0x10]
0086032c : PUSH 0x0
0086032e : CALL EAX
00860330 : MOV ECX,dword ptr [EDI + 0x16c]
00860336 : TEST ECX,ECX
00860338 : JZ 0x00860343
0086033a : MOV EDX,dword ptr [ECX]
0086033c : MOV EAX,dword ptr [EDX + 0x10]
0086033f : PUSH 0x0
00860341 : CALL EAX
00860343 : MOV dword ptr [ESP + 0x80],0xffffffff
0086034e : CMP dword ptr [ESP + 0x6c],0x8
00860353 : JC 0x0086035e
00860355 : MOV ECX,dword ptr [ESP + 0x58]
00860359 : CALL 0x006f04e0
0086035e : XOR ECX,ECX
00860360 : MOV dword ptr [ESP + 0x6c],0x7
00860368 : MOV dword ptr [ESP + 0x68],0x0
00860370 : MOV word ptr [ESP + 0x58],CX
00860375 : JMP 0x0086041c
0086037a : MOV ESI,dword ptr [ESP + 0x28]
0086037e : CALL 0x0084fb70
00860383 : MOV EDX,dword ptr [EBX + 0x8]
00860386 : MOV ESI,dword ptr [0x00d7c54c]
0086038c : LEA EAX,[ESP + 0x18]
00860390 : PUSH EAX
00860391 : LEA ECX,[ESI + 0x40]
00860394 : LEA EAX,[ESP + 0x24]
00860398 : MOV dword ptr [EBX + 0x1a70],0x0
008603a2 : MOV dword ptr [ESP + 0x1c],EDX
008603a6 : CALL 0x004437f0
008603ab : MOV ESI,dword ptr [ESI + 0x44]
008603ae : MOV EAX,dword ptr [ESP + 0x20]
008603b2 : CMP EAX,ESI
008603b4 : JZ 0x008603bb
008603b6 : MOV EAX,dword ptr [EAX + 0x10]
008603b9 : JMP 0x008603bd
008603bb : XOR EAX,EAX
008603bd : MOV EAX,dword ptr [EAX + 0x12c]
008603c3 : TEST EAX,EAX
008603c5 : JZ 0x0086041c
008603c7 : MOV EDX,dword ptr [EAX + 0x1f8]
008603cd : LEA ESI,[EAX + 0x1f8]
008603d3 : MOV EAX,dword ptr [EDX + 0x4]
008603d6 : MOV ECX,ESI
008603d8 : CALL EAX
008603da : MOV dword ptr [ESP + 0x18],EAX
008603de : TEST EAX,EAX
008603e0 : JZ 0x0086041c
008603e2 : LEA EDX,[ESP + 0x18]
008603e6 : MOV EAX,ESI
008603e8 : CALL 0x004f5680
008603ed : MOVZX ECX,word ptr [EAX + 0x18]
008603f1 : CMP CX,0x3
008603f5 : JZ 0x00860409
008603f7 : CMP CX,0x4
008603fb : JZ 0x00860409
008603fd : CMP CX,0x5
00860401 : JZ 0x00860409
00860403 : CMP CX,0xb
00860407 : JNZ 0x00860415
00860409 : MOVZX ECX,CX
0086040c : PUSH EAX
0086040d : PUSH ECX
0086040e : MOV EAX,EBX
00860410 : CALL 0x0088cc50
00860415 : CMP dword ptr [ESP + 0x18],0x0
0086041a : JNZ 0x008603e2
0086041c : CMP byte ptr [EBX + 0x1690],0x1
00860423 : JNZ 0x0086042d
00860425 : MOV dword ptr [ESP + 0x1c],0x1
0086042d : MOV EAX,dword ptr [ESP + 0x1c]
00860431 : CMP word ptr [EBX + 0x43c],AX
00860438 : JZ 0x008606d7
0086043e : CMP word ptr [EBX + 0x43a],0x0
00860446 : LEA ESI,[EBX + 0x43a]
0086044c : MOV word ptr [EBX + 0x43c],AX
00860453 : JZ 0x008606d7
00860459 : CMP dword ptr [EBX + 0x440],0x0
00860460 : JZ 0x008606d7
00860466 : PUSH 0x0
00860468 : PUSH 0x0
0086046a : LEA EDX,[ESP + 0x1f]
0086046e : PUSH EDX
0086046f : PUSH ESI
00860470 : MOV EDI,EBX
00860472 : CALL 0x0088cdd0
00860477 : MOV EDI,EAX
00860479 : LEA EAX,[ESP + 0x30]
0086047d : PUSH EAX
0086047e : MOV dword ptr [ESP + 0x1c],EDI
00860482 : CALL 0x00404a20
00860487 : MOV dword ptr [ESP + 0x80],0x5
00860492 : MOV EDX,dword ptr [EBX + 0x18a8]
00860498 : TEST EDX,EDX
0086049a : JZ 0x00860553
008604a0 : CMP byte ptr [EDX + 0x20],0x0
008604a4 : JZ 0x00860553
008604aa : MOV CX,word ptr [ESI]
008604ad : CALL 0x0083ac80
008604b2 : MOVZX EAX,AX
008604b5 : TEST AX,AX
008604b8 : JBE 0x00860626
008604be : MOVZX ECX,word ptr [EBX + 0x7c]
008604c2 : PUSH 0x1
008604c4 : PUSH ECX
008604c5 : MOV word ptr [ESI],AX
008604c8 : MOV EDX,dword ptr [EDX + 0x24]
008604cb : PUSH EAX
008604cc : PUSH EDX
008604cd : LEA EDX,[ESP + 0x30]
008604d1 : PUSH EDX
008604d2 : MOV EDX,dword ptr [EBX + 0x440]
008604d8 : LEA ECX,[ESP + 0x2b]
008604dc : MOV byte ptr [ESP + 0x2b],0x0
008604e1 : CALL 0x00abe000
008604e6 : MOV byte ptr [ESP + 0x80],0x6
008604ee : CMP dword ptr [ESP + 0x24],0x0
008604f3 : JNZ 0x00860541
008604f5 : MOVZX EAX,word ptr [EBX + 0x7c]
008604f9 : MOVZX ECX,word ptr [ESI]
008604fc : MOVZX EDX,word ptr [EBX + 0x43c]
00860503 : PUSH 0x0
00860505 : PUSH EAX
00860506 : PUSH ECX
00860507 : PUSH EDX
00860508 : MOV EDX,dword ptr [EBX + 0x440]
0086050e : LEA EAX,[ESP + 0x38]
00860512 : PUSH EAX
00860513 : LEA ECX,[ESP + 0x2b]
00860517 : CALL 0x00abe000
0086051c : MOV byte ptr [ESP + 0x80],0x7
00860524 : MOV ESI,EAX
00860526 : LEA EDI,[ESP + 0x20]
0086052a : CALL 0x00463a60
0086052f : MOV byte ptr [ESP + 0x80],0x6
00860537 : LEA ECX,[ESP + 0x28]
0086053b : PUSH ECX
0086053c : CALL 0x0040ed80
00860541 : MOV byte ptr [ESP + 0x80],0x5
00860549 : LEA EDX,[ESP + 0x20]
0086054d : PUSH EDX
0086054e : JMP 0x00860621
00860553 : PUSH 0x0
00860555 : CMP EDI,0x4
00860558 : JNZ 0x008605e8
0086055e : MOV EDX,dword ptr [ESP + 0x20]
00860562 : MOV EAX,0x3e8
00860567 : ADD AX,word ptr [ESI]
0086056a : MOVZX ECX,AX
0086056d : PUSH ECX
0086056e : MOV ECX,dword ptr [EBX + 0x440]
00860574 : PUSH EDX
00860575 : LEA EAX,[ESP + 0x2c]
00860579 : PUSH EAX
0086057a : CALL 0x00abdd00
0086057f : MOV byte ptr [ESP + 0x80],0x8
00860587 : MOV ESI,EAX
00860589 : LEA EDI,[ESP + 0x30]
0086058d : CALL 0x00463a60
00860592 : MOV byte ptr [ESP + 0x80],0x5
0086059a : LEA ECX,[ESP + 0x20]
0086059e : PUSH ECX
0086059f : CALL 0x0040ed80
008605a4 : CMP dword ptr [ESP + 0x34],0x0
008605a9 : JNZ 0x00860626
008605ab : MOVZX EDX,word ptr [EBX + 0x43a]
008605b2 : MOV EAX,dword ptr [ESP + 0x1c]
008605b6 : PUSH 0x0
008605b8 : PUSH EDX
008605b9 : PUSH EAX
008605ba : LEA ECX,[ESP + 0x2c]
008605be : PUSH ECX
008605bf : MOV ECX,dword ptr [EBX + 0x440]
008605c5 : CALL 0x00abdd00
008605ca : MOV byte ptr [ESP + 0x80],0x9
008605d2 : MOV ESI,EAX
008605d4 : CALL 0x00463a60
008605d9 : MOV byte ptr [ESP + 0x80],0x5
008605e1 : LEA EDX,[ESP + 0x20]
008605e5 : PUSH EDX
008605e6 : JMP 0x00860621
008605e8 : MOVZX EAX,word ptr [ESI]
008605eb : MOV ECX,dword ptr [ESP + 0x20]
008605ef : PUSH EAX
008605f0 : PUSH ECX
008605f1 : MOV ECX,dword ptr [EBX + 0x440]
008605f7 : LEA EDX,[ESP + 0x2c]
008605fb : PUSH EDX
008605fc : CALL 0x00abdd00
00860601 : MOV byte ptr [ESP + 0x80],0xa
00860609 : MOV ESI,EAX
0086060b : LEA EDI,[ESP + 0x30]
0086060f : CALL 0x00463a60
00860614 : MOV byte ptr [ESP + 0x80],0x5
0086061c : LEA EAX,[ESP + 0x20]
00860620 : PUSH EAX
00860621 : CALL 0x0040ed80
00860626 : MOV ECX,dword ptr [ESP + 0x18]
0086062a : XOR EAX,EAX
0086062c : CMP ECX,0x4
0086062f : JNZ 0x00860636
00860631 : LEA EAX,[ECX + -0x3]
00860634 : JMP 0x00860640
00860636 : CMP ECX,0x3
00860639 : JNZ 0x00860640
0086063b : MOV EAX,0x2
00860640 : MOV ECX,dword ptr [EBX + 0x410]
00860646 : FLD1
00860648 : LEA EDI,[EAX + EAX*0x2]
0086064b : SUB ESP,0x8
0086064e : FST float ptr [ESP + 0x4]
00860652 : SHL EDI,0x4
00860655 : MOV DL,byte ptr [EDI + ECX*0x1 + 0xb0]
0086065c : FSTP float ptr [ESP]
0086065f : LEA ESI,[EAX + EAX*0x2 + 0x9]
00860663 : MOV byte ptr [ESP + 0x28],DL
00860667 : MOV EAX,dword ptr [ESP + 0x28]
0086066b : MOV EDX,dword ptr [ESP + 0x20]
0086066f : PUSH EAX
00860670 : MOVZX EAX,word ptr [EBX + 0x43a]
00860677 : PUSH 0x0
00860679 : PUSH EDX
0086067a : PUSH EAX
0086067b : LEA EDX,[ESP + 0x48]
0086067f : PUSH EDX
00860680 : SHL ESI,0x4
00860683 : MOVSS XMM0,dword ptr [ESI + ECX*0x1]
00860688 : PUSH ECX
00860689 : MOVSS dword ptr [ESP + 0x48],XMM0
0086068f : CALL 0x0079d530
00860694 : MOV EAX,dword ptr [EBX + 0x410]
0086069a : MOVSS XMM0,dword ptr [ESP + 0x28]
008606a0 : MOVSS dword ptr [EAX + ESI*0x1],XMM0
008606a5 : MOV EAX,dword ptr [EBX + 0x410]
008606ab : MOV byte ptr [EAX + EDI*0x1 + 0xb6],0x1
008606b3 : MOV EBX,dword ptr [EBX + 0x410]
008606b9 : MOV EAX,dword ptr [EBX]
008606bb : MOV EDX,dword ptr [EAX + 0x10]
008606be : MOV ECX,EBX
008606c0 : CALL EDX
008606c2 : MOV dword ptr [ESP + 0x80],0xffffffff
008606cd : LEA EAX,[ESP + 0x30]
008606d1 : PUSH EAX
008606d2 : CALL 0x0040ed80
008606d7 : MOV ECX,dword ptr [ESP + 0x78]
008606db : MOV dword ptr FS:[0x0],ECX
008606e2 : POP ECX
008606e3 : POP EDI
008606e4 : POP ESI
008606e5 : POP EBX
008606e6 : MOV ECX,dword ptr [ESP + 0x60]
008606ea : XOR ECX,ESP
008606ec : CALL 0x00633e6b
008606f1 : MOV ESP,EBP
008606f3 : POP EBP
008606f4 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_007b8f50
ENTRY    : 007b8f50
BODY     : [[007b8f50, 007b91de]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007b8f50(int param_1,int *param_2)

{
  int *piVar1;
  int *piVar2;
  int iVar3;
  undefined4 uVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  float in_XMM0_Da;
  undefined4 local_ec [16];
  undefined4 local_ac [16];
  undefined4 local_6c [17];
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  float local_1c;
  float local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  int *local_8;
  
  if ((((((*(char *)(param_1 + 0xe9) == '\0') && (*(char *)(param_1 + 0xe8) == '\0')) &&
        (0 < *(int *)(DAT_017251ac + 0x3fc))) &&
       ((param_2 != (int *)0x0 && (*(int *)(*(int *)(param_1 + 0xa4) + 0x18c) != 0)))) &&
      ((piVar1 = *(int **)(DAT_01725204 + 0x178), piVar1 != (int *)0x0 &&
       ((*(int *)(DAT_017251ac + 0x1a4) != 0 &&
        (*(int *)(*(int *)(DAT_017251ac + 0x1a4) + 0xf0) != 0)))))) &&
     ((*(int *)(**(int **)(*(int *)(param_1 + 0xa4) + 0x188) + 0x24) != 0 &&
      (piVar2 = *(int **)(DAT_017251ac + 0x18), piVar2 != (int *)0x0)))) {
    local_8 = (int *)0x0;
    iVar3 = (**(code **)(*piVar1 + 0x48))(piVar1,0,&local_8);
    if (-1 < iVar3) {
      FUN_00771f70();
      local_14 = 0;
      local_10 = 0xbf800000;
      local_c = 0;
      local_18 = in_XMM0_Da;
      D3DXVec3Normalize(&local_14,&local_14);
      local_28 = local_14;
      local_24 = local_10;
      local_20 = local_c;
      local_1c = local_18 + 2.0;
      (**(code **)(*param_2 + 0x1c))();
      uVar4 = FUN_007f1710();
      D3DXMatrixMultiply(local_ac,param_2 + 0x2d,uVar4);
      puVar5 = local_ac;
      puVar6 = local_ec;
      for (iVar3 = 0x10; iVar3 != 0; iVar3 = iVar3 + -1) {
        *puVar6 = *puVar5;
        puVar5 = puVar5 + 1;
        puVar6 = puVar6 + 1;
      }
      local_6c[0] = 0;
      D3DXMatrixInverse(local_6c,0,local_ec);
      D3DXMatrixTranspose(local_6c,local_6c);
      D3DXPlaneTransform(&local_28,&local_28,local_6c);
      (**(code **)(*piVar2 + 0xe4))(piVar2,0x98,1);
      (**(code **)(*piVar2 + 0xdc))(piVar2,0,&local_28);
      piVar1 = *(int **)(DAT_01725204 + 0x128);
      (**(code **)(*piVar1 + 0x14))(piVar1,local_8,0);
      if (*(char *)(param_1 + 0xea) == '\0') {
        (**(code **)(*piVar2 + 0xac))(piVar2,0,0,3,0xff000000,0x3f800000,0);
      }
      else {
        (**(code **)(*piVar2 + 0xac))(piVar2,0,0,3,0xffffffff,0x3f800000);
      }
      iVar3 = DAT_017251ac;
      *(undefined1 *)(*(int *)(*(int *)(DAT_017251ac + 0x1a4) + 0xf0) + 0x2ba8) = 1;
      (**(code **)(**(int **)(*(int *)(iVar3 + 0x1a4) + 0xf0) + 0xc))(param_2);
      *(undefined1 *)(*(int *)(*(int *)(DAT_017251ac + 0x1a4) + 0xf0) + 0x2ba8) = 0;
      (**(code **)(*piVar1 + 0x18))(piVar1,0xf0003);
      (**(code **)(*piVar2 + 0xe4))(piVar2,0x98,0);
      if (local_8 != (int *)0x0) {
        (**(code **)(*local_8 + 8))(local_8);
      }
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
007b8f50 : PUSH EBP
007b8f51 : MOV EBP,ESP
007b8f53 : MOV EAX,dword ptr [EBP + 0x8]
007b8f56 : SUB ESP,0xec
007b8f5c : CMP byte ptr [EAX + 0xe9],0x0
007b8f63 : PUSH EBX
007b8f64 : PUSH ESI
007b8f65 : PUSH EDI
007b8f66 : JNZ 0x007b91d6
007b8f6c : CMP byte ptr [EAX + 0xe8],0x0
007b8f73 : JNZ 0x007b91d6
007b8f79 : MOV EBX,dword ptr [0x017251ac]
007b8f7f : CMP dword ptr [EBX + 0x3fc],0x1
007b8f86 : JL 0x007b91d6
007b8f8c : MOV EDI,dword ptr [EBP + 0xc]
007b8f8f : TEST EDI,EDI
007b8f91 : JZ 0x007b91d6
007b8f97 : MOV ECX,dword ptr [EAX + 0xa4]
007b8f9d : CMP dword ptr [ECX + 0x18c],0x0
007b8fa4 : JZ 0x007b91d6
007b8faa : MOV EAX,[0x01725204]
007b8faf : MOV EDX,dword ptr [EAX + 0x178]
007b8fb5 : TEST EDX,EDX
007b8fb7 : JZ 0x007b91d6
007b8fbd : MOV EAX,dword ptr [EBX + 0x1a4]
007b8fc3 : TEST EAX,EAX
007b8fc5 : JZ 0x007b91d6
007b8fcb : CMP dword ptr [EAX + 0xf0],0x0
007b8fd2 : JZ 0x007b91d6
007b8fd8 : MOV ECX,dword ptr [ECX + 0x188]
007b8fde : MOV EAX,dword ptr [ECX]
007b8fe0 : MOV ESI,dword ptr [EAX + 0x24]
007b8fe3 : TEST ESI,ESI
007b8fe5 : JZ 0x007b91d6
007b8feb : MOV EBX,dword ptr [EBX + 0x18]
007b8fee : TEST EBX,EBX
007b8ff0 : JZ 0x007b91d6
007b8ff6 : LEA EAX,[EBP + -0x4]
007b8ff9 : PUSH EAX
007b8ffa : MOV dword ptr [EBP + -0x4],0x0
007b9001 : MOV ECX,dword ptr [EDX]
007b9003 : MOV ECX,dword ptr [ECX + 0x48]
007b9006 : PUSH 0x0
007b9008 : PUSH EDX
007b9009 : CALL ECX
007b900b : TEST EAX,EAX
007b900d : JL 0x007b91d6
007b9013 : CALL 0x00771f70
007b9018 : MOVSS XMM1,dword ptr [0x00cdf0d0]
007b9020 : LEA EDX,[EBP + -0x10]
007b9023 : PUSH EDX
007b9024 : MOV EAX,EDX
007b9026 : MOVSS dword ptr [EBP + -0x14],XMM0
007b902b : XORPS XMM0,XMM0
007b902e : PUSH EAX
007b902f : MOVSS dword ptr [EBP + -0x10],XMM0
007b9034 : MOVSS dword ptr [EBP + -0xc],XMM1
007b9039 : MOVSS dword ptr [EBP + -0x8],XMM0
007b903e : CALL 0x004ff722
007b9043 : MOVSS XMM0,dword ptr [EBP + -0x10]
007b9048 : MOV EDX,dword ptr [EDI]
007b904a : MOV EAX,dword ptr [EDX + 0x1c]
007b904d : MOVSS dword ptr [EBP + -0x24],XMM0
007b9052 : MOVSS XMM0,dword ptr [EBP + -0xc]
007b9057 : MOVSS dword ptr [EBP + -0x20],XMM0
007b905c : MOVSS XMM0,dword ptr [EBP + -0x8]
007b9061 : MOVSS dword ptr [EBP + -0x1c],XMM0
007b9066 : MOVSS XMM0,dword ptr [EBP + -0x14]
007b906b : ADDSS XMM0,dword ptr [0x00cdf144]
007b9073 : MOV ECX,EDI
007b9075 : MOVSS dword ptr [EBP + -0x18],XMM0
007b907a : CALL EAX
007b907c : MOV ESI,EDI
007b907e : CALL 0x007f1710
007b9083 : PUSH EAX
007b9084 : ADD EDI,0xb4
007b908a : PUSH EDI
007b908b : LEA ECX,[EBP + 0xffffff58]
007b9091 : PUSH ECX
007b9092 : CALL 0x004ff752
007b9097 : XORPS XMM0,XMM0
007b909a : LEA EDX,[EBP + 0xffffff18]
007b90a0 : PUSH EDX
007b90a1 : PUSH 0x0
007b90a3 : LEA EAX,[EBP + -0x68]
007b90a6 : MOV ECX,0x10
007b90ab : LEA ESI,[EBP + 0xffffff58]
007b90b1 : LEA EDI,[EBP + 0xffffff18]
007b90b7 : PUSH EAX
007b90b8 : MOVSD.REP ES:EDI,ESI
007b90ba : MOVSS dword ptr [EBP + -0x68],XMM0
007b90bf : CALL 0x004ff73a
007b90c4 : LEA ECX,[EBP + -0x68]
007b90c7 : PUSH ECX
007b90c8 : MOV EDX,ECX
007b90ca : PUSH EDX
007b90cb : CALL 0x00664cb4
007b90d0 : LEA EAX,[EBP + -0x68]
007b90d3 : PUSH EAX
007b90d4 : LEA ECX,[EBP + -0x24]
007b90d7 : PUSH ECX
007b90d8 : MOV EDX,ECX
007b90da : PUSH EDX
007b90db : CALL 0x00664cba
007b90e0 : MOV EAX,dword ptr [EBX]
007b90e2 : MOV ECX,dword ptr [EAX + 0xe4]
007b90e8 : PUSH 0x1
007b90ea : PUSH 0x98
007b90ef : PUSH EBX
007b90f0 : CALL ECX
007b90f2 : MOV EDX,dword ptr [EBX]
007b90f4 : MOV ECX,dword ptr [EDX + 0xdc]
007b90fa : LEA EAX,[EBP + -0x24]
007b90fd : PUSH EAX
007b90fe : PUSH 0x0
007b9100 : PUSH EBX
007b9101 : CALL ECX
007b9103 : MOV EDX,dword ptr [0x01725204]
007b9109 : MOV ESI,dword ptr [EDX + 0x128]
007b910f : MOV ECX,dword ptr [EBP + -0x4]
007b9112 : MOV EAX,dword ptr [ESI]
007b9114 : MOV EDX,dword ptr [EAX + 0x14]
007b9117 : PUSH 0x0
007b9119 : PUSH ECX
007b911a : PUSH ESI
007b911b : CALL EDX
007b911d : MOV EAX,dword ptr [EBP + 0x8]
007b9120 : PUSH 0x0
007b9122 : CMP byte ptr [EAX + 0xea],0x0
007b9129 : FLD1
007b912b : JZ 0x007b9146
007b912d : MOV ECX,dword ptr [EBX]
007b912f : MOV EDX,dword ptr [ECX + 0xac]
007b9135 : PUSH ECX
007b9136 : FSTP float ptr [ESP]
007b9139 : PUSH -0x1
007b913b : PUSH 0x3
007b913d : PUSH 0x0
007b913f : PUSH 0x0
007b9141 : PUSH EBX
007b9142 : CALL EDX
007b9144 : JMP 0x007b9160
007b9146 : MOV EAX,dword ptr [EBX]
007b9148 : PUSH ECX
007b9149 : MOV ECX,dword ptr [EAX + 0xac]
007b914f : FSTP float ptr [ESP]
007b9152 : PUSH 0xff000000
007b9157 : PUSH 0x3
007b9159 : PUSH 0x0
007b915b : PUSH 0x0
007b915d : PUSH EBX
007b915e : CALL ECX
007b9160 : MOV EAX,[0x017251ac]
007b9165 : MOV EDX,dword ptr [EAX + 0x1a4]
007b916b : MOV ECX,dword ptr [EDX + 0xf0]
007b9171 : MOV byte ptr [ECX + 0x2ba8],0x1
007b9178 : MOV EDX,dword ptr [EAX + 0x1a4]
007b917e : MOV ECX,dword ptr [EDX + 0xf0]
007b9184 : MOV EAX,dword ptr [ECX]
007b9186 : MOV EDX,dword ptr [EBP + 0xc]
007b9189 : MOV EAX,dword ptr [EAX + 0xc]
007b918c : PUSH EDX
007b918d : CALL EAX
007b918f : MOV ECX,dword ptr [0x017251ac]
007b9195 : MOV EDX,dword ptr [ECX + 0x1a4]
007b919b : MOV EAX,dword ptr [EDX + 0xf0]
007b91a1 : MOV byte ptr [EAX + 0x2ba8],0x0
007b91a8 : MOV ECX,dword ptr [ESI]
007b91aa : MOV EDX,dword ptr [ECX + 0x18]
007b91ad : PUSH 0xf0003
007b91b2 : PUSH ESI
007b91b3 : CALL EDX
007b91b5 : MOV EAX,dword ptr [EBX]
007b91b7 : MOV ECX,dword ptr [EAX + 0xe4]
007b91bd : PUSH 0x0
007b91bf : PUSH 0x98
007b91c4 : PUSH EBX
007b91c5 : CALL ECX
007b91c7 : MOV EAX,dword ptr [EBP + -0x4]
007b91ca : TEST EAX,EAX
007b91cc : JZ 0x007b91d6
007b91ce : MOV EDX,dword ptr [EAX]
007b91d0 : PUSH EAX
007b91d1 : MOV EAX,dword ptr [EDX + 0x8]
007b91d4 : CALL EAX
007b91d6 : POP EDI
007b91d7 : POP ESI
007b91d8 : POP EBX
007b91d9 : MOV ESP,EBP
007b91db : POP EBP
007b91dc : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : ___init_monetary
ENTRY    : 006550f2
BODY     : [[006550f2, 006553b7]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    ___init_monetary
   
   Library: Visual Studio 2008 Release */

int __cdecl ___init_monetary(threadlocinfo *_LocInfo)

{
  char *pcVar1;
  char cVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  int iVar15;
  int iVar16;
  char *pcVar17;
  uint *puVar18;
  LONG LVar19;
  int iVar20;
  undefined **_Memory;
  LPCWSTR _LocaleName;
  char *pcVar21;
  undefined **ppuVar22;
  undefined **ppuVar23;
  localeinfo_struct local_14;
  wchar_t *local_c;
  undefined4 *local_8;
  
  local_8 = (undefined4 *)0x0;
  local_14.locinfo = _LocInfo;
  local_14.mbcinfo = (pthreadmbcinfo)0x0;
  if ((_LocInfo->lc_category[0].refcount == (int *)0x0) &&
     (_LocInfo->lc_category[0].wrefcount == (int *)0x0)) {
    local_8 = (undefined4 *)0x0;
    local_c = (wchar_t *)0x0;
    _Memory = &PTR_DAT_00d67024;
LAB_0065535b:
    if ((LONG *)_LocInfo[1].refcount != (LONG *)0x0) {
      InterlockedDecrement((LONG *)_LocInfo[1].refcount);
    }
    if ((_LocInfo->locale_name[4] != (wchar_t *)0x0) &&
       (LVar19 = InterlockedDecrement((LONG *)_LocInfo->locale_name[4]), LVar19 == 0)) {
      _free((void *)_LocInfo[1].lc_codepage);
      _free(_LocInfo->locale_name[4]);
    }
    _LocInfo[1].refcount = (int)local_8;
    _LocInfo->locale_name[4] = local_c;
    _LocInfo[1].lc_codepage = (uint)_Memory;
    iVar20 = 0;
  }
  else {
    _Memory = __calloc_crt(1,0x30);
    if (_Memory != (undefined **)0x0) {
      local_c = __malloc_crt(4);
      if (local_c == (wchar_t *)0x0) {
        _free(_Memory);
      }
      else {
        local_c[0] = L'\0';
        local_c[1] = L'\0';
        if (_LocInfo->lc_category[0].refcount == (int *)0x0) {
          ppuVar22 = &PTR_DAT_00d67024;
          ppuVar23 = _Memory;
          for (iVar20 = 0xc; iVar20 != 0; iVar20 = iVar20 + -1) {
            *ppuVar23 = *ppuVar22;
            ppuVar22 = ppuVar22 + 1;
            ppuVar23 = ppuVar23 + 1;
          }
LAB_00655326:
          puVar18 = &_LocInfo[1].lc_codepage;
          *_Memory = *(undefined **)*puVar18;
          _Memory[1] = *(undefined **)(*puVar18 + 4);
          _Memory[2] = *(undefined **)(*puVar18 + 8);
          local_c[0] = L'\x01';
          local_c[1] = L'\0';
          if (local_8 != (undefined4 *)0x0) {
            *local_8 = 1;
          }
          goto LAB_0065535b;
        }
        local_8 = __malloc_crt(4);
        if (local_8 == (undefined4 *)0x0) {
          _free(_Memory);
          _free(local_c);
        }
        else {
          *local_8 = 0;
          _LocaleName = (LPCWSTR)(uint)*(ushort *)&_LocInfo->lc_category[2].refcount;
          iVar20 = ___getlocaleinfo(&local_14,1,_LocaleName,0x15,_Memory + 3);
          iVar3 = ___getlocaleinfo(&local_14,1,_LocaleName,0x14,_Memory + 4);
          iVar4 = ___getlocaleinfo(&local_14,1,_LocaleName,0x16,_Memory + 5);
          iVar5 = ___getlocaleinfo(&local_14,1,_LocaleName,0x17,_Memory + 6);
          iVar6 = ___getlocaleinfo(&local_14,1,_LocaleName,0x18,_Memory + 7);
          iVar7 = ___getlocaleinfo(&local_14,1,_LocaleName,0x50,_Memory + 8);
          iVar8 = ___getlocaleinfo(&local_14,1,_LocaleName,0x51,_Memory + 9);
          iVar9 = ___getlocaleinfo(&local_14,0,_LocaleName,0x1a,_Memory + 10);
          iVar10 = ___getlocaleinfo(&local_14,0,_LocaleName,0x19,(void *)((int)_Memory + 0x29));
          iVar11 = ___getlocaleinfo(&local_14,0,_LocaleName,0x54,(void *)((int)_Memory + 0x2a));
          iVar12 = ___getlocaleinfo(&local_14,0,_LocaleName,0x55,(void *)((int)_Memory + 0x2b));
          iVar13 = ___getlocaleinfo(&local_14,0,_LocaleName,0x56,_Memory + 0xb);
          iVar14 = ___getlocaleinfo(&local_14,0,_LocaleName,0x57,(void *)((int)_Memory + 0x2d));
          iVar15 = ___getlocaleinfo(&local_14,0,_LocaleName,0x52,(void *)((int)_Memory + 0x2e));
          iVar16 = ___getlocaleinfo(&local_14,0,_LocaleName,0x53,(void *)((int)_Memory + 0x2f));
          if (iVar16 == 0 &&
              (((((((((((((iVar20 == 0 && iVar3 == 0) && iVar4 == 0) && iVar5 == 0) && iVar6 == 0)
                      && iVar7 == 0) && iVar8 == 0) && iVar9 == 0) && iVar10 == 0) && iVar11 == 0)
                 && iVar12 == 0) && iVar13 == 0) && iVar14 == 0) && iVar15 == 0)) {
            pcVar17 = _Memory[7];
            while (*pcVar17 != '\0') {
              cVar2 = *pcVar17;
              if ((cVar2 < '0') || ('9' < cVar2)) {
                pcVar21 = pcVar17;
                if (cVar2 != ';') goto LAB_006552fb;
                do {
                  pcVar1 = pcVar21 + 1;
                  *pcVar21 = *pcVar1;
                  pcVar21 = pcVar1;
                } while (*pcVar1 != '\0');
              }
              else {
                *pcVar17 = cVar2 + -0x30;
LAB_006552fb:
                pcVar17 = pcVar17 + 1;
              }
            }
            goto LAB_00655326;
          }
          ___free_lconv_mon(_Memory);
          _free(_Memory);
          _free(local_c);
          _free(local_8);
        }
      }
    }
    iVar20 = 1;
  }
  return iVar20;
}



============================================================
DISASSEMBLY
============================================================
006550f2 : MOV EDI,EDI
006550f4 : PUSH EBP
006550f5 : MOV EBP,ESP
006550f7 : SUB ESP,0x10
006550fa : PUSH EBX
006550fb : PUSH ESI
006550fc : MOV ESI,dword ptr [EBP + 0x8]
006550ff : PUSH EDI
00655100 : XOR EDI,EDI
00655102 : MOV dword ptr [EBP + -0x4],EDI
00655105 : MOV dword ptr [EBP + -0x10],ESI
00655108 : MOV dword ptr [EBP + -0xc],EDI
0065510b : CMP dword ptr [ESI + 0x18],EDI
0065510e : JNZ 0x00655125
00655110 : CMP dword ptr [ESI + 0x1c],EDI
00655113 : JNZ 0x00655125
00655115 : MOV dword ptr [EBP + -0x4],EDI
00655118 : MOV dword ptr [EBP + -0x8],EDI
0065511b : MOV EBX,0xd67024
00655120 : JMP 0x0065535b
00655125 : PUSH 0x30
00655127 : PUSH 0x1
00655129 : CALL 0x006425a4
0065512e : MOV EBX,EAX
00655130 : POP ECX
00655131 : POP ECX
00655132 : CMP EBX,EDI
00655134 : JNZ 0x0065513e
00655136 : XOR EAX,EAX
00655138 : INC EAX
00655139 : JMP 0x006553b3
0065513e : PUSH 0x4
00655140 : CALL 0x0064255f
00655145 : POP ECX
00655146 : MOV dword ptr [EBP + -0x8],EAX
00655149 : CMP EAX,EDI
0065514b : JNZ 0x00655156
0065514d : PUSH EBX
0065514e : CALL 0x0063610d
00655153 : POP ECX
00655154 : JMP 0x00655136
00655156 : MOV dword ptr [EAX],EDI
00655158 : CMP dword ptr [ESI + 0x18],EDI
0065515b : JZ 0x0065531a
00655161 : PUSH 0x4
00655163 : CALL 0x0064255f
00655168 : POP ECX
00655169 : MOV dword ptr [EBP + -0x4],EAX
0065516c : CMP EAX,EDI
0065516e : JNZ 0x00655181
00655170 : PUSH EBX
00655171 : CALL 0x0063610d
00655176 : PUSH dword ptr [EBP + -0x8]
00655179 : CALL 0x0063610d
0065517e : POP ECX
0065517f : JMP 0x00655153
00655181 : MOV dword ptr [EAX],EDI
00655183 : MOVZX ESI,word ptr [ESI + 0x38]
00655187 : LEA EAX,[EBX + 0xc]
0065518a : PUSH EAX
0065518b : PUSH 0x15
0065518d : PUSH ESI
0065518e : LEA EAX,[EBP + -0x10]
00655191 : PUSH 0x1
00655193 : PUSH EAX
00655194 : CALL 0x00645c3a
00655199 : MOV EDI,EAX
0065519b : LEA EAX,[EBX + 0x10]
0065519e : PUSH EAX
0065519f : PUSH 0x14
006551a1 : PUSH ESI
006551a2 : LEA EAX,[EBP + -0x10]
006551a5 : PUSH 0x1
006551a7 : PUSH EAX
006551a8 : CALL 0x00645c3a
006551ad : OR EDI,EAX
006551af : LEA EAX,[EBX + 0x14]
006551b2 : PUSH EAX
006551b3 : PUSH 0x16
006551b5 : PUSH ESI
006551b6 : LEA EAX,[EBP + -0x10]
006551b9 : PUSH 0x1
006551bb : PUSH EAX
006551bc : CALL 0x00645c3a
006551c1 : OR EDI,EAX
006551c3 : LEA EAX,[EBX + 0x18]
006551c6 : PUSH EAX
006551c7 : PUSH 0x17
006551c9 : PUSH ESI
006551ca : LEA EAX,[EBP + -0x10]
006551cd : PUSH 0x1
006551cf : PUSH EAX
006551d0 : CALL 0x00645c3a
006551d5 : ADD ESP,0x50
006551d8 : OR EDI,EAX
006551da : LEA EAX,[EBX + 0x1c]
006551dd : PUSH EAX
006551de : PUSH 0x18
006551e0 : PUSH ESI
006551e1 : LEA EAX,[EBP + -0x10]
006551e4 : PUSH 0x1
006551e6 : PUSH EAX
006551e7 : CALL 0x00645c3a
006551ec : OR EDI,EAX
006551ee : LEA EAX,[EBX + 0x20]
006551f1 : PUSH EAX
006551f2 : PUSH 0x50
006551f4 : PUSH ESI
006551f5 : LEA EAX,[EBP + -0x10]
006551f8 : PUSH 0x1
006551fa : PUSH EAX
006551fb : CALL 0x00645c3a
00655200 : OR EDI,EAX
00655202 : LEA EAX,[EBX + 0x24]
00655205 : PUSH EAX
00655206 : PUSH 0x51
00655208 : PUSH ESI
00655209 : LEA EAX,[EBP + -0x10]
0065520c : PUSH 0x1
0065520e : PUSH EAX
0065520f : CALL 0x00645c3a
00655214 : OR EDI,EAX
00655216 : LEA EAX,[EBX + 0x28]
00655219 : PUSH EAX
0065521a : PUSH 0x1a
0065521c : PUSH ESI
0065521d : LEA EAX,[EBP + -0x10]
00655220 : PUSH 0x0
00655222 : PUSH EAX
00655223 : CALL 0x00645c3a
00655228 : ADD ESP,0x50
0065522b : OR EDI,EAX
0065522d : LEA EAX,[EBX + 0x29]
00655230 : PUSH EAX
00655231 : PUSH 0x19
00655233 : PUSH ESI
00655234 : PUSH 0x0
00655236 : LEA EAX,[EBP + -0x10]
00655239 : PUSH EAX
0065523a : CALL 0x00645c3a
0065523f : OR EDI,EAX
00655241 : LEA EAX,[EBX + 0x2a]
00655244 : PUSH EAX
00655245 : PUSH 0x54
00655247 : PUSH ESI
00655248 : LEA EAX,[EBP + -0x10]
0065524b : PUSH 0x0
0065524d : PUSH EAX
0065524e : CALL 0x00645c3a
00655253 : OR EDI,EAX
00655255 : LEA EAX,[EBX + 0x2b]
00655258 : PUSH EAX
00655259 : PUSH 0x55
0065525b : PUSH ESI
0065525c : LEA EAX,[EBP + -0x10]
0065525f : PUSH 0x0
00655261 : PUSH EAX
00655262 : CALL 0x00645c3a
00655267 : OR EDI,EAX
00655269 : LEA EAX,[EBX + 0x2c]
0065526c : PUSH EAX
0065526d : PUSH 0x56
0065526f : PUSH ESI
00655270 : LEA EAX,[EBP + -0x10]
00655273 : PUSH 0x0
00655275 : PUSH EAX
00655276 : CALL 0x00645c3a
0065527b : ADD ESP,0x50
0065527e : OR EDI,EAX
00655280 : LEA EAX,[EBX + 0x2d]
00655283 : PUSH EAX
00655284 : PUSH 0x57
00655286 : PUSH ESI
00655287 : LEA EAX,[EBP + -0x10]
0065528a : PUSH 0x0
0065528c : PUSH EAX
0065528d : CALL 0x00645c3a
00655292 : OR EDI,EAX
00655294 : LEA EAX,[EBX + 0x2e]
00655297 : PUSH EAX
00655298 : PUSH 0x52
0065529a : PUSH ESI
0065529b : LEA EAX,[EBP + -0x10]
0065529e : PUSH 0x0
006552a0 : PUSH EAX
006552a1 : CALL 0x00645c3a
006552a6 : OR EDI,EAX
006552a8 : LEA EAX,[EBX + 0x2f]
006552ab : PUSH EAX
006552ac : PUSH 0x53
006552ae : PUSH ESI
006552af : LEA EAX,[EBP + -0x10]
006552b2 : PUSH 0x0
006552b4 : PUSH EAX
006552b5 : CALL 0x00645c3a
006552ba : ADD ESP,0x3c
006552bd : OR EAX,EDI
006552bf : JZ 0x006552e5
006552c1 : PUSH EBX
006552c2 : CALL 0x00655064
006552c7 : PUSH EBX
006552c8 : CALL 0x0063610d
006552cd : PUSH dword ptr [EBP + -0x8]
006552d0 : CALL 0x0063610d
006552d5 : PUSH dword ptr [EBP + -0x4]
006552d8 : CALL 0x0063610d
006552dd : ADD ESP,0x10
006552e0 : JMP 0x00655136
006552e5 : MOV EAX,dword ptr [EBX + 0x1c]
006552e8 : JMP 0x006552fc
006552ea : MOV CL,byte ptr [EAX]
006552ec : CMP CL,0x30
006552ef : JL 0x00655303
006552f1 : CMP CL,0x39
006552f4 : JG 0x00655303
006552f6 : SUB CL,0x30
006552f9 : MOV byte ptr [EAX],CL
006552fb : INC EAX
006552fc : CMP byte ptr [EAX],0x0
006552ff : JNZ 0x006552ea
00655301 : JMP 0x00655326
00655303 : CMP CL,0x3b
00655306 : JNZ 0x006552fb
00655308 : MOV ESI,EAX
0065530a : LEA EDI,[ESI + 0x1]
0065530d : MOV CL,byte ptr [EDI]
0065530f : MOV byte ptr [ESI],CL
00655311 : MOV ESI,EDI
00655313 : CMP byte ptr [ESI],0x0
00655316 : JNZ 0x0065530a
00655318 : JMP 0x006552fc
0065531a : PUSH 0xc
0065531c : POP ECX
0065531d : MOV ESI,0xd67024
00655322 : MOV EDI,EBX
00655324 : MOVSD.REP ES:EDI,ESI
00655326 : MOV EAX,dword ptr [EBP + 0x8]
00655329 : MOV ESI,dword ptr [EBP + 0x8]
0065532c : ADD EAX,0xbc
00655331 : MOV ECX,dword ptr [EAX]
00655333 : MOV ECX,dword ptr [ECX]
00655335 : MOV dword ptr [EBX],ECX
00655337 : MOV ECX,dword ptr [EAX]
00655339 : MOV ECX,dword ptr [ECX + 0x4]
0065533c : MOV dword ptr [EBX + 0x4],ECX
0065533f : MOV EAX,dword ptr [EAX]
00655341 : MOV EAX,dword ptr [EAX + 0x8]
00655344 : MOV ECX,dword ptr [EBP + -0x8]
00655347 : MOV dword ptr [EBX + 0x8],EAX
0065534a : XOR EAX,EAX
0065534c : INC EAX
0065534d : XOR EDI,EDI
0065534f : MOV dword ptr [ECX],EAX
00655351 : CMP dword ptr [EBP + -0x4],EDI
00655354 : JZ 0x0065535b
00655356 : MOV ECX,dword ptr [EBP + -0x4]
00655359 : MOV dword ptr [ECX],EAX
0065535b : MOV EAX,dword ptr [ESI + 0xb8]
00655361 : CMP EAX,EDI
00655363 : JZ 0x0065536c
00655365 : PUSH EAX
00655366 : CALL dword ptr [0x00b851b0]
0065536c : MOV EAX,dword ptr [ESI + 0xb0]
00655372 : CMP EAX,EDI
00655374 : JZ 0x00655399
00655376 : PUSH EAX
00655377 : CALL dword ptr [0x00b851b0]
0065537d : TEST EAX,EAX
0065537f : JNZ 0x00655399
00655381 : PUSH dword ptr [ESI + 0xbc]
00655387 : CALL 0x0063610d
0065538c : PUSH dword ptr [ESI + 0xb0]
00655392 : CALL 0x0063610d
00655397 : POP ECX
00655398 : POP ECX
00655399 : MOV EAX,dword ptr [EBP + -0x4]
0065539c : MOV dword ptr [ESI + 0xb8],EAX
006553a2 : MOV EAX,dword ptr [EBP + -0x8]
006553a5 : MOV dword ptr [ESI + 0xb0],EAX
006553ab : MOV dword ptr [ESI + 0xbc],EBX
006553b1 : XOR EAX,EAX
006553b3 : POP EDI
006553b4 : POP ESI
006553b5 : POP EBX
006553b6 : LEAVE
006553b7 : RET

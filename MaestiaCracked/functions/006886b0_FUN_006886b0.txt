PROGRAM  : Maestia.exe
FUNCTION : FUN_006886b0
ENTRY    : 006886b0
BODY     : [[006886b0, 0068876d]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006886b0(int param_1,int param_2,undefined4 param_3)

{
  bool bVar1;
  int iVar2;
  int iVar3;
  undefined4 local_4;
  
  iVar3 = *(int *)(param_2 + 0x48);
  iVar2 = 0;
  if (iVar3 != 0x62697473) {
    local_4 = 0;
    bVar1 = false;
    if (iVar3 == 0x6f75746c) {
      local_4 = *(undefined4 *)(param_1 + 0x9c);
      iVar3 = *(int *)(param_1 + 0xa4);
    }
    else {
      iVar3 = FUN_00686cd0(param_1,iVar3,&local_4);
    }
    iVar2 = 7;
    if (iVar3 != 0) {
      while (iVar2 = (**(code **)(iVar3 + 0x44))(iVar3,param_2,param_3,0), iVar2 != 0) {
        if ((char)iVar2 != '\x13') {
          return iVar2;
        }
        iVar3 = FUN_00686cd0(param_1,*(undefined4 *)(param_2 + 0x48),&local_4);
        bVar1 = true;
        if (iVar3 == 0) {
          return iVar2;
        }
      }
      iVar2 = 0;
      if (bVar1) {
        FUN_00688610(param_1,iVar3,0,0);
      }
    }
  }
  return iVar2;
}



============================================================
DISASSEMBLY
============================================================
006886b0 : PUSH ECX
006886b1 : PUSH EDI
006886b2 : MOV EDI,dword ptr [ESP + 0x10]
006886b6 : MOV ECX,dword ptr [EDI + 0x48]
006886b9 : XOR EAX,EAX
006886bb : CMP ECX,0x62697473
006886c1 : JZ 0x0068876b
006886c7 : PUSH EBP
006886c8 : MOV EBP,dword ptr [ESP + 0x10]
006886cc : PUSH ESI
006886cd : MOV dword ptr [ESP + 0xc],EAX
006886d1 : MOV byte ptr [ESP + 0x18],AL
006886d5 : CMP ECX,0x6f75746c
006886db : JNZ 0x006886ef
006886dd : MOV EAX,dword ptr [EBP + 0x9c]
006886e3 : MOV ESI,dword ptr [EBP + 0xa4]
006886e9 : MOV dword ptr [ESP + 0xc],EAX
006886ed : JMP 0x00688700
006886ef : LEA EDX,[ESP + 0xc]
006886f3 : PUSH EDX
006886f4 : PUSH ECX
006886f5 : PUSH EBP
006886f6 : CALL 0x00686cd0
006886fb : ADD ESP,0xc
006886fe : MOV ESI,EAX
00688700 : MOV EAX,0x7
00688705 : TEST ESI,ESI
00688707 : JZ 0x00688769
00688709 : PUSH EBX
0068870a : LEA EBX,[EBX]
00688710 : MOV EAX,dword ptr [ESP + 0x20]
00688714 : MOV ECX,dword ptr [ESI + 0x44]
00688717 : PUSH 0x0
00688719 : PUSH EAX
0068871a : PUSH EDI
0068871b : PUSH ESI
0068871c : CALL ECX
0068871e : MOV EBX,EAX
00688720 : ADD ESP,0x10
00688723 : TEST EBX,EBX
00688725 : JZ 0x00688751
00688727 : CMP BL,0x13
0068872a : JNZ 0x00688766
0068872c : MOV EAX,dword ptr [EDI + 0x48]
0068872f : LEA EDX,[ESP + 0x10]
00688733 : PUSH EDX
00688734 : PUSH EAX
00688735 : PUSH EBP
00688736 : CALL 0x00686cd0
0068873b : MOV ESI,EAX
0068873d : ADD ESP,0xc
00688740 : MOV byte ptr [ESP + 0x1c],0x1
00688745 : TEST ESI,ESI
00688747 : JNZ 0x00688710
00688749 : MOV EAX,EBX
0068874b : POP EBX
0068874c : POP ESI
0068874d : POP EBP
0068874e : POP EDI
0068874f : POP ECX
00688750 : RET
00688751 : CMP byte ptr [ESP + 0x1c],0x0
00688756 : JZ 0x00688766
00688758 : PUSH 0x0
0068875a : PUSH 0x0
0068875c : PUSH ESI
0068875d : PUSH EBP
0068875e : CALL 0x00688610
00688763 : ADD ESP,0x10
00688766 : MOV EAX,EBX
00688768 : POP EBX
00688769 : POP ESI
0068876a : POP EBP
0068876b : POP EDI
0068876c : POP ECX
0068876d : RET

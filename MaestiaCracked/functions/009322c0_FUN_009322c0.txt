PROGRAM  : Maestia.exe
FUNCTION : FUN_009322c0
ENTRY    : 009322c0
BODY     : [[009322c0, 00932657]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009322c0(uint param_1,int param_2)

{
  uint uVar1;
  int iVar2;
  void **ppvVar3;
  ushort uVar4;
  uint uVar5;
  int iVar6;
  undefined4 uVar7;
  int iVar8;
  uint in_ECX;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  iVar2 = param_1;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b63c16;
  local_10 = ExceptionList;
  uVar5 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  if (*(char *)(param_1 + 8) == '\0') {
    return;
  }
  if (0x1d < (int)in_ECX) {
    param_2 = *(int *)(*(int *)(param_1 + 4) + 0x128);
    if (param_2 == 0) {
      return;
    }
    uVar1 = in_ECX - 0x1e;
    if (1 < uVar1) {
      return;
    }
    iVar8 = *(int *)(*(int *)(param_1 + 0x68 + uVar1 * 4) + 8);
    iVar6 = 0;
    ExceptionList = &local_10;
    if (iVar8 != 0) {
      iVar6 = FUN_009e81c0(iVar8);
    }
    ppvVar3 = ExceptionList;
    if (*(int *)(param_2 + 0x40) != 0x80) {
      if (*(int *)(param_2 + 0x40) != -1) {
        iVar6 = FUN_008eb580();
        iVar8 = param_2;
        if (iVar6 == 0) {
          ExceptionList = local_10;
          return;
        }
        iVar6 = FUN_009300c0(uVar1);
        if (iVar6 == 0) {
          FUN_00404750(L"IDS_ERROR_INVALID_AUTOUSEPOTION%d",uVar1);
          local_8 = 0;
          FUN_009adfc0(*(undefined4 *)(*DAT_00da9894 + 0x1a8),3);
          local_8 = 0xffffffff;
          FUN_00406560();
          FUN_0097fa60();
          ExceptionList = local_10;
          return;
        }
        if (*(int *)(iVar8 + 0x4c) == 0) {
          uVar7 = 0;
        }
        else {
          uVar7 = *(undefined4 *)(*(int *)(iVar8 + 0x4c) + 0x10);
        }
        *(undefined4 *)(*(int *)(iVar2 + 0x70) + 0xb + uVar1 * 4) = uVar7;
        *(undefined1 *)(*(int *)(iVar2 + 0x70) + 8 + uVar1) = 1;
        FUN_008a1050(0x46);
        FUN_00931110(iVar2);
        FUN_0097fa60();
        ExceptionList = local_10;
        return;
      }
      if (iVar6 != 0) {
        FUN_0097fb30(iVar6,in_ECX,0);
        *(bool *)(*(int *)(iVar2 + 0x70) + 8 + uVar1) =
             *(char *)(*(int *)(iVar2 + 0x70) + 8 + uVar1) == '\0';
        if (*(char *)(*(int *)(iVar2 + 0x70) + 8 + uVar1) == '\0') {
          FUN_008a1050(0x47);
          FUN_00931110(iVar2);
          ExceptionList = local_10;
          return;
        }
        FUN_008a1050(0x46);
        FUN_00931110(iVar2);
        ExceptionList = local_10;
        return;
      }
      if (*(char *)(param_2 + 0x58) == '\0') {
        *(bool *)(*(int *)(iVar2 + 0x70) + 8 + uVar1) =
             *(char *)(*(int *)(iVar2 + 0x70) + 8 + uVar1) == '\0';
        if (*(char *)(*(int *)(iVar2 + 0x70) + 8 + uVar1) == '\0') {
          uVar7 = 0x47;
        }
        else {
          uVar7 = 0x46;
        }
        FUN_008a1050(uVar7);
        FUN_00931110(iVar2);
        *(undefined1 *)(param_2 + 0x58) = 1;
        ExceptionList = local_10;
        return;
      }
    }
LAB_0093251b:
    ExceptionList = ppvVar3;
    FUN_0097fa60(uVar5);
    ExceptionList = local_10;
    return;
  }
  if (*(char *)(param_1 + 0x60) != '\0') {
    ppvVar3 = &local_10;
    if (*(int *)(*(int *)(*DAT_00da9894 + 0x128) + 0x4c) == 0) {
      return;
    }
    goto LAB_0093251b;
  }
  ExceptionList = &local_10;
  if (in_ECX == 0xffffffff) {
    iVar8 = 0;
    if (*(int *)(*DAT_00da9894 + 300) != 0) {
      iVar8 = *(int *)(*(int *)(*DAT_00da9894 + 300) + 0xc);
    }
    if (*(int *)(iVar8 + 0x48) != 0) {
      in_ECX = FUN_0092e970(*(int *)(iVar8 + 0x48));
      if (in_ECX == 0xffffffff) {
        FUN_0092ff80(&param_1,&local_14);
        iVar8 = param_1;
        if (param_1 == -1) {
          ExceptionList = local_10;
          return;
        }
        if (local_14 == 0xffffffff) {
          ExceptionList = local_10;
          return;
        }
        FUN_0092fd40();
        in_ECX = local_14 + iVar8 * 10;
      }
      goto LAB_00932598;
    }
  }
  else {
LAB_00932598:
    if (9 < (int)in_ECX) goto LAB_009325d7;
  }
  if ((char)param_2 == '\0') {
    iVar8 = 0;
    if (*(int *)(*DAT_00da9894 + 300) != 0) {
      iVar8 = *(int *)(*(int *)(*DAT_00da9894 + 300) + 0xc);
    }
    if (((*(int *)(iVar8 + 0x48) != 0) &&
        (uVar4 = *(ushort *)(*(int *)(iVar8 + 0x48) + 0x50), uVar4 != 0)) && (uVar4 < 4)) {
      in_ECX = in_ECX + (uint)uVar4 * 10;
    }
  }
LAB_009325d7:
  param_1 = (in_ECX & 0xffff) / 10;
  local_14 = (in_ECX & 0xffff) % 10;
  iVar8 = FUN_0092e480(in_ECX);
  if (iVar8 != 0) {
    uVar4 = (ushort)param_1;
    if ((uVar4 == *(ushort *)(iVar2 + 0x5c)) && ((char)param_2 == '\0')) {
      FUN_0092f850(local_14 & 0xffff);
      ExceptionList = local_10;
      return;
    }
    if ((uVar4 == 1) || (uVar4 < 4)) {
      FUN_0092e100(in_ECX);
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
009322c0 : PUSH EBP
009322c1 : MOV EBP,ESP
009322c3 : PUSH -0x1
009322c5 : PUSH 0xb63c16
009322ca : MOV EAX,FS:[0x0]
009322d0 : PUSH EAX
009322d1 : SUB ESP,0x24
009322d4 : PUSH EBX
009322d5 : PUSH ESI
009322d6 : PUSH EDI
009322d7 : MOV EAX,[0x00d66fa0]
009322dc : XOR EAX,EBP
009322de : PUSH EAX
009322df : LEA EAX,[EBP + -0xc]
009322e2 : MOV FS:[0x0],EAX
009322e8 : MOV EDI,ECX
009322ea : MOV EBX,dword ptr [EBP + 0x8]
009322ed : MOV AL,byte ptr [EBX + 0x8]
009322f0 : TEST AL,AL
009322f2 : JZ 0x00932644
009322f8 : CMP EDI,0x1e
009322fb : JL 0x009324fd
00932301 : MOV EAX,dword ptr [EBX + 0x4]
00932304 : MOV ECX,dword ptr [EAX + 0x128]
0093230a : MOV dword ptr [EBP + 0xc],ECX
0093230d : TEST ECX,ECX
0093230f : JZ 0x00932644
00932315 : LEA ESI,[EDI + -0x1e]
00932318 : CMP ESI,0x2
0093231b : JNC 0x00932644
00932321 : MOV EDX,dword ptr [EBX + ESI*0x4 + 0x68]
00932325 : MOV EDX,dword ptr [EDX + 0x8]
00932328 : XOR EAX,EAX
0093232a : TEST EDX,EDX
0093232c : JZ 0x00932337
0093232e : PUSH EDX
0093232f : CALL 0x009e81c0
00932334 : MOV ECX,dword ptr [EBP + 0xc]
00932337 : MOV EDX,dword ptr [ECX + 0x40]
0093233a : CMP EDX,0x80
00932340 : JZ 0x0093251b
00932346 : CMP EDX,-0x1
00932349 : JZ 0x00932435
0093234f : MOV EAX,dword ptr [EBX + 0x4]
00932352 : MOV EDI,EDX
00932354 : CALL 0x008eb580
00932359 : TEST EAX,EAX
0093235b : JZ 0x00932644
00932361 : MOV EDI,dword ptr [EBP + 0xc]
00932364 : MOV EAX,dword ptr [EDI + 0x4c]
00932367 : TEST EAX,EAX
00932369 : JZ 0x00932370
0093236b : MOV EAX,dword ptr [EAX + 0x10]
0093236e : JMP 0x00932372
00932370 : XOR EAX,EAX
00932372 : PUSH ESI
00932373 : CALL 0x009300c0
00932378 : ADD ESP,0x4
0093237b : TEST EAX,EAX
0093237d : JZ 0x009323ca
0093237f : MOV EAX,dword ptr [EDI + 0x4c]
00932382 : TEST EAX,EAX
00932384 : JZ 0x0093238b
00932386 : MOV EAX,dword ptr [EAX + 0x10]
00932389 : JMP 0x0093238d
0093238b : XOR EAX,EAX
0093238d : MOV ECX,dword ptr [EBX + 0x70]
00932390 : MOV dword ptr [ECX + ESI*0x4 + 0xb],EAX
00932394 : MOV EDX,dword ptr [EBX + 0x70]
00932397 : MOV ECX,dword ptr [0x017248dc]
0093239d : PUSH 0x46
0093239f : MOV byte ptr [EDX + ESI*0x1 + 0x8],0x1
009323a4 : CALL 0x008a1050
009323a9 : PUSH EBX
009323aa : CALL 0x00931110
009323af : MOV ECX,EDI
009323b1 : CALL 0x0097fa60
009323b6 : MOV ECX,dword ptr [EBP + -0xc]
009323b9 : MOV dword ptr FS:[0x0],ECX
009323c0 : POP ECX
009323c1 : POP EDI
009323c2 : POP ESI
009323c3 : POP EBX
009323c4 : MOV ESP,EBP
009323c6 : POP EBP
009323c7 : RET 0x8
009323ca : PUSH ESI
009323cb : PUSH 0xc6e028
009323d0 : LEA ESI,[EBP + -0x2c]
009323d3 : CALL 0x00404750
009323d8 : ADD ESP,0x8
009323db : MOV dword ptr [EBP + -0x4],0x0
009323e2 : CMP dword ptr [EAX + 0x18],0x8
009323e6 : JC 0x009323ed
009323e8 : MOV EAX,dword ptr [EAX + 0x4]
009323eb : JMP 0x009323f0
009323ed : ADD EAX,0x4
009323f0 : MOV ECX,dword ptr [0x00da9894]
009323f6 : MOV EDX,dword ptr [ECX]
009323f8 : MOV EDX,dword ptr [EDX + 0x1a8]
009323fe : PUSH 0x3
00932400 : PUSH EDX
00932401 : MOV ECX,EAX
00932403 : CALL 0x009adfc0
00932408 : ADD ESP,0x8
0093240b : MOV dword ptr [EBP + -0x4],0xffffffff
00932412 : LEA ECX,[EBP + -0x2c]
00932415 : CALL 0x00406560
0093241a : MOV ECX,EDI
0093241c : CALL 0x0097fa60
00932421 : MOV ECX,dword ptr [EBP + -0xc]
00932424 : MOV dword ptr FS:[0x0],ECX
0093242b : POP ECX
0093242c : POP EDI
0093242d : POP ESI
0093242e : POP EBX
0093242f : MOV ESP,EBP
00932431 : POP EBP
00932432 : RET 0x8
00932435 : TEST EAX,EAX
00932437 : JZ 0x009324aa
00932439 : PUSH 0x0
0093243b : PUSH EDI
0093243c : PUSH EAX
0093243d : MOV EAX,0x80
00932442 : CALL 0x0097fb30
00932447 : MOV EDX,dword ptr [EBX + 0x70]
0093244a : CMP byte ptr [EDX + ESI*0x1 + 0x8],0x0
0093244f : MOV ECX,EDX
00932451 : SETZ AL
00932454 : MOV byte ptr [ECX + ESI*0x1 + 0x8],AL
00932458 : MOV EDX,dword ptr [EBX + 0x70]
0093245b : CMP byte ptr [EDX + ESI*0x1 + 0x8],0x0
00932460 : MOV ECX,dword ptr [0x017248dc]
00932466 : JZ 0x00932489
00932468 : PUSH 0x46
0093246a : CALL 0x008a1050
0093246f : PUSH EBX
00932470 : CALL 0x00931110
00932475 : MOV ECX,dword ptr [EBP + -0xc]
00932478 : MOV dword ptr FS:[0x0],ECX
0093247f : POP ECX
00932480 : POP EDI
00932481 : POP ESI
00932482 : POP EBX
00932483 : MOV ESP,EBP
00932485 : POP EBP
00932486 : RET 0x8
00932489 : PUSH 0x47
0093248b : CALL 0x008a1050
00932490 : PUSH EBX
00932491 : CALL 0x00931110
00932496 : MOV ECX,dword ptr [EBP + -0xc]
00932499 : MOV dword ptr FS:[0x0],ECX
009324a0 : POP ECX
009324a1 : POP EDI
009324a2 : POP ESI
009324a3 : POP EBX
009324a4 : MOV ESP,EBP
009324a6 : POP EBP
009324a7 : RET 0x8
009324aa : CMP byte ptr [ECX + 0x58],0x0
009324ae : JNZ 0x0093251b
009324b0 : MOV EAX,dword ptr [EBX + 0x70]
009324b3 : CMP byte ptr [EAX + ESI*0x1 + 0x8],0x0
009324b8 : MOV EDX,EAX
009324ba : SETZ CL
009324bd : MOV byte ptr [EDX + ESI*0x1 + 0x8],CL
009324c1 : MOV EAX,dword ptr [EBX + 0x70]
009324c4 : CMP byte ptr [EAX + ESI*0x1 + 0x8],0x0
009324c9 : MOV ECX,dword ptr [0x017248dc]
009324cf : JZ 0x009324d5
009324d1 : PUSH 0x46
009324d3 : JMP 0x009324d7
009324d5 : PUSH 0x47
009324d7 : CALL 0x008a1050
009324dc : PUSH EBX
009324dd : CALL 0x00931110
009324e2 : MOV ECX,dword ptr [EBP + 0xc]
009324e5 : MOV byte ptr [ECX + 0x58],0x1
009324e9 : MOV ECX,dword ptr [EBP + -0xc]
009324ec : MOV dword ptr FS:[0x0],ECX
009324f3 : POP ECX
009324f4 : POP EDI
009324f5 : POP ESI
009324f6 : POP EBX
009324f7 : MOV ESP,EBP
009324f9 : POP EBP
009324fa : RET 0x8
009324fd : CMP byte ptr [EBX + 0x60],0x0
00932501 : JZ 0x00932534
00932503 : MOV EDX,dword ptr [0x00da9894]
00932509 : MOV EAX,dword ptr [EDX]
0093250b : MOV ECX,dword ptr [EAX + 0x128]
00932511 : CMP dword ptr [ECX + 0x4c],0x0
00932515 : JZ 0x00932644
0093251b : CALL 0x0097fa60
00932520 : MOV ECX,dword ptr [EBP + -0xc]
00932523 : MOV dword ptr FS:[0x0],ECX
0093252a : POP ECX
0093252b : POP EDI
0093252c : POP ESI
0093252d : POP EBX
0093252e : MOV ESP,EBP
00932530 : POP EBP
00932531 : RET 0x8
00932534 : CMP EDI,-0x1
00932537 : JNZ 0x00932598
00932539 : MOV ECX,dword ptr [0x00da9894]
0093253f : MOV EAX,dword ptr [ECX]
00932541 : MOV EAX,dword ptr [EAX + 0x12c]
00932547 : TEST EAX,EAX
00932549 : JZ 0x0093254e
0093254b : MOV EAX,dword ptr [EAX + 0xc]
0093254e : MOV EAX,dword ptr [EAX + 0x48]
00932551 : TEST EAX,EAX
00932553 : JZ 0x0093259d
00932555 : PUSH EAX
00932556 : CALL 0x0092e970
0093255b : MOV EDI,EAX
0093255d : CMP EDI,-0x1
00932560 : JNZ 0x00932598
00932562 : LEA EDX,[EBP + -0x10]
00932565 : PUSH EDX
00932566 : LEA EAX,[EBP + 0x8]
00932569 : PUSH EAX
0093256a : MOV EDI,EBX
0093256c : CALL 0x0092ff80
00932571 : MOV ESI,dword ptr [EBP + 0x8]
00932574 : CMP ESI,-0x1
00932577 : JZ 0x00932644
0093257d : MOV EDI,dword ptr [EBP + -0x10]
00932580 : CMP EDI,-0x1
00932583 : JZ 0x00932644
00932589 : MOV ECX,ESI
0093258b : MOV EAX,EBX
0093258d : CALL 0x0092fd40
00932592 : LEA ECX,[ESI + ESI*0x4]
00932595 : LEA EDI,[EDI + ECX*0x2]
00932598 : CMP EDI,0xa
0093259b : JGE 0x009325d7
0093259d : CMP byte ptr [EBP + 0xc],0x0
009325a1 : JNZ 0x009325d7
009325a3 : MOV EDX,dword ptr [0x00da9894]
009325a9 : MOV EAX,dword ptr [EDX]
009325ab : MOV EAX,dword ptr [EAX + 0x12c]
009325b1 : TEST EAX,EAX
009325b3 : JZ 0x009325b8
009325b5 : MOV EAX,dword ptr [EAX + 0xc]
009325b8 : MOV EAX,dword ptr [EAX + 0x48]
009325bb : TEST EAX,EAX
009325bd : JZ 0x009325d7
009325bf : MOVZX EAX,word ptr [EAX + 0x50]
009325c3 : TEST AX,AX
009325c6 : JBE 0x009325d7
009325c8 : CMP AX,0x4
009325cc : JNC 0x009325d7
009325ce : MOVZX EAX,AX
009325d1 : LEA EAX,[EAX + EAX*0x4]
009325d4 : LEA EDI,[EDI + EAX*0x2]
009325d7 : MOVZX EAX,DI
009325da : CDQ
009325db : MOV ECX,0xa
009325e0 : IDIV ECX
009325e2 : MOV ESI,dword ptr [0x01724884]
009325e8 : PUSH EDI
009325e9 : MOV dword ptr [EBP + -0x10],EDX
009325ec : MOVZX EDX,AX
009325ef : MOV dword ptr [EBP + 0x8],EDX
009325f2 : CALL 0x0092e480
009325f7 : TEST EAX,EAX
009325f9 : JZ 0x00932644
009325fb : MOV EAX,dword ptr [EBP + 0x8]
009325fe : CMP AX,word ptr [EBX + 0x5c]
00932602 : JNZ 0x0093262b
00932604 : CMP byte ptr [EBP + 0xc],0x0
00932608 : JNZ 0x0093262b
0093260a : MOVZX EAX,word ptr [EBP + -0x10]
0093260e : MOV ECX,dword ptr [EBX + 0x48]
00932611 : PUSH EAX
00932612 : CALL 0x0092f850
00932617 : MOV ECX,dword ptr [EBP + -0xc]
0093261a : MOV dword ptr FS:[0x0],ECX
00932621 : POP ECX
00932622 : POP EDI
00932623 : POP ESI
00932624 : POP EBX
00932625 : MOV ESP,EBP
00932627 : POP EBP
00932628 : RET 0x8
0093262b : CMP AX,0x1
0093262f : JZ 0x00932637
00932631 : CMP AX,0x4
00932635 : JNC 0x00932644
00932637 : MOVZX ECX,AX
0093263a : MOV ECX,dword ptr [EBX + ECX*0x4 + 0x48]
0093263e : PUSH EDI
0093263f : CALL 0x0092e100
00932644 : MOV ECX,dword ptr [EBP + -0xc]
00932647 : MOV dword ptr FS:[0x0],ECX
0093264e : POP ECX
0093264f : POP EDI
00932650 : POP ESI
00932651 : POP EBX
00932652 : MOV ESP,EBP
00932654 : POP EBP
00932655 : RET 0x8

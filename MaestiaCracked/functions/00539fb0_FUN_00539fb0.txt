PROGRAM  : Maestia.exe
FUNCTION : FUN_00539fb0
ENTRY    : 00539fb0
BODY     : [[00539fb0, 0053a09d]]

============================================================
DECOMPILED C CODE
============================================================

bool FUN_00539fb0(void)

{
  uint uVar1;
  undefined4 uVar2;
  int iVar3;
  int in_ECX;
  int unaff_EBX;
  int iVar4;
  
  if ((*(int *)(in_ECX + 0x30) == 0) && (*(int **)(in_ECX + 0x10) != (int *)0x0)) {
    uVar2 = (**(code **)(**(int **)(in_ECX + 0x10) + 0x10))();
    *(undefined4 *)(in_ECX + 0x34) = uVar2;
    *(undefined1 *)(in_ECX + 0x38) = 0;
  }
  uVar1 = *(uint *)(in_ECX + 0x2c);
  if (uVar1 < *(uint *)(in_ECX + 0x30)) {
    _memmove(*(void **)(in_ECX + 0x3c),(void *)((int)*(void **)(in_ECX + 0x3c) + uVar1),
             *(uint *)(in_ECX + 0x30) - uVar1);
    *(int *)(in_ECX + 0x30) = *(int *)(in_ECX + 0x30) - *(int *)(in_ECX + 0x2c);
  }
  else {
    *(undefined4 *)(in_ECX + 0x30) = 0;
  }
  *(undefined4 *)(in_ECX + 0x2c) = 0;
  if (*(int **)(in_ECX + 0x10) != (int *)0x0) {
    iVar4 = *(int *)(in_ECX + 0x40) - *(int *)(in_ECX + 0x30);
    iVar3 = (**(code **)(**(int **)(in_ECX + 0x10) + 0x28))
                      (*(int *)(in_ECX + 0x3c) + *(int *)(in_ECX + 0x30),iVar4);
    if (iVar3 < iVar4) {
      if (0 < iVar3) {
        *(int *)(in_ECX + 0x30) = *(int *)(in_ECX + 0x30) + iVar3;
        *(int *)(in_ECX + 0x34) = *(int *)(in_ECX + 0x34) + iVar3;
      }
      _memset((void *)(*(int *)(in_ECX + 0x3c) + *(int *)(in_ECX + 0x30)),0,
              *(int *)(in_ECX + 0x40) - *(int *)(in_ECX + 0x30));
      iVar3 = *(int *)(in_ECX + 0x30) - *(int *)(in_ECX + 0x2c);
      if (iVar3 < unaff_EBX) {
        *(int *)(in_ECX + 0x30) = *(int *)(in_ECX + 0x2c) + unaff_EBX;
      }
      return unaff_EBX <= iVar3;
    }
    *(int *)(in_ECX + 0x30) = *(int *)(in_ECX + 0x30) + iVar3;
    *(int *)(in_ECX + 0x34) = *(int *)(in_ECX + 0x34) + iVar3;
    return true;
  }
  *(void **)(in_ECX + 0x3c) = (void *)(in_ECX + 0x44);
  *(undefined4 *)(in_ECX + 0x40) = 0x200;
  _memset((void *)(in_ECX + 0x44),0,0x200);
  *(int *)(in_ECX + 0x34) = *(int *)(in_ECX + 0x34) + *(int *)(in_ECX + 0x40);
  *(undefined4 *)(in_ECX + 0x2c) = 0;
  *(int *)(in_ECX + 0x30) = *(int *)(in_ECX + 0x40);
  return false;
}



============================================================
DISASSEMBLY
============================================================
00539fb0 : PUSH EBX
00539fb1 : PUSH ESI
00539fb2 : MOV ESI,ECX
00539fb4 : XOR EBX,EBX
00539fb6 : CMP dword ptr [ESI + 0x30],EBX
00539fb9 : JNZ 0x00539fcf
00539fbb : MOV ECX,dword ptr [ESI + 0x10]
00539fbe : CMP ECX,EBX
00539fc0 : JZ 0x00539fcf
00539fc2 : MOV EAX,dword ptr [ECX]
00539fc4 : MOV EDX,dword ptr [EAX + 0x10]
00539fc7 : CALL EDX
00539fc9 : MOV dword ptr [ESI + 0x34],EAX
00539fcc : MOV byte ptr [ESI + 0x38],BL
00539fcf : MOV ECX,dword ptr [ESI + 0x2c]
00539fd2 : MOV EAX,dword ptr [ESI + 0x30]
00539fd5 : CMP ECX,EAX
00539fd7 : JNC 0x00539ff4
00539fd9 : MOV EDX,dword ptr [ESI + 0x3c]
00539fdc : SUB EAX,ECX
00539fde : PUSH EAX
00539fdf : LEA EAX,[EDX + ECX*0x1]
00539fe2 : PUSH EAX
00539fe3 : PUSH EDX
00539fe4 : CALL 0x00636880
00539fe9 : MOV ECX,dword ptr [ESI + 0x2c]
00539fec : ADD ESP,0xc
00539fef : SUB dword ptr [ESI + 0x30],ECX
00539ff2 : JMP 0x00539ff7
00539ff4 : MOV dword ptr [ESI + 0x30],EBX
00539ff7 : MOV ECX,dword ptr [ESI + 0x10]
00539ffa : MOV dword ptr [ESI + 0x2c],EBX
00539ffd : CMP ECX,EBX
00539fff : JZ 0x0053a06f
0053a001 : MOV EAX,dword ptr [ESI + 0x30]
0053a004 : MOV EDX,dword ptr [ECX]
0053a006 : PUSH EBP
0053a007 : MOV EBP,dword ptr [ESI + 0x3c]
0053a00a : PUSH EDI
0053a00b : MOV EDI,dword ptr [ESI + 0x40]
0053a00e : SUB EDI,EAX
0053a010 : ADD EBP,EAX
0053a012 : MOV EAX,dword ptr [EDX + 0x28]
0053a015 : PUSH EDI
0053a016 : PUSH EBP
0053a017 : CALL EAX
0053a019 : CMP EAX,EDI
0053a01b : JGE 0x0053a060
0053a01d : CMP EAX,EBX
0053a01f : JLE 0x0053a027
0053a021 : ADD dword ptr [ESI + 0x30],EAX
0053a024 : ADD dword ptr [ESI + 0x34],EAX
0053a027 : MOV EAX,dword ptr [ESI + 0x30]
0053a02a : MOV ECX,dword ptr [ESI + 0x40]
0053a02d : MOV EDX,dword ptr [ESI + 0x3c]
0053a030 : SUB ECX,EAX
0053a032 : PUSH ECX
0053a033 : ADD EDX,EAX
0053a035 : PUSH EBX
0053a036 : PUSH EDX
0053a037 : CALL 0x0063b700
0053a03c : MOV EDX,dword ptr [ESI + 0x2c]
0053a03f : MOV ECX,dword ptr [ESI + 0x30]
0053a042 : MOV EDI,dword ptr [ESP + 0x20]
0053a046 : SUB ECX,EDX
0053a048 : ADD ESP,0xc
0053a04b : CMP EDI,ECX
0053a04d : SETLE AL
0053a050 : CMP ECX,EDI
0053a052 : JGE 0x0053a059
0053a054 : ADD EDX,EDI
0053a056 : MOV dword ptr [ESI + 0x30],EDX
0053a059 : POP EDI
0053a05a : POP EBP
0053a05b : POP ESI
0053a05c : POP EBX
0053a05d : RET 0x4
0053a060 : ADD dword ptr [ESI + 0x30],EAX
0053a063 : ADD dword ptr [ESI + 0x34],EAX
0053a066 : POP EDI
0053a067 : POP EBP
0053a068 : POP ESI
0053a069 : MOV AL,0x1
0053a06b : POP EBX
0053a06c : RET 0x4
0053a06f : PUSH 0x200
0053a074 : LEA EAX,[ESI + 0x44]
0053a077 : PUSH EBX
0053a078 : PUSH EAX
0053a079 : MOV dword ptr [ESI + 0x3c],EAX
0053a07c : MOV dword ptr [ESI + 0x40],0x200
0053a083 : CALL 0x0063b700
0053a088 : MOV EAX,dword ptr [ESI + 0x40]
0053a08b : ADD dword ptr [ESI + 0x34],EAX
0053a08e : ADD ESP,0xc
0053a091 : MOV dword ptr [ESI + 0x2c],EBX
0053a094 : MOV dword ptr [ESI + 0x30],EAX
0053a097 : POP ESI
0053a098 : XOR AL,AL
0053a09a : POP EBX
0053a09b : RET 0x4

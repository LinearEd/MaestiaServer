PROGRAM  : Maestia.exe
FUNCTION : FUN_005e6680
ENTRY    : 005e6680
BODY     : [[005e6680, 005e67be]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005e6680(int param_1)

{
  undefined1 uVar1;
  undefined1 uVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  undefined4 uVar6;
  code *pcVar7;
  GRefCountNTSImpl *this;
  int *piVar8;
  
  iVar5 = *(int *)(param_1 + 0x314);
  if (iVar5 == 0) {
    iVar5 = param_1 + 0x28;
  }
  *(undefined1 *)(iVar5 + 0x15) = 0;
  if (*(int *)(iVar5 + 0x30) - *(int *)(iVar5 + 0x2c) < 2) {
    FUN_00539fb0(2);
  }
  iVar3 = *(int *)(iVar5 + 0x2c);
  uVar1 = *(undefined1 *)(*(int *)(iVar5 + 0x3c) + 1 + iVar3);
  uVar2 = *(undefined1 *)(*(int *)(iVar5 + 0x3c) + iVar3);
  *(int *)(iVar5 + 0x2c) = iVar3 + 2;
  piVar4 = *(int **)(*(int *)(param_1 + 0x10) + 0x24);
  this = (GRefCountNTSImpl *)0x0;
  if (piVar4 == (int *)0x0) {
    iVar5 = *(int *)(param_1 + 0x314);
    if (iVar5 == 0) {
      iVar5 = param_1 + 0x28;
    }
    FUN_0058c420(iVar5,"Error: Jpeg System is not installed - can\'t load jpeg image data\n");
  }
  else {
    FUN_0053a0b0();
    piVar8 = *(int **)(param_1 + 0x2b4);
    if (piVar8 == (int *)0x0) {
      iVar5 = FUN_005a02c0(*(undefined4 *)(param_1 + 0x2b8));
      uVar6 = DAT_00d73250;
      if (iVar5 == 0) {
        uVar6 = FUN_00561610();
      }
      iVar5 = *(int *)(param_1 + 0x314);
      if (iVar5 == 0) {
        iVar5 = param_1 + 0x28;
      }
      FUN_0053a0b0();
      *(undefined1 *)(iVar5 + 0x38) = 1;
      piVar8 = *(int **)(iVar5 + 0x10);
      pcVar7 = *(code **)(*piVar4 + 8);
    }
    else {
      (**(code **)(*piVar8 + 4))();
      iVar5 = FUN_005a02c0(*(undefined4 *)(param_1 + 0x2b8));
      uVar6 = DAT_00d73250;
      if (iVar5 == 0) {
        uVar6 = FUN_00561610();
      }
      pcVar7 = *(code **)(*piVar4 + 0x10);
    }
    this = (GRefCountNTSImpl *)(*pcVar7)(piVar8,uVar6);
  }
  FUN_005a1850(CONCAT11(uVar1,uVar2),this);
  if (this != (GRefCountNTSImpl *)0x0) {
    GRefCountNTSImpl::Release(this);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005e6680 : PUSH EBX
005e6681 : PUSH EBP
005e6682 : PUSH ESI
005e6683 : PUSH EDI
005e6684 : MOV EDI,dword ptr [ESP + 0x14]
005e6688 : MOV ESI,dword ptr [EDI + 0x314]
005e668e : TEST ESI,ESI
005e6690 : JNZ 0x005e6695
005e6692 : LEA ESI,[EDI + 0x28]
005e6695 : MOV EAX,dword ptr [ESI + 0x30]
005e6698 : SUB EAX,dword ptr [ESI + 0x2c]
005e669b : MOV byte ptr [ESI + 0x15],0x0
005e669f : CMP EAX,0x2
005e66a2 : JGE 0x005e66ad
005e66a4 : PUSH 0x2
005e66a6 : MOV ECX,ESI
005e66a8 : CALL 0x00539fb0
005e66ad : MOV EAX,dword ptr [ESI + 0x2c]
005e66b0 : MOV ECX,dword ptr [ESI + 0x3c]
005e66b3 : MOVZX DX,byte ptr [ECX + EAX*0x1 + 0x1]
005e66b9 : ADD ECX,EAX
005e66bb : MOVZX CX,byte ptr [ECX]
005e66bf : SHL DX,0x8
005e66c3 : ADD EAX,0x2
005e66c6 : MOV dword ptr [ESI + 0x2c],EAX
005e66c9 : MOV EAX,dword ptr [EDI + 0x10]
005e66cc : MOV EBX,dword ptr [EAX + 0x24]
005e66cf : OR DX,CX
005e66d2 : MOVZX EDX,DX
005e66d5 : XOR ESI,ESI
005e66d7 : MOV dword ptr [ESP + 0x14],EDX
005e66db : TEST EBX,EBX
005e66dd : JNZ 0x005e66ff
005e66df : MOV EAX,dword ptr [EDI + 0x314]
005e66e5 : TEST EAX,EAX
005e66e7 : JNZ 0x005e66ec
005e66e9 : LEA EAX,[EDI + 0x28]
005e66ec : PUSH 0xb93ea8
005e66f1 : PUSH EAX
005e66f2 : CALL 0x0058c420
005e66f7 : ADD ESP,0x8
005e66fa : JMP 0x005e679b
005e66ff : MOV ECX,dword ptr [EDI + 0x314]
005e6705 : TEST ECX,ECX
005e6707 : JNZ 0x005e670c
005e6709 : LEA ECX,[EDI + 0x28]
005e670c : CALL 0x0053a0b0
005e6711 : MOV ESI,dword ptr [EDI + 0x2b4]
005e6717 : TEST ESI,ESI
005e6719 : JNZ 0x005e6763
005e671b : MOV EAX,dword ptr [EDI + 0x2b8]
005e6721 : MOV ECX,dword ptr [EDI + 0x10]
005e6724 : PUSH EAX
005e6725 : CALL 0x005a02c0
005e672a : TEST EAX,EAX
005e672c : JZ 0x005e6736
005e672e : MOV EBP,dword ptr [0x00d73250]
005e6734 : JMP 0x005e6740
005e6736 : MOV ECX,dword ptr [EDI + 0x20]
005e6739 : CALL 0x00561610
005e673e : MOV EBP,EAX
005e6740 : MOV ESI,dword ptr [EDI + 0x314]
005e6746 : TEST ESI,ESI
005e6748 : JNZ 0x005e674d
005e674a : LEA ESI,[EDI + 0x28]
005e674d : MOV ECX,ESI
005e674f : CALL 0x0053a0b0
005e6754 : MOV byte ptr [ESI + 0x38],0x1
005e6758 : MOV EDX,dword ptr [EBX]
005e675a : MOV ESI,dword ptr [ESI + 0x10]
005e675d : MOV EAX,dword ptr [EDX + 0x8]
005e6760 : PUSH EBP
005e6761 : JMP 0x005e6794
005e6763 : MOV EDX,dword ptr [ESI]
005e6765 : MOV EAX,dword ptr [EDX + 0x4]
005e6768 : MOV ECX,ESI
005e676a : CALL EAX
005e676c : MOV EDX,dword ptr [EDI + 0x2b8]
005e6772 : MOV ECX,dword ptr [EDI + 0x10]
005e6775 : PUSH EDX
005e6776 : CALL 0x005a02c0
005e677b : TEST EAX,EAX
005e677d : JZ 0x005e6786
005e677f : MOV EAX,[0x00d73250]
005e6784 : JMP 0x005e678e
005e6786 : MOV ECX,dword ptr [EDI + 0x20]
005e6789 : CALL 0x00561610
005e678e : MOV EDX,dword ptr [EBX]
005e6790 : PUSH EAX
005e6791 : MOV EAX,dword ptr [EDX + 0x10]
005e6794 : PUSH ESI
005e6795 : MOV ECX,EBX
005e6797 : CALL EAX
005e6799 : MOV ESI,EAX
005e679b : PUSH ESI
005e679c : PUSH ECX
005e679d : MOVZX ECX,word ptr [ESP + 0x1c]
005e67a2 : MOV EAX,ESP
005e67a4 : MOV dword ptr [EAX],ECX
005e67a6 : MOV ECX,EDI
005e67a8 : CALL 0x005a1850
005e67ad : TEST ESI,ESI
005e67af : JZ 0x005e67b8
005e67b1 : MOV ECX,ESI
005e67b3 : CALL 0x004ff7c0
005e67b8 : POP EDI
005e67b9 : POP ESI
005e67ba : POP EBP
005e67bb : POP EBX
005e67bc : RET 0x8

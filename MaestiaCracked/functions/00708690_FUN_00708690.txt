PROGRAM  : Maestia.exe
FUNCTION : FUN_00708690
ENTRY    : 00708690
BODY     : [[00708690, 007086a9] [007086b0, 0070870c] [00708710, 00708791]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x00708742) */

void FUN_00708690(undefined4 param_1)

{
  byte *pbVar1;
  int iVar2;
  int iVar3;
  byte bVar4;
  int *in_ECX;
  uint uVar5;
  
  FUN_00707fd0(param_1);
  uVar5 = 0;
  *(undefined2 *)(in_ECX + 0xc) = 0;
  iVar3 = 0;
  do {
    pbVar1 = (byte *)(iVar3 + in_ECX[3]);
    bVar4 = (byte)uVar5;
    uVar5 = uVar5 + 8;
    iVar3 = iVar3 + 1;
    *(ushort *)(in_ECX + 0xc) = *(ushort *)(in_ECX + 0xc) | (ushort)*pbVar1 << (bVar4 & 0x1f);
  } while (uVar5 < 0x10);
  iVar3 = 0;
  *(undefined2 *)((int)in_ECX + 0x32) = 0;
  uVar5 = 0;
  do {
    iVar2 = iVar3 + 2;
    bVar4 = (byte)uVar5;
    uVar5 = uVar5 + 8;
    iVar3 = iVar3 + 1;
    *(ushort *)((int)in_ECX + 0x32) =
         *(ushort *)((int)in_ECX + 0x32) | (ushort)*(byte *)(iVar2 + in_ECX[3]) << (bVar4 & 0x1f);
  } while (uVar5 < 0x10);
  *(undefined1 *)(in_ECX + 0xd) = 0;
  *(undefined1 *)(in_ECX + 0xd) = *(undefined1 *)(in_ECX[3] + 4);
  *(undefined1 *)((int)in_ECX + 0x35) = 0;
  uVar5 = 0;
  *(undefined1 *)((int)in_ECX + 0x35) = *(undefined1 *)(in_ECX[3] + 5);
  *(undefined2 *)((int)in_ECX + 0x36) = 0;
  iVar3 = 0;
  do {
    iVar2 = iVar3 + 6;
    bVar4 = (byte)uVar5;
    uVar5 = uVar5 + 8;
    iVar3 = iVar3 + 1;
    *(ushort *)((int)in_ECX + 0x36) =
         *(ushort *)((int)in_ECX + 0x36) | (ushort)*(byte *)(iVar2 + in_ECX[3]) << (bVar4 & 0x1f);
  } while (uVar5 < 0x10);
  if (in_ECX[0xf] != in_ECX[0x10]) {
    in_ECX[0x10] = in_ECX[0xf];
  }
  FUN_004d0ff0();
  iVar3 = in_ECX[6];
  iVar2 = in_ECX[0xf];
  uVar5 = 0;
  if (iVar3 != 8) {
    do {
      *(undefined1 *)(uVar5 + iVar2) = 0;
      *(undefined1 *)(uVar5 + iVar2) = *(undefined1 *)(uVar5 + 8 + in_ECX[3]);
      uVar5 = uVar5 + 1;
    } while (uVar5 < iVar3 - 8U);
  }
  (**(code **)(*in_ECX + 0x10))();
  return;
}



============================================================
DISASSEMBLY
============================================================
00708690 : PUSH EBP
00708691 : MOV EBP,ESP
00708693 : MOV EAX,dword ptr [EBP + 0x8]
00708696 : PUSH ESI
00708697 : PUSH EDI
00708698 : PUSH EAX
00708699 : MOV ESI,ECX
0070869b : CALL 0x00707fd0
007086a0 : XOR ECX,ECX
007086a2 : MOV word ptr [ESI + 0x30],CX
007086a6 : XOR EAX,EAX
007086a8 : JMP 0x007086b0
007086b0 : MOV EDX,dword ptr [ESI + 0xc]
007086b3 : MOVZX DX,byte ptr [EAX + EDX*0x1]
007086b8 : SHL DX,CL
007086bb : ADD ECX,0x8
007086be : INC EAX
007086bf : OR word ptr [ESI + 0x30],DX
007086c3 : CMP ECX,0x10
007086c6 : JC 0x007086b0
007086c8 : XOR EAX,EAX
007086ca : MOV word ptr [ESI + 0x32],AX
007086ce : XOR ECX,ECX
007086d0 : MOV EDX,dword ptr [ESI + 0xc]
007086d3 : MOVZX DX,byte ptr [EAX + EDX*0x1 + 0x2]
007086d9 : SHL DX,CL
007086dc : ADD ECX,0x8
007086df : INC EAX
007086e0 : OR word ptr [ESI + 0x32],DX
007086e4 : CMP ECX,0x10
007086e7 : JC 0x007086d0
007086e9 : MOV byte ptr [ESI + 0x34],0x0
007086ed : MOV EAX,dword ptr [ESI + 0xc]
007086f0 : MOV CL,byte ptr [EAX + 0x4]
007086f3 : MOV byte ptr [ESI + 0x34],CL
007086f6 : MOV byte ptr [ESI + 0x35],0x0
007086fa : MOV EDX,dword ptr [ESI + 0xc]
007086fd : MOV AL,byte ptr [EDX + 0x5]
00708700 : XOR ECX,ECX
00708702 : MOV byte ptr [ESI + 0x35],AL
00708705 : MOV word ptr [ESI + 0x36],CX
00708709 : XOR EAX,EAX
0070870b : JMP 0x00708710
00708710 : MOV EDX,dword ptr [ESI + 0xc]
00708713 : MOVZX DX,byte ptr [EAX + EDX*0x1 + 0x6]
00708719 : SHL DX,CL
0070871c : ADD ECX,0x8
0070871f : INC EAX
00708720 : OR word ptr [ESI + 0x36],DX
00708724 : CMP ECX,0x10
00708727 : JC 0x00708710
00708729 : MOV EDX,dword ptr [ESI + 0x3c]
0070872c : MOV ECX,dword ptr [ESI + 0x40]
0070872f : LEA EDI,[ESI + 0x38]
00708732 : CMP EDX,ECX
00708734 : JZ 0x00708752
00708736 : MOV EAX,ECX
00708738 : SUB EAX,ECX
0070873a : PUSH EBX
0070873b : LEA EBX,[EAX + EDX*0x1]
0070873e : TEST EAX,EAX
00708740 : JLE 0x0070874e
00708742 : PUSH EAX
00708743 : PUSH ECX
00708744 : PUSH EAX
00708745 : PUSH EDX
00708746 : CALL 0x00634101
0070874b : ADD ESP,0x10
0070874e : MOV dword ptr [EDI + 0x8],EBX
00708751 : POP EBX
00708752 : MOV EAX,dword ptr [ESI + 0x18]
00708755 : SUB EAX,0x8
00708758 : CALL 0x004d0ff0
0070875d : MOV ECX,dword ptr [ESI + 0x18]
00708760 : SUB ECX,0x8
00708763 : MOV EDI,dword ptr [ESI + 0x3c]
00708766 : MOV EAX,0x0
0070876b : JZ 0x00708783
0070876d : LEA ECX,[ECX]
00708770 : MOV byte ptr [EAX + EDI*0x1],0x0
00708774 : MOV EDX,dword ptr [ESI + 0xc]
00708777 : MOV DL,byte ptr [EAX + EDX*0x1 + 0x8]
0070877b : MOV byte ptr [EAX + EDI*0x1],DL
0070877e : INC EAX
0070877f : CMP EAX,ECX
00708781 : JC 0x00708770
00708783 : MOV EAX,dword ptr [ESI]
00708785 : MOV EDX,dword ptr [EAX + 0x10]
00708788 : MOV ECX,ESI
0070878a : CALL EDX
0070878c : POP EDI
0070878d : POP ESI
0070878e : POP EBP
0070878f : RET 0x4

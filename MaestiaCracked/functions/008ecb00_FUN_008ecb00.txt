PROGRAM  : Maestia.exe
FUNCTION : FUN_008ecb00
ENTRY    : 008ecb00
BODY     : [[008ecb00, 008ecd10]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008ecb00(void)

{
  int *piVar1;
  undefined4 uVar2;
  int in_ECX;
  int iVar3;
  undefined1 local_4c [4];
  undefined2 local_48;
  undefined4 local_38;
  uint local_34;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1e412;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_18 = 7;
  local_1c = 0;
  local_2c = 0;
  FUN_00406360(L"IDS_RVREVENT_INPUT_PASSWORD",0x1b);
  local_8 = 0;
  uVar2 = FUN_0081d120(local_30);
  local_8 = CONCAT31(local_8._1_3_,1);
  FUN_0044f270(in_ECX + 0x94,&local_14,uVar2);
  if (local_14 != *(int *)(in_ECX + 0x9c)) {
    FUN_00484470(local_14 + 0x24);
    if (local_14 != *(int *)(in_ECX + 0x60)) {
      iVar3 = *(int *)(local_14 + 0x10);
      goto LAB_008ecba2;
    }
  }
  iVar3 = 0;
LAB_008ecba2:
  local_8 = local_8 & 0xffffff00;
  if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_34 = 7;
  local_38 = 0;
  local_48 = 0;
  local_8 = 0xffffffff;
  if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_18 = 7;
  local_1c = 0;
  local_2c = 0;
  if ((iVar3 != 0) && (DAT_00da9852 != '\0')) {
    FUN_00406460(L"IDS_RVREVENT_INPUT_PASSWORD");
    local_8 = 2;
    FUN_0081d120(local_30);
    local_8._0_1_ = 3;
    FUN_008eba30();
    local_8 = CONCAT31(local_8._1_3_,2);
    if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_34 = 7;
    local_38 = 0;
    local_48 = 0;
    local_8 = 0xffffffff;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c = 0;
    if (*(int *)(in_ECX + 0x1cc) != 0) {
      PTR_FUN_00d6eb34 = (undefined *)0x0;
      DAT_00d6ee14 = 0;
    }
    if (((DAT_0172491c != 0) && (*DAT_00da9894 != 0)) && (*(int *)(*DAT_00da9894 + 0x1a8) != 0)) {
      FUN_00406460(L"IDS_CLOSE_WINDOW");
      local_8 = 4;
      piVar1 = *(int **)(*DAT_00da9894 + 0x1a8);
      uVar2 = FUN_0081d120(local_4c);
      local_8._0_1_ = 5;
      (**(code **)(*piVar1 + 0x44))(uVar2,3);
      local_8 = CONCAT31(local_8._1_3_,4);
      FUN_00406560();
      local_8 = 0xffffffff;
      FUN_00406560();
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
008ecb00 : PUSH EBP
008ecb01 : MOV EBP,ESP
008ecb03 : PUSH -0x1
008ecb05 : PUSH 0xb1e412
008ecb0a : MOV EAX,FS:[0x0]
008ecb10 : PUSH EAX
008ecb11 : SUB ESP,0x3c
008ecb14 : PUSH EBX
008ecb15 : PUSH ESI
008ecb16 : PUSH EDI
008ecb17 : MOV EAX,[0x00d66fa0]
008ecb1c : XOR EAX,EBP
008ecb1e : PUSH EAX
008ecb1f : LEA EAX,[EBP + -0xc]
008ecb22 : MOV FS:[0x0],EAX
008ecb28 : MOV ESI,ECX
008ecb2a : PUSH 0x1b
008ecb2c : XOR EAX,EAX
008ecb2e : XOR EBX,EBX
008ecb30 : PUSH 0xc5f93c
008ecb35 : LEA ECX,[EBP + -0x2c]
008ecb38 : MOV dword ptr [EBP + -0x14],0x7
008ecb3f : MOV dword ptr [EBP + -0x18],EBX
008ecb42 : MOV word ptr [EBP + -0x28],AX
008ecb46 : CALL 0x00406360
008ecb4b : MOV dword ptr [EBP + -0x4],EBX
008ecb4e : LEA ECX,[EBP + -0x2c]
008ecb51 : PUSH ECX
008ecb52 : MOV ECX,dword ptr [0x0172491c]
008ecb58 : LEA EDI,[EBP + -0x48]
008ecb5b : CALL 0x0081d120
008ecb60 : MOV byte ptr [EBP + -0x4],0x1
008ecb64 : PUSH EAX
008ecb65 : LEA EDX,[EBP + -0x10]
008ecb68 : PUSH EDX
008ecb69 : LEA EAX,[ESI + 0x94]
008ecb6f : PUSH EAX
008ecb70 : CALL 0x0044f270
008ecb75 : MOV EAX,dword ptr [ESI + 0x9c]
008ecb7b : MOV ECX,dword ptr [EBP + -0x10]
008ecb7e : CMP ECX,EAX
008ecb80 : JZ 0x008ecba0
008ecb82 : ADD ECX,0x24
008ecb85 : PUSH ECX
008ecb86 : LEA ECX,[ESI + 0x5c]
008ecb89 : LEA EAX,[EBP + -0x10]
008ecb8c : CALL 0x00484470
008ecb91 : MOV EAX,dword ptr [ESI + 0x60]
008ecb94 : MOV ECX,dword ptr [EBP + -0x10]
008ecb97 : CMP ECX,EAX
008ecb99 : JZ 0x008ecba0
008ecb9b : MOV EDI,dword ptr [ECX + 0x10]
008ecb9e : JMP 0x008ecba2
008ecba0 : XOR EDI,EDI
008ecba2 : MOV byte ptr [EBP + -0x4],BL
008ecba5 : CMP dword ptr [EBP + -0x30],0x8
008ecba9 : JC 0x008ecbb3
008ecbab : MOV ECX,dword ptr [EBP + -0x44]
008ecbae : CALL 0x006f04e0
008ecbb3 : XOR ECX,ECX
008ecbb5 : MOV dword ptr [EBP + -0x30],0x7
008ecbbc : MOV dword ptr [EBP + -0x34],EBX
008ecbbf : MOV word ptr [EBP + -0x44],CX
008ecbc3 : MOV dword ptr [EBP + -0x4],0xffffffff
008ecbca : CMP dword ptr [EBP + -0x14],0x8
008ecbce : JC 0x008ecbd8
008ecbd0 : MOV ECX,dword ptr [EBP + -0x28]
008ecbd3 : CALL 0x006f04e0
008ecbd8 : XOR EDX,EDX
008ecbda : MOV dword ptr [EBP + -0x14],0x7
008ecbe1 : MOV dword ptr [EBP + -0x18],EBX
008ecbe4 : MOV word ptr [EBP + -0x28],DX
008ecbe8 : CMP EDI,EBX
008ecbea : JZ 0x008eccff
008ecbf0 : CMP byte ptr [0x00da9852],BL
008ecbf6 : JZ 0x008eccff
008ecbfc : PUSH 0xc5f974
008ecc01 : LEA ECX,[EBP + -0x2c]
008ecc04 : CALL 0x00406460
008ecc09 : MOV dword ptr [EBP + -0x4],0x2
008ecc10 : MOV ECX,dword ptr [0x0172491c]
008ecc16 : LEA EAX,[EBP + -0x2c]
008ecc19 : PUSH EAX
008ecc1a : LEA EDI,[EBP + -0x48]
008ecc1d : CALL 0x0081d120
008ecc22 : MOV byte ptr [EBP + -0x4],0x3
008ecc26 : CALL 0x008eba30
008ecc2b : MOV byte ptr [EBP + -0x4],0x2
008ecc2f : CMP dword ptr [EBP + -0x30],0x8
008ecc33 : JC 0x008ecc3d
008ecc35 : MOV ECX,dword ptr [EBP + -0x44]
008ecc38 : CALL 0x006f04e0
008ecc3d : MOV EDI,0x7
008ecc42 : XOR ECX,ECX
008ecc44 : MOV dword ptr [EBP + -0x30],EDI
008ecc47 : MOV dword ptr [EBP + -0x34],EBX
008ecc4a : MOV word ptr [EBP + -0x44],CX
008ecc4e : MOV dword ptr [EBP + -0x4],0xffffffff
008ecc55 : CMP dword ptr [EBP + -0x14],0x8
008ecc59 : JC 0x008ecc63
008ecc5b : MOV ECX,dword ptr [EBP + -0x28]
008ecc5e : CALL 0x006f04e0
008ecc63 : XOR EDX,EDX
008ecc65 : MOV dword ptr [EBP + -0x14],EDI
008ecc68 : MOV dword ptr [EBP + -0x18],EBX
008ecc6b : MOV word ptr [EBP + -0x28],DX
008ecc6f : CMP dword ptr [ESI + 0x1cc],EBX
008ecc75 : JZ 0x008ecc85
008ecc77 : XOR EAX,EAX
008ecc79 : MOV dword ptr [0x00d6eb34],EBX
008ecc7f : MOV [0x00d6ee14],AX
008ecc85 : CMP dword ptr [0x0172491c],EBX
008ecc8b : JZ 0x008eccff
008ecc8d : MOV ECX,dword ptr [0x00da9894]
008ecc93 : MOV EAX,dword ptr [ECX]
008ecc95 : CMP EAX,EBX
008ecc97 : JZ 0x008eccff
008ecc99 : CMP dword ptr [EAX + 0x1a8],EBX
008ecc9f : JZ 0x008eccff
008ecca1 : PUSH 0xc5f9ac
008ecca6 : LEA ECX,[EBP + -0x48]
008ecca9 : CALL 0x00406460
008eccae : MOV EBX,0x4
008eccb3 : MOV dword ptr [EBP + -0x4],EBX
008eccb6 : MOV EDX,dword ptr [0x00da9894]
008eccbc : MOV EAX,dword ptr [EDX]
008eccbe : MOV ESI,dword ptr [EAX + 0x1a8]
008eccc4 : MOV ECX,dword ptr [0x0172491c]
008eccca : LEA EAX,[EBP + -0x48]
008ecccd : PUSH EAX
008eccce : LEA EDI,[EBP + -0x2c]
008eccd1 : CALL 0x0081d120
008eccd6 : MOV byte ptr [EBP + -0x4],0x5
008eccda : MOV EDX,dword ptr [ESI]
008eccdc : PUSH 0x3
008eccde : PUSH EAX
008eccdf : MOV EAX,dword ptr [EDX + 0x44]
008ecce2 : MOV ECX,ESI
008ecce4 : CALL EAX
008ecce6 : MOV byte ptr [EBP + -0x4],BL
008ecce9 : MOV ECX,EDI
008ecceb : CALL 0x00406560
008eccf0 : MOV dword ptr [EBP + -0x4],0xffffffff
008eccf7 : LEA ECX,[EBP + -0x48]
008eccfa : CALL 0x00406560
008eccff : MOV ECX,dword ptr [EBP + -0xc]
008ecd02 : MOV dword ptr FS:[0x0],ECX
008ecd09 : POP ECX
008ecd0a : POP EDI
008ecd0b : POP ESI
008ecd0c : POP EBX
008ecd0d : MOV ESP,EBP
008ecd0f : POP EBP
008ecd10 : RET

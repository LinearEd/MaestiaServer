PROGRAM  : Maestia.exe
FUNCTION : FUN_008bf5a0
ENTRY    : 008bf5a0
BODY     : [[008bf5a0, 008bf7f9]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008bf5a0(undefined4 param_1)

{
  int iVar1;
  int iVar2;
  int *in_ECX;
  uint local_58;
  undefined1 local_4c [4];
  undefined2 local_48;
  undefined4 local_38;
  uint local_34;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b2ba66;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar1 = (**(code **)(*in_ECX + 0x74))();
  iVar2 = (**(code **)(*in_ECX + 0x74))();
  local_34 = 7;
  local_38 = 0;
  local_48 = 0;
  FUN_00406360();
  local_8 = 0;
  local_2c = 0;
  local_18 = 7;
  local_1c = 0;
  FUN_00406360();
  local_8._0_1_ = 1;
  if (iVar1 != 0) {
    (**(code **)(*in_ECX + 0x58))();
    FUN_00405eb0(local_4c);
    local_8._0_1_ = 1;
    FUN_008f75f0();
    local_8._0_1_ = 3;
    FUN_00405eb0();
    local_8._0_1_ = 1;
    if (7 < local_58) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_58 = 7;
  }
  local_8._0_1_ = 1;
  if (iVar2 == 0) {
    (**(code **)(*in_ECX + 0x78))();
    (**(code **)(*in_ECX + 0x70))();
  }
  else {
    (**(code **)(*in_ECX + 0x58))();
    FUN_00405eb0(local_30,0,0xffffffff);
    local_8._0_1_ = 1;
    FUN_008f75f0();
    local_8._0_1_ = 5;
    FUN_00405eb0();
    local_8._0_1_ = 1;
    if (7 < local_58) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    (**(code **)(*in_ECX + 0x78))();
    (**(code **)(*in_ECX + 0x78))();
    (**(code **)(*in_ECX + 0x70))();
    (**(code **)(*in_ECX + 0x70))(iVar2,param_1,0);
  }
  local_8 = (uint)local_8._1_3_ << 8;
  if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_18 = 7;
  local_1c = 0;
  local_2c = 0;
  local_8 = 0xffffffff;
  if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_34 = 7;
  local_38 = 0;
  local_48 = 0;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008bf5a0 : PUSH EBP
008bf5a1 : MOV EBP,ESP
008bf5a3 : PUSH -0x1
008bf5a5 : PUSH 0xb2ba66
008bf5aa : MOV EAX,FS:[0x0]
008bf5b0 : PUSH EAX
008bf5b1 : SUB ESP,0x60
008bf5b4 : MOV EAX,[0x00d66fa0]
008bf5b9 : XOR EAX,EBP
008bf5bb : MOV dword ptr [EBP + -0x10],EAX
008bf5be : PUSH EBX
008bf5bf : PUSH ESI
008bf5c0 : PUSH EDI
008bf5c1 : PUSH EAX
008bf5c2 : LEA EAX,[EBP + -0xc]
008bf5c5 : MOV FS:[0x0],EAX
008bf5cb : MOV ESI,ECX
008bf5cd : MOV ECX,dword ptr [EBP + 0x8]
008bf5d0 : MOV EAX,dword ptr [ESI]
008bf5d2 : MOV EDX,dword ptr [EAX + 0x74]
008bf5d5 : XOR EBX,EBX
008bf5d7 : PUSH EBX
008bf5d8 : PUSH ECX
008bf5d9 : MOV ECX,ESI
008bf5db : CALL EDX
008bf5dd : MOV ECX,dword ptr [EBP + 0x10]
008bf5e0 : MOV EDI,EAX
008bf5e2 : MOV EAX,dword ptr [ESI]
008bf5e4 : MOV EDX,dword ptr [EAX + 0x74]
008bf5e7 : PUSH EBX
008bf5e8 : PUSH ECX
008bf5e9 : MOV ECX,ESI
008bf5eb : CALL EDX
008bf5ed : MOV dword ptr [EBP + -0x4c],EAX
008bf5f0 : PUSH EBX
008bf5f1 : XOR EAX,EAX
008bf5f3 : PUSH 0xc4e828
008bf5f8 : LEA ECX,[EBP + -0x48]
008bf5fb : MOV dword ptr [EBP + -0x30],0x7
008bf602 : MOV dword ptr [EBP + -0x34],EBX
008bf605 : MOV word ptr [EBP + -0x44],AX
008bf609 : CALL 0x00406360
008bf60e : MOV dword ptr [EBP + -0x4],EBX
008bf611 : XOR ECX,ECX
008bf613 : PUSH EBX
008bf614 : MOV word ptr [EBP + -0x28],CX
008bf618 : PUSH 0xc4e82c
008bf61d : LEA ECX,[EBP + -0x2c]
008bf620 : MOV dword ptr [EBP + -0x14],0x7
008bf627 : MOV dword ptr [EBP + -0x18],EBX
008bf62a : CALL 0x00406360
008bf62f : MOV byte ptr [EBP + -0x4],0x1
008bf633 : CMP EDI,EBX
008bf635 : JZ 0x008bf6b1
008bf637 : MOV EAX,dword ptr [EDI + 0x10]
008bf63a : MOV EDX,dword ptr [ESI]
008bf63c : MOV EDX,dword ptr [EDX + 0x58]
008bf63f : LEA ECX,[EBP + -0x48]
008bf642 : PUSH ECX
008bf643 : PUSH EAX
008bf644 : MOV ECX,ESI
008bf646 : CALL EDX
008bf648 : SUB ESP,0x1c
008bf64b : MOV ECX,ESP
008bf64d : MOV dword ptr [EBP + -0x50],ESP
008bf650 : PUSH -0x1
008bf652 : PUSH EBX
008bf653 : LEA EDX,[EBP + -0x48]
008bf656 : XOR EAX,EAX
008bf658 : MOV dword ptr [ECX + 0x18],0x7
008bf65f : MOV dword ptr [ECX + 0x14],EBX
008bf662 : PUSH EDX
008bf663 : MOV word ptr [ECX + 0x4],AX
008bf667 : CALL 0x00405eb0
008bf66c : MOV byte ptr [EBP + -0x4],0x2
008bf670 : MOV byte ptr [EBP + -0x4],0x1
008bf674 : LEA ECX,[EBP + -0x6c]
008bf677 : CALL 0x008f75f0
008bf67c : ADD ESP,0x1c
008bf67f : MOV byte ptr [EBP + -0x4],0x3
008bf683 : PUSH -0x1
008bf685 : PUSH EBX
008bf686 : PUSH EAX
008bf687 : LEA ECX,[EBP + -0x48]
008bf68a : CALL 0x00405eb0
008bf68f : MOV byte ptr [EBP + -0x4],0x1
008bf693 : CMP dword ptr [EBP + -0x54],0x8
008bf697 : JC 0x008bf6a1
008bf699 : MOV ECX,dword ptr [EBP + -0x68]
008bf69c : CALL 0x006f04e0
008bf6a1 : XOR EAX,EAX
008bf6a3 : MOV dword ptr [EBP + -0x54],0x7
008bf6aa : MOV dword ptr [EBP + -0x58],EBX
008bf6ad : MOV word ptr [EBP + -0x68],AX
008bf6b1 : MOV EAX,dword ptr [EBP + -0x4c]
008bf6b4 : MOV EDX,dword ptr [ESI]
008bf6b6 : CMP EAX,EBX
008bf6b8 : JZ 0x008bf7d7
008bf6be : MOV EAX,dword ptr [EAX + 0x10]
008bf6c1 : MOV EDX,dword ptr [EDX + 0x58]
008bf6c4 : LEA ECX,[EBP + -0x2c]
008bf6c7 : PUSH ECX
008bf6c8 : PUSH EAX
008bf6c9 : MOV ECX,ESI
008bf6cb : CALL EDX
008bf6cd : SUB ESP,0x1c
008bf6d0 : MOV ECX,ESP
008bf6d2 : MOV dword ptr [EBP + -0x50],ESP
008bf6d5 : PUSH -0x1
008bf6d7 : PUSH EBX
008bf6d8 : LEA EDX,[EBP + -0x2c]
008bf6db : XOR EAX,EAX
008bf6dd : MOV dword ptr [ECX + 0x18],0x7
008bf6e4 : MOV dword ptr [ECX + 0x14],EBX
008bf6e7 : PUSH EDX
008bf6e8 : MOV word ptr [ECX + 0x4],AX
008bf6ec : CALL 0x00405eb0
008bf6f1 : MOV byte ptr [EBP + -0x4],0x4
008bf6f5 : MOV byte ptr [EBP + -0x4],0x1
008bf6f9 : LEA ECX,[EBP + -0x6c]
008bf6fc : CALL 0x008f75f0
008bf701 : ADD ESP,0x1c
008bf704 : MOV byte ptr [EBP + -0x4],0x5
008bf708 : PUSH -0x1
008bf70a : PUSH EBX
008bf70b : PUSH EAX
008bf70c : LEA ECX,[EBP + -0x2c]
008bf70f : CALL 0x00405eb0
008bf714 : MOV byte ptr [EBP + -0x4],0x1
008bf718 : CMP dword ptr [EBP + -0x54],0x8
008bf71c : JC 0x008bf726
008bf71e : MOV ECX,dword ptr [EBP + -0x68]
008bf721 : CALL 0x006f04e0
008bf726 : MOV ECX,dword ptr [EBP + 0x8]
008bf729 : XOR EAX,EAX
008bf72b : MOV word ptr [EBP + -0x68],AX
008bf72f : MOV EAX,dword ptr [ESI]
008bf731 : MOV EDX,dword ptr [EAX + 0x78]
008bf734 : PUSH EBX
008bf735 : PUSH ECX
008bf736 : MOV ECX,ESI
008bf738 : MOV dword ptr [EBP + -0x54],0x7
008bf73f : MOV dword ptr [EBP + -0x58],EBX
008bf742 : CALL EDX
008bf744 : MOV ECX,dword ptr [EBP + 0x10]
008bf747 : MOV EAX,dword ptr [ESI]
008bf749 : MOV EDX,dword ptr [EAX + 0x78]
008bf74c : PUSH EBX
008bf74d : PUSH ECX
008bf74e : MOV ECX,ESI
008bf750 : CALL EDX
008bf752 : MOV ECX,dword ptr [EBP + 0x10]
008bf755 : MOV EAX,dword ptr [ESI]
008bf757 : MOV EDX,dword ptr [EAX + 0x70]
008bf75a : PUSH EBX
008bf75b : PUSH ECX
008bf75c : PUSH EDI
008bf75d : MOV ECX,ESI
008bf75f : CALL EDX
008bf761 : MOV ECX,dword ptr [EBP + 0x8]
008bf764 : MOV EAX,dword ptr [ESI]
008bf766 : MOV EDX,dword ptr [EBP + -0x4c]
008bf769 : MOV EAX,dword ptr [EAX + 0x70]
008bf76c : PUSH EBX
008bf76d : PUSH ECX
008bf76e : PUSH EDX
008bf76f : MOV ECX,ESI
008bf771 : CALL EAX
008bf773 : MOV byte ptr [EBP + -0x4],BL
008bf776 : MOV EDI,0x8
008bf77b : CMP dword ptr [EBP + -0x14],EDI
008bf77e : JC 0x008bf788
008bf780 : MOV ECX,dword ptr [EBP + -0x28]
008bf783 : CALL 0x006f04e0
008bf788 : MOV ESI,0x7
008bf78d : XOR ECX,ECX
008bf78f : MOV dword ptr [EBP + -0x14],ESI
008bf792 : MOV dword ptr [EBP + -0x18],EBX
008bf795 : MOV word ptr [EBP + -0x28],CX
008bf799 : MOV dword ptr [EBP + -0x4],0xffffffff
008bf7a0 : CMP dword ptr [EBP + -0x30],EDI
008bf7a3 : JC 0x008bf7ad
008bf7a5 : MOV ECX,dword ptr [EBP + -0x44]
008bf7a8 : CALL 0x006f04e0
008bf7ad : XOR EDX,EDX
008bf7af : MOV dword ptr [EBP + -0x30],ESI
008bf7b2 : MOV dword ptr [EBP + -0x34],EBX
008bf7b5 : MOV word ptr [EBP + -0x44],DX
008bf7b9 : MOV ECX,dword ptr [EBP + -0xc]
008bf7bc : MOV dword ptr FS:[0x0],ECX
008bf7c3 : POP ECX
008bf7c4 : POP EDI
008bf7c5 : POP ESI
008bf7c6 : POP EBX
008bf7c7 : MOV ECX,dword ptr [EBP + -0x10]
008bf7ca : XOR ECX,EBP
008bf7cc : CALL 0x00633e6b
008bf7d1 : MOV ESP,EBP
008bf7d3 : POP EBP
008bf7d4 : RET 0xc
008bf7d7 : MOV EAX,dword ptr [EBP + 0xc]
008bf7da : MOV ECX,dword ptr [EBP + 0x8]
008bf7dd : MOV EDX,dword ptr [EDX + 0x78]
008bf7e0 : PUSH EAX
008bf7e1 : PUSH ECX
008bf7e2 : MOV ECX,ESI
008bf7e4 : CALL EDX
008bf7e6 : MOV ECX,dword ptr [EBP + 0x10]
008bf7e9 : MOV EAX,dword ptr [ESI]
008bf7eb : MOV EDX,dword ptr [EAX + 0x70]
008bf7ee : PUSH EBX
008bf7ef : PUSH ECX
008bf7f0 : PUSH EDI
008bf7f1 : MOV ECX,ESI
008bf7f3 : CALL EDX
008bf7f5 : JMP 0x008bf773

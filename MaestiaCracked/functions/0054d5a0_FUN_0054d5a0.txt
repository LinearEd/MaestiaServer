PROGRAM  : Maestia.exe
FUNCTION : FUN_0054d5a0
ENTRY    : 0054d5a0
BODY     : [[0054d5a0, 0054d6c9]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0054d5a0(uint param_1,char param_2)

{
  byte bVar1;
  uint uVar2;
  int iVar3;
  int in_ECX;
  uint uVar4;
  
  uVar4 = param_1;
  uVar2 = param_1;
  if (param_1 != 0xffffffff) {
    uVar2 = FUN_0053c470();
    if (uVar2 < uVar4) {
      uVar4 = uVar2;
    }
    if ((*(byte *)(in_ECX + 0x68) & 1) == 0) {
      *(ushort *)(in_ECX + 0x68) = *(ushort *)(in_ECX + 0x68) | 8;
    }
    else {
      *(ushort *)(in_ECX + 0x68) = *(ushort *)(in_ECX + 0x68) & 0xfff7;
    }
    *(undefined8 *)(in_ECX + 0x38) = 0;
    uVar2 = uVar4;
    if ((((*(int *)(*(int *)(in_ECX + 8) + 0x1c) != 0) &&
         (iVar3 = FUN_0054d0e0(uVar4,&param_1), iVar3 != 0)) &&
        ((*(ushort *)(iVar3 + 4) & 0xf000) != 0x1000)) &&
       ((param_1 != uVar4 && (uVar2 = param_1, *(uint *)(in_ECX + 0x18) <= uVar4)))) {
      uVar2 = (*(ushort *)(iVar3 + 4) >> 0xc) + param_1;
    }
  }
  *(uint *)(in_ECX + 0x18) = uVar2;
  *(short *)(in_ECX + 0x34) = *(short *)(in_ECX + 0x34) + -1;
  *(undefined4 *)(in_ECX + 0x48) = 0xbf800000;
  if (*(int *)(in_ECX + 0x18) != -1) {
    FUN_0054d2b0(*(int *)(in_ECX + 0x18),1,*(byte *)(in_ECX + 0x69) & 1);
    FUN_00545100(*(undefined4 *)(in_ECX + 0x18));
  }
  bVar1 = (byte)*(undefined2 *)(in_ECX + 0x68);
  if ((bVar1 >> 1 & 1) != 0) {
    if (param_2 == '\0') {
      FUN_00546be0(*(undefined4 *)(in_ECX + 0x18),*(undefined4 *)(in_ECX + 0x18));
    }
    else if (((bVar1 >> 6 & 1) == 0) && ((bVar1 >> 5 & 1) == 0)) {
      iVar3 = *(int *)(in_ECX + 0x18);
      if ((*(int *)(*(int *)(in_ECX + 8) + 0x20) != iVar3) ||
         (*(int *)(*(int *)(in_ECX + 8) + 0x24) != iVar3)) {
        FUN_00546be0(iVar3,iVar3);
        return;
      }
    }
    else if (*(int *)(*(int *)(in_ECX + 8) + 0x24) != *(int *)(in_ECX + 0x18)) {
      FUN_00546be0(*(undefined4 *)(*(int *)(in_ECX + 8) + 0x20),*(int *)(in_ECX + 0x18));
      return;
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
0054d5a0 : PUSH ESI
0054d5a1 : PUSH EDI
0054d5a2 : MOV EDI,dword ptr [ESP + 0xc]
0054d5a6 : MOV ESI,ECX
0054d5a8 : CMP EDI,-0x1
0054d5ab : JZ 0x0054d620
0054d5ad : MOV EAX,dword ptr [ESI + 0x8]
0054d5b0 : MOV ECX,dword ptr [EAX + 0xc]
0054d5b3 : CALL 0x0053c470
0054d5b8 : CMP EDI,EAX
0054d5ba : JBE 0x0054d5be
0054d5bc : MOV EDI,EAX
0054d5be : TEST byte ptr [ESI + 0x68],0x1
0054d5c2 : JNZ 0x0054d5cb
0054d5c4 : OR word ptr [ESI + 0x68],0x8
0054d5c9 : JMP 0x0054d5d4
0054d5cb : MOV ECX,0xfff7
0054d5d0 : AND word ptr [ESI + 0x68],CX
0054d5d4 : FLDZ
0054d5d6 : MOV EDX,dword ptr [ESI + 0x8]
0054d5d9 : FSTP double ptr [ESI + 0x38]
0054d5dc : CMP dword ptr [EDX + 0x1c],0x0
0054d5e0 : JZ 0x0054d620
0054d5e2 : LEA EAX,[ESP + 0xc]
0054d5e6 : PUSH EAX
0054d5e7 : PUSH EDI
0054d5e8 : MOV ECX,ESI
0054d5ea : CALL 0x0054d0e0
0054d5ef : TEST EAX,EAX
0054d5f1 : JZ 0x0054d620
0054d5f3 : MOVZX ECX,word ptr [EAX + 0x4]
0054d5f7 : MOV EDX,ECX
0054d5f9 : AND EDX,0xf000
0054d5ff : CMP EDX,0x1000
0054d605 : JZ 0x0054d620
0054d607 : MOV EAX,dword ptr [ESP + 0xc]
0054d60b : CMP EAX,EDI
0054d60d : JZ 0x0054d620
0054d60f : CMP EDI,dword ptr [ESI + 0x18]
0054d612 : JC 0x0054d61e
0054d614 : MOVZX EDI,CX
0054d617 : SHR EDI,0xc
0054d61a : ADD EDI,EAX
0054d61c : JMP 0x0054d620
0054d61e : MOV EDI,EAX
0054d620 : FLD float ptr [0x00cdf0d0]
0054d626 : MOV EAX,0xffff
0054d62b : MOV dword ptr [ESI + 0x18],EDI
0054d62e : ADD word ptr [ESI + 0x34],AX
0054d632 : FSTP float ptr [ESI + 0x48]
0054d635 : MOV EAX,dword ptr [ESI + 0x18]
0054d638 : CMP EAX,-0x1
0054d63b : JZ 0x0054d65d
0054d63d : MOV CL,byte ptr [ESI + 0x69]
0054d640 : AND CL,0x1
0054d643 : MOVZX EDX,CL
0054d646 : PUSH EDX
0054d647 : PUSH 0x1
0054d649 : PUSH EAX
0054d64a : MOV ECX,ESI
0054d64c : CALL 0x0054d2b0
0054d651 : MOV EAX,dword ptr [ESI + 0x18]
0054d654 : MOV ECX,dword ptr [ESI + 0x8]
0054d657 : PUSH EAX
0054d658 : CALL 0x00545100
0054d65d : MOVZX EAX,word ptr [ESI + 0x68]
0054d661 : MOV CL,AL
0054d663 : SHR CL,0x1
0054d665 : TEST CL,0x1
0054d668 : JZ 0x0054d6c5
0054d66a : CMP byte ptr [ESP + 0x10],0x0
0054d66f : JZ 0x0054d6b8
0054d671 : MOV DL,AL
0054d673 : SHR DL,0x6
0054d676 : TEST DL,0x1
0054d679 : JNZ 0x0054d69e
0054d67b : SHR AL,0x5
0054d67e : TEST AL,0x1
0054d680 : JNZ 0x0054d69e
0054d682 : MOV ECX,dword ptr [ESI + 0x8]
0054d685 : MOV ESI,dword ptr [ESI + 0x18]
0054d688 : CMP dword ptr [ECX + 0x20],ESI
0054d68b : JNZ 0x0054d692
0054d68d : CMP dword ptr [ECX + 0x24],ESI
0054d690 : JZ 0x0054d6c5
0054d692 : PUSH ESI
0054d693 : PUSH ESI
0054d694 : CALL 0x00546be0
0054d699 : POP EDI
0054d69a : POP ESI
0054d69b : RET 0x8
0054d69e : MOV ECX,dword ptr [ESI + 0x8]
0054d6a1 : MOV ESI,dword ptr [ESI + 0x18]
0054d6a4 : CMP dword ptr [ECX + 0x24],ESI
0054d6a7 : JZ 0x0054d6c5
0054d6a9 : MOV EAX,dword ptr [ECX + 0x20]
0054d6ac : PUSH ESI
0054d6ad : PUSH EAX
0054d6ae : CALL 0x00546be0
0054d6b3 : POP EDI
0054d6b4 : POP ESI
0054d6b5 : RET 0x8
0054d6b8 : MOV EAX,dword ptr [ESI + 0x18]
0054d6bb : MOV ECX,dword ptr [ESI + 0x8]
0054d6be : PUSH EAX
0054d6bf : PUSH EAX
0054d6c0 : CALL 0x00546be0
0054d6c5 : POP EDI
0054d6c6 : POP ESI
0054d6c7 : RET 0x8

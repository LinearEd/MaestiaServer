PROGRAM  : Maestia.exe
FUNCTION : FUN_006ba390
ENTRY    : 006ba390
BODY     : [[006ba390, 006ba520]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006ba390(undefined4 param_1,int param_2,int param_3,int param_4,int param_5)

{
  int iVar1;
  int iVar2;
  int iVar3;
  undefined **ppuVar4;
  bool bVar5;
  bool bVar6;
  
  iVar3 = *(int *)(*(int *)(param_2 + 0x60) + 4);
  iVar1 = FUN_00686de0(iVar3,&DAT_00bd9350);
  if (iVar1 == 0) {
    return 2;
  }
  iVar2 = FUN_006877c0(param_1,0);
  if ((iVar2 == 0) &&
     (iVar2 = (**(code **)(iVar1 + 4))(param_1,param_2,param_3,param_4,param_5), iVar2 == 0)) {
    iVar2 = *(int *)(param_2 + 0x94);
    if ((iVar2 != 0x10000) && ((iVar2 != 0x20000 && (iVar2 != 0x74727565)))) {
      return 2;
    }
    *(uint *)(param_2 + 8) = *(uint *)(param_2 + 8) | 0x800;
    if (param_3 < 0) {
      return 0;
    }
    iVar2 = (**(code **)(iVar1 + 8))(param_1,param_2,param_3,param_4,param_5);
    if ((iVar2 == 0) && (iVar2 = FUN_006b26f0(param_2,param_1), iVar2 == 0)) {
      if (((*(byte *)(param_2 + 8) & 1) != 0) &&
         (((iVar2 = FUN_006b24b0(), iVar2 == 0 && (iVar2 = FUN_006b96a0(param_1), iVar2 == 0)) &&
          (iVar2 = FUN_006b2650(), iVar2 == 0)))) {
        iVar2 = FUN_006b26a0();
      }
      bVar5 = *(int *)(iVar3 + 0xb8) != 0;
      iVar3 = 0;
      if (0 < param_4) {
        do {
          if (*(char *)(param_2 + 0x2b4) != '\0') break;
          if (*(int *)(param_5 + iVar3 * 8) == 0x756e7061) {
            bVar5 = true;
          }
          iVar3 = iVar3 + 1;
        } while (iVar3 < param_4);
      }
      bVar6 = false;
      if (!bVar5) {
        ppuVar4 = &PTR_s_DFKaiSho_SB_00beb92c;
        do {
          if ((*(int *)(param_2 + 0x14) != 0) &&
             (iVar3 = FUN_00634e90(*(int *)(param_2 + 0x14),*ppuVar4), iVar3 != 0)) {
            bVar5 = true;
            break;
          }
          ppuVar4 = ppuVar4 + 1;
        } while (*ppuVar4 != (undefined *)0x0);
        bVar6 = !bVar5;
      }
      *(bool *)(*(int *)(param_2 + 0x80) + 0x34) = bVar6;
      FUN_006b3140();
    }
  }
  return iVar2;
}



============================================================
DISASSEMBLY
============================================================
006ba390 : PUSH EBX
006ba391 : PUSH EBP
006ba392 : PUSH ESI
006ba393 : MOV ESI,dword ptr [ESP + 0x14]
006ba397 : MOV EAX,dword ptr [ESI + 0x60]
006ba39a : MOV EAX,dword ptr [EAX + 0x4]
006ba39d : PUSH EDI
006ba39e : PUSH 0xbd9350
006ba3a3 : PUSH EAX
006ba3a4 : MOV dword ptr [ESP + 0x20],EAX
006ba3a8 : CALL 0x00686de0
006ba3ad : MOV EBX,EAX
006ba3af : ADD ESP,0x8
006ba3b2 : TEST EBX,EBX
006ba3b4 : JZ 0x006ba40d
006ba3b6 : MOV EDI,dword ptr [ESP + 0x14]
006ba3ba : PUSH 0x0
006ba3bc : PUSH EDI
006ba3bd : CALL 0x006877c0
006ba3c2 : MOV EBP,EAX
006ba3c4 : ADD ESP,0x8
006ba3c7 : TEST EBP,EBP
006ba3c9 : JNZ 0x006ba51a
006ba3cf : MOV ECX,dword ptr [ESP + 0x24]
006ba3d3 : MOV EDX,dword ptr [ESP + 0x20]
006ba3d7 : MOV EAX,dword ptr [ESP + 0x1c]
006ba3db : PUSH ECX
006ba3dc : MOV ECX,dword ptr [EBX + 0x4]
006ba3df : PUSH EDX
006ba3e0 : PUSH EAX
006ba3e1 : PUSH ESI
006ba3e2 : PUSH EDI
006ba3e3 : CALL ECX
006ba3e5 : MOV EBP,EAX
006ba3e7 : ADD ESP,0x14
006ba3ea : TEST EBP,EBP
006ba3ec : JNZ 0x006ba51a
006ba3f2 : MOV EAX,dword ptr [ESI + 0x94]
006ba3f8 : CMP EAX,0x10000
006ba3fd : JZ 0x006ba419
006ba3ff : CMP EAX,0x20000
006ba404 : JZ 0x006ba419
006ba406 : CMP EAX,0x74727565
006ba40b : JZ 0x006ba419
006ba40d : POP EDI
006ba40e : MOV EBP,0x2
006ba413 : POP ESI
006ba414 : MOV EAX,EBP
006ba416 : POP EBP
006ba417 : POP EBX
006ba418 : RET
006ba419 : MOV EAX,dword ptr [ESP + 0x1c]
006ba41d : OR dword ptr [ESI + 0x8],0x800
006ba424 : TEST EAX,EAX
006ba426 : JGE 0x006ba42f
006ba428 : POP EDI
006ba429 : POP ESI
006ba42a : POP EBP
006ba42b : XOR EAX,EAX
006ba42d : POP EBX
006ba42e : RET
006ba42f : MOV EDX,dword ptr [ESP + 0x24]
006ba433 : MOV ECX,dword ptr [ESP + 0x20]
006ba437 : PUSH EDX
006ba438 : MOV EDX,dword ptr [EBX + 0x8]
006ba43b : PUSH ECX
006ba43c : PUSH EAX
006ba43d : PUSH ESI
006ba43e : PUSH EDI
006ba43f : CALL EDX
006ba441 : MOV EBP,EAX
006ba443 : ADD ESP,0x14
006ba446 : TEST EBP,EBP
006ba448 : JNZ 0x006ba51a
006ba44e : PUSH EDI
006ba44f : PUSH ESI
006ba450 : CALL 0x006b26f0
006ba455 : MOV EBP,EAX
006ba457 : ADD ESP,0x8
006ba45a : TEST EBP,EBP
006ba45c : JNZ 0x006ba51a
006ba462 : TEST byte ptr [ESI + 0x8],0x1
006ba466 : JZ 0x006ba49a
006ba468 : MOV EAX,ESI
006ba46a : CALL 0x006b24b0
006ba46f : MOV EBP,EAX
006ba471 : TEST EBP,EBP
006ba473 : JNZ 0x006ba49a
006ba475 : PUSH EDI
006ba476 : CALL 0x006b96a0
006ba47b : MOV EBP,EAX
006ba47d : ADD ESP,0x4
006ba480 : TEST EBP,EBP
006ba482 : JNZ 0x006ba49a
006ba484 : MOV EAX,ESI
006ba486 : CALL 0x006b2650
006ba48b : MOV EBP,EAX
006ba48d : TEST EBP,EBP
006ba48f : JNZ 0x006ba49a
006ba491 : MOV EAX,ESI
006ba493 : CALL 0x006b26a0
006ba498 : MOV EBP,EAX
006ba49a : MOV EAX,dword ptr [ESP + 0x18]
006ba49e : CMP dword ptr [EAX + 0xb8],0x0
006ba4a5 : MOV ECX,dword ptr [ESP + 0x20]
006ba4a9 : SETNZ BL
006ba4ac : XOR EAX,EAX
006ba4ae : TEST ECX,ECX
006ba4b0 : JLE 0x006ba4d0
006ba4b2 : MOV DL,byte ptr [ESI + 0x2b4]
006ba4b8 : TEST DL,DL
006ba4ba : JNZ 0x006ba4d0
006ba4bc : MOV EDI,dword ptr [ESP + 0x24]
006ba4c0 : CMP dword ptr [EDI + EAX*0x8],0x756e7061
006ba4c7 : JNZ 0x006ba4cb
006ba4c9 : MOV BL,0x1
006ba4cb : INC EAX
006ba4cc : CMP EAX,ECX
006ba4ce : JL 0x006ba4b8
006ba4d0 : TEST BL,BL
006ba4d2 : JNZ 0x006ba507
006ba4d4 : CMP dword ptr [0x00beb92c],0x0
006ba4db : JZ 0x006ba505
006ba4dd : MOV EDI,0xbeb92c
006ba4e2 : MOV EAX,dword ptr [ESI + 0x14]
006ba4e5 : TEST EAX,EAX
006ba4e7 : JZ 0x006ba4f9
006ba4e9 : MOV ECX,dword ptr [EDI]
006ba4eb : PUSH ECX
006ba4ec : PUSH EAX
006ba4ed : CALL 0x00634e90
006ba4f2 : ADD ESP,0x8
006ba4f5 : TEST EAX,EAX
006ba4f7 : JNZ 0x006ba503
006ba4f9 : ADD EDI,0x4
006ba4fc : CMP dword ptr [EDI],0x0
006ba4ff : JNZ 0x006ba4e2
006ba501 : JMP 0x006ba505
006ba503 : MOV BL,0x1
006ba505 : TEST BL,BL
006ba507 : MOV EAX,dword ptr [ESI + 0x80]
006ba50d : SETZ DL
006ba510 : MOV byte ptr [EAX + 0x34],DL
006ba513 : MOV EAX,ESI
006ba515 : CALL 0x006b3140
006ba51a : POP EDI
006ba51b : POP ESI
006ba51c : MOV EAX,EBP
006ba51e : POP EBP
006ba51f : POP EBX
006ba520 : RET

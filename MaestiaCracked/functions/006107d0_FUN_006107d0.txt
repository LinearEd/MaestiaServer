PROGRAM  : Maestia.exe
FUNCTION : FUN_006107d0
ENTRY    : 006107d0
BODY     : [[006107d0, 0061091b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006107d0(void)

{
  int *piVar1;
  uint *puVar2;
  uint *puVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  undefined4 *in_ECX;
  int iVar7;
  undefined4 *puVar8;
  undefined4 *puVar9;
  uint uVar10;
  undefined4 local_1c [4];
  undefined4 local_c;
  undefined4 local_8;
  undefined4 local_4;
  
  piVar1 = in_ECX + 5;
  puVar2 = in_ECX + 0x11;
  in_ECX[9] = 0;
  in_ECX[0xd] = 0;
  *puVar2 = 0;
  if (*piVar1 != 0) {
    FUN_0060ffa0(piVar1,0,*piVar1,&LAB_0060ff10);
    uVar10 = *piVar1 - 1;
    in_ECX[3] = *(undefined4 *)(*(int *)(in_ECX[8] + (uVar10 >> 8) * 4) + (uVar10 & 0xff) * 0xc);
    in_ECX[4] = *(undefined4 *)(*(int *)(in_ECX[8] + (uVar10 >> 8) * 4) + 4 + (uVar10 & 0xff) * 0xc)
    ;
    in_ECX[2] = 0;
    do {
      uVar10 = in_ECX[2];
      *puVar2 = 0;
      local_1c[0] = 0;
      local_1c[1] = 0;
      local_1c[2] = *in_ECX;
      local_1c[3] = in_ECX[1];
      local_c = 0xffffffff;
      local_8 = 0xffffffff;
      local_4 = 0xffffffff;
      if (in_ECX[0x12] == 0) {
        FUN_0060ff30(0);
      }
      puVar8 = local_1c;
      puVar9 = (undefined4 *)(*(int *)in_ECX[0x14] + (*puVar2 & 0xff) * 0x1c);
      for (iVar7 = 7; iVar7 != 0; iVar7 = iVar7 + -1) {
        *puVar9 = *puVar8;
        puVar8 = puVar8 + 1;
        puVar9 = puVar9 + 1;
      }
      *puVar2 = *puVar2 + 1;
      FUN_006106f0(0,0);
      if (uVar10 < (uint)in_ECX[2]) {
        iVar7 = in_ECX[9];
        FUN_00610650();
        iVar4 = in_ECX[9];
        puVar3 = in_ECX + 0xd;
        uVar10 = (uint)in_ECX[0xd] >> 4;
        if ((uint)in_ECX[0xe] <= uVar10) {
          FUN_00610b80(uVar10);
        }
        uVar5 = *puVar3;
        iVar6 = *(int *)(in_ECX[0x10] + uVar10 * 4);
        *(int *)(iVar6 + (uVar5 & 0xf) * 8) = iVar7;
        *(int *)(iVar6 + 4 + (uVar5 & 0xf) * 8) = iVar4 - iVar7;
        *puVar3 = *puVar3 + 1;
      }
    } while ((uint)in_ECX[2] < (uint)in_ECX[5]);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
006107d0 : SUB ESP,0x28
006107d3 : PUSH EBX
006107d4 : PUSH EBP
006107d5 : MOV EBX,ECX
006107d7 : PUSH ESI
006107d8 : PUSH EDI
006107d9 : XOR EDI,EDI
006107db : LEA ESI,[EBX + 0x14]
006107de : LEA EBP,[EBX + 0x44]
006107e1 : MOV dword ptr [EBX + 0x24],EDI
006107e4 : MOV dword ptr [EBX + 0x34],EDI
006107e7 : MOV dword ptr [EBP],EDI
006107ea : CMP dword ptr [ESI],EDI
006107ec : JZ 0x00610914
006107f2 : MOV EAX,dword ptr [ESI]
006107f4 : PUSH 0x60ff10
006107f9 : PUSH EAX
006107fa : PUSH EDI
006107fb : PUSH ESI
006107fc : CALL 0x0060ffa0
00610801 : MOV ESI,dword ptr [ESI]
00610803 : MOV EDX,dword ptr [EBX + 0x20]
00610806 : LEA EAX,[ESI + -0x1]
00610809 : MOV ESI,EAX
0061080b : MOV ECX,EAX
0061080d : AND ECX,0xff
00610813 : SHR ESI,0x8
00610816 : MOV ESI,dword ptr [EDX + ESI*0x4]
00610819 : LEA ECX,[ECX + ECX*0x2]
0061081c : MOV ECX,dword ptr [ESI + ECX*0x4]
0061081f : MOV dword ptr [EBX + 0xc],ECX
00610822 : MOV ECX,EAX
00610824 : SHR ECX,0x8
00610827 : MOV ECX,dword ptr [EDX + ECX*0x4]
0061082a : ADD ESP,0x10
0061082d : AND EAX,0xff
00610832 : LEA EAX,[EAX + EAX*0x2]
00610835 : MOV EDX,dword ptr [ECX + EAX*0x4 + 0x4]
00610839 : MOV dword ptr [EBX + 0x10],EDX
0061083c : MOV dword ptr [EBX + 0x8],EDI
0061083f : JMP 0x00610843
00610841 : XOR EDI,EDI
00610843 : MOV EAX,dword ptr [EBX + 0x8]
00610846 : MOV ECX,dword ptr [EBX]
00610848 : MOV EDX,dword ptr [EBX + 0x4]
0061084b : MOV ESI,EDI
0061084d : MOV dword ptr [ESP + 0x10],EAX
00610851 : OR EAX,0xffffffff
00610854 : SHR ESI,0x8
00610857 : MOV dword ptr [EBP],EDI
0061085a : MOV dword ptr [ESP + 0x1c],EDI
0061085e : MOV dword ptr [ESP + 0x20],EDI
00610862 : MOV dword ptr [ESP + 0x24],ECX
00610866 : MOV dword ptr [ESP + 0x28],EDX
0061086a : MOV dword ptr [ESP + 0x2c],EAX
0061086e : MOV dword ptr [ESP + 0x30],EAX
00610872 : MOV dword ptr [ESP + 0x34],EAX
00610876 : CMP ESI,dword ptr [EBP + 0x4]
00610879 : JC 0x00610883
0061087b : PUSH ESI
0061087c : MOV ECX,EBP
0061087e : CALL 0x0060ff30
00610883 : MOV EAX,dword ptr [EBP]
00610886 : MOV ECX,dword ptr [EBP + 0xc]
00610889 : AND EAX,0xff
0061088e : LEA EDX,[EAX*0x8 + 0x0]
00610895 : SUB EDX,EAX
00610897 : MOV EAX,dword ptr [ECX + ESI*0x4]
0061089a : LEA EDI,[EAX + EDX*0x4]
0061089d : MOV ECX,0x7
006108a2 : LEA ESI,[ESP + 0x1c]
006108a6 : MOVSD.REP ES:EDI,ESI
006108a8 : INC dword ptr [EBP]
006108ab : PUSH 0x0
006108ad : PUSH 0x0
006108af : MOV ECX,EBX
006108b1 : CALL 0x006106f0
006108b6 : MOV ECX,dword ptr [ESP + 0x10]
006108ba : CMP dword ptr [EBX + 0x8],ECX
006108bd : JBE 0x00610908
006108bf : MOV ESI,dword ptr [EBX + 0x24]
006108c2 : MOV ECX,EBX
006108c4 : MOV dword ptr [ESP + 0x14],ESI
006108c8 : CALL 0x00610650
006108cd : MOV ECX,dword ptr [EBX + 0x24]
006108d0 : MOV EDI,dword ptr [EBX + 0x34]
006108d3 : SUB ECX,ESI
006108d5 : LEA ESI,[EBX + 0x34]
006108d8 : SHR EDI,0x4
006108db : MOV dword ptr [ESP + 0x18],ECX
006108df : CMP EDI,dword ptr [ESI + 0x4]
006108e2 : JC 0x006108f0
006108e4 : PUSH EDI
006108e5 : MOV ECX,ESI
006108e7 : CALL 0x00610b80
006108ec : MOV ECX,dword ptr [ESP + 0x18]
006108f0 : MOV EDX,dword ptr [ESI + 0xc]
006108f3 : MOV EAX,dword ptr [ESI]
006108f5 : MOV EDI,dword ptr [EDX + EDI*0x4]
006108f8 : MOV EDX,dword ptr [ESP + 0x14]
006108fc : AND EAX,0xf
006108ff : MOV dword ptr [EDI + EAX*0x8],EDX
00610902 : MOV dword ptr [EDI + EAX*0x8 + 0x4],ECX
00610906 : INC dword ptr [ESI]
00610908 : MOV EAX,dword ptr [EBX + 0x8]
0061090b : CMP EAX,dword ptr [EBX + 0x14]
0061090e : JC 0x00610841
00610914 : POP EDI
00610915 : POP ESI
00610916 : POP EBP
00610917 : POP EBX
00610918 : ADD ESP,0x28
0061091b : RET

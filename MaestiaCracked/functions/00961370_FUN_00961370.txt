PROGRAM  : Maestia.exe
FUNCTION : FUN_00961370
ENTRY    : 00961370
BODY     : [[00961370, 009618f4] [009618f7, 00961953]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00961370(int param_1,undefined4 param_2)

{
  short sVar1;
  wchar_t wVar2;
  ulonglong uVar3;
  void *pvVar4;
  undefined1 uVar5;
  undefined1 uVar6;
  char cVar7;
  short ****ppppsVar8;
  int iVar9;
  int *packet;
  undefined4 uVar10;
  wchar_t *pwVar11;
  wchar_t *pwVar12;
  wchar_t *pwVar13;
  short ****ppppsVar14;
  bool bVar15;
  undefined1 auStack_8c [4];
  int *local_88;
  uint local_84;
  undefined1 local_80 [4];
  int local_7c;
  int local_78;
  undefined4 uStack_74;
  undefined1 local_70 [4];
  undefined2 local_6c;
  undefined4 local_5c;
  uint local_58;
  undefined1 local_54 [4];
  undefined2 local_50;
  undefined4 local_40;
  uint local_3c;
  short ***local_34 [4];
  undefined4 uStack_24;
  uint local_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  int local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b4055c;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_8c;
  ExceptionList = &local_14;
  FUN_00403dd0(param_2,DAT_00d66fa0 ^ (uint)&stack0xffffff68);
  local_c = 0;
  local_3c = 7;
  local_40 = 0;
  local_50 = 0;
  FUN_00406360(&DAT_00c79968,1);
  local_c._0_1_ = 1;
  ppppsVar14 = (short ****)local_34[0];
  if (local_20 < 8) {
    ppppsVar14 = local_34;
  }
  local_58 = 7;
  local_5c = 0;
  local_6c = 0;
  ppppsVar8 = ppppsVar14;
  do {
    sVar1 = *(short *)ppppsVar8;
    ppppsVar8 = (short ****)((int)ppppsVar8 + 2);
  } while (sVar1 != 0);
  FUN_00406360(ppppsVar14,(int)ppppsVar8 - (int)((int)ppppsVar14 + 2) >> 1);
  local_c._0_1_ = 2;
  FUN_0070cd60(local_80,local_70,local_54,0);
  pvVar4 = ThreadLocalStoragePointer;
  local_c = CONCAT31(local_c._1_3_,4);
  if (7 < local_58) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_58 = 7;
  local_5c = 0;
  local_6c = 0;
  local_c._0_1_ = 5;
  uVar5 = (undefined1)local_c;
  local_c._0_1_ = 5;
  if (7 < local_3c) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_50 = 0;
  local_84 = *(uint *)(param_1 + 0x18);
  local_3c = 7;
  local_40 = 0;
  pwVar11 = (wchar_t *)(param_1 + 4);
  pwVar13 = pwVar11;
  if (7 < local_84) {
    pwVar13 = *(wchar_t **)pwVar11;
  }
  pwVar12 = L"OnInit";
  do {
    wVar2 = *pwVar13;
    bVar15 = (ushort)wVar2 < (ushort)*pwVar12;
    if (wVar2 != *pwVar12) {
LAB_009614f6:
      iVar9 = (1 - (uint)bVar15) - (uint)(bVar15 != 0);
      goto LAB_009614fb;
    }
    if (wVar2 == L'\0') break;
    wVar2 = pwVar13[1];
    bVar15 = (ushort)wVar2 < (ushort)pwVar12[1];
    if (wVar2 != pwVar12[1]) goto LAB_009614f6;
    pwVar13 = pwVar13 + 2;
    pwVar12 = pwVar12 + 2;
  } while (wVar2 != L'\0');
  iVar9 = 0;
LAB_009614fb:
  if (iVar9 == 0) {
    (**(code **)(*local_88 + 0x48))();
  }
  else {
    pwVar13 = pwVar11;
    if (7 < local_84) {
      pwVar13 = *(wchar_t **)pwVar11;
    }
    pwVar12 = L"Select";
    do {
      wVar2 = *pwVar13;
      bVar15 = (ushort)wVar2 < (ushort)*pwVar12;
      if (wVar2 != *pwVar12) {
LAB_00961547:
        iVar9 = (1 - (uint)bVar15) - (uint)(bVar15 != 0);
        goto LAB_0096154c;
      }
      if (wVar2 == L'\0') break;
      wVar2 = pwVar13[1];
      bVar15 = (ushort)wVar2 < (ushort)pwVar12[1];
      if (wVar2 != pwVar12[1]) goto LAB_00961547;
      pwVar13 = pwVar13 + 2;
      pwVar12 = pwVar12 + 2;
    } while (wVar2 != L'\0');
    iVar9 = 0;
LAB_0096154c:
    if (iVar9 == 0) {
      iVar9 = local_78 - local_7c >> 0x1f;
      if ((local_78 - local_7c) / 0x1c + iVar9 == iVar9) {
LAB_009615d4:
        local_c = (uint)local_c._1_3_ << 8;
        FUN_004042c0();
        local_c = 0xffffffff;
        FUN_00406560();
        goto LAB_00961931;
      }
      if (*(uint *)(local_7c + 0x18) < 8) {
        iVar9 = local_7c + 4;
      }
      else {
        iVar9 = *(int *)(local_7c + 4);
      }
      iVar9 = FUN_00634f4d(iVar9);
      if (iVar9 == -1) {
        iVar9 = *DAT_00da9894;
        if ((iVar9 != 0) && (*(int *)(iVar9 + 0x114) != 0)) {
          (**(code **)**(undefined4 **)(iVar9 + 0x114))("NpcTalkSelectClearTxtButton");
        }
        if (*(int *)(DAT_0172490c + 8) != 2) {
          if (*(int *)(DAT_0172490c + 8) != 0) {
            FUN_008444f0();
          }
          goto LAB_009615d4;
        }
      }
      if (*(uint *)(local_7c + 0x18) < 8) {
LAB_0096185f:
        iVar9 = local_7c + 4;
      }
      else {
        iVar9 = *(int *)(local_7c + 4);
      }
LAB_00961862:
      uVar10 = FUN_00634f4d(iVar9);
      (**(code **)(*local_88 + 0x4c))(uVar10);
    }
    else {
      pwVar13 = pwVar11;
      if (7 < local_84) {
        pwVar13 = *(wchar_t **)pwVar11;
      }
      pwVar12 = L"Skip";
      do {
        wVar2 = *pwVar13;
        bVar15 = (ushort)wVar2 < (ushort)*pwVar12;
        if (wVar2 != *pwVar12) {
LAB_0096164b:
          iVar9 = (1 - (uint)bVar15) - (uint)(bVar15 != 0);
          goto LAB_00961650;
        }
        if (wVar2 == L'\0') break;
        wVar2 = pwVar13[1];
        bVar15 = (ushort)wVar2 < (ushort)pwVar12[1];
        if (wVar2 != pwVar12[1]) goto LAB_0096164b;
        pwVar13 = pwVar13 + 2;
        pwVar12 = pwVar12 + 2;
      } while (wVar2 != L'\0');
      iVar9 = 0;
LAB_00961650:
      if (iVar9 == 0) {
        *(undefined4 *)(DAT_0172490c + 0x44) = 0;
        iVar9 = *(int *)pvVar4;
        uVar3 = (ulonglong)(*(byte *)(iVar9 + 0x18) + 1) % 3;
        local_88 = (int *)((int)uVar3 * 0x2000 + 0x122cb8 + iVar9);
        *(char *)(iVar9 + 0x18) = (char)uVar3;
        if (local_88 == (int *)0x0) {
          packet = (int *)0x0;
        }
        else {
          *(undefined2 *)local_88 = 0;
          *(undefined1 *)((int)local_88 + 2) = 0x3e;
          *(undefined1 *)((int)local_88 + 3) = 0x20;
          packet = local_88;
        }
        local_c._0_1_ = 5;
        if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
          FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),4,(uint8_t *)packet);
        }
        iVar9 = *DAT_00da9894;
        if ((iVar9 != 0) && (*(int *)(iVar9 + 0x114) != 0)) {
          (**(code **)(**(int **)(iVar9 + 0x114) + 4))
                    (*(int **)(iVar9 + 0x114),"SetSkipButton",&DAT_00c799b4,0);
        }
      }
      else {
        pwVar13 = pwVar11;
        if (7 < local_84) {
          pwVar13 = *(wchar_t **)pwVar11;
        }
        pwVar12 = L"Close";
        do {
          wVar2 = *pwVar13;
          bVar15 = (ushort)wVar2 < (ushort)*pwVar12;
          if (wVar2 != *pwVar12) {
LAB_00961746:
            iVar9 = (1 - (uint)bVar15) - (uint)(bVar15 != 0);
            goto LAB_0096174b;
          }
          if (wVar2 == L'\0') break;
          wVar2 = pwVar13[1];
          bVar15 = (ushort)wVar2 < (ushort)pwVar12[1];
          if (wVar2 != pwVar12[1]) goto LAB_00961746;
          pwVar13 = pwVar13 + 2;
          pwVar12 = pwVar12 + 2;
        } while (wVar2 != L'\0');
        iVar9 = 0;
LAB_0096174b:
        if (iVar9 != 0) {
          pwVar13 = pwVar11;
          if (7 < local_84) {
            pwVar13 = *(wchar_t **)pwVar11;
          }
          pwVar12 = L"Pre";
          do {
            wVar2 = *pwVar13;
            bVar15 = (ushort)wVar2 < (ushort)*pwVar12;
            if (wVar2 != *pwVar12) {
LAB_009617d6:
              iVar9 = (1 - (uint)bVar15) - (uint)(bVar15 != 0);
              goto LAB_009617db;
            }
            if (wVar2 == L'\0') break;
            wVar2 = pwVar13[1];
            bVar15 = (ushort)wVar2 < (ushort)pwVar12[1];
            if (wVar2 != pwVar12[1]) goto LAB_009617d6;
            pwVar13 = pwVar13 + 2;
            pwVar12 = pwVar12 + 2;
          } while (wVar2 != L'\0');
          iVar9 = 0;
LAB_009617db:
          if (iVar9 == 0) {
            local_c._0_1_ = uVar5;
            cVar7 = FUN_004014c0();
            if (cVar7 != '\0') goto LAB_009615d4;
            if (7 < *(uint *)(local_7c + 0x18)) {
              iVar9 = *(int *)(local_7c + 4);
              goto LAB_00961862;
            }
            goto LAB_0096185f;
          }
          pwVar13 = pwVar11;
          if (7 < local_84) {
            pwVar13 = *(wchar_t **)pwVar11;
          }
          pwVar12 = L"Next";
          do {
            wVar2 = *pwVar13;
            bVar15 = (ushort)wVar2 < (ushort)*pwVar12;
            if (wVar2 != *pwVar12) {
LAB_00961836:
              iVar9 = (1 - (uint)bVar15) - (uint)(bVar15 != 0);
              goto LAB_0096183b;
            }
            if (wVar2 == L'\0') break;
            wVar2 = pwVar13[1];
            bVar15 = (ushort)wVar2 < (ushort)pwVar12[1];
            if (wVar2 != pwVar12[1]) goto LAB_00961836;
            pwVar13 = pwVar13 + 2;
            pwVar12 = pwVar12 + 2;
          } while (wVar2 != L'\0');
          iVar9 = 0;
LAB_0096183b:
          if (iVar9 != 0) {
            if (7 < local_84) {
              pwVar11 = *(wchar_t **)pwVar11;
            }
            pwVar13 = L"OnLClick";
            do {
              wVar2 = *pwVar11;
              bVar15 = (ushort)wVar2 < (ushort)*pwVar13;
              if (wVar2 != *pwVar13) {
LAB_009618b6:
                iVar9 = (1 - (uint)bVar15) - (uint)(bVar15 != 0);
                goto LAB_009618bb;
              }
              if (wVar2 == L'\0') break;
              wVar2 = pwVar11[1];
              bVar15 = (ushort)wVar2 < (ushort)pwVar13[1];
              if (wVar2 != pwVar13[1]) goto LAB_009618b6;
              pwVar11 = pwVar11 + 2;
              pwVar13 = pwVar13 + 2;
            } while (wVar2 != L'\0');
            iVar9 = 0;
LAB_009618bb:
            if (iVar9 == 0) {
              local_c._0_1_ = uVar5;
              FUN_00844350(DAT_0172490c);
            }
            goto LAB_009618cb;
          }
          local_c._0_1_ = uVar5;
          cVar7 = FUN_004014c0();
          if (cVar7 != '\0') goto LAB_009615d4;
          if (*(uint *)(local_7c + 0x18) < 8) goto LAB_0096185f;
          iVar9 = *(int *)(local_7c + 4);
          goto LAB_00961862;
        }
        iVar9 = *DAT_00da9894;
        uVar6 = uVar5;
        if ((iVar9 != 0) && (uVar6 = (undefined1)local_c, *(int *)(iVar9 + 0x114) != 0)) {
          local_c._0_1_ = uVar5;
          (**(code **)**(undefined4 **)(iVar9 + 0x114))("NpcTalkSelectClearTxtButton");
          uVar6 = (undefined1)local_c;
        }
        local_c._0_1_ = uVar6;
        if ((*(int *)(DAT_0172490c + 8) != 2) && (*(int *)(DAT_0172490c + 8) != 0)) {
          FUN_008444f0();
        }
      }
    }
  }
LAB_009618cb:
  local_c = (uint)local_c._1_3_ << 8;
  if (local_7c != 0) {
    FUN_00405450(local_88);
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_7c = 0;
  local_78 = 0;
  uStack_74 = 0;
  local_c = 0xffffffff;
  if (7 < local_20) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_20 = 7;
  uStack_24 = 0;
  local_34[0] = (short ***)((uint)local_34[0] & 0xffff0000);
LAB_00961931:
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_8c);
  return;
}



============================================================
DISASSEMBLY
============================================================
00961370 : PUSH EBP
00961371 : MOV EBP,ESP
00961373 : AND ESP,0xfffffff8
00961376 : PUSH -0x1
00961378 : PUSH 0xb4055c
0096137d : MOV EAX,FS:[0x0]
00961383 : PUSH EAX
00961384 : SUB ESP,0x78
00961387 : MOV EAX,[0x00d66fa0]
0096138c : XOR EAX,ESP
0096138e : MOV dword ptr [ESP + 0x70],EAX
00961392 : PUSH EBX
00961393 : PUSH ESI
00961394 : PUSH EDI
00961395 : MOV EAX,[0x00d66fa0]
0096139a : XOR EAX,ESP
0096139c : PUSH EAX
0096139d : LEA EAX,[ESP + 0x88]
009613a4 : MOV FS:[0x0],EAX
009613aa : MOV EAX,dword ptr [EBP + 0xc]
009613ad : PUSH EAX
009613ae : LEA ESI,[ESP + 0x68]
009613b2 : MOV dword ptr [ESP + 0x18],ECX
009613b6 : CALL 0x00403dd0
009613bb : ADD ESP,0x4
009613be : XOR EDI,EDI
009613c0 : MOV dword ptr [ESP + 0x90],EDI
009613c7 : PUSH 0x1
009613c9 : XOR EAX,EAX
009613cb : MOV ESI,0x7
009613d0 : PUSH 0xc79968
009613d5 : LEA ECX,[ESP + 0x50]
009613d9 : MOV dword ptr [ESP + 0x68],ESI
009613dd : MOV dword ptr [ESP + 0x64],EDI
009613e1 : MOV word ptr [ESP + 0x54],AX
009613e6 : CALL 0x00406360
009613eb : MOV byte ptr [ESP + 0x90],0x1
009613f3 : MOV EDX,dword ptr [ESP + 0x68]
009613f7 : MOV EBX,0x8
009613fc : CMP dword ptr [ESP + 0x7c],EBX
00961400 : JNC 0x00961406
00961402 : LEA EDX,[ESP + 0x68]
00961406 : XOR ECX,ECX
00961408 : MOV EAX,EDX
0096140a : MOV dword ptr [ESP + 0x44],ESI
0096140e : MOV dword ptr [ESP + 0x40],EDI
00961412 : MOV word ptr [ESP + 0x30],CX
00961417 : LEA ESI,[EAX + 0x2]
0096141a : LEA EBX,[EBX]
00961420 : MOV CX,word ptr [EAX]
00961423 : ADD EAX,0x2
00961426 : CMP CX,DI
00961429 : JNZ 0x00961420
0096142b : SUB EAX,ESI
0096142d : SAR EAX,0x1
0096142f : PUSH EAX
00961430 : PUSH EDX
00961431 : LEA ECX,[ESP + 0x34]
00961435 : CALL 0x00406360
0096143a : MOV byte ptr [ESP + 0x90],0x2
00961442 : PUSH EDI
00961443 : LEA EDX,[ESP + 0x4c]
00961447 : PUSH EDX
00961448 : LEA EAX,[ESP + 0x34]
0096144c : PUSH EAX
0096144d : LEA ECX,[ESP + 0x28]
00961451 : PUSH ECX
00961452 : CALL 0x0070cd60
00961457 : ADD ESP,0x10
0096145a : MOV byte ptr [ESP + 0x90],0x4
00961462 : CMP dword ptr [ESP + 0x44],EBX
00961466 : JC 0x00961471
00961468 : MOV ECX,dword ptr [ESP + 0x30]
0096146c : CALL 0x006f04e0
00961471 : MOV ESI,0x7
00961476 : XOR EDX,EDX
00961478 : MOV dword ptr [ESP + 0x44],ESI
0096147c : MOV dword ptr [ESP + 0x40],EDI
00961480 : MOV word ptr [ESP + 0x30],DX
00961485 : MOV BL,0x5
00961487 : MOV byte ptr [ESP + 0x90],BL
0096148e : CMP dword ptr [ESP + 0x60],0x8
00961493 : JC 0x0096149e
00961495 : MOV ECX,dword ptr [ESP + 0x4c]
00961499 : CALL 0x006f04e0
0096149e : XOR EAX,EAX
009614a0 : MOV word ptr [ESP + 0x4c],AX
009614a5 : MOV EAX,dword ptr [EBP + 0x8]
009614a8 : MOV ECX,dword ptr [EAX + 0x18]
009614ab : MOV dword ptr [ESP + 0x60],ESI
009614af : MOV dword ptr [ESP + 0x5c],EDI
009614b3 : MOV dword ptr [ESP + 0x18],ECX
009614b7 : LEA ESI,[EAX + 0x4]
009614ba : CMP ECX,0x8
009614bd : JC 0x009614c3
009614bf : MOV EAX,dword ptr [ESI]
009614c1 : JMP 0x009614c5
009614c3 : MOV EAX,ESI
009614c5 : MOV ECX,0xc7996c
009614ca : LEA EBX,[EBX]
009614d0 : MOV DX,word ptr [EAX]
009614d3 : CMP DX,word ptr [ECX]
009614d6 : JNZ 0x009614f6
009614d8 : CMP DX,DI
009614db : JZ 0x009614f2
009614dd : MOV DX,word ptr [EAX + 0x2]
009614e1 : CMP DX,word ptr [ECX + 0x2]
009614e5 : JNZ 0x009614f6
009614e7 : ADD EAX,0x4
009614ea : ADD ECX,0x4
009614ed : CMP DX,DI
009614f0 : JNZ 0x009614d0
009614f2 : XOR EAX,EAX
009614f4 : JMP 0x009614fb
009614f6 : SBB EAX,EAX
009614f8 : SBB EAX,-0x1
009614fb : CMP EAX,EDI
009614fd : JNZ 0x0096150f
009614ff : MOV ECX,dword ptr [ESP + 0x14]
00961503 : MOV EDX,dword ptr [ECX]
00961505 : MOV EAX,dword ptr [EDX + 0x48]
00961508 : CALL EAX
0096150a : JMP 0x009618cb
0096150f : CMP dword ptr [ESP + 0x18],0x8
00961514 : JC 0x0096151a
00961516 : MOV EAX,dword ptr [ESI]
00961518 : JMP 0x0096151c
0096151a : MOV EAX,ESI
0096151c : MOV ECX,0xc7997c
00961521 : MOV DX,word ptr [EAX]
00961524 : CMP DX,word ptr [ECX]
00961527 : JNZ 0x00961547
00961529 : CMP DX,DI
0096152c : JZ 0x00961543
0096152e : MOV DX,word ptr [EAX + 0x2]
00961532 : CMP DX,word ptr [ECX + 0x2]
00961536 : JNZ 0x00961547
00961538 : ADD EAX,0x4
0096153b : ADD ECX,0x4
0096153e : CMP DX,DI
00961541 : JNZ 0x00961521
00961543 : XOR EAX,EAX
00961545 : JMP 0x0096154c
00961547 : SBB EAX,EAX
00961549 : SBB EAX,-0x1
0096154c : CMP EAX,EDI
0096154e : JNZ 0x00961613
00961554 : MOV ECX,dword ptr [ESP + 0x24]
00961558 : MOV ESI,dword ptr [ESP + 0x20]
0096155c : SUB ECX,ESI
0096155e : MOV EAX,0x92492493
00961563 : IMUL ECX
00961565 : ADD EDX,ECX
00961567 : SAR EDX,0x4
0096156a : MOV ECX,EDX
0096156c : SHR ECX,0x1f
0096156f : ADD ECX,EDX
00961571 : CMP ECX,0x1
00961574 : JC 0x009615d4
00961576 : MOV EBX,0x8
0096157b : CMP dword ptr [ESI + 0x18],EBX
0096157e : JC 0x00961585
00961580 : MOV ESI,dword ptr [ESI + 0x4]
00961583 : JMP 0x00961588
00961585 : ADD ESI,0x4
00961588 : PUSH ESI
00961589 : CALL 0x00634f4d
0096158e : ADD ESP,0x4
00961591 : CMP EAX,-0x1
00961594 : JNZ 0x009615fe
00961596 : MOV EDX,dword ptr [0x00da9894]
0096159c : MOV EAX,dword ptr [EDX]
0096159e : CMP EAX,EDI
009615a0 : JZ 0x009615bd
009615a2 : CMP dword ptr [EAX + 0x114],EDI
009615a8 : JZ 0x009615bd
009615aa : MOV EAX,dword ptr [EAX + 0x114]
009615b0 : MOV EDX,dword ptr [EAX]
009615b2 : MOV ECX,EAX
009615b4 : MOV EAX,dword ptr [EDX]
009615b6 : PUSH 0xc7998c
009615bb : CALL EAX
009615bd : MOV ECX,dword ptr [0x0172490c]
009615c3 : MOV EAX,dword ptr [ECX + 0x8]
009615c6 : CMP EAX,0x2
009615c9 : JZ 0x009615fe
009615cb : CMP EAX,EDI
009615cd : JZ 0x009615d4
009615cf : CALL 0x008444f0
009615d4 : MOV byte ptr [ESP + 0x90],0x0
009615dc : LEA ESI,[ESP + 0x1c]
009615e0 : CALL 0x004042c0
009615e5 : MOV dword ptr [ESP + 0x90],0xffffffff
009615f0 : LEA ECX,[ESP + 0x64]
009615f4 : CALL 0x00406560
009615f9 : JMP 0x00961931
009615fe : MOV EAX,dword ptr [ESP + 0x20]
00961602 : CMP dword ptr [EAX + 0x18],EBX
00961605 : JC 0x0096185f
0096160b : MOV EAX,dword ptr [EAX + 0x4]
0096160e : JMP 0x00961862
00961613 : CMP dword ptr [ESP + 0x18],0x8
00961618 : JC 0x0096161e
0096161a : MOV EAX,dword ptr [ESI]
0096161c : JMP 0x00961620
0096161e : MOV EAX,ESI
00961620 : MOV ECX,0xc799a8
00961625 : MOV DX,word ptr [EAX]
00961628 : CMP DX,word ptr [ECX]
0096162b : JNZ 0x0096164b
0096162d : CMP DX,DI
00961630 : JZ 0x00961647
00961632 : MOV DX,word ptr [EAX + 0x2]
00961636 : CMP DX,word ptr [ECX + 0x2]
0096163a : JNZ 0x0096164b
0096163c : ADD EAX,0x4
0096163f : ADD ECX,0x4
00961642 : CMP DX,DI
00961645 : JNZ 0x00961625
00961647 : XOR EAX,EAX
00961649 : JMP 0x00961650
0096164b : SBB EAX,EAX
0096164d : SBB EAX,-0x1
00961650 : CMP EAX,EDI
00961652 : JNZ 0x0096170b
00961658 : MOV ECX,dword ptr [0x0172490c]
0096165e : MOV EDX,dword ptr FS:[0x2c]
00961665 : MOV dword ptr [ECX + 0x44],EDI
00961668 : MOV ECX,dword ptr [EDX]
0096166a : MOVZX EAX,byte ptr [ECX + 0x18]
0096166e : INC EAX
0096166f : CDQ
00961670 : MOV ESI,0x3
00961675 : IDIV ESI
00961677 : MOVZX EAX,DL
0096167a : SHL EAX,0xd
0096167d : LEA EAX,[EAX + ECX*0x1 + 0x122cb8]
00961684 : MOV byte ptr [ECX + 0x18],DL
00961687 : MOV dword ptr [ESP + 0x14],EAX
0096168b : MOV byte ptr [ESP + 0x90],0x6
00961693 : CMP EAX,EDI
00961695 : JZ 0x009616a6
00961697 : XOR ECX,ECX
00961699 : MOV word ptr [EAX],CX
0096169c : MOV byte ptr [EAX + 0x2],0x3e
009616a0 : MOV byte ptr [EAX + 0x3],0x20
009616a4 : JMP 0x009616a8
009616a6 : XOR EAX,EAX
009616a8 : MOV byte ptr [ESP + 0x90],BL
009616af : MOV EDX,dword ptr [0x017247d4]
009616b5 : MOV ECX,dword ptr [EDX + 0x4]
009616b8 : CMP ECX,EDI
009616ba : JZ 0x009616ce
009616bc : CMP byte ptr [EDX + 0x8],0x0
009616c0 : JZ 0x009616ce
009616c2 : PUSH 0x4
009616c4 : PUSH ECX
009616c5 : MOV EDI,EAX
009616c7 : CALL 0x00a0dd40
009616cc : XOR EDI,EDI
009616ce : MOV EDX,dword ptr [0x00da9894]
009616d4 : MOV EAX,dword ptr [EDX]
009616d6 : CMP EAX,EDI
009616d8 : JZ 0x009618cb
009616de : CMP dword ptr [EAX + 0x114],EDI
009616e4 : JZ 0x009618cb
009616ea : MOV EAX,dword ptr [EAX + 0x114]
009616f0 : MOV ECX,dword ptr [EAX]
009616f2 : MOV EDX,dword ptr [ECX + 0x4]
009616f5 : PUSH EDI
009616f6 : PUSH 0xc799b4
009616fb : PUSH 0xc799b8
00961700 : PUSH EAX
00961701 : CALL EDX
00961703 : ADD ESP,0x10
00961706 : JMP 0x009618cb
0096170b : CMP dword ptr [ESP + 0x18],0x8
00961710 : JC 0x00961716
00961712 : MOV EAX,dword ptr [ESI]
00961714 : JMP 0x00961718
00961716 : MOV EAX,ESI
00961718 : MOV ECX,0xc799c8
0096171d : LEA ECX,[ECX]
00961720 : MOV DX,word ptr [EAX]
00961723 : CMP DX,word ptr [ECX]
00961726 : JNZ 0x00961746
00961728 : CMP DX,DI
0096172b : JZ 0x00961742
0096172d : MOV DX,word ptr [EAX + 0x2]
00961731 : CMP DX,word ptr [ECX + 0x2]
00961735 : JNZ 0x00961746
00961737 : ADD EAX,0x4
0096173a : ADD ECX,0x4
0096173d : CMP DX,DI
00961740 : JNZ 0x00961720
00961742 : XOR EAX,EAX
00961744 : JMP 0x0096174b
00961746 : SBB EAX,EAX
00961748 : SBB EAX,-0x1
0096174b : CMP EAX,EDI
0096174d : JNZ 0x00961799
0096174f : MOV EAX,[0x00da9894]
00961754 : MOV EAX,dword ptr [EAX]
00961756 : CMP EAX,EDI
00961758 : JZ 0x00961775
0096175a : CMP dword ptr [EAX + 0x114],EDI
00961760 : JZ 0x00961775
00961762 : MOV EAX,dword ptr [EAX + 0x114]
00961768 : MOV EDX,dword ptr [EAX]
0096176a : MOV ECX,EAX
0096176c : MOV EAX,dword ptr [EDX]
0096176e : PUSH 0xc799d4
00961773 : CALL EAX
00961775 : MOV ECX,dword ptr [0x0172490c]
0096177b : MOV EAX,dword ptr [ECX + 0x8]
0096177e : CMP EAX,0x2
00961781 : JZ 0x009618cb
00961787 : CMP EAX,EDI
00961789 : JZ 0x009618cb
0096178f : CALL 0x008444f0
00961794 : JMP 0x009618cb
00961799 : MOV EBX,dword ptr [ESP + 0x18]
0096179d : CMP EBX,0x8
009617a0 : JC 0x009617a6
009617a2 : MOV EAX,dword ptr [ESI]
009617a4 : JMP 0x009617a8
009617a6 : MOV EAX,ESI
009617a8 : MOV ECX,0xc799f0
009617ad : LEA ECX,[ECX]
009617b0 : MOV DX,word ptr [EAX]
009617b3 : CMP DX,word ptr [ECX]
009617b6 : JNZ 0x009617d6
009617b8 : CMP DX,DI
009617bb : JZ 0x009617d2
009617bd : MOV DX,word ptr [EAX + 0x2]
009617c1 : CMP DX,word ptr [ECX + 0x2]
009617c5 : JNZ 0x009617d6
009617c7 : ADD EAX,0x4
009617ca : ADD ECX,0x4
009617cd : CMP DX,DI
009617d0 : JNZ 0x009617b0
009617d2 : XOR EAX,EAX
009617d4 : JMP 0x009617db
009617d6 : SBB EAX,EAX
009617d8 : SBB EAX,-0x1
009617db : CMP EAX,EDI
009617dd : JNZ 0x009617ff
009617df : LEA EAX,[ESP + 0x1c]
009617e3 : CALL 0x004014c0
009617e8 : TEST AL,AL
009617ea : JNZ 0x009615d4
009617f0 : MOV EAX,dword ptr [ESP + 0x20]
009617f4 : CMP dword ptr [EAX + 0x18],0x8
009617f8 : JC 0x0096185f
009617fa : MOV EAX,dword ptr [EAX + 0x4]
009617fd : JMP 0x00961862
009617ff : CMP EBX,0x8
00961802 : JC 0x00961808
00961804 : MOV EAX,dword ptr [ESI]
00961806 : JMP 0x0096180a
00961808 : MOV EAX,ESI
0096180a : MOV ECX,0xc799f8
0096180f : NOP
00961810 : MOV DX,word ptr [EAX]
00961813 : CMP DX,word ptr [ECX]
00961816 : JNZ 0x00961836
00961818 : CMP DX,DI
0096181b : JZ 0x00961832
0096181d : MOV DX,word ptr [EAX + 0x2]
00961821 : CMP DX,word ptr [ECX + 0x2]
00961825 : JNZ 0x00961836
00961827 : ADD EAX,0x4
0096182a : ADD ECX,0x4
0096182d : CMP DX,DI
00961830 : JNZ 0x00961810
00961832 : XOR EAX,EAX
00961834 : JMP 0x0096183b
00961836 : SBB EAX,EAX
00961838 : SBB EAX,-0x1
0096183b : CMP EAX,EDI
0096183d : JNZ 0x00961879
0096183f : LEA EAX,[ESP + 0x1c]
00961843 : CALL 0x004014c0
00961848 : TEST AL,AL
0096184a : JNZ 0x009615d4
00961850 : MOV EAX,dword ptr [ESP + 0x20]
00961854 : CMP dword ptr [EAX + 0x18],0x8
00961858 : JC 0x0096185f
0096185a : MOV EAX,dword ptr [EAX + 0x4]
0096185d : JMP 0x00961862
0096185f : ADD EAX,0x4
00961862 : PUSH EAX
00961863 : CALL 0x00634f4d
00961868 : MOV ECX,dword ptr [ESP + 0x18]
0096186c : MOV EDX,dword ptr [ECX]
0096186e : ADD ESP,0x4
00961871 : PUSH EAX
00961872 : MOV EAX,dword ptr [EDX + 0x4c]
00961875 : CALL EAX
00961877 : JMP 0x009618cb
00961879 : CMP EBX,0x8
0096187c : JC 0x00961882
0096187e : MOV EAX,dword ptr [ESI]
00961880 : JMP 0x00961884
00961882 : MOV EAX,ESI
00961884 : MOV ECX,0xc79a04
00961889 : LEA ESP,[ESP]
00961890 : MOV DX,word ptr [EAX]
00961893 : CMP DX,word ptr [ECX]
00961896 : JNZ 0x009618b6
00961898 : CMP DX,DI
0096189b : JZ 0x009618b2
0096189d : MOV DX,word ptr [EAX + 0x2]
009618a1 : CMP DX,word ptr [ECX + 0x2]
009618a5 : JNZ 0x009618b6
009618a7 : ADD EAX,0x4
009618aa : ADD ECX,0x4
009618ad : CMP DX,DI
009618b0 : JNZ 0x00961890
009618b2 : XOR EAX,EAX
009618b4 : JMP 0x009618bb
009618b6 : SBB EAX,EAX
009618b8 : SBB EAX,-0x1
009618bb : CMP EAX,EDI
009618bd : JNZ 0x009618cb
009618bf : MOV ECX,dword ptr [0x0172490c]
009618c5 : PUSH ECX
009618c6 : CALL 0x00844350
009618cb : MOV byte ptr [ESP + 0x90],0x0
009618d3 : MOV EAX,dword ptr [ESP + 0x20]
009618d7 : CMP EAX,EDI
009618d9 : JZ 0x009618f7
009618db : MOV EDX,dword ptr [ESP + 0x14]
009618df : MOV EDI,dword ptr [ESP + 0x24]
009618e3 : PUSH EDX
009618e4 : CALL 0x00405450
009618e9 : MOV ECX,dword ptr [ESP + 0x24]
009618ed : ADD ESP,0x4
009618f0 : CALL 0x006f04e0
009618f7 : MOV dword ptr [ESP + 0x20],EDI
009618fb : MOV dword ptr [ESP + 0x24],EDI
009618ff : MOV dword ptr [ESP + 0x28],EDI
00961903 : MOV dword ptr [ESP + 0x90],0xffffffff
0096190e : CMP dword ptr [ESP + 0x7c],0x8
00961913 : JC 0x0096191e
00961915 : MOV ECX,dword ptr [ESP + 0x68]
00961919 : CALL 0x006f04e0
0096191e : XOR EAX,EAX
00961920 : MOV dword ptr [ESP + 0x7c],0x7
00961928 : MOV dword ptr [ESP + 0x78],EDI
0096192c : MOV word ptr [ESP + 0x68],AX
00961931 : MOV ECX,dword ptr [ESP + 0x88]
00961938 : MOV dword ptr FS:[0x0],ECX
0096193f : POP ECX
00961940 : POP EDI
00961941 : POP ESI
00961942 : POP EBX
00961943 : MOV ECX,dword ptr [ESP + 0x70]
00961947 : XOR ECX,ESP
00961949 : CALL 0x00633e6b
0096194e : MOV ESP,EBP
00961950 : POP EBP
00961951 : RET 0x8

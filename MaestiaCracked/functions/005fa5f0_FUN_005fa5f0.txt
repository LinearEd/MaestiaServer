PROGRAM  : Maestia.exe
FUNCTION : FUN_005fa5f0
ENTRY    : 005fa5f0
BODY     : [[005fa5f0, 005fa718]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005fa5f0(int param_1,uint param_2,int param_3,code *param_4)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  char cVar5;
  undefined4 *puVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  int iVar10;
  int iVar11;
  
  do {
    do {
      uVar8 = param_2;
      param_2 = uVar8 + 1;
      if (param_3 <= (int)param_2) {
        return;
      }
      iVar10 = (uVar8 >> 6) * 4;
      iVar11 = (uVar8 & 0x3f) * 0xc;
      cVar5 = (*param_4)(*(int *)(*(int *)(param_1 + 0xc) + (uVar8 + 1 >> 6) * 4) +
                         (uVar8 + 1 & 0x3f) * 0xc,
                         *(int *)(*(int *)(param_1 + 0xc) + iVar10) + iVar11);
    } while (cVar5 == '\0');
    uVar9 = uVar8 + 1;
    do {
      puVar6 = (undefined4 *)(*(int *)(*(int *)(param_1 + 0xc) + iVar10) + iVar11);
      iVar10 = *(int *)(*(int *)(param_1 + 0xc) + (uVar9 >> 6) * 4);
      uVar7 = uVar9 & 0x3f;
      uVar2 = *(undefined4 *)(iVar10 + 8 + uVar7 * 0xc);
      uVar3 = *(undefined4 *)(iVar10 + 4 + uVar7 * 0xc);
      puVar1 = (undefined4 *)(iVar10 + uVar7 * 0xc);
      uVar4 = *puVar1;
      *puVar1 = *puVar6;
      puVar1[1] = puVar6[1];
      puVar1[2] = puVar6[2];
      *puVar6 = uVar4;
      puVar6[1] = uVar3;
      puVar6[2] = uVar2;
      if ((int)uVar8 < 1) break;
      uVar8 = uVar8 - 1;
      iVar10 = (uVar8 >> 6) * 4;
      iVar11 = (uVar8 & 0x3f) * 0xc;
      uVar9 = uVar9 - 1;
      cVar5 = (*param_4)(*(int *)(*(int *)(param_1 + 0xc) + (uVar9 >> 6) * 4) + (uVar9 & 0x3f) * 0xc
                         ,*(int *)(*(int *)(param_1 + 0xc) + iVar10) + iVar11);
    } while (cVar5 != '\0');
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
005fa5f0 : SUB ESP,0x10
005fa5f3 : PUSH EBX
005fa5f4 : MOV EBX,dword ptr [ESP + 0x1c]
005fa5f8 : LEA EAX,[EBX + 0x1]
005fa5fb : CMP EAX,dword ptr [ESP + 0x20]
005fa5ff : MOV dword ptr [ESP + 0x1c],EAX
005fa603 : JGE 0x005fa714
005fa609 : PUSH EBP
005fa60a : PUSH ESI
005fa60b : PUSH EDI
005fa60c : LEA ESP,[ESP]
005fa610 : MOV EAX,dword ptr [ESP + 0x24]
005fa614 : MOV EDX,dword ptr [EAX + 0xc]
005fa617 : MOV ESI,EBX
005fa619 : MOV EDI,EBX
005fa61b : AND EDI,0x3f
005fa61e : SHR ESI,0x6
005fa621 : LEA EDI,[EDI + EDI*0x2]
005fa624 : LEA EAX,[EBX + 0x1]
005fa627 : MOV EBP,EAX
005fa629 : ADD ESI,ESI
005fa62b : ADD ESI,ESI
005fa62d : MOV ECX,dword ptr [EDX + ESI*0x1]
005fa630 : ADD EDI,EDI
005fa632 : AND EAX,0x3f
005fa635 : ADD EDI,EDI
005fa637 : SHR EBP,0x6
005fa63a : MOV EDX,dword ptr [EDX + EBP*0x4]
005fa63d : ADD ECX,EDI
005fa63f : LEA EAX,[EAX + EAX*0x2]
005fa642 : LEA EAX,[EDX + EAX*0x4]
005fa645 : PUSH ECX
005fa646 : PUSH EAX
005fa647 : CALL dword ptr [ESP + 0x38]
005fa64b : ADD ESP,0x8
005fa64e : TEST AL,AL
005fa650 : JZ 0x005fa6fc
005fa656 : LEA EBP,[EBX + 0x1]
005fa659 : LEA ESP,[ESP]
005fa660 : MOV EAX,dword ptr [ESP + 0x24]
005fa664 : MOV EDX,dword ptr [EAX + 0xc]
005fa667 : MOV EAX,dword ptr [EDX + ESI*0x1]
005fa66a : ADD EAX,EDI
005fa66c : MOV ESI,EBP
005fa66e : SHR ESI,0x6
005fa671 : MOV EDX,dword ptr [EDX + ESI*0x4]
005fa674 : MOV ECX,EBP
005fa676 : AND ECX,0x3f
005fa679 : LEA ECX,[ECX + ECX*0x2]
005fa67c : MOV EDI,dword ptr [EDX + ECX*0x4 + 0x8]
005fa680 : MOV ESI,dword ptr [EDX + ECX*0x4 + 0x4]
005fa684 : LEA ECX,[EDX + ECX*0x4]
005fa687 : MOV EDX,dword ptr [ECX]
005fa689 : MOV dword ptr [ESP + 0x1c],EDI
005fa68d : MOV EDI,dword ptr [EAX]
005fa68f : MOV dword ptr [ECX],EDI
005fa691 : MOV EDI,dword ptr [EAX + 0x4]
005fa694 : MOV dword ptr [ECX + 0x4],EDI
005fa697 : MOV EDI,dword ptr [EAX + 0x8]
005fa69a : MOV dword ptr [ECX + 0x8],EDI
005fa69d : MOV ECX,dword ptr [ESP + 0x1c]
005fa6a1 : MOV dword ptr [EAX],EDX
005fa6a3 : MOV dword ptr [EAX + 0x4],ESI
005fa6a6 : MOV dword ptr [EAX + 0x8],ECX
005fa6a9 : TEST EBX,EBX
005fa6ab : JLE 0x005fa6fc
005fa6ad : MOV EDX,dword ptr [ESP + 0x24]
005fa6b1 : MOV ECX,dword ptr [EDX + 0xc]
005fa6b4 : DEC EBX
005fa6b5 : MOV ESI,EBX
005fa6b7 : MOV EDI,EBX
005fa6b9 : AND EDI,0x3f
005fa6bc : SHR ESI,0x6
005fa6bf : LEA EDI,[EDI + EDI*0x2]
005fa6c2 : ADD ESI,ESI
005fa6c4 : ADD ESI,ESI
005fa6c6 : MOV EAX,dword ptr [ECX + ESI*0x1]
005fa6c9 : ADD EDI,EDI
005fa6cb : ADD EDI,EDI
005fa6cd : ADD EAX,EDI
005fa6cf : MOV dword ptr [ESP + 0x10],EAX
005fa6d3 : DEC EBP
005fa6d4 : MOV EDX,EBP
005fa6d6 : SHR EDX,0x6
005fa6d9 : MOV ECX,dword ptr [ECX + EDX*0x4]
005fa6dc : MOV EDX,dword ptr [ESP + 0x10]
005fa6e0 : MOV EAX,EBP
005fa6e2 : AND EAX,0x3f
005fa6e5 : LEA EAX,[EAX + EAX*0x2]
005fa6e8 : LEA EAX,[ECX + EAX*0x4]
005fa6eb : PUSH EDX
005fa6ec : PUSH EAX
005fa6ed : CALL dword ptr [ESP + 0x38]
005fa6f1 : ADD ESP,0x8
005fa6f4 : TEST AL,AL
005fa6f6 : JNZ 0x005fa660
005fa6fc : MOV EAX,dword ptr [ESP + 0x28]
005fa700 : MOV EBX,EAX
005fa702 : INC EAX
005fa703 : CMP EAX,dword ptr [ESP + 0x2c]
005fa707 : MOV dword ptr [ESP + 0x28],EAX
005fa70b : JL 0x005fa610
005fa711 : POP EDI
005fa712 : POP ESI
005fa713 : POP EBP
005fa714 : POP EBX
005fa715 : ADD ESP,0x10
005fa718 : RET

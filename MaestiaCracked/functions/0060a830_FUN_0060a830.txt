PROGRAM  : Maestia.exe
FUNCTION : FUN_0060a830
ENTRY    : 0060a830
BODY     : [[0060a830, 0060a949]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_0060a830(int param_1)

{
  uint *puVar1;
  undefined4 *in_ECX;
  undefined1 uVar2;
  uint uVar3;
  
  puVar1 = (uint *)*in_ECX;
  uVar3 = *puVar1 >> 0xc;
  uVar2 = (undefined1)(param_1 >> 4);
  if (param_1 + 0x800U < 0x1000) {
    if (puVar1[1] <= uVar3) {
      FUN_00609600(uVar3);
    }
    *(char *)((*puVar1 & 0xfff) + *(int *)(puVar1[3] + uVar3 * 4)) = (char)param_1 << 4;
    *puVar1 = *puVar1 + 1;
    puVar1 = (uint *)*in_ECX;
    uVar3 = *puVar1 >> 0xc;
    if (puVar1[1] <= uVar3) {
      FUN_00609600(uVar3);
    }
    *(undefined1 *)((*puVar1 & 0xfff) + *(int *)(puVar1[3] + uVar3 * 4)) = uVar2;
    *puVar1 = *puVar1 + 1;
    return 2;
  }
  if (puVar1[1] <= uVar3) {
    FUN_00609600(uVar3);
  }
  *(byte *)((*puVar1 & 0xfff) + *(int *)(puVar1[3] + uVar3 * 4)) = (char)param_1 << 4 | 1;
  *puVar1 = *puVar1 + 1;
  puVar1 = (uint *)*in_ECX;
  uVar3 = *puVar1 >> 0xc;
  if (puVar1[1] <= uVar3) {
    FUN_00609600(uVar3);
  }
  *(undefined1 *)((*puVar1 & 0xfff) + *(int *)(puVar1[3] + uVar3 * 4)) = uVar2;
  *puVar1 = *puVar1 + 1;
  puVar1 = (uint *)*in_ECX;
  uVar3 = *puVar1 >> 0xc;
  if (puVar1[1] <= uVar3) {
    FUN_00609600(uVar3);
  }
  *(char *)((*puVar1 & 0xfff) + *(int *)(puVar1[3] + uVar3 * 4)) = (char)(param_1 >> 0xc);
  *puVar1 = *puVar1 + 1;
  return 3;
}



============================================================
DISASSEMBLY
============================================================
0060a830 : PUSH EBX
0060a831 : MOV EBX,dword ptr [ESP + 0x8]
0060a835 : PUSH EBP
0060a836 : PUSH ESI
0060a837 : MOV EBP,ECX
0060a839 : MOV ESI,dword ptr [EBP]
0060a83c : PUSH EDI
0060a83d : MOV EDI,dword ptr [ESI]
0060a83f : LEA EAX,[EBX + 0x800]
0060a845 : SHR EDI,0xc
0060a848 : CMP EAX,0xfff
0060a84d : MOV AL,BL
0060a84f : JA 0x0060a8b2
0060a851 : SHL AL,0x4
0060a854 : MOV byte ptr [ESP + 0x14],AL
0060a858 : CMP EDI,dword ptr [ESI + 0x4]
0060a85b : JC 0x0060a869
0060a85d : PUSH EDI
0060a85e : MOV ECX,ESI
0060a860 : CALL 0x00609600
0060a865 : MOV AL,byte ptr [ESP + 0x14]
0060a869 : MOV EDX,dword ptr [ESI]
0060a86b : MOV ECX,dword ptr [ESI + 0xc]
0060a86e : MOV ECX,dword ptr [ECX + EDI*0x4]
0060a871 : AND EDX,0xfff
0060a877 : MOV byte ptr [EDX + ECX*0x1],AL
0060a87a : INC dword ptr [ESI]
0060a87c : MOV ESI,dword ptr [EBP]
0060a87f : MOV EDI,dword ptr [ESI]
0060a881 : SHR EDI,0xc
0060a884 : SAR EBX,0x4
0060a887 : CMP EDI,dword ptr [ESI + 0x4]
0060a88a : JC 0x0060a894
0060a88c : PUSH EDI
0060a88d : MOV ECX,ESI
0060a88f : CALL 0x00609600
0060a894 : MOV EDX,dword ptr [ESI + 0xc]
0060a897 : MOV EAX,dword ptr [ESI]
0060a899 : MOV ECX,dword ptr [EDX + EDI*0x4]
0060a89c : AND EAX,0xfff
0060a8a1 : MOV byte ptr [EAX + ECX*0x1],BL
0060a8a4 : INC dword ptr [ESI]
0060a8a6 : POP EDI
0060a8a7 : POP ESI
0060a8a8 : POP EBP
0060a8a9 : MOV EAX,0x2
0060a8ae : POP EBX
0060a8af : RET 0x4
0060a8b2 : SHL AL,0x4
0060a8b5 : OR AL,0x1
0060a8b7 : MOV byte ptr [ESP + 0x14],AL
0060a8bb : CMP EDI,dword ptr [ESI + 0x4]
0060a8be : JC 0x0060a8cc
0060a8c0 : PUSH EDI
0060a8c1 : MOV ECX,ESI
0060a8c3 : CALL 0x00609600
0060a8c8 : MOV AL,byte ptr [ESP + 0x14]
0060a8cc : MOV ECX,dword ptr [ESI]
0060a8ce : MOV EDX,dword ptr [ESI + 0xc]
0060a8d1 : MOV EDX,dword ptr [EDX + EDI*0x4]
0060a8d4 : AND ECX,0xfff
0060a8da : MOV byte ptr [ECX + EDX*0x1],AL
0060a8dd : INC dword ptr [ESI]
0060a8df : MOV ESI,dword ptr [EBP]
0060a8e2 : MOV EDI,dword ptr [ESI]
0060a8e4 : MOV EAX,EBX
0060a8e6 : SAR EAX,0x4
0060a8e9 : SHR EDI,0xc
0060a8ec : MOV byte ptr [ESP + 0x14],AL
0060a8f0 : CMP EDI,dword ptr [ESI + 0x4]
0060a8f3 : JC 0x0060a901
0060a8f5 : PUSH EDI
0060a8f6 : MOV ECX,ESI
0060a8f8 : CALL 0x00609600
0060a8fd : MOV AL,byte ptr [ESP + 0x14]
0060a901 : MOV EDX,dword ptr [ESI]
0060a903 : MOV ECX,dword ptr [ESI + 0xc]
0060a906 : MOV ECX,dword ptr [ECX + EDI*0x4]
0060a909 : AND EDX,0xfff
0060a90f : MOV byte ptr [EDX + ECX*0x1],AL
0060a912 : INC dword ptr [ESI]
0060a914 : MOV ESI,dword ptr [EBP]
0060a917 : MOV EDI,dword ptr [ESI]
0060a919 : SHR EDI,0xc
0060a91c : SAR EBX,0xc
0060a91f : CMP EDI,dword ptr [ESI + 0x4]
0060a922 : JC 0x0060a92c
0060a924 : PUSH EDI
0060a925 : MOV ECX,ESI
0060a927 : CALL 0x00609600
0060a92c : MOV EDX,dword ptr [ESI + 0xc]
0060a92f : MOV EAX,dword ptr [ESI]
0060a931 : MOV ECX,dword ptr [EDX + EDI*0x4]
0060a934 : AND EAX,0xfff
0060a939 : MOV byte ptr [EAX + ECX*0x1],BL
0060a93c : INC dword ptr [ESI]
0060a93e : POP EDI
0060a93f : POP ESI
0060a940 : POP EBP
0060a941 : MOV EAX,0x3
0060a946 : POP EBX
0060a947 : RET 0x4

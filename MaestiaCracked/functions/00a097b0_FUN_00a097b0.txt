PROGRAM  : Maestia.exe
FUNCTION : FUN_00a097b0
ENTRY    : 00a097b0
BODY     : [[00a097b0, 00a099e6]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a097b0(undefined4 param_1)

{
  undefined1 uVar1;
  uint uVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  int iVar5;
  undefined4 local_54;
  int local_50;
  undefined4 local_48;
  undefined4 local_38;
  uint local_34;
  undefined4 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b5e61b;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_14 = uVar2;
  FUN_00406360(&DAT_00caac90,0);
  iVar5 = DAT_00d7c54c;
  local_54 = param_1;
  FUN_004437f0(&local_54);
  if ((local_50 == *(int *)(iVar5 + 0x44)) || (iVar5 = *(int *)(local_50 + 0x10), iVar5 == 0))
  goto LAB_00a099cb;
  FUN_00824a20(DAT_0172491c,0);
  local_8 = 0;
  puVar4 = local_48;
  if (local_34 < 8) {
    puVar4 = &local_48;
  }
  uVar3 = FUN_00404750(L"`L@Y%s\n",puVar4,uVar2);
  local_8._0_1_ = 1;
  FUN_00405eb0(uVar3,0,0xffffffff);
  local_8._0_1_ = 0;
  uVar1 = (undefined1)local_8;
  local_8._0_1_ = 0;
  if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_18 = 7;
  local_1c = 0;
  local_2c = (undefined4 *)((uint)local_2c._2_2_ << 0x10);
  if (*(short *)(iVar5 + 4) == 0xf02) {
    iVar5 = *(int *)(iVar5 + 0xac);
    if (iVar5 != 0) {
      if (*(uint *)(iVar5 + 0x30) < 0x10) {
        iVar5 = iVar5 + 0x1c;
      }
      else {
        iVar5 = *(int *)(iVar5 + 0x1c);
      }
      FUN_00404350(iVar5);
      local_8._0_1_ = 2;
      FUN_0081cee0(DAT_0172491c);
      local_8._0_1_ = 4;
      FUN_00406560();
      puVar4 = local_2c;
      if (local_18 < 8) {
        puVar4 = &local_2c;
      }
      uVar3 = FUN_00404750(L"`L@N%s\n",puVar4);
      local_8._0_1_ = 5;
      FUN_00405c30(uVar3,0,0xffffffff);
      local_8._0_1_ = 4;
LAB_00a0998e:
      FUN_00406560();
      local_8 = (uint)local_8._1_3_ << 8;
      FUN_00406560();
    }
  }
  else {
    iVar5 = *(int *)(iVar5 + 0x9c);
    if (iVar5 != 0) {
      if (*(uint *)(iVar5 + 0x30) < 0x10) {
        iVar5 = iVar5 + 0x1c;
      }
      else {
        iVar5 = *(int *)(iVar5 + 0x1c);
      }
      local_8._0_1_ = uVar1;
      FUN_00404350(iVar5);
      local_8._0_1_ = 6;
      FUN_0081cee0(DAT_0172491c);
      local_8._0_1_ = 8;
      FUN_00406560();
      puVar4 = local_2c;
      if (local_18 < 8) {
        puVar4 = &local_2c;
      }
      uVar3 = FUN_00404750(L"`L@N%s\n",puVar4);
      local_8._0_1_ = 9;
      FUN_00405c30(uVar3,0,0xffffffff);
      local_8._0_1_ = 8;
      goto LAB_00a0998e;
    }
  }
  local_8 = 0xffffffff;
  if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_34 = 7;
  local_38 = 0;
  local_48 = (undefined4 *)((uint)local_48._2_2_ << 0x10);
LAB_00a099cb:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a097b0 : PUSH EBP
00a097b1 : MOV EBP,ESP
00a097b3 : PUSH -0x1
00a097b5 : PUSH 0xb5e61b
00a097ba : MOV EAX,FS:[0x0]
00a097c0 : PUSH EAX
00a097c1 : SUB ESP,0x64
00a097c4 : MOV EAX,[0x00d66fa0]
00a097c9 : XOR EAX,EBP
00a097cb : MOV dword ptr [EBP + -0x10],EAX
00a097ce : PUSH EBX
00a097cf : PUSH ESI
00a097d0 : PUSH EDI
00a097d1 : PUSH EAX
00a097d2 : LEA EAX,[EBP + -0xc]
00a097d5 : MOV FS:[0x0],EAX
00a097db : MOV EBX,dword ptr [EBP + 0xc]
00a097de : PUSH 0x0
00a097e0 : PUSH 0xcaac90
00a097e5 : MOV ECX,EBX
00a097e7 : CALL 0x00406360
00a097ec : MOV EAX,dword ptr [EBP + 0x8]
00a097ef : MOV ESI,dword ptr [0x00d7c54c]
00a097f5 : LEA ECX,[EBP + -0x50]
00a097f8 : MOV dword ptr [EBP + -0x50],EAX
00a097fb : PUSH ECX
00a097fc : LEA ECX,[ESI + 0x40]
00a097ff : LEA EAX,[EBP + -0x4c]
00a09802 : CALL 0x004437f0
00a09807 : MOV ESI,dword ptr [ESI + 0x44]
00a0980a : MOV EAX,dword ptr [EBP + -0x4c]
00a0980d : CMP EAX,ESI
00a0980f : JZ 0x00a099cb
00a09815 : MOV EDI,dword ptr [EAX + 0x10]
00a09818 : TEST EDI,EDI
00a0981a : JZ 0x00a099cb
00a09820 : MOV EAX,[0x0172491c]
00a09825 : PUSH 0x0
00a09827 : LEA EDX,[EDI + 0x18]
00a0982a : PUSH EAX
00a0982b : LEA ESI,[EBP + -0x48]
00a0982e : CALL 0x00824a20
00a09833 : MOV dword ptr [EBP + -0x4],0x0
00a0983a : CMP dword ptr [EBP + -0x30],0x8
00a0983e : MOV EAX,dword ptr [EBP + -0x44]
00a09841 : JNC 0x00a09846
00a09843 : LEA EAX,[EBP + -0x44]
00a09846 : PUSH EAX
00a09847 : PUSH 0xcaac94
00a0984c : LEA ESI,[EBP + -0x2c]
00a0984f : CALL 0x00404750
00a09854 : ADD ESP,0x8
00a09857 : MOV byte ptr [EBP + -0x4],0x1
00a0985b : PUSH -0x1
00a0985d : PUSH 0x0
00a0985f : PUSH EAX
00a09860 : MOV ECX,EBX
00a09862 : CALL 0x00405eb0
00a09867 : MOV byte ptr [EBP + -0x4],0x0
00a0986b : CMP dword ptr [EBP + -0x14],0x8
00a0986f : JC 0x00a09879
00a09871 : MOV ECX,dword ptr [EBP + -0x28]
00a09874 : CALL 0x006f04e0
00a09879 : XOR ECX,ECX
00a0987b : MOV EDX,0xf02
00a09880 : MOV dword ptr [EBP + -0x14],0x7
00a09887 : MOV dword ptr [EBP + -0x18],0x0
00a0988e : MOV word ptr [EBP + -0x28],CX
00a09892 : CMP word ptr [EDI + 0x4],DX
00a09896 : JNZ 0x00a09914
00a09898 : MOV EDI,dword ptr [EDI + 0xac]
00a0989e : TEST EDI,EDI
00a098a0 : JZ 0x00a099a2
00a098a6 : CMP dword ptr [EDI + 0x30],0x10
00a098aa : JC 0x00a098b1
00a098ac : MOV EDI,dword ptr [EDI + 0x1c]
00a098af : JMP 0x00a098b4
00a098b1 : ADD EDI,0x1c
00a098b4 : PUSH EDI
00a098b5 : LEA ESI,[EBP + -0x6c]
00a098b8 : CALL 0x00404350
00a098bd : ADD ESP,0x4
00a098c0 : MOV byte ptr [EBP + -0x4],0x2
00a098c4 : MOV ECX,dword ptr [0x0172491c]
00a098ca : PUSH ECX
00a098cb : MOV ECX,EAX
00a098cd : LEA ESI,[EBP + -0x2c]
00a098d0 : CALL 0x0081cee0
00a098d5 : MOV byte ptr [EBP + -0x4],0x4
00a098d9 : LEA ECX,[EBP + -0x6c]
00a098dc : CALL 0x00406560
00a098e1 : CMP dword ptr [EBP + -0x14],0x8
00a098e5 : MOV EAX,dword ptr [EBP + -0x28]
00a098e8 : JNC 0x00a098ed
00a098ea : LEA EAX,[EBP + -0x28]
00a098ed : PUSH EAX
00a098ee : PUSH 0xcaaca4
00a098f3 : LEA ESI,[EBP + -0x6c]
00a098f6 : CALL 0x00404750
00a098fb : ADD ESP,0x8
00a098fe : MOV byte ptr [EBP + -0x4],0x5
00a09902 : PUSH -0x1
00a09904 : PUSH 0x0
00a09906 : PUSH EAX
00a09907 : MOV ECX,EBX
00a09909 : CALL 0x00405c30
00a0990e : MOV byte ptr [EBP + -0x4],0x4
00a09912 : JMP 0x00a0998e
00a09914 : MOV EDI,dword ptr [EDI + 0x9c]
00a0991a : TEST EDI,EDI
00a0991c : JZ 0x00a099a2
00a09922 : CMP dword ptr [EDI + 0x30],0x10
00a09926 : JC 0x00a0992d
00a09928 : MOV EDI,dword ptr [EDI + 0x1c]
00a0992b : JMP 0x00a09930
00a0992d : ADD EDI,0x1c
00a09930 : PUSH EDI
00a09931 : LEA ESI,[EBP + -0x6c]
00a09934 : CALL 0x00404350
00a09939 : ADD ESP,0x4
00a0993c : MOV byte ptr [EBP + -0x4],0x6
00a09940 : MOV EDX,dword ptr [0x0172491c]
00a09946 : PUSH EDX
00a09947 : MOV ECX,EAX
00a09949 : LEA ESI,[EBP + -0x2c]
00a0994c : CALL 0x0081cee0
00a09951 : MOV byte ptr [EBP + -0x4],0x8
00a09955 : LEA ECX,[EBP + -0x6c]
00a09958 : CALL 0x00406560
00a0995d : CMP dword ptr [EBP + -0x14],0x8
00a09961 : MOV EAX,dword ptr [EBP + -0x28]
00a09964 : JNC 0x00a09969
00a09966 : LEA EAX,[EBP + -0x28]
00a09969 : PUSH EAX
00a0996a : PUSH 0xcaacb4
00a0996f : LEA ESI,[EBP + -0x6c]
00a09972 : CALL 0x00404750
00a09977 : ADD ESP,0x8
00a0997a : MOV byte ptr [EBP + -0x4],0x9
00a0997e : PUSH -0x1
00a09980 : PUSH 0x0
00a09982 : PUSH EAX
00a09983 : MOV ECX,EBX
00a09985 : CALL 0x00405c30
00a0998a : MOV byte ptr [EBP + -0x4],0x8
00a0998e : LEA ECX,[EBP + -0x6c]
00a09991 : CALL 0x00406560
00a09996 : MOV byte ptr [EBP + -0x4],0x0
00a0999a : LEA ECX,[EBP + -0x2c]
00a0999d : CALL 0x00406560
00a099a2 : MOV dword ptr [EBP + -0x4],0xffffffff
00a099a9 : CMP dword ptr [EBP + -0x30],0x8
00a099ad : JC 0x00a099b7
00a099af : MOV ECX,dword ptr [EBP + -0x44]
00a099b2 : CALL 0x006f04e0
00a099b7 : XOR EAX,EAX
00a099b9 : MOV dword ptr [EBP + -0x30],0x7
00a099c0 : MOV dword ptr [EBP + -0x34],0x0
00a099c7 : MOV word ptr [EBP + -0x44],AX
00a099cb : MOV ECX,dword ptr [EBP + -0xc]
00a099ce : MOV dword ptr FS:[0x0],ECX
00a099d5 : POP ECX
00a099d6 : POP EDI
00a099d7 : POP ESI
00a099d8 : POP EBX
00a099d9 : MOV ECX,dword ptr [EBP + -0x10]
00a099dc : XOR ECX,EBP
00a099de : CALL 0x00633e6b
00a099e3 : MOV ESP,EBP
00a099e5 : POP EBP
00a099e6 : RET

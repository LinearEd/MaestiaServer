PROGRAM  : Maestia.exe
FUNCTION : FUN_0098a680
ENTRY    : 0098a680
BODY     : [[0098a680, 0098a9bb]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0098a680(void)

{
  int *piVar1;
  int *in_ECX;
  uint local_5c;
  undefined1 local_4c [4];
  undefined2 local_48;
  undefined4 local_38;
  uint local_34;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4cd0f;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  piVar1 = (int *)FUN_009f2a00();
  if (piVar1 == (int *)0x0) {
    piVar1 = (int *)FUN_00b04230();
    if (piVar1 == (int *)0x0) {
      FUN_00406460();
      local_8 = 3;
      if ((int *)*DAT_00da98e8 != (int *)0x0) {
        (**(code **)(*(int *)*DAT_00da98e8 + 0x14))();
      }
      local_8 = 0xffffffff;
      if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_18 = 7;
      local_1c = 0;
      local_2c = 0;
    }
    else {
      (**(code **)(*piVar1 + 0x3c))();
      (**(code **)(*piVar1 + 0x2c))();
      (**(code **)(*in_ECX + 0x70))();
      local_34 = 7;
      local_38 = 0;
      local_48 = 0;
      local_8 = 4;
      (**(code **)(*in_ECX + 0x58))();
      FUN_009f3690();
      FUN_00405eb0(local_4c,0,0xffffffff);
      local_8._1_3_ = (uint3)(local_8 >> 8);
      local_8._0_1_ = 4;
      FUN_008f75f0();
      local_8._0_1_ = 6;
      FUN_00405eb0();
      local_8 = CONCAT31(local_8._1_3_,4);
      if (7 < local_5c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      (**(code **)(*piVar1 + 0x40))();
      FUN_009890e0();
      local_8 = 0xffffffff;
      if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_34 = 7;
      local_38 = 0;
      local_48 = 0;
    }
  }
  else {
    (**(code **)(*in_ECX + 0x70))();
    (**(code **)(*piVar1 + 0x2c))();
    local_18 = 7;
    local_1c = 0;
    local_2c = 0;
    local_8 = 0;
    (**(code **)(*in_ECX + 0x58))();
    FUN_00405eb0(local_30,0);
    local_8 = local_8 & 0xffffff00;
    FUN_008f75f0();
    local_8._0_1_ = 2;
    FUN_00405eb0();
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_5c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    (**(code **)(*piVar1 + 0x40))();
    FUN_009890e0();
    local_8 = 0xffffffff;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c = 0;
  }
  local_8 = 0xffffffff;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0098a680 : PUSH EBP
0098a681 : MOV EBP,ESP
0098a683 : PUSH -0x1
0098a685 : PUSH 0xb4cd0f
0098a68a : MOV EAX,FS:[0x0]
0098a690 : PUSH EAX
0098a691 : SUB ESP,0x64
0098a694 : MOV EAX,[0x00d66fa0]
0098a699 : XOR EAX,EBP
0098a69b : MOV dword ptr [EBP + -0x10],EAX
0098a69e : PUSH EBX
0098a69f : PUSH ESI
0098a6a0 : PUSH EDI
0098a6a1 : PUSH EAX
0098a6a2 : LEA EAX,[EBP + -0xc]
0098a6a5 : MOV FS:[0x0],EAX
0098a6ab : MOV EBX,dword ptr [EBP + 0x8]
0098a6ae : MOVZX EAX,byte ptr [EBX + 0x11]
0098a6b2 : LEA ESI,[EAX + EAX*0x4]
0098a6b5 : MOVZX EAX,byte ptr [EBX + 0x10]
0098a6b9 : ADD ESI,EAX
0098a6bb : MOV EDI,ECX
0098a6bd : MOV EAX,dword ptr [EDI + 0x3c]
0098a6c0 : MOV dword ptr [EBP + -0x54],ESI
0098a6c3 : JS 0x0098a6dd
0098a6c5 : CMP dword ptr [EAX + 0xc],0x0
0098a6c9 : JZ 0x0098a6dd
0098a6cb : MOV ECX,dword ptr [EAX + 0xc]
0098a6ce : MOV EAX,ESI
0098a6d0 : CDQ
0098a6d1 : IDIV ECX
0098a6d3 : IMUL ECX,EAX
0098a6d6 : SUB ESI,ECX
0098a6d8 : MOV dword ptr [EBP + -0x4c],ESI
0098a6db : JMP 0x0098a6e3
0098a6dd : OR EAX,0xffffffff
0098a6e0 : MOV dword ptr [EBP + -0x4c],EAX
0098a6e3 : MOV ECX,dword ptr [EBX + 0x4]
0098a6e6 : PUSH ECX
0098a6e7 : MOV ECX,dword ptr [0x017247f0]
0098a6ed : MOV dword ptr [EBP + -0x50],EAX
0098a6f0 : CALL 0x009f2a00
0098a6f5 : MOV ESI,EAX
0098a6f7 : TEST ESI,ESI
0098a6f9 : JZ 0x0098a807
0098a6ff : MOV EAX,dword ptr [EBP + -0x50]
0098a702 : MOV ECX,dword ptr [EBP + -0x4c]
0098a705 : MOV EDX,dword ptr [EDI]
0098a707 : MOV EDX,dword ptr [EDX + 0x70]
0098a70a : PUSH EAX
0098a70b : PUSH ECX
0098a70c : PUSH ESI
0098a70d : MOV ECX,EDI
0098a70f : CALL EDX
0098a711 : MOV ECX,dword ptr [EBX + 0x18]
0098a714 : MOV EAX,dword ptr [ESI]
0098a716 : MOV EAX,dword ptr [EAX + 0x2c]
0098a719 : SHR ECX,0x1
0098a71b : AND CL,0x1
0098a71e : MOVZX EDX,CL
0098a721 : PUSH 0x1
0098a723 : PUSH EDX
0098a724 : MOV ECX,ESI
0098a726 : CALL EAX
0098a728 : XOR EAX,EAX
0098a72a : XOR ECX,ECX
0098a72c : MOV dword ptr [EBP + -0x14],0x7
0098a733 : MOV dword ptr [EBP + -0x18],EAX
0098a736 : MOV word ptr [EBP + -0x28],CX
0098a73a : MOV dword ptr [EBP + -0x4],EAX
0098a73d : MOV ECX,dword ptr [EBX + 0x8]
0098a740 : MOV EDX,dword ptr [EDI]
0098a742 : MOV EDX,dword ptr [EDX + 0x58]
0098a745 : LEA EAX,[EBP + -0x2c]
0098a748 : PUSH EAX
0098a749 : PUSH ECX
0098a74a : MOV ECX,EDI
0098a74c : CALL EDX
0098a74e : SUB ESP,0x1c
0098a751 : MOV ECX,ESP
0098a753 : MOV dword ptr [EBP + -0x4c],ESP
0098a756 : XOR EAX,EAX
0098a758 : PUSH -0x1
0098a75a : PUSH EAX
0098a75b : LEA EDX,[EBP + -0x2c]
0098a75e : MOV EBX,0x7
0098a763 : MOV dword ptr [ECX + 0x18],EBX
0098a766 : MOV dword ptr [ECX + 0x14],0x0
0098a76d : PUSH EDX
0098a76e : MOV word ptr [ECX + 0x4],AX
0098a772 : CALL 0x00405eb0
0098a777 : MOV byte ptr [EBP + -0x4],0x1
0098a77b : MOV byte ptr [EBP + -0x4],0x0
0098a77f : LEA ECX,[EBP + -0x70]
0098a782 : CALL 0x008f75f0
0098a787 : ADD ESP,0x1c
0098a78a : MOV byte ptr [EBP + -0x4],0x2
0098a78e : PUSH -0x1
0098a790 : PUSH 0x0
0098a792 : PUSH EAX
0098a793 : LEA ECX,[EBP + -0x2c]
0098a796 : CALL 0x00405eb0
0098a79b : MOV byte ptr [EBP + -0x4],0x0
0098a79f : MOV EDI,0x8
0098a7a4 : CMP dword ptr [EBP + -0x58],EDI
0098a7a7 : JC 0x0098a7b1
0098a7a9 : MOV ECX,dword ptr [EBP + -0x6c]
0098a7ac : CALL 0x006f04e0
0098a7b1 : MOV EDX,dword ptr [ESI]
0098a7b3 : XOR EAX,EAX
0098a7b5 : MOV word ptr [EBP + -0x6c],AX
0098a7b9 : MOV EAX,dword ptr [EDX + 0x40]
0098a7bc : MOV ECX,ESI
0098a7be : MOV dword ptr [EBP + -0x58],EBX
0098a7c1 : MOV dword ptr [EBP + -0x5c],0x0
0098a7c8 : CALL EAX
0098a7ca : MOV EDX,dword ptr [EBP + -0x54]
0098a7cd : MOVZX ECX,AX
0098a7d0 : PUSH ECX
0098a7d1 : PUSH EDX
0098a7d2 : LEA ECX,[EBP + -0x2c]
0098a7d5 : CALL 0x009890e0
0098a7da : MOV dword ptr [EBP + -0x4],0xffffffff
0098a7e1 : CMP dword ptr [EBP + -0x14],EDI
0098a7e4 : JC 0x0098a7ee
0098a7e6 : MOV ECX,dword ptr [EBP + -0x28]
0098a7e9 : CALL 0x006f04e0
0098a7ee : XOR EAX,EAX
0098a7f0 : MOV dword ptr [EBP + -0x14],0x7
0098a7f7 : MOV dword ptr [EBP + -0x18],0x0
0098a7fe : MOV word ptr [EBP + -0x28],AX
0098a802 : JMP 0x0098a99e
0098a807 : MOV ECX,dword ptr [EBX + 0x4]
0098a80a : PUSH ECX
0098a80b : MOV ECX,dword ptr [EBX + 0x8]
0098a80e : CALL 0x00b04230
0098a813 : MOV ESI,EAX
0098a815 : ADD ESP,0x4
0098a818 : TEST ESI,ESI
0098a81a : JNZ 0x0098a87f
0098a81c : PUSH 0xc82850
0098a821 : LEA ECX,[EBP + -0x2c]
0098a824 : CALL 0x00406460
0098a829 : MOV dword ptr [EBP + -0x4],0x3
0098a830 : MOV EDX,dword ptr [0x00da98e8]
0098a836 : MOV ECX,dword ptr [EDX]
0098a838 : TEST ECX,ECX
0098a83a : JZ 0x0098a851
0098a83c : MOV EAX,dword ptr [ECX]
0098a83e : MOV EAX,dword ptr [EAX + 0x14]
0098a841 : LEA EDX,[EBP + -0x2c]
0098a844 : PUSH EDX
0098a845 : PUSH 0x17c
0098a84a : PUSH 0xc82870
0098a84f : CALL EAX
0098a851 : MOV dword ptr [EBP + -0x4],0xffffffff
0098a858 : CMP dword ptr [EBP + -0x14],0x8
0098a85c : JC 0x0098a866
0098a85e : MOV ECX,dword ptr [EBP + -0x28]
0098a861 : CALL 0x006f04e0
0098a866 : XOR ECX,ECX
0098a868 : MOV dword ptr [EBP + -0x14],0x7
0098a86f : MOV dword ptr [EBP + -0x18],0x0
0098a876 : MOV word ptr [EBP + -0x28],CX
0098a87a : JMP 0x0098a99e
0098a87f : MOV EDX,dword ptr [ESI]
0098a881 : MOV EAX,dword ptr [EDX + 0x3c]
0098a884 : PUSH 0x1
0098a886 : MOV ECX,ESI
0098a888 : CALL EAX
0098a88a : MOV EAX,dword ptr [EBX + 0x18]
0098a88d : MOV EDX,dword ptr [ESI]
0098a88f : MOV EDX,dword ptr [EDX + 0x2c]
0098a892 : SHR EAX,0x1
0098a894 : AND AL,0x1
0098a896 : MOVZX ECX,AL
0098a899 : PUSH 0x1
0098a89b : PUSH ECX
0098a89c : MOV ECX,ESI
0098a89e : CALL EDX
0098a8a0 : MOV ECX,dword ptr [EBP + -0x50]
0098a8a3 : MOV EDX,dword ptr [EBP + -0x4c]
0098a8a6 : MOV EAX,dword ptr [EDI]
0098a8a8 : MOV EAX,dword ptr [EAX + 0x70]
0098a8ab : PUSH ECX
0098a8ac : PUSH EDX
0098a8ad : PUSH ESI
0098a8ae : MOV ECX,EDI
0098a8b0 : CALL EAX
0098a8b2 : XOR ECX,ECX
0098a8b4 : MOV dword ptr [EBP + -0x30],0x7
0098a8bb : MOV dword ptr [EBP + -0x34],0x0
0098a8c2 : MOV word ptr [EBP + -0x44],CX
0098a8c6 : MOV dword ptr [EBP + -0x4],0x4
0098a8cd : MOV ECX,dword ptr [EBX + 0x8]
0098a8d0 : MOV EDX,dword ptr [EDI]
0098a8d2 : MOV EDX,dword ptr [EDX + 0x58]
0098a8d5 : LEA EAX,[EBP + -0x48]
0098a8d8 : PUSH EAX
0098a8d9 : PUSH ECX
0098a8da : MOV ECX,EDI
0098a8dc : CALL EDX
0098a8de : MOV EAX,[0x017247f0]
0098a8e3 : MOV ECX,dword ptr [EBX + 0x8]
0098a8e6 : PUSH EAX
0098a8e7 : MOV EAX,ESI
0098a8e9 : CALL 0x009f3690
0098a8ee : SUB ESP,0x1c
0098a8f1 : MOV ECX,ESP
0098a8f3 : MOV dword ptr [EBP + -0x4c],ESP
0098a8f6 : XOR EDX,EDX
0098a8f8 : PUSH -0x1
0098a8fa : PUSH EDX
0098a8fb : LEA EAX,[EBP + -0x48]
0098a8fe : MOV EBX,0x7
0098a903 : MOV dword ptr [ECX + 0x18],EBX
0098a906 : MOV dword ptr [ECX + 0x14],0x0
0098a90d : PUSH EAX
0098a90e : MOV word ptr [ECX + 0x4],DX
0098a912 : CALL 0x00405eb0
0098a917 : MOV byte ptr [EBP + -0x4],0x5
0098a91b : MOV byte ptr [EBP + -0x4],0x4
0098a91f : LEA ECX,[EBP + -0x70]
0098a922 : CALL 0x008f75f0
0098a927 : ADD ESP,0x1c
0098a92a : MOV byte ptr [EBP + -0x4],0x6
0098a92e : PUSH -0x1
0098a930 : PUSH 0x0
0098a932 : PUSH EAX
0098a933 : LEA ECX,[EBP + -0x48]
0098a936 : CALL 0x00405eb0
0098a93b : MOV byte ptr [EBP + -0x4],0x4
0098a93f : MOV EDI,0x8
0098a944 : CMP dword ptr [EBP + -0x58],EDI
0098a947 : JC 0x0098a951
0098a949 : MOV ECX,dword ptr [EBP + -0x6c]
0098a94c : CALL 0x006f04e0
0098a951 : MOV EDX,dword ptr [ESI]
0098a953 : MOV EAX,dword ptr [EDX + 0x40]
0098a956 : XOR ECX,ECX
0098a958 : MOV word ptr [EBP + -0x6c],CX
0098a95c : MOV ECX,ESI
0098a95e : MOV dword ptr [EBP + -0x58],EBX
0098a961 : MOV dword ptr [EBP + -0x5c],0x0
0098a968 : CALL EAX
0098a96a : MOV EDX,dword ptr [EBP + -0x54]
0098a96d : MOVZX ECX,AX
0098a970 : PUSH ECX
0098a971 : PUSH EDX
0098a972 : LEA ECX,[EBP + -0x48]
0098a975 : CALL 0x009890e0
0098a97a : MOV dword ptr [EBP + -0x4],0xffffffff
0098a981 : CMP dword ptr [EBP + -0x30],EDI
0098a984 : JC 0x0098a98e
0098a986 : MOV ECX,dword ptr [EBP + -0x44]
0098a989 : CALL 0x006f04e0
0098a98e : XOR EAX,EAX
0098a990 : MOV dword ptr [EBP + -0x30],EBX
0098a993 : MOV dword ptr [EBP + -0x34],0x0
0098a99a : MOV word ptr [EBP + -0x44],AX
0098a99e : MOV ECX,dword ptr [EBP + -0xc]
0098a9a1 : MOV dword ptr FS:[0x0],ECX
0098a9a8 : POP ECX
0098a9a9 : POP EDI
0098a9aa : POP ESI
0098a9ab : POP EBX
0098a9ac : MOV ECX,dword ptr [EBP + -0x10]
0098a9af : XOR ECX,EBP
0098a9b1 : CALL 0x00633e6b
0098a9b6 : MOV ESP,EBP
0098a9b8 : POP EBP
0098a9b9 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : __wfullpath_helper
ENTRY    : 0063d368
BODY     : [[0063d368, 0063d3c7]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    __wfullpath_helper
   
   Library: Visual Studio 2008 Release */

wchar_t * __wfullpath_helper(wchar_t *param_1,wchar_t *param_2,size_t param_3,undefined4 *param_4)

{
  int iVar1;
  int *piVar2;
  wchar_t *pwVar3;
  
  piVar2 = __errno();
  iVar1 = *piVar2;
  piVar2 = __errno();
  *piVar2 = 0;
  pwVar3 = __wfullpath(param_1,param_2,param_3);
  piVar2 = __errno();
  if (pwVar3 == (wchar_t *)0x0) {
    if (*piVar2 == 0x22) {
      piVar2 = __errno();
      *piVar2 = iVar1;
      pwVar3 = __wfullpath((wchar_t *)0x0,param_2,0);
      *param_4 = pwVar3;
    }
    else {
      pwVar3 = (wchar_t *)0x0;
    }
  }
  else {
    *piVar2 = iVar1;
  }
  return pwVar3;
}



============================================================
DISASSEMBLY
============================================================
0063d368 : MOV EDI,EDI
0063d36a : PUSH EBP
0063d36b : MOV EBP,ESP
0063d36d : PUSH ESI
0063d36e : PUSH EDI
0063d36f : CALL 0x0063ab82
0063d374 : MOV ESI,dword ptr [EAX]
0063d376 : CALL 0x0063ab82
0063d37b : PUSH dword ptr [EBP + 0x10]
0063d37e : AND dword ptr [EAX],0x0
0063d381 : PUSH dword ptr [EBP + 0xc]
0063d384 : PUSH dword ptr [EBP + 0x8]
0063d387 : CALL 0x00648c59
0063d38c : ADD ESP,0xc
0063d38f : MOV EDI,EAX
0063d391 : CALL 0x0063ab82
0063d396 : TEST EDI,EDI
0063d398 : JZ 0x0063d3a0
0063d39a : MOV dword ptr [EAX],ESI
0063d39c : MOV EAX,EDI
0063d39e : JMP 0x0063d3c4
0063d3a0 : CMP dword ptr [EAX],0x22
0063d3a3 : JZ 0x0063d3a9
0063d3a5 : XOR EAX,EAX
0063d3a7 : JMP 0x0063d3c4
0063d3a9 : CALL 0x0063ab82
0063d3ae : PUSH 0x0
0063d3b0 : PUSH dword ptr [EBP + 0xc]
0063d3b3 : MOV dword ptr [EAX],ESI
0063d3b5 : PUSH 0x0
0063d3b7 : CALL 0x00648c59
0063d3bc : MOV ECX,dword ptr [EBP + 0x14]
0063d3bf : ADD ESP,0xc
0063d3c2 : MOV dword ptr [ECX],EAX
0063d3c4 : POP EDI
0063d3c5 : POP ESI
0063d3c6 : POP EBP
0063d3c7 : RET

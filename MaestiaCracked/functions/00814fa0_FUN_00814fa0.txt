PROGRAM  : Maestia.exe
FUNCTION : FUN_00814fa0
ENTRY    : 00814fa0
BODY     : [[00814fa0, 00814fdf] [00814fe3, 00815073] [0081507c, 008150ae] [00815113, 00815126]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00814fa0(int param_1)

{
  char cVar1;
  int *piVar2;
  int iVar3;
  undefined4 *puVar4;
  undefined4 *puVar5;
  int iVar6;
  undefined4 *puVar7;
  uint uVar8;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3a6c0;
  local_10 = ExceptionList;
  uVar8 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  piVar2 = (int *)**(int **)(param_1 + 0x10);
  if (piVar2 == *(int **)(param_1 + 0x10)) {
    return;
  }
  iVar3 = piVar2[4];
  puVar4 = (undefined4 *)**(undefined4 **)(iVar3 + 8);
  while (ExceptionList = &local_10, puVar4 != *(undefined4 **)(iVar3 + 8)) {
    if (puVar4[4] != 0) {
      FUN_00705b10(puVar4[4]);
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    if (*(char *)((int)puVar4 + 0x15) == '\0') {
      puVar5 = (undefined4 *)puVar4[2];
      if (*(char *)((int)puVar5 + 0x15) == '\0') {
        cVar1 = *(char *)((int)*puVar5 + 0x15);
        puVar4 = puVar5;
        puVar5 = (undefined4 *)*puVar5;
        while (cVar1 == '\0') {
          cVar1 = *(char *)((int)*puVar5 + 0x15);
          puVar4 = puVar5;
          puVar5 = (undefined4 *)*puVar5;
        }
      }
      else {
        cVar1 = *(char *)((int)puVar4[1] + 0x15);
        puVar7 = (undefined4 *)puVar4[1];
        puVar5 = puVar4;
        while ((puVar4 = puVar7, cVar1 == '\0' && (puVar5 == (undefined4 *)puVar4[2]))) {
          cVar1 = *(char *)((int)puVar4[1] + 0x15);
          puVar7 = (undefined4 *)puVar4[1];
          puVar5 = puVar4;
        }
      }
    }
  }
  iVar6 = *(int *)(*(int *)(iVar3 + 8) + 4);
  if (*(char *)(iVar6 + 0x15) == '\0') {
    FUN_00401c00(*(undefined4 *)(iVar6 + 8));
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  *(int *)(*(int *)(iVar3 + 8) + 4) = *(int *)(iVar3 + 8);
  *(undefined4 *)(iVar3 + 0xc) = 0;
  *(undefined4 *)*(undefined4 *)(iVar3 + 8) = *(undefined4 *)(iVar3 + 8);
  *(int *)(*(int *)(iVar3 + 8) + 8) = *(int *)(iVar3 + 8);
  local_8 = 0xffffffff;
  FUN_0041efa0(iVar3 + 4,uVar8);
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
00814fa0 : PUSH EBP
00814fa1 : MOV EBP,ESP
00814fa3 : PUSH -0x1
00814fa5 : PUSH 0xb3a6c0
00814faa : MOV EAX,FS:[0x0]
00814fb0 : PUSH EAX
00814fb1 : SUB ESP,0xc
00814fb4 : PUSH EBX
00814fb5 : PUSH ESI
00814fb6 : PUSH EDI
00814fb7 : MOV EAX,[0x00d66fa0]
00814fbc : XOR EAX,EBP
00814fbe : PUSH EAX
00814fbf : LEA EAX,[EBP + -0xc]
00814fc2 : MOV FS:[0x0],EAX
00814fc8 : MOV EAX,dword ptr [EBP + 0x8]
00814fcb : MOV ECX,dword ptr [EAX + 0x10]
00814fce : MOV EAX,dword ptr [ECX]
00814fd0 : MOV dword ptr [EBP + -0x14],ECX
00814fd3 : MOV dword ptr [EBP + 0x8],EAX
00814fd6 : CMP EAX,ECX
00814fd8 : JZ 0x00815113
00814fde : JMP 0x00814fe3
00814fe3 : MOV EAX,dword ptr [EAX + 0x10]
00814fe6 : MOV EBX,dword ptr [EAX + 0x8]
00814fe9 : MOV ESI,dword ptr [EBX]
00814feb : MOV dword ptr [EBP + -0x10],EAX
00814fee : CMP ESI,EBX
00814ff0 : JZ 0x0081504e
00814ff2 : MOV EDI,dword ptr [ESI + 0x10]
00814ff5 : TEST EDI,EDI
00814ff7 : JZ 0x00815006
00814ff9 : PUSH EDI
00814ffa : CALL 0x00705b10
00814fff : MOV ECX,EDI
00815001 : CALL 0x006f04e0
00815006 : CMP byte ptr [ESI + 0x15],0x0
0081500a : JNZ 0x00815047
0081500c : MOV EAX,dword ptr [ESI + 0x8]
0081500f : CMP byte ptr [EAX + 0x15],0x0
00815013 : JNZ 0x0081502c
00815015 : MOV ESI,EAX
00815017 : MOV EAX,dword ptr [ESI]
00815019 : CMP byte ptr [EAX + 0x15],0x0
0081501d : JNZ 0x00815047
0081501f : NOP
00815020 : MOV ESI,EAX
00815022 : MOV EAX,dword ptr [ESI]
00815024 : CMP byte ptr [EAX + 0x15],0x0
00815028 : JZ 0x00815020
0081502a : JMP 0x00815047
0081502c : MOV EAX,dword ptr [ESI + 0x4]
0081502f : CMP byte ptr [EAX + 0x15],0x0
00815033 : JNZ 0x00815045
00815035 : CMP ESI,dword ptr [EAX + 0x8]
00815038 : JNZ 0x00815045
0081503a : MOV ESI,EAX
0081503c : MOV EAX,dword ptr [EAX + 0x4]
0081503f : CMP byte ptr [EAX + 0x15],0x0
00815043 : JZ 0x00815035
00815045 : MOV ESI,EAX
00815047 : CMP ESI,EBX
00815049 : JNZ 0x00814ff2
0081504b : MOV EAX,dword ptr [EBP + -0x10]
0081504e : MOV ECX,dword ptr [EAX + 0x8]
00815051 : MOV EBX,dword ptr [ECX + 0x4]
00815054 : CMP byte ptr [EBX + 0x15],0x0
00815058 : LEA ESI,[EAX + 0x4]
0081505b : MOV EDI,EBX
0081505d : JNZ 0x0081507c
0081505f : NOP
00815060 : MOV EDX,dword ptr [EDI + 0x8]
00815063 : PUSH EDX
00815064 : MOV ECX,ESI
00815066 : CALL 0x00401c00
0081506b : MOV EDI,dword ptr [EDI]
0081506d : MOV ECX,EBX
0081506f : CALL 0x006f04e0
0081507c : MOV EAX,dword ptr [ESI + 0x4]
0081507f : MOV dword ptr [EAX + 0x4],EAX
00815082 : MOV EAX,dword ptr [ESI + 0x4]
00815085 : MOV dword ptr [ESI + 0x8],0x0
0081508c : MOV dword ptr [EAX],EAX
0081508e : MOV EAX,dword ptr [ESI + 0x4]
00815091 : MOV dword ptr [EAX + 0x8],EAX
00815094 : MOV EAX,dword ptr [EBP + -0x10]
00815097 : MOV dword ptr [EBP + -0x18],EAX
0081509a : MOV dword ptr [EBP + -0x4],0xffffffff
008150a1 : PUSH ESI
008150a2 : CALL 0x0041efa0
008150a7 : MOV ECX,dword ptr [EBP + -0x10]
008150aa : CALL 0x006f04e0
00815113 : MOV ECX,dword ptr [EBP + -0xc]
00815116 : MOV dword ptr FS:[0x0],ECX
0081511d : POP ECX
0081511e : POP EDI
0081511f : POP ESI
00815120 : POP EBX
00815121 : MOV ESP,EBP
00815123 : POP EBP
00815124 : RET 0x4

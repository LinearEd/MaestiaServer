PROGRAM  : Maestia.exe
FUNCTION : FUN_00ad9870
ENTRY    : 00ad9870
BODY     : [[00ad9870, 00ad9b4c]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00ad9870(void)

{
  int iVar1;
  int in_ECX;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  undefined4 local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b5e77f;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  switch(*(undefined1 *)(in_ECX + 3)) {
  case 2:
    if ((*DAT_00da9894 != 0) && (*(int *)(*DAT_00da9894 + 0x1bc) != 0)) {
      FUN_00a8d2f0();
    }
    break;
  default:
    FUN_008018d0(L"[ AvaCltNet::PkPrivateShopHandle ] Invalid Packet");
    break;
  case 4:
    if ((*DAT_00da9894 != 0) && (*(int *)(*DAT_00da9894 + 0x1bc) != 0)) {
      FUN_00a8de10();
    }
    break;
  case 7:
    if ((*DAT_00da9894 != 0) && (*(int *)(*DAT_00da9894 + 0x1bc) != 0)) {
      FUN_00a8d2b0();
    }
    break;
  case 0xb:
    iVar1 = *DAT_00da9894;
    if ((iVar1 != 0) && (*(int *)(iVar1 + 0x1bc) != 0)) {
      if (*(int *)(in_ECX + 4) == *(int *)(*(int *)(DAT_0172491c + 0x17c) + 4)) {
        FUN_00a8e5f0(*(undefined1 *)(in_ECX + 8),*(undefined1 *)(in_ECX + 9));
      }
      else {
        (**(code **)(**(int **)(iVar1 + 0x1c0) + 0x78))
                  (*(undefined1 *)(in_ECX + 8),*(undefined1 *)(in_ECX + 9));
      }
    }
    break;
  case 0xc:
    if ((*DAT_00da9894 != 0) && (*(int *)(*DAT_00da9894 + 0x1bc) != 0)) {
      FUN_0093c480(*(undefined4 *)(in_ECX + 4));
    }
    break;
  case 0xd:
    iVar1 = *DAT_00da9894;
    if ((iVar1 != 0) && (*(int *)(iVar1 + 0x1bc) != 0)) {
      (**(code **)(**(int **)(iVar1 + 0x1c0) + 0x20))();
    }
    break;
  case 0xe:
    iVar1 = *DAT_00da9894;
    if ((iVar1 != 0) && (*(int *)(iVar1 + 0x1bc) != 0)) {
      FUN_0093c8e0(*(undefined4 *)(iVar1 + 0x1c0));
    }
    break;
  case 0x10:
    iVar1 = *DAT_00da9894;
    if ((iVar1 != 0) && (*(int *)(iVar1 + 0x1bc) != 0)) {
      if (*(int *)(in_ECX + 4) == *(int *)(*(int *)(DAT_0172491c + 0x17c) + 4)) {
        FUN_00a8e3a0(*(int *)(iVar1 + 0x1bc),*(undefined1 *)(in_ECX + 8),*(undefined1 *)(in_ECX + 9)
                     ,*(undefined1 *)(in_ECX + 10));
      }
      else {
        FUN_0093c6a0(*(undefined4 *)(iVar1 + 0x1c0),*(undefined1 *)(in_ECX + 8),
                     *(undefined1 *)(in_ECX + 9),*(undefined1 *)(in_ECX + 10));
      }
    }
    break;
  case 0x11:
    if (DAT_00da93ec != 0) {
      local_18 = 7;
      local_1c = 0;
      local_2c = 0;
      local_8 = 0;
      FUN_00405c00(local_30);
      FUN_00a1e6f0(*(undefined4 *)(in_ECX + 4),local_30,*(undefined1 *)(in_ECX + 8));
      local_8 = 0xffffffff;
      FUN_00406560();
    }
    break;
  case 0xff:
    if ((*DAT_00da9894 != 0) && (*(int *)(*DAT_00da9894 + 0x1bc) != 0)) {
      FUN_00a8d5b0(local_14);
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00ad9870 : PUSH EBP
00ad9871 : MOV EBP,ESP
00ad9873 : PUSH -0x1
00ad9875 : PUSH 0xb5e77f
00ad987a : MOV EAX,FS:[0x0]
00ad9880 : PUSH EAX
00ad9881 : SUB ESP,0x20
00ad9884 : MOV EAX,[0x00d66fa0]
00ad9889 : XOR EAX,EBP
00ad988b : MOV dword ptr [EBP + -0x10],EAX
00ad988e : PUSH ESI
00ad988f : PUSH EDI
00ad9890 : PUSH EAX
00ad9891 : LEA EAX,[EBP + -0xc]
00ad9894 : MOV FS:[0x0],EAX
00ad989a : MOV ESI,ECX
00ad989c : MOVZX EAX,byte ptr [ESI + 0x3]
00ad98a0 : ADD EAX,-0x2
00ad98a3 : CMP EAX,0xfd
00ad98a8 : JA 0x00ad9b1a
00ad98ae : MOVZX EAX,byte ptr [EAX + 0xad9b7c]
00ad98b5 : JMP dword ptr [EAX*0x4 + 0xad9b50]
00ad98bc : MOV ECX,dword ptr [0x00da9894]
00ad98c2 : MOV EAX,dword ptr [ECX]
00ad98c4 : TEST EAX,EAX
00ad98c6 : JZ 0x00ad9b2d
00ad98cc : MOV ESI,dword ptr [EAX + 0x1bc]
00ad98d2 : TEST ESI,ESI
00ad98d4 : JZ 0x00ad9b2d
00ad98da : CALL 0x00a8d2f0
00ad98df : JMP 0x00ad9b2d
00ad98e4 : MOV EDX,dword ptr [0x00da9894]
00ad98ea : MOV EAX,dword ptr [EDX]
00ad98ec : TEST EAX,EAX
00ad98ee : JZ 0x00ad9b2d
00ad98f4 : MOV EAX,dword ptr [EAX + 0x1bc]
00ad98fa : TEST EAX,EAX
00ad98fc : JZ 0x00ad9b2d
00ad9902 : CALL 0x00a8de10
00ad9907 : JMP 0x00ad9b2d
00ad990c : MOV EAX,[0x00da9894]
00ad9911 : MOV EAX,dword ptr [EAX]
00ad9913 : TEST EAX,EAX
00ad9915 : JZ 0x00ad9b2d
00ad991b : CMP dword ptr [EAX + 0x1bc],0x0
00ad9922 : JZ 0x00ad9b2d
00ad9928 : MOV ECX,dword ptr [ESI + 0x4]
00ad992b : MOV ESI,dword ptr [EAX + 0x1c0]
00ad9931 : PUSH ECX
00ad9932 : CALL 0x0093c480
00ad9937 : JMP 0x00ad9b2d
00ad993c : MOV EDX,dword ptr [0x00da9894]
00ad9942 : MOV EAX,dword ptr [EDX]
00ad9944 : TEST EAX,EAX
00ad9946 : JZ 0x00ad9b2d
00ad994c : CMP dword ptr [EAX + 0x1bc],0x0
00ad9953 : JZ 0x00ad9b2d
00ad9959 : MOV EAX,dword ptr [EAX + 0x1c0]
00ad995f : MOV EDX,dword ptr [EAX]
00ad9961 : MOV ECX,EAX
00ad9963 : MOV EAX,dword ptr [EDX + 0x20]
00ad9966 : CALL EAX
00ad9968 : JMP 0x00ad9b2d
00ad996d : MOV ECX,dword ptr [0x00da9894]
00ad9973 : MOV EAX,dword ptr [ECX]
00ad9975 : TEST EAX,EAX
00ad9977 : JZ 0x00ad9b2d
00ad997d : CMP dword ptr [EAX + 0x1bc],0x0
00ad9984 : JZ 0x00ad9b2d
00ad998a : MOV EDX,dword ptr [EAX + 0x1c0]
00ad9990 : PUSH EDX
00ad9991 : CALL 0x0093c8e0
00ad9996 : JMP 0x00ad9b2d
00ad999b : MOV EAX,[0x00da9894]
00ad99a0 : MOV EAX,dword ptr [EAX]
00ad99a2 : TEST EAX,EAX
00ad99a4 : JZ 0x00ad9b2d
00ad99aa : MOV EDI,dword ptr [EAX + 0x1bc]
00ad99b0 : TEST EDI,EDI
00ad99b2 : JZ 0x00ad9b2d
00ad99b8 : MOV ECX,dword ptr [0x0172491c]
00ad99be : MOV EDX,dword ptr [ECX + 0x17c]
00ad99c4 : MOV ECX,dword ptr [ESI + 0x4]
00ad99c7 : CMP ECX,dword ptr [EDX + 0x4]
00ad99ca : JZ 0x00ad99ea
00ad99cc : MOVZX ECX,byte ptr [ESI + 0x9]
00ad99d0 : MOV EAX,dword ptr [EAX + 0x1c0]
00ad99d6 : MOV EDX,dword ptr [EAX]
00ad99d8 : MOV EDX,dword ptr [EDX + 0x78]
00ad99db : PUSH ECX
00ad99dc : MOVZX ECX,byte ptr [ESI + 0x8]
00ad99e0 : PUSH ECX
00ad99e1 : MOV ECX,EAX
00ad99e3 : CALL EDX
00ad99e5 : JMP 0x00ad9b2d
00ad99ea : MOVZX AX,byte ptr [ESI + 0x9]
00ad99ef : MOVZX DX,byte ptr [ESI + 0x8]
00ad99f4 : MOVZX ECX,AX
00ad99f7 : MOVZX EAX,DX
00ad99fa : PUSH ECX
00ad99fb : PUSH EAX
00ad99fc : CALL 0x00a8e5f0
00ad9a01 : JMP 0x00ad9b2d
00ad9a06 : MOV ECX,dword ptr [0x00da9894]
00ad9a0c : MOV EAX,dword ptr [ECX]
00ad9a0e : TEST EAX,EAX
00ad9a10 : JZ 0x00ad9b2d
00ad9a16 : MOV ECX,dword ptr [EAX + 0x1bc]
00ad9a1c : TEST ECX,ECX
00ad9a1e : JZ 0x00ad9b2d
00ad9a24 : MOV EDX,dword ptr [0x0172491c]
00ad9a2a : MOV EDX,dword ptr [EDX + 0x17c]
00ad9a30 : MOV EDI,dword ptr [ESI + 0x4]
00ad9a33 : CMP EDI,dword ptr [EDX + 0x4]
00ad9a36 : MOVZX EDX,byte ptr [ESI + 0x9]
00ad9a3a : JZ 0x00ad9a5e
00ad9a3c : MOVZX ECX,byte ptr [ESI + 0xa]
00ad9a40 : PUSH ECX
00ad9a41 : MOVZX ECX,DX
00ad9a44 : MOVZX EDX,byte ptr [ESI + 0x8]
00ad9a48 : PUSH ECX
00ad9a49 : MOVZX ECX,DX
00ad9a4c : MOV EDX,dword ptr [EAX + 0x1c0]
00ad9a52 : PUSH ECX
00ad9a53 : PUSH EDX
00ad9a54 : CALL 0x0093c6a0
00ad9a59 : JMP 0x00ad9b2d
00ad9a5e : MOVZX EAX,byte ptr [ESI + 0xa]
00ad9a62 : PUSH EAX
00ad9a63 : MOVZX EAX,DX
00ad9a66 : MOVZX EDX,byte ptr [ESI + 0x8]
00ad9a6a : PUSH EAX
00ad9a6b : MOVZX EAX,DX
00ad9a6e : PUSH EAX
00ad9a6f : PUSH ECX
00ad9a70 : CALL 0x00a8e3a0
00ad9a75 : JMP 0x00ad9b2d
00ad9a7a : MOV ECX,dword ptr [0x00da9894]
00ad9a80 : MOV EAX,dword ptr [ECX]
00ad9a82 : TEST EAX,EAX
00ad9a84 : JZ 0x00ad9b2d
00ad9a8a : MOV EAX,dword ptr [EAX + 0x1bc]
00ad9a90 : TEST EAX,EAX
00ad9a92 : JZ 0x00ad9b2d
00ad9a98 : MOVZX ECX,byte ptr [ESI + 0x4]
00ad9a9c : CALL 0x00a8d2b0
00ad9aa1 : JMP 0x00ad9b2d
00ad9aa6 : CMP dword ptr [0x00da93ec],0x0
00ad9aad : JZ 0x00ad9b2d
00ad9aaf : XOR EDX,EDX
00ad9ab1 : MOV dword ptr [EBP + -0x14],0x7
00ad9ab8 : MOV dword ptr [EBP + -0x18],0x0
00ad9abf : MOV word ptr [EBP + -0x28],DX
00ad9ac3 : MOV dword ptr [EBP + -0x4],EDX
00ad9ac6 : LEA EAX,[EBP + -0x2c]
00ad9ac9 : LEA EDX,[ESI + 0x9]
00ad9acc : PUSH EAX
00ad9acd : CALL 0x00405c00
00ad9ad2 : MOVZX ECX,byte ptr [ESI + 0x8]
00ad9ad6 : MOV EAX,dword ptr [ESI + 0x4]
00ad9ad9 : PUSH ECX
00ad9ada : MOV ECX,dword ptr [0x00da93ec]
00ad9ae0 : LEA EDX,[EBP + -0x2c]
00ad9ae3 : PUSH EDX
00ad9ae4 : PUSH EAX
00ad9ae5 : CALL 0x00a1e6f0
00ad9aea : MOV dword ptr [EBP + -0x4],0xffffffff
00ad9af1 : LEA ECX,[EBP + -0x2c]
00ad9af4 : CALL 0x00406560
00ad9af9 : JMP 0x00ad9b2d
00ad9afb : MOV ECX,dword ptr [0x00da9894]
00ad9b01 : MOV EAX,dword ptr [ECX]
00ad9b03 : TEST EAX,EAX
00ad9b05 : JZ 0x00ad9b2d
00ad9b07 : CMP dword ptr [EAX + 0x1bc],0x0
00ad9b0e : JZ 0x00ad9b2d
00ad9b10 : MOV ECX,dword ptr [ESI + 0x4]
00ad9b13 : CALL 0x00a8d5b0
00ad9b18 : JMP 0x00ad9b2d
00ad9b1a : MOV ESI,dword ptr [0x00da98e8]
00ad9b20 : PUSH 0xcbb0e0
00ad9b25 : CALL 0x008018d0
00ad9b2a : ADD ESP,0x4
00ad9b2d : MOV EAX,0x1
00ad9b32 : MOV ECX,dword ptr [EBP + -0xc]
00ad9b35 : MOV dword ptr FS:[0x0],ECX
00ad9b3c : POP ECX
00ad9b3d : POP EDI
00ad9b3e : POP ESI
00ad9b3f : MOV ECX,dword ptr [EBP + -0x10]
00ad9b42 : XOR ECX,EBP
00ad9b44 : CALL 0x00633e6b
00ad9b49 : MOV ESP,EBP
00ad9b4b : POP EBP
00ad9b4c : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_0056bd40
ENTRY    : 0056bd40
BODY     : [[0056bd40, 0056be3b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0056bd40(int *param_1,uint param_2)

{
  byte bVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  uint *in_ECX;
  int iVar5;
  int iVar6;
  uint local_4;
  
  *in_ECX = param_2;
  in_ECX[1] = 0;
  local_4 = local_4 & 0xffff0000;
  in_ECX[2] = 0xff000000;
  in_ECX[3] = local_4;
  if (param_1[3] != 0) {
    param_1[2] = param_1[2] + 1;
  }
  iVar6 = param_1[2];
  iVar5 = *param_1;
  param_1[3] = 0;
  uVar2 = CONCAT31(CONCAT21(CONCAT11(*(undefined1 *)(iVar5 + 3 + iVar6),
                                     *(undefined1 *)(iVar5 + 2 + iVar6)),
                            *(undefined1 *)(iVar5 + 1 + iVar6)),*(undefined1 *)(iVar5 + iVar6));
  param_1[2] = iVar6 + 4;
  if ((*in_ECX & 0x20000) != 0) {
    param_1[3] = 0;
    bVar1 = *(byte *)(iVar6 + 4 + iVar5);
    param_1[2] = iVar6 + 5;
    *(ushort *)(in_ECX + 2) = (ushort)bVar1;
    uVar2 = uVar2 - 1;
  }
  uVar3 = FUN_0052b230();
  if ((GRefCountImpl *)in_ECX[4] != (GRefCountImpl *)0x0) {
    GRefCountImpl::Release((GRefCountImpl *)in_ECX[4]);
  }
  in_ECX[4] = uVar3;
  FUN_005295c0(param_1,uVar2);
  uVar3 = *(uint *)(in_ECX[4] + 0xc);
  if (uVar2 != uVar3) {
    if (uVar3 < uVar2) {
      iVar6 = uVar2 - uVar3;
      if (iVar6 != 0) {
        iVar5 = param_1[3];
        iVar4 = param_1[2];
        do {
          if (iVar5 != 0) {
            iVar4 = iVar4 + 1;
          }
          iVar5 = 0;
          iVar4 = iVar4 + 1;
          iVar6 = iVar6 + -1;
        } while (iVar6 != 0);
        param_1[3] = 0;
        param_1[2] = iVar4;
        return;
      }
    }
    else {
      param_1[2] = param_1[2] + (uVar2 - uVar3);
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
0056bd40 : SUB ESP,0x10
0056bd43 : MOV EAX,dword ptr [ESP + 0x18]
0056bd47 : PUSH EBX
0056bd48 : PUSH EBP
0056bd49 : PUSH ESI
0056bd4a : MOV ESI,dword ptr [ESP + 0x20]
0056bd4e : PUSH EDI
0056bd4f : MOV EDI,ECX
0056bd51 : XOR ECX,ECX
0056bd53 : MOV dword ptr [EDI],EAX
0056bd55 : XOR EDX,EDX
0056bd57 : MOV dword ptr [EDI + 0x4],ECX
0056bd5a : MOV byte ptr [ESP + 0x1a],CL
0056bd5e : MOV word ptr [ESP + 0x18],DX
0056bd63 : MOV byte ptr [ESP + 0x1b],0xff
0056bd68 : MOV EAX,dword ptr [ESP + 0x18]
0056bd6c : MOV byte ptr [ESP + 0x1c],CL
0056bd70 : MOV byte ptr [ESP + 0x1d],CL
0056bd74 : MOV ECX,dword ptr [ESP + 0x1c]
0056bd78 : MOV dword ptr [EDI + 0x8],EAX
0056bd7b : XOR EBX,EBX
0056bd7d : MOV dword ptr [EDI + 0xc],ECX
0056bd80 : CMP dword ptr [ESI + 0xc],EBX
0056bd83 : JZ 0x0056bd88
0056bd85 : INC dword ptr [ESI + 0x8]
0056bd88 : MOV ECX,dword ptr [ESI + 0x8]
0056bd8b : MOV EDX,dword ptr [ESI]
0056bd8d : MOV dword ptr [ESI + 0xc],EBX
0056bd90 : MOVZX EAX,byte ptr [EDX + ECX*0x1 + 0x3]
0056bd95 : MOVZX EBP,byte ptr [EDX + ECX*0x1 + 0x2]
0056bd9a : SHL EAX,0x8
0056bd9d : OR EAX,EBP
0056bd9f : MOVZX EBP,byte ptr [EDX + ECX*0x1 + 0x1]
0056bda4 : SHL EAX,0x8
0056bda7 : OR EAX,EBP
0056bda9 : MOVZX EBP,byte ptr [EDX + ECX*0x1]
0056bdad : SHL EAX,0x8
0056bdb0 : ADD ECX,0x4
0056bdb3 : OR EAX,EBP
0056bdb5 : MOV dword ptr [ESI + 0x8],ECX
0056bdb8 : TEST dword ptr [EDI],0x20000
0056bdbe : MOV EBP,EAX
0056bdc0 : JZ 0x0056bdd7
0056bdc2 : MOV dword ptr [ESI + 0xc],EBX
0056bdc5 : MOV DL,byte ptr [ECX + EDX*0x1]
0056bdc8 : MOVZX DX,DL
0056bdcc : INC ECX
0056bdcd : MOV dword ptr [ESI + 0x8],ECX
0056bdd0 : MOV word ptr [EDI + 0x8],DX
0056bdd4 : LEA EBP,[EAX + -0x1]
0056bdd7 : CALL 0x0052b230
0056bddc : MOV ECX,dword ptr [EDI + 0x10]
0056bddf : MOV EBX,EAX
0056bde1 : TEST ECX,ECX
0056bde3 : JZ 0x0056bdea
0056bde5 : CALL 0x004ff7e0
0056bdea : PUSH EBP
0056bdeb : PUSH ESI
0056bdec : MOV ECX,EBX
0056bdee : MOV dword ptr [EDI + 0x10],EBX
0056bdf1 : CALL 0x005295c0
0056bdf6 : MOV EAX,dword ptr [EDI + 0x10]
0056bdf9 : MOV EAX,dword ptr [EAX + 0xc]
0056bdfc : CMP EBP,EAX
0056bdfe : JZ 0x0056be32
0056be00 : JBE 0x0056be2d
0056be02 : SUB EBP,EAX
0056be04 : MOV EDX,EBP
0056be06 : JZ 0x0056be32
0056be08 : MOV ECX,dword ptr [ESI + 0xc]
0056be0b : MOV EAX,dword ptr [ESI + 0x8]
0056be0e : MOV EDI,EDI
0056be10 : TEST ECX,ECX
0056be12 : JZ 0x0056be15
0056be14 : INC EAX
0056be15 : XOR ECX,ECX
0056be17 : INC EAX
0056be18 : SUB EDX,0x1
0056be1b : JNZ 0x0056be10
0056be1d : POP EDI
0056be1e : MOV dword ptr [ESI + 0xc],EDX
0056be21 : MOV dword ptr [ESI + 0x8],EAX
0056be24 : POP ESI
0056be25 : POP EBP
0056be26 : POP EBX
0056be27 : ADD ESP,0x10
0056be2a : RET 0x8
0056be2d : SUB EBP,EAX
0056be2f : ADD dword ptr [ESI + 0x8],EBP
0056be32 : POP EDI
0056be33 : POP ESI
0056be34 : POP EBP
0056be35 : POP EBX
0056be36 : ADD ESP,0x10
0056be39 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_00697a10
ENTRY    : 00697a10
BODY     : [[00697a10, 00697b17] [00697b20, 00697c47]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00697a10(uint param_1,char *param_2,undefined4 *param_3)

{
  undefined1 *puVar1;
  undefined1 *puVar2;
  undefined1 *puVar3;
  undefined1 *puVar4;
  char cVar5;
  byte bVar6;
  int iVar7;
  uint uVar8;
  int iVar9;
  void *pvVar10;
  char *pcVar11;
  int iVar12;
  uint _MaxCount;
  int iVar13;
  uint uVar14;
  byte *pbVar15;
  int local_c;
  int local_8;
  
  iVar7 = param_1;
  iVar9 = *(int *)(param_1 + 0x58);
  *param_3 = 0;
  if ((*(char *)(param_1 + 0x330) != '\0') ||
     (local_c = FUN_00697840(*(undefined4 *)(param_1 + 0x68)), local_c == 0)) {
    iVar12 = *(int *)(param_1 + 0x31c);
    param_1 = *(int *)(param_1 + 0x32c);
    local_8 = iVar12 + 8 + param_1 * 4;
    local_c = 6;
    if ((iVar9 != 0) && (param_2 != (char *)0x0)) {
      pcVar11 = param_2;
      do {
        cVar5 = *pcVar11;
        pcVar11 = pcVar11 + 1;
      } while (cVar5 != '\0');
      if ((pcVar11 != param_2 + 1) && (param_1 != 0)) {
        iVar13 = iVar12 + 7;
        iVar12 = iVar12 + 6;
        while( true ) {
          puVar1 = (undefined1 *)(iVar12 + 2);
          puVar2 = (undefined1 *)(iVar13 + 2);
          puVar3 = (undefined1 *)(iVar13 + 4);
          puVar4 = (undefined1 *)(iVar12 + 4);
          iVar12 = iVar12 + 4;
          iVar13 = iVar13 + 4;
          uVar8 = (uint)CONCAT11(*puVar4,*puVar3);
          if (CONCAT11(*puVar1,*puVar2) == *(short *)(iVar9 + 0xe)) break;
          param_1 = param_1 + -1;
          local_8 = local_8 + uVar8 * 10;
          if (param_1 == 0) {
            return 6;
          }
        }
        if (uVar8 != 0) {
          pbVar15 = (byte *)(local_8 + 5);
          param_1 = uVar8;
          do {
            bVar6 = *pbVar15;
            if ((bVar6 & 0x10) == 0) goto switchD_00697baf_default;
            uVar8 = CONCAT31(CONCAT21(CONCAT11(pbVar15[-5],pbVar15[-4]),pbVar15[-3]),pbVar15[-2]);
            uVar14 = CONCAT31(CONCAT21(CONCAT11(pbVar15[1],pbVar15[2]),pbVar15[3]),pbVar15[4]);
            if (((*(uint *)(iVar7 + 0x328) <= uVar8) ||
                (_MaxCount = *(uint *)(iVar7 + 0x328) - uVar8,
                _MaxCount <= (uint)((int)pcVar11 - (int)(param_2 + 1)))) ||
               (iVar9 = _strncmp(param_2,(char *)(*(int *)(iVar7 + 0x324) + uVar8),_MaxCount),
               iVar9 != 0)) goto switchD_00697baf_default;
            switch(bVar6 & 0xf) {
            case 0:
            case 1:
              if ((uVar14 < *(uint *)(iVar7 + 0x328)) &&
                 (pvVar10 = _memchr((void *)(*(int *)(iVar7 + 0x324) + uVar14),0,
                                    *(uint *)(iVar7 + 0x328)), pvVar10 != (void *)0x0)) {
                *param_3 = 1;
                param_3[1] = *(int *)(iVar7 + 0x324) + uVar14;
                return 0;
              }
            default:
switchD_00697baf_default:
              pbVar15 = pbVar15 + 10;
              param_1 = param_1 - 1;
              if (param_1 == 0) {
                return 6;
              }
              break;
            case 2:
              *param_3 = 2;
              goto LAB_00697c31;
            case 3:
              *param_3 = 3;
LAB_00697c31:
              param_3[1] = uVar14;
              return 0;
            }
          } while( true );
        }
      }
    }
  }
  return local_c;
}



============================================================
DISASSEMBLY
============================================================
00697a10 : MOV EAX,dword ptr [ESP + 0xc]
00697a14 : SUB ESP,0xc
00697a17 : PUSH EBP
00697a18 : MOV EBP,dword ptr [ESP + 0x14]
00697a1c : PUSH EDI
00697a1d : MOV EDI,dword ptr [EBP + 0x58]
00697a20 : MOV dword ptr [EAX],0x0
00697a26 : CMP byte ptr [EBP + 0x330],0x0
00697a2d : JNZ 0x00697a49
00697a2f : MOV ECX,dword ptr [EBP + 0x68]
00697a32 : PUSH ECX
00697a33 : MOV ECX,EBP
00697a35 : CALL 0x00697840
00697a3a : ADD ESP,0x4
00697a3d : MOV dword ptr [ESP + 0x8],EAX
00697a41 : TEST EAX,EAX
00697a43 : JNZ 0x00697c3e
00697a49 : MOV EAX,dword ptr [EBP + 0x31c]
00697a4f : PUSH ESI
00697a50 : MOV ESI,dword ptr [EBP + 0x32c]
00697a56 : ADD EAX,0x8
00697a59 : LEA EDX,[EAX + ESI*0x4]
00697a5c : MOV dword ptr [ESP + 0x1c],ESI
00697a60 : MOV dword ptr [ESP + 0x10],EDX
00697a64 : MOV dword ptr [ESP + 0xc],0x6
00697a6c : TEST EDI,EDI
00697a6e : JZ 0x00697c3d
00697a74 : MOV ECX,dword ptr [ESP + 0x20]
00697a78 : TEST ECX,ECX
00697a7a : JZ 0x00697c3d
00697a80 : PUSH EBX
00697a81 : LEA EBX,[ECX + 0x1]
00697a84 : MOV DL,byte ptr [ECX]
00697a86 : INC ECX
00697a87 : TEST DL,DL
00697a89 : JNZ 0x00697a84
00697a8b : SUB ECX,EBX
00697a8d : MOV dword ptr [ESP + 0x18],ECX
00697a91 : JZ 0x00697c3c
00697a97 : TEST ESI,ESI
00697a99 : JBE 0x00697c3c
00697a9f : MOVZX EBX,word ptr [EDI + 0xe]
00697aa3 : LEA EDX,[EAX + -0x1]
00697aa6 : LEA ECX,[EAX + -0x2]
00697aa9 : LEA ESP,[ESP]
00697ab0 : MOVZX EAX,byte ptr [ECX + 0x2]
00697ab4 : ADD ECX,0x2
00697ab7 : SHL AX,0x8
00697abb : MOVZX ESI,AX
00697abe : MOVZX EAX,byte ptr [EDX + 0x2]
00697ac2 : ADD EDX,0x2
00697ac5 : MOVZX EDI,byte ptr [EDX + 0x2]
00697ac9 : OR ESI,EAX
00697acb : MOVZX EAX,byte ptr [ECX + 0x2]
00697acf : ADD ECX,0x2
00697ad2 : SHL AX,0x8
00697ad6 : ADD EDX,0x2
00697ad9 : MOVZX EAX,AX
00697adc : OR EAX,EDI
00697ade : CMP ESI,EBX
00697ae0 : JZ 0x00697b03
00697ae2 : SUB dword ptr [ESP + 0x20],0x1
00697ae7 : MOV ESI,dword ptr [ESP + 0x14]
00697aeb : LEA EAX,[EAX + EAX*0x4]
00697aee : LEA EAX,[ESI + EAX*0x2]
00697af1 : MOV dword ptr [ESP + 0x14],EAX
00697af5 : JNZ 0x00697ab0
00697af7 : MOV EAX,dword ptr [ESP + 0x10]
00697afb : POP EBX
00697afc : POP ESI
00697afd : POP EDI
00697afe : POP EBP
00697aff : ADD ESP,0xc
00697b02 : RET
00697b03 : MOV dword ptr [ESP + 0x20],EAX
00697b07 : TEST EAX,EAX
00697b09 : JBE 0x00697c3c
00697b0f : MOV EDI,dword ptr [ESP + 0x14]
00697b13 : ADD EDI,0x5
00697b16 : JMP 0x00697b20
00697b20 : MOVZX CX,byte ptr [EDI + -0x1]
00697b25 : MOVZX EDX,byte ptr [EDI]
00697b28 : SHL CX,0x8
00697b2c : MOVZX EBX,CX
00697b2f : OR EBX,EDX
00697b31 : TEST BL,0x10
00697b34 : JZ 0x00697bd8
00697b3a : MOVZX EAX,byte ptr [EDI + -0x5]
00697b3e : MOVZX ECX,byte ptr [EDI + -0x4]
00697b42 : MOVZX EDX,byte ptr [EDI + -0x3]
00697b46 : MOVZX ESI,byte ptr [EDI + 0x1]
00697b4a : SHL EAX,0x8
00697b4d : OR EAX,ECX
00697b4f : MOVZX ECX,byte ptr [EDI + -0x2]
00697b53 : SHL EAX,0x8
00697b56 : OR EAX,EDX
00697b58 : MOVZX EDX,byte ptr [EDI + 0x2]
00697b5c : SHL ESI,0x8
00697b5f : OR ESI,EDX
00697b61 : MOVZX EDX,byte ptr [EDI + 0x4]
00697b65 : SHL EAX,0x8
00697b68 : OR EAX,ECX
00697b6a : MOVZX ECX,byte ptr [EDI + 0x3]
00697b6e : SHL ESI,0x8
00697b71 : OR ESI,ECX
00697b73 : MOV ECX,dword ptr [EBP + 0x328]
00697b79 : SHL ESI,0x8
00697b7c : OR ESI,EDX
00697b7e : CMP EAX,ECX
00697b80 : JNC 0x00697bd8
00697b82 : SUB ECX,EAX
00697b84 : CMP dword ptr [ESP + 0x18],ECX
00697b88 : JNC 0x00697bd8
00697b8a : MOV EDX,dword ptr [ESP + 0x24]
00697b8e : PUSH ECX
00697b8f : MOV ECX,dword ptr [EBP + 0x324]
00697b95 : ADD ECX,EAX
00697b97 : PUSH ECX
00697b98 : PUSH EDX
00697b99 : CALL 0x0063abcb
00697b9e : ADD ESP,0xc
00697ba1 : TEST EAX,EAX
00697ba3 : JNZ 0x00697bd8
00697ba5 : MOV EAX,EBX
00697ba7 : AND EAX,0xf
00697baa : CMP EAX,0x3
00697bad : JA 0x00697bd8
00697baf : JMP dword ptr [EAX*0x4 + 0x697c48]
00697bb6 : MOV EAX,dword ptr [EBP + 0x328]
00697bbc : CMP ESI,EAX
00697bbe : JNC 0x00697bd8
00697bc0 : PUSH EAX
00697bc1 : MOV EAX,dword ptr [EBP + 0x324]
00697bc7 : ADD EAX,ESI
00697bc9 : PUSH 0x0
00697bcb : PUSH EAX
00697bcc : CALL 0x00635250
00697bd1 : ADD ESP,0xc
00697bd4 : TEST EAX,EAX
00697bd6 : JNZ 0x00697bf2
00697bd8 : ADD EDI,0xa
00697bdb : SUB dword ptr [ESP + 0x20],0x1
00697be0 : JNZ 0x00697b20
00697be6 : MOV EAX,dword ptr [ESP + 0x10]
00697bea : POP EBX
00697beb : POP ESI
00697bec : POP EDI
00697bed : POP EBP
00697bee : ADD ESP,0xc
00697bf1 : RET
00697bf2 : MOV EAX,dword ptr [ESP + 0x28]
00697bf6 : MOV dword ptr [EAX],0x1
00697bfc : MOV ECX,dword ptr [EBP + 0x324]
00697c02 : POP EBX
00697c03 : ADD ECX,ESI
00697c05 : POP ESI
00697c06 : MOV dword ptr [ESP + 0x8],0x0
00697c0e : POP EDI
00697c0f : MOV dword ptr [EAX + 0x4],ECX
00697c12 : MOV EAX,dword ptr [ESP + 0x4]
00697c16 : POP EBP
00697c17 : ADD ESP,0xc
00697c1a : RET
00697c1b : MOV EAX,dword ptr [ESP + 0x28]
00697c1f : MOV dword ptr [EAX],0x2
00697c25 : JMP 0x00697c31
00697c27 : MOV EAX,dword ptr [ESP + 0x28]
00697c2b : MOV dword ptr [EAX],0x3
00697c31 : MOV dword ptr [EAX + 0x4],ESI
00697c34 : MOV dword ptr [ESP + 0x10],0x0
00697c3c : POP EBX
00697c3d : POP ESI
00697c3e : MOV EAX,dword ptr [ESP + 0x8]
00697c42 : POP EDI
00697c43 : POP EBP
00697c44 : ADD ESP,0xc
00697c47 : RET

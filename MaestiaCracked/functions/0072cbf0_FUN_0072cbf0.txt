PROGRAM  : Maestia.exe
FUNCTION : FUN_0072cbf0
ENTRY    : 0072cbf0
BODY     : [[0072cbf0, 0072ce65]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0072cbf0(undefined4 param_1,int param_2)

{
  ushort uVar1;
  int *piVar2;
  int iVar3;
  short *psVar4;
  undefined4 uVar5;
  int iVar6;
  int in_ECX;
  ushort *****pppppuVar7;
  undefined4 extraout_EDX;
  int extraout_EDX_00;
  int extraout_EDX_01;
  int iVar8;
  ushort *puVar9;
  bool bVar10;
  undefined8 uVar11;
  undefined1 local_40 [4];
  int local_3c;
  char local_35;
  int local_34 [2];
  ushort ****local_2c [4];
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b15f01;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_3c = in_ECX;
  uVar11 = FUN_0072c4c0(local_34);
  iVar6 = (int)((ulonglong)uVar11 >> 0x20);
  piVar2 = (int *)uVar11;
  if (piVar2 != (int *)0x0) {
    if ((short)*piVar2 == 0x3c) {
      iVar6 = local_34[0];
      if ((*piVar2 != 0x3f003c) &&
         (((*piVar2 != 0x21003c || ((char)piVar2[1] != '-')) || (*(char *)((int)piVar2 + 5) != '\0')
          ))) {
        uVar11 = FUN_0072c990(in_ECX,(short *)((int)piVar2 + 2),&local_35);
        iVar6 = (int)((ulonglong)uVar11 >> 0x20);
        iVar3 = (int)uVar11;
        if (iVar3 != 0) {
          if (*(int *)(param_2 + 0x40) == 0) {
            *(int *)(param_2 + 0x40) = iVar3;
            *(int *)(iVar3 + 0x3c) = iVar3;
            *(int *)(iVar3 + 0x38) = iVar3;
          }
          else {
            *(int *)(iVar3 + 0x38) = *(int *)(param_2 + 0x40);
            *(undefined4 *)(iVar3 + 0x3c) = *(undefined4 *)(*(int *)(param_2 + 0x40) + 0x3c);
            iVar6 = *(int *)(*(int *)(param_2 + 0x40) + 0x3c);
            *(int *)(iVar6 + 0x38) = iVar3;
            *(int *)(*(int *)(param_2 + 0x40) + 0x3c) = iVar3;
          }
          if (local_35 != '\x01') {
            psVar4 = (short *)FUN_0072c4c0(local_34);
            if (*psVar4 == 0x3c) {
              FUN_00405c00(iVar3 + 0x1c);
              uVar11 = CONCAT44(extraout_EDX,psVar4);
            }
            else {
              uVar5 = FUN_0072c830(psVar4);
              local_8 = 0;
              FUN_00405d70(uVar5);
              local_8 = 0xffffffff;
              FUN_00406560();
              uVar11 = FUN_0072c4c0(local_34);
            }
            iVar8 = (int)uVar11;
            while( true ) {
              iVar6 = (int)((ulonglong)uVar11 >> 0x20);
              psVar4 = (short *)uVar11;
              if (iVar8 == 0) break;
              if ((*psVar4 == 0x3c) && (psVar4[1] == 0x2f)) {
                local_18 = 7;
                local_1c = 0;
                local_2c[0] = (ushort ****)((uint)local_2c[0] & 0xffff0000);
                local_8 = 1;
                uVar5 = FUN_0072c3d0(local_34[0] + -3,local_34,local_40,&DAT_00c02a50);
                uVar5 = FUN_0072c830(uVar5);
                local_8._0_1_ = 2;
                FUN_00405eb0(uVar5,0,0xffffffff);
                local_8 = CONCAT31(local_8._1_3_,1);
                FUN_00406560();
                pppppuVar7 = (ushort *****)local_2c[0];
                if (local_18 < 8) {
                  pppppuVar7 = local_2c;
                }
                if (*(uint *)(iVar3 + 0x18) < 8) {
                  puVar9 = (ushort *)(iVar3 + 4);
                }
                else {
                  puVar9 = *(ushort **)(iVar3 + 4);
                }
                goto LAB_0072ce00;
              }
              uVar11 = FUN_0072cbf0(psVar4,iVar3);
              iVar6 = (int)((ulonglong)uVar11 >> 0x20);
              if ((int)uVar11 == 0) break;
              uVar11 = FUN_0072c4c0(local_34);
              iVar8 = (int)uVar11;
            }
          }
        }
      }
    }
    else {
      *(undefined **)(in_ECX + 0x48) = &DAT_00c02a14;
    }
  }
  goto LAB_0072cc44;
  while( true ) {
    uVar1 = puVar9[1];
    bVar10 = uVar1 < *(ushort *)((int)pppppuVar7 + 2);
    if (uVar1 != *(ushort *)((int)pppppuVar7 + 2)) goto LAB_0072ce26;
    puVar9 = puVar9 + 2;
    pppppuVar7 = pppppuVar7 + 1;
    if (uVar1 == 0) break;
LAB_0072ce00:
    uVar1 = *puVar9;
    bVar10 = uVar1 < *(ushort *)pppppuVar7;
    if (uVar1 != *(ushort *)pppppuVar7) {
LAB_0072ce26:
      iVar6 = (1 - (uint)bVar10) - (uint)(bVar10 != 0);
      goto LAB_0072ce2b;
    }
    if (uVar1 == 0) break;
  }
  iVar6 = 0;
LAB_0072ce2b:
  if (iVar6 == 0) {
    local_8 = 0xffffffff;
    FUN_00406560();
    iVar6 = extraout_EDX_01;
  }
  else {
    *(undefined **)(local_3c + 0x48) = &DAT_00c02a58;
    local_8 = 0xffffffff;
    FUN_00406560();
    iVar6 = extraout_EDX_00;
  }
LAB_0072cc44:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc,iVar6);
  return;
}



============================================================
DISASSEMBLY
============================================================
0072cbf0 : PUSH EBP
0072cbf1 : MOV EBP,ESP
0072cbf3 : PUSH -0x1
0072cbf5 : PUSH 0xb15f01
0072cbfa : MOV EAX,FS:[0x0]
0072cc00 : PUSH EAX
0072cc01 : SUB ESP,0x4c
0072cc04 : MOV EAX,[0x00d66fa0]
0072cc09 : XOR EAX,EBP
0072cc0b : MOV dword ptr [EBP + -0x10],EAX
0072cc0e : PUSH EBX
0072cc0f : PUSH ESI
0072cc10 : PUSH EDI
0072cc11 : PUSH EAX
0072cc12 : LEA EAX,[EBP + -0xc]
0072cc15 : MOV FS:[0x0],EAX
0072cc1b : MOV EAX,dword ptr [EBP + 0x8]
0072cc1e : MOV EBX,dword ptr [EBP + 0xc]
0072cc21 : MOV EDI,ECX
0072cc23 : LEA ECX,[EBP + -0x30]
0072cc26 : PUSH ECX
0072cc27 : MOV dword ptr [EBP + -0x38],EDI
0072cc2a : CALL 0x0072c4c0
0072cc2f : MOV ESI,EAX
0072cc31 : TEST ESI,ESI
0072cc33 : JZ 0x0072cc42
0072cc35 : CMP word ptr [ESI],0x3c
0072cc39 : JZ 0x0072cc62
0072cc3b : MOV dword ptr [EDI + 0x48],0xc02a14
0072cc42 : XOR EAX,EAX
0072cc44 : MOV ECX,dword ptr [EBP + -0xc]
0072cc47 : MOV dword ptr FS:[0x0],ECX
0072cc4e : POP ECX
0072cc4f : POP EDI
0072cc50 : POP ESI
0072cc51 : POP EBX
0072cc52 : MOV ECX,dword ptr [EBP + -0x10]
0072cc55 : XOR ECX,EBP
0072cc57 : CALL 0x00633e6b
0072cc5c : MOV ESP,EBP
0072cc5e : POP EBP
0072cc5f : RET 0x8
0072cc62 : MOV EAX,dword ptr [ESI]
0072cc64 : CMP EAX,0x3f003c
0072cc69 : JZ 0x0072cc7e
0072cc6b : CMP EAX,0x21003c
0072cc70 : JNZ 0x0072cc86
0072cc72 : CMP byte ptr [ESI + 0x4],0x2d
0072cc76 : JNZ 0x0072cc86
0072cc78 : CMP byte ptr [ESI + 0x5],0x0
0072cc7c : JNZ 0x0072cc86
0072cc7e : MOV EDX,dword ptr [EBP + -0x30]
0072cc81 : LEA EAX,[ESI + EDX*0x2]
0072cc84 : JMP 0x0072cc44
0072cc86 : MOV ECX,dword ptr [EBP + -0x30]
0072cc89 : LEA EAX,[EBP + -0x31]
0072cc8c : PUSH EAX
0072cc8d : LEA EDX,[ESI + 0x2]
0072cc90 : PUSH EDX
0072cc91 : ADD ECX,-0x2
0072cc94 : PUSH EDI
0072cc95 : CALL 0x0072c990
0072cc9a : MOV EDI,EAX
0072cc9c : TEST EDI,EDI
0072cc9e : JZ 0x0072cc42
0072cca0 : MOV ECX,dword ptr [EBX + 0x40]
0072cca3 : MOV EAX,dword ptr [EBP + -0x30]
0072cca6 : LEA EAX,[ESI + EAX*0x2]
0072cca9 : TEST ECX,ECX
0072ccab : JNZ 0x0072ccb8
0072ccad : MOV dword ptr [EBX + 0x40],EDI
0072ccb0 : MOV dword ptr [EDI + 0x3c],EDI
0072ccb3 : MOV dword ptr [EDI + 0x38],EDI
0072ccb6 : JMP 0x0072ccd3
0072ccb8 : MOV dword ptr [EDI + 0x38],ECX
0072ccbb : MOV ECX,dword ptr [EBX + 0x40]
0072ccbe : MOV EDX,dword ptr [ECX + 0x3c]
0072ccc1 : MOV dword ptr [EDI + 0x3c],EDX
0072ccc4 : MOV ECX,dword ptr [EBX + 0x40]
0072ccc7 : MOV EDX,dword ptr [ECX + 0x3c]
0072ccca : MOV dword ptr [EDX + 0x38],EDI
0072cccd : MOV ECX,dword ptr [EBX + 0x40]
0072ccd0 : MOV dword ptr [ECX + 0x3c],EDI
0072ccd3 : CMP byte ptr [EBP + -0x31],0x1
0072ccd7 : JZ 0x0072cc44
0072ccdd : LEA EDX,[EBP + -0x30]
0072cce0 : PUSH EDX
0072cce1 : CALL 0x0072c4c0
0072cce6 : MOV ESI,EAX
0072cce8 : CMP word ptr [ESI],0x3c
0072ccec : JZ 0x0072cd2d
0072ccee : MOV EBX,dword ptr [EBP + -0x30]
0072ccf1 : PUSH ESI
0072ccf2 : MOV EDX,EBX
0072ccf4 : LEA ECX,[EBP + -0x2c]
0072ccf7 : CALL 0x0072c830
0072ccfc : MOV dword ptr [EBP + -0x4],0x0
0072cd03 : PUSH EAX
0072cd04 : LEA ECX,[EDI + 0x1c]
0072cd07 : CALL 0x00405d70
0072cd0c : MOV dword ptr [EBP + -0x4],0xffffffff
0072cd13 : LEA ECX,[EBP + -0x2c]
0072cd16 : CALL 0x00406560
0072cd1b : LEA EAX,[EBP + -0x30]
0072cd1e : LEA ESI,[ESI + EBX*0x2]
0072cd21 : PUSH EAX
0072cd22 : MOV EAX,ESI
0072cd24 : CALL 0x0072c4c0
0072cd29 : MOV ESI,EAX
0072cd2b : JMP 0x0072cd3b
0072cd2d : LEA ECX,[EDI + 0x1c]
0072cd30 : PUSH ECX
0072cd31 : MOV EDX,0xc02a4c
0072cd36 : CALL 0x00405c00
0072cd3b : TEST ESI,ESI
0072cd3d : JZ 0x0072cc42
0072cd43 : MOV EBX,0x2f
0072cd48 : CMP word ptr [ESI],0x3c
0072cd4c : JNZ 0x0072cd54
0072cd4e : CMP word ptr [ESI + 0x2],BX
0072cd52 : JZ 0x0072cd7a
0072cd54 : MOV ECX,dword ptr [EBP + -0x38]
0072cd57 : PUSH EDI
0072cd58 : PUSH ESI
0072cd59 : CALL 0x0072cbf0
0072cd5e : TEST EAX,EAX
0072cd60 : JZ 0x0072cc42
0072cd66 : LEA EDX,[EBP + -0x30]
0072cd69 : PUSH EDX
0072cd6a : CALL 0x0072c4c0
0072cd6f : MOV ESI,EAX
0072cd71 : TEST ESI,ESI
0072cd73 : JNZ 0x0072cd48
0072cd75 : JMP 0x0072cc42
0072cd7a : XOR EAX,EAX
0072cd7c : MOV dword ptr [EBP + -0x14],0x7
0072cd83 : MOV dword ptr [EBP + -0x18],0x0
0072cd8a : MOV word ptr [EBP + -0x28],AX
0072cd8e : MOV dword ptr [EBP + -0x4],0x1
0072cd95 : MOV EBX,dword ptr [EBP + -0x30]
0072cd98 : PUSH 0xc02a50
0072cd9d : LEA ECX,[EBP + -0x3c]
0072cda0 : PUSH ECX
0072cda1 : LEA EDX,[EBP + -0x30]
0072cda4 : PUSH EDX
0072cda5 : LEA EAX,[EBX + -0x3]
0072cda8 : PUSH EAX
0072cda9 : LEA EAX,[ESI + 0x4]
0072cdac : CALL 0x0072c3d0
0072cdb1 : MOV EDX,dword ptr [EBP + -0x30]
0072cdb4 : PUSH EAX
0072cdb5 : LEA ECX,[EBP + -0x58]
0072cdb8 : CALL 0x0072c830
0072cdbd : MOV byte ptr [EBP + -0x4],0x2
0072cdc1 : PUSH -0x1
0072cdc3 : PUSH 0x0
0072cdc5 : PUSH EAX
0072cdc6 : LEA ECX,[EBP + -0x2c]
0072cdc9 : CALL 0x00405eb0
0072cdce : MOV byte ptr [EBP + -0x4],0x1
0072cdd2 : LEA ECX,[EBP + -0x58]
0072cdd5 : CALL 0x00406560
0072cdda : MOV ECX,dword ptr [EBP + -0x28]
0072cddd : MOV EAX,0x8
0072cde2 : CMP dword ptr [EBP + -0x14],EAX
0072cde5 : JNC 0x0072cdea
0072cde7 : LEA ECX,[EBP + -0x28]
0072cdea : CMP dword ptr [EDI + 0x18],EAX
0072cded : JC 0x0072cdf4
0072cdef : MOV EDI,dword ptr [EDI + 0x4]
0072cdf2 : JMP 0x0072cdf7
0072cdf4 : ADD EDI,0x4
0072cdf7 : MOV EAX,EDI
0072cdf9 : LEA ESP,[ESP]
0072ce00 : MOV DX,word ptr [EAX]
0072ce03 : CMP DX,word ptr [ECX]
0072ce06 : JNZ 0x0072ce26
0072ce08 : TEST DX,DX
0072ce0b : JZ 0x0072ce22
0072ce0d : MOV DX,word ptr [EAX + 0x2]
0072ce11 : CMP DX,word ptr [ECX + 0x2]
0072ce15 : JNZ 0x0072ce26
0072ce17 : ADD EAX,0x4
0072ce1a : ADD ECX,0x4
0072ce1d : TEST DX,DX
0072ce20 : JNZ 0x0072ce00
0072ce22 : XOR EAX,EAX
0072ce24 : JMP 0x0072ce2b
0072ce26 : SBB EAX,EAX
0072ce28 : SBB EAX,-0x1
0072ce2b : TEST EAX,EAX
0072ce2d : JZ 0x0072ce4d
0072ce2f : MOV ECX,dword ptr [EBP + -0x38]
0072ce32 : MOV dword ptr [ECX + 0x48],0xc02a58
0072ce39 : MOV dword ptr [EBP + -0x4],0xffffffff
0072ce40 : LEA ECX,[EBP + -0x2c]
0072ce43 : CALL 0x00406560
0072ce48 : JMP 0x0072cc42
0072ce4d : LEA ESI,[ESI + EBX*0x2]
0072ce50 : MOV dword ptr [EBP + -0x4],0xffffffff
0072ce57 : LEA ECX,[EBP + -0x2c]
0072ce5a : CALL 0x00406560
0072ce5f : MOV EAX,ESI
0072ce61 : JMP 0x0072cc44

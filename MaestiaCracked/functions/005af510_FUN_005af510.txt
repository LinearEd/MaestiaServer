PROGRAM  : Maestia.exe
FUNCTION : FUN_005af510
ENTRY    : 005af510
BODY     : [[005af510, 005af5d4]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005af510(undefined1 *param_1,int param_2)

{
  undefined4 *puVar1;
  uint uVar2;
  undefined4 uVar3;
  uint *in_ECX;
  undefined4 uVar4;
  
  if ((param_2 != 0) && (param_1 != (undefined1 *)0x0)) {
    switch(*param_1) {
    case 0x20:
      *(byte *)((int)in_ECX + 6) = *(byte *)((int)in_ECX + 6) | 2;
      break;
    default:
      FUN_005ae800(param_1,param_2);
      return;
    case 0x23:
      *(byte *)((int)in_ECX + 6) = *(byte *)((int)in_ECX + 6) | 8;
      break;
    case 0x2b:
      *(byte *)((int)in_ECX + 5) = *(byte *)((int)in_ECX + 5) | 0x80;
      break;
    case 0x2d:
      *(byte *)((int)in_ECX + 6) = *(byte *)((int)in_ECX + 6) | 4;
      break;
    case 0x2e:
      *in_ECX = *in_ECX & 0xffffffe0;
      uVar4 = 0x3a;
      uVar2 = *in_ECX & 0x1f;
      uVar3 = FUN_005adf30(1);
      uVar2 = FUN_005ae6a0(uVar3,uVar2,uVar4);
      *in_ECX = *in_ECX ^ (*in_ECX ^ uVar2) & 0x1f;
      return;
    case 0x30:
      *(byte *)(in_ECX + 1) = (byte)in_ECX[1] & 0xb0 | 0x30;
    }
    puVar1 = (undefined4 *)FUN_005adf30(1);
    FUN_005af510(*puVar1,puVar1[1]);
    return;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005af510 : CMP dword ptr [ESP + 0x8],0x0
005af515 : PUSH ESI
005af516 : MOV ESI,ECX
005af518 : JZ 0x005af5d1
005af51e : MOV ECX,dword ptr [ESP + 0x8]
005af522 : TEST ECX,ECX
005af524 : JZ 0x005af5d1
005af52a : MOVSX EAX,byte ptr [ECX]
005af52d : ADD EAX,-0x20
005af530 : CMP EAX,0x10
005af533 : JA 0x005af5bc
005af539 : MOVZX EAX,byte ptr [EAX + 0x5af5f4]
005af540 : JMP dword ptr [EAX*0x4 + 0x5af5d8]
005af547 : OR byte ptr [ESI + 0x6],0x4
005af54b : PUSH 0x1
005af54d : LEA ECX,[ESP + 0xc]
005af551 : CALL 0x005adf30
005af556 : MOV EDX,dword ptr [EAX]
005af558 : SUB ESP,0x8
005af55b : MOV ECX,ESP
005af55d : MOV dword ptr [ECX],EDX
005af55f : MOV EAX,dword ptr [EAX + 0x4]
005af562 : MOV dword ptr [ECX + 0x4],EAX
005af565 : MOV ECX,ESI
005af567 : CALL 0x005af510
005af56c : POP ESI
005af56d : RET 0x8
005af570 : OR byte ptr [ESI + 0x6],0x2
005af574 : JMP 0x005af54b
005af576 : AND dword ptr [ESI],0xffffffe0
005af579 : MOV EAX,dword ptr [ESI]
005af57b : PUSH 0x3a
005af57d : AND EAX,0x1f
005af580 : PUSH EAX
005af581 : PUSH 0x1
005af583 : LEA ECX,[ESP + 0x14]
005af587 : CALL 0x005adf30
005af58c : PUSH EAX
005af58d : CALL 0x005ae6a0
005af592 : MOV ECX,dword ptr [ESI]
005af594 : XOR ECX,EAX
005af596 : AND ECX,0x1f
005af599 : ADD ESP,0xc
005af59c : XOR dword ptr [ESI],ECX
005af59e : POP ESI
005af59f : RET 0x8
005af5a2 : OR byte ptr [ESI + 0x5],0x80
005af5a6 : JMP 0x005af54b
005af5a8 : OR byte ptr [ESI + 0x6],0x8
005af5ac : JMP 0x005af54b
005af5ae : MOV CL,byte ptr [ESI + 0x4]
005af5b1 : AND CL,0xb0
005af5b4 : OR CL,0x30
005af5b7 : MOV byte ptr [ESI + 0x4],CL
005af5ba : JMP 0x005af54b
005af5bc : SUB ESP,0x8
005af5bf : MOV EAX,ESP
005af5c1 : MOV dword ptr [EAX],ECX
005af5c3 : MOV ECX,dword ptr [ESP + 0x14]
005af5c7 : MOV dword ptr [EAX + 0x4],ECX
005af5ca : MOV ECX,ESI
005af5cc : CALL 0x005ae800
005af5d1 : POP ESI
005af5d2 : RET 0x8

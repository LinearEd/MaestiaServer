PROGRAM  : Maestia.exe
FUNCTION : __cftoe_l
ENTRY    : 00656537
BODY     : [[00656537, 00656606]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    __cftoe_l
   
   Library: Visual Studio 2008 Release */

void __cftoe_l(double *param_1,undefined1 *param_2,int param_3,int param_4,undefined4 param_5,
              undefined4 param_6)

{
  int *piVar1;
  size_t _SizeInBytes;
  errno_t eVar2;
  _strflt local_30;
  char local_20 [24];
  uint local_8;
  
  local_8 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  __fltout2((_CRT_DOUBLE)*param_1,&local_30,local_20,0x16);
  if ((param_2 == (undefined1 *)0x0) || (param_3 == 0)) {
    piVar1 = __errno();
    *piVar1 = 0x16;
    __invalid_parameter(0,0,0,0,0);
  }
  else {
    if (param_3 == -1) {
      _SizeInBytes = 0xffffffff;
    }
    else {
      _SizeInBytes = (param_3 - (uint)(local_30.sign == 0x2d)) - (uint)(0 < param_4);
    }
    eVar2 = __fptostr(param_2 + (uint)(0 < param_4) + (uint)(local_30.sign == 0x2d),_SizeInBytes,
                      param_4 + 1,&local_30);
    if (eVar2 == 0) {
      __cftoe2_l(param_3,param_4,param_5,&local_30,0,param_6);
    }
    else {
      *param_2 = 0;
    }
  }
  __security_check_cookie(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00656537 : MOV EDI,EDI
00656539 : PUSH EBP
0065653a : MOV EBP,ESP
0065653c : SUB ESP,0x2c
0065653f : MOV EAX,[0x00d66fa0]
00656544 : XOR EAX,EBP
00656546 : MOV dword ptr [EBP + -0x4],EAX
00656549 : MOV EAX,dword ptr [EBP + 0x8]
0065654c : PUSH EBX
0065654d : PUSH ESI
0065654e : PUSH EDI
0065654f : MOV EDI,dword ptr [EBP + 0xc]
00656552 : PUSH 0x16
00656554 : POP ESI
00656555 : PUSH ESI
00656556 : LEA ECX,[EBP + -0x1c]
00656559 : PUSH ECX
0065655a : LEA ECX,[EBP + -0x2c]
0065655d : PUSH ECX
0065655e : PUSH dword ptr [EAX + 0x4]
00656561 : PUSH dword ptr [EAX]
00656563 : CALL 0x0065fc48
00656568 : XOR EBX,EBX
0065656a : ADD ESP,0x14
0065656d : CMP EDI,EBX
0065656f : JNZ 0x00656589
00656571 : CALL 0x0063ab82
00656576 : PUSH EBX
00656577 : PUSH EBX
00656578 : PUSH EBX
00656579 : PUSH EBX
0065657a : PUSH EBX
0065657b : MOV dword ptr [EAX],ESI
0065657d : CALL 0x006372b8
00656582 : ADD ESP,0x14
00656585 : MOV EAX,ESI
00656587 : JMP 0x006565f8
00656589 : MOV EAX,dword ptr [EBP + 0x10]
0065658c : CMP EAX,EBX
0065658e : JBE 0x00656571
00656590 : MOV ESI,dword ptr [EBP + 0x14]
00656593 : CMP EAX,-0x1
00656596 : JNZ 0x0065659d
00656598 : OR EAX,0xffffffff
0065659b : JMP 0x006565b1
0065659d : XOR ECX,ECX
0065659f : CMP dword ptr [EBP + -0x2c],0x2d
006565a3 : SETZ CL
006565a6 : SUB EAX,ECX
006565a8 : XOR ECX,ECX
006565aa : CMP ESI,EBX
006565ac : SETG CL
006565af : SUB EAX,ECX
006565b1 : LEA ECX,[EBP + -0x2c]
006565b4 : PUSH ECX
006565b5 : LEA ECX,[ESI + 0x1]
006565b8 : PUSH ECX
006565b9 : PUSH EAX
006565ba : XOR EAX,EAX
006565bc : CMP dword ptr [EBP + -0x2c],0x2d
006565c0 : SETZ AL
006565c3 : XOR ECX,ECX
006565c5 : CMP ESI,EBX
006565c7 : SETG CL
006565ca : ADD EAX,EDI
006565cc : ADD ECX,EAX
006565ce : PUSH ECX
006565cf : CALL 0x0065fad1
006565d4 : ADD ESP,0x10
006565d7 : CMP EAX,EBX
006565d9 : JZ 0x006565df
006565db : MOV byte ptr [EDI],BL
006565dd : JMP 0x006565f8
006565df : PUSH dword ptr [EBP + 0x1c]
006565e2 : LEA EAX,[EBP + -0x2c]
006565e5 : PUSH EBX
006565e6 : PUSH EAX
006565e7 : PUSH dword ptr [EBP + 0x18]
006565ea : MOV EAX,EDI
006565ec : PUSH ESI
006565ed : PUSH dword ptr [EBP + 0x10]
006565f0 : CALL 0x006563c8
006565f5 : ADD ESP,0x18
006565f8 : MOV ECX,dword ptr [EBP + -0x4]
006565fb : POP EDI
006565fc : POP ESI
006565fd : XOR ECX,EBP
006565ff : POP EBX
00656600 : CALL 0x00633e6b
00656605 : LEAVE
00656606 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_0077bee0
ENTRY    : 0077bee0
BODY     : [[0077bee0, 0077bf5e]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_0077bee0(undefined4 *param_1)

{
  char cVar1;
  int in_ECX;
  
  if (param_1[1] == 3) {
    (**(code **)*param_1)(1);
    FUN_007471c0();
    FUN_0077bb60();
    SetEvent(*(HANDLE *)(in_ECX + 0x50));
    *(undefined4 *)(in_ECX + 0x54) = 0;
    return (undefined4 *)0x0;
  }
  cVar1 = FUN_0077bac0();
  if (cVar1 != '\0') {
    FUN_0077bd90();
    (**(code **)*param_1)(1);
    return (undefined4 *)0x0;
  }
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
0077bee0 : PUSH EBP
0077bee1 : MOV EBP,ESP
0077bee3 : PUSH EBX
0077bee4 : MOV EBX,dword ptr [EBP + 0x8]
0077bee7 : CMP dword ptr [EBX + 0x4],0x3
0077beeb : PUSH ESI
0077beec : PUSH EDI
0077beed : MOV ESI,ECX
0077beef : JZ 0x0077bf2b
0077bef1 : LEA ECX,[ESI + 0x60]
0077bef4 : LEA EDI,[EBX + 0xc]
0077bef7 : MOV ESI,EDI
0077bef9 : MOV dword ptr [EBP + 0x8],ECX
0077befc : CALL 0x0077bac0
0077bf01 : TEST AL,AL
0077bf03 : JZ 0x0077bf22
0077bf05 : MOV ECX,EDI
0077bf07 : MOV EDI,dword ptr [EBP + 0x8]
0077bf0a : CALL 0x0077bd90
0077bf0f : MOV EAX,dword ptr [EBX]
0077bf11 : MOV EDX,dword ptr [EAX]
0077bf13 : PUSH 0x1
0077bf15 : MOV ECX,EBX
0077bf17 : CALL EDX
0077bf19 : POP EDI
0077bf1a : POP ESI
0077bf1b : XOR EAX,EAX
0077bf1d : POP EBX
0077bf1e : POP EBP
0077bf1f : RET 0x4
0077bf22 : POP EDI
0077bf23 : POP ESI
0077bf24 : MOV EAX,EBX
0077bf26 : POP EBX
0077bf27 : POP EBP
0077bf28 : RET 0x4
0077bf2b : MOV EAX,dword ptr [EBX]
0077bf2d : MOV EDX,dword ptr [EAX]
0077bf2f : PUSH 0x1
0077bf31 : MOV ECX,EBX
0077bf33 : CALL EDX
0077bf35 : MOV EDI,dword ptr [ESI + 0x40]
0077bf38 : CALL 0x007471c0
0077bf3d : LEA ECX,[ESI + 0x60]
0077bf40 : CALL 0x0077bb60
0077bf45 : MOV EAX,dword ptr [ESI + 0x50]
0077bf48 : PUSH EAX
0077bf49 : CALL dword ptr [0x00b851e8]
0077bf4f : POP EDI
0077bf50 : MOV dword ptr [ESI + 0x54],0x0
0077bf57 : POP ESI
0077bf58 : XOR EAX,EAX
0077bf5a : POP EBX
0077bf5b : POP EBP
0077bf5c : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_006841d0
ENTRY    : 006841d0
BODY     : [[006841d0, 00684233]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_006841d0(undefined4 *param_1,undefined4 *param_2)

{
  char cVar1;
  char *pcVar2;
  char *pcVar3;
  uint uVar4;
  int iVar5;
  int *in_ECX;
  
  if (*in_ECX != 0) {
    pcVar2 = (char *)*param_2;
    pcVar3 = pcVar2;
    do {
      cVar1 = *pcVar3;
      pcVar3 = pcVar3 + 1;
    } while (cVar1 != '\0');
    uVar4 = FUN_0051b340(pcVar2,(int)pcVar3 - (int)(pcVar2 + 1),0x1505);
    iVar5 = FUN_00684150(param_2,*(uint *)(*in_ECX + 4) & uVar4);
    if (-1 < iVar5) {
      *param_1 = in_ECX;
      param_1[1] = iVar5;
      return param_1;
    }
  }
  *param_1 = 0;
  param_1[1] = 0;
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
006841d0 : PUSH ESI
006841d1 : MOV ESI,ECX
006841d3 : CMP dword ptr [ESI],0x0
006841d6 : JZ 0x0068421f
006841d8 : PUSH EBX
006841d9 : PUSH EDI
006841da : MOV EDI,dword ptr [ESP + 0x14]
006841de : MOV ECX,dword ptr [EDI]
006841e0 : MOV EAX,ECX
006841e2 : LEA EBX,[EAX + 0x1]
006841e5 : MOV DL,byte ptr [EAX]
006841e7 : INC EAX
006841e8 : TEST DL,DL
006841ea : JNZ 0x006841e5
006841ec : PUSH 0x1505
006841f1 : SUB EAX,EBX
006841f3 : PUSH EAX
006841f4 : PUSH ECX
006841f5 : CALL 0x0051b340
006841fa : MOV ECX,dword ptr [ESI]
006841fc : MOV EDX,dword ptr [ECX + 0x4]
006841ff : AND EDX,EAX
00684201 : PUSH EDX
00684202 : PUSH EDI
00684203 : MOV ECX,ESI
00684205 : CALL 0x00684150
0068420a : POP EDI
0068420b : POP EBX
0068420c : TEST EAX,EAX
0068420e : JL 0x0068421f
00684210 : MOV ECX,dword ptr [ESP + 0x8]
00684214 : MOV dword ptr [ECX],ESI
00684216 : MOV dword ptr [ECX + 0x4],EAX
00684219 : MOV EAX,ECX
0068421b : POP ESI
0068421c : RET 0x8
0068421f : MOV EAX,dword ptr [ESP + 0x8]
00684223 : MOV dword ptr [EAX],0x0
00684229 : MOV dword ptr [EAX + 0x4],0x0
00684230 : POP ESI
00684231 : RET 0x8

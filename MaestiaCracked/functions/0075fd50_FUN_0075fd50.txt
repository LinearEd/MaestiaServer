PROGRAM  : Maestia.exe
FUNCTION : FUN_0075fd50
ENTRY    : 0075fd50
BODY     : [[0075fd50, 0075ffc9]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0075fd50(int param_1)

{
  LPCWSTR lpWideCharStr;
  FILE *_File;
  long lVar1;
  int in_ECX;
  undefined4 local_114;
  undefined4 local_110;
  long local_10c;
  CHAR local_108 [256];
  uint local_8;
  
  local_8 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  if (*(uint *)(param_1 + 0x18) < 8) {
    lpWideCharStr = (LPCWSTR)(param_1 + 4);
  }
  else {
    lpWideCharStr = *(LPCWSTR *)(param_1 + 4);
  }
  WideCharToMultiByte(0,0,lpWideCharStr,-1,local_108,0x100,(LPCSTR)0x0,(LPBOOL)0x0);
  _File = _fopen(local_108,"wb");
  if (_File == (FILE *)0x0) {
    __security_check_cookie(local_8 ^ (uint)&stack0xfffffffc);
    return;
  }
  local_114 = 0x19741031;
  local_110 = 0x9090909;
  lVar1 = _ftell(_File);
  _fwrite(&local_110,4,1,_File);
  local_10c = _ftell(_File);
  _fwrite(&local_10c,4,1,_File);
  _fwrite(&local_114,4,1,_File);
  FUN_00767e10(local_10c,lVar1);
  local_114 = 0x20051225;
  local_110 = 0x38383838;
  lVar1 = _ftell(_File);
  _fwrite(&local_110,4,1,_File);
  local_10c = _ftell(_File);
  _fwrite(&local_10c,4,1,_File);
  _fwrite(&local_114,4,1,_File);
  FUN_00767e10(local_10c,lVar1);
  local_110 = 0x10381038;
  lVar1 = _ftell(_File);
  _fwrite(&local_110,4,1,_File);
  local_10c = _ftell(_File);
  _fwrite(&local_10c,4,1,_File);
  _fwrite((void *)(in_ECX + 0x3c),2,1,_File);
  FUN_00767e10(local_10c,lVar1);
  local_110 = 0x12345678;
  lVar1 = _ftell(_File);
  _fwrite(&local_110,4,1,_File);
  local_10c = _ftell(_File);
  _fwrite(&local_10c,4,1,_File);
  _fwrite((void *)(in_ECX + 0x40),4,1,_File);
  FUN_00767e10(local_10c,lVar1);
  local_110 = 0x89498949;
  lVar1 = _ftell(_File);
  _fwrite(&local_110,4,1,_File);
  local_10c = _ftell(_File);
  _fwrite(&local_10c,4,1,_File);
  FUN_0075f880(in_ECX);
  FUN_00767e10(local_10c,lVar1);
  _fclose(_File);
  __security_check_cookie(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0075fd50 : PUSH EBP
0075fd51 : MOV EBP,ESP
0075fd53 : SUB ESP,0x110
0075fd59 : MOV EAX,[0x00d66fa0]
0075fd5e : XOR EAX,EBP
0075fd60 : MOV dword ptr [EBP + -0x4],EAX
0075fd63 : MOV EAX,dword ptr [EBP + 0x8]
0075fd66 : CMP dword ptr [EAX + 0x18],0x8
0075fd6a : PUSH ESI
0075fd6b : PUSH EDI
0075fd6c : MOV EDI,ECX
0075fd6e : JC 0x0075fd75
0075fd70 : MOV EAX,dword ptr [EAX + 0x4]
0075fd73 : JMP 0x0075fd78
0075fd75 : ADD EAX,0x4
0075fd78 : PUSH 0x0
0075fd7a : PUSH 0x0
0075fd7c : PUSH 0x100
0075fd81 : LEA ECX,[EBP + 0xfffffefc]
0075fd87 : PUSH ECX
0075fd88 : PUSH -0x1
0075fd8a : PUSH EAX
0075fd8b : PUSH 0x0
0075fd8d : PUSH 0x0
0075fd8f : CALL dword ptr [0x00b85130]
0075fd95 : LEA EDX,[EBP + 0xfffffefc]
0075fd9b : PUSH 0xc0c3ac
0075fda0 : PUSH EDX
0075fda1 : CALL 0x00638fa0
0075fda6 : MOV ESI,EAX
0075fda8 : ADD ESP,0x8
0075fdab : TEST ESI,ESI
0075fdad : JNZ 0x0075fdc3
0075fdaf : POP EDI
0075fdb0 : XOR AL,AL
0075fdb2 : POP ESI
0075fdb3 : MOV ECX,dword ptr [EBP + -0x4]
0075fdb6 : XOR ECX,EBP
0075fdb8 : CALL 0x00633e6b
0075fdbd : MOV ESP,EBP
0075fdbf : POP EBP
0075fdc0 : RET 0x4
0075fdc3 : PUSH EBX
0075fdc4 : PUSH ESI
0075fdc5 : MOV dword ptr [EBP + 0xfffffef0],0x19741031
0075fdcf : MOV dword ptr [EBP + 0xfffffef4],0x9090909
0075fdd9 : CALL 0x0063751f
0075fdde : PUSH ESI
0075fddf : PUSH 0x1
0075fde1 : MOV EBX,EAX
0075fde3 : LEA EAX,[EBP + 0xfffffef4]
0075fde9 : PUSH 0x4
0075fdeb : PUSH EAX
0075fdec : CALL 0x006376ef
0075fdf1 : PUSH ESI
0075fdf2 : CALL 0x0063751f
0075fdf7 : PUSH ESI
0075fdf8 : PUSH 0x1
0075fdfa : LEA ECX,[EBP + 0xfffffef8]
0075fe00 : PUSH 0x4
0075fe02 : PUSH ECX
0075fe03 : MOV dword ptr [EBP + 0xfffffef8],EAX
0075fe09 : CALL 0x006376ef
0075fe0e : PUSH ESI
0075fe0f : PUSH 0x1
0075fe11 : LEA EDX,[EBP + 0xfffffef0]
0075fe17 : PUSH 0x4
0075fe19 : PUSH EDX
0075fe1a : CALL 0x006376ef
0075fe1f : MOV EAX,dword ptr [EBP + 0xfffffef8]
0075fe25 : PUSH EBX
0075fe26 : PUSH EAX
0075fe27 : CALL 0x00767e10
0075fe2c : ADD ESP,0x40
0075fe2f : PUSH ESI
0075fe30 : MOV dword ptr [EBP + 0xfffffef0],0x20051225
0075fe3a : MOV dword ptr [EBP + 0xfffffef4],0x38383838
0075fe44 : CALL 0x0063751f
0075fe49 : PUSH ESI
0075fe4a : PUSH 0x1
0075fe4c : LEA ECX,[EBP + 0xfffffef4]
0075fe52 : PUSH 0x4
0075fe54 : PUSH ECX
0075fe55 : MOV EBX,EAX
0075fe57 : CALL 0x006376ef
0075fe5c : PUSH ESI
0075fe5d : CALL 0x0063751f
0075fe62 : PUSH ESI
0075fe63 : PUSH 0x1
0075fe65 : LEA EDX,[EBP + 0xfffffef8]
0075fe6b : PUSH 0x4
0075fe6d : PUSH EDX
0075fe6e : MOV dword ptr [EBP + 0xfffffef8],EAX
0075fe74 : CALL 0x006376ef
0075fe79 : PUSH ESI
0075fe7a : PUSH 0x1
0075fe7c : LEA EAX,[EBP + 0xfffffef0]
0075fe82 : PUSH 0x4
0075fe84 : PUSH EAX
0075fe85 : CALL 0x006376ef
0075fe8a : MOV ECX,dword ptr [EBP + 0xfffffef8]
0075fe90 : PUSH EBX
0075fe91 : PUSH ECX
0075fe92 : CALL 0x00767e10
0075fe97 : ADD ESP,0x40
0075fe9a : PUSH ESI
0075fe9b : MOV dword ptr [EBP + 0xfffffef4],0x10381038
0075fea5 : CALL 0x0063751f
0075feaa : PUSH ESI
0075feab : PUSH 0x1
0075fead : LEA EDX,[EBP + 0xfffffef4]
0075feb3 : PUSH 0x4
0075feb5 : PUSH EDX
0075feb6 : MOV EBX,EAX
0075feb8 : CALL 0x006376ef
0075febd : PUSH ESI
0075febe : CALL 0x0063751f
0075fec3 : PUSH ESI
0075fec4 : PUSH 0x1
0075fec6 : MOV dword ptr [EBP + 0xfffffef8],EAX
0075fecc : PUSH 0x4
0075fece : LEA EAX,[EBP + 0xfffffef8]
0075fed4 : PUSH EAX
0075fed5 : CALL 0x006376ef
0075feda : PUSH ESI
0075fedb : PUSH 0x1
0075fedd : LEA ECX,[EDI + 0x3c]
0075fee0 : PUSH 0x2
0075fee2 : PUSH ECX
0075fee3 : CALL 0x006376ef
0075fee8 : MOV EDX,dword ptr [EBP + 0xfffffef8]
0075feee : PUSH EBX
0075feef : PUSH EDX
0075fef0 : CALL 0x00767e10
0075fef5 : ADD ESP,0x40
0075fef8 : PUSH ESI
0075fef9 : MOV dword ptr [EBP + 0xfffffef4],0x12345678
0075ff03 : CALL 0x0063751f
0075ff08 : PUSH ESI
0075ff09 : PUSH 0x1
0075ff0b : MOV EBX,EAX
0075ff0d : LEA EAX,[EBP + 0xfffffef4]
0075ff13 : PUSH 0x4
0075ff15 : PUSH EAX
0075ff16 : CALL 0x006376ef
0075ff1b : PUSH ESI
0075ff1c : CALL 0x0063751f
0075ff21 : PUSH ESI
0075ff22 : PUSH 0x1
0075ff24 : LEA ECX,[EBP + 0xfffffef8]
0075ff2a : PUSH 0x4
0075ff2c : PUSH ECX
0075ff2d : MOV dword ptr [EBP + 0xfffffef8],EAX
0075ff33 : CALL 0x006376ef
0075ff38 : PUSH ESI
0075ff39 : PUSH 0x1
0075ff3b : LEA EDX,[EDI + 0x40]
0075ff3e : PUSH 0x4
0075ff40 : PUSH EDX
0075ff41 : CALL 0x006376ef
0075ff46 : MOV EAX,dword ptr [EBP + 0xfffffef8]
0075ff4c : PUSH EBX
0075ff4d : PUSH EAX
0075ff4e : CALL 0x00767e10
0075ff53 : ADD ESP,0x40
0075ff56 : PUSH ESI
0075ff57 : MOV dword ptr [EBP + 0xfffffef4],0x89498949
0075ff61 : CALL 0x0063751f
0075ff66 : PUSH ESI
0075ff67 : PUSH 0x1
0075ff69 : LEA ECX,[EBP + 0xfffffef4]
0075ff6f : PUSH 0x4
0075ff71 : PUSH ECX
0075ff72 : MOV EBX,EAX
0075ff74 : CALL 0x006376ef
0075ff79 : PUSH ESI
0075ff7a : CALL 0x0063751f
0075ff7f : PUSH ESI
0075ff80 : PUSH 0x1
0075ff82 : LEA EDX,[EBP + 0xfffffef8]
0075ff88 : PUSH 0x4
0075ff8a : PUSH EDX
0075ff8b : MOV dword ptr [EBP + 0xfffffef8],EAX
0075ff91 : CALL 0x006376ef
0075ff96 : ADD ESP,0x28
0075ff99 : PUSH EDI
0075ff9a : CALL 0x0075f880
0075ff9f : MOV EAX,dword ptr [EBP + 0xfffffef8]
0075ffa5 : PUSH EBX
0075ffa6 : PUSH EAX
0075ffa7 : CALL 0x00767e10
0075ffac : PUSH ESI
0075ffad : CALL 0x006366db
0075ffb2 : MOV ECX,dword ptr [EBP + -0x4]
0075ffb5 : ADD ESP,0xc
0075ffb8 : POP EBX
0075ffb9 : POP EDI
0075ffba : XOR ECX,EBP
0075ffbc : MOV AL,0x1
0075ffbe : POP ESI
0075ffbf : CALL 0x00633e6b
0075ffc4 : MOV ESP,EBP
0075ffc6 : POP EBP
0075ffc7 : RET 0x4

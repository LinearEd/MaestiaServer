PROGRAM  : Maestia.exe
FUNCTION : FUN_00831aa0
ENTRY    : 00831aa0
BODY     : [[00831aa0, 00831cf6]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00831aa0(void)

{
  wchar_t wVar1;
  bool bVar2;
  bool bVar3;
  short sVar4;
  uint uVar5;
  int iVar6;
  wchar_t *pwVar7;
  wchar_t *in_ECX;
  int iVar8;
  uint local_13c;
  uint local_120;
  int local_11c;
  wchar_t local_114;
  undefined1 local_112 [252];
  undefined2 local_16;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1b3e7;
  local_10 = ExceptionList;
  uVar5 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  bVar3 = false;
  pwVar7 = in_ECX;
  do {
    wVar1 = *pwVar7;
    pwVar7 = pwVar7 + 1;
  } while (wVar1 != L'\0');
  local_14 = uVar5;
  if ((int)pwVar7 - (int)(in_ECX + 1) >> 1 != 0) {
    _memset(&local_114,0,0x100);
    pwVar7 = in_ECX;
    do {
      wVar1 = *pwVar7;
      pwVar7 = pwVar7 + 1;
    } while (wVar1 != L'\0');
    _wcsncpy(&local_114,in_ECX,(int)pwVar7 - (int)(in_ECX + 1) >> 1);
    local_16 = 0;
    sVar4 = FUN_00634f4d(&local_114);
    if (sVar4 == 0) {
      pwVar7 = &local_114;
      do {
        wVar1 = *pwVar7;
        pwVar7 = pwVar7 + 1;
      } while (wVar1 != L'\0');
      iVar6 = (int)pwVar7 - (int)local_112 >> 1;
      iVar8 = 0;
      if (0 < iVar6) {
        do {
          if (*(short *)(local_112 + iVar8 * 2 + -2) == 0x5f) {
            *(undefined2 *)(local_112 + iVar8 * 2 + -2) = 0x20;
          }
          iVar8 = iVar8 + 1;
        } while (iVar8 < iVar6);
      }
      local_11c = 1;
      do {
        iVar6 = FUN_00703c00(0x700);
        if (iVar6 == 0) {
LAB_00831bda:
          bVar2 = true;
        }
        else {
          iVar8 = FUN_00404350(iVar6 + 0x18);
          bVar3 = true;
          if (*(int *)(iVar8 + 0x14) == 0) goto LAB_00831bda;
          bVar2 = false;
        }
        local_8 = 0xffffffff;
        if (bVar3) {
          bVar3 = false;
          if (7 < local_120) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          local_120 = 7;
        }
        if (!bVar2) {
          iVar6 = FUN_00404350(iVar6 + 0x18);
          local_8 = 1;
          if (*(uint *)(iVar6 + 0x18) < 8) {
            pwVar7 = (wchar_t *)(iVar6 + 4);
          }
          else {
            pwVar7 = *(wchar_t **)(iVar6 + 4);
          }
          pwVar7 = _wcsstr(&local_114,pwVar7);
          local_8 = 0xffffffff;
          if (7 < local_13c) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          local_13c = 7;
          if (pwVar7 != (wchar_t *)0x0) break;
        }
        local_8 = 0xffffffff;
        local_11c = local_11c + 1;
      } while (local_11c < 0xffff);
    }
    else {
      FUN_00703c00(0x700,uVar5);
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00831aa0 : PUSH EBP
00831aa1 : MOV EBP,ESP
00831aa3 : PUSH -0x1
00831aa5 : PUSH 0xb1b3e7
00831aaa : MOV EAX,FS:[0x0]
00831ab0 : PUSH EAX
00831ab1 : SUB ESP,0x144
00831ab7 : MOV EAX,[0x00d66fa0]
00831abc : XOR EAX,EBP
00831abe : MOV dword ptr [EBP + -0x10],EAX
00831ac1 : PUSH EBX
00831ac2 : PUSH ESI
00831ac3 : PUSH EDI
00831ac4 : PUSH EAX
00831ac5 : LEA EAX,[EBP + -0xc]
00831ac8 : MOV FS:[0x0],EAX
00831ace : MOV ESI,ECX
00831ad0 : MOV EAX,ESI
00831ad2 : MOV dword ptr [EBP + 0xfffffeec],0x0
00831adc : LEA EDX,[EAX + 0x2]
00831adf : NOP
00831ae0 : MOV CX,word ptr [EAX]
00831ae3 : ADD EAX,0x2
00831ae6 : TEST CX,CX
00831ae9 : JNZ 0x00831ae0
00831aeb : SUB EAX,EDX
00831aed : SAR EAX,0x1
00831aef : JZ 0x00831cbc
00831af5 : PUSH 0x100
00831afa : LEA EAX,[EBP + 0xfffffef0]
00831b00 : PUSH 0x0
00831b02 : PUSH EAX
00831b03 : CALL 0x0063b700
00831b08 : MOV EAX,ESI
00831b0a : ADD ESP,0xc
00831b0d : LEA EDX,[EAX + 0x2]
00831b10 : MOV CX,word ptr [EAX]
00831b13 : ADD EAX,0x2
00831b16 : TEST CX,CX
00831b19 : JNZ 0x00831b10
00831b1b : SUB EAX,EDX
00831b1d : SAR EAX,0x1
00831b1f : PUSH EAX
00831b20 : LEA ECX,[EBP + 0xfffffef0]
00831b26 : PUSH ESI
00831b27 : PUSH ECX
00831b28 : CALL 0x00634e39
00831b2d : LEA EAX,[EBP + 0xfffffef0]
00831b33 : XOR EDX,EDX
00831b35 : PUSH EAX
00831b36 : MOV word ptr [EBP + -0x12],DX
00831b3a : CALL 0x00634f4d
00831b3f : MOVZX EDI,AX
00831b42 : ADD ESP,0x10
00831b45 : TEST DI,DI
00831b48 : JNZ 0x00831ce0
00831b4e : LEA EAX,[EBP + 0xfffffef0]
00831b54 : LEA EDX,[EAX + 0x2]
00831b57 : MOV CX,word ptr [EAX]
00831b5a : ADD EAX,0x2
00831b5d : TEST CX,CX
00831b60 : JNZ 0x00831b57
00831b62 : SUB EAX,EDX
00831b64 : SAR EAX,0x1
00831b66 : XOR ECX,ECX
00831b68 : TEST EAX,EAX
00831b6a : JLE 0x00831b8d
00831b6c : LEA ESP,[ESP]
00831b70 : CMP word ptr [EBP + ECX*0x2 + 0xfffffef0],0x5f
00831b79 : JNZ 0x00831b88
00831b7b : MOV EDX,0x20
00831b80 : MOV word ptr [EBP + ECX*0x2 + 0xfffffef0],DX
00831b88 : INC ECX
00831b89 : CMP ECX,EAX
00831b8b : JL 0x00831b70
00831b8d : MOV dword ptr [EBP + 0xfffffee8],0x1
00831b97 : MOV EDI,dword ptr [EBP + 0xfffffee8]
00831b9d : PUSH 0x700
00831ba2 : CALL 0x00703c00
00831ba7 : MOV EDI,EAX
00831ba9 : ADD ESP,0x4
00831bac : TEST EDI,EDI
00831bae : JZ 0x00831bda
00831bb0 : LEA EAX,[EDI + 0x18]
00831bb3 : PUSH EAX
00831bb4 : LEA ESI,[EBP + 0xfffffecc]
00831bba : CALL 0x00404350
00831bbf : ADD ESP,0x4
00831bc2 : MOV dword ptr [EBP + -0x4],0x0
00831bc9 : OR dword ptr [EBP + 0xfffffeec],0x1
00831bd0 : CMP dword ptr [EAX + 0x14],0x0
00831bd4 : JZ 0x00831bda
00831bd6 : XOR BL,BL
00831bd8 : JMP 0x00831bdc
00831bda : MOV BL,0x1
00831bdc : MOV dword ptr [EBP + -0x4],0xffffffff
00831be3 : TEST byte ptr [EBP + 0xfffffeec],0x1
00831bea : JZ 0x00831c24
00831bec : AND dword ptr [EBP + 0xfffffeec],0xfffffffe
00831bf3 : CMP dword ptr [EBP + 0xfffffee4],0x8
00831bfa : JC 0x00831c07
00831bfc : MOV ECX,dword ptr [EBP + 0xfffffed0]
00831c02 : CALL 0x006f04e0
00831c07 : XOR ECX,ECX
00831c09 : MOV dword ptr [EBP + 0xfffffee4],0x7
00831c13 : MOV dword ptr [EBP + 0xfffffee0],0x0
00831c1d : MOV word ptr [EBP + 0xfffffed0],CX
00831c24 : TEST BL,BL
00831c26 : JNZ 0x00831ca4
00831c2c : LEA EDX,[EDI + 0x18]
00831c2f : PUSH EDX
00831c30 : LEA ESI,[EBP + 0xfffffeb0]
00831c36 : CALL 0x00404350
00831c3b : ADD ESP,0x4
00831c3e : MOV dword ptr [EBP + -0x4],0x1
00831c45 : CMP dword ptr [EAX + 0x18],0x8
00831c49 : JC 0x00831c50
00831c4b : MOV EAX,dword ptr [EAX + 0x4]
00831c4e : JMP 0x00831c53
00831c50 : ADD EAX,0x4
00831c53 : PUSH EAX
00831c54 : LEA EAX,[EBP + 0xfffffef0]
00831c5a : PUSH EAX
00831c5b : CALL 0x006347ba
00831c60 : ADD ESP,0x8
00831c63 : TEST EAX,EAX
00831c65 : SETNZ BL
00831c68 : MOV dword ptr [EBP + -0x4],0xffffffff
00831c6f : CMP dword ptr [EBP + 0xfffffec8],0x8
00831c76 : JC 0x00831c83
00831c78 : MOV ECX,dword ptr [EBP + 0xfffffeb4]
00831c7e : CALL 0x006f04e0
00831c83 : XOR ECX,ECX
00831c85 : MOV dword ptr [EBP + 0xfffffec8],0x7
00831c8f : MOV dword ptr [EBP + 0xfffffec4],0x0
00831c99 : MOV word ptr [EBP + 0xfffffeb4],CX
00831ca0 : TEST BL,BL
00831ca2 : JNZ 0x00831cda
00831ca4 : MOV EAX,dword ptr [EBP + 0xfffffee8]
00831caa : INC EAX
00831cab : CMP EAX,0xffff
00831cb0 : MOV dword ptr [EBP + 0xfffffee8],EAX
00831cb6 : JL 0x00831b97
00831cbc : XOR EAX,EAX
00831cbe : MOV ECX,dword ptr [EBP + -0xc]
00831cc1 : MOV dword ptr FS:[0x0],ECX
00831cc8 : POP ECX
00831cc9 : POP EDI
00831cca : POP ESI
00831ccb : POP EBX
00831ccc : MOV ECX,dword ptr [EBP + -0x10]
00831ccf : XOR ECX,EBP
00831cd1 : CALL 0x00633e6b
00831cd6 : MOV ESP,EBP
00831cd8 : POP EBP
00831cd9 : RET
00831cda : MOV AX,word ptr [EDI + 0x6]
00831cde : JMP 0x00831cbe
00831ce0 : PUSH 0x700
00831ce5 : CALL 0x00703c00
00831cea : ADD ESP,0x4
00831ced : TEST EAX,EAX
00831cef : JZ 0x00831cbc
00831cf1 : MOV AX,word ptr [EAX + 0x6]
00831cf5 : JMP 0x00831cbe

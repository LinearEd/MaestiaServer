PROGRAM  : Maestia.exe
FUNCTION : FUN_00561fa0
ENTRY    : 00561fa0
BODY     : [[00561fa0, 0056201f]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00561fa0(undefined4 *param_1,int param_2)

{
  int iVar1;
  int *in_ECX;
  int *piVar2;
  int iVar3;
  
  piVar2 = (int *)(param_2 * 0x10 + 8 + *in_ECX);
  if ((*(int *)(param_2 * 0x10 + 8 + *in_ECX) != -2) && (iVar3 = param_2, piVar2[1] == param_2)) {
    while ((piVar2[1] != param_2 ||
           (iVar1 = FUN_0051b280((piVar2[2] & 0xfffffffcU) + 8,(*(uint *)*param_1 & 0xfffffffc) + 8)
           , iVar1 != 0))) {
      iVar3 = *piVar2;
      if (iVar3 == -1) {
        return -1;
      }
      piVar2 = (int *)(iVar3 * 0x10 + 8 + *in_ECX);
    }
    return iVar3;
  }
  return -1;
}



============================================================
DISASSEMBLY
============================================================
00561fa0 : MOV EAX,dword ptr [ESP + 0x8]
00561fa4 : PUSH EBP
00561fa5 : MOV EBP,ECX
00561fa7 : MOV EDX,dword ptr [EBP]
00561faa : MOV ECX,EAX
00561fac : SHL ECX,0x4
00561faf : CMP dword ptr [ECX + EDX*0x1 + 0x8],-0x2
00561fb4 : PUSH ESI
00561fb5 : LEA ESI,[ECX + EDX*0x1 + 0x8]
00561fb9 : PUSH EDI
00561fba : MOV EDI,EAX
00561fbc : JZ 0x00562017
00561fbe : CMP dword ptr [ESI + 0x4],EAX
00561fc1 : JNZ 0x00562017
00561fc3 : PUSH EBX
00561fc4 : MOV EBX,dword ptr [ESP + 0x14]
00561fc8 : CMP dword ptr [ESI + 0x4],EAX
00561fcb : JNZ 0x00561fef
00561fcd : MOV EAX,dword ptr [EBX]
00561fcf : MOV EAX,dword ptr [EAX]
00561fd1 : MOV ECX,dword ptr [ESI + 0x8]
00561fd4 : AND EAX,0xfffffffc
00561fd7 : AND ECX,0xfffffffc
00561fda : ADD EAX,0x8
00561fdd : PUSH EAX
00561fde : ADD ECX,0x8
00561fe1 : PUSH ECX
00561fe2 : CALL 0x0051b280
00561fe7 : TEST EAX,EAX
00561fe9 : JZ 0x00562004
00561feb : MOV EAX,dword ptr [ESP + 0x18]
00561fef : MOV EDI,dword ptr [ESI]
00561ff1 : CMP EDI,-0x1
00561ff4 : JZ 0x0056200d
00561ff6 : MOV EDX,dword ptr [EBP]
00561ff9 : MOV ECX,EDI
00561ffb : SHL ECX,0x4
00561ffe : LEA ESI,[ECX + EDX*0x1 + 0x8]
00562002 : JMP 0x00561fc8
00562004 : POP EBX
00562005 : MOV EAX,EDI
00562007 : POP EDI
00562008 : POP ESI
00562009 : POP EBP
0056200a : RET 0x8
0056200d : POP EBX
0056200e : POP EDI
0056200f : POP ESI
00562010 : OR EAX,0xffffffff
00562013 : POP EBP
00562014 : RET 0x8
00562017 : POP EDI
00562018 : POP ESI
00562019 : OR EAX,0xffffffff
0056201c : POP EBP
0056201d : RET 0x8

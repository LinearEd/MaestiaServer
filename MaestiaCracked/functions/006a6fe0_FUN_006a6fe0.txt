PROGRAM  : Maestia.exe
FUNCTION : FUN_006a6fe0
ENTRY    : 006a6fe0
BODY     : [[006a6fe0, 006a7086] [006a7090, 006a7191]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006a6fe0(int param_1,int param_2,int param_3,int param_4,int param_5)

{
  byte *pbVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int *piVar5;
  int iVar6;
  int *piVar7;
  int iVar8;
  int local_c;
  
  iVar3 = FUN_006877c0(param_2,param_3 + param_4);
  if ((iVar3 == 0) && (iVar3 = FUN_00688900(param_2,param_5), iVar3 == 0)) {
    pbVar1 = *(byte **)(param_2 + 0x20);
    if ((param_5 == 0) || ((*pbVar1 & 0x80) == 0)) {
      iVar3 = FUN_006a6850(param_1,pbVar1,pbVar1 + param_5);
      FUN_006889b0(param_2);
      return iVar3;
    }
    iVar6 = *(int *)(param_1 + 0x10);
    iVar2 = *(int *)(param_1 + 0x1c);
    iVar3 = FUN_006a6cf0(param_1,pbVar1,pbVar1 + param_5);
    FUN_006889b0(param_2);
    if ((iVar3 == 0) && (iVar4 = *(int *)(param_1 + 0x10) - iVar6, 0 < iVar4)) {
      iVar6 = iVar6 * 0x18;
      local_c = 0;
      do {
        iVar8 = (int)*(short *)(iVar2 + 0x16);
        iVar3 = FUN_006a6fe0(param_1,param_2,param_3,
                             *(undefined4 *)(*(int *)(param_1 + 0x18) + iVar6 + 0x10),
                             *(undefined4 *)(*(int *)(param_1 + 0x18) + 0x14 + iVar6));
        if (iVar3 != 0) {
          return iVar3;
        }
        piVar7 = (int *)(*(int *)(param_1 + 0x18) + iVar6);
        iVar3 = *(short *)(iVar2 + 0x16) - iVar8;
        if ((*piVar7 == 0x10000) && (piVar7[1] == 0x10000)) {
          piVar5 = (int *)(*(int *)(iVar2 + 0x18) + iVar8 * 8);
          if (0 < iVar3) {
            do {
              *piVar5 = *piVar5 + piVar7[2];
              piVar5[1] = piVar5[1] + piVar7[3];
              piVar5 = piVar5 + 2;
              iVar3 = iVar3 + -1;
            } while (iVar3 != 0);
          }
        }
        else {
          piVar5 = (int *)(*(int *)(iVar2 + 0x18) + iVar8 * 8);
          if (0 < iVar3) {
            do {
              iVar8 = FUN_00685ea0(*piVar5,*piVar7);
              *piVar5 = iVar8 + piVar7[2];
              iVar8 = FUN_00685ea0(piVar5[1],piVar7[1]);
              piVar5[1] = iVar8 + piVar7[3];
              piVar5 = piVar5 + 2;
              iVar3 = iVar3 + -1;
            } while (iVar3 != 0);
          }
        }
        iVar6 = iVar6 + 0x18;
        local_c = local_c + 1;
      } while (local_c < iVar4);
      return 0;
    }
  }
  return iVar3;
}



============================================================
DISASSEMBLY
============================================================
006a6fe0 : MOV EAX,dword ptr [ESP + 0x10]
006a6fe4 : MOV ECX,dword ptr [ESP + 0xc]
006a6fe8 : SUB ESP,0x10
006a6feb : PUSH ESI
006a6fec : MOV ESI,dword ptr [ESP + 0x1c]
006a6ff0 : ADD ECX,EAX
006a6ff2 : PUSH ECX
006a6ff3 : PUSH ESI
006a6ff4 : CALL 0x006877c0
006a6ff9 : ADD ESP,0x8
006a6ffc : TEST EAX,EAX
006a6ffe : JNZ 0x006a718d
006a7004 : PUSH EDI
006a7005 : MOV EDI,dword ptr [ESP + 0x2c]
006a7009 : PUSH EDI
006a700a : PUSH ESI
006a700b : CALL 0x00688900
006a7010 : ADD ESP,0x8
006a7013 : TEST EAX,EAX
006a7015 : JNZ 0x006a718c
006a701b : MOV EAX,dword ptr [ESI + 0x20]
006a701e : LEA ECX,[EAX + EDI*0x1]
006a7021 : TEST EDI,EDI
006a7023 : JBE 0x006a7169
006a7029 : TEST byte ptr [EAX],0x80
006a702c : JZ 0x006a7169
006a7032 : PUSH EBX
006a7033 : MOV EBX,dword ptr [ESP + 0x20]
006a7037 : MOV EDI,dword ptr [EBX + 0x10]
006a703a : PUSH EBP
006a703b : MOV EBP,dword ptr [EBX + 0x1c]
006a703e : PUSH ECX
006a703f : PUSH EAX
006a7040 : PUSH EBX
006a7041 : MOV dword ptr [ESP + 0x24],EBP
006a7045 : CALL 0x006a6cf0
006a704a : PUSH ESI
006a704b : MOV dword ptr [ESP + 0x20],EAX
006a704f : CALL 0x006889b0
006a7054 : MOV ECX,dword ptr [ESP + 0x20]
006a7058 : ADD ESP,0x10
006a705b : TEST ECX,ECX
006a705d : JNZ 0x006a7188
006a7063 : MOV EAX,dword ptr [EBX + 0x10]
006a7066 : SUB EAX,EDI
006a7068 : MOV dword ptr [ESP + 0x1c],EAX
006a706c : MOV dword ptr [ESP + 0x14],ECX
006a7070 : TEST EAX,EAX
006a7072 : JLE 0x006a7188
006a7078 : LEA ECX,[EDI + EDI*0x2]
006a707b : ADD ECX,ECX
006a707d : ADD ECX,ECX
006a707f : ADD ECX,ECX
006a7081 : MOV dword ptr [ESP + 0x30],ECX
006a7085 : JMP 0x006a7098
006a7090 : MOV ESI,dword ptr [ESP + 0x28]
006a7094 : MOV ECX,dword ptr [ESP + 0x30]
006a7098 : MOV EAX,dword ptr [EBX + 0x18]
006a709b : MOV EDX,dword ptr [EAX + ECX*0x1 + 0x14]
006a709f : MOVSX EDI,word ptr [EBP + 0x16]
006a70a3 : ADD EAX,ECX
006a70a5 : MOV EAX,dword ptr [EAX + 0x10]
006a70a8 : MOV ECX,dword ptr [ESP + 0x2c]
006a70ac : PUSH EDX
006a70ad : PUSH EAX
006a70ae : PUSH ECX
006a70af : PUSH ESI
006a70b0 : PUSH EBX
006a70b1 : CALL 0x006a6fe0
006a70b6 : MOV EDX,EAX
006a70b8 : ADD ESP,0x14
006a70bb : MOV dword ptr [ESP + 0x10],EDX
006a70bf : TEST EDX,EDX
006a70c1 : JNZ 0x006a715f
006a70c7 : MOV ESI,dword ptr [EBX + 0x18]
006a70ca : MOVSX ECX,word ptr [EBP + 0x16]
006a70ce : ADD ESI,dword ptr [ESP + 0x30]
006a70d2 : SUB ECX,EDI
006a70d4 : CMP dword ptr [ESI],0x10000
006a70da : JNZ 0x006a7105
006a70dc : CMP dword ptr [ESI + 0x4],0x10000
006a70e3 : JNZ 0x006a7105
006a70e5 : MOV EAX,dword ptr [EBP + 0x18]
006a70e8 : LEA EAX,[EAX + EDI*0x8]
006a70eb : TEST ECX,ECX
006a70ed : JLE 0x006a7147
006a70ef : NOP
006a70f0 : MOV EDI,dword ptr [ESI + 0x8]
006a70f3 : ADD dword ptr [EAX],EDI
006a70f5 : MOV EDI,dword ptr [ESI + 0xc]
006a70f8 : ADD dword ptr [EAX + 0x4],EDI
006a70fb : ADD EAX,0x8
006a70fe : SUB ECX,0x1
006a7101 : JNZ 0x006a70f0
006a7103 : JMP 0x006a7147
006a7105 : MOV EAX,dword ptr [EBP + 0x18]
006a7108 : LEA EDI,[EAX + EDI*0x8]
006a710b : TEST ECX,ECX
006a710d : JLE 0x006a7147
006a710f : MOV EBP,ECX
006a7111 : MOV ECX,dword ptr [ESI]
006a7113 : MOV EDX,dword ptr [EDI]
006a7115 : PUSH ECX
006a7116 : PUSH EDX
006a7117 : CALL 0x00685ea0
006a711c : ADD EAX,dword ptr [ESI + 0x8]
006a711f : MOV ECX,dword ptr [EDI + 0x4]
006a7122 : MOV dword ptr [EDI],EAX
006a7124 : MOV EAX,dword ptr [ESI + 0x4]
006a7127 : PUSH EAX
006a7128 : PUSH ECX
006a7129 : CALL 0x00685ea0
006a712e : ADD EAX,dword ptr [ESI + 0xc]
006a7131 : ADD ESP,0x10
006a7134 : MOV dword ptr [EDI + 0x4],EAX
006a7137 : ADD EDI,0x8
006a713a : SUB EBP,0x1
006a713d : JNZ 0x006a7111
006a713f : MOV EBP,dword ptr [ESP + 0x18]
006a7143 : MOV EDX,dword ptr [ESP + 0x10]
006a7147 : MOV EAX,dword ptr [ESP + 0x14]
006a714b : ADD dword ptr [ESP + 0x30],0x18
006a7150 : INC EAX
006a7151 : CMP EAX,dword ptr [ESP + 0x1c]
006a7155 : MOV dword ptr [ESP + 0x14],EAX
006a7159 : JL 0x006a7090
006a715f : POP EBP
006a7160 : POP EBX
006a7161 : POP EDI
006a7162 : MOV EAX,EDX
006a7164 : POP ESI
006a7165 : ADD ESP,0x10
006a7168 : RET
006a7169 : MOV EDX,dword ptr [ESP + 0x1c]
006a716d : PUSH ECX
006a716e : PUSH EAX
006a716f : PUSH EDX
006a7170 : CALL 0x006a6850
006a7175 : PUSH ESI
006a7176 : MOV EDI,EAX
006a7178 : CALL 0x006889b0
006a717d : ADD ESP,0x10
006a7180 : MOV EAX,EDI
006a7182 : POP EDI
006a7183 : POP ESI
006a7184 : ADD ESP,0x10
006a7187 : RET
006a7188 : POP EBP
006a7189 : MOV EAX,ECX
006a718b : POP EBX
006a718c : POP EDI
006a718d : POP ESI
006a718e : ADD ESP,0x10
006a7191 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_009966b0
ENTRY    : 009966b0
BODY     : [[009966b0, 00996901]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009966b0(void)

{
  int iVar1;
  undefined4 *puVar2;
  int in_ECX;
  undefined4 uVar3;
  uint local_6c;
  uint local_50;
  undefined1 local_4c [4];
  undefined4 local_48;
  undefined4 local_38;
  uint local_34;
  undefined1 local_30 [4];
  undefined4 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b5b48d;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar1 = FUN_00703c00(0x600,local_14);
  if (iVar1 == 0) {
    FUN_00404750(L"[%s] Failed : Can\'t Find item... index : %u",L"AvaGuiGachaBox::ShowRecvItemMsg",
                 *(undefined2 *)(in_ECX + 0x44));
    local_8 = 5;
    if ((int *)*DAT_00da98e8 != (int *)0x0) {
      (**(code **)(*(int *)*DAT_00da98e8 + 0x14))(L"AvaGuiGachaBox::ShowRecvItemMsg",0x440,local_30)
      ;
    }
    local_8 = 0xffffffff;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c = (undefined4 *)((uint)local_2c._2_2_ << 0x10);
  }
  else {
    FUN_00824a20(DAT_0172491c,0);
    local_8 = 0;
    FUN_00406460(&DAT_00c86e84);
    local_8._0_1_ = 1;
    puVar2 = local_2c;
    if (local_18 < 8) {
      puVar2 = &local_2c;
    }
    uVar3 = 0xffffffff;
    iVar1 = FUN_00412be0(puVar2,local_1c);
    FUN_00405e10(iVar1 + 1,uVar3);
    local_8._0_1_ = 0;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c._0_2_ = 0;
    FUN_008ece00(0);
    FUN_00406460(L"IDS_GET_ITEM_FROM_RANDOMBOX");
    local_8._0_1_ = 2;
    iVar1 = FUN_0081d120(local_30);
    local_8._0_1_ = 3;
    puVar2 = local_48;
    if (local_34 < 8) {
      puVar2 = &local_48;
    }
    if (*(uint *)(iVar1 + 0x18) < 8) {
      iVar1 = iVar1 + 4;
    }
    else {
      iVar1 = *(int *)(iVar1 + 4);
    }
    uVar3 = FUN_00404750(iVar1,puVar2);
    local_8._0_1_ = 4;
    FUN_00405eb0(uVar3,0,0xffffffff);
    local_8 = CONCAT31(local_8._1_3_,3);
    if (7 < local_50) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_8 = CONCAT31(local_8._1_3_,2);
    if (7 < local_6c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c = (undefined4 *)((uint)local_2c._2_2_ << 0x10);
    if (((DAT_0172491c != 0) && (iVar1 = *DAT_00da9894, iVar1 != 0)) &&
       (*(int *)(iVar1 + 0x1a8) != 0)) {
      (**(code **)(**(int **)(iVar1 + 0x1a8) + 0x44))(local_4c,0x13);
    }
    local_8 = 0xffffffff;
    if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_34 = 7;
    local_38 = 0;
    local_48 = (undefined4 *)((uint)local_48._2_2_ << 0x10);
  }
  local_8 = 0xffffffff;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
009966b0 : PUSH EBP
009966b1 : MOV EBP,ESP
009966b3 : PUSH -0x1
009966b5 : PUSH 0xb5b48d
009966ba : MOV EAX,FS:[0x0]
009966c0 : PUSH EAX
009966c1 : SUB ESP,0x74
009966c4 : MOV EAX,[0x00d66fa0]
009966c9 : XOR EAX,EBP
009966cb : MOV dword ptr [EBP + -0x10],EAX
009966ce : PUSH EBX
009966cf : PUSH ESI
009966d0 : PUSH EDI
009966d1 : PUSH EAX
009966d2 : LEA EAX,[EBP + -0xc]
009966d5 : MOV FS:[0x0],EAX
009966db : MOV ESI,ECX
009966dd : MOV DI,word ptr [ESI + 0x44]
009966e1 : PUSH 0x600
009966e6 : CALL 0x00703c00
009966eb : XOR EDI,EDI
009966ed : ADD ESP,0x4
009966f0 : CMP EAX,EDI
009966f2 : JZ 0x00996880
009966f8 : LEA EDX,[EAX + 0x18]
009966fb : MOV EAX,[0x0172491c]
00996700 : PUSH EDI
00996701 : PUSH EAX
00996702 : LEA ESI,[EBP + -0x48]
00996705 : CALL 0x00824a20
0099670a : MOV dword ptr [EBP + -0x4],EDI
0099670d : PUSH 0xc86e84
00996712 : LEA ECX,[EBP + -0x2c]
00996715 : CALL 0x00406460
0099671a : MOV byte ptr [EBP + -0x4],0x1
0099671e : MOV EAX,dword ptr [EBP + -0x28]
00996721 : MOV EBX,0x8
00996726 : CMP dword ptr [EBP + -0x14],EBX
00996729 : JNC 0x0099672e
0099672b : LEA EAX,[EBP + -0x28]
0099672e : MOV ECX,dword ptr [EBP + -0x18]
00996731 : PUSH -0x1
00996733 : PUSH ECX
00996734 : PUSH EAX
00996735 : LEA EDI,[EBP + -0x48]
00996738 : CALL 0x00412be0
0099673d : INC EAX
0099673e : PUSH EAX
0099673f : MOV ECX,EDI
00996741 : CALL 0x00405e10
00996746 : MOV byte ptr [EBP + -0x4],0x0
0099674a : CMP dword ptr [EBP + -0x14],EBX
0099674d : JC 0x00996757
0099674f : MOV ECX,dword ptr [EBP + -0x28]
00996752 : CALL 0x006f04e0
00996757 : XOR EDX,EDX
00996759 : PUSH EDX
0099675a : LEA EDI,[EBP + -0x48]
0099675d : MOV dword ptr [EBP + -0x14],0x7
00996764 : MOV dword ptr [EBP + -0x18],0x0
0099676b : MOV word ptr [EBP + -0x28],DX
0099676f : CALL 0x008ece00
00996774 : PUSH 0xc86ecc
00996779 : LEA ECX,[EBP + -0x2c]
0099677c : CALL 0x00406460
00996781 : MOV byte ptr [EBP + -0x4],0x2
00996785 : MOV ECX,dword ptr [0x0172491c]
0099678b : LEA EAX,[EBP + -0x2c]
0099678e : PUSH EAX
0099678f : LEA EDI,[EBP + -0x80]
00996792 : CALL 0x0081d120
00996797 : MOV byte ptr [EBP + -0x4],0x3
0099679b : MOV ECX,dword ptr [EBP + -0x44]
0099679e : CMP dword ptr [EBP + -0x30],EBX
009967a1 : JNC 0x009967a6
009967a3 : LEA ECX,[EBP + -0x44]
009967a6 : CMP dword ptr [EAX + 0x18],EBX
009967a9 : JC 0x009967b0
009967ab : MOV EAX,dword ptr [EAX + 0x4]
009967ae : JMP 0x009967b3
009967b0 : ADD EAX,0x4
009967b3 : PUSH ECX
009967b4 : PUSH EAX
009967b5 : LEA ESI,[EBP + -0x64]
009967b8 : CALL 0x00404750
009967bd : ADD ESP,0x8
009967c0 : MOV byte ptr [EBP + -0x4],0x4
009967c4 : PUSH -0x1
009967c6 : XOR ESI,ESI
009967c8 : PUSH ESI
009967c9 : PUSH EAX
009967ca : LEA ECX,[EBP + -0x48]
009967cd : CALL 0x00405eb0
009967d2 : MOV byte ptr [EBP + -0x4],0x3
009967d6 : CMP dword ptr [EBP + -0x4c],EBX
009967d9 : JC 0x009967e3
009967db : MOV ECX,dword ptr [EBP + -0x60]
009967de : CALL 0x006f04e0
009967e3 : MOV EDI,0x7
009967e8 : XOR ECX,ECX
009967ea : MOV dword ptr [EBP + -0x4c],EDI
009967ed : MOV dword ptr [EBP + -0x50],ESI
009967f0 : MOV word ptr [EBP + -0x60],CX
009967f4 : MOV byte ptr [EBP + -0x4],0x2
009967f8 : CMP dword ptr [EBP + -0x68],EBX
009967fb : JC 0x00996805
009967fd : MOV ECX,dword ptr [EBP + -0x7c]
00996800 : CALL 0x006f04e0
00996805 : XOR EDX,EDX
00996807 : MOV dword ptr [EBP + -0x68],EDI
0099680a : MOV dword ptr [EBP + -0x6c],ESI
0099680d : MOV word ptr [EBP + -0x7c],DX
00996811 : MOV byte ptr [EBP + -0x4],DL
00996814 : CMP dword ptr [EBP + -0x14],EBX
00996817 : JC 0x00996821
00996819 : MOV ECX,dword ptr [EBP + -0x28]
0099681c : CALL 0x006f04e0
00996821 : XOR EAX,EAX
00996823 : MOV dword ptr [EBP + -0x14],EDI
00996826 : MOV dword ptr [EBP + -0x18],ESI
00996829 : MOV word ptr [EBP + -0x28],AX
0099682d : CMP dword ptr [0x0172491c],ESI
00996833 : JZ 0x0099685e
00996835 : MOV ECX,dword ptr [0x00da9894]
0099683b : MOV EAX,dword ptr [ECX]
0099683d : CMP EAX,ESI
0099683f : JZ 0x0099685e
00996841 : CMP dword ptr [EAX + 0x1a8],ESI
00996847 : JZ 0x0099685e
00996849 : MOV EAX,dword ptr [EAX + 0x1a8]
0099684f : MOV EDX,dword ptr [EAX]
00996851 : MOV EDX,dword ptr [EDX + 0x44]
00996854 : PUSH 0x13
00996856 : LEA ECX,[EBP + -0x48]
00996859 : PUSH ECX
0099685a : MOV ECX,EAX
0099685c : CALL EDX
0099685e : MOV dword ptr [EBP + -0x4],0xffffffff
00996865 : CMP dword ptr [EBP + -0x30],EBX
00996868 : JC 0x00996872
0099686a : MOV ECX,dword ptr [EBP + -0x44]
0099686d : CALL 0x006f04e0
00996872 : XOR EAX,EAX
00996874 : MOV dword ptr [EBP + -0x30],EDI
00996877 : MOV dword ptr [EBP + -0x34],ESI
0099687a : MOV word ptr [EBP + -0x44],AX
0099687e : JMP 0x009968e6
00996880 : MOVZX ECX,word ptr [ESI + 0x44]
00996884 : PUSH ECX
00996885 : PUSH 0xc86f08
0099688a : PUSH 0xc86f48
0099688f : LEA ESI,[EBP + -0x2c]
00996892 : CALL 0x00404750
00996897 : ADD ESP,0xc
0099689a : MOV dword ptr [EBP + -0x4],0x5
009968a1 : MOV EDX,dword ptr [0x00da98e8]
009968a7 : MOV ECX,dword ptr [EDX]
009968a9 : CMP ECX,EDI
009968ab : JZ 0x009968c1
009968ad : MOV EAX,dword ptr [ECX]
009968af : MOV EAX,dword ptr [EAX + 0x14]
009968b2 : MOV EDX,ESI
009968b4 : PUSH EDX
009968b5 : PUSH 0x440
009968ba : PUSH 0xc86fa0
009968bf : CALL EAX
009968c1 : MOV dword ptr [EBP + -0x4],0xffffffff
009968c8 : CMP dword ptr [EBP + -0x14],0x8
009968cc : JC 0x009968d6
009968ce : MOV ECX,dword ptr [EBP + -0x28]
009968d1 : CALL 0x006f04e0
009968d6 : XOR ECX,ECX
009968d8 : MOV dword ptr [EBP + -0x14],0x7
009968df : MOV dword ptr [EBP + -0x18],EDI
009968e2 : MOV word ptr [EBP + -0x28],CX
009968e6 : MOV ECX,dword ptr [EBP + -0xc]
009968e9 : MOV dword ptr FS:[0x0],ECX
009968f0 : POP ECX
009968f1 : POP EDI
009968f2 : POP ESI
009968f3 : POP EBX
009968f4 : MOV ECX,dword ptr [EBP + -0x10]
009968f7 : XOR ECX,EBP
009968f9 : CALL 0x00633e6b
009968fe : MOV ESP,EBP
00996900 : POP EBP
00996901 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_006ef3a0
ENTRY    : 006ef3a0
BODY     : [[006ef3a0, 006ef4c6]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006ef3a0(uint param_1,int param_2)

{
  wint_t wVar1;
  int iVar2;
  int iVar3;
  wint_t *local_14;
  int local_10;
  uint local_c;
  uint local_8;
  
  if (*(int *)(param_2 + 0x14) != 0) {
    if (*(uint *)(param_2 + 0x18) < 8) {
      local_14 = (wint_t *)(param_2 + 4);
    }
    else {
      local_14 = *(wint_t **)(param_2 + 4);
    }
    wVar1 = *local_14;
    if ((ushort)(wVar1 + 0xff) < 0x5e) {
      wVar1 = wVar1 + 0x120;
    }
    wVar1 = __towupper_l(wVar1,(_locale_t)0x0);
    local_8 = (uint)wVar1;
    iVar2 = FUN_00407c10(&local_8,1);
    if (iVar2 == -1) {
      iVar2 = **(int **)(param_1 + 4);
      param_1 = 0;
      local_8 = 0;
      while( true ) {
        while( true ) {
          if (*(uint *)(param_2 + 0x18) < 8) {
            iVar3 = param_2 + 4;
          }
          else {
            iVar3 = *(int *)(param_2 + 4);
          }
          if (local_14 == (wint_t *)(iVar3 + *(int *)(param_2 + 0x14) * 2)) {
            return local_8;
          }
          wVar1 = *local_14;
          param_1 = param_1 + 1;
          if ((ushort)(wVar1 + 0xff) < 0x5e) {
            wVar1 = wVar1 + 0x120;
          }
          wVar1 = __towupper_l(wVar1,(_locale_t)0x0);
          local_c = (uint)wVar1;
          iVar3 = FUN_00407c10(&local_c,1);
          if (iVar3 == -1) break;
          local_14 = local_14 + 1;
        }
        local_c = (uint)wVar1;
        FUN_004f7f30(&local_10);
        if (local_10 == *(int *)(iVar2 + 0xc)) {
          return local_8;
        }
        iVar2 = *(int *)(local_10 + 0xc);
        if (iVar2 == 0) break;
        if (*(char *)(iVar2 + 0x30) != '\0') {
          local_8 = param_1;
        }
        local_14 = local_14 + 1;
      }
      return local_8;
    }
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
006ef3a0 : PUSH EBP
006ef3a1 : MOV EBP,ESP
006ef3a3 : SUB ESP,0x14
006ef3a6 : PUSH EBX
006ef3a7 : PUSH ESI
006ef3a8 : PUSH EDI
006ef3a9 : MOV EDI,dword ptr [EBP + 0xc]
006ef3ac : XOR ESI,ESI
006ef3ae : CMP dword ptr [EDI + 0x14],ESI
006ef3b1 : JNZ 0x006ef3be
006ef3b3 : XOR EAX,EAX
006ef3b5 : POP EDI
006ef3b6 : POP ESI
006ef3b7 : POP EBX
006ef3b8 : MOV ESP,EBP
006ef3ba : POP EBP
006ef3bb : RET 0x8
006ef3be : CMP dword ptr [EDI + 0x18],0x8
006ef3c2 : JC 0x006ef3c9
006ef3c4 : MOV EAX,dword ptr [EDI + 0x4]
006ef3c7 : JMP 0x006ef3cc
006ef3c9 : LEA EAX,[EDI + 0x4]
006ef3cc : MOV dword ptr [EBP + -0x10],EAX
006ef3cf : MOVZX EAX,word ptr [EAX]
006ef3d2 : LEA ECX,[EAX + 0xff]
006ef3d8 : CMP CX,0x5d
006ef3dc : JA 0x006ef3e3
006ef3de : ADD EAX,0x120
006ef3e3 : PUSH ESI
006ef3e4 : PUSH EAX
006ef3e5 : CALL 0x006380e3
006ef3ea : MOVZX EDX,AX
006ef3ed : ADD ESP,0x8
006ef3f0 : PUSH 0x1
006ef3f2 : LEA EAX,[EBP + -0x4]
006ef3f5 : MOV dword ptr [EBP + -0x4],EDX
006ef3f8 : PUSH EAX
006ef3f9 : XOR EAX,EAX
006ef3fb : MOV EDX,0xd723dc
006ef400 : CALL 0x00407c10
006ef405 : CMP EAX,-0x1
006ef408 : JNZ 0x006ef3b3
006ef40a : MOV ECX,dword ptr [EBP + 0x8]
006ef40d : MOV EDX,dword ptr [ECX + 0x4]
006ef410 : MOV EBX,dword ptr [EDX]
006ef412 : MOV dword ptr [EBP + 0x8],ESI
006ef415 : MOV dword ptr [EBP + -0x4],ESI
006ef418 : CMP dword ptr [EDI + 0x18],0x8
006ef41c : JC 0x006ef423
006ef41e : MOV EAX,dword ptr [EDI + 0x4]
006ef421 : JMP 0x006ef426
006ef423 : LEA EAX,[EDI + 0x4]
006ef426 : MOV ECX,dword ptr [EDI + 0x14]
006ef429 : LEA EDX,[EAX + ECX*0x2]
006ef42c : MOV EAX,dword ptr [EBP + -0x10]
006ef42f : CMP EAX,EDX
006ef431 : JZ 0x006ef4bb
006ef437 : MOVZX EAX,word ptr [EAX]
006ef43a : INC dword ptr [EBP + 0x8]
006ef43d : LEA ECX,[EAX + 0xff]
006ef443 : CMP CX,0x5d
006ef447 : JA 0x006ef44e
006ef449 : ADD EAX,0x120
006ef44e : PUSH 0x0
006ef450 : PUSH EAX
006ef451 : CALL 0x006380e3
006ef456 : MOVZX ESI,AX
006ef459 : ADD ESP,0x8
006ef45c : MOVZX EDX,SI
006ef45f : PUSH 0x1
006ef461 : LEA EAX,[EBP + -0x8]
006ef464 : MOV dword ptr [EBP + -0x8],EDX
006ef467 : PUSH EAX
006ef468 : XOR EAX,EAX
006ef46a : MOV EDX,0xd723dc
006ef46f : CALL 0x00407c10
006ef474 : CMP EAX,-0x1
006ef477 : JZ 0x006ef47f
006ef479 : ADD dword ptr [EBP + -0x10],0x2
006ef47d : JMP 0x006ef418
006ef47f : MOVZX ECX,SI
006ef482 : LEA EDX,[EBP + -0xc]
006ef485 : PUSH EDX
006ef486 : LEA EAX,[EBX + 0x4]
006ef489 : LEA EDI,[EBP + -0x8]
006ef48c : MOV dword ptr [EBP + -0x8],ECX
006ef48f : CALL 0x004f7f30
006ef494 : MOV EAX,dword ptr [EBP + -0xc]
006ef497 : CMP EAX,dword ptr [EBX + 0xc]
006ef49a : JZ 0x006ef4bb
006ef49c : MOV EBX,dword ptr [EAX + 0xc]
006ef49f : TEST EBX,EBX
006ef4a1 : JZ 0x006ef4bb
006ef4a3 : CMP byte ptr [EBX + 0x30],0x0
006ef4a7 : JZ 0x006ef4af
006ef4a9 : MOV EAX,dword ptr [EBP + 0x8]
006ef4ac : MOV dword ptr [EBP + -0x4],EAX
006ef4af : ADD dword ptr [EBP + -0x10],0x2
006ef4b3 : MOV EDI,dword ptr [EBP + 0xc]
006ef4b6 : JMP 0x006ef418
006ef4bb : MOV EAX,dword ptr [EBP + -0x4]
006ef4be : POP EDI
006ef4bf : POP ESI
006ef4c0 : POP EBX
006ef4c1 : MOV ESP,EBP
006ef4c3 : POP EBP
006ef4c4 : RET 0x8

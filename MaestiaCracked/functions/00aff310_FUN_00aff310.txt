PROGRAM  : Maestia.exe
FUNCTION : FUN_00aff310
ENTRY    : 00aff310
BODY     : [[00aff310, 00aff46c]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00aff310(int param_1)

{
  uint uVar1;
  int iVar2;
  uint local_50;
  undefined1 local_4c [4];
  undefined2 local_48;
  undefined4 local_38;
  uint local_34;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b6fabd;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_14 = uVar1;
  if (param_1 != 0x3040207) {
    FUN_00406460(L"IDS_CLTNET_ERR_DIFVERSION");
    local_8 = 0;
    iVar2 = FUN_0081d120(local_4c);
    local_8._0_1_ = 1;
    if (*(uint *)(iVar2 + 0x18) < 8) {
      iVar2 = iVar2 + 4;
    }
    else {
      iVar2 = *(int *)(iVar2 + 4);
    }
    FUN_00404750(L"Server GBD V.0x%x, Client GBD V.0x%x %s ExitCode %d",param_1,0x3040207,iVar2,
                 *(undefined4 *)(DAT_0172491c + 0x364),uVar1);
    local_8 = CONCAT31(local_8._1_3_,3);
    if (7 < local_50) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_8 = CONCAT31(local_8._1_3_,4);
    if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_38 = 0;
    local_34 = 7;
    local_48 = 0;
    FUN_00829d90(local_30,1);
    if ((DAT_00da9877 != '\0') || (DAT_00da98b8 != '\0')) {
      FUN_00808780(L"[Invalid GBD: Server: %d, Client: %d",param_1,0x3040207);
    }
    local_8 = 0xffffffff;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c = 0;
  }
  local_8 = 0xffffffff;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00aff310 : PUSH EBP
00aff311 : MOV EBP,ESP
00aff313 : PUSH -0x1
00aff315 : PUSH 0xb6fabd
00aff31a : MOV EAX,FS:[0x0]
00aff320 : PUSH EAX
00aff321 : SUB ESP,0x58
00aff324 : MOV EAX,[0x00d66fa0]
00aff329 : XOR EAX,EBP
00aff32b : MOV dword ptr [EBP + -0x10],EAX
00aff32e : PUSH EBX
00aff32f : PUSH ESI
00aff330 : PUSH EDI
00aff331 : PUSH EAX
00aff332 : LEA EAX,[EBP + -0xc]
00aff335 : MOV FS:[0x0],EAX
00aff33b : MOV ESI,dword ptr [EBP + 0x8]
00aff33e : CMP ESI,0x3040207
00aff344 : JZ 0x00aff44a
00aff34a : PUSH 0xcad0b8
00aff34f : LEA ECX,[EBP + -0x48]
00aff352 : CALL 0x00406460
00aff357 : MOV dword ptr [EBP + -0x4],0x0
00aff35e : MOV ECX,dword ptr [0x0172491c]
00aff364 : LEA EAX,[EBP + -0x48]
00aff367 : PUSH EAX
00aff368 : LEA EDI,[EBP + -0x64]
00aff36b : CALL 0x0081d120
00aff370 : MOV byte ptr [EBP + -0x4],0x1
00aff374 : MOV ECX,dword ptr [0x0172491c]
00aff37a : MOV ECX,dword ptr [ECX + 0x364]
00aff380 : MOV EBX,0x8
00aff385 : CMP dword ptr [EAX + 0x18],EBX
00aff388 : JC 0x00aff38f
00aff38a : MOV EAX,dword ptr [EAX + 0x4]
00aff38d : JMP 0x00aff392
00aff38f : ADD EAX,0x4
00aff392 : PUSH ECX
00aff393 : PUSH EAX
00aff394 : PUSH 0x3040207
00aff399 : PUSH ESI
00aff39a : PUSH 0xcad0f0
00aff39f : LEA ESI,[EBP + -0x2c]
00aff3a2 : CALL 0x00404750
00aff3a7 : ADD ESP,0x14
00aff3aa : MOV byte ptr [EBP + -0x4],0x3
00aff3ae : CMP dword ptr [EBP + -0x4c],EBX
00aff3b1 : JC 0x00aff3bb
00aff3b3 : MOV ECX,dword ptr [EBP + -0x60]
00aff3b6 : CALL 0x006f04e0
00aff3bb : MOV ESI,0x7
00aff3c0 : XOR EDI,EDI
00aff3c2 : XOR EDX,EDX
00aff3c4 : MOV dword ptr [EBP + -0x4c],ESI
00aff3c7 : MOV dword ptr [EBP + -0x50],EDI
00aff3ca : MOV word ptr [EBP + -0x60],DX
00aff3ce : MOV byte ptr [EBP + -0x4],0x4
00aff3d2 : CMP dword ptr [EBP + -0x30],EBX
00aff3d5 : JC 0x00aff3df
00aff3d7 : MOV ECX,dword ptr [EBP + -0x44]
00aff3da : CALL 0x006f04e0
00aff3df : PUSH 0x1
00aff3e1 : LEA ECX,[EBP + -0x2c]
00aff3e4 : MOV dword ptr [EBP + -0x34],EDI
00aff3e7 : MOV EDI,dword ptr [0x0172491c]
00aff3ed : XOR EAX,EAX
00aff3ef : PUSH ECX
00aff3f0 : MOV dword ptr [EBP + -0x30],ESI
00aff3f3 : MOV word ptr [EBP + -0x44],AX
00aff3f7 : CALL 0x00829d90
00aff3fc : CMP byte ptr [0x00da9877],0x0
00aff403 : JNZ 0x00aff40e
00aff405 : CMP byte ptr [0x00da98b8],0x0
00aff40c : JZ 0x00aff424
00aff40e : MOV EDX,dword ptr [EBP + 0x8]
00aff411 : PUSH 0x3040207
00aff416 : PUSH EDX
00aff417 : PUSH 0xcad158
00aff41c : CALL 0x00808780
00aff421 : ADD ESP,0xc
00aff424 : MOV dword ptr [EBP + -0x4],0xffffffff
00aff42b : CMP dword ptr [EBP + -0x14],EBX
00aff42e : JC 0x00aff438
00aff430 : MOV ECX,dword ptr [EBP + -0x28]
00aff433 : CALL 0x006f04e0
00aff438 : XOR EAX,EAX
00aff43a : MOV dword ptr [EBP + -0x14],ESI
00aff43d : MOV dword ptr [EBP + -0x18],0x0
00aff444 : MOV word ptr [EBP + -0x28],AX
00aff448 : JMP 0x00aff44f
00aff44a : MOV EAX,0x1
00aff44f : MOV ECX,dword ptr [EBP + -0xc]
00aff452 : MOV dword ptr FS:[0x0],ECX
00aff459 : POP ECX
00aff45a : POP EDI
00aff45b : POP ESI
00aff45c : POP EBX
00aff45d : MOV ECX,dword ptr [EBP + -0x10]
00aff460 : XOR ECX,EBP
00aff462 : CALL 0x00633e6b
00aff467 : MOV ESP,EBP
00aff469 : POP EBP
00aff46a : RET 0x4

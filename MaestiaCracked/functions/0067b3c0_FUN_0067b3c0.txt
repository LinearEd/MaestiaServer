PROGRAM  : Maestia.exe
FUNCTION : FUN_0067b3c0
ENTRY    : 0067b3c0
BODY     : [[0067b3c0, 0067b47c] [0067b480, 0067b6d7] [0067b6e0, 0067b74c] [0067b750, 0067b877]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0067b3c0(byte *param_1,uint param_2)

{
  byte bVar1;
  byte *pbVar2;
  char cVar3;
  GRefCountImpl *this;
  byte *pbVar4;
  int iVar5;
  undefined4 uVar6;
  byte *pbVar7;
  int *in_ECX;
  char *pcVar8;
  GRefCountImpl *pGVar9;
  int iVar10;
  bool bVar11;
  undefined1 auStack_c [4];
  undefined1 auStack_8 [8];
  
  pbVar7 = param_1;
  this = (GRefCountImpl *)(**(code **)(*(int *)(param_1 + 8) + 0xc))(4);
  pbVar2 = param_1;
  if (this != (GRefCountImpl *)0x0) {
    pGVar9 = this + 0xc;
    FUN_005a2260(pGVar9,"imecommand: \'");
    FUN_005a2260(pGVar9,pbVar2);
    FUN_005a2260(pGVar9,&DAT_00bd6728);
    FUN_005a2260(pGVar9,&DAT_00cd4480,param_2);
    FUN_005a2260(pGVar9,&DAT_00bd6724);
  }
  pcVar8 = "CandidateList_OnItemSelect";
  pbVar4 = pbVar2;
  do {
    bVar1 = *pbVar4;
    bVar11 = bVar1 < (byte)*pcVar8;
    if (bVar1 != *pcVar8) {
LAB_0067b451:
      iVar5 = (1 - (uint)bVar11) - (uint)(bVar11 != 0);
      goto LAB_0067b456;
    }
    if (bVar1 == 0) break;
    bVar1 = pbVar4[1];
    bVar11 = bVar1 < ((byte *)pcVar8)[1];
    if (bVar1 != ((byte *)pcVar8)[1]) goto LAB_0067b451;
    pbVar4 = pbVar4 + 2;
    pcVar8 = (char *)((byte *)pcVar8 + 2);
  } while (bVar1 != 0);
  iVar5 = 0;
LAB_0067b456:
  if (iVar5 == 0) {
    uVar6 = FUN_00634f2c(param_2);
    FUN_0067a940(uVar6);
    goto LAB_0067b643;
  }
  pcVar8 = "CandidateList_OnSetItemDataMap";
  pbVar4 = pbVar2;
  do {
    bVar1 = *pbVar4;
    bVar11 = bVar1 < (byte)*pcVar8;
    if (bVar1 != *pcVar8) {
LAB_0067b4a0:
      iVar5 = (1 - (uint)bVar11) - (uint)(bVar11 != 0);
      goto LAB_0067b4a5;
    }
    if (bVar1 == 0) break;
    bVar1 = pbVar4[1];
    bVar11 = bVar1 < ((byte *)pcVar8)[1];
    if (bVar1 != ((byte *)pcVar8)[1]) goto LAB_0067b4a0;
    pbVar4 = pbVar4 + 2;
    pcVar8 = (char *)((byte *)pcVar8 + 2);
  } while (bVar1 != 0);
  iVar5 = 0;
LAB_0067b4a5:
  if (iVar5 == 0) {
    FUN_0067a960(pbVar7,pbVar2,param_2);
    goto LAB_0067b643;
  }
  pcVar8 = "LangBar_OnInit";
  pbVar7 = pbVar2;
  do {
    bVar1 = *pbVar7;
    bVar11 = bVar1 < (byte)*pcVar8;
    if (bVar1 != *pcVar8) {
LAB_0067b4e3:
      iVar5 = (1 - (uint)bVar11) - (uint)(bVar11 != 0);
      goto LAB_0067b4e8;
    }
    if (bVar1 == 0) break;
    bVar1 = pbVar7[1];
    bVar11 = bVar1 < ((byte *)pcVar8)[1];
    if (bVar1 != ((byte *)pcVar8)[1]) goto LAB_0067b4e3;
    pbVar7 = pbVar7 + 2;
    pcVar8 = (char *)((byte *)pcVar8 + 2);
  } while (bVar1 != 0);
  iVar5 = 0;
LAB_0067b4e8:
  if (iVar5 == 0) {
    if (in_ECX[8] != 0) {
      (**(code **)(*(int *)in_ECX[8] + 0x30))();
    }
    goto LAB_0067b643;
  }
  pcVar8 = "StatusWindow_OnInit";
  pbVar7 = pbVar2;
  do {
    bVar1 = *pbVar7;
    bVar11 = bVar1 < (byte)*pcVar8;
    if (bVar1 != *pcVar8) {
LAB_0067b530:
      iVar5 = (1 - (uint)bVar11) - (uint)(bVar11 != 0);
      goto LAB_0067b535;
    }
    if (bVar1 == 0) break;
    bVar1 = pbVar7[1];
    bVar11 = bVar1 < ((byte *)pcVar8)[1];
    if (bVar1 != ((byte *)pcVar8)[1]) goto LAB_0067b530;
    pbVar7 = pbVar7 + 2;
    pcVar8 = (char *)((byte *)pcVar8 + 2);
  } while (bVar1 != 0);
  iVar5 = 0;
LAB_0067b535:
  if (iVar5 == 0) {
    (**(code **)(*in_ECX + 0x1c))((in_ECX[0x11] & 0xfffffffcU) + 8);
    (**(code **)(*in_ECX + 0x38))();
    (**(code **)(*in_ECX + 4))(0xffffffff);
    goto LAB_0067b643;
  }
  iVar5 = FUN_004ffb40(pbVar2,"LangBar_OnSelectInputLang");
  if (iVar5 == 0) {
    (**(code **)(*in_ECX + 0x34))();
    if (in_ECX[8] != 0) {
      (**(code **)(*(int *)in_ECX[8] + 0x24))(param_2);
    }
    goto LAB_0067b643;
  }
  iVar5 = FUN_004ffb40(pbVar2,"LangBar_GetIMENames");
  if (iVar5 != 0) {
    iVar5 = FUN_004ffb40(pbVar2,"LangBar_OnSelectIME");
    if (iVar5 == 0) {
      if (in_ECX[8] != 0) {
        (**(code **)(*(int *)in_ECX[8] + 0x20))(param_2);
      }
      if (*(int *)(in_ECX[8] + 0x44) == 9) {
        (**(code **)(*in_ECX + 0x38))();
      }
      cVar3 = FUN_004ffbc0("Japanese");
      if ((cVar3 != '\0') || (cVar3 = FUN_004ffbc0("Korean"), cVar3 != '\0')) {
        (**(code **)(*in_ECX + 0x38))();
        (**(code **)(*(int *)in_ECX[8] + 0x28))(0xffffffff);
      }
    }
    else {
      iVar5 = FUN_004ffb40(pbVar2,"LangBar_GetInstalledLanguages");
      if (iVar5 == 0) {
        (**(code **)(*in_ECX + 0x20))((*(uint *)(in_ECX[8] + 0x38) & 0xfffffffc) + 8);
      }
      else {
        (**(code **)(*in_ECX + 0x68))();
        if (in_ECX[8] != 0) {
          (**(code **)(*(int *)in_ECX[8] + 0x2c))(pbVar2,param_2);
        }
      }
    }
    goto LAB_0067b643;
  }
  iVar5 = *(int *)(in_ECX[8] + 0x44);
  if (iVar5 < 0x2001) {
    if (iVar5 == 0x2000) {
      FUN_0051b6e0();
      iVar5 = *(int *)(in_ECX[8] + 0x18);
      if (iVar5 != 0) {
        iVar10 = 0;
        if (0 < iVar5) {
          do {
            uVar6 = FUN_0051c6e0(auStack_c,&DAT_00bd6690);
            FUN_0051bd70(uVar6);
            FUN_0045b730();
            iVar10 = iVar10 + 1;
          } while (iVar10 < iVar5);
        }
LAB_0067b780:
        (**(code **)(*in_ECX + 0x24))((param_2 & 0xfffffffc) + 8);
      }
    }
    else {
      if (iVar5 != 9) {
        if (iVar5 == 0x400) {
          FUN_0051b6e0();
          iVar5 = *(int *)(in_ECX[8] + 0xc);
          iVar10 = 0;
          if (0 < iVar5) {
            do {
              uVar6 = FUN_0051c6e0(&param_1,&DAT_00bd6690);
              FUN_0051bd70(uVar6);
              FUN_0045b730();
              iVar10 = iVar10 + 1;
            } while (iVar10 < iVar5);
          }
          (**(code **)(*in_ECX + 0x24))((param_2 & 0xfffffffc) + 8);
          FUN_0045b730();
        }
        goto LAB_0067b643;
      }
      FUN_0051b6e0();
      iVar5 = *(int *)(in_ECX[8] + 0x30);
      if (iVar5 != 0) {
        iVar10 = 0;
        if (0 < iVar5) {
          do {
            uVar6 = FUN_0051c6e0(&stack0xfffffff0,&DAT_00bd6690);
            FUN_0051bd70(uVar6);
            FUN_0045b730();
            iVar10 = iVar10 + 1;
          } while (iVar10 < iVar5);
        }
        goto LAB_0067b780;
      }
    }
  }
  else {
    if (iVar5 != 0x80000) {
      if (iVar5 == 0x10000000) {
        (**(code **)(*in_ECX + 0x34))();
      }
      goto LAB_0067b643;
    }
    FUN_0051b6e0();
    iVar5 = *(int *)(in_ECX[8] + 0x24);
    if (iVar5 != 0) {
      iVar10 = 0;
      if (0 < iVar5) {
        do {
          uVar6 = FUN_0051c6e0(auStack_8,&DAT_00bd6690);
          FUN_0051bd70(uVar6);
          FUN_0045b730();
          iVar10 = iVar10 + 1;
        } while (iVar10 < iVar5);
      }
      goto LAB_0067b780;
    }
  }
  FUN_0045b730();
LAB_0067b643:
  if (this != (GRefCountImpl *)0x0) {
    GRefCountImpl::Release(this);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
0067b3c0 : SUB ESP,0xc
0067b3c3 : PUSH EBX
0067b3c4 : MOV EBX,dword ptr [ESP + 0x14]
0067b3c8 : MOV EAX,dword ptr [EBX + 0x8]
0067b3cb : MOV EDX,dword ptr [EAX + 0xc]
0067b3ce : PUSH EBP
0067b3cf : PUSH ESI
0067b3d0 : MOV ESI,ECX
0067b3d2 : LEA ECX,[EBX + 0x8]
0067b3d5 : PUSH EDI
0067b3d6 : PUSH 0x4
0067b3d8 : CALL EDX
0067b3da : MOV EBP,dword ptr [ESP + 0x24]
0067b3de : MOV EDI,EAX
0067b3e0 : MOV dword ptr [ESP + 0x20],EDI
0067b3e4 : TEST EDI,EDI
0067b3e6 : JZ 0x0067b42a
0067b3e8 : ADD EDI,0xc
0067b3eb : PUSH 0xbd672c
0067b3f0 : PUSH EDI
0067b3f1 : CALL 0x005a2260
0067b3f6 : PUSH EBP
0067b3f7 : PUSH EDI
0067b3f8 : CALL 0x005a2260
0067b3fd : PUSH 0xbd6728
0067b402 : PUSH EDI
0067b403 : CALL 0x005a2260
0067b408 : MOV EAX,dword ptr [ESP + 0x40]
0067b40c : PUSH EAX
0067b40d : PUSH 0xcd4480
0067b412 : PUSH EDI
0067b413 : CALL 0x005a2260
0067b418 : PUSH 0xbd6724
0067b41d : PUSH EDI
0067b41e : CALL 0x005a2260
0067b423 : MOV EDI,dword ptr [ESP + 0x4c]
0067b427 : ADD ESP,0x2c
0067b42a : MOV ECX,0xbd6708
0067b42f : MOV EAX,EBP
0067b431 : MOV DL,byte ptr [EAX]
0067b433 : CMP DL,byte ptr [ECX]
0067b435 : JNZ 0x0067b451
0067b437 : TEST DL,DL
0067b439 : JZ 0x0067b44d
0067b43b : MOV DL,byte ptr [EAX + 0x1]
0067b43e : CMP DL,byte ptr [ECX + 0x1]
0067b441 : JNZ 0x0067b451
0067b443 : ADD EAX,0x2
0067b446 : ADD ECX,0x2
0067b449 : TEST DL,DL
0067b44b : JNZ 0x0067b431
0067b44d : XOR EAX,EAX
0067b44f : JMP 0x0067b456
0067b451 : SBB EAX,EAX
0067b453 : SBB EAX,-0x1
0067b456 : TEST EAX,EAX
0067b458 : JNZ 0x0067b474
0067b45a : MOV ECX,dword ptr [ESP + 0x28]
0067b45e : PUSH ECX
0067b45f : CALL 0x00634f2c
0067b464 : ADD ESP,0x4
0067b467 : PUSH EAX
0067b468 : MOV ECX,ESI
0067b46a : CALL 0x0067a940
0067b46f : JMP 0x0067b643
0067b474 : MOV ECX,0xbd66e8
0067b479 : MOV EAX,EBP
0067b47b : JMP 0x0067b480
0067b480 : MOV DL,byte ptr [EAX]
0067b482 : CMP DL,byte ptr [ECX]
0067b484 : JNZ 0x0067b4a0
0067b486 : TEST DL,DL
0067b488 : JZ 0x0067b49c
0067b48a : MOV DL,byte ptr [EAX + 0x1]
0067b48d : CMP DL,byte ptr [ECX + 0x1]
0067b490 : JNZ 0x0067b4a0
0067b492 : ADD EAX,0x2
0067b495 : ADD ECX,0x2
0067b498 : TEST DL,DL
0067b49a : JNZ 0x0067b480
0067b49c : XOR EAX,EAX
0067b49e : JMP 0x0067b4a5
0067b4a0 : SBB EAX,EAX
0067b4a2 : SBB EAX,-0x1
0067b4a5 : TEST EAX,EAX
0067b4a7 : JNZ 0x0067b4bc
0067b4a9 : MOV EDX,dword ptr [ESP + 0x28]
0067b4ad : PUSH EDX
0067b4ae : PUSH EBP
0067b4af : PUSH EBX
0067b4b0 : MOV ECX,ESI
0067b4b2 : CALL 0x0067a960
0067b4b7 : JMP 0x0067b643
0067b4bc : MOV ECX,0xbd66d8
0067b4c1 : MOV EAX,EBP
0067b4c3 : MOV DL,byte ptr [EAX]
0067b4c5 : CMP DL,byte ptr [ECX]
0067b4c7 : JNZ 0x0067b4e3
0067b4c9 : TEST DL,DL
0067b4cb : JZ 0x0067b4df
0067b4cd : MOV DL,byte ptr [EAX + 0x1]
0067b4d0 : CMP DL,byte ptr [ECX + 0x1]
0067b4d3 : JNZ 0x0067b4e3
0067b4d5 : ADD EAX,0x2
0067b4d8 : ADD ECX,0x2
0067b4db : TEST DL,DL
0067b4dd : JNZ 0x0067b4c3
0067b4df : XOR EAX,EAX
0067b4e1 : JMP 0x0067b4e8
0067b4e3 : SBB EAX,EAX
0067b4e5 : SBB EAX,-0x1
0067b4e8 : TEST EAX,EAX
0067b4ea : JNZ 0x0067b506
0067b4ec : CMP dword ptr [ESI + 0x20],EAX
0067b4ef : JZ 0x0067b643
0067b4f5 : MOV ESI,dword ptr [ESI + 0x20]
0067b4f8 : MOV EAX,dword ptr [ESI]
0067b4fa : MOV EDX,dword ptr [EAX + 0x30]
0067b4fd : MOV ECX,ESI
0067b4ff : CALL EDX
0067b501 : JMP 0x0067b643
0067b506 : MOV ECX,0xbd66c4
0067b50b : MOV EAX,EBP
0067b50d : LEA ECX,[ECX]
0067b510 : MOV DL,byte ptr [EAX]
0067b512 : CMP DL,byte ptr [ECX]
0067b514 : JNZ 0x0067b530
0067b516 : TEST DL,DL
0067b518 : JZ 0x0067b52c
0067b51a : MOV DL,byte ptr [EAX + 0x1]
0067b51d : CMP DL,byte ptr [ECX + 0x1]
0067b520 : JNZ 0x0067b530
0067b522 : ADD EAX,0x2
0067b525 : ADD ECX,0x2
0067b528 : TEST DL,DL
0067b52a : JNZ 0x0067b510
0067b52c : XOR EAX,EAX
0067b52e : JMP 0x0067b535
0067b530 : SBB EAX,EAX
0067b532 : SBB EAX,-0x1
0067b535 : TEST EAX,EAX
0067b537 : JNZ 0x0067b565
0067b539 : MOV ECX,dword ptr [ESI + 0x44]
0067b53c : MOV EAX,dword ptr [ESI]
0067b53e : MOV EDX,dword ptr [EAX + 0x1c]
0067b541 : AND ECX,0xfffffffc
0067b544 : ADD ECX,0x8
0067b547 : PUSH ECX
0067b548 : MOV ECX,ESI
0067b54a : CALL EDX
0067b54c : MOV EAX,dword ptr [ESI]
0067b54e : MOV EDX,dword ptr [EAX + 0x38]
0067b551 : MOV ECX,ESI
0067b553 : CALL EDX
0067b555 : MOV EAX,dword ptr [ESI]
0067b557 : MOV EDX,dword ptr [EAX + 0x4]
0067b55a : PUSH -0x1
0067b55c : MOV ECX,ESI
0067b55e : CALL EDX
0067b560 : JMP 0x0067b643
0067b565 : PUSH 0xbd66a8
0067b56a : PUSH EBP
0067b56b : CALL 0x004ffb40
0067b570 : ADD ESP,0x8
0067b573 : TEST EAX,EAX
0067b575 : JNZ 0x0067b5a0
0067b577 : MOV EAX,dword ptr [ESI]
0067b579 : MOV EDX,dword ptr [EAX + 0x34]
0067b57c : MOV ECX,ESI
0067b57e : CALL EDX
0067b580 : CMP dword ptr [ESI + 0x20],0x0
0067b584 : JZ 0x0067b643
0067b58a : MOV ESI,dword ptr [ESI + 0x20]
0067b58d : MOV ECX,dword ptr [ESP + 0x28]
0067b591 : MOV EAX,dword ptr [ESI]
0067b593 : MOV EDX,dword ptr [EAX + 0x24]
0067b596 : PUSH ECX
0067b597 : MOV ECX,ESI
0067b599 : CALL EDX
0067b59b : JMP 0x0067b643
0067b5a0 : PUSH 0xbd6694
0067b5a5 : PUSH EBP
0067b5a6 : CALL 0x004ffb40
0067b5ab : ADD ESP,0x8
0067b5ae : TEST EAX,EAX
0067b5b0 : JNZ 0x0067b7a6
0067b5b6 : MOV EAX,dword ptr [ESI + 0x20]
0067b5b9 : MOV EAX,dword ptr [EAX + 0x44]
0067b5bc : CMP EAX,0x2000
0067b5c1 : JG 0x0067b712
0067b5c7 : JZ 0x0067b6b5
0067b5cd : CMP EAX,0x9
0067b5d0 : JZ 0x0067b658
0067b5d6 : CMP EAX,0x400
0067b5db : JNZ 0x0067b643
0067b5dd : LEA ECX,[ESP + 0x28]
0067b5e1 : CALL 0x0051b6e0
0067b5e6 : MOV ECX,dword ptr [ESI + 0x20]
0067b5e9 : MOV EBX,dword ptr [ECX + 0xc]
0067b5ec : XOR EDI,EDI
0067b5ee : TEST EBX,EBX
0067b5f0 : JLE 0x0067b622
0067b5f2 : MOV EDX,dword ptr [ESI + 0x20]
0067b5f5 : MOV EAX,dword ptr [EDX + 0x8]
0067b5f8 : PUSH 0xbd6690
0067b5fd : LEA EDX,[ESP + 0x28]
0067b601 : LEA ECX,[EAX + EDI*0x4]
0067b604 : PUSH EDX
0067b605 : CALL 0x0051c6e0
0067b60a : PUSH EAX
0067b60b : LEA ECX,[ESP + 0x2c]
0067b60f : CALL 0x0051bd70
0067b614 : LEA ECX,[ESP + 0x24]
0067b618 : CALL 0x0045b730
0067b61d : INC EDI
0067b61e : CMP EDI,EBX
0067b620 : JL 0x0067b5f2
0067b622 : MOV ECX,dword ptr [ESP + 0x28]
0067b626 : MOV EAX,dword ptr [ESI]
0067b628 : MOV EDX,dword ptr [EAX + 0x24]
0067b62b : AND ECX,0xfffffffc
0067b62e : ADD ECX,0x8
0067b631 : PUSH ECX
0067b632 : MOV ECX,ESI
0067b634 : CALL EDX
0067b636 : LEA ECX,[ESP + 0x28]
0067b63a : CALL 0x0045b730
0067b63f : MOV EDI,dword ptr [ESP + 0x20]
0067b643 : TEST EDI,EDI
0067b645 : JZ 0x0067b64e
0067b647 : MOV ECX,EDI
0067b649 : CALL 0x004ff7e0
0067b64e : POP EDI
0067b64f : POP ESI
0067b650 : POP EBP
0067b651 : POP EBX
0067b652 : ADD ESP,0xc
0067b655 : RET 0xc
0067b658 : LEA ECX,[ESP + 0x28]
0067b65c : CALL 0x0051b6e0
0067b661 : MOV EAX,dword ptr [ESI + 0x20]
0067b664 : MOV EBX,dword ptr [EAX + 0x30]
0067b667 : TEST EBX,EBX
0067b669 : JZ 0x0067b798
0067b66f : XOR EDI,EDI
0067b671 : TEST EBX,EBX
0067b673 : JLE 0x0067b780
0067b679 : LEA ESP,[ESP]
0067b680 : MOV ECX,dword ptr [ESI + 0x20]
0067b683 : MOV EDX,dword ptr [ECX + 0x2c]
0067b686 : PUSH 0xbd6690
0067b68b : LEA EAX,[ESP + 0x14]
0067b68f : LEA ECX,[EDX + EDI*0x4]
0067b692 : PUSH EAX
0067b693 : CALL 0x0051c6e0
0067b698 : PUSH EAX
0067b699 : LEA ECX,[ESP + 0x2c]
0067b69d : CALL 0x0051bd70
0067b6a2 : LEA ECX,[ESP + 0x10]
0067b6a6 : CALL 0x0045b730
0067b6ab : INC EDI
0067b6ac : CMP EDI,EBX
0067b6ae : JL 0x0067b680
0067b6b0 : JMP 0x0067b780
0067b6b5 : LEA ECX,[ESP + 0x28]
0067b6b9 : CALL 0x0051b6e0
0067b6be : MOV EAX,dword ptr [ESI + 0x20]
0067b6c1 : MOV EBX,dword ptr [EAX + 0x18]
0067b6c4 : TEST EBX,EBX
0067b6c6 : JZ 0x0067b798
0067b6cc : XOR EDI,EDI
0067b6ce : TEST EBX,EBX
0067b6d0 : JLE 0x0067b780
0067b6d6 : JMP 0x0067b6e0
0067b6e0 : MOV ECX,dword ptr [ESI + 0x20]
0067b6e3 : MOV EDX,dword ptr [ECX + 0x14]
0067b6e6 : PUSH 0xbd6690
0067b6eb : LEA EAX,[ESP + 0x18]
0067b6ef : LEA ECX,[EDX + EDI*0x4]
0067b6f2 : PUSH EAX
0067b6f3 : CALL 0x0051c6e0
0067b6f8 : PUSH EAX
0067b6f9 : LEA ECX,[ESP + 0x2c]
0067b6fd : CALL 0x0051bd70
0067b702 : LEA ECX,[ESP + 0x14]
0067b706 : CALL 0x0045b730
0067b70b : INC EDI
0067b70c : CMP EDI,EBX
0067b70e : JL 0x0067b6e0
0067b710 : JMP 0x0067b780
0067b712 : CMP EAX,0x80000
0067b717 : JZ 0x0067b732
0067b719 : CMP EAX,0x10000000
0067b71e : JNZ 0x0067b643
0067b724 : MOV EAX,dword ptr [ESI]
0067b726 : MOV EDX,dword ptr [EAX + 0x34]
0067b729 : MOV ECX,ESI
0067b72b : CALL EDX
0067b72d : JMP 0x0067b643
0067b732 : LEA ECX,[ESP + 0x28]
0067b736 : CALL 0x0051b6e0
0067b73b : MOV EAX,dword ptr [ESI + 0x20]
0067b73e : MOV EBX,dword ptr [EAX + 0x24]
0067b741 : TEST EBX,EBX
0067b743 : JZ 0x0067b798
0067b745 : XOR EDI,EDI
0067b747 : TEST EBX,EBX
0067b749 : JLE 0x0067b780
0067b74b : JMP 0x0067b750
0067b750 : MOV ECX,dword ptr [ESI + 0x20]
0067b753 : MOV EDX,dword ptr [ECX + 0x20]
0067b756 : PUSH 0xbd6690
0067b75b : LEA EAX,[ESP + 0x1c]
0067b75f : LEA ECX,[EDX + EDI*0x4]
0067b762 : PUSH EAX
0067b763 : CALL 0x0051c6e0
0067b768 : PUSH EAX
0067b769 : LEA ECX,[ESP + 0x2c]
0067b76d : CALL 0x0051bd70
0067b772 : LEA ECX,[ESP + 0x18]
0067b776 : CALL 0x0045b730
0067b77b : INC EDI
0067b77c : CMP EDI,EBX
0067b77e : JL 0x0067b750
0067b780 : MOV EAX,dword ptr [ESP + 0x28]
0067b784 : MOV EDX,dword ptr [ESI]
0067b786 : MOV EDX,dword ptr [EDX + 0x24]
0067b789 : AND EAX,0xfffffffc
0067b78c : ADD EAX,0x8
0067b78f : PUSH EAX
0067b790 : MOV ECX,ESI
0067b792 : CALL EDX
0067b794 : MOV EDI,dword ptr [ESP + 0x20]
0067b798 : LEA ECX,[ESP + 0x28]
0067b79c : CALL 0x0045b730
0067b7a1 : JMP 0x0067b643
0067b7a6 : PUSH 0xbd667c
0067b7ab : PUSH EBP
0067b7ac : CALL 0x004ffb40
0067b7b1 : ADD ESP,0x8
0067b7b4 : TEST EAX,EAX
0067b7b6 : JNZ 0x0067b821
0067b7b8 : CMP dword ptr [ESI + 0x20],EAX
0067b7bb : JZ 0x0067b7cc
0067b7bd : MOV ECX,dword ptr [ESI + 0x20]
0067b7c0 : MOV EAX,dword ptr [ECX]
0067b7c2 : MOV EDX,dword ptr [ESP + 0x28]
0067b7c6 : MOV EAX,dword ptr [EAX + 0x20]
0067b7c9 : PUSH EDX
0067b7ca : CALL EAX
0067b7cc : MOV ECX,dword ptr [ESI + 0x20]
0067b7cf : CMP dword ptr [ECX + 0x44],0x9
0067b7d3 : JNZ 0x0067b7de
0067b7d5 : MOV EDX,dword ptr [ESI]
0067b7d7 : MOV EAX,dword ptr [EDX + 0x38]
0067b7da : MOV ECX,ESI
0067b7dc : CALL EAX
0067b7de : LEA EDI,[ESI + 0x44]
0067b7e1 : PUSH 0xbd648c
0067b7e6 : MOV ECX,EDI
0067b7e8 : CALL 0x004ffbc0
0067b7ed : TEST AL,AL
0067b7ef : JNZ 0x0067b805
0067b7f1 : PUSH 0xbd6484
0067b7f6 : MOV ECX,EDI
0067b7f8 : CALL 0x004ffbc0
0067b7fd : TEST AL,AL
0067b7ff : JZ 0x0067b63f
0067b805 : MOV EDX,dword ptr [ESI]
0067b807 : MOV EAX,dword ptr [EDX + 0x38]
0067b80a : MOV ECX,ESI
0067b80c : CALL EAX
0067b80e : MOV ESI,dword ptr [ESI + 0x20]
0067b811 : MOV EDX,dword ptr [ESI]
0067b813 : MOV EAX,dword ptr [EDX + 0x28]
0067b816 : PUSH -0x1
0067b818 : MOV ECX,ESI
0067b81a : CALL EAX
0067b81c : JMP 0x0067b63f
0067b821 : PUSH 0xbd665c
0067b826 : PUSH EBP
0067b827 : CALL 0x004ffb40
0067b82c : ADD ESP,0x8
0067b82f : TEST EAX,EAX
0067b831 : JNZ 0x0067b84e
0067b833 : MOV EAX,dword ptr [ESI + 0x20]
0067b836 : MOV ECX,dword ptr [EAX + 0x38]
0067b839 : MOV EDX,dword ptr [ESI]
0067b83b : MOV EDX,dword ptr [EDX + 0x20]
0067b83e : AND ECX,0xfffffffc
0067b841 : ADD ECX,0x8
0067b844 : PUSH ECX
0067b845 : MOV ECX,ESI
0067b847 : CALL EDX
0067b849 : JMP 0x0067b643
0067b84e : MOV EAX,dword ptr [ESI]
0067b850 : MOV EDX,dword ptr [EAX + 0x68]
0067b853 : MOV ECX,ESI
0067b855 : CALL EDX
0067b857 : CMP dword ptr [ESI + 0x20],0x0
0067b85b : JZ 0x0067b643
0067b861 : MOV ESI,dword ptr [ESI + 0x20]
0067b864 : MOV ECX,dword ptr [ESP + 0x28]
0067b868 : MOV EAX,dword ptr [ESI]
0067b86a : MOV EDX,dword ptr [EAX + 0x2c]
0067b86d : PUSH ECX
0067b86e : PUSH EBP
0067b86f : MOV ECX,ESI
0067b871 : CALL EDX
0067b873 : JMP 0x0067b643

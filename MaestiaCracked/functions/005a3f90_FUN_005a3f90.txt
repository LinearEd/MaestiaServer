PROGRAM  : Maestia.exe
FUNCTION : FUN_005a3f90
ENTRY    : 005a3f90
BODY     : [[005a3f90, 005a40e3]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005a3f90(undefined4 param_1,uint *param_2,uint param_3)

{
  uint *puVar1;
  int iVar2;
  int *piVar3;
  uint uVar4;
  uint *puVar5;
  int *in_ECX;
  int iVar6;
  uint uVar7;
  int iVar8;
  
  piVar3 = (int *)*in_ECX;
  if (piVar3 == (int *)0x0) {
    iVar8 = 8;
  }
  else {
    if ((uint)(*piVar3 * 5) <= piVar3[1] * 4 + 4U) goto LAB_005a3fca;
    iVar8 = piVar3[1] * 2 + 2;
  }
  FUN_005a3c00(param_1,iVar8);
LAB_005a3fca:
  piVar3 = (int *)*in_ECX;
  param_3 = param_3 & piVar3[1];
  *piVar3 = *piVar3 + 1;
  iVar8 = *in_ECX;
  puVar1 = (uint *)(param_3 * 0x20 + 8 + iVar8);
  if (*puVar1 == 0xfffffffe) {
    *puVar1 = 0xffffffff;
    puVar1[2] = *param_2;
    puVar1[3] = param_2[1];
    puVar1[4] = param_2[2];
    puVar1[5] = param_2[3];
    puVar1[6] = param_2[4];
    puVar1[7] = param_2[5];
    puVar1[1] = param_3;
    return;
  }
  uVar7 = param_3;
  do {
    uVar7 = uVar7 + 1 & *(uint *)(iVar8 + 4);
  } while (*(int *)(iVar8 + 8 + uVar7 * 0x20) != -2);
  iVar2 = uVar7 * 0x20 + 8 + iVar8;
  if (puVar1[1] != param_3) {
    iVar6 = puVar1[1] * 0x20;
    uVar4 = *(uint *)(iVar6 + 8 + iVar8);
    while (puVar5 = (uint *)(iVar6 + 8 + iVar8), uVar4 != param_3) {
      iVar6 = *puVar5 * 0x20;
      uVar4 = *(uint *)(iVar6 + 8 + iVar8);
    }
    if (iVar2 != 0) {
      FUN_005a30c0(puVar1);
    }
    *puVar5 = uVar7;
    puVar1[2] = *param_2;
    puVar1[3] = param_2[1];
    puVar1[4] = param_2[2];
    puVar1[5] = param_2[3];
    puVar1[6] = param_2[4];
    uVar7 = param_2[5];
    puVar1[1] = param_3;
    puVar1[7] = uVar7;
    *puVar1 = 0xffffffff;
    return;
  }
  if (iVar2 != 0) {
    FUN_005a30c0(puVar1);
  }
  puVar1[2] = *param_2;
  puVar1[3] = param_2[1];
  puVar1[4] = param_2[2];
  puVar1[5] = param_2[3];
  puVar1[6] = param_2[4];
  uVar4 = param_2[5];
  *puVar1 = uVar7;
  puVar1[1] = param_3;
  puVar1[7] = uVar4;
  return;
}



============================================================
DISASSEMBLY
============================================================
005a3f90 : PUSH ESI
005a3f91 : MOV ESI,ECX
005a3f93 : MOV EAX,dword ptr [ESI]
005a3f95 : PUSH EDI
005a3f96 : TEST EAX,EAX
005a3f98 : JNZ 0x005a3fa3
005a3f9a : MOV EAX,dword ptr [ESP + 0xc]
005a3f9e : PUSH 0x8
005a3fa0 : PUSH EAX
005a3fa1 : JMP 0x005a3fc5
005a3fa3 : MOV ECX,dword ptr [EAX + 0x4]
005a3fa6 : LEA EDX,[ECX*0x4 + 0x4]
005a3fad : MOV ECX,dword ptr [EAX]
005a3faf : LEA ECX,[ECX + ECX*0x4]
005a3fb2 : CMP ECX,EDX
005a3fb4 : JBE 0x005a3fca
005a3fb6 : MOV EDX,dword ptr [EAX + 0x4]
005a3fb9 : MOV ECX,dword ptr [ESP + 0xc]
005a3fbd : LEA EAX,[EDX + EDX*0x1 + 0x2]
005a3fc1 : PUSH EAX
005a3fc2 : PUSH ECX
005a3fc3 : MOV ECX,ESI
005a3fc5 : CALL 0x005a3c00
005a3fca : MOV EAX,dword ptr [ESI]
005a3fcc : MOV EDI,dword ptr [ESP + 0x14]
005a3fd0 : AND EDI,dword ptr [EAX + 0x4]
005a3fd3 : INC dword ptr [EAX]
005a3fd5 : MOV EAX,dword ptr [ESI]
005a3fd7 : MOV EDX,EDI
005a3fd9 : SHL EDX,0x5
005a3fdc : LEA ESI,[EDX + EAX*0x1 + 0x8]
005a3fe0 : MOV EDX,0xfffffffe
005a3fe5 : CMP dword ptr [ESI],EDX
005a3fe7 : JNZ 0x005a4021
005a3fe9 : MOV EAX,dword ptr [ESP + 0x10]
005a3fed : MOV dword ptr [ESI],0xffffffff
005a3ff3 : MOV ECX,dword ptr [EAX]
005a3ff5 : MOV dword ptr [ESI + 0x8],ECX
005a3ff8 : MOV EDX,dword ptr [EAX + 0x4]
005a3ffb : MOV dword ptr [ESI + 0xc],EDX
005a3ffe : MOV ECX,dword ptr [EAX + 0x8]
005a4001 : ADD EAX,0x8
005a4004 : MOV dword ptr [ESI + 0x10],ECX
005a4007 : MOV EDX,dword ptr [EAX + 0x4]
005a400a : MOV dword ptr [ESI + 0x14],EDX
005a400d : MOV ECX,dword ptr [EAX + 0x8]
005a4010 : MOV dword ptr [ESI + 0x18],ECX
005a4013 : MOV EDX,dword ptr [EAX + 0xc]
005a4016 : MOV dword ptr [ESI + 0x1c],EDX
005a4019 : MOV dword ptr [ESI + 0x4],EDI
005a401c : POP EDI
005a401d : POP ESI
005a401e : RET 0xc
005a4021 : MOV ECX,dword ptr [EAX + 0x4]
005a4024 : PUSH EBX
005a4025 : MOV EBX,EDI
005a4027 : PUSH EBP
005a4028 : INC EBX
005a4029 : AND EBX,ECX
005a402b : MOV EBP,EBX
005a402d : SHL EBP,0x5
005a4030 : CMP dword ptr [EAX + EBP*0x1 + 0x8],EDX
005a4034 : JNZ 0x005a4028
005a4036 : MOV EDX,dword ptr [ESI + 0x4]
005a4039 : MOV ECX,EBX
005a403b : SHL ECX,0x5
005a403e : LEA ECX,[ECX + EAX*0x1 + 0x8]
005a4042 : CMP EDX,EDI
005a4044 : JNZ 0x005a4083
005a4046 : TEST ECX,ECX
005a4048 : JZ 0x005a4050
005a404a : PUSH ESI
005a404b : CALL 0x005a30c0
005a4050 : MOV EAX,dword ptr [ESP + 0x18]
005a4054 : MOV EDX,dword ptr [EAX]
005a4056 : MOV dword ptr [ESI + 0x8],EDX
005a4059 : MOV ECX,dword ptr [EAX + 0x4]
005a405c : MOV dword ptr [ESI + 0xc],ECX
005a405f : MOV EDX,dword ptr [EAX + 0x8]
005a4062 : MOV dword ptr [ESI + 0x10],EDX
005a4065 : MOV ECX,dword ptr [EAX + 0xc]
005a4068 : MOV dword ptr [ESI + 0x14],ECX
005a406b : MOV EDX,dword ptr [EAX + 0x10]
005a406e : MOV dword ptr [ESI + 0x18],EDX
005a4071 : MOV EAX,dword ptr [EAX + 0x14]
005a4074 : POP EBP
005a4075 : MOV dword ptr [ESI],EBX
005a4077 : POP EBX
005a4078 : MOV dword ptr [ESI + 0x4],EDI
005a407b : POP EDI
005a407c : MOV dword ptr [ESI + 0x1c],EAX
005a407f : POP ESI
005a4080 : RET 0xc
005a4083 : SHL EDX,0x5
005a4086 : CMP dword ptr [EDX + EAX*0x1 + 0x8],EDI
005a408a : LEA EBP,[EDX + EAX*0x1 + 0x8]
005a408e : JZ 0x005a40a0
005a4090 : MOV EDX,dword ptr [EBP]
005a4093 : SHL EDX,0x5
005a4096 : CMP dword ptr [EDX + EAX*0x1 + 0x8],EDI
005a409a : LEA EBP,[EDX + EAX*0x1 + 0x8]
005a409e : JNZ 0x005a4090
005a40a0 : TEST ECX,ECX
005a40a2 : JZ 0x005a40aa
005a40a4 : PUSH ESI
005a40a5 : CALL 0x005a30c0
005a40aa : MOV EAX,dword ptr [ESP + 0x18]
005a40ae : MOV dword ptr [EBP],EBX
005a40b1 : MOV ECX,dword ptr [EAX]
005a40b3 : MOV dword ptr [ESI + 0x8],ECX
005a40b6 : MOV EDX,dword ptr [EAX + 0x4]
005a40b9 : MOV dword ptr [ESI + 0xc],EDX
005a40bc : MOV ECX,dword ptr [EAX + 0x8]
005a40bf : MOV dword ptr [ESI + 0x10],ECX
005a40c2 : MOV EDX,dword ptr [EAX + 0xc]
005a40c5 : MOV dword ptr [ESI + 0x14],EDX
005a40c8 : MOV ECX,dword ptr [EAX + 0x10]
005a40cb : POP EBP
005a40cc : MOV dword ptr [ESI + 0x18],ECX
005a40cf : MOV EDX,dword ptr [EAX + 0x14]
005a40d2 : POP EBX
005a40d3 : MOV dword ptr [ESI + 0x4],EDI
005a40d6 : POP EDI
005a40d7 : MOV dword ptr [ESI + 0x1c],EDX
005a40da : MOV dword ptr [ESI],0xffffffff
005a40e0 : POP ESI
005a40e1 : RET 0xc

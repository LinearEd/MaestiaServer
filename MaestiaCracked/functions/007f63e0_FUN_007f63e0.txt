PROGRAM  : Maestia.exe
FUNCTION : FUN_007f63e0
ENTRY    : 007f63e0
BODY     : [[007f63e0, 007f6578]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_007f63e0(int param_1,int param_2)

{
  int iVar1;
  char cVar2;
  uint uVar3;
  DWORD DVar4;
  int *piVar5;
  int *unaff_EDI;
  undefined4 uVar6;
  LPCRITICAL_SECTION local_28;
  char *local_24;
  undefined4 local_20;
  int local_1c;
  undefined4 local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b0d992;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_14 = 0;
  piVar5 = (int *)(param_1 + 0xc);
  do {
    iVar1 = *piVar5;
    if (((iVar1 != 0) && (*(int *)(iVar1 + 0x78) == param_2)) && (*(int *)(iVar1 + 4) == 2)) {
      cVar2 = (**(code **)(**(int **)(iVar1 + 0x54) + 0xc4))(uVar3);
      if (cVar2 != '\0') {
        if ((*unaff_EDI != 1) && (*unaff_EDI != 3)) {
          cVar2 = (**(code **)(**(int **)(iVar1 + 0x54) + 0xb0))(unaff_EDI[2],unaff_EDI[3],3);
          if (cVar2 == '\0') goto LAB_007f651b;
        }
        if (*unaff_EDI == 2) {
          *(undefined1 *)(param_1 + 0x16b) = 1;
        }
        local_28 = (LPCRITICAL_SECTION)(iVar1 + 0xc);
        local_1c = 0;
        local_24 = ".\\World\\AvaWorld.cpp";
        local_20 = 0xee5;
        local_18 = 1;
        FUN_006ef1a0(&local_28);
        local_8 = 0;
        (**(code **)(**(int **)(iVar1 + 0x54) + 0xa4))();
        if (*unaff_EDI != 1) {
          iVar1 = *(int *)*piVar5;
          uVar6 = 1;
          DVar4 = GetTickCount();
          (**(code **)(iVar1 + 0x30))(DVar4,uVar6);
        }
        if ((param_2 == 1) && (((iVar1 = *unaff_EDI, iVar1 == 1 || (iVar1 == 2)) || (iVar1 == 4))))
        {
          local_8 = 0xffffffff;
          if (local_1c != 0) {
            LeaveCriticalSection(local_28);
          }
          ExceptionList = local_10;
          return 1;
        }
        local_8 = 0xffffffff;
        if (local_1c != 0) {
          LeaveCriticalSection(local_28);
          local_1c = 0;
        }
      }
    }
LAB_007f651b:
    local_14 = local_14 + 1;
    piVar5 = piVar5 + 1;
    if (0x1f < local_14) {
      ExceptionList = local_10;
      return 0;
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
007f63e0 : PUSH EBP
007f63e1 : MOV EBP,ESP
007f63e3 : PUSH -0x1
007f63e5 : PUSH 0xb0d992
007f63ea : MOV EAX,FS:[0x0]
007f63f0 : PUSH EAX
007f63f1 : SUB ESP,0x18
007f63f4 : PUSH EBX
007f63f5 : PUSH ESI
007f63f6 : MOV EAX,[0x00d66fa0]
007f63fb : XOR EAX,EBP
007f63fd : PUSH EAX
007f63fe : LEA EAX,[EBP + -0xc]
007f6401 : MOV FS:[0x0],EAX
007f6407 : MOV EBX,dword ptr [EBP + 0x8]
007f640a : MOV dword ptr [EBP + -0x10],0x0
007f6411 : ADD EBX,0xc
007f6414 : MOV ESI,dword ptr [EBX]
007f6416 : TEST ESI,ESI
007f6418 : JZ 0x007f651b
007f641e : MOV EAX,dword ptr [EBP + 0xc]
007f6421 : CMP dword ptr [ESI + 0x78],EAX
007f6424 : JNZ 0x007f651b
007f642a : CMP dword ptr [ESI + 0x4],0x2
007f642e : JNZ 0x007f651b
007f6434 : MOV ECX,dword ptr [ESI + 0x54]
007f6437 : MOV EDX,dword ptr [ECX]
007f6439 : MOV EAX,dword ptr [EDX + 0xc4]
007f643f : CALL EAX
007f6441 : TEST AL,AL
007f6443 : JZ 0x007f651b
007f6449 : MOV EAX,dword ptr [EDI]
007f644b : CMP EAX,0x1
007f644e : JZ 0x007f647c
007f6450 : CMP EAX,0x3
007f6453 : JZ 0x007f647c
007f6455 : MOV ECX,dword ptr [ESI + 0x54]
007f6458 : FLD float ptr [EDI + 0xc]
007f645b : MOV EDX,dword ptr [ECX]
007f645d : MOV EAX,dword ptr [EDX + 0xb0]
007f6463 : PUSH 0x3
007f6465 : SUB ESP,0x8
007f6468 : FSTP float ptr [ESP + 0x4]
007f646c : FLD float ptr [EDI + 0x8]
007f646f : FSTP float ptr [ESP]
007f6472 : CALL EAX
007f6474 : TEST AL,AL
007f6476 : JZ 0x007f651b
007f647c : CMP dword ptr [EDI],0x2
007f647f : JNZ 0x007f648b
007f6481 : MOV ECX,dword ptr [EBP + 0x8]
007f6484 : MOV byte ptr [ECX + 0x16b],0x1
007f648b : LEA EAX,[EBP + -0x24]
007f648e : LEA EDX,[ESI + 0xc]
007f6491 : PUSH EAX
007f6492 : MOV dword ptr [EBP + -0x18],0x0
007f6499 : MOV dword ptr [EBP + -0x24],EDX
007f649c : MOV dword ptr [EBP + -0x20],0xc25a18
007f64a3 : MOV dword ptr [EBP + -0x1c],0xee5
007f64aa : MOV dword ptr [EBP + -0x14],0x1
007f64b1 : CALL 0x006ef1a0
007f64b6 : MOV dword ptr [EBP + -0x4],0x0
007f64bd : MOV ECX,dword ptr [ESI + 0x54]
007f64c0 : MOV EDX,dword ptr [ECX]
007f64c2 : MOV EAX,dword ptr [EDX + 0xa4]
007f64c8 : PUSH EDI
007f64c9 : CALL EAX
007f64cb : CMP dword ptr [EDI],0x1
007f64ce : JZ 0x007f64e6
007f64d0 : MOV ECX,dword ptr [EBX]
007f64d2 : MOV ESI,dword ptr [ECX]
007f64d4 : PUSH 0x1
007f64d6 : ADD ESI,0x30
007f64d9 : CALL dword ptr [0x00b850d8]
007f64df : MOV ECX,dword ptr [EBX]
007f64e1 : MOV EDX,dword ptr [ESI]
007f64e3 : PUSH EAX
007f64e4 : CALL EDX
007f64e6 : CMP dword ptr [EBP + 0xc],0x1
007f64ea : JNZ 0x007f64fd
007f64ec : MOV EAX,dword ptr [EDI]
007f64ee : CMP EAX,0x1
007f64f1 : JZ 0x007f6543
007f64f3 : CMP EAX,0x2
007f64f6 : JZ 0x007f6543
007f64f8 : CMP EAX,0x4
007f64fb : JZ 0x007f6543
007f64fd : MOV dword ptr [EBP + -0x4],0xffffffff
007f6504 : CMP dword ptr [EBP + -0x18],0x0
007f6508 : JZ 0x007f651b
007f650a : MOV EAX,dword ptr [EBP + -0x24]
007f650d : PUSH EAX
007f650e : CALL dword ptr [0x00b8511c]
007f6514 : MOV dword ptr [EBP + -0x18],0x0
007f651b : MOV EAX,dword ptr [EBP + -0x10]
007f651e : INC EAX
007f651f : ADD EBX,0x4
007f6522 : MOV dword ptr [EBP + -0x10],EAX
007f6525 : CMP EAX,0x20
007f6528 : JC 0x007f6414
007f652e : XOR EAX,EAX
007f6530 : MOV ECX,dword ptr [EBP + -0xc]
007f6533 : MOV dword ptr FS:[0x0],ECX
007f653a : POP ECX
007f653b : POP ESI
007f653c : POP EBX
007f653d : MOV ESP,EBP
007f653f : POP EBP
007f6540 : RET 0x8
007f6543 : MOV dword ptr [EBP + -0x4],0xffffffff
007f654a : CMP dword ptr [EBP + -0x18],0x0
007f654e : JZ 0x007f6561
007f6550 : MOV ECX,dword ptr [EBP + -0x24]
007f6553 : PUSH ECX
007f6554 : CALL dword ptr [0x00b8511c]
007f655a : MOV dword ptr [EBP + -0x18],0x0
007f6561 : MOV EAX,0x1
007f6566 : MOV ECX,dword ptr [EBP + -0xc]
007f6569 : MOV dword ptr FS:[0x0],ECX
007f6570 : POP ECX
007f6571 : POP ESI
007f6572 : POP EBX
007f6573 : MOV ESP,EBP
007f6575 : POP EBP
007f6576 : RET 0x8

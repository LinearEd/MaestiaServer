PROGRAM  : Maestia.exe
FUNCTION : FUN_00574d10
ENTRY    : 00574d10
BODY     : [[00574d10, 00574f55]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00574d10(char *param_1,undefined4 param_2,char *param_3,undefined4 param_4,
                 undefined4 param_5)

{
  bool bVar1;
  bool bVar2;
  char *pcVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  LONG LVar7;
  int in_ECX;
  undefined4 *puVar8;
  undefined4 uVar9;
  int local_4;
  
  pcVar3 = param_1;
  local_4 = 0;
  if (param_3 == (char *)0x0) {
    bVar2 = false;
    bVar1 = true;
    param_1 = (char *)FUN_00525530(param_1);
    *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 1;
    if ((*(int *)(in_ECX + 0x68) == 0) || (*(int *)(param_1 + 0x10) == 0)) {
      iVar4 = 0;
    }
    else {
      uVar9 = 0;
      puVar8 = &param_1;
      (**(code **)(**(int **)(in_ECX + 0x68) + 0x5c))(puVar8,0);
      iVar4 = FUN_0052add0(puVar8,uVar9);
    }
  }
  else {
    bVar2 = true;
    bVar1 = false;
    local_4 = FUN_00525530(param_1);
    *(int *)(local_4 + 8) = *(int *)(local_4 + 8) + 1;
    iVar4 = FUN_0052add0(&local_4,0);
  }
  if ((bVar1) && (*(int *)(param_1 + 8) = *(int *)(param_1 + 8) + -1, *(int *)(param_1 + 8) == 0)) {
    FUN_00525340();
  }
  if ((bVar2) && (*(int *)(local_4 + 8) = *(int *)(local_4 + 8) + -1, *(int *)(local_4 + 8) == 0)) {
    FUN_00525340();
  }
  bVar1 = false;
  if (iVar4 == 0) {
    param_1 = "";
    uVar6 = FUN_0051cf20();
    param_3 = (char *)CONCAT31(param_3._1_3_,6 < uVar6);
    iVar5 = FUN_0056a360(pcVar3,&param_1,param_3);
    if (*param_1 != '\0') {
      return;
    }
    if (iVar5 == -1) {
      return;
    }
LAB_00574ed3:
    iVar4 = FUN_00515840(0x68,0);
    if (iVar4 == 0) {
      iVar5 = 0;
      goto LAB_00574f35;
    }
    FUN_0051c480(param_2);
    iVar5 = FUN_0056ebb0(iVar5,&param_1,param_4,0,0);
    pcVar3 = param_1;
  }
  else {
    iVar5 = FUN_0054ed10();
    if ((iVar5 != 0) && (iVar5 = *(int *)(iVar5 + 0x1a0), iVar5 != -1)) goto LAB_00574ed3;
    iVar5 = FUN_00515840(0x68,0);
    if (iVar5 == 0) {
      iVar5 = 0;
    }
    else {
      FUN_0051c480(param_2);
      iVar4 = *(int *)(iVar4 + 0x80);
      bVar1 = true;
      if (iVar4 == 0) {
        iVar4 = FUN_00520df0();
      }
      FUN_0051b6e0();
      *(undefined4 *)(iVar5 + 0x14) = 0;
      *(undefined1 *)(iVar5 + 0x1c) = 0;
      *(undefined1 *)(iVar5 + 0x2c) = 0;
      *(undefined1 *)(iVar5 + 0x3c) = 0;
      *(undefined4 *)(iVar5 + 0x4c) = 0;
      *(undefined1 *)(iVar5 + 0x50) = 0;
      *(undefined4 *)(iVar5 + 0x60) = 0;
      FUN_0056eaa0(((uint)param_3 & 0xfffffffc) == 0xfffffff8,iVar4,0xffffffff,&param_3,param_4,0);
    }
    pcVar3 = param_3;
    if (!bVar1) goto LAB_00574f35;
  }
  LVar7 = InterlockedExchangeAdd((LONG *)(((uint)pcVar3 & 0xfffffffc) + 4),-1);
  if (LVar7 == 1) {
    FUN_00515cf0((uint)pcVar3 & 0xfffffffc);
  }
LAB_00574f35:
  if (iVar5 != 0) {
    FUN_005271c0(param_5);
    FUN_00571790(iVar5);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00574d10 : PUSH ECX
00574d11 : PUSH EBX
00574d12 : PUSH EBP
00574d13 : PUSH ESI
00574d14 : PUSH EDI
00574d15 : MOV dword ptr [ESP + 0x10],0x0
00574d1d : MOV EBP,dword ptr [ESP + 0x20]
00574d21 : MOV ESI,dword ptr [ESP + 0x18]
00574d25 : MOV EDI,ECX
00574d27 : MOV EAX,dword ptr [EDI + 0x9e8]
00574d2d : LEA ECX,[EAX + 0x254]
00574d33 : PUSH ESI
00574d34 : TEST EBP,EBP
00574d36 : JZ 0x00574d5b
00574d38 : MOV EBX,0x1
00574d3d : CALL 0x00525530
00574d42 : MOV dword ptr [ESP + 0x10],EAX
00574d46 : INC dword ptr [EAX + 0x8]
00574d49 : PUSH 0x0
00574d4b : LEA EAX,[ESP + 0x14]
00574d4f : PUSH EAX
00574d50 : MOV ECX,EBP
00574d52 : CALL 0x0052add0
00574d57 : MOV EBP,EAX
00574d59 : JMP 0x00574d9a
00574d5b : MOV EBX,0x2
00574d60 : CALL 0x00525530
00574d65 : MOV dword ptr [ESP + 0x18],EAX
00574d69 : INC dword ptr [EAX + 0x8]
00574d6c : CMP dword ptr [EDI + 0x68],0x0
00574d70 : JZ 0x00574d98
00574d72 : MOV ECX,dword ptr [ESP + 0x18]
00574d76 : CMP dword ptr [ECX + 0x10],0x0
00574d7a : JZ 0x00574d98
00574d7c : MOV ECX,dword ptr [EDI + 0x68]
00574d7f : MOV EAX,dword ptr [ECX]
00574d81 : PUSH 0x0
00574d83 : LEA EDX,[ESP + 0x1c]
00574d87 : PUSH EDX
00574d88 : MOV EDX,dword ptr [EAX + 0x5c]
00574d8b : CALL EDX
00574d8d : MOV ECX,EAX
00574d8f : CALL 0x0052add0
00574d94 : MOV EBP,EAX
00574d96 : JMP 0x00574d9a
00574d98 : XOR EBP,EBP
00574d9a : TEST BL,0x2
00574d9d : JZ 0x00574db8
00574d9f : MOV EAX,dword ptr [ESP + 0x18]
00574da3 : DEC dword ptr [EAX + 0x8]
00574da6 : MOV ECX,EAX
00574da8 : ADD EAX,0x8
00574dab : AND EBX,0xfffffffd
00574dae : CMP dword ptr [EAX],0x0
00574db1 : JNZ 0x00574db8
00574db3 : CALL 0x00525340
00574db8 : TEST BL,0x1
00574dbb : JZ 0x00574dd6
00574dbd : MOV EAX,dword ptr [ESP + 0x10]
00574dc1 : DEC dword ptr [EAX + 0x8]
00574dc4 : MOV ECX,EAX
00574dc6 : ADD EAX,0x8
00574dc9 : AND EBX,0xfffffffe
00574dcc : CMP dword ptr [EAX],0x0
00574dcf : JNZ 0x00574dd6
00574dd1 : CALL 0x00525340
00574dd6 : TEST EBP,EBP
00574dd8 : JZ 0x00574e92
00574dde : LEA ECX,[EBP + 0x68]
00574de1 : CALL 0x0054ed10
00574de6 : TEST EAX,EAX
00574de8 : JZ 0x00574df9
00574dea : MOV ESI,dword ptr [EAX + 0x1a0]
00574df0 : CMP ESI,-0x1
00574df3 : JNZ 0x00574ed3
00574df9 : MOV ECX,dword ptr [EDI + 0x14]
00574dfc : PUSH 0x0
00574dfe : PUSH 0x68
00574e00 : CALL 0x00515840
00574e05 : MOV ESI,EAX
00574e07 : TEST ESI,ESI
00574e09 : JZ 0x00574e75
00574e0b : MOV EAX,dword ptr [ESP + 0x1c]
00574e0f : PUSH EAX
00574e10 : LEA ECX,[ESP + 0x24]
00574e14 : CALL 0x0051c480
00574e19 : MOV EAX,dword ptr [EBP + 0x80]
00574e1f : OR EBX,0x4
00574e22 : TEST EAX,EAX
00574e24 : JNZ 0x00574e2d
00574e26 : MOV ECX,EBP
00574e28 : CALL 0x00520df0
00574e2d : LEA ECX,[ESI + 0xc]
00574e30 : MOV EBP,EAX
00574e32 : CALL 0x0051b6e0
00574e37 : MOV ECX,dword ptr [ESP + 0x24]
00574e3b : XOR EAX,EAX
00574e3d : MOV dword ptr [ESI + 0x14],EAX
00574e40 : MOV byte ptr [ESI + 0x1c],AL
00574e43 : MOV byte ptr [ESI + 0x2c],AL
00574e46 : MOV byte ptr [ESI + 0x3c],AL
00574e49 : PUSH EAX
00574e4a : MOV dword ptr [ESI + 0x4c],EAX
00574e4d : MOV byte ptr [ESI + 0x50],AL
00574e50 : MOV dword ptr [ESI + 0x60],EAX
00574e53 : MOV EAX,dword ptr [ESP + 0x24]
00574e57 : AND EAX,0xfffffffc
00574e5a : PUSH ECX
00574e5b : ADD EAX,0x8
00574e5e : LEA EDX,[ESP + 0x28]
00574e62 : PUSH EDX
00574e63 : NEG EAX
00574e65 : PUSH -0x1
00574e67 : SBB EAX,EAX
00574e69 : PUSH EBP
00574e6a : INC EAX
00574e6b : PUSH EAX
00574e6c : MOV ECX,ESI
00574e6e : CALL 0x0056eaa0
00574e73 : JMP 0x00574e77
00574e75 : XOR ESI,ESI
00574e77 : TEST BL,0x4
00574e7a : JZ 0x00574f35
00574e80 : MOV EBX,dword ptr [ESP + 0x20]
00574e84 : AND EBX,0xfffffffc
00574e87 : PUSH -0x1
00574e89 : LEA ECX,[EBX + 0x4]
00574e8c : PUSH ECX
00574e8d : JMP 0x00574f24
00574e92 : MOV ECX,dword ptr [EDI + 0x68]
00574e95 : MOV dword ptr [ESP + 0x18],0xcca874
00574e9d : CALL 0x0051cf20
00574ea2 : CMP EAX,0x6
00574ea5 : SETA DL
00574ea8 : MOV byte ptr [ESP + 0x20],DL
00574eac : MOV EAX,dword ptr [ESP + 0x20]
00574eb0 : PUSH EAX
00574eb1 : LEA ECX,[ESP + 0x1c]
00574eb5 : PUSH ECX
00574eb6 : PUSH ESI
00574eb7 : CALL 0x0056a360
00574ebc : MOV EDX,dword ptr [ESP + 0x24]
00574ec0 : ADD ESP,0xc
00574ec3 : CMP byte ptr [EDX],0x0
00574ec6 : MOV ESI,EAX
00574ec8 : JNZ 0x00574f4e
00574ece : CMP ESI,-0x1
00574ed1 : JZ 0x00574f4e
00574ed3 : MOV ECX,dword ptr [EDI + 0x14]
00574ed6 : PUSH 0x0
00574ed8 : PUSH 0x68
00574eda : CALL 0x00515840
00574edf : MOV EBP,EAX
00574ee1 : TEST EBP,EBP
00574ee3 : JZ 0x00574f10
00574ee5 : MOV EAX,dword ptr [ESP + 0x1c]
00574ee9 : PUSH EAX
00574eea : LEA ECX,[ESP + 0x1c]
00574eee : CALL 0x0051c480
00574ef3 : MOV ECX,dword ptr [ESP + 0x24]
00574ef7 : PUSH 0x0
00574ef9 : PUSH 0x0
00574efb : PUSH ECX
00574efc : LEA EDX,[ESP + 0x24]
00574f00 : PUSH EDX
00574f01 : PUSH ESI
00574f02 : MOV ECX,EBP
00574f04 : OR EBX,0x8
00574f07 : CALL 0x0056ebb0
00574f0c : MOV ESI,EAX
00574f0e : JMP 0x00574f12
00574f10 : XOR ESI,ESI
00574f12 : TEST BL,0x8
00574f15 : JZ 0x00574f35
00574f17 : MOV EBX,dword ptr [ESP + 0x18]
00574f1b : AND EBX,0xfffffffc
00574f1e : PUSH -0x1
00574f20 : LEA EAX,[EBX + 0x4]
00574f23 : PUSH EAX
00574f24 : CALL dword ptr [0x00b851cc]
00574f2a : SUB EAX,0x1
00574f2d : JNZ 0x00574f35
00574f2f : PUSH EBX
00574f30 : CALL 0x00515cf0
00574f35 : TEST ESI,ESI
00574f37 : JZ 0x00574f4e
00574f39 : MOV ECX,dword ptr [ESP + 0x28]
00574f3d : PUSH ECX
00574f3e : LEA ECX,[ESI + 0x1c]
00574f41 : CALL 0x005271c0
00574f46 : PUSH ESI
00574f47 : MOV ECX,EDI
00574f49 : CALL 0x00571790
00574f4e : POP EDI
00574f4f : POP ESI
00574f50 : POP EBP
00574f51 : POP EBX
00574f52 : POP ECX
00574f53 : RET 0x14

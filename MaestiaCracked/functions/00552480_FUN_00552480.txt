PROGRAM  : Maestia.exe
FUNCTION : FUN_00552480
ENTRY    : 00552480
BODY     : [[00552480, 0055270b]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00552480(int *param_1,int *param_2,char *param_3,undefined1 *param_4)

{
  undefined1 uVar1;
  int iVar2;
  char *pcVar3;
  int iVar4;
  undefined4 uVar5;
  undefined4 *puVar6;
  int *in_ECX;
  int *piVar7;
  int *piStack_1c;
  undefined1 *puStack_18;
  byte bStack_14;
  undefined1 uStack_10;
  undefined1 uStack_f;
  
  pcVar3 = param_3;
  if ((((*(char *)((int)in_ECX + 0x1d) == '\0') && (*param_3 == '\x06')) &&
      (*param_2 == *(int *)(*param_1 + 0x140))) &&
     ((iVar4 = FUN_00526fa0(0), iVar4 != 0 &&
      (iVar4 = (**(code **)(*(int *)(iVar4 + 0x10) + 8))(), iVar4 == 7)))) {
    *(undefined1 *)((int)in_ECX + 0x1d) = 1;
  }
  iVar4 = *param_2;
  if (*(byte *)(param_1 + 1) < 7) {
    if (*(int *)(iVar4 + 4) == 0) {
      FUN_00525a80();
    }
    iVar4 = *param_1;
    iVar2 = *(int *)(*param_2 + 4);
    if (*(int *)(*(int *)(iVar4 + 0x134) + 4) == iVar2) {
      if (*param_3 != '\n') {
        iVar4 = *in_ECX;
        uVar5 = FUN_00526fa0(0);
        (**(code **)(iVar4 + 0x34))(param_1,uVar5);
        FUN_0052a830();
      }
      param_3 = &DAT_00d657dc;
    }
    else if (*(int *)(*(int *)(iVar4 + 0x144) + 4) == iVar2) {
      if (*param_3 != '\n') {
        uVar5 = FUN_00527140(&piStack_1c,0);
        FUN_00568a50(uVar5);
        if (((bStack_14 & 2) == 0) && (piStack_1c != (int *)0x0)) {
          FUN_00503db0();
        }
        piStack_1c = (int *)0x0;
        if (((bStack_14 & 1) == 0) && (puStack_18 != (undefined1 *)0x0)) {
          FUN_00503db0();
        }
      }
      param_3 = &DAT_00d657dc;
    }
    else if (*param_2 == *(int *)(iVar4 + 0x194)) {
      FUN_0052a830();
    }
    puVar6 = (undefined4 *)FUN_0052f620(&piStack_1c,param_2);
    piVar7 = (int *)*puVar6;
    iVar4 = puVar6[1];
  }
  else {
    iVar2 = *param_1;
    if (iVar4 == *(int *)(iVar2 + 0x134)) {
      if (*param_3 != '\n') {
        iVar4 = *in_ECX;
        uVar5 = FUN_00526fa0(0);
        (**(code **)(iVar4 + 0x34))(param_1,uVar5);
        FUN_0052a830();
      }
      param_3 = &DAT_00d657dc;
    }
    else if (iVar4 == *(int *)(iVar2 + 0x144)) {
      if (*param_3 != '\n') {
        uVar5 = FUN_00527140(&piStack_1c,0);
        FUN_00568a50(uVar5);
        if (((bStack_14 & 2) == 0) && (piStack_1c != (int *)0x0)) {
          FUN_00503db0();
        }
        piStack_1c = (int *)0x0;
        if (((bStack_14 & 1) == 0) && (puStack_18 != (undefined1 *)0x0)) {
          FUN_00503db0();
        }
      }
      param_3 = &DAT_00d657dc;
    }
    else if (iVar4 == *(int *)(iVar2 + 0x194)) {
      FUN_0052a830();
    }
    piVar7 = in_ECX + 2;
    if ((in_ECX[2] == 0) ||
       (iVar4 = FUN_0054f3b0(param_2,*(uint *)(in_ECX[2] + 4) & *(uint *)(*param_2 + 0xc)),
       iVar4 < 0)) {
      piVar7 = (int *)0x0;
      iVar4 = 0;
    }
  }
  if (*pcVar3 == '\t') {
    *(undefined1 *)(in_ECX + 7) = 1;
  }
  if (((piVar7 != (int *)0x0) && (*piVar7 != 0)) && (iVar4 <= *(int *)(*piVar7 + 4))) {
    FUN_005268b0(param_3);
    return 1;
  }
  uVar1 = *param_4;
  FUN_005266c0(param_3);
  puStack_18 = &uStack_10;
  piStack_1c = param_2;
  uStack_f = uVar1;
  FUN_00551010(in_ECX + 2,&piStack_1c);
  FUN_00526bc0();
  return 1;
}



============================================================
DISASSEMBLY
============================================================
00552480 : SUB ESP,0x1c
00552483 : PUSH EBX
00552484 : PUSH EBP
00552485 : MOV EBP,dword ptr [ESP + 0x30]
00552489 : PUSH ESI
0055248a : MOV ESI,dword ptr [ESP + 0x2c]
0055248e : PUSH EDI
0055248f : MOV EDI,ECX
00552491 : CMP byte ptr [EDI + 0x1d],0x0
00552495 : MOV dword ptr [ESP + 0x38],EBP
00552499 : JNZ 0x005524d4
0055249b : CMP byte ptr [EBP],0x6
0055249f : JNZ 0x005524d4
005524a1 : MOV EBX,dword ptr [ESP + 0x34]
005524a5 : MOV EAX,dword ptr [ESI]
005524a7 : MOV ECX,dword ptr [EBX]
005524a9 : CMP ECX,dword ptr [EAX + 0x140]
005524af : JNZ 0x005524d8
005524b1 : PUSH 0x0
005524b3 : MOV ECX,EBP
005524b5 : CALL 0x00526fa0
005524ba : TEST EAX,EAX
005524bc : JZ 0x005524d8
005524be : MOV EDX,dword ptr [EAX + 0x10]
005524c1 : LEA ECX,[EAX + 0x10]
005524c4 : MOV EAX,dword ptr [EDX + 0x8]
005524c7 : CALL EAX
005524c9 : CMP EAX,0x7
005524cc : JNZ 0x005524d8
005524ce : MOV byte ptr [EDI + 0x1d],0x1
005524d2 : JMP 0x005524d8
005524d4 : MOV EBX,dword ptr [ESP + 0x34]
005524d8 : CMP byte ptr [ESI + 0x4],0x6
005524dc : MOV ECX,dword ptr [EBX]
005524de : JBE 0x005525ba
005524e4 : MOV EAX,dword ptr [ESI]
005524e6 : CMP ECX,dword ptr [EAX + 0x134]
005524ec : JNZ 0x0055251d
005524ee : CMP byte ptr [EBP],0xa
005524f2 : JZ 0x00552513
005524f4 : MOV EBX,dword ptr [EDI]
005524f6 : PUSH 0x0
005524f8 : MOV ECX,EBP
005524fa : CALL 0x00526fa0
005524ff : MOV EDX,dword ptr [EBX + 0x34]
00552502 : PUSH EAX
00552503 : PUSH ESI
00552504 : MOV ECX,EDI
00552506 : CALL EDX
00552508 : MOV ECX,ESI
0055250a : CALL 0x0052a830
0055250f : MOV EBX,dword ptr [ESP + 0x34]
00552513 : MOV dword ptr [ESP + 0x38],0xd657dc
0055251b : JMP 0x0055258b
0055251d : CMP ECX,dword ptr [EAX + 0x144]
00552523 : JNZ 0x0055257c
00552525 : CMP byte ptr [EBP],0xa
00552529 : JZ 0x00552572
0055252b : PUSH 0x0
0055252d : LEA EAX,[ESP + 0x14]
00552531 : PUSH EAX
00552532 : MOV ECX,EBP
00552534 : CALL 0x00527140
00552539 : PUSH EAX
0055253a : LEA ECX,[EDI + 0xc]
0055253d : CALL 0x00568a50
00552542 : TEST byte ptr [ESP + 0x18],0x2
00552547 : JNZ 0x00552556
00552549 : MOV ECX,dword ptr [ESP + 0x10]
0055254d : TEST ECX,ECX
0055254f : JZ 0x00552556
00552551 : CALL 0x00503db0
00552556 : TEST byte ptr [ESP + 0x18],0x1
0055255b : MOV dword ptr [ESP + 0x10],0x0
00552563 : JNZ 0x00552572
00552565 : MOV ECX,dword ptr [ESP + 0x14]
00552569 : TEST ECX,ECX
0055256b : JZ 0x00552572
0055256d : CALL 0x00503db0
00552572 : MOV dword ptr [ESP + 0x38],0xd657dc
0055257a : JMP 0x0055258b
0055257c : CMP ECX,dword ptr [EAX + 0x194]
00552582 : JNZ 0x0055258b
00552584 : MOV ECX,ESI
00552586 : CALL 0x0052a830
0055258b : MOV EAX,dword ptr [EDI + 0x8]
0055258e : LEA ESI,[EDI + 0x8]
00552591 : TEST EAX,EAX
00552593 : JZ 0x005525b1
00552595 : MOV ECX,dword ptr [EBX]
00552597 : MOV EDX,dword ptr [EAX + 0x4]
0055259a : AND EDX,dword ptr [ECX + 0xc]
0055259d : MOV ECX,ESI
0055259f : PUSH EDX
005525a0 : PUSH EBX
005525a1 : CALL 0x0054f3b0
005525a6 : TEST EAX,EAX
005525a8 : JL 0x005525b1
005525aa : MOV ECX,ESI
005525ac : JMP 0x0055268c
005525b1 : XOR ECX,ECX
005525b3 : XOR EAX,EAX
005525b5 : JMP 0x0055268c
005525ba : CMP dword ptr [ECX + 0x4],0x0
005525be : JNZ 0x005525c5
005525c0 : CALL 0x00525a80
005525c5 : MOV EDX,dword ptr [EBX]
005525c7 : MOV EAX,dword ptr [ESI]
005525c9 : MOV ECX,dword ptr [EDX + 0x4]
005525cc : MOV EBX,dword ptr [EAX + 0x134]
005525d2 : CMP dword ptr [EBX + 0x4],ECX
005525d5 : JNZ 0x00552602
005525d7 : CMP byte ptr [EBP],0xa
005525db : JZ 0x005525f8
005525dd : MOV EBX,dword ptr [EDI]
005525df : PUSH 0x0
005525e1 : MOV ECX,EBP
005525e3 : CALL 0x00526fa0
005525e8 : PUSH EAX
005525e9 : MOV EAX,dword ptr [EBX + 0x34]
005525ec : PUSH ESI
005525ed : MOV ECX,EDI
005525ef : CALL EAX
005525f1 : MOV ECX,ESI
005525f3 : CALL 0x0052a830
005525f8 : MOV dword ptr [ESP + 0x38],0xd657dc
00552600 : JMP 0x00552673
00552602 : MOV EBX,dword ptr [EAX + 0x144]
00552608 : CMP dword ptr [EBX + 0x4],ECX
0055260b : JNZ 0x00552664
0055260d : CMP byte ptr [EBP],0xa
00552611 : JZ 0x0055265a
00552613 : PUSH 0x0
00552615 : LEA ECX,[ESP + 0x14]
00552619 : PUSH ECX
0055261a : MOV ECX,EBP
0055261c : CALL 0x00527140
00552621 : PUSH EAX
00552622 : LEA ECX,[EDI + 0xc]
00552625 : CALL 0x00568a50
0055262a : TEST byte ptr [ESP + 0x18],0x2
0055262f : JNZ 0x0055263e
00552631 : MOV ECX,dword ptr [ESP + 0x10]
00552635 : TEST ECX,ECX
00552637 : JZ 0x0055263e
00552639 : CALL 0x00503db0
0055263e : TEST byte ptr [ESP + 0x18],0x1
00552643 : MOV dword ptr [ESP + 0x10],0x0
0055264b : JNZ 0x0055265a
0055264d : MOV ECX,dword ptr [ESP + 0x14]
00552651 : TEST ECX,ECX
00552653 : JZ 0x0055265a
00552655 : CALL 0x00503db0
0055265a : MOV dword ptr [ESP + 0x38],0xd657dc
00552662 : JMP 0x00552673
00552664 : CMP EDX,dword ptr [EAX + 0x194]
0055266a : JNZ 0x00552673
0055266c : MOV ECX,ESI
0055266e : CALL 0x0052a830
00552673 : MOV EDX,dword ptr [ESP + 0x34]
00552677 : PUSH EDX
00552678 : LEA EAX,[ESP + 0x14]
0055267c : LEA ESI,[EDI + 0x8]
0055267f : PUSH EAX
00552680 : MOV ECX,ESI
00552682 : CALL 0x0052f620
00552687 : MOV ECX,dword ptr [EAX]
00552689 : MOV EAX,dword ptr [EAX + 0x4]
0055268c : CMP byte ptr [EBP],0x9
00552690 : JNZ 0x00552696
00552692 : MOV byte ptr [EDI + 0x1c],0x1
00552696 : TEST ECX,ECX
00552698 : JZ 0x005526c2
0055269a : MOV ECX,dword ptr [ECX]
0055269c : TEST ECX,ECX
0055269e : JZ 0x005526c2
005526a0 : CMP EAX,dword ptr [ECX + 0x4]
005526a3 : JG 0x005526c2
005526a5 : MOV EDX,dword ptr [ESP + 0x38]
005526a9 : LEA EAX,[EAX + EAX*0x2]
005526ac : PUSH EDX
005526ad : LEA ECX,[ECX + EAX*0x8 + 0x10]
005526b1 : CALL 0x005268b0
005526b6 : POP EDI
005526b7 : POP ESI
005526b8 : POP EBP
005526b9 : MOV AL,0x1
005526bb : POP EBX
005526bc : ADD ESP,0x1c
005526bf : RET 0x10
005526c2 : MOV ECX,dword ptr [ESP + 0x3c]
005526c6 : MOV EDX,dword ptr [ESP + 0x38]
005526ca : MOV BL,byte ptr [ECX]
005526cc : PUSH EDX
005526cd : LEA ECX,[ESP + 0x20]
005526d1 : CALL 0x005266c0
005526d6 : MOV EAX,dword ptr [ESP + 0x34]
005526da : LEA EDX,[ESP + 0x10]
005526de : LEA ECX,[ESP + 0x1c]
005526e2 : PUSH EDX
005526e3 : MOV dword ptr [ESP + 0x18],ECX
005526e7 : PUSH ESI
005526e8 : MOV ECX,ESI
005526ea : MOV byte ptr [ESP + 0x25],BL
005526ee : MOV dword ptr [ESP + 0x18],EAX
005526f2 : CALL 0x00551010
005526f7 : LEA ECX,[ESP + 0x1c]
005526fb : CALL 0x00526bc0
00552700 : POP EDI
00552701 : POP ESI
00552702 : POP EBP
00552703 : MOV AL,0x1
00552705 : POP EBX
00552706 : ADD ESP,0x1c
00552709 : RET 0x10

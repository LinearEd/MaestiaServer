PROGRAM  : Maestia.exe
FUNCTION : FUN_00802b90
ENTRY    : 00802b90
BODY     : [[00802b90, 00802c09] [00802c10, 00802d81]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00802b90(int param_1,int param_2)

{
  int iVar1;
  int iVar2;
  LPCRITICAL_SECTION lpCriticalSection;
  undefined1 auStack_78 [4];
  undefined2 local_74;
  undefined4 uStack_6c;
  int iStack_68;
  int *local_64;
  int local_4c;
  int local_48;
  LPCRITICAL_SECTION local_44;
  int local_40;
  undefined1 *local_3c;
  undefined2 local_34;
  undefined4 local_24;
  uint local_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  uint local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b3cc8f;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)&local_4c;
  ExceptionList = &local_14;
  lpCriticalSection = (LPCRITICAL_SECTION)(param_1 + 0xb8);
  local_4c = param_2;
  local_64 = (int *)0x802be2;
  local_44 = lpCriticalSection;
  EnterCriticalSection(lpCriticalSection);
  local_c = 0;
  if (*(char *)(param_1 + 0x94) == '\0') {
    local_48 = **(int **)(param_1 + 0x4c);
    if ((int *)local_48 != *(int **)(param_1 + 0x4c)) {
      do {
        iVar1 = *(int *)(local_48 + 0xc);
        local_40 = *(int *)(local_48 + 0x10);
        if (((iVar1 != 0) && (local_40 != 0)) &&
           (iVar2 = *(int *)(local_40 + 4), iVar2 != *(int *)(local_40 + 8))) {
          do {
            local_3c = auStack_78;
            local_64 = (int *)0x0;
            local_74 = 0;
            FUN_00405eb0(iVar2,0,0xffffffff);
            local_c = local_c & 0xffffff00;
            local_64 = (int *)FUN_00a5fb10(iVar1);
            uStack_6c = 0x802c70;
            iStack_68 = iVar1;
            FUN_008022f0();
            iVar2 = iVar2 + 0x1c;
          } while (iVar2 != *(int *)(local_40 + 8));
        }
        FUN_00416210();
        lpCriticalSection = local_44;
      } while (local_48 != *(int *)(param_1 + 0x4c));
    }
    *(undefined1 *)(param_1 + 0x94) = 1;
  }
  local_64 = (int *)0x0;
  local_34 = 0;
  iStack_68 = local_4c;
  local_20 = 7;
  local_24 = 0;
  uStack_6c = 0x802cc4;
  FUN_00405eb0();
  local_c._0_1_ = 2;
  FUN_0070c1f0();
  local_64 = &local_4c;
  iStack_68 = param_1 + 0x68;
  uStack_6c = 0x802ce5;
  FUN_0044f270();
  if (local_4c == *(int *)(param_1 + 0x70)) {
    local_c = (uint)local_c._1_3_ << 8;
    if (7 < local_20) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_20 = 7;
    local_24 = 0;
    local_34 = 0;
    local_c = 0xffffffff;
    local_64 = (int *)0x802d60;
    LeaveCriticalSection(lpCriticalSection);
  }
  else {
    local_c = (uint)local_c._1_3_ << 8;
    if (7 < local_20) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_20 = 7;
    local_24 = 0;
    local_34 = 0;
    local_c = 0xffffffff;
    local_64 = (int *)0x802d25;
    LeaveCriticalSection(lpCriticalSection);
  }
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)&local_4c);
  return;
}



============================================================
DISASSEMBLY
============================================================
00802b90 : PUSH EBP
00802b91 : MOV EBP,ESP
00802b93 : AND ESP,0xfffffff8
00802b96 : PUSH -0x1
00802b98 : PUSH 0xb3cc8f
00802b9d : MOV EAX,FS:[0x0]
00802ba3 : PUSH EAX
00802ba4 : SUB ESP,0x38
00802ba7 : MOV EAX,[0x00d66fa0]
00802bac : XOR EAX,ESP
00802bae : MOV dword ptr [ESP + 0x30],EAX
00802bb2 : PUSH EBX
00802bb3 : PUSH ESI
00802bb4 : PUSH EDI
00802bb5 : MOV EAX,[0x00d66fa0]
00802bba : XOR EAX,ESP
00802bbc : PUSH EAX
00802bbd : LEA EAX,[ESP + 0x48]
00802bc1 : MOV FS:[0x0],EAX
00802bc7 : MOV EBX,dword ptr [EBP + 0x8]
00802bca : MOV EAX,dword ptr [EBP + 0xc]
00802bcd : LEA EDI,[EBX + 0xb8]
00802bd3 : PUSH EDI
00802bd4 : MOV dword ptr [ESP + 0x14],EAX
00802bd8 : MOV dword ptr [ESP + 0x1c],EDI
00802bdc : CALL dword ptr [0x00b85118]
00802be2 : MOV dword ptr [ESP + 0x50],0x0
00802bea : CMP byte ptr [EBX + 0x94],0x0
00802bf1 : JNZ 0x00802c9b
00802bf7 : MOV ECX,dword ptr [EBX + 0x4c]
00802bfa : MOV EAX,dword ptr [ECX]
00802bfc : MOV dword ptr [ESP + 0x14],EAX
00802c00 : CMP EAX,ECX
00802c02 : JZ 0x00802c94
00802c08 : JMP 0x00802c10
00802c10 : MOV EDI,dword ptr [EAX + 0xc]
00802c13 : MOV EAX,dword ptr [EAX + 0x10]
00802c16 : MOV dword ptr [ESP + 0x1c],EAX
00802c1a : TEST EDI,EDI
00802c1c : JZ 0x00802c7c
00802c1e : TEST EAX,EAX
00802c20 : JZ 0x00802c7c
00802c22 : MOV ESI,dword ptr [EAX + 0x4]
00802c25 : CMP ESI,dword ptr [EAX + 0x8]
00802c28 : JZ 0x00802c7c
00802c2a : LEA EBX,[EBX]
00802c30 : SUB ESP,0x1c
00802c33 : MOV ECX,ESP
00802c35 : MOV dword ptr [ESP + 0x3c],ESP
00802c39 : XOR EDX,EDX
00802c3b : PUSH -0x1
00802c3d : PUSH EDX
00802c3e : MOV dword ptr [ECX + 0x18],0x7
00802c45 : MOV dword ptr [ECX + 0x14],0x0
00802c4c : PUSH ESI
00802c4d : MOV word ptr [ECX + 0x4],DX
00802c51 : CALL 0x00405eb0
00802c56 : MOV byte ptr [ESP + 0x6c],0x1
00802c5b : PUSH EDI
00802c5c : MOV byte ptr [ESP + 0x70],0x0
00802c61 : CALL 0x00a5fb10
00802c66 : PUSH ESI
00802c67 : PUSH EAX
00802c68 : PUSH EDI
00802c69 : MOV ECX,EBX
00802c6b : CALL 0x008022f0
00802c70 : MOV EAX,dword ptr [ESP + 0x1c]
00802c74 : ADD ESI,0x1c
00802c77 : CMP ESI,dword ptr [EAX + 0x8]
00802c7a : JNZ 0x00802c30
00802c7c : LEA EDX,[ESP + 0x14]
00802c80 : CALL 0x00416210
00802c85 : MOV ECX,dword ptr [EBX + 0x4c]
00802c88 : MOV EAX,dword ptr [ESP + 0x14]
00802c8c : CMP EAX,ECX
00802c8e : JNZ 0x00802c10
00802c90 : MOV EDI,dword ptr [ESP + 0x18]
00802c94 : MOV byte ptr [EBX + 0x94],0x1
00802c9b : MOV EDX,dword ptr [ESP + 0x10]
00802c9f : XOR ECX,ECX
00802ca1 : PUSH -0x1
00802ca3 : PUSH ECX
00802ca4 : MOV word ptr [ESP + 0x30],CX
00802ca9 : MOV ESI,0x7
00802cae : PUSH EDX
00802caf : LEA ECX,[ESP + 0x30]
00802cb3 : MOV dword ptr [ESP + 0x48],ESI
00802cb7 : MOV dword ptr [ESP + 0x44],0x0
00802cbf : CALL 0x00405eb0
00802cc4 : MOV byte ptr [ESP + 0x50],0x2
00802cc9 : LEA ECX,[ESP + 0x24]
00802ccd : CALL 0x0070c1f0
00802cd2 : LEA EAX,[ESP + 0x24]
00802cd6 : PUSH EAX
00802cd7 : LEA ECX,[ESP + 0x14]
00802cdb : PUSH ECX
00802cdc : LEA EDX,[EBX + 0x68]
00802cdf : PUSH EDX
00802ce0 : CALL 0x0044f270
00802ce5 : MOV EBX,dword ptr [EBX + 0x70]
00802ce8 : CMP dword ptr [ESP + 0x10],EBX
00802cec : JZ 0x00802d29
00802cee : MOV byte ptr [ESP + 0x50],0x0
00802cf3 : CMP dword ptr [ESP + 0x3c],0x8
00802cf8 : JC 0x00802d03
00802cfa : MOV ECX,dword ptr [ESP + 0x28]
00802cfe : CALL 0x006f04e0
00802d03 : XOR EAX,EAX
00802d05 : MOV dword ptr [ESP + 0x3c],ESI
00802d09 : MOV dword ptr [ESP + 0x38],0x0
00802d11 : MOV word ptr [ESP + 0x28],AX
00802d16 : MOV dword ptr [ESP + 0x50],0xffffffff
00802d1e : PUSH EDI
00802d1f : CALL dword ptr [0x00b8511c]
00802d25 : MOV AL,0x1
00802d27 : JMP 0x00802d62
00802d29 : MOV byte ptr [ESP + 0x50],0x0
00802d2e : CMP dword ptr [ESP + 0x3c],0x8
00802d33 : JC 0x00802d3e
00802d35 : MOV ECX,dword ptr [ESP + 0x28]
00802d39 : CALL 0x006f04e0
00802d3e : XOR ECX,ECX
00802d40 : MOV dword ptr [ESP + 0x3c],ESI
00802d44 : MOV dword ptr [ESP + 0x38],0x0
00802d4c : MOV word ptr [ESP + 0x28],CX
00802d51 : MOV dword ptr [ESP + 0x50],0xffffffff
00802d59 : PUSH EDI
00802d5a : CALL dword ptr [0x00b8511c]
00802d60 : XOR AL,AL
00802d62 : MOV ECX,dword ptr [ESP + 0x48]
00802d66 : MOV dword ptr FS:[0x0],ECX
00802d6d : POP ECX
00802d6e : POP EDI
00802d6f : POP ESI
00802d70 : POP EBX
00802d71 : MOV ECX,dword ptr [ESP + 0x30]
00802d75 : XOR ECX,ESP
00802d77 : CALL 0x00633e6b
00802d7c : MOV ESP,EBP
00802d7e : POP EBP
00802d7f : RET 0x8

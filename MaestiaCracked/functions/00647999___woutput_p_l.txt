PROGRAM  : Maestia.exe
FUNCTION : __woutput_p_l
ENTRY    : 00647999
BODY     : [[00647999, 00647c04] [00648373, 00648396] [00648b2e, 00648c01] [00648c11, 00648c38]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x00648b65) */
/* WARNING: Removing unreachable block (ram,0x00648b6e) */
/* WARNING: Removing unreachable block (ram,0x00648b78) */
/* WARNING: Removing unreachable block (ram,0x00648b84) */
/* WARNING: Removing unreachable block (ram,0x00648b8a) */
/* WARNING: Removing unreachable block (ram,0x00648b8d) */
/* WARNING: Removing unreachable block (ram,0x00648b90) */
/* WARNING: Removing unreachable block (ram,0x00648bb1) */
/* WARNING: Removing unreachable block (ram,0x00648b93) */
/* WARNING: Removing unreachable block (ram,0x00648bb8) */
/* WARNING: Removing unreachable block (ram,0x00648bbd) */
/* WARNING: Removing unreachable block (ram,0x00648b96) */
/* WARNING: Removing unreachable block (ram,0x00648b9a) */
/* WARNING: Removing unreachable block (ram,0x00648bc3) */
/* Library Function - Single Match
    __woutput_p_l
   
   Library: Visual Studio 2008 Release */

int __cdecl __woutput_p_l(FILE *_File,wchar_t *_Format,_locale_t _Locale,va_list _ArgList)

{
  int *piVar1;
  uint uVar2;
  long lVar3;
  int iVar4;
  wchar_t *_Str;
  undefined1 local_ad8 [1608];
  wchar_t *local_490;
  undefined4 local_474;
  undefined4 local_470;
  undefined4 local_46c;
  FILE *local_464;
  uint local_45c;
  undefined4 local_458;
  wchar_t *local_454;
  undefined4 local_450;
  int local_44c;
  undefined4 local_448;
  wchar_t *local_444;
  undefined4 local_440;
  undefined4 local_43c;
  uint local_438;
  _LocaleUpdate local_434 [8];
  int local_42c;
  char local_428;
  int local_424;
  int local_420;
  undefined4 local_418;
  undefined4 local_414;
  va_list local_410;
  undefined4 local_40c;
  uint local_8;
  
  local_8 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_464 = _File;
  local_410 = _ArgList;
  local_470 = 0;
  local_40c = 0;
  local_450 = 0;
  local_46c = 0;
  local_458 = 0;
  _LocaleUpdate::_LocaleUpdate(local_434,_Locale);
  local_418 = 0xffffffff;
  local_454 = (wchar_t *)0x0;
  if ((_File == (FILE *)0x0) || (_Format == (wchar_t *)0x0)) {
    piVar1 = __errno();
    *piVar1 = 0x16;
    __invalid_parameter(0,0,0,0,0);
LAB_00647a23:
    if (local_428 != '\0') {
      *(uint *)(local_42c + 0x70) = *(uint *)(local_42c + 0x70) & 0xfffffffd;
    }
  }
  else {
    local_440 = 0;
    local_490 = _Format;
    local_420 = 0;
    do {
      local_438 = (uint)(ushort)*_Format;
      local_44c = -1;
      local_424 = -1;
      local_418 = 0xffffffff;
      local_43c = 0;
      local_45c = 0;
      local_474 = 0;
      local_448 = 0;
      local_414 = 0;
      local_444 = local_490;
      if (*_Format != L'\0') {
        do {
          _Str = local_444 + 1;
          local_444 = _Str;
          if ((ushort)((short)local_438 - 0x20U) < 0x59) {
            uVar2 = (byte)(&DAT_00b9c078)[local_438] & 0xf;
          }
          else {
            uVar2 = 0;
          }
          uVar2 = (uint)((byte)(&DAT_00b9c098)[local_45c + uVar2 * 9] >> 4);
          local_45c = uVar2;
          if (uVar2 == 1) {
            if (*_Str != L'%') {
              lVar3 = _wcstol(_Str,&local_454,10);
              if ((lVar3 < 1) || (*local_454 != L'$')) {
                local_418 = 0;
              }
              else {
                if (local_420 == 0) {
                  _memset(local_ad8,0,0x640);
                }
                local_418 = 1;
                lVar3 = _wcstol(_Str,&local_454,10);
                local_424 = lVar3 + -1;
                local_444 = local_454 + 1;
                if (local_420 == 0) {
                  if (((local_424 < 0) || (*local_454 != L'$')) || (99 < local_424)) {
                    piVar1 = __errno();
                    *piVar1 = 0x16;
                    goto LAB_00648383;
                  }
                  if (local_44c < local_424) {
                    local_44c = local_424;
                  }
                }
              }
            }
LAB_00647be4:
                    /* WARNING: Could not recover jumptable at 0x00647bea. Too many branches */
                    /* WARNING: Treating indirect jump as call */
            iVar4 = (**(code **)(&DAT_00648c39 + uVar2 * 4))();
            return iVar4;
          }
          if (uVar2 == 8) goto LAB_00648beb;
          if (uVar2 < 8) goto LAB_00647be4;
          local_438 = (uint)(ushort)*_Str;
        } while (*_Str != L'\0');
        if ((uVar2 != 0) && (uVar2 != 7)) {
LAB_00648beb:
          piVar1 = __errno();
          *piVar1 = 0x16;
LAB_00648383:
          __invalid_parameter(0,0,0,0,0);
          goto LAB_00647a23;
        }
      }
      local_420 = local_420 + 1;
    } while (local_420 < 2);
    local_414 = 0;
    local_424 = -1;
    local_43c = 0;
    local_448 = 0;
    local_44c = -1;
    local_474 = 0;
    local_418 = 0xffffffff;
    if (local_428 != '\0') {
      *(uint *)(local_42c + 0x70) = *(uint *)(local_42c + 0x70) & 0xfffffffd;
    }
  }
  iVar4 = __security_check_cookie(local_8 ^ (uint)&stack0xfffffffc);
  return iVar4;
}



============================================================
DISASSEMBLY
============================================================
00647999 : MOV EDI,EDI
0064799b : PUSH EBP
0064799c : MOV EBP,ESP
0064799e : SUB ESP,0xad4
006479a4 : MOV EAX,[0x00d66fa0]
006479a9 : XOR EAX,EBP
006479ab : MOV dword ptr [EBP + -0x4],EAX
006479ae : MOV EAX,dword ptr [EBP + 0x14]
006479b1 : PUSH EBX
006479b2 : PUSH ESI
006479b3 : MOV ESI,dword ptr [EBP + 0xc]
006479b6 : PUSH EDI
006479b7 : MOV EDI,dword ptr [EBP + 0x8]
006479ba : PUSH dword ptr [EBP + 0x10]
006479bd : XOR EBX,EBX
006479bf : LEA ECX,[EBP + 0xfffffbd0]
006479c5 : MOV dword ptr [EBP + 0xfffffba0],EDI
006479cb : MOV dword ptr [EBP + 0xfffffbf4],EAX
006479d1 : MOV dword ptr [EBP + 0xfffffb94],EBX
006479d7 : MOV dword ptr [EBP + 0xfffffbf8],EBX
006479dd : MOV dword ptr [EBP + 0xfffffbb4],EBX
006479e3 : MOV dword ptr [EBP + 0xfffffb98],EBX
006479e9 : MOV dword ptr [EBP + 0xfffffbac],EBX
006479ef : CALL 0x00637880
006479f4 : OR dword ptr [EBP + 0xfffffbec],0xffffffff
006479fb : MOV dword ptr [EBP + 0xfffffbb0],EBX
00647a01 : CMP EDI,EBX
00647a03 : JNZ 0x00647a37
00647a05 : CALL 0x0063ab82
00647a0a : PUSH EBX
00647a0b : PUSH EBX
00647a0c : PUSH EBX
00647a0d : PUSH EBX
00647a0e : PUSH EBX
00647a0f : MOV dword ptr [EAX],0x16
00647a15 : CALL 0x006372b8
00647a1a : ADD ESP,0x14
00647a1d : CMP byte ptr [EBP + 0xfffffbdc],BL
00647a23 : JZ 0x00647a2f
00647a25 : MOV EAX,dword ptr [EBP + 0xfffffbd8]
00647a2b : AND dword ptr [EAX + 0x70],0xfffffffd
00647a2f : OR EAX,0xffffffff
00647a32 : JMP 0x00648c2a
00647a37 : CMP ESI,EBX
00647a39 : JZ 0x00647a05
00647a3b : MOV dword ptr [EBP + 0xfffffbc4],EBX
00647a41 : MOV dword ptr [EBP + 0xfffffb74],ESI
00647a47 : MOV dword ptr [EBP + 0xfffffbe4],EBX
00647a4d : CMP dword ptr [EBP + 0xfffffbe4],0x1
00647a54 : JNZ 0x00647a62
00647a56 : CMP dword ptr [EBP + 0xfffffbec],EBX
00647a5c : JZ 0x00648c11
00647a62 : MOVZX EDX,word ptr [ESI]
00647a65 : OR dword ptr [EBP + 0xfffffbb8],0xffffffff
00647a6c : OR dword ptr [EBP + 0xfffffbe0],0xffffffff
00647a73 : OR dword ptr [EBP + 0xfffffbec],0xffffffff
00647a7a : MOV dword ptr [EBP + 0xfffffbc8],EBX
00647a80 : MOV dword ptr [EBP + 0xfffffba8],EBX
00647a86 : MOV dword ptr [EBP + 0xfffffb90],EBX
00647a8c : MOV dword ptr [EBP + 0xfffffbbc],EBX
00647a92 : MOV dword ptr [EBP + 0xfffffbf0],EBX
00647a98 : MOV dword ptr [EBP + 0xfffffbc0],ESI
00647a9e : MOV dword ptr [EBP + 0xfffffbcc],EDX
00647aa4 : CMP DX,BX
00647aa7 : JZ 0x00648bcf
00647aad : JMP 0x00647ab5
00647aaf : MOV EDX,dword ptr [EBP + 0xfffffbcc]
00647ab5 : PUSH 0x2
00647ab7 : POP EDI
00647ab8 : ADD ESI,EDI
00647aba : CMP dword ptr [EBP + 0xfffffbc4],0x0
00647ac1 : MOV dword ptr [EBP + 0xfffffbc0],ESI
00647ac7 : JL 0x00648b46
00647acd : LEA EAX,[EDX + -0x20]
00647ad0 : CMP AX,0x58
00647ad4 : JA 0x00647ae5
00647ad6 : MOVZX EAX,DX
00647ad9 : MOVZX EAX,byte ptr [EAX + 0xb9c078]
00647ae0 : AND EAX,0xf
00647ae3 : JMP 0x00647ae7
00647ae5 : XOR EAX,EAX
00647ae7 : MOV ECX,dword ptr [EBP + 0xfffffba8]
00647aed : IMUL EAX,EAX,0x9
00647af0 : MOVZX EBX,byte ptr [EAX + ECX*0x1 + 0xb9c098]
00647af8 : SHR EBX,0x4
00647afb : MOV dword ptr [EBP + 0xfffffba8],EBX
00647b01 : CMP EBX,0x1
00647b04 : JNZ 0x00647bf1
00647b0a : CMP word ptr [ESI],0x25
00647b0e : JZ 0x00647be4
00647b14 : CMP dword ptr [EBP + 0xfffffbec],-0x1
00647b1b : JNZ 0x00647b77
00647b1d : PUSH 0xa
00647b1f : LEA EAX,[EBP + 0xfffffbb0]
00647b25 : PUSH EAX
00647b26 : PUSH ESI
00647b27 : CALL 0x00637d84
00647b2c : ADD ESP,0xc
00647b2f : TEST EAX,EAX
00647b31 : JLE 0x00647b6a
00647b33 : MOV EAX,dword ptr [EBP + 0xfffffbb0]
00647b39 : CMP word ptr [EAX],0x24
00647b3d : JNZ 0x00647b6a
00647b3f : CMP dword ptr [EBP + 0xfffffbe4],0x0
00647b46 : JNZ 0x00647b5e
00647b48 : PUSH 0x640
00647b4d : LEA EAX,[EBP + 0xfffff52c]
00647b53 : PUSH 0x0
00647b55 : PUSH EAX
00647b56 : CALL 0x0063b700
00647b5b : ADD ESP,0xc
00647b5e : MOV dword ptr [EBP + 0xfffffbec],0x1
00647b68 : JMP 0x00647b80
00647b6a : AND dword ptr [EBP + 0xfffffbec],0x0
00647b71 : MOV EDX,dword ptr [EBP + 0xfffffbcc]
00647b77 : CMP dword ptr [EBP + 0xfffffbec],0x1
00647b7e : JNZ 0x00647be4
00647b80 : PUSH 0xa
00647b82 : LEA EAX,[EBP + 0xfffffbb0]
00647b88 : PUSH EAX
00647b89 : PUSH ESI
00647b8a : CALL 0x00637d84
00647b8f : MOV ECX,dword ptr [EBP + 0xfffffbb0]
00647b95 : ADD ESP,0xc
00647b98 : DEC EAX
00647b99 : CMP dword ptr [EBP + 0xfffffbe4],0x0
00647ba0 : LEA EDX,[ECX + 0x2]
00647ba3 : MOV dword ptr [EBP + 0xfffffbe0],EAX
00647ba9 : MOV dword ptr [EBP + 0xfffffbc0],EDX
00647baf : JNZ 0x00647bdc
00647bb1 : XOR ESI,ESI
00647bb3 : CMP EAX,ESI
00647bb5 : JL 0x00648373
00647bbb : CMP word ptr [ECX],0x24
00647bbf : JNZ 0x00648373
00647bc5 : CMP EAX,0x64
00647bc8 : JGE 0x00648373
00647bce : CMP EAX,dword ptr [EBP + 0xfffffbb8]
00647bd4 : JLE 0x00647bdc
00647bd6 : MOV dword ptr [EBP + 0xfffffbb8],EAX
00647bdc : MOV ESI,EDX
00647bde : MOV EDX,dword ptr [EBP + 0xfffffbcc]
00647be4 : MOV ECX,dword ptr [EBP + 0xfffffbe0]
00647bea : JMP dword ptr [EBX*0x4 + 0x648c39]
00647bf1 : CMP EBX,0x8
00647bf4 : JZ 0x00648beb
00647bfa : CMP EBX,0x7
00647bfd : JA 0x00648b2e
00647c03 : JMP 0x00647be4
00648373 : CALL 0x0063ab82
00648378 : PUSH ESI
00648379 : PUSH ESI
0064837a : PUSH ESI
0064837b : PUSH ESI
0064837c : PUSH ESI
0064837d : MOV dword ptr [EAX],0x16
00648383 : CALL 0x006372b8
00648388 : ADD ESP,0x14
0064838b : CMP byte ptr [EBP + 0xfffffbdc],0x0
00648392 : JMP 0x00647a23
00648b2e : MOV ESI,dword ptr [EBP + 0xfffffbc0]
00648b34 : MOVZX EAX,word ptr [ESI]
00648b37 : MOV dword ptr [EBP + 0xfffffbcc],EAX
00648b3d : TEST AX,AX
00648b40 : JNZ 0x00647aaf
00648b46 : CMP dword ptr [EBP + 0xfffffba8],0x0
00648b4d : JZ 0x00648b5c
00648b4f : CMP dword ptr [EBP + 0xfffffba8],0x7
00648b56 : JNZ 0x00648beb
00648b5c : CMP dword ptr [EBP + 0xfffffbec],0x1
00648b63 : JNZ 0x00648bcf
00648b65 : CMP dword ptr [EBP + 0xfffffbe4],0x0
00648b6c : JNZ 0x00648bcf
00648b6e : XOR EDI,EDI
00648b70 : CMP dword ptr [EBP + 0xfffffbb8],EDI
00648b76 : JL 0x00648bcf
00648b78 : MOV EAX,dword ptr [EBP + 0xfffffbf4]
00648b7e : LEA ESI,[EBP + 0xfffff530]
00648b84 : MOV ECX,dword ptr [ESI + -0x4]
00648b87 : DEC ECX
00648b88 : JZ 0x00648bb8
00648b8a : DEC ECX
00648b8b : JZ 0x00648bb8
00648b8d : DEC ECX
00648b8e : JZ 0x00648bb1
00648b90 : DEC ECX
00648b91 : JZ 0x00648bb1
00648b93 : DEC ECX
00648b94 : JZ 0x00648bb8
00648b96 : DEC ECX
00648b97 : DEC ECX
00648b98 : JNZ 0x00648beb
00648b9a : MOV dword ptr [ESI],EAX
00648b9c : LEA EAX,[EBP + 0xfffffbf4]
00648ba2 : PUSH EAX
00648ba3 : CALL 0x0064c16e
00648ba8 : MOV EAX,dword ptr [EBP + 0xfffffbf4]
00648bae : POP ECX
00648baf : JMP 0x00648bc3
00648bb1 : MOV dword ptr [ESI],EAX
00648bb3 : ADD EAX,0x8
00648bb6 : JMP 0x00648bbd
00648bb8 : MOV dword ptr [ESI],EAX
00648bba : ADD EAX,0x4
00648bbd : MOV dword ptr [EBP + 0xfffffbf4],EAX
00648bc3 : INC EDI
00648bc4 : ADD ESI,0x10
00648bc7 : CMP EDI,dword ptr [EBP + 0xfffffbb8]
00648bcd : JLE 0x00648b84
00648bcf : INC dword ptr [EBP + 0xfffffbe4]
00648bd5 : CMP dword ptr [EBP + 0xfffffbe4],0x2
00648bdc : JGE 0x00648c11
00648bde : MOV ESI,dword ptr [EBP + 0xfffffb74]
00648be4 : XOR EBX,EBX
00648be6 : JMP 0x00647a4d
00648beb : CALL 0x0063ab82
00648bf0 : MOV dword ptr [EAX],0x16
00648bf6 : XOR EAX,EAX
00648bf8 : PUSH EAX
00648bf9 : PUSH EAX
00648bfa : PUSH EAX
00648bfb : PUSH EAX
00648bfc : PUSH EAX
00648bfd : JMP 0x00648383
00648c11 : CMP byte ptr [EBP + 0xfffffbdc],0x0
00648c18 : JZ 0x00648c24
00648c1a : MOV EAX,dword ptr [EBP + 0xfffffbd8]
00648c20 : AND dword ptr [EAX + 0x70],0xfffffffd
00648c24 : MOV EAX,dword ptr [EBP + 0xfffffbc4]
00648c2a : MOV ECX,dword ptr [EBP + -0x4]
00648c2d : POP EDI
00648c2e : POP ESI
00648c2f : XOR ECX,EBP
00648c31 : POP EBX
00648c32 : CALL 0x00633e6b
00648c37 : LEAVE
00648c38 : RET

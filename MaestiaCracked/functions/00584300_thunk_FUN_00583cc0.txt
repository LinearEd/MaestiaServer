PROGRAM  : Maestia.exe
FUNCTION : thunk_FUN_00583cc0
ENTRY    : 00584300
BODY     : [[00584300, 00584304]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 thunk_FUN_00583cc0(int param_1,uint *param_2)

{
  byte bVar1;
  undefined4 uVar2;
  bool bVar3;
  char cVar4;
  GRefCountImpl *pGVar5;
  uint *puVar6;
  byte *pbVar7;
  int iVar8;
  LONG LVar9;
  GRefCountImpl *this;
  byte *pbVar10;
  uint uVar11;
  int *piVar12;
  int iVar13;
  bool bVar14;
  undefined1 *puVar15;
  undefined4 uStack_14;
  uint uStack_c;
  int *piStack_8;
  undefined4 uStack_4;
  
  uStack_14 = 0;
  pGVar5 = (GRefCountImpl *)(**(code **)(**(int **)(param_1 + 0x74) + 0x48))();
  if (pGVar5 == (GRefCountImpl *)0x0) {
    return 0;
  }
  GRefCountImpl::AddRef(pGVar5);
  cVar4 = *(char *)((*param_2 & 0xfffffffc) + 8);
  iVar13 = (*param_2 & 0xfffffffc) + 8;
  bVar3 = false;
  if ((cVar4 == 'i') || (cVar4 == 'I')) {
    FUN_0051c8c0(&uStack_c);
    puVar6 = (uint *)FUN_0051c730(&piStack_8,0,6);
    pbVar7 = (byte *)((*puVar6 & 0xfffffffc) + 8);
    pbVar10 = &DAT_00b86600;
    do {
      bVar1 = *pbVar7;
      bVar14 = bVar1 < *pbVar10;
      if (bVar1 != *pbVar10) {
LAB_00583d60:
        iVar8 = (1 - (uint)bVar14) - (uint)(bVar14 != 0);
        goto LAB_00583d65;
      }
      if (bVar1 == 0) break;
      bVar1 = pbVar7[1];
      bVar14 = bVar1 < pbVar10[1];
      if (bVar1 != pbVar10[1]) goto LAB_00583d60;
      pbVar7 = pbVar7 + 2;
      pbVar10 = pbVar10 + 2;
    } while (bVar1 != 0);
    iVar8 = 0;
LAB_00583d65:
    uVar11 = (uint)piStack_8 & 0xfffffffc;
    LVar9 = InterlockedExchangeAdd((LONG *)(uVar11 + 4),-1);
    if (LVar9 == 1) {
      FUN_00515cf0(uVar11);
    }
    if (iVar8 == 0) {
LAB_00583dc6:
      bVar3 = true;
    }
    else {
      puVar15 = &DAT_00b865f4;
      FUN_0051c730(&piStack_8,0,8);
      cVar4 = FUN_004ffbc0(puVar15);
      uVar11 = (uint)piStack_8 & 0xfffffffc;
      LVar9 = InterlockedExchangeAdd((LONG *)(uVar11 + 4),-1);
      if (LVar9 == 1) {
        FUN_00515cf0(uVar11);
      }
      if (cVar4 != '\0') goto LAB_00583dc6;
    }
    uVar11 = uStack_c & 0xfffffffc;
    LVar9 = InterlockedExchangeAdd((LONG *)(uVar11 + 4),-1);
    if (LVar9 == 1) {
      FUN_00515cf0(uVar11);
    }
    if (!bVar3) goto LAB_00583ed4;
    iVar8 = FUN_005296a0();
    if (*(int *)(iVar8 + 0x100) == 0) {
      piVar12 = (int *)0x0;
    }
    else {
      piVar12 = (int *)(*(int *)(iVar8 + 0x100) + 8);
    }
    uVar2 = *(undefined4 *)(*(int *)(param_1 + 0x78) + 0x288);
    pGVar5 = (GRefCountImpl *)(**(code **)(*piVar12 + 0xc))(4);
    this = (GRefCountImpl *)(**(code **)(*piVar12 + 0xc))(5);
    uStack_c = FUN_00513f20(iVar13,this,pGVar5,uVar2);
    if (this != (GRefCountImpl *)0x0) {
      GRefCountImpl::Release(this);
    }
    if (pGVar5 != (GRefCountImpl *)0x0) {
      GRefCountImpl::Release(pGVar5);
    }
    if (uStack_c == 0) {
      FUN_0052e570(param_1,
                   "GASBitmapData::LoadBitmap: LoadMovieImageCallback failed to load image \"%s\"\n"
                   ,iVar13);
      FUN_00524240();
      return 0;
    }
    iVar13 = FUN_00515840(0x38,0);
    if (iVar13 == 0) {
      uStack_14 = 0;
    }
    else {
      uStack_14 = FUN_00583780(param_1);
    }
    FUN_00583a00(param_1,uStack_c,0);
  }
  else {
LAB_00583ed4:
    piStack_8 = (int *)0x0;
    uStack_4 = 0;
    FUN_0051c480((*param_2 & 0xfffffffc) + 8);
    cVar4 = FUN_005649d0(&piStack_8,&uStack_c);
    uVar11 = uStack_c & 0xfffffffc;
    LVar9 = InterlockedExchangeAdd((LONG *)(uVar11 + 4),-1);
    if (LVar9 == 1) {
      FUN_00515cf0(uVar11);
    }
    if (cVar4 == '\0') {
      if (piStack_8 != (int *)0x0) {
        FUN_00524240();
      }
      FUN_00524240();
      return 0;
    }
    uVar11 = (**(code **)(*piStack_8 + 8))();
    piVar12 = piStack_8;
    if ((uVar11 & 0xff00) != 0x100) {
      if (piStack_8 != (int *)0x0) {
        FUN_00524240();
      }
      FUN_00524240();
      return 0;
    }
    if (piStack_8 == (int *)0x0) goto LAB_00583fcc;
    iVar13 = FUN_00515840(0x38,0);
    if (iVar13 == 0) {
      uStack_14 = 0;
    }
    else {
      uStack_14 = FUN_00583780(param_1);
    }
    FUN_00583a00(param_1,piVar12,pGVar5);
    if (piStack_8 == (int *)0x0) goto LAB_00583fcc;
  }
  FUN_00524240();
LAB_00583fcc:
  FUN_00524240();
  return uStack_14;
}



============================================================
DISASSEMBLY
============================================================
00584300 : JMP 0x00583cc0

PROGRAM  : Maestia.exe
FUNCTION : FUN_00696e70
ENTRY    : 00696e70
BODY     : [[00696e70, 00697115]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00696e70(int param_1,int param_2,int param_3,int param_4,int param_5,int param_6,int param_7
                ,int param_8,byte *param_9,int param_10)

{
  uint *puVar1;
  undefined4 uVar2;
  byte *pbVar3;
  undefined1 uVar4;
  ushort uVar5;
  undefined2 uVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  uint uVar10;
  char *pcVar11;
  undefined1 *puVar12;
  uint local_18;
  undefined4 local_10;
  undefined4 local_c;
  undefined1 local_8 [8];
  
  iVar8 = param_8;
  uVar2 = *(undefined4 *)(param_8 + 0x1c);
  puVar1 = (uint *)(param_5 + 0x4c);
  param_8 = FUN_006877c0(param_8,param_3 + param_4);
  pbVar3 = param_9;
  if (param_8 != 0) {
    return param_8;
  }
  iVar7 = FUN_00696ab0(iVar8,param_2,param_9);
  if (iVar7 != 0) {
    return iVar7;
  }
  param_8 = 0;
  if (param_10 != 0) goto LAB_00696f56;
  *(uint *)(param_5 + 0x50) = (uint)pbVar3[1];
  *puVar1 = (uint)*pbVar3;
  switch(*(undefined1 *)(param_1 + 0x2e)) {
  case 1:
    *(undefined1 *)(param_5 + 0x5e) = 1;
    *(int *)(param_5 + 0x54) = *(int *)(param_5 + 0x50) + 7 >> 3;
    break;
  case 2:
    *(undefined1 *)(param_5 + 0x5e) = 3;
    iVar9 = *(int *)(param_5 + 0x50) + 3 >> 2;
    goto LAB_00696f2f;
  default:
    goto switchD_00696ef1_caseD_3;
  case 4:
    *(undefined1 *)(param_5 + 0x5e) = 4;
    *(int *)(param_5 + 0x54) = *(int *)(param_5 + 0x50) + 1 >> 1;
    break;
  case 8:
    iVar9 = *(int *)(param_5 + 0x50);
    *(undefined1 *)(param_5 + 0x5e) = 2;
LAB_00696f2f:
    *(int *)(param_5 + 0x54) = iVar9;
  }
  iVar9 = *puVar1 * *(int *)(param_5 + 0x54);
  if ((iVar9 != 0) && (param_8 = iVar7, param_8 = FUN_00688ef0(param_5,iVar9), param_8 == 0)) {
LAB_00696f56:
    switch(*(undefined2 *)(param_2 + 6)) {
    case 1:
    case 2:
    case 5:
    case 6:
    case 7:
      iVar8 = FUN_00696d40(puVar1,param_6,param_7,*(undefined2 *)(param_2 + 6),iVar8);
      return iVar8;
    default:
switchD_00696ef1_caseD_3:
      param_8 = 3;
      break;
    case 8:
      FUN_00687800(iVar8,1);
    case 9:
      uVar5 = FUN_00687a80(iVar8,&param_8);
      local_18 = (uint)uVar5;
      if ((param_8 == 0) && (iVar7 = FUN_0068a220(uVar2,4,0,local_18,0,&param_8), param_8 == 0)) {
        param_8 = FUN_00688900(iVar8,local_18 * 4);
        if (param_8 == 0) {
          if (uVar5 != 0) {
            puVar12 = (undefined1 *)(iVar7 + 3);
            uVar10 = local_18;
            do {
              uVar6 = FUN_00687940(iVar8);
              *(undefined2 *)(puVar12 + -3) = uVar6;
              uVar4 = FUN_00687920(iVar8);
              puVar12[-1] = uVar4;
              uVar4 = FUN_00687920(iVar8);
              *puVar12 = uVar4;
              uVar10 = uVar10 + 0xffff;
              puVar12 = puVar12 + 4;
            } while ((short)uVar10 != 0);
          }
          FUN_006889b0(iVar8);
          if (uVar5 != 0) {
            pcVar11 = (char *)(iVar7 + 2);
            iVar9 = param_8;
            do {
              param_8 = iVar9;
              param_8 = FUN_00696910(&local_c,&local_10);
              if ((param_8 != 0) ||
                 (param_8 = FUN_00696e70(param_1,local_c,param_3,local_10,param_5,*pcVar11 + param_6
                                         ,pcVar11[1] + param_7,iVar8,local_8,param_10 + 1),
                 param_8 != 0)) break;
              local_18 = local_18 + 0xffff;
              pcVar11 = pcVar11 + 4;
              iVar9 = 0;
            } while ((short)local_18 != 0);
          }
        }
        FUN_00687f30(uVar2,iVar7);
        return param_8;
      }
    }
  }
  return param_8;
}



============================================================
DISASSEMBLY
============================================================
00696e70 : SUB ESP,0x18
00696e73 : MOV ECX,dword ptr [ESP + 0x28]
00696e77 : MOV EDX,dword ptr [ESP + 0x24]
00696e7b : PUSH EBX
00696e7c : MOV EBX,dword ptr [ESP + 0x30]
00696e80 : PUSH EBP
00696e81 : PUSH ESI
00696e82 : MOV ESI,dword ptr [ESP + 0x44]
00696e86 : MOV EAX,dword ptr [ESI + 0x1c]
00696e89 : PUSH EDI
00696e8a : ADD EDX,ECX
00696e8c : PUSH EDX
00696e8d : PUSH ESI
00696e8e : MOV dword ptr [ESP + 0x1c],EAX
00696e92 : LEA EDI,[EBX + 0x4c]
00696e95 : CALL 0x006877c0
00696e9a : ADD ESP,0x8
00696e9d : MOV dword ptr [ESP + 0x48],EAX
00696ea1 : TEST EAX,EAX
00696ea3 : JNZ 0x0069710e
00696ea9 : MOV EBP,dword ptr [ESP + 0x4c]
00696ead : MOV EAX,dword ptr [ESP + 0x30]
00696eb1 : PUSH EBP
00696eb2 : PUSH EAX
00696eb3 : PUSH ESI
00696eb4 : CALL 0x00696ab0
00696eb9 : ADD ESP,0xc
00696ebc : MOV dword ptr [ESP + 0x48],EAX
00696ec0 : TEST EAX,EAX
00696ec2 : JNZ 0x0069710e
00696ec8 : CMP dword ptr [ESP + 0x50],EAX
00696ecc : JNZ 0x00696f56
00696ed2 : MOVZX ECX,byte ptr [EBP + 0x1]
00696ed6 : MOV dword ptr [EDI + 0x4],ECX
00696ed9 : MOVZX EDX,byte ptr [EBP]
00696edd : MOV ECX,dword ptr [ESP + 0x2c]
00696ee1 : MOV dword ptr [EDI],EDX
00696ee3 : MOVZX ECX,byte ptr [ECX + 0x2e]
00696ee7 : DEC ECX
00696ee8 : CMP ECX,0x7
00696eeb : JA 0x00697109
00696ef1 : JMP dword ptr [ECX*0x4 + 0x697118]
00696ef8 : MOV EDX,dword ptr [EDI + 0x4]
00696efb : ADD EDX,0x7
00696efe : SAR EDX,0x3
00696f01 : MOV byte ptr [EDI + 0x12],0x1
00696f05 : MOV dword ptr [EDI + 0x8],EDX
00696f08 : JMP 0x00696f32
00696f0a : MOV ECX,dword ptr [EDI + 0x4]
00696f0d : ADD ECX,0x3
00696f10 : MOV byte ptr [EDI + 0x12],0x3
00696f14 : SAR ECX,0x2
00696f17 : JMP 0x00696f2f
00696f19 : MOV EDX,dword ptr [EDI + 0x4]
00696f1c : INC EDX
00696f1d : SAR EDX,0x1
00696f1f : MOV byte ptr [EDI + 0x12],0x4
00696f23 : MOV dword ptr [EDI + 0x8],EDX
00696f26 : JMP 0x00696f32
00696f28 : MOV ECX,dword ptr [EDI + 0x4]
00696f2b : MOV byte ptr [EDI + 0x12],0x2
00696f2f : MOV dword ptr [EDI + 0x8],ECX
00696f32 : MOV ECX,dword ptr [EDI]
00696f34 : IMUL ECX,dword ptr [EDI + 0x8]
00696f38 : TEST ECX,ECX
00696f3a : JZ 0x0069710e
00696f40 : PUSH ECX
00696f41 : PUSH EBX
00696f42 : CALL 0x00688ef0
00696f47 : ADD ESP,0x8
00696f4a : MOV dword ptr [ESP + 0x48],EAX
00696f4e : TEST EAX,EAX
00696f50 : JNZ 0x0069710e
00696f56 : MOV EDX,dword ptr [ESP + 0x30]
00696f5a : MOVZX EAX,word ptr [EDX + 0x6]
00696f5e : MOVZX ECX,AX
00696f61 : DEC ECX
00696f62 : CMP ECX,0x8
00696f65 : JA 0x00697109
00696f6b : MOVZX ECX,byte ptr [ECX + 0x697148]
00696f72 : JMP dword ptr [ECX*0x4 + 0x697138]
00696f79 : MOV EDX,dword ptr [ESP + 0x2c]
00696f7d : MOV ECX,dword ptr [ESP + 0x40]
00696f81 : MOVZX EBX,byte ptr [EDX + 0x2e]
00696f85 : PUSH ESI
00696f86 : PUSH EAX
00696f87 : MOV EAX,dword ptr [ESP + 0x4c]
00696f8b : PUSH EAX
00696f8c : PUSH ECX
00696f8d : PUSH EDI
00696f8e : MOV EAX,EBP
00696f90 : CALL 0x00696d40
00696f95 : ADD ESP,0x14
00696f98 : POP EDI
00696f99 : POP ESI
00696f9a : POP EBP
00696f9b : POP EBX
00696f9c : ADD ESP,0x18
00696f9f : RET
00696fa0 : PUSH 0x1
00696fa2 : PUSH ESI
00696fa3 : CALL 0x00687800
00696fa8 : ADD ESP,0x8
00696fab : LEA EDX,[ESP + 0x48]
00696faf : PUSH EDX
00696fb0 : PUSH ESI
00696fb1 : CALL 0x00687a80
00696fb6 : MOVZX EBP,AX
00696fb9 : MOV EAX,dword ptr [ESP + 0x50]
00696fbd : ADD ESP,0x8
00696fc0 : TEST EAX,EAX
00696fc2 : JNZ 0x0069710e
00696fc8 : MOV ECX,dword ptr [ESP + 0x14]
00696fcc : LEA EAX,[ESP + 0x48]
00696fd0 : PUSH EAX
00696fd1 : PUSH 0x0
00696fd3 : MOVZX EDI,BP
00696fd6 : PUSH EDI
00696fd7 : PUSH 0x0
00696fd9 : PUSH 0x4
00696fdb : PUSH ECX
00696fdc : CALL 0x0068a220
00696fe1 : MOV dword ptr [ESP + 0x50],EAX
00696fe5 : MOV EAX,dword ptr [ESP + 0x60]
00696fe9 : ADD ESP,0x18
00696fec : TEST EAX,EAX
00696fee : JNZ 0x0069710e
00696ff4 : LEA EDX,[EDI*0x4 + 0x0]
00696ffb : PUSH EDX
00696ffc : PUSH ESI
00696ffd : MOVZX EBX,BP
00697000 : CALL 0x00688900
00697005 : ADD ESP,0x8
00697008 : MOV dword ptr [ESP + 0x48],EAX
0069700c : TEST EAX,EAX
0069700e : JNZ 0x006970eb
00697014 : TEST BP,BP
00697017 : JBE 0x0069704c
00697019 : MOV EDI,dword ptr [ESP + 0x38]
0069701d : ADD EDI,0x3
00697020 : PUSH ESI
00697021 : CALL 0x00687940
00697026 : PUSH ESI
00697027 : MOV word ptr [EDI + -0x3],AX
0069702b : CALL 0x00687920
00697030 : PUSH ESI
00697031 : MOV byte ptr [EDI + -0x1],AL
00697034 : CALL 0x00687920
00697039 : MOV byte ptr [EDI],AL
0069703b : ADD EBX,0xffff
00697041 : ADD ESP,0xc
00697044 : ADD EDI,0x4
00697047 : TEST BX,BX
0069704a : JA 0x00697020
0069704c : PUSH ESI
0069704d : CALL 0x006889b0
00697052 : MOVZX EAX,BP
00697055 : ADD ESP,0x4
00697058 : MOV dword ptr [ESP + 0x10],EAX
0069705c : TEST BP,BP
0069705f : JBE 0x006970eb
00697065 : MOV EBX,dword ptr [ESP + 0x38]
00697069 : ADD EBX,0x2
0069706c : LEA ESP,[ESP]
00697070 : MOVZX EDI,word ptr [EBX + -0x2]
00697074 : MOV EBP,dword ptr [ESP + 0x2c]
00697078 : LEA ECX,[ESP + 0x18]
0069707c : PUSH ECX
0069707d : LEA EDX,[ESP + 0x20]
00697081 : PUSH EDX
00697082 : MOV ECX,EBP
00697084 : CALL 0x00696910
00697089 : ADD ESP,0x8
0069708c : MOV dword ptr [ESP + 0x48],EAX
00697090 : TEST EAX,EAX
00697092 : JNZ 0x006970eb
00697094 : MOV EAX,dword ptr [ESP + 0x50]
00697098 : MOVSX EDX,byte ptr [EBX + 0x1]
0069709c : ADD EDX,dword ptr [ESP + 0x44]
006970a0 : INC EAX
006970a1 : PUSH EAX
006970a2 : MOVSX EAX,byte ptr [EBX]
006970a5 : ADD EAX,dword ptr [ESP + 0x44]
006970a9 : LEA ECX,[ESP + 0x24]
006970ad : PUSH ECX
006970ae : MOV ECX,dword ptr [ESP + 0x44]
006970b2 : PUSH ESI
006970b3 : PUSH EDX
006970b4 : MOV EDX,dword ptr [ESP + 0x28]
006970b8 : PUSH EAX
006970b9 : MOV EAX,dword ptr [ESP + 0x48]
006970bd : PUSH ECX
006970be : MOV ECX,dword ptr [ESP + 0x34]
006970c2 : PUSH EDX
006970c3 : PUSH EAX
006970c4 : PUSH ECX
006970c5 : PUSH EBP
006970c6 : CALL 0x00696e70
006970cb : ADD ESP,0x28
006970ce : MOV dword ptr [ESP + 0x48],EAX
006970d2 : TEST EAX,EAX
006970d4 : JNZ 0x006970eb
006970d6 : MOV EAX,dword ptr [ESP + 0x10]
006970da : ADD EAX,0xffff
006970df : ADD EBX,0x4
006970e2 : MOV dword ptr [ESP + 0x10],EAX
006970e6 : TEST AX,AX
006970e9 : JA 0x00697070
006970eb : MOV EDX,dword ptr [ESP + 0x38]
006970ef : MOV EAX,dword ptr [ESP + 0x14]
006970f3 : PUSH EDX
006970f4 : PUSH EAX
006970f5 : CALL 0x00687f30
006970fa : MOV EAX,dword ptr [ESP + 0x50]
006970fe : ADD ESP,0x8
00697101 : POP EDI
00697102 : POP ESI
00697103 : POP EBP
00697104 : POP EBX
00697105 : ADD ESP,0x18
00697108 : RET
00697109 : MOV EAX,0x3
0069710e : POP EDI
0069710f : POP ESI
00697110 : POP EBP
00697111 : POP EBX
00697112 : ADD ESP,0x18
00697115 : RET

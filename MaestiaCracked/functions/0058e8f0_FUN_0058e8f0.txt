PROGRAM  : Maestia.exe
FUNCTION : FUN_0058e8f0
ENTRY    : 0058e8f0
BODY     : [[0058e8f0, 0058ecd4]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0058e8f0(float param_1)

{
  float fVar1;
  int iVar2;
  uint uVar3;
  undefined1 uVar4;
  char cVar5;
  int iVar6;
  int *piVar7;
  uint uVar8;
  undefined2 in_FPUControlWord;
  float10 fVar9;
  undefined4 uVar10;
  float local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  int local_14;
  longlong local_10;
  uint local_8;
  float local_4;
  
  iVar2 = (int)param_1;
  if (*(int **)((int)param_1 + 8) == (int *)0x0) {
    local_14 = *(int *)(*(int *)((int)param_1 + 0x18) + 0x74);
  }
  else {
    iVar6 = (**(code **)(**(int **)((int)param_1 + 8) + 8))();
    if (iVar6 != 2) {
      return;
    }
    if (*(int *)(iVar2 + 8) == 0) {
      return;
    }
    local_14 = *(int *)(iVar2 + 8) + -0x68;
  }
  if (local_14 == 0) {
    return;
  }
  if (*(int *)(iVar2 + 0x1c) < 1) {
    FUN_0058dc10();
    return;
  }
  uVar10 = *(undefined4 *)(iVar2 + 0x18);
  FUN_00526260(0);
  fVar9 = (float10)FUN_00527730(uVar10);
  local_4 = (float)fVar9;
  local_24 = 3.0;
  uVar8 = 0xff000000;
  local_8 = local_8 & 0xffffff00;
  local_20 = 0;
  local_18 = 0;
  local_1c = 0;
  if (*(int *)(iVar2 + 0x1c) < 2) goto LAB_0058ec96;
  uVar10 = *(undefined4 *)(iVar2 + 0x18);
  FUN_00526260(1);
  fVar9 = (float10)FUN_00527730(uVar10);
  param_1 = (float)CONCAT22(param_1._2_2_,in_FPUControlWord);
  local_10 = (longlong)ROUND(fVar9);
  uVar3 = (uint)local_10;
  uVar8 = (uint)local_10 | 0xff000000;
  if (*(int *)(iVar2 + 0x1c) < 3) goto LAB_0058ec96;
  uVar10 = *(undefined4 *)(iVar2 + 0x18);
  FUN_00526260(2);
  fVar9 = (float10)FUN_00527730(uVar10);
  param_1 = ((float)fVar9 * 255.0) / 100.0;
  if (255.0 <= param_1) {
    param_1 = 255.0;
LAB_0058ea29:
    fVar1 = param_1;
  }
  else {
    fVar1 = 0.0;
    if (0.0 <= param_1) goto LAB_0058ea29;
  }
  param_1._2_2_ = (undefined2)((uint)fVar1 >> 0x10);
  param_1 = (float)CONCAT22(param_1._2_2_,in_FPUControlWord);
  local_10 = (longlong)ROUND(fVar1);
  uVar8 = uVar3 & 0xffffff | (uint)local_10 << 0x18;
  if (3 < *(int *)(iVar2 + 0x1c)) {
    uVar10 = *(undefined4 *)(iVar2 + 0x18);
    FUN_00526260(3);
    uVar4 = FUN_00526120(uVar10);
    local_8 = CONCAT31(local_8._1_3_,uVar4);
    if (4 < *(int *)(iVar2 + 0x1c)) {
      uVar10 = *(undefined4 *)(iVar2 + 0x18);
      FUN_00526260(4);
      FUN_005272e0(&param_1,uVar10,0xffffffff,0);
      cVar5 = FUN_004ffc90(&DAT_00b86670);
      if (cVar5 == '\0') {
        cVar5 = FUN_004ffc90("vertical");
        if (cVar5 == '\0') {
          cVar5 = FUN_004ffc90("horizontal");
          if (cVar5 != '\0') {
            local_20 = 2;
          }
        }
        else {
          local_20 = 4;
        }
      }
      else {
        local_20 = 6;
      }
      if (5 < *(int *)(iVar2 + 0x1c)) {
        uVar10 = *(undefined4 *)(iVar2 + 0x18);
        FUN_00526260(5);
        FUN_005272e0(&local_10,uVar10,0xffffffff,0);
        iVar6 = (uint)local_10;
        *(int *)((uint)local_10 + 8) = *(int *)((uint)local_10 + 8) + 1;
        *(int *)((int)param_1 + 8) = *(int *)((int)param_1 + 8) + -1;
        if (*(int *)((int)param_1 + 8) == 0) {
          FUN_00525340();
        }
        piVar7 = (int *)((uint)local_10 + 8);
        param_1 = (float)iVar6;
        *piVar7 = *piVar7 + -1;
        if (*piVar7 == 0) {
          FUN_00525340();
        }
        cVar5 = FUN_004ffc90(&DAT_00b86670);
        if (cVar5 == '\0') {
          cVar5 = FUN_004ffc90("square");
          if (cVar5 != '\0') {
            local_18 = 0x80;
          }
        }
        else {
          local_18 = 0x40;
        }
        if (6 < *(int *)(iVar2 + 0x1c)) {
          uVar10 = *(undefined4 *)(iVar2 + 0x18);
          FUN_00526260(6);
          FUN_005272e0(&local_10,uVar10,0xffffffff,0);
          iVar6 = (uint)local_10;
          *(int *)((uint)local_10 + 8) = *(int *)((uint)local_10 + 8) + 1;
          *(int *)((int)param_1 + 8) = *(int *)((int)param_1 + 8) + -1;
          if (*(int *)((int)param_1 + 8) == 0) {
            FUN_00525340();
          }
          piVar7 = (int *)((uint)local_10 + 8);
          param_1 = (float)iVar6;
          *piVar7 = *piVar7 + -1;
          if (*piVar7 == 0) {
            FUN_00525340();
          }
          cVar5 = FUN_004ffc90("miter");
          if (cVar5 == '\0') {
            cVar5 = FUN_004ffc90("bevel");
            if (cVar5 != '\0') {
              local_1c = 0x10;
            }
          }
          else {
            local_1c = 0x20;
          }
          if (7 < *(int *)(iVar2 + 0x1c)) {
            uVar10 = *(undefined4 *)(iVar2 + 0x18);
            FUN_00526260(7);
            fVar9 = (float10)FUN_00527730(uVar10);
            local_24 = (float)fVar9;
            if (local_24 < 1.0) {
              local_24 = 1.0;
            }
            if (255.0 < local_24) {
              local_24 = 255.0;
            }
          }
        }
      }
      *(int *)((int)param_1 + 8) = *(int *)((int)param_1 + 8) + -1;
      if (*(int *)((int)param_1 + 8) == 0) {
        FUN_00525340();
      }
    }
  }
LAB_0058ec96:
  FUN_0058dc80(local_4,uVar8,local_8,local_20,local_18,local_1c,local_24);
  return;
}



============================================================
DISASSEMBLY
============================================================
0058e8f0 : SUB ESP,0x24
0058e8f3 : PUSH ESI
0058e8f4 : MOV ESI,dword ptr [ESP + 0x2c]
0058e8f8 : MOV ECX,dword ptr [ESI + 0x8]
0058e8fb : PUSH EDI
0058e8fc : XOR EDI,EDI
0058e8fe : CMP ECX,EDI
0058e900 : JNZ 0x0058e90e
0058e902 : MOV EAX,dword ptr [ESI + 0x18]
0058e905 : MOV ECX,dword ptr [EAX + 0x74]
0058e908 : MOV dword ptr [ESP + 0x18],ECX
0058e90c : JMP 0x0058e930
0058e90e : MOV EDX,dword ptr [ECX]
0058e910 : MOV EAX,dword ptr [EDX + 0x8]
0058e913 : CALL EAX
0058e915 : CMP EAX,0x2
0058e918 : JNZ 0x0058ecc5
0058e91e : MOV EAX,dword ptr [ESI + 0x8]
0058e921 : CMP EAX,EDI
0058e923 : JZ 0x0058ecc5
0058e929 : ADD EAX,-0x68
0058e92c : MOV dword ptr [ESP + 0x18],EAX
0058e930 : MOV ECX,dword ptr [ESP + 0x18]
0058e934 : CMP ECX,EDI
0058e936 : JZ 0x0058ecc5
0058e93c : CMP dword ptr [ESI + 0x1c],EDI
0058e93f : JLE 0x0058eccb
0058e945 : MOV ECX,dword ptr [ESI + 0x18]
0058e948 : PUSH EBX
0058e949 : PUSH ECX
0058e94a : PUSH EDI
0058e94b : MOV ECX,ESI
0058e94d : CALL 0x00526260
0058e952 : MOV ECX,EAX
0058e954 : CALL 0x00527730
0058e959 : FSTP float ptr [ESP + 0x2c]
0058e95d : CMP dword ptr [ESI + 0x1c],0x1
0058e961 : FLD float ptr [0x00cdf19c]
0058e967 : FSTP float ptr [ESP + 0xc]
0058e96b : MOV EBX,0xff000000
0058e970 : MOV byte ptr [ESP + 0x28],0x0
0058e975 : MOV dword ptr [ESP + 0x10],EDI
0058e979 : MOV dword ptr [ESP + 0x18],EDI
0058e97d : MOV dword ptr [ESP + 0x14],EDI
0058e981 : JLE 0x0058ec96
0058e987 : MOV EDX,dword ptr [ESI + 0x18]
0058e98a : PUSH EDX
0058e98b : PUSH 0x1
0058e98d : MOV ECX,ESI
0058e98f : CALL 0x00526260
0058e994 : MOV ECX,EAX
0058e996 : CALL 0x00527730
0058e99b : FNSTCW word ptr [ESP + 0x34]
0058e99f : MOVZX EAX,word ptr [ESP + 0x34]
0058e9a4 : OR EAX,0xc00
0058e9a9 : MOV dword ptr [ESP + 0x20],EAX
0058e9ad : FLDCW word ptr [ESP + 0x20]
0058e9b1 : FISTP qword ptr [ESP + 0x20]
0058e9b5 : MOV EBX,dword ptr [ESP + 0x20]
0058e9b9 : OR EBX,0xff000000
0058e9bf : CMP dword ptr [ESI + 0x1c],0x2
0058e9c3 : FLDCW word ptr [ESP + 0x34]
0058e9c7 : JLE 0x0058ec96
0058e9cd : MOV EAX,dword ptr [ESI + 0x18]
0058e9d0 : PUSH EAX
0058e9d1 : PUSH 0x2
0058e9d3 : MOV ECX,ESI
0058e9d5 : CALL 0x00526260
0058e9da : MOV ECX,EAX
0058e9dc : CALL 0x00527730
0058e9e1 : FSTP float ptr [ESP + 0x34]
0058e9e5 : FLD float ptr [ESP + 0x34]
0058e9e9 : AND EBX,0xffffff
0058e9ef : FLD double ptr [0x00b86b48]
0058e9f5 : FMUL ST1
0058e9f7 : FXCH
0058e9f9 : FDIV double ptr [0x00cdf2a8]
0058e9ff : FSTP float ptr [ESP + 0x34]
0058ea03 : FLD float ptr [ESP + 0x34]
0058ea07 : FCOM
0058ea09 : FNSTSW AX
0058ea0b : FSTP ST1
0058ea0d : TEST AH,0x5
0058ea10 : JP 0x0058eac1
0058ea16 : FST float ptr [ESP + 0x34]
0058ea1a : FLDZ
0058ea1c : FCOM
0058ea1e : FNSTSW AX
0058ea20 : FSTP ST1
0058ea22 : TEST AH,0x41
0058ea25 : JZ 0x0058ea2d
0058ea27 : FSTP ST0
0058ea29 : FLD float ptr [ESP + 0x34]
0058ea2d : FSTP float ptr [ESP + 0x34]
0058ea31 : FLD float ptr [ESP + 0x34]
0058ea35 : FNSTCW word ptr [ESP + 0x34]
0058ea39 : MOVZX EAX,word ptr [ESP + 0x34]
0058ea3e : OR EAX,0xc00
0058ea43 : MOV dword ptr [ESP + 0x20],EAX
0058ea47 : FLDCW word ptr [ESP + 0x20]
0058ea4b : FISTP qword ptr [ESP + 0x20]
0058ea4f : MOV ECX,dword ptr [ESP + 0x20]
0058ea53 : SHL ECX,0x18
0058ea56 : OR EBX,ECX
0058ea58 : CMP dword ptr [ESI + 0x1c],0x3
0058ea5c : FLDCW word ptr [ESP + 0x34]
0058ea60 : JLE 0x0058ec96
0058ea66 : MOV EDX,dword ptr [ESI + 0x18]
0058ea69 : PUSH EDX
0058ea6a : PUSH 0x3
0058ea6c : MOV ECX,ESI
0058ea6e : CALL 0x00526260
0058ea73 : MOV ECX,EAX
0058ea75 : CALL 0x00526120
0058ea7a : CMP dword ptr [ESI + 0x1c],0x4
0058ea7e : MOV byte ptr [ESP + 0x28],AL
0058ea82 : JLE 0x0058ec96
0058ea88 : MOV EDI,dword ptr [ESI + 0x18]
0058ea8b : PUSH 0x4
0058ea8d : MOV ECX,ESI
0058ea8f : CALL 0x00526260
0058ea94 : PUSH 0x0
0058ea96 : PUSH -0x1
0058ea98 : PUSH EDI
0058ea99 : LEA ECX,[ESP + 0x40]
0058ea9d : PUSH ECX
0058ea9e : MOV ECX,EAX
0058eaa0 : CALL 0x005272e0
0058eaa5 : PUSH 0xb86670
0058eaaa : LEA ECX,[ESP + 0x38]
0058eaae : CALL 0x004ffc90
0058eab3 : TEST AL,AL
0058eab5 : JZ 0x0058ead2
0058eab7 : MOV dword ptr [ESP + 0x10],0x6
0058eabf : JMP 0x0058eb08
0058eac1 : FSTP ST0
0058eac3 : FLD float ptr [0x00cdf130]
0058eac9 : FSTP float ptr [ESP + 0x34]
0058eacd : JMP 0x0058ea29
0058ead2 : PUSH 0xb8e710
0058ead7 : LEA ECX,[ESP + 0x38]
0058eadb : CALL 0x004ffc90
0058eae0 : TEST AL,AL
0058eae2 : JZ 0x0058eaee
0058eae4 : MOV dword ptr [ESP + 0x10],0x4
0058eaec : JMP 0x0058eb08
0058eaee : PUSH 0xb8e704
0058eaf3 : LEA ECX,[ESP + 0x38]
0058eaf7 : CALL 0x004ffc90
0058eafc : TEST AL,AL
0058eafe : JZ 0x0058eb08
0058eb00 : MOV dword ptr [ESP + 0x10],0x2
0058eb08 : CMP dword ptr [ESI + 0x1c],0x5
0058eb0c : JLE 0x0058ec80
0058eb12 : MOV EDI,dword ptr [ESI + 0x18]
0058eb15 : PUSH 0x5
0058eb17 : MOV ECX,ESI
0058eb19 : CALL 0x00526260
0058eb1e : PUSH 0x0
0058eb20 : PUSH -0x1
0058eb22 : PUSH EDI
0058eb23 : LEA EDX,[ESP + 0x2c]
0058eb27 : PUSH EDX
0058eb28 : MOV ECX,EAX
0058eb2a : CALL 0x005272e0
0058eb2f : MOV EAX,dword ptr [ESP + 0x20]
0058eb33 : INC dword ptr [EAX + 0x8]
0058eb36 : MOV EDI,EAX
0058eb38 : MOV EAX,dword ptr [ESP + 0x34]
0058eb3c : DEC dword ptr [EAX + 0x8]
0058eb3f : MOV ECX,EAX
0058eb41 : ADD EAX,0x8
0058eb44 : CMP dword ptr [EAX],0x0
0058eb47 : JNZ 0x0058eb4e
0058eb49 : CALL 0x00525340
0058eb4e : MOV EAX,dword ptr [ESP + 0x20]
0058eb52 : MOV ECX,EAX
0058eb54 : ADD EAX,0x8
0058eb57 : MOV dword ptr [ESP + 0x34],EDI
0058eb5b : DEC dword ptr [EAX]
0058eb5d : CMP dword ptr [EAX],0x0
0058eb60 : JNZ 0x0058eb67
0058eb62 : CALL 0x00525340
0058eb67 : PUSH 0xb86670
0058eb6c : LEA ECX,[ESP + 0x38]
0058eb70 : CALL 0x004ffc90
0058eb75 : TEST AL,AL
0058eb77 : JZ 0x0058eb83
0058eb79 : MOV dword ptr [ESP + 0x18],0x40
0058eb81 : JMP 0x0058eb9d
0058eb83 : PUSH 0xb8e6fc
0058eb88 : LEA ECX,[ESP + 0x38]
0058eb8c : CALL 0x004ffc90
0058eb91 : TEST AL,AL
0058eb93 : JZ 0x0058eb9d
0058eb95 : MOV dword ptr [ESP + 0x18],0x80
0058eb9d : CMP dword ptr [ESI + 0x1c],0x6
0058eba1 : JLE 0x0058ec80
0058eba7 : MOV EDI,dword ptr [ESI + 0x18]
0058ebaa : PUSH 0x6
0058ebac : MOV ECX,ESI
0058ebae : CALL 0x00526260
0058ebb3 : PUSH 0x0
0058ebb5 : PUSH -0x1
0058ebb7 : PUSH EDI
0058ebb8 : LEA ECX,[ESP + 0x2c]
0058ebbc : PUSH ECX
0058ebbd : MOV ECX,EAX
0058ebbf : CALL 0x005272e0
0058ebc4 : MOV EAX,dword ptr [ESP + 0x20]
0058ebc8 : INC dword ptr [EAX + 0x8]
0058ebcb : MOV EDI,EAX
0058ebcd : MOV EAX,dword ptr [ESP + 0x34]
0058ebd1 : DEC dword ptr [EAX + 0x8]
0058ebd4 : MOV ECX,EAX
0058ebd6 : ADD EAX,0x8
0058ebd9 : CMP dword ptr [EAX],0x0
0058ebdc : JNZ 0x0058ebe3
0058ebde : CALL 0x00525340
0058ebe3 : MOV EAX,dword ptr [ESP + 0x20]
0058ebe7 : MOV ECX,EAX
0058ebe9 : ADD EAX,0x8
0058ebec : MOV dword ptr [ESP + 0x34],EDI
0058ebf0 : DEC dword ptr [EAX]
0058ebf2 : CMP dword ptr [EAX],0x0
0058ebf5 : JNZ 0x0058ebfc
0058ebf7 : CALL 0x00525340
0058ebfc : PUSH 0xb8e6f4
0058ec01 : LEA ECX,[ESP + 0x38]
0058ec05 : CALL 0x004ffc90
0058ec0a : TEST AL,AL
0058ec0c : JZ 0x0058ec18
0058ec0e : MOV dword ptr [ESP + 0x14],0x20
0058ec16 : JMP 0x0058ec32
0058ec18 : PUSH 0xb8e6ec
0058ec1d : LEA ECX,[ESP + 0x38]
0058ec21 : CALL 0x004ffc90
0058ec26 : TEST AL,AL
0058ec28 : JZ 0x0058ec32
0058ec2a : MOV dword ptr [ESP + 0x14],0x10
0058ec32 : CMP dword ptr [ESI + 0x1c],0x7
0058ec36 : JLE 0x0058ec80
0058ec38 : MOV EDX,dword ptr [ESI + 0x18]
0058ec3b : PUSH EDX
0058ec3c : PUSH 0x7
0058ec3e : MOV ECX,ESI
0058ec40 : CALL 0x00526260
0058ec45 : MOV ECX,EAX
0058ec47 : CALL 0x00527730
0058ec4c : FSTP float ptr [ESP + 0xc]
0058ec50 : FLD1
0058ec52 : FCOM float ptr [ESP + 0xc]
0058ec56 : FNSTSW AX
0058ec58 : TEST AH,0x41
0058ec5b : JNZ 0x0058ec63
0058ec5d : FSTP float ptr [ESP + 0xc]
0058ec61 : JMP 0x0058ec65
0058ec63 : FSTP ST0
0058ec65 : FLD float ptr [ESP + 0xc]
0058ec69 : FCOMP double ptr [0x00b86b48]
0058ec6f : FNSTSW AX
0058ec71 : TEST AH,0x41
0058ec74 : JNZ 0x0058ec80
0058ec76 : FLD float ptr [0x00cdf130]
0058ec7c : FSTP float ptr [ESP + 0xc]
0058ec80 : MOV EAX,dword ptr [ESP + 0x34]
0058ec84 : DEC dword ptr [EAX + 0x8]
0058ec87 : MOV ECX,EAX
0058ec89 : ADD EAX,0x8
0058ec8c : CMP dword ptr [EAX],0x0
0058ec8f : JNZ 0x0058ec96
0058ec91 : CALL 0x00525340
0058ec96 : FLD float ptr [ESP + 0xc]
0058ec9a : MOV EAX,dword ptr [ESP + 0x14]
0058ec9e : MOV EDX,dword ptr [ESP + 0x10]
0058eca2 : PUSH ECX
0058eca3 : MOV ECX,dword ptr [ESP + 0x1c]
0058eca7 : FSTP float ptr [ESP]
0058ecaa : FLD float ptr [ESP + 0x30]
0058ecae : PUSH EAX
0058ecaf : MOV EAX,dword ptr [ESP + 0x30]
0058ecb3 : PUSH ECX
0058ecb4 : PUSH EDX
0058ecb5 : PUSH EAX
0058ecb6 : PUSH EBX
0058ecb7 : PUSH ECX
0058ecb8 : MOV ECX,dword ptr [ESP + 0x38]
0058ecbc : FSTP float ptr [ESP]
0058ecbf : CALL 0x0058dc80
0058ecc4 : POP EBX
0058ecc5 : POP EDI
0058ecc6 : POP ESI
0058ecc7 : ADD ESP,0x24
0058ecca : RET
0058eccb : POP EDI
0058eccc : POP ESI
0058eccd : ADD ESP,0x24
0058ecd0 : JMP 0x0058dc10

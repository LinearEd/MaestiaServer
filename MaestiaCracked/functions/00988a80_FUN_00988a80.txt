PROGRAM  : Maestia.exe
FUNCTION : FUN_00988a80
ENTRY    : 00988a80
BODY     : [[00988a80, 00988dac] [00988db0, 00989079]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00988a80(int param_1,undefined4 param_2)

{
  wchar_t wVar1;
  int *piVar2;
  undefined1 uVar3;
  undefined2 uVar4;
  uint uVar5;
  undefined4 uVar6;
  int iVar7;
  uint8_t *packet;
  wchar_t *pwVar8;
  wchar_t *pwVar9;
  wchar_t *pwVar10;
  byte bVar11;
  bool bVar12;
  uint8_t *local_6c;
  int *local_68;
  undefined1 local_64 [4];
  int local_60;
  int local_5c;
  undefined4 local_58;
  undefined1 local_54 [4];
  undefined2 local_50;
  undefined4 local_40;
  uint local_3c;
  undefined1 local_38 [4];
  undefined2 local_34;
  undefined4 local_24;
  uint local_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b68efa;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)&local_6c;
  uVar5 = DAT_00d66fa0 ^ (uint)&stack0xffffff88;
  ExceptionList = &local_14;
  local_3c = 7;
  local_40 = 0;
  local_50 = 0;
  FUN_00406360(&DAT_00c8241c,1);
  local_c = 0;
  uVar6 = FUN_00404350(param_2,uVar5);
  local_c._0_1_ = 1;
  FUN_0070cd60(local_64,uVar6,local_54,0);
  local_c = CONCAT31(local_c._1_3_,3);
  if (7 < local_20) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_20 = 7;
  local_24 = 0;
  local_34 = 0;
  local_c._0_1_ = 4;
  uVar3 = (undefined1)local_c;
  local_c._0_1_ = 4;
  if (7 < local_3c) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_50 = 0;
  local_6c = *(uint8_t **)(param_1 + 0x18);
  local_3c = 7;
  local_40 = 0;
  pwVar8 = (wchar_t *)(param_1 + 4);
  pwVar10 = pwVar8;
  if (&DAT_00000008 <= local_6c) {
    pwVar10 = *(wchar_t **)pwVar8;
  }
  pwVar9 = L"OnInit";
  do {
    wVar1 = *pwVar10;
    bVar12 = (ushort)wVar1 < (ushort)*pwVar9;
    if (wVar1 != *pwVar9) {
LAB_00988b99:
      iVar7 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
      goto LAB_00988b9e;
    }
    if (wVar1 == L'\0') break;
    wVar1 = pwVar10[1];
    bVar12 = (ushort)wVar1 < (ushort)pwVar9[1];
    if (wVar1 != pwVar9[1]) goto LAB_00988b99;
    pwVar10 = pwVar10 + 2;
    pwVar9 = pwVar9 + 2;
  } while (wVar1 != L'\0');
  iVar7 = 0;
LAB_00988b9e:
  if (iVar7 != 0) {
    pwVar10 = pwVar8;
    if (&DAT_00000008 <= local_6c) {
      pwVar10 = *(wchar_t **)pwVar8;
    }
    pwVar9 = L"onClose";
    do {
      wVar1 = *pwVar10;
      bVar12 = (ushort)wVar1 < (ushort)*pwVar9;
      if (wVar1 != *pwVar9) {
LAB_00988bde:
        iVar7 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
        goto LAB_00988be3;
      }
      if (wVar1 == L'\0') break;
      wVar1 = pwVar10[1];
      bVar12 = (ushort)wVar1 < (ushort)pwVar9[1];
      if (wVar1 != pwVar9[1]) goto LAB_00988bde;
      pwVar10 = pwVar10 + 2;
      pwVar9 = pwVar9 + 2;
    } while (wVar1 != L'\0');
    iVar7 = 0;
LAB_00988be3:
    if (iVar7 == 0) {
      (**(code **)(*local_68 + 0x24))();
    }
    else {
      pwVar10 = pwVar8;
      if (&DAT_00000008 <= local_6c) {
        pwVar10 = *(wchar_t **)pwVar8;
      }
      pwVar9 = L"onOK";
      do {
        wVar1 = *pwVar10;
        bVar12 = (ushort)wVar1 < (ushort)*pwVar9;
        if (wVar1 != *pwVar9) {
LAB_00988c36:
          iVar7 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
          goto LAB_00988c3b;
        }
        if (wVar1 == L'\0') break;
        wVar1 = pwVar10[1];
        bVar12 = (ushort)wVar1 < (ushort)pwVar9[1];
        if (wVar1 != pwVar9[1]) goto LAB_00988c36;
        pwVar10 = pwVar10 + 2;
        pwVar9 = pwVar9 + 2;
      } while (wVar1 != L'\0');
      iVar7 = 0;
LAB_00988c3b:
      if (iVar7 == 0) {
        iVar7 = *(int *)ThreadLocalStoragePointer;
        bVar11 = (byte)((ulonglong)(*(byte *)(iVar7 + 0x18) + 1) % 3);
        *(byte *)(iVar7 + 0x18) = bVar11;
        local_6c = (uint8_t *)((uint)bVar11 * 0x2000 + 0x122cb8 + iVar7);
        if (local_6c == (uint8_t *)0x0) {
          packet = (uint8_t *)0x0;
        }
        else {
          local_6c[0] = '\0';
          local_6c[1] = '\0';
          local_6c[2] = '6';
          local_6c[3] = 0xf0;
          local_6c[4] = '\x02';
          local_6c[5] = 0xd0;
          local_6c[6] = '\a';
          local_6c[7] = '\0';
          local_6c[8] = '\0';
          packet = local_6c;
        }
        local_c = CONCAT31(local_c._1_3_,4);
        if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
          FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),9,packet);
        }
      }
      else {
        pwVar10 = pwVar8;
        if (&DAT_00000008 <= local_6c) {
          pwVar10 = *(wchar_t **)pwVar8;
        }
        pwVar9 = L"onTooltip";
        do {
          wVar1 = *pwVar10;
          bVar12 = (ushort)wVar1 < (ushort)*pwVar9;
          if (wVar1 != *pwVar9) {
LAB_00988cf6:
            iVar7 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
            goto LAB_00988cfb;
          }
          if (wVar1 == L'\0') break;
          wVar1 = pwVar10[1];
          bVar12 = (ushort)wVar1 < (ushort)pwVar9[1];
          if (wVar1 != pwVar9[1]) goto LAB_00988cf6;
          pwVar10 = pwVar10 + 2;
          pwVar9 = pwVar9 + 2;
        } while (wVar1 != L'\0');
        iVar7 = 0;
LAB_00988cfb:
        if (iVar7 == 0) {
          iVar7 = local_5c - local_60 >> 0x1f;
          if ((local_5c - local_60) / 0x1c + iVar7 == iVar7) {
            uVar4 = 0;
          }
          else if (*(uint *)(local_60 + 0x18) < 8) {
            uVar4 = FUN_00634f4d(local_60 + 4);
          }
          else {
            uVar4 = FUN_00634f4d(*(undefined4 *)(local_60 + 4));
          }
          local_20 = 7;
          local_24 = 0;
          local_34 = 0;
          local_c = CONCAT31(local_c._1_3_,6);
          iVar7 = (**(code **)(*local_68 + 0x74))(uVar4,0);
          if (iVar7 != 0) {
            FUN_008fc070(local_38,1,0);
          }
          local_c = CONCAT31(local_c._1_3_,4);
          FUN_00406560();
        }
        else {
          pwVar10 = pwVar8;
          if (&DAT_00000008 <= local_6c) {
            pwVar10 = *(wchar_t **)pwVar8;
          }
          pwVar9 = L"onLButtonDown";
          do {
            wVar1 = *pwVar10;
            bVar12 = (ushort)wVar1 < (ushort)*pwVar9;
            if (wVar1 != *pwVar9) {
LAB_00988dd6:
              iVar7 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
              goto LAB_00988ddb;
            }
            if (wVar1 == L'\0') break;
            wVar1 = pwVar10[1];
            bVar12 = (ushort)wVar1 < (ushort)pwVar9[1];
            if (wVar1 != pwVar9[1]) goto LAB_00988dd6;
            pwVar10 = pwVar10 + 2;
            pwVar9 = pwVar9 + 2;
          } while (wVar1 != L'\0');
          iVar7 = 0;
LAB_00988ddb:
          local_c._0_1_ = uVar3;
          if (iVar7 == 0) {
            if ((char)local_68[0x90] == '\0') {
              iVar7 = local_5c - local_60 >> 0x1f;
              uVar6 = 0;
              if ((local_5c - local_60) / 0x1c + iVar7 != iVar7) {
                if (*(uint *)(local_60 + 0x18) < 8) {
                  iVar7 = local_60 + 4;
                }
                else {
                  iVar7 = *(int *)(local_60 + 4);
                }
                uVar6 = FUN_00634f4d(iVar7);
              }
              FUN_00988940(local_68,uVar6);
            }
            else if (((DAT_0172491c != 0) && (*DAT_00da9894 != 0)) &&
                    (*(int *)(*DAT_00da9894 + 0x1a8) != 0)) {
              FUN_00406460(L"IDS_MAESTONE_GAMBLE_NOT_MOVE_MAESTONES");
              local_c._0_1_ = 7;
              piVar2 = *(int **)(*DAT_00da9894 + 0x1a8);
              uVar6 = FUN_0081d120(local_38);
              local_c._0_1_ = 8;
              (**(code **)(*piVar2 + 0x44))(uVar6,3);
              local_c._0_1_ = 7;
              FUN_00406560();
              local_c = CONCAT31(local_c._1_3_,4);
              FUN_00406560();
            }
          }
          else {
            pwVar10 = pwVar8;
            if (&DAT_00000008 <= local_6c) {
              pwVar10 = *(wchar_t **)pwVar8;
            }
            pwVar9 = L"onRButtonClick";
            do {
              wVar1 = *pwVar10;
              bVar12 = (ushort)wVar1 < (ushort)*pwVar9;
              if (wVar1 != *pwVar9) {
LAB_00988f06:
                iVar7 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
                goto LAB_00988f0b;
              }
              if (wVar1 == L'\0') break;
              wVar1 = pwVar10[1];
              bVar12 = (ushort)wVar1 < (ushort)pwVar9[1];
              if (wVar1 != pwVar9[1]) goto LAB_00988f06;
              pwVar10 = pwVar10 + 2;
              pwVar9 = pwVar9 + 2;
            } while (wVar1 != L'\0');
            iVar7 = 0;
LAB_00988f0b:
            if (iVar7 != 0) {
              if (&DAT_00000008 <= local_6c) {
                pwVar8 = *(wchar_t **)pwVar8;
              }
              pwVar10 = L"onLButtonDblClick";
              do {
                wVar1 = *pwVar8;
                bVar12 = (ushort)wVar1 < (ushort)*pwVar10;
                if (wVar1 != *pwVar10) {
LAB_00988f46:
                  iVar7 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
                  goto LAB_00988f4b;
                }
                if (wVar1 == L'\0') break;
                wVar1 = pwVar8[1];
                bVar12 = (ushort)wVar1 < (ushort)pwVar10[1];
                if (wVar1 != pwVar10[1]) goto LAB_00988f46;
                pwVar8 = pwVar8 + 2;
                pwVar10 = pwVar10 + 2;
              } while (wVar1 != L'\0');
              iVar7 = 0;
LAB_00988f4b:
              if (iVar7 != 0) goto LAB_00989024;
            }
            if ((char)local_68[0x90] == '\0') {
              iVar7 = local_5c - local_60 >> 0x1f;
              uVar6 = 0;
              if ((local_5c - local_60) / 0x1c + iVar7 != iVar7) {
                if (*(uint *)(local_60 + 0x18) < 8) {
                  iVar7 = local_60 + 4;
                }
                else {
                  iVar7 = *(int *)(local_60 + 4);
                }
                uVar6 = FUN_00634f4d(iVar7);
              }
              FUN_00988340(local_68,uVar6);
            }
            else if (((DAT_0172491c != 0) && (*DAT_00da9894 != 0)) &&
                    (*(int *)(*DAT_00da9894 + 0x1a8) != 0)) {
              FUN_00406460(L"IDS_MAESTONE_GAMBLE_NOT_MOVE_MAESTONES");
              local_c._0_1_ = 9;
              piVar2 = *(int **)(*DAT_00da9894 + 0x1a8);
              uVar6 = FUN_0081d120(local_38);
              local_c._0_1_ = 10;
              (**(code **)(*piVar2 + 0x44))(uVar6,3);
              local_c._0_1_ = 9;
              FUN_00406560();
              local_c = CONCAT31(local_c._1_3_,4);
              FUN_00406560();
            }
          }
        }
      }
    }
  }
LAB_00989024:
  local_c = 0xffffffff;
  if (local_60 == 0) {
    local_60 = 0;
    local_5c = 0;
    local_58 = 0;
    ExceptionList = local_14;
    __security_check_cookie(local_1c ^ (uint)&local_6c);
    return;
  }
  FUN_00405450(local_6c);
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
00988a80 : PUSH EBP
00988a81 : MOV EBP,ESP
00988a83 : AND ESP,0xfffffff8
00988a86 : PUSH -0x1
00988a88 : PUSH 0xb68efa
00988a8d : MOV EAX,FS:[0x0]
00988a93 : PUSH EAX
00988a94 : SUB ESP,0x58
00988a97 : MOV EAX,[0x00d66fa0]
00988a9c : XOR EAX,ESP
00988a9e : MOV dword ptr [ESP + 0x50],EAX
00988aa2 : PUSH EBX
00988aa3 : PUSH ESI
00988aa4 : PUSH EDI
00988aa5 : MOV EAX,[0x00d66fa0]
00988aaa : XOR EAX,ESP
00988aac : PUSH EAX
00988aad : LEA EAX,[ESP + 0x68]
00988ab1 : MOV FS:[0x0],EAX
00988ab7 : MOV ESI,dword ptr [EBP + 0xc]
00988aba : PUSH 0x1
00988abc : MOV dword ptr [ESP + 0x18],ECX
00988ac0 : XOR EAX,EAX
00988ac2 : MOV EDI,0x7
00988ac7 : XOR EBX,EBX
00988ac9 : PUSH 0xc8241c
00988ace : LEA ECX,[ESP + 0x30]
00988ad2 : MOV dword ptr [ESP + 0x48],EDI
00988ad6 : MOV dword ptr [ESP + 0x44],EBX
00988ada : MOV word ptr [ESP + 0x34],AX
00988adf : CALL 0x00406360
00988ae4 : MOV dword ptr [ESP + 0x70],EBX
00988ae8 : PUSH ESI
00988ae9 : LEA ESI,[ESP + 0x48]
00988aed : CALL 0x00404350
00988af2 : ADD ESP,0x4
00988af5 : MOV byte ptr [ESP + 0x70],0x1
00988afa : PUSH EBX
00988afb : LEA ECX,[ESP + 0x2c]
00988aff : PUSH ECX
00988b00 : PUSH EAX
00988b01 : LEA EDX,[ESP + 0x24]
00988b05 : PUSH EDX
00988b06 : CALL 0x0070cd60
00988b0b : ADD ESP,0x10
00988b0e : MOV byte ptr [ESP + 0x70],0x3
00988b13 : CMP dword ptr [ESP + 0x5c],0x8
00988b18 : JC 0x00988b23
00988b1a : MOV ECX,dword ptr [ESP + 0x48]
00988b1e : CALL 0x006f04e0
00988b23 : XOR EAX,EAX
00988b25 : MOV dword ptr [ESP + 0x5c],EDI
00988b29 : MOV dword ptr [ESP + 0x58],EBX
00988b2d : MOV word ptr [ESP + 0x48],AX
00988b32 : MOV byte ptr [ESP + 0x70],0x4
00988b37 : CMP dword ptr [ESP + 0x40],0x8
00988b3c : JC 0x00988b47
00988b3e : MOV ECX,dword ptr [ESP + 0x2c]
00988b42 : CALL 0x006f04e0
00988b47 : MOV EAX,dword ptr [EBP + 0x8]
00988b4a : XOR ECX,ECX
00988b4c : MOV word ptr [ESP + 0x2c],CX
00988b51 : MOV ECX,dword ptr [EAX + 0x18]
00988b54 : MOV dword ptr [ESP + 0x40],EDI
00988b58 : MOV dword ptr [ESP + 0x3c],EBX
00988b5c : MOV dword ptr [ESP + 0x10],ECX
00988b60 : LEA ESI,[EAX + 0x4]
00988b63 : CMP ECX,0x8
00988b66 : JC 0x00988b6c
00988b68 : MOV EAX,dword ptr [ESI]
00988b6a : JMP 0x00988b6e
00988b6c : MOV EAX,ESI
00988b6e : MOV ECX,0xc82420
00988b73 : MOV DX,word ptr [EAX]
00988b76 : CMP DX,word ptr [ECX]
00988b79 : JNZ 0x00988b99
00988b7b : CMP DX,BX
00988b7e : JZ 0x00988b95
00988b80 : MOV DX,word ptr [EAX + 0x2]
00988b84 : CMP DX,word ptr [ECX + 0x2]
00988b88 : JNZ 0x00988b99
00988b8a : ADD EAX,0x4
00988b8d : ADD ECX,0x4
00988b90 : CMP DX,BX
00988b93 : JNZ 0x00988b73
00988b95 : XOR EAX,EAX
00988b97 : JMP 0x00988b9e
00988b99 : SBB EAX,EAX
00988b9b : SBB EAX,-0x1
00988b9e : CMP EAX,EBX
00988ba0 : JZ 0x00989024
00988ba6 : CMP dword ptr [ESP + 0x10],0x8
00988bab : JC 0x00988bb1
00988bad : MOV EAX,dword ptr [ESI]
00988baf : JMP 0x00988bb3
00988bb1 : MOV EAX,ESI
00988bb3 : MOV ECX,0xc82430
00988bb8 : MOV DX,word ptr [EAX]
00988bbb : CMP DX,word ptr [ECX]
00988bbe : JNZ 0x00988bde
00988bc0 : CMP DX,BX
00988bc3 : JZ 0x00988bda
00988bc5 : MOV DX,word ptr [EAX + 0x2]
00988bc9 : CMP DX,word ptr [ECX + 0x2]
00988bcd : JNZ 0x00988bde
00988bcf : ADD EAX,0x4
00988bd2 : ADD ECX,0x4
00988bd5 : CMP DX,BX
00988bd8 : JNZ 0x00988bb8
00988bda : XOR EAX,EAX
00988bdc : JMP 0x00988be3
00988bde : SBB EAX,EAX
00988be0 : SBB EAX,-0x1
00988be3 : CMP EAX,EBX
00988be5 : JNZ 0x00988bf7
00988be7 : MOV ECX,dword ptr [ESP + 0x14]
00988beb : MOV EDX,dword ptr [ECX]
00988bed : MOV EAX,dword ptr [EDX + 0x24]
00988bf0 : CALL EAX
00988bf2 : JMP 0x00989024
00988bf7 : CMP dword ptr [ESP + 0x10],0x8
00988bfc : JC 0x00988c02
00988bfe : MOV EAX,dword ptr [ESI]
00988c00 : JMP 0x00988c04
00988c02 : MOV EAX,ESI
00988c04 : MOV ECX,0xc82440
00988c09 : LEA ESP,[ESP]
00988c10 : MOV DX,word ptr [EAX]
00988c13 : CMP DX,word ptr [ECX]
00988c16 : JNZ 0x00988c36
00988c18 : CMP DX,BX
00988c1b : JZ 0x00988c32
00988c1d : MOV DX,word ptr [EAX + 0x2]
00988c21 : CMP DX,word ptr [ECX + 0x2]
00988c25 : JNZ 0x00988c36
00988c27 : ADD EAX,0x4
00988c2a : ADD ECX,0x4
00988c2d : CMP DX,BX
00988c30 : JNZ 0x00988c10
00988c32 : XOR EAX,EAX
00988c34 : JMP 0x00988c3b
00988c36 : SBB EAX,EAX
00988c38 : SBB EAX,-0x1
00988c3b : CMP EAX,EBX
00988c3d : JNZ 0x00988cbd
00988c3f : MOV ECX,dword ptr FS:[0x2c]
00988c46 : MOV ECX,dword ptr [ECX]
00988c48 : MOVZX EAX,byte ptr [ECX + 0x18]
00988c4c : INC EAX
00988c4d : CDQ
00988c4e : MOV ESI,0x3
00988c53 : IDIV ESI
00988c55 : MOV byte ptr [ECX + 0x18],DL
00988c58 : MOVZX EDX,DL
00988c5b : SHL EDX,0xd
00988c5e : LEA EAX,[EDX + ECX*0x1 + 0x122cb8]
00988c65 : MOV dword ptr [ESP + 0x10],EAX
00988c69 : MOV byte ptr [ESP + 0x70],0x5
00988c6e : CMP EAX,EBX
00988c70 : JZ 0x00988c8c
00988c72 : XOR ECX,ECX
00988c74 : MOV word ptr [EAX],CX
00988c77 : MOV byte ptr [EAX + 0x2],0x36
00988c7b : MOV byte ptr [EAX + 0x3],0xf0
00988c7f : MOV byte ptr [EAX + 0x4],0x2
00988c83 : MOV dword ptr [EAX + 0x5],0x7d0
00988c8a : JMP 0x00988c8e
00988c8c : XOR EAX,EAX
00988c8e : MOV byte ptr [ESP + 0x70],0x4
00988c93 : MOV EDX,dword ptr [0x017247d4]
00988c99 : MOV ECX,dword ptr [EDX + 0x4]
00988c9c : CMP ECX,EBX
00988c9e : JZ 0x00989024
00988ca4 : CMP byte ptr [EDX + 0x8],0x0
00988ca8 : JZ 0x00989024
00988cae : PUSH 0x9
00988cb0 : PUSH ECX
00988cb1 : MOV EDI,EAX
00988cb3 : CALL 0x00a0dd40
00988cb8 : JMP 0x00989024
00988cbd : CMP dword ptr [ESP + 0x10],0x8
00988cc2 : JC 0x00988cc8
00988cc4 : MOV EAX,dword ptr [ESI]
00988cc6 : JMP 0x00988cca
00988cc8 : MOV EAX,ESI
00988cca : MOV ECX,0xc8244c
00988ccf : NOP
00988cd0 : MOV DX,word ptr [EAX]
00988cd3 : CMP DX,word ptr [ECX]
00988cd6 : JNZ 0x00988cf6
00988cd8 : CMP DX,BX
00988cdb : JZ 0x00988cf2
00988cdd : MOV DX,word ptr [EAX + 0x2]
00988ce1 : CMP DX,word ptr [ECX + 0x2]
00988ce5 : JNZ 0x00988cf6
00988ce7 : ADD EAX,0x4
00988cea : ADD ECX,0x4
00988ced : CMP DX,BX
00988cf0 : JNZ 0x00988cd0
00988cf2 : XOR EAX,EAX
00988cf4 : JMP 0x00988cfb
00988cf6 : SBB EAX,EAX
00988cf8 : SBB EAX,-0x1
00988cfb : CMP EAX,EBX
00988cfd : JNZ 0x00988d99
00988d03 : MOV ECX,dword ptr [ESP + 0x20]
00988d07 : MOV ESI,dword ptr [ESP + 0x1c]
00988d0b : SUB ECX,ESI
00988d0d : MOV EAX,0x92492493
00988d12 : IMUL ECX
00988d14 : ADD EDX,ECX
00988d16 : SAR EDX,0x4
00988d19 : MOV EAX,EDX
00988d1b : SHR EAX,0x1f
00988d1e : ADD EAX,EDX
00988d20 : JZ 0x00988d4a
00988d22 : CMP dword ptr [ESI + 0x18],0x8
00988d26 : JC 0x00988d39
00988d28 : MOV ESI,dword ptr [ESI + 0x4]
00988d2b : PUSH ESI
00988d2c : CALL 0x00634f4d
00988d31 : ADD ESP,0x4
00988d34 : MOVZX EAX,AX
00988d37 : JMP 0x00988d4c
00988d39 : ADD ESI,0x4
00988d3c : PUSH ESI
00988d3d : CALL 0x00634f4d
00988d42 : ADD ESP,0x4
00988d45 : MOVZX EAX,AX
00988d48 : JMP 0x00988d4c
00988d4a : XOR EAX,EAX
00988d4c : XOR ECX,ECX
00988d4e : MOV dword ptr [ESP + 0x5c],EDI
00988d52 : MOV dword ptr [ESP + 0x58],EBX
00988d56 : MOV word ptr [ESP + 0x48],CX
00988d5b : MOV byte ptr [ESP + 0x70],0x6
00988d60 : MOV ECX,dword ptr [ESP + 0x14]
00988d64 : MOV EDX,dword ptr [ECX]
00988d66 : PUSH EBX
00988d67 : PUSH EAX
00988d68 : MOV EAX,dword ptr [EDX + 0x74]
00988d6b : CALL EAX
00988d6d : CMP EAX,EBX
00988d6f : JZ 0x00988d86
00988d71 : PUSH EBX
00988d72 : PUSH 0x1
00988d74 : LEA ECX,[ESP + 0x4c]
00988d78 : PUSH ECX
00988d79 : MOV ECX,dword ptr [0x0172489c]
00988d7f : MOV EDX,EAX
00988d81 : CALL 0x008fc070
00988d86 : MOV byte ptr [ESP + 0x70],0x4
00988d8b : LEA ECX,[ESP + 0x44]
00988d8f : CALL 0x00406560
00988d94 : JMP 0x00989024
00988d99 : CMP dword ptr [ESP + 0x10],0x8
00988d9e : JC 0x00988da4
00988da0 : MOV EAX,dword ptr [ESI]
00988da2 : JMP 0x00988da6
00988da4 : MOV EAX,ESI
00988da6 : MOV ECX,0xc82460
00988dab : JMP 0x00988db0
00988db0 : MOV DX,word ptr [EAX]
00988db3 : CMP DX,word ptr [ECX]
00988db6 : JNZ 0x00988dd6
00988db8 : CMP DX,BX
00988dbb : JZ 0x00988dd2
00988dbd : MOV DX,word ptr [EAX + 0x2]
00988dc1 : CMP DX,word ptr [ECX + 0x2]
00988dc5 : JNZ 0x00988dd6
00988dc7 : ADD EAX,0x4
00988dca : ADD ECX,0x4
00988dcd : CMP DX,BX
00988dd0 : JNZ 0x00988db0
00988dd2 : XOR EAX,EAX
00988dd4 : JMP 0x00988ddb
00988dd6 : SBB EAX,EAX
00988dd8 : SBB EAX,-0x1
00988ddb : CMP EAX,EBX
00988ddd : JNZ 0x00988ec6
00988de3 : MOV EDX,dword ptr [ESP + 0x14]
00988de7 : CMP byte ptr [EDX + 0x240],0x0
00988dee : JNZ 0x00988e3a
00988df0 : MOV ECX,dword ptr [ESP + 0x20]
00988df4 : MOV ESI,dword ptr [ESP + 0x1c]
00988df8 : SUB ECX,ESI
00988dfa : MOV EAX,0x92492493
00988dff : IMUL ECX
00988e01 : ADD EDX,ECX
00988e03 : SAR EDX,0x4
00988e06 : MOV EAX,EDX
00988e08 : SHR EAX,0x1f
00988e0b : XOR EDI,EDI
00988e0d : ADD EAX,EDX
00988e0f : JZ 0x00988e2a
00988e11 : CMP dword ptr [ESI + 0x18],0x8
00988e15 : JC 0x00988e1c
00988e17 : MOV ESI,dword ptr [ESI + 0x4]
00988e1a : JMP 0x00988e1f
00988e1c : ADD ESI,0x4
00988e1f : PUSH ESI
00988e20 : CALL 0x00634f4d
00988e25 : ADD ESP,0x4
00988e28 : MOV EDI,EAX
00988e2a : MOV ECX,dword ptr [ESP + 0x14]
00988e2e : PUSH EDI
00988e2f : PUSH ECX
00988e30 : CALL 0x00988940
00988e35 : JMP 0x00989024
00988e3a : CMP dword ptr [0x0172491c],EBX
00988e40 : JZ 0x00989024
00988e46 : MOV EDX,dword ptr [0x00da9894]
00988e4c : MOV EAX,dword ptr [EDX]
00988e4e : CMP EAX,EBX
00988e50 : JZ 0x00989024
00988e56 : CMP dword ptr [EAX + 0x1a8],EBX
00988e5c : JZ 0x00989024
00988e62 : PUSH 0xc824a0
00988e67 : LEA ECX,[ESP + 0x48]
00988e6b : CALL 0x00406460
00988e70 : MOV byte ptr [ESP + 0x70],0x7
00988e75 : MOV EAX,[0x00da9894]
00988e7a : MOV EAX,dword ptr [EAX]
00988e7c : MOV ESI,dword ptr [EAX + 0x1a8]
00988e82 : LEA ECX,[ESP + 0x44]
00988e86 : PUSH ECX
00988e87 : MOV ECX,dword ptr [0x0172491c]
00988e8d : LEA EDI,[ESP + 0x2c]
00988e91 : CALL 0x0081d120
00988e96 : MOV byte ptr [ESP + 0x70],0x8
00988e9b : MOV EDX,dword ptr [ESI]
00988e9d : PUSH 0x3
00988e9f : PUSH EAX
00988ea0 : MOV EAX,dword ptr [EDX + 0x44]
00988ea3 : MOV ECX,ESI
00988ea5 : CALL EAX
00988ea7 : MOV byte ptr [ESP + 0x70],0x7
00988eac : MOV ECX,EDI
00988eae : CALL 0x00406560
00988eb3 : MOV byte ptr [ESP + 0x70],0x4
00988eb8 : LEA ECX,[ESP + 0x44]
00988ebc : CALL 0x00406560
00988ec1 : JMP 0x00989024
00988ec6 : MOV EDI,dword ptr [ESP + 0x10]
00988eca : CMP EDI,0x8
00988ecd : JC 0x00988ed3
00988ecf : MOV EAX,dword ptr [ESI]
00988ed1 : JMP 0x00988ed5
00988ed3 : MOV EAX,ESI
00988ed5 : MOV ECX,0xc824f0
00988eda : LEA EBX,[EBX]
00988ee0 : MOV DX,word ptr [EAX]
00988ee3 : CMP DX,word ptr [ECX]
00988ee6 : JNZ 0x00988f06
00988ee8 : CMP DX,BX
00988eeb : JZ 0x00988f02
00988eed : MOV DX,word ptr [EAX + 0x2]
00988ef1 : CMP DX,word ptr [ECX + 0x2]
00988ef5 : JNZ 0x00988f06
00988ef7 : ADD EAX,0x4
00988efa : ADD ECX,0x4
00988efd : CMP DX,BX
00988f00 : JNZ 0x00988ee0
00988f02 : XOR EAX,EAX
00988f04 : JMP 0x00988f0b
00988f06 : SBB EAX,EAX
00988f08 : SBB EAX,-0x1
00988f0b : CMP EAX,EBX
00988f0d : JZ 0x00988f53
00988f0f : CMP EDI,0x8
00988f12 : JC 0x00988f18
00988f14 : MOV EAX,dword ptr [ESI]
00988f16 : JMP 0x00988f1a
00988f18 : MOV EAX,ESI
00988f1a : MOV ECX,0xc8247c
00988f1f : NOP
00988f20 : MOV DX,word ptr [EAX]
00988f23 : CMP DX,word ptr [ECX]
00988f26 : JNZ 0x00988f46
00988f28 : CMP DX,BX
00988f2b : JZ 0x00988f42
00988f2d : MOV DX,word ptr [EAX + 0x2]
00988f31 : CMP DX,word ptr [ECX + 0x2]
00988f35 : JNZ 0x00988f46
00988f37 : ADD EAX,0x4
00988f3a : ADD ECX,0x4
00988f3d : CMP DX,BX
00988f40 : JNZ 0x00988f20
00988f42 : XOR EAX,EAX
00988f44 : JMP 0x00988f4b
00988f46 : SBB EAX,EAX
00988f48 : SBB EAX,-0x1
00988f4b : CMP EAX,EBX
00988f4d : JNZ 0x00989024
00988f53 : MOV ECX,dword ptr [ESP + 0x14]
00988f57 : CMP byte ptr [ECX + 0x240],0x0
00988f5e : JNZ 0x00988fa7
00988f60 : MOV ECX,dword ptr [ESP + 0x20]
00988f64 : MOV ESI,dword ptr [ESP + 0x1c]
00988f68 : SUB ECX,ESI
00988f6a : MOV EAX,0x92492493
00988f6f : IMUL ECX
00988f71 : ADD EDX,ECX
00988f73 : SAR EDX,0x4
00988f76 : MOV EAX,EDX
00988f78 : SHR EAX,0x1f
00988f7b : XOR EDI,EDI
00988f7d : ADD EAX,EDX
00988f7f : JZ 0x00988f9a
00988f81 : CMP dword ptr [ESI + 0x18],0x8
00988f85 : JC 0x00988f8c
00988f87 : MOV ESI,dword ptr [ESI + 0x4]
00988f8a : JMP 0x00988f8f
00988f8c : ADD ESI,0x4
00988f8f : PUSH ESI
00988f90 : CALL 0x00634f4d
00988f95 : ADD ESP,0x4
00988f98 : MOV EDI,EAX
00988f9a : MOV ECX,dword ptr [ESP + 0x14]
00988f9e : PUSH EDI
00988f9f : PUSH ECX
00988fa0 : CALL 0x00988340
00988fa5 : JMP 0x00989024
00988fa7 : CMP dword ptr [0x0172491c],EBX
00988fad : JZ 0x00989024
00988faf : MOV EDX,dword ptr [0x00da9894]
00988fb5 : MOV EAX,dword ptr [EDX]
00988fb7 : CMP EAX,EBX
00988fb9 : JZ 0x00989024
00988fbb : CMP dword ptr [EAX + 0x1a8],EBX
00988fc1 : JZ 0x00989024
00988fc3 : PUSH 0xc82510
00988fc8 : LEA ECX,[ESP + 0x48]
00988fcc : CALL 0x00406460
00988fd1 : MOV BL,0x9
00988fd3 : MOV byte ptr [ESP + 0x70],BL
00988fd7 : MOV EAX,[0x00da9894]
00988fdc : MOV EAX,dword ptr [EAX]
00988fde : MOV ESI,dword ptr [EAX + 0x1a8]
00988fe4 : LEA ECX,[ESP + 0x44]
00988fe8 : PUSH ECX
00988fe9 : MOV ECX,dword ptr [0x0172491c]
00988fef : LEA EDI,[ESP + 0x2c]
00988ff3 : CALL 0x0081d120
00988ff8 : MOV byte ptr [ESP + 0x70],0xa
00988ffd : MOV EDX,dword ptr [ESI]
00988fff : PUSH 0x3
00989001 : PUSH EAX
00989002 : MOV EAX,dword ptr [EDX + 0x44]
00989005 : MOV ECX,ESI
00989007 : CALL EAX
00989009 : MOV byte ptr [ESP + 0x70],BL
0098900d : MOV ECX,EDI
0098900f : CALL 0x00406560
00989014 : MOV byte ptr [ESP + 0x70],0x4
00989019 : LEA ECX,[ESP + 0x44]
0098901d : CALL 0x00406560
00989022 : XOR EBX,EBX
00989024 : MOV dword ptr [ESP + 0x70],0xffffffff
0098902c : MOV EAX,dword ptr [ESP + 0x1c]
00989030 : CMP EAX,EBX
00989032 : JZ 0x0098904e
00989034 : MOV ECX,dword ptr [ESP + 0x10]
00989038 : MOV EDI,dword ptr [ESP + 0x20]
0098903c : PUSH ECX
0098903d : CALL 0x00405450
00989042 : MOV ECX,dword ptr [ESP + 0x20]
00989046 : ADD ESP,0x4
00989049 : CALL 0x006f04e0
0098904e : MOV dword ptr [ESP + 0x1c],EBX
00989052 : MOV dword ptr [ESP + 0x20],EBX
00989056 : MOV dword ptr [ESP + 0x24],EBX
0098905a : MOV ECX,dword ptr [ESP + 0x68]
0098905e : MOV dword ptr FS:[0x0],ECX
00989065 : POP ECX
00989066 : POP EDI
00989067 : POP ESI
00989068 : POP EBX
00989069 : MOV ECX,dword ptr [ESP + 0x50]
0098906d : XOR ECX,ESP
0098906f : CALL 0x00633e6b
00989074 : MOV ESP,EBP
00989076 : POP EBP
00989077 : RET 0x8

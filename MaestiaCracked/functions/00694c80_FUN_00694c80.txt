PROGRAM  : Maestia.exe
FUNCTION : FUN_00694c80
ENTRY    : 00694c80
BODY     : [[00694c80, 00694e9f]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00694c80(int param_1)

{
  undefined1 *puVar1;
  int iVar2;
  undefined1 local_94 [12];
  int local_88;
  undefined1 local_84 [64];
  uint local_44;
  uint local_3c;
  int local_38 [2];
  undefined2 local_30;
  undefined2 local_2e;
  undefined1 *local_2c;
  int local_28;
  uint local_24;
  undefined4 local_20;
  undefined *local_1c;
  undefined1 *local_18;
  uint local_14;
  undefined1 *local_10;
  undefined **local_c;
  undefined1 *local_8;
  
  local_2c = *(undefined1 **)(param_1 + 500);
  local_18 = local_2c + *(int *)(param_1 + 0x1f8);
  if ((local_18 < local_2c + 4) || (CONCAT11(*local_2c,local_2c[1]) != 0)) {
    return 8;
  }
  local_14 = (uint)CONCAT11(local_2c[2],local_2c[3]);
  puVar1 = local_2c + 4;
  do {
    if ((local_14 == 0) || (local_18 < puVar1 + 8)) {
      return 0;
    }
    local_30 = CONCAT11(*puVar1,puVar1[1]);
    local_2e = CONCAT11(puVar1[2],puVar1[3]);
    local_38[1] = 0;
    local_8 = puVar1 + 8;
    local_3c = CONCAT31(CONCAT21(CONCAT11(puVar1[4],puVar1[5]),puVar1[6]),puVar1[7]);
    if ((local_3c != 0) && (local_3c <= *(int *)(param_1 + 0x1f8) - 2U)) {
      local_10 = local_2c + local_3c;
      local_24 = (uint)CONCAT11(*local_10,local_10[1]);
      local_c = &PTR_DAT_00bd9618;
      do {
        local_1c = *local_c;
        if (*(uint *)(local_1c + 0x28) == local_24) {
          local_20 = 0;
          local_38[0] = param_1;
          FUN_00686470(local_94,local_10,local_18,0);
          local_44 = (uint)*(ushort *)(param_1 + 0x108);
          iVar2 = __setjmp3(local_84,0);
          if (iVar2 == 0) {
            local_20 = (**(code **)(local_1c + 0x2c))(local_10,local_94);
          }
          if ((local_88 == 0) &&
             (iVar2 = FUN_0068a570(local_1c,local_10,local_38,&local_28), iVar2 == 0)) {
            *(undefined4 *)(local_28 + 0x14) = local_20;
          }
          break;
        }
        local_c = local_c + 1;
      } while (*local_c != (undefined *)0x0);
    }
    local_14 = local_14 - 1;
    puVar1 = local_8;
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
00694c80 : PUSH EBP
00694c81 : MOV EBP,ESP
00694c83 : SUB ESP,0x90
00694c89 : PUSH EBX
00694c8a : PUSH ESI
00694c8b : MOV ESI,dword ptr [EBP + 0x8]
00694c8e : MOV EAX,dword ptr [ESI + 0x1f4]
00694c94 : MOV ECX,dword ptr [ESI + 0x1f8]
00694c9a : ADD ECX,EAX
00694c9c : MOV dword ptr [EBP + -0x28],EAX
00694c9f : MOV dword ptr [EBP + -0x14],ECX
00694ca2 : MOV dword ptr [EBP + -0x4],EAX
00694ca5 : MOV EAX,dword ptr [EBP + -0x4]
00694ca8 : MOV EDX,0x4
00694cad : ADD EAX,EDX
00694caf : PUSH EDI
00694cb0 : CMP EAX,dword ptr [EBP + -0x14]
00694cb3 : JA 0x00694cdd
00694cb5 : MOV EBX,0x2
00694cba : ADD dword ptr [EBP + -0x4],EBX
00694cbd : MOV ECX,dword ptr [EBP + -0x4]
00694cc0 : MOVZX AX,byte ptr [ECX + -0x2]
00694cc5 : MOV ECX,dword ptr [EBP + -0x4]
00694cc8 : MOVZX CX,byte ptr [ECX + -0x1]
00694ccd : SHL AX,0x8
00694cd1 : MOVZX EAX,AX
00694cd4 : OR CX,AX
00694cd7 : JZ 0x00694ce9
00694cd9 : ADD dword ptr [EBP + -0x4],-0x2
00694cdd : MOV EAX,0x8
00694ce2 : POP EDI
00694ce3 : POP ESI
00694ce4 : POP EBX
00694ce5 : MOV ESP,EBP
00694ce7 : POP EBP
00694ce8 : RET
00694ce9 : ADD dword ptr [EBP + -0x4],EBX
00694cec : MOV EAX,dword ptr [EBP + -0x4]
00694cef : MOVZX CX,byte ptr [EAX + -0x2]
00694cf4 : SHL CX,0x8
00694cf8 : MOVZX EAX,CX
00694cfb : MOV ECX,dword ptr [EBP + -0x4]
00694cfe : MOVZX ECX,byte ptr [ECX + -0x1]
00694d02 : OR ECX,EAX
00694d04 : MOV dword ptr [EBP + -0x10],ECX
00694d07 : MOV EAX,dword ptr [EBP + -0x10]
00694d0a : TEST EAX,EAX
00694d0c : JBE 0x00694e97
00694d12 : XOR EDI,EDI
00694d14 : MOV ECX,dword ptr [EBP + -0x4]
00694d17 : ADD ECX,0x8
00694d1a : CMP ECX,dword ptr [EBP + -0x14]
00694d1d : JA 0x00694e97
00694d23 : ADD dword ptr [EBP + -0x4],EBX
00694d26 : MOV EAX,dword ptr [EBP + -0x4]
00694d29 : MOVZX ECX,byte ptr [EAX + -0x2]
00694d2d : SHL CX,0x8
00694d31 : MOVZX EAX,CX
00694d34 : MOV ECX,dword ptr [EBP + -0x4]
00694d37 : MOVZX ECX,byte ptr [ECX + -0x1]
00694d3b : OR CX,AX
00694d3e : MOV word ptr [EBP + -0x2c],CX
00694d42 : ADD dword ptr [EBP + -0x4],EBX
00694d45 : MOV EAX,dword ptr [EBP + -0x4]
00694d48 : MOVZX ECX,byte ptr [EAX + -0x2]
00694d4c : SHL CX,0x8
00694d50 : MOVZX EAX,CX
00694d53 : MOV ECX,dword ptr [EBP + -0x4]
00694d56 : MOVZX ECX,byte ptr [ECX + -0x1]
00694d5a : OR CX,AX
00694d5d : MOV word ptr [EBP + -0x2a],CX
00694d61 : MOV dword ptr [EBP + -0x34],ESI
00694d64 : MOV dword ptr [EBP + -0x30],EDI
00694d67 : ADD dword ptr [EBP + -0x4],EDX
00694d6a : MOV EAX,dword ptr [EBP + -0x4]
00694d6d : MOVZX ECX,byte ptr [EAX + -0x4]
00694d71 : MOV EAX,dword ptr [EBP + -0x4]
00694d74 : MOVZX EAX,byte ptr [EAX + -0x3]
00694d78 : SHL ECX,0x8
00694d7b : OR EAX,ECX
00694d7d : MOV ECX,dword ptr [EBP + -0x4]
00694d80 : MOVZX ECX,byte ptr [ECX + -0x2]
00694d84 : SHL EAX,0x8
00694d87 : OR ECX,EAX
00694d89 : MOV EAX,dword ptr [EBP + -0x4]
00694d8c : MOVZX EAX,byte ptr [EAX + -0x1]
00694d90 : SHL ECX,0x8
00694d93 : OR EAX,ECX
00694d95 : MOV dword ptr [EBP + -0x38],EAX
00694d98 : JZ 0x00694e8a
00694d9e : MOV ECX,dword ptr [ESI + 0x1f8]
00694da4 : SUB ECX,EBX
00694da6 : CMP EAX,ECX
00694da8 : JA 0x00694e8a
00694dae : MOV ECX,dword ptr [EBP + -0x28]
00694db1 : ADD EAX,ECX
00694db3 : MOV dword ptr [EBP + -0xc],EAX
00694db6 : MOV EAX,dword ptr [EBP + -0xc]
00694db9 : MOVZX CX,byte ptr [EAX]
00694dbd : SHL CX,0x8
00694dc1 : MOVZX EAX,CX
00694dc4 : MOV ECX,dword ptr [EBP + -0xc]
00694dc7 : MOVZX ECX,byte ptr [ECX + 0x1]
00694dcb : OR ECX,EAX
00694dcd : MOV dword ptr [EBP + -0x20],ECX
00694dd0 : MOV dword ptr [EBP + -0x8],0xbd9618
00694dd7 : MOV EAX,dword ptr [EBP + -0x8]
00694dda : CMP dword ptr [EAX],EDI
00694ddc : JZ 0x00694e87
00694de2 : MOV ECX,dword ptr [EBP + -0x8]
00694de5 : MOV EAX,dword ptr [ECX]
00694de7 : MOV dword ptr [EBP + -0x18],EAX
00694dea : MOV EAX,dword ptr [EBP + -0x18]
00694ded : MOV ECX,dword ptr [EBP + -0x20]
00694df0 : CMP dword ptr [EAX + 0x28],ECX
00694df3 : JZ 0x00694e04
00694df5 : ADD dword ptr [EBP + -0x8],EDX
00694df8 : MOV EAX,dword ptr [EBP + -0x8]
00694dfb : CMP dword ptr [EAX],EDI
00694dfd : JNZ 0x00694de2
00694dff : JMP 0x00694e87
00694e04 : MOV ECX,dword ptr [EBP + -0x14]
00694e07 : PUSH EDI
00694e08 : MOV dword ptr [EBP + -0x1c],EDI
00694e0b : MOV EDX,dword ptr [EBP + -0xc]
00694e0e : PUSH ECX
00694e0f : PUSH EDX
00694e10 : LEA EAX,[EBP + 0xffffff70]
00694e16 : PUSH EAX
00694e17 : CALL 0x00686470
00694e1c : MOVZX ECX,word ptr [ESI + 0x108]
00694e23 : LEA EDX,[EBP + -0x80]
00694e26 : PUSH EDI
00694e27 : PUSH EDX
00694e28 : MOV dword ptr [EBP + -0x40],ECX
00694e2b : CALL 0x006d4930
00694e30 : ADD ESP,0x18
00694e33 : TEST EAX,EAX
00694e35 : JNZ 0x00694e50
00694e37 : MOV EAX,dword ptr [EBP + -0x18]
00694e3a : MOV EDX,dword ptr [EBP + -0xc]
00694e3d : MOV EAX,dword ptr [EAX + 0x2c]
00694e40 : LEA ECX,[EBP + 0xffffff70]
00694e46 : PUSH ECX
00694e47 : PUSH EDX
00694e48 : CALL EAX
00694e4a : ADD ESP,0x8
00694e4d : MOV dword ptr [EBP + -0x1c],EAX
00694e50 : MOV ECX,dword ptr [EBP + 0xffffff7c]
00694e56 : TEST ECX,ECX
00694e58 : JNZ 0x00694e7f
00694e5a : MOV ECX,dword ptr [EBP + -0xc]
00694e5d : LEA EDX,[EBP + -0x24]
00694e60 : PUSH EDX
00694e61 : MOV EDX,dword ptr [EBP + -0x18]
00694e64 : LEA EAX,[EBP + -0x34]
00694e67 : PUSH EAX
00694e68 : PUSH ECX
00694e69 : PUSH EDX
00694e6a : CALL 0x0068a570
00694e6f : ADD ESP,0x10
00694e72 : TEST EAX,EAX
00694e74 : JNZ 0x00694e7f
00694e76 : MOV EAX,dword ptr [EBP + -0x1c]
00694e79 : MOV ECX,dword ptr [EBP + -0x24]
00694e7c : MOV dword ptr [ECX + 0x14],EAX
00694e7f : MOV ESI,dword ptr [EBP + 0x8]
00694e82 : MOV EDX,0x4
00694e87 : MOV EAX,dword ptr [EBP + -0x8]
00694e8a : ADD dword ptr [EBP + -0x10],-0x1
00694e8e : MOV ECX,dword ptr [EBP + -0x10]
00694e91 : JNZ 0x00694d14
00694e97 : POP EDI
00694e98 : POP ESI
00694e99 : XOR EAX,EAX
00694e9b : POP EBX
00694e9c : MOV ESP,EBP
00694e9e : POP EBP
00694e9f : RET

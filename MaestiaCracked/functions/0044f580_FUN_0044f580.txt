PROGRAM  : Maestia.exe
FUNCTION : FUN_0044f580
ENTRY    : 0044f580
BODY     : [[0044f580, 0044f6b8] [0044f6ca, 0044f79b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0044f580(uint param_1,undefined4 *param_2)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  undefined4 uVar4;
  uint in_ECX;
  uint uVar5;
  uint extraout_ECX;
  undefined4 *puVar6;
  int iVar7;
  uint local_20;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  iVar2 = param_1;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7ac90;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  iVar3 = *(int *)(param_1 + 4);
  if (iVar3 == 0) {
    uVar5 = 0;
  }
  else {
    uVar5 = *(int *)(param_1 + 0xc) - iVar3 >> 2;
  }
  if (in_ECX != 0) {
    iVar7 = *(int *)(param_1 + 8);
    iVar3 = iVar7 - iVar3 >> 2;
    if (0x3fffffffU - iVar3 < in_ECX) {
      iVar3 = FUN_00429be0();
      uVar5 = extraout_ECX;
    }
    uVar1 = iVar3 + in_ECX;
    if (uVar5 < uVar1) {
      if (0x3fffffff - (uVar5 >> 1) < uVar5) {
        param_1 = 0;
      }
      else {
        param_1 = uVar5 + (uVar5 >> 1);
      }
      if (param_1 < uVar1) {
        param_1 = uVar1;
      }
      iVar3 = FUN_004c1790();
      local_8 = 0;
      FUN_004c1760();
      FUN_004c17f0(*(undefined4 *)(iVar2 + 4),param_2);
      FUN_004c17f0(param_2,*(undefined4 *)(iVar2 + 8));
      local_8 = 0xffffffff;
      if (*(int *)(iVar2 + 4) == 0) {
        *(uint *)(iVar2 + 0xc) = iVar3 + param_1 * 4;
        *(uint *)(iVar2 + 8) =
             iVar3 + (in_ECX + (*(int *)(iVar2 + 8) - *(int *)(iVar2 + 4) >> 2)) * 4;
        *(int *)(iVar2 + 4) = iVar3;
        ExceptionList = local_10;
        return;
      }
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    if ((uint)(iVar7 - (int)param_2 >> 2) < in_ECX) {
      FUN_004c17f0(param_2,iVar7);
      local_8 = 2;
      local_20 = local_20 & 0xffffff00;
      FUN_004c1940(*(int *)(param_1 + 8),in_ECX - (*(int *)(param_1 + 8) - (int)param_2 >> 2),
                   param_2,local_20);
      local_8 = 0xffffffff;
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + in_ECX * 4;
    }
    else {
      puVar6 = (undefined4 *)(iVar7 + in_ECX * -4);
      uVar4 = FUN_004c17f0(puVar6,iVar7);
      *(undefined4 *)(param_1 + 8) = uVar4;
      if (param_2 != puVar6) {
        iVar7 = iVar7 - (int)puVar6;
        do {
          puVar6 = puVar6 + -1;
          *(undefined4 *)(iVar7 + (int)puVar6) = *puVar6;
        } while (puVar6 != param_2);
      }
    }
    FUN_00422490(param_2);
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
0044f580 : PUSH EBP
0044f581 : MOV EBP,ESP
0044f583 : PUSH -0x1
0044f585 : PUSH 0xb7ac90
0044f58a : MOV EAX,FS:[0x0]
0044f590 : PUSH EAX
0044f591 : SUB ESP,0x10
0044f594 : PUSH EBX
0044f595 : PUSH ESI
0044f596 : PUSH EDI
0044f597 : MOV EAX,[0x00d66fa0]
0044f59c : XOR EAX,EBP
0044f59e : PUSH EAX
0044f59f : LEA EAX,[EBP + -0xc]
0044f5a2 : MOV FS:[0x0],EAX
0044f5a8 : MOV dword ptr [EBP + -0x10],ESP
0044f5ab : MOV ESI,ECX
0044f5ad : MOV EBX,dword ptr [EBP + 0x8]
0044f5b0 : MOV EDX,dword ptr [EBX + 0x4]
0044f5b3 : TEST EDX,EDX
0044f5b5 : JNZ 0x0044f5bb
0044f5b7 : XOR ECX,ECX
0044f5b9 : JMP 0x0044f5c5
0044f5bb : MOV EAX,dword ptr [EBX + 0xc]
0044f5be : SUB EAX,EDX
0044f5c0 : SAR EAX,0x2
0044f5c3 : MOV ECX,EAX
0044f5c5 : TEST ESI,ESI
0044f5c7 : JZ 0x0044f788
0044f5cd : MOV EDI,dword ptr [EBX + 0x8]
0044f5d0 : MOV EAX,EDI
0044f5d2 : SUB EAX,EDX
0044f5d4 : SAR EAX,0x2
0044f5d7 : MOV EDX,0x3fffffff
0044f5dc : SUB EDX,EAX
0044f5de : CMP EDX,ESI
0044f5e0 : JNC 0x0044f5e7
0044f5e2 : CALL 0x00429be0
0044f5e7 : LEA EDX,[EAX + ESI*0x1]
0044f5ea : CMP ECX,EDX
0044f5ec : JNC 0x0044f6ca
0044f5f2 : MOV EAX,ECX
0044f5f4 : SHR EAX,0x1
0044f5f6 : MOV EDI,0x3fffffff
0044f5fb : SUB EDI,EAX
0044f5fd : CMP EDI,ECX
0044f5ff : JNC 0x0044f60d
0044f601 : MOV dword ptr [EBP + 0x8],0x0
0044f608 : MOV ECX,dword ptr [EBP + 0x8]
0044f60b : JMP 0x0044f612
0044f60d : ADD ECX,EAX
0044f60f : MOV dword ptr [EBP + 0x8],ECX
0044f612 : CMP ECX,EDX
0044f614 : JNC 0x0044f61b
0044f616 : MOV dword ptr [EBP + 0x8],EDX
0044f619 : MOV ECX,EDX
0044f61b : CALL 0x004c1790
0044f620 : MOV dword ptr [EBP + -0x14],EAX
0044f623 : MOV ECX,dword ptr [EBP + 0xc]
0044f626 : SUB ECX,dword ptr [EBX + 0x4]
0044f629 : SAR ECX,0x2
0044f62c : MOV dword ptr [EBP + -0x1c],ECX
0044f62f : MOV dword ptr [EBP + -0x4],0x0
0044f636 : LEA EDI,[EAX + ECX*0x4]
0044f639 : MOV EDX,dword ptr [EBP + 0x10]
0044f63c : CALL 0x004c1760
0044f641 : MOV dword ptr [EBP + -0x18],0x1
0044f648 : MOV EAX,dword ptr [EBP + 0xc]
0044f64b : PUSH EAX
0044f64c : MOV ECX,dword ptr [EBX + 0x4]
0044f64f : PUSH ECX
0044f650 : MOV EDI,dword ptr [EBP + -0x14]
0044f653 : MOV EDX,EDI
0044f655 : CALL 0x004c17f0
0044f65a : MOV dword ptr [EBP + -0x18],0x2
0044f661 : MOV EDX,dword ptr [EBP + -0x1c]
0044f664 : ADD EDX,ESI
0044f666 : LEA EDX,[EDI + EDX*0x4]
0044f669 : MOV EAX,dword ptr [EBX + 0x8]
0044f66c : PUSH EAX
0044f66d : MOV ECX,dword ptr [EBP + 0xc]
0044f670 : PUSH ECX
0044f671 : CALL 0x004c17f0
0044f676 : MOV dword ptr [EBP + -0x4],0xffffffff
0044f67d : MOV ECX,dword ptr [EBX + 0x4]
0044f680 : MOV EDX,dword ptr [EBX + 0x8]
0044f683 : SUB EDX,ECX
0044f685 : SAR EDX,0x2
0044f688 : ADD ESI,EDX
0044f68a : TEST ECX,ECX
0044f68c : JZ 0x0044f693
0044f68e : CALL 0x006f04e0
0044f693 : MOV EAX,dword ptr [EBP + 0x8]
0044f696 : LEA ECX,[EDI + EAX*0x4]
0044f699 : MOV dword ptr [EBX + 0xc],ECX
0044f69c : LEA EDX,[EDI + ESI*0x4]
0044f69f : MOV dword ptr [EBX + 0x8],EDX
0044f6a2 : MOV dword ptr [EBX + 0x4],EDI
0044f6a5 : MOV ECX,dword ptr [EBP + -0xc]
0044f6a8 : MOV dword ptr FS:[0x0],ECX
0044f6af : POP ECX
0044f6b0 : POP EDI
0044f6b1 : POP ESI
0044f6b2 : POP EBX
0044f6b3 : MOV ESP,EBP
0044f6b5 : POP EBP
0044f6b6 : RET 0xc
0044f6ca : MOV ECX,EDI
0044f6cc : MOV EAX,dword ptr [EBP + 0xc]
0044f6cf : SUB ECX,EAX
0044f6d1 : SAR ECX,0x2
0044f6d4 : PUSH EDI
0044f6d5 : CMP ECX,ESI
0044f6d7 : JNC 0x0044f739
0044f6d9 : MOV EDX,dword ptr [EBP + 0x10]
0044f6dc : MOV ECX,dword ptr [EDX]
0044f6de : MOV dword ptr [EBP + 0x8],ECX
0044f6e1 : LEA ECX,[ESI*0x4 + 0x0]
0044f6e8 : MOV dword ptr [EBP + 0x10],ECX
0044f6eb : LEA EDX,[ECX + EAX*0x1]
0044f6ee : PUSH EAX
0044f6ef : CALL 0x004c17f0
0044f6f4 : MOV dword ptr [EBP + -0x4],0x2
0044f6fb : MOV EAX,dword ptr [EBX + 0x8]
0044f6fe : MOV EDX,EAX
0044f700 : SUB EDX,dword ptr [EBP + 0xc]
0044f703 : SAR EDX,0x2
0044f706 : SUB ESI,EDX
0044f708 : MOV byte ptr [EBP + -0x1c],0x0
0044f70c : MOV ECX,dword ptr [EBP + -0x1c]
0044f70f : PUSH ECX
0044f710 : MOV EDX,dword ptr [EBP + 0xc]
0044f713 : PUSH EDX
0044f714 : PUSH ESI
0044f715 : PUSH EAX
0044f716 : LEA EDX,[EBP + 0x8]
0044f719 : CALL 0x004c1940
0044f71e : ADD ESP,0x10
0044f721 : MOV dword ptr [EBP + -0x4],0xffffffff
0044f728 : MOV EAX,dword ptr [EBP + 0x10]
0044f72b : ADD dword ptr [EBX + 0x8],EAX
0044f72e : MOV ECX,dword ptr [EBX + 0x8]
0044f731 : SUB ECX,EAX
0044f733 : MOV EAX,dword ptr [EBP + 0xc]
0044f736 : PUSH EAX
0044f737 : JMP 0x0044f77d
0044f739 : MOV ECX,dword ptr [EBP + 0x10]
0044f73c : MOV EDX,dword ptr [ECX]
0044f73e : MOV dword ptr [EBP + 0x8],EDX
0044f741 : LEA EAX,[ESI*0x4 + 0x0]
0044f748 : MOV dword ptr [EBP + 0x10],EAX
0044f74b : MOV ESI,EDI
0044f74d : SUB ESI,EAX
0044f74f : PUSH ESI
0044f750 : MOV EDX,EDI
0044f752 : CALL 0x004c17f0
0044f757 : MOV dword ptr [EBX + 0x8],EAX
0044f75a : MOV EAX,ESI
0044f75c : MOV EDX,dword ptr [EBP + 0xc]
0044f75f : MOV ECX,EDX
0044f761 : CMP EDX,EAX
0044f763 : JZ 0x0044f776
0044f765 : SUB EDI,ESI
0044f767 : SUB EAX,0x4
0044f76a : MOV EDX,dword ptr [EAX]
0044f76c : MOV dword ptr [EDI + EAX*0x1],EDX
0044f76f : CMP EAX,ECX
0044f771 : JNZ 0x0044f767
0044f773 : MOV EDX,dword ptr [EBP + 0xc]
0044f776 : MOV EAX,dword ptr [EBP + 0x10]
0044f779 : LEA ECX,[EAX + EDX*0x1]
0044f77c : PUSH EDX
0044f77d : LEA EDX,[EBP + 0x8]
0044f780 : CALL 0x00422490
0044f785 : ADD ESP,0x4
0044f788 : MOV ECX,dword ptr [EBP + -0xc]
0044f78b : MOV dword ptr FS:[0x0],ECX
0044f792 : POP ECX
0044f793 : POP EDI
0044f794 : POP ESI
0044f795 : POP EBX
0044f796 : MOV ESP,EBP
0044f798 : POP EBP
0044f799 : RET 0xc

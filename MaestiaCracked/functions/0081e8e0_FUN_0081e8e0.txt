PROGRAM  : Maestia.exe
FUNCTION : FUN_0081e8e0
ENTRY    : 0081e8e0
BODY     : [[0081e8e0, 0081ebcb]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0081e8e0(void)

{
  int iVar1;
  DWORD DVar2;
  undefined4 uVar3;
  undefined1 *puVar4;
  int *in_ECX;
  int iVar5;
  undefined4 ***pppuVar6;
  __time64_t _Var7;
  undefined1 local_88 [28];
  uint local_6c;
  undefined1 local_4c [4];
  undefined4 **local_48 [5];
  uint local_34;
  undefined4 **local_2c [4];
  int local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b29bbf;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_6c = 0;
  if (((DAT_00da93ec == 0) ||
      (((iVar1 = FUN_00a1a840(0xffff0000), iVar1 == 0 &&
        (iVar1 = FUN_00a1a6d0(0xffff0000), iVar1 == 0)) &&
       (iVar1 = FUN_00a1a780(0xffff0000), iVar1 == 0)))) ||
     ((*in_ECX == -1 || (DVar2 = GetTickCount(), DVar2 - in_ECX[8] < 0x1f5)))) goto LAB_0081ebb0;
  DVar2 = GetTickCount();
  in_ECX[8] = DVar2;
  local_18 = 7;
  local_1c = 0;
  local_2c[0] = (undefined4 **)((uint)local_2c[0] & 0xffff0000);
  local_8 = 0;
  if (in_ECX[6] != 0 || in_ECX[7] != 0) {
    _Var7 = __time64((__time64_t *)0x0);
    iVar5 = in_ECX[6] - (int)_Var7;
    if (-1 < iVar5) {
      if (iVar5 < 0x15180) {
        if (iVar5 < 0xe10) {
          if (iVar5 < 0x3c) {
            if (iVar5 == 0) goto LAB_0081ea95;
            uVar3 = FUN_00404750(L"%d sec",iVar5);
            local_8._0_1_ = 4;
          }
          else {
            uVar3 = FUN_00404750(L"%d min",iVar5 / 0x3c);
            local_8._0_1_ = 3;
          }
        }
        else {
          uVar3 = FUN_00404750(L"%d hour",iVar5 / 0xe10);
          local_8._0_1_ = 2;
        }
      }
      else {
        uVar3 = FUN_00404750(L"%d day",iVar5 / 0x15180);
        local_8._0_1_ = 1;
      }
      FUN_00405eb0(uVar3,0,0xffffffff);
      local_8 = (uint)local_8._1_3_ << 8;
      FUN_00406560();
    }
  }
LAB_0081ea95:
  iVar5 = FUN_00404750(L"IDS_TOTEM_NAME%d",*in_ECX + 1);
  local_8._0_1_ = 5;
  if (*(uint *)(iVar5 + 0x18) < 8) {
    iVar5 = iVar5 + 4;
  }
  else {
    iVar5 = *(int *)(iVar5 + 4);
  }
  FUN_00406460(iVar5);
  local_8._0_1_ = 6;
  puVar4 = local_4c;
  FUN_0081d120(local_88);
  local_8._0_1_ = 8;
  FUN_00406560();
  local_8._0_1_ = 9;
  FUN_00406560();
  if (local_1c != 0) {
    pppuVar6 = (undefined4 ***)local_2c[0];
    if (local_18 < 8) {
      pppuVar6 = local_2c;
    }
    if (local_34 < 8) {
      local_48[0] = local_48;
    }
    puVar4 = (undefined1 *)FUN_00404750(L"%s (%s)",local_48[0],pppuVar6);
    local_8._0_1_ = 10;
    local_6c = 1;
  }
  FUN_00405660(puVar4);
  local_8 = 0xc;
  if ((local_6c & 1) != 0) {
    local_6c = local_6c & 0xfffffffe;
    FUN_00406560();
  }
  FUN_004044f0();
  FUN_007a6c40(*(undefined4 *)(iVar1 + 0x42c));
  local_8._0_1_ = 9;
  FUN_00406560();
  local_8 = (uint)local_8._1_3_ << 8;
  FUN_00406560();
  local_8 = 0xffffffff;
  FUN_00406560();
LAB_0081ebb0:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0081e8e0 : PUSH EBP
0081e8e1 : MOV EBP,ESP
0081e8e3 : PUSH -0x1
0081e8e5 : PUSH 0xb29bbf
0081e8ea : MOV EAX,FS:[0x0]
0081e8f0 : PUSH EAX
0081e8f1 : SUB ESP,0x9c
0081e8f7 : MOV EAX,[0x00d66fa0]
0081e8fc : XOR EAX,EBP
0081e8fe : MOV dword ptr [EBP + -0x10],EAX
0081e901 : PUSH EBX
0081e902 : PUSH ESI
0081e903 : PUSH EDI
0081e904 : PUSH EAX
0081e905 : LEA EAX,[EBP + -0xc]
0081e908 : MOV FS:[0x0],EAX
0081e90e : MOV EDI,ECX
0081e910 : MOV dword ptr [EBP + -0x68],0x0
0081e917 : MOV ECX,dword ptr [0x00da93ec]
0081e91d : TEST ECX,ECX
0081e91f : JZ 0x0081ebb0
0081e925 : PUSH 0xffff0000
0081e92a : MOV ESI,ECX
0081e92c : CALL 0x00a1a840
0081e931 : MOV EBX,EAX
0081e933 : TEST EBX,EBX
0081e935 : JNZ 0x0081e95f
0081e937 : PUSH 0xffff0000
0081e93c : MOV ECX,ESI
0081e93e : CALL 0x00a1a6d0
0081e943 : MOV EBX,EAX
0081e945 : TEST EBX,EBX
0081e947 : JNZ 0x0081e95f
0081e949 : PUSH 0xffff0000
0081e94e : MOV ECX,ESI
0081e950 : CALL 0x00a1a780
0081e955 : MOV EBX,EAX
0081e957 : TEST EBX,EBX
0081e959 : JZ 0x0081ebb0
0081e95f : CMP dword ptr [EDI],-0x1
0081e962 : JZ 0x0081ebb0
0081e968 : MOV ESI,dword ptr [0x00b850d8]
0081e96e : CALL ESI
0081e970 : SUB EAX,dword ptr [EDI + 0x20]
0081e973 : CMP EAX,0x1f4
0081e978 : JBE 0x0081ebb0
0081e97e : CALL ESI
0081e980 : MOV dword ptr [EDI + 0x20],EAX
0081e983 : XOR ESI,ESI
0081e985 : XOR EAX,EAX
0081e987 : MOV dword ptr [EBP + -0x14],0x7
0081e98e : MOV dword ptr [EBP + -0x18],ESI
0081e991 : MOV word ptr [EBP + -0x28],AX
0081e995 : MOV dword ptr [EBP + -0x4],ESI
0081e998 : MOV ECX,dword ptr [EDI + 0x18]
0081e99b : OR ECX,dword ptr [EDI + 0x1c]
0081e99e : JZ 0x0081ea95
0081e9a4 : PUSH ESI
0081e9a5 : CALL 0x006381ab
0081e9aa : MOV ECX,dword ptr [EDI + 0x18]
0081e9ad : ADD ESP,0x4
0081e9b0 : SUB ECX,EAX
0081e9b2 : MOV dword ptr [EBP + 0xffffff5c],EDX
0081e9b8 : JS 0x0081ea95
0081e9be : CMP ECX,0x15180
0081e9c4 : JL 0x0081e9f6
0081e9c6 : MOV EAX,0xc22e4507
0081e9cb : IMUL ECX
0081e9cd : ADD EDX,ECX
0081e9cf : SAR EDX,0x10
0081e9d2 : MOV EAX,EDX
0081e9d4 : SHR EAX,0x1f
0081e9d7 : ADD EAX,EDX
0081e9d9 : PUSH EAX
0081e9da : PUSH 0xc342e8
0081e9df : LEA ESI,[EBP + 0xffffff7c]
0081e9e5 : CALL 0x00404750
0081e9ea : ADD ESP,0x8
0081e9ed : MOV byte ptr [EBP + -0x4],0x1
0081e9f1 : JMP 0x0081ea79
0081e9f6 : CMP ECX,0xe10
0081e9fc : JL 0x0081ea2b
0081e9fe : MOV EAX,0x91a2b3c5
0081ea03 : IMUL ECX
0081ea05 : ADD EDX,ECX
0081ea07 : SAR EDX,0xb
0081ea0a : MOV ECX,EDX
0081ea0c : SHR ECX,0x1f
0081ea0f : ADD ECX,EDX
0081ea11 : PUSH ECX
0081ea12 : PUSH 0xc342f8
0081ea17 : LEA ESI,[EBP + 0xffffff7c]
0081ea1d : CALL 0x00404750
0081ea22 : ADD ESP,0x8
0081ea25 : MOV byte ptr [EBP + -0x4],0x2
0081ea29 : JMP 0x0081ea79
0081ea2b : CMP ECX,0x3c
0081ea2e : JL 0x0081ea5d
0081ea30 : MOV EAX,0x88888889
0081ea35 : IMUL ECX
0081ea37 : ADD EDX,ECX
0081ea39 : SAR EDX,0x5
0081ea3c : MOV EAX,EDX
0081ea3e : SHR EAX,0x1f
0081ea41 : ADD EAX,EDX
0081ea43 : PUSH EAX
0081ea44 : PUSH 0xc34308
0081ea49 : LEA ESI,[EBP + 0xffffff7c]
0081ea4f : CALL 0x00404750
0081ea54 : ADD ESP,0x8
0081ea57 : MOV byte ptr [EBP + -0x4],0x3
0081ea5b : JMP 0x0081ea79
0081ea5d : CMP ECX,ESI
0081ea5f : JZ 0x0081ea95
0081ea61 : PUSH ECX
0081ea62 : PUSH 0xc34318
0081ea67 : LEA ESI,[EBP + 0xffffff7c]
0081ea6d : CALL 0x00404750
0081ea72 : ADD ESP,0x8
0081ea75 : MOV byte ptr [EBP + -0x4],0x4
0081ea79 : PUSH -0x1
0081ea7b : PUSH 0x0
0081ea7d : PUSH EAX
0081ea7e : LEA ECX,[EBP + -0x2c]
0081ea81 : CALL 0x00405eb0
0081ea86 : MOV byte ptr [EBP + -0x4],0x0
0081ea8a : LEA ECX,[EBP + 0xffffff7c]
0081ea90 : CALL 0x00406560
0081ea95 : MOV ECX,dword ptr [EDI]
0081ea97 : INC ECX
0081ea98 : PUSH ECX
0081ea99 : PUSH 0xc34328
0081ea9e : LEA ESI,[EBP + 0xffffff60]
0081eaa4 : CALL 0x00404750
0081eaa9 : ADD ESP,0x8
0081eaac : MOV byte ptr [EBP + -0x4],0x5
0081eab0 : MOV ESI,0x8
0081eab5 : CMP dword ptr [EAX + 0x18],ESI
0081eab8 : JC 0x0081eabf
0081eaba : MOV EAX,dword ptr [EAX + 0x4]
0081eabd : JMP 0x0081eac2
0081eabf : ADD EAX,0x4
0081eac2 : PUSH EAX
0081eac3 : LEA ECX,[EBP + 0xffffff7c]
0081eac9 : CALL 0x00406460
0081eace : MOV byte ptr [EBP + -0x4],0x6
0081ead2 : MOV ECX,dword ptr [0x0172491c]
0081ead8 : LEA EDX,[EBP + 0xffffff7c]
0081eade : PUSH EDX
0081eadf : LEA EDI,[EBP + -0x48]
0081eae2 : CALL 0x0081d120
0081eae7 : MOV byte ptr [EBP + -0x4],0x8
0081eaeb : LEA ECX,[EBP + 0xffffff7c]
0081eaf1 : CALL 0x00406560
0081eaf6 : MOV byte ptr [EBP + -0x4],0x9
0081eafa : LEA ECX,[EBP + 0xffffff60]
0081eb00 : CALL 0x00406560
0081eb05 : CMP dword ptr [EBP + -0x18],0x0
0081eb09 : JNZ 0x0081eb0f
0081eb0b : MOV EAX,EDI
0081eb0d : JMP 0x0081eb45
0081eb0f : MOV ECX,dword ptr [EBP + -0x28]
0081eb12 : CMP dword ptr [EBP + -0x14],ESI
0081eb15 : JNC 0x0081eb1a
0081eb17 : LEA ECX,[EBP + -0x28]
0081eb1a : MOV EAX,dword ptr [EBP + -0x44]
0081eb1d : CMP dword ptr [EBP + -0x30],ESI
0081eb20 : JNC 0x0081eb25
0081eb22 : LEA EAX,[EBP + -0x44]
0081eb25 : PUSH ECX
0081eb26 : PUSH EAX
0081eb27 : PUSH 0xc3434c
0081eb2c : LEA ESI,[EBP + 0xffffff60]
0081eb32 : CALL 0x00404750
0081eb37 : ADD ESP,0xc
0081eb3a : MOV byte ptr [EBP + -0x4],0xa
0081eb3e : MOV dword ptr [EBP + -0x68],0x1
0081eb45 : PUSH EAX
0081eb46 : LEA ECX,[EBP + -0x64]
0081eb49 : CALL 0x00405660
0081eb4e : MOV dword ptr [EBP + -0x4],0xc
0081eb55 : TEST byte ptr [EBP + -0x68],0x1
0081eb59 : JZ 0x0081eb6a
0081eb5b : AND dword ptr [EBP + -0x68],0xfffffffe
0081eb5f : LEA ECX,[EBP + 0xffffff60]
0081eb65 : CALL 0x00406560
0081eb6a : LEA ECX,[EBP + -0x64]
0081eb6d : MOV EDI,EBX
0081eb6f : CALL 0x004044f0
0081eb74 : MOV EAX,dword ptr [EBX + 0x42c]
0081eb7a : MOV ESI,dword ptr [EBX + 0x3f8]
0081eb80 : PUSH EAX
0081eb81 : LEA EAX,[EBP + -0x64]
0081eb84 : CALL 0x007a6c40
0081eb89 : MOV byte ptr [EBP + -0x4],0x9
0081eb8d : LEA ECX,[EBP + -0x64]
0081eb90 : CALL 0x00406560
0081eb95 : MOV byte ptr [EBP + -0x4],0x0
0081eb99 : LEA ECX,[EBP + -0x48]
0081eb9c : CALL 0x00406560
0081eba1 : MOV dword ptr [EBP + -0x4],0xffffffff
0081eba8 : LEA ECX,[EBP + -0x2c]
0081ebab : CALL 0x00406560
0081ebb0 : MOV ECX,dword ptr [EBP + -0xc]
0081ebb3 : MOV dword ptr FS:[0x0],ECX
0081ebba : POP ECX
0081ebbb : POP EDI
0081ebbc : POP ESI
0081ebbd : POP EBX
0081ebbe : MOV ECX,dword ptr [EBP + -0x10]
0081ebc1 : XOR ECX,EBP
0081ebc3 : CALL 0x00633e6b
0081ebc8 : MOV ESP,EBP
0081ebca : POP EBP
0081ebcb : RET

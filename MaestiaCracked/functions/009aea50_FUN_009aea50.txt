PROGRAM  : Maestia.exe
FUNCTION : FUN_009aea50
ENTRY    : 009aea50
BODY     : [[009aea50, 009aebd9]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */
/* WARNING: Removing unreachable block (ram,0x009aeb99) */

void FUN_009aea50(void)

{
  short sVar1;
  wchar_t *_Src;
  short *psVar2;
  undefined4 in_ECX;
  int unaff_ESI;
  wchar_t local_1014;
  undefined1 local_1012 [2046];
  short local_814;
  undefined1 local_812 [2046];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  puStack_c = &LAB_00b3ad3e;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_8 = 0;
  *(undefined4 *)(unaff_ESI + 0x18) = 7;
  *(undefined4 *)(unaff_ESI + 0x14) = 0;
  *(undefined2 *)(unaff_ESI + 4) = 0;
  FUN_00405eb0(in_ECX,0,0xffffffff);
  local_8 = 0;
  FUN_00405eb0(in_ECX,0,0xffffffff);
  local_8 = 1;
  local_1014 = L'\0';
  _memset(local_1012,0,0x7fe);
  local_814 = 0;
  _memset(local_812,0,0x7fe);
  if (*(uint *)(unaff_ESI + 0x18) < 8) {
    _Src = (wchar_t *)(unaff_ESI + 4);
  }
  else {
    _Src = *(wchar_t **)(unaff_ESI + 4);
  }
  _wcscpy_s(&local_1014,0x400,_Src);
  FUN_006efb90(0x400);
  psVar2 = &local_814;
  do {
    sVar1 = *psVar2;
    psVar2 = psVar2 + 1;
  } while (sVar1 != 0);
  FUN_00406360(&local_814,(int)psVar2 - (int)local_812 >> 1);
  local_8 = local_8 & 0xffffff00;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
009aea50 : PUSH EBP
009aea51 : MOV EBP,ESP
009aea53 : PUSH -0x1
009aea55 : PUSH 0xb3ad3e
009aea5a : MOV EAX,FS:[0x0]
009aea60 : PUSH EAX
009aea61 : MOV EAX,0x1028
009aea66 : CALL 0x0063b780
009aea6b : MOV EAX,[0x00d66fa0]
009aea70 : XOR EAX,EBP
009aea72 : MOV dword ptr [EBP + -0x10],EAX
009aea75 : PUSH EBX
009aea76 : PUSH EDI
009aea77 : PUSH EAX
009aea78 : LEA EAX,[EBP + -0xc]
009aea7b : MOV FS:[0x0],EAX
009aea81 : XOR EBX,EBX
009aea83 : MOV dword ptr [EBP + -0x4],EBX
009aea86 : PUSH -0x1
009aea88 : MOV EDI,ECX
009aea8a : MOV dword ptr [EBP + 0xffffefd0],EBX
009aea90 : PUSH EBX
009aea91 : XOR EAX,EAX
009aea93 : MOV dword ptr [ESI + 0x18],0x7
009aea9a : MOV dword ptr [ESI + 0x14],EBX
009aea9d : PUSH EDI
009aea9e : MOV ECX,ESI
009aeaa0 : MOV dword ptr [EBP + 0xffffefcc],ESI
009aeaa6 : MOV word ptr [ESI + 0x4],AX
009aeaaa : CALL 0x00405eb0
009aeaaf : MOV dword ptr [EBP + -0x4],EBX
009aeab2 : PUSH -0x1
009aeab4 : XOR ECX,ECX
009aeab6 : PUSH EBX
009aeab7 : MOV word ptr [EBP + 0xffffefd8],CX
009aeabe : PUSH EDI
009aeabf : LEA ECX,[EBP + 0xffffefd4]
009aeac5 : MOV dword ptr [EBP + 0xffffefd0],0x1
009aeacf : MOV dword ptr [EBP + 0xffffefec],0x7
009aead9 : MOV dword ptr [EBP + 0xffffefe8],EBX
009aeadf : CALL 0x00405eb0
009aeae4 : MOV dword ptr [EBP + -0x4],0x1
009aeaeb : PUSH 0x7fe
009aeaf0 : LEA EAX,[EBP + 0xffffeff2]
009aeaf6 : XOR EDX,EDX
009aeaf8 : PUSH EBX
009aeaf9 : PUSH EAX
009aeafa : MOV word ptr [EBP + 0xffffeff0],DX
009aeb01 : CALL 0x0063b700
009aeb06 : ADD ESP,0xc
009aeb09 : PUSH 0x7fe
009aeb0e : LEA EDX,[EBP + 0xfffff7f2]
009aeb14 : XOR ECX,ECX
009aeb16 : PUSH EBX
009aeb17 : PUSH EDX
009aeb18 : MOV word ptr [EBP + 0xfffff7f0],CX
009aeb1f : CALL 0x0063b700
009aeb24 : MOV EDI,0x8
009aeb29 : ADD ESP,0xc
009aeb2c : CMP dword ptr [ESI + 0x18],EDI
009aeb2f : JC 0x009aeb36
009aeb31 : MOV EAX,dword ptr [ESI + 0x4]
009aeb34 : JMP 0x009aeb39
009aeb36 : LEA EAX,[ESI + 0x4]
009aeb39 : PUSH EAX
009aeb3a : LEA EAX,[EBP + 0xffffeff0]
009aeb40 : PUSH 0x400
009aeb45 : PUSH EAX
009aeb46 : CALL 0x0063481b
009aeb4b : ADD ESP,0xc
009aeb4e : PUSH 0x400
009aeb53 : LEA EDX,[EBP + 0xfffff7f0]
009aeb59 : LEA ECX,[EBP + 0xffffeff0]
009aeb5f : CALL 0x006efb90
009aeb64 : LEA EAX,[EBP + 0xfffff7f0]
009aeb6a : ADD ESP,0x4
009aeb6d : LEA EDX,[EAX + 0x2]
009aeb70 : MOV CX,word ptr [EAX]
009aeb73 : ADD EAX,0x2
009aeb76 : CMP CX,BX
009aeb79 : JNZ 0x009aeb70
009aeb7b : SUB EAX,EDX
009aeb7d : SAR EAX,0x1
009aeb7f : PUSH EAX
009aeb80 : LEA ECX,[EBP + 0xfffff7f0]
009aeb86 : PUSH ECX
009aeb87 : MOV ECX,ESI
009aeb89 : CALL 0x00406360
009aeb8e : MOV byte ptr [EBP + -0x4],BL
009aeb91 : CMP dword ptr [EBP + 0xffffefec],EDI
009aeb97 : JC 0x009aeba4
009aeb99 : MOV ECX,dword ptr [EBP + 0xffffefd8]
009aeb9f : CALL 0x006f04e0
009aeba4 : XOR EDX,EDX
009aeba6 : MOV dword ptr [EBP + 0xffffefec],0x7
009aebb0 : MOV dword ptr [EBP + 0xffffefe8],EBX
009aebb6 : MOV word ptr [EBP + 0xffffefd8],DX
009aebbd : MOV EAX,ESI
009aebbf : MOV ECX,dword ptr [EBP + -0xc]
009aebc2 : MOV dword ptr FS:[0x0],ECX
009aebc9 : POP ECX
009aebca : POP EDI
009aebcb : POP EBX
009aebcc : MOV ECX,dword ptr [EBP + -0x10]
009aebcf : XOR ECX,EBP
009aebd1 : CALL 0x00633e6b
009aebd6 : MOV ESP,EBP
009aebd8 : POP EBP
009aebd9 : RET

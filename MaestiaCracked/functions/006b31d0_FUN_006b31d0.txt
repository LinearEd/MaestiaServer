PROGRAM  : Maestia.exe
FUNCTION : FUN_006b31d0
ENTRY    : 006b31d0
BODY     : [[006b31d0, 006b3355]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_006b31d0(int param_1,int param_2,int param_3,uint param_4)

{
  byte bVar1;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  uint uVar6;
  uint uVar7;
  int iVar8;
  int iVar9;
  
  iVar3 = *(int *)(param_1 + 0xc);
  bVar1 = *(byte *)(param_2 + 4);
  uVar7 = (uint)*(short *)(iVar3 + 0x16);
  if (((bVar1 & 200) != 0) && (param_4 < uVar7)) {
    iVar9 = *(int *)(iVar3 + 0x18) + param_4 * 8;
    iVar8 = uVar7 - param_4;
    do {
      FUN_00687440(iVar9,param_2 + 0x10);
      iVar9 = iVar9 + 8;
      iVar8 = iVar8 + -1;
    } while (iVar8 != 0);
  }
  if ((*(ushort *)(param_2 + 4) & 2) == 0) {
    uVar2 = *(int *)(param_2 + 8) + param_3;
    uVar6 = *(int *)(param_2 + 0xc) + param_4;
    if ((param_4 <= uVar2) || (uVar7 <= uVar6)) {
      return 0x15;
    }
    iVar3 = *(int *)(iVar3 + 0x18);
    uVar7 = *(int *)(iVar3 + uVar2 * 8) - *(int *)(iVar3 + uVar6 * 8);
    uVar2 = *(int *)(iVar3 + 4 + uVar2 * 8) - *(int *)(iVar3 + 4 + uVar6 * 8);
  }
  else {
    uVar7 = *(uint *)(param_2 + 8);
    uVar2 = *(uint *)(param_2 + 0xc);
    if ((uVar7 == 0) && (uVar2 == 0)) {
      return 0;
    }
    if (((bVar1 & 200) != 0) && ((*(ushort *)(param_2 + 4) & 0x800) != 0)) {
      uVar5 = *(undefined4 *)(param_2 + 0x14);
      iVar3 = FUN_00685ea0(*(undefined4 *)(param_2 + 0x10),*(undefined4 *)(param_2 + 0x10));
      iVar9 = FUN_00685ea0(uVar5,uVar5);
      uVar4 = FUN_006861b0(iVar3 + iVar9);
      uVar5 = *(undefined4 *)(param_2 + 0x1c);
      iVar3 = FUN_00685ea0(*(undefined4 *)(param_2 + 0x18),*(undefined4 *)(param_2 + 0x18));
      iVar9 = FUN_00685ea0(uVar5,uVar5);
      uVar5 = FUN_006861b0(iVar3 + iVar9);
      uVar7 = FUN_00685ea0(uVar7,uVar4);
      uVar2 = FUN_00685ea0(uVar2,uVar5);
    }
    if ((*(byte *)(param_1 + 0x10) & 1) == 0) {
      uVar5 = *(undefined4 *)(*(int *)(param_1 + 4) + 0x34);
      uVar7 = FUN_00685ea0(uVar7,*(undefined4 *)(*(int *)(param_1 + 4) + 0x30));
      uVar2 = FUN_00685ea0(uVar2,uVar5);
      if ((*(byte *)(param_2 + 4) & 4) != 0) {
        uVar7 = uVar7 + 0x20 & 0xffffffc0;
        uVar2 = uVar2 + 0x20 & 0xffffffc0;
      }
    }
  }
  if ((uVar7 != 0) || (uVar2 != 0)) {
    FUN_006b29a0();
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
006b31d0 : SUB ESP,0xc
006b31d3 : MOV EAX,dword ptr [ESP + 0x10]
006b31d7 : PUSH EBX
006b31d8 : MOV EBX,dword ptr [EAX + 0xc]
006b31db : PUSH EBP
006b31dc : MOV EBP,dword ptr [ESP + 0x1c]
006b31e0 : MOV AL,byte ptr [EBP + 0x4]
006b31e3 : PUSH ESI
006b31e4 : MOVSX ESI,word ptr [EBX + 0x16]
006b31e8 : PUSH EDI
006b31e9 : MOV EDI,dword ptr [EBX + 0x18]
006b31ec : AND AL,0xc8
006b31ee : MOV dword ptr [ESP + 0x18],EDI
006b31f2 : MOV dword ptr [ESP + 0x10],ESI
006b31f6 : MOV byte ptr [ESP + 0x24],AL
006b31fa : JZ 0x006b3229
006b31fc : MOV ECX,dword ptr [ESP + 0x2c]
006b3200 : CMP ECX,ESI
006b3202 : JNC 0x006b3229
006b3204 : LEA EDI,[EDI + ECX*0x8]
006b3207 : SUB ESI,ECX
006b3209 : LEA ESP,[ESP]
006b3210 : LEA EAX,[EBP + 0x10]
006b3213 : PUSH EAX
006b3214 : PUSH EDI
006b3215 : CALL 0x00687440
006b321a : ADD ESP,0x8
006b321d : ADD EDI,0x8
006b3220 : SUB ESI,0x1
006b3223 : JNZ 0x006b3210
006b3225 : MOV AL,byte ptr [ESP + 0x24]
006b3229 : MOVZX ECX,word ptr [EBP + 0x4]
006b322d : TEST CL,0x2
006b3230 : JNZ 0x006b326f
006b3232 : MOV EAX,dword ptr [EBP + 0x8]
006b3235 : MOV ECX,dword ptr [ESP + 0x2c]
006b3239 : ADD EAX,dword ptr [ESP + 0x28]
006b323d : MOV EBP,dword ptr [EBP + 0xc]
006b3240 : ADD EBP,ECX
006b3242 : CMP EAX,ECX
006b3244 : JNC 0x006b3262
006b3246 : CMP EBP,dword ptr [ESP + 0x10]
006b324a : JNC 0x006b3262
006b324c : MOV ECX,dword ptr [EBX + 0x18]
006b324f : MOV ESI,dword ptr [ECX + EAX*0x8]
006b3252 : MOV EDI,dword ptr [ECX + EAX*0x8 + 0x4]
006b3256 : SUB ESI,dword ptr [ECX + EBP*0x8]
006b3259 : SUB EDI,dword ptr [ECX + EBP*0x8 + 0x4]
006b325d : JMP 0x006b332e
006b3262 : POP EDI
006b3263 : POP ESI
006b3264 : POP EBP
006b3265 : MOV EAX,0x15
006b326a : POP EBX
006b326b : ADD ESP,0xc
006b326e : RET
006b326f : MOV ESI,dword ptr [EBP + 0x8]
006b3272 : MOV EDI,dword ptr [EBP + 0xc]
006b3275 : TEST ESI,ESI
006b3277 : JNZ 0x006b3281
006b3279 : TEST EDI,EDI
006b327b : JZ 0x006b334c
006b3281 : TEST AL,AL
006b3283 : JZ 0x006b32f4
006b3285 : TEST ECX,0x800
006b328b : JZ 0x006b32f4
006b328d : MOV EAX,dword ptr [EBP + 0x10]
006b3290 : MOV EBX,dword ptr [EBP + 0x14]
006b3293 : PUSH EAX
006b3294 : PUSH EAX
006b3295 : CALL 0x00685ea0
006b329a : PUSH EBX
006b329b : PUSH EBX
006b329c : MOV dword ptr [ESP + 0x34],EAX
006b32a0 : CALL 0x00685ea0
006b32a5 : MOV ECX,dword ptr [ESP + 0x34]
006b32a9 : ADD ECX,EAX
006b32ab : PUSH ECX
006b32ac : CALL 0x006861b0
006b32b1 : MOV EBX,dword ptr [EBP + 0x1c]
006b32b4 : MOV dword ptr [ESP + 0x28],EAX
006b32b8 : MOV EAX,dword ptr [EBP + 0x18]
006b32bb : PUSH EAX
006b32bc : PUSH EAX
006b32bd : CALL 0x00685ea0
006b32c2 : PUSH EBX
006b32c3 : PUSH EBX
006b32c4 : MOV dword ptr [ESP + 0x48],EAX
006b32c8 : CALL 0x00685ea0
006b32cd : MOV ECX,dword ptr [ESP + 0x48]
006b32d1 : ADD ECX,EAX
006b32d3 : PUSH ECX
006b32d4 : CALL 0x006861b0
006b32d9 : MOV ECX,dword ptr [ESP + 0x3c]
006b32dd : PUSH ECX
006b32de : PUSH ESI
006b32df : MOV EBX,EAX
006b32e1 : CALL 0x00685ea0
006b32e6 : PUSH EBX
006b32e7 : PUSH EDI
006b32e8 : MOV ESI,EAX
006b32ea : CALL 0x00685ea0
006b32ef : ADD ESP,0x38
006b32f2 : MOV EDI,EAX
006b32f4 : MOV EAX,dword ptr [ESP + 0x20]
006b32f8 : TEST byte ptr [EAX + 0x10],0x1
006b32fc : JNZ 0x006b332e
006b32fe : MOV EAX,dword ptr [EAX + 0x4]
006b3301 : MOV ECX,dword ptr [EAX + 0x30]
006b3304 : MOV EBX,dword ptr [EAX + 0x34]
006b3307 : PUSH ECX
006b3308 : PUSH ESI
006b3309 : CALL 0x00685ea0
006b330e : PUSH EBX
006b330f : PUSH EDI
006b3310 : MOV ESI,EAX
006b3312 : CALL 0x00685ea0
006b3317 : ADD ESP,0x10
006b331a : TEST byte ptr [EBP + 0x4],0x4
006b331e : MOV EDI,EAX
006b3320 : JZ 0x006b332e
006b3322 : ADD ESI,0x20
006b3325 : ADD EDI,0x20
006b3328 : AND ESI,0xffffffc0
006b332b : AND EDI,0xffffffc0
006b332e : TEST ESI,ESI
006b3330 : JNZ 0x006b3336
006b3332 : TEST EDI,EDI
006b3334 : JZ 0x006b334c
006b3336 : MOV EAX,dword ptr [ESP + 0x2c]
006b333a : MOV EDX,dword ptr [ESP + 0x18]
006b333e : LEA ECX,[EDX + EAX*0x8]
006b3341 : MOV EDX,dword ptr [ESP + 0x10]
006b3345 : SUB EDX,EAX
006b3347 : CALL 0x006b29a0
006b334c : POP EDI
006b334d : POP ESI
006b334e : POP EBP
006b334f : XOR EAX,EAX
006b3351 : POP EBX
006b3352 : ADD ESP,0xc
006b3355 : RET

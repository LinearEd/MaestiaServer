PROGRAM  : Maestia.exe
FUNCTION : FUN_004f7fb0
ENTRY    : 004f7fb0
BODY     : [[004f7fb0, 004f8149]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x004f80f9) */
/* WARNING: Removing unreachable block (ram,0x004f8100) */

void FUN_004f7fb0(int *param_1,ushort *param_2,int *param_3)

{
  int *piVar1;
  float fVar2;
  float fVar3;
  int in_EAX;
  int iVar4;
  int *piVar5;
  uint uVar6;
  
  iVar4 = FUN_004f8260();
  piVar5 = *(int **)(*(int *)(in_EAX + 0x14) + 4 + iVar4 * 4);
  if (piVar5 != *(int **)(*(int *)(in_EAX + 0x14) + iVar4 * 4)) {
    do {
      piVar5 = (int *)piVar5[1];
      if (*(ushort *)(piVar5 + 2) <= *param_2) {
        if (*param_2 <= *(ushort *)(piVar5 + 2)) {
          if (param_3 != *(int **)(in_EAX + 8)) {
            FUN_004f82f0(param_3);
          }
          *param_1 = (int)piVar5;
          *(undefined1 *)(param_1 + 1) = 0;
          return;
        }
        piVar5 = (int *)*piVar5;
        break;
      }
    } while (piVar5 != *(int **)(*(int *)(in_EAX + 0x14) + iVar4 * 4));
  }
  if (param_3 == *(int **)(in_EAX + 8)) {
    param_2 = (ushort *)FUN_004f8390(piVar5,piVar5[1]);
    FUN_004f8450();
    piVar5[1] = (int)param_2;
    **(int **)((int)param_2 + 4) = (int)param_2;
    param_3 = (int *)piVar5[1];
  }
  else if (((param_3 != *(int **)(in_EAX + 8)) && (piVar5 != param_3)) &&
          (piVar5 != (int *)*param_3)) {
    FUN_004f8330(piVar5,param_3,(int *)*param_3);
  }
  piVar1 = *(int **)(*(int *)(in_EAX + 0x14) + iVar4 * 4);
  while ((piVar5 == piVar1 && (*(int **)(*(int *)(in_EAX + 0x14) + iVar4 * 4) = param_3, iVar4 != 0)
         )) {
    iVar4 = iVar4 + -1;
    piVar1 = *(int **)(*(int *)(in_EAX + 0x14) + iVar4 * 4);
  }
  fVar2 = (float)*(int *)(in_EAX + 0xc);
  uVar6 = *(uint *)(in_EAX + 0x24);
  if (*(int *)(in_EAX + 0xc) < 0) {
    fVar2 = fVar2 + 4.2949673e+09;
  }
  fVar3 = (float)(int)uVar6;
  if ((int)uVar6 < 0) {
    fVar3 = fVar3 + 4.2949673e+09;
  }
  if (*(float *)(in_EAX + 0x28) < fVar2 / fVar3) {
    iVar4 = 0;
    do {
      if (0x1ffffffe < uVar6) break;
      iVar4 = iVar4 + 1;
      uVar6 = uVar6 * 2;
    } while (iVar4 < 3);
    param_2 = *(ushort **)(in_EAX + 8);
    if (*(int *)(in_EAX + 0x14) != *(int *)(in_EAX + 0x18)) {
      *(int *)(in_EAX + 0x18) = *(int *)(in_EAX + 0x14);
    }
    FUN_0044f580(in_EAX + 0x10,*(undefined4 *)(in_EAX + 0x14),&param_2);
    *(uint *)(in_EAX + 0x20) = uVar6 - 1;
    *(uint *)(in_EAX + 0x24) = uVar6;
    FUN_004f82b0();
  }
  *param_1 = (int)param_3;
  *(undefined1 *)(param_1 + 1) = 1;
  return;
}



============================================================
DISASSEMBLY
============================================================
004f7fb0 : PUSH EBP
004f7fb1 : MOV EBP,ESP
004f7fb3 : SUB ESP,0x8
004f7fb6 : PUSH EBX
004f7fb7 : PUSH ESI
004f7fb8 : PUSH EDI
004f7fb9 : MOV EDI,EAX
004f7fbb : MOV EAX,dword ptr [EBP + 0xc]
004f7fbe : MOV ESI,EDI
004f7fc0 : CALL 0x004f8260
004f7fc5 : MOV ESI,EAX
004f7fc7 : MOV EAX,dword ptr [EDI + 0x14]
004f7fca : MOV EBX,dword ptr [EAX + ESI*0x4 + 0x4]
004f7fce : LEA EAX,[EAX + ESI*0x4]
004f7fd1 : MOV dword ptr [EBP + -0x4],ESI
004f7fd4 : CMP EBX,dword ptr [EAX]
004f7fd6 : JZ 0x004f7ff1
004f7fd8 : MOV ECX,dword ptr [EBP + 0xc]
004f7fdb : MOVZX EAX,word ptr [ECX]
004f7fde : MOV EDI,EDI
004f7fe0 : MOV EBX,dword ptr [EBX + 0x4]
004f7fe3 : CMP word ptr [EBX + 0x8],AX
004f7fe7 : JBE 0x004f8021
004f7fe9 : MOV EDX,dword ptr [EDI + 0x14]
004f7fec : CMP EBX,dword ptr [EDX + ESI*0x4]
004f7fef : JNZ 0x004f7fe0
004f7ff1 : MOV EDX,dword ptr [EBP + 0x10]
004f7ff4 : CMP EDX,dword ptr [EDI + 0x8]
004f7ff7 : JZ 0x004f804d
004f7ff9 : CMP EDX,dword ptr [EDI + 0x8]
004f7ffc : LEA ECX,[EDI + 0x4]
004f7fff : JZ 0x004f8076
004f8001 : MOV EAX,dword ptr [EDX]
004f8003 : CMP ECX,ECX
004f8005 : JNZ 0x004f800f
004f8007 : CMP EBX,EDX
004f8009 : JZ 0x004f8076
004f800b : CMP EBX,EAX
004f800d : JZ 0x004f8076
004f800f : PUSH EAX
004f8010 : PUSH EDX
004f8011 : PUSH EBX
004f8012 : MOV ESI,ECX
004f8014 : CALL 0x004f8330
004f8019 : MOV EDX,dword ptr [EBP + 0x10]
004f801c : MOV ESI,dword ptr [EBP + -0x4]
004f801f : JMP 0x004f8076
004f8021 : JNC 0x004f8027
004f8023 : MOV EBX,dword ptr [EBX]
004f8025 : JMP 0x004f7ff1
004f8027 : MOV EAX,dword ptr [EBP + 0x10]
004f802a : CMP EAX,dword ptr [EDI + 0x8]
004f802d : JZ 0x004f803b
004f802f : LEA ESI,[EDI + 0x4]
004f8032 : PUSH EAX
004f8033 : LEA EDI,[EBP + 0xc]
004f8036 : CALL 0x004f82f0
004f803b : MOV EAX,dword ptr [EBP + 0x8]
004f803e : MOV dword ptr [EAX],EBX
004f8040 : MOV byte ptr [EAX + 0x4],0x0
004f8044 : POP EDI
004f8045 : POP ESI
004f8046 : POP EBX
004f8047 : MOV ESP,EBP
004f8049 : POP EBP
004f804a : RET 0xc
004f804d : MOV EAX,dword ptr [EBX + 0x4]
004f8050 : MOV ECX,dword ptr [EBP + 0xc]
004f8053 : PUSH EAX
004f8054 : PUSH EBX
004f8055 : CALL 0x004f8390
004f805a : LEA ECX,[EDI + 0x4]
004f805d : MOV dword ptr [EBP + 0xc],EAX
004f8060 : CALL 0x004f8450
004f8065 : MOV EAX,dword ptr [EBP + 0xc]
004f8068 : MOV dword ptr [EBX + 0x4],EAX
004f806b : MOV ECX,dword ptr [EAX + 0x4]
004f806e : MOV dword ptr [ECX],EAX
004f8070 : MOV EDX,dword ptr [EBX + 0x4]
004f8073 : MOV dword ptr [EBP + 0x10],EDX
004f8076 : MOV EAX,dword ptr [EDI + 0x14]
004f8079 : CMP EBX,dword ptr [EAX + ESI*0x4]
004f807c : JNZ 0x004f8099
004f807e : JMP 0x004f8083
004f8080 : MOV EDX,dword ptr [EBP + 0x10]
004f8083 : MOV ECX,dword ptr [EDI + 0x14]
004f8086 : MOV dword ptr [ECX + ESI*0x4],EDX
004f8089 : TEST ESI,ESI
004f808b : JZ 0x004f8096
004f808d : MOV EDX,dword ptr [EDI + 0x14]
004f8090 : DEC ESI
004f8091 : CMP EBX,dword ptr [EDX + ESI*0x4]
004f8094 : JZ 0x004f8080
004f8096 : MOV EDX,dword ptr [EBP + 0x10]
004f8099 : MOV EAX,dword ptr [EDI + 0xc]
004f809c : FILD dword ptr [EDI + 0xc]
004f809f : MOV ESI,dword ptr [EDI + 0x24]
004f80a2 : TEST EAX,EAX
004f80a4 : JGE 0x004f80ac
004f80a6 : FADD float ptr [0x00cdf0e0]
004f80ac : MOV ECX,ESI
004f80ae : MOV dword ptr [EBP + 0xc],ECX
004f80b1 : FILD dword ptr [EBP + 0xc]
004f80b4 : TEST ECX,ECX
004f80b6 : JGE 0x004f80be
004f80b8 : FADD float ptr [0x00cdf0e0]
004f80be : FDIVP
004f80c0 : FLD float ptr [EDI + 0x28]
004f80c3 : FXCH
004f80c5 : FCOMIP ST0,ST1
004f80c7 : FSTP ST0
004f80c9 : JBE 0x004f8138
004f80cb : XOR EAX,EAX
004f80cd : LEA ECX,[ECX]
004f80d0 : CMP ESI,0x1fffffff
004f80d6 : JNC 0x004f80e0
004f80d8 : INC EAX
004f80d9 : ADD ESI,ESI
004f80db : CMP EAX,0x3
004f80de : JL 0x004f80d0
004f80e0 : MOV EDX,dword ptr [EDI + 0x8]
004f80e3 : MOV ECX,dword ptr [EDI + 0x18]
004f80e6 : LEA EAX,[EDI + 0x10]
004f80e9 : MOV dword ptr [EBP + 0xc],EDX
004f80ec : MOV EDX,dword ptr [EAX + 0x4]
004f80ef : CMP EDX,ECX
004f80f1 : JZ 0x004f8114
004f80f3 : MOV EAX,ECX
004f80f5 : CMP ECX,ECX
004f80f7 : JZ 0x004f810e
004f80f9 : LEA ESP,[ESP]
004f8100 : MOV EBX,dword ptr [EAX]
004f8102 : MOV dword ptr [EDX],EBX
004f8104 : ADD EAX,0x4
004f8107 : ADD EDX,0x4
004f810a : CMP EAX,ECX
004f810c : JNZ 0x004f8100
004f810e : LEA EAX,[EDI + 0x10]
004f8111 : MOV dword ptr [EAX + 0x8],EDX
004f8114 : MOV EDX,dword ptr [EAX + 0x4]
004f8117 : LEA ECX,[EBP + 0xc]
004f811a : PUSH ECX
004f811b : PUSH EDX
004f811c : LEA ECX,[ESI + 0x1]
004f811f : PUSH EAX
004f8120 : CALL 0x0044f580
004f8125 : LEA EDX,[ESI + -0x1]
004f8128 : MOV ECX,EDI
004f812a : MOV dword ptr [EDI + 0x20],EDX
004f812d : MOV dword ptr [EDI + 0x24],ESI
004f8130 : CALL 0x004f82b0
004f8135 : MOV EDX,dword ptr [EBP + 0x10]
004f8138 : MOV EAX,dword ptr [EBP + 0x8]
004f813b : POP EDI
004f813c : POP ESI
004f813d : MOV dword ptr [EAX],EDX
004f813f : MOV byte ptr [EAX + 0x4],0x1
004f8143 : POP EBX
004f8144 : MOV ESP,EBP
004f8146 : POP EBP
004f8147 : RET 0xc

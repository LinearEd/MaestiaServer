PROGRAM  : Maestia.exe
FUNCTION : FUN_008ff610
ENTRY    : 008ff610
BODY     : [[008ff610, 008ff87f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008ff610(int param_1,undefined4 param_2)

{
  short sVar1;
  wchar_t wVar2;
  int *piVar3;
  short *psVar4;
  int iVar5;
  wchar_t *pwVar6;
  wchar_t *pwVar7;
  wchar_t *pwVar8;
  short *psVar9;
  bool bVar10;
  int *local_84;
  undefined1 local_80 [4];
  int local_7c;
  undefined4 local_78;
  undefined4 local_74;
  undefined1 local_70 [4];
  undefined2 local_6c;
  undefined4 local_5c;
  uint local_58;
  undefined1 local_54 [4];
  undefined2 local_50;
  undefined4 local_40;
  uint local_3c;
  undefined4 local_34;
  undefined4 local_24;
  uint local_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  int local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b60147;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)&local_84;
  ExceptionList = &local_14;
  FUN_00403dd0(param_2,DAT_00d66fa0 ^ (uint)&stack0xffffff70);
  local_c = 0;
  local_3c = 7;
  local_40 = 0;
  local_50 = 0;
  FUN_00406360(&DAT_00c62a20,1);
  local_c._0_1_ = 1;
  psVar9 = local_34;
  if (local_20 < 8) {
    psVar9 = (short *)&local_34;
  }
  local_58 = 7;
  local_5c = 0;
  local_6c = 0;
  psVar4 = psVar9;
  do {
    sVar1 = *psVar4;
    psVar4 = psVar4 + 1;
  } while (sVar1 != 0);
  FUN_00406360(psVar9,(int)psVar4 - (int)(psVar9 + 1) >> 1);
  local_c._0_1_ = 2;
  FUN_0070cd60(local_80,local_70,local_54,0);
  piVar3 = local_84;
  local_c = CONCAT31(local_c._1_3_,4);
  if (7 < local_58) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_58 = 7;
  local_5c = 0;
  local_6c = 0;
  local_c._0_1_ = 5;
  if (7 < local_3c) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_50 = 0;
  local_3c = 7;
  local_40 = 0;
  pwVar6 = (wchar_t *)(param_1 + 4);
  pwVar8 = pwVar6;
  if (7 < *(uint *)(param_1 + 0x18)) {
    pwVar8 = *(wchar_t **)pwVar6;
  }
  pwVar7 = L"onInit";
  do {
    wVar2 = *pwVar8;
    bVar10 = (ushort)wVar2 < (ushort)*pwVar7;
    if (wVar2 != *pwVar7) {
LAB_008ff786:
      iVar5 = (1 - (uint)bVar10) - (uint)(bVar10 != 0);
      goto LAB_008ff78b;
    }
    if (wVar2 == L'\0') break;
    wVar2 = pwVar8[1];
    bVar10 = (ushort)wVar2 < (ushort)pwVar7[1];
    if (wVar2 != pwVar7[1]) goto LAB_008ff786;
    pwVar8 = pwVar8 + 2;
    pwVar7 = pwVar7 + 2;
  } while (wVar2 != L'\0');
  iVar5 = 0;
LAB_008ff78b:
  if (iVar5 == 0) {
    if ((short)local_84[0xf] != 0) {
      FUN_008ff140(local_84 + 0xe);
      *(undefined1 *)((int)piVar3 + 0x3f) = 0;
    }
  }
  else {
    if (7 < *(uint *)(param_1 + 0x18)) {
      pwVar6 = *(wchar_t **)pwVar6;
    }
    pwVar8 = L"Close";
    do {
      wVar2 = *pwVar6;
      bVar10 = (ushort)wVar2 < (ushort)*pwVar8;
      if (wVar2 != *pwVar8) {
LAB_008ff7e6:
        iVar5 = (1 - (uint)bVar10) - (uint)(bVar10 != 0);
        goto LAB_008ff7eb;
      }
      if (wVar2 == L'\0') break;
      wVar2 = pwVar6[1];
      bVar10 = (ushort)wVar2 < (ushort)pwVar8[1];
      if (wVar2 != pwVar8[1]) goto LAB_008ff7e6;
      pwVar6 = pwVar6 + 2;
      pwVar8 = pwVar8 + 2;
    } while (wVar2 != L'\0');
    iVar5 = 0;
LAB_008ff7eb:
    if (iVar5 == 0) {
      (**(code **)(*local_84 + 0x20))();
    }
  }
  local_c = (uint)local_c._1_3_ << 8;
  if (local_7c != 0) {
    FUN_00405450(local_84);
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_7c = 0;
  local_78 = 0;
  local_74 = 0;
  local_c = 0xffffffff;
  if (local_20 < 8) {
    local_20 = 7;
    local_24 = 0;
    local_34 = (short *)((uint)local_34._2_2_ << 0x10);
    ExceptionList = local_14;
    __security_check_cookie(local_1c ^ (uint)&local_84);
    return;
  }
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
008ff610 : PUSH EBP
008ff611 : MOV EBP,ESP
008ff613 : AND ESP,0xfffffff8
008ff616 : PUSH -0x1
008ff618 : PUSH 0xb60147
008ff61d : MOV EAX,FS:[0x0]
008ff623 : PUSH EAX
008ff624 : SUB ESP,0x70
008ff627 : MOV EAX,[0x00d66fa0]
008ff62c : XOR EAX,ESP
008ff62e : MOV dword ptr [ESP + 0x68],EAX
008ff632 : PUSH EBX
008ff633 : PUSH ESI
008ff634 : PUSH EDI
008ff635 : MOV EAX,[0x00d66fa0]
008ff63a : XOR EAX,ESP
008ff63c : PUSH EAX
008ff63d : LEA EAX,[ESP + 0x80]
008ff644 : MOV FS:[0x0],EAX
008ff64a : MOV EAX,dword ptr [EBP + 0xc]
008ff64d : PUSH EAX
008ff64e : LEA ESI,[ESP + 0x60]
008ff652 : MOV dword ptr [ESP + 0x14],ECX
008ff656 : CALL 0x00403dd0
008ff65b : ADD ESP,0x4
008ff65e : XOR EBX,EBX
008ff660 : MOV dword ptr [ESP + 0x88],EBX
008ff667 : PUSH 0x1
008ff669 : XOR EAX,EAX
008ff66b : MOV EDI,0x7
008ff670 : PUSH 0xc62a20
008ff675 : LEA ECX,[ESP + 0x48]
008ff679 : MOV dword ptr [ESP + 0x60],EDI
008ff67d : MOV dword ptr [ESP + 0x5c],EBX
008ff681 : MOV word ptr [ESP + 0x4c],AX
008ff686 : CALL 0x00406360
008ff68b : MOV byte ptr [ESP + 0x88],0x1
008ff693 : CMP dword ptr [ESP + 0x74],0x8
008ff698 : MOV EDX,dword ptr [ESP + 0x60]
008ff69c : JNC 0x008ff6a2
008ff69e : LEA EDX,[ESP + 0x60]
008ff6a2 : XOR ECX,ECX
008ff6a4 : MOV EAX,EDX
008ff6a6 : MOV dword ptr [ESP + 0x3c],EDI
008ff6aa : MOV dword ptr [ESP + 0x38],EBX
008ff6ae : MOV word ptr [ESP + 0x28],CX
008ff6b3 : LEA ESI,[EAX + 0x2]
008ff6b6 : MOV CX,word ptr [EAX]
008ff6b9 : ADD EAX,0x2
008ff6bc : CMP CX,BX
008ff6bf : JNZ 0x008ff6b6
008ff6c1 : SUB EAX,ESI
008ff6c3 : SAR EAX,0x1
008ff6c5 : PUSH EAX
008ff6c6 : PUSH EDX
008ff6c7 : LEA ECX,[ESP + 0x2c]
008ff6cb : CALL 0x00406360
008ff6d0 : MOV byte ptr [ESP + 0x88],0x2
008ff6d8 : PUSH EBX
008ff6d9 : LEA EDX,[ESP + 0x44]
008ff6dd : PUSH EDX
008ff6de : LEA EAX,[ESP + 0x2c]
008ff6e2 : PUSH EAX
008ff6e3 : LEA ECX,[ESP + 0x20]
008ff6e7 : PUSH ECX
008ff6e8 : CALL 0x0070cd60
008ff6ed : ADD ESP,0x10
008ff6f0 : MOV byte ptr [ESP + 0x88],0x4
008ff6f8 : MOV ESI,0x8
008ff6fd : CMP dword ptr [ESP + 0x3c],ESI
008ff701 : JC 0x008ff70c
008ff703 : MOV ECX,dword ptr [ESP + 0x28]
008ff707 : CALL 0x006f04e0
008ff70c : XOR EDX,EDX
008ff70e : MOV dword ptr [ESP + 0x3c],EDI
008ff712 : MOV dword ptr [ESP + 0x38],EBX
008ff716 : MOV word ptr [ESP + 0x28],DX
008ff71b : MOV byte ptr [ESP + 0x88],0x5
008ff723 : CMP dword ptr [ESP + 0x58],ESI
008ff727 : JC 0x008ff732
008ff729 : MOV ECX,dword ptr [ESP + 0x44]
008ff72d : CALL 0x006f04e0
008ff732 : XOR EAX,EAX
008ff734 : MOV word ptr [ESP + 0x44],AX
008ff739 : MOV EAX,dword ptr [EBP + 0x8]
008ff73c : MOV dword ptr [ESP + 0x58],EDI
008ff740 : MOV EDI,dword ptr [EAX + 0x18]
008ff743 : MOV dword ptr [ESP + 0x54],EBX
008ff747 : LEA ESI,[EAX + 0x4]
008ff74a : CMP EDI,0x8
008ff74d : JC 0x008ff753
008ff74f : MOV EAX,dword ptr [ESI]
008ff751 : JMP 0x008ff755
008ff753 : MOV EAX,ESI
008ff755 : MOV ECX,0xc62a24
008ff75a : LEA EBX,[EBX]
008ff760 : MOV DX,word ptr [EAX]
008ff763 : CMP DX,word ptr [ECX]
008ff766 : JNZ 0x008ff786
008ff768 : CMP DX,BX
008ff76b : JZ 0x008ff782
008ff76d : MOV DX,word ptr [EAX + 0x2]
008ff771 : CMP DX,word ptr [ECX + 0x2]
008ff775 : JNZ 0x008ff786
008ff777 : ADD EAX,0x4
008ff77a : ADD ECX,0x4
008ff77d : CMP DX,BX
008ff780 : JNZ 0x008ff760
008ff782 : XOR EAX,EAX
008ff784 : JMP 0x008ff78b
008ff786 : SBB EAX,EAX
008ff788 : SBB EAX,-0x1
008ff78b : CMP EAX,EBX
008ff78d : JNZ 0x008ff7a9
008ff78f : MOV ESI,dword ptr [ESP + 0x10]
008ff793 : CMP word ptr [ESI + 0x3c],BX
008ff797 : JBE 0x008ff7fa
008ff799 : LEA ECX,[ESI + 0x38]
008ff79c : PUSH ECX
008ff79d : MOV ECX,ESI
008ff79f : CALL 0x008ff140
008ff7a4 : MOV byte ptr [ESI + 0x3f],BL
008ff7a7 : JMP 0x008ff7fa
008ff7a9 : CMP EDI,0x8
008ff7ac : JC 0x008ff7b2
008ff7ae : MOV EAX,dword ptr [ESI]
008ff7b0 : JMP 0x008ff7b4
008ff7b2 : MOV EAX,ESI
008ff7b4 : MOV ECX,0xc62a34
008ff7b9 : LEA ESP,[ESP]
008ff7c0 : MOV DX,word ptr [EAX]
008ff7c3 : CMP DX,word ptr [ECX]
008ff7c6 : JNZ 0x008ff7e6
008ff7c8 : CMP DX,BX
008ff7cb : JZ 0x008ff7e2
008ff7cd : MOV DX,word ptr [EAX + 0x2]
008ff7d1 : CMP DX,word ptr [ECX + 0x2]
008ff7d5 : JNZ 0x008ff7e6
008ff7d7 : ADD EAX,0x4
008ff7da : ADD ECX,0x4
008ff7dd : CMP DX,BX
008ff7e0 : JNZ 0x008ff7c0
008ff7e2 : XOR EAX,EAX
008ff7e4 : JMP 0x008ff7eb
008ff7e6 : SBB EAX,EAX
008ff7e8 : SBB EAX,-0x1
008ff7eb : CMP EAX,EBX
008ff7ed : JNZ 0x008ff7fa
008ff7ef : MOV ECX,dword ptr [ESP + 0x10]
008ff7f3 : MOV EDX,dword ptr [ECX]
008ff7f5 : MOV EAX,dword ptr [EDX + 0x20]
008ff7f8 : CALL EAX
008ff7fa : MOV byte ptr [ESP + 0x88],BL
008ff801 : MOV EAX,dword ptr [ESP + 0x18]
008ff805 : CMP EAX,EBX
008ff807 : JZ 0x008ff823
008ff809 : MOV ECX,dword ptr [ESP + 0x10]
008ff80d : MOV EDI,dword ptr [ESP + 0x1c]
008ff811 : PUSH ECX
008ff812 : CALL 0x00405450
008ff817 : MOV ECX,dword ptr [ESP + 0x1c]
008ff81b : ADD ESP,0x4
008ff81e : CALL 0x006f04e0
008ff823 : MOV dword ptr [ESP + 0x18],EBX
008ff827 : MOV dword ptr [ESP + 0x1c],EBX
008ff82b : MOV dword ptr [ESP + 0x20],EBX
008ff82f : MOV dword ptr [ESP + 0x88],0xffffffff
008ff83a : CMP dword ptr [ESP + 0x74],0x8
008ff83f : JC 0x008ff84a
008ff841 : MOV ECX,dword ptr [ESP + 0x60]
008ff845 : CALL 0x006f04e0
008ff84a : XOR EDX,EDX
008ff84c : MOV dword ptr [ESP + 0x74],0x7
008ff854 : MOV dword ptr [ESP + 0x70],EBX
008ff858 : MOV word ptr [ESP + 0x60],DX
008ff85d : MOV ECX,dword ptr [ESP + 0x80]
008ff864 : MOV dword ptr FS:[0x0],ECX
008ff86b : POP ECX
008ff86c : POP EDI
008ff86d : POP ESI
008ff86e : POP EBX
008ff86f : MOV ECX,dword ptr [ESP + 0x68]
008ff873 : XOR ECX,ESP
008ff875 : CALL 0x00633e6b
008ff87a : MOV ESP,EBP
008ff87c : POP EBP
008ff87d : RET 0x8

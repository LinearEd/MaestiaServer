PROGRAM  : Maestia.exe
FUNCTION : FUN_00999270
ENTRY    : 00999270
BODY     : [[00999270, 009994af]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00999270(undefined2 param_1)

{
  wchar_t wVar1;
  int iVar2;
  ushort ****ppppuVar3;
  undefined4 uVar4;
  int in_ECX;
  wchar_t *pwVar5;
  undefined4 *puVar6;
  int in_EDX;
  bool bVar7;
  undefined4 local_48;
  undefined4 local_38;
  uint local_34;
  undefined1 local_30 [4];
  ushort ***local_2c [4];
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b60abb;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (((*(char *)(in_ECX + 0x32) != '\0') &&
      ((*(int *)(in_ECX + 0x38) != 1 || (*(char *)(in_EDX + 0x60) == '\0')))) &&
     ((*(int *)(in_ECX + 0x38) != 3 || (*(char *)(in_EDX + 0x60) != '\0')))) {
    FUN_00999140(local_30,*(int *)(in_EDX + 0x10) == 0,local_14);
    local_8 = 0;
    iVar2 = *(int *)(in_EDX + 0xc);
    if (((iVar2 == 0xffff) || (iVar2 == 0xfffd)) || (iVar2 == 0xfffe)) {
      *(undefined2 *)(in_EDX + 0x18) = 0xff;
      *(undefined1 *)(in_EDX + 10) = 0;
      *(undefined4 *)(in_EDX + 4) = 0;
      *(undefined2 *)(in_EDX + 8) = 0;
    }
    if ((*(ushort *)(in_EDX + 0x18) != 0xff) && (iVar2 != 0xffff)) {
      ppppuVar3 = (ushort ****)local_2c[0];
      if (local_18 < 8) {
        ppppuVar3 = local_2c;
      }
      pwVar5 = L"$unconnection";
      do {
        wVar1 = *(wchar_t *)ppppuVar3;
        bVar7 = (ushort)wVar1 < (ushort)*pwVar5;
        if (wVar1 != *pwVar5) {
LAB_00999366:
          iVar2 = (1 - (uint)bVar7) - (uint)(bVar7 != 0);
          goto LAB_0099936b;
        }
        if (wVar1 == L'\0') break;
        wVar1 = *(wchar_t *)((int)ppppuVar3 + 2);
        bVar7 = (ushort)wVar1 < (ushort)pwVar5[1];
        if (wVar1 != pwVar5[1]) goto LAB_00999366;
        ppppuVar3 = ppppuVar3 + 1;
        pwVar5 = pwVar5 + 2;
      } while (wVar1 != L'\0');
      iVar2 = 0;
LAB_0099936b:
      if (iVar2 != 0) {
        ppppuVar3 = (ushort ****)local_2c[0];
        if (local_18 < 8) {
          ppppuVar3 = local_2c;
        }
        uVar4 = FUN_00404750(L"%s(CH%d)",ppppuVar3,*(ushort *)(in_EDX + 0x18) + 1);
        local_8._0_1_ = 1;
        FUN_00405eb0(uVar4,0,0xffffffff);
        local_8 = (uint)local_8._1_3_ << 8;
        FUN_00406560();
      }
    }
    if (*(int *)(in_EDX + 0xc) == 0xffff) {
      FUN_00405eb0(in_EDX + 0x44,0,0xffffffff);
    }
    local_34 = 7;
    local_38 = 0;
    local_48 = (undefined4 *)((uint)local_48._2_2_ << 0x10);
    local_8 = CONCAT31(local_8._1_3_,2);
    FUN_00405eb0(in_EDX + 0x28,0,0xffffffff);
    iVar2 = *DAT_00da9894;
    if ((iVar2 != 0) && (*(int *)(iVar2 + 0x114) != 0)) {
      ppppuVar3 = (ushort ****)local_2c[0];
      if (local_18 < 8) {
        ppppuVar3 = local_2c;
      }
      puVar6 = local_48;
      if (local_34 < 8) {
        puVar6 = &local_48;
      }
      (**(code **)(**(int **)(iVar2 + 0x114) + 4))
                (*(int **)(iVar2 + 0x114),"mc_friendPopup.InsertFriend","%d,%ls,%ls,%d,%d,%d,%d",
                 param_1,puVar6,ppppuVar3,*(undefined1 *)(in_EDX + 10),*(undefined2 *)(in_EDX + 8),
                 *(undefined2 *)(in_EDX + 4),*(undefined1 *)(in_EDX + 0x60));
    }
    local_8 = local_8 & 0xffffff00;
    if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_34 = 7;
    local_38 = 0;
    local_48 = (undefined4 *)((uint)local_48 & 0xffff0000);
    local_8 = 0xffffffff;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c[0] = (ushort ***)((uint)local_2c[0] & 0xffff0000);
  }
  local_8 = 0xffffffff;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00999270 : PUSH EBP
00999271 : MOV EBP,ESP
00999273 : PUSH -0x1
00999275 : PUSH 0xb60abb
0099927a : MOV EAX,FS:[0x0]
00999280 : PUSH EAX
00999281 : SUB ESP,0x58
00999284 : MOV EAX,[0x00d66fa0]
00999289 : XOR EAX,EBP
0099928b : MOV dword ptr [EBP + -0x10],EAX
0099928e : PUSH EBX
0099928f : PUSH ESI
00999290 : PUSH EDI
00999291 : PUSH EAX
00999292 : LEA EAX,[EBP + -0xc]
00999295 : MOV FS:[0x0],EAX
0099929b : MOV AL,byte ptr [ECX + 0x32]
0099929e : XOR EBX,EBX
009992a0 : MOV EDI,EDX
009992a2 : CMP AL,BL
009992a4 : JZ 0x00999492
009992aa : MOV ECX,dword ptr [ECX + 0x38]
009992ad : CMP ECX,0x1
009992b0 : JNZ 0x009992bb
009992b2 : CMP byte ptr [EDI + 0x60],BL
009992b5 : JNZ 0x00999492
009992bb : CMP ECX,0x3
009992be : JNZ 0x009992c9
009992c0 : CMP byte ptr [EDI + 0x60],BL
009992c3 : JZ 0x00999492
009992c9 : XOR EAX,EAX
009992cb : CMP dword ptr [EDI + 0x10],EBX
009992ce : LEA ECX,[EBP + -0x2c]
009992d1 : SETZ AL
009992d4 : PUSH EAX
009992d5 : PUSH ECX
009992d6 : MOV CX,word ptr [EDI + 0xc]
009992da : CALL 0x00999140
009992df : ADD ESP,0x8
009992e2 : MOV dword ptr [EBP + -0x4],EBX
009992e5 : MOV EAX,dword ptr [EDI + 0xc]
009992e8 : CMP EAX,0xffff
009992ed : JZ 0x009992fd
009992ef : CMP EAX,0xfffd
009992f4 : JZ 0x009992fd
009992f6 : CMP EAX,0xfffe
009992fb : JNZ 0x00999312
009992fd : MOV EDX,0xff
00999302 : XOR ECX,ECX
00999304 : MOV word ptr [EDI + 0x18],DX
00999308 : MOV byte ptr [EDI + 0xa],BL
0099930b : MOV dword ptr [EDI + 0x4],EBX
0099930e : MOV word ptr [EDI + 0x8],CX
00999312 : MOVZX ESI,word ptr [EDI + 0x18]
00999316 : MOV EDX,0xff
0099931b : CMP SI,DX
0099931e : JZ 0x009993ab
00999324 : CMP EAX,0xffff
00999329 : JZ 0x009993ab
0099932f : CMP dword ptr [EBP + -0x14],0x8
00999333 : MOV EAX,dword ptr [EBP + -0x28]
00999336 : JNC 0x0099933b
00999338 : LEA EAX,[EBP + -0x28]
0099933b : MOV ECX,0xc87670
00999340 : MOV DX,word ptr [EAX]
00999343 : CMP DX,word ptr [ECX]
00999346 : JNZ 0x00999366
00999348 : CMP DX,BX
0099934b : JZ 0x00999362
0099934d : MOV DX,word ptr [EAX + 0x2]
00999351 : CMP DX,word ptr [ECX + 0x2]
00999355 : JNZ 0x00999366
00999357 : ADD EAX,0x4
0099935a : ADD ECX,0x4
0099935d : CMP DX,BX
00999360 : JNZ 0x00999340
00999362 : XOR EAX,EAX
00999364 : JMP 0x0099936b
00999366 : SBB EAX,EAX
00999368 : SBB EAX,-0x1
0099936b : CMP EAX,EBX
0099936d : JZ 0x009993ab
0099936f : CMP dword ptr [EBP + -0x14],0x8
00999373 : MOV EAX,dword ptr [EBP + -0x28]
00999376 : JNC 0x0099937b
00999378 : LEA EAX,[EBP + -0x28]
0099937b : MOVZX ECX,SI
0099937e : INC ECX
0099937f : PUSH ECX
00999380 : PUSH EAX
00999381 : PUSH 0xc8768c
00999386 : LEA ESI,[EBP + -0x64]
00999389 : CALL 0x00404750
0099938e : ADD ESP,0xc
00999391 : MOV byte ptr [EBP + -0x4],0x1
00999395 : PUSH -0x1
00999397 : PUSH EBX
00999398 : PUSH EAX
00999399 : LEA ECX,[EBP + -0x2c]
0099939c : CALL 0x00405eb0
009993a1 : MOV byte ptr [EBP + -0x4],BL
009993a4 : MOV ECX,ESI
009993a6 : CALL 0x00406560
009993ab : CMP dword ptr [EDI + 0xc],0xffff
009993b2 : JNZ 0x009993c3
009993b4 : PUSH -0x1
009993b6 : PUSH EBX
009993b7 : LEA EDX,[EDI + 0x44]
009993ba : PUSH EDX
009993bb : LEA ECX,[EBP + -0x2c]
009993be : CALL 0x00405eb0
009993c3 : MOV ESI,0x7
009993c8 : XOR EAX,EAX
009993ca : MOV dword ptr [EBP + -0x30],ESI
009993cd : MOV dword ptr [EBP + -0x34],EBX
009993d0 : MOV word ptr [EBP + -0x44],AX
009993d4 : MOV byte ptr [EBP + -0x4],0x2
009993d8 : PUSH -0x1
009993da : PUSH EBX
009993db : LEA ECX,[EDI + 0x28]
009993de : PUSH ECX
009993df : LEA ECX,[EBP + -0x48]
009993e2 : CALL 0x00405eb0
009993e7 : MOV EDX,dword ptr [0x00da9894]
009993ed : MOV EAX,dword ptr [EDX]
009993ef : CMP EAX,EBX
009993f1 : JZ 0x00999451
009993f3 : CMP dword ptr [EAX + 0x114],EBX
009993f9 : JZ 0x00999451
009993fb : MOV EAX,dword ptr [EAX + 0x114]
00999401 : MOV EDX,dword ptr [EBP + -0x28]
00999404 : MOV ECX,0x8
00999409 : CMP dword ptr [EBP + -0x14],ECX
0099940c : JNC 0x00999411
0099940e : LEA EDX,[EBP + -0x28]
00999411 : CMP dword ptr [EBP + -0x30],ECX
00999414 : MOV ECX,dword ptr [EBP + -0x44]
00999417 : JNC 0x0099941c
00999419 : LEA ECX,[EBP + -0x44]
0099941c : MOVZX EBX,byte ptr [EDI + 0x60]
00999420 : PUSH EBX
00999421 : MOVZX EBX,word ptr [EDI + 0x4]
00999425 : MOV ESI,dword ptr [EAX]
00999427 : PUSH EBX
00999428 : MOVZX EBX,word ptr [EDI + 0x8]
0099942c : MOVZX EDI,byte ptr [EDI + 0xa]
00999430 : PUSH EBX
00999431 : PUSH EDI
00999432 : PUSH EDX
00999433 : MOV EDX,dword ptr [ESI + 0x4]
00999436 : PUSH ECX
00999437 : MOVZX ECX,word ptr [EBP + 0x8]
0099943b : PUSH ECX
0099943c : PUSH 0xc876a0
00999441 : PUSH 0xc876b8
00999446 : PUSH EAX
00999447 : CALL EDX
00999449 : ADD ESP,0x28
0099944c : XOR EBX,EBX
0099944e : LEA ESI,[EBX + 0x7]
00999451 : MOV byte ptr [EBP + -0x4],BL
00999454 : MOV EDI,0x8
00999459 : CMP dword ptr [EBP + -0x30],EDI
0099945c : JC 0x00999466
0099945e : MOV ECX,dword ptr [EBP + -0x44]
00999461 : CALL 0x006f04e0
00999466 : XOR EAX,EAX
00999468 : MOV dword ptr [EBP + -0x30],ESI
0099946b : MOV dword ptr [EBP + -0x34],EBX
0099946e : MOV word ptr [EBP + -0x44],AX
00999472 : MOV dword ptr [EBP + -0x4],0xffffffff
00999479 : CMP dword ptr [EBP + -0x14],EDI
0099947c : JC 0x00999486
0099947e : MOV ECX,dword ptr [EBP + -0x28]
00999481 : CALL 0x006f04e0
00999486 : XOR ECX,ECX
00999488 : MOV dword ptr [EBP + -0x14],ESI
0099948b : MOV dword ptr [EBP + -0x18],EBX
0099948e : MOV word ptr [EBP + -0x28],CX
00999492 : MOV ECX,dword ptr [EBP + -0xc]
00999495 : MOV dword ptr FS:[0x0],ECX
0099949c : POP ECX
0099949d : POP EDI
0099949e : POP ESI
0099949f : POP EBX
009994a0 : MOV ECX,dword ptr [EBP + -0x10]
009994a3 : XOR ECX,EBP
009994a5 : CALL 0x00633e6b
009994aa : MOV ESP,EBP
009994ac : POP EBP
009994ad : RET 0x4

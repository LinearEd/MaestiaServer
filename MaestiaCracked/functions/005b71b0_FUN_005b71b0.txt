PROGRAM  : Maestia.exe
FUNCTION : FUN_005b71b0
ENTRY    : 005b71b0
BODY     : [[005b71b0, 005b7360]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005b71b0(int *param_1)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  int *piVar4;
  int *piVar5;
  byte bVar6;
  int *piVar7;
  undefined4 uVar8;
  int *in_ECX;
  int iVar9;
  undefined4 *puVar10;
  undefined4 *puVar11;
  undefined4 unaff_retaddr;
  int local_54;
  uint local_4c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20 [8];
  
  if (*(int *)(in_ECX[0x27] + 0x1c) != 0) {
    iVar1 = param_1[8];
    puVar2 = (undefined4 *)param_1[0x11];
    puVar3 = (undefined4 *)param_1[0x10];
    param_1[8] = *(int *)(in_ECX[0x1f] + 0x1c) + 0x18;
    piVar4 = *(int **)(*param_1 + 0xc);
    iVar9 = in_ECX[0x27];
    local_4c = 0;
    if (*(int *)(iVar9 + 0x1c) != 0) {
      local_54 = 0;
      do {
        piVar7 = (int *)(*(int *)(iVar9 + 0x18) + local_54);
        piVar5 = *(int **)(in_ECX[0x29] + local_4c * 4);
        if (piVar5 != (int *)0x0) {
          iVar9 = in_ECX[0x2e];
          if (iVar9 == 0) {
            bVar6 = *(byte *)(piVar7 + 0x12) & 8;
          }
          else if (iVar9 == 1) {
            bVar6 = *(byte *)(piVar7 + 0x12) & 2;
          }
          else {
            if (iVar9 != 2) goto LAB_005b7324;
            bVar6 = *(byte *)(piVar7 + 0x12) & 4;
          }
          if (bVar6 != 0) {
            local_38 = *puVar3;
            local_34 = puVar3[1];
            local_30 = puVar3[2];
            local_2c = puVar3[3];
            local_28 = puVar3[4];
            local_24 = puVar3[5];
            GMatrix2D::Prepend((GMatrix2D *)&local_38,(GMatrix2D *)(in_ECX + 0x11));
            param_1[0x10] = (int)&local_38;
            puVar10 = puVar2;
            puVar11 = local_20;
            for (iVar9 = 8; iVar9 != 0; iVar9 = iVar9 + -1) {
              *puVar11 = *puVar10;
              puVar10 = puVar10 + 1;
              puVar11 = puVar11 + 1;
            }
            FUN_0059cfa0(in_ECX + 9);
            param_1[0x11] = (int)local_20;
            if (*piVar7 != 0) {
              (**(code **)(*piVar5 + 0x1c))(*piVar7);
            }
            iVar9 = *piVar4;
            uVar8 = (**(code **)(*piVar5 + 0xc))();
            (**(code **)(iVar9 + 0x2c))(uVar8);
            (**(code **)(*piVar5 + 0x60))(unaff_retaddr);
            (**(code **)(*piVar4 + 0x30))();
          }
        }
LAB_005b7324:
        iVar9 = in_ECX[0x27];
        local_54 = local_54 + 0x4c;
        local_4c = local_4c + 1;
      } while (local_4c < *(uint *)(iVar9 + 0x1c));
    }
    param_1[8] = iVar1;
    param_1[0x10] = (int)puVar3;
    param_1[0x11] = (int)puVar2;
    (**(code **)(*in_ECX + 0xf4))();
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005b71b0 : SUB ESP,0x54
005b71b3 : PUSH EBP
005b71b4 : MOV EBP,ECX
005b71b6 : MOV EAX,dword ptr [EBP + 0x9c]
005b71bc : CMP dword ptr [EAX + 0x1c],0x0
005b71c0 : JZ 0x005b735a
005b71c6 : MOV EDX,dword ptr [EBP + 0x7c]
005b71c9 : MOV EAX,dword ptr [EDX + 0x1c]
005b71cc : PUSH EBX
005b71cd : PUSH ESI
005b71ce : PUSH EDI
005b71cf : MOV EDI,dword ptr [ESP + 0x68]
005b71d3 : MOV ECX,dword ptr [EDI + 0x20]
005b71d6 : MOV ESI,dword ptr [EDI + 0x44]
005b71d9 : MOV EBX,dword ptr [EDI + 0x40]
005b71dc : ADD EAX,0x18
005b71df : MOV dword ptr [ESP + 0x28],ECX
005b71e3 : MOV ECX,dword ptr [EDI]
005b71e5 : MOV dword ptr [EDI + 0x20],EAX
005b71e8 : MOV EDX,dword ptr [ECX + 0xc]
005b71eb : MOV EAX,dword ptr [EBP + 0x9c]
005b71f1 : XOR ECX,ECX
005b71f3 : MOV dword ptr [ESP + 0x20],EDX
005b71f7 : MOV dword ptr [ESP + 0x24],ESI
005b71fb : MOV dword ptr [ESP + 0x18],ECX
005b71ff : CMP dword ptr [EAX + 0x1c],ECX
005b7202 : JBE 0x005b733d
005b7208 : MOV dword ptr [ESP + 0x10],ECX
005b720c : LEA ESP,[ESP]
005b7210 : MOV EAX,dword ptr [EAX + 0x18]
005b7213 : MOV EDX,dword ptr [EBP + 0xa4]
005b7219 : ADD EAX,dword ptr [ESP + 0x10]
005b721d : MOV EDX,dword ptr [EDX + ECX*0x4]
005b7220 : MOV dword ptr [ESP + 0x1c],EAX
005b7224 : MOV dword ptr [ESP + 0x14],EDX
005b7228 : TEST EDX,EDX
005b722a : JZ 0x005b7324
005b7230 : MOV EDX,dword ptr [EBP + 0xb8]
005b7236 : TEST EDX,EDX
005b7238 : JNZ 0x005b7245
005b723a : TEST byte ptr [EAX + 0x48],0x8
005b723e : JNZ 0x005b7268
005b7240 : JMP 0x005b7324
005b7245 : CMP EDX,0x1
005b7248 : JNZ 0x005b7255
005b724a : TEST byte ptr [EAX + 0x48],0x2
005b724e : JNZ 0x005b7268
005b7250 : JMP 0x005b7324
005b7255 : CMP EDX,0x2
005b7258 : JNZ 0x005b7324
005b725e : TEST byte ptr [EAX + 0x48],0x4
005b7262 : JZ 0x005b7324
005b7268 : FLD float ptr [EBX]
005b726a : LEA EAX,[EBP + 0x44]
005b726d : FSTP float ptr [ESP + 0x2c]
005b7271 : PUSH EAX
005b7272 : FLD float ptr [EBX + 0x4]
005b7275 : LEA ECX,[ESP + 0x30]
005b7279 : FSTP float ptr [ESP + 0x34]
005b727d : FLD float ptr [EBX + 0x8]
005b7280 : FSTP float ptr [ESP + 0x38]
005b7284 : FLD float ptr [EBX + 0xc]
005b7287 : FSTP float ptr [ESP + 0x3c]
005b728b : FLD float ptr [EBX + 0x10]
005b728e : FSTP float ptr [ESP + 0x40]
005b7292 : FLD float ptr [EBX + 0x14]
005b7295 : FSTP float ptr [ESP + 0x44]
005b7299 : CALL 0x00522e20
005b729e : LEA ECX,[ESP + 0x2c]
005b72a2 : MOV dword ptr [EDI + 0x40],ECX
005b72a5 : MOV ECX,0x8
005b72aa : LEA EDI,[ESP + 0x44]
005b72ae : LEA EDX,[EBP + 0x24]
005b72b1 : MOVSD.REP ES:EDI,ESI
005b72b3 : PUSH EDX
005b72b4 : LEA ECX,[ESP + 0x48]
005b72b8 : CALL 0x0059cfa0
005b72bd : MOV ECX,dword ptr [ESP + 0x68]
005b72c1 : MOV EDX,dword ptr [ESP + 0x1c]
005b72c5 : MOV ESI,dword ptr [ESP + 0x14]
005b72c9 : LEA EAX,[ESP + 0x44]
005b72cd : MOV dword ptr [ECX + 0x44],EAX
005b72d0 : MOV EAX,dword ptr [EDX]
005b72d2 : TEST EAX,EAX
005b72d4 : JZ 0x005b72e0
005b72d6 : MOV EDX,dword ptr [ESI]
005b72d8 : PUSH EAX
005b72d9 : MOV EAX,dword ptr [EDX + 0x1c]
005b72dc : MOV ECX,ESI
005b72de : CALL EAX
005b72e0 : MOV EDI,dword ptr [ESP + 0x20]
005b72e4 : MOV EAX,dword ptr [EDI]
005b72e6 : MOV EDX,dword ptr [ESI]
005b72e8 : ADD EAX,0x2c
005b72eb : MOV dword ptr [ESP + 0x1c],EAX
005b72ef : MOV EAX,dword ptr [EDX + 0xc]
005b72f2 : MOV ECX,ESI
005b72f4 : CALL EAX
005b72f6 : MOV EDX,dword ptr [ESP + 0x1c]
005b72fa : PUSH EAX
005b72fb : MOV EAX,dword ptr [EDX]
005b72fd : MOV ECX,EDI
005b72ff : CALL EAX
005b7301 : MOV EDX,dword ptr [ESI]
005b7303 : MOV EAX,dword ptr [ESP + 0x68]
005b7307 : MOV EDX,dword ptr [EDX + 0x60]
005b730a : PUSH EAX
005b730b : MOV ECX,ESI
005b730d : CALL EDX
005b730f : MOV EAX,dword ptr [EDI]
005b7311 : MOV EDX,dword ptr [EAX + 0x30]
005b7314 : MOV ECX,EDI
005b7316 : CALL EDX
005b7318 : MOV ECX,dword ptr [ESP + 0x18]
005b731c : MOV ESI,dword ptr [ESP + 0x24]
005b7320 : MOV EDI,dword ptr [ESP + 0x68]
005b7324 : MOV EAX,dword ptr [EBP + 0x9c]
005b732a : ADD dword ptr [ESP + 0x10],0x4c
005b732f : INC ECX
005b7330 : MOV dword ptr [ESP + 0x18],ECX
005b7334 : CMP ECX,dword ptr [EAX + 0x1c]
005b7337 : JC 0x005b7210
005b733d : MOV EAX,dword ptr [ESP + 0x28]
005b7341 : MOV dword ptr [EDI + 0x20],EAX
005b7344 : MOV dword ptr [EDI + 0x40],EBX
005b7347 : MOV dword ptr [EDI + 0x44],ESI
005b734a : MOV EDX,dword ptr [EBP]
005b734d : MOV EAX,dword ptr [EDX + 0xf4]
005b7353 : MOV ECX,EBP
005b7355 : CALL EAX
005b7357 : POP EDI
005b7358 : POP ESI
005b7359 : POP EBX
005b735a : POP EBP
005b735b : ADD ESP,0x54
005b735e : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_0052fc20
ENTRY    : 0052fc20
BODY     : [[0052fc20, 0052fc6c] [0052fc70, 0052fe21]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0052fc20(void)

{
  char cVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  int *in_ECX;
  char *pcVar5;
  int iVar6;
  uint *puVar7;
  uint uVar8;
  int iStack_38;
  int iStack_34;
  byte bStack_30;
  int local_2c;
  int iStack_28;
  byte local_24;
  undefined1 local_20 [16];
  char local_10;
  
  FUN_005266c0(*(undefined4 *)(*in_ECX + 8));
  iVar2 = FUN_00527990(*in_ECX);
  iVar3 = *in_ECX;
  puVar7 = (uint *)(iVar3 + 8);
  if (*(int *)(iVar3 + 8) - 0x20U < *(uint *)(iVar3 + 0xc)) {
    iVar6 = 2;
    do {
      FUN_00526bc0();
      *puVar7 = *puVar7 - 0x10;
      if (*puVar7 < *(uint *)(iVar3 + 0xc)) {
        FUN_00504f30();
      }
      iVar6 = iVar6 + -1;
    } while (iVar6 != 0);
  }
  else {
    FUN_00526bc0();
    *puVar7 = *puVar7 - 0x10;
    FUN_00526bc0();
    *puVar7 = *puVar7 - 0x10;
  }
  if ((local_10 == '\b') || (local_10 == '\v')) {
    FUN_00527140(&local_2c,*in_ECX);
    if (local_2c != 0) {
      local_20[0] = 0;
      cVar1 = (**(code **)(*(int *)(local_2c + 0x10) + 0x2c))
                        ((int *)(*in_ECX + 0x78),*(int *)(*in_ECX + 0x78) + 0x130,local_20);
      if ((cVar1 != '\0') && (iVar3 = FUN_00526fa0(*in_ECX), iVar3 != 0)) {
        (**(code **)(*(int *)(iVar3 + 0x10) + 0x44))(*in_ECX + 0x78,iVar2,0);
        uVar8 = 0;
        if (0 < iVar2) {
          do {
            iVar6 = *in_ECX;
            uVar4 = (*(int *)(iVar6 + 8) - *(int *)(iVar6 + 0xc) >> 4) +
                    (*(int *)(iVar6 + 0x1c) + -1) * 0x20;
            pcVar5 = (char *)0x0;
            if (uVar8 <= uVar4) {
              uVar4 = uVar4 - uVar8;
              pcVar5 = (char *)((uVar4 & 0x1f) * 0x10 +
                               *(int *)(*(int *)(iVar6 + 0x18) + (uVar4 >> 5) * 4));
            }
            if ((*pcVar5 == '\b') || (*pcVar5 == '\v')) {
              FUN_00527140(&iStack_38,iVar6);
              if (iStack_38 != 0) {
                (**(code **)(*(int *)(iVar3 + 0x10) + 0x44))(*in_ECX + 0x78,uVar8,iStack_38);
              }
              if (((bStack_30 & 2) == 0) && (iStack_38 != 0)) {
                FUN_00503db0();
              }
              iStack_38 = 0;
              if (((bStack_30 & 1) == 0) && (iStack_34 != 0)) {
                FUN_00503db0();
              }
              iStack_34 = 0;
            }
            uVar8 = uVar8 + 1;
          } while ((int)uVar8 < iVar2);
        }
      }
      FUN_00526bc0();
    }
    if (((local_24 & 2) == 0) && (local_2c != 0)) {
      FUN_00503db0();
    }
    local_2c = 0;
    if (((local_24 & 1) == 0) && (iStack_28 != 0)) {
      FUN_00503db0();
    }
  }
  FUN_00520a70(iVar2);
  FUN_00526bc0();
  return;
}



============================================================
DISASSEMBLY
============================================================
0052fc20 : SUB ESP,0x3c
0052fc23 : PUSH EBX
0052fc24 : PUSH EBP
0052fc25 : PUSH ESI
0052fc26 : PUSH EDI
0052fc27 : MOV EDI,ECX
0052fc29 : MOV EAX,dword ptr [EDI]
0052fc2b : MOV ECX,dword ptr [EAX + 0x8]
0052fc2e : PUSH ECX
0052fc2f : LEA ECX,[ESP + 0x40]
0052fc33 : CALL 0x005266c0
0052fc38 : MOV EAX,dword ptr [EDI]
0052fc3a : MOV ECX,dword ptr [EAX + 0x8]
0052fc3d : CMP ECX,dword ptr [EAX + 0xc]
0052fc40 : JBE 0x0052fc47
0052fc42 : ADD ECX,-0x10
0052fc45 : JMP 0x0052fc4a
0052fc47 : MOV ECX,dword ptr [EAX + 0x14]
0052fc4a : PUSH EAX
0052fc4b : CALL 0x00527990
0052fc50 : MOV ESI,dword ptr [EDI]
0052fc52 : MOV ECX,dword ptr [ESI + 0x8]
0052fc55 : ADD ESI,0x8
0052fc58 : LEA EDX,[ECX + -0x20]
0052fc5b : MOV EBX,EAX
0052fc5d : MOV dword ptr [ESP + 0x10],EBX
0052fc61 : CMP EDX,dword ptr [ESI + 0x4]
0052fc64 : JNC 0x0052fc8f
0052fc66 : MOV EBP,0x2
0052fc6b : JMP 0x0052fc70
0052fc70 : MOV ECX,dword ptr [ESI]
0052fc72 : CALL 0x00526bc0
0052fc77 : ADD dword ptr [ESI],-0x10
0052fc7a : MOV EAX,dword ptr [ESI]
0052fc7c : CMP EAX,dword ptr [ESI + 0x4]
0052fc7f : JNC 0x0052fc88
0052fc81 : MOV ECX,ESI
0052fc83 : CALL 0x00504f30
0052fc88 : SUB EBP,0x1
0052fc8b : JNZ 0x0052fc70
0052fc8d : JMP 0x0052fca1
0052fc8f : CALL 0x00526bc0
0052fc94 : ADD dword ptr [ESI],-0x10
0052fc97 : MOV ECX,dword ptr [ESI]
0052fc99 : CALL 0x00526bc0
0052fc9e : ADD dword ptr [ESI],-0x10
0052fca1 : MOV AL,byte ptr [ESP + 0x3c]
0052fca5 : CMP AL,0x8
0052fca7 : JZ 0x0052fcb1
0052fca9 : CMP AL,0xb
0052fcab : JNZ 0x0052fe06
0052fcb1 : MOV EAX,dword ptr [EDI]
0052fcb3 : PUSH EAX
0052fcb4 : LEA ECX,[ESP + 0x24]
0052fcb8 : PUSH ECX
0052fcb9 : LEA ECX,[ESP + 0x44]
0052fcbd : CALL 0x00527140
0052fcc2 : MOV ECX,dword ptr [ESP + 0x20]
0052fcc6 : TEST ECX,ECX
0052fcc8 : JZ 0x0052fdda
0052fcce : MOV EAX,dword ptr [EDI]
0052fcd0 : ADD EAX,0x78
0052fcd3 : MOV byte ptr [ESP + 0x2c],0x0
0052fcd8 : MOV EDX,dword ptr [EAX]
0052fcda : MOV ESI,dword ptr [ECX + 0x10]
0052fcdd : LEA EBP,[ESP + 0x2c]
0052fce1 : PUSH EBP
0052fce2 : ADD EDX,0x130
0052fce8 : ADD ECX,0x10
0052fceb : PUSH EDX
0052fcec : MOV EDX,dword ptr [ESI + 0x2c]
0052fcef : PUSH EAX
0052fcf0 : CALL EDX
0052fcf2 : TEST AL,AL
0052fcf4 : JZ 0x0052fdcd
0052fcfa : MOV EAX,dword ptr [EDI]
0052fcfc : PUSH EAX
0052fcfd : MOV ECX,EBP
0052fcff : CALL 0x00526fa0
0052fd04 : TEST EAX,EAX
0052fd06 : JZ 0x0052fdcd
0052fd0c : MOV EDX,dword ptr [EAX + 0x10]
0052fd0f : MOV EDX,dword ptr [EDX + 0x44]
0052fd12 : LEA EBP,[EAX + 0x10]
0052fd15 : MOV EAX,dword ptr [EDI]
0052fd17 : PUSH 0x0
0052fd19 : PUSH EBX
0052fd1a : ADD EAX,0x78
0052fd1d : PUSH EAX
0052fd1e : MOV ECX,EBP
0052fd20 : CALL EDX
0052fd22 : XOR ESI,ESI
0052fd24 : TEST EBX,EBX
0052fd26 : JLE 0x0052fdcd
0052fd2c : LEA ESP,[ESP]
0052fd30 : MOV EDX,dword ptr [EDI]
0052fd32 : MOV EAX,dword ptr [EDX + 0x8]
0052fd35 : SUB EAX,dword ptr [EDX + 0xc]
0052fd38 : MOV EBX,dword ptr [EDX + 0x1c]
0052fd3b : DEC EBX
0052fd3c : SAR EAX,0x4
0052fd3f : SHL EBX,0x5
0052fd42 : ADD EAX,EBX
0052fd44 : XOR ECX,ECX
0052fd46 : CMP ESI,EAX
0052fd48 : JA 0x0052fd5f
0052fd4a : MOV EBX,dword ptr [EDX + 0x18]
0052fd4d : SUB EAX,ESI
0052fd4f : MOV ECX,EAX
0052fd51 : AND EAX,0x1f
0052fd54 : SHR ECX,0x5
0052fd57 : SHL EAX,0x4
0052fd5a : ADD EAX,dword ptr [EBX + ECX*0x4]
0052fd5d : MOV ECX,EAX
0052fd5f : MOV AL,byte ptr [ECX]
0052fd61 : CMP AL,0x8
0052fd63 : JZ 0x0052fd69
0052fd65 : CMP AL,0xb
0052fd67 : JNZ 0x0052fdc0
0052fd69 : PUSH EDX
0052fd6a : LEA EDX,[ESP + 0x18]
0052fd6e : PUSH EDX
0052fd6f : CALL 0x00527140
0052fd74 : MOV ECX,dword ptr [ESP + 0x14]
0052fd78 : XOR EBX,EBX
0052fd7a : CMP ECX,EBX
0052fd7c : JZ 0x0052fd94
0052fd7e : MOV EAX,dword ptr [EBP]
0052fd81 : MOV EDX,dword ptr [EAX + 0x44]
0052fd84 : PUSH ECX
0052fd85 : MOV ECX,dword ptr [EDI]
0052fd87 : ADD ECX,0x78
0052fd8a : PUSH ESI
0052fd8b : PUSH ECX
0052fd8c : MOV ECX,EBP
0052fd8e : CALL EDX
0052fd90 : MOV ECX,dword ptr [ESP + 0x14]
0052fd94 : TEST byte ptr [ESP + 0x1c],0x2
0052fd99 : JNZ 0x0052fda4
0052fd9b : CMP ECX,EBX
0052fd9d : JZ 0x0052fda4
0052fd9f : CALL 0x00503db0
0052fda4 : TEST byte ptr [ESP + 0x1c],0x1
0052fda9 : MOV dword ptr [ESP + 0x14],EBX
0052fdad : JNZ 0x0052fdbc
0052fdaf : MOV ECX,dword ptr [ESP + 0x18]
0052fdb3 : CMP ECX,EBX
0052fdb5 : JZ 0x0052fdbc
0052fdb7 : CALL 0x00503db0
0052fdbc : MOV dword ptr [ESP + 0x18],EBX
0052fdc0 : MOV EBX,dword ptr [ESP + 0x10]
0052fdc4 : INC ESI
0052fdc5 : CMP ESI,EBX
0052fdc7 : JL 0x0052fd30
0052fdcd : LEA ECX,[ESP + 0x2c]
0052fdd1 : CALL 0x00526bc0
0052fdd6 : MOV ECX,dword ptr [ESP + 0x20]
0052fdda : TEST byte ptr [ESP + 0x28],0x2
0052fddf : JNZ 0x0052fdea
0052fde1 : TEST ECX,ECX
0052fde3 : JZ 0x0052fdea
0052fde5 : CALL 0x00503db0
0052fdea : TEST byte ptr [ESP + 0x28],0x1
0052fdef : MOV dword ptr [ESP + 0x20],0x0
0052fdf7 : JNZ 0x0052fe06
0052fdf9 : MOV ECX,dword ptr [ESP + 0x24]
0052fdfd : TEST ECX,ECX
0052fdff : JZ 0x0052fe06
0052fe01 : CALL 0x00503db0
0052fe06 : MOV ECX,dword ptr [EDI]
0052fe08 : PUSH EBX
0052fe09 : ADD ECX,0x8
0052fe0c : CALL 0x00520a70
0052fe11 : LEA ECX,[ESP + 0x3c]
0052fe15 : CALL 0x00526bc0
0052fe1a : POP EDI
0052fe1b : POP ESI
0052fe1c : POP EBP
0052fe1d : POP EBX
0052fe1e : ADD ESP,0x3c
0052fe21 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_005406c0
ENTRY    : 005406c0
BODY     : [[005406c0, 00540779]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005406c0(GRefCountImpl *param_1,int param_2)

{
  short *psVar1;
  undefined2 *puVar2;
  GRefCountImpl *this;
  int *in_ECX;
  uint uVar3;
  
  uVar3 = in_ECX[1];
  if (uVar3 != 0) {
    if ((*in_ECX == 0) || (uVar3 <= uVar3 - 1)) {
      psVar1 = (short *)0x0;
    }
    else {
      psVar1 = (short *)(*in_ECX + (uVar3 - 1) * 2);
    }
    if (*psVar1 == 0) {
      return;
    }
  }
  if ((uVar3 != 0) && (uVar3 != 0)) {
    if ((*in_ECX == 0) || (uVar3 <= uVar3 - 1)) {
      psVar1 = (short *)0x0;
    }
    else {
      psVar1 = (short *)(*in_ECX + (uVar3 - 1) * 2);
    }
    if (*psVar1 == 0) {
      uVar3 = uVar3 - 1;
    }
  }
  puVar2 = (undefined2 *)FUN_0053b400(param_1,uVar3,1);
  FUN_0053d280(uVar3,1);
  *(short *)(in_ECX + 9) = (short)in_ECX[9] + 1;
  if (((puVar2 != (undefined2 *)0x0) && (*puVar2 = 0, in_ECX[5] == 0)) && (param_2 != 0)) {
    this = (GRefCountImpl *)FUN_00560f80(param_2);
    param_1 = this;
    FUN_005401e0(uVar3,1,&param_1);
    if (this != (GRefCountImpl *)0x0) {
      GRefCountImpl::Release(this);
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005406c0 : PUSH ESI
005406c1 : MOV ESI,ECX
005406c3 : MOV EAX,dword ptr [ESI + 0x4]
005406c6 : TEST EAX,EAX
005406c8 : JBE 0x005406e8
005406ca : MOV ECX,dword ptr [ESI]
005406cc : LEA EDX,[EAX + -0x1]
005406cf : TEST ECX,ECX
005406d1 : JZ 0x005406dc
005406d3 : CMP EDX,EAX
005406d5 : JNC 0x005406dc
005406d7 : LEA ECX,[ECX + EDX*0x2]
005406da : JMP 0x005406de
005406dc : XOR ECX,ECX
005406de : CMP word ptr [ECX],0x0
005406e2 : JZ 0x00540776
005406e8 : PUSH EDI
005406e9 : MOV EDI,EAX
005406eb : TEST EDI,EDI
005406ed : JBE 0x0054070e
005406ef : TEST EAX,EAX
005406f1 : JBE 0x0054070e
005406f3 : MOV ECX,dword ptr [ESI]
005406f5 : LEA EDX,[EAX + -0x1]
005406f8 : TEST ECX,ECX
005406fa : JZ 0x00540705
005406fc : CMP EDX,EAX
005406fe : JNC 0x00540705
00540700 : LEA EAX,[ECX + EDX*0x2]
00540703 : JMP 0x00540707
00540705 : XOR EAX,EAX
00540707 : CMP word ptr [EAX],0x0
0054070b : JNZ 0x0054070e
0054070d : DEC EDI
0054070e : MOV EAX,dword ptr [ESP + 0xc]
00540712 : PUSH EBX
00540713 : PUSH EBP
00540714 : PUSH 0x1
00540716 : PUSH EDI
00540717 : PUSH EAX
00540718 : MOV ECX,ESI
0054071a : CALL 0x0053b400
0054071f : PUSH 0x1
00540721 : LEA EBX,[ESI + 0x10]
00540724 : PUSH EDI
00540725 : MOV ECX,EBX
00540727 : MOV EBP,EAX
00540729 : CALL 0x0053d280
0054072e : INC word ptr [ESI + 0x24]
00540732 : TEST EBP,EBP
00540734 : JZ 0x00540773
00540736 : XOR ECX,ECX
00540738 : MOV word ptr [EBP],CX
0054073c : CMP dword ptr [ESI + 0x14],ECX
0054073f : JNZ 0x00540773
00540741 : MOV EAX,dword ptr [ESP + 0x18]
00540745 : TEST EAX,EAX
00540747 : JZ 0x00540773
00540749 : MOV ECX,dword ptr [ESP + 0x14]
0054074d : PUSH EAX
0054074e : CALL 0x00560f80
00540753 : LEA EDX,[ESP + 0x14]
00540757 : PUSH EDX
00540758 : PUSH 0x1
0054075a : MOV ESI,EAX
0054075c : PUSH EDI
0054075d : MOV ECX,EBX
0054075f : MOV dword ptr [ESP + 0x20],ESI
00540763 : CALL 0x005401e0
00540768 : TEST ESI,ESI
0054076a : JZ 0x00540773
0054076c : MOV ECX,ESI
0054076e : CALL 0x004ff7e0
00540773 : POP EBP
00540774 : POP EBX
00540775 : POP EDI
00540776 : POP ESI
00540777 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_00a6ea50
ENTRY    : 00a6ea50
BODY     : [[00a6ea50, 00a6eb56] [00a6eb59, 00a6ed56]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_00a6ea50(undefined4 param_1,undefined4 param_2)

{
  ushort uVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  wchar_t *_Str;
  bool bVar5;
  undefined1 local_58 [28];
  undefined1 local_3c [4];
  undefined2 local_38;
  undefined1 local_30 [4];
  uint local_2c;
  uint local_28;
  uint local_24;
  undefined1 local_20 [4];
  int local_1c;
  int local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b442bb;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_24 = 7;
  local_28 = 0;
  local_38 = 0;
  FUN_00406360(&DAT_00c44140,3);
  local_8 = 0;
  FUN_00ab63e0(local_20,param_2,local_3c,1,uVar2);
  local_8._0_1_ = 2;
  if (7 < local_24) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_38 = 0;
  local_24 = 7;
  local_28 = 0;
  if ((uint)((local_18 - local_1c) / 0x1c) < 2) {
    FUN_00406460(L"No data. Plz enter the data");
    local_8._0_1_ = 3;
    FUN_00a6e600(local_3c);
    local_8 = CONCAT31(local_8._1_3_,2);
    if (7 < local_24) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_24 = 7;
    local_28 = 0;
    local_38 = 0;
    local_8 = 0xffffffff;
    if (local_1c != 0) {
      FUN_00405450(param_1);
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    uVar2 = 0;
  }
  else {
    iVar3 = FUN_00405bb0(L"file");
    if (iVar3 == 0) {
      FUN_00405eb0(local_1c + 0x1c,0,0xffffffff);
      uVar2 = local_28;
      uVar4 = local_24;
    }
    else {
      iVar3 = FUN_00405bb0(&PTR_DAT_00c4418c);
      if (iVar3 != 0) {
        FUN_00406460(L"Bad Command");
        local_8._0_1_ = 7;
        FUN_00a6e600(local_58);
        local_8 = CONCAT31(local_8._1_3_,2);
        FUN_00406560();
        local_8 = 0xffffffff;
        uVar2 = FUN_004042c0();
        goto LAB_00a6ed41;
      }
      FUN_00406460(&DAT_00c44194);
      local_8._0_1_ = 4;
      FUN_00ab63e0(local_30,local_1c + 0x1c,local_58,0);
      local_8 = CONCAT31(local_8._1_3_,6);
      FUN_00406560();
      iVar3 = local_28 - local_2c;
      uVar1 = ((short)(iVar3 / 0x1c) + (short)(iVar3 >> 0x1f)) -
              (short)((longlong)iVar3 * 0x92492493 >> 0x3f);
      if (uVar1 != 0) {
        iVar3 = 0;
        uVar2 = (uint)uVar1;
        do {
          if (*(uint *)(iVar3 + 0x18 + local_2c) < 8) {
            _Str = (wchar_t *)(iVar3 + 4 + local_2c);
          }
          else {
            _Str = *(wchar_t **)(iVar3 + 4 + local_2c);
          }
          _wcstoul(_Str,(wchar_t **)0x0,10);
          FUN_0041c0d0();
          iVar3 = iVar3 + 0x1c;
          uVar2 = uVar2 - 1;
        } while (uVar2 != 0);
      }
      uVar2 = 0;
      if (local_2c != local_28) {
        uVar4 = FUN_00404250(local_28);
        FUN_00405450(param_1);
        local_28 = uVar4;
      }
      local_8._0_1_ = 2;
      bVar5 = local_2c != 0;
      local_2c = uVar2;
      uVar4 = uVar2;
      if (bVar5) {
        FUN_00405450(param_1);
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
    }
    local_24 = uVar4;
    local_28 = uVar2;
    if (local_1c != local_18) {
      iVar3 = FUN_00404250(local_18);
      FUN_00405450(param_1);
      local_18 = iVar3;
    }
    local_8 = 0xffffffff;
    if (local_1c != 0) {
      FUN_00405450(param_1);
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    uVar2 = 0;
  }
LAB_00a6ed41:
  ExceptionList = local_10;
  return uVar2 & 0xffffff00;
}



============================================================
DISASSEMBLY
============================================================
00a6ea50 : PUSH EBP
00a6ea51 : MOV EBP,ESP
00a6ea53 : PUSH -0x1
00a6ea55 : PUSH 0xb442bb
00a6ea5a : MOV EAX,FS:[0x0]
00a6ea60 : PUSH EAX
00a6ea61 : SUB ESP,0x4c
00a6ea64 : PUSH EBX
00a6ea65 : PUSH ESI
00a6ea66 : PUSH EDI
00a6ea67 : MOV EAX,[0x00d66fa0]
00a6ea6c : XOR EAX,EBP
00a6ea6e : PUSH EAX
00a6ea6f : LEA EAX,[EBP + -0xc]
00a6ea72 : MOV FS:[0x0],EAX
00a6ea78 : PUSH 0x3
00a6ea7a : XOR EAX,EAX
00a6ea7c : MOV EBX,0x7
00a6ea81 : XOR EDI,EDI
00a6ea83 : PUSH 0xc44140
00a6ea88 : LEA ECX,[EBP + -0x38]
00a6ea8b : MOV dword ptr [EBP + -0x20],EBX
00a6ea8e : MOV dword ptr [EBP + -0x24],EDI
00a6ea91 : MOV word ptr [EBP + -0x34],AX
00a6ea95 : CALL 0x00406360
00a6ea9a : MOV dword ptr [EBP + -0x4],EDI
00a6ea9d : MOV EDX,dword ptr [EBP + 0xc]
00a6eaa0 : PUSH 0x1
00a6eaa2 : LEA ECX,[EBP + -0x38]
00a6eaa5 : PUSH ECX
00a6eaa6 : PUSH EDX
00a6eaa7 : LEA EAX,[EBP + -0x1c]
00a6eaaa : PUSH EAX
00a6eaab : CALL 0x00ab63e0
00a6eab0 : ADD ESP,0x10
00a6eab3 : MOV byte ptr [EBP + -0x4],0x2
00a6eab7 : CMP dword ptr [EBP + -0x20],0x8
00a6eabb : JC 0x00a6eac5
00a6eabd : MOV ECX,dword ptr [EBP + -0x34]
00a6eac0 : CALL 0x006f04e0
00a6eac5 : MOV ESI,dword ptr [EBP + -0x14]
00a6eac8 : XOR ECX,ECX
00a6eaca : MOV word ptr [EBP + -0x34],CX
00a6eace : MOV ECX,dword ptr [EBP + -0x18]
00a6ead1 : SUB ESI,ECX
00a6ead3 : MOV EAX,0x92492493
00a6ead8 : IMUL ESI
00a6eada : ADD EDX,ESI
00a6eadc : SAR EDX,0x4
00a6eadf : MOV EAX,EDX
00a6eae1 : SHR EAX,0x1f
00a6eae4 : ADD EAX,EDX
00a6eae6 : MOV dword ptr [EBP + -0x20],EBX
00a6eae9 : MOV dword ptr [EBP + -0x24],EDI
00a6eaec : CMP EAX,0x2
00a6eaef : JNC 0x00a6eb67
00a6eaf1 : PUSH 0xc44148
00a6eaf6 : LEA ECX,[EBP + -0x38]
00a6eaf9 : CALL 0x00406460
00a6eafe : MOV byte ptr [EBP + -0x4],0x3
00a6eb02 : MOV ECX,dword ptr [EBP + 0x8]
00a6eb05 : LEA EDX,[EBP + -0x38]
00a6eb08 : ADD ECX,0xc
00a6eb0b : PUSH EDX
00a6eb0c : CALL 0x00a6e600
00a6eb11 : ADD ESP,0x4
00a6eb14 : MOV byte ptr [EBP + -0x4],0x2
00a6eb18 : CMP dword ptr [EBP + -0x20],0x8
00a6eb1c : JC 0x00a6eb26
00a6eb1e : MOV ECX,dword ptr [EBP + -0x34]
00a6eb21 : CALL 0x006f04e0
00a6eb26 : XOR EAX,EAX
00a6eb28 : MOV dword ptr [EBP + -0x20],EBX
00a6eb2b : MOV dword ptr [EBP + -0x24],EDI
00a6eb2e : MOV word ptr [EBP + -0x34],AX
00a6eb32 : MOV dword ptr [EBP + -0x4],0xffffffff
00a6eb39 : MOV EAX,dword ptr [EBP + -0x18]
00a6eb3c : CMP EAX,EDI
00a6eb3e : JZ 0x00a6eb59
00a6eb40 : MOV ECX,dword ptr [EBP + 0x8]
00a6eb43 : MOV EDI,dword ptr [EBP + -0x14]
00a6eb46 : PUSH ECX
00a6eb47 : CALL 0x00405450
00a6eb4c : MOV ECX,dword ptr [EBP + -0x18]
00a6eb4f : ADD ESP,0x4
00a6eb52 : CALL 0x006f04e0
00a6eb59 : MOV dword ptr [EBP + -0x18],EDI
00a6eb5c : MOV dword ptr [EBP + -0x14],EDI
00a6eb5f : MOV dword ptr [EBP + -0x10],EDI
00a6eb62 : JMP 0x00a6ed41
00a6eb67 : MOV EAX,dword ptr [ECX + 0x14]
00a6eb6a : PUSH 0xc44180
00a6eb6f : MOV EDI,0x4
00a6eb74 : CALL 0x00405bb0
00a6eb79 : TEST EAX,EAX
00a6eb7b : JNZ 0x00a6eb99
00a6eb7d : MOV EAX,dword ptr [EBP + -0x18]
00a6eb80 : MOV ECX,dword ptr [EBP + 0x8]
00a6eb83 : PUSH -0x1
00a6eb85 : XOR EBX,EBX
00a6eb87 : ADD EAX,0x1c
00a6eb8a : PUSH EBX
00a6eb8b : PUSH EAX
00a6eb8c : ADD ECX,0x38
00a6eb8f : CALL 0x00405eb0
00a6eb94 : JMP 0x00a6ecb0
00a6eb99 : MOV ECX,dword ptr [EBP + -0x18]
00a6eb9c : MOV EAX,dword ptr [ECX + 0x14]
00a6eb9f : PUSH 0xc4418c
00a6eba4 : MOV EDI,0x3
00a6eba9 : CALL 0x00405bb0
00a6ebae : LEA ECX,[EBP + -0x54]
00a6ebb1 : TEST EAX,EAX
00a6ebb3 : JNZ 0x00a6ed07
00a6ebb9 : PUSH 0xc44194
00a6ebbe : CALL 0x00406460
00a6ebc3 : MOV byte ptr [EBP + -0x4],0x4
00a6ebc7 : MOV EAX,dword ptr [EBP + -0x18]
00a6ebca : XOR EBX,EBX
00a6ebcc : PUSH EBX
00a6ebcd : LEA EDX,[EBP + -0x54]
00a6ebd0 : ADD EAX,0x1c
00a6ebd3 : PUSH EDX
00a6ebd4 : PUSH EAX
00a6ebd5 : LEA EAX,[EBP + -0x2c]
00a6ebd8 : PUSH EAX
00a6ebd9 : CALL 0x00ab63e0
00a6ebde : ADD ESP,0x10
00a6ebe1 : MOV byte ptr [EBP + -0x4],0x6
00a6ebe5 : LEA ECX,[EBP + -0x54]
00a6ebe8 : CALL 0x00406560
00a6ebed : MOV EDI,dword ptr [EBP + -0x24]
00a6ebf0 : MOV ECX,dword ptr [EBP + -0x28]
00a6ebf3 : MOV ESI,EDI
00a6ebf5 : SUB ESI,ECX
00a6ebf7 : MOV EAX,0x92492493
00a6ebfc : IMUL ESI
00a6ebfe : ADD EDX,ESI
00a6ec00 : SAR EDX,0x4
00a6ec03 : MOV EAX,EDX
00a6ec05 : SHR EAX,0x1f
00a6ec08 : ADD EAX,EDX
00a6ec0a : MOVZX EAX,AX
00a6ec0d : XOR EDX,EDX
00a6ec0f : CMP DX,AX
00a6ec12 : JNC 0x00a6ec60
00a6ec14 : XOR ESI,ESI
00a6ec16 : MOVZX EBX,AX
00a6ec19 : LEA ESP,[ESP]
00a6ec20 : CMP dword ptr [ESI + ECX*0x1 + 0x18],0x8
00a6ec25 : JC 0x00a6ec2d
00a6ec27 : MOV ECX,dword ptr [ESI + ECX*0x1 + 0x4]
00a6ec2b : JMP 0x00a6ec31
00a6ec2d : LEA ECX,[ESI + ECX*0x1 + 0x4]
00a6ec31 : PUSH 0xa
00a6ec33 : PUSH 0x0
00a6ec35 : PUSH ECX
00a6ec36 : CALL 0x00637daf
00a6ec3b : MOV ECX,dword ptr [EBP + 0x8]
00a6ec3e : MOV EDX,dword ptr [ECX + 0x54]
00a6ec41 : MOVZX EAX,AX
00a6ec44 : ADD ESP,0xc
00a6ec47 : LEA EDI,[EBP + 0xc]
00a6ec4a : MOV dword ptr [EBP + 0xc],EAX
00a6ec4d : CALL 0x0041c0d0
00a6ec52 : MOV ECX,dword ptr [EBP + -0x28]
00a6ec55 : ADD ESI,0x1c
00a6ec58 : SUB EBX,0x1
00a6ec5b : JNZ 0x00a6ec20
00a6ec5d : MOV EDI,dword ptr [EBP + -0x24]
00a6ec60 : CMP ECX,EDI
00a6ec62 : JZ 0x00a6ec83
00a6ec64 : PUSH EDI
00a6ec65 : MOV EAX,EDI
00a6ec67 : CALL 0x00404250
00a6ec6c : MOV EDX,dword ptr [EBP + 0x8]
00a6ec6f : MOV EDI,dword ptr [EBP + -0x24]
00a6ec72 : ADD ESP,0x4
00a6ec75 : PUSH EDX
00a6ec76 : MOV ESI,EAX
00a6ec78 : CALL 0x00405450
00a6ec7d : ADD ESP,0x4
00a6ec80 : MOV dword ptr [EBP + -0x24],ESI
00a6ec83 : MOV byte ptr [EBP + -0x4],0x2
00a6ec87 : MOV EAX,dword ptr [EBP + -0x28]
00a6ec8a : CMP EAX,EBX
00a6ec8c : JZ 0x00a6eca5
00a6ec8e : MOV ECX,dword ptr [EBP + 0x8]
00a6ec91 : MOV EDI,dword ptr [EBP + -0x24]
00a6ec94 : PUSH ECX
00a6ec95 : CALL 0x00405450
00a6ec9a : MOV ECX,dword ptr [EBP + -0x28]
00a6ec9d : ADD ESP,0x4
00a6eca0 : CALL 0x006f04e0
00a6eca5 : MOV dword ptr [EBP + -0x28],EBX
00a6eca8 : MOV dword ptr [EBP + -0x24],EBX
00a6ecab : MOV dword ptr [EBP + -0x20],EBX
00a6ecae : XOR EBX,EBX
00a6ecb0 : MOV ECX,dword ptr [EBP + -0x18]
00a6ecb3 : MOV EAX,dword ptr [EBP + -0x14]
00a6ecb6 : CMP ECX,EAX
00a6ecb8 : JZ 0x00a6ecd7
00a6ecba : PUSH EAX
00a6ecbb : CALL 0x00404250
00a6ecc0 : MOV EDX,dword ptr [EBP + 0x8]
00a6ecc3 : MOV EDI,dword ptr [EBP + -0x14]
00a6ecc6 : ADD ESP,0x4
00a6ecc9 : PUSH EDX
00a6ecca : MOV ESI,EAX
00a6eccc : CALL 0x00405450
00a6ecd1 : ADD ESP,0x4
00a6ecd4 : MOV dword ptr [EBP + -0x14],ESI
00a6ecd7 : MOV dword ptr [EBP + -0x4],0xffffffff
00a6ecde : MOV EAX,dword ptr [EBP + -0x18]
00a6ece1 : CMP EAX,EBX
00a6ece3 : JZ 0x00a6ecfc
00a6ece5 : MOV ECX,dword ptr [EBP + 0x8]
00a6ece8 : MOV EDI,dword ptr [EBP + -0x14]
00a6eceb : PUSH ECX
00a6ecec : CALL 0x00405450
00a6ecf1 : MOV ECX,dword ptr [EBP + -0x18]
00a6ecf4 : ADD ESP,0x4
00a6ecf7 : CALL 0x006f04e0
00a6ecfc : MOV dword ptr [EBP + -0x18],EBX
00a6ecff : MOV dword ptr [EBP + -0x14],EBX
00a6ed02 : MOV dword ptr [EBP + -0x10],EBX
00a6ed05 : JMP 0x00a6ed41
00a6ed07 : PUSH 0xc4419c
00a6ed0c : CALL 0x00406460
00a6ed11 : MOV byte ptr [EBP + -0x4],BL
00a6ed14 : MOV ECX,dword ptr [EBP + 0x8]
00a6ed17 : LEA EDX,[EBP + -0x54]
00a6ed1a : ADD ECX,0xc
00a6ed1d : PUSH EDX
00a6ed1e : CALL 0x00a6e600
00a6ed23 : ADD ESP,0x4
00a6ed26 : MOV byte ptr [EBP + -0x4],0x2
00a6ed2a : LEA ECX,[EBP + -0x54]
00a6ed2d : CALL 0x00406560
00a6ed32 : MOV dword ptr [EBP + -0x4],0xffffffff
00a6ed39 : LEA ESI,[EBP + -0x1c]
00a6ed3c : CALL 0x004042c0
00a6ed41 : XOR AL,AL
00a6ed43 : MOV ECX,dword ptr [EBP + -0xc]
00a6ed46 : MOV dword ptr FS:[0x0],ECX
00a6ed4d : POP ECX
00a6ed4e : POP EDI
00a6ed4f : POP ESI
00a6ed50 : POP EBX
00a6ed51 : MOV ESP,EBP
00a6ed53 : POP EBP
00a6ed54 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_006a3f60
ENTRY    : 006a3f60
BODY     : [[006a3f60, 006a4158]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_006a3f60(void)

{
  int *piVar1;
  uint uVar2;
  int in_EAX;
  int iVar3;
  uint in_ECX;
  int *piVar4;
  uint *in_EDX;
  int *piVar5;
  char *pcVar6;
  char *pcVar7;
  uint uVar8;
  char *_Str1;
  int *piVar9;
  undefined **ppuStack_18;
  int iStack_4;
  
  *in_EDX = in_ECX;
  pcVar6 = (char *)(in_ECX + in_EAX);
  in_EDX[2] = (uint)pcVar6;
  in_EDX[3] = 0;
  (*(code *)in_EDX[7])();
  pcVar7 = (char *)*in_EDX;
  while (pcVar7 < pcVar6) {
    pcVar7 = (char *)*in_EDX;
    if (((*pcVar7 == 'F') && (pcVar7 + 0x19 < pcVar6)) &&
       (iVar3 = _strncmp(pcVar7,"FontDirectory",0xd), iVar3 == 0)) {
      (*(code *)in_EDX[8])();
      (*(code *)in_EDX[7])();
      pcVar7 = (char *)*in_EDX;
      _Str1 = pcVar7;
      if (pcVar7 < pcVar6) {
        do {
          if (((*_Str1 == 'k') && (_Str1 + 5 < pcVar6)) &&
             (iVar3 = _strncmp(_Str1,"known",5), iVar3 == 0)) {
            if (_Str1 < pcVar6) {
              (*(code *)in_EDX[8])();
              (*(code *)in_EDX[0xe])();
              if (iStack_4 == 3) {
                pcVar7 = (char *)*in_EDX;
              }
            }
            goto LAB_006a403f;
          }
          (*(code *)in_EDX[8])();
          if (in_EDX[3] != 0) goto LAB_006a414e;
          (*(code *)in_EDX[7])();
          _Str1 = (char *)*in_EDX;
        } while (_Str1 < pcVar6);
        *in_EDX = (uint)pcVar7;
      }
      else {
LAB_006a403f:
        *in_EDX = (uint)pcVar7;
      }
    }
    else if ((*pcVar7 == '/') && (pcVar7 + 2 < pcVar6)) {
      piVar9 = (int *)(pcVar7 + 1);
      *in_EDX = (uint)piVar9;
      (*(code *)in_EDX[8])();
      if (in_EDX[3] != 0) break;
      uVar8 = (int)*in_EDX - (int)piVar9;
      if ((uVar8 - 1 < 0x15) && ((char *)*in_EDX < pcVar6)) {
        ppuStack_18 = &PTR_s_version_00be9310;
        do {
          piVar5 = (int *)*ppuStack_18;
          if ((piVar5 != (int *)0x0) && ((char)*piVar9 == (char)*piVar5)) {
            piVar4 = piVar5;
            do {
              iVar3 = *piVar4;
              piVar4 = (int *)((int)piVar4 + 1);
            } while ((char)iVar3 != '\0');
            piVar1 = piVar9;
            uVar2 = uVar8;
            if (uVar8 == (int)piVar4 - ((int)piVar5 + 1)) {
              for (; 3 < uVar2; uVar2 = uVar2 - 4) {
                if (*piVar1 != *piVar5) goto LAB_006a4100;
                piVar5 = piVar5 + 1;
                piVar1 = piVar1 + 1;
              }
              if ((uVar2 == 0) ||
                 (((char)*piVar5 == (char)*piVar1 &&
                  ((uVar2 < 2 ||
                   ((*(char *)((int)piVar5 + 1) == *(char *)((int)piVar1 + 1) &&
                    ((uVar2 < 3 || (*(char *)((int)piVar5 + 2) == *(char *)((int)piVar1 + 2)))))))))
                 )) {
                uVar8 = FUN_006a3ee0();
                in_EDX[3] = uVar8;
                if (uVar8 != 0) {
                  return uVar8;
                }
                break;
              }
            }
          }
LAB_006a4100:
          ppuStack_18 = ppuStack_18 + 9;
        } while ((int)ppuStack_18 < 0xbe95bc);
      }
    }
    else {
      (*(code *)in_EDX[8])();
      if (in_EDX[3] != 0) break;
    }
    (*(code *)in_EDX[7])();
    pcVar7 = (char *)*in_EDX;
  }
LAB_006a414e:
  return in_EDX[3];
}



============================================================
DISASSEMBLY
============================================================
006a3f60 : SUB ESP,0x18
006a3f63 : PUSH EBX
006a3f64 : PUSH EBP
006a3f65 : PUSH ESI
006a3f66 : MOV ESI,EDX
006a3f68 : MOV EBX,ECX
006a3f6a : MOV ECX,dword ptr [ESI + 0x1c]
006a3f6d : MOV dword ptr [ESI],EBX
006a3f6f : ADD EBX,EAX
006a3f71 : PUSH EDI
006a3f72 : PUSH ESI
006a3f73 : MOV dword ptr [ESP + 0x18],EBX
006a3f77 : MOV dword ptr [ESI + 0x8],EBX
006a3f7a : MOV dword ptr [ESI + 0xc],0x0
006a3f81 : CALL ECX
006a3f83 : ADD ESP,0x4
006a3f86 : CMP dword ptr [ESI],EBX
006a3f88 : JNC 0x006a414e
006a3f8e : MOV EDI,EDI
006a3f90 : MOV EDI,dword ptr [ESI]
006a3f92 : CMP byte ptr [EDI],0x46
006a3f95 : JNZ 0x006a4046
006a3f9b : LEA EDX,[EDI + 0x19]
006a3f9e : CMP EDX,EBX
006a3fa0 : JNC 0x006a4046
006a3fa6 : PUSH 0xd
006a3fa8 : PUSH 0xbe96c4
006a3fad : PUSH EDI
006a3fae : CALL 0x0063abcb
006a3fb3 : ADD ESP,0xc
006a3fb6 : TEST EAX,EAX
006a3fb8 : JNZ 0x006a4046
006a3fbe : MOV EAX,dword ptr [ESI + 0x20]
006a3fc1 : PUSH ESI
006a3fc2 : CALL EAX
006a3fc4 : MOV ECX,dword ptr [ESI + 0x1c]
006a3fc7 : PUSH ESI
006a3fc8 : CALL ECX
006a3fca : MOV EBP,dword ptr [ESI]
006a3fcc : ADD ESP,0x8
006a3fcf : MOV EDI,EBP
006a3fd1 : CMP EBP,EBX
006a3fd3 : JNC 0x006a403f
006a3fd5 : CMP byte ptr [EDI],0x6b
006a3fd8 : JNZ 0x006a3ff5
006a3fda : LEA EDX,[EDI + 0x5]
006a3fdd : CMP EDX,EBX
006a3fdf : JNC 0x006a3ff5
006a3fe1 : PUSH 0x5
006a3fe3 : PUSH 0xbe96bc
006a3fe8 : PUSH EDI
006a3fe9 : CALL 0x0063abcb
006a3fee : ADD ESP,0xc
006a3ff1 : TEST EAX,EAX
006a3ff3 : JZ 0x006a401e
006a3ff5 : MOV EAX,dword ptr [ESI + 0x20]
006a3ff8 : PUSH ESI
006a3ff9 : CALL EAX
006a3ffb : ADD ESP,0x4
006a3ffe : CMP dword ptr [ESI + 0xc],0x0
006a4002 : JNZ 0x006a414e
006a4008 : MOV ECX,dword ptr [ESI + 0x1c]
006a400b : PUSH ESI
006a400c : CALL ECX
006a400e : MOV EDI,dword ptr [ESI]
006a4010 : ADD ESP,0x4
006a4013 : CMP EDI,EBX
006a4015 : JC 0x006a3fd5
006a4017 : MOV dword ptr [ESI],EBP
006a4019 : JMP 0x006a413d
006a401e : CMP EDI,EBX
006a4020 : JNC 0x006a403f
006a4022 : MOV EDX,dword ptr [ESI + 0x20]
006a4025 : PUSH ESI
006a4026 : CALL EDX
006a4028 : MOV ECX,dword ptr [ESI + 0x38]
006a402b : LEA EAX,[ESP + 0x20]
006a402f : PUSH EAX
006a4030 : PUSH ESI
006a4031 : CALL ECX
006a4033 : ADD ESP,0xc
006a4036 : CMP dword ptr [ESP + 0x24],0x3
006a403b : JNZ 0x006a403f
006a403d : MOV EBP,dword ptr [ESI]
006a403f : MOV dword ptr [ESI],EBP
006a4041 : JMP 0x006a413d
006a4046 : CMP byte ptr [EDI],0x2f
006a4049 : JNZ 0x006a412e
006a404f : LEA EDX,[EDI + 0x2]
006a4052 : CMP EDX,EBX
006a4054 : JNC 0x006a412e
006a405a : MOV EAX,dword ptr [ESI + 0x20]
006a405d : INC EDI
006a405e : PUSH ESI
006a405f : MOV dword ptr [ESP + 0x1c],EDI
006a4063 : MOV dword ptr [ESI],EDI
006a4065 : CALL EAX
006a4067 : ADD ESP,0x4
006a406a : CMP dword ptr [ESI + 0xc],0x0
006a406e : JNZ 0x006a414e
006a4074 : MOV EAX,dword ptr [ESI]
006a4076 : MOV EBP,EAX
006a4078 : SUB EBP,EDI
006a407a : LEA ECX,[EBP + -0x1]
006a407d : CMP ECX,0x14
006a4080 : JA 0x006a413d
006a4086 : CMP EAX,EBX
006a4088 : JNC 0x006a413d
006a408e : MOV EAX,0xbe9310
006a4093 : MOV dword ptr [ESP + 0x10],EAX
006a4097 : MOV EDX,dword ptr [EAX]
006a4099 : TEST EDX,EDX
006a409b : JZ 0x006a4100
006a409d : MOV AL,byte ptr [EDI]
006a409f : CMP AL,byte ptr [EDX]
006a40a1 : JNZ 0x006a4100
006a40a3 : MOV ECX,EDX
006a40a5 : LEA EAX,[ECX + 0x1]
006a40a8 : MOV BL,byte ptr [ECX]
006a40aa : INC ECX
006a40ab : TEST BL,BL
006a40ad : JNZ 0x006a40a8
006a40af : SUB ECX,EAX
006a40b1 : CMP EBP,ECX
006a40b3 : JNZ 0x006a40fc
006a40b5 : MOV ECX,EBP
006a40b7 : CMP EBP,0x4
006a40ba : JC 0x006a40d4
006a40bc : LEA ESP,[ESP]
006a40c0 : MOV EAX,dword ptr [EDI]
006a40c2 : CMP EAX,dword ptr [EDX]
006a40c4 : JNZ 0x006a40f8
006a40c6 : SUB ECX,0x4
006a40c9 : ADD EDX,0x4
006a40cc : ADD EDI,0x4
006a40cf : CMP ECX,0x4
006a40d2 : JNC 0x006a40c0
006a40d4 : TEST ECX,ECX
006a40d6 : JZ 0x006a4114
006a40d8 : MOV AL,byte ptr [EDX]
006a40da : CMP AL,byte ptr [EDI]
006a40dc : JNZ 0x006a40f8
006a40de : CMP ECX,0x1
006a40e1 : JBE 0x006a4114
006a40e3 : MOV AL,byte ptr [EDX + 0x1]
006a40e6 : CMP AL,byte ptr [EDI + 0x1]
006a40e9 : JNZ 0x006a40f8
006a40eb : CMP ECX,0x2
006a40ee : JBE 0x006a4114
006a40f0 : MOV CL,byte ptr [EDX + 0x2]
006a40f3 : CMP CL,byte ptr [EDI + 0x2]
006a40f6 : JZ 0x006a4114
006a40f8 : MOV EDI,dword ptr [ESP + 0x18]
006a40fc : MOV EBX,dword ptr [ESP + 0x14]
006a4100 : MOV EAX,dword ptr [ESP + 0x10]
006a4104 : ADD EAX,0x24
006a4107 : CMP EAX,0xbe95bc
006a410c : MOV dword ptr [ESP + 0x10],EAX
006a4110 : JL 0x006a4097
006a4112 : JMP 0x006a413d
006a4114 : MOV EAX,dword ptr [ESP + 0x10]
006a4118 : MOV ECX,dword ptr [ESP + 0x2c]
006a411c : CALL 0x006a3ee0
006a4121 : MOV dword ptr [ESI + 0xc],EAX
006a4124 : TEST EAX,EAX
006a4126 : JNZ 0x006a4151
006a4128 : MOV EBX,dword ptr [ESP + 0x14]
006a412c : JMP 0x006a413d
006a412e : MOV EDX,dword ptr [ESI + 0x20]
006a4131 : PUSH ESI
006a4132 : CALL EDX
006a4134 : ADD ESP,0x4
006a4137 : CMP dword ptr [ESI + 0xc],0x0
006a413b : JNZ 0x006a414e
006a413d : MOV EAX,dword ptr [ESI + 0x1c]
006a4140 : PUSH ESI
006a4141 : CALL EAX
006a4143 : ADD ESP,0x4
006a4146 : CMP dword ptr [ESI],EBX
006a4148 : JC 0x006a3f90
006a414e : MOV EAX,dword ptr [ESI + 0xc]
006a4151 : POP EDI
006a4152 : POP ESI
006a4153 : POP EBP
006a4154 : POP EBX
006a4155 : ADD ESP,0x18
006a4158 : RET

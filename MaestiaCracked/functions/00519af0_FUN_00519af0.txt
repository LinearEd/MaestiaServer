PROGRAM  : Maestia.exe
FUNCTION : FUN_00519af0
ENTRY    : 00519af0
BODY     : [[00519af0, 00519ecc] [00519ed0, 0051a0a9]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_00519af0(int *param_1,byte *param_2,byte *param_3)

{
  GRefCountNTSImpl *pGVar1;
  byte bVar2;
  undefined1 uVar3;
  code *pcVar4;
  char cVar5;
  GRefCountNTSImpl *this;
  byte *pbVar6;
  byte *pbVar7;
  undefined1 *puVar8;
  int iVar9;
  uint uVar10;
  uint unaff_ESI;
  uint uVar11;
  byte *pbVar12;
  undefined4 uStack_447c;
  byte *pbStack_4478;
  byte *pbStack_4474;
  byte *pbStack_4470;
  undefined1 uStack_445c;
  byte bStack_445b;
  char cStack_445a;
  char cStack_4459;
  byte bStack_4458;
  undefined1 uStack_4457;
  undefined1 uStack_4456;
  byte bStack_4455;
  byte bStack_4454;
  byte bStack_4452;
  undefined1 uStack_4451;
  ushort uStack_4450;
  byte *pbStack_444c;
  byte *pbStack_4448;
  byte *pbStack_4444;
  byte *pbStack_4440;
  byte *pbStack_443c;
  GRefCountNTSImpl *pGStack_4438;
  byte *local_4434;
  byte *pbStack_4430;
  byte *pbStack_442c;
  ushort uStack_4420;
  byte *pbStack_441c;
  byte abStack_4418 [5];
  undefined1 auStack_4413 [7];
  undefined4 uStack_440c;
  undefined1 uStack_4408;
  undefined4 uStack_4404;
  byte abStack_4004 [16384];
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)&uStack_445c;
  local_4434 = param_3;
  if ((param_1 == (int *)0x0) || (cVar5 = (**(code **)(*param_1 + 8))(), cVar5 == '\0'))
  goto LAB_0051a07f;
  pbStack_4470 = (byte *)0x1;
  pbStack_4474 = &bStack_4455;
  bStack_4455 = 0;
  pbStack_4478 = (byte *)0x519b4d;
  (**(code **)(*param_1 + 0x28))();
  pbStack_4478 = (byte *)0x1;
  uStack_447c = (byte **)&stack0xffffbb9f;
  (**(code **)(*param_1 + 0x28))();
  (**(code **)(*param_1 + 0x28))(&stack0xffffbb96,1);
  pbStack_443c = (byte *)0x0;
  (**(code **)(*param_1 + 0x28))(&pbStack_443c,2);
  pbStack_4430 = (byte *)((uint)pbStack_4444 & 0xffff);
  pbStack_4448 = (byte *)0x0;
  (**(code **)(*param_1 + 0x28))(&pbStack_4448,2);
  local_4434 = (byte *)(uint)uStack_4450;
  uStack_447c._0_3_ = (uint3)(ushort)uStack_447c;
  (**(code **)(*param_1 + 0x28))((int)&uStack_447c + 2,1);
  uVar10 = (uint)bStack_4452;
  if ((uVar10 == 0) || ((uVar10 == 0x18 || (uVar10 == 0x20)))) {
    pbStack_4470 = (byte *)0x2;
    pbStack_4474 = abStack_4418;
    abStack_4418[0] = 0;
    abStack_4418[1] = 0;
    abStack_4418[2] = 0;
    abStack_4418[3] = 0;
    pbStack_4478 = (byte *)0x519bf0;
    (**(code **)(*param_1 + 0x28))();
    pbStack_4478 = (byte *)0x2;
    uStack_447c = &pbStack_441c;
    pbStack_441c = (byte *)0x0;
    (**(code **)(*param_1 + 0x28))();
    (**(code **)(*param_1 + 0x28))(&stack0xffffbba0,2);
    pGStack_4438 = (GRefCountNTSImpl *)0x0;
    (**(code **)(*param_1 + 0x28))(&pGStack_4438,2);
    pbStack_4478 = (byte *)((uint)pbStack_4478 & 0xffffff00);
    (**(code **)(*param_1 + 0x28))(&pbStack_4478,1);
    uStack_447c = (byte **)((uint)uStack_447c & 0xffffff00);
    (**(code **)(*param_1 + 0x28))(&uStack_447c,1);
    if (cStack_4459 == '\0') {
      if (cStack_445a == '\x02') {
LAB_00519c77:
        if (bStack_4455 != 0) {
          pbStack_4470 = (byte *)(uint)bStack_4455;
          pbStack_4474 = (byte *)0x519c8c;
          (**(code **)(*param_1 + 0x2c))();
        }
        if (bStack_4458 == 8) {
          pbStack_4448 = (byte *)(uint)uStack_4450;
          pbStack_4444 = (byte *)0x64;
        }
        else if (bStack_4458 == 0x18) {
          pbStack_4448 = (byte *)((uint)uStack_4450 * 3);
          pbStack_4444 = (byte *)0x2;
        }
        else {
          if (bStack_4458 != 0x20) goto switchD_00519d4c_caseD_3;
          pbStack_4448 = (byte *)((uint)uStack_4450 * 4);
          pbStack_4444 = (byte *)0x1;
        }
        pbVar7 = pbStack_4448;
        pbVar12 = (byte *)(uint)uStack_4450;
        bStack_445b = bStack_4458;
        if (param_2 == (byte *)0x0) {
          if (pbStack_4444 == (byte *)0x64) {
            if (uVar10 < 0x20) {
              param_2 = (byte *)0x2;
              bStack_445b = 0x18;
              pbStack_444c = (byte *)((int)pbVar12 * 3);
            }
            else {
              param_2 = (byte *)0x1;
              bStack_445b = 0x20;
              pbStack_444c = (byte *)((int)pbVar12 * 4);
            }
          }
          else {
            param_2 = pbStack_4444;
            pbStack_444c = pbStack_4448;
          }
        }
        else {
          switch(param_2) {
          case (byte *)0x1:
            bStack_445b = 0x20;
            pbStack_444c = (byte *)((int)pbVar12 * 4);
            break;
          case (byte *)0x2:
            bStack_445b = 0x18;
            pbStack_444c = (byte *)((int)pbVar12 * 3);
            break;
          default:
            goto switchD_00519d4c_caseD_3;
          case (byte *)0x9:
          case (byte *)0x64:
            bStack_445b = 8;
            pbStack_444c = pbVar12;
          }
        }
        if ((cStack_4459 == '\x01') && (cStack_445a == '\x01')) {
          if (0x400 < (uVar10 + 7 >> 3) * uStack_440c) goto switchD_00519d4c_caseD_3;
          uStack_4408 = uVar10 == 0x20;
          uVar11 = 0;
          if (uStack_440c != 0) {
            do {
              unaff_ESI = unaff_ESI & 0xffffff;
              pbStack_4470 = (byte *)0x1;
              pbStack_4474 = &uStack_4457;
              uStack_4457 = 0;
              pbStack_4478 = (byte *)0x519dcc;
              (**(code **)(*param_1 + 0x28))();
              pcVar4 = *(code **)(*param_1 + 0x28);
              *(undefined1 *)((int)&uStack_440c + uVar11 * 4 + 2) = 0;
              pbStack_4478 = (byte *)0x1;
              uStack_447c = (byte **)&bStack_445b;
              bStack_445b = 0;
              (*pcVar4)();
              pcVar4 = *(code **)(*param_1 + 0x28);
              auStack_4413[uVar11 * 4] = (char)(unaff_ESI >> 8);
              (*pcVar4)(&stack0xffffbb9f,1);
              *(undefined1 *)(&uStack_4404 + uVar11) = uStack_4451;
              if (uVar10 == 0x20) {
                pbStack_4470 = (byte *)0x1;
                pbStack_4474 = &uStack_4456;
                uStack_4456 = 0;
                pbStack_4478 = (byte *)0x519e2b;
                (**(code **)(*param_1 + 0x28))();
                *(undefined1 *)((int)&uStack_4404 + uVar11 * 4 + 3) = uStack_4456;
              }
              else {
                (&uStack_4404)[uVar11] = (&uStack_4404)[uVar11] | 0xff000000;
              }
              uVar11 = uVar11 + 1;
            } while (uVar11 < uStack_440c);
          }
        }
        pbVar12 = (byte *)(uint)uStack_4420;
        pbStack_4478 = (byte *)(uint)uStack_4450;
        pbStack_4470 = local_4434;
        uStack_447c = (byte **)param_2;
        pbStack_4474 = pbVar12;
        pbStack_441c = pbVar12;
        this = (GRefCountNTSImpl *)FUN_00519a90();
        pGStack_4438 = this;
        if (this != (GRefCountNTSImpl *)0x0) {
          if (pbVar7 < (byte *)0x4001) {
            pbStack_443c = abStack_4004;
          }
          else {
            pbStack_4474 = (byte *)0x519e86;
            pbStack_4470 = pbVar7;
            pbStack_443c = (byte *)FUN_0045b5a0();
          }
          if ((bStack_4454 & 0x20) == 0) {
            pbStack_4440 = pbVar12 + -1;
          }
          else {
            pbStack_4440 = (byte *)0x0;
          }
          pbStack_4430 = (byte *)0x0;
          if (pbVar12 != (byte *)0x0) {
            pbStack_442c = (byte *)-(int)pbStack_4440;
            do {
              pbVar7 = pbStack_4440;
              if ((int)pbStack_4440 < 0) {
                pbVar7 = pbStack_442c;
              }
              local_4434 = (byte *)(*(int *)(this + 0x14) * (int)pbVar7 + *(int *)(this + 0x18));
              pbVar7 = local_4434;
              if (pbStack_4444 != param_2) {
                pbVar7 = pbStack_443c;
              }
              pbStack_4470 = pbStack_4448;
              pbStack_4478 = (byte *)0x519f0f;
              pbStack_4474 = pbVar7;
              pbVar6 = (byte *)(**(code **)(*param_1 + 0x28))();
              pbVar12 = pbStack_441c;
              if (pbVar6 != pbStack_4448) break;
              if (pbStack_4444 == (byte *)0x1) {
                if (uStack_4450 != 0) {
                  pbVar7 = pbVar7 + 2;
                  iVar9 = ((uint)uStack_4450 * 4 - 1 >> 2) + 1;
                  do {
                    bVar2 = pbVar7[-2];
                    pbVar7[-2] = *pbVar7;
                    *pbVar7 = bVar2;
                    pbVar7 = pbVar7 + 4;
                    iVar9 = iVar9 + -1;
                    this = pGStack_4438;
                  } while (iVar9 != 0);
                }
              }
              else if (pbStack_4444 == (byte *)0x2) {
                if ((uint)uStack_4450 * 3 != 0) {
                  pbVar7 = pbVar7 + 2;
                  iVar9 = ((uint)uStack_4450 * 3 - 1) / 3 + 1;
                  do {
                    bVar2 = pbVar7[-2];
                    pbVar7[-2] = *pbVar7;
                    *pbVar7 = bVar2;
                    pbVar7 = pbVar7 + 3;
                    iVar9 = iVar9 + -1;
                    this = pGStack_4438;
                  } while (iVar9 != 0);
                }
              }
              else if (param_2 == (byte *)0x64) {
                pGVar1 = this + 0x24;
                pbStack_4470 = (byte *)uStack_440c;
                pbStack_4474 = (byte *)0x519fb1;
                FUN_005198c0();
                uVar10 = 0;
                this = pGStack_4438;
                if (uStack_440c != 0) {
                  do {
                    iVar9 = uVar10 * 4;
                    puVar8 = (undefined1 *)(*(int *)pGVar1 + iVar9);
                    puVar8[2] = *(undefined1 *)(&uStack_4404 + uVar10);
                    puVar8[1] = *(undefined1 *)((int)&uStack_4404 + iVar9 + 1);
                    uVar3 = *(undefined1 *)((int)&uStack_4404 + iVar9 + 3);
                    uVar10 = uVar10 + 1;
                    *puVar8 = *(undefined1 *)((int)&uStack_4404 + iVar9 + 2);
                    puVar8[3] = uVar3;
                  } while (uVar10 < uStack_440c);
                }
              }
              if (pbStack_4444 != param_2) {
                pbStack_4470 = auStack_4413 + 3;
                pbStack_4474 = pbStack_444c;
                uStack_447c = (byte **)(uint)bStack_4458;
                pbStack_4478 = param_2;
                cVar5 = FUN_00519080(pbStack_443c);
                pbVar12 = pbStack_441c;
                if (cVar5 == '\0') break;
              }
              pbStack_4440 = pbStack_4440 + -1;
              pbStack_442c = pbStack_442c + 1;
              pbStack_4430 = pbStack_4430 + 1;
              pbVar12 = pbStack_441c;
            } while (pbStack_4430 < pbStack_441c);
          }
          if ((pbStack_443c != (byte *)0x0) && (pbStack_443c != abStack_4004)) {
            pbStack_4474 = (byte *)0x51a06e;
            pbStack_4470 = pbStack_443c;
            FUN_00515cf0();
          }
          if (pbStack_4430 < pbVar12) {
            pbStack_4470 = (byte *)0x51a07b;
            GRefCountNTSImpl::Release(this);
            goto switchD_00519d4c_caseD_3;
          }
        }
        *(int *)(this + 4) = *(int *)(this + 4) + 1;
        pbStack_4470 = (byte *)0x51a0a2;
        GRefCountNTSImpl::Release(this);
        goto LAB_0051a07f;
      }
    }
    else if ((cStack_4459 == '\x01') && (cStack_445a == '\x01')) goto LAB_00519c77;
  }
switchD_00519d4c_caseD_3:
LAB_0051a07f:
  __security_check_cookie(local_4 ^ (uint)&uStack_445c);
  return;
}



============================================================
DISASSEMBLY
============================================================
00519af0 : MOV EAX,0x445c
00519af5 : CALL 0x0063b780
00519afa : MOV EAX,[0x00d66fa0]
00519aff : XOR EAX,ESP
00519b01 : MOV dword ptr [ESP + 0x4458],EAX
00519b08 : MOV EAX,dword ptr [ESP + 0x4468]
00519b0f : PUSH EBX
00519b10 : PUSH ESI
00519b11 : MOV ESI,dword ptr [ESP + 0x4468]
00519b18 : XOR EBX,EBX
00519b1a : MOV dword ptr [ESP + 0x30],EAX
00519b1e : CMP ESI,EBX
00519b20 : JZ 0x0051a0a6
00519b26 : MOV EDX,dword ptr [ESI]
00519b28 : MOV EAX,dword ptr [EDX + 0x8]
00519b2b : MOV ECX,ESI
00519b2d : CALL EAX
00519b2f : TEST AL,AL
00519b31 : JZ 0x0051a0a6
00519b37 : MOV EDX,dword ptr [ESI]
00519b39 : MOV EDX,dword ptr [EDX + 0x28]
00519b3c : PUSH EBP
00519b3d : PUSH EDI
00519b3e : PUSH 0x1
00519b40 : LEA EAX,[ESP + 0x1b]
00519b44 : PUSH EAX
00519b45 : MOV ECX,ESI
00519b47 : MOV byte ptr [ESP + 0x1f],BL
00519b4b : CALL EDX
00519b4d : MOV EAX,dword ptr [ESI]
00519b4f : MOV EDX,dword ptr [EAX + 0x28]
00519b52 : PUSH 0x1
00519b54 : LEA ECX,[ESP + 0x17]
00519b58 : PUSH ECX
00519b59 : MOV ECX,ESI
00519b5b : MOV byte ptr [ESP + 0x1b],BL
00519b5f : CALL EDX
00519b61 : MOV EAX,dword ptr [ESI]
00519b63 : MOV EDX,dword ptr [EAX + 0x28]
00519b66 : PUSH 0x1
00519b68 : LEA ECX,[ESP + 0x16]
00519b6c : PUSH ECX
00519b6d : MOV ECX,ESI
00519b6f : MOV byte ptr [ESP + 0x1a],BL
00519b73 : CALL EDX
00519b75 : MOV EAX,dword ptr [ESI]
00519b77 : MOV EDX,dword ptr [EAX + 0x28]
00519b7a : MOV EDI,0x2
00519b7f : PUSH EDI
00519b80 : LEA ECX,[ESP + 0x4c]
00519b84 : PUSH ECX
00519b85 : MOV ECX,ESI
00519b87 : MOV dword ptr [ESP + 0x50],EBX
00519b8b : CALL EDX
00519b8d : MOVZX EAX,word ptr [ESP + 0x48]
00519b92 : MOV EDX,dword ptr [ESI]
00519b94 : MOV EDX,dword ptr [EDX + 0x28]
00519b97 : MOV dword ptr [ESP + 0x5c],EAX
00519b9b : PUSH EDI
00519b9c : LEA EAX,[ESP + 0x48]
00519ba0 : PUSH EAX
00519ba1 : MOV ECX,ESI
00519ba3 : MOV dword ptr [ESP + 0x4c],EBX
00519ba7 : CALL EDX
00519ba9 : MOVZX EAX,word ptr [ESP + 0x44]
00519bae : MOV EDX,dword ptr [ESI]
00519bb0 : MOV EDX,dword ptr [EDX + 0x28]
00519bb3 : MOV dword ptr [ESP + 0x60],EAX
00519bb7 : PUSH 0x1
00519bb9 : LEA EAX,[ESP + 0x1e]
00519bbd : PUSH EAX
00519bbe : MOV ECX,ESI
00519bc0 : MOV byte ptr [ESP + 0x22],BL
00519bc4 : CALL EDX
00519bc6 : MOVZX EBP,byte ptr [ESP + 0x1a]
00519bcb : CMP EBP,EBX
00519bcd : JBE 0x00519bdd
00519bcf : CMP EBP,0x18
00519bd2 : JZ 0x00519bdd
00519bd4 : CMP EBP,0x20
00519bd7 : JNZ 0x0051a07b
00519bdd : MOV EAX,dword ptr [ESI]
00519bdf : MOV EDX,dword ptr [EAX + 0x28]
00519be2 : PUSH EDI
00519be3 : LEA ECX,[ESP + 0x58]
00519be7 : PUSH ECX
00519be8 : MOV ECX,ESI
00519bea : MOV dword ptr [ESP + 0x5c],EBX
00519bee : CALL EDX
00519bf0 : MOV EAX,dword ptr [ESI]
00519bf2 : MOV EDX,dword ptr [EAX + 0x28]
00519bf5 : PUSH EDI
00519bf6 : LEA ECX,[ESP + 0x5c]
00519bfa : PUSH ECX
00519bfb : MOV ECX,ESI
00519bfd : MOV dword ptr [ESP + 0x60],EBX
00519c01 : CALL EDX
00519c03 : MOV EAX,dword ptr [ESI]
00519c05 : MOV EDX,dword ptr [EAX + 0x28]
00519c08 : PUSH EDI
00519c09 : LEA ECX,[ESP + 0x20]
00519c0d : PUSH ECX
00519c0e : MOV ECX,ESI
00519c10 : MOV dword ptr [ESP + 0x24],EBX
00519c14 : CALL EDX
00519c16 : MOV EAX,dword ptr [ESI]
00519c18 : MOV EDX,dword ptr [EAX + 0x28]
00519c1b : PUSH EDI
00519c1c : LEA ECX,[ESP + 0x50]
00519c20 : PUSH ECX
00519c21 : MOV ECX,ESI
00519c23 : MOV dword ptr [ESP + 0x54],EBX
00519c27 : CALL EDX
00519c29 : MOV EAX,dword ptr [ESI]
00519c2b : MOV EDX,dword ptr [EAX + 0x28]
00519c2e : PUSH 0x1
00519c30 : LEA ECX,[ESP + 0x18]
00519c34 : PUSH ECX
00519c35 : MOV ECX,ESI
00519c37 : MOV byte ptr [ESP + 0x1c],BL
00519c3b : CALL EDX
00519c3d : MOV EAX,dword ptr [ESI]
00519c3f : MOV EDX,dword ptr [EAX + 0x28]
00519c42 : PUSH 0x1
00519c44 : LEA ECX,[ESP + 0x1c]
00519c48 : PUSH ECX
00519c49 : MOV ECX,ESI
00519c4b : MOV byte ptr [ESP + 0x20],BL
00519c4f : CALL EDX
00519c51 : MOV AL,byte ptr [ESP + 0x13]
00519c55 : TEST AL,AL
00519c57 : JNZ 0x00519c65
00519c59 : CMP byte ptr [ESP + 0x12],0x2
00519c5e : JZ 0x00519c77
00519c60 : JMP 0x0051a07b
00519c65 : CMP AL,0x1
00519c67 : JNZ 0x0051a07b
00519c6d : CMP byte ptr [ESP + 0x12],AL
00519c71 : JNZ 0x0051a07b
00519c77 : MOV AL,byte ptr [ESP + 0x17]
00519c7b : TEST AL,AL
00519c7d : JBE 0x00519c8c
00519c7f : MOV EDX,dword ptr [ESI]
00519c81 : MOV EDX,dword ptr [EDX + 0x2c]
00519c84 : MOVZX EAX,AL
00519c87 : PUSH EAX
00519c88 : MOV ECX,ESI
00519c8a : CALL EDX
00519c8c : MOV CL,byte ptr [ESP + 0x14]
00519c90 : MOV DL,0x8
00519c92 : CMP CL,DL
00519c94 : JZ 0x00519cd0
00519c96 : CMP CL,0x18
00519c99 : JZ 0x00519cbe
00519c9b : CMP CL,0x20
00519c9e : JNZ 0x0051a07b
00519ca4 : MOVZX EAX,word ptr [ESP + 0x1c]
00519ca9 : LEA EBX,[EAX*0x4 + 0x0]
00519cb0 : MOV dword ptr [ESP + 0x28],0x1
00519cb8 : MOV dword ptr [ESP + 0x24],EBX
00519cbc : JMP 0x00519ce3
00519cbe : MOVZX EAX,word ptr [ESP + 0x1c]
00519cc3 : LEA EBX,[EAX + EAX*0x2]
00519cc6 : MOV dword ptr [ESP + 0x28],EDI
00519cca : MOV dword ptr [ESP + 0x24],EBX
00519cce : JMP 0x00519ce3
00519cd0 : MOVZX EAX,word ptr [ESP + 0x1c]
00519cd5 : MOV dword ptr [ESP + 0x28],0x64
00519cdd : MOV dword ptr [ESP + 0x24],EAX
00519ce1 : MOV EBX,EAX
00519ce3 : MOV byte ptr [ESP + 0x11],CL
00519ce7 : MOV ECX,dword ptr [ESP + 0x4474]
00519cee : TEST ECX,ECX
00519cf0 : JNZ 0x00519d3b
00519cf2 : MOV ECX,dword ptr [ESP + 0x28]
00519cf6 : CMP ECX,0x64
00519cf9 : JNZ 0x00519d2e
00519cfb : CMP EBP,0x20
00519cfe : JNC 0x00519d11
00519d00 : MOV dword ptr [ESP + 0x4474],EDI
00519d07 : LEA EAX,[EAX + EAX*0x2]
00519d0a : MOV byte ptr [ESP + 0x11],0x18
00519d0f : JMP 0x00519d70
00519d11 : LEA ECX,[EAX*0x4 + 0x0]
00519d18 : MOV dword ptr [ESP + 0x4474],0x1
00519d23 : MOV dword ptr [ESP + 0x20],ECX
00519d27 : MOV byte ptr [ESP + 0x11],0x20
00519d2c : JMP 0x00519d74
00519d2e : MOV dword ptr [ESP + 0x4474],ECX
00519d35 : MOV dword ptr [ESP + 0x20],EBX
00519d39 : JMP 0x00519d74
00519d3b : DEC ECX
00519d3c : CMP ECX,0x63
00519d3f : JA 0x0051a07b
00519d45 : MOVZX ECX,byte ptr [ECX + 0x51a0bc]
00519d4c : JMP dword ptr [ECX*0x4 + 0x51a0ac]
00519d53 : MOV byte ptr [ESP + 0x11],DL
00519d57 : JMP 0x00519d70
00519d59 : LEA EDX,[EAX + EAX*0x2]
00519d5c : MOV byte ptr [ESP + 0x11],0x18
00519d61 : MOV dword ptr [ESP + 0x20],EDX
00519d65 : JMP 0x00519d74
00519d67 : ADD EAX,EAX
00519d69 : MOV byte ptr [ESP + 0x11],0x20
00519d6e : ADD EAX,EAX
00519d70 : MOV dword ptr [ESP + 0x20],EAX
00519d74 : CMP byte ptr [ESP + 0x13],0x1
00519d79 : JNZ 0x00519e48
00519d7f : CMP byte ptr [ESP + 0x12],0x1
00519d84 : JNZ 0x00519e48
00519d8a : MOV EAX,dword ptr [ESP + 0x60]
00519d8e : LEA ECX,[EBP + 0x7]
00519d91 : SHR ECX,0x3
00519d94 : IMUL ECX,EAX
00519d97 : CMP ECX,0x400
00519d9d : JA 0x0051a07b
00519da3 : CMP EBP,0x20
00519da6 : SETZ DL
00519da9 : XOR EDI,EDI
00519dab : MOV byte ptr [ESP + 0x64],DL
00519daf : TEST EAX,EAX
00519db1 : JBE 0x00519e48
00519db7 : MOV EAX,dword ptr [ESI]
00519db9 : MOV EDX,dword ptr [EAX + 0x28]
00519dbc : PUSH 0x1
00519dbe : LEA ECX,[ESP + 0x19]
00519dc2 : PUSH ECX
00519dc3 : MOV ECX,ESI
00519dc5 : MOV byte ptr [ESP + 0x1d],0x0
00519dca : CALL EDX
00519dcc : MOVZX EAX,byte ptr [ESP + 0x15]
00519dd1 : MOV EDX,dword ptr [ESI]
00519dd3 : MOV EDX,dword ptr [EDX + 0x28]
00519dd6 : MOV byte ptr [ESP + EDI*0x4 + 0x6a],AL
00519dda : PUSH 0x1
00519ddc : LEA EAX,[ESP + 0x1d]
00519de0 : PUSH EAX
00519de1 : MOV ECX,ESI
00519de3 : MOV byte ptr [ESP + 0x21],0x0
00519de8 : CALL EDX
00519dea : MOVZX EAX,byte ptr [ESP + 0x19]
00519def : MOV EDX,dword ptr [ESI]
00519df1 : MOV EDX,dword ptr [EDX + 0x28]
00519df4 : MOV byte ptr [ESP + EDI*0x4 + 0x69],AL
00519df8 : PUSH 0x1
00519dfa : LEA EAX,[ESP + 0x1f]
00519dfe : PUSH EAX
00519dff : MOV ECX,ESI
00519e01 : MOV byte ptr [ESP + 0x23],0x0
00519e06 : CALL EDX
00519e08 : MOVZX EAX,byte ptr [ESP + 0x1b]
00519e0d : MOV byte ptr [ESP + EDI*0x4 + 0x68],AL
00519e11 : CMP EBP,0x20
00519e14 : JNZ 0x00519e35
00519e16 : MOV EDX,dword ptr [ESI]
00519e18 : MOV EDX,dword ptr [EDX + 0x28]
00519e1b : PUSH 0x1
00519e1d : LEA EAX,[ESP + 0x1a]
00519e21 : PUSH EAX
00519e22 : MOV ECX,ESI
00519e24 : MOV byte ptr [ESP + 0x1e],0x0
00519e29 : CALL EDX
00519e2b : MOV AL,byte ptr [ESP + 0x16]
00519e2f : MOV byte ptr [ESP + EDI*0x4 + 0x6b],AL
00519e33 : JMP 0x00519e3d
00519e35 : OR dword ptr [ESP + EDI*0x4 + 0x68],0xff000000
00519e3d : INC EDI
00519e3e : CMP EDI,dword ptr [ESP + 0x60]
00519e42 : JC 0x00519db7
00519e48 : MOVZX EDI,word ptr [ESP + 0x4c]
00519e4d : MOV ECX,dword ptr [ESP + 0x38]
00519e51 : MOVZX EAX,word ptr [ESP + 0x1c]
00519e56 : MOV EDX,dword ptr [ESP + 0x4474]
00519e5d : PUSH ECX
00519e5e : PUSH EDI
00519e5f : PUSH EAX
00519e60 : PUSH EDX
00519e61 : MOV dword ptr [ESP + 0x60],EDI
00519e65 : CALL 0x00519a90
00519e6a : MOV EBP,EAX
00519e6c : MOV dword ptr [ESP + 0x34],EBP
00519e70 : TEST EBP,EBP
00519e72 : JZ 0x0051a098
00519e78 : CMP EBX,0x4000
00519e7e : JBE 0x00519e8e
00519e80 : PUSH EBX
00519e81 : CALL 0x0045b5a0
00519e86 : MOV EDX,EAX
00519e88 : MOV dword ptr [ESP + 0x30],EDX
00519e8c : JMP 0x00519e9b
00519e8e : LEA EAX,[ESP + 0x468]
00519e95 : MOV dword ptr [ESP + 0x30],EAX
00519e99 : MOV EDX,EAX
00519e9b : TEST byte ptr [ESP + 0x18],0x20
00519ea0 : JZ 0x00519eaa
00519ea2 : XOR EAX,EAX
00519ea4 : MOV dword ptr [ESP + 0x2c],EAX
00519ea8 : JMP 0x00519eb3
00519eaa : LEA ECX,[EDI + -0x1]
00519ead : MOV dword ptr [ESP + 0x2c],ECX
00519eb1 : MOV EAX,ECX
00519eb3 : MOV dword ptr [ESP + 0x3c],0x0
00519ebb : TEST EDI,EDI
00519ebd : JBE 0x0051a059
00519ec3 : MOV ECX,EAX
00519ec5 : NEG ECX
00519ec7 : MOV dword ptr [ESP + 0x40],ECX
00519ecb : JMP 0x00519edc
00519ed0 : MOV ECX,dword ptr [ESP + 0x40]
00519ed4 : MOV EDX,dword ptr [ESP + 0x30]
00519ed8 : MOV EAX,dword ptr [ESP + 0x2c]
00519edc : TEST EAX,EAX
00519ede : JGE 0x00519ee2
00519ee0 : MOV EAX,ECX
00519ee2 : MOV EBX,dword ptr [EBP + 0x14]
00519ee5 : IMUL EBX,EAX
00519ee8 : ADD EBX,dword ptr [EBP + 0x18]
00519eeb : MOV EAX,dword ptr [ESP + 0x4474]
00519ef2 : MOV dword ptr [ESP + 0x38],EBX
00519ef6 : MOV EDI,EBX
00519ef8 : CMP dword ptr [ESP + 0x28],EAX
00519efc : JZ 0x00519f00
00519efe : MOV EDI,EDX
00519f00 : MOV EAX,dword ptr [ESP + 0x24]
00519f04 : MOV EDX,dword ptr [ESI]
00519f06 : MOV EDX,dword ptr [EDX + 0x28]
00519f09 : PUSH EAX
00519f0a : PUSH EDI
00519f0b : MOV ECX,ESI
00519f0d : CALL EDX
00519f0f : CMP EAX,dword ptr [ESP + 0x24]
00519f13 : JNZ 0x0051a051
00519f19 : MOV EAX,dword ptr [ESP + 0x28]
00519f1d : CMP EAX,0x1
00519f20 : JNZ 0x00519f5b
00519f22 : MOVZX EAX,word ptr [ESP + 0x1c]
00519f27 : LEA ECX,[EAX*0x4 + 0x0]
00519f2e : TEST ECX,ECX
00519f30 : JBE 0x00519ff4
00519f36 : DEC ECX
00519f37 : SHR ECX,0x2
00519f3a : LEA EAX,[EDI + 0x2]
00519f3d : INC ECX
00519f3e : MOV EDI,EDI
00519f40 : MOV DL,byte ptr [EAX + -0x2]
00519f43 : MOV BL,byte ptr [EAX]
00519f45 : MOV byte ptr [EAX + -0x2],BL
00519f48 : MOV byte ptr [EAX],DL
00519f4a : ADD EAX,0x4
00519f4d : SUB ECX,0x1
00519f50 : JNZ 0x00519f40
00519f52 : MOV EBX,dword ptr [ESP + 0x38]
00519f56 : JMP 0x00519ff0
00519f5b : CMP EAX,0x2
00519f5e : JNZ 0x00519f98
00519f60 : MOVZX EAX,word ptr [ESP + 0x1c]
00519f65 : LEA EAX,[EAX + EAX*0x2]
00519f68 : TEST EAX,EAX
00519f6a : JBE 0x00519ff4
00519f70 : LEA EDX,[EAX + -0x1]
00519f73 : MOV EAX,0xaaaaaaab
00519f78 : MUL EDX
00519f7a : SHR EDX,0x1
00519f7c : LEA ECX,[EDI + 0x2]
00519f7f : INC EDX
00519f80 : MOV AL,byte ptr [ECX + -0x2]
00519f83 : MOV BL,byte ptr [ECX]
00519f85 : MOV byte ptr [ECX + -0x2],BL
00519f88 : MOV byte ptr [ECX],AL
00519f8a : ADD ECX,0x3
00519f8d : SUB EDX,0x1
00519f90 : JNZ 0x00519f80
00519f92 : MOV EBX,dword ptr [ESP + 0x38]
00519f96 : JMP 0x00519ff0
00519f98 : CMP dword ptr [ESP + 0x4474],0x64
00519fa0 : JNZ 0x00519ff4
00519fa2 : MOV EAX,dword ptr [ESP + 0x60]
00519fa6 : LEA EDI,[EBP + 0x24]
00519fa9 : PUSH EAX
00519faa : MOV ECX,EDI
00519fac : CALL 0x005198c0
00519fb1 : XOR EBP,EBP
00519fb3 : CMP dword ptr [ESP + 0x60],EBP
00519fb7 : JBE 0x00519ff0
00519fb9 : LEA ESP,[ESP]
00519fc0 : MOV EAX,dword ptr [EDI]
00519fc2 : LEA ECX,[EBP*0x4 + 0x0]
00519fc9 : MOVZX EDX,byte ptr [ESP + ECX*0x1 + 0x68]
00519fce : ADD EAX,ECX
00519fd0 : LEA ECX,[ESP + ECX*0x1 + 0x69]
00519fd4 : MOV byte ptr [EAX + 0x2],DL
00519fd7 : MOVZX EDX,byte ptr [ECX]
00519fda : MOV byte ptr [EAX + 0x1],DL
00519fdd : MOVZX EDX,byte ptr [ECX + 0x1]
00519fe1 : MOV CL,byte ptr [ECX + 0x2]
00519fe4 : INC EBP
00519fe5 : MOV byte ptr [EAX],DL
00519fe7 : MOV byte ptr [EAX + 0x3],CL
00519fea : CMP EBP,dword ptr [ESP + 0x60]
00519fee : JC 0x00519fc0
00519ff0 : MOV EBP,dword ptr [ESP + 0x34]
00519ff4 : MOV EDX,dword ptr [ESP + 0x28]
00519ff8 : MOV EAX,dword ptr [ESP + 0x4474]
00519fff : CMP EDX,EAX
0051a001 : JZ 0x0051a030
0051a003 : MOV EDI,dword ptr [ESP + 0x24]
0051a007 : LEA ECX,[ESP + 0x5c]
0051a00b : PUSH ECX
0051a00c : MOV ECX,dword ptr [ESP + 0x24]
0051a010 : PUSH ECX
0051a011 : MOVZX ECX,byte ptr [ESP + 0x1c]
0051a016 : PUSH EAX
0051a017 : MOVZX EAX,byte ptr [ESP + 0x1d]
0051a01c : PUSH ECX
0051a01d : MOV ECX,dword ptr [ESP + 0x40]
0051a021 : PUSH ECX
0051a022 : MOV ECX,EBX
0051a024 : CALL 0x00519080
0051a029 : ADD ESP,0x14
0051a02c : TEST AL,AL
0051a02e : JZ 0x0051a051
0051a030 : MOV EAX,dword ptr [ESP + 0x3c]
0051a034 : MOV ECX,0x1
0051a039 : SUB dword ptr [ESP + 0x2c],ECX
0051a03d : ADD dword ptr [ESP + 0x40],ECX
0051a041 : ADD EAX,ECX
0051a043 : MOV dword ptr [ESP + 0x3c],EAX
0051a047 : CMP EAX,dword ptr [ESP + 0x50]
0051a04b : JC 0x00519ed0
0051a051 : MOV EDI,dword ptr [ESP + 0x50]
0051a055 : MOV EDX,dword ptr [ESP + 0x30]
0051a059 : TEST EDX,EDX
0051a05b : JZ 0x0051a06e
0051a05d : LEA EAX,[ESP + 0x468]
0051a064 : CMP EDX,EAX
0051a066 : JZ 0x0051a06e
0051a068 : PUSH EDX
0051a069 : CALL 0x00515cf0
0051a06e : CMP dword ptr [ESP + 0x3c],EDI
0051a072 : JNC 0x0051a098
0051a074 : MOV ECX,EBP
0051a076 : CALL 0x004ff7c0
0051a07b : XOR EAX,EAX
0051a07d : POP EDI
0051a07e : POP EBP
0051a07f : MOV ECX,dword ptr [ESP + 0x4460]
0051a086 : POP ESI
0051a087 : POP EBX
0051a088 : XOR ECX,ESP
0051a08a : CALL 0x00633e6b
0051a08f : ADD ESP,0x445c
0051a095 : RET 0xc
0051a098 : INC dword ptr [EBP + 0x4]
0051a09b : MOV ECX,EBP
0051a09d : CALL 0x004ff7c0
0051a0a2 : MOV EAX,EBP
0051a0a4 : JMP 0x0051a07d
0051a0a6 : XOR EAX,EAX
0051a0a8 : JMP 0x0051a07f

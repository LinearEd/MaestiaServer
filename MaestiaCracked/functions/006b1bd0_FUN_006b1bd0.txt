PROGRAM  : Maestia.exe
FUNCTION : FUN_006b1bd0
ENTRY    : 006b1bd0
BODY     : [[006b1bd0, 006b1dd4]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006b1bd0(int param_1,int param_2)

{
  undefined4 *puVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined1 local_14 [8];
  int iStack_c;
  code *pcStack_8;
  int iStack_4;
  
  iVar3 = param_2;
  puVar1 = (undefined4 *)(param_2 + 0x1c);
  param_2 = 2;
  iVar4 = FUN_00688c00(*puVar1,0x2c,&param_2);
  if ((param_2 != 0) || (param_2 = FUN_00688900(iVar3,*(undefined4 *)(iVar3 + 4)), param_2 != 0))
  goto LAB_006b1dbc;
  *(undefined4 *)(iVar4 + 4) = *(undefined4 *)(param_1 + 0x1c8);
  *(undefined4 *)(iVar4 + 8) = *(undefined4 *)(param_1 + 0x1cc);
  *(undefined4 *)(iVar4 + 0xc) = *(undefined4 *)(param_1 + 0x1d0);
  *(undefined4 *)(iVar4 + 0x10) = *(undefined4 *)(param_1 + 0x1d4);
  *(undefined4 *)(iVar4 + 0x14) = *(undefined4 *)(param_1 + 0x1d4);
  *(undefined4 *)(iVar4 + 0x18) = *(undefined4 *)(param_1 + 0x1cc);
  iVar2 = *(int *)(param_1 + 0x1e4);
  if ((iVar2 != 0) &&
     ((*(undefined4 **)(iVar2 + 0x18) != (undefined4 *)0x0 &&
      (param_2 = (*(code *)**(undefined4 **)(iVar2 + 0x18))
                           (local_14,*(undefined4 *)(iVar3 + 0x1c),*(undefined4 *)(iVar3 + 0x20),
                            *(undefined4 *)(iVar3 + 0x24)), param_2 == 0)))) {
    pcStack_8 = FUN_006b1960;
    iStack_c = iVar4;
    iStack_4 = param_1 + 0x84;
    param_2 = (**(code **)(*(int *)(iVar2 + 0x18) + 8))(local_14);
    (**(code **)(*(int *)(iVar2 + 0x18) + 4))(local_14);
  }
  if (param_2 == 2) {
    if (((6 < *(uint *)(iVar3 + 4)) && (*(byte *)(*(int *)(iVar3 + 0x20) + 1) < 4)) &&
       (*(int *)(*(int *)(iVar3 + 0x20) + 2) == *(int *)(iVar3 + 4))) {
      param_2 = FUN_006b19e0(iVar4);
      goto LAB_006b1d26;
    }
  }
  else {
LAB_006b1d26:
    if (param_2 == 0) {
      *(undefined4 *)(param_1 + 0x1c8) = *(undefined4 *)(iVar4 + 4);
      *(undefined4 *)(param_1 + 0x1cc) = *(undefined4 *)(iVar4 + 8);
      *(undefined4 *)(param_1 + 0x1d0) = *(undefined4 *)(iVar4 + 0xc);
      *(undefined4 *)(param_1 + 0x1d4) = *(undefined4 *)(iVar4 + 0x10);
      *(int *)(param_1 + 0x34) = (int)*(short *)(iVar4 + 6);
      *(int *)(param_1 + 0x38) = (int)*(short *)(iVar4 + 10);
      *(uint *)(param_1 + 0x3c) = *(int *)(iVar4 + 0xc) + 0xffffU >> 0x10;
      *(uint *)(param_1 + 0x40) = *(int *)(iVar4 + 0x10) + 0xffffU >> 0x10;
      *(short *)(param_1 + 0x46) = (short)((uint)(*(int *)(iVar4 + 0x14) + 0x8000) >> 0x10);
      *(short *)(param_1 + 0x48) = (short)((uint)(*(int *)(iVar4 + 0x18) + 0x8000) >> 0x10);
      if (*(int *)(iVar4 + 0x28) != 0) {
        *(uint *)(param_1 + 8) = *(uint *)(param_1 + 8) | 0x40;
        *(int *)(param_1 + 0x1e8) = iVar4;
        iVar4 = 0;
      }
    }
  }
  FUN_006889b0(iVar3);
LAB_006b1dbc:
  if (iVar4 != 0) {
    FUN_006b1930();
  }
  return param_2;
}



============================================================
DISASSEMBLY
============================================================
006b1bd0 : SUB ESP,0x18
006b1bd3 : PUSH EBX
006b1bd4 : MOV EBX,dword ptr [ESP + 0x20]
006b1bd8 : PUSH EBP
006b1bd9 : PUSH ESI
006b1bda : PUSH EDI
006b1bdb : MOV EDI,dword ptr [ESP + 0x30]
006b1bdf : MOV EAX,dword ptr [EDI + 0x1c]
006b1be2 : LEA ECX,[ESP + 0x30]
006b1be6 : PUSH ECX
006b1be7 : PUSH 0x2c
006b1be9 : PUSH EAX
006b1bea : MOV dword ptr [ESP + 0x1c],EAX
006b1bee : MOV dword ptr [ESP + 0x3c],0x2
006b1bf6 : LEA EBP,[EBX + 0x84]
006b1bfc : CALL 0x00688c00
006b1c01 : MOV ESI,EAX
006b1c03 : MOV EAX,dword ptr [ESP + 0x3c]
006b1c07 : ADD ESP,0xc
006b1c0a : TEST EAX,EAX
006b1c0c : JNZ 0x006b1dbc
006b1c12 : MOV EDX,dword ptr [EDI + 0x4]
006b1c15 : PUSH EDX
006b1c16 : PUSH EDI
006b1c17 : CALL 0x00688900
006b1c1c : ADD ESP,0x8
006b1c1f : MOV dword ptr [ESP + 0x30],EAX
006b1c23 : TEST EAX,EAX
006b1c25 : JNZ 0x006b1dbc
006b1c2b : MOV EAX,dword ptr [EBP + 0x144]
006b1c31 : MOV dword ptr [ESI + 0x4],EAX
006b1c34 : MOV ECX,dword ptr [EBP + 0x148]
006b1c3a : MOV dword ptr [ESI + 0x8],ECX
006b1c3d : MOV EDX,dword ptr [EBP + 0x14c]
006b1c43 : MOV dword ptr [ESI + 0xc],EDX
006b1c46 : MOV EAX,dword ptr [EBP + 0x150]
006b1c4c : MOV dword ptr [ESI + 0x10],EAX
006b1c4f : MOV ECX,dword ptr [EBP + 0x150]
006b1c55 : MOV dword ptr [ESI + 0x14],ECX
006b1c58 : MOV EDX,dword ptr [EBP + 0x148]
006b1c5e : MOV dword ptr [ESI + 0x18],EDX
006b1c61 : MOV EAX,dword ptr [EBX + 0x1e4]
006b1c67 : MOV dword ptr [ESP + 0x2c],EAX
006b1c6b : TEST EAX,EAX
006b1c6d : JZ 0x006b1ccf
006b1c6f : MOV EAX,dword ptr [EAX + 0x18]
006b1c72 : TEST EAX,EAX
006b1c74 : JZ 0x006b1ccf
006b1c76 : MOV ECX,dword ptr [EDI + 0x24]
006b1c79 : MOV EDX,dword ptr [EDI + 0x20]
006b1c7c : MOV EAX,dword ptr [EAX]
006b1c7e : PUSH ECX
006b1c7f : MOV ECX,dword ptr [EDI + 0x1c]
006b1c82 : PUSH EDX
006b1c83 : PUSH ECX
006b1c84 : LEA EDX,[ESP + 0x20]
006b1c88 : PUSH EDX
006b1c89 : CALL EAX
006b1c8b : ADD ESP,0x10
006b1c8e : MOV dword ptr [ESP + 0x30],EAX
006b1c92 : TEST EAX,EAX
006b1c94 : JNZ 0x006b1cd3
006b1c96 : MOV ECX,dword ptr [ESP + 0x2c]
006b1c9a : MOV dword ptr [ESP + 0x1c],ESI
006b1c9e : MOV dword ptr [ESP + 0x20],0x6b1960
006b1ca6 : MOV dword ptr [ESP + 0x24],EBP
006b1caa : MOV EDX,dword ptr [ECX + 0x18]
006b1cad : MOV ECX,dword ptr [EDX + 0x8]
006b1cb0 : LEA EAX,[ESP + 0x14]
006b1cb4 : PUSH EAX
006b1cb5 : CALL ECX
006b1cb7 : MOV EDX,dword ptr [ESP + 0x30]
006b1cbb : MOV dword ptr [ESP + 0x34],EAX
006b1cbf : MOV EAX,dword ptr [EDX + 0x18]
006b1cc2 : MOV EDX,dword ptr [EAX + 0x4]
006b1cc5 : LEA ECX,[ESP + 0x18]
006b1cc9 : PUSH ECX
006b1cca : CALL EDX
006b1ccc : ADD ESP,0x8
006b1ccf : MOV EAX,dword ptr [ESP + 0x30]
006b1cd3 : CMP EAX,0x2
006b1cd6 : JNZ 0x006b1d26
006b1cd8 : CMP dword ptr [EDI + 0x4],0x6
006b1cdc : MOV EAX,dword ptr [EDI + 0x20]
006b1cdf : JBE 0x006b1daf
006b1ce5 : CMP byte ptr [EAX + 0x1],0x4
006b1ce9 : JNC 0x006b1daf
006b1cef : MOVZX ECX,byte ptr [EAX + 0x5]
006b1cf3 : MOVZX EDX,byte ptr [EAX + 0x4]
006b1cf7 : SHL ECX,0x8
006b1cfa : OR ECX,EDX
006b1cfc : MOVZX EDX,byte ptr [EAX + 0x3]
006b1d00 : MOVZX EAX,byte ptr [EAX + 0x2]
006b1d04 : SHL ECX,0x8
006b1d07 : OR ECX,EDX
006b1d09 : SHL ECX,0x8
006b1d0c : OR ECX,EAX
006b1d0e : CMP ECX,dword ptr [EDI + 0x4]
006b1d11 : JNZ 0x006b1daf
006b1d17 : PUSH ESI
006b1d18 : MOV ECX,EDI
006b1d1a : CALL 0x006b19e0
006b1d1f : ADD ESP,0x4
006b1d22 : MOV dword ptr [ESP + 0x30],EAX
006b1d26 : TEST EAX,EAX
006b1d28 : JNZ 0x006b1daf
006b1d2e : MOV ECX,dword ptr [ESI + 0x4]
006b1d31 : MOV dword ptr [EBP + 0x144],ECX
006b1d37 : MOV EDX,dword ptr [ESI + 0x8]
006b1d3a : MOV dword ptr [EBP + 0x148],EDX
006b1d40 : MOV EAX,dword ptr [ESI + 0xc]
006b1d43 : MOV dword ptr [EBP + 0x14c],EAX
006b1d49 : MOV ECX,dword ptr [ESI + 0x10]
006b1d4c : MOV dword ptr [EBP + 0x150],ECX
006b1d52 : MOVSX EDX,word ptr [ESI + 0x6]
006b1d56 : MOV dword ptr [EBX + 0x34],EDX
006b1d59 : MOVSX EAX,word ptr [ESI + 0xa]
006b1d5d : MOV dword ptr [EBX + 0x38],EAX
006b1d60 : MOV ECX,dword ptr [ESI + 0xc]
006b1d63 : ADD ECX,0xffff
006b1d69 : SHR ECX,0x10
006b1d6c : MOV dword ptr [EBX + 0x3c],ECX
006b1d6f : MOV EDX,dword ptr [ESI + 0x10]
006b1d72 : ADD EDX,0xffff
006b1d78 : SHR EDX,0x10
006b1d7b : MOV dword ptr [EBX + 0x40],EDX
006b1d7e : MOV EAX,dword ptr [ESI + 0x14]
006b1d81 : ADD EAX,0x8000
006b1d86 : SHR EAX,0x10
006b1d89 : MOV word ptr [EBX + 0x46],AX
006b1d8d : MOV ECX,dword ptr [ESI + 0x18]
006b1d90 : ADD ECX,0x8000
006b1d96 : SHR ECX,0x10
006b1d99 : MOV word ptr [EBX + 0x48],CX
006b1d9d : CMP dword ptr [ESI + 0x28],0x0
006b1da1 : JZ 0x006b1daf
006b1da3 : OR dword ptr [EBX + 0x8],0x40
006b1da7 : MOV dword ptr [EBX + 0x1e8],ESI
006b1dad : XOR ESI,ESI
006b1daf : PUSH EDI
006b1db0 : CALL 0x006889b0
006b1db5 : MOV EAX,dword ptr [ESP + 0x34]
006b1db9 : ADD ESP,0x4
006b1dbc : TEST ESI,ESI
006b1dbe : JZ 0x006b1dcd
006b1dc0 : MOV EDI,dword ptr [ESP + 0x10]
006b1dc4 : CALL 0x006b1930
006b1dc9 : MOV EAX,dword ptr [ESP + 0x30]
006b1dcd : POP EDI
006b1dce : POP ESI
006b1dcf : POP EBP
006b1dd0 : POP EBX
006b1dd1 : ADD ESP,0x18
006b1dd4 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00585ac0
ENTRY    : 00585ac0
BODY     : [[00585ac0, 00585c33]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00585ac0(int param_1)

{
  undefined4 *puVar1;
  int iVar2;
  char cVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  undefined4 uVar7;
  uint uVar8;
  int local_8;
  int local_4;
  
  cVar3 = FUN_00526030(7);
  if (cVar3 == '\0') {
    FUN_00526050("Array",0,0);
    return;
  }
  if (*(int *)(param_1 + 8) == 0) {
    local_4 = 0;
  }
  else {
    local_4 = *(int *)(param_1 + 8) + -0x10;
  }
  local_8 = *(int *)(local_4 + 0x38);
  iVar4 = 0;
  if (0 < *(int *)(param_1 + 0x1c)) {
    uVar7 = *(undefined4 *)(param_1 + 0x18);
    FUN_00526260(0);
    FUN_00527730(uVar7);
    iVar4 = FUN_0063b380();
    if ((iVar4 < 0) && (iVar4 = iVar4 + *(int *)(local_4 + 0x38), iVar4 < 0)) {
      iVar4 = 0;
    }
    if (*(int *)(local_4 + 0x38) < iVar4) {
      iVar4 = *(int *)(local_4 + 0x38);
    }
  }
  if (1 < *(int *)(param_1 + 0x1c)) {
    uVar7 = *(undefined4 *)(param_1 + 0x18);
    FUN_00526260(1);
    FUN_00527730(uVar7);
    local_8 = FUN_0063b380();
    if ((local_8 < 0) && (local_8 = local_8 + *(int *)(local_4 + 0x38), local_8 < 0)) {
      local_8 = 0;
    }
    if (*(int *)(local_4 + 0x38) < local_8) {
      local_8 = *(int *)(local_4 + 0x38);
    }
  }
  iVar5 = *(int *)(*(int *)(param_1 + 0x18) + 0x78);
  iVar5 = FUN_005324f0(*(undefined4 *)(iVar5 + 0x2a0),iVar5 + 0x10,0,0xffffffff);
  if (iVar5 != 0) {
    for (; iVar4 < local_8; iVar4 = iVar4 + 1) {
      iVar2 = *(int *)(*(int *)(local_4 + 0x34) + iVar4 * 4);
      if (iVar2 == 0) {
        uVar6 = *(int *)(iVar5 + 0x38) + 1;
        if (uVar6 < *(uint *)(iVar5 + 0x38)) {
          uVar8 = uVar6;
          if (uVar6 < *(uint *)(iVar5 + 0x3c) >> 1) {
LAB_00585bed:
            FUN_005b5ef0((int *)(iVar5 + 0x34),uVar8);
          }
        }
        else if (*(uint *)(iVar5 + 0x3c) <= uVar6) {
          uVar8 = (uVar6 >> 2) + uVar6;
          goto LAB_00585bed;
        }
        puVar1 = (undefined4 *)(*(int *)(iVar5 + 0x34) + -4 + uVar6 * 4);
        *(uint *)(iVar5 + 0x38) = uVar6;
        if (puVar1 != (undefined4 *)0x0) {
          *puVar1 = 0;
        }
      }
      else {
        FUN_00585540(iVar2);
      }
    }
  }
  FUN_005271c0(iVar5);
  if (iVar5 == 0) {
    return;
  }
  FUN_00503db0();
  return;
}



============================================================
DISASSEMBLY
============================================================
00585ac0 : SUB ESP,0x8
00585ac3 : PUSH EDI
00585ac4 : MOV EDI,dword ptr [ESP + 0x10]
00585ac8 : PUSH 0x7
00585aca : MOV ECX,EDI
00585acc : CALL 0x00526030
00585ad1 : TEST AL,AL
00585ad3 : JNZ 0x00585aea
00585ad5 : PUSH 0x0
00585ad7 : PUSH 0x0
00585ad9 : PUSH 0xb8df10
00585ade : MOV ECX,EDI
00585ae0 : CALL 0x00526050
00585ae5 : POP EDI
00585ae6 : ADD ESP,0x8
00585ae9 : RET
00585aea : MOV EAX,dword ptr [EDI + 0x8]
00585aed : PUSH EBX
00585aee : PUSH EBP
00585aef : XOR EBP,EBP
00585af1 : CMP EAX,EBP
00585af3 : JZ 0x00585afe
00585af5 : LEA EBX,[EAX + -0x10]
00585af8 : MOV dword ptr [ESP + 0x10],EBX
00585afc : JMP 0x00585b04
00585afe : MOV dword ptr [ESP + 0x10],EBP
00585b02 : MOV EBX,EBP
00585b04 : MOV EAX,dword ptr [EBX + 0x38]
00585b07 : PUSH ESI
00585b08 : XOR ESI,ESI
00585b0a : CMP dword ptr [EDI + 0x1c],0x1
00585b0e : MOV dword ptr [ESP + 0x10],EAX
00585b12 : JL 0x00585b42
00585b14 : MOV ECX,dword ptr [EDI + 0x18]
00585b17 : PUSH ECX
00585b18 : PUSH EBP
00585b19 : MOV ECX,EDI
00585b1b : CALL 0x00526260
00585b20 : MOV ECX,EAX
00585b22 : CALL 0x00527730
00585b27 : CALL 0x0063b380
00585b2c : MOV ESI,EAX
00585b2e : CMP ESI,EBP
00585b30 : JGE 0x00585b39
00585b32 : ADD ESI,dword ptr [EBX + 0x38]
00585b35 : JNS 0x00585b39
00585b37 : XOR ESI,ESI
00585b39 : MOV EAX,dword ptr [EBX + 0x38]
00585b3c : CMP ESI,EAX
00585b3e : JLE 0x00585b42
00585b40 : MOV ESI,EAX
00585b42 : CMP dword ptr [EDI + 0x1c],0x2
00585b46 : JL 0x00585b85
00585b48 : MOV EDX,dword ptr [EDI + 0x18]
00585b4b : PUSH EDX
00585b4c : PUSH 0x1
00585b4e : MOV ECX,EDI
00585b50 : CALL 0x00526260
00585b55 : MOV ECX,EAX
00585b57 : CALL 0x00527730
00585b5c : CALL 0x0063b380
00585b61 : MOV ECX,EAX
00585b63 : CMP ECX,EBP
00585b65 : MOV dword ptr [ESP + 0x10],ECX
00585b69 : JGE 0x00585b7a
00585b6b : ADD ECX,dword ptr [EBX + 0x38]
00585b6e : MOV dword ptr [ESP + 0x10],ECX
00585b72 : JNS 0x00585b7a
00585b74 : MOV dword ptr [ESP + 0x10],EBP
00585b78 : MOV ECX,EBP
00585b7a : MOV EAX,dword ptr [EBX + 0x38]
00585b7d : CMP ECX,EAX
00585b7f : JLE 0x00585b85
00585b81 : MOV dword ptr [ESP + 0x10],EAX
00585b85 : MOV ECX,dword ptr [EDI + 0x18]
00585b88 : MOV EAX,dword ptr [ECX + 0x78]
00585b8b : PUSH -0x1
00585b8d : MOV EDX,EAX
00585b8f : MOV EDX,dword ptr [EDX + 0x2a0]
00585b95 : PUSH EBP
00585b96 : ADD EAX,0x10
00585b99 : PUSH EAX
00585b9a : PUSH EDX
00585b9b : CALL 0x005324f0
00585ba0 : MOV EBX,EAX
00585ba2 : CMP EBX,EBP
00585ba4 : JZ 0x00585c13
00585ba6 : CMP ESI,dword ptr [ESP + 0x10]
00585baa : MOV EBP,ESI
00585bac : JGE 0x00585c13
00585bae : MOV EDI,EDI
00585bb0 : MOV EAX,dword ptr [ESP + 0x14]
00585bb4 : MOV ECX,dword ptr [EAX + 0x34]
00585bb7 : MOV EAX,dword ptr [ECX + EBP*0x4]
00585bba : TEST EAX,EAX
00585bbc : JZ 0x00585bc8
00585bbe : PUSH EAX
00585bbf : MOV ECX,EBX
00585bc1 : CALL 0x00585540
00585bc6 : JMP 0x00585c0c
00585bc8 : MOV ESI,dword ptr [EBX + 0x38]
00585bcb : LEA EDI,[EBX + 0x34]
00585bce : INC ESI
00585bcf : CMP ESI,dword ptr [EDI + 0x4]
00585bd2 : JNC 0x00585be0
00585bd4 : MOV EDX,dword ptr [EDI + 0x8]
00585bd7 : SHR EDX,0x1
00585bd9 : CMP ESI,EDX
00585bdb : JNC 0x00585bf5
00585bdd : PUSH ESI
00585bde : JMP 0x00585bed
00585be0 : CMP ESI,dword ptr [EDI + 0x8]
00585be3 : JC 0x00585bf5
00585be5 : MOV EAX,ESI
00585be7 : SHR EAX,0x2
00585bea : ADD EAX,ESI
00585bec : PUSH EAX
00585bed : PUSH EDI
00585bee : MOV ECX,EDI
00585bf0 : CALL 0x005b5ef0
00585bf5 : MOV ECX,dword ptr [EDI]
00585bf7 : LEA EAX,[ECX + ESI*0x4 + -0x4]
00585bfb : MOV dword ptr [EDI + 0x4],ESI
00585bfe : MOV EDI,dword ptr [ESP + 0x1c]
00585c02 : TEST EAX,EAX
00585c04 : JZ 0x00585c0c
00585c06 : MOV dword ptr [EAX],0x0
00585c0c : INC EBP
00585c0d : CMP EBP,dword ptr [ESP + 0x10]
00585c11 : JL 0x00585bb0
00585c13 : MOV ECX,dword ptr [EDI + 0x4]
00585c16 : PUSH EBX
00585c17 : CALL 0x005271c0
00585c1c : POP ESI
00585c1d : POP EBP
00585c1e : TEST EBX,EBX
00585c20 : JZ 0x00585c2e
00585c22 : MOV ECX,EBX
00585c24 : POP EBX
00585c25 : POP EDI
00585c26 : ADD ESP,0x8
00585c29 : JMP 0x00503db0
00585c2e : POP EBX
00585c2f : POP EDI
00585c30 : ADD ESP,0x8
00585c33 : RET

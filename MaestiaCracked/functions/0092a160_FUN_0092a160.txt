PROGRAM  : Maestia.exe
FUNCTION : FUN_0092a160
ENTRY    : 0092a160
BODY     : [[0092a160, 0092a30e]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x0092a204) */
/* WARNING: Removing unreachable block (ram,0x0092a2d9) */

void FUN_0092a160(int param_1,short param_2)

{
  uint uVar1;
  int iVar2;
  short in_CX;
  uint local_3c;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  puStack_c = &LAB_00b1f3dd;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(char *)(param_1 + 0x32) != '\0') {
    *(short *)(param_1 + 0x44) = in_CX;
    *(short *)(param_1 + 0x46) = param_2;
    if ((in_CX != 0) || (param_2 != 0)) {
      local_8 = 0;
      iVar2 = FUN_00703c00();
      if (iVar2 == 0) {
        FUN_008018d0();
      }
      else {
        FUN_00406460();
        local_8._0_1_ = 1;
        FUN_00404350(iVar2 + 0x58);
        local_8 = (uint)local_8._1_3_ << 8;
        FUN_008f7470();
        local_8._0_1_ = 3;
        FUN_00405eb0();
        local_8 = (uint)local_8._1_3_ << 8;
        if (7 < local_3c) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        iVar2 = *DAT_00da9894;
        if ((iVar2 != 0) && (*(int *)(iVar2 + 0x114) != 0)) {
          (**(code **)(**(int **)(iVar2 + 0x114) + 4))();
        }
      }
    }
  }
  local_8 = 0xffffffff;
  ExceptionList = local_10;
  __security_check_cookie(uVar1 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0092a160 : PUSH EBP
0092a161 : MOV EBP,ESP
0092a163 : PUSH -0x1
0092a165 : PUSH 0xb1f3dd
0092a16a : MOV EAX,FS:[0x0]
0092a170 : PUSH EAX
0092a171 : SUB ESP,0x44
0092a174 : MOV EAX,[0x00d66fa0]
0092a179 : XOR EAX,EBP
0092a17b : MOV dword ptr [EBP + -0x10],EAX
0092a17e : PUSH EBX
0092a17f : PUSH ESI
0092a180 : PUSH EDI
0092a181 : PUSH EAX
0092a182 : LEA EAX,[EBP + -0xc]
0092a185 : MOV FS:[0x0],EAX
0092a18b : MOV EDI,ECX
0092a18d : MOV EAX,dword ptr [EBP + 0x8]
0092a190 : XOR EBX,EBX
0092a192 : CMP byte ptr [EAX + 0x32],BL
0092a195 : JZ 0x0092a2f1
0092a19b : MOV CX,word ptr [EBP + 0xc]
0092a19f : MOV word ptr [EAX + 0x44],DI
0092a1a3 : MOV word ptr [EAX + 0x46],CX
0092a1a7 : CMP DI,BX
0092a1aa : JNZ 0x0092a1b5
0092a1ac : CMP CX,BX
0092a1af : JZ 0x0092a2f1
0092a1b5 : XOR EAX,EAX
0092a1b7 : MOV dword ptr [EBP + -0x14],0x7
0092a1be : MOV dword ptr [EBP + -0x18],EBX
0092a1c1 : MOV word ptr [EBP + -0x28],AX
0092a1c5 : MOV dword ptr [EBP + -0x4],EBX
0092a1c8 : PUSH 0x600
0092a1cd : CALL 0x00703c00
0092a1d2 : MOV ESI,EAX
0092a1d4 : ADD ESP,0x4
0092a1d7 : CMP ESI,EBX
0092a1d9 : JNZ 0x0092a217
0092a1db : MOV ESI,dword ptr [0x00da98e8]
0092a1e1 : MOVZX ECX,DI
0092a1e4 : PUSH ECX
0092a1e5 : PUSH 0xc6c0d4
0092a1ea : PUSH 0xc6c118
0092a1ef : CALL 0x008018d0
0092a1f4 : ADD ESP,0xc
0092a1f7 : MOV dword ptr [EBP + -0x4],0xffffffff
0092a1fe : CMP dword ptr [EBP + -0x14],0x8
0092a202 : JC 0x0092a20c
0092a204 : MOV ECX,dword ptr [EBP + -0x28]
0092a207 : CALL 0x006f04e0
0092a20c : XOR EDX,EDX
0092a20e : MOV word ptr [EBP + -0x28],DX
0092a212 : JMP 0x0092a2e7
0092a217 : SUB ESP,0x1c
0092a21a : MOV ECX,ESP
0092a21c : MOV dword ptr [EBP + -0x34],ESP
0092a21f : PUSH 0xc6c164
0092a224 : CALL 0x00406460
0092a229 : MOV byte ptr [EBP + -0x4],0x1
0092a22d : SUB ESP,0x1c
0092a230 : LEA EAX,[ESI + 0x58]
0092a233 : MOV ESI,ESP
0092a235 : MOV dword ptr [EBP + -0x30],ESP
0092a238 : PUSH EAX
0092a239 : CALL 0x00404350
0092a23e : ADD ESP,0x4
0092a241 : MOV byte ptr [EBP + -0x4],0x2
0092a245 : MOV byte ptr [EBP + -0x4],BL
0092a248 : LEA EDI,[EBP + -0x50]
0092a24b : CALL 0x008f7470
0092a250 : ADD ESP,0x38
0092a253 : MOV byte ptr [EBP + -0x4],0x3
0092a257 : PUSH -0x1
0092a259 : PUSH EBX
0092a25a : PUSH EAX
0092a25b : LEA ECX,[EBP + -0x2c]
0092a25e : CALL 0x00405eb0
0092a263 : MOV byte ptr [EBP + -0x4],BL
0092a266 : MOV ESI,0x8
0092a26b : CMP dword ptr [EBP + -0x38],ESI
0092a26e : JC 0x0092a278
0092a270 : MOV ECX,dword ptr [EBP + -0x4c]
0092a273 : CALL 0x006f04e0
0092a278 : MOV EDX,dword ptr [0x00da9894]
0092a27e : XOR ECX,ECX
0092a280 : MOV dword ptr [EBP + -0x38],0x7
0092a287 : MOV dword ptr [EBP + -0x3c],EBX
0092a28a : MOV word ptr [EBP + -0x4c],CX
0092a28e : MOV EAX,dword ptr [EDX]
0092a290 : CMP EAX,EBX
0092a292 : JZ 0x0092a2cd
0092a294 : CMP dword ptr [EAX + 0x114],EBX
0092a29a : JZ 0x0092a2cd
0092a29c : MOV EAX,dword ptr [EAX + 0x114]
0092a2a2 : MOV ECX,dword ptr [EBP + -0x28]
0092a2a5 : CMP dword ptr [EBP + -0x14],ESI
0092a2a8 : JNC 0x0092a2ad
0092a2aa : LEA ECX,[EBP + -0x28]
0092a2ad : MOVZX EDI,word ptr [EBP + 0xc]
0092a2b1 : MOV EDX,dword ptr [EAX]
0092a2b3 : PUSH 0xbb8
0092a2b8 : PUSH EDI
0092a2b9 : PUSH ECX
0092a2ba : PUSH 0xc6c168
0092a2bf : PUSH 0xc6c174
0092a2c4 : PUSH EAX
0092a2c5 : MOV EAX,dword ptr [EDX + 0x4]
0092a2c8 : CALL EAX
0092a2ca : ADD ESP,0x18
0092a2cd : MOV dword ptr [EBP + -0x4],0xffffffff
0092a2d4 : CMP dword ptr [EBP + -0x14],ESI
0092a2d7 : JC 0x0092a2e1
0092a2d9 : MOV ECX,dword ptr [EBP + -0x28]
0092a2dc : CALL 0x006f04e0
0092a2e1 : XOR ECX,ECX
0092a2e3 : MOV word ptr [EBP + -0x28],CX
0092a2e7 : MOV dword ptr [EBP + -0x18],EBX
0092a2ea : MOV dword ptr [EBP + -0x14],0x7
0092a2f1 : MOV ECX,dword ptr [EBP + -0xc]
0092a2f4 : MOV dword ptr FS:[0x0],ECX
0092a2fb : POP ECX
0092a2fc : POP EDI
0092a2fd : POP ESI
0092a2fe : POP EBX
0092a2ff : MOV ECX,dword ptr [EBP + -0x10]
0092a302 : XOR ECX,EBP
0092a304 : CALL 0x00633e6b
0092a309 : MOV ESP,EBP
0092a30b : POP EBP
0092a30c : RET 0x8

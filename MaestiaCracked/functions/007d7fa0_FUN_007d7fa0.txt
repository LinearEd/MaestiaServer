PROGRAM  : Maestia.exe
FUNCTION : FUN_007d7fa0
ENTRY    : 007d7fa0
BODY     : [[007d7fa0, 007d8222]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007d7fa0(int param_1)

{
  int iVar1;
  int in_ECX;
  int iVar2;
  int local_5c;
  int local_58;
  undefined1 local_54 [4];
  undefined2 local_50;
  undefined4 local_40;
  uint local_3c;
  undefined1 local_38 [4];
  undefined2 local_34;
  undefined4 local_24;
  uint local_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b28e26;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)&local_5c;
  ExceptionList = &local_14;
  local_58 = param_1;
  if (*(int *)(param_1 + 8) != 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(param_1 + 8) + 4));
  }
  local_c = 0;
  FUN_0044f270(param_1 + 0x25c,&local_5c,in_ECX);
  if (local_5c != *(int *)(param_1 + 0x264)) {
    FUN_007d6bb0(local_5c + 0x24);
    FUN_004600d0(&local_5c,local_5c);
  }
  local_c = 0xffffffff;
  if (*(int *)(param_1 + 8) != 0) {
    LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(param_1 + 8) + 4));
  }
  if (4 < *(uint *)(in_ECX + 0x14)) {
    local_34 = 0;
    local_20 = 7;
    local_24 = 0;
    FUN_00405eb0(in_ECX,0,0xffffffff);
    local_c = 1;
    local_3c = 7;
    local_40 = 0;
    local_50 = 0;
    FUN_00405eb0(in_ECX,0,0xffffffff);
    local_c = CONCAT31(local_c._1_3_,2);
    local_5c = 0x2e;
    iVar1 = FUN_00407cc0(&local_5c,1);
    if (iVar1 != -1) {
      iVar2 = *(int *)(in_ECX + 0x14) - iVar1;
      FUN_00405e10(iVar1,iVar2);
      FUN_00405e10(iVar1,iVar2);
      FUN_00404870(L"_5.mmf",6);
      FUN_00404870(L"_2.mmf",6);
    }
    local_58 = param_1;
    if (*(int *)(param_1 + 8) != 0) {
      EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(param_1 + 8) + 4));
    }
    local_c = CONCAT31(local_c._1_3_,3);
    FUN_0044f270(param_1 + 0x25c,&local_5c,local_38);
    if (local_5c != *(int *)(param_1 + 0x264)) {
      FUN_007d6bb0(local_5c + 0x24);
      FUN_004600d0(&local_5c,local_5c);
    }
    FUN_0044f270(param_1 + 0x25c,&local_5c,local_54);
    if (local_5c != *(int *)(param_1 + 0x264)) {
      FUN_007d6bb0(local_5c + 0x24);
      FUN_004600d0(&local_5c,local_5c);
    }
    local_c._0_1_ = 2;
    if (*(int *)(param_1 + 8) != 0) {
      LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(param_1 + 8) + 4));
    }
    local_c = CONCAT31(local_c._1_3_,1);
    if (7 < local_3c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_3c = 7;
    local_40 = 0;
    local_50 = 0;
    local_c = 0xffffffff;
    if (7 < local_20) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_20 = 7;
    local_24 = 0;
    local_34 = 0;
  }
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)&local_5c);
  return;
}



============================================================
DISASSEMBLY
============================================================
007d7fa0 : PUSH EBP
007d7fa1 : MOV EBP,ESP
007d7fa3 : AND ESP,0xfffffff8
007d7fa6 : PUSH -0x1
007d7fa8 : PUSH 0xb28e26
007d7fad : MOV EAX,FS:[0x0]
007d7fb3 : PUSH EAX
007d7fb4 : SUB ESP,0x48
007d7fb7 : MOV EAX,[0x00d66fa0]
007d7fbc : XOR EAX,ESP
007d7fbe : MOV dword ptr [ESP + 0x40],EAX
007d7fc2 : PUSH EBX
007d7fc3 : PUSH ESI
007d7fc4 : PUSH EDI
007d7fc5 : MOV EAX,[0x00d66fa0]
007d7fca : XOR EAX,ESP
007d7fcc : PUSH EAX
007d7fcd : LEA EAX,[ESP + 0x58]
007d7fd1 : MOV FS:[0x0],EAX
007d7fd7 : MOV EBX,dword ptr [EBP + 0x8]
007d7fda : MOV EAX,dword ptr [EBX + 0x8]
007d7fdd : XOR EDI,EDI
007d7fdf : MOV ESI,ECX
007d7fe1 : MOV dword ptr [ESP + 0x14],EBX
007d7fe5 : CMP EAX,EDI
007d7fe7 : JZ 0x007d7ff3
007d7fe9 : ADD EAX,0x4
007d7fec : PUSH EAX
007d7fed : CALL dword ptr [0x00b85118]
007d7ff3 : MOV dword ptr [ESP + 0x60],EDI
007d7ff7 : PUSH ESI
007d7ff8 : LEA ECX,[ESP + 0x14]
007d7ffc : LEA EAX,[EBX + 0x25c]
007d8002 : PUSH ECX
007d8003 : PUSH EAX
007d8004 : CALL 0x0044f270
007d8009 : MOV EAX,dword ptr [EBX + 0x264]
007d800f : MOV ECX,dword ptr [ESP + 0x10]
007d8013 : CMP ECX,EAX
007d8015 : JZ 0x007d8039
007d8017 : ADD ECX,0x24
007d801a : PUSH ECX
007d801b : MOV EDI,EBX
007d801d : CALL 0x007d6bb0
007d8022 : MOV EDX,dword ptr [ESP + 0x10]
007d8026 : PUSH EDX
007d8027 : LEA EAX,[ESP + 0x14]
007d802b : PUSH EAX
007d802c : LEA ECX,[EBX + 0x25c]
007d8032 : CALL 0x004600d0
007d8037 : XOR EDI,EDI
007d8039 : MOV dword ptr [ESP + 0x60],0xffffffff
007d8041 : MOV EAX,dword ptr [EBX + 0x8]
007d8044 : CMP EAX,EDI
007d8046 : JZ 0x007d8052
007d8048 : ADD EAX,0x4
007d804b : PUSH EAX
007d804c : CALL dword ptr [0x00b8511c]
007d8052 : CMP dword ptr [ESI + 0x14],0x4
007d8056 : JBE 0x007d8203
007d805c : PUSH -0x1
007d805e : XOR ECX,ECX
007d8060 : PUSH EDI
007d8061 : MOV word ptr [ESP + 0x40],CX
007d8066 : PUSH ESI
007d8067 : LEA ECX,[ESP + 0x40]
007d806b : MOV dword ptr [ESP + 0x58],0x7
007d8073 : MOV dword ptr [ESP + 0x54],EDI
007d8077 : CALL 0x00405eb0
007d807c : MOV dword ptr [ESP + 0x60],0x1
007d8084 : PUSH -0x1
007d8086 : PUSH EDI
007d8087 : XOR EDX,EDX
007d8089 : PUSH ESI
007d808a : LEA ECX,[ESP + 0x24]
007d808e : MOV dword ptr [ESP + 0x3c],0x7
007d8096 : MOV dword ptr [ESP + 0x38],EDI
007d809a : MOV word ptr [ESP + 0x28],DX
007d809f : CALL 0x00405eb0
007d80a4 : MOV byte ptr [ESP + 0x60],0x2
007d80a9 : PUSH 0x1
007d80ab : LEA EAX,[ESP + 0x14]
007d80af : PUSH EAX
007d80b0 : OR ECX,0xffffffff
007d80b3 : MOV EDI,ESI
007d80b5 : MOV dword ptr [ESP + 0x18],0x2e
007d80bd : CALL 0x00407cc0
007d80c2 : MOV ESI,dword ptr [ESI + 0x14]
007d80c5 : MOV EDI,EAX
007d80c7 : CMP EDI,-0x1
007d80ca : JZ 0x007d8104
007d80cc : SUB ESI,EDI
007d80ce : PUSH ESI
007d80cf : PUSH EDI
007d80d0 : LEA ECX,[ESP + 0x3c]
007d80d4 : CALL 0x00405e10
007d80d9 : PUSH ESI
007d80da : PUSH EDI
007d80db : LEA ECX,[ESP + 0x20]
007d80df : CALL 0x00405e10
007d80e4 : PUSH 0x6
007d80e6 : PUSH 0xc20018
007d80eb : LEA ESI,[ESP + 0x3c]
007d80ef : CALL 0x00404870
007d80f4 : PUSH 0x6
007d80f6 : PUSH 0xc20028
007d80fb : LEA ESI,[ESP + 0x20]
007d80ff : CALL 0x00404870
007d8104 : MOV EAX,dword ptr [EBX + 0x8]
007d8107 : MOV dword ptr [ESP + 0x14],EBX
007d810b : TEST EAX,EAX
007d810d : JZ 0x007d8119
007d810f : ADD EAX,0x4
007d8112 : PUSH EAX
007d8113 : CALL dword ptr [0x00b85118]
007d8119 : MOV byte ptr [ESP + 0x60],0x3
007d811e : LEA ECX,[ESP + 0x34]
007d8122 : PUSH ECX
007d8123 : LEA EDX,[ESP + 0x14]
007d8127 : PUSH EDX
007d8128 : LEA ESI,[EBX + 0x25c]
007d812e : PUSH ESI
007d812f : CALL 0x0044f270
007d8134 : MOV EAX,dword ptr [EBX + 0x264]
007d813a : MOV ECX,dword ptr [ESP + 0x10]
007d813e : CMP ECX,EAX
007d8140 : JZ 0x007d815e
007d8142 : ADD ECX,0x24
007d8145 : PUSH ECX
007d8146 : MOV EDI,EBX
007d8148 : CALL 0x007d6bb0
007d814d : MOV EAX,dword ptr [ESP + 0x10]
007d8151 : PUSH EAX
007d8152 : LEA ECX,[ESP + 0x14]
007d8156 : PUSH ECX
007d8157 : MOV ECX,ESI
007d8159 : CALL 0x004600d0
007d815e : LEA EDX,[ESP + 0x18]
007d8162 : PUSH EDX
007d8163 : LEA EAX,[ESP + 0x14]
007d8167 : PUSH EAX
007d8168 : PUSH ESI
007d8169 : CALL 0x0044f270
007d816e : MOV EAX,dword ptr [EBX + 0x264]
007d8174 : MOV ECX,dword ptr [ESP + 0x10]
007d8178 : CMP ECX,EAX
007d817a : JZ 0x007d8198
007d817c : ADD ECX,0x24
007d817f : PUSH ECX
007d8180 : MOV EDI,EBX
007d8182 : CALL 0x007d6bb0
007d8187 : MOV ECX,dword ptr [ESP + 0x10]
007d818b : PUSH ECX
007d818c : LEA EDX,[ESP + 0x14]
007d8190 : PUSH EDX
007d8191 : MOV ECX,ESI
007d8193 : CALL 0x004600d0
007d8198 : MOV byte ptr [ESP + 0x60],0x2
007d819d : MOV EBX,dword ptr [EBX + 0x8]
007d81a0 : TEST EBX,EBX
007d81a2 : JZ 0x007d81ae
007d81a4 : ADD EBX,0x4
007d81a7 : PUSH EBX
007d81a8 : CALL dword ptr [0x00b8511c]
007d81ae : MOV byte ptr [ESP + 0x60],0x1
007d81b3 : MOV EDI,0x8
007d81b8 : CMP dword ptr [ESP + 0x30],EDI
007d81bc : JC 0x007d81c7
007d81be : MOV ECX,dword ptr [ESP + 0x1c]
007d81c2 : CALL 0x006f04e0
007d81c7 : MOV ESI,0x7
007d81cc : XOR EBX,EBX
007d81ce : XOR EAX,EAX
007d81d0 : MOV dword ptr [ESP + 0x30],ESI
007d81d4 : MOV dword ptr [ESP + 0x2c],EBX
007d81d8 : MOV word ptr [ESP + 0x1c],AX
007d81dd : MOV dword ptr [ESP + 0x60],0xffffffff
007d81e5 : CMP dword ptr [ESP + 0x4c],EDI
007d81e9 : JC 0x007d81f4
007d81eb : MOV ECX,dword ptr [ESP + 0x38]
007d81ef : CALL 0x006f04e0
007d81f4 : XOR ECX,ECX
007d81f6 : MOV dword ptr [ESP + 0x4c],ESI
007d81fa : MOV dword ptr [ESP + 0x48],EBX
007d81fe : MOV word ptr [ESP + 0x38],CX
007d8203 : MOV ECX,dword ptr [ESP + 0x58]
007d8207 : MOV dword ptr FS:[0x0],ECX
007d820e : POP ECX
007d820f : POP EDI
007d8210 : POP ESI
007d8211 : POP EBX
007d8212 : MOV ECX,dword ptr [ESP + 0x40]
007d8216 : XOR ECX,ESP
007d8218 : CALL 0x00633e6b
007d821d : MOV ESP,EBP
007d821f : POP EBP
007d8220 : RET 0x4

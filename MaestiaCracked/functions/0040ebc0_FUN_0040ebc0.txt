PROGRAM  : Maestia.exe
FUNCTION : FUN_0040ebc0
ENTRY    : 0040ebc0
BODY     : [[0040ebc0, 0040ece9]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_0040ebc0(int param_1)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  int in_ECX;
  int iVar5;
  int unaff_EDI;
  wchar_t *pwVar6;
  undefined1 local_2c [28];
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7c678;
  local_10 = ExceptionList;
  iVar1 = *(int *)(in_ECX + 0x380);
  if (iVar1 == 0) {
    pwVar6 = L"m_pMHGrid NULL!!!!!!!";
  }
  else {
    iVar2 = *(int *)(in_ECX + 0x280);
    if (iVar2 != 0) {
      uVar3 = (*(int *)(in_ECX + 0x2d0) + -1) * (*(int *)(in_ECX + 0x2cc) + -1);
      if ((uint)(*(int *)(iVar2 + 0x58) * param_1 + unaff_EDI) <= uVar3) {
        iVar4 = *(int *)(iVar2 + 0x58) * param_1 + unaff_EDI;
        iVar5 = *(int *)(iVar1 + 0xc + iVar4 * 0x14) - *(int *)(iVar1 + 8 + iVar4 * 0x14);
        iVar4 = iVar5 >> 0x1f;
        if (iVar5 / 7 + iVar4 != iVar4) {
          iVar1 = *(int *)(iVar1 + 8 + (*(int *)(iVar2 + 0x58) * param_1 + unaff_EDI) * 0x14);
          return CONCAT31((int3)((uint)iVar1 >> 8),*(undefined1 *)(iVar1 + 2));
        }
        ExceptionList = &local_10;
        FUN_00406460(L"m_pMHGrid->vMGrid.empty !!");
        local_8 = 0;
        if ((int *)*DAT_00da98e8 != (int *)0x0) {
          (**(code **)(*(int *)*DAT_00da98e8 + 0x14))(L"AvaLib::AvaPatch::GetMask",0x170,local_2c);
        }
        local_8 = 0xffffffff;
        uVar3 = FUN_00406560();
      }
      goto LAB_0040ec0a;
    }
    pwVar6 = L"m_rpParentZone->IsNULL !!!!!!!";
  }
  ExceptionList = &local_10;
  uVar3 = FUN_008018d0(pwVar6,DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
LAB_0040ec0a:
  ExceptionList = local_10;
  return uVar3 & 0xffffff00;
}



============================================================
DISASSEMBLY
============================================================
0040ebc0 : PUSH EBP
0040ebc1 : MOV EBP,ESP
0040ebc3 : PUSH -0x1
0040ebc5 : PUSH 0xb7c678
0040ebca : MOV EAX,FS:[0x0]
0040ebd0 : PUSH EAX
0040ebd1 : SUB ESP,0x1c
0040ebd4 : PUSH EBX
0040ebd5 : PUSH ESI
0040ebd6 : MOV EAX,[0x00d66fa0]
0040ebdb : XOR EAX,EBP
0040ebdd : PUSH EAX
0040ebde : LEA EAX,[EBP + -0xc]
0040ebe1 : MOV FS:[0x0],EAX
0040ebe7 : MOV EBX,dword ptr [EBP + 0x8]
0040ebea : MOV EDX,dword ptr [ECX + 0x380]
0040ebf0 : MOV dword ptr [EBP + 0x8],EDX
0040ebf3 : TEST EDX,EDX
0040ebf5 : JNZ 0x0040ec1f
0040ebf7 : PUSH 0xcca634
0040ebfc : MOV ESI,dword ptr [0x00da98e8]
0040ec02 : CALL 0x008018d0
0040ec07 : ADD ESP,0x4
0040ec0a : XOR AL,AL
0040ec0c : MOV ECX,dword ptr [EBP + -0xc]
0040ec0f : MOV dword ptr FS:[0x0],ECX
0040ec16 : POP ECX
0040ec17 : POP ESI
0040ec18 : POP EBX
0040ec19 : MOV ESP,EBP
0040ec1b : POP EBP
0040ec1c : RET 0x4
0040ec1f : MOV ESI,dword ptr [ECX + 0x280]
0040ec25 : TEST ESI,ESI
0040ec27 : JNZ 0x0040ec30
0040ec29 : PUSH 0xcca660
0040ec2e : JMP 0x0040ebfc
0040ec30 : MOV EAX,dword ptr [ECX + 0x2d0]
0040ec36 : MOV ECX,dword ptr [ECX + 0x2cc]
0040ec3c : DEC ECX
0040ec3d : DEC EAX
0040ec3e : IMUL EAX,ECX
0040ec41 : MOV ECX,dword ptr [ESI + 0x58]
0040ec44 : IMUL ECX,EBX
0040ec47 : ADD ECX,EDI
0040ec49 : CMP ECX,EAX
0040ec4b : JA 0x0040ec0a
0040ec4d : MOV EAX,dword ptr [ESI + 0x58]
0040ec50 : IMUL EAX,EBX
0040ec53 : ADD EAX,EDI
0040ec55 : LEA EAX,[EAX + EAX*0x4]
0040ec58 : MOV ECX,dword ptr [EDX + EAX*0x4 + 0xc]
0040ec5c : SUB ECX,dword ptr [EDX + EAX*0x4 + 0x8]
0040ec60 : LEA EAX,[EDX + EAX*0x4 + 0x4]
0040ec64 : MOV EAX,0x92492493
0040ec69 : IMUL ECX
0040ec6b : ADD EDX,ECX
0040ec6d : SAR EDX,0x2
0040ec70 : MOV ECX,EDX
0040ec72 : SHR ECX,0x1f
0040ec75 : ADD ECX,EDX
0040ec77 : JNZ 0x0040ecc2
0040ec79 : PUSH 0xcca6a0
0040ec7e : LEA ECX,[EBP + -0x28]
0040ec81 : CALL 0x00406460
0040ec86 : MOV dword ptr [EBP + -0x4],0x0
0040ec8d : MOV EDX,dword ptr [0x00da98e8]
0040ec93 : MOV ECX,dword ptr [EDX]
0040ec95 : TEST ECX,ECX
0040ec97 : JZ 0x0040ecae
0040ec99 : MOV EAX,dword ptr [ECX]
0040ec9b : MOV EAX,dword ptr [EAX + 0x14]
0040ec9e : LEA EDX,[EBP + -0x28]
0040eca1 : PUSH EDX
0040eca2 : PUSH 0x170
0040eca7 : PUSH 0xcca6d8
0040ecac : CALL EAX
0040ecae : MOV dword ptr [EBP + -0x4],0xffffffff
0040ecb5 : LEA ECX,[EBP + -0x28]
0040ecb8 : CALL 0x00406560
0040ecbd : JMP 0x0040ec0a
0040ecc2 : MOV EAX,dword ptr [ESI + 0x58]
0040ecc5 : MOV EDX,dword ptr [EBP + 0x8]
0040ecc8 : IMUL EAX,EBX
0040eccb : ADD EAX,EDI
0040eccd : LEA ECX,[EAX + EAX*0x4]
0040ecd0 : MOV EAX,dword ptr [EDX + ECX*0x4 + 0x8]
0040ecd4 : MOV AL,byte ptr [EAX + 0x2]
0040ecd7 : MOV ECX,dword ptr [EBP + -0xc]
0040ecda : MOV dword ptr FS:[0x0],ECX
0040ece1 : POP ECX
0040ece2 : POP ESI
0040ece3 : POP EBX
0040ece4 : MOV ESP,EBP
0040ece6 : POP EBP
0040ece7 : RET 0x4

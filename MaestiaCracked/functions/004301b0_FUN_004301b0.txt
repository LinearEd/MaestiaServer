PROGRAM  : Maestia.exe
FUNCTION : FUN_004301b0
ENTRY    : 004301b0
BODY     : [[004301b0, 00430206]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_004301b0(wchar_t *param_1)

{
  wchar_t wVar1;
  wchar_t *_Dest;
  undefined4 in_ECX;
  undefined1 in_DL;
  ushort *unaff_ESI;
  
  *unaff_ESI = 0;
  _Dest = (wchar_t *)((int)unaff_ESI + 9);
  *(undefined1 *)(unaff_ESI + 1) = 0x36;
  *(undefined1 *)((int)unaff_ESI + 3) = 0xe3;
  *(undefined4 *)(unaff_ESI + 2) = in_ECX;
  *(undefined1 *)(unaff_ESI + 4) = in_DL;
  _wcsncpy(_Dest,param_1,0x28);
  do {
    wVar1 = *_Dest;
    _Dest = _Dest + 1;
  } while (wVar1 != L'\0');
  *unaff_ESI = *unaff_ESI ^
               ((short)((int)_Dest - ((int)unaff_ESI + 0xb) >> 1) * 2 + 0xbU ^ *unaff_ESI) & 0x1fff;
  return;
}



============================================================
DISASSEMBLY
============================================================
004301b0 : PUSH EBP
004301b1 : MOV EBP,ESP
004301b3 : PUSH EDI
004301b4 : XOR EAX,EAX
004301b6 : MOV word ptr [ESI],AX
004301b9 : MOV EAX,dword ptr [EBP + 0x8]
004301bc : PUSH 0x28
004301be : PUSH EAX
004301bf : LEA EDI,[ESI + 0x9]
004301c2 : PUSH EDI
004301c3 : MOV byte ptr [ESI + 0x2],0x36
004301c7 : MOV byte ptr [ESI + 0x3],0xe3
004301cb : MOV dword ptr [ESI + 0x4],ECX
004301ce : MOV byte ptr [ESI + 0x8],DL
004301d1 : CALL 0x00634e39
004301d6 : MOV EAX,EDI
004301d8 : ADD ESP,0xc
004301db : LEA EDX,[EAX + 0x2]
004301de : POP EDI
004301df : NOP
004301e0 : MOV CX,word ptr [EAX]
004301e3 : ADD EAX,0x2
004301e6 : TEST CX,CX
004301e9 : JNZ 0x004301e0
004301eb : SUB EAX,EDX
004301ed : SAR EAX,0x1
004301ef : LEA ECX,[EAX + EAX*0x1 + 0xb]
004301f3 : XOR CX,word ptr [ESI]
004301f6 : MOV EDX,0x1fff
004301fb : AND CX,DX
004301fe : XOR word ptr [ESI],CX
00430201 : MOV EAX,ESI
00430203 : POP EBP
00430204 : RET 0x4

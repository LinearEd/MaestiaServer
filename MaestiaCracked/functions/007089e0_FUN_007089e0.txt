PROGRAM  : Maestia.exe
FUNCTION : FUN_007089e0
ENTRY    : 007089e0
BODY     : [[007089e0, 00708a59] [00708a60, 00708af8] [00708b00, 00708b28] [00708b30, 00708bf0]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x00708ace) */

void FUN_007089e0(int param_1)

{
  code *pcVar1;
  ushort uVar2;
  int iVar3;
  int iVar4;
  byte bVar5;
  byte bVar6;
  int *in_ECX;
  uint uVar7;
  byte *pbVar8;
  int *piVar9;
  
  FUN_00707fd0(param_1);
  uVar7 = 0;
  *(undefined2 *)(in_ECX + 0xc) = 0;
  iVar3 = 0;
  do {
    pbVar8 = (byte *)(iVar3 + in_ECX[3]);
    bVar5 = (byte)uVar7;
    uVar7 = uVar7 + 8;
    iVar3 = iVar3 + 1;
    *(ushort *)(in_ECX + 0xc) = *(ushort *)(in_ECX + 0xc) | (ushort)*pbVar8 << (bVar5 & 0x1f);
  } while (uVar7 < 0x10);
  iVar3 = 0;
  *(undefined2 *)((int)in_ECX + 0x32) = 0;
  uVar7 = 0;
  do {
    iVar4 = iVar3 + 2;
    bVar5 = (byte)uVar7;
    uVar7 = uVar7 + 8;
    iVar3 = iVar3 + 1;
    *(ushort *)((int)in_ECX + 0x32) =
         *(ushort *)((int)in_ECX + 0x32) | (ushort)*(byte *)(iVar4 + in_ECX[3]) << (bVar5 & 0x1f);
  } while (uVar7 < 0x10);
  iVar3 = 0;
  in_ECX[0xd] = 0;
  uVar7 = 0;
  do {
    iVar4 = iVar3 + 4;
    bVar5 = (byte)uVar7;
    uVar7 = uVar7 + 8;
    iVar3 = iVar3 + 1;
    in_ECX[0xd] = in_ECX[0xd] | (uint)*(byte *)(iVar4 + in_ECX[3]) << (bVar5 & 0x1f);
  } while (uVar7 < 0x10);
  uVar7 = 0;
  do {
    *(undefined1 *)((int)in_ECX + uVar7 + 0x38) = 0;
    *(undefined1 *)((int)in_ECX + uVar7 + 0x38) = *(undefined1 *)(uVar7 + 6 + in_ECX[3]);
    uVar7 = uVar7 + 1;
  } while (uVar7 < 8);
  iVar3 = 0;
  *(undefined2 *)(in_ECX + 0x10) = 0;
  uVar7 = 0;
  do {
    iVar4 = iVar3 + 0xe;
    bVar5 = (byte)uVar7;
    uVar7 = uVar7 + 8;
    iVar3 = iVar3 + 1;
    *(ushort *)(in_ECX + 0x10) =
         *(ushort *)(in_ECX + 0x10) | (ushort)*(byte *)(iVar4 + in_ECX[3]) << (bVar5 & 0x1f);
  } while (uVar7 < 0x10);
  iVar3 = 0;
  in_ECX[0x11] = 0;
  uVar7 = 0;
  do {
    iVar4 = iVar3 + 0x10;
    bVar5 = (byte)uVar7;
    uVar7 = uVar7 + 8;
    iVar3 = iVar3 + 1;
    in_ECX[0x11] = in_ECX[0x11] | (uint)*(byte *)(iVar4 + in_ECX[3]) << (bVar5 & 0x1f);
  } while (uVar7 < 0x10);
  if (in_ECX[0x13] != in_ECX[0x14]) {
    in_ECX[0x14] = in_ECX[0x13];
  }
  FUN_004d0ff0();
  iVar3 = in_ECX[6];
  iVar4 = in_ECX[0x13];
  uVar7 = 0;
  if (iVar3 != 0x12) {
    do {
      *(undefined1 *)(uVar7 + iVar4) = 0;
      *(undefined1 *)(uVar7 + iVar4) = *(undefined1 *)(uVar7 + 0x12 + in_ECX[3]);
      uVar7 = uVar7 + 1;
    } while (uVar7 < iVar3 - 0x12U);
  }
  iVar3 = in_ECX[6] + 4;
  pbVar8 = (byte *)(iVar3 + param_1);
  uVar7 = 0;
  uVar2 = 0;
  do {
    bVar5 = *pbVar8;
    bVar6 = (byte)uVar7;
    uVar7 = uVar7 + 8;
    pbVar8 = pbVar8 + 1;
    uVar2 = uVar2 | (ushort)bVar5 << (bVar6 & 0x1f);
  } while (uVar7 < 0x10);
  if ((short)uVar2 < 0x222) {
    if (uVar2 == 0x221) {
      piVar9 = in_ECX + 0x17;
    }
    else if (uVar2 == 0x36) {
      piVar9 = in_ECX + 0x4e;
    }
    else {
      if (uVar2 != 0xbc) goto LAB_00708b9e;
      piVar9 = in_ECX + 0x2a;
    }
  }
  else {
    if (uVar2 != 0x4bc) goto LAB_00708b9e;
    piVar9 = in_ECX + 0x3c;
  }
  pcVar1 = *(code **)(*piVar9 + 4);
  *(ushort *)(in_ECX + 0x16) = uVar2;
  (*pcVar1)(param_1 + iVar3);
  iVar4 = (**(code **)(*piVar9 + 0x10))();
  iVar3 = iVar3 + iVar4;
LAB_00708b9e:
  uVar2 = 0;
  uVar7 = 0;
  pbVar8 = (byte *)(iVar3 + param_1);
  do {
    bVar5 = *pbVar8;
    bVar6 = (byte)uVar7;
    uVar7 = uVar7 + 8;
    pbVar8 = pbVar8 + 1;
    uVar2 = uVar2 | (ushort)bVar5 << (bVar6 & 0x1f);
  } while (uVar7 < 0x10);
  if (uVar2 == 0x207) {
    (**(code **)(in_ECX[0x5e] + 4))((byte *)(iVar3 + param_1));
  }
  (**(code **)(*in_ECX + 0x10))();
  return;
}



============================================================
DISASSEMBLY
============================================================
007089e0 : PUSH EBP
007089e1 : MOV EBP,ESP
007089e3 : PUSH ECX
007089e4 : MOV EAX,dword ptr [EBP + 0x8]
007089e7 : PUSH EBX
007089e8 : PUSH ESI
007089e9 : PUSH EDI
007089ea : PUSH EAX
007089eb : MOV ESI,ECX
007089ed : CALL 0x00707fd0
007089f2 : XOR ECX,ECX
007089f4 : XOR EBX,EBX
007089f6 : MOV word ptr [ESI + 0x30],CX
007089fa : XOR EAX,EAX
007089fc : LEA ESP,[ESP]
00708a00 : MOV EDX,dword ptr [ESI + 0xc]
00708a03 : MOVZX DX,byte ptr [EAX + EDX*0x1]
00708a08 : SHL DX,CL
00708a0b : ADD ECX,0x8
00708a0e : INC EAX
00708a0f : OR word ptr [ESI + 0x30],DX
00708a13 : CMP ECX,0x10
00708a16 : JC 0x00708a00
00708a18 : XOR EAX,EAX
00708a1a : MOV word ptr [ESI + 0x32],AX
00708a1e : XOR ECX,ECX
00708a20 : MOV EDX,dword ptr [ESI + 0xc]
00708a23 : MOVZX DX,byte ptr [EAX + EDX*0x1 + 0x2]
00708a29 : SHL DX,CL
00708a2c : ADD ECX,0x8
00708a2f : INC EAX
00708a30 : OR word ptr [ESI + 0x32],DX
00708a34 : CMP ECX,0x10
00708a37 : JC 0x00708a20
00708a39 : XOR EAX,EAX
00708a3b : MOV dword ptr [ESI + 0x34],EBX
00708a3e : XOR ECX,ECX
00708a40 : MOV EDX,dword ptr [ESI + 0xc]
00708a43 : MOVZX EDX,byte ptr [EAX + EDX*0x1 + 0x4]
00708a48 : SHL EDX,CL
00708a4a : ADD ECX,0x8
00708a4d : INC EAX
00708a4e : OR dword ptr [ESI + 0x34],EDX
00708a51 : CMP ECX,0x10
00708a54 : JC 0x00708a40
00708a56 : XOR EAX,EAX
00708a58 : JMP 0x00708a60
00708a60 : MOV byte ptr [ESI + EAX*0x1 + 0x38],BL
00708a64 : MOV ECX,dword ptr [ESI + 0xc]
00708a67 : MOV DL,byte ptr [EAX + ECX*0x1 + 0x6]
00708a6b : MOV byte ptr [ESI + EAX*0x1 + 0x38],DL
00708a6f : INC EAX
00708a70 : CMP EAX,0x8
00708a73 : JC 0x00708a60
00708a75 : XOR EAX,EAX
00708a77 : MOV word ptr [ESI + 0x40],AX
00708a7b : XOR ECX,ECX
00708a7d : LEA ECX,[ECX]
00708a80 : MOV EDX,dword ptr [ESI + 0xc]
00708a83 : MOVZX DX,byte ptr [EAX + EDX*0x1 + 0xe]
00708a89 : SHL DX,CL
00708a8c : ADD ECX,0x8
00708a8f : INC EAX
00708a90 : OR word ptr [ESI + 0x40],DX
00708a94 : CMP ECX,0x10
00708a97 : JC 0x00708a80
00708a99 : XOR EAX,EAX
00708a9b : MOV dword ptr [ESI + 0x44],EBX
00708a9e : XOR ECX,ECX
00708aa0 : MOV EDX,dword ptr [ESI + 0xc]
00708aa3 : MOVZX EDX,byte ptr [EAX + EDX*0x1 + 0x10]
00708aa8 : SHL EDX,CL
00708aaa : ADD ECX,0x8
00708aad : INC EAX
00708aae : OR dword ptr [ESI + 0x44],EDX
00708ab1 : CMP ECX,0x10
00708ab4 : JC 0x00708aa0
00708ab6 : MOV EDX,dword ptr [ESI + 0x4c]
00708ab9 : MOV ECX,dword ptr [ESI + 0x50]
00708abc : LEA EDI,[ESI + 0x48]
00708abf : CMP EDX,ECX
00708ac1 : JZ 0x00708adf
00708ac3 : MOV EAX,ECX
00708ac5 : SUB EAX,ECX
00708ac7 : LEA EBX,[EAX + EDX*0x1]
00708aca : TEST EAX,EAX
00708acc : JLE 0x00708ada
00708ace : PUSH EAX
00708acf : PUSH ECX
00708ad0 : PUSH EAX
00708ad1 : PUSH EDX
00708ad2 : CALL 0x00634101
00708ad7 : ADD ESP,0x10
00708ada : MOV dword ptr [EDI + 0x8],EBX
00708add : XOR EBX,EBX
00708adf : MOV EAX,dword ptr [ESI + 0x18]
00708ae2 : SUB EAX,0x12
00708ae5 : CALL 0x004d0ff0
00708aea : MOV ECX,dword ptr [ESI + 0x18]
00708aed : SUB ECX,0x12
00708af0 : MOV EDI,dword ptr [ESI + 0x4c]
00708af3 : MOV EAX,EBX
00708af5 : JZ 0x00708b13
00708af7 : JMP 0x00708b00
00708b00 : MOV byte ptr [EAX + EDI*0x1],0x0
00708b04 : MOV EDX,dword ptr [ESI + 0xc]
00708b07 : MOV DL,byte ptr [EAX + EDX*0x1 + 0x12]
00708b0b : MOV byte ptr [EAX + EDI*0x1],DL
00708b0e : INC EAX
00708b0f : CMP EAX,ECX
00708b11 : JC 0x00708b00
00708b13 : MOV EDI,dword ptr [ESI + 0x18]
00708b16 : MOV EAX,dword ptr [EBP + 0x8]
00708b19 : ADD EDI,0x4
00708b1c : LEA EDX,[EDI + EAX*0x1]
00708b1f : MOV dword ptr [EBP + -0x4],EBX
00708b22 : XOR ECX,ECX
00708b24 : MOV AX,BX
00708b27 : JMP 0x00708b30
00708b30 : MOVZX BX,byte ptr [EDX]
00708b34 : SHL BX,CL
00708b37 : ADD ECX,0x8
00708b3a : INC EDX
00708b3b : OR AX,BX
00708b3e : CMP ECX,0x10
00708b41 : JC 0x00708b30
00708b43 : MOVSX ECX,AX
00708b46 : CMP ECX,0x221
00708b4c : JG 0x00708b72
00708b4e : JZ 0x00708b6d
00708b50 : CMP ECX,0x36
00708b53 : JZ 0x00708b65
00708b55 : CMP ECX,0xbc
00708b5b : JNZ 0x00708b9e
00708b5d : LEA EBX,[ESI + 0xa8]
00708b63 : JMP 0x00708b80
00708b65 : LEA EBX,[ESI + 0x138]
00708b6b : JMP 0x00708b80
00708b6d : LEA EBX,[ESI + 0x5c]
00708b70 : JMP 0x00708b80
00708b72 : CMP ECX,0x4bc
00708b78 : JNZ 0x00708b9e
00708b7a : LEA EBX,[ESI + 0xf0]
00708b80 : MOV EDX,dword ptr [EBX]
00708b82 : MOV EDX,dword ptr [EDX + 0x4]
00708b85 : MOV word ptr [ESI + 0x58],AX
00708b89 : MOV EAX,dword ptr [EBP + 0x8]
00708b8c : ADD EAX,EDI
00708b8e : PUSH EAX
00708b8f : MOV ECX,EBX
00708b91 : CALL EDX
00708b93 : MOV EAX,dword ptr [EBX]
00708b95 : MOV EDX,dword ptr [EAX + 0x10]
00708b98 : MOV ECX,EBX
00708b9a : CALL EDX
00708b9c : ADD EDI,EAX
00708b9e : MOV EAX,dword ptr [EBP + 0x8]
00708ba1 : XOR ECX,ECX
00708ba3 : ADD EDI,EAX
00708ba5 : MOV dword ptr [EBP + -0x4],ECX
00708ba8 : MOV EAX,EDI
00708baa : MOV DX,CX
00708bad : LEA ECX,[ECX]
00708bb0 : MOVZX BX,byte ptr [EAX]
00708bb4 : SHL BX,CL
00708bb7 : ADD ECX,0x8
00708bba : INC EAX
00708bbb : OR DX,BX
00708bbe : CMP ECX,0x10
00708bc1 : JC 0x00708bb0
00708bc3 : MOV ECX,0x207
00708bc8 : CMP DX,CX
00708bcb : JNZ 0x00708bdf
00708bcd : MOV EDX,dword ptr [ESI + 0x178]
00708bd3 : MOV EAX,dword ptr [EDX + 0x4]
00708bd6 : LEA ECX,[ESI + 0x178]
00708bdc : PUSH EDI
00708bdd : CALL EAX
00708bdf : MOV EDX,dword ptr [ESI]
00708be1 : MOV EAX,dword ptr [EDX + 0x10]
00708be4 : MOV ECX,ESI
00708be6 : CALL EAX
00708be8 : POP EDI
00708be9 : POP ESI
00708bea : POP EBX
00708beb : MOV ESP,EBP
00708bed : POP EBP
00708bee : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_00515e00
ENTRY    : 00515e00
BODY     : [[00515e00, 00515eb5]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 FUN_00515e00(int param_1)

{
  LPCRITICAL_SECTION lpCriticalSection;
  int iVar1;
  int *in_ECX;
  int *piVar2;
  
  lpCriticalSection = (LPCRITICAL_SECTION)(in_ECX + 0xb1);
  EnterCriticalSection(lpCriticalSection);
  EnterCriticalSection(lpCriticalSection);
  EnterCriticalSection(lpCriticalSection);
  if (param_1 == 0) {
    LeaveCriticalSection(lpCriticalSection);
    piVar2 = in_ECX;
  }
  else {
    piVar2 = *(int **)(in_ECX[0xb7] + -4 + param_1 * 4);
    LeaveCriticalSection(lpCriticalSection);
  }
  iVar1 = (**(code **)(*piVar2 + 0x24))();
  LeaveCriticalSection(lpCriticalSection);
  if (iVar1 == 0) {
    (**(code **)(**(int **)(in_ECX[0xb7] + -4 + param_1 * 4) + 0x30))(0);
    FUN_005a87d0(*(undefined4 *)(in_ECX[0xb7] + -4 + param_1 * 4),0xb4);
    *(undefined4 *)(in_ECX[0xb7] + -4 + param_1 * 4) = 0;
    LeaveCriticalSection(lpCriticalSection);
    return 0;
  }
  LeaveCriticalSection(lpCriticalSection);
  return _DAT_00000000;
}



============================================================
DISASSEMBLY
============================================================
00515e00 : PUSH EBX
00515e01 : MOV EBX,dword ptr [0x00b85118]
00515e07 : PUSH EBP
00515e08 : PUSH ESI
00515e09 : PUSH EDI
00515e0a : MOV EDI,ECX
00515e0c : LEA ESI,[EDI + 0x2c4]
00515e12 : PUSH ESI
00515e13 : CALL EBX
00515e15 : PUSH ESI
00515e16 : CALL EBX
00515e18 : PUSH ESI
00515e19 : CALL EBX
00515e1b : MOV EBP,dword ptr [ESP + 0x14]
00515e1f : MOV EBX,dword ptr [0x00b8511c]
00515e25 : PUSH ESI
00515e26 : TEST EBP,EBP
00515e28 : JZ 0x00515e40
00515e2a : MOV EAX,dword ptr [EDI + 0x2dc]
00515e30 : MOV ECX,dword ptr [EAX + EBP*0x4 + -0x4]
00515e34 : MOV dword ptr [ESP + 0x18],ECX
00515e38 : CALL EBX
00515e3a : MOV ECX,dword ptr [ESP + 0x14]
00515e3e : JMP 0x00515e44
00515e40 : CALL EBX
00515e42 : MOV ECX,EDI
00515e44 : MOV EDX,dword ptr [ECX]
00515e46 : MOV EAX,dword ptr [EDX + 0x24]
00515e49 : CALL EAX
00515e4b : TEST EAX,EAX
00515e4d : PUSH ESI
00515e4e : SETZ byte ptr [ESP + 0x18]
00515e53 : CALL EBX
00515e55 : CMP byte ptr [ESP + 0x14],0x0
00515e5a : JZ 0x00515ea4
00515e5c : MOV ECX,dword ptr [EDI + 0x2dc]
00515e62 : MOV ECX,dword ptr [ECX + EBP*0x4 + -0x4]
00515e66 : MOV EDX,dword ptr [ECX]
00515e68 : MOV EAX,dword ptr [EDX + 0x30]
00515e6b : PUSH 0x0
00515e6d : CALL EAX
00515e6f : MOV ECX,dword ptr [EDI + 0x2dc]
00515e75 : MOV EDX,dword ptr [ECX + EBP*0x4 + -0x4]
00515e79 : PUSH 0xb4
00515e7e : PUSH EDX
00515e7f : LEA ECX,[EDI + 0x118]
00515e85 : CALL 0x005a87d0
00515e8a : MOV EAX,dword ptr [EDI + 0x2dc]
00515e90 : PUSH ESI
00515e91 : MOV dword ptr [EAX + EBP*0x4 + -0x4],0x0
00515e99 : CALL EBX
00515e9b : POP EDI
00515e9c : POP ESI
00515e9d : POP EBP
00515e9e : XOR EAX,EAX
00515ea0 : POP EBX
00515ea1 : RET 0x4
00515ea4 : MOV EDI,dword ptr [0x00000000]
00515eaa : PUSH ESI
00515eab : CALL EBX
00515ead : MOV EAX,EDI
00515eaf : POP EDI
00515eb0 : POP ESI
00515eb1 : POP EBP
00515eb2 : POP EBX
00515eb3 : RET 0x4

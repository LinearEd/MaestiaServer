PROGRAM  : Maestia.exe
FUNCTION : FUN_00597cf0
ENTRY    : 00597cf0
BODY     : [[00597cf0, 00597dee]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00597cf0(void)

{
  GRefCountNTSImpl *pGVar1;
  int *piVar2;
  GRefCountNTSImpl *pGVar3;
  char cVar4;
  int iVar5;
  undefined4 uVar6;
  GRefCountNTSImpl *in_ECX;
  GRefCountNTSImpl *pGVar7;
  GRefCountNTSImpl *local_4;
  
  if ((**(int **)(in_ECX + 0xc) != 0) &&
     (local_4 = in_ECX, FUN_00597b80(&local_4), pGVar7 = local_4, local_4 != (GRefCountNTSImpl *)0x0
     )) {
    iVar5 = (**(code **)(*(int *)local_4 + 0x9c))();
    pGVar3 = local_4;
    if (iVar5 == 4) {
      *(int *)(pGVar7 + 4) = *(int *)(pGVar7 + 4) + 1;
      pGVar1 = pGVar7 + 4;
      cVar4 = (**(code **)(*(int *)local_4 + 0x170))();
      pGVar7 = pGVar3;
      if (cVar4 != '\0') {
        iVar5 = *(int *)(in_ECX + 0xc);
        *(int *)pGVar1 = *(int *)pGVar1 + 1;
        pGVar7 = *(GRefCountNTSImpl **)(iVar5 + 4);
        if (pGVar7 != (GRefCountNTSImpl *)0x0) {
          GRefCountNTSImpl::Release(pGVar7);
        }
        *(GRefCountNTSImpl **)(iVar5 + 4) = local_4;
        piVar2 = *(int **)(*(int *)(in_ECX + 0xc) + 4);
        iVar5 = *piVar2;
        uVar6 = (**(code **)(iVar5 + 0x160))(0xffffffff);
        uVar6 = (**(code **)(*piVar2 + 0x15c))(uVar6);
        (**(code **)(iVar5 + 0x16c))(&DAT_00cca49c,uVar6);
        uVar6 = (**(code **)(**(int **)(*(int *)(in_ECX + 0xc) + 4) + 0x15c))();
        *(undefined4 *)(*(int *)(in_ECX + 0xc) + 8) = uVar6;
        uVar6 = *(undefined4 *)(*(int *)(in_ECX + 0xc) + 8);
        (**(code **)(**(int **)(*(int *)(in_ECX + 0xc) + 4) + 0x154))(uVar6,uVar6);
        (**(code **)(**(int **)(*(int *)(in_ECX + 0xc) + 4) + 0x174))();
        pGVar7 = local_4;
      }
      GRefCountNTSImpl::Release(pGVar7);
    }
    GRefCountNTSImpl::Release(pGVar7);
    return;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00597cf0 : PUSH ECX
00597cf1 : PUSH EDI
00597cf2 : MOV EDI,ECX
00597cf4 : MOV EAX,dword ptr [EDI + 0xc]
00597cf7 : CMP dword ptr [EAX],0x0
00597cfa : JZ 0x00597dec
00597d00 : PUSH EBP
00597d01 : LEA ECX,[ESP + 0x8]
00597d05 : PUSH ECX
00597d06 : MOV ECX,dword ptr [EAX]
00597d08 : CALL 0x00597b80
00597d0d : MOV EBP,dword ptr [ESP + 0x8]
00597d11 : TEST EBP,EBP
00597d13 : JZ 0x00597deb
00597d19 : MOV EDX,dword ptr [EBP]
00597d1c : MOV EAX,dword ptr [EDX + 0x9c]
00597d22 : MOV ECX,EBP
00597d24 : CALL EAX
00597d26 : CMP EAX,0x4
00597d29 : JNZ 0x00597ddf
00597d2f : INC dword ptr [EBP + 0x4]
00597d32 : PUSH EBX
00597d33 : LEA EBX,[EBP + 0x4]
00597d36 : MOV EBP,dword ptr [ESP + 0xc]
00597d3a : MOV EDX,dword ptr [EBP]
00597d3d : MOV EAX,dword ptr [EDX + 0x170]
00597d43 : MOV ECX,EBP
00597d45 : CALL EAX
00597d47 : TEST AL,AL
00597d49 : JZ 0x00597dd7
00597d4f : PUSH ESI
00597d50 : MOV ESI,dword ptr [EDI + 0xc]
00597d53 : INC dword ptr [EBX]
00597d55 : MOV ECX,dword ptr [ESI + 0x4]
00597d58 : ADD ESI,0x4
00597d5b : TEST ECX,ECX
00597d5d : JZ 0x00597d64
00597d5f : CALL 0x004ff7c0
00597d64 : MOV EBP,dword ptr [ESP + 0x10]
00597d68 : MOV dword ptr [ESI],EBP
00597d6a : MOV ECX,dword ptr [EDI + 0xc]
00597d6d : MOV ESI,dword ptr [ECX + 0x4]
00597d70 : MOV EBX,dword ptr [ESI]
00597d72 : MOV EDX,dword ptr [EBX + 0x160]
00597d78 : PUSH -0x1
00597d7a : MOV ECX,ESI
00597d7c : CALL EDX
00597d7e : PUSH EAX
00597d7f : MOV EAX,dword ptr [ESI]
00597d81 : MOV EDX,dword ptr [EAX + 0x15c]
00597d87 : MOV ECX,ESI
00597d89 : CALL EDX
00597d8b : PUSH EAX
00597d8c : MOV EAX,dword ptr [EBX + 0x16c]
00597d92 : PUSH 0xcca49c
00597d97 : MOV ECX,ESI
00597d99 : CALL EAX
00597d9b : MOV ECX,dword ptr [EDI + 0xc]
00597d9e : MOV ECX,dword ptr [ECX + 0x4]
00597da1 : MOV EDX,dword ptr [ECX]
00597da3 : MOV EAX,dword ptr [EDX + 0x15c]
00597da9 : CALL EAX
00597dab : MOV ECX,dword ptr [EDI + 0xc]
00597dae : MOV dword ptr [ECX + 0x8],EAX
00597db1 : MOV EAX,dword ptr [EDI + 0xc]
00597db4 : MOV ECX,dword ptr [EAX + 0x4]
00597db7 : MOV EAX,dword ptr [EAX + 0x8]
00597dba : MOV EDX,dword ptr [ECX]
00597dbc : PUSH EAX
00597dbd : PUSH EAX
00597dbe : MOV EAX,dword ptr [EDX + 0x154]
00597dc4 : CALL EAX
00597dc6 : MOV ECX,dword ptr [EDI + 0xc]
00597dc9 : MOV ECX,dword ptr [ECX + 0x4]
00597dcc : MOV EDX,dword ptr [ECX]
00597dce : MOV EAX,dword ptr [EDX + 0x174]
00597dd4 : CALL EAX
00597dd6 : POP ESI
00597dd7 : MOV ECX,EBP
00597dd9 : CALL 0x004ff7c0
00597dde : POP EBX
00597ddf : MOV ECX,EBP
00597de1 : POP EBP
00597de2 : POP EDI
00597de3 : ADD ESP,0x4
00597de6 : JMP 0x004ff7c0
00597deb : POP EBP
00597dec : POP EDI
00597ded : POP ECX
00597dee : RET

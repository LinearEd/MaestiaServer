PROGRAM  : Maestia.exe
FUNCTION : FUN_0077ce30
ENTRY    : 0077ce30
BODY     : [[0077ce30, 0077d059] [0077d079, 0077d096]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0077ce30(int param_1)

{
  int *piVar1;
  wchar_t *pwVar2;
  size_t _ElementSize;
  void *_DstBuf;
  int iVar3;
  undefined4 uVar4;
  int in_ECX;
  wchar_t *pwVar5;
  FILE *local_23c;
  int *local_238;
  undefined1 local_234 [28];
  wchar_t local_218 [256];
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3c257;
  local_10 = ExceptionList;
  local_18 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar3 = *(int *)(DAT_017251ac + 0x18);
  if (iVar3 != 0) {
    piVar1 = *(int **)(param_1 + 0x1c);
    if (piVar1 != (int *)0x0) {
      (**(code **)(*piVar1 + 8))(piVar1,local_18);
      *(undefined4 *)(param_1 + 0x1c) = 0;
    }
    pwVar5 = (wchar_t *)(in_ECX + 4);
    local_238 = (int *)0x0;
    local_23c = (FILE *)0x0;
    pwVar2 = pwVar5;
    if (7 < *(uint *)(in_ECX + 0x18)) {
      pwVar2 = *(wchar_t **)pwVar5;
    }
    __wfopen_s(&local_23c,pwVar2,(wchar_t *)&PTR_LAB_00c10888);
    if (local_23c != (FILE *)0x0) {
      _fseek(local_23c,0,2);
      _ElementSize = _ftell(local_23c);
      _fseek(local_23c,0,0);
      _DstBuf = (void *)FUN_006f0760(_ElementSize,"",0,(DAT_01725270 >> 3 & 1) == 0);
      _fread(_DstBuf,_ElementSize,1,local_23c);
      _fclose(local_23c);
      iVar3 = D3DXCreateEffect(iVar3,_DstBuf,_ElementSize,0,0,0x800,0,(undefined4 *)(param_1 + 0x1c)
                               ,&local_238);
      if (-1 < iVar3) {
        if (local_238 != (int *)0x0) {
          (**(code **)(*local_238 + 8))(local_238);
          local_238 = (int *)0x0;
        }
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      pwVar2 = local_218;
      for (iVar3 = 0x80; iVar3 != 0; iVar3 = iVar3 + -1) {
        pwVar2[0] = L'\0';
        pwVar2[1] = L'\0';
        pwVar2 = pwVar2 + 2;
      }
      if (7 < *(uint *)(in_ECX + 0x18)) {
        pwVar5 = *(wchar_t **)pwVar5;
      }
      uVar4 = (**(code **)(*local_238 + 0xc))(local_238);
      _swprintf_s(local_218,0x100,L"[AvaShaderData::LoadComplied] %s, Error: %s",pwVar5,uVar4);
      (*(code *)PTR_FUN_00d6d23c)("ShaderData Load Error(");
      FUN_00406460(local_218);
      local_8 = 0;
      FUN_00464320(local_234);
      (*(code *)PTR_FUN_00d6d23c)(&DAT_00c10900);
      if (local_238 != (int *)0x0) {
        (**(code **)(*local_238 + 8))(local_238);
        local_238 = (int *)0x0;
      }
      local_8 = 0xffffffff;
      FUN_00406560();
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0077ce30 : PUSH EBP
0077ce31 : MOV EBP,ESP
0077ce33 : PUSH -0x1
0077ce35 : PUSH 0xb3c257
0077ce3a : MOV EAX,FS:[0x0]
0077ce40 : PUSH EAX
0077ce41 : SUB ESP,0x240
0077ce47 : MOV EAX,[0x00d66fa0]
0077ce4c : XOR EAX,EBP
0077ce4e : MOV dword ptr [EBP + -0x14],EAX
0077ce51 : PUSH EBX
0077ce52 : PUSH ESI
0077ce53 : PUSH EDI
0077ce54 : PUSH EAX
0077ce55 : LEA EAX,[EBP + -0xc]
0077ce58 : MOV FS:[0x0],EAX
0077ce5e : MOV EAX,[0x017251ac]
0077ce63 : MOV EAX,dword ptr [EAX + 0x18]
0077ce66 : MOV EBX,dword ptr [EBP + 0x8]
0077ce69 : XOR EDI,EDI
0077ce6b : MOV ESI,ECX
0077ce6d : MOV dword ptr [EBP + 0xfffffdb8],EBX
0077ce73 : MOV dword ptr [EBP + 0xfffffdc0],ESI
0077ce79 : MOV dword ptr [EBP + 0xfffffdbc],EAX
0077ce7f : CMP EAX,EDI
0077ce81 : JZ 0x0077d037
0077ce87 : MOV EAX,dword ptr [EBX + 0x1c]
0077ce8a : ADD EBX,0x1c
0077ce8d : CMP EAX,EDI
0077ce8f : JZ 0x0077ce9b
0077ce91 : MOV ECX,dword ptr [EAX]
0077ce93 : MOV EDX,dword ptr [ECX + 0x8]
0077ce96 : PUSH EAX
0077ce97 : CALL EDX
0077ce99 : MOV dword ptr [EBX],EDI
0077ce9b : CMP dword ptr [ESI + 0x18],0x8
0077ce9f : LEA EAX,[ESI + 0x4]
0077cea2 : MOV dword ptr [EBP + 0xfffffdcc],EDI
0077cea8 : MOV dword ptr [EBP + 0xfffffdc8],EDI
0077ceae : MOV dword ptr [EBP + 0xfffffdc4],EAX
0077ceb4 : JC 0x0077ceb8
0077ceb6 : MOV EAX,dword ptr [EAX]
0077ceb8 : PUSH 0xc10888
0077cebd : PUSH EAX
0077cebe : LEA EAX,[EBP + 0xfffffdc8]
0077cec4 : PUSH EAX
0077cec5 : CALL 0x0063641b
0077ceca : MOV EAX,dword ptr [EBP + 0xfffffdc8]
0077ced0 : ADD ESP,0xc
0077ced3 : CMP EAX,EDI
0077ced5 : JZ 0x0077d037
0077cedb : PUSH 0x2
0077cedd : PUSH EDI
0077cede : PUSH EAX
0077cedf : CALL 0x006377fb
0077cee4 : MOV ECX,dword ptr [EBP + 0xfffffdc8]
0077ceea : ADD ESP,0xc
0077ceed : PUSH ECX
0077ceee : CALL 0x0063751f
0077cef3 : MOV EDX,dword ptr [EBP + 0xfffffdc8]
0077cef9 : ADD ESP,0x4
0077cefc : PUSH EDI
0077cefd : PUSH EDI
0077cefe : PUSH EDX
0077ceff : MOV ESI,EAX
0077cf01 : CALL 0x006377fb
0077cf06 : MOV EAX,[0x01725270]
0077cf0b : ADD ESP,0xc
0077cf0e : SHR EAX,0x3
0077cf11 : MOV ECX,EDI
0077cf13 : AND EAX,0x1
0077cf16 : SETZ CL
0077cf19 : PUSH ECX
0077cf1a : PUSH EDI
0077cf1b : PUSH 0xbf1a4b
0077cf20 : PUSH ESI
0077cf21 : CALL 0x006f0760
0077cf26 : MOV EDX,dword ptr [EBP + 0xfffffdc8]
0077cf2c : PUSH EDX
0077cf2d : PUSH 0x1
0077cf2f : MOV EDI,EAX
0077cf31 : PUSH ESI
0077cf32 : PUSH EDI
0077cf33 : CALL 0x00638b7b
0077cf38 : MOV EAX,dword ptr [EBP + 0xfffffdc8]
0077cf3e : PUSH EAX
0077cf3f : CALL 0x006366db
0077cf44 : MOV EDX,dword ptr [EBP + 0xfffffdbc]
0077cf4a : ADD ESP,0x24
0077cf4d : LEA ECX,[EBP + 0xfffffdcc]
0077cf53 : PUSH ECX
0077cf54 : PUSH EBX
0077cf55 : XOR EBX,EBX
0077cf57 : PUSH EBX
0077cf58 : PUSH 0x800
0077cf5d : PUSH EBX
0077cf5e : PUSH EBX
0077cf5f : PUSH ESI
0077cf60 : PUSH EDI
0077cf61 : PUSH EDX
0077cf62 : CALL 0x00664d14
0077cf67 : CMP EAX,EBX
0077cf69 : JGE 0x0077d03b
0077cf6f : XOR EAX,EAX
0077cf71 : MOVZX EDX,AX
0077cf74 : MOV EAX,EDX
0077cf76 : SHL EDX,0x10
0077cf79 : OR EAX,EDX
0077cf7b : MOV ECX,0x80
0077cf80 : LEA EDI,[EBP + 0xfffffdec]
0077cf86 : STOSD.REP ES:EDI
0077cf88 : MOV EAX,dword ptr [EBP + 0xfffffdc0]
0077cf8e : CMP dword ptr [EAX + 0x18],0x8
0077cf92 : JC 0x0077cf9e
0077cf94 : MOV ECX,dword ptr [EBP + 0xfffffdc4]
0077cf9a : MOV ESI,dword ptr [ECX]
0077cf9c : JMP 0x0077cfa4
0077cf9e : MOV ESI,dword ptr [EBP + 0xfffffdc4]
0077cfa4 : MOV EAX,dword ptr [EBP + 0xfffffdcc]
0077cfaa : MOV EDX,dword ptr [EAX]
0077cfac : PUSH EAX
0077cfad : MOV EAX,dword ptr [EDX + 0xc]
0077cfb0 : CALL EAX
0077cfb2 : PUSH EAX
0077cfb3 : PUSH ESI
0077cfb4 : PUSH 0xc10890
0077cfb9 : LEA ECX,[EBP + 0xfffffdec]
0077cfbf : PUSH 0x100
0077cfc4 : PUSH ECX
0077cfc5 : CALL 0x00635d51
0077cfca : ADD ESP,0x14
0077cfcd : PUSH 0xc108e8
0077cfd2 : CALL dword ptr [0x00d6d23c]
0077cfd8 : ADD ESP,0x4
0077cfdb : LEA EDX,[EBP + 0xfffffdec]
0077cfe1 : PUSH EDX
0077cfe2 : LEA ECX,[EBP + 0xfffffdd0]
0077cfe8 : CALL 0x00406460
0077cfed : MOV dword ptr [EBP + -0x4],EBX
0077cff0 : LEA EAX,[EBP + 0xfffffdd0]
0077cff6 : PUSH EAX
0077cff7 : CALL 0x00464320
0077cffc : ADD ESP,0x4
0077cfff : PUSH 0xc10900
0077d004 : CALL dword ptr [0x00d6d23c]
0077d00a : MOV EAX,dword ptr [EBP + 0xfffffdcc]
0077d010 : ADD ESP,0x4
0077d013 : CMP EAX,EBX
0077d015 : JZ 0x0077d025
0077d017 : MOV ECX,dword ptr [EAX]
0077d019 : MOV EDX,dword ptr [ECX + 0x8]
0077d01c : PUSH EAX
0077d01d : CALL EDX
0077d01f : MOV dword ptr [EBP + 0xfffffdcc],EBX
0077d025 : MOV dword ptr [EBP + -0x4],0xffffffff
0077d02c : LEA ECX,[EBP + 0xfffffdd0]
0077d032 : CALL 0x00406560
0077d037 : XOR AL,AL
0077d039 : JMP 0x0077d079
0077d03b : MOV EAX,dword ptr [EBP + 0xfffffdcc]
0077d041 : CMP EAX,EBX
0077d043 : JZ 0x0077d053
0077d045 : MOV ECX,dword ptr [EAX]
0077d047 : MOV EDX,dword ptr [ECX + 0x8]
0077d04a : PUSH EAX
0077d04b : CALL EDX
0077d04d : MOV dword ptr [EBP + 0xfffffdcc],EBX
0077d053 : MOV ECX,EDI
0077d055 : CALL 0x006f04e0
0077d079 : MOV ECX,dword ptr [EBP + -0xc]
0077d07c : MOV dword ptr FS:[0x0],ECX
0077d083 : POP ECX
0077d084 : POP EDI
0077d085 : POP ESI
0077d086 : POP EBX
0077d087 : MOV ECX,dword ptr [EBP + -0x14]
0077d08a : XOR ECX,EBP
0077d08c : CALL 0x00633e6b
0077d091 : MOV ESP,EBP
0077d093 : POP EBP
0077d094 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_0080b7e0
ENTRY    : 0080b7e0
BODY     : [[0080b7e0, 0080b8e9]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Type propagation algorithm not settling */

void FUN_0080b7e0(UINT param_1)

{
  WCHAR WVar1;
  uint uVar2;
  WCHAR *pWVar3;
  int iVar4;
  int in_EDX;
  int unaff_ESI;
  undefined4 *puVar5;
  WCHAR local_a14;
  undefined1 local_a12 [2046];
  undefined4 local_214 [128];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1a745;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  pWVar3 = &local_a14;
  local_14 = uVar2;
  for (iVar4 = 0x200; iVar4 != 0; iVar4 = iVar4 + -1) {
    pWVar3[0] = L'\0';
    pWVar3[1] = L'\0';
    pWVar3 = pWVar3 + 2;
  }
  iVar4 = LoadStringW(*(HINSTANCE *)(in_EDX + 4),param_1,&local_a14,0x400);
  if (iVar4 == 0) {
    puVar5 = local_214;
    for (iVar4 = 0x80; iVar4 != 0; iVar4 = iVar4 + -1) {
      *puVar5 = 0;
      puVar5 = puVar5 + 1;
    }
    FUN_0040e4a0(L"Failed to load string resource : %d",param_1,uVar2);
  }
  *(undefined4 *)(unaff_ESI + 0x18) = 7;
  *(undefined4 *)(unaff_ESI + 0x14) = 0;
  *(undefined2 *)(unaff_ESI + 4) = 0;
  pWVar3 = &local_a14;
  do {
    WVar1 = *pWVar3;
    pWVar3 = pWVar3 + 1;
  } while (WVar1 != L'\0');
  FUN_00406360(&local_a14,(int)pWVar3 - (int)local_a12 >> 1);
  local_8 = 0;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0080b7e0 : PUSH EBP
0080b7e1 : MOV EBP,ESP
0080b7e3 : PUSH -0x1
0080b7e5 : PUSH 0xb1a745
0080b7ea : MOV EAX,FS:[0x0]
0080b7f0 : PUSH EAX
0080b7f1 : SUB ESP,0xa0c
0080b7f7 : MOV EAX,[0x00d66fa0]
0080b7fc : XOR EAX,EBP
0080b7fe : MOV dword ptr [EBP + -0x10],EAX
0080b801 : PUSH EBX
0080b802 : PUSH EDI
0080b803 : PUSH EAX
0080b804 : LEA EAX,[EBP + -0xc]
0080b807 : MOV FS:[0x0],EAX
0080b80d : XOR EAX,EAX
0080b80f : MOVZX EBX,AX
0080b812 : MOV EAX,EBX
0080b814 : SHL EBX,0x10
0080b817 : OR EAX,EBX
0080b819 : MOV EBX,dword ptr [EBP + 0x8]
0080b81c : MOV dword ptr [EBP + 0xfffff5ec],0x0
0080b826 : MOV ECX,0x200
0080b82b : LEA EDI,[EBP + 0xfffff5f0]
0080b831 : STOSD.REP ES:EDI
0080b833 : MOV ECX,dword ptr [EDX + 0x4]
0080b836 : PUSH 0x400
0080b83b : LEA EAX,[EBP + 0xfffff5f0]
0080b841 : PUSH EAX
0080b842 : PUSH EBX
0080b843 : PUSH ECX
0080b844 : MOV dword ptr [EBP + 0xfffff5e8],ESI
0080b84a : CALL dword ptr [0x00b854e4]
0080b850 : TEST EAX,EAX
0080b852 : JNZ 0x0080b87f
0080b854 : MOVZX EDX,AX
0080b857 : MOV EAX,EDX
0080b859 : SHL EDX,0x10
0080b85c : OR EAX,EDX
0080b85e : PUSH EBX
0080b85f : MOV ECX,0x80
0080b864 : LEA EDI,[EBP + 0xfffffdf0]
0080b86a : PUSH 0xc2d408
0080b86f : LEA EDX,[EBP + 0xfffffdf0]
0080b875 : STOSD.REP ES:EDI
0080b877 : CALL 0x0040e4a0
0080b87c : ADD ESP,0x8
0080b87f : XOR EDI,EDI
0080b881 : XOR EAX,EAX
0080b883 : MOV dword ptr [ESI + 0x18],0x7
0080b88a : MOV dword ptr [ESI + 0x14],EDI
0080b88d : MOV word ptr [ESI + 0x4],AX
0080b891 : LEA EAX,[EBP + 0xfffff5f0]
0080b897 : LEA EDX,[EAX + 0x2]
0080b89a : LEA EBX,[EBX]
0080b8a0 : MOV CX,word ptr [EAX]
0080b8a3 : ADD EAX,0x2
0080b8a6 : CMP CX,DI
0080b8a9 : JNZ 0x0080b8a0
0080b8ab : SUB EAX,EDX
0080b8ad : SAR EAX,0x1
0080b8af : PUSH EAX
0080b8b0 : LEA ECX,[EBP + 0xfffff5f0]
0080b8b6 : PUSH ECX
0080b8b7 : MOV ECX,ESI
0080b8b9 : CALL 0x00406360
0080b8be : MOV dword ptr [EBP + -0x4],EDI
0080b8c1 : MOV dword ptr [EBP + 0xfffff5ec],0x1
0080b8cb : MOV EAX,ESI
0080b8cd : MOV ECX,dword ptr [EBP + -0xc]
0080b8d0 : MOV dword ptr FS:[0x0],ECX
0080b8d7 : POP ECX
0080b8d8 : POP EDI
0080b8d9 : POP EBX
0080b8da : MOV ECX,dword ptr [EBP + -0x10]
0080b8dd : XOR ECX,EBP
0080b8df : CALL 0x00633e6b
0080b8e4 : MOV ESP,EBP
0080b8e6 : POP EBP
0080b8e7 : RET 0x4

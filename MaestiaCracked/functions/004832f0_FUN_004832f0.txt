PROGRAM  : Maestia.exe
FUNCTION : FUN_004832f0
ENTRY    : 004832f0
BODY     : [[004832f0, 004835cd]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_004832f0(void)

{
  int Comperand;
  int *piVar1;
  int *piVar2;
  LONG LVar3;
  int in_ECX;
  LONG *Destination;
  int *local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b73f08;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if (*(char *)(in_ECX + 8) != '\0') {
    FUN_0047f350(DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
    *(undefined1 *)(in_ECX + 0xf4) = 0;
    *(undefined1 *)(in_ECX + 0xf6) = 0;
    *(undefined1 *)(in_ECX + 0xf7) = 0;
    *(undefined1 *)(in_ECX + 0xf8) = 0;
    EnterCriticalSection((LPCRITICAL_SECTION)(in_ECX + 0x184));
    local_8 = 0;
    if (*(int *)(in_ECX + 0x180) != 0) {
      local_18 = (int *)(*(int *)(in_ECX + 0x180) + -8);
joined_r0x00483370:
      piVar1 = local_18;
      if (piVar1 != (int *)0x0) {
        if (piVar1 == (int *)0x0) {
          piVar2 = (int *)0x0;
        }
        else {
          piVar2 = piVar1 + 2;
        }
        if (piVar2 == (int *)(in_ECX + 0x17c)) goto LAB_0048341d;
        if (piVar1[3] == 0) {
          local_18 = (int *)0x0;
        }
        else {
          local_18 = (int *)(piVar1[3] + -8);
        }
        Destination = piVar1 + 1;
        Comperand = piVar1[1];
        while (Comperand != 0) {
          LVar3 = InterlockedCompareExchange(Destination,Comperand + 1,Comperand);
          if (LVar3 == Comperand) {
            if (((piVar1[0x12] != 0) && ((char)piVar1[8] == '\0')) &&
               (*(char *)(in_ECX + 0x28a) == '\0')) {
              (**(code **)(*piVar1 + 0x3c))();
              FUN_00740690(1);
            }
            LVar3 = InterlockedExchangeAdd(Destination,-1);
            if (LVar3 == 1) {
              (**(code **)*piVar1)(1);
            }
            break;
          }
          Comperand = *Destination;
        }
        goto joined_r0x00483370;
      }
    }
LAB_0048341d:
    local_8 = 0xffffffff;
    LeaveCriticalSection((LPCRITICAL_SECTION)(in_ECX + 0x184));
    piVar1 = *(int **)(in_ECX + 0x1c0);
    if (piVar1 != (int *)0x0) {
      (**(code **)(*piVar1 + 8))(piVar1);
    }
    *(undefined4 *)(in_ECX + 0x1c0) = 0;
    piVar1 = *(int **)(in_ECX + 0x1c4);
    if (piVar1 != (int *)0x0) {
      (**(code **)(*piVar1 + 8))(piVar1);
    }
    *(undefined4 *)(in_ECX + 0x1c4) = 0;
    *(undefined4 *)(in_ECX + 0x1c8) = 0;
    *(undefined4 *)(in_ECX + 0x1cc) = 0;
    *(undefined4 *)(in_ECX + 0x200) = 0;
    *(undefined4 *)(in_ECX + 0x204) = 0;
    *(undefined1 *)(in_ECX + 0x1a0) = 0;
    *(undefined4 *)(in_ECX + 0x19c) = 0;
    piVar1 = *(int **)(in_ECX + 0x284);
    if (piVar1 != (int *)0x0) {
      (**(code **)(*piVar1 + 8))(piVar1);
    }
    *(undefined4 *)(in_ECX + 0x284) = 0;
    piVar1 = *(int **)(in_ECX + 0x280);
    if (piVar1 != (int *)0x0) {
      (**(code **)(*piVar1 + 8))(piVar1);
    }
    piVar1 = *(int **)(in_ECX + 0x284);
    *(int **)(in_ECX + 0x280) = piVar1;
    if (piVar1 != (int *)0x0) {
      (**(code **)(*piVar1 + 4))(piVar1);
    }
    piVar1 = *(int **)(in_ECX + 0x27c);
    if (piVar1 != (int *)0x0) {
      (**(code **)(*piVar1 + 8))(piVar1);
    }
    piVar1 = *(int **)(in_ECX + 0x280);
    *(int **)(in_ECX + 0x27c) = piVar1;
    if (piVar1 != (int *)0x0) {
      (**(code **)(*piVar1 + 4))(piVar1);
    }
    piVar1 = *(int **)(in_ECX + 0x278);
    if (piVar1 != (int *)0x0) {
      (**(code **)(*piVar1 + 8))(piVar1);
    }
    *(undefined4 *)(in_ECX + 0x278) = *(undefined4 *)(in_ECX + 0x27c);
    piVar1 = *(int **)(in_ECX + 0x274);
    if (piVar1 != (int *)0x0) {
      (**(code **)(*piVar1 + 8))(piVar1);
    }
    *(undefined4 *)(in_ECX + 0x274) = 0;
    piVar1 = *(int **)(in_ECX + 0x270);
    if (piVar1 != (int *)0x0) {
      (**(code **)(*piVar1 + 8))(piVar1);
    }
    piVar1 = *(int **)(in_ECX + 0x274);
    *(int **)(in_ECX + 0x270) = piVar1;
    if (piVar1 != (int *)0x0) {
      (**(code **)(*piVar1 + 4))(piVar1);
    }
    piVar1 = *(int **)(in_ECX + 0x26c);
    if (piVar1 != (int *)0x0) {
      (**(code **)(*piVar1 + 8))(piVar1);
    }
    piVar1 = *(int **)(in_ECX + 0x270);
    *(int **)(in_ECX + 0x26c) = piVar1;
    if (piVar1 != (int *)0x0) {
      (**(code **)(*piVar1 + 4))(piVar1);
    }
    piVar1 = *(int **)(in_ECX + 0x268);
    if (piVar1 != (int *)0x0) {
      (**(code **)(*piVar1 + 8))(piVar1);
    }
    *(undefined4 *)(in_ECX + 0x268) = *(undefined4 *)(in_ECX + 0x26c);
    FUN_0047ff00(in_ECX);
    (**(code **)(**(int **)(in_ECX + 0xf0) + 8))(*(int **)(in_ECX + 0xf0));
    *(undefined4 *)(in_ECX + 0xf0) = 0;
    *(undefined4 *)(in_ECX + 600) = 0;
    *(undefined1 *)(in_ECX + 8) = 0;
  }
  ExceptionList = local_10;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
004832f0 : PUSH EBP
004832f1 : MOV EBP,ESP
004832f3 : PUSH -0x1
004832f5 : PUSH 0xb73f08
004832fa : MOV EAX,FS:[0x0]
00483300 : PUSH EAX
00483301 : SUB ESP,0xc
00483304 : PUSH EBX
00483305 : PUSH ESI
00483306 : PUSH EDI
00483307 : MOV EAX,[0x00d66fa0]
0048330c : XOR EAX,EBP
0048330e : PUSH EAX
0048330f : LEA EAX,[EBP + -0xc]
00483312 : MOV FS:[0x0],EAX
00483318 : MOV ESI,ECX
0048331a : CMP byte ptr [ESI + 0x8],0x0
0048331e : JZ 0x004835ba
00483324 : CALL 0x0047f350
00483329 : LEA EDI,[ESI + 0x184]
0048332f : PUSH EDI
00483330 : MOV byte ptr [ESI + 0xf4],0x0
00483337 : MOV byte ptr [ESI + 0xf6],0x0
0048333e : MOV byte ptr [ESI + 0xf7],0x0
00483345 : MOV byte ptr [ESI + 0xf8],0x0
0048334c : MOV dword ptr [EBP + -0x18],EDI
0048334f : CALL dword ptr [0x00b85118]
00483355 : MOV dword ptr [EBP + -0x4],0x0
0048335c : MOV EBX,dword ptr [ESI + 0x180]
00483362 : TEST EBX,EBX
00483364 : JZ 0x0048341d
0048336a : ADD EBX,-0x8
0048336d : MOV dword ptr [EBP + -0x10],EBX
00483370 : JZ 0x0048341d
00483376 : JMP 0x0048337b
00483378 : MOV EBX,dword ptr [EBP + -0x10]
0048337b : TEST EBX,EBX
0048337d : JZ 0x00483384
0048337f : LEA EAX,[EBX + 0x8]
00483382 : JMP 0x00483386
00483384 : XOR EAX,EAX
00483386 : LEA ECX,[ESI + 0x17c]
0048338c : CMP EAX,ECX
0048338e : JZ 0x0048341a
00483394 : MOV EAX,dword ptr [EBX + 0xc]
00483397 : TEST EAX,EAX
00483399 : JZ 0x004833a3
0048339b : ADD EAX,-0x8
0048339e : MOV dword ptr [EBP + -0x14],EAX
004833a1 : JMP 0x004833aa
004833a3 : MOV dword ptr [EBP + -0x14],0x0
004833aa : MOV EDI,dword ptr [EBX + 0x4]
004833ad : ADD EBX,0x4
004833b0 : TEST EDI,EDI
004833b2 : JZ 0x0048340c
004833b4 : PUSH EDI
004833b5 : LEA EAX,[EDI + 0x1]
004833b8 : PUSH EAX
004833b9 : PUSH EBX
004833ba : CALL dword ptr [0x00b85228]
004833c0 : CMP EAX,EDI
004833c2 : JZ 0x004833cc
004833c4 : MOV EDI,dword ptr [EBX]
004833c6 : TEST EDI,EDI
004833c8 : JNZ 0x004833b4
004833ca : JMP 0x0048340c
004833cc : MOV EDI,dword ptr [EBP + -0x10]
004833cf : CMP dword ptr [EDI + 0x48],0x0
004833d3 : JZ 0x004833f4
004833d5 : CMP byte ptr [EDI + 0x20],0x0
004833d9 : JNZ 0x004833f4
004833db : CMP byte ptr [ESI + 0x28a],0x0
004833e2 : JNZ 0x004833f4
004833e4 : MOV EAX,dword ptr [EDI]
004833e6 : MOV EDX,dword ptr [EAX + 0x3c]
004833e9 : MOV ECX,EDI
004833eb : CALL EDX
004833ed : PUSH 0x1
004833ef : CALL 0x00740690
004833f4 : PUSH -0x1
004833f6 : PUSH EBX
004833f7 : CALL dword ptr [0x00b851cc]
004833fd : ADD EAX,-0x1
00483400 : JNZ 0x0048340c
00483402 : MOV EAX,dword ptr [EDI]
00483404 : MOV EDX,dword ptr [EAX]
00483406 : PUSH 0x1
00483408 : MOV ECX,EDI
0048340a : CALL EDX
0048340c : MOV EAX,dword ptr [EBP + -0x14]
0048340f : MOV dword ptr [EBP + -0x10],EAX
00483412 : TEST EAX,EAX
00483414 : JNZ 0x00483378
0048341a : MOV EDI,dword ptr [EBP + -0x18]
0048341d : MOV dword ptr [EBP + -0x4],0xffffffff
00483424 : PUSH EDI
00483425 : CALL dword ptr [0x00b8511c]
0048342b : MOV EAX,dword ptr [ESI + 0x1c0]
00483431 : XOR EDI,EDI
00483433 : CMP EAX,EDI
00483435 : JZ 0x0048343f
00483437 : MOV ECX,dword ptr [EAX]
00483439 : MOV EDX,dword ptr [ECX + 0x8]
0048343c : PUSH EAX
0048343d : CALL EDX
0048343f : MOV dword ptr [ESI + 0x1c0],EDI
00483445 : MOV EAX,dword ptr [ESI + 0x1c4]
0048344b : CMP EAX,EDI
0048344d : JZ 0x00483457
0048344f : MOV ECX,dword ptr [EAX]
00483451 : MOV EDX,dword ptr [ECX + 0x8]
00483454 : PUSH EAX
00483455 : CALL EDX
00483457 : MOV dword ptr [ESI + 0x1c4],EDI
0048345d : MOV dword ptr [ESI + 0x1c8],EDI
00483463 : MOV dword ptr [ESI + 0x1cc],EDI
00483469 : MOV dword ptr [ESI + 0x200],EDI
0048346f : MOV dword ptr [ESI + 0x204],EDI
00483475 : MOV byte ptr [ESI + 0x1a0],0x0
0048347c : MOV dword ptr [ESI + 0x19c],EDI
00483482 : MOV EAX,dword ptr [ESI + 0x284]
00483488 : CMP EAX,EDI
0048348a : JZ 0x00483494
0048348c : MOV ECX,dword ptr [EAX]
0048348e : MOV EDX,dword ptr [ECX + 0x8]
00483491 : PUSH EAX
00483492 : CALL EDX
00483494 : MOV dword ptr [ESI + 0x284],EDI
0048349a : MOV EAX,dword ptr [ESI + 0x280]
004834a0 : CMP EAX,EDI
004834a2 : JZ 0x004834ac
004834a4 : MOV ECX,dword ptr [EAX]
004834a6 : MOV EDX,dword ptr [ECX + 0x8]
004834a9 : PUSH EAX
004834aa : CALL EDX
004834ac : MOV EAX,dword ptr [ESI + 0x284]
004834b2 : MOV dword ptr [ESI + 0x280],EAX
004834b8 : CMP EAX,EDI
004834ba : JZ 0x004834c4
004834bc : MOV ECX,dword ptr [EAX]
004834be : MOV EDX,dword ptr [ECX + 0x4]
004834c1 : PUSH EAX
004834c2 : CALL EDX
004834c4 : MOV EAX,dword ptr [ESI + 0x27c]
004834ca : CMP EAX,EDI
004834cc : JZ 0x004834d6
004834ce : MOV ECX,dword ptr [EAX]
004834d0 : MOV EDX,dword ptr [ECX + 0x8]
004834d3 : PUSH EAX
004834d4 : CALL EDX
004834d6 : MOV EAX,dword ptr [ESI + 0x280]
004834dc : MOV dword ptr [ESI + 0x27c],EAX
004834e2 : CMP EAX,EDI
004834e4 : JZ 0x004834ee
004834e6 : MOV ECX,dword ptr [EAX]
004834e8 : MOV EDX,dword ptr [ECX + 0x4]
004834eb : PUSH EAX
004834ec : CALL EDX
004834ee : MOV EAX,dword ptr [ESI + 0x278]
004834f4 : CMP EAX,EDI
004834f6 : JZ 0x00483500
004834f8 : MOV ECX,dword ptr [EAX]
004834fa : MOV EDX,dword ptr [ECX + 0x8]
004834fd : PUSH EAX
004834fe : CALL EDX
00483500 : MOV EAX,dword ptr [ESI + 0x27c]
00483506 : MOV dword ptr [ESI + 0x278],EAX
0048350c : MOV EAX,dword ptr [ESI + 0x274]
00483512 : CMP EAX,EDI
00483514 : JZ 0x0048351e
00483516 : MOV ECX,dword ptr [EAX]
00483518 : MOV EDX,dword ptr [ECX + 0x8]
0048351b : PUSH EAX
0048351c : CALL EDX
0048351e : MOV dword ptr [ESI + 0x274],EDI
00483524 : MOV EAX,dword ptr [ESI + 0x270]
0048352a : CMP EAX,EDI
0048352c : JZ 0x00483536
0048352e : MOV ECX,dword ptr [EAX]
00483530 : MOV EDX,dword ptr [ECX + 0x8]
00483533 : PUSH EAX
00483534 : CALL EDX
00483536 : MOV EAX,dword ptr [ESI + 0x274]
0048353c : MOV dword ptr [ESI + 0x270],EAX
00483542 : CMP EAX,EDI
00483544 : JZ 0x0048354e
00483546 : MOV ECX,dword ptr [EAX]
00483548 : MOV EDX,dword ptr [ECX + 0x4]
0048354b : PUSH EAX
0048354c : CALL EDX
0048354e : MOV EAX,dword ptr [ESI + 0x26c]
00483554 : CMP EAX,EDI
00483556 : JZ 0x00483560
00483558 : MOV ECX,dword ptr [EAX]
0048355a : MOV EDX,dword ptr [ECX + 0x8]
0048355d : PUSH EAX
0048355e : CALL EDX
00483560 : MOV EAX,dword ptr [ESI + 0x270]
00483566 : MOV dword ptr [ESI + 0x26c],EAX
0048356c : CMP EAX,EDI
0048356e : JZ 0x00483578
00483570 : MOV ECX,dword ptr [EAX]
00483572 : MOV EDX,dword ptr [ECX + 0x4]
00483575 : PUSH EAX
00483576 : CALL EDX
00483578 : MOV EAX,dword ptr [ESI + 0x268]
0048357e : CMP EAX,EDI
00483580 : JZ 0x0048358a
00483582 : MOV ECX,dword ptr [EAX]
00483584 : MOV EDX,dword ptr [ECX + 0x8]
00483587 : PUSH EAX
00483588 : CALL EDX
0048358a : MOV EAX,dword ptr [ESI + 0x26c]
00483590 : PUSH ESI
00483591 : MOV dword ptr [ESI + 0x268],EAX
00483597 : CALL 0x0047ff00
0048359c : MOV EAX,dword ptr [ESI + 0xf0]
004835a2 : MOV ECX,dword ptr [EAX]
004835a4 : MOV EDX,dword ptr [ECX + 0x8]
004835a7 : PUSH EAX
004835a8 : CALL EDX
004835aa : MOV dword ptr [ESI + 0xf0],EDI
004835b0 : MOV dword ptr [ESI + 0x258],EDI
004835b6 : MOV byte ptr [ESI + 0x8],0x0
004835ba : MOV AL,0x1
004835bc : MOV ECX,dword ptr [EBP + -0xc]
004835bf : MOV dword ptr FS:[0x0],ECX
004835c6 : POP ECX
004835c7 : POP EDI
004835c8 : POP ESI
004835c9 : POP EBX
004835ca : MOV ESP,EBP
004835cc : POP EBP
004835cd : RET

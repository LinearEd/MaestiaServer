PROGRAM  : Maestia.exe
FUNCTION : FUN_00a31470
ENTRY    : 00a31470
BODY     : [[00a31470, 00a315f9]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00a31470(void)

{
  int iVar1;
  int *piVar2;
  uint uVar3;
  undefined4 uVar4;
  undefined1 local_2c [28];
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4d098;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  iVar1 = *DAT_00da9894;
  if ((iVar1 != 0) && (*(int *)(iVar1 + 0x128) != 0)) {
    switch(*(undefined4 *)(*(int *)(iVar1 + 0x128) + 0x5c)) {
    case 1:
      ExceptionList = &local_10;
      FUN_00406460(L"IDS_ZONE_UPGRADE_CANCEL");
      local_8 = 0;
      piVar2 = *(int **)(*DAT_00da9894 + 0x1a8);
      uVar4 = FUN_0081d120(local_2c);
      local_8._0_1_ = 1;
      (**(code **)(*piVar2 + 0x44))(uVar4,3);
      local_8 = (uint)local_8._1_3_ << 8;
      FUN_00406560();
      local_8 = 0xffffffff;
      FUN_00406560();
      FUN_0097fca0(*(undefined4 *)(*DAT_00da9894 + 0x128));
      ExceptionList = local_10;
      return 1;
    case 2:
    case 3:
    case 5:
    case 6:
    case 0xd:
      ExceptionList = &local_10;
      FUN_0097fca0(*(undefined4 *)(iVar1 + 0x128));
      FUN_0097fa60();
      ExceptionList = local_10;
      return 1;
    case 4:
      return 1;
    case 7:
    case 8:
      ExceptionList = &local_10;
      if (*(int *)(iVar1 + 0x290) != 0) {
        *(undefined4 *)(*(int *)(iVar1 + 0x290) + 0x80) = 0;
        FUN_0094b9b0(uVar3);
      }
      FUN_0097fca0(*(undefined4 *)(*DAT_00da9894 + 0x128));
      FUN_0097fa60();
      ExceptionList = local_10;
      return 1;
    }
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00a31470 : PUSH EBP
00a31471 : MOV EBP,ESP
00a31473 : PUSH -0x1
00a31475 : PUSH 0xb4d098
00a3147a : MOV EAX,FS:[0x0]
00a31480 : PUSH EAX
00a31481 : SUB ESP,0x38
00a31484 : PUSH ESI
00a31485 : PUSH EDI
00a31486 : MOV EAX,[0x00d66fa0]
00a3148b : XOR EAX,EBP
00a3148d : PUSH EAX
00a3148e : LEA EAX,[EBP + -0xc]
00a31491 : MOV FS:[0x0],EAX
00a31497 : MOV EDX,dword ptr [0x00da9894]
00a3149d : MOV EAX,dword ptr [EDX]
00a3149f : TEST EAX,EAX
00a314a1 : JZ 0x00a315e7
00a314a7 : CMP dword ptr [EAX + 0x128],0x0
00a314ae : JZ 0x00a315e7
00a314b4 : MOV ECX,dword ptr [EAX + 0x128]
00a314ba : MOV ECX,dword ptr [ECX + 0x5c]
00a314bd : DEC ECX
00a314be : CMP ECX,0xc
00a314c1 : JA 0x00a315e7
00a314c7 : MOVZX ECX,byte ptr [ECX + 0xa31610]
00a314ce : JMP dword ptr [ECX*0x4 + 0xa315fc]
00a314d5 : PUSH 0xcc42c0
00a314da : LEA ECX,[EBP + -0x28]
00a314dd : CALL 0x00406460
00a314e2 : MOV dword ptr [EBP + -0x4],0x0
00a314e9 : MOV EDX,dword ptr [0x00da9894]
00a314ef : MOV EAX,dword ptr [EDX]
00a314f1 : MOV ESI,dword ptr [EAX + 0x1a8]
00a314f7 : MOV ECX,dword ptr [0x0172491c]
00a314fd : LEA EAX,[EBP + -0x28]
00a31500 : PUSH EAX
00a31501 : LEA EDI,[EBP + -0x44]
00a31504 : CALL 0x0081d120
00a31509 : MOV byte ptr [EBP + -0x4],0x1
00a3150d : MOV EDX,dword ptr [ESI]
00a3150f : PUSH 0x3
00a31511 : PUSH EAX
00a31512 : MOV EAX,dword ptr [EDX + 0x44]
00a31515 : MOV ECX,ESI
00a31517 : CALL EAX
00a31519 : MOV byte ptr [EBP + -0x4],0x0
00a3151d : MOV ECX,EDI
00a3151f : CALL 0x00406560
00a31524 : MOV dword ptr [EBP + -0x4],0xffffffff
00a3152b : LEA ECX,[EBP + -0x28]
00a3152e : CALL 0x00406560
00a31533 : MOV ECX,dword ptr [0x00da9894]
00a31539 : MOV EDX,dword ptr [ECX]
00a3153b : MOV EAX,dword ptr [EDX + 0x128]
00a31541 : PUSH EAX
00a31542 : CALL 0x0097fca0
00a31547 : MOV AL,0x1
00a31549 : MOV ECX,dword ptr [EBP + -0xc]
00a3154c : MOV dword ptr FS:[0x0],ECX
00a31553 : POP ECX
00a31554 : POP EDI
00a31555 : POP ESI
00a31556 : MOV ESP,EBP
00a31558 : POP EBP
00a31559 : RET
00a3155a : MOV ECX,dword ptr [EAX + 0x128]
00a31560 : PUSH ECX
00a31561 : CALL 0x0097fca0
00a31566 : MOV EDX,dword ptr [0x00da9894]
00a3156c : MOV EAX,dword ptr [EDX]
00a3156e : MOV ECX,dword ptr [EAX + 0x128]
00a31574 : CALL 0x0097fa60
00a31579 : MOV AL,0x1
00a3157b : MOV ECX,dword ptr [EBP + -0xc]
00a3157e : MOV dword ptr FS:[0x0],ECX
00a31585 : POP ECX
00a31586 : POP EDI
00a31587 : POP ESI
00a31588 : MOV ESP,EBP
00a3158a : POP EBP
00a3158b : RET
00a3158c : MOV EAX,dword ptr [EAX + 0x290]
00a31592 : TEST EAX,EAX
00a31594 : JZ 0x00a315b3
00a31596 : MOV dword ptr [EAX + 0x80],0x0
00a315a0 : MOV ECX,dword ptr [EDX]
00a315a2 : MOV ESI,dword ptr [ECX + 0x290]
00a315a8 : CALL 0x0094b9b0
00a315ad : MOV EDX,dword ptr [0x00da9894]
00a315b3 : MOV EDX,dword ptr [EDX]
00a315b5 : MOV EAX,dword ptr [EDX + 0x128]
00a315bb : PUSH EAX
00a315bc : CALL 0x0097fca0
00a315c1 : MOV ECX,dword ptr [0x00da9894]
00a315c7 : MOV EDX,dword ptr [ECX]
00a315c9 : MOV ECX,dword ptr [EDX + 0x128]
00a315cf : CALL 0x0097fa60
00a315d4 : MOV AL,0x1
00a315d6 : MOV ECX,dword ptr [EBP + -0xc]
00a315d9 : MOV dword ptr FS:[0x0],ECX
00a315e0 : POP ECX
00a315e1 : POP EDI
00a315e2 : POP ESI
00a315e3 : MOV ESP,EBP
00a315e5 : POP EBP
00a315e6 : RET
00a315e7 : XOR AL,AL
00a315e9 : MOV ECX,dword ptr [EBP + -0xc]
00a315ec : MOV dword ptr FS:[0x0],ECX
00a315f3 : POP ECX
00a315f4 : POP EDI
00a315f5 : POP ESI
00a315f6 : MOV ESP,EBP
00a315f8 : POP EBP
00a315f9 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_007386d0
ENTRY    : 007386d0
BODY     : [[007386d0, 00738746] [00738751, 007387d9]]

============================================================
DECOMPILED C CODE
============================================================

undefined1 FUN_007386d0(int param_1,undefined4 param_2,undefined4 param_3)

{
  uint uVar1;
  char cVar2;
  uint uVar3;
  int iVar4;
  byte bVar5;
  int in_ECX;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4f319;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  cVar2 = FUN_0073a210(param_1,param_2,param_3);
  if (cVar2 == '\0') {
    ExceptionList = local_10;
    return 0;
  }
  if (*(short *)(param_1 + 0xe6) != 0) {
    if (*(int *)(in_ECX + 0x304) != 0) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    uVar1 = (uint)*(ushort *)(param_1 + 0xe6) * 0x40;
    if (uVar1 < 0xfffffff0) {
      iVar4 = FUN_006f0760(uVar1 + 0x10,"",0,(DAT_01725270 >> 3 & 1) == 0,uVar3);
      if (iVar4 != 0) {
        bVar5 = 0x10 - ((byte)iVar4 & 0xf);
        iVar4 = iVar4 + (uint)bVar5;
        *(byte *)(iVar4 + -1) = bVar5;
      }
    }
    else {
      iVar4 = 0;
    }
    *(int *)(in_ECX + 0x304) = iVar4;
  }
  ExceptionList = local_10;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
007386d0 : PUSH EBP
007386d1 : MOV EBP,ESP
007386d3 : PUSH -0x1
007386d5 : PUSH 0xb4f319
007386da : MOV EAX,FS:[0x0]
007386e0 : PUSH EAX
007386e1 : PUSH ESI
007386e2 : PUSH EDI
007386e3 : MOV EAX,[0x00d66fa0]
007386e8 : XOR EAX,EBP
007386ea : PUSH EAX
007386eb : LEA EAX,[EBP + -0xc]
007386ee : MOV FS:[0x0],EAX
007386f4 : MOV EDI,ECX
007386f6 : MOV EAX,dword ptr [EBP + 0x10]
007386f9 : MOV ECX,dword ptr [EBP + 0xc]
007386fc : MOV ESI,dword ptr [EBP + 0x8]
007386ff : PUSH EAX
00738700 : PUSH ECX
00738701 : PUSH ESI
00738702 : MOV ECX,EDI
00738704 : CALL 0x0073a210
00738709 : TEST AL,AL
0073870b : JNZ 0x00738720
0073870d : MOV ECX,dword ptr [EBP + -0xc]
00738710 : MOV dword ptr FS:[0x0],ECX
00738717 : POP ECX
00738718 : POP EDI
00738719 : POP ESI
0073871a : MOV ESP,EBP
0073871c : POP EBP
0073871d : RET 0xc
00738720 : MOVZX EAX,word ptr [ESI + 0xe6]
00738727 : TEST AX,AX
0073872a : JBE 0x007387c5
00738730 : MOV EAX,dword ptr [EDI + 0x304]
00738736 : TEST EAX,EAX
00738738 : JZ 0x00738751
0073873a : MOVZX EDX,byte ptr [EAX + -0x1]
0073873e : SUB EAX,EDX
00738740 : MOV ECX,EAX
00738742 : CALL 0x006f04e0
00738751 : MOVZX EAX,word ptr [ESI + 0xe6]
00738758 : XOR ECX,ECX
0073875a : MOV EDX,0x40
0073875f : MUL EDX
00738761 : SETO CL
00738764 : NEG ECX
00738766 : OR EAX,ECX
00738768 : CMP EAX,-0x11
0073876b : JBE 0x00738771
0073876d : XOR EAX,EAX
0073876f : JMP 0x007387ae
00738771 : MOV ECX,dword ptr [0x01725270]
00738777 : SHR ECX,0x3
0073877a : MOV EDX,0x0
0073877f : AND ECX,0x1
00738782 : SETZ DL
00738785 : ADD EAX,0x10
00738788 : PUSH EDX
00738789 : PUSH 0x0
0073878b : PUSH 0xbf1a4b
00738790 : PUSH EAX
00738791 : CALL 0x006f0760
00738796 : ADD ESP,0x10
00738799 : TEST EAX,EAX
0073879b : JZ 0x007387ae
0073879d : MOV DL,AL
0073879f : AND DL,0xf
007387a2 : MOV CL,0x10
007387a4 : SUB CL,DL
007387a6 : MOVZX EDX,CL
007387a9 : ADD EAX,EDX
007387ab : MOV byte ptr [EAX + -0x1],CL
007387ae : MOV dword ptr [EBP + 0x10],EAX
007387b1 : MOV dword ptr [EBP + -0x4],0x0
007387b8 : MOV dword ptr [EBP + -0x4],0xffffffff
007387bf : MOV dword ptr [EDI + 0x304],EAX
007387c5 : MOV AL,0x1
007387c7 : MOV ECX,dword ptr [EBP + -0xc]
007387ca : MOV dword ptr FS:[0x0],ECX
007387d1 : POP ECX
007387d2 : POP EDI
007387d3 : POP ESI
007387d4 : MOV ESP,EBP
007387d6 : POP EBP
007387d7 : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_007d5010
ENTRY    : 007d5010
BODY     : [[007d5010, 007d5179]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007d5010(undefined4 param_1,undefined4 param_2)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int *piVar3;
  uint uVar4;
  int iVar5;
  int in_ECX;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b0f27a;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *(undefined1 *)(in_ECX + 0x255) = (undefined1)param_1;
  *(undefined2 *)(in_ECX + 0x256) = (undefined2)param_2;
  if (*(int *)(in_ECX + 8) != 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  local_8 = 0;
  puVar1 = *(undefined4 **)(in_ECX + 0x38);
  for (puVar2 = (undefined4 *)*puVar1; puVar2 != puVar1; puVar2 = (undefined4 *)*puVar2) {
    piVar3 = (int *)puVar2[9];
    iVar5 = (**(code **)(*piVar3 + 0x1c))(uVar4);
    if (iVar5 - 2U < 8) {
      (**(code **)(*piVar3 + 0x114))(param_1,param_2);
    }
    else {
      iVar5 = (**(code **)(*piVar3 + 0x1c))();
      if (iVar5 == 1) {
        FUN_0078d220(param_1,param_2);
      }
    }
  }
  local_8 = 0xffffffff;
  if (*(int *)(in_ECX + 8) != 0) {
    LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  if (*(int *)(in_ECX + 8) != 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  local_8 = 1;
  puVar1 = *(undefined4 **)(in_ECX + 0x188);
  for (puVar2 = (undefined4 *)*puVar1; puVar2 != puVar1; puVar2 = (undefined4 *)*puVar2) {
    (**(code **)(*(int *)puVar2[9] + 100))(param_1,param_2);
  }
  local_8 = 0xffffffff;
  if (*(int *)(in_ECX + 8) != 0) {
    LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  if (*(int **)(in_ECX + 0x2b4) != (int *)0x0) {
    (**(code **)(**(int **)(in_ECX + 0x2b4) + 100))(param_1,param_2);
  }
  if (*(int **)(in_ECX + 0x2b8) != (int *)0x0) {
    (**(code **)(**(int **)(in_ECX + 0x2b8) + 100))(param_1,param_2);
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
007d5010 : PUSH EBP
007d5011 : MOV EBP,ESP
007d5013 : PUSH -0x1
007d5015 : PUSH 0xb0f27a
007d501a : MOV EAX,FS:[0x0]
007d5020 : PUSH EAX
007d5021 : SUB ESP,0x8
007d5024 : PUSH EBX
007d5025 : PUSH ESI
007d5026 : PUSH EDI
007d5027 : MOV EAX,[0x00d66fa0]
007d502c : XOR EAX,EBP
007d502e : PUSH EAX
007d502f : LEA EAX,[EBP + -0xc]
007d5032 : MOV FS:[0x0],EAX
007d5038 : MOV EDI,ECX
007d503a : MOV AL,byte ptr [EBP + 0x8]
007d503d : MOV CX,word ptr [EBP + 0xc]
007d5041 : MOV byte ptr [EDI + 0x255],AL
007d5047 : MOV word ptr [EDI + 0x256],CX
007d504e : MOV EAX,dword ptr [EDI + 0x8]
007d5051 : MOV dword ptr [EBP + -0x14],EDI
007d5054 : TEST EAX,EAX
007d5056 : JZ 0x007d5062
007d5058 : ADD EAX,0x4
007d505b : PUSH EAX
007d505c : CALL dword ptr [0x00b85118]
007d5062 : MOV dword ptr [EBP + -0x4],0x0
007d5069 : MOV EAX,dword ptr [EDI + 0x38]
007d506c : MOV EBX,dword ptr [EAX]
007d506e : MOV dword ptr [EBP + -0x10],EAX
007d5071 : CMP EBX,EAX
007d5073 : JZ 0x007d50c3
007d5075 : MOV ESI,dword ptr [EBX + 0x24]
007d5078 : MOV EDX,dword ptr [ESI]
007d507a : MOV EAX,dword ptr [EDX + 0x1c]
007d507d : MOV ECX,ESI
007d507f : CALL EAX
007d5081 : ADD EAX,-0x2
007d5084 : CMP EAX,0x7
007d5087 : JA 0x007d509f
007d5089 : MOV EAX,dword ptr [EBP + 0xc]
007d508c : MOV ECX,dword ptr [EBP + 0x8]
007d508f : MOV EDX,dword ptr [ESI]
007d5091 : MOV EDX,dword ptr [EDX + 0x114]
007d5097 : PUSH EAX
007d5098 : PUSH ECX
007d5099 : MOV ECX,ESI
007d509b : CALL EDX
007d509d : JMP 0x007d50bc
007d509f : MOV EAX,dword ptr [ESI]
007d50a1 : MOV EDX,dword ptr [EAX + 0x1c]
007d50a4 : MOV ECX,ESI
007d50a6 : CALL EDX
007d50a8 : CMP EAX,0x1
007d50ab : JNZ 0x007d50bc
007d50ad : MOV EAX,dword ptr [EBP + 0xc]
007d50b0 : MOV ECX,dword ptr [EBP + 0x8]
007d50b3 : PUSH EAX
007d50b4 : PUSH ECX
007d50b5 : MOV ECX,ESI
007d50b7 : CALL 0x0078d220
007d50bc : MOV EBX,dword ptr [EBX]
007d50be : CMP EBX,dword ptr [EBP + -0x10]
007d50c1 : JNZ 0x007d5075
007d50c3 : MOV dword ptr [EBP + -0x4],0xffffffff
007d50ca : MOV EAX,dword ptr [EDI + 0x8]
007d50cd : TEST EAX,EAX
007d50cf : JZ 0x007d50db
007d50d1 : ADD EAX,0x4
007d50d4 : PUSH EAX
007d50d5 : CALL dword ptr [0x00b8511c]
007d50db : MOV EAX,dword ptr [EDI + 0x8]
007d50de : MOV dword ptr [EBP + -0x14],EDI
007d50e1 : TEST EAX,EAX
007d50e3 : JZ 0x007d50ef
007d50e5 : ADD EAX,0x4
007d50e8 : PUSH EAX
007d50e9 : CALL dword ptr [0x00b85118]
007d50ef : MOV dword ptr [EBP + -0x4],0x1
007d50f6 : MOV EBX,dword ptr [EDI + 0x188]
007d50fc : MOV ESI,dword ptr [EBX]
007d50fe : CMP ESI,EBX
007d5100 : JZ 0x007d511a
007d5102 : MOV EAX,dword ptr [EBP + 0xc]
007d5105 : MOV ECX,dword ptr [ESI + 0x24]
007d5108 : MOV EDX,dword ptr [ECX]
007d510a : MOV EDX,dword ptr [EDX + 0x64]
007d510d : PUSH EAX
007d510e : MOV EAX,dword ptr [EBP + 0x8]
007d5111 : PUSH EAX
007d5112 : CALL EDX
007d5114 : MOV ESI,dword ptr [ESI]
007d5116 : CMP ESI,EBX
007d5118 : JNZ 0x007d5102
007d511a : MOV dword ptr [EBP + -0x4],0xffffffff
007d5121 : MOV EAX,dword ptr [EDI + 0x8]
007d5124 : TEST EAX,EAX
007d5126 : JZ 0x007d5132
007d5128 : ADD EAX,0x4
007d512b : PUSH EAX
007d512c : CALL dword ptr [0x00b8511c]
007d5132 : MOV ECX,dword ptr [EDI + 0x2b4]
007d5138 : TEST ECX,ECX
007d513a : JZ 0x007d514b
007d513c : MOV EDX,dword ptr [EBP + 0xc]
007d513f : MOV EAX,dword ptr [ECX]
007d5141 : MOV EAX,dword ptr [EAX + 0x64]
007d5144 : PUSH EDX
007d5145 : MOV EDX,dword ptr [EBP + 0x8]
007d5148 : PUSH EDX
007d5149 : CALL EAX
007d514b : MOV EDI,dword ptr [EDI + 0x2b8]
007d5151 : TEST EDI,EDI
007d5153 : JZ 0x007d5166
007d5155 : MOV EAX,dword ptr [EBP + 0xc]
007d5158 : MOV ECX,dword ptr [EBP + 0x8]
007d515b : MOV EDX,dword ptr [EDI]
007d515d : MOV EDX,dword ptr [EDX + 0x64]
007d5160 : PUSH EAX
007d5161 : PUSH ECX
007d5162 : MOV ECX,EDI
007d5164 : CALL EDX
007d5166 : MOV ECX,dword ptr [EBP + -0xc]
007d5169 : MOV dword ptr FS:[0x0],ECX
007d5170 : POP ECX
007d5171 : POP EDI
007d5172 : POP ESI
007d5173 : POP EBX
007d5174 : MOV ESP,EBP
007d5176 : POP EBP
007d5177 : RET 0x8

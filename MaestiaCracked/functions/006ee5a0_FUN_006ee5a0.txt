PROGRAM  : Maestia.exe
FUNCTION : FUN_006ee5a0
ENTRY    : 006ee5a0
BODY     : [[006ee5a0, 006ee7ae]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 FUN_006ee5a0(ushort *param_1,int *param_2)

{
  byte bVar1;
  ushort uVar2;
  ushort uVar3;
  ushort uVar4;
  int iVar5;
  int iVar6;
  uint uVar7;
  uint uVar8;
  bool bVar9;
  longlong lVar10;
  uint local_14;
  int local_10;
  
  if ((param_1 == (ushort *)0x0) || (param_2 == (int *)0x0)) {
    return 4;
  }
  uVar2 = param_1[3];
  if (uVar2 == 0) {
    _DAT_01720ee8 = _DAT_01720ee8 + 1;
    return 1;
  }
  uVar3 = param_1[1];
  if ((uVar3 == 0) || (0xc < uVar3)) {
    _DAT_01720ee8 = _DAT_01720ee8 + 1000;
    return 2;
  }
  uVar4 = *param_1;
  iVar5 = FUN_006ee560();
  if ((iVar5 == 0) && ((byte)(&DAT_00d69127)[uVar3] < uVar2)) {
    _DAT_01720ee8 = _DAT_01720ee8 + 10;
    return 1;
  }
  if ((iVar5 != 0) && ((byte)(&DAT_00d69133)[uVar3] < uVar2)) {
    _DAT_01720ee8 = _DAT_01720ee8 + 100;
    return 1;
  }
  if (0x63f < uVar4) {
    uVar7 = 0x640;
    iVar5 = 0;
    local_14 = 0;
    local_10 = 0;
    if (0x640 < uVar4) {
      do {
        iVar6 = FUN_006ee560();
        if (iVar6 == 0) {
          bVar9 = 0xfffffe92 < local_14;
          local_14 = local_14 + 0x16d;
        }
        else {
          bVar9 = 0xfffffe91 < local_14;
          local_14 = local_14 + 0x16e;
        }
        local_10 = local_10 + (uint)bVar9;
        bVar9 = 0xfffffffe < uVar7;
        uVar7 = uVar7 + 1;
        iVar5 = iVar5 + (uint)bVar9;
      } while ((iVar5 < 0) || ((iVar5 < 1 && (uVar7 < uVar4))));
    }
    uVar3 = param_1[1];
    iVar5 = 0;
    uVar7 = 1;
    if (1 < uVar3) {
      iVar6 = FUN_006ee560();
      do {
        if (((iVar6 == 0) || (uVar7 != 2)) || (bVar1 = DAT_00d69135, iVar5 != 0)) {
          bVar1 = (&DAT_00d69127)[uVar7];
        }
        bVar9 = CARRY4(local_14,(uint)bVar1);
        local_14 = local_14 + bVar1;
        local_10 = local_10 + (uint)bVar9;
        bVar9 = 0xfffffffe < uVar7;
        uVar7 = uVar7 + 1;
        iVar5 = iVar5 + (uint)bVar9;
      } while ((iVar5 < 0) || ((iVar5 < 1 && (uVar7 < uVar3))));
    }
    uVar7 = uVar2 - 1;
    lVar10 = __allmul(uVar7 + local_14,
                      ((int)uVar7 >> 0x1f) + local_10 + (uint)CARRY4(uVar7,local_14),86400000,0);
    lVar10 = lVar10 + (int)((uint)param_1[4] * 3600000) + (longlong)(int)((uint)param_1[5] * 60000);
    uVar7 = (uint)lVar10;
    uVar2 = param_1[6];
    uVar8 = uVar7 + (uint)uVar2 * 1000;
    uVar3 = param_1[7];
    *param_2 = uVar8 + uVar3;
    param_2[1] = (int)((ulonglong)lVar10 >> 0x20) + (uint)CARRY4(uVar7,(uint)uVar2 * 1000) +
                 (uint)CARRY4(uVar8,(uint)uVar3);
    return 0;
  }
  _DAT_01720ee8 = _DAT_01720ee8 + 10000;
  return 3;
}



============================================================
DISASSEMBLY
============================================================
006ee5a0 : PUSH EBP
006ee5a1 : MOV EBP,ESP
006ee5a3 : MOV EAX,dword ptr [EBP + 0x8]
006ee5a6 : SUB ESP,0x18
006ee5a9 : PUSH EBX
006ee5aa : PUSH ESI
006ee5ab : PUSH EDI
006ee5ac : TEST EAX,EAX
006ee5ae : JZ 0x006ee7a3
006ee5b4 : CMP dword ptr [EBP + 0xc],0x0
006ee5b8 : JZ 0x006ee7a3
006ee5be : MOVZX ECX,word ptr [EAX + 0x6]
006ee5c2 : XOR EDX,EDX
006ee5c4 : MOV dword ptr [EBP + -0x4],ECX
006ee5c7 : CMP DX,CX
006ee5ca : JNZ 0x006ee5de
006ee5cc : MOV EAX,0x1
006ee5d1 : ADD dword ptr [0x01720ee8],EAX
006ee5d7 : POP EDI
006ee5d8 : POP ESI
006ee5d9 : POP EBX
006ee5da : MOV ESP,EBP
006ee5dc : POP EBP
006ee5dd : RET
006ee5de : MOVZX EBX,word ptr [EAX + 0x2]
006ee5e2 : XOR ECX,ECX
006ee5e4 : CMP CX,BX
006ee5e7 : JZ 0x006ee78d
006ee5ed : MOV EDX,0xc
006ee5f2 : CMP DX,BX
006ee5f5 : JC 0x006ee78d
006ee5fb : MOVZX ESI,word ptr [EAX]
006ee5fe : MOVZX EDI,SI
006ee601 : MOV ECX,EDI
006ee603 : CALL 0x006ee560
006ee608 : TEST EAX,EAX
006ee60a : JNZ 0x006ee630
006ee60c : MOVZX ECX,BX
006ee60f : MOVZX DX,byte ptr [ECX + 0xd69127]
006ee617 : CMP word ptr [EBP + -0x4],DX
006ee61b : JBE 0x006ee630
006ee61d : ADD dword ptr [0x01720ee8],0xa
006ee624 : MOV EAX,0x1
006ee629 : POP EDI
006ee62a : POP ESI
006ee62b : POP EBX
006ee62c : MOV ESP,EBP
006ee62e : POP EBP
006ee62f : RET
006ee630 : XOR ECX,ECX
006ee632 : CMP EAX,ECX
006ee634 : JZ 0x006ee658
006ee636 : MOVZX EAX,BX
006ee639 : MOVZX DX,byte ptr [EAX + 0xd69133]
006ee641 : CMP word ptr [EBP + -0x4],DX
006ee645 : JBE 0x006ee658
006ee647 : ADD dword ptr [0x01720ee8],0x64
006ee64e : LEA EAX,[ECX + 0x1]
006ee651 : POP EDI
006ee652 : POP ESI
006ee653 : POP EBX
006ee654 : MOV ESP,EBP
006ee656 : POP EBP
006ee657 : RET
006ee658 : MOV EAX,0x640
006ee65d : CMP AX,SI
006ee660 : JBE 0x006ee678
006ee662 : ADD dword ptr [0x01720ee8],0x2710
006ee66c : MOV EAX,0x3
006ee671 : POP EDI
006ee672 : POP ESI
006ee673 : POP EBX
006ee674 : MOV ESP,EBP
006ee676 : POP EBP
006ee677 : RET
006ee678 : MOV EBX,EAX
006ee67a : MOV EAX,EDI
006ee67c : CDQ
006ee67d : XOR ESI,ESI
006ee67f : MOV EDI,EDX
006ee681 : CMP ESI,EDI
006ee683 : MOV dword ptr [EBP + -0x10],ECX
006ee686 : MOV dword ptr [EBP + -0xc],ECX
006ee689 : MOV dword ptr [EBP + -0x18],EAX
006ee68c : JG 0x006ee6c4
006ee68e : JL 0x006ee694
006ee690 : CMP EBX,EAX
006ee692 : JNC 0x006ee6c4
006ee694 : MOV ECX,EBX
006ee696 : CALL 0x006ee560
006ee69b : TEST EAX,EAX
006ee69d : JZ 0x006ee6a8
006ee69f : ADD dword ptr [EBP + -0x10],0x16e
006ee6a6 : JMP 0x006ee6af
006ee6a8 : ADD dword ptr [EBP + -0x10],0x16d
006ee6af : ADC dword ptr [EBP + -0xc],0x0
006ee6b3 : ADD EBX,0x1
006ee6b6 : ADC ESI,0x0
006ee6b9 : CMP ESI,EDI
006ee6bb : JL 0x006ee694
006ee6bd : JG 0x006ee6c4
006ee6bf : CMP EBX,dword ptr [EBP + -0x18]
006ee6c2 : JC 0x006ee694
006ee6c4 : MOV ECX,dword ptr [EBP + 0x8]
006ee6c7 : MOVZX EAX,word ptr [ECX + 0x2]
006ee6cb : CDQ
006ee6cc : XOR EDI,EDI
006ee6ce : CMP EDI,EDX
006ee6d0 : MOV ESI,0x1
006ee6d5 : MOV dword ptr [EBP + -0x18],EAX
006ee6d8 : MOV dword ptr [EBP + -0x14],EDX
006ee6db : JG 0x006ee725
006ee6dd : JL 0x006ee6e3
006ee6df : CMP ESI,EAX
006ee6e1 : JNC 0x006ee725
006ee6e3 : MOV ECX,EBX
006ee6e5 : CALL 0x006ee560
006ee6ea : MOV CL,byte ptr [0x00d69135]
006ee6f0 : MOV dword ptr [EBP + -0x8],EAX
006ee6f3 : CMP dword ptr [EBP + -0x8],0x0
006ee6f7 : JZ 0x006ee705
006ee6f9 : CMP ESI,0x2
006ee6fc : JNZ 0x006ee705
006ee6fe : MOVZX EAX,CL
006ee701 : TEST EDI,EDI
006ee703 : JZ 0x006ee70c
006ee705 : MOVZX EAX,byte ptr [ESI + 0xd69127]
006ee70c : CDQ
006ee70d : ADD dword ptr [EBP + -0x10],EAX
006ee710 : ADC dword ptr [EBP + -0xc],EDX
006ee713 : ADD ESI,0x1
006ee716 : ADC EDI,0x0
006ee719 : CMP EDI,dword ptr [EBP + -0x14]
006ee71c : JL 0x006ee6f3
006ee71e : JG 0x006ee725
006ee720 : CMP ESI,dword ptr [EBP + -0x18]
006ee723 : JC 0x006ee6f3
006ee725 : MOVZX EAX,word ptr [EBP + -0x4]
006ee729 : DEC EAX
006ee72a : CDQ
006ee72b : ADD EAX,dword ptr [EBP + -0x10]
006ee72e : PUSH 0x0
006ee730 : ADC EDX,dword ptr [EBP + -0xc]
006ee733 : PUSH 0x5265c00
006ee738 : PUSH EDX
006ee739 : PUSH EAX
006ee73a : CALL 0x0063c720
006ee73f : MOV ECX,dword ptr [EBP + 0x8]
006ee742 : MOV ESI,EAX
006ee744 : MOVZX EAX,word ptr [ECX + 0x8]
006ee748 : IMUL EAX,EAX,0x36ee80
006ee74e : MOV EDI,EDX
006ee750 : CDQ
006ee751 : ADD ESI,EAX
006ee753 : MOVZX EAX,word ptr [ECX + 0xa]
006ee757 : ADC EDI,EDX
006ee759 : IMUL EAX,EAX,0xea60
006ee75f : CDQ
006ee760 : ADD ESI,EAX
006ee762 : MOVZX EAX,word ptr [ECX + 0xc]
006ee766 : ADC EDI,EDX
006ee768 : IMUL EAX,EAX,0x3e8
006ee76e : CDQ
006ee76f : ADD ESI,EAX
006ee771 : MOVZX EAX,word ptr [ECX + 0xe]
006ee775 : ADC EDI,EDX
006ee777 : CDQ
006ee778 : ADD ESI,EAX
006ee77a : MOV EAX,dword ptr [EBP + 0xc]
006ee77d : ADC EDI,EDX
006ee77f : MOV dword ptr [EAX],ESI
006ee781 : MOV dword ptr [EAX + 0x4],EDI
006ee784 : XOR EAX,EAX
006ee786 : POP EDI
006ee787 : POP ESI
006ee788 : POP EBX
006ee789 : MOV ESP,EBP
006ee78b : POP EBP
006ee78c : RET
006ee78d : ADD dword ptr [0x01720ee8],0x3e8
006ee797 : MOV EAX,0x2
006ee79c : POP EDI
006ee79d : POP ESI
006ee79e : POP EBX
006ee79f : MOV ESP,EBP
006ee7a1 : POP EBP
006ee7a2 : RET
006ee7a3 : POP EDI
006ee7a4 : POP ESI
006ee7a5 : MOV EAX,0x4
006ee7aa : POP EBX
006ee7ab : MOV ESP,EBP
006ee7ad : POP EBP
006ee7ae : RET

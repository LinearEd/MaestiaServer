PROGRAM  : Maestia.exe
FUNCTION : FUN_0068b9b0
ENTRY    : 0068b9b0
BODY     : [[0068b9b0, 0068bb59] [0068bb60, 0068bc8d]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_0068b9b0(undefined4 *param_1,int *param_2,int param_3,int param_4)

{
  byte bVar1;
  byte bVar2;
  int iVar3;
  int iVar4;
  byte *pbVar5;
  int iVar6;
  byte *pbVar7;
  int iVar8;
  int local_3c;
  int local_34;
  int local_30;
  int local_2c;
  int local_28;
  int local_24;
  int local_20;
  int local_18;
  int local_14;
  int local_10;
  int local_c;
  int local_8;
  int local_4;
  
  if (param_1 == (undefined4 *)0x0) {
    return 0x21;
  }
  if ((param_2 == (int *)0x0) || (param_2[3] == 0)) {
    return 6;
  }
  local_3c = param_3 + 0x20 >> 6;
  local_34 = param_4 + 0x20 >> 6;
  if (local_3c == 0) {
    if (local_34 == 0) {
      return 0;
    }
  }
  else if (local_3c < 0) {
    return 6;
  }
  if (local_34 < 0) {
    return 6;
  }
  switch(*(char *)((int)param_2 + 0x12)) {
  case '\x01':
    if (8 < local_3c) {
      local_3c = 8;
    }
    break;
  case '\x03':
  case '\x04':
    if (*(char *)((int)param_2 + 0x12) == '\x03') {
      iVar3 = param_2[1] + 3 + local_3c;
      iVar3 = (int)(iVar3 + (iVar3 >> 0x1f & 3U)) >> 2;
    }
    else {
      iVar3 = (param_2[1] + 1 + local_3c) / 2;
    }
    FUN_0068b3b0(&local_18);
    iVar3 = FUN_0068b5f0(param_1,param_2,&local_18,iVar3);
    if (iVar3 != 0) {
      return iVar3;
    }
    FUN_0068b940(param_1,param_2);
    *param_2 = local_18;
    param_2[1] = local_14;
    param_2[2] = local_10;
    param_2[3] = local_c;
    param_2[4] = local_8;
    param_2[5] = local_4;
    break;
  case '\x05':
    local_3c = local_3c * 3;
    break;
  case '\x06':
    local_34 = local_34 * 3;
  }
  iVar3 = FUN_0068b3f0(*param_1,local_34);
  if (iVar3 == 0) {
    local_30 = param_2[2];
    if (local_30 < 1) {
      local_30 = -local_30;
      iVar3 = (*param_2 + -1) * local_30;
    }
    else {
      iVar3 = local_30 * local_34;
    }
    iVar3 = iVar3 + param_2[3];
    local_20 = 0;
    if (0 < *param_2) {
      do {
        local_2c = local_30 + -1;
        if (-1 < local_2c) {
          local_28 = 8 - local_2c;
          pbVar7 = (byte *)(local_2c + iVar3);
          do {
            bVar1 = *pbVar7;
            local_24 = 1;
            if (0 < local_3c) {
              pbVar5 = pbVar7 + (-1 - iVar3);
              do {
                if (*(char *)((int)param_2 + 0x12) == '\x01') {
                  bVar2 = bVar1 >> ((byte)local_24 & 0x1f) | *pbVar7;
                  *pbVar7 = bVar2;
                  if (0 < local_2c) {
                    *pbVar7 = pbVar7[-1] << ((char)local_28 + (char)pbVar5 & 0x1fU) | bVar2;
                  }
                }
                else {
                  if ((int)pbVar5 < 0) break;
                  if ((short)param_2[4] + -1 < (int)((uint)*pbVar7 + (uint)pbVar5[iVar3])) {
                    *pbVar7 = (char)param_2[4] - 1;
                    break;
                  }
                  bVar2 = *pbVar7 + pbVar5[iVar3];
                  *pbVar7 = bVar2;
                  if ((uint)bVar2 == (int)(short)param_2[4] - 1U) break;
                }
                local_24 = local_24 + 1;
                pbVar5 = pbVar5 + -1;
              } while (local_24 <= local_3c);
            }
            local_28 = local_28 + 1;
            local_2c = local_2c + -1;
            pbVar7 = pbVar7 + -1;
          } while (-1 < local_2c);
        }
        iVar6 = 1;
        if (0 < local_34) {
          do {
            pbVar7 = (byte *)(iVar3 - param_2[2] * iVar6);
            if (0 < local_30) {
              iVar4 = iVar3 - (int)pbVar7;
              iVar8 = local_30;
              do {
                *pbVar7 = *pbVar7 | pbVar7[iVar4];
                pbVar7 = pbVar7 + 1;
                iVar8 = iVar8 + -1;
              } while (iVar8 != 0);
            }
            iVar6 = iVar6 + 1;
          } while (iVar6 <= local_34);
        }
        iVar3 = iVar3 + param_2[2];
        local_20 = local_20 + 1;
      } while (local_20 < *param_2);
    }
    param_2[1] = param_2[1] + local_3c;
    *param_2 = *param_2 + local_34;
    iVar3 = 0;
  }
  return iVar3;
}



============================================================
DISASSEMBLY
============================================================
0068b9b0 : SUB ESP,0x3c
0068b9b3 : CMP dword ptr [ESP + 0x40],0x0
0068b9b8 : JNZ 0x0068b9c3
0068b9ba : MOV EAX,0x21
0068b9bf : ADD ESP,0x3c
0068b9c2 : RET
0068b9c3 : PUSH EDI
0068b9c4 : MOV EDI,dword ptr [ESP + 0x48]
0068b9c8 : TEST EDI,EDI
0068b9ca : JZ 0x0068bc84
0068b9d0 : CMP dword ptr [EDI + 0xc],0x0
0068b9d4 : JZ 0x0068bc84
0068b9da : PUSH EBX
0068b9db : MOV EBX,dword ptr [ESP + 0x50]
0068b9df : PUSH EBP
0068b9e0 : MOV EBP,dword ptr [ESP + 0x58]
0068b9e4 : ADD EBX,0x20
0068b9e7 : ADD EBP,0x20
0068b9ea : SAR EBX,0x6
0068b9ed : SAR EBP,0x6
0068b9f0 : MOV dword ptr [ESP + 0xc],EBX
0068b9f4 : MOV dword ptr [ESP + 0x14],EBP
0068b9f8 : TEST EBX,EBX
0068b9fa : JNZ 0x0068ba09
0068b9fc : TEST EBP,EBP
0068b9fe : JNZ 0x0068ba11
0068ba00 : POP EBP
0068ba01 : POP EBX
0068ba02 : XOR EAX,EAX
0068ba04 : POP EDI
0068ba05 : ADD ESP,0x3c
0068ba08 : RET
0068ba09 : JL 0x0068bc78
0068ba0f : TEST EBP,EBP
0068ba11 : JL 0x0068bc78
0068ba17 : MOV AL,byte ptr [EDI + 0x12]
0068ba1a : MOVSX ECX,AL
0068ba1d : DEC ECX
0068ba1e : PUSH ESI
0068ba1f : CMP ECX,0x5
0068ba22 : JA 0x0068bad8
0068ba28 : JMP dword ptr [ECX*0x4 + 0x68bc90]
0068ba2f : CMP AL,0x3
0068ba31 : JNZ 0x0068ba47
0068ba33 : MOV EAX,dword ptr [EDI + 0x4]
0068ba36 : LEA EAX,[EAX + EBX*0x1 + 0x3]
0068ba3a : CDQ
0068ba3b : AND EDX,0x3
0068ba3e : ADD EAX,EDX
0068ba40 : MOV ESI,EAX
0068ba42 : SAR ESI,0x2
0068ba45 : JMP 0x0068ba55
0068ba47 : MOV ECX,dword ptr [EDI + 0x4]
0068ba4a : LEA EAX,[ECX + EBX*0x1 + 0x1]
0068ba4e : CDQ
0068ba4f : SUB EAX,EDX
0068ba51 : MOV ESI,EAX
0068ba53 : SAR ESI,0x1
0068ba55 : LEA EDX,[ESP + 0x34]
0068ba59 : PUSH EDX
0068ba5a : CALL 0x0068b3b0
0068ba5f : PUSH ESI
0068ba60 : MOV ESI,dword ptr [ESP + 0x58]
0068ba64 : LEA EAX,[ESP + 0x3c]
0068ba68 : PUSH EAX
0068ba69 : PUSH EDI
0068ba6a : PUSH ESI
0068ba6b : CALL 0x0068b5f0
0068ba70 : ADD ESP,0x14
0068ba73 : TEST EAX,EAX
0068ba75 : JNZ 0x0068bc70
0068ba7b : PUSH EDI
0068ba7c : PUSH ESI
0068ba7d : CALL 0x0068b940
0068ba82 : MOV ECX,dword ptr [ESP + 0x3c]
0068ba86 : MOV EDX,dword ptr [ESP + 0x40]
0068ba8a : MOV EAX,dword ptr [ESP + 0x44]
0068ba8e : MOV dword ptr [EDI],ECX
0068ba90 : MOV ECX,dword ptr [ESP + 0x48]
0068ba94 : MOV dword ptr [EDI + 0x4],EDX
0068ba97 : MOV EDX,dword ptr [ESP + 0x4c]
0068ba9b : MOV dword ptr [EDI + 0x8],EAX
0068ba9e : MOV EAX,dword ptr [ESP + 0x50]
0068baa2 : MOV dword ptr [EDI + 0xc],ECX
0068baa5 : MOV dword ptr [EDI + 0x10],EDX
0068baa8 : ADD ESP,0x8
0068baab : MOV dword ptr [EDI + 0x14],EAX
0068baae : JMP 0x0068bad8
0068bab0 : CMP EBX,0x8
0068bab3 : JLE 0x0068bad8
0068bab5 : MOV dword ptr [ESP + 0x10],0x8
0068babd : MOV EBX,dword ptr [ESP + 0x10]
0068bac1 : JMP 0x0068bad8
0068bac3 : LEA ECX,[EBX + EBX*0x2]
0068bac6 : MOV dword ptr [ESP + 0x10],ECX
0068baca : MOV EBX,ECX
0068bacc : JMP 0x0068bad8
0068bace : LEA EDX,[EBP + EBP*0x2]
0068bad2 : MOV dword ptr [ESP + 0x18],EDX
0068bad6 : MOV EBP,EDX
0068bad8 : MOV EAX,dword ptr [ESP + 0x50]
0068badc : MOV ECX,dword ptr [EAX]
0068bade : PUSH EBP
0068badf : PUSH ECX
0068bae0 : MOV ECX,EBX
0068bae2 : MOV EAX,EDI
0068bae4 : CALL 0x0068b3f0
0068bae9 : ADD ESP,0x8
0068baec : TEST EAX,EAX
0068baee : JNZ 0x0068bc70
0068baf4 : MOV EBX,dword ptr [EDI + 0x8]
0068baf7 : MOV dword ptr [ESP + 0x1c],EBX
0068bafb : TEST EBX,EBX
0068bafd : JLE 0x0068bb04
0068baff : IMUL EBX,EBP
0068bb02 : JMP 0x0068bb12
0068bb04 : NEG EBX
0068bb06 : MOV EAX,EBX
0068bb08 : MOV EBX,dword ptr [EDI]
0068bb0a : DEC EBX
0068bb0b : MOV dword ptr [ESP + 0x1c],EAX
0068bb0f : IMUL EBX,EAX
0068bb12 : ADD EBX,dword ptr [EDI + 0xc]
0068bb15 : CMP dword ptr [EDI],0x0
0068bb18 : MOV dword ptr [ESP + 0x14],EBX
0068bb1c : MOV dword ptr [ESP + 0x2c],0x0
0068bb24 : JLE 0x0068bc65
0068bb2a : MOV EDX,0x1
0068bb2f : NOP
0068bb30 : MOV EAX,dword ptr [ESP + 0x1c]
0068bb34 : DEC EAX
0068bb35 : MOV dword ptr [ESP + 0x20],EAX
0068bb39 : TEST EAX,EAX
0068bb3b : JL 0x0068bc08
0068bb41 : MOV ECX,0x8
0068bb46 : SUB ECX,EAX
0068bb48 : OR EBP,0xffffffff
0068bb4b : SUB EBP,EBX
0068bb4d : LEA ESI,[EAX + EBX*0x1]
0068bb50 : MOV dword ptr [ESP + 0x24],ECX
0068bb54 : MOV dword ptr [ESP + 0x30],EBP
0068bb58 : JMP 0x0068bb64
0068bb60 : MOV EBP,dword ptr [ESP + 0x30]
0068bb64 : CMP dword ptr [ESP + 0x10],EDX
0068bb68 : MOV AL,byte ptr [ESI]
0068bb6a : MOV byte ptr [ESP + 0x50],AL
0068bb6e : MOV dword ptr [ESP + 0x28],EDX
0068bb72 : JL 0x0068bbeb
0068bb74 : ADD EBP,ESI
0068bb76 : CMP byte ptr [EDI + 0x12],0x1
0068bb7a : JNZ 0x0068bba0
0068bb7c : MOV AL,byte ptr [ESP + 0x50]
0068bb80 : MOV CL,DL
0068bb82 : SHR AL,CL
0068bb84 : OR AL,byte ptr [ESI]
0068bb86 : CMP dword ptr [ESP + 0x20],0x0
0068bb8b : MOV byte ptr [ESI],AL
0068bb8d : JLE 0x0068bbd2
0068bb8f : MOV ECX,dword ptr [ESP + 0x24]
0068bb93 : MOV BL,byte ptr [ESI + -0x1]
0068bb96 : ADD ECX,EBP
0068bb98 : SHL BL,CL
0068bb9a : OR BL,AL
0068bb9c : MOV byte ptr [ESI],BL
0068bb9e : JMP 0x0068bbce
0068bba0 : TEST EBP,EBP
0068bba2 : JL 0x0068bbeb
0068bba4 : MOV CL,byte ptr [EBX + EBP*0x1]
0068bba7 : MOV AL,byte ptr [ESI]
0068bba9 : MOVZX EBX,CL
0068bbac : MOVZX EDX,AL
0068bbaf : ADD EDX,EBX
0068bbb1 : MOVSX EBX,word ptr [EDI + 0x10]
0068bbb5 : DEC EBX
0068bbb6 : CMP EDX,EBX
0068bbb8 : JG 0x0068bbe0
0068bbba : ADD AL,CL
0068bbbc : MOV byte ptr [ESI],AL
0068bbbe : MOVSX ECX,word ptr [EDI + 0x10]
0068bbc2 : MOVZX EDX,AL
0068bbc5 : DEC ECX
0068bbc6 : CMP EDX,ECX
0068bbc8 : JZ 0x0068bbe7
0068bbca : MOV EDX,dword ptr [ESP + 0x28]
0068bbce : MOV EBX,dword ptr [ESP + 0x14]
0068bbd2 : INC EDX
0068bbd3 : DEC EBP
0068bbd4 : CMP EDX,dword ptr [ESP + 0x10]
0068bbd8 : MOV dword ptr [ESP + 0x28],EDX
0068bbdc : JLE 0x0068bb76
0068bbde : JMP 0x0068bbeb
0068bbe0 : MOV AL,byte ptr [EDI + 0x10]
0068bbe3 : DEC AL
0068bbe5 : MOV byte ptr [ESI],AL
0068bbe7 : MOV EBX,dword ptr [ESP + 0x14]
0068bbeb : MOV EAX,dword ptr [ESP + 0x20]
0068bbef : MOV EDX,0x1
0068bbf4 : ADD dword ptr [ESP + 0x24],EDX
0068bbf8 : SUB EAX,EDX
0068bbfa : SUB ESI,EDX
0068bbfc : MOV dword ptr [ESP + 0x20],EAX
0068bc00 : TEST EAX,EAX
0068bc02 : JGE 0x0068bb60
0068bc08 : CMP dword ptr [ESP + 0x18],EDX
0068bc0c : MOV EBP,EDX
0068bc0e : JL 0x0068bc48
0068bc10 : MOV ECX,dword ptr [EDI + 0x8]
0068bc13 : IMUL ECX,EBP
0068bc16 : MOV EAX,EBX
0068bc18 : SUB EAX,ECX
0068bc1a : CMP dword ptr [ESP + 0x1c],0x0
0068bc1f : JLE 0x0068bc3b
0068bc21 : MOV ESI,dword ptr [ESP + 0x1c]
0068bc25 : MOV ECX,EBX
0068bc27 : SUB ECX,EAX
0068bc29 : LEA ESP,[ESP]
0068bc30 : MOV DL,byte ptr [ECX + EAX*0x1]
0068bc33 : OR byte ptr [EAX],DL
0068bc35 : INC EAX
0068bc36 : SUB ESI,0x1
0068bc39 : JNZ 0x0068bc30
0068bc3b : MOV EDX,0x1
0068bc40 : ADD EBP,EDX
0068bc42 : CMP EBP,dword ptr [ESP + 0x18]
0068bc46 : JLE 0x0068bc10
0068bc48 : MOV EAX,dword ptr [ESP + 0x2c]
0068bc4c : ADD EBX,dword ptr [EDI + 0x8]
0068bc4f : ADD EAX,EDX
0068bc51 : CMP EAX,dword ptr [EDI]
0068bc53 : MOV dword ptr [ESP + 0x14],EBX
0068bc57 : MOV dword ptr [ESP + 0x2c],EAX
0068bc5b : JL 0x0068bb30
0068bc61 : MOV EBP,dword ptr [ESP + 0x18]
0068bc65 : MOV EAX,dword ptr [ESP + 0x10]
0068bc69 : ADD dword ptr [EDI + 0x4],EAX
0068bc6c : ADD dword ptr [EDI],EBP
0068bc6e : XOR EAX,EAX
0068bc70 : POP ESI
0068bc71 : POP EBP
0068bc72 : POP EBX
0068bc73 : POP EDI
0068bc74 : ADD ESP,0x3c
0068bc77 : RET
0068bc78 : POP EBP
0068bc79 : POP EBX
0068bc7a : MOV EAX,0x6
0068bc7f : POP EDI
0068bc80 : ADD ESP,0x3c
0068bc83 : RET
0068bc84 : MOV EAX,0x6
0068bc89 : POP EDI
0068bc8a : ADD ESP,0x3c
0068bc8d : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00919170
ENTRY    : 00919170
BODY     : [[00919170, 009191bc] [009191c0, 009193dd]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00919170(int param_1,ushort *param_2)

{
  ushort uVar1;
  uint uVar2;
  undefined4 *puVar3;
  int iVar4;
  int *piVar5;
  ushort *puVar6;
  undefined4 *puVar7;
  undefined1 *puVar8;
  ushort *puVar9;
  uint uVar10;
  int iVar11;
  undefined1 local_28 [8];
  undefined4 local_20;
  undefined4 *local_1c;
  ushort *local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1f130;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  uVar10 = (*param_2 & 0x1fff) - 6;
  puVar9 = param_2 + 3;
  local_14 = 0;
  if (param_2[2] != 0) {
    do {
      puVar3 = (undefined4 *)FUN_006f0760(0x2c,".\\Gui\\AvaGuiRvREvent.cpp",0x404,0,uVar2);
      puVar7 = (undefined4 *)0x0;
      if (puVar3 != (undefined4 *)0x0) {
        puVar3[8] = 7;
        puVar3[7] = 0;
        *(undefined2 *)(puVar3 + 3) = 0;
        puVar7 = puVar3;
      }
      local_8 = 0xffffffff;
      puVar6 = (ushort *)0x0;
      *(undefined1 *)((int)puVar7 + 0x26) = 0;
      puVar7[10] = 0;
      if ((puVar9 == (ushort *)0x0) || (uVar10 < 4)) {
LAB_00919242:
        iVar11 = 0;
        puVar8 = (undefined1 *)0x0;
      }
      else {
        uVar10 = uVar10 - 4;
        *puVar7 = *(undefined4 *)puVar9;
        if ((puVar9 + 2 == (ushort *)0x0) ||
           (((uVar10 < 2 || (uVar1 = puVar9[2], (short)uVar1 < 0)) ||
            (iVar4 = (int)(short)uVar1, (int)uVar10 < iVar4 + 2)))) goto LAB_00919242;
        puVar6 = puVar9 + 3;
        iVar11 = uVar10 + (-2 - iVar4);
        puVar8 = (undefined1 *)((int)puVar9 + iVar4 + 6);
      }
      local_18 = puVar6 + 1;
      puVar9 = puVar6;
      do {
        uVar1 = *puVar9;
        puVar9 = puVar9 + 1;
      } while (uVar1 != 0);
      FUN_00406360(puVar6,(int)puVar9 - (int)local_18 >> 1);
      if ((puVar8 == (undefined1 *)0x0) || (iVar11 == 0)) {
LAB_009192a0:
        uVar10 = 0;
        puVar9 = (ushort *)0x0;
      }
      else {
        *(undefined1 *)(puVar7 + 9) = *puVar8;
        if ((puVar8 + 1 == (undefined1 *)0x0) || (iVar11 == 1)) goto LAB_009192a0;
        *(undefined1 *)((int)puVar7 + 0x25) = puVar8[1];
        if (((undefined4 *)(puVar8 + 2) == (undefined4 *)0x0) || (iVar11 - 2U < 4))
        goto LAB_009192a0;
        uVar10 = iVar11 - 6;
        puVar7[1] = *(undefined4 *)(puVar8 + 2);
        puVar9 = (ushort *)(puVar8 + 6);
      }
      local_20 = *puVar7;
      local_1c = puVar7;
      FUN_00429740(local_28,&local_20);
      local_14 = local_14 + 1;
    } while (local_14 < (int)(uint)param_2[2]);
  }
  param_2 = *(ushort **)(*(int *)(DAT_0172491c + 0x17c) + 0x18a4);
  iVar4 = *(int *)(param_1 + 0x8c);
  piVar5 = (int *)FUN_004437f0(&param_2);
  if (*piVar5 == iVar4) {
    param_2 = (ushort *)FUN_006f0760(0x2c,".\\Gui\\AvaGuiRvREvent.cpp",0x416,0,uVar2);
    if (param_2 == (ushort *)0x0) {
      iVar4 = 0;
    }
    else {
      *(undefined4 *)((int)param_2 + 0x20) = 7;
      *(undefined4 *)((int)param_2 + 0x1c) = 0;
      *(undefined2 *)((int)param_2 + 0xc) = 0;
      iVar4 = (int)param_2;
    }
    iVar11 = DAT_0172491c;
    local_8 = 0xffffffff;
    *(undefined1 *)(iVar4 + 0x26) = 0;
    *(undefined4 *)(iVar4 + 0x28) = 0;
    FUN_00405eb0(*(int *)(iVar11 + 0x17c) + 0xc,0,0xffffffff);
    iVar11 = DAT_0172491c;
    *(undefined1 *)(iVar4 + 0x24) = *(undefined1 *)(*(int *)(DAT_0172491c + 0x17c) + 0xa0);
    *(undefined1 *)(iVar4 + 0x25) = *(undefined1 *)(*(int *)(iVar11 + 0x17c) + 0x16d8);
    *(undefined4 *)(iVar4 + 4) = *(undefined4 *)(*(int *)(iVar11 + 0x17c) + 4);
    local_20 = *(undefined4 *)(*(int *)(iVar11 + 0x17c) + 0x18a4);
    local_1c = (undefined4 *)iVar4;
    FUN_00429740(local_28,&local_20);
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00919170 : PUSH EBP
00919171 : MOV EBP,ESP
00919173 : PUSH -0x1
00919175 : PUSH 0xb1f130
0091917a : MOV EAX,FS:[0x0]
00919180 : PUSH EAX
00919181 : SUB ESP,0x1c
00919184 : PUSH EBX
00919185 : PUSH ESI
00919186 : PUSH EDI
00919187 : MOV EAX,[0x00d66fa0]
0091918c : XOR EAX,EBP
0091918e : PUSH EAX
0091918f : LEA EAX,[EBP + -0xc]
00919192 : MOV FS:[0x0],EAX
00919198 : MOV EAX,dword ptr [EBP + 0xc]
0091919b : MOVZX EDI,word ptr [EAX]
0091919e : AND EDI,0x1fff
009191a4 : XOR EBX,EBX
009191a6 : XOR ECX,ECX
009191a8 : SUB EDI,0x6
009191ab : LEA ESI,[EAX + 0x6]
009191ae : MOV dword ptr [EBP + -0x10],EBX
009191b1 : CMP CX,word ptr [EAX + 0x4]
009191b5 : JNC 0x009192d9
009191bb : JMP 0x009191c0
009191c0 : PUSH EBX
009191c1 : PUSH 0x404
009191c6 : PUSH 0xc67f70
009191cb : PUSH 0x2c
009191cd : CALL 0x006f0760
009191d2 : ADD ESP,0x10
009191d5 : MOV dword ptr [EBP + -0x14],EAX
009191d8 : MOV dword ptr [EBP + -0x4],EBX
009191db : CMP EAX,EBX
009191dd : JZ 0x009191f4
009191df : XOR EDX,EDX
009191e1 : MOV dword ptr [EAX + 0x20],0x7
009191e8 : MOV dword ptr [EAX + 0x1c],EBX
009191eb : MOV word ptr [EAX + 0xc],DX
009191ef : MOV byte ptr [EBP + -0x4],DL
009191f2 : MOV EBX,EAX
009191f4 : MOV dword ptr [EBP + -0x4],0xffffffff
009191fb : XOR ECX,ECX
009191fd : MOV byte ptr [EBX + 0x26],0x0
00919201 : MOV dword ptr [EBX + 0x28],ECX
00919204 : CMP ESI,ECX
00919206 : JZ 0x00919242
00919208 : CMP EDI,0x4
0091920b : JC 0x00919242
0091920d : MOV EAX,dword ptr [ESI]
0091920f : ADD ESI,0x4
00919212 : SUB EDI,0x4
00919215 : MOV dword ptr [EBX],EAX
00919217 : CMP ESI,ECX
00919219 : JZ 0x00919242
0091921b : CMP EDI,0x2
0091921e : JC 0x00919242
00919220 : MOVZX EAX,word ptr [ESI]
00919223 : CMP AX,CX
00919226 : JL 0x00919242
00919228 : CWDE
00919229 : LEA EDX,[EAX + 0x2]
0091922c : CMP EDI,EDX
0091922e : JL 0x00919242
00919230 : MOV EDX,0xfffffffe
00919235 : SUB EDX,EAX
00919237 : LEA ECX,[ESI + 0x2]
0091923a : ADD EDI,EDX
0091923c : LEA ESI,[ESI + EAX*0x1 + 0x2]
00919240 : JMP 0x00919246
00919242 : XOR EDI,EDI
00919244 : XOR ESI,ESI
00919246 : MOV EAX,ECX
00919248 : LEA EDX,[EAX + 0x2]
0091924b : MOV dword ptr [EBP + -0x14],EDX
0091924e : MOV EDI,EDI
00919250 : MOV DX,word ptr [EAX]
00919253 : ADD EAX,0x2
00919256 : TEST DX,DX
00919259 : JNZ 0x00919250
0091925b : SUB EAX,dword ptr [EBP + -0x14]
0091925e : SAR EAX,0x1
00919260 : PUSH EAX
00919261 : PUSH ECX
00919262 : LEA ECX,[EBX + 0x8]
00919265 : CALL 0x00406360
0091926a : TEST ESI,ESI
0091926c : JZ 0x009192a0
0091926e : CMP EDI,0x1
00919271 : JC 0x009192a0
00919273 : MOV AL,byte ptr [ESI]
00919275 : DEC EDI
00919276 : ADD ESI,0x1
00919279 : MOV byte ptr [EBX + 0x24],AL
0091927c : JZ 0x009192a0
0091927e : CMP EDI,0x1
00919281 : JC 0x009192a0
00919283 : MOV CL,byte ptr [ESI]
00919285 : DEC EDI
00919286 : ADD ESI,0x1
00919289 : MOV byte ptr [EBX + 0x25],CL
0091928c : JZ 0x009192a0
0091928e : CMP EDI,0x4
00919291 : JC 0x009192a0
00919293 : MOV EDX,dword ptr [ESI]
00919295 : SUB EDI,0x4
00919298 : MOV dword ptr [EBX + 0x4],EDX
0091929b : ADD ESI,0x4
0091929e : JMP 0x009192a4
009192a0 : XOR EDI,EDI
009192a2 : XOR ESI,ESI
009192a4 : MOV EAX,dword ptr [EBX]
009192a6 : MOV dword ptr [EBP + -0x1c],EAX
009192a9 : MOV EAX,dword ptr [EBP + 0x8]
009192ac : LEA ECX,[EBP + -0x1c]
009192af : PUSH ECX
009192b0 : LEA EDX,[EBP + -0x24]
009192b3 : PUSH EDX
009192b4 : ADD EAX,0x88
009192b9 : MOV dword ptr [EBP + -0x18],EBX
009192bc : CALL 0x00429740
009192c1 : MOV ECX,dword ptr [EBP + 0xc]
009192c4 : MOV EAX,dword ptr [EBP + -0x10]
009192c7 : MOVZX EDX,word ptr [ECX + 0x4]
009192cb : INC EAX
009192cc : XOR EBX,EBX
009192ce : CMP EAX,EDX
009192d0 : MOV dword ptr [EBP + -0x10],EAX
009192d3 : JL 0x009191c0
009192d9 : MOV EAX,[0x0172491c]
009192de : MOV EAX,dword ptr [EAX + 0x17c]
009192e4 : MOV ECX,dword ptr [EAX + 0x18a4]
009192ea : MOV EAX,dword ptr [EBP + 0x8]
009192ed : MOV ESI,dword ptr [EAX + 0x8c]
009192f3 : LEA EDI,[EAX + 0x88]
009192f9 : LEA EDX,[EBP + 0xc]
009192fc : MOV dword ptr [EBP + 0xc],ECX
009192ff : PUSH EDX
00919300 : LEA EAX,[EBP + 0x8]
00919303 : MOV ECX,EDI
00919305 : CALL 0x004437f0
0091930a : CMP dword ptr [EAX],ESI
0091930c : JNZ 0x009193ca
00919312 : PUSH EBX
00919313 : PUSH 0x416
00919318 : PUSH 0xc67fa8
0091931d : PUSH 0x2c
0091931f : CALL 0x006f0760
00919324 : ADD ESP,0x10
00919327 : MOV dword ptr [EBP + 0xc],EAX
0091932a : MOV dword ptr [EBP + -0x4],0x2
00919331 : CMP EAX,EBX
00919333 : JZ 0x0091934d
00919335 : XOR ECX,ECX
00919337 : MOV dword ptr [EAX + 0x20],0x7
0091933e : MOV dword ptr [EAX + 0x1c],EBX
00919341 : MOV word ptr [EAX + 0xc],CX
00919345 : MOV byte ptr [EBP + -0x4],0x2
00919349 : MOV ESI,EAX
0091934b : JMP 0x0091934f
0091934d : XOR ESI,ESI
0091934f : MOV dword ptr [EBP + -0x4],0xffffffff
00919356 : MOV EDX,dword ptr [0x0172491c]
0091935c : MOV byte ptr [ESI + 0x26],0x0
00919360 : MOV dword ptr [ESI + 0x28],EBX
00919363 : MOV EAX,dword ptr [EDX + 0x17c]
00919369 : PUSH -0x1
0091936b : PUSH EBX
0091936c : ADD EAX,0xc
0091936f : PUSH EAX
00919370 : LEA ECX,[ESI + 0x8]
00919373 : CALL 0x00405eb0
00919378 : MOV EAX,[0x0172491c]
0091937d : MOV ECX,dword ptr [EAX + 0x17c]
00919383 : MOVZX EDX,byte ptr [ECX + 0xa0]
0091938a : MOV byte ptr [ESI + 0x24],DL
0091938d : MOV ECX,dword ptr [EAX + 0x17c]
00919393 : MOVZX EDX,byte ptr [ECX + 0x16d8]
0091939a : MOV byte ptr [ESI + 0x25],DL
0091939d : MOV ECX,dword ptr [EAX + 0x17c]
009193a3 : MOV EDX,dword ptr [ECX + 0x4]
009193a6 : MOV dword ptr [ESI + 0x4],EDX
009193a9 : MOV EAX,dword ptr [EAX + 0x17c]
009193af : MOV ECX,dword ptr [EAX + 0x18a4]
009193b5 : LEA EDX,[EBP + -0x1c]
009193b8 : PUSH EDX
009193b9 : LEA EAX,[EBP + -0x24]
009193bc : PUSH EAX
009193bd : MOV EAX,EDI
009193bf : MOV dword ptr [EBP + -0x1c],ECX
009193c2 : MOV dword ptr [EBP + -0x18],ESI
009193c5 : CALL 0x00429740
009193ca : MOV ECX,dword ptr [EBP + -0xc]
009193cd : MOV dword ptr FS:[0x0],ECX
009193d4 : POP ECX
009193d5 : POP EDI
009193d6 : POP ESI
009193d7 : POP EBX
009193d8 : MOV ESP,EBP
009193da : POP EBP
009193db : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_00995d80
ENTRY    : 00995d80
BODY     : [[00995d80, 00995ddc] [00995de0, 00995eae] [00995eb0, 00995f6a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00995d80(int param_1)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  int *extraout_EDX;
  int *extraout_EDX_00;
  int *piVar4;
  undefined4 uVar5;
  char cVar6;
  ulonglong uVar7;
  undefined8 uVar8;
  undefined1 local_3c [4];
  int local_38;
  int local_34;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  iVar3 = DAT_0172484c;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b21101;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  cVar6 = '\t';
  if (*(int *)(param_1 + 0x4c) == 6) {
    cVar6 = '\n';
  }
  local_14 = uVar1;
  if (DAT_0172484c == 0) {
    local_34 = 0;
    iVar2 = 0;
  }
  else {
    local_34 = -(uint)(*(int *)(DAT_0172484c + 0x28) != 0);
    iVar2 = local_34;
  }
  do {
    do {
      if (iVar2 == 0) {
        FUN_00404750(L"[AvaGuiGachaBox::FindPremiumLinkGachaItemProto] Item Don\'t Find LinkItem(%d). Fail."
                     ,cVar6,uVar1);
        local_8 = 0;
        piVar4 = DAT_00da98e8;
        if ((int *)*DAT_00da98e8 != (int *)0x0) {
          (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                    (L"AvaGuiGachaBox::FindPremiumLinkGachaItemProto",0x22a,local_30);
          piVar4 = extraout_EDX;
        }
        uVar7 = CONCAT44(piVar4,local_38);
        local_8 = 0xffffffff;
        if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_18 = 7;
        local_1c = 0;
        local_2c = 0;
        goto LAB_00995e91;
      }
    } while (iVar3 == 0);
    local_38 = 0;
    FUN_00404160(&local_34,local_3c,&local_38);
    iVar2 = local_34;
  } while ((local_38 == 0) || (*(char *)(local_38 + 0xfc) != cVar6));
  local_34 = local_38 + 0x100;
  uVar7 = (**(code **)(*(int *)(local_38 + 0x100) + 4))();
  do {
    while( true ) {
      local_38 = (int)uVar7;
      if (local_38 == 0) goto LAB_00995e91;
      iVar3 = FUN_004f5680();
      if (iVar3 != 0) break;
      local_2c = 0;
      local_18 = 7;
      local_1c = 0;
      FUN_00406360(L"[AvaGuiGachaBox::FindPremiumLinkGachaItemProto] pUnitData is NULL.",0x42);
      local_8 = 1;
      piVar4 = DAT_00da98e8;
      if ((int *)*DAT_00da98e8 != (int *)0x0) {
        (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                  (L"AvaGuiGachaBox::FindPremiumLinkGachaItemProto",0x234,local_30);
        piVar4 = extraout_EDX_00;
      }
      local_8 = 0xffffffff;
      if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_18 = 7;
      local_1c = 0;
      local_2c = 0;
      uVar7 = CONCAT44(piVar4,local_38);
    }
    uVar8 = FUN_00703c00(0x68e);
    uVar5 = (undefined4)((ulonglong)uVar8 >> 0x20);
    iVar3 = (int)uVar8;
    uVar7 = CONCAT44(uVar5,local_38);
  } while ((iVar3 == 0) ||
          ((*(char *)(iVar3 + 0x7e8) != '\x05' &&
           (uVar7 = CONCAT44(uVar5,local_38), *(char *)(iVar3 + 0x7e8) != '\x06'))));
  uVar7 = (ulonglong)CONCAT24(*(undefined2 *)(iVar3 + 6),local_38);
LAB_00995e91:
  local_38 = (int)uVar7;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc,(int)(uVar7 >> 0x20));
  return;
}



============================================================
DISASSEMBLY
============================================================
00995d80 : PUSH EBP
00995d81 : MOV EBP,ESP
00995d83 : PUSH -0x1
00995d85 : PUSH 0xb21101
00995d8a : MOV EAX,FS:[0x0]
00995d90 : PUSH EAX
00995d91 : SUB ESP,0x2c
00995d94 : MOV EAX,[0x00d66fa0]
00995d99 : XOR EAX,EBP
00995d9b : MOV dword ptr [EBP + -0x10],EAX
00995d9e : PUSH EBX
00995d9f : PUSH ESI
00995da0 : PUSH EDI
00995da1 : PUSH EAX
00995da2 : LEA EAX,[EBP + -0xc]
00995da5 : MOV FS:[0x0],EAX
00995dab : MOV EAX,dword ptr [EBP + 0x8]
00995dae : CMP dword ptr [EAX + 0x4c],0x6
00995db2 : MOV EDI,0x9
00995db7 : JNZ 0x00995dbe
00995db9 : MOV EDI,0xa
00995dbe : MOV ESI,dword ptr [0x0172484c]
00995dc4 : XOR EBX,EBX
00995dc6 : CMP ESI,EBX
00995dc8 : JZ 0x00995dd6
00995dca : MOV EAX,dword ptr [ESI + 0x28]
00995dcd : NEG EAX
00995dcf : SBB EAX,EAX
00995dd1 : MOV dword ptr [EBP + -0x30],EAX
00995dd4 : JMP 0x00995de3
00995dd6 : XOR EAX,EAX
00995dd8 : MOV dword ptr [EBP + -0x30],EAX
00995ddb : JMP 0x00995de3
00995de0 : MOV EAX,dword ptr [EBP + -0x30]
00995de3 : CMP EAX,EBX
00995de5 : JZ 0x00995e36
00995de7 : CMP ESI,EBX
00995de9 : JZ 0x00995de3
00995deb : LEA ECX,[EBP + -0x34]
00995dee : PUSH ECX
00995def : LEA EDX,[EBP + -0x38]
00995df2 : PUSH EDX
00995df3 : LEA EAX,[EBP + -0x30]
00995df6 : PUSH EAX
00995df7 : MOV EAX,ESI
00995df9 : MOV dword ptr [EBP + -0x34],EBX
00995dfc : CALL 0x00404160
00995e01 : MOV EAX,dword ptr [EBP + -0x34]
00995e04 : CMP EAX,EBX
00995e06 : JZ 0x00995de0
00995e08 : MOVZX ECX,byte ptr [EAX + 0xfc]
00995e0f : CMP ECX,EDI
00995e11 : JNZ 0x00995de0
00995e13 : MOV EDX,dword ptr [EAX + 0x100]
00995e19 : LEA EDI,[EAX + 0x100]
00995e1f : MOV EAX,dword ptr [EDX + 0x4]
00995e22 : MOV ECX,EDI
00995e24 : MOV dword ptr [EBP + -0x30],EDI
00995e27 : CALL EAX
00995e29 : MOV dword ptr [EBP + -0x34],EAX
00995e2c : MOV ESI,0x7
00995e31 : JMP 0x00995eb3
00995e36 : PUSH EDI
00995e37 : PUSH 0xc86590
00995e3c : LEA ESI,[EBP + -0x2c]
00995e3f : CALL 0x00404750
00995e44 : ADD ESP,0x8
00995e47 : MOV dword ptr [EBP + -0x4],EBX
00995e4a : MOV EDX,dword ptr [0x00da98e8]
00995e50 : MOV ECX,dword ptr [EDX]
00995e52 : CMP ECX,EBX
00995e54 : JZ 0x00995e6a
00995e56 : MOV EAX,dword ptr [ECX]
00995e58 : MOV EAX,dword ptr [EAX + 0x14]
00995e5b : MOV EDX,ESI
00995e5d : PUSH EDX
00995e5e : PUSH 0x22a
00995e63 : PUSH 0xc86638
00995e68 : CALL EAX
00995e6a : MOV dword ptr [EBP + -0x4],0xffffffff
00995e71 : CMP dword ptr [EBP + -0x14],0x8
00995e75 : JC 0x00995e7f
00995e77 : MOV ECX,dword ptr [EBP + -0x28]
00995e7a : CALL 0x006f04e0
00995e7f : XOR ECX,ECX
00995e81 : MOV dword ptr [EBP + -0x14],0x7
00995e88 : MOV dword ptr [EBP + -0x18],EBX
00995e8b : MOV word ptr [EBP + -0x28],CX
00995e8f : XOR EAX,EAX
00995e91 : MOV ECX,dword ptr [EBP + -0xc]
00995e94 : MOV dword ptr FS:[0x0],ECX
00995e9b : POP ECX
00995e9c : POP EDI
00995e9d : POP ESI
00995e9e : POP EBX
00995e9f : MOV ECX,dword ptr [EBP + -0x10]
00995ea2 : XOR ECX,EBP
00995ea4 : CALL 0x00633e6b
00995ea9 : MOV ESP,EBP
00995eab : POP EBP
00995eac : RET 0x4
00995eb0 : MOV EDI,dword ptr [EBP + -0x30]
00995eb3 : CMP dword ptr [EBP + -0x34],EBX
00995eb6 : JZ 0x00995e8f
00995eb8 : LEA EDX,[EBP + -0x34]
00995ebb : MOV EAX,EDI
00995ebd : CALL 0x004f5680
00995ec2 : CMP EAX,EBX
00995ec4 : JNZ 0x00995f2c
00995ec6 : XOR ECX,ECX
00995ec8 : PUSH 0x42
00995eca : MOV word ptr [EBP + -0x28],CX
00995ece : PUSH 0xc866b0
00995ed3 : LEA ECX,[EBP + -0x2c]
00995ed6 : MOV dword ptr [EBP + -0x14],ESI
00995ed9 : MOV dword ptr [EBP + -0x18],EBX
00995edc : CALL 0x00406360
00995ee1 : MOV dword ptr [EBP + -0x4],0x1
00995ee8 : MOV EDX,dword ptr [0x00da98e8]
00995eee : MOV ECX,dword ptr [EDX]
00995ef0 : CMP ECX,EBX
00995ef2 : JZ 0x00995f09
00995ef4 : MOV EAX,dword ptr [ECX]
00995ef6 : MOV EAX,dword ptr [EAX + 0x14]
00995ef9 : LEA EDX,[EBP + -0x2c]
00995efc : PUSH EDX
00995efd : PUSH 0x234
00995f02 : PUSH 0xc86738
00995f07 : CALL EAX
00995f09 : MOV dword ptr [EBP + -0x4],0xffffffff
00995f10 : CMP dword ptr [EBP + -0x14],0x8
00995f14 : JC 0x00995f1e
00995f16 : MOV ECX,dword ptr [EBP + -0x28]
00995f19 : CALL 0x006f04e0
00995f1e : XOR ECX,ECX
00995f20 : MOV dword ptr [EBP + -0x14],ESI
00995f23 : MOV dword ptr [EBP + -0x18],EBX
00995f26 : MOV word ptr [EBP + -0x28],CX
00995f2a : JMP 0x00995eb3
00995f2c : MOV DI,word ptr [EAX + 0x18]
00995f30 : PUSH 0x68e
00995f35 : CALL 0x00703c00
00995f3a : MOV ECX,EAX
00995f3c : ADD ESP,0x4
00995f3f : CMP ECX,EBX
00995f41 : JZ 0x00995eb0
00995f47 : MOV AL,byte ptr [ECX + 0x7e8]
00995f4d : CMP AL,0x5
00995f4f : JZ 0x00995f59
00995f51 : CMP AL,0x6
00995f53 : JNZ 0x00995eb0
00995f59 : MOVZX EAX,word ptr [ECX + 0x4]
00995f5d : MOVZX EDX,word ptr [ECX + 0x6]
00995f61 : SHL EAX,0x10
00995f64 : OR EAX,EDX
00995f66 : JMP 0x00995e91

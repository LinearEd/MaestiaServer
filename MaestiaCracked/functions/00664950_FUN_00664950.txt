PROGRAM  : Maestia.exe
FUNCTION : FUN_00664950
ENTRY    : 00664950
BODY     : [[00664950, 006649b3]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00664950(void *param_1,undefined4 *param_2)

{
  undefined4 *puVar1;
  int iVar2;
  LPVOID _Dst;
  SIZE_T cb;
  
  puVar1 = param_2;
  if (param_2 == (undefined4 *)0x0) {
    return -0x7fffbffd;
  }
  *param_2 = 0;
  iVar2 = FUN_00664900(param_1,100000,&param_2);
  if (-1 < iVar2) {
    cb = (int)param_2 + 2;
    _Dst = CoTaskMemAlloc(cb);
    *puVar1 = _Dst;
    if (_Dst == (LPVOID)0x0) {
      return -0x7ff8fff2;
    }
    _memcpy(_Dst,param_1,cb);
    iVar2 = 0;
  }
  return iVar2;
}



============================================================
DISASSEMBLY
============================================================
00664950 : PUSH EDI
00664951 : MOV EDI,dword ptr [ESP + 0xc]
00664955 : TEST EDI,EDI
00664957 : JNZ 0x00664962
00664959 : MOV EAX,0x80004003
0066495e : POP EDI
0066495f : RET 0x8
00664962 : PUSH EBX
00664963 : MOV EBX,dword ptr [ESP + 0xc]
00664967 : LEA EAX,[ESP + 0x10]
0066496b : PUSH EAX
0066496c : PUSH 0x186a0
00664971 : PUSH EBX
00664972 : MOV dword ptr [EDI],0x0
00664978 : CALL 0x00664900
0066497d : TEST EAX,EAX
0066497f : JL 0x006649af
00664981 : PUSH ESI
00664982 : MOV ESI,dword ptr [ESP + 0x14]
00664986 : ADD ESI,0x2
00664989 : PUSH ESI
0066498a : CALL dword ptr [0x00b85764]
00664990 : MOV dword ptr [EDI],EAX
00664992 : TEST EAX,EAX
00664994 : JNZ 0x006649a1
00664996 : POP ESI
00664997 : POP EBX
00664998 : MOV EAX,0x8007000e
0066499d : POP EDI
0066499e : RET 0x8
006649a1 : PUSH ESI
006649a2 : PUSH EBX
006649a3 : PUSH EAX
006649a4 : CALL 0x0063ae40
006649a9 : ADD ESP,0xc
006649ac : XOR EAX,EAX
006649ae : POP ESI
006649af : POP EBX
006649b0 : POP EDI
006649b1 : RET 0x8

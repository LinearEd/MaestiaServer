PROGRAM  : Maestia.exe
FUNCTION : FUN_00870b80
ENTRY    : 00870b80
BODY     : [[00870b80, 00870df5]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00870b80(int param_1,int param_2)

{
  ushort uVar1;
  short sVar2;
  char cVar3;
  int iVar4;
  int *in_ECX;
  uint local_c;
  int local_8;
  
  iVar4 = DAT_00d7c54c;
  local_8 = param_1;
  FUN_004437f0(&local_8);
  if ((local_c != *(uint *)(iVar4 + 0x44)) && (iVar4 = *(int *)(local_c + 0x10), iVar4 != 0)) {
    uVar1 = *(ushort *)(in_ECX + 0x61e);
    if ((uVar1 != 0) && (*(ushort *)(iVar4 + 0x84) != uVar1)) {
      local_c = (uint)uVar1;
      FUN_00484470(&local_c);
      if (local_8 != in_ECX[0x176]) {
        FUN_007bc960(DAT_01725208,*(undefined4 *)(local_8 + 0x10));
      }
    }
    *(undefined2 *)(in_ECX + 0x61e) = *(undefined2 *)(iVar4 + 0x84);
    if ((param_2 == 0) || ((*(byte *)(iVar4 + 0x80) & 1) == 0)) {
      *(undefined1 *)((int)in_ECX + 0x187a) = 0;
    }
    else {
      *(undefined1 *)((int)in_ECX + 0x187a) = 1;
    }
    if ((short)param_1 == 0x2715) {
      *(undefined2 *)(in_ECX + 0x61e) = 0x73;
    }
    sVar2 = (short)in_ECX[0x61e];
    if (sVar2 != 0) {
      if (sVar2 == 0xf) {
        if (param_2 == 0) {
          *(undefined2 *)(in_ECX + 0x61e) = 0x11;
          FUN_008914b0(0x9b,0,0);
        }
        else {
          FUN_008914b0(0x9b,1,0);
        }
      }
      else if (sVar2 == 0x73) {
        if (param_2 == 0) {
          if ((in_ECX[0x62e] != 0) && (iVar4 = FUN_00702b00(), param_1 == iVar4)) {
            FUN_0083a530();
          }
          cVar3 = FUN_0040dfb0();
          if (cVar3 != '\0') {
            *(undefined2 *)(in_ECX + 0x61e) = 0x75;
          }
          FUN_008914b0(0x9b,0,0);
        }
        else {
          if ((in_ECX[0x62e] != 0) && (iVar4 = FUN_00702b00(), param_1 == iVar4)) {
            FUN_0083a550();
          }
          FUN_008914b0(0x9b,1,0);
        }
      }
      else if (param_2 == 0) {
        (**(code **)(*(int *)(*(int *)(in_ECX[0x4e] + 4) + 0x138 + (int)in_ECX) + 0x10))
                  (in_ECX + 0x322,0,1,0);
        (**(code **)(*(int *)(*(int *)(in_ECX[0x4e] + 4) + 0x138 + (int)in_ECX) + 0x10))
                  (in_ECX + 0x74e,0,1,0);
      }
      cVar3 = FUN_0040dfb0();
      if (((cVar3 != '\0') || (param_2 != 0)) ||
         ((iVar4 = FUN_00702b00(), iVar4 != param_1 && (iVar4 = FUN_00702b00(), iVar4 != param_1))))
      {
        cVar3 = FUN_00876040();
        if (cVar3 != '\0') {
          (**(code **)(*in_ECX + 0x410))();
          return;
        }
        (**(code **)(*(int *)((int)in_ECX + *(int *)(in_ECX[0x4e] + 4) + 0x138) + 0x10))
                  (in_ECX + 0x6fa,0,1,0);
      }
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00870b80 : PUSH EBP
00870b81 : MOV EBP,ESP
00870b83 : SUB ESP,0x8
00870b86 : MOV EAX,dword ptr [EBP + 0x8]
00870b89 : PUSH EBX
00870b8a : MOV EBX,ECX
00870b8c : PUSH ESI
00870b8d : MOV ESI,dword ptr [0x00d7c54c]
00870b93 : LEA ECX,[EBP + -0x4]
00870b96 : MOV dword ptr [EBP + -0x4],EAX
00870b99 : PUSH ECX
00870b9a : LEA ECX,[ESI + 0x40]
00870b9d : LEA EAX,[EBP + -0x8]
00870ba0 : CALL 0x004437f0
00870ba5 : MOV EAX,dword ptr [EBP + -0x8]
00870ba8 : CMP EAX,dword ptr [ESI + 0x44]
00870bab : JZ 0x00870dee
00870bb1 : MOV ESI,dword ptr [EAX + 0x10]
00870bb4 : TEST ESI,ESI
00870bb6 : JZ 0x00870dee
00870bbc : MOVZX EAX,word ptr [EBX + 0x1878]
00870bc3 : TEST AX,AX
00870bc6 : JZ 0x00870c04
00870bc8 : CMP word ptr [ESI + 0x84],AX
00870bcf : JZ 0x00870c04
00870bd1 : MOVZX EDX,AX
00870bd4 : LEA EAX,[EBP + -0x8]
00870bd7 : PUSH EAX
00870bd8 : LEA ECX,[EBX + 0x5d4]
00870bde : LEA EAX,[EBP + -0x4]
00870be1 : MOV dword ptr [EBP + -0x8],EDX
00870be4 : CALL 0x00484470
00870be9 : MOV EAX,dword ptr [EBP + -0x4]
00870bec : CMP EAX,dword ptr [EBX + 0x5d8]
00870bf2 : JZ 0x00870c04
00870bf4 : MOV ECX,dword ptr [EAX + 0x10]
00870bf7 : MOV EDX,dword ptr [0x01725208]
00870bfd : PUSH ECX
00870bfe : PUSH EDX
00870bff : CALL 0x007bc960
00870c04 : MOV AX,word ptr [ESI + 0x84]
00870c0b : PUSH EDI
00870c0c : MOV EDI,dword ptr [EBP + 0xc]
00870c0f : MOV word ptr [EBX + 0x1878],AX
00870c16 : TEST EDI,EDI
00870c18 : JZ 0x00870c2c
00870c1a : TEST byte ptr [ESI + 0x80],0x1
00870c21 : JZ 0x00870c2c
00870c23 : MOV byte ptr [EBX + 0x187a],0x1
00870c2a : JMP 0x00870c33
00870c2c : MOV byte ptr [EBX + 0x187a],0x0
00870c33 : MOV ESI,dword ptr [EBP + 0x8]
00870c36 : MOV ECX,0x2715
00870c3b : CMP SI,CX
00870c3e : JNZ 0x00870c4c
00870c40 : MOV EDX,0x73
00870c45 : MOV word ptr [EBX + 0x1878],DX
00870c4c : MOVZX EAX,word ptr [EBX + 0x1878]
00870c53 : TEST AX,AX
00870c56 : JZ 0x00870ded
00870c5c : CMP AX,0xf
00870c60 : JNZ 0x00870c98
00870c62 : PUSH 0x0
00870c64 : MOV ESI,EBX
00870c66 : TEST EDI,EDI
00870c68 : JZ 0x00870c7b
00870c6a : PUSH 0x1
00870c6c : PUSH 0x9b
00870c71 : CALL 0x008914b0
00870c76 : JMP 0x00870d6a
00870c7b : PUSH 0x0
00870c7d : MOV EAX,0x11
00870c82 : PUSH 0x9b
00870c87 : MOV word ptr [EBX + 0x1878],AX
00870c8e : CALL 0x008914b0
00870c93 : JMP 0x00870d6a
00870c98 : CMP AX,0x73
00870c9c : JNZ 0x00870d18
00870c9e : TEST EDI,EDI
00870ca0 : JZ 0x00870cd3
00870ca2 : CMP dword ptr [EBX + 0x18b8],0x0
00870ca9 : JZ 0x00870cbe
00870cab : MOV EAX,0x8
00870cb0 : CALL 0x00702b00
00870cb5 : CMP ESI,EAX
00870cb7 : JNZ 0x00870cbe
00870cb9 : CALL 0x0083a550
00870cbe : PUSH 0x0
00870cc0 : PUSH 0x1
00870cc2 : PUSH 0x9b
00870cc7 : MOV ESI,EBX
00870cc9 : CALL 0x008914b0
00870cce : JMP 0x00870d6a
00870cd3 : CMP dword ptr [EBX + 0x18b8],0x0
00870cda : JZ 0x00870cef
00870cdc : MOV EAX,0x8
00870ce1 : CALL 0x00702b00
00870ce6 : CMP ESI,EAX
00870ce8 : JNZ 0x00870cef
00870cea : CALL 0x0083a530
00870cef : MOV EAX,EBX
00870cf1 : CALL 0x0040dfb0
00870cf6 : TEST AL,AL
00870cf8 : JZ 0x00870d06
00870cfa : MOV ECX,0x75
00870cff : MOV word ptr [EBX + 0x1878],CX
00870d06 : PUSH 0x0
00870d08 : PUSH 0x0
00870d0a : PUSH 0x9b
00870d0f : MOV ESI,EBX
00870d11 : CALL 0x008914b0
00870d16 : JMP 0x00870d6a
00870d18 : TEST EDI,EDI
00870d1a : JNZ 0x00870d6a
00870d1c : MOV EDX,dword ptr [EBX + 0x138]
00870d22 : MOV EAX,dword ptr [EDX + 0x4]
00870d25 : MOV EDX,dword ptr [EAX + EBX*0x1 + 0x138]
00870d2c : MOV EDX,dword ptr [EDX + 0x10]
00870d2f : PUSH EDI
00870d30 : LEA ECX,[EAX + EBX*0x1 + 0x138]
00870d37 : PUSH 0x1
00870d39 : PUSH EDI
00870d3a : LEA EAX,[EBX + 0xc88]
00870d40 : PUSH EAX
00870d41 : CALL EDX
00870d43 : MOV EAX,dword ptr [EBX + 0x138]
00870d49 : MOV ECX,dword ptr [EAX + 0x4]
00870d4c : MOV EDX,dword ptr [ECX + EBX*0x1 + 0x138]
00870d53 : MOV EDX,dword ptr [EDX + 0x10]
00870d56 : PUSH EDI
00870d57 : PUSH 0x1
00870d59 : LEA ECX,[ECX + EBX*0x1 + 0x138]
00870d60 : PUSH EDI
00870d61 : LEA EAX,[EBX + 0x1d38]
00870d67 : PUSH EAX
00870d68 : CALL EDX
00870d6a : MOV EAX,EBX
00870d6c : CALL 0x0040dfb0
00870d71 : TEST AL,AL
00870d73 : JNZ 0x00870d96
00870d75 : TEST EDI,EDI
00870d77 : JNZ 0x00870d96
00870d79 : LEA EAX,[EDI + 0x8]
00870d7c : CALL 0x00702b00
00870d81 : MOV ESI,dword ptr [EBP + 0x8]
00870d84 : CMP EAX,ESI
00870d86 : JZ 0x00870ded
00870d88 : MOV EAX,0x800
00870d8d : CALL 0x00702b00
00870d92 : CMP EAX,ESI
00870d94 : JZ 0x00870ded
00870d96 : MOV EAX,dword ptr [EBX + 0x138]
00870d9c : MOV EAX,dword ptr [EAX + 0x4]
00870d9f : LEA ESI,[EBX + 0x1be8]
00870da5 : LEA EDI,[EBX + EAX*0x1 + 0x138]
00870dac : CALL 0x00876040
00870db1 : TEST AL,AL
00870db3 : JZ 0x00870dca
00870db5 : MOV EDX,dword ptr [EBX]
00870db7 : MOV EAX,dword ptr [EDX + 0x410]
00870dbd : MOV ECX,EBX
00870dbf : CALL EAX
00870dc1 : POP EDI
00870dc2 : POP ESI
00870dc3 : POP EBX
00870dc4 : MOV ESP,EBP
00870dc6 : POP EBP
00870dc7 : RET 0x8
00870dca : MOV EAX,dword ptr [EBX + 0x138]
00870dd0 : MOV ECX,dword ptr [EAX + 0x4]
00870dd3 : MOV EDX,dword ptr [EBX + ECX*0x1 + 0x138]
00870dda : MOV EAX,dword ptr [EDX + 0x10]
00870ddd : PUSH 0x0
00870ddf : PUSH 0x1
00870de1 : LEA ECX,[EBX + ECX*0x1 + 0x138]
00870de8 : PUSH 0x0
00870dea : PUSH ESI
00870deb : CALL EAX
00870ded : POP EDI
00870dee : POP ESI
00870def : POP EBX
00870df0 : MOV ESP,EBP
00870df2 : POP EBP
00870df3 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_0053b640
ENTRY    : 0053b640
BODY     : [[0053b640, 0053b6c2]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_0053b640(int *param_1,ushort *param_2,uint param_3)

{
  ushort uVar1;
  uint in_EAX;
  uint uVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  
  uVar5 = param_3;
  if (param_3 == 0) {
    return in_EAX & 0xffffff00;
  }
  uVar1 = *param_2;
  uVar2 = (uint)uVar1;
  iVar6 = 0;
  iVar3 = 1;
  param_3 = 1;
  if (uVar1 == 0x2d) {
    param_3 = -1;
    iVar3 = -1;
  }
  else if (uVar1 != 0x2b) goto LAB_0053b67f;
  param_2 = param_2 + 1;
  uVar5 = uVar5 - 1;
LAB_0053b67f:
  uVar4 = 0;
  if (uVar5 != 0) {
    do {
      iVar3 = _isdigit((uint)*param_2);
      if (iVar3 == 0) {
        return 0;
      }
      uVar1 = *param_2;
      uVar4 = uVar4 + 1;
      uVar2 = iVar6 * 5;
      param_2 = param_2 + 1;
      iVar6 = (uVar1 - 0x30) + iVar6 * 10;
      iVar3 = param_3;
    } while (uVar4 < uVar5);
  }
  *param_1 = iVar3 * iVar6;
  return CONCAT31((int3)(uVar2 >> 8),1);
}



============================================================
DISASSEMBLY
============================================================
0053b640 : PUSH EBP
0053b641 : MOV EBP,dword ptr [ESP + 0x10]
0053b645 : TEST EBP,EBP
0053b647 : JNZ 0x0053b64d
0053b649 : XOR AL,AL
0053b64b : POP EBP
0053b64c : RET
0053b64d : PUSH ESI
0053b64e : MOV ESI,dword ptr [ESP + 0x10]
0053b652 : MOVZX EAX,word ptr [ESI]
0053b655 : PUSH EDI
0053b656 : XOR EDI,EDI
0053b658 : MOV ECX,0x1
0053b65d : MOV dword ptr [ESP + 0x18],ECX
0053b661 : CMP AX,0x2d
0053b665 : JNZ 0x0053b675
0053b667 : MOV dword ptr [ESP + 0x18],0xffffffff
0053b66f : MOV ECX,dword ptr [ESP + 0x18]
0053b673 : JMP 0x0053b67b
0053b675 : CMP AX,0x2b
0053b679 : JNZ 0x0053b67f
0053b67b : ADD ESI,0x2
0053b67e : DEC EBP
0053b67f : PUSH EBX
0053b680 : XOR EBX,EBX
0053b682 : TEST EBP,EBP
0053b684 : JBE 0x0053b6ac
0053b686 : MOVZX EAX,word ptr [ESI]
0053b689 : PUSH EAX
0053b68a : CALL 0x006397a2
0053b68f : ADD ESP,0x4
0053b692 : TEST EAX,EAX
0053b694 : JZ 0x0053b6bc
0053b696 : MOVZX ECX,word ptr [ESI]
0053b699 : INC EBX
0053b69a : LEA EAX,[EDI + EDI*0x4]
0053b69d : ADD ESI,0x2
0053b6a0 : LEA EDI,[ECX + EAX*0x2 + -0x30]
0053b6a4 : CMP EBX,EBP
0053b6a6 : JC 0x0053b686
0053b6a8 : MOV ECX,dword ptr [ESP + 0x1c]
0053b6ac : MOV EDX,dword ptr [ESP + 0x14]
0053b6b0 : IMUL ECX,EDI
0053b6b3 : POP EBX
0053b6b4 : POP EDI
0053b6b5 : POP ESI
0053b6b6 : MOV dword ptr [EDX],ECX
0053b6b8 : MOV AL,0x1
0053b6ba : POP EBP
0053b6bb : RET
0053b6bc : POP EBX
0053b6bd : POP EDI
0053b6be : POP ESI
0053b6bf : XOR AL,AL
0053b6c1 : POP EBP
0053b6c2 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_007c48b0
ENTRY    : 007c48b0
BODY     : [[007c48b0, 007c4b90]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007c48b0(void)

{
  uint uVar1;
  int *piVar2;
  int iVar3;
  int in_ECX;
  int in_EDX;
  int iVar4;
  undefined1 auStack_64 [4];
  LPCRITICAL_SECTION local_60;
  char *local_5c;
  undefined4 local_58;
  int local_54;
  undefined4 local_50;
  int local_4c;
  int local_48;
  int local_44;
  int local_40 [3];
  undefined2 local_34;
  undefined4 local_24;
  uint local_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  int local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b4d67c;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_64;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xffffff90;
  ExceptionList = &local_14;
  iVar4 = 0;
  if (*(int *)(in_ECX + 0xd0) != 0) {
    local_44 = in_EDX;
    local_40[0] = InterlockedIncrement((LONG *)(in_ECX + 0xd8));
    piVar2 = (int *)(in_EDX + 4);
    if (7 < *(uint *)(in_EDX + 0x18)) {
      piVar2 = (int *)*piVar2;
    }
    FUN_00404750(L"%s_%d",piVar2,local_40[0],uVar1);
    local_c = 0;
    local_4c = FUN_006f0760(0x2f0,".\\Frk\\FrkMgr.cpp",0x5d,0);
    local_c._0_1_ = 1;
    if (local_4c == 0) {
      piVar2 = (int *)0x0;
    }
    else {
      piVar2 = (int *)FUN_00796900(local_4c);
    }
    local_c._0_1_ = 0;
    local_4c = FUN_006f0760(0x268,"",0,(DAT_01725270 >> 3 & 1) == 0);
    local_c._0_1_ = 2;
    if (local_4c != 0) {
      iVar4 = FUN_0075b730(local_4c);
    }
    local_c._0_1_ = 0;
    local_60 = (LPCRITICAL_SECTION)(in_ECX + 0xf8);
    local_54 = 0;
    local_5c = ".\\Frk\\FrkMgr.cpp";
    local_58 = 0x62;
    local_50 = 1;
    FUN_006ef1a0(&local_60);
    local_c._0_1_ = 3;
    local_4c = *(int *)(in_ECX + 0xd0);
    if (*(uint *)(local_44 + 0x18) < 8) {
      iVar3 = local_44 + 4;
    }
    else {
      iVar3 = *(int *)(local_44 + 4);
    }
    FUN_0070cf00(iVar3);
    iVar3 = FUN_0075bec0(iVar4,local_4c);
    if (iVar3 == -1) {
      if (iVar4 != 0) {
        FUN_0075b440(iVar4);
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      piVar2[0x5f] = 0;
      FUN_007958c0();
      (**(code **)(*piVar2 + 0x18))(1);
      local_c = (uint)local_c._1_3_ << 8;
      if (local_54 != 0) {
        LeaveCriticalSection(local_60);
        local_54 = 0;
      }
      local_c = 0xffffffff;
      if (7 < local_20) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
    }
    else {
      local_c._0_1_ = 0;
      if (local_54 != 0) {
        LeaveCriticalSection(local_60);
        local_54 = 0;
      }
      FUN_00405eb0(local_44,0,0xffffffff);
      piVar2[0x62] = local_40[0];
      FUN_007958c0();
      FUN_00795f50();
      local_60 = (LPCRITICAL_SECTION)(in_ECX + 0x114);
      local_54 = 0;
      local_5c = ".\\Frk\\FrkMgr.cpp";
      local_58 = 0x72;
      local_50 = 1;
      FUN_006ef1a0(&local_60);
      local_c._0_1_ = 4;
      local_4c = local_40[0];
      local_48 = iVar4;
      FUN_00451e00(local_40,&local_4c);
      local_c = (uint)local_c._1_3_ << 8;
      if (local_54 != 0) {
        LeaveCriticalSection(local_60);
        local_54 = 0;
      }
      local_c = 0xffffffff;
      if (7 < local_20) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
    }
    local_34 = 0;
    local_24 = 0;
    local_20 = 7;
  }
  local_c = 0xffffffff;
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_64);
  return;
}



============================================================
DISASSEMBLY
============================================================
007c48b0 : PUSH EBP
007c48b1 : MOV EBP,ESP
007c48b3 : AND ESP,0xfffffff8
007c48b6 : PUSH -0x1
007c48b8 : PUSH 0xb4d67c
007c48bd : MOV EAX,FS:[0x0]
007c48c3 : PUSH EAX
007c48c4 : SUB ESP,0x50
007c48c7 : MOV EAX,[0x00d66fa0]
007c48cc : XOR EAX,ESP
007c48ce : MOV dword ptr [ESP + 0x48],EAX
007c48d2 : PUSH EBX
007c48d3 : PUSH ESI
007c48d4 : PUSH EDI
007c48d5 : MOV EAX,[0x00d66fa0]
007c48da : XOR EAX,ESP
007c48dc : PUSH EAX
007c48dd : LEA EAX,[ESP + 0x60]
007c48e1 : MOV FS:[0x0],EAX
007c48e7 : MOV EDI,ECX
007c48e9 : XOR EBX,EBX
007c48eb : MOV ESI,EDX
007c48ed : MOV dword ptr [ESP + 0x30],ESI
007c48f1 : CMP dword ptr [EDI + 0xd0],EBX
007c48f7 : JNZ 0x007c4900
007c48f9 : XOR EAX,EAX
007c48fb : JMP 0x007c4b73
007c4900 : LEA EAX,[EDI + 0xd8]
007c4906 : PUSH EAX
007c4907 : CALL dword ptr [0x00b850dc]
007c490d : CMP dword ptr [ESI + 0x18],0x8
007c4911 : MOV dword ptr [ESP + 0x34],EAX
007c4915 : LEA ECX,[ESI + 0x4]
007c4918 : JC 0x007c491c
007c491a : MOV ECX,dword ptr [ECX]
007c491c : PUSH EAX
007c491d : PUSH ECX
007c491e : PUSH 0xc1c458
007c4923 : LEA ESI,[ESP + 0x48]
007c4927 : CALL 0x00404750
007c492c : ADD ESP,0xc
007c492f : MOV dword ptr [ESP + 0x68],EBX
007c4933 : PUSH EBX
007c4934 : PUSH 0x5d
007c4936 : PUSH 0xc1c464
007c493b : PUSH 0x2f0
007c4940 : CALL 0x006f0760
007c4945 : ADD ESP,0x10
007c4948 : MOV dword ptr [ESP + 0x28],EAX
007c494c : MOV byte ptr [ESP + 0x68],0x1
007c4951 : CMP EAX,EBX
007c4953 : JZ 0x007c4961
007c4955 : PUSH EAX
007c4956 : MOV EDX,ESI
007c4958 : CALL 0x00796900
007c495d : MOV ESI,EAX
007c495f : JMP 0x007c4963
007c4961 : XOR ESI,ESI
007c4963 : MOV byte ptr [ESP + 0x68],0x0
007c4968 : MOV ECX,dword ptr [0x01725270]
007c496e : SHR ECX,0x3
007c4971 : MOV EDX,0x0
007c4976 : AND ECX,0x1
007c4979 : SETZ DL
007c497c : PUSH EDX
007c497d : PUSH EBX
007c497e : PUSH 0xbf1a4a
007c4983 : PUSH 0x268
007c4988 : CALL 0x006f0760
007c498d : ADD ESP,0x10
007c4990 : MOV dword ptr [ESP + 0x28],EAX
007c4994 : MOV byte ptr [ESP + 0x68],0x2
007c4999 : CMP EAX,EBX
007c499b : JZ 0x007c49a7
007c499d : PUSH EAX
007c499e : MOV ECX,ESI
007c49a0 : CALL 0x0075b730
007c49a5 : MOV EBX,EAX
007c49a7 : MOV byte ptr [ESP + 0x68],0x0
007c49ac : LEA ECX,[ESP + 0x14]
007c49b0 : LEA EAX,[EDI + 0xf8]
007c49b6 : PUSH ECX
007c49b7 : MOV dword ptr [ESP + 0x24],0x0
007c49bf : MOV dword ptr [ESP + 0x18],EAX
007c49c3 : MOV dword ptr [ESP + 0x1c],0xc1c48c
007c49cb : MOV dword ptr [ESP + 0x20],0x62
007c49d3 : MOV dword ptr [ESP + 0x28],0x1
007c49db : CALL 0x006ef1a0
007c49e0 : MOV byte ptr [ESP + 0x68],0x3
007c49e5 : MOV EAX,dword ptr [ESP + 0x30]
007c49e9 : CMP dword ptr [EAX + 0x18],0x8
007c49ed : MOV EDX,dword ptr [EDI + 0xd0]
007c49f3 : MOV dword ptr [ESP + 0x28],EDX
007c49f7 : JC 0x007c4a00
007c49f9 : ADD EAX,0x4
007c49fc : MOV EAX,dword ptr [EAX]
007c49fe : JMP 0x007c4a03
007c4a00 : ADD EAX,0x4
007c4a03 : PUSH EAX
007c4a04 : CALL 0x0070cf00
007c4a09 : MOV ECX,dword ptr [ESP + 0x2c]
007c4a0d : ADD ESP,0x4
007c4a10 : PUSH ECX
007c4a11 : PUSH EBX
007c4a12 : MOV ECX,EAX
007c4a14 : CALL 0x0075bec0
007c4a19 : CMP EAX,-0x1
007c4a1c : JNZ 0x007c4a87
007c4a1e : XOR EDI,EDI
007c4a20 : CMP EBX,EDI
007c4a22 : JZ 0x007c4a31
007c4a24 : PUSH EBX
007c4a25 : CALL 0x0075b440
007c4a2a : MOV ECX,EBX
007c4a2c : CALL 0x006f04e0
007c4a31 : MOV dword ptr [ESI + 0x17c],EDI
007c4a37 : CALL 0x007958c0
007c4a3c : MOV EDX,dword ptr [ESI]
007c4a3e : MOV EAX,dword ptr [EDX + 0x18]
007c4a41 : PUSH 0x1
007c4a43 : MOV ECX,ESI
007c4a45 : CALL EAX
007c4a47 : MOV byte ptr [ESP + 0x68],0x0
007c4a4c : CMP dword ptr [ESP + 0x20],EDI
007c4a50 : JZ 0x007c4a61
007c4a52 : MOV ECX,dword ptr [ESP + 0x14]
007c4a56 : PUSH ECX
007c4a57 : CALL dword ptr [0x00b8511c]
007c4a5d : MOV dword ptr [ESP + 0x20],EDI
007c4a61 : MOV dword ptr [ESP + 0x68],0xffffffff
007c4a69 : CMP dword ptr [ESP + 0x54],0x8
007c4a6e : JC 0x007c4a79
007c4a70 : MOV ECX,dword ptr [ESP + 0x40]
007c4a74 : CALL 0x006f04e0
007c4a79 : XOR EDX,EDX
007c4a7b : MOV word ptr [ESP + 0x40],DX
007c4a80 : XOR EAX,EAX
007c4a82 : JMP 0x007c4b67
007c4a87 : MOV byte ptr [ESP + 0x68],0x0
007c4a8c : CMP dword ptr [ESP + 0x20],0x0
007c4a91 : JZ 0x007c4aa6
007c4a93 : MOV EAX,dword ptr [ESP + 0x14]
007c4a97 : PUSH EAX
007c4a98 : CALL dword ptr [0x00b8511c]
007c4a9e : MOV dword ptr [ESP + 0x20],0x0
007c4aa6 : MOV ECX,dword ptr [ESP + 0x30]
007c4aaa : PUSH -0x1
007c4aac : PUSH 0x0
007c4aae : PUSH ECX
007c4aaf : LEA ECX,[ESI + 0x18c]
007c4ab5 : CALL 0x00405eb0
007c4aba : MOV EDX,dword ptr [ESP + 0x34]
007c4abe : MOV dword ptr [ESI + 0x188],EDX
007c4ac4 : CALL 0x007958c0
007c4ac9 : MOV EAX,ESI
007c4acb : CALL 0x00795f50
007c4ad0 : LEA ECX,[ESP + 0x14]
007c4ad4 : LEA EAX,[EDI + 0x114]
007c4ada : PUSH ECX
007c4adb : MOV dword ptr [ESP + 0x24],0x0
007c4ae3 : MOV dword ptr [ESP + 0x18],EAX
007c4ae7 : MOV dword ptr [ESP + 0x1c],0xc1c4a0
007c4aef : MOV dword ptr [ESP + 0x20],0x72
007c4af7 : MOV dword ptr [ESP + 0x28],0x1
007c4aff : CALL 0x006ef1a0
007c4b04 : MOV byte ptr [ESP + 0x68],0x4
007c4b09 : MOV EDX,dword ptr [ESP + 0x34]
007c4b0d : LEA EAX,[ESP + 0x28]
007c4b11 : PUSH EAX
007c4b12 : LEA ECX,[ESP + 0x38]
007c4b16 : PUSH ECX
007c4b17 : LEA EAX,[EDI + 0xdc]
007c4b1d : MOV dword ptr [ESP + 0x30],EDX
007c4b21 : MOV dword ptr [ESP + 0x34],EBX
007c4b25 : CALL 0x00451e00
007c4b2a : MOV byte ptr [ESP + 0x68],0x0
007c4b2f : XOR EDI,EDI
007c4b31 : CMP dword ptr [ESP + 0x20],EDI
007c4b35 : JZ 0x007c4b46
007c4b37 : MOV EDX,dword ptr [ESP + 0x14]
007c4b3b : PUSH EDX
007c4b3c : CALL dword ptr [0x00b8511c]
007c4b42 : MOV dword ptr [ESP + 0x20],EDI
007c4b46 : MOV dword ptr [ESP + 0x68],0xffffffff
007c4b4e : CMP dword ptr [ESP + 0x54],0x8
007c4b53 : JC 0x007c4b5e
007c4b55 : MOV ECX,dword ptr [ESP + 0x40]
007c4b59 : CALL 0x006f04e0
007c4b5e : XOR EAX,EAX
007c4b60 : MOV word ptr [ESP + 0x40],AX
007c4b65 : MOV EAX,ESI
007c4b67 : MOV dword ptr [ESP + 0x50],EDI
007c4b6b : MOV dword ptr [ESP + 0x54],0x7
007c4b73 : MOV ECX,dword ptr [ESP + 0x60]
007c4b77 : MOV dword ptr FS:[0x0],ECX
007c4b7e : POP ECX
007c4b7f : POP EDI
007c4b80 : POP ESI
007c4b81 : POP EBX
007c4b82 : MOV ECX,dword ptr [ESP + 0x48]
007c4b86 : XOR ECX,ESP
007c4b88 : CALL 0x00633e6b
007c4b8d : MOV ESP,EBP
007c4b8f : POP EBP
007c4b90 : RET

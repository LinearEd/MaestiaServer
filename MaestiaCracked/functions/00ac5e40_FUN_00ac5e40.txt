PROGRAM  : Maestia.exe
FUNCTION : FUN_00ac5e40
ENTRY    : 00ac5e40
BODY     : [[00ac5e40, 00ac637a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00ac5e40(void)

{
  short sVar1;
  uint uVar2;
  int iVar3;
  LPCWSTR pWVar4;
  HANDLE hObject;
  short *psVar5;
  wchar_t *pwVar6;
  int in_ECX;
  short *psVar7;
  undefined1 local_f0 [4];
  undefined2 local_ec;
  undefined4 local_dc;
  uint local_d8;
  undefined **local_d4;
  undefined1 local_d0;
  undefined4 local_cc;
  undefined4 local_c8;
  FILE *local_c4;
  undefined1 local_c0 [4];
  undefined4 local_bc;
  undefined4 local_ac;
  uint local_a8;
  char local_a1;
  undefined1 local_a0 [4];
  undefined2 local_9c;
  undefined4 local_8c;
  uint local_88;
  undefined4 local_80;
  undefined4 local_70;
  uint local_6c;
  undefined1 local_68 [4];
  undefined4 local_64;
  undefined4 local_54;
  uint local_50;
  undefined1 local_4c [4];
  undefined4 local_48;
  undefined4 local_38;
  uint local_34;
  undefined1 local_30 [4];
  undefined4 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b22a42;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_14 = uVar2;
  FUN_008b6db0(DAT_017248c8,local_a0);
  local_8 = 0;
  FUN_00403510(local_30,uVar2);
  local_8._0_1_ = 1;
  FUN_00403510(local_68);
  local_8 = CONCAT31(local_8._1_3_,2);
  pWVar4 = local_2c;
  if (local_18 < 8) {
    pWVar4 = (LPCWSTR)&local_2c;
  }
  SetFileAttributesW(pWVar4,0x80);
  pwVar6 = local_2c;
  if (local_18 < 8) {
    pwVar6 = (wchar_t *)&local_2c;
  }
  iVar3 = FID_conflict___access(pwVar6,0);
  if (iVar3 == 0) {
    while( true ) {
      pWVar4 = local_2c;
      if (local_18 < 8) {
        pWVar4 = (LPCWSTR)&local_2c;
      }
      iVar3 = FUN_0063829d(pWVar4);
      if (iVar3 == 0) break;
      Sleep(1);
    }
  }
  pwVar6 = local_64;
  if (local_50 < 8) {
    pwVar6 = (wchar_t *)&local_64;
  }
  iVar3 = FID_conflict___access(pwVar6,0);
  if (iVar3 == 0) {
    while( true ) {
      pWVar4 = local_2c;
      if (local_18 < 8) {
        pWVar4 = (LPCWSTR)&local_2c;
      }
      pwVar6 = local_64;
      if (local_50 < 8) {
        pwVar6 = (wchar_t *)&local_64;
      }
      iVar3 = FUN_006382cd(pwVar6,pWVar4);
      if (iVar3 == 0) break;
      Sleep(1);
    }
  }
  if (*(uint *)(in_ECX + 0x20) < 8) {
    iVar3 = in_ECX + 0xc;
  }
  else {
    iVar3 = *(int *)(in_ECX + 0xc);
  }
  FUN_00404750(L"version.%d.%s",*(undefined4 *)(in_ECX + 4),iVar3);
  local_8._0_1_ = 3;
  FUN_008b6db0(DAT_017248c8,local_f0);
  local_8._0_1_ = 4;
  FUN_00403510(local_c0);
  local_8._0_1_ = 5;
  FUN_00403510(local_4c);
  local_8 = CONCAT31(local_8._1_3_,7);
  if (7 < local_a8) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_a8 = 7;
  local_ac = 0;
  local_bc._0_2_ = L'\0';
  local_8._0_1_ = 8;
  if (7 < local_d8) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_d8 = 7;
  local_dc = 0;
  local_ec = 0;
  pWVar4 = local_48;
  if (local_34 < 8) {
    pWVar4 = (LPCWSTR)&local_48;
  }
  SetFileAttributesW(pWVar4,0x80);
  pWVar4 = local_48;
  if (local_34 < 8) {
    pWVar4 = (LPCWSTR)&local_48;
  }
  hObject = CreateFileW(pWVar4,0x40000000,0,(LPSECURITY_ATTRIBUTES)0x0,2,0x80,(HANDLE)0x0);
  if (hObject == (HANDLE)0xffffffff) {
    local_8 = CONCAT31(local_8._1_3_,3);
    if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_34 = 7;
    local_38 = 0;
    local_48 = (LPCWSTR)((uint)local_48 & 0xffff0000);
    local_8 = CONCAT31(local_8._1_3_,2);
    if (7 < local_6c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_6c = 7;
    local_70 = 0;
    local_80 = (short *)((uint)local_80 & 0xffff0000);
    local_8 = CONCAT31(local_8._1_3_,1);
    if (7 < local_50) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_50 = 7;
    local_54 = 0;
    local_64 = (wchar_t *)((uint)local_64 & 0xffff0000);
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c = (LPCWSTR)((uint)local_2c & 0xffff0000);
    local_8 = 0xffffffff;
    if (7 < local_88) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  else {
    CloseHandle(hObject);
    local_d0 = 0;
    local_cc = 0;
    local_c8 = 0;
    local_d4 = &PTR_FUN_00cda538;
    local_c4 = (FILE *)0x0;
    local_8._0_1_ = 9;
    local_bc._0_2_ = L'\0';
    local_a8 = 7;
    local_ac = 0;
    FUN_00406360(&PTR_LAB_00c94db8,2);
    local_8._0_1_ = 10;
    local_a1 = FUN_0070a9a0(local_4c,local_c0);
    local_8._0_1_ = 9;
    if (7 < local_a8) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    if (local_a1 != '\0') {
      psVar7 = local_80;
      if (local_6c < 8) {
        psVar7 = (short *)&local_80;
      }
      local_bc = (wchar_t *)((uint)local_bc._2_2_ << 0x10);
      local_a8 = 7;
      local_ac = 0;
      psVar5 = psVar7;
      do {
        sVar1 = *psVar5;
        psVar5 = psVar5 + 1;
      } while (sVar1 != 0);
      FUN_00406360(psVar7,(int)psVar5 - (int)(psVar7 + 1) >> 1);
      local_8._0_1_ = 0xb;
      pwVar6 = local_bc;
      if (local_a8 < 8) {
        pwVar6 = (wchar_t *)&local_bc;
      }
      _fputws(pwVar6,local_c4);
      _fputwc(L'\0',local_c4);
      local_8._0_1_ = 9;
      if (7 < local_a8) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
    }
    local_8._0_1_ = 9;
    local_bc._0_2_ = L'\0';
    local_a8 = 7;
    local_ac = 0;
    if (local_c4 != (FILE *)0x0) {
      _fflush(local_c4);
      _fclose(local_c4);
      local_c4 = (FILE *)0x0;
    }
    local_8._0_1_ = 8;
    local_d4 = &PTR_FUN_00cda538;
    if (local_c4 != (FILE *)0x0) {
      _fflush(local_c4);
      _fclose(local_c4);
      local_c4 = (FILE *)0x0;
    }
    local_8 = CONCAT31(local_8._1_3_,3);
    if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_34 = 7;
    local_38 = 0;
    local_48 = (LPCWSTR)((uint)local_48._2_2_ << 0x10);
    local_8 = CONCAT31(local_8._1_3_,2);
    if (7 < local_6c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_6c = 7;
    local_70 = 0;
    local_80 = (short *)((uint)local_80._2_2_ << 0x10);
    local_8 = CONCAT31(local_8._1_3_,1);
    if (7 < local_50) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_50 = 7;
    local_54 = 0;
    local_64 = (wchar_t *)((uint)local_64._2_2_ << 0x10);
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c = (LPCWSTR)((uint)local_2c._2_2_ << 0x10);
    local_8 = 0xffffffff;
    if (7 < local_88) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  local_8 = 0xffffffff;
  local_18 = 7;
  local_1c = 0;
  local_34 = 7;
  local_38 = 0;
  local_50 = 7;
  local_54 = 0;
  local_6c = 7;
  local_70 = 0;
  local_9c = 0;
  local_8c = 0;
  local_88 = 7;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00ac5e40 : PUSH EBP
00ac5e41 : MOV EBP,ESP
00ac5e43 : PUSH -0x1
00ac5e45 : PUSH 0xb22a42
00ac5e4a : MOV EAX,FS:[0x0]
00ac5e50 : PUSH EAX
00ac5e51 : SUB ESP,0xe0
00ac5e57 : MOV EAX,[0x00d66fa0]
00ac5e5c : XOR EAX,EBP
00ac5e5e : MOV dword ptr [EBP + -0x10],EAX
00ac5e61 : PUSH EBX
00ac5e62 : PUSH ESI
00ac5e63 : PUSH EDI
00ac5e64 : PUSH EAX
00ac5e65 : LEA EAX,[EBP + -0xc]
00ac5e68 : MOV FS:[0x0],EAX
00ac5e6e : LEA EAX,[EBP + 0xffffff64]
00ac5e74 : MOV ESI,ECX
00ac5e76 : MOV ECX,dword ptr [0x017248c8]
00ac5e7c : PUSH EAX
00ac5e7d : PUSH ECX
00ac5e7e : CALL 0x008b6db0
00ac5e83 : XOR EBX,EBX
00ac5e85 : MOV dword ptr [EBP + -0x4],EBX
00ac5e88 : LEA EDX,[EBP + -0x2c]
00ac5e8b : PUSH EDX
00ac5e8c : MOV EDX,0xc94d20
00ac5e91 : LEA ECX,[EBP + 0xffffff64]
00ac5e97 : CALL 0x00403510
00ac5e9c : MOV byte ptr [EBP + -0x4],0x1
00ac5ea0 : LEA EAX,[EBP + -0x64]
00ac5ea3 : PUSH EAX
00ac5ea4 : MOV EDX,0xc94d48
00ac5ea9 : LEA ECX,[EBP + 0xffffff64]
00ac5eaf : CALL 0x00403510
00ac5eb4 : ADD ESP,0x8
00ac5eb7 : MOV byte ptr [EBP + -0x4],0x2
00ac5ebb : MOV EAX,dword ptr [EBP + -0x28]
00ac5ebe : MOV EDI,0x8
00ac5ec3 : CMP dword ptr [EBP + -0x14],EDI
00ac5ec6 : JNC 0x00ac5ecb
00ac5ec8 : LEA EAX,[EBP + -0x28]
00ac5ecb : PUSH 0x80
00ac5ed0 : PUSH EAX
00ac5ed1 : CALL dword ptr [0x00b851c4]
00ac5ed7 : MOV EAX,dword ptr [EBP + -0x28]
00ac5eda : CMP dword ptr [EBP + -0x14],EDI
00ac5edd : JNC 0x00ac5ee2
00ac5edf : LEA EAX,[EBP + -0x28]
00ac5ee2 : PUSH EBX
00ac5ee3 : PUSH EAX
00ac5ee4 : CALL 0x00638285
00ac5ee9 : MOV EDI,dword ptr [0x00b8510c]
00ac5eef : ADD ESP,0x8
00ac5ef2 : TEST EAX,EAX
00ac5ef4 : JNZ 0x00ac5f15
00ac5ef6 : CMP dword ptr [EBP + -0x14],0x8
00ac5efa : MOV EAX,dword ptr [EBP + -0x28]
00ac5efd : JNC 0x00ac5f02
00ac5eff : LEA EAX,[EBP + -0x28]
00ac5f02 : PUSH EAX
00ac5f03 : CALL 0x0063829d
00ac5f08 : ADD ESP,0x4
00ac5f0b : TEST EAX,EAX
00ac5f0d : JZ 0x00ac5f15
00ac5f0f : PUSH 0x1
00ac5f11 : CALL EDI
00ac5f13 : JMP 0x00ac5ef6
00ac5f15 : CMP dword ptr [EBP + -0x4c],0x8
00ac5f19 : MOV EAX,dword ptr [EBP + -0x60]
00ac5f1c : JNC 0x00ac5f21
00ac5f1e : LEA EAX,[EBP + -0x60]
00ac5f21 : PUSH EBX
00ac5f22 : PUSH EAX
00ac5f23 : CALL 0x00638285
00ac5f28 : ADD ESP,0x8
00ac5f2b : TEST EAX,EAX
00ac5f2d : JNZ 0x00ac5f5f
00ac5f2f : NOP
00ac5f30 : MOV ECX,dword ptr [EBP + -0x28]
00ac5f33 : MOV EAX,0x8
00ac5f38 : CMP dword ptr [EBP + -0x14],EAX
00ac5f3b : JNC 0x00ac5f40
00ac5f3d : LEA ECX,[EBP + -0x28]
00ac5f40 : CMP dword ptr [EBP + -0x4c],EAX
00ac5f43 : MOV EAX,dword ptr [EBP + -0x60]
00ac5f46 : JNC 0x00ac5f4b
00ac5f48 : LEA EAX,[EBP + -0x60]
00ac5f4b : PUSH ECX
00ac5f4c : PUSH EAX
00ac5f4d : CALL 0x006382cd
00ac5f52 : ADD ESP,0x8
00ac5f55 : TEST EAX,EAX
00ac5f57 : JZ 0x00ac5f5f
00ac5f59 : PUSH 0x1
00ac5f5b : CALL EDI
00ac5f5d : JMP 0x00ac5f30
00ac5f5f : MOV EDI,0x8
00ac5f64 : CMP dword ptr [ESI + 0x20],EDI
00ac5f67 : JC 0x00ac5f6e
00ac5f69 : MOV EAX,dword ptr [ESI + 0xc]
00ac5f6c : JMP 0x00ac5f71
00ac5f6e : LEA EAX,[ESI + 0xc]
00ac5f71 : MOV ECX,dword ptr [ESI + 0x4]
00ac5f74 : PUSH EAX
00ac5f75 : PUSH ECX
00ac5f76 : PUSH 0xc94d70
00ac5f7b : LEA ESI,[EBP + -0x80]
00ac5f7e : CALL 0x00404750
00ac5f83 : ADD ESP,0xc
00ac5f86 : MOV byte ptr [EBP + -0x4],0x3
00ac5f8a : MOV EAX,[0x017248c8]
00ac5f8f : LEA EDX,[EBP + 0xffffff14]
00ac5f95 : PUSH EDX
00ac5f96 : PUSH EAX
00ac5f97 : CALL 0x008b6db0
00ac5f9c : MOV byte ptr [EBP + -0x4],0x4
00ac5fa0 : LEA ECX,[EBP + 0xffffff44]
00ac5fa6 : PUSH ECX
00ac5fa7 : MOV EDX,0xc94da8
00ac5fac : MOV ECX,EAX
00ac5fae : CALL 0x00403510
00ac5fb3 : MOV byte ptr [EBP + -0x4],0x5
00ac5fb7 : LEA EDX,[EBP + -0x48]
00ac5fba : PUSH EDX
00ac5fbb : MOV EDX,0xc94d8c
00ac5fc0 : MOV ECX,EAX
00ac5fc2 : CALL 0x00403510
00ac5fc7 : ADD ESP,0x8
00ac5fca : MOV byte ptr [EBP + -0x4],0x7
00ac5fce : CMP dword ptr [EBP + 0xffffff5c],EDI
00ac5fd4 : JC 0x00ac5fe1
00ac5fd6 : MOV ECX,dword ptr [EBP + 0xffffff48]
00ac5fdc : CALL 0x006f04e0
00ac5fe1 : MOV EDI,0x7
00ac5fe6 : XOR EAX,EAX
00ac5fe8 : MOV dword ptr [EBP + 0xffffff5c],EDI
00ac5fee : MOV dword ptr [EBP + 0xffffff58],EBX
00ac5ff4 : MOV word ptr [EBP + 0xffffff48],AX
00ac5ffb : MOV byte ptr [EBP + -0x4],0x8
00ac5fff : MOV ESI,0x8
00ac6004 : CMP dword ptr [EBP + 0xffffff2c],ESI
00ac600a : JC 0x00ac6017
00ac600c : MOV ECX,dword ptr [EBP + 0xffffff18]
00ac6012 : CALL 0x006f04e0
00ac6017 : MOV EAX,dword ptr [EBP + -0x44]
00ac601a : XOR ECX,ECX
00ac601c : MOV dword ptr [EBP + 0xffffff2c],EDI
00ac6022 : MOV dword ptr [EBP + 0xffffff28],EBX
00ac6028 : MOV word ptr [EBP + 0xffffff18],CX
00ac602f : CMP dword ptr [EBP + -0x30],ESI
00ac6032 : JNC 0x00ac6037
00ac6034 : LEA EAX,[EBP + -0x44]
00ac6037 : PUSH 0x80
00ac603c : PUSH EAX
00ac603d : CALL dword ptr [0x00b851c4]
00ac6043 : MOV EAX,dword ptr [EBP + -0x44]
00ac6046 : CMP dword ptr [EBP + -0x30],ESI
00ac6049 : JNC 0x00ac604e
00ac604b : LEA EAX,[EBP + -0x44]
00ac604e : PUSH EBX
00ac604f : PUSH 0x80
00ac6054 : PUSH 0x2
00ac6056 : PUSH EBX
00ac6057 : PUSH EBX
00ac6058 : PUSH 0x40000000
00ac605d : PUSH EAX
00ac605e : CALL dword ptr [0x00b85164]
00ac6064 : CMP EAX,-0x1
00ac6067 : JNZ 0x00ac6108
00ac606d : MOV byte ptr [EBP + -0x4],0x3
00ac6071 : CMP dword ptr [EBP + -0x30],ESI
00ac6074 : JC 0x00ac607e
00ac6076 : MOV ECX,dword ptr [EBP + -0x44]
00ac6079 : CALL 0x006f04e0
00ac607e : XOR EDX,EDX
00ac6080 : MOV dword ptr [EBP + -0x30],EDI
00ac6083 : MOV dword ptr [EBP + -0x34],EBX
00ac6086 : MOV word ptr [EBP + -0x44],DX
00ac608a : MOV byte ptr [EBP + -0x4],0x2
00ac608e : CMP dword ptr [EBP + -0x68],ESI
00ac6091 : JC 0x00ac609b
00ac6093 : MOV ECX,dword ptr [EBP + -0x7c]
00ac6096 : CALL 0x006f04e0
00ac609b : XOR EAX,EAX
00ac609d : MOV dword ptr [EBP + -0x68],EDI
00ac60a0 : MOV dword ptr [EBP + -0x6c],EBX
00ac60a3 : MOV word ptr [EBP + -0x7c],AX
00ac60a7 : MOV byte ptr [EBP + -0x4],0x1
00ac60ab : CMP dword ptr [EBP + -0x4c],ESI
00ac60ae : JC 0x00ac60b8
00ac60b0 : MOV ECX,dword ptr [EBP + -0x60]
00ac60b3 : CALL 0x006f04e0
00ac60b8 : XOR ECX,ECX
00ac60ba : MOV dword ptr [EBP + -0x4c],EDI
00ac60bd : MOV dword ptr [EBP + -0x50],EBX
00ac60c0 : MOV word ptr [EBP + -0x60],CX
00ac60c4 : MOV byte ptr [EBP + -0x4],BL
00ac60c7 : CMP dword ptr [EBP + -0x14],ESI
00ac60ca : JC 0x00ac60d4
00ac60cc : MOV ECX,dword ptr [EBP + -0x28]
00ac60cf : CALL 0x006f04e0
00ac60d4 : XOR EDX,EDX
00ac60d6 : MOV dword ptr [EBP + -0x14],EDI
00ac60d9 : MOV dword ptr [EBP + -0x18],EBX
00ac60dc : MOV word ptr [EBP + -0x28],DX
00ac60e0 : MOV dword ptr [EBP + -0x4],0xffffffff
00ac60e7 : CMP dword ptr [EBP + 0xffffff7c],ESI
00ac60ed : JC 0x00ac60fa
00ac60ef : MOV ECX,dword ptr [EBP + 0xffffff68]
00ac60f5 : CALL 0x006f04e0
00ac60fa : XOR EAX,EAX
00ac60fc : MOV word ptr [EBP + 0xffffff68],AX
00ac6103 : JMP 0x00ac6353
00ac6108 : PUSH EAX
00ac6109 : CALL dword ptr [0x00b85104]
00ac610f : MOV dword ptr [EBP + 0xffffff30],0xcd4c80
00ac6119 : MOV byte ptr [EBP + 0xffffff34],BL
00ac611f : MOV dword ptr [EBP + 0xffffff38],EBX
00ac6125 : MOV dword ptr [EBP + 0xffffff3c],EBX
00ac612b : MOV dword ptr [EBP + 0xffffff30],0xcda538
00ac6135 : MOV dword ptr [EBP + 0xffffff40],EBX
00ac613b : MOV byte ptr [EBP + -0x4],0x9
00ac613f : XOR ECX,ECX
00ac6141 : PUSH 0x2
00ac6143 : MOV word ptr [EBP + 0xffffff48],CX
00ac614a : PUSH 0xc94db8
00ac614f : LEA ECX,[EBP + 0xffffff44]
00ac6155 : MOV dword ptr [EBP + 0xffffff5c],EDI
00ac615b : MOV dword ptr [EBP + 0xffffff58],EBX
00ac6161 : CALL 0x00406360
00ac6166 : MOV byte ptr [EBP + -0x4],0xa
00ac616a : LEA EDX,[EBP + 0xffffff44]
00ac6170 : PUSH EDX
00ac6171 : LEA EAX,[EBP + -0x48]
00ac6174 : PUSH EAX
00ac6175 : LEA ECX,[EBP + 0xffffff30]
00ac617b : CALL 0x0070a9a0
00ac6180 : MOV byte ptr [EBP + 0xffffff63],AL
00ac6186 : MOV byte ptr [EBP + -0x4],0x9
00ac618a : CMP dword ptr [EBP + 0xffffff5c],ESI
00ac6190 : JC 0x00ac619d
00ac6192 : MOV ECX,dword ptr [EBP + 0xffffff48]
00ac6198 : CALL 0x006f04e0
00ac619d : XOR ECX,ECX
00ac619f : MOV dword ptr [EBP + 0xffffff5c],EDI
00ac61a5 : MOV dword ptr [EBP + 0xffffff58],EBX
00ac61ab : MOV word ptr [EBP + 0xffffff48],CX
00ac61b2 : CMP byte ptr [EBP + 0xffffff63],BL
00ac61b8 : JZ 0x00ac6265
00ac61be : MOV EDX,dword ptr [EBP + -0x7c]
00ac61c1 : CMP dword ptr [EBP + -0x68],ESI
00ac61c4 : JNC 0x00ac61c9
00ac61c6 : LEA EDX,[EBP + -0x7c]
00ac61c9 : XOR EAX,EAX
00ac61cb : MOV word ptr [EBP + 0xffffff48],AX
00ac61d2 : MOV EAX,EDX
00ac61d4 : MOV dword ptr [EBP + 0xffffff5c],EDI
00ac61da : MOV dword ptr [EBP + 0xffffff58],EBX
00ac61e0 : LEA ESI,[EAX + 0x2]
00ac61e3 : MOV CX,word ptr [EAX]
00ac61e6 : ADD EAX,0x2
00ac61e9 : CMP CX,BX
00ac61ec : JNZ 0x00ac61e3
00ac61ee : SUB EAX,ESI
00ac61f0 : SAR EAX,0x1
00ac61f2 : PUSH EAX
00ac61f3 : PUSH EDX
00ac61f4 : LEA ECX,[EBP + 0xffffff44]
00ac61fa : CALL 0x00406360
00ac61ff : MOV byte ptr [EBP + -0x4],0xb
00ac6203 : MOV EAX,dword ptr [EBP + 0xffffff48]
00ac6209 : MOV ESI,0x8
00ac620e : CMP dword ptr [EBP + 0xffffff5c],ESI
00ac6214 : JNC 0x00ac621c
00ac6216 : LEA EAX,[EBP + 0xffffff48]
00ac621c : MOV ECX,dword ptr [EBP + 0xffffff40]
00ac6222 : PUSH ECX
00ac6223 : PUSH EAX
00ac6224 : CALL 0x0063e64e
00ac6229 : MOV EDX,dword ptr [EBP + 0xffffff40]
00ac622f : PUSH EDX
00ac6230 : PUSH EBX
00ac6231 : CALL 0x0063e5d5
00ac6236 : ADD ESP,0x10
00ac6239 : MOV byte ptr [EBP + -0x4],0x9
00ac623d : CMP dword ptr [EBP + 0xffffff5c],ESI
00ac6243 : JC 0x00ac6250
00ac6245 : MOV ECX,dword ptr [EBP + 0xffffff48]
00ac624b : CALL 0x006f04e0
00ac6250 : XOR EAX,EAX
00ac6252 : MOV dword ptr [EBP + 0xffffff5c],EDI
00ac6258 : MOV dword ptr [EBP + 0xffffff58],EBX
00ac625e : MOV word ptr [EBP + 0xffffff48],AX
00ac6265 : MOV EAX,dword ptr [EBP + 0xffffff40]
00ac626b : CMP EAX,EBX
00ac626d : JZ 0x00ac628a
00ac626f : PUSH EAX
00ac6270 : CALL 0x006395f7
00ac6275 : MOV ECX,dword ptr [EBP + 0xffffff40]
00ac627b : PUSH ECX
00ac627c : CALL 0x006366db
00ac6281 : ADD ESP,0x8
00ac6284 : MOV dword ptr [EBP + 0xffffff40],EBX
00ac628a : MOV byte ptr [EBP + -0x4],0x8
00ac628e : MOV EAX,dword ptr [EBP + 0xffffff40]
00ac6294 : MOV dword ptr [EBP + 0xffffff30],0xcda538
00ac629e : CMP EAX,EBX
00ac62a0 : JZ 0x00ac62bd
00ac62a2 : PUSH EAX
00ac62a3 : CALL 0x006395f7
00ac62a8 : MOV EDX,dword ptr [EBP + 0xffffff40]
00ac62ae : PUSH EDX
00ac62af : CALL 0x006366db
00ac62b4 : ADD ESP,0x8
00ac62b7 : MOV dword ptr [EBP + 0xffffff40],EBX
00ac62bd : MOV byte ptr [EBP + -0x4],0x3
00ac62c1 : CMP dword ptr [EBP + -0x30],ESI
00ac62c4 : JC 0x00ac62ce
00ac62c6 : MOV ECX,dword ptr [EBP + -0x44]
00ac62c9 : CALL 0x006f04e0
00ac62ce : XOR EAX,EAX
00ac62d0 : MOV dword ptr [EBP + -0x30],EDI
00ac62d3 : MOV dword ptr [EBP + -0x34],EBX
00ac62d6 : MOV word ptr [EBP + -0x44],AX
00ac62da : MOV byte ptr [EBP + -0x4],0x2
00ac62de : CMP dword ptr [EBP + -0x68],ESI
00ac62e1 : JC 0x00ac62eb
00ac62e3 : MOV ECX,dword ptr [EBP + -0x7c]
00ac62e6 : CALL 0x006f04e0
00ac62eb : XOR ECX,ECX
00ac62ed : MOV dword ptr [EBP + -0x68],EDI
00ac62f0 : MOV dword ptr [EBP + -0x6c],EBX
00ac62f3 : MOV word ptr [EBP + -0x7c],CX
00ac62f7 : MOV byte ptr [EBP + -0x4],0x1
00ac62fb : CMP dword ptr [EBP + -0x4c],ESI
00ac62fe : JC 0x00ac6308
00ac6300 : MOV ECX,dword ptr [EBP + -0x60]
00ac6303 : CALL 0x006f04e0
00ac6308 : XOR EDX,EDX
00ac630a : MOV dword ptr [EBP + -0x4c],EDI
00ac630d : MOV dword ptr [EBP + -0x50],EBX
00ac6310 : MOV word ptr [EBP + -0x60],DX
00ac6314 : MOV byte ptr [EBP + -0x4],BL
00ac6317 : CMP dword ptr [EBP + -0x14],ESI
00ac631a : JC 0x00ac6324
00ac631c : MOV ECX,dword ptr [EBP + -0x28]
00ac631f : CALL 0x006f04e0
00ac6324 : XOR EAX,EAX
00ac6326 : MOV dword ptr [EBP + -0x14],EDI
00ac6329 : MOV dword ptr [EBP + -0x18],EBX
00ac632c : MOV word ptr [EBP + -0x28],AX
00ac6330 : MOV dword ptr [EBP + -0x4],0xffffffff
00ac6337 : CMP dword ptr [EBP + 0xffffff7c],ESI
00ac633d : JC 0x00ac634a
00ac633f : MOV ECX,dword ptr [EBP + 0xffffff68]
00ac6345 : CALL 0x006f04e0
00ac634a : XOR ECX,ECX
00ac634c : MOV word ptr [EBP + 0xffffff68],CX
00ac6353 : MOV dword ptr [EBP + 0xffffff78],EBX
00ac6359 : MOV dword ptr [EBP + 0xffffff7c],EDI
00ac635f : MOV ECX,dword ptr [EBP + -0xc]
00ac6362 : MOV dword ptr FS:[0x0],ECX
00ac6369 : POP ECX
00ac636a : POP EDI
00ac636b : POP ESI
00ac636c : POP EBX
00ac636d : MOV ECX,dword ptr [EBP + -0x10]
00ac6370 : XOR ECX,EBP
00ac6372 : CALL 0x00633e6b
00ac6377 : MOV ESP,EBP
00ac6379 : POP EBP
00ac637a : RET

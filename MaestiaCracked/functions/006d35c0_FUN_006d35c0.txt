PROGRAM  : Maestia.exe
FUNCTION : FUN_006d35c0
ENTRY    : 006d35c0
BODY     : [[006d35c0, 006d3a11]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006d35c0(int param_1)

{
  undefined4 uVar1;
  int iVar2;
  char *local_18;
  uint local_14;
  undefined1 local_10 [4];
  int local_c;
  undefined1 local_5;
  
  *(int *)(param_1 + 0xe4) = *(int *)(param_1 + 0xe4) + 1;
  if (*(uint *)(param_1 + 0xd0) <= *(uint *)(param_1 + 0xe4)) {
    if (*(char *)(param_1 + 0x123) != '\0') {
      *(undefined4 *)(param_1 + 0xe4) = 0;
      FUN_006cefe0(param_1,*(undefined4 *)(param_1 + 0xe8),0,*(int *)(param_1 + 0xd8) + 1);
      while (*(char *)(param_1 + 0x124) = *(char *)(param_1 + 0x124) + '\x01',
            *(byte *)(param_1 + 0x124) < 7) {
        *(uint *)(param_1 + 0xe0) =
             (uint)((*(int *)(param_1 + 200) + -1 +
                    *(int *)(&DAT_00bed958 + (uint)*(byte *)(param_1 + 0x124) * 4)) -
                   *(int *)(&DAT_00bed93c + (uint)*(byte *)(param_1 + 0x124) * 4)) /
             *(uint *)(&DAT_00bed958 + (uint)*(byte *)(param_1 + 0x124) * 4);
        if (*(byte *)(param_1 + 0x129) < 8) {
          local_14 = (uint)*(byte *)(param_1 + 0x129) * *(int *)(param_1 + 0xe0) + 7 >> 3;
        }
        else {
          local_14 = (uint)(*(byte *)(param_1 + 0x129) >> 3) * *(int *)(param_1 + 0xe0);
        }
        *(uint *)(param_1 + 0xdc) = local_14 + 1;
        if (((*(uint *)(param_1 + 0x70) & 2) != 0) ||
           (*(uint *)(param_1 + 0xd0) =
                 (uint)((*(int *)(param_1 + 0xcc) + -1 + (&DAT_00bed990)[*(byte *)(param_1 + 0x124)]
                        ) - *(int *)(&DAT_00bed974 + (uint)*(byte *)(param_1 + 0x124) * 4)) /
                 (uint)(&DAT_00bed990)[*(byte *)(param_1 + 0x124)], *(int *)(param_1 + 0xe0) != 0))
        break;
      }
      if (*(byte *)(param_1 + 0x124) < 7) {
        return;
      }
    }
    if ((*(uint *)(param_1 + 0x6c) & 0x20) == 0) {
      *(undefined1 **)(param_1 + 0x80) = &local_5;
      *(undefined4 *)(param_1 + 0x84) = 1;
      do {
        if (*(int *)(param_1 + 0x78) == 0) {
          while (*(int *)(param_1 + 0x10c) == 0) {
            FUN_006cf140(param_1,0);
            FUN_006cd2d0(param_1,local_10,4);
            uVar1 = FUN_006cf050(param_1,local_10);
            *(undefined4 *)(param_1 + 0x10c) = uVar1;
            FUN_006cca50(param_1);
            FUN_006cf100(param_1,param_1 + 0x11c,4);
            iVar2 = _memcmp((void *)(param_1 + 0x11c),&DAT_00bed89c,4);
            if (iVar2 != 0) {
              FUN_006c23a0(param_1,"Not enough image data");
            }
          }
          *(undefined4 *)(param_1 + 0x78) = *(undefined4 *)(param_1 + 0xb0);
          *(undefined4 *)(param_1 + 0x74) = *(undefined4 *)(param_1 + 0xac);
          if (*(uint *)(param_1 + 0x10c) < *(uint *)(param_1 + 0xb0)) {
            *(undefined4 *)(param_1 + 0x78) = *(undefined4 *)(param_1 + 0x10c);
          }
          FUN_006cf100(param_1,*(undefined4 *)(param_1 + 0xac),*(undefined4 *)(param_1 + 0x78));
          *(int *)(param_1 + 0x10c) = *(int *)(param_1 + 0x10c) - *(int *)(param_1 + 0x78);
        }
        local_c = FUN_00710080(param_1 + 0x74,1);
        if (local_c == 1) {
          if (((*(int *)(param_1 + 0x84) == 0) || (*(int *)(param_1 + 0x78) != 0)) ||
             (*(int *)(param_1 + 0x10c) != 0)) {
            FUN_006c24c0(param_1,"Extra compressed data");
          }
          *(uint *)(param_1 + 0x68) = *(uint *)(param_1 + 0x68) | 8;
          *(uint *)(param_1 + 0x6c) = *(uint *)(param_1 + 0x6c) | 0x20;
          goto LAB_006d39bd;
        }
        if (local_c != 0) {
          if (*(int *)(param_1 + 0x8c) == 0) {
            local_18 = "Decompression Error";
          }
          else {
            local_18 = *(char **)(param_1 + 0x8c);
          }
          FUN_006c23a0(param_1,local_18);
        }
      } while (*(int *)(param_1 + 0x84) != 0);
      FUN_006c24c0(param_1,"Extra compressed data.");
      *(uint *)(param_1 + 0x68) = *(uint *)(param_1 + 0x68) | 8;
      *(uint *)(param_1 + 0x6c) = *(uint *)(param_1 + 0x6c) | 0x20;
LAB_006d39bd:
      *(undefined4 *)(param_1 + 0x84) = 0;
    }
    if ((*(int *)(param_1 + 0x10c) != 0) || (*(int *)(param_1 + 0x78) != 0)) {
      FUN_006c24c0(param_1,"Extra compression data");
    }
    FUN_00710030(param_1 + 0x74);
    *(uint *)(param_1 + 0x68) = *(uint *)(param_1 + 0x68) | 8;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
006d35c0 : PUSH EBP
006d35c1 : MOV EBP,ESP
006d35c3 : SUB ESP,0x14
006d35c6 : MOV EAX,dword ptr [EBP + 0x8]
006d35c9 : MOV ECX,dword ptr [EAX + 0xe4]
006d35cf : ADD ECX,0x1
006d35d2 : MOV EDX,dword ptr [EBP + 0x8]
006d35d5 : MOV dword ptr [EDX + 0xe4],ECX
006d35db : MOV EAX,dword ptr [EBP + 0x8]
006d35de : MOV ECX,dword ptr [EBP + 0x8]
006d35e1 : MOV EDX,dword ptr [EAX + 0xe4]
006d35e7 : CMP EDX,dword ptr [ECX + 0xd0]
006d35ed : JNC 0x006d35f4
006d35ef : JMP 0x006d3a0e
006d35f4 : MOV EAX,dword ptr [EBP + 0x8]
006d35f7 : MOVZX ECX,byte ptr [EAX + 0x123]
006d35fe : TEST ECX,ECX
006d3600 : JZ 0x006d378e
006d3606 : MOV EDX,dword ptr [EBP + 0x8]
006d3609 : MOV dword ptr [EDX + 0xe4],0x0
006d3613 : MOV EAX,dword ptr [EBP + 0x8]
006d3616 : MOV ECX,dword ptr [EAX + 0xd8]
006d361c : ADD ECX,0x1
006d361f : PUSH ECX
006d3620 : PUSH 0x0
006d3622 : MOV EDX,dword ptr [EBP + 0x8]
006d3625 : MOV EAX,dword ptr [EDX + 0xe8]
006d362b : PUSH EAX
006d362c : MOV ECX,dword ptr [EBP + 0x8]
006d362f : PUSH ECX
006d3630 : CALL 0x006cefe0
006d3635 : ADD ESP,0x10
006d3638 : MOV EDX,dword ptr [EBP + 0x8]
006d363b : MOV AL,byte ptr [EDX + 0x124]
006d3641 : ADD AL,0x1
006d3643 : MOV ECX,dword ptr [EBP + 0x8]
006d3646 : MOV byte ptr [ECX + 0x124],AL
006d364c : MOV EDX,dword ptr [EBP + 0x8]
006d364f : MOVZX EAX,byte ptr [EDX + 0x124]
006d3656 : CMP EAX,0x7
006d3659 : JL 0x006d3660
006d365b : JMP 0x006d377a
006d3660 : MOV ECX,dword ptr [EBP + 0x8]
006d3663 : MOVZX EDX,byte ptr [ECX + 0x124]
006d366a : MOV EAX,dword ptr [EBP + 0x8]
006d366d : MOV ECX,dword ptr [EAX + 0xc8]
006d3673 : MOV EDX,dword ptr [EDX*0x4 + 0xbed958]
006d367a : LEA EAX,[ECX + EDX*0x1 + -0x1]
006d367e : MOV ECX,dword ptr [EBP + 0x8]
006d3681 : MOVZX EDX,byte ptr [ECX + 0x124]
006d3688 : SUB EAX,dword ptr [EDX*0x4 + 0xbed93c]
006d368f : MOV ECX,dword ptr [EBP + 0x8]
006d3692 : MOVZX ECX,byte ptr [ECX + 0x124]
006d3699 : XOR EDX,EDX
006d369b : DIV dword ptr [ECX*0x4 + 0xbed958]
006d36a2 : MOV EDX,dword ptr [EBP + 0x8]
006d36a5 : MOV dword ptr [EDX + 0xe0],EAX
006d36ab : MOV EAX,dword ptr [EBP + 0x8]
006d36ae : MOVZX ECX,byte ptr [EAX + 0x129]
006d36b5 : CMP ECX,0x8
006d36b8 : JL 0x006d36d6
006d36ba : MOV EDX,dword ptr [EBP + 0x8]
006d36bd : MOVZX EAX,byte ptr [EDX + 0x129]
006d36c4 : SHR EAX,0x3
006d36c7 : MOV ECX,dword ptr [EBP + 0x8]
006d36ca : IMUL EAX,dword ptr [ECX + 0xe0]
006d36d1 : MOV dword ptr [EBP + -0x10],EAX
006d36d4 : JMP 0x006d36f3
006d36d6 : MOV EDX,dword ptr [EBP + 0x8]
006d36d9 : MOVZX EAX,byte ptr [EDX + 0x129]
006d36e0 : MOV ECX,dword ptr [EBP + 0x8]
006d36e3 : IMUL EAX,dword ptr [ECX + 0xe0]
006d36ea : ADD EAX,0x7
006d36ed : SHR EAX,0x3
006d36f0 : MOV dword ptr [EBP + -0x10],EAX
006d36f3 : MOV EDX,dword ptr [EBP + -0x10]
006d36f6 : ADD EDX,0x1
006d36f9 : MOV EAX,dword ptr [EBP + 0x8]
006d36fc : MOV dword ptr [EAX + 0xdc],EDX
006d3702 : MOV ECX,dword ptr [EBP + 0x8]
006d3705 : MOV EDX,dword ptr [ECX + 0x70]
006d3708 : AND EDX,0x2
006d370b : JNZ 0x006d3768
006d370d : MOV EAX,dword ptr [EBP + 0x8]
006d3710 : MOVZX ECX,byte ptr [EAX + 0x124]
006d3717 : MOV EDX,dword ptr [EBP + 0x8]
006d371a : MOV EAX,dword ptr [EDX + 0xcc]
006d3720 : MOV ECX,dword ptr [ECX*0x4 + 0xbed990]
006d3727 : LEA EAX,[EAX + ECX*0x1 + -0x1]
006d372b : MOV EDX,dword ptr [EBP + 0x8]
006d372e : MOVZX ECX,byte ptr [EDX + 0x124]
006d3735 : SUB EAX,dword ptr [ECX*0x4 + 0xbed974]
006d373c : MOV EDX,dword ptr [EBP + 0x8]
006d373f : MOVZX ECX,byte ptr [EDX + 0x124]
006d3746 : XOR EDX,EDX
006d3748 : DIV dword ptr [ECX*0x4 + 0xbed990]
006d374f : MOV EDX,dword ptr [EBP + 0x8]
006d3752 : MOV dword ptr [EDX + 0xd0],EAX
006d3758 : MOV EAX,dword ptr [EBP + 0x8]
006d375b : CMP dword ptr [EAX + 0xd0],0x0
006d3762 : JNZ 0x006d3766
006d3764 : JMP 0x006d376a
006d3766 : JMP 0x006d376a
006d3768 : JMP 0x006d377a
006d376a : MOV ECX,dword ptr [EBP + 0x8]
006d376d : CMP dword ptr [ECX + 0xe0],0x0
006d3774 : JZ 0x006d3638
006d377a : MOV EDX,dword ptr [EBP + 0x8]
006d377d : MOVZX EAX,byte ptr [EDX + 0x124]
006d3784 : CMP EAX,0x7
006d3787 : JGE 0x006d378e
006d3789 : JMP 0x006d3a0e
006d378e : MOV ECX,dword ptr [EBP + 0x8]
006d3791 : MOV EDX,dword ptr [ECX + 0x6c]
006d3794 : AND EDX,0x20
006d3797 : JNZ 0x006d39ca
006d379d : MOV EAX,dword ptr [EBP + 0x8]
006d37a0 : LEA ECX,[EBP + -0x1]
006d37a3 : MOV dword ptr [EAX + 0x80],ECX
006d37a9 : MOV EDX,dword ptr [EBP + 0x8]
006d37ac : MOV dword ptr [EDX + 0x84],0x1
006d37b6 : MOV EAX,dword ptr [EBP + 0x8]
006d37b9 : CMP dword ptr [EAX + 0x78],0x0
006d37bd : JNZ 0x006d38d8
006d37c3 : MOV ECX,dword ptr [EBP + 0x8]
006d37c6 : CMP dword ptr [ECX + 0x10c],0x0
006d37cd : JNZ 0x006d3862
006d37d3 : PUSH 0x0
006d37d5 : MOV EDX,dword ptr [EBP + 0x8]
006d37d8 : PUSH EDX
006d37d9 : CALL 0x006cf140
006d37de : ADD ESP,0x8
006d37e1 : PUSH 0x4
006d37e3 : LEA EAX,[EBP + -0xc]
006d37e6 : PUSH EAX
006d37e7 : MOV ECX,dword ptr [EBP + 0x8]
006d37ea : PUSH ECX
006d37eb : CALL 0x006cd2d0
006d37f0 : ADD ESP,0xc
006d37f3 : LEA EDX,[EBP + -0xc]
006d37f6 : PUSH EDX
006d37f7 : MOV EAX,dword ptr [EBP + 0x8]
006d37fa : PUSH EAX
006d37fb : CALL 0x006cf050
006d3800 : ADD ESP,0x8
006d3803 : MOV ECX,dword ptr [EBP + 0x8]
006d3806 : MOV dword ptr [ECX + 0x10c],EAX
006d380c : MOV EDX,dword ptr [EBP + 0x8]
006d380f : PUSH EDX
006d3810 : CALL 0x006cca50
006d3815 : ADD ESP,0x4
006d3818 : PUSH 0x4
006d381a : MOV EAX,dword ptr [EBP + 0x8]
006d381d : ADD EAX,0x11c
006d3822 : PUSH EAX
006d3823 : MOV ECX,dword ptr [EBP + 0x8]
006d3826 : PUSH ECX
006d3827 : CALL 0x006cf100
006d382c : ADD ESP,0xc
006d382f : PUSH 0x4
006d3831 : PUSH 0xbed89c
006d3836 : MOV EDX,dword ptr [EBP + 0x8]
006d3839 : ADD EDX,0x11c
006d383f : PUSH EDX
006d3840 : CALL 0x00640edf
006d3845 : ADD ESP,0xc
006d3848 : TEST EAX,EAX
006d384a : JZ 0x006d385d
006d384c : PUSH 0xbed76c
006d3851 : MOV EAX,dword ptr [EBP + 0x8]
006d3854 : PUSH EAX
006d3855 : CALL 0x006c23a0
006d385a : ADD ESP,0x8
006d385d : JMP 0x006d37c3
006d3862 : MOV ECX,dword ptr [EBP + 0x8]
006d3865 : MOV EDX,dword ptr [EBP + 0x8]
006d3868 : MOV EAX,dword ptr [EDX + 0xb0]
006d386e : MOV dword ptr [ECX + 0x78],EAX
006d3871 : MOV ECX,dword ptr [EBP + 0x8]
006d3874 : MOV EDX,dword ptr [EBP + 0x8]
006d3877 : MOV EAX,dword ptr [EDX + 0xac]
006d387d : MOV dword ptr [ECX + 0x74],EAX
006d3880 : MOV ECX,dword ptr [EBP + 0x8]
006d3883 : MOV EDX,dword ptr [EBP + 0x8]
006d3886 : MOV EAX,dword ptr [ECX + 0xb0]
006d388c : CMP EAX,dword ptr [EDX + 0x10c]
006d3892 : JBE 0x006d38a3
006d3894 : MOV ECX,dword ptr [EBP + 0x8]
006d3897 : MOV EDX,dword ptr [EBP + 0x8]
006d389a : MOV EAX,dword ptr [EDX + 0x10c]
006d38a0 : MOV dword ptr [ECX + 0x78],EAX
006d38a3 : MOV ECX,dword ptr [EBP + 0x8]
006d38a6 : MOV EDX,dword ptr [ECX + 0x78]
006d38a9 : PUSH EDX
006d38aa : MOV EAX,dword ptr [EBP + 0x8]
006d38ad : MOV ECX,dword ptr [EAX + 0xac]
006d38b3 : PUSH ECX
006d38b4 : MOV EDX,dword ptr [EBP + 0x8]
006d38b7 : PUSH EDX
006d38b8 : CALL 0x006cf100
006d38bd : ADD ESP,0xc
006d38c0 : MOV EAX,dword ptr [EBP + 0x8]
006d38c3 : MOV ECX,dword ptr [EBP + 0x8]
006d38c6 : MOV EDX,dword ptr [EAX + 0x10c]
006d38cc : SUB EDX,dword ptr [ECX + 0x78]
006d38cf : MOV EAX,dword ptr [EBP + 0x8]
006d38d2 : MOV dword ptr [EAX + 0x10c],EDX
006d38d8 : PUSH 0x1
006d38da : MOV ECX,dword ptr [EBP + 0x8]
006d38dd : ADD ECX,0x74
006d38e0 : PUSH ECX
006d38e1 : CALL 0x00710080
006d38e6 : ADD ESP,0x8
006d38e9 : MOV dword ptr [EBP + -0x8],EAX
006d38ec : CMP dword ptr [EBP + -0x8],0x1
006d38f0 : JNZ 0x006d3944
006d38f2 : MOV EDX,dword ptr [EBP + 0x8]
006d38f5 : CMP dword ptr [EDX + 0x84],0x0
006d38fc : JZ 0x006d3913
006d38fe : MOV EAX,dword ptr [EBP + 0x8]
006d3901 : CMP dword ptr [EAX + 0x78],0x0
006d3905 : JNZ 0x006d3913
006d3907 : MOV ECX,dword ptr [EBP + 0x8]
006d390a : CMP dword ptr [ECX + 0x10c],0x0
006d3911 : JZ 0x006d3924
006d3913 : PUSH 0xbed754
006d3918 : MOV EDX,dword ptr [EBP + 0x8]
006d391b : PUSH EDX
006d391c : CALL 0x006c24c0
006d3921 : ADD ESP,0x8
006d3924 : MOV EAX,dword ptr [EBP + 0x8]
006d3927 : MOV ECX,dword ptr [EAX + 0x68]
006d392a : OR ECX,0x8
006d392d : MOV EDX,dword ptr [EBP + 0x8]
006d3930 : MOV dword ptr [EDX + 0x68],ECX
006d3933 : MOV EAX,dword ptr [EBP + 0x8]
006d3936 : MOV ECX,dword ptr [EAX + 0x6c]
006d3939 : OR ECX,0x20
006d393c : MOV EDX,dword ptr [EBP + 0x8]
006d393f : MOV dword ptr [EDX + 0x6c],ECX
006d3942 : JMP 0x006d39bd
006d3944 : CMP dword ptr [EBP + -0x8],0x0
006d3948 : JZ 0x006d397b
006d394a : MOV EAX,dword ptr [EBP + 0x8]
006d394d : CMP dword ptr [EAX + 0x8c],0x0
006d3954 : JZ 0x006d3964
006d3956 : MOV ECX,dword ptr [EBP + 0x8]
006d3959 : MOV EDX,dword ptr [ECX + 0x8c]
006d395f : MOV dword ptr [EBP + -0x14],EDX
006d3962 : JMP 0x006d396b
006d3964 : MOV dword ptr [EBP + -0x14],0xbeeec4
006d396b : MOV EAX,dword ptr [EBP + -0x14]
006d396e : PUSH EAX
006d396f : MOV ECX,dword ptr [EBP + 0x8]
006d3972 : PUSH ECX
006d3973 : CALL 0x006c23a0
006d3978 : ADD ESP,0x8
006d397b : MOV EDX,dword ptr [EBP + 0x8]
006d397e : CMP dword ptr [EDX + 0x84],0x0
006d3985 : JNZ 0x006d39b8
006d3987 : PUSH 0xbeeeac
006d398c : MOV EAX,dword ptr [EBP + 0x8]
006d398f : PUSH EAX
006d3990 : CALL 0x006c24c0
006d3995 : ADD ESP,0x8
006d3998 : MOV ECX,dword ptr [EBP + 0x8]
006d399b : MOV EDX,dword ptr [ECX + 0x68]
006d399e : OR EDX,0x8
006d39a1 : MOV EAX,dword ptr [EBP + 0x8]
006d39a4 : MOV dword ptr [EAX + 0x68],EDX
006d39a7 : MOV ECX,dword ptr [EBP + 0x8]
006d39aa : MOV EDX,dword ptr [ECX + 0x6c]
006d39ad : OR EDX,0x20
006d39b0 : MOV EAX,dword ptr [EBP + 0x8]
006d39b3 : MOV dword ptr [EAX + 0x6c],EDX
006d39b6 : JMP 0x006d39bd
006d39b8 : JMP 0x006d37b6
006d39bd : MOV ECX,dword ptr [EBP + 0x8]
006d39c0 : MOV dword ptr [ECX + 0x84],0x0
006d39ca : MOV EDX,dword ptr [EBP + 0x8]
006d39cd : CMP dword ptr [EDX + 0x10c],0x0
006d39d4 : JNZ 0x006d39df
006d39d6 : MOV EAX,dword ptr [EBP + 0x8]
006d39d9 : CMP dword ptr [EAX + 0x78],0x0
006d39dd : JZ 0x006d39f0
006d39df : PUSH 0xbeee94
006d39e4 : MOV ECX,dword ptr [EBP + 0x8]
006d39e7 : PUSH ECX
006d39e8 : CALL 0x006c24c0
006d39ed : ADD ESP,0x8
006d39f0 : MOV EDX,dword ptr [EBP + 0x8]
006d39f3 : ADD EDX,0x74
006d39f6 : PUSH EDX
006d39f7 : CALL 0x00710030
006d39fc : ADD ESP,0x4
006d39ff : MOV EAX,dword ptr [EBP + 0x8]
006d3a02 : MOV ECX,dword ptr [EAX + 0x68]
006d3a05 : OR ECX,0x8
006d3a08 : MOV EDX,dword ptr [EBP + 0x8]
006d3a0b : MOV dword ptr [EDX + 0x68],ECX
006d3a0e : MOV ESP,EBP
006d3a10 : POP EBP
006d3a11 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_006aa0b0
ENTRY    : 006aa0b0
BODY     : [[006aa0b0, 006aa17b] [006aa180, 006aa37b]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006aa0b0(uint *param_1,int param_2,char param_3)

{
  short sVar1;
  undefined2 uVar2;
  uint in_EAX;
  uint uVar3;
  undefined2 *puVar4;
  uint uVar5;
  uint uVar6;
  void *pvVar7;
  int in_ECX;
  uint in_EDX;
  undefined4 uVar8;
  int local_8;
  undefined4 local_4;
  
  uVar8 = *(undefined4 *)(param_2 + 0x1c);
  local_8 = 0;
  local_4 = uVar8;
  if (in_EAX < 3) {
    param_1[1] = in_EAX;
    if (in_EAX == 0) {
      if (0xe5 < in_EDX) goto LAB_006aa204;
      pvVar7 = (void *)FUN_0068a220(uVar8,2,0);
      param_1[2] = (uint)pvVar7;
      if (local_8 != 0) goto LAB_006aa348;
      _memcpy(pvVar7,&DAT_00bea858,in_EDX * 2);
    }
    else if (in_EAX == 1) {
      if (0xa6 < in_EDX) goto LAB_006aa204;
      pvVar7 = (void *)FUN_0068a220(uVar8,2,0);
      param_1[2] = (uint)pvVar7;
      if (local_8 != 0) goto LAB_006aa348;
      _memcpy(pvVar7,&DAT_00beaa28,in_EDX * 2);
    }
    else {
      if ((in_EAX != 2) || (0x57 < in_EDX)) {
LAB_006aa204:
        local_8 = 3;
        goto LAB_006aa348;
      }
      pvVar7 = (void *)FUN_0068a220(uVar8,2,0);
      param_1[2] = (uint)pvVar7;
      if (local_8 != 0) goto LAB_006aa348;
      _memcpy(pvVar7,&DAT_00beab78,in_EDX * 2);
    }
  }
  else {
    param_1[1] = in_EAX + in_ECX;
    local_8 = FUN_006877c0(param_2,in_EAX + in_ECX);
    if (local_8 != 0) goto LAB_006aa348;
    uVar3 = FUN_00687a20(param_2,&local_8);
    *param_1 = uVar3 & 0xff;
    if (local_8 != 0) goto LAB_006aa348;
    puVar4 = (undefined2 *)FUN_0068a220(uVar8,2,0);
    param_1[2] = (uint)puVar4;
    if (local_8 != 0) goto LAB_006aa348;
    *puVar4 = 0;
    if (*param_1 == 0) {
      if (in_EDX != 0) {
        local_8 = FUN_00688900(param_2,in_EDX * 2 + -2);
        if (local_8 != 0) goto LAB_006aa348;
        uVar3 = 1;
        if (1 < in_EDX) {
          do {
            uVar2 = FUN_00687940(param_2);
            *(undefined2 *)(param_1[2] + uVar3 * 2) = uVar2;
            uVar3 = uVar3 + 1;
          } while (uVar3 < in_EDX);
        }
        FUN_006889b0(param_2);
        uVar8 = local_4;
      }
    }
    else {
      if (1 < *param_1 - 1) goto LAB_006aa204;
      uVar3 = 1;
      uVar8 = local_4;
      if (1 < in_EDX) {
        do {
          sVar1 = FUN_00687a80(param_2,&local_8);
          uVar8 = local_4;
          if (local_8 != 0) goto LAB_006aa348;
          if (*param_1 == 2) {
            uVar5 = FUN_00687a80(param_2,&local_8);
            uVar5 = uVar5 & 0xffff;
          }
          else {
            uVar5 = FUN_00687a20(param_2,&local_8);
            uVar5 = uVar5 & 0xff;
          }
          uVar8 = local_4;
          if (local_8 != 0) goto LAB_006aa348;
          uVar6 = 0;
          while( true ) {
            if (in_EDX <= uVar3) goto LAB_006aa15b;
            if (uVar5 < uVar6) break;
            *(short *)(param_1[2] + uVar3 * 2) = sVar1;
            uVar3 = uVar3 + 1;
            uVar6 = uVar6 + 1;
            sVar1 = sVar1 + 1;
          }
        } while (uVar3 < in_EDX);
      }
    }
  }
LAB_006aa15b:
  if (param_3 != '\0') {
    local_8 = FUN_006a9fd0(uVar8);
  }
  if (local_8 == 0) {
    return 0;
  }
LAB_006aa348:
  FUN_00687f30(uVar8,param_1[2]);
  param_1[2] = 0;
  FUN_00687f30(uVar8,param_1[3]);
  param_1[3] = 0;
  *param_1 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  return local_8;
}



============================================================
DISASSEMBLY
============================================================
006aa0b0 : SUB ESP,0x8
006aa0b3 : PUSH EBX
006aa0b4 : MOV EBX,dword ptr [ESP + 0x14]
006aa0b8 : PUSH EBP
006aa0b9 : MOV EBP,dword ptr [ESP + 0x14]
006aa0bd : PUSH ESI
006aa0be : PUSH EDI
006aa0bf : MOV EDI,dword ptr [EBX + 0x1c]
006aa0c2 : MOV ESI,EDX
006aa0c4 : MOV dword ptr [ESP + 0x14],EDI
006aa0c8 : MOV dword ptr [ESP + 0x10],0x0
006aa0d0 : CMP EAX,0x2
006aa0d3 : JBE 0x006aa263
006aa0d9 : ADD EAX,ECX
006aa0db : PUSH EAX
006aa0dc : PUSH EBX
006aa0dd : MOV dword ptr [EBP + 0x4],EAX
006aa0e0 : CALL 0x006877c0
006aa0e5 : ADD ESP,0x8
006aa0e8 : MOV dword ptr [ESP + 0x10],EAX
006aa0ec : TEST EAX,EAX
006aa0ee : JNZ 0x006aa348
006aa0f4 : LEA EDX,[ESP + 0x10]
006aa0f8 : PUSH EDX
006aa0f9 : PUSH EBX
006aa0fa : CALL 0x00687a20
006aa0ff : MOVZX EAX,AL
006aa102 : ADD ESP,0x8
006aa105 : CMP dword ptr [ESP + 0x10],0x0
006aa10a : MOV dword ptr [EBP],EAX
006aa10d : JNZ 0x006aa348
006aa113 : LEA ECX,[ESP + 0x10]
006aa117 : PUSH ECX
006aa118 : PUSH 0x0
006aa11a : PUSH ESI
006aa11b : PUSH 0x0
006aa11d : PUSH 0x2
006aa11f : PUSH EDI
006aa120 : CALL 0x0068a220
006aa125 : ADD ESP,0x18
006aa128 : CMP dword ptr [ESP + 0x10],0x0
006aa12d : MOV dword ptr [EBP + 0x8],EAX
006aa130 : JNZ 0x006aa348
006aa136 : XOR EDX,EDX
006aa138 : MOV word ptr [EAX],DX
006aa13b : MOV EAX,dword ptr [EBP]
006aa13e : TEST EAX,EAX
006aa140 : JZ 0x006aa211
006aa146 : DEC EAX
006aa147 : CMP EAX,0x1
006aa14a : JA 0x006aa204
006aa150 : LEA EDI,[EDX + 0x1]
006aa153 : CMP ESI,EDI
006aa155 : JA 0x006aa184
006aa157 : MOV EDI,dword ptr [ESP + 0x14]
006aa15b : CMP byte ptr [ESP + 0x24],0x0
006aa160 : JZ 0x006aa33a
006aa166 : MOV EBX,ESI
006aa168 : PUSH EDI
006aa169 : MOV ESI,EBP
006aa16b : CALL 0x006a9fd0
006aa170 : ADD ESP,0x4
006aa173 : MOV dword ptr [ESP + 0x10],EAX
006aa177 : JMP 0x006aa33e
006aa180 : MOV EBX,dword ptr [ESP + 0x20]
006aa184 : LEA EAX,[ESP + 0x10]
006aa188 : PUSH EAX
006aa189 : PUSH EBX
006aa18a : CALL 0x00687a80
006aa18f : ADD ESP,0x8
006aa192 : CMP dword ptr [ESP + 0x10],0x0
006aa197 : MOVZX EBX,AX
006aa19a : JNZ 0x006aa344
006aa1a0 : CMP dword ptr [EBP],0x2
006aa1a4 : JNZ 0x006aa1ba
006aa1a6 : MOV EDX,dword ptr [ESP + 0x20]
006aa1aa : LEA ECX,[ESP + 0x10]
006aa1ae : PUSH ECX
006aa1af : PUSH EDX
006aa1b0 : CALL 0x00687a80
006aa1b5 : MOVZX ECX,AX
006aa1b8 : JMP 0x006aa1cc
006aa1ba : MOV ECX,dword ptr [ESP + 0x20]
006aa1be : LEA EAX,[ESP + 0x10]
006aa1c2 : PUSH EAX
006aa1c3 : PUSH ECX
006aa1c4 : CALL 0x00687a20
006aa1c9 : MOVZX ECX,AL
006aa1cc : ADD ESP,0x8
006aa1cf : CMP dword ptr [ESP + 0x10],0x0
006aa1d4 : JNZ 0x006aa344
006aa1da : XOR EAX,EAX
006aa1dc : CMP EDI,ESI
006aa1de : JNC 0x006aa157
006aa1e4 : CMP EAX,ECX
006aa1e6 : JA 0x006aa1fb
006aa1e8 : MOV EDX,dword ptr [EBP + 0x8]
006aa1eb : MOV word ptr [EDX + EDI*0x2],BX
006aa1ef : INC EDI
006aa1f0 : INC EAX
006aa1f1 : INC EBX
006aa1f2 : CMP EDI,ESI
006aa1f4 : JC 0x006aa1e4
006aa1f6 : JMP 0x006aa157
006aa1fb : CMP EDI,ESI
006aa1fd : JC 0x006aa180
006aa1ff : JMP 0x006aa157
006aa204 : MOV dword ptr [ESP + 0x10],0x3
006aa20c : JMP 0x006aa348
006aa211 : TEST ESI,ESI
006aa213 : JBE 0x006aa15b
006aa219 : LEA EAX,[ESI + ESI*0x1 + -0x2]
006aa21d : PUSH EAX
006aa21e : PUSH EBX
006aa21f : CALL 0x00688900
006aa224 : ADD ESP,0x8
006aa227 : MOV dword ptr [ESP + 0x10],EAX
006aa22b : TEST EAX,EAX
006aa22d : JNZ 0x006aa348
006aa233 : LEA EDI,[EAX + 0x1]
006aa236 : CMP ESI,EDI
006aa238 : JBE 0x006aa255
006aa23a : LEA EBX,[EBX]
006aa240 : PUSH EBX
006aa241 : CALL 0x00687940
006aa246 : MOV ECX,dword ptr [EBP + 0x8]
006aa249 : MOV word ptr [ECX + EDI*0x2],AX
006aa24d : INC EDI
006aa24e : ADD ESP,0x4
006aa251 : CMP EDI,ESI
006aa253 : JC 0x006aa240
006aa255 : PUSH EBX
006aa256 : CALL 0x006889b0
006aa25b : ADD ESP,0x4
006aa25e : JMP 0x006aa157
006aa263 : MOV dword ptr [EBP + 0x4],EAX
006aa266 : SUB EAX,0x0
006aa269 : JZ 0x006aa2f8
006aa26f : SUB EAX,0x1
006aa272 : JZ 0x006aa2b6
006aa274 : SUB EAX,0x1
006aa277 : JNZ 0x006aa204
006aa279 : CMP ESI,0x57
006aa27c : JA 0x006aa204
006aa27e : LEA EDX,[ESP + 0x10]
006aa282 : PUSH EDX
006aa283 : PUSH EAX
006aa284 : PUSH ESI
006aa285 : PUSH EAX
006aa286 : PUSH 0x2
006aa288 : PUSH EDI
006aa289 : CALL 0x0068a220
006aa28e : ADD ESP,0x18
006aa291 : CMP dword ptr [ESP + 0x10],0x0
006aa296 : MOV dword ptr [EBP + 0x8],EAX
006aa299 : JNZ 0x006aa348
006aa29f : LEA ECX,[ESI + ESI*0x1]
006aa2a2 : PUSH ECX
006aa2a3 : PUSH 0xbeab78
006aa2a8 : PUSH EAX
006aa2a9 : CALL 0x0063ae40
006aa2ae : ADD ESP,0xc
006aa2b1 : JMP 0x006aa15b
006aa2b6 : CMP ESI,0xa6
006aa2bc : JA 0x006aa204
006aa2c2 : LEA EDX,[ESP + 0x10]
006aa2c6 : PUSH EDX
006aa2c7 : PUSH 0x0
006aa2c9 : PUSH ESI
006aa2ca : PUSH 0x0
006aa2cc : PUSH 0x2
006aa2ce : PUSH EDI
006aa2cf : CALL 0x0068a220
006aa2d4 : ADD ESP,0x18
006aa2d7 : CMP dword ptr [ESP + 0x10],0x0
006aa2dc : MOV dword ptr [EBP + 0x8],EAX
006aa2df : JNZ 0x006aa348
006aa2e1 : LEA ECX,[ESI + ESI*0x1]
006aa2e4 : PUSH ECX
006aa2e5 : PUSH 0xbeaa28
006aa2ea : PUSH EAX
006aa2eb : CALL 0x0063ae40
006aa2f0 : ADD ESP,0xc
006aa2f3 : JMP 0x006aa15b
006aa2f8 : CMP ESI,0xe5
006aa2fe : JA 0x006aa204
006aa304 : LEA EDX,[ESP + 0x10]
006aa308 : PUSH EDX
006aa309 : PUSH 0x0
006aa30b : PUSH ESI
006aa30c : PUSH 0x0
006aa30e : PUSH 0x2
006aa310 : PUSH EDI
006aa311 : CALL 0x0068a220
006aa316 : ADD ESP,0x18
006aa319 : CMP dword ptr [ESP + 0x10],0x0
006aa31e : MOV dword ptr [EBP + 0x8],EAX
006aa321 : JNZ 0x006aa348
006aa323 : LEA ECX,[ESI + ESI*0x1]
006aa326 : PUSH ECX
006aa327 : PUSH 0xbea858
006aa32c : PUSH EAX
006aa32d : CALL 0x0063ae40
006aa332 : ADD ESP,0xc
006aa335 : JMP 0x006aa15b
006aa33a : MOV EAX,dword ptr [ESP + 0x10]
006aa33e : TEST EAX,EAX
006aa340 : JZ 0x006aa374
006aa342 : JMP 0x006aa348
006aa344 : MOV EDI,dword ptr [ESP + 0x14]
006aa348 : MOV EDX,dword ptr [EBP + 0x8]
006aa34b : PUSH EDX
006aa34c : PUSH EDI
006aa34d : CALL 0x00687f30
006aa352 : MOV EAX,dword ptr [EBP + 0xc]
006aa355 : PUSH EAX
006aa356 : XOR ESI,ESI
006aa358 : PUSH EDI
006aa359 : MOV dword ptr [EBP + 0x8],ESI
006aa35c : CALL 0x00687f30
006aa361 : MOV EAX,dword ptr [ESP + 0x20]
006aa365 : ADD ESP,0x10
006aa368 : MOV dword ptr [EBP + 0xc],ESI
006aa36b : MOV dword ptr [EBP],ESI
006aa36e : MOV dword ptr [EBP + 0x4],ESI
006aa371 : MOV dword ptr [EBP + 0x8],ESI
006aa374 : POP EDI
006aa375 : POP ESI
006aa376 : POP EBP
006aa377 : POP EBX
006aa378 : ADD ESP,0x8
006aa37b : RET

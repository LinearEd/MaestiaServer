PROGRAM  : Maestia.exe
FUNCTION : FUN_005aa980
ENTRY    : 005aa980
BODY     : [[005aa980, 005aaa66]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005aa980(undefined4 *param_1,undefined4 param_2,int param_3,undefined1 param_4)

{
  uint uVar1;
  byte bVar2;
  undefined4 *in_ECX;
  
  in_ECX[4] = param_2;
  *in_ECX = &PTR_LAB_00b8f444;
  in_ECX[1] = param_1;
  in_ECX[2] = 0;
  if (param_3 == 0) {
    param_3 = 1;
  }
  *(undefined1 *)(in_ECX + 0x69) = param_4;
  in_ECX[5] = param_3;
  in_ECX[6] = 0;
  in_ECX[0x67] = 0;
  in_ECX[0x68] = 0xffffffff;
  in_ECX[0x6a] = 0;
  uVar1 = (**(code **)*param_1)();
  in_ECX[2] = uVar1;
  if ((uVar1 & 0xffff0000) == 0) {
    if ((uVar1 & 0xff00) == 0) {
      bVar2 = *(byte *)((int)&PTR_DAT_00b94fc8 + (uVar1 & 0xff));
    }
    else {
      bVar2 = *(char *)((int)&PTR_DAT_00b94fc8 + (uVar1 >> 8 & 0xff)) + 8;
    }
  }
  else if ((uVar1 & 0xff000000) == 0) {
    bVar2 = *(char *)((int)&PTR_DAT_00b94fc8 + (uVar1 >> 0x10 & 0xff)) + 0x10;
  }
  else {
    bVar2 = *(char *)((int)&PTR_DAT_00b94fc8 + (uVar1 >> 0x18)) + 0x18;
  }
  in_ECX[3] = (uint)bVar2;
  in_ECX[6] = 0;
  in_ECX[0x67] = 0;
  in_ECX[5] = (uVar1 - 1) + in_ECX[5] & ~(uVar1 - 1);
  in_ECX[0x68] = 0xffffffff;
  return;
}



============================================================
DISASSEMBLY
============================================================
005aa980 : MOV EAX,dword ptr [ESP + 0x8]
005aa984 : PUSH ESI
005aa985 : MOV ESI,ECX
005aa987 : MOV ECX,dword ptr [ESP + 0x8]
005aa98b : PUSH EDI
005aa98c : XOR EDI,EDI
005aa98e : MOV dword ptr [ESI + 0x10],EAX
005aa991 : MOV EAX,dword ptr [ESP + 0x14]
005aa995 : MOV dword ptr [ESI],0xb8f444
005aa99b : MOV dword ptr [ESI + 0x4],ECX
005aa99e : MOV dword ptr [ESI + 0x8],EDI
005aa9a1 : CMP EAX,EDI
005aa9a3 : JNZ 0x005aa9aa
005aa9a5 : MOV EAX,0x1
005aa9aa : MOV DL,byte ptr [ESP + 0x18]
005aa9ae : MOV byte ptr [ESI + 0x1a4],DL
005aa9b4 : MOV dword ptr [ESI + 0x14],EAX
005aa9b7 : MOV dword ptr [ESI + 0x18],EDI
005aa9ba : MOV dword ptr [ESI + 0x19c],EDI
005aa9c0 : MOV dword ptr [ESI + 0x1a0],0xffffffff
005aa9ca : MOV dword ptr [ESI + 0x1a8],EDI
005aa9d0 : MOV EAX,dword ptr [ECX]
005aa9d2 : MOV EDX,dword ptr [EAX]
005aa9d4 : CALL EDX
005aa9d6 : MOV dword ptr [ESI + 0x8],EAX
005aa9d9 : TEST EAX,0xffff0000
005aa9de : JZ 0x005aaa0d
005aa9e0 : TEST EAX,0xff000000
005aa9e5 : JZ 0x005aa9f7
005aa9e7 : MOV ECX,EAX
005aa9e9 : SHR ECX,0x18
005aa9ec : MOV CL,byte ptr [ECX + 0xb94fc8]
005aa9f2 : ADD CL,0x18
005aa9f5 : JMP 0x005aaa38
005aa9f7 : MOV EDX,EAX
005aa9f9 : SHR EDX,0x10
005aa9fc : AND EDX,0xff
005aaa02 : MOV CL,byte ptr [EDX + 0xb94fc8]
005aaa08 : ADD CL,0x10
005aaa0b : JMP 0x005aaa38
005aaa0d : TEST EAX,0xff00
005aaa12 : JZ 0x005aaa2a
005aaa14 : MOV ECX,EAX
005aaa16 : SHR ECX,0x8
005aaa19 : AND ECX,0xff
005aaa1f : MOV CL,byte ptr [ECX + 0xb94fc8]
005aaa25 : ADD CL,0x8
005aaa28 : JMP 0x005aaa38
005aaa2a : MOV EDX,EAX
005aaa2c : AND EDX,0xff
005aaa32 : MOV CL,byte ptr [EDX + 0xb94fc8]
005aaa38 : MOV EDX,dword ptr [ESI + 0x14]
005aaa3b : MOVZX ECX,CL
005aaa3e : MOV dword ptr [ESI + 0xc],ECX
005aaa41 : LEA ECX,[EAX + EDX*0x1 + -0x1]
005aaa45 : DEC EAX
005aaa46 : NOT EAX
005aaa48 : AND ECX,EAX
005aaa4a : MOV dword ptr [ESI + 0x18],EDI
005aaa4d : MOV dword ptr [ESI + 0x19c],EDI
005aaa53 : POP EDI
005aaa54 : MOV dword ptr [ESI + 0x14],ECX
005aaa57 : MOV dword ptr [ESI + 0x1a0],0xffffffff
005aaa61 : MOV EAX,ESI
005aaa63 : POP ESI
005aaa64 : RET 0x10

PROGRAM  : Maestia.exe
FUNCTION : FUN_0093f020
ENTRY    : 0093f020
BODY     : [[0093f020, 0093f35a]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_0093f020(int param_1,int param_2)

{
  int *piVar1;
  uint uVar2;
  undefined4 uVar3;
  int in_ECX;
  undefined1 local_9c [28];
  undefined1 local_80 [28];
  undefined1 local_64 [28];
  undefined1 local_48 [28];
  undefined1 local_2c [28];
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4e31d;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  if (param_1 == 0) {
    return 0;
  }
  if (param_2 == 0) {
    return 0;
  }
  switch(*(int *)(param_2 + 0x5c) + -1) {
  case 0:
    if (*(int *)(param_2 + 0x60) == 0) {
      return 0;
    }
    ExceptionList = &local_10;
    FUN_00406460(L"IDS_GUI_CANT_USE_UPGRADE_THING");
    local_8 = 0;
    piVar1 = *(int **)(*(int *)(in_ECX + 4) + 0x1a8);
    uVar3 = FUN_0081d120(local_9c);
    local_8._0_1_ = 1;
    (**(code **)(*piVar1 + 0x44))(uVar3,3,uVar2);
    local_8 = (uint)local_8._1_3_ << 8;
    FUN_00406560();
    local_8 = 0xffffffff;
    FUN_00406560();
    FUN_0097fca0(param_2);
    ExceptionList = local_10;
    return 1;
  case 1:
    ExceptionList = &local_10;
    if (((DAT_0172491c == 0) || (*DAT_00da9894 == 0)) || (*(int *)(*DAT_00da9894 + 0x1a8) == 0))
    goto LAB_0093f183;
    FUN_00406460(L"IDS_TRADEBINDITEM_DONT_ITEM_ISUNBIND");
    local_8 = 2;
    piVar1 = *(int **)(*DAT_00da9894 + 0x1a8);
    uVar3 = FUN_0081d120(local_80);
    local_8._0_1_ = 3;
    (**(code **)(*piVar1 + 0x44))(uVar3,3);
    local_8 = CONCAT31(local_8._1_3_,2);
    FUN_00406560();
    break;
  case 2:
    ExceptionList = &local_10;
    if (((DAT_0172491c == 0) || (*DAT_00da9894 == 0)) || (*(int *)(*DAT_00da9894 + 0x1a8) == 0))
    goto LAB_0093f183;
    FUN_00406460(L"IDS_UNIDENTIFIED_NOT_BREAK_SEAL");
    local_8 = 4;
    piVar1 = *(int **)(*DAT_00da9894 + 0x1a8);
    uVar3 = FUN_0081d120(local_48);
    local_8._0_1_ = 5;
    (**(code **)(*piVar1 + 0x44))(uVar3,3);
    local_8 = CONCAT31(local_8._1_3_,4);
    FUN_00406560();
    break;
  default:
    return 0;
  case 4:
    ExceptionList = &local_10;
    if (((DAT_0172491c != 0) && (*DAT_00da9894 != 0)) && (*(int *)(*DAT_00da9894 + 0x1a8) != 0)) {
      FUN_00406460(L"IDS_DECOMPOSE_CANNOT_USE");
      local_8 = 6;
      piVar1 = *(int **)(*DAT_00da9894 + 0x1a8);
      uVar3 = FUN_0081d120(local_64);
      local_8._0_1_ = 7;
      (**(code **)(*piVar1 + 0x44))(uVar3,3);
      local_8 = CONCAT31(local_8._1_3_,6);
      FUN_00406560();
      local_8 = 0xffffffff;
      FUN_00406560();
    }
    goto LAB_0093f183;
  case 5:
    ExceptionList = &local_10;
    if (((DAT_0172491c != 0) && (*DAT_00da9894 != 0)) && (*(int *)(*DAT_00da9894 + 0x1a8) != 0)) {
      FUN_00406460(L"IDS_ITEMCRAFT_REPAIR_TOOL_ERROR");
      local_8 = 8;
      piVar1 = *(int **)(*DAT_00da9894 + 0x1a8);
      uVar3 = FUN_0081d120(local_2c);
      local_8._0_1_ = 9;
      (**(code **)(*piVar1 + 0x44))(uVar3,3);
      local_8 = CONCAT31(local_8._1_3_,8);
      FUN_00406560();
      local_8 = 0xffffffff;
      FUN_00406560();
    }
    goto LAB_0093f183;
  }
  local_8 = 0xffffffff;
  FUN_00406560();
LAB_0093f183:
  FUN_0097fca0(param_2);
  FUN_0097fa60();
  ExceptionList = local_10;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
0093f020 : PUSH EBP
0093f021 : MOV EBP,ESP
0093f023 : PUSH -0x1
0093f025 : PUSH 0xb4e31d
0093f02a : MOV EAX,FS:[0x0]
0093f030 : PUSH EAX
0093f031 : SUB ESP,0x118
0093f037 : PUSH EBX
0093f038 : PUSH ESI
0093f039 : PUSH EDI
0093f03a : MOV EAX,[0x00d66fa0]
0093f03f : XOR EAX,EBP
0093f041 : PUSH EAX
0093f042 : LEA EAX,[EBP + -0xc]
0093f045 : MOV FS:[0x0],EAX
0093f04b : MOV ESI,ECX
0093f04d : CMP dword ptr [EBP + 0x8],0x0
0093f051 : JZ 0x0093f345
0093f057 : MOV EBX,dword ptr [EBP + 0xc]
0093f05a : TEST EBX,EBX
0093f05c : JZ 0x0093f345
0093f062 : MOV EAX,dword ptr [EBX + 0x5c]
0093f065 : DEC EAX
0093f066 : CMP EAX,0x5
0093f069 : JA 0x0093f345
0093f06f : JMP dword ptr [EAX*0x4 + 0x93f35c]
0093f076 : CMP dword ptr [EBX + 0x60],0x0
0093f07a : JZ 0x0093f345
0093f080 : PUSH 0xc714e4
0093f085 : LEA ECX,[EBP + 0xffffff68]
0093f08b : CALL 0x00406460
0093f090 : MOV dword ptr [EBP + -0x4],0x0
0093f097 : MOV EAX,dword ptr [ESI + 0x4]
0093f09a : MOV ESI,dword ptr [EAX + 0x1a8]
0093f0a0 : LEA ECX,[EBP + 0xffffff68]
0093f0a6 : PUSH ECX
0093f0a7 : MOV ECX,dword ptr [0x0172491c]
0093f0ad : LEA EDI,[EBP + 0xffffff4c]
0093f0b3 : CALL 0x0081d120
0093f0b8 : MOV byte ptr [EBP + -0x4],0x1
0093f0bc : MOV EDX,dword ptr [ESI]
0093f0be : PUSH 0x3
0093f0c0 : PUSH EAX
0093f0c1 : MOV EAX,dword ptr [EDX + 0x44]
0093f0c4 : MOV ECX,ESI
0093f0c6 : CALL EAX
0093f0c8 : MOV byte ptr [EBP + -0x4],0x0
0093f0cc : MOV ECX,EDI
0093f0ce : CALL 0x00406560
0093f0d3 : MOV dword ptr [EBP + -0x4],0xffffffff
0093f0da : LEA ECX,[EBP + 0xffffff68]
0093f0e0 : CALL 0x00406560
0093f0e5 : PUSH EBX
0093f0e6 : CALL 0x0097fca0
0093f0eb : MOV AL,0x1
0093f0ed : MOV ECX,dword ptr [EBP + -0xc]
0093f0f0 : MOV dword ptr FS:[0x0],ECX
0093f0f7 : POP ECX
0093f0f8 : POP EDI
0093f0f9 : POP ESI
0093f0fa : POP EBX
0093f0fb : MOV ESP,EBP
0093f0fd : POP EBP
0093f0fe : RET 0x8
0093f101 : CMP dword ptr [0x0172491c],0x0
0093f108 : JZ 0x0093f183
0093f10a : MOV ECX,dword ptr [0x00da9894]
0093f110 : MOV EAX,dword ptr [ECX]
0093f112 : TEST EAX,EAX
0093f114 : JZ 0x0093f183
0093f116 : CMP dword ptr [EAX + 0x1a8],0x0
0093f11d : JZ 0x0093f183
0093f11f : PUSH 0xc71528
0093f124 : LEA ECX,[EBP + -0x7c]
0093f127 : CALL 0x00406460
0093f12c : MOV EBX,0x2
0093f131 : MOV dword ptr [EBP + -0x4],EBX
0093f134 : MOV EDX,dword ptr [0x00da9894]
0093f13a : MOV EAX,dword ptr [EDX]
0093f13c : MOV ESI,dword ptr [EAX + 0x1a8]
0093f142 : MOV ECX,dword ptr [0x0172491c]
0093f148 : LEA EAX,[EBP + -0x7c]
0093f14b : PUSH EAX
0093f14c : LEA EDI,[EBP + 0xfffffef8]
0093f152 : CALL 0x0081d120
0093f157 : MOV byte ptr [EBP + -0x4],0x3
0093f15b : MOV EDX,dword ptr [ESI]
0093f15d : PUSH 0x3
0093f15f : PUSH EAX
0093f160 : MOV EAX,dword ptr [EDX + 0x44]
0093f163 : MOV ECX,ESI
0093f165 : CALL EAX
0093f167 : MOV byte ptr [EBP + -0x4],BL
0093f16a : MOV ECX,EDI
0093f16c : CALL 0x00406560
0093f171 : MOV dword ptr [EBP + -0x4],0xffffffff
0093f178 : LEA ECX,[EBP + -0x7c]
0093f17b : CALL 0x00406560
0093f180 : MOV EBX,dword ptr [EBP + 0xc]
0093f183 : PUSH EBX
0093f184 : CALL 0x0097fca0
0093f189 : MOV ECX,EBX
0093f18b : CALL 0x0097fa60
0093f190 : MOV AL,0x1
0093f192 : MOV ECX,dword ptr [EBP + -0xc]
0093f195 : MOV dword ptr FS:[0x0],ECX
0093f19c : POP ECX
0093f19d : POP EDI
0093f19e : POP ESI
0093f19f : POP EBX
0093f1a0 : MOV ESP,EBP
0093f1a2 : POP EBP
0093f1a3 : RET 0x8
0093f1a6 : CMP dword ptr [0x0172491c],0x0
0093f1ad : JZ 0x0093f183
0093f1af : MOV ECX,dword ptr [0x00da9894]
0093f1b5 : MOV EAX,dword ptr [ECX]
0093f1b7 : TEST EAX,EAX
0093f1b9 : JZ 0x0093f183
0093f1bb : CMP dword ptr [EAX + 0x1a8],0x0
0093f1c2 : JZ 0x0093f183
0093f1c4 : PUSH 0xc71578
0093f1c9 : LEA ECX,[EBP + -0x44]
0093f1cc : CALL 0x00406460
0093f1d1 : MOV EBX,0x4
0093f1d6 : MOV dword ptr [EBP + -0x4],EBX
0093f1d9 : MOV EDX,dword ptr [0x00da9894]
0093f1df : MOV EAX,dword ptr [EDX]
0093f1e1 : MOV ESI,dword ptr [EAX + 0x1a8]
0093f1e7 : MOV ECX,dword ptr [0x0172491c]
0093f1ed : LEA EAX,[EBP + -0x44]
0093f1f0 : PUSH EAX
0093f1f1 : LEA EDI,[EBP + 0xffffff30]
0093f1f7 : CALL 0x0081d120
0093f1fc : MOV byte ptr [EBP + -0x4],0x5
0093f200 : MOV EDX,dword ptr [ESI]
0093f202 : PUSH 0x3
0093f204 : PUSH EAX
0093f205 : MOV EAX,dword ptr [EDX + 0x44]
0093f208 : MOV ECX,ESI
0093f20a : CALL EAX
0093f20c : MOV byte ptr [EBP + -0x4],BL
0093f20f : MOV ECX,EDI
0093f211 : CALL 0x00406560
0093f216 : MOV dword ptr [EBP + -0x4],0xffffffff
0093f21d : LEA ECX,[EBP + -0x44]
0093f220 : JMP 0x0093f17b
0093f225 : CMP dword ptr [0x0172491c],0x0
0093f22c : JZ 0x0093f183
0093f232 : MOV ECX,dword ptr [0x00da9894]
0093f238 : MOV EAX,dword ptr [ECX]
0093f23a : TEST EAX,EAX
0093f23c : JZ 0x0093f183
0093f242 : CMP dword ptr [EAX + 0x1a8],0x0
0093f249 : JZ 0x0093f183
0093f24f : PUSH 0xc715b8
0093f254 : LEA ECX,[EBP + -0x60]
0093f257 : CALL 0x00406460
0093f25c : MOV dword ptr [EBP + -0x4],0x6
0093f263 : MOV EDX,dword ptr [0x00da9894]
0093f269 : MOV EAX,dword ptr [EDX]
0093f26b : MOV ESI,dword ptr [EAX + 0x1a8]
0093f271 : MOV ECX,dword ptr [0x0172491c]
0093f277 : LEA EAX,[EBP + -0x60]
0093f27a : PUSH EAX
0093f27b : LEA EDI,[EBP + 0xffffff14]
0093f281 : CALL 0x0081d120
0093f286 : MOV byte ptr [EBP + -0x4],0x7
0093f28a : MOV EDX,dword ptr [ESI]
0093f28c : PUSH 0x3
0093f28e : PUSH EAX
0093f28f : MOV EAX,dword ptr [EDX + 0x44]
0093f292 : MOV ECX,ESI
0093f294 : CALL EAX
0093f296 : MOV byte ptr [EBP + -0x4],0x6
0093f29a : MOV ECX,EDI
0093f29c : CALL 0x00406560
0093f2a1 : MOV dword ptr [EBP + -0x4],0xffffffff
0093f2a8 : LEA ECX,[EBP + -0x60]
0093f2ab : CALL 0x00406560
0093f2b0 : JMP 0x0093f183
0093f2b5 : CMP dword ptr [0x0172491c],0x0
0093f2bc : JZ 0x0093f183
0093f2c2 : MOV ECX,dword ptr [0x00da9894]
0093f2c8 : MOV EAX,dword ptr [ECX]
0093f2ca : TEST EAX,EAX
0093f2cc : JZ 0x0093f183
0093f2d2 : CMP dword ptr [EAX + 0x1a8],0x0
0093f2d9 : JZ 0x0093f183
0093f2df : PUSH 0xc715f0
0093f2e4 : LEA ECX,[EBP + -0x28]
0093f2e7 : CALL 0x00406460
0093f2ec : MOV dword ptr [EBP + -0x4],0x8
0093f2f3 : MOV EDX,dword ptr [0x00da9894]
0093f2f9 : MOV EAX,dword ptr [EDX]
0093f2fb : MOV ESI,dword ptr [EAX + 0x1a8]
0093f301 : MOV ECX,dword ptr [0x0172491c]
0093f307 : LEA EAX,[EBP + -0x28]
0093f30a : PUSH EAX
0093f30b : LEA EDI,[EBP + 0xfffffedc]
0093f311 : CALL 0x0081d120
0093f316 : MOV byte ptr [EBP + -0x4],0x9
0093f31a : MOV EDX,dword ptr [ESI]
0093f31c : PUSH 0x3
0093f31e : PUSH EAX
0093f31f : MOV EAX,dword ptr [EDX + 0x44]
0093f322 : MOV ECX,ESI
0093f324 : CALL EAX
0093f326 : MOV byte ptr [EBP + -0x4],0x8
0093f32a : MOV ECX,EDI
0093f32c : CALL 0x00406560
0093f331 : MOV dword ptr [EBP + -0x4],0xffffffff
0093f338 : LEA ECX,[EBP + -0x28]
0093f33b : CALL 0x00406560
0093f340 : JMP 0x0093f183
0093f345 : XOR AL,AL
0093f347 : MOV ECX,dword ptr [EBP + -0xc]
0093f34a : MOV dword ptr FS:[0x0],ECX
0093f351 : POP ECX
0093f352 : POP EDI
0093f353 : POP ESI
0093f354 : POP EBX
0093f355 : MOV ESP,EBP
0093f357 : POP EBP
0093f358 : RET 0x8

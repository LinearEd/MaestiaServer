PROGRAM  : Maestia.exe
FUNCTION : FUN_00a4b010
ENTRY    : 00a4b010
BODY     : [[00a4b010, 00a4b334]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a4b010(int param_1,undefined4 param_2,char param_3)

{
  wchar_t wVar1;
  int *piVar2;
  int *piVar3;
  int iVar4;
  int iVar5;
  void **ppvVar6;
  tm *ptVar7;
  wchar_t *pwVar8;
  int in_ECX;
  int local_248;
  undefined4 local_23c;
  char local_238;
  uint local_230;
  undefined4 local_220;
  uint local_21c;
  wchar_t local_218 [255];
  undefined2 local_1a;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b266e2;
  local_18 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  piVar2 = *(int **)(param_1 + 0x128);
  piVar3 = (int *)*piVar2;
  ppvVar6 = &local_10;
  local_10 = ExceptionList;
  do {
    ExceptionList = ppvVar6;
    if (piVar3 == piVar2) {
LAB_00a4b317:
      ExceptionList = local_10;
      __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
      return;
    }
    iVar4 = piVar3[4];
    if (*(int *)(iVar4 + 4) == in_ECX) {
      iVar5 = *(int *)(iVar4 + 0x169c);
      if (*(int *)(iVar4 + 0x18a4) == 0) {
        *(undefined4 *)(iVar4 + 0x18a4) = param_2;
      }
      if (iVar5 != -1) {
        local_218[0] = L'\0';
        if (param_3 != '\0') {
          ptVar7 = __localtime64((__time64_t *)&stack0x00000010);
          if (ptVar7 != (tm *)0x0) {
            FUN_0081cbe0();
            local_8 = 0;
            __snwprintf(local_218,0x100,L"%s: %d.%02d.%02d %02d:%02d");
            local_1a = 0;
            local_8 = 0xffffffff;
            if (7 < local_21c) {
                    /* WARNING: Subroutine does not return */
              FUN_006f04e0();
            }
            local_21c = 7;
            local_220 = 0;
            local_230 = local_230 & 0xffff0000;
          }
          if (*(int **)(param_1 + 0x40) != (int *)0x0) {
            (**(code **)(**(int **)(param_1 + 0x40) + 4))();
          }
        }
        FUN_00401930();
        if (local_248 == *(int *)(param_1 + 0x1ec)) {
          local_21c = 7;
          local_220 = 0;
          local_230 = local_230 & 0xffff0000;
          local_8 = 2;
          local_238 = param_3;
          pwVar8 = local_218;
          do {
            wVar1 = *pwVar8;
            pwVar8 = pwVar8 + 1;
          } while (wVar1 != L'\0');
          FUN_00406360();
          local_23c = param_2;
          FUN_00401370(&stack0xfffffd2c,&local_23c);
          local_8._1_3_ = (undefined3)((uint)local_8 >> 8);
          local_8._0_1_ = 2;
          FUN_00403650(iVar5);
          local_8._0_1_ = 4;
          FUN_004032e0();
          local_8._0_1_ = 5;
          FUN_00401880();
          local_8._0_1_ = 4;
          FUN_00401300();
          local_8 = CONCAT31(local_8._1_3_,2);
          FUN_00401300();
          local_8 = 0xffffffff;
          FUN_00401300();
        }
        else {
          *(char *)(local_248 + 0x14) = param_3;
          pwVar8 = local_218;
          do {
            wVar1 = *pwVar8;
            pwVar8 = pwVar8 + 1;
          } while (wVar1 != L'\0');
          FUN_00406360();
          *(undefined4 *)(local_248 + 0x10) = param_2;
        }
      }
      goto LAB_00a4b317;
    }
    FUN_00416210();
    ppvVar6 = ExceptionList;
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
00a4b010 : PUSH EBP
00a4b011 : MOV EBP,ESP
00a4b013 : PUSH -0x1
00a4b015 : PUSH 0xb266e2
00a4b01a : MOV EAX,FS:[0x0]
00a4b020 : PUSH EAX
00a4b021 : SUB ESP,0x290
00a4b027 : MOV EAX,[0x00d66fa0]
00a4b02c : XOR EAX,EBP
00a4b02e : MOV dword ptr [EBP + -0x14],EAX
00a4b031 : PUSH EBX
00a4b032 : PUSH ESI
00a4b033 : PUSH EDI
00a4b034 : PUSH EAX
00a4b035 : LEA EAX,[EBP + -0xc]
00a4b038 : MOV FS:[0x0],EAX
00a4b03e : MOV EDI,ECX
00a4b040 : MOV EBX,dword ptr [EBP + 0x8]
00a4b043 : MOV ESI,dword ptr [EBX + 0x128]
00a4b049 : MOV EAX,dword ptr [ESI]
00a4b04b : MOV dword ptr [EBP + 0xfffffdc4],EAX
00a4b051 : CMP EAX,ESI
00a4b053 : JZ 0x00a4b317
00a4b059 : LEA ESP,[ESP]
00a4b060 : MOV EAX,dword ptr [EAX + 0x10]
00a4b063 : CMP dword ptr [EAX + 0x4],EDI
00a4b066 : JZ 0x00a4b082
00a4b068 : LEA EDX,[EBP + 0xfffffdc4]
00a4b06e : CALL 0x00416210
00a4b073 : MOV EAX,dword ptr [EBP + 0xfffffdc4]
00a4b079 : CMP EAX,ESI
00a4b07b : JNZ 0x00a4b060
00a4b07d : JMP 0x00a4b317
00a4b082 : MOV ECX,dword ptr [EAX + 0x18a4]
00a4b088 : MOV ESI,dword ptr [EAX + 0x169c]
00a4b08e : MOV dword ptr [EBP + 0xfffffdc4],ESI
00a4b094 : TEST ECX,ECX
00a4b096 : JNZ 0x00a4b0a1
00a4b098 : MOV ECX,dword ptr [EBP + 0xc]
00a4b09b : MOV dword ptr [EAX + 0x18a4],ECX
00a4b0a1 : CMP ESI,-0x1
00a4b0a4 : JZ 0x00a4b317
00a4b0aa : XOR EDX,EDX
00a4b0ac : MOV word ptr [EBP + 0xfffffdec],DX
00a4b0b3 : CMP byte ptr [EBP + 0x10],DL
00a4b0b6 : JZ 0x00a4b1b5
00a4b0bc : LEA EAX,[EBP + 0x14]
00a4b0bf : PUSH EAX
00a4b0c0 : CALL 0x00635226
00a4b0c5 : MOV EDI,EAX
00a4b0c7 : ADD ESP,0x4
00a4b0ca : TEST EDI,EDI
00a4b0cc : JZ 0x00a4b18c
00a4b0d2 : CMP byte ptr [EBP + 0x10],0x1
00a4b0d6 : MOV ECX,0xcc9eac
00a4b0db : JZ 0x00a4b0e2
00a4b0dd : MOV ECX,0xcc9ebc
00a4b0e2 : MOV EDX,dword ptr [0x0172491c]
00a4b0e8 : PUSH EDX
00a4b0e9 : LEA ESI,[EBP + 0xfffffdd0]
00a4b0ef : CALL 0x0081cbe0
00a4b0f4 : MOV dword ptr [EBP + -0x4],0x0
00a4b0fb : MOV EAX,dword ptr [EBP + 0xfffffdd4]
00a4b101 : MOV ESI,0x8
00a4b106 : CMP dword ptr [EBP + 0xfffffde8],ESI
00a4b10c : JNC 0x00a4b114
00a4b10e : LEA EAX,[EBP + 0xfffffdd4]
00a4b114 : MOV ECX,dword ptr [EDI + 0x4]
00a4b117 : MOV EDX,dword ptr [EDI + 0x8]
00a4b11a : PUSH ECX
00a4b11b : MOV ECX,dword ptr [EDI + 0xc]
00a4b11e : PUSH EDX
00a4b11f : MOV EDX,dword ptr [EDI + 0x10]
00a4b122 : PUSH ECX
00a4b123 : MOV ECX,dword ptr [EDI + 0x14]
00a4b126 : INC EDX
00a4b127 : PUSH EDX
00a4b128 : ADD ECX,0x76c
00a4b12e : PUSH ECX
00a4b12f : PUSH EAX
00a4b130 : PUSH 0xcc9ecc
00a4b135 : LEA EDX,[EBP + 0xfffffdec]
00a4b13b : PUSH 0x100
00a4b140 : PUSH EDX
00a4b141 : CALL 0x006343c8
00a4b146 : XOR EAX,EAX
00a4b148 : ADD ESP,0x24
00a4b14b : MOV word ptr [EBP + -0x16],AX
00a4b14f : MOV dword ptr [EBP + -0x4],0xffffffff
00a4b156 : CMP dword ptr [EBP + 0xfffffde8],ESI
00a4b15c : JC 0x00a4b169
00a4b15e : MOV ECX,dword ptr [EBP + 0xfffffdd4]
00a4b164 : CALL 0x006f04e0
00a4b169 : MOV ESI,dword ptr [EBP + 0xfffffdc4]
00a4b16f : XOR ECX,ECX
00a4b171 : MOV dword ptr [EBP + 0xfffffde8],0x7
00a4b17b : MOV dword ptr [EBP + 0xfffffde4],0x0
00a4b185 : MOV word ptr [EBP + 0xfffffdd4],CX
00a4b18c : MOV EAX,dword ptr [EBX + 0x40]
00a4b18f : TEST EAX,EAX
00a4b191 : JZ 0x00a4b1b5
00a4b193 : MOV EDX,dword ptr [EAX]
00a4b195 : MOV EDX,dword ptr [EDX + 0x4]
00a4b198 : LEA ECX,[EBP + 0xfffffdec]
00a4b19e : PUSH ECX
00a4b19f : MOVZX ECX,byte ptr [EBP + 0x10]
00a4b1a3 : PUSH ECX
00a4b1a4 : PUSH ESI
00a4b1a5 : PUSH 0xcc9f04
00a4b1aa : PUSH 0xcc9f10
00a4b1af : PUSH EAX
00a4b1b0 : CALL EDX
00a4b1b2 : ADD ESP,0x18
00a4b1b5 : MOVZX EAX,SI
00a4b1b8 : LEA ECX,[EBP + 0xfffffdc0]
00a4b1be : MOV dword ptr [EBP + 0xfffffdc0],EAX
00a4b1c4 : LEA EDI,[EBX + 0x1e8]
00a4b1ca : PUSH ECX
00a4b1cb : LEA EAX,[EBP + 0xfffffdbc]
00a4b1d1 : MOV ECX,EDI
00a4b1d3 : CALL 0x00401930
00a4b1d8 : MOV EAX,dword ptr [EBX + 0x1ec]
00a4b1de : MOV ESI,dword ptr [EBP + 0xfffffdbc]
00a4b1e4 : CMP ESI,EAX
00a4b1e6 : JNZ 0x00a4b2df
00a4b1ec : XOR EDX,EDX
00a4b1ee : MOV dword ptr [EBP + 0xfffffde8],0x7
00a4b1f8 : MOV dword ptr [EBP + 0xfffffde4],0x0
00a4b202 : MOV word ptr [EBP + 0xfffffdd4],DX
00a4b209 : MOV EBX,0x2
00a4b20e : MOV dword ptr [EBP + -0x4],EBX
00a4b211 : MOV AL,byte ptr [EBP + 0x10]
00a4b214 : MOV byte ptr [EBP + 0xfffffdcc],AL
00a4b21a : LEA EAX,[EBP + 0xfffffdec]
00a4b220 : LEA EDX,[EAX + 0x2]
00a4b223 : MOV CX,word ptr [EAX]
00a4b226 : ADD EAX,EBX
00a4b228 : TEST CX,CX
00a4b22b : JNZ 0x00a4b223
00a4b22d : SUB EAX,EDX
00a4b22f : SAR EAX,0x1
00a4b231 : PUSH EAX
00a4b232 : LEA ECX,[EBP + 0xfffffdec]
00a4b238 : PUSH ECX
00a4b239 : LEA ECX,[EBP + 0xfffffdd0]
00a4b23f : CALL 0x00406360
00a4b244 : MOV EDX,dword ptr [EBP + 0xc]
00a4b247 : SUB ESP,0x24
00a4b24a : MOV EAX,ESP
00a4b24c : MOV dword ptr [EBP + 0xfffffdbc],ESP
00a4b252 : LEA ECX,[EBP + 0xfffffdc8]
00a4b258 : PUSH ECX
00a4b259 : PUSH EAX
00a4b25a : MOV dword ptr [EBP + 0xfffffdc8],EDX
00a4b260 : CALL 0x00401370
00a4b265 : MOV byte ptr [EBP + -0x4],0x3
00a4b269 : MOV EDX,dword ptr [EBP + 0xfffffdc4]
00a4b26f : PUSH EDX
00a4b270 : MOV byte ptr [EBP + -0x4],BL
00a4b273 : LEA ESI,[EBP + 0xfffffd68]
00a4b279 : CALL 0x00403650
00a4b27e : ADD ESP,0x28
00a4b281 : MOV byte ptr [EBP + -0x4],0x4
00a4b285 : PUSH EAX
00a4b286 : LEA EAX,[EBP + 0xfffffd90]
00a4b28c : PUSH EAX
00a4b28d : CALL 0x004032e0
00a4b292 : MOV byte ptr [EBP + -0x4],0x5
00a4b296 : LEA ECX,[EBP + 0xfffffd90]
00a4b29c : PUSH ECX
00a4b29d : LEA EDX,[EBP + 0xfffffdb8]
00a4b2a3 : PUSH EDX
00a4b2a4 : MOV EAX,EDI
00a4b2a6 : CALL 0x00401880
00a4b2ab : MOV byte ptr [EBP + -0x4],0x4
00a4b2af : LEA EAX,[EBP + 0xfffffd94]
00a4b2b5 : PUSH EAX
00a4b2b6 : CALL 0x00401300
00a4b2bb : MOV byte ptr [EBP + -0x4],BL
00a4b2be : LEA ECX,[EBP + 0xfffffd6c]
00a4b2c4 : PUSH ECX
00a4b2c5 : CALL 0x00401300
00a4b2ca : MOV dword ptr [EBP + -0x4],0xffffffff
00a4b2d1 : LEA EDX,[EBP + 0xfffffdc8]
00a4b2d7 : PUSH EDX
00a4b2d8 : CALL 0x00401300
00a4b2dd : JMP 0x00a4b317
00a4b2df : MOV AL,byte ptr [EBP + 0x10]
00a4b2e2 : MOV byte ptr [ESI + 0x14],AL
00a4b2e5 : LEA EAX,[EBP + 0xfffffdec]
00a4b2eb : LEA EDX,[EAX + 0x2]
00a4b2ee : MOV EBX,0x2
00a4b2f3 : MOV CX,word ptr [EAX]
00a4b2f6 : ADD EAX,EBX
00a4b2f8 : TEST CX,CX
00a4b2fb : JNZ 0x00a4b2f3
00a4b2fd : SUB EAX,EDX
00a4b2ff : SAR EAX,0x1
00a4b301 : PUSH EAX
00a4b302 : LEA ECX,[EBP + 0xfffffdec]
00a4b308 : PUSH ECX
00a4b309 : LEA ECX,[ESI + 0x18]
00a4b30c : CALL 0x00406360
00a4b311 : MOV EDX,dword ptr [EBP + 0xc]
00a4b314 : MOV dword ptr [ESI + 0x10],EDX
00a4b317 : MOV ECX,dword ptr [EBP + -0xc]
00a4b31a : MOV dword ptr FS:[0x0],ECX
00a4b321 : POP ECX
00a4b322 : POP EDI
00a4b323 : POP ESI
00a4b324 : POP EBX
00a4b325 : MOV ECX,dword ptr [EBP + -0x14]
00a4b328 : XOR ECX,EBP
00a4b32a : CALL 0x00633e6b
00a4b32f : MOV ESP,EBP
00a4b331 : POP EBP
00a4b332 : RET 0x14

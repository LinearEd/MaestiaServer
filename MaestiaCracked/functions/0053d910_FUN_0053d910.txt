PROGRAM  : Maestia.exe
FUNCTION : FUN_0053d910
ENTRY    : 0053d910
BODY     : [[0053d910, 0053db21]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_0053d910(uint *param_1,int *param_2)

{
  uint *puVar1;
  char cVar2;
  int iVar3;
  ushort *puVar4;
  undefined4 uVar5;
  bool bVar6;
  int iVar7;
  undefined4 uVar8;
  int in_ECX;
  undefined1 local_5;
  
  local_5 = 0;
  if (*(int *)(in_ECX + 4) == 8) {
    iVar3 = *(int *)(in_ECX + 0x14);
    if ((iVar3 == 0x22) || (iVar3 == 0x27)) {
      puVar4 = *(ushort **)(in_ECX + 0xc);
      puVar1 = (uint *)(in_ECX + 8);
      *puVar1 = (uint)puVar4;
      if ((*(char *)(in_ECX + 0x18) == '\0') || (*puVar4 != 0x26)) {
        if (puVar4 < *(ushort **)(in_ECX + 0x10)) {
          *(uint *)(in_ECX + 0x14) = (uint)*puVar4;
          *(ushort **)(in_ECX + 0xc) = puVar4 + 1;
        }
      }
      else {
        FUN_0053bdd0();
      }
      *param_1 = *puVar1;
      *param_2 = 0;
      cVar2 = *(char *)(in_ECX + 0x18);
      bVar6 = false;
      *(undefined1 *)(in_ECX + 0x18) = 1;
      if ((cVar2 == '\0') && (*(short *)*puVar1 == 0x26)) {
        FUN_0053bdd0();
      }
      if (*puVar1 < *(uint *)(in_ECX + 0x10)) {
        do {
          if (*(int *)(in_ECX + 0x14) == iVar3) break;
          if ((*(char *)(in_ECX + 0x18) == '\0') || (*(short *)*puVar1 != 0x26)) {
            if (bVar6) {
              FUN_0053b7f0(*puVar1,(int)(*(int *)(in_ECX + 0xc) - *puVar1) >> 1);
            }
            else {
              *param_2 = *param_2 + ((int)(*(int *)(in_ECX + 0xc) - *puVar1) >> 1);
            }
          }
          else {
            if (!bVar6) {
              *(undefined4 *)(in_ECX + 0x24) = 0;
              FUN_0053b7f0(*param_1,*param_2);
              bVar6 = true;
            }
            uVar5 = *(undefined4 *)(in_ECX + 0x14);
            if (*(uint *)(in_ECX + 0x20) < *(int *)(in_ECX + 0x24) + 6U) {
              iVar7 = *(uint *)(in_ECX + 0x20) + 6;
              *(int *)(in_ECX + 0x20) = iVar7;
              iVar7 = iVar7 * 2;
              if (*(int *)(in_ECX + 0x1c) == 0) {
                uVar8 = FUN_00515840(iVar7,0);
              }
              else {
                uVar8 = FUN_00515c80(*(int *)(in_ECX + 0x1c),iVar7);
              }
              *(undefined4 *)(in_ECX + 0x1c) = uVar8;
            }
            *(short *)(*(int *)(in_ECX + 0x1c) + *(int *)(in_ECX + 0x24) * 2) = (short)uVar5;
            *(int *)(in_ECX + 0x24) = *(int *)(in_ECX + 0x24) + 1;
          }
          puVar4 = *(ushort **)(in_ECX + 0xc);
          *puVar1 = (uint)puVar4;
          if ((*(char *)(in_ECX + 0x18) == '\0') || (*puVar4 != 0x26)) {
            if (puVar4 < *(ushort **)(in_ECX + 0x10)) {
              *(uint *)(in_ECX + 0x14) = (uint)*puVar4;
              *(ushort **)(in_ECX + 0xc) = puVar4 + 1;
            }
          }
          else {
            FUN_0053bdd0();
          }
        } while (*puVar1 < *(uint *)(in_ECX + 0x10));
      }
      *(undefined1 *)(in_ECX + 0x18) = 0;
      if (bVar6) {
        *param_1 = *(uint *)(in_ECX + 0x1c);
        *param_2 = *(int *)(in_ECX + 0x24);
      }
      if (*puVar1 < *(uint *)(in_ECX + 0x10)) {
        puVar4 = *(ushort **)(in_ECX + 0xc);
        local_5 = 1;
        *puVar1 = (uint)puVar4;
        if ((*(char *)(in_ECX + 0x18) == '\0') || (*puVar4 != 0x26)) {
          if (puVar4 < *(ushort **)(in_ECX + 0x10)) {
            *(uint *)(in_ECX + 0x14) = (uint)*puVar4;
            *(ushort **)(in_ECX + 0xc) = puVar4 + 1;
          }
        }
        else {
          FUN_0053bdd0();
        }
        FUN_0053c7a0();
        if ((*(int *)(in_ECX + 0x14) == 0x3e) || (*(int *)(in_ECX + 0x14) == 0x2f)) {
          *(undefined4 *)(in_ECX + 4) = 9;
        }
        else {
          *(undefined4 *)(in_ECX + 4) = 7;
        }
      }
      else {
        *(undefined4 *)(in_ECX + 4) = 1;
      }
    }
    else {
      *(undefined4 *)(in_ECX + 4) = 1;
    }
  }
  if (*(uint *)(in_ECX + 0x10) <= *(uint *)(in_ECX + 8)) {
    *(undefined4 *)(in_ECX + 4) = 1;
  }
  return CONCAT31((int3)(*(uint *)(in_ECX + 8) >> 8),local_5);
}



============================================================
DISASSEMBLY
============================================================
0053d910 : SUB ESP,0x8
0053d913 : PUSH ESI
0053d914 : MOV ESI,ECX
0053d916 : CMP dword ptr [ESI + 0x4],0x8
0053d91a : MOV byte ptr [ESP + 0x7],0x0
0053d91f : JNZ 0x0053db08
0053d925 : MOV EAX,dword ptr [ESI + 0x14]
0053d928 : MOV dword ptr [ESP + 0x8],EAX
0053d92c : CMP EAX,0x22
0053d92f : JZ 0x0053d942
0053d931 : CMP EAX,0x27
0053d934 : JZ 0x0053d942
0053d936 : MOV dword ptr [ESI + 0x4],0x1
0053d93d : JMP 0x0053db08
0053d942 : CMP byte ptr [ESI + 0x18],0x0
0053d946 : MOV EAX,dword ptr [ESI + 0xc]
0053d949 : PUSH EDI
0053d94a : LEA EDI,[ESI + 0x8]
0053d94d : MOV dword ptr [EDI],EAX
0053d94f : JZ 0x0053d960
0053d951 : CMP word ptr [EAX],0x26
0053d955 : JNZ 0x0053d960
0053d957 : MOV ECX,EDI
0053d959 : CALL 0x0053bdd0
0053d95e : JMP 0x0053d971
0053d960 : CMP EAX,dword ptr [EDI + 0x8]
0053d963 : JNC 0x0053d971
0053d965 : MOVZX ECX,word ptr [EAX]
0053d968 : ADD EAX,0x2
0053d96b : MOV dword ptr [EDI + 0xc],ECX
0053d96e : MOV dword ptr [EDI + 0x4],EAX
0053d971 : MOV EDX,dword ptr [EDI]
0053d973 : MOV EAX,dword ptr [ESP + 0x14]
0053d977 : PUSH EBX
0053d978 : PUSH EBP
0053d979 : MOV EBP,dword ptr [ESP + 0x20]
0053d97d : MOV dword ptr [EAX],EDX
0053d97f : MOV dword ptr [EBP],0x0
0053d986 : MOV AL,byte ptr [EDI + 0x10]
0053d989 : XOR BL,BL
0053d98b : MOV byte ptr [EDI + 0x10],0x1
0053d98f : TEST AL,AL
0053d991 : JNZ 0x0053d9a2
0053d993 : MOV ECX,dword ptr [EDI]
0053d995 : CMP word ptr [ECX],0x26
0053d999 : JNZ 0x0053d9a2
0053d99b : MOV ECX,EDI
0053d99d : CALL 0x0053bdd0
0053d9a2 : MOV EDX,dword ptr [EDI]
0053d9a4 : CMP EDX,dword ptr [EDI + 0x8]
0053d9a7 : JNC 0x0053da8a
0053d9ad : LEA ECX,[ECX]
0053d9b0 : MOV EAX,dword ptr [ESP + 0x14]
0053d9b4 : CMP dword ptr [ESI + 0x14],EAX
0053d9b7 : JZ 0x0053da8a
0053d9bd : CMP byte ptr [EDI + 0x10],0x0
0053d9c1 : JZ 0x0053da32
0053d9c3 : MOV ECX,dword ptr [EDI]
0053d9c5 : CMP word ptr [ECX],0x26
0053d9c9 : JNZ 0x0053da32
0053d9cb : TEST BL,BL
0053d9cd : JNZ 0x0053d9ea
0053d9cf : MOV EAX,dword ptr [ESP + 0x1c]
0053d9d3 : MOV dword ptr [ESI + 0x24],0x0
0053d9da : MOV EDX,dword ptr [EBP]
0053d9dd : MOV ECX,dword ptr [EAX]
0053d9df : PUSH EDX
0053d9e0 : PUSH ECX
0053d9e1 : MOV ECX,ESI
0053d9e3 : CALL 0x0053b7f0
0053d9e8 : MOV BL,0x1
0053d9ea : MOV EDX,dword ptr [ESI + 0x24]
0053d9ed : MOV EAX,dword ptr [ESI + 0x20]
0053d9f0 : MOV EBP,dword ptr [ESI + 0x14]
0053d9f3 : ADD EDX,0x6
0053d9f6 : CMP EDX,EAX
0053d9f8 : JBE 0x0053da1f
0053d9fa : MOV ECX,dword ptr [ESI + 0x1c]
0053d9fd : ADD EAX,0x6
0053da00 : MOV dword ptr [ESI + 0x20],EAX
0053da03 : ADD EAX,EAX
0053da05 : TEST ECX,ECX
0053da07 : JNZ 0x0053da15
0053da09 : MOV ECX,dword ptr [ESI]
0053da0b : PUSH 0x0
0053da0d : PUSH EAX
0053da0e : CALL 0x00515840
0053da13 : JMP 0x0053da1c
0053da15 : PUSH EAX
0053da16 : PUSH ECX
0053da17 : CALL 0x00515c80
0053da1c : MOV dword ptr [ESI + 0x1c],EAX
0053da1f : MOV EAX,dword ptr [ESI + 0x24]
0053da22 : MOV ECX,dword ptr [ESI + 0x1c]
0053da25 : MOV word ptr [ECX + EAX*0x2],BP
0053da29 : INC dword ptr [ESI + 0x24]
0053da2c : MOV EBP,dword ptr [ESP + 0x20]
0053da30 : JMP 0x0053da54
0053da32 : TEST BL,BL
0053da34 : JZ 0x0053da4a
0053da36 : MOV EDX,dword ptr [EDI + 0x4]
0053da39 : SUB EDX,dword ptr [EDI]
0053da3b : MOV EAX,dword ptr [EDI]
0053da3d : SAR EDX,0x1
0053da3f : PUSH EDX
0053da40 : PUSH EAX
0053da41 : MOV ECX,ESI
0053da43 : CALL 0x0053b7f0
0053da48 : JMP 0x0053da54
0053da4a : MOV ECX,dword ptr [EDI + 0x4]
0053da4d : SUB ECX,dword ptr [EDI]
0053da4f : SAR ECX,0x1
0053da51 : ADD dword ptr [EBP],ECX
0053da54 : CMP byte ptr [EDI + 0x10],0x0
0053da58 : MOV EAX,dword ptr [EDI + 0x4]
0053da5b : MOV dword ptr [EDI],EAX
0053da5d : JZ 0x0053da6e
0053da5f : CMP word ptr [EAX],0x26
0053da63 : JNZ 0x0053da6e
0053da65 : MOV ECX,EDI
0053da67 : CALL 0x0053bdd0
0053da6c : JMP 0x0053da7f
0053da6e : CMP EAX,dword ptr [EDI + 0x8]
0053da71 : JNC 0x0053da7f
0053da73 : MOVZX EDX,word ptr [EAX]
0053da76 : ADD EAX,0x2
0053da79 : MOV dword ptr [EDI + 0xc],EDX
0053da7c : MOV dword ptr [EDI + 0x4],EAX
0053da7f : MOV EAX,dword ptr [EDI]
0053da81 : CMP EAX,dword ptr [EDI + 0x8]
0053da84 : JC 0x0053d9b0
0053da8a : MOV byte ptr [ESI + 0x18],0x0
0053da8e : TEST BL,BL
0053da90 : JZ 0x0053daa1
0053da92 : MOV ECX,dword ptr [ESI + 0x1c]
0053da95 : MOV EDX,dword ptr [ESP + 0x1c]
0053da99 : MOV dword ptr [EDX],ECX
0053da9b : MOV EAX,dword ptr [ESI + 0x24]
0053da9e : MOV dword ptr [EBP],EAX
0053daa1 : MOV ECX,dword ptr [EDI]
0053daa3 : POP EBP
0053daa4 : POP EBX
0053daa5 : CMP ECX,dword ptr [EDI + 0x8]
0053daa8 : JC 0x0053dab3
0053daaa : MOV dword ptr [ESI + 0x4],0x1
0053dab1 : JMP 0x0053db07
0053dab3 : CMP byte ptr [EDI + 0x10],0x0
0053dab7 : MOV EAX,dword ptr [EDI + 0x4]
0053daba : MOV byte ptr [ESP + 0xb],0x1
0053dabf : MOV dword ptr [EDI],EAX
0053dac1 : JZ 0x0053dad2
0053dac3 : CMP word ptr [EAX],0x26
0053dac7 : JNZ 0x0053dad2
0053dac9 : MOV ECX,EDI
0053dacb : CALL 0x0053bdd0
0053dad0 : JMP 0x0053dae3
0053dad2 : CMP EAX,dword ptr [EDI + 0x8]
0053dad5 : JNC 0x0053dae3
0053dad7 : MOVZX EDX,word ptr [EAX]
0053dada : ADD EAX,0x2
0053dadd : MOV dword ptr [EDI + 0xc],EDX
0053dae0 : MOV dword ptr [EDI + 0x4],EAX
0053dae3 : MOV ECX,ESI
0053dae5 : CALL 0x0053c7a0
0053daea : MOV EAX,dword ptr [ESI + 0x14]
0053daed : CMP EAX,0x3e
0053daf0 : JZ 0x0053db00
0053daf2 : CMP EAX,0x2f
0053daf5 : JZ 0x0053db00
0053daf7 : MOV dword ptr [ESI + 0x4],0x7
0053dafe : JMP 0x0053db07
0053db00 : MOV dword ptr [ESI + 0x4],0x9
0053db07 : POP EDI
0053db08 : MOV EAX,dword ptr [ESI + 0x8]
0053db0b : CMP EAX,dword ptr [ESI + 0x10]
0053db0e : MOV AL,byte ptr [ESP + 0x7]
0053db12 : JC 0x0053db1b
0053db14 : MOV dword ptr [ESI + 0x4],0x1
0053db1b : POP ESI
0053db1c : ADD ESP,0x8
0053db1f : RET 0x8

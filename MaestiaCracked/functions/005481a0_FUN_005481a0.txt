PROGRAM  : Maestia.exe
FUNCTION : FUN_005481a0
ENTRY    : 005481a0
BODY     : [[005481a0, 005482dd]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005481a0(undefined4 param_1,uint *param_2,uint param_3)

{
  uint *puVar1;
  uint *puVar2;
  uint *puVar3;
  int *piVar4;
  int *in_ECX;
  uint *puVar5;
  uint uVar6;
  uint uVar7;
  int iVar8;
  
  piVar4 = (int *)*in_ECX;
  if (piVar4 == (int *)0x0) {
    iVar8 = 8;
  }
  else {
    if ((uint)(*piVar4 * 5) <= piVar4[1] * 4 + 4U) goto LAB_005481da;
    iVar8 = piVar4[1] * 2 + 2;
  }
  FUN_00547ba0(param_1,iVar8);
LAB_005481da:
  piVar4 = (int *)*in_ECX;
  param_3 = param_3 & piVar4[1];
  *piVar4 = *piVar4 + 1;
  iVar8 = *in_ECX;
  puVar1 = (uint *)(iVar8 + 8 + param_3 * 0xc);
  if (*(int *)(iVar8 + 8 + param_3 * 0xc) == -2) {
    *puVar1 = 0xffffffff;
    puVar1[1] = *param_2;
    piVar4 = (int *)param_2[1];
    if (piVar4 != (int *)0x0) {
      *piVar4 = *piVar4 + 1;
    }
    puVar1[2] = param_2[1];
    return;
  }
  uVar6 = param_3;
  do {
    uVar6 = uVar6 + 1 & *(uint *)(iVar8 + 4);
  } while (*(int *)(iVar8 + 8 + uVar6 * 0xc) != -2);
  puVar5 = puVar1 + 1;
  puVar2 = (uint *)(iVar8 + 8 + uVar6 * 0xc);
  uVar7 = *puVar5 & *(uint *)(iVar8 + 4);
  if (uVar7 != param_3) {
    puVar3 = (uint *)(iVar8 + 8 + uVar7 * 0xc);
    for (uVar7 = *(uint *)(iVar8 + 8 + uVar7 * 0xc); uVar7 != param_3;
        uVar7 = *(uint *)(iVar8 + 8 + uVar7 * 0xc)) {
      uVar7 = *puVar3;
      puVar3 = (uint *)(iVar8 + 8 + uVar7 * 0xc);
    }
    if (puVar2 != (uint *)0x0) {
      *puVar2 = *puVar1;
      puVar2[1] = *puVar5;
      piVar4 = (int *)puVar1[2];
      if (piVar4 != (int *)0x0) {
        *piVar4 = *piVar4 + 1;
      }
      puVar2[2] = puVar1[2];
    }
    *puVar3 = uVar6;
    FUN_00545920(param_2);
    *puVar1 = 0xffffffff;
    return;
  }
  if (puVar2 != (uint *)0x0) {
    *puVar2 = *puVar1;
    puVar2[1] = *puVar5;
    piVar4 = (int *)puVar1[2];
    if (piVar4 != (int *)0x0) {
      *piVar4 = *piVar4 + 1;
    }
    puVar2[2] = puVar1[2];
  }
  FUN_00545920(param_2);
  *puVar1 = uVar6;
  return;
}



============================================================
DISASSEMBLY
============================================================
005481a0 : PUSH ESI
005481a1 : MOV ESI,ECX
005481a3 : MOV EAX,dword ptr [ESI]
005481a5 : PUSH EDI
005481a6 : TEST EAX,EAX
005481a8 : JNZ 0x005481b3
005481aa : MOV EAX,dword ptr [ESP + 0xc]
005481ae : PUSH 0x8
005481b0 : PUSH EAX
005481b1 : JMP 0x005481d5
005481b3 : MOV ECX,dword ptr [EAX + 0x4]
005481b6 : LEA EDX,[ECX*0x4 + 0x4]
005481bd : MOV ECX,dword ptr [EAX]
005481bf : LEA ECX,[ECX + ECX*0x4]
005481c2 : CMP ECX,EDX
005481c4 : JBE 0x005481da
005481c6 : MOV EDX,dword ptr [EAX + 0x4]
005481c9 : MOV ECX,dword ptr [ESP + 0xc]
005481cd : LEA EAX,[EDX + EDX*0x1 + 0x2]
005481d1 : PUSH EAX
005481d2 : PUSH ECX
005481d3 : MOV ECX,ESI
005481d5 : CALL 0x00547ba0
005481da : MOV ECX,dword ptr [ESI]
005481dc : MOV EAX,dword ptr [ESP + 0x14]
005481e0 : AND EAX,dword ptr [ECX + 0x4]
005481e3 : INC dword ptr [ECX]
005481e5 : MOV EDX,dword ptr [ESI]
005481e7 : LEA ECX,[EAX + EAX*0x2]
005481ea : MOV ESI,dword ptr [EDX + ECX*0x4 + 0x8]
005481ee : LEA ECX,[EDX + ECX*0x4 + 0x8]
005481f2 : MOV EDI,0xfffffffe
005481f7 : MOV dword ptr [ESP + 0xc],ECX
005481fb : CMP ESI,EDI
005481fd : JNZ 0x00548222
005481ff : MOV EDX,dword ptr [ESP + 0x10]
00548203 : MOV dword ptr [ECX],0xffffffff
00548209 : MOV EAX,dword ptr [EDX]
0054820b : MOV dword ptr [ECX + 0x4],EAX
0054820e : MOV EAX,dword ptr [EDX + 0x4]
00548211 : TEST EAX,EAX
00548213 : JZ 0x00548217
00548215 : INC dword ptr [EAX]
00548217 : MOV EDX,dword ptr [EDX + 0x4]
0054821a : POP EDI
0054821b : MOV dword ptr [ECX + 0x8],EDX
0054821e : POP ESI
0054821f : RET 0xc
00548222 : PUSH EBX
00548223 : PUSH EBP
00548224 : MOV EBP,dword ptr [EDX + 0x4]
00548227 : MOV ESI,EAX
00548229 : LEA ESP,[ESP]
00548230 : INC ESI
00548231 : AND ESI,EBP
00548233 : LEA EBX,[ESI + ESI*0x2]
00548236 : CMP dword ptr [EDX + EBX*0x4 + 0x8],EDI
0054823a : JNZ 0x00548230
0054823c : LEA EDI,[ESI + ESI*0x2]
0054823f : ADD ECX,0x4
00548242 : LEA EBX,[EDX + EDI*0x4 + 0x8]
00548246 : MOV EDI,dword ptr [ECX]
00548248 : AND EDI,EBP
0054824a : CMP EDI,EAX
0054824c : JNZ 0x00548285
0054824e : TEST EBX,EBX
00548250 : JZ 0x0054826e
00548252 : MOV EAX,dword ptr [ESP + 0x14]
00548256 : MOV EAX,dword ptr [EAX]
00548258 : MOV dword ptr [EBX],EAX
0054825a : MOV EDX,dword ptr [ECX]
0054825c : MOV dword ptr [EBX + 0x4],EDX
0054825f : MOV EAX,dword ptr [ECX + 0x4]
00548262 : TEST EAX,EAX
00548264 : JZ 0x00548268
00548266 : INC dword ptr [EAX]
00548268 : MOV EAX,dword ptr [ECX + 0x4]
0054826b : MOV dword ptr [EBX + 0x8],EAX
0054826e : MOV EDX,dword ptr [ESP + 0x18]
00548272 : PUSH EDX
00548273 : CALL 0x00545920
00548278 : MOV EAX,dword ptr [ESP + 0x14]
0054827c : POP EBP
0054827d : POP EBX
0054827e : POP EDI
0054827f : MOV dword ptr [EAX],ESI
00548281 : POP ESI
00548282 : RET 0xc
00548285 : LEA EDI,[EDI + EDI*0x2]
00548288 : CMP dword ptr [EDX + EDI*0x4 + 0x8],EAX
0054828c : LEA EDI,[EDX + EDI*0x4 + 0x8]
00548290 : JZ 0x005482a1
00548292 : MOV EDI,dword ptr [EDI]
00548294 : LEA EDI,[EDI + EDI*0x2]
00548297 : CMP dword ptr [EDX + EDI*0x4 + 0x8],EAX
0054829b : LEA EDI,[EDX + EDI*0x4 + 0x8]
0054829f : JNZ 0x00548292
005482a1 : TEST EBX,EBX
005482a3 : JZ 0x005482c1
005482a5 : MOV EDX,dword ptr [ESP + 0x14]
005482a9 : MOV EAX,dword ptr [EDX]
005482ab : MOV dword ptr [EBX],EAX
005482ad : MOV EAX,dword ptr [ECX]
005482af : MOV dword ptr [EBX + 0x4],EAX
005482b2 : MOV EAX,dword ptr [ECX + 0x4]
005482b5 : TEST EAX,EAX
005482b7 : JZ 0x005482bb
005482b9 : INC dword ptr [EAX]
005482bb : MOV EDX,dword ptr [ECX + 0x4]
005482be : MOV dword ptr [EBX + 0x8],EDX
005482c1 : MOV EAX,dword ptr [ESP + 0x18]
005482c5 : PUSH EAX
005482c6 : MOV dword ptr [EDI],ESI
005482c8 : CALL 0x00545920
005482cd : MOV ECX,dword ptr [ESP + 0x14]
005482d1 : POP EBP
005482d2 : POP EBX
005482d3 : POP EDI
005482d4 : MOV dword ptr [ECX],0xffffffff
005482da : POP ESI
005482db : RET 0xc

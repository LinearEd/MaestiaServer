PROGRAM  : Maestia.exe
FUNCTION : FUN_006ed830
ENTRY    : 006ed830
BODY     : [[006ed830, 006ed929]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006ed830(void)

{
  HANDLE hObject;
  int iVar1;
  HANDLE pvVar2;
  undefined4 local_30;
  undefined4 uStack_2c;
  DWORD DStack_28;
  int iStack_24;
  undefined4 uStack_20;
  undefined4 uStack_1c;
  undefined4 uStack_18;
  
  local_30 = 0;
  uStack_2c = 0;
  DStack_28 = 0;
  iStack_24 = 0;
  uStack_20 = 0;
  uStack_1c = 0;
  uStack_18 = 0;
  DAT_01728940 = 0;
  hObject = (HANDLE)CreateToolhelp32Snapshot(4,DAT_0172793c);
  if (hObject != (HANDLE)0xffffffff) {
    uStack_2c = 0;
    DStack_28 = 0;
    iStack_24 = 0;
    uStack_20 = 0;
    uStack_1c = 0;
    uStack_18 = 0;
    local_30 = 0x1c;
    iVar1 = Thread32First(hObject,&local_30);
    while ((iVar1 != 0 && (DAT_01728940 < 0x200))) {
      if ((iStack_24 == DAT_0172793c) &&
         ((DStack_28 != 0 && (pvVar2 = OpenThread(10,0,DStack_28), pvVar2 != (HANDLE)0x0)))) {
        (&DAT_01728140)[DAT_01728940] = DStack_28;
        (&DAT_01727940)[DAT_01728940] = pvVar2;
        DAT_01728940 = DAT_01728940 + 1;
      }
      iVar1 = Thread32Next(hObject,&local_30);
    }
    CloseHandle(hObject);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
006ed830 : PUSH EBX
006ed831 : MOV EBX,ESP
006ed833 : SUB ESP,0x8
006ed836 : AND ESP,0xfffffff0
006ed839 : ADD ESP,0x4
006ed83c : PUSH EBP
006ed83d : MOV EBP,dword ptr [EBX + 0x4]
006ed840 : MOV dword ptr [ESP + 0x4],EBP
006ed844 : MOV EBP,ESP
006ed846 : SUB ESP,0x28
006ed849 : MOV EAX,[0x0172793c]
006ed84e : PUSH ESI
006ed84f : PUSH EDI
006ed850 : PXOR XMM0,XMM0
006ed854 : PUSH EAX
006ed855 : XOR ESI,ESI
006ed857 : PUSH 0x4
006ed859 : MOV dword ptr [EBP + -0x20],ESI
006ed85c : MOVQ qword ptr [EBP + -0x1c],XMM0
006ed861 : MOVQ qword ptr [EBP + -0x14],XMM0
006ed866 : MOVQ qword ptr [EBP + -0xc],XMM0
006ed86b : MOV dword ptr [0x01728940],ESI
006ed871 : CALL 0x0061147a
006ed876 : MOV EDI,EAX
006ed878 : CMP EDI,-0x1
006ed87b : JZ 0x006ed921
006ed881 : LEA ECX,[EBP + -0x20]
006ed884 : PXOR XMM0,XMM0
006ed888 : PUSH ECX
006ed889 : MOVDQA xmmword ptr [EBP + -0x20],XMM0
006ed88e : PUSH EDI
006ed88f : MOVQ qword ptr [EBP + -0x10],XMM0
006ed894 : MOV dword ptr [EBP + -0x8],ESI
006ed897 : MOV dword ptr [EBP + -0x20],0x1c
006ed89e : CALL 0x006d486a
006ed8a3 : TEST EAX,EAX
006ed8a5 : JZ 0x006ed91a
006ed8a7 : CMP dword ptr [0x01728940],0x200
006ed8b1 : JNC 0x006ed91a
006ed8b3 : MOV ESI,dword ptr [0x00b852ec]
006ed8b9 : LEA ESP,[ESP]
006ed8c0 : MOV EDX,dword ptr [EBP + -0x14]
006ed8c3 : CMP EDX,dword ptr [0x0172793c]
006ed8c9 : JNZ 0x006ed900
006ed8cb : MOV EAX,dword ptr [EBP + -0x18]
006ed8ce : TEST EAX,EAX
006ed8d0 : JZ 0x006ed900
006ed8d2 : PUSH EAX
006ed8d3 : PUSH 0x0
006ed8d5 : PUSH 0xa
006ed8d7 : CALL ESI
006ed8d9 : TEST EAX,EAX
006ed8db : JZ 0x006ed900
006ed8dd : MOV ECX,dword ptr [0x01728940]
006ed8e3 : MOV EDX,dword ptr [EBP + -0x18]
006ed8e6 : MOV dword ptr [ECX*0x4 + 0x1728140],EDX
006ed8ed : MOV ECX,dword ptr [0x01728940]
006ed8f3 : MOV dword ptr [ECX*0x4 + 0x1727940],EAX
006ed8fa : INC dword ptr [0x01728940]
006ed900 : LEA EDX,[EBP + -0x20]
006ed903 : PUSH EDX
006ed904 : PUSH EDI
006ed905 : CALL 0x006d4870
006ed90a : TEST EAX,EAX
006ed90c : JZ 0x006ed91a
006ed90e : CMP dword ptr [0x01728940],0x200
006ed918 : JC 0x006ed8c0
006ed91a : PUSH EDI
006ed91b : CALL dword ptr [0x00b85104]
006ed921 : POP EDI
006ed922 : POP ESI
006ed923 : MOV ESP,EBP
006ed925 : POP EBP
006ed926 : MOV ESP,EBX
006ed928 : POP EBX
006ed929 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00789620
ENTRY    : 00789620
BODY     : [[00789620, 0078980c] [00789810, 007898d9] [007898e0, 007899d7] [007899e0, 00789efd]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00789620(GImageBase *param_1,byte param_2)

{
  GImageBase *pGVar1;
  int *piVar2;
  bool bVar3;
  GImageBase *pGVar4;
  ulong uVar5;
  char cVar6;
  uint uVar7;
  GImage *pGVar8;
  GImage *pGVar9;
  int iVar10;
  int iVar11;
  GRefCountNTSImpl *pGVar12;
  undefined4 uVar13;
  GImageBase *in_ECX;
  uint uVar14;
  ImageFormat IVar15;
  undefined1 *puVar16;
  undefined4 uVar17;
  undefined1 *puVar18;
  undefined4 unaff_EBX;
  GRefCountNTSImpl *pGStack_84;
  uint uStack_80;
  uint uStack_7c;
  GImage *pGStack_78;
  uint uStack_74;
  GImageBase *pGStack_70;
  int *piStack_68;
  GImageBase *local_64;
  GImage *pGStack_60;
  ulong uStack_5c;
  GImage *pGStack_58;
  undefined4 uStack_54;
  undefined4 uStack_50;
  ulong uStack_4c;
  GImage *pGStack_48;
  undefined4 uStack_44;
  undefined4 uStack_40;
  ulong uStack_3c;
  GImage *pGStack_38;
  undefined1 auStack_34 [32];
  void *local_14;
  undefined1 *puStack_10;
  int iStack_c;
  
  iStack_c = 0xffffffff;
  puStack_10 = &LAB_00b194c5;
  local_14 = ExceptionList;
  uVar7 = DAT_00d66fa0 ^ (uint)&stack0xffffff70;
  iVar10 = *(int *)(in_ECX + 0x24);
  if (iVar10 == 0) {
    return 0;
  }
  if (*(int *)(iVar10 + 0xf0) == 0) {
    return 0;
  }
  ExceptionList = &local_14;
  *(int *)(iVar10 + 0x2e4) = *(int *)(iVar10 + 0x2e4) + 1;
  local_64 = in_ECX;
  (**(code **)(*(int *)in_ECX + 0x3c))(uVar7);
  if ((param_1 == (GImageBase *)0x0) || (*(int *)(param_1 + 0x10) == 0)) {
    FUN_00740690(0);
    ExceptionList = local_14;
    return 1;
  }
  iVar10 = *(int *)param_1;
  bVar3 = false;
  if (iVar10 == 1) {
    uStack_74 = 4;
    if ((*(uint *)(param_1 + 4) < 0x400) || (*(uint *)(param_1 + 8) < 0x300)) {
LAB_00789711:
      *(int *)(in_ECX + 0x1c) = 0x15;
    }
    else {
      *(int *)(in_ECX + 0x1c) = 0x35545844;
      if (((byte)param_1[4] & 3) != 0) {
LAB_00789709:
        bVar3 = true;
        pGStack_70 = (GImageBase *)0x15;
        goto LAB_0078975b;
      }
      if (((byte)param_1[8] & 3) != 0) {
        bVar3 = true;
        pGStack_70 = (GImageBase *)0x15;
        goto LAB_0078975b;
      }
    }
LAB_00789714:
    pGStack_70 = (GImageBase *)0x15;
  }
  else {
    if (iVar10 == 2) {
      uStack_74 = 3;
      if ((0x3ff < *(uint *)(param_1 + 4)) && (0x2ff < *(uint *)(param_1 + 8))) {
        *(int *)(in_ECX + 0x1c) = 0x31545844;
        if ((((byte)param_1[4] & 3) == 0) && (((byte)param_1[8] & 3) == 0)) goto LAB_00789714;
        goto LAB_00789709;
      }
      goto LAB_00789711;
    }
    if (iVar10 == 9) {
      pGStack_70 = *(GImageBase **)(*(int *)(in_ECX + 0x24) + 0x108);
    }
    else if (iVar10 == 10) {
      pGStack_70 = (GImageBase *)0x31545844;
    }
    else if (iVar10 == 0xb) {
      pGStack_70 = (GImageBase *)0x33545844;
    }
    else {
      if (iVar10 != 0xc) {
        ExceptionList = local_14;
        return 0;
      }
      pGStack_70 = (GImageBase *)0x35545844;
    }
    uStack_74 = 1;
    *(GImageBase **)(in_ECX + 0x1c) = pGStack_70;
  }
LAB_0078975b:
  in_ECX[0x20] = *(GImageBase *)(*(int *)(in_ECX + 0x24) + 0x289);
  uVar7 = *(uint *)(param_1 + 4);
  pGVar9 = *(GImage **)(param_1 + 8);
  if ((bVar3) ||
     (uStack_7c = uVar7, pGStack_78 = pGVar9,
     *(int *)(*(int *)(in_ECX + 0x24) + 0x14) < (int)(((param_2 & 1) != 0) + 1))) {
    uVar14 = 1;
    uStack_7c = 1;
    if (1 < uVar7) {
      do {
        uVar14 = uVar14 * 2;
        uStack_7c = uVar14;
      } while (uVar14 < uVar7);
    }
    pGVar8 = (GImage *)0x1;
    pGStack_78 = (GImage *)0x1;
    if ((GImage *)0x1 < pGVar9) {
      do {
        pGVar8 = (GImage *)((int)pGVar8 * 2);
        pGStack_78 = pGVar8;
      } while (pGVar8 < pGVar9);
    }
  }
  *(uint *)(in_ECX + 0x28) = uStack_7c;
  *(GImage **)(in_ECX + 0x2c) = pGStack_78;
  if (((*(int *)param_1 < 10) || (0xc < *(int *)param_1)) && (*(uint *)(param_1 + 0x18) < 2)) {
    uStack_80 = 1;
    uVar7 = uStack_7c;
    for (pGVar9 = pGStack_78; (1 < uVar7 && ((GImage *)0x1 < pGVar9));
        pGVar9 = (GImage *)((uint)pGVar9 >> 1)) {
      uVar7 = uVar7 >> 1;
      uStack_80 = uStack_80 + 1;
    }
  }
  else {
    uVar7 = *(uint *)(param_1 + 4);
    uStack_80 = 1;
    for (uVar14 = *(uint *)(param_1 + 8); (1 < uVar7 && (1 < uVar14)); uVar14 = uVar14 >> 1) {
      uVar7 = uVar7 >> 1;
      uStack_80 = uStack_80 + 1;
    }
  }
  pGStack_84 = (GRefCountNTSImpl *)0x0;
  iStack_c = 0;
  iVar10 = *(int *)param_1;
  if (((iVar10 < 10) || (0xc < iVar10)) &&
     ((uStack_7c != *(ulong *)(param_1 + 4) ||
      ((pGStack_78 != *(GImage **)(param_1 + 8) || (iVar10 == 2)))))) {
    pGStack_58 = (GImage *)FUN_00475fa0(0x30);
    iStack_c._0_1_ = 1;
    if (pGStack_58 == (GImage *)0x0) {
      pGStack_84 = (GRefCountNTSImpl *)0x0;
    }
    else {
      IVar15 = *(ImageFormat *)param_1;
      if (IVar15 == 2) {
        IVar15 = 1;
      }
      pGStack_84 = (GRefCountNTSImpl *)GImage::GImage(pGStack_58,IVar15,uStack_7c,(ulong)pGStack_78)
      ;
    }
    iStack_c = (uint)iStack_c._1_3_ << 8;
    if (pGStack_84 != (GRefCountNTSImpl *)0x0) {
      if ((uStack_7c == *(ulong *)(param_1 + 4)) && (pGStack_78 == *(GImage **)(param_1 + 8))) {
        if ((*(int *)param_1 == 2) && (pGStack_60 = (GImage *)0x0, pGStack_78 != (GImage *)0x0)) {
          do {
            if (uStack_7c != 0) {
              puVar16 = (undefined1 *)
                        (*(int *)(pGStack_84 + 0x14) * (int)pGStack_60 + *(int *)(pGStack_84 + 0x18)
                        + 2);
              puVar18 = (undefined1 *)
                        (*(int *)(param_1 + 0xc) * (int)pGStack_60 + *(int *)(param_1 + 0x10) + 2);
              uVar7 = uStack_7c;
              do {
                puVar16[-2] = puVar18[-2];
                puVar16[-1] = puVar18[-1];
                *puVar16 = *puVar18;
                puVar16[1] = 0xff;
                puVar18 = puVar18 + 3;
                puVar16 = puVar16 + 4;
                uVar7 = uVar7 - 1;
                in_ECX = local_64;
              } while (uVar7 != 0);
            }
            pGStack_60 = pGStack_60 + 1;
          } while (pGStack_60 < pGStack_78);
        }
      }
      else {
        FUN_00787b90(*(undefined4 *)(pGStack_84 + 0x18),pGStack_78,
                     *(undefined4 *)(pGStack_84 + 0x14),*(undefined4 *)(param_1 + 0x10),
                     *(ulong *)(param_1 + 4),*(undefined4 *)(param_1 + 8));
        *(int *)(in_ECX + 0x34) = 1;
        iVar10 = *(int *)(param_1 + 4);
        *(int *)(in_ECX + 0x38) = iVar10;
        iVar11 = *(int *)(param_1 + 8);
        *(float *)(in_ECX + 0x40) = (float)iVar10 / (float)*(int *)(in_ECX + 0x28);
        *(int *)(in_ECX + 0x3c) = iVar11;
        *(float *)(in_ECX + 0x44) = (float)iVar11 / (float)*(int *)(in_ECX + 0x2c);
      }
      if (1 < *(uint *)(param_1 + 0x18)) {
        uStack_80 = 1;
      }
    }
  }
  if ((*(uint *)(param_1 + 0x18) < 2) && (uStack_74 != 1)) {
    uStack_80 = 1;
  }
  else {
    uVar7 = uStack_80 - 1;
    uStack_80 = 1;
    if (uVar7 != 0) {
      uStack_80 = uVar7;
    }
  }
  pGVar1 = in_ECX + 0x48;
  while( true ) {
    pGVar4 = pGStack_70;
    iVar10 = *(int *)(in_ECX + 0x24);
    if ((*(char *)(iVar10 + 0x289) == '\0') || (uVar17 = 1, *(char *)(iVar10 + 0x28a) != '\0')) {
      uVar17 = 2;
    }
    iVar10 = (**(code **)(**(int **)(iVar10 + 0xf0) + 0x5c))
                       (*(int **)(iVar10 + 0xf0),uStack_7c,pGStack_78,uStack_80,0,
                        *(int *)(in_ECX + 0x1c),uVar17,pGVar1,0);
    if (iVar10 == 0) break;
    if (*(int *)(in_ECX + 0x1c) == 0x1c) {
      *(undefined4 *)(*(int *)(in_ECX + 0x24) + 0x108) = 0x33;
      *(int *)(in_ECX + 0x1c) = 0x33;
      pGStack_70 = (GImageBase *)0x33;
    }
    else {
      if (*(int *)(in_ECX + 0x1c) != 0x33) goto LAB_00789ac0;
      *(undefined4 *)(*(int *)(in_ECX + 0x24) + 0x108) = 0x1a;
      *(int *)(in_ECX + 0x1c) = 0x1a;
      pGStack_70 = (GImageBase *)0x1a;
    }
  }
  piStack_68 = (int *)0x0;
  if ((*(char *)(*(int *)(in_ECX + 0x24) + 0x28a) == '\0') ||
     (piVar2 = *(int **)(*(int *)(in_ECX + 0x24) + 0xf0),
     iVar10 = (**(code **)(*piVar2 + 0x5c))
                        (piVar2,uStack_7c,pGStack_78,uStack_80,0,*(int *)(in_ECX + 0x1c),0,
                         &piStack_68,0), iVar10 == 0)) {
    cVar6 = FUN_00475fc0();
    if ((cVar6 != '\0') || (1 < *(uint *)(param_1 + 0x18))) {
      pGStack_60 = (GImage *)0x0;
      if (pGStack_84 == (GRefCountNTSImpl *)0x0) {
        local_64 = param_1;
      }
      else {
        local_64 = (GImageBase *)(pGStack_84 + 8);
      }
      uStack_3c = uStack_7c;
      uStack_44 = 0;
      uStack_40 = 0;
      pGStack_38 = pGStack_78;
      pGStack_70 = (GImageBase *)0x20;
      if (pGVar4 != (GImageBase *)0x15) {
        pGStack_70 = pGVar4;
      }
      uStack_74 = 0;
      if (uStack_80 == 0) goto LAB_00789e1a;
      goto LAB_00789d57;
    }
    if (((uStack_74 == 1) && (1 < uStack_80)) && (pGStack_84 == (GRefCountNTSImpl *)0x0)) {
      pGStack_84 = (GRefCountNTSImpl *)
                   FUN_00519a90(*(undefined4 *)param_1,*(undefined4 *)(param_1 + 4),
                                *(undefined4 *)(param_1 + 8),0);
      _memcpy(*(void **)(pGStack_84 + 0x18),*(void **)(param_1 + 0x10),
              *(int *)(param_1 + 0xc) * *(int *)(param_1 + 8));
    }
    local_64 = (GImageBase *)0x0;
    if (pGStack_84 == (GRefCountNTSImpl *)0x0) {
      pGStack_70 = param_1;
    }
    else {
      pGStack_70 = (GImageBase *)(pGStack_84 + 8);
    }
    uStack_4c = uStack_7c;
    uStack_54 = 0;
    uStack_50 = 0;
    pGStack_48 = pGStack_78;
    pGStack_78 = (GImage *)0x0;
    iVar10 = (uint)(uStack_74 != 1) * 4;
    if (uStack_80 == 0) goto LAB_00789e1a;
    goto LAB_00789ba0;
  }
  (**(code **)(**(int **)pGVar1 + 8))(*(int **)pGVar1);
  *(int *)pGVar1 = 0;
  goto LAB_00789ac0;
  while( true ) {
    uVar17 = FUN_00519580(uStack_74,&uStack_5c,&pGStack_58,0);
    uVar5 = uStack_5c;
    uStack_3c = uStack_5c;
    pGStack_38 = pGStack_58;
    cVar6 = FUN_00475fc0();
    if (cVar6 == '\0') {
      uVar13 = FUN_00518fc0(*(int *)local_64,uVar5);
    }
    else {
      uVar13 = FUN_005194f0(*(int *)local_64,uVar5,1);
    }
    iVar10 = D3DXLoadSurfaceFromMemory
                       (pGStack_60,0,0,uVar17,pGStack_70,uVar13,0,&uStack_44,0xffffffff,0);
    (**(code **)(*(int *)pGStack_60 + 8))(pGStack_60);
    pGStack_60 = (GImage *)0x0;
    if (iVar10 != 0) goto LAB_00789ce9;
    uStack_74 = uStack_74 + 1;
    if (uStack_80 <= uStack_74) break;
LAB_00789d57:
    pGStack_60 = (GImage *)0x0;
    iVar10 = (**(code **)(**(int **)pGVar1 + 0x48))(*(int **)pGVar1,uStack_74,&pGStack_60);
    if (iVar10 != 0) goto LAB_00789ce9;
  }
  goto LAB_00789e1a;
LAB_00789ce9:
  (**(code **)(**(int **)pGVar1 + 8))(*(int **)pGVar1);
  *(int *)pGVar1 = 0;
LAB_00789cd0:
  if (piStack_68 != (int *)0x0) {
    (**(code **)(*piStack_68 + 8))(piStack_68);
  }
  goto LAB_00789ac0;
  while( true ) {
    pGVar9 = pGStack_58;
    if (uStack_80 != 1) {
      pGVar9 = *(GImage **)(iVar10 + 0x28);
    }
    iVar11 = D3DXLoadSurfaceFromMemory
                       (pGStack_70,0,0,*(undefined4 *)(iVar10 + 0x2c),unaff_EBX,pGVar9,0,&pGStack_60
                        ,0xffffffff,0);
    (**(code **)(*(int *)pGStack_70 + 8))(pGStack_70);
    local_64 = (GImageBase *)0x0;
    if (iVar11 != 0) goto LAB_00789ce9;
    if (pGStack_78 < uStack_80 - 1) {
      if (pGStack_70 == param_1) {
        pGVar9 = (GImage *)FUN_00475fa0(0x30);
        iStack_c._0_1_ = 2;
        if (pGVar9 == (GImage *)0x0) {
          pGVar12 = (GRefCountNTSImpl *)0x0;
        }
        else {
          pGVar12 = (GRefCountNTSImpl *)GImage::GImage(pGVar9,param_1);
        }
        iStack_c = (uint)iStack_c._1_3_ << 8;
        if (pGVar12 != (GRefCountNTSImpl *)0x0) {
          *(int *)(pGVar12 + 4) = *(int *)(pGVar12 + 4) + 1;
        }
        if (pGStack_84 != (GRefCountNTSImpl *)0x0) {
          GRefCountNTSImpl::Release(pGStack_84);
        }
        pGStack_84 = pGVar12;
        if (pGVar12 == (GRefCountNTSImpl *)0x0) {
          pGStack_70 = (GImageBase *)0x0;
        }
        else {
          pGStack_70 = (GImageBase *)(pGVar12 + 8);
        }
      }
      FUN_00480140(&uStack_4c,&pGStack_48,*(int *)(pGStack_70 + 0x10));
    }
    pGStack_78 = (GImage *)((int)pGStack_78 + 1);
    if (uStack_80 <= pGStack_78) break;
LAB_00789ba0:
    iVar11 = (**(code **)(**(int **)pGVar1 + 0x48))(*(int **)pGVar1,pGStack_78,&local_64);
    if (iVar11 != 0) {
      (**(code **)(**(int **)pGVar1 + 8))(*(int **)pGVar1);
      *(int *)pGVar1 = 0;
      goto LAB_00789cd0;
    }
  }
LAB_00789e1a:
  if (piStack_68 != (int *)0x0) {
    iVar10 = (**(code **)(**(int **)(*(int *)(in_ECX + 0x24) + 0xf0) + 0x7c))
                       (*(int **)(*(int *)(in_ECX + 0x24) + 0xf0),*(int *)pGVar1,piStack_68);
    if (iVar10 < 0) {
      FUN_00406460(L"updatetexture failed");
      iStack_c._0_1_ = 3;
      if ((int *)*DAT_00da98e8 != (int *)0x0) {
        (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                  (L"GTextureD3D9Impl::InitTexture",0x128b,auStack_34);
      }
      iStack_c = (uint)iStack_c._1_3_ << 8;
      FUN_00406560();
LAB_00789ac0:
      iStack_c = 0xffffffff;
      if (pGStack_84 != (GRefCountNTSImpl *)0x0) {
        GRefCountNTSImpl::Release(pGStack_84);
      }
      ExceptionList = local_14;
      return 0;
    }
    (**(code **)(**(int **)pGVar1 + 8))(*(int **)pGVar1);
    *(int **)pGVar1 = piStack_68;
  }
  FUN_00740690(0);
  iStack_c = 0xffffffff;
  if (pGStack_84 == (GRefCountNTSImpl *)0x0) {
    ExceptionList = local_14;
    return 1;
  }
  GRefCountNTSImpl::Release(pGStack_84);
  ExceptionList = local_14;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
00789620 : PUSH EBP
00789621 : MOV EBP,ESP
00789623 : AND ESP,0xfffffff8
00789626 : PUSH -0x1
00789628 : PUSH 0xb194c5
0078962d : MOV EAX,FS:[0x0]
00789633 : PUSH EAX
00789634 : SUB ESP,0x70
00789637 : PUSH EBX
00789638 : PUSH ESI
00789639 : PUSH EDI
0078963a : MOV EAX,[0x00d66fa0]
0078963f : XOR EAX,ESP
00789641 : PUSH EAX
00789642 : LEA EAX,[ESP + 0x80]
00789649 : MOV FS:[0x0],EAX
0078964f : MOV EBX,ECX
00789651 : MOV dword ptr [ESP + 0x30],EBX
00789655 : MOV EAX,dword ptr [EBX + 0x24]
00789658 : TEST EAX,EAX
0078965a : JZ 0x00789ad8
00789660 : CMP dword ptr [EAX + 0xf0],0x0
00789667 : JZ 0x00789ad8
0078966d : MOV EDI,0x1
00789672 : ADD dword ptr [EAX + 0x2e4],EDI
00789678 : MOV EAX,dword ptr [EBX]
0078967a : MOV EDX,dword ptr [EAX + 0x3c]
0078967d : CALL EDX
0078967f : MOV ESI,dword ptr [EBP + 0x8]
00789682 : TEST ESI,ESI
00789684 : JZ 0x00789edb
0078968a : CMP dword ptr [ESI + 0x10],0x0
0078968e : JZ 0x00789edb
00789694 : MOV EAX,dword ptr [ESI]
00789696 : XOR DL,DL
00789698 : LEA ECX,[EDI + 0x14]
0078969b : CMP EAX,EDI
0078969d : JNZ 0x007896d7
0078969f : CMP dword ptr [ESI + 0x4],0x400
007896a6 : MOV dword ptr [ESP + 0x20],0x4
007896ae : JC 0x00789711
007896b0 : CMP dword ptr [ESI + 0x8],0x300
007896b7 : JC 0x00789711
007896b9 : MOV dword ptr [EBX + 0x1c],0x35545844
007896c0 : TEST byte ptr [ESI + 0x4],0x3
007896c4 : JNZ 0x00789709
007896c6 : TEST byte ptr [ESI + 0x8],0x3
007896ca : JZ 0x00789714
007896cc : MOV DL,0x1
007896ce : MOV dword ptr [ESP + 0x24],ECX
007896d2 : JMP 0x0078975b
007896d7 : CMP EAX,0x2
007896da : JNZ 0x0078971a
007896dc : CMP dword ptr [ESI + 0x4],0x400
007896e3 : MOV dword ptr [ESP + 0x20],0x3
007896eb : JC 0x00789711
007896ed : CMP dword ptr [ESI + 0x8],0x300
007896f4 : JC 0x00789711
007896f6 : MOV dword ptr [EBX + 0x1c],0x31545844
007896fd : TEST byte ptr [ESI + 0x4],0x3
00789701 : JNZ 0x00789709
00789703 : TEST byte ptr [ESI + 0x8],0x3
00789707 : JZ 0x00789714
00789709 : MOV DL,0x1
0078970b : MOV dword ptr [ESP + 0x24],ECX
0078970f : JMP 0x0078975b
00789711 : MOV dword ptr [EBX + 0x1c],ECX
00789714 : MOV dword ptr [ESP + 0x24],ECX
00789718 : JMP 0x0078975b
0078971a : CMP EAX,0x9
0078971d : JNZ 0x0078972a
0078971f : MOV EAX,dword ptr [EBX + 0x24]
00789722 : MOV EAX,dword ptr [EAX + 0x108]
00789728 : JMP 0x00789750
0078972a : CMP EAX,0xa
0078972d : JNZ 0x00789736
0078972f : MOV EAX,0x31545844
00789734 : JMP 0x00789750
00789736 : CMP EAX,0xb
00789739 : JNZ 0x00789742
0078973b : MOV EAX,0x33545844
00789740 : JMP 0x00789750
00789742 : CMP EAX,0xc
00789745 : JNZ 0x00789ad8
0078974b : MOV EAX,0x35545844
00789750 : MOV dword ptr [ESP + 0x20],EDI
00789754 : MOV dword ptr [ESP + 0x24],EAX
00789758 : MOV dword ptr [EBX + 0x1c],EAX
0078975b : MOV ECX,dword ptr [EBX + 0x24]
0078975e : MOV AL,byte ptr [ECX + 0x289]
00789764 : MOV byte ptr [EBX + 0x20],AL
00789767 : MOV EAX,dword ptr [ESI + 0x4]
0078976a : MOV EDI,dword ptr [ESI + 0x8]
0078976d : MOV dword ptr [ESP + 0x18],EAX
00789771 : MOV dword ptr [ESP + 0x1c],EDI
00789775 : TEST DL,DL
00789777 : JNZ 0x0078978b
00789779 : TEST byte ptr [EBP + 0xc],0x1
0078977d : MOV EDX,0x0
00789782 : SETNZ DL
00789785 : INC EDX
00789786 : CMP dword ptr [ECX + 0x14],EDX
00789789 : JGE 0x007897bc
0078978b : MOV ECX,0x1
00789790 : MOV dword ptr [ESP + 0x18],ECX
00789794 : CMP EAX,ECX
00789796 : JBE 0x007897a2
00789798 : ADD ECX,ECX
0078979a : CMP ECX,EAX
0078979c : JC 0x00789798
0078979e : MOV dword ptr [ESP + 0x18],ECX
007897a2 : MOV EAX,0x1
007897a7 : MOV dword ptr [ESP + 0x1c],EAX
007897ab : CMP EDI,EAX
007897ad : JBE 0x007897c2
007897af : NOP
007897b0 : ADD EAX,EAX
007897b2 : CMP EAX,EDI
007897b4 : JC 0x007897b0
007897b6 : MOV dword ptr [ESP + 0x1c],EAX
007897ba : JMP 0x007897c2
007897bc : MOV ECX,dword ptr [ESP + 0x18]
007897c0 : MOV EAX,EDI
007897c2 : MOV dword ptr [EBX + 0x28],ECX
007897c5 : MOV dword ptr [EBX + 0x2c],EAX
007897c8 : MOV EDX,dword ptr [ESI]
007897ca : CMP EDX,0xa
007897cd : JL 0x007897d4
007897cf : CMP EDX,0xc
007897d2 : JLE 0x007897f8
007897d4 : CMP dword ptr [ESI + 0x18],0x1
007897d8 : JA 0x007897f8
007897da : MOV EDX,0x1
007897df : MOV dword ptr [ESP + 0x14],EDX
007897e3 : CMP ECX,EDX
007897e5 : JBE 0x00789823
007897e7 : CMP EAX,0x1
007897ea : JBE 0x0078981f
007897ec : SHR ECX,0x1
007897ee : SHR EAX,0x1
007897f0 : INC EDX
007897f1 : CMP ECX,0x1
007897f4 : JA 0x007897e7
007897f6 : JMP 0x0078981f
007897f8 : MOV EAX,dword ptr [ESI + 0x4]
007897fb : MOV ECX,dword ptr [ESI + 0x8]
007897fe : MOV EDX,0x1
00789803 : MOV dword ptr [ESP + 0x14],EDX
00789807 : CMP EAX,EDX
00789809 : JBE 0x00789823
0078980b : JMP 0x00789810
00789810 : CMP ECX,0x1
00789813 : JBE 0x0078981f
00789815 : SHR EAX,0x1
00789817 : SHR ECX,0x1
00789819 : INC EDX
0078981a : CMP EAX,0x1
0078981d : JA 0x00789810
0078981f : MOV dword ptr [ESP + 0x14],EDX
00789823 : XOR EAX,EAX
00789825 : MOV dword ptr [ESP + 0x10],EAX
00789829 : MOV dword ptr [ESP + 0x88],EAX
00789830 : MOV EAX,dword ptr [ESI]
00789832 : CMP EAX,0xa
00789835 : JL 0x00789840
00789837 : CMP EAX,0xc
0078983a : JLE 0x007899a8
00789840 : MOV ECX,dword ptr [ESP + 0x18]
00789844 : CMP ECX,dword ptr [ESI + 0x4]
00789847 : JNZ 0x0078985b
00789849 : MOV EDX,dword ptr [ESP + 0x1c]
0078984d : CMP EDX,dword ptr [ESI + 0x8]
00789850 : JNZ 0x0078985b
00789852 : CMP EAX,0x2
00789855 : JNZ 0x007899a8
0078985b : PUSH 0x30
0078985d : CALL 0x00475fa0
00789862 : ADD ESP,0x4
00789865 : MOV dword ptr [ESP + 0x3c],EAX
00789869 : MOV byte ptr [ESP + 0x88],0x1
00789871 : TEST EAX,EAX
00789873 : JZ 0x00789895
00789875 : MOV ECX,dword ptr [ESI]
00789877 : CMP ECX,0x2
0078987a : JNZ 0x00789881
0078987c : MOV ECX,0x1
00789881 : MOV EDX,dword ptr [ESP + 0x1c]
00789885 : PUSH EDX
00789886 : MOV EDX,dword ptr [ESP + 0x1c]
0078988a : PUSH EDX
0078988b : PUSH ECX
0078988c : MOV ECX,EAX
0078988e : CALL 0x005199d0
00789893 : JMP 0x00789897
00789895 : XOR EAX,EAX
00789897 : MOV byte ptr [ESP + 0x88],0x0
0078989f : MOV dword ptr [ESP + 0x10],EAX
007898a3 : TEST EAX,EAX
007898a5 : JZ 0x007899a8
007898ab : MOV ECX,dword ptr [ESI + 0x4]
007898ae : CMP dword ptr [ESP + 0x18],ECX
007898b2 : JNZ 0x0078993a
007898b8 : MOV EDX,dword ptr [ESP + 0x1c]
007898bc : CMP EDX,dword ptr [ESI + 0x8]
007898bf : JNZ 0x0078993a
007898c1 : CMP dword ptr [ESI],0x2
007898c4 : JNZ 0x0078999a
007898ca : XOR EDI,EDI
007898cc : MOV dword ptr [ESP + 0x34],EDI
007898d0 : CMP EDX,EDI
007898d2 : JBE 0x0078999a
007898d8 : JMP 0x007898e0
007898e0 : MOV EDX,dword ptr [ESI + 0xc]
007898e3 : MOV ECX,dword ptr [EAX + 0x14]
007898e6 : IMUL EDX,EDI
007898e9 : ADD EDX,dword ptr [ESI + 0x10]
007898ec : IMUL ECX,EDI
007898ef : ADD ECX,dword ptr [EAX + 0x18]
007898f2 : CMP dword ptr [ESP + 0x18],0x0
007898f7 : JBE 0x0078992d
007898f9 : MOV EDI,dword ptr [ESP + 0x18]
007898fd : ADD ECX,0x2
00789900 : ADD EDX,0x2
00789903 : MOVZX EBX,byte ptr [EDX + -0x2]
00789907 : MOV byte ptr [ECX + -0x2],BL
0078990a : MOVZX EBX,byte ptr [EDX + -0x1]
0078990e : MOV byte ptr [ECX + -0x1],BL
00789911 : MOVZX EBX,byte ptr [EDX]
00789914 : MOV byte ptr [ECX],BL
00789916 : MOV byte ptr [ECX + 0x1],0xff
0078991a : ADD EDX,0x3
0078991d : ADD ECX,0x4
00789920 : SUB EDI,0x1
00789923 : JNZ 0x00789903
00789925 : MOV EDI,dword ptr [ESP + 0x34]
00789929 : MOV EBX,dword ptr [ESP + 0x30]
0078992d : INC EDI
0078992e : MOV dword ptr [ESP + 0x34],EDI
00789932 : CMP EDI,dword ptr [ESP + 0x1c]
00789936 : JC 0x007898e0
00789938 : JMP 0x0078999a
0078993a : MOV EDX,dword ptr [ESI + 0x8]
0078993d : MOV EDI,dword ptr [ESI + 0xc]
00789940 : PUSH EDX
00789941 : MOV EDX,dword ptr [EAX + 0x14]
00789944 : PUSH ECX
00789945 : MOV ECX,dword ptr [ESI + 0x10]
00789948 : PUSH ECX
00789949 : MOV ECX,dword ptr [ESP + 0x28]
0078994d : PUSH EDX
0078994e : MOV EDX,dword ptr [EAX + 0x18]
00789951 : MOV EAX,dword ptr [ESP + 0x30]
00789955 : PUSH ECX
00789956 : MOV ECX,dword ptr [ESP + 0x2c]
0078995a : PUSH EDX
0078995b : CALL 0x00787b90
00789960 : CVTSI2SS XMM1,dword ptr [EBX + 0x28]
00789965 : MOV dword ptr [EBX + 0x34],0x1
0078996c : MOV EAX,dword ptr [ESI + 0x4]
0078996f : MOV dword ptr [EBX + 0x38],EAX
00789972 : MOV ECX,dword ptr [ESI + 0x8]
00789975 : CVTSI2SS XMM0,EAX
00789979 : DIVSS XMM0,XMM1
0078997d : CVTSI2SS XMM1,dword ptr [EBX + 0x2c]
00789982 : MOVSS dword ptr [EBX + 0x40],XMM0
00789987 : CVTSI2SS XMM0,ECX
0078998b : DIVSS XMM0,XMM1
0078998f : ADD ESP,0x18
00789992 : MOV dword ptr [EBX + 0x3c],ECX
00789995 : MOVSS dword ptr [EBX + 0x44],XMM0
0078999a : MOV EAX,0x1
0078999f : CMP dword ptr [ESI + 0x18],EAX
007899a2 : JBE 0x007899a8
007899a4 : MOV dword ptr [ESP + 0x14],EAX
007899a8 : MOV ECX,0x1
007899ad : CMP dword ptr [ESI + 0x18],ECX
007899b0 : JA 0x007899be
007899b2 : CMP dword ptr [ESP + 0x20],ECX
007899b6 : JZ 0x007899be
007899b8 : MOV dword ptr [ESP + 0x14],ECX
007899bc : JMP 0x007899cf
007899be : MOV EAX,dword ptr [ESP + 0x14]
007899c2 : DEC EAX
007899c3 : MOV dword ptr [ESP + 0x14],ECX
007899c7 : CMP EAX,ECX
007899c9 : JC 0x007899cf
007899cb : MOV dword ptr [ESP + 0x14],EAX
007899cf : LEA EDX,[EBX + 0x48]
007899d2 : MOV dword ptr [ESP + 0x28],EDX
007899d6 : JMP 0x007899e0
007899e0 : MOV EAX,dword ptr [EBX + 0x24]
007899e3 : CMP byte ptr [EAX + 0x289],0x0
007899ea : JZ 0x007899fa
007899ec : CMP byte ptr [EAX + 0x28a],0x0
007899f3 : MOV ECX,0x1
007899f8 : JZ 0x007899ff
007899fa : MOV ECX,0x2
007899ff : MOV EDI,dword ptr [ESP + 0x28]
00789a03 : MOV EAX,dword ptr [EAX + 0xf0]
00789a09 : MOV EDX,dword ptr [EAX]
00789a0b : MOV EDX,dword ptr [EDX + 0x5c]
00789a0e : PUSH 0x0
00789a10 : PUSH EDI
00789a11 : MOV EDI,dword ptr [ESP + 0x1c]
00789a15 : PUSH ECX
00789a16 : MOV ECX,dword ptr [EBX + 0x1c]
00789a19 : PUSH ECX
00789a1a : MOV ECX,dword ptr [ESP + 0x2c]
00789a1e : PUSH 0x0
00789a20 : PUSH EDI
00789a21 : PUSH ECX
00789a22 : MOV ECX,dword ptr [ESP + 0x34]
00789a26 : PUSH ECX
00789a27 : PUSH EAX
00789a28 : CALL EDX
00789a2a : TEST EAX,EAX
00789a2c : JZ 0x00789a6c
00789a2e : MOV EAX,dword ptr [EBX + 0x1c]
00789a31 : CMP EAX,0x1c
00789a34 : JNZ 0x00789a4d
00789a36 : MOV ECX,dword ptr [EBX + 0x24]
00789a39 : MOV EAX,0x33
00789a3e : MOV dword ptr [ECX + 0x108],EAX
00789a44 : MOV dword ptr [EBX + 0x1c],EAX
00789a47 : MOV dword ptr [ESP + 0x24],EAX
00789a4b : JMP 0x007899e0
00789a4d : CMP EAX,0x33
00789a50 : JNZ 0x00789ac0
00789a52 : MOV EDX,dword ptr [EBX + 0x24]
00789a55 : MOV EAX,0x1a
00789a5a : MOV dword ptr [EDX + 0x108],EAX
00789a60 : MOV dword ptr [EBX + 0x1c],EAX
00789a63 : MOV dword ptr [ESP + 0x24],EAX
00789a67 : JMP 0x007899e0
00789a6c : MOV EAX,dword ptr [EBX + 0x24]
00789a6f : MOV dword ptr [ESP + 0x2c],0x0
00789a77 : CMP byte ptr [EAX + 0x28a],0x0
00789a7e : JZ 0x00789af2
00789a80 : MOV EAX,dword ptr [EAX + 0xf0]
00789a86 : MOV ECX,dword ptr [EAX]
00789a88 : PUSH 0x0
00789a8a : LEA EDX,[ESP + 0x30]
00789a8e : PUSH EDX
00789a8f : MOV EDX,dword ptr [EBX + 0x1c]
00789a92 : PUSH 0x0
00789a94 : PUSH EDX
00789a95 : MOV EDX,dword ptr [ESP + 0x2c]
00789a99 : PUSH 0x0
00789a9b : PUSH EDI
00789a9c : PUSH EDX
00789a9d : MOV EDX,dword ptr [ESP + 0x34]
00789aa1 : PUSH EDX
00789aa2 : PUSH EAX
00789aa3 : MOV EAX,dword ptr [ECX + 0x5c]
00789aa6 : CALL EAX
00789aa8 : TEST EAX,EAX
00789aaa : JZ 0x00789af2
00789aac : MOV ESI,dword ptr [ESP + 0x28]
00789ab0 : MOV EAX,dword ptr [ESI]
00789ab2 : MOV ECX,dword ptr [EAX]
00789ab4 : MOV EDX,dword ptr [ECX + 0x8]
00789ab7 : PUSH EAX
00789ab8 : CALL EDX
00789aba : MOV dword ptr [ESI],0x0
00789ac0 : MOV dword ptr [ESP + 0x88],0xffffffff
00789acb : MOV ECX,dword ptr [ESP + 0x10]
00789acf : TEST ECX,ECX
00789ad1 : JZ 0x00789ad8
00789ad3 : CALL 0x004ff7c0
00789ad8 : XOR AL,AL
00789ada : MOV ECX,dword ptr [ESP + 0x80]
00789ae1 : MOV dword ptr FS:[0x0],ECX
00789ae8 : POP ECX
00789ae9 : POP EDI
00789aea : POP ESI
00789aeb : POP EBX
00789aec : MOV ESP,EBP
00789aee : POP EBP
00789aef : RET 0x8
00789af2 : MOV ECX,ESI
00789af4 : CALL 0x00475fc0
00789af9 : TEST AL,AL
00789afb : JNZ 0x00789cff
00789b01 : CMP dword ptr [ESI + 0x18],0x1
00789b05 : JA 0x00789cff
00789b0b : CMP dword ptr [ESP + 0x20],0x1
00789b10 : JNZ 0x00789b4c
00789b12 : CMP EDI,0x1
00789b15 : JBE 0x00789b4c
00789b17 : XOR EAX,EAX
00789b19 : CMP dword ptr [ESP + 0x10],EAX
00789b1d : JNZ 0x00789b4e
00789b1f : MOV ECX,dword ptr [ESI + 0x4]
00789b22 : MOV EDX,dword ptr [ESI]
00789b24 : PUSH EAX
00789b25 : MOV EAX,dword ptr [ESI + 0x8]
00789b28 : PUSH EAX
00789b29 : PUSH ECX
00789b2a : PUSH EDX
00789b2b : CALL 0x00519a90
00789b30 : MOV ECX,dword ptr [ESI + 0xc]
00789b33 : IMUL ECX,dword ptr [ESI + 0x8]
00789b37 : MOV EDX,dword ptr [ESI + 0x10]
00789b3a : PUSH ECX
00789b3b : MOV dword ptr [ESP + 0x14],EAX
00789b3f : MOV EAX,dword ptr [EAX + 0x18]
00789b42 : PUSH EDX
00789b43 : PUSH EAX
00789b44 : CALL 0x0063ae40
00789b49 : ADD ESP,0xc
00789b4c : XOR EAX,EAX
00789b4e : MOV ECX,dword ptr [ESP + 0x10]
00789b52 : MOV dword ptr [ESP + 0x30],EAX
00789b56 : CMP ECX,EAX
00789b58 : JZ 0x00789b63
00789b5a : ADD ECX,0x8
00789b5d : MOV dword ptr [ESP + 0x24],ECX
00789b61 : JMP 0x00789b67
00789b63 : MOV dword ptr [ESP + 0x24],ESI
00789b67 : MOV ECX,dword ptr [ESP + 0x18]
00789b6b : MOV EDX,dword ptr [ESP + 0x1c]
00789b6f : MOV dword ptr [ESP + 0x48],ECX
00789b73 : XOR ECX,ECX
00789b75 : CMP dword ptr [ESP + 0x20],0x1
00789b7a : MOV dword ptr [ESP + 0x40],EAX
00789b7e : SETNZ CL
00789b81 : MOV dword ptr [ESP + 0x44],EAX
00789b85 : MOV dword ptr [ESP + 0x4c],EDX
00789b89 : MOV dword ptr [ESP + 0x1c],EAX
00789b8d : LEA ECX,[ECX*0x4 + 0x1c]
00789b94 : MOV dword ptr [ESP + 0x18],ECX
00789b98 : CMP EDI,EAX
00789b9a : JBE 0x00789e1a
00789ba0 : MOV EDI,dword ptr [ESP + 0x28]
00789ba4 : MOV EAX,dword ptr [EDI]
00789ba6 : MOV EDX,dword ptr [EAX]
00789ba8 : MOV EDX,dword ptr [EDX + 0x48]
00789bab : LEA ECX,[ESP + 0x30]
00789baf : PUSH ECX
00789bb0 : MOV ECX,dword ptr [ESP + 0x20]
00789bb4 : PUSH ECX
00789bb5 : PUSH EAX
00789bb6 : CALL EDX
00789bb8 : TEST EAX,EAX
00789bba : JNZ 0x00789cc0
00789bc0 : CMP dword ptr [ESP + 0x20],0x1
00789bc5 : JNZ 0x00789bcd
00789bc7 : MOV EAX,dword ptr [ESP + 0x48]
00789bcb : JMP 0x00789bd4
00789bcd : MOV EAX,dword ptr [ESP + 0x24]
00789bd1 : MOV EAX,dword ptr [EAX + 0xc]
00789bd4 : MOV EDX,dword ptr [ESP + 0x18]
00789bd8 : PUSH 0x0
00789bda : PUSH -0x1
00789bdc : LEA ECX,[ESP + 0x48]
00789be0 : PUSH ECX
00789be1 : PUSH 0x0
00789be3 : PUSH EAX
00789be4 : MOV EAX,dword ptr [ESP + 0x38]
00789be8 : MOV ECX,dword ptr [EAX + 0x10]
00789beb : PUSH EDX
00789bec : MOV EDX,dword ptr [ESP + 0x48]
00789bf0 : PUSH ECX
00789bf1 : PUSH 0x0
00789bf3 : PUSH 0x0
00789bf5 : PUSH EDX
00789bf6 : CALL 0x00664cc0
00789bfb : MOV EDI,EAX
00789bfd : MOV EAX,dword ptr [ESP + 0x30]
00789c01 : MOV ECX,dword ptr [EAX]
00789c03 : MOV EDX,dword ptr [ECX + 0x8]
00789c06 : PUSH EAX
00789c07 : CALL EDX
00789c09 : MOV dword ptr [ESP + 0x30],0x0
00789c11 : TEST EDI,EDI
00789c13 : JNZ 0x00789ce9
00789c19 : MOV EAX,dword ptr [ESP + 0x14]
00789c1d : DEC EAX
00789c1e : CMP dword ptr [ESP + 0x1c],EAX
00789c22 : JNC 0x00789ca8
00789c28 : CMP dword ptr [ESP + 0x24],ESI
00789c2c : JNZ 0x00789c8e
00789c2e : PUSH 0x30
00789c30 : CALL 0x00475fa0
00789c35 : ADD ESP,0x4
00789c38 : MOV dword ptr [ESP + 0x24],EAX
00789c3c : MOV byte ptr [ESP + 0x88],0x2
00789c44 : TEST EAX,EAX
00789c46 : JZ 0x00789c54
00789c48 : PUSH ESI
00789c49 : MOV ECX,EAX
00789c4b : CALL 0x00454ba0
00789c50 : MOV EDI,EAX
00789c52 : JMP 0x00789c56
00789c54 : XOR EDI,EDI
00789c56 : MOV byte ptr [ESP + 0x88],0x0
00789c5e : TEST EDI,EDI
00789c60 : JZ 0x00789c65
00789c62 : INC dword ptr [EDI + 0x4]
00789c65 : CMP dword ptr [ESP + 0x10],0x0
00789c6a : JZ 0x00789c75
00789c6c : MOV ECX,dword ptr [ESP + 0x10]
00789c70 : CALL 0x004ff7c0
00789c75 : MOV dword ptr [ESP + 0x10],EDI
00789c79 : TEST EDI,EDI
00789c7b : JZ 0x00789c86
00789c7d : ADD EDI,0x8
00789c80 : MOV dword ptr [ESP + 0x24],EDI
00789c84 : JMP 0x00789c8e
00789c86 : MOV dword ptr [ESP + 0x24],0x0
00789c8e : MOV ECX,dword ptr [ESP + 0x24]
00789c92 : MOV EDX,dword ptr [ECX + 0x10]
00789c95 : PUSH EDX
00789c96 : LEA EAX,[ESP + 0x50]
00789c9a : PUSH EAX
00789c9b : LEA ECX,[ESP + 0x50]
00789c9f : PUSH ECX
00789ca0 : CALL 0x00480140
00789ca5 : ADD ESP,0xc
00789ca8 : MOV EAX,dword ptr [ESP + 0x1c]
00789cac : INC EAX
00789cad : MOV dword ptr [ESP + 0x1c],EAX
00789cb1 : CMP EAX,dword ptr [ESP + 0x14]
00789cb5 : JC 0x00789ba0
00789cbb : JMP 0x00789e1a
00789cc0 : MOV EAX,dword ptr [EDI]
00789cc2 : MOV EDX,dword ptr [EAX]
00789cc4 : PUSH EAX
00789cc5 : MOV EAX,dword ptr [EDX + 0x8]
00789cc8 : CALL EAX
00789cca : MOV dword ptr [EDI],0x0
00789cd0 : MOV EAX,dword ptr [ESP + 0x2c]
00789cd4 : TEST EAX,EAX
00789cd6 : JZ 0x00789ac0
00789cdc : MOV ECX,dword ptr [EAX]
00789cde : MOV EDX,dword ptr [ECX + 0x8]
00789ce1 : PUSH EAX
00789ce2 : CALL EDX
00789ce4 : JMP 0x00789ac0
00789ce9 : MOV ESI,dword ptr [ESP + 0x28]
00789ced : MOV EAX,dword ptr [ESI]
00789cef : MOV ECX,dword ptr [EAX]
00789cf1 : MOV EDX,dword ptr [ECX + 0x8]
00789cf4 : PUSH EAX
00789cf5 : CALL EDX
00789cf7 : MOV dword ptr [ESI],0x0
00789cfd : JMP 0x00789cd0
00789cff : MOV EAX,dword ptr [ESP + 0x10]
00789d03 : XOR ECX,ECX
00789d05 : MOV dword ptr [ESP + 0x34],ECX
00789d09 : CMP EAX,ECX
00789d0b : JZ 0x00789d16
00789d0d : ADD EAX,0x8
00789d10 : MOV dword ptr [ESP + 0x30],EAX
00789d14 : JMP 0x00789d1a
00789d16 : MOV dword ptr [ESP + 0x30],ESI
00789d1a : MOV EAX,dword ptr [ESP + 0x18]
00789d1e : MOV dword ptr [ESP + 0x58],EAX
00789d22 : MOV EAX,dword ptr [ESP + 0x24]
00789d26 : MOV dword ptr [ESP + 0x50],ECX
00789d2a : MOV dword ptr [ESP + 0x54],ECX
00789d2e : MOV ECX,dword ptr [ESP + 0x1c]
00789d32 : MOV dword ptr [ESP + 0x5c],ECX
00789d36 : MOV dword ptr [ESP + 0x24],0x20
00789d3e : CMP EAX,0x15
00789d41 : JZ 0x00789d47
00789d43 : MOV dword ptr [ESP + 0x24],EAX
00789d47 : XOR EDI,EDI
00789d49 : MOV dword ptr [ESP + 0x20],EDI
00789d4d : CMP dword ptr [ESP + 0x14],EDI
00789d51 : JBE 0x00789e1a
00789d57 : MOV EDX,dword ptr [ESP + 0x28]
00789d5b : MOV EAX,dword ptr [EDX]
00789d5d : MOV ECX,dword ptr [EAX]
00789d5f : LEA EDX,[ESP + 0x34]
00789d63 : PUSH EDX
00789d64 : PUSH EDI
00789d65 : PUSH EAX
00789d66 : MOV EAX,dword ptr [ECX + 0x48]
00789d69 : CALL EAX
00789d6b : TEST EAX,EAX
00789d6d : JNZ 0x00789ce9
00789d73 : PUSH EAX
00789d74 : LEA ECX,[ESP + 0x40]
00789d78 : PUSH ECX
00789d79 : MOV ECX,dword ptr [ESP + 0x38]
00789d7d : LEA EDX,[ESP + 0x40]
00789d81 : PUSH EDX
00789d82 : PUSH EDI
00789d83 : CALL 0x00519580
00789d88 : MOV EDI,dword ptr [ESP + 0x38]
00789d8c : MOV dword ptr [ESP + 0x1c],EAX
00789d90 : MOV EAX,dword ptr [ESP + 0x3c]
00789d94 : MOV ECX,ESI
00789d96 : MOV dword ptr [ESP + 0x58],EDI
00789d9a : MOV dword ptr [ESP + 0x5c],EAX
00789d9e : CALL 0x00475fc0
00789da3 : TEST AL,AL
00789da5 : JZ 0x00789db8
00789da7 : MOV ECX,dword ptr [ESP + 0x30]
00789dab : MOV EDX,dword ptr [ECX]
00789dad : PUSH 0x1
00789daf : PUSH EDI
00789db0 : PUSH EDX
00789db1 : CALL 0x005194f0
00789db6 : JMP 0x00789dc5
00789db8 : MOV EAX,dword ptr [ESP + 0x30]
00789dbc : MOV ECX,dword ptr [EAX]
00789dbe : PUSH EDI
00789dbf : PUSH ECX
00789dc0 : CALL 0x00518fc0
00789dc5 : MOV ECX,dword ptr [ESP + 0x1c]
00789dc9 : PUSH 0x0
00789dcb : PUSH -0x1
00789dcd : LEA EDX,[ESP + 0x58]
00789dd1 : PUSH EDX
00789dd2 : MOV EDX,dword ptr [ESP + 0x40]
00789dd6 : PUSH 0x0
00789dd8 : PUSH EAX
00789dd9 : MOV EAX,dword ptr [ESP + 0x38]
00789ddd : PUSH EAX
00789dde : PUSH ECX
00789ddf : PUSH 0x0
00789de1 : PUSH 0x0
00789de3 : PUSH EDX
00789de4 : CALL 0x00664cc0
00789de9 : MOV EDI,EAX
00789deb : MOV EAX,dword ptr [ESP + 0x34]
00789def : MOV ECX,dword ptr [EAX]
00789df1 : MOV EDX,dword ptr [ECX + 0x8]
00789df4 : PUSH EAX
00789df5 : CALL EDX
00789df7 : MOV dword ptr [ESP + 0x34],0x0
00789dff : TEST EDI,EDI
00789e01 : JNZ 0x00789ce9
00789e07 : MOV EDI,dword ptr [ESP + 0x20]
00789e0b : INC EDI
00789e0c : MOV dword ptr [ESP + 0x20],EDI
00789e10 : CMP EDI,dword ptr [ESP + 0x14]
00789e14 : JC 0x00789d57
00789e1a : CMP dword ptr [ESP + 0x2c],0x0
00789e1f : JZ 0x00789ea0
00789e21 : MOV EDX,dword ptr [ESP + 0x2c]
00789e25 : MOV EAX,dword ptr [EBX + 0x24]
00789e28 : MOV EAX,dword ptr [EAX + 0xf0]
00789e2e : MOV ESI,dword ptr [ESP + 0x28]
00789e32 : MOV ECX,dword ptr [EAX]
00789e34 : PUSH EDX
00789e35 : MOV EDX,dword ptr [ESI]
00789e37 : PUSH EDX
00789e38 : PUSH EAX
00789e39 : MOV EAX,dword ptr [ECX + 0x7c]
00789e3c : CALL EAX
00789e3e : TEST EAX,EAX
00789e40 : JGE 0x00789e90
00789e42 : PUSH 0xc12a14
00789e47 : LEA ECX,[ESP + 0x64]
00789e4b : CALL 0x00406460
00789e50 : MOV byte ptr [ESP + 0x88],0x3
00789e58 : MOV ECX,dword ptr [0x00da98e8]
00789e5e : MOV ECX,dword ptr [ECX]
00789e60 : TEST ECX,ECX
00789e62 : JZ 0x00789e7a
00789e64 : MOV EDX,dword ptr [ECX]
00789e66 : MOV EDX,dword ptr [EDX + 0x14]
00789e69 : LEA EAX,[ESP + 0x60]
00789e6d : PUSH EAX
00789e6e : PUSH 0x128b
00789e73 : PUSH 0xc12c34
00789e78 : CALL EDX
00789e7a : MOV byte ptr [ESP + 0x88],0x0
00789e82 : LEA ECX,[ESP + 0x60]
00789e86 : CALL 0x00406560
00789e8b : JMP 0x00789ac0
00789e90 : MOV EAX,dword ptr [ESI]
00789e92 : MOV ECX,dword ptr [EAX]
00789e94 : MOV EDX,dword ptr [ECX + 0x8]
00789e97 : PUSH EAX
00789e98 : CALL EDX
00789e9a : MOV EAX,dword ptr [ESP + 0x2c]
00789e9e : MOV dword ptr [ESI],EAX
00789ea0 : PUSH 0x0
00789ea2 : MOV EDI,EBX
00789ea4 : CALL 0x00740690
00789ea9 : MOV dword ptr [ESP + 0x88],0xffffffff
00789eb4 : MOV ECX,dword ptr [ESP + 0x10]
00789eb8 : TEST ECX,ECX
00789eba : JZ 0x00789ee4
00789ebc : CALL 0x004ff7c0
00789ec1 : MOV AL,0x1
00789ec3 : MOV ECX,dword ptr [ESP + 0x80]
00789eca : MOV dword ptr FS:[0x0],ECX
00789ed1 : POP ECX
00789ed2 : POP EDI
00789ed3 : POP ESI
00789ed4 : POP EBX
00789ed5 : MOV ESP,EBP
00789ed7 : POP EBP
00789ed8 : RET 0x8
00789edb : PUSH 0x0
00789edd : MOV EDI,EBX
00789edf : CALL 0x00740690
00789ee4 : MOV AL,0x1
00789ee6 : MOV ECX,dword ptr [ESP + 0x80]
00789eed : MOV dword ptr FS:[0x0],ECX
00789ef4 : POP ECX
00789ef5 : POP EDI
00789ef6 : POP ESI
00789ef7 : POP EBX
00789ef8 : MOV ESP,EBP
00789efa : POP EBP
00789efb : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_006a90a0
ENTRY    : 006a90a0
BODY     : [[006a90a0, 006a931f]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006a90a0(byte *param_1,int param_2,int *param_3)

{
  byte bVar1;
  bool bVar2;
  bool bVar3;
  byte *in_EAX;
  uint uVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int local_14;
  int local_10;
  int local_c;
  
  local_14 = 0;
  bVar3 = false;
  bVar2 = false;
  if (param_3 != (int *)0x0) {
    *param_3 = 0;
  }
  iVar7 = 0;
  local_10 = 0;
  local_c = 0;
  iVar6 = 0;
  iVar5 = 4;
  while( true ) {
    while( true ) {
      if ((iVar5 != 0) && (in_EAX = in_EAX + 1, param_1 <= in_EAX)) {
        return 0;
      }
      bVar1 = *in_EAX >> ((byte)iVar5 & 0x1f);
      iVar5 = 4 - iVar5;
      uVar4 = bVar1 & 0xf;
      if (uVar4 != 0xe) break;
      bVar3 = true;
    }
    if (9 < uVar4) break;
    if (local_14 < 0xccccccc) {
      if (((bVar1 & 0xf) != 0) || (local_14 != 0)) {
        local_c = local_c + 1;
        local_14 = uVar4 + local_14 * 10;
      }
    }
    else {
      local_10 = local_10 + 1;
    }
  }
  if (uVar4 == 10) {
    while( true ) {
      if ((iVar5 != 0) && (in_EAX = in_EAX + 1, param_1 <= in_EAX)) {
        return 0;
      }
      bVar1 = *in_EAX >> ((byte)iVar5 & 0x1f);
      iVar5 = 4 - iVar5;
      uVar4 = bVar1 & 0xf;
      if (9 < uVar4) break;
      if (((bVar1 & 0xf) == 0) && (local_14 == 0)) {
        local_10 = local_10 + -1;
      }
      else if (local_14 < 0xccccccc) {
        iVar6 = iVar6 + 1;
        local_14 = uVar4 + local_14 * 10;
      }
    }
  }
  if (uVar4 == 0xc) {
    bVar2 = true;
LAB_006a9190:
    while( true ) {
      if ((iVar5 != 0) && (in_EAX = in_EAX + 1, param_1 <= in_EAX)) {
        return 0;
      }
      bVar1 = (byte)iVar5;
      iVar5 = 4 - iVar5;
      uVar4 = *in_EAX >> (bVar1 & 0x1f) & 0xf;
      if (9 < uVar4) break;
      iVar7 = uVar4 + iVar7 * 10;
      if (1000 < iVar7) {
        return 0;
      }
    }
    if (bVar2) {
      iVar7 = -iVar7;
    }
  }
  else if (uVar4 == 0xb) goto LAB_006a9190;
  iVar7 = iVar7 + local_10 + param_2;
  if (param_3 == (int *)0x0) {
    local_c = local_c + iVar7;
    iVar6 = iVar6 - iVar7;
    if (local_c < 0) {
      local_c = -local_c;
    }
    if (5 < local_c) {
      return 0;
    }
    if (iVar6 < 1) {
      if (0x7fff < *(int *)(&DAT_00bea280 + iVar6 * -4) * local_14) {
        return 0;
      }
      local_14 = *(int *)(&DAT_00bea280 + iVar6 * -4) * local_14 * 0x10000;
    }
    else {
      if (0x7fff < local_14 / *(int *)(&DAT_00bea280 + iVar6 * 4)) {
        return 0;
      }
      local_14 = FUN_00685f30(local_14,*(int *)(&DAT_00bea280 + iVar6 * 4));
    }
  }
  else {
    iVar6 = iVar6 + local_c;
    iVar7 = iVar7 + local_c;
    if (iVar6 < 6) {
      if (local_14 < 0x8000) {
        if (iVar7 < 1) {
          iVar7 = iVar7 - iVar6;
        }
        else {
          iVar5 = iVar7;
          if (4 < iVar7) {
            iVar5 = 5;
          }
          iVar7 = iVar7 - iVar5;
          local_14 = local_14 * *(int *)(&DAT_00bea280 + (iVar5 - iVar6) * 4);
          if (0x7fff < local_14) {
            local_14 = (local_14 / 10) * 0x10000;
            *param_3 = iVar7 + 1;
            goto LAB_006a9303;
          }
        }
        local_14 = local_14 << 0x10;
        *param_3 = iVar7;
      }
      else {
        local_14 = FUN_00685f30(local_14,10);
        *param_3 = (iVar7 - iVar6) + 1;
      }
    }
    else if (local_14 / (int)(&PTR_LAB_00bea26c)[iVar6] < 0x8000) {
      local_14 = FUN_00685f30(local_14,(&PTR_LAB_00bea26c)[iVar6]);
      *param_3 = iVar7 + -5;
    }
    else {
      local_14 = FUN_00685f30(local_14,*(undefined4 *)(&DAT_00bea270 + iVar6 * 4));
      *param_3 = iVar7 + -4;
    }
  }
LAB_006a9303:
  if (bVar3) {
    local_14 = -local_14;
  }
  return local_14;
}



============================================================
DISASSEMBLY
============================================================
006a90a0 : SUB ESP,0x14
006a90a3 : PUSH EBX
006a90a4 : PUSH EBP
006a90a5 : PUSH ESI
006a90a6 : XOR ESI,ESI
006a90a8 : MOV EBX,EAX
006a90aa : MOV EAX,dword ptr [ESP + 0x2c]
006a90ae : PUSH EDI
006a90af : MOV dword ptr [ESP + 0x20],ESI
006a90b3 : MOV dword ptr [ESP + 0x1c],ESI
006a90b7 : CMP EAX,ESI
006a90b9 : JZ 0x006a90bd
006a90bb : MOV dword ptr [EAX],ESI
006a90bd : XOR EDI,EDI
006a90bf : MOV dword ptr [ESP + 0x10],ESI
006a90c3 : MOV dword ptr [ESP + 0x14],ESI
006a90c7 : MOV dword ptr [ESP + 0x18],ESI
006a90cb : XOR EBP,EBP
006a90cd : MOV EDX,0x4
006a90d2 : TEST EDX,EDX
006a90d4 : JZ 0x006a90e1
006a90d6 : INC EBX
006a90d7 : CMP EBX,dword ptr [ESP + 0x28]
006a90db : JNC 0x006a9314
006a90e1 : MOVZX EAX,byte ptr [EBX]
006a90e4 : MOV CL,DL
006a90e6 : SHR EAX,CL
006a90e8 : MOV ECX,0x4
006a90ed : SUB ECX,EDX
006a90ef : MOV EDX,ECX
006a90f1 : AND EAX,0xf
006a90f4 : CMP EAX,0xe
006a90f7 : JNZ 0x006a9103
006a90f9 : MOV dword ptr [ESP + 0x20],0x1
006a9101 : JMP 0x006a90d2
006a9103 : CMP EAX,0x9
006a9106 : JA 0x006a912a
006a9108 : CMP ESI,0xccccccc
006a910e : JL 0x006a9116
006a9110 : INC dword ptr [ESP + 0x14]
006a9114 : JMP 0x006a90d2
006a9116 : TEST EAX,EAX
006a9118 : JNZ 0x006a911e
006a911a : TEST ESI,ESI
006a911c : JZ 0x006a90d2
006a911e : INC dword ptr [ESP + 0x18]
006a9122 : LEA ECX,[ESI + ESI*0x4]
006a9125 : LEA ESI,[EAX + ECX*0x2]
006a9128 : JMP 0x006a90d2
006a912a : CMP EAX,0xa
006a912d : JNZ 0x006a9176
006a912f : NOP
006a9130 : TEST EDX,EDX
006a9132 : JZ 0x006a913f
006a9134 : INC EBX
006a9135 : CMP EBX,dword ptr [ESP + 0x28]
006a9139 : JNC 0x006a9314
006a913f : MOVZX EAX,byte ptr [EBX]
006a9142 : MOV CL,DL
006a9144 : SHR EAX,CL
006a9146 : MOV ECX,0x4
006a914b : SUB ECX,EDX
006a914d : MOV EDX,ECX
006a914f : AND EAX,0xf
006a9152 : CMP EAX,0xa
006a9155 : JNC 0x006a9176
006a9157 : TEST EAX,EAX
006a9159 : JNZ 0x006a9165
006a915b : TEST ESI,ESI
006a915d : JNZ 0x006a9165
006a915f : DEC dword ptr [ESP + 0x14]
006a9163 : JMP 0x006a9130
006a9165 : CMP ESI,0xccccccc
006a916b : JGE 0x006a9130
006a916d : LEA ECX,[ESI + ESI*0x4]
006a9170 : INC EBP
006a9171 : LEA ESI,[EAX + ECX*0x2]
006a9174 : JMP 0x006a9130
006a9176 : CMP EAX,0xc
006a9179 : JNZ 0x006a9185
006a917b : MOV dword ptr [ESP + 0x1c],0x1
006a9183 : JMP 0x006a9190
006a9185 : CMP EAX,0xb
006a9188 : JNZ 0x006a91da
006a918a : LEA EBX,[EBX]
006a9190 : TEST EDX,EDX
006a9192 : JZ 0x006a919f
006a9194 : INC EBX
006a9195 : CMP EBX,dword ptr [ESP + 0x28]
006a9199 : JNC 0x006a9314
006a919f : MOVZX EAX,byte ptr [EBX]
006a91a2 : MOV CL,DL
006a91a4 : SHR EAX,CL
006a91a6 : MOV ECX,0x4
006a91ab : SUB ECX,EDX
006a91ad : MOV EDX,ECX
006a91af : AND EAX,0xf
006a91b2 : CMP EAX,0xa
006a91b5 : JNC 0x006a91d1
006a91b7 : LEA ECX,[EDI + EDI*0x4]
006a91ba : LEA EDI,[EAX + ECX*0x2]
006a91bd : CMP EDI,0x3e8
006a91c3 : JLE 0x006a9190
006a91c5 : MOV EAX,dword ptr [ESP + 0x10]
006a91c9 : POP EDI
006a91ca : POP ESI
006a91cb : POP EBP
006a91cc : POP EBX
006a91cd : ADD ESP,0x14
006a91d0 : RET
006a91d1 : CMP dword ptr [ESP + 0x1c],0x0
006a91d6 : JZ 0x006a91da
006a91d8 : NEG EDI
006a91da : MOV EDX,dword ptr [ESP + 0x2c]
006a91de : MOV EAX,dword ptr [ESP + 0x14]
006a91e2 : MOV EBX,dword ptr [ESP + 0x30]
006a91e6 : ADD EAX,EDX
006a91e8 : ADD EDI,EAX
006a91ea : MOV EAX,dword ptr [ESP + 0x18]
006a91ee : TEST EBX,EBX
006a91f0 : JZ 0x006a92b0
006a91f6 : ADD EBP,EAX
006a91f8 : ADD EDI,EAX
006a91fa : CMP EBP,0x5
006a91fd : JG 0x006a9274
006a91ff : CMP ESI,0x7fff
006a9205 : JLE 0x006a921c
006a9207 : PUSH 0xa
006a9209 : PUSH ESI
006a920a : CALL 0x00685f30
006a920f : SUB EDI,EBP
006a9211 : ADD ESP,0x8
006a9214 : INC EDI
006a9215 : MOV dword ptr [EBX],EDI
006a9217 : JMP 0x006a92ff
006a921c : TEST EDI,EDI
006a921e : JLE 0x006a9264
006a9220 : CMP EDI,0x5
006a9223 : MOV EAX,EDI
006a9225 : JL 0x006a922c
006a9227 : MOV EAX,0x5
006a922c : SUB EDI,EAX
006a922e : SUB EAX,EBP
006a9230 : MOV ECX,dword ptr [EAX*0x4 + 0xbea280]
006a9237 : IMUL ESI,ECX
006a923a : CMP ESI,0x7fff
006a9240 : JLE 0x006a9266
006a9242 : MOV EAX,0x66666667
006a9247 : IMUL ESI
006a9249 : SAR EDX,0x2
006a924c : MOV EAX,EDX
006a924e : SHR EAX,0x1f
006a9251 : ADD EAX,EDX
006a9253 : MOV ESI,EAX
006a9255 : INC EDI
006a9256 : SHL ESI,0x10
006a9259 : MOV dword ptr [ESP + 0x10],ESI
006a925d : MOV dword ptr [EBX],EDI
006a925f : JMP 0x006a9303
006a9264 : SUB EDI,EBP
006a9266 : SHL ESI,0x10
006a9269 : MOV dword ptr [ESP + 0x10],ESI
006a926d : MOV dword ptr [EBX],EDI
006a926f : JMP 0x006a9303
006a9274 : MOV ECX,dword ptr [EBP*0x4 + 0xbea26c]
006a927b : MOV EAX,ESI
006a927d : CDQ
006a927e : IDIV ECX
006a9280 : CMP EAX,0x7fff
006a9285 : JLE 0x006a929f
006a9287 : MOV ECX,dword ptr [EBP*0x4 + 0xbea270]
006a928e : PUSH ECX
006a928f : PUSH ESI
006a9290 : CALL 0x00685f30
006a9295 : ADD ESP,0x8
006a9298 : ADD EDI,-0x4
006a929b : MOV dword ptr [EBX],EDI
006a929d : JMP 0x006a92ff
006a929f : PUSH ECX
006a92a0 : PUSH ESI
006a92a1 : CALL 0x00685f30
006a92a6 : ADD ESP,0x8
006a92a9 : ADD EDI,-0x5
006a92ac : MOV dword ptr [EBX],EDI
006a92ae : JMP 0x006a92ff
006a92b0 : ADD EAX,EDI
006a92b2 : SUB EBP,EDI
006a92b4 : TEST EAX,EAX
006a92b6 : JGE 0x006a92ba
006a92b8 : NEG EAX
006a92ba : CMP EAX,0x5
006a92bd : JG 0x006a9314
006a92bf : TEST EBP,EBP
006a92c1 : JLE 0x006a92e2
006a92c3 : MOV ECX,dword ptr [EBP*0x4 + 0xbea280]
006a92ca : MOV EAX,ESI
006a92cc : CDQ
006a92cd : IDIV ECX
006a92cf : CMP EAX,0x7fff
006a92d4 : JG 0x006a9314
006a92d6 : PUSH ECX
006a92d7 : PUSH ESI
006a92d8 : CALL 0x00685f30
006a92dd : ADD ESP,0x8
006a92e0 : JMP 0x006a92ff
006a92e2 : LEA EDX,[EBP*0x4 + 0x0]
006a92e9 : MOV EAX,0xbea280
006a92ee : SUB EAX,EDX
006a92f0 : MOV EAX,dword ptr [EAX]
006a92f2 : IMUL EAX,ESI
006a92f5 : CMP EAX,0x7fff
006a92fa : JG 0x006a9314
006a92fc : SHL EAX,0x10
006a92ff : MOV dword ptr [ESP + 0x10],EAX
006a9303 : CMP dword ptr [ESP + 0x20],0x0
006a9308 : JZ 0x006a9314
006a930a : MOV ECX,dword ptr [ESP + 0x10]
006a930e : NEG ECX
006a9310 : MOV dword ptr [ESP + 0x10],ECX
006a9314 : MOV EAX,dword ptr [ESP + 0x10]
006a9318 : POP EDI
006a9319 : POP ESI
006a931a : POP EBP
006a931b : POP EBX
006a931c : ADD ESP,0x14
006a931f : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00457f40
ENTRY    : 00457f40
BODY     : [[00457f40, 0045801b]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

uint * FUN_00457f40(uint param_1)

{
  uint *puVar1;
  uint *puVar2;
  uint uVar3;
  size_t _Size;
  void *local_c;
  undefined1 *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00b714c5;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  _Size = param_1 * 0x40c + 4;
  if (DAT_00da98c8 == (int *)0x0) {
    puVar1 = _malloc(_Size);
  }
  else {
    puVar1 = (uint *)(**(code **)(*DAT_00da98c8 + 4))(_Size,DAT_00d66fa0 ^ (uint)&stack0xffffffdc);
  }
  if (puVar1 == (uint *)0x0) {
    ExceptionList = local_c;
    return (uint *)0x0;
  }
  uVar3 = 0;
  *puVar1 = param_1;
  if (param_1 != 0) {
    do {
      puVar2 = puVar1 + 1 + uVar3 * 0x103;
      if (puVar2 != (uint *)0x0) {
        *(undefined1 *)puVar2 = 0;
        puVar2[1] = (uint)&PTR_LAB_00cd4200;
        puVar2[2] = 0;
        *(undefined1 *)(puVar2 + 3) = 0;
      }
      uVar3 = uVar3 + 1;
    } while (uVar3 < param_1);
  }
  _DAT_00da98cc = _DAT_00da98cc + _Size;
  _DAT_00da98d0 = _DAT_00da98d0 + 1;
  ExceptionList = local_c;
  return puVar1 + 1;
}



============================================================
DISASSEMBLY
============================================================
00457f40 : PUSH -0x1
00457f42 : PUSH 0xb714c5
00457f47 : MOV EAX,FS:[0x0]
00457f4d : PUSH EAX
00457f4e : SUB ESP,0x8
00457f51 : PUSH EBX
00457f52 : PUSH EBP
00457f53 : PUSH ESI
00457f54 : PUSH EDI
00457f55 : MOV EAX,[0x00d66fa0]
00457f5a : XOR EAX,ESP
00457f5c : PUSH EAX
00457f5d : LEA EAX,[ESP + 0x1c]
00457f61 : MOV FS:[0x0],EAX
00457f67 : MOV EBP,dword ptr [ESP + 0x2c]
00457f6b : MOV ECX,dword ptr [0x00da98c8]
00457f71 : MOV EDI,EBP
00457f73 : IMUL EDI,EDI,0x40c
00457f79 : ADD EDI,0x4
00457f7c : XOR EBX,EBX
00457f7e : PUSH EDI
00457f7f : CMP ECX,EBX
00457f81 : JZ 0x00457f8c
00457f83 : MOV EAX,dword ptr [ECX]
00457f85 : MOV EDX,dword ptr [EAX + 0x4]
00457f88 : CALL EDX
00457f8a : JMP 0x00457f94
00457f8c : CALL 0x00636043
00457f91 : ADD ESP,0x4
00457f94 : CMP EAX,EBX
00457f96 : JZ 0x00458006
00457f98 : XOR EDX,EDX
00457f9a : LEA ESI,[EAX + 0x4]
00457f9d : MOV dword ptr [EAX],EBP
00457f9f : MOV dword ptr [ESP + 0x14],ESI
00457fa3 : MOV dword ptr [ESP + 0x2c],EDX
00457fa7 : CMP EBP,EBX
00457fa9 : JBE 0x00457fe4
00457fab : OR EAX,0xffffffff
00457fae : MOV EDI,EDI
00457fb0 : MOV ECX,EDX
00457fb2 : IMUL ECX,ECX,0x40c
00457fb8 : ADD ECX,ESI
00457fba : MOV dword ptr [ESP + 0x18],ECX
00457fbe : MOV dword ptr [ESP + 0x24],EBX
00457fc2 : JZ 0x00457fd7
00457fc4 : MOV byte ptr [ECX],BL
00457fc6 : MOV dword ptr [ECX + 0x4],0xcd4200
00457fcd : MOV dword ptr [ECX + 0x8],EBX
00457fd0 : MOV byte ptr [ECX + 0xc],BL
00457fd3 : MOV byte ptr [ESP + 0x24],BL
00457fd7 : MOV dword ptr [ESP + 0x24],EAX
00457fdb : INC EDX
00457fdc : MOV dword ptr [ESP + 0x2c],EDX
00457fe0 : CMP EDX,EBP
00457fe2 : JC 0x00457fb0
00457fe4 : ADD dword ptr [0x00da98cc],EDI
00457fea : INC dword ptr [0x00da98d0]
00457ff0 : MOV EAX,ESI
00457ff2 : MOV ECX,dword ptr [ESP + 0x1c]
00457ff6 : MOV dword ptr FS:[0x0],ECX
00457ffd : POP ECX
00457ffe : POP EDI
00457fff : POP ESI
00458000 : POP EBP
00458001 : POP EBX
00458002 : ADD ESP,0x14
00458005 : RET
00458006 : XOR EAX,EAX
00458008 : MOV ECX,dword ptr [ESP + 0x1c]
0045800c : MOV dword ptr FS:[0x0],ECX
00458013 : POP ECX
00458014 : POP EDI
00458015 : POP ESI
00458016 : POP EBP
00458017 : POP EBX
00458018 : ADD ESP,0x14
0045801b : RET

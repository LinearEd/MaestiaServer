PROGRAM  : Maestia.exe
FUNCTION : FUN_004405c0
ENTRY    : 004405c0
BODY     : [[004405c0, 004405fb] [00440600, 00440715]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x0044061c) */

void FUN_004405c0(int param_1,undefined4 *param_2,undefined4 *param_3)

{
  uint uVar1;
  int iVar2;
  ushort *puVar3;
  undefined4 *puVar4;
  int iVar5;
  ushort *puVar6;
  uint uVar7;
  undefined4 *puVar8;
  bool bVar9;
  
  iVar2 = (int)param_3;
  puVar4 = *(undefined4 **)(param_1 + 4);
  bVar9 = true;
  if (*(char *)((int)puVar4[1] + 0x35) == '\0') {
    uVar1 = *(uint *)((int)param_3 + 0x14);
    puVar8 = (undefined4 *)puVar4[1];
    do {
      puVar4 = puVar8;
      if ((uint)puVar4[9] < 8) {
        puVar3 = (ushort *)(puVar4 + 4);
      }
      else {
        puVar3 = (ushort *)puVar4[4];
      }
      uVar7 = puVar4[8];
      if (uVar1 < (uint)puVar4[8]) {
        uVar7 = uVar1;
      }
      if (*(uint *)((int)param_3 + 0x18) < 8) {
        puVar6 = (ushort *)((int)param_3 + 4);
      }
      else {
        puVar6 = *(ushort **)((int)param_3 + 4);
      }
      for (; uVar7 != 0; uVar7 = uVar7 - 1) {
        if (*puVar6 != *puVar3) {
          uVar7 = (-(uint)(*puVar6 < *puVar3) & 0xfffffffe) + 1;
          if (uVar7 != 0) goto LAB_00440677;
          break;
        }
        puVar6 = puVar6 + 1;
        puVar3 = puVar3 + 1;
      }
      if (uVar1 < (uint)puVar4[8]) {
        uVar7 = 0xffffffff;
      }
      else {
        uVar7 = (uint)(uVar1 != puVar4[8]);
      }
LAB_00440677:
      bVar9 = (int)uVar7 < 0;
      if (bVar9) {
        puVar8 = (undefined4 *)*puVar4;
      }
      else {
        puVar8 = (undefined4 *)puVar4[2];
      }
    } while (*(char *)((int)puVar8 + 0x35) == '\0');
  }
  param_3 = puVar4;
  if (bVar9) {
    if (puVar4 == (undefined4 *)**(int **)(param_1 + 4)) {
      bVar9 = true;
      goto LAB_004406b1;
    }
    FUN_00403140();
  }
  puVar4 = param_3;
  if (*(uint *)(iVar2 + 0x18) < 8) {
    iVar5 = iVar2 + 4;
  }
  else {
    iVar5 = *(int *)(iVar2 + 4);
  }
  iVar5 = FUN_00405bb0(iVar5);
  if (-1 < iVar5) {
    *param_2 = puVar4;
    *(undefined1 *)(param_2 + 1) = 0;
    return;
  }
LAB_004406b1:
  puVar4 = (undefined4 *)FUN_00440a00(&param_3,bVar9,iVar2);
  *param_2 = *puVar4;
  *(undefined1 *)(param_2 + 1) = 1;
  return;
}



============================================================
DISASSEMBLY
============================================================
004405c0 : PUSH EBP
004405c1 : MOV EBP,ESP
004405c3 : SUB ESP,0x18
004405c6 : PUSH EBX
004405c7 : MOV EBX,dword ptr [EBP + 0x10]
004405ca : PUSH ESI
004405cb : PUSH EDI
004405cc : MOV EDI,dword ptr [EBP + 0x8]
004405cf : MOV EAX,dword ptr [EDI + 0x4]
004405d2 : MOV ESI,dword ptr [EAX + 0x4]
004405d5 : CMP byte ptr [ESI + 0x35],0x0
004405d9 : MOV ECX,EAX
004405db : MOV AL,0x1
004405dd : MOV dword ptr [EBP + -0x4],ECX
004405e0 : MOV byte ptr [EBP + -0x8],AL
004405e3 : JNZ 0x0044069a
004405e9 : MOV EAX,dword ptr [EBX + 0x14]
004405ec : MOV EDX,dword ptr [EBX + 0x18]
004405ef : MOV ECX,EAX
004405f1 : MOV dword ptr [EBP + -0x10],EAX
004405f4 : MOV dword ptr [EBP + -0xc],ECX
004405f7 : MOV dword ptr [EBP + -0x14],EDX
004405fa : JMP 0x00440603
00440600 : MOV ECX,dword ptr [EBP + -0xc]
00440603 : CMP dword ptr [ESI + 0x24],0x8
00440607 : MOV EDX,dword ptr [ESI + 0x20]
0044060a : MOV dword ptr [EBP + -0x4],ESI
0044060d : JC 0x00440614
0044060f : MOV EAX,dword ptr [ESI + 0x10]
00440612 : JMP 0x00440617
00440614 : LEA EAX,[ESI + 0x10]
00440617 : MOV EDI,dword ptr [EBP + -0x10]
0044061a : CMP ECX,EDI
0044061c : CMOVC EDI,ECX
0044061f : CMP EDI,EDX
00440621 : JNC 0x00440625
00440623 : MOV EDX,EDI
00440625 : CMP dword ptr [EBP + -0x14],0x8
00440629 : JC 0x00440630
0044062b : MOV ECX,dword ptr [EBX + 0x4]
0044062e : JMP 0x00440633
00440630 : LEA ECX,[EBX + 0x4]
00440633 : TEST EDX,EDX
00440635 : JBE 0x0044064d
00440637 : MOV BX,word ptr [ECX]
0044063a : CMP BX,word ptr [EAX]
0044063d : JNZ 0x00440659
0044063f : ADD ECX,0x2
00440642 : ADD EAX,0x2
00440645 : SUB EDX,0x1
00440648 : JNZ 0x00440637
0044064a : MOV EBX,dword ptr [EBP + 0x10]
0044064d : MOV EAX,dword ptr [ESI + 0x20]
00440650 : CMP EDI,EAX
00440652 : JNC 0x0044066e
00440654 : OR EAX,0xffffffff
00440657 : JMP 0x00440677
00440659 : MOV CX,BX
0044065c : CMP CX,word ptr [EAX]
0044065f : SBB EAX,EAX
00440661 : AND EAX,0xfffffffe
00440664 : ADD EAX,0x1
00440667 : JZ 0x0044064a
00440669 : MOV EBX,dword ptr [EBP + 0x10]
0044066c : JMP 0x00440677
0044066e : XOR EDX,EDX
00440670 : CMP EDI,EAX
00440672 : SETNZ DL
00440675 : MOV EAX,EDX
00440677 : TEST EAX,EAX
00440679 : SETL AL
0044067c : MOV byte ptr [EBP + -0x8],AL
0044067f : TEST AL,AL
00440681 : JZ 0x00440687
00440683 : MOV ESI,dword ptr [ESI]
00440685 : JMP 0x0044068a
00440687 : MOV ESI,dword ptr [ESI + 0x8]
0044068a : CMP byte ptr [ESI + 0x35],0x0
0044068e : JZ 0x00440600
00440694 : MOV EDI,dword ptr [EBP + 0x8]
00440697 : MOV ECX,dword ptr [EBP + -0x4]
0044069a : MOV ESI,ECX
0044069c : MOV dword ptr [EBP + 0x10],ESI
0044069f : TEST AL,AL
004406a1 : JZ 0x004406d2
004406a3 : MOV EAX,dword ptr [EDI + 0x4]
004406a6 : LEA EDX,[EBP + 0x10]
004406a9 : CMP ECX,dword ptr [EAX]
004406ab : JNZ 0x004406ca
004406ad : PUSH EBX
004406ae : PUSH 0x1
004406b0 : PUSH EDX
004406b1 : CALL 0x00440a00
004406b6 : MOV ECX,dword ptr [EAX]
004406b8 : MOV EAX,dword ptr [EBP + 0xc]
004406bb : MOV dword ptr [EAX],ECX
004406bd : MOV byte ptr [EAX + 0x4],0x1
004406c1 : POP EDI
004406c2 : POP ESI
004406c3 : POP EBX
004406c4 : MOV ESP,EBP
004406c6 : POP EBP
004406c7 : RET 0xc
004406ca : CALL 0x00403140
004406cf : MOV ESI,dword ptr [EBP + 0x10]
004406d2 : CMP dword ptr [EBX + 0x18],0x8
004406d6 : MOV EDI,dword ptr [EBX + 0x14]
004406d9 : LEA ECX,[ESI + 0xc]
004406dc : JC 0x004406e3
004406de : MOV EAX,dword ptr [EBX + 0x4]
004406e1 : JMP 0x004406e6
004406e3 : LEA EAX,[EBX + 0x4]
004406e6 : PUSH EAX
004406e7 : MOV EAX,dword ptr [ECX + 0x14]
004406ea : CALL 0x00405bb0
004406ef : TEST EAX,EAX
004406f1 : JGE 0x00440704
004406f3 : MOV EDX,dword ptr [EBP + -0x8]
004406f6 : MOV ECX,dword ptr [EBP + -0x4]
004406f9 : MOV EDI,dword ptr [EBP + 0x8]
004406fc : PUSH EBX
004406fd : PUSH EDX
004406fe : LEA EAX,[EBP + 0x10]
00440701 : PUSH EAX
00440702 : JMP 0x004406b1
00440704 : MOV EAX,dword ptr [EBP + 0xc]
00440707 : POP EDI
00440708 : MOV dword ptr [EAX],ESI
0044070a : POP ESI
0044070b : MOV byte ptr [EAX + 0x4],0x0
0044070f : POP EBX
00440710 : MOV ESP,EBP
00440712 : POP EBP
00440713 : RET 0xc

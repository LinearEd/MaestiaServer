PROGRAM  : Maestia.exe
FUNCTION : FUN_007d5f70
ENTRY    : 007d5f70
BODY     : [[007d5f70, 007d6143]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_007d5f70(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  char cVar3;
  uint uVar4;
  undefined4 uVar5;
  int in_ECX;
  int iVar6;
  int iVar7;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b10165;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar7 = *(int *)(in_ECX + 0x288);
  if ((iVar7 != 0) && ((*(int *)(iVar7 + 0x60) - *(int *)(iVar7 + 0x5c) & 0xfffffffcU) != 0)) {
    uVar5 = FUN_00a65fb0(param_1,param_2,param_3);
    ExceptionList = local_10;
    return uVar5;
  }
  iVar6 = *(int *)(in_ECX + 0x238) - *(int *)(in_ECX + 0x234);
  iVar7 = iVar6 >> 0x1f;
  if (iVar6 / 0x178 + iVar7 == iVar7) {
    if (*(int *)(in_ECX + 8) != 0) {
      EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
    }
    local_8 = 0;
    puVar1 = *(undefined4 **)(in_ECX + 0x188);
    for (puVar2 = (undefined4 *)*puVar1; puVar2 != puVar1; puVar2 = (undefined4 *)*puVar2) {
      cVar3 = (**(code **)(*(int *)puVar2[9] + 0x50))(param_1,param_2,param_3,uVar4);
      if (cVar3 != '\0') goto LAB_007d6116;
    }
    local_8 = 0xffffffff;
    if (*(int *)(in_ECX + 8) != 0) {
      LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
    }
    if (*(int *)(in_ECX + 8) != 0) {
      EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
    }
    local_8 = 1;
    puVar1 = *(undefined4 **)(in_ECX + 0x38);
    for (puVar2 = (undefined4 *)*puVar1; puVar2 != puVar1; puVar2 = (undefined4 *)*puVar2) {
      cVar3 = (**(code **)(*(int *)puVar2[9] + 200))(param_1,param_2,param_3);
      if (cVar3 != '\0') {
LAB_007d6116:
        local_8 = 0xffffffff;
        if (*(int *)(in_ECX + 8) != 0) {
          LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
        }
        ExceptionList = local_10;
        return 1;
      }
    }
    local_8 = 0xffffffff;
    if (*(int *)(in_ECX + 8) != 0) {
      LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
    }
  }
  else {
    iVar7 = *(int *)(in_ECX + 0x234);
    if (iVar7 != *(int *)(in_ECX + 0x238)) {
      do {
        cVar3 = FUN_0079ed20(iVar7 + 0xbc,param_3);
        if (cVar3 != '\0') {
          ExceptionList = local_10;
          return 1;
        }
        iVar7 = iVar7 + 0x178;
      } while (iVar7 != *(int *)(in_ECX + 0x238));
    }
  }
  ExceptionList = local_10;
  return 0;
}



============================================================
DISASSEMBLY
============================================================
007d5f70 : PUSH EBP
007d5f71 : MOV EBP,ESP
007d5f73 : PUSH -0x1
007d5f75 : PUSH 0xb10165
007d5f7a : MOV EAX,FS:[0x0]
007d5f80 : PUSH EAX
007d5f81 : PUSH ECX
007d5f82 : PUSH EBX
007d5f83 : PUSH ESI
007d5f84 : PUSH EDI
007d5f85 : MOV EAX,[0x00d66fa0]
007d5f8a : XOR EAX,EBP
007d5f8c : PUSH EAX
007d5f8d : LEA EAX,[EBP + -0xc]
007d5f90 : MOV FS:[0x0],EAX
007d5f96 : MOV ESI,ECX
007d5f98 : MOV EDI,dword ptr [ESI + 0x288]
007d5f9e : TEST EDI,EDI
007d5fa0 : JZ 0x007d5fd4
007d5fa2 : MOV EAX,dword ptr [EDI + 0x60]
007d5fa5 : SUB EAX,dword ptr [EDI + 0x5c]
007d5fa8 : TEST EAX,0xfffffffc
007d5fad : JZ 0x007d5fd4
007d5faf : MOV ECX,dword ptr [EBP + 0x10]
007d5fb2 : MOV EDX,dword ptr [EBP + 0xc]
007d5fb5 : MOV EAX,dword ptr [EBP + 0x8]
007d5fb8 : PUSH ECX
007d5fb9 : PUSH EDX
007d5fba : PUSH EAX
007d5fbb : CALL 0x00a65fb0
007d5fc0 : MOV ECX,dword ptr [EBP + -0xc]
007d5fc3 : MOV dword ptr FS:[0x0],ECX
007d5fca : POP ECX
007d5fcb : POP EDI
007d5fcc : POP ESI
007d5fcd : POP EBX
007d5fce : MOV ESP,EBP
007d5fd0 : POP EBP
007d5fd1 : RET 0xc
007d5fd4 : MOV ECX,dword ptr [ESI + 0x238]
007d5fda : SUB ECX,dword ptr [ESI + 0x234]
007d5fe0 : MOV EAX,0xae4c415d
007d5fe5 : IMUL ECX
007d5fe7 : ADD EDX,ECX
007d5fe9 : SAR EDX,0x8
007d5fec : MOV ECX,EDX
007d5fee : SHR ECX,0x1f
007d5ff1 : ADD ECX,EDX
007d5ff3 : JZ 0x007d603e
007d5ff5 : MOV EDI,dword ptr [ESI + 0x234]
007d5ffb : CMP EDI,dword ptr [ESI + 0x238]
007d6001 : JZ 0x007d6100
007d6007 : MOV EBX,dword ptr [EBP + 0x10]
007d600a : LEA EBX,[EBX]
007d6010 : MOV ECX,dword ptr [EBP + 0xc]
007d6013 : PUSH EBX
007d6014 : LEA EDX,[EDI + 0xbc]
007d601a : PUSH EDX
007d601b : MOV EDX,dword ptr [EBP + 0x8]
007d601e : CALL 0x0079ed20
007d6023 : TEST AL,AL
007d6025 : JNZ 0x007d612e
007d602b : ADD EDI,0x178
007d6031 : CMP EDI,dword ptr [ESI + 0x238]
007d6037 : JNZ 0x007d6010
007d6039 : JMP 0x007d6100
007d603e : MOV EAX,dword ptr [ESI + 0x8]
007d6041 : MOV dword ptr [EBP + -0x10],ESI
007d6044 : TEST EAX,EAX
007d6046 : JZ 0x007d6052
007d6048 : ADD EAX,0x4
007d604b : PUSH EAX
007d604c : CALL dword ptr [0x00b85118]
007d6052 : MOV dword ptr [EBP + -0x4],0x0
007d6059 : MOV EBX,dword ptr [ESI + 0x188]
007d605f : MOV EDI,dword ptr [EBX]
007d6061 : CMP EDI,EBX
007d6063 : JZ 0x007d6089
007d6065 : MOV EDX,dword ptr [EBP + 0x10]
007d6068 : MOV ECX,dword ptr [EDI + 0x24]
007d606b : MOV EAX,dword ptr [ECX]
007d606d : MOV EAX,dword ptr [EAX + 0x50]
007d6070 : PUSH EDX
007d6071 : MOV EDX,dword ptr [EBP + 0xc]
007d6074 : PUSH EDX
007d6075 : MOV EDX,dword ptr [EBP + 0x8]
007d6078 : PUSH EDX
007d6079 : CALL EAX
007d607b : TEST AL,AL
007d607d : JNZ 0x007d6116
007d6083 : MOV EDI,dword ptr [EDI]
007d6085 : CMP EDI,EBX
007d6087 : JNZ 0x007d6065
007d6089 : MOV dword ptr [EBP + -0x4],0xffffffff
007d6090 : MOV EAX,dword ptr [ESI + 0x8]
007d6093 : TEST EAX,EAX
007d6095 : JZ 0x007d60a1
007d6097 : ADD EAX,0x4
007d609a : PUSH EAX
007d609b : CALL dword ptr [0x00b8511c]
007d60a1 : MOV EAX,dword ptr [ESI + 0x8]
007d60a4 : MOV dword ptr [EBP + -0x10],ESI
007d60a7 : TEST EAX,EAX
007d60a9 : JZ 0x007d60b5
007d60ab : ADD EAX,0x4
007d60ae : PUSH EAX
007d60af : CALL dword ptr [0x00b85118]
007d60b5 : MOV dword ptr [EBP + -0x4],0x1
007d60bc : MOV EBX,dword ptr [ESI + 0x38]
007d60bf : MOV EDI,dword ptr [EBX]
007d60c1 : CMP EDI,EBX
007d60c3 : JZ 0x007d60e8
007d60c5 : MOV EAX,dword ptr [EBP + 0x10]
007d60c8 : MOV ECX,dword ptr [EDI + 0x24]
007d60cb : MOV EDX,dword ptr [ECX]
007d60cd : MOV EDX,dword ptr [EDX + 0xc8]
007d60d3 : PUSH EAX
007d60d4 : MOV EAX,dword ptr [EBP + 0xc]
007d60d7 : PUSH EAX
007d60d8 : MOV EAX,dword ptr [EBP + 0x8]
007d60db : PUSH EAX
007d60dc : CALL EDX
007d60de : TEST AL,AL
007d60e0 : JNZ 0x007d6116
007d60e2 : MOV EDI,dword ptr [EDI]
007d60e4 : CMP EDI,EBX
007d60e6 : JNZ 0x007d60c5
007d60e8 : MOV dword ptr [EBP + -0x4],0xffffffff
007d60ef : MOV ESI,dword ptr [ESI + 0x8]
007d60f2 : TEST ESI,ESI
007d60f4 : JZ 0x007d6100
007d60f6 : ADD ESI,0x4
007d60f9 : PUSH ESI
007d60fa : CALL dword ptr [0x00b8511c]
007d6100 : XOR AL,AL
007d6102 : MOV ECX,dword ptr [EBP + -0xc]
007d6105 : MOV dword ptr FS:[0x0],ECX
007d610c : POP ECX
007d610d : POP EDI
007d610e : POP ESI
007d610f : POP EBX
007d6110 : MOV ESP,EBP
007d6112 : POP EBP
007d6113 : RET 0xc
007d6116 : MOV dword ptr [EBP + -0x4],0xffffffff
007d611d : MOV ESI,dword ptr [ESI + 0x8]
007d6120 : TEST ESI,ESI
007d6122 : JZ 0x007d612e
007d6124 : ADD ESI,0x4
007d6127 : PUSH ESI
007d6128 : CALL dword ptr [0x00b8511c]
007d612e : MOV AL,0x1
007d6130 : MOV ECX,dword ptr [EBP + -0xc]
007d6133 : MOV dword ptr FS:[0x0],ECX
007d613a : POP ECX
007d613b : POP EDI
007d613c : POP ESI
007d613d : POP EBX
007d613e : MOV ESP,EBP
007d6140 : POP EBP
007d6141 : RET 0xc

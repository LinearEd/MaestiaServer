PROGRAM  : Maestia.exe
FUNCTION : FUN_004d5cf0
ENTRY    : 004d5cf0
BODY     : [[004d5cf0, 004d5da3]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_004d5cf0(void)

{
  uint uVar1;
  uint uVar2;
  int in_ECX;
  ushort *puVar3;
  ushort *puVar4;
  uint uVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  undefined4 *local_c;
  
  local_c = DAT_017245c4;
  if (*(char *)((int)DAT_017245c4[1] + 0x2d) == '\0') {
    uVar1 = *(uint *)(in_ECX + 0x14);
    puVar6 = (undefined4 *)DAT_017245c4[1];
    do {
      puVar3 = (ushort *)(in_ECX + 4);
      if (7 < *(uint *)(in_ECX + 0x18)) {
        puVar3 = *(ushort **)(in_ECX + 4);
      }
      uVar2 = puVar6[8];
      uVar5 = uVar2;
      if (uVar1 <= uVar2) {
        uVar5 = uVar1;
      }
      if ((uint)puVar6[9] < 8) {
        puVar4 = (ushort *)(puVar6 + 4);
      }
      else {
        puVar4 = (ushort *)puVar6[4];
      }
      for (; uVar5 != 0; uVar5 = uVar5 - 1) {
        if (*puVar4 != *puVar3) {
          uVar5 = (-(uint)(*puVar4 < *puVar3) & 0xfffffffe) + 1;
          if (uVar5 != 0) goto LAB_004d5d83;
          break;
        }
        puVar4 = puVar4 + 1;
        puVar3 = puVar3 + 1;
      }
      if (uVar2 < uVar1) {
LAB_004d5d87:
        puVar7 = (undefined4 *)puVar6[2];
      }
      else {
        uVar5 = (uint)(uVar2 != uVar1);
LAB_004d5d83:
        if ((int)uVar5 < 0) goto LAB_004d5d87;
        puVar7 = (undefined4 *)*puVar6;
        local_c = puVar6;
      }
      puVar6 = puVar7;
    } while (*(char *)((int)puVar7 + 0x2d) == '\0');
  }
  return local_c;
}



============================================================
DISASSEMBLY
============================================================
004d5cf0 : SUB ESP,0xc
004d5cf3 : MOV EAX,[0x017245c4]
004d5cf8 : PUSH EDI
004d5cf9 : MOV EDI,dword ptr [EAX + 0x4]
004d5cfc : CMP byte ptr [EDI + 0x2d],0x0
004d5d00 : MOV dword ptr [ESP + 0x4],EAX
004d5d04 : JNZ 0x004d5d9f
004d5d0a : MOV EAX,dword ptr [ECX + 0x18]
004d5d0d : PUSH EBX
004d5d0e : PUSH EBP
004d5d0f : MOV EBP,dword ptr [ECX + 0x14]
004d5d12 : ADD ECX,0x4
004d5d15 : PUSH ESI
004d5d16 : MOV dword ptr [ESP + 0x18],EAX
004d5d1a : MOV dword ptr [ESP + 0x14],ECX
004d5d1e : JMP 0x004d5d24
004d5d20 : MOV ECX,dword ptr [ESP + 0x14]
004d5d24 : MOV EAX,0x8
004d5d29 : CMP dword ptr [ESP + 0x18],EAX
004d5d2d : JC 0x004d5d31
004d5d2f : MOV ECX,dword ptr [ECX]
004d5d31 : MOV EBX,dword ptr [EDI + 0x20]
004d5d34 : MOV EDX,EBX
004d5d36 : CMP EDX,EBX
004d5d38 : JNC 0x004d5d3a
004d5d3a : MOV ESI,EBX
004d5d3c : CMP EBX,EBP
004d5d3e : JC 0x004d5d42
004d5d40 : MOV ESI,EBP
004d5d42 : CMP dword ptr [EDI + 0x24],EAX
004d5d45 : JC 0x004d5d4c
004d5d47 : MOV EDX,dword ptr [EDI + 0x10]
004d5d4a : JMP 0x004d5d4f
004d5d4c : LEA EDX,[EDI + 0x10]
004d5d4f : TEST ESI,ESI
004d5d51 : JBE 0x004d5d78
004d5d53 : MOV AX,word ptr [EDX]
004d5d56 : CMP AX,word ptr [ECX]
004d5d59 : JNZ 0x004d5d68
004d5d5b : ADD EDX,0x2
004d5d5e : ADD ECX,0x2
004d5d61 : SUB ESI,0x1
004d5d64 : JNZ 0x004d5d53
004d5d66 : JMP 0x004d5d78
004d5d68 : MOV DX,AX
004d5d6b : CMP DX,word ptr [ECX]
004d5d6e : SBB ECX,ECX
004d5d70 : AND ECX,0xfffffffe
004d5d73 : ADD ECX,0x1
004d5d76 : JNZ 0x004d5d83
004d5d78 : CMP EBX,EBP
004d5d7a : JC 0x004d5d87
004d5d7c : XOR ECX,ECX
004d5d7e : CMP EBX,EBP
004d5d80 : SETNZ CL
004d5d83 : TEST ECX,ECX
004d5d85 : JGE 0x004d5d8c
004d5d87 : MOV EDI,dword ptr [EDI + 0x8]
004d5d8a : JMP 0x004d5d92
004d5d8c : MOV dword ptr [ESP + 0x10],EDI
004d5d90 : MOV EDI,dword ptr [EDI]
004d5d92 : CMP byte ptr [EDI + 0x2d],0x0
004d5d96 : JZ 0x004d5d20
004d5d98 : MOV EAX,dword ptr [ESP + 0x10]
004d5d9c : POP ESI
004d5d9d : POP EBP
004d5d9e : POP EBX
004d5d9f : POP EDI
004d5da0 : ADD ESP,0xc
004d5da3 : RET

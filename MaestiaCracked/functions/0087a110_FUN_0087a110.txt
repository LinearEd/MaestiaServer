PROGRAM  : Maestia.exe
FUNCTION : FUN_0087a110
ENTRY    : 0087a110
BODY     : [[0087a110, 0087a5f7]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0087a110(float *param_1)

{
  float fVar1;
  float fVar2;
  float fVar3;
  float fVar4;
  char cVar5;
  int iVar6;
  float *pfVar7;
  float unaff_EDI;
  float fVar8;
  float fVar9;
  float fVar10;
  float fStack_108;
  float local_104;
  float local_100;
  float local_fc;
  float fStack_f8;
  float fStack_f4;
  float fStack_f0;
  float fStack_ec;
  float fStack_e8;
  float fStack_e4;
  float fStack_e0;
  float fStack_dc;
  undefined4 local_d8;
  undefined4 local_d4;
  undefined4 local_d0;
  float fStack_c8;
  undefined4 uStack_c0;
  undefined4 uStack_bc;
  undefined4 local_b8;
  undefined4 local_b4;
  undefined4 local_b0;
  undefined4 local_ac;
  undefined4 uStack_a8;
  undefined4 uStack_a4;
  float fStack_a0;
  undefined4 uStack_9c;
  float fStack_98;
  float fStack_94;
  float fStack_90;
  float fStack_8c;
  undefined1 auStack_78 [4];
  undefined1 auStack_74 [12];
  float local_68;
  undefined4 local_64;
  undefined4 local_60;
  undefined4 local_5c;
  undefined1 auStack_54 [12];
  undefined4 local_48 [17];
  
  local_104 = 0.0;
  local_100 = 0.0;
  if (((*(int *)(*DAT_00da9894 + 0x288) != 0) &&
      (local_fc = *(float *)(*(int *)(*DAT_00da9894 + 0x288) + 0x38), local_fc != 0.0)) &&
     ((iVar6 = FUN_00a1a840(), iVar6 != 0 ||
      ((iVar6 = FUN_00a1a6d0(), iVar6 != 0 || (iVar6 = FUN_00a1a780(), iVar6 != 0)))))) {
    fVar4 = local_fc;
    FUN_00889560();
    local_68 = local_104;
    local_60 = local_100;
    local_48[0] = 0;
    local_b8 = 0;
    local_b4 = 0;
    local_b0 = 0;
    local_ac = 0;
    local_64 = 0;
    local_5c = 0x3f800000;
    local_d8 = 0;
    local_d4 = 0x3f800000;
    local_d0 = 0;
    D3DXMatrixRotationAxis(local_48,&local_d8);
    D3DXVec4Transform(&stack0xffffff3c,auStack_74,auStack_54);
    D3DXVec2Normalize(&local_104,&local_104);
    FUN_0085f980(0xbe3ba866,unaff_EDI);
    iVar6 = *(int *)(iVar6 + 1000);
    fVar1 = *(float *)(iVar6 + 0x68);
    fVar2 = *(float *)(iVar6 + 0x6c);
    fVar3 = *(float *)(iVar6 + 0x70);
    pfVar7 = &fStack_c8;
    iVar6 = 4;
    do {
      *pfVar7 = 0.0;
      pfVar7[1] = 0.0;
      pfVar7 = pfVar7 + 2;
      iVar6 = iVar6 + -1;
    } while (-1 < iVar6);
    local_100 = -0.18325958;
    fStack_c8 = -0.18325958;
    uStack_c0 = 0;
    uStack_bc = 0x3f800000;
    local_b8 = 0;
    local_b4 = 0xbf800000;
    local_b0 = 0x3f800000;
    param_1[1] = fVar2;
    local_ac = 0;
    uStack_a8 = 0xbf800000;
    uStack_a4 = 0;
    fVar10 = 0.0;
    *param_1 = fVar1;
    param_1[2] = fVar3;
    iVar6 = 0;
    local_fc = unaff_EDI;
    do {
      fVar8 = local_fc * *(float *)(&stack0xffffff3c + iVar6 * 8) +
              (&fStack_c8)[iVar6 * 2] * local_100;
      fStack_108 = 0.0;
      if (fVar10 <= fVar8) {
        fStack_dc = (&fStack_c8)[iVar6 * 2];
        fStack_e0 = *(float *)(&stack0xffffff3c + iVar6 * 8);
        fVar9 = fStack_dc * 27.0 + fVar1;
        local_104 = fStack_e0 * 27.0 + fVar3;
        if ((*(char *)(DAT_00da93ec + 0x514) != '\0') ||
           (cVar5 = FUN_00891380(fVar4,fVar9,local_104,&fStack_108,&stack0xfffffedb,auStack_78,0),
           cVar5 != '\0')) {
          uStack_9c = 0;
          fStack_f4 = fStack_108;
          fStack_f8 = fVar9;
          fStack_f0 = local_104;
          fStack_a0 = fStack_dc;
          fStack_98 = fStack_e0;
          fStack_94 = fVar1;
          fStack_90 = fVar2;
          fStack_8c = fVar3;
          FUN_0085e880(fVar4,&fStack_94,&fStack_f8,&stack0xffffff60,0x41d80000);
          fVar10 = fStack_108;
          if (fStack_108 <= fStack_f4) {
            fVar10 = fStack_f4;
          }
          fStack_e8 = fVar10 - fVar2;
          fStack_ec = fVar9 - fVar1;
          fStack_e4 = local_104 - fVar3;
          if (fStack_e8 <= DAT_00d72c20) {
            param_1[1] = fVar10;
            *param_1 = fVar9;
            param_1[2] = local_104;
            fVar10 = fVar8;
          }
          else {
            D3DXVec3Normalize(&fStack_ec,&fStack_ec);
            *param_1 = fStack_ec * 27.0 + fVar1;
            param_1[1] = fStack_e8 * 27.0 + fVar2;
            param_1[2] = fStack_e4 * 27.0 + fVar3;
            fVar10 = fVar8;
          }
        }
      }
      iVar6 = iVar6 + 1;
    } while (iVar6 < 5);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
0087a110 : PUSH EBP
0087a111 : MOV EBP,ESP
0087a113 : AND ESP,0xfffffff8
0087a116 : SUB ESP,0x10c
0087a11c : MOV EAX,[0x00da9894]
0087a121 : XORPS XMM0,XMM0
0087a124 : MOV ECX,dword ptr [EAX]
0087a126 : PUSH EBX
0087a127 : MOVSS dword ptr [ESP + 0x14],XMM0
0087a12d : MOVSS dword ptr [ESP + 0x18],XMM0
0087a133 : MOV EAX,dword ptr [ECX + 0x288]
0087a139 : PUSH ESI
0087a13a : PUSH EDI
0087a13b : TEST EAX,EAX
0087a13d : JZ 0x0087a5ef
0087a143 : MOV EAX,dword ptr [EAX + 0x38]
0087a146 : MOV dword ptr [ESP + 0x24],EAX
0087a14a : TEST EAX,EAX
0087a14c : JZ 0x0087a5ef
0087a152 : MOV ECX,dword ptr [0x00da93ec]
0087a158 : MOV ESI,dword ptr [ECX + 0x24c]
0087a15e : PUSH ESI
0087a15f : MOV EBX,ECX
0087a161 : CALL 0x00a1a840
0087a166 : MOV EDI,EAX
0087a168 : TEST EDI,EDI
0087a16a : JNZ 0x0087a18c
0087a16c : PUSH ESI
0087a16d : MOV ECX,EBX
0087a16f : CALL 0x00a1a6d0
0087a174 : MOV EDI,EAX
0087a176 : TEST EDI,EDI
0087a178 : JNZ 0x0087a18c
0087a17a : PUSH ESI
0087a17b : MOV ECX,EBX
0087a17d : CALL 0x00a1a780
0087a182 : MOV EDI,EAX
0087a184 : TEST EDI,EDI
0087a186 : JZ 0x0087a5ef
0087a18c : MOV EBX,dword ptr [ESP + 0x24]
0087a190 : LEA ESI,[ESP + 0x1c]
0087a194 : MOV EAX,EBX
0087a196 : CALL 0x00889560
0087a19b : FLD float ptr [0x00cdf814]
0087a1a1 : XORPS XMM0,XMM0
0087a1a4 : MOVSS XMM1,dword ptr [ESP + 0x1c]
0087a1aa : PUSH ECX
0087a1ab : FSTP float ptr [ESP]
0087a1ae : MOVSS dword ptr [ESP + 0xbc],XMM1
0087a1b7 : MOVSS XMM1,dword ptr [ESP + 0x24]
0087a1bd : LEA EDX,[ESP + 0x4c]
0087a1c1 : PUSH EDX
0087a1c2 : LEA EAX,[ESP + 0xe0]
0087a1c9 : MOVSS dword ptr [ESP + 0xc8],XMM1
0087a1d2 : MOVSS XMM1,dword ptr [0x00c10fc4]
0087a1da : PUSH EAX
0087a1db : MOVSS dword ptr [ESP + 0xe4],XMM0
0087a1e4 : MOVSS dword ptr [ESP + 0x74],XMM0
0087a1ea : MOVSS dword ptr [ESP + 0x78],XMM0
0087a1f0 : MOVSS dword ptr [ESP + 0x7c],XMM0
0087a1f6 : MOVSS dword ptr [ESP + 0x80],XMM0
0087a1ff : MOVSS dword ptr [ESP + 0xc8],XMM0
0087a208 : MOVSS dword ptr [ESP + 0xd0],XMM1
0087a211 : MOVSS dword ptr [ESP + 0x54],XMM0
0087a217 : MOVSS dword ptr [ESP + 0x58],XMM1
0087a21d : MOVSS dword ptr [ESP + 0x5c],XMM0
0087a223 : CALL 0x004ff746
0087a228 : LEA ECX,[ESP + 0xd8]
0087a22f : PUSH ECX
0087a230 : LEA EDX,[ESP + 0xbc]
0087a237 : PUSH EDX
0087a238 : LEA EAX,[ESP + 0x70]
0087a23c : PUSH EAX
0087a23d : CALL 0x004ff74c
0087a242 : FLD float ptr [ESP + 0x68]
0087a246 : MOV ECX,ESI
0087a248 : FSTP float ptr [ESP + 0x1c]
0087a24c : FLD float ptr [ESP + 0x70]
0087a250 : PUSH ECX
0087a251 : MOV EDX,ESI
0087a253 : FSTP float ptr [ESP + 0x24]
0087a257 : PUSH EDX
0087a258 : CALL 0x004ff71c
0087a25d : FLD float ptr [ESP + 0x20]
0087a261 : SUB ESP,0x8
0087a264 : FSTP float ptr [ESP + 0x4]
0087a268 : MOV ECX,EBX
0087a26a : FLD float ptr [ESP + 0x24]
0087a26e : FSTP float ptr [ESP]
0087a271 : CALL 0x0085f980
0087a276 : MOV EDI,dword ptr [EDI + 0x3e8]
0087a27c : MOVSS XMM4,dword ptr [EDI + 0x68]
0087a281 : MOVSS XMM3,dword ptr [EDI + 0x6c]
0087a286 : MOVSS XMM5,dword ptr [EDI + 0x70]
0087a28b : XORPS XMM2,XMM2
0087a28e : ADD EDI,0x68
0087a291 : MOVSS dword ptr [ESP + 0x28],XMM4
0087a297 : MOVSS dword ptr [ESP + 0x2c],XMM3
0087a29d : MOVSS dword ptr [ESP + 0x30],XMM5
0087a2a3 : LEA EAX,[ESP + 0x78]
0087a2a7 : MOV ECX,0x4
0087a2ac : LEA ESP,[ESP]
0087a2b0 : MOVSS dword ptr [EAX],XMM2
0087a2b4 : MOVSS dword ptr [EAX + 0x4],XMM2
0087a2b9 : ADD EAX,0x8
0087a2bc : SUB ECX,0x1
0087a2bf : JNS 0x0087a2b0
0087a2c1 : MOVSS XMM0,dword ptr [ESP + 0x1c]
0087a2c7 : MOVSS XMM1,dword ptr [0x00c10fc4]
0087a2cf : MOV EDI,dword ptr [EBP + 0x8]
0087a2d2 : MOVSS dword ptr [ESP + 0x40],XMM0
0087a2d8 : MOVSS XMM0,dword ptr [ESP + 0x20]
0087a2de : MOV EAX,dword ptr [ESP + 0x40]
0087a2e2 : MOVSS dword ptr [ESP + 0x44],XMM0
0087a2e8 : MOV ECX,dword ptr [ESP + 0x44]
0087a2ec : MOVSS XMM0,dword ptr [0x00cdf0d0]
0087a2f4 : MOV dword ptr [ESP + 0x78],EAX
0087a2f8 : MOVSS dword ptr [ESP + 0x10],XMM2
0087a2fe : MOV EDX,dword ptr [ESP + 0x10]
0087a302 : MOVSS dword ptr [ESP + 0x14],XMM1
0087a308 : MOV EAX,dword ptr [ESP + 0x14]
0087a30c : MOV dword ptr [ESP + 0x7c],ECX
0087a310 : MOVSS dword ptr [ESP + 0x10],XMM2
0087a316 : MOV ECX,dword ptr [ESP + 0x10]
0087a31a : MOV dword ptr [ESP + 0x80],EDX
0087a321 : MOVSS dword ptr [ESP + 0x14],XMM0
0087a327 : MOV EDX,dword ptr [ESP + 0x14]
0087a32b : MOV dword ptr [ESP + 0x84],EAX
0087a332 : MOVSS dword ptr [ESP + 0x10],XMM1
0087a338 : MOV EAX,dword ptr [ESP + 0x10]
0087a33c : MOVSS dword ptr [ESP + 0x14],XMM2
0087a342 : MOV dword ptr [ESP + 0x88],ECX
0087a349 : MOV ECX,dword ptr [ESP + 0x14]
0087a34d : MOV dword ptr [ESP + 0x8c],EDX
0087a354 : MOV dword ptr [ESP + 0x90],EAX
0087a35b : MOVSS dword ptr [ESP + 0x10],XMM0
0087a361 : MOV EDX,dword ptr [ESP + 0x10]
0087a365 : MOVSS dword ptr [ESP + 0x14],XMM2
0087a36b : MOV EAX,dword ptr [ESP + 0x14]
0087a36f : MOVSS dword ptr [EDI + 0x4],XMM3
0087a374 : MOVSS XMM3,dword ptr [0x00cdf278]
0087a37c : MOV dword ptr [ESP + 0x94],ECX
0087a383 : MOV dword ptr [ESP + 0x98],EDX
0087a38a : MOV dword ptr [ESP + 0x9c],EAX
0087a391 : MOVSS dword ptr [ESP + 0x24],XMM2
0087a397 : MOVSS dword ptr [EDI],XMM4
0087a39b : MOVSS dword ptr [EDI + 0x8],XMM5
0087a3a0 : XOR ESI,ESI
0087a3a2 : MOVSS XMM0,dword ptr [ESP + 0x44]
0087a3a8 : MOVSS XMM1,dword ptr [ESP + ESI*0x8 + 0x78]
0087a3ae : MULSS XMM1,dword ptr [ESP + 0x40]
0087a3b4 : MULSS XMM0,dword ptr [ESP + ESI*0x8 + 0x7c]
0087a3ba : ADDSS XMM0,XMM1
0087a3be : MOVSS XMM1,dword ptr [ESP + 0x24]
0087a3c4 : COMISS XMM1,XMM0
0087a3c7 : MOV byte ptr [ESP + 0x1b],0xff
0087a3cc : MOVSS dword ptr [ESP + 0x38],XMM2
0087a3d2 : MOVSS dword ptr [ESP + 0x10],XMM0
0087a3d8 : JA 0x0087a5e5
0087a3de : MOVSS XMM6,dword ptr [ESP + ESI*0x8 + 0x78]
0087a3e4 : MOVSS XMM7,dword ptr [ESP + ESI*0x8 + 0x7c]
0087a3ea : MOV ECX,dword ptr [0x00da93ec]
0087a3f0 : CMP byte ptr [ECX + 0x514],0x0
0087a3f7 : MOVAPS XMM1,XMM6
0087a3fa : MOVAPS XMM0,XMM7
0087a3fd : MULSS XMM1,XMM3
0087a401 : MULSS XMM0,XMM3
0087a405 : ADDSS XMM1,XMM4
0087a409 : ADDSS XMM0,XMM5
0087a40d : MOVSS dword ptr [ESP + 0x64],XMM6
0087a413 : MOVSS dword ptr [ESP + 0x34],XMM1
0087a419 : MOVSS dword ptr [ESP + 0x60],XMM7
0087a41f : MOVSS dword ptr [ESP + 0x3c],XMM0
0087a425 : JNZ 0x0087a482
0087a427 : FLD float ptr [ESP + 0x3c]
0087a42b : PUSH 0x0
0087a42d : LEA EDX,[ESP + 0xcc]
0087a434 : PUSH EDX
0087a435 : LEA EAX,[ESP + 0x23]
0087a439 : PUSH EAX
0087a43a : LEA ECX,[ESP + 0x44]
0087a43e : PUSH ECX
0087a43f : SUB ESP,0x8
0087a442 : FSTP float ptr [ESP + 0x4]
0087a446 : FLD float ptr [ESP + 0x4c]
0087a44a : FSTP float ptr [ESP]
0087a44d : PUSH EBX
0087a44e : CALL 0x00891380
0087a453 : XORPS XMM2,XMM2
0087a456 : MOVSS XMM4,dword ptr [ESP + 0x28]
0087a45c : MOVSS XMM5,dword ptr [ESP + 0x30]
0087a462 : TEST AL,AL
0087a464 : JZ 0x0087a5dd
0087a46a : MOVSS XMM0,dword ptr [ESP + 0x3c]
0087a470 : MOVSS XMM1,dword ptr [ESP + 0x34]
0087a476 : MOVSS XMM7,dword ptr [ESP + 0x60]
0087a47c : MOVSS XMM6,dword ptr [ESP + 0x64]
0087a482 : FLD float ptr [0x00cdf278]
0087a488 : PUSH ECX
0087a489 : FSTP float ptr [ESP]
0087a48c : LEA EDX,[ESP + 0xa4]
0087a493 : PUSH EDX
0087a494 : LEA EAX,[ESP + 0x50]
0087a498 : PUSH EAX
0087a499 : LEA ECX,[ESP + 0xb8]
0087a4a0 : PUSH ECX
0087a4a1 : MOVSS dword ptr [ESP + 0xb4],XMM2
0087a4aa : MOVSS XMM2,dword ptr [ESP + 0x3c]
0087a4b0 : MOVSS dword ptr [ESP + 0x58],XMM1
0087a4b6 : MOVSS XMM1,dword ptr [ESP + 0x48]
0087a4bc : PUSH EBX
0087a4bd : MOVSS dword ptr [ESP + 0xb4],XMM6
0087a4c6 : MOVSS dword ptr [ESP + 0xbc],XMM7
0087a4cf : MOVSS dword ptr [ESP + 0xc0],XMM4
0087a4d8 : MOVSS dword ptr [ESP + 0xc4],XMM2
0087a4e1 : MOVSS dword ptr [ESP + 0xc8],XMM5
0087a4ea : MOVSS dword ptr [ESP + 0x60],XMM1
0087a4f0 : MOVSS dword ptr [ESP + 0x64],XMM0
0087a4f6 : CALL 0x0085e880
0087a4fb : MOVSS XMM0,dword ptr [ESP + 0x4c]
0087a501 : MOVSS XMM3,dword ptr [ESP + 0x38]
0087a507 : COMISS XMM3,XMM0
0087a50a : JA 0x0087a50f
0087a50c : MOVAPS XMM3,XMM0
0087a50f : MOVSS XMM7,dword ptr [ESP + 0x34]
0087a515 : MOVSS XMM6,dword ptr [ESP + 0x3c]
0087a51b : MOVSS XMM4,dword ptr [ESP + 0x28]
0087a521 : MOVSS XMM5,dword ptr [ESP + 0x30]
0087a527 : MOVAPS XMM0,XMM3
0087a52a : SUBSS XMM0,dword ptr [ESP + 0x2c]
0087a530 : COMISS XMM0,dword ptr [0x00d72c20]
0087a537 : MOVAPS XMM1,XMM7
0087a53a : MOVAPS XMM2,XMM6
0087a53d : SUBSS XMM1,XMM4
0087a541 : SUBSS XMM2,XMM5
0087a545 : MOVSS dword ptr [ESP + 0x54],XMM1
0087a54b : MOVSS dword ptr [ESP + 0x58],XMM0
0087a551 : MOVSS dword ptr [ESP + 0x5c],XMM2
0087a557 : JBE 0x0087a5b6
0087a559 : LEA EDX,[ESP + 0x54]
0087a55d : PUSH EDX
0087a55e : MOV EAX,EDX
0087a560 : PUSH EAX
0087a561 : CALL 0x004ff722
0087a566 : MOVSS XMM3,dword ptr [0x00cdf278]
0087a56e : MOVSS XMM0,dword ptr [ESP + 0x54]
0087a574 : MOVSS XMM1,dword ptr [ESP + 0x58]
0087a57a : MOVSS XMM2,dword ptr [ESP + 0x5c]
0087a580 : MOVSS XMM4,dword ptr [ESP + 0x28]
0087a586 : MOVSS XMM5,dword ptr [ESP + 0x30]
0087a58c : MULSS XMM0,XMM3
0087a590 : MULSS XMM1,XMM3
0087a594 : ADDSS XMM1,dword ptr [ESP + 0x2c]
0087a59a : MULSS XMM2,XMM3
0087a59e : ADDSS XMM0,XMM4
0087a5a2 : ADDSS XMM2,XMM5
0087a5a6 : MOVSS dword ptr [EDI],XMM0
0087a5aa : MOVSS dword ptr [EDI + 0x4],XMM1
0087a5af : MOVSS dword ptr [EDI + 0x8],XMM2
0087a5b4 : JMP 0x0087a5cc
0087a5b6 : MOVSS dword ptr [EDI + 0x4],XMM3
0087a5bb : MOVSS XMM3,dword ptr [0x00cdf278]
0087a5c3 : MOVSS dword ptr [EDI],XMM7
0087a5c7 : MOVSS dword ptr [EDI + 0x8],XMM6
0087a5cc : MOVSS XMM0,dword ptr [ESP + 0x10]
0087a5d2 : XORPS XMM2,XMM2
0087a5d5 : MOVSS dword ptr [ESP + 0x24],XMM0
0087a5db : JMP 0x0087a5e5
0087a5dd : MOVSS XMM3,dword ptr [0x00cdf278]
0087a5e5 : INC ESI
0087a5e6 : CMP ESI,0x5
0087a5e9 : JL 0x0087a3a2
0087a5ef : POP EDI
0087a5f0 : POP ESI
0087a5f1 : POP EBX
0087a5f2 : MOV ESP,EBP
0087a5f4 : POP EBP
0087a5f5 : RET 0x4

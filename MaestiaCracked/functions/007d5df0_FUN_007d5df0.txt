PROGRAM  : Maestia.exe
FUNCTION : FUN_007d5df0
ENTRY    : 007d5df0
BODY     : [[007d5df0, 007d5f66]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_007d5df0(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int *piVar3;
  char cVar4;
  uint uVar5;
  int iVar6;
  int in_ECX;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1013a;
  local_10 = ExceptionList;
  uVar5 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar6 = *(int *)(in_ECX + 0x288);
  if (((iVar6 == 0) || ((*(int *)(iVar6 + 0x60) - *(int *)(iVar6 + 0x5c) & 0xfffffffcU) == 0)) ||
     (cVar4 = FUN_00a65fb0(param_1,param_2,param_3), cVar4 == '\0')) {
    if (*(int *)(in_ECX + 8) != 0) {
      EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
    }
    local_8 = 0;
    puVar1 = *(undefined4 **)(in_ECX + 0x188);
    for (puVar2 = (undefined4 *)*puVar1; puVar2 != puVar1; puVar2 = (undefined4 *)*puVar2) {
      cVar4 = (**(code **)(*(int *)puVar2[9] + 0x58))(param_1,param_2,param_3,uVar5);
      if (cVar4 != '\0') goto LAB_007d5f39;
    }
    local_8 = 0xffffffff;
    if (*(int *)(in_ECX + 8) != 0) {
      LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
    }
    if (*(int *)(in_ECX + 8) != 0) {
      EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
    }
    local_8 = 1;
    puVar1 = *(undefined4 **)(in_ECX + 0x38);
    puVar2 = (undefined4 *)*puVar1;
    while( true ) {
      if (puVar2 == puVar1) {
        local_8 = 0xffffffff;
        if (*(int *)(in_ECX + 8) != 0) {
          LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
        }
        ExceptionList = local_10;
        return 0;
      }
      piVar3 = (int *)puVar2[9];
      iVar6 = (**(code **)(*piVar3 + 0x1c))();
      if ((iVar6 - 2U < 8) &&
         (cVar4 = (**(code **)(*piVar3 + 0x108))(param_1,param_2,param_3), cVar4 != '\0')) break;
      puVar2 = (undefined4 *)*puVar2;
    }
LAB_007d5f39:
    local_8 = 0xffffffff;
    if (*(int *)(in_ECX + 8) != 0) {
      LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
    }
  }
  ExceptionList = local_10;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
007d5df0 : PUSH EBP
007d5df1 : MOV EBP,ESP
007d5df3 : PUSH -0x1
007d5df5 : PUSH 0xb1013a
007d5dfa : MOV EAX,FS:[0x0]
007d5e00 : PUSH EAX
007d5e01 : SUB ESP,0x8
007d5e04 : PUSH EBX
007d5e05 : PUSH ESI
007d5e06 : PUSH EDI
007d5e07 : MOV EAX,[0x00d66fa0]
007d5e0c : XOR EAX,EBP
007d5e0e : PUSH EAX
007d5e0f : LEA EAX,[EBP + -0xc]
007d5e12 : MOV FS:[0x0],EAX
007d5e18 : MOV EBX,ECX
007d5e1a : MOV EDI,dword ptr [EBX + 0x288]
007d5e20 : TEST EDI,EDI
007d5e22 : JZ 0x007d5e4a
007d5e24 : MOV EAX,dword ptr [EDI + 0x60]
007d5e27 : SUB EAX,dword ptr [EDI + 0x5c]
007d5e2a : TEST EAX,0xfffffffc
007d5e2f : JZ 0x007d5e4a
007d5e31 : MOV ECX,dword ptr [EBP + 0x10]
007d5e34 : MOV EDX,dword ptr [EBP + 0xc]
007d5e37 : MOV EAX,dword ptr [EBP + 0x8]
007d5e3a : PUSH ECX
007d5e3b : PUSH EDX
007d5e3c : PUSH EAX
007d5e3d : CALL 0x00a65fb0
007d5e42 : TEST AL,AL
007d5e44 : JNZ 0x007d5f51
007d5e4a : MOV EAX,dword ptr [EBX + 0x8]
007d5e4d : MOV dword ptr [EBP + -0x10],EBX
007d5e50 : TEST EAX,EAX
007d5e52 : JZ 0x007d5e5e
007d5e54 : ADD EAX,0x4
007d5e57 : PUSH EAX
007d5e58 : CALL dword ptr [0x00b85118]
007d5e5e : MOV dword ptr [EBP + -0x4],0x0
007d5e65 : MOV EDI,dword ptr [EBX + 0x188]
007d5e6b : MOV ESI,dword ptr [EDI]
007d5e6d : CMP ESI,EDI
007d5e6f : JZ 0x007d5e95
007d5e71 : MOV EAX,dword ptr [EBP + 0x10]
007d5e74 : MOV ECX,dword ptr [ESI + 0x24]
007d5e77 : MOV EDX,dword ptr [ECX]
007d5e79 : MOV EDX,dword ptr [EDX + 0x58]
007d5e7c : PUSH EAX
007d5e7d : MOV EAX,dword ptr [EBP + 0xc]
007d5e80 : PUSH EAX
007d5e81 : MOV EAX,dword ptr [EBP + 0x8]
007d5e84 : PUSH EAX
007d5e85 : CALL EDX
007d5e87 : TEST AL,AL
007d5e89 : JNZ 0x007d5f39
007d5e8f : MOV ESI,dword ptr [ESI]
007d5e91 : CMP ESI,EDI
007d5e93 : JNZ 0x007d5e71
007d5e95 : MOV dword ptr [EBP + -0x4],0xffffffff
007d5e9c : MOV EAX,dword ptr [EBX + 0x8]
007d5e9f : TEST EAX,EAX
007d5ea1 : JZ 0x007d5ead
007d5ea3 : ADD EAX,0x4
007d5ea6 : PUSH EAX
007d5ea7 : CALL dword ptr [0x00b8511c]
007d5ead : MOV EAX,dword ptr [EBX + 0x8]
007d5eb0 : MOV dword ptr [EBP + -0x14],EBX
007d5eb3 : TEST EAX,EAX
007d5eb5 : JZ 0x007d5ec1
007d5eb7 : ADD EAX,0x4
007d5eba : PUSH EAX
007d5ebb : CALL dword ptr [0x00b85118]
007d5ec1 : MOV dword ptr [EBP + -0x4],0x1
007d5ec8 : MOV EAX,dword ptr [EBX + 0x38]
007d5ecb : MOV EDI,dword ptr [EAX]
007d5ecd : MOV dword ptr [EBP + -0x10],EAX
007d5ed0 : CMP EDI,EAX
007d5ed2 : JZ 0x007d5f0b
007d5ed4 : MOV ESI,dword ptr [EDI + 0x24]
007d5ed7 : MOV EAX,dword ptr [ESI]
007d5ed9 : MOV EDX,dword ptr [EAX + 0x1c]
007d5edc : MOV ECX,ESI
007d5ede : CALL EDX
007d5ee0 : ADD EAX,-0x2
007d5ee3 : CMP EAX,0x7
007d5ee6 : JA 0x007d5f04
007d5ee8 : MOV ECX,dword ptr [EBP + 0x10]
007d5eeb : MOV EDX,dword ptr [EBP + 0xc]
007d5eee : MOV EAX,dword ptr [ESI]
007d5ef0 : PUSH ECX
007d5ef1 : MOV ECX,dword ptr [EBP + 0x8]
007d5ef4 : PUSH EDX
007d5ef5 : MOV EDX,dword ptr [EAX + 0x108]
007d5efb : PUSH ECX
007d5efc : MOV ECX,ESI
007d5efe : CALL EDX
007d5f00 : TEST AL,AL
007d5f02 : JNZ 0x007d5f39
007d5f04 : MOV EDI,dword ptr [EDI]
007d5f06 : CMP EDI,dword ptr [EBP + -0x10]
007d5f09 : JNZ 0x007d5ed4
007d5f0b : MOV dword ptr [EBP + -0x4],0xffffffff
007d5f12 : MOV EBX,dword ptr [EBX + 0x8]
007d5f15 : TEST EBX,EBX
007d5f17 : JZ 0x007d5f23
007d5f19 : ADD EBX,0x4
007d5f1c : PUSH EBX
007d5f1d : CALL dword ptr [0x00b8511c]
007d5f23 : XOR AL,AL
007d5f25 : MOV ECX,dword ptr [EBP + -0xc]
007d5f28 : MOV dword ptr FS:[0x0],ECX
007d5f2f : POP ECX
007d5f30 : POP EDI
007d5f31 : POP ESI
007d5f32 : POP EBX
007d5f33 : MOV ESP,EBP
007d5f35 : POP EBP
007d5f36 : RET 0xc
007d5f39 : MOV dword ptr [EBP + -0x4],0xffffffff
007d5f40 : MOV EBX,dword ptr [EBX + 0x8]
007d5f43 : TEST EBX,EBX
007d5f45 : JZ 0x007d5f51
007d5f47 : ADD EBX,0x4
007d5f4a : PUSH EBX
007d5f4b : CALL dword ptr [0x00b8511c]
007d5f51 : MOV AL,0x1
007d5f53 : MOV ECX,dword ptr [EBP + -0xc]
007d5f56 : MOV dword ptr FS:[0x0],ECX
007d5f5d : POP ECX
007d5f5e : POP EDI
007d5f5f : POP ESI
007d5f60 : POP EBX
007d5f61 : MOV ESP,EBP
007d5f63 : POP EBP
007d5f64 : RET 0xc

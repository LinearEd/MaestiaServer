PROGRAM  : Maestia.exe
FUNCTION : FUN_00a554e0
ENTRY    : 00a554e0
BODY     : [[00a554e0, 00a55845]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00a554e0(void)

{
  float fVar1;
  uint uVar2;
  DWORD DVar3;
  undefined4 uVar4;
  int iVar5;
  int *piVar6;
  int in_ECX;
  undefined4 uStack_6c;
  float local_68 [2];
  LONG local_60;
  LONG LStack_5c;
  LONG LStack_58;
  LONG LStack_54;
  tagRECT local_50;
  undefined2 local_38;
  undefined4 local_28;
  uint local_24;
  void *pvStack_20;
  void *local_1c;
  undefined1 *puStack_18;
  undefined4 local_14;
  
  local_14 = 0xffffffff;
  puStack_18 = &LAB_00b65c69;
  local_1c = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xffffff80;
  ExceptionList = &local_1c;
  *(undefined1 *)(in_ECX + 0x7d) = 0;
  if (in_ECX == 4) {
    iVar5 = 0;
  }
  else {
    iVar5 = in_ECX + 0x14;
  }
  *(int *)(DAT_017247e4 + 8) = iVar5;
  DVar3 = timeGetTime();
  *(DWORD *)(in_ECX + 0xb8) = DVar3;
  iVar5 = DAT_017251ac;
  *(undefined4 *)(in_ECX + 0xbc) = 0;
  local_60 = 0x3f800000;
  LStack_5c = 0x3f800000;
  LStack_58 = 0x3f800000;
  LStack_54 = 0x3f800000;
  *(undefined4 *)(in_ECX + 0xc0) = 0;
  *(undefined4 *)(in_ECX + 0xc4) = 10;
  *(undefined8 *)(iVar5 + 0x2e4) = 0x3f8000003f800000;
  *(undefined8 *)(iVar5 + 0x2ec) = 0x3f8000003f800000;
  SetRect(&local_50,10,0x226,0x400,0x300);
  iVar5 = DAT_017251ac;
  local_60 = local_50.left;
  LStack_5c = local_50.top;
  LStack_58 = local_50.right;
  LStack_54 = local_50.bottom;
  *(ulonglong *)(DAT_017251ac + 0x2f4) = CONCAT44(local_50.top,local_50.left);
  *(ulonglong *)(iVar5 + 0x2fc) = CONCAT44(local_50.bottom,local_50.right);
  local_24 = 7;
  local_28 = 0;
  local_38 = 0;
  FUN_00406360(L"Lobby Camera",0xc);
  local_14 = 0;
  uVar4 = FUN_007f8ef0(uVar2);
  *(undefined4 *)(in_ECX + 0x2c) = uVar4;
  local_14 = 0xffffffff;
  if (7 < local_24) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_38 = 0;
  local_68[0] = *(float *)(in_ECX + 0x2c);
  local_24 = 7;
  local_28 = 0;
  iVar5 = (**(code **)(**(int **)(DAT_0172491c + 0x14) + 0xc))(0);
  *(undefined4 *)(iVar5 + 8) = uStack_6c;
  if (DAT_017251f8 != 0) {
    *(undefined4 *)(DAT_017251f8 + 0xe8) = uStack_6c;
  }
  iVar5 = *(int *)(DAT_017251ac + 0x178);
  fVar1 = (float)*(int *)(iVar5 + 0x48);
  if (*(int *)(iVar5 + 0x48) < 0) {
    fVar1 = fVar1 + 4.2949673e+09;
  }
  local_68[0] = (float)*(int *)(iVar5 + 0x4c);
  if (*(int *)(iVar5 + 0x4c) < 0) {
    local_68[0] = local_68[0] + 4.2949673e+09;
  }
  iVar5 = *(int *)(in_ECX + 0x2c);
  *(float *)(iVar5 + 0x50) = fVar1 / local_68[0];
  *(undefined4 *)(iVar5 + 0x54) = 0x3f800000;
  *(undefined4 *)(iVar5 + 0x4c) = 0x3f490fdb;
  *(undefined4 *)(iVar5 + 0x58) = 0x461c4000;
  *(undefined4 *)(iVar5 + 0x5c) = 0x461c4000;
  *(undefined1 *)(iVar5 + 0x155) = 1;
  if ((char)((int *)*DAT_00da9894)[0xd] == '\0') {
    (**(code **)(*(int *)*DAT_00da9894 + 8))();
  }
  FUN_00a6a6b0(DAT_017248f8 + 4);
  piVar6 = (int *)FUN_007f91b0(*(undefined4 *)(DAT_0172491c + 0x90),in_ECX + -4,0);
  *(int **)(in_ECX + 0x4c) = piVar6;
  if (piVar6 == (int *)0x0) {
    FUN_008018d0(L"[AvaGameLobby::Initialize] Flash file not found.\n");
  }
  else {
    (**(code **)(*piVar6 + 0x14))(2);
    (**(code **)(**(int **)(in_ECX + 0x4c) + 0xc))(1);
    (**(code **)(**(int **)(in_ECX + 0x4c) + 0x2c))(0);
  }
  if (*(int *)(in_ECX + 0x54) == 0) {
    local_68[0] = (float)FUN_006f0760(0x2100,".\\Flow\\AvaGameLobby.cpp",0x253,0);
    puStack_18 = (undefined1 *)0x1;
    if (local_68[0] == 0.0) {
      uVar4 = 0;
    }
    else {
      uVar4 = FUN_00874090(local_68[0],5);
    }
    puStack_18 = (undefined1 *)0xffffffff;
    *(undefined4 *)(in_ECX + 0x54) = uVar4;
  }
  FUN_00401ed0(in_ECX + 300,local_68,*(undefined4 *)(in_ECX + 0x130),*(undefined4 *)(in_ECX + 0x134)
              );
  if (((DAT_017251ac != 0) && (iVar5 = *(int *)(DAT_017251ac + 0x1a4), iVar5 != 0)) &&
     (*(int *)(iVar5 + 0xf8) != 0)) {
    *(undefined4 *)(*(int *)(iVar5 + 0xf8) + 0x28) = 0xbf800000;
  }
  local_68[0] = (float)FUN_006f0760(0x48,".\\Flow\\AvaGameLobby.cpp",0x268,0);
  puStack_18 = (undefined1 *)0x2;
  if (local_68[0] == 0.0) {
    uVar4 = 0;
  }
  else {
    uVar4 = FUN_00ac21a0(local_68[0]);
  }
  *(undefined4 *)(in_ECX + 0x338) = uVar4;
  ExceptionList = pvStack_20;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
00a554e0 : PUSH EBP
00a554e1 : MOV EBP,ESP
00a554e3 : AND ESP,0xfffffff0
00a554e6 : PUSH -0x1
00a554e8 : PUSH 0xb65c69
00a554ed : MOV EAX,FS:[0x0]
00a554f3 : PUSH EAX
00a554f4 : SUB ESP,0x58
00a554f7 : PUSH EBX
00a554f8 : PUSH ESI
00a554f9 : PUSH EDI
00a554fa : MOV EAX,[0x00d66fa0]
00a554ff : XOR EAX,ESP
00a55501 : PUSH EAX
00a55502 : LEA EAX,[ESP + 0x68]
00a55506 : MOV FS:[0x0],EAX
00a5550c : MOV EDI,ECX
00a5550e : XOR EBX,EBX
00a55510 : LEA EAX,[EDI + -0x4]
00a55513 : MOV byte ptr [EDI + 0x7d],BL
00a55516 : TEST EAX,EAX
00a55518 : JZ 0x00a5551f
00a5551a : LEA EAX,[EDI + 0x14]
00a5551d : JMP 0x00a55521
00a5551f : XOR EAX,EAX
00a55521 : MOV ECX,dword ptr [0x017247e4]
00a55527 : MOV dword ptr [ECX + 0x8],EAX
00a5552a : CALL dword ptr [0x00b85598]
00a55530 : MOVSS XMM0,dword ptr [0x00c10fc4]
00a55538 : PUSH 0x300
00a5553d : MOV dword ptr [EDI + 0xb8],EAX
00a55543 : MOV EAX,[0x017251ac]
00a55548 : PUSH 0x400
00a5554d : MOV dword ptr [EDI + 0xbc],EBX
00a55553 : PUSH 0x226
00a55558 : LEA ESI,[EDI + -0x4]
00a5555b : MOVSS dword ptr [ESP + 0x30],XMM0
00a55561 : MOVSS dword ptr [ESP + 0x34],XMM0
00a55567 : MOVSS dword ptr [ESP + 0x38],XMM0
00a5556d : MOVSS dword ptr [ESP + 0x3c],XMM0
00a55573 : MOVQ XMM0,qword ptr [ESP + 0x30]
00a55579 : MOV dword ptr [ESI + 0xc4],EBX
00a5557f : MOV dword ptr [ESI + 0xc8],0xa
00a55589 : MOVQ qword ptr [EAX + 0x2e4],XMM0
00a55591 : MOVQ XMM0,qword ptr [ESP + 0x38]
00a55597 : PUSH 0xa
00a55599 : LEA EDX,[ESP + 0x44]
00a5559d : PUSH EDX
00a5559e : MOVQ qword ptr [EAX + 0x2ec],XMM0
00a555a6 : CALL dword ptr [0x00b85430]
00a555ac : MOVDQA XMM0,xmmword ptr [ESP + 0x34]
00a555b2 : MOV EAX,[0x017251ac]
00a555b7 : MOVDQA xmmword ptr [ESP + 0x24],XMM0
00a555bd : MOVQ XMM0,qword ptr [ESP + 0x24]
00a555c3 : MOVQ qword ptr [EAX + 0x2f4],XMM0
00a555cb : MOVQ XMM0,qword ptr [ESP + 0x2c]
00a555d1 : MOVQ qword ptr [EAX + 0x2fc],XMM0
00a555d9 : PUSH 0xc
00a555db : XOR EAX,EAX
00a555dd : PUSH 0xcc5bc4
00a555e2 : LEA ECX,[ESP + 0x50]
00a555e6 : MOV dword ptr [ESP + 0x68],0x7
00a555ee : MOV dword ptr [ESP + 0x64],EBX
00a555f2 : MOV word ptr [ESP + 0x54],AX
00a555f7 : CALL 0x00406360
00a555fc : MOV dword ptr [ESP + 0x70],EBX
00a55600 : MOV ECX,dword ptr [0x0172491c]
00a55606 : MOV EDX,dword ptr [ECX + 0x90]
00a5560c : LEA ECX,[ESP + 0x48]
00a55610 : CALL 0x007f8ef0
00a55615 : MOV dword ptr [EDI + 0x2c],EAX
00a55618 : MOV dword ptr [ESP + 0x70],0xffffffff
00a55620 : CMP dword ptr [ESP + 0x60],0x8
00a55625 : JC 0x00a55630
00a55627 : MOV ECX,dword ptr [ESP + 0x4c]
00a5562b : CALL 0x006f04e0
00a55630 : MOV EAX,[0x0172491c]
00a55635 : XOR EDX,EDX
00a55637 : MOV word ptr [ESP + 0x4c],DX
00a5563c : MOV EDX,dword ptr [EDI + 0x2c]
00a5563f : MOV dword ptr [ESP + 0x60],0x7
00a55647 : MOV dword ptr [ESP + 0x5c],EBX
00a5564b : MOV ECX,dword ptr [EAX + 0x14]
00a5564e : MOV EAX,dword ptr [ECX]
00a55650 : MOV dword ptr [ESP + 0x1c],EDX
00a55654 : MOV EDX,dword ptr [EAX + 0xc]
00a55657 : PUSH EBX
00a55658 : CALL EDX
00a5565a : MOV ECX,dword ptr [ESP + 0x1c]
00a5565e : MOV dword ptr [EAX + 0x8],ECX
00a55661 : MOV EAX,[0x017251f8]
00a55666 : CMP EAX,EBX
00a55668 : JZ 0x00a55670
00a5566a : MOV dword ptr [EAX + 0xe8],ECX
00a55670 : MOV EAX,[0x017251ac]
00a55675 : MOV EAX,dword ptr [EAX + 0x178]
00a5567b : MOV ECX,dword ptr [EAX + 0x48]
00a5567e : FILD dword ptr [EAX + 0x48]
00a55681 : TEST ECX,ECX
00a55683 : JGE 0x00a5568b
00a55685 : FADD float ptr [0x00cdf0e0]
00a5568b : MOV EDX,dword ptr [EAX + 0x4c]
00a5568e : FSTP float ptr [ESP + 0x1c]
00a55692 : FILD dword ptr [EAX + 0x4c]
00a55695 : TEST EDX,EDX
00a55697 : JGE 0x00a5569f
00a55699 : FADD float ptr [0x00cdf0e0]
00a5569f : MOV EAX,dword ptr [EDI + 0x2c]
00a556a2 : FSTP float ptr [ESP + 0x20]
00a556a6 : MOVSS XMM0,dword ptr [ESP + 0x1c]
00a556ac : DIVSS XMM0,dword ptr [ESP + 0x20]
00a556b2 : MOVSS XMM1,dword ptr [0x00cdf31c]
00a556ba : MOVSS dword ptr [EAX + 0x50],XMM0
00a556bf : MOVSS XMM0,dword ptr [0x00c10fc4]
00a556c7 : MOVSS dword ptr [EAX + 0x54],XMM0
00a556cc : MOVSS XMM0,dword ptr [0x00cdf288]
00a556d4 : MOVSS dword ptr [EAX + 0x4c],XMM1
00a556d9 : MOVSS dword ptr [EAX + 0x58],XMM0
00a556de : MOVSS dword ptr [EAX + 0x5c],XMM0
00a556e3 : MOV byte ptr [EAX + 0x155],0x1
00a556ea : MOV EAX,[0x00da9894]
00a556ef : MOV ECX,dword ptr [EAX]
00a556f1 : CMP byte ptr [ECX + 0x34],BL
00a556f4 : JNZ 0x00a556fd
00a556f6 : MOV EDX,dword ptr [ECX]
00a556f8 : MOV EAX,dword ptr [EDX + 0x8]
00a556fb : CALL EAX
00a556fd : MOV ECX,dword ptr [0x017248f8]
00a55703 : ADD ECX,0x4
00a55706 : PUSH ECX
00a55707 : CALL 0x00a6a6b0
00a5570c : MOV EDX,dword ptr [0x0172491c]
00a55712 : MOV EAX,dword ptr [EDX + 0x90]
00a55718 : PUSH EBX
00a55719 : PUSH ESI
00a5571a : PUSH EAX
00a5571b : MOV ECX,0xcc5be0
00a55720 : CALL 0x007f91b0
00a55725 : MOV dword ptr [EDI + 0x4c],EAX
00a55728 : CMP EAX,EBX
00a5572a : JNZ 0x00a55741
00a5572c : MOV ESI,dword ptr [0x00da98e8]
00a55732 : PUSH 0xcc5bf0
00a55737 : CALL 0x008018d0
00a5573c : ADD ESP,0x4
00a5573f : JMP 0x00a55763
00a55741 : MOV EDX,dword ptr [EAX]
00a55743 : MOV ECX,EAX
00a55745 : MOV EAX,dword ptr [EDX + 0x14]
00a55748 : PUSH 0x2
00a5574a : CALL EAX
00a5574c : MOV ECX,dword ptr [EDI + 0x4c]
00a5574f : MOV EDX,dword ptr [ECX]
00a55751 : MOV EAX,dword ptr [EDX + 0xc]
00a55754 : PUSH 0x1
00a55756 : CALL EAX
00a55758 : MOV ECX,dword ptr [EDI + 0x4c]
00a5575b : MOV EDX,dword ptr [ECX]
00a5575d : MOV EAX,dword ptr [EDX + 0x2c]
00a55760 : PUSH EBX
00a55761 : CALL EAX
00a55763 : CMP dword ptr [EDI + 0x54],EBX
00a55766 : JNZ 0x00a557a7
00a55768 : PUSH EBX
00a55769 : PUSH 0x253
00a5576e : PUSH 0xcc5c54
00a55773 : PUSH 0x2100
00a55778 : CALL 0x006f0760
00a5577d : ADD ESP,0x10
00a55780 : MOV dword ptr [ESP + 0x20],EAX
00a55784 : MOV dword ptr [ESP + 0x70],0x1
00a5578c : CMP EAX,EBX
00a5578e : JZ 0x00a5579a
00a55790 : PUSH 0x5
00a55792 : PUSH EAX
00a55793 : CALL 0x00874090
00a55798 : JMP 0x00a5579c
00a5579a : XOR EAX,EAX
00a5579c : MOV dword ptr [ESP + 0x70],0xffffffff
00a557a4 : MOV dword ptr [EDI + 0x54],EAX
00a557a7 : MOV ECX,dword ptr [EDI + 0x134]
00a557ad : MOV EDX,dword ptr [EDI + 0x130]
00a557b3 : LEA EAX,[EDI + 0x12c]
00a557b9 : PUSH ECX
00a557ba : PUSH EDX
00a557bb : LEA ECX,[ESP + 0x28]
00a557bf : PUSH ECX
00a557c0 : PUSH EAX
00a557c1 : CALL 0x00401ed0
00a557c6 : MOV EAX,[0x017251ac]
00a557cb : CMP EAX,EBX
00a557cd : JZ 0x00a557f4
00a557cf : MOV EAX,dword ptr [EAX + 0x1a4]
00a557d5 : CMP EAX,EBX
00a557d7 : JZ 0x00a557f4
00a557d9 : CMP dword ptr [EAX + 0xf8],EBX
00a557df : JZ 0x00a557f4
00a557e1 : MOV EAX,dword ptr [EAX + 0xf8]
00a557e7 : MOVSS XMM0,dword ptr [0x00cdf0d0]
00a557ef : MOVSS dword ptr [EAX + 0x28],XMM0
00a557f4 : PUSH EBX
00a557f5 : PUSH 0x268
00a557fa : PUSH 0xcc5c84
00a557ff : PUSH 0x48
00a55801 : CALL 0x006f0760
00a55806 : ADD ESP,0x10
00a55809 : MOV dword ptr [ESP + 0x20],EAX
00a5580d : MOV dword ptr [ESP + 0x70],0x2
00a55815 : CMP EAX,EBX
00a55817 : JZ 0x00a55821
00a55819 : PUSH EAX
00a5581a : CALL 0x00ac21a0
00a5581f : JMP 0x00a55823
00a55821 : XOR EAX,EAX
00a55823 : MOV dword ptr [ESP + 0x70],0xffffffff
00a5582b : MOV dword ptr [EDI + 0x338],EAX
00a55831 : MOV AL,0x1
00a55833 : MOV ECX,dword ptr [ESP + 0x68]
00a55837 : MOV dword ptr FS:[0x0],ECX
00a5583e : POP ECX
00a5583f : POP EDI
00a55840 : POP ESI
00a55841 : POP EBX
00a55842 : MOV ESP,EBP
00a55844 : POP EBP
00a55845 : RET

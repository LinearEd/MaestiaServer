PROGRAM  : Maestia.exe
FUNCTION : FUN_00a506a0
ENTRY    : 00a506a0
BODY     : [[00a506a0, 00a508bc] [00a508c0, 00a5091c] [00a50920, 00a50a32]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a506a0(int param_1)

{
  char cVar1;
  uint uVar2;
  undefined4 uVar3;
  int iVar4;
  char *pcVar5;
  uint8_t *puVar6;
  byte bVar7;
  char *pcVar8;
  uint8_t *puVar9;
  undefined1 local_154 [4];
  undefined2 local_150;
  undefined4 local_140;
  uint local_13c;
  int local_138;
  char *local_134;
  undefined1 local_130 [4];
  int local_12c;
  int local_128;
  uint8_t *local_120;
  int local_11c;
  char local_118 [128];
  char local_98 [128];
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b42ce9;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_120 = (uint8_t *)(uint)*(ushort *)(param_1 + 0x15c);
  local_18 = uVar2;
  FUN_00413b60(&local_120);
  if ((local_11c != *(int *)(param_1 + 0x128)) &&
     (local_11c = *(int *)(local_11c + 0x10), local_11c != 0)) {
    FUN_00406460(&DAT_00cc6e38);
    local_8 = 0;
    FUN_0070cd60(local_130);
    local_8._0_1_ = 2;
    if (7 < local_13c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_150 = 0;
    local_13c = 7;
    local_140 = 0;
    if (2 < (uint)((local_128 - local_12c) / 0x1c)) {
      if (*(undefined4 **)(param_1 + 0x40) != (undefined4 *)0x0) {
        (**(code **)**(undefined4 **)(param_1 + 0x40))("CloseCharPassword",uVar2);
      }
      FUN_00a49030();
      *(undefined1 *)(param_1 + 500) = 0;
      cVar1 = FUN_00404010();
      if (cVar1 == '\0') {
        local_98[0] = '\0';
        _memset(local_98 + 1,0,0x7f);
        local_118[0] = '\0';
        _memset(local_118 + 1,0,0x7f);
        if (*(uint *)(local_12c + 0x18) < 8) {
          iVar4 = local_12c + 4;
        }
        else {
          iVar4 = *(int *)(local_12c + 4);
        }
        pcVar5 = (char *)FUN_0070cf00(iVar4);
        pcVar8 = local_98;
        do {
          cVar1 = *pcVar5;
          *pcVar8 = cVar1;
          pcVar5 = pcVar5 + 1;
          pcVar8 = pcVar8 + 1;
        } while (cVar1 != '\0');
        if (*(uint *)(local_12c + 0x34) < 8) {
          local_12c = local_12c + 0x20;
        }
        else {
          local_12c = *(int *)(local_12c + 0x20);
        }
        pcVar5 = (char *)FUN_0070cf00(local_12c);
        pcVar8 = local_118;
        do {
          cVar1 = *pcVar5;
          *pcVar8 = cVar1;
          pcVar5 = pcVar5 + 1;
          pcVar8 = pcVar8 + 1;
        } while (cVar1 != '\0');
        pcVar8 = local_98;
        do {
          cVar1 = *pcVar8;
          pcVar8 = pcVar8 + 1;
        } while (cVar1 != '\0');
        local_138 = (int)pcVar8 - (int)(local_98 + 1);
        local_134 = local_118;
        do {
          cVar1 = *local_134;
          local_134 = local_134 + 1;
        } while (cVar1 != '\0');
        local_134 = local_134 + (2 - (int)(local_118 + 1));
        FUN_006f00e0(local_98,&local_138,0x80);
        FUN_006f00e0(local_118,&local_134,0x80);
        iVar4 = *(int *)ThreadLocalStoragePointer;
        bVar7 = (byte)((ulonglong)(*(byte *)(iVar4 + 0x18) + 1) % 3);
        *(byte *)(iVar4 + 0x18) = bVar7;
        local_120 = (uint8_t *)((uint)bVar7 * 0x2000 + 0x122cb8 + iVar4);
        local_8 = CONCAT31(local_8._1_3_,5);
        if (local_120 == (uint8_t *)0x0) {
          puVar6 = (uint8_t *)0x0;
        }
        else {
          *(undefined4 *)(local_120 + 4) = *(undefined4 *)(local_11c + 4);
          pcVar8 = local_98;
          puVar6 = local_120 + 8;
          for (iVar4 = 0x20; iVar4 != 0; iVar4 = iVar4 + -1) {
            *(undefined4 *)puVar6 = *(undefined4 *)pcVar8;
            pcVar8 = pcVar8 + 4;
            puVar6 = puVar6 + 4;
          }
          local_120[0] = '\0';
          local_120[1] = '\0';
          local_120[2] = '3';
          local_120[3] = ',';
          pcVar8 = local_118;
          puVar9 = local_120 + 0x88;
          for (iVar4 = 0x20; puVar6 = local_120, iVar4 != 0; iVar4 = iVar4 + -1) {
            *(undefined4 *)puVar9 = *(undefined4 *)pcVar8;
            pcVar8 = pcVar8 + 4;
            puVar9 = puVar9 + 4;
          }
        }
        local_8 = CONCAT31(local_8._1_3_,2);
        if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
          FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),0x108,puVar6);
        }
      }
      else {
        FUN_00406460(L"IDS_LOBBY_CHAR_PASSWORD_DIFFERENT");
        local_8._0_1_ = 3;
        uVar3 = FUN_0081d120(local_154);
        local_8._0_1_ = 4;
        iVar4 = FUN_008ede80(uVar3,0);
        local_8._0_1_ = 3;
        FUN_00406560();
        local_8 = CONCAT31(local_8._1_3_,2);
        FUN_00406560();
        if (iVar4 != 0) {
          if (*(code **)(iVar4 + 0x60) != (code *)0x0) {
            (**(code **)(iVar4 + 0x60))(1,iVar4);
          }
          *(undefined1 **)(iVar4 + 0x60) = &LAB_00a49980;
          FUN_00a49030();
        }
      }
    }
    local_8 = 0xffffffff;
    FUN_004042c0();
  }
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a506a0 : PUSH EBP
00a506a1 : MOV EBP,ESP
00a506a3 : PUSH -0x1
00a506a5 : PUSH 0xb42ce9
00a506aa : MOV EAX,FS:[0x0]
00a506b0 : PUSH EAX
00a506b1 : SUB ESP,0x160
00a506b7 : MOV EAX,[0x00d66fa0]
00a506bc : XOR EAX,EBP
00a506be : MOV dword ptr [EBP + -0x14],EAX
00a506c1 : PUSH EBX
00a506c2 : PUSH ESI
00a506c3 : PUSH EDI
00a506c4 : PUSH EAX
00a506c5 : LEA EAX,[EBP + -0xc]
00a506c8 : MOV FS:[0x0],EAX
00a506ce : MOV EBX,dword ptr [EBP + 0x8]
00a506d1 : MOVZX EAX,word ptr [EBX + 0x15c]
00a506d8 : MOV ESI,ECX
00a506da : LEA ECX,[EBP + 0xfffffee4]
00a506e0 : MOV dword ptr [EBP + 0xfffffee4],EAX
00a506e6 : PUSH ECX
00a506e7 : LEA ECX,[EBX + 0x124]
00a506ed : LEA EAX,[EBP + 0xfffffee8]
00a506f3 : CALL 0x00413b60
00a506f8 : MOV EAX,dword ptr [EBX + 0x128]
00a506fe : MOV ECX,dword ptr [EBP + 0xfffffee8]
00a50704 : CMP ECX,EAX
00a50706 : JZ 0x00a50a15
00a5070c : MOV ECX,dword ptr [ECX + 0x10]
00a5070f : XOR EDI,EDI
00a50711 : MOV dword ptr [EBP + 0xfffffee8],ECX
00a50717 : CMP ECX,EDI
00a50719 : JZ 0x00a50a15
00a5071f : PUSH 0xcc6e38
00a50724 : LEA ECX,[EBP + 0xfffffeb0]
00a5072a : CALL 0x00406460
00a5072f : MOV dword ptr [EBP + -0x4],EDI
00a50732 : PUSH EDI
00a50733 : LEA EDX,[EBP + 0xfffffeb0]
00a50739 : PUSH EDX
00a5073a : LEA EAX,[EBP + 0xfffffed4]
00a50740 : PUSH ESI
00a50741 : PUSH EAX
00a50742 : CALL 0x0070cd60
00a50747 : ADD ESP,0x10
00a5074a : MOV byte ptr [EBP + -0x4],0x2
00a5074e : MOV ESI,0x8
00a50753 : CMP dword ptr [EBP + 0xfffffec8],ESI
00a50759 : JC 0x00a50766
00a5075b : MOV ECX,dword ptr [EBP + 0xfffffeb4]
00a50761 : CALL 0x006f04e0
00a50766 : XOR ECX,ECX
00a50768 : MOV word ptr [EBP + 0xfffffeb4],CX
00a5076f : MOV ECX,dword ptr [EBP + 0xfffffedc]
00a50775 : SUB ECX,dword ptr [EBP + 0xfffffed8]
00a5077b : MOV EAX,0x92492493
00a50780 : IMUL ECX
00a50782 : ADD EDX,ECX
00a50784 : SAR EDX,0x4
00a50787 : MOV EAX,EDX
00a50789 : SHR EAX,0x1f
00a5078c : ADD EAX,EDX
00a5078e : MOV dword ptr [EBP + 0xfffffec8],0x7
00a50798 : MOV dword ptr [EBP + 0xfffffec4],EDI
00a5079e : CMP EAX,0x3
00a507a1 : JC 0x00a50a03
00a507a7 : MOV ECX,dword ptr [EBX + 0x40]
00a507aa : CMP ECX,EDI
00a507ac : JZ 0x00a507b9
00a507ae : MOV EDX,dword ptr [ECX]
00a507b0 : MOV EAX,dword ptr [EDX]
00a507b2 : PUSH 0xcc6da0
00a507b7 : CALL EAX
00a507b9 : MOV DL,0x1
00a507bb : MOV EAX,EBX
00a507bd : CALL 0x00a49030
00a507c2 : MOV ECX,dword ptr [EBP + 0xfffffed8]
00a507c8 : LEA EAX,[ECX + 0x38]
00a507cb : ADD ECX,0x1c
00a507ce : MOV byte ptr [EBX + 0x1f4],0x0
00a507d5 : CALL 0x00404010
00a507da : TEST AL,AL
00a507dc : JZ 0x00a50867
00a507e2 : PUSH 0xcc6e40
00a507e7 : LEA ECX,[EBP + 0xfffffeb0]
00a507ed : CALL 0x00406460
00a507f2 : MOV byte ptr [EBP + -0x4],0x3
00a507f6 : LEA ECX,[EBP + 0xfffffeb0]
00a507fc : PUSH ECX
00a507fd : MOV ECX,dword ptr [0x0172491c]
00a50803 : LEA EDI,[EBP + 0xfffffe94]
00a50809 : CALL 0x0081d120
00a5080e : MOV byte ptr [EBP + -0x4],0x4
00a50812 : MOV EDX,dword ptr [0x00da9894]
00a50818 : MOV ECX,dword ptr [EDX]
00a5081a : PUSH 0x0
00a5081c : PUSH EAX
00a5081d : CALL 0x008ede80
00a50822 : MOV ESI,EAX
00a50824 : MOV byte ptr [EBP + -0x4],0x3
00a50828 : MOV ECX,EDI
00a5082a : CALL 0x00406560
00a5082f : MOV byte ptr [EBP + -0x4],0x2
00a50833 : LEA ECX,[EBP + 0xfffffeb0]
00a50839 : CALL 0x00406560
00a5083e : TEST ESI,ESI
00a50840 : JZ 0x00a50a03
00a50846 : MOV EAX,dword ptr [ESI + 0x60]
00a50849 : TEST EAX,EAX
00a5084b : JZ 0x00a50852
00a5084d : PUSH ESI
00a5084e : PUSH 0x1
00a50850 : CALL EAX
00a50852 : XOR DL,DL
00a50854 : MOV EAX,EBX
00a50856 : MOV dword ptr [ESI + 0x60],0xa49980
00a5085d : CALL 0x00a49030
00a50862 : JMP 0x00a50a03
00a50867 : PUSH 0x7f
00a50869 : LEA EAX,[EBP + 0xffffff6d]
00a5086f : PUSH EDI
00a50870 : PUSH EAX
00a50871 : MOV byte ptr [EBP + 0xffffff6c],0x0
00a50878 : CALL 0x0063b700
00a5087d : ADD ESP,0xc
00a50880 : PUSH 0x7f
00a50882 : LEA ECX,[EBP + 0xfffffeed]
00a50888 : PUSH EDI
00a50889 : PUSH ECX
00a5088a : MOV byte ptr [EBP + 0xfffffeec],0x0
00a50891 : CALL 0x0063b700
00a50896 : MOV EAX,dword ptr [EBP + 0xfffffed8]
00a5089c : ADD ESP,0xc
00a5089f : CMP dword ptr [EAX + 0x18],ESI
00a508a2 : JC 0x00a508a9
00a508a4 : MOV EAX,dword ptr [EAX + 0x4]
00a508a7 : JMP 0x00a508ac
00a508a9 : ADD EAX,0x4
00a508ac : PUSH EAX
00a508ad : CALL 0x0070cf00
00a508b2 : ADD ESP,0x4
00a508b5 : LEA EDX,[EBP + 0xffffff6c]
00a508bb : JMP 0x00a508c0
00a508c0 : MOV CL,byte ptr [EAX]
00a508c2 : MOV byte ptr [EDX],CL
00a508c4 : INC EAX
00a508c5 : INC EDX
00a508c6 : TEST CL,CL
00a508c8 : JNZ 0x00a508c0
00a508ca : MOV EAX,dword ptr [EBP + 0xfffffed8]
00a508d0 : CMP dword ptr [EAX + 0x34],ESI
00a508d3 : JC 0x00a508da
00a508d5 : MOV EAX,dword ptr [EAX + 0x20]
00a508d8 : JMP 0x00a508dd
00a508da : ADD EAX,0x20
00a508dd : PUSH EAX
00a508de : CALL 0x0070cf00
00a508e3 : ADD ESP,0x4
00a508e6 : LEA EDX,[EBP + 0xfffffeec]
00a508ec : LEA ESP,[ESP]
00a508f0 : MOV CL,byte ptr [EAX]
00a508f2 : MOV byte ptr [EDX],CL
00a508f4 : INC EAX
00a508f5 : INC EDX
00a508f6 : TEST CL,CL
00a508f8 : JNZ 0x00a508f0
00a508fa : LEA EAX,[EBP + 0xffffff6c]
00a50900 : LEA EDX,[EAX + 0x1]
00a50903 : MOV CL,byte ptr [EAX]
00a50905 : INC EAX
00a50906 : TEST CL,CL
00a50908 : JNZ 0x00a50903
00a5090a : SUB EAX,EDX
00a5090c : MOV dword ptr [EBP + 0xfffffecc],EAX
00a50912 : LEA EAX,[EBP + 0xfffffeec]
00a50918 : LEA ESI,[EAX + 0x1]
00a5091b : JMP 0x00a50920
00a50920 : MOV CL,byte ptr [EAX]
00a50922 : INC EAX
00a50923 : TEST CL,CL
00a50925 : JNZ 0x00a50920
00a50927 : SUB EAX,ESI
00a50929 : ADD EAX,0x2
00a5092c : PUSH 0x80
00a50931 : LEA EDX,[EBP + 0xfffffecc]
00a50937 : MOV dword ptr [EBP + 0xfffffed0],EAX
00a5093d : PUSH EDX
00a5093e : LEA EAX,[EBP + 0xffffff6c]
00a50944 : LEA ESI,[EBX + 0x2dc]
00a5094a : PUSH EAX
00a5094b : MOV ECX,ESI
00a5094d : CALL 0x006f00e0
00a50952 : PUSH 0x80
00a50957 : LEA ECX,[EBP + 0xfffffed0]
00a5095d : PUSH ECX
00a5095e : LEA EDX,[EBP + 0xfffffeec]
00a50964 : PUSH EDX
00a50965 : MOV ECX,ESI
00a50967 : CALL 0x006f00e0
00a5096c : MOV EAX,FS:[0x2c]
00a50972 : MOV ECX,dword ptr [EAX]
00a50974 : MOVZX EAX,byte ptr [ECX + 0x18]
00a50978 : INC EAX
00a50979 : CDQ
00a5097a : MOV ESI,0x3
00a5097f : IDIV ESI
00a50981 : MOV byte ptr [ECX + 0x18],DL
00a50984 : MOVZX EDX,DL
00a50987 : SHL EDX,0xd
00a5098a : LEA EAX,[EDX + ECX*0x1 + 0x122cb8]
00a50991 : MOV dword ptr [EBP + 0xfffffee4],EAX
00a50997 : MOV byte ptr [EBP + -0x4],0x5
00a5099b : TEST EAX,EAX
00a5099d : JZ 0x00a509dd
00a5099f : MOV ECX,dword ptr [EBP + 0xfffffee8]
00a509a5 : MOV ECX,dword ptr [ECX + 0x4]
00a509a8 : MOV dword ptr [EAX + 0x4],ECX
00a509ab : LEA EDI,[EAX + 0x8]
00a509ae : MOV ECX,0x20
00a509b3 : LEA ESI,[EBP + 0xffffff6c]
00a509b9 : MOVSD.REP ES:EDI,ESI
00a509bb : XOR EDX,EDX
00a509bd : LEA EDI,[EAX + 0x88]
00a509c3 : MOV ECX,0x20
00a509c8 : LEA ESI,[EBP + 0xfffffeec]
00a509ce : MOV word ptr [EAX],DX
00a509d1 : MOV byte ptr [EAX + 0x2],0x33
00a509d5 : MOV byte ptr [EAX + 0x3],0x2c
00a509d9 : MOVSD.REP ES:EDI,ESI
00a509db : JMP 0x00a509df
00a509dd : XOR EAX,EAX
00a509df : MOV byte ptr [EBP + -0x4],0x2
00a509e3 : MOV EDX,dword ptr [0x017247d4]
00a509e9 : MOV ECX,dword ptr [EDX + 0x4]
00a509ec : TEST ECX,ECX
00a509ee : JZ 0x00a50a03
00a509f0 : CMP byte ptr [EDX + 0x8],0x0
00a509f4 : JZ 0x00a50a03
00a509f6 : PUSH 0x108
00a509fb : PUSH ECX
00a509fc : MOV EDI,EAX
00a509fe : CALL 0x00a0dd40
00a50a03 : MOV dword ptr [EBP + -0x4],0xffffffff
00a50a0a : LEA ESI,[EBP + 0xfffffed4]
00a50a10 : CALL 0x004042c0
00a50a15 : MOV ECX,dword ptr [EBP + -0xc]
00a50a18 : MOV dword ptr FS:[0x0],ECX
00a50a1f : POP ECX
00a50a20 : POP EDI
00a50a21 : POP ESI
00a50a22 : POP EBX
00a50a23 : MOV ECX,dword ptr [EBP + -0x14]
00a50a26 : XOR ECX,EBP
00a50a28 : CALL 0x00633e6b
00a50a2d : MOV ESP,EBP
00a50a2f : POP EBP
00a50a30 : RET 0x4

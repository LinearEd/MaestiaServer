PROGRAM  : Maestia.exe
FUNCTION : FUN_009ee120
ENTRY    : 009ee120
BODY     : [[009ee120, 009ee27d] [009ee280, 009ee3eb]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009ee120(undefined4 param_1)

{
  uint uVar1;
  int iVar2;
  int *piVar3;
  undefined4 uVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  int in_ECX;
  char *in_EDX;
  undefined1 auStack_7c [8];
  undefined4 *local_74;
  undefined4 *local_70;
  undefined4 local_6c;
  undefined4 local_68;
  char *local_64;
  int iStack_60;
  undefined4 uStack_5c;
  int local_58;
  undefined2 uStack_50;
  undefined4 uStack_40;
  uint uStack_3c;
  undefined1 auStack_38 [4];
  undefined2 uStack_34;
  undefined4 uStack_24;
  uint uStack_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  uint local_c;
  
  puStack_10 = &LAB_00b5cb23;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_7c;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xffffff78;
  ExceptionList = &local_14;
  local_68 = param_1;
  *in_EDX = '\0';
  local_74 = (undefined4 *)0x0;
  local_70 = (undefined4 *)0x0;
  local_6c = 0;
  local_c = 0;
  local_64 = in_EDX;
  FUN_00413630(uVar1);
  if (*(char *)(in_ECX + 4) == -0x74) {
    local_58 = in_ECX + 0xf4;
    iStack_60 = (**(code **)(*(int *)(in_ECX + 0xf4) + 4))();
    while (iStack_60 != 0) {
      iVar2 = FUN_004f5680();
      if (iVar2 != 0) {
        FUN_00824a20(DAT_0172491c,0);
        puVar6 = local_70;
        local_c = CONCAT31(local_c._1_3_,1);
        piVar3 = (int *)FUN_00413740(&uStack_5c,local_74,local_70,auStack_38);
        if (puVar6 == (undefined4 *)*piVar3) {
          if (*(short *)(iVar2 + 6) == *(short *)(*(int *)(DAT_0172491c + 0x17c) + 0x7c)) {
            *local_64 = '\x01';
          }
          FUN_00405ae0(auStack_38);
        }
        local_c = local_c & 0xffffff00;
        if (7 < uStack_20) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        uStack_20 = 7;
        uStack_24 = 0;
        uStack_34 = 0;
      }
    }
  }
  else {
    *in_EDX = '\x01';
  }
  if (local_74 != local_70) {
    puVar6 = local_74 + 1;
    do {
      if (puVar6 + -1 != local_74) {
        FUN_00404870(&DAT_00ca0c84,2);
      }
      if (*local_64 == '\0') {
        puVar5 = puVar6;
        if (7 < (uint)puVar6[5]) {
          puVar5 = (undefined4 *)*puVar6;
        }
        uVar4 = FUN_00404750(L"@R%s",puVar5);
        local_c._0_1_ = 2;
        FUN_00405c30(uVar4,0,0xffffffff);
        local_c = (uint)local_c._1_3_ << 8;
        if (7 < uStack_20) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        uStack_20 = 7;
        uStack_24 = 0;
        uStack_34 = 0;
      }
      else {
        puVar5 = puVar6;
        if (7 < (uint)puVar6[5]) {
          puVar5 = (undefined4 *)*puVar6;
        }
        uVar4 = FUN_00404750(L"@N%s",puVar5);
        local_c._0_1_ = 3;
        FUN_00405c30(uVar4,0,0xffffffff);
        local_c = (uint)local_c._1_3_ << 8;
        if (7 < uStack_3c) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        uStack_3c = 7;
        uStack_40 = 0;
        uStack_50 = 0;
      }
      puVar5 = puVar6 + 6;
      puVar6 = puVar6 + 7;
    } while (puVar5 != local_70);
    puVar6 = (undefined4 *)FUN_00404250(local_70);
    FUN_00405450(uStack_5c);
    local_70 = puVar6;
  }
  local_c = 0xffffffff;
  if (local_74 == (undefined4 *)0x0) {
    local_74 = (undefined4 *)0x0;
    local_70 = (undefined4 *)0x0;
    local_6c = 0;
    ExceptionList = local_14;
    __security_check_cookie(local_1c ^ (uint)auStack_7c);
    return;
  }
  FUN_00405450(uStack_5c);
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
009ee120 : PUSH EBP
009ee121 : MOV EBP,ESP
009ee123 : AND ESP,0xfffffff8
009ee126 : PUSH -0x1
009ee128 : PUSH 0xb5cb23
009ee12d : MOV EAX,FS:[0x0]
009ee133 : PUSH EAX
009ee134 : SUB ESP,0x68
009ee137 : MOV EAX,[0x00d66fa0]
009ee13c : XOR EAX,ESP
009ee13e : MOV dword ptr [ESP + 0x60],EAX
009ee142 : PUSH EBX
009ee143 : PUSH ESI
009ee144 : PUSH EDI
009ee145 : MOV EAX,[0x00d66fa0]
009ee14a : XOR EAX,ESP
009ee14c : PUSH EAX
009ee14d : LEA EAX,[ESP + 0x78]
009ee151 : MOV FS:[0x0],EAX
009ee157 : MOV EAX,dword ptr [EBP + 0x8]
009ee15a : XOR EBX,EBX
009ee15c : MOV EDI,EDX
009ee15e : MOV ESI,ECX
009ee160 : MOV dword ptr [ESP + 0x24],EAX
009ee164 : MOV dword ptr [ESP + 0x28],EDI
009ee168 : MOV byte ptr [EDI],BL
009ee16a : MOV dword ptr [ESP + 0x18],EBX
009ee16e : MOV dword ptr [ESP + 0x1c],EBX
009ee172 : MOV dword ptr [ESP + 0x20],EBX
009ee176 : MOV dword ptr [ESP + 0x80],EBX
009ee17d : LEA ECX,[ESP + 0x14]
009ee181 : CALL 0x00413630
009ee186 : MOV AL,byte ptr [ESI + 0x4]
009ee189 : CMP AL,0x8c
009ee18b : JNZ 0x009ee268
009ee191 : MOV EDX,dword ptr [ESI + 0xf4]
009ee197 : MOV EAX,dword ptr [EDX + 0x4]
009ee19a : ADD ESI,0xf4
009ee1a0 : MOV ECX,ESI
009ee1a2 : MOV dword ptr [ESP + 0x34],ESI
009ee1a6 : CALL EAX
009ee1a8 : MOV dword ptr [ESP + 0x2c],EAX
009ee1ac : CMP EAX,EBX
009ee1ae : JZ 0x009ee26b
009ee1b4 : LEA EDX,[ESP + 0x2c]
009ee1b8 : MOV EAX,ESI
009ee1ba : CALL 0x004f5680
009ee1bf : MOV EDI,EAX
009ee1c1 : CMP EDI,EBX
009ee1c3 : JZ 0x009ee25c
009ee1c9 : MOV ECX,dword ptr [0x0172491c]
009ee1cf : PUSH EBX
009ee1d0 : LEA EDX,[EDI + 0x18]
009ee1d3 : PUSH ECX
009ee1d4 : LEA ESI,[ESP + 0x5c]
009ee1d8 : CALL 0x00824a20
009ee1dd : MOV byte ptr [ESP + 0x80],0x1
009ee1e5 : MOV EAX,dword ptr [ESP + 0x18]
009ee1e9 : MOV EDX,ESI
009ee1eb : MOV ESI,dword ptr [ESP + 0x1c]
009ee1ef : PUSH EDX
009ee1f0 : PUSH ESI
009ee1f1 : PUSH EAX
009ee1f2 : LEA ECX,[ESP + 0x3c]
009ee1f6 : PUSH ECX
009ee1f7 : CALL 0x00413740
009ee1fc : ADD ESP,0x10
009ee1ff : CMP ESI,dword ptr [EAX]
009ee201 : JNZ 0x009ee22e
009ee203 : MOV EDX,dword ptr [0x0172491c]
009ee209 : MOV EAX,dword ptr [EDX + 0x17c]
009ee20f : MOVZX EAX,word ptr [EAX + 0x7c]
009ee213 : CMP word ptr [EDI + 0x6],AX
009ee217 : JNZ 0x009ee220
009ee219 : MOV EAX,dword ptr [ESP + 0x28]
009ee21d : MOV byte ptr [EAX],0x1
009ee220 : LEA ECX,[ESP + 0x54]
009ee224 : PUSH ECX
009ee225 : LEA EAX,[ESP + 0x18]
009ee229 : CALL 0x00405ae0
009ee22e : MOV byte ptr [ESP + 0x80],BL
009ee235 : CMP dword ptr [ESP + 0x6c],0x8
009ee23a : JC 0x009ee245
009ee23c : MOV ECX,dword ptr [ESP + 0x58]
009ee240 : CALL 0x006f04e0
009ee245 : MOV ESI,dword ptr [ESP + 0x34]
009ee249 : XOR EDX,EDX
009ee24b : MOV dword ptr [ESP + 0x6c],0x7
009ee253 : MOV dword ptr [ESP + 0x68],EBX
009ee257 : MOV word ptr [ESP + 0x58],DX
009ee25c : CMP dword ptr [ESP + 0x2c],EBX
009ee260 : JNZ 0x009ee1b4
009ee266 : JMP 0x009ee26b
009ee268 : MOV byte ptr [EDI],0x1
009ee26b : MOV ESI,dword ptr [ESP + 0x18]
009ee26f : CMP ESI,dword ptr [ESP + 0x1c]
009ee273 : JZ 0x009ee399
009ee279 : LEA EDI,[ESI + 0x4]
009ee27c : JMP 0x009ee284
009ee280 : MOV ESI,dword ptr [ESP + 0x18]
009ee284 : LEA EAX,[EDI + -0x4]
009ee287 : CMP EAX,ESI
009ee289 : JZ 0x009ee29b
009ee28b : MOV ESI,dword ptr [ESP + 0x24]
009ee28f : PUSH 0x2
009ee291 : PUSH 0xca0c84
009ee296 : CALL 0x00404870
009ee29b : MOV ECX,dword ptr [ESP + 0x28]
009ee29f : CMP byte ptr [ECX],BL
009ee2a1 : JNZ 0x009ee302
009ee2a3 : CMP dword ptr [EDI + 0x14],0x8
009ee2a7 : JC 0x009ee2ad
009ee2a9 : MOV EAX,dword ptr [EDI]
009ee2ab : JMP 0x009ee2af
009ee2ad : MOV EAX,EDI
009ee2af : PUSH EAX
009ee2b0 : PUSH 0xca0c8c
009ee2b5 : LEA ESI,[ESP + 0x5c]
009ee2b9 : CALL 0x00404750
009ee2be : ADD ESP,0x8
009ee2c1 : MOV byte ptr [ESP + 0x80],0x2
009ee2c9 : MOV ECX,dword ptr [ESP + 0x24]
009ee2cd : PUSH -0x1
009ee2cf : PUSH EBX
009ee2d0 : PUSH EAX
009ee2d1 : CALL 0x00405c30
009ee2d6 : MOV byte ptr [ESP + 0x80],BL
009ee2dd : CMP dword ptr [ESP + 0x6c],0x8
009ee2e2 : JC 0x009ee2ed
009ee2e4 : MOV ECX,dword ptr [ESP + 0x58]
009ee2e8 : CALL 0x006f04e0
009ee2ed : XOR EDX,EDX
009ee2ef : MOV dword ptr [ESP + 0x6c],0x7
009ee2f7 : MOV dword ptr [ESP + 0x68],EBX
009ee2fb : MOV word ptr [ESP + 0x58],DX
009ee300 : JMP 0x009ee35f
009ee302 : CMP dword ptr [EDI + 0x14],0x8
009ee306 : JC 0x009ee30c
009ee308 : MOV EAX,dword ptr [EDI]
009ee30a : JMP 0x009ee30e
009ee30c : MOV EAX,EDI
009ee30e : PUSH EAX
009ee30f : PUSH 0xca0c98
009ee314 : LEA ESI,[ESP + 0x40]
009ee318 : CALL 0x00404750
009ee31d : ADD ESP,0x8
009ee320 : MOV byte ptr [ESP + 0x80],0x3
009ee328 : MOV ECX,dword ptr [ESP + 0x24]
009ee32c : PUSH -0x1
009ee32e : PUSH EBX
009ee32f : PUSH EAX
009ee330 : CALL 0x00405c30
009ee335 : MOV byte ptr [ESP + 0x80],BL
009ee33c : CMP dword ptr [ESP + 0x50],0x8
009ee341 : JC 0x009ee34c
009ee343 : MOV ECX,dword ptr [ESP + 0x3c]
009ee347 : CALL 0x006f04e0
009ee34c : XOR EAX,EAX
009ee34e : MOV dword ptr [ESP + 0x50],0x7
009ee356 : MOV dword ptr [ESP + 0x4c],EBX
009ee35a : MOV word ptr [ESP + 0x3c],AX
009ee35f : ADD EDI,0x1c
009ee362 : LEA ECX,[EDI + -0x4]
009ee365 : CMP ECX,dword ptr [ESP + 0x1c]
009ee369 : JNZ 0x009ee280
009ee36f : MOV EDI,dword ptr [ESP + 0x1c]
009ee373 : MOV ECX,dword ptr [ESP + 0x18]
009ee377 : PUSH EDI
009ee378 : MOV EAX,EDI
009ee37a : CALL 0x00404250
009ee37f : MOV EDX,dword ptr [ESP + 0x34]
009ee383 : ADD ESP,0x4
009ee386 : PUSH EDX
009ee387 : MOV ESI,EAX
009ee389 : CALL 0x00405450
009ee38e : MOV dword ptr [ESP + 0x20],ESI
009ee392 : MOV ESI,dword ptr [ESP + 0x1c]
009ee396 : ADD ESP,0x4
009ee399 : MOV dword ptr [ESP + 0x80],0xffffffff
009ee3a4 : CMP ESI,EBX
009ee3a6 : JZ 0x009ee3c2
009ee3a8 : MOV EAX,dword ptr [ESP + 0x30]
009ee3ac : MOV EDI,dword ptr [ESP + 0x1c]
009ee3b0 : PUSH EAX
009ee3b1 : MOV EAX,ESI
009ee3b3 : CALL 0x00405450
009ee3b8 : ADD ESP,0x4
009ee3bb : MOV ECX,ESI
009ee3bd : CALL 0x006f04e0
009ee3c2 : MOV dword ptr [ESP + 0x18],EBX
009ee3c6 : MOV dword ptr [ESP + 0x1c],EBX
009ee3ca : MOV dword ptr [ESP + 0x20],EBX
009ee3ce : MOV ECX,dword ptr [ESP + 0x78]
009ee3d2 : MOV dword ptr FS:[0x0],ECX
009ee3d9 : POP ECX
009ee3da : POP EDI
009ee3db : POP ESI
009ee3dc : POP EBX
009ee3dd : MOV ECX,dword ptr [ESP + 0x60]
009ee3e1 : XOR ECX,ESP
009ee3e3 : CALL 0x00633e6b
009ee3e8 : MOV ESP,EBP
009ee3ea : POP EBP
009ee3eb : RET

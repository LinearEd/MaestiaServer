PROGRAM  : Maestia.exe
FUNCTION : FUN_0041bb30
ENTRY    : 0041bb30
BODY     : [[0041bb30, 0041bd8a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0041bb30(int *param_1)

{
  uint uVar1;
  undefined1 *puVar2;
  undefined4 *puVar3;
  undefined2 *puVar4;
  short *psVar5;
  int iVar6;
  wchar_t *_Source;
  int iVar7;
  int *piVar8;
  uint *unaff_ESI;
  undefined4 *unaff_EDI;
  __time64_t _Var9;
  
  puVar3 = (undefined4 *)*param_1;
  if ((puVar3 == (undefined4 *)0x0) || (*unaff_ESI < 8)) {
    *unaff_ESI = 0;
    puVar3 = (undefined4 *)0x0;
  }
  else {
    *unaff_EDI = *puVar3;
    unaff_EDI[1] = puVar3[1];
    *unaff_ESI = *unaff_ESI - 8;
    puVar3 = puVar3 + 2;
  }
  *param_1 = (int)puVar3;
  if ((puVar3 == (undefined4 *)0x0) || (*unaff_ESI < 8)) {
    *unaff_ESI = 0;
    puVar3 = (undefined4 *)0x0;
  }
  else {
    unaff_EDI[0x24] = *puVar3;
    unaff_EDI[0x25] = puVar3[1];
    *unaff_ESI = *unaff_ESI - 8;
    puVar3 = puVar3 + 2;
  }
  *param_1 = (int)puVar3;
  if ((puVar3 == (undefined4 *)0x0) || (*unaff_ESI < 8)) {
    *unaff_ESI = 0;
    puVar3 = (undefined4 *)0x0;
  }
  else {
    unaff_EDI[2] = *puVar3;
    unaff_EDI[3] = puVar3[1];
    *unaff_ESI = *unaff_ESI - 8;
    puVar3 = puVar3 + 2;
  }
  *param_1 = (int)puVar3;
  if ((puVar3 == (undefined4 *)0x0) || (*unaff_ESI < 4)) {
    *unaff_ESI = 0;
    psVar5 = (short *)0x0;
  }
  else {
    unaff_EDI[4] = *puVar3;
    *unaff_ESI = *unaff_ESI - 4;
    psVar5 = (short *)(puVar3 + 1);
  }
  *param_1 = (int)psVar5;
  if ((((psVar5 == (short *)0x0) || (uVar1 = *unaff_ESI, uVar1 < 2)) || (*psVar5 < 0)) ||
     (iVar7 = (int)*psVar5, (int)uVar1 < iVar7 + 2)) {
    _Source = (wchar_t *)0x0;
    iVar6 = 0;
    *unaff_ESI = 0;
  }
  else {
    _Source = psVar5 + 1;
    iVar6 = iVar7 + 2 + (int)psVar5;
    *unaff_ESI = (uVar1 - iVar7) - 2;
  }
  *param_1 = iVar6;
  if (_Source != (wchar_t *)0x0) {
    _wcsncpy((wchar_t *)(unaff_EDI + 0xf),_Source,0x27);
    *(undefined2 *)((int)unaff_EDI + 0x8a) = 0;
  }
  puVar3 = (undefined4 *)*param_1;
  if ((puVar3 == (undefined4 *)0x0) || (*unaff_ESI < 4)) {
    *unaff_ESI = 0;
    puVar3 = (undefined4 *)0x0;
    piVar8 = param_1;
  }
  else {
    piVar8 = (int *)*puVar3;
    *unaff_ESI = *unaff_ESI - 4;
    puVar3 = puVar3 + 1;
  }
  *param_1 = (int)puVar3;
  _Var9 = __time64((__time64_t *)0x0);
  *(__time64_t *)(unaff_EDI + 6) = _Var9 + (int)piVar8;
  puVar2 = (undefined1 *)*param_1;
  if ((puVar2 == (undefined1 *)0x0) || (*unaff_ESI == 0)) {
    *unaff_ESI = 0;
    puVar3 = (undefined4 *)0x0;
  }
  else {
    *(undefined1 *)(unaff_EDI + 8) = *puVar2;
    *unaff_ESI = *unaff_ESI - 1;
    puVar3 = (undefined4 *)(puVar2 + 1);
  }
  *param_1 = (int)puVar3;
  if ((puVar3 == (undefined4 *)0x0) || (*unaff_ESI < 4)) {
    *unaff_ESI = 0;
    puVar3 = (undefined4 *)0x0;
  }
  else {
    unaff_EDI[9] = *puVar3;
    *unaff_ESI = *unaff_ESI - 4;
    puVar3 = puVar3 + 1;
  }
  *param_1 = (int)puVar3;
  if ((puVar3 == (undefined4 *)0x0) || (*unaff_ESI < 4)) {
    *unaff_ESI = 0;
    puVar3 = (undefined4 *)0x0;
  }
  else {
    unaff_EDI[10] = *puVar3;
    *unaff_ESI = *unaff_ESI - 4;
    puVar3 = puVar3 + 1;
  }
  *param_1 = (int)puVar3;
  if ((puVar3 == (undefined4 *)0x0) || (*unaff_ESI < 4)) {
    *unaff_ESI = 0;
    puVar3 = (undefined4 *)0x0;
  }
  else {
    unaff_EDI[0xb] = *puVar3;
    *unaff_ESI = *unaff_ESI - 4;
    puVar3 = puVar3 + 1;
  }
  *param_1 = (int)puVar3;
  if ((puVar3 == (undefined4 *)0x0) || (*unaff_ESI < 4)) {
    *unaff_ESI = 0;
    puVar3 = (undefined4 *)0x0;
  }
  else {
    unaff_EDI[0xd] = *puVar3;
    *unaff_ESI = *unaff_ESI - 4;
    puVar3 = puVar3 + 1;
  }
  *param_1 = (int)puVar3;
  if ((puVar3 == (undefined4 *)0x0) || (*unaff_ESI < 4)) {
    *unaff_ESI = 0;
    puVar3 = (undefined4 *)0x0;
  }
  else {
    unaff_EDI[0x26] = *puVar3;
    *unaff_ESI = *unaff_ESI - 4;
    puVar3 = puVar3 + 1;
  }
  *param_1 = (int)puVar3;
  if ((puVar3 == (undefined4 *)0x0) || (*unaff_ESI < 2)) {
    *unaff_ESI = 0;
    puVar4 = (undefined2 *)0x0;
  }
  else {
    *(undefined2 *)(unaff_EDI + 0xe) = *(undefined2 *)puVar3;
    *unaff_ESI = *unaff_ESI - 2;
    puVar4 = (undefined2 *)((int)puVar3 + 2);
  }
  *param_1 = (int)puVar4;
  if ((puVar4 != (undefined2 *)0x0) && (1 < *unaff_ESI)) {
    *(undefined2 *)(unaff_EDI + 0x27) = *puVar4;
    *unaff_ESI = *unaff_ESI - 2;
    *param_1 = (int)(puVar4 + 1);
    return;
  }
  *unaff_ESI = 0;
  *param_1 = 0;
  return;
}



============================================================
DISASSEMBLY
============================================================
0041bb30 : PUSH EBP
0041bb31 : MOV EBP,ESP
0041bb33 : PUSH ECX
0041bb34 : PUSH EBX
0041bb35 : MOV EBX,dword ptr [EBP + 0x8]
0041bb38 : MOV EAX,dword ptr [EBX]
0041bb3a : TEST EAX,EAX
0041bb3c : JZ 0x0041bb55
0041bb3e : CMP dword ptr [ESI],0x8
0041bb41 : JC 0x0041bb55
0041bb43 : MOV ECX,dword ptr [EAX]
0041bb45 : MOV dword ptr [EDI],ECX
0041bb47 : MOV EDX,dword ptr [EAX + 0x4]
0041bb4a : MOV dword ptr [EDI + 0x4],EDX
0041bb4d : ADD dword ptr [ESI],-0x8
0041bb50 : ADD EAX,0x8
0041bb53 : JMP 0x0041bb5d
0041bb55 : MOV dword ptr [ESI],0x0
0041bb5b : XOR EAX,EAX
0041bb5d : MOV dword ptr [EBX],EAX
0041bb5f : TEST EAX,EAX
0041bb61 : JZ 0x0041bb81
0041bb63 : CMP dword ptr [ESI],0x8
0041bb66 : JC 0x0041bb81
0041bb68 : MOV ECX,dword ptr [EAX]
0041bb6a : MOV dword ptr [EDI + 0x90],ECX
0041bb70 : MOV EDX,dword ptr [EAX + 0x4]
0041bb73 : MOV dword ptr [EDI + 0x94],EDX
0041bb79 : ADD dword ptr [ESI],-0x8
0041bb7c : ADD EAX,0x8
0041bb7f : JMP 0x0041bb89
0041bb81 : MOV dword ptr [ESI],0x0
0041bb87 : XOR EAX,EAX
0041bb89 : MOV dword ptr [EBX],EAX
0041bb8b : TEST EAX,EAX
0041bb8d : JZ 0x0041bba7
0041bb8f : CMP dword ptr [ESI],0x8
0041bb92 : JC 0x0041bba7
0041bb94 : MOV ECX,dword ptr [EAX]
0041bb96 : MOV dword ptr [EDI + 0x8],ECX
0041bb99 : MOV EDX,dword ptr [EAX + 0x4]
0041bb9c : MOV dword ptr [EDI + 0xc],EDX
0041bb9f : ADD dword ptr [ESI],-0x8
0041bba2 : ADD EAX,0x8
0041bba5 : JMP 0x0041bbaf
0041bba7 : MOV dword ptr [ESI],0x0
0041bbad : XOR EAX,EAX
0041bbaf : MOV dword ptr [EBX],EAX
0041bbb1 : TEST EAX,EAX
0041bbb3 : JZ 0x0041bbc7
0041bbb5 : CMP dword ptr [ESI],0x4
0041bbb8 : JC 0x0041bbc7
0041bbba : MOV ECX,dword ptr [EAX]
0041bbbc : MOV dword ptr [EDI + 0x10],ECX
0041bbbf : ADD dword ptr [ESI],-0x4
0041bbc2 : LEA ECX,[EAX + 0x4]
0041bbc5 : JMP 0x0041bbcf
0041bbc7 : MOV dword ptr [ESI],0x0
0041bbcd : XOR ECX,ECX
0041bbcf : MOV dword ptr [EBX],ECX
0041bbd1 : TEST ECX,ECX
0041bbd3 : JZ 0x0041bc04
0041bbd5 : MOV EAX,dword ptr [ESI]
0041bbd7 : CMP EAX,0x2
0041bbda : JC 0x0041bc04
0041bbdc : MOVZX EDX,word ptr [ECX]
0041bbdf : TEST DX,DX
0041bbe2 : JL 0x0041bc04
0041bbe4 : MOVSX EBX,DX
0041bbe7 : LEA EDX,[EBX + 0x2]
0041bbea : CMP EAX,EDX
0041bbec : JL 0x0041bc01
0041bbee : SUB EAX,EBX
0041bbf0 : LEA EDX,[ECX + 0x2]
0041bbf3 : SUB EAX,0x2
0041bbf6 : LEA ECX,[EBX + ECX*0x1 + 0x2]
0041bbfa : MOV EBX,dword ptr [EBP + 0x8]
0041bbfd : MOV dword ptr [ESI],EAX
0041bbff : JMP 0x0041bc0a
0041bc01 : MOV EBX,dword ptr [EBP + 0x8]
0041bc04 : XOR EDX,EDX
0041bc06 : XOR ECX,ECX
0041bc08 : MOV dword ptr [ESI],ECX
0041bc0a : MOV dword ptr [EBX],ECX
0041bc0c : TEST EDX,EDX
0041bc0e : JZ 0x0041bc28
0041bc10 : PUSH 0x27
0041bc12 : PUSH EDX
0041bc13 : LEA EBX,[EDI + 0x3c]
0041bc16 : PUSH EBX
0041bc17 : CALL 0x00634e39
0041bc1c : ADD ESP,0xc
0041bc1f : XOR EAX,EAX
0041bc21 : MOV word ptr [EBX + 0x4e],AX
0041bc25 : MOV EBX,dword ptr [EBP + 0x8]
0041bc28 : MOV EAX,dword ptr [EBX]
0041bc2a : TEST EAX,EAX
0041bc2c : JZ 0x0041bc41
0041bc2e : MOV ECX,dword ptr [ESI]
0041bc30 : CMP ECX,0x4
0041bc33 : JC 0x0041bc41
0041bc35 : MOV EBX,dword ptr [EAX]
0041bc37 : ADD ECX,-0x4
0041bc3a : MOV dword ptr [ESI],ECX
0041bc3c : ADD EAX,0x4
0041bc3f : JMP 0x0041bc4c
0041bc41 : MOV EBX,dword ptr [EBP + 0x8]
0041bc44 : MOV dword ptr [ESI],0x0
0041bc4a : XOR EAX,EAX
0041bc4c : MOV ECX,dword ptr [EBP + 0x8]
0041bc4f : PUSH 0x0
0041bc51 : MOV dword ptr [ECX],EAX
0041bc53 : CALL 0x006381ab
0041bc58 : MOV ECX,EAX
0041bc5a : MOV EAX,EDX
0041bc5c : MOV dword ptr [EBP + -0x4],EAX
0041bc5f : MOV EAX,EBX
0041bc61 : CDQ
0041bc62 : ADD ESP,0x4
0041bc65 : ADD ECX,EAX
0041bc67 : MOV EAX,dword ptr [EBP + -0x4]
0041bc6a : ADC EAX,EDX
0041bc6c : MOV dword ptr [EDI + 0x18],ECX
0041bc6f : MOV ECX,dword ptr [EBP + 0x8]
0041bc72 : MOV dword ptr [EDI + 0x1c],EAX
0041bc75 : MOV EAX,dword ptr [ECX]
0041bc77 : POP EBX
0041bc78 : TEST EAX,EAX
0041bc7a : JZ 0x0041bc8b
0041bc7c : CMP dword ptr [ESI],0x1
0041bc7f : JC 0x0041bc8b
0041bc81 : MOV DL,byte ptr [EAX]
0041bc83 : MOV byte ptr [EDI + 0x20],DL
0041bc86 : DEC dword ptr [ESI]
0041bc88 : INC EAX
0041bc89 : JMP 0x0041bc93
0041bc8b : MOV dword ptr [ESI],0x0
0041bc91 : XOR EAX,EAX
0041bc93 : MOV dword ptr [ECX],EAX
0041bc95 : TEST EAX,EAX
0041bc97 : JZ 0x0041bcab
0041bc99 : CMP dword ptr [ESI],0x4
0041bc9c : JC 0x0041bcab
0041bc9e : MOV EDX,dword ptr [EAX]
0041bca0 : MOV dword ptr [EDI + 0x24],EDX
0041bca3 : ADD dword ptr [ESI],-0x4
0041bca6 : ADD EAX,0x4
0041bca9 : JMP 0x0041bcb3
0041bcab : MOV dword ptr [ESI],0x0
0041bcb1 : XOR EAX,EAX
0041bcb3 : MOV dword ptr [ECX],EAX
0041bcb5 : TEST EAX,EAX
0041bcb7 : JZ 0x0041bccb
0041bcb9 : CMP dword ptr [ESI],0x4
0041bcbc : JC 0x0041bccb
0041bcbe : MOV EDX,dword ptr [EAX]
0041bcc0 : MOV dword ptr [EDI + 0x28],EDX
0041bcc3 : ADD dword ptr [ESI],-0x4
0041bcc6 : ADD EAX,0x4
0041bcc9 : JMP 0x0041bcd3
0041bccb : MOV dword ptr [ESI],0x0
0041bcd1 : XOR EAX,EAX
0041bcd3 : MOV dword ptr [ECX],EAX
0041bcd5 : TEST EAX,EAX
0041bcd7 : JZ 0x0041bceb
0041bcd9 : CMP dword ptr [ESI],0x4
0041bcdc : JC 0x0041bceb
0041bcde : MOV EDX,dword ptr [EAX]
0041bce0 : MOV dword ptr [EDI + 0x2c],EDX
0041bce3 : ADD dword ptr [ESI],-0x4
0041bce6 : ADD EAX,0x4
0041bce9 : JMP 0x0041bcf3
0041bceb : MOV dword ptr [ESI],0x0
0041bcf1 : XOR EAX,EAX
0041bcf3 : MOV dword ptr [ECX],EAX
0041bcf5 : TEST EAX,EAX
0041bcf7 : JZ 0x0041bd0b
0041bcf9 : CMP dword ptr [ESI],0x4
0041bcfc : JC 0x0041bd0b
0041bcfe : MOV EDX,dword ptr [EAX]
0041bd00 : MOV dword ptr [EDI + 0x34],EDX
0041bd03 : ADD dword ptr [ESI],-0x4
0041bd06 : ADD EAX,0x4
0041bd09 : JMP 0x0041bd13
0041bd0b : MOV dword ptr [ESI],0x0
0041bd11 : XOR EAX,EAX
0041bd13 : MOV dword ptr [ECX],EAX
0041bd15 : TEST EAX,EAX
0041bd17 : JZ 0x0041bd2e
0041bd19 : CMP dword ptr [ESI],0x4
0041bd1c : JC 0x0041bd2e
0041bd1e : MOV EDX,dword ptr [EAX]
0041bd20 : MOV dword ptr [EDI + 0x98],EDX
0041bd26 : ADD dword ptr [ESI],-0x4
0041bd29 : ADD EAX,0x4
0041bd2c : JMP 0x0041bd36
0041bd2e : MOV dword ptr [ESI],0x0
0041bd34 : XOR EAX,EAX
0041bd36 : MOV dword ptr [ECX],EAX
0041bd38 : TEST EAX,EAX
0041bd3a : JZ 0x0041bd50
0041bd3c : CMP dword ptr [ESI],0x2
0041bd3f : JC 0x0041bd50
0041bd41 : MOV DX,word ptr [EAX]
0041bd44 : MOV word ptr [EDI + 0x38],DX
0041bd48 : ADD dword ptr [ESI],-0x2
0041bd4b : ADD EAX,0x2
0041bd4e : JMP 0x0041bd58
0041bd50 : MOV dword ptr [ESI],0x0
0041bd56 : XOR EAX,EAX
0041bd58 : MOV dword ptr [ECX],EAX
0041bd5a : TEST EAX,EAX
0041bd5c : JZ 0x0041bd7b
0041bd5e : CMP dword ptr [ESI],0x2
0041bd61 : JC 0x0041bd7b
0041bd63 : MOV DX,word ptr [EAX]
0041bd66 : MOV word ptr [EDI + 0x9c],DX
0041bd6d : ADD dword ptr [ESI],-0x2
0041bd70 : ADD EAX,0x2
0041bd73 : MOV dword ptr [ECX],EAX
0041bd75 : MOV ESP,EBP
0041bd77 : POP EBP
0041bd78 : RET 0x4
0041bd7b : XOR EAX,EAX
0041bd7d : MOV dword ptr [ESI],0x0
0041bd83 : MOV dword ptr [ECX],EAX
0041bd85 : MOV ESP,EBP
0041bd87 : POP EBP
0041bd88 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_00a40170
ENTRY    : 00a40170
BODY     : [[00a40170, 00a404ac] [00a404b0, 00a40506]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00a40170(void)

{
  int iVar1;
  int iVar2;
  int in_EAX;
  int iVar3;
  LONG LVar4;
  undefined4 uVar5;
  int iVar6;
  int *piVar7;
  code *pcVar8;
  uint uVar9;
  int *local_8;
  
  iVar3 = FUN_00a3b3b0(in_EAX);
  if (iVar3 != 0) {
    iVar6 = *(int *)(iVar3 + 0x17f8);
    iVar1 = *(int *)(in_EAX + 0xd8);
    iVar2 = *(int *)(in_EAX + 0xdc);
    pcVar8 = InterlockedDecrement_exref;
    if (iVar6 != 0) {
      *(int *)(iVar6 + 0x150) = iVar1;
      *(int *)(iVar6 + 0x154) = iVar2;
      pcVar8 = InterlockedDecrement_exref;
      if (iVar1 != 0 || iVar2 != 0) {
        LVar4 = InterlockedDecrement((LONG *)&DAT_00d6ff74);
        *(LONG *)(*(int *)(iVar3 + 0x17f8) + 0x14c) = LVar4;
      }
    }
    iVar6 = *(int *)(iVar3 + 0x17f0);
    iVar1 = *(int *)(in_EAX + 0xe0);
    iVar2 = *(int *)(in_EAX + 0xe4);
    if (iVar6 != 0) {
      *(int *)(iVar6 + 0x150) = iVar1;
      *(int *)(iVar6 + 0x154) = iVar2;
      if (iVar1 != 0 || iVar2 != 0) {
        uVar5 = (*pcVar8)(&DAT_00d6ff74);
        *(undefined4 *)(*(int *)(iVar3 + 0x17f0) + 0x14c) = uVar5;
      }
    }
    iVar6 = *(int *)(iVar3 + 0x1804);
    iVar1 = *(int *)(in_EAX + 0xf0);
    iVar2 = *(int *)(in_EAX + 0xf4);
    if (iVar6 != 0) {
      *(int *)(iVar6 + 0x150) = iVar1;
      *(int *)(iVar6 + 0x154) = iVar2;
      if (iVar1 != 0 || iVar2 != 0) {
        uVar5 = (*pcVar8)(&DAT_00d6ff74);
        *(undefined4 *)(*(int *)(iVar3 + 0x1804) + 0x14c) = uVar5;
      }
    }
    iVar6 = *(int *)(iVar3 + 0x180c);
    iVar1 = *(int *)(in_EAX + 0xf8);
    iVar2 = *(int *)(in_EAX + 0xfc);
    if (iVar6 != 0) {
      *(int *)(iVar6 + 0x150) = iVar1;
      *(int *)(iVar6 + 0x154) = iVar2;
      if (iVar1 != 0 || iVar2 != 0) {
        uVar5 = (*pcVar8)(&DAT_00d6ff74);
        *(undefined4 *)(*(int *)(iVar3 + 0x180c) + 0x14c) = uVar5;
      }
    }
    iVar6 = *(int *)(iVar3 + 0x1800);
    iVar1 = *(int *)(in_EAX + 0x100);
    iVar2 = *(int *)(in_EAX + 0x104);
    if (iVar6 != 0) {
      *(int *)(iVar6 + 0x150) = iVar1;
      *(int *)(iVar6 + 0x154) = iVar2;
      if (iVar1 != 0 || iVar2 != 0) {
        uVar5 = (*pcVar8)(&DAT_00d6ff74);
        *(undefined4 *)(*(int *)(iVar3 + 0x1800) + 0x14c) = uVar5;
      }
    }
    iVar6 = *(int *)(iVar3 + 0x1814);
    iVar1 = *(int *)(in_EAX + 0x108);
    iVar2 = *(int *)(in_EAX + 0x10c);
    if (iVar6 != 0) {
      *(int *)(iVar6 + 0x150) = iVar1;
      *(int *)(iVar6 + 0x154) = iVar2;
      if (iVar1 != 0 || iVar2 != 0) {
        uVar5 = (*pcVar8)(&DAT_00d6ff74);
        *(undefined4 *)(*(int *)(iVar3 + 0x1814) + 0x14c) = uVar5;
      }
    }
    iVar6 = *(int *)(iVar3 + 0x1810);
    iVar1 = *(int *)(in_EAX + 0x110);
    iVar2 = *(int *)(in_EAX + 0x114);
    if (iVar6 != 0) {
      *(int *)(iVar6 + 0x150) = iVar1;
      *(int *)(iVar6 + 0x154) = iVar2;
      if (iVar1 != 0 || iVar2 != 0) {
        uVar5 = (*pcVar8)(&DAT_00d6ff74);
        *(undefined4 *)(*(int *)(iVar3 + 0x1810) + 0x14c) = uVar5;
      }
    }
    iVar6 = *(int *)(iVar3 + 0x17fc);
    iVar1 = *(int *)(in_EAX + 0x118);
    iVar2 = *(int *)(in_EAX + 0x11c);
    if (iVar6 != 0) {
      *(int *)(iVar6 + 0x150) = iVar1;
      *(int *)(iVar6 + 0x154) = iVar2;
      if (iVar1 != 0 || iVar2 != 0) {
        uVar5 = (*pcVar8)(&DAT_00d6ff74);
        *(undefined4 *)(*(int *)(iVar3 + 0x17fc) + 0x14c) = uVar5;
      }
    }
    iVar6 = *(int *)(iVar3 + 0x1808);
    iVar1 = *(int *)(in_EAX + 0x128);
    iVar2 = *(int *)(in_EAX + 300);
    if (iVar6 != 0) {
      *(int *)(iVar6 + 0x150) = iVar1;
      *(int *)(iVar6 + 0x154) = iVar2;
      if (iVar1 != 0 || iVar2 != 0) {
        uVar5 = (*pcVar8)(&DAT_00d6ff74);
        *(undefined4 *)(*(int *)(iVar3 + 0x1808) + 0x14c) = uVar5;
      }
    }
    iVar6 = *(int *)(iVar3 + 0x1818);
    iVar1 = *(int *)(in_EAX + 0x120);
    iVar2 = *(int *)(in_EAX + 0x124);
    if (iVar6 != 0) {
      *(int *)(iVar6 + 0x150) = iVar1;
      *(int *)(iVar6 + 0x154) = iVar2;
      if (iVar1 != 0 || iVar2 != 0) {
        uVar5 = (*pcVar8)(&DAT_00d6ff74);
        *(undefined4 *)(*(int *)(iVar3 + 0x1818) + 0x14c) = uVar5;
      }
    }
    iVar6 = *(int *)(iVar3 + 0x181c);
    iVar1 = *(int *)(in_EAX + 0x130);
    iVar2 = *(int *)(in_EAX + 0x134);
    if (iVar6 != 0) {
      *(int *)(iVar6 + 0x150) = iVar1;
      *(int *)(iVar6 + 0x154) = iVar2;
      if (iVar1 != 0 || iVar2 != 0) {
        uVar5 = (*pcVar8)(&DAT_00d6ff74);
        *(undefined4 *)(*(int *)(iVar3 + 0x181c) + 0x14c) = uVar5;
      }
    }
    iVar6 = FUN_00703c00(0x600);
    if (iVar6 != 0) {
      iVar1 = *(int *)(in_EAX + 0xe8);
      iVar2 = *(int *)(in_EAX + 0xec);
      if (*(short *)(iVar6 + 4) == 0x61e) {
        iVar6 = *(int *)(iVar3 + 0x17f4);
        if (iVar6 != 0) {
          *(int *)(iVar6 + 0x150) = iVar1;
          *(int *)(iVar6 + 0x154) = iVar2;
          if (iVar1 != 0 || iVar2 != 0) {
            LVar4 = InterlockedDecrement((LONG *)&DAT_00d6ff74);
            *(LONG *)(*(int *)(iVar3 + 0x17f4) + 0x14c) = LVar4;
          }
        }
      }
      else {
        iVar6 = *(int *)(iVar3 + 0x1870);
        if (iVar6 != 0) {
          *(int *)(iVar6 + 0x150) = iVar1;
          *(int *)(iVar6 + 0x154) = iVar2;
          if (iVar1 != 0 || iVar2 != 0) {
            LVar4 = InterlockedDecrement((LONG *)&DAT_00d6ff74);
            *(LONG *)(*(int *)(iVar3 + 0x1870) + 0x14c) = LVar4;
          }
        }
      }
    }
    local_8 = (int *)(iVar3 + 0x1840);
    uVar9 = 0;
    piVar7 = (int *)(in_EAX + 0x138);
    do {
      iVar6 = *piVar7;
      iVar1 = piVar7[1];
      if (((uVar9 < 10) && (uVar9 + 0x14 < 0x21)) && (iVar2 = *local_8, iVar2 != 0)) {
        *(int *)(iVar2 + 0x150) = iVar6;
        *(int *)(iVar2 + 0x154) = iVar1;
        if (iVar6 != 0 || iVar1 != 0) {
          LVar4 = InterlockedDecrement((LONG *)&DAT_00d6ff74);
          *(LONG *)(*local_8 + 0x14c) = LVar4;
        }
      }
      local_8 = local_8 + 1;
      uVar9 = uVar9 + 1;
      piVar7 = piVar7 + 2;
    } while ((int)uVar9 < 10);
  }
  return iVar3;
}



============================================================
DISASSEMBLY
============================================================
00a40170 : PUSH EBP
00a40171 : MOV EBP,ESP
00a40173 : PUSH ECX
00a40174 : PUSH EBX
00a40175 : PUSH ESI
00a40176 : PUSH EDI
00a40177 : MOV ESI,EAX
00a40179 : PUSH ESI
00a4017a : CALL 0x00a3b3b0
00a4017f : MOV EBX,EAX
00a40181 : TEST EBX,EBX
00a40183 : JZ 0x00a40500
00a40189 : MOV EAX,dword ptr [EBX + 0x17f8]
00a4018f : MOV ECX,dword ptr [ESI + 0xd8]
00a40195 : MOV EDX,dword ptr [ESI + 0xdc]
00a4019b : TEST EAX,EAX
00a4019d : JZ 0x00a401ca
00a4019f : MOV dword ptr [EAX + 0x150],ECX
00a401a5 : OR ECX,EDX
00a401a7 : MOV dword ptr [EAX + 0x154],EDX
00a401ad : JZ 0x00a401ca
00a401af : MOV EDI,dword ptr [0x00b851b0]
00a401b5 : PUSH 0xd6ff74
00a401ba : CALL EDI
00a401bc : MOV ECX,dword ptr [EBX + 0x17f8]
00a401c2 : MOV dword ptr [ECX + 0x14c],EAX
00a401c8 : JMP 0x00a401d0
00a401ca : MOV EDI,dword ptr [0x00b851b0]
00a401d0 : MOV ECX,dword ptr [EBX + 0x17f0]
00a401d6 : MOV EAX,dword ptr [ESI + 0xe0]
00a401dc : MOV EDX,dword ptr [ESI + 0xe4]
00a401e2 : TEST ECX,ECX
00a401e4 : JZ 0x00a40209
00a401e6 : MOV dword ptr [ECX + 0x150],EAX
00a401ec : OR EAX,EDX
00a401ee : MOV dword ptr [ECX + 0x154],EDX
00a401f4 : JZ 0x00a40209
00a401f6 : PUSH 0xd6ff74
00a401fb : CALL EDI
00a401fd : MOV EDX,dword ptr [EBX + 0x17f0]
00a40203 : MOV dword ptr [EDX + 0x14c],EAX
00a40209 : MOV ECX,dword ptr [EBX + 0x1804]
00a4020f : MOV EAX,dword ptr [ESI + 0xf0]
00a40215 : MOV EDX,dword ptr [ESI + 0xf4]
00a4021b : TEST ECX,ECX
00a4021d : JZ 0x00a40242
00a4021f : MOV dword ptr [ECX + 0x150],EAX
00a40225 : OR EAX,EDX
00a40227 : MOV dword ptr [ECX + 0x154],EDX
00a4022d : JZ 0x00a40242
00a4022f : PUSH 0xd6ff74
00a40234 : CALL EDI
00a40236 : MOV ECX,dword ptr [EBX + 0x1804]
00a4023c : MOV dword ptr [ECX + 0x14c],EAX
00a40242 : MOV ECX,dword ptr [EBX + 0x180c]
00a40248 : MOV EAX,dword ptr [ESI + 0xf8]
00a4024e : MOV EDX,dword ptr [ESI + 0xfc]
00a40254 : TEST ECX,ECX
00a40256 : JZ 0x00a4027b
00a40258 : MOV dword ptr [ECX + 0x150],EAX
00a4025e : OR EAX,EDX
00a40260 : MOV dword ptr [ECX + 0x154],EDX
00a40266 : JZ 0x00a4027b
00a40268 : PUSH 0xd6ff74
00a4026d : CALL EDI
00a4026f : MOV EDX,dword ptr [EBX + 0x180c]
00a40275 : MOV dword ptr [EDX + 0x14c],EAX
00a4027b : MOV ECX,dword ptr [EBX + 0x1800]
00a40281 : MOV EAX,dword ptr [ESI + 0x100]
00a40287 : MOV EDX,dword ptr [ESI + 0x104]
00a4028d : TEST ECX,ECX
00a4028f : JZ 0x00a402b4
00a40291 : MOV dword ptr [ECX + 0x150],EAX
00a40297 : OR EAX,EDX
00a40299 : MOV dword ptr [ECX + 0x154],EDX
00a4029f : JZ 0x00a402b4
00a402a1 : PUSH 0xd6ff74
00a402a6 : CALL EDI
00a402a8 : MOV ECX,dword ptr [EBX + 0x1800]
00a402ae : MOV dword ptr [ECX + 0x14c],EAX
00a402b4 : MOV ECX,dword ptr [EBX + 0x1814]
00a402ba : MOV EAX,dword ptr [ESI + 0x108]
00a402c0 : MOV EDX,dword ptr [ESI + 0x10c]
00a402c6 : TEST ECX,ECX
00a402c8 : JZ 0x00a402ed
00a402ca : MOV dword ptr [ECX + 0x150],EAX
00a402d0 : OR EAX,EDX
00a402d2 : MOV dword ptr [ECX + 0x154],EDX
00a402d8 : JZ 0x00a402ed
00a402da : PUSH 0xd6ff74
00a402df : CALL EDI
00a402e1 : MOV EDX,dword ptr [EBX + 0x1814]
00a402e7 : MOV dword ptr [EDX + 0x14c],EAX
00a402ed : MOV ECX,dword ptr [EBX + 0x1810]
00a402f3 : MOV EAX,dword ptr [ESI + 0x110]
00a402f9 : MOV EDX,dword ptr [ESI + 0x114]
00a402ff : TEST ECX,ECX
00a40301 : JZ 0x00a40326
00a40303 : MOV dword ptr [ECX + 0x150],EAX
00a40309 : OR EAX,EDX
00a4030b : MOV dword ptr [ECX + 0x154],EDX
00a40311 : JZ 0x00a40326
00a40313 : PUSH 0xd6ff74
00a40318 : CALL EDI
00a4031a : MOV ECX,dword ptr [EBX + 0x1810]
00a40320 : MOV dword ptr [ECX + 0x14c],EAX
00a40326 : MOV ECX,dword ptr [EBX + 0x17fc]
00a4032c : MOV EAX,dword ptr [ESI + 0x118]
00a40332 : MOV EDX,dword ptr [ESI + 0x11c]
00a40338 : TEST ECX,ECX
00a4033a : JZ 0x00a4035f
00a4033c : MOV dword ptr [ECX + 0x150],EAX
00a40342 : OR EAX,EDX
00a40344 : MOV dword ptr [ECX + 0x154],EDX
00a4034a : JZ 0x00a4035f
00a4034c : PUSH 0xd6ff74
00a40351 : CALL EDI
00a40353 : MOV EDX,dword ptr [EBX + 0x17fc]
00a40359 : MOV dword ptr [EDX + 0x14c],EAX
00a4035f : MOV ECX,dword ptr [EBX + 0x1808]
00a40365 : MOV EAX,dword ptr [ESI + 0x128]
00a4036b : MOV EDX,dword ptr [ESI + 0x12c]
00a40371 : TEST ECX,ECX
00a40373 : JZ 0x00a40398
00a40375 : MOV dword ptr [ECX + 0x150],EAX
00a4037b : OR EAX,EDX
00a4037d : MOV dword ptr [ECX + 0x154],EDX
00a40383 : JZ 0x00a40398
00a40385 : PUSH 0xd6ff74
00a4038a : CALL EDI
00a4038c : MOV ECX,dword ptr [EBX + 0x1808]
00a40392 : MOV dword ptr [ECX + 0x14c],EAX
00a40398 : MOV ECX,dword ptr [EBX + 0x1818]
00a4039e : MOV EAX,dword ptr [ESI + 0x120]
00a403a4 : MOV EDX,dword ptr [ESI + 0x124]
00a403aa : TEST ECX,ECX
00a403ac : JZ 0x00a403d1
00a403ae : MOV dword ptr [ECX + 0x150],EAX
00a403b4 : OR EAX,EDX
00a403b6 : MOV dword ptr [ECX + 0x154],EDX
00a403bc : JZ 0x00a403d1
00a403be : PUSH 0xd6ff74
00a403c3 : CALL EDI
00a403c5 : MOV EDX,dword ptr [EBX + 0x1818]
00a403cb : MOV dword ptr [EDX + 0x14c],EAX
00a403d1 : MOV ECX,dword ptr [EBX + 0x181c]
00a403d7 : MOV EAX,dword ptr [ESI + 0x130]
00a403dd : MOV EDX,dword ptr [ESI + 0x134]
00a403e3 : TEST ECX,ECX
00a403e5 : JZ 0x00a4040a
00a403e7 : MOV dword ptr [ECX + 0x150],EAX
00a403ed : OR EAX,EDX
00a403ef : MOV dword ptr [ECX + 0x154],EDX
00a403f5 : JZ 0x00a4040a
00a403f7 : PUSH 0xd6ff74
00a403fc : CALL EDI
00a403fe : MOV ECX,dword ptr [EBX + 0x181c]
00a40404 : MOV dword ptr [ECX + 0x14c],EAX
00a4040a : MOV DI,word ptr [ESI + 0x29]
00a4040e : PUSH 0x600
00a40413 : CALL 0x00703c00
00a40418 : ADD ESP,0x4
00a4041b : TEST EAX,EAX
00a4041d : JZ 0x00a4049a
00a4041f : MOV EDX,0x61e
00a40424 : CMP word ptr [EAX + 0x4],DX
00a40428 : MOV EAX,dword ptr [ESI + 0xe8]
00a4042e : MOV EDX,dword ptr [ESI + 0xec]
00a40434 : JNZ 0x00a40469
00a40436 : MOV ECX,dword ptr [EBX + 0x17f4]
00a4043c : TEST ECX,ECX
00a4043e : JZ 0x00a4049a
00a40440 : MOV dword ptr [ECX + 0x150],EAX
00a40446 : OR EAX,EDX
00a40448 : MOV dword ptr [ECX + 0x154],EDX
00a4044e : JZ 0x00a4049a
00a40450 : PUSH 0xd6ff74
00a40455 : CALL dword ptr [0x00b851b0]
00a4045b : MOV ECX,dword ptr [EBX + 0x17f4]
00a40461 : MOV dword ptr [ECX + 0x14c],EAX
00a40467 : JMP 0x00a4049a
00a40469 : MOV ECX,dword ptr [EBX + 0x1870]
00a4046f : TEST ECX,ECX
00a40471 : JZ 0x00a4049a
00a40473 : MOV dword ptr [ECX + 0x150],EAX
00a40479 : OR EAX,EDX
00a4047b : MOV dword ptr [ECX + 0x154],EDX
00a40481 : JZ 0x00a4049a
00a40483 : PUSH 0xd6ff74
00a40488 : CALL dword ptr [0x00b851b0]
00a4048e : MOV EDX,dword ptr [EBX + 0x1870]
00a40494 : MOV dword ptr [EDX + 0x14c],EAX
00a4049a : LEA EAX,[EBX + 0x1840]
00a404a0 : XOR EDI,EDI
00a404a2 : ADD ESI,0x138
00a404a8 : MOV dword ptr [EBP + -0x4],EAX
00a404ab : JMP 0x00a404b0
00a404b0 : MOV EAX,dword ptr [ESI]
00a404b2 : MOV EDX,dword ptr [ESI + 0x4]
00a404b5 : CMP EDI,0xa
00a404b8 : JNC 0x00a404f1
00a404ba : LEA ECX,[EDI + 0x14]
00a404bd : CMP ECX,0x21
00a404c0 : JNC 0x00a404f1
00a404c2 : MOV ECX,dword ptr [EBP + -0x4]
00a404c5 : MOV ECX,dword ptr [ECX]
00a404c7 : TEST ECX,ECX
00a404c9 : JZ 0x00a404f1
00a404cb : MOV dword ptr [ECX + 0x150],EAX
00a404d1 : OR EAX,EDX
00a404d3 : MOV dword ptr [ECX + 0x154],EDX
00a404d9 : JZ 0x00a404f1
00a404db : PUSH 0xd6ff74
00a404e0 : CALL dword ptr [0x00b851b0]
00a404e6 : MOV EDX,dword ptr [EBP + -0x4]
00a404e9 : MOV ECX,dword ptr [EDX]
00a404eb : MOV dword ptr [ECX + 0x14c],EAX
00a404f1 : ADD dword ptr [EBP + -0x4],0x4
00a404f5 : INC EDI
00a404f6 : ADD ESI,0x8
00a404f9 : CMP EDI,0xa
00a404fc : JL 0x00a404b0
00a404fe : MOV EAX,EBX
00a40500 : POP EDI
00a40501 : POP ESI
00a40502 : POP EBX
00a40503 : MOV ESP,EBP
00a40505 : POP EBP
00a40506 : RET

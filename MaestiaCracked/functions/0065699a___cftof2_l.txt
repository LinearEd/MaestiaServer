PROGRAM  : Maestia.exe
FUNCTION : __cftof2_l
ENTRY    : 0065699a
BODY     : [[0065699a, 00656a90]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    __cftof2_l
   
   Library: Visual Studio 2008 Release */

undefined4 __cftof2_l(int param_1,size_t param_2,char param_3,localeinfo_struct *param_4)

{
  int iVar1;
  int iVar2;
  int *in_EAX;
  int *piVar3;
  undefined4 uVar4;
  undefined1 *in_ECX;
  size_t sVar5;
  undefined1 *puVar6;
  int local_14 [2];
  int local_c;
  char local_8;
  
  iVar1 = in_EAX[1];
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_14,param_4);
  if ((in_ECX == (undefined1 *)0x0) || (param_1 == 0)) {
    piVar3 = __errno();
    uVar4 = 0x16;
    *piVar3 = 0x16;
    __invalid_parameter(0,0,0,0,0);
    if (local_8 != '\0') {
      *(uint *)(local_c + 0x70) = *(uint *)(local_c + 0x70) & 0xfffffffd;
    }
  }
  else {
    if ((param_3 != '\0') && (iVar1 - 1U == param_2)) {
      iVar2 = *in_EAX;
      in_ECX[(uint)(iVar2 == 0x2d) + (iVar1 - 1U)] = 0x30;
      (in_ECX + (uint)(iVar2 == 0x2d) + (iVar1 - 1U))[1] = 0;
    }
    if (*in_EAX == 0x2d) {
      *in_ECX = 0x2d;
      in_ECX = in_ECX + 1;
    }
    if (in_EAX[1] < 1) {
      __shift();
      *in_ECX = 0x30;
      puVar6 = in_ECX + 1;
    }
    else {
      puVar6 = in_ECX + in_EAX[1];
    }
    if (0 < (int)param_2) {
      __shift();
      *puVar6 = *(undefined1 *)**(undefined4 **)(local_14[0] + 0xbc);
      if (in_EAX[1] < 0) {
        sVar5 = -in_EAX[1];
        if ((param_3 != '\0') || ((int)sVar5 <= (int)param_2)) {
          param_2 = sVar5;
        }
        __shift();
        _memset(puVar6 + 1,0x30,param_2);
      }
    }
    if (local_8 != '\0') {
      *(uint *)(local_c + 0x70) = *(uint *)(local_c + 0x70) & 0xfffffffd;
    }
    uVar4 = 0;
  }
  return uVar4;
}



============================================================
DISASSEMBLY
============================================================
0065699a : MOV EDI,EDI
0065699c : PUSH EBP
0065699d : MOV EBP,ESP
0065699f : SUB ESP,0x10
006569a2 : PUSH EBX
006569a3 : PUSH ESI
006569a4 : PUSH EDI
006569a5 : PUSH dword ptr [EBP + 0x14]
006569a8 : MOV EBX,EAX
006569aa : MOV ESI,dword ptr [EBX + 0x4]
006569ad : MOV EDI,ECX
006569af : LEA ECX,[EBP + -0x10]
006569b2 : DEC ESI
006569b3 : CALL 0x00637880
006569b8 : TEST EDI,EDI
006569ba : JNZ 0x006569e9
006569bc : CALL 0x0063ab82
006569c1 : PUSH 0x16
006569c3 : POP ESI
006569c4 : MOV dword ptr [EAX],ESI
006569c6 : XOR EAX,EAX
006569c8 : PUSH EAX
006569c9 : PUSH EAX
006569ca : PUSH EAX
006569cb : PUSH EAX
006569cc : PUSH EAX
006569cd : CALL 0x006372b8
006569d2 : ADD ESP,0x14
006569d5 : CMP byte ptr [EBP + -0x4],0x0
006569d9 : JZ 0x006569e2
006569db : MOV EAX,dword ptr [EBP + -0x8]
006569de : AND dword ptr [EAX + 0x70],0xfffffffd
006569e2 : MOV EAX,ESI
006569e4 : JMP 0x00656a8c
006569e9 : CMP dword ptr [EBP + 0x8],0x0
006569ed : JBE 0x006569bc
006569ef : CMP byte ptr [EBP + 0x10],0x0
006569f3 : JZ 0x00656a0d
006569f5 : CMP ESI,dword ptr [EBP + 0xc]
006569f8 : JNZ 0x00656a0d
006569fa : XOR EAX,EAX
006569fc : CMP dword ptr [EBX],0x2d
006569ff : SETZ AL
00656a02 : ADD EAX,ESI
00656a04 : ADD EAX,EDI
00656a06 : MOV byte ptr [EAX],0x30
00656a09 : MOV byte ptr [EAX + 0x1],0x0
00656a0d : CMP dword ptr [EBX],0x2d
00656a10 : MOV ESI,EDI
00656a12 : JNZ 0x00656a1a
00656a14 : MOV byte ptr [EDI],0x2d
00656a17 : LEA ESI,[EDI + 0x1]
00656a1a : MOV EAX,dword ptr [EBX + 0x4]
00656a1d : XOR EDI,EDI
00656a1f : INC EDI
00656a20 : TEST EAX,EAX
00656a22 : JG 0x00656a31
00656a24 : MOV EAX,ESI
00656a26 : CALL 0x00656383
00656a2b : MOV byte ptr [ESI],0x30
00656a2e : INC ESI
00656a2f : JMP 0x00656a33
00656a31 : ADD ESI,EAX
00656a33 : CMP dword ptr [EBP + 0xc],0x0
00656a37 : JLE 0x00656a7d
00656a39 : MOV EAX,ESI
00656a3b : CALL 0x00656383
00656a40 : MOV EAX,dword ptr [EBP + -0x10]
00656a43 : MOV EAX,dword ptr [EAX + 0xbc]
00656a49 : MOV EAX,dword ptr [EAX]
00656a4b : MOV AL,byte ptr [EAX]
00656a4d : MOV byte ptr [ESI],AL
00656a4f : MOV EBX,dword ptr [EBX + 0x4]
00656a52 : INC ESI
00656a53 : TEST EBX,EBX
00656a55 : JGE 0x00656a7d
00656a57 : NEG EBX
00656a59 : CMP byte ptr [EBP + 0x10],0x0
00656a5d : JNZ 0x00656a64
00656a5f : CMP dword ptr [EBP + 0xc],EBX
00656a62 : JL 0x00656a67
00656a64 : MOV dword ptr [EBP + 0xc],EBX
00656a67 : MOV EDI,dword ptr [EBP + 0xc]
00656a6a : MOV EAX,ESI
00656a6c : CALL 0x00656383
00656a71 : PUSH EDI
00656a72 : PUSH 0x30
00656a74 : PUSH ESI
00656a75 : CALL 0x0063b700
00656a7a : ADD ESP,0xc
00656a7d : CMP byte ptr [EBP + -0x4],0x0
00656a81 : JZ 0x00656a8a
00656a83 : MOV EAX,dword ptr [EBP + -0x8]
00656a86 : AND dword ptr [EAX + 0x70],0xfffffffd
00656a8a : XOR EAX,EAX
00656a8c : POP EDI
00656a8d : POP ESI
00656a8e : POP EBX
00656a8f : LEAVE
00656a90 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_0060b6c0
ENTRY    : 0060b6c0
BODY     : [[0060b6c0, 0060b987] [0060b990, 0060b9ef]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0060b6c0(void)

{
  uint *puVar1;
  uint *puVar2;
  uint *puVar3;
  short sVar4;
  undefined4 uVar5;
  int iVar6;
  uint uVar7;
  short sVar8;
  uint uVar9;
  int in_ECX;
  short sVar10;
  uint uVar11;
  uint uVar12;
  undefined4 local_18;
  uint local_14;
  
  uVar9 = *(int *)(in_ECX + 0x28) - 1;
  puVar3 = (uint *)(*(int *)(*(int *)(in_ECX + 0x34) + (uVar9 >> 6) * 4) + (uVar9 & 0x3f) * 8);
  uVar9 = *(int *)(in_ECX + 0x18) - 1;
  uVar9 = *(uint *)(*(int *)(*(int *)(in_ECX + 0x24) + (uVar9 >> 6) * 4) + (uVar9 & 0x3f) * 4);
  if ((uVar9 & 1) == 0) {
    uVar5 = *(undefined4 *)
             (*(int *)(*(int *)(in_ECX + 0x24) + (*puVar3 >> 6) * 4) + (*puVar3 & 0x3f) * 4);
    local_18._0_2_ = (ushort)uVar5;
    if (((ushort)local_18 == (short)uVar9) &&
       ((short)((uint)uVar5 >> 0x10) == (short)(uVar9 >> 0x10))) {
      puVar3[1] = puVar3[1] - 1;
      if (*(int *)(in_ECX + 0x18) != 0) {
        *(int *)(in_ECX + 0x18) = *(int *)(in_ECX + 0x18) + -1;
      }
    }
  }
  if (puVar3[1] < 3) {
    if (*puVar3 < *(uint *)(in_ECX + 0x18)) {
      *(uint *)(in_ECX + 0x18) = *puVar3;
    }
    if (*(int *)(in_ECX + 0x28) != 0) {
      *(int *)(in_ECX + 0x28) = *(int *)(in_ECX + 0x28) + -1;
      return;
    }
  }
  else {
    uVar9 = *puVar3;
    iVar6 = *(int *)(in_ECX + 0x24);
    sVar10 = *(short *)(*(int *)(iVar6 + (uVar9 >> 6) * 4) + (uVar9 & 0x3f) * 4) >> 1;
    sVar4 = *(short *)(*(int *)(iVar6 + (uVar9 >> 6) * 4) + 2 + (uVar9 & 0x3f) * 4);
    uVar11 = 1;
    uVar12 = 0;
    if (1 < puVar3[1]) {
      do {
        local_14 = uVar9 + 1;
        uVar7 = *(uint *)(*(int *)(iVar6 + (local_14 >> 6) * 4) + (local_14 & 0x3f) * 4);
        if ((uVar7 & 1) == 0) {
          sVar8 = (short)(uVar7 >> 0x10);
          local_18._0_2_ = sVar10;
          if ((sVar8 < sVar4) ||
             ((sVar8 == sVar4 &&
              (local_18._0_2_ = (ushort)uVar7, sVar8 = sVar4, (short)(ushort)local_18 >> 1 < sVar10)
              ))) {
            uVar12 = uVar11;
            sVar10 = (ushort)local_18;
            sVar4 = sVar8;
          }
        }
        else {
          uVar11 = uVar11 + 1;
          local_14 = uVar9 + 2;
        }
        uVar11 = uVar11 + 1;
        uVar9 = local_14;
      } while (uVar11 < puVar3[1]);
      if (uVar12 != 0) {
        puVar1 = (uint *)(in_ECX + 0x38);
        *puVar1 = 0;
        local_18 = *(uint *)(*(int *)(iVar6 + (*puVar3 + uVar12 >> 6) * 4) +
                            (*puVar3 + uVar12 & 0x3f) * 4) & 0xfffffffe;
        uVar9 = *puVar1 >> 6;
        if (*(uint *)(in_ECX + 0x3c) <= uVar9) {
          FUN_00609500(uVar9);
        }
        *(uint *)(*(int *)(*(int *)(in_ECX + 0x44) + uVar9 * 4) + (*puVar1 & 0x3f) * 4) = local_18;
        *puVar1 = *puVar1 + 1;
        local_14 = 1;
        if (1 < puVar3[1]) {
          do {
            uVar11 = uVar12 + 1;
            uVar9 = uVar11 % puVar3[1] + *puVar3;
            uVar9 = *(uint *)(*(int *)(*(int *)(in_ECX + 0x24) + (uVar9 >> 6) * 4) +
                             (uVar9 & 0x3f) * 4);
            if ((uVar9 & 1) == 0) {
              local_18._0_2_ = (ushort)uVar9;
              if ((((*(ushort *)
                      (*(int *)(*(int *)(in_ECX + 0x44) + (*puVar1 - 1 >> 6) * 4) +
                      (*puVar1 - 1 & 0x3f) * 4) ^ (ushort)local_18) & 0xfffe) != 0) ||
                 (local_18._2_2_ = (short)(uVar9 >> 0x10),
                 local_18._2_2_ !=
                 *(short *)(*(int *)(*(int *)(in_ECX + 0x44) + (*puVar1 - 1 >> 6) * 4) + 2 +
                           (*puVar1 - 1 & 0x3f) * 4))) {
                uVar12 = *puVar1 >> 6;
                if (*(uint *)(in_ECX + 0x3c) <= uVar12) {
                  FUN_00609500(uVar12);
                }
                *(uint *)(*(int *)(*(int *)(in_ECX + 0x44) + uVar12 * 4) + (*puVar1 & 0x3f) * 4) =
                     uVar9;
                goto LAB_0060b953;
              }
            }
            else {
              uVar11 = uVar12 + 2;
              local_14 = local_14 + 1;
              uVar12 = uVar11 % puVar3[1] + *puVar3;
              uVar5 = *(undefined4 *)
                       (*(int *)(*(int *)(in_ECX + 0x24) + (uVar12 >> 6) * 4) + (uVar12 & 0x3f) * 4)
              ;
              uVar12 = *puVar1 >> 6;
              if (*(uint *)(in_ECX + 0x3c) <= uVar12) {
                FUN_00609500(uVar12);
              }
              *(uint *)(*(int *)(*(int *)(in_ECX + 0x44) + uVar12 * 4) + (*puVar1 & 0x3f) * 4) =
                   uVar9;
              *puVar1 = *puVar1 + 1;
              uVar9 = *puVar1 >> 6;
              if (*(uint *)(in_ECX + 0x3c) <= uVar9) {
                FUN_00609500(uVar9);
              }
              *(undefined4 *)(*(int *)(*(int *)(in_ECX + 0x44) + uVar9 * 4) + (*puVar1 & 0x3f) * 4)
                   = uVar5;
LAB_0060b953:
              *puVar1 = *puVar1 + 1;
            }
            local_14 = local_14 + 1;
            uVar12 = uVar11;
          } while (local_14 < puVar3[1]);
        }
        puVar2 = (uint *)(in_ECX + 0x18);
        if (*puVar3 < *(uint *)(in_ECX + 0x18)) {
          *puVar2 = *puVar3;
        }
        local_14 = 0;
        if (*puVar1 != 0) {
          do {
            iVar6 = *(int *)(*(int *)(in_ECX + 0x44) + (local_14 >> 6) * 4);
            uVar9 = *puVar2 >> 6;
            if (*(uint *)(in_ECX + 0x1c) <= uVar9) {
              FUN_00609500(uVar9);
            }
            *(undefined4 *)(*(int *)(*(int *)(in_ECX + 0x24) + uVar9 * 4) + (*puVar2 & 0x3f) * 4) =
                 *(undefined4 *)(iVar6 + (local_14 & 0x3f) * 4);
            *puVar2 = *puVar2 + 1;
            local_14 = local_14 + 1;
          } while (local_14 < *puVar1);
        }
        puVar3[1] = *puVar1;
      }
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
0060b6c0 : SUB ESP,0x18
0060b6c3 : MOV EAX,dword ptr [ECX + 0x28]
0060b6c6 : DEC EAX
0060b6c7 : MOV EDX,EAX
0060b6c9 : PUSH EBX
0060b6ca : SHR EDX,0x6
0060b6cd : PUSH ESI
0060b6ce : MOV ESI,dword ptr [ECX + 0x34]
0060b6d1 : MOV EDX,dword ptr [ESI + EDX*0x4]
0060b6d4 : MOV ESI,dword ptr [ECX + 0x24]
0060b6d7 : AND EAX,0x3f
0060b6da : LEA EBX,[EDX + EAX*0x8]
0060b6dd : MOV EAX,dword ptr [ECX + 0x18]
0060b6e0 : DEC EAX
0060b6e1 : MOV EDX,EAX
0060b6e3 : SHR EDX,0x6
0060b6e6 : MOV EDX,dword ptr [ESI + EDX*0x4]
0060b6e9 : AND EAX,0x3f
0060b6ec : MOV EAX,dword ptr [EDX + EAX*0x4]
0060b6ef : PUSH EDI
0060b6f0 : MOV dword ptr [ESP + 0x14],ECX
0060b6f4 : MOV dword ptr [ESP + 0x20],EBX
0060b6f8 : TEST AL,0x1
0060b6fa : JNZ 0x0060b733
0060b6fc : MOV EDX,dword ptr [EBX]
0060b6fe : MOV EDI,dword ptr [ECX + 0x24]
0060b701 : MOV ESI,EDX
0060b703 : SHR ESI,0x6
0060b706 : MOV ESI,dword ptr [EDI + ESI*0x4]
0060b709 : AND EDX,0x3f
0060b70c : MOV EDX,dword ptr [ESI + EDX*0x4]
0060b70f : MOV dword ptr [ESP + 0xc],EDX
0060b713 : CMP word ptr [ESP + 0xc],AX
0060b718 : JNZ 0x0060b733
0060b71a : SHR EDX,0x10
0060b71d : SHR EAX,0x10
0060b720 : CMP DX,AX
0060b723 : JNZ 0x0060b733
0060b725 : DEC dword ptr [EBX + 0x4]
0060b728 : MOV EAX,dword ptr [ECX + 0x18]
0060b72b : TEST EAX,EAX
0060b72d : JZ 0x0060b733
0060b72f : DEC EAX
0060b730 : MOV dword ptr [ECX + 0x18],EAX
0060b733 : CMP dword ptr [EBX + 0x4],0x3
0060b737 : JNC 0x0060b759
0060b739 : MOV EBX,dword ptr [EBX]
0060b73b : CMP EBX,dword ptr [ECX + 0x18]
0060b73e : JNC 0x0060b743
0060b740 : MOV dword ptr [ECX + 0x18],EBX
0060b743 : MOV EAX,dword ptr [ECX + 0x28]
0060b746 : TEST EAX,EAX
0060b748 : JZ 0x0060b9e9
0060b74e : POP EDI
0060b74f : DEC EAX
0060b750 : POP ESI
0060b751 : MOV dword ptr [ECX + 0x28],EAX
0060b754 : POP EBX
0060b755 : ADD ESP,0x18
0060b758 : RET
0060b759 : MOV EAX,dword ptr [EBX]
0060b75b : MOV EDI,dword ptr [ECX + 0x24]
0060b75e : MOV EDX,EAX
0060b760 : SHR EDX,0x6
0060b763 : MOV EDX,dword ptr [EDI + EDX*0x4]
0060b766 : MOV ESI,EAX
0060b768 : AND ESI,0x3f
0060b76b : MOVSX EDX,word ptr [EDX + ESI*0x4]
0060b76f : SAR EDX,0x1
0060b771 : MOV dword ptr [ESP + 0x1c],EDX
0060b775 : MOV EDX,EAX
0060b777 : SHR EDX,0x6
0060b77a : MOV EDX,dword ptr [EDI + EDX*0x4]
0060b77d : MOV ESI,EAX
0060b77f : AND ESI,0x3f
0060b782 : MOVSX EDX,word ptr [EDX + ESI*0x4 + 0x2]
0060b787 : MOV dword ptr [ESP + 0x18],EDX
0060b78b : PUSH EBP
0060b78c : MOV EDX,0x1
0060b791 : XOR EBP,EBP
0060b793 : CMP dword ptr [EBX + 0x4],EDX
0060b796 : JBE 0x0060b9e8
0060b79c : INC EAX
0060b79d : MOV dword ptr [ESP + 0x14],EAX
0060b7a1 : MOV ESI,EAX
0060b7a3 : SHR ESI,0x6
0060b7a6 : MOV ESI,dword ptr [EDI + ESI*0x4]
0060b7a9 : AND EAX,0x3f
0060b7ac : MOV EAX,dword ptr [ESI + EAX*0x4]
0060b7af : MOV dword ptr [ESP + 0x10],EAX
0060b7b3 : TEST byte ptr [ESP + 0x10],0x1
0060b7b8 : JZ 0x0060b7c1
0060b7ba : INC EDX
0060b7bb : INC dword ptr [ESP + 0x14]
0060b7bf : JMP 0x0060b7ea
0060b7c1 : MOV ESI,dword ptr [ESP + 0x1c]
0060b7c5 : SHR EAX,0x10
0060b7c8 : CWDE
0060b7c9 : CMP EAX,ESI
0060b7cb : JGE 0x0060b7d3
0060b7cd : MOV dword ptr [ESP + 0x1c],EAX
0060b7d1 : JMP 0x0060b7e8
0060b7d3 : JNZ 0x0060b7ea
0060b7d5 : MOVSX EAX,word ptr [ESP + 0x10]
0060b7da : MOV ESI,EAX
0060b7dc : SAR ESI,0x1
0060b7de : CMP ESI,dword ptr [ESP + 0x20]
0060b7e2 : JGE 0x0060b7ea
0060b7e4 : MOV dword ptr [ESP + 0x20],EAX
0060b7e8 : MOV EBP,EDX
0060b7ea : MOV EAX,dword ptr [ESP + 0x14]
0060b7ee : INC EDX
0060b7ef : INC EAX
0060b7f0 : MOV dword ptr [ESP + 0x14],EAX
0060b7f4 : CMP EDX,dword ptr [EBX + 0x4]
0060b7f7 : JC 0x0060b7a1
0060b7f9 : TEST EBP,EBP
0060b7fb : JZ 0x0060b9e8
0060b801 : LEA ESI,[ECX + 0x38]
0060b804 : MOV dword ptr [ESI],0x0
0060b80a : MOV EAX,dword ptr [EBX]
0060b80c : ADD EAX,EBP
0060b80e : MOV EDX,EAX
0060b810 : SHR EDX,0x6
0060b813 : MOV EDX,dword ptr [EDI + EDX*0x4]
0060b816 : MOV EDI,dword ptr [ESI]
0060b818 : AND EAX,0x3f
0060b81b : MOV EAX,dword ptr [EDX + EAX*0x4]
0060b81e : MOV dword ptr [ESP + 0x10],EAX
0060b822 : AND word ptr [ESP + 0x10],0xfffe
0060b828 : SHR EDI,0x6
0060b82b : CMP EDI,dword ptr [ESI + 0x4]
0060b82e : JC 0x0060b83c
0060b830 : PUSH EDI
0060b831 : MOV ECX,ESI
0060b833 : CALL 0x00609500
0060b838 : MOV ECX,dword ptr [ESP + 0x18]
0060b83c : MOV EDX,dword ptr [ESI + 0xc]
0060b83f : MOV EAX,dword ptr [ESI]
0060b841 : MOV EDX,dword ptr [EDX + EDI*0x4]
0060b844 : MOV EDI,dword ptr [ESP + 0x10]
0060b848 : AND EAX,0x3f
0060b84b : MOV dword ptr [EDX + EAX*0x4],EDI
0060b84e : MOV EAX,0x1
0060b853 : ADD dword ptr [ESI],EAX
0060b855 : MOV dword ptr [ESP + 0x14],EAX
0060b859 : CMP dword ptr [EBX + 0x4],EAX
0060b85c : JBE 0x0060b96f
0060b862 : MOV ECX,dword ptr [EBX + 0x4]
0060b865 : XOR EDX,EDX
0060b867 : INC EBP
0060b868 : MOV EAX,EBP
0060b86a : DIV ECX
0060b86c : MOV EDI,dword ptr [EBX]
0060b86e : MOV EAX,dword ptr [ESP + 0x18]
0060b872 : MOV EBX,dword ptr [EAX + 0x24]
0060b875 : ADD EDX,EDI
0060b877 : MOV EAX,EDX
0060b879 : SHR EAX,0x6
0060b87c : MOV EAX,dword ptr [EBX + EAX*0x4]
0060b87f : AND EDX,0x3f
0060b882 : MOV EDX,dword ptr [EAX + EDX*0x4]
0060b885 : MOV dword ptr [ESP + 0x10],EDX
0060b889 : TEST DL,0x1
0060b88c : JZ 0x0060b8f1
0060b88e : INC EBP
0060b88f : XOR EDX,EDX
0060b891 : MOV EAX,EBP
0060b893 : DIV ECX
0060b895 : INC dword ptr [ESP + 0x14]
0060b899 : ADD EDX,EDI
0060b89b : MOV EDI,dword ptr [ESI]
0060b89d : MOV EAX,EDX
0060b89f : SHR EAX,0x6
0060b8a2 : MOV ECX,dword ptr [EBX + EAX*0x4]
0060b8a5 : AND EDX,0x3f
0060b8a8 : MOV EBX,dword ptr [ECX + EDX*0x4]
0060b8ab : SHR EDI,0x6
0060b8ae : CMP EDI,dword ptr [ESI + 0x4]
0060b8b1 : JC 0x0060b8bb
0060b8b3 : PUSH EDI
0060b8b4 : MOV ECX,ESI
0060b8b6 : CALL 0x00609500
0060b8bb : MOV EDX,dword ptr [ESI + 0xc]
0060b8be : MOV ECX,dword ptr [EDX + EDI*0x4]
0060b8c1 : MOV EAX,dword ptr [ESI]
0060b8c3 : MOV EDX,dword ptr [ESP + 0x10]
0060b8c7 : AND EAX,0x3f
0060b8ca : MOV dword ptr [ECX + EAX*0x4],EDX
0060b8cd : INC dword ptr [ESI]
0060b8cf : MOV EDI,dword ptr [ESI]
0060b8d1 : SHR EDI,0x6
0060b8d4 : CMP EDI,dword ptr [ESI + 0x4]
0060b8d7 : JC 0x0060b8e1
0060b8d9 : PUSH EDI
0060b8da : MOV ECX,ESI
0060b8dc : CALL 0x00609500
0060b8e1 : MOV EAX,dword ptr [ESI + 0xc]
0060b8e4 : MOV ECX,dword ptr [ESI]
0060b8e6 : MOV EDX,dword ptr [EAX + EDI*0x4]
0060b8e9 : AND ECX,0x3f
0060b8ec : MOV dword ptr [EDX + ECX*0x4],EBX
0060b8ef : JMP 0x0060b953
0060b8f1 : MOV EAX,dword ptr [ESI]
0060b8f3 : MOV EDX,dword ptr [ESI + 0xc]
0060b8f6 : DEC EAX
0060b8f7 : MOV ECX,EAX
0060b8f9 : SHR ECX,0x6
0060b8fc : MOV ECX,dword ptr [EDX + ECX*0x4]
0060b8ff : AND EAX,0x3f
0060b902 : MOV DX,word ptr [ECX + EAX*0x4]
0060b906 : XOR DX,word ptr [ESP + 0x10]
0060b90b : TEST DX,0xfffe
0060b910 : JNZ 0x0060b92f
0060b912 : MOV EAX,dword ptr [ESI]
0060b914 : MOV EDX,dword ptr [ESI + 0xc]
0060b917 : DEC EAX
0060b918 : MOV ECX,EAX
0060b91a : SHR ECX,0x6
0060b91d : MOV ECX,dword ptr [EDX + ECX*0x4]
0060b920 : MOV DX,word ptr [ESP + 0x12]
0060b925 : AND EAX,0x3f
0060b928 : CMP DX,word ptr [ECX + EAX*0x4 + 0x2]
0060b92d : JZ 0x0060b955
0060b92f : MOV EDI,dword ptr [ESI]
0060b931 : SHR EDI,0x6
0060b934 : CMP EDI,dword ptr [ESI + 0x4]
0060b937 : JC 0x0060b941
0060b939 : PUSH EDI
0060b93a : MOV ECX,ESI
0060b93c : CALL 0x00609500
0060b941 : MOV EAX,dword ptr [ESI + 0xc]
0060b944 : MOV ECX,dword ptr [ESI]
0060b946 : MOV EDX,dword ptr [EAX + EDI*0x4]
0060b949 : MOV EAX,dword ptr [ESP + 0x10]
0060b94d : AND ECX,0x3f
0060b950 : MOV dword ptr [EDX + ECX*0x4],EAX
0060b953 : INC dword ptr [ESI]
0060b955 : MOV EAX,dword ptr [ESP + 0x14]
0060b959 : MOV EBX,dword ptr [ESP + 0x24]
0060b95d : INC EAX
0060b95e : MOV dword ptr [ESP + 0x14],EAX
0060b962 : CMP EAX,dword ptr [EBX + 0x4]
0060b965 : JC 0x0060b862
0060b96b : MOV ECX,dword ptr [ESP + 0x18]
0060b96f : MOV EAX,dword ptr [EBX]
0060b971 : CMP EAX,dword ptr [ECX + 0x18]
0060b974 : LEA EBP,[ECX + 0x18]
0060b977 : JNC 0x0060b97c
0060b979 : MOV dword ptr [EBP],EAX
0060b97c : XOR EAX,EAX
0060b97e : MOV dword ptr [ESP + 0x14],EAX
0060b982 : CMP dword ptr [ESI],EAX
0060b984 : JBE 0x0060b9e3
0060b986 : JMP 0x0060b994
0060b990 : MOV ECX,dword ptr [ESP + 0x18]
0060b994 : MOV ECX,dword ptr [ECX + 0x44]
0060b997 : MOV EDX,EAX
0060b999 : SHR EDX,0x6
0060b99c : MOV EDX,dword ptr [ECX + EDX*0x4]
0060b99f : MOV EDI,EAX
0060b9a1 : AND EDI,0x3f
0060b9a4 : LEA ECX,[EDX + EDI*0x4]
0060b9a7 : MOV EDI,dword ptr [EBP]
0060b9aa : SHR EDI,0x6
0060b9ad : MOV dword ptr [ESP + 0x24],ECX
0060b9b1 : CMP EDI,dword ptr [EBP + 0x4]
0060b9b4 : JC 0x0060b9c2
0060b9b6 : PUSH EDI
0060b9b7 : MOV ECX,EBP
0060b9b9 : CALL 0x00609500
0060b9be : MOV EAX,dword ptr [ESP + 0x14]
0060b9c2 : MOV EDX,dword ptr [EBP + 0xc]
0060b9c5 : MOV EDX,dword ptr [EDX + EDI*0x4]
0060b9c8 : MOV ECX,dword ptr [EBP]
0060b9cb : MOV EDI,dword ptr [ESP + 0x24]
0060b9cf : MOV EDI,dword ptr [EDI]
0060b9d1 : AND ECX,0x3f
0060b9d4 : MOV dword ptr [EDX + ECX*0x4],EDI
0060b9d7 : INC dword ptr [EBP]
0060b9da : INC EAX
0060b9db : MOV dword ptr [ESP + 0x14],EAX
0060b9df : CMP EAX,dword ptr [ESI]
0060b9e1 : JC 0x0060b990
0060b9e3 : MOV EAX,dword ptr [ESI]
0060b9e5 : MOV dword ptr [EBX + 0x4],EAX
0060b9e8 : POP EBP
0060b9e9 : POP EDI
0060b9ea : POP ESI
0060b9eb : POP EBX
0060b9ec : ADD ESP,0x18
0060b9ef : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_0053ab10
ENTRY    : 0053ab10
BODY     : [[0053ab10, 0053abfe]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_0053ab10(int *param_1)

{
  byte *pbVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  int in_ECX;
  GThread *this;
  uint uVar7;
  int iVar8;
  
  iVar2 = *(int *)(in_ECX + 0x30);
  iVar3 = *(int *)(in_ECX + 0x2c);
  iVar4 = *(int *)(in_ECX + 0x34);
  *(undefined1 *)(in_ECX + 0x15) = 0;
  if (iVar2 - iVar3 < 2) {
    FUN_00539fb0(2);
  }
  iVar8 = *(int *)(in_ECX + 0x2c);
  uVar7 = (uint)CONCAT11(*(undefined1 *)(*(int *)(in_ECX + 0x3c) + 1 + iVar8),
                         *(undefined1 *)(*(int *)(in_ECX + 0x3c) + iVar8));
  this = (GThread *)(iVar8 + 2);
  uVar6 = uVar7 & 0x3f;
  iVar8 = (int)uVar7 >> 6;
  *(GThread **)(in_ECX + 0x2c) = this;
  if (uVar6 == 0x3f) {
    *(undefined1 *)(in_ECX + 0x15) = 0;
    if (*(int *)(in_ECX + 0x30) - (int)this < 4) {
      FUN_00539fb0(4);
    }
    iVar5 = *(int *)(in_ECX + 0x2c);
    pbVar1 = (byte *)(*(int *)(in_ECX + 0x3c) + iVar5);
    this = (GThread *)(uint)*pbVar1;
    uVar6 = CONCAT31(CONCAT21(CONCAT11(pbVar1[3],
                                       *(undefined1 *)(*(int *)(in_ECX + 0x3c) + 2 + iVar5)),
                              pbVar1[1]),*pbVar1);
    *(int *)(in_ECX + 0x2c) = iVar5 + 4;
  }
  param_1[1] = (iVar4 - iVar2) + iVar3;
  *param_1 = iVar8;
  param_1[2] = uVar6;
  param_1[3] = (*(int *)(in_ECX + 0x34) - *(int *)(in_ECX + 0x30)) + *(int *)(in_ECX + 0x2c);
  if ((*(byte *)(in_ECX + 0xc) & 1) != 0) {
    GThread::OnExit(this);
  }
  *(uint *)(in_ECX + 0x20 + *(int *)(in_ECX + 0x28) * 4) =
       (*(int *)(in_ECX + 0x34) - *(int *)(in_ECX + 0x30)) + *(int *)(in_ECX + 0x2c) + uVar6;
  *(int *)(in_ECX + 0x28) = *(int *)(in_ECX + 0x28) + 1;
  return iVar8;
}



============================================================
DISASSEMBLY
============================================================
0053ab10 : PUSH EBX
0053ab11 : PUSH EBP
0053ab12 : PUSH ESI
0053ab13 : MOV ESI,ECX
0053ab15 : MOV EAX,dword ptr [ESI + 0x30]
0053ab18 : MOV ECX,dword ptr [ESI + 0x2c]
0053ab1b : MOV EBX,dword ptr [ESI + 0x34]
0053ab1e : SUB EBX,EAX
0053ab20 : SUB EAX,ECX
0053ab22 : ADD EBX,ECX
0053ab24 : CMP EAX,0x2
0053ab27 : PUSH EDI
0053ab28 : MOV byte ptr [ESI + 0x15],0x0
0053ab2c : JGE 0x0053ab37
0053ab2e : PUSH 0x2
0053ab30 : MOV ECX,ESI
0053ab32 : CALL 0x00539fb0
0053ab37 : MOV EAX,dword ptr [ESI + 0x2c]
0053ab3a : MOV ECX,dword ptr [ESI + 0x3c]
0053ab3d : MOVZX DX,byte ptr [ECX + EAX*0x1 + 0x1]
0053ab43 : ADD ECX,EAX
0053ab45 : MOVZX CX,byte ptr [ECX]
0053ab49 : SHL DX,0x8
0053ab4d : OR DX,CX
0053ab50 : MOVZX EDX,DX
0053ab53 : LEA ECX,[EAX + 0x2]
0053ab56 : MOVZX EAX,DX
0053ab59 : MOV EBP,EAX
0053ab5b : AND EAX,0x3f
0053ab5e : MOV EDI,EAX
0053ab60 : SAR EBP,0x6
0053ab63 : MOV dword ptr [ESI + 0x2c],ECX
0053ab66 : CMP EDI,0x3f
0053ab69 : JNZ 0x0053abb2
0053ab6b : MOV EDX,dword ptr [ESI + 0x30]
0053ab6e : SUB EDX,ECX
0053ab70 : CMP EDX,0x4
0053ab73 : MOV byte ptr [ESI + 0x15],0x0
0053ab77 : JGE 0x0053ab82
0053ab79 : PUSH 0x4
0053ab7b : MOV ECX,ESI
0053ab7d : CALL 0x00539fb0
0053ab82 : MOV EDX,dword ptr [ESI + 0x2c]
0053ab85 : MOV EAX,dword ptr [ESI + 0x3c]
0053ab88 : MOVZX EDI,byte ptr [EAX + EDX*0x1 + 0x2]
0053ab8d : LEA ECX,[EAX + EDX*0x1]
0053ab90 : MOVZX EAX,byte ptr [ECX + 0x3]
0053ab94 : SHL EAX,0x8
0053ab97 : OR EAX,EDI
0053ab99 : MOVZX EDI,byte ptr [ECX + 0x1]
0053ab9d : MOVZX ECX,byte ptr [ECX]
0053aba0 : SHL EAX,0x8
0053aba3 : OR EAX,EDI
0053aba5 : SHL EAX,0x8
0053aba8 : OR EAX,ECX
0053abaa : ADD EDX,0x4
0053abad : MOV dword ptr [ESI + 0x2c],EDX
0053abb0 : MOV EDI,EAX
0053abb2 : MOV EAX,dword ptr [ESP + 0x14]
0053abb6 : MOV dword ptr [EAX + 0x4],EBX
0053abb9 : MOV dword ptr [EAX],EBP
0053abbb : MOV dword ptr [EAX + 0x8],EDI
0053abbe : MOV EDX,dword ptr [ESI + 0x34]
0053abc1 : SUB EDX,dword ptr [ESI + 0x30]
0053abc4 : ADD EDX,dword ptr [ESI + 0x2c]
0053abc7 : MOV dword ptr [EAX + 0xc],EDX
0053abca : TEST byte ptr [ESI + 0xc],0x1
0053abce : JZ 0x0053abe1
0053abd0 : PUSH EBX
0053abd1 : PUSH EDI
0053abd2 : PUSH EBP
0053abd3 : PUSH 0xb8b890
0053abd8 : PUSH ESI
0053abd9 : CALL 0x0051d420
0053abde : ADD ESP,0x14
0053abe1 : MOV EAX,dword ptr [ESI + 0x34]
0053abe4 : SUB EAX,dword ptr [ESI + 0x30]
0053abe7 : MOV ECX,dword ptr [ESI + 0x28]
0053abea : ADD EAX,dword ptr [ESI + 0x2c]
0053abed : ADD EAX,EDI
0053abef : MOV dword ptr [ESI + ECX*0x4 + 0x20],EAX
0053abf3 : INC dword ptr [ESI + 0x28]
0053abf6 : POP EDI
0053abf7 : POP ESI
0053abf8 : MOV EAX,EBP
0053abfa : POP EBP
0053abfb : POP EBX
0053abfc : RET 0x4

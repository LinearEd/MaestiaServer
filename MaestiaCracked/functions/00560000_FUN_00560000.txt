PROGRAM  : Maestia.exe
FUNCTION : FUN_00560000
ENTRY    : 00560000
BODY     : [[00560000, 005603e4]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_00560000(undefined4 *param_1,int param_2)

{
  ushort uVar1;
  byte bVar2;
  byte bVar3;
  int iVar4;
  undefined4 uVar5;
  int iVar6;
  GRefCountNTSImpl *pGVar7;
  int in_ECX;
  undefined1 local_24 [4];
  undefined4 local_20;
  undefined1 local_1c [8];
  GRefCountNTSImpl *local_14;
  int *local_10;
  uint local_c;
  short local_8;
  ushort local_6;
  byte local_4;
  ushort local_2;
  
  FUN_00504200(*(undefined4 *)(param_2 + 0xc));
  if ((((*(byte *)(in_ECX + 0x2a) >> 4 & 1) != 0) && ((*(byte *)(param_2 + 0x2a) >> 4 & 1) != 0)) &&
     (bVar2 = *(byte *)(param_2 + 0x28) & 1, (*(byte *)(in_ECX + 0x28) & 1) == bVar2)) {
    FUN_0055fbc0(bVar2);
  }
  if ((((*(byte *)(in_ECX + 0x2a) >> 5 & 1) != 0) && ((*(byte *)(param_2 + 0x2a) >> 5 & 1) != 0)) &&
     (bVar2 = *(byte *)(param_2 + 0x28) >> 1 & 1, (*(byte *)(in_ECX + 0x28) >> 1 & 1) == bVar2)) {
    FUN_0055fc30(bVar2);
  }
  bVar2 = (byte)*(ushort *)(in_ECX + 0x2a);
  if ((((bVar2 >> 6 & 1) != 0) && ((*(byte *)(param_2 + 0x2a) >> 6 & 1) != 0)) &&
     (bVar3 = *(byte *)(param_2 + 0x28) >> 2 & 1, (*(byte *)(in_ECX + 0x28) >> 2 & 1) == bVar3)) {
    if (bVar3 == 0) {
      local_4 = local_4 & 0xfb;
    }
    else {
      local_4 = local_4 | 4;
    }
    local_2 = local_2 | 0x40;
  }
  if ((((char)bVar2 < '\0') && (*(char *)(param_2 + 0x2a) < '\0')) &&
     (bVar3 = *(byte *)(param_2 + 0x28) >> 3 & 1, (*(byte *)(in_ECX + 0x28) >> 3 & 1) == bVar3)) {
    if (bVar3 == 0) {
      local_4 = local_4 & 0xf7;
    }
    else {
      local_4 = local_4 | 8;
    }
    local_2 = local_2 | 0x80;
  }
  if ((((*(byte *)(in_ECX + 0x2a) & 1) != 0) && ((*(byte *)(param_2 + 0x2a) & 1) != 0)) &&
     (*(uint *)(in_ECX + 0x20) == *(uint *)(param_2 + 0x20))) {
    local_2 = local_2 | 1;
    local_c = *(uint *)(param_2 + 0x20);
  }
  if ((((*(ushort *)(in_ECX + 0x2a) >> 10 & 1) != 0) &&
      ((*(ushort *)(param_2 + 0x2a) >> 10 & 1) != 0)) &&
     (*(byte *)(in_ECX + 0x23) == *(byte *)(param_2 + 0x23))) {
    local_c = (uint)*(byte *)(param_2 + 0x23) << 0x18 | local_c & 0xffffff;
    local_2 = local_2 | 0x400;
  }
  if ((((bVar2 >> 1 & 1) != 0) && ((*(byte *)(param_2 + 0x2a) >> 1 & 1) != 0)) &&
     ((float)(int)*(short *)(param_2 + 0x24) / 20.0 == (float)(int)*(short *)(in_ECX + 0x24) / 20.0)
     ) {
    local_2 = local_2 | 2;
    local_8 = *(short *)(param_2 + 0x24);
  }
  if ((((bVar2 >> 3 & 1) != 0) && ((*(byte *)(param_2 + 0x2a) >> 3 & 1) != 0)) &&
     (uVar1 = *(ushort *)(param_2 + 0x26), *(ushort *)(in_ECX + 0x26) == uVar1)) {
    local_6 = uVar1;
    if (0x10000 < uVar1) {
      local_6 = 0xffff;
    }
    local_2 = local_2 | 8;
  }
  if ((((bVar2 >> 2 & 1) != 0) && ((*(byte *)(param_2 + 0x2a) >> 2 & 1) != 0)) &&
     (iVar4 = FUN_0051b280((*(uint *)(in_ECX + 8) & 0xfffffffc) + 8,
                           (*(uint *)(param_2 + 8) & 0xfffffffc) + 8), iVar4 == 0)) {
    uVar5 = FUN_0055ef50();
    FUN_0055f890(uVar5);
  }
  if (((*(ushort *)(in_ECX + 0x2a) >> 0xb & 1) != 0) &&
     ((*(ushort *)(param_2 + 0x2a) >> 0xb & 1) != 0)) {
    iVar4 = FUN_005459d0();
    iVar6 = FUN_005459d0();
    if (iVar6 == iVar4) {
      uVar5 = FUN_005459d0();
      FUN_0055fb80(uVar5);
    }
  }
  if ((*(ushort *)(in_ECX + 0x2a) & 0x100) != 0) {
    iVar4 = FUN_0051b1a0();
    if ((iVar4 != 0) && ((*(ushort *)(param_2 + 0x2a) & 0x100) != 0)) {
      iVar4 = FUN_0051b1a0();
      if ((iVar4 != 0) &&
         (iVar4 = FUN_0051b280((*(uint *)(in_ECX + 0x10) & 0xfffffffc) + 8,
                               (*(uint *)(param_2 + 0x10) & 0xfffffffc) + 8), iVar4 == 0)) {
        FUN_0051bc20((uint *)(param_2 + 0x10));
        local_2 = local_2 | 0x100;
      }
    }
  }
  if (((*(ushort *)(in_ECX + 0x2a) >> 9 & 1) != 0) && ((*(ushort *)(param_2 + 0x2a) >> 9 & 1) != 0))
  {
    iVar4 = FUN_0053b9f0();
    iVar6 = FUN_0053b9f0();
    if (iVar6 == iVar4) {
      pGVar7 = (GRefCountNTSImpl *)FUN_0053b9f0();
      if (pGVar7 != (GRefCountNTSImpl *)0x0) {
        *(int *)(pGVar7 + 4) = *(int *)(pGVar7 + 4) + 1;
      }
      if (local_14 != (GRefCountNTSImpl *)0x0) {
        GRefCountNTSImpl::Release(local_14);
      }
      local_2 = local_2 | 0x200;
      local_14 = pGVar7;
    }
  }
  *param_1 = &PTR_FUN_00cd3f2c;
  param_1[1] = 1;
  *param_1 = &PTR_FUN_00b86530;
  FUN_0051c380(local_24,local_20);
  FUN_0051c380(local_1c,local_20);
  if (local_14 != (GRefCountNTSImpl *)0x0) {
    *(int *)(local_14 + 4) = *(int *)(local_14 + 4) + 1;
  }
  param_1[6] = local_14;
  if (local_10 != (int *)0x0) {
    *local_10 = *local_10 + 1;
  }
  param_1[7] = local_10;
  *(short *)(param_1 + 9) = local_8;
  param_1[8] = local_c;
  *(ushort *)((int)param_1 + 0x2a) = local_2;
  *(ushort *)((int)param_1 + 0x26) = local_6;
  *(byte *)(param_1 + 10) = local_4;
  FUN_00504260();
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
00560000 : SUB ESP,0x34
00560003 : PUSH ESI
00560004 : MOV ESI,dword ptr [ESP + 0x40]
00560008 : MOV EAX,dword ptr [ESI + 0xc]
0056000b : PUSH EDI
0056000c : MOV EDI,ECX
0056000e : PUSH EAX
0056000f : LEA ECX,[ESP + 0x14]
00560013 : CALL 0x00504200
00560018 : MOV CL,byte ptr [EDI + 0x2a]
0056001b : SHR CL,0x4
0056001e : TEST CL,0x1
00560021 : JZ 0x00560048
00560023 : MOV DL,byte ptr [ESI + 0x2a]
00560026 : SHR DL,0x4
00560029 : TEST DL,0x1
0056002c : JZ 0x00560048
0056002e : MOVZX EAX,byte ptr [ESI + 0x28]
00560032 : MOV CL,byte ptr [EDI + 0x28]
00560035 : AND AL,0x1
00560037 : AND CL,0x1
0056003a : CMP CL,AL
0056003c : JNZ 0x00560048
0056003e : PUSH EAX
0056003f : LEA ECX,[ESP + 0x14]
00560043 : CALL 0x0055fbc0
00560048 : MOV DL,byte ptr [EDI + 0x2a]
0056004b : SHR DL,0x5
0056004e : TEST DL,0x1
00560051 : JZ 0x0056007b
00560053 : MOV AL,byte ptr [ESI + 0x2a]
00560056 : SHR AL,0x5
00560059 : TEST AL,0x1
0056005b : JZ 0x0056007b
0056005d : MOVZX EAX,byte ptr [ESI + 0x28]
00560061 : MOV CL,byte ptr [EDI + 0x28]
00560064 : SHR AL,0x1
00560066 : SHR CL,0x1
00560068 : AND AL,0x1
0056006a : AND CL,0x1
0056006d : CMP CL,AL
0056006f : JNZ 0x0056007b
00560071 : PUSH EAX
00560072 : LEA ECX,[ESP + 0x14]
00560076 : CALL 0x0055fc30
0056007b : MOVZX EDX,word ptr [EDI + 0x2a]
0056007f : MOV AL,DL
00560081 : SHR AL,0x6
00560084 : TEST AL,0x1
00560086 : JZ 0x005600be
00560088 : MOV CL,byte ptr [ESI + 0x2a]
0056008b : SHR CL,0x6
0056008e : TEST CL,0x1
00560091 : JZ 0x005600be
00560093 : MOV AL,byte ptr [ESI + 0x28]
00560096 : MOV CL,byte ptr [EDI + 0x28]
00560099 : SHR AL,0x2
0056009c : SHR CL,0x2
0056009f : AND AL,0x1
005600a1 : AND CL,0x1
005600a4 : CMP CL,AL
005600a6 : JNZ 0x005600be
005600a8 : TEST AL,AL
005600aa : JZ 0x005600b3
005600ac : OR byte ptr [ESP + 0x38],0x4
005600b1 : JMP 0x005600b8
005600b3 : AND byte ptr [ESP + 0x38],0xfb
005600b8 : OR word ptr [ESP + 0x3a],0x40
005600be : MOV AL,DL
005600c0 : SHR AL,0x7
005600c3 : PUSH EBX
005600c4 : MOV EBX,0x8
005600c9 : TEST AL,0x1
005600cb : JZ 0x00560106
005600cd : MOV CL,byte ptr [ESI + 0x2a]
005600d0 : SHR CL,0x7
005600d3 : TEST CL,0x1
005600d6 : JZ 0x00560106
005600d8 : MOV AL,byte ptr [ESI + 0x28]
005600db : MOV CL,byte ptr [EDI + 0x28]
005600de : SHR AL,0x3
005600e1 : SHR CL,0x3
005600e4 : AND AL,0x1
005600e6 : AND CL,0x1
005600e9 : CMP CL,AL
005600eb : JNZ 0x00560106
005600ed : TEST AL,AL
005600ef : JZ 0x005600f7
005600f1 : OR byte ptr [ESP + 0x3c],BL
005600f5 : JMP 0x005600fc
005600f7 : AND byte ptr [ESP + 0x3c],0xf7
005600fc : MOV EAX,0x80
00560101 : OR word ptr [ESP + 0x3e],AX
00560106 : TEST byte ptr [EDI + 0x2a],0x1
0056010a : JZ 0x0056012a
0056010c : TEST byte ptr [ESI + 0x2a],0x1
00560110 : JZ 0x0056012a
00560112 : MOV EAX,dword ptr [ESI + 0x20]
00560115 : MOV dword ptr [ESP + 0x10],EAX
00560119 : CMP dword ptr [EDI + 0x20],EAX
0056011c : JNZ 0x0056012a
0056011e : OR word ptr [ESP + 0x3e],0x1
00560124 : MOV dword ptr [ESP + 0x34],EAX
00560128 : JMP 0x0056012e
0056012a : MOV EAX,dword ptr [ESP + 0x34]
0056012e : MOV ECX,EDX
00560130 : SHR ECX,0xa
00560133 : TEST CL,0x1
00560136 : JZ 0x00560168
00560138 : MOV CX,word ptr [ESI + 0x2a]
0056013c : SHR CX,0xa
00560140 : TEST CL,0x1
00560143 : JZ 0x00560168
00560145 : MOV CL,byte ptr [ESI + 0x23]
00560148 : CMP byte ptr [EDI + 0x23],CL
0056014b : JNZ 0x00560168
0056014d : MOVZX ECX,CL
00560150 : AND EAX,0xffffff
00560155 : SHL ECX,0x18
00560158 : OR ECX,EAX
0056015a : MOV EAX,0x400
0056015f : OR word ptr [ESP + 0x3e],AX
00560164 : MOV dword ptr [ESP + 0x34],ECX
00560168 : MOV CL,DL
0056016a : SHR CL,0x1
0056016c : TEST CL,0x1
0056016f : JZ 0x005601c7
00560171 : MOV AL,byte ptr [ESI + 0x2a]
00560174 : SHR AL,0x1
00560176 : TEST AL,0x1
00560178 : JZ 0x005601c7
0056017a : MOVSX EAX,word ptr [EDI + 0x24]
0056017e : MOV dword ptr [ESP + 0x48],EAX
00560182 : MOVZX ECX,word ptr [ESI + 0x24]
00560186 : FILD dword ptr [ESP + 0x48]
0056018a : FLD double ptr [0x00b86058]
00560190 : MOVSX EAX,CX
00560193 : FDIV ST1,ST0
00560195 : FXCH
00560197 : FSTP float ptr [ESP + 0x48]
0056019b : FLD float ptr [ESP + 0x48]
0056019f : MOV dword ptr [ESP + 0x48],EAX
005601a3 : FILD dword ptr [ESP + 0x48]
005601a7 : FDIVRP ST2,ST0
005601a9 : FXCH
005601ab : FSTP float ptr [ESP + 0x48]
005601af : FLD float ptr [ESP + 0x48]
005601b3 : FUCOMPP
005601b5 : FNSTSW AX
005601b7 : TEST AH,0x44
005601ba : JP 0x005601c7
005601bc : OR word ptr [ESP + 0x3e],0x2
005601c2 : MOV word ptr [ESP + 0x38],CX
005601c7 : MOV CL,DL
005601c9 : SHR CL,0x3
005601cc : TEST CL,0x1
005601cf : JZ 0x00560205
005601d1 : MOV AL,byte ptr [ESI + 0x2a]
005601d4 : SHR AL,0x3
005601d7 : TEST AL,0x1
005601d9 : JZ 0x00560205
005601db : MOVZX EAX,word ptr [ESI + 0x26]
005601df : CMP word ptr [EDI + 0x26],AX
005601e3 : JNZ 0x00560205
005601e5 : MOVZX EAX,AX
005601e8 : CMP EAX,0x10000
005601ed : JA 0x005601f6
005601ef : MOV word ptr [ESP + 0x3a],AX
005601f4 : JMP 0x00560200
005601f6 : MOV ECX,0xffff
005601fb : MOV word ptr [ESP + 0x3a],CX
00560200 : OR word ptr [ESP + 0x3e],BX
00560205 : SHR DL,0x2
00560208 : TEST DL,0x1
0056020b : JZ 0x00560245
0056020d : MOV DL,byte ptr [ESI + 0x2a]
00560210 : SHR DL,0x2
00560213 : TEST DL,0x1
00560216 : JZ 0x00560245
00560218 : MOV EAX,dword ptr [ESI + 0x8]
0056021b : MOV ECX,dword ptr [EDI + 0x8]
0056021e : AND EAX,0xfffffffc
00560221 : AND ECX,0xfffffffc
00560224 : ADD EAX,0x8
00560227 : PUSH EAX
00560228 : ADD ECX,EBX
0056022a : PUSH ECX
0056022b : CALL 0x0051b280
00560230 : TEST EAX,EAX
00560232 : JNZ 0x00560245
00560234 : MOV ECX,ESI
00560236 : CALL 0x0055ef50
0056023b : PUSH EAX
0056023c : LEA ECX,[ESP + 0x18]
00560240 : CALL 0x0055f890
00560245 : MOV AX,word ptr [EDI + 0x2a]
00560249 : SHR AX,0xb
0056024d : TEST AL,0x1
0056024f : JZ 0x00560283
00560251 : MOV CX,word ptr [ESI + 0x2a]
00560255 : SHR CX,0xb
00560259 : TEST CL,0x1
0056025c : JZ 0x00560283
0056025e : MOV ECX,ESI
00560260 : CALL 0x005459d0
00560265 : MOV ECX,EDI
00560267 : MOV EBX,EAX
00560269 : CALL 0x005459d0
0056026e : CMP EAX,EBX
00560270 : JNZ 0x00560283
00560272 : MOV ECX,ESI
00560274 : CALL 0x005459d0
00560279 : PUSH EAX
0056027a : LEA ECX,[ESP + 0x18]
0056027e : CALL 0x0055fb80
00560283 : MOV EDX,0x100
00560288 : TEST word ptr [EDI + 0x2a],DX
0056028c : JZ 0x005602e7
0056028e : LEA EBX,[EDI + 0x10]
00560291 : MOV ECX,EBX
00560293 : CALL 0x0051b1a0
00560298 : TEST EAX,EAX
0056029a : JZ 0x005602e7
0056029c : MOV EAX,0x100
005602a1 : TEST word ptr [ESI + 0x2a],AX
005602a5 : JZ 0x005602e7
005602a7 : PUSH EBP
005602a8 : LEA EBP,[ESI + 0x10]
005602ab : MOV ECX,EBP
005602ad : CALL 0x0051b1a0
005602b2 : TEST EAX,EAX
005602b4 : JZ 0x005602e6
005602b6 : MOV EAX,dword ptr [EBP]
005602b9 : MOV ECX,dword ptr [EBX]
005602bb : AND EAX,0xfffffffc
005602be : AND ECX,0xfffffffc
005602c1 : ADD EAX,0x8
005602c4 : PUSH EAX
005602c5 : ADD ECX,0x8
005602c8 : PUSH ECX
005602c9 : CALL 0x0051b280
005602ce : TEST EAX,EAX
005602d0 : JNZ 0x005602e6
005602d2 : PUSH EBP
005602d3 : LEA ECX,[ESP + 0x2c]
005602d7 : CALL 0x0051bc20
005602dc : MOV ECX,0x100
005602e1 : OR word ptr [ESP + 0x42],CX
005602e6 : POP EBP
005602e7 : MOV DX,word ptr [EDI + 0x2a]
005602eb : SHR DX,0x9
005602ef : TEST DL,0x1
005602f2 : JZ 0x0056033f
005602f4 : MOV AX,word ptr [ESI + 0x2a]
005602f8 : SHR AX,0x9
005602fc : TEST AL,0x1
005602fe : JZ 0x0056033f
00560300 : MOV ECX,ESI
00560302 : CALL 0x0053b9f0
00560307 : MOV ECX,EDI
00560309 : MOV EBX,EAX
0056030b : CALL 0x0053b9f0
00560310 : CMP EAX,EBX
00560312 : JNZ 0x0056033f
00560314 : MOV ECX,ESI
00560316 : CALL 0x0053b9f0
0056031b : MOV ESI,EAX
0056031d : TEST ESI,ESI
0056031f : JZ 0x00560324
00560321 : INC dword ptr [ESI + 0x4]
00560324 : MOV ECX,dword ptr [ESP + 0x2c]
00560328 : TEST ECX,ECX
0056032a : JZ 0x00560331
0056032c : CALL 0x004ff7c0
00560331 : MOV ECX,0x200
00560336 : OR word ptr [ESP + 0x3e],CX
0056033b : MOV dword ptr [ESP + 0x2c],ESI
0056033f : MOV ESI,dword ptr [ESP + 0x44]
00560343 : MOV EDX,dword ptr [ESP + 0x20]
00560347 : PUSH EDX
00560348 : LEA EAX,[ESP + 0x20]
0056034c : MOV dword ptr [ESI],0xcd3f2c
00560352 : MOV EDI,0x1
00560357 : PUSH EAX
00560358 : LEA ECX,[ESI + 0x8]
0056035b : MOV dword ptr [ESI + 0x4],EDI
0056035e : MOV dword ptr [ESI],0xb86530
00560364 : MOV byte ptr [ESP + 0x50],0x0
00560369 : CALL 0x0051c380
0056036e : MOV ECX,dword ptr [ESP + 0x20]
00560372 : PUSH ECX
00560373 : LEA EDX,[ESP + 0x28]
00560377 : PUSH EDX
00560378 : LEA ECX,[ESI + 0x10]
0056037b : MOV byte ptr [ESP + 0x17],0x0
00560380 : CALL 0x0051c380
00560385 : MOV EAX,dword ptr [ESP + 0x2c]
00560389 : POP EBX
0056038a : TEST EAX,EAX
0056038c : JZ 0x00560395
0056038e : ADD dword ptr [EAX + 0x4],EDI
00560391 : MOV EAX,dword ptr [ESP + 0x28]
00560395 : MOV dword ptr [ESI + 0x18],EAX
00560398 : MOV EAX,dword ptr [ESP + 0x2c]
0056039c : TEST EAX,EAX
0056039e : JZ 0x005603a6
005603a0 : ADD dword ptr [EAX],EDI
005603a2 : MOV EAX,dword ptr [ESP + 0x2c]
005603a6 : MOVZX ECX,word ptr [ESP + 0x34]
005603ab : MOV DX,word ptr [ESP + 0x36]
005603b0 : MOV dword ptr [ESI + 0x1c],EAX
005603b3 : MOV EAX,dword ptr [ESP + 0x30]
005603b7 : MOV word ptr [ESI + 0x24],CX
005603bb : MOVZX ECX,word ptr [ESP + 0x3a]
005603c0 : MOV dword ptr [ESI + 0x20],EAX
005603c3 : MOV AL,byte ptr [ESP + 0x38]
005603c7 : MOV word ptr [ESI + 0x2a],CX
005603cb : LEA ECX,[ESP + 0x10]
005603cf : MOV word ptr [ESI + 0x26],DX
005603d3 : MOV byte ptr [ESI + 0x28],AL
005603d6 : CALL 0x00504260
005603db : POP EDI
005603dc : MOV EAX,ESI
005603de : POP ESI
005603df : ADD ESP,0x34
005603e2 : RET 0x8

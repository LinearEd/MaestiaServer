PROGRAM  : Maestia.exe
FUNCTION : FUN_00ad73f0
ENTRY    : 00ad73f0
BODY     : [[00ad73f0, 00ad7850]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00ad73f0(void)

{
  uint uVar1;
  int *piVar2;
  undefined4 uVar3;
  int in_ECX;
  wchar_t *pwVar4;
  undefined1 local_d4 [28];
  undefined1 local_b8 [28];
  undefined1 local_9c [28];
  undefined1 local_80 [28];
  undefined1 local_64 [28];
  undefined1 local_48 [28];
  undefined1 local_2c [28];
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b471f7;
  local_10 = ExceptionList;
  switch(*(undefined1 *)(in_ECX + 3)) {
  case 0x16:
    ExceptionList = &local_10;
    FUN_00a0e7b0();
    break;
  default:
    pwVar4 = L"[AvaCltNet::PkZChannelHandle] Invalid Packet";
    goto LAB_00ad782c;
  case 0x18:
    ExceptionList = &local_10;
    FUN_00a0e570();
    break;
  case 0x33:
    if ((*DAT_00da9894 != 0) && (*(int *)(*DAT_00da9894 + 0x1a8) != 0)) {
      ExceptionList = &local_10;
      FUN_009b06f0();
    }
    break;
  case 0x35:
    if ((*DAT_00da9894 != 0) && (*(int *)(*DAT_00da9894 + 0x1a8) != 0)) {
      ExceptionList = &local_10;
      FUN_00406460(in_ECX + 0x59);
      local_8 = 0;
      FUN_00406460(in_ECX + 9);
      local_8._0_1_ = 1;
      (**(code **)(**(int **)(*DAT_00da9894 + 0x1a8) + 0x48))
                (*(undefined4 *)(in_ECX + 4),local_9c,local_64,*(undefined1 *)(in_ECX + 8),0,0xc,0);
      local_8 = (uint)local_8._1_3_ << 8;
      FUN_00406560();
      local_8 = 0xffffffff;
      FUN_00406560();
    }
    break;
  case 0x36:
    if ((*DAT_00da9894 != 0) && (*(int *)(*DAT_00da9894 + 0x238) != 0)) {
      ExceptionList = &local_10;
      FUN_009c5e30(DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
    }
    break;
  case 0xff:
    uVar1 = *(uint *)(in_ECX + 4);
    if (uVar1 < 6) {
      if (uVar1 == 5) {
        if (DAT_0172491c == 0) {
          return 1;
        }
        if (*DAT_00da9894 == 0) {
          return 1;
        }
        if (*(int *)(*DAT_00da9894 + 0x1a8) == 0) {
          return 1;
        }
        ExceptionList = &local_10;
        FUN_00406460(L"IDS_CHANNEL_CANNOT_WHISPER_SAME_ALLIANCE");
        local_8 = 10;
        piVar2 = *(int **)(*DAT_00da9894 + 0x1a8);
        uVar3 = FUN_0081d120(local_80);
        local_8._0_1_ = 0xb;
        (**(code **)(*piVar2 + 0x44))(uVar3,3);
        local_8 = CONCAT31(local_8._1_3_,10);
        FUN_00406560();
        local_8 = 0xffffffff;
        FUN_00406560();
        ExceptionList = local_10;
        return 1;
      }
      if (uVar1 == 3) {
        if (DAT_0172491c == 0) {
          return 1;
        }
        if (*DAT_00da9894 == 0) {
          return 1;
        }
        if (*(int *)(*DAT_00da9894 + 0x1a8) == 0) {
          return 1;
        }
        ExceptionList = &local_10;
        FUN_00406460(L"IDS_CHANNEL_CANNOT_WHISPER");
        local_8 = 6;
        piVar2 = *(int **)(*DAT_00da9894 + 0x1a8);
        uVar3 = FUN_0081d120(local_b8);
        local_8._0_1_ = 7;
        (**(code **)(*piVar2 + 0x44))(uVar3,3);
        local_8 = CONCAT31(local_8._1_3_,6);
        FUN_00406560();
        local_8 = 0xffffffff;
        FUN_00406560();
        ExceptionList = local_10;
        return 1;
      }
      if (uVar1 == 4) {
        ExceptionList = &local_10;
        FUN_00406460(L"IDS_CHANNEL_NOT_EXIST_CHAR");
        local_8 = 8;
        piVar2 = *(int **)(*DAT_00da9894 + 0x1a8);
        uVar3 = FUN_0081d120(local_d4);
        local_8._0_1_ = 9;
        (**(code **)(*piVar2 + 0x44))(uVar3,3);
        local_8 = CONCAT31(local_8._1_3_,8);
        FUN_00406560();
        local_8 = 0xffffffff;
        FUN_00406560();
        ExceptionList = local_10;
        return 1;
      }
    }
    else {
      if (uVar1 == 0x80001) {
        if (DAT_0172491c == 0) {
          return 1;
        }
        if (*DAT_00da9894 == 0) {
          return 1;
        }
        if (*(int *)(*DAT_00da9894 + 0x1a8) == 0) {
          return 1;
        }
        ExceptionList = &local_10;
        FUN_00406460(L"IDS_CHANNEL_NOT_EXIST_NICKNAME");
        local_8 = 2;
        piVar2 = *(int **)(*DAT_00da9894 + 0x1a8);
        uVar3 = FUN_0081d120(local_48);
        local_8._0_1_ = 3;
        (**(code **)(*piVar2 + 0x44))(uVar3,3);
        local_8 = CONCAT31(local_8._1_3_,2);
        FUN_00406560();
        local_8 = 0xffffffff;
        FUN_00406560();
        ExceptionList = local_10;
        return 1;
      }
      if (uVar1 == 0x80002) {
        if (DAT_0172491c == 0) {
          return 1;
        }
        if (*DAT_00da9894 == 0) {
          return 1;
        }
        if (*(int *)(*DAT_00da9894 + 0x1a8) == 0) {
          return 1;
        }
        ExceptionList = &local_10;
        FUN_00406460(L"IDS_CHANNEL_SAME_NICKNAME");
        local_8 = 4;
        piVar2 = *(int **)(*DAT_00da9894 + 0x1a8);
        uVar3 = FUN_0081d120(local_2c);
        local_8._0_1_ = 5;
        (**(code **)(*piVar2 + 0x44))(uVar3,3);
        local_8 = CONCAT31(local_8._1_3_,4);
        FUN_00406560();
        local_8 = 0xffffffff;
        FUN_00406560();
        ExceptionList = local_10;
        return 1;
      }
    }
    pwVar4 = L"[AvaCltNet::PkZChannelHandle] Invalid Packet(dwErrorCode)";
LAB_00ad782c:
    ExceptionList = &local_10;
    FUN_008018d0(pwVar4);
  }
  ExceptionList = local_10;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
00ad73f0 : PUSH EBP
00ad73f1 : MOV EBP,ESP
00ad73f3 : PUSH -0x1
00ad73f5 : PUSH 0xb471f7
00ad73fa : MOV EAX,FS:[0x0]
00ad7400 : PUSH EAX
00ad7401 : SUB ESP,0x154
00ad7407 : PUSH EBX
00ad7408 : PUSH ESI
00ad7409 : PUSH EDI
00ad740a : MOV EAX,[0x00d66fa0]
00ad740f : XOR EAX,EBP
00ad7411 : PUSH EAX
00ad7412 : LEA EAX,[EBP + -0xc]
00ad7415 : MOV FS:[0x0],EAX
00ad741b : MOV ESI,ECX
00ad741d : MOVZX EAX,byte ptr [ESI + 0x3]
00ad7421 : ADD EAX,-0x16
00ad7424 : CMP EAX,0xe9
00ad7429 : JA 0x00ad7827
00ad742f : MOVZX EAX,byte ptr [EAX + 0xad7870]
00ad7436 : JMP dword ptr [EAX*0x4 + 0xad7854]
00ad743d : CALL 0x00a0e570
00ad7442 : JMP 0x00ad783a
00ad7447 : MOV ECX,dword ptr [0x017247c0]
00ad744d : MOV EDX,ESI
00ad744f : CALL 0x00a0e7b0
00ad7454 : JMP 0x00ad783a
00ad7459 : MOV ECX,dword ptr [0x00da9894]
00ad745f : MOV EAX,dword ptr [ECX]
00ad7461 : TEST EAX,EAX
00ad7463 : JZ 0x00ad783a
00ad7469 : CMP dword ptr [EAX + 0x1a8],0x0
00ad7470 : JZ 0x00ad783a
00ad7476 : CALL 0x009b06f0
00ad747b : JMP 0x00ad783a
00ad7480 : MOV EDX,dword ptr [0x00da9894]
00ad7486 : MOV EAX,dword ptr [EDX]
00ad7488 : TEST EAX,EAX
00ad748a : JZ 0x00ad783a
00ad7490 : CMP dword ptr [EAX + 0x1a8],0x0
00ad7497 : JZ 0x00ad783a
00ad749d : LEA EAX,[ESI + 0x59]
00ad74a0 : PUSH EAX
00ad74a1 : LEA ECX,[EBP + -0x60]
00ad74a4 : CALL 0x00406460
00ad74a9 : MOV dword ptr [EBP + -0x4],0x0
00ad74b0 : LEA ECX,[ESI + 0x9]
00ad74b3 : PUSH ECX
00ad74b4 : LEA ECX,[EBP + 0xffffff68]
00ad74ba : CALL 0x00406460
00ad74bf : MOV byte ptr [EBP + -0x4],0x1
00ad74c3 : MOV EDX,dword ptr [0x00da9894]
00ad74c9 : MOV EAX,dword ptr [EDX]
00ad74cb : MOVZX EDX,byte ptr [ESI + 0x8]
00ad74cf : MOV ECX,dword ptr [EAX + 0x1a8]
00ad74d5 : MOV EAX,dword ptr [ECX]
00ad74d7 : MOV EAX,dword ptr [EAX + 0x48]
00ad74da : PUSH 0x0
00ad74dc : PUSH 0xc
00ad74de : PUSH 0x0
00ad74e0 : PUSH EDX
00ad74e1 : LEA EDX,[EBP + -0x60]
00ad74e4 : PUSH EDX
00ad74e5 : LEA EDX,[EBP + 0xffffff68]
00ad74eb : PUSH EDX
00ad74ec : MOV EDX,dword ptr [ESI + 0x4]
00ad74ef : PUSH EDX
00ad74f0 : CALL EAX
00ad74f2 : MOV byte ptr [EBP + -0x4],0x0
00ad74f6 : LEA ECX,[EBP + 0xffffff68]
00ad74fc : CALL 0x00406560
00ad7501 : MOV dword ptr [EBP + -0x4],0xffffffff
00ad7508 : LEA ECX,[EBP + -0x60]
00ad750b : CALL 0x00406560
00ad7510 : JMP 0x00ad783a
00ad7515 : MOV ECX,dword ptr [0x00da9894]
00ad751b : MOV EAX,dword ptr [ECX]
00ad751d : TEST EAX,EAX
00ad751f : JZ 0x00ad783a
00ad7525 : CMP dword ptr [EAX + 0x238],0x0
00ad752c : JZ 0x00ad783a
00ad7532 : MOV EDX,dword ptr [ESI + 0x8]
00ad7535 : CALL 0x009c5e30
00ad753a : JMP 0x00ad783a
00ad753f : MOV ESI,dword ptr [ESI + 0x4]
00ad7542 : CMP ESI,0x5
00ad7545 : JA 0x00ad76f7
00ad754b : JZ 0x00ad7667
00ad7551 : SUB ESI,0x3
00ad7554 : JZ 0x00ad75ce
00ad7556 : SUB ESI,0x1
00ad7559 : JNZ 0x00ad7708
00ad755f : PUSH 0xcba3b8
00ad7564 : LEA ECX,[EBP + 0xffffff30]
00ad756a : CALL 0x00406460
00ad756f : MOV EBX,0x8
00ad7574 : MOV dword ptr [EBP + -0x4],EBX
00ad7577 : MOV EDX,dword ptr [0x00da9894]
00ad757d : MOV EAX,dword ptr [EDX]
00ad757f : MOV ESI,dword ptr [EAX + 0x1a8]
00ad7585 : MOV ECX,dword ptr [0x0172491c]
00ad758b : LEA EAX,[EBP + 0xffffff30]
00ad7591 : PUSH EAX
00ad7592 : LEA EDI,[EBP + 0xffffff14]
00ad7598 : CALL 0x0081d120
00ad759d : MOV byte ptr [EBP + -0x4],0x9
00ad75a1 : MOV EDX,dword ptr [ESI]
00ad75a3 : PUSH 0x3
00ad75a5 : PUSH EAX
00ad75a6 : MOV EAX,dword ptr [EDX + 0x44]
00ad75a9 : MOV ECX,ESI
00ad75ab : CALL EAX
00ad75ad : MOV byte ptr [EBP + -0x4],BL
00ad75b0 : MOV ECX,EDI
00ad75b2 : CALL 0x00406560
00ad75b7 : MOV dword ptr [EBP + -0x4],0xffffffff
00ad75be : LEA ECX,[EBP + 0xffffff30]
00ad75c4 : CALL 0x00406560
00ad75c9 : JMP 0x00ad783a
00ad75ce : CMP dword ptr [0x0172491c],0x0
00ad75d5 : JZ 0x00ad783a
00ad75db : MOV ECX,dword ptr [0x00da9894]
00ad75e1 : MOV EAX,dword ptr [ECX]
00ad75e3 : TEST EAX,EAX
00ad75e5 : JZ 0x00ad783a
00ad75eb : CMP dword ptr [EAX + 0x1a8],0x0
00ad75f2 : JZ 0x00ad783a
00ad75f8 : PUSH 0xcba380
00ad75fd : LEA ECX,[EBP + 0xffffff4c]
00ad7603 : CALL 0x00406460
00ad7608 : MOV EBX,0x6
00ad760d : MOV dword ptr [EBP + -0x4],EBX
00ad7610 : MOV EDX,dword ptr [0x00da9894]
00ad7616 : MOV EAX,dword ptr [EDX]
00ad7618 : MOV ESI,dword ptr [EAX + 0x1a8]
00ad761e : MOV ECX,dword ptr [0x0172491c]
00ad7624 : LEA EAX,[EBP + 0xffffff4c]
00ad762a : PUSH EAX
00ad762b : LEA EDI,[EBP + 0xfffffec0]
00ad7631 : CALL 0x0081d120
00ad7636 : MOV byte ptr [EBP + -0x4],0x7
00ad763a : MOV EDX,dword ptr [ESI]
00ad763c : PUSH 0x3
00ad763e : PUSH EAX
00ad763f : MOV EAX,dword ptr [EDX + 0x44]
00ad7642 : MOV ECX,ESI
00ad7644 : CALL EAX
00ad7646 : MOV byte ptr [EBP + -0x4],BL
00ad7649 : MOV ECX,EDI
00ad764b : CALL 0x00406560
00ad7650 : MOV dword ptr [EBP + -0x4],0xffffffff
00ad7657 : LEA ECX,[EBP + 0xffffff4c]
00ad765d : CALL 0x00406560
00ad7662 : JMP 0x00ad783a
00ad7667 : CMP dword ptr [0x0172491c],0x0
00ad766e : JZ 0x00ad783a
00ad7674 : MOV ECX,dword ptr [0x00da9894]
00ad767a : MOV EAX,dword ptr [ECX]
00ad767c : TEST EAX,EAX
00ad767e : JZ 0x00ad783a
00ad7684 : CMP dword ptr [EAX + 0x1a8],0x0
00ad768b : JZ 0x00ad783a
00ad7691 : PUSH 0xcba3f0
00ad7696 : LEA ECX,[EBP + -0x7c]
00ad7699 : CALL 0x00406460
00ad769e : MOV EBX,0xa
00ad76a3 : MOV dword ptr [EBP + -0x4],EBX
00ad76a6 : MOV EDX,dword ptr [0x00da9894]
00ad76ac : MOV EAX,dword ptr [EDX]
00ad76ae : MOV ESI,dword ptr [EAX + 0x1a8]
00ad76b4 : MOV ECX,dword ptr [0x0172491c]
00ad76ba : LEA EAX,[EBP + -0x7c]
00ad76bd : PUSH EAX
00ad76be : LEA EDI,[EBP + 0xfffffef8]
00ad76c4 : CALL 0x0081d120
00ad76c9 : MOV byte ptr [EBP + -0x4],0xb
00ad76cd : MOV EDX,dword ptr [ESI]
00ad76cf : PUSH 0x3
00ad76d1 : PUSH EAX
00ad76d2 : MOV EAX,dword ptr [EDX + 0x44]
00ad76d5 : MOV ECX,ESI
00ad76d7 : CALL EAX
00ad76d9 : MOV byte ptr [EBP + -0x4],BL
00ad76dc : MOV ECX,EDI
00ad76de : CALL 0x00406560
00ad76e3 : MOV dword ptr [EBP + -0x4],0xffffffff
00ad76ea : LEA ECX,[EBP + -0x7c]
00ad76ed : CALL 0x00406560
00ad76f2 : JMP 0x00ad783a
00ad76f7 : SUB ESI,0x80001
00ad76fd : JZ 0x00ad77a2
00ad7703 : SUB ESI,0x1
00ad7706 : JZ 0x00ad7712
00ad7708 : PUSH 0xcba448
00ad770d : JMP 0x00ad782c
00ad7712 : CMP dword ptr [0x0172491c],0x0
00ad7719 : JZ 0x00ad783a
00ad771f : MOV ECX,dword ptr [0x00da9894]
00ad7725 : MOV EAX,dword ptr [ECX]
00ad7727 : TEST EAX,EAX
00ad7729 : JZ 0x00ad783a
00ad772f : CMP dword ptr [EAX + 0x1a8],0x0
00ad7736 : JZ 0x00ad783a
00ad773c : PUSH 0xcba34c
00ad7741 : LEA ECX,[EBP + -0x28]
00ad7744 : CALL 0x00406460
00ad7749 : MOV EBX,0x4
00ad774e : MOV dword ptr [EBP + -0x4],EBX
00ad7751 : MOV EDX,dword ptr [0x00da9894]
00ad7757 : MOV EAX,dword ptr [EDX]
00ad7759 : MOV ESI,dword ptr [EAX + 0x1a8]
00ad775f : MOV ECX,dword ptr [0x0172491c]
00ad7765 : LEA EAX,[EBP + -0x28]
00ad7768 : PUSH EAX
00ad7769 : LEA EDI,[EBP + 0xfffffedc]
00ad776f : CALL 0x0081d120
00ad7774 : MOV byte ptr [EBP + -0x4],0x5
00ad7778 : MOV EDX,dword ptr [ESI]
00ad777a : PUSH 0x3
00ad777c : PUSH EAX
00ad777d : MOV EAX,dword ptr [EDX + 0x44]
00ad7780 : MOV ECX,ESI
00ad7782 : CALL EAX
00ad7784 : MOV byte ptr [EBP + -0x4],BL
00ad7787 : MOV ECX,EDI
00ad7789 : CALL 0x00406560
00ad778e : MOV dword ptr [EBP + -0x4],0xffffffff
00ad7795 : LEA ECX,[EBP + -0x28]
00ad7798 : CALL 0x00406560
00ad779d : JMP 0x00ad783a
00ad77a2 : CMP dword ptr [0x0172491c],0x0
00ad77a9 : JZ 0x00ad783a
00ad77af : MOV ECX,dword ptr [0x00da9894]
00ad77b5 : MOV EAX,dword ptr [ECX]
00ad77b7 : TEST EAX,EAX
00ad77b9 : JZ 0x00ad783a
00ad77bb : CMP dword ptr [EAX + 0x1a8],0x0
00ad77c2 : JZ 0x00ad783a
00ad77c4 : PUSH 0xcba30c
00ad77c9 : LEA ECX,[EBP + -0x44]
00ad77cc : CALL 0x00406460
00ad77d1 : MOV EBX,0x2
00ad77d6 : MOV dword ptr [EBP + -0x4],EBX
00ad77d9 : MOV EDX,dword ptr [0x00da9894]
00ad77df : MOV EAX,dword ptr [EDX]
00ad77e1 : MOV ESI,dword ptr [EAX + 0x1a8]
00ad77e7 : MOV ECX,dword ptr [0x0172491c]
00ad77ed : LEA EAX,[EBP + -0x44]
00ad77f0 : PUSH EAX
00ad77f1 : LEA EDI,[EBP + 0xfffffea4]
00ad77f7 : CALL 0x0081d120
00ad77fc : MOV byte ptr [EBP + -0x4],0x3
00ad7800 : MOV EDX,dword ptr [ESI]
00ad7802 : PUSH 0x3
00ad7804 : PUSH EAX
00ad7805 : MOV EAX,dword ptr [EDX + 0x44]
00ad7808 : MOV ECX,ESI
00ad780a : CALL EAX
00ad780c : MOV byte ptr [EBP + -0x4],BL
00ad780f : MOV ECX,EDI
00ad7811 : CALL 0x00406560
00ad7816 : MOV dword ptr [EBP + -0x4],0xffffffff
00ad781d : LEA ECX,[EBP + -0x44]
00ad7820 : CALL 0x00406560
00ad7825 : JMP 0x00ad783a
00ad7827 : PUSH 0xcba4e0
00ad782c : MOV ESI,dword ptr [0x00da98e8]
00ad7832 : CALL 0x008018d0
00ad7837 : ADD ESP,0x4
00ad783a : MOV EAX,0x1
00ad783f : MOV ECX,dword ptr [EBP + -0xc]
00ad7842 : MOV dword ptr FS:[0x0],ECX
00ad7849 : POP ECX
00ad784a : POP EDI
00ad784b : POP ESI
00ad784c : POP EBX
00ad784d : MOV ESP,EBP
00ad784f : POP EBP
00ad7850 : RET

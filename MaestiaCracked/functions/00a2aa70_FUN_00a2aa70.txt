PROGRAM  : Maestia.exe
FUNCTION : FUN_00a2aa70
ENTRY    : 00a2aa70
BODY     : [[00a2aa70, 00a2aac3] [00a2aad0, 00a2ac88]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a2aa70(int param_1)

{
  int *piVar1;
  rsize_t _DstSize;
  char cVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  undefined4 uVar6;
  int *_Src;
  int *piVar7;
  int iVar8;
  undefined1 local_40 [4];
  undefined2 local_3c;
  undefined4 local_2c;
  uint local_28;
  undefined1 local_24 [4];
  int *local_20;
  int *local_1c;
  int local_18;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  puStack_c = &LAB_00b3b16e;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_20 = (int *)0x0;
  local_1c = (int *)0x0;
  local_18 = 0;
  local_8 = 0;
  piVar7 = *(int **)(param_1 + 0x180);
  if (piVar7 != *(int **)(param_1 + 0x184)) {
    _Src = piVar7 + 1;
    do {
      piVar1 = (int *)*piVar7;
      if ((char)piVar1[0x23] == '\0') {
        (**(code **)(*piVar1 + 8))(uVar3);
        if ((*(int *)(*piVar7 + 0xdc) != 0) && (cVar2 = FUN_008770a0(), cVar2 != '\0')) {
          if (local_20 == (int *)0x0) {
            uVar4 = 0;
          }
          else {
            uVar4 = local_18 - (int)local_20 >> 2;
          }
          if ((uint)((int)local_1c - (int)local_20 >> 2) < uVar4) {
            *local_1c = *piVar7;
            local_1c = local_1c + 1;
          }
          else {
LAB_00a2abba:
            FUN_0042fe80(local_24,local_1c,piVar7);
          }
        }
LAB_00a2abbf:
        piVar7 = piVar7 + 1;
        _Src = _Src + 1;
      }
      else {
        if (piVar1[0x37] != 0) {
          cVar2 = FUN_008770a0();
          if (cVar2 != '\0') {
            if (local_20 == (int *)0x0) {
              uVar4 = 0;
            }
            else {
              uVar4 = local_18 - (int)local_20 >> 2;
            }
            if (uVar4 <= (uint)((int)local_1c - (int)local_20 >> 2)) goto LAB_00a2abba;
            *local_1c = *piVar7;
            local_1c = local_1c + 1;
          }
          goto LAB_00a2abbf;
        }
        iVar5 = *(int *)(param_1 + 0x184) - (int)_Src >> 2;
        if (0 < iVar5) {
          _DstSize = iVar5 * 4;
          _memmove_s(piVar7,_DstSize,_Src,_DstSize);
        }
        *(int *)(param_1 + 0x184) = *(int *)(param_1 + 0x184) + -4;
        if (piVar1 != (int *)0x0) {
          (**(code **)(*piVar1 + 4))(1);
        }
      }
    } while (piVar7 != *(int **)(param_1 + 0x184));
  }
  if ((((int)local_1c - (int)local_20 & 0xfffffffcU) != 0) &&
     (piVar7 = local_20, local_20 != local_1c)) {
    do {
      iVar5 = *piVar7;
      if (iVar5 != 0) {
        iVar8 = *(int *)(iVar5 + 0xdc);
        if (iVar8 == 0) {
          iVar8 = 500;
        }
        uVar6 = FUN_0040e7b0(iVar5,local_40);
        local_8._0_1_ = 1;
        FUN_00a27c70(*(undefined4 *)(iVar5 + 0x74),*(undefined4 *)(iVar5 + 0x78),uVar6,iVar8);
        local_8 = (uint)local_8._1_3_ << 8;
        if (7 < local_28) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_28 = 7;
        local_2c = 0;
        local_3c = 0;
        *(undefined4 *)(iVar5 + 0xdc) = 0;
      }
      piVar7 = piVar7 + 1;
    } while (piVar7 != local_1c);
  }
  local_8 = 0xffffffff;
  if (local_20 == (int *)0x0) {
    ExceptionList = local_10;
    return;
  }
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
00a2aa70 : PUSH EBP
00a2aa71 : MOV EBP,ESP
00a2aa73 : PUSH -0x1
00a2aa75 : PUSH 0xb3b16e
00a2aa7a : MOV EAX,FS:[0x0]
00a2aa80 : PUSH EAX
00a2aa81 : SUB ESP,0x30
00a2aa84 : PUSH EBX
00a2aa85 : PUSH ESI
00a2aa86 : PUSH EDI
00a2aa87 : MOV EAX,[0x00d66fa0]
00a2aa8c : XOR EAX,EBP
00a2aa8e : PUSH EAX
00a2aa8f : LEA EAX,[EBP + -0xc]
00a2aa92 : MOV FS:[0x0],EAX
00a2aa98 : XOR ECX,ECX
00a2aa9a : MOV dword ptr [EBP + -0x1c],ECX
00a2aa9d : XOR ESI,ESI
00a2aa9f : MOV dword ptr [EBP + -0x18],ESI
00a2aaa2 : MOV dword ptr [EBP + -0x14],ECX
00a2aaa5 : MOV dword ptr [EBP + -0x4],ECX
00a2aaa8 : MOV EDX,dword ptr [EBP + 0x8]
00a2aaab : MOV EDI,dword ptr [EDX + 0x180]
00a2aab1 : MOV EAX,dword ptr [EDX + 0x184]
00a2aab7 : CMP EDI,EAX
00a2aab9 : JZ 0x00a2abda
00a2aabf : LEA EBX,[EDI + 0x4]
00a2aac2 : JMP 0x00a2aad0
00a2aad0 : MOV ESI,dword ptr [EDI]
00a2aad2 : CMP byte ptr [ESI + 0x8c],0x0
00a2aad9 : JZ 0x00a2ab6a
00a2aadf : CMP dword ptr [ESI + 0xdc],0x0
00a2aae6 : JBE 0x00a2ab30
00a2aae8 : CALL 0x008770a0
00a2aaed : TEST AL,AL
00a2aaef : JZ 0x00a2abbf
00a2aaf5 : MOV EDX,dword ptr [EBP + -0x1c]
00a2aaf8 : TEST EDX,EDX
00a2aafa : JNZ 0x00a2ab00
00a2aafc : XOR EAX,EAX
00a2aafe : JMP 0x00a2ab08
00a2ab00 : MOV EAX,dword ptr [EBP + -0x14]
00a2ab03 : SUB EAX,EDX
00a2ab05 : SAR EAX,0x2
00a2ab08 : MOV ECX,dword ptr [EBP + -0x18]
00a2ab0b : MOV ESI,ECX
00a2ab0d : SUB ESI,EDX
00a2ab0f : SAR ESI,0x2
00a2ab12 : CMP ESI,EAX
00a2ab14 : JNC 0x00a2ab25
00a2ab16 : MOV EAX,dword ptr [EDI]
00a2ab18 : MOV dword ptr [ECX],EAX
00a2ab1a : ADD ECX,0x4
00a2ab1d : MOV dword ptr [EBP + -0x18],ECX
00a2ab20 : JMP 0x00a2abbf
00a2ab25 : PUSH EDI
00a2ab26 : PUSH ECX
00a2ab27 : LEA ECX,[EBP + -0x20]
00a2ab2a : PUSH ECX
00a2ab2b : JMP 0x00a2abba
00a2ab30 : MOV EAX,dword ptr [EDX + 0x184]
00a2ab36 : SUB EAX,EBX
00a2ab38 : SAR EAX,0x2
00a2ab3b : TEST EAX,EAX
00a2ab3d : JLE 0x00a2ab4f
00a2ab3f : ADD EAX,EAX
00a2ab41 : ADD EAX,EAX
00a2ab43 : PUSH EAX
00a2ab44 : PUSH EBX
00a2ab45 : PUSH EAX
00a2ab46 : PUSH EDI
00a2ab47 : CALL 0x00634101
00a2ab4c : ADD ESP,0x10
00a2ab4f : MOV EAX,dword ptr [EBP + 0x8]
00a2ab52 : ADD dword ptr [EAX + 0x184],-0x4
00a2ab59 : TEST ESI,ESI
00a2ab5b : JZ 0x00a2abc5
00a2ab5d : MOV EDX,dword ptr [ESI]
00a2ab5f : MOV EAX,dword ptr [EDX + 0x4]
00a2ab62 : PUSH 0x1
00a2ab64 : MOV ECX,ESI
00a2ab66 : CALL EAX
00a2ab68 : JMP 0x00a2abc5
00a2ab6a : MOV EDX,dword ptr [ESI]
00a2ab6c : MOV EAX,dword ptr [EDX + 0x8]
00a2ab6f : MOV ECX,ESI
00a2ab71 : CALL EAX
00a2ab73 : MOV ESI,dword ptr [EDI]
00a2ab75 : CMP dword ptr [ESI + 0xdc],0x0
00a2ab7c : JZ 0x00a2abbf
00a2ab7e : CALL 0x008770a0
00a2ab83 : TEST AL,AL
00a2ab85 : JZ 0x00a2abbf
00a2ab87 : MOV EDX,dword ptr [EBP + -0x1c]
00a2ab8a : TEST EDX,EDX
00a2ab8c : JNZ 0x00a2ab92
00a2ab8e : XOR EAX,EAX
00a2ab90 : JMP 0x00a2ab9a
00a2ab92 : MOV EAX,dword ptr [EBP + -0x14]
00a2ab95 : SUB EAX,EDX
00a2ab97 : SAR EAX,0x2
00a2ab9a : MOV ECX,dword ptr [EBP + -0x18]
00a2ab9d : MOV ESI,ECX
00a2ab9f : SUB ESI,EDX
00a2aba1 : SAR ESI,0x2
00a2aba4 : CMP ESI,EAX
00a2aba6 : JNC 0x00a2abb4
00a2aba8 : MOV EDX,dword ptr [EDI]
00a2abaa : MOV dword ptr [ECX],EDX
00a2abac : ADD ECX,0x4
00a2abaf : MOV dword ptr [EBP + -0x18],ECX
00a2abb2 : JMP 0x00a2abbf
00a2abb4 : PUSH EDI
00a2abb5 : PUSH ECX
00a2abb6 : LEA EAX,[EBP + -0x20]
00a2abb9 : PUSH EAX
00a2abba : CALL 0x0042fe80
00a2abbf : ADD EDI,0x4
00a2abc2 : ADD EBX,0x4
00a2abc5 : MOV EDX,dword ptr [EBP + 0x8]
00a2abc8 : CMP EDI,dword ptr [EDX + 0x184]
00a2abce : JNZ 0x00a2aad0
00a2abd4 : MOV ESI,dword ptr [EBP + -0x18]
00a2abd7 : MOV ECX,dword ptr [EBP + -0x1c]
00a2abda : MOV EDX,ESI
00a2abdc : SUB EDX,ECX
00a2abde : TEST EDX,0xfffffffc
00a2abe4 : JZ 0x00a2ac5a
00a2abe6 : MOV EBX,ECX
00a2abe8 : CMP ECX,ESI
00a2abea : JZ 0x00a2ac5a
00a2abec : LEA ESP,[ESP]
00a2abf0 : MOV ESI,dword ptr [EBX]
00a2abf2 : TEST ESI,ESI
00a2abf4 : JZ 0x00a2ac4f
00a2abf6 : MOV EDI,dword ptr [ESI + 0xdc]
00a2abfc : TEST EDI,EDI
00a2abfe : JNZ 0x00a2ac05
00a2ac00 : MOV EDI,0x1f4
00a2ac05 : LEA EAX,[EBP + -0x3c]
00a2ac08 : PUSH EAX
00a2ac09 : PUSH ESI
00a2ac0a : CALL 0x0040e7b0
00a2ac0f : MOV byte ptr [EBP + -0x4],0x1
00a2ac13 : MOV ECX,dword ptr [ESI + 0x78]
00a2ac16 : MOV EDX,dword ptr [ESI + 0x74]
00a2ac19 : PUSH EDI
00a2ac1a : PUSH EAX
00a2ac1b : PUSH ECX
00a2ac1c : MOV ECX,dword ptr [EBP + 0x8]
00a2ac1f : PUSH EDX
00a2ac20 : CALL 0x00a27c70
00a2ac25 : MOV byte ptr [EBP + -0x4],0x0
00a2ac29 : CMP dword ptr [EBP + -0x24],0x8
00a2ac2d : JC 0x00a2ac37
00a2ac2f : MOV ECX,dword ptr [EBP + -0x38]
00a2ac32 : CALL 0x006f04e0
00a2ac37 : XOR EAX,EAX
00a2ac39 : XOR ECX,ECX
00a2ac3b : MOV dword ptr [EBP + -0x24],0x7
00a2ac42 : MOV dword ptr [EBP + -0x28],EAX
00a2ac45 : MOV word ptr [EBP + -0x38],CX
00a2ac49 : MOV dword ptr [ESI + 0xdc],EAX
00a2ac4f : ADD EBX,0x4
00a2ac52 : CMP EBX,dword ptr [EBP + -0x18]
00a2ac55 : JNZ 0x00a2abf0
00a2ac57 : MOV ECX,dword ptr [EBP + -0x1c]
00a2ac5a : MOV dword ptr [EBP + -0x4],0xffffffff
00a2ac61 : TEST ECX,ECX
00a2ac63 : JZ 0x00a2ac6a
00a2ac65 : CALL 0x006f04e0
00a2ac6a : XOR EAX,EAX
00a2ac6c : MOV dword ptr [EBP + -0x1c],EAX
00a2ac6f : MOV dword ptr [EBP + -0x18],EAX
00a2ac72 : MOV dword ptr [EBP + -0x14],EAX
00a2ac75 : MOV ECX,dword ptr [EBP + -0xc]
00a2ac78 : MOV dword ptr FS:[0x0],ECX
00a2ac7f : POP ECX
00a2ac80 : POP EDI
00a2ac81 : POP ESI
00a2ac82 : POP EBX
00a2ac83 : MOV ESP,EBP
00a2ac85 : POP EBP
00a2ac86 : RET 0x4

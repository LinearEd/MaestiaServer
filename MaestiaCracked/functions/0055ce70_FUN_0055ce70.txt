PROGRAM  : Maestia.exe
FUNCTION : FUN_0055ce70
ENTRY    : 0055ce70
BODY     : [[0055ce70, 0055cf6f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0055ce70(undefined4 param_1,uint *param_2,uint param_3)

{
  uint *puVar1;
  uint *puVar2;
  int *piVar3;
  int iVar4;
  uint uVar5;
  int *in_ECX;
  uint uVar6;
  int iVar7;
  
  piVar3 = (int *)*in_ECX;
  if (piVar3 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar3 * 5) <= piVar3[1] * 4 + 4U) goto LAB_0055ceaa;
    iVar7 = piVar3[1] * 2 + 2;
  }
  FUN_0055cbb0(param_1,iVar7);
LAB_0055ceaa:
  piVar3 = (int *)*in_ECX;
  param_3 = param_3 & piVar3[1];
  *piVar3 = *piVar3 + 1;
  iVar7 = *in_ECX;
  iVar4 = *(int *)(iVar7 + 8 + param_3 * 0xc);
  puVar1 = (uint *)(iVar7 + 8 + param_3 * 0xc);
  if (iVar4 == -2) {
    *puVar1 = 0xffffffff;
    puVar1[2] = *param_2;
    puVar1[1] = param_3;
    return;
  }
  uVar6 = param_3;
  do {
    uVar6 = uVar6 + 1 & *(uint *)(iVar7 + 4);
  } while (*(int *)(iVar7 + 8 + uVar6 * 0xc) != -2);
  piVar3 = (int *)(iVar7 + 8 + uVar6 * 0xc);
  uVar5 = puVar1[1];
  if (uVar5 != param_3) {
    puVar2 = (uint *)(iVar7 + 8 + uVar5 * 0xc);
    for (uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0xc); uVar5 != param_3;
        uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0xc)) {
      uVar5 = *puVar2;
      puVar2 = (uint *)(iVar7 + 8 + uVar5 * 0xc);
    }
    if (piVar3 != (int *)0x0) {
      *piVar3 = iVar4;
      piVar3[1] = puVar1[1];
      piVar3[2] = puVar1[2];
    }
    *puVar2 = uVar6;
    puVar1[2] = *param_2;
    *puVar1 = 0xffffffff;
    puVar1[1] = param_3;
    return;
  }
  if (piVar3 != (int *)0x0) {
    *piVar3 = iVar4;
    piVar3[1] = puVar1[1];
    piVar3[2] = puVar1[2];
  }
  puVar1[2] = *param_2;
  *puVar1 = uVar6;
  puVar1[1] = param_3;
  return;
}



============================================================
DISASSEMBLY
============================================================
0055ce70 : PUSH EBP
0055ce71 : PUSH ESI
0055ce72 : MOV ESI,ECX
0055ce74 : MOV EAX,dword ptr [ESI]
0055ce76 : TEST EAX,EAX
0055ce78 : JNZ 0x0055ce83
0055ce7a : MOV EAX,dword ptr [ESP + 0xc]
0055ce7e : PUSH 0x8
0055ce80 : PUSH EAX
0055ce81 : JMP 0x0055cea5
0055ce83 : MOV ECX,dword ptr [EAX + 0x4]
0055ce86 : LEA EDX,[ECX*0x4 + 0x4]
0055ce8d : MOV ECX,dword ptr [EAX]
0055ce8f : LEA ECX,[ECX + ECX*0x4]
0055ce92 : CMP ECX,EDX
0055ce94 : JBE 0x0055ceaa
0055ce96 : MOV EDX,dword ptr [EAX + 0x4]
0055ce99 : MOV ECX,dword ptr [ESP + 0xc]
0055ce9d : LEA EAX,[EDX + EDX*0x1 + 0x2]
0055cea1 : PUSH EAX
0055cea2 : PUSH ECX
0055cea3 : MOV ECX,ESI
0055cea5 : CALL 0x0055cbb0
0055ceaa : MOV ECX,dword ptr [ESI]
0055ceac : MOV EAX,dword ptr [ESP + 0x14]
0055ceb0 : AND EAX,dword ptr [ECX + 0x4]
0055ceb3 : INC dword ptr [ECX]
0055ceb5 : MOV ESI,dword ptr [ESI]
0055ceb7 : LEA EDX,[EAX + EAX*0x2]
0055ceba : MOV EBP,dword ptr [ESI + EDX*0x4 + 0x8]
0055cebe : LEA ECX,[ESI + EDX*0x4 + 0x8]
0055cec2 : CMP EBP,-0x2
0055cec5 : JNZ 0x0055cede
0055cec7 : MOV EDX,dword ptr [ESP + 0x10]
0055cecb : MOV dword ptr [ECX],0xffffffff
0055ced1 : MOV EDX,dword ptr [EDX]
0055ced3 : POP ESI
0055ced4 : MOV dword ptr [ECX + 0x8],EDX
0055ced7 : MOV dword ptr [ECX + 0x4],EAX
0055ceda : POP EBP
0055cedb : RET 0xc
0055cede : PUSH EDI
0055cedf : MOV EDI,dword ptr [ESI + 0x4]
0055cee2 : MOV EDX,EAX
0055cee4 : PUSH EBX
0055cee5 : INC EDX
0055cee6 : AND EDX,EDI
0055cee8 : LEA EBX,[EDX + EDX*0x2]
0055ceeb : CMP dword ptr [ESI + EBX*0x4 + 0x8],-0x2
0055cef0 : JNZ 0x0055cee5
0055cef2 : LEA EDI,[EDX + EDX*0x2]
0055cef5 : LEA EBX,[ESI + EDI*0x4 + 0x8]
0055cef9 : MOV EDI,dword ptr [ECX + 0x4]
0055cefc : CMP EDI,EAX
0055cefe : JNZ 0x0055cf27
0055cf00 : TEST EBX,EBX
0055cf02 : JZ 0x0055cf12
0055cf04 : MOV dword ptr [EBX],EBP
0055cf06 : MOV ESI,dword ptr [ECX + 0x4]
0055cf09 : MOV dword ptr [EBX + 0x4],ESI
0055cf0c : MOV ESI,dword ptr [ECX + 0x8]
0055cf0f : MOV dword ptr [EBX + 0x8],ESI
0055cf12 : MOV ESI,dword ptr [ESP + 0x18]
0055cf16 : MOV ESI,dword ptr [ESI]
0055cf18 : POP EBX
0055cf19 : POP EDI
0055cf1a : MOV dword ptr [ECX + 0x8],ESI
0055cf1d : POP ESI
0055cf1e : MOV dword ptr [ECX],EDX
0055cf20 : MOV dword ptr [ECX + 0x4],EAX
0055cf23 : POP EBP
0055cf24 : RET 0xc
0055cf27 : LEA EDI,[EDI + EDI*0x2]
0055cf2a : CMP dword ptr [ESI + EDI*0x4 + 0x8],EAX
0055cf2e : LEA EDI,[ESI + EDI*0x4 + 0x8]
0055cf32 : JZ 0x0055cf43
0055cf34 : MOV EDI,dword ptr [EDI]
0055cf36 : LEA EDI,[EDI + EDI*0x2]
0055cf39 : CMP dword ptr [ESI + EDI*0x4 + 0x8],EAX
0055cf3d : LEA EDI,[ESI + EDI*0x4 + 0x8]
0055cf41 : JNZ 0x0055cf34
0055cf43 : TEST EBX,EBX
0055cf45 : JZ 0x0055cf55
0055cf47 : MOV dword ptr [EBX],EBP
0055cf49 : MOV ESI,dword ptr [ECX + 0x4]
0055cf4c : MOV dword ptr [EBX + 0x4],ESI
0055cf4f : MOV ESI,dword ptr [ECX + 0x8]
0055cf52 : MOV dword ptr [EBX + 0x8],ESI
0055cf55 : MOV dword ptr [EDI],EDX
0055cf57 : MOV EDX,dword ptr [ESP + 0x18]
0055cf5b : MOV EDX,dword ptr [EDX]
0055cf5d : POP EBX
0055cf5e : POP EDI
0055cf5f : POP ESI
0055cf60 : MOV dword ptr [ECX + 0x8],EDX
0055cf63 : MOV dword ptr [ECX],0xffffffff
0055cf69 : MOV dword ptr [ECX + 0x4],EAX
0055cf6c : POP EBP
0055cf6d : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_0042be40
ENTRY    : 0042be40
BODY     : [[0042be40, 0042beac] [0042beb0, 0042bfdd]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x0042bf5a) */

void FUN_0042be40(void)

{
  ushort *puVar1;
  int iVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  uint uVar5;
  uint uVar6;
  ushort *puVar7;
  int unaff_ESI;
  undefined4 *puVar8;
  undefined4 *puVar9;
  undefined8 uVar10;
  
  if (*(uint *)(unaff_ESI + 0x24) <
      (*(int *)(unaff_ESI + 0x18) - *(int *)(unaff_ESI + 0x14) >> 2) - 1U) {
    if (*(uint *)(unaff_ESI + 0x20) < *(uint *)(unaff_ESI + 0x24)) {
      *(uint *)(unaff_ESI + 0x20) = *(uint *)(unaff_ESI + 0x20) * 2 + 1;
    }
  }
  else {
    *(int *)(unaff_ESI + 0x20) =
         (*(int *)(unaff_ESI + 0x18) - *(int *)(unaff_ESI + 0x14) >> 2) * 2 + -3;
    FUN_0042bfe0(*(undefined4 *)(unaff_ESI + 8));
  }
  uVar5 = (*(int *)(unaff_ESI + 0x24) - (*(uint *)(unaff_ESI + 0x20) >> 1)) - 1;
  puVar8 = *(undefined4 **)(uVar5 * 4 + *(int *)(unaff_ESI + 0x14));
  if (puVar8 != *(undefined4 **)(uVar5 * 4 + *(int *)(unaff_ESI + 0x14) + 4)) {
    do {
      if ((uint)puVar8[8] < 8) {
        puVar7 = (ushort *)(puVar8 + 3);
      }
      else {
        puVar7 = (ushort *)puVar8[3];
      }
      puVar1 = puVar7 + puVar8[7];
      uVar6 = 0x811c9dc5;
      for (; puVar7 != puVar1; puVar7 = puVar7 + 1) {
        uVar6 = uVar6 * 0x1000193 ^ (uint)*puVar7;
      }
      uVar10 = FUN_0063871f(uVar6 & 0x7fffffff,0x1f31d);
      uVar6 = (int)((ulonglong)uVar10 >> 0x20) * 0x41a7 + (int)uVar10 * -0xb14;
      if ((int)uVar6 < 0) {
        uVar6 = uVar6 + 0x7fffffff;
      }
      if ((*(uint *)(unaff_ESI + 0x20) & uVar6) == uVar5) {
        puVar9 = (undefined4 *)*puVar8;
      }
      else {
        puVar9 = (undefined4 *)*puVar8;
        if (puVar9 != *(undefined4 **)(unaff_ESI + 8)) {
          iVar2 = uVar5 * 4;
          puVar3 = *(undefined4 **)(iVar2 + *(int *)(unaff_ESI + 0x14));
          uVar6 = uVar5;
          while ((puVar8 == puVar3 &&
                 (*(undefined4 **)(iVar2 + *(int *)(unaff_ESI + 0x14)) = puVar9, uVar6 != 0))) {
            uVar6 = uVar6 - 1;
            iVar2 = uVar6 * 4;
            puVar3 = *(undefined4 **)(iVar2 + *(int *)(unaff_ESI + 0x14));
          }
          iVar2 = *(int *)(unaff_ESI + 8);
          *(undefined4 **)puVar8[1] = puVar9;
          *(int *)puVar9[1] = iVar2;
          **(undefined4 **)(iVar2 + 4) = puVar8;
          uVar4 = *(undefined4 *)(iVar2 + 4);
          *(undefined4 *)(iVar2 + 4) = puVar9[1];
          puVar9[1] = puVar8[1];
          puVar8[1] = uVar4;
          puVar8 = *(undefined4 **)(*(int *)(unaff_ESI + 8) + 4);
          *(int *)(*(int *)(unaff_ESI + 0x14) + 4 + *(int *)(unaff_ESI + 0x24) * 4) =
               *(int *)(unaff_ESI + 8);
        }
        for (uVar6 = *(uint *)(unaff_ESI + 0x24);
            (uVar5 < uVar6 &&
            (*(int *)(*(int *)(unaff_ESI + 0x14) + uVar6 * 4) == *(int *)(unaff_ESI + 8)));
            uVar6 = uVar6 - 1) {
          *(undefined4 **)(*(int *)(unaff_ESI + 0x14) + uVar6 * 4) = puVar8;
        }
        if (puVar9 == *(undefined4 **)(unaff_ESI + 8)) break;
      }
      puVar8 = puVar9;
    } while (puVar9 != *(undefined4 **)(uVar5 * 4 + 4 + *(int *)(unaff_ESI + 0x14)));
  }
  *(int *)(unaff_ESI + 0x24) = *(int *)(unaff_ESI + 0x24) + 1;
  return;
}



============================================================
DISASSEMBLY
============================================================
0042be40 : PUSH EBP
0042be41 : MOV EBP,ESP
0042be43 : MOV EDX,dword ptr [ESI + 0x18]
0042be46 : SUB EDX,dword ptr [ESI + 0x14]
0042be49 : MOV ECX,dword ptr [ESI + 0x24]
0042be4c : LEA EAX,[ESI + 0x10]
0042be4f : SUB ESP,0x8
0042be52 : SAR EDX,0x2
0042be55 : DEC EDX
0042be56 : PUSH EBX
0042be57 : PUSH EDI
0042be58 : CMP EDX,ECX
0042be5a : JA 0x0042be7a
0042be5c : MOV ECX,dword ptr [EAX + 0x8]
0042be5f : SUB ECX,dword ptr [EAX + 0x4]
0042be62 : MOV EDX,dword ptr [ESI + 0x8]
0042be65 : SAR ECX,0x2
0042be68 : LEA ECX,[ECX + ECX*0x1 + -0x3]
0042be6c : MOV dword ptr [ESI + 0x20],ECX
0042be6f : PUSH EDX
0042be70 : ADD ECX,0x2
0042be73 : CALL 0x0042bfe0
0042be78 : JMP 0x0042be88
0042be7a : MOV EAX,dword ptr [ESI + 0x20]
0042be7d : CMP EAX,ECX
0042be7f : JNC 0x0042be88
0042be81 : LEA EAX,[EAX + EAX*0x1 + 0x1]
0042be85 : MOV dword ptr [ESI + 0x20],EAX
0042be88 : MOV ECX,dword ptr [ESI + 0x20]
0042be8b : MOV EAX,dword ptr [ESI + 0x24]
0042be8e : MOV EDX,dword ptr [ESI + 0x14]
0042be91 : SHR ECX,0x1
0042be93 : SUB EAX,ECX
0042be95 : DEC EAX
0042be96 : MOV dword ptr [EBP + -0x4],EAX
0042be99 : ADD EAX,EAX
0042be9b : ADD EAX,EAX
0042be9d : MOV EDI,dword ptr [EAX + EDX*0x1]
0042bea0 : ADD EAX,EDX
0042bea2 : CMP EDI,dword ptr [EAX + 0x4]
0042bea5 : JZ 0x0042bfd5
0042beab : JMP 0x0042beb0
0042beb0 : CMP dword ptr [EDI + 0x20],0x8
0042beb4 : JC 0x0042bebb
0042beb6 : MOV ECX,dword ptr [EDI + 0xc]
0042beb9 : JMP 0x0042bebe
0042bebb : LEA ECX,[EDI + 0xc]
0042bebe : MOV EDX,dword ptr [EDI + 0x1c]
0042bec1 : LEA EDX,[ECX + EDX*0x2]
0042bec4 : MOV EAX,0x811c9dc5
0042bec9 : CMP ECX,EDX
0042becb : JZ 0x0042bee2
0042becd : LEA ECX,[ECX]
0042bed0 : MOVZX EBX,word ptr [ECX]
0042bed3 : IMUL EAX,EAX,0x1000193
0042bed9 : ADD ECX,0x2
0042bedc : XOR EAX,EBX
0042bede : CMP ECX,EDX
0042bee0 : JNZ 0x0042bed0
0042bee2 : AND EAX,0x7fffffff
0042bee7 : PUSH 0x1f31d
0042beec : PUSH EAX
0042beed : CALL 0x0063871f
0042bef2 : IMUL EDX,EDX,0x41a7
0042bef8 : IMUL EAX,EAX,0xb14
0042befe : ADD ESP,0x8
0042bf01 : SUB EDX,EAX
0042bf03 : JNS 0x0042bf0b
0042bf05 : ADD EDX,0x7fffffff
0042bf0b : MOV EAX,dword ptr [ESI + 0x20]
0042bf0e : MOV ECX,dword ptr [EBP + -0x4]
0042bf11 : AND EAX,EDX
0042bf13 : CMP EAX,ECX
0042bf15 : JNZ 0x0042bf1e
0042bf17 : MOV EDI,dword ptr [EDI]
0042bf19 : JMP 0x0042bfc1
0042bf1e : MOV EDX,dword ptr [EDI]
0042bf20 : MOV dword ptr [EBP + -0x8],EDX
0042bf23 : CMP EDX,dword ptr [ESI + 0x8]
0042bf26 : JZ 0x0042bf9a
0042bf28 : MOV EBX,dword ptr [ESI + 0x14]
0042bf2b : MOV EAX,ECX
0042bf2d : ADD ECX,ECX
0042bf2f : ADD ECX,ECX
0042bf31 : CMP EDI,dword ptr [ECX + EBX*0x1]
0042bf34 : JNZ 0x0042bf50
0042bf36 : MOV EBX,dword ptr [ESI + 0x14]
0042bf39 : MOV dword ptr [ECX + EBX*0x1],EDX
0042bf3c : TEST EAX,EAX
0042bf3e : JZ 0x0042bf50
0042bf40 : MOV EBX,dword ptr [ESI + 0x14]
0042bf43 : DEC EAX
0042bf44 : LEA ECX,[EAX*0x4 + 0x0]
0042bf4b : CMP EDI,dword ptr [ECX + EBX*0x1]
0042bf4e : JZ 0x0042bf36
0042bf50 : MOV EBX,dword ptr [ESI + 0x8]
0042bf53 : LEA EAX,[ESI + 0x4]
0042bf56 : CMP EAX,EAX
0042bf58 : JZ 0x0042bf66
0042bf5a : XOR ECX,ECX
0042bf5c : MOV EDX,EAX
0042bf5e : CALL 0x0044f4f0
0042bf63 : MOV EDX,dword ptr [EBP + -0x8]
0042bf66 : MOV ECX,dword ptr [EDI + 0x4]
0042bf69 : MOV dword ptr [ECX],EDX
0042bf6b : MOV EAX,dword ptr [EDX + 0x4]
0042bf6e : MOV dword ptr [EAX],EBX
0042bf70 : MOV ECX,dword ptr [EBX + 0x4]
0042bf73 : MOV dword ptr [ECX],EDI
0042bf75 : MOV EAX,dword ptr [EBX + 0x4]
0042bf78 : MOV ECX,dword ptr [EDX + 0x4]
0042bf7b : MOV dword ptr [EBX + 0x4],ECX
0042bf7e : MOV ECX,dword ptr [EDI + 0x4]
0042bf81 : MOV dword ptr [EDX + 0x4],ECX
0042bf84 : MOV dword ptr [EDI + 0x4],EAX
0042bf87 : MOV EAX,dword ptr [ESI + 0x8]
0042bf8a : MOV ECX,dword ptr [ESI + 0x24]
0042bf8d : MOV EBX,dword ptr [ESI + 0x14]
0042bf90 : MOV EDI,dword ptr [EAX + 0x4]
0042bf93 : MOV dword ptr [EBX + ECX*0x4 + 0x4],EAX
0042bf97 : MOV ECX,dword ptr [EBP + -0x4]
0042bf9a : MOV EAX,dword ptr [ESI + 0x24]
0042bf9d : CMP ECX,EAX
0042bf9f : JNC 0x0042bfba
0042bfa1 : MOV ECX,dword ptr [ESI + 0x14]
0042bfa4 : MOV EBX,dword ptr [ECX + EAX*0x4]
0042bfa7 : LEA ECX,[ECX + EAX*0x4]
0042bfaa : CMP EBX,dword ptr [ESI + 0x8]
0042bfad : JNZ 0x0042bfb7
0042bfaf : DEC EAX
0042bfb0 : MOV dword ptr [ECX],EDI
0042bfb2 : CMP dword ptr [EBP + -0x4],EAX
0042bfb5 : JC 0x0042bfa1
0042bfb7 : MOV ECX,dword ptr [EBP + -0x4]
0042bfba : CMP EDX,dword ptr [ESI + 0x8]
0042bfbd : JZ 0x0042bfd5
0042bfbf : MOV EDI,EDX
0042bfc1 : MOV EDX,dword ptr [ESI + 0x14]
0042bfc4 : LEA EAX,[ECX*0x4 + 0x0]
0042bfcb : CMP EDI,dword ptr [EAX + EDX*0x1 + 0x4]
0042bfcf : JNZ 0x0042beb0
0042bfd5 : INC dword ptr [ESI + 0x24]
0042bfd8 : POP EDI
0042bfd9 : POP EBX
0042bfda : MOV ESP,EBP
0042bfdc : POP EBP
0042bfdd : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00568ba0
ENTRY    : 00568ba0
BODY     : [[00568ba0, 00568dd4]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00568ba0(int param_1)

{
  undefined1 *puVar1;
  int iVar2;
  int unaff_EBX;
  GRefCountNTSImpl *unaff_EBP;
  int *piVar3;
  int *piVar4;
  undefined4 uVar5;
  int local_64;
  int local_60;
  int *local_5c;
  undefined1 local_58 [4];
  undefined **ppuStack_54;
  undefined **ppuStack_48;
  undefined1 *puStack_44;
  int *piStack_40;
  undefined4 uStack_3c;
  undefined4 uStack_38;
  undefined1 uStack_34;
  undefined **local_30;
  int iStack_2c;
  int iStack_28;
  undefined **ppuStack_24;
  undefined1 *puStack_20;
  int *piStack_1c;
  undefined4 uStack_18;
  undefined4 uStack_14;
  undefined1 uStack_10;
  int iStack_c;
  int iStack_8;
  int iStack_4;
  
  puVar1 = *(undefined1 **)(param_1 + 4);
  local_5c = (int *)0x0;
  local_60 = 0;
  piVar4 = (int *)0x0;
  local_64 = 0;
  FUN_00526400();
  *puVar1 = 0;
  if (0 < *(int *)(param_1 + 0x1c)) {
    uVar5 = *(undefined4 *)(param_1 + 0x18);
    FUN_00526260(0);
    piVar4 = (int *)FUN_005270f0(uVar5);
    if (piVar4 != (int *)0x0) {
      iVar2 = (**(code **)(*piVar4 + 8))();
      if (iVar2 - 2U < 4) {
        local_60 = FUN_0054ecd0();
        if (local_60 != 0) {
          *(int *)(local_60 + 4) = *(int *)(local_60 + 4) + 1;
        }
      }
      else {
        local_5c = piVar4 + -4;
        if (local_5c != (int *)0x0) {
          piVar4[-2] = piVar4[-2] + 1U & 0x8fffffff;
        }
      }
    }
  }
  if (1 < *(int *)(param_1 + 0x1c)) {
    local_64 = *(int *)(param_1 + 0x1c) + -1;
  }
  local_58[0] = 0;
  if (*(int *)(param_1 + 0xc) == 0) {
    iVar2 = *(int *)(param_1 + 8);
    if (iVar2 == 0) {
      piVar3 = (int *)0x0;
    }
    else {
      piVar3 = (int *)(iVar2 + -0x10);
      if (piVar3 != (int *)0x0) {
        *(uint *)(iVar2 + -8) = *(int *)(iVar2 + -8) + 1U & 0x8fffffff;
      }
    }
    iStack_c = *(int *)(param_1 + 0x18);
    puStack_20 = local_58;
    iStack_4 = (*(int *)(iStack_c + 8) - *(int *)(iStack_c + 0xc) >> 4) +
               *(int *)(iStack_c + 0x1c) * 0x20 + -0x24;
    iStack_8 = local_64;
    ppuStack_24 = &PTR_FUN_00b8ab5c;
    uStack_10 = 0;
    uStack_18 = 0;
    uStack_14 = 0;
    piStack_1c = piVar4;
    (**(code **)(*piVar3 + 0x28))(&ppuStack_24,0,0);
    local_30 = &PTR_FUN_00b8ab5c;
    if ((((uint)piStack_1c & 2) == 0) && (ppuStack_24 != (undefined **)0x0)) {
      FUN_00503db0();
    }
    ppuStack_24 = (undefined **)0x0;
    if ((((uint)piStack_1c & 1) == 0) && (puStack_20 != (undefined1 *)0x0)) {
      FUN_00503db0();
    }
    FUN_00503db0();
  }
  else {
    local_30 = *(undefined ***)(param_1 + 0x18);
    iStack_2c = local_64;
    iStack_28 = ((int)local_30[2] - (int)local_30[3] >> 4) + (int)local_30[7] * 0x20 + -0x24;
    puStack_44 = local_58;
    ppuStack_48 = &PTR_FUN_00b8ab5c;
    uStack_34 = 0;
    uStack_3c = 0;
    uStack_38 = 0;
    piStack_40 = piVar4;
    (**(code **)(**(int **)(param_1 + 0xc) + 0x28))(&ppuStack_48,*(undefined4 *)(param_1 + 0x10),0);
    ppuStack_54 = &PTR_FUN_00b8ab5c;
    if ((((uint)piStack_40 & 2) == 0) && (ppuStack_48 != (undefined **)0x0)) {
      FUN_00503db0();
    }
    ppuStack_48 = (undefined **)0x0;
    if ((((uint)piStack_40 & 1) == 0) && (puStack_44 != (undefined1 *)0x0)) {
      FUN_00503db0();
    }
  }
  FUN_005268b0(&local_64);
  FUN_00526bc0();
  if (unaff_EBP != (GRefCountNTSImpl *)0x0) {
    GRefCountNTSImpl::Release(unaff_EBP);
  }
  if (unaff_EBX != 0) {
    FUN_00503db0();
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00568ba0 : SUB ESP,0x64
00568ba3 : PUSH EBX
00568ba4 : PUSH EBP
00568ba5 : PUSH ESI
00568ba6 : MOV ESI,dword ptr [ESP + 0x74]
00568baa : MOV EBP,dword ptr [ESI + 0x4]
00568bad : XOR EBX,EBX
00568baf : PUSH EDI
00568bb0 : MOV ECX,EBP
00568bb2 : MOV dword ptr [ESP + 0x18],EBX
00568bb6 : MOV dword ptr [ESP + 0x14],EBX
00568bba : XOR EDI,EDI
00568bbc : MOV dword ptr [ESP + 0x10],EBX
00568bc0 : CALL 0x00526400
00568bc5 : MOV byte ptr [EBP],BL
00568bc8 : MOV EBP,0x1
00568bcd : CMP dword ptr [ESI + 0x1c],EBP
00568bd0 : JL 0x00568c29
00568bd2 : MOV EAX,dword ptr [ESI + 0x18]
00568bd5 : PUSH EAX
00568bd6 : PUSH EBX
00568bd7 : MOV ECX,ESI
00568bd9 : CALL 0x00526260
00568bde : MOV ECX,EAX
00568be0 : CALL 0x005270f0
00568be5 : MOV EDI,EAX
00568be7 : CMP EDI,EBX
00568be9 : JZ 0x00568c29
00568beb : MOV EDX,dword ptr [EDI]
00568bed : MOV EAX,dword ptr [EDX + 0x8]
00568bf0 : MOV ECX,EDI
00568bf2 : CALL EAX
00568bf4 : ADD EAX,-0x2
00568bf7 : CMP EAX,0x3
00568bfa : JA 0x00568c10
00568bfc : MOV ECX,EDI
00568bfe : CALL 0x0054ecd0
00568c03 : CMP EAX,EBX
00568c05 : JZ 0x00568c0a
00568c07 : ADD dword ptr [EAX + 0x4],EBP
00568c0a : MOV dword ptr [ESP + 0x14],EAX
00568c0e : JMP 0x00568c29
00568c10 : LEA EAX,[EDI + -0x10]
00568c13 : CMP EAX,EBX
00568c15 : JZ 0x00568c25
00568c17 : MOV ECX,dword ptr [EAX + 0x8]
00568c1a : ADD ECX,EBP
00568c1c : AND ECX,0x8fffffff
00568c22 : MOV dword ptr [EAX + 0x8],ECX
00568c25 : MOV dword ptr [ESP + 0x18],EAX
00568c29 : MOV EAX,dword ptr [ESI + 0x1c]
00568c2c : CMP EAX,0x2
00568c2f : JL 0x00568c36
00568c31 : DEC EAX
00568c32 : MOV dword ptr [ESP + 0x10],EAX
00568c36 : MOV byte ptr [ESP + 0x1c],BL
00568c3a : CMP dword ptr [ESI + 0xc],EBX
00568c3d : JZ 0x00568ce1
00568c43 : MOV EAX,dword ptr [ESI + 0x18]
00568c46 : MOV EDX,dword ptr [EAX + 0x8]
00568c49 : SUB EDX,dword ptr [EAX + 0xc]
00568c4c : MOV ECX,dword ptr [EAX + 0x1c]
00568c4f : SAR EDX,0x4
00568c52 : SHL ECX,0x5
00568c55 : LEA ECX,[EDX + ECX*0x1 + -0x20]
00568c59 : MOV dword ptr [ESP + 0x44],EAX
00568c5d : MOV EAX,dword ptr [ESP + 0x10]
00568c61 : MOV dword ptr [ESP + 0x34],EDI
00568c65 : XOR EDI,EDI
00568c67 : MOV dword ptr [ESP + 0x48],EAX
00568c6b : MOV EAX,dword ptr [ESI + 0x10]
00568c6e : ADD ECX,-0x4
00568c71 : MOV dword ptr [ESP + 0x4c],ECX
00568c75 : MOV ECX,dword ptr [ESI + 0xc]
00568c78 : PUSH EDI
00568c79 : LEA EDX,[ESP + 0x20]
00568c7d : MOV EBX,0xb8ab5c
00568c82 : MOV dword ptr [ESP + 0x34],EDX
00568c86 : PUSH EAX
00568c87 : MOV dword ptr [ESP + 0x34],EBX
00568c8b : MOV byte ptr [ESP + 0x48],0x0
00568c90 : MOV dword ptr [ESP + 0x40],EDI
00568c94 : MOV dword ptr [ESP + 0x44],EDI
00568c98 : MOV EDX,dword ptr [ECX]
00568c9a : MOV EDX,dword ptr [EDX + 0x28]
00568c9d : LEA EAX,[ESP + 0x34]
00568ca1 : PUSH EAX
00568ca2 : CALL EDX
00568ca4 : TEST byte ptr [ESP + 0x40],0x2
00568ca9 : MOV dword ptr [ESP + 0x2c],EBX
00568cad : JNZ 0x00568cbc
00568caf : MOV ECX,dword ptr [ESP + 0x38]
00568cb3 : CMP ECX,EDI
00568cb5 : JZ 0x00568cbc
00568cb7 : CALL 0x00503db0
00568cbc : TEST byte ptr [ESP + 0x40],0x1
00568cc1 : MOV dword ptr [ESP + 0x38],EDI
00568cc5 : JNZ 0x00568d96
00568ccb : MOV ECX,dword ptr [ESP + 0x3c]
00568ccf : CMP ECX,EDI
00568cd1 : JZ 0x00568d96
00568cd7 : CALL 0x00503db0
00568cdc : JMP 0x00568d96
00568ce1 : MOV EBP,dword ptr [ESI + 0x8]
00568ce4 : CMP EBP,EBX
00568ce6 : JZ 0x00568dce
00568cec : ADD EBP,-0x10
00568cef : CMP EBP,EBX
00568cf1 : JZ 0x00568cff
00568cf3 : MOV EAX,dword ptr [EBP + 0x8]
00568cf6 : INC EAX
00568cf7 : AND EAX,0x8fffffff
00568cfc : MOV dword ptr [EBP + 0x8],EAX
00568cff : MOV EAX,dword ptr [ESI + 0x18]
00568d02 : MOV ECX,dword ptr [EAX + 0x8]
00568d05 : SUB ECX,dword ptr [EAX + 0xc]
00568d08 : MOV EDX,dword ptr [EAX + 0x1c]
00568d0b : SHL EDX,0x5
00568d0e : SAR ECX,0x4
00568d11 : LEA ECX,[ECX + EDX*0x1 + -0x20]
00568d15 : MOV dword ptr [ESP + 0x58],EDI
00568d19 : XOR EDI,EDI
00568d1b : MOV dword ptr [ESP + 0x68],EAX
00568d1f : MOV EAX,dword ptr [ESP + 0x10]
00568d23 : LEA EDX,[ESP + 0x1c]
00568d27 : PUSH EDI
00568d28 : MOV dword ptr [ESP + 0x58],EDX
00568d2c : MOV EDX,dword ptr [EBP]
00568d2f : MOV EDX,dword ptr [EDX + 0x28]
00568d32 : ADD ECX,-0x4
00568d35 : MOV dword ptr [ESP + 0x70],EAX
00568d39 : PUSH EDI
00568d3a : LEA EAX,[ESP + 0x58]
00568d3e : MOV dword ptr [ESP + 0x78],ECX
00568d42 : MOV EBX,0xb8ab5c
00568d47 : PUSH EAX
00568d48 : MOV ECX,EBP
00568d4a : MOV dword ptr [ESP + 0x5c],EBX
00568d4e : MOV byte ptr [ESP + 0x70],0x0
00568d53 : MOV dword ptr [ESP + 0x68],EDI
00568d57 : MOV dword ptr [ESP + 0x6c],EDI
00568d5b : CALL EDX
00568d5d : TEST byte ptr [ESP + 0x64],0x2
00568d62 : MOV dword ptr [ESP + 0x50],EBX
00568d66 : JNZ 0x00568d75
00568d68 : MOV ECX,dword ptr [ESP + 0x5c]
00568d6c : CMP ECX,EDI
00568d6e : JZ 0x00568d75
00568d70 : CALL 0x00503db0
00568d75 : TEST byte ptr [ESP + 0x64],0x1
00568d7a : MOV dword ptr [ESP + 0x5c],EDI
00568d7e : JNZ 0x00568d8d
00568d80 : MOV ECX,dword ptr [ESP + 0x60]
00568d84 : CMP ECX,EDI
00568d86 : JZ 0x00568d8d
00568d88 : CALL 0x00503db0
00568d8d : MOV ECX,EBP
00568d8f : CALL 0x00503db0
00568d94 : XOR EDI,EDI
00568d96 : MOV ECX,dword ptr [ESI + 0x4]
00568d99 : LEA EAX,[ESP + 0x1c]
00568d9d : PUSH EAX
00568d9e : CALL 0x005268b0
00568da3 : LEA ECX,[ESP + 0x1c]
00568da7 : CALL 0x00526bc0
00568dac : MOV ECX,dword ptr [ESP + 0x14]
00568db0 : CMP ECX,EDI
00568db2 : JZ 0x00568db9
00568db4 : CALL 0x004ff7c0
00568db9 : MOV ECX,dword ptr [ESP + 0x18]
00568dbd : CMP ECX,EDI
00568dbf : POP EDI
00568dc0 : POP ESI
00568dc1 : POP EBP
00568dc2 : POP EBX
00568dc3 : JZ 0x00568dca
00568dc5 : CALL 0x00503db0
00568dca : ADD ESP,0x64
00568dcd : RET
00568dce : XOR EBP,EBP
00568dd0 : JMP 0x00568cff

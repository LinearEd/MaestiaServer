PROGRAM  : Maestia.exe
FUNCTION : FUN_005b0590
ENTRY    : 005b0590
BODY     : [[005b0590, 005b06d7]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005b0590(undefined4 param_1,undefined4 *param_2,uint param_3)

{
  uint *puVar1;
  int *piVar2;
  int iVar3;
  uint *puVar4;
  uint uVar5;
  int *in_ECX;
  uint uVar6;
  int iVar7;
  
  piVar2 = (int *)*in_ECX;
  if (piVar2 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar2 * 5) <= piVar2[1] * 4 + 4U) goto LAB_005b05ca;
    iVar7 = piVar2[1] * 2 + 2;
  }
  FUN_005af810(param_1,iVar7);
LAB_005b05ca:
  piVar2 = (int *)*in_ECX;
  param_3 = param_3 & piVar2[1];
  *piVar2 = *piVar2 + 1;
  iVar7 = *in_ECX;
  iVar3 = *(int *)(iVar7 + 8 + param_3 * 0x14);
  puVar1 = (uint *)(iVar7 + 8 + param_3 * 0x14);
  if (iVar3 == -2) {
    *puVar1 = 0xffffffff;
    puVar1[2] = *(uint *)*param_2;
    puVar4 = (uint *)param_2[1];
    puVar1[3] = *puVar4;
    puVar1[4] = puVar4[1];
    puVar1[1] = param_3;
    return;
  }
  uVar6 = param_3;
  do {
    uVar6 = uVar6 + 1 & *(uint *)(iVar7 + 4);
  } while (*(int *)(iVar7 + 8 + uVar6 * 0x14) != -2);
  piVar2 = (int *)(iVar7 + 8 + uVar6 * 0x14);
  uVar5 = puVar1[1];
  if (uVar5 != param_3) {
    puVar4 = (uint *)(iVar7 + 8 + uVar5 * 0x14);
    for (uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x14); uVar5 != param_3;
        uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x14)) {
      uVar5 = *puVar4;
      puVar4 = (uint *)(iVar7 + 8 + uVar5 * 0x14);
    }
    if (piVar2 != (int *)0x0) {
      *piVar2 = iVar3;
      piVar2[1] = puVar1[1];
      piVar2[2] = puVar1[2];
      piVar2[3] = puVar1[3];
      piVar2[4] = puVar1[4];
    }
    *puVar4 = uVar6;
    puVar1[2] = *(uint *)*param_2;
    puVar4 = (uint *)param_2[1];
    puVar1[3] = *puVar4;
    puVar1[4] = puVar4[1];
    *puVar1 = 0xffffffff;
    puVar1[1] = param_3;
    return;
  }
  if (piVar2 != (int *)0x0) {
    *piVar2 = iVar3;
    piVar2[1] = puVar1[1];
    piVar2[2] = puVar1[2];
    piVar2[3] = puVar1[3];
    piVar2[4] = puVar1[4];
  }
  puVar1[2] = *(uint *)*param_2;
  puVar4 = (uint *)param_2[1];
  puVar1[3] = *puVar4;
  puVar1[4] = puVar4[1];
  *puVar1 = uVar6;
  puVar1[1] = param_3;
  return;
}



============================================================
DISASSEMBLY
============================================================
005b0590 : PUSH EBP
005b0591 : PUSH ESI
005b0592 : MOV ESI,ECX
005b0594 : MOV EAX,dword ptr [ESI]
005b0596 : TEST EAX,EAX
005b0598 : JNZ 0x005b05a3
005b059a : MOV EAX,dword ptr [ESP + 0xc]
005b059e : PUSH 0x8
005b05a0 : PUSH EAX
005b05a1 : JMP 0x005b05c5
005b05a3 : MOV ECX,dword ptr [EAX + 0x4]
005b05a6 : LEA EDX,[ECX*0x4 + 0x4]
005b05ad : MOV ECX,dword ptr [EAX]
005b05af : LEA ECX,[ECX + ECX*0x4]
005b05b2 : CMP ECX,EDX
005b05b4 : JBE 0x005b05ca
005b05b6 : MOV EDX,dword ptr [EAX + 0x4]
005b05b9 : MOV ECX,dword ptr [ESP + 0xc]
005b05bd : LEA EAX,[EDX + EDX*0x1 + 0x2]
005b05c1 : PUSH EAX
005b05c2 : PUSH ECX
005b05c3 : MOV ECX,ESI
005b05c5 : CALL 0x005af810
005b05ca : MOV EAX,dword ptr [ESI]
005b05cc : MOV ECX,dword ptr [ESP + 0x14]
005b05d0 : AND ECX,dword ptr [EAX + 0x4]
005b05d3 : INC dword ptr [EAX]
005b05d5 : MOV ESI,dword ptr [ESI]
005b05d7 : LEA EDX,[ECX + ECX*0x4]
005b05da : MOV EBP,dword ptr [ESI + EDX*0x4 + 0x8]
005b05de : LEA EAX,[ESI + EDX*0x4 + 0x8]
005b05e2 : CMP EBP,-0x2
005b05e5 : JNZ 0x005b060e
005b05e7 : MOV EDX,dword ptr [ESP + 0x10]
005b05eb : MOV dword ptr [EAX],0xffffffff
005b05f1 : MOV ESI,dword ptr [EDX]
005b05f3 : MOV ESI,dword ptr [ESI]
005b05f5 : MOV dword ptr [EAX + 0x8],ESI
005b05f8 : MOV EDX,dword ptr [EDX + 0x4]
005b05fb : MOV ESI,dword ptr [EDX]
005b05fd : MOV dword ptr [EAX + 0xc],ESI
005b0600 : MOV EDX,dword ptr [EDX + 0x4]
005b0603 : POP ESI
005b0604 : MOV dword ptr [EAX + 0x10],EDX
005b0607 : MOV dword ptr [EAX + 0x4],ECX
005b060a : POP EBP
005b060b : RET 0xc
005b060e : PUSH EDI
005b060f : MOV EDI,dword ptr [ESI + 0x4]
005b0612 : MOV EDX,ECX
005b0614 : PUSH EBX
005b0615 : INC EDX
005b0616 : AND EDX,EDI
005b0618 : LEA EBX,[EDX + EDX*0x4]
005b061b : CMP dword ptr [ESI + EBX*0x4 + 0x8],-0x2
005b0620 : JNZ 0x005b0615
005b0622 : LEA EDI,[EDX + EDX*0x4]
005b0625 : LEA EBX,[ESI + EDI*0x4 + 0x8]
005b0629 : MOV EDI,dword ptr [EAX + 0x4]
005b062c : CMP EDI,ECX
005b062e : JNZ 0x005b0673
005b0630 : TEST EBX,EBX
005b0632 : JZ 0x005b064e
005b0634 : MOV dword ptr [EBX],EBP
005b0636 : MOV ESI,dword ptr [EAX + 0x4]
005b0639 : MOV dword ptr [EBX + 0x4],ESI
005b063c : MOV ESI,dword ptr [EAX + 0x8]
005b063f : MOV dword ptr [EBX + 0x8],ESI
005b0642 : MOV ESI,dword ptr [EAX + 0xc]
005b0645 : MOV dword ptr [EBX + 0xc],ESI
005b0648 : MOV ESI,dword ptr [EAX + 0x10]
005b064b : MOV dword ptr [EBX + 0x10],ESI
005b064e : MOV ESI,dword ptr [ESP + 0x18]
005b0652 : MOV EDI,dword ptr [ESI]
005b0654 : MOV EDI,dword ptr [EDI]
005b0656 : MOV dword ptr [EAX + 0x8],EDI
005b0659 : MOV ESI,dword ptr [ESI + 0x4]
005b065c : MOV EDI,dword ptr [ESI]
005b065e : MOV dword ptr [EAX + 0xc],EDI
005b0661 : MOV ESI,dword ptr [ESI + 0x4]
005b0664 : POP EBX
005b0665 : MOV dword ptr [EAX + 0x10],ESI
005b0668 : POP EDI
005b0669 : POP ESI
005b066a : MOV dword ptr [EAX],EDX
005b066c : MOV dword ptr [EAX + 0x4],ECX
005b066f : POP EBP
005b0670 : RET 0xc
005b0673 : LEA EDI,[EDI + EDI*0x4]
005b0676 : CMP dword ptr [ESI + EDI*0x4 + 0x8],ECX
005b067a : LEA EDI,[ESI + EDI*0x4 + 0x8]
005b067e : JZ 0x005b068f
005b0680 : MOV EDI,dword ptr [EDI]
005b0682 : LEA EDI,[EDI + EDI*0x4]
005b0685 : CMP dword ptr [ESI + EDI*0x4 + 0x8],ECX
005b0689 : LEA EDI,[ESI + EDI*0x4 + 0x8]
005b068d : JNZ 0x005b0680
005b068f : TEST EBX,EBX
005b0691 : JZ 0x005b06ad
005b0693 : MOV dword ptr [EBX],EBP
005b0695 : MOV ESI,dword ptr [EAX + 0x4]
005b0698 : MOV dword ptr [EBX + 0x4],ESI
005b069b : MOV ESI,dword ptr [EAX + 0x8]
005b069e : MOV dword ptr [EBX + 0x8],ESI
005b06a1 : MOV ESI,dword ptr [EAX + 0xc]
005b06a4 : MOV dword ptr [EBX + 0xc],ESI
005b06a7 : MOV ESI,dword ptr [EAX + 0x10]
005b06aa : MOV dword ptr [EBX + 0x10],ESI
005b06ad : MOV dword ptr [EDI],EDX
005b06af : MOV EDX,dword ptr [ESP + 0x18]
005b06b3 : MOV ESI,dword ptr [EDX]
005b06b5 : MOV ESI,dword ptr [ESI]
005b06b7 : MOV dword ptr [EAX + 0x8],ESI
005b06ba : MOV EDX,dword ptr [EDX + 0x4]
005b06bd : MOV ESI,dword ptr [EDX]
005b06bf : POP EBX
005b06c0 : MOV dword ptr [EAX + 0xc],ESI
005b06c3 : MOV EDX,dword ptr [EDX + 0x4]
005b06c6 : POP EDI
005b06c7 : MOV dword ptr [EAX + 0x10],EDX
005b06ca : POP ESI
005b06cb : MOV dword ptr [EAX],0xffffffff
005b06d1 : MOV dword ptr [EAX + 0x4],ECX
005b06d4 : POP EBP
005b06d5 : RET 0xc

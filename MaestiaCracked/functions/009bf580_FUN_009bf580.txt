PROGRAM  : Maestia.exe
FUNCTION : FUN_009bf580
ENTRY    : 009bf580
BODY     : [[009bf580, 009bfe97]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009bf580(int param_1,undefined4 param_2)

{
  short sVar1;
  wchar_t wVar2;
  uint uVar3;
  int *piVar4;
  float fVar5;
  short ****ppppsVar6;
  int iVar7;
  undefined4 uVar8;
  int iVar9;
  short ****ppppsVar10;
  undefined4 uVar11;
  wchar_t *pwVar12;
  wchar_t *pwVar13;
  wchar_t *pwVar14;
  undefined *puVar15;
  bool bVar16;
  undefined8 uVar17;
  undefined1 auStack_ec [8];
  int *local_e4;
  longlong local_e0;
  undefined1 local_d4 [4];
  int local_d0;
  int local_cc;
  undefined4 uStack_c8;
  undefined1 local_c4 [4];
  undefined4 local_c0;
  int local_bc;
  undefined4 local_b0;
  uint local_ac;
  undefined1 local_a8 [28];
  undefined1 local_8c [28];
  undefined1 local_70 [4];
  undefined2 local_6c;
  undefined4 local_5c;
  uint local_58;
  short ***local_50 [4];
  undefined4 uStack_40;
  uint local_3c;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  int local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b4675d;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_ec;
  ExceptionList = &local_14;
  FUN_00403dd0(param_2,DAT_00d66fa0 ^ (uint)&stack0xffffff08);
  local_c = 0;
  local_58 = 7;
  local_5c = 0;
  local_6c = 0;
  FUN_00406360(&DAT_00c8f1b4,1);
  local_c._0_1_ = 1;
  ppppsVar10 = (short ****)local_50[0];
  if (local_3c < 8) {
    ppppsVar10 = local_50;
  }
  local_ac = 7;
  local_b0 = 0;
  local_c0._0_2_ = 0;
  ppppsVar6 = ppppsVar10;
  do {
    sVar1 = *(short *)ppppsVar6;
    ppppsVar6 = (short ****)((int)ppppsVar6 + 2);
  } while (sVar1 != 0);
  FUN_00406360(ppppsVar10,(int)ppppsVar6 - (int)((int)ppppsVar10 + 2) >> 1);
  local_c._0_1_ = 2;
  FUN_0070cd60(local_d4,local_c4,local_70,0);
  local_c = CONCAT31(local_c._1_3_,4);
  if (7 < local_ac) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_ac = 7;
  local_b0 = 0;
  local_c0 = (uint)local_c0._2_2_ << 0x10;
  local_c._0_1_ = 5;
  if (7 < local_58) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_6c = 0;
  local_58 = 7;
  local_5c = 0;
  iVar7 = FUN_00405bb0(L"onInit");
  if (iVar7 == 0) {
    uVar8 = FUN_00702a00();
    iVar9 = FUN_00702b50(uVar8);
    iVar7 = *DAT_00da9894;
    if ((iVar7 != 0) && (*(int *)(iVar7 + 0x114) != 0)) {
      (**(code **)(**(int **)(iVar7 + 0x114) + 4))
                (*(int **)(iVar7 + 0x114),"mc_charpetregpopup.SetMinPrice",&DAT_00c8f1c8,iVar9);
    }
    iVar7 = *DAT_00da9894;
    if ((iVar7 != 0) && (*(int *)(iVar7 + 0x114) != 0)) {
      (**(code **)(**(int **)(iVar7 + 0x114) + 4))
                (*(int **)(iVar7 + 0x114),"mc_charpetregpopup.SetMaxPrice",&DAT_00c8f1ec,1000);
    }
    uVar8 = FUN_00702e30(uVar8);
    fVar5 = (float)iVar9;
    if (iVar9 < 0) {
      fVar5 = fVar5 + 4.2949673e+09;
    }
    iVar7 = *DAT_00da9894;
    local_e0 = (longlong)ROUND(fVar5 * 0.05);
    if ((iVar7 != 0) && (*(int *)(iVar7 + 0x114) != 0)) {
      (**(code **)(**(int **)(iVar7 + 0x114) + 4))
                (*(int **)(iVar7 + 0x114),"mc_charpetregpopup.SetPriceInfo","%d,%d",uVar8,
                 (undefined4)local_e0);
    }
    local_e4[0x15] = iVar9;
  }
  else {
    iVar7 = FUN_00405bb0(L"PriceChange");
    if (iVar7 == 0) {
      iVar7 = local_cc - local_d0 >> 0x1f;
      if ((local_cc - local_d0) / 0x1c + iVar7 == iVar7) {
        iVar7 = 0;
      }
      else {
        if (*(uint *)(local_d0 + 0x18) < 8) {
          iVar7 = local_d0 + 4;
        }
        else {
          iVar7 = *(int *)(local_d0 + 4);
        }
        iVar7 = FUN_00634f4d(iVar7);
      }
      if (1 < (uint)((local_cc - local_d0) / 0x1c)) {
        if (*(uint *)(local_d0 + 0x34) < 8) {
          FUN_00634f4d(local_d0 + 0x20);
        }
        else {
          FUN_00634f4d(*(undefined4 *)(local_d0 + 0x20));
        }
      }
      uVar8 = FUN_00702a00();
      FUN_00702e30(uVar8);
      uVar17 = FUN_007029c0();
      iVar9 = *DAT_00da9894;
      if ((iVar9 != 0) && (*(int *)(iVar9 + 0x114) != 0)) {
        (**(code **)(**(int **)(iVar9 + 0x114) + 4))
                  (*(int **)(iVar9 + 0x114),"mc_charpetregpopup.SetPriceInfo","%d,%d",
                   (int)((ulonglong)uVar17 >> 0x20),(int)uVar17);
      }
      local_e4[0x15] = iVar7;
    }
    else {
      iVar7 = FUN_00405bb0(L"RegDurationChange");
      if (iVar7 == 0) {
        iVar7 = local_cc - local_d0 >> 0x1f;
        if ((local_cc - local_d0) / 0x1c + iVar7 != iVar7) {
          if (*(uint *)(local_d0 + 0x18) < 8) {
            FUN_00634f4d(local_d0 + 4);
          }
          else {
            FUN_00634f4d(*(undefined4 *)(local_d0 + 4));
          }
        }
        uVar8 = FUN_00702a00();
        FUN_00702e30(uVar8);
        uVar17 = FUN_007029c0();
        iVar7 = *DAT_00da9894;
        if ((iVar7 != 0) && (*(int *)(iVar7 + 0x114) != 0)) {
          (**(code **)(**(int **)(iVar7 + 0x114) + 4))
                    (*(int **)(iVar7 + 0x114),"mc_charpetregpopup.SetPriceInfo","%d,%d",
                     (int)((ulonglong)uVar17 >> 0x20),(int)uVar17);
        }
      }
      else {
        uVar3 = *(uint *)(param_1 + 0x18);
        pwVar14 = (wchar_t *)(param_1 + 4);
        pwVar13 = pwVar14;
        if (7 < uVar3) {
          pwVar13 = *(wchar_t **)pwVar14;
        }
        pwVar12 = L"Ok";
        do {
          wVar2 = *pwVar13;
          bVar16 = (ushort)wVar2 < (ushort)*pwVar12;
          if (wVar2 != *pwVar12) {
LAB_009bfa36:
            iVar7 = (1 - (uint)bVar16) - (uint)(bVar16 != 0);
            goto LAB_009bfa3b;
          }
          if (wVar2 == L'\0') break;
          wVar2 = pwVar13[1];
          bVar16 = (ushort)wVar2 < (ushort)pwVar12[1];
          if (wVar2 != pwVar12[1]) goto LAB_009bfa36;
          pwVar13 = pwVar13 + 2;
          pwVar12 = pwVar12 + 2;
        } while (wVar2 != L'\0');
        iVar7 = 0;
LAB_009bfa3b:
        if (iVar7 == 0) {
          FUN_00406460(&DAT_00c8f2cc);
          local_c._0_1_ = 6;
          ppppsVar10 = (short ****)local_50[0];
          if (local_3c < 8) {
            ppppsVar10 = local_50;
          }
          FUN_00406460(ppppsVar10);
          local_c._0_1_ = 7;
          FUN_0070cd60(local_c4,local_8c,local_a8,0);
          local_c._0_1_ = 9;
          FUN_00406560();
          local_c._0_1_ = 10;
          FUN_00406560();
          iVar7 = local_bc - local_c0 >> 0x1f;
          if ((local_bc - local_c0) / 0x1c + iVar7 == iVar7) {
            puVar15 = &DAT_00c8f2d0;
          }
          else if (*(uint *)(local_c0 + 0x18) < 8) {
            puVar15 = (undefined *)(local_c0 + 4);
          }
          else {
            puVar15 = *(undefined **)(local_c0 + 4);
          }
          FUN_00406460(puVar15);
          local_c = CONCAT31(local_c._1_3_,0xb);
          if ((uint)((local_bc - local_c0) / 0x1c) < 2) {
            uVar8 = 0;
          }
          else {
            if (*(uint *)(local_c0 + 0x34) < 8) {
              iVar7 = local_c0 + 0x20;
            }
            else {
              iVar7 = *(int *)(local_c0 + 0x20);
            }
            uVar8 = FUN_00634f4d(iVar7);
          }
          if ((uint)((local_bc - local_c0) / 0x1c) < 3) {
            uVar11 = 0;
          }
          else if (*(uint *)(local_c0 + 0x50) < 8) {
            uVar11 = FUN_00634f4d(local_c0 + 0x3c);
          }
          else {
            uVar11 = FUN_00634f4d(*(undefined4 *)(local_c0 + 0x3c));
          }
          iVar7 = FUN_006f0300(0x30);
          local_e0 = CONCAT44(local_e0._4_4_,iVar7);
          local_c._0_1_ = 0xc;
          if (iVar7 == 0) {
            uVar8 = 0;
          }
          else {
            uVar8 = FUN_0041eaf0(iVar7,uVar8,uVar11);
          }
          local_c._0_1_ = 0xb;
          FUN_00406460(L"IDS_CHARPET_REGISTER");
          local_c._0_1_ = 0xd;
          FUN_0081d120(local_a8);
          local_c._0_1_ = 0xf;
          FUN_00406560();
          iVar7 = FUN_008ede80(local_70,2);
          if (iVar7 == 0) {
            local_c._0_1_ = 0xb;
            FUN_00406560();
            local_c._0_1_ = 10;
            FUN_00406560();
            local_c._0_1_ = 5;
            FUN_004042c0();
            local_c = (uint)local_c._1_3_ << 8;
            FUN_004042c0();
            local_c = 0xffffffff;
            FUN_00406560();
            goto LAB_009bfe72;
          }
          *(undefined4 *)(iVar7 + 0x6c) = uVar8;
          *(undefined4 *)(iVar7 + 0x70) = 4;
          if (*(code **)(iVar7 + 0x60) != (code *)0x0) {
            (**(code **)(iVar7 + 0x60))(1,iVar7);
          }
          *(code **)(iVar7 + 0x60) = FUN_009be0e0;
          local_c._0_1_ = 0xb;
          FUN_00406560();
          local_c._0_1_ = 10;
          FUN_00406560();
          local_c._0_1_ = 5;
          FUN_004042c0();
        }
        else {
          pwVar13 = pwVar14;
          if (7 < uVar3) {
            pwVar13 = *(wchar_t **)pwVar14;
          }
          pwVar12 = L"Close";
          do {
            wVar2 = *pwVar13;
            bVar16 = (ushort)wVar2 < (ushort)*pwVar12;
            if (wVar2 != *pwVar12) {
LAB_009bfd16:
              iVar7 = (1 - (uint)bVar16) - (uint)(bVar16 != 0);
              goto LAB_009bfd1b;
            }
            if (wVar2 == L'\0') break;
            wVar2 = pwVar13[1];
            bVar16 = (ushort)wVar2 < (ushort)pwVar12[1];
            if (wVar2 != pwVar12[1]) goto LAB_009bfd16;
            pwVar13 = pwVar13 + 2;
            pwVar12 = pwVar12 + 2;
          } while (wVar2 != L'\0');
          iVar7 = 0;
LAB_009bfd1b:
          if (iVar7 == 0) {
            (**(code **)(*local_e4 + 0x20))();
          }
          else {
            if (7 < uVar3) {
              pwVar14 = *(wchar_t **)pwVar14;
            }
            pwVar13 = L"ErrorMoney";
            do {
              wVar2 = *pwVar14;
              bVar16 = (ushort)wVar2 < (ushort)*pwVar13;
              if (wVar2 != *pwVar13) {
LAB_009bfd66:
                iVar7 = (1 - (uint)bVar16) - (uint)(bVar16 != 0);
                goto LAB_009bfd6b;
              }
              if (wVar2 == L'\0') break;
              wVar2 = pwVar14[1];
              bVar16 = (ushort)wVar2 < (ushort)pwVar13[1];
              if (wVar2 != pwVar13[1]) goto LAB_009bfd66;
              pwVar14 = pwVar14 + 2;
              pwVar13 = pwVar13 + 2;
            } while (wVar2 != L'\0');
            iVar7 = 0;
LAB_009bfd6b:
            if ((((iVar7 == 0) && (DAT_0172491c != 0)) && (*DAT_00da9894 != 0)) &&
               (*(int *)(*DAT_00da9894 + 0x1a8) != 0)) {
              FUN_00406460(L"IDS_CHARPET_REGIST_INVALID_MONEY");
              local_c._0_1_ = 0x10;
              piVar4 = *(int **)(*DAT_00da9894 + 0x1a8);
              uVar8 = FUN_0081d120(local_a8);
              local_c._0_1_ = 0x11;
              (**(code **)(*piVar4 + 0x44))(uVar8,3);
              local_c._0_1_ = 0x10;
              FUN_00406560();
              local_c._0_1_ = 5;
              FUN_00406560();
            }
          }
        }
      }
    }
  }
  local_c = (uint)local_c._1_3_ << 8;
  if (local_d0 != 0) {
    FUN_00405450((undefined4)local_e0);
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_d0 = 0;
  local_cc = 0;
  uStack_c8 = 0;
  local_c = 0xffffffff;
  if (7 < local_3c) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_3c = 7;
  uStack_40 = 0;
  local_50[0] = (short ***)((uint)local_50[0] & 0xffff0000);
LAB_009bfe72:
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_ec);
  return;
}



============================================================
DISASSEMBLY
============================================================
009bf580 : PUSH EBP
009bf581 : MOV EBP,ESP
009bf583 : AND ESP,0xfffffff8
009bf586 : PUSH -0x1
009bf588 : PUSH 0xb4675d
009bf58d : MOV EAX,FS:[0x0]
009bf593 : PUSH EAX
009bf594 : SUB ESP,0xd8
009bf59a : MOV EAX,[0x00d66fa0]
009bf59f : XOR EAX,ESP
009bf5a1 : MOV dword ptr [ESP + 0xd0],EAX
009bf5a8 : PUSH EBX
009bf5a9 : PUSH ESI
009bf5aa : PUSH EDI
009bf5ab : MOV EAX,[0x00d66fa0]
009bf5b0 : XOR EAX,ESP
009bf5b2 : PUSH EAX
009bf5b3 : LEA EAX,[ESP + 0xe8]
009bf5ba : MOV FS:[0x0],EAX
009bf5c0 : MOV EAX,dword ptr [EBP + 0xc]
009bf5c3 : MOV EBX,dword ptr [EBP + 0x8]
009bf5c6 : PUSH EAX
009bf5c7 : LEA ESI,[ESP + 0xac]
009bf5ce : MOV dword ptr [ESP + 0x1c],ECX
009bf5d2 : CALL 0x00403dd0
009bf5d7 : ADD ESP,0x4
009bf5da : XOR ESI,ESI
009bf5dc : MOV dword ptr [ESP + 0xf0],ESI
009bf5e3 : PUSH 0x1
009bf5e5 : XOR EAX,EAX
009bf5e7 : MOV EDI,0x7
009bf5ec : PUSH 0xc8f1b4
009bf5f1 : LEA ECX,[ESP + 0x94]
009bf5f8 : MOV dword ptr [ESP + 0xac],EDI
009bf5ff : MOV dword ptr [ESP + 0xa8],ESI
009bf606 : MOV word ptr [ESP + 0x98],AX
009bf60e : CALL 0x00406360
009bf613 : MOV byte ptr [ESP + 0xf0],0x1
009bf61b : CMP dword ptr [ESP + 0xc0],0x8
009bf623 : MOV EDX,dword ptr [ESP + 0xac]
009bf62a : JNC 0x009bf633
009bf62c : LEA EDX,[ESP + 0xac]
009bf633 : XOR ECX,ECX
009bf635 : MOV EAX,EDX
009bf637 : MOV dword ptr [ESP + 0x50],EDI
009bf63b : MOV dword ptr [ESP + 0x4c],ESI
009bf63f : MOV word ptr [ESP + 0x3c],CX
009bf644 : LEA EDI,[EAX + 0x2]
009bf647 : MOV CX,word ptr [EAX]
009bf64a : ADD EAX,0x2
009bf64d : CMP CX,SI
009bf650 : JNZ 0x009bf647
009bf652 : SUB EAX,EDI
009bf654 : SAR EAX,0x1
009bf656 : PUSH EAX
009bf657 : PUSH EDX
009bf658 : LEA ECX,[ESP + 0x40]
009bf65c : CALL 0x00406360
009bf661 : MOV byte ptr [ESP + 0xf0],0x2
009bf669 : PUSH ESI
009bf66a : LEA EDX,[ESP + 0x90]
009bf671 : PUSH EDX
009bf672 : LEA EAX,[ESP + 0x40]
009bf676 : PUSH EAX
009bf677 : LEA ECX,[ESP + 0x34]
009bf67b : PUSH ECX
009bf67c : CALL 0x0070cd60
009bf681 : ADD ESP,0x10
009bf684 : MOV byte ptr [ESP + 0xf0],0x4
009bf68c : MOV EDI,0x8
009bf691 : CMP dword ptr [ESP + 0x50],EDI
009bf695 : JC 0x009bf6a0
009bf697 : MOV ECX,dword ptr [ESP + 0x3c]
009bf69b : CALL 0x006f04e0
009bf6a0 : XOR EDX,EDX
009bf6a2 : MOV dword ptr [ESP + 0x50],0x7
009bf6aa : MOV dword ptr [ESP + 0x4c],ESI
009bf6ae : MOV word ptr [ESP + 0x3c],DX
009bf6b3 : MOV byte ptr [ESP + 0xf0],0x5
009bf6bb : CMP dword ptr [ESP + 0xa4],EDI
009bf6c2 : JC 0x009bf6d0
009bf6c4 : MOV ECX,dword ptr [ESP + 0x90]
009bf6cb : CALL 0x006f04e0
009bf6d0 : XOR EAX,EAX
009bf6d2 : XOR ESI,ESI
009bf6d4 : MOV word ptr [ESP + 0x90],AX
009bf6dc : MOV EAX,dword ptr [EBX + 0x14]
009bf6df : PUSH 0xc8f1b8
009bf6e4 : LEA EDI,[ESI + 0x6]
009bf6e7 : MOV ECX,EBX
009bf6e9 : MOV dword ptr [ESP + 0xa8],0x7
009bf6f4 : MOV dword ptr [ESP + 0xa4],ESI
009bf6fb : CALL 0x00405bb0
009bf700 : TEST EAX,EAX
009bf702 : JNZ 0x009bf814
009bf708 : MOV ECX,dword ptr [0x0172491c]
009bf70e : MOV EAX,dword ptr [ECX + 0x17c]
009bf714 : MOV EAX,dword ptr [EAX + 0xa0]
009bf71a : CALL 0x00702a00
009bf71f : MOV EDI,EAX
009bf721 : PUSH EDI
009bf722 : CALL 0x00702b50
009bf727 : MOV EDX,dword ptr [0x00da9894]
009bf72d : MOV EBX,EAX
009bf72f : MOV EAX,dword ptr [EDX]
009bf731 : ADD ESP,0x4
009bf734 : CMP EAX,ESI
009bf736 : JZ 0x009bf75c
009bf738 : CMP dword ptr [EAX + 0x114],ESI
009bf73e : JZ 0x009bf75c
009bf740 : MOV EAX,dword ptr [EAX + 0x114]
009bf746 : MOV ECX,dword ptr [EAX]
009bf748 : MOV EDX,dword ptr [ECX + 0x4]
009bf74b : PUSH EBX
009bf74c : PUSH 0xc8f1c8
009bf751 : PUSH 0xc8f1cc
009bf756 : PUSH EAX
009bf757 : CALL EDX
009bf759 : ADD ESP,0x10
009bf75c : MOV EAX,[0x00da9894]
009bf761 : MOV EAX,dword ptr [EAX]
009bf763 : CMP EAX,ESI
009bf765 : JZ 0x009bf78f
009bf767 : CMP dword ptr [EAX + 0x114],ESI
009bf76d : JZ 0x009bf78f
009bf76f : MOV EAX,dword ptr [EAX + 0x114]
009bf775 : MOV ECX,dword ptr [EAX]
009bf777 : MOV EDX,dword ptr [ECX + 0x4]
009bf77a : PUSH 0x3e8
009bf77f : PUSH 0xc8f1ec
009bf784 : PUSH 0xc8f1f0
009bf789 : PUSH EAX
009bf78a : CALL EDX
009bf78c : ADD ESP,0x10
009bf78f : PUSH EDI
009bf790 : XOR EAX,EAX
009bf792 : CALL 0x00702e30
009bf797 : MOV ECX,EAX
009bf799 : MOV EAX,EBX
009bf79b : ADD ESP,0x4
009bf79e : MOV dword ptr [ESP + 0x1c],EAX
009bf7a2 : FILD dword ptr [ESP + 0x1c]
009bf7a6 : TEST EAX,EAX
009bf7a8 : JGE 0x009bf7b0
009bf7aa : FADD float ptr [0x00cdf0e0]
009bf7b0 : FMUL float ptr [0x00cdf0f4]
009bf7b6 : FNSTCW word ptr [ESP + 0x16]
009bf7ba : MOVZX EAX,word ptr [ESP + 0x16]
009bf7bf : OR EAX,0xc00
009bf7c4 : MOV dword ptr [ESP + 0x1c],EAX
009bf7c8 : MOV EAX,[0x00da9894]
009bf7cd : FLDCW word ptr [ESP + 0x1c]
009bf7d1 : MOV EAX,dword ptr [EAX]
009bf7d3 : FISTP qword ptr [ESP + 0x1c]
009bf7d7 : MOV EDX,dword ptr [ESP + 0x1c]
009bf7db : FLDCW word ptr [ESP + 0x16]
009bf7df : CMP EAX,ESI
009bf7e1 : JZ 0x009bf808
009bf7e3 : CMP dword ptr [EAX + 0x114],ESI
009bf7e9 : JZ 0x009bf808
009bf7eb : MOV EAX,dword ptr [EAX + 0x114]
009bf7f1 : MOV EDI,dword ptr [EAX]
009bf7f3 : PUSH EDX
009bf7f4 : PUSH ECX
009bf7f5 : MOV ECX,dword ptr [EDI + 0x4]
009bf7f8 : PUSH 0xc8f210
009bf7fd : PUSH 0xc8f218
009bf802 : PUSH EAX
009bf803 : CALL ECX
009bf805 : ADD ESP,0x14
009bf808 : MOV EDX,dword ptr [ESP + 0x18]
009bf80c : MOV dword ptr [EDX + 0x54],EBX
009bf80f : JMP 0x009bfdff
009bf814 : MOV EAX,dword ptr [EBX + 0x14]
009bf817 : PUSH 0xc8f238
009bf81c : MOV EDI,0xb
009bf821 : MOV ECX,EBX
009bf823 : CALL 0x00405bb0
009bf828 : TEST EAX,EAX
009bf82a : JNZ 0x009bf923
009bf830 : MOV ESI,dword ptr [ESP + 0x30]
009bf834 : MOV EDI,dword ptr [ESP + 0x2c]
009bf838 : MOV ECX,ESI
009bf83a : SUB ECX,EDI
009bf83c : MOV EAX,0x92492493
009bf841 : IMUL ECX
009bf843 : ADD EDX,ECX
009bf845 : SAR EDX,0x4
009bf848 : MOV EAX,EDX
009bf84a : SHR EAX,0x1f
009bf84d : ADD EAX,EDX
009bf84f : JZ 0x009bf874
009bf851 : CMP dword ptr [EDI + 0x18],0x8
009bf855 : JC 0x009bf85c
009bf857 : MOV EDI,dword ptr [EDI + 0x4]
009bf85a : JMP 0x009bf85f
009bf85c : ADD EDI,0x4
009bf85f : PUSH EDI
009bf860 : CALL 0x00634f4d
009bf865 : MOV ESI,dword ptr [ESP + 0x34]
009bf869 : MOV EDI,dword ptr [ESP + 0x30]
009bf86d : ADD ESP,0x4
009bf870 : MOV EBX,EAX
009bf872 : JMP 0x009bf876
009bf874 : XOR EBX,EBX
009bf876 : SUB ESI,EDI
009bf878 : MOV EAX,0x92492493
009bf87d : IMUL ESI
009bf87f : ADD EDX,ESI
009bf881 : SAR EDX,0x4
009bf884 : MOV ECX,EDX
009bf886 : SHR ECX,0x1f
009bf889 : ADD ECX,EDX
009bf88b : CMP ECX,0x1
009bf88e : JBE 0x009bf8b6
009bf890 : CMP dword ptr [EDI + 0x34],0x8
009bf894 : JC 0x009bf8a6
009bf896 : MOV EDI,dword ptr [EDI + 0x20]
009bf899 : PUSH EDI
009bf89a : CALL 0x00634f4d
009bf89f : ADD ESP,0x4
009bf8a2 : MOV ESI,EAX
009bf8a4 : JMP 0x009bf8b8
009bf8a6 : ADD EDI,0x20
009bf8a9 : PUSH EDI
009bf8aa : CALL 0x00634f4d
009bf8af : ADD ESP,0x4
009bf8b2 : MOV ESI,EAX
009bf8b4 : JMP 0x009bf8b8
009bf8b6 : XOR ESI,ESI
009bf8b8 : MOV EDX,dword ptr [0x0172491c]
009bf8be : MOV EAX,dword ptr [EDX + 0x17c]
009bf8c4 : MOV EAX,dword ptr [EAX + 0xa0]
009bf8ca : CALL 0x00702a00
009bf8cf : PUSH EAX
009bf8d0 : MOV EAX,ESI
009bf8d2 : CALL 0x00702e30
009bf8d7 : MOV EDX,EAX
009bf8d9 : ADD ESP,0x4
009bf8dc : MOV EAX,EBX
009bf8de : CALL 0x007029c0
009bf8e3 : MOV ECX,dword ptr [0x00da9894]
009bf8e9 : MOV ECX,dword ptr [ECX]
009bf8eb : TEST ECX,ECX
009bf8ed : JZ 0x009bf915
009bf8ef : CMP dword ptr [ECX + 0x114],0x0
009bf8f6 : JZ 0x009bf915
009bf8f8 : MOV ECX,dword ptr [ECX + 0x114]
009bf8fe : MOV ESI,dword ptr [ECX]
009bf900 : PUSH EAX
009bf901 : PUSH EDX
009bf902 : MOV EDX,dword ptr [ESI + 0x4]
009bf905 : PUSH 0xc8f250
009bf90a : PUSH 0xc8f258
009bf90f : PUSH ECX
009bf910 : CALL EDX
009bf912 : ADD ESP,0x14
009bf915 : MOV EAX,dword ptr [ESP + 0x18]
009bf919 : MOV dword ptr [EAX + 0x54],EBX
009bf91c : XOR ESI,ESI
009bf91e : JMP 0x009bfdff
009bf923 : MOV EAX,dword ptr [EBX + 0x14]
009bf926 : PUSH 0xc8f278
009bf92b : MOV EDI,0x11
009bf930 : MOV ECX,EBX
009bf932 : CALL 0x00405bb0
009bf937 : TEST EAX,EAX
009bf939 : JNZ 0x009bf9f4
009bf93f : MOV ECX,dword ptr [ESP + 0x30]
009bf943 : MOV EDI,dword ptr [ESP + 0x2c]
009bf947 : SUB ECX,EDI
009bf949 : MOV EAX,0x92492493
009bf94e : IMUL ECX
009bf950 : ADD EDX,ECX
009bf952 : SAR EDX,0x4
009bf955 : MOV ECX,EDX
009bf957 : SHR ECX,0x1f
009bf95a : ADD ECX,EDX
009bf95c : JZ 0x009bf984
009bf95e : CMP dword ptr [EDI + 0x18],0x8
009bf962 : JC 0x009bf974
009bf964 : MOV EDI,dword ptr [EDI + 0x4]
009bf967 : PUSH EDI
009bf968 : CALL 0x00634f4d
009bf96d : ADD ESP,0x4
009bf970 : MOV EDI,EAX
009bf972 : JMP 0x009bf986
009bf974 : ADD EDI,0x4
009bf977 : PUSH EDI
009bf978 : CALL 0x00634f4d
009bf97d : ADD ESP,0x4
009bf980 : MOV EDI,EAX
009bf982 : JMP 0x009bf986
009bf984 : XOR EDI,EDI
009bf986 : MOV EDX,dword ptr [0x0172491c]
009bf98c : MOV EAX,dword ptr [EDX + 0x17c]
009bf992 : MOV EAX,dword ptr [EAX + 0xa0]
009bf998 : CALL 0x00702a00
009bf99d : PUSH EAX
009bf99e : MOV EAX,EDI
009bf9a0 : CALL 0x00702e30
009bf9a5 : MOV EDX,EAX
009bf9a7 : MOV EAX,dword ptr [ESP + 0x1c]
009bf9ab : MOV EAX,dword ptr [EAX + 0x54]
009bf9ae : ADD ESP,0x4
009bf9b1 : CALL 0x007029c0
009bf9b6 : MOV ECX,dword ptr [0x00da9894]
009bf9bc : MOV ECX,dword ptr [ECX]
009bf9be : CMP ECX,ESI
009bf9c0 : JZ 0x009bfdff
009bf9c6 : CMP dword ptr [ECX + 0x114],ESI
009bf9cc : JZ 0x009bfdff
009bf9d2 : MOV ECX,dword ptr [ECX + 0x114]
009bf9d8 : MOV EDI,dword ptr [ECX]
009bf9da : PUSH EAX
009bf9db : PUSH EDX
009bf9dc : MOV EDX,dword ptr [EDI + 0x4]
009bf9df : PUSH 0xc8f29c
009bf9e4 : PUSH 0xc8f2a4
009bf9e9 : PUSH ECX
009bf9ea : CALL EDX
009bf9ec : ADD ESP,0x14
009bf9ef : JMP 0x009bfdff
009bf9f4 : MOV EDI,dword ptr [EBX + 0x18]
009bf9f7 : ADD EBX,0x4
009bf9fa : CMP EDI,0x8
009bf9fd : JC 0x009bfa03
009bf9ff : MOV EAX,dword ptr [EBX]
009bfa01 : JMP 0x009bfa05
009bfa03 : MOV EAX,EBX
009bfa05 : MOV ECX,0xc8f2c4
009bfa0a : LEA EBX,[EBX]
009bfa10 : MOV DX,word ptr [EAX]
009bfa13 : CMP DX,word ptr [ECX]
009bfa16 : JNZ 0x009bfa36
009bfa18 : CMP DX,SI
009bfa1b : JZ 0x009bfa32
009bfa1d : MOV DX,word ptr [EAX + 0x2]
009bfa21 : CMP DX,word ptr [ECX + 0x2]
009bfa25 : JNZ 0x009bfa36
009bfa27 : ADD EAX,0x4
009bfa2a : ADD ECX,0x4
009bfa2d : CMP DX,SI
009bfa30 : JNZ 0x009bfa10
009bfa32 : XOR EAX,EAX
009bfa34 : JMP 0x009bfa3b
009bfa36 : SBB EAX,EAX
009bfa38 : SBB EAX,-0x1
009bfa3b : CMP EAX,ESI
009bfa3d : JNZ 0x009bfcdc
009bfa43 : PUSH 0xc8f2cc
009bfa48 : LEA ECX,[ESP + 0x58]
009bfa4c : CALL 0x00406460
009bfa51 : MOV byte ptr [ESP + 0xf0],0x6
009bfa59 : CMP dword ptr [ESP + 0xc0],0x8
009bfa61 : MOV EAX,dword ptr [ESP + 0xac]
009bfa68 : JNC 0x009bfa71
009bfa6a : LEA EAX,[ESP + 0xac]
009bfa71 : PUSH EAX
009bfa72 : LEA ECX,[ESP + 0x74]
009bfa76 : CALL 0x00406460
009bfa7b : MOV byte ptr [ESP + 0xf0],0x7
009bfa83 : PUSH ESI
009bfa84 : LEA EAX,[ESP + 0x58]
009bfa88 : PUSH EAX
009bfa89 : LEA ECX,[ESP + 0x78]
009bfa8d : PUSH ECX
009bfa8e : LEA EDX,[ESP + 0x44]
009bfa92 : PUSH EDX
009bfa93 : CALL 0x0070cd60
009bfa98 : ADD ESP,0x10
009bfa9b : MOV byte ptr [ESP + 0xf0],0x9
009bfaa3 : LEA ECX,[ESP + 0x70]
009bfaa7 : CALL 0x00406560
009bfaac : MOV byte ptr [ESP + 0xf0],0xa
009bfab4 : LEA ECX,[ESP + 0x54]
009bfab8 : CALL 0x00406560
009bfabd : MOV ECX,dword ptr [ESP + 0x40]
009bfac1 : MOV ESI,dword ptr [ESP + 0x3c]
009bfac5 : SUB ECX,ESI
009bfac7 : MOV EAX,0x92492493
009bfacc : IMUL ECX
009bface : ADD EDX,ECX
009bfad0 : SAR EDX,0x4
009bfad3 : MOV EAX,EDX
009bfad5 : SHR EAX,0x1f
009bfad8 : ADD EAX,EDX
009bfada : JZ 0x009bfaec
009bfadc : CMP dword ptr [ESI + 0x18],0x8
009bfae0 : JC 0x009bfae7
009bfae2 : MOV ESI,dword ptr [ESI + 0x4]
009bfae5 : JMP 0x009bfaf1
009bfae7 : ADD ESI,0x4
009bfaea : JMP 0x009bfaf1
009bfaec : MOV ESI,0xc8f2d0
009bfaf1 : PUSH ESI
009bfaf2 : LEA ECX,[ESP + 0xc8]
009bfaf9 : CALL 0x00406460
009bfafe : MOV byte ptr [ESP + 0xf0],0xb
009bfb06 : MOV ESI,dword ptr [ESP + 0x40]
009bfb0a : MOV EDI,dword ptr [ESP + 0x3c]
009bfb0e : MOV ECX,ESI
009bfb10 : SUB ECX,EDI
009bfb12 : MOV EAX,0x92492493
009bfb17 : IMUL ECX
009bfb19 : ADD EDX,ECX
009bfb1b : SAR EDX,0x4
009bfb1e : MOV ECX,EDX
009bfb20 : SHR ECX,0x1f
009bfb23 : ADD ECX,EDX
009bfb25 : CMP ECX,0x1
009bfb28 : JBE 0x009bfb4d
009bfb2a : CMP dword ptr [EDI + 0x34],0x8
009bfb2e : JC 0x009bfb35
009bfb30 : MOV EDI,dword ptr [EDI + 0x20]
009bfb33 : JMP 0x009bfb38
009bfb35 : ADD EDI,0x20
009bfb38 : PUSH EDI
009bfb39 : CALL 0x00634f4d
009bfb3e : MOV ESI,dword ptr [ESP + 0x44]
009bfb42 : MOV EDI,dword ptr [ESP + 0x40]
009bfb46 : ADD ESP,0x4
009bfb49 : MOV EBX,EAX
009bfb4b : JMP 0x009bfb4f
009bfb4d : XOR EBX,EBX
009bfb4f : SUB ESI,EDI
009bfb51 : MOV EAX,0x92492493
009bfb56 : IMUL ESI
009bfb58 : ADD EDX,ESI
009bfb5a : SAR EDX,0x4
009bfb5d : MOV EAX,EDX
009bfb5f : SHR EAX,0x1f
009bfb62 : ADD EAX,EDX
009bfb64 : CMP EAX,0x2
009bfb67 : JBE 0x009bfb8f
009bfb69 : CMP dword ptr [EDI + 0x50],0x8
009bfb6d : JC 0x009bfb7f
009bfb6f : MOV EDI,dword ptr [EDI + 0x3c]
009bfb72 : PUSH EDI
009bfb73 : CALL 0x00634f4d
009bfb78 : ADD ESP,0x4
009bfb7b : MOV ESI,EAX
009bfb7d : JMP 0x009bfb91
009bfb7f : ADD EDI,0x3c
009bfb82 : PUSH EDI
009bfb83 : CALL 0x00634f4d
009bfb88 : ADD ESP,0x4
009bfb8b : MOV ESI,EAX
009bfb8d : JMP 0x009bfb91
009bfb8f : XOR ESI,ESI
009bfb91 : PUSH 0x30
009bfb93 : CALL 0x006f0300
009bfb98 : ADD ESP,0x4
009bfb9b : MOV dword ptr [ESP + 0x1c],EAX
009bfb9f : MOV byte ptr [ESP + 0xf0],0xc
009bfba7 : TEST EAX,EAX
009bfba9 : JZ 0x009bfbbe
009bfbab : PUSH ESI
009bfbac : PUSH EBX
009bfbad : PUSH EAX
009bfbae : LEA ECX,[ESP + 0xd0]
009bfbb5 : CALL 0x0041eaf0
009bfbba : MOV EBX,EAX
009bfbbc : JMP 0x009bfbc0
009bfbbe : XOR EBX,EBX
009bfbc0 : MOV byte ptr [ESP + 0xf0],0xb
009bfbc8 : PUSH 0xc8f2d4
009bfbcd : LEA ECX,[ESP + 0x58]
009bfbd1 : CALL 0x00406460
009bfbd6 : MOV byte ptr [ESP + 0xf0],0xd
009bfbde : LEA ECX,[ESP + 0x54]
009bfbe2 : PUSH ECX
009bfbe3 : MOV ECX,dword ptr [0x0172491c]
009bfbe9 : LEA EDI,[ESP + 0x90]
009bfbf0 : CALL 0x0081d120
009bfbf5 : MOV byte ptr [ESP + 0xf0],0xf
009bfbfd : LEA ECX,[ESP + 0x54]
009bfc01 : CALL 0x00406560
009bfc06 : MOV EDX,dword ptr [0x00da9894]
009bfc0c : MOV ECX,dword ptr [EDX]
009bfc0e : PUSH 0x2
009bfc10 : MOV EAX,EDI
009bfc12 : PUSH EAX
009bfc13 : CALL 0x008ede80
009bfc18 : MOV ESI,EAX
009bfc1a : TEST ESI,ESI
009bfc1c : JNZ 0x009bfc7f
009bfc1e : MOV byte ptr [ESP + 0xf0],0xb
009bfc26 : MOV ECX,EDI
009bfc28 : CALL 0x00406560
009bfc2d : MOV byte ptr [ESP + 0xf0],0xa
009bfc35 : LEA ECX,[ESP + 0xc4]
009bfc3c : CALL 0x00406560
009bfc41 : MOV byte ptr [ESP + 0xf0],0x5
009bfc49 : LEA ESI,[ESP + 0x38]
009bfc4d : CALL 0x004042c0
009bfc52 : MOV byte ptr [ESP + 0xf0],0x0
009bfc5a : LEA ESI,[ESP + 0x28]
009bfc5e : CALL 0x004042c0
009bfc63 : MOV dword ptr [ESP + 0xf0],0xffffffff
009bfc6e : LEA ECX,[ESP + 0xa8]
009bfc75 : CALL 0x00406560
009bfc7a : JMP 0x009bfe72
009bfc7f : MOV EAX,dword ptr [ESI + 0x60]
009bfc82 : MOV dword ptr [ESI + 0x6c],EBX
009bfc85 : MOV dword ptr [ESI + 0x70],0x4
009bfc8c : TEST EAX,EAX
009bfc8e : JZ 0x009bfc95
009bfc90 : PUSH ESI
009bfc91 : PUSH 0x1
009bfc93 : CALL EAX
009bfc95 : MOV dword ptr [ESI + 0x60],0x9be0e0
009bfc9c : MOV byte ptr [ESP + 0xf0],0xb
009bfca4 : LEA ECX,[ESP + 0x8c]
009bfcab : CALL 0x00406560
009bfcb0 : MOV byte ptr [ESP + 0xf0],0xa
009bfcb8 : LEA ECX,[ESP + 0xc4]
009bfcbf : CALL 0x00406560
009bfcc4 : MOV byte ptr [ESP + 0xf0],0x5
009bfccc : LEA ESI,[ESP + 0x38]
009bfcd0 : CALL 0x004042c0
009bfcd5 : XOR ESI,ESI
009bfcd7 : JMP 0x009bfdff
009bfcdc : CMP EDI,0x8
009bfcdf : JC 0x009bfce5
009bfce1 : MOV EAX,dword ptr [EBX]
009bfce3 : JMP 0x009bfce7
009bfce5 : MOV EAX,EBX
009bfce7 : MOV ECX,0xc8f300
009bfcec : LEA ESP,[ESP]
009bfcf0 : MOV DX,word ptr [EAX]
009bfcf3 : CMP DX,word ptr [ECX]
009bfcf6 : JNZ 0x009bfd16
009bfcf8 : CMP DX,SI
009bfcfb : JZ 0x009bfd12
009bfcfd : MOV DX,word ptr [EAX + 0x2]
009bfd01 : CMP DX,word ptr [ECX + 0x2]
009bfd05 : JNZ 0x009bfd16
009bfd07 : ADD EAX,0x4
009bfd0a : ADD ECX,0x4
009bfd0d : CMP DX,SI
009bfd10 : JNZ 0x009bfcf0
009bfd12 : XOR EAX,EAX
009bfd14 : JMP 0x009bfd1b
009bfd16 : SBB EAX,EAX
009bfd18 : SBB EAX,-0x1
009bfd1b : CMP EAX,ESI
009bfd1d : JNZ 0x009bfd2f
009bfd1f : MOV ECX,dword ptr [ESP + 0x18]
009bfd23 : MOV EDX,dword ptr [ECX]
009bfd25 : MOV EAX,dword ptr [EDX + 0x20]
009bfd28 : CALL EAX
009bfd2a : JMP 0x009bfdff
009bfd2f : CMP EDI,0x8
009bfd32 : JC 0x009bfd38
009bfd34 : MOV EAX,dword ptr [EBX]
009bfd36 : JMP 0x009bfd3a
009bfd38 : MOV EAX,EBX
009bfd3a : MOV ECX,0xc8f30c
009bfd3f : NOP
009bfd40 : MOV DX,word ptr [EAX]
009bfd43 : CMP DX,word ptr [ECX]
009bfd46 : JNZ 0x009bfd66
009bfd48 : CMP DX,SI
009bfd4b : JZ 0x009bfd62
009bfd4d : MOV DX,word ptr [EAX + 0x2]
009bfd51 : CMP DX,word ptr [ECX + 0x2]
009bfd55 : JNZ 0x009bfd66
009bfd57 : ADD EAX,0x4
009bfd5a : ADD ECX,0x4
009bfd5d : CMP DX,SI
009bfd60 : JNZ 0x009bfd40
009bfd62 : XOR EAX,EAX
009bfd64 : JMP 0x009bfd6b
009bfd66 : SBB EAX,EAX
009bfd68 : SBB EAX,-0x1
009bfd6b : CMP EAX,ESI
009bfd6d : JNZ 0x009bfdff
009bfd73 : CMP dword ptr [0x0172491c],ESI
009bfd79 : JZ 0x009bfdff
009bfd7f : MOV ECX,dword ptr [0x00da9894]
009bfd85 : MOV EAX,dword ptr [ECX]
009bfd87 : CMP EAX,ESI
009bfd89 : JZ 0x009bfdff
009bfd8b : CMP dword ptr [EAX + 0x1a8],ESI
009bfd91 : JZ 0x009bfdff
009bfd93 : PUSH 0xc8f328
009bfd98 : LEA ECX,[ESP + 0x58]
009bfd9c : CALL 0x00406460
009bfda1 : MOV byte ptr [ESP + 0xf0],0x10
009bfda9 : MOV EDX,dword ptr [0x00da9894]
009bfdaf : MOV EAX,dword ptr [EDX]
009bfdb1 : MOV EBX,dword ptr [EAX + 0x1a8]
009bfdb7 : MOV ECX,dword ptr [0x0172491c]
009bfdbd : LEA EAX,[ESP + 0x54]
009bfdc1 : PUSH EAX
009bfdc2 : LEA EDI,[ESP + 0x74]
009bfdc6 : CALL 0x0081d120
009bfdcb : MOV byte ptr [ESP + 0xf0],0x11
009bfdd3 : MOV EDX,dword ptr [EBX]
009bfdd5 : PUSH 0x3
009bfdd7 : PUSH EAX
009bfdd8 : MOV EAX,dword ptr [EDX + 0x44]
009bfddb : MOV ECX,EBX
009bfddd : CALL EAX
009bfddf : MOV byte ptr [ESP + 0xf0],0x10
009bfde7 : MOV ECX,EDI
009bfde9 : CALL 0x00406560
009bfdee : MOV byte ptr [ESP + 0xf0],0x5
009bfdf6 : LEA ECX,[ESP + 0x54]
009bfdfa : CALL 0x00406560
009bfdff : MOV byte ptr [ESP + 0xf0],0x0
009bfe07 : MOV EAX,dword ptr [ESP + 0x2c]
009bfe0b : CMP EAX,ESI
009bfe0d : JZ 0x009bfe29
009bfe0f : MOV ECX,dword ptr [ESP + 0x1c]
009bfe13 : MOV EDI,dword ptr [ESP + 0x30]
009bfe17 : PUSH ECX
009bfe18 : CALL 0x00405450
009bfe1d : MOV ECX,dword ptr [ESP + 0x30]
009bfe21 : ADD ESP,0x4
009bfe24 : CALL 0x006f04e0
009bfe29 : MOV dword ptr [ESP + 0x2c],ESI
009bfe2d : MOV dword ptr [ESP + 0x30],ESI
009bfe31 : MOV dword ptr [ESP + 0x34],ESI
009bfe35 : MOV dword ptr [ESP + 0xf0],0xffffffff
009bfe40 : CMP dword ptr [ESP + 0xc0],0x8
009bfe48 : JC 0x009bfe56
009bfe4a : MOV ECX,dword ptr [ESP + 0xac]
009bfe51 : CALL 0x006f04e0
009bfe56 : XOR EDX,EDX
009bfe58 : MOV dword ptr [ESP + 0xc0],0x7
009bfe63 : MOV dword ptr [ESP + 0xbc],ESI
009bfe6a : MOV word ptr [ESP + 0xac],DX
009bfe72 : MOV ECX,dword ptr [ESP + 0xe8]
009bfe79 : MOV dword ptr FS:[0x0],ECX
009bfe80 : POP ECX
009bfe81 : POP EDI
009bfe82 : POP ESI
009bfe83 : POP EBX
009bfe84 : MOV ECX,dword ptr [ESP + 0xd0]
009bfe8b : XOR ECX,ESP
009bfe8d : CALL 0x00633e6b
009bfe92 : MOV ESP,EBP
009bfe94 : POP EBP
009bfe95 : RET 0x8

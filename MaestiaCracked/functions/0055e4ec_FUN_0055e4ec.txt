PROGRAM  : Maestia.exe
FUNCTION : FUN_0055e4ec
ENTRY    : 0055e4ec
BODY     : [[0055e4ec, 0055e56a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0055e4ec(undefined4 param_1,undefined4 param_2)

{
  int iVar1;
  int iVar2;
  uint _MaxCount;
  char *unaff_EDI;
  char *pcVar3;
  uint in_stack_0000008c;
  undefined4 in_stack_00000098;
  
  do {
    iVar1 = FUN_00638800(unaff_EDI,0x2c);
    pcVar3 = unaff_EDI;
    if (iVar1 == 0) {
LAB_0055e52d:
      iVar2 = FUN_0055e1e0(unaff_EDI,in_stack_00000098,param_2);
      if (iVar2 != 0) break;
    }
    else {
      _MaxCount = iVar1 - (int)unaff_EDI;
      if (_MaxCount < 0x80) {
        _strncpy_s(&stack0x0000000c,0x7f,unaff_EDI,_MaxCount);
        (&stack0x0000000c)[_MaxCount] = 0;
        pcVar3 = unaff_EDI + _MaxCount + 1;
        unaff_EDI = &stack0x0000000c;
        goto LAB_0055e52d;
      }
    }
    unaff_EDI = pcVar3;
  } while (iVar1 != 0);
  __security_check_cookie(in_stack_0000008c ^ (uint)&param_1);
  return;
}



============================================================
DISASSEMBLY
============================================================
0055e4ec : PUSH EBX
0055e4ed : PUSH EBP
0055e4ee : PUSH ESI
0055e4ef : XOR EBP,EBP
0055e4f1 : PUSH 0x2c
0055e4f3 : PUSH EDI
0055e4f4 : CALL 0x00638800
0055e4f9 : MOV EBX,EAX
0055e4fb : ADD ESP,0x8
0055e4fe : TEST EBX,EBX
0055e500 : JZ 0x0055e52b
0055e502 : MOV ESI,EBX
0055e504 : SUB ESI,EDI
0055e506 : CMP ESI,0x7f
0055e509 : JA 0x0055e54a
0055e50b : PUSH ESI
0055e50c : PUSH EDI
0055e50d : LEA ECX,[ESP + 0x20]
0055e511 : PUSH 0x7f
0055e513 : PUSH ECX
0055e514 : CALL 0x0063c196
0055e519 : ADD ESP,0x10
0055e51c : MOV byte ptr [ESP + ESI*0x1 + 0x18],0x0
0055e521 : LEA EAX,[ESP + 0x18]
0055e525 : LEA EDI,[EDI + ESI*0x1 + 0x1]
0055e529 : JMP 0x0055e52d
0055e52b : MOV EAX,EDI
0055e52d : MOV EDX,dword ptr [ESP + 0x14]
0055e531 : MOV ECX,dword ptr [ESP + 0xa4]
0055e538 : PUSH EDX
0055e539 : PUSH ECX
0055e53a : MOV ECX,dword ptr [ESP + 0x18]
0055e53e : PUSH EAX
0055e53f : CALL 0x0055e1e0
0055e544 : MOV EBP,EAX
0055e546 : TEST EBP,EBP
0055e548 : JNZ 0x0055e54e
0055e54a : TEST EBX,EBX
0055e54c : JNZ 0x0055e4f1
0055e54e : MOV ECX,dword ptr [ESP + 0x98]
0055e555 : POP ESI
0055e556 : MOV EAX,EBP
0055e558 : POP EBP
0055e559 : POP EBX
0055e55a : POP EDI
0055e55b : XOR ECX,ESP
0055e55d : CALL 0x00633e6b
0055e562 : ADD ESP,0x8c
0055e568 : RET 0x10

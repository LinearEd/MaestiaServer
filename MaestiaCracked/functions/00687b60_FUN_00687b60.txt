PROGRAM  : Maestia.exe
FUNCTION : FUN_00687b60
ENTRY    : 00687b60
BODY     : [[00687b60, 00687bc8]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00687b60(int *param_1,undefined4 *param_2)

{
  int iVar1;
  int iVar2;
  undefined4 *puVar3;
  
  puVar3 = param_2;
  iVar1 = 0;
  *param_2 = 0;
  iVar2 = param_1[2];
  if ((uint)param_1[1] <= iVar2 + 2U) {
LAB_00687bbe:
    *puVar3 = 0x55;
    return 0;
  }
  if ((code *)param_1[5] == (code *)0x0) {
    puVar3 = (undefined4 *)(*param_1 + iVar2);
    if (puVar3 == (undefined4 *)0x0) goto LAB_00687bb7;
  }
  else {
    iVar2 = (*(code *)param_1[5])(param_1,iVar2,&param_2,3);
    if (iVar2 != 3) goto LAB_00687bbe;
    puVar3 = &param_2;
  }
  iVar1 = (int)CONCAT21(CONCAT11(*(undefined1 *)puVar3,*(undefined1 *)((int)puVar3 + 1)),
                        *(undefined1 *)((int)puVar3 + 2));
LAB_00687bb7:
  param_1[2] = param_1[2] + 3;
  return iVar1;
}



============================================================
DISASSEMBLY
============================================================
00687b60 : PUSH ESI
00687b61 : MOV ESI,dword ptr [ESP + 0x8]
00687b65 : PUSH EDI
00687b66 : MOV EDI,dword ptr [ESP + 0x10]
00687b6a : XOR EAX,EAX
00687b6c : MOV dword ptr [EDI],EAX
00687b6e : MOV EDX,dword ptr [ESI + 0x8]
00687b71 : LEA ECX,[EDX + 0x2]
00687b74 : CMP ECX,dword ptr [ESI + 0x4]
00687b77 : JNC 0x00687bbe
00687b79 : MOV ECX,dword ptr [ESI + 0x14]
00687b7c : TEST ECX,ECX
00687b7e : JZ 0x00687b99
00687b80 : PUSH 0x3
00687b82 : LEA EAX,[ESP + 0x14]
00687b86 : PUSH EAX
00687b87 : PUSH EDX
00687b88 : PUSH ESI
00687b89 : CALL ECX
00687b8b : ADD ESP,0x10
00687b8e : CMP EAX,0x3
00687b91 : JNZ 0x00687bbe
00687b93 : LEA ECX,[ESP + 0x10]
00687b97 : JMP 0x00687b9f
00687b99 : MOV ECX,dword ptr [ESI]
00687b9b : ADD ECX,EDX
00687b9d : JZ 0x00687bb7
00687b9f : MOVSX EAX,byte ptr [ECX]
00687ba2 : MOVZX EDX,byte ptr [ECX + 0x1]
00687ba6 : ADD ECX,0x3
00687ba9 : MOVZX ECX,byte ptr [ECX + -0x1]
00687bad : SHL EAX,0x8
00687bb0 : OR EAX,EDX
00687bb2 : SHL EAX,0x8
00687bb5 : OR EAX,ECX
00687bb7 : ADD dword ptr [ESI + 0x8],0x3
00687bbb : POP EDI
00687bbc : POP ESI
00687bbd : RET
00687bbe : MOV dword ptr [EDI],0x55
00687bc4 : POP EDI
00687bc5 : XOR EAX,EAX
00687bc7 : POP ESI
00687bc8 : RET

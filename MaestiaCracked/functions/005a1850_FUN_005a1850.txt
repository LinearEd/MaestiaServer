PROGRAM  : Maestia.exe
FUNCTION : FUN_005a1850
ENTRY    : 005a1850
BODY     : [[005a1850, 005a19e5]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005a1850(undefined4 param_1,int param_2)

{
  int iVar1;
  GRefCountNTSImpl *this;
  int iVar2;
  int in_ECX;
  int *local_40;
  undefined4 local_3c;
  int local_38;
  int local_34;
  uint local_30 [7];
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  undefined1 local_4;
  
  iVar2 = *(int *)(in_ECX + 0x10);
  if (((((*(byte *)(in_ECX + 0x2b8) & 0x80) == 0) && (*(int *)(*(int *)(iVar2 + 8) + 0x10) != 0)) &&
      (iVar1 = *(int *)(*(int *)(iVar2 + 8) + 0x10), *(char *)(iVar1 + 0xc) == '\0')) &&
     (iVar1 != 0)) {
    local_30[4] = 0;
    local_30[2] = 0;
    local_30[1] = 0;
    local_30[3] = 1;
    local_8 = *(undefined4 *)(*(int *)(in_ECX + 0x20) + 0x1c);
    local_c = *(undefined4 *)(iVar2 + 0x2c);
    local_10 = *(undefined4 *)(iVar2 + 0x24);
    local_14 = *(undefined4 *)(iVar2 + 0xc);
    local_30[6] = *(undefined4 *)(iVar2 + 0x20);
    local_30[5] = 0;
    if ((*(char *)(iVar2 + 0x44) != '\0') || (local_4 = 0, *(int *)(iVar2 + 0x18) != 0)) {
      local_4 = 1;
    }
    if (param_2 != 0) {
      local_30[4] = param_2;
    }
    local_30[0] = (uint)(param_2 != 0);
    if (*(int *)(*(int *)(iVar2 + 8) + 0x10) == 0) {
      this = (GRefCountNTSImpl *)0x0;
    }
    else {
      this = (GRefCountNTSImpl *)(**(code **)(**(int **)(*(int *)(iVar2 + 8) + 0x10) + 4))(local_30)
      ;
    }
    iVar2 = FUN_00515840(0x1c,0);
    if (iVar2 == 0) {
      iVar2 = 0;
    }
    else {
      iVar2 = FUN_00513610(this,1);
    }
    if (*(int *)(in_ECX + 0x2e8) == 0) {
      FUN_00566b90(param_1,iVar2);
    }
    if (iVar2 != 0) {
      FUN_00524240();
    }
    if (this != (GRefCountNTSImpl *)0x0) {
      GRefCountNTSImpl::Release(this);
      return;
    }
  }
  else {
    FUN_005a0af0(&local_40,param_2);
    FUN_005a1610(&local_38,param_1,&local_40);
    if ((local_38 == 0) && (local_34 != 0)) {
      FUN_00524240();
    }
    if (local_40 != (int *)0x0) {
      (**(code **)(*local_40 + 8))(local_3c);
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005a1850 : SUB ESP,0x40
005a1853 : PUSH EBX
005a1854 : PUSH EBP
005a1855 : MOV EBP,ECX
005a1857 : MOV EAX,dword ptr [EBP + 0x10]
005a185a : PUSH ESI
005a185b : XOR EBX,EBX
005a185d : TEST byte ptr [EBP + 0x2b8],0x80
005a1864 : PUSH EDI
005a1865 : JNZ 0x005a1989
005a186b : MOV ECX,dword ptr [EAX + 0x8]
005a186e : CMP dword ptr [ECX + 0x10],EBX
005a1871 : JZ 0x005a1989
005a1877 : MOV EDX,dword ptr [ECX + 0x10]
005a187a : CMP byte ptr [EDX + 0xc],BL
005a187d : JNZ 0x005a1989
005a1883 : CMP EDX,EBX
005a1885 : JZ 0x005a1989
005a188b : MOV ECX,dword ptr [EBP + 0x20]
005a188e : MOV dword ptr [ESP + 0x34],EBX
005a1892 : MOV dword ptr [ESP + 0x38],EBX
005a1896 : MOV dword ptr [ESP + 0x3c],EBX
005a189a : MOV dword ptr [ESP + 0x40],EBX
005a189e : MOV dword ptr [ESP + 0x44],EBX
005a18a2 : MOV dword ptr [ESP + 0x48],EBX
005a18a6 : MOV dword ptr [ESP + 0x20],EBX
005a18aa : MOV dword ptr [ESP + 0x30],EBX
005a18ae : MOV dword ptr [ESP + 0x28],EBX
005a18b2 : MOV dword ptr [ESP + 0x24],EBX
005a18b6 : MOV dword ptr [ESP + 0x2c],0x1
005a18be : MOV byte ptr [ESP + 0x4c],BL
005a18c2 : MOV ECX,dword ptr [ECX + 0x1c]
005a18c5 : MOV dword ptr [ESP + 0x48],ECX
005a18c9 : MOV ECX,dword ptr [EAX + 0x2c]
005a18cc : MOV EDX,dword ptr [EAX + 0x24]
005a18cf : MOV ESI,dword ptr [EAX + 0xc]
005a18d2 : MOV EDI,dword ptr [EAX + 0x20]
005a18d5 : MOV dword ptr [ESP + 0x34],EBX
005a18d9 : MOV dword ptr [ESP + 0x38],EDI
005a18dd : MOV dword ptr [ESP + 0x3c],ESI
005a18e1 : MOV dword ptr [ESP + 0x40],EDX
005a18e5 : MOV dword ptr [ESP + 0x44],ECX
005a18e9 : CMP byte ptr [EAX + 0x44],BL
005a18ec : JNZ 0x005a18f7
005a18ee : CMP dword ptr [EAX + 0x18],EBX
005a18f1 : MOV byte ptr [ESP + 0x4c],BL
005a18f5 : JZ 0x005a18fc
005a18f7 : MOV byte ptr [ESP + 0x4c],0x1
005a18fc : MOV ECX,dword ptr [ESP + 0x58]
005a1900 : CMP ECX,EBX
005a1902 : JZ 0x005a1910
005a1904 : MOV dword ptr [ESP + 0x20],0x1
005a190c : MOV dword ptr [ESP + 0x30],ECX
005a1910 : MOV ECX,dword ptr [EAX + 0x8]
005a1913 : CMP dword ptr [ECX + 0x10],EBX
005a1916 : JZ 0x005a192d
005a1918 : MOV EAX,ECX
005a191a : MOV ECX,dword ptr [EAX + 0x10]
005a191d : MOV EDX,dword ptr [ECX]
005a191f : MOV EDX,dword ptr [EDX + 0x4]
005a1922 : LEA EAX,[ESP + 0x20]
005a1926 : PUSH EAX
005a1927 : CALL EDX
005a1929 : MOV EDI,EAX
005a192b : JMP 0x005a192f
005a192d : MOV EDI,EBX
005a192f : MOV ECX,dword ptr [ESP + 0x48]
005a1933 : PUSH EBX
005a1934 : PUSH 0x1c
005a1936 : CALL 0x00515840
005a193b : CMP EAX,EBX
005a193d : JZ 0x005a194d
005a193f : PUSH 0x1
005a1941 : PUSH EDI
005a1942 : MOV ECX,EAX
005a1944 : CALL 0x00513610
005a1949 : MOV ESI,EAX
005a194b : JMP 0x005a194f
005a194d : XOR ESI,ESI
005a194f : CMP dword ptr [EBP + 0x2e8],EBX
005a1955 : JNZ 0x005a1969
005a1957 : PUSH ESI
005a1958 : PUSH ECX
005a1959 : MOV ECX,dword ptr [ESP + 0x5c]
005a195d : MOV EAX,ESP
005a195f : MOV dword ptr [EAX],ECX
005a1961 : MOV ECX,dword ptr [EBP + 0x20]
005a1964 : CALL 0x00566b90
005a1969 : CMP ESI,EBX
005a196b : JZ 0x005a1974
005a196d : MOV ECX,ESI
005a196f : CALL 0x00524240
005a1974 : CMP EDI,EBX
005a1976 : JZ 0x005a19dc
005a1978 : MOV ECX,EDI
005a197a : CALL 0x004ff7c0
005a197f : POP EDI
005a1980 : POP ESI
005a1981 : POP EBP
005a1982 : POP EBX
005a1983 : ADD ESP,0x40
005a1986 : RET 0x8
005a1989 : MOV EDX,dword ptr [ESP + 0x58]
005a198d : PUSH EDX
005a198e : LEA EAX,[ESP + 0x14]
005a1992 : PUSH EAX
005a1993 : CALL 0x005a0af0
005a1998 : MOV EDX,dword ptr [ESP + 0x5c]
005a199c : ADD ESP,0x8
005a199f : LEA ECX,[ESP + 0x10]
005a19a3 : PUSH ECX
005a19a4 : PUSH ECX
005a19a5 : MOV EAX,ESP
005a19a7 : MOV dword ptr [EAX],EDX
005a19a9 : LEA EAX,[ESP + 0x20]
005a19ad : PUSH EAX
005a19ae : MOV ECX,EBP
005a19b0 : CALL 0x005a1610
005a19b5 : CMP dword ptr [ESP + 0x18],EBX
005a19b9 : JNZ 0x005a19c8
005a19bb : MOV ECX,dword ptr [ESP + 0x1c]
005a19bf : CMP ECX,EBX
005a19c1 : JZ 0x005a19c8
005a19c3 : CALL 0x00524240
005a19c8 : MOV ECX,dword ptr [ESP + 0x10]
005a19cc : CMP ECX,EBX
005a19ce : JZ 0x005a19dc
005a19d0 : MOV EDX,dword ptr [ECX]
005a19d2 : MOV EAX,dword ptr [ESP + 0x14]
005a19d6 : MOV EDX,dword ptr [EDX + 0x8]
005a19d9 : PUSH EAX
005a19da : CALL EDX
005a19dc : POP EDI
005a19dd : POP ESI
005a19de : POP EBP
005a19df : POP EBX
005a19e0 : ADD ESP,0x40
005a19e3 : RET 0x8

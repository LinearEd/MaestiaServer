PROGRAM  : Maestia.exe
FUNCTION : FUN_00a5d620
ENTRY    : 00a5d620
BODY     : [[00a5d620, 00a5d6e0]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00a5d620(byte *param_1,uint param_2,byte *param_3,int *param_4)

{
  int iVar1;
  int in_ECX;
  char cVar2;
  uint uVar3;
  byte *pbVar4;
  byte *pbVar5;
  char local_6;
  char local_5;
  
  uVar3 = 0;
  cVar2 = '\0';
  local_5 = '\0';
  local_6 = 'w';
  pbVar4 = param_3;
  if (1 < (int)param_2) {
    iVar1 = (param_2 - 2 >> 1) + 1;
    uVar3 = iVar1 * 2;
    pbVar5 = param_1;
    param_3 = (byte *)iVar1;
    do {
      local_5 = local_5 + *pbVar5;
      param_1 = pbVar5 + 2;
      *pbVar4 = (&DAT_00d69148)[*(byte *)(in_ECX + 4)] ^ *pbVar5;
      *(char *)(in_ECX + 4) = *(char *)(in_ECX + 4) + '\x01';
      cVar2 = cVar2 + pbVar5[1];
      pbVar4[1] = (&DAT_00d69148)[*(byte *)(in_ECX + 4)] ^ pbVar5[1];
      *(char *)(in_ECX + 4) = *(char *)(in_ECX + 4) + '\x01';
      pbVar4 = pbVar4 + 2;
      param_3 = (byte *)((int)param_3 + -1);
      pbVar5 = param_1;
    } while (param_3 != (byte *)0x0);
  }
  if (uVar3 < param_2) {
    local_6 = *param_1 + 0x77;
    *pbVar4 = (&DAT_00d69148)[*(byte *)(in_ECX + 4)] ^ *param_1;
    *(char *)(in_ECX + 4) = *(char *)(in_ECX + 4) + '\x01';
    pbVar4 = pbVar4 + 1;
  }
  *pbVar4 = cVar2 + local_5 + local_6 ^ (&DAT_00d69148)[*(byte *)(in_ECX + 4)];
  *(char *)(in_ECX + 4) = *(char *)(in_ECX + 4) + '\x01';
  *param_4 = param_2 + 1;
  return CONCAT31((int3)(param_2 + 1 >> 8),1);
}



============================================================
DISASSEMBLY
============================================================
00a5d620 : PUSH EBP
00a5d621 : MOV EBP,ESP
00a5d623 : SUB ESP,0x8
00a5d626 : MOV EAX,dword ptr [EBP + 0xc]
00a5d629 : PUSH EBX
00a5d62a : PUSH ESI
00a5d62b : MOV ESI,dword ptr [EBP + 0x10]
00a5d62e : XOR EBX,EBX
00a5d630 : XOR DL,DL
00a5d632 : CMP EAX,0x2
00a5d635 : PUSH EDI
00a5d636 : MOV EDI,dword ptr [EBP + 0x8]
00a5d639 : MOV byte ptr [EBP + -0x1],BL
00a5d63c : MOV byte ptr [EBP + -0x2],0x77
00a5d640 : JL 0x00a5d698
00a5d642 : ADD EAX,-0x2
00a5d645 : SHR EAX,0x1
00a5d647 : INC EAX
00a5d648 : MOV dword ptr [EBP + 0x10],EAX
00a5d64b : ADD EAX,EAX
00a5d64d : MOV dword ptr [EBP + -0x8],EAX
00a5d650 : MOVZX EAX,byte ptr [EDI]
00a5d653 : ADD byte ptr [EBP + -0x1],AL
00a5d656 : MOVZX EAX,byte ptr [ECX + 0x4]
00a5d65a : MOVZX EAX,byte ptr [EAX + 0xd69148]
00a5d661 : XOR AL,byte ptr [EDI]
00a5d663 : ADD EDI,0x2
00a5d666 : MOV byte ptr [ESI],AL
00a5d668 : INC byte ptr [ECX + 0x4]
00a5d66b : MOV BL,byte ptr [ECX + 0x4]
00a5d66e : MOV AL,byte ptr [EDI + -0x1]
00a5d671 : MOVZX EBX,BL
00a5d674 : MOVZX EBX,byte ptr [EBX + 0xd69148]
00a5d67b : XOR BL,AL
00a5d67d : ADD DL,AL
00a5d67f : MOV EAX,0x1
00a5d684 : MOV byte ptr [ESI + 0x1],BL
00a5d687 : ADD byte ptr [ECX + 0x4],AL
00a5d68a : ADD ESI,0x2
00a5d68d : SUB dword ptr [EBP + 0x10],EAX
00a5d690 : JNZ 0x00a5d650
00a5d692 : MOV EAX,dword ptr [EBP + 0xc]
00a5d695 : MOV EBX,dword ptr [EBP + -0x8]
00a5d698 : CMP EBX,EAX
00a5d69a : JNC 0x00a5d6bb
00a5d69c : MOV AL,byte ptr [EDI]
00a5d69e : MOVZX EDI,byte ptr [ECX + 0x4]
00a5d6a2 : MOV BL,AL
00a5d6a4 : ADD BL,0x77
00a5d6a7 : MOV byte ptr [EBP + -0x2],BL
00a5d6aa : MOV BL,byte ptr [EDI + 0xd69148]
00a5d6b0 : XOR BL,AL
00a5d6b2 : MOV EAX,dword ptr [EBP + 0xc]
00a5d6b5 : MOV byte ptr [ESI],BL
00a5d6b7 : INC byte ptr [ECX + 0x4]
00a5d6ba : INC ESI
00a5d6bb : MOVZX EDI,byte ptr [ECX + 0x4]
00a5d6bf : ADD DL,byte ptr [EBP + -0x1]
00a5d6c2 : ADD DL,byte ptr [EBP + -0x2]
00a5d6c5 : XOR DL,byte ptr [EDI + 0xd69148]
00a5d6cb : POP EDI
00a5d6cc : MOV byte ptr [ESI],DL
00a5d6ce : INC byte ptr [ECX + 0x4]
00a5d6d1 : MOV ECX,dword ptr [EBP + 0x14]
00a5d6d4 : INC EAX
00a5d6d5 : POP ESI
00a5d6d6 : MOV dword ptr [ECX],EAX
00a5d6d8 : MOV AL,0x1
00a5d6da : POP EBX
00a5d6db : MOV ESP,EBP
00a5d6dd : POP EBP
00a5d6de : RET 0x14

PROGRAM  : Maestia.exe
FUNCTION : FUN_00457e70
ENTRY    : 00457e70
BODY     : [[00457e70, 00457f39]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00457e70(undefined1 *param_1)

{
  uint uVar1;
  size_t sVar2;
  undefined1 *puVar3;
  int unaff_EDI;
  
  if (*(char *)(unaff_EDI + 0x10) == '\0') {
    if (*(uint *)(unaff_EDI + 8) == *(uint *)(unaff_EDI + 0xc)) {
      if (*(uint *)(unaff_EDI + 0xc) < 8) {
        *(undefined4 *)(unaff_EDI + 0xc) = 8;
      }
      FUN_00457cd0(unaff_EDI,*(int *)(unaff_EDI + 0xc) * 2 + 1);
    }
    puVar3 = (undefined1 *)(*(int *)(unaff_EDI + 8) * 0x40c + *(int *)(unaff_EDI + 4));
    *(int *)(unaff_EDI + 8) = *(int *)(unaff_EDI + 8) + 1;
    *puVar3 = *param_1;
    sVar2 = *(size_t *)(param_1 + 8);
    *(size_t *)(puVar3 + 8) = sVar2;
    if (*(int *)(param_1 + 8) != 0) {
      _memmove(puVar3 + 0xc,param_1 + 0xc,sVar2);
    }
    puVar3[*(int *)(puVar3 + 8) + 0xc] = 0;
    return 1;
  }
  uVar1 = *(uint *)(unaff_EDI + 8);
  if (uVar1 < *(uint *)(unaff_EDI + 0xc)) {
    puVar3 = (undefined1 *)(uVar1 * 0x40c + *(int *)(unaff_EDI + 4));
    *(uint *)(unaff_EDI + 8) = uVar1 + 1;
    *puVar3 = *param_1;
    sVar2 = *(size_t *)(param_1 + 8);
    *(size_t *)(puVar3 + 8) = sVar2;
    if (*(int *)(param_1 + 8) != 0) {
      _memmove(puVar3 + 0xc,param_1 + 0xc,sVar2);
    }
    puVar3[*(int *)(puVar3 + 8) + 0xc] = 0;
    return 1;
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00457e70 : CMP byte ptr [EDI + 0x10],0x0
00457e74 : PUSH EBX
00457e75 : PUSH EBP
00457e76 : MOV EBP,dword ptr [ESP + 0xc]
00457e7a : PUSH ESI
00457e7b : MOV BL,0x1
00457e7d : JZ 0x00457ed2
00457e7f : MOV EAX,dword ptr [EDI + 0x8]
00457e82 : CMP EAX,dword ptr [EDI + 0xc]
00457e85 : JNC 0x00457eca
00457e87 : MOV ESI,EAX
00457e89 : IMUL ESI,ESI,0x40c
00457e8f : ADD ESI,dword ptr [EDI + 0x4]
00457e92 : INC EAX
00457e93 : MOV dword ptr [EDI + 0x8],EAX
00457e96 : MOV AL,byte ptr [EBP]
00457e99 : MOV byte ptr [ESI],AL
00457e9b : MOV ECX,dword ptr [EBP + 0x8]
00457e9e : MOV dword ptr [ESI + 0x8],ECX
00457ea1 : CMP dword ptr [EBP + 0x8],0x0
00457ea5 : JBE 0x00457eba
00457ea7 : MOV EDX,ECX
00457ea9 : PUSH EDX
00457eaa : ADD EBP,0xc
00457ead : LEA EAX,[ESI + 0xc]
00457eb0 : PUSH EBP
00457eb1 : PUSH EAX
00457eb2 : CALL 0x00636880
00457eb7 : ADD ESP,0xc
00457eba : MOV ECX,dword ptr [ESI + 0x8]
00457ebd : MOV byte ptr [ECX + ESI*0x1 + 0xc],0x0
00457ec2 : POP ESI
00457ec3 : POP EBP
00457ec4 : MOV AL,BL
00457ec6 : POP EBX
00457ec7 : RET 0x4
00457eca : POP ESI
00457ecb : POP EBP
00457ecc : XOR AL,AL
00457ece : POP EBX
00457ecf : RET 0x4
00457ed2 : MOV EAX,dword ptr [EDI + 0xc]
00457ed5 : CMP dword ptr [EDI + 0x8],EAX
00457ed8 : JNZ 0x00457ef4
00457eda : CMP EAX,0x8
00457edd : JNC 0x00457ee6
00457edf : MOV dword ptr [EDI + 0xc],0x8
00457ee6 : MOV EDX,dword ptr [EDI + 0xc]
00457ee9 : LEA EAX,[EDX + EDX*0x1 + 0x1]
00457eed : PUSH EAX
00457eee : PUSH EDI
00457eef : CALL 0x00457cd0
00457ef4 : MOV EAX,dword ptr [EDI + 0x8]
00457ef7 : MOV ESI,EAX
00457ef9 : IMUL ESI,ESI,0x40c
00457eff : ADD ESI,dword ptr [EDI + 0x4]
00457f02 : INC EAX
00457f03 : MOV dword ptr [EDI + 0x8],EAX
00457f06 : MOV CL,byte ptr [EBP]
00457f09 : MOV byte ptr [ESI],CL
00457f0b : MOV EDX,dword ptr [EBP + 0x8]
00457f0e : MOV dword ptr [ESI + 0x8],EDX
00457f11 : CMP dword ptr [EBP + 0x8],0x0
00457f15 : JBE 0x00457f2a
00457f17 : MOV EAX,EDX
00457f19 : PUSH EAX
00457f1a : ADD EBP,0xc
00457f1d : LEA ECX,[ESI + 0xc]
00457f20 : PUSH EBP
00457f21 : PUSH ECX
00457f22 : CALL 0x00636880
00457f27 : ADD ESP,0xc
00457f2a : MOV EDX,dword ptr [ESI + 0x8]
00457f2d : MOV byte ptr [EDX + ESI*0x1 + 0xc],0x0
00457f32 : POP ESI
00457f33 : POP EBP
00457f34 : MOV AL,BL
00457f36 : POP EBX
00457f37 : RET 0x4

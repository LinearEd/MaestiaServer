PROGRAM  : Maestia.exe
FUNCTION : FUN_00802790
ENTRY    : 00802790
BODY     : [[00802790, 00802829] [0080282c, 008028fb]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x008028a2) */

void FUN_00802790(void)

{
  LPCRITICAL_SECTION lpCriticalSection;
  int iVar1;
  uint uVar2;
  undefined4 uVar3;
  int unaff_ESI;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b37712;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  lpCriticalSection = (LPCRITICAL_SECTION)(unaff_ESI + 0xb8);
  EnterCriticalSection(lpCriticalSection);
  local_8 = 0;
  if (*(int *)(unaff_ESI + 0x58) != *(int *)(unaff_ESI + 0x5c)) {
    uVar3 = FUN_00404250(*(int *)(unaff_ESI + 0x5c),uVar2);
    FUN_00405450(lpCriticalSection);
    *(undefined4 *)(unaff_ESI + 0x5c) = uVar3;
  }
  local_14 = **(int **)(unaff_ESI + 0x4c);
  if ((int *)local_14 != *(int **)(unaff_ESI + 0x4c)) {
    do {
      iVar1 = *(int *)(local_14 + 0x10);
      if (iVar1 != 0) {
        if (*(int *)(iVar1 + 4) == 0) {
          *(undefined4 *)(iVar1 + 4) = 0;
          *(undefined4 *)(iVar1 + 8) = 0;
          *(undefined4 *)(iVar1 + 0xc) = 0;
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        FUN_00405450(lpCriticalSection);
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      FUN_00416210();
    } while (local_14 != *(int *)(unaff_ESI + 0x4c));
  }
  FUN_00401c00(*(undefined4 *)(*(int *)(unaff_ESI + 0x4c) + 4));
  *(int *)(*(int *)(unaff_ESI + 0x4c) + 4) = *(int *)(unaff_ESI + 0x4c);
  *(undefined4 *)(unaff_ESI + 0x50) = 0;
  *(undefined4 *)*(undefined4 *)(unaff_ESI + 0x4c) = *(undefined4 *)(unaff_ESI + 0x4c);
  *(int *)(*(int *)(unaff_ESI + 0x4c) + 8) = *(int *)(unaff_ESI + 0x4c);
  *(undefined1 *)(unaff_ESI + 0x94) = 0;
  FUN_00458b50(unaff_ESI + 0x6c);
  local_14 = *(int *)(unaff_ESI + 0x70);
  if (*(int *)(unaff_ESI + 0x7c) != *(int *)(unaff_ESI + 0x80)) {
    *(int *)(unaff_ESI + 0x80) = *(int *)(unaff_ESI + 0x7c);
  }
  FUN_0044f580(unaff_ESI + 0x78,*(undefined4 *)(unaff_ESI + 0x7c),&local_14);
  *(undefined4 *)(unaff_ESI + 0x88) = 7;
  *(undefined4 *)(unaff_ESI + 0x8c) = 8;
  local_8 = 0xffffffff;
  LeaveCriticalSection(lpCriticalSection);
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00802790 : PUSH EBP
00802791 : MOV EBP,ESP
00802793 : PUSH -0x1
00802795 : PUSH 0xb37712
0080279a : MOV EAX,FS:[0x0]
008027a0 : PUSH EAX
008027a1 : SUB ESP,0x8
008027a4 : PUSH EBX
008027a5 : PUSH EDI
008027a6 : MOV EAX,[0x00d66fa0]
008027ab : XOR EAX,EBP
008027ad : PUSH EAX
008027ae : LEA EAX,[EBP + -0xc]
008027b1 : MOV FS:[0x0],EAX
008027b7 : LEA EAX,[ESI + 0xb8]
008027bd : PUSH EAX
008027be : MOV dword ptr [EBP + -0x14],EAX
008027c1 : CALL dword ptr [0x00b85118]
008027c7 : MOV dword ptr [EBP + -0x4],0x0
008027ce : MOV EAX,dword ptr [ESI + 0x5c]
008027d1 : MOV ECX,dword ptr [ESI + 0x58]
008027d4 : CMP ECX,EAX
008027d6 : JZ 0x008027f7
008027d8 : PUSH EAX
008027d9 : CALL 0x00404250
008027de : MOV EDI,dword ptr [ESI + 0x5c]
008027e1 : MOV EBX,EAX
008027e3 : MOV EAX,dword ptr [EBP + -0x14]
008027e6 : ADD ESP,0x4
008027e9 : PUSH EAX
008027ea : MOV EAX,EBX
008027ec : CALL 0x00405450
008027f1 : ADD ESP,0x4
008027f4 : MOV dword ptr [ESI + 0x5c],EBX
008027f7 : MOV ECX,dword ptr [ESI + 0x4c]
008027fa : MOV EAX,dword ptr [ECX]
008027fc : MOV dword ptr [EBP + -0x10],EAX
008027ff : CMP EAX,ECX
00802801 : JZ 0x0080284e
00802803 : MOV EBX,dword ptr [EAX + 0x10]
00802806 : XOR ECX,ECX
00802808 : CMP EBX,ECX
0080280a : JZ 0x0080283c
0080280c : MOV EAX,dword ptr [EBX + 0x4]
0080280f : CMP EAX,ECX
00802811 : JZ 0x0080282c
00802813 : MOV ECX,dword ptr [EBP + -0x14]
00802816 : MOV EDI,dword ptr [EBX + 0x8]
00802819 : PUSH ECX
0080281a : CALL 0x00405450
0080281f : MOV ECX,dword ptr [EBX + 0x4]
00802822 : ADD ESP,0x4
00802825 : CALL 0x006f04e0
0080282c : MOV dword ptr [EBX + 0x4],ECX
0080282f : MOV dword ptr [EBX + 0x8],ECX
00802832 : MOV dword ptr [EBX + 0xc],ECX
00802835 : MOV ECX,EBX
00802837 : CALL 0x006f04e0
0080283c : LEA EDX,[EBP + -0x10]
0080283f : CALL 0x00416210
00802844 : MOV ECX,dword ptr [ESI + 0x4c]
00802847 : MOV EAX,dword ptr [EBP + -0x10]
0080284a : CMP EAX,ECX
0080284c : JNZ 0x00802803
0080284e : MOV EDX,dword ptr [ESI + 0x4c]
00802851 : MOV EAX,dword ptr [EDX + 0x4]
00802854 : LEA EDI,[ESI + 0x48]
00802857 : PUSH EAX
00802858 : MOV ECX,EDI
0080285a : CALL 0x00401c00
0080285f : MOV EAX,dword ptr [EDI + 0x4]
00802862 : MOV dword ptr [EAX + 0x4],EAX
00802865 : MOV EAX,dword ptr [EDI + 0x4]
00802868 : MOV dword ptr [EDI + 0x8],0x0
0080286f : MOV dword ptr [EAX],EAX
00802871 : MOV EDI,dword ptr [EDI + 0x4]
00802874 : LEA ECX,[ESI + 0x6c]
00802877 : MOV dword ptr [EDI + 0x8],EDI
0080287a : PUSH ECX
0080287b : MOV byte ptr [ESI + 0x94],0x0
00802882 : CALL 0x00458b50
00802887 : MOV EAX,dword ptr [ESI + 0x70]
0080288a : MOV EDX,dword ptr [ESI + 0x7c]
0080288d : LEA ECX,[ESI + 0x78]
00802890 : MOV dword ptr [EBP + -0x10],EAX
00802893 : MOV EAX,dword ptr [ECX + 0x8]
00802896 : CMP EDX,EAX
00802898 : JZ 0x008028b3
0080289a : MOV EDI,EDX
0080289c : MOV EDX,EAX
0080289e : CMP EAX,EAX
008028a0 : JZ 0x008028b0
008028a2 : MOV EBX,dword ptr [EDX]
008028a4 : MOV dword ptr [EDI],EBX
008028a6 : ADD EDX,0x4
008028a9 : ADD EDI,0x4
008028ac : CMP EDX,EAX
008028ae : JNZ 0x008028a2
008028b0 : MOV dword ptr [ECX + 0x8],EDI
008028b3 : MOV EAX,dword ptr [ECX + 0x4]
008028b6 : LEA EDX,[EBP + -0x10]
008028b9 : PUSH EDX
008028ba : PUSH EAX
008028bb : PUSH ECX
008028bc : MOV ECX,0x9
008028c1 : CALL 0x0044f580
008028c6 : MOV dword ptr [ESI + 0x88],0x7
008028d0 : MOV dword ptr [ESI + 0x8c],0x8
008028da : MOV dword ptr [EBP + -0x4],0xffffffff
008028e1 : MOV EAX,dword ptr [EBP + -0x14]
008028e4 : PUSH EAX
008028e5 : CALL dword ptr [0x00b8511c]
008028eb : MOV ECX,dword ptr [EBP + -0xc]
008028ee : MOV dword ptr FS:[0x0],ECX
008028f5 : POP ECX
008028f6 : POP EDI
008028f7 : POP EBX
008028f8 : MOV ESP,EBP
008028fa : POP EBP
008028fb : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_009531d0
ENTRY    : 009531d0
BODY     : [[009531d0, 009533d9]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009531d0(int param_1,ushort *param_2)

{
  int *piVar1;
  byte *pbVar2;
  int iVar3;
  __time64_t _Var4;
  undefined4 local_3c;
  uint local_38;
  int local_34;
  undefined4 local_2c;
  uint local_28;
  int local_20;
  int local_1c;
  int *local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b400d1;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_1c = (*param_2 & 0x1fff) - 0xb;
  piVar1 = (int *)(param_1 + 0x80);
  pbVar2 = (byte *)*piVar1;
  local_20 = (int)param_2 + 0xb;
  local_18 = piVar1;
  if (pbVar2 == (byte *)0x0) {
    local_18 = (int *)FUN_006f0760(0x68,"",0,(DAT_01725270 >> 3 & 1) == 0,
                                   DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
    local_8 = 0;
    if (local_18 == (int *)0x0) {
      local_34 = 0;
    }
    else {
      local_34 = FUN_004278e0(local_18);
    }
    local_8 = 0xffffffff;
    *piVar1 = local_34;
    local_38 = (uint)(byte)param_2[2];
    local_3c = *(undefined4 *)((int)param_2 + 5);
    FUN_00426e00(param_1 + 0x90,&local_3c);
    FUN_00449730();
    FUN_00405eb0(param_1 + 0x58,0,0xffffffff);
    iVar3 = *(int *)(param_1 + 0x80);
    _Var4 = __time64((__time64_t *)0x0);
    *(__time64_t *)(iVar3 + 0x20) = _Var4;
  }
  else if ((*pbVar2 != (byte)param_2[2]) || (*(int *)(pbVar2 + 4) != *(int *)((int)param_2 + 5))) {
    local_2c = *(undefined4 *)(pbVar2 + 4);
    local_28 = (uint)*pbVar2;
    FUN_00426f10(&local_14);
    if (local_14 != *(int *)(param_1 + 0x94)) {
      FUN_004422c0(param_1 + 0x90,&local_14,local_14);
    }
    *(char *)*local_18 = (char)param_2[2];
    *(undefined4 *)(*local_18 + 4) = *(undefined4 *)((int)param_2 + 5);
    local_38 = (uint)(byte)param_2[2];
    local_34 = *local_18;
    local_3c = *(undefined4 *)((int)param_2 + 5);
    FUN_00426e00(param_1 + 0x90,&local_3c);
  }
  if ((char)param_2[5] == '\0') {
    if ((*(char *)((int)param_2 + 9) == '\0') || (*(char *)((int)param_2 + 9) == '\x02')) {
      *(undefined1 *)(*(int *)(param_1 + 0x80) + 0x28) = 1;
    }
  }
  else {
    FUN_00952720(param_1,*(undefined1 *)((int)param_2 + 9),&local_20,&local_1c,(char)param_2[5]);
    FUN_00952c80(param_1,*(undefined1 *)((int)param_2 + 9),*(undefined4 *)(param_1 + 0x78),
                 *(undefined4 *)(param_1 + 0x7c),5);
  }
  *(undefined4 *)(param_1 + 0x74) = 0;
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
009531d0 : PUSH EBP
009531d1 : MOV EBP,ESP
009531d3 : PUSH -0x1
009531d5 : PUSH 0xb400d1
009531da : MOV EAX,FS:[0x0]
009531e0 : PUSH EAX
009531e1 : SUB ESP,0x2c
009531e4 : PUSH EBX
009531e5 : PUSH ESI
009531e6 : PUSH EDI
009531e7 : MOV EAX,[0x00d66fa0]
009531ec : XOR EAX,EBP
009531ee : PUSH EAX
009531ef : LEA EAX,[EBP + -0xc]
009531f2 : MOV FS:[0x0],EAX
009531f8 : MOV EBX,dword ptr [EBP + 0xc]
009531fb : MOVZX ECX,word ptr [EBX]
009531fe : MOV ESI,dword ptr [EBP + 0x8]
00953201 : AND ECX,0x1fff
00953207 : SUB ECX,0xb
0095320a : LEA EDI,[ESI + 0x80]
00953210 : MOV dword ptr [EBP + -0x18],ECX
00953213 : MOV ECX,dword ptr [EDI]
00953215 : LEA EAX,[EBX + 0xb]
00953218 : MOV dword ptr [EBP + -0x1c],EAX
0095321b : MOV dword ptr [EBP + -0x14],EDI
0095321e : TEST ECX,ECX
00953220 : JNZ 0x009532de
00953226 : MOV EDX,dword ptr [0x01725270]
0095322c : SHR EDX,0x3
0095322f : MOV EAX,ECX
00953231 : AND EDX,0x1
00953234 : SETZ AL
00953237 : PUSH EAX
00953238 : PUSH ECX
00953239 : PUSH 0xbf1a4a
0095323e : PUSH 0x68
00953240 : CALL 0x006f0760
00953245 : ADD ESP,0x10
00953248 : MOV dword ptr [EBP + -0x14],EAX
0095324b : MOV dword ptr [EBP + -0x4],0x0
00953252 : TEST EAX,EAX
00953254 : JZ 0x00953264
00953256 : MOV EDX,dword ptr [EBX + 0x5]
00953259 : MOV CL,byte ptr [EBX + 0x4]
0095325c : PUSH EAX
0095325d : CALL 0x004278e0
00953262 : JMP 0x00953266
00953264 : XOR EAX,EAX
00953266 : MOV dword ptr [EBP + 0xc],EAX
00953269 : MOV dword ptr [EBP + -0x4],0xffffffff
00953270 : MOV dword ptr [EDI],EAX
00953272 : MOVZX EAX,byte ptr [EBX + 0x4]
00953276 : CDQ
00953277 : MOV EDX,dword ptr [EBX + 0x5]
0095327a : XOR ECX,ECX
0095327c : OR ECX,EDX
0095327e : MOV dword ptr [EBP + -0x38],ECX
00953281 : XOR EDI,EDI
00953283 : OR EAX,EDI
00953285 : LEA ECX,[EBP + -0x38]
00953288 : PUSH ECX
00953289 : ADD ESI,0x90
0095328f : MOV dword ptr [EBP + -0x34],EAX
00953292 : MOV EAX,dword ptr [EBP + 0xc]
00953295 : PUSH ESI
00953296 : LEA ESI,[EBP + -0x28]
00953299 : MOV dword ptr [EBP + -0x30],EAX
0095329c : CALL 0x00426e00
009532a1 : MOV ESI,dword ptr [EBP + 0x8]
009532a4 : LEA EDX,[ESI + 0x9c]
009532aa : LEA EDI,[ESI + 0x80]
009532b0 : CALL 0x00449730
009532b5 : MOV ECX,dword ptr [EDI]
009532b7 : PUSH -0x1
009532b9 : PUSH 0x0
009532bb : ADD ESI,0x58
009532be : PUSH ESI
009532bf : ADD ECX,0x2c
009532c2 : CALL 0x00405eb0
009532c7 : MOV EDI,dword ptr [EDI]
009532c9 : PUSH 0x0
009532cb : CALL 0x006381ab
009532d0 : ADD ESP,0x4
009532d3 : MOV dword ptr [EDI + 0x20],EAX
009532d6 : MOV dword ptr [EDI + 0x24],EDX
009532d9 : JMP 0x00953371
009532de : MOV AL,byte ptr [ECX]
009532e0 : CMP AL,byte ptr [EBX + 0x4]
009532e3 : JNZ 0x009532f1
009532e5 : MOV EDX,dword ptr [ECX + 0x4]
009532e8 : CMP EDX,dword ptr [EBX + 0x5]
009532eb : JZ 0x00953374
009532f1 : MOV ECX,dword ptr [ECX + 0x4]
009532f4 : MOVZX EAX,AL
009532f7 : CDQ
009532f8 : XOR EDX,EDX
009532fa : XOR EDI,EDI
009532fc : OR EDX,ECX
009532fe : OR EAX,EDI
00953300 : MOV dword ptr [EBP + -0x28],EDX
00953303 : MOV dword ptr [EBP + -0x24],EAX
00953306 : LEA EDX,[EBP + -0x10]
00953309 : LEA EAX,[ESI + 0x90]
0095330f : PUSH EDX
00953310 : LEA EDI,[EBP + -0x28]
00953313 : MOV dword ptr [EBP + 0xc],EAX
00953316 : CALL 0x00426f10
0095331b : MOV EAX,dword ptr [EBP + -0x10]
0095331e : CMP EAX,dword ptr [ESI + 0x94]
00953324 : JZ 0x00953334
00953326 : MOV ECX,dword ptr [EBP + 0xc]
00953329 : PUSH EAX
0095332a : LEA EAX,[EBP + -0x10]
0095332d : PUSH EAX
0095332e : PUSH ECX
0095332f : CALL 0x004422c0
00953334 : MOV ESI,dword ptr [EBP + -0x14]
00953337 : MOV EDX,dword ptr [ESI]
00953339 : MOV AL,byte ptr [EBX + 0x4]
0095333c : MOV byte ptr [EDX],AL
0095333e : MOV ECX,dword ptr [ESI]
00953340 : MOV EDX,dword ptr [EBX + 0x5]
00953343 : MOV dword ptr [ECX + 0x4],EDX
00953346 : MOVZX EAX,byte ptr [EBX + 0x4]
0095334a : MOV ESI,dword ptr [ESI]
0095334c : CDQ
0095334d : MOV EDX,dword ptr [EBX + 0x5]
00953350 : XOR EDI,EDI
00953352 : XOR ECX,ECX
00953354 : OR EAX,EDI
00953356 : OR ECX,EDX
00953358 : MOV dword ptr [EBP + -0x34],EAX
0095335b : LEA EAX,[EBP + -0x38]
0095335e : MOV dword ptr [EBP + -0x38],ECX
00953361 : MOV ECX,dword ptr [EBP + 0xc]
00953364 : PUSH EAX
00953365 : MOV dword ptr [EBP + -0x30],ESI
00953368 : PUSH ECX
00953369 : LEA ESI,[EBP + -0x28]
0095336c : CALL 0x00426e00
00953371 : MOV ESI,dword ptr [EBP + 0x8]
00953374 : MOV AL,byte ptr [EBX + 0xa]
00953377 : TEST AL,AL
00953379 : JBE 0x009533a9
0095337b : MOVZX EDX,AL
0095337e : PUSH EDX
0095337f : MOVZX EDX,byte ptr [EBX + 0x9]
00953383 : LEA EAX,[EBP + -0x18]
00953386 : PUSH EAX
00953387 : LEA ECX,[EBP + -0x1c]
0095338a : PUSH ECX
0095338b : PUSH EDX
0095338c : PUSH ESI
0095338d : CALL 0x00952720
00953392 : MOV EAX,dword ptr [ESI + 0x7c]
00953395 : MOV ECX,dword ptr [ESI + 0x78]
00953398 : MOVZX EDX,byte ptr [EBX + 0x9]
0095339c : PUSH 0x5
0095339e : PUSH EAX
0095339f : PUSH ECX
009533a0 : PUSH EDX
009533a1 : PUSH ESI
009533a2 : CALL 0x00952c80
009533a7 : JMP 0x009533bf
009533a9 : MOV BL,byte ptr [EBX + 0x9]
009533ac : TEST BL,BL
009533ae : JZ 0x009533b5
009533b0 : CMP BL,0x2
009533b3 : JNZ 0x009533bf
009533b5 : MOV EAX,dword ptr [ESI + 0x80]
009533bb : MOV byte ptr [EAX + 0x28],0x1
009533bf : MOV dword ptr [ESI + 0x74],0x0
009533c6 : MOV ECX,dword ptr [EBP + -0xc]
009533c9 : MOV dword ptr FS:[0x0],ECX
009533d0 : POP ECX
009533d1 : POP EDI
009533d2 : POP ESI
009533d3 : POP EBX
009533d4 : MOV ESP,EBP
009533d6 : POP EBP
009533d7 : RET 0x8

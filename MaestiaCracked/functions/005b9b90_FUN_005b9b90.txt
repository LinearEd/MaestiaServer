PROGRAM  : Maestia.exe
FUNCTION : FUN_005b9b90
ENTRY    : 005b9b90
BODY     : [[005b9b90, 005b9c1e]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_005b9b90(uint *param_1,int param_2)

{
  byte bVar1;
  int iVar2;
  int iVar3;
  int *in_ECX;
  byte *pbVar4;
  int iVar5;
  byte *pbVar6;
  int *piVar7;
  bool bVar8;
  
  iVar2 = *in_ECX;
  piVar7 = (int *)(iVar2 + 8 + param_2 * 0x14);
  if ((*(int *)(iVar2 + 8 + param_2 * 0x14) == -2) || (iVar3 = param_2, piVar7[1] != param_2)) {
    return -1;
  }
  do {
    if (piVar7[1] == param_2) {
      pbVar6 = (byte *)((*param_1 & 0xfffffffc) + 8);
      pbVar4 = (byte *)((piVar7[2] & 0xfffffffcU) + 8);
      do {
        bVar1 = *pbVar4;
        bVar8 = bVar1 < *pbVar6;
        if (bVar1 != *pbVar6) {
LAB_005b9bf0:
          iVar5 = (1 - (uint)bVar8) - (uint)(bVar8 != 0);
          goto LAB_005b9bf5;
        }
        if (bVar1 == 0) break;
        bVar1 = pbVar4[1];
        bVar8 = bVar1 < pbVar6[1];
        if (bVar1 != pbVar6[1]) goto LAB_005b9bf0;
        pbVar4 = pbVar4 + 2;
        pbVar6 = pbVar6 + 2;
      } while (bVar1 != 0);
      iVar5 = 0;
LAB_005b9bf5:
      if (iVar5 == 0) {
        return iVar3;
      }
    }
    iVar3 = *piVar7;
    if (iVar3 == -1) {
      return -1;
    }
    piVar7 = (int *)(iVar2 + 8 + iVar3 * 0x14);
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
005b9b90 : MOV ECX,dword ptr [ECX]
005b9b92 : PUSH ESI
005b9b93 : PUSH EDI
005b9b94 : MOV EDI,dword ptr [ESP + 0x10]
005b9b98 : LEA EDX,[EDI + EDI*0x4]
005b9b9b : CMP dword ptr [ECX + EDX*0x4 + 0x8],-0x2
005b9ba0 : LEA ESI,[ECX + EDX*0x4 + 0x8]
005b9ba4 : MOV EAX,EDI
005b9ba6 : MOV dword ptr [ESP + 0x10],ECX
005b9baa : JZ 0x005b9c17
005b9bac : CMP dword ptr [ESI + 0x4],EDI
005b9baf : JNZ 0x005b9c17
005b9bb1 : PUSH EBP
005b9bb2 : MOV EBP,dword ptr [ESP + 0x10]
005b9bb6 : PUSH EBX
005b9bb7 : CMP dword ptr [ESI + 0x4],EDI
005b9bba : JNZ 0x005b9bfd
005b9bbc : MOV EDX,dword ptr [EBP]
005b9bbf : MOV ECX,dword ptr [ESI + 0x8]
005b9bc2 : AND EDX,0xfffffffc
005b9bc5 : AND ECX,0xfffffffc
005b9bc8 : ADD EDX,0x8
005b9bcb : ADD ECX,0x8
005b9bce : MOV EDI,EDI
005b9bd0 : MOV BL,byte ptr [ECX]
005b9bd2 : CMP BL,byte ptr [EDX]
005b9bd4 : JNZ 0x005b9bf0
005b9bd6 : TEST BL,BL
005b9bd8 : JZ 0x005b9bec
005b9bda : MOV BL,byte ptr [ECX + 0x1]
005b9bdd : CMP BL,byte ptr [EDX + 0x1]
005b9be0 : JNZ 0x005b9bf0
005b9be2 : ADD ECX,0x2
005b9be5 : ADD EDX,0x2
005b9be8 : TEST BL,BL
005b9bea : JNZ 0x005b9bd0
005b9bec : XOR ECX,ECX
005b9bee : JMP 0x005b9bf5
005b9bf0 : SBB ECX,ECX
005b9bf2 : SBB ECX,-0x1
005b9bf5 : TEST ECX,ECX
005b9bf7 : JZ 0x005b9c10
005b9bf9 : MOV ECX,dword ptr [ESP + 0x18]
005b9bfd : MOV EAX,dword ptr [ESI]
005b9bff : CMP EAX,-0x1
005b9c02 : JZ 0x005b9c0d
005b9c04 : LEA EDX,[EAX + EAX*0x4]
005b9c07 : LEA ESI,[ECX + EDX*0x4 + 0x8]
005b9c0b : JMP 0x005b9bb7
005b9c0d : OR EAX,0xffffffff
005b9c10 : POP EBX
005b9c11 : POP EBP
005b9c12 : POP EDI
005b9c13 : POP ESI
005b9c14 : RET 0x8
005b9c17 : POP EDI
005b9c18 : OR EAX,0xffffffff
005b9c1b : POP ESI
005b9c1c : RET 0x8

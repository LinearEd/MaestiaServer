PROGRAM  : Maestia.exe
FUNCTION : FUN_00427e10
ENTRY    : 00427e10
BODY     : [[00427e10, 00427ffb]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00427e10(undefined4 *param_1,undefined4 *param_2,undefined4 *param_3,code *param_4)

{
  undefined4 uVar1;
  undefined4 *puVar2;
  char cVar3;
  undefined4 *puVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  undefined4 *puVar8;
  undefined4 *local_c;
  undefined4 *local_8;
  
  puVar8 = param_2 + (((int)param_3 - (int)param_2 >> 2) - ((int)param_3 - (int)param_2 >> 0x1f) >>
                     1);
  FUN_00428000(param_2,puVar8,param_3 + -1);
  puVar4 = puVar8;
  while (((param_2 < puVar4 && (cVar3 = (*param_4)(puVar4[-1],*puVar4), cVar3 == '\0')) &&
         (cVar3 = (*param_4)(*puVar4,puVar4[-1]), cVar3 == '\0'))) {
    puVar4 = puVar4 + -1;
  }
  do {
    puVar8 = puVar8 + 1;
    puVar7 = puVar8;
    local_c = puVar8;
    local_8 = puVar4;
    puVar6 = puVar4;
    if ((param_3 <= puVar8) || (cVar3 = (*param_4)(*puVar8,*puVar4), cVar3 != '\0')) break;
    cVar3 = (*param_4)(*puVar4,*puVar8);
  } while (cVar3 == '\0');
joined_r0x00427eb3:
  do {
    puVar5 = puVar6;
    puVar2 = puVar7;
    puVar7 = puVar4;
    if (param_3 <= puVar2) {
joined_r0x00427ef7:
      while (param_2 < puVar4) {
        puVar7 = puVar7 + -1;
        cVar3 = (*param_4)(*puVar7,*puVar5);
        puVar8 = local_c;
        if (cVar3 == '\0') {
          cVar3 = (*param_4)(*puVar5,*puVar7);
          puVar4 = local_8;
          if (cVar3 != '\0') break;
          puVar5 = puVar5 + -1;
          if (puVar5 != puVar7) {
            uVar1 = *puVar5;
            *puVar5 = *puVar7;
            *puVar7 = uVar1;
          }
        }
        local_8 = local_8 + -1;
        puVar4 = local_8;
      }
      if (puVar4 == param_2) {
        if (puVar2 == param_3) {
          param_1[1] = puVar8;
          *param_1 = puVar5;
          return;
        }
        if ((puVar8 != puVar2) && (puVar5 != puVar8)) {
          uVar1 = *puVar5;
          *puVar5 = *puVar8;
          *puVar8 = uVar1;
        }
        puVar8 = puVar8 + 1;
        puVar7 = puVar2 + 1;
        local_c = puVar8;
        puVar6 = puVar5 + 1;
        if (puVar5 != puVar2) {
          uVar1 = *puVar5;
          *puVar5 = *puVar2;
          *puVar2 = uVar1;
        }
      }
      else {
        puVar4 = puVar4 + -1;
        local_8 = puVar4;
        if (puVar2 == param_3) {
          puVar6 = puVar5 + -1;
          if (puVar4 != puVar6) {
            uVar1 = *puVar4;
            *puVar4 = *puVar6;
            *puVar6 = uVar1;
          }
          puVar8 = puVar8 + -1;
          puVar7 = puVar2;
          local_c = puVar8;
          if (puVar6 != puVar8) {
            uVar1 = *puVar6;
            *puVar6 = *puVar8;
            *puVar8 = uVar1;
          }
        }
        else {
          puVar7 = puVar2 + 1;
          puVar6 = puVar5;
          if (puVar2 != puVar4) {
            uVar1 = *puVar2;
            *puVar2 = *puVar4;
            *puVar4 = uVar1;
          }
        }
      }
      goto joined_r0x00427eb3;
    }
    cVar3 = (*param_4)(*puVar5,*puVar2);
    puVar6 = puVar8;
    puVar4 = local_8;
    if (cVar3 == '\0') {
      cVar3 = (*param_4)(*puVar2,*puVar5);
      puVar7 = local_8;
      if (cVar3 != '\0') goto joined_r0x00427ef7;
      puVar6 = puVar8 + 1;
      local_c = puVar6;
      if (puVar8 != puVar2) {
        uVar1 = *puVar8;
        *puVar8 = *puVar2;
        *puVar2 = uVar1;
      }
    }
    puVar7 = puVar2 + 1;
    puVar8 = puVar6;
    puVar6 = puVar5;
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
00427e10 : PUSH EBP
00427e11 : MOV EBP,ESP
00427e13 : SUB ESP,0x10
00427e16 : MOV ECX,dword ptr [EBP + 0xc]
00427e19 : PUSH EBX
00427e1a : MOV EBX,dword ptr [EBP + 0x14]
00427e1d : PUSH ESI
00427e1e : PUSH EDI
00427e1f : MOV EDI,dword ptr [EBP + 0x10]
00427e22 : MOV EAX,EDI
00427e24 : SUB EAX,ECX
00427e26 : SAR EAX,0x2
00427e29 : CDQ
00427e2a : SUB EAX,EDX
00427e2c : SAR EAX,0x1
00427e2e : LEA ESI,[ECX + EAX*0x4]
00427e31 : LEA EAX,[EDI + -0x4]
00427e34 : PUSH EAX
00427e35 : PUSH ESI
00427e36 : PUSH ECX
00427e37 : MOV EDI,EBX
00427e39 : CALL 0x00428000
00427e3e : ADD ESP,0xc
00427e41 : LEA EDI,[ESI + 0x4]
00427e44 : MOV dword ptr [EBP + -0x8],EDI
00427e47 : CMP dword ptr [EBP + 0xc],ESI
00427e4a : JNC 0x00427e78
00427e4c : LEA ESP,[ESP]
00427e50 : MOV EAX,dword ptr [ESI]
00427e52 : MOV ECX,dword ptr [ESI + -0x4]
00427e55 : PUSH EAX
00427e56 : PUSH ECX
00427e57 : CALL EBX
00427e59 : ADD ESP,0x8
00427e5c : TEST AL,AL
00427e5e : JNZ 0x00427e78
00427e60 : MOV EDX,dword ptr [ESI + -0x4]
00427e63 : MOV EAX,dword ptr [ESI]
00427e65 : PUSH EDX
00427e66 : PUSH EAX
00427e67 : CALL EBX
00427e69 : ADD ESP,0x8
00427e6c : TEST AL,AL
00427e6e : JNZ 0x00427e78
00427e70 : ADD ESI,-0x4
00427e73 : CMP dword ptr [EBP + 0xc],ESI
00427e76 : JC 0x00427e50
00427e78 : CMP EDI,dword ptr [EBP + 0x10]
00427e7b : JNC 0x00427ea9
00427e7d : LEA ECX,[ECX]
00427e80 : MOV ECX,dword ptr [ESI]
00427e82 : MOV EDX,dword ptr [EDI]
00427e84 : PUSH ECX
00427e85 : PUSH EDX
00427e86 : CALL EBX
00427e88 : ADD ESP,0x8
00427e8b : TEST AL,AL
00427e8d : JNZ 0x00427ea9
00427e8f : MOV EAX,dword ptr [EDI]
00427e91 : MOV ECX,dword ptr [ESI]
00427e93 : PUSH EAX
00427e94 : PUSH ECX
00427e95 : CALL EBX
00427e97 : ADD ESP,0x8
00427e9a : TEST AL,AL
00427e9c : JNZ 0x00427ea9
00427e9e : ADD EDI,0x4
00427ea1 : MOV dword ptr [EBP + -0x8],EDI
00427ea4 : CMP EDI,dword ptr [EBP + 0x10]
00427ea7 : JC 0x00427e80
00427ea9 : MOV EAX,ESI
00427eab : MOV EBX,EDI
00427ead : MOV dword ptr [EBP + -0x4],EAX
00427eb0 : CMP EBX,dword ptr [EBP + 0x10]
00427eb3 : JNC 0x00427ef4
00427eb5 : MOV EDX,dword ptr [EBX]
00427eb7 : MOV EAX,dword ptr [ESI]
00427eb9 : PUSH EDX
00427eba : PUSH EAX
00427ebb : CALL dword ptr [EBP + 0x14]
00427ebe : ADD ESP,0x8
00427ec1 : TEST AL,AL
00427ec3 : JNZ 0x00427ee9
00427ec5 : MOV ECX,dword ptr [ESI]
00427ec7 : MOV EDX,dword ptr [EBX]
00427ec9 : PUSH ECX
00427eca : PUSH EDX
00427ecb : CALL dword ptr [EBP + 0x14]
00427ece : ADD ESP,0x8
00427ed1 : TEST AL,AL
00427ed3 : JNZ 0x00427ef1
00427ed5 : MOV EAX,EDI
00427ed7 : ADD EDI,0x4
00427eda : MOV dword ptr [EBP + -0x8],EDI
00427edd : CMP EAX,EBX
00427edf : JZ 0x00427ee9
00427ee1 : MOV EDX,dword ptr [EBX]
00427ee3 : MOV ECX,dword ptr [EAX]
00427ee5 : MOV dword ptr [EAX],EDX
00427ee7 : MOV dword ptr [EBX],ECX
00427ee9 : ADD EBX,0x4
00427eec : CMP EBX,dword ptr [EBP + 0x10]
00427eef : JC 0x00427eb5
00427ef1 : MOV EAX,dword ptr [EBP + -0x4]
00427ef4 : CMP EAX,dword ptr [EBP + 0xc]
00427ef7 : JBE 0x00427f49
00427ef9 : LEA EDI,[EAX + -0x4]
00427efc : LEA ESP,[ESP]
00427f00 : MOV EAX,dword ptr [ESI]
00427f02 : MOV ECX,dword ptr [EDI]
00427f04 : PUSH EAX
00427f05 : PUSH ECX
00427f06 : CALL dword ptr [EBP + 0x14]
00427f09 : ADD ESP,0x8
00427f0c : TEST AL,AL
00427f0e : JNZ 0x00427f2f
00427f10 : MOV EDX,dword ptr [EDI]
00427f12 : MOV EAX,dword ptr [ESI]
00427f14 : PUSH EDX
00427f15 : PUSH EAX
00427f16 : CALL dword ptr [EBP + 0x14]
00427f19 : ADD ESP,0x8
00427f1c : TEST AL,AL
00427f1e : JNZ 0x00427f40
00427f20 : SUB ESI,0x4
00427f23 : CMP ESI,EDI
00427f25 : JZ 0x00427f2f
00427f27 : MOV ECX,dword ptr [EDI]
00427f29 : MOV EAX,dword ptr [ESI]
00427f2b : MOV dword ptr [ESI],ECX
00427f2d : MOV dword ptr [EDI],EAX
00427f2f : MOV EAX,dword ptr [EBP + -0x4]
00427f32 : SUB EAX,0x4
00427f35 : SUB EDI,0x4
00427f38 : MOV dword ptr [EBP + -0x4],EAX
00427f3b : CMP dword ptr [EBP + 0xc],EAX
00427f3e : JC 0x00427f00
00427f40 : MOV EAX,dword ptr [EBP + -0x4]
00427f43 : MOV EDI,dword ptr [EBP + -0x8]
00427f46 : CMP EAX,dword ptr [EBP + 0xc]
00427f49 : JNZ 0x00427f98
00427f4b : CMP EBX,dword ptr [EBP + 0x10]
00427f4e : JZ 0x00427fed
00427f54 : CMP EDI,EBX
00427f56 : JZ 0x00427f64
00427f58 : CMP ESI,EDI
00427f5a : JZ 0x00427f64
00427f5c : MOV EDX,dword ptr [EDI]
00427f5e : MOV ECX,dword ptr [ESI]
00427f60 : MOV dword ptr [ESI],EDX
00427f62 : MOV dword ptr [EDI],ECX
00427f64 : MOV EDX,EBX
00427f66 : MOV ECX,ESI
00427f68 : ADD EDI,0x4
00427f6b : ADD EBX,0x4
00427f6e : ADD ESI,0x4
00427f71 : MOV dword ptr [EBP + -0x8],EDI
00427f74 : MOV dword ptr [EBP + -0xc],EDX
00427f77 : CMP ECX,EDX
00427f79 : JZ 0x00427eb0
00427f7f : MOV EDX,dword ptr [ECX]
00427f81 : MOV dword ptr [EBP + -0x10],EDX
00427f84 : MOV EDX,dword ptr [EBP + -0xc]
00427f87 : MOV EDX,dword ptr [EDX]
00427f89 : MOV dword ptr [ECX],EDX
00427f8b : MOV ECX,dword ptr [EBP + -0x10]
00427f8e : MOV EDX,dword ptr [EBP + -0xc]
00427f91 : MOV dword ptr [EDX],ECX
00427f93 : JMP 0x00427eb0
00427f98 : SUB EAX,0x4
00427f9b : MOV dword ptr [EBP + -0x4],EAX
00427f9e : CMP EBX,dword ptr [EBP + 0x10]
00427fa1 : JNZ 0x00427fcd
00427fa3 : SUB ESI,0x4
00427fa6 : CMP EAX,ESI
00427fa8 : JZ 0x00427fb2
00427faa : MOV EDX,dword ptr [ESI]
00427fac : MOV ECX,dword ptr [EAX]
00427fae : MOV dword ptr [EAX],EDX
00427fb0 : MOV dword ptr [ESI],ECX
00427fb2 : SUB EDI,0x4
00427fb5 : MOV dword ptr [EBP + -0x8],EDI
00427fb8 : CMP ESI,EDI
00427fba : JZ 0x00427eb0
00427fc0 : MOV EDX,dword ptr [EDI]
00427fc2 : MOV ECX,dword ptr [ESI]
00427fc4 : MOV dword ptr [ESI],EDX
00427fc6 : MOV dword ptr [EDI],ECX
00427fc8 : JMP 0x00427eb0
00427fcd : MOV ECX,EBX
00427fcf : ADD EBX,0x4
00427fd2 : CMP ECX,EAX
00427fd4 : JZ 0x00427eb0
00427fda : MOV EDX,dword ptr [ECX]
00427fdc : MOV dword ptr [EBP + -0x10],EDX
00427fdf : MOV EDX,dword ptr [EAX]
00427fe1 : MOV dword ptr [ECX],EDX
00427fe3 : MOV ECX,dword ptr [EBP + -0x10]
00427fe6 : MOV dword ptr [EAX],ECX
00427fe8 : JMP 0x00427eb0
00427fed : MOV EAX,dword ptr [EBP + 0x8]
00427ff0 : MOV dword ptr [EAX + 0x4],EDI
00427ff3 : POP EDI
00427ff4 : MOV dword ptr [EAX],ESI
00427ff6 : POP ESI
00427ff7 : POP EBX
00427ff8 : MOV ESP,EBP
00427ffa : POP EBP
00427ffb : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_006a76f0
ENTRY    : 006a76f0
BODY     : [[006a76f0, 006a79b7]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006a76f0(int param_1)

{
  int iVar1;
  int iVar2;
  uint in_ECX;
  char *pcVar3;
  char *_Str;
  uint *unaff_ESI;
  char *pcVar4;
  uint uVar5;
  char *pcStack_124;
  uint local_120;
  char *pcStack_11c;
  char *pcStack_118;
  int iStack_114;
  char acStack_110 [10];
  char acStack_106 [258];
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)&pcStack_124;
  local_120 = in_ECX;
  _memset(unaff_ESI,0,100);
  (*(code *)**(undefined4 **)(param_1 + 4))();
  unaff_ESI[0x12] = in_ECX;
  iStack_114 = FUN_00687830();
  iVar1 = FUN_00688900();
  if (iVar1 == 0) {
    iVar1 = _strncmp(*(char **)(in_ECX + 0x20),"%!PS-Adobe-3.0 Resource-CIDFont",0x1f);
    FUN_006889b0();
    if (iVar1 == 0) {
LAB_006a7780:
      uVar5 = local_120;
      iVar1 = 0x10a;
      pcVar3 = acStack_110;
      pcStack_124 = (char *)FUN_00687830(local_120);
      while( true ) {
        iVar2 = FUN_00687830(uVar5);
        iVar2 = *(int *)(uVar5 + 4) - iVar2;
        if (iVar2 == 0) break;
        if (iVar2 <= iVar1) {
          iVar1 = iVar2;
        }
        iVar2 = FUN_006888a0(uVar5,pcVar3,iVar1);
        if (iVar2 != 0) break;
        if (iVar1 < 0x100) {
          pcVar3[iVar1] = '\0';
        }
        for (pcVar4 = acStack_110; pcVar4 < pcVar3 + iVar1 + -10; pcVar4 = pcVar4 + 1) {
          if ((*pcVar4 == 'S') && (iVar2 = _strncmp(pcVar4,"StartData",9), iVar2 == 0)) {
            pcStack_124 = pcStack_124 + (10 - (int)acStack_110);
LAB_006a7864:
            pcStack_124 = pcVar4 + (int)pcStack_124;
            uVar5 = (int)pcStack_124 - iStack_114;
            iVar1 = FUN_006877c0(local_120,iStack_114);
            if (iVar1 != 0) goto LAB_006a799e;
            iVar1 = FUN_0068a1f0(local_120,uVar5,unaff_ESI + 0x13);
            if (iVar1 != 0) goto LAB_006a799e;
            pcStack_11c = (char *)unaff_ESI[0x13];
            unaff_ESI[1] = (uint)pcStack_11c;
            *unaff_ESI = (uint)pcStack_11c;
            unaff_ESI[0x15] = (uint)pcStack_124;
            unaff_ESI[0x14] = uVar5;
            unaff_ESI[2] = (uint)(pcStack_11c + uVar5);
            unaff_ESI[0x18] = 0xffffffff;
            (*(code *)unaff_ESI[8])();
            (*(code *)unaff_ESI[7])();
            pcVar3 = (char *)*unaff_ESI;
            (*(code *)unaff_ESI[8])();
            (*(code *)unaff_ESI[7])();
            pcStack_118 = (char *)unaff_ESI[2];
            pcVar4 = (char *)*unaff_ESI;
            if (pcStack_118 <= (char *)*unaff_ESI) goto LAB_006a7946;
            goto LAB_006a78f0;
          }
          if ((pcVar4[1] == 's') && (iVar2 = _strncmp(pcVar4,"/sfnts",6), iVar2 == 0)) {
            pcStack_124 = pcStack_124 + (7 - (int)acStack_110);
            goto LAB_006a7864;
          }
        }
        _memmove(acStack_110,pcVar4,10);
        iVar1 = 0x100;
        pcStack_124 = pcStack_124 + 0x100;
        pcVar3 = acStack_106;
        uVar5 = local_120;
      }
    }
  }
LAB_006a799e:
  __security_check_cookie(local_4 ^ (uint)&pcStack_124);
  return;
  while( true ) {
    if ((*pcVar4 == 'S') && (iVar1 = _strncmp(pcVar4,"StartData",9), iVar1 == 0)) {
      iVar1 = _strncmp(pcStack_11c,"(Hex)",5);
      if (iVar1 == 0) {
        uVar5 = _atol(_Str);
        unaff_ESI[0x16] = uVar5;
      }
      goto LAB_006a799e;
    }
    if ((pcVar4[1] == 's') && (iVar1 = _strncmp(pcVar4,"/sfnts",6), iVar1 == 0)) goto LAB_006a799e;
    (*(code *)unaff_ESI[8])();
    (*(code *)unaff_ESI[7])();
    pcVar3 = pcVar4;
    pcVar4 = (char *)*unaff_ESI;
    pcStack_11c = _Str;
    if (pcStack_118 <= (char *)*unaff_ESI) break;
LAB_006a78f0:
    _Str = pcVar3;
    if (unaff_ESI[3] != 0) goto LAB_006a799e;
  }
LAB_006a7946:
  uVar5 = local_120;
  FUN_006888c0(local_120,unaff_ESI + 0x13);
  iVar1 = FUN_006877c0(uVar5,pcStack_124);
  if (iVar1 != 0) goto LAB_006a799e;
  goto LAB_006a7780;
}



============================================================
DISASSEMBLY
============================================================
006a76f0 : SUB ESP,0x124
006a76f6 : MOV EAX,[0x00d66fa0]
006a76fb : XOR EAX,ESP
006a76fd : MOV dword ptr [ESP + 0x120],EAX
006a7704 : PUSH EBX
006a7705 : PUSH EBP
006a7706 : MOV EBP,dword ptr [ESP + 0x130]
006a770d : PUSH EDI
006a770e : PUSH 0x64
006a7710 : MOV EDI,ECX
006a7712 : PUSH 0x0
006a7714 : PUSH ESI
006a7715 : MOV dword ptr [ESP + 0x1c],EDI
006a7719 : MOV EBX,EDX
006a771b : CALL 0x0063b700
006a7720 : MOV EAX,dword ptr [EBP + 0x4]
006a7723 : MOV ECX,dword ptr [EAX]
006a7725 : PUSH EBX
006a7726 : PUSH 0x0
006a7728 : PUSH 0x0
006a772a : PUSH ESI
006a772b : CALL ECX
006a772d : PUSH EDI
006a772e : MOV dword ptr [ESI + 0x48],EDI
006a7731 : CALL 0x00687830
006a7736 : PUSH 0x1f
006a7738 : PUSH EDI
006a7739 : MOV dword ptr [ESP + 0x44],EAX
006a773d : CALL 0x00688900
006a7742 : MOV EBP,EAX
006a7744 : ADD ESP,0x28
006a7747 : TEST EBP,EBP
006a7749 : JNZ 0x006a799e
006a774f : MOV EDX,dword ptr [EDI + 0x20]
006a7752 : PUSH 0x1f
006a7754 : PUSH 0xbea17c
006a7759 : PUSH EDX
006a775a : CALL 0x0063abcb
006a775f : ADD ESP,0xc
006a7762 : TEST EAX,EAX
006a7764 : JZ 0x006a776b
006a7766 : MOV EBP,0x2
006a776b : PUSH EDI
006a776c : CALL 0x006889b0
006a7771 : ADD ESP,0x4
006a7774 : TEST EBP,EBP
006a7776 : JNZ 0x006a799e
006a777c : LEA ESP,[ESP]
006a7780 : MOV EBP,dword ptr [ESP + 0x10]
006a7784 : PUSH EBP
006a7785 : MOV EDI,0x10a
006a778a : LEA EBX,[ESP + 0x24]
006a778e : CALL 0x00687830
006a7793 : ADD ESP,0x4
006a7796 : MOV dword ptr [ESP + 0xc],EAX
006a779a : LEA EBX,[EBX]
006a77a0 : PUSH EBP
006a77a1 : CALL 0x00687830
006a77a6 : MOV ECX,dword ptr [EBP + 0x4]
006a77a9 : ADD ESP,0x4
006a77ac : SUB ECX,EAX
006a77ae : JZ 0x006a7999
006a77b4 : CMP EDI,ECX
006a77b6 : JL 0x006a77ba
006a77b8 : MOV EDI,ECX
006a77ba : PUSH EDI
006a77bb : PUSH EBX
006a77bc : PUSH EBP
006a77bd : CALL 0x006888a0
006a77c2 : MOV EBP,EAX
006a77c4 : ADD ESP,0xc
006a77c7 : TEST EBP,EBP
006a77c9 : JNZ 0x006a799e
006a77cf : CMP EDI,0x100
006a77d5 : JGE 0x006a77da
006a77d7 : MOV byte ptr [EBX + EDI*0x1],AL
006a77da : LEA EBX,[EBX + EDI*0x1 + -0xa]
006a77de : LEA EDI,[ESP + 0x20]
006a77e2 : MOV EAX,EDI
006a77e4 : CMP EAX,EBX
006a77e6 : JNC 0x006a7820
006a77e8 : CMP byte ptr [EDI],0x53
006a77eb : JNZ 0x006a7801
006a77ed : PUSH 0x9
006a77ef : PUSH 0xbea170
006a77f4 : PUSH EDI
006a77f5 : CALL 0x0063abcb
006a77fa : ADD ESP,0xc
006a77fd : TEST EAX,EAX
006a77ff : JZ 0x006a7846
006a7801 : CMP byte ptr [EDI + 0x1],0x73
006a7805 : JNZ 0x006a781b
006a7807 : PUSH 0x6
006a7809 : PUSH 0xbea168
006a780e : PUSH EDI
006a780f : CALL 0x0063abcb
006a7814 : ADD ESP,0xc
006a7817 : TEST EAX,EAX
006a7819 : JZ 0x006a7856
006a781b : INC EDI
006a781c : CMP EDI,EBX
006a781e : JC 0x006a77e8
006a7820 : PUSH 0xa
006a7822 : LEA ECX,[ESP + 0x24]
006a7826 : PUSH EDI
006a7827 : PUSH ECX
006a7828 : CALL 0x00636880
006a782d : MOV EBP,dword ptr [ESP + 0x1c]
006a7831 : MOV EDI,0x100
006a7836 : ADD ESP,0xc
006a7839 : ADD dword ptr [ESP + 0xc],EDI
006a783d : LEA EBX,[ESP + 0x2a]
006a7841 : JMP 0x006a77a0
006a7846 : MOV EAX,dword ptr [ESP + 0xc]
006a784a : LEA EDX,[ESP + 0x20]
006a784e : SUB EDI,EDX
006a7850 : LEA ECX,[EAX + EDI*0x1 + 0xa]
006a7854 : JMP 0x006a7864
006a7856 : MOV EAX,dword ptr [ESP + 0xc]
006a785a : LEA EDX,[ESP + 0x20]
006a785e : SUB EDI,EDX
006a7860 : LEA ECX,[EAX + EDI*0x1 + 0x7]
006a7864 : MOV EAX,dword ptr [ESP + 0x1c]
006a7868 : MOV EDX,dword ptr [ESP + 0x10]
006a786c : PUSH EAX
006a786d : MOV EDI,ECX
006a786f : PUSH EDX
006a7870 : MOV dword ptr [ESP + 0x14],ECX
006a7874 : SUB EDI,EAX
006a7876 : CALL 0x006877c0
006a787b : MOV EBP,EAX
006a787d : ADD ESP,0x8
006a7880 : TEST EBP,EBP
006a7882 : JNZ 0x006a799e
006a7888 : MOV EAX,dword ptr [ESP + 0x10]
006a788c : LEA EBX,[ESI + 0x4c]
006a788f : PUSH EBX
006a7890 : PUSH EDI
006a7891 : PUSH EAX
006a7892 : CALL 0x0068a1f0
006a7897 : MOV EBP,EAX
006a7899 : ADD ESP,0xc
006a789c : TEST EBP,EBP
006a789e : JNZ 0x006a799e
006a78a4 : MOV EAX,dword ptr [EBX]
006a78a6 : MOV ECX,dword ptr [ESP + 0xc]
006a78aa : LEA EDX,[EAX + EDI*0x1]
006a78ad : MOV dword ptr [ESI + 0x4],EAX
006a78b0 : MOV dword ptr [ESI],EAX
006a78b2 : MOV dword ptr [ESP + 0x14],EAX
006a78b6 : MOV EAX,dword ptr [ESI + 0x20]
006a78b9 : PUSH ESI
006a78ba : MOV dword ptr [ESI + 0x54],ECX
006a78bd : MOV dword ptr [ESI + 0x50],EDI
006a78c0 : MOV dword ptr [ESI + 0x8],EDX
006a78c3 : MOV dword ptr [ESI + 0x60],0xffffffff
006a78ca : CALL EAX
006a78cc : MOV ECX,dword ptr [ESI + 0x1c]
006a78cf : PUSH ESI
006a78d0 : CALL ECX
006a78d2 : MOV EDX,dword ptr [ESI + 0x20]
006a78d5 : MOV EBX,dword ptr [ESI]
006a78d7 : PUSH ESI
006a78d8 : CALL EDX
006a78da : MOV EAX,dword ptr [ESI + 0x1c]
006a78dd : PUSH ESI
006a78de : CALL EAX
006a78e0 : MOV EAX,dword ptr [ESI + 0x8]
006a78e3 : MOV EDI,dword ptr [ESI]
006a78e5 : ADD ESP,0x10
006a78e8 : MOV dword ptr [ESP + 0x18],EAX
006a78ec : CMP EDI,EAX
006a78ee : JNC 0x006a7946
006a78f0 : CMP dword ptr [ESI + 0xc],0x0
006a78f4 : JNZ 0x006a796e
006a78f6 : CMP byte ptr [EDI],0x53
006a78f9 : JNZ 0x006a790f
006a78fb : PUSH 0x9
006a78fd : PUSH 0xbea170
006a7902 : PUSH EDI
006a7903 : CALL 0x0063abcb
006a7908 : ADD ESP,0xc
006a790b : TEST EAX,EAX
006a790d : JZ 0x006a7973
006a790f : CMP byte ptr [EDI + 0x1],0x73
006a7913 : JNZ 0x006a7929
006a7915 : PUSH 0x6
006a7917 : PUSH 0xbea168
006a791c : PUSH EDI
006a791d : CALL 0x0063abcb
006a7922 : ADD ESP,0xc
006a7925 : TEST EAX,EAX
006a7927 : JZ 0x006a7999
006a7929 : MOV ECX,dword ptr [ESI + 0x20]
006a792c : PUSH ESI
006a792d : CALL ECX
006a792f : MOV EDX,dword ptr [ESI + 0x1c]
006a7932 : PUSH ESI
006a7933 : CALL EDX
006a7935 : MOV dword ptr [ESP + 0x1c],EBX
006a7939 : MOV EBX,EDI
006a793b : MOV EDI,dword ptr [ESI]
006a793d : ADD ESP,0x8
006a7940 : CMP EDI,dword ptr [ESP + 0x18]
006a7944 : JC 0x006a78f0
006a7946 : MOV EDI,dword ptr [ESP + 0x10]
006a794a : LEA EAX,[ESI + 0x4c]
006a794d : PUSH EAX
006a794e : PUSH EDI
006a794f : CALL 0x006888c0
006a7954 : MOV EAX,dword ptr [ESP + 0x14]
006a7958 : PUSH EAX
006a7959 : PUSH EDI
006a795a : CALL 0x006877c0
006a795f : MOV EBP,EAX
006a7961 : ADD ESP,0x10
006a7964 : TEST EBP,EBP
006a7966 : JZ 0x006a7780
006a796c : JMP 0x006a799e
006a796e : MOV EBP,dword ptr [ESI + 0xc]
006a7971 : JMP 0x006a799e
006a7973 : MOV ECX,dword ptr [ESP + 0x14]
006a7977 : PUSH 0x5
006a7979 : PUSH 0xbea160
006a797e : PUSH ECX
006a797f : CALL 0x0063abcb
006a7984 : ADD ESP,0xc
006a7987 : TEST EAX,EAX
006a7989 : JNZ 0x006a799e
006a798b : PUSH EBX
006a798c : CALL 0x00634f16
006a7991 : ADD ESP,0x4
006a7994 : MOV dword ptr [ESI + 0x58],EAX
006a7997 : JMP 0x006a799e
006a7999 : MOV EBP,0x2
006a799e : MOV ECX,dword ptr [ESP + 0x12c]
006a79a5 : POP EDI
006a79a6 : MOV EAX,EBP
006a79a8 : POP EBP
006a79a9 : POP EBX
006a79aa : XOR ECX,ESP
006a79ac : CALL 0x00633e6b
006a79b1 : ADD ESP,0x124
006a79b7 : RET

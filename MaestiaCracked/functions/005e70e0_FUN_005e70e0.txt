PROGRAM  : Maestia.exe
FUNCTION : FUN_005e70e0
ENTRY    : 005e70e0
BODY     : [[005e70e0, 005e721b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005e70e0(int param_1,uint param_2,undefined4 param_3,undefined4 param_4,ushort param_5,
                 undefined2 param_6,undefined2 param_7)

{
  int iVar1;
  GRefCountNTSImpl *this;
  undefined4 uVar2;
  int *piVar3;
  int *unaff_EBX;
  int local_10;
  int local_c;
  int *local_8;
  undefined4 local_4;
  
  *unaff_EBX = 0;
  unaff_EBX[1] = 0;
  this = (GRefCountNTSImpl *)FUN_00515840(0x20,0);
  if (this != (GRefCountNTSImpl *)0x0) {
    FUN_00523eb0();
    *(undefined ***)this = &PTR_LAB_00b8f0ec;
    FUN_0051b6e0();
    *(undefined2 *)(this + 0x16) = 0;
    *(undefined4 *)(this + 0x18) = 1;
    FUN_0051bb20(param_3);
    FUN_0051bb20(param_4);
    *(uint *)(this + 0xc) =
         -(uint)(*(int *)(*(int *)(param_1 + 0x20) + 0x4c) != 0) & *(int *)(param_1 + 0x20) + 0x4cU;
    *(uint *)(this + 8) = (uint)param_5;
    *(undefined2 *)(this + 0x14) = param_6;
    *(undefined2 *)(this + 0x16) = param_7;
    if ((param_2 & 0xfff0000) == 0x60000) {
      *(undefined4 *)(this + 0x18) = 3;
    }
    uVar2 = FUN_005a09b0(&local_8,this);
    piVar3 = (int *)FUN_005a1610(&local_10,param_2,uVar2);
    if ((*piVar3 == 0) && ((GRefCountImpl *)piVar3[1] != (GRefCountImpl *)0x0)) {
      GRefCountImpl::AddRef((GRefCountImpl *)piVar3[1]);
    }
    if ((*unaff_EBX == 0) && (unaff_EBX[1] != 0)) {
      FUN_00524240();
    }
    iVar1 = piVar3[1];
    *unaff_EBX = *piVar3;
    unaff_EBX[1] = iVar1;
    if ((local_10 == 0) && (local_c != 0)) {
      FUN_00524240();
    }
    if (local_8 != (int *)0x0) {
      (**(code **)(*local_8 + 8))(local_4);
    }
    GRefCountNTSImpl::Release(this);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005e70e0 : MOV ECX,dword ptr [0x00d73250]
005e70e6 : SUB ESP,0x10
005e70e9 : PUSH EBP
005e70ea : MOV EBP,dword ptr [ESP + 0x18]
005e70ee : PUSH ESI
005e70ef : PUSH EDI
005e70f0 : PUSH 0x0
005e70f2 : PUSH 0x20
005e70f4 : MOV dword ptr [EBX],0x0
005e70fa : MOV dword ptr [EBX + 0x4],0x0
005e7101 : CALL 0x00515840
005e7106 : MOV ESI,EAX
005e7108 : TEST ESI,ESI
005e710a : JZ 0x005e7213
005e7110 : MOV ECX,ESI
005e7112 : CALL 0x00523eb0
005e7117 : LEA EDI,[ESI + 0x1c]
005e711a : MOV ECX,EDI
005e711c : MOV dword ptr [ESI],0xb8f0ec
005e7122 : CALL 0x0051b6e0
005e7127 : MOV ECX,dword ptr [ESP + 0x28]
005e712b : XOR EAX,EAX
005e712d : PUSH ECX
005e712e : LEA ECX,[ESI + 0x10]
005e7131 : MOV word ptr [ESI + 0x16],AX
005e7135 : MOV dword ptr [ESI + 0x18],0x1
005e713c : CALL 0x0051bb20
005e7141 : MOV EDX,dword ptr [ESP + 0x2c]
005e7145 : PUSH EDX
005e7146 : MOV ECX,EDI
005e7148 : CALL 0x0051bb20
005e714d : MOV EAX,dword ptr [EBP + 0x20]
005e7150 : MOV ECX,dword ptr [EAX + 0x4c]
005e7153 : MOVZX EDX,word ptr [ESP + 0x30]
005e7158 : ADD EAX,0x4c
005e715b : NEG ECX
005e715d : SBB ECX,ECX
005e715f : AND ECX,EAX
005e7161 : MOV AX,word ptr [ESP + 0x34]
005e7166 : MOV dword ptr [ESI + 0xc],ECX
005e7169 : MOV CX,word ptr [ESP + 0x38]
005e716e : MOV dword ptr [ESI + 0x8],EDX
005e7171 : MOV word ptr [ESI + 0x14],AX
005e7175 : MOV word ptr [ESI + 0x16],CX
005e7179 : MOV EDX,dword ptr [ESP + 0x24]
005e717d : AND EDX,0xfff0000
005e7183 : CMP EDX,0x60000
005e7189 : JNZ 0x005e7192
005e718b : MOV dword ptr [ESI + 0x18],0x3
005e7192 : LEA EAX,[ESP + 0x14]
005e7196 : PUSH ESI
005e7197 : PUSH EAX
005e7198 : CALL 0x005a09b0
005e719d : ADD ESP,0x8
005e71a0 : PUSH EAX
005e71a1 : PUSH ECX
005e71a2 : MOV ECX,dword ptr [ESP + 0x2c]
005e71a6 : MOV EAX,ESP
005e71a8 : LEA EDX,[ESP + 0x14]
005e71ac : MOV dword ptr [EAX],ECX
005e71ae : PUSH EDX
005e71af : MOV ECX,EBP
005e71b1 : CALL 0x005a1610
005e71b6 : MOV EDI,EAX
005e71b8 : CMP dword ptr [EDI],0x0
005e71bb : JNZ 0x005e71c9
005e71bd : MOV ECX,dword ptr [EDI + 0x4]
005e71c0 : TEST ECX,ECX
005e71c2 : JZ 0x005e71c9
005e71c4 : CALL 0x00523dd0
005e71c9 : CMP dword ptr [EBX],0x0
005e71cc : JNZ 0x005e71da
005e71ce : MOV ECX,dword ptr [EBX + 0x4]
005e71d1 : TEST ECX,ECX
005e71d3 : JZ 0x005e71da
005e71d5 : CALL 0x00524240
005e71da : CMP dword ptr [ESP + 0xc],0x0
005e71df : MOV EAX,dword ptr [EDI]
005e71e1 : MOV ECX,dword ptr [EDI + 0x4]
005e71e4 : MOV dword ptr [EBX],EAX
005e71e6 : MOV dword ptr [EBX + 0x4],ECX
005e71e9 : JNZ 0x005e71f8
005e71eb : MOV ECX,dword ptr [ESP + 0x10]
005e71ef : TEST ECX,ECX
005e71f1 : JZ 0x005e71f8
005e71f3 : CALL 0x00524240
005e71f8 : MOV ECX,dword ptr [ESP + 0x14]
005e71fc : TEST ECX,ECX
005e71fe : JZ 0x005e720c
005e7200 : MOV EDX,dword ptr [ECX]
005e7202 : MOV EAX,dword ptr [ESP + 0x18]
005e7206 : MOV EDX,dword ptr [EDX + 0x8]
005e7209 : PUSH EAX
005e720a : CALL EDX
005e720c : MOV ECX,ESI
005e720e : CALL 0x004ff7c0
005e7213 : POP EDI
005e7214 : POP ESI
005e7215 : MOV EAX,EBX
005e7217 : POP EBP
005e7218 : ADD ESP,0x10
005e721b : RET

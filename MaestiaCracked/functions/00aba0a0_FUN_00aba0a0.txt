PROGRAM  : Maestia.exe
FUNCTION : FUN_00aba0a0
ENTRY    : 00aba0a0
BODY     : [[00aba0a0, 00aba2eb]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00aba0a0(int param_1)

{
  int iVar1;
  uint uVar2;
  byte bVar3;
  ushort *in_EAX;
  int *piVar4;
  uint uVar5;
  ushort *puVar6;
  int local_30;
  uint local_2c;
  uint local_28;
  uint local_24;
  uint local_20;
  ushort *local_1c;
  uint local_18;
  uint local_14;
  int local_10;
  int local_c;
  byte local_8;
  byte local_7;
  byte local_6;
  char local_5;
  
  if ((in_EAX + 2 == (ushort *)0x0) || ((*in_EAX & 0x1fff) == 4)) {
    uVar5 = 0;
    puVar6 = (ushort *)0x0;
    bVar3 = param_1._3_1_;
  }
  else {
    uVar5 = (*in_EAX & 0x1fff) - 5;
    puVar6 = (ushort *)((int)in_EAX + 5);
    bVar3 = (byte)in_EAX[2];
  }
  local_24 = (uint)bVar3;
  do {
    if (local_24 == 0) {
      return;
    }
    if ((puVar6 == (ushort *)0x0) || (uVar5 < 2)) {
LAB_00aba105:
      uVar5 = 0;
      puVar6 = (ushort *)0x0;
    }
    else {
      local_28 = (uint)*puVar6;
      if ((puVar6 + 1 == (ushort *)0x0) || (uVar5 == 2)) goto LAB_00aba105;
      local_6 = (byte)puVar6[1];
      uVar5 = uVar5 - 3;
      puVar6 = (ushort *)((int)puVar6 + 3);
    }
    local_5 = '\x01';
    FUN_00413b60(&local_28);
    if (local_10 == *(int *)(param_1 + 0x40)) {
      local_5 = '\0';
    }
    uVar2 = (uint)local_6;
    if (local_6 != 0) {
      do {
        local_20 = uVar2;
        if ((puVar6 == (ushort *)0x0) || (uVar5 < 2)) {
LAB_00aba165:
          uVar5 = 0;
          puVar6 = (ushort *)0x0;
        }
        else {
          local_2c = (uint)*puVar6;
          if ((puVar6 + 1 == (ushort *)0x0) || (uVar5 == 2)) goto LAB_00aba165;
          local_7 = (byte)puVar6[1];
          uVar5 = uVar5 - 3;
          puVar6 = (ushort *)((int)puVar6 + 3);
        }
        iVar1 = *(int *)(*(int *)(local_10 + 0x10) + 0x50);
        local_c = iVar1;
        if (local_5 == '\x01') {
          piVar4 = (int *)FUN_00413b60(&local_2c);
          local_c = *piVar4;
          if (local_c == iVar1) {
            local_5 = '\0';
          }
        }
        if (local_7 != 0) {
          local_1c = (ushort *)(uint)(ushort)local_7;
          do {
            if ((puVar6 == (ushort *)0x0) || (uVar5 == 0)) {
LAB_00aba1f0:
              uVar5 = 0;
              puVar6 = (ushort *)0x0;
            }
            else {
              local_8 = (byte)*puVar6;
              if (((ushort *)((int)puVar6 + 1) == (ushort *)0x0) || (uVar5 - 1 < 2))
              goto LAB_00aba1f0;
              local_14 = (uint)*(ushort *)((int)puVar6 + 1);
              if (((ushort *)((int)puVar6 + 3) == (ushort *)0x0) || (uVar5 - 3 < 2))
              goto LAB_00aba1f0;
              local_18 = (uint)*(ushort *)((int)puVar6 + 3);
              uVar5 = uVar5 - 5;
              puVar6 = (ushort *)((int)puVar6 + 5);
            }
            if (local_5 == '\x01') {
              if ((local_8 & 1) == 0) {
                if ((local_8 & 2) == 0) {
                  if ((local_8 & 4) != 0) {
                    iVar1 = *(int *)(local_c + 0x10);
                    piVar4 = (int *)FUN_00413b60(&local_14);
                    if (*piVar4 != *(int *)(iVar1 + 0x28)) {
                      *(undefined2 *)(*(int *)(*piVar4 + 0x10) + 0x22) = (undefined2)local_18;
                      goto LAB_00aba289;
                    }
                  }
                }
                else {
                  iVar1 = *(int *)(local_c + 0x10);
                  piVar4 = (int *)FUN_00413b60(&local_14);
                  if (*piVar4 != *(int *)(iVar1 + 0x1c)) {
                    *(undefined2 *)(*(int *)(*piVar4 + 0x10) + 0x22) = (undefined2)local_18;
                    goto LAB_00aba289;
                  }
                }
              }
              else {
                iVar1 = *(int *)(local_c + 0x10);
                piVar4 = (int *)FUN_00413b60(&local_14);
                if (*piVar4 != *(int *)(iVar1 + 0x10)) {
                  *(undefined2 *)(*(int *)(*piVar4 + 0x10) + 0x22) = (undefined2)local_18;
                  goto LAB_00aba289;
                }
              }
              local_5 = '\0';
            }
LAB_00aba289:
            local_1c = (ushort *)((int)local_1c + -1);
          } while (local_1c != (ushort *)0x0);
        }
        uVar2 = local_20 - 1;
      } while (local_20 - 1 != 0);
      local_20 = 0;
    }
    if (local_5 == '\x01') {
      local_1c = *(ushort **)(local_10 + 0x10);
      local_20 = (uint)*local_1c;
      FUN_00413b60(&local_20);
      if (local_30 != *(int *)(param_1 + 0x4c)) {
        FUN_00ab9740(*(undefined4 *)local_1c);
      }
    }
    local_24 = local_24 - 1;
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
00aba0a0 : PUSH EBP
00aba0a1 : MOV EBP,ESP
00aba0a3 : SUB ESP,0x3c
00aba0a6 : PUSH EBX
00aba0a7 : MOVZX EBX,word ptr [EAX]
00aba0aa : AND EBX,0x1fff
00aba0b0 : PUSH ESI
00aba0b1 : LEA ESI,[EAX + 0x4]
00aba0b4 : SUB EBX,0x4
00aba0b7 : TEST ESI,ESI
00aba0b9 : JZ 0x00aba0c6
00aba0bb : CMP EBX,0x1
00aba0be : JC 0x00aba0c6
00aba0c0 : MOV AL,byte ptr [ESI]
00aba0c2 : DEC EBX
00aba0c3 : INC ESI
00aba0c4 : JMP 0x00aba0cd
00aba0c6 : MOV AL,byte ptr [EBP + 0xb]
00aba0c9 : XOR EBX,EBX
00aba0cb : XOR ESI,ESI
00aba0cd : MOVZX EAX,AL
00aba0d0 : TEST EAX,EAX
00aba0d2 : JLE 0x00aba2e4
00aba0d8 : MOV dword ptr [EBP + -0x20],EAX
00aba0db : PUSH EDI
00aba0dc : LEA ESP,[ESP]
00aba0e0 : TEST ESI,ESI
00aba0e2 : JZ 0x00aba105
00aba0e4 : CMP EBX,0x2
00aba0e7 : JC 0x00aba105
00aba0e9 : MOVZX EAX,word ptr [ESI]
00aba0ec : SUB EBX,0x2
00aba0ef : ADD ESI,0x2
00aba0f2 : MOV dword ptr [EBP + -0x24],EAX
00aba0f5 : JZ 0x00aba105
00aba0f7 : CMP EBX,0x1
00aba0fa : JC 0x00aba105
00aba0fc : MOV CL,byte ptr [ESI]
00aba0fe : DEC EBX
00aba0ff : MOV byte ptr [EBP + -0x2],CL
00aba102 : INC ESI
00aba103 : JMP 0x00aba109
00aba105 : XOR EBX,EBX
00aba107 : XOR ESI,ESI
00aba109 : MOV EDI,dword ptr [EBP + 0x8]
00aba10c : LEA EDX,[EBP + -0x24]
00aba10f : PUSH EDX
00aba110 : LEA EAX,[EBP + -0xc]
00aba113 : LEA ECX,[EDI + 0x3c]
00aba116 : MOV byte ptr [EBP + -0x1],0x1
00aba11a : CALL 0x00413b60
00aba11f : MOV EAX,dword ptr [EBP + -0xc]
00aba122 : CMP EAX,dword ptr [EDI + 0x40]
00aba125 : JNZ 0x00aba12b
00aba127 : MOV byte ptr [EBP + -0x1],0x0
00aba12b : MOVZX EAX,byte ptr [EBP + -0x2]
00aba12f : TEST EAX,EAX
00aba131 : JLE 0x00aba2a0
00aba137 : MOV dword ptr [EBP + -0x1c],EAX
00aba13a : LEA EBX,[EBX]
00aba140 : TEST ESI,ESI
00aba142 : JZ 0x00aba165
00aba144 : CMP EBX,0x2
00aba147 : JC 0x00aba165
00aba149 : MOVZX ECX,word ptr [ESI]
00aba14c : SUB EBX,0x2
00aba14f : ADD ESI,0x2
00aba152 : MOV dword ptr [EBP + -0x28],ECX
00aba155 : JZ 0x00aba165
00aba157 : CMP EBX,0x1
00aba15a : JC 0x00aba165
00aba15c : MOV DL,byte ptr [ESI]
00aba15e : DEC EBX
00aba15f : MOV byte ptr [EBP + -0x3],DL
00aba162 : INC ESI
00aba163 : JMP 0x00aba169
00aba165 : XOR EBX,EBX
00aba167 : XOR ESI,ESI
00aba169 : CMP byte ptr [EBP + -0x1],0x1
00aba16d : MOV EAX,dword ptr [EBP + -0xc]
00aba170 : MOV ECX,dword ptr [EAX + 0x10]
00aba173 : MOV EDI,dword ptr [ECX + 0x50]
00aba176 : MOV dword ptr [EBP + -0x8],EDI
00aba179 : JNZ 0x00aba19a
00aba17b : MOV ECX,dword ptr [EAX + 0x10]
00aba17e : LEA EDX,[EBP + -0x28]
00aba181 : PUSH EDX
00aba182 : ADD ECX,0x4c
00aba185 : LEA EAX,[EBP + -0x30]
00aba188 : CALL 0x00413b60
00aba18d : MOV EAX,dword ptr [EAX]
00aba18f : MOV dword ptr [EBP + -0x8],EAX
00aba192 : CMP EAX,EDI
00aba194 : JNZ 0x00aba19a
00aba196 : MOV byte ptr [EBP + -0x1],0x0
00aba19a : MOVZX CX,byte ptr [EBP + -0x3]
00aba19f : MOVZX EAX,CX
00aba1a2 : XOR EDX,EDX
00aba1a4 : CMP DX,AX
00aba1a7 : JNC 0x00aba293
00aba1ad : MOVZX EAX,AX
00aba1b0 : MOV dword ptr [EBP + -0x18],EAX
00aba1b3 : TEST ESI,ESI
00aba1b5 : JZ 0x00aba1ed
00aba1b7 : CMP EBX,0x1
00aba1ba : JC 0x00aba1ed
00aba1bc : MOV AL,byte ptr [ESI]
00aba1be : DEC EBX
00aba1bf : ADD ESI,0x1
00aba1c2 : MOV byte ptr [EBP + -0x4],AL
00aba1c5 : JZ 0x00aba1f0
00aba1c7 : CMP EBX,0x2
00aba1ca : JC 0x00aba1f0
00aba1cc : MOVZX ECX,word ptr [ESI]
00aba1cf : SUB EBX,0x2
00aba1d2 : ADD ESI,0x2
00aba1d5 : MOV dword ptr [EBP + -0x10],ECX
00aba1d8 : JZ 0x00aba1f0
00aba1da : CMP EBX,0x2
00aba1dd : JC 0x00aba1f0
00aba1df : MOVZX EDX,word ptr [ESI]
00aba1e2 : SUB EBX,0x2
00aba1e5 : MOV dword ptr [EBP + -0x14],EDX
00aba1e8 : ADD ESI,0x2
00aba1eb : JMP 0x00aba1f4
00aba1ed : MOV AL,byte ptr [EBP + -0x4]
00aba1f0 : XOR EBX,EBX
00aba1f2 : XOR ESI,ESI
00aba1f4 : CMP byte ptr [EBP + -0x1],0x1
00aba1f8 : JNZ 0x00aba289
00aba1fe : TEST AL,0x1
00aba200 : JZ 0x00aba22b
00aba202 : MOV EAX,dword ptr [EBP + -0x8]
00aba205 : MOV EDI,dword ptr [EAX + 0x10]
00aba208 : LEA ECX,[EBP + -0x10]
00aba20b : PUSH ECX
00aba20c : LEA ECX,[EDI + 0xc]
00aba20f : LEA EAX,[EBP + -0x34]
00aba212 : CALL 0x00413b60
00aba217 : MOV EAX,dword ptr [EAX]
00aba219 : CMP EAX,dword ptr [EDI + 0x10]
00aba21c : JZ 0x00aba285
00aba21e : MOV EDX,dword ptr [EAX + 0x10]
00aba221 : MOV AX,word ptr [EBP + -0x14]
00aba225 : MOV word ptr [EDX + 0x22],AX
00aba229 : JMP 0x00aba289
00aba22b : TEST AL,0x2
00aba22d : JZ 0x00aba258
00aba22f : MOV ECX,dword ptr [EBP + -0x8]
00aba232 : MOV EDI,dword ptr [ECX + 0x10]
00aba235 : LEA EDX,[EBP + -0x10]
00aba238 : PUSH EDX
00aba239 : LEA ECX,[EDI + 0x18]
00aba23c : LEA EAX,[EBP + -0x38]
00aba23f : CALL 0x00413b60
00aba244 : MOV EAX,dword ptr [EAX]
00aba246 : CMP EAX,dword ptr [EDI + 0x1c]
00aba249 : JZ 0x00aba285
00aba24b : MOV EAX,dword ptr [EAX + 0x10]
00aba24e : MOV CX,word ptr [EBP + -0x14]
00aba252 : MOV word ptr [EAX + 0x22],CX
00aba256 : JMP 0x00aba289
00aba258 : TEST AL,0x4
00aba25a : JZ 0x00aba285
00aba25c : MOV EDX,dword ptr [EBP + -0x8]
00aba25f : MOV EDI,dword ptr [EDX + 0x10]
00aba262 : LEA EAX,[EBP + -0x10]
00aba265 : PUSH EAX
00aba266 : LEA ECX,[EDI + 0x24]
00aba269 : LEA EAX,[EBP + -0x3c]
00aba26c : CALL 0x00413b60
00aba271 : MOV EAX,dword ptr [EAX]
00aba273 : CMP EAX,dword ptr [EDI + 0x28]
00aba276 : JZ 0x00aba285
00aba278 : MOV ECX,dword ptr [EAX + 0x10]
00aba27b : MOV DX,word ptr [EBP + -0x14]
00aba27f : MOV word ptr [ECX + 0x22],DX
00aba283 : JMP 0x00aba289
00aba285 : MOV byte ptr [EBP + -0x1],0x0
00aba289 : SUB dword ptr [EBP + -0x18],0x1
00aba28d : JNZ 0x00aba1b3
00aba293 : SUB dword ptr [EBP + -0x1c],0x1
00aba297 : JNZ 0x00aba140
00aba29d : MOV EDI,dword ptr [EBP + 0x8]
00aba2a0 : CMP byte ptr [EBP + -0x1],0x1
00aba2a4 : JNZ 0x00aba2d9
00aba2a6 : MOV EAX,dword ptr [EBP + -0xc]
00aba2a9 : MOV EAX,dword ptr [EAX + 0x10]
00aba2ac : MOVZX ECX,word ptr [EAX]
00aba2af : LEA EDX,[EBP + -0x1c]
00aba2b2 : MOV dword ptr [EBP + -0x18],EAX
00aba2b5 : MOV dword ptr [EBP + -0x1c],ECX
00aba2b8 : PUSH EDX
00aba2b9 : LEA ECX,[EDI + 0x48]
00aba2bc : LEA EAX,[EBP + -0x2c]
00aba2bf : CALL 0x00413b60
00aba2c4 : MOV EAX,dword ptr [EBP + -0x2c]
00aba2c7 : CMP EAX,dword ptr [EDI + 0x4c]
00aba2ca : JZ 0x00aba2d9
00aba2cc : MOV ECX,dword ptr [EBP + -0x18]
00aba2cf : MOV EDX,dword ptr [ECX]
00aba2d1 : PUSH EDX
00aba2d2 : MOV ECX,EDI
00aba2d4 : CALL 0x00ab9740
00aba2d9 : SUB dword ptr [EBP + -0x20],0x1
00aba2dd : JNZ 0x00aba0e0
00aba2e3 : POP EDI
00aba2e4 : POP ESI
00aba2e5 : POP EBX
00aba2e6 : MOV ESP,EBP
00aba2e8 : POP EBP
00aba2e9 : RET 0x4

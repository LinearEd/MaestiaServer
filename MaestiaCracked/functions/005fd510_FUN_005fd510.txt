PROGRAM  : Maestia.exe
FUNCTION : FUN_005fd510
ENTRY    : 005fd510
BODY     : [[005fd510, 005fd70d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005fd510(int *param_1,int param_2,uint param_3)

{
  uint uVar1;
  int iVar2;
  bool bVar3;
  int iVar4;
  int in_ECX;
  int iVar5;
  uint uVar6;
  int *local_2c;
  int local_20;
  int local_1c;
  uint local_c;
  
  if (*(int *)(param_2 + 0x18) == -1) {
    local_2c = param_1;
  }
  else {
    local_2c = (int *)(*(int *)(in_ECX + 0x128) + *(int *)(param_2 + 0x18) * 0xc);
  }
  local_1c = *(int *)(param_2 + 0x14);
  uVar1 = *(uint *)(param_2 + 0xc);
  iVar4 = *(int *)(param_2 + 4);
  iVar2 = *(int *)(param_1[1] + 0x10);
  bVar3 = true;
  uVar6 = *(uint *)(param_2 + 8);
  local_20 = *(int *)(param_2 + 0x10);
  local_c = *(uint *)(*(int *)(in_ECX + 0x128) + 8 + *(int *)(param_2 + 0x10) * 0xc);
  while( true ) {
    if (bVar3) {
      iVar5 = param_1[1];
      if (uVar6 != 0xffffffff) {
        FUN_005fcb20(iVar5,uVar6 | 0x40000000);
      }
      if (local_c != 0xffffffff) {
        FUN_005fcb20(iVar5,local_c & 0xbfffffff);
      }
    }
    else if (uVar6 != local_c) {
      FUN_005fcc80(param_1,iVar2);
      iVar5 = param_1[1];
      if (param_3 != 0xffffffff) {
        FUN_005fcb20(iVar5,param_3 | 0x40000000);
        FUN_005fcb20(iVar5,param_3 & 0xbfffffff);
      }
      iVar5 = param_1[1];
      if (uVar6 != 0xffffffff) {
        FUN_005fcb20(iVar5,uVar6 | 0x40000000);
      }
      if (local_c != 0xffffffff) {
        FUN_005fcb20(iVar5,local_c & 0xbfffffff);
      }
    }
    if ((iVar4 != iVar2) || (param_1[1] == 0)) {
      if (*(char *)(iVar4 + *(int *)(in_ECX + 0x24)) == '\0') {
        param_1[1] = 0;
      }
      else {
        if (bVar3) {
          param_1 = local_2c;
        }
        FUN_005fcc80(param_1,iVar4);
        iVar4 = param_1[1];
        if (uVar6 != 0xffffffff) {
          FUN_005fcb20(iVar4,uVar6 | 0x40000000);
        }
        if (local_c != 0xffffffff) {
          FUN_005fcb20(iVar4,local_c & 0xbfffffff);
        }
      }
    }
    bVar3 = false;
    if (local_1c == 0) break;
    local_1c = local_1c + -1;
    iVar5 = local_20 + 1;
    param_1 = (int *)(*(int *)(in_ECX + 0x128) + local_20 * 0xc);
    uVar6 = local_c;
    local_20 = iVar5;
    if (local_1c == 0) {
      iVar4 = *(int *)(*param_1 + 0x28);
      local_c = uVar1;
    }
    else {
      iVar4 = *(int *)(*param_1 + 0x28);
      local_c = *(uint *)(*(int *)(in_ECX + 0x128) + 8 + iVar5 * 0xc);
    }
  }
  *(undefined4 *)(param_2 + 0x14) = 0;
  return;
}



============================================================
DISASSEMBLY
============================================================
005fd510 : MOV EAX,dword ptr [ESP + 0x8]
005fd514 : SUB ESP,0x2c
005fd517 : PUSH EBX
005fd518 : PUSH EBP
005fd519 : PUSH ESI
005fd51a : MOV ESI,ECX
005fd51c : MOV ECX,dword ptr [EAX + 0x18]
005fd51f : PUSH EDI
005fd520 : MOV EDI,dword ptr [ESP + 0x40]
005fd524 : CMP ECX,-0x1
005fd527 : JNZ 0x005fd52f
005fd529 : MOV dword ptr [ESP + 0x10],EDI
005fd52d : JMP 0x005fd53f
005fd52f : MOV EDX,dword ptr [ESI + 0x128]
005fd535 : LEA ECX,[ECX + ECX*0x2]
005fd538 : LEA ECX,[EDX + ECX*0x4]
005fd53b : MOV dword ptr [ESP + 0x10],ECX
005fd53f : MOV EDX,dword ptr [EAX + 0x14]
005fd542 : MOV EBX,dword ptr [EAX + 0x10]
005fd545 : MOV ECX,dword ptr [EAX + 0xc]
005fd548 : MOV EBP,dword ptr [EAX + 0x8]
005fd54b : MOV EAX,dword ptr [ESI + 0x128]
005fd551 : MOV dword ptr [ESP + 0x20],EDX
005fd555 : LEA EDX,[EBX + EBX*0x2]
005fd558 : MOV dword ptr [ESP + 0x24],ECX
005fd55c : MOV ECX,dword ptr [EAX + EDX*0x4 + 0x8]
005fd560 : MOV EDX,dword ptr [ESP + 0x44]
005fd564 : MOV EAX,dword ptr [EDX + 0x4]
005fd567 : MOV dword ptr [ESP + 0x30],ECX
005fd56b : MOV ECX,dword ptr [EDI + 0x4]
005fd56e : MOV EDX,dword ptr [ECX + 0x10]
005fd571 : MOV dword ptr [ESP + 0x1c],EBX
005fd575 : MOV byte ptr [ESP + 0x38],0x1
005fd57a : MOV dword ptr [ESP + 0x40],EDX
005fd57e : CMP byte ptr [ESP + 0x38],0x0
005fd583 : MOV dword ptr [ESP + 0x34],EAX
005fd587 : JZ 0x005fd5c8
005fd589 : MOV EAX,dword ptr [EDI + 0x4]
005fd58c : MOV dword ptr [ESP + 0x14],EAX
005fd590 : CMP EBP,-0x1
005fd593 : JZ 0x005fd5aa
005fd595 : MOV ECX,EBP
005fd597 : OR ECX,0x40000000
005fd59d : PUSH ECX
005fd59e : PUSH EAX
005fd59f : MOV ECX,ESI
005fd5a1 : CALL 0x005fcb20
005fd5a6 : MOV EAX,dword ptr [ESP + 0x14]
005fd5aa : MOV ECX,dword ptr [ESP + 0x30]
005fd5ae : CMP ECX,-0x1
005fd5b1 : JZ 0x005fd63e
005fd5b7 : AND ECX,0xbfffffff
005fd5bd : PUSH ECX
005fd5be : PUSH EAX
005fd5bf : MOV ECX,ESI
005fd5c1 : CALL 0x005fcb20
005fd5c6 : JMP 0x005fd63e
005fd5c8 : CMP EBP,dword ptr [ESP + 0x30]
005fd5cc : JZ 0x005fd63e
005fd5ce : MOV EDX,dword ptr [ESP + 0x40]
005fd5d2 : PUSH EDX
005fd5d3 : PUSH EDI
005fd5d4 : MOV ECX,ESI
005fd5d6 : CALL 0x005fcc80
005fd5db : MOV EAX,dword ptr [ESP + 0x48]
005fd5df : MOV EBX,dword ptr [EDI + 0x4]
005fd5e2 : CMP EAX,-0x1
005fd5e5 : JZ 0x005fd607
005fd5e7 : OR EAX,0x40000000
005fd5ec : PUSH EAX
005fd5ed : PUSH EBX
005fd5ee : MOV ECX,ESI
005fd5f0 : CALL 0x005fcb20
005fd5f5 : MOV EAX,dword ptr [ESP + 0x48]
005fd5f9 : AND EAX,0xbfffffff
005fd5fe : PUSH EAX
005fd5ff : PUSH EBX
005fd600 : MOV ECX,ESI
005fd602 : CALL 0x005fcb20
005fd607 : MOV EBX,dword ptr [EDI + 0x4]
005fd60a : CMP EBP,-0x1
005fd60d : JZ 0x005fd620
005fd60f : MOV ECX,EBP
005fd611 : OR ECX,0x40000000
005fd617 : PUSH ECX
005fd618 : PUSH EBX
005fd619 : MOV ECX,ESI
005fd61b : CALL 0x005fcb20
005fd620 : CMP dword ptr [ESP + 0x30],-0x1
005fd625 : JZ 0x005fd63a
005fd627 : MOV EDX,dword ptr [ESP + 0x30]
005fd62b : AND EDX,0xbfffffff
005fd631 : PUSH EDX
005fd632 : PUSH EBX
005fd633 : MOV ECX,ESI
005fd635 : CALL 0x005fcb20
005fd63a : MOV EBX,dword ptr [ESP + 0x1c]
005fd63e : MOV EAX,dword ptr [ESP + 0x34]
005fd642 : CMP EAX,dword ptr [ESP + 0x40]
005fd646 : JNZ 0x005fd64e
005fd648 : CMP dword ptr [EDI + 0x4],0x0
005fd64c : JNZ 0x005fd6a5
005fd64e : MOV ECX,dword ptr [ESI + 0x24]
005fd651 : CMP byte ptr [EAX + ECX*0x1],0x0
005fd655 : JNZ 0x005fd660
005fd657 : MOV dword ptr [EDI + 0x4],0x0
005fd65e : JMP 0x005fd6a5
005fd660 : CMP byte ptr [ESP + 0x38],0x0
005fd665 : JZ 0x005fd66b
005fd667 : MOV EDI,dword ptr [ESP + 0x10]
005fd66b : PUSH EAX
005fd66c : PUSH EDI
005fd66d : MOV ECX,ESI
005fd66f : CALL 0x005fcc80
005fd674 : MOV EDI,dword ptr [EDI + 0x4]
005fd677 : CMP EBP,-0x1
005fd67a : JZ 0x005fd68b
005fd67c : OR EBP,0x40000000
005fd682 : PUSH EBP
005fd683 : PUSH EDI
005fd684 : MOV ECX,ESI
005fd686 : CALL 0x005fcb20
005fd68b : CMP dword ptr [ESP + 0x30],-0x1
005fd690 : JZ 0x005fd6a5
005fd692 : MOV EDX,dword ptr [ESP + 0x30]
005fd696 : AND EDX,0xbfffffff
005fd69c : PUSH EDX
005fd69d : PUSH EDI
005fd69e : MOV ECX,ESI
005fd6a0 : CALL 0x005fcb20
005fd6a5 : MOV EDX,dword ptr [ESP + 0x20]
005fd6a9 : MOV byte ptr [ESP + 0x38],0x0
005fd6ae : TEST EDX,EDX
005fd6b0 : JZ 0x005fd6f9
005fd6b2 : MOV ECX,dword ptr [ESI + 0x128]
005fd6b8 : MOV EBP,dword ptr [ESP + 0x30]
005fd6bc : MOV EAX,EBX
005fd6be : DEC EDX
005fd6bf : INC EBX
005fd6c0 : LEA EAX,[EAX + EAX*0x2]
005fd6c3 : MOV dword ptr [ESP + 0x20],EDX
005fd6c7 : MOV dword ptr [ESP + 0x1c],EBX
005fd6cb : LEA EDI,[ECX + EAX*0x4]
005fd6ce : TEST EDX,EDX
005fd6d0 : JZ 0x005fd6e7
005fd6d2 : LEA EDX,[EBX + EBX*0x2]
005fd6d5 : MOV EAX,dword ptr [ECX + EDX*0x4 + 0x8]
005fd6d9 : MOV EDX,dword ptr [EDI]
005fd6db : MOV dword ptr [ESP + 0x30],EAX
005fd6df : MOV EAX,dword ptr [EDX + 0x28]
005fd6e2 : JMP 0x005fd57e
005fd6e7 : MOV ECX,dword ptr [ESP + 0x24]
005fd6eb : MOV EDX,dword ptr [EDI]
005fd6ed : MOV EAX,dword ptr [EDX + 0x28]
005fd6f0 : MOV dword ptr [ESP + 0x30],ECX
005fd6f4 : JMP 0x005fd57e
005fd6f9 : MOV ECX,dword ptr [ESP + 0x44]
005fd6fd : POP EDI
005fd6fe : POP ESI
005fd6ff : POP EBP
005fd700 : MOV dword ptr [ECX + 0x14],0x0
005fd707 : POP EBX
005fd708 : ADD ESP,0x2c
005fd70b : RET 0xc

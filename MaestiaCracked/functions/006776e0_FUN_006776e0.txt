PROGRAM  : Maestia.exe
FUNCTION : FUN_006776e0
ENTRY    : 006776e0
BODY     : [[006776e0, 00677808]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006776e0(undefined4 param_1,undefined4 *param_2,uint param_3)

{
  uint *puVar1;
  uint *puVar2;
  uint *puVar3;
  int *piVar4;
  int *in_ECX;
  uint uVar5;
  uint uVar6;
  int iVar7;
  
  piVar4 = (int *)*in_ECX;
  if (piVar4 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar4 * 5) <= piVar4[1] * 4 + 4U) goto LAB_0067771a;
    iVar7 = piVar4[1] * 2 + 2;
  }
  FUN_006772f0(param_1,iVar7);
LAB_0067771a:
  piVar4 = (int *)*in_ECX;
  param_3 = param_3 & piVar4[1];
  *piVar4 = *piVar4 + 1;
  iVar7 = *in_ECX;
  puVar1 = (uint *)(iVar7 + 8 + param_3 * 0xc);
  if (*(int *)(iVar7 + 8 + param_3 * 0xc) == -2) {
    *puVar1 = 0xffffffff;
    *(undefined2 *)(puVar1 + 1) = *(undefined2 *)*param_2;
    puVar1[2] = *(uint *)param_2[1];
    return;
  }
  uVar5 = param_3;
  do {
    uVar5 = uVar5 + 1 & *(uint *)(iVar7 + 4);
  } while (*(int *)(iVar7 + 8 + uVar5 * 0xc) != -2);
  puVar2 = (uint *)(iVar7 + 8 + uVar5 * 0xc);
  uVar6 = (uint)(ushort)puVar1[1] & *(uint *)(iVar7 + 4);
  if (uVar6 != param_3) {
    puVar3 = (uint *)(iVar7 + 8 + uVar6 * 0xc);
    for (uVar6 = *(uint *)(iVar7 + 8 + uVar6 * 0xc); uVar6 != param_3;
        uVar6 = *(uint *)(iVar7 + 8 + uVar6 * 0xc)) {
      uVar6 = *puVar3;
      puVar3 = (uint *)(iVar7 + 8 + uVar6 * 0xc);
    }
    if (puVar2 != (uint *)0x0) {
      *puVar2 = *puVar1;
      *(short *)(puVar2 + 1) = (short)puVar1[1];
      puVar2[2] = puVar1[2];
    }
    *puVar3 = uVar5;
    *(undefined2 *)(puVar1 + 1) = *(undefined2 *)*param_2;
    puVar1[2] = *(uint *)param_2[1];
    *puVar1 = 0xffffffff;
    return;
  }
  if (puVar2 != (uint *)0x0) {
    *puVar2 = *puVar1;
    *(short *)(puVar2 + 1) = (short)puVar1[1];
    puVar2[2] = puVar1[2];
  }
  *(undefined2 *)(puVar1 + 1) = *(undefined2 *)*param_2;
  puVar1[2] = *(uint *)param_2[1];
  *puVar1 = uVar5;
  return;
}



============================================================
DISASSEMBLY
============================================================
006776e0 : PUSH ESI
006776e1 : MOV ESI,ECX
006776e3 : MOV EAX,dword ptr [ESI]
006776e5 : PUSH EDI
006776e6 : TEST EAX,EAX
006776e8 : JNZ 0x006776f3
006776ea : MOV EAX,dword ptr [ESP + 0xc]
006776ee : PUSH 0x8
006776f0 : PUSH EAX
006776f1 : JMP 0x00677715
006776f3 : MOV ECX,dword ptr [EAX + 0x4]
006776f6 : LEA EDX,[ECX*0x4 + 0x4]
006776fd : MOV ECX,dword ptr [EAX]
006776ff : LEA ECX,[ECX + ECX*0x4]
00677702 : CMP ECX,EDX
00677704 : JBE 0x0067771a
00677706 : MOV EDX,dword ptr [EAX + 0x4]
00677709 : MOV ECX,dword ptr [ESP + 0xc]
0067770d : LEA EAX,[EDX + EDX*0x1 + 0x2]
00677711 : PUSH EAX
00677712 : PUSH ECX
00677713 : MOV ECX,ESI
00677715 : CALL 0x006772f0
0067771a : MOV ECX,dword ptr [ESI]
0067771c : MOV EAX,dword ptr [ESP + 0x14]
00677720 : AND EAX,dword ptr [ECX + 0x4]
00677723 : INC dword ptr [ECX]
00677725 : MOV ESI,dword ptr [ESI]
00677727 : LEA EDX,[EAX + EAX*0x2]
0067772a : MOV ECX,dword ptr [ESI + EDX*0x4 + 0x8]
0067772e : LEA EDX,[ESI + EDX*0x4 + 0x8]
00677732 : MOV EDI,0xfffffffe
00677737 : CMP ECX,EDI
00677739 : JNZ 0x0067775b
0067773b : MOV EAX,dword ptr [ESP + 0x10]
0067773f : MOV dword ptr [EDX],0xffffffff
00677745 : MOV ECX,dword ptr [EAX]
00677747 : MOV CX,word ptr [ECX]
0067774a : MOV word ptr [EDX + 0x4],CX
0067774e : MOV EAX,dword ptr [EAX + 0x4]
00677751 : MOV ECX,dword ptr [EAX]
00677753 : POP EDI
00677754 : MOV dword ptr [EDX + 0x8],ECX
00677757 : POP ESI
00677758 : RET 0xc
0067775b : PUSH EBX
0067775c : PUSH EBP
0067775d : MOV EBP,dword ptr [ESI + 0x4]
00677760 : MOV ECX,EAX
00677762 : INC ECX
00677763 : AND ECX,EBP
00677765 : LEA EBX,[ECX + ECX*0x2]
00677768 : CMP dword ptr [ESI + EBX*0x4 + 0x8],EDI
0067776c : JNZ 0x00677762
0067776e : LEA EDI,[ECX + ECX*0x2]
00677771 : LEA EBX,[ESI + EDI*0x4 + 0x8]
00677775 : MOVZX EDI,word ptr [EDX + 0x4]
00677779 : AND EDI,EBP
0067777b : CMP EDI,EAX
0067777d : JNZ 0x006777b3
0067777f : TEST EBX,EBX
00677781 : JZ 0x00677795
00677783 : MOV EAX,dword ptr [EDX]
00677785 : MOV dword ptr [EBX],EAX
00677787 : MOV AX,word ptr [EDX + 0x4]
0067778b : MOV word ptr [EBX + 0x4],AX
0067778f : MOV EAX,dword ptr [EDX + 0x8]
00677792 : MOV dword ptr [EBX + 0x8],EAX
00677795 : MOV EAX,dword ptr [ESP + 0x18]
00677799 : MOV ESI,dword ptr [EAX]
0067779b : MOV SI,word ptr [ESI]
0067779e : MOV word ptr [EDX + 0x4],SI
006777a2 : MOV EAX,dword ptr [EAX + 0x4]
006777a5 : MOV EAX,dword ptr [EAX]
006777a7 : POP EBP
006777a8 : POP EBX
006777a9 : POP EDI
006777aa : MOV dword ptr [EDX + 0x8],EAX
006777ad : MOV dword ptr [EDX],ECX
006777af : POP ESI
006777b0 : RET 0xc
006777b3 : LEA EDI,[EDI + EDI*0x2]
006777b6 : CMP dword ptr [ESI + EDI*0x4 + 0x8],EAX
006777ba : LEA EDI,[ESI + EDI*0x4 + 0x8]
006777be : JZ 0x006777cf
006777c0 : MOV EDI,dword ptr [EDI]
006777c2 : LEA EDI,[EDI + EDI*0x2]
006777c5 : CMP dword ptr [ESI + EDI*0x4 + 0x8],EAX
006777c9 : LEA EDI,[ESI + EDI*0x4 + 0x8]
006777cd : JNZ 0x006777c0
006777cf : TEST EBX,EBX
006777d1 : JZ 0x006777e5
006777d3 : MOV EAX,dword ptr [EDX]
006777d5 : MOV dword ptr [EBX],EAX
006777d7 : MOV AX,word ptr [EDX + 0x4]
006777db : MOV word ptr [EBX + 0x4],AX
006777df : MOV EAX,dword ptr [EDX + 0x8]
006777e2 : MOV dword ptr [EBX + 0x8],EAX
006777e5 : MOV EAX,dword ptr [ESP + 0x18]
006777e9 : MOV dword ptr [EDI],ECX
006777eb : MOV ECX,dword ptr [EAX]
006777ed : MOV CX,word ptr [ECX]
006777f0 : MOV word ptr [EDX + 0x4],CX
006777f4 : MOV EAX,dword ptr [EAX + 0x4]
006777f7 : MOV ECX,dword ptr [EAX]
006777f9 : POP EBP
006777fa : POP EBX
006777fb : POP EDI
006777fc : MOV dword ptr [EDX + 0x8],ECX
006777ff : MOV dword ptr [EDX],0xffffffff
00677805 : POP ESI
00677806 : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_00a7bd70
ENTRY    : 00a7bd70
BODY     : [[00a7bd70, 00a7c0ee]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a7bd70(int param_1)

{
  undefined4 *puVar1;
  undefined2 uVar2;
  short sVar3;
  uint uVar4;
  int *piVar5;
  int iVar6;
  int *piVar7;
  int iVar8;
  int iVar9;
  uint uVar10;
  undefined2 local_74 [2];
  undefined8 local_70;
  undefined8 local_68;
  undefined8 local_60;
  undefined1 local_58 [4];
  undefined2 local_54;
  undefined2 uStack_52;
  undefined2 uStack_50;
  undefined2 uStack_4e;
  undefined4 local_4c;
  int iStack_48;
  short local_44;
  undefined2 uStack_42;
  int *piStack_40;
  undefined1 local_3c [8];
  uint local_34;
  int local_30;
  uint local_2c;
  int local_28;
  int local_24;
  uint local_20;
  int local_1c;
  int local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1d39f;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(int *)(param_1 + 0x40) != 0) {
    local_24 = 0;
    FUN_0042eef0(*(undefined4 *)(*(int *)(param_1 + 0xac) + 4));
    *(int *)(*(int *)(param_1 + 0xac) + 4) = *(int *)(param_1 + 0xac);
    *(undefined4 *)(param_1 + 0xb0) = 0;
    *(undefined4 *)*(undefined4 *)(param_1 + 0xac) = *(undefined4 *)(param_1 + 0xac);
    piVar5 = DAT_00da9894;
    *(int *)(*(int *)(param_1 + 0xac) + 8) = *(int *)(param_1 + 0xac);
    if ((*piVar5 != 0) && (puVar1 = *(undefined4 **)(*piVar5 + 0x114), puVar1 != (undefined4 *)0x0))
    {
      (**(code **)*puVar1)("ClearItemList");
    }
    local_20 = 0;
    if ((*DAT_00da9894 != 0) && (*(int *)(*DAT_00da9894 + 0x11c) != 0)) {
      local_20 = **(uint **)(param_1 + 0x40) / 10000 & 0xffff;
    }
    piVar5 = (int *)FUN_00703c00(0x600);
    if ((piVar5 != (int *)0x0) && (iVar6 = (**(code **)(*piVar5 + 0x3c))(), iVar6 != 0)) {
      local_18 = **(int **)(param_1 + 0xa0);
      if ((int *)local_18 != *(int **)(param_1 + 0xa0)) {
        do {
          iVar6 = *(int *)(local_18 + 0x10);
          if ((iVar6 != 0) &&
             ((((*(short *)(iVar6 + 0xc) == 0 || (*(short *)(iVar6 + 0xc) == (short)local_20)) &&
               (uVar4 = *(uint *)(*(int *)(param_1 + 0x40) + 0x20), *(ushort *)(iVar6 + 8) <= uVar4)
               ) && (uVar4 <= *(ushort *)(iVar6 + 10))))) {
            local_54 = (undefined2)iVar6;
            uStack_52 = (undefined2)((uint)iVar6 >> 0x10);
            uStack_50 = (undefined2)local_24;
            local_24 = local_24 + 1;
            piStack_40 = (int *)0x0;
            local_4c = 0;
            uVar4 = *(uint *)(*DAT_00da9894 + 0x40);
            iStack_48 = -1;
            local_44 = 0;
            local_2c = 0;
            local_34 = uVar4;
            if (uVar4 != 0) {
              do {
                uVar10 = local_2c;
                piVar5 = (int *)FUN_008eb810();
                if (((piVar5 != (int *)0x0) && ((char)piVar5[0x19] != '\0')) && (piVar5[0xf] != 0))
                {
                  iVar6 = *(int *)(piVar5[0xf] + 8);
                  local_28 = *(int *)(piVar5[0xf] + 0xc);
                  local_1c = 0;
                  local_30 = iVar6;
                  if (0 < iVar6) {
                    do {
                      iVar9 = 0;
                      if (0 < local_28) {
                        do {
                          piVar7 = (int *)(**(code **)(*piVar5 + 0x74))(iVar9,local_1c);
                          if ((piVar7 != (int *)0x0) &&
                             ((uint)*(ushort *)(piVar7 + 4) == **(uint **)(local_18 + 0x10))) {
                            iStack_48 = piVar7[3];
                            sVar3 = (**(code **)(*piVar7 + 0x40))();
                            local_44 = local_44 + sVar3;
                            local_4c = 1;
                            piStack_40 = piVar7;
                          }
                          iVar9 = iVar9 + 1;
                          iVar6 = local_30;
                        } while (iVar9 < local_28);
                      }
                      local_1c = local_1c + 1;
                      uVar4 = local_34;
                      uVar10 = local_2c;
                    } while (local_1c < iVar6);
                  }
                }
                local_2c = uVar10 + 1;
              } while (local_2c < uVar4);
            }
            uVar2 = uStack_50;
            local_70 = CONCAT26(uStack_4e,CONCAT24(uStack_50,CONCAT22(uStack_52,local_54)));
            local_68 = CONCAT44(iStack_48,local_4c);
            local_60 = CONCAT44(piStack_40,CONCAT22(uStack_42,local_44));
            local_74[0] = uStack_50;
            FUN_0042edd0(local_3c,local_74);
            if ((*DAT_00da9894 != 0) &&
               (piVar5 = *(int **)(*DAT_00da9894 + 0x114), piVar5 != (int *)0x0)) {
              iVar6 = *(int *)(local_18 + 0x10);
              if (*(uint *)(iVar6 + 0x6c) < 8) {
                iVar9 = iVar6 + 0x58;
              }
              else {
                iVar9 = *(int *)(iVar6 + 0x58);
              }
              if (*(uint *)(iVar6 + 0x34) < 8) {
                iVar8 = iVar6 + 0x20;
              }
              else {
                iVar8 = *(int *)(iVar6 + 0x20);
              }
              (**(code **)(*piVar5 + 4))
                        (piVar5,"AddItemList","%ls, %ls, %d, %b, %b, %d",iVar8,iVar9,local_44,
                         local_4c,*(undefined4 *)(iVar6 + 4),uVar2);
            }
          }
          FUN_00416210();
        } while (local_18 != *(int *)(param_1 + 0xa0));
      }
      if ((*DAT_00da9894 != 0) && (piVar5 = *(int **)(*DAT_00da9894 + 0x114), piVar5 != (int *)0x0))
      {
        (**(code **)(*piVar5 + 4))(piVar5,"ShowCraftAdditiveList","%d,%b",0,0);
      }
    }
    ExceptionList = local_10;
    return;
  }
  FUN_00406460(L"m_pCurCraftItem NULL");
  local_8 = 0;
  if ((int *)*DAT_00da98e8 != (int *)0x0) {
    (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
              (L"AvaGuiCraftIngredient::ShowCraftAdditiveList",0x192,local_58,uVar4);
  }
  local_8 = 0xffffffff;
  if (piStack_40 < &DAT_00000008) {
    ExceptionList = local_10;
    return;
  }
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
00a7bd70 : PUSH EBP
00a7bd71 : MOV EBP,ESP
00a7bd73 : PUSH -0x1
00a7bd75 : PUSH 0xb1d39f
00a7bd7a : MOV EAX,FS:[0x0]
00a7bd80 : PUSH EAX
00a7bd81 : SUB ESP,0x68
00a7bd84 : PUSH EBX
00a7bd85 : PUSH ESI
00a7bd86 : PUSH EDI
00a7bd87 : MOV EAX,[0x00d66fa0]
00a7bd8c : XOR EAX,EBP
00a7bd8e : PUSH EAX
00a7bd8f : LEA EAX,[EBP + -0xc]
00a7bd92 : MOV FS:[0x0],EAX
00a7bd98 : MOV EBX,dword ptr [EBP + 0x8]
00a7bd9b : XOR ESI,ESI
00a7bd9d : CMP dword ptr [EBX + 0x40],ESI
00a7bda0 : JNZ 0x00a7be0b
00a7bda2 : PUSH 0xc52534
00a7bda7 : LEA ECX,[EBP + -0x54]
00a7bdaa : CALL 0x00406460
00a7bdaf : MOV dword ptr [EBP + -0x4],ESI
00a7bdb2 : MOV EAX,[0x00da98e8]
00a7bdb7 : MOV ECX,dword ptr [EAX]
00a7bdb9 : CMP ECX,ESI
00a7bdbb : JZ 0x00a7bdd2
00a7bdbd : MOV EDX,dword ptr [ECX]
00a7bdbf : MOV EDX,dword ptr [EDX + 0x14]
00a7bdc2 : LEA EAX,[EBP + -0x54]
00a7bdc5 : PUSH EAX
00a7bdc6 : PUSH 0x192
00a7bdcb : PUSH 0xc52560
00a7bdd0 : CALL EDX
00a7bdd2 : MOV dword ptr [EBP + -0x4],0xffffffff
00a7bdd9 : CMP dword ptr [EBP + -0x3c],0x8
00a7bddd : JC 0x00a7bde7
00a7bddf : MOV ECX,dword ptr [EBP + -0x50]
00a7bde2 : CALL 0x006f04e0
00a7bde7 : XOR EAX,EAX
00a7bde9 : MOV dword ptr [EBP + -0x3c],0x7
00a7bdf0 : MOV dword ptr [EBP + -0x40],ESI
00a7bdf3 : MOV word ptr [EBP + -0x50],AX
00a7bdf7 : MOV ECX,dword ptr [EBP + -0xc]
00a7bdfa : MOV dword ptr FS:[0x0],ECX
00a7be01 : POP ECX
00a7be02 : POP EDI
00a7be03 : POP ESI
00a7be04 : POP EBX
00a7be05 : MOV ESP,EBP
00a7be07 : POP EBP
00a7be08 : RET 0x4
00a7be0b : MOV ECX,dword ptr [EBX + 0xac]
00a7be11 : MOV EDX,dword ptr [ECX + 0x4]
00a7be14 : LEA EDI,[EBX + 0xa8]
00a7be1a : PUSH EDX
00a7be1b : MOV ECX,EDI
00a7be1d : MOV dword ptr [EBP + -0x20],ESI
00a7be20 : CALL 0x0042eef0
00a7be25 : MOV EAX,dword ptr [EDI + 0x4]
00a7be28 : MOV dword ptr [EAX + 0x4],EAX
00a7be2b : MOV EAX,dword ptr [EDI + 0x4]
00a7be2e : MOV dword ptr [EDI + 0x8],ESI
00a7be31 : MOV dword ptr [EAX],EAX
00a7be33 : MOV EDI,dword ptr [EDI + 0x4]
00a7be36 : MOV EAX,[0x00da9894]
00a7be3b : MOV dword ptr [EDI + 0x8],EDI
00a7be3e : MOV EAX,dword ptr [EAX]
00a7be40 : CMP EAX,ESI
00a7be42 : JZ 0x00a7be5b
00a7be44 : MOV EAX,dword ptr [EAX + 0x114]
00a7be4a : CMP EAX,ESI
00a7be4c : JZ 0x00a7be5b
00a7be4e : MOV EDX,dword ptr [EAX]
00a7be50 : MOV ECX,EAX
00a7be52 : MOV EAX,dword ptr [EDX]
00a7be54 : PUSH 0xc525bc
00a7be59 : CALL EAX
00a7be5b : MOV ECX,dword ptr [0x00da9894]
00a7be61 : MOV EAX,dword ptr [ECX]
00a7be63 : MOV dword ptr [EBP + -0x1c],ESI
00a7be66 : CMP EAX,ESI
00a7be68 : JZ 0x00a7be85
00a7be6a : CMP dword ptr [EAX + 0x11c],ESI
00a7be70 : JZ 0x00a7be85
00a7be72 : MOV EDX,dword ptr [EBX + 0x40]
00a7be75 : MOV EAX,0xd1b71759
00a7be7a : MUL dword ptr [EDX]
00a7be7c : SHR EDX,0xd
00a7be7f : MOVZX EAX,DX
00a7be82 : MOV dword ptr [EBP + -0x1c],EAX
00a7be85 : MOV ECX,dword ptr [EBX + 0x40]
00a7be88 : MOV DI,word ptr [ECX + 0x2e]
00a7be8c : PUSH 0x600
00a7be91 : CALL 0x00703c00
00a7be96 : ADD ESP,0x4
00a7be99 : CMP EAX,ESI
00a7be9b : JZ 0x00a7c0db
00a7bea1 : MOV EDX,dword ptr [EAX]
00a7bea3 : MOV ECX,EAX
00a7bea5 : MOV EAX,dword ptr [EDX + 0x3c]
00a7bea8 : CALL EAX
00a7beaa : TEST EAX,EAX
00a7beac : JZ 0x00a7c0db
00a7beb2 : MOV EAX,dword ptr [EBX + 0xa0]
00a7beb8 : MOV ECX,dword ptr [EAX]
00a7beba : MOV dword ptr [EBP + -0x14],ECX
00a7bebd : CMP ECX,EAX
00a7bebf : JZ 0x00a7c0ae
00a7bec5 : JMP 0x00a7bec9
00a7bec7 : MOV EBX,EAX
00a7bec9 : MOV ECX,dword ptr [EBP + -0x14]
00a7becc : MOV EAX,dword ptr [ECX + 0x10]
00a7becf : CMP EAX,ESI
00a7bed1 : JZ 0x00a7c094
00a7bed7 : MOVZX ECX,word ptr [EAX + 0xc]
00a7bedb : CMP CX,SI
00a7bede : JZ 0x00a7beea
00a7bee0 : CMP CX,word ptr [EBP + -0x1c]
00a7bee4 : JNZ 0x00a7c094
00a7beea : MOV EDX,dword ptr [EBX + 0x40]
00a7beed : MOV ECX,dword ptr [EDX + 0x20]
00a7bef0 : MOVZX EDX,word ptr [EAX + 0x8]
00a7bef4 : CMP EDX,ECX
00a7bef6 : JA 0x00a7c094
00a7befc : MOVZX EDX,word ptr [EAX + 0xa]
00a7bf00 : CMP EDX,ECX
00a7bf02 : JC 0x00a7c094
00a7bf08 : MOV ECX,dword ptr [0x00da9894]
00a7bf0e : MOV EDX,dword ptr [ECX]
00a7bf10 : MOV dword ptr [EBP + -0x50],EAX
00a7bf13 : MOV EAX,dword ptr [EBP + -0x20]
00a7bf16 : MOV BX,AX
00a7bf19 : INC EAX
00a7bf1a : MOV dword ptr [EBP + -0x3c],ESI
00a7bf1d : MOV dword ptr [EBP + -0x48],ESI
00a7bf20 : MOV ESI,dword ptr [EDX + 0x40]
00a7bf23 : MOV dword ptr [EBP + -0x20],EAX
00a7bf26 : XOR EAX,EAX
00a7bf28 : XOR EDI,EDI
00a7bf2a : MOV word ptr [EBP + -0x4c],BX
00a7bf2e : MOV dword ptr [EBP + -0x44],0xffffffff
00a7bf35 : MOV word ptr [EBP + -0x40],AX
00a7bf39 : MOV dword ptr [EBP + -0x30],ESI
00a7bf3c : MOV dword ptr [EBP + -0x28],EDI
00a7bf3f : TEST ESI,ESI
00a7bf41 : JBE 0x00a7bff9
00a7bf47 : MOV EAX,[0x00da9894]
00a7bf4c : MOV EAX,dword ptr [EAX]
00a7bf4e : MOV ECX,EDI
00a7bf50 : CALL 0x008eb810
00a7bf55 : MOV EBX,EAX
00a7bf57 : TEST EBX,EBX
00a7bf59 : JZ 0x00a7bfe9
00a7bf5f : CMP byte ptr [EBX + 0x64],0x0
00a7bf63 : JZ 0x00a7bfe9
00a7bf69 : CMP dword ptr [EBX + 0x3c],0x0
00a7bf6d : JZ 0x00a7bfe9
00a7bf6f : MOV EAX,dword ptr [EBX + 0x3c]
00a7bf72 : MOV ECX,dword ptr [EAX + 0x8]
00a7bf75 : MOV EDX,dword ptr [EAX + 0xc]
00a7bf78 : MOV dword ptr [EBP + -0x2c],ECX
00a7bf7b : MOV dword ptr [EBP + -0x24],EDX
00a7bf7e : MOV dword ptr [EBP + -0x18],0x0
00a7bf85 : TEST ECX,ECX
00a7bf87 : JLE 0x00a7bfe9
00a7bf89 : XOR EDI,EDI
00a7bf8b : CMP dword ptr [EBP + -0x24],EDI
00a7bf8e : JLE 0x00a7bfd8
00a7bf90 : MOV ECX,dword ptr [EBP + -0x18]
00a7bf93 : MOV EAX,dword ptr [EBX]
00a7bf95 : MOV EDX,dword ptr [EAX + 0x74]
00a7bf98 : PUSH ECX
00a7bf99 : PUSH EDI
00a7bf9a : MOV ECX,EBX
00a7bf9c : CALL EDX
00a7bf9e : MOV ESI,EAX
00a7bfa0 : TEST ESI,ESI
00a7bfa2 : JZ 0x00a7bfcf
00a7bfa4 : MOVZX EAX,word ptr [ESI + 0x10]
00a7bfa8 : MOV ECX,dword ptr [EBP + -0x14]
00a7bfab : MOV EDX,dword ptr [ECX + 0x10]
00a7bfae : CMP EAX,dword ptr [EDX]
00a7bfb0 : JNZ 0x00a7bfcf
00a7bfb2 : MOV EAX,dword ptr [ESI + 0xc]
00a7bfb5 : MOV EDX,dword ptr [ESI]
00a7bfb7 : MOV dword ptr [EBP + -0x44],EAX
00a7bfba : MOV EAX,dword ptr [EDX + 0x40]
00a7bfbd : MOV ECX,ESI
00a7bfbf : CALL EAX
00a7bfc1 : ADD word ptr [EBP + -0x40],AX
00a7bfc5 : MOV dword ptr [EBP + -0x48],0x1
00a7bfcc : MOV dword ptr [EBP + -0x3c],ESI
00a7bfcf : INC EDI
00a7bfd0 : CMP EDI,dword ptr [EBP + -0x24]
00a7bfd3 : JL 0x00a7bf90
00a7bfd5 : MOV ECX,dword ptr [EBP + -0x2c]
00a7bfd8 : MOV EAX,dword ptr [EBP + -0x18]
00a7bfdb : INC EAX
00a7bfdc : CMP EAX,ECX
00a7bfde : MOV dword ptr [EBP + -0x18],EAX
00a7bfe1 : JL 0x00a7bf89
00a7bfe3 : MOV EDI,dword ptr [EBP + -0x28]
00a7bfe6 : MOV ESI,dword ptr [EBP + -0x30]
00a7bfe9 : INC EDI
00a7bfea : MOV dword ptr [EBP + -0x28],EDI
00a7bfed : CMP EDI,ESI
00a7bfef : JC 0x00a7bf47
00a7bff5 : MOV BX,word ptr [EBP + -0x4c]
00a7bff9 : MOVQ XMM0,qword ptr [EBP + -0x50]
00a7bffe : MOV EAX,dword ptr [EBP + 0x8]
00a7c001 : MOVQ qword ptr [EBP + -0x6c],XMM0
00a7c006 : MOVQ XMM0,qword ptr [EBP + -0x48]
00a7c00b : LEA ECX,[EBP + -0x70]
00a7c00e : PUSH ECX
00a7c00f : LEA EDX,[EBP + -0x38]
00a7c012 : MOVQ qword ptr [EBP + -0x64],XMM0
00a7c017 : MOVQ XMM0,qword ptr [EBP + -0x40]
00a7c01c : PUSH EDX
00a7c01d : ADD EAX,0xa8
00a7c022 : MOV word ptr [EBP + -0x70],BX
00a7c026 : MOVQ qword ptr [EBP + -0x5c],XMM0
00a7c02b : CALL 0x0042edd0
00a7c030 : MOV EAX,[0x00da9894]
00a7c035 : MOV EAX,dword ptr [EAX]
00a7c037 : TEST EAX,EAX
00a7c039 : JZ 0x00a7c092
00a7c03b : MOV ECX,dword ptr [EAX + 0x114]
00a7c041 : TEST ECX,ECX
00a7c043 : JZ 0x00a7c092
00a7c045 : MOV EDX,dword ptr [EBP + -0x14]
00a7c048 : MOV EAX,dword ptr [EDX + 0x10]
00a7c04b : MOV EDX,0x8
00a7c050 : CMP dword ptr [EAX + 0x6c],EDX
00a7c053 : JC 0x00a7c05a
00a7c055 : MOV EDI,dword ptr [EAX + 0x58]
00a7c058 : JMP 0x00a7c05d
00a7c05a : LEA EDI,[EAX + 0x58]
00a7c05d : CMP dword ptr [EAX + 0x34],EDX
00a7c060 : JC 0x00a7c067
00a7c062 : MOV EDX,dword ptr [EAX + 0x20]
00a7c065 : JMP 0x00a7c06a
00a7c067 : LEA EDX,[EAX + 0x20]
00a7c06a : MOV EAX,dword ptr [EAX + 0x4]
00a7c06d : MOV ESI,dword ptr [ECX]
00a7c06f : MOVZX EBX,BX
00a7c072 : PUSH EBX
00a7c073 : PUSH EAX
00a7c074 : MOV EAX,dword ptr [EBP + -0x48]
00a7c077 : PUSH EAX
00a7c078 : MOVZX EAX,word ptr [EBP + -0x40]
00a7c07c : PUSH EAX
00a7c07d : PUSH EDI
00a7c07e : PUSH EDX
00a7c07f : PUSH 0xc525cc
00a7c084 : PUSH 0xc525e8
00a7c089 : PUSH ECX
00a7c08a : MOV ECX,dword ptr [ESI + 0x4]
00a7c08d : CALL ECX
00a7c08f : ADD ESP,0x24
00a7c092 : XOR ESI,ESI
00a7c094 : LEA EDX,[EBP + -0x14]
00a7c097 : CALL 0x00416210
00a7c09c : MOV EDX,dword ptr [EBP + -0x14]
00a7c09f : MOV EAX,dword ptr [EBP + 0x8]
00a7c0a2 : CMP EDX,dword ptr [EAX + 0xa0]
00a7c0a8 : JNZ 0x00a7bec7
00a7c0ae : MOV ECX,dword ptr [0x00da9894]
00a7c0b4 : MOV EAX,dword ptr [ECX]
00a7c0b6 : CMP EAX,ESI
00a7c0b8 : JZ 0x00a7c0db
00a7c0ba : MOV EAX,dword ptr [EAX + 0x114]
00a7c0c0 : CMP EAX,ESI
00a7c0c2 : JZ 0x00a7c0db
00a7c0c4 : MOV EDX,dword ptr [EAX]
00a7c0c6 : PUSH ESI
00a7c0c7 : PUSH ESI
00a7c0c8 : PUSH 0xc525f4
00a7c0cd : PUSH 0xc525fc
00a7c0d2 : PUSH EAX
00a7c0d3 : MOV EAX,dword ptr [EDX + 0x4]
00a7c0d6 : CALL EAX
00a7c0d8 : ADD ESP,0x14
00a7c0db : MOV ECX,dword ptr [EBP + -0xc]
00a7c0de : MOV dword ptr FS:[0x0],ECX
00a7c0e5 : POP ECX
00a7c0e6 : POP EDI
00a7c0e7 : POP ESI
00a7c0e8 : POP EBX
00a7c0e9 : MOV ESP,EBP
00a7c0eb : POP EBP
00a7c0ec : RET 0x4

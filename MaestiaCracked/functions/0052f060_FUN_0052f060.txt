PROGRAM  : Maestia.exe
FUNCTION : FUN_0052f060
ENTRY    : 0052f060
BODY     : [[0052f060, 0052f23d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0052f060(int param_1)

{
  int iVar1;
  char cVar2;
  int *piVar3;
  int *piVar4;
  char *pcVar5;
  uint _MaxCount;
  undefined4 uVar6;
  undefined4 *puStack_7fc;
  undefined4 *puStack_7f8;
  char local_7f4 [16];
  undefined1 auStack_7e4 [16];
  char acStack_7d4 [2000];
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)&puStack_7fc;
  uVar6 = *(undefined4 *)(param_1 + 0x18);
  FUN_00526260(0);
  piVar3 = (int *)FUN_005270f0(uVar6);
  if (piVar3 != (int *)0x0) {
    piVar4 = (int *)(*(int *)(param_1 + 0x18) + 0x78);
    local_7f4[0] = '\0';
    cVar2 = (**(code **)(*piVar3 + 0x2c))(piVar4,*piVar4 + 0x154,local_7f4);
    if ((cVar2 != '\0') && ((local_7f4[0] == '\b' || (local_7f4[0] == '\v')))) {
      iVar1 = *(int *)(param_1 + 0x18);
      auStack_7e4[0] = 0;
      FUN_0052c930(local_7f4,auStack_7e4,piVar3,iVar1,0,
                   (*(int *)(iVar1 + 8) - *(int *)(iVar1 + 0xc) >> 4) + -0x1f +
                   *(int *)(iVar1 + 0x1c) * 0x20,0);
      FUN_005272e0(&puStack_7f8,*(undefined4 *)(param_1 + 0x18),0xffffffff,0);
      FUN_0052ab00(param_1,&DAT_00b8b674,*puStack_7f8);
      puStack_7f8[2] = puStack_7f8[2] + -1;
      if (puStack_7f8[2] == 0) {
        FUN_00525340();
      }
      FUN_00526bc0();
      FUN_00526bc0();
      __security_check_cookie(local_4 ^ (uint)&puStack_7fc);
      return;
    }
    FUN_00526bc0();
  }
  uVar6 = *(undefined4 *)(param_1 + 0x18);
  FUN_00526260(0);
  FUN_005272e0(&puStack_7fc,uVar6,0xffffffff,0);
  _MaxCount = puStack_7fc[4];
  if (1999 < _MaxCount) {
    _MaxCount = 1999;
  }
  _strncpy_s(acStack_7d4,2000,(char *)*puStack_7fc,_MaxCount);
  acStack_7d4[_MaxCount] = '\0';
  pcVar5 = acStack_7d4;
  while (acStack_7d4[0] != '\0') {
    if (*pcVar5 == '\r') {
      *pcVar5 = '\n';
    }
    pcVar5 = pcVar5 + 1;
    acStack_7d4[0] = *pcVar5;
  }
  if ((uint)puStack_7fc[4] < 2000) {
    pcVar5 = "%s\n";
  }
  else {
    pcVar5 = "%s ...<truncated>\n";
  }
  FUN_0052ab00(param_1,pcVar5,acStack_7d4);
  puStack_7fc[2] = puStack_7fc[2] + -1;
  if (puStack_7fc[2] == 0) {
    FUN_00525340();
  }
  __security_check_cookie(local_4 ^ (uint)&puStack_7fc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0052f060 : SUB ESP,0x7fc
0052f066 : MOV EAX,[0x00d66fa0]
0052f06b : XOR EAX,ESP
0052f06d : MOV dword ptr [ESP + 0x7f8],EAX
0052f074 : PUSH ESI
0052f075 : MOV ESI,dword ptr [ESP + 0x804]
0052f07c : MOV EAX,dword ptr [ESI + 0x18]
0052f07f : PUSH EDI
0052f080 : PUSH EAX
0052f081 : PUSH 0x0
0052f083 : MOV ECX,ESI
0052f085 : CALL 0x00526260
0052f08a : MOV ECX,EAX
0052f08c : CALL 0x005270f0
0052f091 : MOV EDI,EAX
0052f093 : TEST EDI,EDI
0052f095 : JZ 0x0052f17f
0052f09b : MOV EAX,dword ptr [ESI + 0x18]
0052f09e : MOV EDX,dword ptr [EDI]
0052f0a0 : PUSH EBP
0052f0a1 : ADD EAX,0x78
0052f0a4 : MOV byte ptr [ESP + 0x14],0x0
0052f0a9 : MOV ECX,dword ptr [EAX]
0052f0ab : LEA EBP,[ESP + 0x14]
0052f0af : PUSH EBP
0052f0b0 : ADD ECX,0x154
0052f0b6 : PUSH ECX
0052f0b7 : PUSH EAX
0052f0b8 : MOV EAX,dword ptr [EDX + 0x2c]
0052f0bb : MOV ECX,EDI
0052f0bd : CALL EAX
0052f0bf : POP EBP
0052f0c0 : TEST AL,AL
0052f0c2 : JZ 0x0052f176
0052f0c8 : MOV AL,byte ptr [ESP + 0x10]
0052f0cc : CMP AL,0x8
0052f0ce : JZ 0x0052f0d8
0052f0d0 : CMP AL,0xb
0052f0d2 : JNZ 0x0052f176
0052f0d8 : MOV EAX,dword ptr [ESI + 0x18]
0052f0db : MOV byte ptr [ESP + 0x20],0x0
0052f0e0 : MOV ECX,dword ptr [EAX + 0x8]
0052f0e3 : SUB ECX,dword ptr [EAX + 0xc]
0052f0e6 : MOV EDX,dword ptr [EAX + 0x1c]
0052f0e9 : PUSH 0x0
0052f0eb : SHL EDX,0x5
0052f0ee : SAR ECX,0x4
0052f0f1 : LEA ECX,[ECX + EDX*0x1 + -0x1f]
0052f0f5 : PUSH ECX
0052f0f6 : PUSH 0x0
0052f0f8 : PUSH EAX
0052f0f9 : PUSH EDI
0052f0fa : LEA EDX,[ESP + 0x34]
0052f0fe : PUSH EDX
0052f0ff : LEA EAX,[ESP + 0x28]
0052f103 : PUSH EAX
0052f104 : CALL 0x0052c930
0052f109 : MOV ECX,dword ptr [ESI + 0x18]
0052f10c : ADD ESP,0x1c
0052f10f : PUSH 0x0
0052f111 : PUSH -0x1
0052f113 : PUSH ECX
0052f114 : LEA EDX,[ESP + 0x18]
0052f118 : PUSH EDX
0052f119 : LEA ECX,[ESP + 0x30]
0052f11d : CALL 0x005272e0
0052f122 : MOV EAX,dword ptr [ESP + 0xc]
0052f126 : MOV ECX,dword ptr [EAX]
0052f128 : PUSH ECX
0052f129 : PUSH 0xb8b674
0052f12e : PUSH ESI
0052f12f : CALL 0x0052ab00
0052f134 : MOV EAX,dword ptr [ESP + 0x18]
0052f138 : DEC dword ptr [EAX + 0x8]
0052f13b : MOV ECX,EAX
0052f13d : ADD EAX,0x8
0052f140 : ADD ESP,0xc
0052f143 : CMP dword ptr [EAX],0x0
0052f146 : JNZ 0x0052f14d
0052f148 : CALL 0x00525340
0052f14d : LEA ECX,[ESP + 0x20]
0052f151 : CALL 0x00526bc0
0052f156 : LEA ECX,[ESP + 0x10]
0052f15a : CALL 0x00526bc0
0052f15f : POP EDI
0052f160 : POP ESI
0052f161 : MOV ECX,dword ptr [ESP + 0x7f8]
0052f168 : XOR ECX,ESP
0052f16a : CALL 0x00633e6b
0052f16f : ADD ESP,0x7fc
0052f175 : RET
0052f176 : LEA ECX,[ESP + 0x10]
0052f17a : CALL 0x00526bc0
0052f17f : MOV EDI,dword ptr [ESI + 0x18]
0052f182 : PUSH 0x0
0052f184 : MOV ECX,ESI
0052f186 : CALL 0x00526260
0052f18b : PUSH 0x0
0052f18d : PUSH -0x1
0052f18f : PUSH EDI
0052f190 : LEA EDX,[ESP + 0x14]
0052f194 : PUSH EDX
0052f195 : MOV ECX,EAX
0052f197 : CALL 0x005272e0
0052f19c : MOV ECX,dword ptr [ESP + 0x8]
0052f1a0 : MOV EAX,dword ptr [ECX + 0x10]
0052f1a3 : MOV EDI,EAX
0052f1a5 : CMP EAX,0x7d0
0052f1aa : JC 0x0052f1b1
0052f1ac : MOV EDI,0x7cf
0052f1b1 : MOV EAX,dword ptr [ECX]
0052f1b3 : PUSH EDI
0052f1b4 : PUSH EAX
0052f1b5 : LEA ECX,[ESP + 0x38]
0052f1b9 : PUSH 0x7d0
0052f1be : PUSH ECX
0052f1bf : CALL 0x0063c196
0052f1c4 : ADD ESP,0x10
0052f1c7 : MOV byte ptr [ESP + EDI*0x1 + 0x30],0x0
0052f1cc : CMP byte ptr [ESP + 0x30],0x0
0052f1d1 : LEA EAX,[ESP + 0x30]
0052f1d5 : JZ 0x0052f1e5
0052f1d7 : CMP byte ptr [EAX],0xd
0052f1da : JNZ 0x0052f1df
0052f1dc : MOV byte ptr [EAX],0xa
0052f1df : INC EAX
0052f1e0 : CMP byte ptr [EAX],0x0
0052f1e3 : JNZ 0x0052f1d7
0052f1e5 : MOV EDX,dword ptr [ESP + 0x8]
0052f1e9 : CMP dword ptr [EDX + 0x10],0x7d0
0052f1f0 : JNC 0x0052f1fe
0052f1f2 : LEA EAX,[ESP + 0x30]
0052f1f6 : PUSH EAX
0052f1f7 : PUSH 0xb8b674
0052f1fc : JMP 0x0052f208
0052f1fe : LEA ECX,[ESP + 0x30]
0052f202 : PUSH ECX
0052f203 : PUSH 0xb8b660
0052f208 : PUSH ESI
0052f209 : CALL 0x0052ab00
0052f20e : MOV EAX,dword ptr [ESP + 0x14]
0052f212 : DEC dword ptr [EAX + 0x8]
0052f215 : MOV ECX,EAX
0052f217 : ADD EAX,0x8
0052f21a : ADD ESP,0xc
0052f21d : CMP dword ptr [EAX],0x0
0052f220 : JNZ 0x0052f227
0052f222 : CALL 0x00525340
0052f227 : MOV ECX,dword ptr [ESP + 0x800]
0052f22e : POP EDI
0052f22f : POP ESI
0052f230 : XOR ECX,ESP
0052f232 : CALL 0x00633e6b
0052f237 : ADD ESP,0x7fc
0052f23d : RET

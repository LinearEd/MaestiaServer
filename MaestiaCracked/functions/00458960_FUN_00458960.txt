PROGRAM  : Maestia.exe
FUNCTION : FUN_00458960
ENTRY    : 00458960
BODY     : [[00458960, 00458999] [004589a0, 00458b2e]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00458960(int param_1,int *param_2,int param_3,int *param_4)

{
  int *piVar1;
  int *piVar2;
  uint uVar3;
  uint uVar4;
  float fVar5;
  float fVar6;
  char cVar7;
  int iVar8;
  ushort *puVar9;
  int iVar10;
  ushort *puVar11;
  uint uVar12;
  int *piVar13;
  int iVar14;
  
  iVar10 = param_3;
  iVar8 = FUN_0044f3f0();
  piVar13 = *(int **)(*(int *)(param_1 + 0x14) + 4 + iVar8 * 4);
  piVar2 = *(int **)(*(int *)(param_1 + 0x14) + iVar8 * 4);
  iVar14 = iVar10;
  if (piVar13 != piVar2) {
    uVar3 = *(uint *)(iVar10 + 0x14);
    do {
      piVar13 = (int *)piVar13[1];
      uVar4 = piVar13[7];
      if ((uint)piVar13[8] < 8) {
        puVar9 = (ushort *)(piVar13 + 3);
      }
      else {
        puVar9 = (ushort *)piVar13[3];
      }
      uVar12 = uVar3;
      if (uVar4 <= uVar3) {
        uVar12 = uVar4;
      }
      if (*(uint *)(iVar10 + 0x18) < 8) {
        puVar11 = (ushort *)(param_3 + 4);
      }
      else {
        puVar11 = *(ushort **)(param_3 + 4);
      }
      for (; uVar12 != 0; uVar12 = uVar12 - 1) {
        if (*puVar11 != *puVar9) {
          uVar12 = (-(uint)(*puVar11 < *puVar9) & 0xfffffffe) + 1;
          if (uVar12 != 0) goto LAB_004589f8;
          break;
        }
        puVar11 = puVar11 + 1;
        puVar9 = puVar9 + 1;
      }
      if (uVar4 <= uVar3) {
        uVar12 = (uint)(uVar3 != uVar4);
LAB_004589f8:
        if (-1 < (int)uVar12) {
          cVar7 = FUN_0042be00();
          if (cVar7 == '\0') {
            if (param_4 != *(int **)(param_1 + 8)) {
              FUN_00458e30(&param_3,param_4);
            }
            *param_2 = (int)piVar13;
            *(undefined1 *)(param_2 + 1) = 0;
            return;
          }
          piVar13 = (int *)*piVar13;
          iVar14 = param_3;
          break;
        }
      }
      iVar14 = param_3;
    } while (piVar13 != piVar2);
  }
  if (param_4 == *(int **)(param_1 + 8)) {
    iVar10 = FUN_00459390(piVar13,piVar13[1],iVar14);
    FUN_00459450();
    piVar13[1] = iVar10;
    **(int **)(iVar10 + 4) = iVar10;
    param_4 = (int *)piVar13[1];
  }
  else if (((param_4 != *(int **)(param_1 + 8)) && (piVar13 != param_4)) &&
          (piVar13 != (int *)*param_4)) {
    FUN_00459290(piVar13,param_4,(int *)*param_4);
  }
  piVar1 = *(int **)(*(int *)(param_1 + 0x14) + iVar8 * 4);
  piVar2 = (int *)(*(int *)(param_1 + 0x14) + iVar8 * 4);
  while ((piVar13 == piVar1 && (*piVar2 = (int)param_4, iVar8 != 0))) {
    iVar8 = iVar8 + -1;
    piVar1 = *(int **)(*(int *)(param_1 + 0x14) + iVar8 * 4);
    piVar2 = (int *)(*(int *)(param_1 + 0x14) + iVar8 * 4);
  }
  fVar5 = (float)*(int *)(param_1 + 0xc);
  if (*(int *)(param_1 + 0xc) < 0) {
    fVar5 = fVar5 + 4.2949673e+09;
  }
  fVar6 = (float)*(int *)(param_1 + 0x24);
  if (*(int *)(param_1 + 0x24) < 0) {
    fVar6 = fVar6 + 4.2949673e+09;
  }
  if (*(float *)(param_1 + 0x28) < fVar5 / fVar6) {
    FUN_00458c90();
  }
  *param_2 = (int)param_4;
  *(undefined1 *)(param_2 + 1) = 1;
  return;
}



============================================================
DISASSEMBLY
============================================================
00458960 : PUSH EBP
00458961 : MOV EBP,ESP
00458963 : SUB ESP,0x14
00458966 : PUSH EBX
00458967 : PUSH ESI
00458968 : MOV ESI,dword ptr [EBP + 0x8]
0045896b : PUSH EDI
0045896c : MOV EDI,dword ptr [EBP + 0x10]
0045896f : MOV EAX,EDI
00458971 : CALL 0x0044f3f0
00458976 : MOV ECX,dword ptr [ESI + 0x14]
00458979 : MOV EBX,dword ptr [ECX + EAX*0x4 + 0x4]
0045897d : MOV dword ptr [EBP + -0x10],EAX
00458980 : LEA EAX,[ECX + EAX*0x4]
00458983 : MOV EAX,dword ptr [EAX]
00458985 : MOV dword ptr [EBP + -0xc],EAX
00458988 : CMP EBX,EAX
0045898a : JZ 0x00458a04
0045898c : MOV EDX,dword ptr [EDI + 0x14]
0045898f : MOV EAX,dword ptr [EDI + 0x18]
00458992 : MOV dword ptr [EBP + -0x4],EDX
00458995 : MOV dword ptr [EBP + -0x8],EAX
00458998 : JMP 0x004589a3
004589a0 : MOV EDX,dword ptr [EBP + -0x4]
004589a3 : MOV EBX,dword ptr [EBX + 0x4]
004589a6 : CMP dword ptr [EBX + 0x20],0x8
004589aa : MOV EDI,dword ptr [EBX + 0x1c]
004589ad : JC 0x004589b4
004589af : MOV EAX,dword ptr [EBX + 0xc]
004589b2 : JMP 0x004589b7
004589b4 : LEA EAX,[EBX + 0xc]
004589b7 : CMP EDX,EDI
004589b9 : JC 0x004589bd
004589bb : MOV EDX,EDI
004589bd : CMP dword ptr [EBP + -0x8],0x8
004589c1 : MOV ECX,dword ptr [EBP + 0x10]
004589c4 : JC 0x004589cb
004589c6 : MOV ECX,dword ptr [ECX + 0x4]
004589c9 : JMP 0x004589ce
004589cb : ADD ECX,0x4
004589ce : TEST EDX,EDX
004589d0 : JBE 0x004589e8
004589d2 : MOV SI,word ptr [ECX]
004589d5 : CMP SI,word ptr [EAX]
004589d8 : JNZ 0x00458a49
004589da : ADD ECX,0x2
004589dd : ADD EAX,0x2
004589e0 : SUB EDX,0x1
004589e3 : JNZ 0x004589d2
004589e5 : MOV ESI,dword ptr [EBP + 0x8]
004589e8 : MOV EAX,dword ptr [EBP + -0x4]
004589eb : CMP EAX,EDI
004589ed : JC 0x004589fc
004589ef : XOR ECX,ECX
004589f1 : CMP EAX,EDI
004589f3 : SETNZ CL
004589f6 : MOV EAX,ECX
004589f8 : TEST EAX,EAX
004589fa : JGE 0x00458a5e
004589fc : CMP EBX,dword ptr [EBP + -0xc]
004589ff : JNZ 0x004589a0
00458a01 : MOV EDI,dword ptr [EBP + 0x10]
00458a04 : MOV ECX,dword ptr [EBP + 0x14]
00458a07 : CMP ECX,dword ptr [ESI + 0x8]
00458a0a : JZ 0x00458a98
00458a10 : CMP ECX,dword ptr [ESI + 0x8]
00458a13 : LEA EDX,[ESI + 0x4]
00458a16 : JZ 0x00458ac0
00458a1c : MOV EAX,dword ptr [ECX]
00458a1e : CMP EDX,EDX
00458a20 : JNZ 0x00458a32
00458a22 : CMP EBX,ECX
00458a24 : JZ 0x00458ac0
00458a2a : CMP EBX,EAX
00458a2c : JZ 0x00458ac0
00458a32 : PUSH EAX
00458a33 : PUSH ECX
00458a34 : PUSH EBX
00458a35 : MOV EDI,0x1
00458a3a : MOV ESI,EDX
00458a3c : CALL 0x00459290
00458a41 : MOV ECX,dword ptr [EBP + 0x14]
00458a44 : MOV ESI,dword ptr [EBP + 0x8]
00458a47 : JMP 0x00458ac0
00458a49 : MOV DX,SI
00458a4c : CMP DX,word ptr [EAX]
00458a4f : SBB EAX,EAX
00458a51 : AND EAX,0xfffffffe
00458a54 : ADD EAX,0x1
00458a57 : JZ 0x004589e5
00458a59 : MOV ESI,dword ptr [EBP + 0x8]
00458a5c : JMP 0x004589f8
00458a5e : MOV EAX,dword ptr [EBP + 0x10]
00458a61 : LEA ECX,[EBX + 0x8]
00458a64 : CALL 0x0042be00
00458a69 : TEST AL,AL
00458a6b : JZ 0x00458a71
00458a6d : MOV EBX,dword ptr [EBX]
00458a6f : JMP 0x00458a01
00458a71 : MOV EAX,dword ptr [EBP + 0x14]
00458a74 : CMP EAX,dword ptr [ESI + 0x8]
00458a77 : JZ 0x00458a86
00458a79 : PUSH EAX
00458a7a : LEA EDX,[EBP + 0x10]
00458a7d : PUSH EDX
00458a7e : LEA EDI,[ESI + 0x4]
00458a81 : CALL 0x00458e30
00458a86 : MOV EAX,dword ptr [EBP + 0xc]
00458a89 : MOV dword ptr [EAX],EBX
00458a8b : MOV byte ptr [EAX + 0x4],0x0
00458a8f : POP EDI
00458a90 : POP ESI
00458a91 : POP EBX
00458a92 : MOV ESP,EBP
00458a94 : POP EBP
00458a95 : RET 0x10
00458a98 : MOV EAX,dword ptr [EBX + 0x4]
00458a9b : PUSH EDI
00458a9c : PUSH EAX
00458a9d : PUSH EBX
00458a9e : CALL 0x00459390
00458aa3 : LEA EDX,[ESI + 0x4]
00458aa6 : MOV ECX,0x1
00458aab : MOV EDI,EAX
00458aad : CALL 0x00459450
00458ab2 : MOV dword ptr [EBX + 0x4],EDI
00458ab5 : MOV ECX,dword ptr [EDI + 0x4]
00458ab8 : MOV dword ptr [ECX],EDI
00458aba : MOV ECX,dword ptr [EBX + 0x4]
00458abd : MOV dword ptr [EBP + 0x14],ECX
00458ac0 : MOV EAX,dword ptr [ESI + 0x14]
00458ac3 : MOV EDX,dword ptr [EBP + -0x10]
00458ac6 : CMP EBX,dword ptr [EAX + EDX*0x4]
00458ac9 : LEA EAX,[EAX + EDX*0x4]
00458acc : JNZ 0x00458ae8
00458ace : JMP 0x00458ad3
00458ad0 : MOV ECX,dword ptr [EBP + 0x14]
00458ad3 : MOV dword ptr [EAX],ECX
00458ad5 : TEST EDX,EDX
00458ad7 : JZ 0x00458ae5
00458ad9 : MOV ECX,dword ptr [ESI + 0x14]
00458adc : DEC EDX
00458add : CMP EBX,dword ptr [ECX + EDX*0x4]
00458ae0 : LEA EAX,[ECX + EDX*0x4]
00458ae3 : JZ 0x00458ad0
00458ae5 : MOV ECX,dword ptr [EBP + 0x14]
00458ae8 : MOV EDX,dword ptr [ESI + 0xc]
00458aeb : FILD dword ptr [ESI + 0xc]
00458aee : TEST EDX,EDX
00458af0 : JGE 0x00458af8
00458af2 : FADD float ptr [0x00cdf0e0]
00458af8 : MOV EAX,dword ptr [ESI + 0x24]
00458afb : FILD dword ptr [ESI + 0x24]
00458afe : TEST EAX,EAX
00458b00 : JGE 0x00458b08
00458b02 : FADD float ptr [0x00cdf0e0]
00458b08 : FDIVP
00458b0a : FLD float ptr [ESI + 0x28]
00458b0d : FXCH
00458b0f : FCOMIP ST0,ST1
00458b11 : FSTP ST0
00458b13 : JBE 0x00458b1d
00458b15 : CALL 0x00458c90
00458b1a : MOV ECX,dword ptr [EBP + 0x14]
00458b1d : MOV EAX,dword ptr [EBP + 0xc]
00458b20 : POP EDI
00458b21 : POP ESI
00458b22 : MOV dword ptr [EAX],ECX
00458b24 : MOV byte ptr [EAX + 0x4],0x1
00458b28 : POP EBX
00458b29 : MOV ESP,EBP
00458b2b : POP EBP
00458b2c : RET 0x10

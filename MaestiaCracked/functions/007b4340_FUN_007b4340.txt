PROGRAM  : Maestia.exe
FUNCTION : FUN_007b4340
ENTRY    : 007b4340
BODY     : [[007b4340, 007b43d4]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_007b4340(int param_1,uint param_2)

{
  int *_Src;
  char cVar1;
  int *in_EAX;
  int iVar2;
  uint uVar3;
  void *_Dst;
  int *local_8;
  
  if (*in_EAX == 0x20534444) {
    local_8 = in_EAX + 2;
    if (in_EAX[1] == 0x7c) {
      if (param_1 == 0) {
        iVar2 = 0;
      }
      else {
        iVar2 = param_1 + 8;
      }
      cVar1 = FUN_007b41a0(iVar2,&local_8);
      _Src = local_8;
      if (cVar1 != '\0') {
        uVar3 = (int)in_EAX + (param_2 - (int)local_8);
        *(uint *)(param_1 + 0x1c) = uVar3;
        if (uVar3 <= param_2) {
          _Dst = (void *)FUN_006f0820(uVar3);
          *(void **)(param_1 + 0x18) = _Dst;
          if (((_Dst != (void *)0x0) && (in_EAX <= _Src)) &&
             (_Src <= (int *)((int)in_EAX + param_2))) {
            _memcpy(_Dst,_Src,*(size_t *)(param_1 + 0x1c));
            return 1;
          }
        }
      }
    }
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
007b4340 : PUSH EBP
007b4341 : MOV EBP,ESP
007b4343 : SUB ESP,0x1c
007b4346 : PUSH EBX
007b4347 : MOV EBX,dword ptr [EBP + 0x8]
007b434a : PUSH ESI
007b434b : PUSH EDI
007b434c : MOV EDI,EAX
007b434e : CMP dword ptr [EDI],0x20534444
007b4354 : LEA ECX,[EDI + 0x4]
007b4357 : JNZ 0x007b43cc
007b4359 : MOV EAX,dword ptr [ECX]
007b435b : ADD ECX,0x4
007b435e : MOV dword ptr [EBP + -0x4],ECX
007b4361 : CMP EAX,0x7c
007b4364 : JNZ 0x007b43cc
007b4366 : TEST EBX,EBX
007b4368 : JZ 0x007b436f
007b436a : LEA EAX,[EBX + 0x8]
007b436d : JMP 0x007b4371
007b436f : XOR EAX,EAX
007b4371 : LEA EDX,[EBP + -0x4]
007b4374 : PUSH EDX
007b4375 : PUSH EAX
007b4376 : LEA ESI,[EBP + -0x1c]
007b4379 : CALL 0x007b41a0
007b437e : ADD ESP,0x8
007b4381 : TEST AL,AL
007b4383 : JZ 0x007b43cc
007b4385 : MOV ESI,dword ptr [EBP + -0x4]
007b4388 : MOV ECX,dword ptr [EBP + 0xc]
007b438b : MOV EAX,EDI
007b438d : SUB EAX,ESI
007b438f : ADD EAX,ECX
007b4391 : MOV dword ptr [EBX + 0x1c],EAX
007b4394 : CMP EAX,ECX
007b4396 : JA 0x007b43cc
007b4398 : PUSH EAX
007b4399 : CALL 0x006f0820
007b439e : ADD ESP,0x4
007b43a1 : MOV dword ptr [EBX + 0x18],EAX
007b43a4 : TEST EAX,EAX
007b43a6 : JZ 0x007b43cc
007b43a8 : CMP ESI,EDI
007b43aa : JC 0x007b43cc
007b43ac : MOV ECX,dword ptr [EBP + 0xc]
007b43af : ADD EDI,ECX
007b43b1 : CMP ESI,EDI
007b43b3 : JA 0x007b43cc
007b43b5 : MOV EDX,dword ptr [EBX + 0x1c]
007b43b8 : PUSH EDX
007b43b9 : PUSH ESI
007b43ba : PUSH EAX
007b43bb : CALL 0x0063ae40
007b43c0 : ADD ESP,0xc
007b43c3 : MOV AL,0x1
007b43c5 : POP EDI
007b43c6 : POP ESI
007b43c7 : POP EBX
007b43c8 : MOV ESP,EBP
007b43ca : POP EBP
007b43cb : RET
007b43cc : POP EDI
007b43cd : POP ESI
007b43ce : XOR AL,AL
007b43d0 : POP EBX
007b43d1 : MOV ESP,EBP
007b43d3 : POP EBP
007b43d4 : RET

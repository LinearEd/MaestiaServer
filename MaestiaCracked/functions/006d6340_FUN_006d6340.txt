PROGRAM  : Maestia.exe
FUNCTION : FUN_006d6340
ENTRY    : 006d6340
BODY     : [[006d6340, 006d6379] [006d6380, 006d645c]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_006d6340(int *param_1)

{
  byte bVar1;
  undefined4 *puVar2;
  char cVar3;
  uint uVar4;
  byte *pbVar5;
  int iVar6;
  
  puVar2 = (undefined4 *)param_1[6];
  pbVar5 = (byte *)*puVar2;
  iVar6 = puVar2[1];
  while( true ) {
    if (iVar6 == 0) {
      cVar3 = (*(code *)puVar2[3])(param_1);
      if (cVar3 == '\0') {
        return 0;
      }
      pbVar5 = (byte *)*puVar2;
      iVar6 = puVar2[1];
    }
    bVar1 = *pbVar5;
    while( true ) {
      pbVar5 = pbVar5 + 1;
      iVar6 = iVar6 + -1;
      if (bVar1 == 0xff) break;
      *(int *)(param_1[0x65] + 0x14) = *(int *)(param_1[0x65] + 0x14) + 1;
      *puVar2 = pbVar5;
      puVar2[1] = iVar6;
      if (iVar6 == 0) {
        cVar3 = (*(code *)puVar2[3])(param_1);
        if (cVar3 == '\0') {
          return 0;
        }
        pbVar5 = (byte *)*puVar2;
        iVar6 = puVar2[1];
      }
      bVar1 = *pbVar5;
    }
    do {
      if (iVar6 == 0) {
        cVar3 = (*(code *)puVar2[3])(param_1);
        if (cVar3 == '\0') {
          return 0;
        }
        pbVar5 = (byte *)*puVar2;
        iVar6 = puVar2[1];
      }
      uVar4 = (uint)*pbVar5;
      iVar6 = iVar6 + -1;
      pbVar5 = pbVar5 + 1;
    } while (uVar4 == 0xff);
    if (uVar4 != 0) break;
    *(int *)(param_1[0x65] + 0x14) = *(int *)(param_1[0x65] + 0x14) + 2;
    *puVar2 = pbVar5;
    puVar2[1] = iVar6;
  }
  if (*(int *)(param_1[0x65] + 0x14) != 0) {
    *(undefined4 *)(*param_1 + 0x14) = 0x74;
    *(undefined4 *)(*param_1 + 0x18) = *(undefined4 *)(param_1[0x65] + 0x14);
    *(uint *)(*param_1 + 0x1c) = uVar4;
    (**(code **)(*param_1 + 4))(param_1,0xffffffff);
    *(undefined4 *)(param_1[0x65] + 0x14) = 0;
  }
  param_1[0x5f] = uVar4;
  puVar2[1] = iVar6;
  *puVar2 = pbVar5;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
006d6340 : PUSH EBX
006d6341 : MOV EBX,dword ptr [ESP + 0x8]
006d6345 : PUSH EBP
006d6346 : MOV EBP,dword ptr [EBX + 0x18]
006d6349 : PUSH ESI
006d634a : MOV ESI,dword ptr [EBP]
006d634d : PUSH EDI
006d634e : MOV EDI,dword ptr [EBP + 0x4]
006d6351 : TEST EDI,EDI
006d6353 : JNZ 0x006d636c
006d6355 : MOV EAX,dword ptr [EBP + 0xc]
006d6358 : PUSH EBX
006d6359 : CALL EAX
006d635b : ADD ESP,0x4
006d635e : TEST AL,AL
006d6360 : JZ 0x006d63fd
006d6366 : MOV ESI,dword ptr [EBP]
006d6369 : MOV EDI,dword ptr [EBP + 0x4]
006d636c : MOVZX EAX,byte ptr [ESI]
006d636f : DEC EDI
006d6370 : INC ESI
006d6371 : CMP EAX,0xff
006d6376 : JZ 0x006d63b8
006d6378 : JMP 0x006d6380
006d6380 : MOV EAX,dword ptr [EBX + 0x194]
006d6386 : INC dword ptr [EAX + 0x14]
006d6389 : MOV dword ptr [EBP],ESI
006d638c : MOV dword ptr [EBP + 0x4],EDI
006d638f : TEST EDI,EDI
006d6391 : JNZ 0x006d63a6
006d6393 : MOV ECX,dword ptr [EBP + 0xc]
006d6396 : PUSH EBX
006d6397 : CALL ECX
006d6399 : ADD ESP,0x4
006d639c : TEST AL,AL
006d639e : JZ 0x006d63fd
006d63a0 : MOV ESI,dword ptr [EBP]
006d63a3 : MOV EDI,dword ptr [EBP + 0x4]
006d63a6 : MOVZX EAX,byte ptr [ESI]
006d63a9 : DEC EDI
006d63aa : INC ESI
006d63ab : CMP EAX,0xff
006d63b0 : JNZ 0x006d6380
006d63b2 : JMP 0x006d63b8
006d63b4 : MOV EBX,dword ptr [ESP + 0x14]
006d63b8 : TEST EDI,EDI
006d63ba : JNZ 0x006d63cf
006d63bc : MOV EDX,dword ptr [EBP + 0xc]
006d63bf : PUSH EBX
006d63c0 : CALL EDX
006d63c2 : ADD ESP,0x4
006d63c5 : TEST AL,AL
006d63c7 : JZ 0x006d63fd
006d63c9 : MOV ESI,dword ptr [EBP]
006d63cc : MOV EDI,dword ptr [EBP + 0x4]
006d63cf : MOVZX EBX,byte ptr [ESI]
006d63d2 : DEC EDI
006d63d3 : INC ESI
006d63d4 : CMP EBX,0xff
006d63da : JZ 0x006d63b4
006d63dc : MOV EAX,dword ptr [ESP + 0x14]
006d63e0 : TEST EBX,EBX
006d63e2 : JNZ 0x006d6404
006d63e4 : MOV EAX,dword ptr [EAX + 0x194]
006d63ea : ADD dword ptr [EAX + 0x14],0x2
006d63ee : MOV EBX,dword ptr [ESP + 0x14]
006d63f2 : MOV dword ptr [EBP],ESI
006d63f5 : MOV dword ptr [EBP + 0x4],EDI
006d63f8 : JMP 0x006d6351
006d63fd : POP EDI
006d63fe : POP ESI
006d63ff : POP EBP
006d6400 : XOR AL,AL
006d6402 : POP EBX
006d6403 : RET
006d6404 : MOV ECX,dword ptr [EAX + 0x194]
006d640a : CMP dword ptr [ECX + 0x14],0x0
006d640e : JZ 0x006d644a
006d6410 : MOV EDX,dword ptr [EAX]
006d6412 : MOV dword ptr [EDX + 0x14],0x74
006d6419 : MOV ECX,dword ptr [EAX + 0x194]
006d641f : MOV EDX,dword ptr [EAX]
006d6421 : MOV ECX,dword ptr [ECX + 0x14]
006d6424 : MOV dword ptr [EDX + 0x18],ECX
006d6427 : MOV EDX,dword ptr [EAX]
006d6429 : MOV dword ptr [EDX + 0x1c],EBX
006d642c : MOV ECX,dword ptr [EAX]
006d642e : MOV EDX,dword ptr [ECX + 0x4]
006d6431 : PUSH -0x1
006d6433 : PUSH EAX
006d6434 : CALL EDX
006d6436 : MOV EAX,dword ptr [ESP + 0x1c]
006d643a : MOV ECX,dword ptr [EAX + 0x194]
006d6440 : ADD ESP,0x8
006d6443 : MOV dword ptr [ECX + 0x14],0x0
006d644a : MOV dword ptr [EAX + 0x17c],EBX
006d6450 : MOV dword ptr [EBP + 0x4],EDI
006d6453 : POP EDI
006d6454 : MOV dword ptr [EBP],ESI
006d6457 : POP ESI
006d6458 : POP EBP
006d6459 : MOV AL,0x1
006d645b : POP EBX
006d645c : RET

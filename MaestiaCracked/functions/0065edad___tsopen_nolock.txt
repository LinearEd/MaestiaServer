PROGRAM  : Maestia.exe
FUNCTION : __tsopen_nolock
ENTRY    : 0065edad
BODY     : [[0065edad, 0065edfc] [0065ee00, 0065f4cb]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    __tsopen_nolock
   
   Library: Visual Studio 2008 Release */

int __tsopen_nolock(undefined4 *param_1,LPCSTR param_2,uint param_3,int param_4,byte param_5)

{
  byte *pbVar1;
  byte bVar2;
  uint *in_EAX;
  errno_t eVar3;
  uint uVar4;
  ulong *puVar5;
  int *piVar6;
  DWORD DVar7;
  long lVar8;
  int iVar9;
  HANDLE pvVar10;
  byte bVar11;
  int unaff_EDI;
  int iVar12;
  bool bVar13;
  longlong lVar14;
  _SECURITY_ATTRIBUTES local_34;
  uint local_24;
  HANDLE local_20;
  uint local_1c;
  DWORD local_18;
  uint local_14;
  uint local_10;
  uint local_c;
  char local_8;
  byte local_7;
  byte local_6;
  byte local_5;
  
  bVar13 = (param_3 & 0x80) == 0;
  local_24 = 0;
  local_6 = 0;
  local_34.nLength = 0xc;
  local_34.lpSecurityDescriptor = (LPVOID)0x0;
  if (bVar13) {
    local_5 = 0;
  }
  else {
    local_5 = 0x10;
  }
  local_34.bInheritHandle = (BOOL)bVar13;
  eVar3 = __get_fmode((int *)&local_24);
  if (eVar3 != 0) {
                    /* WARNING: Subroutine does not return */
    __invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
  }
  if (((param_3 & 0x8000) == 0) && (((param_3 & 0x74000) != 0 || (local_24 != 0x8000)))) {
    local_5 = local_5 | 0x80;
  }
  uVar4 = param_3 & 3;
  if (uVar4 == 0) {
    local_c = 0x80000000;
  }
  else {
    if (uVar4 == 1) {
      if (((param_3 & 8) == 0) || ((param_3 & 0x70000) == 0)) {
        local_c = 0x40000000;
        goto LAB_0065ee7a;
      }
    }
    else if (uVar4 != 2) goto LAB_0065ee36;
    local_c = 0xc0000000;
  }
LAB_0065ee7a:
  if (param_4 == 0x10) {
    local_14 = 0;
  }
  else if (param_4 == 0x20) {
    local_14 = 1;
  }
  else if (param_4 == 0x30) {
    local_14 = 2;
  }
  else if (param_4 == 0x40) {
    local_14 = 3;
  }
  else {
    if (param_4 != 0x80) goto LAB_0065ee36;
    local_14 = (uint)(local_c == 0x80000000);
  }
  uVar4 = param_3 & 0x700;
  if (uVar4 < 0x401) {
    if ((uVar4 == 0x400) || (uVar4 == 0)) {
      local_18 = 3;
    }
    else if (uVar4 == 0x100) {
      local_18 = 4;
    }
    else {
      if (uVar4 == 0x200) goto LAB_0065ef7f;
      if (uVar4 != 0x300) goto LAB_0065ee36;
      local_18 = 2;
    }
  }
  else {
    if (uVar4 != 0x500) {
      if (uVar4 == 0x600) {
LAB_0065ef7f:
        local_18 = 5;
        goto LAB_0065ef2e;
      }
      if (uVar4 != 0x700) {
LAB_0065ee36:
        puVar5 = ___doserrno();
        *puVar5 = 0;
        *in_EAX = 0xffffffff;
        piVar6 = __errno();
        *piVar6 = 0x16;
        __invalid_parameter(0,0,0,0,0);
        return 0x16;
      }
    }
    local_18 = 1;
  }
LAB_0065ef2e:
  local_10 = 0x80;
  if (((param_3 & 0x100) != 0) && (-1 < (char)(~(byte)DAT_00d7b790 & param_5))) {
    local_10 = 1;
  }
  if ((param_3 & 0x40) != 0) {
    local_10 = local_10 | 0x4000000;
    local_c = local_c | 0x10000;
    local_14 = local_14 | 4;
  }
  if ((param_3 & 0x1000) != 0) {
    local_10 = local_10 | 0x100;
  }
  if ((param_3 & 0x20) == 0) {
    if ((param_3 & 0x10) != 0) {
      local_10 = local_10 | 0x10000000;
    }
  }
  else {
    local_10 = local_10 | 0x8000000;
  }
  uVar4 = __alloc_osfhnd();
  *in_EAX = uVar4;
  if (uVar4 == 0xffffffff) {
    puVar5 = ___doserrno();
    *puVar5 = 0;
    *in_EAX = 0xffffffff;
    piVar6 = __errno();
    *piVar6 = 0x18;
    goto LAB_0065f047;
  }
  *param_1 = 1;
  local_20 = CreateFileA(param_2,local_c,local_14,&local_34,local_18,local_10,(HANDLE)0x0);
  if (local_20 == (HANDLE)0xffffffff) {
    if (((local_c & 0xc0000000) == 0xc0000000) && ((param_3 & 1) != 0)) {
      local_c = local_c & 0x7fffffff;
      local_20 = CreateFileA(param_2,local_c,local_14,&local_34,local_18,local_10,(HANDLE)0x0);
      if (local_20 != (HANDLE)0xffffffff) goto LAB_0065f053;
    }
    pbVar1 = (byte *)((&DAT_01728c40)[(int)*in_EAX >> 5] + 4 + (*in_EAX & 0x1f) * 0x40);
    *pbVar1 = *pbVar1 & 0xfe;
    DVar7 = GetLastError();
    __dosmaperr(DVar7);
    goto LAB_0065f047;
  }
LAB_0065f053:
  DVar7 = GetFileType(local_20);
  if (DVar7 == 0) {
    pbVar1 = (byte *)((&DAT_01728c40)[(int)*in_EAX >> 5] + 4 + (*in_EAX & 0x1f) * 0x40);
    *pbVar1 = *pbVar1 & 0xfe;
    DVar7 = GetLastError();
    __dosmaperr(DVar7);
    CloseHandle(local_20);
    if (DVar7 == 0) {
      piVar6 = __errno();
      *piVar6 = 0xd;
    }
    goto LAB_0065f047;
  }
  if (DVar7 == 2) {
    local_5 = local_5 | 0x40;
  }
  else if (DVar7 == 3) {
    local_5 = local_5 | 8;
  }
  __set_osfhnd(*in_EAX,(intptr_t)local_20);
  bVar11 = local_5 | 1;
  *(byte *)((&DAT_01728c40)[(int)*in_EAX >> 5] + 4 + (*in_EAX & 0x1f) * 0x40) = bVar11;
  pbVar1 = (byte *)((&DAT_01728c40)[(int)*in_EAX >> 5] + 0x24 + (*in_EAX & 0x1f) * 0x40);
  *pbVar1 = *pbVar1 & 0x80;
  local_7 = local_5 & 0x48;
  if (local_7 == 0) {
    bVar2 = local_5 & 0x80;
    local_5 = bVar11;
    if (bVar2 == 0) goto LAB_0065f3c7;
    if ((param_3 & 2) == 0) goto LAB_0065f18d;
    local_1c = __lseek_nolock(*in_EAX,-1,2);
    if (local_1c == 0xffffffff) {
      puVar5 = ___doserrno();
      bVar11 = local_5;
      if (*puVar5 == 0x83) goto LAB_0065f18d;
    }
    else {
      local_8 = '\0';
      iVar12 = __read_nolock(*in_EAX,&local_8,1);
      if ((((iVar12 != 0) || (local_8 != '\x1a')) ||
          (iVar12 = __chsize_nolock(*in_EAX,CONCAT44(unaff_EDI,(int)local_1c >> 0x1f)), iVar12 != -1
          )) && (lVar8 = __lseek_nolock(*in_EAX,0,0), bVar11 = local_5, lVar8 != -1))
      goto LAB_0065f18d;
    }
LAB_0065f140:
    __close_nolock(*in_EAX);
    goto LAB_0065f047;
  }
LAB_0065f18d:
  local_5 = bVar11;
  if ((local_5 & 0x80) != 0) {
    if ((param_3 & 0x74000) == 0) {
      if ((local_24 & 0x74000) == 0) {
        param_3 = param_3 | 0x4000;
      }
      else {
        param_3 = param_3 | local_24 & 0x74000;
      }
    }
    uVar4 = param_3 & 0x74000;
    if (uVar4 == 0x4000) {
      local_6 = 0;
    }
    else if ((uVar4 == 0x10000) || (uVar4 == 0x14000)) {
      if ((param_3 & 0x301) == 0x301) goto LAB_0065f1fc;
    }
    else if ((uVar4 == 0x20000) || (uVar4 == 0x24000)) {
LAB_0065f1fc:
      local_6 = 2;
    }
    else if ((uVar4 == 0x40000) || (uVar4 == 0x44000)) {
      local_6 = 1;
    }
    if (((param_3 & 0x70000) != 0) && (local_1c = 0, (local_5 & 0x40) == 0)) {
      uVar4 = local_c & 0xc0000000;
      if (uVar4 == 0x40000000) {
        if (local_18 == 0) goto LAB_0065f3c7;
        if (2 < local_18) {
          if (local_18 < 5) {
            lVar14 = __lseeki64_nolock(*in_EAX,0x200000000,unaff_EDI);
            if (lVar14 == 0) goto LAB_0065f261;
            lVar14 = __lseeki64_nolock(*in_EAX,0,unaff_EDI);
            uVar4 = (uint)lVar14 & (uint)((ulonglong)lVar14 >> 0x20);
            goto LAB_0065f32d;
          }
LAB_0065f258:
          if (local_18 != 5) goto LAB_0065f3c7;
        }
LAB_0065f261:
        iVar12 = 0;
        if (local_6 == 1) {
          local_1c = (int)L"[ERROR] %s %d\n" + 0xf;
          local_18 = 3;
        }
        else {
          if (local_6 != 2) goto LAB_0065f3c7;
          local_1c = 0xfeff;
          local_18 = 2;
        }
        do {
          iVar9 = __write(*in_EAX,(void *)((int)&local_1c + iVar12),local_18 - iVar12);
          if (iVar9 == -1) goto LAB_0065f140;
          iVar12 = iVar12 + iVar9;
        } while (iVar12 < (int)local_18);
      }
      else {
        if (uVar4 != 0x80000000) {
          if ((uVar4 == 0xc0000000) && (local_18 != 0)) {
            if (2 < local_18) {
              if (4 < local_18) goto LAB_0065f258;
              lVar14 = __lseeki64_nolock(*in_EAX,0x200000000,unaff_EDI);
              if (lVar14 != 0) {
                lVar14 = __lseeki64_nolock(*in_EAX,0,unaff_EDI);
                if (lVar14 == -1) goto LAB_0065f140;
                goto LAB_0065f2b2;
              }
            }
            goto LAB_0065f261;
          }
          goto LAB_0065f3c7;
        }
LAB_0065f2b2:
        iVar12 = __read_nolock(*in_EAX,&local_1c,3);
        if (iVar12 == -1) goto LAB_0065f140;
        if (iVar12 == 2) {
LAB_0065f33b:
          if ((local_1c & 0xffff) == 0xfffe) {
            __close_nolock(*in_EAX);
            piVar6 = __errno();
            *piVar6 = 0x16;
            return 0x16;
          }
          if ((local_1c & 0xffff) == 0xfeff) {
            lVar8 = __lseek_nolock(*in_EAX,2,0);
            if (lVar8 == -1) goto LAB_0065f140;
            local_6 = 2;
            goto LAB_0065f3c7;
          }
        }
        else if (iVar12 == 3) {
          if (local_1c == (int)L"[ERROR] %s %d\n" + 0xfU) {
            local_6 = 1;
            goto LAB_0065f3c7;
          }
          goto LAB_0065f33b;
        }
        uVar4 = __lseek_nolock(*in_EAX,0,0);
LAB_0065f32d:
        if (uVar4 == 0xffffffff) goto LAB_0065f140;
      }
    }
  }
LAB_0065f3c7:
  uVar4 = local_c;
  pbVar1 = (byte *)((&DAT_01728c40)[(int)*in_EAX >> 5] + 0x24 + (*in_EAX & 0x1f) * 0x40);
  *pbVar1 = *pbVar1 ^ (*pbVar1 ^ local_6) & 0x7f;
  pbVar1 = (byte *)((&DAT_01728c40)[(int)*in_EAX >> 5] + 0x24 + (*in_EAX & 0x1f) * 0x40);
  *pbVar1 = (char)(param_3 >> 0x10) << 7 | *pbVar1 & 0x7f;
  if ((local_7 == 0) && ((param_3 & 8) != 0)) {
    pbVar1 = (byte *)((&DAT_01728c40)[(int)*in_EAX >> 5] + 4 + (*in_EAX & 0x1f) * 0x40);
    *pbVar1 = *pbVar1 | 0x20;
  }
  if (((local_c & 0xc0000000) == 0xc0000000) && ((param_3 & 1) != 0)) {
    CloseHandle(local_20);
    pvVar10 = CreateFileA(param_2,uVar4 & 0x7fffffff,local_14,&local_34,3,local_10,(HANDLE)0x0);
    if (pvVar10 == (HANDLE)0xffffffff) {
      DVar7 = GetLastError();
      __dosmaperr(DVar7);
      pbVar1 = (byte *)((&DAT_01728c40)[(int)*in_EAX >> 5] + 4 + (*in_EAX & 0x1f) * 0x40);
      *pbVar1 = *pbVar1 & 0xfe;
      __free_osfhnd(*in_EAX);
LAB_0065f047:
      piVar6 = __errno();
      return *piVar6;
    }
    *(HANDLE *)((*in_EAX & 0x1f) * 0x40 + (&DAT_01728c40)[(int)*in_EAX >> 5]) = pvVar10;
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
0065edad : MOV EDI,EDI
0065edaf : PUSH EBP
0065edb0 : MOV EBP,ESP
0065edb2 : SUB ESP,0x30
0065edb5 : PUSH EBX
0065edb6 : XOR EBX,EBX
0065edb8 : TEST byte ptr [EBP + 0x10],0x80
0065edbc : PUSH ESI
0065edbd : PUSH EDI
0065edbe : MOV ESI,EAX
0065edc0 : MOV dword ptr [EBP + -0x20],EBX
0065edc3 : MOV byte ptr [EBP + -0x2],BL
0065edc6 : MOV dword ptr [EBP + -0x30],0xc
0065edcd : MOV dword ptr [EBP + -0x2c],EBX
0065edd0 : JZ 0x0065eddb
0065edd2 : MOV dword ptr [EBP + -0x28],EBX
0065edd5 : MOV byte ptr [EBP + -0x1],0x10
0065edd9 : JMP 0x0065ede5
0065eddb : MOV dword ptr [EBP + -0x28],0x1
0065ede2 : MOV byte ptr [EBP + -0x1],BL
0065ede5 : LEA EAX,[EBP + -0x20]
0065ede8 : PUSH EAX
0065ede9 : CALL 0x0065d155
0065edee : POP ECX
0065edef : TEST EAX,EAX
0065edf1 : JZ 0x0065ee00
0065edf3 : PUSH EBX
0065edf4 : PUSH EBX
0065edf5 : PUSH EBX
0065edf6 : PUSH EBX
0065edf7 : PUSH EBX
0065edf8 : CALL 0x00637169
0065ee00 : MOV ECX,dword ptr [EBP + 0x10]
0065ee03 : MOV EAX,0x8000
0065ee08 : TEST EAX,ECX
0065ee0a : JNZ 0x0065ee1d
0065ee0c : TEST ECX,0x74000
0065ee12 : JNZ 0x0065ee19
0065ee14 : CMP dword ptr [EBP + -0x20],EAX
0065ee17 : JZ 0x0065ee1d
0065ee19 : OR byte ptr [EBP + -0x1],0x80
0065ee1d : MOV EAX,ECX
0065ee1f : AND EAX,0x3
0065ee22 : SUB EAX,EBX
0065ee24 : MOV EDX,0xc0000000
0065ee29 : MOV EDI,0x80000000
0065ee2e : JZ 0x0065ee77
0065ee30 : DEC EAX
0065ee31 : JZ 0x0065ee61
0065ee33 : DEC EAX
0065ee34 : JZ 0x0065ee5c
0065ee36 : CALL 0x0063ab95
0065ee3b : MOV dword ptr [EAX],EBX
0065ee3d : OR dword ptr [ESI],0xffffffff
0065ee40 : CALL 0x0063ab82
0065ee45 : PUSH 0x16
0065ee47 : POP ESI
0065ee48 : PUSH EBX
0065ee49 : PUSH EBX
0065ee4a : PUSH EBX
0065ee4b : PUSH EBX
0065ee4c : PUSH EBX
0065ee4d : MOV dword ptr [EAX],ESI
0065ee4f : CALL 0x006372b8
0065ee54 : ADD ESP,0x14
0065ee57 : JMP 0x0065f35c
0065ee5c : MOV dword ptr [EBP + -0x8],EDX
0065ee5f : JMP 0x0065ee7a
0065ee61 : TEST CL,0x8
0065ee64 : JZ 0x0065ee6e
0065ee66 : TEST ECX,0x70000
0065ee6c : JNZ 0x0065ee5c
0065ee6e : MOV dword ptr [EBP + -0x8],0x40000000
0065ee75 : JMP 0x0065ee7a
0065ee77 : MOV dword ptr [EBP + -0x8],EDI
0065ee7a : MOV EAX,dword ptr [EBP + 0x14]
0065ee7d : PUSH 0x10
0065ee7f : POP ECX
0065ee80 : SUB EAX,ECX
0065ee82 : JZ 0x0065eebb
0065ee84 : SUB EAX,ECX
0065ee86 : JZ 0x0065eeb2
0065ee88 : SUB EAX,ECX
0065ee8a : JZ 0x0065eea9
0065ee8c : SUB EAX,ECX
0065ee8e : JZ 0x0065eea0
0065ee90 : SUB EAX,0x40
0065ee93 : JNZ 0x0065ee36
0065ee95 : CMP dword ptr [EBP + -0x8],EDI
0065ee98 : SETZ AL
0065ee9b : MOV dword ptr [EBP + -0x10],EAX
0065ee9e : JMP 0x0065eebe
0065eea0 : MOV dword ptr [EBP + -0x10],0x3
0065eea7 : JMP 0x0065eebe
0065eea9 : MOV dword ptr [EBP + -0x10],0x2
0065eeb0 : JMP 0x0065eebe
0065eeb2 : MOV dword ptr [EBP + -0x10],0x1
0065eeb9 : JMP 0x0065eebe
0065eebb : MOV dword ptr [EBP + -0x10],EBX
0065eebe : MOV EAX,dword ptr [EBP + 0x10]
0065eec1 : MOV EDX,0x700
0065eec6 : AND EAX,EDX
0065eec8 : MOV ECX,0x400
0065eecd : CMP EAX,ECX
0065eecf : MOV EDI,0x100
0065eed4 : JG 0x0065ef11
0065eed6 : JZ 0x0065ef08
0065eed8 : CMP EAX,EBX
0065eeda : JZ 0x0065ef08
0065eedc : CMP EAX,EDI
0065eede : JZ 0x0065eeff
0065eee0 : CMP EAX,0x200
0065eee5 : JZ 0x0065ef7f
0065eeeb : CMP EAX,0x300
0065eef0 : JNZ 0x0065ee36
0065eef6 : MOV dword ptr [EBP + -0x14],0x2
0065eefd : JMP 0x0065ef2e
0065eeff : MOV dword ptr [EBP + -0x14],0x4
0065ef06 : JMP 0x0065ef2e
0065ef08 : MOV dword ptr [EBP + -0x14],0x3
0065ef0f : JMP 0x0065ef2e
0065ef11 : CMP EAX,0x500
0065ef16 : JZ 0x0065ef27
0065ef18 : CMP EAX,0x600
0065ef1d : JZ 0x0065ef7f
0065ef1f : CMP EAX,EDX
0065ef21 : JNZ 0x0065ee36
0065ef27 : MOV dword ptr [EBP + -0x14],0x1
0065ef2e : MOV EAX,dword ptr [EBP + 0x10]
0065ef31 : MOV dword ptr [EBP + -0xc],0x80
0065ef38 : TEST EDI,EAX
0065ef3a : JZ 0x0065ef52
0065ef3c : MOV ECX,dword ptr [0x00d7b790]
0065ef42 : NOT ECX
0065ef44 : AND ECX,dword ptr [EBP + 0x18]
0065ef47 : TEST CL,CL
0065ef49 : JS 0x0065ef52
0065ef4b : MOV dword ptr [EBP + -0xc],0x1
0065ef52 : TEST AL,0x40
0065ef54 : JZ 0x0065ef68
0065ef56 : OR dword ptr [EBP + -0xc],0x4000000
0065ef5d : OR dword ptr [EBP + -0x8],0x10000
0065ef64 : OR dword ptr [EBP + -0x10],0x4
0065ef68 : TEST EAX,0x1000
0065ef6d : JZ 0x0065ef72
0065ef6f : OR dword ptr [EBP + -0xc],EDI
0065ef72 : TEST AL,0x20
0065ef74 : JZ 0x0065ef88
0065ef76 : OR dword ptr [EBP + -0xc],0x8000000
0065ef7d : JMP 0x0065ef93
0065ef7f : MOV dword ptr [EBP + -0x14],0x5
0065ef86 : JMP 0x0065ef2e
0065ef88 : TEST AL,0x10
0065ef8a : JZ 0x0065ef93
0065ef8c : OR dword ptr [EBP + -0xc],0x10000000
0065ef93 : CALL 0x0065cd49
0065ef98 : MOV dword ptr [ESI],EAX
0065ef9a : CMP EAX,-0x1
0065ef9d : JNZ 0x0065efb9
0065ef9f : CALL 0x0063ab95
0065efa4 : MOV dword ptr [EAX],EBX
0065efa6 : OR dword ptr [ESI],0xffffffff
0065efa9 : CALL 0x0063ab82
0065efae : MOV dword ptr [EAX],0x18
0065efb4 : JMP 0x0065f047
0065efb9 : MOV EAX,dword ptr [EBP + 0x8]
0065efbc : MOV EDI,dword ptr [0x00b85318]
0065efc2 : PUSH EBX
0065efc3 : PUSH dword ptr [EBP + -0xc]
0065efc6 : MOV dword ptr [EAX],0x1
0065efcc : PUSH dword ptr [EBP + -0x14]
0065efcf : LEA EAX,[EBP + -0x30]
0065efd2 : PUSH EAX
0065efd3 : PUSH dword ptr [EBP + -0x10]
0065efd6 : PUSH dword ptr [EBP + -0x8]
0065efd9 : PUSH dword ptr [EBP + 0xc]
0065efdc : CALL EDI
0065efde : MOV dword ptr [EBP + -0x1c],EAX
0065efe1 : CMP EAX,-0x1
0065efe4 : JNZ 0x0065f053
0065efe6 : MOV ECX,dword ptr [EBP + -0x8]
0065efe9 : MOV EAX,0xc0000000
0065efee : AND ECX,EAX
0065eff0 : CMP ECX,EAX
0065eff2 : JNZ 0x0065f01f
0065eff4 : TEST byte ptr [EBP + 0x10],0x1
0065eff8 : JZ 0x0065f01f
0065effa : AND dword ptr [EBP + -0x8],0x7fffffff
0065f001 : PUSH EBX
0065f002 : PUSH dword ptr [EBP + -0xc]
0065f005 : LEA EAX,[EBP + -0x30]
0065f008 : PUSH dword ptr [EBP + -0x14]
0065f00b : PUSH EAX
0065f00c : PUSH dword ptr [EBP + -0x10]
0065f00f : PUSH dword ptr [EBP + -0x8]
0065f012 : PUSH dword ptr [EBP + 0xc]
0065f015 : CALL EDI
0065f017 : MOV dword ptr [EBP + -0x1c],EAX
0065f01a : CMP EAX,-0x1
0065f01d : JNZ 0x0065f053
0065f01f : MOV ESI,dword ptr [ESI]
0065f021 : MOV EAX,ESI
0065f023 : SAR EAX,0x5
0065f026 : MOV EAX,dword ptr [EAX*0x4 + 0x1728c40]
0065f02d : AND ESI,0x1f
0065f030 : SHL ESI,0x6
0065f033 : LEA EAX,[EAX + ESI*0x1 + 0x4]
0065f037 : AND byte ptr [EAX],0xfe
0065f03a : CALL dword ptr [0x00b85128]
0065f040 : PUSH EAX
0065f041 : CALL 0x0063aba8
0065f046 : POP ECX
0065f047 : CALL 0x0063ab82
0065f04c : MOV EAX,dword ptr [EAX]
0065f04e : JMP 0x0065f4c7
0065f053 : PUSH dword ptr [EBP + -0x1c]
0065f056 : CALL dword ptr [0x00b852a4]
0065f05c : CMP EAX,EBX
0065f05e : JNZ 0x0065f0a4
0065f060 : MOV ESI,dword ptr [ESI]
0065f062 : MOV EAX,ESI
0065f064 : SAR EAX,0x5
0065f067 : MOV EAX,dword ptr [EAX*0x4 + 0x1728c40]
0065f06e : AND ESI,0x1f
0065f071 : SHL ESI,0x6
0065f074 : LEA EAX,[EAX + ESI*0x1 + 0x4]
0065f078 : AND byte ptr [EAX],0xfe
0065f07b : CALL dword ptr [0x00b85128]
0065f081 : MOV ESI,EAX
0065f083 : PUSH ESI
0065f084 : CALL 0x0063aba8
0065f089 : POP ECX
0065f08a : PUSH dword ptr [EBP + -0x1c]
0065f08d : CALL dword ptr [0x00b85104]
0065f093 : CMP ESI,EBX
0065f095 : JNZ 0x0065f047
0065f097 : CALL 0x0063ab82
0065f09c : MOV dword ptr [EAX],0xd
0065f0a2 : JMP 0x0065f047
0065f0a4 : CMP EAX,0x2
0065f0a7 : JNZ 0x0065f0af
0065f0a9 : OR byte ptr [EBP + -0x1],0x40
0065f0ad : JMP 0x0065f0b8
0065f0af : CMP EAX,0x3
0065f0b2 : JNZ 0x0065f0b8
0065f0b4 : OR byte ptr [EBP + -0x1],0x8
0065f0b8 : PUSH dword ptr [EBP + -0x1c]
0065f0bb : PUSH dword ptr [ESI]
0065f0bd : CALL 0x0065cb04
0065f0c2 : MOV EAX,dword ptr [ESI]
0065f0c4 : MOV EDX,EAX
0065f0c6 : AND EAX,0x1f
0065f0c9 : SAR EDX,0x5
0065f0cc : MOV EDX,dword ptr [EDX*0x4 + 0x1728c40]
0065f0d3 : POP ECX
0065f0d4 : SHL EAX,0x6
0065f0d7 : POP ECX
0065f0d8 : MOV CL,byte ptr [EBP + -0x1]
0065f0db : OR CL,0x1
0065f0de : MOV byte ptr [EDX + EAX*0x1 + 0x4],CL
0065f0e2 : MOV EAX,dword ptr [ESI]
0065f0e4 : MOV EDX,EAX
0065f0e6 : AND EAX,0x1f
0065f0e9 : SAR EDX,0x5
0065f0ec : MOV EDX,dword ptr [EDX*0x4 + 0x1728c40]
0065f0f3 : SHL EAX,0x6
0065f0f6 : LEA EAX,[EDX + EAX*0x1 + 0x24]
0065f0fa : AND byte ptr [EAX],0x80
0065f0fd : MOV byte ptr [EBP + -0x3],CL
0065f100 : AND byte ptr [EBP + -0x3],0x48
0065f104 : MOV byte ptr [EBP + -0x1],CL
0065f107 : JNZ 0x0065f18d
0065f10d : TEST CL,0x80
0065f110 : JZ 0x0065f3c7
0065f116 : TEST byte ptr [EBP + 0x10],0x2
0065f11a : JZ 0x0065f18d
0065f11c : PUSH 0x2
0065f11e : OR EDI,0xffffffff
0065f121 : PUSH EDI
0065f122 : PUSH dword ptr [ESI]
0065f124 : CALL 0x006504d5
0065f129 : ADD ESP,0xc
0065f12c : MOV dword ptr [EBP + -0x18],EAX
0065f12f : CMP EAX,EDI
0065f131 : JNZ 0x0065f14c
0065f133 : CALL 0x0063ab95
0065f138 : CMP dword ptr [EAX],0x83
0065f13e : JZ 0x0065f18d
0065f140 : PUSH dword ptr [ESI]
0065f142 : CALL 0x00648d67
0065f147 : JMP 0x0065f046
0065f14c : PUSH 0x1
0065f14e : LEA EAX,[EBP + -0x4]
0065f151 : PUSH EAX
0065f152 : PUSH dword ptr [ESI]
0065f154 : MOV byte ptr [EBP + -0x4],BL
0065f157 : CALL 0x00653624
0065f15c : ADD ESP,0xc
0065f15f : TEST EAX,EAX
0065f161 : JNZ 0x0065f17d
0065f163 : CMP byte ptr [EBP + -0x4],0x1a
0065f167 : JNZ 0x0065f17d
0065f169 : MOV EAX,dword ptr [EBP + -0x18]
0065f16c : CDQ
0065f16d : PUSH EDX
0065f16e : PUSH EAX
0065f16f : PUSH dword ptr [ESI]
0065f171 : CALL 0x0065cee3
0065f176 : ADD ESP,0xc
0065f179 : CMP EAX,EDI
0065f17b : JZ 0x0065f140
0065f17d : PUSH EBX
0065f17e : PUSH EBX
0065f17f : PUSH dword ptr [ESI]
0065f181 : CALL 0x006504d5
0065f186 : ADD ESP,0xc
0065f189 : CMP EAX,EDI
0065f18b : JZ 0x0065f140
0065f18d : TEST byte ptr [EBP + -0x1],0x80
0065f191 : JZ 0x0065f3c7
0065f197 : MOV EDI,0x74000
0065f19c : MOV ECX,0x4000
0065f1a1 : TEST dword ptr [EBP + 0x10],EDI
0065f1a4 : JNZ 0x0065f1b5
0065f1a6 : MOV EAX,dword ptr [EBP + -0x20]
0065f1a9 : AND EAX,EDI
0065f1ab : JNZ 0x0065f1b2
0065f1ad : OR dword ptr [EBP + 0x10],ECX
0065f1b0 : JMP 0x0065f1b5
0065f1b2 : OR dword ptr [EBP + 0x10],EAX
0065f1b5 : MOV EAX,dword ptr [EBP + 0x10]
0065f1b8 : AND EAX,EDI
0065f1ba : CMP EAX,ECX
0065f1bc : JZ 0x0065f202
0065f1be : CMP EAX,0x10000
0065f1c3 : JZ 0x0065f1ee
0065f1c5 : CMP EAX,0x14000
0065f1ca : JZ 0x0065f1ee
0065f1cc : CMP EAX,0x20000
0065f1d1 : JZ 0x0065f1fc
0065f1d3 : CMP EAX,0x24000
0065f1d8 : JZ 0x0065f1fc
0065f1da : CMP EAX,0x40000
0065f1df : JZ 0x0065f1e8
0065f1e1 : CMP EAX,0x44000
0065f1e6 : JNZ 0x0065f205
0065f1e8 : MOV byte ptr [EBP + -0x2],0x1
0065f1ec : JMP 0x0065f205
0065f1ee : MOV ECX,dword ptr [EBP + 0x10]
0065f1f1 : MOV EAX,0x301
0065f1f6 : AND ECX,EAX
0065f1f8 : CMP ECX,EAX
0065f1fa : JNZ 0x0065f205
0065f1fc : MOV byte ptr [EBP + -0x2],0x2
0065f200 : JMP 0x0065f205
0065f202 : MOV byte ptr [EBP + -0x2],BL
0065f205 : TEST dword ptr [EBP + 0x10],0x70000
0065f20c : JZ 0x0065f3c7
0065f212 : TEST byte ptr [EBP + -0x1],0x40
0065f216 : MOV dword ptr [EBP + -0x18],EBX
0065f219 : JNZ 0x0065f3c7
0065f21f : MOV EAX,dword ptr [EBP + -0x8]
0065f222 : MOV ECX,0xc0000000
0065f227 : AND EAX,ECX
0065f229 : CMP EAX,0x40000000
0065f22e : JZ 0x0065f2eb
0065f234 : CMP EAX,0x80000000
0065f239 : JZ 0x0065f2b2
0065f23b : CMP EAX,ECX
0065f23d : JNZ 0x0065f3c7
0065f243 : MOV EAX,dword ptr [EBP + -0x14]
0065f246 : CMP EAX,EBX
0065f248 : JBE 0x0065f3c7
0065f24e : CMP EAX,0x2
0065f251 : JBE 0x0065f261
0065f253 : CMP EAX,0x4
0065f256 : JBE 0x0065f288
0065f258 : CMP EAX,0x5
0065f25b : JNZ 0x0065f3c7
0065f261 : MOVSX EAX,byte ptr [EBP + -0x2]
0065f265 : XOR EDI,EDI
0065f267 : DEC EAX
0065f268 : JZ 0x0065f394
0065f26e : DEC EAX
0065f26f : JNZ 0x0065f3c7
0065f275 : MOV dword ptr [EBP + -0x18],0xfeff
0065f27c : MOV dword ptr [EBP + -0x14],0x2
0065f283 : JMP 0x0065f3a2
0065f288 : PUSH 0x2
0065f28a : PUSH EBX
0065f28b : PUSH EBX
0065f28c : PUSH dword ptr [ESI]
0065f28e : CALL 0x0065c72d
0065f293 : ADD ESP,0x10
0065f296 : OR EAX,EDX
0065f298 : JZ 0x0065f261
0065f29a : PUSH EBX
0065f29b : PUSH EBX
0065f29c : PUSH EBX
0065f29d : PUSH dword ptr [ESI]
0065f29f : CALL 0x0065c72d
0065f2a4 : AND EAX,EDX
0065f2a6 : ADD ESP,0x10
0065f2a9 : CMP EAX,-0x1
0065f2ac : JZ 0x0065f140
0065f2b2 : PUSH 0x3
0065f2b4 : LEA EAX,[EBP + -0x18]
0065f2b7 : PUSH EAX
0065f2b8 : PUSH dword ptr [ESI]
0065f2ba : CALL 0x00653624
0065f2bf : ADD ESP,0xc
0065f2c2 : CMP EAX,-0x1
0065f2c5 : JZ 0x0065f140
0065f2cb : CMP EAX,0x2
0065f2ce : JZ 0x0065f33b
0065f2d0 : CMP EAX,0x3
0065f2d3 : JNZ 0x0065f386
0065f2d9 : CMP dword ptr [EBP + -0x18],0xbfbbef
0065f2e0 : JNZ 0x0065f33b
0065f2e2 : MOV byte ptr [EBP + -0x2],0x1
0065f2e6 : JMP 0x0065f3c7
0065f2eb : MOV EAX,dword ptr [EBP + -0x14]
0065f2ee : CMP EAX,EBX
0065f2f0 : JBE 0x0065f3c7
0065f2f6 : CMP EAX,0x2
0065f2f9 : JBE 0x0065f261
0065f2ff : CMP EAX,0x4
0065f302 : JA 0x0065f258
0065f308 : PUSH 0x2
0065f30a : PUSH EBX
0065f30b : PUSH EBX
0065f30c : PUSH dword ptr [ESI]
0065f30e : CALL 0x0065c72d
0065f313 : ADD ESP,0x10
0065f316 : OR EAX,EDX
0065f318 : JZ 0x0065f261
0065f31e : PUSH EBX
0065f31f : PUSH EBX
0065f320 : PUSH EBX
0065f321 : PUSH dword ptr [ESI]
0065f323 : CALL 0x0065c72d
0065f328 : ADD ESP,0x10
0065f32b : AND EAX,EDX
0065f32d : CMP EAX,-0x1
0065f330 : JNZ 0x0065f3c7
0065f336 : JMP 0x0065f140
0065f33b : MOV EAX,dword ptr [EBP + -0x18]
0065f33e : AND EAX,0xffff
0065f343 : CMP EAX,0xfffe
0065f348 : JNZ 0x0065f363
0065f34a : PUSH dword ptr [ESI]
0065f34c : CALL 0x00648d67
0065f351 : POP ECX
0065f352 : CALL 0x0063ab82
0065f357 : PUSH 0x16
0065f359 : POP ESI
0065f35a : MOV dword ptr [EAX],ESI
0065f35c : MOV EAX,ESI
0065f35e : JMP 0x0065f4c7
0065f363 : CMP EAX,0xfeff
0065f368 : JNZ 0x0065f386
0065f36a : PUSH EBX
0065f36b : PUSH 0x2
0065f36d : PUSH dword ptr [ESI]
0065f36f : CALL 0x006504d5
0065f374 : ADD ESP,0xc
0065f377 : CMP EAX,-0x1
0065f37a : JZ 0x0065f140
0065f380 : MOV byte ptr [EBP + -0x2],0x2
0065f384 : JMP 0x0065f3c7
0065f386 : PUSH EBX
0065f387 : PUSH EBX
0065f388 : PUSH dword ptr [ESI]
0065f38a : CALL 0x006504d5
0065f38f : ADD ESP,0xc
0065f392 : JMP 0x0065f32d
0065f394 : MOV dword ptr [EBP + -0x18],0xbfbbef
0065f39b : MOV dword ptr [EBP + -0x14],0x3
0065f3a2 : MOV EAX,dword ptr [EBP + -0x14]
0065f3a5 : SUB EAX,EDI
0065f3a7 : PUSH EAX
0065f3a8 : LEA EAX,[EBP + EDI*0x1 + -0x18]
0065f3ac : PUSH EAX
0065f3ad : PUSH dword ptr [ESI]
0065f3af : CALL 0x00650d59
0065f3b4 : ADD ESP,0xc
0065f3b7 : CMP EAX,-0x1
0065f3ba : JZ 0x0065f140
0065f3c0 : ADD EDI,EAX
0065f3c2 : CMP dword ptr [EBP + -0x14],EDI
0065f3c5 : JG 0x0065f3a2
0065f3c7 : MOV EAX,dword ptr [ESI]
0065f3c9 : MOV ECX,EAX
0065f3cb : SAR ECX,0x5
0065f3ce : MOV ECX,dword ptr [ECX*0x4 + 0x1728c40]
0065f3d5 : AND EAX,0x1f
0065f3d8 : SHL EAX,0x6
0065f3db : LEA EAX,[ECX + EAX*0x1 + 0x24]
0065f3df : MOV CL,byte ptr [EAX]
0065f3e1 : XOR CL,byte ptr [EBP + -0x2]
0065f3e4 : AND CL,0x7f
0065f3e7 : XOR byte ptr [EAX],CL
0065f3e9 : MOV EAX,dword ptr [ESI]
0065f3eb : MOV ECX,EAX
0065f3ed : SAR ECX,0x5
0065f3f0 : MOV ECX,dword ptr [ECX*0x4 + 0x1728c40]
0065f3f7 : AND EAX,0x1f
0065f3fa : SHL EAX,0x6
0065f3fd : LEA EAX,[ECX + EAX*0x1 + 0x24]
0065f401 : MOV ECX,dword ptr [EBP + 0x10]
0065f404 : MOV DL,byte ptr [EAX]
0065f406 : SHR ECX,0x10
0065f409 : SHL CL,0x7
0065f40c : AND DL,0x7f
0065f40f : OR CL,DL
0065f411 : MOV byte ptr [EAX],CL
0065f413 : CMP byte ptr [EBP + -0x3],BL
0065f416 : JNZ 0x0065f439
0065f418 : TEST byte ptr [EBP + 0x10],0x8
0065f41c : JZ 0x0065f439
0065f41e : MOV EAX,dword ptr [ESI]
0065f420 : MOV ECX,EAX
0065f422 : AND EAX,0x1f
0065f425 : SAR ECX,0x5
0065f428 : MOV ECX,dword ptr [ECX*0x4 + 0x1728c40]
0065f42f : SHL EAX,0x6
0065f432 : LEA EAX,[ECX + EAX*0x1 + 0x4]
0065f436 : OR byte ptr [EAX],0x20
0065f439 : MOV EDI,dword ptr [EBP + -0x8]
0065f43c : MOV EAX,0xc0000000
0065f441 : MOV ECX,EDI
0065f443 : AND ECX,EAX
0065f445 : CMP ECX,EAX
0065f447 : JNZ 0x0065f4c5
0065f449 : TEST byte ptr [EBP + 0x10],0x1
0065f44d : JZ 0x0065f4c5
0065f44f : PUSH dword ptr [EBP + -0x1c]
0065f452 : CALL dword ptr [0x00b85104]
0065f458 : PUSH EBX
0065f459 : PUSH dword ptr [EBP + -0xc]
0065f45c : LEA EAX,[EBP + -0x30]
0065f45f : PUSH 0x3
0065f461 : PUSH EAX
0065f462 : PUSH dword ptr [EBP + -0x10]
0065f465 : AND EDI,0x7fffffff
0065f46b : PUSH EDI
0065f46c : PUSH dword ptr [EBP + 0xc]
0065f46f : CALL dword ptr [0x00b85318]
0065f475 : CMP EAX,-0x1
0065f478 : JNZ 0x0065f4ae
0065f47a : CALL dword ptr [0x00b85128]
0065f480 : PUSH EAX
0065f481 : CALL 0x0063aba8
0065f486 : MOV EAX,dword ptr [ESI]
0065f488 : MOV ECX,EAX
0065f48a : AND EAX,0x1f
0065f48d : SAR ECX,0x5
0065f490 : MOV ECX,dword ptr [ECX*0x4 + 0x1728c40]
0065f497 : SHL EAX,0x6
0065f49a : LEA EAX,[ECX + EAX*0x1 + 0x4]
0065f49e : AND byte ptr [EAX],0xfe
0065f4a1 : PUSH dword ptr [ESI]
0065f4a3 : CALL 0x0065cb85
0065f4a8 : POP ECX
0065f4a9 : JMP 0x0065f046
0065f4ae : MOV ESI,dword ptr [ESI]
0065f4b0 : MOV ECX,ESI
0065f4b2 : SAR ECX,0x5
0065f4b5 : MOV ECX,dword ptr [ECX*0x4 + 0x1728c40]
0065f4bc : AND ESI,0x1f
0065f4bf : SHL ESI,0x6
0065f4c2 : MOV dword ptr [ESI + ECX*0x1],EAX
0065f4c5 : MOV EAX,EBX
0065f4c7 : POP EDI
0065f4c8 : POP ESI
0065f4c9 : POP EBX
0065f4ca : LEAVE
0065f4cb : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00595930
ENTRY    : 00595930
BODY     : [[00595930, 00595ad9]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00595930(void)

{
  int *piVar1;
  int *piVar2;
  char cVar3;
  int *in_ECX;
  int iVar4;
  undefined4 *puVar5;
  
  *in_ECX = (int)&PTR_FUN_00b8e9d8;
  in_ECX[3] = (int)&PTR_LAB_00b8e9cc;
  in_ECX[0x1a] = (int)&PTR_LAB_00b8e978;
  if (in_ECX[0x6d] != 0) {
    cVar3 = FUN_004fff70();
    if (cVar3 == '\0') {
      if (in_ECX[0x6d] == 0) goto LAB_00595996;
      FUN_0058b4b0(0);
    }
    if (((in_ECX[0x6d] != 0) && (cVar3 = (**(code **)(*in_ECX + 0xa0))(), cVar3 != '\0')) &&
       (in_ECX[0x6d] != 0)) {
      FUN_0058b4b0(0);
    }
  }
LAB_00595996:
  if (in_ECX[0x69] != 0) {
    piVar1 = (int *)(in_ECX[0x69] + 8);
    *piVar1 = *piVar1 + -1;
    piVar1 = (int *)in_ECX[0x69];
    if (piVar1[2] == 0) {
      *(int *)(*piVar1 + 4) = piVar1[1];
      *(int *)piVar1[1] = *piVar1;
      iVar4 = in_ECX[0x69];
      if (iVar4 != 0) {
        if (*(GRefCountNTSImpl **)(iVar4 + 0x1c) != (GRefCountNTSImpl *)0x0) {
          GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar4 + 0x1c));
        }
        FUN_00515cf0(iVar4);
      }
    }
  }
  iVar4 = in_ECX[0x6b];
  if (iVar4 != 0) {
    FUN_00590720();
    FUN_00515cf0(iVar4);
  }
  FUN_005ed030();
  *(uint *)(in_ECX[0x28] + 0xb00) = *(uint *)(in_ECX[0x28] + 0xb00) | 0x400;
  FUN_00515cf0(in_ECX[0x29]);
  piVar1 = (int *)in_ECX[0x70];
  if (piVar1 != (int *)0x0) {
    piVar2 = (int *)(*piVar1 + 8);
    *piVar2 = *piVar2 + -1;
    if (*piVar2 == 0) {
      FUN_00525340();
    }
    FUN_00515cf0(piVar1);
  }
  piVar1 = (int *)in_ECX[0x6e];
  if ((piVar1 != (int *)0x0) && (*piVar1 = *piVar1 + -1, *piVar1 < 1)) {
    FUN_0051d070();
    FUN_00515cf0(piVar1);
  }
  if ((GRefCountNTSImpl *)in_ECX[0x6c] != (GRefCountNTSImpl *)0x0) {
    GRefCountNTSImpl::Release((GRefCountNTSImpl *)in_ECX[0x6c]);
  }
  if (in_ECX[0x6a] != 0) {
    FUN_00503db0();
  }
  FUN_00595450();
  FUN_00515cf0(in_ECX[0x30]);
  iVar4 = in_ECX[0x2b];
  puVar5 = (undefined4 *)(in_ECX[0x2a] + -4 + iVar4 * 4);
  for (; iVar4 != 0; iVar4 = iVar4 + -1) {
    if ((GRefCountNTSImpl *)*puVar5 != (GRefCountNTSImpl *)0x0) {
      GRefCountNTSImpl::Release((GRefCountNTSImpl *)*puVar5);
    }
    puVar5 = puVar5 + -1;
  }
  FUN_00515cf0(in_ECX[0x2a]);
  if (in_ECX[0x27] != 0) {
    FUN_00524240();
  }
  FUN_00522630();
  return;
}



============================================================
DISASSEMBLY
============================================================
00595930 : PUSH ESI
00595931 : MOV ESI,ECX
00595933 : CMP dword ptr [ESI + 0x1b4],0x0
0059593a : MOV dword ptr [ESI],0xb8e9d8
00595940 : MOV dword ptr [ESI + 0xc],0xb8e9cc
00595947 : MOV dword ptr [ESI + 0x68],0xb8e978
0059594e : JZ 0x00595996
00595950 : CALL dword ptr [0x00b8ea78]
00595956 : TEST AL,AL
00595958 : JNZ 0x0059596c
0059595a : CMP dword ptr [ESI + 0x1b4],0x0
00595961 : JZ 0x00595996
00595963 : PUSH 0x0
00595965 : MOV ECX,ESI
00595967 : CALL 0x0058b4b0
0059596c : CMP dword ptr [ESI + 0x1b4],0x0
00595973 : JZ 0x00595996
00595975 : MOV EAX,dword ptr [ESI]
00595977 : MOV EDX,dword ptr [EAX + 0xa0]
0059597d : MOV ECX,ESI
0059597f : CALL EDX
00595981 : TEST AL,AL
00595983 : JZ 0x00595996
00595985 : MOV ECX,dword ptr [ESI + 0x1b4]
0059598b : TEST ECX,ECX
0059598d : JZ 0x00595996
0059598f : PUSH 0x0
00595991 : CALL 0x0058b4b0
00595996 : MOV EAX,dword ptr [ESI + 0x1a4]
0059599c : PUSH EBX
0059599d : PUSH EBP
0059599e : OR EBX,0xffffffff
005959a1 : PUSH EDI
005959a2 : TEST EAX,EAX
005959a4 : JZ 0x005959e0
005959a6 : ADD dword ptr [EAX + 0x8],EBX
005959a9 : MOV EAX,dword ptr [ESI + 0x1a4]
005959af : CMP dword ptr [EAX + 0x8],0x0
005959b3 : JNZ 0x005959e0
005959b5 : MOV ECX,dword ptr [EAX]
005959b7 : MOV EDX,dword ptr [EAX + 0x4]
005959ba : MOV dword ptr [ECX + 0x4],EDX
005959bd : MOV ECX,dword ptr [EAX + 0x4]
005959c0 : MOV EDX,dword ptr [EAX]
005959c2 : MOV dword ptr [ECX],EDX
005959c4 : MOV EDI,dword ptr [ESI + 0x1a4]
005959ca : TEST EDI,EDI
005959cc : JZ 0x005959e0
005959ce : MOV ECX,dword ptr [EDI + 0x1c]
005959d1 : TEST ECX,ECX
005959d3 : JZ 0x005959da
005959d5 : CALL 0x004ff7c0
005959da : PUSH EDI
005959db : CALL 0x00515cf0
005959e0 : MOV EDI,dword ptr [ESI + 0x1ac]
005959e6 : TEST EDI,EDI
005959e8 : JZ 0x005959f7
005959ea : MOV ECX,EDI
005959ec : CALL 0x00590720
005959f1 : PUSH EDI
005959f2 : CALL 0x00515cf0
005959f7 : LEA EBP,[ESI + 0xa8]
005959fd : MOV ECX,EBP
005959ff : CALL 0x005ed030
00595a04 : MOV EAX,dword ptr [ESI + 0xa0]
00595a0a : OR dword ptr [EAX + 0xb00],0x400
00595a14 : ADD EAX,0xb00
00595a19 : MOV EAX,dword ptr [ESI + 0xa4]
00595a1f : PUSH EAX
00595a20 : CALL 0x00515cf0
00595a25 : MOV EDI,dword ptr [ESI + 0x1c0]
00595a2b : TEST EDI,EDI
00595a2d : JZ 0x00595a41
00595a2f : MOV ECX,dword ptr [EDI]
00595a31 : ADD dword ptr [ECX + 0x8],EBX
00595a34 : JNZ 0x00595a3b
00595a36 : CALL 0x00525340
00595a3b : PUSH EDI
00595a3c : CALL 0x00515cf0
00595a41 : MOV EDI,dword ptr [ESI + 0x1b8]
00595a47 : TEST EDI,EDI
00595a49 : JZ 0x00595a5f
00595a4b : ADD dword ptr [EDI],EBX
00595a4d : CMP dword ptr [EDI],0x0
00595a50 : JG 0x00595a5f
00595a52 : MOV ECX,EDI
00595a54 : CALL 0x0051d070
00595a59 : PUSH EDI
00595a5a : CALL 0x00515cf0
00595a5f : MOV ECX,dword ptr [ESI + 0x1b0]
00595a65 : TEST ECX,ECX
00595a67 : JZ 0x00595a6e
00595a69 : CALL 0x004ff7c0
00595a6e : MOV ECX,dword ptr [ESI + 0x1a8]
00595a74 : TEST ECX,ECX
00595a76 : JZ 0x00595a7d
00595a78 : CALL 0x00503db0
00595a7d : LEA ECX,[ESI + 0xcc]
00595a83 : CALL 0x00595450
00595a88 : MOV ECX,dword ptr [ESI + 0xc0]
00595a8e : PUSH ECX
00595a8f : CALL 0x00515cf0
00595a94 : MOV EAX,dword ptr [EBP + 0x4]
00595a97 : MOV EDX,dword ptr [EBP]
00595a9a : LEA EDI,[EDX + EAX*0x4 + -0x4]
00595a9e : TEST EAX,EAX
00595aa0 : JBE 0x00595ab7
00595aa2 : MOV EBX,EAX
00595aa4 : MOV ECX,dword ptr [EDI]
00595aa6 : TEST ECX,ECX
00595aa8 : JZ 0x00595aaf
00595aaa : CALL 0x004ff7c0
00595aaf : SUB EDI,0x4
00595ab2 : SUB EBX,0x1
00595ab5 : JNZ 0x00595aa4
00595ab7 : MOV EAX,dword ptr [EBP]
00595aba : PUSH EAX
00595abb : CALL 0x00515cf0
00595ac0 : MOV ECX,dword ptr [ESI + 0x9c]
00595ac6 : POP EDI
00595ac7 : POP EBP
00595ac8 : POP EBX
00595ac9 : TEST ECX,ECX
00595acb : JZ 0x00595ad2
00595acd : CALL 0x00524240
00595ad2 : MOV ECX,ESI
00595ad4 : POP ESI
00595ad5 : JMP 0x00522630

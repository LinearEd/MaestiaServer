PROGRAM  : Maestia.exe
FUNCTION : FUN_0070a9a0
ENTRY    : 0070a9a0
BODY     : [[0070a9a0, 0070aa01]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_0070a9a0(int param_1,int param_2)

{
  wchar_t *_Filename;
  int in_ECX;
  wchar_t *_Mode;
  
  if (*(FILE **)(in_ECX + 0x10) != (FILE *)0x0) {
    _fclose(*(FILE **)(in_ECX + 0x10));
  }
  if (*(uint *)(param_2 + 0x18) < 8) {
    _Mode = (wchar_t *)(param_2 + 4);
  }
  else {
    _Mode = *(wchar_t **)(param_2 + 4);
  }
  if (*(uint *)(param_1 + 0x18) < 8) {
    _Filename = (wchar_t *)(param_1 + 4);
  }
  else {
    _Filename = *(wchar_t **)(param_1 + 4);
  }
  __wfopen_s((FILE **)(in_ECX + 0x10),_Filename,_Mode);
  if (*(FILE **)(in_ECX + 0x10) == (FILE *)0x0) {
    return 0;
  }
  *(undefined1 *)(in_ECX + 4) = 1;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
0070a9a0 : PUSH EBP
0070a9a1 : MOV EBP,ESP
0070a9a3 : PUSH ESI
0070a9a4 : PUSH EDI
0070a9a5 : MOV EDI,ECX
0070a9a7 : MOV EAX,dword ptr [EDI + 0x10]
0070a9aa : LEA ESI,[EDI + 0x10]
0070a9ad : TEST EAX,EAX
0070a9af : JZ 0x0070a9ba
0070a9b1 : PUSH EAX
0070a9b2 : CALL 0x006366db
0070a9b7 : ADD ESP,0x4
0070a9ba : MOV EAX,dword ptr [EBP + 0xc]
0070a9bd : MOV EDX,0x8
0070a9c2 : CMP dword ptr [EAX + 0x18],EDX
0070a9c5 : JC 0x0070a9cc
0070a9c7 : MOV ECX,dword ptr [EAX + 0x4]
0070a9ca : JMP 0x0070a9cf
0070a9cc : LEA ECX,[EAX + 0x4]
0070a9cf : MOV EAX,dword ptr [EBP + 0x8]
0070a9d2 : CMP dword ptr [EAX + 0x18],EDX
0070a9d5 : JC 0x0070a9dc
0070a9d7 : MOV EAX,dword ptr [EAX + 0x4]
0070a9da : JMP 0x0070a9df
0070a9dc : ADD EAX,0x4
0070a9df : PUSH ECX
0070a9e0 : PUSH EAX
0070a9e1 : PUSH ESI
0070a9e2 : CALL 0x0063641b
0070a9e7 : ADD ESP,0xc
0070a9ea : CMP dword ptr [ESI],0x0
0070a9ed : JNZ 0x0070a9f7
0070a9ef : POP EDI
0070a9f0 : XOR AL,AL
0070a9f2 : POP ESI
0070a9f3 : POP EBP
0070a9f4 : RET 0x8
0070a9f7 : MOV AL,0x1
0070a9f9 : MOV byte ptr [EDI + 0x4],AL
0070a9fc : POP EDI
0070a9fd : POP ESI
0070a9fe : POP EBP
0070a9ff : RET 0x8

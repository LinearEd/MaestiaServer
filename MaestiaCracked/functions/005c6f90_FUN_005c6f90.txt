PROGRAM  : Maestia.exe
FUNCTION : FUN_005c6f90
ENTRY    : 005c6f90
BODY     : [[005c6f90, 005c7174]]

============================================================
DECOMPILED C CODE
============================================================

undefined4
FUN_005c6f90(undefined4 param_1,undefined4 *param_2,undefined4 param_3,undefined4 param_4)

{
  byte bVar1;
  byte *pbVar2;
  int iVar3;
  GRefCountNTSImpl *pGVar4;
  int iVar5;
  byte *pbVar6;
  undefined4 uVar7;
  int in_ECX;
  char *pcVar8;
  bool bVar9;
  undefined1 auStack_18 [8];
  float fStack_10;
  float fStack_4;
  
  pbVar6 = *(byte **)*param_2;
  pcVar8 = "pixelBounds";
  pbVar2 = pbVar6;
  do {
    bVar1 = *pbVar2;
    bVar9 = bVar1 < (byte)*pcVar8;
    if (bVar1 != *pcVar8) {
LAB_005c6fc5:
      iVar3 = (1 - (uint)bVar9) - (uint)(bVar9 != 0);
      goto LAB_005c6fca;
    }
    if (bVar1 == 0) break;
    bVar1 = pbVar2[1];
    bVar9 = bVar1 < ((byte *)pcVar8)[1];
    if (bVar1 != ((byte *)pcVar8)[1]) goto LAB_005c6fc5;
    pbVar2 = pbVar2 + 2;
    pcVar8 = (char *)((byte *)pcVar8 + 2);
  } while (bVar1 != 0);
  iVar3 = 0;
LAB_005c6fca:
  if (iVar3 != 0) {
    pcVar8 = "colorTransform";
    pbVar2 = pbVar6;
    do {
      bVar1 = *pbVar2;
      bVar9 = bVar1 < (byte)*pcVar8;
      if (bVar1 != *pcVar8) {
LAB_005c7000:
        iVar3 = (1 - (uint)bVar9) - (uint)(bVar9 != 0);
        goto LAB_005c7005;
      }
      if (bVar1 == 0) break;
      bVar1 = pbVar2[1];
      bVar9 = bVar1 < ((byte *)pcVar8)[1];
      if (bVar1 != ((byte *)pcVar8)[1]) goto LAB_005c7000;
      pbVar2 = pbVar2 + 2;
      pcVar8 = (char *)((byte *)pcVar8 + 2);
    } while (bVar1 != 0);
    iVar3 = 0;
LAB_005c7005:
    if (iVar3 != 0) {
      pcVar8 = "matrix";
      do {
        bVar1 = *pbVar6;
        bVar9 = bVar1 < (byte)*pcVar8;
        if (bVar1 != *pcVar8) {
LAB_005c70b0:
          iVar3 = (1 - (uint)bVar9) - (uint)(bVar9 != 0);
          goto LAB_005c70b5;
        }
        if (bVar1 == 0) break;
        bVar1 = pbVar6[1];
        bVar9 = bVar1 < ((byte *)pcVar8)[1];
        if (bVar1 != ((byte *)pcVar8)[1]) goto LAB_005c70b0;
        pbVar6 = pbVar6 + 2;
        pcVar8 = (char *)((byte *)pcVar8 + 2);
      } while (bVar1 != 0);
      iVar3 = 0;
LAB_005c70b5:
      if (iVar3 == 0) {
        if (*(int *)(in_ECX + 0x20) != 0) {
          pGVar4 = (GRefCountNTSImpl *)FUN_0051d0a0(*(int *)(in_ECX + 0x20));
          if (pGVar4 != (GRefCountNTSImpl *)0x0) {
            *(int *)(pGVar4 + 4) = *(int *)(pGVar4 + 4) + 1;
            iVar3 = FUN_00526fa0(param_1);
            if (iVar3 != 0) {
              *(uint *)(iVar3 + 8) = *(int *)(iVar3 + 8) + 1U & 0x8fffffff;
              iVar3 = (**(code **)(*(int *)(iVar3 + 0x10) + 8))();
              if (iVar3 == 0xf) {
                FUN_005c7cd0(auStack_18,param_1);
                fStack_10 = fStack_10 * 20.0;
                fStack_4 = fStack_4 * 20.0;
                FUN_0051cca0(auStack_18);
              }
              FUN_00503db0();
            }
            GRefCountNTSImpl::Release(pGVar4);
          }
        }
        return 1;
      }
      uVar7 = FUN_005520e0(param_1,param_2,param_3,param_4);
      return uVar7;
    }
    if (*(int *)(in_ECX + 0x20) != 0) {
      pGVar4 = (GRefCountNTSImpl *)FUN_0051d0a0(*(int *)(in_ECX + 0x20));
      if (pGVar4 != (GRefCountNTSImpl *)0x0) {
        *(int *)(pGVar4 + 4) = *(int *)(pGVar4 + 4) + 1;
        iVar3 = FUN_00526fa0(param_1);
        if (iVar3 != 0) {
          *(uint *)(iVar3 + 8) = *(int *)(iVar3 + 8) + 1U & 0x8fffffff;
          iVar5 = (**(code **)(*(int *)(iVar3 + 0x10) + 8))();
          if (iVar5 == 0x12) {
            FUN_0051ccd0(iVar3 + 0x30);
            (**(code **)(*(int *)pGVar4 + 0x14))(0);
          }
          FUN_00503db0();
        }
        GRefCountNTSImpl::Release(pGVar4);
      }
    }
  }
  return 1;
}



============================================================
DISASSEMBLY
============================================================
005c6f90 : SUB ESP,0x18
005c6f93 : PUSH EBX
005c6f94 : PUSH ESI
005c6f95 : PUSH EDI
005c6f96 : MOV EDI,dword ptr [ESP + 0x2c]
005c6f9a : MOV EAX,dword ptr [EDI]
005c6f9c : MOV ESI,dword ptr [EAX]
005c6f9e : MOV EDX,0xb91f10
005c6fa3 : MOV EAX,ESI
005c6fa5 : MOV BL,byte ptr [EAX]
005c6fa7 : CMP BL,byte ptr [EDX]
005c6fa9 : JNZ 0x005c6fc5
005c6fab : TEST BL,BL
005c6fad : JZ 0x005c6fc1
005c6faf : MOV BL,byte ptr [EAX + 0x1]
005c6fb2 : CMP BL,byte ptr [EDX + 0x1]
005c6fb5 : JNZ 0x005c6fc5
005c6fb7 : ADD EAX,0x2
005c6fba : ADD EDX,0x2
005c6fbd : TEST BL,BL
005c6fbf : JNZ 0x005c6fa5
005c6fc1 : XOR EAX,EAX
005c6fc3 : JMP 0x005c6fca
005c6fc5 : SBB EAX,EAX
005c6fc7 : SBB EAX,-0x1
005c6fca : TEST EAX,EAX
005c6fcc : JZ 0x005c7077
005c6fd2 : MOV EDX,0xb91f00
005c6fd7 : MOV EAX,ESI
005c6fd9 : LEA ESP,[ESP]
005c6fe0 : MOV BL,byte ptr [EAX]
005c6fe2 : CMP BL,byte ptr [EDX]
005c6fe4 : JNZ 0x005c7000
005c6fe6 : TEST BL,BL
005c6fe8 : JZ 0x005c6ffc
005c6fea : MOV BL,byte ptr [EAX + 0x1]
005c6fed : CMP BL,byte ptr [EDX + 0x1]
005c6ff0 : JNZ 0x005c7000
005c6ff2 : ADD EAX,0x2
005c6ff5 : ADD EDX,0x2
005c6ff8 : TEST BL,BL
005c6ffa : JNZ 0x005c6fe0
005c6ffc : XOR EAX,EAX
005c6ffe : JMP 0x005c7005
005c7000 : SBB EAX,EAX
005c7002 : SBB EAX,-0x1
005c7005 : TEST EAX,EAX
005c7007 : JNZ 0x005c7082
005c7009 : MOV EAX,dword ptr [ECX + 0x20]
005c700c : TEST EAX,EAX
005c700e : JZ 0x005c7077
005c7010 : MOV ECX,dword ptr [ECX + 0x24]
005c7013 : PUSH EAX
005c7014 : CALL 0x0051d0a0
005c7019 : MOV ESI,EAX
005c701b : TEST ESI,ESI
005c701d : JZ 0x005c7077
005c701f : MOV ECX,dword ptr [ESP + 0x28]
005c7023 : INC dword ptr [ESI + 0x4]
005c7026 : PUSH ECX
005c7027 : MOV ECX,dword ptr [ESP + 0x34]
005c702b : CALL 0x00526fa0
005c7030 : MOV EDI,EAX
005c7032 : TEST EDI,EDI
005c7034 : JZ 0x005c7070
005c7036 : MOV EDX,dword ptr [EDI + 0x8]
005c7039 : INC EDX
005c703a : AND EDX,0x8fffffff
005c7040 : MOV dword ptr [EDI + 0x8],EDX
005c7043 : MOV EAX,dword ptr [EDI + 0x10]
005c7046 : MOV EDX,dword ptr [EAX + 0x8]
005c7049 : LEA ECX,[EDI + 0x10]
005c704c : CALL EDX
005c704e : CMP EAX,0x12
005c7051 : JNZ 0x005c7069
005c7053 : LEA EAX,[EDI + 0x30]
005c7056 : PUSH EAX
005c7057 : MOV ECX,ESI
005c7059 : CALL 0x0051ccd0
005c705e : MOV EDX,dword ptr [ESI]
005c7060 : MOV EAX,dword ptr [EDX + 0x14]
005c7063 : PUSH 0x0
005c7065 : MOV ECX,ESI
005c7067 : CALL EAX
005c7069 : MOV ECX,EDI
005c706b : CALL 0x00503db0
005c7070 : MOV ECX,ESI
005c7072 : CALL 0x004ff7c0
005c7077 : POP EDI
005c7078 : POP ESI
005c7079 : MOV AL,0x1
005c707b : POP EBX
005c707c : ADD ESP,0x18
005c707f : RET 0x10
005c7082 : MOV EDX,0xb91ef8
005c7087 : MOV EAX,ESI
005c7089 : LEA ESP,[ESP]
005c7090 : MOV BL,byte ptr [EAX]
005c7092 : CMP BL,byte ptr [EDX]
005c7094 : JNZ 0x005c70b0
005c7096 : TEST BL,BL
005c7098 : JZ 0x005c70ac
005c709a : MOV BL,byte ptr [EAX + 0x1]
005c709d : CMP BL,byte ptr [EDX + 0x1]
005c70a0 : JNZ 0x005c70b0
005c70a2 : ADD EAX,0x2
005c70a5 : ADD EDX,0x2
005c70a8 : TEST BL,BL
005c70aa : JNZ 0x005c7090
005c70ac : XOR EAX,EAX
005c70ae : JMP 0x005c70b5
005c70b0 : SBB EAX,EAX
005c70b2 : SBB EAX,-0x1
005c70b5 : TEST EAX,EAX
005c70b7 : JNZ 0x005c7157
005c70bd : MOV EAX,dword ptr [ECX + 0x20]
005c70c0 : TEST EAX,EAX
005c70c2 : JZ 0x005c714c
005c70c8 : MOV ECX,dword ptr [ECX + 0x24]
005c70cb : PUSH EAX
005c70cc : CALL 0x0051d0a0
005c70d1 : MOV EDI,EAX
005c70d3 : TEST EDI,EDI
005c70d5 : JZ 0x005c714c
005c70d7 : MOV EBX,dword ptr [ESP + 0x28]
005c70db : MOV ECX,dword ptr [ESP + 0x30]
005c70df : INC dword ptr [EDI + 0x4]
005c70e2 : PUSH EBX
005c70e3 : CALL 0x00526fa0
005c70e8 : MOV ESI,EAX
005c70ea : TEST ESI,ESI
005c70ec : JZ 0x005c7145
005c70ee : MOV ECX,dword ptr [ESI + 0x8]
005c70f1 : INC ECX
005c70f2 : AND ECX,0x8fffffff
005c70f8 : MOV dword ptr [ESI + 0x8],ECX
005c70fb : MOV EDX,dword ptr [ESI + 0x10]
005c70fe : MOV EAX,dword ptr [EDX + 0x8]
005c7101 : LEA ECX,[ESI + 0x10]
005c7104 : CALL EAX
005c7106 : CMP EAX,0xf
005c7109 : JNZ 0x005c713e
005c710b : PUSH EBX
005c710c : LEA ECX,[ESP + 0x10]
005c7110 : PUSH ECX
005c7111 : MOV ECX,ESI
005c7113 : CALL 0x005c7cd0
005c7118 : FLD float ptr [ESP + 0x14]
005c711c : FLD double ptr [0x00b86058]
005c7122 : LEA EDX,[ESP + 0xc]
005c7126 : FMUL ST1
005c7128 : PUSH EDX
005c7129 : FXCH
005c712b : MOV ECX,EDI
005c712d : FSTP float ptr [ESP + 0x18]
005c7131 : FMUL float ptr [ESP + 0x24]
005c7135 : FSTP float ptr [ESP + 0x24]
005c7139 : CALL 0x0051cca0
005c713e : MOV ECX,ESI
005c7140 : CALL 0x00503db0
005c7145 : MOV ECX,EDI
005c7147 : CALL 0x004ff7c0
005c714c : POP EDI
005c714d : POP ESI
005c714e : MOV AL,0x1
005c7150 : POP EBX
005c7151 : ADD ESP,0x18
005c7154 : RET 0x10
005c7157 : MOV EAX,dword ptr [ESP + 0x34]
005c715b : MOV EDX,dword ptr [ESP + 0x30]
005c715f : PUSH EAX
005c7160 : MOV EAX,dword ptr [ESP + 0x2c]
005c7164 : PUSH EDX
005c7165 : PUSH EDI
005c7166 : PUSH EAX
005c7167 : CALL 0x005520e0
005c716c : POP EDI
005c716d : POP ESI
005c716e : POP EBX
005c716f : ADD ESP,0x18
005c7172 : RET 0x10

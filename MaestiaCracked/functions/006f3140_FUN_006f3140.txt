PROGRAM  : Maestia.exe
FUNCTION : FUN_006f3140
ENTRY    : 006f3140
BODY     : [[006f3140, 006f3275]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006f3140(void)

{
  int iVar1;
  int in_ECX;
  LPCRITICAL_SECTION local_28;
  char *local_24;
  undefined4 local_20;
  int local_1c;
  undefined4 local_18;
  undefined4 local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3026b;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_28 = (LPCRITICAL_SECTION)(in_ECX + 0xf7c);
  local_1c = 0;
  local_24 = ".\\AvSocket.cpp";
  local_20 = 0x142;
  local_18 = 1;
  FUN_006ef1a0(&local_28);
  if (*(int *)(in_ECX + 0xef4) == 0) {
    *(undefined4 *)(in_ECX + 0xef4) = 1;
    local_8 = 0xffffffff;
    if (local_1c != 0) {
      LeaveCriticalSection(local_28);
      local_1c = 0;
    }
    if (*(undefined4 **)(in_ECX + 0x23f8) != (undefined4 *)0x0) {
      (**(code **)**(undefined4 **)(in_ECX + 0x23f8))();
    }
    local_28 = (LPCRITICAL_SECTION)(in_ECX + 0xf60);
    local_14 = 0xff;
    local_1c = 0;
    local_24 = ".\\AvSocket.cpp";
    local_20 = 0x151;
    local_18 = 1;
    FUN_006ef1a0(&local_28);
    local_8 = 1;
    iVar1 = FUN_006f2ca0(&local_14);
    local_8 = 0xffffffff;
    if (local_1c != 0) {
      LeaveCriticalSection(local_28);
      local_1c = 0;
    }
    if (iVar1 == 0) {
      FUN_006f2e90(local_14);
    }
  }
  else {
    local_8 = 0xffffffff;
    if (local_1c != 0) {
      LeaveCriticalSection(local_28);
      ExceptionList = local_10;
      return;
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
006f3140 : PUSH EBP
006f3141 : MOV EBP,ESP
006f3143 : PUSH -0x1
006f3145 : PUSH 0xb3026b
006f314a : MOV EAX,FS:[0x0]
006f3150 : PUSH EAX
006f3151 : SUB ESP,0x18
006f3154 : PUSH EBX
006f3155 : PUSH ESI
006f3156 : PUSH EDI
006f3157 : MOV EAX,[0x00d66fa0]
006f315c : XOR EAX,EBP
006f315e : PUSH EAX
006f315f : LEA EAX,[EBP + -0xc]
006f3162 : MOV FS:[0x0],EAX
006f3168 : MOV ESI,ECX
006f316a : LEA ECX,[EBP + -0x24]
006f316d : LEA EAX,[ESI + 0xf7c]
006f3173 : XOR EDI,EDI
006f3175 : MOV EBX,0x1
006f317a : PUSH ECX
006f317b : MOV dword ptr [EBP + -0x18],EDI
006f317e : MOV dword ptr [EBP + -0x24],EAX
006f3181 : MOV dword ptr [EBP + -0x20],0xbf6644
006f3188 : MOV dword ptr [EBP + -0x1c],0x142
006f318f : MOV dword ptr [EBP + -0x14],EBX
006f3192 : CALL 0x006ef1a0
006f3197 : MOV dword ptr [EBP + -0x4],EDI
006f319a : CMP dword ptr [ESI + 0xef4],EDI
006f31a0 : JZ 0x006f31d1
006f31a2 : MOV dword ptr [EBP + -0x4],0xffffffff
006f31a9 : CMP dword ptr [EBP + -0x18],EDI
006f31ac : JZ 0x006f3264
006f31b2 : MOV EDX,dword ptr [EBP + -0x24]
006f31b5 : PUSH EDX
006f31b6 : CALL dword ptr [0x00b8511c]
006f31bc : MOV dword ptr [EBP + -0x18],EDI
006f31bf : MOV ECX,dword ptr [EBP + -0xc]
006f31c2 : MOV dword ptr FS:[0x0],ECX
006f31c9 : POP ECX
006f31ca : POP EDI
006f31cb : POP ESI
006f31cc : POP EBX
006f31cd : MOV ESP,EBP
006f31cf : POP EBP
006f31d0 : RET
006f31d1 : MOV dword ptr [ESI + 0xef4],EBX
006f31d7 : MOV dword ptr [EBP + -0x4],0xffffffff
006f31de : CMP dword ptr [EBP + -0x18],EDI
006f31e1 : JZ 0x006f31f0
006f31e3 : MOV EAX,dword ptr [EBP + -0x24]
006f31e6 : PUSH EAX
006f31e7 : CALL dword ptr [0x00b8511c]
006f31ed : MOV dword ptr [EBP + -0x18],EDI
006f31f0 : MOV ECX,dword ptr [ESI + 0x23f8]
006f31f6 : CMP ECX,EDI
006f31f8 : JZ 0x006f3201
006f31fa : MOV EDX,dword ptr [ECX]
006f31fc : MOV EAX,dword ptr [EDX]
006f31fe : PUSH ESI
006f31ff : CALL EAX
006f3201 : LEA EDX,[EBP + -0x24]
006f3204 : LEA ECX,[ESI + 0xf60]
006f320a : PUSH EDX
006f320b : MOV dword ptr [EBP + -0x10],0xff
006f3212 : MOV dword ptr [EBP + -0x18],EDI
006f3215 : MOV dword ptr [EBP + -0x24],ECX
006f3218 : MOV dword ptr [EBP + -0x20],0xbf6654
006f321f : MOV dword ptr [EBP + -0x1c],0x151
006f3226 : MOV dword ptr [EBP + -0x14],EBX
006f3229 : CALL 0x006ef1a0
006f322e : MOV dword ptr [EBP + -0x4],EBX
006f3231 : LEA EAX,[EBP + -0x10]
006f3234 : PUSH EAX
006f3235 : MOV ECX,ESI
006f3237 : CALL 0x006f2ca0
006f323c : MOV EBX,EAX
006f323e : MOV dword ptr [EBP + -0x4],0xffffffff
006f3245 : CMP dword ptr [EBP + -0x18],EDI
006f3248 : JZ 0x006f3257
006f324a : MOV ECX,dword ptr [EBP + -0x24]
006f324d : PUSH ECX
006f324e : CALL dword ptr [0x00b8511c]
006f3254 : MOV dword ptr [EBP + -0x18],EDI
006f3257 : CMP EBX,EDI
006f3259 : JNZ 0x006f3264
006f325b : MOV EDX,dword ptr [EBP + -0x10]
006f325e : PUSH EDX
006f325f : CALL 0x006f2e90
006f3264 : MOV ECX,dword ptr [EBP + -0xc]
006f3267 : MOV dword ptr FS:[0x0],ECX
006f326e : POP ECX
006f326f : POP EDI
006f3270 : POP ESI
006f3271 : POP EBX
006f3272 : MOV ESP,EBP
006f3274 : POP EBP
006f3275 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00527d10
ENTRY    : 00527d10
BODY     : [[00527d10, 00527fd6]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00527d10(undefined4 param_1,int param_2)

{
  int iVar1;
  ushort uVar2;
  byte bVar3;
  char cVar4;
  undefined4 uVar5;
  int iVar6;
  int *piVar7;
  char *in_ECX;
  int *local_54;
  int local_50;
  byte local_4c;
  byte local_44 [16];
  byte abStack_34 [16];
  undefined1 auStack_24 [36];
  
  iVar1 = param_2;
  cVar4 = *in_ECX;
  if (((cVar4 != '\x06') && (cVar4 != '\a')) && (cVar4 != '\b')) {
    if (cVar4 == '\v') {
      FUN_00526e40(&local_54,param_2);
      if (local_54 != (int *)0x0) {
        FUN_00526210(&local_54);
        if (((local_4c & 2) == 0) && (local_54 != (int *)0x0)) {
          FUN_00503db0();
        }
        local_54 = (int *)0x0;
        if (((local_4c & 1) == 0) && (local_50 != 0)) {
          FUN_00503db0();
        }
        return param_1;
      }
      local_54 = (int *)0x0;
      if (((local_4c & 1) == 0) && (local_50 != 0)) {
        FUN_00503db0();
      }
    }
    FUN_005266c0(in_ECX);
    return param_1;
  }
  local_44[0] = 0;
  if (cVar4 == '\a') {
    if ((param_2 != 0) && (*(int *)(in_ECX + 4) != 0)) {
      uVar5 = FUN_005296a0();
      iVar6 = FUN_0051d0a0(uVar5);
      if (iVar6 != 0) {
        piVar7 = (int *)(iVar6 + 0x68);
        goto LAB_00527e04;
      }
    }
  }
  else {
    iVar6 = FUN_00526fa0(param_2);
    if (iVar6 != 0) {
      piVar7 = (int *)(iVar6 + 0x10);
      goto LAB_00527e04;
    }
  }
  piVar7 = (int *)0x0;
LAB_00527e04:
  if (((iVar1 == 0) || (piVar7 == (int *)0x0)) ||
     (cVar4 = (**(code **)(*piVar7 + 0x2c))(iVar1 + 0x78,*(int *)(iVar1 + 0x78) + 0x158,local_44),
     cVar4 == '\0')) {
    if ((*in_ECX == '\a') && (*(int *)(in_ECX + 4) != 0)) {
      piVar7 = (int *)FUN_00525fd0(iVar1);
      local_50 = *piVar7;
      *(int *)(local_50 + 8) = *(int *)(local_50 + 8) + 1;
      local_54 = (int *)CONCAT31(local_54._1_3_,5);
    }
    else {
      if ((*in_ECX == '\x06') &&
         ((*(int *)(in_ECX + 4) != 0 &&
          (iVar6 = (**(code **)(*(int *)(*(int *)(in_ECX + 4) + 0x10) + 4))(iVar1), iVar6 != 0)))) {
        local_50 = FUN_00525530(iVar6);
        *(int *)(local_50 + 8) = *(int *)(local_50 + 8) + 1;
        *(int *)(local_50 + 8) = *(int *)(local_50 + 8) + 1;
        piVar7 = (int *)(local_50 + 8);
        *piVar7 = *piVar7 + -1;
        iVar1 = *piVar7;
      }
      else {
        FUN_005272e0(&param_2,iVar1,0xffffffff,0);
        *(int *)(param_2 + 8) = *(int *)(param_2 + 8) + 1;
        piVar7 = (int *)(param_2 + 8);
        *piVar7 = *piVar7 + -1;
        iVar1 = *piVar7;
        local_50 = param_2;
      }
      local_54 = (int *)CONCAT31(local_54._1_3_,5);
      if (iVar1 == 0) {
        FUN_00525340();
      }
    }
    FUN_005266c0(&local_54);
    bVar3 = (byte)local_54;
  }
  else {
    uVar2 = *(ushort *)(iVar1 + 0xc4);
    abStack_34[0] = 0;
    *(ushort *)(iVar1 + 0xc4) = uVar2 + 1;
    if (uVar2 < 0xff) {
      FUN_00527140(&local_54,iVar1);
      if (local_54 != (int *)0x0) {
        FUN_0051fae0(abStack_34,piVar7,iVar1,0,0);
        (**(code **)(*local_54 + 0x28))(auStack_24,local_50,0);
        FUN_0051fbd0();
      }
      if (((local_4c & 2) == 0) && (local_54 != (int *)0x0)) {
        FUN_00503db0();
      }
      local_54 = (int *)0x0;
      if (((local_4c & 1) == 0) && (local_50 != 0)) {
        FUN_00503db0();
      }
    }
    *(short *)(iVar1 + 0xc4) = *(short *)(iVar1 + 0xc4) + -1;
    FUN_005266c0(abStack_34);
    bVar3 = abStack_34[0];
  }
  if (4 < bVar3) {
    FUN_00526400();
  }
  if (4 < local_44[0]) {
    FUN_00526400();
  }
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
00527d10 : SUB ESP,0x54
00527d13 : PUSH ESI
00527d14 : PUSH EDI
00527d15 : MOV EDI,ECX
00527d17 : MOV AL,byte ptr [EDI]
00527d19 : CMP AL,0x6
00527d1b : JZ 0x00527dc2
00527d21 : CMP AL,0x7
00527d23 : JZ 0x00527dc2
00527d29 : CMP AL,0x8
00527d2b : JZ 0x00527dc2
00527d31 : CMP AL,0xb
00527d33 : JNZ 0x00527dac
00527d35 : MOV EAX,dword ptr [ESP + 0x64]
00527d39 : PUSH EAX
00527d3a : LEA ECX,[ESP + 0xc]
00527d3e : PUSH ECX
00527d3f : MOV ECX,EDI
00527d41 : CALL 0x00526e40
00527d46 : XOR ESI,ESI
00527d48 : CMP dword ptr [ESP + 0x8],ESI
00527d4c : JZ 0x00527d94
00527d4e : MOV EDI,dword ptr [ESP + 0x60]
00527d52 : LEA EDX,[ESP + 0x8]
00527d56 : PUSH EDX
00527d57 : MOV ECX,EDI
00527d59 : CALL 0x00526210
00527d5e : TEST byte ptr [ESP + 0x10],0x2
00527d63 : JNZ 0x00527d72
00527d65 : MOV ECX,dword ptr [ESP + 0x8]
00527d69 : CMP ECX,ESI
00527d6b : JZ 0x00527d72
00527d6d : CALL 0x00503db0
00527d72 : TEST byte ptr [ESP + 0x10],0x1
00527d77 : MOV dword ptr [ESP + 0x8],ESI
00527d7b : JNZ 0x00527d8a
00527d7d : MOV ECX,dword ptr [ESP + 0xc]
00527d81 : CMP ECX,ESI
00527d83 : JZ 0x00527d8a
00527d85 : CALL 0x00503db0
00527d8a : MOV EAX,EDI
00527d8c : POP EDI
00527d8d : POP ESI
00527d8e : ADD ESP,0x54
00527d91 : RET 0xc
00527d94 : TEST byte ptr [ESP + 0x10],0x1
00527d99 : MOV dword ptr [ESP + 0x8],ESI
00527d9d : JNZ 0x00527dac
00527d9f : MOV ECX,dword ptr [ESP + 0xc]
00527da3 : CMP ECX,ESI
00527da5 : JZ 0x00527dac
00527da7 : CALL 0x00503db0
00527dac : MOV ESI,dword ptr [ESP + 0x60]
00527db0 : PUSH EDI
00527db1 : MOV ECX,ESI
00527db3 : CALL 0x005266c0
00527db8 : POP EDI
00527db9 : MOV EAX,ESI
00527dbb : POP ESI
00527dbc : ADD ESP,0x54
00527dbf : RET 0xc
00527dc2 : MOV ESI,dword ptr [ESP + 0x64]
00527dc6 : PUSH EBP
00527dc7 : MOV byte ptr [ESP + 0x1c],0x0
00527dcc : CMP AL,0x7
00527dce : JNZ 0x00527df3
00527dd0 : TEST ESI,ESI
00527dd2 : JZ 0x00527e02
00527dd4 : CMP dword ptr [EDI + 0x4],0x0
00527dd8 : JZ 0x00527e02
00527dda : MOV ECX,ESI
00527ddc : CALL 0x005296a0
00527de1 : MOV ECX,dword ptr [EDI + 0x4]
00527de4 : PUSH EAX
00527de5 : CALL 0x0051d0a0
00527dea : TEST EAX,EAX
00527dec : JZ 0x00527e02
00527dee : LEA EBP,[EAX + 0x68]
00527df1 : JMP 0x00527e04
00527df3 : PUSH ESI
00527df4 : CALL 0x00526fa0
00527df9 : TEST EAX,EAX
00527dfb : JZ 0x00527e02
00527dfd : LEA EBP,[EAX + 0x10]
00527e00 : JMP 0x00527e04
00527e02 : XOR EBP,EBP
00527e04 : PUSH EBX
00527e05 : TEST ESI,ESI
00527e07 : JZ 0x00527f00
00527e0d : TEST EBP,EBP
00527e0f : JZ 0x00527f00
00527e15 : MOV ECX,dword ptr [ESI + 0x78]
00527e18 : MOV EDX,dword ptr [EBP]
00527e1b : LEA EAX,[ESI + 0x78]
00527e1e : LEA EBX,[ESP + 0x20]
00527e22 : PUSH EBX
00527e23 : ADD ECX,0x158
00527e29 : PUSH ECX
00527e2a : PUSH EAX
00527e2b : MOV EAX,dword ptr [EDX + 0x2c]
00527e2e : MOV ECX,EBP
00527e30 : CALL EAX
00527e32 : TEST AL,AL
00527e34 : JZ 0x00527f00
00527e3a : MOVZX EAX,word ptr [ESI + 0xc4]
00527e41 : XOR EBX,EBX
00527e43 : MOV ECX,0xff
00527e48 : LEA EDX,[EAX + 0x1]
00527e4b : MOV byte ptr [ESP + 0x30],BL
00527e4f : MOV word ptr [ESI + 0xc4],DX
00527e56 : CMP AX,CX
00527e59 : JNC 0x00527ecf
00527e5b : PUSH ESI
00527e5c : LEA EAX,[ESP + 0x14]
00527e60 : PUSH EAX
00527e61 : LEA ECX,[ESP + 0x28]
00527e65 : CALL 0x00527140
00527e6a : MOV ECX,dword ptr [ESP + 0x10]
00527e6e : CMP ECX,EBX
00527e70 : JZ 0x00527ea7
00527e72 : PUSH EBX
00527e73 : PUSH EBX
00527e74 : PUSH ESI
00527e75 : PUSH EBP
00527e76 : LEA ECX,[ESP + 0x40]
00527e7a : PUSH ECX
00527e7b : LEA ECX,[ESP + 0x54]
00527e7f : CALL 0x0051fae0
00527e84 : MOV EAX,dword ptr [ESP + 0x14]
00527e88 : MOV ECX,dword ptr [ESP + 0x10]
00527e8c : MOV EDX,dword ptr [ECX]
00527e8e : MOV EDX,dword ptr [EDX + 0x28]
00527e91 : PUSH EBX
00527e92 : PUSH EAX
00527e93 : LEA EAX,[ESP + 0x48]
00527e97 : PUSH EAX
00527e98 : CALL EDX
00527e9a : LEA ECX,[ESP + 0x40]
00527e9e : CALL 0x0051fbd0
00527ea3 : MOV ECX,dword ptr [ESP + 0x10]
00527ea7 : TEST byte ptr [ESP + 0x18],0x2
00527eac : JNZ 0x00527eb7
00527eae : CMP ECX,EBX
00527eb0 : JZ 0x00527eb7
00527eb2 : CALL 0x00503db0
00527eb7 : TEST byte ptr [ESP + 0x18],0x1
00527ebc : MOV dword ptr [ESP + 0x10],EBX
00527ec0 : JNZ 0x00527ecf
00527ec2 : MOV ECX,dword ptr [ESP + 0x14]
00527ec6 : CMP ECX,EBX
00527ec8 : JZ 0x00527ecf
00527eca : CALL 0x00503db0
00527ecf : MOV EAX,0xffff
00527ed4 : ADD word ptr [ESI + 0xc4],AX
00527edb : MOV ESI,dword ptr [ESP + 0x68]
00527edf : LEA ECX,[ESP + 0x30]
00527ee3 : PUSH ECX
00527ee4 : MOV ECX,ESI
00527ee6 : CALL 0x005266c0
00527eeb : MOV BL,0x5
00527eed : CMP byte ptr [ESP + 0x30],BL
00527ef1 : JC 0x00527fbc
00527ef7 : LEA ECX,[ESP + 0x30]
00527efb : JMP 0x00527fb7
00527f00 : MOV AL,byte ptr [EDI]
00527f02 : CMP AL,0x7
00527f04 : JNZ 0x00527f25
00527f06 : CMP dword ptr [EDI + 0x4],0x0
00527f0a : JZ 0x00527f25
00527f0c : PUSH ESI
00527f0d : MOV ECX,EDI
00527f0f : CALL 0x00525fd0
00527f14 : MOV EAX,dword ptr [EAX]
00527f16 : INC dword ptr [EAX + 0x8]
00527f19 : MOV BL,0x5
00527f1b : MOV byte ptr [ESP + 0x10],BL
00527f1f : MOV dword ptr [ESP + 0x14],EAX
00527f23 : JMP 0x00527f9d
00527f25 : CMP AL,0x6
00527f27 : JNZ 0x00527f70
00527f29 : CMP dword ptr [EDI + 0x4],0x0
00527f2d : JZ 0x00527f70
00527f2f : MOV EAX,dword ptr [EDI + 0x4]
00527f32 : MOV EDX,dword ptr [EAX + 0x10]
00527f35 : LEA ECX,[EAX + 0x10]
00527f38 : MOV EAX,dword ptr [EDX + 0x4]
00527f3b : PUSH ESI
00527f3c : CALL EAX
00527f3e : TEST EAX,EAX
00527f40 : JZ 0x00527f70
00527f42 : MOV ESI,dword ptr [ESI + 0x78]
00527f45 : PUSH EAX
00527f46 : LEA ECX,[ESI + 0x254]
00527f4c : CALL 0x00525530
00527f51 : MOV ECX,0x1
00527f56 : ADD dword ptr [EAX + 0x8],ECX
00527f59 : ADD dword ptr [EAX + 0x8],ECX
00527f5c : ADD dword ptr [EAX + 0x8],-0x1
00527f60 : MOV BL,0x5
00527f62 : MOV byte ptr [ESP + 0x10],BL
00527f66 : MOV dword ptr [ESP + 0x14],EAX
00527f6a : JNZ 0x00527f9d
00527f6c : MOV ECX,EAX
00527f6e : JMP 0x00527f98
00527f70 : PUSH 0x0
00527f72 : PUSH -0x1
00527f74 : PUSH ESI
00527f75 : LEA ECX,[ESP + 0x78]
00527f79 : PUSH ECX
00527f7a : MOV ECX,EDI
00527f7c : CALL 0x005272e0
00527f81 : MOV ECX,dword ptr [ESP + 0x6c]
00527f85 : INC dword ptr [ECX + 0x8]
00527f88 : ADD dword ptr [ECX + 0x8],-0x1
00527f8c : MOV BL,0x5
00527f8e : MOV byte ptr [ESP + 0x10],BL
00527f92 : MOV dword ptr [ESP + 0x14],ECX
00527f96 : JNZ 0x00527f9d
00527f98 : CALL 0x00525340
00527f9d : MOV ESI,dword ptr [ESP + 0x68]
00527fa1 : LEA EDX,[ESP + 0x10]
00527fa5 : PUSH EDX
00527fa6 : MOV ECX,ESI
00527fa8 : CALL 0x005266c0
00527fad : CMP byte ptr [ESP + 0x10],BL
00527fb1 : JC 0x00527fbc
00527fb3 : LEA ECX,[ESP + 0x10]
00527fb7 : CALL 0x00526400
00527fbc : CMP byte ptr [ESP + 0x20],BL
00527fc0 : JC 0x00527fcb
00527fc2 : LEA ECX,[ESP + 0x20]
00527fc6 : CALL 0x00526400
00527fcb : POP EBX
00527fcc : POP EBP
00527fcd : POP EDI
00527fce : MOV EAX,ESI
00527fd0 : POP ESI
00527fd1 : ADD ESP,0x54
00527fd4 : RET 0xc

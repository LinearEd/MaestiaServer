PROGRAM  : Maestia.exe
FUNCTION : FUN_0093b8f0
ENTRY    : 0093b8f0
BODY     : [[0093b8f0, 0093bcd1] [0093bcd8, 0093bcf1]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_0093b8f0(int *param_1,undefined4 param_2,undefined4 *param_3)

{
  char cVar1;
  int *piVar2;
  undefined4 *in_EDX;
  undefined1 *puVar3;
  int iVar4;
  uint uVar5;
  undefined4 local_1070 [129];
  undefined4 *local_e6c;
  undefined2 *local_e68;
  undefined4 *local_e64;
  undefined4 local_e60;
  undefined4 local_e5c;
  undefined4 local_e58;
  undefined4 local_e54;
  uint local_e4d;
  undefined1 local_e49 [5];
  int local_e44;
  int local_e40;
  undefined4 local_e3c;
  undefined1 local_e38 [4];
  undefined4 *local_e34;
  undefined4 *local_e30;
  undefined4 local_e2c;
  undefined4 local_e28;
  int local_e24;
  uint local_e20;
  uint local_e1c;
  undefined1 local_e18 [20];
  int local_e04 [891];
  uint local_18;
  undefined4 uStack_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b66eb9;
  local_10 = ExceptionList;
  uStack_14 = 0x93b90b;
  local_18 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_e6c = param_3;
  local_e64 = in_EDX;
  _eh_vector_constructor_iterator_(local_e18,0x1c,0x80,FUN_00405d90,FUN_00406560);
  local_e28 = param_2;
  local_e4d = local_e4d & 0xffffff00;
  local_e34 = (undefined4 *)0x0;
  local_e30 = (undefined4 *)0x0;
  local_e2c = 0;
  local_8._0_1_ = 1;
  local_8._1_3_ = 0;
  iVar4 = *(int *)(DAT_017248f8 + 0x1c);
  local_e24 = *param_1;
  local_e1c = 0x80;
  FUN_004437f0(&local_e24);
  if (((local_e20 != *(uint *)(iVar4 + 4)) && (*(int *)(local_e20 + 0x10) != 0)) &&
     (cVar1 = FUN_0084a4a0(&local_e1c,local_e18,local_1070,&local_e4d,&local_e28,0xffffffff),
     cVar1 != '\0')) {
    iVar4 = 0;
    local_e40 = 0;
    local_e60 = 0;
    local_e5c = 0;
    local_e58 = 0;
    local_e44 = 0;
    local_e3c = 0;
    local_8 = CONCAT31(local_8._1_3_,2);
    local_e24 = 0;
    do {
      cVar1 = FUN_0084a4a0(&local_e1c,local_e18,local_1070,&local_e4d,&local_e28,local_e24);
      if (cVar1 != '\0') {
        if (local_e1c != 0) {
          puVar3 = local_e18;
          local_e20 = local_e1c;
          do {
            piVar2 = (int *)FUN_00413740(&local_e54,local_e44,iVar4,puVar3);
            if (*piVar2 == iVar4) {
              FUN_00405ae0(puVar3);
              iVar4 = local_e40;
            }
            else {
              FUN_00406360(&DAT_00c70384,0);
            }
            puVar3 = puVar3 + 0x1c;
            local_e20 = local_e20 - 1;
          } while (local_e20 != 0);
        }
        uVar5 = 0;
        iVar4 = local_e40;
        if (local_e1c != 0) {
          piVar2 = local_e04;
          do {
            if (((*piVar2 != 0) &&
                (cVar1 = FUN_00a3e0b0(DAT_00da93ec,local_1070[uVar5],piVar2 + -5,&local_e28,
                                      local_e38,&local_e20,&local_e60,local_e49,local_e4d,param_2),
                cVar1 != '\0')) && (local_e34 != local_e30)) {
              *local_e68 = (undefined2)local_e28;
              *local_e64 = local_e60;
              local_e64[1] = local_e5c;
              local_e64[2] = local_e58;
              *local_e6c = *local_e34;
              local_e6c[1] = local_e34[1];
              local_e6c[2] = local_e34[2];
              local_8 = CONCAT31(local_8._1_3_,1);
              if (local_e44 == 0) {
                local_e44 = 0;
                local_e40 = 0;
                local_e3c = 0;
                local_8 = (uint)local_8._1_3_ << 8;
                    /* WARNING: Subroutine does not return */
                FUN_006f04e0();
              }
              FUN_00405450(local_e54);
                    /* WARNING: Subroutine does not return */
              FUN_006f04e0();
            }
            uVar5 = uVar5 + 1;
            piVar2 = piVar2 + 7;
            iVar4 = local_e40;
          } while (uVar5 < local_e1c);
        }
      }
      local_e24 = local_e24 + 1;
    } while (local_e24 < 1);
    local_8 = CONCAT31(local_8._1_3_,1);
    if (local_e44 != 0) {
      FUN_00405450(local_e54);
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_e44 = 0;
    local_e40 = 0;
    local_e3c = 0;
    local_8 = (uint)local_8._1_3_ << 8;
    if (local_e34 != (undefined4 *)0x0) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  local_8 = 0xffffffff;
  local_e2c = 0;
  local_e30 = (undefined4 *)0x0;
  local_e34 = (undefined4 *)0x0;
  _eh_vector_destructor_iterator_(local_e18,0x1c,0x80,FUN_00406560);
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0093b8f0 : PUSH EBP
0093b8f1 : MOV EBP,ESP
0093b8f3 : PUSH -0x1
0093b8f5 : PUSH 0xb66eb9
0093b8fa : MOV EAX,FS:[0x0]
0093b900 : PUSH EAX
0093b901 : MOV EAX,0x1060
0093b906 : CALL 0x0063b780
0093b90b : MOV EAX,[0x00d66fa0]
0093b910 : XOR EAX,EBP
0093b912 : MOV dword ptr [EBP + -0x14],EAX
0093b915 : PUSH EBX
0093b916 : PUSH ESI
0093b917 : PUSH EDI
0093b918 : PUSH EAX
0093b919 : LEA EAX,[EBP + -0xc]
0093b91c : MOV FS:[0x0],EAX
0093b922 : MOV EAX,dword ptr [EBP + 0x10]
0093b925 : PUSH 0x406560
0093b92a : PUSH 0x405d90
0093b92f : PUSH 0x80
0093b934 : MOV dword ptr [EBP + 0xfffff198],EAX
0093b93a : PUSH 0x1c
0093b93c : LEA EAX,[EBP + 0xfffff1ec]
0093b942 : PUSH EAX
0093b943 : MOV dword ptr [EBP + 0xfffff19c],ECX
0093b949 : MOV dword ptr [EBP + 0xfffff1a0],EDX
0093b94f : CALL 0x0063619b
0093b954 : XOR EBX,EBX
0093b956 : MOV dword ptr [EBP + -0x4],EBX
0093b959 : MOV ECX,dword ptr [EBP + 0xc]
0093b95c : MOV dword ptr [EBP + 0xfffff1dc],ECX
0093b962 : MOV byte ptr [EBP + 0xfffff1b7],BL
0093b968 : MOV dword ptr [EBP + 0xfffff1d0],EBX
0093b96e : MOV dword ptr [EBP + 0xfffff1d4],EBX
0093b974 : MOV dword ptr [EBP + 0xfffff1d8],EBX
0093b97a : MOV byte ptr [EBP + -0x4],0x1
0093b97e : MOV EAX,[0x017248f8]
0093b983 : MOV EDX,dword ptr [EBP + 0x8]
0093b986 : MOV ESI,dword ptr [EAX + 0x1c]
0093b989 : MOV EDI,dword ptr [EDX]
0093b98b : LEA ECX,[EBP + 0xfffff1e0]
0093b991 : PUSH ECX
0093b992 : LEA EAX,[EBP + 0xfffff1e4]
0093b998 : MOV ECX,ESI
0093b99a : MOV dword ptr [EBP + 0xfffff1e8],0x80
0093b9a4 : MOV dword ptr [EBP + 0xfffff1e0],EDI
0093b9aa : CALL 0x004437f0
0093b9af : MOV ESI,dword ptr [ESI + 0x4]
0093b9b2 : MOV EAX,dword ptr [EBP + 0xfffff1e4]
0093b9b8 : CMP EAX,ESI
0093b9ba : JZ 0x0093b9c1
0093b9bc : CMP dword ptr [EAX + 0x10],EBX
0093b9bf : JNZ 0x0093b9f5
0093b9c1 : MOV byte ptr [EBP + -0x4],BL
0093b9c4 : MOV dword ptr [EBP + 0xfffff1d0],EBX
0093b9ca : MOV dword ptr [EBP + 0xfffff1d4],EBX
0093b9d0 : MOV dword ptr [EBP + 0xfffff1d8],EBX
0093b9d6 : MOV dword ptr [EBP + -0x4],0xffffffff
0093b9dd : PUSH 0x406560
0093b9e2 : PUSH 0x80
0093b9e7 : PUSH 0x1c
0093b9e9 : LEA EDX,[EBP + 0xfffff1ec]
0093b9ef : PUSH EDX
0093b9f0 : JMP 0x0093bc2f
0093b9f5 : PUSH -0x1
0093b9f7 : LEA EAX,[EBP + 0xfffff1dc]
0093b9fd : PUSH EAX
0093b9fe : LEA ECX,[EBP + 0xfffff1b7]
0093ba04 : PUSH ECX
0093ba05 : LEA EDX,[EBP + 0xffffef94]
0093ba0b : PUSH EDX
0093ba0c : MOV EDX,dword ptr [0x017248f8]
0093ba12 : MOV EDX,dword ptr [EDX + 0x1c]
0093ba15 : LEA EAX,[EBP + 0xfffff1ec]
0093ba1b : PUSH EAX
0093ba1c : LEA ECX,[EBP + 0xfffff1e8]
0093ba22 : PUSH ECX
0093ba23 : MOV ECX,EDI
0093ba25 : CALL 0x0084a4a0
0093ba2a : TEST AL,AL
0093ba2c : JNZ 0x0093ba36
0093ba2e : MOV byte ptr [EBP + -0x4],BL
0093ba31 : JMP 0x0093bc03
0093ba36 : XORPS XMM0,XMM0
0093ba39 : XOR EDI,EDI
0093ba3b : MOV dword ptr [EBP + 0xfffff1c4],EDI
0093ba41 : MOVSS dword ptr [EBP + 0xfffff1a4],XMM0
0093ba49 : MOVSS dword ptr [EBP + 0xfffff1a8],XMM0
0093ba51 : MOVSS dword ptr [EBP + 0xfffff1ac],XMM0
0093ba59 : MOV dword ptr [EBP + 0xfffff1c0],EBX
0093ba5f : MOV dword ptr [EBP + 0xfffff1c8],EBX
0093ba65 : MOV byte ptr [EBP + -0x4],0x2
0093ba69 : XOR EAX,EAX
0093ba6b : MOV dword ptr [EBP + 0xfffff1e0],EAX
0093ba71 : MOV ECX,dword ptr [EBP + 0x8]
0093ba74 : MOV ECX,dword ptr [ECX]
0093ba76 : PUSH EAX
0093ba77 : LEA EDX,[EBP + 0xfffff1dc]
0093ba7d : PUSH EDX
0093ba7e : LEA EAX,[EBP + 0xfffff1b7]
0093ba84 : PUSH EAX
0093ba85 : LEA EDX,[EBP + 0xffffef94]
0093ba8b : PUSH EDX
0093ba8c : LEA EAX,[EBP + 0xfffff1ec]
0093ba92 : PUSH EAX
0093ba93 : MOV EAX,[0x017248f8]
0093ba98 : LEA EDX,[EBP + 0xfffff1e8]
0093ba9e : PUSH EDX
0093ba9f : MOV EDX,dword ptr [EAX + 0x1c]
0093baa2 : CALL 0x0084a4a0
0093baa7 : TEST AL,AL
0093baa9 : JZ 0x0093bb9f
0093baaf : MOV EAX,dword ptr [EBP + 0xfffff1e8]
0093bab5 : CMP EAX,EBX
0093bab7 : JBE 0x0093bb0e
0093bab9 : LEA ESI,[EBP + 0xfffff1ec]
0093babf : MOV dword ptr [EBP + 0xfffff1e4],EAX
0093bac5 : MOV ECX,dword ptr [EBP + 0xfffff1c0]
0093bacb : PUSH ESI
0093bacc : PUSH EDI
0093bacd : PUSH ECX
0093bace : LEA EDX,[EBP + 0xfffff1b0]
0093bad4 : PUSH EDX
0093bad5 : CALL 0x00413740
0093bada : ADD ESP,0x10
0093badd : CMP dword ptr [EAX],EDI
0093badf : JNZ 0x0093baf5
0093bae1 : PUSH ESI
0093bae2 : LEA EAX,[EBP + 0xfffff1bc]
0093bae8 : CALL 0x00405ae0
0093baed : MOV EDI,dword ptr [EBP + 0xfffff1c4]
0093baf3 : JMP 0x0093bb02
0093baf5 : PUSH EBX
0093baf6 : PUSH 0xc70384
0093bafb : MOV ECX,ESI
0093bafd : CALL 0x00406360
0093bb02 : ADD ESI,0x1c
0093bb05 : SUB dword ptr [EBP + 0xfffff1e4],0x1
0093bb0c : JNZ 0x0093bac5
0093bb0e : XOR EDI,EDI
0093bb10 : CMP dword ptr [EBP + 0xfffff1e8],EBX
0093bb16 : JBE 0x0093bb99
0093bb1c : LEA ESI,[EBP + 0xfffff200]
0093bb22 : MOV EAX,dword ptr [ESI]
0093bb24 : XOR ECX,ECX
0093bb26 : CMP EAX,EBX
0093bb28 : SETNZ CL
0093bb2b : MOV EAX,ECX
0093bb2d : CMP EAX,EBX
0093bb2f : JZ 0x0093bb8d
0093bb31 : MOV EDX,dword ptr [EBP + 0xc]
0093bb34 : MOV EAX,dword ptr [EBP + 0xfffff1b7]
0093bb3a : PUSH EDX
0093bb3b : PUSH EAX
0093bb3c : LEA ECX,[EBP + 0xfffff1bb]
0093bb42 : PUSH ECX
0093bb43 : LEA EDX,[EBP + 0xfffff1a4]
0093bb49 : PUSH EDX
0093bb4a : LEA EAX,[EBP + 0xfffff1e4]
0093bb50 : PUSH EAX
0093bb51 : LEA ECX,[EBP + 0xfffff1cc]
0093bb57 : PUSH ECX
0093bb58 : MOV ECX,dword ptr [EBP + EDI*0x4 + 0xffffef94]
0093bb5f : LEA EDX,[EBP + 0xfffff1dc]
0093bb65 : PUSH EDX
0093bb66 : MOV EDX,dword ptr [0x00da93ec]
0093bb6c : LEA EAX,[ESI + -0x14]
0093bb6f : PUSH EAX
0093bb70 : PUSH ECX
0093bb71 : PUSH EDX
0093bb72 : CALL 0x00a3e0b0
0093bb77 : TEST AL,AL
0093bb79 : JZ 0x0093bb8d
0093bb7b : MOV ECX,dword ptr [EBP + 0xfffff1d0]
0093bb81 : CMP ECX,dword ptr [EBP + 0xfffff1d4]
0093bb87 : JNZ 0x0093bc54
0093bb8d : INC EDI
0093bb8e : ADD ESI,0x1c
0093bb91 : CMP EDI,dword ptr [EBP + 0xfffff1e8]
0093bb97 : JC 0x0093bb22
0093bb99 : MOV EDI,dword ptr [EBP + 0xfffff1c4]
0093bb9f : MOV EAX,dword ptr [EBP + 0xfffff1e0]
0093bba5 : INC EAX
0093bba6 : CMP EAX,0x1
0093bba9 : MOV dword ptr [EBP + 0xfffff1e0],EAX
0093bbaf : JL 0x0093ba71
0093bbb5 : MOV byte ptr [EBP + -0x4],0x1
0093bbb9 : CMP dword ptr [EBP + 0xfffff1c0],EBX
0093bbbf : JZ 0x0093bbdf
0093bbc1 : MOV EDX,dword ptr [EBP + 0xfffff1b0]
0093bbc7 : MOV ESI,dword ptr [EBP + 0xfffff1c0]
0093bbcd : PUSH EDX
0093bbce : MOV EAX,ESI
0093bbd0 : CALL 0x00405450
0093bbd5 : ADD ESP,0x4
0093bbd8 : MOV ECX,ESI
0093bbda : CALL 0x006f04e0
0093bbdf : MOV dword ptr [EBP + 0xfffff1c0],EBX
0093bbe5 : MOV dword ptr [EBP + 0xfffff1c4],EBX
0093bbeb : MOV dword ptr [EBP + 0xfffff1c8],EBX
0093bbf1 : MOV byte ptr [EBP + -0x4],BL
0093bbf4 : MOV ECX,dword ptr [EBP + 0xfffff1d0]
0093bbfa : CMP ECX,EBX
0093bbfc : JZ 0x0093bc03
0093bbfe : CALL 0x006f04e0
0093bc03 : MOV dword ptr [EBP + 0xfffff1d8],EBX
0093bc09 : MOV dword ptr [EBP + 0xfffff1d4],EBX
0093bc0f : MOV dword ptr [EBP + 0xfffff1d0],EBX
0093bc15 : MOV dword ptr [EBP + -0x4],0xffffffff
0093bc1c : PUSH 0x406560
0093bc21 : PUSH 0x80
0093bc26 : PUSH 0x1c
0093bc28 : LEA EAX,[EBP + 0xfffff1ec]
0093bc2e : PUSH EAX
0093bc2f : CALL 0x0063625e
0093bc34 : XOR EAX,EAX
0093bc36 : MOV ECX,dword ptr [EBP + -0xc]
0093bc39 : MOV dword ptr FS:[0x0],ECX
0093bc40 : POP ECX
0093bc41 : POP EDI
0093bc42 : POP ESI
0093bc43 : POP EBX
0093bc44 : MOV ECX,dword ptr [EBP + -0x14]
0093bc47 : XOR ECX,EBP
0093bc49 : CALL 0x00633e6b
0093bc4e : MOV ESP,EBP
0093bc50 : POP EBP
0093bc51 : RET 0xc
0093bc54 : MOV AX,word ptr [EBP + 0xfffff1dc]
0093bc5b : MOV EDX,dword ptr [EBP + 0xfffff19c]
0093bc61 : MOVSS XMM0,dword ptr [EBP + 0xfffff1a4]
0093bc69 : MOV word ptr [EDX],AX
0093bc6c : MOV EAX,dword ptr [EBP + 0xfffff1a0]
0093bc72 : MOVSS dword ptr [EAX],XMM0
0093bc76 : MOVSS XMM0,dword ptr [EBP + 0xfffff1a8]
0093bc7e : MOVSS dword ptr [EAX + 0x4],XMM0
0093bc83 : MOVSS XMM0,dword ptr [EBP + 0xfffff1ac]
0093bc8b : MOVSS dword ptr [EAX + 0x8],XMM0
0093bc90 : FLD float ptr [ECX]
0093bc92 : MOV EAX,dword ptr [EBP + 0xfffff198]
0093bc98 : FSTP float ptr [EAX]
0093bc9a : FLD float ptr [ECX + 0x4]
0093bc9d : FSTP float ptr [EAX + 0x4]
0093bca0 : FLD float ptr [ECX + 0x8]
0093bca3 : FSTP float ptr [EAX + 0x8]
0093bca6 : MOV byte ptr [EBP + -0x4],0x1
0093bcaa : MOV ESI,dword ptr [EBP + 0xfffff1c0]
0093bcb0 : CMP ESI,EBX
0093bcb2 : JZ 0x0093bcd8
0093bcb4 : MOV EAX,dword ptr [EBP + 0xfffff1b0]
0093bcba : MOV EDI,dword ptr [EBP + 0xfffff1c4]
0093bcc0 : PUSH EAX
0093bcc1 : MOV EAX,ESI
0093bcc3 : CALL 0x00405450
0093bcc8 : ADD ESP,0x4
0093bccb : MOV ECX,ESI
0093bccd : CALL 0x006f04e0
0093bcd8 : MOV dword ptr [EBP + 0xfffff1c0],EBX
0093bcde : MOV dword ptr [EBP + 0xfffff1c4],EBX
0093bce4 : MOV dword ptr [EBP + 0xfffff1c8],EBX
0093bcea : MOV byte ptr [EBP + -0x4],BL
0093bced : CALL 0x006f04e0

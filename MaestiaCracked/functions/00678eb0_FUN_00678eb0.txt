PROGRAM  : Maestia.exe
FUNCTION : FUN_00678eb0
ENTRY    : 00678eb0
BODY     : [[00678eb0, 0067903f]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00678eb0(uint param_1,undefined4 param_2,undefined4 param_3)

{
  int *piVar1;
  int iVar2;
  uint uVar3;
  char cVar4;
  int iVar5;
  undefined4 uVar6;
  uint uVar7;
  uint local_14;
  undefined1 local_10 [16];
  
  uVar3 = param_1;
  if (*(int *)(param_1 + 0x68) == 0) {
    return 0;
  }
  __controlfp_s(&local_14,0,0);
  __controlfp_s(&param_1,0x10000,0x30000);
  uVar6 = param_2;
  local_10[0] = 0;
  if (*(int *)(uVar3 + 0xa00) != 0) {
    iVar5 = FUN_005760d0(param_2);
    if (iVar5 != 0) {
      cVar4 = FUN_00572520(uVar6,iVar5,local_10,param_3,&stack0x00000010);
      goto LAB_00678f3b;
    }
  }
  cVar4 = FUN_0058b460(uVar6,local_10,param_3,&stack0x00000010);
LAB_00678f3b:
  if (cVar4 != '\0') {
    *(undefined4 *)(*(int *)(uVar3 + 0x9ec) + 0x18) = 0;
    iVar5 = *(int *)(*(int *)(uVar3 + 0x9ec) + 0x18);
    *(int *)(*(int *)(uVar3 + 0x9ec) + 0x18) = iVar5 + 1;
    uVar7 = *(uint *)(*(int *)(uVar3 + 0x9ec) + 0x18);
    if (*(uint *)(*(int *)(uVar3 + 0x9ec) + 0xc) < uVar7) {
      if (uVar7 == 0) {
        uVar7 = 1;
      }
      FUN_0052b460(uVar7);
    }
    uVar6 = (**(code **)(**(int **)(uVar3 + 0x68) + 0x5c))();
    FUN_005272e0(&param_1,uVar6,0xffffffff,0);
    uVar7 = param_1;
    iVar5 = iVar5 * 4;
    iVar2 = *(int *)(*(int *)(uVar3 + 0x9ec) + 8);
    *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 1;
    piVar1 = (int *)(*(int *)(iVar2 + iVar5) + 8);
    *piVar1 = *piVar1 + -1;
    if (*piVar1 == 0) {
      FUN_00525340();
    }
    *(uint *)(iVar2 + iVar5) = uVar7;
    *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + -1;
    if (*(int *)(param_1 + 8) == 0) {
      FUN_00525340();
    }
    uVar6 = **(undefined4 **)(*(int *)(*(int *)(uVar3 + 0x9ec) + 8) + iVar5);
    FUN_00526bc0();
    __controlfp_s(&param_1,local_14,0x30000);
    return uVar6;
  }
  FUN_00526bc0();
  __controlfp_s(&param_1,local_14,0x30000);
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00678eb0 : SUB ESP,0x14
00678eb3 : PUSH ESI
00678eb4 : MOV ESI,dword ptr [ESP + 0x1c]
00678eb8 : CMP dword ptr [ESI + 0x68],0x0
00678ebc : JNZ 0x00678ec5
00678ebe : XOR EAX,EAX
00678ec0 : POP ESI
00678ec1 : ADD ESP,0x14
00678ec4 : RET
00678ec5 : PUSH EDI
00678ec6 : PUSH 0x0
00678ec8 : LEA EAX,[ESP + 0xc]
00678ecc : PUSH 0x0
00678ece : PUSH EAX
00678ecf : CALL 0x0063c57b
00678ed4 : PUSH 0x30000
00678ed9 : LEA ECX,[ESP + 0x30]
00678edd : PUSH 0x10000
00678ee2 : PUSH ECX
00678ee3 : CALL 0x0063c57b
00678ee8 : MOV EDI,dword ptr [ESP + 0x3c]
00678eec : ADD ESP,0x18
00678eef : CMP dword ptr [ESI + 0xa00],0x0
00678ef6 : MOV byte ptr [ESP + 0xc],0x0
00678efb : JZ 0x00678f23
00678efd : PUSH EDI
00678efe : MOV ECX,ESI
00678f00 : CALL 0x005760d0
00678f05 : TEST EAX,EAX
00678f07 : JZ 0x00678f23
00678f09 : MOV ECX,dword ptr [ESP + 0x28]
00678f0d : LEA EDX,[ESP + 0x2c]
00678f11 : PUSH EDX
00678f12 : PUSH ECX
00678f13 : LEA EDX,[ESP + 0x14]
00678f17 : PUSH EDX
00678f18 : PUSH EAX
00678f19 : PUSH EDI
00678f1a : MOV ECX,ESI
00678f1c : CALL 0x00572520
00678f21 : JMP 0x00678f3b
00678f23 : MOV ECX,dword ptr [ESP + 0x28]
00678f27 : LEA EAX,[ESP + 0x2c]
00678f2b : PUSH EAX
00678f2c : PUSH ECX
00678f2d : MOV ECX,dword ptr [ESI + 0x68]
00678f30 : LEA EDX,[ESP + 0x14]
00678f34 : PUSH EDX
00678f35 : PUSH EDI
00678f36 : CALL 0x0058b460
00678f3b : TEST AL,AL
00678f3d : JZ 0x00679018
00678f43 : MOV EAX,dword ptr [ESI + 0x9ec]
00678f49 : MOV dword ptr [EAX + 0x18],0x0
00678f50 : MOV EAX,dword ptr [ESI + 0x9ec]
00678f56 : MOV EDI,dword ptr [EAX + 0x18]
00678f59 : LEA ECX,[EDI + 0x1]
00678f5c : MOV dword ptr [EAX + 0x18],ECX
00678f5f : MOV EAX,dword ptr [ESI + 0x9ec]
00678f65 : MOV ECX,dword ptr [EAX + 0x18]
00678f68 : CMP dword ptr [EAX + 0xc],ECX
00678f6b : JNC 0x00678f80
00678f6d : CMP ECX,0x1
00678f70 : JNC 0x00678f77
00678f72 : MOV ECX,0x1
00678f77 : PUSH ECX
00678f78 : LEA ECX,[EAX + 0x8]
00678f7b : CALL 0x0052b460
00678f80 : MOV ECX,dword ptr [ESI + 0x68]
00678f83 : MOV EDX,dword ptr [ECX]
00678f85 : MOV EAX,dword ptr [EDX + 0x5c]
00678f88 : PUSH EBX
00678f89 : PUSH EBP
00678f8a : CALL EAX
00678f8c : PUSH 0x0
00678f8e : PUSH -0x1
00678f90 : PUSH EAX
00678f91 : LEA ECX,[ESP + 0x34]
00678f95 : PUSH ECX
00678f96 : LEA ECX,[ESP + 0x24]
00678f9a : CALL 0x005272e0
00678f9f : MOV EDX,dword ptr [ESI + 0x9ec]
00678fa5 : MOV EAX,dword ptr [ESP + 0x28]
00678fa9 : LEA EBP,[EDI*0x4 + 0x0]
00678fb0 : MOV EDI,dword ptr [EDX + 0x8]
00678fb3 : INC dword ptr [EAX + 0x8]
00678fb6 : MOV ECX,dword ptr [EDI + EBP*0x1]
00678fb9 : ADD EDI,EBP
00678fbb : ADD dword ptr [ECX + 0x8],-0x1
00678fbf : MOV EBX,EAX
00678fc1 : JNZ 0x00678fc8
00678fc3 : CALL 0x00525340
00678fc8 : MOV dword ptr [EDI],EBX
00678fca : MOV EAX,dword ptr [ESP + 0x28]
00678fce : DEC dword ptr [EAX + 0x8]
00678fd1 : MOV ECX,EAX
00678fd3 : ADD EAX,0x8
00678fd6 : CMP dword ptr [EAX],0x0
00678fd9 : JNZ 0x00678fe0
00678fdb : CALL 0x00525340
00678fe0 : MOV EAX,dword ptr [ESI + 0x9ec]
00678fe6 : MOV ECX,dword ptr [EAX + 0x8]
00678fe9 : MOV EDX,dword ptr [ECX + EBP*0x1]
00678fec : MOV ESI,dword ptr [EDX]
00678fee : LEA ECX,[ESP + 0x14]
00678ff2 : CALL 0x00526bc0
00678ff7 : MOV EAX,dword ptr [ESP + 0x10]
00678ffb : PUSH 0x30000
00679000 : PUSH EAX
00679001 : LEA ECX,[ESP + 0x30]
00679005 : PUSH ECX
00679006 : CALL 0x0063c57b
0067900b : ADD ESP,0xc
0067900e : POP EBP
0067900f : POP EBX
00679010 : POP EDI
00679011 : MOV EAX,ESI
00679013 : POP ESI
00679014 : ADD ESP,0x14
00679017 : RET
00679018 : LEA ECX,[ESP + 0xc]
0067901c : CALL 0x00526bc0
00679021 : MOV EDX,dword ptr [ESP + 0x8]
00679025 : PUSH 0x30000
0067902a : PUSH EDX
0067902b : LEA EAX,[ESP + 0x28]
0067902f : PUSH EAX
00679030 : CALL 0x0063c57b
00679035 : ADD ESP,0xc
00679038 : POP EDI
00679039 : XOR EAX,EAX
0067903b : POP ESI
0067903c : ADD ESP,0x14
0067903f : RET

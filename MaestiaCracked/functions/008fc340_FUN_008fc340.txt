PROGRAM  : Maestia.exe
FUNCTION : FUN_008fc340
ENTRY    : 008fc340
BODY     : [[008fc340, 008fc404]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008fc340(void)

{
  uint uVar1;
  DWORD DVar2;
  int unaff_EDI;
  uint uVar3;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b2c3c0;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(char *)(unaff_EDI + 0x40) == '\x01') {
    if (*(int *)(unaff_EDI + 0x44) == 0) {
      *(undefined1 *)(unaff_EDI + 0x40) = 0;
      *(undefined4 *)(unaff_EDI + 0x44) = 0;
      *(undefined4 *)(unaff_EDI + 0x48) = 0;
    }
    else {
      uVar3 = uVar1;
      DVar2 = timeGetTime();
      if (1000 < DVar2 - *(int *)(unaff_EDI + 0x48)) {
        FUN_00404750(&DAT_00c62394,*(undefined4 *)(unaff_EDI + 0x44),uVar3);
        local_8 = 0;
        FUN_009adfc0(*(undefined4 *)(*DAT_00da9894 + 0x1a8),0x14);
        *(int *)(unaff_EDI + 0x44) = *(int *)(unaff_EDI + 0x44) + -1;
        DVar2 = timeGetTime();
        *(DWORD *)(unaff_EDI + 0x48) = DVar2;
        local_8 = 0xffffffff;
        FUN_00406560();
      }
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(uVar1 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008fc340 : PUSH EBP
008fc341 : MOV EBP,ESP
008fc343 : PUSH -0x1
008fc345 : PUSH 0xb2c3c0
008fc34a : MOV EAX,FS:[0x0]
008fc350 : PUSH EAX
008fc351 : SUB ESP,0x20
008fc354 : MOV EAX,[0x00d66fa0]
008fc359 : XOR EAX,EBP
008fc35b : MOV dword ptr [EBP + -0x10],EAX
008fc35e : PUSH EBX
008fc35f : PUSH ESI
008fc360 : PUSH EAX
008fc361 : LEA EAX,[EBP + -0xc]
008fc364 : MOV FS:[0x0],EAX
008fc36a : CMP byte ptr [EDI + 0x40],0x1
008fc36e : JNZ 0x008fc3ea
008fc370 : XOR EAX,EAX
008fc372 : CMP dword ptr [EDI + 0x44],EAX
008fc375 : JBE 0x008fc3e1
008fc377 : MOV EBX,dword ptr [0x00b85598]
008fc37d : CALL EBX
008fc37f : SUB EAX,dword ptr [EDI + 0x48]
008fc382 : CMP EAX,0x3e8
008fc387 : JBE 0x008fc3ea
008fc389 : MOV EAX,dword ptr [EDI + 0x44]
008fc38c : PUSH EAX
008fc38d : PUSH 0xc62394
008fc392 : LEA ESI,[EBP + -0x2c]
008fc395 : CALL 0x00404750
008fc39a : ADD ESP,0x8
008fc39d : MOV dword ptr [EBP + -0x4],0x0
008fc3a4 : CMP dword ptr [EBP + -0x14],0x8
008fc3a8 : MOV ECX,dword ptr [EBP + -0x28]
008fc3ab : JNC 0x008fc3b0
008fc3ad : LEA ECX,[EBP + -0x28]
008fc3b0 : MOV EDX,dword ptr [0x00da9894]
008fc3b6 : MOV EAX,dword ptr [EDX]
008fc3b8 : MOV EAX,dword ptr [EAX + 0x1a8]
008fc3be : PUSH 0x14
008fc3c0 : PUSH EAX
008fc3c1 : CALL 0x009adfc0
008fc3c6 : OR ESI,0xffffffff
008fc3c9 : ADD dword ptr [EDI + 0x44],ESI
008fc3cc : ADD ESP,0x8
008fc3cf : CALL EBX
008fc3d1 : MOV dword ptr [EDI + 0x48],EAX
008fc3d4 : MOV dword ptr [EBP + -0x4],ESI
008fc3d7 : LEA ECX,[EBP + -0x2c]
008fc3da : CALL 0x00406560
008fc3df : JMP 0x008fc3ea
008fc3e1 : MOV byte ptr [EDI + 0x40],AL
008fc3e4 : MOV dword ptr [EDI + 0x44],EAX
008fc3e7 : MOV dword ptr [EDI + 0x48],EAX
008fc3ea : MOV ECX,dword ptr [EBP + -0xc]
008fc3ed : MOV dword ptr FS:[0x0],ECX
008fc3f4 : POP ECX
008fc3f5 : POP ESI
008fc3f6 : POP EBX
008fc3f7 : MOV ECX,dword ptr [EBP + -0x10]
008fc3fa : XOR ECX,EBP
008fc3fc : CALL 0x00633e6b
008fc401 : MOV ESP,EBP
008fc403 : POP EBP
008fc404 : RET

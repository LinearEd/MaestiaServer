PROGRAM  : Maestia.exe
FUNCTION : FUN_0077ad60
ENTRY    : 0077ad60
BODY     : [[0077ad60, 0077af49]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x0077aeea) */
/* WARNING: Removing unreachable block (ram,0x0077aef0) */
/* WARNING: Removing unreachable block (ram,0x0077aeff) */
/* WARNING: Removing unreachable block (ram,0x0077af0c) */

void FUN_0077ad60(int param_1)

{
  int *piVar1;
  char cVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  undefined1 local_2c [4];
  int local_28;
  int local_24;
  undefined4 local_20;
  int *local_1c;
  char local_15;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b36d6e;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  cVar2 = FUN_00486300(DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
  if (cVar2 != '\0') {
    ExceptionList = local_10;
    return;
  }
  if (*(uint *)(param_1 + 0x4c) < 3) {
    FUN_008018d0(L"Find Path Error m_WayPoints size 2 under !!!!!!!!!!!!");
    ExceptionList = local_10;
    return;
  }
  local_28 = 0;
  local_24 = 0;
  local_20 = 0;
  local_8 = 1;
  piVar1 = *(int **)(param_1 + 0x30);
  local_1c = (int *)(param_1 + 0x30);
  for (uVar6 = *(uint *)(param_1 + 0x48);
      (piVar1 != *(int **)(param_1 + 0x30) ||
      (uVar6 != *(int *)(param_1 + 0x4c) + *(int *)(param_1 + 0x48))); uVar6 = uVar6 + 1) {
    if (piVar1 == (int *)0x0) {
      iVar5 = 0;
    }
    else {
      iVar5 = *piVar1;
    }
    uVar3 = uVar6;
    if (*(uint *)(iVar5 + 0x14) <= uVar6) {
      if (piVar1 == (int *)0x0) {
        iVar5 = 0;
      }
      else {
        iVar5 = *piVar1;
      }
      uVar3 = uVar6 - *(int *)(iVar5 + 0x14);
    }
    if (piVar1 == (int *)0x0) {
      iVar5 = 0;
    }
    else {
      iVar5 = *piVar1;
    }
    FUN_00406db0(*(undefined4 *)(*(int *)(iVar5 + 0x10) + uVar3 * 4));
  }
  FUN_00476f00();
  iVar4 = local_28;
  iVar5 = (local_24 - local_28) / 0xc + -1;
  iVar7 = 0;
  local_15 = '\0';
  FUN_00406db0(local_28);
  if (0 < iVar5) {
    do {
      iVar4 = FUN_00485c10(param_1,local_2c,iVar5);
      if (iVar4 == -1) {
        FUN_00406db0(local_28 + (iVar7 * 3 + 3) * 4);
        iVar4 = iVar7;
      }
      else {
        FUN_00406db0(local_28 + iVar4 * 0xc);
        iVar7 = iVar4 + -1;
      }
      if (iVar4 == iVar5) {
        local_15 = '\x01';
      }
      iVar7 = iVar7 + 1;
    } while (iVar7 < iVar5);
    iVar4 = local_28;
    if (local_15 != '\0') goto LAB_0077aed6;
  }
  FUN_00406db0(iVar4 + iVar5 * 0xc);
LAB_0077aed6:
  FUN_00476f00();
  local_8 = 0xffffffff;
  if (local_28 == 0) {
    ExceptionList = local_10;
    return;
  }
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
0077ad60 : PUSH EBP
0077ad61 : MOV EBP,ESP
0077ad63 : PUSH -0x1
0077ad65 : PUSH 0xb36d6e
0077ad6a : MOV EAX,FS:[0x0]
0077ad70 : PUSH EAX
0077ad71 : SUB ESP,0x30
0077ad74 : PUSH EBX
0077ad75 : PUSH ESI
0077ad76 : PUSH EDI
0077ad77 : MOV EAX,[0x00d66fa0]
0077ad7c : XOR EAX,EBP
0077ad7e : PUSH EAX
0077ad7f : LEA EAX,[EBP + -0xc]
0077ad82 : MOV FS:[0x0],EAX
0077ad88 : MOV EDI,dword ptr [EBP + 0x8]
0077ad8b : MOV EAX,EDI
0077ad8d : CALL 0x00486300
0077ad92 : TEST AL,AL
0077ad94 : JNZ 0x0077af36
0077ad9a : CMP dword ptr [EDI + 0x4c],0x2
0077ad9e : JA 0x0077adc7
0077ada0 : MOV ESI,dword ptr [0x00da98e8]
0077ada6 : PUSH 0xc10538
0077adab : CALL 0x008018d0
0077adb0 : ADD ESP,0x4
0077adb3 : MOV ECX,dword ptr [EBP + -0xc]
0077adb6 : MOV dword ptr FS:[0x0],ECX
0077adbd : POP ECX
0077adbe : POP EDI
0077adbf : POP ESI
0077adc0 : POP EBX
0077adc1 : MOV ESP,EBP
0077adc3 : POP EBP
0077adc4 : RET 0x4
0077adc7 : XOR EDX,EDX
0077adc9 : MOV dword ptr [EBP + -0x24],EDX
0077adcc : MOV dword ptr [EBP + -0x20],EDX
0077adcf : MOV dword ptr [EBP + -0x1c],EDX
0077add2 : MOV dword ptr [EBP + -0x4],EDX
0077add5 : MOV dword ptr [EBP + -0x34],EDX
0077add8 : MOV dword ptr [EBP + -0x30],EDX
0077addb : MOV dword ptr [EBP + -0x2c],EDX
0077adde : MOV byte ptr [EBP + -0x4],0x1
0077ade2 : MOV ESI,dword ptr [EDI + 0x48]
0077ade5 : MOV EBX,dword ptr [EDI + 0x30]
0077ade8 : ADD EDI,0x30
0077adeb : MOV dword ptr [EBP + -0x18],EDI
0077adee : MOV EDI,EDI
0077adf0 : MOV EAX,dword ptr [EDI + 0x1c]
0077adf3 : ADD EAX,dword ptr [EDI + 0x18]
0077adf6 : CMP EBX,dword ptr [EDI]
0077adf8 : JNZ 0x0077adfe
0077adfa : CMP ESI,EAX
0077adfc : JZ 0x0077ae3c
0077adfe : MOV EAX,ESI
0077ae00 : CMP EBX,EDX
0077ae02 : JZ 0x0077ae08
0077ae04 : MOV ECX,dword ptr [EBX]
0077ae06 : JMP 0x0077ae0a
0077ae08 : XOR ECX,ECX
0077ae0a : CMP dword ptr [ECX + 0x14],ESI
0077ae0d : JA 0x0077ae1e
0077ae0f : CMP EBX,EDX
0077ae11 : JZ 0x0077ae17
0077ae13 : MOV ECX,dword ptr [EBX]
0077ae15 : JMP 0x0077ae19
0077ae17 : XOR ECX,ECX
0077ae19 : MOV EAX,ESI
0077ae1b : SUB EAX,dword ptr [ECX + 0x14]
0077ae1e : CMP EBX,EDX
0077ae20 : JZ 0x0077ae26
0077ae22 : MOV ECX,dword ptr [EBX]
0077ae24 : JMP 0x0077ae28
0077ae26 : XOR ECX,ECX
0077ae28 : MOV ECX,dword ptr [ECX + 0x10]
0077ae2b : MOV EDX,dword ptr [ECX + EAX*0x4]
0077ae2e : PUSH EDX
0077ae2f : LEA EAX,[EBP + -0x28]
0077ae32 : CALL 0x00406db0
0077ae37 : INC ESI
0077ae38 : XOR EDX,EDX
0077ae3a : JMP 0x0077adf0
0077ae3c : MOV ESI,EDI
0077ae3e : CALL 0x00476f00
0077ae43 : MOV ESI,dword ptr [EBP + -0x24]
0077ae46 : MOV ECX,dword ptr [EBP + -0x20]
0077ae49 : SUB ECX,ESI
0077ae4b : MOV EAX,0x2aaaaaab
0077ae50 : IMUL ECX
0077ae52 : SAR EDX,0x1
0077ae54 : MOV EAX,EDX
0077ae56 : SHR EAX,0x1f
0077ae59 : ADD EAX,EDX
0077ae5b : LEA EBX,[EAX + -0x1]
0077ae5e : PUSH ESI
0077ae5f : LEA EAX,[EBP + -0x38]
0077ae62 : XOR EDI,EDI
0077ae64 : MOV byte ptr [EBP + -0x11],0x0
0077ae68 : CALL 0x00406db0
0077ae6d : TEST EBX,EBX
0077ae6f : JLE 0x0077aec7
0077ae71 : MOV ECX,dword ptr [EBP + 0x8]
0077ae74 : PUSH EBX
0077ae75 : LEA EAX,[EBP + -0x28]
0077ae78 : PUSH EAX
0077ae79 : PUSH ECX
0077ae7a : MOV ECX,EDI
0077ae7c : CALL 0x00485c10
0077ae81 : MOV ESI,EAX
0077ae83 : MOV EAX,dword ptr [EBP + -0x24]
0077ae86 : CMP ESI,-0x1
0077ae89 : JZ 0x0077aea1
0077ae8b : LEA EDX,[ESI + ESI*0x2]
0077ae8e : LEA ECX,[EAX + EDX*0x4]
0077ae91 : PUSH ECX
0077ae92 : LEA EAX,[EBP + -0x38]
0077ae95 : CALL 0x00406db0
0077ae9a : LEA EDI,[ESI + -0x1]
0077ae9d : CMP ESI,EBX
0077ae9f : JMP 0x0077aeb3
0077aea1 : LEA EDX,[EDI + EDI*0x2 + 0x3]
0077aea5 : LEA ECX,[EAX + EDX*0x4]
0077aea8 : PUSH ECX
0077aea9 : LEA EAX,[EBP + -0x38]
0077aeac : CALL 0x00406db0
0077aeb1 : CMP EDI,EBX
0077aeb3 : JNZ 0x0077aeb9
0077aeb5 : MOV byte ptr [EBP + -0x11],0x1
0077aeb9 : INC EDI
0077aeba : CMP EDI,EBX
0077aebc : JL 0x0077ae71
0077aebe : CMP byte ptr [EBP + -0x11],0x0
0077aec2 : JNZ 0x0077aed6
0077aec4 : MOV ESI,dword ptr [EBP + -0x24]
0077aec7 : LEA EDX,[EBX + EBX*0x2]
0077aeca : LEA EAX,[ESI + EDX*0x4]
0077aecd : PUSH EAX
0077aece : LEA EAX,[EBP + -0x38]
0077aed1 : CALL 0x00406db0
0077aed6 : MOV ESI,dword ptr [EBP + -0x18]
0077aed9 : CALL 0x00476f00
0077aede : MOV ECX,dword ptr [EBP + -0x34]
0077aee1 : MOV EBX,dword ptr [EBP + -0x30]
0077aee4 : MOV EDI,ECX
0077aee6 : CMP ECX,EBX
0077aee8 : JZ 0x0077af02
0077aeea : LEA EBX,[EBX]
0077aef0 : PUSH EDI
0077aef1 : MOV EAX,ESI
0077aef3 : CALL 0x00406ea0
0077aef8 : ADD EDI,0xc
0077aefb : CMP EDI,EBX
0077aefd : JNZ 0x0077aef0
0077aeff : MOV ECX,dword ptr [EBP + -0x34]
0077af02 : MOV byte ptr [EBP + -0x4],0x0
0077af06 : XOR ESI,ESI
0077af08 : CMP ECX,ESI
0077af0a : JZ 0x0077af11
0077af0c : CALL 0x006f04e0
0077af11 : MOV dword ptr [EBP + -0x34],ESI
0077af14 : MOV dword ptr [EBP + -0x30],ESI
0077af17 : MOV dword ptr [EBP + -0x2c],ESI
0077af1a : MOV dword ptr [EBP + -0x4],0xffffffff
0077af21 : MOV ECX,dword ptr [EBP + -0x24]
0077af24 : CMP ECX,ESI
0077af26 : JZ 0x0077af2d
0077af28 : CALL 0x006f04e0
0077af2d : MOV dword ptr [EBP + -0x24],ESI
0077af30 : MOV dword ptr [EBP + -0x20],ESI
0077af33 : MOV dword ptr [EBP + -0x1c],ESI
0077af36 : MOV ECX,dword ptr [EBP + -0xc]
0077af39 : MOV dword ptr FS:[0x0],ECX
0077af40 : POP ECX
0077af41 : POP EDI
0077af42 : POP ESI
0077af43 : POP EBX
0077af44 : MOV ESP,EBP
0077af46 : POP EBP
0077af47 : RET 0x4

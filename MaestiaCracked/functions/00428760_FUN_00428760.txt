PROGRAM  : Maestia.exe
FUNCTION : FUN_00428760
ENTRY    : 00428760
BODY     : [[00428760, 00428813]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x004287a2) */

undefined4 * FUN_00428760(void)

{
  uint uVar1;
  uint uVar2;
  int in_EAX;
  int in_ECX;
  ushort *puVar3;
  ushort *puVar4;
  uint uVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  undefined4 *local_c;
  
  local_c = *(undefined4 **)(in_EAX + 4);
  if (*(char *)((int)local_c[1] + 0x29) == '\0') {
    uVar1 = *(uint *)(in_ECX + 0x14);
    puVar6 = (undefined4 *)local_c[1];
    do {
      puVar3 = (ushort *)(in_ECX + 4);
      if (7 < *(uint *)(in_ECX + 0x18)) {
        puVar3 = *(ushort **)(in_ECX + 4);
      }
      uVar2 = puVar6[8];
      uVar5 = uVar2;
      if (uVar1 <= uVar2) {
        uVar5 = uVar1;
      }
      if ((uint)puVar6[9] < 8) {
        puVar4 = (ushort *)(puVar6 + 4);
      }
      else {
        puVar4 = (ushort *)puVar6[4];
      }
      for (; uVar5 != 0; uVar5 = uVar5 - 1) {
        if (*puVar4 != *puVar3) {
          uVar5 = (-(uint)(*puVar4 < *puVar3) & 0xfffffffe) + 1;
          if (uVar5 != 0) goto LAB_004287e1;
          break;
        }
        puVar4 = puVar4 + 1;
        puVar3 = puVar3 + 1;
      }
      if (uVar2 < uVar1) {
LAB_004287e5:
        puVar7 = (undefined4 *)puVar6[2];
      }
      else {
        uVar5 = (uint)(uVar2 != uVar1);
LAB_004287e1:
        if ((int)uVar5 < 0) goto LAB_004287e5;
        puVar7 = (undefined4 *)*puVar6;
        local_c = puVar6;
      }
      puVar6 = puVar7;
    } while (*(char *)((int)puVar7 + 0x29) == '\0');
  }
  return local_c;
}



============================================================
DISASSEMBLY
============================================================
00428760 : PUSH EBP
00428761 : MOV EBP,ESP
00428763 : SUB ESP,0x10
00428766 : MOV EAX,dword ptr [EAX + 0x4]
00428769 : PUSH EDI
0042876a : MOV EDI,dword ptr [EAX + 0x4]
0042876d : CMP byte ptr [EDI + 0x29],0x0
00428771 : MOV dword ptr [EBP + -0x8],EAX
00428774 : JNZ 0x0042880f
0042877a : MOV EAX,dword ptr [ECX + 0x14]
0042877d : MOV EDX,dword ptr [ECX + 0x18]
00428780 : PUSH EBX
00428781 : ADD ECX,0x4
00428784 : PUSH ESI
00428785 : MOV dword ptr [EBP + -0x4],EAX
00428788 : MOV dword ptr [EBP + -0x10],EDX
0042878b : MOV dword ptr [EBP + -0xc],ECX
0042878e : JMP 0x00428793
00428790 : MOV ECX,dword ptr [EBP + -0xc]
00428793 : CMP dword ptr [EBP + -0x10],0x8
00428797 : JC 0x0042879b
00428799 : MOV ECX,dword ptr [ECX]
0042879b : MOV EBX,dword ptr [EDI + 0x20]
0042879e : MOV EDX,EBX
004287a0 : CMP EDX,EBX
004287a2 : CMOVC EBX,EDX
004287a5 : MOV ESI,EBX
004287a7 : CMP EBX,EAX
004287a9 : JC 0x004287ad
004287ab : MOV ESI,EAX
004287ad : CMP dword ptr [EDI + 0x24],0x8
004287b1 : JC 0x004287b8
004287b3 : MOV EDX,dword ptr [EDI + 0x10]
004287b6 : JMP 0x004287bb
004287b8 : LEA EDX,[EDI + 0x10]
004287bb : TEST ESI,ESI
004287bd : JBE 0x004287d6
004287bf : NOP
004287c0 : MOV AX,word ptr [EDX]
004287c3 : CMP AX,word ptr [ECX]
004287c6 : JNZ 0x004287ea
004287c8 : ADD EDX,0x2
004287cb : ADD ECX,0x2
004287ce : SUB ESI,0x1
004287d1 : JNZ 0x004287c0
004287d3 : MOV EAX,dword ptr [EBP + -0x4]
004287d6 : CMP EBX,EAX
004287d8 : JC 0x004287e5
004287da : XOR ECX,ECX
004287dc : CMP EBX,EAX
004287de : SETNZ CL
004287e1 : TEST ECX,ECX
004287e3 : JGE 0x004287ff
004287e5 : MOV EDI,dword ptr [EDI + 0x8]
004287e8 : JMP 0x00428804
004287ea : MOV DX,AX
004287ed : CMP DX,word ptr [ECX]
004287f0 : SBB ECX,ECX
004287f2 : AND ECX,0xfffffffe
004287f5 : ADD ECX,0x1
004287f8 : JZ 0x004287d3
004287fa : MOV EAX,dword ptr [EBP + -0x4]
004287fd : JMP 0x004287e1
004287ff : MOV dword ptr [EBP + -0x8],EDI
00428802 : MOV EDI,dword ptr [EDI]
00428804 : CMP byte ptr [EDI + 0x29],0x0
00428808 : JZ 0x00428790
0042880a : MOV EAX,dword ptr [EBP + -0x8]
0042880d : POP ESI
0042880e : POP EBX
0042880f : POP EDI
00428810 : MOV ESP,EBP
00428812 : POP EBP
00428813 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_0070e2b0
ENTRY    : 0070e2b0
BODY     : [[0070e2b0, 0070e2d8] [0070e2e0, 0070e30c] [0070e310, 0070e3e6]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_0070e2b0(uint param_1)

{
  byte *in_EAX;
  uint uVar1;
  uint in_ECX;
  uint uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  int iVar15;
  int iVar16;
  int iVar17;
  uint uVar18;
  uint uVar19;
  
  uVar2 = in_ECX & 0xffff;
  uVar19 = in_ECX >> 0x10;
  if (in_EAX == (byte *)0x0) {
    return 1;
  }
  while (param_1 != 0) {
    uVar1 = param_1;
    if (0x15af < param_1) {
      uVar1 = 0x15b0;
    }
    param_1 = param_1 - uVar1;
    if (0xf < (int)uVar1) {
      uVar18 = uVar1 >> 4;
      uVar1 = uVar1 + uVar18 * -0x10;
      do {
        iVar3 = uVar2 + *in_EAX;
        iVar4 = iVar3 + (uint)in_EAX[1];
        iVar5 = iVar4 + (uint)in_EAX[2];
        iVar6 = iVar5 + (uint)in_EAX[3];
        iVar7 = iVar6 + (uint)in_EAX[4];
        iVar8 = iVar7 + (uint)in_EAX[5];
        iVar9 = iVar8 + (uint)in_EAX[6];
        iVar10 = iVar9 + (uint)in_EAX[7];
        iVar11 = iVar10 + (uint)in_EAX[8];
        iVar12 = iVar11 + (uint)in_EAX[9];
        iVar13 = iVar12 + (uint)in_EAX[10];
        iVar14 = iVar13 + (uint)in_EAX[0xb];
        iVar15 = iVar14 + (uint)in_EAX[0xc];
        iVar16 = iVar15 + (uint)in_EAX[0xd];
        iVar17 = iVar16 + (uint)in_EAX[0xe];
        uVar2 = iVar17 + (uint)in_EAX[0xf];
        uVar19 = uVar19 + iVar3 + iVar4 + iVar5 + iVar6 + iVar7 + iVar8 + iVar9 + iVar10 + iVar11 +
                 iVar12 + iVar13 + iVar14 + iVar15 + iVar16 + iVar17 + uVar2;
        in_EAX = in_EAX + 0x10;
        uVar18 = uVar18 - 1;
      } while (uVar18 != 0);
    }
    for (; uVar1 != 0; uVar1 = uVar1 - 1) {
      uVar2 = uVar2 + *in_EAX;
      in_EAX = in_EAX + 1;
      uVar19 = uVar19 + uVar2;
    }
    uVar2 = uVar2 % 0xfff1;
    uVar19 = uVar19 % 0xfff1;
  }
  return uVar19 << 0x10 | uVar2;
}



============================================================
DISASSEMBLY
============================================================
0070e2b0 : PUSH EBP
0070e2b1 : MOV EBP,ESP
0070e2b3 : PUSH EBX
0070e2b4 : MOV EBX,dword ptr [EBP + 0x8]
0070e2b7 : PUSH ESI
0070e2b8 : PUSH EDI
0070e2b9 : MOV EDI,ECX
0070e2bb : MOV ESI,EAX
0070e2bd : MOVZX ECX,DI
0070e2c0 : SHR EDI,0x10
0070e2c3 : TEST ESI,ESI
0070e2c5 : JNZ 0x0070e2cf
0070e2c7 : POP EDI
0070e2c8 : LEA EAX,[ESI + 0x1]
0070e2cb : POP ESI
0070e2cc : POP EBX
0070e2cd : POP EBP
0070e2ce : RET
0070e2cf : TEST EBX,EBX
0070e2d1 : JBE 0x0070e3db
0070e2d7 : JMP 0x0070e2e0
0070e2e0 : MOV EAX,EBX
0070e2e2 : CMP EBX,0x15b0
0070e2e8 : JC 0x0070e2ef
0070e2ea : MOV EAX,0x15b0
0070e2ef : SUB EBX,EAX
0070e2f1 : CMP EAX,0x10
0070e2f4 : MOV dword ptr [EBP + 0x8],EBX
0070e2f7 : JL 0x0070e39e
0070e2fd : MOV EDX,EAX
0070e2ff : SHR EDX,0x4
0070e302 : MOV EBX,EDX
0070e304 : NEG EBX
0070e306 : SHL EBX,0x4
0070e309 : ADD EAX,EBX
0070e30b : JMP 0x0070e310
0070e310 : MOVZX EBX,byte ptr [ESI]
0070e313 : ADD ECX,EBX
0070e315 : MOVZX EBX,byte ptr [ESI + 0x1]
0070e319 : ADD EDI,ECX
0070e31b : ADD ECX,EBX
0070e31d : MOVZX EBX,byte ptr [ESI + 0x2]
0070e321 : ADD EDI,ECX
0070e323 : ADD ECX,EBX
0070e325 : MOVZX EBX,byte ptr [ESI + 0x3]
0070e329 : ADD EDI,ECX
0070e32b : ADD ECX,EBX
0070e32d : MOVZX EBX,byte ptr [ESI + 0x4]
0070e331 : ADD EDI,ECX
0070e333 : ADD ECX,EBX
0070e335 : MOVZX EBX,byte ptr [ESI + 0x5]
0070e339 : ADD EDI,ECX
0070e33b : ADD ECX,EBX
0070e33d : MOVZX EBX,byte ptr [ESI + 0x6]
0070e341 : ADD EDI,ECX
0070e343 : ADD ECX,EBX
0070e345 : MOVZX EBX,byte ptr [ESI + 0x7]
0070e349 : ADD EDI,ECX
0070e34b : ADD ECX,EBX
0070e34d : MOVZX EBX,byte ptr [ESI + 0x8]
0070e351 : ADD EDI,ECX
0070e353 : ADD ECX,EBX
0070e355 : MOVZX EBX,byte ptr [ESI + 0x9]
0070e359 : ADD EDI,ECX
0070e35b : ADD ECX,EBX
0070e35d : MOVZX EBX,byte ptr [ESI + 0xa]
0070e361 : ADD EDI,ECX
0070e363 : ADD ECX,EBX
0070e365 : MOVZX EBX,byte ptr [ESI + 0xb]
0070e369 : ADD EDI,ECX
0070e36b : ADD ECX,EBX
0070e36d : MOVZX EBX,byte ptr [ESI + 0xc]
0070e371 : ADD EDI,ECX
0070e373 : ADD ECX,EBX
0070e375 : MOVZX EBX,byte ptr [ESI + 0xd]
0070e379 : ADD EDI,ECX
0070e37b : ADD ECX,EBX
0070e37d : MOVZX EBX,byte ptr [ESI + 0xe]
0070e381 : ADD EDI,ECX
0070e383 : ADD ECX,EBX
0070e385 : MOVZX EBX,byte ptr [ESI + 0xf]
0070e389 : ADD EDI,ECX
0070e38b : ADD ECX,EBX
0070e38d : ADD EDI,ECX
0070e38f : ADD ESI,0x10
0070e392 : SUB EDX,0x1
0070e395 : JNZ 0x0070e310
0070e39b : MOV EBX,dword ptr [EBP + 0x8]
0070e39e : TEST EAX,EAX
0070e3a0 : JZ 0x0070e3af
0070e3a2 : MOVZX EDX,byte ptr [ESI]
0070e3a5 : ADD ECX,EDX
0070e3a7 : INC ESI
0070e3a8 : ADD EDI,ECX
0070e3aa : SUB EAX,0x1
0070e3ad : JNZ 0x0070e3a2
0070e3af : MOV EAX,0x80078071
0070e3b4 : MUL ECX
0070e3b6 : SHR EDX,0xf
0070e3b9 : IMUL EDX,EDX,-0xfff1
0070e3bf : ADD ECX,EDX
0070e3c1 : MOV EAX,0x80078071
0070e3c6 : MUL EDI
0070e3c8 : SHR EDX,0xf
0070e3cb : IMUL EDX,EDX,-0xfff1
0070e3d1 : ADD EDI,EDX
0070e3d3 : TEST EBX,EBX
0070e3d5 : JA 0x0070e2e0
0070e3db : MOV EAX,EDI
0070e3dd : POP EDI
0070e3de : SHL EAX,0x10
0070e3e1 : POP ESI
0070e3e2 : OR EAX,ECX
0070e3e4 : POP EBX
0070e3e5 : POP EBP
0070e3e6 : RET

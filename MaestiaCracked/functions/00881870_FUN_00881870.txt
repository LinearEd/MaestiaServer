PROGRAM  : Maestia.exe
FUNCTION : FUN_00881870
ENTRY    : 00881870
BODY     : [[00881870, 008819d3]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00881870(int param_1,undefined4 param_2,undefined4 param_3)

{
  uint uVar1;
  int iVar2;
  DWORD DVar3;
  int iVar4;
  int local_8c;
  uint local_88;
  char local_81;
  undefined1 local_80 [4];
  uint local_7c;
  undefined4 local_74;
  undefined4 local_70;
  undefined1 local_2b;
  undefined4 local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b6360a;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar2 = FUN_008806a0(local_14);
  if (iVar2 != 0) {
    *(undefined4 *)(iVar2 + 0xc) = param_3;
    DVar3 = timeGetTime();
    *(DWORD *)(iVar2 + 0x18) = DVar3;
    (**(code **)(**(int **)(param_1 + 0x2c) + 0x310))(iVar2,1);
    iVar4 = DAT_00d7c54c;
    uVar1 = *(uint *)(iVar2 + 8);
    local_88 = uVar1;
    FUN_004437f0(&local_88);
    if ((local_8c != *(int *)(iVar4 + 0x44)) && (iVar2 = *(int *)(local_8c + 0x10), iVar2 != 0)) {
      local_81 = '\0';
      if (((uVar1 >> 0x10 == 0x1410) && (iVar4 = FUN_004049b0(uVar1), iVar4 != 0)) &&
         (((*(char *)(iVar4 + 0x1a4) != '\x02' && (*(char *)(iVar4 + 0x1a4) != '\x04')) ||
          (local_81 = '\x01', *(int *)(iVar4 + 0x1ac) < 1)))) {
        local_81 = '\0';
      }
      FUN_0040e250(local_80);
      local_8 = 0;
      local_74 = *(undefined4 *)(*(int *)(param_1 + 0x2c) + 4);
      local_70 = param_2;
      local_2b = 0;
      local_80[0] = 0xff;
      if (((*(byte *)(iVar2 + 0x144) & 1) != 0) || (local_18 = 0x11, local_81 == '\x01')) {
        local_18 = 0xe;
      }
      local_7c = uVar1;
      FUN_00883670(DAT_017248e4);
      local_8 = 0xffffffff;
      FUN_00406bd0(local_80);
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00881870 : PUSH EBP
00881871 : MOV EBP,ESP
00881873 : PUSH -0x1
00881875 : PUSH 0xb6360a
0088187a : MOV EAX,FS:[0x0]
00881880 : PUSH EAX
00881881 : SUB ESP,0x7c
00881884 : MOV EAX,[0x00d66fa0]
00881889 : XOR EAX,EBP
0088188b : MOV dword ptr [EBP + -0x10],EAX
0088188e : PUSH EBX
0088188f : PUSH ESI
00881890 : PUSH EDI
00881891 : PUSH EAX
00881892 : LEA EAX,[EBP + -0xc]
00881895 : MOV FS:[0x0],EAX
0088189b : MOV EBX,dword ptr [EBP + 0x8]
0088189e : MOV EDI,ECX
008818a0 : MOV ECX,EBX
008818a2 : CALL 0x008806a0
008818a7 : MOV ESI,EAX
008818a9 : TEST ESI,ESI
008818ab : JZ 0x008819b6
008818b1 : MOV EAX,dword ptr [EBP + 0x10]
008818b4 : MOV dword ptr [ESI + 0xc],EAX
008818b7 : CALL dword ptr [0x00b85598]
008818bd : MOV dword ptr [ESI + 0x18],EAX
008818c0 : MOV ECX,dword ptr [EBX + 0x2c]
008818c3 : MOV EDX,dword ptr [ECX]
008818c5 : MOV EAX,dword ptr [EDX + 0x310]
008818cb : PUSH 0x1
008818cd : PUSH ESI
008818ce : CALL EAX
008818d0 : MOV EDI,dword ptr [0x00d7c54c]
008818d6 : MOV ESI,dword ptr [ESI + 0x8]
008818d9 : LEA ECX,[EBP + 0xffffff7c]
008818df : PUSH ECX
008818e0 : LEA ECX,[EDI + 0x40]
008818e3 : LEA EAX,[EBP + 0xffffff78]
008818e9 : MOV dword ptr [EBP + 0xffffff7c],ESI
008818ef : CALL 0x004437f0
008818f4 : MOV EDI,dword ptr [EDI + 0x44]
008818f7 : MOV EAX,dword ptr [EBP + 0xffffff78]
008818fd : CMP EAX,EDI
008818ff : JZ 0x008819b4
00881905 : MOV EDI,dword ptr [EAX + 0x10]
00881908 : TEST EDI,EDI
0088190a : JZ 0x008819b4
00881910 : MOV EDX,ESI
00881912 : SHR EDX,0x10
00881915 : MOV byte ptr [EBP + -0x7d],0x0
00881919 : CMP EDX,0x1410
0088191f : JNZ 0x0088194f
00881921 : PUSH ESI
00881922 : CALL 0x004049b0
00881927 : ADD ESP,0x4
0088192a : TEST EAX,EAX
0088192c : JZ 0x0088194f
0088192e : MOV CL,byte ptr [EAX + 0x1a4]
00881934 : CMP CL,0x2
00881937 : JZ 0x0088193e
00881939 : CMP CL,0x4
0088193c : JNZ 0x0088194b
0088193e : CMP dword ptr [EAX + 0x1ac],0x0
00881945 : MOV byte ptr [EBP + -0x7d],0x1
00881949 : JG 0x0088194f
0088194b : MOV byte ptr [EBP + -0x7d],0x0
0088194f : LEA EAX,[EBP + -0x7c]
00881952 : PUSH EAX
00881953 : CALL 0x0040e250
00881958 : MOV dword ptr [EBP + -0x4],0x0
0088195f : TEST byte ptr [EDI + 0x144],0x1
00881966 : MOV ECX,dword ptr [EBX + 0x2c]
00881969 : MOV EAX,dword ptr [ECX + 0x4]
0088196c : MOV EDX,dword ptr [EBP + 0xc]
0088196f : MOV dword ptr [EBP + -0x70],EAX
00881972 : MOV dword ptr [EBP + -0x6c],EDX
00881975 : MOV dword ptr [EBP + -0x78],ESI
00881978 : MOV byte ptr [EBP + -0x27],0x0
0088197c : MOV byte ptr [EBP + -0x7c],0xff
00881980 : JNZ 0x0088198f
00881982 : CMP byte ptr [EBP + -0x7d],0x1
00881986 : MOV dword ptr [EBP + -0x14],0x11
0088198d : JNZ 0x00881996
0088198f : MOV dword ptr [EBP + -0x14],0xe
00881996 : MOV EAX,[0x017248e4]
0088199b : PUSH EAX
0088199c : LEA ECX,[EBP + -0x7c]
0088199f : CALL 0x00883670
008819a4 : MOV dword ptr [EBP + -0x4],0xffffffff
008819ab : LEA ECX,[EBP + -0x7c]
008819ae : PUSH ECX
008819af : CALL 0x00406bd0
008819b4 : MOV EAX,ESI
008819b6 : MOV ECX,dword ptr [EBP + -0xc]
008819b9 : MOV dword ptr FS:[0x0],ECX
008819c0 : POP ECX
008819c1 : POP EDI
008819c2 : POP ESI
008819c3 : POP EBX
008819c4 : MOV ECX,dword ptr [EBP + -0x10]
008819c7 : XOR ECX,EBP
008819c9 : CALL 0x00633e6b
008819ce : MOV ESP,EBP
008819d0 : POP EBP
008819d1 : RET 0xc

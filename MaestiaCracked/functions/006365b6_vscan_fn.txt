PROGRAM  : Maestia.exe
FUNCTION : vscan_fn
ENTRY    : 006365b6
BODY     : [[006365b6, 0063661f]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    _vscan_fn
   
   Library: Visual Studio 2008 Release */

undefined4 __cdecl vscan_fn(code *param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  int *piVar1;
  undefined4 uVar2;
  char *unaff_ESI;
  
  _strlen(unaff_ESI);
  if ((unaff_ESI == (char *)0x0) || (param_2 == 0)) {
    piVar1 = __errno();
    *piVar1 = 0x16;
    __invalid_parameter(0,0,0,0,0);
    uVar2 = 0xffffffff;
  }
  else {
    uVar2 = (*param_1)(&stack0xffffffdc,param_2,param_3,param_4);
  }
  return uVar2;
}



============================================================
DISASSEMBLY
============================================================
006365b6 : MOV EDI,EDI
006365b8 : PUSH EBP
006365b9 : MOV EBP,ESP
006365bb : SUB ESP,0x20
006365be : PUSH EDI
006365bf : PUSH ESI
006365c0 : CALL 0x00640960
006365c5 : XOR EDI,EDI
006365c7 : POP ECX
006365c8 : CMP ESI,EDI
006365ca : JNZ 0x006365e9
006365cc : CALL 0x0063ab82
006365d1 : PUSH EDI
006365d2 : PUSH EDI
006365d3 : PUSH EDI
006365d4 : PUSH EDI
006365d5 : PUSH EDI
006365d6 : MOV dword ptr [EAX],0x16
006365dc : CALL 0x006372b8
006365e1 : ADD ESP,0x14
006365e4 : OR EAX,0xffffffff
006365e7 : JMP 0x0063661d
006365e9 : CMP dword ptr [EBP + 0xc],EDI
006365ec : JZ 0x006365cc
006365ee : MOV ECX,0x7fffffff
006365f3 : MOV dword ptr [EBP + -0x14],0x49
006365fa : MOV dword ptr [EBP + -0x18],ESI
006365fd : MOV dword ptr [EBP + -0x20],ESI
00636600 : MOV dword ptr [EBP + -0x1c],ECX
00636603 : CMP EAX,ECX
00636605 : JA 0x0063660a
00636607 : MOV dword ptr [EBP + -0x1c],EAX
0063660a : PUSH dword ptr [EBP + 0x14]
0063660d : LEA EAX,[EBP + -0x20]
00636610 : PUSH dword ptr [EBP + 0x10]
00636613 : PUSH dword ptr [EBP + 0xc]
00636616 : PUSH EAX
00636617 : CALL dword ptr [EBP + 0x8]
0063661a : ADD ESP,0x10
0063661d : POP EDI
0063661e : LEAVE
0063661f : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_0043f500
ENTRY    : 0043f500
BODY     : [[0043f500, 0043f635] [0043f647, 0043f707]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0043f500(uint param_1,undefined8 *param_2)

{
  undefined8 *puVar1;
  int iVar2;
  undefined8 *puVar3;
  undefined4 uVar4;
  uint uVar5;
  uint extraout_ECX;
  int iVar6;
  uint uVar7;
  undefined8 uVar8;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  iVar2 = param_1;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7e220;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  iVar6 = *(int *)(param_1 + 4);
  if (iVar6 == 0) {
    uVar5 = 0;
  }
  else {
    uVar5 = *(int *)(param_1 + 0xc) - iVar6 >> 4;
  }
  iVar6 = *(int *)(param_1 + 8) - iVar6 >> 4;
  uVar8 = CONCAT44(iVar6,*(int *)(param_1 + 8));
  if (iVar6 == 0xfffffff) {
    uVar8 = FUN_00429be0();
    uVar5 = extraout_ECX;
  }
  puVar3 = (undefined8 *)uVar8;
  uVar7 = (int)((ulonglong)uVar8 >> 0x20) + 1;
  if (uVar5 < uVar7) {
    if (0xfffffff - (uVar5 >> 1) < uVar5) {
      param_1 = 0;
    }
    else {
      param_1 = uVar5 + (uVar5 >> 1);
    }
    if (param_1 < uVar7) {
      param_1 = uVar7;
    }
    iVar6 = FUN_00424e80();
    local_8 = 0;
    FUN_0043f480();
    FUN_0043fa30(*(undefined4 *)(iVar2 + 4),param_2);
    FUN_0043fa30(param_2,*(undefined4 *)(iVar2 + 8));
    local_8 = 0xffffffff;
    if (*(int *)(iVar2 + 4) != 0) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    *(uint *)(iVar2 + 0xc) = param_1 * 0x10 + iVar6;
    *(int *)(iVar2 + 8) = ((*(int *)(iVar2 + 8) - *(int *)(iVar2 + 4) >> 4) + 1) * 0x10 + iVar6;
    *(int *)(iVar2 + 4) = iVar6;
    ExceptionList = local_10;
    return;
  }
  if ((int)puVar3 - (int)param_2 >> 4 == 0) {
    FUN_0043fa30(param_2,puVar3);
    local_8 = 2;
    FUN_0043f480();
    local_8 = 0xffffffff;
    *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 0x10;
  }
  else {
    uVar4 = FUN_0043fa30(puVar3 + -2,puVar3);
    *(undefined4 *)(param_1 + 8) = uVar4;
    puVar1 = puVar3 + -2;
    while (param_2 != puVar1) {
      puVar3[-2] = puVar1[-2];
      puVar3[-1] = puVar1[-1];
      puVar1 = puVar1 + -2;
      puVar3 = puVar3 + -2;
    }
  }
  FUN_004cb8f0(param_2);
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
0043f500 : PUSH EBP
0043f501 : MOV EBP,ESP
0043f503 : PUSH -0x1
0043f505 : PUSH 0xb7e220
0043f50a : MOV EAX,FS:[0x0]
0043f510 : PUSH EAX
0043f511 : SUB ESP,0x24
0043f514 : PUSH EBX
0043f515 : PUSH ESI
0043f516 : PUSH EDI
0043f517 : MOV EAX,[0x00d66fa0]
0043f51c : XOR EAX,EBP
0043f51e : PUSH EAX
0043f51f : LEA EAX,[EBP + -0xc]
0043f522 : MOV FS:[0x0],EAX
0043f528 : MOV dword ptr [EBP + -0x10],ESP
0043f52b : MOV ESI,ECX
0043f52d : MOV EBX,dword ptr [EBP + 0x8]
0043f530 : MOV EDI,dword ptr [EBX + 0x4]
0043f533 : TEST EDI,EDI
0043f535 : JNZ 0x0043f53b
0043f537 : XOR ECX,ECX
0043f539 : JMP 0x0043f545
0043f53b : MOV EAX,dword ptr [EBX + 0xc]
0043f53e : SUB EAX,EDI
0043f540 : SAR EAX,0x4
0043f543 : MOV ECX,EAX
0043f545 : MOV EAX,dword ptr [EBX + 0x8]
0043f548 : MOV EDX,EAX
0043f54a : SUB EDX,EDI
0043f54c : SAR EDX,0x4
0043f54f : MOV EDI,0xfffffff
0043f554 : SUB EDI,EDX
0043f556 : CMP EDI,0x1
0043f559 : JNC 0x0043f560
0043f55b : CALL 0x00429be0
0043f560 : INC EDX
0043f561 : CMP ECX,EDX
0043f563 : JNC 0x0043f647
0043f569 : MOV EAX,ECX
0043f56b : SHR EAX,0x1
0043f56d : MOV EDI,0xfffffff
0043f572 : SUB EDI,EAX
0043f574 : CMP EDI,ECX
0043f576 : JNC 0x0043f584
0043f578 : MOV dword ptr [EBP + 0x8],0x0
0043f57f : MOV ECX,dword ptr [EBP + 0x8]
0043f582 : JMP 0x0043f589
0043f584 : ADD ECX,EAX
0043f586 : MOV dword ptr [EBP + 0x8],ECX
0043f589 : CMP ECX,EDX
0043f58b : JNC 0x0043f592
0043f58d : MOV dword ptr [EBP + 0x8],EDX
0043f590 : MOV ECX,EDX
0043f592 : CALL 0x00424e80
0043f597 : MOV dword ptr [EBP + -0x14],EAX
0043f59a : MOV EDI,dword ptr [EBP + 0xc]
0043f59d : SUB EDI,dword ptr [EBX + 0x4]
0043f5a0 : SAR EDI,0x4
0043f5a3 : MOV dword ptr [EBP + -0x1c],EDI
0043f5a6 : MOV dword ptr [EBP + -0x4],0x0
0043f5ad : SHL EDI,0x4
0043f5b0 : ADD EDI,EAX
0043f5b2 : MOV EDX,ESI
0043f5b4 : MOV ESI,0x1
0043f5b9 : CALL 0x0043f480
0043f5be : MOV dword ptr [EBP + -0x18],ESI
0043f5c1 : MOV EAX,dword ptr [EBP + 0xc]
0043f5c4 : PUSH EAX
0043f5c5 : MOV ECX,dword ptr [EBX + 0x4]
0043f5c8 : PUSH ECX
0043f5c9 : MOV EDI,dword ptr [EBP + -0x14]
0043f5cc : MOV EDX,EDI
0043f5ce : CALL 0x0043fa30
0043f5d3 : MOV dword ptr [EBP + -0x18],0x2
0043f5da : MOV EDX,dword ptr [EBP + -0x1c]
0043f5dd : INC EDX
0043f5de : SHL EDX,0x4
0043f5e1 : ADD EDX,EDI
0043f5e3 : MOV EAX,dword ptr [EBX + 0x8]
0043f5e6 : PUSH EAX
0043f5e7 : MOV ECX,dword ptr [EBP + 0xc]
0043f5ea : PUSH ECX
0043f5eb : CALL 0x0043fa30
0043f5f0 : MOV dword ptr [EBP + -0x4],0xffffffff
0043f5f7 : MOV ECX,dword ptr [EBX + 0x4]
0043f5fa : MOV ESI,dword ptr [EBX + 0x8]
0043f5fd : SUB ESI,ECX
0043f5ff : SAR ESI,0x4
0043f602 : INC ESI
0043f603 : TEST ECX,ECX
0043f605 : JZ 0x0043f60c
0043f607 : CALL 0x006f04e0
0043f60c : MOV EAX,dword ptr [EBP + 0x8]
0043f60f : SHL EAX,0x4
0043f612 : ADD EAX,EDI
0043f614 : MOV dword ptr [EBX + 0xc],EAX
0043f617 : SHL ESI,0x4
0043f61a : ADD ESI,EDI
0043f61c : MOV dword ptr [EBX + 0x8],ESI
0043f61f : MOV dword ptr [EBX + 0x4],EDI
0043f622 : MOV ECX,dword ptr [EBP + -0xc]
0043f625 : MOV dword ptr FS:[0x0],ECX
0043f62c : POP ECX
0043f62d : POP EDI
0043f62e : POP ESI
0043f62f : POP EBX
0043f630 : MOV ESP,EBP
0043f632 : POP EBP
0043f633 : RET 0x8
0043f647 : MOV EDX,EAX
0043f649 : MOV ECX,dword ptr [EBP + 0xc]
0043f64c : SUB EDX,ECX
0043f64e : SAR EDX,0x4
0043f651 : MOVQ XMM0,qword ptr [ESI]
0043f655 : PUSH EAX
0043f656 : MOVQ qword ptr [EBP + -0x2c],XMM0
0043f65b : MOVQ XMM0,qword ptr [ESI + 0x8]
0043f660 : MOVQ qword ptr [EBP + -0x24],XMM0
0043f665 : CMP EDX,0x1
0043f668 : JNC 0x0043f6aa
0043f66a : LEA EDX,[ECX + 0x10]
0043f66d : PUSH ECX
0043f66e : CALL 0x0043fa30
0043f673 : MOV dword ptr [EBP + -0x4],0x2
0043f67a : MOV EDI,dword ptr [EBX + 0x8]
0043f67d : MOV EAX,EDI
0043f67f : SUB EAX,dword ptr [EBP + 0xc]
0043f682 : SAR EAX,0x4
0043f685 : MOV ESI,0x1
0043f68a : SUB ESI,EAX
0043f68c : LEA EDX,[EBP + -0x2c]
0043f68f : CALL 0x0043f480
0043f694 : MOV dword ptr [EBP + -0x4],0xffffffff
0043f69b : ADD dword ptr [EBX + 0x8],0x10
0043f69f : MOV EBX,dword ptr [EBX + 0x8]
0043f6a2 : LEA EDX,[EBX + -0x10]
0043f6a5 : MOV ECX,dword ptr [EBP + 0xc]
0043f6a8 : JMP 0x0043f6e8
0043f6aa : LEA ESI,[EAX + -0x10]
0043f6ad : PUSH ESI
0043f6ae : MOV EDX,EAX
0043f6b0 : CALL 0x0043fa30
0043f6b5 : MOV dword ptr [EBX + 0x8],EAX
0043f6b8 : MOV EAX,ESI
0043f6ba : MOV ECX,dword ptr [EBP + 0xc]
0043f6bd : MOV EDX,ECX
0043f6bf : CMP ECX,EAX
0043f6c1 : JZ 0x0043f6e5
0043f6c3 : LEA ECX,[EAX + 0x10]
0043f6c6 : SUB EAX,0x10
0043f6c9 : SUB ECX,0x10
0043f6cc : MOVQ XMM0,qword ptr [EAX]
0043f6d0 : MOVQ qword ptr [ECX],XMM0
0043f6d4 : MOVQ XMM0,qword ptr [EAX + 0x8]
0043f6d9 : MOVQ qword ptr [ECX + 0x8],XMM0
0043f6de : CMP EAX,EDX
0043f6e0 : JNZ 0x0043f6c6
0043f6e2 : MOV ECX,dword ptr [EBP + 0xc]
0043f6e5 : LEA EDX,[ECX + 0x10]
0043f6e8 : PUSH ECX
0043f6e9 : LEA ECX,[EBP + -0x2c]
0043f6ec : CALL 0x004cb8f0
0043f6f1 : ADD ESP,0x4
0043f6f4 : MOV ECX,dword ptr [EBP + -0xc]
0043f6f7 : MOV dword ptr FS:[0x0],ECX
0043f6fe : POP ECX
0043f6ff : POP EDI
0043f700 : POP ESI
0043f701 : POP EBX
0043f702 : MOV ESP,EBP
0043f704 : POP EBP
0043f705 : RET 0x8

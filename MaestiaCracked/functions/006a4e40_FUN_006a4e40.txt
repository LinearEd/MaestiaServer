PROGRAM  : Maestia.exe
FUNCTION : FUN_006a4e40
ENTRY    : 006a4e40
BODY     : [[006a4e40, 006a4eb8]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006a4e40(undefined4 param_1,undefined4 *param_2)

{
  uint in_EAX;
  uint uVar1;
  void *unaff_EBX;
  void *_Dst;
  int local_4;
  
  _Dst = (void *)0x0;
  local_4 = 0;
  if ((in_EAX != 0) && (*(char *)((int)unaff_EBX + (in_EAX - 1)) == '\0')) {
    in_EAX = in_EAX - 1;
  }
  uVar1 = 0;
  if (in_EAX != 0) {
    do {
      if ((*(byte *)(uVar1 + (int)unaff_EBX) < 0x20) || (0x7f < *(byte *)(uVar1 + (int)unaff_EBX)))
      goto LAB_006a4eab;
      uVar1 = uVar1 + 1;
    } while (uVar1 < in_EAX);
  }
  if (in_EAX != 0) {
    _Dst = (void *)FUN_00688c00(param_1,in_EAX + 1,&local_4);
    if (local_4 == 0) {
      _memcpy(_Dst,unaff_EBX,in_EAX);
      *(undefined1 *)((int)_Dst + in_EAX) = 0;
    }
  }
LAB_006a4eab:
  *param_2 = _Dst;
  return local_4;
}



============================================================
DISASSEMBLY
============================================================
006a4e40 : PUSH ECX
006a4e41 : PUSH ESI
006a4e42 : PUSH EDI
006a4e43 : MOV ESI,EAX
006a4e45 : XOR EDI,EDI
006a4e47 : MOV dword ptr [ESP + 0x8],0x0
006a4e4f : TEST ESI,ESI
006a4e51 : JBE 0x006a4e5b
006a4e53 : CMP byte ptr [EBX + ESI*0x1 + -0x1],0x0
006a4e58 : JNZ 0x006a4e5b
006a4e5a : DEC ESI
006a4e5b : XOR EAX,EAX
006a4e5d : CMP EAX,ESI
006a4e5f : SBB EDX,EDX
006a4e61 : NEG EDX
006a4e63 : TEST ESI,ESI
006a4e65 : JBE 0x006a4e79
006a4e67 : MOV CL,byte ptr [EAX + EBX*0x1]
006a4e6a : CMP CL,0x20
006a4e6d : JC 0x006a4eab
006a4e6f : CMP CL,0x7f
006a4e72 : JA 0x006a4eab
006a4e74 : INC EAX
006a4e75 : CMP EAX,ESI
006a4e77 : JC 0x006a4e67
006a4e79 : TEST EDX,EDX
006a4e7b : JZ 0x006a4eab
006a4e7d : MOV EAX,dword ptr [ESP + 0x10]
006a4e81 : LEA ECX,[ESP + 0x8]
006a4e85 : PUSH ECX
006a4e86 : LEA EDX,[ESI + 0x1]
006a4e89 : PUSH EDX
006a4e8a : PUSH EAX
006a4e8b : CALL 0x00688c00
006a4e90 : ADD ESP,0xc
006a4e93 : CMP dword ptr [ESP + 0x8],0x0
006a4e98 : MOV EDI,EAX
006a4e9a : JNZ 0x006a4eab
006a4e9c : PUSH ESI
006a4e9d : PUSH EBX
006a4e9e : PUSH EDI
006a4e9f : CALL 0x0063ae40
006a4ea4 : ADD ESP,0xc
006a4ea7 : MOV byte ptr [EDI + ESI*0x1],0x0
006a4eab : MOV ECX,dword ptr [ESP + 0x14]
006a4eaf : MOV EAX,dword ptr [ESP + 0x8]
006a4eb3 : MOV dword ptr [ECX],EDI
006a4eb5 : POP EDI
006a4eb6 : POP ESI
006a4eb7 : POP ECX
006a4eb8 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00891fd0
ENTRY    : 00891fd0
BODY     : [[00891fd0, 008922de]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00891fd0(void)

{
  int *piVar1;
  code *pcVar2;
  float fVar3;
  char cVar4;
  short sVar5;
  DWORD DVar6;
  uint uVar7;
  int *unaff_ESI;
  float local_18;
  float local_14;
  float local_10;
  float local_c;
  undefined1 local_5;
  
  if (((char)unaff_ESI[0x518] != '\0') && (unaff_ESI[0xfa] != 0)) {
    if (*(char *)((int)unaff_ESI + 0x425) != '\0') {
      *(undefined2 *)(unaff_ESI + 0x51b) = 0;
      pcVar2 = *(code **)(*unaff_ESI + 0x2a0);
      *(undefined1 *)(unaff_ESI + 0x518) = 0;
      unaff_ESI[0x519] = 0;
      unaff_ESI[0x51a] = 0;
      (*pcVar2)(unaff_ESI + 0x510,1);
      unaff_ESI[0x510] = DAT_01720f20;
      unaff_ESI[0x511] = DAT_01720f24;
      unaff_ESI[0x512] = DAT_01720f28;
      (**(code **)(*unaff_ESI + 0x284))();
      return;
    }
    DVar6 = timeGetTime();
    uVar7 = DVar6 - unaff_ESI[0x517];
    if (uVar7 < 1000000) {
      local_c = (float)(int)uVar7;
      if ((int)uVar7 < 0) {
        local_c = local_c + 4.2949673e+09;
      }
      fVar3 = (float)unaff_ESI[0x516];
      if (unaff_ESI[0x516] < 0) {
        fVar3 = fVar3 + 4.2949673e+09;
      }
      local_c = local_c / fVar3;
      if (local_c <= 1.0) {
        local_18 = (float)unaff_ESI[0x50d] + (float)unaff_ESI[0x513] * local_c;
        local_14 = (float)unaff_ESI[0x50e] + (float)unaff_ESI[0x514] * local_c;
        local_10 = (float)unaff_ESI[0x50f] + (float)unaff_ESI[0x515] * local_c;
        local_5 = 0xff;
        cVar4 = FUN_00891380(unaff_ESI,local_18,local_10,&local_14,&local_5,0,1);
        if (cVar4 != '\0') {
          sVar5 = (**(code **)(*unaff_ESI + 0x1e4))();
          if (sVar5 == 0) {
            cVar4 = (**(code **)(*unaff_ESI + 0x188))(0x28,0,0,0,0,0x3f800000);
            if ((cVar4 == '\0') && (*(short *)((int)unaff_ESI + 0x43a) != 0x28)) {
              (**(code **)(*unaff_ESI + 0x188))(7,1,0,0,0,0x3f800000);
            }
          }
          else {
            (**(code **)(*unaff_ESI + 0x188))(7,1,0,0,0,0x3f800000);
            (**(code **)(*unaff_ESI + 0x254))(1,unaff_ESI + 1,1);
          }
          FUN_0079c400(0x42a00000);
          (**(code **)(*unaff_ESI + 0x254))(1,unaff_ESI + 1,0);
          (**(code **)(*unaff_ESI + 0x2a0))(&local_18,1);
        }
      }
      else {
        *(undefined1 *)(unaff_ESI + 0x518) = 0;
        (**(code **)(*(int *)(*(int *)(unaff_ESI[0x4e] + 4) + 0x138 + (int)unaff_ESI) + 0x10))
                  (unaff_ESI + 0x1b6,1,1,0);
        piVar1 = unaff_ESI + 0x510;
        (**(code **)(*unaff_ESI + 0x2a0))(piVar1,1);
        unaff_ESI[0x560] = *piVar1;
        unaff_ESI[0x561] = unaff_ESI[0x511];
        unaff_ESI[0x562] = unaff_ESI[0x512];
        *piVar1 = DAT_01720f20;
        unaff_ESI[0x511] = DAT_01720f24;
        unaff_ESI[0x512] = DAT_01720f28;
        (**(code **)(*unaff_ESI + 0x338))(1);
        if ((unaff_ESI[0x519] != 0) && (unaff_ESI[0x51a] != 0)) {
          (**(code **)(*unaff_ESI + 0x35c))
                    (unaff_ESI[0x519],unaff_ESI[0x51a],(short)unaff_ESI[0x51b],0);
          unaff_ESI[0x519] = 0;
          unaff_ESI[0x51a] = 0;
          *(undefined2 *)(unaff_ESI + 0x51b) = 0;
          return;
        }
      }
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00891fd0 : PUSH EBP
00891fd1 : MOV EBP,ESP
00891fd3 : SUB ESP,0x20
00891fd6 : PUSH EBX
00891fd7 : XOR EBX,EBX
00891fd9 : CMP byte ptr [ESI + 0x1460],BL
00891fdf : JZ 0x008922da
00891fe5 : CMP dword ptr [ESI + 0x3e8],EBX
00891feb : JZ 0x008922da
00891ff1 : PUSH EDI
00891ff2 : CMP byte ptr [ESI + 0x425],BL
00891ff8 : JZ 0x00892062
00891ffa : MOV EDX,dword ptr [ESI]
00891ffc : XOR EAX,EAX
00891ffe : PUSH 0x1
00892000 : MOV word ptr [ESI + 0x146c],AX
00892007 : MOV EAX,dword ptr [EDX + 0x2a0]
0089200d : LEA EDI,[ESI + 0x1440]
00892013 : PUSH EDI
00892014 : MOV ECX,ESI
00892016 : MOV byte ptr [ESI + 0x1460],BL
0089201c : MOV dword ptr [ESI + 0x1464],EBX
00892022 : MOV dword ptr [ESI + 0x1468],EBX
00892028 : CALL EAX
0089202a : MOVSS XMM0,dword ptr [0x01720f20]
00892032 : MOVSS dword ptr [EDI],XMM0
00892036 : MOVSS XMM0,dword ptr [0x01720f24]
0089203e : MOVSS dword ptr [EDI + 0x4],XMM0
00892043 : MOVSS XMM0,dword ptr [0x01720f28]
0089204b : MOVSS dword ptr [EDI + 0x8],XMM0
00892050 : MOV EDX,dword ptr [ESI]
00892052 : MOV EAX,dword ptr [EDX + 0x284]
00892058 : MOV ECX,ESI
0089205a : CALL EAX
0089205c : POP EDI
0089205d : POP EBX
0089205e : MOV ESP,EBP
00892060 : POP EBP
00892061 : RET
00892062 : CALL dword ptr [0x00b85598]
00892068 : SUB EAX,dword ptr [ESI + 0x145c]
0089206e : CMP EAX,0xf423f
00892073 : JA 0x008922d9
00892079 : MOV dword ptr [EBP + -0x8],EAX
0089207c : FILD dword ptr [EBP + -0x8]
0089207f : TEST EAX,EAX
00892081 : JGE 0x00892089
00892083 : FADD float ptr [0x00cdf0e0]
00892089 : MOV ECX,dword ptr [ESI + 0x1458]
0089208f : FILD dword ptr [ESI + 0x1458]
00892095 : TEST ECX,ECX
00892097 : JGE 0x0089209f
00892099 : FADD float ptr [0x00cdf0e0]
0089209f : FDIVP
008920a1 : FST float ptr [EBP + -0x8]
008920a4 : FLD1
008920a6 : FXCH
008920a8 : FCOMIP ST0,ST1
008920aa : FSTP ST0
008920ac : JBE 0x00892191
008920b2 : MOV EDX,dword ptr [ESI + 0x138]
008920b8 : MOV byte ptr [ESI + 0x1460],BL
008920be : MOV EAX,dword ptr [EDX + 0x4]
008920c1 : MOV EDX,dword ptr [EAX + ESI*0x1 + 0x138]
008920c8 : MOV EDX,dword ptr [EDX + 0x10]
008920cb : PUSH EBX
008920cc : LEA ECX,[EAX + ESI*0x1 + 0x138]
008920d3 : PUSH 0x1
008920d5 : PUSH 0x1
008920d7 : LEA EAX,[ESI + 0x6d8]
008920dd : PUSH EAX
008920de : CALL EDX
008920e0 : MOV EAX,dword ptr [ESI]
008920e2 : MOV EDX,dword ptr [EAX + 0x2a0]
008920e8 : PUSH 0x1
008920ea : LEA EDI,[ESI + 0x1440]
008920f0 : PUSH EDI
008920f1 : MOV ECX,ESI
008920f3 : CALL EDX
008920f5 : FLD float ptr [EDI]
008920f7 : FSTP float ptr [ESI + 0x1580]
008920fd : PUSH 0x1
008920ff : FLD float ptr [EDI + 0x4]
00892102 : MOV ECX,ESI
00892104 : FSTP float ptr [ESI + 0x1584]
0089210a : FLD float ptr [EDI + 0x8]
0089210d : FSTP float ptr [ESI + 0x1588]
00892113 : MOVSS XMM0,dword ptr [0x01720f20]
0089211b : MOVSS dword ptr [EDI],XMM0
0089211f : MOVSS XMM0,dword ptr [0x01720f24]
00892127 : MOVSS dword ptr [EDI + 0x4],XMM0
0089212c : MOVSS XMM0,dword ptr [0x01720f28]
00892134 : MOVSS dword ptr [EDI + 0x8],XMM0
00892139 : MOV EAX,dword ptr [ESI]
0089213b : MOV EDX,dword ptr [EAX + 0x338]
00892141 : CALL EDX
00892143 : MOV EAX,dword ptr [ESI + 0x1464]
00892149 : CMP EAX,EBX
0089214b : JZ 0x008922d9
00892151 : MOV ECX,dword ptr [ESI + 0x1468]
00892157 : CMP ECX,EBX
00892159 : JZ 0x008922d9
0089215f : MOVZX EDI,word ptr [ESI + 0x146c]
00892166 : MOV EDX,dword ptr [ESI]
00892168 : PUSH EBX
00892169 : PUSH EDI
0089216a : PUSH ECX
0089216b : PUSH EAX
0089216c : MOV EAX,dword ptr [EDX + 0x35c]
00892172 : MOV ECX,ESI
00892174 : CALL EAX
00892176 : XOR ECX,ECX
00892178 : POP EDI
00892179 : MOV dword ptr [ESI + 0x1464],EBX
0089217f : MOV dword ptr [ESI + 0x1468],EBX
00892185 : MOV word ptr [ESI + 0x146c],CX
0089218c : POP EBX
0089218d : MOV ESP,EBP
0089218f : POP EBP
00892190 : RET
00892191 : MOVSS XMM3,dword ptr [EBP + -0x8]
00892196 : MOVSS XMM0,dword ptr [ESI + 0x144c]
0089219e : MOVSS XMM1,dword ptr [ESI + 0x1450]
008921a6 : MOVSS XMM2,dword ptr [ESI + 0x1454]
008921ae : MULSS XMM1,XMM3
008921b2 : MULSS XMM0,XMM3
008921b6 : PUSH 0x1
008921b8 : MULSS XMM2,XMM3
008921bc : MOVSS XMM3,dword ptr [ESI + 0x1434]
008921c4 : ADDSS XMM3,XMM0
008921c8 : MOVSS XMM0,dword ptr [ESI + 0x1438]
008921d0 : PUSH EBX
008921d1 : ADDSS XMM0,XMM1
008921d5 : MOVSS XMM1,dword ptr [ESI + 0x143c]
008921dd : LEA EDX,[EBP + -0x1]
008921e0 : PUSH EDX
008921e1 : ADDSS XMM1,XMM2
008921e5 : LEA EAX,[EBP + -0x10]
008921e8 : PUSH EAX
008921e9 : MOVSS dword ptr [EBP + -0x18],XMM1
008921ee : FLD float ptr [EBP + -0x18]
008921f1 : SUB ESP,0x8
008921f4 : FSTP float ptr [ESP + 0x4]
008921f8 : MOVSS dword ptr [EBP + -0x20],XMM3
008921fd : FLD float ptr [EBP + -0x20]
00892200 : MOVSS dword ptr [EBP + -0x14],XMM3
00892205 : FSTP float ptr [ESP]
00892208 : PUSH ESI
00892209 : MOVSS dword ptr [EBP + -0x10],XMM0
0089220e : MOVSS dword ptr [EBP + -0xc],XMM1
00892213 : MOV byte ptr [EBP + -0x1],0xff
00892217 : CALL 0x00891380
0089221c : TEST AL,AL
0089221e : JZ 0x008922d9
00892224 : MOV EDX,dword ptr [ESI]
00892226 : MOV EAX,dword ptr [EDX + 0x1e4]
0089222c : MOV ECX,ESI
0089222e : CALL EAX
00892230 : FLD1
00892232 : MOV EDX,dword ptr [ESI]
00892234 : PUSH ECX
00892235 : FSTP float ptr [ESP]
00892238 : PUSH EBX
00892239 : PUSH EBX
0089223a : TEST AX,AX
0089223d : MOV EAX,dword ptr [EDX + 0x188]
00892243 : MOV ECX,ESI
00892245 : PUSH EBX
00892246 : JNZ 0x00892276
00892248 : PUSH EBX
00892249 : PUSH 0x28
0089224b : CALL EAX
0089224d : TEST AL,AL
0089224f : JNZ 0x00892290
00892251 : CMP word ptr [ESI + 0x43a],0x28
00892259 : JZ 0x00892290
0089225b : FLD1
0089225d : MOV EDX,dword ptr [ESI]
0089225f : MOV EAX,dword ptr [EDX + 0x188]
00892265 : PUSH ECX
00892266 : FSTP float ptr [ESP]
00892269 : PUSH EBX
0089226a : PUSH EBX
0089226b : PUSH EBX
0089226c : PUSH 0x1
0089226e : PUSH 0x7
00892270 : MOV ECX,ESI
00892272 : CALL EAX
00892274 : JMP 0x00892290
00892276 : PUSH 0x1
00892278 : PUSH 0x7
0089227a : CALL EAX
0089227c : MOV EDX,dword ptr [ESI]
0089227e : MOV EDX,dword ptr [EDX + 0x254]
00892284 : PUSH 0x1
00892286 : LEA EAX,[ESI + 0x4]
00892289 : PUSH EAX
0089228a : PUSH 0x1
0089228c : MOV ECX,ESI
0089228e : CALL EDX
00892290 : MOV EDX,dword ptr [ESI + 0x410]
00892296 : FLD float ptr [0x00cdf4a4]
0089229c : XOR EAX,EAX
0089229e : CMP byte ptr [EDX + 0x12c],BL
008922a4 : PUSH ECX
008922a5 : SETNZ AL
008922a8 : FSTP float ptr [ESP]
008922ab : DEC EAX
008922ac : AND EAX,0x2
008922af : CALL 0x0079c400
008922b4 : MOV EAX,dword ptr [ESI]
008922b6 : MOV EDX,dword ptr [EAX + 0x254]
008922bc : PUSH EBX
008922bd : LEA ECX,[ESI + 0x4]
008922c0 : PUSH ECX
008922c1 : PUSH 0x1
008922c3 : MOV ECX,ESI
008922c5 : CALL EDX
008922c7 : MOV EAX,dword ptr [ESI]
008922c9 : MOV EDX,dword ptr [EAX + 0x2a0]
008922cf : PUSH 0x1
008922d1 : LEA ECX,[EBP + -0x14]
008922d4 : PUSH ECX
008922d5 : MOV ECX,ESI
008922d7 : CALL EDX
008922d9 : POP EDI
008922da : POP EBX
008922db : MOV ESP,EBP
008922dd : POP EBP
008922de : RET

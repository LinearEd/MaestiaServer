PROGRAM  : Maestia.exe
FUNCTION : FUN_00956bc0
ENTRY    : 00956bc0
BODY     : [[00956bc0, 00956e3b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00956bc0(void)

{
  uint uVar1;
  undefined4 uVar2;
  int in_ECX;
  uint local_50;
  undefined1 local_4c [4];
  undefined2 local_48;
  undefined4 local_38;
  uint local_34;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b2d087;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_14 = uVar1;
  if (*(char *)(*(int *)(in_ECX + 0x38) + 0x60) == '\0') {
    FUN_00406460(L"IDS_PCTRADE_ACCEPT_ERROR");
    local_8 = 0;
    FUN_0081d120(local_4c);
    local_8._0_1_ = 2;
    if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_48 = 0;
    local_34 = 7;
    local_38 = 0;
    (**(code **)(**(int **)(*(int *)(in_ECX + 4) + 0x1a8) + 0x44))(local_30,2,uVar1);
    FUN_00406460(L"IDS_PCTRADE_ACCEPT_ERROR");
    local_8._0_1_ = 3;
    uVar2 = FUN_0081d120(local_4c);
    local_8._0_1_ = 4;
    FUN_0096b1e0(uVar2,0xffff0000,0x12);
    local_8 = CONCAT31(local_8._1_3_,3);
    if (7 < local_50) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_8 = CONCAT31(local_8._1_3_,2);
    if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_34 = 7;
    local_38 = 0;
    local_48 = 0;
    local_8 = 0xffffffff;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c = 0;
  }
  else if (*(char *)(*(int *)(in_ECX + 0x3c) + 0x80) == '\0') {
    FUN_00406460(L"IDS_PCTRADE_ACCEPT_ERROR");
    local_8 = 5;
    FUN_0081d120(local_30);
    local_8._0_1_ = 7;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_2c = 0;
    local_18 = 7;
    local_1c = 0;
    (**(code **)(**(int **)(*(int *)(in_ECX + 4) + 0x1a8) + 0x44))(local_4c,2);
    FUN_00406460(L"IDS_PCTRADE_ACCEPT_ERROR");
    local_8._0_1_ = 8;
    uVar2 = FUN_0081d120(local_30);
    local_8._0_1_ = 9;
    FUN_0096b1e0(uVar2,0xffff0000,0x12);
    local_8 = CONCAT31(local_8._1_3_,8);
    if (7 < local_50) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_8 = CONCAT31(local_8._1_3_,7);
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c = 0;
    local_8 = 0xffffffff;
    if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_34 = 7;
    local_38 = 0;
    local_48 = 0;
  }
  local_8 = 0xffffffff;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00956bc0 : PUSH EBP
00956bc1 : MOV EBP,ESP
00956bc3 : PUSH -0x1
00956bc5 : PUSH 0xb2d087
00956bca : MOV EAX,FS:[0x0]
00956bd0 : PUSH EAX
00956bd1 : SUB ESP,0x58
00956bd4 : MOV EAX,[0x00d66fa0]
00956bd9 : XOR EAX,EBP
00956bdb : MOV dword ptr [EBP + -0x10],EAX
00956bde : PUSH EBX
00956bdf : PUSH ESI
00956be0 : PUSH EDI
00956be1 : PUSH EAX
00956be2 : LEA EAX,[EBP + -0xc]
00956be5 : MOV FS:[0x0],EAX
00956beb : MOV ESI,ECX
00956bed : MOV EAX,dword ptr [ESI + 0x38]
00956bf0 : MOV AL,byte ptr [EAX + 0x60]
00956bf3 : TEST AL,AL
00956bf5 : JNZ 0x00956d09
00956bfb : PUSH 0xc762d0
00956c00 : LEA ECX,[EBP + -0x48]
00956c03 : CALL 0x00406460
00956c08 : MOV dword ptr [EBP + -0x4],0x0
00956c0f : LEA ECX,[EBP + -0x48]
00956c12 : PUSH ECX
00956c13 : MOV ECX,dword ptr [0x0172491c]
00956c19 : LEA EDI,[EBP + -0x2c]
00956c1c : CALL 0x0081d120
00956c21 : MOV byte ptr [EBP + -0x4],0x2
00956c25 : MOV EBX,0x8
00956c2a : CMP dword ptr [EBP + -0x30],EBX
00956c2d : JC 0x00956c37
00956c2f : MOV ECX,dword ptr [EBP + -0x44]
00956c32 : CALL 0x006f04e0
00956c37 : MOV EAX,dword ptr [ESI + 0x4]
00956c3a : MOV ECX,dword ptr [EAX + 0x1a8]
00956c40 : XOR EDX,EDX
00956c42 : MOV word ptr [EBP + -0x44],DX
00956c46 : MOV EDX,dword ptr [ECX]
00956c48 : MOV EDX,dword ptr [EDX + 0x44]
00956c4b : PUSH 0x2
00956c4d : LEA EAX,[EBP + -0x2c]
00956c50 : PUSH EAX
00956c51 : MOV dword ptr [EBP + -0x30],0x7
00956c58 : MOV dword ptr [EBP + -0x34],0x0
00956c5f : CALL EDX
00956c61 : PUSH 0xc76304
00956c66 : LEA ECX,[EBP + -0x48]
00956c69 : CALL 0x00406460
00956c6e : MOV byte ptr [EBP + -0x4],0x3
00956c72 : MOV ECX,dword ptr [0x0172491c]
00956c78 : LEA EAX,[EBP + -0x48]
00956c7b : PUSH EAX
00956c7c : LEA EDI,[EBP + -0x64]
00956c7f : CALL 0x0081d120
00956c84 : MOV byte ptr [EBP + -0x4],0x4
00956c88 : MOV ECX,dword ptr [0x00da9894]
00956c8e : MOV ECX,dword ptr [ECX]
00956c90 : MOV ECX,dword ptr [ECX + 0x134]
00956c96 : PUSH 0x12
00956c98 : PUSH 0xffff0000
00956c9d : PUSH EAX
00956c9e : CALL 0x0096b1e0
00956ca3 : MOV byte ptr [EBP + -0x4],0x3
00956ca7 : CMP dword ptr [EBP + -0x4c],EBX
00956caa : JC 0x00956cb4
00956cac : MOV ECX,dword ptr [EBP + -0x60]
00956caf : CALL 0x006f04e0
00956cb4 : MOV ESI,0x7
00956cb9 : XOR EDI,EDI
00956cbb : XOR EDX,EDX
00956cbd : MOV dword ptr [EBP + -0x4c],ESI
00956cc0 : MOV dword ptr [EBP + -0x50],EDI
00956cc3 : MOV word ptr [EBP + -0x60],DX
00956cc7 : MOV byte ptr [EBP + -0x4],0x2
00956ccb : CMP dword ptr [EBP + -0x30],EBX
00956cce : JC 0x00956cd8
00956cd0 : MOV ECX,dword ptr [EBP + -0x44]
00956cd3 : CALL 0x006f04e0
00956cd8 : XOR EAX,EAX
00956cda : MOV dword ptr [EBP + -0x30],ESI
00956cdd : MOV dword ptr [EBP + -0x34],EDI
00956ce0 : MOV word ptr [EBP + -0x44],AX
00956ce4 : MOV dword ptr [EBP + -0x4],0xffffffff
00956ceb : CMP dword ptr [EBP + -0x14],EBX
00956cee : JC 0x00956cf8
00956cf0 : MOV ECX,dword ptr [EBP + -0x28]
00956cf3 : CALL 0x006f04e0
00956cf8 : XOR ECX,ECX
00956cfa : MOV dword ptr [EBP + -0x14],ESI
00956cfd : MOV dword ptr [EBP + -0x18],EDI
00956d00 : MOV word ptr [EBP + -0x28],CX
00956d04 : JMP 0x00956e20
00956d09 : MOV EDX,dword ptr [ESI + 0x3c]
00956d0c : CMP byte ptr [EDX + 0x80],0x0
00956d13 : JNZ 0x00956e20
00956d19 : PUSH 0xc76338
00956d1e : LEA ECX,[EBP + -0x2c]
00956d21 : CALL 0x00406460
00956d26 : MOV dword ptr [EBP + -0x4],0x5
00956d2d : MOV ECX,dword ptr [0x0172491c]
00956d33 : LEA EAX,[EBP + -0x2c]
00956d36 : PUSH EAX
00956d37 : LEA EDI,[EBP + -0x48]
00956d3a : CALL 0x0081d120
00956d3f : MOV byte ptr [EBP + -0x4],0x7
00956d43 : MOV EBX,0x8
00956d48 : CMP dword ptr [EBP + -0x14],EBX
00956d4b : JC 0x00956d55
00956d4d : MOV ECX,dword ptr [EBP + -0x28]
00956d50 : CALL 0x006f04e0
00956d55 : MOV EDX,dword ptr [ESI + 0x4]
00956d58 : XOR ECX,ECX
00956d5a : MOV word ptr [EBP + -0x28],CX
00956d5e : MOV ECX,dword ptr [EDX + 0x1a8]
00956d64 : MOV EAX,dword ptr [ECX]
00956d66 : MOV EAX,dword ptr [EAX + 0x44]
00956d69 : PUSH 0x2
00956d6b : LEA EDX,[EBP + -0x48]
00956d6e : PUSH EDX
00956d6f : MOV dword ptr [EBP + -0x14],0x7
00956d76 : MOV dword ptr [EBP + -0x18],0x0
00956d7d : CALL EAX
00956d7f : PUSH 0xc7636c
00956d84 : LEA ECX,[EBP + -0x2c]
00956d87 : CALL 0x00406460
00956d8c : MOV byte ptr [EBP + -0x4],BL
00956d8f : LEA ECX,[EBP + -0x2c]
00956d92 : PUSH ECX
00956d93 : MOV ECX,dword ptr [0x0172491c]
00956d99 : LEA EDI,[EBP + -0x64]
00956d9c : CALL 0x0081d120
00956da1 : MOV byte ptr [EBP + -0x4],0x9
00956da5 : MOV EDX,dword ptr [0x00da9894]
00956dab : MOV ECX,dword ptr [EDX]
00956dad : MOV ECX,dword ptr [ECX + 0x134]
00956db3 : PUSH 0x12
00956db5 : PUSH 0xffff0000
00956dba : PUSH EAX
00956dbb : CALL 0x0096b1e0
00956dc0 : MOV byte ptr [EBP + -0x4],BL
00956dc3 : CMP dword ptr [EBP + -0x4c],EBX
00956dc6 : JC 0x00956dd0
00956dc8 : MOV ECX,dword ptr [EBP + -0x60]
00956dcb : CALL 0x006f04e0
00956dd0 : MOV ESI,0x7
00956dd5 : XOR EDI,EDI
00956dd7 : XOR EAX,EAX
00956dd9 : MOV dword ptr [EBP + -0x4c],ESI
00956ddc : MOV dword ptr [EBP + -0x50],EDI
00956ddf : MOV word ptr [EBP + -0x60],AX
00956de3 : MOV byte ptr [EBP + -0x4],0x7
00956de7 : CMP dword ptr [EBP + -0x14],EBX
00956dea : JC 0x00956df4
00956dec : MOV ECX,dword ptr [EBP + -0x28]
00956def : CALL 0x006f04e0
00956df4 : XOR ECX,ECX
00956df6 : MOV dword ptr [EBP + -0x14],ESI
00956df9 : MOV dword ptr [EBP + -0x18],EDI
00956dfc : MOV word ptr [EBP + -0x28],CX
00956e00 : MOV dword ptr [EBP + -0x4],0xffffffff
00956e07 : CMP dword ptr [EBP + -0x30],EBX
00956e0a : JC 0x00956e14
00956e0c : MOV ECX,dword ptr [EBP + -0x44]
00956e0f : CALL 0x006f04e0
00956e14 : XOR EDX,EDX
00956e16 : MOV dword ptr [EBP + -0x30],ESI
00956e19 : MOV dword ptr [EBP + -0x34],EDI
00956e1c : MOV word ptr [EBP + -0x44],DX
00956e20 : MOV ECX,dword ptr [EBP + -0xc]
00956e23 : MOV dword ptr FS:[0x0],ECX
00956e2a : POP ECX
00956e2b : POP EDI
00956e2c : POP ESI
00956e2d : POP EBX
00956e2e : MOV ECX,dword ptr [EBP + -0x10]
00956e31 : XOR ECX,EBP
00956e33 : CALL 0x00633e6b
00956e38 : MOV ESP,EBP
00956e3a : POP EBP
00956e3b : RET

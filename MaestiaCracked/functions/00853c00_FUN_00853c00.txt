PROGRAM  : Maestia.exe
FUNCTION : FUN_00853c00
ENTRY    : 00853c00
BODY     : [[00853c00, 00853ed2]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00853c00(void)

{
  char cVar1;
  int *piVar2;
  int iVar3;
  int in_ECX;
  undefined1 auStack_3c [4];
  undefined1 local_38;
  undefined1 local_37;
  undefined4 local_34;
  undefined4 local_30;
  undefined2 local_2c;
  undefined1 local_2a;
  undefined4 local_28;
  undefined1 local_24;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_00b62ca7;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_3c;
  ExceptionList = &local_14;
  if (*(char *)(in_ECX + 0x65d) == '\0') {
    local_34 = 0;
    local_30 = 0;
    local_2c = 0;
    local_24 = 0;
    local_38 = 0;
    local_2a = 1;
    local_28 = 1;
    local_37 = 0x28;
    FUN_0041dea0(&local_38);
  }
  else if (*(char *)(*(int *)(in_ECX + 0x18a8) + 0x20) != '\0') {
    (**(code **)(*(int *)(*(int *)(*(int *)(in_ECX + 0x138) + 4) + 0x138 + in_ECX) + 0x10))
              (in_ECX + 0x1d38,1,1,1,DAT_00d66fa0 ^ (uint)&stack0xffffffb8);
    piVar2 = (int *)FUN_004049b0(*(undefined4 *)(*(int *)(in_ECX + 0x18a8) + 0x28));
    if (piVar2 != (int *)0x0) {
      iVar3 = (**(code **)(*piVar2 + 0x38))();
      if (iVar3 != 0) {
        FUN_00404350(piVar2 + 0x31);
        local_1c = 0;
        cVar1 = FUN_004049e0();
        if (cVar1 != '\0') {
          FUN_008980b0(&stack0xffffffb8,1);
        }
        FUN_0088e570(0x12);
        local_1c = 0xffffffff;
        FUN_00406560();
      }
    }
    FUN_0085bfe0(in_ECX,1);
    FUN_0085c1c0();
    FUN_0083bb00(0);
    FUN_0083ba10();
    (**(code **)(*(int *)(*(int *)(*(int *)(in_ECX + 0x138) + 4) + 0x138 + in_ECX) + 0x10))
              (in_ECX + 0x6d8,1,0,1);
    *(undefined4 *)(in_ECX + 0x19ec) = 0;
    *(undefined4 *)(in_ECX + 0x1a68) = 0;
    FUN_00856310(&DAT_00d720f0);
    if (*(char *)(in_ECX + 0x4d4) != '\0') {
      FUN_0084c320(1);
      iVar3 = *(int *)(in_ECX + 0x17f0);
      *(undefined1 *)(iVar3 + 0x1a8) = 0;
      if (*(int **)(iVar3 + 0x168) != (int *)0x0) {
        (**(code **)(**(int **)(iVar3 + 0x168) + 0x10))(0);
      }
      if (*(int **)(iVar3 + 0x16c) != (int *)0x0) {
        (**(code **)(**(int **)(iVar3 + 0x16c) + 0x10))(0);
      }
      FUN_0084c320(1);
      iVar3 = *(int *)(in_ECX + 0x1870);
      *(undefined1 *)(iVar3 + 0x1a8) = 0;
      if (*(int **)(iVar3 + 0x168) != (int *)0x0) {
        (**(code **)(**(int **)(iVar3 + 0x168) + 0x10))(0);
      }
      if (*(int **)(iVar3 + 0x16c) != (int *)0x0) {
        (**(code **)(**(int **)(iVar3 + 0x16c) + 0x10))(0);
      }
      FUN_0084c320(1);
      *(undefined1 *)(in_ECX + 0x198c) = 1;
      *(undefined1 *)(in_ECX + 0x4d4) = 0;
    }
  }
  iVar3 = *(int *)(in_ECX + 0x17f0);
  *(undefined1 *)(iVar3 + 0x1a8) = 1;
  if (*(int **)(iVar3 + 0x168) != (int *)0x0) {
    (**(code **)(**(int **)(iVar3 + 0x168) + 0x10))(1);
  }
  if (*(int **)(iVar3 + 0x16c) != (int *)0x0) {
    (**(code **)(**(int **)(iVar3 + 0x16c) + 0x10))(1);
  }
  iVar3 = *(int *)(in_ECX + 0x1870);
  *(undefined1 *)(iVar3 + 0x1a8) = 1;
  if (*(int **)(iVar3 + 0x168) != (int *)0x0) {
    (**(code **)(**(int **)(iVar3 + 0x168) + 0x10))(1);
  }
  if (*(int **)(iVar3 + 0x16c) != (int *)0x0) {
    (**(code **)(**(int **)(iVar3 + 0x16c) + 0x10))(1);
  }
  FUN_00884de0();
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_3c);
  return;
}



============================================================
DISASSEMBLY
============================================================
00853c00 : PUSH EBP
00853c01 : MOV EBP,ESP
00853c03 : AND ESP,0xfffffff8
00853c06 : PUSH -0x1
00853c08 : PUSH 0xb62ca7
00853c0d : MOV EAX,FS:[0x0]
00853c13 : PUSH EAX
00853c14 : SUB ESP,0x28
00853c17 : MOV EAX,[0x00d66fa0]
00853c1c : XOR EAX,ESP
00853c1e : MOV dword ptr [ESP + 0x20],EAX
00853c22 : PUSH EBX
00853c23 : PUSH ESI
00853c24 : PUSH EDI
00853c25 : MOV EAX,[0x00d66fa0]
00853c2a : XOR EAX,ESP
00853c2c : PUSH EAX
00853c2d : LEA EAX,[ESP + 0x38]
00853c31 : MOV FS:[0x0],EAX
00853c37 : MOV EBX,ECX
00853c39 : CMP byte ptr [EBX + 0x65d],0x0
00853c40 : JNZ 0x00853c80
00853c42 : XOR EAX,EAX
00853c44 : LEA ECX,[ESP + 0x14]
00853c48 : MOV dword ptr [ESP + 0x18],EAX
00853c4c : MOV dword ptr [ESP + 0x1c],EAX
00853c50 : MOV word ptr [ESP + 0x20],AX
00853c55 : MOV byte ptr [ESP + 0x28],AL
00853c59 : MOV byte ptr [ESP + 0x14],AL
00853c5d : PUSH ECX
00853c5e : LEA EAX,[EBX + 0x19a4]
00853c64 : MOV byte ptr [ESP + 0x26],0x1
00853c69 : MOV dword ptr [ESP + 0x28],0x1
00853c71 : MOV byte ptr [ESP + 0x19],0x28
00853c76 : CALL 0x0041dea0
00853c7b : JMP 0x00853e48
00853c80 : MOV EDX,dword ptr [EBX + 0x18a8]
00853c86 : CMP byte ptr [EDX + 0x20],0x0
00853c8a : JZ 0x00853e48
00853c90 : MOV EAX,dword ptr [EBX + 0x138]
00853c96 : MOV ECX,dword ptr [EAX + 0x4]
00853c99 : MOV EDX,dword ptr [ECX + EBX*0x1 + 0x138]
00853ca0 : MOV EDX,dword ptr [EDX + 0x10]
00853ca3 : PUSH 0x1
00853ca5 : PUSH 0x1
00853ca7 : LEA ECX,[ECX + EBX*0x1 + 0x138]
00853cae : PUSH 0x1
00853cb0 : LEA EAX,[EBX + 0x1d38]
00853cb6 : PUSH EAX
00853cb7 : CALL EDX
00853cb9 : MOV EAX,dword ptr [EBX + 0x18a8]
00853cbf : MOV EAX,dword ptr [EAX + 0x28]
00853cc2 : PUSH EAX
00853cc3 : CALL 0x004049b0
00853cc8 : MOV ESI,EAX
00853cca : XOR EDI,EDI
00853ccc : ADD ESP,0x4
00853ccf : CMP ESI,EDI
00853cd1 : JZ 0x00853d31
00853cd3 : MOV EDX,dword ptr [ESI]
00853cd5 : MOV EAX,dword ptr [EDX + 0x38]
00853cd8 : MOV ECX,ESI
00853cda : CALL EAX
00853cdc : TEST EAX,EAX
00853cde : JZ 0x00853d31
00853ce0 : ADD ESI,0xc4
00853ce6 : PUSH ESI
00853ce7 : LEA ESI,[ESP + 0x18]
00853ceb : CALL 0x00404350
00853cf0 : ADD ESP,0x4
00853cf3 : MOV dword ptr [ESP + 0x40],EDI
00853cf7 : MOV ESI,0xc3f4c8
00853cfc : LEA ECX,[ESP + 0x14]
00853d00 : CALL 0x004049e0
00853d05 : TEST AL,AL
00853d07 : JZ 0x00853d17
00853d09 : PUSH 0x1
00853d0b : LEA ECX,[ESP + 0x18]
00853d0f : PUSH ECX
00853d10 : MOV ESI,EBX
00853d12 : CALL 0x008980b0
00853d17 : PUSH 0x12
00853d19 : MOV ECX,EBX
00853d1b : CALL 0x0088e570
00853d20 : MOV dword ptr [ESP + 0x40],0xffffffff
00853d28 : LEA ECX,[ESP + 0x14]
00853d2c : CALL 0x00406560
00853d31 : PUSH 0x1
00853d33 : PUSH EBX
00853d34 : CALL 0x0085bfe0
00853d39 : MOV ECX,EBX
00853d3b : CALL 0x0085c1c0
00853d40 : MOV ECX,dword ptr [EBX + 0x18a8]
00853d46 : PUSH EDI
00853d47 : XOR AL,AL
00853d49 : CALL 0x0083bb00
00853d4e : MOV ESI,dword ptr [EBX + 0x18a8]
00853d54 : CALL 0x0083ba10
00853d59 : MOV EDX,dword ptr [EBX + 0x138]
00853d5f : MOV EAX,dword ptr [EDX + 0x4]
00853d62 : MOV EDX,dword ptr [EAX + EBX*0x1 + 0x138]
00853d69 : MOV EDX,dword ptr [EDX + 0x10]
00853d6c : PUSH 0x1
00853d6e : LEA ECX,[EAX + EBX*0x1 + 0x138]
00853d75 : PUSH EDI
00853d76 : PUSH 0x1
00853d78 : LEA EAX,[EBX + 0x6d8]
00853d7e : PUSH EAX
00853d7f : CALL EDX
00853d81 : XORPS XMM0,XMM0
00853d84 : PUSH 0xd720f0
00853d89 : MOV ESI,EBX
00853d8b : MOV dword ptr [EBX + 0x19ec],EDI
00853d91 : MOVSS dword ptr [EBX + 0x1a68],XMM0
00853d99 : CALL 0x00856310
00853d9e : CMP byte ptr [EBX + 0x4d4],0x0
00853da5 : JZ 0x00853e48
00853dab : MOV EDI,dword ptr [EBX + 0x17f0]
00853db1 : PUSH 0x1
00853db3 : CALL 0x0084c320
00853db8 : MOV ESI,dword ptr [EBX + 0x17f0]
00853dbe : MOV ECX,dword ptr [ESI + 0x168]
00853dc4 : MOV byte ptr [ESI + 0x1a8],0x0
00853dcb : TEST ECX,ECX
00853dcd : JZ 0x00853dd8
00853dcf : MOV EAX,dword ptr [ECX]
00853dd1 : MOV EDX,dword ptr [EAX + 0x10]
00853dd4 : PUSH 0x0
00853dd6 : CALL EDX
00853dd8 : MOV ECX,dword ptr [ESI + 0x16c]
00853dde : TEST ECX,ECX
00853de0 : JZ 0x00853deb
00853de2 : MOV EAX,dword ptr [ECX]
00853de4 : MOV EDX,dword ptr [EAX + 0x10]
00853de7 : PUSH 0x0
00853de9 : CALL EDX
00853deb : MOV EDI,dword ptr [EBX + 0x1870]
00853df1 : PUSH 0x1
00853df3 : CALL 0x0084c320
00853df8 : MOV ESI,dword ptr [EBX + 0x1870]
00853dfe : MOV ECX,dword ptr [ESI + 0x168]
00853e04 : MOV byte ptr [ESI + 0x1a8],0x0
00853e0b : TEST ECX,ECX
00853e0d : JZ 0x00853e18
00853e0f : MOV EAX,dword ptr [ECX]
00853e11 : MOV EDX,dword ptr [EAX + 0x10]
00853e14 : PUSH 0x0
00853e16 : CALL EDX
00853e18 : MOV ESI,dword ptr [ESI + 0x16c]
00853e1e : TEST ESI,ESI
00853e20 : JZ 0x00853e2d
00853e22 : MOV EAX,dword ptr [ESI]
00853e24 : MOV EDX,dword ptr [EAX + 0x10]
00853e27 : PUSH 0x0
00853e29 : MOV ECX,ESI
00853e2b : CALL EDX
00853e2d : MOV EDI,dword ptr [EBX + 0x17f4]
00853e33 : PUSH 0x1
00853e35 : CALL 0x0084c320
00853e3a : MOV byte ptr [EBX + 0x198c],0x1
00853e41 : MOV byte ptr [EBX + 0x4d4],0x0
00853e48 : MOV ESI,dword ptr [EBX + 0x17f0]
00853e4e : MOV ECX,dword ptr [ESI + 0x168]
00853e54 : MOV byte ptr [ESI + 0x1a8],0x1
00853e5b : TEST ECX,ECX
00853e5d : JZ 0x00853e68
00853e5f : MOV EAX,dword ptr [ECX]
00853e61 : MOV EDX,dword ptr [EAX + 0x10]
00853e64 : PUSH 0x1
00853e66 : CALL EDX
00853e68 : MOV ECX,dword ptr [ESI + 0x16c]
00853e6e : TEST ECX,ECX
00853e70 : JZ 0x00853e7b
00853e72 : MOV EAX,dword ptr [ECX]
00853e74 : MOV EDX,dword ptr [EAX + 0x10]
00853e77 : PUSH 0x1
00853e79 : CALL EDX
00853e7b : MOV ESI,dword ptr [EBX + 0x1870]
00853e81 : MOV ECX,dword ptr [ESI + 0x168]
00853e87 : MOV byte ptr [ESI + 0x1a8],0x1
00853e8e : TEST ECX,ECX
00853e90 : JZ 0x00853e9b
00853e92 : MOV EAX,dword ptr [ECX]
00853e94 : MOV EDX,dword ptr [EAX + 0x10]
00853e97 : PUSH 0x1
00853e99 : CALL EDX
00853e9b : MOV ECX,dword ptr [ESI + 0x16c]
00853ea1 : TEST ECX,ECX
00853ea3 : JZ 0x00853eae
00853ea5 : MOV EAX,dword ptr [ECX]
00853ea7 : MOV EDX,dword ptr [EAX + 0x10]
00853eaa : PUSH 0x1
00853eac : CALL EDX
00853eae : MOV ECX,EBX
00853eb0 : CALL 0x00884de0
00853eb5 : MOV ECX,dword ptr [ESP + 0x38]
00853eb9 : MOV dword ptr FS:[0x0],ECX
00853ec0 : POP ECX
00853ec1 : POP EDI
00853ec2 : POP ESI
00853ec3 : POP EBX
00853ec4 : MOV ECX,dword ptr [ESP + 0x20]
00853ec8 : XOR ECX,ESP
00853eca : CALL 0x00633e6b
00853ecf : MOV ESP,EBP
00853ed1 : POP EBP
00853ed2 : RET

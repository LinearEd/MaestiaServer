PROGRAM  : Maestia.exe
FUNCTION : FUN_00817690
ENTRY    : 00817690
BODY     : [[00817690, 008176d9] [008176e0, 008178d4]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_00817690(undefined4 param_1)

{
  short sVar1;
  char cVar2;
  uint uVar3;
  short *psVar4;
  undefined4 *puVar5;
  int *unaff_ESI;
  undefined1 local_2050 [4];
  undefined2 local_204c;
  undefined4 local_203c;
  uint local_2038;
  undefined4 local_2034;
  undefined4 local_2030;
  undefined4 local_202c;
  undefined4 local_2028;
  uint local_2024;
  uint local_2020;
  undefined4 *local_201c;
  short local_2018;
  undefined1 local_2016 [8190];
  uint local_18;
  undefined4 uStack_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3d194;
  local_10 = ExceptionList;
  uStack_14 = 0x8176ab;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_2028 = param_1;
  local_2024 = 0;
  local_201c = (undefined4 *)0x0;
  puVar5 = (undefined4 *)0x0;
  local_18 = uVar3;
  while (((uint)unaff_ESI[9] < (uint)unaff_ESI[8] &&
         (cVar2 = (**(code **)(*unaff_ESI + 0x1c))(&local_2034,uVar3), cVar2 != '\0'))) {
    switch(local_2034) {
    case 0x5041:
      (**(code **)(*unaff_ESI + 0xc))(&local_2024,4,1);
      local_2020 = FUN_006f0760(0x14,"",0,(DAT_01725270 >> 3 & 1) == 0);
      local_8 = 0;
      if (local_2020 == 0) {
        local_201c = (undefined4 *)0x0;
      }
      else {
        local_201c = (undefined4 *)FUN_00453500(local_2020);
      }
      local_8 = 0xffffffff;
      FUN_00449610();
      puVar5 = local_201c;
      break;
    case 0x5042:
      local_2020 = 0;
      if (local_2024 != 0) {
        do {
          FUN_0070d080(&local_2018);
          psVar4 = &local_2018;
          local_204c = 0;
          local_2038 = 7;
          local_203c = 0;
          do {
            sVar1 = *psVar4;
            psVar4 = psVar4 + 1;
          } while (sVar1 != 0);
          FUN_00406360(&local_2018,(int)psVar4 - (int)local_2016 >> 1);
          local_8 = 1;
          FUN_00405ae0(local_2050);
          local_8 = 0xffffffff;
          if (7 < local_2038) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          local_2020 = local_2020 + 1;
          local_2038 = 7;
          local_203c = 0;
          local_204c = 0;
          puVar5 = local_201c;
        } while (local_2020 < local_2024);
      }
      break;
    case 0x5043:
      (**(code **)(*unaff_ESI + 0xc))(&local_202c,4,1);
      if (puVar5 != (undefined4 *)0x0) {
        *puVar5 = local_202c;
      }
      break;
    case 0x5044:
      goto switchD_00817718_caseD_5044;
    default:
      (**(code **)(*unaff_ESI + 0x24))(local_2030);
    }
  }
switchD_00817718_caseD_5044:
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00817690 : PUSH EBP
00817691 : MOV EBP,ESP
00817693 : PUSH -0x1
00817695 : PUSH 0xb3d194
0081769a : MOV EAX,FS:[0x0]
008176a0 : PUSH EAX
008176a1 : MOV EAX,0x2044
008176a6 : CALL 0x0063b780
008176ab : MOV EAX,[0x00d66fa0]
008176b0 : XOR EAX,EBP
008176b2 : MOV dword ptr [EBP + -0x14],EAX
008176b5 : PUSH EBX
008176b6 : PUSH EDI
008176b7 : PUSH EAX
008176b8 : LEA EAX,[EBP + -0xc]
008176bb : MOV FS:[0x0],EAX
008176c1 : MOV EAX,dword ptr [EBP + 0x8]
008176c4 : XOR EBX,EBX
008176c6 : MOV dword ptr [EBP + 0xffffdfdc],EAX
008176cc : MOV dword ptr [EBP + 0xffffdfe0],EBX
008176d2 : MOV dword ptr [EBP + 0xffffdfe8],EBX
008176d8 : JMP 0x008176e0
008176e0 : MOV ECX,dword ptr [ESI + 0x24]
008176e3 : CMP ECX,dword ptr [ESI + 0x20]
008176e6 : JNC 0x008178b8
008176ec : MOV EDX,dword ptr [ESI]
008176ee : MOV EDX,dword ptr [EDX + 0x1c]
008176f1 : LEA EAX,[EBP + 0xffffdfd0]
008176f7 : PUSH EAX
008176f8 : MOV ECX,ESI
008176fa : CALL EDX
008176fc : TEST AL,AL
008176fe : JZ 0x008178b8
00817704 : MOV EAX,dword ptr [EBP + 0xffffdfd0]
0081770a : ADD EAX,0xffffafbf
0081770f : CMP EAX,0x3
00817712 : JA 0x008178a3
00817718 : JMP dword ptr [EAX*0x4 + 0x8178d8]
0081771f : MOV EAX,dword ptr [ESI]
00817721 : MOV EDX,dword ptr [EAX + 0xc]
00817724 : PUSH 0x1
00817726 : PUSH 0x4
00817728 : LEA ECX,[EBP + 0xffffdfe0]
0081772e : PUSH ECX
0081772f : MOV ECX,ESI
00817731 : CALL EDX
00817733 : MOV EAX,[0x01725270]
00817738 : SHR EAX,0x3
0081773b : MOV ECX,0x0
00817740 : AND EAX,0x1
00817743 : SETZ CL
00817746 : PUSH ECX
00817747 : PUSH 0x0
00817749 : PUSH 0xbf1a4a
0081774e : PUSH 0x14
00817750 : CALL 0x006f0760
00817755 : ADD ESP,0x10
00817758 : MOV dword ptr [EBP + 0xffffdfe4],EAX
0081775e : MOV dword ptr [EBP + -0x4],0x0
00817765 : TEST EAX,EAX
00817767 : JZ 0x00817771
00817769 : PUSH EAX
0081776a : CALL 0x00453500
0081776f : JMP 0x00817773
00817771 : XOR EAX,EAX
00817773 : MOV dword ptr [EBP + -0x4],0xffffffff
0081777a : MOV EDX,dword ptr [EBP + 0xffffdfdc]
00817780 : ADD EDX,0x60
00817783 : LEA EDI,[EBP + 0xffffdfe8]
00817789 : MOV dword ptr [EBP + 0xffffdfe8],EAX
0081778f : CALL 0x00449610
00817794 : MOV EBX,dword ptr [EBP + 0xffffdfe8]
0081779a : JMP 0x008176e0
0081779f : MOV EDX,dword ptr [ESI]
008177a1 : MOV EDX,dword ptr [EDX + 0xc]
008177a4 : PUSH 0x1
008177a6 : PUSH 0x4
008177a8 : LEA EAX,[EBP + 0xffffdfd8]
008177ae : PUSH EAX
008177af : MOV ECX,ESI
008177b1 : CALL EDX
008177b3 : TEST EBX,EBX
008177b5 : JZ 0x008176e0
008177bb : MOV EAX,dword ptr [EBP + 0xffffdfd8]
008177c1 : MOV dword ptr [EBX],EAX
008177c3 : JMP 0x008176e0
008177c8 : CMP dword ptr [EBP + 0xffffdfe0],0x0
008177cf : MOV dword ptr [EBP + 0xffffdfe4],0x0
008177d9 : JBE 0x008176e0
008177df : ADD EBX,0x4
008177e2 : LEA ECX,[EBP + 0xffffdfec]
008177e8 : PUSH ECX
008177e9 : MOV EDI,ESI
008177eb : CALL 0x0070d080
008177f0 : XOR EDI,EDI
008177f2 : XOR EDX,EDX
008177f4 : LEA EAX,[EBP + 0xffffdfec]
008177fa : MOV word ptr [EBP + 0xffffdfb8],DX
00817801 : MOV dword ptr [EBP + 0xffffdfcc],0x7
0081780b : MOV dword ptr [EBP + 0xffffdfc8],EDI
00817811 : LEA EDX,[EAX + 0x2]
00817814 : MOV CX,word ptr [EAX]
00817817 : ADD EAX,0x2
0081781a : CMP CX,DI
0081781d : JNZ 0x00817814
0081781f : SUB EAX,EDX
00817821 : SAR EAX,0x1
00817823 : PUSH EAX
00817824 : LEA EAX,[EBP + 0xffffdfec]
0081782a : PUSH EAX
0081782b : LEA ECX,[EBP + 0xffffdfb4]
00817831 : CALL 0x00406360
00817836 : MOV dword ptr [EBP + -0x4],0x1
0081783d : LEA ECX,[EBP + 0xffffdfb4]
00817843 : PUSH ECX
00817844 : MOV EAX,EBX
00817846 : CALL 0x00405ae0
0081784b : MOV dword ptr [EBP + -0x4],0xffffffff
00817852 : CMP dword ptr [EBP + 0xffffdfcc],0x8
00817859 : JC 0x00817866
0081785b : MOV ECX,dword ptr [EBP + 0xffffdfb8]
00817861 : CALL 0x006f04e0
00817866 : MOV EAX,dword ptr [EBP + 0xffffdfe4]
0081786c : INC EAX
0081786d : XOR EDX,EDX
0081786f : MOV dword ptr [EBP + 0xffffdfcc],0x7
00817879 : MOV dword ptr [EBP + 0xffffdfc8],EDI
0081787f : MOV word ptr [EBP + 0xffffdfb8],DX
00817886 : MOV dword ptr [EBP + 0xffffdfe4],EAX
0081788c : CMP EAX,dword ptr [EBP + 0xffffdfe0]
00817892 : JC 0x008177e2
00817898 : MOV EBX,dword ptr [EBP + 0xffffdfe8]
0081789e : JMP 0x008176e0
008178a3 : MOV ECX,dword ptr [EBP + 0xffffdfd4]
008178a9 : MOV EAX,dword ptr [ESI]
008178ab : MOV EDX,dword ptr [EAX + 0x24]
008178ae : PUSH ECX
008178af : MOV ECX,ESI
008178b1 : CALL EDX
008178b3 : JMP 0x008176e0
008178b8 : MOV ECX,dword ptr [EBP + -0xc]
008178bb : MOV dword ptr FS:[0x0],ECX
008178c2 : POP ECX
008178c3 : POP EDI
008178c4 : POP EBX
008178c5 : MOV ECX,dword ptr [EBP + -0x14]
008178c8 : XOR ECX,EBP
008178ca : CALL 0x00633e6b
008178cf : MOV ESP,EBP
008178d1 : POP EBP
008178d2 : RET 0x4

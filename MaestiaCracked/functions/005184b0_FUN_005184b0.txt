PROGRAM  : Maestia.exe
FUNCTION : FUN_005184b0
ENTRY    : 005184b0
BODY     : [[005184b0, 00518560]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005184b0(int param_1,undefined4 param_2)

{
  LPCRITICAL_SECTION lpCriticalSection;
  undefined4 *puVar1;
  undefined4 *in_ECX;
  undefined1 *local_8 [2];
  
  *in_ECX = &PTR_FUN_00cd3f2c;
  in_ECX[1] = 1;
  *in_ECX = &PTR_FUN_00b87170;
  puVar1 = (undefined4 *)FUN_00515840(0x28,0);
  if (puVar1 == (undefined4 *)0x0) {
    puVar1 = (undefined4 *)0x0;
  }
  else {
    puVar1[1] = 0;
    puVar1[2] = 0;
    puVar1[3] = 0;
    FUN_005a2090(0);
    *puVar1 = 1;
  }
  in_ECX[2] = puVar1;
  in_ECX[3] = &PTR_FUN_00cd40d4;
  *in_ECX = &PTR_FUN_00b871d0;
  in_ECX[3] = &PTR_LAB_00b871bc;
  in_ECX[4] = param_1;
  in_ECX[5] = param_2;
  if (*(int *)(param_1 + 8) != 0) {
    lpCriticalSection = (LPCRITICAL_SECTION)(*(int *)(param_1 + 8) + 0x10);
    local_8[0] = &LAB_00518010;
    EnterCriticalSection(lpCriticalSection);
    FUN_00517c30(local_8);
    LeaveCriticalSection(lpCriticalSection);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005184b0 : SUB ESP,0x8
005184b3 : PUSH EBX
005184b4 : PUSH ESI
005184b5 : MOV ESI,ECX
005184b7 : PUSH EDI
005184b8 : MOV dword ptr [ESI],0xcd3f2c
005184be : XOR EBX,EBX
005184c0 : PUSH EBX
005184c1 : MOV dword ptr [ESI + 0x4],0x1
005184c8 : MOV dword ptr [ESI],0xb87170
005184ce : MOV ECX,dword ptr [0x00d73250]
005184d4 : PUSH 0x28
005184d6 : CALL 0x00515840
005184db : MOV EDI,EAX
005184dd : CMP EDI,EBX
005184df : JZ 0x005184fb
005184e1 : MOV dword ptr [EDI + 0x4],EBX
005184e4 : MOV dword ptr [EDI + 0x8],EBX
005184e7 : PUSH EBX
005184e8 : LEA ECX,[EDI + 0x10]
005184eb : MOV dword ptr [EDI + 0xc],EBX
005184ee : CALL 0x005a2090
005184f3 : MOV dword ptr [EDI],0x1
005184f9 : JMP 0x005184fd
005184fb : XOR EDI,EDI
005184fd : MOV EAX,dword ptr [ESP + 0x1c]
00518501 : MOV dword ptr [ESI + 0x8],EDI
00518504 : MOV EDI,dword ptr [ESP + 0x18]
00518508 : MOV dword ptr [ESI + 0xc],0xcd40d4
0051850f : MOV dword ptr [ESI],0xb871d0
00518515 : MOV dword ptr [ESI + 0xc],0xb871bc
0051851c : MOV dword ptr [ESI + 0x10],EDI
0051851f : MOV dword ptr [ESI + 0x14],EAX
00518522 : MOV EAX,dword ptr [EDI + 0x8]
00518525 : CMP EAX,EBX
00518527 : JZ 0x00518556
00518529 : LEA EBX,[EAX + 0x10]
0051852c : PUSH EBX
0051852d : MOV dword ptr [ESP + 0x10],0x518010
00518535 : MOV dword ptr [ESP + 0x14],ESI
00518539 : CALL dword ptr [0x00b85118]
0051853f : LEA ECX,[ESP + 0xc]
00518543 : PUSH ECX
00518544 : MOV ECX,dword ptr [EDI + 0x8]
00518547 : ADD ECX,0x4
0051854a : CALL 0x00517c30
0051854f : PUSH EBX
00518550 : CALL dword ptr [0x00b8511c]
00518556 : POP EDI
00518557 : MOV EAX,ESI
00518559 : POP ESI
0051855a : POP EBX
0051855b : ADD ESP,0x8
0051855e : RET 0x8

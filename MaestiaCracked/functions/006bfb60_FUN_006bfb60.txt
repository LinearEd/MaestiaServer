PROGRAM  : Maestia.exe
FUNCTION : FUN_006bfb60
ENTRY    : 006bfb60
BODY     : [[006bfb60, 006bfbc9] [006bfbd0, 006bfc17]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006bfb60(int param_1,uint param_2)

{
  uint in_EAX;
  int iVar1;
  int in_ECX;
  uint uVar2;
  int iVar3;
  
  uVar2 = *(uint *)(in_ECX + 0x10b8);
  iVar3 = 0;
  if (in_EAX < uVar2) {
    if ((*(int *)(in_ECX + 0x10bc) - in_ECX) - 0xb8U < uVar2 - in_EAX) {
      iVar1 = FUN_006bfa70();
      if (iVar1 != 0) {
        return 0;
      }
    }
    else {
      *(uint *)(in_ECX + 0x10bc) = (*(int *)(in_ECX + 0x10bc) - uVar2) + in_EAX;
      *(uint *)(in_ECX + 0x10b8) = in_EAX;
    }
  }
  if (((in_EAX <= *(uint *)(in_ECX + 0x10b8)) || (iVar1 = FUN_006bfaf0(), iVar1 == 0)) &&
     (param_2 != 0)) {
    do {
      uVar2 = *(int *)(in_ECX + 0x10c0) - (int)*(void **)(in_ECX + 0x10bc);
      if (param_2 <= uVar2) {
        uVar2 = param_2;
      }
      _memcpy((void *)(param_1 + iVar3),*(void **)(in_ECX + 0x10bc),uVar2);
      *(int *)(in_ECX + 0x10bc) = *(int *)(in_ECX + 0x10bc) + uVar2;
      *(int *)(in_ECX + 0x10b8) = *(int *)(in_ECX + 0x10b8) + uVar2;
      iVar3 = iVar3 + uVar2;
      param_2 = param_2 - uVar2;
    } while ((param_2 != 0) && (iVar1 = FUN_006bfab0(), iVar1 == 0));
  }
  return iVar3;
}



============================================================
DISASSEMBLY
============================================================
006bfb60 : PUSH EBX
006bfb61 : PUSH EBP
006bfb62 : PUSH ESI
006bfb63 : MOV ESI,ECX
006bfb65 : MOV ECX,dword ptr [ESI + 0x10b8]
006bfb6b : PUSH EDI
006bfb6c : MOV EDI,EAX
006bfb6e : XOR EBP,EBP
006bfb70 : CMP EDI,ECX
006bfb72 : JNC 0x006bfba7
006bfb74 : MOV EAX,dword ptr [ESI + 0x10bc]
006bfb7a : MOV EDX,EAX
006bfb7c : SUB EDX,ESI
006bfb7e : MOV EBX,ECX
006bfb80 : SUB EDX,0xb8
006bfb86 : SUB EBX,EDI
006bfb88 : CMP EBX,EDX
006bfb8a : JA 0x006bfb9e
006bfb8c : SUB EAX,ECX
006bfb8e : ADD EAX,EDI
006bfb90 : MOV dword ptr [ESI + 0x10bc],EAX
006bfb96 : MOV dword ptr [ESI + 0x10b8],EDI
006bfb9c : JMP 0x006bfba7
006bfb9e : CALL 0x006bfa70
006bfba3 : TEST EAX,EAX
006bfba5 : JNZ 0x006bfc11
006bfba7 : MOV ECX,dword ptr [ESI + 0x10b8]
006bfbad : CMP EDI,ECX
006bfbaf : JBE 0x006bfbc0
006bfbb1 : MOV EAX,EDI
006bfbb3 : SUB EAX,ECX
006bfbb5 : MOV EDI,ESI
006bfbb7 : CALL 0x006bfaf0
006bfbbc : TEST EAX,EAX
006bfbbe : JNZ 0x006bfc11
006bfbc0 : MOV EDI,dword ptr [ESP + 0x18]
006bfbc4 : TEST EDI,EDI
006bfbc6 : JZ 0x006bfc11
006bfbc8 : JMP 0x006bfbd0
006bfbd0 : MOV EAX,dword ptr [ESI + 0x10bc]
006bfbd6 : MOV EBX,dword ptr [ESI + 0x10c0]
006bfbdc : SUB EBX,EAX
006bfbde : CMP EBX,EDI
006bfbe0 : JC 0x006bfbe4
006bfbe2 : MOV EBX,EDI
006bfbe4 : PUSH EBX
006bfbe5 : PUSH EAX
006bfbe6 : MOV EAX,dword ptr [ESP + 0x1c]
006bfbea : LEA ECX,[EAX + EBP*0x1]
006bfbed : PUSH ECX
006bfbee : CALL 0x0063ae40
006bfbf3 : ADD dword ptr [ESI + 0x10bc],EBX
006bfbf9 : ADD dword ptr [ESI + 0x10b8],EBX
006bfbff : ADD ESP,0xc
006bfc02 : ADD EBP,EBX
006bfc04 : SUB EDI,EBX
006bfc06 : JZ 0x006bfc11
006bfc08 : CALL 0x006bfab0
006bfc0d : TEST EAX,EAX
006bfc0f : JZ 0x006bfbd0
006bfc11 : POP EDI
006bfc12 : POP ESI
006bfc13 : MOV EAX,EBP
006bfc15 : POP EBP
006bfc16 : POP EBX
006bfc17 : RET

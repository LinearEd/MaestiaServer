PROGRAM  : Maestia.exe
FUNCTION : FUN_00530020
ENTRY    : 00530020
BODY     : [[00530020, 0053016c]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00530020(void)

{
  int iVar1;
  undefined1 *puVar2;
  char cVar3;
  undefined1 uVar4;
  int *piVar5;
  undefined4 uVar6;
  int *in_ECX;
  int iVar7;
  uint *puVar8;
  int local_1c;
  int iStack_18;
  byte local_14;
  undefined1 local_10 [16];
  
  cVar3 = **(char **)(*in_ECX + 8);
  uVar4 = 0;
  if ((cVar3 == '\b') || (cVar3 == '\v')) {
    FUN_00527140(&local_1c,*in_ECX);
    if ((local_1c != 0) && (piVar5 = (int *)FUN_005270f0(*in_ECX), piVar5 != (int *)0x0)) {
      local_10[0] = 0;
      cVar3 = (**(code **)(*(int *)(local_1c + 0x10) + 0x2c))
                        ((int *)(*in_ECX + 0x78),*(int *)(*in_ECX + 0x78) + 0x130,local_10);
      if (cVar3 == '\0') {
        uVar4 = 0;
      }
      else {
        uVar6 = FUN_00526fa0(*in_ECX);
        uVar4 = (**(code **)(*piVar5 + 0x48))(*in_ECX,uVar6,1);
      }
      FUN_00526bc0();
    }
    if (((local_14 & 2) == 0) && (local_1c != 0)) {
      FUN_00503db0();
    }
    local_1c = 0;
    if (((local_14 & 1) == 0) && (iStack_18 != 0)) {
      FUN_00503db0();
    }
  }
  iVar1 = *in_ECX;
  puVar8 = (uint *)(iVar1 + 8);
  if (*(int *)(iVar1 + 8) - 0x20U < *(uint *)(iVar1 + 0xc)) {
    iVar7 = 2;
    do {
      FUN_00526bc0();
      *puVar8 = *puVar8 - 0x10;
      if (*puVar8 < *(uint *)(iVar1 + 0xc)) {
        FUN_00504f30();
      }
      iVar7 = iVar7 + -1;
    } while (iVar7 != 0);
  }
  else {
    FUN_00526bc0();
    *puVar8 = *puVar8 - 0x10;
    FUN_00526bc0();
    *puVar8 = *puVar8 - 0x10;
  }
  iVar1 = *in_ECX;
  *(int *)(iVar1 + 8) = *(int *)(iVar1 + 8) + 0x10;
  if (*(uint *)(iVar1 + 0x10) <= *(uint *)(iVar1 + 8)) {
    FUN_00504050();
  }
  puVar2 = *(undefined1 **)(iVar1 + 8);
  if (puVar2 != (undefined1 *)0x0) {
    *puVar2 = 2;
    puVar2[4] = uVar4;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00530020 : SUB ESP,0x20
00530023 : PUSH EBX
00530024 : PUSH EBP
00530025 : PUSH ESI
00530026 : PUSH EDI
00530027 : MOV EDI,ECX
00530029 : MOV EAX,dword ptr [EDI]
0053002b : MOV ECX,dword ptr [EAX + 0x8]
0053002e : MOV EDX,ECX
00530030 : LEA ESI,[EDX + -0x10]
00530033 : CMP EDX,dword ptr [EAX + 0xc]
00530036 : JA 0x0053003b
00530038 : MOV ESI,dword ptr [EAX + 0x14]
0053003b : MOV DL,byte ptr [ECX]
0053003d : XOR BL,BL
0053003f : MOV byte ptr [ESP + 0x13],BL
00530043 : CMP DL,0x8
00530046 : JZ 0x00530051
00530048 : CMP DL,0xb
0053004b : JNZ 0x005300f9
00530051 : PUSH EAX
00530052 : LEA EAX,[ESP + 0x18]
00530056 : PUSH EAX
00530057 : CALL 0x00527140
0053005c : CMP dword ptr [ESP + 0x14],0x0
00530061 : JZ 0x005300c9
00530063 : MOV ECX,dword ptr [EDI]
00530065 : PUSH ECX
00530066 : MOV ECX,ESI
00530068 : CALL 0x005270f0
0053006d : MOV ESI,EAX
0053006f : TEST ESI,ESI
00530071 : JZ 0x005300c9
00530073 : MOV EAX,dword ptr [EDI]
00530075 : MOV ECX,dword ptr [ESP + 0x14]
00530079 : ADD EAX,0x78
0053007c : MOV byte ptr [ESP + 0x20],0x0
00530081 : MOV EDX,dword ptr [EAX]
00530083 : MOV EBX,dword ptr [ECX + 0x10]
00530086 : LEA EBP,[ESP + 0x20]
0053008a : PUSH EBP
0053008b : ADD EDX,0x130
00530091 : ADD ECX,0x10
00530094 : PUSH EDX
00530095 : MOV EDX,dword ptr [EBX + 0x2c]
00530098 : PUSH EAX
00530099 : CALL EDX
0053009b : TEST AL,AL
0053009d : JZ 0x005300bc
0053009f : MOV EAX,dword ptr [EDI]
005300a1 : PUSH EAX
005300a2 : MOV ECX,EBP
005300a4 : CALL 0x00526fa0
005300a9 : MOV EDX,dword ptr [ESI]
005300ab : MOV EDX,dword ptr [EDX + 0x48]
005300ae : PUSH 0x1
005300b0 : PUSH EAX
005300b1 : MOV EAX,dword ptr [EDI]
005300b3 : PUSH EAX
005300b4 : MOV ECX,ESI
005300b6 : CALL EDX
005300b8 : MOV BL,AL
005300ba : JMP 0x005300c0
005300bc : MOV BL,byte ptr [ESP + 0x13]
005300c0 : LEA ECX,[ESP + 0x20]
005300c4 : CALL 0x00526bc0
005300c9 : TEST byte ptr [ESP + 0x1c],0x2
005300ce : JNZ 0x005300dd
005300d0 : MOV ECX,dword ptr [ESP + 0x14]
005300d4 : TEST ECX,ECX
005300d6 : JZ 0x005300dd
005300d8 : CALL 0x00503db0
005300dd : TEST byte ptr [ESP + 0x1c],0x1
005300e2 : MOV dword ptr [ESP + 0x14],0x0
005300ea : JNZ 0x005300f9
005300ec : MOV ECX,dword ptr [ESP + 0x18]
005300f0 : TEST ECX,ECX
005300f2 : JZ 0x005300f9
005300f4 : CALL 0x00503db0
005300f9 : MOV ESI,dword ptr [EDI]
005300fb : MOV ECX,dword ptr [ESI + 0x8]
005300fe : ADD ESI,0x8
00530101 : LEA EAX,[ECX + -0x20]
00530104 : CMP EAX,dword ptr [ESI + 0x4]
00530107 : JNC 0x0053012f
00530109 : MOV EBP,0x2
0053010e : MOV EDI,EDI
00530110 : MOV ECX,dword ptr [ESI]
00530112 : CALL 0x00526bc0
00530117 : ADD dword ptr [ESI],-0x10
0053011a : MOV EAX,dword ptr [ESI]
0053011c : CMP EAX,dword ptr [ESI + 0x4]
0053011f : JNC 0x00530128
00530121 : MOV ECX,ESI
00530123 : CALL 0x00504f30
00530128 : SUB EBP,0x1
0053012b : JNZ 0x00530110
0053012d : JMP 0x00530141
0053012f : CALL 0x00526bc0
00530134 : ADD dword ptr [ESI],-0x10
00530137 : MOV ECX,dword ptr [ESI]
00530139 : CALL 0x00526bc0
0053013e : ADD dword ptr [ESI],-0x10
00530141 : MOV ESI,dword ptr [EDI]
00530143 : ADD dword ptr [ESI + 0x8],0x10
00530147 : MOV EAX,dword ptr [ESI + 0x8]
0053014a : ADD ESI,0x8
0053014d : CMP EAX,dword ptr [ESI + 0x8]
00530150 : JC 0x00530159
00530152 : MOV ECX,ESI
00530154 : CALL 0x00504050
00530159 : MOV ESI,dword ptr [ESI]
0053015b : TEST ESI,ESI
0053015d : JZ 0x00530165
0053015f : MOV byte ptr [ESI],0x2
00530162 : MOV byte ptr [ESI + 0x4],BL
00530165 : POP EDI
00530166 : POP ESI
00530167 : POP EBP
00530168 : POP EBX
00530169 : ADD ESP,0x20
0053016c : RET

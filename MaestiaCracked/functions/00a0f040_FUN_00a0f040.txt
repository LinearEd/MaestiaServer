PROGRAM  : Maestia.exe
FUNCTION : FUN_00a0f040
ENTRY    : 00a0f040
BODY     : [[00a0f040, 00a0f1db]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a0f040(undefined4 param_1)

{
  undefined4 *puVar1;
  int iVar2;
  int in_ECX;
  int unaff_ESI;
  undefined1 local_25c [4];
  undefined2 local_258;
  undefined4 local_248;
  uint local_244;
  undefined1 local_23c [4];
  undefined4 local_238;
  undefined4 local_234;
  undefined1 local_230 [4];
  undefined4 local_22c;
  undefined4 local_21c;
  uint local_218;
  undefined1 local_214 [512];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b17151;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_234 = 0;
  FUN_00403510(local_25c,local_14);
  local_8 = 1;
  FUN_00403450(local_230,param_1);
  local_8 = CONCAT31(local_8._1_3_,3);
  if (7 < local_244) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_244 = 7;
  local_248 = 0;
  local_258 = 0;
  puVar1 = local_22c;
  if (local_218 < 8) {
    puVar1 = &local_22c;
  }
  iVar2 = FtpCreateDirectoryW(*(undefined4 *)(in_ECX + 8),puVar1);
  if (iVar2 == 1) {
    *(undefined4 *)(unaff_ESI + 0x18) = 7;
    *(undefined4 *)(unaff_ESI + 0x14) = 0;
    *(undefined2 *)(unaff_ESI + 4) = 0;
    FUN_00405eb0(local_230,0,0xffffffff);
  }
  else {
    local_238 = 0xff;
    InternetGetLastResponseInfoW(local_23c,local_214,&local_238);
    GetLastError();
    *(undefined4 *)(unaff_ESI + 0x18) = 7;
    *(undefined4 *)(unaff_ESI + 0x14) = 0;
    *(undefined2 *)(unaff_ESI + 4) = 0;
    FUN_00405eb0(local_230,0,0xffffffff);
  }
  local_234 = 1;
  local_8 = local_8 & 0xffffff00;
  if (7 < local_218) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_218 = 7;
  local_21c = 0;
  local_22c = (undefined4 *)((uint)local_22c._2_2_ << 0x10);
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a0f040 : PUSH EBP
00a0f041 : MOV EBP,ESP
00a0f043 : PUSH -0x1
00a0f045 : PUSH 0xb17151
00a0f04a : MOV EAX,FS:[0x0]
00a0f050 : PUSH EAX
00a0f051 : SUB ESP,0x24c
00a0f057 : MOV EAX,[0x00d66fa0]
00a0f05c : XOR EAX,EBP
00a0f05e : MOV dword ptr [EBP + -0x10],EAX
00a0f061 : PUSH EBX
00a0f062 : PUSH EDI
00a0f063 : PUSH EAX
00a0f064 : LEA EAX,[EBP + -0xc]
00a0f067 : MOV FS:[0x0],EAX
00a0f06d : MOV EBX,dword ptr [EBP + 0x8]
00a0f070 : MOV EDI,ECX
00a0f072 : LEA EAX,[EBP + 0xfffffda8]
00a0f078 : LEA ECX,[EDI + 0xc]
00a0f07b : PUSH EAX
00a0f07c : MOV EDX,0xcbd854
00a0f081 : MOV dword ptr [EBP + 0xfffffdc4],ESI
00a0f087 : MOV dword ptr [EBP + 0xfffffdd0],0x0
00a0f091 : CALL 0x00403510
00a0f096 : MOV dword ptr [EBP + -0x4],0x1
00a0f09d : LEA ECX,[EBP + 0xfffffdd4]
00a0f0a3 : PUSH EBX
00a0f0a4 : PUSH ECX
00a0f0a5 : MOV ECX,EAX
00a0f0a7 : CALL 0x00403450
00a0f0ac : ADD ESP,0xc
00a0f0af : MOV byte ptr [EBP + -0x4],0x3
00a0f0b3 : MOV EBX,0x8
00a0f0b8 : CMP dword ptr [EBP + 0xfffffdc0],EBX
00a0f0be : JC 0x00a0f0cb
00a0f0c0 : MOV ECX,dword ptr [EBP + 0xfffffdac]
00a0f0c6 : CALL 0x006f04e0
00a0f0cb : MOV EAX,dword ptr [EBP + 0xfffffdd8]
00a0f0d1 : XOR EDX,EDX
00a0f0d3 : MOV dword ptr [EBP + 0xfffffdc0],0x7
00a0f0dd : MOV dword ptr [EBP + 0xfffffdbc],0x0
00a0f0e7 : MOV word ptr [EBP + 0xfffffdac],DX
00a0f0ee : CMP dword ptr [EBP + 0xfffffdec],EBX
00a0f0f4 : JNC 0x00a0f0fc
00a0f0f6 : LEA EAX,[EBP + 0xfffffdd8]
00a0f0fc : PUSH EAX
00a0f0fd : MOV EAX,dword ptr [EDI + 0x8]
00a0f100 : PUSH EAX
00a0f101 : CALL dword ptr [0x00b85560]
00a0f107 : MOV EDI,0x1
00a0f10c : CMP EAX,EDI
00a0f10e : JNZ 0x00a0f137
00a0f110 : XOR ECX,ECX
00a0f112 : PUSH -0x1
00a0f114 : PUSH ECX
00a0f115 : MOV dword ptr [ESI + 0x18],0x7
00a0f11c : MOV dword ptr [ESI + 0x14],0x0
00a0f123 : LEA EDX,[EBP + 0xfffffdd4]
00a0f129 : MOV word ptr [ESI + 0x4],CX
00a0f12d : PUSH EDX
00a0f12e : MOV ECX,ESI
00a0f130 : CALL 0x00405eb0
00a0f135 : JMP 0x00a0f187
00a0f137 : LEA ECX,[EBP + 0xfffffdcc]
00a0f13d : PUSH ECX
00a0f13e : LEA EDX,[EBP + 0xfffffdf0]
00a0f144 : PUSH EDX
00a0f145 : LEA EAX,[EBP + 0xfffffdc8]
00a0f14b : PUSH EAX
00a0f14c : MOV dword ptr [EBP + 0xfffffdcc],0xff
00a0f156 : CALL dword ptr [0x00b8555c]
00a0f15c : CALL dword ptr [0x00b85128]
00a0f162 : XOR ECX,ECX
00a0f164 : PUSH -0x1
00a0f166 : PUSH ECX
00a0f167 : MOV dword ptr [ESI + 0x18],0x7
00a0f16e : MOV dword ptr [ESI + 0x14],0x0
00a0f175 : LEA EDX,[EBP + 0xfffffdd4]
00a0f17b : MOV word ptr [ESI + 0x4],CX
00a0f17f : PUSH EDX
00a0f180 : MOV ECX,ESI
00a0f182 : CALL 0x00405eb0
00a0f187 : MOV dword ptr [EBP + 0xfffffdd0],EDI
00a0f18d : MOV byte ptr [EBP + -0x4],0x0
00a0f191 : CMP dword ptr [EBP + 0xfffffdec],EBX
00a0f197 : JC 0x00a0f1a4
00a0f199 : MOV ECX,dword ptr [EBP + 0xfffffdd8]
00a0f19f : CALL 0x006f04e0
00a0f1a4 : XOR EAX,EAX
00a0f1a6 : MOV dword ptr [EBP + 0xfffffdec],0x7
00a0f1b0 : MOV dword ptr [EBP + 0xfffffde8],EAX
00a0f1b6 : MOV word ptr [EBP + 0xfffffdd8],AX
00a0f1bd : MOV EAX,ESI
00a0f1bf : MOV ECX,dword ptr [EBP + -0xc]
00a0f1c2 : MOV dword ptr FS:[0x0],ECX
00a0f1c9 : POP ECX
00a0f1ca : POP EDI
00a0f1cb : POP EBX
00a0f1cc : MOV ECX,dword ptr [EBP + -0x10]
00a0f1cf : XOR ECX,EBP
00a0f1d1 : CALL 0x00633e6b
00a0f1d6 : MOV ESP,EBP
00a0f1d8 : POP EBP
00a0f1d9 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : __get_osfhandle
ENTRY    : 0065cc0b
BODY     : [[0065cc0b, 0065cc81]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    __get_osfhandle
   
   Library: Visual Studio 2008 Release */

intptr_t __cdecl __get_osfhandle(int _FileHandle)

{
  ulong *puVar1;
  int *piVar2;
  intptr_t *piVar3;
  intptr_t iVar4;
  
  if (_FileHandle == -2) {
    puVar1 = ___doserrno();
    *puVar1 = 0;
    piVar2 = __errno();
    *piVar2 = 9;
    return -1;
  }
  if (((_FileHandle < 0) || (DAT_01728c30 <= (uint)_FileHandle)) ||
     (piVar3 = (intptr_t *)((_FileHandle & 0x1fU) * 0x40 + (&DAT_01728c40)[_FileHandle >> 5]),
     (*(byte *)(piVar3 + 1) & 1) == 0)) {
    puVar1 = ___doserrno();
    *puVar1 = 0;
    piVar2 = __errno();
    *piVar2 = 9;
    __invalid_parameter(0,0,0,0,0);
    iVar4 = -1;
  }
  else {
    iVar4 = *piVar3;
  }
  return iVar4;
}



============================================================
DISASSEMBLY
============================================================
0065cc0b : MOV EDI,EDI
0065cc0d : PUSH EBP
0065cc0e : MOV EBP,ESP
0065cc10 : MOV EAX,dword ptr [EBP + 0x8]
0065cc13 : CMP EAX,-0x2
0065cc16 : JNZ 0x0065cc30
0065cc18 : CALL 0x0063ab95
0065cc1d : AND dword ptr [EAX],0x0
0065cc20 : CALL 0x0063ab82
0065cc25 : MOV dword ptr [EAX],0x9
0065cc2b : OR EAX,0xffffffff
0065cc2e : POP EBP
0065cc2f : RET
0065cc30 : PUSH ESI
0065cc31 : XOR ESI,ESI
0065cc33 : CMP EAX,ESI
0065cc35 : JL 0x0065cc59
0065cc37 : CMP EAX,dword ptr [0x01728c30]
0065cc3d : JNC 0x0065cc59
0065cc3f : MOV ECX,EAX
0065cc41 : AND EAX,0x1f
0065cc44 : SAR ECX,0x5
0065cc47 : MOV ECX,dword ptr [ECX*0x4 + 0x1728c40]
0065cc4e : SHL EAX,0x6
0065cc51 : ADD EAX,ECX
0065cc53 : TEST byte ptr [EAX + 0x4],0x1
0065cc57 : JNZ 0x0065cc7d
0065cc59 : CALL 0x0063ab95
0065cc5e : MOV dword ptr [EAX],ESI
0065cc60 : CALL 0x0063ab82
0065cc65 : PUSH ESI
0065cc66 : PUSH ESI
0065cc67 : PUSH ESI
0065cc68 : PUSH ESI
0065cc69 : PUSH ESI
0065cc6a : MOV dword ptr [EAX],0x9
0065cc70 : CALL 0x006372b8
0065cc75 : ADD ESP,0x14
0065cc78 : OR EAX,0xffffffff
0065cc7b : JMP 0x0065cc7f
0065cc7d : MOV EAX,dword ptr [EAX]
0065cc7f : POP ESI
0065cc80 : POP EBP
0065cc81 : RET

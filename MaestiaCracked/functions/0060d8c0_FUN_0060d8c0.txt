PROGRAM  : Maestia.exe
FUNCTION : FUN_0060d8c0
ENTRY    : 0060d8c0
BODY     : [[0060d8c0, 0060dc0a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0060d8c0(float param_1,int param_2,byte *param_3,byte *param_4)

{
  undefined1 uVar1;
  undefined1 uVar2;
  short sVar3;
  byte *pbVar4;
  int iVar5;
  undefined4 uVar6;
  byte bVar7;
  GThread *this;
  GThread *this_00;
  GThread *extraout_ECX;
  GThread *extraout_ECX_00;
  GThread *extraout_ECX_01;
  GThread *pGVar8;
  byte *pbVar9;
  uint uVar10;
  int iVar11;
  bool bVar12;
  
  iVar11 = *(int *)((int)param_1 + 0x314);
  if (iVar11 == 0) {
    iVar11 = (int)param_1 + 0x28;
  }
  *(undefined1 *)(iVar11 + 0x15) = 0;
  if (*(int *)(iVar11 + 0x30) - *(int *)(iVar11 + 0x2c) < 1) {
    FUN_0053a0a0();
  }
  pbVar9 = param_4;
  pbVar4 = param_3;
  iVar5 = *(int *)(iVar11 + 0x3c);
  bVar7 = *(byte *)(*(int *)(iVar11 + 0x2c) + iVar5);
  *(int *)(iVar11 + 0x2c) = *(int *)(iVar11 + 0x2c) + 1;
  *param_3 = bVar7;
  *param_4 = bVar7;
  GThread::OnExit((GThread *)CONCAT31((int3)((uint)iVar5 >> 8),bVar7));
  bVar7 = *pbVar4;
  if (bVar7 == 0) {
    FUN_0053b150(&param_1);
    FUN_0053b150(&param_2);
    *(float *)(pbVar4 + 4) = param_1;
    *(int *)(pbVar9 + 4) = param_2;
    GThread::OnExit(this);
    GThread::OnExit(this_00);
    return;
  }
  if ((bVar7 & 0x10) == 0) {
    if ((bVar7 & 0x40) != 0) {
      *(undefined1 *)(iVar11 + 0x15) = 0;
      if (*(int *)(iVar11 + 0x30) - *(int *)(iVar11 + 0x2c) < 2) {
        FUN_00539fb0(2);
      }
      pGVar8 = (GThread *)(uint)*(ushort *)(*(int *)(iVar11 + 0x3c) + *(int *)(iVar11 + 0x2c));
      *(int *)(iVar11 + 0x2c) = *(int *)(iVar11 + 0x2c) + 2;
      GThread::OnExit(pGVar8);
      FUN_00565560(pbVar4 + 8,pGVar8);
      FUN_004ffda0(pbVar4 + 8);
      FUN_0053acd0(pbVar4 + 0x10);
      FUN_0053acd0(pbVar9 + 0x10);
    }
  }
  else {
    FUN_0053acd0(pbVar4 + 0x10);
    FUN_0053acd0(pbVar9 + 0x10);
    *(undefined1 *)(iVar11 + 0x15) = 0;
    if (*(int *)(iVar11 + 0x30) - *(int *)(iVar11 + 0x2c) < 1) {
      FUN_0053a0a0();
    }
    bVar7 = *(byte *)(*(int *)(iVar11 + 0x2c) + *(int *)(iVar11 + 0x3c));
    *(int *)(iVar11 + 0x2c) = *(int *)(iVar11 + 0x2c) + 1;
    bVar12 = false;
    if ((param_2 == 0x54) || (*pbVar4 == 0x13)) {
      bVar12 = (bVar7 & 0x10) != 0;
      bVar7 = bVar7 & 0xf;
    }
    param_3 = (byte *)CONCAT31(param_3._1_3_,bVar7);
    iVar5 = FUN_00515840(0x14,0);
    if (iVar5 == 0) {
      uVar6 = 0;
    }
    else {
      uVar6 = FUN_005d5d30(*pbVar4,(uint)param_3 & 0xff,bVar12);
    }
    *(undefined4 *)(pbVar4 + 4) = uVar6;
    iVar5 = FUN_00515840(0x14,0);
    if (iVar5 == 0) {
      iVar5 = 0;
      pGVar8 = extraout_ECX;
    }
    else {
      iVar5 = FUN_005d5d30(*pbVar9,(uint)param_3 & 0xff,bVar12);
      pGVar8 = extraout_ECX_00;
    }
    *(int *)(pbVar9 + 4) = iVar5;
    if ((*(int *)(pbVar4 + 4) == 0) || (iVar5 == 0)) {
      *pbVar4 = 0;
      *pbVar9 = 0;
      return;
    }
    param_3 = (byte *)((uint)param_3 & 0xff);
    uVar10 = 0;
    if (param_3 != (byte *)0x0) {
      do {
        FUN_005d4690(param_1,param_2);
        FUN_005d4690(param_1,param_2);
        uVar10 = uVar10 + 1;
        pGVar8 = extraout_ECX_01;
        pbVar9 = param_4;
      } while (uVar10 < param_3);
    }
    GThread::OnExit(pGVar8);
    if (*pbVar4 == 0x13) {
      *(undefined1 *)(iVar11 + 0x15) = 0;
      if (*(int *)(iVar11 + 0x30) - *(int *)(iVar11 + 0x2c) < 2) {
        FUN_00539fb0(2);
      }
      iVar5 = *(int *)(iVar11 + 0x2c);
      uVar1 = *(undefined1 *)(*(int *)(iVar11 + 0x3c) + 1 + iVar5);
      uVar2 = *(undefined1 *)(*(int *)(iVar11 + 0x3c) + iVar5);
      *(int *)(iVar11 + 0x2c) = iVar5 + 2;
      param_1 = (float)(int)CONCAT11(uVar1,uVar2) * 0.00390625;
      *(float *)(*(int *)(pbVar4 + 4) + 0x10) = param_1;
      *(undefined1 *)(iVar11 + 0x15) = 0;
      if (*(int *)(iVar11 + 0x30) - *(int *)(iVar11 + 0x2c) < 2) {
        FUN_00539fb0(2);
      }
      sVar3 = *(short *)(*(int *)(iVar11 + 0x3c) + *(int *)(iVar11 + 0x2c));
      *(int *)(iVar11 + 0x2c) = *(int *)(iVar11 + 0x2c) + 2;
      *(float *)(*(int *)(pbVar9 + 4) + 0x10) = (float)(int)sVar3 * 0.00390625;
      return;
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
0060d8c0 : PUSH ECX
0060d8c1 : PUSH EBX
0060d8c2 : PUSH EBP
0060d8c3 : PUSH ESI
0060d8c4 : MOV ESI,dword ptr [ESP + 0x14]
0060d8c8 : MOV EAX,dword ptr [ESI + 0x314]
0060d8ce : PUSH EDI
0060d8cf : TEST EAX,EAX
0060d8d1 : JNZ 0x0060d8d8
0060d8d3 : ADD ESI,0x28
0060d8d6 : JMP 0x0060d8da
0060d8d8 : MOV ESI,EAX
0060d8da : MOV EAX,dword ptr [ESI + 0x30]
0060d8dd : SUB EAX,dword ptr [ESI + 0x2c]
0060d8e0 : MOV byte ptr [ESI + 0x15],0x0
0060d8e4 : CMP EAX,0x1
0060d8e7 : JGE 0x0060d8f0
0060d8e9 : MOV ECX,ESI
0060d8eb : CALL 0x0053a0a0
0060d8f0 : MOV EAX,dword ptr [ESI + 0x2c]
0060d8f3 : MOV ECX,dword ptr [ESI + 0x3c]
0060d8f6 : MOV CL,byte ptr [EAX + ECX*0x1]
0060d8f9 : MOV EDI,dword ptr [ESP + 0x20]
0060d8fd : MOV EBX,dword ptr [ESP + 0x24]
0060d901 : INC EAX
0060d902 : MOV dword ptr [ESI + 0x2c],EAX
0060d905 : MOV byte ptr [EDI],CL
0060d907 : MOV byte ptr [EBX],CL
0060d909 : MOVZX EDX,byte ptr [EDI]
0060d90c : PUSH EDX
0060d90d : PUSH 0xb95804
0060d912 : PUSH ESI
0060d913 : CALL 0x0051d420
0060d918 : MOV AL,byte ptr [EDI]
0060d91a : ADD ESP,0xc
0060d91d : TEST AL,AL
0060d91f : JNZ 0x0060d968
0060d921 : LEA EAX,[ESP + 0x18]
0060d925 : PUSH EAX
0060d926 : MOV ECX,ESI
0060d928 : CALL 0x0053b150
0060d92d : LEA ECX,[ESP + 0x1c]
0060d931 : PUSH ECX
0060d932 : MOV ECX,ESI
0060d934 : CALL 0x0053b150
0060d939 : MOV EDX,dword ptr [ESP + 0x18]
0060d93d : MOV EAX,dword ptr [ESP + 0x1c]
0060d941 : PUSH 0xb957e4
0060d946 : MOV dword ptr [EDI + 0x4],EDX
0060d949 : PUSH ESI
0060d94a : MOV dword ptr [EBX + 0x4],EAX
0060d94d : CALL 0x0051d420
0060d952 : PUSH 0xb957c4
0060d957 : PUSH ESI
0060d958 : CALL 0x0051d420
0060d95d : ADD ESP,0x10
0060d960 : POP EDI
0060d961 : POP ESI
0060d962 : POP EBP
0060d963 : POP EBX
0060d964 : POP ECX
0060d965 : RET 0x10
0060d968 : TEST AL,0x10
0060d96a : JZ 0x0060db7c
0060d970 : LEA ECX,[EDI + 0x10]
0060d973 : PUSH ECX
0060d974 : MOV ECX,ESI
0060d976 : CALL 0x0053acd0
0060d97b : LEA EDX,[EBX + 0x10]
0060d97e : PUSH EDX
0060d97f : MOV ECX,ESI
0060d981 : CALL 0x0053acd0
0060d986 : MOV EAX,dword ptr [ESI + 0x30]
0060d989 : SUB EAX,dword ptr [ESI + 0x2c]
0060d98c : MOV byte ptr [ESI + 0x15],0x0
0060d990 : CMP EAX,0x1
0060d993 : JGE 0x0060d99c
0060d995 : MOV ECX,ESI
0060d997 : CALL 0x0053a0a0
0060d99c : MOV EAX,dword ptr [ESI + 0x2c]
0060d99f : MOV ECX,dword ptr [ESI + 0x3c]
0060d9a2 : MOV CL,byte ptr [EAX + ECX*0x1]
0060d9a5 : INC EAX
0060d9a6 : CMP dword ptr [ESP + 0x1c],0x54
0060d9ab : MOV byte ptr [ESP + 0x20],CL
0060d9af : MOV dword ptr [ESI + 0x2c],EAX
0060d9b2 : MOV byte ptr [ESP + 0x10],0x0
0060d9b7 : JZ 0x0060d9be
0060d9b9 : CMP byte ptr [EDI],0x13
0060d9bc : JNZ 0x0060d9cf
0060d9be : TEST CL,0x10
0060d9c1 : JZ 0x0060d9c8
0060d9c3 : MOV byte ptr [ESP + 0x10],0x1
0060d9c8 : AND CL,0xf
0060d9cb : MOV byte ptr [ESP + 0x20],CL
0060d9cf : MOV ECX,dword ptr [0x00d73250]
0060d9d5 : PUSH 0x0
0060d9d7 : PUSH 0x14
0060d9d9 : CALL 0x00515840
0060d9de : MOV EBP,dword ptr [ESP + 0x10]
0060d9e2 : TEST EAX,EAX
0060d9e4 : JZ 0x0060d9fe
0060d9e6 : MOVZX DX,byte ptr [ESP + 0x20]
0060d9ec : MOVZX ECX,DX
0060d9ef : MOVZX EDX,byte ptr [EDI]
0060d9f2 : PUSH EBP
0060d9f3 : PUSH ECX
0060d9f4 : PUSH EDX
0060d9f5 : MOV ECX,EAX
0060d9f7 : CALL 0x005d5d30
0060d9fc : JMP 0x0060da00
0060d9fe : XOR EAX,EAX
0060da00 : PUSH 0x0
0060da02 : MOV dword ptr [EDI + 0x4],EAX
0060da05 : MOV ECX,dword ptr [0x00d73250]
0060da0b : PUSH 0x14
0060da0d : CALL 0x00515840
0060da12 : TEST EAX,EAX
0060da14 : JZ 0x0060da2e
0060da16 : MOVZX CX,byte ptr [ESP + 0x20]
0060da1c : MOVZX EDX,CX
0060da1f : MOVZX ECX,byte ptr [EBX]
0060da22 : PUSH EBP
0060da23 : PUSH EDX
0060da24 : PUSH ECX
0060da25 : MOV ECX,EAX
0060da27 : CALL 0x005d5d30
0060da2c : JMP 0x0060da30
0060da2e : XOR EAX,EAX
0060da30 : MOV dword ptr [EBX + 0x4],EAX
0060da33 : CMP dword ptr [EDI + 0x4],0x0
0060da37 : JZ 0x0060db6e
0060da3d : TEST EAX,EAX
0060da3f : JZ 0x0060db6e
0060da45 : MOVZX EAX,byte ptr [ESP + 0x20]
0060da4a : XOR EBP,EBP
0060da4c : MOV dword ptr [ESP + 0x20],EAX
0060da50 : TEST EAX,EAX
0060da52 : JBE 0x0060da9c
0060da54 : MOV EDX,dword ptr [ESP + 0x1c]
0060da58 : MOV ECX,dword ptr [EDI + 0x4]
0060da5b : MOV EAX,dword ptr [ESP + 0x18]
0060da5f : MOV ECX,dword ptr [ECX + 0xc]
0060da62 : PUSH EDX
0060da63 : LEA EBX,[EBP*0x8 + 0x0]
0060da6a : PUSH EAX
0060da6b : ADD ECX,EBX
0060da6d : CALL 0x005d4690
0060da72 : MOV EDX,dword ptr [ESP + 0x1c]
0060da76 : MOV ECX,dword ptr [ESP + 0x24]
0060da7a : MOV EAX,dword ptr [ESP + 0x18]
0060da7e : PUSH EDX
0060da7f : MOV EDX,dword ptr [ECX + 0x4]
0060da82 : MOV ECX,dword ptr [EDX + 0xc]
0060da85 : PUSH EAX
0060da86 : ADD ECX,EBX
0060da88 : CALL 0x005d4690
0060da8d : INC EBP
0060da8e : CMP EBP,dword ptr [ESP + 0x20]
0060da92 : JC 0x0060da54
0060da94 : MOV EAX,dword ptr [ESP + 0x20]
0060da98 : MOV EBX,dword ptr [ESP + 0x24]
0060da9c : PUSH EAX
0060da9d : PUSH 0xb957a4
0060daa2 : PUSH ESI
0060daa3 : CALL 0x0051d420
0060daa8 : ADD ESP,0xc
0060daab : CMP byte ptr [EDI],0x13
0060daae : JNZ 0x0060dc03
0060dab4 : MOV EAX,dword ptr [ESI + 0x30]
0060dab7 : SUB EAX,dword ptr [ESI + 0x2c]
0060daba : MOV byte ptr [ESI + 0x15],0x0
0060dabe : CMP EAX,0x2
0060dac1 : JGE 0x0060dacc
0060dac3 : PUSH 0x2
0060dac5 : MOV ECX,ESI
0060dac7 : CALL 0x00539fb0
0060dacc : MOV EAX,dword ptr [ESI + 0x2c]
0060dacf : MOV ECX,dword ptr [ESI + 0x3c]
0060dad2 : MOVZX DX,byte ptr [ECX + EAX*0x1 + 0x1]
0060dad8 : ADD ECX,EAX
0060dada : MOVZX CX,byte ptr [ECX]
0060dade : SHL DX,0x8
0060dae2 : OR DX,CX
0060dae5 : MOVZX ECX,DX
0060dae8 : MOVSX EDX,CX
0060daeb : MOV dword ptr [ESP + 0x18],EDX
0060daef : ADD EAX,0x2
0060daf2 : FILD dword ptr [ESP + 0x18]
0060daf6 : MOV dword ptr [ESI + 0x2c],EAX
0060daf9 : MOV EAX,dword ptr [EDI + 0x4]
0060dafc : FMUL double ptr [0x00b86f00]
0060db02 : FSTP float ptr [ESP + 0x18]
0060db06 : FLD float ptr [ESP + 0x18]
0060db0a : FSTP float ptr [EAX + 0x10]
0060db0d : MOV ECX,dword ptr [ESI + 0x30]
0060db10 : SUB ECX,dword ptr [ESI + 0x2c]
0060db13 : MOV byte ptr [ESI + 0x15],0x0
0060db17 : CMP ECX,0x2
0060db1a : JGE 0x0060db25
0060db1c : PUSH 0x2
0060db1e : MOV ECX,ESI
0060db20 : CALL 0x00539fb0
0060db25 : MOV EAX,dword ptr [ESI + 0x2c]
0060db28 : MOV EDX,dword ptr [ESI + 0x3c]
0060db2b : LEA ECX,[EDX + EAX*0x1]
0060db2e : MOVZX DX,byte ptr [ECX + 0x1]
0060db33 : MOVZX CX,byte ptr [ECX]
0060db37 : SHL DX,0x8
0060db3b : OR DX,CX
0060db3e : MOVZX ECX,DX
0060db41 : MOVSX EDX,CX
0060db44 : MOV dword ptr [ESP + 0x18],EDX
0060db48 : ADD EAX,0x2
0060db4b : FILD dword ptr [ESP + 0x18]
0060db4f : MOV dword ptr [ESI + 0x2c],EAX
0060db52 : MOV EAX,dword ptr [EBX + 0x4]
0060db55 : FMUL double ptr [0x00b86f00]
0060db5b : FSTP float ptr [ESP + 0x18]
0060db5f : FLD float ptr [ESP + 0x18]
0060db63 : FSTP float ptr [EAX + 0x10]
0060db66 : POP EDI
0060db67 : POP ESI
0060db68 : POP EBP
0060db69 : POP EBX
0060db6a : POP ECX
0060db6b : RET 0x10
0060db6e : MOV byte ptr [EDI],0x0
0060db71 : MOV byte ptr [EBX],0x0
0060db74 : POP EDI
0060db75 : POP ESI
0060db76 : POP EBP
0060db77 : POP EBX
0060db78 : POP ECX
0060db79 : RET 0x10
0060db7c : TEST AL,0x40
0060db7e : JZ 0x0060dc03
0060db84 : MOV ECX,dword ptr [ESI + 0x30]
0060db87 : SUB ECX,dword ptr [ESI + 0x2c]
0060db8a : MOV byte ptr [ESI + 0x15],0x0
0060db8e : CMP ECX,0x2
0060db91 : JGE 0x0060db9c
0060db93 : PUSH 0x2
0060db95 : MOV ECX,ESI
0060db97 : CALL 0x00539fb0
0060db9c : MOV EAX,dword ptr [ESI + 0x2c]
0060db9f : MOV EDX,dword ptr [ESI + 0x3c]
0060dba2 : LEA ECX,[EDX + EAX*0x1]
0060dba5 : MOVZX DX,byte ptr [ECX + 0x1]
0060dbaa : MOVZX CX,byte ptr [ECX]
0060dbae : SHL DX,0x8
0060dbb2 : OR DX,CX
0060dbb5 : MOVZX ECX,DX
0060dbb8 : MOVZX EBP,CX
0060dbbb : PUSH EBP
0060dbbc : ADD EAX,0x2
0060dbbf : PUSH 0xb95788
0060dbc4 : PUSH ESI
0060dbc5 : MOV dword ptr [ESI + 0x2c],EAX
0060dbc8 : CALL 0x0051d420
0060dbcd : MOV EDX,dword ptr [ESP + 0x24]
0060dbd1 : ADD ESP,0x8
0060dbd4 : MOV EAX,ESP
0060dbd6 : MOV dword ptr [EAX],EBP
0060dbd8 : MOV ECX,dword ptr [EDX + 0x20]
0060dbdb : LEA EBP,[EDI + 0x8]
0060dbde : PUSH EBP
0060dbdf : CALL 0x00565560
0060dbe4 : PUSH EBP
0060dbe5 : LEA ECX,[EBX + 0x8]
0060dbe8 : CALL 0x004ffda0
0060dbed : ADD EDI,0x10
0060dbf0 : PUSH EDI
0060dbf1 : MOV ECX,ESI
0060dbf3 : CALL 0x0053acd0
0060dbf8 : ADD EBX,0x10
0060dbfb : PUSH EBX
0060dbfc : MOV ECX,ESI
0060dbfe : CALL 0x0053acd0
0060dc03 : POP EDI
0060dc04 : POP ESI
0060dc05 : POP EBP
0060dc06 : POP EBX
0060dc07 : POP ECX
0060dc08 : RET 0x10

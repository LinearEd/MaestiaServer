PROGRAM  : Maestia.exe
FUNCTION : FUN_00acbb30
ENTRY    : 00acbb30
BODY     : [[00acbb30, 00acbc8b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00acbb30(undefined4 param_1)

{
  uint8_t *packet;
  int iVar1;
  byte bVar2;
  short *psVar3;
  short *psVar4;
  int unaff_ESI;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b40908;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  FUN_00acb9d0(unaff_ESI,param_1);
  iVar1 = *(int *)ThreadLocalStoragePointer;
  bVar2 = (byte)((ulonglong)(*(byte *)(iVar1 + 0x18) + 1) % 3);
  *(byte *)(iVar1 + 0x18) = bVar2;
  packet = (uint8_t *)((uint)bVar2 * 0x2000 + 0x122cb8 + iVar1);
  iVar1 = 0;
  if (packet == (uint8_t *)0x0) {
    packet = (uint8_t *)0x0;
  }
  else {
    packet[0] = '\0';
    packet[1] = '\0';
    packet[2] = 0x8f;
    packet[3] = '\a';
    packet[0x14] = '\0';
    packet[0x15] = '\0';
    packet[0x16] = '\0';
    packet[0x17] = '\0';
    packet[0x18] = '\0';
    packet[0x19] = '\0';
    packet[0x1e] = '\0';
    packet[0x1f] = '\0';
    packet[0x20] = '\0';
    packet[0x21] = '\0';
    packet[0x22] = '\0';
    packet[0x23] = '\0';
    packet[0x24] = '\0';
    packet[0x25] = '\0';
    packet[0x26] = '\0';
    packet[0x27] = '\0';
    packet[0x28] = '\0';
    packet[0x29] = '\0';
    packet[0x2b] = '\0';
    packet[0x2c] = '\0';
    packet[0x2a] = '\0';
    packet[0x1a] = 'd';
    packet[0x1b] = '\0';
    packet[0x1c] = '\0';
    packet[0x1d] = '\0';
    packet[0x2d] = 'd';
    packet[0x2e] = '\0';
    packet[0x2f] = 'd';
    packet[0x30] = '\0';
  }
  local_8 = 0xffffffff;
  *(undefined2 *)(packet + 4) = *(undefined2 *)(unaff_ESI + 0x38);
  *(int *)(packet + 0x10) = *(int *)(unaff_ESI + 0x60) * 60000;
  psVar3 = (short *)(packet + 6);
  psVar4 = (short *)(unaff_ESI + 0x56);
  do {
    if (*psVar4 == 0) break;
    *psVar3 = *psVar4;
    iVar1 = iVar1 + 1;
    psVar4 = psVar4 + 1;
    psVar3 = psVar3 + 1;
  } while (iVar1 < 5);
  *(undefined2 *)(packet + 0x14) = *(undefined2 *)(unaff_ESI + 0x6c);
  *(undefined2 *)(packet + 0x16) = *(undefined2 *)(unaff_ESI + 100);
  *(undefined2 *)(packet + 0x18) = *(undefined2 *)(unaff_ESI + 0x68);
  *(undefined4 *)(packet + 0x1a) = *(undefined4 *)(unaff_ESI + 0x70);
  *(undefined2 *)(packet + 0x2d) = *(undefined2 *)(unaff_ESI + 0x74);
  *(undefined2 *)(packet + 0x2f) = *(undefined2 *)(unaff_ESI + 0x78);
  *(undefined4 *)(packet + 0x1e) = *(undefined4 *)(unaff_ESI + 0xac);
  *(undefined4 *)(packet + 0x22) = *(undefined4 *)(unaff_ESI + 0xa4);
  *(undefined4 *)(packet + 0x26) = *(undefined4 *)(unaff_ESI + 0xa8);
  *(undefined2 *)(packet + 0x2b) = *(undefined2 *)(unaff_ESI + 0xb0);
  if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
    FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),0x31,packet);
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00acbb30 : PUSH EBP
00acbb31 : MOV EBP,ESP
00acbb33 : PUSH -0x1
00acbb35 : PUSH 0xb40908
00acbb3a : MOV EAX,FS:[0x0]
00acbb40 : PUSH EAX
00acbb41 : PUSH ECX
00acbb42 : PUSH EBX
00acbb43 : PUSH EDI
00acbb44 : MOV EAX,[0x00d66fa0]
00acbb49 : XOR EAX,EBP
00acbb4b : PUSH EAX
00acbb4c : LEA EAX,[EBP + -0xc]
00acbb4f : MOV FS:[0x0],EAX
00acbb55 : MOV EAX,dword ptr [EBP + 0x8]
00acbb58 : PUSH EAX
00acbb59 : PUSH ESI
00acbb5a : CALL 0x00acb9d0
00acbb5f : MOV ECX,dword ptr FS:[0x2c]
00acbb66 : MOV ECX,dword ptr [ECX]
00acbb68 : MOVZX EAX,byte ptr [ECX + 0x18]
00acbb6c : INC EAX
00acbb6d : CDQ
00acbb6e : MOV EDI,0x3
00acbb73 : IDIV EDI
00acbb75 : MOV byte ptr [ECX + 0x18],DL
00acbb78 : MOVZX EDX,DL
00acbb7b : SHL EDX,0xd
00acbb7e : LEA EAX,[EDX + ECX*0x1 + 0x122cb8]
00acbb85 : MOV dword ptr [EBP + 0x8],EAX
00acbb88 : XOR ECX,ECX
00acbb8a : MOV dword ptr [EBP + -0x4],ECX
00acbb8d : CMP EAX,ECX
00acbb8f : JZ 0x00acbbce
00acbb91 : XOR EDX,EDX
00acbb93 : MOV word ptr [EAX],DX
00acbb96 : MOV byte ptr [EAX + 0x2],0x8f
00acbb9a : MOV byte ptr [EAX + 0x3],0x7
00acbb9e : MOV dword ptr [EAX + 0x14],ECX
00acbba1 : MOV word ptr [EAX + 0x18],CX
00acbba5 : PXOR XMM0,XMM0
00acbba9 : MOVQ qword ptr [EAX + 0x1e],XMM0
00acbbae : MOV dword ptr [EAX + 0x26],ECX
00acbbb1 : MOV word ptr [EAX + 0x2b],DX
00acbbb5 : MOV EDX,0x64
00acbbba : MOV byte ptr [EAX + 0x2a],CL
00acbbbd : MOV dword ptr [EAX + 0x1a],0x64
00acbbc4 : MOV word ptr [EAX + 0x2d],DX
00acbbc8 : MOV word ptr [EAX + 0x2f],DX
00acbbcc : JMP 0x00acbbd0
00acbbce : XOR EAX,EAX
00acbbd0 : MOV dword ptr [EBP + -0x4],0xffffffff
00acbbd7 : MOV DX,word ptr [ESI + 0x38]
00acbbdb : MOV word ptr [EAX + 0x4],DX
00acbbdf : MOV EDX,dword ptr [ESI + 0x60]
00acbbe2 : IMUL EDX,EDX,0xea60
00acbbe8 : MOV dword ptr [EAX + 0x10],EDX
00acbbeb : LEA EDX,[EAX + 0x6]
00acbbee : LEA EBX,[ESI + 0x56]
00acbbf1 : MOVZX EDI,word ptr [EBX]
00acbbf4 : TEST DI,DI
00acbbf7 : JZ 0x00acbc08
00acbbf9 : MOV word ptr [EDX],DI
00acbbfc : INC ECX
00acbbfd : ADD EBX,0x2
00acbc00 : ADD EDX,0x2
00acbc03 : CMP ECX,0x5
00acbc06 : JL 0x00acbbf1
00acbc08 : MOVZX ECX,word ptr [ESI + 0x6c]
00acbc0c : MOV word ptr [EAX + 0x14],CX
00acbc10 : MOVZX EDX,word ptr [ESI + 0x64]
00acbc14 : MOV word ptr [EAX + 0x16],DX
00acbc18 : MOVZX ECX,word ptr [ESI + 0x68]
00acbc1c : MOV word ptr [EAX + 0x18],CX
00acbc20 : MOV EDX,dword ptr [ESI + 0x70]
00acbc23 : MOV dword ptr [EAX + 0x1a],EDX
00acbc26 : MOVZX ECX,word ptr [ESI + 0x74]
00acbc2a : MOV word ptr [EAX + 0x2d],CX
00acbc2e : MOVZX EDX,word ptr [ESI + 0x78]
00acbc32 : MOV word ptr [EAX + 0x2f],DX
00acbc36 : MOV ECX,dword ptr [ESI + 0xac]
00acbc3c : MOV dword ptr [EAX + 0x1e],ECX
00acbc3f : MOV EDX,dword ptr [ESI + 0xa4]
00acbc45 : MOV dword ptr [EAX + 0x22],EDX
00acbc48 : MOV ECX,dword ptr [ESI + 0xa8]
00acbc4e : MOV dword ptr [EAX + 0x26],ECX
00acbc51 : MOVZX EDX,word ptr [ESI + 0xb0]
00acbc58 : MOV word ptr [EAX + 0x2b],DX
00acbc5c : MOV EDX,dword ptr [0x017247d4]
00acbc62 : MOV ECX,dword ptr [EDX + 0x4]
00acbc65 : TEST ECX,ECX
00acbc67 : JZ 0x00acbc79
00acbc69 : CMP byte ptr [EDX + 0x8],0x0
00acbc6d : JZ 0x00acbc79
00acbc6f : PUSH 0x31
00acbc71 : PUSH ECX
00acbc72 : MOV EDI,EAX
00acbc74 : CALL 0x00a0dd40
00acbc79 : MOV ECX,dword ptr [EBP + -0xc]
00acbc7c : MOV dword ptr FS:[0x0],ECX
00acbc83 : POP ECX
00acbc84 : POP EDI
00acbc85 : POP EBX
00acbc86 : MOV ESP,EBP
00acbc88 : POP EBP
00acbc89 : RET 0x4

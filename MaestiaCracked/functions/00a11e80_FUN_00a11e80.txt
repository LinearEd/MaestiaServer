PROGRAM  : Maestia.exe
FUNCTION : FUN_00a11e80
ENTRY    : 00a11e80
BODY     : [[00a11e80, 00a12143]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a11e80(undefined4 param_1,char param_2)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  UINT UVar4;
  int in_ECX;
  wchar_t *pwVar5;
  int local_250;
  undefined1 local_24c [4];
  undefined4 **local_248 [4];
  int local_238;
  uint local_234;
  undefined1 local_230 [4];
  undefined4 **local_22c [4];
  int local_21c;
  uint local_218;
  WCHAR local_214;
  undefined1 local_212 [510];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b26056;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_214 = L'\0';
  local_14 = uVar3;
  _memset(local_212,0,0x1fe);
  if ((*(int *)(in_ECX + 8) != 0) && (FUN_0040f910(&param_1), local_250 != *(int *)(in_ECX + 4))) {
    UVar4 = MapVirtualKeyW(*(UINT *)(local_250 + 0x14),0);
    GetKeyNameTextW((UVar4 | 0x100) << 0x10,&local_214,0x100);
    uVar1 = *(uint *)(local_250 + 0x14);
    if ((0x6f < uVar1) && (uVar1 < 0x7c)) {
      _swprintf_s(&local_214,0x100,L"F%d",uVar1 - 0x6f,uVar3);
    }
    if (*(int *)(local_250 + 0x14) == 8) {
      _swprintf_s(&local_214,0x100,L"BACKSPACE");
    }
    if (*(int *)(local_250 + 0x14) == 0x91) {
      _swprintf_s(&local_214,0x100,L"SCROLL");
    }
    if (*(int *)(local_250 + 0x14) == 0x13) {
      _swprintf_s(&local_214,0x100,L"PAUSE");
    }
    FUN_00406460(&DAT_00cbe094);
    local_8 = 0;
    FUN_00406460(&DAT_00cbe098);
    local_8 = CONCAT31(local_8._1_3_,1);
    iVar2 = *(int *)(local_250 + 0x18);
    if (((iVar2 == 0x10) || (iVar2 == 0x11)) || (iVar2 == 0x12)) {
      FUN_00405c00(local_230);
    }
    iVar2 = *(int *)(local_250 + 0x1c);
    if (((iVar2 == 0x10) || (iVar2 == 0x11)) || (iVar2 == 0x12)) {
      FUN_00405c00(local_24c);
    }
    if (local_21c == 0) {
      if (param_2 == '\0') {
        pwVar5 = L"%s";
      }
      else {
        pwVar5 = L"(%s)";
      }
      FUN_0040e4a0(pwVar5,&local_214);
    }
    else if (local_238 == 0) {
      if (local_218 < 8) {
        local_22c[0] = local_22c;
      }
      FUN_0040e4a0(L"(%s + %s)",local_22c[0],&local_214);
    }
    else {
      if (local_234 < 8) {
        local_248[0] = local_248;
      }
      if (local_218 < 8) {
        local_22c[0] = local_22c;
      }
      FUN_0040e4a0(L"(%s + %s + %s)",local_22c[0],local_248[0],&local_214);
    }
    local_8 = local_8 & 0xffffff00;
    FUN_00406560();
    local_8 = 0xffffffff;
    FUN_00406560();
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a11e80 : PUSH EBP
00a11e81 : MOV EBP,ESP
00a11e83 : PUSH -0x1
00a11e85 : PUSH 0xb26056
00a11e8a : MOV EAX,FS:[0x0]
00a11e90 : PUSH EAX
00a11e91 : SUB ESP,0x240
00a11e97 : MOV EAX,[0x00d66fa0]
00a11e9c : XOR EAX,EBP
00a11e9e : MOV dword ptr [EBP + -0x10],EAX
00a11ea1 : PUSH EBX
00a11ea2 : PUSH ESI
00a11ea3 : PUSH EAX
00a11ea4 : LEA EAX,[EBP + -0xc]
00a11ea7 : MOV FS:[0x0],EAX
00a11ead : XOR EAX,EAX
00a11eaf : PUSH 0x1fe
00a11eb4 : MOV ESI,ECX
00a11eb6 : PUSH EAX
00a11eb7 : LEA ECX,[EBP + 0xfffffdf2]
00a11ebd : PUSH ECX
00a11ebe : MOV word ptr [EBP + 0xfffffdf0],AX
00a11ec5 : CALL 0x0063b700
00a11eca : ADD ESP,0xc
00a11ecd : CMP dword ptr [ESI + 0x8],0x0
00a11ed1 : JNZ 0x00a11eda
00a11ed3 : XOR EAX,EAX
00a11ed5 : JMP 0x00a12127
00a11eda : LEA EDX,[EBP + 0x8]
00a11edd : PUSH EDX
00a11ede : LEA EAX,[EBP + 0xfffffdb4]
00a11ee4 : MOV ECX,ESI
00a11ee6 : CALL 0x0040f910
00a11eeb : MOV EAX,dword ptr [ESI + 0x4]
00a11eee : MOV ESI,dword ptr [EBP + 0xfffffdb4]
00a11ef4 : CMP ESI,EAX
00a11ef6 : JZ 0x00a11ed3
00a11ef8 : MOV EAX,dword ptr [ESI + 0x14]
00a11efb : PUSH 0x0
00a11efd : PUSH EAX
00a11efe : CALL dword ptr [0x00b85458]
00a11f04 : PUSH 0x100
00a11f09 : OR EAX,0x100
00a11f0e : LEA ECX,[EBP + 0xfffffdf0]
00a11f14 : PUSH ECX
00a11f15 : SHL EAX,0x10
00a11f18 : PUSH EAX
00a11f19 : CALL dword ptr [0x00b8545c]
00a11f1f : MOV EAX,dword ptr [ESI + 0x14]
00a11f22 : CMP EAX,0x6f
00a11f25 : JBE 0x00a11f49
00a11f27 : CMP EAX,0x7c
00a11f2a : JNC 0x00a11f49
00a11f2c : ADD EAX,-0x6f
00a11f2f : PUSH EAX
00a11f30 : PUSH 0xcbe05c
00a11f35 : LEA EDX,[EBP + 0xfffffdf0]
00a11f3b : PUSH 0x100
00a11f40 : PUSH EDX
00a11f41 : CALL 0x00635d51
00a11f46 : ADD ESP,0x10
00a11f49 : MOV EBX,0x8
00a11f4e : CMP dword ptr [ESI + 0x14],EBX
00a11f51 : JNZ 0x00a11f6c
00a11f53 : PUSH 0xcbe064
00a11f58 : LEA EAX,[EBP + 0xfffffdf0]
00a11f5e : PUSH 0x100
00a11f63 : PUSH EAX
00a11f64 : CALL 0x00635d51
00a11f69 : ADD ESP,0xc
00a11f6c : CMP dword ptr [ESI + 0x14],0x91
00a11f73 : JNZ 0x00a11f8e
00a11f75 : PUSH 0xcbe078
00a11f7a : LEA ECX,[EBP + 0xfffffdf0]
00a11f80 : PUSH 0x100
00a11f85 : PUSH ECX
00a11f86 : CALL 0x00635d51
00a11f8b : ADD ESP,0xc
00a11f8e : CMP dword ptr [ESI + 0x14],0x13
00a11f92 : JNZ 0x00a11fad
00a11f94 : PUSH 0xcbe088
00a11f99 : LEA EDX,[EBP + 0xfffffdf0]
00a11f9f : PUSH 0x100
00a11fa4 : PUSH EDX
00a11fa5 : CALL 0x00635d51
00a11faa : ADD ESP,0xc
00a11fad : PUSH 0xcbe094
00a11fb2 : LEA ECX,[EBP + 0xfffffdd4]
00a11fb8 : CALL 0x00406460
00a11fbd : MOV dword ptr [EBP + -0x4],0x0
00a11fc4 : PUSH 0xcbe098
00a11fc9 : LEA ECX,[EBP + 0xfffffdb8]
00a11fcf : CALL 0x00406460
00a11fd4 : MOV byte ptr [EBP + -0x4],0x1
00a11fd8 : MOV EAX,dword ptr [ESI + 0x18]
00a11fdb : SUB EAX,0x10
00a11fde : JZ 0x00a12006
00a11fe0 : SUB EAX,0x1
00a11fe3 : JZ 0x00a11ff8
00a11fe5 : SUB EAX,0x1
00a11fe8 : JNZ 0x00a12017
00a11fea : LEA EAX,[EBP + 0xfffffdd4]
00a11ff0 : PUSH EAX
00a11ff1 : MOV EDX,0xcbe0a8
00a11ff6 : JMP 0x00a12012
00a11ff8 : LEA ECX,[EBP + 0xfffffdd4]
00a11ffe : PUSH ECX
00a11fff : MOV EDX,0xcbe09c
00a12004 : JMP 0x00a12012
00a12006 : LEA EDX,[EBP + 0xfffffdd4]
00a1200c : PUSH EDX
00a1200d : MOV EDX,0xcbe0b0
00a12012 : CALL 0x00405c00
00a12017 : MOV ESI,dword ptr [ESI + 0x1c]
00a1201a : SUB ESI,0x10
00a1201d : JZ 0x00a12045
00a1201f : SUB ESI,0x1
00a12022 : JZ 0x00a12037
00a12024 : SUB ESI,0x1
00a12027 : JNZ 0x00a12056
00a12029 : LEA EAX,[EBP + 0xfffffdb8]
00a1202f : PUSH EAX
00a12030 : MOV EDX,0xcbe0c8
00a12035 : JMP 0x00a12051
00a12037 : LEA ECX,[EBP + 0xfffffdb8]
00a1203d : PUSH ECX
00a1203e : MOV EDX,0xcbe0bc
00a12043 : JMP 0x00a12051
00a12045 : LEA EDX,[EBP + 0xfffffdb8]
00a1204b : PUSH EDX
00a1204c : MOV EDX,0xcbe0d0
00a12051 : CALL 0x00405c00
00a12056 : CMP dword ptr [EBP + 0xfffffde8],0x0
00a1205d : JZ 0x00a120d7
00a1205f : CMP dword ptr [EBP + 0xfffffdcc],0x0
00a12066 : JZ 0x00a120aa
00a12068 : MOV ECX,dword ptr [EBP + 0xfffffdbc]
00a1206e : CMP dword ptr [EBP + 0xfffffdd0],EBX
00a12074 : JNC 0x00a1207c
00a12076 : LEA ECX,[EBP + 0xfffffdbc]
00a1207c : MOV EAX,dword ptr [EBP + 0xfffffdd8]
00a12082 : CMP dword ptr [EBP + 0xfffffdec],EBX
00a12088 : JNC 0x00a12090
00a1208a : LEA EAX,[EBP + 0xfffffdd8]
00a12090 : LEA EDX,[EBP + 0xfffffdf0]
00a12096 : PUSH EDX
00a12097 : PUSH ECX
00a12098 : PUSH EAX
00a12099 : PUSH 0xcbe0dc
00a1209e : MOV EDX,EDI
00a120a0 : CALL 0x0040e4a0
00a120a5 : ADD ESP,0x10
00a120a8 : JMP 0x00a12101
00a120aa : MOV EAX,dword ptr [EBP + 0xfffffdd8]
00a120b0 : CMP dword ptr [EBP + 0xfffffdec],EBX
00a120b6 : JNC 0x00a120be
00a120b8 : LEA EAX,[EBP + 0xfffffdd8]
00a120be : LEA ECX,[EBP + 0xfffffdf0]
00a120c4 : PUSH ECX
00a120c5 : PUSH EAX
00a120c6 : PUSH 0xcbe0fc
00a120cb : MOV EDX,EDI
00a120cd : CALL 0x0040e4a0
00a120d2 : ADD ESP,0xc
00a120d5 : JMP 0x00a12101
00a120d7 : CMP byte ptr [EBP + 0xc],0x0
00a120db : JZ 0x00a120eb
00a120dd : LEA EDX,[EBP + 0xfffffdf0]
00a120e3 : PUSH EDX
00a120e4 : PUSH 0xcbe110
00a120e9 : JMP 0x00a120f7
00a120eb : LEA EAX,[EBP + 0xfffffdf0]
00a120f1 : PUSH EAX
00a120f2 : PUSH 0xcbe11c
00a120f7 : MOV EDX,EDI
00a120f9 : CALL 0x0040e4a0
00a120fe : ADD ESP,0x8
00a12101 : MOV byte ptr [EBP + -0x4],0x0
00a12105 : LEA ECX,[EBP + 0xfffffdb8]
00a1210b : CALL 0x00406560
00a12110 : MOV dword ptr [EBP + -0x4],0xffffffff
00a12117 : LEA ECX,[EBP + 0xfffffdd4]
00a1211d : CALL 0x00406560
00a12122 : MOV EAX,0x1
00a12127 : MOV ECX,dword ptr [EBP + -0xc]
00a1212a : MOV dword ptr FS:[0x0],ECX
00a12131 : POP ECX
00a12132 : POP ESI
00a12133 : POP EBX
00a12134 : MOV ECX,dword ptr [EBP + -0x10]
00a12137 : XOR ECX,EBP
00a12139 : CALL 0x00633e6b
00a1213e : MOV ESP,EBP
00a12140 : POP EBP
00a12141 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_00586790
ENTRY    : 00586790
BODY     : [[00586790, 00586885]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x0058687b) */

undefined4 * FUN_00586790(undefined4 param_1)

{
  char cVar1;
  char *pcVar2;
  undefined4 uVar3;
  int iVar4;
  char *pcVar5;
  undefined4 *in_ECX;
  undefined **ppuVar6;
  int local_1c;
  int local_18;
  undefined4 *local_14;
  undefined1 local_10 [4];
  undefined4 local_c;
  
  uVar3 = param_1;
  local_14 = in_ECX;
  FUN_00568960(param_1,FUN_00586000);
  iVar4 = 0;
  *in_ECX = &PTR_LAB_00b8dfb8;
  in_ECX[4] = &PTR_LAB_00b90510;
  local_18 = 0;
  ppuVar6 = &PTR_s_CASEINSENSITIVE_00b8de68;
  do {
    local_c = *(undefined4 *)((int)&DAT_00b8de6c + iVar4);
    pcVar2 = *ppuVar6;
    param_1 = CONCAT31(param_1._1_3_,3);
    local_10[0] = 4;
    pcVar5 = pcVar2;
    do {
      cVar1 = *pcVar5;
      pcVar5 = pcVar5 + 1;
    } while (cVar1 != '\0');
    local_1c = FUN_00525380(pcVar2,(int)pcVar5 - (int)(pcVar2 + 1),0);
    *(int *)(local_1c + 8) = *(int *)(local_1c + 8) + 1;
    (**(code **)(in_ECX[4] + 0x28))(uVar3,&local_1c,local_10,&param_1);
    *(int *)(local_1c + 8) = *(int *)(local_1c + 8) + -1;
    if (*(int *)(local_1c + 8) == 0) {
      FUN_00525340();
    }
    FUN_00526bc0();
    local_18 = local_18 + 1;
    iVar4 = local_18 * 8;
    ppuVar6 = &PTR_s_CASEINSENSITIVE_00b8de68 + local_18 * 2;
  } while ((&PTR_s_CASEINSENSITIVE_00b8de68)[local_18 * 2] != (undefined *)0x0);
  return local_14;
}



============================================================
DISASSEMBLY
============================================================
00586790 : SUB ESP,0x1c
00586793 : PUSH EBX
00586794 : MOV EBX,dword ptr [ESP + 0x24]
00586798 : PUSH EBP
00586799 : PUSH ESI
0058679a : PUSH 0x586000
0058679f : MOV ESI,ECX
005867a1 : PUSH EBX
005867a2 : MOV dword ptr [ESP + 0x1c],ESI
005867a6 : CALL 0x00568960
005867ab : LEA EBP,[ESI + 0x10]
005867ae : XOR EAX,EAX
005867b0 : MOV dword ptr [ESI],0xb8dfb8
005867b6 : MOV dword ptr [EBP],0xb90510
005867bd : MOV dword ptr [ESP + 0x10],EAX
005867c1 : CMP dword ptr [0x00b8de68],EAX
005867c7 : JZ 0x0058687b
005867cd : MOV ECX,0xb8de68
005867d2 : PUSH EDI
005867d3 : MOV EAX,dword ptr [EAX + 0xb8de6c]
005867d9 : MOV ESI,dword ptr [ECX]
005867db : MOV ECX,dword ptr [EBX]
005867dd : MOV dword ptr [ESP + 0x20],EAX
005867e1 : MOV EAX,ESI
005867e3 : MOV byte ptr [ESP + 0x30],0x3
005867e8 : MOV byte ptr [ESP + 0x1c],0x4
005867ed : ADD ECX,0x8
005867f0 : LEA EDI,[EAX + 0x1]
005867f3 : MOV DL,byte ptr [EAX]
005867f5 : INC EAX
005867f6 : TEST DL,DL
005867f8 : JNZ 0x005867f3
005867fa : PUSH 0x0
005867fc : SUB EAX,EDI
005867fe : PUSH EAX
005867ff : PUSH ESI
00586800 : ADD ECX,0x24c
00586806 : CALL 0x00525380
0058680b : MOV dword ptr [ESP + 0x10],EAX
0058680f : INC dword ptr [EAX + 0x8]
00586812 : MOV EDX,dword ptr [EBP]
00586815 : MOV EDX,dword ptr [EDX + 0x28]
00586818 : LEA EAX,[ESP + 0x30]
0058681c : PUSH EAX
0058681d : LEA ECX,[ESP + 0x20]
00586821 : PUSH ECX
00586822 : LEA EAX,[ESP + 0x18]
00586826 : PUSH EAX
00586827 : PUSH EBX
00586828 : MOV ECX,EBP
0058682a : CALL EDX
0058682c : MOV EAX,dword ptr [ESP + 0x10]
00586830 : DEC dword ptr [EAX + 0x8]
00586833 : MOV ECX,EAX
00586835 : ADD EAX,0x8
00586838 : CMP dword ptr [EAX],0x0
0058683b : JNZ 0x00586842
0058683d : CALL 0x00525340
00586842 : LEA ECX,[ESP + 0x1c]
00586846 : CALL 0x00526bc0
0058684b : MOV EAX,dword ptr [ESP + 0x14]
0058684f : INC EAX
00586850 : MOV dword ptr [ESP + 0x14],EAX
00586854 : ADD EAX,EAX
00586856 : ADD EAX,EAX
00586858 : ADD EAX,EAX
0058685a : CMP dword ptr [EAX + 0xb8de68],0x0
00586861 : LEA ECX,[EAX + 0xb8de68]
00586867 : JNZ 0x005867d3
0058686d : MOV EAX,dword ptr [ESP + 0x18]
00586871 : POP EDI
00586872 : POP ESI
00586873 : POP EBP
00586874 : POP EBX
00586875 : ADD ESP,0x1c
00586878 : RET 0x4
0058687b : MOV EAX,ESI
0058687d : POP ESI
0058687e : POP EBP
0058687f : POP EBX
00586880 : ADD ESP,0x1c
00586883 : RET 0x4

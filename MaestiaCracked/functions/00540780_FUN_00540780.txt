PROGRAM  : Maestia.exe
FUNCTION : FUN_00540780
ENTRY    : 00540780
BODY     : [[00540780, 005407b6] [005407c0, 0054089b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00540780(int param_1,int param_2,int param_3)

{
  int *piVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  short *psVar5;
  int in_ECX;
  uint uVar6;
  int iVar7;
  int iVar8;
  uint uVar9;
  int local_10;
  int local_c;
  int *local_8;
  int local_4;
  
  local_c = in_ECX;
  FUN_0053c2d0(&local_8,param_2,&local_10);
  param_2 = param_3 - param_2;
  iVar7 = local_10;
  iVar8 = local_4;
  while (((iVar3 = local_c, local_8 != (int *)0x0 && (-1 < iVar8)) && (iVar8 < local_8[1]))) {
    piVar1 = *(int **)(*local_8 + iVar8 * 4);
    uVar2 = piVar1[1];
    uVar6 = uVar2;
    if ((uVar2 != 0) && (uVar2 != 0)) {
      if ((*piVar1 == 0) || (uVar2 <= uVar2 - 1)) {
        psVar5 = (short *)0x0;
      }
      else {
        psVar5 = (short *)(*piVar1 + (uVar2 - 1) * 2);
      }
      if (*psVar5 == 0) {
        uVar6 = uVar2 - 1;
      }
    }
    uVar9 = param_2 + iVar7;
    uVar4 = uVar6;
    if (((uVar6 < uVar9) || (uVar4 = uVar9, uVar9 == uVar6)) && (uVar9 = uVar4, uVar2 != 0)) {
      if ((*piVar1 == 0) || (uVar2 <= uVar2 - 1)) {
        psVar5 = (short *)0x0;
      }
      else {
        psVar5 = (short *)(*piVar1 + (uVar2 - 1) * 2);
      }
      if ((*psVar5 == 0) && (uVar9 = uVar9 + 1, param_2 != -1)) {
        param_2 = param_2 + 1;
      }
    }
    FUN_00540450(*(undefined4 *)(local_c + 8),param_1,iVar7,uVar9);
    param_2 = param_2 + (iVar7 - uVar9);
    iVar7 = 0;
    in_ECX = iVar3;
    if (iVar8 < local_8[1]) {
      iVar8 = iVar8 + 1;
    }
  }
  if (((*(ushort *)(param_1 + 0x2a) & 0x100) != 0) && (iVar7 = FUN_0051b1a0(), iVar7 != 0)) {
    *(byte *)(in_ECX + 0x20) = *(byte *)(in_ECX + 0x20) | 1;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00540780 : SUB ESP,0x10
00540783 : PUSH EBX
00540784 : PUSH EBP
00540785 : PUSH ESI
00540786 : MOV ESI,dword ptr [ESP + 0x24]
0054078a : PUSH EDI
0054078b : LEA EAX,[ESP + 0x10]
0054078f : MOV EDI,ECX
00540791 : PUSH EAX
00540792 : PUSH ESI
00540793 : LEA ECX,[ESP + 0x20]
00540797 : PUSH ECX
00540798 : MOV ECX,EDI
0054079a : MOV dword ptr [ESP + 0x20],EDI
0054079e : CALL 0x0053c2d0
005407a3 : MOV EAX,dword ptr [ESP + 0x2c]
005407a7 : MOV EBX,dword ptr [ESP + 0x10]
005407ab : MOV EBP,dword ptr [ESP + 0x1c]
005407af : SUB EAX,ESI
005407b1 : MOV dword ptr [ESP + 0x28],EAX
005407b5 : JMP 0x005407c0
005407c0 : MOV EAX,dword ptr [ESP + 0x18]
005407c4 : TEST EAX,EAX
005407c6 : JZ 0x00540873
005407cc : TEST EBP,EBP
005407ce : JL 0x00540873
005407d4 : CMP EBP,dword ptr [EAX + 0x4]
005407d7 : JGE 0x00540873
005407dd : MOV EDX,dword ptr [EAX]
005407df : MOV ECX,dword ptr [EDX + EBP*0x4]
005407e2 : MOV EAX,dword ptr [ECX + 0x4]
005407e5 : MOV EDX,EAX
005407e7 : TEST EDX,EDX
005407e9 : JBE 0x0054080a
005407eb : TEST EAX,EAX
005407ed : JBE 0x0054080a
005407ef : MOV ESI,dword ptr [ECX]
005407f1 : LEA EDI,[EAX + -0x1]
005407f4 : TEST ESI,ESI
005407f6 : JZ 0x00540801
005407f8 : CMP EDI,EAX
005407fa : JNC 0x00540801
005407fc : LEA ESI,[ESI + EDI*0x2]
005407ff : JMP 0x00540803
00540801 : XOR ESI,ESI
00540803 : CMP word ptr [ESI],0x0
00540807 : JNZ 0x0054080a
00540809 : DEC EDX
0054080a : MOV ESI,dword ptr [ESP + 0x28]
0054080e : ADD ESI,EBX
00540810 : CMP ESI,EDX
00540812 : JBE 0x00540818
00540814 : MOV ESI,EDX
00540816 : JMP 0x0054081a
00540818 : JNZ 0x00540844
0054081a : TEST EAX,EAX
0054081c : JBE 0x00540844
0054081e : MOV EDX,dword ptr [ECX]
00540820 : LEA EDI,[EAX + -0x1]
00540823 : TEST EDX,EDX
00540825 : JZ 0x00540830
00540827 : CMP EDI,EAX
00540829 : JNC 0x00540830
0054082b : LEA EAX,[EDX + EDI*0x2]
0054082e : JMP 0x00540832
00540830 : XOR EAX,EAX
00540832 : CMP word ptr [EAX],0x0
00540836 : JNZ 0x00540844
00540838 : INC ESI
00540839 : CMP dword ptr [ESP + 0x28],-0x1
0054083e : JZ 0x00540844
00540840 : INC dword ptr [ESP + 0x28]
00540844 : MOV EAX,dword ptr [ESP + 0x24]
00540848 : MOV EDI,dword ptr [ESP + 0x14]
0054084c : MOV EDX,dword ptr [EDI + 0x8]
0054084f : PUSH ESI
00540850 : PUSH EBX
00540851 : PUSH EAX
00540852 : PUSH EDX
00540853 : CALL 0x00540450
00540858 : MOV EAX,dword ptr [ESP + 0x18]
0054085c : SUB EBX,ESI
0054085e : ADD dword ptr [ESP + 0x28],EBX
00540862 : XOR EBX,EBX
00540864 : CMP EBP,dword ptr [EAX + 0x4]
00540867 : JGE 0x005407c0
0054086d : INC EBP
0054086e : JMP 0x005407c0
00540873 : MOV EAX,dword ptr [ESP + 0x24]
00540877 : MOV ECX,0x100
0054087c : TEST word ptr [EAX + 0x2a],CX
00540880 : JZ 0x00540892
00540882 : LEA ECX,[EAX + 0x10]
00540885 : CALL 0x0051b1a0
0054088a : TEST EAX,EAX
0054088c : JZ 0x00540892
0054088e : OR byte ptr [EDI + 0x20],0x1
00540892 : POP EDI
00540893 : POP ESI
00540894 : POP EBP
00540895 : POP EBX
00540896 : ADD ESP,0x10
00540899 : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_0060a600
ENTRY    : 0060a600
BODY     : [[0060a600, 0060a77a]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_0060a600(uint param_1)

{
  uint *puVar1;
  byte bVar2;
  undefined4 *in_ECX;
  char cVar3;
  uint uVar4;
  uint uVar5;
  
  uVar4 = param_1;
  cVar3 = (char)param_1;
  if (param_1 < 0x40) {
    puVar1 = (uint *)*in_ECX;
    uVar4 = *puVar1 >> 0xc;
    if (puVar1[1] <= uVar4) {
      FUN_00609600(uVar4);
    }
    *(char *)((*puVar1 & 0xfff) + *(int *)(puVar1[3] + uVar4 * 4)) = cVar3 * '\x04';
    *puVar1 = *puVar1 + 1;
    return 1;
  }
  if (param_1 < 0x4000) {
    puVar1 = (uint *)*in_ECX;
    uVar5 = *puVar1 >> 0xc;
    param_1 = CONCAT31(param_1._1_3_,cVar3 * '\x04') | 1;
    bVar2 = cVar3 * '\x04' | 1;
    if (puVar1[1] <= uVar5) {
      FUN_00609600(uVar5);
      bVar2 = (byte)param_1;
    }
    *(byte *)((*puVar1 & 0xfff) + *(int *)(puVar1[3] + uVar5 * 4)) = bVar2;
    *puVar1 = *puVar1 + 1;
    puVar1 = (uint *)*in_ECX;
    uVar5 = *puVar1 >> 0xc;
    if (puVar1[1] <= uVar5) {
      FUN_00609600(uVar5);
    }
    *(char *)((*puVar1 & 0xfff) + *(int *)(puVar1[3] + uVar5 * 4)) = (char)(uVar4 >> 6);
    *puVar1 = *puVar1 + 1;
    return 2;
  }
  if (param_1 < 0x400000) {
    param_1 = CONCAT31(param_1._1_3_,cVar3 * '\x04') | 2;
    FUN_0060a360(&param_1);
    param_1._0_1_ = (char)(uVar4 >> 6);
    FUN_0060a360(&param_1);
    param_1 = CONCAT31(param_1._1_3_,(char)(uVar4 >> 0xe));
    FUN_0060a360(&param_1);
    return 3;
  }
  param_1 = CONCAT31(param_1._1_3_,cVar3 * '\x04') | 3;
  FUN_0060a360(&param_1);
  param_1._0_1_ = (char)(uVar4 >> 6);
  FUN_0060a360(&param_1);
  param_1._0_1_ = (byte)(uVar4 >> 0xe);
  FUN_0060a360(&param_1);
  param_1 = CONCAT31(param_1._1_3_,(char)(uVar4 >> 0x16));
  FUN_0060a360(&param_1);
  return 4;
}



============================================================
DISASSEMBLY
============================================================
0060a600 : PUSH EBX
0060a601 : MOV EBX,dword ptr [ESP + 0x8]
0060a605 : PUSH EBP
0060a606 : PUSH ESI
0060a607 : MOV EBP,ECX
0060a609 : CMP EBX,0x3f
0060a60c : JA 0x0060a648
0060a60e : MOV EBP,dword ptr [EBP]
0060a611 : MOV ESI,dword ptr [EBP]
0060a614 : ADD BL,BL
0060a616 : SHR ESI,0xc
0060a619 : ADD BL,BL
0060a61b : CMP ESI,dword ptr [EBP + 0x4]
0060a61e : JC 0x0060a628
0060a620 : PUSH ESI
0060a621 : MOV ECX,EBP
0060a623 : CALL 0x00609600
0060a628 : MOV EAX,dword ptr [EBP + 0xc]
0060a62b : MOV ECX,dword ptr [EBP]
0060a62e : MOV EDX,dword ptr [EAX + ESI*0x4]
0060a631 : AND ECX,0xfff
0060a637 : MOV byte ptr [ECX + EDX*0x1],BL
0060a63a : INC dword ptr [EBP]
0060a63d : POP ESI
0060a63e : POP EBP
0060a63f : MOV EAX,0x1
0060a644 : POP EBX
0060a645 : RET 0x4
0060a648 : CMP EBX,0x3fff
0060a64e : JA 0x0060a6bf
0060a650 : MOV ESI,dword ptr [EBP]
0060a653 : MOV AL,BL
0060a655 : ADD AL,AL
0060a657 : PUSH EDI
0060a658 : MOV EDI,dword ptr [ESI]
0060a65a : ADD AL,AL
0060a65c : OR AL,0x1
0060a65e : SHR EDI,0xc
0060a661 : MOV byte ptr [ESP + 0x14],AL
0060a665 : CMP EDI,dword ptr [ESI + 0x4]
0060a668 : JC 0x0060a676
0060a66a : PUSH EDI
0060a66b : MOV ECX,ESI
0060a66d : CALL 0x00609600
0060a672 : MOV AL,byte ptr [ESP + 0x14]
0060a676 : MOV EDX,dword ptr [ESI]
0060a678 : MOV ECX,dword ptr [ESI + 0xc]
0060a67b : MOV ECX,dword ptr [ECX + EDI*0x4]
0060a67e : AND EDX,0xfff
0060a684 : MOV byte ptr [EDX + ECX*0x1],AL
0060a687 : INC dword ptr [ESI]
0060a689 : MOV ESI,dword ptr [EBP]
0060a68c : MOV EDI,dword ptr [ESI]
0060a68e : SHR EDI,0xc
0060a691 : SHR EBX,0x6
0060a694 : CMP EDI,dword ptr [ESI + 0x4]
0060a697 : JC 0x0060a6a1
0060a699 : PUSH EDI
0060a69a : MOV ECX,ESI
0060a69c : CALL 0x00609600
0060a6a1 : MOV EAX,dword ptr [ESI]
0060a6a3 : MOV EDX,dword ptr [ESI + 0xc]
0060a6a6 : MOV ECX,dword ptr [EDX + EDI*0x4]
0060a6a9 : AND EAX,0xfff
0060a6ae : MOV byte ptr [EAX + ECX*0x1],BL
0060a6b1 : INC dword ptr [ESI]
0060a6b3 : POP EDI
0060a6b4 : POP ESI
0060a6b5 : POP EBP
0060a6b6 : MOV EAX,0x2
0060a6bb : POP EBX
0060a6bc : RET 0x4
0060a6bf : CMP EBX,0x3fffff
0060a6c5 : JA 0x0060a716
0060a6c7 : MOV ECX,dword ptr [EBP]
0060a6ca : MOV DL,BL
0060a6cc : ADD DL,DL
0060a6ce : ADD DL,DL
0060a6d0 : LEA EAX,[ESP + 0x10]
0060a6d4 : OR DL,0x2
0060a6d7 : PUSH EAX
0060a6d8 : MOV byte ptr [ESP + 0x14],DL
0060a6dc : CALL 0x0060a360
0060a6e1 : MOV ECX,EBX
0060a6e3 : SHR ECX,0x6
0060a6e6 : LEA EDX,[ESP + 0x10]
0060a6ea : MOV byte ptr [ESP + 0x10],CL
0060a6ee : MOV ECX,dword ptr [EBP]
0060a6f1 : PUSH EDX
0060a6f2 : CALL 0x0060a360
0060a6f7 : MOV ECX,dword ptr [EBP]
0060a6fa : LEA EAX,[ESP + 0x10]
0060a6fe : SHR EBX,0xe
0060a701 : PUSH EAX
0060a702 : MOV byte ptr [ESP + 0x14],BL
0060a706 : CALL 0x0060a360
0060a70b : POP ESI
0060a70c : POP EBP
0060a70d : MOV EAX,0x3
0060a712 : POP EBX
0060a713 : RET 0x4
0060a716 : MOV CL,BL
0060a718 : ADD CL,CL
0060a71a : ADD CL,CL
0060a71c : OR CL,0x3
0060a71f : LEA EDX,[ESP + 0x10]
0060a723 : MOV byte ptr [ESP + 0x10],CL
0060a727 : MOV ECX,dword ptr [EBP]
0060a72a : PUSH EDX
0060a72b : CALL 0x0060a360
0060a730 : LEA ECX,[ESP + 0x10]
0060a734 : MOV EAX,EBX
0060a736 : SHR EAX,0x6
0060a739 : PUSH ECX
0060a73a : MOV ECX,dword ptr [EBP]
0060a73d : MOV byte ptr [ESP + 0x14],AL
0060a741 : CALL 0x0060a360
0060a746 : MOV ECX,dword ptr [EBP]
0060a749 : MOV EDX,EBX
0060a74b : LEA EAX,[ESP + 0x10]
0060a74f : SHR EDX,0xe
0060a752 : PUSH EAX
0060a753 : MOV byte ptr [ESP + 0x14],DL
0060a757 : CALL 0x0060a360
0060a75c : LEA ECX,[ESP + 0x10]
0060a760 : PUSH ECX
0060a761 : MOV ECX,dword ptr [EBP]
0060a764 : SHR EBX,0x16
0060a767 : MOV byte ptr [ESP + 0x14],BL
0060a76b : CALL 0x0060a360
0060a770 : POP ESI
0060a771 : POP EBP
0060a772 : MOV EAX,0x4
0060a777 : POP EBX
0060a778 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_00713c50
ENTRY    : 00713c50
BODY     : [[00713c50, 00713f0e]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00713c50(int param_1)

{
  uint uVar1;
  int iVar2;
  undefined4 uVar3;
  int iVar4;
  undefined1 local_9c [4];
  undefined2 local_98;
  undefined4 local_88;
  uint local_84;
  undefined1 local_80 [4];
  undefined2 local_7c;
  undefined4 local_6c;
  uint local_68;
  undefined1 local_64 [4];
  undefined2 local_60;
  undefined4 local_50;
  uint local_4c;
  undefined **local_48;
  undefined1 local_44;
  undefined4 local_40;
  undefined4 local_3c;
  FILE *local_38;
  char local_31;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3b7e6;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar4 = *(int *)(param_1 + 0x5c);
  local_14 = uVar1;
  iVar2 = FUN_00a5d800(*(undefined4 *)(param_1 + 4));
  if (iVar2 != 0) {
    *(int *)(param_1 + 0x58) = (*(int *)(iVar2 + 0x1c) - *(int *)(iVar2 + 0x28)) + iVar4;
    goto LAB_00713ef1;
  }
  FUN_00a5d9f0(*(undefined4 *)(param_1 + 4),local_30);
  local_8._0_1_ = 0;
  local_8._1_3_ = 0;
  if (DAT_00d6911f == '\0') {
LAB_00713d3a:
    local_8._0_1_ = 0;
    uVar3 = FUN_0070a3a0(uVar1);
    *(undefined4 *)(param_1 + 0x58) = uVar3;
    local_44 = 0;
    local_40 = 0;
    local_3c = 0;
    local_48 = &PTR_FUN_00cda538;
    local_38 = (FILE *)0x0;
    local_8._0_1_ = 2;
    FUN_00406460(&PTR_LAB_00c00dd8);
    local_8._0_1_ = 3;
    iVar4 = FUN_00a5d970(*(undefined4 *)(param_1 + 4),local_9c);
    local_8._0_1_ = 4;
    if (*(uint *)(iVar4 + 0x18) < 8) {
      iVar4 = iVar4 + 4;
    }
    else {
      iVar4 = *(int *)(iVar4 + 4);
    }
    FUN_00406460(iVar4);
    local_8._0_1_ = 5;
    local_31 = FUN_0070a9a0(local_64,local_80);
    local_8 = CONCAT31(local_8._1_3_,4);
    if (7 < local_4c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_4c = 7;
    local_50 = 0;
    local_60 = 0;
    local_8 = CONCAT31(local_8._1_3_,3);
    if (7 < local_84) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_84 = 7;
    local_88 = 0;
    local_98 = 0;
    local_8._0_1_ = 2;
    if (7 < local_68) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_68 = 7;
    local_6c = 0;
    local_7c = 0;
    if (local_31 == '\0') {
      local_8 = (uint)local_8._1_3_ << 8;
      local_48 = &PTR_FUN_00cda538;
      if (local_38 != (FILE *)0x0) {
        _fflush(local_38);
        _fclose(local_38);
        local_38 = (FILE *)0x0;
      }
      local_8 = 0xffffffff;
      if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_18 = 7;
      local_1c = 0;
      local_2c = 0;
      goto LAB_00713ef1;
    }
    if ((local_38 == (FILE *)0x0) ||
       (iVar4 = __fseek_nolock(local_38,*(long *)(param_1 + 0x5c),0), iVar4 != 0)) {
      FUN_0070a8b0();
      local_8 = (uint)local_8._1_3_ << 8;
      FUN_0070a930();
      local_8 = 0xffffffff;
      FUN_00406560();
      goto LAB_00713ef1;
    }
    if (local_38 != (FILE *)0x0) {
      __fread_nolock(*(void **)(param_1 + 0x58),1,*(size_t *)(param_1 + 0x60),local_38);
    }
    FUN_0070a8b0();
    *(undefined1 *)(param_1 + 0xd4) = 1;
    local_8 = (uint)local_8._1_3_ << 8;
    FUN_0070a930();
  }
  else {
    FUN_00406460(&PTR_LAB_00c00dd0);
    local_8._0_1_ = 1;
    local_31 = FUN_0070d850(local_30,local_64,*(undefined4 *)(param_1 + 0x5c),
                            *(undefined4 *)(param_1 + 0x60));
    local_8._0_1_ = 0;
    if (7 < local_4c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_4c = 7;
    local_50 = 0;
    local_60 = 0;
    if (local_31 == '\0') goto LAB_00713d3a;
    *(undefined4 *)(param_1 + 0x58) = *(undefined4 *)(param_1 + 0x9c);
  }
  local_8 = 0xffffffff;
  FUN_00406560();
LAB_00713ef1:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00713c50 : PUSH EBP
00713c51 : MOV EBP,ESP
00713c53 : PUSH -0x1
00713c55 : PUSH 0xb3b7e6
00713c5a : MOV EAX,FS:[0x0]
00713c60 : PUSH EAX
00713c61 : SUB ESP,0x90
00713c67 : MOV EAX,[0x00d66fa0]
00713c6c : XOR EAX,EBP
00713c6e : MOV dword ptr [EBP + -0x10],EAX
00713c71 : PUSH EBX
00713c72 : PUSH ESI
00713c73 : PUSH EDI
00713c74 : PUSH EAX
00713c75 : LEA EAX,[EBP + -0xc]
00713c78 : MOV FS:[0x0],EAX
00713c7e : MOV EBX,dword ptr [EBP + 0x8]
00713c81 : MOV EAX,dword ptr [EBX + 0x4]
00713c84 : MOV ESI,dword ptr [EBX + 0x5c]
00713c87 : MOV EDI,dword ptr [EBX + 0x60]
00713c8a : PUSH EAX
00713c8b : CALL 0x00a5d800
00713c90 : XOR EDI,EDI
00713c92 : CMP EAX,EDI
00713c94 : JZ 0x00713ca8
00713c96 : MOV ECX,dword ptr [EAX + 0x1c]
00713c99 : SUB ECX,dword ptr [EAX + 0x28]
00713c9c : MOV AL,0x1
00713c9e : ADD ECX,ESI
00713ca0 : MOV dword ptr [EBX + 0x58],ECX
00713ca3 : JMP 0x00713ef1
00713ca8 : MOV EAX,dword ptr [EBX + 0x4]
00713cab : LEA EDX,[EBP + -0x2c]
00713cae : PUSH EDX
00713caf : PUSH EAX
00713cb0 : CALL 0x00a5d9f0
00713cb5 : MOV dword ptr [EBP + -0x4],EDI
00713cb8 : CMP byte ptr [0x00d6911f],0x0
00713cbf : MOV ESI,0x8
00713cc4 : JZ 0x00713d3a
00713cc6 : PUSH 0xc00dd0
00713ccb : LEA ECX,[EBP + -0x60]
00713cce : CALL 0x00406460
00713cd3 : MOV byte ptr [EBP + -0x4],0x1
00713cd7 : MOV EAX,dword ptr [EBX + 0x60]
00713cda : MOV ECX,dword ptr [EBX + 0x5c]
00713cdd : PUSH EAX
00713cde : PUSH ECX
00713cdf : LEA EDX,[EBP + -0x60]
00713ce2 : PUSH EDX
00713ce3 : LEA EAX,[EBP + -0x2c]
00713ce6 : PUSH EAX
00713ce7 : LEA EAX,[EBX + 0x80]
00713ced : CALL 0x0070d850
00713cf2 : MOV byte ptr [EBP + -0x2d],AL
00713cf5 : MOV byte ptr [EBP + -0x4],0x0
00713cf9 : CMP dword ptr [EBP + -0x48],ESI
00713cfc : JC 0x00713d06
00713cfe : MOV ECX,dword ptr [EBP + -0x5c]
00713d01 : CALL 0x006f04e0
00713d06 : XOR ECX,ECX
00713d08 : MOV dword ptr [EBP + -0x48],0x7
00713d0f : MOV dword ptr [EBP + -0x4c],EDI
00713d12 : MOV word ptr [EBP + -0x5c],CX
00713d16 : CMP byte ptr [EBP + -0x2d],CL
00713d19 : JZ 0x00713d3a
00713d1b : MOV EAX,dword ptr [EBX + 0x9c]
00713d21 : MOV dword ptr [EBX + 0x58],EAX
00713d24 : MOV dword ptr [EBP + -0x4],0xffffffff
00713d2b : LEA ECX,[EBP + -0x2c]
00713d2e : CALL 0x00406560
00713d33 : MOV AL,0x1
00713d35 : JMP 0x00713ef1
00713d3a : MOV ECX,dword ptr [EBX + 0x60]
00713d3d : CALL 0x0070a3a0
00713d42 : MOV dword ptr [EBP + -0x44],0xcd4c80
00713d49 : MOV dword ptr [EBX + 0x58],EAX
00713d4c : MOV byte ptr [EBP + -0x40],0x0
00713d50 : MOV dword ptr [EBP + -0x3c],EDI
00713d53 : MOV dword ptr [EBP + -0x38],EDI
00713d56 : MOV dword ptr [EBP + -0x44],0xcda538
00713d5d : MOV dword ptr [EBP + -0x34],EDI
00713d60 : MOV byte ptr [EBP + -0x4],0x2
00713d64 : PUSH 0xc00dd8
00713d69 : LEA ECX,[EBP + -0x7c]
00713d6c : CALL 0x00406460
00713d71 : MOV byte ptr [EBP + -0x4],0x3
00713d75 : MOV EAX,dword ptr [EBX + 0x4]
00713d78 : LEA EDX,[EBP + 0xffffff68]
00713d7e : PUSH EDX
00713d7f : PUSH EAX
00713d80 : CALL 0x00a5d970
00713d85 : MOV byte ptr [EBP + -0x4],0x4
00713d89 : CMP dword ptr [EAX + 0x18],ESI
00713d8c : JC 0x00713d93
00713d8e : MOV EAX,dword ptr [EAX + 0x4]
00713d91 : JMP 0x00713d96
00713d93 : ADD EAX,0x4
00713d96 : PUSH EAX
00713d97 : LEA ECX,[EBP + -0x60]
00713d9a : CALL 0x00406460
00713d9f : MOV byte ptr [EBP + -0x4],0x5
00713da3 : LEA ECX,[EBP + -0x7c]
00713da6 : PUSH ECX
00713da7 : LEA EDX,[EBP + -0x60]
00713daa : PUSH EDX
00713dab : LEA ECX,[EBP + -0x44]
00713dae : CALL 0x0070a9a0
00713db3 : MOV byte ptr [EBP + -0x2d],AL
00713db6 : MOV byte ptr [EBP + -0x4],0x4
00713dba : CMP dword ptr [EBP + -0x48],ESI
00713dbd : JC 0x00713dc7
00713dbf : MOV ECX,dword ptr [EBP + -0x5c]
00713dc2 : CALL 0x006f04e0
00713dc7 : XOR EAX,EAX
00713dc9 : MOV dword ptr [EBP + -0x48],0x7
00713dd0 : MOV dword ptr [EBP + -0x4c],EDI
00713dd3 : MOV word ptr [EBP + -0x5c],AX
00713dd7 : MOV byte ptr [EBP + -0x4],0x3
00713ddb : CMP dword ptr [EBP + -0x80],ESI
00713dde : JC 0x00713deb
00713de0 : MOV ECX,dword ptr [EBP + 0xffffff6c]
00713de6 : CALL 0x006f04e0
00713deb : XOR ECX,ECX
00713ded : MOV dword ptr [EBP + -0x80],0x7
00713df4 : MOV dword ptr [EBP + 0xffffff7c],EDI
00713dfa : MOV word ptr [EBP + 0xffffff6c],CX
00713e01 : MOV byte ptr [EBP + -0x4],0x2
00713e05 : CMP dword ptr [EBP + -0x64],ESI
00713e08 : JC 0x00713e12
00713e0a : MOV ECX,dword ptr [EBP + -0x78]
00713e0d : CALL 0x006f04e0
00713e12 : XOR EDX,EDX
00713e14 : MOV dword ptr [EBP + -0x64],0x7
00713e1b : MOV dword ptr [EBP + -0x68],EDI
00713e1e : MOV word ptr [EBP + -0x78],DX
00713e22 : CMP byte ptr [EBP + -0x2d],DL
00713e25 : JZ 0x00713ea2
00713e27 : MOV ECX,dword ptr [EBP + -0x34]
00713e2a : MOV EAX,dword ptr [EBX + 0x5c]
00713e2d : CMP ECX,EDI
00713e2f : JZ 0x00713e40
00713e31 : PUSH EDI
00713e32 : PUSH EAX
00713e33 : PUSH ECX
00713e34 : CALL 0x00637771
00713e39 : ADD ESP,0xc
00713e3c : CMP EAX,EDI
00713e3e : JZ 0x00713e68
00713e40 : LEA ECX,[EBP + -0x44]
00713e43 : CALL 0x0070a8b0
00713e48 : MOV byte ptr [EBP + -0x4],0x0
00713e4c : LEA ECX,[EBP + -0x44]
00713e4f : CALL 0x0070a930
00713e54 : MOV dword ptr [EBP + -0x4],0xffffffff
00713e5b : LEA ECX,[EBP + -0x2c]
00713e5e : CALL 0x00406560
00713e63 : JMP 0x00713eef
00713e68 : MOV EDX,dword ptr [EBP + -0x34]
00713e6b : MOV EAX,dword ptr [EBX + 0x60]
00713e6e : MOV ECX,dword ptr [EBX + 0x58]
00713e71 : CMP EDX,EDI
00713e73 : JZ 0x00713e82
00713e75 : PUSH EDX
00713e76 : PUSH EAX
00713e77 : PUSH 0x1
00713e79 : PUSH ECX
00713e7a : CALL 0x00638ac8
00713e7f : ADD ESP,0x10
00713e82 : LEA ECX,[EBP + -0x44]
00713e85 : CALL 0x0070a8b0
00713e8a : MOV byte ptr [EBX + 0xd4],0x1
00713e91 : MOV byte ptr [EBP + -0x4],0x0
00713e95 : LEA ECX,[EBP + -0x44]
00713e98 : CALL 0x0070a930
00713e9d : JMP 0x00713d24
00713ea2 : MOV byte ptr [EBP + -0x4],DL
00713ea5 : MOV EAX,dword ptr [EBP + -0x34]
00713ea8 : MOV dword ptr [EBP + -0x44],0xcda538
00713eaf : CMP EAX,EDI
00713eb1 : JZ 0x00713ecb
00713eb3 : PUSH EAX
00713eb4 : CALL 0x006395f7
00713eb9 : MOV EAX,dword ptr [EBP + -0x34]
00713ebc : ADD ESP,0x4
00713ebf : PUSH EAX
00713ec0 : CALL 0x006366db
00713ec5 : ADD ESP,0x4
00713ec8 : MOV dword ptr [EBP + -0x34],EDI
00713ecb : MOV dword ptr [EBP + -0x4],0xffffffff
00713ed2 : CMP dword ptr [EBP + -0x14],ESI
00713ed5 : JC 0x00713edf
00713ed7 : MOV ECX,dword ptr [EBP + -0x28]
00713eda : CALL 0x006f04e0
00713edf : XOR ECX,ECX
00713ee1 : MOV dword ptr [EBP + -0x14],0x7
00713ee8 : MOV dword ptr [EBP + -0x18],EDI
00713eeb : MOV word ptr [EBP + -0x28],CX
00713eef : XOR AL,AL
00713ef1 : MOV ECX,dword ptr [EBP + -0xc]
00713ef4 : MOV dword ptr FS:[0x0],ECX
00713efb : POP ECX
00713efc : POP EDI
00713efd : POP ESI
00713efe : POP EBX
00713eff : MOV ECX,dword ptr [EBP + -0x10]
00713f02 : XOR ECX,EBP
00713f04 : CALL 0x00633e6b
00713f09 : MOV ESP,EBP
00713f0b : POP EBP
00713f0c : RET 0x4

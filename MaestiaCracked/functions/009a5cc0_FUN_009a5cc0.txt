PROGRAM  : Maestia.exe
FUNCTION : FUN_009a5cc0
ENTRY    : 009a5cc0
BODY     : [[009a5cc0, 009a5e17] [009a5e20, 009a60ef]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009a5cc0(int *param_1,int *param_2)

{
  char cVar1;
  char *pcVar2;
  int *piVar3;
  int iVar4;
  int iVar5;
  int *piVar6;
  int iVar7;
  undefined8 uVar8;
  undefined1 local_58 [4];
  undefined2 local_54;
  undefined4 local_44;
  uint local_40;
  undefined1 local_3c [12];
  _SYSTEMTIME local_30;
  int local_20;
  int local_1c;
  int local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4cd4c;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if (((char)param_1[0x17] == '\0') || ((char)param_2 != '\0')) {
    (**(code **)(*param_1 + 0x80))(DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
    iVar7 = 0;
    if (DAT_01724848 != 0) {
      local_18 = -(uint)(*(int *)(DAT_01724848 + 0x28) != 0);
      while (local_18 != 0) {
        if (DAT_01724848 != 0) {
          local_14 = 0;
          FUN_00404160(&local_18,&param_2,&local_14);
          iVar5 = local_14;
          if (local_14 != 0) {
            pcVar2 = (char *)(local_14 + 0x40);
            do {
              cVar1 = *pcVar2;
              pcVar2 = pcVar2 + 1;
            } while (cVar1 != '\0');
            if (pcVar2 != (char *)(local_14 + 0x41)) {
              if ((*(byte *)(local_14 + 0x80) & 2) == 0) {
                iVar4 = FUN_009f2740(CONCAT22(*(undefined2 *)(local_14 + 4),
                                              *(undefined2 *)(local_14 + 6)));
                if (iVar4 == 0) {
LAB_009a5f24:
                  iVar4 = FUN_00b04230(iVar7);
                  if (iVar4 == 0) {
                    FUN_00406460(L"Alloc failed");
                    local_8 = 1;
                    piVar6 = (int *)*DAT_00da98e8;
                    if (piVar6 == (int *)0x0) goto LAB_009a5fc5;
                    uVar8 = 0x10300c89b0c;
                    goto LAB_009a5fbe;
                  }
                  FUN_009f3690(DAT_017247f0);
                }
                else {
                  param_2 = (int *)iVar7;
                  FUN_004437f0(&param_2);
                  if (local_20 == *(int *)(iVar4 + 0xc)) {
                    iVar4 = 0;
                  }
                  else {
                    iVar4 = *(int *)(local_20 + 0x10);
                  }
                  if (iVar4 == 0) goto LAB_009a5f24;
                }
                FUN_009a52d0(iVar7);
                if (*(short *)(iVar5 + 0xa0) == 1) {
                  *(short *)((int)param_1 + 0x5e) = (short)*(undefined4 *)(iVar4 + 0x10);
                }
                iVar7 = iVar7 + 1;
              }
              else {
                iVar5 = FUN_009f2740(CONCAT22(*(undefined2 *)(local_14 + 4),
                                              *(undefined2 *)(local_14 + 6)));
                if (((iVar5 == 0) ||
                    (param_2 = (int *)iVar7, FUN_004437f0(&param_2),
                    local_1c == *(int *)(iVar5 + 0xc))) || (*(int *)(local_1c + 0x10) == 0)) {
                  iVar5 = FUN_00b04230(iVar7);
                  if (iVar5 == 0) {
                    FUN_00406460(L"Alloc failed");
                    local_8 = 0;
                    piVar6 = (int *)*DAT_00da98e8;
                    if (piVar6 == (int *)0x0) goto LAB_009a5fc5;
                    uVar8 = 0xea00c89ab4;
LAB_009a5fbe:
                    (**(code **)(*piVar6 + 0x14))(uVar8,local_3c);
LAB_009a5fc5:
                    local_8 = 0xffffffff;
                    if ((uint)local_30._12_4_ < 8) {
                      ExceptionList = local_10;
                      return;
                    }
                    /* WARNING: Subroutine does not return */
                    FUN_006f04e0();
                  }
                  FUN_009f3690(DAT_017247f0);
                }
              }
            }
          }
        }
      }
    }
    piVar6 = (int *)param_1[0x1a];
    if (piVar6 != (int *)param_1[0x1b]) {
      do {
        iVar5 = DAT_00d7c54c;
        local_20 = *(int *)*piVar6;
        param_2 = piVar6;
        FUN_004437f0(&local_20);
        if ((local_1c != *(int *)(iVar5 + 0x44)) && (iVar5 = *(int *)(local_1c + 0x10), iVar5 != 0))
        {
          pcVar2 = (char *)(iVar5 + 0x40);
          do {
            cVar1 = *pcVar2;
            pcVar2 = pcVar2 + 1;
          } while (cVar1 != '\0');
          if (pcVar2 != (char *)(iVar5 + 0x41)) {
            piVar3 = (int *)FUN_009f2840(iVar7);
            if (piVar3 == (int *)0x0) {
              piVar3 = (int *)FUN_00b04230(iVar7);
              if (piVar3 == (int *)0x0) {
                FUN_00406460(L"Alloc failed");
                local_8 = 2;
                if ((int *)*DAT_00da98e8 != (int *)0x0) {
                  (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                            (L"AvaGuiEmoticon::SetEmoticons",0x136,local_58);
                }
                local_8 = 0xffffffff;
                if (7 < local_40) {
                    /* WARNING: Subroutine does not return */
                  FUN_006f04e0();
                }
                local_40 = 7;
                local_44 = 0;
                local_54 = 0;
              }
              else {
                VariantTimeToSystemTime(*(DOUBLE *)(*param_2 + 8),&local_30);
                iVar4 = FUN_00411e00();
                if (iVar4 == 0) {
                  (**(code **)(*piVar3 + 0x9c))(1);
                  (**(code **)(*piVar3 + 0xa4))();
                }
                FUN_009f3690(DAT_017247f0);
              }
              piVar6 = param_2;
              if (piVar3 == (int *)0x0) goto LAB_009a60c3;
            }
            FUN_009a52d0(iVar7);
            if (*(short *)(iVar5 + 0xa0) == 1) {
              *(short *)((int)param_1 + 0x5e) = (short)piVar3[4];
            }
            iVar7 = iVar7 + 1;
            piVar6 = param_2;
          }
        }
LAB_009a60c3:
        piVar6 = piVar6 + 1;
      } while (piVar6 != (int *)param_1[0x1b]);
    }
    *(undefined1 *)(param_1 + 0x17) = 1;
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
009a5cc0 : PUSH EBP
009a5cc1 : MOV EBP,ESP
009a5cc3 : PUSH -0x1
009a5cc5 : PUSH 0xb4cd4c
009a5cca : MOV EAX,FS:[0x0]
009a5cd0 : PUSH EAX
009a5cd1 : SUB ESP,0x4c
009a5cd4 : PUSH EBX
009a5cd5 : PUSH ESI
009a5cd6 : PUSH EDI
009a5cd7 : MOV EAX,[0x00d66fa0]
009a5cdc : XOR EAX,EBP
009a5cde : PUSH EAX
009a5cdf : LEA EAX,[EBP + -0xc]
009a5ce2 : MOV FS:[0x0],EAX
009a5ce8 : MOV ESI,dword ptr [EBP + 0x8]
009a5ceb : CMP byte ptr [ESI + 0x5c],0x0
009a5cef : JZ 0x009a5cfb
009a5cf1 : CMP byte ptr [EBP + 0xc],0x0
009a5cf5 : JZ 0x009a60dc
009a5cfb : MOV EAX,dword ptr [ESI]
009a5cfd : MOV EDX,dword ptr [EAX + 0x80]
009a5d03 : MOV ECX,ESI
009a5d05 : CALL EDX
009a5d07 : MOV EAX,[0x01724848]
009a5d0c : XOR EBX,EBX
009a5d0e : TEST EAX,EAX
009a5d10 : JZ 0x009a5d22
009a5d12 : MOV ECX,dword ptr [EAX + 0x28]
009a5d15 : NEG ECX
009a5d17 : SBB ECX,ECX
009a5d19 : MOV dword ptr [EBP + -0x14],ECX
009a5d1c : JNZ 0x009a5e25
009a5d22 : MOV EDI,dword ptr [ESI + 0x68]
009a5d25 : MOV dword ptr [EBP + 0xc],EDI
009a5d28 : CMP EDI,dword ptr [ESI + 0x6c]
009a5d2b : JZ 0x009a60d5
009a5d31 : MOV EDX,dword ptr [EDI]
009a5d33 : MOV EAX,dword ptr [EDX]
009a5d35 : MOV ESI,dword ptr [0x00d7c54c]
009a5d3b : LEA ECX,[EBP + -0x1c]
009a5d3e : MOV dword ptr [EBP + -0x1c],EAX
009a5d41 : PUSH ECX
009a5d42 : LEA ECX,[ESI + 0x40]
009a5d45 : LEA EAX,[EBP + -0x18]
009a5d48 : CALL 0x004437f0
009a5d4d : MOV EAX,dword ptr [ESI + 0x44]
009a5d50 : MOV ECX,dword ptr [EBP + -0x18]
009a5d53 : CMP ECX,EAX
009a5d55 : JZ 0x009a60c3
009a5d5b : MOV ESI,dword ptr [ECX + 0x10]
009a5d5e : TEST ESI,ESI
009a5d60 : JZ 0x009a60c3
009a5d66 : LEA EAX,[ESI + 0x40]
009a5d69 : LEA EDX,[EAX + 0x1]
009a5d6c : LEA ESP,[ESP]
009a5d70 : MOV CL,byte ptr [EAX]
009a5d72 : INC EAX
009a5d73 : TEST CL,CL
009a5d75 : JNZ 0x009a5d70
009a5d77 : SUB EAX,EDX
009a5d79 : JZ 0x009a60c3
009a5d7f : MOVZX EAX,word ptr [ESI + 0x4]
009a5d83 : MOVZX EDX,word ptr [ESI + 0x6]
009a5d87 : MOV ECX,dword ptr [0x017247f0]
009a5d8d : SHL EAX,0x10
009a5d90 : OR EAX,EDX
009a5d92 : PUSH EBX
009a5d93 : CALL 0x009f2840
009a5d98 : MOV EDI,EAX
009a5d9a : TEST EDI,EDI
009a5d9c : JNZ 0x009a6094
009a5da2 : MOVZX ECX,word ptr [ESI + 0x4]
009a5da6 : MOVZX EAX,word ptr [ESI + 0x6]
009a5daa : SHL ECX,0x10
009a5dad : OR ECX,EAX
009a5daf : PUSH EBX
009a5db0 : CALL 0x00b04230
009a5db5 : MOV EDI,EAX
009a5db7 : ADD ESP,0x4
009a5dba : TEST EDI,EDI
009a5dbc : JZ 0x009a6032
009a5dc2 : MOV EDX,dword ptr [EBP + 0xc]
009a5dc5 : MOV EAX,dword ptr [EDX]
009a5dc7 : FLD double ptr [EAX + 0x8]
009a5dca : LEA ECX,[EBP + -0x2c]
009a5dcd : PUSH ECX
009a5dce : SUB ESP,0x8
009a5dd1 : FSTP double ptr [ESP]
009a5dd4 : CALL dword ptr [0x00b853d4]
009a5dda : MOV EAX,ESI
009a5ddc : CALL 0x00411e00
009a5de1 : TEST EAX,EAX
009a5de3 : JNZ 0x009a5e03
009a5de5 : MOV EDX,dword ptr [EDI]
009a5de7 : MOV EAX,dword ptr [EDX + 0x9c]
009a5ded : PUSH 0x1
009a5def : MOV ECX,EDI
009a5df1 : CALL EAX
009a5df3 : MOV EDX,dword ptr [EDI]
009a5df5 : MOV EDX,dword ptr [EDX + 0xa4]
009a5dfb : LEA EAX,[EBP + -0x2c]
009a5dfe : PUSH EAX
009a5dff : MOV ECX,EDI
009a5e01 : CALL EDX
009a5e03 : MOV EAX,[0x017247f0]
009a5e08 : MOV ECX,dword ptr [EDI + 0x10]
009a5e0b : PUSH EAX
009a5e0c : MOV EAX,EDI
009a5e0e : CALL 0x009f3690
009a5e13 : JMP 0x009a6090
009a5e20 : MOV EAX,[0x01724848]
009a5e25 : TEST EAX,EAX
009a5e27 : JZ 0x009a5f7e
009a5e2d : LEA ECX,[EBP + -0x10]
009a5e30 : PUSH ECX
009a5e31 : LEA EDX,[EBP + 0xc]
009a5e34 : PUSH EDX
009a5e35 : LEA ECX,[EBP + -0x14]
009a5e38 : PUSH ECX
009a5e39 : MOV dword ptr [EBP + -0x10],0x0
009a5e40 : CALL 0x00404160
009a5e45 : MOV ESI,dword ptr [EBP + -0x10]
009a5e48 : TEST ESI,ESI
009a5e4a : JZ 0x009a5f7e
009a5e50 : LEA EAX,[ESI + 0x40]
009a5e53 : LEA EDX,[EAX + 0x1]
009a5e56 : MOV CL,byte ptr [EAX]
009a5e58 : INC EAX
009a5e59 : TEST CL,CL
009a5e5b : JNZ 0x009a5e56
009a5e5d : SUB EAX,EDX
009a5e5f : JZ 0x009a5f7e
009a5e65 : MOVZX EAX,word ptr [ESI + 0x4]
009a5e69 : SHL EAX,0x10
009a5e6c : TEST byte ptr [ESI + 0x80],0x2
009a5e73 : JZ 0x009a5ee5
009a5e75 : MOVZX EDX,word ptr [ESI + 0x6]
009a5e79 : MOV ECX,dword ptr [0x017247f0]
009a5e7f : OR EAX,EDX
009a5e81 : PUSH EAX
009a5e82 : CALL 0x009f2740
009a5e87 : MOV EDI,EAX
009a5e89 : TEST EDI,EDI
009a5e8b : JZ 0x009a5eb3
009a5e8d : LEA EAX,[EBP + 0xc]
009a5e90 : PUSH EAX
009a5e91 : LEA ECX,[EDI + 0x8]
009a5e94 : LEA EAX,[EBP + -0x18]
009a5e97 : MOV dword ptr [EBP + 0xc],EBX
009a5e9a : CALL 0x004437f0
009a5e9f : MOV EDI,dword ptr [EDI + 0xc]
009a5ea2 : MOV EAX,dword ptr [EBP + -0x18]
009a5ea5 : CMP EAX,EDI
009a5ea7 : JZ 0x009a5eb3
009a5ea9 : CMP dword ptr [EAX + 0x10],0x0
009a5ead : JNZ 0x009a5f7e
009a5eb3 : MOVZX ECX,word ptr [ESI + 0x4]
009a5eb7 : MOVZX EDX,word ptr [ESI + 0x6]
009a5ebb : SHL ECX,0x10
009a5ebe : OR ECX,EDX
009a5ec0 : PUSH EBX
009a5ec1 : CALL 0x00b04230
009a5ec6 : ADD ESP,0x4
009a5ec9 : TEST EAX,EAX
009a5ecb : JZ 0x009a5f90
009a5ed1 : MOV EDX,dword ptr [0x017247f0]
009a5ed7 : MOV ECX,dword ptr [EAX + 0x10]
009a5eda : PUSH EDX
009a5edb : CALL 0x009f3690
009a5ee0 : JMP 0x009a5f7e
009a5ee5 : MOVZX ECX,word ptr [ESI + 0x6]
009a5ee9 : OR EAX,ECX
009a5eeb : MOV ECX,dword ptr [0x017247f0]
009a5ef1 : PUSH EAX
009a5ef2 : CALL 0x009f2740
009a5ef7 : MOV EDI,EAX
009a5ef9 : TEST EDI,EDI
009a5efb : JZ 0x009a5f24
009a5efd : LEA EDX,[EBP + 0xc]
009a5f00 : PUSH EDX
009a5f01 : LEA ECX,[EDI + 0x8]
009a5f04 : LEA EAX,[EBP + -0x1c]
009a5f07 : MOV dword ptr [EBP + 0xc],EBX
009a5f0a : CALL 0x004437f0
009a5f0f : MOV EDI,dword ptr [EDI + 0xc]
009a5f12 : MOV EAX,dword ptr [EBP + -0x1c]
009a5f15 : CMP EAX,EDI
009a5f17 : JNZ 0x009a5f1d
009a5f19 : XOR EDI,EDI
009a5f1b : JMP 0x009a5f20
009a5f1d : MOV EDI,dword ptr [EAX + 0x10]
009a5f20 : TEST EDI,EDI
009a5f22 : JNZ 0x009a5f53
009a5f24 : MOVZX ECX,word ptr [ESI + 0x4]
009a5f28 : MOVZX EAX,word ptr [ESI + 0x6]
009a5f2c : SHL ECX,0x10
009a5f2f : OR ECX,EAX
009a5f31 : PUSH EBX
009a5f32 : CALL 0x00b04230
009a5f37 : MOV EDI,EAX
009a5f39 : ADD ESP,0x4
009a5f3c : TEST EDI,EDI
009a5f3e : JZ 0x009a6002
009a5f44 : MOV EDX,dword ptr [0x017247f0]
009a5f4a : MOV ECX,dword ptr [EDI + 0x10]
009a5f4d : PUSH EDX
009a5f4e : CALL 0x009f3690
009a5f53 : MOVZX ECX,word ptr [ESI + 0x4]
009a5f57 : MOVZX EAX,word ptr [ESI + 0x6]
009a5f5b : MOV EDX,dword ptr [EBP + 0x8]
009a5f5e : SHL ECX,0x10
009a5f61 : PUSH EBX
009a5f62 : OR ECX,EAX
009a5f64 : CALL 0x009a52d0
009a5f69 : CMP word ptr [ESI + 0xa0],0x1
009a5f71 : JNZ 0x009a5f7d
009a5f73 : MOV EDI,dword ptr [EDI + 0x10]
009a5f76 : MOV ECX,dword ptr [EBP + 0x8]
009a5f79 : MOV word ptr [ECX + 0x5e],DI
009a5f7d : INC EBX
009a5f7e : CMP dword ptr [EBP + -0x14],0x0
009a5f82 : JNZ 0x009a5e20
009a5f88 : MOV ESI,dword ptr [EBP + 0x8]
009a5f8b : JMP 0x009a5d22
009a5f90 : PUSH 0xc89a98
009a5f95 : LEA ECX,[EBP + -0x38]
009a5f98 : CALL 0x00406460
009a5f9d : MOV dword ptr [EBP + -0x4],0x0
009a5fa4 : MOV EDX,dword ptr [0x00da98e8]
009a5faa : MOV ECX,dword ptr [EDX]
009a5fac : TEST ECX,ECX
009a5fae : JZ 0x009a5fc5
009a5fb0 : LEA EDX,[EBP + -0x38]
009a5fb3 : PUSH EDX
009a5fb4 : PUSH 0xea
009a5fb9 : PUSH 0xc89ab4
009a5fbe : MOV EAX,dword ptr [ECX]
009a5fc0 : MOV EAX,dword ptr [EAX + 0x14]
009a5fc3 : CALL EAX
009a5fc5 : MOV dword ptr [EBP + -0x4],0xffffffff
009a5fcc : CMP dword ptr [EBP + -0x20],0x8
009a5fd0 : JC 0x009a5fda
009a5fd2 : MOV ECX,dword ptr [EBP + -0x34]
009a5fd5 : CALL 0x006f04e0
009a5fda : XOR ECX,ECX
009a5fdc : MOV dword ptr [EBP + -0x20],0x7
009a5fe3 : MOV dword ptr [EBP + -0x24],0x0
009a5fea : MOV word ptr [EBP + -0x34],CX
009a5fee : MOV ECX,dword ptr [EBP + -0xc]
009a5ff1 : MOV dword ptr FS:[0x0],ECX
009a5ff8 : POP ECX
009a5ff9 : POP EDI
009a5ffa : POP ESI
009a5ffb : POP EBX
009a5ffc : MOV ESP,EBP
009a5ffe : POP EBP
009a5fff : RET 0x8
009a6002 : PUSH 0xc89af0
009a6007 : LEA ECX,[EBP + -0x38]
009a600a : CALL 0x00406460
009a600f : MOV dword ptr [EBP + -0x4],0x1
009a6016 : MOV EDX,dword ptr [0x00da98e8]
009a601c : MOV ECX,dword ptr [EDX]
009a601e : TEST ECX,ECX
009a6020 : JZ 0x009a5fc5
009a6022 : LEA EDX,[EBP + -0x38]
009a6025 : PUSH EDX
009a6026 : PUSH 0x103
009a602b : PUSH 0xc89b0c
009a6030 : JMP 0x009a5fbe
009a6032 : PUSH 0xc89b48
009a6037 : LEA ECX,[EBP + -0x54]
009a603a : CALL 0x00406460
009a603f : MOV dword ptr [EBP + -0x4],0x2
009a6046 : MOV ECX,dword ptr [0x00da98e8]
009a604c : MOV ECX,dword ptr [ECX]
009a604e : TEST ECX,ECX
009a6050 : JZ 0x009a6067
009a6052 : MOV EDX,dword ptr [ECX]
009a6054 : MOV EDX,dword ptr [EDX + 0x14]
009a6057 : LEA EAX,[EBP + -0x54]
009a605a : PUSH EAX
009a605b : PUSH 0x136
009a6060 : PUSH 0xc89b64
009a6065 : CALL EDX
009a6067 : MOV dword ptr [EBP + -0x4],0xffffffff
009a606e : CMP dword ptr [EBP + -0x3c],0x8
009a6072 : JC 0x009a607c
009a6074 : MOV ECX,dword ptr [EBP + -0x50]
009a6077 : CALL 0x006f04e0
009a607c : XOR EAX,EAX
009a607e : MOV dword ptr [EBP + -0x3c],0x7
009a6085 : MOV dword ptr [EBP + -0x40],0x0
009a608c : MOV word ptr [EBP + -0x50],AX
009a6090 : TEST EDI,EDI
009a6092 : JZ 0x009a60c0
009a6094 : MOVZX ECX,word ptr [ESI + 0x4]
009a6098 : MOVZX EDX,word ptr [ESI + 0x6]
009a609c : SHL ECX,0x10
009a609f : OR ECX,EDX
009a60a1 : MOV EDX,dword ptr [EBP + 0x8]
009a60a4 : PUSH EBX
009a60a5 : CALL 0x009a52d0
009a60aa : CMP word ptr [ESI + 0xa0],0x1
009a60b2 : JNZ 0x009a60bf
009a60b4 : MOV AX,word ptr [EDI + 0x10]
009a60b8 : MOV ECX,dword ptr [EBP + 0x8]
009a60bb : MOV word ptr [ECX + 0x5e],AX
009a60bf : INC EBX
009a60c0 : MOV EDI,dword ptr [EBP + 0xc]
009a60c3 : MOV EDX,dword ptr [EBP + 0x8]
009a60c6 : ADD EDI,0x4
009a60c9 : MOV dword ptr [EBP + 0xc],EDI
009a60cc : CMP EDI,dword ptr [EDX + 0x6c]
009a60cf : JNZ 0x009a5d31
009a60d5 : MOV EAX,dword ptr [EBP + 0x8]
009a60d8 : MOV byte ptr [EAX + 0x5c],0x1
009a60dc : MOV ECX,dword ptr [EBP + -0xc]
009a60df : MOV dword ptr FS:[0x0],ECX
009a60e6 : POP ECX
009a60e7 : POP EDI
009a60e8 : POP ESI
009a60e9 : POP EBX
009a60ea : MOV ESP,EBP
009a60ec : POP EBP
009a60ed : RET 0x8

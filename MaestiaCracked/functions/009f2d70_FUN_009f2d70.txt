PROGRAM  : Maestia.exe
FUNCTION : FUN_009f2d70
ENTRY    : 009f2d70
BODY     : [[009f2d70, 009f2f90]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009f2d70(int param_1,undefined4 param_2)

{
  int *piVar1;
  short sVar2;
  char cVar3;
  uint uVar4;
  int iVar5;
  int *piVar6;
  undefined4 uVar7;
  undefined4 in_ECX;
  undefined4 *puVar8;
  LPCRITICAL_SECTION local_24;
  char *local_20;
  undefined4 *local_1c;
  undefined4 *local_18;
  undefined4 local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b2f66b;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  cVar3 = (char)((uint)in_ECX >> 0x18);
  if (cVar3 == '\a') {
    iVar5 = FUN_009f2740(in_ECX);
    if (iVar5 != 0) {
      FUN_009ea720(uVar4);
      iVar5 = FUN_008413b0(in_ECX,0);
      if (iVar5 != 0) {
        if (*(char *)(iVar5 + 0x31) == '\0') {
          FUN_009ec670(param_2);
          ExceptionList = local_10;
          return;
        }
        FUN_0047bc90(&local_20,DAT_01724910 + 0x44);
        local_8 = 0;
        for (puVar8 = local_1c; puVar8 != local_18; puVar8 = puVar8 + 1) {
          iVar5 = FUN_009f2740(*(undefined4 *)*puVar8);
          if (iVar5 == 0) {
            local_8 = 0xffffffff;
            if (local_1c == (undefined4 *)0x0) {
              ExceptionList = local_10;
              return;
            }
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          FUN_009ec670(param_2);
        }
        local_8 = 0xffffffff;
        if (local_1c == (undefined4 *)0x0) {
          ExceptionList = local_10;
          return;
        }
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
    }
  }
  else if (cVar3 == '\x06') {
    sVar2 = 0;
    piVar6 = (int *)FUN_004049b0();
    if ((piVar6 != (int *)0x0) && (iVar5 = (**(code **)(*piVar6 + 0x48))(), iVar5 != 0)) {
      iVar5 = (**(code **)(*piVar6 + 0x68))();
      if (iVar5 == 0) {
        ExceptionList = local_10;
        return;
      }
      sVar2 = (short)piVar6[0x5e];
    }
    local_24 = (LPCRITICAL_SECTION)(param_1 + 0x18);
    local_18 = (undefined4 *)0x0;
    local_20 = ".\\Items\\AvaItemManager.cpp";
    local_1c = (undefined4 *)0x135;
    local_14 = 1;
    FUN_006ef1a0(&local_24);
    local_8 = 1;
    piVar6 = *(int **)(param_1 + 8);
    piVar1 = (int *)*piVar6;
    while (piVar1 != piVar6) {
      if (*(short *)(piVar1[4] + 0xd0) == sVar2) {
        uVar7 = FUN_009ea720();
        FUN_009ec670(uVar7);
      }
      FUN_00416210();
    }
    local_8 = 0xffffffff;
    if (local_18 != (undefined4 *)0x0) {
      LeaveCriticalSection(local_24);
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
009f2d70 : PUSH EBP
009f2d71 : MOV EBP,ESP
009f2d73 : PUSH -0x1
009f2d75 : PUSH 0xb2f66b
009f2d7a : MOV EAX,FS:[0x0]
009f2d80 : PUSH EAX
009f2d81 : SUB ESP,0x14
009f2d84 : PUSH EBX
009f2d85 : PUSH ESI
009f2d86 : PUSH EDI
009f2d87 : MOV EAX,[0x00d66fa0]
009f2d8c : XOR EAX,EBP
009f2d8e : PUSH EAX
009f2d8f : LEA EAX,[EBP + -0xc]
009f2d92 : MOV FS:[0x0],EAX
009f2d98 : MOV EDI,ECX
009f2d9a : MOV EBX,dword ptr [EBP + 0x8]
009f2d9d : MOV EAX,EDI
009f2d9f : SHR EAX,0x18
009f2da2 : CMP AL,0x7
009f2da4 : JNZ 0x009f2eab
009f2daa : PUSH EDI
009f2dab : MOV ECX,EBX
009f2dad : CALL 0x009f2740
009f2db2 : MOV ESI,EAX
009f2db4 : TEST ESI,ESI
009f2db6 : JZ 0x009f2f7d
009f2dbc : CALL 0x009ea720
009f2dc1 : MOV ECX,dword ptr [0x01724910]
009f2dc7 : PUSH 0x0
009f2dc9 : PUSH EDI
009f2dca : CALL 0x008413b0
009f2dcf : TEST EAX,EAX
009f2dd1 : JZ 0x009f2f7d
009f2dd7 : CMP byte ptr [EAX + 0x31],0x0
009f2ddb : JZ 0x009f2e8c
009f2de1 : MOV EAX,[0x01724910]
009f2de6 : ADD EAX,0x44
009f2de9 : PUSH EAX
009f2dea : LEA ECX,[EBP + -0x1c]
009f2ded : PUSH ECX
009f2dee : CALL 0x0047bc90
009f2df3 : MOV dword ptr [EBP + -0x4],0x0
009f2dfa : MOV ECX,dword ptr [EBP + -0x18]
009f2dfd : MOV EDI,dword ptr [EBP + -0x14]
009f2e00 : MOV ESI,ECX
009f2e02 : CMP ECX,EDI
009f2e04 : JZ 0x009f2e2b
009f2e06 : MOV EAX,dword ptr [ESI]
009f2e08 : MOV EAX,dword ptr [EAX]
009f2e0a : PUSH EAX
009f2e0b : MOV ECX,EBX
009f2e0d : CALL 0x009f2740
009f2e12 : TEST EAX,EAX
009f2e14 : JZ 0x009f2e5a
009f2e16 : MOV EDX,dword ptr [EBP + 0xc]
009f2e19 : PUSH EDX
009f2e1a : MOV ECX,EAX
009f2e1c : CALL 0x009ec670
009f2e21 : ADD ESI,0x4
009f2e24 : CMP ESI,EDI
009f2e26 : JNZ 0x009f2e06
009f2e28 : MOV ECX,dword ptr [EBP + -0x18]
009f2e2b : MOV dword ptr [EBP + -0x4],0xffffffff
009f2e32 : XOR ESI,ESI
009f2e34 : CMP ECX,ESI
009f2e36 : JZ 0x009f2e3d
009f2e38 : CALL 0x006f04e0
009f2e3d : MOV dword ptr [EBP + -0x18],ESI
009f2e40 : MOV dword ptr [EBP + -0x14],ESI
009f2e43 : MOV dword ptr [EBP + -0x10],ESI
009f2e46 : MOV ECX,dword ptr [EBP + -0xc]
009f2e49 : MOV dword ptr FS:[0x0],ECX
009f2e50 : POP ECX
009f2e51 : POP EDI
009f2e52 : POP ESI
009f2e53 : POP EBX
009f2e54 : MOV ESP,EBP
009f2e56 : POP EBP
009f2e57 : RET 0x8
009f2e5a : MOV dword ptr [EBP + -0x4],0xffffffff
009f2e61 : MOV ECX,dword ptr [EBP + -0x18]
009f2e64 : TEST ECX,ECX
009f2e66 : JZ 0x009f2e6d
009f2e68 : CALL 0x006f04e0
009f2e6d : XOR EAX,EAX
009f2e6f : MOV dword ptr [EBP + -0x18],EAX
009f2e72 : MOV dword ptr [EBP + -0x14],EAX
009f2e75 : MOV dword ptr [EBP + -0x10],EAX
009f2e78 : MOV ECX,dword ptr [EBP + -0xc]
009f2e7b : MOV dword ptr FS:[0x0],ECX
009f2e82 : POP ECX
009f2e83 : POP EDI
009f2e84 : POP ESI
009f2e85 : POP EBX
009f2e86 : MOV ESP,EBP
009f2e88 : POP EBP
009f2e89 : RET 0x8
009f2e8c : MOV EAX,dword ptr [EBP + 0xc]
009f2e8f : PUSH EAX
009f2e90 : MOV ECX,ESI
009f2e92 : CALL 0x009ec670
009f2e97 : MOV ECX,dword ptr [EBP + -0xc]
009f2e9a : MOV dword ptr FS:[0x0],ECX
009f2ea1 : POP ECX
009f2ea2 : POP EDI
009f2ea3 : POP ESI
009f2ea4 : POP EBX
009f2ea5 : MOV ESP,EBP
009f2ea7 : POP EBP
009f2ea8 : RET 0x8
009f2eab : CMP AL,0x6
009f2ead : JNZ 0x009f2f7d
009f2eb3 : PUSH EDI
009f2eb4 : MOV dword ptr [EBP + 0xc],0x0
009f2ebb : CALL 0x004049b0
009f2ec0 : MOV ESI,EAX
009f2ec2 : ADD ESP,0x4
009f2ec5 : TEST ESI,ESI
009f2ec7 : JZ 0x009f2ef1
009f2ec9 : MOV EDX,dword ptr [ESI]
009f2ecb : MOV EAX,dword ptr [EDX + 0x48]
009f2ece : MOV ECX,ESI
009f2ed0 : CALL EAX
009f2ed2 : TEST EAX,EAX
009f2ed4 : JZ 0x009f2ef1
009f2ed6 : MOV EDX,dword ptr [ESI]
009f2ed8 : MOV EAX,dword ptr [EDX + 0x68]
009f2edb : MOV ECX,ESI
009f2edd : CALL EAX
009f2edf : TEST EAX,EAX
009f2ee1 : JZ 0x009f2f7d
009f2ee7 : MOVZX ECX,word ptr [ESI + 0x178]
009f2eee : MOV dword ptr [EBP + 0xc],ECX
009f2ef1 : LEA EAX,[EBP + -0x20]
009f2ef4 : LEA EDX,[EBX + 0x18]
009f2ef7 : MOV ESI,0x1
009f2efc : PUSH EAX
009f2efd : MOV dword ptr [EBP + -0x14],0x0
009f2f04 : MOV dword ptr [EBP + -0x20],EDX
009f2f07 : MOV dword ptr [EBP + -0x1c],0xca52cc
009f2f0e : MOV dword ptr [EBP + -0x18],0x135
009f2f15 : MOV dword ptr [EBP + -0x10],ESI
009f2f18 : CALL 0x006ef1a0
009f2f1d : MOV dword ptr [EBP + -0x4],ESI
009f2f20 : MOV EBX,dword ptr [EBX + 0x8]
009f2f23 : MOV EDI,dword ptr [EBX]
009f2f25 : MOV dword ptr [EBP + 0x8],EDI
009f2f28 : CMP EDI,EBX
009f2f2a : JZ 0x009f2f5f
009f2f2c : LEA ESP,[ESP]
009f2f30 : MOV ECX,dword ptr [EDI + 0x10]
009f2f33 : MOVZX EAX,word ptr [ECX + 0xd0]
009f2f3a : CMP AX,word ptr [EBP + 0xc]
009f2f3e : JNZ 0x009f2f50
009f2f40 : MOV ESI,ECX
009f2f42 : CALL 0x009ea720
009f2f47 : MOV ECX,dword ptr [EDI + 0x10]
009f2f4a : PUSH EAX
009f2f4b : CALL 0x009ec670
009f2f50 : LEA EDX,[EBP + 0x8]
009f2f53 : CALL 0x00416210
009f2f58 : MOV EDI,dword ptr [EBP + 0x8]
009f2f5b : CMP EDI,EBX
009f2f5d : JNZ 0x009f2f30
009f2f5f : MOV dword ptr [EBP + -0x4],0xffffffff
009f2f66 : CMP dword ptr [EBP + -0x14],0x0
009f2f6a : JZ 0x009f2f7d
009f2f6c : MOV EDX,dword ptr [EBP + -0x20]
009f2f6f : PUSH EDX
009f2f70 : CALL dword ptr [0x00b8511c]
009f2f76 : MOV dword ptr [EBP + -0x14],0x0
009f2f7d : MOV ECX,dword ptr [EBP + -0xc]
009f2f80 : MOV dword ptr FS:[0x0],ECX
009f2f87 : POP ECX
009f2f88 : POP EDI
009f2f89 : POP ESI
009f2f8a : POP EBX
009f2f8b : MOV ESP,EBP
009f2f8d : POP EBP
009f2f8e : RET 0x8

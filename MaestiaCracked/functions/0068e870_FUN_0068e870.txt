PROGRAM  : Maestia.exe
FUNCTION : FUN_0068e870
ENTRY    : 0068e870
BODY     : [[0068e870, 0068eada]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_0068e870(undefined4 param_1,uint param_2,uint *param_3)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  undefined4 *in_EAX;
  uint *puVar4;
  undefined4 uVar5;
  undefined1 local_4 [4];
  
  uVar3 = param_2;
  param_2 = 0;
  puVar4 = (uint *)FUN_00688c00(uVar3,0x203c,&param_2);
  if (param_2 != 0) goto LAB_0068eab0;
  if (in_EAX == (undefined4 *)0x0) {
    in_EAX = &DAT_00bd8ac8;
  }
  puVar4[9] = (uint)in_EAX;
  *(undefined2 *)(puVar4 + 3) = 0x7fff;
  puVar4[0x80e] = uVar3;
  FUN_0068bf20(uVar3);
  param_2 = FUN_0068c2b0(param_1,puVar4,local_4);
  if (param_2 == 0) {
    uVar1 = puVar4[8];
    if (uVar1 != 0) {
      if (*(int *)(uVar1 + 0x1c) != 8) {
        *(undefined2 *)(uVar1 + 0x20) = *(undefined2 *)(uVar1 + 4);
      }
      uVar1 = puVar4[8];
      if (puVar4[1] != *(int *)(uVar1 + 0x40) + *(int *)(uVar1 + 0x34)) {
        *(undefined2 *)(uVar1 + 0x4084) = 1;
      }
      if ((*(int *)puVar4[9] != 0) &&
         ((uVar1 = puVar4[8], *(int *)(uVar1 + 0x34) != 0 || (*(int *)(uVar1 + 0x40) != 0)))) {
        if ((int)(short)puVar4[4] - (int)(short)puVar4[3] != (uint)*(ushort *)(uVar1 + 4)) {
          *(short *)(uVar1 + 4) = (short)puVar4[4] - (short)puVar4[3];
          *(undefined2 *)(puVar4[8] + 0x4084) = 1;
        }
        if (*(short *)(puVar4[8] + 8) != (short)puVar4[3]) {
          *(short *)(puVar4[8] + 8) = (short)puVar4[3];
          *(undefined2 *)(puVar4[8] + 0x4084) = 1;
        }
        if (*(short *)(puVar4[8] + 0xc) != *(short *)((int)puVar4 + 0x12)) {
          *(short *)(puVar4[8] + 0xc) = *(short *)((int)puVar4 + 0x12);
          *(undefined2 *)(puVar4[8] + 0x4084) = 1;
        }
        if (*(short *)(puVar4[8] + 0xe) != (short)puVar4[5]) {
          *(short *)(puVar4[8] + 0xe) = (short)puVar4[5];
          *(short *)(puVar4[8] + 10) = -(short)puVar4[5];
          *(undefined2 *)(puVar4[8] + 0x4084) = 1;
        }
        if ((int)(short)puVar4[5] + (int)*(short *)((int)puVar4 + 0x12) !=
            (uint)*(ushort *)(puVar4[8] + 6)) {
          *(short *)(puVar4[8] + 6) = (short)puVar4[5] + *(short *)((int)puVar4 + 0x12);
        }
      }
    }
    if ((*puVar4 & 1) != 0) {
      param_2 = (*puVar4 & 0xff) >> 5 & 1 | 0xb8;
      goto LAB_0068eab0;
    }
    uVar1 = puVar4[8];
    if (uVar1 == 0) {
      param_2 = 3;
    }
    else {
      iVar2 = *(int *)(uVar1 + 0x58);
      if (iVar2 != 0) {
        uVar5 = FUN_0068a220(*(undefined4 *)(uVar1 + 0x4088),1,iVar2,iVar2 + 1,
                             *(undefined4 *)(uVar1 + 0x54),&param_2);
        *(undefined4 *)(puVar4[8] + 0x54) = uVar5;
        if (param_2 != 0) goto LAB_0068ea65;
        *(undefined1 *)(*(int *)(puVar4[8] + 0x58) + *(int *)(puVar4[8] + 0x54)) = 0;
      }
    }
    *param_3 = puVar4[8];
  }
  else {
LAB_0068ea65:
    FUN_0068d890();
    FUN_00687f30(uVar3,puVar4[8]);
    puVar4[8] = 0;
  }
LAB_0068eab0:
  if (puVar4 != (uint *)0x0) {
    FUN_0068bf40();
    FUN_00687f30(uVar3,puVar4);
    return param_2;
  }
  return param_2;
}



============================================================
DISASSEMBLY
============================================================
0068e870 : PUSH ECX
0068e871 : PUSH EBX
0068e872 : PUSH EBP
0068e873 : MOV EBP,dword ptr [ESP + 0x14]
0068e877 : PUSH ESI
0068e878 : PUSH EDI
0068e879 : MOV ESI,EAX
0068e87b : LEA EAX,[ESP + 0x1c]
0068e87f : PUSH EAX
0068e880 : PUSH 0x203c
0068e885 : PUSH EBP
0068e886 : MOV dword ptr [ESP + 0x28],0x0
0068e88e : CALL 0x00688c00
0068e893 : MOV EBX,dword ptr [ESP + 0x28]
0068e897 : ADD ESP,0xc
0068e89a : MOV EDI,EAX
0068e89c : TEST EBX,EBX
0068e89e : JNZ 0x0068eab0
0068e8a4 : MOV EAX,ESI
0068e8a6 : TEST ESI,ESI
0068e8a8 : JNZ 0x0068e8af
0068e8aa : MOV EAX,0xbd8ac8
0068e8af : MOV dword ptr [EDI + 0x24],EAX
0068e8b2 : MOV ECX,0x7fff
0068e8b7 : PUSH EBP
0068e8b8 : LEA EAX,[EDI + 0x2028]
0068e8be : MOV word ptr [EDI + 0xc],CX
0068e8c2 : MOV dword ptr [EDI + 0x2038],EBP
0068e8c8 : CALL 0x0068bf20
0068e8cd : MOV EAX,dword ptr [ESP + 0x1c]
0068e8d1 : LEA EDX,[ESP + 0x14]
0068e8d5 : PUSH EDX
0068e8d6 : PUSH EDI
0068e8d7 : PUSH EAX
0068e8d8 : MOV EAX,0x68e2d0
0068e8dd : CALL 0x0068c2b0
0068e8e2 : MOV EBX,EAX
0068e8e4 : ADD ESP,0x10
0068e8e7 : MOV dword ptr [ESP + 0x1c],EBX
0068e8eb : TEST EBX,EBX
0068e8ed : JNZ 0x0068ea65
0068e8f3 : MOV EAX,dword ptr [EDI + 0x20]
0068e8f6 : TEST EAX,EAX
0068e8f8 : JZ 0x0068ea0d
0068e8fe : CMP dword ptr [EAX + 0x1c],0x8
0068e902 : JZ 0x0068e910
0068e904 : MOV CX,word ptr [EAX + 0x4]
0068e908 : MOV word ptr [EAX + 0x20],CX
0068e90c : MOV EBX,dword ptr [ESP + 0x1c]
0068e910 : MOV EAX,dword ptr [EDI + 0x20]
0068e913 : MOV EDX,dword ptr [EAX + 0x40]
0068e916 : ADD EDX,dword ptr [EAX + 0x34]
0068e919 : CMP dword ptr [EDI + 0x4],EDX
0068e91c : JZ 0x0068e92e
0068e91e : MOV ECX,0x1
0068e923 : MOV word ptr [EAX + 0x4084],CX
0068e92a : MOV EBX,dword ptr [ESP + 0x1c]
0068e92e : MOV EDX,dword ptr [EDI + 0x24]
0068e931 : CMP dword ptr [EDX],0x0
0068e934 : JZ 0x0068ea0d
0068e93a : MOV ECX,dword ptr [EDI + 0x20]
0068e93d : CMP dword ptr [ECX + 0x34],0x0
0068e941 : JA 0x0068e94d
0068e943 : CMP dword ptr [ECX + 0x40],0x0
0068e947 : JBE 0x0068ea0d
0068e94d : MOVZX EAX,word ptr [EDI + 0x10]
0068e951 : MOVZX EDX,word ptr [EDI + 0xc]
0068e955 : MOVSX ESI,DX
0068e958 : MOVSX EBX,AX
0068e95b : SUB EBX,ESI
0068e95d : MOVZX ESI,word ptr [ECX + 0x4]
0068e961 : CMP EBX,ESI
0068e963 : JZ 0x0068e97a
0068e965 : SUB EAX,EDX
0068e967 : MOV word ptr [ECX + 0x4],AX
0068e96b : MOV EAX,dword ptr [EDI + 0x20]
0068e96e : MOV ECX,0x1
0068e973 : MOV word ptr [EAX + 0x4084],CX
0068e97a : MOVZX ECX,word ptr [EDI + 0xc]
0068e97e : MOV EAX,dword ptr [EDI + 0x20]
0068e981 : CMP word ptr [EAX + 0x8],CX
0068e985 : JZ 0x0068e99a
0068e987 : MOV word ptr [EAX + 0x8],CX
0068e98b : MOV EDX,dword ptr [EDI + 0x20]
0068e98e : MOV EAX,0x1
0068e993 : MOV word ptr [EDX + 0x4084],AX
0068e99a : MOVZX ECX,word ptr [EDI + 0x12]
0068e99e : MOV EAX,dword ptr [EDI + 0x20]
0068e9a1 : CMP word ptr [EAX + 0xc],CX
0068e9a5 : JZ 0x0068e9ba
0068e9a7 : MOV word ptr [EAX + 0xc],CX
0068e9ab : MOV ECX,dword ptr [EDI + 0x20]
0068e9ae : MOV EDX,0x1
0068e9b3 : MOV word ptr [ECX + 0x4084],DX
0068e9ba : MOVZX ECX,word ptr [EDI + 0x14]
0068e9be : MOV EAX,dword ptr [EDI + 0x20]
0068e9c1 : CMP word ptr [EAX + 0xe],CX
0068e9c5 : JZ 0x0068e9e8
0068e9c7 : MOV word ptr [EAX + 0xe],CX
0068e9cb : MOV AX,word ptr [EDI + 0x14]
0068e9cf : MOV ECX,dword ptr [EDI + 0x20]
0068e9d2 : NEG AX
0068e9d5 : MOV word ptr [ECX + 0xa],AX
0068e9d9 : MOV EDX,dword ptr [EDI + 0x20]
0068e9dc : MOV EAX,0x1
0068e9e1 : MOV word ptr [EDX + 0x4084],AX
0068e9e8 : MOVZX EAX,word ptr [EDI + 0x14]
0068e9ec : MOVZX ECX,word ptr [EDI + 0x12]
0068e9f0 : MOV EDX,dword ptr [EDI + 0x20]
0068e9f3 : MOVSX EBX,CX
0068e9f6 : MOVSX ESI,AX
0068e9f9 : ADD ESI,EBX
0068e9fb : MOVZX EBX,word ptr [EDX + 0x6]
0068e9ff : CMP ESI,EBX
0068ea01 : JZ 0x0068ea09
0068ea03 : ADD EAX,ECX
0068ea05 : MOV word ptr [EDX + 0x6],AX
0068ea09 : MOV EBX,dword ptr [ESP + 0x1c]
0068ea0d : MOV EAX,dword ptr [EDI]
0068ea0f : TEST AL,0x1
0068ea11 : JZ 0x0068ea2b
0068ea13 : MOVZX EBX,AL
0068ea16 : SHR EBX,0x5
0068ea19 : AND EBX,0x1
0068ea1c : OR EBX,0xb8
0068ea22 : MOV dword ptr [ESP + 0x1c],EBX
0068ea26 : JMP 0x0068eab0
0068ea2b : MOV ECX,dword ptr [EDI + 0x20]
0068ea2e : TEST ECX,ECX
0068ea30 : JZ 0x0068ea9a
0068ea32 : MOV EAX,dword ptr [ECX + 0x58]
0068ea35 : MOV EDX,dword ptr [ECX + 0x4088]
0068ea3b : TEST EAX,EAX
0068ea3d : JBE 0x0068eaa7
0068ea3f : MOV ECX,dword ptr [ECX + 0x54]
0068ea42 : LEA ESI,[ESP + 0x1c]
0068ea46 : PUSH ESI
0068ea47 : PUSH ECX
0068ea48 : LEA ECX,[EAX + 0x1]
0068ea4b : PUSH ECX
0068ea4c : PUSH EAX
0068ea4d : PUSH 0x1
0068ea4f : PUSH EDX
0068ea50 : CALL 0x0068a220
0068ea55 : MOV EDX,dword ptr [EDI + 0x20]
0068ea58 : ADD ESP,0x18
0068ea5b : MOV dword ptr [EDX + 0x54],EAX
0068ea5e : CMP dword ptr [ESP + 0x1c],0x0
0068ea63 : JZ 0x0068ea87
0068ea65 : MOV ESI,dword ptr [EDI + 0x20]
0068ea68 : CALL 0x0068d890
0068ea6d : MOV EAX,dword ptr [EDI + 0x20]
0068ea70 : PUSH EAX
0068ea71 : PUSH EBP
0068ea72 : CALL 0x00687f30
0068ea77 : MOV dword ptr [EDI + 0x20],0x0
0068ea7e : MOV EBX,dword ptr [ESP + 0x24]
0068ea82 : ADD ESP,0x8
0068ea85 : JMP 0x0068eab0
0068ea87 : MOV EAX,dword ptr [EDI + 0x20]
0068ea8a : MOV ECX,dword ptr [EAX + 0x58]
0068ea8d : MOV EDX,dword ptr [EAX + 0x54]
0068ea90 : MOV byte ptr [ECX + EDX*0x1],0x0
0068ea94 : MOV EBX,dword ptr [ESP + 0x1c]
0068ea98 : JMP 0x0068eaa7
0068ea9a : TEST EBX,EBX
0068ea9c : JNZ 0x0068eaa7
0068ea9e : MOV EBX,0x3
0068eaa3 : MOV dword ptr [ESP + 0x1c],EBX
0068eaa7 : MOV EAX,dword ptr [EDI + 0x20]
0068eaaa : MOV ECX,dword ptr [ESP + 0x20]
0068eaae : MOV dword ptr [ECX],EAX
0068eab0 : TEST EDI,EDI
0068eab2 : JZ 0x0068ead3
0068eab4 : LEA ESI,[EDI + 0x2028]
0068eaba : CALL 0x0068bf40
0068eabf : PUSH EDI
0068eac0 : PUSH EBP
0068eac1 : CALL 0x00687f30
0068eac6 : MOV EAX,dword ptr [ESP + 0x24]
0068eaca : ADD ESP,0x8
0068eacd : POP EDI
0068eace : POP ESI
0068eacf : POP EBP
0068ead0 : POP EBX
0068ead1 : POP ECX
0068ead2 : RET
0068ead3 : POP EDI
0068ead4 : POP ESI
0068ead5 : POP EBP
0068ead6 : MOV EAX,EBX
0068ead8 : POP EBX
0068ead9 : POP ECX
0068eada : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_005af0a0
ENTRY    : 005af0a0
BODY     : [[005af0a0, 005af0bc] [005af0c0, 005af21b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005af0a0(void)

{
  int iVar1;
  uint uVar2;
  int *piVar3;
  uint uVar4;
  int *in_ECX;
  int iVar5;
  uint uVar6;
  undefined4 uVar7;
  undefined4 uStack_8;
  uint uStack_4;
  
  uVar2 = in_ECX[9];
  iVar5 = 0;
  uVar6 = 0;
  in_ECX[3] = 0;
  if (uVar2 != 0) {
    do {
      if (uVar6 < 0x10) {
        iVar1 = iVar5 + 0x34 + (int)in_ECX;
        piVar3 = (int *)(iVar5 + 0x34 + (int)in_ECX);
      }
      else {
        iVar1 = in_ECX[10] + -0xc0 + iVar5;
        piVar3 = (int *)(in_ECX[10] + -0xc0 + iVar5);
      }
      if (*piVar3 == 0) {
        in_ECX[3] = in_ECX[3] + (uint)*(byte *)(iVar1 + 8);
      }
      else if (*piVar3 == 2) {
        FUN_005aea40(uVar6);
        if (*(int **)(iVar1 + 4) != (int *)0x0) {
          iVar1 = (**(code **)(**(int **)(iVar1 + 4) + 0x14))();
          in_ECX[3] = in_ECX[3] + iVar1;
        }
      }
      uVar6 = uVar6 + 1;
      iVar5 = iVar5 + 0xc;
    } while (uVar6 < uVar2);
  }
  iVar5 = in_ECX[6];
  if (iVar5 == 0) {
    FUN_0051ba00(in_ECX,in_ECX[3]);
  }
  else if (iVar5 == 1) {
    uVar2 = in_ECX[9];
    FUN_0051b400(*(int *)(in_ECX[7] + 4) + in_ECX[3]);
    if (uVar2 != 0) {
      iVar5 = 0;
      uVar6 = 0;
      do {
        if (uVar6 < 0x10) {
          iVar1 = iVar5 + 0x34 + (int)in_ECX;
          piVar3 = (int *)(iVar5 + 0x34 + (int)in_ECX);
        }
        else {
          iVar1 = in_ECX[10] + -0xc0 + iVar5;
          piVar3 = (int *)(in_ECX[10] + -0xc0 + iVar5);
        }
        if (*piVar3 == 0) {
          uVar4 = (uint)*(byte *)(iVar1 + 8);
          uVar7 = *(undefined4 *)(iVar1 + 4);
LAB_005af1ee:
          FUN_0051b5d0(uVar7,uVar4);
        }
        else if ((*piVar3 == 2) && (*(int **)(iVar1 + 4) != (int *)0x0)) {
          (**(code **)(**(int **)(iVar1 + 4) + 0x10))(&uStack_8);
          uVar7 = uStack_8;
          uVar4 = uStack_4;
          goto LAB_005af1ee;
        }
        uVar6 = uVar6 + 1;
        iVar5 = iVar5 + 0xc;
        if (uVar2 <= uVar6) {
          return;
        }
      } while( true );
    }
  }
  else if (iVar5 == 2) {
    iVar5 = in_ECX[7];
    (**(code **)(*in_ECX + 4))(iVar5,in_ECX[8]);
    uVar2 = in_ECX[3];
    if (in_ECX[8] - 1U < (uint)in_ECX[3]) {
      uVar2 = in_ECX[8] - 1U;
    }
    *(undefined1 *)(uVar2 + iVar5) = 0;
    return;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005af0a0 : SUB ESP,0xc
005af0a3 : PUSH EBX
005af0a4 : PUSH EBP
005af0a5 : PUSH ESI
005af0a6 : MOV ESI,ECX
005af0a8 : MOV EAX,dword ptr [ESI + 0x24]
005af0ab : XOR EBX,EBX
005af0ad : PUSH EDI
005af0ae : XOR EDI,EDI
005af0b0 : MOV dword ptr [ESI + 0xc],EBX
005af0b3 : MOV dword ptr [ESP + 0x10],EAX
005af0b7 : CMP EAX,EBX
005af0b9 : JBE 0x005af122
005af0bb : JMP 0x005af0c0
005af0c0 : CMP EDI,0x10
005af0c3 : JNC 0x005af0cb
005af0c5 : LEA EBP,[EBX + ESI*0x1 + 0x34]
005af0c9 : JMP 0x005af0d5
005af0cb : MOV EAX,dword ptr [ESI + 0x28]
005af0ce : LEA EBP,[EAX + EBX*0x1 + 0xffffff40]
005af0d5 : CMP EDI,0x10
005af0d8 : JNC 0x005af0e0
005af0da : LEA EAX,[EBX + ESI*0x1 + 0x34]
005af0de : JMP 0x005af0ea
005af0e0 : MOV ECX,dword ptr [ESI + 0x28]
005af0e3 : LEA EAX,[ECX + EBX*0x1 + 0xffffff40]
005af0ea : MOV EAX,dword ptr [EAX]
005af0ec : SUB EAX,0x0
005af0ef : JZ 0x005af111
005af0f1 : SUB EAX,0x2
005af0f4 : JNZ 0x005af118
005af0f6 : PUSH EDI
005af0f7 : MOV ECX,ESI
005af0f9 : CALL 0x005aea40
005af0fe : MOV ECX,dword ptr [EBP + 0x4]
005af101 : TEST ECX,ECX
005af103 : JZ 0x005af118
005af105 : MOV EDX,dword ptr [ECX]
005af107 : MOV EAX,dword ptr [EDX + 0x14]
005af10a : CALL EAX
005af10c : ADD dword ptr [ESI + 0xc],EAX
005af10f : JMP 0x005af118
005af111 : MOVZX ECX,byte ptr [EBP + 0x8]
005af115 : ADD dword ptr [ESI + 0xc],ECX
005af118 : INC EDI
005af119 : ADD EBX,0xc
005af11c : CMP EDI,dword ptr [ESP + 0x10]
005af120 : JC 0x005af0c0
005af122 : MOV EAX,dword ptr [ESI + 0x18]
005af125 : SUB EAX,0x0
005af128 : JZ 0x005af207
005af12e : SUB EAX,0x1
005af131 : JZ 0x005af166
005af133 : SUB EAX,0x1
005af136 : JNZ 0x005af214
005af13c : MOV EAX,dword ptr [ESI + 0x20]
005af13f : MOV EDI,dword ptr [ESI + 0x1c]
005af142 : MOV EDX,dword ptr [ESI]
005af144 : MOV EDX,dword ptr [EDX + 0x4]
005af147 : PUSH EAX
005af148 : PUSH EDI
005af149 : MOV ECX,ESI
005af14b : CALL EDX
005af14d : MOV EAX,dword ptr [ESI + 0xc]
005af150 : MOV ESI,dword ptr [ESI + 0x20]
005af153 : DEC ESI
005af154 : CMP ESI,EAX
005af156 : JNC 0x005af15a
005af158 : MOV EAX,ESI
005af15a : MOV byte ptr [EAX + EDI*0x1],0x0
005af15e : POP EDI
005af15f : POP ESI
005af160 : POP EBP
005af161 : POP EBX
005af162 : ADD ESP,0xc
005af165 : RET
005af166 : MOV EBP,dword ptr [ESI + 0x1c]
005af169 : MOV EAX,dword ptr [EBP + 0x4]
005af16c : ADD EAX,dword ptr [ESI + 0xc]
005af16f : MOV EDI,dword ptr [ESI + 0x24]
005af172 : PUSH EAX
005af173 : MOV ECX,EBP
005af175 : MOV dword ptr [ESP + 0x14],EDI
005af179 : CALL 0x0051b400
005af17e : XOR EBX,EBX
005af180 : TEST EDI,EDI
005af182 : JBE 0x005af214
005af188 : XOR EDI,EDI
005af18a : LEA EBX,[EBX]
005af190 : CMP EBX,0x10
005af193 : JNC 0x005af19b
005af195 : LEA ECX,[EDI + ESI*0x1 + 0x34]
005af199 : JMP 0x005af1a5
005af19b : MOV ECX,dword ptr [ESI + 0x28]
005af19e : LEA ECX,[ECX + EDI*0x1 + 0xffffff40]
005af1a5 : CMP EBX,0x10
005af1a8 : JNC 0x005af1b0
005af1aa : LEA EAX,[EDI + ESI*0x1 + 0x34]
005af1ae : JMP 0x005af1ba
005af1b0 : MOV EDX,dword ptr [ESI + 0x28]
005af1b3 : LEA EAX,[EDX + EDI*0x1 + 0xffffff40]
005af1ba : MOV EAX,dword ptr [EAX]
005af1bc : SUB EAX,0x0
005af1bf : JZ 0x005af1e5
005af1c1 : SUB EAX,0x2
005af1c4 : JNZ 0x005af1f5
005af1c6 : MOV ECX,dword ptr [ECX + 0x4]
005af1c9 : TEST ECX,ECX
005af1cb : JZ 0x005af1f5
005af1cd : MOV EAX,dword ptr [ECX]
005af1cf : MOV EAX,dword ptr [EAX + 0x10]
005af1d2 : LEA EDX,[ESP + 0x14]
005af1d6 : PUSH EDX
005af1d7 : CALL EAX
005af1d9 : MOV ECX,dword ptr [ESP + 0x18]
005af1dd : MOV EDX,dword ptr [ESP + 0x14]
005af1e1 : PUSH ECX
005af1e2 : PUSH EDX
005af1e3 : JMP 0x005af1ee
005af1e5 : MOVZX EAX,byte ptr [ECX + 0x8]
005af1e9 : MOV ECX,dword ptr [ECX + 0x4]
005af1ec : PUSH EAX
005af1ed : PUSH ECX
005af1ee : MOV ECX,EBP
005af1f0 : CALL 0x0051b5d0
005af1f5 : INC EBX
005af1f6 : ADD EDI,0xc
005af1f9 : CMP EBX,dword ptr [ESP + 0x10]
005af1fd : JC 0x005af190
005af1ff : POP EDI
005af200 : POP ESI
005af201 : POP EBP
005af202 : POP EBX
005af203 : ADD ESP,0xc
005af206 : RET
005af207 : MOV EDX,dword ptr [ESI + 0xc]
005af20a : MOV ECX,dword ptr [ESI + 0x1c]
005af20d : PUSH EDX
005af20e : PUSH ESI
005af20f : CALL 0x0051ba00
005af214 : POP EDI
005af215 : POP ESI
005af216 : POP EBP
005af217 : POP EBX
005af218 : ADD ESP,0xc
005af21b : RET

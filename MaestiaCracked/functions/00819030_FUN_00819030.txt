PROGRAM  : Maestia.exe
FUNCTION : FUN_00819030
ENTRY    : 00819030
BODY     : [[00819030, 008194dc]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_00819030(void)

{
  short sVar1;
  bool bVar2;
  char cVar3;
  int iVar4;
  short *psVar5;
  int *in_ECX;
  int iVar6;
  int local_2270;
  wchar_t local_2250 [258];
  uint local_204c;
  undefined4 local_203c;
  uint local_2038;
  undefined1 local_2034 [4];
  uint local_2030;
  undefined4 local_2020;
  uint local_201c;
  short local_2018 [4096];
  uint local_18;
  undefined4 uStack_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  puStack_c = &LAB_00b48a3c;
  local_10 = ExceptionList;
  uStack_14 = 0x81904b;
  local_18 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar6 = 0;
  local_201c = 7;
  local_2020 = 0;
  local_2030 = local_2030 & 0xffff0000;
  local_2038 = 7;
  local_203c = 0;
  local_204c = local_204c & 0xffff0000;
  local_8._0_1_ = 1;
  local_8._1_3_ = 0;
  do {
    bVar2 = false;
LAB_008190b0:
    if (((uint)in_ECX[8] <= (uint)in_ECX[9]) ||
       (cVar3 = (**(code **)(*in_ECX + 0x1c))(), cVar3 == '\0')) {
LAB_0081935e:
      local_8 = (uint)local_8._1_3_ << 8;
      if (7 < local_2038) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_2038 = 7;
      local_203c = 0;
      local_204c = local_204c & 0xffff0000;
      local_8 = 0xffffffff;
      if (7 < local_201c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
LAB_008193ce:
      local_2030 = local_2030 & 0xffff0000;
      local_8 = 0xffffffff;
      local_201c = 7;
      local_2020 = 0;
      local_2038 = 7;
      local_203c = 0;
      ExceptionList = local_10;
      __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
      return;
    }
    iVar6 = iVar6 + 1;
    if (1000000 < iVar6) {
      FUN_008018d0();
      goto LAB_0081935e;
    }
    if (local_2270 == 0x1001) {
      FUN_0070d320();
      psVar5 = local_2018;
      do {
        sVar1 = *psVar5;
        psVar5 = psVar5 + 1;
      } while (sVar1 != 0);
      FUN_00406360();
      bVar2 = true;
      goto LAB_008190b0;
    }
    if (local_2270 != 0x1002) {
      if (local_2270 == 0x1003) {
        if (bVar2) {
          _wcscpy_s(local_2250,0x100,L"");
          local_8._0_1_ = 7;
          FUN_0041f590();
          FUN_008018d0();
        }
        local_8 = (uint)local_8._1_3_ << 8;
        if (7 < local_2038) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_2038 = 7;
        local_203c = 0;
        local_204c = local_204c & 0xffff0000;
        local_8 = 0xffffffff;
        if (7 < local_201c) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        goto LAB_008193ce;
      }
      (**(code **)(*in_ECX + 0x24))();
      goto LAB_008190b0;
    }
    if (!bVar2) {
      _wcscpy_s(local_2250,0x100,L"");
      local_8._0_1_ = 2;
      FUN_0041f590();
      FUN_008018d0();
      local_8._0_1_ = 1;
    }
    iVar4 = FUN_006f0760();
    local_8._0_1_ = 3;
    if (iVar4 == 0) {
      local_8 = CONCAT31(local_8._1_3_,1);
      iVar4 = 0;
    }
    else {
      FUN_004540e0();
      local_8 = CONCAT31(local_8._1_3_,1);
      iVar4 = 0;
    }
    do {
      FUN_0070d080();
      psVar5 = local_2018;
      do {
        sVar1 = *psVar5;
        psVar5 = psVar5 + 1;
      } while (sVar1 != 0);
      FUN_00406360();
      if (*(int *)(DAT_017248cc + 0x90) == iVar4) {
        FUN_00453bb0();
      }
      iVar4 = iVar4 + 1;
    } while (iVar4 < 0xc);
    FUN_00405eb0(local_2034,0,0xffffffff);
    local_8._1_3_ = (uint3)((uint)local_8 >> 8);
    local_8._0_1_ = 1;
    FUN_00438060();
    local_8._0_1_ = 5;
    FUN_00452dc0();
    local_8._0_1_ = 6;
    FUN_0042f990();
    local_8._0_1_ = 5;
    FUN_0044cb00();
    local_8._0_1_ = 1;
    FUN_0044cb00();
    FUN_00406360();
    FUN_00406360();
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
00819030 : PUSH EBP
00819031 : MOV EBP,ESP
00819033 : PUSH -0x1
00819035 : PUSH 0xb48a3c
0081903a : MOV EAX,FS:[0x0]
00819040 : PUSH EAX
00819041 : MOV EAX,0x22a8
00819046 : CALL 0x0063b780
0081904b : MOV EAX,[0x00d66fa0]
00819050 : XOR EAX,EBP
00819052 : MOV dword ptr [EBP + -0x14],EAX
00819055 : PUSH EBX
00819056 : PUSH ESI
00819057 : PUSH EDI
00819058 : PUSH EAX
00819059 : LEA EAX,[EBP + -0xc]
0081905c : MOV FS:[0x0],EAX
00819062 : MOV EAX,dword ptr [EBP + 0x8]
00819065 : MOV EDI,ECX
00819067 : MOV dword ptr [EBP + 0xffffdda0],EAX
0081906d : MOV EAX,0x7
00819072 : XOR ESI,ESI
00819074 : XOR ECX,ECX
00819076 : MOV dword ptr [EBP + 0xffffdda4],EDI
0081907c : MOV dword ptr [EBP + 0xffffdfe8],EAX
00819082 : MOV dword ptr [EBP + 0xffffdfe4],ESI
00819088 : MOV word ptr [EBP + 0xffffdfd4],CX
0081908f : MOV dword ptr [EBP + -0x4],ESI
00819092 : XOR EDX,EDX
00819094 : MOV dword ptr [EBP + 0xffffdfcc],EAX
0081909a : MOV dword ptr [EBP + 0xffffdfc8],ESI
008190a0 : MOV word ptr [EBP + 0xffffdfb8],DX
008190a7 : MOV byte ptr [EBP + -0x4],0x1
008190ab : XOR BL,BL
008190ad : LEA ECX,[ECX]
008190b0 : MOV EAX,dword ptr [EDI + 0x24]
008190b3 : CMP EAX,dword ptr [EDI + 0x20]
008190b6 : JNC 0x0081935e
008190bc : MOV EDX,dword ptr [EDI]
008190be : MOV EDX,dword ptr [EDX + 0x1c]
008190c1 : LEA EAX,[EBP + 0xffffdd94]
008190c7 : PUSH EAX
008190c8 : MOV ECX,EDI
008190ca : CALL EDX
008190cc : TEST AL,AL
008190ce : JZ 0x0081935e
008190d4 : INC ESI
008190d5 : CMP ESI,0xf4240
008190db : MOV dword ptr [EBP + 0xffffdd9c],ESI
008190e1 : JG 0x0081934b
008190e7 : MOV EAX,dword ptr [EBP + 0xffffdd94]
008190ed : SUB EAX,0x1001
008190f2 : JZ 0x0081930b
008190f8 : SUB EAX,0x1
008190fb : JZ 0x00819118
008190fd : SUB EAX,0x1
00819100 : JZ 0x008193ec
00819106 : MOV ECX,dword ptr [EBP + 0xffffdd98]
0081910c : MOV EAX,dword ptr [EDI]
0081910e : MOV EDX,dword ptr [EAX + 0x24]
00819111 : PUSH ECX
00819112 : MOV ECX,EDI
00819114 : CALL EDX
00819116 : JMP 0x008190b0
00819118 : TEST BL,BL
0081911a : JNZ 0x00819193
0081911c : PUSH 0xcca49c
00819121 : LEA EAX,[EBP + 0xffffddb4]
00819127 : PUSH 0x100
0081912c : MOV EBX,0xcd083c
00819131 : PUSH EAX
00819132 : MOV dword ptr [EBP + 0xffffddac],EBX
00819138 : MOV dword ptr [EBP + 0xffffddb0],0xff
00819142 : CALL 0x0063481b
00819147 : ADD ESP,0xc
0081914a : MOV byte ptr [EBP + -0x4],0x2
0081914e : CMP dword ptr [EBP + 0xffffdfcc],0x8
00819155 : MOV EAX,dword ptr [EBP + 0xffffdfb8]
0081915b : JNC 0x00819163
0081915d : LEA EAX,[EBP + 0xffffdfb8]
00819163 : PUSH EAX
00819164 : PUSH 0xc2e5c8
00819169 : LEA ECX,[EBP + 0xffffddac]
0081916f : CALL 0x0041f590
00819174 : MOV ESI,dword ptr [0x00da98e8]
0081917a : LEA ECX,[EBP + 0xffffddb4]
00819180 : PUSH ECX
00819181 : CALL 0x008018d0
00819186 : ADD ESP,0xc
00819189 : MOV byte ptr [EBP + -0x4],0x1
0081918d : MOV dword ptr [EBP + 0xffffddac],EBX
00819193 : MOV EDX,dword ptr [0x01725270]
00819199 : SHR EDX,0x3
0081919c : MOV EAX,0x0
008191a1 : AND EDX,0x1
008191a4 : SETZ AL
008191a7 : PUSH EAX
008191a8 : PUSH 0x0
008191aa : PUSH 0xbf1a4a
008191af : PUSH 0x10
008191b1 : CALL 0x006f0760
008191b6 : ADD ESP,0x10
008191b9 : MOV dword ptr [EBP + 0xffffdda8],EAX
008191bf : MOV byte ptr [EBP + -0x4],0x3
008191c3 : TEST EAX,EAX
008191c5 : JZ 0x008191d7
008191c7 : PUSH EAX
008191c8 : CALL 0x004540e0
008191cd : MOV EBX,EAX
008191cf : MOV byte ptr [EBP + -0x4],0x1
008191d3 : XOR ESI,ESI
008191d5 : JMP 0x008191e7
008191d7 : XOR EBX,EBX
008191d9 : MOV byte ptr [EBP + -0x4],0x1
008191dd : XOR ESI,ESI
008191df : JMP 0x008191e7
008191e1 : MOV EDI,dword ptr [EBP + 0xffffdda4]
008191e7 : LEA ECX,[EBP + 0xffffdfec]
008191ed : PUSH ECX
008191ee : CALL 0x0070d080
008191f3 : LEA EAX,[EBP + 0xffffdfec]
008191f9 : LEA EDX,[EAX + 0x2]
008191fc : LEA ESP,[ESP]
00819200 : MOV CX,word ptr [EAX]
00819203 : ADD EAX,0x2
00819206 : TEST CX,CX
00819209 : JNZ 0x00819200
0081920b : SUB EAX,EDX
0081920d : SAR EAX,0x1
0081920f : PUSH EAX
00819210 : LEA EDX,[EBP + 0xffffdfec]
00819216 : PUSH EDX
00819217 : LEA ECX,[EBP + 0xffffdfb4]
0081921d : CALL 0x00406360
00819222 : MOV EAX,[0x017248cc]
00819227 : CMP dword ptr [EAX + 0x90],ESI
0081922d : JNZ 0x0081923c
0081922f : LEA ECX,[EBP + 0xffffdfb4]
00819235 : PUSH ECX
00819236 : PUSH EBX
00819237 : CALL 0x00453bb0
0081923c : INC ESI
0081923d : CMP ESI,0xc
00819240 : JL 0x008191e1
00819242 : PUSH EBX
00819243 : SUB ESP,0x1c
00819246 : MOV ECX,ESP
00819248 : MOV dword ptr [EBP + 0xffffdda8],ESP
0081924e : XOR EDX,EDX
00819250 : PUSH -0x1
00819252 : PUSH EDX
00819253 : LEA EAX,[EBP + 0xffffdfd0]
00819259 : MOV dword ptr [ECX + 0x18],0x7
00819260 : MOV dword ptr [ECX + 0x14],0x0
00819267 : PUSH EAX
00819268 : MOV word ptr [ECX + 0x4],DX
0081926c : CALL 0x00405eb0
00819271 : MOV byte ptr [EBP + -0x4],0x4
00819275 : MOV byte ptr [EBP + -0x4],0x1
00819279 : LEA ESI,[EBP + 0xffffdd4c]
0081927f : CALL 0x00438060
00819284 : ADD ESP,0x20
00819287 : MOV byte ptr [EBP + -0x4],0x5
0081928b : LEA ECX,[EBP + 0xffffdd6c]
00819291 : PUSH ECX
00819292 : MOV EDI,EAX
00819294 : CALL 0x00452dc0
00819299 : MOV byte ptr [EBP + -0x4],0x6
0081929d : MOV ECX,dword ptr [EBP + 0xffffdda0]
008192a3 : LEA EDX,[EBP + 0xffffdd6c]
008192a9 : PUSH EDX
008192aa : LEA EAX,[EBP + 0xffffdd8c]
008192b0 : PUSH EAX
008192b1 : ADD ECX,0x18
008192b4 : PUSH ECX
008192b5 : CALL 0x0042f990
008192ba : MOV byte ptr [EBP + -0x4],0x5
008192be : LEA EDX,[EBP + 0xffffdd6c]
008192c4 : PUSH EDX
008192c5 : CALL 0x0044cb00
008192ca : MOV byte ptr [EBP + -0x4],0x1
008192ce : MOV EAX,ESI
008192d0 : PUSH EAX
008192d1 : CALL 0x0044cb00
008192d6 : PUSH 0x0
008192d8 : PUSH 0xc2e6a8
008192dd : LEA ECX,[EBP + 0xffffdfd0]
008192e3 : CALL 0x00406360
008192e8 : PUSH 0x0
008192ea : PUSH 0xc2e6ac
008192ef : LEA ECX,[EBP + 0xffffdfb4]
008192f5 : CALL 0x00406360
008192fa : MOV EDI,dword ptr [EBP + 0xffffdda4]
00819300 : MOV ESI,dword ptr [EBP + 0xffffdd9c]
00819306 : JMP 0x008190ab
0081930b : LEA ECX,[EBP + 0xffffdfec]
00819311 : PUSH ECX
00819312 : MOV ECX,EDI
00819314 : CALL 0x0070d320
00819319 : LEA EAX,[EBP + 0xffffdfec]
0081931f : LEA EDX,[EAX + 0x2]
00819322 : MOV CX,word ptr [EAX]
00819325 : ADD EAX,0x2
00819328 : TEST CX,CX
0081932b : JNZ 0x00819322
0081932d : SUB EAX,EDX
0081932f : SAR EAX,0x1
00819331 : PUSH EAX
00819332 : LEA EDX,[EBP + 0xffffdfec]
00819338 : PUSH EDX
00819339 : LEA ECX,[EBP + 0xffffdfd0]
0081933f : CALL 0x00406360
00819344 : MOV BL,0x1
00819346 : JMP 0x008190b0
0081934b : MOV ESI,dword ptr [0x00da98e8]
00819351 : PUSH 0xc2e528
00819356 : CALL 0x008018d0
0081935b : ADD ESP,0x4
0081935e : MOV byte ptr [EBP + -0x4],0x0
00819362 : MOV EDI,0x8
00819367 : CMP dword ptr [EBP + 0xffffdfcc],EDI
0081936d : JC 0x0081937a
0081936f : MOV ECX,dword ptr [EBP + 0xffffdfb8]
00819375 : CALL 0x006f04e0
0081937a : XOR ECX,ECX
0081937c : MOV dword ptr [EBP + 0xffffdfcc],0x7
00819386 : MOV dword ptr [EBP + 0xffffdfc8],0x0
00819390 : MOV word ptr [EBP + 0xffffdfb8],CX
00819397 : MOV dword ptr [EBP + -0x4],0xffffffff
0081939e : CMP dword ptr [EBP + 0xffffdfe8],EDI
008193a4 : JC 0x008193b1
008193a6 : MOV ECX,dword ptr [EBP + 0xffffdfd4]
008193ac : CALL 0x006f04e0
008193b1 : XOR EDX,EDX
008193b3 : MOV dword ptr [EBP + 0xffffdfe8],0x7
008193bd : MOV dword ptr [EBP + 0xffffdfe4],0x0
008193c7 : MOV word ptr [EBP + 0xffffdfd4],DX
008193ce : MOV ECX,dword ptr [EBP + -0xc]
008193d1 : MOV dword ptr FS:[0x0],ECX
008193d8 : POP ECX
008193d9 : POP EDI
008193da : POP ESI
008193db : POP EBX
008193dc : MOV ECX,dword ptr [EBP + -0x14]
008193df : XOR ECX,EBP
008193e1 : CALL 0x00633e6b
008193e6 : MOV ESP,EBP
008193e8 : POP EBP
008193e9 : RET 0x4
008193ec : TEST BL,BL
008193ee : JZ 0x00819471
008193f4 : PUSH 0xcca49c
008193f9 : LEA EAX,[EBP + 0xffffddb4]
008193ff : PUSH 0x100
00819404 : MOV EDI,0xcd083c
00819409 : PUSH EAX
0081940a : MOV dword ptr [EBP + 0xffffddac],EDI
00819410 : MOV dword ptr [EBP + 0xffffddb0],0xff
0081941a : CALL 0x0063481b
0081941f : ADD ESP,0xc
00819422 : MOV byte ptr [EBP + -0x4],0x7
00819426 : MOV EAX,dword ptr [EBP + 0xffffdfd4]
0081942c : MOV EBX,0x8
00819431 : CMP dword ptr [EBP + 0xffffdfe8],EBX
00819437 : JNC 0x0081943f
00819439 : LEA EAX,[EBP + 0xffffdfd4]
0081943f : PUSH EAX
00819440 : PUSH 0xc2e6b0
00819445 : LEA ECX,[EBP + 0xffffddac]
0081944b : CALL 0x0041f590
00819450 : MOV ESI,dword ptr [0x00da98e8]
00819456 : LEA ECX,[EBP + 0xffffddb4]
0081945c : PUSH ECX
0081945d : CALL 0x008018d0
00819462 : ADD ESP,0xc
00819465 : MOV byte ptr [EBP + -0x4],0x1
00819469 : MOV dword ptr [EBP + 0xffffddac],EDI
0081946f : JMP 0x00819476
00819471 : MOV EBX,0x8
00819476 : MOV byte ptr [EBP + -0x4],0x0
0081947a : CMP dword ptr [EBP + 0xffffdfcc],EBX
00819480 : JC 0x0081948d
00819482 : MOV ECX,dword ptr [EBP + 0xffffdfb8]
00819488 : CALL 0x006f04e0
0081948d : MOV ESI,0x7
00819492 : XOR EDI,EDI
00819494 : XOR EDX,EDX
00819496 : MOV dword ptr [EBP + 0xffffdfcc],ESI
0081949c : MOV dword ptr [EBP + 0xffffdfc8],EDI
008194a2 : MOV word ptr [EBP + 0xffffdfb8],DX
008194a9 : MOV dword ptr [EBP + -0x4],0xffffffff
008194b0 : CMP dword ptr [EBP + 0xffffdfe8],EBX
008194b6 : JC 0x008194c3
008194b8 : MOV ECX,dword ptr [EBP + 0xffffdfd4]
008194be : CALL 0x006f04e0
008194c3 : XOR EAX,EAX
008194c5 : MOV dword ptr [EBP + 0xffffdfe8],ESI
008194cb : MOV dword ptr [EBP + 0xffffdfe4],EDI
008194d1 : MOV word ptr [EBP + 0xffffdfd4],AX
008194d8 : JMP 0x008193ce

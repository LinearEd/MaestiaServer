PROGRAM  : Maestia.exe
FUNCTION : FUN_00405040
ENTRY    : 00405040
BODY     : [[00405040, 004050ac] [004050b0, 00405100]]

============================================================
DECOMPILED C CODE
============================================================

bool FUN_00405040(uint param_1,char param_2)

{
  uint uVar1;
  int in_ECX;
  uint _MaxCount;
  
  if (param_1 == 0xffffffff) {
    FUN_00622ecf();
  }
  uVar1 = *(uint *)(in_ECX + 0x18);
  if (uVar1 < param_1) {
    FUN_00404ef0(param_1,*(undefined4 *)(in_ECX + 0x14));
    return param_1 != 0;
  }
  if ((param_2 == '\0') || (0xf < param_1)) {
    if (param_1 == 0) {
      *(undefined4 *)(in_ECX + 0x14) = 0;
      if (0xf < uVar1) {
        **(undefined1 **)(in_ECX + 4) = 0;
        return false;
      }
      *(undefined1 *)(in_ECX + 4) = 0;
    }
    return param_1 != 0;
  }
  _MaxCount = *(uint *)(in_ECX + 0x14);
  if (param_1 < *(uint *)(in_ECX + 0x14)) {
    _MaxCount = param_1;
  }
  if (0xf < uVar1) {
    if (_MaxCount != 0) {
      _memcpy_s((void *)(in_ECX + 4),0x10,*(void **)(in_ECX + 4),_MaxCount);
    }
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  *(uint *)(in_ECX + 0x14) = _MaxCount;
  *(undefined4 *)(in_ECX + 0x18) = 0xf;
  *(undefined1 *)(in_ECX + 4 + _MaxCount) = 0;
  return param_1 != 0;
}



============================================================
DISASSEMBLY
============================================================
00405040 : PUSH EBP
00405041 : MOV EBP,ESP
00405043 : PUSH EBX
00405044 : MOV EBX,dword ptr [EBP + 0x8]
00405047 : PUSH ESI
00405048 : MOV ESI,ECX
0040504a : CMP EBX,-0x2
0040504d : JBE 0x00405054
0040504f : CALL 0x00622ecf
00405054 : MOV EAX,dword ptr [ESI + 0x18]
00405057 : CMP EAX,EBX
00405059 : JNC 0x00405075
0040505b : MOV EAX,dword ptr [ESI + 0x14]
0040505e : PUSH EAX
0040505f : PUSH EBX
00405060 : MOV ECX,ESI
00405062 : CALL 0x00404ef0
00405067 : XOR ECX,ECX
00405069 : CMP ECX,EBX
0040506b : SBB EAX,EAX
0040506d : POP ESI
0040506e : NEG EAX
00405070 : POP EBX
00405071 : POP EBP
00405072 : RET 0x8
00405075 : CMP byte ptr [EBP + 0xc],0x0
00405079 : JZ 0x004050ce
0040507b : CMP EBX,0x10
0040507e : JNC 0x004050ce
00405080 : PUSH EDI
00405081 : MOV EDI,dword ptr [ESI + 0x14]
00405084 : CMP EBX,EDI
00405086 : JNC 0x0040508a
00405088 : MOV EDI,EBX
0040508a : CMP EAX,0x10
0040508d : JC 0x004050b0
0040508f : MOV EBX,dword ptr [ESI + 0x4]
00405092 : LEA EAX,[ESI + 0x4]
00405095 : TEST EDI,EDI
00405097 : JBE 0x004050a6
00405099 : PUSH EDI
0040509a : PUSH EBX
0040509b : PUSH 0x10
0040509d : PUSH EAX
0040509e : CALL 0x00633ea4
004050a3 : ADD ESP,0x10
004050a6 : MOV ECX,EBX
004050a8 : CALL 0x006f04e0
004050b0 : MOV dword ptr [ESI + 0x14],EDI
004050b3 : MOV dword ptr [ESI + 0x18],0xf
004050ba : XOR ECX,ECX
004050bc : MOV byte ptr [ESI + EDI*0x1 + 0x4],0x0
004050c1 : CMP ECX,EBX
004050c3 : POP EDI
004050c4 : SBB EAX,EAX
004050c6 : POP ESI
004050c7 : NEG EAX
004050c9 : POP EBX
004050ca : POP EBP
004050cb : RET 0x8
004050ce : TEST EBX,EBX
004050d0 : JNZ 0x004050f3
004050d2 : MOV dword ptr [ESI + 0x14],EBX
004050d5 : CMP EAX,0x10
004050d8 : JC 0x004050ed
004050da : MOV ESI,dword ptr [ESI + 0x4]
004050dd : XOR ECX,ECX
004050df : CMP ECX,EBX
004050e1 : MOV byte ptr [ESI],BL
004050e3 : SBB EAX,EAX
004050e5 : POP ESI
004050e6 : NEG EAX
004050e8 : POP EBX
004050e9 : POP EBP
004050ea : RET 0x8
004050ed : ADD ESI,0x4
004050f0 : MOV byte ptr [ESI],0x0
004050f3 : XOR ECX,ECX
004050f5 : CMP ECX,EBX
004050f7 : SBB EAX,EAX
004050f9 : POP ESI
004050fa : NEG EAX
004050fc : POP EBX
004050fd : POP EBP
004050fe : RET 0x8

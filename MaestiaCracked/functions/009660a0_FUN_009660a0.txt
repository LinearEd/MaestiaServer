PROGRAM  : Maestia.exe
FUNCTION : FUN_009660a0
ENTRY    : 009660a0
BODY     : [[009660a0, 009668d3]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009660a0(int *param_1,uint param_2,uint param_3)

{
  ushort uVar1;
  int *piVar2;
  char cVar3;
  SHORT SVar4;
  uint uVar5;
  int *piVar6;
  uint8_t *puVar7;
  int iVar8;
  undefined4 uVar9;
  int iVar10;
  byte bVar11;
  undefined8 uVar12;
  int *piStack_10c;
  int *local_108;
  int iStack_104;
  uint8_t *puStack_100;
  undefined1 auStack_fc [28];
  undefined1 auStack_e0 [28];
  undefined1 auStack_c4 [28];
  undefined1 auStack_a8 [112];
  undefined1 auStack_38 [28];
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_00b60780;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)&piStack_10c;
  uVar5 = DAT_00d66fa0 ^ (uint)&stack0xfffffee8;
  ExceptionList = &local_14;
  local_108 = param_1;
  *(uint *)(param_1[0xf] + 0x14) =
       *(int *)(param_1[0xf] + 0xc) * (param_3 & 0xffff) + (param_2 & 0xffff);
  if (((*(int *)(param_1[0xf] + 8) + -1 < (int)(param_3 & 0xffff)) ||
      (*(int *)(param_1[0xf] + 0xc) + -1 < (int)(param_2 & 0xffff))) ||
     (piVar6 = (int *)(**(code **)(*param_1 + 0x74))(param_2,param_3,uVar5), piStack_10c = piVar6,
     piVar6 == (int *)0x0)) goto LAB_009668ae;
  SVar4 = GetKeyState(0x11);
  if (SVar4 < 0) {
    iVar8 = *(int *)ThreadLocalStoragePointer;
    bVar11 = (byte)((ulonglong)(*(byte *)(iVar8 + 0x18) + 1) % 3);
    *(byte *)(iVar8 + 0x18) = bVar11;
    puStack_100 = (uint8_t *)((uint)bVar11 * 0x2000 + 0x122cb8 + iVar8);
    if (puStack_100 == (uint8_t *)0x0) {
      puVar7 = (uint8_t *)0x0;
    }
    else {
      iVar8 = piVar6[4];
      puStack_100[0] = '\0';
      puStack_100[1] = '\0';
      puStack_100[2] = '7';
      puStack_100[3] = ')';
      *(int *)(puStack_100 + 4) = iVar8;
      puStack_100[8] = '\x01';
      puStack_100[9] = '\0';
      puVar7 = puStack_100;
    }
    uStack_c = 0xffffffff;
    if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
      FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),10,puVar7);
    }
    goto LAB_009668ae;
  }
  piVar6 = (int *)FUN_004049b0(piVar6[4]);
  if ((piVar6 == (int *)0x0) ||
     (((iVar8 = (**(code **)(*piVar6 + 0x3c))(), iVar8 == 0 && ((char)piVar6[1] != -0x74)) &&
      (((char)piVar6[1] != 'q' && ((short)piVar6[0x29] != 1)))))) {
    piVar6 = local_108;
    if (local_108[0x17] != 0) {
      iVar10 = (**(code **)(*piStack_10c + 0x20))();
      iVar8 = piVar6[0x17];
      if (iVar10 == 0) {
        FUN_009636b0(iVar8,0x20,param_2,param_3,1);
      }
      else {
        iVar10 = *(int *)(iVar8 + 0x78);
        *(undefined2 *)(iVar10 + 0x54) = *(undefined2 *)(iVar8 + 0x76);
        *(int *)(iVar10 + 0x50) = iVar8;
        *(undefined1 *)(iVar10 + 0x56) = 0;
        iVar10 = *(int *)(iVar8 + 0x78);
        *(undefined2 *)(iVar10 + 0x3a) = 200;
        *(undefined2 *)(iVar10 + 0x38) = 1;
        FUN_009621f0(iVar8,param_2);
        *(undefined1 *)(*(int *)(iVar8 + 0x78) + 0x4e) = 1;
        FUN_009ac1d0();
        (**(code **)(**(int **)(iVar8 + 0x78) + 0x50))(0x20,param_2,param_3,0,0,0);
      }
      goto LAB_009668ae;
    }
    FUN_00406460(L"Null parent!!");
    uStack_c = 0x16;
    if ((int *)*DAT_00da98e8 != (int *)0x0) {
      (**(code **)(*(int *)*DAT_00da98e8 + 0x14))(L"AvaGuiNpcShopGrid::BuyItem",0x1e3,auStack_fc);
    }
  }
  else {
    FUN_00406460(&DAT_00c79ec8);
    piVar2 = piStack_10c;
    uStack_c = 1;
    iStack_104 = 0;
    puStack_100 = (uint8_t *)0x0;
    if ((char)piVar6[1] == 'q') {
      cVar3 = FUN_00962f30();
      if (cVar3 == '\x01') {
        FUN_00406460(L"IDS_NPCSHOP_MSG_LEANRED_SKILL_BUY");
        uStack_c._0_1_ = 2;
        iVar8 = FUN_0081d120(auStack_fc);
        uStack_c._0_1_ = 3;
        if (*(uint *)(iVar8 + 0x18) < 8) {
          iVar8 = iVar8 + 4;
        }
        else {
          iVar8 = *(int *)(iVar8 + 4);
        }
        FUN_00404750(iVar8);
        uStack_c._0_1_ = 4;
        uVar9 = FUN_00403510(auStack_c4);
        uStack_c._0_1_ = 5;
        FUN_00405eb0(uVar9,0,0xffffffff);
        uStack_c._0_1_ = 4;
        FUN_00406560();
        uStack_c._0_1_ = 3;
        FUN_00406560();
        uStack_c._0_1_ = 2;
      }
      else {
        cVar3 = FUN_00962040(piVar2);
        if (cVar3 != '\x01') goto LAB_009663ef;
        FUN_00406460(L"IDS_NPCSHOP_INVEN_HAVE_SKILL_BUY");
        uStack_c._0_1_ = 6;
        iVar8 = FUN_0081d120(auStack_fc);
        uStack_c._0_1_ = 7;
        if (*(uint *)(iVar8 + 0x18) < 8) {
          iVar8 = iVar8 + 4;
        }
        else {
          iVar8 = *(int *)(iVar8 + 4);
        }
        FUN_00404750(iVar8);
        uStack_c._0_1_ = 8;
        uVar9 = FUN_00403510(auStack_e0);
        uStack_c._0_1_ = 9;
        FUN_00405eb0(uVar9,0,0xffffffff);
        uStack_c._0_1_ = 8;
        FUN_00406560();
        uStack_c._0_1_ = 7;
        FUN_00406560();
        uStack_c._0_1_ = 6;
      }
      FUN_00406560();
      uStack_c = CONCAT31(uStack_c._1_3_,1);
      FUN_00406560();
    }
LAB_009663ef:
    iVar8 = iStack_104;
    if ((local_108[0x17] != 0) &&
       (iVar10 = FUN_004049b0(*(undefined4 *)(local_108[0x17] + 0x70)), iVar8 = iStack_104,
       iVar10 != 0)) {
      iVar8 = FUN_00962140(piStack_10c[4]);
      cVar3 = *(char *)(iVar10 + 0x40);
      if (((cVar3 != '\x03') && ((cVar3 != '\x04' && (cVar3 != '\x06')))) || (iVar8 == 0)) {
        uVar1 = *(ushort *)(iVar10 + 0x46);
        uVar12 = __allmul(piVar6[0x15],0,uVar1,0);
        iVar8 = __alldiv(uVar12,10000,0);
        if (10000 < uVar1) {
          puStack_100 = (uint8_t *)
                        (int)ABS((1.0 - (float)*(ushort *)(iVar10 + 0x46) * 0.0001) * 100.0);
        }
      }
    }
    iStack_104 = iVar8;
    FUN_00406460(L"IDS_SHOP_BUYITEM_INFO_CHECKMSG");
    uStack_c._0_1_ = 10;
    iVar8 = FUN_00824a20(DAT_0172491c,0);
    uStack_c._0_1_ = 0xb;
    iVar10 = FUN_0081d120(auStack_fc);
    uStack_c._0_1_ = 0xc;
    if (*(uint *)(iVar8 + 0x18) < 8) {
      iVar8 = iVar8 + 4;
    }
    else {
      iVar8 = *(int *)(iVar8 + 4);
    }
    if (*(uint *)(iVar10 + 0x18) < 8) {
      iVar10 = iVar10 + 4;
    }
    else {
      iVar10 = *(int *)(iVar10 + 4);
    }
    uVar9 = FUN_00404750(iVar10,iVar8);
    uStack_c._0_1_ = 0xd;
    FUN_00405c30(uVar9,0,0xffffffff);
    uStack_c._0_1_ = 0xc;
    FUN_00406560();
    uStack_c._0_1_ = 0xb;
    FUN_00406560();
    uStack_c._0_1_ = 10;
    FUN_00406560();
    uStack_c._0_1_ = 1;
    FUN_00406560();
    if ((local_108[0x17] == 0) || (*(char *)(local_108[0x17] + 0x8c) != '\0')) {
      iVar8 = FUN_0081cbe0(DAT_0172491c);
      uStack_c._0_1_ = 0x13;
      iVar10 = FUN_0070c2d0(piStack_10c[0x2f],0);
      uStack_c._0_1_ = 0x14;
      if (*(uint *)(iVar8 + 0x18) < 8) {
        iVar8 = iVar8 + 4;
      }
      else {
        iVar8 = *(int *)(iVar8 + 4);
      }
      if (*(uint *)(iVar10 + 0x18) < 8) {
        iVar10 = iVar10 + 4;
      }
      else {
        iVar10 = *(int *)(iVar10 + 4);
      }
      uVar9 = FUN_00404750(L" %s %s",iVar10,iVar8);
      uStack_c._0_1_ = 0x15;
      FUN_00405c30(uVar9,0,0xffffffff);
      uStack_c._0_1_ = 0x14;
      FUN_00406560();
      uStack_c._0_1_ = 0x13;
      FUN_00406560();
LAB_0096676c:
      uStack_c._0_1_ = 1;
      FUN_00406560();
    }
    else {
      uVar9 = FUN_0070c2d0(iStack_104,0);
      uStack_c._0_1_ = 0xe;
      FUN_00405c30(uVar9,0,0xffffffff);
      uStack_c._0_1_ = 1;
      FUN_00406560();
      puVar7 = puStack_100;
      if (0 < (int)puStack_100) {
        FUN_00406460(L"IDS_APPLY_BUY_TAX");
        uStack_c._0_1_ = 0xf;
        iVar8 = FUN_0081d120(auStack_fc);
        uStack_c._0_1_ = 0x10;
        if (*(uint *)(iVar8 + 0x18) < 8) {
          iVar8 = iVar8 + 4;
        }
        else {
          iVar8 = *(int *)(iVar8 + 4);
        }
        uVar9 = FUN_00404750(iVar8,puVar7);
        uStack_c._0_1_ = 0x11;
        uVar9 = FUN_00403380(auStack_a8,uVar9);
        uStack_c._0_1_ = 0x12;
        FUN_00405c30(uVar9,0,0xffffffff);
        uStack_c._0_1_ = 0x11;
        FUN_00406560();
        uStack_c._0_1_ = 0x10;
        FUN_00406560();
        uStack_c._0_1_ = 0xf;
        FUN_00406560();
        goto LAB_0096676c;
      }
    }
    iVar8 = FUN_008ede80(auStack_38,2);
    if (iVar8 != 0) {
      *(int **)(iVar8 + 0x6c) = piStack_10c;
      *(undefined4 *)(iVar8 + 0x70) = 2;
      *(undefined4 *)(iVar8 + 0x74) = 0x20;
      if (*(code **)(iVar8 + 0x60) != (code *)0x0) {
        (**(code **)(iVar8 + 0x60))(1,iVar8);
      }
      *(code **)(iVar8 + 0x60) = FUN_00963920;
    }
  }
  uStack_c = 0xffffffff;
  FUN_00406560();
LAB_009668ae:
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)&piStack_10c);
  return;
}



============================================================
DISASSEMBLY
============================================================
009660a0 : PUSH EBP
009660a1 : MOV EBP,ESP
009660a3 : AND ESP,0xfffffff8
009660a6 : PUSH -0x1
009660a8 : PUSH 0xb60780
009660ad : MOV EAX,FS:[0x0]
009660b3 : PUSH EAX
009660b4 : SUB ESP,0xf8
009660ba : MOV EAX,[0x00d66fa0]
009660bf : XOR EAX,ESP
009660c1 : MOV dword ptr [ESP + 0xf0],EAX
009660c8 : PUSH EBX
009660c9 : PUSH ESI
009660ca : PUSH EDI
009660cb : MOV EAX,[0x00d66fa0]
009660d0 : XOR EAX,ESP
009660d2 : PUSH EAX
009660d3 : LEA EAX,[ESP + 0x108]
009660da : MOV FS:[0x0],EAX
009660e0 : MOV EAX,dword ptr [EBP + 0x8]
009660e3 : MOV ECX,dword ptr [EAX + 0x3c]
009660e6 : MOV EDI,dword ptr [EBP + 0x10]
009660e9 : MOV EBX,dword ptr [ECX + 0xc]
009660ec : MOV ESI,dword ptr [EBP + 0xc]
009660ef : MOV dword ptr [ESP + 0x14],EAX
009660f3 : MOVZX EAX,DI
009660f6 : IMUL EBX,EAX
009660f9 : MOVZX EDX,SI
009660fc : ADD EBX,EDX
009660fe : MOV dword ptr [ECX + 0x14],EBX
00966101 : MOV ECX,dword ptr [ESP + 0x14]
00966105 : MOV ECX,dword ptr [ECX + 0x3c]
00966108 : TEST EAX,EAX
0096610a : JL 0x009668ae
00966110 : MOV EBX,dword ptr [ECX + 0x8]
00966113 : DEC EBX
00966114 : CMP EAX,EBX
00966116 : JG 0x009668ae
0096611c : TEST EDX,EDX
0096611e : JL 0x009668ae
00966124 : MOV EAX,dword ptr [ECX + 0xc]
00966127 : DEC EAX
00966128 : CMP EDX,EAX
0096612a : JG 0x009668ae
00966130 : MOV ECX,dword ptr [ESP + 0x14]
00966134 : MOV EDX,dword ptr [ECX]
00966136 : MOV EAX,dword ptr [EDX + 0x74]
00966139 : PUSH EDI
0096613a : PUSH ESI
0096613b : CALL EAX
0096613d : MOV EBX,EAX
0096613f : MOV dword ptr [ESP + 0x10],EBX
00966143 : TEST EBX,EBX
00966145 : JZ 0x009668ae
0096614b : PUSH 0x11
0096614d : CALL dword ptr [0x00b85438]
00966153 : TEST AX,AX
00966156 : JGE 0x009661ea
0096615c : MOV ECX,dword ptr FS:[0x2c]
00966163 : MOV ECX,dword ptr [ECX]
00966165 : MOVZX EAX,byte ptr [ECX + 0x18]
00966169 : INC EAX
0096616a : CDQ
0096616b : MOV ESI,0x3
00966170 : IDIV ESI
00966172 : MOV byte ptr [ECX + 0x18],DL
00966175 : MOVZX EDX,DL
00966178 : SHL EDX,0xd
0096617b : LEA EAX,[EDX + ECX*0x1 + 0x122cb8]
00966182 : MOV dword ptr [ESP + 0x1c],EAX
00966186 : MOV dword ptr [ESP + 0x110],0x0
00966191 : TEST EAX,EAX
00966193 : JZ 0x009661b3
00966195 : MOV EBX,dword ptr [EBX + 0x10]
00966198 : XOR ECX,ECX
0096619a : MOV EDX,0x1
0096619f : MOV word ptr [EAX],CX
009661a2 : MOV byte ptr [EAX + 0x2],0x37
009661a6 : MOV byte ptr [EAX + 0x3],0x29
009661aa : MOV dword ptr [EAX + 0x4],EBX
009661ad : MOV word ptr [EAX + 0x8],DX
009661b1 : JMP 0x009661b5
009661b3 : XOR EAX,EAX
009661b5 : MOV dword ptr [ESP + 0x110],0xffffffff
009661c0 : MOV EDX,dword ptr [0x017247d4]
009661c6 : MOV ECX,dword ptr [EDX + 0x4]
009661c9 : TEST ECX,ECX
009661cb : JZ 0x009668ae
009661d1 : CMP byte ptr [EDX + 0x8],0x0
009661d5 : JZ 0x009668ae
009661db : PUSH 0xa
009661dd : PUSH ECX
009661de : MOV EDI,EAX
009661e0 : CALL 0x00a0dd40
009661e5 : JMP 0x009668ae
009661ea : MOV EBX,dword ptr [EBX + 0x10]
009661ed : PUSH EBX
009661ee : CALL 0x004049b0
009661f3 : MOV EBX,EAX
009661f5 : ADD ESP,0x4
009661f8 : TEST EBX,EBX
009661fa : JZ 0x009667cd
00966200 : MOV EAX,dword ptr [EBX]
00966202 : MOV EDX,dword ptr [EAX + 0x3c]
00966205 : MOV ECX,EBX
00966207 : CALL EDX
00966209 : TEST EAX,EAX
0096620b : JNZ 0x00966226
0096620d : MOV AL,byte ptr [EBX + 0x4]
00966210 : CMP AL,0x8c
00966212 : JZ 0x00966226
00966214 : CMP AL,0x71
00966216 : JZ 0x00966226
00966218 : CMP word ptr [EBX + 0xa4],0x1
00966220 : JNZ 0x009667cd
00966226 : PUSH 0xc79ec8
0096622b : LEA ECX,[ESP + 0xe8]
00966232 : CALL 0x00406460
00966237 : MOV dword ptr [ESP + 0x110],0x1
00966242 : XOR EAX,EAX
00966244 : MOV dword ptr [ESP + 0x18],EAX
00966248 : MOV dword ptr [ESP + 0x1c],EAX
0096624c : MOV AL,byte ptr [EBX + 0x4]
0096624f : CMP AL,0x71
00966251 : JNZ 0x009663ef
00966257 : MOV ESI,dword ptr [ESP + 0x10]
0096625b : MOV EAX,ESI
0096625d : CALL 0x00962f30
00966262 : CMP AL,0x1
00966264 : JNZ 0x0096631d
0096626a : PUSH 0xc79ed0
0096626f : LEA ECX,[ESP + 0x24]
00966273 : CALL 0x00406460
00966278 : MOV byte ptr [ESP + 0x110],0x2
00966280 : MOV ECX,dword ptr [0x0172491c]
00966286 : LEA EAX,[ESP + 0x20]
0096628a : PUSH EAX
0096628b : LEA EDI,[ESP + 0x40]
0096628f : CALL 0x0081d120
00966294 : MOV byte ptr [ESP + 0x110],0x3
0096629c : CMP dword ptr [EAX + 0x18],0x8
009662a0 : JC 0x009662a7
009662a2 : MOV EAX,dword ptr [EAX + 0x4]
009662a5 : JMP 0x009662aa
009662a7 : ADD EAX,0x4
009662aa : PUSH EAX
009662ab : LEA ESI,[ESP + 0x78]
009662af : CALL 0x00404750
009662b4 : ADD ESP,0x4
009662b7 : MOV byte ptr [ESP + 0x110],0x4
009662bf : LEA ECX,[ESP + 0x58]
009662c3 : PUSH ECX
009662c4 : MOV EDX,0xc79ecc
009662c9 : MOV ECX,EAX
009662cb : CALL 0x00403510
009662d0 : ADD ESP,0x4
009662d3 : MOV byte ptr [ESP + 0x110],0x5
009662db : PUSH -0x1
009662dd : PUSH 0x0
009662df : PUSH EAX
009662e0 : LEA ECX,[ESP + 0xf0]
009662e7 : CALL 0x00405eb0
009662ec : MOV byte ptr [ESP + 0x110],0x4
009662f4 : LEA ECX,[ESP + 0x58]
009662f8 : CALL 0x00406560
009662fd : MOV byte ptr [ESP + 0x110],0x3
00966305 : MOV ECX,ESI
00966307 : CALL 0x00406560
0096630c : MOV byte ptr [ESP + 0x110],0x2
00966314 : LEA ECX,[ESP + 0x3c]
00966318 : JMP 0x009663d9
0096631d : PUSH ESI
0096631e : CALL 0x00962040
00966323 : CMP AL,0x1
00966325 : JNZ 0x009663ef
0096632b : PUSH 0xc79f18
00966330 : LEA ECX,[ESP + 0x24]
00966334 : CALL 0x00406460
00966339 : MOV byte ptr [ESP + 0x110],0x6
00966341 : MOV ECX,dword ptr [0x0172491c]
00966347 : LEA EDX,[ESP + 0x20]
0096634b : PUSH EDX
0096634c : LEA EDI,[ESP + 0x5c]
00966350 : CALL 0x0081d120
00966355 : MOV byte ptr [ESP + 0x110],0x7
0096635d : CMP dword ptr [EAX + 0x18],0x8
00966361 : JC 0x00966368
00966363 : MOV EAX,dword ptr [EAX + 0x4]
00966366 : JMP 0x0096636b
00966368 : ADD EAX,0x4
0096636b : PUSH EAX
0096636c : LEA ESI,[ESP + 0x78]
00966370 : CALL 0x00404750
00966375 : ADD ESP,0x4
00966378 : MOV byte ptr [ESP + 0x110],0x8
00966380 : LEA ECX,[ESP + 0x3c]
00966384 : PUSH ECX
00966385 : MOV EDX,0xc79f14
0096638a : MOV ECX,EAX
0096638c : CALL 0x00403510
00966391 : ADD ESP,0x4
00966394 : MOV byte ptr [ESP + 0x110],0x9
0096639c : PUSH -0x1
0096639e : PUSH 0x0
009663a0 : PUSH EAX
009663a1 : LEA ECX,[ESP + 0xf0]
009663a8 : CALL 0x00405eb0
009663ad : MOV byte ptr [ESP + 0x110],0x8
009663b5 : LEA ECX,[ESP + 0x3c]
009663b9 : CALL 0x00406560
009663be : MOV byte ptr [ESP + 0x110],0x7
009663c6 : MOV ECX,ESI
009663c8 : CALL 0x00406560
009663cd : MOV byte ptr [ESP + 0x110],0x6
009663d5 : LEA ECX,[ESP + 0x58]
009663d9 : CALL 0x00406560
009663de : MOV byte ptr [ESP + 0x110],0x1
009663e6 : LEA ECX,[ESP + 0x20]
009663ea : CALL 0x00406560
009663ef : MOV EDX,dword ptr [ESP + 0x14]
009663f3 : MOV EDI,dword ptr [EDX + 0x5c]
009663f6 : TEST EDI,EDI
009663f8 : JZ 0x009664a5
009663fe : MOV EAX,dword ptr [EDI + 0x70]
00966401 : PUSH EAX
00966402 : CALL 0x004049b0
00966407 : MOV ESI,EAX
00966409 : ADD ESP,0x4
0096640c : TEST ESI,ESI
0096640e : JZ 0x009664a5
00966414 : MOV EAX,dword ptr [ESP + 0x10]
00966418 : MOV EAX,dword ptr [EAX + 0x10]
0096641b : PUSH EAX
0096641c : CALL 0x00962140
00966421 : MOV CL,byte ptr [ESI + 0x40]
00966424 : CMP CL,0x3
00966427 : JZ 0x00966433
00966429 : CMP CL,0x4
0096642c : JZ 0x00966433
0096642e : CMP CL,0x6
00966431 : JNZ 0x0096643d
00966433 : TEST EAX,EAX
00966435 : JBE 0x0096643d
00966437 : MOV dword ptr [ESP + 0x18],EAX
0096643b : JMP 0x009664a5
0096643d : MOVZX EDI,word ptr [ESI + 0x46]
00966441 : MOV ECX,dword ptr [EBX + 0x54]
00966444 : MOVZX EAX,DI
00966447 : CDQ
00966448 : PUSH EDX
00966449 : PUSH EAX
0096644a : PUSH 0x0
0096644c : PUSH ECX
0096644d : CALL 0x0063c720
00966452 : PUSH 0x0
00966454 : PUSH 0x2710
00966459 : PUSH EDX
0096645a : PUSH EAX
0096645b : CALL 0x0063c760
00966460 : MOV EDX,0x2710
00966465 : MOV dword ptr [ESP + 0x18],EAX
00966469 : CMP DX,DI
0096646c : JNC 0x009664a5
0096646e : MOVZX EAX,word ptr [ESI + 0x46]
00966472 : MOVSS XMM1,dword ptr [0x00c10fc4]
0096647a : CVTSI2SS XMM0,EAX
0096647e : MULSS XMM0,dword ptr [0x00cdf398]
00966486 : SUBSS XMM1,XMM0
0096648a : MULSS XMM1,dword ptr [0x00cdf230]
00966492 : MOVSS XMM0,dword ptr [0x00cdf350]
0096649a : ANDPS XMM1,XMM0
0096649d : CVTTSS2SI ECX,XMM1
009664a1 : MOV dword ptr [ESP + 0x1c],ECX
009664a5 : PUSH 0xc79f5c
009664aa : LEA ECX,[ESP + 0x24]
009664ae : CALL 0x00406460
009664b3 : MOV byte ptr [ESP + 0x110],0xa
009664bb : MOV EAX,[0x0172491c]
009664c0 : PUSH 0x0
009664c2 : LEA EDX,[EBX + 0x18]
009664c5 : PUSH EAX
009664c6 : LEA ESI,[ESP + 0x60]
009664ca : CALL 0x00824a20
009664cf : MOV ESI,EAX
009664d1 : MOV byte ptr [ESP + 0x110],0xb
009664d9 : LEA ECX,[ESP + 0x20]
009664dd : PUSH ECX
009664de : MOV ECX,dword ptr [0x0172491c]
009664e4 : LEA EDI,[ESP + 0x78]
009664e8 : CALL 0x0081d120
009664ed : MOV BL,0xc
009664ef : MOV byte ptr [ESP + 0x110],BL
009664f6 : MOV EDI,0x8
009664fb : CMP dword ptr [ESI + 0x18],EDI
009664fe : JC 0x00966505
00966500 : MOV ESI,dword ptr [ESI + 0x4]
00966503 : JMP 0x00966508
00966505 : ADD ESI,0x4
00966508 : CMP dword ptr [EAX + 0x18],EDI
0096650b : JC 0x00966512
0096650d : MOV EAX,dword ptr [EAX + 0x4]
00966510 : JMP 0x00966515
00966512 : ADD EAX,0x4
00966515 : PUSH ESI
00966516 : PUSH EAX
00966517 : LEA ESI,[ESP + 0x44]
0096651b : CALL 0x00404750
00966520 : ADD ESP,0x8
00966523 : MOV byte ptr [ESP + 0x110],0xd
0096652b : PUSH -0x1
0096652d : PUSH 0x0
0096652f : PUSH EAX
00966530 : LEA ECX,[ESP + 0xf0]
00966537 : CALL 0x00405c30
0096653c : MOV byte ptr [ESP + 0x110],BL
00966543 : MOV ECX,ESI
00966545 : CALL 0x00406560
0096654a : MOV byte ptr [ESP + 0x110],0xb
00966552 : LEA ECX,[ESP + 0x74]
00966556 : CALL 0x00406560
0096655b : MOV byte ptr [ESP + 0x110],0xa
00966563 : LEA ECX,[ESP + 0x58]
00966567 : CALL 0x00406560
0096656c : MOV byte ptr [ESP + 0x110],0x1
00966574 : LEA ECX,[ESP + 0x20]
00966578 : CALL 0x00406560
0096657d : MOV EDX,dword ptr [ESP + 0x14]
00966581 : MOV EAX,dword ptr [EDX + 0x5c]
00966584 : TEST EAX,EAX
00966586 : JZ 0x009666ac
0096658c : CMP byte ptr [EAX + 0x8c],0x0
00966593 : JNZ 0x009666ac
00966599 : MOV EAX,dword ptr [ESP + 0x18]
0096659d : PUSH 0x0
0096659f : PUSH EAX
009665a0 : LEA ECX,[ESP + 0x44]
009665a4 : CALL 0x0070c2d0
009665a9 : ADD ESP,0x8
009665ac : MOV byte ptr [ESP + 0x110],0xe
009665b4 : PUSH -0x1
009665b6 : PUSH 0x0
009665b8 : PUSH EAX
009665b9 : LEA ECX,[ESP + 0xf0]
009665c0 : CALL 0x00405c30
009665c5 : MOV byte ptr [ESP + 0x110],0x1
009665cd : LEA ECX,[ESP + 0x3c]
009665d1 : CALL 0x00406560
009665d6 : MOV ESI,dword ptr [ESP + 0x1c]
009665da : TEST ESI,ESI
009665dc : JLE 0x00966771
009665e2 : PUSH 0xc79f9c
009665e7 : LEA ECX,[ESP + 0x24]
009665eb : CALL 0x00406460
009665f0 : MOV byte ptr [ESP + 0x110],0xf
009665f8 : LEA ECX,[ESP + 0x20]
009665fc : PUSH ECX
009665fd : MOV ECX,dword ptr [0x0172491c]
00966603 : LEA EDI,[ESP + 0x94]
0096660a : CALL 0x0081d120
0096660f : MOV BL,0x10
00966611 : MOV byte ptr [ESP + 0x110],BL
00966618 : CMP dword ptr [EAX + 0x18],0x8
0096661c : JC 0x00966623
0096661e : MOV EAX,dword ptr [EAX + 0x4]
00966621 : JMP 0x00966626
00966623 : ADD EAX,0x4
00966626 : PUSH ESI
00966627 : PUSH EAX
00966628 : LEA ESI,[ESP + 0x60]
0096662c : CALL 0x00404750
00966631 : MOV byte ptr [ESP + 0x118],0x11
00966639 : PUSH EAX
0096663a : LEA EDX,[ESP + 0x80]
00966641 : PUSH EDX
00966642 : MOV EDX,0xc79fc0
00966647 : CALL 0x00403380
0096664c : ADD ESP,0x10
0096664f : MOV byte ptr [ESP + 0x110],0x12
00966657 : PUSH -0x1
00966659 : PUSH 0x0
0096665b : PUSH EAX
0096665c : LEA ECX,[ESP + 0xf0]
00966663 : CALL 0x00405c30
00966668 : MOV byte ptr [ESP + 0x110],0x11
00966670 : LEA ECX,[ESP + 0x74]
00966674 : CALL 0x00406560
00966679 : MOV byte ptr [ESP + 0x110],BL
00966680 : MOV ECX,ESI
00966682 : CALL 0x00406560
00966687 : MOV byte ptr [ESP + 0x110],0xf
0096668f : LEA ECX,[ESP + 0x90]
00966696 : CALL 0x00406560
0096669b : MOV byte ptr [ESP + 0x110],0x1
009666a3 : LEA ECX,[ESP + 0x20]
009666a7 : JMP 0x0096676c
009666ac : MOV EAX,[0x0172491c]
009666b1 : PUSH EAX
009666b2 : MOV ECX,0xc79fc4
009666b7 : LEA ESI,[ESP + 0xb0]
009666be : CALL 0x0081cbe0
009666c3 : MOV ESI,EAX
009666c5 : MOV byte ptr [ESP + 0x110],0x13
009666cd : MOV ECX,dword ptr [ESP + 0x10]
009666d1 : MOV EAX,dword ptr [ECX + 0xbc]
009666d7 : PUSH 0x0
009666d9 : PUSH EAX
009666da : LEA ECX,[ESP + 0xd0]
009666e1 : CALL 0x0070c2d0
009666e6 : ADD ESP,0x8
009666e9 : MOV BL,0x14
009666eb : MOV byte ptr [ESP + 0x110],BL
009666f2 : CMP dword ptr [ESI + 0x18],EDI
009666f5 : JC 0x009666fc
009666f7 : MOV ESI,dword ptr [ESI + 0x4]
009666fa : JMP 0x009666ff
009666fc : ADD ESI,0x4
009666ff : CMP dword ptr [EAX + 0x18],EDI
00966702 : JC 0x00966709
00966704 : MOV EAX,dword ptr [EAX + 0x4]
00966707 : JMP 0x0096670c
00966709 : ADD EAX,0x4
0096670c : PUSH ESI
0096670d : PUSH EAX
0096670e : PUSH 0xc79fc8
00966713 : LEA ESI,[ESP + 0x9c]
0096671a : CALL 0x00404750
0096671f : ADD ESP,0xc
00966722 : MOV byte ptr [ESP + 0x110],0x15
0096672a : PUSH -0x1
0096672c : PUSH 0x0
0096672e : PUSH EAX
0096672f : LEA ECX,[ESP + 0xf0]
00966736 : CALL 0x00405c30
0096673b : MOV byte ptr [ESP + 0x110],BL
00966742 : MOV ECX,ESI
00966744 : CALL 0x00406560
00966749 : MOV byte ptr [ESP + 0x110],0x13
00966751 : LEA ECX,[ESP + 0xc8]
00966758 : CALL 0x00406560
0096675d : MOV byte ptr [ESP + 0x110],0x1
00966765 : LEA ECX,[ESP + 0xac]
0096676c : CALL 0x00406560
00966771 : MOV EDX,dword ptr [0x00da9894]
00966777 : MOV ECX,dword ptr [EDX]
00966779 : PUSH 0x2
0096677b : LEA EAX,[ESP + 0xe8]
00966782 : PUSH EAX
00966783 : CALL 0x008ede80
00966788 : MOV ESI,EAX
0096678a : TEST ESI,ESI
0096678c : JZ 0x009667b6
0096678e : MOV EAX,dword ptr [ESI + 0x60]
00966791 : MOV ECX,dword ptr [ESP + 0x10]
00966795 : MOV dword ptr [ESI + 0x6c],ECX
00966798 : MOV dword ptr [ESI + 0x70],0x2
0096679f : MOV dword ptr [ESI + 0x74],0x20
009667a6 : TEST EAX,EAX
009667a8 : JZ 0x009667af
009667aa : PUSH ESI
009667ab : PUSH 0x1
009667ad : CALL EAX
009667af : MOV dword ptr [ESI + 0x60],0x963920
009667b6 : MOV dword ptr [ESP + 0x110],0xffffffff
009667c1 : LEA ECX,[ESP + 0xe4]
009667c8 : JMP 0x009668a9
009667cd : MOV EBX,dword ptr [ESP + 0x14]
009667d1 : CMP dword ptr [EBX + 0x5c],0x0
009667d5 : JZ 0x00966860
009667db : MOV ECX,dword ptr [ESP + 0x10]
009667df : MOV EDX,dword ptr [ECX]
009667e1 : MOV EAX,dword ptr [EDX + 0x20]
009667e4 : CALL EAX
009667e6 : MOV EBX,dword ptr [EBX + 0x5c]
009667e9 : TEST EAX,EAX
009667eb : JNZ 0x009667fe
009667ed : PUSH 0x1
009667ef : PUSH EDI
009667f0 : PUSH ESI
009667f1 : PUSH 0x20
009667f3 : PUSH EBX
009667f4 : CALL 0x009636b0
009667f9 : JMP 0x009668ae
009667fe : MOVZX ECX,word ptr [EBX + 0x76]
00966802 : MOV EAX,dword ptr [EBX + 0x78]
00966805 : MOV word ptr [EAX + 0x54],CX
00966809 : MOV dword ptr [EAX + 0x50],EBX
0096680c : MOV byte ptr [EAX + 0x56],0x0
00966810 : MOV EAX,dword ptr [EBX + 0x78]
00966813 : MOV EDX,0xc8
00966818 : PUSH ESI
00966819 : MOV ECX,0x1
0096681e : MOV word ptr [EAX + 0x3a],DX
00966822 : PUSH EBX
00966823 : MOV EDX,EDI
00966825 : MOV word ptr [EAX + 0x38],CX
00966829 : CALL 0x009621f0
0096682e : MOV EAX,dword ptr [EBX + 0x78]
00966831 : MOV byte ptr [EAX + 0x4e],0x1
00966835 : MOV EDI,dword ptr [EBX + 0x78]
00966838 : MOV ESI,0x1
0096683d : CALL 0x009ac1d0
00966842 : MOV EAX,dword ptr [EBP + 0x10]
00966845 : MOV EBX,dword ptr [EBX + 0x78]
00966848 : MOV ECX,dword ptr [EBP + 0xc]
0096684b : MOV EDX,dword ptr [EBX]
0096684d : MOV EDX,dword ptr [EDX + 0x50]
00966850 : PUSH 0x0
00966852 : PUSH 0x0
00966854 : PUSH 0x0
00966856 : PUSH EAX
00966857 : PUSH ECX
00966858 : PUSH 0x20
0096685a : MOV ECX,EBX
0096685c : CALL EDX
0096685e : JMP 0x009668ae
00966860 : PUSH 0xc79fd8
00966865 : LEA ECX,[ESP + 0x24]
00966869 : CALL 0x00406460
0096686e : MOV dword ptr [ESP + 0x110],0x16
00966879 : MOV EAX,[0x00da98e8]
0096687e : MOV ECX,dword ptr [EAX]
00966880 : TEST ECX,ECX
00966882 : JZ 0x0096689a
00966884 : MOV EDX,dword ptr [ECX]
00966886 : MOV EDX,dword ptr [EDX + 0x14]
00966889 : LEA EAX,[ESP + 0x20]
0096688d : PUSH EAX
0096688e : PUSH 0x1e3
00966893 : PUSH 0xc79ff4
00966898 : CALL EDX
0096689a : MOV dword ptr [ESP + 0x110],0xffffffff
009668a5 : LEA ECX,[ESP + 0x20]
009668a9 : CALL 0x00406560
009668ae : MOV ECX,dword ptr [ESP + 0x108]
009668b5 : MOV dword ptr FS:[0x0],ECX
009668bc : POP ECX
009668bd : POP EDI
009668be : POP ESI
009668bf : POP EBX
009668c0 : MOV ECX,dword ptr [ESP + 0xf0]
009668c7 : XOR ECX,ESP
009668c9 : CALL 0x00633e6b
009668ce : MOV ESP,EBP
009668d0 : POP EBP
009668d1 : RET 0xc

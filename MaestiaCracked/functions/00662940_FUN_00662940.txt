PROGRAM  : Maestia.exe
FUNCTION : FUN_00662940
ENTRY    : 00662940
BODY     : [[00662940, 00662abf]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00662940(int param_1,uint param_2,uint *param_3)

{
  uint uVar1;
  int local_4;
  
  local_4 = 0;
  if (3 < param_2) {
    if (param_3 == (uint *)0x0) {
      return 0x80004003;
    }
    uVar1 = *param_3;
    if (uVar1 < param_2) {
      param_2 = uVar1;
    }
    if (((((0x30 < param_2) || (0x30 < uVar1)) ||
         ((0xb < param_2 &&
          (((param_3[2] & 0xfffffe20) != 0 ||
           ((((param_3[2] & 0x10) != 0 && ((*(byte *)(param_1 + 4) & 0x10) == 0)) &&
            (param_2 < 0x20)))))))) ||
        (((0x2b < param_2 && (param_3[10] != 0)) && (param_3[10] != *(uint *)(param_1 + 0xc))))) ||
       ((0x2f < param_2 &&
        (((uVar1 = param_3[0xb], uVar1 != 0 && (uVar1 != *(uint *)(param_1 + 0x14))) ||
         ((0xf < param_2 && ((int)uVar1 < (int)param_3[3])))))))) {
      return 0x80070057;
    }
    if ((0x27 < param_2) && ((param_3[2] & 8) != 0)) {
      if (param_3[9] == 0) {
        return 0x80004003;
      }
      local_4 = FUN_006646c0(param_3[9]);
      if (local_4 == 0) {
        return 0x8007000e;
      }
    }
    if (0x23 < param_2) {
      *(uint *)(param_1 + 0x40) = param_3[8];
    }
    if (param_2 < 0xc) {
      if (7 < param_2) {
        *(uint *)(param_1 + 8) = param_3[1];
      }
    }
    else {
      *(uint *)(param_1 + 4) = *(uint *)(param_1 + 4) & 0x20 | param_3[2];
      *(uint *)(param_1 + 8) = param_3[1];
    }
    if (0xf < param_2) {
      *(uint *)(param_1 + 0x10) = param_3[3];
    }
    if (0x1f < param_2) {
      *(uint *)(param_1 + 0x28) = param_3[6];
      *(uint *)(param_1 + 0x2c) = param_3[7];
    }
    if (0x17 < param_2) {
      *(uint *)(param_1 + 0x20) = param_3[4];
      *(uint *)(param_1 + 0x24) = param_3[5];
    }
    if ((0x27 < param_2) && ((param_3[2] & 8) != 0)) {
      if (*(int *)(param_1 + 0x3c) != 0) {
        FUN_00664670(*(int *)(param_1 + 0x3c));
      }
      *(int *)(param_1 + 0x3c) = local_4;
    }
    if (*(int *)(param_1 + 0x3c) == 0) {
      *(uint *)(param_1 + 4) = *(uint *)(param_1 + 4) & 0xfffffff7;
      return 0;
    }
    *(uint *)(param_1 + 4) = *(uint *)(param_1 + 4) | 8;
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00662940 : PUSH ECX
00662941 : PUSH EBP
00662942 : MOV EBP,dword ptr [ESP + 0x10]
00662946 : PUSH ESI
00662947 : PUSH EDI
00662948 : MOV dword ptr [ESP + 0xc],0x0
00662950 : CMP EBP,0x4
00662953 : JC 0x00662a9e
00662959 : MOV ESI,dword ptr [ESP + 0x1c]
0066295d : TEST ESI,ESI
0066295f : JNZ 0x0066296d
00662961 : POP EDI
00662962 : POP ESI
00662963 : MOV EAX,0x80004003
00662968 : POP EBP
00662969 : POP ECX
0066296a : RET 0xc
0066296d : MOV EAX,dword ptr [ESI]
0066296f : CMP EAX,EBP
00662971 : JNC 0x00662975
00662973 : MOV EBP,EAX
00662975 : CMP EBP,0x30
00662978 : JA 0x00662ab4
0066297e : CMP EAX,0x30
00662981 : JA 0x00662ab4
00662987 : MOV EDI,dword ptr [ESP + 0x14]
0066298b : CMP EBP,0xc
0066298e : JC 0x006629b1
00662990 : MOV EAX,dword ptr [ESI + 0x8]
00662993 : TEST EAX,0xfffffe20
00662998 : JNZ 0x00662ab4
0066299e : TEST AL,0x10
006629a0 : JZ 0x006629b1
006629a2 : TEST byte ptr [EDI + 0x4],0x10
006629a6 : JNZ 0x006629b1
006629a8 : CMP EBP,0x20
006629ab : JC 0x00662ab4
006629b1 : CMP EBP,0x2c
006629b4 : JC 0x006629c6
006629b6 : MOV EAX,dword ptr [ESI + 0x28]
006629b9 : TEST EAX,EAX
006629bb : JZ 0x006629c6
006629bd : CMP EAX,dword ptr [EDI + 0xc]
006629c0 : JNZ 0x00662ab4
006629c6 : CMP EBP,0x30
006629c9 : JC 0x006629e9
006629cb : MOV EAX,dword ptr [ESI + 0x2c]
006629ce : TEST EAX,EAX
006629d0 : JZ 0x006629db
006629d2 : CMP EAX,dword ptr [EDI + 0x14]
006629d5 : JNZ 0x00662ab4
006629db : CMP EBP,0x10
006629de : JC 0x006629e9
006629e0 : CMP EAX,dword ptr [ESI + 0xc]
006629e3 : JL 0x00662ab4
006629e9 : CMP EBP,0x28
006629ec : JC 0x00662a19
006629ee : TEST byte ptr [ESI + 0x8],0x8
006629f2 : JZ 0x00662a19
006629f4 : MOV EAX,dword ptr [ESI + 0x24]
006629f7 : TEST EAX,EAX
006629f9 : JZ 0x00662961
006629ff : PUSH EAX
00662a00 : CALL 0x006646c0
00662a05 : MOV dword ptr [ESP + 0xc],EAX
00662a09 : TEST EAX,EAX
00662a0b : JNZ 0x00662a19
00662a0d : POP EDI
00662a0e : POP ESI
00662a0f : MOV EAX,0x8007000e
00662a14 : POP EBP
00662a15 : POP ECX
00662a16 : RET 0xc
00662a19 : CMP EBP,0x24
00662a1c : JC 0x00662a24
00662a1e : MOV EAX,dword ptr [ESI + 0x20]
00662a21 : MOV dword ptr [EDI + 0x40],EAX
00662a24 : CMP EBP,0xc
00662a27 : JC 0x00662a3d
00662a29 : MOV ECX,dword ptr [EDI + 0x4]
00662a2c : AND ECX,0x20
00662a2f : OR ECX,dword ptr [ESI + 0x8]
00662a32 : MOV dword ptr [EDI + 0x4],ECX
00662a35 : MOV EDX,dword ptr [ESI + 0x4]
00662a38 : MOV dword ptr [EDI + 0x8],EDX
00662a3b : JMP 0x00662a48
00662a3d : CMP EBP,0x8
00662a40 : JC 0x00662a48
00662a42 : MOV EAX,dword ptr [ESI + 0x4]
00662a45 : MOV dword ptr [EDI + 0x8],EAX
00662a48 : CMP EBP,0x10
00662a4b : JC 0x00662a53
00662a4d : MOV ECX,dword ptr [ESI + 0xc]
00662a50 : MOV dword ptr [EDI + 0x10],ECX
00662a53 : CMP EBP,0x20
00662a56 : JC 0x00662a64
00662a58 : MOV EDX,dword ptr [ESI + 0x18]
00662a5b : MOV dword ptr [EDI + 0x28],EDX
00662a5e : MOV EAX,dword ptr [ESI + 0x1c]
00662a61 : MOV dword ptr [EDI + 0x2c],EAX
00662a64 : CMP EBP,0x18
00662a67 : JC 0x00662a75
00662a69 : MOV ECX,dword ptr [ESI + 0x10]
00662a6c : MOV dword ptr [EDI + 0x20],ECX
00662a6f : MOV EDX,dword ptr [ESI + 0x14]
00662a72 : MOV dword ptr [EDI + 0x24],EDX
00662a75 : CMP EBP,0x28
00662a78 : JC 0x00662a94
00662a7a : TEST byte ptr [ESI + 0x8],0x8
00662a7e : JZ 0x00662a94
00662a80 : MOV EAX,dword ptr [EDI + 0x3c]
00662a83 : TEST EAX,EAX
00662a85 : JZ 0x00662a8d
00662a87 : PUSH EAX
00662a88 : CALL 0x00664670
00662a8d : MOV EAX,dword ptr [ESP + 0xc]
00662a91 : MOV dword ptr [EDI + 0x3c],EAX
00662a94 : CMP dword ptr [EDI + 0x3c],0x0
00662a98 : JZ 0x00662aa7
00662a9a : OR dword ptr [EDI + 0x4],0x8
00662a9e : POP EDI
00662a9f : POP ESI
00662aa0 : XOR EAX,EAX
00662aa2 : POP EBP
00662aa3 : POP ECX
00662aa4 : RET 0xc
00662aa7 : AND dword ptr [EDI + 0x4],0xfffffff7
00662aab : POP EDI
00662aac : POP ESI
00662aad : XOR EAX,EAX
00662aaf : POP EBP
00662ab0 : POP ECX
00662ab1 : RET 0xc
00662ab4 : POP EDI
00662ab5 : POP ESI
00662ab6 : MOV EAX,0x80070057
00662abb : POP EBP
00662abc : POP ECX
00662abd : RET 0xc

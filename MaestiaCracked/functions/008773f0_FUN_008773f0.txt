PROGRAM  : Maestia.exe
FUNCTION : FUN_008773f0
ENTRY    : 008773f0
BODY     : [[008773f0, 00877627]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x0087741c) */

void FUN_008773f0(void)

{
  undefined4 uVar1;
  int *piVar2;
  int *piVar3;
  DWORD DVar4;
  int iVar5;
  int unaff_EDI;
  float10 fVar6;
  float10 fVar7;
  float fVar8;
  float fVar9;
  float fVar10;
  float fVar11;
  float fVar12;
  float fVar13;
  float local_1c;
  
  DVar4 = timeGetTime();
  uVar1 = *(undefined4 *)(unaff_EDI + 0x74);
  local_1c = 1.0;
  fVar6 = (float10)fsin((float10)((DVar4 - *(int *)(unaff_EDI + 0xd8)) % 1000) * (float10)0.001 *
                        (float10)6.2831855);
  iVar5 = FUN_00a1a840(uVar1);
  if ((((iVar5 != 0) || (iVar5 = FUN_00a1a6d0(uVar1), iVar5 != 0)) ||
      (iVar5 = FUN_00a1a780(uVar1), iVar5 != 0)) && (*(int *)(iVar5 + 1000) != 0)) {
    piVar2 = *(int **)(unaff_EDI + 0x48);
    if (*(char *)((int)piVar2 + 0x5d) != '\0') {
      (**(code **)(*piVar2 + 0x14))();
    }
    fVar9 = (float)piVar2[0x2e];
    piVar3 = *(int **)(iVar5 + 1000);
    fVar11 = (float)piVar2[0x2f];
    fVar13 = (float)piVar2[0x30];
    if (*(char *)((int)piVar3 + 0x5d) != '\0') {
      (**(code **)(*piVar3 + 0x14))();
    }
    fVar12 = fVar13 - (float)piVar3[0x30];
    fVar10 = fVar11 - (float)piVar3[0x2f];
    fVar8 = fVar9 - (float)piVar3[0x2e];
    fVar7 = (float10)FUN_0040f460(fVar12 * fVar12 + fVar10 * fVar10 + fVar8 * fVar8);
    fVar8 = (float)fVar7;
    fVar13 = fVar13 - *(float *)(unaff_EDI + 0x84);
    fVar11 = fVar11 - *(float *)(unaff_EDI + 0x80);
    fVar9 = fVar9 - *(float *)(unaff_EDI + 0x7c);
    fVar7 = (float10)FUN_0040f460(fVar13 * fVar13 + fVar11 * fVar11 + fVar9 * fVar9);
    fVar9 = (float)fVar7;
    if ((fVar8 < 20.0) || (fVar9 < 20.0)) {
      if (fVar8 < fVar9) {
        fVar9 = fVar8;
      }
      local_1c = fVar9 * 0.05;
    }
  }
  fVar9 = *(float *)(unaff_EDI + 0xe0);
  if (((*(int *)(unaff_EDI + 0x50) != 0) &&
      (iVar5 = *(int *)(*(int *)(unaff_EDI + 0x50) + 0x14), iVar5 != 0)) ||
     (iVar5 = *(int *)(unaff_EDI + 0x54), iVar5 != 0)) {
    *(undefined4 *)(iVar5 + 0x68) = 0;
    *(float *)(iVar5 + 0x6c) = fVar9 * local_1c * (float)fVar6;
    *(undefined4 *)(iVar5 + 0x70) = 0;
    *(undefined1 *)(iVar5 + 0x5d) = 1;
    *(undefined1 *)(iVar5 + 0x134) = 1;
    *(undefined1 *)(iVar5 + 0x5c) = 1;
    if (*(int **)(iVar5 + 0x2c) != (int *)0x0) {
      (**(code **)(**(int **)(iVar5 + 0x2c) + 0x60))(iVar5);
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
008773f0 : PUSH EBP
008773f1 : MOV EBP,ESP
008773f3 : AND ESP,0xfffffff8
008773f6 : SUB ESP,0x20
008773f9 : PUSH EBX
008773fa : PUSH ESI
008773fb : CALL dword ptr [0x00b85598]
00877401 : SUB EAX,dword ptr [EDI + 0xd8]
00877407 : XOR EDX,EDX
00877409 : MOV ECX,0x3e8
0087740e : DIV ECX
00877410 : MOV dword ptr [ESP + 0x18],EDX
00877414 : FILD dword ptr [ESP + 0x18]
00877418 : TEST EDX,EDX
0087741a : JGE 0x00877422
0087741c : FADD float ptr [0x00cdf0e0]
00877422 : FMUL float ptr [0x00cdf128]
00877428 : MOV EBX,dword ptr [EDI + 0x74]
0087742b : MOV ECX,dword ptr [0x00da93ec]
00877431 : MOVSS XMM0,dword ptr [0x00c10fc4]
00877439 : FMUL float ptr [0x00c1884c]
0087743f : PUSH EBX
00877440 : MOVSS dword ptr [ESP + 0x18],XMM0
00877446 : MOV dword ptr [ESP + 0x10],ECX
0087744a : FSIN
0087744c : FSTP float ptr [ESP + 0x1c]
00877450 : CALL 0x00a1a840
00877455 : MOV ESI,EAX
00877457 : TEST ESI,ESI
00877459 : JNZ 0x0087747f
0087745b : MOV ECX,dword ptr [ESP + 0xc]
0087745f : PUSH EBX
00877460 : CALL 0x00a1a6d0
00877465 : MOV ESI,EAX
00877467 : TEST ESI,ESI
00877469 : JNZ 0x0087747f
0087746b : MOV ECX,dword ptr [ESP + 0xc]
0087746f : PUSH EBX
00877470 : CALL 0x00a1a780
00877475 : MOV ESI,EAX
00877477 : TEST ESI,ESI
00877479 : JZ 0x008775c6
0087747f : CMP dword ptr [ESI + 0x3e8],0x0
00877486 : JZ 0x008775c6
0087748c : MOV EBX,dword ptr [EDI + 0x48]
0087748f : CMP byte ptr [EBX + 0x5d],0x0
00877493 : JZ 0x0087749e
00877495 : MOV EDX,dword ptr [EBX]
00877497 : MOV EAX,dword ptr [EDX + 0x14]
0087749a : MOV ECX,EBX
0087749c : CALL EAX
0087749e : MOVSS XMM0,dword ptr [EBX + 0xb8]
008774a6 : MOV ESI,dword ptr [ESI + 0x3e8]
008774ac : CMP byte ptr [ESI + 0x5d],0x0
008774b0 : MOVSS dword ptr [ESP + 0x1c],XMM0
008774b6 : MOVSS XMM0,dword ptr [EBX + 0xbc]
008774be : MOVSS dword ptr [ESP + 0x20],XMM0
008774c4 : MOVSS XMM0,dword ptr [EBX + 0xc0]
008774cc : MOVSS dword ptr [ESP + 0x24],XMM0
008774d2 : JZ 0x008774dd
008774d4 : MOV EDX,dword ptr [ESI]
008774d6 : MOV EAX,dword ptr [EDX + 0x14]
008774d9 : MOV ECX,ESI
008774db : CALL EAX
008774dd : MOVSS XMM2,dword ptr [ESP + 0x24]
008774e3 : SUBSS XMM2,dword ptr [ESI + 0xc0]
008774eb : MOVSS XMM1,dword ptr [ESP + 0x20]
008774f1 : SUBSS XMM1,dword ptr [ESI + 0xbc]
008774f9 : MOVSS XMM0,dword ptr [ESP + 0x1c]
008774ff : SUBSS XMM0,dword ptr [ESI + 0xb8]
00877507 : MOVAPS XMM3,XMM2
0087750a : MULSS XMM3,XMM2
0087750e : MOVAPS XMM2,XMM1
00877511 : MULSS XMM2,XMM1
00877515 : MOVAPS XMM1,XMM0
00877518 : ADDSS XMM3,XMM2
0087751c : MULSS XMM1,XMM0
00877520 : PUSH ECX
00877521 : ADDSS XMM3,XMM1
00877525 : MOVSS dword ptr [ESP],XMM3
0087752a : CALL 0x0040f460
0087752f : FSTP float ptr [ESP + 0x10]
00877533 : MOVSS XMM2,dword ptr [ESP + 0x28]
00877539 : SUBSS XMM2,dword ptr [EDI + 0x84]
00877541 : MOVSS XMM1,dword ptr [ESP + 0x24]
00877547 : SUBSS XMM1,dword ptr [EDI + 0x80]
0087754f : MOVSS XMM0,dword ptr [ESP + 0x20]
00877555 : SUBSS XMM0,dword ptr [EDI + 0x7c]
0087755a : MOVAPS XMM3,XMM2
0087755d : MULSS XMM3,XMM2
00877561 : MOVAPS XMM2,XMM1
00877564 : MULSS XMM2,XMM1
00877568 : MOVAPS XMM1,XMM0
0087756b : ADDSS XMM3,XMM2
0087756f : MULSS XMM1,XMM0
00877573 : ADDSS XMM3,XMM1
00877577 : MOVSS dword ptr [ESP],XMM3
0087757c : CALL 0x0040f460
00877581 : FSTP float ptr [ESP + 0x14]
00877585 : FLD float ptr [ESP + 0x10]
00877589 : MOVSS XMM0,dword ptr [ESP + 0x14]
0087758f : FLD float ptr [0x00cdf140]
00877595 : ADD ESP,0x4
00877598 : FCOMIP ST0,ST1
0087759a : FSTP ST0
0087759c : JA 0x008775ab
0087759e : MOVSS XMM1,dword ptr [0x00cdf140]
008775a6 : COMISS XMM1,XMM0
008775a9 : JBE 0x008775c6
008775ab : MOVSS XMM1,dword ptr [ESP + 0xc]
008775b1 : COMISS XMM0,XMM1
008775b4 : JBE 0x008775b9
008775b6 : MOVAPS XMM0,XMM1
008775b9 : MULSS XMM0,dword ptr [0x00cdf0f4]
008775c1 : MOVAPS XMM1,XMM0
008775c4 : JMP 0x008775cc
008775c6 : MOVSS XMM1,dword ptr [ESP + 0x14]
008775cc : MOV EAX,dword ptr [EDI + 0x50]
008775cf : MOVSS XMM0,dword ptr [EDI + 0xe0]
008775d7 : MULSS XMM0,XMM1
008775db : MULSS XMM0,dword ptr [ESP + 0x18]
008775e1 : TEST EAX,EAX
008775e3 : JZ 0x008775ec
008775e5 : MOV EAX,dword ptr [EAX + 0x14]
008775e8 : TEST EAX,EAX
008775ea : JNZ 0x008775f3
008775ec : MOV EAX,dword ptr [EDI + 0x54]
008775ef : TEST EAX,EAX
008775f1 : JZ 0x00877622
008775f3 : XORPS XMM1,XMM1
008775f6 : MOVSS dword ptr [EAX + 0x68],XMM1
008775fb : MOVSS dword ptr [EAX + 0x6c],XMM0
00877600 : MOV CL,0x1
00877602 : MOVSS dword ptr [EAX + 0x70],XMM1
00877607 : MOV byte ptr [EAX + 0x5d],CL
0087760a : MOV byte ptr [EAX + 0x134],CL
00877610 : MOV byte ptr [EAX + 0x5c],CL
00877613 : MOV ECX,dword ptr [EAX + 0x2c]
00877616 : TEST ECX,ECX
00877618 : JZ 0x00877622
0087761a : MOV EDX,dword ptr [ECX]
0087761c : PUSH EAX
0087761d : MOV EAX,dword ptr [EDX + 0x60]
00877620 : CALL EAX
00877622 : POP ESI
00877623 : POP EBX
00877624 : MOV ESP,EBP
00877626 : POP EBP
00877627 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00705630
ENTRY    : 00705630
BODY     : [[00705630, 0070568c] [00705690, 007058bb]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00705630(int param_1)

{
  int *piVar1;
  short sVar2;
  undefined1 uVar3;
  uint uVar4;
  uint uVar5;
  int in_ECX;
  undefined1 *puVar6;
  uint uVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  undefined1 *puVar11;
  int iVar12;
  undefined1 *puVar13;
  uint uVar14;
  int local_10;
  int local_c;
  uint local_8;
  
  sVar2 = *(short *)(in_ECX + 4);
  uVar4 = 0;
  do {
    local_8._0_1_ = (undefined1)sVar2;
    sVar2 = sVar2 >> 8;
    *(undefined1 *)(uVar4 + param_1) = (undefined1)local_8;
    uVar4 = uVar4 + 1;
  } while (uVar4 < 2);
  iVar8 = 2;
  if ((*(int *)(in_ECX + 0x28) - *(int *)(in_ECX + 0x24) & 0xfffffffcU) != 0) {
    uVar4 = **(uint **)(in_ECX + 0x24);
    uVar14 = *(int *)(in_ECX + 0x28) - *(int *)(in_ECX + 0x24) >> 2;
    uVar7 = 0;
    uVar5 = uVar4;
    do {
      *(char *)(param_1 + 2 + uVar7) = (char)uVar5;
      uVar7 = uVar7 + 1;
      uVar5 = uVar5 >> 8;
    } while (uVar7 < 2);
    puVar6 = *(undefined1 **)(in_ECX + 0xc);
    puVar13 = puVar6 + uVar4;
    puVar11 = (undefined1 *)(param_1 + 4);
    for (; puVar6 != puVar13; puVar6 = puVar6 + 1) {
      *puVar11 = *puVar6;
      puVar11 = puVar11 + 1;
    }
    iVar8 = uVar4 + 4;
    local_8 = 1;
    if (1 < uVar14) {
      do {
        uVar3 = 0x3c;
        uVar4 = 0;
        do {
          *(undefined1 *)(param_1 + iVar8 + uVar4) = uVar3;
          uVar4 = uVar4 + 1;
          uVar3 = 0;
        } while (uVar4 < 2);
        uVar7 = *(int *)(*(int *)(in_ECX + 0x24) + local_8 * 4) -
                *(int *)(*(int *)(in_ECX + 0x24) + -4 + local_8 * 4);
        uVar5 = 0;
        uVar4 = uVar7;
        do {
          *(char *)(param_1 + iVar8 + 2 + uVar5) = (char)uVar4;
          uVar5 = uVar5 + 1;
          uVar4 = uVar4 >> 8;
        } while (uVar5 < 2);
        iVar12 = *(int *)(in_ECX + 0xc);
        puVar13 = (undefined1 *)(param_1 + iVar8 + 4);
        piVar1 = (int *)(*(int *)(in_ECX + 0x24) + local_8 * 4);
        iVar9 = *piVar1;
        for (puVar6 = (undefined1 *)(piVar1[-1] + iVar12); puVar6 != (undefined1 *)(iVar9 + iVar12);
            puVar6 = puVar6 + 1) {
          *puVar13 = *puVar6;
          puVar13 = puVar13 + 1;
        }
        local_8 = local_8 + 1;
        iVar8 = iVar8 + 4 + uVar7;
      } while (local_8 < uVar14);
    }
    uVar4 = 0;
    uVar3 = 0x3c;
    do {
      *(undefined1 *)(param_1 + iVar8 + uVar4) = uVar3;
      uVar4 = uVar4 + 1;
      uVar3 = 0;
    } while (uVar4 < 2);
    uVar5 = (*(int *)(in_ECX + 0x10) - *(int *)(*(int *)(in_ECX + 0x24) + -4 + local_8 * 4)) -
            *(int *)(in_ECX + 0xc);
    uVar7 = 0;
    uVar4 = uVar5;
    do {
      *(char *)(param_1 + iVar8 + 2 + uVar7) = (char)uVar4;
      uVar7 = uVar7 + 1;
      uVar4 = uVar4 >> 8;
    } while (uVar7 < 2);
    puVar13 = (undefined1 *)(iVar8 + 4 + param_1);
    puVar6 = *(undefined1 **)(in_ECX + 0x10);
    for (puVar11 = (undefined1 *)
                   (*(int *)(*(int *)(in_ECX + 0x24) + -4 + local_8 * 4) + *(int *)(in_ECX + 0xc));
        puVar11 != puVar6; puVar11 = puVar11 + 1) {
      *puVar13 = *puVar11;
      puVar13 = puVar13 + 1;
    }
    return iVar8 + 4 + uVar5;
  }
  local_8 = *(uint *)(in_ECX + 0x18);
  local_10 = 0;
  iVar12 = 0;
  if (0x2020 < local_8) {
    local_c = 0;
    iVar9 = iVar8;
    iVar10 = param_1 + 2;
    do {
      iVar8 = 0x2020;
      uVar4 = 0;
      do {
        *(char *)(iVar10 + uVar4) = (char)iVar8;
        uVar4 = uVar4 + 1;
        iVar8 = iVar8 >> 8;
      } while (uVar4 < 2);
      local_8 = local_8 - 0x2020;
      puVar6 = (undefined1 *)(*(int *)(in_ECX + 0xc) + local_c);
      puVar11 = (undefined1 *)(iVar10 + 2);
      puVar13 = puVar6 + 0x2020;
      for (; puVar6 != puVar13; puVar6 = puVar6 + 1) {
        *puVar11 = *puVar6;
        puVar11 = puVar11 + 1;
      }
      iVar8 = iVar9 + 0x2022;
      iVar12 = iVar10 + 0x2022;
      if (local_8 != 0) {
        local_10 = local_10 + 1;
        local_c = local_c + 0x2020;
        uVar3 = 0x3c;
        uVar4 = 0;
        do {
          *(undefined1 *)(iVar12 + uVar4) = uVar3;
          uVar4 = uVar4 + 1;
          uVar3 = 0;
        } while (uVar4 < 2);
        iVar8 = iVar9 + 0x2024;
        iVar12 = iVar10 + 0x2024;
      }
      iVar9 = iVar8;
      iVar10 = iVar12;
      iVar12 = local_10;
    } while (0x2020 < local_8);
  }
  uVar5 = 0;
  uVar4 = local_8;
  do {
    *(char *)(param_1 + iVar8 + uVar5) = (char)uVar4;
    uVar5 = uVar5 + 1;
    uVar4 = uVar4 >> 8;
  } while (uVar5 < 2);
  puVar13 = (undefined1 *)(iVar8 + 2 + param_1);
  puVar6 = (undefined1 *)(iVar12 * 0x2020 + *(int *)(in_ECX + 0xc));
  puVar11 = puVar6 + local_8;
  for (; puVar6 != puVar11; puVar6 = puVar6 + 1) {
    *puVar13 = *puVar6;
    puVar13 = puVar13 + 1;
  }
  return iVar8 + 2 + local_8;
}



============================================================
DISASSEMBLY
============================================================
00705630 : PUSH EBP
00705631 : MOV EBP,ESP
00705633 : SUB ESP,0x10
00705636 : MOVZX EAX,word ptr [ECX + 0x4]
0070563a : PUSH EBX
0070563b : PUSH ESI
0070563c : MOV dword ptr [EBP + -0x4],EAX
0070563f : MOV dword ptr [EBP + -0xc],ECX
00705642 : XOR EAX,EAX
00705644 : PUSH EDI
00705645 : MOV DL,byte ptr [EBP + -0x4]
00705648 : MOV ESI,dword ptr [EBP + 0x8]
0070564b : SAR word ptr [EBP + -0x4],0x8
00705650 : MOV byte ptr [EAX + ESI*0x1],DL
00705653 : INC EAX
00705654 : CMP EAX,0x2
00705657 : JC 0x00705645
00705659 : MOV EAX,dword ptr [ECX + 0x28]
0070565c : SUB EAX,dword ptr [ECX + 0x24]
0070565f : MOV EBX,0x2
00705664 : TEST EAX,0xfffffffc
00705669 : JNZ 0x00705768
0070566f : MOV EDX,dword ptr [ECX + 0x18]
00705672 : XOR EDI,EDI
00705674 : MOV dword ptr [EBP + -0x4],EDX
00705677 : MOV dword ptr [EBP + -0xc],EDI
0070567a : CMP EDX,0x2020
00705680 : JBE 0x0070571c
00705686 : ADD ESI,EBX
00705688 : MOV dword ptr [EBP + -0x8],EDI
0070568b : JMP 0x00705690
00705690 : MOV EAX,0x2020
00705695 : XOR EDX,EDX
00705697 : MOV byte ptr [ESI + EDX*0x1],AL
0070569a : INC EDX
0070569b : SAR EAX,0x8
0070569e : CMP EDX,0x2
007056a1 : JC 0x00705697
007056a3 : MOV EDI,dword ptr [EBP + -0x8]
007056a6 : MOV EDX,dword ptr [ECX + 0xc]
007056a9 : SUB dword ptr [EBP + -0x4],0x2020
007056b0 : ADD EDX,EDI
007056b2 : ADD EBX,0x2
007056b5 : ADD ESI,0x2
007056b8 : LEA EDI,[EDX + 0x2020]
007056be : MOV dword ptr [EBP + -0x10],EBX
007056c1 : MOV EAX,ESI
007056c3 : CMP EDX,EDI
007056c5 : JZ 0x007056d4
007056c7 : MOV BL,byte ptr [EDX]
007056c9 : MOV byte ptr [EAX],BL
007056cb : INC EDX
007056cc : INC EAX
007056cd : CMP EDX,EDI
007056cf : JNZ 0x007056c7
007056d1 : MOV EBX,dword ptr [EBP + -0x10]
007056d4 : MOV EDI,dword ptr [EBP + -0x4]
007056d7 : ADD EBX,0x2020
007056dd : ADD ESI,0x2020
007056e3 : TEST EDI,EDI
007056e5 : JZ 0x0070570a
007056e7 : INC dword ptr [EBP + -0xc]
007056ea : ADD dword ptr [EBP + -0x8],0x2020
007056f1 : MOV EAX,0x3c
007056f6 : XOR EDX,EDX
007056f8 : MOV byte ptr [ESI + EDX*0x1],AL
007056fb : INC EDX
007056fc : SAR EAX,0x8
007056ff : CMP EDX,0x2
00705702 : JC 0x007056f8
00705704 : ADD EBX,0x2
00705707 : ADD ESI,0x2
0070570a : CMP EDI,0x2020
00705710 : JA 0x00705690
00705716 : MOV EDI,dword ptr [EBP + -0xc]
00705719 : MOV EDX,dword ptr [EBP + -0x4]
0070571c : MOV ESI,dword ptr [EBP + 0x8]
0070571f : XOR EAX,EAX
00705721 : ADD ESI,EBX
00705723 : MOV byte ptr [ESI + EAX*0x1],DL
00705726 : INC EAX
00705727 : SHR EDX,0x8
0070572a : CMP EAX,0x2
0070572d : JC 0x00705723
0070572f : MOV EAX,dword ptr [EBP + 0x8]
00705732 : IMUL EDI,EDI,0x2020
00705738 : MOV ECX,dword ptr [ECX + 0xc]
0070573b : MOV EDX,dword ptr [EBP + -0x4]
0070573e : ADD EBX,0x2
00705741 : LEA ESI,[EBX + EAX*0x1]
00705744 : LEA EAX,[EDI + ECX*0x1]
00705747 : LEA ECX,[EAX + EDX*0x1]
0070574a : CMP EAX,ECX
0070574c : JZ 0x0070575a
0070574e : MOV EDI,EDI
00705750 : MOV DL,byte ptr [EAX]
00705752 : MOV byte ptr [ESI],DL
00705754 : INC EAX
00705755 : INC ESI
00705756 : CMP EAX,ECX
00705758 : JNZ 0x00705750
0070575a : ADD EBX,dword ptr [EBP + -0x4]
0070575d : POP EDI
0070575e : POP ESI
0070575f : MOV EAX,EBX
00705761 : POP EBX
00705762 : MOV ESP,EBP
00705764 : POP EBP
00705765 : RET 0x4
00705768 : MOV ESI,dword ptr [ECX + 0x28]
0070576b : SUB ESI,dword ptr [ECX + 0x24]
0070576e : MOV EAX,dword ptr [ECX + 0x24]
00705771 : MOV EAX,dword ptr [EAX]
00705773 : SAR ESI,0x2
00705776 : MOV dword ptr [EBP + -0x8],ESI
00705779 : MOV dword ptr [EBP + -0x10],EAX
0070577c : MOV EBX,EAX
0070577e : XOR EDX,EDX
00705780 : MOV EDI,dword ptr [EBP + 0x8]
00705783 : MOV byte ptr [EDI + EDX*0x1 + 0x2],BL
00705787 : INC EDX
00705788 : SHR EBX,0x8
0070578b : CMP EDX,0x2
0070578e : JC 0x00705780
00705790 : MOV EDX,dword ptr [ECX + 0xc]
00705793 : LEA EBX,[EAX + EDX*0x1]
00705796 : ADD EDI,0x4
00705799 : CMP EDX,EBX
0070579b : JZ 0x007057ad
0070579d : LEA ECX,[ECX]
007057a0 : MOV AL,byte ptr [EDX]
007057a2 : MOV byte ptr [EDI],AL
007057a4 : INC EDX
007057a5 : INC EDI
007057a6 : CMP EDX,EBX
007057a8 : JNZ 0x007057a0
007057aa : MOV EAX,dword ptr [EBP + -0x10]
007057ad : MOV EBX,0x1
007057b2 : ADD EAX,0x4
007057b5 : MOV dword ptr [EBP + -0x4],EBX
007057b8 : CMP ESI,EBX
007057ba : JBE 0x00705847
007057c0 : MOV EBX,0x3c
007057c5 : XOR EDX,EDX
007057c7 : MOV ESI,dword ptr [EBP + 0x8]
007057ca : ADD ESI,EAX
007057cc : MOV byte ptr [ESI + EDX*0x1],BL
007057cf : INC EDX
007057d0 : SAR EBX,0x8
007057d3 : CMP EDX,0x2
007057d6 : JC 0x007057c7
007057d8 : MOV EDX,dword ptr [ECX + 0x24]
007057db : MOV ESI,dword ptr [EBP + -0x4]
007057de : MOV EDI,dword ptr [EDX + ESI*0x4]
007057e1 : SUB EDI,dword ptr [EDX + ESI*0x4 + -0x4]
007057e5 : LEA EDX,[EDX + ESI*0x4]
007057e8 : ADD EAX,0x2
007057eb : MOV EBX,EDI
007057ed : XOR EDX,EDX
007057ef : NOP
007057f0 : MOV ESI,dword ptr [EBP + 0x8]
007057f3 : ADD ESI,EAX
007057f5 : MOV byte ptr [ESI + EDX*0x1],BL
007057f8 : INC EDX
007057f9 : SHR EBX,0x8
007057fc : CMP EDX,0x2
007057ff : JC 0x007057f0
00705801 : MOV EDX,dword ptr [EBP + 0x8]
00705804 : MOV ESI,dword ptr [EBP + -0x4]
00705807 : MOV EBX,dword ptr [ECX + 0xc]
0070580a : ADD EAX,0x2
0070580d : ADD EDX,EAX
0070580f : MOV dword ptr [EBP + -0x10],EDX
00705812 : MOV EDX,dword ptr [ECX + 0x24]
00705815 : LEA EDX,[EDX + ESI*0x4]
00705818 : MOV ESI,dword ptr [EDX]
0070581a : MOV EDX,dword ptr [EDX + -0x4]
0070581d : ADD ESI,EBX
0070581f : ADD EDX,EBX
00705821 : CMP EDX,ESI
00705823 : JZ 0x00705835
00705825 : MOV ECX,dword ptr [EBP + -0x10]
00705828 : MOV BL,byte ptr [EDX]
0070582a : MOV byte ptr [ECX],BL
0070582c : INC EDX
0070582d : INC ECX
0070582e : CMP EDX,ESI
00705830 : JNZ 0x00705828
00705832 : MOV ECX,dword ptr [EBP + -0xc]
00705835 : MOV EBX,dword ptr [EBP + -0x4]
00705838 : INC EBX
00705839 : ADD EAX,EDI
0070583b : MOV dword ptr [EBP + -0x4],EBX
0070583e : CMP EBX,dword ptr [EBP + -0x8]
00705841 : JC 0x007057c0
00705847 : MOV EDI,dword ptr [EBP + 0x8]
0070584a : XOR ESI,ESI
0070584c : MOV EDX,0x3c
00705851 : ADD EDI,EAX
00705853 : MOV byte ptr [EDI + ESI*0x1],DL
00705856 : INC ESI
00705857 : SAR EDX,0x8
0070585a : CMP ESI,0x2
0070585d : JC 0x00705853
0070585f : MOV EDX,dword ptr [ECX + 0x24]
00705862 : MOV ESI,dword ptr [ECX + 0x10]
00705865 : SUB ESI,dword ptr [EDX + EBX*0x4 + -0x4]
00705869 : MOV EBX,dword ptr [EBP + 0x8]
0070586c : SUB ESI,dword ptr [ECX + 0xc]
0070586f : ADD EAX,0x2
00705872 : XOR EDI,EDI
00705874 : MOV EDX,ESI
00705876 : ADD EBX,EAX
00705878 : MOV byte ptr [EBX + EDI*0x1],DL
0070587b : INC EDI
0070587c : SHR EDX,0x8
0070587f : CMP EDI,0x2
00705882 : JC 0x00705878
00705884 : MOV EDX,dword ptr [EBP + 0x8]
00705887 : MOV EBX,dword ptr [EBP + -0x4]
0070588a : ADD EAX,0x2
0070588d : LEA EDI,[EAX + EDX*0x1]
00705890 : MOV EDX,dword ptr [ECX + 0x10]
00705893 : MOV dword ptr [EBP + 0x8],EDX
00705896 : MOV EDX,dword ptr [ECX + 0x24]
00705899 : MOV EDX,dword ptr [EDX + EBX*0x4 + -0x4]
0070589d : ADD EDX,dword ptr [ECX + 0xc]
007058a0 : MOV ECX,dword ptr [EBP + 0x8]
007058a3 : CMP EDX,ECX
007058a5 : JZ 0x007058b1
007058a7 : MOV BL,byte ptr [EDX]
007058a9 : MOV byte ptr [EDI],BL
007058ab : INC EDX
007058ac : INC EDI
007058ad : CMP EDX,ECX
007058af : JNZ 0x007058a7
007058b1 : POP EDI
007058b2 : ADD EAX,ESI
007058b4 : POP ESI
007058b5 : POP EBX
007058b6 : MOV ESP,EBP
007058b8 : POP EBP
007058b9 : RET 0x4

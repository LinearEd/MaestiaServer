PROGRAM  : Maestia.exe
FUNCTION : FUN_0041b8b0
ENTRY    : 0041b8b0
BODY     : [[0041b8b0, 0041babc]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0041b8b0(undefined4 *param_1,int *param_2)

{
  uint uVar1;
  undefined1 *puVar2;
  undefined4 *puVar3;
  undefined2 *puVar4;
  short *psVar5;
  wchar_t *_Source;
  uint *unaff_ESI;
  int iVar6;
  int *piVar7;
  __time64_t _Var8;
  
  puVar3 = (undefined4 *)*param_2;
  if ((puVar3 == (undefined4 *)0x0) || (*unaff_ESI < 8)) {
    *unaff_ESI = 0;
    puVar3 = (undefined4 *)0x0;
  }
  else {
    *param_1 = *puVar3;
    param_1[1] = puVar3[1];
    *unaff_ESI = *unaff_ESI - 8;
    puVar3 = puVar3 + 2;
  }
  *param_2 = (int)puVar3;
  if ((puVar3 == (undefined4 *)0x0) || (*unaff_ESI < 8)) {
    *unaff_ESI = 0;
    puVar3 = (undefined4 *)0x0;
  }
  else {
    param_1[2] = *puVar3;
    param_1[3] = puVar3[1];
    *unaff_ESI = *unaff_ESI - 8;
    puVar3 = puVar3 + 2;
  }
  *param_2 = (int)puVar3;
  if ((puVar3 == (undefined4 *)0x0) || (*unaff_ESI < 4)) {
    *unaff_ESI = 0;
    puVar3 = (undefined4 *)0x0;
  }
  else {
    param_1[4] = *puVar3;
    *unaff_ESI = *unaff_ESI - 4;
    puVar3 = puVar3 + 1;
  }
  *param_2 = (int)puVar3;
  if ((puVar3 == (undefined4 *)0x0) || (*unaff_ESI == 0)) {
    *unaff_ESI = 0;
    psVar5 = (short *)0x0;
  }
  else {
    *(undefined1 *)((int)param_1 + 0x3a) = *(undefined1 *)puVar3;
    *unaff_ESI = *unaff_ESI - 1;
    psVar5 = (short *)((int)puVar3 + 1);
  }
  *param_2 = (int)psVar5;
  if ((((psVar5 == (short *)0x0) || (uVar1 = *unaff_ESI, uVar1 < 2)) || (*psVar5 < 0)) ||
     (iVar6 = (int)*psVar5, (int)uVar1 < iVar6 + 2)) {
    _Source = (wchar_t *)0x0;
    puVar2 = (undefined1 *)0x0;
    *unaff_ESI = 0;
  }
  else {
    *unaff_ESI = (uVar1 - iVar6) - 2;
    puVar2 = (undefined1 *)(iVar6 + 2 + (int)psVar5);
    _Source = psVar5 + 1;
  }
  *param_2 = (int)puVar2;
  if (_Source != (wchar_t *)0x0) {
    _wcsncpy((wchar_t *)(param_1 + 0xf),_Source,0x27);
    *(undefined2 *)((int)param_1 + 0x8a) = 0;
  }
  puVar3 = (undefined4 *)*param_2;
  if ((puVar3 == (undefined4 *)0x0) || (*unaff_ESI < 4)) {
    *unaff_ESI = 0;
    puVar3 = (undefined4 *)0x0;
    piVar7 = param_2;
  }
  else {
    piVar7 = (int *)*puVar3;
    *unaff_ESI = *unaff_ESI - 4;
    puVar3 = puVar3 + 1;
  }
  *param_2 = (int)puVar3;
  _Var8 = __time64((__time64_t *)0x0);
  *(__time64_t *)(param_1 + 6) = _Var8 + (int)piVar7;
  puVar2 = (undefined1 *)*param_2;
  if ((puVar2 == (undefined1 *)0x0) || (*unaff_ESI == 0)) {
    *unaff_ESI = 0;
    puVar3 = (undefined4 *)0x0;
  }
  else {
    *(undefined1 *)(param_1 + 8) = *puVar2;
    *unaff_ESI = *unaff_ESI - 1;
    puVar3 = (undefined4 *)(puVar2 + 1);
  }
  *param_2 = (int)puVar3;
  if ((puVar3 == (undefined4 *)0x0) || (*unaff_ESI < 4)) {
    *unaff_ESI = 0;
    puVar3 = (undefined4 *)0x0;
  }
  else {
    param_1[9] = *puVar3;
    *unaff_ESI = *unaff_ESI - 4;
    puVar3 = puVar3 + 1;
  }
  *param_2 = (int)puVar3;
  if ((puVar3 == (undefined4 *)0x0) || (*unaff_ESI < 4)) {
    *unaff_ESI = 0;
    puVar3 = (undefined4 *)0x0;
  }
  else {
    param_1[10] = *puVar3;
    *unaff_ESI = *unaff_ESI - 4;
    puVar3 = puVar3 + 1;
  }
  *param_2 = (int)puVar3;
  if ((puVar3 == (undefined4 *)0x0) || (*unaff_ESI < 4)) {
    *unaff_ESI = 0;
    puVar3 = (undefined4 *)0x0;
  }
  else {
    param_1[0xb] = *puVar3;
    *unaff_ESI = *unaff_ESI - 4;
    puVar3 = puVar3 + 1;
  }
  *param_2 = (int)puVar3;
  if ((puVar3 == (undefined4 *)0x0) || (*unaff_ESI < 2)) {
    *unaff_ESI = 0;
    puVar4 = (undefined2 *)0x0;
  }
  else {
    *(undefined2 *)(param_1 + 0xe) = *(undefined2 *)puVar3;
    *unaff_ESI = *unaff_ESI - 2;
    puVar4 = (undefined2 *)((int)puVar3 + 2);
  }
  *param_2 = (int)puVar4;
  if ((puVar4 != (undefined2 *)0x0) && (1 < *unaff_ESI)) {
    *(undefined2 *)(param_1 + 0x27) = *puVar4;
    *unaff_ESI = *unaff_ESI - 2;
    *param_2 = (int)(puVar4 + 1);
    return;
  }
  *unaff_ESI = 0;
  *param_2 = 0;
  return;
}



============================================================
DISASSEMBLY
============================================================
0041b8b0 : PUSH EBP
0041b8b1 : MOV EBP,ESP
0041b8b3 : PUSH EBX
0041b8b4 : MOV EBX,dword ptr [EBP + 0x8]
0041b8b7 : PUSH EDI
0041b8b8 : MOV EDI,dword ptr [EBP + 0xc]
0041b8bb : MOV EAX,dword ptr [EDI]
0041b8bd : TEST EAX,EAX
0041b8bf : JZ 0x0041b8d8
0041b8c1 : CMP dword ptr [ESI],0x8
0041b8c4 : JC 0x0041b8d8
0041b8c6 : MOV ECX,dword ptr [EAX]
0041b8c8 : MOV dword ptr [EBX],ECX
0041b8ca : MOV EDX,dword ptr [EAX + 0x4]
0041b8cd : MOV dword ptr [EBX + 0x4],EDX
0041b8d0 : ADD dword ptr [ESI],-0x8
0041b8d3 : ADD EAX,0x8
0041b8d6 : JMP 0x0041b8e0
0041b8d8 : MOV dword ptr [ESI],0x0
0041b8de : XOR EAX,EAX
0041b8e0 : MOV dword ptr [EDI],EAX
0041b8e2 : TEST EAX,EAX
0041b8e4 : JZ 0x0041b8fe
0041b8e6 : CMP dword ptr [ESI],0x8
0041b8e9 : JC 0x0041b8fe
0041b8eb : MOV ECX,dword ptr [EAX]
0041b8ed : MOV dword ptr [EBX + 0x8],ECX
0041b8f0 : MOV EDX,dword ptr [EAX + 0x4]
0041b8f3 : MOV dword ptr [EBX + 0xc],EDX
0041b8f6 : ADD dword ptr [ESI],-0x8
0041b8f9 : ADD EAX,0x8
0041b8fc : JMP 0x0041b906
0041b8fe : MOV dword ptr [ESI],0x0
0041b904 : XOR EAX,EAX
0041b906 : MOV dword ptr [EDI],EAX
0041b908 : TEST EAX,EAX
0041b90a : JZ 0x0041b91e
0041b90c : CMP dword ptr [ESI],0x4
0041b90f : JC 0x0041b91e
0041b911 : MOV ECX,dword ptr [EAX]
0041b913 : MOV dword ptr [EBX + 0x10],ECX
0041b916 : ADD dword ptr [ESI],-0x4
0041b919 : ADD EAX,0x4
0041b91c : JMP 0x0041b926
0041b91e : MOV dword ptr [ESI],0x0
0041b924 : XOR EAX,EAX
0041b926 : MOV dword ptr [EDI],EAX
0041b928 : TEST EAX,EAX
0041b92a : JZ 0x0041b93d
0041b92c : CMP dword ptr [ESI],0x1
0041b92f : JC 0x0041b93d
0041b931 : MOV DL,byte ptr [EAX]
0041b933 : MOV byte ptr [EBX + 0x3a],DL
0041b936 : DEC dword ptr [ESI]
0041b938 : LEA ECX,[EAX + 0x1]
0041b93b : JMP 0x0041b945
0041b93d : MOV dword ptr [ESI],0x0
0041b943 : XOR ECX,ECX
0041b945 : MOV dword ptr [EDI],ECX
0041b947 : TEST ECX,ECX
0041b949 : JZ 0x0041b97a
0041b94b : MOV EAX,dword ptr [ESI]
0041b94d : CMP EAX,0x2
0041b950 : JC 0x0041b97a
0041b952 : MOVZX EDX,word ptr [ECX]
0041b955 : TEST DX,DX
0041b958 : JL 0x0041b97a
0041b95a : MOVSX EDI,DX
0041b95d : LEA EDX,[EDI + 0x2]
0041b960 : CMP EAX,EDX
0041b962 : JL 0x0041b977
0041b964 : SUB EAX,EDI
0041b966 : SUB EAX,0x2
0041b969 : MOV dword ptr [ESI],EAX
0041b96b : LEA EAX,[EDI + ECX*0x1 + 0x2]
0041b96f : MOV EDI,dword ptr [EBP + 0xc]
0041b972 : LEA EDX,[ECX + 0x2]
0041b975 : JMP 0x0041b980
0041b977 : MOV EDI,dword ptr [EBP + 0xc]
0041b97a : XOR EDX,EDX
0041b97c : XOR EAX,EAX
0041b97e : MOV dword ptr [ESI],EAX
0041b980 : MOV dword ptr [EDI],EAX
0041b982 : TEST EDX,EDX
0041b984 : JZ 0x0041b99e
0041b986 : PUSH 0x27
0041b988 : PUSH EDX
0041b989 : LEA EDI,[EBX + 0x3c]
0041b98c : PUSH EDI
0041b98d : CALL 0x00634e39
0041b992 : ADD ESP,0xc
0041b995 : XOR EAX,EAX
0041b997 : MOV word ptr [EDI + 0x4e],AX
0041b99b : MOV EDI,dword ptr [EBP + 0xc]
0041b99e : MOV EAX,dword ptr [EDI]
0041b9a0 : TEST EAX,EAX
0041b9a2 : JZ 0x0041b9b7
0041b9a4 : MOV ECX,dword ptr [ESI]
0041b9a6 : CMP ECX,0x4
0041b9a9 : JC 0x0041b9b7
0041b9ab : MOV EDI,dword ptr [EAX]
0041b9ad : ADD ECX,-0x4
0041b9b0 : MOV dword ptr [ESI],ECX
0041b9b2 : ADD EAX,0x4
0041b9b5 : JMP 0x0041b9c2
0041b9b7 : MOV EDI,dword ptr [EBP + 0xc]
0041b9ba : MOV dword ptr [ESI],0x0
0041b9c0 : XOR EAX,EAX
0041b9c2 : MOV ECX,dword ptr [EBP + 0xc]
0041b9c5 : PUSH 0x0
0041b9c7 : MOV dword ptr [ECX],EAX
0041b9c9 : CALL 0x006381ab
0041b9ce : MOV ECX,EAX
0041b9d0 : MOV EAX,EDX
0041b9d2 : MOV dword ptr [EBP + 0x8],EAX
0041b9d5 : MOV EAX,EDI
0041b9d7 : MOV EDI,dword ptr [EBP + 0xc]
0041b9da : CDQ
0041b9db : ADD ESP,0x4
0041b9de : ADD ECX,EAX
0041b9e0 : MOV EAX,dword ptr [EBP + 0x8]
0041b9e3 : ADC EAX,EDX
0041b9e5 : MOV dword ptr [EBX + 0x18],ECX
0041b9e8 : MOV dword ptr [EBX + 0x1c],EAX
0041b9eb : MOV EAX,dword ptr [EDI]
0041b9ed : TEST EAX,EAX
0041b9ef : JZ 0x0041ba00
0041b9f1 : CMP dword ptr [ESI],0x1
0041b9f4 : JC 0x0041ba00
0041b9f6 : MOV DL,byte ptr [EAX]
0041b9f8 : MOV byte ptr [EBX + 0x20],DL
0041b9fb : DEC dword ptr [ESI]
0041b9fd : INC EAX
0041b9fe : JMP 0x0041ba08
0041ba00 : MOV dword ptr [ESI],0x0
0041ba06 : XOR EAX,EAX
0041ba08 : MOV dword ptr [EDI],EAX
0041ba0a : TEST EAX,EAX
0041ba0c : JZ 0x0041ba20
0041ba0e : CMP dword ptr [ESI],0x4
0041ba11 : JC 0x0041ba20
0041ba13 : MOV ECX,dword ptr [EAX]
0041ba15 : MOV dword ptr [EBX + 0x24],ECX
0041ba18 : ADD dword ptr [ESI],-0x4
0041ba1b : ADD EAX,0x4
0041ba1e : JMP 0x0041ba28
0041ba20 : MOV dword ptr [ESI],0x0
0041ba26 : XOR EAX,EAX
0041ba28 : MOV dword ptr [EDI],EAX
0041ba2a : TEST EAX,EAX
0041ba2c : JZ 0x0041ba40
0041ba2e : CMP dword ptr [ESI],0x4
0041ba31 : JC 0x0041ba40
0041ba33 : MOV EDX,dword ptr [EAX]
0041ba35 : MOV dword ptr [EBX + 0x28],EDX
0041ba38 : ADD dword ptr [ESI],-0x4
0041ba3b : ADD EAX,0x4
0041ba3e : JMP 0x0041ba48
0041ba40 : MOV dword ptr [ESI],0x0
0041ba46 : XOR EAX,EAX
0041ba48 : MOV dword ptr [EDI],EAX
0041ba4a : TEST EAX,EAX
0041ba4c : JZ 0x0041ba60
0041ba4e : CMP dword ptr [ESI],0x4
0041ba51 : JC 0x0041ba60
0041ba53 : MOV ECX,dword ptr [EAX]
0041ba55 : MOV dword ptr [EBX + 0x2c],ECX
0041ba58 : ADD dword ptr [ESI],-0x4
0041ba5b : ADD EAX,0x4
0041ba5e : JMP 0x0041ba68
0041ba60 : MOV dword ptr [ESI],0x0
0041ba66 : XOR EAX,EAX
0041ba68 : MOV dword ptr [EDI],EAX
0041ba6a : TEST EAX,EAX
0041ba6c : JZ 0x0041ba82
0041ba6e : CMP dword ptr [ESI],0x2
0041ba71 : JC 0x0041ba82
0041ba73 : MOV DX,word ptr [EAX]
0041ba76 : MOV word ptr [EBX + 0x38],DX
0041ba7a : ADD dword ptr [ESI],-0x2
0041ba7d : ADD EAX,0x2
0041ba80 : JMP 0x0041ba8a
0041ba82 : MOV dword ptr [ESI],0x0
0041ba88 : XOR EAX,EAX
0041ba8a : MOV dword ptr [EDI],EAX
0041ba8c : TEST EAX,EAX
0041ba8e : JZ 0x0041baad
0041ba90 : CMP dword ptr [ESI],0x2
0041ba93 : JC 0x0041baad
0041ba95 : MOV CX,word ptr [EAX]
0041ba98 : MOV word ptr [EBX + 0x9c],CX
0041ba9f : ADD dword ptr [ESI],-0x2
0041baa2 : ADD EAX,0x2
0041baa5 : MOV dword ptr [EDI],EAX
0041baa7 : POP EDI
0041baa8 : POP EBX
0041baa9 : POP EBP
0041baaa : RET 0x8
0041baad : XOR EAX,EAX
0041baaf : MOV dword ptr [ESI],0x0
0041bab5 : MOV dword ptr [EDI],EAX
0041bab7 : POP EDI
0041bab8 : POP EBX
0041bab9 : POP EBP
0041baba : RET 0x8

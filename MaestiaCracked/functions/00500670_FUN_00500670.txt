PROGRAM  : Maestia.exe
FUNCTION : FUN_00500670
ENTRY    : 00500670
BODY     : [[00500670, 005006e9]]

============================================================
DECOMPILED C CODE
============================================================

undefined1 FUN_00500670(int param_1,char *param_2,undefined4 param_3)

{
  char cVar1;
  undefined4 uVar2;
  undefined1 uVar3;
  char *pcVar4;
  int *in_ECX;
  int unaff_EBP;
  undefined4 uStack_4;
  
  uVar2 = param_1;
  uStack_4 = (uint)in_ECX & 0xffffff;
  pcVar4 = param_2;
  do {
    cVar1 = *pcVar4;
    pcVar4 = pcVar4 + 1;
  } while (cVar1 != '\0');
  param_1 = FUN_00525380(param_2,(int)pcVar4 - (int)(param_2 + 1),0);
  *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 1;
  uVar3 = (**(code **)(*in_ECX + 0x28))(uVar2,&param_1,param_3,(int)&uStack_4 + 3);
  *(int *)(unaff_EBP + 8) = *(int *)(unaff_EBP + 8) + -1;
  if (*(int *)(unaff_EBP + 8) == 0) {
    FUN_00525340();
  }
  return uVar3;
}



============================================================
DISASSEMBLY
============================================================
00500670 : PUSH ECX
00500671 : PUSH EBX
00500672 : PUSH EBP
00500673 : MOV EBP,dword ptr [ESP + 0x14]
00500677 : PUSH ESI
00500678 : PUSH EDI
00500679 : MOV EDI,dword ptr [ESP + 0x18]
0050067d : MOV ESI,ECX
0050067f : MOV ECX,dword ptr [EDI]
00500681 : MOV EAX,EBP
00500683 : MOV byte ptr [ESP + 0x13],0x0
00500688 : ADD ECX,0x8
0050068b : LEA EDX,[EAX + 0x1]
0050068e : MOV EDI,EDI
00500690 : MOV BL,byte ptr [EAX]
00500692 : INC EAX
00500693 : TEST BL,BL
00500695 : JNZ 0x00500690
00500697 : PUSH 0x0
00500699 : SUB EAX,EDX
0050069b : PUSH EAX
0050069c : PUSH EBP
0050069d : ADD ECX,0x24c
005006a3 : CALL 0x00525380
005006a8 : MOV EDX,dword ptr [ESP + 0x20]
005006ac : LEA ECX,[ESP + 0x13]
005006b0 : PUSH ECX
005006b1 : PUSH EDX
005006b2 : MOV dword ptr [ESP + 0x20],EAX
005006b6 : INC dword ptr [EAX + 0x8]
005006b9 : MOV EAX,dword ptr [ESI]
005006bb : MOV EDX,dword ptr [EAX + 0x28]
005006be : LEA ECX,[ESP + 0x20]
005006c2 : PUSH ECX
005006c3 : PUSH EDI
005006c4 : MOV ECX,ESI
005006c6 : CALL EDX
005006c8 : MOV BL,AL
005006ca : MOV EAX,dword ptr [ESP + 0x18]
005006ce : DEC dword ptr [EAX + 0x8]
005006d1 : MOV ECX,EAX
005006d3 : ADD EAX,0x8
005006d6 : CMP dword ptr [EAX],0x0
005006d9 : JNZ 0x005006e0
005006db : CALL 0x00525340
005006e0 : POP EDI
005006e1 : POP ESI
005006e2 : POP EBP
005006e3 : MOV AL,BL
005006e5 : POP EBX
005006e6 : POP ECX
005006e7 : RET 0xc

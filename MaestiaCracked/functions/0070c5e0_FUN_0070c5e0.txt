PROGRAM  : Maestia.exe
FUNCTION : FUN_0070c5e0
ENTRY    : 0070c5e0
BODY     : [[0070c5e0, 0070c73a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0070c5e0(int param_1)

{
  wchar_t *_FullPath;
  uint local_a48;
  uint local_a2c;
  wchar_t local_a20 [1024];
  wchar_t local_220 [128];
  wchar_t local_120 [128];
  wchar_t local_20 [6];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1775a;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(uint *)(param_1 + 0x14) < 0x401) {
    if (*(uint *)(param_1 + 0x18) < 8) {
      _FullPath = (wchar_t *)(param_1 + 4);
    }
    else {
      _FullPath = *(wchar_t **)(param_1 + 4);
    }
    __wsplitpath(_FullPath,local_20,local_a20,local_220,local_120);
    FUN_00406460(local_120);
    local_8 = 1;
    FUN_00406460(local_220);
    local_8._0_1_ = 2;
    FUN_00403450();
    local_8 = CONCAT31(local_8._1_3_,1);
    if (7 < local_a2c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_a48) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  else {
    FUN_00406460(&DAT_00bfd770);
    local_8 = 0;
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0070c5e0 : PUSH EBP
0070c5e1 : MOV EBP,ESP
0070c5e3 : PUSH -0x1
0070c5e5 : PUSH 0xb1775a
0070c5ea : MOV EAX,FS:[0x0]
0070c5f0 : PUSH EAX
0070c5f1 : SUB ESP,0xa50
0070c5f7 : MOV EAX,[0x00d66fa0]
0070c5fc : XOR EAX,EBP
0070c5fe : MOV dword ptr [EBP + -0x10],EAX
0070c601 : PUSH EBX
0070c602 : PUSH EDI
0070c603 : PUSH EAX
0070c604 : LEA EAX,[EBP + -0xc]
0070c607 : MOV FS:[0x0],EAX
0070c60d : MOV EAX,dword ptr [EBP + 0x8]
0070c610 : XOR EDI,EDI
0070c612 : MOV dword ptr [EBP + 0xfffff5e0],EDI
0070c618 : CMP dword ptr [EAX + 0x14],0x400
0070c61f : MOV dword ptr [EBP + 0xfffff5dc],ESI
0070c625 : JBE 0x0070c645
0070c627 : PUSH 0xbfd770
0070c62c : MOV ECX,ESI
0070c62e : CALL 0x00406460
0070c633 : MOV dword ptr [EBP + -0x4],EDI
0070c636 : MOV dword ptr [EBP + 0xfffff5e0],0x1
0070c640 : JMP 0x0070c71e
0070c645 : CMP dword ptr [EAX + 0x18],0x8
0070c649 : JC 0x0070c650
0070c64b : MOV EAX,dword ptr [EAX + 0x4]
0070c64e : JMP 0x0070c653
0070c650 : ADD EAX,0x4
0070c653 : LEA ECX,[EBP + 0xfffffee4]
0070c659 : PUSH ECX
0070c65a : LEA EDX,[EBP + 0xfffffde4]
0070c660 : PUSH EDX
0070c661 : LEA ECX,[EBP + 0xfffff5e4]
0070c667 : PUSH ECX
0070c668 : LEA EDX,[EBP + -0x1c]
0070c66b : PUSH EDX
0070c66c : PUSH EAX
0070c66d : CALL 0x00636e00
0070c672 : ADD ESP,0x14
0070c675 : LEA EAX,[EBP + 0xfffffee4]
0070c67b : PUSH EAX
0070c67c : LEA ECX,[EBP + 0xfffff5a4]
0070c682 : CALL 0x00406460
0070c687 : MOV EDI,EAX
0070c689 : MOV EBX,0x1
0070c68e : MOV dword ptr [EBP + -0x4],EBX
0070c691 : LEA ECX,[EBP + 0xfffffde4]
0070c697 : PUSH ECX
0070c698 : LEA ECX,[EBP + 0xfffff5c0]
0070c69e : CALL 0x00406460
0070c6a3 : MOV byte ptr [EBP + -0x4],0x2
0070c6a7 : PUSH EDI
0070c6a8 : PUSH ESI
0070c6a9 : MOV ECX,EAX
0070c6ab : CALL 0x00403450
0070c6b0 : ADD ESP,0x8
0070c6b3 : MOV dword ptr [EBP + 0xfffff5e0],EBX
0070c6b9 : MOV byte ptr [EBP + -0x4],BL
0070c6bc : MOV EDI,0x8
0070c6c1 : CMP dword ptr [EBP + 0xfffff5d8],EDI
0070c6c7 : JC 0x0070c6d4
0070c6c9 : MOV ECX,dword ptr [EBP + 0xfffff5c4]
0070c6cf : CALL 0x006f04e0
0070c6d4 : XOR EDX,EDX
0070c6d6 : XOR EBX,EBX
0070c6d8 : MOV dword ptr [EBP + 0xfffff5d8],0x7
0070c6e2 : MOV dword ptr [EBP + 0xfffff5d4],EBX
0070c6e8 : MOV word ptr [EBP + 0xfffff5c4],DX
0070c6ef : MOV byte ptr [EBP + -0x4],DL
0070c6f2 : CMP dword ptr [EBP + 0xfffff5bc],EDI
0070c6f8 : JC 0x0070c705
0070c6fa : MOV ECX,dword ptr [EBP + 0xfffff5a8]
0070c700 : CALL 0x006f04e0
0070c705 : XOR EAX,EAX
0070c707 : MOV dword ptr [EBP + 0xfffff5bc],0x7
0070c711 : MOV dword ptr [EBP + 0xfffff5b8],EBX
0070c717 : MOV word ptr [EBP + 0xfffff5a8],AX
0070c71e : MOV EAX,ESI
0070c720 : MOV ECX,dword ptr [EBP + -0xc]
0070c723 : MOV dword ptr FS:[0x0],ECX
0070c72a : POP ECX
0070c72b : POP EDI
0070c72c : POP EBX
0070c72d : MOV ECX,dword ptr [EBP + -0x10]
0070c730 : XOR ECX,EBP
0070c732 : CALL 0x00633e6b
0070c737 : MOV ESP,EBP
0070c739 : POP EBP
0070c73a : RET

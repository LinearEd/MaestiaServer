PROGRAM  : Maestia.exe
FUNCTION : FUN_0042fe80
ENTRY    : 0042fe80
BODY     : [[0042fe80, 0042ffa3] [0042ffb5, 0043006a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0042fe80(uint param_1,void *param_2)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  uint uVar6;
  uint extraout_ECX;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  iVar3 = param_1;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7b980;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  iVar4 = *(int *)(param_1 + 4);
  if (iVar4 == 0) {
    uVar6 = 0;
  }
  else {
    uVar6 = *(int *)(param_1 + 0xc) - iVar4 >> 2;
  }
  iVar2 = *(int *)(param_1 + 8);
  iVar4 = iVar2 - iVar4 >> 2;
  if (iVar4 == 0x3fffffff) {
    iVar4 = FUN_00429be0();
    uVar6 = extraout_ECX;
  }
  uVar1 = iVar4 + 1;
  if (uVar1 <= uVar6) {
    if (iVar2 - (int)param_2 >> 2 == 0) {
      FUN_00461070();
      local_8 = 2;
      FUN_004154b0();
      local_8 = 0xffffffff;
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 4;
    }
    else {
      uVar5 = FUN_00461070();
      *(undefined4 *)(param_1 + 8) = uVar5;
      iVar4 = (iVar2 + -4) - (int)param_2 >> 2;
      if (0 < iVar4) {
        _memmove_s((void *)(iVar2 + iVar4 * -4),iVar4 * 4,param_2,iVar4 * 4);
      }
    }
    FUN_00422490(param_2);
    ExceptionList = local_10;
    return;
  }
  if (0x3fffffff - (uVar6 >> 1) < uVar6) {
    param_1 = 0;
  }
  else {
    param_1 = uVar6 + (uVar6 >> 1);
  }
  if (param_1 < uVar1) {
    param_1 = uVar1;
  }
  iVar4 = FUN_004c1790();
  local_8 = 0;
  FUN_004154b0();
  FUN_00461070();
  FUN_00461070();
  local_8 = 0xffffffff;
  if (*(int *)(iVar3 + 4) == 0) {
    *(uint *)(iVar3 + 0xc) = iVar4 + param_1 * 4;
    *(int *)(iVar3 + 8) = iVar4 + ((*(int *)(iVar3 + 8) - *(int *)(iVar3 + 4) >> 2) + 1) * 4;
    *(int *)(iVar3 + 4) = iVar4;
    ExceptionList = local_10;
    return;
  }
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
0042fe80 : PUSH EBP
0042fe81 : MOV EBP,ESP
0042fe83 : PUSH -0x1
0042fe85 : PUSH 0xb7b980
0042fe8a : MOV EAX,FS:[0x0]
0042fe90 : PUSH EAX
0042fe91 : SUB ESP,0x10
0042fe94 : PUSH EBX
0042fe95 : PUSH ESI
0042fe96 : PUSH EDI
0042fe97 : MOV EAX,[0x00d66fa0]
0042fe9c : XOR EAX,EBP
0042fe9e : PUSH EAX
0042fe9f : LEA EAX,[EBP + -0xc]
0042fea2 : MOV FS:[0x0],EAX
0042fea8 : MOV dword ptr [EBP + -0x10],ESP
0042feab : MOV EBX,dword ptr [EBP + 0x8]
0042feae : MOV EDX,dword ptr [EBX + 0x4]
0042feb1 : XOR EDI,EDI
0042feb3 : CMP EDX,EDI
0042feb5 : JNZ 0x0042febb
0042feb7 : XOR ECX,ECX
0042feb9 : JMP 0x0042fec5
0042febb : MOV EAX,dword ptr [EBX + 0xc]
0042febe : SUB EAX,EDX
0042fec0 : SAR EAX,0x2
0042fec3 : MOV ECX,EAX
0042fec5 : MOV ESI,dword ptr [EBX + 0x8]
0042fec8 : MOV EAX,ESI
0042feca : SUB EAX,EDX
0042fecc : SAR EAX,0x2
0042fecf : MOV EDX,0x3fffffff
0042fed4 : SUB EDX,EAX
0042fed6 : CMP EDX,0x1
0042fed9 : JNC 0x0042fee0
0042fedb : CALL 0x00429be0
0042fee0 : LEA EDX,[EAX + 0x1]
0042fee3 : CMP ECX,EDX
0042fee5 : JNC 0x0042ffb5
0042feeb : MOV EAX,ECX
0042feed : SHR EAX,0x1
0042feef : MOV ESI,0x3fffffff
0042fef4 : SUB ESI,EAX
0042fef6 : CMP ESI,ECX
0042fef8 : JNC 0x0042ff01
0042fefa : MOV dword ptr [EBP + 0x8],EDI
0042fefd : MOV ECX,EDI
0042feff : JMP 0x0042ff06
0042ff01 : ADD ECX,EAX
0042ff03 : MOV dword ptr [EBP + 0x8],ECX
0042ff06 : CMP ECX,EDX
0042ff08 : JNC 0x0042ff0f
0042ff0a : MOV dword ptr [EBP + 0x8],EDX
0042ff0d : MOV ECX,EDX
0042ff0f : CALL 0x004c1790
0042ff14 : MOV dword ptr [EBP + -0x14],EAX
0042ff17 : MOV ECX,dword ptr [EBP + 0xc]
0042ff1a : SUB ECX,dword ptr [EBX + 0x4]
0042ff1d : SAR ECX,0x2
0042ff20 : MOV dword ptr [EBP + -0x1c],ECX
0042ff23 : MOV dword ptr [EBP + -0x4],EDI
0042ff26 : LEA EDI,[EAX + ECX*0x4]
0042ff29 : MOV EDX,dword ptr [EBP + 0x10]
0042ff2c : MOV ESI,0x1
0042ff31 : CALL 0x004154b0
0042ff36 : MOV dword ptr [EBP + -0x18],ESI
0042ff39 : MOV ESI,dword ptr [EBP + -0x14]
0042ff3c : MOV EDX,ESI
0042ff3e : MOV EAX,dword ptr [EBP + 0xc]
0042ff41 : MOV EDI,dword ptr [EBX + 0x4]
0042ff44 : CALL 0x00461070
0042ff49 : MOV dword ptr [EBP + -0x18],0x2
0042ff50 : MOV EAX,dword ptr [EBP + -0x1c]
0042ff53 : LEA EDX,[ESI + EAX*0x4 + 0x4]
0042ff57 : MOV EAX,dword ptr [EBX + 0x8]
0042ff5a : MOV EDI,dword ptr [EBP + 0xc]
0042ff5d : CALL 0x00461070
0042ff62 : MOV dword ptr [EBP + -0x4],0xffffffff
0042ff69 : MOV ECX,dword ptr [EBX + 0x4]
0042ff6c : MOV EDI,dword ptr [EBX + 0x8]
0042ff6f : SUB EDI,ECX
0042ff71 : SAR EDI,0x2
0042ff74 : INC EDI
0042ff75 : TEST ECX,ECX
0042ff77 : JZ 0x0042ff7e
0042ff79 : CALL 0x006f04e0
0042ff7e : MOV ECX,dword ptr [EBP + 0x8]
0042ff81 : LEA EDX,[ESI + ECX*0x4]
0042ff84 : MOV dword ptr [EBX + 0xc],EDX
0042ff87 : LEA EAX,[ESI + EDI*0x4]
0042ff8a : MOV dword ptr [EBX + 0x8],EAX
0042ff8d : MOV dword ptr [EBX + 0x4],ESI
0042ff90 : MOV ECX,dword ptr [EBP + -0xc]
0042ff93 : MOV dword ptr FS:[0x0],ECX
0042ff9a : POP ECX
0042ff9b : POP EDI
0042ff9c : POP ESI
0042ff9d : POP EBX
0042ff9e : MOV ESP,EBP
0042ffa0 : POP EBP
0042ffa1 : RET 0xc
0042ffb5 : MOV ECX,ESI
0042ffb7 : MOV EDI,dword ptr [EBP + 0xc]
0042ffba : SUB ECX,EDI
0042ffbc : SAR ECX,0x2
0042ffbf : CMP ECX,0x1
0042ffc2 : JNC 0x0043000d
0042ffc4 : MOV EDX,dword ptr [EBP + 0x10]
0042ffc7 : MOV EAX,dword ptr [EDX]
0042ffc9 : MOV dword ptr [EBP + 0x10],EAX
0042ffcc : LEA EDX,[EDI + 0x4]
0042ffcf : MOV EAX,ESI
0042ffd1 : CALL 0x00461070
0042ffd6 : MOV dword ptr [EBP + -0x4],0x2
0042ffdd : MOV EDI,dword ptr [EBX + 0x8]
0042ffe0 : MOV ECX,EDI
0042ffe2 : SUB ECX,dword ptr [EBP + 0xc]
0042ffe5 : SAR ECX,0x2
0042ffe8 : MOV ESI,0x1
0042ffed : SUB ESI,ECX
0042ffef : LEA EDX,[EBP + 0x10]
0042fff2 : CALL 0x004154b0
0042fff7 : MOV dword ptr [EBP + -0x4],0xffffffff
0042fffe : ADD dword ptr [EBX + 0x8],0x4
00430002 : MOV EBX,dword ptr [EBX + 0x8]
00430005 : LEA ECX,[EBX + -0x4]
00430008 : MOV EDX,dword ptr [EBP + 0xc]
0043000b : JMP 0x0043004b
0043000d : MOV EAX,dword ptr [EBP + 0x10]
00430010 : MOV ECX,dword ptr [EAX]
00430012 : MOV dword ptr [EBP + 0x10],ECX
00430015 : LEA EDI,[ESI + -0x4]
00430018 : MOV EDX,ESI
0043001a : MOV EAX,ESI
0043001c : CALL 0x00461070
00430021 : MOV dword ptr [EBX + 0x8],EAX
00430024 : MOV EDX,dword ptr [EBP + 0xc]
00430027 : SUB EDI,EDX
00430029 : SAR EDI,0x2
0043002c : TEST EDI,EDI
0043002e : JLE 0x00430048
00430030 : LEA EAX,[EDI*0x4 + 0x0]
00430037 : PUSH EAX
00430038 : PUSH EDX
00430039 : PUSH EAX
0043003a : SUB ESI,EAX
0043003c : PUSH ESI
0043003d : CALL 0x00634101
00430042 : ADD ESP,0x10
00430045 : MOV EDX,dword ptr [EBP + 0xc]
00430048 : LEA ECX,[EDX + 0x4]
0043004b : PUSH EDX
0043004c : LEA EDX,[EBP + 0x10]
0043004f : CALL 0x00422490
00430054 : ADD ESP,0x4
00430057 : MOV ECX,dword ptr [EBP + -0xc]
0043005a : MOV dword ptr FS:[0x0],ECX
00430061 : POP ECX
00430062 : POP EDI
00430063 : POP ESI
00430064 : POP EBX
00430065 : MOV ESP,EBP
00430067 : POP EBP
00430068 : RET 0xc

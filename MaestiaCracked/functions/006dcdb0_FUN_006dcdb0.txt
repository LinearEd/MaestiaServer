PROGRAM  : Maestia.exe
FUNCTION : FUN_006dcdb0
ENTRY    : 006dcdb0
BODY     : [[006dcdb0, 006dcfc2]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006dcdb0(int *param_1,char param_2,int param_3,int *param_4)

{
  int *piVar1;
  char cVar2;
  int iVar3;
  char *pcVar4;
  int iVar5;
  void *_Dst;
  uint uVar6;
  int iVar7;
  int iVar8;
  int local_51c;
  int iStack_518;
  int iStack_514;
  int *local_510;
  int aiStack_50c [257];
  char acStack_108 [260];
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)&local_51c;
  local_510 = param_1;
  if ((param_3 < 0) || (3 < param_3)) {
    *(undefined4 *)(*param_1 + 0x14) = 0x32;
    *(int *)(*param_1 + 0x18) = param_3;
    (**(code **)*param_1)(param_1);
  }
  if (param_2 == '\0') {
    local_51c = param_1[param_3 + 0x1a];
  }
  else {
    local_51c = param_1[param_3 + 0x16];
  }
  if (local_51c == 0) {
    *(undefined4 *)(*param_1 + 0x14) = 0x32;
    *(int *)(*param_1 + 0x18) = param_3;
    (**(code **)*param_1)(param_1);
  }
  if (*param_4 == 0) {
    iVar3 = (**(code **)param_1[1])(param_1,1,0x500);
    *param_4 = iVar3;
  }
  iStack_514 = *param_4;
  iVar8 = 0;
  iVar3 = 1;
  do {
    uVar6 = (uint)*(byte *)(iVar3 + local_51c);
    if (0x100 < (int)(uVar6 + iVar8)) {
      *(undefined4 *)(*param_1 + 0x14) = 8;
      (**(code **)*param_1)(param_1);
    }
    if (uVar6 != 0) {
      _memset(acStack_108 + iVar8,iVar3,uVar6);
      iVar8 = iVar8 + uVar6;
    }
    iVar3 = iVar3 + 1;
  } while (iVar3 < 0x11);
  acStack_108[iVar8] = '\0';
  iVar3 = 0;
  iVar7 = 0;
  iVar5 = (int)acStack_108[0];
  iStack_518 = iVar8;
  if (acStack_108[0] != '\0') {
    pcVar4 = acStack_108;
    do {
      cVar2 = *pcVar4;
      while (cVar2 == iVar5) {
        cVar2 = acStack_108[iVar7 + 1];
        aiStack_50c[iVar7] = iVar3;
        iVar7 = iVar7 + 1;
        iVar3 = iVar3 + 1;
      }
      if (1 << ((byte)iVar5 & 0x1f) <= iVar3) {
        *(undefined4 *)(*param_1 + 0x14) = 8;
        (**(code **)*param_1)(param_1);
      }
      pcVar4 = acStack_108 + iVar7;
      iVar3 = iVar3 * 2;
      iVar5 = iVar5 + 1;
    } while (*pcVar4 != '\0');
  }
  _Dst = (void *)(iStack_514 + 0x400);
  _memset(_Dst,0,0x100);
  iVar3 = 0;
  if (0 < iStack_518) {
    do {
      uVar6 = (uint)*(byte *)(local_51c + 0x11 + iVar3);
      if (((int)((-(uint)(param_2 != '\0') & 0xffffff10) + 0xff) < (int)uVar6) ||
         (*(char *)(uVar6 + (int)_Dst) != '\0')) {
        *(undefined4 *)(*local_510 + 0x14) = 8;
        (**(code **)*local_510)(local_510);
      }
      piVar1 = aiStack_50c + iVar3;
      cVar2 = acStack_108[iVar3];
      iVar3 = iVar3 + 1;
      *(int *)(iStack_514 + uVar6 * 4) = *piVar1;
      *(char *)(uVar6 + (int)_Dst) = cVar2;
    } while (iVar3 < iStack_518);
  }
  __security_check_cookie(local_4 ^ (uint)&local_51c);
  return;
}



============================================================
DISASSEMBLY
============================================================
006dcdb0 : SUB ESP,0x51c
006dcdb6 : MOV EAX,[0x00d66fa0]
006dcdbb : XOR EAX,ESP
006dcdbd : MOV dword ptr [ESP + 0x518],EAX
006dcdc4 : PUSH EBX
006dcdc5 : PUSH EBP
006dcdc6 : MOV EBP,dword ptr [ESP + 0x528]
006dcdcd : PUSH ESI
006dcdce : MOV ESI,dword ptr [ESP + 0x534]
006dcdd5 : PUSH EDI
006dcdd6 : MOV EDI,dword ptr [ESP + 0x53c]
006dcddd : MOV dword ptr [ESP + 0x1c],EBP
006dcde1 : MOV EBX,0x32
006dcde6 : TEST ESI,ESI
006dcde8 : JL 0x006dcdef
006dcdea : CMP ESI,0x4
006dcded : JL 0x006dce06
006dcdef : MOV EAX,dword ptr [EBP]
006dcdf2 : MOV dword ptr [EAX + 0x14],EBX
006dcdf5 : MOV ECX,dword ptr [EBP]
006dcdf8 : MOV dword ptr [ECX + 0x18],ESI
006dcdfb : MOV EDX,dword ptr [EBP]
006dcdfe : MOV EAX,dword ptr [EDX]
006dce00 : PUSH EBP
006dce01 : CALL EAX
006dce03 : ADD ESP,0x4
006dce06 : CMP byte ptr [ESP + 0x534],0x0
006dce0e : JZ 0x006dce1a
006dce10 : MOV ECX,dword ptr [EBP + ESI*0x4 + 0x58]
006dce14 : MOV dword ptr [ESP + 0x10],ECX
006dce18 : JMP 0x006dce22
006dce1a : MOV EDX,dword ptr [EBP + ESI*0x4 + 0x68]
006dce1e : MOV dword ptr [ESP + 0x10],EDX
006dce22 : CMP dword ptr [ESP + 0x10],0x0
006dce27 : JNZ 0x006dce40
006dce29 : MOV EAX,dword ptr [EBP]
006dce2c : MOV dword ptr [EAX + 0x14],EBX
006dce2f : MOV ECX,dword ptr [EBP]
006dce32 : MOV dword ptr [ECX + 0x18],ESI
006dce35 : MOV EDX,dword ptr [EBP]
006dce38 : MOV EAX,dword ptr [EDX]
006dce3a : PUSH EBP
006dce3b : CALL EAX
006dce3d : ADD ESP,0x4
006dce40 : CMP dword ptr [EDI],0x0
006dce43 : JNZ 0x006dce59
006dce45 : MOV ECX,dword ptr [EBP + 0x4]
006dce48 : MOV EDX,dword ptr [ECX]
006dce4a : PUSH 0x500
006dce4f : PUSH 0x1
006dce51 : PUSH EBP
006dce52 : CALL EDX
006dce54 : ADD ESP,0xc
006dce57 : MOV dword ptr [EDI],EAX
006dce59 : MOV EAX,dword ptr [EDI]
006dce5b : MOV dword ptr [ESP + 0x18],EAX
006dce5f : XOR EDI,EDI
006dce61 : MOV EBX,0x1
006dce66 : MOV ECX,dword ptr [ESP + 0x10]
006dce6a : MOVZX ESI,byte ptr [EBX + ECX*0x1]
006dce6e : TEST ESI,ESI
006dce70 : JL 0x006dce7d
006dce72 : LEA EDX,[ESI + EDI*0x1]
006dce75 : CMP EDX,0x100
006dce7b : JLE 0x006dce92
006dce7d : MOV EAX,dword ptr [EBP]
006dce80 : MOV dword ptr [EAX + 0x14],0x8
006dce87 : MOV ECX,dword ptr [EBP]
006dce8a : MOV EDX,dword ptr [ECX]
006dce8c : PUSH EBP
006dce8d : CALL EDX
006dce8f : ADD ESP,0x4
006dce92 : TEST ESI,ESI
006dce94 : JZ 0x006dceaa
006dce96 : PUSH ESI
006dce97 : LEA EAX,[ESP + EDI*0x1 + 0x428]
006dce9e : PUSH EBX
006dce9f : PUSH EAX
006dcea0 : CALL 0x0063b700
006dcea5 : ADD ESP,0xc
006dcea8 : ADD EDI,ESI
006dceaa : INC EBX
006dceab : CMP EBX,0x10
006dceae : JLE 0x006dce66
006dceb0 : MOV byte ptr [ESP + EDI*0x1 + 0x424],0x0
006dceb8 : MOV AL,byte ptr [ESP + 0x424]
006dcebf : MOV dword ptr [ESP + 0x14],EDI
006dcec3 : XOR EDI,EDI
006dcec5 : XOR ESI,ESI
006dcec7 : MOVSX EBX,AL
006dceca : TEST AL,AL
006dcecc : JZ 0x006dcf23
006dcece : LEA EAX,[ESP + 0x424]
006dced5 : MOVSX EAX,byte ptr [EAX]
006dced8 : CMP EAX,EBX
006dceda : JNZ 0x006dcef2
006dcedc : LEA ESP,[ESP]
006dcee0 : MOVSX ECX,byte ptr [ESP + ESI*0x1 + 0x425]
006dcee8 : MOV dword ptr [ESP + ESI*0x4 + 0x20],EDI
006dceec : INC ESI
006dceed : INC EDI
006dceee : CMP ECX,EBX
006dcef0 : JZ 0x006dcee0
006dcef2 : MOV EDX,0x1
006dcef7 : MOV ECX,EBX
006dcef9 : SHL EDX,CL
006dcefb : CMP EDI,EDX
006dcefd : JL 0x006dcf14
006dceff : MOV EAX,dword ptr [EBP]
006dcf02 : MOV dword ptr [EAX + 0x14],0x8
006dcf09 : MOV ECX,dword ptr [EBP]
006dcf0c : MOV EDX,dword ptr [ECX]
006dcf0e : PUSH EBP
006dcf0f : CALL EDX
006dcf11 : ADD ESP,0x4
006dcf14 : LEA EAX,[ESP + ESI*0x1 + 0x424]
006dcf1b : ADD EDI,EDI
006dcf1d : INC EBX
006dcf1e : CMP byte ptr [EAX],0x0
006dcf21 : JNZ 0x006dced5
006dcf23 : MOV EBP,dword ptr [ESP + 0x18]
006dcf27 : PUSH 0x100
006dcf2c : ADD EBP,0x400
006dcf32 : PUSH 0x0
006dcf34 : PUSH EBP
006dcf35 : CALL 0x0063b700
006dcf3a : MOVZX EBX,byte ptr [ESP + 0x540]
006dcf42 : ADD ESP,0xc
006dcf45 : NEG EBX
006dcf47 : SBB EBX,EBX
006dcf49 : AND EBX,0xffffff10
006dcf4f : XOR ESI,ESI
006dcf51 : ADD EBX,0xff
006dcf57 : CMP dword ptr [ESP + 0x14],ESI
006dcf5b : JLE 0x006dcfaa
006dcf5d : LEA ECX,[ECX]
006dcf60 : MOV EAX,dword ptr [ESP + 0x10]
006dcf64 : MOVZX EDI,byte ptr [EAX + ESI*0x1 + 0x11]
006dcf69 : TEST EDI,EDI
006dcf6b : JL 0x006dcf77
006dcf6d : CMP EDI,EBX
006dcf6f : JG 0x006dcf77
006dcf71 : CMP byte ptr [EDI + EBP*0x1],0x0
006dcf75 : JZ 0x006dcf8e
006dcf77 : MOV EAX,dword ptr [ESP + 0x1c]
006dcf7b : MOV ECX,dword ptr [EAX]
006dcf7d : MOV dword ptr [ECX + 0x14],0x8
006dcf84 : MOV EDX,dword ptr [EAX]
006dcf86 : PUSH EAX
006dcf87 : MOV EAX,dword ptr [EDX]
006dcf89 : CALL EAX
006dcf8b : ADD ESP,0x4
006dcf8e : MOV ECX,dword ptr [ESP + ESI*0x4 + 0x20]
006dcf92 : MOV AL,byte ptr [ESP + ESI*0x1 + 0x424]
006dcf99 : MOV EDX,dword ptr [ESP + 0x18]
006dcf9d : INC ESI
006dcf9e : CMP ESI,dword ptr [ESP + 0x14]
006dcfa2 : MOV dword ptr [EDX + EDI*0x4],ECX
006dcfa5 : MOV byte ptr [EDI + EBP*0x1],AL
006dcfa8 : JL 0x006dcf60
006dcfaa : MOV ECX,dword ptr [ESP + 0x528]
006dcfb1 : POP EDI
006dcfb2 : POP ESI
006dcfb3 : POP EBP
006dcfb4 : POP EBX
006dcfb5 : XOR ECX,ESP
006dcfb7 : CALL 0x00633e6b
006dcfbc : ADD ESP,0x51c
006dcfc2 : RET

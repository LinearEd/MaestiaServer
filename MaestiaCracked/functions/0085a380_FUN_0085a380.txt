PROGRAM  : Maestia.exe
FUNCTION : FUN_0085a380
ENTRY    : 0085a380
BODY     : [[0085a380, 0085a6d1]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0085a380(int param_1,int param_2,undefined4 param_3,undefined2 param_4)

{
  uint *puVar1;
  uint *puVar2;
  short sVar3;
  uint uVar4;
  int iVar5;
  int in_ECX;
  uint *puVar6;
  undefined4 in_stack_00000020;
  uint in_stack_00000024;
  uint local_78;
  int local_74;
  int local_70;
  undefined4 local_6c;
  undefined4 local_68;
  undefined1 local_64 [4];
  uint *local_60;
  uint *local_5c;
  int local_58;
  char local_51;
  undefined1 local_50 [28];
  undefined1 local_34 [4];
  undefined2 local_30;
  undefined4 local_20;
  uint local_1c;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  puStack_c = &LAB_00b3456c;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_68 = 0;
  local_8 = 1;
  local_1c = 7;
  local_20 = 0;
  local_30 = 0;
  local_18 = uVar4;
  FUN_00405eb0(&param_3,0,0xffffffff);
  local_8._0_1_ = 2;
  if (in_ECX == 0) {
    *(undefined4 *)(param_2 + 0x18) = 7;
    *(undefined4 *)(param_2 + 0x14) = 0;
    *(undefined2 *)(param_2 + 4) = 0;
    FUN_00405eb0(local_34,0,0xffffffff);
    local_68 = 1;
    local_8 = CONCAT31(local_8._1_3_,1);
    if (7 < local_1c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_1c = 7;
    local_20 = 0;
    local_30 = 0;
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < in_stack_00000024) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    in_stack_00000024 = 7;
    in_stack_00000020 = 0;
    param_4 = 0;
  }
  else {
    local_60 = (uint *)0x0;
    local_5c = (uint *)0x0;
    local_58 = 0;
    local_8 = CONCAT31(local_8._1_3_,3);
    FUN_00443b50(uVar4);
    local_6c = *(undefined4 *)(param_1 + 0x16d8);
    local_74 = in_ECX + 0x128;
    local_51 = '\0';
    local_70 = (**(code **)(*(int *)(in_ECX + 0x128) + 4))();
    puVar1 = local_60;
    puVar2 = local_5c;
joined_r0x0085a49a:
    if (local_70 != 0) {
      iVar5 = FUN_004f5680();
      if (iVar5 != 0) {
        if (puVar1 != puVar2) {
          puVar6 = puVar1;
          do {
            if (*puVar6 == (uint)*(ushort *)(iVar5 + 6)) {
              if (puVar2 != puVar6) goto joined_r0x0085a49a;
              break;
            }
            puVar6 = puVar6 + 1;
          } while (puVar6 != puVar2);
        }
        if (*(ushort *)(iVar5 + 6) == (ushort)local_6c) {
          local_51 = '\x01';
        }
        local_78 = (uint)*(ushort *)(iVar5 + 6);
        if (puVar1 == (uint *)0x0) {
          uVar4 = 0;
        }
        else {
          uVar4 = local_58 - (int)puVar1 >> 2;
        }
        if ((uint)((int)puVar2 - (int)puVar1 >> 2) < uVar4) {
          *puVar2 = local_78;
          local_5c = puVar2 + 1;
          puVar2 = local_5c;
        }
        else {
          FUN_00408c10(local_64,puVar2,1,&local_78);
          puVar1 = local_60;
          puVar2 = local_5c;
        }
      }
      goto joined_r0x0085a49a;
    }
    if (((uint)((int)puVar2 - (int)puVar1 >> 2) < 2) || (local_51 == '\0')) {
      *(undefined4 *)(param_2 + 0x18) = 7;
      *(undefined4 *)(param_2 + 0x14) = 0;
      *(undefined2 *)(param_2 + 4) = 0;
      FUN_00405eb0(local_34,0,0xffffffff);
      local_68 = 1;
      local_8 = CONCAT31(local_8._1_3_,2);
      if (puVar1 != (uint *)0x0) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_60 = (uint *)0x0;
      local_5c = (uint *)0x0;
      local_58 = 0;
      local_8 = CONCAT31(local_8._1_3_,1);
      if (7 < local_1c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_1c = 7;
      local_20 = 0;
      local_30 = 0;
      local_8 = (uint)local_8._1_3_ << 8;
      if (7 < in_stack_00000024) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      in_stack_00000024 = 7;
      in_stack_00000020 = 0;
      param_4 = 0;
    }
    else {
      iVar5 = FUN_00407c10(L"cgne_",5);
      if (iVar5 != -1) {
        FUN_00406460(&DAT_00c400ec);
        local_8._0_1_ = 4;
        sVar3 = (short)local_6c;
        if ((((sVar3 == 1) || (sVar3 == 2)) || (sVar3 == 3)) || (sVar3 == 4)) {
          FUN_00405c00(local_50);
        }
        FUN_00408540(local_34,4,local_50,0);
        local_8 = CONCAT31(local_8._1_3_,3);
        FUN_00406560();
      }
      FUN_00405660(local_34);
      local_68 = 1;
      local_8 = CONCAT31(local_8._1_3_,2);
      if (puVar1 != (uint *)0x0) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_60 = (uint *)0x0;
      local_5c = (uint *)0x0;
      local_58 = 0;
      local_8._0_1_ = 1;
      FUN_00406560();
      local_8 = (uint)local_8._1_3_ << 8;
      FUN_00406560();
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0085a380 : PUSH EBP
0085a381 : MOV EBP,ESP
0085a383 : PUSH -0x1
0085a385 : PUSH 0xb3456c
0085a38a : MOV EAX,FS:[0x0]
0085a390 : PUSH EAX
0085a391 : SUB ESP,0x70
0085a394 : MOV EAX,[0x00d66fa0]
0085a399 : XOR EAX,EBP
0085a39b : MOV dword ptr [EBP + -0x14],EAX
0085a39e : PUSH EBX
0085a39f : PUSH ESI
0085a3a0 : PUSH EDI
0085a3a1 : PUSH EAX
0085a3a2 : LEA EAX,[EBP + -0xc]
0085a3a5 : MOV FS:[0x0],EAX
0085a3ab : MOV EBX,dword ptr [EBP + 0xc]
0085a3ae : XOR EDI,EDI
0085a3b0 : MOV dword ptr [EBP + -0x78],EBX
0085a3b3 : MOV ESI,ECX
0085a3b5 : MOV dword ptr [EBP + -0x64],EDI
0085a3b8 : MOV dword ptr [EBP + -0x4],0x1
0085a3bf : PUSH -0x1
0085a3c1 : PUSH EDI
0085a3c2 : LEA ECX,[EBP + 0x10]
0085a3c5 : XOR EAX,EAX
0085a3c7 : PUSH ECX
0085a3c8 : LEA ECX,[EBP + -0x30]
0085a3cb : MOV dword ptr [EBP + -0x18],0x7
0085a3d2 : MOV dword ptr [EBP + -0x1c],EDI
0085a3d5 : MOV word ptr [EBP + -0x2c],AX
0085a3d9 : CALL 0x00405eb0
0085a3de : MOV byte ptr [EBP + -0x4],0x2
0085a3e2 : CMP ESI,EDI
0085a3e4 : JNZ 0x0085a456
0085a3e6 : PUSH -0x1
0085a3e8 : PUSH EDI
0085a3e9 : LEA EAX,[EBP + -0x30]
0085a3ec : XOR EDX,EDX
0085a3ee : MOV dword ptr [EBX + 0x18],0x7
0085a3f5 : MOV dword ptr [EBX + 0x14],EDI
0085a3f8 : PUSH EAX
0085a3f9 : MOV ECX,EBX
0085a3fb : MOV word ptr [EBX + 0x4],DX
0085a3ff : CALL 0x00405eb0
0085a404 : MOV dword ptr [EBP + -0x64],0x1
0085a40b : MOV byte ptr [EBP + -0x4],0x1
0085a40f : MOV ESI,0x8
0085a414 : CMP dword ptr [EBP + -0x18],ESI
0085a417 : JC 0x0085a421
0085a419 : MOV ECX,dword ptr [EBP + -0x2c]
0085a41c : CALL 0x006f04e0
0085a421 : XOR ECX,ECX
0085a423 : MOV dword ptr [EBP + -0x18],0x7
0085a42a : MOV dword ptr [EBP + -0x1c],EDI
0085a42d : MOV word ptr [EBP + -0x2c],CX
0085a431 : MOV byte ptr [EBP + -0x4],CL
0085a434 : CMP dword ptr [EBP + 0x28],ESI
0085a437 : JC 0x0085a441
0085a439 : MOV ECX,dword ptr [EBP + 0x14]
0085a43c : CALL 0x006f04e0
0085a441 : XOR EDX,EDX
0085a443 : MOV dword ptr [EBP + 0x28],0x7
0085a44a : MOV dword ptr [EBP + 0x24],EDI
0085a44d : MOV word ptr [EBP + 0x14],DX
0085a451 : JMP 0x0085a6b2
0085a456 : MOV dword ptr [EBP + -0x5c],EDI
0085a459 : MOV dword ptr [EBP + -0x58],EDI
0085a45c : MOV dword ptr [EBP + -0x54],EDI
0085a45f : MOV byte ptr [EBP + -0x4],0x3
0085a463 : LEA ECX,[EBP + -0x60]
0085a466 : CALL 0x00443b50
0085a46b : MOV EAX,dword ptr [EBP + 0x8]
0085a46e : MOV ECX,dword ptr [EAX + 0x16d8]
0085a474 : MOV EDX,dword ptr [ESI + 0x128]
0085a47a : MOV EAX,dword ptr [EDX + 0x4]
0085a47d : MOV dword ptr [EBP + -0x68],ECX
0085a480 : LEA ECX,[ESI + 0x128]
0085a486 : MOV byte ptr [EBP + -0x4d],0x0
0085a48a : MOV dword ptr [EBP + -0x70],ECX
0085a48d : CALL EAX
0085a48f : MOV ESI,dword ptr [EBP + -0x58]
0085a492 : CMP EAX,EDI
0085a494 : MOV EDI,dword ptr [EBP + -0x5c]
0085a497 : MOV dword ptr [EBP + -0x6c],EAX
0085a49a : JZ 0x0085a52a
0085a4a0 : MOV EAX,dword ptr [EBP + -0x70]
0085a4a3 : LEA EDX,[EBP + -0x6c]
0085a4a6 : CALL 0x004f5680
0085a4ab : TEST EAX,EAX
0085a4ad : JZ 0x0085a520
0085a4af : MOV ECX,EDI
0085a4b1 : CMP EDI,ESI
0085a4b3 : JZ 0x0085a4d1
0085a4b5 : MOVZX EDX,word ptr [EAX + 0x6]
0085a4b9 : LEA ESP,[ESP]
0085a4c0 : CMP dword ptr [ECX],EDX
0085a4c2 : JZ 0x0085a4cd
0085a4c4 : ADD ECX,0x4
0085a4c7 : CMP ECX,ESI
0085a4c9 : JNZ 0x0085a4c0
0085a4cb : JMP 0x0085a4d1
0085a4cd : CMP ESI,ECX
0085a4cf : JNZ 0x0085a520
0085a4d1 : MOVZX EAX,word ptr [EAX + 0x6]
0085a4d5 : CMP AX,word ptr [EBP + -0x68]
0085a4d9 : JNZ 0x0085a4df
0085a4db : MOV byte ptr [EBP + -0x4d],0x1
0085a4df : MOVZX ECX,AX
0085a4e2 : MOV dword ptr [EBP + -0x74],ECX
0085a4e5 : TEST EDI,EDI
0085a4e7 : JNZ 0x0085a4ed
0085a4e9 : XOR EAX,EAX
0085a4eb : JMP 0x0085a4f5
0085a4ed : MOV EAX,dword ptr [EBP + -0x54]
0085a4f0 : SUB EAX,EDI
0085a4f2 : SAR EAX,0x2
0085a4f5 : MOV EDX,ESI
0085a4f7 : SUB EDX,EDI
0085a4f9 : SAR EDX,0x2
0085a4fc : CMP EDX,EAX
0085a4fe : JNC 0x0085a50a
0085a500 : MOV dword ptr [ESI],ECX
0085a502 : ADD ESI,0x4
0085a505 : MOV dword ptr [EBP + -0x58],ESI
0085a508 : JMP 0x0085a520
0085a50a : LEA EAX,[EBP + -0x74]
0085a50d : PUSH EAX
0085a50e : PUSH 0x1
0085a510 : PUSH ESI
0085a511 : LEA ECX,[EBP + -0x60]
0085a514 : PUSH ECX
0085a515 : CALL 0x00408c10
0085a51a : MOV ESI,dword ptr [EBP + -0x58]
0085a51d : MOV EDI,dword ptr [EBP + -0x5c]
0085a520 : CMP dword ptr [EBP + -0x6c],0x0
0085a524 : JNZ 0x0085a4a0
0085a52a : SUB ESI,EDI
0085a52c : SAR ESI,0x2
0085a52f : CMP ESI,0x1
0085a532 : JBE 0x0085a624
0085a538 : CMP byte ptr [EBP + -0x4d],0x0
0085a53c : JZ 0x0085a624
0085a542 : PUSH 0x5
0085a544 : PUSH 0xc400e0
0085a549 : XOR EAX,EAX
0085a54b : LEA EDX,[EBP + 0x10]
0085a54e : CALL 0x00407c10
0085a553 : MOV ESI,EAX
0085a555 : CMP ESI,-0x1
0085a558 : JZ 0x0085a5db
0085a55e : PUSH 0xc400ec
0085a563 : LEA ECX,[EBP + -0x4c]
0085a566 : CALL 0x00406460
0085a56b : MOV byte ptr [EBP + -0x4],0x4
0085a56f : MOV EAX,dword ptr [EBP + -0x68]
0085a572 : CMP AX,0x1
0085a576 : JNZ 0x0085a583
0085a578 : LEA EDX,[EBP + -0x4c]
0085a57b : PUSH EDX
0085a57c : MOV EDX,0xc400f0
0085a581 : JMP 0x0085a5b4
0085a583 : CMP AX,0x2
0085a587 : JNZ 0x0085a594
0085a589 : LEA EAX,[EBP + -0x4c]
0085a58c : PUSH EAX
0085a58d : MOV EDX,0xc400f8
0085a592 : JMP 0x0085a5b4
0085a594 : CMP AX,0x3
0085a598 : JNZ 0x0085a5a5
0085a59a : LEA ECX,[EBP + -0x4c]
0085a59d : PUSH ECX
0085a59e : MOV EDX,0xc40100
0085a5a3 : JMP 0x0085a5b4
0085a5a5 : CMP AX,0x4
0085a5a9 : JNZ 0x0085a5b9
0085a5ab : LEA EDX,[EBP + -0x4c]
0085a5ae : PUSH EDX
0085a5af : MOV EDX,0xc40108
0085a5b4 : CALL 0x00405c00
0085a5b9 : PUSH 0x0
0085a5bb : LEA EAX,[EBP + -0x4c]
0085a5be : PUSH EAX
0085a5bf : PUSH 0x4
0085a5c1 : LEA ECX,[EBP + -0x30]
0085a5c4 : PUSH ECX
0085a5c5 : OR EAX,0xffffffff
0085a5c8 : MOV ECX,ESI
0085a5ca : CALL 0x00408540
0085a5cf : MOV byte ptr [EBP + -0x4],0x3
0085a5d3 : LEA ECX,[EBP + -0x4c]
0085a5d6 : CALL 0x00406560
0085a5db : LEA EDX,[EBP + -0x30]
0085a5de : PUSH EDX
0085a5df : MOV ECX,EBX
0085a5e1 : CALL 0x00405660
0085a5e6 : MOV dword ptr [EBP + -0x64],0x1
0085a5ed : MOV byte ptr [EBP + -0x4],0x2
0085a5f1 : XOR ESI,ESI
0085a5f3 : CMP EDI,ESI
0085a5f5 : JZ 0x0085a5fe
0085a5f7 : MOV ECX,EDI
0085a5f9 : CALL 0x006f04e0
0085a5fe : MOV dword ptr [EBP + -0x5c],ESI
0085a601 : MOV dword ptr [EBP + -0x58],ESI
0085a604 : MOV dword ptr [EBP + -0x54],ESI
0085a607 : MOV byte ptr [EBP + -0x4],0x1
0085a60b : LEA ECX,[EBP + -0x30]
0085a60e : CALL 0x00406560
0085a613 : MOV byte ptr [EBP + -0x4],0x0
0085a617 : LEA ECX,[EBP + 0x10]
0085a61a : CALL 0x00406560
0085a61f : JMP 0x0085a6b2
0085a624 : XOR EAX,EAX
0085a626 : PUSH -0x1
0085a628 : PUSH EAX
0085a629 : LEA ECX,[EBP + -0x30]
0085a62c : PUSH ECX
0085a62d : MOV dword ptr [EBX + 0x18],0x7
0085a634 : MOV dword ptr [EBX + 0x14],0x0
0085a63b : MOV ECX,EBX
0085a63d : MOV word ptr [EBX + 0x4],AX
0085a641 : CALL 0x00405eb0
0085a646 : MOV dword ptr [EBP + -0x64],0x1
0085a64d : MOV byte ptr [EBP + -0x4],0x2
0085a651 : XOR ESI,ESI
0085a653 : CMP EDI,ESI
0085a655 : JZ 0x0085a65e
0085a657 : MOV ECX,EDI
0085a659 : CALL 0x006f04e0
0085a65e : MOV dword ptr [EBP + -0x5c],ESI
0085a661 : MOV dword ptr [EBP + -0x58],ESI
0085a664 : MOV dword ptr [EBP + -0x54],ESI
0085a667 : MOV byte ptr [EBP + -0x4],0x1
0085a66b : MOV ESI,0x8
0085a670 : CMP dword ptr [EBP + -0x18],ESI
0085a673 : JC 0x0085a67d
0085a675 : MOV ECX,dword ptr [EBP + -0x2c]
0085a678 : CALL 0x006f04e0
0085a67d : XOR EDX,EDX
0085a67f : MOV EDI,0x7
0085a684 : MOV dword ptr [EBP + -0x18],EDI
0085a687 : MOV dword ptr [EBP + -0x1c],0x0
0085a68e : MOV word ptr [EBP + -0x2c],DX
0085a692 : MOV byte ptr [EBP + -0x4],DL
0085a695 : CMP dword ptr [EBP + 0x28],ESI
0085a698 : JC 0x0085a6a2
0085a69a : MOV ECX,dword ptr [EBP + 0x14]
0085a69d : CALL 0x006f04e0
0085a6a2 : XOR EAX,EAX
0085a6a4 : MOV dword ptr [EBP + 0x28],EDI
0085a6a7 : MOV dword ptr [EBP + 0x24],0x0
0085a6ae : MOV word ptr [EBP + 0x14],AX
0085a6b2 : MOV EAX,EBX
0085a6b4 : MOV ECX,dword ptr [EBP + -0xc]
0085a6b7 : MOV dword ptr FS:[0x0],ECX
0085a6be : POP ECX
0085a6bf : POP EDI
0085a6c0 : POP ESI
0085a6c1 : POP EBX
0085a6c2 : MOV ECX,dword ptr [EBP + -0x14]
0085a6c5 : XOR ECX,EBP
0085a6c7 : CALL 0x00633e6b
0085a6cc : MOV ESP,EBP
0085a6ce : POP EBP
0085a6cf : RET 0x24

PROGRAM  : Maestia.exe
FUNCTION : FUN_0045e1e0
ENTRY    : 0045e1e0
BODY     : [[0045e1e0, 0045e2e8]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_0045e1e0(void)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  int iVar4;
  size_t _Size;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b713c8;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  EnterCriticalSection((LPCRITICAL_SECTION)&DAT_01723390);
  local_8 = 0;
  puVar2 = DAT_017233ac;
  if (DAT_017233ac == (undefined4 *)0x0) {
    _Size = DAT_017233b0 * 0x110f0 + 4;
    puVar2 = _malloc(_Size);
    if (puVar2 != (undefined4 *)0x0) {
      _memset(puVar2,0,_Size);
      *puVar2 = DAT_017233a8;
      puVar3 = DAT_017233ac;
      puVar1 = puVar2 + 1;
      iVar4 = DAT_017233b0;
      DAT_017233a8 = puVar2;
      do {
        DAT_017233ac = puVar1;
        *DAT_017233ac = puVar3;
        iVar4 = iVar4 + -1;
        puVar3 = DAT_017233ac;
        puVar1 = DAT_017233ac + 0x443c;
      } while (iVar4 != 0);
    }
    puVar2 = DAT_017233ac;
    if (DAT_017233ac == (undefined4 *)0x0) {
      local_8 = 0xffffffff;
      LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_01723390);
      ExceptionList = local_10;
      return (undefined4 *)0x0;
    }
  }
  DAT_017233ac = (undefined4 *)*puVar2;
  DAT_017233b4 = DAT_017233b4 + 1;
  local_8 = 0xffffffff;
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_01723390);
  ExceptionList = local_10;
  return puVar2;
}



============================================================
DISASSEMBLY
============================================================
0045e1e0 : PUSH EBP
0045e1e1 : MOV EBP,ESP
0045e1e3 : PUSH -0x1
0045e1e5 : PUSH 0xb713c8
0045e1ea : MOV EAX,FS:[0x0]
0045e1f0 : PUSH EAX
0045e1f1 : PUSH ECX
0045e1f2 : PUSH ESI
0045e1f3 : PUSH EDI
0045e1f4 : MOV EAX,[0x00d66fa0]
0045e1f9 : XOR EAX,EBP
0045e1fb : PUSH EAX
0045e1fc : LEA EAX,[EBP + -0xc]
0045e1ff : MOV FS:[0x0],EAX
0045e205 : PUSH 0x1723390
0045e20a : MOV dword ptr [EBP + -0x10],0x172338c
0045e211 : CALL dword ptr [0x00b85118]
0045e217 : MOV dword ptr [EBP + -0x4],0x0
0045e21e : MOV EAX,[0x017233ac]
0045e223 : TEST EAX,EAX
0045e225 : JNZ 0x0045e2b4
0045e22b : MOV EDI,dword ptr [0x017233b0]
0045e231 : IMUL EDI,EDI,0x110f0
0045e237 : ADD EDI,0x4
0045e23a : PUSH EDI
0045e23b : CALL 0x00636043
0045e240 : MOV ESI,EAX
0045e242 : ADD ESP,0x4
0045e245 : TEST ESI,ESI
0045e247 : JZ 0x0045e286
0045e249 : PUSH EDI
0045e24a : PUSH 0x0
0045e24c : PUSH ESI
0045e24d : CALL 0x0063b700
0045e252 : MOV EAX,[0x017233a8]
0045e257 : MOV dword ptr [ESI],EAX
0045e259 : MOV EDX,dword ptr [0x017233b0]
0045e25f : MOV EAX,[0x017233ac]
0045e264 : ADD ESP,0xc
0045e267 : MOV dword ptr [0x017233a8],ESI
0045e26d : LEA ECX,[ESI + 0x4]
0045e270 : MOV dword ptr [ECX],EAX
0045e272 : MOV EAX,ECX
0045e274 : ADD ECX,0x110f0
0045e27a : SUB EDX,0x1
0045e27d : JNZ 0x0045e270
0045e27f : MOV [0x017233ac],EAX
0045e284 : JMP 0x0045e28b
0045e286 : MOV EAX,[0x017233ac]
0045e28b : TEST EAX,EAX
0045e28d : JNZ 0x0045e2b4
0045e28f : MOV dword ptr [EBP + -0x4],0xffffffff
0045e296 : PUSH 0x1723390
0045e29b : CALL dword ptr [0x00b8511c]
0045e2a1 : XOR EAX,EAX
0045e2a3 : MOV ECX,dword ptr [EBP + -0xc]
0045e2a6 : MOV dword ptr FS:[0x0],ECX
0045e2ad : POP ECX
0045e2ae : POP EDI
0045e2af : POP ESI
0045e2b0 : MOV ESP,EBP
0045e2b2 : POP EBP
0045e2b3 : RET
0045e2b4 : MOV ECX,dword ptr [EAX]
0045e2b6 : INC dword ptr [0x017233b4]
0045e2bc : MOV ESI,EAX
0045e2be : MOV dword ptr [0x017233ac],ECX
0045e2c4 : MOV dword ptr [EBP + -0x4],0xffffffff
0045e2cb : PUSH 0x1723390
0045e2d0 : CALL dword ptr [0x00b8511c]
0045e2d6 : MOV EAX,ESI
0045e2d8 : MOV ECX,dword ptr [EBP + -0xc]
0045e2db : MOV dword ptr FS:[0x0],ECX
0045e2e2 : POP ECX
0045e2e3 : POP EDI
0045e2e4 : POP ESI
0045e2e5 : MOV ESP,EBP
0045e2e7 : POP EBP
0045e2e8 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_006be660
ENTRY    : 006be660
BODY     : [[006be660, 006beb95] [006beba0, 006bedfb]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006be660(int *param_1,int param_2,undefined4 param_3,undefined4 param_4,int param_5)

{
  int *piVar1;
  short sVar2;
  int *piVar3;
  int iVar4;
  int *piVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int *piVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  undefined4 uVar13;
  int iVar14;
  int iVar15;
  uint uVar16;
  uint uVar17;
  uint uVar18;
  uint uVar19;
  int local_58;
  undefined2 local_44;
  uint local_40;
  uint local_34;
  int local_30;
  int local_2c;
  int local_28;
  uint local_24;
  uint local_20;
  uint local_1c;
  uint local_18;
  undefined4 local_14;
  int local_10;
  undefined4 local_c;
  undefined4 local_8;
  undefined4 local_4;
  
  piVar9 = param_1;
  piVar3 = (int *)param_1[0x22];
  iVar4 = *(int *)(*param_1 + 0x54);
  piVar5 = *(int **)(iVar4 + 0x9c);
  iVar6 = param_1[2];
  piVar1 = param_1 + 3;
  iVar10 = FUN_00688ff0(*param_1,param_3,param_4);
  if (iVar10 == 0) {
    iVar10 = piVar5[2];
    *(char *)(param_1 + 0x23) = (char)iVar10;
    if ((char)iVar10 != '\0') {
      param_1[0x24] = piVar5[3];
      param_1[0x25] = piVar5[4];
      param_1[0x26] = piVar5[5];
      param_1[0x27] = piVar5[6];
      param_1[0x28] = piVar5[7];
      local_20 = param_1[0x25];
      local_24 = param_1[0x24];
      param_1[0x29] = piVar5[8];
      local_1c = param_1[0x26];
      local_18 = param_1[0x27];
      FUN_00685fc0(&local_24);
      FUN_00687440(param_1 + 0x28,&local_24);
    }
    *(undefined4 *)(iVar4 + 0x38) = *(undefined4 *)(iVar4 + 0x28);
    *(undefined4 *)(iVar4 + 0x3c) = *(undefined4 *)(iVar4 + 0x34);
    if (*(int *)(iVar4 + 0x48) == 0x636f6d70) {
      uVar16 = *(uint *)(iVar4 + 0x80);
      sVar2 = *(short *)(iVar6 + 0x16);
      local_34 = uVar16;
      iVar10 = FUN_0068a450(iVar6,uVar16);
      if (iVar10 != 0) {
        return iVar10;
      }
      _memcpy(*(void **)(iVar6 + 0x58),*(void **)(iVar4 + 0x84),uVar16 << 5);
      *(uint *)(iVar6 + 0x54) = uVar16;
      local_40 = 0;
      iVar10 = 0;
      if (uVar16 != 0) {
        local_58 = *(int *)(iVar6 + 0x30) << 5;
        do {
          local_28 = param_1[0x2b];
          local_2c = param_1[0x2a];
          uVar16 = (uint)*(short *)(iVar6 + 0x16);
          local_20 = param_1[0x2d];
          local_24 = param_1[0x2c];
          iVar10 = FUN_006be660(param_1,param_2,*(undefined4 *)(*(int *)(iVar6 + 0x34) + local_58),
                                param_4,param_5 + 1);
          if (iVar10 != 0) {
            return iVar10;
          }
          iVar10 = *(int *)(iVar6 + 0x34) + local_58;
          if ((*(ushort *)(iVar10 + 4) & 0x200) == 0) {
            param_1[0x2a] = local_2c;
            param_1[0x2b] = local_28;
            param_1[0x2c] = local_24;
            param_1[0x2d] = local_20;
          }
          uVar17 = (int)*(short *)(iVar6 + 0x16) - uVar16;
          if ((*(byte *)(iVar10 + 4) & 200) != 0) {
            uVar18 = *(int *)(iVar6 + 0x18) + uVar16 * 8;
            uVar19 = uVar18 + uVar17 * 8;
            for (; uVar18 < uVar19; uVar18 = uVar18 + 8) {
              FUN_00687440(uVar18,iVar10 + 0x10);
            }
          }
          if ((*(byte *)(iVar10 + 4) & 2) == 0) {
            uVar18 = (int)sVar2 + *(int *)(iVar10 + 8);
            if ((uVar16 <= uVar18) || (uVar17 <= *(uint *)(iVar10 + 0xc))) {
              return 0x15;
            }
            iVar12 = *(int *)(iVar6 + 0x18);
            iVar10 = *(uint *)(iVar10 + 0xc) + uVar16 + (int)sVar2;
            uVar19 = *(int *)(iVar12 + uVar18 * 8) - *(int *)(iVar12 + iVar10 * 8);
            uVar18 = *(int *)(iVar12 + 4 + uVar18 * 8) - *(int *)(iVar12 + 4 + iVar10 * 8);
          }
          else {
            iVar12 = FUN_00685ea0(*(undefined4 *)(iVar10 + 8),param_1[4]);
            uVar19 = iVar12 + param_1[5] + 0x20U & 0xffffffc0;
            iVar10 = FUN_00685ea0(*(undefined4 *)(iVar10 + 0xc),param_1[6]);
            uVar18 = iVar10 + 0x20 + param_1[7] & 0xffffffc0;
          }
          local_c = *(undefined4 *)(iVar6 + 0x1c);
          local_8 = *(undefined4 *)(iVar6 + 0x20);
          local_4 = *(undefined4 *)(iVar6 + 0x24);
          local_10 = *(int *)(iVar6 + 0x18) + uVar16 * 8;
          local_44 = (undefined2)uVar17;
          local_14 = CONCAT22(local_44,(short)*(undefined4 *)(iVar6 + 0x14));
          FUN_00687400(&local_14,uVar19,uVar18);
          local_58 = local_58 + 0x20;
          local_40 = local_40 + 1;
          iVar10 = 0;
        } while (local_40 < local_34);
      }
    }
    else if (*(int *)(iVar4 + 0x48) == 0x6f75746c) {
      if ((char)param_1[0x23] != '\0') {
        FUN_00687400(iVar4 + 0x6c,param_1[0x28],param_1[0x29]);
      }
      iVar10 = *(short *)(iVar4 + 0x6e) + 4;
      if (((iVar10 == 0) ||
          (*(short *)(iVar6 + 0x16) + 4 +
           (int)*(short *)(iVar6 + 0x3a) + (int)*(short *)(iVar4 + 0x6e) <= *(int *)(iVar6 + 4))) &&
         ((*(short *)(iVar4 + 0x6c) == 0 ||
          ((int)*(short *)(iVar6 + 0x38) + (int)*(short *)(iVar6 + 0x14) +
           (int)*(short *)(iVar4 + 0x6c) <= *(int *)(iVar6 + 8))))) {
        param_1 = (int *)0x0;
      }
      else {
        param_1 = (int *)FUN_0068a300(iVar6,iVar10,(int)*(short *)(iVar4 + 0x6c));
        if (param_1 != (int *)0x0) {
          return (int)param_1;
        }
      }
      _memcpy(*(void **)(iVar6 + 0x3c),*(void **)(iVar4 + 0x70),*(short *)(iVar4 + 0x6e) * 8);
      _memcpy(*(void **)(iVar6 + 0x44),*(void **)(iVar4 + 0x78),*(short *)(iVar4 + 0x6c) * 2);
      _memcpy(*(void **)(iVar6 + 0x40),*(void **)(iVar4 + 0x74),(int)*(short *)(iVar4 + 0x6e));
      *(undefined2 *)(iVar6 + 0x3a) = *(undefined2 *)(iVar4 + 0x6e);
      *(undefined2 *)(iVar6 + 0x38) = *(undefined2 *)(iVar4 + 0x6c);
      piVar9[0x2a] = piVar9[5];
      piVar9[0x2b] = piVar9[7];
      iVar10 = FUN_00685ea0(*(undefined4 *)(iVar4 + 0x28),piVar9[4]);
      piVar9[0x2c] = iVar10 + piVar9[5];
      piVar9[0x2d] = piVar9[7];
      iVar10 = (int)param_1;
      if (*(short *)(iVar4 + 0x6e) != 0) {
        if (*(code **)(*piVar3 + 0x1c) != (code *)0x0) {
          (**(code **)(*piVar3 + 0x1c))(piVar1,iVar6 + 0x38,piVar3);
        }
        if (*(int *)(param_2 + 0x14) == 1) {
          iVar12 = piVar9[0x2a];
          iVar7 = piVar9[0x2c];
          piVar9[0x2a] = piVar9[0x20] + 0x20 + iVar12 & 0xffffffc0;
          piVar9[0x2c] = piVar9[0x21] + 0x20 + iVar7 & 0xffffffc0;
          *(int *)(iVar4 + 0x90) = piVar9[0x2a] - iVar12;
          *(int *)(iVar4 + 0x94) = piVar9[0x2c] - iVar7;
          FUN_006863c0(iVar6);
        }
        else {
          iVar7 = piVar9[0x14];
          iVar12 = piVar9[0x12] * 0x30 + -0x30 + iVar7;
          if ((piVar9[0x12] < 2) || ((*(byte *)(piVar9 + 0x1d) & 4) != 0)) {
            iVar12 = piVar9[0x2a];
            iVar7 = piVar9[0x2c];
            uVar16 = iVar12 + 0x20U & 0xffffffc0;
            piVar9[0x2a] = uVar16;
            piVar9[0x2c] = iVar7 + 0x20U & 0xffffffc0;
            *(uint *)(iVar4 + 0x90) = uVar16 - iVar12;
            *(int *)(iVar4 + 0x94) = piVar9[0x2c] - iVar7;
            FUN_006863c0(iVar6);
          }
          else {
            iVar8 = *(int *)(iVar7 + 4);
            iVar15 = piVar9[0x2c] - *(int *)(iVar12 + 4);
            iVar7 = *(int *)(iVar7 + 8);
            iVar14 = iVar7 - iVar8;
            iVar11 = *(int *)(iVar12 + 8) + iVar15;
            if (iVar8 < 0x18) {
              iVar14 = iVar14 + -8;
            }
            if (iVar15 < 0x18) {
              iVar11 = iVar11 + 8;
            }
            uVar16 = iVar14 + 0x20U & 0xffffffc0;
            uVar17 = iVar11 + 0x20U & 0xffffffc0;
            piVar9[0x2a] = uVar16;
            piVar9[0x2c] = uVar17;
            if ((iVar7 <= (int)uVar16) && (0 < iVar8)) {
              piVar9[0x2a] = uVar16 - 0x40;
            }
            if (((int)uVar17 <= *(int *)(iVar12 + 8)) && (0 < iVar15)) {
              piVar9[0x2c] = uVar17 + 0x40;
            }
            *(int *)(iVar4 + 0x90) = piVar9[0x2a] - iVar14;
            *(int *)(iVar4 + 0x94) = piVar9[0x2c] - iVar11;
            FUN_006863c0(iVar6);
          }
        }
      }
    }
    else {
      param_1 = (int *)0x7;
      iVar10 = (int)param_1;
    }
    param_1 = (int *)iVar10;
    iVar10 = (int)param_1;
    if (param_5 == 0) {
      local_34 = *(int *)(iVar4 + 0x2c) - *(int *)(iVar4 + 0x20);
      local_30 = *(int *)(iVar4 + 0x30) - *(int *)(iVar4 + 0x24);
      local_34 = FUN_00685ea0(local_34,piVar3[2]);
      local_30 = FUN_00685ea0(local_30,piVar3[3]);
      if ((char)piVar9[0x23] != '\0') {
        FUN_006874a0(iVar6 + 0x14,piVar9 + 0x24);
        FUN_00687440(&local_34,piVar9 + 0x24);
      }
      if (piVar9[0x2a] != 0) {
        FUN_00687400(iVar6 + 0x14,-piVar9[0x2a],0);
      }
      FUN_00687370(iVar6 + 0x14,&local_24);
      local_20 = local_20 & 0xffffffc0;
      local_1c = local_1c + 0x3f & 0xffffffc0;
      local_24 = local_24 & 0xffffffc0;
      local_18 = local_18 + 0x3f & 0xffffffc0;
      *(uint *)(iVar4 + 0x18) = local_1c - local_24;
      *(uint *)(iVar4 + 0x1c) = local_18 - local_20;
      *(uint *)(iVar4 + 0x20) = local_24;
      *(uint *)(iVar4 + 0x2c) = local_24 + local_34 & 0xffffffc0;
      *(uint *)(iVar4 + 0x24) = local_18;
      *(uint *)(iVar4 + 0x30) = local_18 + local_30 & 0xffffffc0;
      if ((*(byte *)(*(int *)(iVar4 + 4) + 8) & 4) == 0) {
        if (*(int *)(iVar4 + 0x28) != 0) {
          *(int *)(iVar4 + 0x28) = piVar9[0x2c] - piVar9[0x2a];
        }
      }
      else {
        uVar13 = FUN_00685ea0(*(undefined4 *)(iVar4 + 0x28),piVar3[2]);
        *(undefined4 *)(iVar4 + 0x28) = uVar13;
        *(undefined4 *)(iVar4 + 0x90) = 0;
        *(undefined4 *)(iVar4 + 0x94) = 0;
      }
      iVar10 = FUN_00685ea0(*(undefined4 *)(iVar4 + 0x34),piVar3[3]);
      *(uint *)(iVar4 + 0x28) = *(int *)(iVar4 + 0x28) + 0x20U & 0xffffffc0;
      *(uint *)(iVar4 + 0x34) = iVar10 + 0x20U & 0xffffffc0;
      FUN_00686310(*piVar5);
      iVar10 = FUN_0068a4b0(*piVar5,iVar6);
      if (iVar10 == 0) {
        iVar6 = *piVar5;
        *(undefined4 *)(iVar4 + 0x6c) = *(undefined4 *)(iVar6 + 0x14);
        *(undefined4 *)(iVar4 + 0x70) = *(undefined4 *)(iVar6 + 0x18);
        *(undefined4 *)(iVar4 + 0x74) = *(undefined4 *)(iVar6 + 0x1c);
        *(undefined4 *)(iVar4 + 0x78) = *(undefined4 *)(iVar6 + 0x20);
        *(undefined4 *)(iVar4 + 0x7c) = *(undefined4 *)(iVar6 + 0x24);
        *(undefined4 *)(iVar4 + 0x48) = 0x6f75746c;
        return 0;
      }
    }
  }
  return iVar10;
}



============================================================
DISASSEMBLY
============================================================
006be660 : SUB ESP,0x58
006be663 : PUSH EBX
006be664 : PUSH EBP
006be665 : PUSH ESI
006be666 : MOV ESI,dword ptr [ESP + 0x68]
006be66a : MOV EAX,dword ptr [ESI]
006be66c : MOV ECX,dword ptr [ESI + 0x88]
006be672 : MOV EBP,dword ptr [EAX + 0x54]
006be675 : MOV EDX,dword ptr [EBP + 0x9c]
006be67b : PUSH EDI
006be67c : MOV EDI,dword ptr [ESI + 0x8]
006be67f : MOV dword ptr [ESP + 0x1c],ECX
006be683 : MOV ECX,dword ptr [ESP + 0x78]
006be687 : MOV dword ptr [ESP + 0x2c],EDX
006be68b : MOV EDX,dword ptr [ESP + 0x74]
006be68f : PUSH ECX
006be690 : PUSH EDX
006be691 : PUSH EAX
006be692 : LEA EBX,[ESI + 0xc]
006be695 : CALL 0x00688ff0
006be69a : ADD ESP,0xc
006be69d : TEST EAX,EAX
006be69f : JNZ 0x006bedf4
006be6a5 : MOV EAX,dword ptr [ESP + 0x2c]
006be6a9 : MOV CL,byte ptr [EAX + 0x8]
006be6ac : MOV byte ptr [ESI + 0x8c],CL
006be6b2 : TEST CL,CL
006be6b4 : JZ 0x006be732
006be6b6 : MOV ECX,dword ptr [EAX + 0xc]
006be6b9 : MOV dword ptr [ESI + 0x90],ECX
006be6bf : MOV EDX,dword ptr [EAX + 0x10]
006be6c2 : MOV dword ptr [ESI + 0x94],EDX
006be6c8 : MOV ECX,dword ptr [EAX + 0x14]
006be6cb : MOV dword ptr [ESI + 0x98],ECX
006be6d1 : MOV EDX,dword ptr [EAX + 0x18]
006be6d4 : MOV dword ptr [ESI + 0x9c],EDX
006be6da : MOV ECX,dword ptr [EAX + 0x1c]
006be6dd : MOV dword ptr [ESI + 0xa0],ECX
006be6e3 : MOV EDX,dword ptr [EAX + 0x20]
006be6e6 : MOV ECX,dword ptr [ESI + 0x94]
006be6ec : MOV EAX,dword ptr [ESI + 0x90]
006be6f2 : MOV dword ptr [ESP + 0x48],ECX
006be6f6 : MOV dword ptr [ESI + 0xa4],EDX
006be6fc : MOV EDX,dword ptr [ESI + 0x98]
006be702 : MOV dword ptr [ESP + 0x44],EAX
006be706 : MOV EAX,dword ptr [ESI + 0x9c]
006be70c : LEA ECX,[ESP + 0x44]
006be710 : PUSH ECX
006be711 : MOV dword ptr [ESP + 0x50],EDX
006be715 : MOV dword ptr [ESP + 0x54],EAX
006be719 : CALL 0x00685fc0
006be71e : LEA EDX,[ESP + 0x48]
006be722 : PUSH EDX
006be723 : LEA EAX,[ESI + 0xa0]
006be729 : PUSH EAX
006be72a : CALL 0x00687440
006be72f : ADD ESP,0xc
006be732 : MOV EAX,dword ptr [EBP + 0x28]
006be735 : MOV ECX,dword ptr [EBP + 0x34]
006be738 : MOV dword ptr [EBP + 0x38],EAX
006be73b : MOV EAX,dword ptr [EBP + 0x48]
006be73e : MOV dword ptr [EBP + 0x3c],ECX
006be741 : CMP EAX,0x636f6d70
006be746 : JZ 0x006beb36
006be74c : CMP EAX,0x6f75746c
006be751 : JZ 0x006be87f
006be757 : MOV dword ptr [ESP + 0x6c],0x7
006be75f : CMP dword ptr [ESP + 0x7c],0x0
006be764 : JNZ 0x006bedf0
006be76a : MOV EAX,dword ptr [EBP + 0x2c]
006be76d : MOV EBX,dword ptr [ESP + 0x1c]
006be771 : SUB EAX,dword ptr [EBP + 0x20]
006be774 : MOV ECX,dword ptr [EBP + 0x30]
006be777 : MOV EDX,dword ptr [EBX + 0x8]
006be77a : SUB ECX,dword ptr [EBP + 0x24]
006be77d : PUSH EDX
006be77e : PUSH EAX
006be77f : MOV dword ptr [ESP + 0x3c],EAX
006be783 : MOV dword ptr [ESP + 0x40],ECX
006be787 : CALL 0x00685ea0
006be78c : MOV ECX,dword ptr [ESP + 0x40]
006be790 : MOV dword ptr [ESP + 0x3c],EAX
006be794 : MOV EAX,dword ptr [EBX + 0xc]
006be797 : PUSH EAX
006be798 : PUSH ECX
006be799 : CALL 0x00685ea0
006be79e : ADD ESP,0x10
006be7a1 : CMP byte ptr [ESI + 0x8c],0x0
006be7a8 : MOV dword ptr [ESP + 0x38],EAX
006be7ac : JZ 0x006be7d0
006be7ae : LEA EBX,[ESI + 0x90]
006be7b4 : LEA EDX,[EDI + 0x14]
006be7b7 : PUSH EBX
006be7b8 : PUSH EDX
006be7b9 : CALL 0x006874a0
006be7be : LEA EAX,[ESP + 0x3c]
006be7c2 : PUSH EBX
006be7c3 : PUSH EAX
006be7c4 : CALL 0x00687440
006be7c9 : MOV EBX,dword ptr [ESP + 0x2c]
006be7cd : ADD ESP,0x10
006be7d0 : MOV EAX,dword ptr [ESI + 0xa8]
006be7d6 : TEST EAX,EAX
006be7d8 : JZ 0x006be7eb
006be7da : PUSH 0x0
006be7dc : NEG EAX
006be7de : PUSH EAX
006be7df : LEA ECX,[EDI + 0x14]
006be7e2 : PUSH ECX
006be7e3 : CALL 0x00687400
006be7e8 : ADD ESP,0xc
006be7eb : LEA EDX,[ESP + 0x44]
006be7ef : PUSH EDX
006be7f0 : LEA EAX,[EDI + 0x14]
006be7f3 : PUSH EAX
006be7f4 : CALL 0x00687370
006be7f9 : MOV EAX,dword ptr [ESP + 0x54]
006be7fd : MOV EDX,dword ptr [ESP + 0x4c]
006be801 : MOV ECX,dword ptr [ESP + 0x58]
006be805 : AND dword ptr [ESP + 0x50],0xffffffc0
006be80a : ADD EAX,0x3f
006be80d : AND EAX,0xffffffc0
006be810 : AND EDX,0xffffffc0
006be813 : MOV dword ptr [ESP + 0x54],EAX
006be817 : SUB EAX,EDX
006be819 : ADD ECX,0x3f
006be81c : AND ECX,0xffffffc0
006be81f : MOV dword ptr [EBP + 0x18],EAX
006be822 : MOV EAX,ECX
006be824 : SUB EAX,dword ptr [ESP + 0x50]
006be828 : MOV dword ptr [ESP + 0x4c],EDX
006be82c : MOV dword ptr [EBP + 0x1c],EAX
006be82f : MOV EAX,dword ptr [ESP + 0x3c]
006be833 : MOV dword ptr [EBP + 0x20],EDX
006be836 : ADD EDX,EAX
006be838 : MOV EAX,dword ptr [EBP + 0x4]
006be83b : AND EDX,0xffffffc0
006be83e : MOV dword ptr [EBP + 0x2c],EDX
006be841 : MOV EDX,dword ptr [ESP + 0x40]
006be845 : MOV dword ptr [ESP + 0x58],ECX
006be849 : MOV dword ptr [EBP + 0x24],ECX
006be84c : ADD ECX,EDX
006be84e : AND ECX,0xffffffc0
006be851 : ADD ESP,0x8
006be854 : MOV dword ptr [EBP + 0x30],ECX
006be857 : TEST byte ptr [EAX + 0x8],0x4
006be85b : JNZ 0x006bed5f
006be861 : CMP dword ptr [EBP + 0x28],0x0
006be865 : JZ 0x006bed80
006be86b : MOV ECX,dword ptr [ESI + 0xb0]
006be871 : SUB ECX,dword ptr [ESI + 0xa8]
006be877 : MOV dword ptr [EBP + 0x28],ECX
006be87a : JMP 0x006bed80
006be87f : CMP byte ptr [ESI + 0x8c],0x0
006be886 : JZ 0x006be8a2
006be888 : MOV EDX,dword ptr [ESI + 0xa4]
006be88e : MOV EAX,dword ptr [ESI + 0xa0]
006be894 : PUSH EDX
006be895 : PUSH EAX
006be896 : LEA ECX,[EBP + 0x6c]
006be899 : PUSH ECX
006be89a : CALL 0x00687400
006be89f : ADD ESP,0xc
006be8a2 : MOVSX EAX,word ptr [EBP + 0x6e]
006be8a6 : LEA ECX,[EAX + 0x4]
006be8a9 : MOV dword ptr [ESP + 0x6c],ECX
006be8ad : TEST ECX,ECX
006be8af : JZ 0x006be8c4
006be8b1 : MOVSX EDX,word ptr [EDI + 0x3a]
006be8b5 : MOVSX ECX,word ptr [EDI + 0x16]
006be8b9 : ADD EDX,EAX
006be8bb : LEA EDX,[ECX + EDX*0x1 + 0x4]
006be8bf : CMP EDX,dword ptr [EDI + 0x4]
006be8c2 : JG 0x006be8e7
006be8c4 : MOVZX EAX,word ptr [EBP + 0x6c]
006be8c8 : TEST AX,AX
006be8cb : JZ 0x006bea8b
006be8d1 : MOVSX ECX,word ptr [EDI + 0x38]
006be8d5 : MOVSX EDX,word ptr [EDI + 0x14]
006be8d9 : CWDE
006be8da : ADD ECX,EDX
006be8dc : ADD ECX,EAX
006be8de : CMP ECX,dword ptr [EDI + 0x8]
006be8e1 : JLE 0x006bea8b
006be8e7 : MOVSX ECX,word ptr [EBP + 0x6c]
006be8eb : MOV EDX,dword ptr [ESP + 0x6c]
006be8ef : PUSH ECX
006be8f0 : PUSH EDX
006be8f1 : PUSH EDI
006be8f2 : CALL 0x0068a300
006be8f7 : ADD ESP,0xc
006be8fa : MOV dword ptr [ESP + 0x6c],EAX
006be8fe : TEST EAX,EAX
006be900 : JNZ 0x006bedf4
006be906 : MOVSX EAX,word ptr [EBP + 0x6e]
006be90a : MOV ECX,dword ptr [EBP + 0x70]
006be90d : MOV EDX,dword ptr [EDI + 0x3c]
006be910 : ADD EAX,EAX
006be912 : ADD EAX,EAX
006be914 : ADD EAX,EAX
006be916 : PUSH EAX
006be917 : PUSH ECX
006be918 : PUSH EDX
006be919 : CALL 0x0063ae40
006be91e : MOVSX EAX,word ptr [EBP + 0x6c]
006be922 : MOV ECX,dword ptr [EBP + 0x78]
006be925 : MOV EDX,dword ptr [EDI + 0x44]
006be928 : ADD EAX,EAX
006be92a : PUSH EAX
006be92b : PUSH ECX
006be92c : PUSH EDX
006be92d : CALL 0x0063ae40
006be932 : MOVSX EAX,word ptr [EBP + 0x6e]
006be936 : MOV ECX,dword ptr [EBP + 0x74]
006be939 : MOV EDX,dword ptr [EDI + 0x40]
006be93c : PUSH EAX
006be93d : PUSH ECX
006be93e : PUSH EDX
006be93f : CALL 0x0063ae40
006be944 : MOV AX,word ptr [EBP + 0x6e]
006be948 : MOV word ptr [EDI + 0x3a],AX
006be94c : MOV CX,word ptr [EBP + 0x6c]
006be950 : MOV word ptr [EDI + 0x38],CX
006be954 : MOV EDX,dword ptr [EBX + 0x8]
006be957 : MOV dword ptr [ESI + 0xa8],EDX
006be95d : MOV EAX,dword ptr [EBX + 0x10]
006be960 : MOV dword ptr [ESI + 0xac],EAX
006be966 : MOV ECX,dword ptr [EBX + 0x4]
006be969 : MOV EDX,dword ptr [EBP + 0x28]
006be96c : PUSH ECX
006be96d : PUSH EDX
006be96e : CALL 0x00685ea0
006be973 : ADD EAX,dword ptr [EBX + 0x8]
006be976 : ADD ESP,0x2c
006be979 : MOV dword ptr [ESI + 0xb0],EAX
006be97f : MOV EAX,dword ptr [EBX + 0x10]
006be982 : MOV dword ptr [ESI + 0xb4],EAX
006be988 : CMP word ptr [EBP + 0x6e],0x0
006be98d : JZ 0x006be75f
006be993 : MOV EAX,dword ptr [ESP + 0x1c]
006be997 : MOV ECX,dword ptr [EAX]
006be999 : MOV ECX,dword ptr [ECX + 0x1c]
006be99c : TEST ECX,ECX
006be99e : JZ 0x006be9ab
006be9a0 : PUSH EAX
006be9a1 : LEA EAX,[EDI + 0x38]
006be9a4 : PUSH EAX
006be9a5 : PUSH EBX
006be9a6 : CALL ECX
006be9a8 : ADD ESP,0xc
006be9ab : MOV EDX,dword ptr [ESP + 0x70]
006be9af : CMP dword ptr [EDX + 0x14],0x1
006be9b3 : JZ 0x006beae0
006be9b9 : MOV EDX,dword ptr [EBX + 0x3c]
006be9bc : MOV ECX,dword ptr [EBX + 0x44]
006be9bf : LEA EAX,[EDX + EDX*0x2]
006be9c2 : SHL EAX,0x4
006be9c5 : CMP EDX,0x1
006be9c8 : LEA EAX,[EAX + ECX*0x1 + -0x30]
006be9cc : MOV dword ptr [ESP + 0x20],EAX
006be9d0 : JLE 0x006bea98
006be9d6 : TEST byte ptr [EBX + 0x68],0x4
006be9da : JNZ 0x006bea98
006be9e0 : MOV EBX,dword ptr [ECX + 0x4]
006be9e3 : MOV EDX,dword ptr [ESI + 0xb0]
006be9e9 : SUB EDX,dword ptr [EAX + 0x4]
006be9ec : MOV ECX,dword ptr [ECX + 0x8]
006be9ef : MOV EAX,dword ptr [EAX + 0x8]
006be9f2 : MOV dword ptr [ESP + 0x28],ECX
006be9f6 : SUB ECX,EBX
006be9f8 : ADD EAX,EDX
006be9fa : CMP EBX,0x18
006be9fd : MOV dword ptr [ESP + 0x14],EDX
006bea01 : MOV dword ptr [ESP + 0x18],EBX
006bea05 : JGE 0x006bea0a
006bea07 : SUB ECX,0x8
006bea0a : CMP EDX,0x18
006bea0d : JGE 0x006bea12
006bea0f : ADD EAX,0x8
006bea12 : LEA EDX,[ECX + 0x20]
006bea15 : AND EDX,0xffffffc0
006bea18 : LEA EBX,[EAX + 0x20]
006bea1b : AND EBX,0xffffffc0
006bea1e : CMP EDX,dword ptr [ESP + 0x28]
006bea22 : MOV dword ptr [ESI + 0xa8],EDX
006bea28 : MOV dword ptr [ESP + 0x24],EBX
006bea2c : MOV dword ptr [ESI + 0xb0],EBX
006bea32 : JL 0x006bea44
006bea34 : CMP dword ptr [ESP + 0x18],0x0
006bea39 : JLE 0x006bea44
006bea3b : ADD EDX,-0x40
006bea3e : MOV dword ptr [ESI + 0xa8],EDX
006bea44 : MOV EDX,dword ptr [ESP + 0x24]
006bea48 : MOV EBX,dword ptr [ESP + 0x20]
006bea4c : CMP EDX,dword ptr [EBX + 0x8]
006bea4f : JG 0x006bea61
006bea51 : CMP dword ptr [ESP + 0x14],0x0
006bea56 : JLE 0x006bea61
006bea58 : ADD EDX,0x40
006bea5b : MOV dword ptr [ESI + 0xb0],EDX
006bea61 : MOV EDX,dword ptr [ESI + 0xa8]
006bea67 : SUB EDX,ECX
006bea69 : MOV dword ptr [EBP + 0x90],EDX
006bea6f : MOV ECX,dword ptr [ESI + 0xb0]
006bea75 : SUB ECX,EAX
006bea77 : PUSH EDI
006bea78 : MOV dword ptr [EBP + 0x94],ECX
006bea7e : CALL 0x006863c0
006bea83 : ADD ESP,0x4
006bea86 : JMP 0x006be75f
006bea8b : MOV dword ptr [ESP + 0x6c],0x0
006bea93 : JMP 0x006be906
006bea98 : MOV ECX,dword ptr [ESI + 0xa8]
006bea9e : MOV EDX,dword ptr [ESI + 0xb0]
006beaa4 : LEA EAX,[ECX + 0x20]
006beaa7 : AND EAX,0xffffffc0
006beaaa : MOV dword ptr [ESI + 0xa8],EAX
006beab0 : LEA EBX,[EDX + 0x20]
006beab3 : SUB EAX,ECX
006beab5 : AND EBX,0xffffffc0
006beab8 : MOV dword ptr [ESI + 0xb0],EBX
006beabe : MOV dword ptr [EBP + 0x90],EAX
006beac4 : MOV EAX,dword ptr [ESI + 0xb0]
006beaca : SUB EAX,EDX
006beacc : PUSH EDI
006beacd : MOV dword ptr [EBP + 0x94],EAX
006bead3 : CALL 0x006863c0
006bead8 : ADD ESP,0x4
006beadb : JMP 0x006be75f
006beae0 : MOV EAX,dword ptr [ESI + 0xa8]
006beae6 : MOV EDX,dword ptr [EBX + 0x74]
006beae9 : MOV ECX,dword ptr [ESI + 0xb0]
006beaef : LEA EDX,[EDX + EAX*0x1 + 0x20]
006beaf3 : AND EDX,0xffffffc0
006beaf6 : MOV dword ptr [ESI + 0xa8],EDX
006beafc : MOV EDX,dword ptr [EBX + 0x78]
006beaff : LEA EDX,[EDX + ECX*0x1 + 0x20]
006beb03 : AND EDX,0xffffffc0
006beb06 : MOV dword ptr [ESI + 0xb0],EDX
006beb0c : MOV EDX,dword ptr [ESI + 0xa8]
006beb12 : SUB EDX,EAX
006beb14 : MOV dword ptr [EBP + 0x90],EDX
006beb1a : MOV EAX,dword ptr [ESI + 0xb0]
006beb20 : SUB EAX,ECX
006beb22 : PUSH EDI
006beb23 : MOV dword ptr [EBP + 0x94],EAX
006beb29 : CALL 0x006863c0
006beb2e : ADD ESP,0x4
006beb31 : JMP 0x006be75f
006beb36 : MOV EBX,dword ptr [EBP + 0x80]
006beb3c : MOVSX ECX,word ptr [EDI + 0x16]
006beb40 : PUSH EBX
006beb41 : PUSH EDI
006beb42 : MOV dword ptr [ESP + 0x3c],EBX
006beb46 : MOV dword ptr [ESP + 0x28],ECX
006beb4a : CALL 0x0068a450
006beb4f : ADD ESP,0x8
006beb52 : MOV dword ptr [ESP + 0x6c],EAX
006beb56 : TEST EAX,EAX
006beb58 : JNZ 0x006bedf4
006beb5e : MOV EAX,dword ptr [EBP + 0x84]
006beb64 : MOV ECX,dword ptr [EDI + 0x58]
006beb67 : MOV EDX,EBX
006beb69 : SHL EDX,0x5
006beb6c : PUSH EDX
006beb6d : PUSH EAX
006beb6e : PUSH ECX
006beb6f : CALL 0x0063ae40
006beb74 : MOV EAX,dword ptr [EDI + 0x30]
006beb77 : ADD ESP,0xc
006beb7a : MOV dword ptr [EDI + 0x54],EBX
006beb7d : MOV dword ptr [ESP + 0x28],0x0
006beb85 : TEST EBX,EBX
006beb87 : JBE 0x006be75f
006beb8d : SHL EAX,0x5
006beb90 : MOV dword ptr [ESP + 0x10],EAX
006beb94 : JMP 0x006beba0
006beba0 : MOV ECX,dword ptr [ESI + 0xac]
006beba6 : MOV EDX,dword ptr [ESI + 0xa8]
006bebac : MOV EAX,dword ptr [EDI + 0x34]
006bebaf : ADD EAX,dword ptr [ESP + 0x10]
006bebb3 : MOVSX EBX,word ptr [EDI + 0x16]
006bebb7 : MOV EAX,dword ptr [EAX]
006bebb9 : MOV dword ptr [ESP + 0x40],ECX
006bebbd : MOV ECX,dword ptr [ESI + 0xb4]
006bebc3 : MOV dword ptr [ESP + 0x48],ECX
006bebc7 : MOV ECX,dword ptr [ESP + 0x7c]
006bebcb : MOV dword ptr [ESP + 0x3c],EDX
006bebcf : MOV EDX,dword ptr [ESI + 0xb0]
006bebd5 : INC ECX
006bebd6 : PUSH ECX
006bebd7 : MOV ECX,dword ptr [ESP + 0x74]
006bebdb : MOV dword ptr [ESP + 0x48],EDX
006bebdf : MOV EDX,dword ptr [ESP + 0x7c]
006bebe3 : PUSH EDX
006bebe4 : PUSH EAX
006bebe5 : PUSH ECX
006bebe6 : PUSH ESI
006bebe7 : MOV dword ptr [ESP + 0x2c],EBX
006bebeb : CALL 0x006be660
006bebf0 : ADD ESP,0x14
006bebf3 : MOV dword ptr [ESP + 0x6c],EAX
006bebf7 : TEST EAX,EAX
006bebf9 : JNZ 0x006bedf4
006bebff : MOV EAX,dword ptr [EDI + 0x34]
006bec02 : ADD EAX,dword ptr [ESP + 0x10]
006bec06 : MOV EDX,0x200
006bec0b : MOV dword ptr [ESP + 0x14],EAX
006bec0f : TEST word ptr [EAX + 0x4],DX
006bec13 : JNZ 0x006bec3d
006bec15 : MOV ECX,dword ptr [ESP + 0x3c]
006bec19 : MOV EDX,dword ptr [ESP + 0x40]
006bec1d : MOV dword ptr [ESI + 0xa8],ECX
006bec23 : MOV ECX,dword ptr [ESP + 0x44]
006bec27 : MOV dword ptr [ESI + 0xac],EDX
006bec2d : MOV EDX,dword ptr [ESP + 0x48]
006bec31 : MOV dword ptr [ESI + 0xb0],ECX
006bec37 : MOV dword ptr [ESI + 0xb4],EDX
006bec3d : MOVSX ECX,word ptr [EDI + 0x16]
006bec41 : SUB ECX,EBX
006bec43 : TEST byte ptr [EAX + 0x4],0xc8
006bec47 : MOV dword ptr [ESP + 0x24],ECX
006bec4b : JZ 0x006bec7e
006bec4d : MOV EDX,dword ptr [EDI + 0x18]
006bec50 : LEA EBX,[EDX + EBX*0x8]
006bec53 : LEA ECX,[EBX + ECX*0x8]
006bec56 : MOV dword ptr [ESP + 0x30],ECX
006bec5a : CMP EBX,ECX
006bec5c : JNC 0x006bec7a
006bec5e : MOV EDI,EDI
006bec60 : ADD EAX,0x10
006bec63 : PUSH EAX
006bec64 : PUSH EBX
006bec65 : CALL 0x00687440
006bec6a : MOV EAX,dword ptr [ESP + 0x1c]
006bec6e : ADD EBX,0x8
006bec71 : ADD ESP,0x8
006bec74 : CMP EBX,dword ptr [ESP + 0x30]
006bec78 : JC 0x006bec60
006bec7a : MOV EBX,dword ptr [ESP + 0x18]
006bec7e : TEST byte ptr [EAX + 0x4],0x2
006bec82 : JNZ 0x006becbe
006bec84 : MOV ECX,dword ptr [EAX + 0x8]
006bec87 : MOV EDX,dword ptr [EAX + 0xc]
006bec8a : MOV EAX,dword ptr [ESP + 0x20]
006bec8e : ADD EAX,ECX
006bec90 : CMP EAX,EBX
006bec92 : JNC 0x006bed52
006bec98 : CMP EDX,dword ptr [ESP + 0x24]
006bec9c : JNC 0x006bed52
006beca2 : MOV ECX,dword ptr [EDI + 0x18]
006beca5 : ADD EDX,EBX
006beca7 : ADD EDX,dword ptr [ESP + 0x20]
006becab : MOV EBX,dword ptr [ECX + EAX*0x8]
006becae : MOV EAX,dword ptr [ECX + EAX*0x8 + 0x4]
006becb2 : SUB EBX,dword ptr [ECX + EDX*0x8]
006becb5 : SUB EAX,dword ptr [ECX + EDX*0x8 + 0x4]
006becb9 : LEA EDX,[ECX + EDX*0x8]
006becbc : JMP 0x006becf2
006becbe : MOV ECX,dword ptr [ESI + 0x10]
006becc1 : MOV EDX,dword ptr [EAX + 0x8]
006becc4 : PUSH ECX
006becc5 : PUSH EDX
006becc6 : CALL 0x00685ea0
006beccb : ADD EAX,dword ptr [ESI + 0x14]
006becce : MOV ECX,dword ptr [ESP + 0x1c]
006becd2 : MOV EDX,dword ptr [ECX + 0xc]
006becd5 : LEA EBX,[EAX + 0x20]
006becd8 : MOV EAX,dword ptr [ESI + 0x18]
006becdb : PUSH EAX
006becdc : PUSH EDX
006becdd : AND EBX,0xffffffc0
006bece0 : CALL 0x00685ea0
006bece5 : MOV ECX,dword ptr [ESI + 0x1c]
006bece8 : LEA EAX,[EAX + ECX*0x1 + 0x20]
006becec : ADD ESP,0x10
006becef : AND EAX,0xffffffc0
006becf2 : MOV EDX,dword ptr [EDI + 0x14]
006becf5 : MOV ECX,dword ptr [EDI + 0x18]
006becf8 : MOV dword ptr [ESP + 0x54],EDX
006becfc : MOV EDX,dword ptr [EDI + 0x1c]
006becff : MOV dword ptr [ESP + 0x5c],EDX
006bed03 : MOV EDX,dword ptr [EDI + 0x20]
006bed06 : MOV dword ptr [ESP + 0x60],EDX
006bed0a : MOV EDX,dword ptr [EDI + 0x24]
006bed0d : MOV dword ptr [ESP + 0x64],EDX
006bed11 : MOV EDX,dword ptr [ESP + 0x18]
006bed15 : PUSH EAX
006bed16 : LEA ECX,[ECX + EDX*0x8]
006bed19 : MOV DX,word ptr [ESP + 0x28]
006bed1e : LEA EAX,[ESP + 0x58]
006bed22 : PUSH EBX
006bed23 : PUSH EAX
006bed24 : MOV dword ptr [ESP + 0x64],ECX
006bed28 : MOV word ptr [ESP + 0x62],DX
006bed2d : CALL 0x00687400
006bed32 : MOV EAX,dword ptr [ESP + 0x34]
006bed36 : ADD dword ptr [ESP + 0x1c],0x20
006bed3b : INC EAX
006bed3c : ADD ESP,0xc
006bed3f : MOV dword ptr [ESP + 0x28],EAX
006bed43 : CMP EAX,dword ptr [ESP + 0x34]
006bed47 : JC 0x006beba0
006bed4d : JMP 0x006be75f
006bed52 : POP EDI
006bed53 : POP ESI
006bed54 : POP EBP
006bed55 : MOV EAX,0x15
006bed5a : POP EBX
006bed5b : ADD ESP,0x58
006bed5e : RET
006bed5f : MOV EDX,dword ptr [EBX + 0x8]
006bed62 : MOV EAX,dword ptr [EBP + 0x28]
006bed65 : PUSH EDX
006bed66 : PUSH EAX
006bed67 : CALL 0x00685ea0
006bed6c : ADD ESP,0x8
006bed6f : MOV dword ptr [EBP + 0x28],EAX
006bed72 : XOR EAX,EAX
006bed74 : MOV dword ptr [EBP + 0x90],EAX
006bed7a : MOV dword ptr [EBP + 0x94],EAX
006bed80 : MOV ECX,dword ptr [EBX + 0xc]
006bed83 : MOV EDX,dword ptr [EBP + 0x34]
006bed86 : PUSH ECX
006bed87 : PUSH EDX
006bed88 : CALL 0x00685ea0
006bed8d : MOV ECX,dword ptr [EBP + 0x28]
006bed90 : MOV ESI,dword ptr [ESP + 0x34]
006bed94 : ADD ECX,0x20
006bed97 : ADD EAX,0x20
006bed9a : AND ECX,0xffffffc0
006bed9d : AND EAX,0xffffffc0
006beda0 : MOV dword ptr [EBP + 0x28],ECX
006beda3 : MOV dword ptr [EBP + 0x34],EAX
006beda6 : MOV EDX,dword ptr [ESI]
006beda8 : PUSH EDX
006beda9 : CALL 0x00686310
006bedae : MOV EAX,dword ptr [ESI]
006bedb0 : PUSH EDI
006bedb1 : PUSH EAX
006bedb2 : CALL 0x0068a4b0
006bedb7 : ADD ESP,0x14
006bedba : TEST EAX,EAX
006bedbc : JNZ 0x006bedf4
006bedbe : MOV ECX,dword ptr [ESI]
006bedc0 : MOV EDX,dword ptr [ECX + 0x14]
006bedc3 : ADD ECX,0x14
006bedc6 : MOV dword ptr [EBP + 0x6c],EDX
006bedc9 : MOV EDX,dword ptr [ECX + 0x4]
006bedcc : MOV dword ptr [EBP + 0x70],EDX
006bedcf : MOV EDX,dword ptr [ECX + 0x8]
006bedd2 : MOV dword ptr [EBP + 0x74],EDX
006bedd5 : MOV EDX,dword ptr [ECX + 0xc]
006bedd8 : MOV dword ptr [EBP + 0x78],EDX
006beddb : MOV ECX,dword ptr [ECX + 0x10]
006bedde : POP EDI
006beddf : POP ESI
006bede0 : MOV dword ptr [EBP + 0x7c],ECX
006bede3 : MOV dword ptr [EBP + 0x48],0x6f75746c
006bedea : POP EBP
006bedeb : POP EBX
006bedec : ADD ESP,0x58
006bedef : RET
006bedf0 : MOV EAX,dword ptr [ESP + 0x6c]
006bedf4 : POP EDI
006bedf5 : POP ESI
006bedf6 : POP EBP
006bedf7 : POP EBX
006bedf8 : ADD ESP,0x58
006bedfb : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00466850
ENTRY    : 00466850
BODY     : [[00466850, 00466c6d]]

============================================================
DECOMPILED C CODE
============================================================

byte FUN_00466850(int param_1,short param_2)

{
  int iVar1;
  int *piVar2;
  bool bVar3;
  char cVar4;
  byte bVar5;
  byte bVar6;
  byte bVar7;
  int in_EAX;
  int iVar8;
  int iVar9;
  int iVar10;
  int *piVar11;
  int iVar12;
  int iVar13;
  int *piVar14;
  int iVar15;
  undefined4 uVar16;
  undefined4 uVar17;
  int local_28;
  int local_24;
  int local_c;
  bool local_6;
  byte local_5;
  
  local_5 = 0;
  if ((*(int *)(param_1 + 4) == 0) || (*(int *)(param_1 + 0x10) == 0)) {
    return 1;
  }
  cVar4 = FUN_0046c730();
  if (cVar4 != '\0') {
    iVar13 = *(int *)(param_1 + 4);
    local_5 = 1;
    bVar3 = false;
    local_28 = 0;
    if (0 < *(int *)(iVar13 + 8)) {
      do {
        iVar13 = *(int *)(*(int *)(iVar13 + 4) + local_28 * 4);
        if (((*(char *)(iVar13 + 0x1f7) != '\0') && (iVar8 = FUN_0046c9c0(local_28), iVar8 != 0)) &&
           (iVar1 = *(int *)(iVar8 + 8), iVar1 != 0)) {
          if (!bVar3) {
            bVar5 = FUN_0046ab70();
            local_5 = local_5 & bVar5;
            bVar3 = true;
          }
          bVar5 = FUN_0046ab90();
          iVar9 = (**(code **)(*DAT_01720efc + 0x1a0))
                            (DAT_01720efc,*(undefined4 *)(iVar13 + 0x1020));
          local_5 = local_5 & bVar5 & iVar9 == 0;
          *(int *)(in_EAX + 0x74f4) = *(int *)(in_EAX + 0x74f4) + 1;
          FUN_0046a440();
          if (0 < iVar1) {
            iVar10 = 0;
            iVar9 = iVar1;
            do {
              if (*(char *)(*(char *)(iVar10 + 0x1f + *(int *)(iVar8 + 4)) + 1 +
                           *(int *)(iVar13 + 0xeb0)) != '\0') {
                *(int *)(in_EAX + 0x74e8) = *(int *)(in_EAX + 0x74e8) + 1;
              }
              iVar10 = iVar10 + 0x20;
              iVar9 = iVar9 + -1;
            } while (iVar9 != 0);
          }
          piVar11 = *(int **)(iVar13 + 0xec4);
          if (piVar11 != piVar11 + *(int *)(iVar13 + 0xec8)) {
            do {
              iVar9 = *piVar11;
              iVar15 = iVar9 * 0x1128 + *(int *)(iVar13 + 0xda8);
              iVar10 = FUN_0046a050(in_EAX,iVar15,0);
              if (0 < iVar10) {
                *(int *)(in_EAX + 0x74ec) = *(int *)(in_EAX + 0x74ec) + iVar10;
              }
              iVar10 = *(int *)(iVar15 + 0x58);
              cVar4 = (**(code **)(*(int *)PTR_DAT_00d6df20 + 4))();
              if (cVar4 != '\0') {
                iVar10 = *(int *)(&DAT_00d72c28 + iVar10 * 4);
              }
              if (iVar10 == 2) {
                uVar16 = 2;
              }
              else if (iVar10 == 1) {
                uVar16 = 3;
              }
              else {
                uVar16 = 1;
              }
              (**(code **)(*DAT_01720efc + 0xe4))(DAT_01720efc,0x16,uVar16);
              if (0 < iVar1) {
                local_c = 0;
                local_24 = iVar1;
                do {
                  piVar14 = (int *)(*(int *)(iVar8 + 4) + local_c);
                  if (-1 < *(char *)((int)piVar14 + 0x1f)) {
                    iVar10 = *piVar14;
                    if (param_2 == 1) {
                      if (*(char *)(iVar10 + 0x12d) == '\0') {
LAB_00466a38:
                        iVar12 = *(int *)(iVar13 + 0xe90) * iVar9 +
                                 (int)*(char *)((int)piVar14 + 0x1f);
                        iVar15 = *(int *)(iVar13 + 0xe9c) + iVar12 * 0x14;
                        if (*(int *)(*(int *)(iVar13 + 0xe9c) + iVar12 * 0x14) != -1) {
                          local_6 = false;
                          if (*(int *)(in_EAX + 0x32b8) != 0) {
                            piVar2 = *(int **)(*(int *)(in_EAX + 0x32c0) + 0xc);
                            iVar12 = (**(code **)(*piVar2 + 0x4c))
                                               (piVar2,DAT_01720efc,*(int *)(in_EAX + 0x32b8),iVar10
                                               );
                            local_6 = -1 < iVar12;
                          }
                          if (*(int *)(in_EAX + 0x32bc) != 0) {
                            piVar2 = *(int **)(*(int *)(in_EAX + 0x32c0) + 0x10);
                            iVar12 = (**(code **)(*piVar2 + 0x4c))
                                               (piVar2,DAT_01720efc,*(int *)(in_EAX + 0x32bc),iVar10
                                               );
                            local_6 = -1 < iVar12;
                          }
                          bVar5 = FUN_0046c3b0((float)(int)*(char *)(iVar10 + 0x21) * 0.007874016,
                                               piVar14[6],piVar14[2]);
                          if (*(char *)(iVar10 + 300) == '\0') {
                            uVar16 = 0;
                            uVar17 = 0;
                          }
                          else {
                            uVar16 = *(undefined4 *)(iVar10 + 0x134);
                            uVar17 = *(undefined4 *)(iVar10 + 0x138);
                          }
                          bVar6 = FUN_0046c4d0(uVar16,uVar17);
                          if (*(char *)(iVar10 + 0x12d) == '\0') {
                            uVar16 = 0x3f800000;
                          }
                          else {
                            uVar16 = 0x3e99999a;
                          }
                          FUN_0046c5e0(uVar16);
                          if (*(int *)(iVar15 + 8) == 0) {
                            bVar7 = 0;
                          }
                          else {
                            bVar7 = FUN_0046c640(*(undefined4 *)(iVar15 + 4),
                                                 *(undefined4 *)(iVar15 + 0xc),
                                                 *(undefined4 *)(iVar15 + 0x10));
                          }
                          local_5 = local_5 & bVar5 & local_6 & bVar6 & bVar7;
                          *(int *)(in_EAX + 0x74f0) = *(int *)(in_EAX + 0x74f0) + 1;
                          *(int *)(in_EAX + 0x74f8) =
                               *(int *)(in_EAX + 0x74f8) + *(uint *)(iVar15 + 8) / 3;
                        }
                      }
                    }
                    else if ((param_2 != 2) || (*(char *)(iVar10 + 0x12d) != '\0'))
                    goto LAB_00466a38;
                  }
                  local_c = local_c + 0x20;
                  local_24 = local_24 + -1;
                } while (local_24 != 0);
              }
              piVar11 = piVar11 + 1;
            } while (piVar11 != (int *)(*(int *)(iVar13 + 0xec4) + *(int *)(iVar13 + 0xec8) * 4));
          }
          iVar13 = (**(code **)(*DAT_01720efc + 400))(DAT_01720efc,0,0,0,0);
          iVar8 = (**(code **)(*DAT_01720efc + 0x1a0))(DAT_01720efc,0);
          local_5 = local_5 & iVar13 == 0 & iVar8 == 0;
        }
        iVar13 = *(int *)(param_1 + 4);
        local_28 = local_28 + 1;
      } while (local_28 < *(int *)(iVar13 + 8));
    }
    (**(code **)(*DAT_01720efc + 0x170))(DAT_01720efc,0);
    (**(code **)(*DAT_01720efc + 0x1ac))(DAT_01720efc,0);
  }
  return local_5;
}



============================================================
DISASSEMBLY
============================================================
00466850 : PUSH EBP
00466851 : MOV EBP,ESP
00466853 : SUB ESP,0x2c
00466856 : PUSH EBX
00466857 : MOV EBX,dword ptr [EBP + 0x8]
0046685a : CMP dword ptr [EBX + 0x4],0x0
0046685e : PUSH ESI
0046685f : PUSH EDI
00466860 : MOV EDI,EAX
00466862 : MOV byte ptr [EBP + -0x1],0x0
00466866 : JZ 0x00466c63
0046686c : CMP dword ptr [EBX + 0x10],0x0
00466870 : JZ 0x00466c63
00466876 : LEA EAX,[EDI + 0x1f34]
0046687c : CALL 0x0046c730
00466881 : TEST AL,AL
00466883 : JZ 0x00466c57
00466889 : MOV EAX,dword ptr [EBX + 0x4]
0046688c : XOR ESI,ESI
0046688e : CMP dword ptr [EAX + 0x8],ESI
00466891 : MOV byte ptr [EBP + -0x1],0x1
00466895 : MOV byte ptr [EBP + -0x3],0x0
00466899 : MOV dword ptr [EBP + -0x24],ESI
0046689c : JLE 0x00466c2f
004668a2 : MOV EAX,dword ptr [EAX + 0x4]
004668a5 : MOV EBX,dword ptr [EAX + ESI*0x4]
004668a8 : CMP byte ptr [EBX + 0x1f7],0x0
004668af : MOV dword ptr [EBP + -0x1c],EBX
004668b2 : JZ 0x00466c12
004668b8 : MOV EAX,dword ptr [EBP + 0x8]
004668bb : PUSH ESI
004668bc : CALL 0x0046c9c0
004668c1 : MOV dword ptr [EBP + -0x14],EAX
004668c4 : TEST EAX,EAX
004668c6 : JZ 0x00466c12
004668cc : MOV EAX,dword ptr [EAX + 0x8]
004668cf : MOV dword ptr [EBP + -0x10],EAX
004668d2 : TEST EAX,EAX
004668d4 : JZ 0x00466c12
004668da : CMP byte ptr [EBP + -0x3],0x0
004668de : LEA ESI,[EBX + 0x1010]
004668e4 : JNZ 0x004668f4
004668e6 : MOV EDX,ESI
004668e8 : CALL 0x0046ab70
004668ed : AND byte ptr [EBP + -0x1],AL
004668f0 : MOV byte ptr [EBP + -0x3],0x1
004668f4 : MOV ECX,ESI
004668f6 : CALL 0x0046ab90
004668fb : AND byte ptr [EBP + -0x1],AL
004668fe : MOV EAX,[0x01720efc]
00466903 : MOV EDX,dword ptr [ESI + 0x10]
00466906 : MOV ECX,dword ptr [EAX]
00466908 : PUSH EDX
00466909 : PUSH EAX
0046690a : MOV EAX,dword ptr [ECX + 0x1a0]
00466910 : CALL EAX
00466912 : TEST EAX,EAX
00466914 : SETZ CL
00466917 : AND byte ptr [EBP + -0x1],CL
0046691a : INC dword ptr [EDI + 0x74f4]
00466920 : MOV ESI,EBX
00466922 : CALL 0x0046a440
00466927 : MOV ECX,dword ptr [EBP + -0x10]
0046692a : TEST ECX,ECX
0046692c : JLE 0x00466956
0046692e : XOR EAX,EAX
00466930 : MOV EDX,dword ptr [EBP + -0x14]
00466933 : MOV EDX,dword ptr [EDX + 0x4]
00466936 : MOVSX EDX,byte ptr [EAX + EDX*0x1 + 0x1f]
0046693b : MOV ESI,dword ptr [EBX + 0xeb0]
00466941 : CMP byte ptr [EDX + ESI*0x1 + 0x1],0x0
00466946 : JZ 0x0046694e
00466948 : INC dword ptr [EDI + 0x74e8]
0046694e : ADD EAX,0x20
00466951 : SUB ECX,0x1
00466954 : JNZ 0x00466930
00466956 : MOV EAX,dword ptr [EBX + 0xec4]
0046695c : MOV ECX,dword ptr [EBX + 0xec8]
00466962 : LEA EDX,[EAX + ECX*0x4]
00466965 : MOV dword ptr [EBP + -0xc],EAX
00466968 : CMP EAX,EDX
0046696a : JZ 0x00466bd1
00466970 : JMP 0x00466975
00466972 : MOV EAX,dword ptr [EBP + -0xc]
00466975 : MOV ESI,dword ptr [EAX]
00466977 : MOV dword ptr [EBP + -0x28],ESI
0046697a : IMUL ESI,ESI,0x1128
00466980 : ADD ESI,dword ptr [EBX + 0xda8]
00466986 : PUSH 0x0
00466988 : PUSH ESI
00466989 : PUSH EDI
0046698a : CALL 0x0046a050
0046698f : TEST EAX,EAX
00466991 : JLE 0x0046699d
00466993 : AND byte ptr [EBP + -0x1],0x1
00466997 : ADD dword ptr [EDI + 0x74ec],EAX
0046699d : MOV ECX,dword ptr [0x00d6df20]
004669a3 : MOV EAX,dword ptr [ECX]
004669a5 : MOV EDX,dword ptr [EAX + 0x4]
004669a8 : MOV ESI,dword ptr [ESI + 0x58]
004669ab : CALL EDX
004669ad : TEST AL,AL
004669af : JZ 0x004669b8
004669b1 : MOV ESI,dword ptr [ESI*0x4 + 0xd72c28]
004669b8 : CMP ESI,0x2
004669bb : JNZ 0x004669c0
004669bd : PUSH ESI
004669be : JMP 0x004669cb
004669c0 : CMP ESI,0x1
004669c3 : JNZ 0x004669c9
004669c5 : PUSH 0x3
004669c7 : JMP 0x004669cb
004669c9 : PUSH 0x1
004669cb : MOV EAX,[0x01720efc]
004669d0 : MOV ECX,dword ptr [EAX]
004669d2 : MOV EDX,dword ptr [ECX + 0xe4]
004669d8 : PUSH 0x16
004669da : PUSH EAX
004669db : CALL EDX
004669dd : MOV EAX,dword ptr [EBP + -0x10]
004669e0 : TEST EAX,EAX
004669e2 : JLE 0x00466bb1
004669e8 : MOV dword ptr [EBP + -0x8],0x0
004669ef : MOV dword ptr [EBP + -0x20],EAX
004669f2 : MOV EAX,dword ptr [EBP + -0x14]
004669f5 : MOV ECX,dword ptr [EAX + 0x4]
004669f8 : ADD ECX,dword ptr [EBP + -0x8]
004669fb : MOV DL,byte ptr [ECX + 0x1f]
004669fe : CMP DL,0xff
00466a01 : MOV dword ptr [EBP + -0x18],ECX
00466a04 : JLE 0x00466ba3
00466a0a : MOV AX,word ptr [EBP + 0xc]
00466a0e : MOV ESI,dword ptr [ECX]
00466a10 : CMP AX,0x1
00466a14 : JNZ 0x00466a25
00466a16 : CMP byte ptr [ESI + 0x12d],0x0
00466a1d : JNZ 0x00466ba3
00466a23 : JMP 0x00466a38
00466a25 : CMP AX,0x2
00466a29 : JNZ 0x00466a38
00466a2b : CMP byte ptr [ESI + 0x12d],0x0
00466a32 : JZ 0x00466ba3
00466a38 : MOV EAX,dword ptr [EBX + 0xe90]
00466a3e : IMUL EAX,dword ptr [EBP + -0x28]
00466a42 : MOVSX EDX,DL
00466a45 : ADD EAX,EDX
00466a47 : MOV EDX,dword ptr [EBX + 0xe9c]
00466a4d : LEA EAX,[EAX + EAX*0x4]
00466a50 : CMP dword ptr [EDX + EAX*0x4],-0x1
00466a54 : LEA EBX,[EDX + EAX*0x4]
00466a57 : JZ 0x00466ba0
00466a5d : MOV EDX,dword ptr [EDI + 0x32b8]
00466a63 : MOV byte ptr [EBP + -0x2],0x0
00466a67 : TEST EDX,EDX
00466a69 : JZ 0x00466a8e
00466a6b : MOV EAX,dword ptr [EDI + 0x32c0]
00466a71 : MOV EAX,dword ptr [EAX + 0xc]
00466a74 : MOV ECX,dword ptr [EAX]
00466a76 : PUSH ESI
00466a77 : PUSH EDX
00466a78 : MOV EDX,dword ptr [0x01720efc]
00466a7e : PUSH EDX
00466a7f : PUSH EAX
00466a80 : MOV EAX,dword ptr [ECX + 0x4c]
00466a83 : CALL EAX
00466a85 : MOV ECX,dword ptr [EBP + -0x18]
00466a88 : TEST EAX,EAX
00466a8a : SETGE byte ptr [EBP + -0x2]
00466a8e : MOV EDX,dword ptr [EDI + 0x32bc]
00466a94 : TEST EDX,EDX
00466a96 : JZ 0x00466abb
00466a98 : MOV ECX,dword ptr [EDI + 0x32c0]
00466a9e : MOV EAX,dword ptr [ECX + 0x10]
00466aa1 : MOV ECX,dword ptr [EAX]
00466aa3 : PUSH ESI
00466aa4 : PUSH EDX
00466aa5 : MOV EDX,dword ptr [0x01720efc]
00466aab : PUSH EDX
00466aac : PUSH EAX
00466aad : MOV EAX,dword ptr [ECX + 0x4c]
00466ab0 : CALL EAX
00466ab2 : MOV ECX,dword ptr [EBP + -0x18]
00466ab5 : TEST EAX,EAX
00466ab7 : SETGE byte ptr [EBP + -0x2]
00466abb : MOVSX EAX,byte ptr [ESI + 0x21]
00466abf : MOVSX EDX,byte ptr [ESI + 0x20]
00466ac3 : MOV dword ptr [EBP + -0x18],EAX
00466ac6 : SUB ESP,0xc
00466ac9 : CVTSI2SS XMM0,EDX
00466acd : FILD dword ptr [EBP + -0x18]
00466ad0 : MULSS XMM0,dword ptr [0x00cdf310]
00466ad8 : LEA EAX,[EDI + 0x33cc]
00466ade : FMUL float ptr [0x00cdf310]
00466ae4 : FLD float ptr [ECX + 0x18]
00466ae7 : FLD float ptr [ECX + 0x8]
00466aea : FSTP float ptr [ESP + 0x8]
00466aee : FSTP float ptr [ESP + 0x4]
00466af2 : FSTP float ptr [ESP]
00466af5 : CALL 0x0046c3b0
00466afa : AND AL,byte ptr [EBP + -0x2]
00466afd : SUB ESP,0x8
00466b00 : AND byte ptr [EBP + -0x1],AL
00466b03 : CMP byte ptr [ESI + 0x12c],0x0
00466b0a : LEA EAX,[EDI + 0x6778]
00466b10 : JZ 0x00466b2c
00466b12 : FLD float ptr [ESI + 0x134]
00466b18 : MOVSS XMM0,dword ptr [ESI + 0x130]
00466b20 : FLD float ptr [ESI + 0x138]
00466b26 : FSTP float ptr [ESP + 0x4]
00466b2a : JMP 0x00466b35
00466b2c : FLDZ
00466b2e : XORPS XMM0,XMM0
00466b31 : FST float ptr [ESP + 0x4]
00466b35 : FSTP float ptr [ESP]
00466b38 : CALL 0x0046c4d0
00466b3d : AND byte ptr [EBP + -0x1],AL
00466b40 : CMP byte ptr [ESI + 0x12d],0x0
00466b47 : PUSH ECX
00466b48 : LEA ESI,[EDI + 0x6890]
00466b4e : JZ 0x00466b58
00466b50 : FLD float ptr [0x00cdf0e8]
00466b56 : JMP 0x00466b5a
00466b58 : FLD1
00466b5a : FSTP float ptr [ESP]
00466b5d : CALL 0x0046c5e0
00466b62 : MOV ECX,dword ptr [EBX + 0x8]
00466b65 : AND byte ptr [EBP + -0x1],0x1
00466b69 : MOV EAX,dword ptr [EBX + 0x10]
00466b6c : MOV EDX,dword ptr [EBX + 0xc]
00466b6f : MOV ESI,dword ptr [EBX + 0x4]
00466b72 : TEST ECX,ECX
00466b74 : JBE 0x00466b85
00466b76 : PUSH EAX
00466b77 : PUSH EDX
00466b78 : PUSH ESI
00466b79 : MOV EAX,0x6
00466b7e : CALL 0x0046c640
00466b83 : JMP 0x00466b87
00466b85 : XOR AL,AL
00466b87 : AND byte ptr [EBP + -0x1],AL
00466b8a : INC dword ptr [EDI + 0x74f0]
00466b90 : MOV EAX,0xaaaaaaab
00466b95 : MUL dword ptr [EBX + 0x8]
00466b98 : SHR EDX,0x1
00466b9a : ADD dword ptr [EDI + 0x74f8],EDX
00466ba0 : MOV EBX,dword ptr [EBP + -0x1c]
00466ba3 : ADD dword ptr [EBP + -0x8],0x20
00466ba7 : SUB dword ptr [EBP + -0x20],0x1
00466bab : JNZ 0x004669f2
00466bb1 : MOV EAX,dword ptr [EBP + -0xc]
00466bb4 : MOV ECX,dword ptr [EBX + 0xec8]
00466bba : MOV EDX,dword ptr [EBX + 0xec4]
00466bc0 : ADD EAX,0x4
00466bc3 : LEA ECX,[EDX + ECX*0x4]
00466bc6 : MOV dword ptr [EBP + -0xc],EAX
00466bc9 : CMP EAX,ECX
00466bcb : JNZ 0x00466972
00466bd1 : MOV EAX,[0x01720efc]
00466bd6 : MOV EDX,dword ptr [EAX]
00466bd8 : PUSH 0x0
00466bda : PUSH 0x0
00466bdc : PUSH 0x0
00466bde : PUSH 0x0
00466be0 : PUSH EAX
00466be1 : MOV EAX,dword ptr [EDX + 0x190]
00466be7 : CALL EAX
00466be9 : MOV BL,byte ptr [EBP + -0x1]
00466bec : TEST EAX,EAX
00466bee : MOV EAX,[0x01720efc]
00466bf3 : MOV EDX,dword ptr [EAX]
00466bf5 : PUSH 0x0
00466bf7 : SETZ CL
00466bfa : PUSH EAX
00466bfb : MOV EAX,dword ptr [EDX + 0x1a0]
00466c01 : AND BL,CL
00466c03 : CALL EAX
00466c05 : MOV ESI,dword ptr [EBP + -0x24]
00466c08 : TEST EAX,EAX
00466c0a : SETZ CL
00466c0d : AND BL,CL
00466c0f : MOV byte ptr [EBP + -0x1],BL
00466c12 : MOV EDX,dword ptr [EBP + 0x8]
00466c15 : MOV EAX,dword ptr [EDX + 0x4]
00466c18 : INC ESI
00466c19 : CMP ESI,dword ptr [EAX + 0x8]
00466c1c : MOV dword ptr [EBP + -0x24],ESI
00466c1f : JL 0x004668a2
00466c25 : CMP byte ptr [EBP + -0x3],0x0
00466c29 : JZ 0x00466c2f
00466c2b : AND byte ptr [EBP + -0x1],0x1
00466c2f : MOV EAX,[0x01720efc]
00466c34 : MOV ECX,dword ptr [EAX]
00466c36 : MOV EDX,dword ptr [ECX + 0x170]
00466c3c : PUSH 0x0
00466c3e : PUSH EAX
00466c3f : CALL EDX
00466c41 : MOV EAX,[0x01720efc]
00466c46 : MOV ECX,dword ptr [EAX]
00466c48 : MOV EDX,dword ptr [ECX + 0x1ac]
00466c4e : PUSH 0x0
00466c50 : PUSH EAX
00466c51 : CALL EDX
00466c53 : AND byte ptr [EBP + -0x1],0x1
00466c57 : MOV AL,byte ptr [EBP + -0x1]
00466c5a : POP EDI
00466c5b : POP ESI
00466c5c : POP EBX
00466c5d : MOV ESP,EBP
00466c5f : POP EBP
00466c60 : RET 0x8
00466c63 : POP EDI
00466c64 : POP ESI
00466c65 : MOV AL,0x1
00466c67 : POP EBX
00466c68 : MOV ESP,EBP
00466c6a : POP EBP
00466c6b : RET 0x8

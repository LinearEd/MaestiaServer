PROGRAM  : Maestia.exe
FUNCTION : FUN_006dd0e0
ENTRY    : 006dd0e0
BODY     : [[006dd0e0, 006dd169] [006dd170, 006dd276]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_006dd0e0(int param_1,short *param_2,int param_3,undefined4 *param_4)

{
  char cVar1;
  int in_EAX;
  int iVar2;
  int iVar3;
  int iVar4;
  int *local_4;
  
  param_3 = *param_2 - param_3;
  iVar2 = param_3;
  if (param_3 < 0) {
    iVar2 = -param_3;
    param_3 = param_3 + -1;
  }
  iVar4 = 0;
  if (iVar2 != 0) {
    do {
      iVar4 = iVar4 + 1;
      iVar2 = iVar2 >> 1;
    } while (iVar2 != 0);
    if (0xb < iVar4) {
      *(undefined4 *)(**(int **)(param_1 + 0x20) + 0x14) = 6;
      (**(code **)**(undefined4 **)(param_1 + 0x20))(*(undefined4 **)(param_1 + 0x20));
    }
  }
  cVar1 = FUN_006dd000(*(undefined4 *)(in_EAX + iVar4 * 4));
  if ((cVar1 != '\0') && ((iVar4 == 0 || (cVar1 = FUN_006dd000(param_3), cVar1 != '\0')))) {
    iVar2 = 0;
    local_4 = &DAT_00bf1574;
    do {
      param_3 = (int)param_2[*local_4];
      if (param_3 == 0) {
        iVar2 = iVar2 + 1;
      }
      else {
        for (; 0xf < iVar2; iVar2 = iVar2 + -0x10) {
          cVar1 = FUN_006dd000(param_4[0xf0]);
          if (cVar1 == '\0') {
            return 0;
          }
        }
        iVar4 = param_3;
        if (param_3 < 0) {
          iVar4 = -param_3;
          param_3 = param_3 + -1;
        }
        iVar4 = iVar4 >> 1;
        iVar3 = 1;
        if (iVar4 != 0) {
          do {
            iVar3 = iVar3 + 1;
            iVar4 = iVar4 >> 1;
          } while (iVar4 != 0);
          if (10 < iVar3) {
            *(undefined4 *)(**(int **)(param_1 + 0x20) + 0x14) = 6;
            (**(code **)**(undefined4 **)(param_1 + 0x20))(*(undefined4 **)(param_1 + 0x20));
          }
        }
        cVar1 = FUN_006dd000(param_4[iVar2 * 0x10 + iVar3]);
        if (cVar1 == '\0') {
          return 0;
        }
        cVar1 = FUN_006dd000(param_3);
        if (cVar1 == '\0') {
          return 0;
        }
        iVar2 = 0;
      }
      local_4 = local_4 + 1;
    } while ((int)local_4 < 0xbf1670);
    if ((iVar2 < 1) || (cVar1 = FUN_006dd000(*param_4), cVar1 != '\0')) {
      return 1;
    }
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
006dd0e0 : PUSH ECX
006dd0e1 : PUSH EBX
006dd0e2 : PUSH EBP
006dd0e3 : MOV EBP,dword ptr [ESP + 0x10]
006dd0e7 : MOV EBX,EAX
006dd0e9 : MOV EAX,dword ptr [ESP + 0x14]
006dd0ed : PUSH ESI
006dd0ee : MOVSX ESI,word ptr [EAX]
006dd0f1 : SUB ESI,dword ptr [ESP + 0x1c]
006dd0f5 : PUSH EDI
006dd0f6 : MOV EAX,ESI
006dd0f8 : JNS 0x006dd0fd
006dd0fa : NEG EAX
006dd0fc : DEC ESI
006dd0fd : XOR EDI,EDI
006dd0ff : TEST EAX,EAX
006dd101 : JZ 0x006dd126
006dd103 : INC EDI
006dd104 : SAR EAX,0x1
006dd106 : JNZ 0x006dd103
006dd108 : CMP EDI,0xb
006dd10b : JLE 0x006dd126
006dd10d : MOV ECX,dword ptr [EBP + 0x20]
006dd110 : MOV EDX,dword ptr [ECX]
006dd112 : MOV dword ptr [EDX + 0x14],0x6
006dd119 : MOV EAX,dword ptr [EBP + 0x20]
006dd11c : MOV ECX,dword ptr [EAX]
006dd11e : MOV EDX,dword ptr [ECX]
006dd120 : PUSH EAX
006dd121 : CALL EDX
006dd123 : ADD ESP,0x4
006dd126 : MOV ECX,dword ptr [EBX + EDI*0x4]
006dd129 : MOVSX EAX,byte ptr [EDI + EBX*0x1 + 0x400]
006dd131 : PUSH ECX
006dd132 : MOV ECX,EBP
006dd134 : CALL 0x006dd000
006dd139 : ADD ESP,0x4
006dd13c : TEST AL,AL
006dd13e : JNZ 0x006dd148
006dd140 : POP EDI
006dd141 : POP ESI
006dd142 : POP EBP
006dd143 : XOR AL,AL
006dd145 : POP EBX
006dd146 : POP ECX
006dd147 : RET
006dd148 : TEST EDI,EDI
006dd14a : JZ 0x006dd15d
006dd14c : PUSH ESI
006dd14d : MOV EAX,EDI
006dd14f : MOV ECX,EBP
006dd151 : CALL 0x006dd000
006dd156 : ADD ESP,0x4
006dd159 : TEST AL,AL
006dd15b : JZ 0x006dd140
006dd15d : MOV EAX,0xbf1574
006dd162 : XOR ESI,ESI
006dd164 : MOV dword ptr [ESP + 0x10],EAX
006dd168 : JMP 0x006dd170
006dd170 : MOV EDX,dword ptr [EAX]
006dd172 : MOV ECX,dword ptr [ESP + 0x1c]
006dd176 : MOVSX EDI,word ptr [ECX + EDX*0x2]
006dd17a : TEST EDI,EDI
006dd17c : JNZ 0x006dd184
006dd17e : INC ESI
006dd17f : JMP 0x006dd239
006dd184 : CMP ESI,0xf
006dd187 : JLE 0x006dd1b8
006dd189 : LEA ESP,[ESP]
006dd190 : MOV ECX,dword ptr [ESP + 0x24]
006dd194 : MOV EDX,dword ptr [ECX + 0x3c0]
006dd19a : MOVSX EAX,byte ptr [ECX + 0x4f0]
006dd1a1 : PUSH EDX
006dd1a2 : MOV ECX,EBP
006dd1a4 : CALL 0x006dd000
006dd1a9 : ADD ESP,0x4
006dd1ac : TEST AL,AL
006dd1ae : JZ 0x006dd140
006dd1b0 : SUB ESI,0x10
006dd1b3 : CMP ESI,0xf
006dd1b6 : JG 0x006dd190
006dd1b8 : MOV dword ptr [ESP + 0x20],EDI
006dd1bc : TEST EDI,EDI
006dd1be : JGE 0x006dd1c6
006dd1c0 : NEG EDI
006dd1c2 : DEC dword ptr [ESP + 0x20]
006dd1c6 : SAR EDI,0x1
006dd1c8 : MOV EBX,0x1
006dd1cd : JZ 0x006dd1f3
006dd1cf : NOP
006dd1d0 : INC EBX
006dd1d1 : SAR EDI,0x1
006dd1d3 : JNZ 0x006dd1d0
006dd1d5 : CMP EBX,0xa
006dd1d8 : JLE 0x006dd1f3
006dd1da : MOV EAX,dword ptr [EBP + 0x20]
006dd1dd : MOV ECX,dword ptr [EAX]
006dd1df : MOV dword ptr [ECX + 0x14],0x6
006dd1e6 : MOV EAX,dword ptr [EBP + 0x20]
006dd1e9 : MOV EDX,dword ptr [EAX]
006dd1eb : PUSH EAX
006dd1ec : MOV EAX,dword ptr [EDX]
006dd1ee : CALL EAX
006dd1f0 : ADD ESP,0x4
006dd1f3 : MOV ECX,dword ptr [ESP + 0x24]
006dd1f7 : SHL ESI,0x4
006dd1fa : ADD ESI,EBX
006dd1fc : MOVSX EAX,byte ptr [ESI + ECX*0x1 + 0x400]
006dd204 : MOV ECX,dword ptr [ECX + ESI*0x4]
006dd207 : PUSH ECX
006dd208 : MOV ECX,EBP
006dd20a : CALL 0x006dd000
006dd20f : ADD ESP,0x4
006dd212 : TEST AL,AL
006dd214 : JZ 0x006dd140
006dd21a : MOV EDX,dword ptr [ESP + 0x20]
006dd21e : PUSH EDX
006dd21f : MOV EAX,EBX
006dd221 : MOV ECX,EBP
006dd223 : CALL 0x006dd000
006dd228 : ADD ESP,0x4
006dd22b : TEST AL,AL
006dd22d : JZ 0x006dd140
006dd233 : MOV EAX,dword ptr [ESP + 0x10]
006dd237 : XOR ESI,ESI
006dd239 : ADD EAX,0x4
006dd23c : CMP EAX,0xbf1670
006dd241 : MOV dword ptr [ESP + 0x10],EAX
006dd245 : JL 0x006dd170
006dd24b : TEST ESI,ESI
006dd24d : JLE 0x006dd26f
006dd24f : MOV ECX,dword ptr [ESP + 0x24]
006dd253 : MOVSX EAX,byte ptr [ECX + 0x400]
006dd25a : MOV ECX,dword ptr [ECX]
006dd25c : PUSH ECX
006dd25d : MOV ECX,EBP
006dd25f : CALL 0x006dd000
006dd264 : ADD ESP,0x4
006dd267 : TEST AL,AL
006dd269 : JZ 0x006dd140
006dd26f : POP EDI
006dd270 : POP ESI
006dd271 : POP EBP
006dd272 : MOV AL,0x1
006dd274 : POP EBX
006dd275 : POP ECX
006dd276 : RET

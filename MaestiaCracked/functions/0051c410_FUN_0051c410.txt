PROGRAM  : Maestia.exe
FUNCTION : FUN_0051c410
ENTRY    : 0051c410
BODY     : [[0051c410, 0051c477]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0051c410(char *param_1,size_t param_2,undefined4 param_3)

{
  char cVar1;
  char *pcVar2;
  undefined4 *in_ECX;
  
  *in_ECX = 0;
  in_ECX[1] = 0;
  in_ECX[2] = 0;
  in_ECX[3] = 0x200;
  *(undefined1 *)(in_ECX + 4) = 0;
  in_ECX[5] = param_3;
  if ((param_1 != (char *)0x0) && (param_2 != 0)) {
    if (param_2 == 0xffffffff) {
      pcVar2 = param_1;
      do {
        cVar1 = *pcVar2;
        pcVar2 = pcVar2 + 1;
      } while (cVar1 != '\0');
      param_2 = (int)pcVar2 - (int)(param_1 + 1);
    }
    FUN_0051b440(param_2);
    _memcpy((void *)*in_ECX,param_1,param_2);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
0051c410 : MOV EAX,dword ptr [ESP + 0xc]
0051c414 : PUSH EBX
0051c415 : MOV EBX,dword ptr [ESP + 0x8]
0051c419 : XOR EDX,EDX
0051c41b : PUSH ESI
0051c41c : MOV ESI,ECX
0051c41e : PUSH EDI
0051c41f : MOV EDI,dword ptr [ESP + 0x14]
0051c423 : MOV dword ptr [ESI],EDX
0051c425 : MOV dword ptr [ESI + 0x4],EDX
0051c428 : MOV dword ptr [ESI + 0x8],EDX
0051c42b : MOV dword ptr [ESI + 0xc],0x200
0051c432 : MOV byte ptr [ESI + 0x10],DL
0051c435 : MOV dword ptr [ESI + 0x14],EAX
0051c438 : CMP EBX,EDX
0051c43a : JZ 0x0051c470
0051c43c : CMP EDI,EDX
0051c43e : JZ 0x0051c470
0051c440 : CMP EDI,-0x1
0051c443 : JNZ 0x0051c45b
0051c445 : MOV EAX,EBX
0051c447 : LEA EDI,[EAX + 0x1]
0051c44a : LEA EBX,[EBX]
0051c450 : MOV CL,byte ptr [EAX]
0051c452 : INC EAX
0051c453 : CMP CL,DL
0051c455 : JNZ 0x0051c450
0051c457 : SUB EAX,EDI
0051c459 : MOV EDI,EAX
0051c45b : PUSH EDI
0051c45c : MOV ECX,ESI
0051c45e : CALL 0x0051b440
0051c463 : MOV ECX,dword ptr [ESI]
0051c465 : PUSH EDI
0051c466 : PUSH EBX
0051c467 : PUSH ECX
0051c468 : CALL 0x0063ae40
0051c46d : ADD ESP,0xc
0051c470 : POP EDI
0051c471 : MOV EAX,ESI
0051c473 : POP ESI
0051c474 : POP EBX
0051c475 : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_004c6a80
ENTRY    : 004c6a80
BODY     : [[004c6a80, 004c6b33]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x004c6ac2) */

undefined4 * FUN_004c6a80(void)

{
  uint uVar1;
  uint uVar2;
  int in_EAX;
  int in_ECX;
  ushort *puVar3;
  ushort *puVar4;
  uint uVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  undefined4 *local_c;
  
  local_c = *(undefined4 **)(in_EAX + 4);
  if (*(char *)((int)local_c[1] + 0x41) == '\0') {
    uVar1 = *(uint *)(in_ECX + 0x14);
    puVar6 = (undefined4 *)local_c[1];
    do {
      puVar3 = (ushort *)(in_ECX + 4);
      if (7 < *(uint *)(in_ECX + 0x18)) {
        puVar3 = *(ushort **)(in_ECX + 4);
      }
      uVar2 = puVar6[8];
      uVar5 = uVar2;
      if (uVar1 <= uVar2) {
        uVar5 = uVar1;
      }
      if ((uint)puVar6[9] < 8) {
        puVar4 = (ushort *)(puVar6 + 4);
      }
      else {
        puVar4 = (ushort *)puVar6[4];
      }
      for (; uVar5 != 0; uVar5 = uVar5 - 1) {
        if (*puVar4 != *puVar3) {
          uVar5 = (-(uint)(*puVar4 < *puVar3) & 0xfffffffe) + 1;
          if (uVar5 != 0) goto LAB_004c6b01;
          break;
        }
        puVar4 = puVar4 + 1;
        puVar3 = puVar3 + 1;
      }
      if (uVar2 < uVar1) {
LAB_004c6b05:
        puVar7 = (undefined4 *)puVar6[2];
      }
      else {
        uVar5 = (uint)(uVar2 != uVar1);
LAB_004c6b01:
        if ((int)uVar5 < 0) goto LAB_004c6b05;
        puVar7 = (undefined4 *)*puVar6;
        local_c = puVar6;
      }
      puVar6 = puVar7;
    } while (*(char *)((int)puVar7 + 0x41) == '\0');
  }
  return local_c;
}



============================================================
DISASSEMBLY
============================================================
004c6a80 : PUSH EBP
004c6a81 : MOV EBP,ESP
004c6a83 : SUB ESP,0x10
004c6a86 : MOV EAX,dword ptr [EAX + 0x4]
004c6a89 : PUSH EDI
004c6a8a : MOV EDI,dword ptr [EAX + 0x4]
004c6a8d : CMP byte ptr [EDI + 0x41],0x0
004c6a91 : MOV dword ptr [EBP + -0x8],EAX
004c6a94 : JNZ 0x004c6b2f
004c6a9a : MOV EAX,dword ptr [ECX + 0x14]
004c6a9d : MOV EDX,dword ptr [ECX + 0x18]
004c6aa0 : PUSH EBX
004c6aa1 : ADD ECX,0x4
004c6aa4 : PUSH ESI
004c6aa5 : MOV dword ptr [EBP + -0x4],EAX
004c6aa8 : MOV dword ptr [EBP + -0x10],EDX
004c6aab : MOV dword ptr [EBP + -0xc],ECX
004c6aae : JMP 0x004c6ab3
004c6ab0 : MOV ECX,dword ptr [EBP + -0xc]
004c6ab3 : CMP dword ptr [EBP + -0x10],0x8
004c6ab7 : JC 0x004c6abb
004c6ab9 : MOV ECX,dword ptr [ECX]
004c6abb : MOV EBX,dword ptr [EDI + 0x20]
004c6abe : MOV EDX,EBX
004c6ac0 : CMP EDX,EBX
004c6ac2 : CMOVC EBX,EDX
004c6ac5 : MOV ESI,EBX
004c6ac7 : CMP EBX,EAX
004c6ac9 : JC 0x004c6acd
004c6acb : MOV ESI,EAX
004c6acd : CMP dword ptr [EDI + 0x24],0x8
004c6ad1 : JC 0x004c6ad8
004c6ad3 : MOV EDX,dword ptr [EDI + 0x10]
004c6ad6 : JMP 0x004c6adb
004c6ad8 : LEA EDX,[EDI + 0x10]
004c6adb : TEST ESI,ESI
004c6add : JBE 0x004c6af6
004c6adf : NOP
004c6ae0 : MOV AX,word ptr [EDX]
004c6ae3 : CMP AX,word ptr [ECX]
004c6ae6 : JNZ 0x004c6b0a
004c6ae8 : ADD EDX,0x2
004c6aeb : ADD ECX,0x2
004c6aee : SUB ESI,0x1
004c6af1 : JNZ 0x004c6ae0
004c6af3 : MOV EAX,dword ptr [EBP + -0x4]
004c6af6 : CMP EBX,EAX
004c6af8 : JC 0x004c6b05
004c6afa : XOR ECX,ECX
004c6afc : CMP EBX,EAX
004c6afe : SETNZ CL
004c6b01 : TEST ECX,ECX
004c6b03 : JGE 0x004c6b1f
004c6b05 : MOV EDI,dword ptr [EDI + 0x8]
004c6b08 : JMP 0x004c6b24
004c6b0a : MOV DX,AX
004c6b0d : CMP DX,word ptr [ECX]
004c6b10 : SBB ECX,ECX
004c6b12 : AND ECX,0xfffffffe
004c6b15 : ADD ECX,0x1
004c6b18 : JZ 0x004c6af3
004c6b1a : MOV EAX,dword ptr [EBP + -0x4]
004c6b1d : JMP 0x004c6b01
004c6b1f : MOV dword ptr [EBP + -0x8],EDI
004c6b22 : MOV EDI,dword ptr [EDI]
004c6b24 : CMP byte ptr [EDI + 0x41],0x0
004c6b28 : JZ 0x004c6ab0
004c6b2a : MOV EAX,dword ptr [EBP + -0x8]
004c6b2d : POP ESI
004c6b2e : POP EBX
004c6b2f : POP EDI
004c6b30 : MOV ESP,EBP
004c6b32 : POP EBP
004c6b33 : RET

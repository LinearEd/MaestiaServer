PROGRAM  : Maestia.exe
FUNCTION : FUN_00405eb0
ENTRY    : 00405eb0
BODY     : [[00405eb0, 00405fba]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00405eb0(int param_1,uint param_2,uint param_3)

{
  rsize_t _MaxCount;
  void *_Dst;
  int in_ECX;
  uint uVar1;
  
  if (*(uint *)(param_1 + 0x14) < param_2) {
    FUN_00622f07();
  }
  uVar1 = *(int *)(param_1 + 0x14) - param_2;
  if (param_3 < uVar1) {
    uVar1 = param_3;
  }
  if (in_ECX == param_1) {
    FUN_00405e10(uVar1 + param_2,0xffffffff);
    FUN_00405e10(0,param_2);
    return;
  }
  if (0x7ffffffe < uVar1) {
    FUN_00622ecf();
  }
  if (*(uint *)(in_ECX + 0x18) < uVar1) {
    FUN_00406170(uVar1,*(undefined4 *)(in_ECX + 0x14));
  }
  else if (uVar1 == 0) {
    *(undefined4 *)(in_ECX + 0x14) = 0;
    if (7 < *(uint *)(in_ECX + 0x18)) {
      **(undefined2 **)(in_ECX + 4) = 0;
      return;
    }
    *(undefined2 *)(in_ECX + 4) = 0;
    return;
  }
  if (uVar1 != 0) {
    if (*(uint *)(param_1 + 0x18) < 8) {
      param_1 = param_1 + 4;
    }
    else {
      param_1 = *(int *)(param_1 + 4);
    }
    if (*(uint *)(in_ECX + 0x18) < 8) {
      _Dst = (void *)(in_ECX + 4);
    }
    else {
      _Dst = *(void **)(in_ECX + 4);
    }
    _MaxCount = uVar1 * 2;
    _memcpy_s(_Dst,*(int *)(in_ECX + 0x18) * 2,(void *)(param_1 + param_2 * 2),_MaxCount);
    *(uint *)(in_ECX + 0x14) = uVar1;
    if (7 < *(uint *)(in_ECX + 0x18)) {
      *(undefined2 *)(_MaxCount + *(int *)(in_ECX + 4)) = 0;
      return;
    }
    *(undefined2 *)(_MaxCount + in_ECX + 4) = 0;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00405eb0 : PUSH EBP
00405eb1 : MOV EBP,ESP
00405eb3 : PUSH EBX
00405eb4 : MOV EBX,dword ptr [EBP + 0xc]
00405eb7 : PUSH ESI
00405eb8 : PUSH EDI
00405eb9 : MOV EDI,dword ptr [EBP + 0x8]
00405ebc : MOV ESI,ECX
00405ebe : CMP dword ptr [EDI + 0x14],EBX
00405ec1 : JNC 0x00405ec8
00405ec3 : CALL 0x00622f07
00405ec8 : MOV EDI,dword ptr [EDI + 0x14]
00405ecb : MOV EAX,dword ptr [EBP + 0x10]
00405ece : MOV ECX,dword ptr [EBP + 0x8]
00405ed1 : SUB EDI,EBX
00405ed3 : CMP EAX,EDI
00405ed5 : CMOVC EDI,EAX
00405ed8 : CMP ESI,ECX
00405eda : JNZ 0x00405efb
00405edc : PUSH -0x1
00405ede : ADD EDI,EBX
00405ee0 : PUSH EDI
00405ee1 : MOV ECX,ESI
00405ee3 : CALL 0x00405e10
00405ee8 : PUSH EBX
00405ee9 : PUSH 0x0
00405eeb : MOV ECX,ESI
00405eed : CALL 0x00405e10
00405ef2 : POP EDI
00405ef3 : MOV EAX,ESI
00405ef5 : POP ESI
00405ef6 : POP EBX
00405ef7 : POP EBP
00405ef8 : RET 0xc
00405efb : CMP EDI,0x7ffffffe
00405f01 : JBE 0x00405f0b
00405f03 : CALL 0x00622ecf
00405f08 : MOV ECX,dword ptr [EBP + 0x8]
00405f0b : MOV EAX,dword ptr [ESI + 0x18]
00405f0e : CMP EAX,EDI
00405f10 : JNC 0x00405f34
00405f12 : MOV EAX,dword ptr [ESI + 0x14]
00405f15 : PUSH EAX
00405f16 : PUSH EDI
00405f17 : MOV ECX,ESI
00405f19 : CALL 0x00406170
00405f1e : MOV ECX,dword ptr [EBP + 0x8]
00405f21 : TEST EDI,EDI
00405f23 : JBE 0x00405fb2
00405f29 : CMP dword ptr [ECX + 0x18],0x8
00405f2d : JC 0x00405f62
00405f2f : MOV ECX,dword ptr [ECX + 0x4]
00405f32 : JMP 0x00405f65
00405f34 : TEST EDI,EDI
00405f36 : JNZ 0x00405f23
00405f38 : MOV dword ptr [ESI + 0x14],EDI
00405f3b : CMP EAX,0x8
00405f3e : JC 0x00405f51
00405f40 : MOV EAX,dword ptr [ESI + 0x4]
00405f43 : XOR ECX,ECX
00405f45 : POP EDI
00405f46 : MOV word ptr [EAX],CX
00405f49 : MOV EAX,ESI
00405f4b : POP ESI
00405f4c : POP EBX
00405f4d : POP EBP
00405f4e : RET 0xc
00405f51 : LEA EAX,[ESI + 0x4]
00405f54 : XOR ECX,ECX
00405f56 : POP EDI
00405f57 : MOV word ptr [EAX],CX
00405f5a : MOV EAX,ESI
00405f5c : POP ESI
00405f5d : POP EBX
00405f5e : POP EBP
00405f5f : RET 0xc
00405f62 : ADD ECX,0x4
00405f65 : CMP dword ptr [ESI + 0x18],0x8
00405f69 : JC 0x00405f70
00405f6b : MOV EAX,dword ptr [ESI + 0x4]
00405f6e : JMP 0x00405f73
00405f70 : LEA EAX,[ESI + 0x4]
00405f73 : MOV EDX,dword ptr [EBP + 0xc]
00405f76 : LEA ECX,[ECX + EDX*0x2]
00405f79 : LEA EBX,[EDI + EDI*0x1]
00405f7c : PUSH EBX
00405f7d : PUSH ECX
00405f7e : MOV ECX,dword ptr [ESI + 0x18]
00405f81 : LEA EDX,[ECX + ECX*0x1]
00405f84 : PUSH EDX
00405f85 : PUSH EAX
00405f86 : CALL 0x00633ea4
00405f8b : ADD ESP,0x10
00405f8e : CMP dword ptr [ESI + 0x18],0x8
00405f92 : MOV dword ptr [ESI + 0x14],EDI
00405f95 : JC 0x00405fa9
00405f97 : MOV EAX,dword ptr [ESI + 0x4]
00405f9a : XOR ECX,ECX
00405f9c : MOV word ptr [EBX + EAX*0x1],CX
00405fa0 : POP EDI
00405fa1 : MOV EAX,ESI
00405fa3 : POP ESI
00405fa4 : POP EBX
00405fa5 : POP EBP
00405fa6 : RET 0xc
00405fa9 : LEA EAX,[ESI + 0x4]
00405fac : XOR ECX,ECX
00405fae : MOV word ptr [EBX + EAX*0x1],CX
00405fb2 : POP EDI
00405fb3 : MOV EAX,ESI
00405fb5 : POP ESI
00405fb6 : POP EBX
00405fb7 : POP EBP
00405fb8 : RET 0xc

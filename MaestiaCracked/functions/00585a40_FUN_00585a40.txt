PROGRAM  : Maestia.exe
FUNCTION : FUN_00585a40
ENTRY    : 00585a40
BODY     : [[00585780, 0058580d] [00585a40, 00585ab9]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00585a40(int param_1)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  undefined1 *puVar4;
  char cVar5;
  uint uVar6;
  undefined4 unaff_ESI;
  int iVar7;
  
  cVar5 = FUN_00526030(7);
  if (cVar5 == '\0') {
    FUN_00526050("Array",0,0);
    return;
  }
  if (*(int *)(param_1 + 8) == 0) {
    iVar7 = 0;
  }
  else {
    iVar7 = *(int *)(param_1 + 8) + -0x10;
  }
  if (*(int *)(iVar7 + 0x38) == 0) {
    puVar4 = *(undefined1 **)(param_1 + 4);
    FUN_00526400();
    *puVar4 = 0;
    return;
  }
  if (**(int **)(iVar7 + 0x34) == 0) {
    puVar4 = *(undefined1 **)(param_1 + 4);
    FUN_00526400();
    *puVar4 = 0;
  }
  else {
    FUN_005268b0(**(int **)(iVar7 + 0x34));
  }
  if (*(int *)(iVar7 + 0x38) != 0) {
    iVar3 = **(int **)(iVar7 + 0x34);
    piVar1 = (int *)(iVar7 + 0x34);
    if (iVar3 != 0) {
      FUN_00526bc0(unaff_ESI);
      FUN_00515cf0(iVar3);
    }
    uVar6 = 1;
    if (1 < *(uint *)(iVar7 + 0x38)) {
      do {
        iVar3 = uVar6 * 4;
        iVar2 = uVar6 * 4;
        uVar6 = uVar6 + 1;
        *(undefined4 *)(*piVar1 + iVar2 + -4) = *(undefined4 *)(*piVar1 + iVar3);
      } while (uVar6 < *(uint *)(iVar7 + 0x38));
    }
    *(undefined4 *)(*piVar1 + -4 + *(int *)(iVar7 + 0x38) * 4) = 0;
    uVar6 = *(int *)(iVar7 + 0x38) - 1;
    if (uVar6 < *(uint *)(iVar7 + 0x38)) {
      if (uVar6 < *(uint *)(iVar7 + 0x3c) >> 1) {
        FUN_005b5ef0(piVar1,uVar6);
        *(uint *)(iVar7 + 0x38) = uVar6;
        return;
      }
    }
    else if (*(uint *)(iVar7 + 0x3c) <= uVar6) {
      FUN_005b5ef0(piVar1,(uVar6 >> 2) + uVar6);
    }
    *(uint *)(iVar7 + 0x38) = uVar6;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00585780 : PUSH EDI
00585781 : MOV EDI,ECX
00585783 : CMP dword ptr [EDI + 0x38],0x0
00585787 : JZ 0x0058580c
0058578d : MOV EAX,dword ptr [EDI + 0x34]
00585790 : PUSH EBX
00585791 : MOV EBX,dword ptr [EAX]
00585793 : PUSH ESI
00585794 : LEA ESI,[EDI + 0x34]
00585797 : TEST EBX,EBX
00585799 : JZ 0x005857a8
0058579b : MOV ECX,EBX
0058579d : CALL 0x00526bc0
005857a2 : PUSH EBX
005857a3 : CALL 0x00515cf0
005857a8 : MOV EAX,0x1
005857ad : CMP dword ptr [EDI + 0x38],EAX
005857b0 : JBE 0x005857c3
005857b2 : MOV ECX,dword ptr [ESI]
005857b4 : MOV EDX,dword ptr [ECX + EAX*0x4]
005857b7 : LEA ECX,[ECX + EAX*0x4]
005857ba : INC EAX
005857bb : MOV dword ptr [ECX + -0x4],EDX
005857be : CMP EAX,dword ptr [EDI + 0x38]
005857c1 : JC 0x005857b2
005857c3 : MOV EAX,dword ptr [EDI + 0x38]
005857c6 : MOV ECX,dword ptr [ESI]
005857c8 : MOV dword ptr [ECX + EAX*0x4 + -0x4],0x0
005857d0 : MOV EDI,dword ptr [EDI + 0x38]
005857d3 : DEC EDI
005857d4 : CMP EDI,dword ptr [ESI + 0x4]
005857d7 : JNC 0x005857f2
005857d9 : MOV EDX,dword ptr [ESI + 0x8]
005857dc : SHR EDX,0x1
005857de : CMP EDI,EDX
005857e0 : JNC 0x00585807
005857e2 : PUSH EDI
005857e3 : PUSH ESI
005857e4 : MOV ECX,ESI
005857e6 : CALL 0x005b5ef0
005857eb : MOV dword ptr [ESI + 0x4],EDI
005857ee : POP ESI
005857ef : POP EBX
005857f0 : POP EDI
005857f1 : RET
005857f2 : CMP EDI,dword ptr [ESI + 0x8]
005857f5 : JC 0x00585807
005857f7 : MOV EAX,EDI
005857f9 : SHR EAX,0x2
005857fc : ADD EAX,EDI
005857fe : PUSH EAX
005857ff : PUSH ESI
00585800 : MOV ECX,ESI
00585802 : CALL 0x005b5ef0
00585807 : MOV dword ptr [ESI + 0x4],EDI
0058580a : POP ESI
0058580b : POP EBX
0058580c : POP EDI
0058580d : RET
00585a40 : PUSH ESI
00585a41 : MOV ESI,dword ptr [ESP + 0x8]
00585a45 : PUSH 0x7
00585a47 : MOV ECX,ESI
00585a49 : CALL 0x00526030
00585a4e : TEST AL,AL
00585a50 : JNZ 0x00585a64
00585a52 : PUSH 0x0
00585a54 : PUSH 0x0
00585a56 : PUSH 0xb8df10
00585a5b : MOV ECX,ESI
00585a5d : CALL 0x00526050
00585a62 : POP ESI
00585a63 : RET
00585a64 : MOV EAX,dword ptr [ESI + 0x8]
00585a67 : PUSH EDI
00585a68 : TEST EAX,EAX
00585a6a : JZ 0x00585a71
00585a6c : LEA EDI,[EAX + -0x10]
00585a6f : JMP 0x00585a73
00585a71 : XOR EDI,EDI
00585a73 : CMP dword ptr [EDI + 0x38],0x0
00585a77 : JNZ 0x00585a89
00585a79 : MOV ESI,dword ptr [ESI + 0x4]
00585a7c : MOV ECX,ESI
00585a7e : CALL 0x00526400
00585a83 : POP EDI
00585a84 : MOV byte ptr [ESI],0x0
00585a87 : POP ESI
00585a88 : RET
00585a89 : MOV EAX,dword ptr [EDI + 0x34]
00585a8c : MOV EAX,dword ptr [EAX]
00585a8e : TEST EAX,EAX
00585a90 : JZ 0x00585aa4
00585a92 : MOV ECX,dword ptr [ESI + 0x4]
00585a95 : PUSH EAX
00585a96 : CALL 0x005268b0
00585a9b : MOV ECX,EDI
00585a9d : POP EDI
00585a9e : POP ESI
00585a9f : JMP 0x00585780
00585aa4 : MOV ESI,dword ptr [ESI + 0x4]
00585aa7 : MOV ECX,ESI
00585aa9 : CALL 0x00526400
00585aae : MOV ECX,EDI
00585ab0 : POP EDI
00585ab1 : MOV byte ptr [ESI],0x0
00585ab4 : POP ESI
00585ab5 : JMP 0x00585780

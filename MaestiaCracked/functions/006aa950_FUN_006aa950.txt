PROGRAM  : Maestia.exe
FUNCTION : FUN_006aa950
ENTRY    : 006aa950
BODY     : [[006aa950, 006aacdc]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006aa950(int param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  uint uVar6;
  int *unaff_EBX;
  undefined1 local_20 [8];
  uint local_18;
  
  iVar1 = param_1;
  iVar5 = *(int *)(param_1 + 0x1c);
  _memset(unaff_EBX,0,0x834);
  *unaff_EBX = iVar1;
  unaff_EBX[1] = iVar5;
  iVar2 = FUN_00687830(iVar1);
  param_1 = FUN_006889e0(iVar1,&DAT_00beb028);
  if (param_1 != 0) {
    return param_1;
  }
  if ((((char)unaff_EBX[4] == '\x01') && (3 < *(byte *)((int)unaff_EBX + 0x12))) &&
     (*(byte *)((int)unaff_EBX + 0x13) < 5)) {
    param_1 = FUN_00687800(iVar1,*(byte *)((int)unaff_EBX + 0x12) - 4);
    if (param_1 != 0) {
      return param_1;
    }
    param_1 = FUN_006a98c0(0);
    if (param_1 != 0) {
      return param_1;
    }
    param_1 = FUN_006a98c0(0);
    if (param_1 != 0) {
      return param_1;
    }
    param_1 = FUN_006a98c0(0);
    if (param_1 != 0) {
      return param_1;
    }
    iVar3 = FUN_006a98c0(1);
    if (iVar3 != 0) {
      return iVar3;
    }
    unaff_EBX[2] = unaff_EBX[7];
    param_1 = 0;
    if (unaff_EBX[7] <= param_2) {
      param_1 = 6;
    }
    if (param_2 < 0) {
      return param_1;
    }
    param_1 = FUN_006aa6f0(unaff_EBX + 0x136,param_2,iVar1,iVar2);
    if (param_1 != 0) {
      return param_1;
    }
    param_1 = FUN_006877c0(iVar1,unaff_EBX[0x16c] + iVar2);
    if (param_1 != 0) {
      return param_1;
    }
    param_1 = FUN_006a98c0(0);
    if (param_1 != 0) {
      return param_1;
    }
    if (unaff_EBX[0x171] == 0xffff) {
      unaff_EBX[0x1e0] = 0;
      param_1 = 0;
    }
    else {
      param_1 = FUN_006877c0(iVar1,unaff_EBX[0x179] + iVar2);
      if (param_1 != 0) {
        return param_1;
      }
      param_1 = FUN_006a98c0(0);
      if (param_1 != 0) {
        return param_1;
      }
      if (local_18 < 0x21) {
        unaff_EBX[0x1e0] = local_18;
        iVar3 = FUN_0068a220(iVar5,0x23c,0,local_18,0,&param_1);
        if (param_1 == 0) {
          if (local_18 != 0) {
            piVar4 = unaff_EBX + 0x1e1;
            uVar6 = local_18;
            do {
              *piVar4 = iVar3;
              piVar4 = piVar4 + 1;
              iVar3 = iVar3 + 0x23c;
              uVar6 = uVar6 - 1;
            } while (uVar6 != 0);
          }
          uVar6 = 0;
          iVar3 = param_1;
          if (local_18 != 0) {
            do {
              param_1 = iVar3;
              param_1 = FUN_006aa6f0(local_20,uVar6,iVar1,iVar2);
              if (param_1 != 0) goto LAB_006aabbd;
              uVar6 = uVar6 + 1;
              param_1 = 0;
              iVar3 = 0;
            } while (uVar6 < local_18);
          }
          param_1 = FUN_006a9ec0(unaff_EBX[0x130]);
        }
      }
LAB_006aabbd:
      FUN_006a99e0();
      if (param_1 != 0) {
        return param_1;
      }
    }
    if (unaff_EBX[0x16c] != 0) {
      unaff_EBX[3] = unaff_EBX[0x130];
      unaff_EBX[0x14f] = unaff_EBX[0x1f];
      param_1 = FUN_006a9bb0(unaff_EBX + 0x150);
      if (param_1 != 0) {
        return param_1;
      }
      iVar3 = 0;
      if (unaff_EBX[3] != 0) {
        param_1 = FUN_006aa0b0(unaff_EBX + 0x128,iVar1,unaff_EBX[0x171] != 0xffff);
        if (param_1 != 0) {
          return param_1;
        }
        if (unaff_EBX[0x171] == 0xffff) {
          iVar5 = FUN_006aa390(unaff_EBX + 0x25,unaff_EBX + 0x128,unaff_EBX[3],iVar1,iVar2);
          if (iVar5 != 0) {
            return iVar5;
          }
          iVar3 = 0;
        }
        else {
          FUN_00687f30(iVar5,unaff_EBX[0x12a]);
          unaff_EBX[0x12a] = 0;
          iVar3 = param_1;
        }
      }
      param_1 = iVar3;
      iVar5 = FUN_006a9db0(param_2);
      unaff_EBX[0x14e] = iVar5;
      return param_1;
    }
  }
  return 2;
}



============================================================
DISASSEMBLY
============================================================
006aa950 : SUB ESP,0x2c
006aa953 : PUSH EBP
006aa954 : MOV EBP,dword ptr [ESP + 0x34]
006aa958 : PUSH ESI
006aa959 : MOV ESI,dword ptr [EBP + 0x1c]
006aa95c : PUSH EDI
006aa95d : PUSH 0x834
006aa962 : PUSH 0x0
006aa964 : PUSH EBX
006aa965 : MOV dword ptr [ESP + 0x1c],ESI
006aa969 : CALL 0x0063b700
006aa96e : PUSH EBP
006aa96f : MOV dword ptr [EBX],EBP
006aa971 : MOV dword ptr [EBX + 0x4],ESI
006aa974 : CALL 0x00687830
006aa979 : PUSH EBX
006aa97a : PUSH 0xbeb028
006aa97f : PUSH EBP
006aa980 : MOV dword ptr [ESP + 0x28],EAX
006aa984 : CALL 0x006889e0
006aa989 : ADD ESP,0x1c
006aa98c : MOV dword ptr [ESP + 0x3c],EAX
006aa990 : TEST EAX,EAX
006aa992 : JNZ 0x006aacd6
006aa998 : CMP byte ptr [EBX + 0x10],0x1
006aa99c : JNZ 0x006aacd1
006aa9a2 : MOV AL,byte ptr [EBX + 0x12]
006aa9a5 : CMP AL,0x4
006aa9a7 : JC 0x006aacd1
006aa9ad : CMP byte ptr [EBX + 0x13],0x4
006aa9b1 : JA 0x006aacd1
006aa9b7 : MOVZX EAX,AL
006aa9ba : SUB EAX,0x4
006aa9bd : PUSH EAX
006aa9be : PUSH EBP
006aa9bf : CALL 0x00687800
006aa9c4 : ADD ESP,0x8
006aa9c7 : MOV dword ptr [ESP + 0x3c],EAX
006aa9cb : TEST EAX,EAX
006aa9cd : JNZ 0x006aacd6
006aa9d3 : LEA ESI,[EBX + 0x14]
006aa9d6 : PUSH EAX
006aa9d7 : MOV EDI,EBP
006aa9d9 : CALL 0x006a98c0
006aa9de : ADD ESP,0x4
006aa9e1 : MOV dword ptr [ESP + 0x3c],EAX
006aa9e5 : TEST EAX,EAX
006aa9e7 : JNZ 0x006aacd6
006aa9ed : LEA ESI,[EBX + 0x4d8]
006aa9f3 : PUSH EAX
006aa9f4 : CALL 0x006a98c0
006aa9f9 : ADD ESP,0x4
006aa9fc : MOV dword ptr [ESP + 0x3c],EAX
006aaa00 : TEST EAX,EAX
006aaa02 : JNZ 0x006aacd6
006aaa08 : PUSH EAX
006aaa09 : LEA ESI,[EBX + 0x54]
006aaa0c : CALL 0x006a98c0
006aaa11 : ADD ESP,0x4
006aaa14 : MOV dword ptr [ESP + 0x3c],EAX
006aaa18 : TEST EAX,EAX
006aaa1a : JNZ 0x006aacd6
006aaa20 : LEA ESI,[EBX + 0x74]
006aaa23 : PUSH 0x1
006aaa25 : CALL 0x006a98c0
006aaa2a : ADD ESP,0x4
006aaa2d : MOV dword ptr [ESP + 0x3c],EAX
006aaa31 : TEST EAX,EAX
006aaa33 : JNZ 0x006aacd6
006aaa39 : MOV EDX,dword ptr [EBX + 0x1c]
006aaa3c : MOV ECX,dword ptr [ESP + 0x40]
006aaa40 : CMP ECX,EDX
006aaa42 : MOV dword ptr [EBX + 0x8],EDX
006aaa45 : JL 0x006aaa50
006aaa47 : MOV EAX,0x6
006aaa4c : MOV dword ptr [ESP + 0x3c],EAX
006aaa50 : TEST ECX,ECX
006aaa52 : JL 0x006aacd6
006aaa58 : MOV EDI,dword ptr [ESP + 0xc]
006aaa5c : PUSH EDI
006aaa5d : PUSH EBP
006aaa5e : PUSH ECX
006aaa5f : LEA EAX,[EBX + 0x4d8]
006aaa65 : PUSH EAX
006aaa66 : LEA ESI,[EBX + 0x544]
006aaa6c : MOV EAX,ESI
006aaa6e : CALL 0x006aa6f0
006aaa73 : ADD ESP,0x10
006aaa76 : MOV dword ptr [ESP + 0x3c],EAX
006aaa7a : TEST EAX,EAX
006aaa7c : JNZ 0x006aacd6
006aaa82 : MOV ECX,dword ptr [ESI + 0x6c]
006aaa85 : ADD ECX,EDI
006aaa87 : PUSH ECX
006aaa88 : PUSH EBP
006aaa89 : CALL 0x006877c0
006aaa8e : ADD ESP,0x8
006aaa91 : MOV dword ptr [ESP + 0x3c],EAX
006aaa95 : TEST EAX,EAX
006aaa97 : JNZ 0x006aacd6
006aaa9d : PUSH EAX
006aaa9e : LEA ESI,[EBX + 0x4b8]
006aaaa4 : MOV EDI,EBP
006aaaa6 : CALL 0x006a98c0
006aaaab : ADD ESP,0x4
006aaaae : MOV dword ptr [ESP + 0x3c],EAX
006aaab2 : TEST EAX,EAX
006aaab4 : JNZ 0x006aacd6
006aaaba : CMP dword ptr [EBX + 0x5c4],0xffff
006aaac4 : JZ 0x006aabd4
006aaaca : MOV EDX,dword ptr [EBX + 0x5e4]
006aaad0 : ADD EDX,dword ptr [ESP + 0xc]
006aaad4 : PUSH EDX
006aaad5 : PUSH EBP
006aaad6 : CALL 0x006877c0
006aaadb : ADD ESP,0x8
006aaade : MOV dword ptr [ESP + 0x3c],EAX
006aaae2 : TEST EAX,EAX
006aaae4 : JNZ 0x006aacd6
006aaaea : PUSH EAX
006aaaeb : LEA ESI,[ESP + 0x1c]
006aaaef : CALL 0x006a98c0
006aaaf4 : ADD ESP,0x4
006aaaf7 : MOV dword ptr [ESP + 0x3c],EAX
006aaafb : TEST EAX,EAX
006aaafd : JNZ 0x006aacd6
006aab03 : MOV EAX,dword ptr [ESP + 0x20]
006aab07 : CMP EAX,0x20
006aab0a : JA 0x006aabbd
006aab10 : MOV EDX,dword ptr [ESP + 0x10]
006aab14 : LEA ECX,[ESP + 0x3c]
006aab18 : PUSH ECX
006aab19 : PUSH 0x0
006aab1b : PUSH EAX
006aab1c : PUSH 0x0
006aab1e : PUSH 0x23c
006aab23 : PUSH EDX
006aab24 : MOV dword ptr [EBX + 0x780],EAX
006aab2a : CALL 0x0068a220
006aab2f : ADD ESP,0x18
006aab32 : CMP dword ptr [ESP + 0x3c],0x0
006aab37 : JNZ 0x006aabbd
006aab3d : MOV EDI,dword ptr [ESP + 0x20]
006aab41 : TEST EDI,EDI
006aab43 : JBE 0x006aab60
006aab45 : MOV ECX,EAX
006aab47 : LEA EAX,[EBX + 0x784]
006aab4d : MOV EDX,EDI
006aab4f : NOP
006aab50 : MOV dword ptr [EAX],ECX
006aab52 : ADD EAX,0x4
006aab55 : ADD ECX,0x23c
006aab5b : SUB EDX,0x1
006aab5e : JNZ 0x006aab50
006aab60 : XOR ESI,ESI
006aab62 : TEST EDI,EDI
006aab64 : JBE 0x006aab98
006aab66 : LEA EDI,[EBX + 0x784]
006aab6c : LEA ESP,[ESP]
006aab70 : MOV ECX,dword ptr [ESP + 0xc]
006aab74 : MOV EAX,dword ptr [EDI]
006aab76 : PUSH ECX
006aab77 : PUSH EBP
006aab78 : LEA EDX,[ESP + 0x20]
006aab7c : PUSH ESI
006aab7d : PUSH EDX
006aab7e : CALL 0x006aa6f0
006aab83 : ADD ESP,0x10
006aab86 : MOV dword ptr [ESP + 0x3c],EAX
006aab8a : TEST EAX,EAX
006aab8c : JNZ 0x006aabbd
006aab8e : INC ESI
006aab8f : ADD EDI,0x4
006aab92 : CMP ESI,dword ptr [ESP + 0x20]
006aab96 : JC 0x006aab70
006aab98 : MOV EAX,dword ptr [EBX + 0x5e8]
006aab9e : MOV ECX,dword ptr [EBX + 0x4c0]
006aaba4 : ADD EAX,dword ptr [ESP + 0xc]
006aaba8 : PUSH ECX
006aaba9 : LEA EDI,[EBX + 0x804]
006aabaf : MOV ESI,EBP
006aabb1 : CALL 0x006a9ec0
006aabb6 : ADD ESP,0x4
006aabb9 : MOV dword ptr [ESP + 0x3c],EAX
006aabbd : LEA ESI,[ESP + 0x18]
006aabc1 : CALL 0x006a99e0
006aabc6 : MOV EAX,dword ptr [ESP + 0x3c]
006aabca : TEST EAX,EAX
006aabcc : JNZ 0x006aacd6
006aabd2 : JMP 0x006aabde
006aabd4 : MOV dword ptr [EBX + 0x780],0x0
006aabde : CMP dword ptr [EBX + 0x5b0],0x0
006aabe5 : JZ 0x006aacd1
006aabeb : MOV EAX,dword ptr [EBX + 0x4c0]
006aabf1 : MOV EDX,dword ptr [EBX + 0x7c]
006aabf4 : LEA ECX,[EBX + 0x540]
006aabfa : MOV dword ptr [EBX + 0xc],EAX
006aabfd : PUSH ECX
006aabfe : LEA EAX,[EBX + 0x74]
006aac01 : MOV dword ptr [EBX + 0x53c],EDX
006aac07 : CALL 0x006a9bb0
006aac0c : ADD ESP,0x4
006aac0f : MOV dword ptr [ESP + 0x3c],EAX
006aac13 : TEST EAX,EAX
006aac15 : JNZ 0x006aacd6
006aac1b : MOV EDX,dword ptr [EBX + 0xc]
006aac1e : TEST EDX,EDX
006aac20 : JBE 0x006aacb0
006aac26 : CMP dword ptr [EBX + 0x5c4],0xffff
006aac30 : MOV EDI,dword ptr [ESP + 0xc]
006aac34 : SETNZ AL
006aac37 : MOV byte ptr [ESP + 0x14],AL
006aac3b : MOV ECX,dword ptr [ESP + 0x14]
006aac3f : MOV EAX,dword ptr [EBX + 0x5a8]
006aac45 : PUSH ECX
006aac46 : LEA ESI,[EBX + 0x4a0]
006aac4c : PUSH EBP
006aac4d : PUSH ESI
006aac4e : MOV ECX,EDI
006aac50 : CALL 0x006aa0b0
006aac55 : ADD ESP,0xc
006aac58 : MOV dword ptr [ESP + 0x3c],EAX
006aac5c : TEST EAX,EAX
006aac5e : JNZ 0x006aacd6
006aac60 : CMP dword ptr [EBX + 0x5c4],0xffff
006aac6a : JNZ 0x006aac92
006aac6c : MOV EDX,dword ptr [EBX + 0xc]
006aac6f : PUSH EDI
006aac70 : PUSH EBP
006aac71 : PUSH EDX
006aac72 : MOV EDX,dword ptr [EBX + 0x5ac]
006aac78 : LEA EAX,[EBX + 0x94]
006aac7e : PUSH ESI
006aac7f : PUSH EAX
006aac80 : CALL 0x006aa390
006aac85 : ADD ESP,0x14
006aac88 : MOV dword ptr [ESP + 0x3c],EAX
006aac8c : TEST EAX,EAX
006aac8e : JNZ 0x006aacd6
006aac90 : JMP 0x006aacb0
006aac92 : MOV ECX,dword ptr [EBX + 0x4a8]
006aac98 : MOV EDX,dword ptr [ESP + 0x10]
006aac9c : PUSH ECX
006aac9d : PUSH EDX
006aac9e : CALL 0x00687f30
006aaca3 : ADD ESP,0x8
006aaca6 : MOV dword ptr [EBX + 0x4a8],0x0
006aacb0 : MOV EAX,dword ptr [ESP + 0x40]
006aacb4 : PUSH EAX
006aacb5 : LEA EAX,[EBX + 0x14]
006aacb8 : CALL 0x006a9db0
006aacbd : ADD ESP,0x4
006aacc0 : POP EDI
006aacc1 : POP ESI
006aacc2 : MOV dword ptr [EBX + 0x538],EAX
006aacc8 : MOV EAX,dword ptr [ESP + 0x34]
006aaccc : POP EBP
006aaccd : ADD ESP,0x2c
006aacd0 : RET
006aacd1 : MOV EAX,0x2
006aacd6 : POP EDI
006aacd7 : POP ESI
006aacd8 : POP EBP
006aacd9 : ADD ESP,0x2c
006aacdc : RET

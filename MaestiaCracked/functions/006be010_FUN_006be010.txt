PROGRAM  : Maestia.exe
FUNCTION : FUN_006be010
ENTRY    : 006be010
BODY     : [[006be010, 006be1a0]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006be010(int param_1,int param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  int in_ECX;
  uint uVar5;
  int in_EDX;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  
  uVar1 = *(uint *)(in_EDX + 0x6c) & 4;
  iVar7 = 0x40;
  if (uVar1 == 0) {
    if (((*(byte *)(param_1 + 0xc) & 1) == 0) || ((*(byte *)(param_2 + 0xc) & 1) == 0)) {
      iVar7 = (uint)(in_ECX == 1) * 2 + 0x3b;
    }
    else {
      iVar7 = (-(uint)(in_ECX != 1) & 0xfffffffa) + 0x37;
    }
  }
  iVar8 = *(int *)(param_2 + 4);
  iVar3 = *(int *)(param_1 + 4);
  uVar2 = FUN_006bdec0();
  uVar5 = ((iVar8 + iVar3) / 2 - (int)uVar2 / 2) + param_3;
  iVar6 = uVar5 - (uVar5 & 0xffffffc0);
  iVar3 = (uVar5 + uVar2) - (uVar5 + uVar2 & 0xffffffc0);
  iVar9 = 0x40 - iVar6;
  iVar8 = 0;
  if ((iVar6 == 0) || (iVar3 == 0)) goto LAB_006be109;
  if (iVar7 < (int)uVar2) {
    if ((0x3f < iVar7) ||
       ((((iVar6 < iVar7 && (iVar9 < iVar7)) && (iVar3 < iVar7)) && (0x40 - iVar3 < iVar7)))) {
      uVar4 = uVar2 & 0x8000003f;
      if ((int)uVar4 < 0) {
        uVar4 = (uVar4 - 1 | 0xffffffc0) + 1;
      }
      if ((int)uVar4 < 0x20) {
        if ((iVar9 <= (int)uVar4) || (iVar3 <= (int)uVar4)) goto LAB_006be105;
      }
      else {
        uVar4 = 0x40 - iVar7;
      }
      iVar8 = iVar7 - iVar3;
      iVar6 = iVar9 - uVar4;
      if (iVar7 - iVar9 <= iVar6) {
        iVar6 = -(iVar7 - iVar9);
      }
      if ((int)(iVar3 - uVar4) <= iVar8) {
        iVar8 = -(iVar3 - uVar4);
      }
      iVar7 = iVar6;
      if (iVar6 < 0) {
        iVar7 = -iVar6;
      }
      iVar3 = iVar8;
      if (iVar8 < 0) {
        iVar3 = -iVar8;
      }
      if (iVar7 <= iVar3) {
        iVar8 = iVar6;
      }
      goto LAB_006be109;
    }
  }
  else if (iVar3 < (int)uVar2) {
    iVar8 = iVar9;
    if (iVar3 < iVar9) {
      iVar8 = -iVar3;
    }
    goto LAB_006be109;
  }
LAB_006be105:
  iVar8 = 0;
LAB_006be109:
  if (uVar1 == 0) {
    if (iVar8 < 0xf) {
      if (iVar8 < -0xe) {
        iVar8 = -0xe;
      }
    }
    else {
      iVar8 = 0xe;
    }
  }
  iVar7 = uVar5 + iVar8;
  if (*(int *)(param_2 + 4) <= *(int *)(param_1 + 4)) {
    *(uint *)(param_1 + 8) = uVar2 + iVar7;
    *(int *)(param_2 + 8) = iVar7;
    return iVar8;
  }
  *(int *)(param_1 + 8) = iVar7;
  *(uint *)(param_2 + 8) = iVar7 + uVar2;
  return iVar8;
}



============================================================
DISASSEMBLY
============================================================
006be010 : SUB ESP,0x8
006be013 : MOV EAX,dword ptr [EDX + 0x6c]
006be016 : PUSH EBX
006be017 : PUSH EBP
006be018 : PUSH ESI
006be019 : MOV ESI,dword ptr [ESP + 0x18]
006be01d : AND EAX,0x4
006be020 : PUSH EDI
006be021 : MOV EDI,dword ptr [ESP + 0x20]
006be025 : MOV EBX,0x40
006be02a : MOV dword ptr [ESP + 0x14],EAX
006be02e : JNZ 0x006be05a
006be030 : MOV EAX,0x1
006be035 : TEST byte ptr [ESI + 0xc],AL
006be038 : JZ 0x006be04f
006be03a : TEST byte ptr [EDI + 0xc],AL
006be03d : JZ 0x006be04f
006be03f : MOV EBX,ECX
006be041 : SUB EBX,EAX
006be043 : NEG EBX
006be045 : SBB EBX,EBX
006be047 : AND EBX,0xfffffffa
006be04a : ADD EBX,0x37
006be04d : JMP 0x006be05a
006be04f : XOR EBX,EBX
006be051 : CMP ECX,EAX
006be053 : SETZ BL
006be056 : LEA EBX,[EBX + EBX*0x1 + 0x3b]
006be05a : MOV EDI,dword ptr [EDI + 0x4]
006be05d : MOV ESI,dword ptr [ESI + 0x4]
006be060 : MOV EAX,EDI
006be062 : SUB EAX,ESI
006be064 : PUSH EDX
006be065 : CALL 0x006bdec0
006be06a : MOV EBP,EAX
006be06c : LEA EAX,[EDI + ESI*0x1]
006be06f : CDQ
006be070 : SUB EAX,EDX
006be072 : MOV ECX,EAX
006be074 : MOV EAX,EBP
006be076 : CDQ
006be077 : SUB EAX,EDX
006be079 : SAR EAX,0x1
006be07b : SAR ECX,0x1
006be07d : SUB ECX,EAX
006be07f : ADD ECX,dword ptr [ESP + 0x28]
006be083 : MOV dword ptr [ESP + 0x14],EBP
006be087 : MOV ESI,ECX
006be089 : AND ESI,0xffffffc0
006be08c : LEA EAX,[ECX + EBP*0x1]
006be08f : MOV EDX,ECX
006be091 : SUB EDX,ESI
006be093 : MOV ESI,EAX
006be095 : AND ESI,0xffffffc0
006be098 : SUB EAX,ESI
006be09a : MOV EDI,EAX
006be09c : MOV ESI,0x40
006be0a1 : MOV EAX,0x40
006be0a6 : XOR EBP,EBP
006be0a8 : ADD ESP,0x4
006be0ab : SUB ESI,EDX
006be0ad : SUB EAX,EDI
006be0af : MOV dword ptr [ESP + 0x24],EBP
006be0b3 : TEST EDX,EDX
006be0b5 : JZ 0x006be109
006be0b7 : TEST EDI,EDI
006be0b9 : JZ 0x006be109
006be0bb : MOV EBP,dword ptr [ESP + 0x10]
006be0bf : CMP EBP,EBX
006be0c1 : JG 0x006be0d5
006be0c3 : CMP EDI,EBP
006be0c5 : JGE 0x006be105
006be0c7 : CMP ESI,EDI
006be0c9 : JG 0x006be0cf
006be0cb : MOV EBP,ESI
006be0cd : JMP 0x006be109
006be0cf : NEG EDI
006be0d1 : MOV EBP,EDI
006be0d3 : JMP 0x006be109
006be0d5 : CMP EBX,0x40
006be0d8 : JGE 0x006be0ea
006be0da : CMP EDX,EBX
006be0dc : JGE 0x006be105
006be0de : CMP ESI,EBX
006be0e0 : JGE 0x006be105
006be0e2 : CMP EDI,EBX
006be0e4 : JGE 0x006be105
006be0e6 : CMP EAX,EBX
006be0e8 : JGE 0x006be105
006be0ea : MOV EAX,EBP
006be0ec : AND EAX,0x8000003f
006be0f1 : JNS 0x006be0f8
006be0f3 : DEC EAX
006be0f4 : OR EAX,0xffffffc0
006be0f7 : INC EAX
006be0f8 : CMP EAX,0x20
006be0fb : JGE 0x006be11c
006be0fd : CMP ESI,EAX
006be0ff : JLE 0x006be105
006be101 : CMP EDI,EAX
006be103 : JG 0x006be123
006be105 : MOV EBP,dword ptr [ESP + 0x24]
006be109 : CMP dword ptr [ESP + 0x14],0x0
006be10e : JNZ 0x006be163
006be110 : CMP EBP,0xe
006be113 : JLE 0x006be159
006be115 : MOV EBP,0xe
006be11a : JMP 0x006be163
006be11c : MOV EAX,0x40
006be121 : SUB EAX,EBX
006be123 : MOV EDX,EBX
006be125 : SUB EDX,ESI
006be127 : SUB EBX,EDI
006be129 : SUB ESI,EAX
006be12b : SUB EDI,EAX
006be12d : CMP EDX,ESI
006be12f : JG 0x006be135
006be131 : NEG EDX
006be133 : MOV ESI,EDX
006be135 : CMP EDI,EBX
006be137 : JG 0x006be13d
006be139 : NEG EDI
006be13b : MOV EBX,EDI
006be13d : MOV EDX,ESI
006be13f : TEST ESI,ESI
006be141 : JGE 0x006be145
006be143 : NEG EDX
006be145 : MOV EAX,EBX
006be147 : TEST EBX,EBX
006be149 : JGE 0x006be14d
006be14b : NEG EAX
006be14d : CMP EDX,EAX
006be14f : JG 0x006be155
006be151 : MOV EBP,ESI
006be153 : JMP 0x006be109
006be155 : MOV EBP,EBX
006be157 : JMP 0x006be109
006be159 : CMP EBP,-0xe
006be15c : JGE 0x006be163
006be15e : MOV EBP,0xfffffff2
006be163 : MOV EDX,dword ptr [ESP + 0x1c]
006be167 : MOV ESI,dword ptr [EDX + 0x4]
006be16a : MOV EAX,dword ptr [ESP + 0x20]
006be16e : ADD ECX,EBP
006be170 : CMP ESI,dword ptr [EAX + 0x4]
006be173 : JGE 0x006be18b
006be175 : MOV dword ptr [EDX + 0x8],ECX
006be178 : MOV EDX,dword ptr [ESP + 0x10]
006be17c : POP EDI
006be17d : ADD ECX,EDX
006be17f : POP ESI
006be180 : MOV dword ptr [EAX + 0x8],ECX
006be183 : MOV EAX,EBP
006be185 : POP EBP
006be186 : POP EBX
006be187 : ADD ESP,0x8
006be18a : RET
006be18b : MOV ESI,dword ptr [ESP + 0x10]
006be18f : ADD ESI,ECX
006be191 : POP EDI
006be192 : MOV dword ptr [EDX + 0x8],ESI
006be195 : POP ESI
006be196 : MOV dword ptr [EAX + 0x8],ECX
006be199 : MOV EAX,EBP
006be19b : POP EBP
006be19c : POP EBX
006be19d : ADD ESP,0x8
006be1a0 : RET

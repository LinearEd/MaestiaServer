PROGRAM  : Maestia.exe
FUNCTION : FUN_0058ef60
ENTRY    : 0058ef60
BODY     : [[0058ef60, 0058f26a]]

============================================================
DECOMPILED C CODE
============================================================

float * FUN_0058ef60(float *param_1,GMatrix2D *param_2)

{
  float fVar1;
  int *piVar2;
  float *pfVar3;
  int in_ECX;
  float fVar4;
  float local_4c;
  float local_48;
  float local_44;
  float local_40;
  float local_3c;
  float fStack_38;
  float fStack_34;
  float fStack_30;
  float fStack_2c;
  undefined1 local_28 [16];
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  undefined4 local_4;
  
  *param_1 = 0.0;
  param_1[1] = 0.0;
  fVar1 = *(float *)(in_ECX + 0xac);
  param_1[2] = 0.0;
  param_1[3] = 0.0;
  local_48 = 0.0;
  local_44 = 0.0;
  local_40 = 0.0;
  local_3c = 0.0;
  local_4c = fVar1;
  GMatrix2D::SetIdentity((GMatrix2D *)&local_18);
  fVar4 = 0.0;
  if (fVar1 != 0.0) {
    do {
      piVar2 = *(int **)(*(int *)(in_ECX + 0xa8) + (int)fVar4 * 4);
      if (piVar2 != (int *)0x0) {
        local_18 = *(undefined4 *)param_2;
        local_14 = *(undefined4 *)(param_2 + 4);
        local_10 = *(undefined4 *)(param_2 + 8);
        local_c = *(undefined4 *)(param_2 + 0xc);
        local_8 = *(undefined4 *)(param_2 + 0x10);
        local_4 = *(undefined4 *)(param_2 + 0x14);
        GMatrix2D::Prepend((GMatrix2D *)&local_18,(GMatrix2D *)(piVar2 + 0x11));
        pfVar3 = (float *)(**(code **)(*piVar2 + 0x28))(local_28,&local_18);
        local_44 = pfVar3[1];
        local_40 = pfVar3[2];
        local_3c = pfVar3[3];
        local_48 = *pfVar3;
        if ((local_48 < local_40) && (local_44 < local_3c)) {
          if ((param_1[2] < *param_1 == (param_1[2] == *param_1)) &&
             (param_1[3] < param_1[1] == (param_1[3] == param_1[1]))) {
            fStack_38 = local_48;
            if (*param_1 <= local_48) {
              fStack_38 = *param_1;
            }
            fStack_30 = local_40;
            if (local_40 < param_1[2]) {
              fStack_30 = param_1[2];
            }
            fStack_34 = local_44;
            if (param_1[1] <= local_44) {
              fStack_34 = param_1[1];
            }
            fStack_2c = local_3c;
            if (local_3c < param_1[3]) {
              fStack_2c = param_1[3];
            }
            *param_1 = fStack_38;
            param_1[1] = fStack_34;
            param_1[2] = fStack_30;
            param_1[3] = fStack_2c;
          }
          else {
            *param_1 = local_48;
            param_1[1] = local_44;
            param_1[2] = local_40;
            param_1[3] = local_3c;
          }
        }
      }
      fVar4 = (float)((int)fVar4 + 1);
    } while ((uint)fVar4 < (uint)local_4c);
  }
  if (((*(int *)(in_ECX + 0x1b0) != 0) &&
      (FUN_005d7750(&local_48), local_44 < local_4c == (local_44 == local_4c))) &&
     (local_40 < local_48 == (local_40 == local_48))) {
    local_3c = 0.0;
    fStack_38 = 0.0;
    fStack_34 = 0.0;
    fStack_30 = 0.0;
    GMatrix2D::EncloseTransform(param_2,(GRect<float> *)&local_3c,(GRect<float> *)&local_4c);
    if ((param_1[2] < *param_1 == (param_1[2] == *param_1)) &&
       (param_1[3] < param_1[1] == (param_1[3] == param_1[1]))) {
      if (*param_1 <= local_3c) {
        local_3c = *param_1;
      }
      if (fStack_34 < param_1[2]) {
        fStack_34 = param_1[2];
      }
      if (param_1[1] <= fStack_38) {
        fStack_38 = param_1[1];
      }
      if (fStack_30 < param_1[3]) {
        fStack_30 = param_1[3];
      }
      *param_1 = local_3c;
      param_1[1] = fStack_38;
      param_1[2] = fStack_34;
      param_1[3] = fStack_30;
      return param_1;
    }
    *param_1 = local_3c;
    param_1[1] = fStack_38;
    param_1[2] = fStack_34;
    param_1[3] = fStack_30;
  }
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
0058ef60 : SUB ESP,0x54
0058ef63 : FLDZ
0058ef65 : PUSH EBX
0058ef66 : PUSH EBP
0058ef67 : PUSH ESI
0058ef68 : MOV ESI,dword ptr [ESP + 0x64]
0058ef6c : FST float ptr [ESI]
0058ef6e : PUSH EDI
0058ef6f : FST float ptr [ESI + 0x4]
0058ef72 : MOV EDI,ECX
0058ef74 : MOV EBX,dword ptr [EDI + 0xac]
0058ef7a : FST float ptr [ESI + 0x8]
0058ef7d : FST float ptr [ESI + 0xc]
0058ef80 : LEA ECX,[ESP + 0x4c]
0058ef84 : FST float ptr [ESP + 0x1c]
0058ef88 : MOV dword ptr [ESP + 0x10],EDI
0058ef8c : FST float ptr [ESP + 0x20]
0058ef90 : MOV dword ptr [ESP + 0x18],EBX
0058ef94 : FST float ptr [ESP + 0x24]
0058ef98 : FSTP float ptr [ESP + 0x28]
0058ef9c : CALL 0x00522b80
0058efa1 : XOR EBP,EBP
0058efa3 : TEST EBX,EBX
0058efa5 : MOV EBX,dword ptr [ESP + 0x6c]
0058efa9 : JBE 0x0058f129
0058efaf : NOP
0058efb0 : MOV EAX,dword ptr [EDI + 0xa8]
0058efb6 : MOV EDI,dword ptr [EAX + EBP*0x4]
0058efb9 : TEST EDI,EDI
0058efbb : JZ 0x0058f11a
0058efc1 : FLD float ptr [EBX]
0058efc3 : LEA ECX,[EDI + 0x44]
0058efc6 : FSTP float ptr [ESP + 0x4c]
0058efca : PUSH ECX
0058efcb : FLD float ptr [EBX + 0x4]
0058efce : LEA ECX,[ESP + 0x50]
0058efd2 : FSTP float ptr [ESP + 0x54]
0058efd6 : FLD float ptr [EBX + 0x8]
0058efd9 : FSTP float ptr [ESP + 0x58]
0058efdd : FLD float ptr [EBX + 0xc]
0058efe0 : FSTP float ptr [ESP + 0x5c]
0058efe4 : FLD float ptr [EBX + 0x10]
0058efe7 : FSTP float ptr [ESP + 0x60]
0058efeb : FLD float ptr [EBX + 0x14]
0058efee : FSTP float ptr [ESP + 0x64]
0058eff2 : CALL 0x00522e20
0058eff7 : MOV EDX,dword ptr [EDI]
0058eff9 : MOV EDX,dword ptr [EDX + 0x28]
0058effc : LEA EAX,[ESP + 0x4c]
0058f000 : PUSH EAX
0058f001 : LEA ECX,[ESP + 0x40]
0058f005 : PUSH ECX
0058f006 : MOV ECX,EDI
0058f008 : CALL EDX
0058f00a : FLD float ptr [EAX + 0x4]
0058f00d : FSTP float ptr [ESP + 0x68]
0058f011 : FLD float ptr [EAX + 0x8]
0058f014 : FSTP float ptr [ESP + 0x6c]
0058f018 : FLD float ptr [EAX + 0xc]
0058f01b : FSTP float ptr [ESP + 0x14]
0058f01f : FLD float ptr [EAX]
0058f021 : FSTP float ptr [ESP + 0x1c]
0058f025 : FLD float ptr [ESP + 0x68]
0058f029 : FST float ptr [ESP + 0x20]
0058f02d : FLD float ptr [ESP + 0x6c]
0058f031 : FST float ptr [ESP + 0x24]
0058f035 : FLD float ptr [ESP + 0x14]
0058f039 : FST float ptr [ESP + 0x28]
0058f03d : FLD float ptr [ESP + 0x1c]
0058f041 : FCOM ST2
0058f043 : FNSTSW AX
0058f045 : TEST AH,0x1
0058f048 : JZ 0x0058f10a
0058f04e : FXCH ST3
0058f050 : FCOM
0058f052 : FNSTSW AX
0058f054 : TEST AH,0x1
0058f057 : JZ 0x0058f112
0058f05d : FLD float ptr [ESI]
0058f05f : FLD float ptr [ESI + 0x8]
0058f062 : FCOMPP
0058f064 : FNSTSW AX
0058f066 : TEST AH,0x41
0058f069 : JNP 0x0058f0f9
0058f06f : FLD float ptr [ESI + 0x4]
0058f072 : FLD float ptr [ESI + 0xc]
0058f075 : FCOMPP
0058f077 : FNSTSW AX
0058f079 : TEST AH,0x41
0058f07c : JNP 0x0058f0f9
0058f07e : FLD float ptr [ESI]
0058f080 : FCOMP ST4
0058f082 : FNSTSW AX
0058f084 : TEST AH,0x41
0058f087 : JNZ 0x0058f08d
0058f089 : FXCH ST3
0058f08b : JMP 0x0058f091
0058f08d : FSTP ST3
0058f08f : FLD float ptr [ESI]
0058f091 : FSTP float ptr [ESP + 0x2c]
0058f095 : FLD float ptr [ESI + 0x8]
0058f098 : FCOMP ST2
0058f09a : FNSTSW AX
0058f09c : TEST AH,0x41
0058f09f : JNZ 0x0058f0a8
0058f0a1 : FSTP ST1
0058f0a3 : FLD float ptr [ESI + 0x8]
0058f0a6 : JMP 0x0058f0aa
0058f0a8 : FXCH
0058f0aa : FSTP float ptr [ESP + 0x34]
0058f0ae : FLD float ptr [ESI + 0x4]
0058f0b1 : FCOMP ST2
0058f0b3 : FNSTSW AX
0058f0b5 : TEST AH,0x41
0058f0b8 : JNZ 0x0058f0be
0058f0ba : FXCH
0058f0bc : JMP 0x0058f0c3
0058f0be : FSTP ST1
0058f0c0 : FLD float ptr [ESI + 0x4]
0058f0c3 : FSTP float ptr [ESP + 0x30]
0058f0c7 : FLD float ptr [ESI + 0xc]
0058f0ca : FCOMP
0058f0cc : FNSTSW AX
0058f0ce : TEST AH,0x41
0058f0d1 : JNZ 0x0058f0d8
0058f0d3 : FSTP ST0
0058f0d5 : FLD float ptr [ESI + 0xc]
0058f0d8 : FSTP float ptr [ESP + 0x38]
0058f0dc : FLD float ptr [ESP + 0x2c]
0058f0e0 : FSTP float ptr [ESI]
0058f0e2 : FLD float ptr [ESP + 0x30]
0058f0e6 : FSTP float ptr [ESI + 0x4]
0058f0e9 : FLD float ptr [ESP + 0x34]
0058f0ed : FSTP float ptr [ESI + 0x8]
0058f0f0 : FLD float ptr [ESP + 0x38]
0058f0f4 : FSTP float ptr [ESI + 0xc]
0058f0f7 : JMP 0x0058f11a
0058f0f9 : FXCH ST3
0058f0fb : FSTP float ptr [ESI]
0058f0fd : FXCH ST2
0058f0ff : FSTP float ptr [ESI + 0x4]
0058f102 : FSTP float ptr [ESI + 0x8]
0058f105 : FSTP float ptr [ESI + 0xc]
0058f108 : JMP 0x0058f11a
0058f10a : FSTP ST2
0058f10c : FSTP ST2
0058f10e : FSTP ST1
0058f110 : JMP 0x0058f118
0058f112 : FSTP ST2
0058f114 : FSTP ST1
0058f116 : FSTP ST0
0058f118 : FSTP ST0
0058f11a : MOV EDI,dword ptr [ESP + 0x10]
0058f11e : INC EBP
0058f11f : CMP EBP,dword ptr [ESP + 0x18]
0058f123 : JC 0x0058efb0
0058f129 : MOV ECX,dword ptr [EDI + 0x1b0]
0058f12f : TEST ECX,ECX
0058f131 : JZ 0x0058f25f
0058f137 : LEA EAX,[ESP + 0x1c]
0058f13b : PUSH EAX
0058f13c : CALL 0x005d7750
0058f141 : FLD float ptr [ESP + 0x1c]
0058f145 : FLD float ptr [ESP + 0x24]
0058f149 : FCOMPP
0058f14b : FNSTSW AX
0058f14d : TEST AH,0x41
0058f150 : JNP 0x0058f25f
0058f156 : FLD float ptr [ESP + 0x20]
0058f15a : FLD float ptr [ESP + 0x28]
0058f15e : FCOMPP
0058f160 : FNSTSW AX
0058f162 : TEST AH,0x41
0058f165 : JNP 0x0058f25f
0058f16b : FLDZ
0058f16d : LEA ECX,[ESP + 0x1c]
0058f171 : FST float ptr [ESP + 0x2c]
0058f175 : PUSH ECX
0058f176 : FST float ptr [ESP + 0x34]
0058f17a : LEA EDX,[ESP + 0x30]
0058f17e : FST float ptr [ESP + 0x38]
0058f182 : PUSH EDX
0058f183 : MOV ECX,EBX
0058f185 : FSTP float ptr [ESP + 0x40]
0058f189 : CALL 0x005231d0
0058f18e : FLD float ptr [ESI]
0058f190 : FLD float ptr [ESI + 0x8]
0058f193 : FCOMPP
0058f195 : FNSTSW AX
0058f197 : TEST AH,0x41
0058f19a : JNP 0x0058f244
0058f1a0 : FLD float ptr [ESI + 0x4]
0058f1a3 : FLD float ptr [ESI + 0xc]
0058f1a6 : FCOMPP
0058f1a8 : FNSTSW AX
0058f1aa : TEST AH,0x41
0058f1ad : JNP 0x0058f244
0058f1b3 : FLD float ptr [ESI]
0058f1b5 : FLD float ptr [ESP + 0x2c]
0058f1b9 : FCOM
0058f1bb : FNSTSW AX
0058f1bd : FSTP ST1
0058f1bf : TEST AH,0x5
0058f1c2 : JNP 0x0058f1c8
0058f1c4 : FSTP ST0
0058f1c6 : FLD float ptr [ESI]
0058f1c8 : FSTP float ptr [ESP + 0x1c]
0058f1cc : FLD float ptr [ESI + 0x8]
0058f1cf : FLD float ptr [ESP + 0x34]
0058f1d3 : FCOM
0058f1d5 : FNSTSW AX
0058f1d7 : FSTP ST1
0058f1d9 : TEST AH,0x5
0058f1dc : JP 0x0058f1e3
0058f1de : FSTP ST0
0058f1e0 : FLD float ptr [ESI + 0x8]
0058f1e3 : FSTP float ptr [ESP + 0x24]
0058f1e7 : FLD float ptr [ESI + 0x4]
0058f1ea : FLD float ptr [ESP + 0x30]
0058f1ee : FCOM
0058f1f0 : FNSTSW AX
0058f1f2 : FSTP ST1
0058f1f4 : TEST AH,0x5
0058f1f7 : JNP 0x0058f1fe
0058f1f9 : FSTP ST0
0058f1fb : FLD float ptr [ESI + 0x4]
0058f1fe : FSTP float ptr [ESP + 0x20]
0058f202 : FLD float ptr [ESI + 0xc]
0058f205 : FLD float ptr [ESP + 0x38]
0058f209 : FCOM
0058f20b : FNSTSW AX
0058f20d : FSTP ST1
0058f20f : TEST AH,0x5
0058f212 : JP 0x0058f219
0058f214 : FSTP ST0
0058f216 : FLD float ptr [ESI + 0xc]
0058f219 : FSTP float ptr [ESP + 0x28]
0058f21d : POP EDI
0058f21e : FLD float ptr [ESP + 0x18]
0058f222 : MOV EAX,ESI
0058f224 : FSTP float ptr [ESI]
0058f226 : FLD float ptr [ESP + 0x1c]
0058f22a : FSTP float ptr [ESI + 0x4]
0058f22d : FLD float ptr [ESP + 0x20]
0058f231 : FSTP float ptr [ESI + 0x8]
0058f234 : FLD float ptr [ESP + 0x24]
0058f238 : FSTP float ptr [ESI + 0xc]
0058f23b : POP ESI
0058f23c : POP EBP
0058f23d : POP EBX
0058f23e : ADD ESP,0x54
0058f241 : RET 0x8
0058f244 : FLD float ptr [ESP + 0x2c]
0058f248 : FSTP float ptr [ESI]
0058f24a : FLD float ptr [ESP + 0x30]
0058f24e : FSTP float ptr [ESI + 0x4]
0058f251 : FLD float ptr [ESP + 0x34]
0058f255 : FSTP float ptr [ESI + 0x8]
0058f258 : FLD float ptr [ESP + 0x38]
0058f25c : FSTP float ptr [ESI + 0xc]
0058f25f : POP EDI
0058f260 : MOV EAX,ESI
0058f262 : POP ESI
0058f263 : POP EBP
0058f264 : POP EBX
0058f265 : ADD ESP,0x54
0058f268 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_007d5290
ENTRY    : 007d5290
BODY     : [[007d5290, 007d537f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007d5290(undefined4 param_1)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  uint uVar3;
  int *piVar4;
  int iVar5;
  int in_ECX;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b0f2d0;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(int *)(in_ECX + 8) != 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  piVar4 = (int *)**(int **)(in_ECX + 0x188);
  if (piVar4 != *(int **)(in_ECX + 0x188)) {
    do {
      *(undefined1 *)(piVar4[9] + 0x1b6) = (undefined1)param_1;
      piVar4 = (int *)*piVar4;
    } while (piVar4 != (int *)*(int *)(in_ECX + 0x188));
  }
  local_8 = 0xffffffff;
  if (*(int *)(in_ECX + 8) != 0) {
    LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  if (*(int *)(in_ECX + 8) != 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  local_8 = 1;
  puVar1 = *(undefined4 **)(in_ECX + 0x38);
  for (puVar2 = (undefined4 *)*puVar1; puVar2 != puVar1; puVar2 = (undefined4 *)*puVar2) {
    iVar5 = (**(code **)(*(int *)puVar2[9] + 0x1c))(uVar3);
    if (iVar5 - 2U < 8) {
      FUN_007d5290(param_1);
    }
  }
  local_8 = 0xffffffff;
  if (*(int *)(in_ECX + 8) != 0) {
    LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
007d5290 : PUSH EBP
007d5291 : MOV EBP,ESP
007d5293 : PUSH -0x1
007d5295 : PUSH 0xb0f2d0
007d529a : MOV EAX,FS:[0x0]
007d52a0 : PUSH EAX
007d52a1 : PUSH ECX
007d52a2 : PUSH EBX
007d52a3 : PUSH ESI
007d52a4 : PUSH EDI
007d52a5 : MOV EAX,[0x00d66fa0]
007d52aa : XOR EAX,EBP
007d52ac : PUSH EAX
007d52ad : LEA EAX,[EBP + -0xc]
007d52b0 : MOV FS:[0x0],EAX
007d52b6 : MOV ESI,ECX
007d52b8 : MOV EAX,dword ptr [ESI + 0x8]
007d52bb : MOV EDI,dword ptr [0x00b85118]
007d52c1 : MOV dword ptr [EBP + -0x10],ESI
007d52c4 : TEST EAX,EAX
007d52c6 : JZ 0x007d52ce
007d52c8 : ADD EAX,0x4
007d52cb : PUSH EAX
007d52cc : CALL EDI
007d52ce : MOV dword ptr [EBP + -0x4],0x0
007d52d5 : MOV ECX,dword ptr [ESI + 0x188]
007d52db : MOV EAX,dword ptr [ECX]
007d52dd : CMP EAX,ECX
007d52df : JZ 0x007d52f7
007d52e1 : MOV ECX,dword ptr [EAX + 0x24]
007d52e4 : MOV DL,byte ptr [EBP + 0x8]
007d52e7 : MOV byte ptr [ECX + 0x1b6],DL
007d52ed : MOV EAX,dword ptr [EAX]
007d52ef : CMP EAX,dword ptr [ESI + 0x188]
007d52f5 : JNZ 0x007d52e1
007d52f7 : MOV dword ptr [EBP + -0x4],0xffffffff
007d52fe : MOV EAX,dword ptr [ESI + 0x8]
007d5301 : TEST EAX,EAX
007d5303 : JZ 0x007d530f
007d5305 : ADD EAX,0x4
007d5308 : PUSH EAX
007d5309 : CALL dword ptr [0x00b8511c]
007d530f : MOV EAX,dword ptr [ESI + 0x8]
007d5312 : MOV dword ptr [EBP + -0x10],ESI
007d5315 : TEST EAX,EAX
007d5317 : JZ 0x007d531f
007d5319 : ADD EAX,0x4
007d531c : PUSH EAX
007d531d : CALL EDI
007d531f : MOV dword ptr [EBP + -0x4],0x1
007d5326 : MOV EBX,dword ptr [ESI + 0x38]
007d5329 : MOV EDI,dword ptr [EBX]
007d532b : CMP EDI,EBX
007d532d : JZ 0x007d5354
007d532f : NOP
007d5330 : MOV ECX,dword ptr [EDI + 0x24]
007d5333 : MOV EAX,dword ptr [ECX]
007d5335 : MOV EDX,dword ptr [EAX + 0x1c]
007d5338 : CALL EDX
007d533a : ADD EAX,-0x2
007d533d : CMP EAX,0x7
007d5340 : JA 0x007d534e
007d5342 : MOV EAX,dword ptr [EBP + 0x8]
007d5345 : MOV ECX,dword ptr [EDI + 0x24]
007d5348 : PUSH EAX
007d5349 : CALL 0x007d5290
007d534e : MOV EDI,dword ptr [EDI]
007d5350 : CMP EDI,EBX
007d5352 : JNZ 0x007d5330
007d5354 : MOV dword ptr [EBP + -0x4],0xffffffff
007d535b : MOV ESI,dword ptr [ESI + 0x8]
007d535e : TEST ESI,ESI
007d5360 : JZ 0x007d536c
007d5362 : ADD ESI,0x4
007d5365 : PUSH ESI
007d5366 : CALL dword ptr [0x00b8511c]
007d536c : MOV ECX,dword ptr [EBP + -0xc]
007d536f : MOV dword ptr FS:[0x0],ECX
007d5376 : POP ECX
007d5377 : POP EDI
007d5378 : POP ESI
007d5379 : POP EBX
007d537a : MOV ESP,EBP
007d537c : POP EBP
007d537d : RET 0x4

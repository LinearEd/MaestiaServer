PROGRAM  : Maestia.exe
FUNCTION : _ungetc
ENTRY    : 0063eaee
BODY     : [[0063eaee, 0063eb55]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4 */
/* WARNING: Function: __SEH_epilog4 replaced with injection: EH_epilog3 */
/* Library Function - Single Match
    _ungetc
   
   Library: Visual Studio 2008 Release */

int __cdecl _ungetc(int _Ch,FILE *_File)

{
  int *piVar1;
  int iVar2;
  
  if (_File == (FILE *)0x0) {
    piVar1 = __errno();
    *piVar1 = 0x16;
    __invalid_parameter(0,0,0,0,0);
    iVar2 = -1;
  }
  else {
    __lock_file(_File);
    iVar2 = __ungetc_nolock(_Ch,_File);
    FUN_0063eb56();
  }
  return iVar2;
}



============================================================
DISASSEMBLY
============================================================
0063eaee : PUSH 0xc
0063eaf0 : PUSH 0xcece48
0063eaf5 : CALL 0x0064c228
0063eafa : XOR EAX,EAX
0063eafc : XOR ESI,ESI
0063eafe : CMP dword ptr [EBP + 0xc],ESI
0063eb01 : SETNZ AL
0063eb04 : CMP EAX,ESI
0063eb06 : JNZ 0x0063eb25
0063eb08 : CALL 0x0063ab82
0063eb0d : MOV dword ptr [EAX],0x16
0063eb13 : PUSH ESI
0063eb14 : PUSH ESI
0063eb15 : PUSH ESI
0063eb16 : PUSH ESI
0063eb17 : PUSH ESI
0063eb18 : CALL 0x006372b8
0063eb1d : ADD ESP,0x14
0063eb20 : OR EAX,0xffffffff
0063eb23 : JMP 0x0063eb50
0063eb25 : PUSH dword ptr [EBP + 0xc]
0063eb28 : CALL 0x0063d990
0063eb2d : POP ECX
0063eb2e : MOV dword ptr [EBP + -0x4],ESI
0063eb31 : PUSH dword ptr [EBP + 0xc]
0063eb34 : PUSH dword ptr [EBP + 0x8]
0063eb37 : CALL 0x0063e9fd
0063eb3c : POP ECX
0063eb3d : POP ECX
0063eb3e : MOV dword ptr [EBP + -0x1c],EAX
0063eb41 : MOV dword ptr [EBP + -0x4],0xfffffffe
0063eb48 : CALL 0x0063eb56
0063eb4d : MOV EAX,dword ptr [EBP + -0x1c]
0063eb50 : CALL 0x0064c26d
0063eb55 : RET

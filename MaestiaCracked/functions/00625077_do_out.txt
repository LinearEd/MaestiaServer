PROGRAM  : Maestia.exe
FUNCTION : do_out
ENTRY    : 00625077
BODY     : [[00625077, 0062517c]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    protected: virtual int __thiscall std::codecvt<wchar_t,char,int>::do_out(int &,wchar_t const
   *,wchar_t const *,wchar_t const * &,char *,char *,char * &)const 
   
   Library: Visual Studio 2008 Release */

int __thiscall
std::codecvt<wchar_t,char,int>::do_out
          (codecvt<wchar_t,char,int> *this,int *param_1,wchar_t *param_2,wchar_t *param_3,
          wchar_t **param_4,char *param_5,char *param_6,char **param_7)

{
  wchar_t *pwVar1;
  char *pcVar2;
  int iVar3;
  rsize_t _MaxCount;
  rsize_t _DstSize;
  char local_10 [8];
  uint local_8;
  
  local_8 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  *param_4 = param_2;
  *param_7 = param_5;
  pwVar1 = *param_4;
  do {
    if ((pwVar1 == param_3) || (*param_7 == param_6)) goto LAB_0062516c;
    pcVar2 = *param_7;
    iVar3 = ____mb_cur_max_func();
    if ((int)param_6 - (int)pcVar2 < iVar3) {
      iVar3 = *param_1;
      _MaxCount = __Wcrtomb(local_10,**param_4,param_1,(_Cvtvec *)(this + 8));
      if ((int)_MaxCount < 0) goto LAB_0062516c;
      _DstSize = (int)param_6 - (int)*param_7;
      if ((int)_DstSize < (int)_MaxCount) {
        *param_1 = iVar3;
LAB_0062516c:
        iVar3 = __security_check_cookie(local_8 ^ (uint)&stack0xfffffffc);
        return iVar3;
      }
      _memcpy_s(*param_7,_DstSize,local_10,_MaxCount);
      *param_4 = *param_4 + 1;
      *param_7 = *param_7 + _MaxCount;
    }
    else {
      iVar3 = __Wcrtomb(pcVar2,**param_4,param_1,(_Cvtvec *)(this + 8));
      if (iVar3 < 0) goto LAB_0062516c;
      *param_4 = *param_4 + 1;
      *param_7 = *param_7 + iVar3;
    }
    pwVar1 = *param_4;
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
00625077 : MOV EDI,EDI
00625079 : PUSH EBP
0062507a : MOV EBP,ESP
0062507c : SUB ESP,0x20
0062507f : MOV EAX,[0x00d66fa0]
00625084 : XOR EAX,EBP
00625086 : MOV dword ptr [EBP + -0x4],EAX
00625089 : MOV EAX,dword ptr [EBP + 0x1c]
0062508c : PUSH EBX
0062508d : MOV EBX,dword ptr [EBP + 0x8]
00625090 : MOV dword ptr [EBP + -0x18],EAX
00625093 : MOV EAX,dword ptr [EBP + 0xc]
00625096 : PUSH ESI
00625097 : MOV ESI,dword ptr [EBP + 0x14]
0062509a : MOV dword ptr [ESI],EAX
0062509c : MOV EAX,dword ptr [EBP + 0x18]
0062509f : PUSH EDI
006250a0 : MOV EDI,dword ptr [EBP + 0x20]
006250a3 : MOV dword ptr [EBP + -0x1c],ECX
006250a6 : XOR ECX,ECX
006250a8 : MOV dword ptr [EDI],EAX
006250aa : MOV EAX,dword ptr [ESI]
006250ac : CMP EAX,dword ptr [EBP + 0x10]
006250af : MOV dword ptr [EBP + -0x20],EBX
006250b2 : SETNZ CL
006250b5 : MOV dword ptr [EBP + -0x14],ECX
006250b8 : CMP EAX,dword ptr [EBP + 0x10]
006250bb : JZ 0x00625169
006250c1 : MOV EAX,dword ptr [EBP + -0x18]
006250c4 : CMP dword ptr [EDI],EAX
006250c6 : JZ 0x00625169
006250cc : MOV EAX,dword ptr [EDI]
006250ce : MOV dword ptr [EBP + -0x10],EAX
006250d1 : CALL 0x00642a32
006250d6 : MOV ECX,dword ptr [EBP + -0x18]
006250d9 : SUB ECX,dword ptr [EBP + -0x10]
006250dc : CMP EAX,ECX
006250de : JG 0x00625104
006250e0 : MOV EAX,dword ptr [EBP + -0x1c]
006250e3 : ADD EAX,0x8
006250e6 : PUSH EAX
006250e7 : MOV EAX,dword ptr [ESI]
006250e9 : MOVZX EAX,word ptr [EAX]
006250ec : PUSH EBX
006250ed : PUSH EAX
006250ee : PUSH dword ptr [EBP + -0x10]
006250f1 : CALL 0x006249de
006250f6 : ADD ESP,0x10
006250f9 : TEST EAX,EAX
006250fb : JL 0x0062515c
006250fd : ADD dword ptr [ESI],0x2
00625100 : ADD dword ptr [EDI],EAX
00625102 : JMP 0x0062514b
00625104 : MOV EAX,dword ptr [EBX]
00625106 : MOV dword ptr [EBP + -0x10],EAX
00625109 : MOV EAX,dword ptr [EBP + -0x1c]
0062510c : ADD EAX,0x8
0062510f : PUSH EAX
00625110 : MOV EAX,dword ptr [ESI]
00625112 : MOVZX EAX,word ptr [EAX]
00625115 : PUSH EBX
00625116 : PUSH EAX
00625117 : LEA EAX,[EBP + -0xc]
0062511a : PUSH EAX
0062511b : CALL 0x006249de
00625120 : MOV EBX,EAX
00625122 : ADD ESP,0x10
00625125 : TEST EBX,EBX
00625127 : JL 0x0062515c
00625129 : MOV EAX,dword ptr [EDI]
0062512b : MOV ECX,dword ptr [EBP + -0x18]
0062512e : SUB ECX,EAX
00625130 : CMP ECX,EBX
00625132 : JL 0x00625161
00625134 : PUSH EBX
00625135 : LEA EDX,[EBP + -0xc]
00625138 : PUSH EDX
00625139 : PUSH ECX
0062513a : PUSH EAX
0062513b : CALL 0x00633ea4
00625140 : ADD dword ptr [ESI],0x2
00625143 : ADD ESP,0x10
00625146 : ADD dword ptr [EDI],EBX
00625148 : MOV EBX,dword ptr [EBP + -0x20]
0062514b : MOV EAX,dword ptr [EBP + 0x10]
0062514e : AND dword ptr [EBP + -0x14],0x0
00625152 : CMP dword ptr [ESI],EAX
00625154 : JNZ 0x006250c1
0062515a : JMP 0x00625169
0062515c : PUSH 0x2
0062515e : POP EAX
0062515f : JMP 0x0062516c
00625161 : MOV EAX,dword ptr [EBP + -0x10]
00625164 : MOV ECX,dword ptr [EBP + -0x20]
00625167 : MOV dword ptr [ECX],EAX
00625169 : MOV EAX,dword ptr [EBP + -0x14]
0062516c : MOV ECX,dword ptr [EBP + -0x4]
0062516f : POP EDI
00625170 : POP ESI
00625171 : XOR ECX,EBP
00625173 : POP EBX
00625174 : CALL 0x00633e6b
00625179 : LEAVE
0062517a : RET 0x1c

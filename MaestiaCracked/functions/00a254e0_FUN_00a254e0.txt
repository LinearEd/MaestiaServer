PROGRAM  : Maestia.exe
FUNCTION : FUN_00a254e0
ENTRY    : 00a254e0
BODY     : [[00a254e0, 00a256a0]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a254e0(int param_1)

{
  int *piVar1;
  int *piVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  int iVar7;
  int *piVar8;
  undefined1 local_1c [4];
  int *local_18 [2];
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  iVar7 = param_1;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b2ff6d;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (param_1 == 0) {
    iVar4 = 0;
  }
  else {
    iVar4 = param_1 + 0x18;
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(iVar4 + 4));
  local_8 = 0;
  piVar8 = *(int **)(iVar7 + 0x4c);
  piVar1 = *(int **)(iVar7 + 0x34);
  while( true ) {
    if ((piVar1 == *(int **)(iVar7 + 0x34)) &&
       (piVar8 == (int *)(*(int *)(iVar7 + 0x4c) + *(int *)(iVar7 + 0x50)))) goto LAB_00a2567c;
    uVar5 = (uint)piVar8 >> 2;
    local_18[0] = (int *)((uint)piVar8 & 3);
    if (piVar1 == (int *)0x0) {
      iVar7 = 0;
    }
    else {
      iVar7 = *piVar1;
    }
    uVar6 = uVar5;
    if (*(uint *)(iVar7 + 0x14) <= uVar5) {
      if (piVar1 == (int *)0x0) {
        iVar7 = 0;
      }
      else {
        iVar7 = *piVar1;
      }
      uVar6 = uVar5 - *(int *)(iVar7 + 0x14);
    }
    if (piVar1 == (int *)0x0) {
      iVar7 = 0;
    }
    else {
      iVar7 = *piVar1;
    }
    piVar2 = *(int **)(*(int *)(*(int *)(iVar7 + 0x10) + uVar6 * 4) + (int)local_18[0] * 4);
    if (*(char *)((int)piVar2 + 0x5c2) != '\0') break;
    if (piVar1 == (int *)0x0) {
      iVar7 = 0;
    }
    else {
      iVar7 = *piVar1;
    }
    if (*(uint *)(iVar7 + 0x14) <= uVar5) {
      if (piVar1 == (int *)0x0) {
        iVar7 = 0;
      }
      else {
        iVar7 = *piVar1;
      }
      uVar5 = uVar5 - *(int *)(iVar7 + 0x14);
    }
    if (piVar1 == (int *)0x0) {
      iVar7 = 0;
    }
    else {
      iVar7 = *piVar1;
    }
    (**(code **)(**(int **)(*(int *)(*(int *)(iVar7 + 0x10) + uVar5 * 4) + (int)local_18[0] * 4) +
                0x248))(uVar3);
    piVar8 = (int *)((int)piVar8 + 1);
    iVar7 = param_1;
  }
  local_18[0] = piVar8;
  FUN_0043ea30(local_1c,piVar1,piVar8,piVar1,(int)piVar8 + 1);
  iVar7 = param_1;
  local_18[0] = piVar2;
  FUN_00443d70(local_18);
  local_18[0] = (int *)piVar2[1];
  FUN_004437f0(local_18);
  if (param_1 != *(int *)(iVar7 + 0xd8)) {
    piVar8 = *(int **)(param_1 + 0x10);
    local_18[0] = piVar8;
    (**(code **)(*piVar8 + 0x2cc))();
    FUN_00443d70(local_18);
    FUN_0042b2c0(iVar7 + 0xd4,&param_1,param_1);
    if (*(int **)(iVar7 + 600) == piVar8) {
      (**(code **)(*piVar8 + 0x29c))();
      *(undefined4 *)(iVar7 + 0x24c) = 0xffffffff;
      *(undefined4 *)(iVar7 + 600) = 0;
    }
  }
LAB_00a2567c:
  local_8 = 0xffffffff;
  LeaveCriticalSection((LPCRITICAL_SECTION)(iVar4 + 4));
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00a254e0 : PUSH EBP
00a254e1 : MOV EBP,ESP
00a254e3 : PUSH -0x1
00a254e5 : PUSH 0xb2ff6d
00a254ea : MOV EAX,FS:[0x0]
00a254f0 : PUSH EAX
00a254f1 : SUB ESP,0x18
00a254f4 : PUSH EBX
00a254f5 : PUSH ESI
00a254f6 : PUSH EDI
00a254f7 : MOV EAX,[0x00d66fa0]
00a254fc : XOR EAX,EBP
00a254fe : PUSH EAX
00a254ff : LEA EAX,[EBP + -0xc]
00a25502 : MOV FS:[0x0],EAX
00a25508 : MOV EDI,dword ptr [EBP + 0x8]
00a2550b : TEST EDI,EDI
00a2550d : JZ 0x00a25514
00a2550f : LEA EAX,[EDI + 0x18]
00a25512 : JMP 0x00a25516
00a25514 : XOR EAX,EAX
00a25516 : MOV dword ptr [EBP + -0x20],EAX
00a25519 : ADD EAX,0x4
00a2551c : PUSH EAX
00a2551d : MOV dword ptr [EBP + -0x1c],EAX
00a25520 : CALL dword ptr [0x00b85118]
00a25526 : MOV dword ptr [EBP + -0x4],0x0
00a2552d : MOV EBX,dword ptr [EDI + 0x4c]
00a25530 : MOV ESI,dword ptr [EDI + 0x34]
00a25533 : MOV EAX,dword ptr [EDI + 0x4c]
00a25536 : MOV ECX,dword ptr [EDI + 0x34]
00a25539 : ADD EAX,dword ptr [EDI + 0x50]
00a2553c : LEA EDX,[EDI + 0x34]
00a2553f : CMP ESI,ECX
00a25541 : JNZ 0x00a2554b
00a25543 : CMP EBX,EAX
00a25545 : JZ 0x00a2567c
00a2554b : MOV EAX,EBX
00a2554d : MOV EDI,EBX
00a2554f : SHR EAX,0x2
00a25552 : AND EDI,0x3
00a25555 : MOV ECX,EAX
00a25557 : MOV dword ptr [EBP + -0x14],EDI
00a2555a : TEST ESI,ESI
00a2555c : JZ 0x00a25562
00a2555e : MOV EDI,dword ptr [ESI]
00a25560 : JMP 0x00a25564
00a25562 : XOR EDI,EDI
00a25564 : CMP dword ptr [EDI + 0x14],ECX
00a25567 : JA 0x00a25576
00a25569 : TEST ESI,ESI
00a2556b : JZ 0x00a25571
00a2556d : MOV EDI,dword ptr [ESI]
00a2556f : JMP 0x00a25573
00a25571 : XOR EDI,EDI
00a25573 : SUB ECX,dword ptr [EDI + 0x14]
00a25576 : TEST ESI,ESI
00a25578 : JZ 0x00a2557e
00a2557a : MOV EDI,dword ptr [ESI]
00a2557c : JMP 0x00a25580
00a2557e : XOR EDI,EDI
00a25580 : MOV EDI,dword ptr [EDI + 0x10]
00a25583 : MOV ECX,dword ptr [EDI + ECX*0x4]
00a25586 : MOV EDI,dword ptr [EBP + -0x14]
00a25589 : MOV EDI,dword ptr [ECX + EDI*0x4]
00a2558c : CMP byte ptr [EDI + 0x5c2],0x0
00a25593 : JNZ 0x00a255da
00a25595 : TEST ESI,ESI
00a25597 : JZ 0x00a2559d
00a25599 : MOV ECX,dword ptr [ESI]
00a2559b : JMP 0x00a2559f
00a2559d : XOR ECX,ECX
00a2559f : CMP dword ptr [ECX + 0x14],EAX
00a255a2 : JA 0x00a255b1
00a255a4 : TEST ESI,ESI
00a255a6 : JZ 0x00a255ac
00a255a8 : MOV ECX,dword ptr [ESI]
00a255aa : JMP 0x00a255ae
00a255ac : XOR ECX,ECX
00a255ae : SUB EAX,dword ptr [ECX + 0x14]
00a255b1 : TEST ESI,ESI
00a255b3 : JZ 0x00a255b9
00a255b5 : MOV ECX,dword ptr [ESI]
00a255b7 : JMP 0x00a255bb
00a255b9 : XOR ECX,ECX
00a255bb : MOV EDX,dword ptr [ECX + 0x10]
00a255be : MOV EAX,dword ptr [EDX + EAX*0x4]
00a255c1 : MOV ECX,dword ptr [EBP + -0x14]
00a255c4 : MOV ECX,dword ptr [EAX + ECX*0x4]
00a255c7 : MOV EDX,dword ptr [ECX]
00a255c9 : MOV EAX,dword ptr [EDX + 0x248]
00a255cf : CALL EAX
00a255d1 : MOV EDI,dword ptr [EBP + 0x8]
00a255d4 : INC EBX
00a255d5 : JMP 0x00a25533
00a255da : LEA EAX,[EBX + 0x1]
00a255dd : PUSH EAX
00a255de : PUSH ESI
00a255df : PUSH EBX
00a255e0 : PUSH ESI
00a255e1 : LEA ECX,[EBP + -0x18]
00a255e4 : PUSH ECX
00a255e5 : MOV EAX,EDX
00a255e7 : MOV dword ptr [EBP + -0x14],EBX
00a255ea : CALL 0x0043ea30
00a255ef : MOV EBX,dword ptr [EBP + 0x8]
00a255f2 : LEA EDX,[EBP + -0x14]
00a255f5 : PUSH EDX
00a255f6 : LEA EAX,[EBX + 0x54]
00a255f9 : MOV dword ptr [EBP + -0x14],EDI
00a255fc : CALL 0x00443d70
00a25601 : MOV EAX,dword ptr [EDI + 0x4]
00a25604 : LEA ECX,[EBP + -0x14]
00a25607 : MOV dword ptr [EBP + -0x14],EAX
00a2560a : LEA EDI,[EBX + 0xd4]
00a25610 : PUSH ECX
00a25611 : LEA EAX,[EBP + 0x8]
00a25614 : MOV ECX,EDI
00a25616 : CALL 0x004437f0
00a2561b : MOV EAX,dword ptr [EBX + 0xd8]
00a25621 : MOV ECX,dword ptr [EBP + 0x8]
00a25624 : CMP ECX,EAX
00a25626 : JZ 0x00a2567c
00a25628 : MOV ESI,dword ptr [ECX + 0x10]
00a2562b : MOV EDX,dword ptr [ESI]
00a2562d : MOV EAX,dword ptr [EDX + 0x2cc]
00a25633 : MOV ECX,ESI
00a25635 : MOV dword ptr [EBP + -0x14],ESI
00a25638 : CALL EAX
00a2563a : LEA ECX,[EBP + -0x14]
00a2563d : PUSH ECX
00a2563e : LEA EAX,[EBX + 0x34]
00a25641 : CALL 0x00443d70
00a25646 : MOV EDX,dword ptr [EBP + 0x8]
00a25649 : PUSH EDX
00a2564a : LEA EAX,[EBP + 0x8]
00a2564d : PUSH EAX
00a2564e : PUSH EDI
00a2564f : CALL 0x0042b2c0
00a25654 : CMP dword ptr [EBX + 0x258],ESI
00a2565a : JNZ 0x00a2567c
00a2565c : MOV EDX,dword ptr [ESI]
00a2565e : MOV EAX,dword ptr [EDX + 0x29c]
00a25664 : MOV ECX,ESI
00a25666 : CALL EAX
00a25668 : MOV dword ptr [EBX + 0x24c],0xffffffff
00a25672 : MOV dword ptr [EBX + 0x258],0x0
00a2567c : MOV dword ptr [EBP + -0x4],0xffffffff
00a25683 : MOV ECX,dword ptr [EBP + -0x1c]
00a25686 : PUSH ECX
00a25687 : CALL dword ptr [0x00b8511c]
00a2568d : MOV ECX,dword ptr [EBP + -0xc]
00a25690 : MOV dword ptr FS:[0x0],ECX
00a25697 : POP ECX
00a25698 : POP EDI
00a25699 : POP ESI
00a2569a : POP EBX
00a2569b : MOV ESP,EBP
00a2569d : POP EBP
00a2569e : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : __mtinitlocknum
ENTRY    : 0064c4d5
BODY     : [[0064c4d5, 0064c58e]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4 */
/* WARNING: Function: __SEH_epilog4 replaced with injection: EH_epilog3 */
/* Library Function - Single Match
    __mtinitlocknum
   
   Library: Visual Studio 2008 Release */

int __cdecl __mtinitlocknum(int _LockNum)

{
  void *_Memory;
  int *piVar1;
  int iVar2;
  int local_20;
  
  iVar2 = 1;
  local_20 = 1;
  if (DAT_00d7c09c == 0) {
    __FF_MSGBANNER();
    __NMSG_WRITE(0x1e);
    ___crtExitProcess(0xff);
  }
  piVar1 = &DAT_00d67690 + _LockNum * 2;
  if (*piVar1 == 0) {
    _Memory = __malloc_crt(0x18);
    if (_Memory == (void *)0x0) {
      piVar1 = __errno();
      *piVar1 = 0xc;
      iVar2 = 0;
    }
    else {
      __lock(10);
      if (*piVar1 == 0) {
        iVar2 = ___crtInitCritSecAndSpinCount(_Memory,4000);
        if (iVar2 == 0) {
          _free(_Memory);
          piVar1 = __errno();
          *piVar1 = 0xc;
          local_20 = 0;
        }
        else {
          *piVar1 = (int)_Memory;
        }
      }
      else {
        _free(_Memory);
      }
      FUN_0064c58f();
      iVar2 = local_20;
    }
  }
  return iVar2;
}



============================================================
DISASSEMBLY
============================================================
0064c4d5 : PUSH 0xc
0064c4d7 : PUSH 0xced138
0064c4dc : CALL 0x0064c228
0064c4e1 : XOR EDI,EDI
0064c4e3 : INC EDI
0064c4e4 : MOV dword ptr [EBP + -0x1c],EDI
0064c4e7 : XOR EBX,EBX
0064c4e9 : CMP dword ptr [0x00d7c09c],EBX
0064c4ef : JNZ 0x0064c509
0064c4f1 : CALL 0x006455b9
0064c4f6 : PUSH 0x1e
0064c4f8 : CALL 0x0064540e
0064c4fd : PUSH 0xff
0064c502 : CALL 0x00635757
0064c507 : POP ECX
0064c508 : POP ECX
0064c509 : MOV ESI,dword ptr [EBP + 0x8]
0064c50c : LEA ESI,[ESI*0x8 + 0xd67690]
0064c513 : CMP dword ptr [ESI],EBX
0064c515 : JZ 0x0064c51b
0064c517 : MOV EAX,EDI
0064c519 : JMP 0x0064c589
0064c51b : PUSH 0x18
0064c51d : CALL 0x0064255f
0064c522 : POP ECX
0064c523 : MOV EDI,EAX
0064c525 : CMP EDI,EBX
0064c527 : JNZ 0x0064c538
0064c529 : CALL 0x0063ab82
0064c52e : MOV dword ptr [EAX],0xc
0064c534 : XOR EAX,EAX
0064c536 : JMP 0x0064c589
0064c538 : PUSH 0xa
0064c53a : CALL 0x0064c598
0064c53f : POP ECX
0064c540 : MOV dword ptr [EBP + -0x4],EBX
0064c543 : CMP dword ptr [ESI],EBX
0064c545 : JNZ 0x0064c573
0064c547 : PUSH 0xfa0
0064c54c : PUSH EDI
0064c54d : CALL 0x0064cbb2
0064c552 : POP ECX
0064c553 : POP ECX
0064c554 : TEST EAX,EAX
0064c556 : JNZ 0x0064c56f
0064c558 : PUSH EDI
0064c559 : CALL 0x0063610d
0064c55e : POP ECX
0064c55f : CALL 0x0063ab82
0064c564 : MOV dword ptr [EAX],0xc
0064c56a : MOV dword ptr [EBP + -0x1c],EBX
0064c56d : JMP 0x0064c57a
0064c56f : MOV dword ptr [ESI],EDI
0064c571 : JMP 0x0064c57a
0064c573 : PUSH EDI
0064c574 : CALL 0x0063610d
0064c579 : POP ECX
0064c57a : MOV dword ptr [EBP + -0x4],0xfffffffe
0064c581 : CALL 0x0064c58f
0064c586 : MOV EAX,dword ptr [EBP + -0x1c]
0064c589 : CALL 0x0064c26d
0064c58e : RET

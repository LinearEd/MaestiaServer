PROGRAM  : Maestia.exe
FUNCTION : FUN_00687a20
ENTRY    : 00687a20
BODY     : [[00687a20, 00687a7d]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_00687a20(int *param_1,undefined4 *param_2)

{
  undefined1 uVar1;
  uint uVar2;
  uint3 in_ECX;
  undefined4 uStack_4;
  
  *param_2 = 0;
  uStack_4 = (uint)in_ECX;
  if ((code *)param_1[5] == (code *)0x0) {
    uVar2 = param_1[2];
    if (uVar2 < (uint)param_1[1]) {
      uVar1 = *(undefined1 *)(uVar2 + *param_1);
      param_1[2] = param_1[2] + 1;
      return CONCAT31((int3)(uVar2 >> 8),uVar1);
    }
  }
  else {
    uVar2 = (*(code *)param_1[5])(param_1,param_1[2],(int)&uStack_4 + 3,1);
    if (uVar2 == 1) {
      param_1[2] = param_1[2] + 1;
      return uStack_4 >> 0x18;
    }
  }
  *param_2 = 0x55;
  return uVar2 & 0xffffff00;
}



============================================================
DISASSEMBLY
============================================================
00687a20 : PUSH ECX
00687a21 : PUSH ESI
00687a22 : MOV ESI,dword ptr [ESP + 0xc]
00687a26 : PUSH EDI
00687a27 : MOV EDI,dword ptr [ESP + 0x14]
00687a2b : MOV dword ptr [EDI],0x0
00687a31 : MOV EAX,dword ptr [ESI + 0x14]
00687a34 : MOV byte ptr [ESP + 0xb],0x0
00687a39 : TEST EAX,EAX
00687a3b : JZ 0x00687a5e
00687a3d : MOV EDX,dword ptr [ESI + 0x8]
00687a40 : PUSH 0x1
00687a42 : LEA ECX,[ESP + 0xf]
00687a46 : PUSH ECX
00687a47 : PUSH EDX
00687a48 : PUSH ESI
00687a49 : CALL EAX
00687a4b : ADD ESP,0x10
00687a4e : CMP EAX,0x1
00687a51 : JNZ 0x00687a72
00687a53 : INC dword ptr [ESI + 0x8]
00687a56 : MOV AL,byte ptr [ESP + 0xb]
00687a5a : POP EDI
00687a5b : POP ESI
00687a5c : POP ECX
00687a5d : RET
00687a5e : MOV EAX,dword ptr [ESI + 0x8]
00687a61 : CMP EAX,dword ptr [ESI + 0x4]
00687a64 : JNC 0x00687a72
00687a66 : MOV ECX,dword ptr [ESI]
00687a68 : MOV AL,byte ptr [EAX + ECX*0x1]
00687a6b : INC dword ptr [ESI + 0x8]
00687a6e : POP EDI
00687a6f : POP ESI
00687a70 : POP ECX
00687a71 : RET
00687a72 : MOV dword ptr [EDI],0x55
00687a78 : POP EDI
00687a79 : XOR AL,AL
00687a7b : POP ESI
00687a7c : POP ECX
00687a7d : RET

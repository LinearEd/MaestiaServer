PROGRAM  : Maestia.exe
FUNCTION : FUN_00812e40
ENTRY    : 00812e40
BODY     : [[00812e40, 00812e69] [00812e70, 00813117]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00812e40(void)

{
  char cVar1;
  uint uVar2;
  int *unaff_ESI;
  undefined4 *puVar3;
  undefined1 local_3c [8];
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 *local_28;
  undefined4 *local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18 [2];
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1a835;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  puVar3 = (undefined4 *)0x0;
  while (((uint)unaff_ESI[9] < (uint)unaff_ESI[8] &&
         (cVar1 = (**(code **)(*unaff_ESI + 0x1c))(&local_34,uVar2), cVar1 != '\0'))) {
    switch(local_34) {
    case 0x5081:
      (**(code **)(*unaff_ESI + 0xc))(&local_20,4,1);
      puVar3 = (undefined4 *)FUN_006f0760(0x38,"",0,(DAT_01725270 >> 3 & 1) == 0);
      local_8 = 0xffffffff;
      local_24 = puVar3;
      break;
    case 0x5082:
      (**(code **)(*unaff_ESI + 0xc))(&local_1c,4,1);
      if (puVar3 != (undefined4 *)0x0) {
        *puVar3 = local_1c;
      }
      break;
    case 0x5083:
      (**(code **)(*unaff_ESI + 0xc))(local_18,4,1);
      if (puVar3 != (undefined4 *)0x0) {
        puVar3[1] = local_18[0];
      }
      (**(code **)(*unaff_ESI + 0xc))(local_18,4,1);
      if (puVar3 != (undefined4 *)0x0) {
        puVar3[2] = local_18[0];
      }
      (**(code **)(*unaff_ESI + 0xc))(local_18,4,1);
      if (puVar3 != (undefined4 *)0x0) {
        puVar3[3] = local_18[0];
      }
      break;
    case 0x5084:
      (**(code **)(*unaff_ESI + 0xc))(local_18,4,1);
      if (puVar3 != (undefined4 *)0x0) {
        puVar3[4] = local_18[0];
      }
      (**(code **)(*unaff_ESI + 0xc))(local_18,4,1);
      if (puVar3 != (undefined4 *)0x0) {
        puVar3[5] = local_18[0];
      }
      (**(code **)(*unaff_ESI + 0xc))(local_18,4,1);
      if (puVar3 != (undefined4 *)0x0) {
        puVar3[6] = local_18[0];
      }
      break;
    case 0x5085:
      (**(code **)(*unaff_ESI + 0xc))(local_18,4,1);
      if (puVar3 != (undefined4 *)0x0) {
        puVar3[7] = local_18[0];
      }
      (**(code **)(*unaff_ESI + 0xc))(local_18,4,1);
      if (puVar3 != (undefined4 *)0x0) {
        puVar3[8] = local_18[0];
      }
      (**(code **)(*unaff_ESI + 0xc))(local_18,4,1);
      if (puVar3 != (undefined4 *)0x0) {
        puVar3[9] = local_18[0];
      }
      break;
    case 0x5086:
      (**(code **)(*unaff_ESI + 0xc))(local_18,4,1);
      if (puVar3 != (undefined4 *)0x0) {
        puVar3[10] = local_18[0];
      }
      (**(code **)(*unaff_ESI + 0xc))(local_18,4,1);
      if (puVar3 != (undefined4 *)0x0) {
        puVar3[0xb] = local_18[0];
      }
      (**(code **)(*unaff_ESI + 0xc))(local_18,4,1);
      if (puVar3 != (undefined4 *)0x0) {
        puVar3[0xc] = local_18[0];
      }
      break;
    case 0x5087:
      (**(code **)(*unaff_ESI + 0xc))(&local_1c,4,1);
      if (puVar3 != (undefined4 *)0x0) {
        puVar3[0xd] = local_1c;
        local_2c = local_20;
        local_28 = puVar3;
        FUN_00451e00(local_3c,&local_2c);
      }
      break;
    case 0x5088:
      goto switchD_00812ea2_caseD_5088;
    default:
      (**(code **)(*unaff_ESI + 0x24))(local_30);
    }
  }
switchD_00812ea2_caseD_5088:
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00812e40 : PUSH EBP
00812e41 : MOV EBP,ESP
00812e43 : PUSH -0x1
00812e45 : PUSH 0xb1a835
00812e4a : MOV EAX,FS:[0x0]
00812e50 : PUSH EAX
00812e51 : SUB ESP,0x30
00812e54 : PUSH EDI
00812e55 : MOV EAX,[0x00d66fa0]
00812e5a : XOR EAX,EBP
00812e5c : PUSH EAX
00812e5d : LEA EAX,[EBP + -0xc]
00812e60 : MOV FS:[0x0],EAX
00812e66 : XOR EDI,EDI
00812e68 : JMP 0x00812e70
00812e70 : MOV EAX,dword ptr [ESI + 0x24]
00812e73 : CMP EAX,dword ptr [ESI + 0x20]
00812e76 : JNC 0x00813106
00812e7c : MOV EDX,dword ptr [ESI]
00812e7e : MOV EDX,dword ptr [EDX + 0x1c]
00812e81 : LEA EAX,[EBP + -0x30]
00812e84 : PUSH EAX
00812e85 : MOV ECX,ESI
00812e87 : CALL EDX
00812e89 : TEST AL,AL
00812e8b : JZ 0x00813106
00812e91 : MOV EAX,dword ptr [EBP + -0x30]
00812e94 : ADD EAX,0xffffaf7f
00812e99 : CMP EAX,0x7
00812e9c : JA 0x008130f4
00812ea2 : JMP dword ptr [EAX*0x4 + 0x813118]
00812ea9 : MOV EAX,dword ptr [ESI]
00812eab : MOV EDX,dword ptr [EAX + 0xc]
00812eae : PUSH 0x1
00812eb0 : PUSH 0x4
00812eb2 : LEA ECX,[EBP + -0x1c]
00812eb5 : PUSH ECX
00812eb6 : MOV ECX,ESI
00812eb8 : CALL EDX
00812eba : MOV EAX,[0x01725270]
00812ebf : SHR EAX,0x3
00812ec2 : MOV ECX,0x0
00812ec7 : AND EAX,0x1
00812eca : SETZ CL
00812ecd : PUSH ECX
00812ece : PUSH 0x0
00812ed0 : PUSH 0xbf1a4a
00812ed5 : PUSH 0x38
00812ed7 : CALL 0x006f0760
00812edc : ADD ESP,0x10
00812edf : MOV dword ptr [EBP + -0x20],EAX
00812ee2 : MOV dword ptr [EBP + -0x4],0x0
00812ee9 : MOV dword ptr [EBP + -0x4],0xffffffff
00812ef0 : MOV EDI,EAX
00812ef2 : JMP 0x00812e70
00812ef7 : MOV EDX,dword ptr [ESI]
00812ef9 : MOV EDX,dword ptr [EDX + 0xc]
00812efc : PUSH 0x1
00812efe : PUSH 0x4
00812f00 : LEA EAX,[EBP + -0x18]
00812f03 : PUSH EAX
00812f04 : MOV ECX,ESI
00812f06 : CALL EDX
00812f08 : TEST EDI,EDI
00812f0a : JZ 0x00812e70
00812f10 : MOV EAX,dword ptr [EBP + -0x18]
00812f13 : MOV dword ptr [EDI],EAX
00812f15 : JMP 0x00812e70
00812f1a : MOV EDX,dword ptr [ESI]
00812f1c : MOV EDX,dword ptr [EDX + 0xc]
00812f1f : PUSH 0x1
00812f21 : PUSH 0x4
00812f23 : LEA EAX,[EBP + -0x14]
00812f26 : PUSH EAX
00812f27 : MOV ECX,ESI
00812f29 : CALL EDX
00812f2b : TEST EDI,EDI
00812f2d : JZ 0x00812f39
00812f2f : MOVSS XMM0,dword ptr [EBP + -0x14]
00812f34 : MOVSS dword ptr [EDI + 0x4],XMM0
00812f39 : MOV EAX,dword ptr [ESI]
00812f3b : MOV EDX,dword ptr [EAX + 0xc]
00812f3e : PUSH 0x1
00812f40 : PUSH 0x4
00812f42 : LEA ECX,[EBP + -0x14]
00812f45 : PUSH ECX
00812f46 : MOV ECX,ESI
00812f48 : CALL EDX
00812f4a : TEST EDI,EDI
00812f4c : JZ 0x00812f58
00812f4e : MOVSS XMM0,dword ptr [EBP + -0x14]
00812f53 : MOVSS dword ptr [EDI + 0x8],XMM0
00812f58 : MOV EAX,dword ptr [ESI]
00812f5a : MOV EDX,dword ptr [EAX + 0xc]
00812f5d : PUSH 0x1
00812f5f : PUSH 0x4
00812f61 : LEA ECX,[EBP + -0x14]
00812f64 : PUSH ECX
00812f65 : MOV ECX,ESI
00812f67 : CALL EDX
00812f69 : TEST EDI,EDI
00812f6b : JZ 0x00812e70
00812f71 : MOVSS XMM0,dword ptr [EBP + -0x14]
00812f76 : MOVSS dword ptr [EDI + 0xc],XMM0
00812f7b : JMP 0x00812e70
00812f80 : MOV EAX,dword ptr [ESI]
00812f82 : MOV EDX,dword ptr [EAX + 0xc]
00812f85 : PUSH 0x1
00812f87 : PUSH 0x4
00812f89 : LEA ECX,[EBP + -0x14]
00812f8c : PUSH ECX
00812f8d : MOV ECX,ESI
00812f8f : CALL EDX
00812f91 : TEST EDI,EDI
00812f93 : JZ 0x00812f9f
00812f95 : MOVSS XMM0,dword ptr [EBP + -0x14]
00812f9a : MOVSS dword ptr [EDI + 0x10],XMM0
00812f9f : MOV EAX,dword ptr [ESI]
00812fa1 : MOV EDX,dword ptr [EAX + 0xc]
00812fa4 : PUSH 0x1
00812fa6 : PUSH 0x4
00812fa8 : LEA ECX,[EBP + -0x14]
00812fab : PUSH ECX
00812fac : MOV ECX,ESI
00812fae : CALL EDX
00812fb0 : TEST EDI,EDI
00812fb2 : JZ 0x00812fbe
00812fb4 : MOVSS XMM0,dword ptr [EBP + -0x14]
00812fb9 : MOVSS dword ptr [EDI + 0x14],XMM0
00812fbe : MOV EAX,dword ptr [ESI]
00812fc0 : MOV EDX,dword ptr [EAX + 0xc]
00812fc3 : PUSH 0x1
00812fc5 : PUSH 0x4
00812fc7 : LEA ECX,[EBP + -0x14]
00812fca : PUSH ECX
00812fcb : MOV ECX,ESI
00812fcd : CALL EDX
00812fcf : TEST EDI,EDI
00812fd1 : JZ 0x00812e70
00812fd7 : MOVSS XMM0,dword ptr [EBP + -0x14]
00812fdc : MOVSS dword ptr [EDI + 0x18],XMM0
00812fe1 : JMP 0x00812e70
00812fe6 : MOV EAX,dword ptr [ESI]
00812fe8 : MOV EDX,dword ptr [EAX + 0xc]
00812feb : PUSH 0x1
00812fed : PUSH 0x4
00812fef : LEA ECX,[EBP + -0x14]
00812ff2 : PUSH ECX
00812ff3 : MOV ECX,ESI
00812ff5 : CALL EDX
00812ff7 : TEST EDI,EDI
00812ff9 : JZ 0x00813005
00812ffb : MOVSS XMM0,dword ptr [EBP + -0x14]
00813000 : MOVSS dword ptr [EDI + 0x1c],XMM0
00813005 : MOV EAX,dword ptr [ESI]
00813007 : MOV EDX,dword ptr [EAX + 0xc]
0081300a : PUSH 0x1
0081300c : PUSH 0x4
0081300e : LEA ECX,[EBP + -0x14]
00813011 : PUSH ECX
00813012 : MOV ECX,ESI
00813014 : CALL EDX
00813016 : TEST EDI,EDI
00813018 : JZ 0x00813024
0081301a : MOVSS XMM0,dword ptr [EBP + -0x14]
0081301f : MOVSS dword ptr [EDI + 0x20],XMM0
00813024 : MOV EAX,dword ptr [ESI]
00813026 : MOV EDX,dword ptr [EAX + 0xc]
00813029 : PUSH 0x1
0081302b : PUSH 0x4
0081302d : LEA ECX,[EBP + -0x14]
00813030 : PUSH ECX
00813031 : MOV ECX,ESI
00813033 : CALL EDX
00813035 : TEST EDI,EDI
00813037 : JZ 0x00812e70
0081303d : MOVSS XMM0,dword ptr [EBP + -0x14]
00813042 : MOVSS dword ptr [EDI + 0x24],XMM0
00813047 : JMP 0x00812e70
0081304c : MOV EAX,dword ptr [ESI]
0081304e : MOV EDX,dword ptr [EAX + 0xc]
00813051 : PUSH 0x1
00813053 : PUSH 0x4
00813055 : LEA ECX,[EBP + -0x14]
00813058 : PUSH ECX
00813059 : MOV ECX,ESI
0081305b : CALL EDX
0081305d : TEST EDI,EDI
0081305f : JZ 0x0081306b
00813061 : MOVSS XMM0,dword ptr [EBP + -0x14]
00813066 : MOVSS dword ptr [EDI + 0x28],XMM0
0081306b : MOV EAX,dword ptr [ESI]
0081306d : MOV EDX,dword ptr [EAX + 0xc]
00813070 : PUSH 0x1
00813072 : PUSH 0x4
00813074 : LEA ECX,[EBP + -0x14]
00813077 : PUSH ECX
00813078 : MOV ECX,ESI
0081307a : CALL EDX
0081307c : TEST EDI,EDI
0081307e : JZ 0x0081308a
00813080 : MOVSS XMM0,dword ptr [EBP + -0x14]
00813085 : MOVSS dword ptr [EDI + 0x2c],XMM0
0081308a : MOV EAX,dword ptr [ESI]
0081308c : MOV EDX,dword ptr [EAX + 0xc]
0081308f : PUSH 0x1
00813091 : PUSH 0x4
00813093 : LEA ECX,[EBP + -0x14]
00813096 : PUSH ECX
00813097 : MOV ECX,ESI
00813099 : CALL EDX
0081309b : TEST EDI,EDI
0081309d : JZ 0x00812e70
008130a3 : MOVSS XMM0,dword ptr [EBP + -0x14]
008130a8 : MOVSS dword ptr [EDI + 0x30],XMM0
008130ad : JMP 0x00812e70
008130b2 : MOV EAX,dword ptr [ESI]
008130b4 : MOV EDX,dword ptr [EAX + 0xc]
008130b7 : PUSH 0x1
008130b9 : PUSH 0x4
008130bb : LEA ECX,[EBP + -0x18]
008130be : PUSH ECX
008130bf : MOV ECX,ESI
008130c1 : CALL EDX
008130c3 : TEST EDI,EDI
008130c5 : JZ 0x00812e70
008130cb : MOV EAX,dword ptr [EBP + -0x18]
008130ce : MOV dword ptr [EDI + 0x34],EAX
008130d1 : MOV ECX,dword ptr [EBP + -0x1c]
008130d4 : LEA EDX,[EBP + -0x28]
008130d7 : PUSH EDX
008130d8 : LEA EAX,[EBP + -0x38]
008130db : PUSH EAX
008130dc : MOV EAX,dword ptr [EBP + 0x8]
008130df : ADD EAX,0xb0
008130e4 : MOV dword ptr [EBP + -0x28],ECX
008130e7 : MOV dword ptr [EBP + -0x24],EDI
008130ea : CALL 0x00451e00
008130ef : JMP 0x00812e70
008130f4 : MOV EDX,dword ptr [ESI]
008130f6 : MOV EAX,dword ptr [EBP + -0x2c]
008130f9 : MOV EDX,dword ptr [EDX + 0x24]
008130fc : PUSH EAX
008130fd : MOV ECX,ESI
008130ff : CALL EDX
00813101 : JMP 0x00812e70
00813106 : MOV ECX,dword ptr [EBP + -0xc]
00813109 : MOV dword ptr FS:[0x0],ECX
00813110 : POP ECX
00813111 : POP EDI
00813112 : MOV ESP,EBP
00813114 : POP EBP
00813115 : RET 0x4

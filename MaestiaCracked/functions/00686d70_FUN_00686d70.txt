PROGRAM  : Maestia.exe
FUNCTION : FUN_00686d70
ENTRY    : 00686d70
BODY     : [[00686d70, 00686ddf]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00686d70(int param_1,byte *param_2)

{
  undefined4 *puVar1;
  byte bVar2;
  byte *pbVar3;
  int iVar4;
  byte *pbVar5;
  undefined4 *puVar6;
  bool bVar7;
  
  if ((param_1 == 0) || (param_2 == (byte *)0x0)) {
    return 0;
  }
  puVar6 = (undefined4 *)(param_1 + 0x1c);
  puVar1 = puVar6 + *(int *)(param_1 + 0x18);
  if (puVar1 <= puVar6) {
    return 0;
  }
  do {
    pbVar3 = *(byte **)(*(int *)*puVar6 + 8);
    pbVar5 = param_2;
    do {
      bVar2 = *pbVar3;
      bVar7 = bVar2 < *pbVar5;
      if (bVar2 != *pbVar5) {
LAB_00686dc0:
        iVar4 = (1 - (uint)bVar7) - (uint)(bVar7 != 0);
        goto LAB_00686dc5;
      }
      if (bVar2 == 0) break;
      bVar2 = pbVar3[1];
      bVar7 = bVar2 < pbVar5[1];
      if (bVar2 != pbVar5[1]) goto LAB_00686dc0;
      pbVar3 = pbVar3 + 2;
      pbVar5 = pbVar5 + 2;
    } while (bVar2 != 0);
    iVar4 = 0;
LAB_00686dc5:
    if (iVar4 == 0) {
      return *puVar6;
    }
    puVar6 = puVar6 + 1;
    if (puVar1 <= puVar6) {
      return 0;
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
00686d70 : MOV ECX,dword ptr [ESP + 0x4]
00686d74 : XOR EAX,EAX
00686d76 : PUSH EBP
00686d77 : TEST ECX,ECX
00686d79 : JZ 0x00686ddc
00686d7b : MOV EBP,dword ptr [ESP + 0xc]
00686d7f : TEST EBP,EBP
00686d81 : JZ 0x00686ddc
00686d83 : PUSH ESI
00686d84 : LEA ESI,[ECX + 0x1c]
00686d87 : MOV ECX,dword ptr [ECX + 0x18]
00686d8a : PUSH EDI
00686d8b : LEA EDI,[ESI + ECX*0x4]
00686d8e : CMP ESI,EDI
00686d90 : JNC 0x00686dd8
00686d92 : PUSH EBX
00686d93 : MOV ECX,dword ptr [ESI]
00686d95 : MOV ECX,dword ptr [ECX]
00686d97 : MOV ECX,dword ptr [ECX + 0x8]
00686d9a : MOV EDX,EBP
00686d9c : LEA ESP,[ESP]
00686da0 : MOV BL,byte ptr [ECX]
00686da2 : CMP BL,byte ptr [EDX]
00686da4 : JNZ 0x00686dc0
00686da6 : TEST BL,BL
00686da8 : JZ 0x00686dbc
00686daa : MOV BL,byte ptr [ECX + 0x1]
00686dad : CMP BL,byte ptr [EDX + 0x1]
00686db0 : JNZ 0x00686dc0
00686db2 : ADD ECX,0x2
00686db5 : ADD EDX,0x2
00686db8 : TEST BL,BL
00686dba : JNZ 0x00686da0
00686dbc : XOR ECX,ECX
00686dbe : JMP 0x00686dc5
00686dc0 : SBB ECX,ECX
00686dc2 : SBB ECX,-0x1
00686dc5 : TEST ECX,ECX
00686dc7 : JZ 0x00686dd5
00686dc9 : ADD ESI,0x4
00686dcc : CMP ESI,EDI
00686dce : JC 0x00686d93
00686dd0 : POP EBX
00686dd1 : POP EDI
00686dd2 : POP ESI
00686dd3 : POP EBP
00686dd4 : RET
00686dd5 : MOV EAX,dword ptr [ESI]
00686dd7 : POP EBX
00686dd8 : POP EDI
00686dd9 : POP ESI
00686dda : POP EBP
00686ddb : RET
00686ddc : XOR EAX,EAX
00686dde : POP EBP
00686ddf : RET

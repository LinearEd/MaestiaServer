PROGRAM  : Maestia.exe
FUNCTION : FUN_00558820
ENTRY    : 00558820
BODY     : [[00558820, 005589ff]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00558820(int param_1,undefined4 param_2,undefined4 *param_3,int param_4)

{
  int iVar1;
  int *in_ECX;
  undefined4 uVar2;
  float afStack_1b4 [7];
  float fStack_198;
  float fStack_194;
  undefined4 uStack_190;
  undefined4 uStack_18c;
  undefined4 uStack_188;
  undefined4 uStack_184;
  undefined4 uStack_180;
  undefined4 uStack_17c;
  undefined1 auStack_178 [4];
  undefined4 local_174;
  undefined4 uStack_170;
  undefined4 uStack_168;
  undefined4 uStack_164;
  undefined1 local_154 [340];
  
  GMatrix2D::SetIdentity((GMatrix2D *)&local_174);
  FUN_00557b60();
  afStack_1b4[3] = 0.0;
  uVar2 = 0;
  afStack_1b4[4] = 0.0;
  afStack_1b4[5] = 0.0;
  afStack_1b4[2] = 0.0;
  afStack_1b4[6] = 0.0;
  if ((*(byte *)(in_ECX + 9) & 0x40) != 0) {
    uVar2 = (**(code **)(*in_ECX + 0x24))(afStack_1b4 + 2);
  }
  if ((*(byte *)(in_ECX + 9) & 0xc0) != 0) {
    if (param_4 == 0) goto LAB_00558960;
    if ((*(char *)(param_4 + 0x5c) != '\0') && (iVar1 = FUN_00555020(param_2), -1 < iVar1)) {
      FUN_005d6b20(auStack_178,param_3,0x3f800000,0);
      uStack_190 = local_174;
      uStack_18c = uStack_170;
      uStack_184 = uStack_168;
      uStack_180 = uStack_164;
      uStack_188 = 0;
      uStack_17c = 0;
      afStack_1b4[0] = 1.0;
      afStack_1b4[1] = 0.0;
      GMatrix2D::Transform
                ((GMatrix2D *)&uStack_190,(GPoint<float> *)&fStack_198,(GPoint<float> *)afStack_1b4)
      ;
      afStack_1b4[0] = ABS(fStack_198);
      if ((afStack_1b4[0] <= 1e-06) || (afStack_1b4[0] = ABS(fStack_194), afStack_1b4[0] <= 1e-06))
      {
        FUN_005dcbd0(afStack_1b4 + 3,afStack_1b4 + 4,afStack_1b4 + 5,afStack_1b4 + 6);
        FUN_005ad2d0(param_4,afStack_1b4 + 3,*(undefined4 *)(param_1 + 0xc),iVar1);
        FUN_005dc070(local_154);
        return;
      }
    }
  }
  if (param_4 != 0) {
    FUN_005ad7b0(param_2,uVar2,afStack_1b4[2]);
    FUN_00554a90(param_2,param_4);
  }
LAB_00558960:
  afStack_1b4[0] = *(float *)(param_1 + 8) * 0.25;
  FUN_005dcd20(afStack_1b4[0]);
  FUN_005dc490(param_2,uVar2,afStack_1b4[2],param_3,*param_3);
  return;
}



============================================================
DISASSEMBLY
============================================================
00558820 : SUB ESP,0x1b4
00558826 : PUSH EBX
00558827 : PUSH EBP
00558828 : PUSH ESI
00558829 : MOV ESI,ECX
0055882b : PUSH EDI
0055882c : LEA ECX,[ESP + 0x50]
00558830 : CALL 0x00522b80
00558835 : LEA ECX,[ESP + 0x70]
00558839 : CALL 0x00557b60
0055883e : FLDZ
00558840 : FST float ptr [ESP + 0x1c]
00558844 : XOR EBP,EBP
00558846 : TEST byte ptr [ESI + 0x24],0x40
0055884a : FST float ptr [ESP + 0x20]
0055884e : FST float ptr [ESP + 0x24]
00558852 : MOV dword ptr [ESP + 0x18],EBP
00558856 : FSTP float ptr [ESP + 0x28]
0055885a : JZ 0x0055886c
0055885c : MOV EAX,dword ptr [ESI]
0055885e : MOV EDX,dword ptr [EAX + 0x24]
00558861 : LEA ECX,[ESP + 0x18]
00558865 : PUSH ECX
00558866 : MOV ECX,ESI
00558868 : CALL EDX
0055886a : MOV EBP,EAX
0055886c : TEST byte ptr [ESI + 0x24],0xc0
00558870 : MOV EDI,dword ptr [ESP + 0x1cc]
00558877 : MOV EBX,dword ptr [ESP + 0x1d4]
0055887e : JZ 0x00558944
00558884 : TEST EBX,EBX
00558886 : JZ 0x00558960
0055888c : CMP byte ptr [EBX + 0x5c],0x0
00558890 : JZ 0x00558944
00558896 : PUSH EDI
00558897 : MOV ECX,ESI
00558899 : CALL 0x00555020
0055889e : MOV ESI,EAX
005588a0 : TEST ESI,ESI
005588a2 : JL 0x00558944
005588a8 : FLD1
005588aa : MOV EAX,dword ptr [ESP + 0x1d0]
005588b1 : PUSH 0x0
005588b3 : PUSH ECX
005588b4 : FSTP float ptr [ESP]
005588b7 : PUSH EAX
005588b8 : LEA ECX,[ESP + 0x58]
005588bc : LEA EDX,[ESI + ESI*0x4]
005588bf : PUSH ECX
005588c0 : LEA ECX,[EBP + EDX*0x8]
005588c4 : CALL 0x005d6b20
005588c9 : FLD float ptr [ESP + 0x50]
005588cd : FSTP float ptr [ESP + 0x34]
005588d1 : LEA EAX,[ESP + 0x10]
005588d5 : FLD float ptr [ESP + 0x54]
005588d9 : PUSH EAX
005588da : FSTP float ptr [ESP + 0x3c]
005588de : LEA ECX,[ESP + 0x30]
005588e2 : FLD float ptr [ESP + 0x60]
005588e6 : PUSH ECX
005588e7 : FSTP float ptr [ESP + 0x48]
005588eb : LEA ECX,[ESP + 0x3c]
005588ef : FLD float ptr [ESP + 0x68]
005588f3 : FSTP float ptr [ESP + 0x4c]
005588f7 : FLDZ
005588f9 : FST float ptr [ESP + 0x44]
005588fd : FST float ptr [ESP + 0x50]
00558901 : FLD1
00558903 : FSTP float ptr [ESP + 0x18]
00558907 : FSTP float ptr [ESP + 0x1c]
0055890b : CALL 0x00522c50
00558910 : FLD float ptr [ESP + 0x2c]
00558914 : FABS
00558916 : FSTP float ptr [ESP + 0x10]
0055891a : FLD float ptr [ESP + 0x10]
0055891e : FLD float ptr [0x00cdf414]
00558924 : FCOM
00558926 : FNSTSW AX
00558928 : FSTP ST1
0055892a : TEST AH,0x5
0055892d : JP 0x005589a9
0055892f : FLD float ptr [ESP + 0x30]
00558933 : FABS
00558935 : FSTP float ptr [ESP + 0x10]
00558939 : FCOMP float ptr [ESP + 0x10]
0055893d : FNSTSW AX
0055893f : TEST AH,0x5
00558942 : JP 0x005589ab
00558944 : TEST EBX,EBX
00558946 : JZ 0x00558960
00558948 : MOV EDX,dword ptr [ESP + 0x18]
0055894c : PUSH EDX
0055894d : PUSH EBP
0055894e : PUSH EDI
0055894f : MOV ECX,EBX
00558951 : CALL 0x005ad7b0
00558956 : PUSH EBX
00558957 : PUSH EDI
00558958 : CALL 0x00554a90
0055895d : ADD ESP,0x8
00558960 : MOV ESI,dword ptr [ESP + 0x1c8]
00558967 : FLD float ptr [ESI + 0x8]
0055896a : PUSH ECX
0055896b : FMUL double ptr [0x00cdf848]
00558971 : MOV ECX,EDI
00558973 : FSTP float ptr [ESP + 0x14]
00558977 : FLD float ptr [ESP + 0x14]
0055897b : FSTP float ptr [ESP]
0055897e : CALL 0x005dcd20
00558983 : MOV EAX,dword ptr [ESP + 0x1d0]
0055898a : MOV ECX,dword ptr [EAX]
0055898c : MOV EDX,dword ptr [ESP + 0x18]
00558990 : PUSH ECX
00558991 : PUSH EAX
00558992 : PUSH EDX
00558993 : PUSH EBP
00558994 : PUSH EDI
00558995 : MOV ECX,ESI
00558997 : CALL 0x005dc490
0055899c : POP EDI
0055899d : POP ESI
0055899e : POP EBP
0055899f : POP EBX
005589a0 : ADD ESP,0x1b4
005589a6 : RET 0x10
005589a9 : FSTP ST0
005589ab : LEA EDX,[ESP + 0x28]
005589af : PUSH EDX
005589b0 : LEA EAX,[ESP + 0x28]
005589b4 : PUSH EAX
005589b5 : LEA ECX,[ESP + 0x28]
005589b9 : PUSH ECX
005589ba : LEA EDX,[ESP + 0x28]
005589be : PUSH EDX
005589bf : MOV ECX,EDI
005589c1 : CALL 0x005dcbd0
005589c6 : PUSH ESI
005589c7 : MOV ESI,dword ptr [ESP + 0x1cc]
005589ce : FLD float ptr [ESI + 0xc]
005589d1 : PUSH ECX
005589d2 : FSTP float ptr [ESP]
005589d5 : LEA EAX,[ESP + 0x24]
005589d9 : PUSH EAX
005589da : PUSH EBX
005589db : LEA ECX,[ESP + 0x80]
005589e2 : CALL 0x005ad2d0
005589e7 : LEA ECX,[ESP + 0x70]
005589eb : PUSH ECX
005589ec : MOV ECX,ESI
005589ee : CALL 0x005dc070
005589f3 : POP EDI
005589f4 : POP ESI
005589f5 : POP EBP
005589f6 : POP EBX
005589f7 : ADD ESP,0x1b4
005589fd : RET 0x10

PROGRAM  : Maestia.exe
FUNCTION : FUN_00767ab0
ENTRY    : 00767ab0
BODY     : [[00767ab0, 00767c8f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00767ab0(int param_1,int param_2,int param_3,int param_4,undefined4 param_5,int param_6)

{
  undefined4 *puVar1;
  float fVar2;
  float fVar3;
  float fVar4;
  int iVar5;
  float fVar6;
  int iVar7;
  int in_ECX;
  uint uVar8;
  uint uVar9;
  ushort uVar10;
  uint local_2c;
  uint local_20;
  
  iVar7 = FUN_0070a3a0();
  fVar6 = DAT_00d72c24;
  uVar10 = 0;
  if (*(short *)(in_ECX + 0x10) != 0) {
    do {
      uVar9 = (uint)uVar10;
      iVar5 = uVar9 * 0xc;
      puVar1 = (undefined4 *)(iVar7 + uVar9 * 0x24);
      *puVar1 = *(undefined4 *)(iVar5 + param_1);
      puVar1[1] = *(undefined4 *)(iVar5 + 4 + param_1);
      puVar1[2] = *(undefined4 *)(iVar5 + 8 + param_1);
      puVar1[3] = *(undefined4 *)(iVar5 + param_2);
      puVar1[4] = *(undefined4 *)(iVar5 + 4 + param_2);
      puVar1[5] = *(undefined4 *)(iVar5 + 8 + param_2);
      fVar2 = *(float *)(iVar5 + param_4);
      fVar3 = *(float *)(iVar5 + 4 + param_4);
      fVar4 = *(float *)(iVar5 + 8 + param_4);
      if (fVar2 < 1.0) {
        if (0.0 < fVar2) {
          local_20 = (uint)(longlong)ROUND(fVar2 * 255.0 + fVar6);
          uVar8 = local_20;
        }
        else {
          uVar8 = 0;
        }
      }
      else {
        uVar8 = 0xff;
      }
      if (fVar3 < 1.0) {
        if (0.0 < fVar3) {
          local_20 = (uint)(longlong)ROUND(fVar3 * 255.0 + fVar6);
          local_2c = local_20;
        }
        else {
          local_2c = 0;
        }
      }
      else {
        local_2c = 0xff;
      }
      if (fVar4 < 1.0) {
        if (0.0 < fVar4) {
          local_20 = (uint)(longlong)ROUND(fVar4 * 255.0 + fVar6);
        }
        else {
          local_20 = 0;
        }
      }
      else {
        local_20 = 0xff;
      }
      uVar10 = uVar10 + 1;
      puVar1[6] = ((uVar8 | 0xffffff00) << 8 | local_2c) << 8 | local_20;
      puVar1[7] = *(undefined4 *)(param_3 + uVar9 * 8);
      puVar1[8] = *(undefined4 *)(param_3 + 4 + uVar9 * 8);
    } while (uVar10 < *(ushort *)(in_ECX + 0x10));
  }
  FUN_007377f0(iVar7);
  if (param_6 != 0) {
    *(int *)(in_ECX + 0x24) = param_6;
  }
  FUN_0070a260(iVar7);
  return;
}



============================================================
DISASSEMBLY
============================================================
00767ab0 : PUSH EBP
00767ab1 : MOV EBP,ESP
00767ab3 : AND ESP,0xfffffff8
00767ab6 : SUB ESP,0x2c
00767ab9 : PUSH EBX
00767aba : PUSH ESI
00767abb : MOV ESI,ECX
00767abd : MOVZX EAX,word ptr [ESI + 0x10]
00767ac1 : LEA ECX,[EAX + EAX*0x8]
00767ac4 : ADD ECX,ECX
00767ac6 : PUSH EDI
00767ac7 : ADD ECX,ECX
00767ac9 : MOV dword ptr [ESP + 0x18],ESI
00767acd : CALL 0x0070a3a0
00767ad2 : MOV EBX,EAX
00767ad4 : XOR EAX,EAX
00767ad6 : XOR EDI,EDI
00767ad8 : MOV dword ptr [ESP + 0x1c],EBX
00767adc : CMP AX,word ptr [ESI + 0x10]
00767ae0 : JNC 0x00767c6c
00767ae6 : FLD float ptr [0x00cdf130]
00767aec : MOV EBX,dword ptr [EBP + 0x14]
00767aef : MOVSS XMM3,dword ptr [0x00c10fc4]
00767af7 : FLD float ptr [0x00d72c24]
00767afd : XORPS XMM4,XMM4
00767b00 : MOV EDX,dword ptr [ESP + 0x1c]
00767b04 : MOVZX ESI,DI
00767b07 : LEA EAX,[ESI + ESI*0x2]
00767b0a : ADD EAX,EAX
00767b0c : ADD EAX,EAX
00767b0e : LEA ECX,[ESI + ESI*0x8]
00767b11 : LEA ECX,[EDX + ECX*0x4]
00767b14 : MOV EDX,dword ptr [EBP + 0x8]
00767b17 : FLD float ptr [EAX + EDX*0x1]
00767b1a : FSTP float ptr [ECX]
00767b1c : FLD float ptr [EAX + EDX*0x1 + 0x4]
00767b20 : FSTP float ptr [ECX + 0x4]
00767b23 : FLD float ptr [EAX + EDX*0x1 + 0x8]
00767b27 : MOV EDX,dword ptr [EBP + 0xc]
00767b2a : FSTP float ptr [ECX + 0x8]
00767b2d : FLD float ptr [EAX + EDX*0x1]
00767b30 : FSTP float ptr [ECX + 0xc]
00767b33 : FLD float ptr [EAX + EDX*0x1 + 0x4]
00767b37 : FSTP float ptr [ECX + 0x10]
00767b3a : FLD float ptr [EAX + EDX*0x1 + 0x8]
00767b3e : FSTP float ptr [ECX + 0x14]
00767b41 : MOVSS XMM0,dword ptr [EAX + EBX*0x1]
00767b46 : COMISS XMM0,XMM3
00767b49 : MOVSS XMM1,dword ptr [EAX + EBX*0x1 + 0x4]
00767b4f : MOVSS XMM2,dword ptr [EAX + EBX*0x1 + 0x8]
00767b55 : MOVSS dword ptr [ESP + 0x28],XMM0
00767b5b : MOVSS dword ptr [ESP + 0x2c],XMM1
00767b61 : MOVSS dword ptr [ESP + 0x30],XMM2
00767b67 : JC 0x00767b70
00767b69 : MOV EDX,0xff
00767b6e : JMP 0x00767ba3
00767b70 : COMISS XMM4,XMM0
00767b73 : JC 0x00767b79
00767b75 : XOR EDX,EDX
00767b77 : JMP 0x00767ba3
00767b79 : FLD float ptr [ESP + 0x28]
00767b7d : FNSTCW word ptr [ESP + 0x12]
00767b81 : MOVZX EAX,word ptr [ESP + 0x12]
00767b86 : FMUL ST2
00767b88 : OR EAX,0xc00
00767b8d : MOV dword ptr [ESP + 0x14],EAX
00767b91 : FADD ST0,ST1
00767b93 : FLDCW word ptr [ESP + 0x14]
00767b97 : FISTP qword ptr [ESP + 0x20]
00767b9b : MOV EDX,dword ptr [ESP + 0x20]
00767b9f : FLDCW word ptr [ESP + 0x12]
00767ba3 : COMISS XMM1,XMM3
00767ba6 : JC 0x00767bb2
00767ba8 : MOV dword ptr [ESP + 0x14],0xff
00767bb0 : JMP 0x00767bef
00767bb2 : COMISS XMM4,XMM1
00767bb5 : JC 0x00767bc1
00767bb7 : MOV dword ptr [ESP + 0x14],0x0
00767bbf : JMP 0x00767bef
00767bc1 : FLD float ptr [ESP + 0x2c]
00767bc5 : FNSTCW word ptr [ESP + 0x12]
00767bc9 : MOVZX EAX,word ptr [ESP + 0x12]
00767bce : FMUL ST2
00767bd0 : OR EAX,0xc00
00767bd5 : MOV dword ptr [ESP + 0x14],EAX
00767bd9 : FADD ST0,ST1
00767bdb : FLDCW word ptr [ESP + 0x14]
00767bdf : FISTP qword ptr [ESP + 0x20]
00767be3 : MOV EAX,dword ptr [ESP + 0x20]
00767be7 : MOV dword ptr [ESP + 0x14],EAX
00767beb : FLDCW word ptr [ESP + 0x12]
00767bef : COMISS XMM2,XMM3
00767bf2 : JC 0x00767bfb
00767bf4 : MOV EAX,0xff
00767bf9 : JMP 0x00767c2e
00767bfb : COMISS XMM4,XMM2
00767bfe : JC 0x00767c04
00767c00 : XOR EAX,EAX
00767c02 : JMP 0x00767c2e
00767c04 : FLD float ptr [ESP + 0x30]
00767c08 : FNSTCW word ptr [ESP + 0x12]
00767c0c : MOVZX EAX,word ptr [ESP + 0x12]
00767c11 : FMUL ST2
00767c13 : OR EAX,0xc00
00767c18 : MOV dword ptr [ESP + 0x20],EAX
00767c1c : FADD ST0,ST1
00767c1e : FLDCW word ptr [ESP + 0x20]
00767c22 : FISTP qword ptr [ESP + 0x20]
00767c26 : MOV EAX,dword ptr [ESP + 0x20]
00767c2a : FLDCW word ptr [ESP + 0x12]
00767c2e : OR EDX,0xffffff00
00767c34 : SHL EDX,0x8
00767c37 : OR EDX,dword ptr [ESP + 0x14]
00767c3b : INC EDI
00767c3c : SHL EDX,0x8
00767c3f : OR EDX,EAX
00767c41 : MOV EAX,dword ptr [EBP + 0x10]
00767c44 : MOV dword ptr [ECX + 0x18],EDX
00767c47 : FLD float ptr [EAX + ESI*0x8]
00767c4a : FSTP float ptr [ECX + 0x1c]
00767c4d : FLD float ptr [EAX + ESI*0x8 + 0x4]
00767c51 : FSTP float ptr [ECX + 0x20]
00767c54 : MOV ECX,dword ptr [ESP + 0x18]
00767c58 : CMP DI,word ptr [ECX + 0x10]
00767c5c : JC 0x00767b00
00767c62 : MOV EBX,dword ptr [ESP + 0x1c]
00767c66 : FSTP ST1
00767c68 : FSTP ST0
00767c6a : MOV ESI,ECX
00767c6c : PUSH EBX
00767c6d : MOV ECX,ESI
00767c6f : CALL 0x007377f0
00767c74 : MOV EAX,dword ptr [EBP + 0x1c]
00767c77 : TEST EAX,EAX
00767c79 : JZ 0x00767c7e
00767c7b : MOV dword ptr [ESI + 0x24],EAX
00767c7e : PUSH EBX
00767c7f : CALL 0x0070a260
00767c84 : ADD ESP,0x4
00767c87 : POP EDI
00767c88 : POP ESI
00767c89 : POP EBX
00767c8a : MOV ESP,EBP
00767c8c : POP EBP
00767c8d : RET 0x18

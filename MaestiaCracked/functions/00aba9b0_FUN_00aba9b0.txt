PROGRAM  : Maestia.exe
FUNCTION : FUN_00aba9b0
ENTRY    : 00aba9b0
BODY     : [[00aba9b0, 00abab14]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00aba9b0(char param_1)

{
  int iVar1;
  ulonglong uVar2;
  uint uVar3;
  uint8_t *packet;
  int in_ECX;
  undefined2 uVar4;
  undefined1 local_54 [4];
  undefined2 local_50;
  undefined4 local_40;
  uint local_3c;
  uint8_t *local_38;
  uint8_t *local_34;
  undefined1 local_30 [28];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b419d7;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_14 = uVar3;
  FUN_00413b60(in_ECX + 0x3a);
  local_38 = *(uint8_t **)(in_ECX + 0x4c);
  if ((local_34 == local_38) || (*(short *)(*(int *)(local_34 + 0x10) + 0x28) == 1)) {
    uVar4 = 0;
    if (param_1 == '\x01') {
      FUN_00413b60(in_ECX + 0x3a);
      if (local_34 != local_38) {
        uVar4 = *(undefined2 *)(*(int *)(local_34 + 0x10) + 8);
      }
    }
    iVar1 = *(int *)ThreadLocalStoragePointer;
    uVar2 = (ulonglong)(*(byte *)(iVar1 + 0x18) + 1) % 3;
    local_38 = (uint8_t *)((int)uVar2 * 0x2000 + 0x122cb8 + iVar1);
    *(char *)(iVar1 + 0x18) = (char)uVar2;
    if (local_38 == (uint8_t *)0x0) {
      packet = (uint8_t *)0x0;
    }
    else {
      local_38[0] = '\0';
      local_38[1] = '\0';
      local_38[2] = 0xcc;
      local_38[3] = '\x06';
      *(undefined2 *)(local_38 + 4) = uVar4;
      packet = local_38;
    }
    local_8 = 0xffffffff;
    if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
      FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),6,packet);
    }
  }
  else {
    FUN_00406460(L"IDS_CHAR_TITLE_NOT_ACHIVE");
    local_8 = 0;
    FUN_0081d120(local_54);
    local_8 = CONCAT31(local_8._1_3_,2);
    if (7 < local_3c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_3c = 7;
    local_40 = 0;
    local_50 = 0;
    FUN_008ede80(local_30,0);
    local_8 = 0xffffffff;
    FUN_00406560(uVar3);
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00aba9b0 : PUSH EBP
00aba9b1 : MOV EBP,ESP
00aba9b3 : PUSH -0x1
00aba9b5 : PUSH 0xb419d7
00aba9ba : MOV EAX,FS:[0x0]
00aba9c0 : PUSH EAX
00aba9c1 : SUB ESP,0x48
00aba9c4 : MOV EAX,[0x00d66fa0]
00aba9c9 : XOR EAX,EBP
00aba9cb : MOV dword ptr [EBP + -0x10],EAX
00aba9ce : PUSH EBX
00aba9cf : PUSH ESI
00aba9d0 : PUSH EDI
00aba9d1 : PUSH EAX
00aba9d2 : LEA EAX,[EBP + -0xc]
00aba9d5 : MOV FS:[0x0],EAX
00aba9db : MOV ESI,ECX
00aba9dd : LEA EDI,[ESI + 0x3a]
00aba9e0 : LEA EBX,[ESI + 0x48]
00aba9e3 : PUSH EDI
00aba9e4 : LEA EAX,[EBP + -0x30]
00aba9e7 : MOV ECX,EBX
00aba9e9 : CALL 0x00413b60
00aba9ee : MOV EAX,dword ptr [ESI + 0x4c]
00aba9f1 : MOV ECX,dword ptr [EBP + -0x30]
00aba9f4 : MOV dword ptr [EBP + -0x34],EAX
00aba9f7 : CMP ECX,EAX
00aba9f9 : JZ 0x00abaa6c
00aba9fb : MOV EAX,dword ptr [ECX + 0x10]
00aba9fe : CMP word ptr [EAX + 0x28],0x1
00abaa03 : JZ 0x00abaa6c
00abaa05 : PUSH 0xc8f01c
00abaa0a : LEA ECX,[EBP + -0x50]
00abaa0d : CALL 0x00406460
00abaa12 : XOR EBX,EBX
00abaa14 : MOV dword ptr [EBP + -0x4],EBX
00abaa17 : LEA ECX,[EBP + -0x50]
00abaa1a : PUSH ECX
00abaa1b : MOV ECX,dword ptr [0x0172491c]
00abaa21 : LEA EDI,[EBP + -0x2c]
00abaa24 : CALL 0x0081d120
00abaa29 : MOV byte ptr [EBP + -0x4],0x2
00abaa2d : CMP dword ptr [EBP + -0x38],0x8
00abaa31 : JC 0x00abaa3b
00abaa33 : MOV ECX,dword ptr [EBP + -0x4c]
00abaa36 : CALL 0x006f04e0
00abaa3b : MOV ECX,dword ptr [ESI + 0x4]
00abaa3e : PUSH EBX
00abaa3f : LEA EAX,[EBP + -0x2c]
00abaa42 : XOR EDX,EDX
00abaa44 : PUSH EAX
00abaa45 : MOV dword ptr [EBP + -0x38],0x7
00abaa4c : MOV dword ptr [EBP + -0x3c],EBX
00abaa4f : MOV word ptr [EBP + -0x4c],DX
00abaa53 : CALL 0x008ede80
00abaa58 : MOV dword ptr [EBP + -0x4],0xffffffff
00abaa5f : LEA ECX,[EBP + -0x2c]
00abaa62 : CALL 0x00406560
00abaa67 : JMP 0x00abaaf7
00abaa6c : XOR ESI,ESI
00abaa6e : CMP byte ptr [EBP + 0x8],0x1
00abaa72 : JNZ 0x00abaa8e
00abaa74 : PUSH EDI
00abaa75 : LEA EAX,[EBP + -0x30]
00abaa78 : MOV ECX,EBX
00abaa7a : CALL 0x00413b60
00abaa7f : MOV EAX,dword ptr [EBP + -0x30]
00abaa82 : CMP EAX,dword ptr [EBP + -0x34]
00abaa85 : JZ 0x00abaa8e
00abaa87 : MOV ECX,dword ptr [EAX + 0x10]
00abaa8a : MOVZX ESI,word ptr [ECX + 0x8]
00abaa8e : MOV EDX,dword ptr FS:[0x2c]
00abaa95 : MOV ECX,dword ptr [EDX]
00abaa97 : MOVZX EAX,byte ptr [ECX + 0x18]
00abaa9b : INC EAX
00abaa9c : CDQ
00abaa9d : MOV EDI,0x3
00abaaa2 : IDIV EDI
00abaaa4 : MOVZX EAX,DL
00abaaa7 : SHL EAX,0xd
00abaaaa : LEA EAX,[EAX + ECX*0x1 + 0x122cb8]
00abaab1 : MOV byte ptr [ECX + 0x18],DL
00abaab4 : MOV dword ptr [EBP + -0x34],EAX
00abaab7 : MOV dword ptr [EBP + -0x4],EDI
00abaaba : TEST EAX,EAX
00abaabc : JZ 0x00abaad1
00abaabe : XOR ECX,ECX
00abaac0 : MOV word ptr [EAX],CX
00abaac3 : MOV byte ptr [EAX + 0x2],0xcc
00abaac7 : MOV byte ptr [EAX + 0x3],0x6
00abaacb : MOV word ptr [EAX + 0x4],SI
00abaacf : JMP 0x00abaad3
00abaad1 : XOR EAX,EAX
00abaad3 : MOV dword ptr [EBP + -0x4],0xffffffff
00abaada : MOV EDX,dword ptr [0x017247d4]
00abaae0 : MOV ECX,dword ptr [EDX + 0x4]
00abaae3 : TEST ECX,ECX
00abaae5 : JZ 0x00abaaf7
00abaae7 : CMP byte ptr [EDX + 0x8],0x0
00abaaeb : JZ 0x00abaaf7
00abaaed : PUSH 0x6
00abaaef : PUSH ECX
00abaaf0 : MOV EDI,EAX
00abaaf2 : CALL 0x00a0dd40
00abaaf7 : MOV ECX,dword ptr [EBP + -0xc]
00abaafa : MOV dword ptr FS:[0x0],ECX
00abab01 : POP ECX
00abab02 : POP EDI
00abab03 : POP ESI
00abab04 : POP EBX
00abab05 : MOV ECX,dword ptr [EBP + -0x10]
00abab08 : XOR ECX,EBP
00abab0a : CALL 0x00633e6b
00abab0f : MOV ESP,EBP
00abab11 : POP EBP
00abab12 : RET 0x4

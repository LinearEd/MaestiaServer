PROGRAM  : Maestia.exe
FUNCTION : FUN_006e1950
ENTRY    : 006e1950
BODY     : [[006e1950, 006e19f7] [006e1a00, 006e1ac0]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006e1950(int param_1,int param_2)

{
  int iVar1;
  int *in_EAX;
  int iVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  ushort *puVar8;
  ushort *puVar9;
  int iVar10;
  int iVar11;
  int local_38;
  int local_34;
  int local_30;
  int local_2c;
  
  iVar6 = in_EAX[2];
  iVar1 = in_EAX[4];
  iVar4 = *in_EAX;
  iVar11 = 0;
  local_34 = 0;
  local_30 = 0;
  local_2c = 0;
  if (iVar4 <= in_EAX[1]) {
    local_38 = iVar4 * 8 + 4;
    do {
      if (iVar6 <= in_EAX[3]) {
        puVar8 = (ushort *)
                 (*(int *)(*(int *)(*(int *)(param_1 + 0x1a8) + 0x18) + iVar4 * 4) +
                 (iVar6 * 0x20 + iVar1) * 2);
        iVar2 = (in_EAX[3] - iVar6) + 1;
        iVar10 = iVar6 * 4 + 2;
        do {
          if (iVar1 <= in_EAX[5]) {
            iVar5 = iVar1 * 8 + 4;
            iVar7 = (in_EAX[5] - iVar1) + 1;
            puVar9 = puVar8;
            do {
              uVar3 = (uint)*puVar9;
              puVar9 = puVar9 + 1;
              if (uVar3 != 0) {
                local_34 = local_34 + local_38 * uVar3;
                local_30 = local_30 + iVar10 * uVar3;
                iVar11 = iVar11 + uVar3;
                local_2c = local_2c + iVar5 * uVar3;
              }
              iVar5 = iVar5 + 8;
              iVar7 = iVar7 + -1;
            } while (iVar7 != 0);
          }
          puVar8 = puVar8 + 0x20;
          iVar10 = iVar10 + 4;
          iVar2 = iVar2 + -1;
        } while (iVar2 != 0);
      }
      local_38 = local_38 + 8;
      iVar4 = iVar4 + 1;
    } while (iVar4 <= in_EAX[1]);
  }
  iVar6 = iVar11 >> 1;
  *(char *)(param_2 + **(int **)(param_1 + 0x74)) = (char)((iVar6 + local_34) / iVar11);
  *(char *)(param_2 + *(int *)(*(int *)(param_1 + 0x74) + 4)) = (char)((local_30 + iVar6) / iVar11);
  *(char *)(param_2 + *(int *)(*(int *)(param_1 + 0x74) + 8)) = (char)((local_2c + iVar6) / iVar11);
  return;
}



============================================================
DISASSEMBLY
============================================================
006e1950 : SUB ESP,0x38
006e1953 : PUSH EBX
006e1954 : MOV EBX,dword ptr [EAX + 0xc]
006e1957 : PUSH EBP
006e1958 : MOV EBP,dword ptr [EAX + 0x14]
006e195b : PUSH ESI
006e195c : MOV ESI,dword ptr [ESP + 0x48]
006e1960 : MOV ECX,dword ptr [ESI + 0x1a8]
006e1966 : MOV EDX,dword ptr [ECX + 0x18]
006e1969 : MOV ECX,dword ptr [EAX + 0x8]
006e196c : MOV dword ptr [ESP + 0x30],EDX
006e1970 : MOV EDX,dword ptr [EAX + 0x4]
006e1973 : MOV dword ptr [ESP + 0x1c],EBX
006e1977 : MOV EBX,dword ptr [EAX + 0x10]
006e197a : MOV EAX,dword ptr [EAX]
006e197c : PUSH EDI
006e197d : XOR EDI,EDI
006e197f : CMP EAX,EDX
006e1981 : MOV dword ptr [ESP + 0x14],EDI
006e1985 : MOV dword ptr [ESP + 0x18],EDI
006e1989 : MOV dword ptr [ESP + 0x1c],EDI
006e198d : MOV dword ptr [ESP + 0x44],EDX
006e1991 : MOV dword ptr [ESP + 0x40],ECX
006e1995 : MOV dword ptr [ESP + 0x38],EBX
006e1999 : MOV dword ptr [ESP + 0x24],EBP
006e199d : MOV dword ptr [ESP + 0x30],EAX
006e19a1 : JG 0x006e1a7b
006e19a7 : LEA EBP,[EAX*0x8 + 0x4]
006e19ae : MOV dword ptr [ESP + 0x10],EBP
006e19b2 : CMP ECX,dword ptr [ESP + 0x20]
006e19b6 : JG 0x006e1a69
006e19bc : MOV EBP,dword ptr [ESP + 0x34]
006e19c0 : MOV EAX,dword ptr [EBP + EAX*0x4]
006e19c4 : MOV EDX,ECX
006e19c6 : SHL EDX,0x5
006e19c9 : ADD EDX,EBX
006e19cb : LEA EBP,[EAX + EDX*0x2]
006e19ce : MOV EAX,dword ptr [ESP + 0x20]
006e19d2 : MOV EDX,dword ptr [ESP + 0x24]
006e19d6 : SUB EAX,ECX
006e19d8 : INC EAX
006e19d9 : LEA ESI,[ECX*0x4 + 0x2]
006e19e0 : MOV dword ptr [ESP + 0x28],EBP
006e19e4 : MOV dword ptr [ESP + 0x2c],EAX
006e19e8 : CMP EBX,EDX
006e19ea : JG 0x006e1a46
006e19ec : SUB EDX,EBX
006e19ee : LEA ECX,[EBX*0x8 + 0x4]
006e19f5 : INC EDX
006e19f6 : JMP 0x006e1a00
006e1a00 : MOVZX EAX,word ptr [EBP]
006e1a04 : ADD EBP,0x2
006e1a07 : MOV dword ptr [ESP + 0x3c],EBP
006e1a0b : TEST EAX,EAX
006e1a0d : JZ 0x006e1a32
006e1a0f : MOV EBX,dword ptr [ESP + 0x10]
006e1a13 : IMUL EBX,EAX
006e1a16 : ADD dword ptr [ESP + 0x14],EBX
006e1a1a : MOV EBX,ESI
006e1a1c : IMUL EBX,EAX
006e1a1f : ADD dword ptr [ESP + 0x18],EBX
006e1a23 : MOV EBX,ECX
006e1a25 : IMUL EBX,EAX
006e1a28 : ADD EDI,EAX
006e1a2a : ADD dword ptr [ESP + 0x1c],EBX
006e1a2e : MOV EBX,dword ptr [ESP + 0x38]
006e1a32 : ADD ECX,0x8
006e1a35 : SUB EDX,0x1
006e1a38 : JNZ 0x006e1a00
006e1a3a : MOV ECX,dword ptr [ESP + 0x40]
006e1a3e : MOV EDX,dword ptr [ESP + 0x24]
006e1a42 : MOV EAX,dword ptr [ESP + 0x2c]
006e1a46 : MOV EBP,dword ptr [ESP + 0x28]
006e1a4a : ADD EBP,0x40
006e1a4d : ADD ESI,0x4
006e1a50 : SUB EAX,0x1
006e1a53 : MOV dword ptr [ESP + 0x28],EBP
006e1a57 : MOV dword ptr [ESP + 0x2c],EAX
006e1a5b : JNZ 0x006e19e8
006e1a5d : MOV ESI,dword ptr [ESP + 0x4c]
006e1a61 : MOV EDX,dword ptr [ESP + 0x44]
006e1a65 : MOV EAX,dword ptr [ESP + 0x30]
006e1a69 : ADD dword ptr [ESP + 0x10],0x8
006e1a6e : INC EAX
006e1a6f : CMP EAX,EDX
006e1a71 : MOV dword ptr [ESP + 0x30],EAX
006e1a75 : JLE 0x006e19b2
006e1a7b : MOV EDX,dword ptr [ESP + 0x14]
006e1a7f : MOV ECX,EDI
006e1a81 : SAR ECX,0x1
006e1a83 : LEA EAX,[ECX + EDX*0x1]
006e1a86 : CDQ
006e1a87 : IDIV EDI
006e1a89 : MOV EDX,dword ptr [ESI + 0x74]
006e1a8c : MOV EDX,dword ptr [EDX]
006e1a8e : MOV EBX,dword ptr [ESP + 0x50]
006e1a92 : MOV byte ptr [EBX + EDX*0x1],AL
006e1a95 : MOV EAX,dword ptr [ESP + 0x18]
006e1a99 : ADD EAX,ECX
006e1a9b : CDQ
006e1a9c : IDIV EDI
006e1a9e : MOV EDX,dword ptr [ESI + 0x74]
006e1aa1 : MOV EDX,dword ptr [EDX + 0x4]
006e1aa4 : MOV byte ptr [EBX + EDX*0x1],AL
006e1aa7 : MOV EAX,dword ptr [ESP + 0x1c]
006e1aab : ADD EAX,ECX
006e1aad : CDQ
006e1aae : IDIV EDI
006e1ab0 : MOV ECX,dword ptr [ESI + 0x74]
006e1ab3 : MOV EDX,dword ptr [ECX + 0x8]
006e1ab6 : POP EDI
006e1ab7 : POP ESI
006e1ab8 : POP EBP
006e1ab9 : MOV byte ptr [EBX + EDX*0x1],AL
006e1abc : POP EBX
006e1abd : ADD ESP,0x38
006e1ac0 : RET

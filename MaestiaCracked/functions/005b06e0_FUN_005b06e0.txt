PROGRAM  : Maestia.exe
FUNCTION : FUN_005b06e0
ENTRY    : 005b06e0
BODY     : [[005b06e0, 005b07db]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005b06e0(undefined4 *param_1)

{
  byte *pbVar1;
  bool bVar2;
  int iVar3;
  int in_ECX;
  uint uVar4;
  int iVar5;
  char *pcVar6;
  uint uVar7;
  char *local_10;
  uint local_c;
  undefined4 *local_8;
  char **local_4;
  
  pcVar6 = (char *)*param_1;
  bVar2 = false;
  uVar7 = param_1[1];
  param_1 = (undefined4 *)0x0;
  do {
    local_c = 0;
    if (uVar7 != 0) {
      do {
        if ((pcVar6[local_c] == '\0') || (pcVar6[local_c] == ':')) break;
        local_c = local_c + 1;
      } while (local_c < uVar7);
    }
    uVar4 = local_c + 1;
    if (uVar7 < local_c + 1) {
      uVar4 = uVar7;
    }
    uVar7 = uVar7 - uVar4;
    local_10 = pcVar6;
    if (bVar2) {
      local_8 = &param_1;
      local_4 = &local_10;
      iVar5 = 0x1505;
      iVar3 = 4;
      do {
        pbVar1 = &stack0x00000003 + iVar3;
        iVar3 = iVar3 + -1;
        iVar5 = iVar5 * 0x1003f + (uint)*pbVar1;
      } while (iVar3 != 0);
      FUN_005b0590(in_ECX + 0x10,&local_8,iVar5);
      bVar2 = false;
    }
    else {
      if ((local_c == 0) || (pcVar6 == (char *)0x0)) {
LAB_005b07c1:
        *(char **)(in_ECX + 0x1c) = local_10;
        *(uint *)(in_ECX + 0x20) = local_c;
        return;
      }
      iVar3 = _isdigit((int)*pcVar6);
      if (iVar3 == 0) goto LAB_005b07c1;
      param_1 = (undefined4 *)FUN_00634f2c(pcVar6);
      bVar2 = true;
    }
    pcVar6 = pcVar6 + uVar4;
    if (uVar7 == 0) {
      return;
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
005b06e0 : SUB ESP,0x14
005b06e3 : MOV EAX,dword ptr [ESP + 0x18]
005b06e7 : PUSH EBP
005b06e8 : MOV EBP,dword ptr [EAX]
005b06ea : PUSH ESI
005b06eb : XOR EDX,EDX
005b06ed : PUSH EDI
005b06ee : MOV EDI,dword ptr [EAX + 0x4]
005b06f1 : MOV dword ptr [ESP + 0xc],ECX
005b06f5 : MOV dword ptr [ESP + 0x10],0x0
005b06fd : MOV dword ptr [ESP + 0x14],0x0
005b0705 : MOV dword ptr [ESP + 0x24],EDX
005b0709 : LEA ESP,[ESP]
005b0710 : XOR EAX,EAX
005b0712 : TEST EDI,EDI
005b0714 : JBE 0x005b0727
005b0716 : MOV CL,byte ptr [EAX + EBP*0x1]
005b0719 : TEST CL,CL
005b071b : JZ 0x005b0727
005b071d : CMP CL,0x3a
005b0720 : JZ 0x005b0727
005b0722 : INC EAX
005b0723 : CMP EAX,EDI
005b0725 : JC 0x005b0716
005b0727 : LEA ECX,[EAX + 0x1]
005b072a : MOV ESI,EBP
005b072c : MOV dword ptr [ESP + 0x10],ESI
005b0730 : MOV dword ptr [ESP + 0x14],EAX
005b0734 : CMP EDI,ECX
005b0736 : JNC 0x005b073a
005b0738 : MOV ECX,EDI
005b073a : ADD EBP,ECX
005b073c : SUB EDI,ECX
005b073e : TEST EDX,EDX
005b0740 : JNZ 0x005b076e
005b0742 : TEST EAX,EAX
005b0744 : JZ 0x005b07c1
005b0746 : TEST ESI,ESI
005b0748 : JZ 0x005b07c1
005b074a : MOVSX EAX,byte ptr [ESI]
005b074d : PUSH EAX
005b074e : CALL 0x006397a2
005b0753 : ADD ESP,0x4
005b0756 : TEST EAX,EAX
005b0758 : JZ 0x005b07c1
005b075a : PUSH ESI
005b075b : CALL 0x00634f2c
005b0760 : ADD ESP,0x4
005b0763 : MOV dword ptr [ESP + 0x24],EAX
005b0767 : MOV EDX,0x1
005b076c : JMP 0x005b07b0
005b076e : MOV ECX,dword ptr [ESP + 0xc]
005b0772 : LEA EDX,[ESP + 0x24]
005b0776 : LEA EAX,[ESP + 0x10]
005b077a : MOV dword ptr [ESP + 0x18],EDX
005b077e : MOV dword ptr [ESP + 0x1c],EAX
005b0782 : ADD ECX,0x10
005b0785 : MOV EDX,0x1505
005b078a : MOV EAX,0x4
005b078f : NOP
005b0790 : MOVZX ESI,byte ptr [ESP + EAX*0x1 + 0x23]
005b0795 : IMUL EDX,EDX,0x1003f
005b079b : DEC EAX
005b079c : ADD EDX,ESI
005b079e : TEST EAX,EAX
005b07a0 : JA 0x005b0790
005b07a2 : PUSH EDX
005b07a3 : LEA EDX,[ESP + 0x1c]
005b07a7 : PUSH EDX
005b07a8 : PUSH ECX
005b07a9 : CALL 0x005b0590
005b07ae : XOR EDX,EDX
005b07b0 : TEST EDI,EDI
005b07b2 : JNZ 0x005b0710
005b07b8 : POP EDI
005b07b9 : POP ESI
005b07ba : POP EBP
005b07bb : ADD ESP,0x14
005b07be : RET 0x4
005b07c1 : MOV EAX,dword ptr [ESP + 0xc]
005b07c5 : MOV ECX,dword ptr [ESP + 0x10]
005b07c9 : MOV EDX,dword ptr [ESP + 0x14]
005b07cd : POP EDI
005b07ce : POP ESI
005b07cf : MOV dword ptr [EAX + 0x1c],ECX
005b07d2 : MOV dword ptr [EAX + 0x20],EDX
005b07d5 : POP EBP
005b07d6 : ADD ESP,0x14
005b07d9 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_006cf140
ENTRY    : 006cf140
BODY     : [[006cf140, 006cf226]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_006cf140(int param_1,uint param_2)

{
  uint uVar1;
  int iVar2;
  undefined4 uVar3;
  uint local_8;
  
  uVar1 = *(uint *)(param_1 + 0xb0);
  for (local_8 = param_2; uVar1 < local_8; local_8 = local_8 - uVar1) {
    FUN_006cf100(param_1,*(undefined4 *)(param_1 + 0xac),*(undefined4 *)(param_1 + 0xb0));
  }
  if (local_8 != 0) {
    FUN_006cf100(param_1,*(undefined4 *)(param_1 + 0xac),local_8);
  }
  iVar2 = FUN_006cf230(param_1);
  if (iVar2 == 0) {
    uVar3 = 0;
  }
  else {
    if ((((*(byte *)(param_1 + 0x11c) & 0x20) == 0) || ((*(uint *)(param_1 + 0x6c) & 0x200) != 0))
       && (((*(byte *)(param_1 + 0x11c) & 0x20) != 0 || ((*(uint *)(param_1 + 0x6c) & 0x400) == 0)))
       ) {
      FUN_006c2560(param_1,"CRC error");
    }
    else {
      FUN_006c26f0(param_1,"CRC error");
    }
    uVar3 = 1;
  }
  return uVar3;
}



============================================================
DISASSEMBLY
============================================================
006cf140 : PUSH EBP
006cf141 : MOV EBP,ESP
006cf143 : SUB ESP,0x8
006cf146 : MOV EAX,dword ptr [EBP + 0x8]
006cf149 : MOV ECX,dword ptr [EAX + 0xb0]
006cf14f : MOV dword ptr [EBP + -0x8],ECX
006cf152 : MOV EDX,dword ptr [EBP + 0xc]
006cf155 : MOV dword ptr [EBP + -0x4],EDX
006cf158 : JMP 0x006cf163
006cf15a : MOV EAX,dword ptr [EBP + -0x4]
006cf15d : SUB EAX,dword ptr [EBP + -0x8]
006cf160 : MOV dword ptr [EBP + -0x4],EAX
006cf163 : MOV ECX,dword ptr [EBP + -0x4]
006cf166 : CMP ECX,dword ptr [EBP + -0x8]
006cf169 : JBE 0x006cf18d
006cf16b : MOV EDX,dword ptr [EBP + 0x8]
006cf16e : MOV EAX,dword ptr [EDX + 0xb0]
006cf174 : PUSH EAX
006cf175 : MOV ECX,dword ptr [EBP + 0x8]
006cf178 : MOV EDX,dword ptr [ECX + 0xac]
006cf17e : PUSH EDX
006cf17f : MOV EAX,dword ptr [EBP + 0x8]
006cf182 : PUSH EAX
006cf183 : CALL 0x006cf100
006cf188 : ADD ESP,0xc
006cf18b : JMP 0x006cf15a
006cf18d : CMP dword ptr [EBP + -0x4],0x0
006cf191 : JZ 0x006cf1ad
006cf193 : MOV ECX,dword ptr [EBP + -0x4]
006cf196 : PUSH ECX
006cf197 : MOV EDX,dword ptr [EBP + 0x8]
006cf19a : MOV EAX,dword ptr [EDX + 0xac]
006cf1a0 : PUSH EAX
006cf1a1 : MOV ECX,dword ptr [EBP + 0x8]
006cf1a4 : PUSH ECX
006cf1a5 : CALL 0x006cf100
006cf1aa : ADD ESP,0xc
006cf1ad : MOV EDX,dword ptr [EBP + 0x8]
006cf1b0 : PUSH EDX
006cf1b1 : CALL 0x006cf230
006cf1b6 : ADD ESP,0x4
006cf1b9 : TEST EAX,EAX
006cf1bb : JZ 0x006cf221
006cf1bd : MOV EAX,dword ptr [EBP + 0x8]
006cf1c0 : MOVZX ECX,byte ptr [EAX + 0x11c]
006cf1c7 : AND ECX,0x20
006cf1ca : JZ 0x006cf1d9
006cf1cc : MOV EDX,dword ptr [EBP + 0x8]
006cf1cf : MOV EAX,dword ptr [EDX + 0x6c]
006cf1d2 : AND EAX,0x200
006cf1d7 : JZ 0x006cf1f6
006cf1d9 : MOV ECX,dword ptr [EBP + 0x8]
006cf1dc : MOVZX EDX,byte ptr [ECX + 0x11c]
006cf1e3 : AND EDX,0x20
006cf1e6 : JNZ 0x006cf209
006cf1e8 : MOV EAX,dword ptr [EBP + 0x8]
006cf1eb : MOV ECX,dword ptr [EAX + 0x6c]
006cf1ee : AND ECX,0x400
006cf1f4 : JZ 0x006cf209
006cf1f6 : PUSH 0xbee030
006cf1fb : MOV EDX,dword ptr [EBP + 0x8]
006cf1fe : PUSH EDX
006cf1ff : CALL 0x006c26f0
006cf204 : ADD ESP,0x8
006cf207 : JMP 0x006cf21a
006cf209 : PUSH 0xbee030
006cf20e : MOV EAX,dword ptr [EBP + 0x8]
006cf211 : PUSH EAX
006cf212 : CALL 0x006c2560
006cf217 : ADD ESP,0x8
006cf21a : MOV EAX,0x1
006cf21f : JMP 0x006cf223
006cf221 : XOR EAX,EAX
006cf223 : MOV ESP,EBP
006cf225 : POP EBP
006cf226 : RET

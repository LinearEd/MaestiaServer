PROGRAM  : Maestia.exe
FUNCTION : FUN_007ff990
ENTRY    : 007ff990
BODY     : [[007ff990, 007ffc01]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007ff990(void)

{
  int *piVar1;
  int iVar2;
  char cVar3;
  uint uVar4;
  int in_ECX;
  LPCRITICAL_SECTION local_28;
  char *local_24;
  undefined4 local_20;
  int local_1c;
  undefined4 local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3cc5c;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_28 = (LPCRITICAL_SECTION)(DAT_017251ac + 0x424);
  local_1c = 0;
  local_24 = ".\\Render\\AvaRender.cpp";
  local_20 = 0x674;
  local_18 = 1;
  FUN_006ef1a0(&local_28);
  local_8 = 0;
  FUN_008018d0(L"[AvaRender::ReleaseRef] Start",uVar4);
  piVar1 = *(int **)(in_ECX + 0x26c);
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 0x40))(piVar1);
  }
  piVar1 = *(int **)(in_ECX + 0x268);
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 0x40))(piVar1);
  }
  piVar1 = *(int **)(in_ECX + 0x264);
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 0x40))(piVar1);
  }
  piVar1 = *(int **)(in_ECX + 0x270);
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 0x40))(piVar1);
  }
  if (DAT_017251d0 != 0) {
    FUN_007cb3d0();
  }
  if (*(int *)(in_ECX + 0x198) != 0) {
    FUN_007ceae0();
  }
  piVar1 = *(int **)(in_ECX + 0x378);
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
    *(undefined4 *)(in_ECX + 0x378) = 0;
  }
  piVar1 = *(int **)(in_ECX + 0x37c);
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
    *(undefined4 *)(in_ECX + 0x37c) = 0;
  }
  piVar1 = *(int **)(in_ECX + 0x380);
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
    *(undefined4 *)(in_ECX + 0x380) = 0;
  }
  piVar1 = *(int **)(in_ECX + 0x43c);
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
    *(undefined4 *)(in_ECX + 0x43c) = 0;
  }
  FUN_00787200();
  if (DAT_01725204 != 0) {
    FUN_007c05e0(DAT_01725204);
  }
  if (*(int **)(in_ECX + 0x4a4) != (int *)0x0) {
    cVar3 = (**(code **)(**(int **)(in_ECX + 0x4a4) + 0x90))();
    if (cVar3 == '\0') {
      FUN_008018d0(L"GFX Doesn\'t Reset Video Mode\n");
    }
  }
  if ((*(int *)(in_ECX + 0x1a4) != 0) && (*(int *)(*(int *)(in_ECX + 0x1a4) + 0x110) != 0)) {
    FUN_007c8a20();
  }
  FUN_007cf090(*(undefined4 *)(in_ECX + 0x188));
  FUN_007c80d0(*(undefined4 *)(in_ECX + 0x18c));
  FUN_007f0280(*(undefined4 *)(in_ECX + 400));
  FUN_007c4bc0(*(undefined4 *)(in_ECX + 0x194));
  local_14 = **(int **)(in_ECX + 0xc);
  if ((int *)local_14 != *(int **)(in_ECX + 0xc)) {
    do {
      if (*(int **)(local_14 + 0x28) != (int *)0x0) {
        (**(code **)(**(int **)(local_14 + 0x28) + 0x1c))();
      }
      FUN_00430160();
    } while (local_14 != *(int *)(in_ECX + 0xc));
  }
  iVar2 = *(int *)(*(int *)(in_ECX + 0x1a4) + 0x104);
  if (iVar2 != 0) {
    *(undefined1 *)(iVar2 + 0xa9ba) = 0;
    FUN_006ed250();
    FUN_006ed250();
    FUN_006ed250();
    FUN_006ed250();
  }
  FUN_008018d0(L"[AvaRender::ReleaseRef] End");
  local_8 = 0xffffffff;
  if (local_1c != 0) {
    LeaveCriticalSection(local_28);
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
007ff990 : PUSH EBP
007ff991 : MOV EBP,ESP
007ff993 : PUSH -0x1
007ff995 : PUSH 0xb3cc5c
007ff99a : MOV EAX,FS:[0x0]
007ff9a0 : PUSH EAX
007ff9a1 : SUB ESP,0x18
007ff9a4 : PUSH EBX
007ff9a5 : PUSH ESI
007ff9a6 : PUSH EDI
007ff9a7 : MOV EAX,[0x00d66fa0]
007ff9ac : XOR EAX,EBP
007ff9ae : PUSH EAX
007ff9af : LEA EAX,[EBP + -0xc]
007ff9b2 : MOV FS:[0x0],EAX
007ff9b8 : MOV EDI,ECX
007ff9ba : MOV EAX,[0x017251ac]
007ff9bf : LEA ECX,[EBP + -0x24]
007ff9c2 : ADD EAX,0x424
007ff9c7 : XOR EBX,EBX
007ff9c9 : PUSH ECX
007ff9ca : MOV dword ptr [EBP + -0x18],EBX
007ff9cd : MOV dword ptr [EBP + -0x24],EAX
007ff9d0 : MOV dword ptr [EBP + -0x20],0xc27e94
007ff9d7 : MOV dword ptr [EBP + -0x1c],0x674
007ff9de : MOV dword ptr [EBP + -0x14],0x1
007ff9e5 : CALL 0x006ef1a0
007ff9ea : MOV dword ptr [EBP + -0x4],EBX
007ff9ed : MOV ESI,dword ptr [0x00da98e8]
007ff9f3 : PUSH 0xc27a4c
007ff9f8 : CALL 0x008018d0
007ff9fd : MOV EAX,dword ptr [EDI + 0x26c]
007ffa03 : ADD ESP,0x4
007ffa06 : CMP EAX,EBX
007ffa08 : JZ 0x007ffa12
007ffa0a : MOV EDX,dword ptr [EAX]
007ffa0c : PUSH EAX
007ffa0d : MOV EAX,dword ptr [EDX + 0x40]
007ffa10 : CALL EAX
007ffa12 : MOV EAX,dword ptr [EDI + 0x268]
007ffa18 : CMP EAX,EBX
007ffa1a : JZ 0x007ffa24
007ffa1c : MOV ECX,dword ptr [EAX]
007ffa1e : MOV EDX,dword ptr [ECX + 0x40]
007ffa21 : PUSH EAX
007ffa22 : CALL EDX
007ffa24 : MOV EAX,dword ptr [EDI + 0x264]
007ffa2a : CMP EAX,EBX
007ffa2c : JZ 0x007ffa36
007ffa2e : MOV ECX,dword ptr [EAX]
007ffa30 : MOV EDX,dword ptr [ECX + 0x40]
007ffa33 : PUSH EAX
007ffa34 : CALL EDX
007ffa36 : MOV EAX,dword ptr [EDI + 0x270]
007ffa3c : CMP EAX,EBX
007ffa3e : JZ 0x007ffa48
007ffa40 : MOV ECX,dword ptr [EAX]
007ffa42 : MOV EDX,dword ptr [ECX + 0x40]
007ffa45 : PUSH EAX
007ffa46 : CALL EDX
007ffa48 : MOV ECX,dword ptr [0x017251d0]
007ffa4e : CMP ECX,EBX
007ffa50 : JZ 0x007ffa57
007ffa52 : CALL 0x007cb3d0
007ffa57 : MOV EAX,dword ptr [EDI + 0x198]
007ffa5d : CMP EAX,EBX
007ffa5f : JZ 0x007ffa66
007ffa61 : CALL 0x007ceae0
007ffa66 : MOV EAX,dword ptr [EDI + 0x378]
007ffa6c : CMP EAX,EBX
007ffa6e : JZ 0x007ffa7e
007ffa70 : MOV ECX,dword ptr [EAX]
007ffa72 : MOV EDX,dword ptr [ECX + 0x8]
007ffa75 : PUSH EAX
007ffa76 : CALL EDX
007ffa78 : MOV dword ptr [EDI + 0x378],EBX
007ffa7e : MOV EAX,dword ptr [EDI + 0x37c]
007ffa84 : CMP EAX,EBX
007ffa86 : JZ 0x007ffa96
007ffa88 : MOV ECX,dword ptr [EAX]
007ffa8a : MOV EDX,dword ptr [ECX + 0x8]
007ffa8d : PUSH EAX
007ffa8e : CALL EDX
007ffa90 : MOV dword ptr [EDI + 0x37c],EBX
007ffa96 : MOV EAX,dword ptr [EDI + 0x380]
007ffa9c : CMP EAX,EBX
007ffa9e : JZ 0x007ffaae
007ffaa0 : MOV ECX,dword ptr [EAX]
007ffaa2 : MOV EDX,dword ptr [ECX + 0x8]
007ffaa5 : PUSH EAX
007ffaa6 : CALL EDX
007ffaa8 : MOV dword ptr [EDI + 0x380],EBX
007ffaae : MOV EAX,dword ptr [EDI + 0x43c]
007ffab4 : CMP EAX,EBX
007ffab6 : JZ 0x007ffac6
007ffab8 : MOV ECX,dword ptr [EAX]
007ffaba : MOV EDX,dword ptr [ECX + 0x8]
007ffabd : PUSH EAX
007ffabe : CALL EDX
007ffac0 : MOV dword ptr [EDI + 0x43c],EBX
007ffac6 : MOV EAX,[0x0172523c]
007ffacb : CALL 0x00787200
007ffad0 : MOV EAX,[0x01725204]
007ffad5 : CMP EAX,EBX
007ffad7 : JZ 0x007ffadf
007ffad9 : PUSH EAX
007ffada : CALL 0x007c05e0
007ffadf : MOV ECX,dword ptr [EDI + 0x4a4]
007ffae5 : CMP ECX,EBX
007ffae7 : JZ 0x007ffb0a
007ffae9 : MOV EAX,dword ptr [ECX]
007ffaeb : MOV EDX,dword ptr [EAX + 0x90]
007ffaf1 : CALL EDX
007ffaf3 : TEST AL,AL
007ffaf5 : JNZ 0x007ffb0a
007ffaf7 : MOV ESI,dword ptr [0x00da98e8]
007ffafd : PUSH 0xc27c7c
007ffb02 : CALL 0x008018d0
007ffb07 : ADD ESP,0x4
007ffb0a : MOV EAX,dword ptr [EDI + 0x1a4]
007ffb10 : CMP EAX,EBX
007ffb12 : JZ 0x007ffb23
007ffb14 : MOV EAX,dword ptr [EAX + 0x110]
007ffb1a : CMP EAX,EBX
007ffb1c : JZ 0x007ffb23
007ffb1e : CALL 0x007c8a20
007ffb23 : MOV EAX,dword ptr [EDI + 0x188]
007ffb29 : PUSH EAX
007ffb2a : CALL 0x007cf090
007ffb2f : MOV ECX,dword ptr [EDI + 0x18c]
007ffb35 : PUSH ECX
007ffb36 : CALL 0x007c80d0
007ffb3b : MOV EDX,dword ptr [EDI + 0x190]
007ffb41 : PUSH EDX
007ffb42 : CALL 0x007f0280
007ffb47 : MOV EAX,dword ptr [EDI + 0x194]
007ffb4d : PUSH EAX
007ffb4e : CALL 0x007c4bc0
007ffb53 : MOV ECX,dword ptr [EDI + 0xc]
007ffb56 : MOV EAX,dword ptr [ECX]
007ffb58 : MOV dword ptr [EBP + -0x10],EAX
007ffb5b : CMP EAX,ECX
007ffb5d : JZ 0x007ffb82
007ffb5f : NOP
007ffb60 : MOV EAX,dword ptr [EAX + 0x28]
007ffb63 : CMP EAX,EBX
007ffb65 : JZ 0x007ffb70
007ffb67 : MOV EDX,dword ptr [EAX]
007ffb69 : MOV ECX,EAX
007ffb6b : MOV EAX,dword ptr [EDX + 0x1c]
007ffb6e : CALL EAX
007ffb70 : LEA EDX,[EBP + -0x10]
007ffb73 : CALL 0x00430160
007ffb78 : MOV ECX,dword ptr [EDI + 0xc]
007ffb7b : MOV EAX,dword ptr [EBP + -0x10]
007ffb7e : CMP EAX,ECX
007ffb80 : JNZ 0x007ffb60
007ffb82 : MOV ECX,dword ptr [EDI + 0x1a4]
007ffb88 : MOV EDI,dword ptr [ECX + 0x104]
007ffb8e : CMP EDI,EBX
007ffb90 : JZ 0x007ffbc4
007ffb92 : LEA ESI,[EDI + 0x5c44]
007ffb98 : MOV byte ptr [EDI + 0xa9ba],BL
007ffb9e : CALL 0x006ed250
007ffba3 : LEA ESI,[EDI + 0x5c80]
007ffba9 : CALL 0x006ed250
007ffbae : LEA ESI,[EDI + 0x5cbc]
007ffbb4 : CALL 0x006ed250
007ffbb9 : LEA ESI,[EDI + 0x5cf8]
007ffbbf : CALL 0x006ed250
007ffbc4 : MOV ESI,dword ptr [0x00da98e8]
007ffbca : PUSH 0xc27eac
007ffbcf : CALL 0x008018d0
007ffbd4 : ADD ESP,0x4
007ffbd7 : MOV dword ptr [EBP + -0x4],0xffffffff
007ffbde : CMP dword ptr [EBP + -0x18],EBX
007ffbe1 : JZ 0x007ffbf0
007ffbe3 : MOV EDX,dword ptr [EBP + -0x24]
007ffbe6 : PUSH EDX
007ffbe7 : CALL dword ptr [0x00b8511c]
007ffbed : MOV dword ptr [EBP + -0x18],EBX
007ffbf0 : MOV ECX,dword ptr [EBP + -0xc]
007ffbf3 : MOV dword ptr FS:[0x0],ECX
007ffbfa : POP ECX
007ffbfb : POP EDI
007ffbfc : POP ESI
007ffbfd : POP EBX
007ffbfe : MOV ESP,EBP
007ffc00 : POP EBP
007ffc01 : RET

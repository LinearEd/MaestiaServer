PROGRAM  : Maestia.exe
FUNCTION : FUN_0081bb70
ENTRY    : 0081bb70
BODY     : [[0081bb70, 0081bbab]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_0081bb70(char param_1)

{
  short *psVar1;
  undefined2 uVar2;
  int in_ECX;
  short in_DX;
  
  psVar1 = *(short **)(in_ECX + 0x3b4);
  while( true ) {
    if (psVar1 == *(short **)(in_ECX + 0x3b8)) {
      return 0;
    }
    if (*psVar1 == in_DX) break;
    psVar1 = psVar1 + 3;
  }
  uVar2 = (undefined2)((uint)psVar1 >> 0x10);
  if (param_1 == '\0') {
    return CONCAT22(uVar2,psVar1[1]);
  }
  return CONCAT22(uVar2,(ushort)*(byte *)(psVar1 + 2));
}



============================================================
DISASSEMBLY
============================================================
0081bb70 : PUSH EBP
0081bb71 : MOV EBP,ESP
0081bb73 : MOV EAX,dword ptr [ECX + 0x3b4]
0081bb79 : MOV ECX,dword ptr [ECX + 0x3b8]
0081bb7f : CMP EAX,ECX
0081bb81 : JZ 0x0081bb8f
0081bb83 : CMP word ptr [EAX],DX
0081bb86 : JZ 0x0081bb95
0081bb88 : ADD EAX,0x6
0081bb8b : CMP EAX,ECX
0081bb8d : JNZ 0x0081bb83
0081bb8f : XOR EAX,EAX
0081bb91 : POP EBP
0081bb92 : RET 0x4
0081bb95 : CMP byte ptr [EBP + 0x8],0x0
0081bb99 : JZ 0x0081bba4
0081bb9b : MOVZX AX,byte ptr [EAX + 0x4]
0081bba0 : POP EBP
0081bba1 : RET 0x4
0081bba4 : MOV AX,word ptr [EAX + 0x2]
0081bba8 : POP EBP
0081bba9 : RET 0x4

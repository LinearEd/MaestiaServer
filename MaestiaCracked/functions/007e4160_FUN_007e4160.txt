PROGRAM  : Maestia.exe
FUNCTION : FUN_007e4160
ENTRY    : 007e4160
BODY     : [[007e4160, 007e4410]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007e4160(undefined4 param_1)

{
  char cVar1;
  int *piVar2;
  code *pcVar3;
  int iVar4;
  int *unaff_EDI;
  undefined4 uVar5;
  int local_c80 [5];
  int local_c6c;
  int local_c68;
  undefined4 local_c64;
  wchar_t local_c60 [256];
  wchar_t local_a60 [256];
  wchar_t local_860 [256];
  wchar_t local_660 [256];
  wchar_t local_460 [256];
  int local_260;
  int local_25c;
  int local_258 [4];
  int local_248;
  int local_244 [2];
  int local_23c;
  int local_238 [5];
  int local_224 [5];
  wchar_t local_210 [258];
  uint local_c;
  
  local_c = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_c80[4] = param_1;
LAB_007e4180:
  do {
    if (((uint)unaff_EDI[8] <= (uint)unaff_EDI[9]) ||
       (cVar1 = (**(code **)(*unaff_EDI + 0x1c))(&local_c68), cVar1 == '\0')) {
LAB_007e43ff:
      __security_check_cookie(local_c ^ (uint)&stack0xfffffffc);
      return;
    }
    if (local_c68 == 0x3018) {
      iVar4 = 0;
      local_c6c = 0;
      FUN_0045f2f0();
      piVar2 = &local_c6c;
LAB_007e41e7:
      uVar5 = 4;
LAB_007e41eb:
      pcVar3 = *(code **)(*unaff_EDI + 0xc);
LAB_007e41f1:
      (*pcVar3)(piVar2,uVar5,1);
switchD_007e423c_caseD_3019:
      if ((((uint)unaff_EDI[8] <= (uint)unaff_EDI[9]) || (local_c6c <= iVar4)) ||
         (cVar1 = (**(code **)(*unaff_EDI + 0x1c))(&local_c68), cVar1 == '\0')) goto LAB_007e4180;
      switch(local_c68) {
      case 0x3019:
        goto switchD_007e423c_caseD_3019;
      default:
        (**(code **)(*unaff_EDI + 0x24))(local_c64);
        goto switchD_007e423c_caseD_3019;
      case 0x3020:
        FUN_0070d320(local_210);
        _wcscpy_s(local_c60,0x100,local_210);
        goto switchD_007e423c_caseD_3019;
      case 0x3021:
        FUN_0070d320(local_210);
        _wcscpy_s(local_a60,0x100,local_210);
        goto switchD_007e423c_caseD_3019;
      case 0x3022:
        FUN_0070d320(local_210);
        _wcscpy_s(local_860,0x100,local_210);
        goto switchD_007e423c_caseD_3019;
      case 0x3023:
        FUN_0070d320(local_210);
        _wcscpy_s(local_660,0x100,local_210);
        goto switchD_007e423c_caseD_3019;
      case 0x3024:
        goto switchD_007e423c_caseD_3024;
      case 0x3025:
        piVar2 = &local_25c;
        goto LAB_007e41e7;
      case 0x3026:
        uVar5 = 0xc;
        piVar2 = local_258;
        goto LAB_007e41eb;
      case 0x3027:
        local_c80[1] = 0;
        local_c80[2] = 0;
        local_c80[3] = 0x3f800000;
        uVar5 = 0x10;
        piVar2 = local_c80;
        goto LAB_007e41eb;
      case 0x3028:
        piVar2 = &local_248;
        goto LAB_007e41e7;
      case 0x3029:
        uVar5 = 8;
        piVar2 = local_244;
        goto LAB_007e41eb;
      case 0x3030:
        piVar2 = &local_23c;
        goto LAB_007e41e7;
      case 0x3031:
        FUN_007e1920(local_c80[4]);
        iVar4 = iVar4 + 1;
        goto switchD_007e423c_caseD_3019;
      case 0x3040:
        piVar2 = local_238;
        goto LAB_007e41e7;
      case 0x3063:
        piVar2 = local_224;
        goto LAB_007e41e7;
      case 0x3064:
        FUN_0070d320(local_210);
        _wcscpy_s(local_460,0x100,local_210);
        goto switchD_007e423c_caseD_3019;
      }
    }
    if (local_c68 == 0x4011) goto LAB_007e43ff;
    (**(code **)(*unaff_EDI + 0x24))(local_c64);
  } while( true );
switchD_007e423c_caseD_3024:
  pcVar3 = *(code **)(*unaff_EDI + 0xc);
  uVar5 = 4;
  piVar2 = &local_260;
  goto LAB_007e41f1;
}



============================================================
DISASSEMBLY
============================================================
007e4160 : PUSH EBP
007e4161 : MOV EBP,ESP
007e4163 : SUB ESP,0xc7c
007e4169 : MOV EAX,[0x00d66fa0]
007e416e : XOR EAX,EBP
007e4170 : MOV dword ptr [EBP + -0x8],EAX
007e4173 : MOV EAX,dword ptr [EBP + 0x8]
007e4176 : PUSH EBX
007e4177 : PUSH ESI
007e4178 : MOV dword ptr [EBP + 0xfffff394],EAX
007e417e : MOV EDI,EDI
007e4180 : MOV ECX,dword ptr [EDI + 0x24]
007e4183 : CMP ECX,dword ptr [EDI + 0x20]
007e4186 : JNC 0x007e43ff
007e418c : MOV EDX,dword ptr [EDI]
007e418e : MOV EDX,dword ptr [EDX + 0x1c]
007e4191 : LEA EAX,[EBP + 0xfffff39c]
007e4197 : PUSH EAX
007e4198 : MOV ECX,EDI
007e419a : CALL EDX
007e419c : TEST AL,AL
007e419e : JZ 0x007e43ff
007e41a4 : MOV EAX,dword ptr [EBP + 0xfffff39c]
007e41aa : CMP EAX,0x3018
007e41af : JZ 0x007e41ce
007e41b1 : CMP EAX,0x4011
007e41b6 : JZ 0x007e43ff
007e41bc : MOV ECX,dword ptr [EBP + 0xfffff3a0]
007e41c2 : MOV EAX,dword ptr [EDI]
007e41c4 : MOV EDX,dword ptr [EAX + 0x24]
007e41c7 : PUSH ECX
007e41c8 : MOV ECX,EDI
007e41ca : CALL EDX
007e41cc : JMP 0x007e4180
007e41ce : XOR EBX,EBX
007e41d0 : LEA ESI,[EBP + 0xfffff3a4]
007e41d6 : MOV dword ptr [EBP + 0xfffff398],EBX
007e41dc : CALL 0x0045f2f0
007e41e1 : LEA ECX,[EBP + 0xfffff398]
007e41e7 : PUSH 0x1
007e41e9 : PUSH 0x4
007e41eb : MOV EAX,dword ptr [EDI]
007e41ed : MOV EDX,dword ptr [EAX + 0xc]
007e41f0 : PUSH ECX
007e41f1 : MOV ECX,EDI
007e41f3 : CALL EDX
007e41f5 : MOV EAX,dword ptr [EDI + 0x24]
007e41f8 : CMP EAX,dword ptr [EDI + 0x20]
007e41fb : JNC 0x007e4180
007e41fd : CMP EBX,dword ptr [EBP + 0xfffff398]
007e4203 : JGE 0x007e4180
007e4209 : MOV EDX,dword ptr [EDI]
007e420b : MOV EDX,dword ptr [EDX + 0x1c]
007e420e : LEA EAX,[EBP + 0xfffff39c]
007e4214 : PUSH EAX
007e4215 : MOV ECX,EDI
007e4217 : CALL EDX
007e4219 : TEST AL,AL
007e421b : JZ 0x007e4180
007e4221 : MOV EAX,dword ptr [EBP + 0xfffff39c]
007e4227 : ADD EAX,0xffffcfe7
007e422c : CMP EAX,0x4b
007e422f : JA 0x007e43ea
007e4235 : MOVZX EAX,byte ptr [EAX + 0x7e4458]
007e423c : JMP dword ptr [EAX*0x4 + 0x7e4414]
007e4243 : LEA ECX,[EBP + 0xfffffdf4]
007e4249 : PUSH ECX
007e424a : MOV ECX,EDI
007e424c : CALL 0x0070d320
007e4251 : LEA EDX,[EBP + 0xfffffdf4]
007e4257 : PUSH EDX
007e4258 : LEA EAX,[EBP + 0xfffff3a4]
007e425e : PUSH 0x100
007e4263 : PUSH EAX
007e4264 : CALL 0x0063481b
007e4269 : ADD ESP,0xc
007e426c : JMP 0x007e41f5
007e426e : LEA ECX,[EBP + 0xfffffdf4]
007e4274 : PUSH ECX
007e4275 : MOV ECX,EDI
007e4277 : CALL 0x0070d320
007e427c : LEA EDX,[EBP + 0xfffffdf4]
007e4282 : PUSH EDX
007e4283 : LEA EAX,[EBP + 0xfffffba4]
007e4289 : PUSH 0x100
007e428e : PUSH EAX
007e428f : CALL 0x0063481b
007e4294 : ADD ESP,0xc
007e4297 : JMP 0x007e41f5
007e429c : LEA ECX,[EBP + 0xfffffdf4]
007e42a2 : PUSH ECX
007e42a3 : MOV ECX,EDI
007e42a5 : CALL 0x0070d320
007e42aa : LEA EDX,[EBP + 0xfffffdf4]
007e42b0 : PUSH EDX
007e42b1 : LEA EAX,[EBP + 0xfffff5a4]
007e42b7 : PUSH 0x100
007e42bc : PUSH EAX
007e42bd : CALL 0x0063481b
007e42c2 : ADD ESP,0xc
007e42c5 : JMP 0x007e41f5
007e42ca : LEA ECX,[EBP + 0xfffffdf4]
007e42d0 : PUSH ECX
007e42d1 : MOV ECX,EDI
007e42d3 : CALL 0x0070d320
007e42d8 : LEA EDX,[EBP + 0xfffffdf4]
007e42de : PUSH EDX
007e42df : LEA EAX,[EBP + 0xfffff7a4]
007e42e5 : PUSH 0x100
007e42ea : PUSH EAX
007e42eb : CALL 0x0063481b
007e42f0 : ADD ESP,0xc
007e42f3 : JMP 0x007e41f5
007e42f8 : LEA ECX,[EBP + 0xfffffdf4]
007e42fe : PUSH ECX
007e42ff : MOV ECX,EDI
007e4301 : CALL 0x0070d320
007e4306 : LEA EDX,[EBP + 0xfffffdf4]
007e430c : PUSH EDX
007e430d : LEA EAX,[EBP + 0xfffff9a4]
007e4313 : PUSH 0x100
007e4318 : PUSH EAX
007e4319 : CALL 0x0063481b
007e431e : ADD ESP,0xc
007e4321 : JMP 0x007e41f5
007e4326 : MOV EDX,dword ptr [EDI]
007e4328 : MOV EDX,dword ptr [EDX + 0xc]
007e432b : PUSH 0x1
007e432d : PUSH 0x4
007e432f : LEA EAX,[EBP + 0xfffffda4]
007e4335 : PUSH EAX
007e4336 : JMP 0x007e41f1
007e433b : LEA ECX,[EBP + 0xfffffda8]
007e4341 : JMP 0x007e41e7
007e4346 : PUSH 0x1
007e4348 : PUSH 0xc
007e434a : LEA ECX,[EBP + 0xfffffdac]
007e4350 : JMP 0x007e41eb
007e4355 : XORPS XMM0,XMM0
007e4358 : MOVSS dword ptr [EBP + 0xfffff388],XMM0
007e4360 : MOVSS dword ptr [EBP + 0xfffff38c],XMM0
007e4368 : MOVSS XMM0,dword ptr [0x00c10fc4]
007e4370 : MOVSS dword ptr [EBP + 0xfffff390],XMM0
007e4378 : MOVSS XMM0,dword ptr [EBP + 0xfffffdb8]
007e4380 : PUSH 0x1
007e4382 : MOVSS dword ptr [EBP + 0xfffff384],XMM0
007e438a : PUSH 0x10
007e438c : LEA ECX,[EBP + 0xfffff384]
007e4392 : JMP 0x007e41eb
007e4397 : LEA ECX,[EBP + 0xfffffdbc]
007e439d : JMP 0x007e41e7
007e43a2 : PUSH 0x1
007e43a4 : PUSH 0x8
007e43a6 : LEA ECX,[EBP + 0xfffffdc0]
007e43ac : JMP 0x007e41eb
007e43b1 : LEA ECX,[EBP + 0xfffffdc8]
007e43b7 : JMP 0x007e41e7
007e43bc : LEA ECX,[EBP + 0xfffffdcc]
007e43c2 : JMP 0x007e41e7
007e43c7 : LEA ECX,[EBP + 0xfffffde0]
007e43cd : JMP 0x007e41e7
007e43d2 : MOV EAX,dword ptr [EBP + 0xfffff394]
007e43d8 : PUSH EAX
007e43d9 : LEA ECX,[EBP + 0xfffff3a4]
007e43df : CALL 0x007e1920
007e43e4 : INC EBX
007e43e5 : JMP 0x007e41f5
007e43ea : MOV EDX,dword ptr [EDI]
007e43ec : MOV EAX,dword ptr [EBP + 0xfffff3a0]
007e43f2 : MOV EDX,dword ptr [EDX + 0x24]
007e43f5 : PUSH EAX
007e43f6 : MOV ECX,EDI
007e43f8 : CALL EDX
007e43fa : JMP 0x007e41f5
007e43ff : MOV ECX,dword ptr [EBP + -0x8]
007e4402 : POP ESI
007e4403 : XOR ECX,EBP
007e4405 : POP EBX
007e4406 : CALL 0x00633e6b
007e440b : MOV ESP,EBP
007e440d : POP EBP
007e440e : RET 0x4

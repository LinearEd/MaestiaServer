PROGRAM  : Maestia.exe
FUNCTION : FUN_0041f590
ENTRY    : 0041f590
BODY     : [[0041f590, 0041f612]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0041f590(wchar_t *param_1)

{
  wchar_t wVar1;
  wchar_t *_DstBuf;
  wchar_t *pwVar2;
  int in_ECX;
  
  _DstBuf = _malloc(0x408);
  if (_DstBuf != (wchar_t *)0x0) {
    _DstBuf[0] = L'\xdddd';
    _DstBuf[1] = L'\0';
    _DstBuf = _DstBuf + 4;
  }
  __vsnwprintf_s(_DstBuf,0x100,0xffffffff,param_1,&stack0x00000008);
  pwVar2 = _DstBuf;
  do {
    wVar1 = *pwVar2;
    pwVar2 = pwVar2 + 1;
  } while (wVar1 != L'\0');
  if ((int)pwVar2 - (int)(_DstBuf + 1) >> 1 <= *(int *)(in_ECX + 4)) {
    _wcscpy_s((wchar_t *)(in_ECX + 8),0x100,_DstBuf);
  }
  if ((_DstBuf != (wchar_t *)0x0) && (*(int *)(_DstBuf + -4) == 0xdddd)) {
    _free(_DstBuf + -4);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
0041f590 : PUSH EBP
0041f591 : MOV EBP,ESP
0041f593 : PUSH ESI
0041f594 : PUSH EDI
0041f595 : PUSH 0x408
0041f59a : MOV EDI,ECX
0041f59c : CALL 0x00636043
0041f5a1 : MOV ESI,EAX
0041f5a3 : ADD ESP,0x4
0041f5a6 : TEST ESI,ESI
0041f5a8 : JZ 0x0041f5b3
0041f5aa : MOV dword ptr [ESI],0xdddd
0041f5b0 : ADD ESI,0x8
0041f5b3 : MOV ECX,dword ptr [EBP + 0x8]
0041f5b6 : LEA EAX,[EBP + 0xc]
0041f5b9 : PUSH EAX
0041f5ba : PUSH ECX
0041f5bb : PUSH -0x1
0041f5bd : PUSH 0x100
0041f5c2 : PUSH ESI
0041f5c3 : CALL 0x00634771
0041f5c8 : MOV EAX,ESI
0041f5ca : ADD ESP,0x14
0041f5cd : LEA EDX,[EAX + 0x2]
0041f5d0 : MOV CX,word ptr [EAX]
0041f5d3 : ADD EAX,0x2
0041f5d6 : TEST CX,CX
0041f5d9 : JNZ 0x0041f5d0
0041f5db : SUB EAX,EDX
0041f5dd : SAR EAX,0x1
0041f5df : CMP EAX,dword ptr [EDI + 0x4]
0041f5e2 : JG 0x0041f5f6
0041f5e4 : PUSH ESI
0041f5e5 : PUSH 0x100
0041f5ea : ADD EDI,0x8
0041f5ed : PUSH EDI
0041f5ee : CALL 0x0063481b
0041f5f3 : ADD ESP,0xc
0041f5f6 : TEST ESI,ESI
0041f5f8 : JZ 0x0041f60f
0041f5fa : CMP dword ptr [ESI + -0x8],0xdddd
0041f601 : LEA EAX,[ESI + -0x8]
0041f604 : JNZ 0x0041f60f
0041f606 : PUSH EAX
0041f607 : CALL 0x0063610d
0041f60c : ADD ESP,0x4
0041f60f : POP EDI
0041f610 : POP ESI
0041f611 : POP EBP
0041f612 : RET

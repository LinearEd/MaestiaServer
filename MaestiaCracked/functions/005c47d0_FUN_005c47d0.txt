PROGRAM  : Maestia.exe
FUNCTION : FUN_005c47d0
ENTRY    : 005c47d0
BODY     : [[005c47d0, 005c48f4]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005c47d0(undefined4 param_1,undefined4 *param_2,uint param_3)

{
  uint *puVar1;
  uint *puVar2;
  uint *puVar3;
  int *piVar4;
  int *in_ECX;
  uint uVar5;
  uint uVar6;
  int iVar7;
  
  piVar4 = (int *)*in_ECX;
  if (piVar4 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar4 * 5) <= piVar4[1] * 4 + 4U) goto LAB_005c480a;
    iVar7 = piVar4[1] * 2 + 2;
  }
  FUN_005c4520(param_1,iVar7);
LAB_005c480a:
  piVar4 = (int *)*in_ECX;
  param_3 = param_3 & piVar4[1];
  *piVar4 = *piVar4 + 1;
  iVar7 = *in_ECX;
  puVar1 = (uint *)(iVar7 + 8 + param_3 * 0xc);
  if (*(int *)(iVar7 + 8 + param_3 * 0xc) == -2) {
    *puVar1 = 0xffffffff;
    puVar1[1] = *(uint *)*param_2;
    puVar1[2] = *(uint *)param_2[1];
    return;
  }
  uVar5 = param_3;
  do {
    uVar5 = uVar5 + 1 & *(uint *)(iVar7 + 4);
  } while (*(int *)(iVar7 + 8 + uVar5 * 0xc) != -2);
  puVar2 = (uint *)(iVar7 + 8 + uVar5 * 0xc);
  uVar6 = puVar1[1] & *(uint *)(iVar7 + 4);
  if (uVar6 == param_3) {
    if (puVar2 != (uint *)0x0) {
      *puVar2 = *puVar1;
      puVar2[1] = puVar1[1];
      puVar2[2] = puVar1[2];
    }
    puVar1[1] = *(uint *)*param_2;
    puVar1[2] = *(uint *)param_2[1];
    *puVar1 = uVar5;
    return;
  }
  puVar3 = (uint *)(iVar7 + 8 + uVar6 * 0xc);
  for (uVar6 = *(uint *)(iVar7 + 8 + uVar6 * 0xc); uVar6 != param_3;
      uVar6 = *(uint *)(iVar7 + 8 + uVar6 * 0xc)) {
    uVar6 = *puVar3;
    puVar3 = (uint *)(iVar7 + 8 + uVar6 * 0xc);
  }
  if (puVar2 != (uint *)0x0) {
    *puVar2 = *puVar1;
    puVar2[1] = puVar1[1];
    puVar2[2] = puVar1[2];
  }
  *puVar3 = uVar5;
  puVar1[1] = *(uint *)*param_2;
  puVar1[2] = *(uint *)param_2[1];
  *puVar1 = 0xffffffff;
  return;
}



============================================================
DISASSEMBLY
============================================================
005c47d0 : PUSH ESI
005c47d1 : MOV ESI,ECX
005c47d3 : MOV EAX,dword ptr [ESI]
005c47d5 : PUSH EDI
005c47d6 : TEST EAX,EAX
005c47d8 : JNZ 0x005c47e3
005c47da : MOV EAX,dword ptr [ESP + 0xc]
005c47de : PUSH 0x8
005c47e0 : PUSH EAX
005c47e1 : JMP 0x005c4805
005c47e3 : MOV ECX,dword ptr [EAX + 0x4]
005c47e6 : LEA EDX,[ECX*0x4 + 0x4]
005c47ed : MOV ECX,dword ptr [EAX]
005c47ef : LEA ECX,[ECX + ECX*0x4]
005c47f2 : CMP ECX,EDX
005c47f4 : JBE 0x005c480a
005c47f6 : MOV EDX,dword ptr [EAX + 0x4]
005c47f9 : MOV ECX,dword ptr [ESP + 0xc]
005c47fd : LEA EAX,[EDX + EDX*0x1 + 0x2]
005c4801 : PUSH EAX
005c4802 : PUSH ECX
005c4803 : MOV ECX,ESI
005c4805 : CALL 0x005c4520
005c480a : MOV ECX,dword ptr [ESI]
005c480c : MOV EAX,dword ptr [ESP + 0x14]
005c4810 : AND EAX,dword ptr [ECX + 0x4]
005c4813 : INC dword ptr [ECX]
005c4815 : MOV ESI,dword ptr [ESI]
005c4817 : LEA EDX,[EAX + EAX*0x2]
005c481a : MOV ECX,dword ptr [ESI + EDX*0x4 + 0x8]
005c481e : LEA EDX,[ESI + EDX*0x4 + 0x8]
005c4822 : MOV EDI,0xfffffffe
005c4827 : CMP ECX,EDI
005c4829 : JNZ 0x005c4849
005c482b : MOV EAX,dword ptr [ESP + 0x10]
005c482f : MOV dword ptr [EDX],0xffffffff
005c4835 : MOV ECX,dword ptr [EAX]
005c4837 : MOV ECX,dword ptr [ECX]
005c4839 : MOV dword ptr [EDX + 0x4],ECX
005c483c : MOV EAX,dword ptr [EAX + 0x4]
005c483f : MOV ECX,dword ptr [EAX]
005c4841 : POP EDI
005c4842 : MOV dword ptr [EDX + 0x8],ECX
005c4845 : POP ESI
005c4846 : RET 0xc
005c4849 : PUSH EBX
005c484a : PUSH EBP
005c484b : MOV EBP,dword ptr [ESI + 0x4]
005c484e : MOV ECX,EAX
005c4850 : INC ECX
005c4851 : AND ECX,EBP
005c4853 : LEA EBX,[ECX + ECX*0x2]
005c4856 : CMP dword ptr [ESI + EBX*0x4 + 0x8],EDI
005c485a : JNZ 0x005c4850
005c485c : LEA EDI,[ECX + ECX*0x2]
005c485f : LEA EBX,[ESI + EDI*0x4 + 0x8]
005c4863 : MOV EDI,dword ptr [EDX + 0x4]
005c4866 : AND EDI,EBP
005c4868 : CMP EDI,EAX
005c486a : JNZ 0x005c489c
005c486c : TEST EBX,EBX
005c486e : JZ 0x005c4880
005c4870 : MOV EAX,dword ptr [EDX]
005c4872 : MOV dword ptr [EBX],EAX
005c4874 : MOV EAX,dword ptr [EDX + 0x4]
005c4877 : MOV dword ptr [EBX + 0x4],EAX
005c487a : MOV EAX,dword ptr [EDX + 0x8]
005c487d : MOV dword ptr [EBX + 0x8],EAX
005c4880 : MOV EAX,dword ptr [ESP + 0x18]
005c4884 : MOV ESI,dword ptr [EAX]
005c4886 : MOV ESI,dword ptr [ESI]
005c4888 : MOV dword ptr [EDX + 0x4],ESI
005c488b : MOV EAX,dword ptr [EAX + 0x4]
005c488e : MOV EAX,dword ptr [EAX]
005c4890 : POP EBP
005c4891 : POP EBX
005c4892 : POP EDI
005c4893 : MOV dword ptr [EDX + 0x8],EAX
005c4896 : MOV dword ptr [EDX],ECX
005c4898 : POP ESI
005c4899 : RET 0xc
005c489c : LEA EDI,[EDI + EDI*0x2]
005c489f : CMP dword ptr [ESI + EDI*0x4 + 0x8],EAX
005c48a3 : LEA EDI,[ESI + EDI*0x4 + 0x8]
005c48a7 : JZ 0x005c48bf
005c48a9 : LEA ESP,[ESP]
005c48b0 : MOV EDI,dword ptr [EDI]
005c48b2 : LEA EDI,[EDI + EDI*0x2]
005c48b5 : CMP dword ptr [ESI + EDI*0x4 + 0x8],EAX
005c48b9 : LEA EDI,[ESI + EDI*0x4 + 0x8]
005c48bd : JNZ 0x005c48b0
005c48bf : TEST EBX,EBX
005c48c1 : JZ 0x005c48d3
005c48c3 : MOV EAX,dword ptr [EDX]
005c48c5 : MOV dword ptr [EBX],EAX
005c48c7 : MOV EAX,dword ptr [EDX + 0x4]
005c48ca : MOV dword ptr [EBX + 0x4],EAX
005c48cd : MOV EAX,dword ptr [EDX + 0x8]
005c48d0 : MOV dword ptr [EBX + 0x8],EAX
005c48d3 : MOV EAX,dword ptr [ESP + 0x18]
005c48d7 : MOV dword ptr [EDI],ECX
005c48d9 : MOV ECX,dword ptr [EAX]
005c48db : MOV ECX,dword ptr [ECX]
005c48dd : MOV dword ptr [EDX + 0x4],ECX
005c48e0 : MOV EAX,dword ptr [EAX + 0x4]
005c48e3 : MOV ECX,dword ptr [EAX]
005c48e5 : POP EBP
005c48e6 : POP EBX
005c48e7 : POP EDI
005c48e8 : MOV dword ptr [EDX + 0x8],ECX
005c48eb : MOV dword ptr [EDX],0xffffffff
005c48f1 : POP ESI
005c48f2 : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_00813ff0
ENTRY    : 00813ff0
BODY     : [[00813ff0, 0081428c]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00813ff0(int param_1,undefined4 param_2,int param_3,int param_4)

{
  char cVar1;
  uint uVar2;
  undefined4 *puVar3;
  int iVar4;
  int *piVar5;
  undefined1 *puVar6;
  int *piVar7;
  undefined4 uVar8;
  int in_ECX;
  undefined1 local_90 [56];
  int local_58;
  undefined4 local_54;
  uint local_50;
  undefined1 local_4c [4];
  undefined4 local_48;
  int local_38;
  uint local_34;
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1aaf0;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_50 = 0;
  local_2c = 0;
  local_54 = param_2;
  local_18 = 7;
  local_1c = 0;
  local_14 = uVar2;
  FUN_00405eb0(param_1,0,0xffffffff);
  local_8 = 0;
  FUN_0070cac0(uVar2);
  FUN_0043acd0(in_ECX + 0x30,&local_58);
  if (local_58 == *(int *)(in_ECX + 0x34)) {
    cVar1 = FUN_008123d0();
    if (cVar1 == '\0') {
      FUN_00405eb0(param_1,0,0xffffffff);
      local_8 = 0xffffffff;
      if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
    }
    else {
      local_8 = 0xffffffff;
      if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
    }
  }
  else {
    if (param_3 == 0) {
      FUN_00405eb0(param_1,0,0xffffffff);
    }
    else {
      FUN_00453720(local_4c,param_4);
      local_8._0_1_ = 1;
      if (param_4 != 0) {
        puVar3 = local_48;
        if (local_34 < 8) {
          puVar3 = &local_48;
        }
        iVar4 = FUN_00405b70(puVar3);
        if ((iVar4 == 0) && (local_38 == 0)) {
          local_8 = (uint)local_8._1_3_ << 8;
          FUN_00406560();
          local_8 = 0xffffffff;
          FUN_00406560();
          goto LAB_0081426f;
        }
      }
      piVar7 = (int *)(param_1 + 4);
      piVar5 = piVar7;
      if (7 < *(uint *)(param_1 + 0x18)) {
        piVar5 = (int *)*piVar7;
      }
      if (*(short *)piVar5 == 0x20) {
        FUN_00406460(&DAT_00c2e1c8);
        local_8 = CONCAT31(local_8._1_3_,2);
        local_50 = 1;
        puVar6 = (undefined1 *)FUN_00403450(local_90,local_4c);
        local_8._0_1_ = 3;
        local_8._1_3_ = 0;
        local_50 = 3;
      }
      else {
        puVar6 = local_4c;
      }
      FUN_00405eb0(puVar6,0,0xffffffff);
      local_8 = 2;
      if ((local_50 & 2) != 0) {
        local_50 = local_50 & 0xfffffffd;
        FUN_00406560();
      }
      local_8 = 1;
      if ((local_50 & 1) != 0) {
        local_50 = local_50 & 0xfffffffe;
        FUN_00406560();
      }
      if (*(int *)(param_1 + 0x14) != 0) {
        if (7 < *(uint *)(param_1 + 0x18)) {
          piVar7 = (int *)*piVar7;
        }
        if (*(short *)((int)piVar7 + *(int *)(param_1 + 0x14) * 2 + -2) == 0x20) {
          uVar8 = FUN_00406460(&DAT_00c2e1cc);
          local_8._0_1_ = 4;
          FUN_00405c30(uVar8,0,0xffffffff);
          local_8 = CONCAT31(local_8._1_3_,1);
          FUN_00406560();
        }
      }
      local_8 = local_8 & 0xffffff00;
      if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_34 = 7;
      local_38 = 0;
      local_48 = (undefined4 *)((uint)local_48._2_2_ << 0x10);
    }
    local_8 = 0xffffffff;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  local_8 = 0xffffffff;
  local_2c = 0;
  local_18 = 7;
  local_1c = 0;
LAB_0081426f:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00813ff0 : PUSH EBP
00813ff1 : MOV EBP,ESP
00813ff3 : PUSH -0x1
00813ff5 : PUSH 0xb1aaf0
00813ffa : MOV EAX,FS:[0x0]
00814000 : PUSH EAX
00814001 : SUB ESP,0x80
00814007 : MOV EAX,[0x00d66fa0]
0081400c : XOR EAX,EBP
0081400e : MOV dword ptr [EBP + -0x10],EAX
00814011 : PUSH EBX
00814012 : PUSH ESI
00814013 : PUSH EDI
00814014 : PUSH EAX
00814015 : LEA EAX,[EBP + -0xc]
00814018 : MOV FS:[0x0],EAX
0081401e : MOV EBX,dword ptr [EBP + 0x8]
00814021 : MOV EAX,dword ptr [EBP + 0xc]
00814024 : MOV EDI,ECX
00814026 : XOR ESI,ESI
00814028 : PUSH -0x1
0081402a : MOV dword ptr [EBP + -0x4c],ESI
0081402d : XOR ECX,ECX
0081402f : PUSH ESI
00814030 : MOV word ptr [EBP + -0x28],CX
00814034 : PUSH EBX
00814035 : LEA ECX,[EBP + -0x2c]
00814038 : MOV dword ptr [EBP + -0x50],EAX
0081403b : MOV dword ptr [EBP + -0x14],0x7
00814042 : MOV dword ptr [EBP + -0x18],ESI
00814045 : CALL 0x00405eb0
0081404a : MOV dword ptr [EBP + -0x4],ESI
0081404d : LEA ECX,[EBP + -0x2c]
00814050 : CALL 0x0070cac0
00814055 : LEA EDX,[EBP + -0x54]
00814058 : PUSH EDX
00814059 : LEA EAX,[EDI + 0x30]
0081405c : PUSH EAX
0081405d : LEA ESI,[EBP + -0x2c]
00814060 : CALL 0x0043acd0
00814065 : MOV EDI,dword ptr [EDI + 0x34]
00814068 : MOV EAX,dword ptr [EBP + -0x54]
0081406b : CMP EAX,EDI
0081406d : JNZ 0x008140c9
0081406f : MOV EDX,ESI
00814071 : CALL 0x008123d0
00814076 : TEST AL,AL
00814078 : JNZ 0x008140a7
0081407a : MOV ECX,dword ptr [EBP + -0x50]
0081407d : PUSH -0x1
0081407f : PUSH 0x0
00814081 : PUSH EBX
00814082 : CALL 0x00405eb0
00814087 : MOV dword ptr [EBP + -0x4],0xffffffff
0081408e : CMP dword ptr [EBP + -0x14],0x8
00814092 : JC 0x0081409c
00814094 : MOV ECX,dword ptr [EBP + -0x28]
00814097 : CALL 0x006f04e0
0081409c : XOR ECX,ECX
0081409e : MOV word ptr [EBP + -0x28],CX
008140a2 : JMP 0x0081425f
008140a7 : MOV dword ptr [EBP + -0x4],0xffffffff
008140ae : CMP dword ptr [EBP + -0x14],0x8
008140b2 : JC 0x008140bc
008140b4 : MOV ECX,dword ptr [EBP + -0x28]
008140b7 : CALL 0x006f04e0
008140bc : XOR EDX,EDX
008140be : MOV word ptr [EBP + -0x28],DX
008140c2 : XOR AL,AL
008140c4 : JMP 0x00814261
008140c9 : CMP dword ptr [EBP + 0x10],0x0
008140cd : JNZ 0x008140e1
008140cf : MOV ECX,dword ptr [EBP + -0x50]
008140d2 : PUSH -0x1
008140d4 : PUSH 0x0
008140d6 : PUSH EBX
008140d7 : CALL 0x00405eb0
008140dc : JMP 0x00814244
008140e1 : MOV ESI,dword ptr [EBP + 0x14]
008140e4 : PUSH ESI
008140e5 : LEA ECX,[EBP + -0x48]
008140e8 : PUSH ECX
008140e9 : MOV ECX,dword ptr [EAX + 0x28]
008140ec : CALL 0x00453720
008140f1 : MOV byte ptr [EBP + -0x4],0x1
008140f5 : TEST ESI,ESI
008140f7 : JZ 0x00814144
008140f9 : CMP dword ptr [EBP + -0x30],0x8
008140fd : MOV EAX,dword ptr [EBP + -0x44]
00814100 : JNC 0x00814105
00814102 : LEA EAX,[EBP + -0x44]
00814105 : PUSH EAX
00814106 : XOR EDX,EDX
00814108 : MOV ECX,0xc2e1c4
0081410d : CALL 0x00405b70
00814112 : ADD ESP,0x4
00814115 : TEST EAX,EAX
00814117 : JNZ 0x00814144
00814119 : CMP dword ptr [EBP + -0x34],EAX
0081411c : SETNZ AL
0081411f : TEST EAX,EAX
00814121 : JNZ 0x00814144
00814123 : MOV byte ptr [EBP + -0x4],AL
00814126 : LEA ECX,[EBP + -0x48]
00814129 : CALL 0x00406560
0081412e : MOV dword ptr [EBP + -0x4],0xffffffff
00814135 : LEA ECX,[EBP + -0x2c]
00814138 : CALL 0x00406560
0081413d : XOR AL,AL
0081413f : JMP 0x0081426f
00814144 : CMP dword ptr [EBX + 0x18],0x8
00814148 : LEA ESI,[EBX + 0x4]
0081414b : JC 0x00814151
0081414d : MOV EAX,dword ptr [ESI]
0081414f : JMP 0x00814153
00814151 : MOV EAX,ESI
00814153 : CMP word ptr [EAX],0x20
00814157 : JNZ 0x00814193
00814159 : PUSH 0xc2e1c8
0081415e : LEA ECX,[EBP + -0x70]
00814161 : CALL 0x00406460
00814166 : MOV byte ptr [EBP + -0x4],0x2
0081416a : LEA EDX,[EBP + -0x48]
0081416d : PUSH EDX
0081416e : LEA ECX,[EBP + 0xffffff74]
00814174 : PUSH ECX
00814175 : MOV ECX,EAX
00814177 : MOV dword ptr [EBP + -0x4c],0x1
0081417e : CALL 0x00403450
00814183 : ADD ESP,0x8
00814186 : MOV ECX,0x3
0081418b : MOV dword ptr [EBP + -0x4],ECX
0081418e : MOV dword ptr [EBP + -0x4c],ECX
00814191 : JMP 0x00814196
00814193 : LEA EAX,[EBP + -0x48]
00814196 : MOV EDI,dword ptr [EBP + -0x50]
00814199 : PUSH -0x1
0081419b : PUSH 0x0
0081419d : PUSH EAX
0081419e : MOV ECX,EDI
008141a0 : CALL 0x00405eb0
008141a5 : MOV dword ptr [EBP + -0x4],0x2
008141ac : TEST byte ptr [EBP + -0x4c],0x2
008141b0 : JZ 0x008141c1
008141b2 : AND dword ptr [EBP + -0x4c],0xfffffffd
008141b6 : LEA ECX,[EBP + 0xffffff74]
008141bc : CALL 0x00406560
008141c1 : MOV dword ptr [EBP + -0x4],0x1
008141c8 : TEST byte ptr [EBP + -0x4c],0x1
008141cc : JZ 0x008141da
008141ce : AND dword ptr [EBP + -0x4c],0xfffffffe
008141d2 : LEA ECX,[EBP + -0x70]
008141d5 : CALL 0x00406560
008141da : MOV ECX,dword ptr [EBX + 0x14]
008141dd : TEST ECX,ECX
008141df : JBE 0x0081421e
008141e1 : CMP dword ptr [EBX + 0x18],0x8
008141e5 : JC 0x008141eb
008141e7 : MOV EAX,dword ptr [ESI]
008141e9 : JMP 0x008141ed
008141eb : MOV EAX,ESI
008141ed : CMP word ptr [EAX + ECX*0x2 + -0x2],0x20
008141f3 : JNZ 0x0081421e
008141f5 : PUSH 0xc2e1cc
008141fa : LEA ECX,[EBP + -0x70]
008141fd : CALL 0x00406460
00814202 : MOV byte ptr [EBP + -0x4],0x4
00814206 : PUSH -0x1
00814208 : PUSH 0x0
0081420a : PUSH EAX
0081420b : MOV ECX,EDI
0081420d : CALL 0x00405c30
00814212 : MOV byte ptr [EBP + -0x4],0x1
00814216 : LEA ECX,[EBP + -0x70]
00814219 : CALL 0x00406560
0081421e : MOV byte ptr [EBP + -0x4],0x0
00814222 : CMP dword ptr [EBP + -0x30],0x8
00814226 : JC 0x00814230
00814228 : MOV ECX,dword ptr [EBP + -0x44]
0081422b : CALL 0x006f04e0
00814230 : XOR EDX,EDX
00814232 : MOV dword ptr [EBP + -0x30],0x7
00814239 : MOV dword ptr [EBP + -0x34],0x0
00814240 : MOV word ptr [EBP + -0x44],DX
00814244 : MOV dword ptr [EBP + -0x4],0xffffffff
0081424b : CMP dword ptr [EBP + -0x14],0x8
0081424f : JC 0x00814259
00814251 : MOV ECX,dword ptr [EBP + -0x28]
00814254 : CALL 0x006f04e0
00814259 : XOR EAX,EAX
0081425b : MOV word ptr [EBP + -0x28],AX
0081425f : MOV AL,0x1
00814261 : MOV dword ptr [EBP + -0x14],0x7
00814268 : MOV dword ptr [EBP + -0x18],0x0
0081426f : MOV ECX,dword ptr [EBP + -0xc]
00814272 : MOV dword ptr FS:[0x0],ECX
00814279 : POP ECX
0081427a : POP EDI
0081427b : POP ESI
0081427c : POP EBX
0081427d : MOV ECX,dword ptr [EBP + -0x10]
00814280 : XOR ECX,EBP
00814282 : CALL 0x00633e6b
00814287 : MOV ESP,EBP
00814289 : POP EBP
0081428a : RET 0x10

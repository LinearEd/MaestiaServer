PROGRAM  : Maestia.exe
FUNCTION : FUN_005b5960
ENTRY    : 005b5960
BODY     : [[005b5960, 005b5a01]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_005b5960(undefined4 *param_1)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  int iVar4;
  int *in_ECX;
  bool bVar5;
  
  puVar3 = param_1;
  iVar1 = in_ECX[0x28];
  bVar5 = param_1 != (undefined4 *)0x0;
  if (param_1 == (undefined4 *)0x0) {
    FUN_00515cf0(iVar1);
    *(byte *)((int)in_ECX + 0x66) = *(byte *)((int)in_ECX + 0x66) & 0xfe;
    in_ECX[0x28] = 0;
  }
  else {
    if (iVar1 == 0) {
      param_1 = (undefined4 *)0x109;
      iVar4 = FUN_00515d60(in_ECX,0x10,&param_1);
      in_ECX[0x28] = iVar4;
    }
    puVar2 = (undefined4 *)in_ECX[0x28];
    *puVar2 = *puVar3;
    puVar2[1] = puVar3[1];
    puVar2[2] = puVar3[2];
    puVar2[3] = puVar3[3];
    *(byte *)((int)in_ECX + 0x66) = *(byte *)((int)in_ECX + 0x66) | 1;
  }
  iVar4 = (**(code **)(*in_ECX + 0x40))();
  *(uint *)(iVar4 + 0xb00) = *(uint *)(iVar4 + 0xb00) | 0x400;
  iVar4 = iVar4 + 0xb00;
  if (bVar5 != (iVar1 != 0)) {
    iVar4 = (**(code **)(*in_ECX + 0x3c))();
  }
  return iVar4;
}



============================================================
DISASSEMBLY
============================================================
005b5960 : PUSH EBX
005b5961 : PUSH ESI
005b5962 : MOV ESI,ECX
005b5964 : MOV EAX,dword ptr [ESI + 0xa0]
005b596a : XOR ECX,ECX
005b596c : TEST EAX,EAX
005b596e : SETNZ CL
005b5971 : XOR EDX,EDX
005b5973 : PUSH EDI
005b5974 : MOV EDI,dword ptr [ESP + 0x10]
005b5978 : TEST EDI,EDI
005b597a : SETNZ DL
005b597d : CMP EDX,ECX
005b597f : SETNZ BL
005b5982 : TEST EDI,EDI
005b5984 : JNZ 0x005b5998
005b5986 : PUSH EAX
005b5987 : CALL 0x00515cf0
005b598c : AND byte ptr [ESI + 0x66],0xfe
005b5990 : MOV dword ptr [ESI + 0xa0],EDI
005b5996 : JMP 0x005b59d7
005b5998 : TEST EAX,EAX
005b599a : JNZ 0x005b59b7
005b599c : LEA EAX,[ESP + 0x10]
005b59a0 : PUSH EAX
005b59a1 : PUSH 0x10
005b59a3 : PUSH ESI
005b59a4 : MOV dword ptr [ESP + 0x1c],0x109
005b59ac : CALL 0x00515d60
005b59b1 : MOV dword ptr [ESI + 0xa0],EAX
005b59b7 : MOV ECX,dword ptr [EDI]
005b59b9 : MOV EAX,dword ptr [ESI + 0xa0]
005b59bf : MOV dword ptr [EAX],ECX
005b59c1 : MOV EDX,dword ptr [EDI + 0x4]
005b59c4 : MOV dword ptr [EAX + 0x4],EDX
005b59c7 : MOV ECX,dword ptr [EDI + 0x8]
005b59ca : MOV dword ptr [EAX + 0x8],ECX
005b59cd : MOV EDX,dword ptr [EDI + 0xc]
005b59d0 : MOV dword ptr [EAX + 0xc],EDX
005b59d3 : OR byte ptr [ESI + 0x66],0x1
005b59d7 : MOV EAX,dword ptr [ESI]
005b59d9 : MOV EDX,dword ptr [EAX + 0x40]
005b59dc : MOV ECX,ESI
005b59de : CALL EDX
005b59e0 : OR dword ptr [EAX + 0xb00],0x400
005b59ea : ADD EAX,0xb00
005b59ef : TEST BL,BL
005b59f1 : JZ 0x005b59fc
005b59f3 : MOV EAX,dword ptr [ESI]
005b59f5 : MOV EDX,dword ptr [EAX + 0x3c]
005b59f8 : MOV ECX,ESI
005b59fa : CALL EDX
005b59fc : POP EDI
005b59fd : POP ESI
005b59fe : POP EBX
005b59ff : RET 0x4

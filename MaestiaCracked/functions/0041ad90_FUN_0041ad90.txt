PROGRAM  : Maestia.exe
FUNCTION : FUN_0041ad90
ENTRY    : 0041ad90
BODY     : [[0041ad90, 0041af28]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0041ad90(undefined2 *param_1,undefined2 *param_2,code *param_3)

{
  undefined2 *puVar1;
  undefined2 *puVar2;
  undefined2 *puVar3;
  void **ppvVar4;
  undefined2 *puVar5;
  char cVar6;
  uint uVar7;
  undefined1 local_4c [4];
  code *local_48;
  uint local_44;
  undefined2 local_40;
  undefined2 local_3e;
  undefined1 local_3c [28];
  undefined4 local_20;
  undefined2 local_1c;
  undefined2 local_1a;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b79574;
  local_10 = ExceptionList;
  local_18 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_48 = param_3;
  uVar7 = local_18;
  ppvVar4 = &local_10;
  puVar5 = param_1;
  if (param_1 != param_2) {
    while (ExceptionList = ppvVar4, puVar1 = puVar5 + 0x14, puVar1 != param_2) {
      FUN_00416650(&local_40);
      local_8 = 0;
      cVar6 = (*local_48)(&local_40,param_1,uVar7);
      if (cVar6 == '\0') {
        cVar6 = (*local_48)(&local_40,puVar5);
        puVar3 = puVar1;
        while (puVar2 = puVar5, cVar6 != '\0') {
          *puVar3 = *puVar2;
          puVar3[1] = puVar2[1];
          FUN_00405eb0(puVar2 + 2,0,0xffffffff);
          *(undefined4 *)(puVar3 + 0x10) = *(undefined4 *)(puVar2 + 0x10);
          puVar3[0x12] = puVar2[0x12];
          puVar3[0x13] = puVar2[0x13];
          cVar6 = (*local_48)(&local_40,puVar2 + -0x14);
          puVar5 = puVar2 + -0x14;
          puVar3 = puVar2;
        }
        puVar3[1] = local_3e;
        *puVar3 = local_40;
        FUN_00405eb0(local_3c,0,0xffffffff);
        *(undefined4 *)(puVar3 + 0x10) = local_20;
        puVar3[0x12] = local_1c;
        puVar3[0x13] = local_1a;
      }
      else {
        local_44 = local_44 & 0xffffff00;
        FUN_0041b360(local_4c,param_1,puVar1,puVar5 + 0x28,local_44,local_44,local_44);
        *param_1 = local_40;
        param_1[1] = local_3e;
        FUN_00405eb0(local_3c,0,0xffffffff);
        *(undefined4 *)(param_1 + 0x10) = local_20;
        param_1[0x12] = local_1c;
        param_1[0x13] = local_1a;
      }
      local_8 = 0xffffffff;
      FUN_004427d0(&local_40);
      ppvVar4 = ExceptionList;
      puVar5 = puVar1;
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0041ad90 : PUSH EBP
0041ad91 : MOV EBP,ESP
0041ad93 : PUSH -0x1
0041ad95 : PUSH 0xb79574
0041ad9a : MOV EAX,FS:[0x0]
0041ada0 : PUSH EAX
0041ada1 : SUB ESP,0x40
0041ada4 : MOV EAX,[0x00d66fa0]
0041ada9 : XOR EAX,EBP
0041adab : MOV dword ptr [EBP + -0x14],EAX
0041adae : PUSH EBX
0041adaf : PUSH ESI
0041adb0 : PUSH EDI
0041adb1 : PUSH EAX
0041adb2 : LEA EAX,[EBP + -0xc]
0041adb5 : MOV FS:[0x0],EAX
0041adbb : MOV EAX,dword ptr [EBP + 0x10]
0041adbe : MOV EBX,dword ptr [EBP + 0x8]
0041adc1 : MOV dword ptr [EBP + -0x44],EAX
0041adc4 : MOV EAX,dword ptr [EBP + 0xc]
0041adc7 : CMP EBX,EAX
0041adc9 : JZ 0x0041af0d
0041adcf : ADD EBX,0x28
0041add2 : CMP EBX,EAX
0041add4 : JZ 0x0041af0d
0041adda : LEA ECX,[EBP + -0x3c]
0041addd : PUSH ECX
0041adde : MOV ECX,EBX
0041ade0 : MOV EDI,EBX
0041ade2 : CALL 0x00416650
0041ade7 : MOV dword ptr [EBP + -0x4],0x0
0041adee : MOV EDX,dword ptr [EBP + 0x8]
0041adf1 : PUSH EDX
0041adf2 : LEA EAX,[EBP + -0x3c]
0041adf5 : PUSH EAX
0041adf6 : CALL dword ptr [EBP + -0x44]
0041adf9 : ADD ESP,0x8
0041adfc : TEST AL,AL
0041adfe : JZ 0x0041ae62
0041ae00 : MOV byte ptr [EBP + -0x40],0x0
0041ae04 : MOV ECX,dword ptr [EBP + -0x40]
0041ae07 : MOV EDX,dword ptr [EBP + -0x40]
0041ae0a : PUSH ECX
0041ae0b : MOV ECX,dword ptr [EBP + -0x40]
0041ae0e : PUSH EDX
0041ae0f : MOV EDX,dword ptr [EBP + 0x8]
0041ae12 : PUSH ECX
0041ae13 : LEA EAX,[EBX + 0x28]
0041ae16 : PUSH EAX
0041ae17 : PUSH EBX
0041ae18 : PUSH EDX
0041ae19 : LEA EAX,[EBP + -0x48]
0041ae1c : PUSH EAX
0041ae1d : CALL 0x0041b360
0041ae22 : MOV ESI,dword ptr [EBP + 0x8]
0041ae25 : MOV CX,word ptr [EBP + -0x3c]
0041ae29 : ADD ESP,0x1c
0041ae2c : MOV word ptr [ESI],CX
0041ae2f : MOVZX EDX,word ptr [EBP + -0x3a]
0041ae33 : PUSH -0x1
0041ae35 : PUSH 0x0
0041ae37 : LEA EAX,[EBP + -0x38]
0041ae3a : PUSH EAX
0041ae3b : LEA ECX,[ESI + 0x4]
0041ae3e : MOV word ptr [ESI + 0x2],DX
0041ae42 : CALL 0x00405eb0
0041ae47 : MOV ECX,dword ptr [EBP + -0x1c]
0041ae4a : MOV dword ptr [ESI + 0x20],ECX
0041ae4d : MOVZX EDX,word ptr [EBP + -0x18]
0041ae51 : MOV word ptr [ESI + 0x24],DX
0041ae55 : MOV AX,word ptr [EBP + -0x16]
0041ae59 : MOV word ptr [ESI + 0x26],AX
0041ae5d : JMP 0x0041aef1
0041ae62 : LEA ESI,[EBX + -0x28]
0041ae65 : LEA ECX,[EBP + -0x3c]
0041ae68 : PUSH ESI
0041ae69 : PUSH ECX
0041ae6a : CALL dword ptr [EBP + -0x44]
0041ae6d : ADD ESP,0x8
0041ae70 : TEST AL,AL
0041ae72 : JZ 0x0041aebc
0041ae74 : MOV DX,word ptr [ESI]
0041ae77 : PUSH -0x1
0041ae79 : MOV word ptr [EDI],DX
0041ae7c : MOVZX EAX,word ptr [ESI + 0x2]
0041ae80 : PUSH 0x0
0041ae82 : LEA ECX,[ESI + 0x4]
0041ae85 : PUSH ECX
0041ae86 : LEA ECX,[EDI + 0x4]
0041ae89 : MOV word ptr [EDI + 0x2],AX
0041ae8d : CALL 0x00405eb0
0041ae92 : MOV EDX,dword ptr [ESI + 0x20]
0041ae95 : MOV dword ptr [EDI + 0x20],EDX
0041ae98 : MOVZX EAX,word ptr [ESI + 0x24]
0041ae9c : MOV word ptr [EDI + 0x24],AX
0041aea0 : MOV CX,word ptr [ESI + 0x26]
0041aea4 : MOV word ptr [EDI + 0x26],CX
0041aea8 : MOV EDI,ESI
0041aeaa : SUB ESI,0x28
0041aead : LEA EDX,[EBP + -0x3c]
0041aeb0 : PUSH ESI
0041aeb1 : PUSH EDX
0041aeb2 : CALL dword ptr [EBP + -0x44]
0041aeb5 : ADD ESP,0x8
0041aeb8 : TEST AL,AL
0041aeba : JNZ 0x0041ae74
0041aebc : MOVZX ECX,word ptr [EBP + -0x3a]
0041aec0 : MOV AX,word ptr [EBP + -0x3c]
0041aec4 : PUSH -0x1
0041aec6 : PUSH 0x0
0041aec8 : LEA EDX,[EBP + -0x38]
0041aecb : MOV word ptr [EDI + 0x2],CX
0041aecf : PUSH EDX
0041aed0 : LEA ECX,[EDI + 0x4]
0041aed3 : MOV word ptr [EDI],AX
0041aed6 : CALL 0x00405eb0
0041aedb : MOVZX ECX,word ptr [EBP + -0x18]
0041aedf : MOV EAX,dword ptr [EBP + -0x1c]
0041aee2 : MOV DX,word ptr [EBP + -0x16]
0041aee6 : MOV dword ptr [EDI + 0x20],EAX
0041aee9 : MOV word ptr [EDI + 0x24],CX
0041aeed : MOV word ptr [EDI + 0x26],DX
0041aef1 : MOV dword ptr [EBP + -0x4],0xffffffff
0041aef8 : LEA EAX,[EBP + -0x3c]
0041aefb : PUSH EAX
0041aefc : CALL 0x004427d0
0041af01 : ADD EBX,0x28
0041af04 : CMP EBX,dword ptr [EBP + 0xc]
0041af07 : JNZ 0x0041adda
0041af0d : MOV ECX,dword ptr [EBP + -0xc]
0041af10 : MOV dword ptr FS:[0x0],ECX
0041af17 : POP ECX
0041af18 : POP EDI
0041af19 : POP ESI
0041af1a : POP EBX
0041af1b : MOV ECX,dword ptr [EBP + -0x14]
0041af1e : XOR ECX,EBP
0041af20 : CALL 0x00633e6b
0041af25 : MOV ESP,EBP
0041af27 : POP EBP
0041af28 : RET

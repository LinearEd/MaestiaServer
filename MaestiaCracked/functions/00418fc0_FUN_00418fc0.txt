PROGRAM  : Maestia.exe
FUNCTION : FUN_00418fc0
ENTRY    : 00418fc0
BODY     : [[00418fc0, 0041904c] [00419050, 00419099]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00418fc0(int param_1)

{
  wchar_t wVar1;
  wchar_t *pwVar2;
  int unaff_ESI;
  wchar_t local_61c [256];
  wchar_t local_41c [256];
  wchar_t local_21c;
  undefined1 local_21a [510];
  wchar_t local_1c [4];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7c262;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(uint *)(param_1 + 0x18) < 8) {
    pwVar2 = (wchar_t *)(param_1 + 4);
  }
  else {
    pwVar2 = *(wchar_t **)(param_1 + 4);
  }
  __wsplitpath(pwVar2,local_1c,local_61c,local_41c,&local_21c);
  *(undefined4 *)(unaff_ESI + 0x18) = 7;
  *(undefined4 *)(unaff_ESI + 0x14) = 0;
  *(undefined2 *)(unaff_ESI + 4) = 0;
  pwVar2 = &local_21c;
  do {
    wVar1 = *pwVar2;
    pwVar2 = pwVar2 + 1;
  } while (wVar1 != L'\0');
  FUN_00406360(&local_21c,(int)pwVar2 - (int)local_21a >> 1);
  local_8 = 0;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00418fc0 : PUSH EBP
00418fc1 : MOV EBP,ESP
00418fc3 : PUSH -0x1
00418fc5 : PUSH 0xb7c262
00418fca : MOV EAX,FS:[0x0]
00418fd0 : PUSH EAX
00418fd1 : SUB ESP,0x614
00418fd7 : MOV EAX,[0x00d66fa0]
00418fdc : XOR EAX,EBP
00418fde : MOV dword ptr [EBP + -0x10],EAX
00418fe1 : PUSH EAX
00418fe2 : LEA EAX,[EBP + -0xc]
00418fe5 : MOV FS:[0x0],EAX
00418feb : MOV EAX,dword ptr [EBP + 0x8]
00418fee : MOV dword ptr [EBP + 0xfffff9e4],0x0
00418ff8 : CMP dword ptr [EAX + 0x18],0x8
00418ffc : MOV dword ptr [EBP + 0xfffff9e0],ESI
00419002 : JC 0x00419009
00419004 : MOV EAX,dword ptr [EAX + 0x4]
00419007 : JMP 0x0041900c
00419009 : ADD EAX,0x4
0041900c : LEA ECX,[EBP + 0xfffffde8]
00419012 : PUSH ECX
00419013 : LEA EDX,[EBP + 0xfffffbe8]
00419019 : PUSH EDX
0041901a : LEA ECX,[EBP + 0xfffff9e8]
00419020 : PUSH ECX
00419021 : LEA EDX,[EBP + -0x18]
00419024 : PUSH EDX
00419025 : PUSH EAX
00419026 : CALL 0x00636e00
0041902b : ADD ESP,0x14
0041902e : XOR EAX,EAX
00419030 : MOV dword ptr [ESI + 0x18],0x7
00419037 : MOV dword ptr [ESI + 0x14],0x0
0041903e : MOV word ptr [ESI + 0x4],AX
00419042 : LEA EAX,[EBP + 0xfffffde8]
00419048 : LEA EDX,[EAX + 0x2]
0041904b : JMP 0x00419050
00419050 : MOV CX,word ptr [EAX]
00419053 : ADD EAX,0x2
00419056 : TEST CX,CX
00419059 : JNZ 0x00419050
0041905b : SUB EAX,EDX
0041905d : SAR EAX,0x1
0041905f : PUSH EAX
00419060 : LEA ECX,[EBP + 0xfffffde8]
00419066 : PUSH ECX
00419067 : MOV ECX,ESI
00419069 : CALL 0x00406360
0041906e : MOV dword ptr [EBP + -0x4],0x0
00419075 : MOV dword ptr [EBP + 0xfffff9e4],0x1
0041907f : MOV EAX,ESI
00419081 : MOV ECX,dword ptr [EBP + -0xc]
00419084 : MOV dword ptr FS:[0x0],ECX
0041908b : POP ECX
0041908c : MOV ECX,dword ptr [EBP + -0x10]
0041908f : XOR ECX,EBP
00419091 : CALL 0x00633e6b
00419096 : MOV ESP,EBP
00419098 : POP EBP
00419099 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_009d7060
ENTRY    : 009d7060
BODY     : [[009d7060, 009d7278]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009d7060(int *param_1)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  wchar_t *_Source;
  uint uVar4;
  undefined1 local_30 [24];
  uint local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b640f6;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_14 = FUN_006f0760(0xa8,"",0,(DAT_01725270 >> 3 & 1) == 0,
                          DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
  local_8 = 0;
  if (local_14 == 0) {
    iVar3 = 0;
  }
  else {
    iVar3 = FUN_0041bd90();
  }
  local_8 = 0xffffffff;
  local_14 = iVar3;
  FUN_0041b840();
  iVar1 = *(int *)(DAT_0172491c + 0x17c);
  if (*(uint *)(iVar1 + 0x24) < 8) {
    _Source = (wchar_t *)(iVar1 + 0x10);
  }
  else {
    _Source = *(wchar_t **)(iVar1 + 0x10);
  }
  _wcsncpy((wchar_t *)(iVar3 + 0x3c),_Source,0x27);
  *(undefined2 *)(iVar3 + 0x8a) = 0;
  iVar1 = param_1[0x35];
  if (iVar1 == 0) {
    uVar4 = 0;
  }
  else {
    uVar4 = param_1[0x37] - iVar1 >> 2;
  }
  piVar2 = (int *)param_1[0x36];
  if ((uint)((int)piVar2 - iVar1 >> 2) < uVar4) {
    *piVar2 = iVar3;
    param_1[0x36] = (int)(piVar2 + 1);
  }
  else {
    FUN_0042fe80(param_1 + 0x34,piVar2,&local_14);
  }
  piVar2 = param_1;
  FUN_009d39e0(param_1);
  if (piVar2[0x4e] == 0) {
    FUN_009d5930();
  }
  iVar3 = *DAT_00da9894;
  if ((iVar3 != 0) && (*(int *)(iVar3 + 0x114) != 0)) {
    (**(code **)(**(int **)(iVar3 + 0x114) + 4))
              (*(int **)(iVar3 + 0x114),"mc_auction.SetMoney",&DAT_00c96d8c,
               *(undefined4 *)(*(int *)(DAT_0172491c + 0x17c) + 0x1ed0));
  }
  (**(code **)(*piVar2 + 0x78))(0,0);
  if ((*(int *)(*DAT_00da9894 + 0x140) != 0) &&
     (iVar3 = *(int *)(*DAT_00da9894 + 0x140), *(int *)(iVar3 + 0x38) != 0)) {
    iVar3 = *(int *)(iVar3 + 0x38);
    *(int *)(iVar3 + 0x968) = *(int *)(iVar3 + 0x968) + 1;
    (**(code **)(*(int *)(iVar3 + 0x38) + 4))(0x22,*(undefined4 *)(iVar3 + 0x968));
  }
  FUN_00703510((int)&param_1 + 3,&stack0x0000000b);
  if (param_1._3_1_ == '\b') {
    FUN_00406460(L"Item has been registered on GM Category");
    local_8 = 1;
    (**(code **)(**(int **)(*DAT_00da9894 + 0x1a8) + 0x44))(local_30,0x13);
    local_8 = 0xffffffff;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
009d7060 : PUSH EBP
009d7061 : MOV EBP,ESP
009d7063 : PUSH -0x1
009d7065 : PUSH 0xb640f6
009d706a : MOV EAX,FS:[0x0]
009d7070 : PUSH EAX
009d7071 : SUB ESP,0x24
009d7074 : PUSH EBX
009d7075 : PUSH ESI
009d7076 : PUSH EDI
009d7077 : MOV EAX,[0x00d66fa0]
009d707c : XOR EAX,EBP
009d707e : PUSH EAX
009d707f : LEA EAX,[EBP + -0xc]
009d7082 : MOV FS:[0x0],EAX
009d7088 : MOV EAX,[0x01725270]
009d708d : SHR EAX,0x3
009d7090 : MOV ECX,0x0
009d7095 : AND EAX,0x1
009d7098 : SETZ CL
009d709b : PUSH ECX
009d709c : PUSH 0x0
009d709e : PUSH 0xbf1a4a
009d70a3 : PUSH 0xa8
009d70a8 : CALL 0x006f0760
009d70ad : ADD ESP,0x10
009d70b0 : MOV dword ptr [EBP + -0x10],EAX
009d70b3 : MOV dword ptr [EBP + -0x4],0x0
009d70ba : TEST EAX,EAX
009d70bc : JZ 0x009d70c7
009d70be : CALL 0x0041bd90
009d70c3 : MOV ESI,EAX
009d70c5 : JMP 0x009d70c9
009d70c7 : XOR ESI,ESI
009d70c9 : MOV dword ptr [EBP + -0x4],0xffffffff
009d70d0 : MOV EDI,dword ptr [EBP + 0xc]
009d70d3 : MOV dword ptr [EBP + -0x10],ESI
009d70d6 : CALL 0x0041b840
009d70db : MOV EDX,dword ptr [0x0172491c]
009d70e1 : MOV EAX,dword ptr [EDX + 0x17c]
009d70e7 : CMP dword ptr [EAX + 0x24],0x8
009d70eb : JC 0x009d70f2
009d70ed : MOV EAX,dword ptr [EAX + 0x10]
009d70f0 : JMP 0x009d70f5
009d70f2 : ADD EAX,0x10
009d70f5 : PUSH 0x27
009d70f7 : PUSH EAX
009d70f8 : LEA EDI,[ESI + 0x3c]
009d70fb : PUSH EDI
009d70fc : CALL 0x00634e39
009d7101 : XOR EAX,EAX
009d7103 : MOV word ptr [EDI + 0x4e],AX
009d7107 : MOV EAX,dword ptr [EBP + 0x8]
009d710a : MOV ECX,dword ptr [EAX + 0xd4]
009d7110 : ADD EAX,0xd0
009d7115 : ADD ESP,0xc
009d7118 : TEST ECX,ECX
009d711a : JNZ 0x009d7120
009d711c : XOR EDX,EDX
009d711e : JMP 0x009d7128
009d7120 : MOV EDX,dword ptr [EAX + 0xc]
009d7123 : SUB EDX,ECX
009d7125 : SAR EDX,0x2
009d7128 : MOV EDI,dword ptr [EAX + 0x8]
009d712b : MOV EBX,EDI
009d712d : SUB EBX,ECX
009d712f : SAR EBX,0x2
009d7132 : CMP EBX,EDX
009d7134 : JNC 0x009d7140
009d7136 : MOV dword ptr [EDI],ESI
009d7138 : ADD EDI,0x4
009d713b : MOV dword ptr [EAX + 0x8],EDI
009d713e : JMP 0x009d714b
009d7140 : LEA ECX,[EBP + -0x10]
009d7143 : PUSH ECX
009d7144 : PUSH EDI
009d7145 : PUSH EAX
009d7146 : CALL 0x0042fe80
009d714b : MOV EDI,dword ptr [EBP + 0x8]
009d714e : PUSH EDI
009d714f : MOV ECX,ESI
009d7151 : CALL 0x009d39e0
009d7156 : CMP dword ptr [EDI + 0x138],0x0
009d715d : JNZ 0x009d7166
009d715f : MOV ECX,EDI
009d7161 : CALL 0x009d5930
009d7166 : MOV EDX,dword ptr [0x00da9894]
009d716c : MOV EAX,dword ptr [EDX]
009d716e : TEST EAX,EAX
009d7170 : JZ 0x009d71a9
009d7172 : CMP dword ptr [EAX + 0x114],0x0
009d7179 : JZ 0x009d71a9
009d717b : MOV ECX,dword ptr [0x0172491c]
009d7181 : MOV ECX,dword ptr [ECX + 0x17c]
009d7187 : MOV ECX,dword ptr [ECX + 0x1ed0]
009d718d : MOV EAX,dword ptr [EAX + 0x114]
009d7193 : MOV EDX,dword ptr [EAX]
009d7195 : PUSH ECX
009d7196 : PUSH 0xc96d8c
009d719b : PUSH 0xc96dd0
009d71a0 : PUSH EAX
009d71a1 : MOV EAX,dword ptr [EDX + 0x4]
009d71a4 : CALL EAX
009d71a6 : ADD ESP,0x10
009d71a9 : MOV EDX,dword ptr [EDI]
009d71ab : MOV EAX,dword ptr [EDX + 0x78]
009d71ae : PUSH 0x0
009d71b0 : PUSH 0x0
009d71b2 : MOV ECX,EDI
009d71b4 : CALL EAX
009d71b6 : MOV ECX,dword ptr [0x00da9894]
009d71bc : MOV EAX,dword ptr [ECX]
009d71be : CMP dword ptr [EAX + 0x140],0x0
009d71c5 : JZ 0x009d71f2
009d71c7 : MOV ECX,dword ptr [EAX + 0x140]
009d71cd : CMP dword ptr [ECX + 0x38],0x0
009d71d1 : JZ 0x009d71f2
009d71d3 : MOV EAX,ECX
009d71d5 : MOV EAX,dword ptr [EAX + 0x38]
009d71d8 : INC dword ptr [EAX + 0x968]
009d71de : MOV EDX,dword ptr [EAX + 0x38]
009d71e1 : LEA ECX,[EAX + 0x38]
009d71e4 : MOV EAX,dword ptr [ECX + 0x930]
009d71ea : PUSH EAX
009d71eb : MOV EAX,dword ptr [EDX + 0x4]
009d71ee : PUSH 0x22
009d71f0 : CALL EAX
009d71f2 : MOV EDI,dword ptr [ESI + 0x10]
009d71f5 : LEA ECX,[EBP + 0xf]
009d71f8 : PUSH ECX
009d71f9 : LEA EDX,[EBP + 0xb]
009d71fc : PUSH EDX
009d71fd : CALL 0x00703510
009d7202 : MOV EBX,0x8
009d7207 : ADD ESP,0x8
009d720a : CMP byte ptr [EBP + 0xb],BL
009d720d : JNZ 0x009d7265
009d720f : PUSH 0xc96678
009d7214 : LEA ECX,[EBP + -0x2c]
009d7217 : CALL 0x00406460
009d721c : MOV dword ptr [EBP + -0x4],0x1
009d7223 : MOV EAX,[0x00da9894]
009d7228 : MOV EAX,dword ptr [EAX]
009d722a : MOV ECX,dword ptr [EAX + 0x1a8]
009d7230 : MOV EDX,dword ptr [ECX]
009d7232 : MOV EDX,dword ptr [EDX + 0x44]
009d7235 : PUSH 0x13
009d7237 : LEA EAX,[EBP + -0x2c]
009d723a : PUSH EAX
009d723b : CALL EDX
009d723d : MOV dword ptr [EBP + -0x4],0xffffffff
009d7244 : CMP dword ptr [EBP + -0x14],EBX
009d7247 : JC 0x009d7251
009d7249 : MOV ECX,dword ptr [EBP + -0x28]
009d724c : CALL 0x006f04e0
009d7251 : XOR EAX,EAX
009d7253 : MOV dword ptr [EBP + -0x14],0x7
009d725a : MOV dword ptr [EBP + -0x18],0x0
009d7261 : MOV word ptr [EBP + -0x28],AX
009d7265 : MOV ECX,dword ptr [EBP + -0xc]
009d7268 : MOV dword ptr FS:[0x0],ECX
009d726f : POP ECX
009d7270 : POP EDI
009d7271 : POP ESI
009d7272 : POP EBX
009d7273 : MOV ESP,EBP
009d7275 : POP EBP
009d7276 : RET 0x8

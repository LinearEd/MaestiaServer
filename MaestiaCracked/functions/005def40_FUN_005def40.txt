PROGRAM  : Maestia.exe
FUNCTION : FUN_005def40
ENTRY    : 005def40
BODY     : [[005def40, 005df027]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005def40(int param_1)

{
  char cVar1;
  int *piVar2;
  uint uVar3;
  int iVar4;
  undefined4 *in_ECX;
  ushort uVar5;
  
  piVar2 = (int *)*in_ECX;
  in_ECX[1] = param_1;
  uVar3 = (uint)*(char *)(param_1 + *piVar2);
  uVar5 = (ushort)((int)uVar3 >> 1);
  if ((uVar3 & 1) == 0) {
    iVar4 = 1;
  }
  else {
    uVar5 = (short)((char *)(param_1 + *piVar2))[1] << 7 | uVar5 & 0x7f;
    iVar4 = 2;
  }
  param_1 = param_1 + iVar4;
  *(ushort *)(in_ECX + 2) = uVar5;
  in_ECX[1] = param_1;
  uVar3 = (uint)*(char *)(*piVar2 + param_1);
  uVar5 = (ushort)((int)uVar3 >> 1);
  if ((uVar3 & 1) == 0) {
    iVar4 = 1;
  }
  else {
    uVar5 = (short)*(char *)(*piVar2 + param_1 + 1) << 7 | uVar5 & 0x7f;
    iVar4 = 2;
  }
  param_1 = param_1 + iVar4;
  *(ushort *)((int)in_ECX + 10) = uVar5;
  in_ECX[1] = param_1;
  uVar3 = (uint)*(char *)(param_1 + *piVar2);
  uVar5 = (ushort)((int)uVar3 >> 1);
  if ((uVar3 & 1) == 0) {
    iVar4 = 1;
  }
  else {
    uVar5 = (short)((char *)(param_1 + *piVar2))[1] << 7 | uVar5 & 0x7f;
    iVar4 = 2;
  }
  param_1 = param_1 + iVar4;
  *(ushort *)(in_ECX + 3) = uVar5;
  in_ECX[1] = param_1;
  uVar3 = (uint)*(char *)(*piVar2 + param_1);
  uVar5 = (ushort)((int)uVar3 >> 1);
  if ((uVar3 & 1) == 0) {
    in_ECX[1] = param_1 + 1;
    *(ushort *)((int)in_ECX + 0xe) = uVar5;
    return;
  }
  cVar1 = *(char *)(*piVar2 + param_1 + 1);
  in_ECX[1] = param_1 + 2;
  *(ushort *)((int)in_ECX + 0xe) = (short)cVar1 << 7 | uVar5 & 0x7f;
  return;
}



============================================================
DISASSEMBLY
============================================================
005def40 : PUSH ESI
005def41 : MOV ESI,dword ptr [ESP + 0x8]
005def45 : PUSH EDI
005def46 : MOV EDI,dword ptr [ECX]
005def48 : MOV dword ptr [ECX + 0x4],ESI
005def4b : MOV EAX,dword ptr [EDI]
005def4d : LEA EDX,[ESI + EAX*0x1]
005def50 : MOVSX EAX,byte ptr [EDX]
005def53 : TEST AL,0x1
005def55 : JNZ 0x005def62
005def57 : SAR EAX,0x1
005def59 : MOV EDX,EAX
005def5b : MOV EAX,0x1
005def60 : JMP 0x005def75
005def62 : MOVSX EDX,byte ptr [EDX + 0x1]
005def66 : SAR EAX,0x1
005def68 : AND EAX,0x7f
005def6b : SHL EDX,0x7
005def6e : OR EDX,EAX
005def70 : MOV EAX,0x2
005def75 : ADD ESI,EAX
005def77 : MOV word ptr [ECX + 0x8],DX
005def7b : MOV dword ptr [ECX + 0x4],ESI
005def7e : MOV EDX,dword ptr [EDI]
005def80 : MOVSX EAX,byte ptr [EDX + ESI*0x1]
005def84 : ADD EDX,ESI
005def86 : TEST AL,0x1
005def88 : JNZ 0x005def95
005def8a : SAR EAX,0x1
005def8c : MOV EDX,EAX
005def8e : MOV EAX,0x1
005def93 : JMP 0x005defa8
005def95 : MOVSX EDX,byte ptr [EDX + 0x1]
005def99 : SAR EAX,0x1
005def9b : AND EAX,0x7f
005def9e : SHL EDX,0x7
005defa1 : OR EDX,EAX
005defa3 : MOV EAX,0x2
005defa8 : ADD ESI,EAX
005defaa : MOV word ptr [ECX + 0xa],DX
005defae : MOV dword ptr [ECX + 0x4],ESI
005defb1 : MOV EAX,dword ptr [EDI]
005defb3 : LEA EDX,[ESI + EAX*0x1]
005defb6 : MOVSX EAX,byte ptr [EDX]
005defb9 : TEST AL,0x1
005defbb : JNZ 0x005defc8
005defbd : SAR EAX,0x1
005defbf : MOV EDX,EAX
005defc1 : MOV EAX,0x1
005defc6 : JMP 0x005defdb
005defc8 : MOVSX EDX,byte ptr [EDX + 0x1]
005defcc : SAR EAX,0x1
005defce : AND EAX,0x7f
005defd1 : SHL EDX,0x7
005defd4 : OR EDX,EAX
005defd6 : MOV EAX,0x2
005defdb : ADD ESI,EAX
005defdd : MOV word ptr [ECX + 0xc],DX
005defe1 : MOV dword ptr [ECX + 0x4],ESI
005defe4 : MOV EDX,dword ptr [EDI]
005defe6 : MOVSX EAX,byte ptr [EDX + ESI*0x1]
005defea : ADD EDX,ESI
005defec : TEST AL,0x1
005defee : JNZ 0x005df007
005deff0 : SAR EAX,0x1
005deff2 : MOV EDX,EAX
005deff4 : MOV EAX,0x1
005deff9 : ADD ESI,EAX
005deffb : POP EDI
005deffc : MOV dword ptr [ECX + 0x4],ESI
005defff : MOV word ptr [ECX + 0xe],DX
005df003 : POP ESI
005df004 : RET 0x4
005df007 : MOVSX EDX,byte ptr [EDX + 0x1]
005df00b : SAR EAX,0x1
005df00d : AND EAX,0x7f
005df010 : SHL EDX,0x7
005df013 : OR EDX,EAX
005df015 : MOV EAX,0x2
005df01a : ADD ESI,EAX
005df01c : POP EDI
005df01d : MOV dword ptr [ECX + 0x4],ESI
005df020 : MOV word ptr [ECX + 0xe],DX
005df024 : POP ESI
005df025 : RET 0x4

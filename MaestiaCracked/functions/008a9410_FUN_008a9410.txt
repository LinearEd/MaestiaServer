PROGRAM  : Maestia.exe
FUNCTION : FUN_008a9410
ENTRY    : 008a9410
BODY     : [[008a9410, 008a960d]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_008a9410(int param_1,ushort *param_2)

{
  short sVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  short *psVar5;
  ushort *puVar6;
  uint uVar7;
  undefined **local_4030 [4];
  undefined4 local_4020;
  uint local_401c;
  int local_4018;
  ushort *local_4014;
  int local_4010;
  undefined2 uStack_400a;
  wchar_t local_4008 [8192];
  uint local_8;
  
  local_8 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  uVar7 = (*param_2 & 0x1fff) - 10;
  local_4014 = param_2;
  puVar6 = param_2 + 5;
  local_4030[0] = &PTR_DAT_00c4ae00;
  local_4030[1] = &PTR_LAB_00c4ae04;
  local_4030[2] = &PTR_DAT_00c4ae08;
  local_4030[3] = (undefined **)&DAT_00c4ae0c;
  local_4008[0] = L'\0';
  local_4010 = 0;
  local_4018 = 0;
  if (*(char *)((int)param_2 + 9) != '\0') {
    do {
      if ((puVar6 == (ushort *)0x0) || (uVar7 < 4)) {
LAB_008a9526:
        iVar3 = 0;
LAB_008a9528:
        psVar5 = (short *)0x0;
LAB_008a952a:
        uVar7 = 0;
        puVar6 = (ushort *)0x0;
      }
      else {
        local_4020 = *(undefined4 *)puVar6;
        if ((puVar6 + 2 == (ushort *)0x0) || (uVar7 == 4)) goto LAB_008a9526;
        uVar7 = uVar7 - 5;
        uStack_400a._1_1_ = (byte)puVar6[2];
        if (((((short *)((int)puVar6 + 5) == (short *)0x0) || (uVar7 < 2)) ||
            (sVar1 = *(short *)((int)puVar6 + 5), sVar1 < 0)) ||
           (iVar3 = (int)sVar1, (int)uVar7 < iVar3 + 2)) goto LAB_008a9526;
        psVar5 = (short *)((int)puVar6 + iVar3 + 7);
        uVar7 = uVar7 + (-2 - iVar3);
        iVar3 = (int)puVar6 + 7;
        if (((psVar5 == (short *)0x0) || (uVar7 < 2)) ||
           ((*psVar5 < 0 || (iVar4 = (int)*psVar5, (int)uVar7 < iVar4 + 2)))) goto LAB_008a9528;
        uVar7 = uVar7 + (-2 - iVar4);
        puVar6 = (ushort *)((int)psVar5 + iVar4 + 2);
        psVar5 = psVar5 + 1;
        if ((puVar6 == (ushort *)0x0) || (uVar7 < 2)) goto LAB_008a952a;
        uVar7 = uVar7 - 2;
        local_401c = (uint)*puVar6;
        puVar6 = puVar6 + 1;
      }
      iVar3 = __snwprintf(local_4008 + local_4010,0x2000 - local_4010,L"%d&%d&%s&%s&%S|",local_4020,
                          (uint)uStack_400a._1_1_,iVar3,psVar5,local_4030[local_401c - 1 & 0xffff]);
      local_4010 = local_4010 + iVar3;
      local_4018 = local_4018 + 1;
    } while (local_4018 < (int)(uint)*(byte *)((int)local_4014 + 9));
    if (0 < local_4010) {
      (&uStack_400a)[local_4010] = 0;
    }
  }
  if (((*(char *)(param_1 + 0x32) != '\0') && (*DAT_00da9894 != 0)) &&
     (piVar2 = *(int **)(*DAT_00da9894 + 0x114), piVar2 != (int *)0x0)) {
    (**(code **)(*piVar2 + 4))
              (piVar2,"mc_guildmanage.guildJoinRequest.OnJoinRequestList","%d,%d,%ls",
               (char)local_4014[2],*(undefined4 *)((int)local_4014 + 5),local_4008);
  }
  __security_check_cookie(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008a9410 : PUSH EBP
008a9411 : MOV EBP,ESP
008a9413 : MOV EAX,0x402c
008a9418 : CALL 0x0063b780
008a941d : MOV EAX,[0x00d66fa0]
008a9422 : XOR EAX,EBP
008a9424 : MOV dword ptr [EBP + -0x4],EAX
008a9427 : MOV EAX,dword ptr [EBP + 0xc]
008a942a : PUSH ESI
008a942b : PUSH EDI
008a942c : MOVZX EDI,word ptr [EAX]
008a942f : XOR ECX,ECX
008a9431 : AND EDI,0x1fff
008a9437 : SUB EDI,0xa
008a943a : MOV dword ptr [EBP + 0xffffbff0],EAX
008a9440 : LEA ESI,[EAX + 0xa]
008a9443 : MOV dword ptr [EBP + 0xffffbfd4],0xc4ae00
008a944d : MOV dword ptr [EBP + 0xffffbfd8],0xc4ae04
008a9457 : MOV dword ptr [EBP + 0xffffbfdc],0xc4ae08
008a9461 : MOV dword ptr [EBP + 0xffffbfe0],0xc4ae0c
008a946b : MOV word ptr [EBP + 0xffffbffc],CX
008a9472 : MOV dword ptr [EBP + 0xffffbff4],ECX
008a9478 : MOV dword ptr [EBP + 0xffffbfec],ECX
008a947e : CMP byte ptr [EAX + 0x9],CL
008a9481 : JBE 0x008a95b8
008a9487 : PUSH EBX
008a9488 : TEST ESI,ESI
008a948a : JZ 0x008a9526
008a9490 : CMP EDI,0x4
008a9493 : JC 0x008a9526
008a9499 : MOV EDX,dword ptr [ESI]
008a949b : SUB EDI,0x4
008a949e : ADD ESI,0x4
008a94a1 : MOV dword ptr [EBP + 0xffffbfe4],EDX
008a94a7 : JZ 0x008a9526
008a94a9 : CMP EDI,0x1
008a94ac : JC 0x008a9526
008a94ae : MOV AL,byte ptr [ESI]
008a94b0 : DEC EDI
008a94b1 : ADD ESI,0x1
008a94b4 : MOV byte ptr [EBP + 0xffffbffb],AL
008a94ba : JZ 0x008a9526
008a94bc : CMP EDI,0x2
008a94bf : JC 0x008a9526
008a94c1 : MOVZX EAX,word ptr [ESI]
008a94c4 : TEST AX,AX
008a94c7 : JL 0x008a9526
008a94c9 : CWDE
008a94ca : LEA ECX,[EAX + 0x2]
008a94cd : CMP EDI,ECX
008a94cf : JL 0x008a9526
008a94d1 : MOV EDX,0xfffffffe
008a94d6 : SUB EDX,EAX
008a94d8 : LEA EAX,[ESI + EAX*0x1 + 0x2]
008a94dc : ADD EDI,EDX
008a94de : LEA EBX,[ESI + 0x2]
008a94e1 : TEST EAX,EAX
008a94e3 : JZ 0x008a9528
008a94e5 : CMP EDI,0x2
008a94e8 : JC 0x008a9528
008a94ea : MOVZX ECX,word ptr [EAX]
008a94ed : TEST CX,CX
008a94f0 : JL 0x008a9528
008a94f2 : MOVSX ECX,CX
008a94f5 : LEA EDX,[ECX + 0x2]
008a94f8 : CMP EDI,EDX
008a94fa : JL 0x008a9528
008a94fc : MOV ESI,0xfffffffe
008a9501 : SUB ESI,ECX
008a9503 : ADD EDI,ESI
008a9505 : LEA ESI,[EAX + ECX*0x1 + 0x2]
008a9509 : LEA EDX,[EAX + 0x2]
008a950c : TEST ESI,ESI
008a950e : JZ 0x008a952a
008a9510 : CMP EDI,0x2
008a9513 : JC 0x008a952a
008a9515 : MOVZX EAX,word ptr [ESI]
008a9518 : SUB EDI,0x2
008a951b : MOV dword ptr [EBP + 0xffffbfe8],EAX
008a9521 : ADD ESI,0x2
008a9524 : JMP 0x008a952e
008a9526 : XOR EBX,EBX
008a9528 : XOR EDX,EDX
008a952a : XOR EDI,EDI
008a952c : XOR ESI,ESI
008a952e : MOV ECX,dword ptr [EBP + 0xffffbfe8]
008a9534 : DEC ECX
008a9535 : MOVZX EAX,CX
008a9538 : MOV ECX,dword ptr [EBP + EAX*0x4 + 0xffffbfd4]
008a953f : MOV EAX,dword ptr [EBP + 0xffffbfe4]
008a9545 : PUSH ECX
008a9546 : PUSH EDX
008a9547 : MOVZX EDX,byte ptr [EBP + 0xffffbffb]
008a954e : PUSH EBX
008a954f : PUSH EDX
008a9550 : PUSH EAX
008a9551 : MOV EAX,dword ptr [EBP + 0xffffbff4]
008a9557 : MOV ECX,0x2000
008a955c : PUSH 0xc4ae10
008a9561 : SUB ECX,EAX
008a9563 : PUSH ECX
008a9564 : LEA EDX,[EBP + EAX*0x2 + 0xffffbffc]
008a956b : PUSH EDX
008a956c : CALL 0x006343c8
008a9571 : ADD dword ptr [EBP + 0xffffbff4],EAX
008a9577 : MOV ECX,dword ptr [EBP + 0xffffbff0]
008a957d : MOV EAX,dword ptr [EBP + 0xffffbfec]
008a9583 : MOVZX EDX,byte ptr [ECX + 0x9]
008a9587 : INC EAX
008a9588 : ADD ESP,0x20
008a958b : CMP EAX,EDX
008a958d : MOV dword ptr [EBP + 0xffffbfec],EAX
008a9593 : JL 0x008a9488
008a9599 : MOV EAX,dword ptr [EBP + 0xffffbff4]
008a959f : POP EBX
008a95a0 : TEST EAX,EAX
008a95a2 : JLE 0x008a95b6
008a95a4 : XOR ECX,ECX
008a95a6 : MOV word ptr [EBP + EAX*0x2 + 0xffffbffa],CX
008a95ae : MOV EAX,dword ptr [EBP + 0xffffbff0]
008a95b4 : JMP 0x008a95b8
008a95b6 : MOV EAX,ECX
008a95b8 : MOV EDX,dword ptr [EBP + 0x8]
008a95bb : CMP byte ptr [EDX + 0x32],0x0
008a95bf : JZ 0x008a95fc
008a95c1 : MOV ECX,dword ptr [0x00da9894]
008a95c7 : MOV ECX,dword ptr [ECX]
008a95c9 : TEST ECX,ECX
008a95cb : JZ 0x008a95fc
008a95cd : MOV ECX,dword ptr [ECX + 0x114]
008a95d3 : TEST ECX,ECX
008a95d5 : JZ 0x008a95fc
008a95d7 : MOV EDX,dword ptr [ECX]
008a95d9 : LEA ESI,[EBP + 0xffffbffc]
008a95df : PUSH ESI
008a95e0 : MOV ESI,dword ptr [EAX + 0x5]
008a95e3 : MOVZX EAX,byte ptr [EAX + 0x4]
008a95e7 : PUSH ESI
008a95e8 : PUSH EAX
008a95e9 : PUSH 0xc4ae30
008a95ee : PUSH 0xc4ae3c
008a95f3 : PUSH ECX
008a95f4 : MOV ECX,dword ptr [EDX + 0x4]
008a95f7 : CALL ECX
008a95f9 : ADD ESP,0x18
008a95fc : MOV ECX,dword ptr [EBP + -0x4]
008a95ff : POP EDI
008a9600 : XOR ECX,EBP
008a9602 : POP ESI
008a9603 : CALL 0x00633e6b
008a9608 : MOV ESP,EBP
008a960a : POP EBP
008a960b : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_006d5a90
ENTRY    : 006d5a90
BODY     : [[006d5a90, 006d5ce3]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_006d5a90(void)

{
  undefined1 uVar1;
  byte bVar2;
  undefined4 *puVar3;
  int iVar4;
  int iVar5;
  char cVar6;
  int iVar7;
  int iVar8;
  undefined1 *puVar9;
  byte *pbVar10;
  int iVar11;
  ushort uVar12;
  uint uVar13;
  ushort *puVar14;
  int *unaff_EDI;
  int *piStack_c;
  int iStack_8;
  
  puVar3 = (undefined4 *)unaff_EDI[6];
  iVar11 = puVar3[1];
  puVar9 = (undefined1 *)*puVar3;
  if (iVar11 == 0) {
    cVar6 = (*(code *)puVar3[3])();
    if (cVar6 == '\0') {
      return 0;
    }
    puVar9 = (undefined1 *)*puVar3;
    iVar11 = puVar3[1];
  }
  uVar1 = *puVar9;
  iVar11 = iVar11 + -1;
  puVar9 = puVar9 + 1;
  if (iVar11 == 0) {
    cVar6 = (*(code *)puVar3[3])();
    if (cVar6 == '\0') {
      return 0;
    }
    puVar9 = (undefined1 *)*puVar3;
    iVar11 = puVar3[1];
  }
  iVar11 = iVar11 + -1;
  pbVar10 = puVar9 + 1;
  iVar8 = CONCAT11(uVar1,*puVar9) - 2;
  do {
    iVar5 = iVar8;
    if (iVar5 < 1) {
      if (iVar5 != 0) {
        *(undefined4 *)(*unaff_EDI + 0x14) = 0xb;
        (**(code **)*unaff_EDI)();
      }
      *puVar3 = pbVar10;
      puVar3[1] = iVar11;
      return 1;
    }
    if (iVar11 == 0) {
      cVar6 = (*(code *)puVar3[3])();
      if (cVar6 == '\0') {
        return 0;
      }
      pbVar10 = (byte *)*puVar3;
      iVar11 = puVar3[1];
    }
    bVar2 = *pbVar10;
    *(undefined4 *)(*unaff_EDI + 0x14) = 0x51;
    iVar7 = (int)(uint)bVar2 >> 4;
    uVar13 = bVar2 & 0xf;
    *(uint *)(*unaff_EDI + 0x18) = uVar13;
    *(int *)(*unaff_EDI + 0x1c) = iVar7;
    iVar11 = iVar11 + -1;
    pbVar10 = pbVar10 + 1;
    (**(code **)(*unaff_EDI + 4))();
    if (3 < uVar13) {
      *(undefined4 *)(*unaff_EDI + 0x14) = 0x1f;
      *(uint *)(*unaff_EDI + 0x18) = uVar13;
      (**(code **)*unaff_EDI)();
    }
    if (unaff_EDI[uVar13 + 0x24] == 0) {
      iVar8 = FUN_006d9540();
      unaff_EDI[uVar13 + 0x24] = iVar8;
    }
    iVar8 = unaff_EDI[uVar13 + 0x24];
    piStack_c = &DAT_00bf1570;
    do {
      if (iVar7 == 0) {
        if (iVar11 == 0) {
          cVar6 = (*(code *)puVar3[3])();
          if (cVar6 == '\0') {
            return 0;
          }
          pbVar10 = (byte *)*puVar3;
          iVar11 = puVar3[1];
        }
        uVar12 = (ushort)*pbVar10;
      }
      else {
        if (iVar11 == 0) {
          cVar6 = (*(code *)puVar3[3])();
          if (cVar6 == '\0') {
            return 0;
          }
          pbVar10 = (byte *)*puVar3;
          iVar11 = puVar3[1];
        }
        bVar2 = *pbVar10;
        iVar11 = iVar11 + -1;
        pbVar10 = pbVar10 + 1;
        if (iVar11 == 0) {
          cVar6 = (*(code *)puVar3[3])();
          if (cVar6 == '\0') {
            return 0;
          }
          pbVar10 = (byte *)*puVar3;
          iVar11 = puVar3[1];
        }
        uVar12 = CONCAT11(bVar2,*pbVar10);
      }
      iVar4 = *piStack_c;
      piStack_c = piStack_c + 1;
      iVar11 = iVar11 + -1;
      pbVar10 = pbVar10 + 1;
      *(ushort *)(iVar8 + iVar4 * 2) = uVar12;
    } while ((int)piStack_c < 0xbf1670);
    if (1 < *(int *)(*unaff_EDI + 0x68)) {
      puVar14 = (ushort *)(iVar8 + 4);
      iStack_8 = 8;
      do {
        iVar8 = *unaff_EDI;
        *(uint *)(iVar8 + 0x18) = (uint)puVar14[-2];
        *(uint *)(iVar8 + 0x1c) = (uint)puVar14[-1];
        *(uint *)(iVar8 + 0x20) = (uint)*puVar14;
        *(uint *)(iVar8 + 0x24) = (uint)puVar14[1];
        *(uint *)(iVar8 + 0x28) = (uint)puVar14[2];
        *(uint *)(iVar8 + 0x2c) = (uint)puVar14[3];
        *(uint *)(iVar8 + 0x30) = (uint)puVar14[4];
        *(uint *)(iVar8 + 0x34) = (uint)puVar14[5];
        *(undefined4 *)(*unaff_EDI + 0x14) = 0x5d;
        (**(code **)(*unaff_EDI + 4))();
        puVar14 = puVar14 + 8;
        iStack_8 = iStack_8 + -1;
      } while (iStack_8 != 0);
    }
    iVar8 = iVar5 + -0x41;
    if (iVar7 != 0) {
      iVar8 = iVar5 + -0x81;
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
006d5a90 : SUB ESP,0x14
006d5a93 : PUSH EBX
006d5a94 : PUSH EBP
006d5a95 : PUSH ESI
006d5a96 : MOV ESI,dword ptr [EDI + 0x18]
006d5a99 : MOV EBP,dword ptr [ESI + 0x4]
006d5a9c : MOV EBX,dword ptr [ESI]
006d5a9e : MOV dword ptr [ESP + 0x10],ESI
006d5aa2 : TEST EBP,EBP
006d5aa4 : JNZ 0x006d5ac1
006d5aa6 : MOV EAX,dword ptr [ESI + 0xc]
006d5aa9 : PUSH EDI
006d5aaa : CALL EAX
006d5aac : ADD ESP,0x4
006d5aaf : TEST AL,AL
006d5ab1 : JNZ 0x006d5abc
006d5ab3 : POP ESI
006d5ab4 : POP EBP
006d5ab5 : XOR AL,AL
006d5ab7 : POP EBX
006d5ab8 : ADD ESP,0x14
006d5abb : RET
006d5abc : MOV EBX,dword ptr [ESI]
006d5abe : MOV EBP,dword ptr [ESI + 0x4]
006d5ac1 : MOVZX EAX,byte ptr [EBX]
006d5ac4 : DEC EBP
006d5ac5 : SHL EAX,0x8
006d5ac8 : INC EBX
006d5ac9 : MOV dword ptr [ESP + 0xc],EAX
006d5acd : TEST EBP,EBP
006d5acf : JNZ 0x006d5ae7
006d5ad1 : MOV ECX,dword ptr [ESI + 0xc]
006d5ad4 : PUSH EDI
006d5ad5 : CALL ECX
006d5ad7 : ADD ESP,0x4
006d5ada : TEST AL,AL
006d5adc : JZ 0x006d5ab3
006d5ade : MOV EBX,dword ptr [ESI]
006d5ae0 : MOV EBP,dword ptr [ESI + 0x4]
006d5ae3 : MOV EAX,dword ptr [ESP + 0xc]
006d5ae7 : MOVZX EDX,byte ptr [EBX]
006d5aea : ADD EAX,EDX
006d5aec : SUB EAX,0x2
006d5aef : DEC EBP
006d5af0 : INC EBX
006d5af1 : MOV dword ptr [ESP + 0xc],EAX
006d5af5 : TEST EAX,EAX
006d5af7 : JLE 0x006d5cc1
006d5afd : LEA ECX,[ECX]
006d5b00 : TEST EBP,EBP
006d5b02 : JNZ 0x006d5b16
006d5b04 : MOV EAX,dword ptr [ESI + 0xc]
006d5b07 : PUSH EDI
006d5b08 : CALL EAX
006d5b0a : ADD ESP,0x4
006d5b0d : TEST AL,AL
006d5b0f : JZ 0x006d5ab3
006d5b11 : MOV EBX,dword ptr [ESI]
006d5b13 : MOV EBP,dword ptr [ESI + 0x4]
006d5b16 : MOVZX ESI,byte ptr [EBX]
006d5b19 : MOV ECX,dword ptr [EDI]
006d5b1b : MOV dword ptr [ECX + 0x14],0x51
006d5b22 : MOV EDX,dword ptr [EDI]
006d5b24 : MOV EAX,ESI
006d5b26 : SAR EAX,0x4
006d5b29 : AND ESI,0xf
006d5b2c : MOV dword ptr [EDX + 0x18],ESI
006d5b2f : MOV ECX,dword ptr [EDI]
006d5b31 : MOV dword ptr [ECX + 0x1c],EAX
006d5b34 : MOV EDX,dword ptr [EDI]
006d5b36 : MOV dword ptr [ESP + 0x1c],EAX
006d5b3a : MOV EAX,dword ptr [EDX + 0x4]
006d5b3d : PUSH 0x1
006d5b3f : PUSH EDI
006d5b40 : DEC EBP
006d5b41 : INC EBX
006d5b42 : CALL EAX
006d5b44 : ADD ESP,0x8
006d5b47 : CMP ESI,0x4
006d5b4a : JL 0x006d5b64
006d5b4c : MOV ECX,dword ptr [EDI]
006d5b4e : MOV dword ptr [ECX + 0x14],0x1f
006d5b55 : MOV EDX,dword ptr [EDI]
006d5b57 : MOV dword ptr [EDX + 0x18],ESI
006d5b5a : MOV EAX,dword ptr [EDI]
006d5b5c : MOV ECX,dword ptr [EAX]
006d5b5e : PUSH EDI
006d5b5f : CALL ECX
006d5b61 : ADD ESP,0x4
006d5b64 : CMP dword ptr [EDI + ESI*0x4 + 0x90],0x0
006d5b6c : JNZ 0x006d5b7e
006d5b6e : PUSH EDI
006d5b6f : CALL 0x006d9540
006d5b74 : ADD ESP,0x4
006d5b77 : MOV dword ptr [EDI + ESI*0x4 + 0x90],EAX
006d5b7e : MOV EDX,dword ptr [EDI + ESI*0x4 + 0x90]
006d5b85 : MOV dword ptr [ESP + 0x18],EDX
006d5b89 : MOV dword ptr [ESP + 0x14],0xbf1570
006d5b91 : CMP dword ptr [ESP + 0x1c],0x0
006d5b96 : JZ 0x006d5be4
006d5b98 : TEST EBP,EBP
006d5b9a : JNZ 0x006d5bb6
006d5b9c : MOV ESI,dword ptr [ESP + 0x10]
006d5ba0 : MOV EAX,dword ptr [ESI + 0xc]
006d5ba3 : PUSH EDI
006d5ba4 : CALL EAX
006d5ba6 : ADD ESP,0x4
006d5ba9 : TEST AL,AL
006d5bab : JZ 0x006d5ab3
006d5bb1 : MOV EBX,dword ptr [ESI]
006d5bb3 : MOV EBP,dword ptr [ESI + 0x4]
006d5bb6 : MOVZX ESI,byte ptr [EBX]
006d5bb9 : DEC EBP
006d5bba : SHL ESI,0x8
006d5bbd : INC EBX
006d5bbe : TEST EBP,EBP
006d5bc0 : JNZ 0x006d5bdd
006d5bc2 : MOV EBP,dword ptr [ESP + 0x10]
006d5bc6 : MOV ECX,dword ptr [EBP + 0xc]
006d5bc9 : PUSH EDI
006d5bca : CALL ECX
006d5bcc : ADD ESP,0x4
006d5bcf : TEST AL,AL
006d5bd1 : JZ 0x006d5ab3
006d5bd7 : MOV EBX,dword ptr [EBP]
006d5bda : MOV EBP,dword ptr [EBP + 0x4]
006d5bdd : MOVZX EDX,byte ptr [EBX]
006d5be0 : ADD ESI,EDX
006d5be2 : JMP 0x006d5c05
006d5be4 : TEST EBP,EBP
006d5be6 : JNZ 0x006d5c02
006d5be8 : MOV ESI,dword ptr [ESP + 0x10]
006d5bec : MOV EAX,dword ptr [ESI + 0xc]
006d5bef : PUSH EDI
006d5bf0 : CALL EAX
006d5bf2 : ADD ESP,0x4
006d5bf5 : TEST AL,AL
006d5bf7 : JZ 0x006d5ab3
006d5bfd : MOV EBX,dword ptr [ESI]
006d5bff : MOV EBP,dword ptr [ESI + 0x4]
006d5c02 : MOVZX ESI,byte ptr [EBX]
006d5c05 : MOV EAX,dword ptr [ESP + 0x14]
006d5c09 : MOV ECX,dword ptr [EAX]
006d5c0b : MOV EDX,dword ptr [ESP + 0x18]
006d5c0f : ADD EAX,0x4
006d5c12 : DEC EBP
006d5c13 : INC EBX
006d5c14 : CMP EAX,0xbf1670
006d5c19 : MOV word ptr [EDX + ECX*0x2],SI
006d5c1d : MOV dword ptr [ESP + 0x14],EAX
006d5c21 : JL 0x006d5b91
006d5c27 : MOV EAX,dword ptr [EDI]
006d5c29 : CMP dword ptr [EAX + 0x68],0x2
006d5c2d : JL 0x006d5c9b
006d5c2f : MOV ESI,EDX
006d5c31 : ADD ESI,0x4
006d5c34 : MOV dword ptr [ESP + 0x18],0x8
006d5c3c : LEA ESP,[ESP]
006d5c40 : MOV EAX,dword ptr [EDI]
006d5c42 : MOVZX ECX,word ptr [ESI + -0x4]
006d5c46 : ADD EAX,0x18
006d5c49 : MOV dword ptr [EAX],ECX
006d5c4b : MOVZX EDX,word ptr [ESI + -0x2]
006d5c4f : MOV dword ptr [EAX + 0x4],EDX
006d5c52 : MOVZX ECX,word ptr [ESI]
006d5c55 : MOV dword ptr [EAX + 0x8],ECX
006d5c58 : MOVZX EDX,word ptr [ESI + 0x2]
006d5c5c : MOV dword ptr [EAX + 0xc],EDX
006d5c5f : MOVZX ECX,word ptr [ESI + 0x4]
006d5c63 : MOV dword ptr [EAX + 0x10],ECX
006d5c66 : MOVZX EDX,word ptr [ESI + 0x6]
006d5c6a : MOV dword ptr [EAX + 0x14],EDX
006d5c6d : MOVZX ECX,word ptr [ESI + 0x8]
006d5c71 : MOV dword ptr [EAX + 0x18],ECX
006d5c74 : MOVZX EDX,word ptr [ESI + 0xa]
006d5c78 : MOV dword ptr [EAX + 0x1c],EDX
006d5c7b : MOV EAX,dword ptr [EDI]
006d5c7d : MOV dword ptr [EAX + 0x14],0x5d
006d5c84 : MOV ECX,dword ptr [EDI]
006d5c86 : MOV EDX,dword ptr [ECX + 0x4]
006d5c89 : PUSH 0x2
006d5c8b : PUSH EDI
006d5c8c : CALL EDX
006d5c8e : ADD ESP,0x8
006d5c91 : ADD ESI,0x10
006d5c94 : SUB dword ptr [ESP + 0x18],0x1
006d5c99 : JNZ 0x006d5c40
006d5c9b : SUB dword ptr [ESP + 0xc],0x41
006d5ca0 : CMP dword ptr [ESP + 0x1c],0x0
006d5ca5 : JZ 0x006d5cac
006d5ca7 : SUB dword ptr [ESP + 0xc],0x40
006d5cac : CMP dword ptr [ESP + 0xc],0x0
006d5cb1 : MOV ESI,dword ptr [ESP + 0x10]
006d5cb5 : JG 0x006d5b00
006d5cbb : MOV EAX,dword ptr [ESP + 0xc]
006d5cbf : TEST EAX,EAX
006d5cc1 : JZ 0x006d5cd6
006d5cc3 : MOV EAX,dword ptr [EDI]
006d5cc5 : MOV dword ptr [EAX + 0x14],0xb
006d5ccc : MOV ECX,dword ptr [EDI]
006d5cce : MOV EDX,dword ptr [ECX]
006d5cd0 : PUSH EDI
006d5cd1 : CALL EDX
006d5cd3 : ADD ESP,0x4
006d5cd6 : MOV dword ptr [ESI],EBX
006d5cd8 : MOV dword ptr [ESI + 0x4],EBP
006d5cdb : POP ESI
006d5cdc : POP EBP
006d5cdd : MOV AL,0x1
006d5cdf : POP EBX
006d5ce0 : ADD ESP,0x14
006d5ce3 : RET

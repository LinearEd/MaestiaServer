PROGRAM  : Maestia.exe
FUNCTION : FUN_008bb1a0
ENTRY    : 008bb1a0
BODY     : [[008bb1a0, 008bb321]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008bb1a0(void)

{
  int iVar1;
  char cVar2;
  uint uVar3;
  undefined4 uVar4;
  undefined1 local_450 [4];
  undefined2 local_44c;
  undefined4 local_43c;
  uint local_438;
  int local_434;
  undefined1 local_430 [4];
  undefined2 local_42c;
  undefined4 local_41c;
  uint local_418;
  WCHAR local_414 [512];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  iVar1 = DAT_00da989c;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3e66f;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_418 = 7;
  local_41c = 0;
  local_42c = 0;
  local_14 = uVar3;
  FUN_00406360(&DAT_00c4cc50,1);
  local_8 = 0;
  GetCurrentDirectoryW(0x200,local_414);
  uVar4 = FUN_00403380(local_450,local_430,uVar3);
  local_8._0_1_ = 1;
  FUN_00405eb0(uVar4,0,0xffffffff);
  local_8 = (uint)local_8._1_3_ << 8;
  if (7 < local_438) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_44c = 0;
  local_438 = 7;
  local_43c = 0;
  FUN_00406360(&DAT_00c4cc54,3);
  cVar2 = FUN_008bafb0(iVar1);
  if (cVar2 == '\0') {
    FUN_008b8930(iVar1);
  }
  FUN_008baaf0(iVar1);
  FUN_008b79a0(iVar1);
  FUN_00418ee0(iVar1 + 4,&local_434);
  if (*(char *)(iVar1 + 0x144) == '\0') {
    FUN_00405eb0(local_434 + 0x28,0,0xffffffff);
  }
  local_8 = 0xffffffff;
  if (7 < local_418) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_418 = 7;
  local_41c = 0;
  local_42c = 0;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008bb1a0 : PUSH EBP
008bb1a1 : MOV EBP,ESP
008bb1a3 : PUSH -0x1
008bb1a5 : PUSH 0xb3e66f
008bb1aa : MOV EAX,FS:[0x0]
008bb1b0 : PUSH EAX
008bb1b1 : SUB ESP,0x440
008bb1b7 : MOV EAX,[0x00d66fa0]
008bb1bc : XOR EAX,EBP
008bb1be : MOV dword ptr [EBP + -0x10],EAX
008bb1c1 : PUSH EBX
008bb1c2 : PUSH ESI
008bb1c3 : PUSH EDI
008bb1c4 : PUSH EAX
008bb1c5 : LEA EAX,[EBP + -0xc]
008bb1c8 : MOV FS:[0x0],EAX
008bb1ce : MOV EDI,dword ptr [0x00da989c]
008bb1d4 : PUSH 0x1
008bb1d6 : XOR EAX,EAX
008bb1d8 : MOV ESI,0x7
008bb1dd : XOR EBX,EBX
008bb1df : PUSH 0xc4cc50
008bb1e4 : LEA ECX,[EBP + 0xfffffbd4]
008bb1ea : MOV dword ptr [EBP + 0xfffffbec],ESI
008bb1f0 : MOV dword ptr [EBP + 0xfffffbe8],EBX
008bb1f6 : MOV word ptr [EBP + 0xfffffbd8],AX
008bb1fd : CALL 0x00406360
008bb202 : MOV dword ptr [EBP + -0x4],EBX
008bb205 : LEA ECX,[EBP + 0xfffffbf0]
008bb20b : PUSH ECX
008bb20c : PUSH 0x200
008bb211 : CALL dword ptr [0x00b851d4]
008bb217 : LEA EDX,[EBP + 0xfffffbd4]
008bb21d : PUSH EDX
008bb21e : LEA EAX,[EBP + 0xfffffbb4]
008bb224 : PUSH EAX
008bb225 : LEA EDX,[EBP + 0xfffffbf0]
008bb22b : CALL 0x00403380
008bb230 : ADD ESP,0x8
008bb233 : MOV byte ptr [EBP + -0x4],0x1
008bb237 : PUSH -0x1
008bb239 : PUSH EBX
008bb23a : PUSH EAX
008bb23b : LEA ECX,[EDI + 0x2c]
008bb23e : CALL 0x00405eb0
008bb243 : MOV byte ptr [EBP + -0x4],BL
008bb246 : CMP dword ptr [EBP + 0xfffffbcc],0x8
008bb24d : JC 0x008bb25a
008bb24f : MOV ECX,dword ptr [EBP + 0xfffffbb8]
008bb255 : CALL 0x006f04e0
008bb25a : XOR ECX,ECX
008bb25c : PUSH 0x3
008bb25e : MOV word ptr [EBP + 0xfffffbb8],CX
008bb265 : PUSH 0xc4cc54
008bb26a : LEA ECX,[EDI + 0x10]
008bb26d : MOV dword ptr [EBP + 0xfffffbcc],ESI
008bb273 : MOV dword ptr [EBP + 0xfffffbc8],EBX
008bb279 : CALL 0x00406360
008bb27e : PUSH EDI
008bb27f : CALL 0x008bafb0
008bb284 : TEST AL,AL
008bb286 : JNZ 0x008bb28e
008bb288 : PUSH EDI
008bb289 : CALL 0x008b8930
008bb28e : PUSH EDI
008bb28f : CALL 0x008baaf0
008bb294 : PUSH EDI
008bb295 : CALL 0x008b79a0
008bb29a : LEA EDX,[EBP + 0xfffffbd0]
008bb2a0 : PUSH EDX
008bb2a1 : LEA EAX,[EDI + 0x4]
008bb2a4 : LEA ESI,[EDI + 0x128]
008bb2aa : PUSH EAX
008bb2ab : CALL 0x00418ee0
008bb2b0 : CMP byte ptr [EDI + 0x144],BL
008bb2b6 : JNZ 0x008bb2d0
008bb2b8 : MOV EAX,dword ptr [EBP + 0xfffffbd0]
008bb2be : PUSH -0x1
008bb2c0 : ADD EAX,0x28
008bb2c3 : PUSH EBX
008bb2c4 : PUSH EAX
008bb2c5 : LEA ECX,[EDI + 0xf0]
008bb2cb : CALL 0x00405eb0
008bb2d0 : MOV dword ptr [EBP + -0x4],0xffffffff
008bb2d7 : CMP dword ptr [EBP + 0xfffffbec],0x8
008bb2de : JC 0x008bb2eb
008bb2e0 : MOV ECX,dword ptr [EBP + 0xfffffbd8]
008bb2e6 : CALL 0x006f04e0
008bb2eb : XOR ECX,ECX
008bb2ed : MOV dword ptr [EBP + 0xfffffbec],0x7
008bb2f7 : MOV dword ptr [EBP + 0xfffffbe8],EBX
008bb2fd : MOV word ptr [EBP + 0xfffffbd8],CX
008bb304 : MOV AL,0x1
008bb306 : MOV ECX,dword ptr [EBP + -0xc]
008bb309 : MOV dword ptr FS:[0x0],ECX
008bb310 : POP ECX
008bb311 : POP EDI
008bb312 : POP ESI
008bb313 : POP EBX
008bb314 : MOV ECX,dword ptr [EBP + -0x10]
008bb317 : XOR ECX,EBP
008bb319 : CALL 0x00633e6b
008bb31e : MOV ESP,EBP
008bb320 : POP EBP
008bb321 : RET

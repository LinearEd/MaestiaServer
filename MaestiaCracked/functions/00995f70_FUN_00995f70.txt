PROGRAM  : Maestia.exe
FUNCTION : FUN_00995f70
ENTRY    : 00995f70
BODY     : [[00995f70, 0099613d]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00995f70(int param_1)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  undefined1 local_54 [24];
  uint local_3c;
  int local_38;
  uint local_34;
  int local_30;
  int local_2c;
  int local_28;
  uint local_24;
  uint local_20;
  uint local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b2112e;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (param_1 == 0) {
    FUN_00406460(L"[AvaGuiGachaBox::FindGachaItemInPocket] nBoxType is NONE. FAIL ");
    local_8 = 0;
    if ((int *)*DAT_00da98e8 != (int *)0x0) {
      (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                (L"AvaGuiGachaBox::FindGachaItemInPocket",0x17d,local_54);
    }
    local_8 = 0xffffffff;
    if (7 < local_3c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  else {
    local_38 = *DAT_00da9894;
    local_34 = *(uint *)(local_38 + 0x40);
    local_20 = 0;
    if (local_34 != 0) {
      do {
        uVar6 = local_20;
        iVar3 = FUN_008eb810(uVar2);
        if ((iVar3 != 0) && (*(char *)(iVar3 + 100) != '\0')) {
          iVar3 = *(int *)(iVar3 + 0x3c);
          if (iVar3 == 0) {
            ExceptionList = local_10;
            return 0;
          }
          local_18 = (uint)*(ushort *)(iVar3 + 0xc);
          iVar4 = *(int *)(iVar3 + 8);
          local_1c = 0;
          local_30 = iVar4;
          local_2c = iVar3;
          if ((short)iVar4 != 0) {
            do {
              local_14 = 0;
              if ((ushort)local_18 != 0) {
                iVar1 = *(int *)(iVar3 + 0xc);
                uVar6 = local_1c & 0xffff;
                iVar5 = iVar1 * iVar4;
                do {
                  iVar4 = (local_14 & 0xffff) + uVar6 * iVar1;
                  if (((((iVar4 < iVar5) && (-1 < iVar4)) &&
                       (iVar4 = *(int *)(*(int *)(iVar3 + 0x10) + iVar4 * 4), iVar4 != 0)) &&
                      ((iVar4 = *(int *)(iVar4 + 8), iVar4 != 0 &&
                       (*(uint *)(iVar4 + 0x10) >> 0x10 == 0x68e)))) &&
                     ((local_24 = *(uint *)(iVar4 + 0x10), FUN_004437f0(&local_24), iVar3 = local_2c
                      , local_28 != *(int *)(DAT_00d7c54c + 0x44) &&
                      ((*(int *)(local_28 + 0x10) != 0 &&
                       ((char)param_1 == *(char *)(*(int *)(local_28 + 0x10) + 0x7e8))))))) {
                    ExceptionList = local_10;
                    return iVar4;
                  }
                  local_14 = local_14 + 1;
                  iVar4 = local_30;
                } while ((ushort)local_14 < (ushort)local_18);
              }
              local_1c = local_1c + 1;
              uVar6 = local_20;
            } while ((ushort)local_1c < (ushort)iVar4);
          }
        }
        local_20 = uVar6 + 1;
      } while (local_20 < local_34);
    }
  }
  ExceptionList = local_10;
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00995f70 : PUSH EBP
00995f71 : MOV EBP,ESP
00995f73 : PUSH -0x1
00995f75 : PUSH 0xb2112e
00995f7a : MOV EAX,FS:[0x0]
00995f80 : PUSH EAX
00995f81 : SUB ESP,0x44
00995f84 : PUSH EBX
00995f85 : PUSH ESI
00995f86 : PUSH EDI
00995f87 : MOV EAX,[0x00d66fa0]
00995f8c : XOR EAX,EBP
00995f8e : PUSH EAX
00995f8f : LEA EAX,[EBP + -0xc]
00995f92 : MOV FS:[0x0],EAX
00995f98 : XOR EBX,EBX
00995f9a : CMP dword ptr [EBP + 0x8],EBX
00995f9d : JNZ 0x0099600a
00995f9f : PUSH 0xc862d0
00995fa4 : LEA ECX,[EBP + -0x50]
00995fa7 : CALL 0x00406460
00995fac : MOV dword ptr [EBP + -0x4],EBX
00995faf : MOV EAX,[0x00da98e8]
00995fb4 : MOV ECX,dword ptr [EAX]
00995fb6 : CMP ECX,EBX
00995fb8 : JZ 0x00995fcf
00995fba : MOV EDX,dword ptr [ECX]
00995fbc : MOV EDX,dword ptr [EDX + 0x14]
00995fbf : LEA EAX,[EBP + -0x50]
00995fc2 : PUSH EAX
00995fc3 : PUSH 0x17d
00995fc8 : PUSH 0xc86350
00995fcd : CALL EDX
00995fcf : MOV dword ptr [EBP + -0x4],0xffffffff
00995fd6 : CMP dword ptr [EBP + -0x38],0x8
00995fda : JC 0x00995fe4
00995fdc : MOV ECX,dword ptr [EBP + -0x4c]
00995fdf : CALL 0x006f04e0
00995fe4 : XOR EAX,EAX
00995fe6 : MOV dword ptr [EBP + -0x38],0x7
00995fed : MOV dword ptr [EBP + -0x3c],EBX
00995ff0 : MOV word ptr [EBP + -0x4c],AX
00995ff4 : XOR EAX,EAX
00995ff6 : MOV ECX,dword ptr [EBP + -0xc]
00995ff9 : MOV dword ptr FS:[0x0],ECX
00996000 : POP ECX
00996001 : POP EDI
00996002 : POP ESI
00996003 : POP EBX
00996004 : MOV ESP,EBP
00996006 : POP EBP
00996007 : RET 0x4
0099600a : MOV ECX,dword ptr [0x00da9894]
00996010 : MOV EAX,dword ptr [ECX]
00996012 : MOV ECX,dword ptr [EAX + 0x40]
00996015 : MOV dword ptr [EBP + -0x1c],EBX
00996018 : MOV dword ptr [EBP + -0x34],EAX
0099601b : MOV dword ptr [EBP + -0x30],ECX
0099601e : CMP ECX,EBX
00996020 : JBE 0x00995ff4
00996022 : MOV ECX,EBX
00996024 : CALL 0x008eb810
00996029 : TEST EAX,EAX
0099602b : JZ 0x00996113
00996031 : CMP byte ptr [EAX + 0x64],0x0
00996035 : JZ 0x00996113
0099603b : MOV ECX,dword ptr [EAX + 0x3c]
0099603e : MOV dword ptr [EBP + -0x28],ECX
00996041 : TEST ECX,ECX
00996043 : JZ 0x00995ff4
00996045 : MOVZX EDX,word ptr [ECX + 0xc]
00996049 : MOV ESI,dword ptr [ECX + 0x8]
0099604c : MOVZX EAX,SI
0099604f : MOV dword ptr [EBP + -0x14],EDX
00996052 : XOR EDI,EDI
00996054 : XOR EDX,EDX
00996056 : MOV dword ptr [EBP + -0x2c],ESI
00996059 : MOV dword ptr [EBP + -0x18],EDI
0099605c : CMP DX,AX
0099605f : JNC 0x00996113
00996065 : XOR EDX,EDX
00996067 : XOR EAX,EAX
00996069 : MOV dword ptr [EBP + -0x10],EDX
0099606c : CMP AX,word ptr [EBP + -0x14]
00996070 : JNC 0x00996100
00996076 : MOV EAX,dword ptr [ECX + 0xc]
00996079 : MOVZX EDI,DI
0099607c : MOV EBX,EAX
0099607e : IMUL EDI,EAX
00996081 : IMUL EBX,ESI
00996084 : MOVZX EAX,DX
00996087 : ADD EAX,EDI
00996089 : CMP EAX,EBX
0099608b : JGE 0x009960ed
0099608d : TEST EAX,EAX
0099608f : JL 0x009960ed
00996091 : MOV EDX,dword ptr [ECX + 0x10]
00996094 : MOV EAX,dword ptr [EDX + EAX*0x4]
00996097 : TEST EAX,EAX
00996099 : JZ 0x009960ed
0099609b : MOV ESI,dword ptr [EAX + 0x8]
0099609e : TEST ESI,ESI
009960a0 : JZ 0x009960ed
009960a2 : MOV EAX,dword ptr [ESI + 0x10]
009960a5 : MOV EDX,EAX
009960a7 : SHR EDX,0x10
009960aa : CMP EDX,0x68e
009960b0 : JNZ 0x009960ed
009960b2 : MOV ECX,dword ptr [0x00d7c54c]
009960b8 : MOV dword ptr [EBP + -0x20],EAX
009960bb : LEA EAX,[EBP + -0x20]
009960be : PUSH EAX
009960bf : ADD ECX,0x40
009960c2 : LEA EAX,[EBP + -0x24]
009960c5 : CALL 0x004437f0
009960ca : MOV EAX,dword ptr [EBP + -0x24]
009960cd : MOV ECX,dword ptr [0x00d7c54c]
009960d3 : CMP EAX,dword ptr [ECX + 0x44]
009960d6 : JZ 0x009960ea
009960d8 : MOV EAX,dword ptr [EAX + 0x10]
009960db : TEST EAX,EAX
009960dd : JZ 0x009960ea
009960df : MOV DL,byte ptr [EBP + 0x8]
009960e2 : CMP DL,byte ptr [EAX + 0x7e8]
009960e8 : JZ 0x00996128
009960ea : MOV ECX,dword ptr [EBP + -0x28]
009960ed : MOV EDX,dword ptr [EBP + -0x10]
009960f0 : INC EDX
009960f1 : MOV dword ptr [EBP + -0x10],EDX
009960f4 : CMP DX,word ptr [EBP + -0x14]
009960f8 : JC 0x00996084
009960fa : MOV EDI,dword ptr [EBP + -0x18]
009960fd : MOV ESI,dword ptr [EBP + -0x2c]
00996100 : MOVZX EAX,SI
00996103 : INC EDI
00996104 : MOV dword ptr [EBP + -0x18],EDI
00996107 : CMP DI,AX
0099610a : JC 0x00996065
00996110 : MOV EBX,dword ptr [EBP + -0x1c]
00996113 : INC EBX
00996114 : MOV dword ptr [EBP + -0x1c],EBX
00996117 : CMP EBX,dword ptr [EBP + -0x30]
0099611a : JNC 0x00995ff4
00996120 : MOV EAX,dword ptr [EBP + -0x34]
00996123 : JMP 0x00996022
00996128 : MOV EAX,ESI
0099612a : MOV ECX,dword ptr [EBP + -0xc]
0099612d : MOV dword ptr FS:[0x0],ECX
00996134 : POP ECX
00996135 : POP EDI
00996136 : POP ESI
00996137 : POP EBX
00996138 : MOV ESP,EBP
0099613a : POP EBP
0099613b : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_00743a90
ENTRY    : 00743a90
BODY     : [[00743a90, 00743e29] [00743e30, 00743e36]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

uint FUN_00743a90(undefined4 param_1,int *param_2,int param_3)

{
  int iVar1;
  int *piVar2;
  undefined4 *puVar3;
  undefined8 uVar4;
  uint extraout_EAX;
  uint extraout_EAX_00;
  uint uVar5;
  undefined4 *puVar6;
  int iVar7;
  int *in_ECX;
  int *piStack_40;
  int *apiStack_3c [3];
  undefined4 *puStack_30;
  int iStack_2c;
  int iStack_28;
  int iStack_24;
  int iStack_20;
  int iStack_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_00b430ad;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  _DAT_00da9b14 = _DAT_00da9b14 + 1;
  if (param_3 == 2) {
    param_3 = FUN_007f2d40(DAT_00d66fa0 ^ (uint)&stack0xffffffb0);
  }
  uVar5 = 0;
  if (param_3 != 0) {
    (**(code **)(*in_ECX + 0x140))();
    uVar5 = 0;
    apiStack_3c[0] = in_ECX;
    if (in_ECX[2] != 0) {
      EnterCriticalSection((LPCRITICAL_SECTION)(in_ECX[2] + 4));
      uVar5 = extraout_EAX;
    }
    if (in_ECX[99] != 0) {
      uStack_c = 0xffffffff;
      if (in_ECX[2] != 0) {
        LeaveCriticalSection((LPCRITICAL_SECTION)(in_ECX[2] + 4));
      }
      *(char *)(in_ECX[0x185] + 0x1ee) = (char)in_ECX[0x158];
      *(undefined1 *)(in_ECX[0x185] + 0x1ef) = *(undefined1 *)((int)in_ECX + 0x561);
      *(undefined1 *)(in_ECX[0x185] + 0x1f1) = *(undefined1 *)((int)in_ECX + 0x562);
      *(int *)(in_ECX[0x185] + 0x1d4) = in_ECX[0xe5];
      *(int *)(in_ECX[0x185] + 0x1d8) = in_ECX[0xe6];
      *(int *)(in_ECX[0x185] + 0x1dc) = in_ECX[0xe7];
      *(int *)(in_ECX[0x185] + 0x1e0) = in_ECX[0xe8];
      *(undefined1 *)(in_ECX[0x185] + 0x1f2) = *(undefined1 *)((int)in_ECX + 0x563);
      *(char *)(in_ECX[0x185] + 499) = (char)in_ECX[0x159];
      *(undefined1 *)(in_ECX[0x185] + 500) = *(undefined1 *)((int)in_ECX + 0x567);
      *(undefined1 *)(in_ECX[0x185] + 0x1f5) = *(undefined1 *)((int)in_ECX + 0x566);
      iVar7 = in_ECX[0x185];
      iStack_28 = in_ECX[0x178];
      iStack_24 = in_ECX[0x179];
      iStack_20 = in_ECX[0x17a];
      iStack_1c = in_ECX[0x17b];
      uVar4 = *(undefined8 *)(in_ECX + 0x17a);
      *(undefined8 *)(iVar7 + 0x1f8) = *(undefined8 *)(in_ECX + 0x178);
      *(undefined8 *)(iVar7 + 0x200) = uVar4;
      *(char *)(in_ECX[0x185] + 0x1ec) = (char)in_ECX[0x15a];
      *(int *)(in_ECX[0x185] + 0x1e4) = in_ECX[0x155];
      *(int *)(in_ECX[0x185] + 0x1e8) = in_ECX[0x156];
      FUN_00439630();
      iVar7 = in_ECX[0x2b];
      iVar1 = in_ECX[0x185];
      *(int *)(iVar1 + 0x210) = iVar7;
      *(int *)(iVar1 + 0x208) = iVar7;
      *(int *)(iVar1 + 0x20c) = iVar7;
      iVar7 = in_ECX[0x185];
      *(undefined4 *)(iVar7 + 0x220) = 0;
      *(undefined4 *)(iVar7 + 0x218) = 0;
      puVar6 = (undefined4 *)FUN_0045f710();
      iStack_2c = 0;
      uStack_c = 1;
      puStack_30 = puVar6;
      if (in_ECX[2] != 0) {
        EnterCriticalSection((LPCRITICAL_SECTION)(in_ECX[2] + 4));
      }
      uStack_c._0_1_ = 2;
      piStack_40 = *(int **)in_ECX[0x62];
      if (piStack_40 != (int *)in_ECX[0x62]) {
        do {
          piVar2 = (int *)piStack_40[9];
          if ((piVar2 != (int *)0x0) && (iVar7 = (**(code **)(*piVar2 + 4))(), iVar7 == 0xf)) {
            apiStack_3c[0] = piVar2;
            iVar7 = FUN_004c09c0(puVar6,puVar6[1],apiStack_3c);
            FUN_0047a1b0();
            puVar6[1] = iVar7;
            **(int **)(iVar7 + 4) = iVar7;
            puVar6 = puStack_30;
          }
          piStack_40 = (int *)*piStack_40;
        } while (piStack_40 != (int *)in_ECX[0x62]);
      }
      uStack_c = CONCAT31(uStack_c._1_3_,1);
      if (in_ECX[2] != 0) {
        LeaveCriticalSection((LPCRITICAL_SECTION)(in_ECX[2] + 4));
      }
      if (iStack_2c != 0) {
        for (puVar3 = (undefined4 *)*puVar6; puVar3 != puVar6; puVar3 = (undefined4 *)*puVar3) {
          if (puVar3[2] != 0) {
            FUN_00aca090(param_1);
          }
        }
      }
      if (*(int *)(in_ECX[0x185] + 0x220) != 0) {
        (**(code **)(*param_2 + 0x10))(in_ECX[0x185],param_1,0);
      }
      uStack_c = 0xffffffff;
      puVar3 = (undefined4 *)*puVar6;
      *puVar6 = puVar6;
      puVar6[1] = puVar6;
      iStack_2c = 0;
      if (puVar3 != puVar6) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    uStack_c = 0xffffffff;
    if (in_ECX[2] != 0) {
      LeaveCriticalSection((LPCRITICAL_SECTION)(in_ECX[2] + 4));
      uVar5 = extraout_EAX_00;
    }
  }
  ExceptionList = local_14;
  return uVar5 & 0xffffff00;
}



============================================================
DISASSEMBLY
============================================================
00743a90 : PUSH EBP
00743a91 : MOV EBP,ESP
00743a93 : AND ESP,0xfffffff8
00743a96 : PUSH -0x1
00743a98 : PUSH 0xb430ad
00743a9d : MOV EAX,FS:[0x0]
00743aa3 : PUSH EAX
00743aa4 : SUB ESP,0x30
00743aa7 : PUSH EBX
00743aa8 : PUSH ESI
00743aa9 : PUSH EDI
00743aaa : MOV EAX,[0x00d66fa0]
00743aaf : XOR EAX,ESP
00743ab1 : PUSH EAX
00743ab2 : LEA EAX,[ESP + 0x40]
00743ab6 : MOV FS:[0x0],EAX
00743abc : MOV ESI,ECX
00743abe : MOV EAX,dword ptr [EBP + 0x10]
00743ac1 : INC dword ptr [0x00da9b14]
00743ac7 : CMP EAX,0x2
00743aca : JNZ 0x00743ada
00743acc : MOV EDX,dword ptr [EBP + 0x8]
00743acf : LEA EAX,[ESI + 0x1ac]
00743ad5 : CALL 0x007f2d40
00743ada : XOR EBX,EBX
00743adc : CMP EAX,EBX
00743ade : JZ 0x00743b26
00743ae0 : MOV EAX,dword ptr [ESI]
00743ae2 : MOV EDX,dword ptr [EAX + 0x140]
00743ae8 : MOV ECX,ESI
00743aea : CALL EDX
00743aec : MOV EAX,dword ptr [ESI + 0x8]
00743aef : MOV dword ptr [ESP + 0x18],ESI
00743af3 : CMP EAX,EBX
00743af5 : JZ 0x00743b01
00743af7 : ADD EAX,0x4
00743afa : PUSH EAX
00743afb : CALL dword ptr [0x00b85118]
00743b01 : MOV dword ptr [ESP + 0x48],EBX
00743b05 : CMP dword ptr [ESI + 0x18c],EBX
00743b0b : JNZ 0x00743b3d
00743b0d : MOV dword ptr [ESP + 0x48],0xffffffff
00743b15 : MOV ESI,dword ptr [ESI + 0x8]
00743b18 : CMP ESI,EBX
00743b1a : JZ 0x00743b26
00743b1c : ADD ESI,0x4
00743b1f : PUSH ESI
00743b20 : CALL dword ptr [0x00b8511c]
00743b26 : XOR AL,AL
00743b28 : MOV ECX,dword ptr [ESP + 0x40]
00743b2c : MOV dword ptr FS:[0x0],ECX
00743b33 : POP ECX
00743b34 : POP EDI
00743b35 : POP ESI
00743b36 : POP EBX
00743b37 : MOV ESP,EBP
00743b39 : POP EBP
00743b3a : RET 0xc
00743b3d : MOV dword ptr [ESP + 0x48],0xffffffff
00743b45 : MOV EAX,dword ptr [ESI + 0x8]
00743b48 : CMP EAX,EBX
00743b4a : JZ 0x00743b56
00743b4c : ADD EAX,0x4
00743b4f : PUSH EAX
00743b50 : CALL dword ptr [0x00b8511c]
00743b56 : MOV AL,byte ptr [ESI + 0x560]
00743b5c : MOV ECX,dword ptr [ESI + 0x614]
00743b62 : MOV byte ptr [ECX + 0x1ee],AL
00743b68 : MOV AL,byte ptr [ESI + 0x561]
00743b6e : MOV ECX,dword ptr [ESI + 0x614]
00743b74 : MOV byte ptr [ECX + 0x1ef],AL
00743b7a : MOV AL,byte ptr [ESI + 0x562]
00743b80 : MOV ECX,dword ptr [ESI + 0x614]
00743b86 : MOV byte ptr [ECX + 0x1f1],AL
00743b8c : MOV EAX,dword ptr [ESI + 0x394]
00743b92 : MOV ECX,dword ptr [ESI + 0x614]
00743b98 : MOV dword ptr [ECX + 0x1d4],EAX
00743b9e : MOV EAX,dword ptr [ESI + 0x398]
00743ba4 : MOV ECX,dword ptr [ESI + 0x614]
00743baa : MOV dword ptr [ECX + 0x1d8],EAX
00743bb0 : MOV EAX,dword ptr [ESI + 0x39c]
00743bb6 : MOV ECX,dword ptr [ESI + 0x614]
00743bbc : MOV dword ptr [ECX + 0x1dc],EAX
00743bc2 : MOV EAX,dword ptr [ESI + 0x3a0]
00743bc8 : MOV ECX,dword ptr [ESI + 0x614]
00743bce : MOV dword ptr [ECX + 0x1e0],EAX
00743bd4 : MOV AL,byte ptr [ESI + 0x563]
00743bda : MOV ECX,dword ptr [ESI + 0x614]
00743be0 : MOV byte ptr [ECX + 0x1f2],AL
00743be6 : MOV AL,byte ptr [ESI + 0x564]
00743bec : MOV ECX,dword ptr [ESI + 0x614]
00743bf2 : MOV byte ptr [ECX + 0x1f3],AL
00743bf8 : MOV AL,byte ptr [ESI + 0x567]
00743bfe : MOV ECX,dword ptr [ESI + 0x614]
00743c04 : MOV byte ptr [ECX + 0x1f4],AL
00743c0a : MOV AL,byte ptr [ESI + 0x566]
00743c10 : MOV ECX,dword ptr [ESI + 0x614]
00743c16 : MOV byte ptr [ECX + 0x1f5],AL
00743c1c : MOV EAX,dword ptr [ESI + 0x614]
00743c22 : MOVSS XMM0,dword ptr [ESI + 0x5e0]
00743c2a : MOVSS XMM1,dword ptr [ESI + 0x5e4]
00743c32 : MOVSS XMM2,dword ptr [ESI + 0x5e8]
00743c3a : MOVSS XMM3,dword ptr [ESI + 0x5ec]
00743c42 : MOVSS dword ptr [ESP + 0x2c],XMM0
00743c48 : MOVSS dword ptr [ESP + 0x30],XMM1
00743c4e : MOVQ XMM0,qword ptr [ESP + 0x2c]
00743c54 : MOVQ qword ptr [EAX + 0x1f8],XMM0
00743c5c : MOVSS dword ptr [ESP + 0x34],XMM2
00743c62 : MOVSS dword ptr [ESP + 0x38],XMM3
00743c68 : MOVQ XMM0,qword ptr [ESP + 0x34]
00743c6e : MOVQ qword ptr [EAX + 0x200],XMM0
00743c76 : MOV AL,byte ptr [ESI + 0x568]
00743c7c : MOV ECX,dword ptr [ESI + 0x614]
00743c82 : MOV byte ptr [ECX + 0x1ec],AL
00743c88 : MOV EAX,dword ptr [ESI + 0x554]
00743c8e : MOV ECX,dword ptr [ESI + 0x614]
00743c94 : MOV dword ptr [ECX + 0x1e4],EAX
00743c9a : MOV EAX,dword ptr [ESI + 0x558]
00743ca0 : MOV ECX,dword ptr [ESI + 0x614]
00743ca6 : MOV dword ptr [ECX + 0x1e8],EAX
00743cac : MOV EAX,dword ptr [ESI + 0x614]
00743cb2 : LEA ECX,[ESI + 0x1ac]
00743cb8 : ADD EAX,0x74
00743cbb : CALL 0x00439630
00743cc0 : MOVSS XMM0,dword ptr [ESI + 0xac]
00743cc8 : MOV EAX,dword ptr [ESI + 0x614]
00743cce : MOVSS dword ptr [EAX + 0x210],XMM0
00743cd6 : MOVAPS XMM1,XMM0
00743cd9 : MOVSS dword ptr [EAX + 0x208],XMM1
00743ce1 : MOVAPS XMM2,XMM0
00743ce4 : MOVSS dword ptr [EAX + 0x20c],XMM2
00743cec : MOV EAX,dword ptr [ESI + 0x614]
00743cf2 : MOV dword ptr [EAX + 0x220],EBX
00743cf8 : MOV dword ptr [EAX + 0x218],EBX
00743cfe : CALL 0x0045f710
00743d03 : MOV EDI,EAX
00743d05 : MOV dword ptr [ESP + 0x24],EDI
00743d09 : MOV dword ptr [ESP + 0x28],EBX
00743d0d : MOV dword ptr [ESP + 0x48],0x1
00743d15 : MOV EAX,dword ptr [ESI + 0x8]
00743d18 : MOV dword ptr [ESP + 0x1c],ESI
00743d1c : CMP EAX,EBX
00743d1e : JZ 0x00743d2a
00743d20 : ADD EAX,0x4
00743d23 : PUSH EAX
00743d24 : CALL dword ptr [0x00b85118]
00743d2a : MOV byte ptr [ESP + 0x48],0x2
00743d2f : MOV EAX,dword ptr [ESI + 0x188]
00743d35 : MOV ECX,dword ptr [EAX]
00743d37 : MOV dword ptr [ESP + 0x14],ECX
00743d3b : CMP ECX,EAX
00743d3d : JZ 0x00743d98
00743d3f : MOV EAX,dword ptr [ESP + 0x14]
00743d43 : MOV EBX,dword ptr [EAX + 0x24]
00743d46 : TEST EBX,EBX
00743d48 : JZ 0x00743d84
00743d4a : MOV EDX,dword ptr [EBX]
00743d4c : MOV EAX,dword ptr [EDX + 0x4]
00743d4f : MOV ECX,EBX
00743d51 : CALL EAX
00743d53 : CMP EAX,0xf
00743d56 : JNZ 0x00743d84
00743d58 : MOV EDX,dword ptr [EDI + 0x4]
00743d5b : MOV dword ptr [ESP + 0x18],EBX
00743d5f : LEA ECX,[ESP + 0x18]
00743d63 : LEA EBX,[EDI + 0x4]
00743d66 : PUSH ECX
00743d67 : PUSH EDX
00743d68 : PUSH EDI
00743d69 : CALL 0x004c09c0
00743d6e : LEA ECX,[ESP + 0x20]
00743d72 : MOV EDI,EAX
00743d74 : CALL 0x0047a1b0
00743d79 : MOV dword ptr [EBX],EDI
00743d7b : MOV EAX,dword ptr [EDI + 0x4]
00743d7e : MOV dword ptr [EAX],EDI
00743d80 : MOV EDI,dword ptr [ESP + 0x24]
00743d84 : MOV EAX,dword ptr [ESP + 0x14]
00743d88 : MOV EAX,dword ptr [EAX]
00743d8a : MOV dword ptr [ESP + 0x14],EAX
00743d8e : CMP EAX,dword ptr [ESI + 0x188]
00743d94 : JNZ 0x00743d3f
00743d96 : XOR EBX,EBX
00743d98 : MOV byte ptr [ESP + 0x48],0x1
00743d9d : MOV EAX,dword ptr [ESI + 0x8]
00743da0 : CMP EAX,EBX
00743da2 : JZ 0x00743dae
00743da4 : ADD EAX,0x4
00743da7 : PUSH EAX
00743da8 : CALL dword ptr [0x00b8511c]
00743dae : CMP dword ptr [ESP + 0x28],EBX
00743db2 : JZ 0x00743dee
00743db4 : MOV ECX,dword ptr [EDI]
00743db6 : MOV dword ptr [ESP + 0x14],ECX
00743dba : CMP ECX,EDI
00743dbc : JZ 0x00743dee
00743dbe : JMP 0x00743dc4
00743dc0 : MOV ECX,dword ptr [ESP + 0x14]
00743dc4 : MOV EAX,dword ptr [ECX + 0x8]
00743dc7 : CMP EAX,EBX
00743dc9 : JZ 0x00743de4
00743dcb : MOV ECX,dword ptr [EBP + 0x8]
00743dce : PUSH ECX
00743dcf : MOV ECX,dword ptr [ESI + 0x614]
00743dd5 : LEA EDX,[EAX + 0x260]
00743ddb : CALL 0x00aca090
00743de0 : MOV ECX,dword ptr [ESP + 0x14]
00743de4 : MOV ECX,dword ptr [ECX]
00743de6 : MOV dword ptr [ESP + 0x14],ECX
00743dea : CMP ECX,EDI
00743dec : JNZ 0x00743dc0
00743dee : MOV ESI,dword ptr [ESI + 0x614]
00743df4 : CMP dword ptr [ESI + 0x220],EBX
00743dfa : JZ 0x00743e0c
00743dfc : MOV ECX,dword ptr [EBP + 0xc]
00743dff : MOV EAX,dword ptr [EBP + 0x8]
00743e02 : MOV EDX,dword ptr [ECX]
00743e04 : MOV EDX,dword ptr [EDX + 0x10]
00743e07 : PUSH EBX
00743e08 : PUSH EAX
00743e09 : PUSH ESI
00743e0a : CALL EDX
00743e0c : MOV dword ptr [ESP + 0x48],0xffffffff
00743e14 : MOV ECX,dword ptr [EDI]
00743e16 : MOV dword ptr [EDI],EDI
00743e18 : MOV dword ptr [EDI + 0x4],EDI
00743e1b : MOV dword ptr [ESP + 0x28],EBX
00743e1f : CMP ECX,EDI
00743e21 : JZ 0x00743e30
00743e23 : MOV ESI,dword ptr [ECX]
00743e25 : CALL 0x006f04e0
00743e30 : MOV ECX,EDI
00743e32 : CALL 0x006f04e0

PROGRAM  : Maestia.exe
FUNCTION : FUN_0070d4c0
ENTRY    : 0070d4c0
BODY     : [[0070d4c0, 0070d549]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0070d4c0(void)

{
  uint uVar1;
  int in_ECX;
  
  if (*(code **)(in_ECX + 8) != (code *)0x0) {
    (**(code **)(in_ECX + 8))();
  }
  if (*(char *)(in_ECX + 0x50) != '\0') {
    uVar1 = *(uint *)(in_ECX + 0x18);
    if (((uVar1 == 0) || (*(uint *)(in_ECX + 0x1c) < uVar1)) ||
       (*(int *)(in_ECX + 0x2c) + uVar1 < *(uint *)(in_ECX + 0x1c))) {
      FUN_0070a260(*(undefined4 *)(in_ECX + 0x1c));
      *(undefined4 *)(in_ECX + 0x1c) = 0;
    }
    *(undefined1 *)(in_ECX + 0x50) = 0;
  }
  if (*(HANDLE *)(in_ECX + 0x10) != (HANDLE)0x0) {
    CloseHandle(*(HANDLE *)(in_ECX + 0x10));
    *(undefined4 *)(in_ECX + 0x10) = 0;
  }
  if (*(HANDLE *)(in_ECX + 0x14) != (HANDLE)0x0) {
    CloseHandle(*(HANDLE *)(in_ECX + 0x14));
    *(undefined4 *)(in_ECX + 0x14) = 0;
  }
  if (*(LPCVOID *)(in_ECX + 0x18) != (LPCVOID)0x0) {
    UnmapViewOfFile(*(LPCVOID *)(in_ECX + 0x18));
    *(undefined4 *)(in_ECX + 0x18) = 0;
  }
  *(undefined4 *)(in_ECX + 0x2c) = 0;
  *(undefined4 *)(in_ECX + 0x20) = 0;
  *(undefined4 *)(in_ECX + 0x24) = 0;
  *(undefined4 *)(in_ECX + 0x1c) = 0;
  *(undefined1 *)(in_ECX + 4) = 0;
  return;
}



============================================================
DISASSEMBLY
============================================================
0070d4c0 : PUSH EBX
0070d4c1 : PUSH ESI
0070d4c2 : MOV ESI,ECX
0070d4c4 : MOV EAX,dword ptr [ESI + 0x8]
0070d4c7 : XOR EBX,EBX
0070d4c9 : PUSH EDI
0070d4ca : CMP EAX,EBX
0070d4cc : JZ 0x0070d4d8
0070d4ce : MOV ECX,dword ptr [ESI + 0xc]
0070d4d1 : PUSH ECX
0070d4d2 : PUSH ESI
0070d4d3 : CALL EAX
0070d4d5 : ADD ESP,0x8
0070d4d8 : CMP byte ptr [ESI + 0x50],BL
0070d4db : JZ 0x0070d506
0070d4dd : MOV EAX,dword ptr [ESI + 0x18]
0070d4e0 : CMP EAX,EBX
0070d4e2 : JZ 0x0070d4f4
0070d4e4 : MOV ECX,dword ptr [ESI + 0x1c]
0070d4e7 : CMP ECX,EAX
0070d4e9 : JC 0x0070d4f4
0070d4eb : MOV EDX,dword ptr [ESI + 0x2c]
0070d4ee : ADD EDX,EAX
0070d4f0 : CMP ECX,EDX
0070d4f2 : JBE 0x0070d503
0070d4f4 : MOV EAX,dword ptr [ESI + 0x1c]
0070d4f7 : PUSH EAX
0070d4f8 : CALL 0x0070a260
0070d4fd : ADD ESP,0x4
0070d500 : MOV dword ptr [ESI + 0x1c],EBX
0070d503 : MOV byte ptr [ESI + 0x50],BL
0070d506 : MOV EAX,dword ptr [ESI + 0x10]
0070d509 : MOV EDI,dword ptr [0x00b85104]
0070d50f : CMP EAX,EBX
0070d511 : JZ 0x0070d519
0070d513 : PUSH EAX
0070d514 : CALL EDI
0070d516 : MOV dword ptr [ESI + 0x10],EBX
0070d519 : MOV EAX,dword ptr [ESI + 0x14]
0070d51c : CMP EAX,EBX
0070d51e : JZ 0x0070d526
0070d520 : PUSH EAX
0070d521 : CALL EDI
0070d523 : MOV dword ptr [ESI + 0x14],EBX
0070d526 : MOV EAX,dword ptr [ESI + 0x18]
0070d529 : CMP EAX,EBX
0070d52b : JZ 0x0070d537
0070d52d : PUSH EAX
0070d52e : CALL dword ptr [0x00b851ac]
0070d534 : MOV dword ptr [ESI + 0x18],EBX
0070d537 : POP EDI
0070d538 : MOV dword ptr [ESI + 0x2c],EBX
0070d53b : MOV dword ptr [ESI + 0x20],EBX
0070d53e : MOV dword ptr [ESI + 0x24],EBX
0070d541 : MOV dword ptr [ESI + 0x1c],EBX
0070d544 : MOV byte ptr [ESI + 0x4],BL
0070d547 : POP ESI
0070d548 : POP EBX
0070d549 : RET

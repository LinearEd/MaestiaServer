PROGRAM  : Maestia.exe
FUNCTION : FUN_005651a0
ENTRY    : 005651a0
BODY     : [[005651a0, 005652e5]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005651a0(undefined4 param_1,uint *param_2,uint param_3)

{
  uint *puVar1;
  uint *puVar2;
  uint *puVar3;
  int *piVar4;
  uint uVar5;
  uint uVar6;
  int *in_ECX;
  uint uVar7;
  int iVar8;
  int iVar9;
  
  piVar4 = (int *)*in_ECX;
  if (piVar4 == (int *)0x0) {
    iVar9 = 8;
  }
  else {
    if ((uint)(*piVar4 * 5) <= piVar4[1] * 4 + 4U) goto LAB_005651da;
    iVar9 = piVar4[1] * 2 + 2;
  }
  FUN_00563f30(param_1,iVar9);
LAB_005651da:
  piVar4 = (int *)*in_ECX;
  param_3 = param_3 & piVar4[1];
  *piVar4 = *piVar4 + 1;
  iVar9 = *in_ECX;
  puVar1 = (uint *)(param_3 * 0x10 + 8 + iVar9);
  uVar5 = *puVar1;
  if (uVar5 == 0xfffffffe) {
    *puVar1 = 0xffffffff;
    puVar1[2] = *param_2;
    FUN_0051c2c0(param_2 + 1);
    puVar1[1] = param_3;
    return;
  }
  uVar7 = param_3;
  do {
    uVar7 = uVar7 + 1 & *(uint *)(iVar9 + 4);
  } while (*(int *)(iVar9 + 8 + uVar7 * 0x10) != -2);
  puVar2 = (uint *)(uVar7 * 0x10 + 8 + iVar9);
  if (puVar1[1] == param_3) {
    if (puVar2 != (uint *)0x0) {
      *puVar2 = uVar5;
      puVar2[1] = puVar1[1];
      puVar2[2] = puVar1[2];
      FUN_0051c2c0(puVar1 + 3);
    }
    puVar1[2] = *param_2;
    FUN_0051bc20(param_2 + 1);
    *puVar1 = uVar7;
    puVar1[1] = param_3;
    return;
  }
  iVar8 = puVar1[1] * 0x10;
  puVar3 = (uint *)(iVar9 + 8 + iVar8);
  for (uVar6 = *(uint *)(iVar9 + 8 + iVar8); uVar6 != param_3;
      uVar6 = *(uint *)(iVar9 + 8 + uVar6 * 0x10)) {
    uVar6 = *puVar3;
    puVar3 = (uint *)(iVar9 + 8 + uVar6 * 0x10);
  }
  if (puVar2 != (uint *)0x0) {
    *puVar2 = uVar5;
    puVar2[1] = puVar1[1];
    puVar2[2] = puVar1[2];
    FUN_0051c2c0(puVar1 + 3);
  }
  *puVar3 = uVar7;
  puVar1[2] = *param_2;
  FUN_0051bc20(param_2 + 1);
  puVar1[1] = param_3;
  *puVar1 = 0xffffffff;
  return;
}



============================================================
DISASSEMBLY
============================================================
005651a0 : PUSH ESI
005651a1 : MOV ESI,ECX
005651a3 : MOV EAX,dword ptr [ESI]
005651a5 : PUSH EDI
005651a6 : TEST EAX,EAX
005651a8 : JNZ 0x005651b3
005651aa : MOV EAX,dword ptr [ESP + 0xc]
005651ae : PUSH 0x8
005651b0 : PUSH EAX
005651b1 : JMP 0x005651d5
005651b3 : MOV ECX,dword ptr [EAX + 0x4]
005651b6 : LEA EDX,[ECX*0x4 + 0x4]
005651bd : MOV ECX,dword ptr [EAX]
005651bf : LEA ECX,[ECX + ECX*0x4]
005651c2 : CMP ECX,EDX
005651c4 : JBE 0x005651da
005651c6 : MOV EDX,dword ptr [EAX + 0x4]
005651c9 : MOV ECX,dword ptr [ESP + 0xc]
005651cd : LEA EAX,[EDX + EDX*0x1 + 0x2]
005651d1 : PUSH EAX
005651d2 : PUSH ECX
005651d3 : MOV ECX,ESI
005651d5 : CALL 0x00563f30
005651da : MOV EAX,dword ptr [ESI]
005651dc : MOV EDI,dword ptr [ESP + 0x14]
005651e0 : AND EDI,dword ptr [EAX + 0x4]
005651e3 : INC dword ptr [EAX]
005651e5 : MOV EAX,dword ptr [ESI]
005651e7 : MOV EDX,EDI
005651e9 : SHL EDX,0x4
005651ec : LEA ESI,[EDX + EAX*0x1 + 0x8]
005651f0 : MOV EDX,dword ptr [ESI]
005651f2 : CMP EDX,-0x2
005651f5 : JNZ 0x0056521a
005651f7 : MOV EAX,dword ptr [ESP + 0x10]
005651fb : MOV dword ptr [ESI],0xffffffff
00565201 : MOV ECX,dword ptr [EAX]
00565203 : ADD EAX,0x4
00565206 : MOV dword ptr [ESI + 0x8],ECX
00565209 : PUSH EAX
0056520a : LEA ECX,[ESI + 0xc]
0056520d : CALL 0x0051c2c0
00565212 : MOV dword ptr [ESI + 0x4],EDI
00565215 : POP EDI
00565216 : POP ESI
00565217 : RET 0xc
0056521a : MOV ECX,dword ptr [EAX + 0x4]
0056521d : PUSH EBX
0056521e : MOV EBX,EDI
00565220 : PUSH EBP
00565221 : INC EBX
00565222 : AND EBX,ECX
00565224 : MOV EBP,EBX
00565226 : SHL EBP,0x4
00565229 : CMP dword ptr [EAX + EBP*0x1 + 0x8],-0x2
0056522e : JNZ 0x00565221
00565230 : MOV EBP,dword ptr [ESI + 0x4]
00565233 : MOV ECX,EBX
00565235 : SHL ECX,0x4
00565238 : LEA ECX,[ECX + EAX*0x1 + 0x8]
0056523c : CMP EBP,EDI
0056523e : JNZ 0x0056527f
00565240 : TEST ECX,ECX
00565242 : JZ 0x0056525e
00565244 : MOV dword ptr [ECX],EDX
00565246 : MOV EDX,dword ptr [ESI + 0x4]
00565249 : MOV dword ptr [ECX + 0x4],EDX
0056524c : MOV EAX,dword ptr [ESI + 0x8]
0056524f : LEA EDX,[ESI + 0xc]
00565252 : MOV dword ptr [ECX + 0x8],EAX
00565255 : PUSH EDX
00565256 : ADD ECX,0xc
00565259 : CALL 0x0051c2c0
0056525e : MOV EAX,dword ptr [ESP + 0x18]
00565262 : MOV ECX,dword ptr [EAX]
00565264 : ADD EAX,0x4
00565267 : MOV dword ptr [ESI + 0x8],ECX
0056526a : PUSH EAX
0056526b : LEA ECX,[ESI + 0xc]
0056526e : CALL 0x0051bc20
00565273 : POP EBP
00565274 : MOV dword ptr [ESI],EBX
00565276 : POP EBX
00565277 : MOV dword ptr [ESI + 0x4],EDI
0056527a : POP EDI
0056527b : POP ESI
0056527c : RET 0xc
0056527f : SHL EBP,0x4
00565282 : CMP dword ptr [EAX + EBP*0x1 + 0x8],EDI
00565286 : LEA EBP,[EAX + EBP*0x1 + 0x8]
0056528a : JZ 0x005652a0
0056528c : LEA ESP,[ESP]
00565290 : MOV EBP,dword ptr [EBP]
00565293 : SHL EBP,0x4
00565296 : CMP dword ptr [EAX + EBP*0x1 + 0x8],EDI
0056529a : LEA EBP,[EAX + EBP*0x1 + 0x8]
0056529e : JNZ 0x00565290
005652a0 : TEST ECX,ECX
005652a2 : JZ 0x005652be
005652a4 : MOV dword ptr [ECX],EDX
005652a6 : MOV EDX,dword ptr [ESI + 0x4]
005652a9 : MOV dword ptr [ECX + 0x4],EDX
005652ac : MOV EAX,dword ptr [ESI + 0x8]
005652af : LEA EDX,[ESI + 0xc]
005652b2 : MOV dword ptr [ECX + 0x8],EAX
005652b5 : PUSH EDX
005652b6 : ADD ECX,0xc
005652b9 : CALL 0x0051c2c0
005652be : MOV EAX,dword ptr [ESP + 0x18]
005652c2 : MOV dword ptr [EBP],EBX
005652c5 : MOV ECX,dword ptr [EAX]
005652c7 : ADD EAX,0x4
005652ca : MOV dword ptr [ESI + 0x8],ECX
005652cd : PUSH EAX
005652ce : LEA ECX,[ESI + 0xc]
005652d1 : CALL 0x0051bc20
005652d6 : POP EBP
005652d7 : POP EBX
005652d8 : MOV dword ptr [ESI + 0x4],EDI
005652db : POP EDI
005652dc : MOV dword ptr [ESI],0xffffffff
005652e2 : POP ESI
005652e3 : RET 0xc

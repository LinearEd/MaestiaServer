PROGRAM  : Maestia.exe
FUNCTION : FUN_00633484
ENTRY    : 00633484
BODY     : [[00633484, 00633688]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x0063360e) */

ulonglong FUN_00633484(byte *param_1,undefined4 *param_2,size_t param_3,undefined4 *param_4)

{
  byte bVar1;
  ulonglong uVar2;
  ulonglong uVar3;
  int iVar4;
  void *pvVar5;
  int *piVar6;
  byte *pbVar7;
  byte *pbVar8;
  byte *pbVar9;
  longlong lVar10;
  ulonglong uVar11;
  size_t sVar12;
  int local_1c;
  int local_18;
  char local_6;
  byte local_5;
  
  if (param_4 != (undefined4 *)0x0) {
    *param_4 = 0;
  }
  bVar1 = *param_1;
  pbVar7 = param_1;
  while (iVar4 = _isspace((uint)bVar1), iVar4 != 0) {
    pbVar7 = pbVar7 + 1;
    bVar1 = *pbVar7;
  }
  local_5 = *pbVar7;
  if ((local_5 == 0x2d) || (local_5 == 0x2b)) {
    pbVar7 = pbVar7 + 1;
  }
  else {
    local_5 = 0x2b;
  }
  if ((((int)param_3 < 0) || (param_3 == 1)) || (0x24 < (int)param_3)) goto LAB_0063367c;
  pbVar8 = pbVar7;
  if ((int)param_3 < 1) {
    if (*pbVar7 == 0x30) {
      if ((pbVar7[1] == 0x78) || (pbVar7[1] == 0x58)) {
        param_3 = 0x10;
        goto LAB_00633528;
      }
      param_3 = 8;
    }
    else {
      param_3 = 10;
    }
  }
  else if (((param_3 == 0x10) && (*pbVar7 == 0x30)) && ((pbVar7[1] == 0x78 || (pbVar7[1] == 0x58))))
  {
LAB_00633528:
    pbVar7 = pbVar7 + 2;
    pbVar8 = pbVar7;
  }
  for (; *pbVar7 == 0x30; pbVar7 = pbVar7 + 1) {
  }
  local_6 = '\0';
  sVar12 = param_3;
  iVar4 = _tolower((int)(char)*pbVar7);
  pvVar5 = _memchr("0123456789abcdefghijklmnopqrstuvwxyz",iVar4,sVar12);
  pbVar9 = pbVar7;
  uVar11 = 0;
  uVar3 = 0;
  while (uVar2 = uVar11, pvVar5 != (void *)0x0) {
    local_6 = (char)pvVar5 + '(';
    lVar10 = __allmul(param_3,(int)param_3 >> 0x1f,uVar2);
    pbVar9 = pbVar9 + 1;
    sVar12 = param_3;
    iVar4 = _tolower((int)(char)*pbVar9);
    pvVar5 = _memchr("0123456789abcdefghijklmnopqrstuvwxyz",iVar4,sVar12);
    uVar11 = lVar10 + (int)local_6;
    uVar3 = uVar2;
  }
  if (pbVar8 != pbVar9) {
    iVar4 = (int)(pbVar9 + -(int)(char)(&DAT_00b96100)[param_3]) - (int)pbVar7;
    if ((-1 < iVar4) &&
       (((pbVar9 + -(int)(char)(&DAT_00b96100)[param_3] != pbVar7 && -1 < iVar4 ||
         (uVar2 < uVar2 - (longlong)(int)local_6)) ||
        (uVar11 = __aulldiv(uVar2 - (longlong)(int)local_6,param_3,(int)param_3 >> 0x1f),
        uVar11 != uVar3)))) {
      piVar6 = __errno();
      *piVar6 = 0x22;
      if (param_4 != (undefined4 *)0x0) {
        *param_4 = 1;
      }
      uVar2 = 0xffffffffffffffff;
      local_5 = 0x2b;
    }
    local_18 = (int)(uVar2 >> 0x20);
    local_1c = (int)uVar2;
    if (local_5 == 0x2d) {
      uVar2 = CONCAT44(-(local_18 + (uint)(local_1c != 0)),-local_1c);
    }
    if (param_2 == (undefined4 *)0x0) {
      return uVar2;
    }
    *param_2 = pbVar9;
    return uVar2;
  }
LAB_0063367c:
  if (param_2 != (undefined4 *)0x0) {
    *param_2 = param_1;
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00633484 : MOV EDI,EDI
00633486 : PUSH EBP
00633487 : MOV EBP,ESP
00633489 : MOV EAX,dword ptr [EBP + 0x14]
0063348c : SUB ESP,0x28
0063348f : PUSH EBX
00633490 : PUSH ESI
00633491 : XOR ESI,ESI
00633493 : PUSH EDI
00633494 : CMP EAX,ESI
00633496 : JZ 0x0063349a
00633498 : MOV dword ptr [EAX],ESI
0063349a : MOV EBX,dword ptr [EBP + 0x8]
0063349d : MOVZX EAX,byte ptr [EBX]
006334a0 : MOV EDI,EBX
006334a2 : JMP 0x006334a8
006334a4 : INC EDI
006334a5 : MOVZX EAX,byte ptr [EDI]
006334a8 : PUSH EAX
006334a9 : CALL 0x006398a7
006334ae : POP ECX
006334af : TEST EAX,EAX
006334b1 : JNZ 0x006334a4
006334b3 : MOV AL,byte ptr [EDI]
006334b5 : CMP AL,0x2d
006334b7 : JZ 0x006334c3
006334b9 : CMP AL,0x2b
006334bb : JZ 0x006334c3
006334bd : MOV byte ptr [EBP + -0x1],0x2b
006334c1 : JMP 0x006334c7
006334c3 : MOV byte ptr [EBP + -0x1],AL
006334c6 : INC EDI
006334c7 : MOV EAX,dword ptr [EBP + 0x10]
006334ca : CMP EAX,ESI
006334cc : JL 0x00633677
006334d2 : CMP EAX,0x1
006334d5 : JZ 0x00633677
006334db : CMP EAX,0x24
006334de : JG 0x00633677
006334e4 : CMP EAX,ESI
006334e6 : MOV CL,0x30
006334e8 : JLE 0x00633500
006334ea : CMP EAX,0x10
006334ed : JNZ 0x0063352a
006334ef : CMP byte ptr [EDI],CL
006334f1 : JNZ 0x0063352a
006334f3 : MOV AL,byte ptr [EDI + 0x1]
006334f6 : CMP AL,0x78
006334f8 : JZ 0x00633528
006334fa : CMP AL,0x58
006334fc : JNZ 0x0063352a
006334fe : JMP 0x00633528
00633500 : CMP byte ptr [EDI],CL
00633502 : JZ 0x0063350d
00633504 : MOV dword ptr [EBP + 0x10],0xa
0063350b : JMP 0x0063352a
0063350d : MOV AL,byte ptr [EDI + 0x1]
00633510 : CMP AL,0x78
00633512 : JZ 0x00633521
00633514 : CMP AL,0x58
00633516 : JZ 0x00633521
00633518 : MOV dword ptr [EBP + 0x10],0x8
0063351f : JMP 0x0063352a
00633521 : MOV dword ptr [EBP + 0x10],0x10
00633528 : INC EDI
00633529 : INC EDI
0063352a : MOV dword ptr [EBP + -0xc],EDI
0063352d : JMP 0x00633530
0063352f : INC EDI
00633530 : CMP byte ptr [EDI],CL
00633532 : JZ 0x0063352f
00633534 : MOVSX EAX,byte ptr [EDI]
00633537 : PUSH dword ptr [EBP + 0x10]
0063353a : MOV dword ptr [EBP + -0x18],ESI
0063353d : PUSH EAX
0063353e : MOV dword ptr [EBP + -0x14],ESI
00633541 : MOV dword ptr [EBP + -0x10],EDI
00633544 : MOV dword ptr [EBP + -0x20],ESI
00633547 : MOV dword ptr [EBP + -0x1c],ESI
0063354a : MOV byte ptr [EBP + -0x2],0x0
0063354e : CALL 0x00637a1c
00633553 : POP ECX
00633554 : PUSH EAX
00633555 : MOV ESI,0xb960d8
0063355a : PUSH ESI
0063355b : CALL 0x00635250
00633560 : MOV ECX,EAX
00633562 : ADD ESP,0xc
00633565 : TEST ECX,ECX
00633567 : JZ 0x006335d2
00633569 : MOV EAX,dword ptr [EBP + 0x10]
0063356c : CDQ
0063356d : MOV dword ptr [EBP + -0x28],EAX
00633570 : MOV dword ptr [EBP + -0x24],EDX
00633573 : PUSH dword ptr [EBP + -0x14]
00633576 : MOV EAX,dword ptr [EBP + -0x18]
00633579 : PUSH dword ptr [EBP + -0x18]
0063357c : MOV dword ptr [EBP + -0x20],EAX
0063357f : MOV EAX,dword ptr [EBP + -0x14]
00633582 : PUSH dword ptr [EBP + -0x24]
00633585 : MOV dword ptr [EBP + -0x1c],EAX
00633588 : PUSH dword ptr [EBP + -0x28]
0063358b : MOV BL,CL
0063358d : MOV EAX,ESI
0063358f : SUB BL,AL
00633591 : MOV byte ptr [EBP + -0x2],BL
00633594 : CALL 0x0063c720
00633599 : PUSH dword ptr [EBP + 0x10]
0063359c : MOV ECX,EAX
0063359e : MOV EAX,EDX
006335a0 : MOV dword ptr [EBP + -0x8],EAX
006335a3 : MOVSX EAX,BL
006335a6 : CDQ
006335a7 : ADD ECX,EAX
006335a9 : MOV EAX,dword ptr [EBP + -0x8]
006335ac : ADC EAX,EDX
006335ae : MOV dword ptr [EBP + -0x14],EAX
006335b1 : INC EDI
006335b2 : MOVSX EAX,byte ptr [EDI]
006335b5 : PUSH EAX
006335b6 : MOV dword ptr [EBP + -0x18],ECX
006335b9 : CALL 0x00637a1c
006335be : POP ECX
006335bf : PUSH EAX
006335c0 : PUSH ESI
006335c1 : CALL 0x00635250
006335c6 : MOV ECX,EAX
006335c8 : ADD ESP,0xc
006335cb : TEST ECX,ECX
006335cd : JNZ 0x00633573
006335cf : MOV EBX,dword ptr [EBP + 0x8]
006335d2 : CMP dword ptr [EBP + -0xc],EDI
006335d5 : JNZ 0x006335e1
006335d7 : MOV EAX,dword ptr [EBP + 0xc]
006335da : TEST EAX,EAX
006335dc : JMP 0x0063367c
006335e1 : MOV EBX,dword ptr [EBP + 0x10]
006335e4 : MOVSX ECX,byte ptr [EBX + 0xb96100]
006335eb : MOV EAX,EDI
006335ed : SUB EAX,ECX
006335ef : SUB EAX,dword ptr [EBP + -0x10]
006335f2 : JS 0x0063364d
006335f4 : TEST EAX,EAX
006335f6 : JG 0x00633629
006335f8 : MOVSX EAX,byte ptr [EBP + -0x2]
006335fc : MOV ESI,dword ptr [EBP + -0x18]
006335ff : MOV ECX,dword ptr [EBP + -0x14]
00633602 : CDQ
00633603 : SUB ESI,EAX
00633605 : SBB ECX,EDX
00633607 : CMP dword ptr [EBP + -0x14],ECX
0063360a : JC 0x00633629
0063360c : JA 0x00633613
0063360e : CMP dword ptr [EBP + -0x18],ESI
00633611 : JC 0x00633629
00633613 : MOV EAX,EBX
00633615 : CDQ
00633616 : PUSH EDX
00633617 : PUSH EAX
00633618 : PUSH ECX
00633619 : PUSH ESI
0063361a : CALL 0x0063c250
0063361f : CMP EAX,dword ptr [EBP + -0x20]
00633622 : JNZ 0x00633629
00633624 : CMP EDX,dword ptr [EBP + -0x1c]
00633627 : JZ 0x0063364d
00633629 : CALL 0x0063ab82
0063362e : MOV dword ptr [EAX],0x22
00633634 : MOV EAX,dword ptr [EBP + 0x14]
00633637 : TEST EAX,EAX
00633639 : JZ 0x00633641
0063363b : MOV dword ptr [EAX],0x1
00633641 : OR dword ptr [EBP + -0x18],0xffffffff
00633645 : OR dword ptr [EBP + -0x14],0xffffffff
00633649 : MOV byte ptr [EBP + -0x1],0x2b
0063364d : CMP byte ptr [EBP + -0x1],0x2d
00633651 : JNZ 0x00633666
00633653 : MOV EAX,dword ptr [EBP + -0x18]
00633656 : MOV ECX,dword ptr [EBP + -0x14]
00633659 : NEG EAX
0063365b : ADC ECX,0x0
0063365e : NEG ECX
00633660 : MOV dword ptr [EBP + -0x18],EAX
00633663 : MOV dword ptr [EBP + -0x14],ECX
00633666 : MOV EAX,dword ptr [EBP + 0xc]
00633669 : TEST EAX,EAX
0063366b : JZ 0x0063366f
0063366d : MOV dword ptr [EAX],EDI
0063366f : MOV EAX,dword ptr [EBP + -0x18]
00633672 : MOV EDX,dword ptr [EBP + -0x14]
00633675 : JMP 0x00633684
00633677 : MOV EAX,dword ptr [EBP + 0xc]
0063367a : CMP EAX,ESI
0063367c : JZ 0x00633680
0063367e : MOV dword ptr [EAX],EBX
00633680 : XOR EAX,EAX
00633682 : XOR EDX,EDX
00633684 : POP EDI
00633685 : POP ESI
00633686 : POP EBX
00633687 : LEAVE
00633688 : RET

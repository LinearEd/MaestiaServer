PROGRAM  : Maestia.exe
FUNCTION : FUN_00a85b80
ENTRY    : 00a85b80
BODY     : [[00a85b80, 00a86065]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x00a85e5e) */

void FUN_00a85b80(uint8_t *param_1)

{
  undefined4 uVar1;
  ulonglong uVar2;
  int *piVar3;
  int iVar4;
  int iVar5;
  undefined4 *puVar6;
  undefined4 uVar7;
  uint8_t *packet;
  short in_CX;
  uint uVar8;
  undefined4 *puVar9;
  undefined4 ****ppppuVar10;
  int *piVar11;
  uint local_94;
  int local_90 [2];
  undefined2 local_88;
  undefined4 local_78;
  uint local_74;
  uint8_t *local_70;
  int *local_6c;
  undefined4 local_64;
  undefined4 local_54;
  uint local_50;
  undefined4 local_48;
  undefined4 local_38;
  uint local_34;
  undefined1 local_30 [4];
  undefined4 ***local_2c [4];
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3ef1c;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_70 = param_1;
  if (*(short *)(param_1 + 0x3e) == 0) {
    piVar3 = *(int **)(param_1 + 0x48);
    local_6c = *(int **)(param_1 + 0x44);
    if ((uint)((int)piVar3 - (int)local_6c >> 2) <= (uint)(int)in_CX) goto LAB_00a86048;
  }
  else {
    if (*(short *)(param_1 + 0x3e) != 1) {
      FUN_008018d0(L"AvaGuiPremiumShopInven::Refresh inven type error",local_14);
      goto LAB_00a86048;
    }
    local_6c = *(int **)(param_1 + 0x54);
    piVar3 = *(int **)(param_1 + 0x58);
    if ((uint)((int)piVar3 - *(int *)(param_1 + 0x54) >> 2) <= (uint)(int)in_CX) goto LAB_00a86048;
  }
  *(short *)(param_1 + 0x3c) = in_CX;
  uVar8 = 0;
  for (piVar11 = local_6c; local_6c = piVar11, piVar11 != piVar3; piVar11 = piVar11 + 1) {
    if ((uVar8 & 0xffff) == (int)in_CX) {
      if (*(short *)(param_1 + 0x3e) == 1) {
        FUN_00406460(&DAT_00c59854);
        local_8 = 0;
        if (*(int *)(*DAT_00da9894 + 0x1d4) != 0) {
          iVar4 = FUN_008d3e90(*(undefined2 *)(*piVar11 + 0xe2));
          if (iVar4 == 0) {
            FUN_00405c00(local_30);
LAB_00a85c90:
            iVar4 = *piVar11;
          }
          else {
            FUN_00405eb0(iVar4 + 0x40,0,0xffffffff);
            FUN_00404980(local_30);
            if (*(char *)(iVar4 + 4) == '\0') goto LAB_00a85c90;
            iVar4 = iVar4 + 8;
          }
          FUN_00405c30(iVar4,0,0xffffffff);
          FUN_00404870(&DAT_00c598c4,1);
        }
        FUN_00426f10(local_90);
        if (local_90[0] != *(int *)(param_1 + 100)) {
          FUN_00406460(L"sender");
          local_8._0_1_ = 1;
          iVar5 = FUN_0081cce0(DAT_0172491c);
          local_8._0_1_ = 2;
          iVar4 = *(int *)(local_90[0] + 0x18);
          if (*(uint *)(iVar4 + 0x18) < 8) {
            iVar4 = iVar4 + 4;
          }
          else {
            iVar4 = *(int *)(iVar4 + 4);
          }
          if (*(uint *)(iVar5 + 0x18) < 8) {
            iVar5 = iVar5 + 4;
          }
          else {
            iVar5 = *(int *)(iVar5 + 4);
          }
          FUN_00404750(L"%s : %s",iVar5,iVar4);
          local_8 = CONCAT31(local_8._1_3_,4);
          if (7 < local_74) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          local_74 = 7;
          local_78 = 0;
          local_88 = 0;
          local_8._0_1_ = 5;
          if (7 < local_94) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          FUN_00406460(L"mailcontents");
          local_8._0_1_ = 6;
          iVar5 = FUN_0081cce0(DAT_0172491c);
          local_8._0_1_ = 7;
          iVar4 = *(int *)(local_90[0] + 0x18);
          if (*(uint *)(iVar4 + 0x34) < 8) {
            iVar4 = iVar4 + 0x20;
          }
          else {
            iVar4 = *(int *)(iVar4 + 0x20);
          }
          if (*(uint *)(iVar5 + 0x18) < 8) {
            iVar5 = iVar5 + 4;
          }
          else {
            iVar5 = *(int *)(iVar5 + 4);
          }
          FUN_00404750(L"%s : %s",iVar5,iVar4);
          local_8 = CONCAT31(local_8._1_3_,9);
          if (7 < local_74) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          local_74 = 7;
          local_78 = 0;
          local_88 = 0;
          local_8._0_1_ = 10;
          puVar9 = local_48;
          if (local_34 < 8) {
            puVar9 = &local_48;
          }
          puVar6 = local_64;
          if (local_50 < 8) {
            puVar6 = &local_64;
          }
          uVar7 = FUN_00404750(L"%s \n\n%s",puVar6,puVar9);
          local_8._0_1_ = 0xb;
          FUN_00405c30(uVar7,0,0xffffffff);
          local_8 = CONCAT31(local_8._1_3_,10);
          if (7 < local_74) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          local_74 = 7;
          local_78 = 0;
          local_88 = 0;
          local_8 = CONCAT31(local_8._1_3_,5);
          if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          local_34 = 7;
          local_38 = 0;
          local_48 = (undefined4 *)((uint)local_48._2_2_ << 0x10);
          local_8 = (uint)local_8._1_3_ << 8;
          if (7 < local_50) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          local_50 = 7;
          local_54 = 0;
          local_64 = (undefined4 *)((uint)local_64._2_2_ << 0x10);
        }
        iVar4 = *DAT_00da9894;
        if ((iVar4 != 0) && (*(int *)(iVar4 + 0x114) != 0)) {
          (**(code **)**(undefined4 **)(iVar4 + 0x114))("mc_premiumshopinven.CashInvenItemInfoOpen")
          ;
        }
        iVar4 = *DAT_00da9894;
        if ((iVar4 != 0) && (*(int *)(iVar4 + 0x114) != 0)) {
          ppppuVar10 = (undefined4 ****)local_2c[0];
          if (local_18 < 8) {
            ppppuVar10 = local_2c;
          }
          (**(code **)(**(int **)(iVar4 + 0x114) + 4))
                    (*(int **)(iVar4 + 0x114),"mc_premiumshopinven.CashInvenItemInfoData",
                     &DAT_00c59950,ppppuVar10);
        }
        *(int *)(local_70 + 0x78) = *local_6c;
        local_8 = 0xffffffff;
        if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_18 = 7;
        local_1c = 0;
        local_2c[0] = (undefined4 ***)((uint)local_2c[0] & 0xffff0000);
      }
      else {
        iVar4 = *(int *)ThreadLocalStoragePointer;
        uVar2 = (ulonglong)(*(byte *)(iVar4 + 0x18) + 1) % 3;
        local_70 = (uint8_t *)((int)uVar2 * 0x2000 + 0x122cb8 + iVar4);
        *(char *)(iVar4 + 0x18) = (char)uVar2;
        if (local_70 == (uint8_t *)0x0) {
          packet = (uint8_t *)0x0;
        }
        else {
          uVar7 = *(undefined4 *)(*piVar11 + 0xe8);
          uVar1 = *(undefined4 *)(*piVar11 + 0xec);
          local_70[0] = '\0';
          local_70[1] = '\0';
          local_70[2] = ';';
          local_70[3] = '\r';
          *(undefined4 *)(local_70 + 4) = uVar7;
          *(undefined4 *)(local_70 + 8) = uVar1;
          packet = local_70;
        }
        local_8 = 0xffffffff;
        if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
          FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),0xc,packet);
        }
        param_1[0x7c] = '\x01';
      }
      break;
    }
    uVar8 = uVar8 + 1;
  }
LAB_00a86048:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a85b80 : PUSH EBP
00a85b81 : MOV EBP,ESP
00a85b83 : PUSH -0x1
00a85b85 : PUSH 0xb3ef1c
00a85b8a : MOV EAX,FS:[0x0]
00a85b90 : PUSH EAX
00a85b91 : SUB ESP,0xa0
00a85b97 : MOV EAX,[0x00d66fa0]
00a85b9c : XOR EAX,EBP
00a85b9e : MOV dword ptr [EBP + -0x10],EAX
00a85ba1 : PUSH EBX
00a85ba2 : PUSH ESI
00a85ba3 : PUSH EDI
00a85ba4 : PUSH EAX
00a85ba5 : LEA EAX,[EBP + -0xc]
00a85ba8 : MOV FS:[0x0],EAX
00a85bae : MOV EBX,dword ptr [EBP + 0x8]
00a85bb1 : MOVZX EDX,word ptr [EBX + 0x3e]
00a85bb5 : MOVZX EAX,DX
00a85bb8 : MOV dword ptr [EBP + -0x6c],EBX
00a85bbb : TEST AX,AX
00a85bbe : JNZ 0x00a85bdd
00a85bc0 : MOV EAX,dword ptr [EBX + 0x48]
00a85bc3 : MOV EDI,dword ptr [EBX + 0x44]
00a85bc6 : MOV ESI,EAX
00a85bc8 : SUB ESI,EDI
00a85bca : MOVSX EDX,CX
00a85bcd : SAR ESI,0x2
00a85bd0 : MOV dword ptr [EBP + -0x68],EDI
00a85bd3 : CMP ESI,EDX
00a85bd5 : JBE 0x00a86048
00a85bdb : JMP 0x00a85c09
00a85bdd : MOVZX EAX,DX
00a85be0 : CMP AX,0x1
00a85be4 : JNZ 0x00a86035
00a85bea : MOV EAX,dword ptr [EBX + 0x54]
00a85bed : MOV dword ptr [EBP + -0x68],EAX
00a85bf0 : MOV EAX,dword ptr [EBX + 0x58]
00a85bf3 : MOV ESI,EAX
00a85bf5 : SUB ESI,dword ptr [EBX + 0x54]
00a85bf8 : MOVSX EDX,CX
00a85bfb : SAR ESI,0x2
00a85bfe : CMP ESI,EDX
00a85c00 : JBE 0x00a86048
00a85c06 : MOV EDI,dword ptr [EBP + -0x68]
00a85c09 : MOV word ptr [EBX + 0x3c],CX
00a85c0d : XOR ECX,ECX
00a85c0f : CMP EDI,EAX
00a85c11 : JZ 0x00a86048
00a85c17 : MOVZX ESI,CX
00a85c1a : CMP ESI,EDX
00a85c1c : JZ 0x00a85c2e
00a85c1e : ADD EDI,0x4
00a85c21 : INC ECX
00a85c22 : CMP EDI,EAX
00a85c24 : JNZ 0x00a85c17
00a85c26 : MOV dword ptr [EBP + -0x68],EDI
00a85c29 : JMP 0x00a86048
00a85c2e : MOVZX EAX,word ptr [EBX + 0x3e]
00a85c32 : MOV dword ptr [EBP + -0x68],EDI
00a85c35 : CMP AX,0x1
00a85c39 : JNZ 0x00a85fb2
00a85c3f : PUSH 0xc59854
00a85c44 : LEA ECX,[EBP + -0x2c]
00a85c47 : CALL 0x00406460
00a85c4c : MOV dword ptr [EBP + -0x4],0x0
00a85c53 : MOV ECX,dword ptr [0x00da9894]
00a85c59 : MOV EAX,dword ptr [ECX]
00a85c5b : MOV ECX,dword ptr [EAX + 0x1d4]
00a85c61 : TEST ECX,ECX
00a85c63 : JZ 0x00a85cae
00a85c65 : MOV EDX,dword ptr [EDI]
00a85c67 : MOV EAX,ECX
00a85c69 : MOVZX ECX,word ptr [EDX + 0xe2]
00a85c70 : PUSH ECX
00a85c71 : MOV ESI,EAX
00a85c73 : CALL 0x008d3e90
00a85c78 : MOV ESI,EAX
00a85c7a : TEST ESI,ESI
00a85c7c : JNZ 0x00a85d17
00a85c82 : LEA EDX,[EBP + -0x2c]
00a85c85 : PUSH EDX
00a85c86 : MOV EDX,0xc598bc
00a85c8b : CALL 0x00405c00
00a85c90 : MOV EAX,dword ptr [EDI]
00a85c92 : PUSH -0x1
00a85c94 : PUSH 0x0
00a85c96 : PUSH EAX
00a85c97 : LEA ECX,[EBP + -0x2c]
00a85c9a : CALL 0x00405c30
00a85c9f : PUSH 0x1
00a85ca1 : PUSH 0xc598c4
00a85ca6 : LEA ESI,[EBP + -0x2c]
00a85ca9 : CALL 0x00404870
00a85cae : MOV EDI,dword ptr [EDI]
00a85cb0 : LEA EDX,[EBP + 0xffffff74]
00a85cb6 : ADD EDI,0xe8
00a85cbc : PUSH EDX
00a85cbd : LEA EAX,[EBX + 0x60]
00a85cc0 : CALL 0x00426f10
00a85cc5 : MOV EAX,dword ptr [EBX + 0x64]
00a85cc8 : MOV EDI,dword ptr [EBP + 0xffffff74]
00a85cce : MOV EBX,0x8
00a85cd3 : CMP EDI,EAX
00a85cd5 : JZ 0x00a85f1c
00a85cdb : PUSH 0xc598c8
00a85ce0 : LEA ECX,[EBP + 0xffffff58]
00a85ce6 : CALL 0x00406460
00a85ceb : MOV byte ptr [EBP + -0x4],0x1
00a85cef : MOV EAX,[0x0172491c]
00a85cf4 : PUSH EAX
00a85cf5 : LEA ECX,[EBP + 0xffffff58]
00a85cfb : LEA ESI,[EBP + 0xffffff78]
00a85d01 : CALL 0x0081cce0
00a85d06 : MOV byte ptr [EBP + -0x4],0x2
00a85d0a : MOV ECX,dword ptr [EDI + 0x18]
00a85d0d : CMP dword ptr [ECX + 0x18],EBX
00a85d10 : JC 0x00a85d4c
00a85d12 : MOV ECX,dword ptr [ECX + 0x4]
00a85d15 : JMP 0x00a85d4f
00a85d17 : PUSH -0x1
00a85d19 : PUSH 0x0
00a85d1b : LEA EAX,[ESI + 0x40]
00a85d1e : PUSH EAX
00a85d1f : LEA ECX,[EBP + -0x2c]
00a85d22 : CALL 0x00405eb0
00a85d27 : LEA ECX,[EBP + -0x2c]
00a85d2a : PUSH ECX
00a85d2b : MOV EDX,0xc598c0
00a85d30 : CALL 0x00404980
00a85d35 : CMP byte ptr [ESI + 0x4],0x0
00a85d39 : JZ 0x00a85c90
00a85d3f : PUSH -0x1
00a85d41 : PUSH 0x0
00a85d43 : ADD ESI,0x8
00a85d46 : PUSH ESI
00a85d47 : JMP 0x00a85c97
00a85d4c : ADD ECX,0x4
00a85d4f : CMP dword ptr [EAX + 0x18],EBX
00a85d52 : JC 0x00a85d59
00a85d54 : MOV EAX,dword ptr [EAX + 0x4]
00a85d57 : JMP 0x00a85d5c
00a85d59 : ADD EAX,0x4
00a85d5c : PUSH ECX
00a85d5d : PUSH EAX
00a85d5e : PUSH 0xc598d8
00a85d63 : LEA ESI,[EBP + -0x64]
00a85d66 : CALL 0x00404750
00a85d6b : ADD ESP,0xc
00a85d6e : MOV byte ptr [EBP + -0x4],0x4
00a85d72 : CMP dword ptr [EBP + -0x70],EBX
00a85d75 : JC 0x00a85d82
00a85d77 : MOV ECX,dword ptr [EBP + 0xffffff7c]
00a85d7d : CALL 0x006f04e0
00a85d82 : XOR ESI,ESI
00a85d84 : XOR ECX,ECX
00a85d86 : MOV dword ptr [EBP + -0x70],0x7
00a85d8d : MOV dword ptr [EBP + -0x74],ESI
00a85d90 : MOV word ptr [EBP + 0xffffff7c],CX
00a85d97 : MOV byte ptr [EBP + -0x4],0x5
00a85d9b : CMP dword ptr [EBP + 0xffffff70],EBX
00a85da1 : JC 0x00a85dae
00a85da3 : MOV ECX,dword ptr [EBP + 0xffffff5c]
00a85da9 : CALL 0x006f04e0
00a85dae : XOR EDX,EDX
00a85db0 : PUSH 0xc598e8
00a85db5 : LEA ECX,[EBP + 0xffffff58]
00a85dbb : MOV dword ptr [EBP + 0xffffff70],0x7
00a85dc5 : MOV dword ptr [EBP + 0xffffff6c],ESI
00a85dcb : MOV word ptr [EBP + 0xffffff5c],DX
00a85dd2 : CALL 0x00406460
00a85dd7 : MOV byte ptr [EBP + -0x4],0x6
00a85ddb : MOV EAX,[0x0172491c]
00a85de0 : PUSH EAX
00a85de1 : LEA ECX,[EBP + 0xffffff58]
00a85de7 : LEA ESI,[EBP + 0xffffff78]
00a85ded : CALL 0x0081cce0
00a85df2 : MOV byte ptr [EBP + -0x4],0x7
00a85df6 : MOV ECX,dword ptr [EDI + 0x18]
00a85df9 : ADD ECX,0x1c
00a85dfc : CMP dword ptr [ECX + 0x18],EBX
00a85dff : JC 0x00a85e06
00a85e01 : MOV ECX,dword ptr [ECX + 0x4]
00a85e04 : JMP 0x00a85e09
00a85e06 : ADD ECX,0x4
00a85e09 : CMP dword ptr [EAX + 0x18],EBX
00a85e0c : JC 0x00a85e13
00a85e0e : MOV EAX,dword ptr [EAX + 0x4]
00a85e11 : JMP 0x00a85e16
00a85e13 : ADD EAX,0x4
00a85e16 : PUSH ECX
00a85e17 : PUSH EAX
00a85e18 : PUSH 0xc59904
00a85e1d : LEA ESI,[EBP + -0x48]
00a85e20 : CALL 0x00404750
00a85e25 : ADD ESP,0xc
00a85e28 : MOV byte ptr [EBP + -0x4],0x9
00a85e2c : CMP dword ptr [EBP + -0x70],EBX
00a85e2f : JC 0x00a85e3c
00a85e31 : MOV ECX,dword ptr [EBP + 0xffffff7c]
00a85e37 : CALL 0x006f04e0
00a85e3c : MOV ESI,0x7
00a85e41 : XOR EDI,EDI
00a85e43 : XOR ECX,ECX
00a85e45 : MOV dword ptr [EBP + -0x70],ESI
00a85e48 : MOV dword ptr [EBP + -0x74],EDI
00a85e4b : MOV word ptr [EBP + 0xffffff7c],CX
00a85e52 : MOV byte ptr [EBP + -0x4],0xa
00a85e56 : CMP dword ptr [EBP + 0xffffff70],EBX
00a85e5c : JC 0x00a85e69
00a85e5e : MOV ECX,dword ptr [EBP + 0xffffff5c]
00a85e64 : CALL 0x006f04e0
00a85e69 : MOV ECX,dword ptr [EBP + -0x44]
00a85e6c : XOR EDX,EDX
00a85e6e : MOV dword ptr [EBP + 0xffffff70],ESI
00a85e74 : MOV dword ptr [EBP + 0xffffff6c],EDI
00a85e7a : MOV word ptr [EBP + 0xffffff5c],DX
00a85e81 : CMP dword ptr [EBP + -0x30],EBX
00a85e84 : JNC 0x00a85e89
00a85e86 : LEA ECX,[EBP + -0x44]
00a85e89 : MOV EAX,dword ptr [EBP + -0x60]
00a85e8c : CMP dword ptr [EBP + -0x4c],EBX
00a85e8f : JNC 0x00a85e94
00a85e91 : LEA EAX,[EBP + -0x60]
00a85e94 : PUSH ECX
00a85e95 : PUSH EAX
00a85e96 : PUSH 0xc59914
00a85e9b : LEA ESI,[EBP + 0xffffff78]
00a85ea1 : CALL 0x00404750
00a85ea6 : ADD ESP,0xc
00a85ea9 : MOV byte ptr [EBP + -0x4],0xb
00a85ead : PUSH -0x1
00a85eaf : PUSH EDI
00a85eb0 : PUSH EAX
00a85eb1 : LEA ECX,[EBP + -0x2c]
00a85eb4 : CALL 0x00405c30
00a85eb9 : MOV byte ptr [EBP + -0x4],0xa
00a85ebd : CMP dword ptr [EBP + -0x70],EBX
00a85ec0 : JC 0x00a85ecd
00a85ec2 : MOV ECX,dword ptr [EBP + 0xffffff7c]
00a85ec8 : CALL 0x006f04e0
00a85ecd : MOV ESI,0x7
00a85ed2 : XOR EAX,EAX
00a85ed4 : MOV dword ptr [EBP + -0x70],ESI
00a85ed7 : MOV dword ptr [EBP + -0x74],EDI
00a85eda : MOV word ptr [EBP + 0xffffff7c],AX
00a85ee1 : MOV byte ptr [EBP + -0x4],0x5
00a85ee5 : CMP dword ptr [EBP + -0x30],EBX
00a85ee8 : JC 0x00a85ef2
00a85eea : MOV ECX,dword ptr [EBP + -0x44]
00a85eed : CALL 0x006f04e0
00a85ef2 : XOR ECX,ECX
00a85ef4 : MOV dword ptr [EBP + -0x30],ESI
00a85ef7 : MOV dword ptr [EBP + -0x34],EDI
00a85efa : MOV word ptr [EBP + -0x44],CX
00a85efe : MOV byte ptr [EBP + -0x4],CL
00a85f01 : CMP dword ptr [EBP + -0x4c],EBX
00a85f04 : JC 0x00a85f0e
00a85f06 : MOV ECX,dword ptr [EBP + -0x60]
00a85f09 : CALL 0x006f04e0
00a85f0e : XOR EDX,EDX
00a85f10 : MOV dword ptr [EBP + -0x4c],ESI
00a85f13 : MOV dword ptr [EBP + -0x50],EDI
00a85f16 : MOV word ptr [EBP + -0x60],DX
00a85f1a : JMP 0x00a85f21
00a85f1c : XOR EDI,EDI
00a85f1e : LEA ESI,[EDI + 0x7]
00a85f21 : MOV EAX,[0x00da9894]
00a85f26 : MOV EAX,dword ptr [EAX]
00a85f28 : CMP EAX,EDI
00a85f2a : JZ 0x00a85f47
00a85f2c : CMP dword ptr [EAX + 0x114],EDI
00a85f32 : JZ 0x00a85f47
00a85f34 : MOV EAX,dword ptr [EAX + 0x114]
00a85f3a : MOV EDX,dword ptr [EAX]
00a85f3c : MOV ECX,EAX
00a85f3e : MOV EAX,dword ptr [EDX]
00a85f40 : PUSH 0xc59924
00a85f45 : CALL EAX
00a85f47 : MOV ECX,dword ptr [0x00da9894]
00a85f4d : MOV EAX,dword ptr [ECX]
00a85f4f : CMP EAX,EDI
00a85f51 : JZ 0x00a85f82
00a85f53 : CMP dword ptr [EAX + 0x114],EDI
00a85f59 : JZ 0x00a85f82
00a85f5b : MOV EAX,dword ptr [EAX + 0x114]
00a85f61 : MOV ECX,dword ptr [EBP + -0x28]
00a85f64 : CMP dword ptr [EBP + -0x14],EBX
00a85f67 : JNC 0x00a85f6c
00a85f69 : LEA ECX,[EBP + -0x28]
00a85f6c : MOV EDX,dword ptr [EAX]
00a85f6e : PUSH ECX
00a85f6f : PUSH 0xc59950
00a85f74 : PUSH 0xc59954
00a85f79 : PUSH EAX
00a85f7a : MOV EAX,dword ptr [EDX + 0x4]
00a85f7d : CALL EAX
00a85f7f : ADD ESP,0x10
00a85f82 : MOV ECX,dword ptr [EBP + -0x68]
00a85f85 : MOV EDX,dword ptr [ECX]
00a85f87 : MOV EAX,dword ptr [EBP + -0x6c]
00a85f8a : MOV dword ptr [EAX + 0x78],EDX
00a85f8d : MOV dword ptr [EBP + -0x4],0xffffffff
00a85f94 : CMP dword ptr [EBP + -0x14],EBX
00a85f97 : JC 0x00a85fa1
00a85f99 : MOV ECX,dword ptr [EBP + -0x28]
00a85f9c : CALL 0x006f04e0
00a85fa1 : XOR ECX,ECX
00a85fa3 : MOV dword ptr [EBP + -0x14],ESI
00a85fa6 : MOV dword ptr [EBP + -0x18],EDI
00a85fa9 : MOV word ptr [EBP + -0x28],CX
00a85fad : JMP 0x00a86048
00a85fb2 : MOV EDX,dword ptr FS:[0x2c]
00a85fb9 : MOV ECX,dword ptr [EDX]
00a85fbb : MOVZX EAX,byte ptr [ECX + 0x18]
00a85fbf : INC EAX
00a85fc0 : CDQ
00a85fc1 : MOV ESI,0x3
00a85fc6 : IDIV ESI
00a85fc8 : MOVZX EAX,DL
00a85fcb : SHL EAX,0xd
00a85fce : LEA EAX,[EAX + ECX*0x1 + 0x122cb8]
00a85fd5 : MOV byte ptr [ECX + 0x18],DL
00a85fd8 : MOV dword ptr [EBP + -0x6c],EAX
00a85fdb : MOV dword ptr [EBP + -0x4],0xc
00a85fe2 : TEST EAX,EAX
00a85fe4 : JZ 0x00a86009
00a85fe6 : MOV ECX,dword ptr [EDI]
00a85fe8 : MOV EDX,dword ptr [ECX + 0xe8]
00a85fee : MOV ECX,dword ptr [ECX + 0xec]
00a85ff4 : XOR ESI,ESI
00a85ff6 : MOV word ptr [EAX],SI
00a85ff9 : MOV byte ptr [EAX + 0x2],0x3b
00a85ffd : MOV byte ptr [EAX + 0x3],0xd
00a86001 : MOV dword ptr [EAX + 0x4],EDX
00a86004 : MOV dword ptr [EAX + 0x8],ECX
00a86007 : JMP 0x00a8600b
00a86009 : XOR EAX,EAX
00a8600b : MOV dword ptr [EBP + -0x4],0xffffffff
00a86012 : MOV EDX,dword ptr [0x017247d4]
00a86018 : MOV ECX,dword ptr [EDX + 0x4]
00a8601b : TEST ECX,ECX
00a8601d : JZ 0x00a8602f
00a8601f : CMP byte ptr [EDX + 0x8],0x0
00a86023 : JZ 0x00a8602f
00a86025 : PUSH 0xc
00a86027 : PUSH ECX
00a86028 : MOV EDI,EAX
00a8602a : CALL 0x00a0dd40
00a8602f : MOV byte ptr [EBX + 0x7c],0x1
00a86033 : JMP 0x00a86048
00a86035 : MOV ESI,dword ptr [0x00da98e8]
00a8603b : PUSH 0xc59858
00a86040 : CALL 0x008018d0
00a86045 : ADD ESP,0x4
00a86048 : MOV ECX,dword ptr [EBP + -0xc]
00a8604b : MOV dword ptr FS:[0x0],ECX
00a86052 : POP ECX
00a86053 : POP EDI
00a86054 : POP ESI
00a86055 : POP EBX
00a86056 : MOV ECX,dword ptr [EBP + -0x10]
00a86059 : XOR ECX,EBP
00a8605b : CALL 0x00633e6b
00a86060 : MOV ESP,EBP
00a86062 : POP EBP
00a86063 : RET 0x4

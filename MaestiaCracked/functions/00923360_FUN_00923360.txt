PROGRAM  : Maestia.exe
FUNCTION : FUN_00923360
ENTRY    : 00923360
BODY     : [[00923360, 009236c3]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00923360(void)

{
  int iVar1;
  char cVar2;
  undefined4 uVar3;
  int *piVar4;
  int iVar5;
  int iVar6;
  uint uVar7;
  uint uVar8;
  int *in_ECX;
  undefined1 local_40 [28];
  int *local_24;
  int local_20;
  uint local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3f8e3;
  local_10 = ExceptionList;
  if (((char)in_ECX[2] == '\0') || (iVar1 = *(int *)(in_ECX[1] + 0x128), iVar1 == 0)) {
    return;
  }
  ExceptionList = &local_10;
  if (*(char *)(iVar1 + 0x59) == '\0') {
    local_14 = (uint)*(ushort *)((int)in_ECX + 0x5e);
    local_1c = (uint)*(ushort *)(in_ECX + 0x18);
    piVar4 = (int *)(**(code **)(*in_ECX + 0x74))
                              (local_14,local_1c,DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
    local_24 = piVar4;
    if ((piVar4 == (int *)0x0) || ((char)piVar4[0xf] == '\0')) {
      cVar2 = (**(code **)(*in_ECX + 0x5c))(piVar4,iVar1);
      if (cVar2 != '\0') {
        ExceptionList = local_10;
        return;
      }
      local_20 = *(int *)(iVar1 + 0x40);
      if (local_20 == 0) {
        ExceptionList = local_10;
        return;
      }
      if (local_20 == 0x20) {
        ExceptionList = local_10;
        return;
      }
      if (local_20 == -1) {
        if (piVar4 == (int *)0x0) {
          ExceptionList = local_10;
          return;
        }
        if (*(char *)(*(int *)(*DAT_00da9894 + 0x1a4) + 0x50) != '\0') {
          FUN_009a4410(*(int *)(*DAT_00da9894 + 0x1a4),piVar4);
        }
        FUN_0097fb30(piVar4,local_14,local_1c);
        ExceptionList = local_10;
        return;
      }
      iVar5 = FUN_008eb580();
      if (iVar5 == 0) {
        ExceptionList = local_10;
        return;
      }
      iVar5 = local_14 + local_1c * 6;
      local_18 = (uint)*(ushort *)(iVar1 + 0x46);
      if (*(int *)(iVar1 + 0x4c) == 0) {
        uVar3 = 0;
      }
      else {
        uVar3 = *(undefined4 *)(*(int *)(iVar1 + 0x4c) + 0x10);
      }
      local_1c = (uint)*(ushort *)(iVar1 + 0x44);
      local_14 = iVar5;
      piVar4 = (int *)FUN_004049b0(uVar3);
      if (piVar4 == (int *)0x0) {
        ExceptionList = local_10;
        return;
      }
      iVar6 = (**(code **)(*piVar4 + 0x48))();
      if (iVar6 == 0) {
        FUN_008efa90(local_20,local_1c,local_18,0x44,iVar5,0);
        ExceptionList = local_10;
        return;
      }
      if (*(int *)(iVar1 + 0x4c) == 0) {
        ExceptionList = local_10;
        return;
      }
      uVar7 = FUN_00922700();
      if (uVar7 == 0) {
        FUN_00483f90(0x1d2,L"AvaGuiRecipe::OnLButtonDown");
        ExceptionList = local_10;
        return;
      }
      if (local_24 != (int *)0x0) {
        uVar8 = (**(code **)(*local_24 + 0x40))();
        uVar7 = uVar7 - (uVar8 & 0xffff);
      }
      if (uVar7 != 0) {
        uVar8 = FUN_0097f9f0();
        if ((uVar8 & 0xffff) < uVar7) {
          uVar7 = uVar8 & 0xffff;
        }
        if (uVar7 != 1) {
          FUN_00922620(local_20,local_1c,local_18,local_14,0);
          ExceptionList = local_10;
          return;
        }
        FUN_008ef980(local_20,local_1c,local_18,0x44,local_14,0,1);
        ExceptionList = local_10;
        return;
      }
      FUN_00406460(L"IDS_RECIPE_ENOUGH_COUNTS");
      local_8 = 4;
      piVar4 = *(int **)(in_ECX[1] + 0x1a8);
      uVar3 = FUN_0081d120(local_40);
      local_8._0_1_ = 5;
      (**(code **)(*piVar4 + 0x44))(uVar3,3);
      local_8 = CONCAT31(local_8._1_3_,4);
      FUN_00406560();
      local_8 = 0xffffffff;
      FUN_00406560();
      FUN_0097fa60();
      ExceptionList = local_10;
      return;
    }
    FUN_00406460(L"IDS_GUI_CANT_MOVE_USING_ITEM");
    local_8 = 2;
    piVar4 = *(int **)(in_ECX[1] + 0x1a8);
    uVar3 = FUN_0081d120(local_40);
    local_8._0_1_ = 3;
    (**(code **)(*piVar4 + 0x44))(uVar3,3);
    local_8 = CONCAT31(local_8._1_3_,2);
  }
  else {
    FUN_00406460(L"IDS_GUI_IS_REQUEST_DELETE");
    local_8 = 0;
    piVar4 = *(int **)(in_ECX[1] + 0x1a8);
    uVar3 = FUN_0081d120(local_40);
    local_8._0_1_ = 1;
    (**(code **)(*piVar4 + 0x44))(uVar3,3);
    local_8 = (uint)local_8._1_3_ << 8;
  }
  FUN_00406560();
  local_8 = 0xffffffff;
  FUN_00406560();
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00923360 : PUSH EBP
00923361 : MOV EBP,ESP
00923363 : PUSH -0x1
00923365 : PUSH 0xb3f8e3
0092336a : MOV EAX,FS:[0x0]
00923370 : PUSH EAX
00923371 : SUB ESP,0x4c
00923374 : PUSH EBX
00923375 : PUSH ESI
00923376 : PUSH EDI
00923377 : MOV EAX,[0x00d66fa0]
0092337c : XOR EAX,EBP
0092337e : PUSH EAX
0092337f : LEA EAX,[EBP + -0xc]
00923382 : MOV FS:[0x0],EAX
00923388 : MOV ESI,ECX
0092338a : MOV AL,byte ptr [ESI + 0x8]
0092338d : TEST AL,AL
0092338f : JZ 0x009236b2
00923395 : MOV EAX,dword ptr [ESI + 0x4]
00923398 : MOV EBX,dword ptr [EAX + 0x128]
0092339e : TEST EBX,EBX
009233a0 : JZ 0x009236b2
009233a6 : CMP byte ptr [EBX + 0x59],0x0
009233aa : JZ 0x00923418
009233ac : PUSH 0xc6a7e0
009233b1 : LEA ECX,[EBP + -0x3c]
009233b4 : CALL 0x00406460
009233b9 : MOV dword ptr [EBP + -0x4],0x0
009233c0 : MOV ECX,dword ptr [ESI + 0x4]
009233c3 : MOV ESI,dword ptr [ECX + 0x1a8]
009233c9 : MOV ECX,dword ptr [0x0172491c]
009233cf : LEA EDX,[EBP + -0x3c]
009233d2 : PUSH EDX
009233d3 : LEA EDI,[EBP + -0x58]
009233d6 : CALL 0x0081d120
009233db : MOV byte ptr [EBP + -0x4],0x1
009233df : MOV EDX,dword ptr [ESI]
009233e1 : PUSH 0x3
009233e3 : PUSH EAX
009233e4 : MOV EAX,dword ptr [EDX + 0x44]
009233e7 : MOV ECX,ESI
009233e9 : CALL EAX
009233eb : MOV byte ptr [EBP + -0x4],0x0
009233ef : LEA ECX,[EBP + -0x58]
009233f2 : CALL 0x00406560
009233f7 : MOV dword ptr [EBP + -0x4],0xffffffff
009233fe : LEA ECX,[EBP + -0x3c]
00923401 : CALL 0x00406560
00923406 : MOV ECX,dword ptr [EBP + -0xc]
00923409 : MOV dword ptr FS:[0x0],ECX
00923410 : POP ECX
00923411 : POP EDI
00923412 : POP ESI
00923413 : POP EBX
00923414 : MOV ESP,EBP
00923416 : POP EBP
00923417 : RET
00923418 : MOVZX EAX,word ptr [ESI + 0x5e]
0092341c : MOVZX ECX,AX
0092341f : MOV dword ptr [EBP + -0x10],ECX
00923422 : MOVZX ECX,word ptr [ESI + 0x60]
00923426 : MOVZX EDX,CX
00923429 : PUSH ECX
0092342a : MOV dword ptr [EBP + -0x18],EDX
0092342d : MOV EDX,dword ptr [ESI]
0092342f : PUSH EAX
00923430 : MOV EAX,dword ptr [EDX + 0x74]
00923433 : MOV ECX,ESI
00923435 : CALL EAX
00923437 : MOV EDI,EAX
00923439 : MOV dword ptr [EBP + -0x20],EDI
0092343c : TEST EDI,EDI
0092343e : JZ 0x0092348e
00923440 : CMP byte ptr [EDI + 0x3c],0x0
00923444 : JZ 0x0092348e
00923446 : PUSH 0xc6a814
0092344b : LEA ECX,[EBP + -0x3c]
0092344e : CALL 0x00406460
00923453 : MOV EBX,0x2
00923458 : MOV dword ptr [EBP + -0x4],EBX
0092345b : MOV ECX,dword ptr [ESI + 0x4]
0092345e : MOV ESI,dword ptr [ECX + 0x1a8]
00923464 : MOV ECX,dword ptr [0x0172491c]
0092346a : LEA EDX,[EBP + -0x3c]
0092346d : PUSH EDX
0092346e : LEA EDI,[EBP + -0x58]
00923471 : CALL 0x0081d120
00923476 : MOV byte ptr [EBP + -0x4],0x3
0092347a : MOV EDX,dword ptr [ESI]
0092347c : PUSH 0x3
0092347e : PUSH EAX
0092347f : MOV EAX,dword ptr [EDX + 0x44]
00923482 : MOV ECX,ESI
00923484 : CALL EAX
00923486 : MOV byte ptr [EBP + -0x4],BL
00923489 : JMP 0x009233ef
0092348e : MOV EDX,dword ptr [ESI]
00923490 : MOV EAX,dword ptr [EDX + 0x5c]
00923493 : PUSH EBX
00923494 : PUSH EDI
00923495 : MOV ECX,ESI
00923497 : CALL EAX
00923499 : TEST AL,AL
0092349b : JNZ 0x009236b2
009234a1 : MOV EAX,dword ptr [EBX + 0x40]
009234a4 : MOV dword ptr [EBP + -0x1c],EAX
009234a7 : TEST EAX,EAX
009234a9 : JZ 0x009236b2
009234af : CMP EAX,0x20
009234b2 : JZ 0x009236b2
009234b8 : CMP EAX,-0x1
009234bb : JZ 0x00923681
009234c1 : MOV EDI,EAX
009234c3 : MOV EAX,dword ptr [ESI + 0x4]
009234c6 : CALL 0x008eb580
009234cb : TEST EAX,EAX
009234cd : JZ 0x009236b2
009234d3 : MOV EAX,dword ptr [EBP + -0x18]
009234d6 : MOV EDX,dword ptr [EBP + -0x10]
009234d9 : LEA ECX,[EAX + EAX*0x2]
009234dc : MOVZX EAX,word ptr [EBX + 0x44]
009234e0 : LEA EDI,[EDX + ECX*0x2]
009234e3 : MOVZX ECX,word ptr [EBX + 0x46]
009234e7 : MOV dword ptr [EBP + -0x18],EAX
009234ea : MOV EAX,dword ptr [EBX + 0x4c]
009234ed : MOV dword ptr [EBP + -0x10],EDI
009234f0 : MOV dword ptr [EBP + -0x14],ECX
009234f3 : TEST EAX,EAX
009234f5 : JZ 0x009234fc
009234f7 : MOV EAX,dword ptr [EAX + 0x10]
009234fa : JMP 0x009234fe
009234fc : XOR EAX,EAX
009234fe : PUSH EAX
009234ff : CALL 0x004049b0
00923504 : ADD ESP,0x4
00923507 : TEST EAX,EAX
00923509 : JZ 0x009236b2
0092350f : MOV EDX,dword ptr [EAX]
00923511 : MOV ECX,EAX
00923513 : MOV EAX,dword ptr [EDX + 0x48]
00923516 : CALL EAX
00923518 : TEST EAX,EAX
0092351a : JZ 0x00923656
00923520 : MOV EAX,dword ptr [EBX + 0x4c]
00923523 : TEST EAX,EAX
00923525 : JZ 0x009236b2
0092352b : MOV EDI,dword ptr [EAX + 0x10]
0092352e : MOV ECX,ESI
00923530 : CALL 0x00922700
00923535 : MOV EDI,EAX
00923537 : TEST EDI,EDI
00923539 : JNZ 0x0092355f
0092353b : PUSH 0xc6a850
00923540 : PUSH 0x1d2
00923545 : CALL 0x00483f90
0092354a : ADD ESP,0x8
0092354d : MOV ECX,dword ptr [EBP + -0xc]
00923550 : MOV dword ptr FS:[0x0],ECX
00923557 : POP ECX
00923558 : POP EDI
00923559 : POP ESI
0092355a : POP EBX
0092355b : MOV ESP,EBP
0092355d : POP EBP
0092355e : RET
0092355f : MOV ECX,dword ptr [EBP + -0x20]
00923562 : TEST ECX,ECX
00923564 : JZ 0x00923572
00923566 : MOV EDX,dword ptr [ECX]
00923568 : MOV EAX,dword ptr [EDX + 0x40]
0092356b : CALL EAX
0092356d : MOVZX ECX,AX
00923570 : SUB EDI,ECX
00923572 : TEST EDI,EDI
00923574 : JNZ 0x009235e8
00923576 : PUSH 0xc6a8d4
0092357b : LEA ECX,[EBP + -0x3c]
0092357e : CALL 0x00406460
00923583 : MOV dword ptr [EBP + -0x4],0x4
0092358a : MOV EDX,dword ptr [ESI + 0x4]
0092358d : MOV ECX,dword ptr [0x0172491c]
00923593 : MOV ESI,dword ptr [EDX + 0x1a8]
00923599 : LEA EAX,[EBP + -0x3c]
0092359c : PUSH EAX
0092359d : LEA EDI,[EBP + -0x58]
009235a0 : CALL 0x0081d120
009235a5 : MOV byte ptr [EBP + -0x4],0x5
009235a9 : MOV EDX,dword ptr [ESI]
009235ab : PUSH 0x3
009235ad : PUSH EAX
009235ae : MOV EAX,dword ptr [EDX + 0x44]
009235b1 : MOV ECX,ESI
009235b3 : CALL EAX
009235b5 : MOV byte ptr [EBP + -0x4],0x4
009235b9 : MOV ECX,EDI
009235bb : CALL 0x00406560
009235c0 : MOV dword ptr [EBP + -0x4],0xffffffff
009235c7 : LEA ECX,[EBP + -0x3c]
009235ca : CALL 0x00406560
009235cf : MOV ECX,EBX
009235d1 : CALL 0x0097fa60
009235d6 : MOV ECX,dword ptr [EBP + -0xc]
009235d9 : MOV dword ptr FS:[0x0],ECX
009235e0 : POP ECX
009235e1 : POP EDI
009235e2 : POP ESI
009235e3 : POP EBX
009235e4 : MOV ESP,EBP
009235e6 : POP EBP
009235e7 : RET
009235e8 : MOV EAX,EBX
009235ea : CALL 0x0097f9f0
009235ef : MOVZX EAX,AX
009235f2 : CMP EAX,EDI
009235f4 : CMOVC EDI,EAX
009235f7 : CMP EDI,0x1
009235fa : JNZ 0x0092362b
009235fc : MOV ECX,dword ptr [EBP + -0x10]
009235ff : MOV EDX,dword ptr [EBP + -0x14]
00923602 : MOV EAX,dword ptr [EBP + -0x18]
00923605 : PUSH EDI
00923606 : PUSH 0x0
00923608 : PUSH ECX
00923609 : MOV ECX,dword ptr [EBP + -0x1c]
0092360c : PUSH 0x44
0092360e : PUSH EDX
0092360f : PUSH EAX
00923610 : PUSH ECX
00923611 : CALL 0x008ef980
00923616 : ADD ESP,0x1c
00923619 : MOV ECX,dword ptr [EBP + -0xc]
0092361c : MOV dword ptr FS:[0x0],ECX
00923623 : POP ECX
00923624 : POP EDI
00923625 : POP ESI
00923626 : POP EBX
00923627 : MOV ESP,EBP
00923629 : POP EBP
0092362a : RET
0092362b : MOV EDX,dword ptr [EBP + -0x10]
0092362e : MOV EAX,dword ptr [EBP + -0x14]
00923631 : MOV ECX,dword ptr [EBP + -0x18]
00923634 : PUSH 0x0
00923636 : PUSH EDX
00923637 : MOV EDX,dword ptr [EBP + -0x1c]
0092363a : PUSH EAX
0092363b : PUSH ECX
0092363c : PUSH EDX
0092363d : MOV EDX,EDI
0092363f : CALL 0x00922620
00923644 : MOV ECX,dword ptr [EBP + -0xc]
00923647 : MOV dword ptr FS:[0x0],ECX
0092364e : POP ECX
0092364f : POP EDI
00923650 : POP ESI
00923651 : POP EBX
00923652 : MOV ESP,EBP
00923654 : POP EBP
00923655 : RET
00923656 : MOV EAX,dword ptr [EBP + -0x14]
00923659 : MOV ECX,dword ptr [EBP + -0x18]
0092365c : MOV EDX,dword ptr [EBP + -0x1c]
0092365f : PUSH 0x0
00923661 : PUSH EDI
00923662 : PUSH 0x44
00923664 : PUSH EAX
00923665 : PUSH ECX
00923666 : PUSH EDX
00923667 : CALL 0x008efa90
0092366c : ADD ESP,0x18
0092366f : MOV ECX,dword ptr [EBP + -0xc]
00923672 : MOV dword ptr FS:[0x0],ECX
00923679 : POP ECX
0092367a : POP EDI
0092367b : POP ESI
0092367c : POP EBX
0092367d : MOV ESP,EBP
0092367f : POP EBP
00923680 : RET
00923681 : TEST EDI,EDI
00923683 : JZ 0x009236b2
00923685 : MOV EAX,[0x00da9894]
0092368a : MOV ECX,dword ptr [EAX]
0092368c : MOV EAX,dword ptr [ECX + 0x1a4]
00923692 : CMP byte ptr [EAX + 0x50],0x0
00923696 : JZ 0x0092369f
00923698 : PUSH EDI
00923699 : PUSH EAX
0092369a : CALL 0x009a4410
0092369f : MOV EDX,dword ptr [EBP + -0x18]
009236a2 : MOV EAX,dword ptr [EBP + -0x10]
009236a5 : PUSH EDX
009236a6 : PUSH EAX
009236a7 : MOV EAX,dword ptr [ESI + 0x2c]
009236aa : PUSH EDI
009236ab : MOV ECX,EBX
009236ad : CALL 0x0097fb30
009236b2 : MOV ECX,dword ptr [EBP + -0xc]
009236b5 : MOV dword ptr FS:[0x0],ECX
009236bc : POP ECX
009236bd : POP EDI
009236be : POP ESI
009236bf : POP EBX
009236c0 : MOV ESP,EBP
009236c2 : POP EBP
009236c3 : RET

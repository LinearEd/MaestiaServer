PROGRAM  : Maestia.exe
FUNCTION : FUN_009cb290
ENTRY    : 009cb290
BODY     : [[009cb290, 009cb346]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009cb290(int param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  uint8_t *packet;
  byte bVar2;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_00b41eb2;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  *(undefined1 *)(param_1 + 0x50) = 1;
  *(undefined4 *)(param_1 + 0x38) = param_3;
  iVar1 = *(int *)ThreadLocalStoragePointer;
  bVar2 = (byte)((ulonglong)(*(byte *)(iVar1 + 0x18) + 1) % 3);
  *(byte *)(iVar1 + 0x18) = bVar2;
  packet = (uint8_t *)((uint)bVar2 * 0x2000 + 0x122cb8 + iVar1);
  if (packet == (uint8_t *)0x0) {
    packet = (uint8_t *)0x0;
  }
  else {
    packet[0] = '\0';
    packet[1] = '\0';
    packet[2] = 'd';
    packet[3] = '\x01';
    *(undefined4 *)(packet + 4) = param_2;
    packet[8] = (uint8_t)param_3;
  }
  local_8 = 0xffffffff;
  if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
    FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),9,packet);
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
009cb290 : PUSH EBP
009cb291 : MOV EBP,ESP
009cb293 : PUSH -0x1
009cb295 : PUSH 0xb41eb2
009cb29a : MOV EAX,FS:[0x0]
009cb2a0 : PUSH EAX
009cb2a1 : PUSH EBX
009cb2a2 : PUSH ESI
009cb2a3 : PUSH EDI
009cb2a4 : MOV EAX,[0x00d66fa0]
009cb2a9 : XOR EAX,EBP
009cb2ab : PUSH EAX
009cb2ac : LEA EAX,[EBP + -0xc]
009cb2af : MOV FS:[0x0],EAX
009cb2b5 : MOV EBX,dword ptr [EBP + 0x10]
009cb2b8 : MOV EAX,dword ptr [EBP + 0x8]
009cb2bb : MOV byte ptr [EAX + 0x50],0x1
009cb2bf : MOV dword ptr [EAX + 0x38],EBX
009cb2c2 : MOV EAX,FS:[0x2c]
009cb2c8 : MOV ECX,dword ptr [EAX]
009cb2ca : MOVZX EAX,byte ptr [ECX + 0x18]
009cb2ce : INC EAX
009cb2cf : CDQ
009cb2d0 : MOV ESI,0x3
009cb2d5 : IDIV ESI
009cb2d7 : MOV byte ptr [ECX + 0x18],DL
009cb2da : MOVZX EDX,DL
009cb2dd : SHL EDX,0xd
009cb2e0 : LEA EAX,[EDX + ECX*0x1 + 0x122cb8]
009cb2e7 : MOV dword ptr [EBP + 0x10],EAX
009cb2ea : MOV dword ptr [EBP + -0x4],0x0
009cb2f1 : TEST EAX,EAX
009cb2f3 : JZ 0x009cb30d
009cb2f5 : MOV EDX,dword ptr [EBP + 0xc]
009cb2f8 : XOR ECX,ECX
009cb2fa : MOV word ptr [EAX],CX
009cb2fd : MOV byte ptr [EAX + 0x2],0x64
009cb301 : MOV byte ptr [EAX + 0x3],0x1
009cb305 : MOV dword ptr [EAX + 0x4],EDX
009cb308 : MOV byte ptr [EAX + 0x8],BL
009cb30b : JMP 0x009cb30f
009cb30d : XOR EAX,EAX
009cb30f : MOV dword ptr [EBP + -0x4],0xffffffff
009cb316 : MOV EDX,dword ptr [0x017247d4]
009cb31c : MOV ECX,dword ptr [EDX + 0x4]
009cb31f : TEST ECX,ECX
009cb321 : JZ 0x009cb333
009cb323 : CMP byte ptr [EDX + 0x8],0x0
009cb327 : JZ 0x009cb333
009cb329 : PUSH 0x9
009cb32b : PUSH ECX
009cb32c : MOV EDI,EAX
009cb32e : CALL 0x00a0dd40
009cb333 : MOV ECX,dword ptr [EBP + -0xc]
009cb336 : MOV dword ptr FS:[0x0],ECX
009cb33d : POP ECX
009cb33e : POP EDI
009cb33f : POP ESI
009cb340 : POP EBX
009cb341 : MOV ESP,EBP
009cb343 : POP EBP
009cb344 : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_00570c00
ENTRY    : 00570c00
BODY     : [[00570c00, 00570d44]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00570c00(undefined4 param_1,uint *param_2,uint param_3)

{
  uint *puVar1;
  uint *puVar2;
  uint *puVar3;
  int *piVar4;
  int *in_ECX;
  uint uVar5;
  uint uVar6;
  int iVar7;
  
  piVar4 = (int *)*in_ECX;
  if (piVar4 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar4 * 5) <= piVar4[1] * 4 + 4U) goto LAB_00570c3a;
    iVar7 = piVar4[1] * 2 + 2;
  }
  FUN_005702f0(param_1,iVar7);
LAB_00570c3a:
  piVar4 = (int *)*in_ECX;
  param_3 = param_3 & piVar4[1];
  *piVar4 = *piVar4 + 1;
  iVar7 = *in_ECX;
  puVar1 = (uint *)(iVar7 + 8 + param_3 * 0xc);
  if (*puVar1 == 0xfffffffe) {
    *puVar1 = 0xffffffff;
    uVar6 = *param_2;
    puVar1[1] = uVar6;
    piVar4 = (int *)(uVar6 + 8);
    *piVar4 = *piVar4 + 1;
    puVar1[2] = param_2[1];
    return;
  }
  uVar6 = param_3;
  do {
    uVar6 = uVar6 + 1 & *(uint *)(iVar7 + 4);
  } while (*(int *)(iVar7 + 8 + uVar6 * 0xc) != -2);
  puVar2 = (uint *)(iVar7 + 8 + uVar6 * 0xc);
  uVar5 = *(uint *)(puVar1[1] + 0xc) & *(uint *)(iVar7 + 4);
  if (uVar5 == param_3) {
    if (puVar2 != (uint *)0x0) {
      *puVar2 = *puVar1;
      uVar5 = puVar1[1];
      puVar2[1] = uVar5;
      piVar4 = (int *)(uVar5 + 8);
      *piVar4 = *piVar4 + 1;
      puVar2[2] = puVar1[2];
    }
    uVar5 = *param_2;
    piVar4 = (int *)(uVar5 + 8);
    *piVar4 = *piVar4 + 1;
    piVar4 = (int *)(puVar1[1] + 8);
    *piVar4 = *piVar4 + -1;
    if (*piVar4 == 0) {
      FUN_00525340();
    }
    puVar1[1] = uVar5;
    puVar1[2] = param_2[1];
    *puVar1 = uVar6;
    return;
  }
  puVar3 = (uint *)(iVar7 + 8 + uVar5 * 0xc);
  for (uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0xc); uVar5 != param_3;
      uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0xc)) {
    uVar5 = *puVar3;
    puVar3 = (uint *)(iVar7 + 8 + uVar5 * 0xc);
  }
  if (puVar2 != (uint *)0x0) {
    *puVar2 = *puVar1;
    uVar5 = puVar1[1];
    puVar2[1] = uVar5;
    piVar4 = (int *)(uVar5 + 8);
    *piVar4 = *piVar4 + 1;
    puVar2[2] = puVar1[2];
  }
  *puVar3 = uVar6;
  uVar6 = *param_2;
  piVar4 = (int *)(uVar6 + 8);
  *piVar4 = *piVar4 + 1;
  piVar4 = (int *)(puVar1[1] + 8);
  *piVar4 = *piVar4 + -1;
  if (*piVar4 == 0) {
    FUN_00525340();
  }
  puVar1[1] = uVar6;
  puVar1[2] = param_2[1];
  *puVar1 = 0xffffffff;
  return;
}



============================================================
DISASSEMBLY
============================================================
00570c00 : PUSH EBX
00570c01 : PUSH ESI
00570c02 : MOV ESI,ECX
00570c04 : MOV EAX,dword ptr [ESI]
00570c06 : TEST EAX,EAX
00570c08 : JNZ 0x00570c13
00570c0a : MOV EAX,dword ptr [ESP + 0xc]
00570c0e : PUSH 0x8
00570c10 : PUSH EAX
00570c11 : JMP 0x00570c35
00570c13 : MOV ECX,dword ptr [EAX + 0x4]
00570c16 : LEA EDX,[ECX*0x4 + 0x4]
00570c1d : MOV ECX,dword ptr [EAX]
00570c1f : LEA ECX,[ECX + ECX*0x4]
00570c22 : CMP ECX,EDX
00570c24 : JBE 0x00570c3a
00570c26 : MOV EDX,dword ptr [EAX + 0x4]
00570c29 : MOV ECX,dword ptr [ESP + 0xc]
00570c2d : LEA EAX,[EDX + EDX*0x1 + 0x2]
00570c31 : PUSH EAX
00570c32 : PUSH ECX
00570c33 : MOV ECX,ESI
00570c35 : CALL 0x005702f0
00570c3a : MOV ECX,dword ptr [ESI]
00570c3c : MOV EAX,dword ptr [ESP + 0x14]
00570c40 : AND EAX,dword ptr [ECX + 0x4]
00570c43 : INC dword ptr [ECX]
00570c45 : MOV ECX,dword ptr [ESI]
00570c47 : LEA EDX,[EAX + EAX*0x2]
00570c4a : LEA ESI,[ECX + EDX*0x4 + 0x8]
00570c4e : MOV EDX,dword ptr [ESI]
00570c50 : MOV EBX,0xfffffffe
00570c55 : CMP EDX,EBX
00570c57 : JNZ 0x00570c76
00570c59 : MOV ECX,dword ptr [ESP + 0x10]
00570c5d : MOV dword ptr [ESI],0xffffffff
00570c63 : MOV EAX,dword ptr [ECX]
00570c65 : MOV dword ptr [ESI + 0x4],EAX
00570c68 : INC dword ptr [EAX + 0x8]
00570c6b : MOV EAX,dword ptr [ECX + 0x4]
00570c6e : MOV dword ptr [ESI + 0x8],EAX
00570c71 : POP ESI
00570c72 : POP EBX
00570c73 : RET 0xc
00570c76 : PUSH EBP
00570c77 : MOV EBP,dword ptr [ECX + 0x4]
00570c7a : PUSH EDI
00570c7b : MOV EDI,EAX
00570c7d : LEA ECX,[ECX]
00570c80 : INC EDI
00570c81 : AND EDI,EBP
00570c83 : LEA EDX,[EDI + EDI*0x2]
00570c86 : CMP dword ptr [ECX + EDX*0x4 + 0x8],EBX
00570c8a : JNZ 0x00570c80
00570c8c : LEA EDX,[EDI + EDI*0x2]
00570c8f : LEA EBX,[ECX + EDX*0x4 + 0x8]
00570c93 : MOV EDX,dword ptr [ESI + 0x4]
00570c96 : MOV EDX,dword ptr [EDX + 0xc]
00570c99 : AND EDX,EBP
00570c9b : CMP EDX,EAX
00570c9d : JNZ 0x00570ce0
00570c9f : TEST EBX,EBX
00570ca1 : JZ 0x00570cb6
00570ca3 : MOV EAX,dword ptr [ESI]
00570ca5 : MOV dword ptr [EBX],EAX
00570ca7 : MOV EAX,dword ptr [ESI + 0x4]
00570caa : MOV dword ptr [EBX + 0x4],EAX
00570cad : INC dword ptr [EAX + 0x8]
00570cb0 : MOV EAX,dword ptr [ESI + 0x8]
00570cb3 : MOV dword ptr [EBX + 0x8],EAX
00570cb6 : MOV EBP,dword ptr [ESP + 0x18]
00570cba : MOV EBX,dword ptr [EBP]
00570cbd : INC dword ptr [EBX + 0x8]
00570cc0 : MOV ECX,dword ptr [ESI + 0x4]
00570cc3 : ADD dword ptr [ECX + 0x8],-0x1
00570cc7 : JNZ 0x00570cce
00570cc9 : CALL 0x00525340
00570cce : MOV dword ptr [ESI + 0x4],EBX
00570cd1 : MOV ECX,dword ptr [EBP + 0x4]
00570cd4 : MOV dword ptr [ESI + 0x8],ECX
00570cd7 : MOV dword ptr [ESI],EDI
00570cd9 : POP EDI
00570cda : POP EBP
00570cdb : POP ESI
00570cdc : POP EBX
00570cdd : RET 0xc
00570ce0 : LEA EDX,[EDX + EDX*0x2]
00570ce3 : CMP dword ptr [ECX + EDX*0x4 + 0x8],EAX
00570ce7 : LEA EDX,[ECX + EDX*0x4 + 0x8]
00570ceb : JZ 0x00570cff
00570ced : LEA ECX,[ECX]
00570cf0 : MOV EDX,dword ptr [EDX]
00570cf2 : LEA EDX,[EDX + EDX*0x2]
00570cf5 : CMP dword ptr [ECX + EDX*0x4 + 0x8],EAX
00570cf9 : LEA EDX,[ECX + EDX*0x4 + 0x8]
00570cfd : JNZ 0x00570cf0
00570cff : TEST EBX,EBX
00570d01 : JZ 0x00570d16
00570d03 : MOV EAX,dword ptr [ESI]
00570d05 : MOV dword ptr [EBX],EAX
00570d07 : MOV EAX,dword ptr [ESI + 0x4]
00570d0a : MOV dword ptr [EBX + 0x4],EAX
00570d0d : INC dword ptr [EAX + 0x8]
00570d10 : MOV EAX,dword ptr [ESI + 0x8]
00570d13 : MOV dword ptr [EBX + 0x8],EAX
00570d16 : MOV EBX,dword ptr [ESP + 0x18]
00570d1a : MOV dword ptr [EDX],EDI
00570d1c : MOV EDI,dword ptr [EBX]
00570d1e : INC dword ptr [EDI + 0x8]
00570d21 : MOV ECX,dword ptr [ESI + 0x4]
00570d24 : ADD dword ptr [ECX + 0x8],-0x1
00570d28 : JNZ 0x00570d2f
00570d2a : CALL 0x00525340
00570d2f : MOV dword ptr [ESI + 0x4],EDI
00570d32 : MOV ECX,dword ptr [EBX + 0x4]
00570d35 : POP EDI
00570d36 : MOV dword ptr [ESI + 0x8],ECX
00570d39 : POP EBP
00570d3a : MOV dword ptr [ESI],0xffffffff
00570d40 : POP ESI
00570d41 : POP EBX
00570d42 : RET 0xc

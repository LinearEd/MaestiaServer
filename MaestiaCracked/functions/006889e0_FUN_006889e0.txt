PROGRAM  : Maestia.exe
FUNCTION : FUN_006889e0
ENTRY    : 006889e0
BODY     : [[006889e0, 00688bb5]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006889e0(int param_1,byte *param_2,int param_3)

{
  undefined4 *puVar1;
  byte *pbVar2;
  byte bVar3;
  byte bVar4;
  undefined2 uVar5;
  bool bVar6;
  int iVar7;
  uint uVar8;
  uint *puVar9;
  uint *puVar10;
  sbyte sVar11;
  
  iVar7 = param_1;
  puVar1 = (undefined4 *)(param_1 + 0x20);
  bVar6 = false;
  if (param_2 == (byte *)0x0) {
    return 6;
  }
  bVar3 = *param_2;
  param_1 = 0;
  puVar9 = (uint *)*puVar1;
  while (bVar3 - 4 < 0x16) {
    switch(bVar3 - 4) {
    case 4:
      param_1 = FUN_00688900(iVar7,*(undefined2 *)(param_2 + 2));
      if (param_1 == 0) {
        puVar10 = *(uint **)(iVar7 + 0x20);
        bVar6 = true;
        goto LAB_00688b71;
      }
      goto LAB_00688b89;
    default:
      goto switchD_00688a27_caseD_5;
    case 8:
    case 9:
      uVar8 = (uint)(byte)*puVar9;
      puVar10 = (uint *)((int)puVar9 + 1);
      sVar11 = 0x18;
      break;
    case 0xc:
    case 0xd:
      puVar10 = (uint *)((int)puVar9 + 2);
      uVar8 = (uint)CONCAT11((byte)*puVar9,*(byte *)((int)puVar9 + 1));
      sVar11 = 0x10;
      break;
    case 0xe:
    case 0xf:
      puVar10 = (uint *)((int)puVar9 + 2);
      uVar8 = (uint)(ushort)*puVar9;
      sVar11 = 0x10;
      break;
    case 0x10:
    case 0x11:
      puVar10 = puVar9 + 1;
      uVar8 = CONCAT31(CONCAT21(CONCAT11((byte)*puVar9,*(byte *)((int)puVar9 + 1)),
                                *(byte *)((int)puVar9 + 2)),*(byte *)((int)puVar9 + 3));
      sVar11 = 0;
      break;
    case 0x12:
    case 0x13:
      puVar10 = puVar9 + 1;
      uVar8 = *puVar9;
      sVar11 = 0;
      break;
    case 0x14:
    case 0x15:
      uVar5 = CONCAT11((byte)*puVar9,*(byte *)((int)puVar9 + 1));
      bVar4 = *(byte *)((int)puVar9 + 2);
      goto LAB_00688b3d;
    case 0x16:
    case 0x17:
                    /* WARNING: This code block may not be properly labeled as switch case */
      uVar5 = *(undefined2 *)((int)puVar9 + 1);
      bVar4 = (byte)*puVar9;
LAB_00688b3d:
      puVar10 = (uint *)((int)puVar9 + 3);
      uVar8 = (uint)CONCAT21(uVar5,bVar4);
      sVar11 = 8;
      break;
    case 0x18:
    case 0x19:
                    /* WARNING: This code block may not be properly labeled as switch case */
      puVar10 = (uint *)((uint)param_2[1] + (int)puVar9);
      if (puVar10 <= *(uint **)(iVar7 + 0x24)) {
        if (bVar3 == 0x18) {
          _memcpy((void *)((uint)*(ushort *)(param_2 + 2) + param_3),puVar9,(uint)param_2[1]);
        }
        goto LAB_00688b71;
      }
      param_1 = 0x55;
      goto LAB_00688b89;
    }
    if ((bVar3 & 1) != 0) {
      uVar8 = (int)(uVar8 << sVar11) >> sVar11;
    }
    puVar9 = (uint *)((uint)*(ushort *)(param_2 + 2) + param_3);
    if (param_2[1] == 1) {
      *(char *)puVar9 = (char)uVar8;
    }
    else if (param_2[1] == 2) {
      *(short *)puVar9 = (short)uVar8;
    }
    else {
      *puVar9 = uVar8;
    }
LAB_00688b71:
    pbVar2 = param_2 + 4;
    param_2 = param_2 + 4;
    puVar9 = puVar10;
    bVar3 = *pbVar2;
  }
switchD_00688a27_caseD_5:
  *(uint **)(iVar7 + 0x20) = puVar9;
LAB_00688b89:
  if (bVar6) {
    FUN_006889b0(iVar7);
  }
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
006889e0 : PUSH ECX
006889e1 : PUSH EBP
006889e2 : MOV EBP,dword ptr [ESP + 0xc]
006889e6 : MOV EDX,dword ptr [EBP + 0x20]
006889e9 : PUSH EDI
006889ea : MOV EDI,dword ptr [ESP + 0x14]
006889ee : MOV byte ptr [ESP + 0xb],0x0
006889f3 : TEST EDI,EDI
006889f5 : JZ 0x00688bad
006889fb : MOV CL,byte ptr [EDI]
006889fd : MOVZX EAX,CL
00688a00 : SUB EAX,0x4
00688a03 : PUSH EBX
00688a04 : PUSH ESI
00688a05 : MOV dword ptr [ESP + 0x18],0x0
00688a0d : CMP EAX,0x15
00688a10 : JA 0x00688b86
00688a16 : MOV EBX,dword ptr [ESP + 0x20]
00688a1a : LEA EBX,[EBX]
00688a20 : MOVZX EAX,byte ptr [EAX + 0x688be0]
00688a27 : JMP dword ptr [EAX*0x4 + 0x688bb8]
00688a2e : MOVZX ECX,word ptr [EDI + 0x2]
00688a32 : PUSH ECX
00688a33 : PUSH EBP
00688a34 : CALL 0x00688900
00688a39 : ADD ESP,0x8
00688a3c : MOV dword ptr [ESP + 0x18],EAX
00688a40 : TEST EAX,EAX
00688a42 : JNZ 0x00688b89
00688a48 : MOV EDX,dword ptr [EBP + 0x20]
00688a4b : MOV byte ptr [ESP + 0x13],0x1
00688a50 : JMP 0x00688b71
00688a55 : MOVZX EAX,byte ptr [EDI + 0x1]
00688a59 : LEA ESI,[EAX + EDX*0x1]
00688a5c : CMP ESI,dword ptr [EBP + 0x24]
00688a5f : JA 0x00688ba3
00688a65 : CMP CL,0x18
00688a68 : JNZ 0x00688a7b
00688a6a : PUSH EAX
00688a6b : PUSH EDX
00688a6c : MOVZX EDX,word ptr [EDI + 0x2]
00688a70 : ADD EDX,EBX
00688a72 : PUSH EDX
00688a73 : CALL 0x0063ae40
00688a78 : ADD ESP,0xc
00688a7b : MOV EDX,ESI
00688a7d : JMP 0x00688b71
00688a82 : MOVZX EAX,byte ptr [EDX]
00688a85 : INC EDX
00688a86 : MOV ESI,0x18
00688a8b : JMP 0x00688b47
00688a90 : MOVZX AX,byte ptr [EDX]
00688a94 : MOVZX ESI,byte ptr [EDX + 0x1]
00688a98 : ADD EDX,0x2
00688a9b : SHL AX,0x8
00688a9f : MOVZX EAX,AX
00688aa2 : OR EAX,ESI
00688aa4 : MOV ESI,0x10
00688aa9 : JMP 0x00688b47
00688aae : MOVZX AX,byte ptr [EDX + 0x1]
00688ab3 : MOVZX ESI,byte ptr [EDX]
00688ab6 : ADD EDX,0x2
00688ab9 : SHL AX,0x8
00688abd : MOVZX EAX,AX
00688ac0 : OR EAX,ESI
00688ac2 : MOV ESI,0x10
00688ac7 : JMP 0x00688b47
00688ac9 : MOVZX EAX,byte ptr [EDX]
00688acc : MOVZX ESI,byte ptr [EDX + 0x1]
00688ad0 : ADD EDX,0x4
00688ad3 : SHL EAX,0x8
00688ad6 : OR EAX,ESI
00688ad8 : MOVZX ESI,byte ptr [EDX + -0x2]
00688adc : SHL EAX,0x8
00688adf : OR EAX,ESI
00688ae1 : MOVZX ESI,byte ptr [EDX + -0x1]
00688ae5 : SHL EAX,0x8
00688ae8 : OR EAX,ESI
00688aea : XOR ESI,ESI
00688aec : JMP 0x00688b47
00688aee : MOVZX EAX,byte ptr [EDX + 0x3]
00688af2 : MOVZX ESI,byte ptr [EDX + 0x2]
00688af6 : ADD EDX,0x4
00688af9 : SHL EAX,0x8
00688afc : OR EAX,ESI
00688afe : MOVZX ESI,byte ptr [EDX + -0x3]
00688b02 : SHL EAX,0x8
00688b05 : OR EAX,ESI
00688b07 : MOVZX ESI,byte ptr [EDX + -0x4]
00688b0b : SHL EAX,0x8
00688b0e : OR EAX,ESI
00688b10 : XOR ESI,ESI
00688b12 : JMP 0x00688b47
00688b14 : MOVZX EAX,byte ptr [EDX]
00688b17 : MOVZX ESI,byte ptr [EDX + 0x1]
00688b1b : ADD EDX,0x3
00688b1e : SHL EAX,0x8
00688b21 : OR EAX,ESI
00688b23 : MOVZX ESI,byte ptr [EDX + -0x1]
00688b27 : JMP 0x00688b3d
00688b29 : MOVZX EAX,byte ptr [EDX + 0x2]
00688b2d : MOVZX ESI,byte ptr [EDX + 0x1]
00688b31 : ADD EDX,0x3
00688b34 : SHL EAX,0x8
00688b37 : OR EAX,ESI
00688b39 : MOVZX ESI,byte ptr [EDX + -0x3]
00688b3d : SHL EAX,0x8
00688b40 : OR EAX,ESI
00688b42 : MOV ESI,0x8
00688b47 : TEST CL,0x1
00688b4a : JZ 0x00688b52
00688b4c : MOV ECX,ESI
00688b4e : SHL EAX,CL
00688b50 : SAR EAX,CL
00688b52 : MOVZX ECX,word ptr [EDI + 0x2]
00688b56 : MOVZX ESI,byte ptr [EDI + 0x1]
00688b5a : ADD ECX,EBX
00688b5c : SUB ESI,0x1
00688b5f : JZ 0x00688b6f
00688b61 : SUB ESI,0x1
00688b64 : JZ 0x00688b6a
00688b66 : MOV dword ptr [ECX],EAX
00688b68 : JMP 0x00688b71
00688b6a : MOV word ptr [ECX],AX
00688b6d : JMP 0x00688b71
00688b6f : MOV byte ptr [ECX],AL
00688b71 : MOV CL,byte ptr [EDI + 0x4]
00688b74 : ADD EDI,0x4
00688b77 : MOVZX EAX,CL
00688b7a : SUB EAX,0x4
00688b7d : CMP EAX,0x15
00688b80 : JBE 0x00688a20
00688b86 : MOV dword ptr [EBP + 0x20],EDX
00688b89 : CMP byte ptr [ESP + 0x13],0x0
00688b8e : POP ESI
00688b8f : POP EBX
00688b90 : JZ 0x00688b9b
00688b92 : PUSH EBP
00688b93 : CALL 0x006889b0
00688b98 : ADD ESP,0x4
00688b9b : MOV EAX,dword ptr [ESP + 0x10]
00688b9f : POP EDI
00688ba0 : POP EBP
00688ba1 : POP ECX
00688ba2 : RET
00688ba3 : MOV dword ptr [ESP + 0x18],0x55
00688bab : JMP 0x00688b89
00688bad : POP EDI
00688bae : MOV EAX,0x6
00688bb3 : POP EBP
00688bb4 : POP ECX
00688bb5 : RET

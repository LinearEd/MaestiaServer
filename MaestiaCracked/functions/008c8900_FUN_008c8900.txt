PROGRAM  : Maestia.exe
FUNCTION : FUN_008c8900
ENTRY    : 008c8900
BODY     : [[008c8900, 008c8cdd]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008c8900(int *param_1)

{
  int iVar1;
  int *piVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  int iVar5;
  int in_ECX;
  uint local_54;
  undefined1 local_50 [4];
  undefined2 local_4c;
  undefined4 local_3c;
  uint local_38;
  int local_34;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  undefined4 local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b51518;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_34 = in_ECX;
  if (*(char *)(in_ECX + 10) == '\0') {
    FUN_00406460(L"IDS_UPGRADE_FAILED");
    local_8 = 3;
    piVar2 = *(int **)(*DAT_00da9894 + 0x1a8);
    uVar3 = FUN_0081d120(local_50);
    local_8._0_1_ = 4;
    (**(code **)(*piVar2 + 0x44))(uVar3,3);
    local_8 = CONCAT31(local_8._1_3_,3);
    if (7 < local_54) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_8 = 0xffffffff;
    if (7 < local_38) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_38 = 7;
    local_3c = 0;
    local_4c = 0;
    iVar1 = *DAT_00da9894;
    if ((iVar1 != 0) && (*(int *)(iVar1 + 0x114) != 0)) {
      (**(code **)(**(int **)(iVar1 + 0x114) + 4))
                (*(int **)(iVar1 + 0x114),"HaildomPlayEffect",&DAT_00c51d10,0);
    }
    FUN_008a1050(0x33);
    iVar1 = FUN_009f2a00(*(undefined4 *)(in_ECX + 4));
    if (iVar1 == 0) {
      piVar2 = (int *)FUN_004049b0(*(undefined4 *)(in_ECX + 0xb));
      if (((piVar2 == (int *)0x0) || (iVar1 = (**(code **)(*piVar2 + 0x40))(), iVar1 == 0)) ||
         (*(int *)(*DAT_00da9894 + 700) == 0)) goto LAB_008c8cc0;
      uVar3 = FUN_00824a20(DAT_0172491c,0);
      local_8 = 5;
      FUN_00968ef0(uVar3,*(undefined1 *)(local_34 + 0xf),piVar2[0x14],4);
    }
    else {
      iVar5 = FUN_004049b0(*(undefined4 *)(iVar1 + 0x10));
      if ((iVar5 == 0) || (uVar3 = FUN_00a08b70(), *(int *)(*DAT_00da9894 + 700) == 0))
      goto LAB_008c8cc0;
      uVar4 = FUN_00824a20(DAT_0172491c,0);
      local_8 = 6;
      FUN_00968ef0(uVar4,*(undefined2 *)(iVar1 + 0xac),uVar3,4);
    }
LAB_008c8cbb:
    local_8 = 0xffffffff;
    FUN_00406560();
  }
  else {
    if ((*(char *)(in_ECX + 10) != '\x01') ||
       (iVar1 = (**(code **)(*param_1 + 0x74))(0,0,local_14), iVar1 == 0)) goto LAB_008c8cc0;
    piVar2 = (int *)FUN_009f2a00(*(undefined4 *)(in_ECX + 4));
    if (piVar2 != (int *)0x0) {
      FUN_00a07b80();
      (**(code **)(*piVar2 + 0x58))(0);
      local_18 = 7;
      local_1c = 0;
      local_2c = 0;
      local_8 = 0;
      (**(code **)(*param_1 + 0x60))(piVar2,local_30);
      (**(code **)(*param_1 + 0x48))(local_30,0,0);
      FUN_004049b0(param_1[0x18]);
      FUN_008c79f0();
      iVar1 = FUN_004049b0(piVar2[4]);
      if (iVar1 == 0) goto LAB_008c8cbb;
      local_34 = iVar1 + 0x18;
      iVar1 = FUN_00824a20(DAT_0172491c,0);
      local_8._0_1_ = 1;
      if (*(uint *)(iVar1 + 0x18) < 8) {
        iVar1 = iVar1 + 4;
      }
      else {
        iVar1 = *(int *)(iVar1 + 4);
      }
      FUN_009adfc0(*(undefined4 *)(*DAT_00da9894 + 0x1a8),0x13,iVar1);
      local_8._0_1_ = 0;
      FUN_00406560();
      uVar3 = FUN_00a08b70();
      if (*(int *)(*DAT_00da9894 + 700) != 0) {
        uVar4 = FUN_00824a20(DAT_0172491c,0);
        local_8._0_1_ = 2;
        FUN_00968ef0(uVar4,(short)piVar2[0x2b],uVar3,2);
        local_8 = (uint)local_8._1_3_ << 8;
        FUN_00406560();
      }
      local_8 = 0xffffffff;
      FUN_00406560();
    }
    if ((*DAT_00da9894 != 0) && (piVar2 = *(int **)(*DAT_00da9894 + 0x114), piVar2 != (int *)0x0)) {
      (**(code **)(*piVar2 + 4))(piVar2,"HaildomPlayEffect",&DAT_00c51cd0,1);
    }
    FUN_008a1050(0x32);
  }
LAB_008c8cc0:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008c8900 : PUSH EBP
008c8901 : MOV EBP,ESP
008c8903 : PUSH -0x1
008c8905 : PUSH 0xb51518
008c890a : MOV EAX,FS:[0x0]
008c8910 : PUSH EAX
008c8911 : SUB ESP,0xd0
008c8917 : MOV EAX,[0x00d66fa0]
008c891c : XOR EAX,EBP
008c891e : MOV dword ptr [EBP + -0x10],EAX
008c8921 : PUSH EBX
008c8922 : PUSH ESI
008c8923 : PUSH EDI
008c8924 : PUSH EAX
008c8925 : LEA EAX,[EBP + -0xc]
008c8928 : MOV FS:[0x0],EAX
008c892e : MOV EBX,dword ptr [EBP + 0x8]
008c8931 : MOV ESI,ECX
008c8933 : MOVZX EAX,byte ptr [ESI + 0xa]
008c8937 : SUB EAX,0x0
008c893a : MOV dword ptr [EBP + -0x30],ESI
008c893d : JZ 0x008c8afa
008c8943 : SUB EAX,0x1
008c8946 : JNZ 0x008c8cc0
008c894c : MOV EAX,dword ptr [EBX]
008c894e : MOV EDX,dword ptr [EAX + 0x74]
008c8951 : PUSH 0x0
008c8953 : PUSH 0x0
008c8955 : MOV ECX,EBX
008c8957 : CALL EDX
008c8959 : TEST EAX,EAX
008c895b : JZ 0x008c8cc0
008c8961 : MOV EAX,dword ptr [ESI + 0x4]
008c8964 : MOV ECX,dword ptr [0x017247f0]
008c896a : PUSH EAX
008c896b : CALL 0x009f2a00
008c8970 : MOV EDI,EAX
008c8972 : TEST EDI,EDI
008c8974 : JZ 0x008c8abb
008c897a : MOV AX,word ptr [ESI + 0x8]
008c897e : MOV ESI,EDI
008c8980 : CALL 0x00a07b80
008c8985 : MOV EDX,dword ptr [EDI]
008c8987 : MOV EAX,dword ptr [EDX + 0x58]
008c898a : XOR ESI,ESI
008c898c : PUSH ESI
008c898d : MOV ECX,EDI
008c898f : CALL EAX
008c8991 : XOR ECX,ECX
008c8993 : MOV dword ptr [EBP + -0x14],0x7
008c899a : MOV dword ptr [EBP + -0x18],ESI
008c899d : MOV word ptr [EBP + -0x28],CX
008c89a1 : MOV dword ptr [EBP + -0x4],ESI
008c89a4 : MOV EDX,dword ptr [EBX]
008c89a6 : MOV EDX,dword ptr [EDX + 0x60]
008c89a9 : LEA EAX,[EBP + -0x2c]
008c89ac : PUSH EAX
008c89ad : PUSH EDI
008c89ae : MOV ECX,EBX
008c89b0 : CALL EDX
008c89b2 : MOV EAX,dword ptr [EBX]
008c89b4 : MOV EDX,dword ptr [EAX + 0x48]
008c89b7 : PUSH ESI
008c89b8 : PUSH ESI
008c89b9 : LEA ECX,[EBP + -0x2c]
008c89bc : PUSH ECX
008c89bd : MOV ECX,EBX
008c89bf : CALL EDX
008c89c1 : MOV EAX,dword ptr [EBX + 0x60]
008c89c4 : PUSH EAX
008c89c5 : CALL 0x004049b0
008c89ca : MOVZX ECX,word ptr [EDI + 0xac]
008c89d1 : MOV ECX,dword ptr [EAX + ECX*0x4 + 0x48]
008c89d5 : ADD ESP,0x4
008c89d8 : MOV EAX,EBX
008c89da : CALL 0x008c79f0
008c89df : MOV EAX,dword ptr [EDI + 0x10]
008c89e2 : PUSH EAX
008c89e3 : CALL 0x004049b0
008c89e8 : ADD ESP,0x4
008c89eb : CMP EAX,ESI
008c89ed : JNZ 0x008c89fe
008c89ef : MOV dword ptr [EBP + -0x4],0xffffffff
008c89f6 : LEA ECX,[EBP + -0x2c]
008c89f9 : JMP 0x008c8cbb
008c89fe : MOV EDX,dword ptr [0x0172491c]
008c8a04 : PUSH ESI
008c8a05 : ADD EAX,0x18
008c8a08 : PUSH EDX
008c8a09 : MOV EDX,EAX
008c8a0b : LEA ESI,[EBP + 0xffffff44]
008c8a11 : MOV dword ptr [EBP + -0x30],EAX
008c8a14 : CALL 0x00824a20
008c8a19 : MOV byte ptr [EBP + -0x4],0x1
008c8a1d : CMP dword ptr [EAX + 0x18],0x8
008c8a21 : JC 0x008c8a28
008c8a23 : MOV ECX,dword ptr [EAX + 0x4]
008c8a26 : JMP 0x008c8a2b
008c8a28 : LEA ECX,[EAX + 0x4]
008c8a2b : MOV EAX,[0x00da9894]
008c8a30 : MOV EAX,dword ptr [EAX]
008c8a32 : MOV EAX,dword ptr [EAX + 0x1a8]
008c8a38 : PUSH ECX
008c8a39 : PUSH 0x13
008c8a3b : PUSH EAX
008c8a3c : MOV ECX,0xc51ca8
008c8a41 : CALL 0x009adfc0
008c8a46 : ADD ESP,0xc
008c8a49 : MOV byte ptr [EBP + -0x4],0x0
008c8a4d : LEA ECX,[EBP + 0xffffff44]
008c8a53 : CALL 0x00406560
008c8a58 : MOV ECX,EDI
008c8a5a : CALL 0x00a08b70
008c8a5f : MOV ECX,dword ptr [0x00da9894]
008c8a65 : MOV EBX,EAX
008c8a67 : MOV EAX,dword ptr [ECX]
008c8a69 : CMP dword ptr [EAX + 0x2bc],0x0
008c8a70 : JZ 0x008c8aac
008c8a72 : MOV EDX,dword ptr [0x0172491c]
008c8a78 : PUSH 0x0
008c8a7a : PUSH EDX
008c8a7b : MOV EDX,dword ptr [EBP + -0x30]
008c8a7e : LEA ESI,[EBP + 0xffffff7c]
008c8a84 : CALL 0x00824a20
008c8a89 : MOV byte ptr [EBP + -0x4],0x2
008c8a8d : MOVZX ECX,word ptr [EDI + 0xac]
008c8a94 : PUSH 0x2
008c8a96 : MOVZX ECX,CX
008c8a99 : PUSH EBX
008c8a9a : PUSH ECX
008c8a9b : PUSH EAX
008c8a9c : CALL 0x00968ef0
008c8aa1 : MOV byte ptr [EBP + -0x4],0x0
008c8aa5 : MOV ECX,ESI
008c8aa7 : CALL 0x00406560
008c8aac : MOV dword ptr [EBP + -0x4],0xffffffff
008c8ab3 : LEA ECX,[EBP + -0x2c]
008c8ab6 : CALL 0x00406560
008c8abb : MOV EDX,dword ptr [0x00da9894]
008c8ac1 : MOV EAX,dword ptr [EDX]
008c8ac3 : TEST EAX,EAX
008c8ac5 : JZ 0x008c8ae8
008c8ac7 : MOV EAX,dword ptr [EAX + 0x114]
008c8acd : TEST EAX,EAX
008c8acf : JZ 0x008c8ae8
008c8ad1 : MOV ECX,dword ptr [EAX]
008c8ad3 : MOV EDX,dword ptr [ECX + 0x4]
008c8ad6 : PUSH 0x1
008c8ad8 : PUSH 0xc51cd0
008c8add : PUSH 0xc51cd4
008c8ae2 : PUSH EAX
008c8ae3 : CALL EDX
008c8ae5 : ADD ESP,0x10
008c8ae8 : MOV ECX,dword ptr [0x017248dc]
008c8aee : PUSH 0x32
008c8af0 : CALL 0x008a1050
008c8af5 : JMP 0x008c8cc0
008c8afa : PUSH 0xc51ce8
008c8aff : LEA ECX,[EBP + -0x4c]
008c8b02 : CALL 0x00406460
008c8b07 : MOV dword ptr [EBP + -0x4],0x3
008c8b0e : MOV EAX,[0x00da9894]
008c8b13 : MOV EAX,dword ptr [EAX]
008c8b15 : MOV EBX,dword ptr [EAX + 0x1a8]
008c8b1b : LEA ECX,[EBP + -0x4c]
008c8b1e : PUSH ECX
008c8b1f : MOV ECX,dword ptr [0x0172491c]
008c8b25 : LEA EDI,[EBP + -0x68]
008c8b28 : CALL 0x0081d120
008c8b2d : MOV byte ptr [EBP + -0x4],0x4
008c8b31 : MOV EDX,dword ptr [EBX]
008c8b33 : PUSH 0x3
008c8b35 : PUSH EAX
008c8b36 : MOV EAX,dword ptr [EDX + 0x44]
008c8b39 : MOV ECX,EBX
008c8b3b : CALL EAX
008c8b3d : MOV byte ptr [EBP + -0x4],0x3
008c8b41 : MOV EDI,0x8
008c8b46 : CMP dword ptr [EBP + -0x50],EDI
008c8b49 : JC 0x008c8b53
008c8b4b : MOV ECX,dword ptr [EBP + -0x64]
008c8b4e : CALL 0x006f04e0
008c8b53 : MOV EBX,0x7
008c8b58 : XOR ECX,ECX
008c8b5a : MOV dword ptr [EBP + -0x50],EBX
008c8b5d : MOV dword ptr [EBP + -0x54],0x0
008c8b64 : MOV word ptr [EBP + -0x64],CX
008c8b68 : MOV dword ptr [EBP + -0x4],0xffffffff
008c8b6f : CMP dword ptr [EBP + -0x34],EDI
008c8b72 : JC 0x008c8b7c
008c8b74 : MOV ECX,dword ptr [EBP + -0x48]
008c8b77 : CALL 0x006f04e0
008c8b7c : MOV EAX,[0x00da9894]
008c8b81 : XOR EDX,EDX
008c8b83 : MOV dword ptr [EBP + -0x34],EBX
008c8b86 : MOV dword ptr [EBP + -0x38],0x0
008c8b8d : MOV word ptr [EBP + -0x48],DX
008c8b91 : MOV EAX,dword ptr [EAX]
008c8b93 : TEST EAX,EAX
008c8b95 : JZ 0x008c8bbb
008c8b97 : CMP dword ptr [EAX + 0x114],EDX
008c8b9d : JZ 0x008c8bbb
008c8b9f : MOV EAX,dword ptr [EAX + 0x114]
008c8ba5 : MOV ECX,dword ptr [EAX]
008c8ba7 : PUSH EDX
008c8ba8 : MOV EDX,dword ptr [ECX + 0x4]
008c8bab : PUSH 0xc51d10
008c8bb0 : PUSH 0xc51d14
008c8bb5 : PUSH EAX
008c8bb6 : CALL EDX
008c8bb8 : ADD ESP,0x10
008c8bbb : MOV ECX,dword ptr [0x017248dc]
008c8bc1 : PUSH 0x33
008c8bc3 : CALL 0x008a1050
008c8bc8 : MOV EAX,dword ptr [ESI + 0x4]
008c8bcb : MOV ECX,dword ptr [0x017247f0]
008c8bd1 : PUSH EAX
008c8bd2 : CALL 0x009f2a00
008c8bd7 : MOV EDI,EAX
008c8bd9 : TEST EDI,EDI
008c8bdb : JNZ 0x008c8c55
008c8bdd : MOV ECX,dword ptr [ESI + 0xb]
008c8be0 : PUSH ECX
008c8be1 : CALL 0x004049b0
008c8be6 : MOV EDI,EAX
008c8be8 : ADD ESP,0x4
008c8beb : TEST EDI,EDI
008c8bed : JZ 0x008c8cc0
008c8bf3 : MOV EDX,dword ptr [EDI]
008c8bf5 : MOV EAX,dword ptr [EDX + 0x40]
008c8bf8 : MOV ECX,EDI
008c8bfa : CALL EAX
008c8bfc : TEST EAX,EAX
008c8bfe : JZ 0x008c8cc0
008c8c04 : MOV ECX,dword ptr [0x00da9894]
008c8c0a : MOV EAX,dword ptr [ECX]
008c8c0c : CMP dword ptr [EAX + 0x2bc],0x0
008c8c13 : JZ 0x008c8cc0
008c8c19 : MOV EAX,[0x0172491c]
008c8c1e : PUSH 0x0
008c8c20 : LEA EDX,[EDI + 0x18]
008c8c23 : PUSH EAX
008c8c24 : LEA ESI,[EBP + 0xffffff60]
008c8c2a : CALL 0x00824a20
008c8c2f : MOV dword ptr [EBP + -0x4],0x5
008c8c36 : MOV ECX,dword ptr [EDI + 0x50]
008c8c39 : MOV EDX,dword ptr [EBP + -0x30]
008c8c3c : PUSH 0x4
008c8c3e : PUSH ECX
008c8c3f : MOVZX ECX,byte ptr [EDX + 0xf]
008c8c43 : PUSH ECX
008c8c44 : PUSH EAX
008c8c45 : CALL 0x00968ef0
008c8c4a : MOV dword ptr [EBP + -0x4],0xffffffff
008c8c51 : MOV ECX,ESI
008c8c53 : JMP 0x008c8cbb
008c8c55 : MOV EAX,dword ptr [EDI + 0x10]
008c8c58 : PUSH EAX
008c8c59 : CALL 0x004049b0
008c8c5e : MOV ESI,EAX
008c8c60 : ADD ESP,0x4
008c8c63 : TEST ESI,ESI
008c8c65 : JZ 0x008c8cc0
008c8c67 : MOV ECX,EDI
008c8c69 : CALL 0x00a08b70
008c8c6e : MOV EDX,dword ptr [0x00da9894]
008c8c74 : MOV EBX,EAX
008c8c76 : MOV EAX,dword ptr [EDX]
008c8c78 : CMP dword ptr [EAX + 0x2bc],0x0
008c8c7f : JZ 0x008c8cc0
008c8c81 : MOV EAX,[0x0172491c]
008c8c86 : PUSH 0x0
008c8c88 : LEA EDX,[ESI + 0x18]
008c8c8b : PUSH EAX
008c8c8c : LEA ESI,[EBP + 0xffffff28]
008c8c92 : CALL 0x00824a20
008c8c97 : MOV dword ptr [EBP + -0x4],0x6
008c8c9e : MOVZX ECX,word ptr [EDI + 0xac]
008c8ca5 : PUSH 0x4
008c8ca7 : MOVZX ECX,CX
008c8caa : PUSH EBX
008c8cab : PUSH ECX
008c8cac : PUSH EAX
008c8cad : CALL 0x00968ef0
008c8cb2 : MOV dword ptr [EBP + -0x4],0xffffffff
008c8cb9 : MOV ECX,ESI
008c8cbb : CALL 0x00406560
008c8cc0 : MOV ECX,dword ptr [EBP + -0xc]
008c8cc3 : MOV dword ptr FS:[0x0],ECX
008c8cca : POP ECX
008c8ccb : POP EDI
008c8ccc : POP ESI
008c8ccd : POP EBX
008c8cce : MOV ECX,dword ptr [EBP + -0x10]
008c8cd1 : XOR ECX,EBP
008c8cd3 : CALL 0x00633e6b
008c8cd8 : MOV ESP,EBP
008c8cda : POP EBP
008c8cdb : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_00439060
ENTRY    : 00439060
BODY     : [[00439060, 004391e1] [004391e8, 00439210] [00439266, 004392eb] [0043930a, 00439390]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00439060(int param_1,int param_2,undefined4 param_3)

{
  uint *puVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  undefined4 uVar5;
  int extraout_ECX;
  uint uStack_58;
  uint local_38;
  undefined1 local_34 [28];
  uint local_18;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b80830;
  local_10 = ExceptionList;
  uStack_58 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&uStack_58;
  ExceptionList = &local_10;
  iVar2 = *(int *)(param_1 + 4);
  if (iVar2 == 0) {
    local_38 = 0;
  }
  else {
    local_38 = (*(int *)(param_1 + 0xc) - iVar2) / 0x1c;
  }
  iVar4 = *(int *)(param_1 + 8);
  iVar2 = (iVar4 - iVar2) / 0x1c;
  local_18 = uStack_58;
  puVar1 = &uStack_58;
  if (iVar2 == 0x9249249) {
    iVar2 = FUN_00452880();
    iVar4 = extraout_ECX;
    puVar1 = (uint *)local_14;
  }
  local_14 = (undefined1 *)puVar1;
  uVar3 = iVar2 + 1;
  if (local_38 < uVar3) {
    if (0x9249249 - (local_38 >> 1) < local_38) {
      local_38 = 0;
    }
    else {
      local_38 = local_38 + (local_38 >> 1);
    }
    if (local_38 < uVar3) {
      local_38 = uVar3;
    }
    iVar4 = FUN_0043c030();
    iVar2 = *(int *)(param_1 + 4);
    local_8 = 0;
    FUN_00438e00();
    FUN_00439000(*(undefined4 *)(param_1 + 4),iVar4);
    FUN_00439000(param_2,iVar4 + ((param_2 - iVar2) / 0x1c + 1) * 0x1c);
    local_8 = 0xffffffff;
    iVar2 = (*(int *)(param_1 + 8) - *(int *)(param_1 + 4)) / 0x1c + 1;
    if (*(int *)(param_1 + 4) != 0) {
      FUN_00438e30(iVar2);
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    *(uint *)(param_1 + 0xc) = iVar4 + local_38 * 0x1c;
    *(int *)(param_1 + 8) = iVar4 + iVar2 * 0x1c;
    *(int *)(param_1 + 4) = iVar4;
  }
  else {
    iVar2 = iVar4 - param_2 >> 0x1f;
    if ((iVar4 - param_2) / 0x1c + iVar2 == iVar2) {
      FUN_00405200(param_3);
      local_8 = 2;
      FUN_00439000(param_2,param_2 + 0x1c);
      local_8 = CONCAT31(local_8._1_3_,3);
      FUN_00438e00();
      local_8 = 2;
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 0x1c;
    }
    else {
      FUN_00405200(param_3);
      local_8 = 5;
      iVar4 = *(int *)(param_1 + 8);
      iVar2 = iVar4 + -0x1c;
      uVar5 = FUN_00439000(iVar2,iVar4);
      *(undefined4 *)(param_1 + 8) = uVar5;
      if (param_2 != iVar2) {
        iVar4 = iVar4 - iVar2;
        do {
          iVar2 = iVar2 + -0x1c;
          FUN_00405690(iVar4 + iVar2);
        } while (iVar2 != param_2);
      }
    }
    FUN_00439030(local_34);
    local_8 = 0xffffffff;
    FUN_004052b0();
  }
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00439060 : PUSH EBP
00439061 : MOV EBP,ESP
00439063 : PUSH -0x1
00439065 : PUSH 0xb80830
0043906a : MOV EAX,FS:[0x0]
00439070 : PUSH EAX
00439071 : SUB ESP,0x38
00439074 : MOV EAX,[0x00d66fa0]
00439079 : XOR EAX,EBP
0043907b : MOV dword ptr [EBP + -0x14],EAX
0043907e : PUSH EBX
0043907f : PUSH ESI
00439080 : PUSH EDI
00439081 : PUSH EAX
00439082 : LEA EAX,[EBP + -0xc]
00439085 : MOV FS:[0x0],EAX
0043908b : MOV dword ptr [EBP + -0x10],ESP
0043908e : MOV EBX,dword ptr [EBP + 0x8]
00439091 : MOV dword ptr [EBP + -0x3c],EBX
00439094 : MOV EAX,dword ptr [EBP + 0x10]
00439097 : MOV dword ptr [EBP + -0x38],EAX
0043909a : MOV ESI,dword ptr [EBX + 0x4]
0043909d : TEST ESI,ESI
0043909f : JNZ 0x004390a6
004390a1 : MOV dword ptr [EBP + -0x34],ESI
004390a4 : JMP 0x004390c1
004390a6 : MOV ECX,dword ptr [EBX + 0xc]
004390a9 : SUB ECX,ESI
004390ab : MOV EAX,0x92492493
004390b0 : IMUL ECX
004390b2 : ADD EDX,ECX
004390b4 : SAR EDX,0x4
004390b7 : MOV EAX,EDX
004390b9 : SHR EAX,0x1f
004390bc : ADD EAX,EDX
004390be : MOV dword ptr [EBP + -0x34],EAX
004390c1 : MOV ECX,dword ptr [EBX + 0x8]
004390c4 : MOV EDI,ECX
004390c6 : SUB EDI,ESI
004390c8 : MOV EAX,0x92492493
004390cd : IMUL EDI
004390cf : ADD EDX,EDI
004390d1 : SAR EDX,0x4
004390d4 : MOV EAX,EDX
004390d6 : SHR EAX,0x1f
004390d9 : ADD EAX,EDX
004390db : MOV EDX,0x9249249
004390e0 : SUB EDX,EAX
004390e2 : CMP EDX,0x1
004390e5 : JNC 0x004390ec
004390e7 : CALL 0x00452880
004390ec : INC EAX
004390ed : MOV EDX,dword ptr [EBP + -0x34]
004390f0 : CMP EDX,EAX
004390f2 : JNC 0x00439266
004390f8 : MOV ECX,EDX
004390fa : SHR ECX,0x1
004390fc : MOV ESI,0x9249249
00439101 : SUB ESI,ECX
00439103 : CMP ESI,EDX
00439105 : JNC 0x00439110
00439107 : XOR EDI,EDI
00439109 : MOV dword ptr [EBP + -0x34],EDI
0043910c : MOV EDX,EDI
0043910e : JMP 0x00439117
00439110 : ADD EDX,ECX
00439112 : MOV dword ptr [EBP + -0x34],EDX
00439115 : XOR EDI,EDI
00439117 : CMP EDX,EAX
00439119 : JNC 0x00439120
0043911b : MOV dword ptr [EBP + -0x34],EAX
0043911e : MOV EDX,EAX
00439120 : MOV ECX,EDX
00439122 : CALL 0x0043c030
00439127 : MOV ESI,EAX
00439129 : MOV dword ptr [EBP + -0x44],ESI
0043912c : MOV ECX,dword ptr [EBP + 0xc]
0043912f : SUB ECX,dword ptr [EBX + 0x4]
00439132 : MOV EAX,0x92492493
00439137 : IMUL ECX
00439139 : ADD EDX,ECX
0043913b : SAR EDX,0x4
0043913e : MOV EAX,EDX
00439140 : SHR EAX,0x1f
00439143 : ADD EAX,EDX
00439145 : MOV dword ptr [EBP + -0x3c],EAX
00439148 : MOV dword ptr [EBP + -0x40],EDI
0043914b : MOV dword ptr [EBP + -0x4],EDI
0043914e : LEA ECX,[EAX*0x8 + 0x0]
00439155 : SUB ECX,EAX
00439157 : LEA EDI,[ESI + ECX*0x4]
0043915a : MOV EDX,dword ptr [EBP + -0x38]
0043915d : MOV ESI,0x1
00439162 : CALL 0x00438e00
00439167 : MOV dword ptr [EBP + -0x40],ESI
0043916a : MOV EDI,dword ptr [EBP + -0x44]
0043916d : PUSH EDI
0043916e : MOV EDX,dword ptr [EBX + 0x4]
00439171 : PUSH EDX
00439172 : MOV EDX,dword ptr [EBP + 0xc]
00439175 : CALL 0x00439000
0043917a : MOV dword ptr [EBP + -0x40],0x2
00439181 : MOV EAX,dword ptr [EBP + -0x3c]
00439184 : INC EAX
00439185 : LEA ECX,[EAX*0x8 + 0x0]
0043918c : SUB ECX,EAX
0043918e : LEA EDX,[EDI + ECX*0x4]
00439191 : PUSH EDX
00439192 : MOV EAX,dword ptr [EBP + 0xc]
00439195 : PUSH EAX
00439196 : MOV EDX,dword ptr [EBX + 0x8]
00439199 : CALL 0x00439000
0043919e : MOV dword ptr [EBP + -0x4],0xffffffff
004391a5 : MOV ECX,dword ptr [EBX + 0x8]
004391a8 : MOV ESI,dword ptr [EBX + 0x4]
004391ab : SUB ECX,ESI
004391ad : MOV EAX,0x92492493
004391b2 : IMUL ECX
004391b4 : ADD EDX,ECX
004391b6 : SAR EDX,0x4
004391b9 : MOV ECX,EDX
004391bb : SHR ECX,0x1f
004391be : LEA EDX,[EDX + ECX*0x1 + 0x1]
004391c2 : MOV dword ptr [EBP + -0x38],EDX
004391c5 : TEST ESI,ESI
004391c7 : JZ 0x004391e8
004391c9 : MOV EDX,dword ptr [EBP + -0x38]
004391cc : PUSH EDX
004391cd : MOV EDI,dword ptr [EBX + 0x8]
004391d0 : MOV EAX,ESI
004391d2 : CALL 0x00438e30
004391d7 : ADD ESP,0x4
004391da : MOV ECX,dword ptr [EBX + 0x4]
004391dd : CALL 0x006f04e0
004391e8 : MOV EAX,dword ptr [EBP + -0x34]
004391eb : LEA ECX,[EAX*0x8 + 0x0]
004391f2 : SUB ECX,EAX
004391f4 : LEA EAX,[EDI + ECX*0x4]
004391f7 : MOV dword ptr [EBX + 0xc],EAX
004391fa : LEA ECX,[EDX*0x8 + 0x0]
00439201 : SUB ECX,EDX
00439203 : LEA EDX,[EDI + ECX*0x4]
00439206 : MOV dword ptr [EBX + 0x8],EDX
00439209 : MOV dword ptr [EBX + 0x4],EDI
0043920c : JMP 0x00439373
00439266 : SUB ECX,dword ptr [EBP + 0xc]
00439269 : MOV EAX,0x92492493
0043926e : IMUL ECX
00439270 : ADD EDX,ECX
00439272 : SAR EDX,0x4
00439275 : MOV ECX,EDX
00439277 : SHR ECX,0x1f
0043927a : ADD ECX,EDX
0043927c : CMP ECX,0x1
0043927f : JNC 0x0043930a
00439285 : MOV EDX,dword ptr [EBP + -0x38]
00439288 : PUSH EDX
00439289 : LEA ECX,[EBP + -0x30]
0043928c : CALL 0x00405200
00439291 : MOV dword ptr [EBP + -0x4],0x2
00439298 : MOV EAX,dword ptr [EBP + 0xc]
0043929b : LEA ECX,[EAX + 0x1c]
0043929e : PUSH ECX
0043929f : PUSH EAX
004392a0 : MOV EDX,dword ptr [EBX + 0x8]
004392a3 : CALL 0x00439000
004392a8 : MOV byte ptr [EBP + -0x4],0x3
004392ac : MOV EDI,dword ptr [EBX + 0x8]
004392af : MOV ECX,EDI
004392b1 : SUB ECX,dword ptr [EBP + 0xc]
004392b4 : MOV EAX,0x92492493
004392b9 : IMUL ECX
004392bb : ADD EDX,ECX
004392bd : SAR EDX,0x4
004392c0 : MOV EAX,EDX
004392c2 : SHR EAX,0x1f
004392c5 : ADD EAX,EDX
004392c7 : MOV ESI,0x1
004392cc : SUB ESI,EAX
004392ce : LEA EDX,[EBP + -0x30]
004392d1 : CALL 0x00438e00
004392d6 : MOV dword ptr [EBP + -0x4],0x2
004392dd : ADD dword ptr [EBX + 0x8],0x1c
004392e1 : MOV EBX,dword ptr [EBX + 0x8]
004392e4 : LEA EDI,[EBX + -0x1c]
004392e7 : MOV EAX,dword ptr [EBP + 0xc]
004392ea : JMP 0x00439358
0043930a : MOV ECX,dword ptr [EBP + -0x38]
0043930d : PUSH ECX
0043930e : LEA ECX,[EBP + -0x30]
00439311 : CALL 0x00405200
00439316 : MOV dword ptr [EBP + -0x4],0x5
0043931d : MOV EDI,dword ptr [EBX + 0x8]
00439320 : LEA ESI,[EDI + -0x1c]
00439323 : PUSH EDI
00439324 : PUSH ESI
00439325 : MOV EDX,EDI
00439327 : CALL 0x00439000
0043932c : MOV dword ptr [EBX + 0x8],EAX
0043932f : MOV EAX,dword ptr [EBP + 0xc]
00439332 : MOV EBX,EAX
00439334 : CMP EAX,ESI
00439336 : JZ 0x00439355
00439338 : SUB EDI,ESI
0043933a : LEA EBX,[EBX]
00439340 : SUB ESI,0x1c
00439343 : LEA EDX,[EDI + ESI*0x1]
00439346 : PUSH EDX
00439347 : MOV ECX,ESI
00439349 : CALL 0x00405690
0043934e : CMP ESI,EBX
00439350 : JNZ 0x00439340
00439352 : MOV EAX,dword ptr [EBP + 0xc]
00439355 : LEA EDI,[EAX + 0x1c]
00439358 : LEA ECX,[EBP + -0x30]
0043935b : PUSH ECX
0043935c : CALL 0x00439030
00439361 : ADD ESP,0x4
00439364 : MOV dword ptr [EBP + -0x4],0xffffffff
0043936b : LEA ECX,[EBP + -0x30]
0043936e : CALL 0x004052b0
00439373 : MOV ECX,dword ptr [EBP + -0xc]
00439376 : MOV dword ptr FS:[0x0],ECX
0043937d : POP ECX
0043937e : POP EDI
0043937f : POP ESI
00439380 : POP EBX
00439381 : MOV ECX,dword ptr [EBP + -0x14]
00439384 : XOR ECX,EBP
00439386 : CALL 0x00633e6b
0043938b : MOV ESP,EBP
0043938d : POP EBP
0043938e : RET 0xc

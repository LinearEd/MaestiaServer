PROGRAM  : Maestia.exe
FUNCTION : FUN_00a0a6b0
ENTRY    : 00a0a6b0
BODY     : [[00a0a6b0, 00a0a838] [00a0a84b, 00a0a86b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a0a6b0(FILE *param_1,uint *param_2)

{
  char cVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  bool bVar5;
  int local_2c;
  uint *local_28;
  uint *local_24;
  int local_20;
  void *local_14;
  code *pcStack_10;
  uint local_c;
  undefined4 local_8;
  
  local_8 = 0xfffffffe;
  pcStack_10 = __except_handler4;
  local_14 = ExceptionList;
  local_c = DAT_00d66fa0 ^ 0xcedec8;
  ExceptionList = &local_14;
  _fwprintf(param_1,L"\r\n\r\nStack:\r\n");
  local_8 = 0;
  local_24 = StackBase;
  if (param_2 + 0xc00 < StackBase) {
    local_24 = param_2 + 0xc00;
  }
  uVar3 = 0;
  local_28 = param_2;
  local_20 = 0;
  while (param_2 + 1 <= local_24) {
    uVar2 = uVar3 & 0x80000003;
    bVar5 = uVar2 == 0;
    if ((int)uVar2 < 0) {
      bVar5 = (uVar2 - 1 | 0xfffffffc) == 0xffffffff;
    }
    if (bVar5) {
      local_20 = 0;
      _fwprintf(param_1,L"0x%08p: ",param_2);
      local_28 = param_2;
    }
    uVar3 = uVar3 + 1;
    uVar2 = uVar3 & 0x80000003;
    bVar5 = uVar2 == 0;
    if ((int)uVar2 < 0) {
      bVar5 = (uVar2 - 1 | 0xfffffffc) == 0xffffffff;
    }
    if ((bVar5) || (local_24 < param_2 + 2)) {
      _fwprintf(param_1,L"%08x ",*param_2);
      local_20 = local_20 + 1;
      for (iVar4 = local_20; iVar4 < 4; iVar4 = iVar4 + 1) {
        _fwprintf(param_1,L"         ");
      }
      for (local_2c = 0; local_2c < local_20; local_2c = local_2c + 1) {
        uVar2 = *local_28;
        iVar4 = 0;
        while( true ) {
          if (3 < iVar4) break;
          cVar1 = (char)uVar2;
          if ((cVar1 < ' ') || ('~' < cVar1)) {
            cVar1 = '.';
          }
          _fwprintf(param_1,L"%c",(uint)(ushort)(short)cVar1);
          uVar2 = uVar2 >> 8;
          iVar4 = iVar4 + 1;
        }
        local_28 = local_28 + 1;
      }
      _fwprintf(param_1,L"\r\n");
      param_2 = param_2 + 1;
    }
    else {
      _fwprintf(param_1,L"%08x ",*param_2);
      local_20 = local_20 + 1;
      param_2 = param_2 + 1;
    }
  }
  _fwprintf(param_1,L"\r\n");
  ExceptionList = local_14;
  return;
}



============================================================
DISASSEMBLY
============================================================
00a0a6b0 : PUSH EBP
00a0a6b1 : MOV EBP,ESP
00a0a6b3 : PUSH -0x2
00a0a6b5 : PUSH 0xcedec8
00a0a6ba : PUSH 0x64c290
00a0a6bf : MOV EAX,FS:[0x0]
00a0a6c5 : PUSH EAX
00a0a6c6 : SUB ESP,0x28
00a0a6c9 : PUSH EBX
00a0a6ca : PUSH ESI
00a0a6cb : PUSH EDI
00a0a6cc : MOV EAX,[0x00d66fa0]
00a0a6d1 : XOR dword ptr [EBP + -0x8],EAX
00a0a6d4 : XOR EAX,EBP
00a0a6d6 : PUSH EAX
00a0a6d7 : LEA EAX,[EBP + -0x10]
00a0a6da : MOV FS:[0x0],EAX
00a0a6e0 : MOV dword ptr [EBP + -0x18],ESP
00a0a6e3 : MOV EDI,dword ptr [EBP + 0x8]
00a0a6e6 : PUSH 0xcabfa0
00a0a6eb : PUSH EDI
00a0a6ec : CALL 0x006372ee
00a0a6f1 : ADD ESP,0x8
00a0a6f4 : XOR ECX,ECX
00a0a6f6 : MOV dword ptr [EBP + -0x4],ECX
00a0a6f9 : MOV EAX,FS:[0x4]
00a0a6ff : MOV dword ptr [EBP + -0x20],EAX
00a0a702 : MOV EBX,dword ptr [EBP + 0xc]
00a0a705 : LEA EAX,[EBX + 0x3000]
00a0a70b : CMP dword ptr [EBP + -0x20],EAX
00a0a70e : JBE 0x00a0a713
00a0a710 : MOV dword ptr [EBP + -0x20],EAX
00a0a713 : XOR ESI,ESI
00a0a715 : MOV dword ptr [EBP + -0x2c],ESI
00a0a718 : MOV dword ptr [EBP + -0x24],EBX
00a0a71b : MOV dword ptr [EBP + -0x1c],ECX
00a0a71e : MOV EDI,EDI
00a0a720 : LEA EAX,[EBX + 0x4]
00a0a723 : CMP EAX,dword ptr [EBP + -0x20]
00a0a726 : JA 0x00a0a831
00a0a72c : MOV EDX,ESI
00a0a72e : AND EDX,0x80000003
00a0a734 : JNS 0x00a0a73b
00a0a736 : DEC EDX
00a0a737 : OR EDX,0xfffffffc
00a0a73a : INC EDX
00a0a73b : JNZ 0x00a0a752
00a0a73d : MOV dword ptr [EBP + -0x24],EBX
00a0a740 : MOV dword ptr [EBP + -0x1c],ECX
00a0a743 : PUSH EBX
00a0a744 : PUSH 0xcabfbc
00a0a749 : PUSH EDI
00a0a74a : CALL 0x006372ee
00a0a74f : ADD ESP,0xc
00a0a752 : INC ESI
00a0a753 : MOV dword ptr [EBP + -0x2c],ESI
00a0a756 : MOV EAX,ESI
00a0a758 : AND EAX,0x80000003
00a0a75d : JNS 0x00a0a764
00a0a75f : DEC EAX
00a0a760 : OR EAX,0xfffffffc
00a0a763 : INC EAX
00a0a764 : JZ 0x00a0a78c
00a0a766 : LEA ECX,[EBX + 0x8]
00a0a769 : CMP ECX,dword ptr [EBP + -0x20]
00a0a76c : JA 0x00a0a78c
00a0a76e : MOV EDX,dword ptr [EBX]
00a0a770 : PUSH EDX
00a0a771 : PUSH 0xcac000
00a0a776 : PUSH EDI
00a0a777 : CALL 0x006372ee
00a0a77c : ADD ESP,0xc
00a0a77f : INC dword ptr [EBP + -0x1c]
00a0a782 : ADD EBX,0x4
00a0a785 : MOV dword ptr [EBP + 0xc],EBX
00a0a788 : XOR ECX,ECX
00a0a78a : JMP 0x00a0a720
00a0a78c : MOV EAX,dword ptr [EBX]
00a0a78e : PUSH EAX
00a0a78f : PUSH 0xcabfd0
00a0a794 : PUSH EDI
00a0a795 : CALL 0x006372ee
00a0a79a : ADD ESP,0xc
00a0a79d : MOV ESI,dword ptr [EBP + -0x1c]
00a0a7a0 : INC ESI
00a0a7a1 : MOV dword ptr [EBP + -0x1c],ESI
00a0a7a4 : MOV dword ptr [EBP + -0x30],ESI
00a0a7a7 : CMP ESI,0x4
00a0a7aa : JGE 0x00a0a7bd
00a0a7ac : PUSH 0xcabfdc
00a0a7b1 : PUSH EDI
00a0a7b2 : CALL 0x006372ee
00a0a7b7 : ADD ESP,0x8
00a0a7ba : INC ESI
00a0a7bb : JMP 0x00a0a7a4
00a0a7bd : MOV dword ptr [EBP + -0x28],0x0
00a0a7c4 : MOV ECX,dword ptr [EBP + -0x28]
00a0a7c7 : CMP ECX,dword ptr [EBP + -0x1c]
00a0a7ca : JGE 0x00a0a813
00a0a7cc : MOV EDX,dword ptr [EBP + -0x24]
00a0a7cf : MOV EBX,dword ptr [EDX]
00a0a7d1 : XOR ESI,ESI
00a0a7d3 : MOV dword ptr [EBP + -0x38],ESI
00a0a7d6 : MOV dword ptr [EBP + -0x34],EBX
00a0a7d9 : CMP ESI,0x4
00a0a7dc : JGE 0x00a0a807
00a0a7de : MOV AL,BL
00a0a7e0 : CMP AL,0x20
00a0a7e2 : JL 0x00a0a7e8
00a0a7e4 : CMP AL,0x7e
00a0a7e6 : JLE 0x00a0a7ea
00a0a7e8 : MOV AL,0x2e
00a0a7ea : CBW
00a0a7ec : MOVZX EAX,AX
00a0a7ef : MOVZX ECX,AX
00a0a7f2 : PUSH ECX
00a0a7f3 : PUSH 0xcabff0
00a0a7f8 : PUSH EDI
00a0a7f9 : CALL 0x006372ee
00a0a7fe : ADD ESP,0xc
00a0a801 : SHR EBX,0x8
00a0a804 : INC ESI
00a0a805 : JMP 0x00a0a7d3
00a0a807 : ADD dword ptr [EBP + -0x24],0x4
00a0a80b : INC dword ptr [EBP + -0x28]
00a0a80e : MOV EBX,dword ptr [EBP + 0xc]
00a0a811 : JMP 0x00a0a7c4
00a0a813 : PUSH 0xcabff8
00a0a818 : PUSH EDI
00a0a819 : CALL 0x006372ee
00a0a81e : ADD ESP,0x8
00a0a821 : MOV ESI,dword ptr [EBP + -0x2c]
00a0a824 : ADD EBX,0x4
00a0a827 : MOV dword ptr [EBP + 0xc],EBX
00a0a82a : XOR ECX,ECX
00a0a82c : JMP 0x00a0a720
00a0a831 : PUSH 0xcac00c
00a0a836 : PUSH EDI
00a0a837 : JMP 0x00a0a84b
00a0a84b : CALL 0x006372ee
00a0a850 : ADD ESP,0x8
00a0a853 : MOV dword ptr [EBP + -0x4],0xfffffffe
00a0a85a : MOV ECX,dword ptr [EBP + -0x10]
00a0a85d : MOV dword ptr FS:[0x0],ECX
00a0a864 : POP ECX
00a0a865 : POP EDI
00a0a866 : POP ESI
00a0a867 : POP EBX
00a0a868 : MOV ESP,EBP
00a0a86a : POP EBP
00a0a86b : RET

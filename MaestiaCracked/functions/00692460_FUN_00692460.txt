PROGRAM  : Maestia.exe
FUNCTION : FUN_00692460
ENTRY    : 00692460
BODY     : [[00692460, 0069262a] [00692630, 00692812]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_00692460(int param_1,int param_2)

{
  undefined1 *puVar1;
  undefined1 *puVar2;
  int iVar3;
  undefined1 *puVar4;
  undefined1 uVar5;
  byte bVar6;
  ushort uVar7;
  ushort uVar8;
  undefined1 *puVar9;
  int iVar10;
  undefined1 *puVar11;
  uint uVar12;
  undefined1 *puVar13;
  uint uVar14;
  int iVar15;
  uint uVar16;
  uint uVar17;
  uint uVar18;
  bool bVar19;
  bool bVar20;
  uint local_38;
  uint uStack_34;
  uint local_30;
  uint uStack_28;
  undefined1 *puStack_24;
  uint uStack_1c;
  
  local_30 = (uint)CONCAT11(*(undefined1 *)(param_1 + 2),*(undefined1 *)(param_1 + 3));
  local_38 = 0;
  if (local_30 < 0x10) {
    FUN_00686490(param_2,8);
  }
  if (*(uint *)(param_2 + 4) < local_30 + param_1) {
    if (0 < *(int *)(param_2 + 8)) {
      FUN_00686490(param_2,8);
    }
    local_30 = *(int *)(param_2 + 4) - param_1;
  }
  uVar5 = *(undefined1 *)(param_1 + 6);
  bVar6 = *(byte *)(param_1 + 7);
  if ((1 < *(int *)(param_2 + 8)) && ((bVar6 & 1) != 0)) {
    FUN_00686490(param_2,8);
  }
  uVar12 = (uint)(ushort)(CONCAT11(uVar5,bVar6) >> 1);
  if (local_30 < uVar12 * 8 + 0x10) {
    FUN_00686490(param_2,8);
  }
  if (1 < *(int *)(param_2 + 8)) {
    bVar6 = *(byte *)(param_1 + 0xb);
    uVar7 = CONCAT11(*(undefined1 *)(param_1 + 8),*(undefined1 *)(param_1 + 9));
    uVar8 = CONCAT11(*(undefined1 *)(param_1 + 0xc),*(undefined1 *)(param_1 + 0xd));
    if (((uVar8 | uVar7) & 1) != 0) {
      FUN_00686490(param_2,8);
    }
    uVar17 = (uint)(uVar7 >> 1);
    if ((((uVar12 < uVar17) || (uVar17 * 2 < uVar12)) || ((uVar8 >> 1) + uVar17 != uVar12)) ||
       (uVar17 != 1 << (bVar6 & 0x1f))) {
      FUN_00686490(param_2,8);
    }
  }
  iVar10 = param_1 + 0x10 + uVar12 * 2;
  iVar3 = iVar10 + uVar12 * 2;
  puVar4 = (undefined1 *)(iVar3 + uVar12 * 2);
  if ((1 < *(int *)(param_2 + 8)) &&
     (CONCAT11(*(undefined1 *)(param_1 + 0xc + uVar12 * 2),
               *(undefined1 *)(param_1 + 0xd + uVar12 * 2)) != -1)) {
    FUN_00686490(param_2,8);
  }
  uStack_1c = 0;
  uStack_28 = 0;
  uStack_34 = 0;
  if (uVar12 != 0) {
    puStack_24 = (undefined1 *)(param_1 + 0xc);
    puVar9 = (undefined1 *)(iVar10 + -1);
    iVar10 = iVar3 + -1;
    puVar11 = puVar4;
    do {
      puVar13 = puVar9 + 1;
      puVar9 = puVar9 + 2;
      uVar16 = (uint)CONCAT11(*puVar13,*puVar9);
      puStack_24 = puStack_24 + 2;
      uVar18 = (uint)CONCAT11(*puStack_24,*(undefined1 *)(iVar10 + ((param_1 + 0x10) - iVar3)));
      uVar17 = (int)(short)((short)*(char *)(iVar10 + 1) << 8) | (uint)*(byte *)(iVar10 + 2);
      uVar14 = (uint)CONCAT11(*puVar11,puVar4[(iVar10 + 2) - iVar3]);
      if (uVar18 < uVar16) {
        FUN_00686490(param_2,8);
      }
      if ((uVar16 <= uStack_28) && (uStack_34 != 0)) {
        if (*(int *)(param_2 + 8) < 1) {
          if ((uVar16 < uStack_1c) || (uVar18 < uStack_28)) {
            local_38 = local_38 | 1;
          }
          else {
            local_38 = local_38 | 2;
          }
        }
        else {
          FUN_00686490(param_2,8);
        }
      }
      if (uVar14 != 0) {
        if (uVar14 == 0xffff) {
          if ((((1 < *(int *)(param_2 + 8)) || (uStack_34 != uVar12 - 1)) || (uVar16 != 0xffff)) ||
             ((uVar18 != 0xffff || (uVar17 != 1)))) {
            FUN_00686490(param_2,8);
          }
        }
        else {
          puVar13 = puVar11 + uVar14;
          if (*(int *)(param_2 + 8) < 1) {
            if (puVar4 + uVar12 * 2 <= puVar13) {
              bVar19 = puVar13 + (uVar18 - uVar16) * 2 + 2 < *(undefined1 **)(param_2 + 4);
              bVar20 = puVar13 + (uVar18 - uVar16) * 2 + 2 == *(undefined1 **)(param_2 + 4);
              goto LAB_00692757;
            }
LAB_00692759:
            FUN_00686490(param_2,8);
          }
          else {
            if (puVar13 < puVar4 + uVar12 * 2) goto LAB_00692759;
            bVar19 = puVar13 + (uVar18 - uVar16) * 2 + 2 < (undefined1 *)(local_30 + param_1);
            bVar20 = puVar13 + (uVar18 - uVar16) * 2 + 2 == (undefined1 *)(local_30 + param_1);
LAB_00692757:
            if (!bVar19 && !bVar20) goto LAB_00692759;
          }
          if ((0 < *(int *)(param_2 + 8)) && (uVar16 < uVar18)) {
            puVar13 = puVar13 + -1;
            iVar15 = uVar18 - uVar16;
            do {
              puVar1 = puVar13 + 1;
              puVar2 = puVar13 + 2;
              puVar13 = puVar13 + 2;
              if ((CONCAT11(*puVar1,*puVar2) != 0) &&
                 (*(uint *)(param_2 + 0x50) <= (CONCAT11(*puVar1,*puVar2) + uVar17 & 0xffff))) {
                FUN_00686490(param_2,0x10);
              }
              iVar15 = iVar15 + -1;
            } while (iVar15 != 0);
          }
        }
      }
      uStack_34 = uStack_34 + 1;
      iVar10 = iVar10 + 2;
      puVar11 = puVar11 + 2;
      uStack_28 = uVar18;
      uStack_1c = uVar16;
    } while (uStack_34 < uVar12);
  }
  return local_38;
}



============================================================
DISASSEMBLY
============================================================
00692460 : SUB ESP,0x38
00692463 : PUSH EBX
00692464 : PUSH EBP
00692465 : MOV EBP,dword ptr [ESP + 0x48]
00692469 : PUSH ESI
0069246a : PUSH EDI
0069246b : MOV EDI,dword ptr [ESP + 0x4c]
0069246f : MOVZX AX,byte ptr [EDI + 0x2]
00692474 : MOVZX ECX,byte ptr [EDI + 0x3]
00692478 : SHL AX,0x8
0069247c : MOVZX ESI,AX
0069247f : OR ESI,ECX
00692481 : MOV dword ptr [ESP + 0x18],ESI
00692485 : MOV dword ptr [ESP + 0x10],0x0
0069248d : CMP ESI,0x10
00692490 : JNC 0x0069249d
00692492 : PUSH 0x8
00692494 : PUSH EBP
00692495 : CALL 0x00686490
0069249a : ADD ESP,0x8
0069249d : MOV EDX,dword ptr [EBP + 0x4]
006924a0 : ADD ESI,EDI
006924a2 : CMP ESI,EDX
006924a4 : JBE 0x006924c2
006924a6 : MOV EAX,dword ptr [EBP + 0x8]
006924a9 : CMP EAX,0x1
006924ac : JL 0x006924b9
006924ae : PUSH 0x8
006924b0 : PUSH EBP
006924b1 : CALL 0x00686490
006924b6 : ADD ESP,0x8
006924b9 : MOV EAX,dword ptr [EBP + 0x4]
006924bc : SUB EAX,EDI
006924be : MOV dword ptr [ESP + 0x18],EAX
006924c2 : MOVZX CX,byte ptr [EDI + 0x6]
006924c7 : MOVZX EDX,byte ptr [EDI + 0x7]
006924cb : MOV EAX,dword ptr [EBP + 0x8]
006924ce : LEA ESI,[EDI + 0x8]
006924d1 : SHL CX,0x8
006924d5 : MOVZX EBX,CX
006924d8 : OR EBX,EDX
006924da : CMP EAX,0x2
006924dd : JL 0x006924ef
006924df : TEST BL,0x1
006924e2 : JZ 0x006924ef
006924e4 : PUSH 0x8
006924e6 : PUSH EBP
006924e7 : CALL 0x00686490
006924ec : ADD ESP,0x8
006924ef : SHR EBX,0x1
006924f1 : LEA ECX,[EBX*0x8 + 0x10]
006924f8 : MOV dword ptr [ESP + 0x30],EBX
006924fc : CMP dword ptr [ESP + 0x18],ECX
00692500 : JNC 0x0069250d
00692502 : PUSH 0x8
00692504 : PUSH EBP
00692505 : CALL 0x00686490
0069250a : ADD ESP,0x8
0069250d : MOV EDX,dword ptr [EBP + 0x8]
00692510 : CMP EDX,0x2
00692513 : JL 0x006925a6
00692519 : MOVZX AX,byte ptr [ESI]
0069251d : MOVZX ECX,byte ptr [ESI + 0x1]
00692521 : ADD ESI,0x2
00692524 : MOVZX EDX,byte ptr [ESI]
00692527 : ADD ESI,0x2
0069252a : SHL AX,0x8
0069252e : MOVZX EDI,AX
00692531 : MOVZX EAX,byte ptr [ESI + -0x1]
00692535 : SHL DX,0x8
00692539 : OR EDI,ECX
0069253b : MOVZX ECX,DX
0069253e : MOVZX EDX,byte ptr [ESI]
00692541 : ADD ESI,0x2
00692544 : SHL DX,0x8
00692548 : OR ECX,EAX
0069254a : MOVZX EAX,byte ptr [ESI + -0x1]
0069254e : MOVZX EBP,DX
00692551 : OR EBP,EAX
00692553 : MOV EDX,EBP
00692555 : OR EDX,EDI
00692557 : MOV dword ptr [ESP + 0x2c],ECX
0069255b : TEST DL,0x1
0069255e : JZ 0x00692573
00692560 : MOV EAX,dword ptr [ESP + 0x50]
00692564 : PUSH 0x8
00692566 : PUSH EAX
00692567 : CALL 0x00686490
0069256c : MOV ECX,dword ptr [ESP + 0x34]
00692570 : ADD ESP,0x8
00692573 : SHR EDI,0x1
00692575 : CMP EDI,EBX
00692577 : JA 0x00692593
00692579 : LEA EDX,[EDI + EDI*0x1]
0069257c : CMP EDX,EBX
0069257e : JC 0x00692593
00692580 : SHR EBP,0x1
00692582 : ADD EBP,EDI
00692584 : CMP EBP,EBX
00692586 : JNZ 0x00692593
00692588 : MOV EAX,0x1
0069258d : SHL EAX,CL
0069258f : CMP EDI,EAX
00692591 : JZ 0x006925a2
00692593 : MOV ECX,dword ptr [ESP + 0x50]
00692597 : PUSH 0x8
00692599 : PUSH ECX
0069259a : CALL 0x00686490
0069259f : ADD ESP,0x8
006925a2 : MOV EDI,dword ptr [ESP + 0x4c]
006925a6 : MOV ECX,dword ptr [ESP + 0x50]
006925aa : LEA EAX,[EDI + EBX*0x2 + 0x10]
006925ae : LEA ESI,[EAX + EBX*0x2]
006925b1 : LEA EBP,[EDI + 0xe]
006925b4 : LEA EDI,[ESI + EBX*0x2]
006925b7 : LEA EDX,[EDI + EBX*0x2]
006925ba : MOV dword ptr [ESP + 0x28],EDX
006925be : MOV EDX,dword ptr [ECX + 0x8]
006925c1 : CMP EDX,0x2
006925c4 : MOV dword ptr [ESP + 0x2c],EAX
006925c8 : JL 0x006925fa
006925ca : MOVZX CX,byte ptr [EBP + EBX*0x2 + -0x2]
006925d0 : MOVZX DX,byte ptr [EBP + EBX*0x2 + -0x1]
006925d6 : SHL CX,0x8
006925da : OR CX,DX
006925dd : MOV EDX,0xffff
006925e2 : CMP CX,DX
006925e5 : JZ 0x006925fa
006925e7 : MOV EAX,dword ptr [ESP + 0x50]
006925eb : PUSH 0x8
006925ed : PUSH EAX
006925ee : CALL 0x00686490
006925f3 : MOV EAX,dword ptr [ESP + 0x34]
006925f7 : ADD ESP,0x8
006925fa : XOR ECX,ECX
006925fc : MOV dword ptr [ESP + 0x2c],ECX
00692600 : MOV dword ptr [ESP + 0x20],ECX
00692604 : MOV EDX,EDI
00692606 : MOV dword ptr [ESP + 0x14],ECX
0069260a : CMP EBX,ECX
0069260c : JBE 0x00692807
00692612 : LEA ECX,[EBP + -0x2]
00692615 : SUB EBP,ESI
00692617 : DEC EAX
00692618 : SUB EDI,ESI
0069261a : MOV dword ptr [ESP + 0x24],ECX
0069261e : LEA ECX,[ESI + -0x1]
00692621 : MOV dword ptr [ESP + 0x34],EBP
00692625 : MOV dword ptr [ESP + 0x44],EDI
00692629 : JMP 0x00692640
00692630 : MOV ECX,dword ptr [ESP + 0x3c]
00692634 : MOV EBP,dword ptr [ESP + 0x34]
00692638 : MOV EDX,dword ptr [ESP + 0x40]
0069263c : MOV EAX,dword ptr [ESP + 0x38]
00692640 : MOVZX SI,byte ptr [EAX + 0x1]
00692645 : ADD EAX,0x2
00692648 : MOVZX EDI,byte ptr [ECX + EBP*0x1 + 0x2]
0069264d : MOV dword ptr [ESP + 0x38],EAX
00692651 : MOVZX EAX,byte ptr [EAX]
00692654 : MOVZX EBP,byte ptr [ECX + 0x2]
00692658 : SHL SI,0x8
0069265c : MOVZX ESI,SI
0069265f : OR ESI,EAX
00692661 : MOV EAX,dword ptr [ESP + 0x24]
00692665 : ADD EAX,0x2
00692668 : MOV dword ptr [ESP + 0x24],EAX
0069266c : MOVZX EAX,byte ptr [EAX]
0069266f : ADD ECX,0x2
00692672 : SHL AX,0x8
00692676 : MOVZX EAX,AX
00692679 : OR EDI,EAX
0069267b : MOVSX EAX,byte ptr [ECX + -0x1]
0069267f : MOV EBX,EDX
00692681 : ADD EDX,0x2
00692684 : SHL AX,0x8
00692688 : MOV dword ptr [ESP + 0x40],EDX
0069268c : MOVZX DX,byte ptr [EDX + -0x2]
00692691 : CWDE
00692692 : OR EAX,EBP
00692694 : SHL DX,0x8
00692698 : MOVZX EBP,DX
0069269b : MOV EDX,dword ptr [ESP + 0x44]
0069269f : MOV dword ptr [ESP + 0x3c],ECX
006926a3 : MOVZX ECX,byte ptr [EDX + ECX*0x1]
006926a7 : OR EBP,ECX
006926a9 : MOV dword ptr [ESP + 0x1c],EAX
006926ad : CMP ESI,EDI
006926af : JBE 0x006926c4
006926b1 : MOV EDX,dword ptr [ESP + 0x50]
006926b5 : PUSH 0x8
006926b7 : PUSH EDX
006926b8 : CALL 0x00686490
006926bd : MOV EAX,dword ptr [ESP + 0x24]
006926c1 : ADD ESP,0x8
006926c4 : MOV ECX,dword ptr [ESP + 0x50]
006926c8 : CMP ESI,dword ptr [ESP + 0x20]
006926cc : JA 0x0069270a
006926ce : CMP dword ptr [ESP + 0x14],0x0
006926d3 : JBE 0x0069270a
006926d5 : MOV EDX,dword ptr [ECX + 0x8]
006926d8 : CMP EDX,0x1
006926db : JL 0x006926f2
006926dd : PUSH 0x8
006926df : PUSH ECX
006926e0 : CALL 0x00686490
006926e5 : MOV ECX,dword ptr [ESP + 0x58]
006926e9 : MOV EAX,dword ptr [ESP + 0x24]
006926ed : ADD ESP,0x8
006926f0 : JMP 0x0069270a
006926f2 : CMP dword ptr [ESP + 0x2c],ESI
006926f6 : JA 0x00692705
006926f8 : CMP dword ptr [ESP + 0x20],EDI
006926fc : JA 0x00692705
006926fe : OR dword ptr [ESP + 0x10],0x2
00692703 : JMP 0x0069270a
00692705 : OR dword ptr [ESP + 0x10],0x1
0069270a : TEST EBP,EBP
0069270c : JZ 0x006927ec
00692712 : CMP EBP,0xffff
00692718 : JZ 0x006927bd
0069271e : MOV EAX,dword ptr [ECX + 0x8]
00692721 : ADD EBX,EBP
00692723 : CMP EAX,0x1
00692726 : JL 0x00692744
00692728 : CMP EBX,dword ptr [ESP + 0x28]
0069272c : JC 0x00692759
0069272e : MOV EBP,dword ptr [ESP + 0x4c]
00692732 : MOV EDX,EDI
00692734 : SUB EDX,ESI
00692736 : LEA EAX,[EBX + EDX*0x2 + 0x2]
0069273a : MOV EDX,dword ptr [ESP + 0x18]
0069273e : ADD EDX,EBP
00692740 : CMP EAX,EDX
00692742 : JMP 0x00692757
00692744 : CMP EBX,dword ptr [ESP + 0x28]
00692748 : JC 0x00692759
0069274a : MOV EAX,EDI
0069274c : SUB EAX,ESI
0069274e : LEA EDX,[EBX + EAX*0x2 + 0x2]
00692752 : MOV EAX,dword ptr [ECX + 0x4]
00692755 : CMP EDX,EAX
00692757 : JBE 0x00692768
00692759 : PUSH 0x8
0069275b : PUSH ECX
0069275c : CALL 0x00686490
00692761 : MOV ECX,dword ptr [ESP + 0x58]
00692765 : ADD ESP,0x8
00692768 : MOV EDX,dword ptr [ECX + 0x8]
0069276b : CMP EDX,0x1
0069276e : JL 0x006927ec
00692770 : CMP ESI,EDI
00692772 : JNC 0x006927ec
00692774 : MOV EBP,EDI
00692776 : DEC EBX
00692777 : SUB EBP,ESI
00692779 : LEA ESP,[ESP]
00692780 : MOVZX AX,byte ptr [EBX + 0x1]
00692785 : MOVZX EDX,byte ptr [EBX + 0x2]
00692789 : ADD EBX,0x2
0069278c : SHL AX,0x8
00692790 : MOVZX EAX,AX
00692793 : OR EAX,EDX
00692795 : JZ 0x006927b6
00692797 : MOV EDX,dword ptr [ESP + 0x1c]
0069279b : ADD EAX,EDX
0069279d : AND EAX,0xffff
006927a2 : CMP EAX,dword ptr [ECX + 0x50]
006927a5 : JC 0x006927b6
006927a7 : PUSH 0x10
006927a9 : PUSH ECX
006927aa : CALL 0x00686490
006927af : MOV ECX,dword ptr [ESP + 0x58]
006927b3 : ADD ESP,0x8
006927b6 : SUB EBP,0x1
006927b9 : JNZ 0x00692780
006927bb : JMP 0x006927ec
006927bd : MOV EDX,dword ptr [ECX + 0x8]
006927c0 : CMP EDX,0x2
006927c3 : JGE 0x006927e1
006927c5 : MOV EDX,dword ptr [ESP + 0x30]
006927c9 : DEC EDX
006927ca : CMP dword ptr [ESP + 0x14],EDX
006927ce : JNZ 0x006927e1
006927d0 : CMP ESI,0xffff
006927d6 : JNZ 0x006927e1
006927d8 : CMP EDI,ESI
006927da : JNZ 0x006927e1
006927dc : CMP EAX,0x1
006927df : JZ 0x006927ec
006927e1 : PUSH 0x8
006927e3 : PUSH ECX
006927e4 : CALL 0x00686490
006927e9 : ADD ESP,0x8
006927ec : MOV EAX,dword ptr [ESP + 0x14]
006927f0 : INC EAX
006927f1 : MOV dword ptr [ESP + 0x2c],ESI
006927f5 : MOV dword ptr [ESP + 0x20],EDI
006927f9 : MOV dword ptr [ESP + 0x14],EAX
006927fd : CMP EAX,dword ptr [ESP + 0x30]
00692801 : JC 0x00692630
00692807 : MOV EAX,dword ptr [ESP + 0x10]
0069280b : POP EDI
0069280c : POP ESI
0069280d : POP EBP
0069280e : POP EBX
0069280f : ADD ESP,0x38
00692812 : RET

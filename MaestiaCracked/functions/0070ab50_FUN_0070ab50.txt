PROGRAM  : Maestia.exe
FUNCTION : FUN_0070ab50
ENTRY    : 0070ab50
BODY     : [[0070ab50, 0070ac13]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0070ab50(void)

{
  uint uVar1;
  int *in_ECX;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  puStack_c = &LAB_00b11758;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *in_ECX = (int)&PTR_FUN_00cda51c;
  local_8 = 2;
  if (in_ECX[8] != 0) {
    (**(code **)(*in_ECX + 4))(uVar1);
    if ((FILE *)in_ECX[8] != (FILE *)0x0) {
      _fclose((FILE *)in_ECX[8]);
      in_ECX[8] = 0;
    }
  }
  local_8 = CONCAT31(local_8._1_3_,1);
  if (7 < (uint)in_ECX[0x16]) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  in_ECX[0x16] = 7;
  in_ECX[0x15] = 0;
  *(undefined2 *)(in_ECX + 0x11) = 0;
  local_8 = (uint)local_8._1_3_ << 8;
  if (7 < (uint)in_ECX[0xf]) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  in_ECX[0xf] = 7;
  in_ECX[0xe] = 0;
  *(undefined2 *)(in_ECX + 10) = 0;
  local_8 = 0xffffffff;
  in_ECX[1] = (int)&PTR_FUN_00cdec94;
  DeleteCriticalSection((LPCRITICAL_SECTION)(in_ECX + 2));
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
0070ab50 : PUSH EBP
0070ab51 : MOV EBP,ESP
0070ab53 : PUSH -0x1
0070ab55 : PUSH 0xb11758
0070ab5a : MOV EAX,FS:[0x0]
0070ab60 : PUSH EAX
0070ab61 : PUSH ECX
0070ab62 : PUSH EBX
0070ab63 : PUSH ESI
0070ab64 : MOV EAX,[0x00d66fa0]
0070ab69 : XOR EAX,EBP
0070ab6b : PUSH EAX
0070ab6c : LEA EAX,[EBP + -0xc]
0070ab6f : MOV FS:[0x0],EAX
0070ab75 : MOV ESI,ECX
0070ab77 : MOV dword ptr [EBP + -0x10],ESI
0070ab7a : MOV dword ptr [ESI],0xcda51c
0070ab80 : MOV dword ptr [EBP + -0x4],0x2
0070ab87 : XOR EBX,EBX
0070ab89 : CMP dword ptr [ESI + 0x20],EBX
0070ab8c : JZ 0x0070aba8
0070ab8e : MOV EAX,dword ptr [ESI]
0070ab90 : MOV EDX,dword ptr [EAX + 0x4]
0070ab93 : CALL EDX
0070ab95 : MOV EAX,dword ptr [ESI + 0x20]
0070ab98 : CMP EAX,EBX
0070ab9a : JZ 0x0070aba8
0070ab9c : PUSH EAX
0070ab9d : CALL 0x006366db
0070aba2 : ADD ESP,0x4
0070aba5 : MOV dword ptr [ESI + 0x20],EBX
0070aba8 : MOV byte ptr [EBP + -0x4],0x1
0070abac : CMP dword ptr [ESI + 0x58],0x8
0070abb0 : JC 0x0070abba
0070abb2 : MOV ECX,dword ptr [ESI + 0x44]
0070abb5 : CALL 0x006f04e0
0070abba : MOV dword ptr [ESI + 0x58],0x7
0070abc1 : MOV dword ptr [ESI + 0x54],EBX
0070abc4 : XOR EAX,EAX
0070abc6 : MOV word ptr [ESI + 0x44],AX
0070abca : MOV byte ptr [EBP + -0x4],BL
0070abcd : CMP dword ptr [ESI + 0x3c],0x8
0070abd1 : JC 0x0070abdb
0070abd3 : MOV ECX,dword ptr [ESI + 0x28]
0070abd6 : CALL 0x006f04e0
0070abdb : MOV dword ptr [ESI + 0x3c],0x7
0070abe2 : MOV dword ptr [ESI + 0x38],EBX
0070abe5 : XOR ECX,ECX
0070abe7 : MOV word ptr [ESI + 0x28],CX
0070abeb : MOV dword ptr [EBP + -0x4],0xffffffff
0070abf2 : MOV dword ptr [ESI + 0x4],0xcdec94
0070abf9 : ADD ESI,0x8
0070abfc : PUSH ESI
0070abfd : CALL dword ptr [0x00b850fc]
0070ac03 : MOV ECX,dword ptr [EBP + -0xc]
0070ac06 : MOV dword ptr FS:[0x0],ECX
0070ac0d : POP ECX
0070ac0e : POP ESI
0070ac0f : POP EBX
0070ac10 : MOV ESP,EBP
0070ac12 : POP EBP
0070ac13 : RET

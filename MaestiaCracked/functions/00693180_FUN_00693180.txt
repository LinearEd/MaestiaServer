PROGRAM  : Maestia.exe
FUNCTION : FUN_00693180
ENTRY    : 00693180
BODY     : [[00693180, 00693463]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00693180(int param_1,int param_2)

{
  undefined1 uVar1;
  undefined1 uVar2;
  undefined1 uVar3;
  undefined1 uVar4;
  short sVar5;
  short sVar6;
  uint uVar7;
  undefined1 *puVar8;
  int iVar9;
  undefined1 *puVar10;
  undefined1 *puVar11;
  int iVar12;
  int iVar13;
  uint uVar14;
  uint uVar15;
  uint uStack_c;
  uint uStack_8;
  
  if (*(uint *)(param_2 + 4) < param_1 + 0x2010U) {
    FUN_00686490(param_2,8);
  }
  uVar7 = CONCAT31(CONCAT21(CONCAT11(*(undefined1 *)(param_1 + 4),*(undefined1 *)(param_1 + 5)),
                            *(undefined1 *)(param_1 + 6)),*(undefined1 *)(param_1 + 7));
  if ((*(uint *)(param_2 + 4) < uVar7 + param_1) || (uVar7 < 0x2010)) {
    FUN_00686490(param_2,8);
  }
  iVar12 = param_1 + 0x200c;
  puVar11 = (undefined1 *)(param_1 + 0x200f);
  puVar8 = (undefined1 *)(param_1 + 0x200d);
  iVar9 = param_1 + 0x200e;
  uVar7 = CONCAT31(CONCAT21(CONCAT11(*(undefined1 *)(param_1 + 0x200c),
                                     *(undefined1 *)(param_1 + 0x200d)),
                            *(undefined1 *)(param_1 + 0x200e)),*puVar11);
  if (*(uint *)(param_2 + 4) < param_1 + 0x2010 + uVar7 * 0xc) {
    FUN_00686490(param_2,8);
  }
  uStack_8 = 0;
  uStack_c = 0;
  if (uVar7 != 0) {
    do {
      sVar5 = CONCAT11(*(undefined1 *)(iVar12 + 4),puVar8[4]);
      uVar15 = CONCAT31(CONCAT21(sVar5,*(undefined1 *)(iVar9 + 4)),puVar11[4]);
      sVar6 = CONCAT11(*(undefined1 *)(iVar12 + 8),puVar8[8]);
      puVar10 = puVar11 + 8;
      puVar11 = puVar11 + 0xc;
      uVar14 = CONCAT31(CONCAT21(sVar6,*(undefined1 *)(iVar9 + 8)),*puVar10);
      uVar1 = *(undefined1 *)(iVar12 + 0xc);
      iVar12 = iVar12 + 0xc;
      puVar8 = puVar8 + 0xc;
      uVar2 = *puVar8;
      uVar3 = *(undefined1 *)(iVar9 + 0xc);
      iVar9 = iVar9 + 0xc;
      uVar4 = *puVar11;
      if (uVar14 < uVar15) {
        FUN_00686490(param_2,8);
      }
      if ((uStack_c != 0) && (uVar15 <= uStack_8)) {
        FUN_00686490(param_2,8);
      }
      if (0 < *(int *)(param_2 + 8)) {
        if (*(uint *)(param_2 + 0x50) <=
            (CONCAT31(CONCAT21(CONCAT11(uVar1,uVar2),uVar3),uVar4) - uVar15) + uVar14) {
          FUN_00686490(param_2,0x10);
        }
        iVar13 = (uVar14 - uVar15) + 1;
        if (sVar5 == 0) {
          if (sVar6 != 0) {
            FUN_00686490(param_2,8);
          }
          for (; iVar13 != 0; iVar13 = iVar13 + -1) {
            if ((*(byte *)(((uVar15 & 0xffff) >> 3) + 0xc + param_1) &
                (byte)(0x80 >> ((byte)(uVar15 & 0xffff) & 7))) != 0) {
              FUN_00686490(param_2,8);
            }
            uVar15 = uVar15 + 1;
          }
        }
        else {
          for (; iVar13 != 0; iVar13 = iVar13 + -1) {
            if ((*(byte *)((uVar15 >> 0x13) + 0xc + param_1) &
                (byte)(0x80 >> ((byte)(uVar15 >> 0x10) & 7))) == 0) {
              FUN_00686490(param_2,8);
            }
            if ((*(byte *)(((uVar15 & 0xffff) >> 3) + 0xc + param_1) &
                (byte)(0x80 >> ((byte)(uVar15 & 0xffff) & 7))) == 0) {
              FUN_00686490(param_2,8);
            }
            uVar15 = uVar15 + 1;
          }
        }
      }
      uStack_c = uStack_c + 1;
      uStack_8 = uVar14;
    } while (uStack_c < uVar7);
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00693180 : SUB ESP,0x1c
00693183 : PUSH EBX
00693184 : PUSH EBP
00693185 : MOV EBP,dword ptr [ESP + 0x2c]
00693189 : MOV ECX,dword ptr [EBP + 0x4]
0069318c : PUSH ESI
0069318d : PUSH EDI
0069318e : MOV EDI,dword ptr [ESP + 0x30]
00693192 : LEA EAX,[EDI + 0x2010]
00693198 : LEA ESI,[EDI + 0x4]
0069319b : CMP EAX,ECX
0069319d : JBE 0x006931aa
0069319f : PUSH 0x8
006931a1 : PUSH EBP
006931a2 : CALL 0x00686490
006931a7 : ADD ESP,0x8
006931aa : MOVZX EAX,byte ptr [ESI]
006931ad : MOVZX EDX,byte ptr [ESI + 0x1]
006931b1 : MOVZX ECX,byte ptr [ESI + 0x2]
006931b5 : ADD ESI,0x4
006931b8 : SHL EAX,0x8
006931bb : OR EAX,EDX
006931bd : MOVZX EDX,byte ptr [ESI + -0x1]
006931c1 : SHL EAX,0x8
006931c4 : OR EAX,ECX
006931c6 : SHL EAX,0x8
006931c9 : OR EAX,EDX
006931cb : MOV EDX,dword ptr [EBP + 0x4]
006931ce : LEA ECX,[EAX + EDI*0x1]
006931d1 : CMP ECX,EDX
006931d3 : JA 0x006931dc
006931d5 : CMP EAX,0x2010
006931da : JNC 0x006931e7
006931dc : PUSH 0x8
006931de : PUSH EBP
006931df : CALL 0x00686490
006931e4 : ADD ESP,0x8
006931e7 : MOVZX ESI,byte ptr [EDI + 0x200c]
006931ee : LEA EBX,[EDI + 0x200c]
006931f4 : LEA EDX,[EDI + 0x200f]
006931fa : MOV dword ptr [ESP + 0x1c],EDX
006931fe : MOVZX EDX,byte ptr [EDI + 0x200d]
00693205 : LEA EAX,[EDI + 0x200d]
0069320b : SHL ESI,0x8
0069320e : OR ESI,EDX
00693210 : MOVZX EDX,byte ptr [EDI + 0x200e]
00693217 : LEA ECX,[EDI + 0x200e]
0069321d : SHL ESI,0x8
00693220 : OR ESI,EDX
00693222 : MOV EDX,dword ptr [ESP + 0x1c]
00693226 : MOVZX EDX,byte ptr [EDX]
00693229 : SHL ESI,0x8
0069322c : OR ESI,EDX
0069322e : LEA EDX,[ESI + ESI*0x2]
00693231 : LEA EDX,[EDI + EDX*0x4 + 0x2010]
00693238 : MOV EDI,dword ptr [EBP + 0x4]
0069323b : MOV dword ptr [ESP + 0x20],EAX
0069323f : MOV dword ptr [ESP + 0x24],ECX
00693243 : MOV dword ptr [ESP + 0x28],ESI
00693247 : CMP EDX,EDI
00693249 : JBE 0x0069325e
0069324b : PUSH 0x8
0069324d : PUSH EBP
0069324e : CALL 0x00686490
00693253 : MOV ECX,dword ptr [ESP + 0x2c]
00693257 : MOV EAX,dword ptr [ESP + 0x28]
0069325b : ADD ESP,0x8
0069325e : XOR EDX,EDX
00693260 : MOV dword ptr [ESP + 0x24],EDX
00693264 : MOV dword ptr [ESP + 0x20],EDX
00693268 : CMP ESI,EDX
0069326a : JBE 0x0069345a
00693270 : MOV EDX,dword ptr [ESP + 0x1c]
00693274 : MOVZX ESI,byte ptr [EBX + 0x4]
00693278 : MOVZX EDI,byte ptr [EAX + 0x4]
0069327c : ADD EBX,0x4
0069327f : MOVZX EBP,byte ptr [EBX + 0x4]
00693283 : ADD EAX,0x4
00693286 : SHL ESI,0x8
00693289 : OR ESI,EDI
0069328b : MOVZX EDI,byte ptr [ECX + 0x4]
0069328f : ADD ECX,0x4
00693292 : ADD EDX,0x4
00693295 : SHL ESI,0x8
00693298 : OR ESI,EDI
0069329a : MOVZX EDI,byte ptr [EDX]
0069329d : ADD EBX,0x4
006932a0 : SHL ESI,0x8
006932a3 : OR ESI,EDI
006932a5 : MOVZX EDI,byte ptr [EAX + 0x4]
006932a9 : ADD EAX,0x4
006932ac : SHL EBP,0x8
006932af : OR EBP,EDI
006932b1 : MOVZX EDI,byte ptr [ECX + 0x4]
006932b5 : ADD ECX,0x4
006932b8 : ADD EDX,0x4
006932bb : SHL EBP,0x8
006932be : OR EBP,EDI
006932c0 : MOVZX EDI,byte ptr [EDX]
006932c3 : ADD EDX,0x4
006932c6 : SHL EBP,0x8
006932c9 : OR EBP,EDI
006932cb : MOVZX EDI,byte ptr [EBX + 0x4]
006932cf : ADD EBX,0x4
006932d2 : ADD EAX,0x4
006932d5 : MOV dword ptr [ESP + 0x18],EDX
006932d9 : MOVZX EDX,byte ptr [EAX]
006932dc : SHL EDI,0x8
006932df : OR EDI,EDX
006932e1 : MOVZX EDX,byte ptr [ECX + 0x4]
006932e5 : ADD ECX,0x4
006932e8 : SHL EDI,0x8
006932eb : OR EDI,EDX
006932ed : MOV EDX,dword ptr [ESP + 0x18]
006932f1 : MOVZX EDX,byte ptr [EDX]
006932f4 : SHL EDI,0x8
006932f7 : OR EDI,EDX
006932f9 : MOV dword ptr [ESP + 0x1c],EBX
006932fd : MOV dword ptr [ESP + 0x10],EAX
00693301 : MOV dword ptr [ESP + 0x14],ECX
00693305 : CMP ESI,EBP
00693307 : JBE 0x00693320
00693309 : MOV EAX,dword ptr [ESP + 0x34]
0069330d : PUSH 0x8
0069330f : PUSH EAX
00693310 : CALL 0x00686490
00693315 : MOV EAX,dword ptr [ESP + 0x18]
00693319 : MOV ECX,dword ptr [ESP + 0x1c]
0069331d : ADD ESP,0x8
00693320 : CMP dword ptr [ESP + 0x20],0x0
00693325 : JBE 0x00693344
00693327 : CMP ESI,dword ptr [ESP + 0x24]
0069332b : JA 0x00693344
0069332d : MOV ECX,dword ptr [ESP + 0x34]
00693331 : PUSH 0x8
00693333 : PUSH ECX
00693334 : CALL 0x00686490
00693339 : MOV EAX,dword ptr [ESP + 0x18]
0069333d : MOV ECX,dword ptr [ESP + 0x1c]
00693341 : ADD ESP,0x8
00693344 : MOV EDX,dword ptr [ESP + 0x34]
00693348 : MOV EDX,dword ptr [EDX + 0x8]
0069334b : CMP EDX,0x1
0069334e : JL 0x0069343f
00693354 : MOV EAX,dword ptr [ESP + 0x34]
00693358 : SUB EDI,ESI
0069335a : ADD EDI,EBP
0069335c : CMP EDI,dword ptr [EAX + 0x50]
0069335f : JC 0x0069336c
00693361 : PUSH 0x10
00693363 : PUSH EAX
00693364 : CALL 0x00686490
00693369 : ADD ESP,0x8
0069336c : MOV EBX,EBP
0069336e : SUB EBX,ESI
00693370 : INC EBX
00693371 : TEST ESI,0xffff0000
00693377 : JZ 0x006933e5
00693379 : TEST EBX,EBX
0069337b : JBE 0x00693433
00693381 : MOV EAX,ESI
00693383 : SHR EAX,0x10
00693386 : MOV ECX,EAX
00693388 : AND ECX,0x7
0069338b : MOV EDX,0x80
00693390 : SAR EDX,CL
00693392 : MOV ECX,dword ptr [ESP + 0x30]
00693396 : SHR EAX,0x3
00693399 : MOV AL,byte ptr [EAX + ECX*0x1 + 0xc]
0069339d : MOVZX EDI,SI
006933a0 : TEST AL,DL
006933a2 : JNZ 0x006933b3
006933a4 : MOV ECX,dword ptr [ESP + 0x34]
006933a8 : PUSH 0x8
006933aa : PUSH ECX
006933ab : CALL 0x00686490
006933b0 : ADD ESP,0x8
006933b3 : MOV EAX,dword ptr [ESP + 0x30]
006933b7 : MOV ECX,EDI
006933b9 : AND ECX,0x7
006933bc : MOV EDX,0x80
006933c1 : SAR EDX,CL
006933c3 : SHR EDI,0x3
006933c6 : MOV CL,byte ptr [EDI + EAX*0x1 + 0xc]
006933ca : TEST CL,DL
006933cc : JNZ 0x006933dd
006933ce : MOV EDX,dword ptr [ESP + 0x34]
006933d2 : PUSH 0x8
006933d4 : PUSH EDX
006933d5 : CALL 0x00686490
006933da : ADD ESP,0x8
006933dd : DEC EBX
006933de : INC ESI
006933df : TEST EBX,EBX
006933e1 : JA 0x00693381
006933e3 : JMP 0x00693433
006933e5 : TEST EBP,0xffff0000
006933eb : JZ 0x006933fc
006933ed : MOV EAX,dword ptr [ESP + 0x34]
006933f1 : PUSH 0x8
006933f3 : PUSH EAX
006933f4 : CALL 0x00686490
006933f9 : ADD ESP,0x8
006933fc : TEST EBX,EBX
006933fe : JBE 0x00693433
00693400 : MOVZX EAX,SI
00693403 : MOV ECX,EAX
00693405 : AND ECX,0x7
00693408 : MOV EDX,0x80
0069340d : SAR EDX,CL
0069340f : MOV ECX,dword ptr [ESP + 0x30]
00693413 : SHR EAX,0x3
00693416 : MOV AL,byte ptr [EAX + ECX*0x1 + 0xc]
0069341a : TEST AL,DL
0069341c : JZ 0x0069342d
0069341e : MOV ECX,dword ptr [ESP + 0x34]
00693422 : PUSH 0x8
00693424 : PUSH ECX
00693425 : CALL 0x00686490
0069342a : ADD ESP,0x8
0069342d : DEC EBX
0069342e : INC ESI
0069342f : TEST EBX,EBX
00693431 : JA 0x00693400
00693433 : MOV EBX,dword ptr [ESP + 0x1c]
00693437 : MOV EAX,dword ptr [ESP + 0x10]
0069343b : MOV ECX,dword ptr [ESP + 0x14]
0069343f : MOV ESI,dword ptr [ESP + 0x20]
00693443 : MOV EDX,dword ptr [ESP + 0x18]
00693447 : INC ESI
00693448 : MOV dword ptr [ESP + 0x24],EBP
0069344c : MOV dword ptr [ESP + 0x20],ESI
00693450 : CMP ESI,dword ptr [ESP + 0x28]
00693454 : JC 0x00693274
0069345a : POP EDI
0069345b : POP ESI
0069345c : POP EBP
0069345d : XOR EAX,EAX
0069345f : POP EBX
00693460 : ADD ESP,0x1c
00693463 : RET

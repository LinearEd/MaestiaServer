PROGRAM  : Maestia.exe
FUNCTION : FUN_0082ec10
ENTRY    : 0082ec10
BODY     : [[0082ec10, 0082eea9]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0082ec10(void)

{
  uint uVar1;
  short *psVar2;
  int iVar3;
  undefined4 uVar4;
  int in_ECX;
  int iVar5;
  undefined1 auStack_64 [4];
  ushort *local_60;
  uint local_5c;
  int local_58;
  undefined1 auStack_54 [28];
  undefined1 local_38 [4];
  undefined4 *****apppppuStack_34 [5];
  uint uStack_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  int local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b3d93f;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_64;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xffffff90;
  ExceptionList = &local_14;
  local_5c = *(uint *)(*(int *)(in_ECX + 0xf0) + 0x24);
  if (local_5c < (uint)((*(int *)(in_ECX + 0x100) - *(int *)(in_ECX + 0xfc)) / 0x1c)) {
    local_58 = local_5c * 0x1c;
    iVar5 = local_58 + *(int *)(in_ECX + 0xfc);
    if (*(uint *)(iVar5 + 0x18) < 8) {
      psVar2 = (short *)(iVar5 + 4);
    }
    else {
      psVar2 = *(short **)(iVar5 + 4);
    }
    if (*psVar2 != 0x23) {
      if (*(uint *)(iVar5 + 0x18) < 8) {
        psVar2 = (short *)(iVar5 + 4);
      }
      else {
        psVar2 = *(short **)(iVar5 + 4);
      }
      if (*psVar2 != 0) {
        iVar3 = FUN_0082d6b0(local_5c);
        if (iVar3 < 0) {
          if (*(int *)(in_ECX + 0xcc) != 0) {
            if (*(uint *)(iVar5 + 0x18) < 8) {
              iVar5 = iVar5 + 4;
            }
            else {
              iVar5 = *(int *)(iVar5 + 4);
            }
            iVar3 = *(int *)(in_ECX + 0xf0);
            if (*(uint *)(iVar3 + 0x1c) < 8) {
              iVar3 = iVar3 + 8;
            }
            else {
              iVar3 = *(int *)(iVar3 + 8);
            }
            FUN_00404750(L"%s#%d: %s\n",iVar3,local_5c + 1,iVar5,uVar1);
            local_c = 0;
            (**(code **)(**(int **)(*DAT_00da9894 + 0x1a8) + 0x44))(local_38,5);
            uVar4 = FUN_00403380(auStack_54,local_38);
            local_c._0_1_ = 1;
            FUN_00405eb0(uVar4,0,0xffffffff);
            local_c = (uint)local_c._1_3_ << 8;
            FUN_00406560();
            if (uStack_20 < 8) {
              apppppuStack_34[0] = apppppuStack_34;
            }
            FUN_0082d5c0(apppppuStack_34[0]);
            local_c = 0xffffffff;
            FUN_00406560();
          }
          iVar5 = FUN_00839b90(*(int *)(in_ECX + 0xfc) + local_58,&local_60);
          if (iVar5 == 0) {
            *(undefined4 *)(in_ECX + 0xc4) = 1;
          }
          else {
            if (((local_60 != (ushort *)0x0) && (*(int *)(DAT_017247d4 + 4) != 0)) &&
               (*(char *)(DAT_017247d4 + 8) != '\0')) {
              FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),*local_60 & 0x1fff,(uint8_t *)local_60);
            }
            iVar5 = *(int *)(in_ECX + 0xf0);
            if (*(uint *)(iVar5 + 0x24) == local_5c) {
              *(int *)(iVar5 + 0x20) = *(int *)(iVar5 + 0x24);
              *(int *)(iVar5 + 0x24) = *(int *)(iVar5 + 0x24) + 1;
            }
          }
          if (*(int *)(in_ECX + 0xc4) == 0) {
            if (*(HANDLE *)(in_ECX + 0x70) != (HANDLE)0x0) {
              ResetEvent(*(HANDLE *)(in_ECX + 0x70));
            }
            Sleep(10);
          }
        }
        else {
          iVar5 = *(int *)(in_ECX + 0x10c) + iVar3 * 0x3c;
          FUN_0082e190(*(undefined4 *)(iVar5 + 4),*(undefined4 *)(iVar5 + 8),
                       *(undefined4 *)(*(int *)(in_ECX + 0x10c) + 0xc + iVar3 * 0x3c));
        }
        goto LAB_0082ee8c;
      }
    }
    iVar5 = *(int *)(in_ECX + 0xf0);
    *(undefined4 *)(iVar5 + 0x20) = *(undefined4 *)(iVar5 + 0x24);
    *(uint *)(iVar5 + 0x24) = local_5c + 1;
  }
LAB_0082ee8c:
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_64);
  return;
}



============================================================
DISASSEMBLY
============================================================
0082ec10 : PUSH EBP
0082ec11 : MOV EBP,ESP
0082ec13 : AND ESP,0xfffffff8
0082ec16 : PUSH -0x1
0082ec18 : PUSH 0xb3d93f
0082ec1d : MOV EAX,FS:[0x0]
0082ec23 : PUSH EAX
0082ec24 : SUB ESP,0x50
0082ec27 : MOV EAX,[0x00d66fa0]
0082ec2c : XOR EAX,ESP
0082ec2e : MOV dword ptr [ESP + 0x48],EAX
0082ec32 : PUSH EBX
0082ec33 : PUSH ESI
0082ec34 : PUSH EDI
0082ec35 : MOV EAX,[0x00d66fa0]
0082ec3a : XOR EAX,ESP
0082ec3c : PUSH EAX
0082ec3d : LEA EAX,[ESP + 0x60]
0082ec41 : MOV FS:[0x0],EAX
0082ec47 : MOV EBX,ECX
0082ec49 : MOV EAX,dword ptr [EBX + 0xf0]
0082ec4f : MOV ESI,dword ptr [EAX + 0x24]
0082ec52 : MOV ECX,dword ptr [EBX + 0x100]
0082ec58 : SUB ECX,dword ptr [EBX + 0xfc]
0082ec5e : MOV EAX,0x92492493
0082ec63 : IMUL ECX
0082ec65 : ADD EDX,ECX
0082ec67 : SAR EDX,0x4
0082ec6a : MOV EAX,EDX
0082ec6c : SHR EAX,0x1f
0082ec6f : ADD EAX,EDX
0082ec71 : MOV dword ptr [ESP + 0x18],ESI
0082ec75 : CMP ESI,EAX
0082ec77 : JC 0x0082ec80
0082ec79 : XOR EAX,EAX
0082ec7b : JMP 0x0082ee8c
0082ec80 : MOV ECX,dword ptr [EBX + 0xfc]
0082ec86 : LEA EDI,[ESI*0x8 + 0x0]
0082ec8d : SUB EDI,ESI
0082ec8f : ADD EDI,EDI
0082ec91 : ADD EDI,EDI
0082ec93 : MOV dword ptr [ESP + 0x1c],EDI
0082ec97 : ADD EDI,ECX
0082ec99 : MOV ECX,0x8
0082ec9e : CMP dword ptr [EDI + 0x18],ECX
0082eca1 : JC 0x0082eca8
0082eca3 : MOV EAX,dword ptr [EDI + 0x4]
0082eca6 : JMP 0x0082ecab
0082eca8 : LEA EAX,[EDI + 0x4]
0082ecab : CMP word ptr [EAX],0x23
0082ecaf : JZ 0x0082ee77
0082ecb5 : CMP dword ptr [EDI + 0x18],ECX
0082ecb8 : JC 0x0082ecbf
0082ecba : MOV EAX,dword ptr [EDI + 0x4]
0082ecbd : JMP 0x0082ecc2
0082ecbf : LEA EAX,[EDI + 0x4]
0082ecc2 : CMP word ptr [EAX],0x0
0082ecc6 : JZ 0x0082ee77
0082eccc : PUSH ESI
0082eccd : MOV ESI,EBX
0082eccf : CALL 0x0082d6b0
0082ecd4 : TEST EAX,EAX
0082ecd6 : JL 0x0082ed01
0082ecd8 : MOV EDX,EAX
0082ecda : SHL EDX,0x4
0082ecdd : SUB EDX,EAX
0082ecdf : MOV EAX,dword ptr [EBX + 0x10c]
0082ece5 : MOV ECX,dword ptr [EAX + EDX*0x4 + 0xc]
0082ece9 : LEA EAX,[EAX + EDX*0x4]
0082ecec : MOV EDX,dword ptr [EAX + 0x8]
0082ecef : MOV EAX,dword ptr [EAX + 0x4]
0082ecf2 : PUSH ECX
0082ecf3 : PUSH EDX
0082ecf4 : PUSH EAX
0082ecf5 : MOV EDI,EBX
0082ecf7 : CALL 0x0082e190
0082ecfc : JMP 0x0082ee8c
0082ed01 : CMP dword ptr [EBX + 0xcc],0x0
0082ed08 : JZ 0x0082edcd
0082ed0e : MOV ECX,0x8
0082ed13 : CMP dword ptr [EDI + 0x18],ECX
0082ed16 : JC 0x0082ed1d
0082ed18 : MOV EDI,dword ptr [EDI + 0x4]
0082ed1b : JMP 0x0082ed20
0082ed1d : ADD EDI,0x4
0082ed20 : MOV EAX,dword ptr [EBX + 0xf0]
0082ed26 : CMP dword ptr [EAX + 0x1c],ECX
0082ed29 : JC 0x0082ed30
0082ed2b : MOV EAX,dword ptr [EAX + 0x8]
0082ed2e : JMP 0x0082ed33
0082ed30 : ADD EAX,0x8
0082ed33 : MOV ECX,dword ptr [ESP + 0x18]
0082ed37 : PUSH EDI
0082ed38 : INC ECX
0082ed39 : PUSH ECX
0082ed3a : PUSH EAX
0082ed3b : PUSH 0xc35794
0082ed40 : LEA ESI,[ESP + 0x4c]
0082ed44 : CALL 0x00404750
0082ed49 : ADD ESP,0x10
0082ed4c : MOV dword ptr [ESP + 0x68],0x0
0082ed54 : MOV EDX,dword ptr [0x00da9894]
0082ed5a : MOV EAX,dword ptr [EDX]
0082ed5c : MOV ECX,dword ptr [EAX + 0x1a8]
0082ed62 : MOV EAX,dword ptr [ECX]
0082ed64 : MOV EAX,dword ptr [EAX + 0x44]
0082ed67 : PUSH 0x5
0082ed69 : MOV EDX,ESI
0082ed6b : PUSH EDX
0082ed6c : CALL EAX
0082ed6e : MOV ECX,ESI
0082ed70 : PUSH ECX
0082ed71 : LEA EDX,[ESP + 0x24]
0082ed75 : PUSH EDX
0082ed76 : MOV EDX,0xc357ac
0082ed7b : CALL 0x00403380
0082ed80 : ADD ESP,0x8
0082ed83 : MOV byte ptr [ESP + 0x68],0x1
0082ed88 : PUSH -0x1
0082ed8a : PUSH 0x0
0082ed8c : PUSH EAX
0082ed8d : MOV ECX,ESI
0082ed8f : CALL 0x00405eb0
0082ed94 : MOV byte ptr [ESP + 0x68],0x0
0082ed99 : LEA ECX,[ESP + 0x20]
0082ed9d : CALL 0x00406560
0082eda2 : CMP dword ptr [ESP + 0x54],0x8
0082eda7 : MOV EAX,dword ptr [ESP + 0x40]
0082edab : JNC 0x0082edb1
0082edad : LEA EAX,[ESP + 0x40]
0082edb1 : PUSH EAX
0082edb2 : MOV ESI,EBX
0082edb4 : CALL 0x0082d5c0
0082edb9 : ADD ESP,0x4
0082edbc : MOV dword ptr [ESP + 0x68],0xffffffff
0082edc4 : LEA ECX,[ESP + 0x3c]
0082edc8 : CALL 0x00406560
0082edcd : MOV EAX,dword ptr [EBX + 0xfc]
0082edd3 : ADD EAX,dword ptr [ESP + 0x1c]
0082edd7 : LEA ECX,[ESP + 0x14]
0082eddb : PUSH ECX
0082eddc : PUSH EAX
0082eddd : MOV ECX,EBX
0082eddf : CALL 0x00839b90
0082ede4 : TEST EAX,EAX
0082ede6 : JZ 0x0082ee2e
0082ede8 : MOV EDI,dword ptr [ESP + 0x14]
0082edec : TEST EDI,EDI
0082edee : JZ 0x0082ee13
0082edf0 : MOV ECX,dword ptr [0x017247d4]
0082edf6 : MOV EAX,dword ptr [ECX + 0x4]
0082edf9 : TEST EAX,EAX
0082edfb : JZ 0x0082ee13
0082edfd : CMP byte ptr [ECX + 0x8],0x0
0082ee01 : JZ 0x0082ee13
0082ee03 : MOVZX EDX,word ptr [EDI]
0082ee06 : AND EDX,0x1fff
0082ee0c : PUSH EDX
0082ee0d : PUSH EAX
0082ee0e : CALL 0x00a0dd40
0082ee13 : MOV EAX,dword ptr [EBX + 0xf0]
0082ee19 : MOV ECX,dword ptr [ESP + 0x18]
0082ee1d : CMP dword ptr [EAX + 0x24],ECX
0082ee20 : JNZ 0x0082ee38
0082ee22 : MOV ECX,dword ptr [EAX + 0x24]
0082ee25 : MOV dword ptr [EAX + 0x20],ECX
0082ee28 : INC ECX
0082ee29 : MOV dword ptr [EAX + 0x24],ECX
0082ee2c : JMP 0x0082ee38
0082ee2e : MOV dword ptr [EBX + 0xc4],0x1
0082ee38 : CMP dword ptr [EBX + 0xc4],0x0
0082ee3f : JNZ 0x0082ec79
0082ee45 : MOV EAX,dword ptr [EBX + 0x70]
0082ee48 : TEST EAX,EAX
0082ee4a : JZ 0x0082ee53
0082ee4c : PUSH EAX
0082ee4d : CALL dword ptr [0x00b851dc]
0082ee53 : PUSH 0xa
0082ee55 : CALL dword ptr [0x00b8510c]
0082ee5b : CMP dword ptr [EBX + 0xc4],0x0
0082ee62 : JNZ 0x0082ec79
0082ee68 : CMP dword ptr [EBX + 0xc8],0x0
0082ee6f : JNZ 0x0082ec79
0082ee75 : JMP 0x0082ee87
0082ee77 : MOV EAX,dword ptr [EBX + 0xf0]
0082ee7d : MOV EDX,dword ptr [EAX + 0x24]
0082ee80 : INC ESI
0082ee81 : MOV dword ptr [EAX + 0x20],EDX
0082ee84 : MOV dword ptr [EAX + 0x24],ESI
0082ee87 : MOV EAX,0x1
0082ee8c : MOV ECX,dword ptr [ESP + 0x60]
0082ee90 : MOV dword ptr FS:[0x0],ECX
0082ee97 : POP ECX
0082ee98 : POP EDI
0082ee99 : POP ESI
0082ee9a : POP EBX
0082ee9b : MOV ECX,dword ptr [ESP + 0x48]
0082ee9f : XOR ECX,ESP
0082eea1 : CALL 0x00633e6b
0082eea6 : MOV ESP,EBP
0082eea8 : POP EBP
0082eea9 : RET

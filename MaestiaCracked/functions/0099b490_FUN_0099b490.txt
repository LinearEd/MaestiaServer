PROGRAM  : Maestia.exe
FUNCTION : FUN_0099b490
ENTRY    : 0099b490
BODY     : [[0099b490, 0099b509] [0099b510, 0099b658]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0099b490(int *param_1)

{
  short sVar1;
  int iVar2;
  int *piVar3;
  char cVar4;
  undefined4 *puVar5;
  short *psVar6;
  undefined4 *puVar7;
  int in_ECX;
  undefined4 uVar8;
  undefined1 local_24 [8];
  undefined4 local_1c;
  undefined4 *local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b60b70;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_18 = (undefined4 *)
             FUN_006f0760(0x68,"",0,(DAT_01725270 >> 3 & 1) == 0,
                          DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
  local_8 = 0;
  if (local_18 == (undefined4 *)0x0) {
    puVar5 = (undefined4 *)0x0;
  }
  else {
    puVar5 = (undefined4 *)FUN_00412470(local_18);
  }
  local_8 = 0xffffffff;
  puVar5[4] = 0;
  psVar6 = (short *)(in_ECX + 0x13);
  do {
    sVar1 = *psVar6;
    psVar6 = psVar6 + 1;
  } while (sVar1 != 0);
  FUN_00406360((short *)(in_ECX + 0x13),(int)psVar6 - (in_ECX + 0x15) >> 1);
  *puVar5 = *(undefined4 *)(in_ECX + 4);
  puVar5[3] = (uint)*(ushort *)(in_ECX + 0xf);
  *(undefined1 *)((int)puVar5 + 10) = *(undefined1 *)(in_ECX + 8);
  puVar5[1] = *(undefined4 *)(in_ECX + 9);
  *(undefined2 *)(puVar5 + 2) = *(undefined2 *)(in_ECX + 0xd);
  *(ushort *)(puVar5 + 6) = (ushort)*(byte *)(in_ECX + 0x11);
  cVar4 = *(char *)(in_ECX + 0x12);
  *(char *)(puVar5 + 0x18) = cVar4;
  if (cVar4 == '\0') {
    if ((uint)puVar5[0x10] < 8) {
      puVar7 = puVar5 + 0xb;
    }
    else {
      puVar7 = (undefined4 *)puVar5[0xb];
    }
    uVar8 = *(undefined4 *)(*DAT_00da9894 + 0x1a8);
  }
  else if (cVar4 == '\x01') {
    if ((uint)puVar5[0x10] < 8) {
      puVar7 = puVar5 + 0xb;
    }
    else {
      puVar7 = (undefined4 *)puVar5[0xb];
    }
    uVar8 = *(undefined4 *)(*DAT_00da9894 + 0x1a8);
  }
  else {
    if ((uint)puVar5[0x10] < 8) {
      puVar7 = puVar5 + 0xb;
    }
    else {
      puVar7 = (undefined4 *)puVar5[0xb];
    }
    uVar8 = *(undefined4 *)(*DAT_00da9894 + 0x1a8);
  }
  FUN_009adfc0(uVar8,0x13,puVar7);
  piVar3 = param_1;
  if (*(short *)(in_ECX + 0xf) != -1) {
    puVar5[5] = 1;
  }
  cVar4 = FUN_0099bb60(puVar5 + 10);
  if (cVar4 == '\x01') {
    FUN_0099be20(*piVar3,*puVar5);
  }
  param_1 = (int *)*puVar5;
  iVar2 = *piVar3;
  FUN_004437f0(&param_1);
  if (local_18 == *(undefined4 **)(iVar2 + 4)) {
    local_1c = param_1;
    local_18 = puVar5;
    FUN_00451e00(local_24,&local_1c);
  }
  FUN_0099aee0();
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
0099b490 : PUSH EBP
0099b491 : MOV EBP,ESP
0099b493 : PUSH -0x1
0099b495 : PUSH 0xb60b70
0099b49a : MOV EAX,FS:[0x0]
0099b4a0 : PUSH EAX
0099b4a1 : SUB ESP,0x18
0099b4a4 : PUSH EBX
0099b4a5 : PUSH ESI
0099b4a6 : PUSH EDI
0099b4a7 : MOV EAX,[0x00d66fa0]
0099b4ac : XOR EAX,EBP
0099b4ae : PUSH EAX
0099b4af : LEA EAX,[EBP + -0xc]
0099b4b2 : MOV FS:[0x0],EAX
0099b4b8 : MOV EDI,ECX
0099b4ba : MOV EAX,[0x01725270]
0099b4bf : SHR EAX,0x3
0099b4c2 : MOV ECX,0x0
0099b4c7 : AND EAX,0x1
0099b4ca : SETZ CL
0099b4cd : XOR EBX,EBX
0099b4cf : PUSH ECX
0099b4d0 : PUSH EBX
0099b4d1 : PUSH 0xbf1a4a
0099b4d6 : PUSH 0x68
0099b4d8 : CALL 0x006f0760
0099b4dd : ADD ESP,0x10
0099b4e0 : MOV dword ptr [EBP + -0x14],EAX
0099b4e3 : MOV dword ptr [EBP + -0x4],EBX
0099b4e6 : CMP EAX,EBX
0099b4e8 : JZ 0x0099b4f4
0099b4ea : PUSH EAX
0099b4eb : CALL 0x00412470
0099b4f0 : MOV ESI,EAX
0099b4f2 : JMP 0x0099b4f6
0099b4f4 : XOR ESI,ESI
0099b4f6 : MOV dword ptr [EBP + -0x4],0xffffffff
0099b4fd : LEA ECX,[EDI + 0x13]
0099b500 : MOV EAX,ECX
0099b502 : MOV dword ptr [ESI + 0x10],EBX
0099b505 : LEA EBX,[EAX + 0x2]
0099b508 : JMP 0x0099b510
0099b510 : MOV DX,word ptr [EAX]
0099b513 : ADD EAX,0x2
0099b516 : TEST DX,DX
0099b519 : JNZ 0x0099b510
0099b51b : SUB EAX,EBX
0099b51d : SAR EAX,0x1
0099b51f : PUSH EAX
0099b520 : LEA EBX,[ESI + 0x28]
0099b523 : PUSH ECX
0099b524 : MOV ECX,EBX
0099b526 : CALL 0x00406360
0099b52b : MOV EDX,dword ptr [EDI + 0x4]
0099b52e : MOV dword ptr [ESI],EDX
0099b530 : MOVZX EAX,word ptr [EDI + 0xf]
0099b534 : MOV dword ptr [ESI + 0xc],EAX
0099b537 : MOV CL,byte ptr [EDI + 0x8]
0099b53a : MOV byte ptr [ESI + 0xa],CL
0099b53d : MOV EDX,dword ptr [EDI + 0x9]
0099b540 : MOV dword ptr [ESI + 0x4],EDX
0099b543 : MOV AX,word ptr [EDI + 0xd]
0099b547 : MOV word ptr [ESI + 0x8],AX
0099b54b : MOVZX CX,byte ptr [EDI + 0x11]
0099b550 : MOV word ptr [ESI + 0x18],CX
0099b554 : MOV AL,byte ptr [EDI + 0x12]
0099b557 : MOV byte ptr [ESI + 0x60],AL
0099b55a : TEST AL,AL
0099b55c : JNZ 0x0099b585
0099b55e : CMP dword ptr [EBX + 0x18],0x8
0099b562 : JC 0x0099b569
0099b564 : MOV EAX,dword ptr [EBX + 0x4]
0099b567 : JMP 0x0099b56c
0099b569 : LEA EAX,[EBX + 0x4]
0099b56c : MOV EDX,dword ptr [0x00da9894]
0099b572 : PUSH EAX
0099b573 : MOV EAX,dword ptr [EDX]
0099b575 : MOV ECX,dword ptr [EAX + 0x1a8]
0099b57b : PUSH 0x13
0099b57d : PUSH ECX
0099b57e : MOV ECX,0xc87ba4
0099b583 : JMP 0x0099b5d5
0099b585 : CMP AL,0x1
0099b587 : JNZ 0x0099b5b0
0099b589 : CMP dword ptr [EBX + 0x18],0x8
0099b58d : JC 0x0099b594
0099b58f : MOV EAX,dword ptr [EBX + 0x4]
0099b592 : JMP 0x0099b597
0099b594 : LEA EAX,[EBX + 0x4]
0099b597 : MOV EDX,dword ptr [0x00da9894]
0099b59d : PUSH EAX
0099b59e : MOV EAX,dword ptr [EDX]
0099b5a0 : MOV ECX,dword ptr [EAX + 0x1a8]
0099b5a6 : PUSH 0x13
0099b5a8 : PUSH ECX
0099b5a9 : MOV ECX,0xc87bcc
0099b5ae : JMP 0x0099b5d5
0099b5b0 : CMP dword ptr [EBX + 0x18],0x8
0099b5b4 : JC 0x0099b5bb
0099b5b6 : MOV EAX,dword ptr [EBX + 0x4]
0099b5b9 : JMP 0x0099b5be
0099b5bb : LEA EAX,[EBX + 0x4]
0099b5be : MOV EDX,dword ptr [0x00da9894]
0099b5c4 : PUSH EAX
0099b5c5 : MOV EAX,dword ptr [EDX]
0099b5c7 : MOV ECX,dword ptr [EAX + 0x1a8]
0099b5cd : PUSH 0x13
0099b5cf : PUSH ECX
0099b5d0 : MOV ECX,0xc87c00
0099b5d5 : CALL 0x009adfc0
0099b5da : MOV EDX,0xffff
0099b5df : ADD ESP,0xc
0099b5e2 : CMP word ptr [EDI + 0xf],DX
0099b5e6 : JZ 0x0099b5ef
0099b5e8 : MOV dword ptr [ESI + 0x14],0x1
0099b5ef : MOV EDI,dword ptr [EBP + 0x8]
0099b5f2 : MOV EAX,dword ptr [EDI]
0099b5f4 : PUSH EBX
0099b5f5 : CALL 0x0099bb60
0099b5fa : CMP AL,0x1
0099b5fc : JNZ 0x0099b609
0099b5fe : MOV EAX,dword ptr [ESI]
0099b600 : MOV ECX,dword ptr [EDI]
0099b602 : PUSH EAX
0099b603 : PUSH ECX
0099b604 : CALL 0x0099be20
0099b609 : MOV EDX,dword ptr [ESI]
0099b60b : MOV EBX,dword ptr [EDI]
0099b60d : LEA EAX,[EBP + 0x8]
0099b610 : PUSH EAX
0099b611 : LEA EAX,[EBP + -0x14]
0099b614 : MOV ECX,EBX
0099b616 : MOV dword ptr [EBP + 0x8],EDX
0099b619 : CALL 0x004437f0
0099b61e : MOV ECX,dword ptr [EBP + -0x14]
0099b621 : CMP ECX,dword ptr [EBX + 0x4]
0099b624 : JNZ 0x0099b63e
0099b626 : MOV EDX,dword ptr [EBP + 0x8]
0099b629 : LEA EAX,[EBP + -0x18]
0099b62c : PUSH EAX
0099b62d : LEA ECX,[EBP + -0x20]
0099b630 : PUSH ECX
0099b631 : MOV EAX,EBX
0099b633 : MOV dword ptr [EBP + -0x18],EDX
0099b636 : MOV dword ptr [EBP + -0x14],ESI
0099b639 : CALL 0x00451e00
0099b63e : XOR ECX,ECX
0099b640 : CALL 0x0099aee0
0099b645 : MOV ECX,dword ptr [EBP + -0xc]
0099b648 : MOV dword ptr FS:[0x0],ECX
0099b64f : POP ECX
0099b650 : POP EDI
0099b651 : POP ESI
0099b652 : POP EBX
0099b653 : MOV ESP,EBP
0099b655 : POP EBP
0099b656 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_008fdaf0
ENTRY    : 008fdaf0
BODY     : [[008fdaf0, 008fdcf6]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008fdaf0(uint param_1,ushort *param_2)

{
  undefined1 *puVar1;
  int *piVar2;
  bool bVar3;
  int iVar4;
  undefined4 uVar5;
  uint uVar6;
  ushort *puVar7;
  ushort local_128;
  int local_118;
  ushort *local_114;
  undefined1 local_10e;
  undefined1 local_10d;
  char local_10c [260];
  uint local_8;
  
  local_8 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  uVar6 = (*param_2 & 0x1fff) - 8;
  puVar7 = param_2 + 4;
  if (*(char *)((int)param_2 + 7) != '\0') {
    local_118 = 1;
    do {
      if ((((puVar7 == (ushort *)0x0) || (uVar6 < 2)) || ((short)*puVar7 < 0)) ||
         (iVar4 = (int)(short)*puVar7, (int)uVar6 < iVar4 + 2)) {
        local_114 = (ushort *)0x0;
LAB_008fdbe0:
        uVar6 = 0;
        puVar7 = (ushort *)0x0;
      }
      else {
        local_114 = puVar7 + 1;
        puVar1 = (undefined1 *)((int)puVar7 + iVar4 + 2);
        iVar4 = uVar6 + (-2 - iVar4);
        if ((puVar1 == (undefined1 *)0x0) || (iVar4 == 0)) goto LAB_008fdbe0;
        local_10d = *puVar1;
        if ((puVar1 + 1 == (undefined1 *)0x0) || (iVar4 == 1)) goto LAB_008fdbe0;
        local_10e = puVar1[1];
        if (((uint *)(puVar1 + 2) == (uint *)0x0) || (iVar4 - 2U < 4)) goto LAB_008fdbe0;
        param_1 = *(uint *)(puVar1 + 2);
        if (((ushort *)(puVar1 + 6) == (ushort *)0x0) || (iVar4 - 6U < 2)) goto LAB_008fdbe0;
        local_128 = *(ushort *)(puVar1 + 6);
        if ((puVar1 == (undefined1 *)0xfffffff8) || (iVar4 - 8U < 8)) goto LAB_008fdbe0;
        uVar6 = iVar4 - 0x10;
        puVar7 = (ushort *)(puVar1 + 0x10);
      }
      uVar5 = FUN_008fd6d0();
      __snprintf(local_10c,0x100,"%02d:%02d:%02d (%.f%%)",param_1 / 0xe10,(param_1 / 0x3c) % 0x3c,
                 param_1 % 0x3c,(double)((float)local_128 * 0.01));
      if ((*DAT_00da9894 != 0) && (piVar2 = *(int **)(*DAT_00da9894 + 0x114), piVar2 != (int *)0x0))
      {
        (**(code **)(*piVar2 + 4))
                  (piVar2,"mc_timeattacksuccess.AddRank","%d,%d,%ls,%d,%d,%s,%d",local_118,local_118
                   ,local_114,local_10d,local_10e,local_10c,uVar5);
      }
      bVar3 = local_118 < (int)(uint)*(byte *)((int)param_2 + 7);
      local_118 = local_118 + 1;
    } while (bVar3);
  }
  FUN_008fd9d0();
  __security_check_cookie(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008fdaf0 : PUSH EBP
008fdaf1 : MOV EBP,ESP
008fdaf3 : SUB ESP,0x124
008fdaf9 : MOV EAX,[0x00d66fa0]
008fdafe : XOR EAX,EBP
008fdb00 : MOV dword ptr [EBP + -0x4],EAX
008fdb03 : MOV EAX,dword ptr [EBP + 0x8]
008fdb06 : PUSH EBX
008fdb07 : MOV dword ptr [EBP + 0xfffffee4],EAX
008fdb0d : MOV EAX,dword ptr [EBP + 0xc]
008fdb10 : MOVZX EBX,word ptr [EAX]
008fdb13 : AND EBX,0x1fff
008fdb19 : PUSH ESI
008fdb1a : SUB EBX,0x8
008fdb1d : CMP byte ptr [EAX + 0x7],0x0
008fdb21 : PUSH EDI
008fdb22 : MOV dword ptr [EBP + 0xfffffee8],EAX
008fdb28 : LEA ESI,[EAX + 0x8]
008fdb2b : JBE 0x008fdcd9
008fdb31 : MOV EDI,dword ptr [EBP + 0xfffffee4]
008fdb37 : MOV dword ptr [EBP + 0xfffffeec],0x1
008fdb41 : XOR ECX,ECX
008fdb43 : CMP ESI,ECX
008fdb45 : JZ 0x008fdbda
008fdb4b : CMP EBX,0x2
008fdb4e : JC 0x008fdbda
008fdb54 : MOVZX EAX,word ptr [ESI]
008fdb57 : CMP AX,CX
008fdb5a : JL 0x008fdbda
008fdb5c : CWDE
008fdb5d : LEA EDX,[EAX + 0x2]
008fdb60 : CMP EBX,EDX
008fdb62 : JL 0x008fdbda
008fdb64 : LEA EDX,[ESI + 0x2]
008fdb67 : MOV dword ptr [EBP + 0xfffffef0],EDX
008fdb6d : MOV EDX,0xfffffffe
008fdb72 : SUB EDX,EAX
008fdb74 : LEA ESI,[ESI + EAX*0x1 + 0x2]
008fdb78 : ADD EBX,EDX
008fdb7a : CMP ESI,ECX
008fdb7c : JZ 0x008fdbe0
008fdb7e : CMP EBX,0x1
008fdb81 : JC 0x008fdbe0
008fdb83 : MOV AL,byte ptr [ESI]
008fdb85 : INC ESI
008fdb86 : DEC EBX
008fdb87 : MOV byte ptr [EBP + 0xfffffef7],AL
008fdb8d : CMP ESI,ECX
008fdb8f : JZ 0x008fdbe0
008fdb91 : CMP EBX,0x1
008fdb94 : JC 0x008fdbe0
008fdb96 : MOV DL,byte ptr [ESI]
008fdb98 : INC ESI
008fdb99 : DEC EBX
008fdb9a : MOV byte ptr [EBP + 0xfffffef6],DL
008fdba0 : CMP ESI,ECX
008fdba2 : JZ 0x008fdbe0
008fdba4 : CMP EBX,0x4
008fdba7 : JC 0x008fdbe0
008fdba9 : MOV EDI,dword ptr [ESI]
008fdbab : ADD ESI,0x4
008fdbae : SUB EBX,0x4
008fdbb1 : CMP ESI,ECX
008fdbb3 : JZ 0x008fdbe0
008fdbb5 : CMP EBX,0x2
008fdbb8 : JC 0x008fdbe0
008fdbba : MOVZX EAX,word ptr [ESI]
008fdbbd : ADD ESI,0x2
008fdbc0 : SUB EBX,0x2
008fdbc3 : MOV dword ptr [EBP + 0xfffffedc],EAX
008fdbc9 : CMP ESI,ECX
008fdbcb : JZ 0x008fdbe0
008fdbcd : CMP EBX,0x8
008fdbd0 : JC 0x008fdbe0
008fdbd2 : SUB EBX,0x8
008fdbd5 : ADD ESI,0x8
008fdbd8 : JMP 0x008fdbe4
008fdbda : MOV dword ptr [EBP + 0xfffffef0],ECX
008fdbe0 : XOR EBX,EBX
008fdbe2 : XOR ESI,ESI
008fdbe4 : MOV ECX,dword ptr [EBP + 0xfffffee8]
008fdbea : MOV DX,word ptr [ECX + 0x4]
008fdbee : CALL 0x008fd6d0
008fdbf3 : MOV dword ptr [EBP + 0xfffffee0],EAX
008fdbf9 : MOV EAX,0x88888889
008fdbfe : MUL EDI
008fdc00 : MOV EAX,EDX
008fdc02 : MOVZX EDX,word ptr [EBP + 0xfffffedc]
008fdc09 : SHR EAX,0x5
008fdc0c : MOV ECX,EAX
008fdc0e : CVTSI2SS XMM0,EDX
008fdc12 : MULSS XMM0,dword ptr [0x00cdf23c]
008fdc1a : SHL ECX,0x4
008fdc1d : SUB ECX,EAX
008fdc1f : SUB ESP,0x8
008fdc22 : ADD ECX,ECX
008fdc24 : ADD ECX,ECX
008fdc26 : MOV EDX,EDI
008fdc28 : SUB EDX,ECX
008fdc2a : CVTSS2SD XMM0,XMM0
008fdc2e : MOVSD qword ptr [ESP],XMM0
008fdc33 : PUSH EDX
008fdc34 : XOR EDX,EDX
008fdc36 : MOV ECX,0x3c
008fdc3b : DIV ECX
008fdc3d : MOV EAX,0x91a2b3c5
008fdc42 : PUSH EDX
008fdc43 : MUL EDI
008fdc45 : SHR EDX,0xb
008fdc48 : PUSH EDX
008fdc49 : PUSH 0xc62954
008fdc4e : LEA EDX,[EBP + 0xfffffef8]
008fdc54 : PUSH 0x100
008fdc59 : PUSH EDX
008fdc5a : CALL 0x00638607
008fdc5f : MOV EAX,[0x00da9894]
008fdc64 : MOV EAX,dword ptr [EAX]
008fdc66 : ADD ESP,0x20
008fdc69 : TEST EAX,EAX
008fdc6b : JZ 0x008fdcb9
008fdc6d : MOV EAX,dword ptr [EAX + 0x114]
008fdc73 : TEST EAX,EAX
008fdc75 : JZ 0x008fdcb9
008fdc77 : MOV ECX,dword ptr [EBP + 0xfffffee0]
008fdc7d : PUSH ECX
008fdc7e : MOV EDX,dword ptr [EAX]
008fdc80 : MOV EDX,dword ptr [EDX + 0x4]
008fdc83 : LEA ECX,[EBP + 0xfffffef8]
008fdc89 : PUSH ECX
008fdc8a : MOVZX ECX,byte ptr [EBP + 0xfffffef6]
008fdc91 : PUSH ECX
008fdc92 : MOVZX ECX,byte ptr [EBP + 0xfffffef7]
008fdc99 : PUSH ECX
008fdc9a : MOV ECX,dword ptr [EBP + 0xfffffef0]
008fdca0 : PUSH ECX
008fdca1 : MOV ECX,dword ptr [EBP + 0xfffffeec]
008fdca7 : PUSH ECX
008fdca8 : PUSH ECX
008fdca9 : PUSH 0xc6296c
008fdcae : PUSH 0xc62984
008fdcb3 : PUSH EAX
008fdcb4 : CALL EDX
008fdcb6 : ADD ESP,0x28
008fdcb9 : MOV EAX,dword ptr [EBP + 0xfffffeec]
008fdcbf : MOV ECX,dword ptr [EBP + 0xfffffee8]
008fdcc5 : MOVZX EDX,byte ptr [ECX + 0x7]
008fdcc9 : INC EAX
008fdcca : MOV dword ptr [EBP + 0xfffffeec],EAX
008fdcd0 : DEC EAX
008fdcd1 : CMP EAX,EDX
008fdcd3 : JL 0x008fdb41
008fdcd9 : MOV ESI,dword ptr [EBP + 0xfffffee4]
008fdcdf : CALL 0x008fd9d0
008fdce4 : MOV ECX,dword ptr [EBP + -0x4]
008fdce7 : POP EDI
008fdce8 : POP ESI
008fdce9 : XOR ECX,EBP
008fdceb : POP EBX
008fdcec : CALL 0x00633e6b
008fdcf1 : MOV ESP,EBP
008fdcf3 : POP EBP
008fdcf4 : RET 0x8

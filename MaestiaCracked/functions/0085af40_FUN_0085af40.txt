PROGRAM  : Maestia.exe
FUNCTION : FUN_0085af40
ENTRY    : 0085af40
BODY     : [[0085af40, 0085b053]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_0085af40(uint *param_1,int param_2)

{
  byte bVar1;
  int iVar2;
  int iVar3;
  byte in_CL;
  int unaff_EDI;
  
  switch(in_CL) {
  case 2:
  case 4:
  case 5:
  case 7:
  case 8:
  case 9:
    if (((*(uint *)(unaff_EDI + 0x16e4) & 0x800) != 0) && ((*param_1 >> (in_CL & 0x1f) & 1) != 0)) {
      return 0;
    }
    iVar2 = FUN_00859cb0(in_CL);
    if ((iVar2 != -1) && ((*(uint *)(unaff_EDI + 0x16e4) & 1 << ((byte)iVar2 & 0x1f)) != 0)) {
      iVar2 = *(int *)(unaff_EDI + 0x16e8 + iVar2 * 4);
      iVar3 = FUN_004049b0(iVar2);
      if ((iVar3 == 0) || ((*(uint *)(iVar3 + 0x4c) & 0x10000) == 0)) {
        if (iVar2 != 0) {
          return 0;
        }
      }
      else {
        iVar2 = FUN_00854b00();
        if (iVar2 != 0) {
          return 0;
        }
      }
    }
    break;
  default:
    if (((byte)(in_CL - 0x14) < 10) &&
       (((bVar1 = FUN_00859cb0(in_CL), param_2 == 0 &&
         ((*(uint *)(unaff_EDI + 0x16e4) & 1 << (in_CL & 0x1f)) == 0)) ||
        (((*(uint *)(unaff_EDI + 0x16e4) & 0x800) != 0 && ((*param_1 >> (bVar1 & 0x1f) & 1) != 0))))
       )) {
      return 0;
    }
    break;
  case 0xb:
    if ((param_2 == 0) && ((*(uint *)(unaff_EDI + 0x16e4) & 1 << (in_CL & 0x1f)) == 0)) {
      return 0;
    }
  }
  return 1;
}



============================================================
DISASSEMBLY
============================================================
0085af40 : PUSH EBP
0085af41 : MOV EBP,ESP
0085af43 : PUSH EBX
0085af44 : MOV EBX,dword ptr [EBP + 0xc]
0085af47 : PUSH ESI
0085af48 : MOVZX ESI,CL
0085af4b : LEA EAX,[ESI + -0x2]
0085af4e : CMP EAX,0x9
0085af51 : JA 0x0085b009
0085af57 : MOVZX EAX,byte ptr [EAX + 0x85b060]
0085af5e : JMP dword ptr [EAX*0x4 + 0x85b054]
0085af65 : TEST dword ptr [EDI + 0x16e4],0x800
0085af6f : JZ 0x0085af7f
0085af71 : MOV ECX,dword ptr [EBP + 0x8]
0085af74 : MOV EDX,dword ptr [ECX]
0085af76 : MOV ECX,ESI
0085af78 : SHR EDX,CL
0085af7a : TEST DL,0x1
0085af7d : JNZ 0x0085afd8
0085af7f : PUSH ESI
0085af80 : CALL 0x00859cb0
0085af85 : MOV EBX,EAX
0085af87 : ADD ESP,0x4
0085af8a : CMP EBX,-0x1
0085af8d : JZ 0x0085b049
0085af93 : MOV EAX,0x1
0085af98 : MOV CL,BL
0085af9a : SHL EAX,CL
0085af9c : TEST dword ptr [EDI + 0x16e4],EAX
0085afa2 : JZ 0x0085b049
0085afa8 : MOV ESI,dword ptr [EDI + EBX*0x4 + 0x16e8]
0085afaf : PUSH ESI
0085afb0 : CALL 0x004049b0
0085afb5 : ADD ESP,0x4
0085afb8 : TEST EAX,EAX
0085afba : JZ 0x0085afe0
0085afbc : MOV ECX,dword ptr [EAX + 0x4c]
0085afbf : AND ECX,0x10000
0085afc5 : XOR EAX,EAX
0085afc7 : OR EAX,ECX
0085afc9 : JZ 0x0085afe0
0085afcb : MOV AL,BL
0085afcd : MOV ECX,EDI
0085afcf : CALL 0x00854b00
0085afd4 : TEST EAX,EAX
0085afd6 : JZ 0x0085b049
0085afd8 : XOR EAX,EAX
0085afda : POP ESI
0085afdb : POP EBX
0085afdc : POP EBP
0085afdd : RET 0x8
0085afe0 : TEST ESI,ESI
0085afe2 : JZ 0x0085b049
0085afe4 : XOR EAX,EAX
0085afe6 : POP ESI
0085afe7 : POP EBX
0085afe8 : POP EBP
0085afe9 : RET 0x8
0085afec : TEST EBX,EBX
0085afee : JNZ 0x0085b049
0085aff0 : MOV EDX,0x1
0085aff5 : MOV ECX,ESI
0085aff7 : SHL EDX,CL
0085aff9 : TEST dword ptr [EDI + 0x16e4],EDX
0085afff : JNZ 0x0085b049
0085b001 : XOR EAX,EAX
0085b003 : POP ESI
0085b004 : POP EBX
0085b005 : POP EBP
0085b006 : RET 0x8
0085b009 : SUB CL,0x14
0085b00c : CMP CL,0x9
0085b00f : JA 0x0085b049
0085b011 : PUSH ESI
0085b012 : CALL 0x00859cb0
0085b017 : ADD ESP,0x4
0085b01a : TEST EBX,EBX
0085b01c : JNZ 0x0085b02f
0085b01e : MOV EDX,0x1
0085b023 : MOV ECX,ESI
0085b025 : SHL EDX,CL
0085b027 : TEST dword ptr [EDI + 0x16e4],EDX
0085b02d : JZ 0x0085b001
0085b02f : TEST dword ptr [EDI + 0x16e4],0x800
0085b039 : JZ 0x0085b049
0085b03b : MOV ECX,dword ptr [EBP + 0x8]
0085b03e : MOV EDX,dword ptr [ECX]
0085b040 : MOV CL,AL
0085b042 : SHR EDX,CL
0085b044 : TEST DL,0x1
0085b047 : JNZ 0x0085b001
0085b049 : POP ESI
0085b04a : MOV EAX,0x1
0085b04f : POP EBX
0085b050 : POP EBP
0085b051 : RET 0x8

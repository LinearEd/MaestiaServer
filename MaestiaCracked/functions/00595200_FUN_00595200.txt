PROGRAM  : Maestia.exe
FUNCTION : FUN_00595200
ENTRY    : 00595200
BODY     : [[00595200, 005953b7]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00595200(int param_1)

{
  undefined1 *puVar1;
  int iVar2;
  int iVar3;
  GRefCountNTSImpl *this;
  undefined4 uVar4;
  int *piVar5;
  undefined4 uVar6;
  undefined *puVar7;
  undefined4 uVar8;
  undefined *puVar9;
  undefined4 uVar10;
  undefined4 uVar11;
  undefined4 uVar12;
  undefined4 uVar13;
  GRefCountNTSImpl *local_4c [16];
  uint local_c;
  
  iVar2 = param_1;
  puVar1 = *(undefined1 **)(param_1 + 4);
  FUN_00526400();
  *puVar1 = 0;
  if (*(int **)(iVar2 + 8) == (int *)0x0) {
    iVar3 = *(int *)(*(int *)(iVar2 + 0x18) + 0x74);
  }
  else {
    iVar3 = (**(code **)(**(int **)(iVar2 + 8) + 8))();
    if (iVar3 != 2) {
      return;
    }
    if (*(int *)(iVar2 + 8) == 0) {
      return;
    }
    iVar3 = *(int *)(iVar2 + 8) + -0x68;
  }
  if ((iVar3 != 0) && (5 < *(int *)(iVar2 + 0x1c))) {
    uVar13 = 0;
    uVar12 = 0;
    uVar11 = 0;
    uVar4 = *(undefined4 *)(iVar2 + 0x18);
    uVar10 = 0;
    puVar9 = &DAT_00d65698;
    uVar8 = 1;
    puVar7 = &DAT_00d65858;
    uVar6 = 1;
    FUN_00526260(1);
    FUN_00527730(uVar4);
    iVar3 = FUN_0063b380(uVar6,puVar7,uVar8,puVar9,uVar10,uVar11,uVar12,uVar13);
    FUN_0051d350(0x10002,iVar3 + 0x4000,uVar6,puVar7,uVar8,puVar9,uVar10,uVar11,uVar12,uVar13);
    if (local_c < 0x7efffffe) {
      uVar4 = *(undefined4 *)(iVar2 + 0x18);
      FUN_00526260(0);
      FUN_005272e0(&param_1,uVar4,0xffffffff,0);
      this = (GRefCountNTSImpl *)FUN_00594270(local_4c,&param_1,0,0,0xffffffff,1,0,0);
      if (this != (GRefCountNTSImpl *)0x0) {
        *(int *)(this + 4) = *(int *)(this + 4) + 1;
      }
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + -1;
      if (*(int *)(param_1 + 8) == 0) {
        FUN_00525340();
      }
      if (this != (GRefCountNTSImpl *)0x0) {
        (**(code **)(*(int *)this + 0x14))(0);
        uVar6 = 0;
        piVar5 = (int *)(-(uint)(((byte)this[0x66] & 0x80) != 0) & (uint)this);
        iVar2 = *piVar5;
        uVar4 = FUN_00526260(2);
        (**(code **)(iVar2 + 0xfc))(0,uVar4,uVar6);
        iVar2 = *piVar5;
        uVar6 = 0;
        uVar4 = FUN_00526260(3);
        (**(code **)(iVar2 + 0xfc))(1,uVar4,uVar6);
        iVar2 = *piVar5;
        uVar6 = 0;
        uVar4 = FUN_00526260(4);
        (**(code **)(iVar2 + 0xfc))(8,uVar4,uVar6);
        iVar2 = *piVar5;
        uVar6 = 0;
        uVar4 = FUN_00526260(5);
        (**(code **)(iVar2 + 0xfc))(9,uVar4,uVar6);
        FUN_00526c80(piVar5);
        GRefCountNTSImpl::Release(this);
      }
    }
    if (local_4c[0] != (GRefCountNTSImpl *)0x0) {
      GRefCountNTSImpl::Release(local_4c[0]);
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00595200 : SUB ESP,0x4c
00595203 : PUSH EBX
00595204 : PUSH EBP
00595205 : PUSH ESI
00595206 : PUSH EDI
00595207 : MOV EDI,dword ptr [ESP + 0x60]
0059520b : MOV ESI,dword ptr [EDI + 0x4]
0059520e : MOV ECX,ESI
00595210 : CALL 0x00526400
00595215 : MOV byte ptr [ESI],0x0
00595218 : MOV ECX,dword ptr [EDI + 0x8]
0059521b : TEST ECX,ECX
0059521d : JNZ 0x00595227
0059521f : MOV EAX,dword ptr [EDI + 0x18]
00595222 : MOV EBX,dword ptr [EAX + 0x74]
00595225 : JMP 0x00595245
00595227 : MOV EDX,dword ptr [ECX]
00595229 : MOV EAX,dword ptr [EDX + 0x8]
0059522c : CALL EAX
0059522e : CMP EAX,0x2
00595231 : JNZ 0x005953b0
00595237 : MOV EAX,dword ptr [EDI + 0x8]
0059523a : TEST EAX,EAX
0059523c : JZ 0x005953b0
00595242 : LEA EBX,[EAX + -0x68]
00595245 : TEST EBX,EBX
00595247 : JZ 0x005953b0
0059524d : CMP dword ptr [EDI + 0x1c],0x6
00595251 : JL 0x005953b0
00595257 : FLDZ
00595259 : PUSH 0x0
0059525b : PUSH 0x0
0059525d : PUSH 0x0
0059525f : PUSH ECX
00595260 : MOV ECX,dword ptr [EDI + 0x18]
00595263 : FSTP float ptr [ESP]
00595266 : PUSH 0xd65698
0059526b : PUSH 0x1
0059526d : PUSH 0xd65858
00595272 : PUSH 0x1
00595274 : PUSH ECX
00595275 : PUSH 0x1
00595277 : MOV ECX,EDI
00595279 : CALL 0x00526260
0059527e : MOV ECX,EAX
00595280 : CALL 0x00527730
00595285 : CALL 0x0063b380
0059528a : ADD EAX,0x4000
0059528f : PUSH EAX
00595290 : PUSH ECX
00595291 : MOV EAX,ESP
00595293 : LEA ECX,[ESP + 0x38]
00595297 : MOV dword ptr [EAX],0x10002
0059529d : CALL 0x0051d350
005952a2 : CMP dword ptr [ESP + 0x50],0x7efffffd
005952aa : JA 0x005953a3
005952b0 : MOV ESI,dword ptr [EDI + 0x18]
005952b3 : PUSH 0x0
005952b5 : MOV ECX,EDI
005952b7 : CALL 0x00526260
005952bc : PUSH 0x0
005952be : PUSH -0x1
005952c0 : PUSH ESI
005952c1 : LEA EDX,[ESP + 0x6c]
005952c5 : PUSH EDX
005952c6 : MOV ECX,EAX
005952c8 : CALL 0x005272e0
005952cd : PUSH 0x0
005952cf : PUSH 0x0
005952d1 : PUSH 0x1
005952d3 : PUSH -0x1
005952d5 : PUSH 0x0
005952d7 : PUSH 0x0
005952d9 : LEA EAX,[ESP + 0x78]
005952dd : PUSH EAX
005952de : LEA ECX,[ESP + 0x2c]
005952e2 : PUSH ECX
005952e3 : MOV ECX,EBX
005952e5 : CALL 0x00594270
005952ea : MOV EBX,EAX
005952ec : TEST EBX,EBX
005952ee : JZ 0x005952f3
005952f0 : INC dword ptr [EBX + 0x4]
005952f3 : MOV EAX,dword ptr [ESP + 0x60]
005952f7 : DEC dword ptr [EAX + 0x8]
005952fa : MOV ECX,EAX
005952fc : ADD EAX,0x8
005952ff : CMP dword ptr [EAX],0x0
00595302 : JNZ 0x00595309
00595304 : CALL 0x00525340
00595309 : TEST EBX,EBX
0059530b : JZ 0x005953a3
00595311 : MOV EDX,dword ptr [EBX]
00595313 : MOV EAX,dword ptr [EDX + 0x14]
00595316 : PUSH 0x0
00595318 : MOV ECX,EBX
0059531a : CALL EAX
0059531c : MOV CL,byte ptr [EBX + 0x66]
0059531f : AND CL,0x80
00595322 : MOVZX ESI,CL
00595325 : NEG ESI
00595327 : SBB ESI,ESI
00595329 : PUSH 0x0
0059532b : AND ESI,EBX
0059532d : MOV EBP,dword ptr [ESI]
0059532f : PUSH 0x2
00595331 : MOV ECX,EDI
00595333 : CALL 0x00526260
00595338 : MOV EDX,dword ptr [EBP + 0xfc]
0059533e : PUSH EAX
0059533f : PUSH 0x0
00595341 : MOV ECX,ESI
00595343 : CALL EDX
00595345 : MOV EBP,dword ptr [ESI]
00595347 : PUSH 0x0
00595349 : PUSH 0x3
0059534b : MOV ECX,EDI
0059534d : CALL 0x00526260
00595352 : PUSH EAX
00595353 : MOV EAX,dword ptr [EBP + 0xfc]
00595359 : PUSH 0x1
0059535b : MOV ECX,ESI
0059535d : CALL EAX
0059535f : MOV EBP,dword ptr [ESI]
00595361 : PUSH 0x0
00595363 : PUSH 0x4
00595365 : MOV ECX,EDI
00595367 : CALL 0x00526260
0059536c : MOV EDX,dword ptr [EBP + 0xfc]
00595372 : PUSH EAX
00595373 : PUSH 0x8
00595375 : MOV ECX,ESI
00595377 : CALL EDX
00595379 : MOV EBP,dword ptr [ESI]
0059537b : PUSH 0x0
0059537d : PUSH 0x5
0059537f : MOV ECX,EDI
00595381 : CALL 0x00526260
00595386 : PUSH EAX
00595387 : MOV EAX,dword ptr [EBP + 0xfc]
0059538d : PUSH 0x9
0059538f : MOV ECX,ESI
00595391 : CALL EAX
00595393 : MOV ECX,dword ptr [EDI + 0x4]
00595396 : PUSH ESI
00595397 : CALL 0x00526c80
0059539c : MOV ECX,EBX
0059539e : CALL 0x004ff7c0
005953a3 : MOV ECX,dword ptr [ESP + 0x10]
005953a7 : TEST ECX,ECX
005953a9 : JZ 0x005953b0
005953ab : CALL 0x004ff7c0
005953b0 : POP EDI
005953b1 : POP ESI
005953b2 : POP EBP
005953b3 : POP EBX
005953b4 : ADD ESP,0x4c
005953b7 : RET

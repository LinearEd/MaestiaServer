PROGRAM  : Maestia.exe
FUNCTION : Iput
ENTRY    : 0062a0f1
BODY     : [[0062a0f1, 0062a2dc]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __EH_prolog3_GS replaced with injection: EH_prolog3 */
/* Library Function - Multiple Matches With Same Base Name
    private: class std::ostreambuf_iterator<unsigned short,struct std::char_traits<unsigned short> >
   __cdecl std::num_put<unsigned short,class std::ostreambuf_iterator<unsigned short,struct
   std::char_traits<unsigned short> > >::_Iput(class std::ostreambuf_iterator<unsigned short,struct
   std::char_traits<unsigned short> >,class std::ios_base &,unsigned short,char *,unsigned int)const
   
    private: class std::ostreambuf_iterator<wchar_t,struct std::char_traits<wchar_t> > __cdecl
   std::num_put<wchar_t,class std::ostreambuf_iterator<wchar_t,struct std::char_traits<wchar_t> >
   >::_Iput(class std::ostreambuf_iterator<wchar_t,struct std::char_traits<wchar_t> >,class
   std::ios_base &,wchar_t,char *,unsigned int)const 
   
   Library: Visual Studio 2008 Release */

void Iput(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,int param_5,
         undefined4 param_6,char *param_7,uint param_8)

{
  char cVar1;
  undefined4 uVar2;
  undefined2 uVar3;
  undefined4 uVar4;
  char ****ppppcVar5;
  rsize_t _DstSize;
  uint uVar6;
  undefined4 *puVar7;
  int iVar8;
  undefined1 local_54 [4];
  undefined4 local_50;
  int *local_4c;
  undefined1 local_48 [4];
  int local_44;
  undefined1 local_40 [4];
  int local_3c;
  undefined4 local_38;
  char ***local_34;
  undefined1 local_30 [4];
  char ***local_2c [5];
  uint local_18;
  undefined4 local_8;
  undefined4 uStack_4;
  
  uStack_4 = 0x44;
  local_8 = 0x62a0fd;
  local_38 = param_1;
  local_50 = param_2;
  local_44 = param_5;
  uVar4 = FUN_004d0b70(local_54);
  local_8 = 0;
  local_4c = (int *)use_facet<>(uVar4);
  local_8 = 0xffffffff;
  FUN_00451310();
  grouping(local_30);
  cVar1 = *param_7;
  local_8 = 1;
  if ((cVar1 == '+') || (cVar1 == '-')) {
    local_3c = 1;
  }
  else if ((cVar1 == '0') && ((param_7[1] == 'x' || (param_7[1] == 'X')))) {
    local_3c = 2;
  }
  else {
    local_3c = 0;
  }
  ppppcVar5 = (char ****)local_2c[0];
  if (local_18 < 0x10) {
    ppppcVar5 = local_2c;
  }
  if (*(char *)ppppcVar5 != '\x7f') {
    ppppcVar5 = (char ****)local_2c[0];
    if (local_18 < 0x10) {
      ppppcVar5 = local_2c;
    }
    if ('\0' < *(char *)ppppcVar5) {
      uVar6 = param_8;
      if (local_18 < 0x10) {
        local_34 = (char ***)local_2c;
      }
      else {
        local_34 = local_2c[0];
      }
      while (((cVar1 = *(char *)local_34, cVar1 != '\x7f' && ('\0' < cVar1)) &&
             ((uint)(int)cVar1 < uVar6 - local_3c))) {
        uVar6 = uVar6 - (int)cVar1;
        _DstSize = (param_8 - uVar6) + 1;
        _memmove_s(param_7 + uVar6 + 1,_DstSize,param_7 + uVar6,_DstSize);
        param_8 = param_8 + 1;
        param_7[uVar6] = '\0';
        param_5 = local_44;
        if ('\0' < *(char *)((int)local_34 + 1)) {
          local_34 = (char ***)((int)local_34 + 1);
        }
      }
    }
  }
  uVar6 = *(uint *)(param_5 + 0x18);
  if (((int)uVar6 < 1) || (uVar6 <= param_8)) {
    iVar8 = 0;
  }
  else {
    iVar8 = uVar6 - param_8;
  }
  uVar6 = *(uint *)(param_5 + 0x10) & 0x1c0;
  if (uVar6 != 0x40) {
    if (uVar6 == 0x100) {
      puVar7 = (undefined4 *)Putc(local_38,local_48,param_3,param_4,param_7,local_3c);
      param_8 = param_8 - local_3c;
      param_7 = param_7 + local_3c;
      puVar7 = (undefined4 *)Rep(local_38,local_48,*puVar7,puVar7[1],param_6,iVar8);
    }
    else {
      puVar7 = (undefined4 *)Rep(local_38,local_48,param_3,param_4,param_6,iVar8);
    }
    param_3 = *puVar7;
    param_4 = puVar7[1];
    iVar8 = 0;
  }
  uVar3 = (**(code **)(*local_4c + 8))();
  puVar7 = (undefined4 *)Putgrouped(local_38,local_40,param_3,param_4,param_7,param_8,uVar3);
  uVar4 = *puVar7;
  uVar2 = puVar7[1];
  *(undefined4 *)(param_5 + 0x18) = 0;
  Rep(local_38,local_50,uVar4,uVar2,param_6,iVar8);
  FUN_00405260(1,0);
  FUN_00640ed0();
  return;
}



============================================================
DISASSEMBLY
============================================================
0062a0f1 : PUSH 0x44
0062a0f3 : MOV EAX,0xb0ba75
0062a0f8 : CALL 0x00640e86
0062a0fd : MOV EAX,dword ptr [EBP + 0x8]
0062a100 : MOV EBX,dword ptr [EBP + 0x18]
0062a103 : MOV ESI,dword ptr [EBP + 0x20]
0062a106 : MOV dword ptr [EBP + -0x34],EAX
0062a109 : MOV EAX,dword ptr [EBP + 0xc]
0062a10c : MOV dword ptr [EBP + -0x4c],EAX
0062a10f : LEA EAX,[EBP + -0x50]
0062a112 : PUSH EAX
0062a113 : MOV ECX,EBX
0062a115 : MOV dword ptr [EBP + -0x40],EBX
0062a118 : CALL 0x004d0b70
0062a11d : AND dword ptr [EBP + -0x4],0x0
0062a121 : PUSH EAX
0062a122 : CALL 0x006284b1
0062a127 : OR dword ptr [EBP + -0x4],0xffffffff
0062a12b : POP ECX
0062a12c : LEA ECX,[EBP + -0x50]
0062a12f : MOV dword ptr [EBP + -0x48],EAX
0062a132 : CALL 0x00451310
0062a137 : MOV ECX,dword ptr [EBP + -0x48]
0062a13a : LEA EAX,[EBP + -0x2c]
0062a13d : PUSH EAX
0062a13e : CALL 0x006269c7
0062a143 : MOV AL,byte ptr [ESI]
0062a145 : XOR ECX,ECX
0062a147 : INC ECX
0062a148 : MOV dword ptr [EBP + -0x4],ECX
0062a14b : CMP AL,0x2b
0062a14d : JZ 0x0062a171
0062a14f : CMP AL,0x2d
0062a151 : JZ 0x0062a171
0062a153 : CMP AL,0x30
0062a155 : JNZ 0x0062a16b
0062a157 : MOV AL,byte ptr [ESI + 0x1]
0062a15a : CMP AL,0x78
0062a15c : JZ 0x0062a162
0062a15e : CMP AL,0x58
0062a160 : JNZ 0x0062a16b
0062a162 : MOV dword ptr [EBP + -0x38],0x2
0062a169 : JMP 0x0062a174
0062a16b : AND dword ptr [EBP + -0x38],0x0
0062a16f : JMP 0x0062a174
0062a171 : MOV dword ptr [EBP + -0x38],ECX
0062a174 : CMP dword ptr [EBP + -0x14],0x10
0062a178 : MOV ECX,dword ptr [EBP + -0x28]
0062a17b : MOV EAX,ECX
0062a17d : JNC 0x0062a182
0062a17f : LEA EAX,[EBP + -0x28]
0062a182 : CMP byte ptr [EAX],0x7f
0062a185 : JZ 0x0062a1f6
0062a187 : CMP dword ptr [EBP + -0x14],0x10
0062a18b : MOV EAX,ECX
0062a18d : JNC 0x0062a192
0062a18f : LEA EAX,[EBP + -0x28]
0062a192 : CMP byte ptr [EAX],0x0
0062a195 : JLE 0x0062a1f6
0062a197 : CMP dword ptr [EBP + -0x14],0x10
0062a19b : JC 0x0062a1a2
0062a19d : MOV dword ptr [EBP + -0x30],ECX
0062a1a0 : JMP 0x0062a1a8
0062a1a2 : LEA EAX,[EBP + -0x28]
0062a1a5 : MOV dword ptr [EBP + -0x30],EAX
0062a1a8 : MOV EDI,dword ptr [EBP + 0x24]
0062a1ab : JMP 0x0062a1ed
0062a1ad : TEST AL,AL
0062a1af : JLE 0x0062a1f6
0062a1b1 : MOV ECX,EDI
0062a1b3 : SUB ECX,dword ptr [EBP + -0x38]
0062a1b6 : MOVSX EAX,AL
0062a1b9 : CMP EAX,ECX
0062a1bb : JNC 0x0062a1f6
0062a1bd : SUB EDI,EAX
0062a1bf : MOV EAX,dword ptr [EBP + 0x24]
0062a1c2 : SUB EAX,EDI
0062a1c4 : INC EAX
0062a1c5 : PUSH EAX
0062a1c6 : LEA EBX,[ESI + EDI*0x1]
0062a1c9 : PUSH EBX
0062a1ca : PUSH EAX
0062a1cb : LEA EAX,[ESI + EDI*0x1 + 0x1]
0062a1cf : PUSH EAX
0062a1d0 : CALL 0x00634101
0062a1d5 : MOV EAX,dword ptr [EBP + -0x30]
0062a1d8 : ADD ESP,0x10
0062a1db : INC dword ptr [EBP + 0x24]
0062a1de : INC EAX
0062a1df : MOV byte ptr [EBX],0x0
0062a1e2 : CMP byte ptr [EAX],0x0
0062a1e5 : JLE 0x0062a1ea
0062a1e7 : MOV dword ptr [EBP + -0x30],EAX
0062a1ea : MOV EBX,dword ptr [EBP + -0x40]
0062a1ed : MOV EAX,dword ptr [EBP + -0x30]
0062a1f0 : MOV AL,byte ptr [EAX]
0062a1f2 : CMP AL,0x7f
0062a1f4 : JNZ 0x0062a1ad
0062a1f6 : MOV EDI,dword ptr [EBX + 0x18]
0062a1f9 : TEST EDI,EDI
0062a1fb : JLE 0x0062a207
0062a1fd : CMP EDI,dword ptr [EBP + 0x24]
0062a200 : JBE 0x0062a207
0062a202 : SUB EDI,dword ptr [EBP + 0x24]
0062a205 : JMP 0x0062a209
0062a207 : XOR EDI,EDI
0062a209 : MOV EAX,dword ptr [EBX + 0x10]
0062a20c : AND EAX,0x1c0
0062a211 : CMP EAX,0x40
0062a214 : JZ 0x0062a283
0062a216 : CMP EAX,0x100
0062a21b : LEA EAX,[EBP + -0x44]
0062a21e : JZ 0x0062a238
0062a220 : PUSH EDI
0062a221 : PUSH dword ptr [EBP + 0x1c]
0062a224 : PUSH dword ptr [EBP + 0x14]
0062a227 : PUSH dword ptr [EBP + 0x10]
0062a22a : PUSH EAX
0062a22b : PUSH dword ptr [EBP + -0x34]
0062a22e : CALL 0x006264ac
0062a233 : ADD ESP,0x18
0062a236 : JMP 0x0062a276
0062a238 : PUSH dword ptr [EBP + -0x38]
0062a23b : PUSH ESI
0062a23c : PUSH dword ptr [EBP + 0x14]
0062a23f : PUSH dword ptr [EBP + 0x10]
0062a242 : PUSH EAX
0062a243 : PUSH dword ptr [EBP + -0x34]
0062a246 : CALL 0x006261e0
0062a24b : MOV ECX,dword ptr [EAX]
0062a24d : PUSH EDI
0062a24e : PUSH dword ptr [EBP + 0x1c]
0062a251 : MOV dword ptr [EBP + 0x10],ECX
0062a254 : MOV ECX,dword ptr [EAX + 0x4]
0062a257 : MOV dword ptr [EBP + 0x14],ECX
0062a25a : PUSH dword ptr [EAX + 0x4]
0062a25d : MOV ECX,dword ptr [EBP + -0x38]
0062a260 : PUSH dword ptr [EAX]
0062a262 : SUB dword ptr [EBP + 0x24],ECX
0062a265 : LEA EAX,[EBP + -0x44]
0062a268 : PUSH EAX
0062a269 : PUSH dword ptr [EBP + -0x34]
0062a26c : ADD ESI,ECX
0062a26e : CALL 0x006264ac
0062a273 : ADD ESP,0x30
0062a276 : MOV ECX,dword ptr [EAX]
0062a278 : MOV dword ptr [EBP + 0x10],ECX
0062a27b : MOV EAX,dword ptr [EAX + 0x4]
0062a27e : XOR EDI,EDI
0062a280 : MOV dword ptr [EBP + 0x14],EAX
0062a283 : MOV ECX,dword ptr [EBP + -0x48]
0062a286 : MOV EAX,dword ptr [ECX]
0062a288 : CALL dword ptr [EAX + 0x8]
0062a28b : MOVZX EAX,AX
0062a28e : PUSH EAX
0062a28f : PUSH dword ptr [EBP + 0x24]
0062a292 : LEA EAX,[EBP + -0x3c]
0062a295 : PUSH ESI
0062a296 : PUSH dword ptr [EBP + 0x14]
0062a299 : PUSH dword ptr [EBP + 0x10]
0062a29c : PUSH EAX
0062a29d : PUSH dword ptr [EBP + -0x34]
0062a2a0 : CALL 0x00626589
0062a2a5 : MOV ECX,dword ptr [EAX]
0062a2a7 : PUSH EDI
0062a2a8 : PUSH dword ptr [EBP + 0x1c]
0062a2ab : MOV dword ptr [EBP + 0x10],ECX
0062a2ae : MOV EAX,dword ptr [EAX + 0x4]
0062a2b1 : AND dword ptr [EBX + 0x18],0x0
0062a2b5 : PUSH EAX
0062a2b6 : PUSH ECX
0062a2b7 : PUSH dword ptr [EBP + -0x4c]
0062a2ba : MOV dword ptr [EBP + 0x14],EAX
0062a2bd : PUSH dword ptr [EBP + -0x34]
0062a2c0 : CALL 0x006264ac
0062a2c5 : ADD ESP,0x34
0062a2c8 : PUSH 0x0
0062a2ca : PUSH 0x1
0062a2cc : LEA ECX,[EBP + -0x2c]
0062a2cf : CALL 0x00405260
0062a2d4 : MOV EAX,dword ptr [EBP + -0x4c]
0062a2d7 : CALL 0x00640ed0
0062a2dc : RET

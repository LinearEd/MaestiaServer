PROGRAM  : Maestia.exe
FUNCTION : FUN_009adfc0
ENTRY    : 009adfc0
BODY     : [[009adfc0, 009ae1bb]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009adfc0(int *param_1,undefined4 param_2)

{
  wchar_t wVar1;
  uint uVar2;
  wchar_t *pwVar3;
  wchar_t *in_ECX;
  undefined1 local_86c [4];
  undefined2 local_868;
  undefined4 local_858;
  uint local_854;
  int *local_850;
  undefined4 local_848;
  int local_838;
  uint local_834;
  undefined1 local_830 [4];
  undefined2 local_82c;
  undefined4 local_81c;
  uint local_818;
  wchar_t local_814;
  undefined1 local_812 [2044];
  undefined2 local_16;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b216cf;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_850 = param_1;
  local_854 = 7;
  local_858 = 0;
  local_868 = 0;
  pwVar3 = in_ECX;
  do {
    wVar1 = *pwVar3;
    pwVar3 = pwVar3 + 1;
  } while (wVar1 != L'\0');
  local_14 = uVar2;
  FUN_00406360(in_ECX,(int)pwVar3 - (int)(in_ECX + 1) >> 1);
  local_8 = 0;
  FUN_0081d120(local_86c);
  local_8 = CONCAT31(local_8._1_3_,2);
  if (7 < local_854) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0(uVar2);
  }
  local_854 = 7;
  local_858 = 0;
  local_868 = 0;
  if (local_838 == 0) {
    _wcsncpy(&local_814,in_ECX,0x3ff);
    local_16 = 0;
  }
  else {
    pwVar3 = local_848;
    if (local_834 < 8) {
      pwVar3 = (wchar_t *)&local_848;
    }
    FID_conflict___vswprintf_c(&local_814,0x400,pwVar3,&stack0x0000000c);
    local_16 = 0;
  }
  local_16 = 0;
  pwVar3 = &local_814;
  local_818 = 7;
  local_81c = 0;
  local_82c = 0;
  do {
    wVar1 = *pwVar3;
    pwVar3 = pwVar3 + 1;
  } while (wVar1 != L'\0');
  FUN_00406360(&local_814,(int)pwVar3 - (int)local_812 >> 1);
  local_8._0_1_ = 3;
  (**(code **)(*local_850 + 0x44))(local_830,param_2);
  local_8 = CONCAT31(local_8._1_3_,2);
  if (7 < local_818) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_818 = 7;
  local_81c = 0;
  local_82c = 0;
  local_8 = 0xffffffff;
  if (7 < local_834) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_834 = 7;
  local_838 = 0;
  local_848 = (wchar_t *)((uint)local_848._2_2_ << 0x10);
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
009adfc0 : PUSH EBP
009adfc1 : MOV EBP,ESP
009adfc3 : PUSH -0x1
009adfc5 : PUSH 0xb216cf
009adfca : MOV EAX,FS:[0x0]
009adfd0 : PUSH EAX
009adfd1 : SUB ESP,0x85c
009adfd7 : MOV EAX,[0x00d66fa0]
009adfdc : XOR EAX,EBP
009adfde : MOV dword ptr [EBP + -0x10],EAX
009adfe1 : PUSH EBX
009adfe2 : PUSH ESI
009adfe3 : PUSH EDI
009adfe4 : PUSH EAX
009adfe5 : LEA EAX,[EBP + -0xc]
009adfe8 : MOV FS:[0x0],EAX
009adfee : MOV EAX,dword ptr [EBP + 0x8]
009adff1 : MOV ESI,ECX
009adff3 : XOR EBX,EBX
009adff5 : MOV dword ptr [EBP + 0xfffff7b4],EAX
009adffb : XOR ECX,ECX
009adffd : MOV EAX,ESI
009adfff : MOV dword ptr [EBP + 0xfffff7b0],0x7
009ae009 : MOV dword ptr [EBP + 0xfffff7ac],EBX
009ae00f : MOV word ptr [EBP + 0xfffff79c],CX
009ae016 : LEA EDX,[EAX + 0x2]
009ae019 : LEA ESP,[ESP]
009ae020 : MOV CX,word ptr [EAX]
009ae023 : ADD EAX,0x2
009ae026 : CMP CX,BX
009ae029 : JNZ 0x009ae020
009ae02b : SUB EAX,EDX
009ae02d : SAR EAX,0x1
009ae02f : PUSH EAX
009ae030 : PUSH ESI
009ae031 : LEA ECX,[EBP + 0xfffff798]
009ae037 : CALL 0x00406360
009ae03c : MOV dword ptr [EBP + -0x4],EBX
009ae03f : MOV ECX,dword ptr [0x0172491c]
009ae045 : LEA EDX,[EBP + 0xfffff798]
009ae04b : PUSH EDX
009ae04c : LEA EDI,[EBP + 0xfffff7b8]
009ae052 : CALL 0x0081d120
009ae057 : MOV byte ptr [EBP + -0x4],0x2
009ae05b : MOV EDI,0x8
009ae060 : CMP dword ptr [EBP + 0xfffff7b0],EDI
009ae066 : JC 0x009ae073
009ae068 : MOV ECX,dword ptr [EBP + 0xfffff79c]
009ae06e : CALL 0x006f04e0
009ae073 : XOR EAX,EAX
009ae075 : MOV dword ptr [EBP + 0xfffff7b0],0x7
009ae07f : MOV dword ptr [EBP + 0xfffff7ac],EBX
009ae085 : MOV word ptr [EBP + 0xfffff79c],AX
009ae08c : CMP dword ptr [EBP + 0xfffff7cc],EBX
009ae092 : JNZ 0x009ae0b1
009ae094 : PUSH 0x3ff
009ae099 : LEA ECX,[EBP + 0xfffff7f0]
009ae09f : PUSH ESI
009ae0a0 : PUSH ECX
009ae0a1 : CALL 0x00634e39
009ae0a6 : ADD ESP,0xc
009ae0a9 : XOR EDX,EDX
009ae0ab : MOV word ptr [EBP + -0x12],DX
009ae0af : JMP 0x009ae0e4
009ae0b1 : MOV EAX,dword ptr [EBP + 0xfffff7bc]
009ae0b7 : CMP dword ptr [EBP + 0xfffff7d0],EDI
009ae0bd : JNC 0x009ae0c5
009ae0bf : LEA EAX,[EBP + 0xfffff7bc]
009ae0c5 : LEA ECX,[EBP + 0x10]
009ae0c8 : PUSH ECX
009ae0c9 : PUSH EAX
009ae0ca : LEA EDX,[EBP + 0xfffff7f0]
009ae0d0 : PUSH 0x400
009ae0d5 : PUSH EDX
009ae0d6 : CALL 0x00634791
009ae0db : ADD ESP,0x10
009ae0de : XOR EAX,EAX
009ae0e0 : MOV word ptr [EBP + -0x12],AX
009ae0e4 : MOV ESI,0x7
009ae0e9 : XOR ECX,ECX
009ae0eb : LEA EAX,[EBP + 0xfffff7f0]
009ae0f1 : MOV dword ptr [EBP + 0xfffff7ec],ESI
009ae0f7 : MOV dword ptr [EBP + 0xfffff7e8],EBX
009ae0fd : MOV word ptr [EBP + 0xfffff7d8],CX
009ae104 : LEA EDX,[EAX + 0x2]
009ae107 : MOV CX,word ptr [EAX]
009ae10a : ADD EAX,0x2
009ae10d : CMP CX,BX
009ae110 : JNZ 0x009ae107
009ae112 : SUB EAX,EDX
009ae114 : SAR EAX,0x1
009ae116 : PUSH EAX
009ae117 : LEA EDX,[EBP + 0xfffff7f0]
009ae11d : PUSH EDX
009ae11e : LEA ECX,[EBP + 0xfffff7d4]
009ae124 : CALL 0x00406360
009ae129 : MOV byte ptr [EBP + -0x4],0x3
009ae12d : MOV EDX,dword ptr [EBP + 0xc]
009ae130 : MOV ECX,dword ptr [EBP + 0xfffff7b4]
009ae136 : MOV EAX,dword ptr [ECX]
009ae138 : MOV EAX,dword ptr [EAX + 0x44]
009ae13b : PUSH EDX
009ae13c : LEA EDX,[EBP + 0xfffff7d4]
009ae142 : PUSH EDX
009ae143 : CALL EAX
009ae145 : MOV byte ptr [EBP + -0x4],0x2
009ae149 : CMP dword ptr [EBP + 0xfffff7ec],EDI
009ae14f : JC 0x009ae15c
009ae151 : MOV ECX,dword ptr [EBP + 0xfffff7d8]
009ae157 : CALL 0x006f04e0
009ae15c : XOR ECX,ECX
009ae15e : MOV dword ptr [EBP + 0xfffff7ec],ESI
009ae164 : MOV dword ptr [EBP + 0xfffff7e8],EBX
009ae16a : MOV word ptr [EBP + 0xfffff7d8],CX
009ae171 : MOV dword ptr [EBP + -0x4],0xffffffff
009ae178 : CMP dword ptr [EBP + 0xfffff7d0],EDI
009ae17e : JC 0x009ae18b
009ae180 : MOV ECX,dword ptr [EBP + 0xfffff7bc]
009ae186 : CALL 0x006f04e0
009ae18b : XOR EDX,EDX
009ae18d : MOV dword ptr [EBP + 0xfffff7d0],ESI
009ae193 : MOV dword ptr [EBP + 0xfffff7cc],EBX
009ae199 : MOV word ptr [EBP + 0xfffff7bc],DX
009ae1a0 : MOV ECX,dword ptr [EBP + -0xc]
009ae1a3 : MOV dword ptr FS:[0x0],ECX
009ae1aa : POP ECX
009ae1ab : POP EDI
009ae1ac : POP ESI
009ae1ad : POP EBX
009ae1ae : MOV ECX,dword ptr [EBP + -0x10]
009ae1b1 : XOR ECX,EBP
009ae1b3 : CALL 0x00633e6b
009ae1b8 : MOV ESP,EBP
009ae1ba : POP EBP
009ae1bb : RET

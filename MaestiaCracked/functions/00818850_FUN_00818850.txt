PROGRAM  : Maestia.exe
FUNCTION : FUN_00818850
ENTRY    : 00818850
BODY     : [[00818850, 008188cc] [008188d0, 00818966] [00818970, 0081898c] [00818990, 00818bb4]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_00818850(int param_1)

{
  short sVar1;
  char cVar2;
  undefined4 uVar3;
  short *psVar4;
  int *in_ECX;
  int iVar5;
  undefined1 auStack_20e0 [4];
  undefined2 uStack_20dc;
  undefined4 uStack_20d4;
  undefined4 uStack_20d0;
  char *pcStack_20cc;
  short *psStack_20c8;
  int *piStack_20c4;
  uint uStack_20c0;
  undefined1 local_20ac [32];
  undefined1 local_208c [32];
  undefined1 local_206c [8];
  int local_2064;
  int *local_2060;
  int local_205c;
  int *local_2058;
  undefined1 *local_2054;
  undefined1 local_2050 [4];
  undefined2 local_204c;
  undefined4 local_203c;
  uint local_2038;
  undefined1 local_2034 [4];
  undefined2 local_2030;
  undefined4 local_2020;
  uint local_201c;
  short local_2018;
  undefined1 local_2016 [8190];
  uint local_18;
  undefined4 uStack_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  puStack_c = &LAB_00b48944;
  local_10 = ExceptionList;
  uStack_14 = 0x81886b;
  uStack_20c0 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_205c = param_1;
  local_201c = 7;
  local_2020 = 0;
  local_2030 = 0;
  local_2038 = 7;
  local_203c = 0;
  local_204c = 0;
  local_8._0_1_ = 1;
  local_8._1_3_ = 0;
  local_2058 = in_ECX;
  local_18 = uStack_20c0;
  while (uVar3 = 0, (uint)in_ECX[9] < (uint)in_ECX[8]) {
    piStack_20c4 = &local_2064;
    psStack_20c8 = (short *)0x8188ec;
    cVar2 = (**(code **)(*in_ECX + 0x1c))();
    if (cVar2 == '\0') break;
    if (local_2064 == 0x5011) {
      piStack_20c4 = (int *)&local_2018;
      psStack_20c8 = (short *)0x818aa6;
      FUN_0070d320();
      psVar4 = &local_2018;
      do {
        sVar1 = *psVar4;
        psVar4 = psVar4 + 1;
      } while (sVar1 != 0);
      piStack_20c4 = (int *)((int)psVar4 - (int)local_2016 >> 1);
      psStack_20c8 = &local_2018;
      pcStack_20cc = (char *)0x818ad2;
      FUN_00406360();
    }
    else if (local_2064 == 0x5012) {
      piStack_20c4 = (int *)(uint)((DAT_01725270 >> 3 & 1) == 0);
      psStack_20c8 = (short *)0x0;
      pcStack_20cc = "";
      uStack_20d0 = 0x10;
      uStack_20d4 = 0x818946;
      piStack_20c4 = (int *)FUN_006f0760();
      local_8._0_1_ = 2;
      local_2054 = (undefined1 *)piStack_20c4;
      if (piStack_20c4 != (int *)0x0) {
        psStack_20c8 = (short *)0x81895d;
        uVar3 = FUN_004540e0();
      }
      local_8 = CONCAT31(local_8._1_3_,1);
      iVar5 = 0;
      do {
        piStack_20c4 = (int *)&local_2018;
        psStack_20c8 = (short *)0x818982;
        FUN_0070d080();
        psVar4 = &local_2018;
        do {
          sVar1 = *psVar4;
          psVar4 = psVar4 + 1;
        } while (sVar1 != 0);
        piStack_20c4 = (int *)((int)psVar4 - (int)local_2016 >> 1);
        psStack_20c8 = &local_2018;
        pcStack_20cc = (char *)0x8189b2;
        FUN_00406360();
        if (*(int *)(DAT_017248cc + 0x90) == iVar5) {
          piStack_20c4 = (int *)local_2050;
          pcStack_20cc = (char *)0x8189cd;
          psStack_20c8 = (short *)uVar3;
          FUN_00453bb0();
        }
        iVar5 = iVar5 + 1;
      } while (iVar5 < 0xc);
      local_2054 = auStack_20e0;
      psStack_20c8 = (short *)0x7;
      pcStack_20cc = (char *)0x0;
      uStack_20dc = 0;
      piStack_20c4 = (int *)uVar3;
      FUN_00405eb0(local_2034,0,0xffffffff);
      local_8._1_3_ = (uint3)((uint)local_8 >> 8);
      local_8._0_1_ = 1;
      FUN_00438060();
      local_8._0_1_ = 4;
      piStack_20c4 = (int *)local_208c;
      psStack_20c8 = (short *)0x818a2a;
      FUN_00452dc0();
      local_8._0_1_ = 5;
      piStack_20c4 = (int *)local_208c;
      psStack_20c8 = (short *)local_206c;
      pcStack_20cc = (char *)(local_205c + 0x3c);
      uStack_20d0 = 0x818a4b;
      FUN_0042f990();
      local_8._0_1_ = 4;
      piStack_20c4 = (int *)local_208c;
      psStack_20c8 = (short *)0x818a5b;
      FUN_0044cb00();
      local_8._0_1_ = 1;
      psStack_20c8 = (short *)0x818a67;
      piStack_20c4 = (int *)local_20ac;
      FUN_0044cb00();
      piStack_20c4 = (int *)0x0;
      psStack_20c8 = (short *)&DAT_00c2e7f0;
      pcStack_20cc = "j";
      FUN_00406360();
      piStack_20c4 = (int *)0x0;
      psStack_20c8 = (short *)&DAT_00c2e7f4;
      pcStack_20cc = (char *)0x818a8b;
      FUN_00406360();
      in_ECX = local_2058;
    }
    else {
      if (local_2064 == 0x5013) {
        local_8 = (uint)local_8._1_3_ << 8;
        if (7 < local_2038) {
                    /* WARNING: Subroutine does not return */
          piStack_20c4 = (int *)0x818af3;
          FUN_006f04e0();
        }
        local_2038 = 7;
        local_203c = 0;
        local_204c = 0;
        local_8 = 0xffffffff;
        if (7 < local_201c) {
                    /* WARNING: Subroutine does not return */
          piStack_20c4 = (int *)0x818b27;
          FUN_006f04e0();
        }
        goto LAB_00818b8b;
      }
      piStack_20c4 = local_2060;
      psStack_20c8 = (short *)0x818923;
      (**(code **)(*in_ECX + 0x24))();
    }
  }
  local_8 = (uint)local_8._1_3_ << 8;
  if (7 < local_2038) {
                    /* WARNING: Subroutine does not return */
    piStack_20c4 = (int *)0x818b4e;
    FUN_006f04e0();
  }
  local_2038 = 7;
  local_203c = 0;
  local_204c = 0;
  local_8 = 0xffffffff;
  if (7 < local_201c) {
                    /* WARNING: Subroutine does not return */
    piStack_20c4 = (int *)0x818b82;
    FUN_006f04e0();
  }
LAB_00818b8b:
  local_8 = 0xffffffff;
  local_2030 = 0;
  local_2038 = 7;
  local_203c = 0;
  local_204c = 0;
  local_2020 = 0;
  local_201c = 7;
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00818850 : PUSH EBP
00818851 : MOV EBP,ESP
00818853 : PUSH -0x1
00818855 : PUSH 0xb48944
0081885a : MOV EAX,FS:[0x0]
00818860 : PUSH EAX
00818861 : MOV EAX,0x20a0
00818866 : CALL 0x0063b780
0081886b : MOV EAX,[0x00d66fa0]
00818870 : XOR EAX,EBP
00818872 : MOV dword ptr [EBP + -0x14],EAX
00818875 : PUSH EBX
00818876 : PUSH ESI
00818877 : PUSH EDI
00818878 : PUSH EAX
00818879 : LEA EAX,[EBP + -0xc]
0081887c : MOV FS:[0x0],EAX
00818882 : MOV EAX,dword ptr [EBP + 0x8]
00818885 : MOV EDI,ECX
00818887 : MOV dword ptr [EBP + 0xffffdfa8],EAX
0081888d : MOV EAX,0x7
00818892 : XOR EBX,EBX
00818894 : XOR ECX,ECX
00818896 : MOV dword ptr [EBP + 0xffffdfac],EDI
0081889c : MOV dword ptr [EBP + 0xffffdfe8],EAX
008188a2 : MOV dword ptr [EBP + 0xffffdfe4],EBX
008188a8 : MOV word ptr [EBP + 0xffffdfd4],CX
008188af : MOV dword ptr [EBP + -0x4],EBX
008188b2 : XOR EDX,EDX
008188b4 : MOV dword ptr [EBP + 0xffffdfcc],EAX
008188ba : MOV dword ptr [EBP + 0xffffdfc8],EBX
008188c0 : MOV word ptr [EBP + 0xffffdfb8],DX
008188c7 : MOV byte ptr [EBP + -0x4],0x1
008188cb : JMP 0x008188d0
008188d0 : MOV EAX,dword ptr [EDI + 0x24]
008188d3 : CMP EAX,dword ptr [EDI + 0x20]
008188d6 : JNC 0x00818b32
008188dc : MOV EDX,dword ptr [EDI]
008188de : MOV EDX,dword ptr [EDX + 0x1c]
008188e1 : LEA EAX,[EBP + 0xffffdfa0]
008188e7 : PUSH EAX
008188e8 : MOV ECX,EDI
008188ea : CALL EDX
008188ec : TEST AL,AL
008188ee : JZ 0x00818b32
008188f4 : MOV EAX,dword ptr [EBP + 0xffffdfa0]
008188fa : SUB EAX,0x5011
008188ff : JZ 0x00818a98
00818905 : SUB EAX,0x1
00818908 : JZ 0x00818925
0081890a : SUB EAX,0x1
0081890d : JZ 0x00818ad7
00818913 : MOV ECX,dword ptr [EBP + 0xffffdfa4]
00818919 : MOV EAX,dword ptr [EDI]
0081891b : MOV EDX,dword ptr [EAX + 0x24]
0081891e : PUSH ECX
0081891f : MOV ECX,EDI
00818921 : CALL EDX
00818923 : JMP 0x008188d0
00818925 : MOV EAX,[0x01725270]
0081892a : SHR EAX,0x3
0081892d : MOV ECX,0x0
00818932 : AND EAX,0x1
00818935 : SETZ CL
00818938 : PUSH ECX
00818939 : PUSH EBX
0081893a : PUSH 0xbf1a4a
0081893f : PUSH 0x10
00818941 : CALL 0x006f0760
00818946 : ADD ESP,0x10
00818949 : MOV dword ptr [EBP + 0xffffdfb0],EAX
0081894f : MOV byte ptr [EBP + -0x4],0x2
00818953 : CMP EAX,EBX
00818955 : JZ 0x0081895f
00818957 : PUSH EAX
00818958 : CALL 0x004540e0
0081895d : MOV EBX,EAX
0081895f : MOV byte ptr [EBP + -0x4],0x1
00818963 : XOR ESI,ESI
00818965 : JMP 0x00818976
00818970 : MOV EDI,dword ptr [EBP + 0xffffdfac]
00818976 : LEA EDX,[EBP + 0xffffdfec]
0081897c : PUSH EDX
0081897d : CALL 0x0070d080
00818982 : LEA EAX,[EBP + 0xffffdfec]
00818988 : LEA EDX,[EAX + 0x2]
0081898b : JMP 0x00818990
00818990 : MOV CX,word ptr [EAX]
00818993 : ADD EAX,0x2
00818996 : TEST CX,CX
00818999 : JNZ 0x00818990
0081899b : SUB EAX,EDX
0081899d : SAR EAX,0x1
0081899f : PUSH EAX
008189a0 : LEA EAX,[EBP + 0xffffdfec]
008189a6 : PUSH EAX
008189a7 : LEA ECX,[EBP + 0xffffdfb4]
008189ad : CALL 0x00406360
008189b2 : MOV ECX,dword ptr [0x017248cc]
008189b8 : CMP dword ptr [ECX + 0x90],ESI
008189be : JNZ 0x008189cd
008189c0 : LEA EDX,[EBP + 0xffffdfb4]
008189c6 : PUSH EDX
008189c7 : PUSH EBX
008189c8 : CALL 0x00453bb0
008189cd : INC ESI
008189ce : CMP ESI,0xc
008189d1 : JL 0x00818970
008189d3 : PUSH EBX
008189d4 : SUB ESP,0x1c
008189d7 : MOV ECX,ESP
008189d9 : MOV dword ptr [EBP + 0xffffdfb0],ESP
008189df : XOR EAX,EAX
008189e1 : PUSH -0x1
008189e3 : PUSH EAX
008189e4 : LEA EDX,[EBP + 0xffffdfd0]
008189ea : MOV dword ptr [ECX + 0x18],0x7
008189f1 : MOV dword ptr [ECX + 0x14],0x0
008189f8 : PUSH EDX
008189f9 : MOV word ptr [ECX + 0x4],AX
008189fd : CALL 0x00405eb0
00818a02 : MOV byte ptr [EBP + -0x4],0x3
00818a06 : MOV byte ptr [EBP + -0x4],0x1
00818a0a : LEA ESI,[EBP + 0xffffdf58]
00818a10 : CALL 0x00438060
00818a15 : ADD ESP,0x20
00818a18 : MOV byte ptr [EBP + -0x4],0x4
00818a1c : LEA ECX,[EBP + 0xffffdf78]
00818a22 : PUSH ECX
00818a23 : MOV EDI,EAX
00818a25 : CALL 0x00452dc0
00818a2a : MOV byte ptr [EBP + -0x4],0x5
00818a2e : MOV ECX,dword ptr [EBP + 0xffffdfa8]
00818a34 : LEA EDX,[EBP + 0xffffdf78]
00818a3a : PUSH EDX
00818a3b : LEA EAX,[EBP + 0xffffdf98]
00818a41 : PUSH EAX
00818a42 : ADD ECX,0x3c
00818a45 : PUSH ECX
00818a46 : CALL 0x0042f990
00818a4b : MOV byte ptr [EBP + -0x4],0x4
00818a4f : LEA EDX,[EBP + 0xffffdf78]
00818a55 : PUSH EDX
00818a56 : CALL 0x0044cb00
00818a5b : MOV byte ptr [EBP + -0x4],0x1
00818a5f : MOV EAX,ESI
00818a61 : PUSH EAX
00818a62 : CALL 0x0044cb00
00818a67 : PUSH 0x0
00818a69 : PUSH 0xc2e7f0
00818a6e : LEA ECX,[EBP + 0xffffdfd0]
00818a74 : CALL 0x00406360
00818a79 : PUSH 0x0
00818a7b : PUSH 0xc2e7f4
00818a80 : LEA ECX,[EBP + 0xffffdfb4]
00818a86 : CALL 0x00406360
00818a8b : MOV EDI,dword ptr [EBP + 0xffffdfac]
00818a91 : XOR EBX,EBX
00818a93 : JMP 0x008188d0
00818a98 : LEA ECX,[EBP + 0xffffdfec]
00818a9e : PUSH ECX
00818a9f : MOV ECX,EDI
00818aa1 : CALL 0x0070d320
00818aa6 : LEA EAX,[EBP + 0xffffdfec]
00818aac : LEA EDX,[EAX + 0x2]
00818aaf : NOP
00818ab0 : MOV CX,word ptr [EAX]
00818ab3 : ADD EAX,0x2
00818ab6 : CMP CX,BX
00818ab9 : JNZ 0x00818ab0
00818abb : SUB EAX,EDX
00818abd : SAR EAX,0x1
00818abf : PUSH EAX
00818ac0 : LEA EDX,[EBP + 0xffffdfec]
00818ac6 : PUSH EDX
00818ac7 : LEA ECX,[EBP + 0xffffdfd0]
00818acd : CALL 0x00406360
00818ad2 : JMP 0x008188d0
00818ad7 : MOV byte ptr [EBP + -0x4],0x0
00818adb : MOV ESI,0x8
00818ae0 : CMP dword ptr [EBP + 0xffffdfcc],ESI
00818ae6 : JC 0x00818af3
00818ae8 : MOV ECX,dword ptr [EBP + 0xffffdfb8]
00818aee : CALL 0x006f04e0
00818af3 : MOV EDI,0x7
00818af8 : XOR EAX,EAX
00818afa : MOV dword ptr [EBP + 0xffffdfcc],EDI
00818b00 : MOV dword ptr [EBP + 0xffffdfc8],EBX
00818b06 : MOV word ptr [EBP + 0xffffdfb8],AX
00818b0d : MOV dword ptr [EBP + -0x4],0xffffffff
00818b14 : CMP dword ptr [EBP + 0xffffdfe8],ESI
00818b1a : JC 0x00818b27
00818b1c : MOV ECX,dword ptr [EBP + 0xffffdfd4]
00818b22 : CALL 0x006f04e0
00818b27 : XOR ECX,ECX
00818b29 : MOV word ptr [EBP + 0xffffdfd4],CX
00818b30 : JMP 0x00818b8b
00818b32 : MOV byte ptr [EBP + -0x4],0x0
00818b36 : MOV ESI,0x8
00818b3b : CMP dword ptr [EBP + 0xffffdfcc],ESI
00818b41 : JC 0x00818b4e
00818b43 : MOV ECX,dword ptr [EBP + 0xffffdfb8]
00818b49 : CALL 0x006f04e0
00818b4e : MOV EDI,0x7
00818b53 : XOR EDX,EDX
00818b55 : MOV dword ptr [EBP + 0xffffdfcc],EDI
00818b5b : MOV dword ptr [EBP + 0xffffdfc8],EBX
00818b61 : MOV word ptr [EBP + 0xffffdfb8],DX
00818b68 : MOV dword ptr [EBP + -0x4],0xffffffff
00818b6f : CMP dword ptr [EBP + 0xffffdfe8],ESI
00818b75 : JC 0x00818b82
00818b77 : MOV ECX,dword ptr [EBP + 0xffffdfd4]
00818b7d : CALL 0x006f04e0
00818b82 : XOR EAX,EAX
00818b84 : MOV word ptr [EBP + 0xffffdfd4],AX
00818b8b : MOV dword ptr [EBP + 0xffffdfe4],EBX
00818b91 : MOV dword ptr [EBP + 0xffffdfe8],EDI
00818b97 : MOV ECX,dword ptr [EBP + -0xc]
00818b9a : MOV dword ptr FS:[0x0],ECX
00818ba1 : POP ECX
00818ba2 : POP EDI
00818ba3 : POP ESI
00818ba4 : POP EBX
00818ba5 : MOV ECX,dword ptr [EBP + -0x14]
00818ba8 : XOR ECX,EBP
00818baa : CALL 0x00633e6b
00818baf : MOV ESP,EBP
00818bb1 : POP EBP
00818bb2 : RET 0x4

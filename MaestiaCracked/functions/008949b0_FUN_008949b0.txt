PROGRAM  : Maestia.exe
FUNCTION : FUN_008949b0
ENTRY    : 008949b0
BODY     : [[008949b0, 00894e32]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008949b0(wchar_t *param_1)

{
  wchar_t wVar1;
  short sVar2;
  uint uVar3;
  wchar_t *pwVar4;
  undefined4 uVar5;
  wchar_t ****ppppwVar6;
  int *in_ECX;
  int iVar7;
  uint local_894;
  wchar_t *local_888;
  undefined1 local_884 [4];
  wchar_t ***local_880 [4];
  undefined4 local_870;
  uint local_86c;
  undefined1 local_868 [4];
  wchar_t ***local_864 [4];
  undefined4 local_854;
  uint local_850;
  wchar_t ***local_848 [4];
  undefined4 local_838;
  uint local_834;
  wchar_t ***local_82c [4];
  undefined4 local_81c;
  uint local_818;
  wchar_t local_814 [512];
  wchar_t local_414 [512];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4e0b1;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_14 = uVar3;
  ExceptionList = &local_10;
  pwVar4 = param_1;
  do {
    wVar1 = *pwVar4;
    pwVar4 = pwVar4 + 1;
  } while (wVar1 != L'\0');
  if ((int)pwVar4 - (int)(param_1 + 1) >> 1 != 0) {
    local_814[0] = L'\0';
    wVar1 = *param_1;
    local_888 = param_1;
    while (wVar1 != L'\0') {
      if (*local_888 == L'`') {
        local_888 = local_888 + 1;
        wVar1 = *local_888;
        if (wVar1 == L'C') {
          local_82c[0] = (wchar_t ***)((uint)local_82c[0] & 0xffff0000);
          local_818 = 7;
          local_81c = 0;
          FUN_00406360(&DAT_00c46564,0);
          local_8 = 0;
          FUN_00405eb0(in_ECX + 3,0,0xffffffff);
          sVar2 = (**(code **)(*in_ECX + 0x1e4))(uVar3);
          if (sVar2 == 2) {
            uVar5 = FUN_00824120(DAT_0172491c);
            local_8._0_1_ = 1;
            FUN_00405eb0(uVar5,0,0xffffffff);
            local_8 = (uint)local_8._1_3_ << 8;
            if (7 < local_894) {
                    /* WARNING: Subroutine does not return */
              FUN_006f04e0();
            }
            local_894 = 7;
          }
          ppppwVar6 = (wchar_t ****)local_82c[0];
          if (local_818 < 8) {
            ppppwVar6 = local_82c;
          }
          _wcscpy_s(local_414,0x200,(wchar_t *)ppppwVar6);
          _wcscat_s(local_814,0x200,local_414);
          local_8 = 0xffffffff;
          if (7 < local_818) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          local_818 = 7;
          local_81c = 0;
          local_82c[0] = (wchar_t ***)((uint)local_82c[0] & 0xffff0000);
        }
        else if (wVar1 == L'M') {
          local_848[0] = (wchar_t ***)((uint)local_848[0] & 0xffff0000);
          local_834 = 7;
          local_838 = 0;
          FUN_00405eb0(*(int *)(DAT_0172491c + 0x17c) + 0xc,0,0xffffffff);
          local_8 = 2;
          ppppwVar6 = (wchar_t ****)local_848[0];
          if (local_834 < 8) {
            ppppwVar6 = local_848;
          }
          _wcscpy_s(local_414,0x200,(wchar_t *)ppppwVar6);
          _wcscat_s(local_814,0x200,local_414);
          local_8 = 0xffffffff;
          if (7 < local_834) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          local_834 = 7;
          local_838 = 0;
          local_848[0] = (wchar_t ***)((uint)local_848[0] & 0xffff0000);
        }
        else if (wVar1 == L'A') {
          FUN_00406460(&DAT_00c46568);
          local_8 = 3;
          FUN_00404730();
          FUN_00405c00(local_884);
          ppppwVar6 = (wchar_t ****)local_880[0];
          if (local_86c < 8) {
            ppppwVar6 = local_880;
          }
          _wcscpy_s(local_414,0x200,(wchar_t *)ppppwVar6);
          _wcscat_s(local_814,0x200,local_414);
          local_8 = 0xffffffff;
          if (7 < local_86c) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          local_86c = 7;
          local_870 = 0;
          local_880[0] = (wchar_t ***)((uint)local_880[0] & 0xffff0000);
        }
        else if (wVar1 == L'E') {
          FUN_00406460(&DAT_00c46598);
          local_8 = 4;
          FUN_00404730();
          FUN_00405c00(local_868);
          ppppwVar6 = (wchar_t ****)local_864[0];
          if (local_850 < 8) {
            ppppwVar6 = local_864;
          }
          _wcscpy_s(local_414,0x200,(wchar_t *)ppppwVar6);
          _wcscat_s(local_814,0x200,local_414);
          local_8 = 0xffffffff;
          if (7 < local_850) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          local_850 = 7;
          local_854 = 0;
          local_864[0] = (wchar_t ***)((uint)local_864[0] & 0xffff0000);
        }
      }
      else {
        _wcsncat_s(local_814,0x200,local_888,1);
      }
      local_888 = local_888 + 1;
      wVar1 = *local_888;
    }
    iVar7 = (int)local_814 - (int)param_1;
    do {
      wVar1 = *(wchar_t *)(iVar7 + (int)param_1);
      *param_1 = wVar1;
      param_1 = param_1 + 1;
    } while (wVar1 != L'\0');
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008949b0 : PUSH EBP
008949b1 : MOV EBP,ESP
008949b3 : PUSH -0x1
008949b5 : PUSH 0xb4e0b1
008949ba : MOV EAX,FS:[0x0]
008949c0 : PUSH EAX
008949c1 : SUB ESP,0x89c
008949c7 : MOV EAX,[0x00d66fa0]
008949cc : XOR EAX,EBP
008949ce : MOV dword ptr [EBP + -0x10],EAX
008949d1 : PUSH EBX
008949d2 : PUSH ESI
008949d3 : PUSH EDI
008949d4 : PUSH EAX
008949d5 : LEA EAX,[EBP + -0xc]
008949d8 : MOV FS:[0x0],EAX
008949de : MOV ESI,dword ptr [EBP + 0x8]
008949e1 : MOV EDI,ECX
008949e3 : MOV EAX,ESI
008949e5 : MOV dword ptr [EBP + 0xfffff778],EDI
008949eb : MOV dword ptr [EBP + 0xfffff774],ESI
008949f1 : LEA EDX,[EAX + 0x2]
008949f4 : XOR EBX,EBX
008949f6 : MOV CX,word ptr [EAX]
008949f9 : ADD EAX,0x2
008949fc : CMP CX,BX
008949ff : JNZ 0x008949f6
00894a01 : SUB EAX,EDX
00894a03 : SAR EAX,0x1
00894a05 : JZ 0x00894e15
00894a0b : XOR EAX,EAX
00894a0d : MOV word ptr [EBP + 0xfffff7f0],AX
00894a14 : MOV EAX,ESI
00894a16 : MOV dword ptr [EBP + 0xfffff77c],EAX
00894a1c : CMP word ptr [ESI],BX
00894a1f : JZ 0x00894dfc
00894a25 : MOV ESI,0x8
00894a2a : LEA EBX,[EBX]
00894a30 : CMP word ptr [EAX],0x60
00894a34 : JNZ 0x00894dc9
00894a3a : ADD EAX,0x2
00894a3d : MOV dword ptr [EBP + 0xfffff77c],EAX
00894a43 : MOVZX EAX,word ptr [EAX]
00894a46 : CMP AX,0x43
00894a4a : JNZ 0x00894b79
00894a50 : XOR ECX,ECX
00894a52 : PUSH EBX
00894a53 : MOV word ptr [EBP + 0xfffff7d8],CX
00894a5a : PUSH 0xc46564
00894a5f : LEA ECX,[EBP + 0xfffff7d4]
00894a65 : MOV dword ptr [EBP + 0xfffff7ec],0x7
00894a6f : MOV dword ptr [EBP + 0xfffff7e8],EBX
00894a75 : CALL 0x00406360
00894a7a : MOV dword ptr [EBP + -0x4],EBX
00894a7d : PUSH -0x1
00894a7f : PUSH EBX
00894a80 : LEA EDX,[EDI + 0xc]
00894a83 : PUSH EDX
00894a84 : LEA ECX,[EBP + 0xfffff7d4]
00894a8a : CALL 0x00405eb0
00894a8f : MOV EAX,dword ptr [EDI]
00894a91 : MOV EDX,dword ptr [EAX + 0x1e4]
00894a97 : MOV ECX,EDI
00894a99 : CALL EDX
00894a9b : CMP AX,0x2
00894a9f : JNZ 0x00894b00
00894aa1 : MOV EAX,[0x0172491c]
00894aa6 : PUSH EAX
00894aa7 : LEA EDX,[EBP + 0xfffff7d4]
00894aad : LEA EDI,[EBP + 0xfffff758]
00894ab3 : CALL 0x00824120
00894ab8 : MOV byte ptr [EBP + -0x4],0x1
00894abc : PUSH -0x1
00894abe : PUSH EBX
00894abf : PUSH EAX
00894ac0 : LEA ECX,[EBP + 0xfffff7d4]
00894ac6 : CALL 0x00405eb0
00894acb : MOV byte ptr [EBP + -0x4],BL
00894ace : CMP dword ptr [EBP + 0xfffff770],ESI
00894ad4 : JC 0x00894ae1
00894ad6 : MOV ECX,dword ptr [EBP + 0xfffff75c]
00894adc : CALL 0x006f04e0
00894ae1 : MOV EDI,dword ptr [EBP + 0xfffff778]
00894ae7 : XOR ECX,ECX
00894ae9 : MOV dword ptr [EBP + 0xfffff770],0x7
00894af3 : MOV dword ptr [EBP + 0xfffff76c],EBX
00894af9 : MOV word ptr [EBP + 0xfffff75c],CX
00894b00 : MOV EAX,dword ptr [EBP + 0xfffff7d8]
00894b06 : CMP dword ptr [EBP + 0xfffff7ec],ESI
00894b0c : JNC 0x00894b14
00894b0e : LEA EAX,[EBP + 0xfffff7d8]
00894b14 : PUSH EAX
00894b15 : LEA EDX,[EBP + 0xfffffbf0]
00894b1b : PUSH 0x200
00894b20 : PUSH EDX
00894b21 : CALL 0x0063481b
00894b26 : LEA EAX,[EBP + 0xfffffbf0]
00894b2c : PUSH EAX
00894b2d : LEA ECX,[EBP + 0xfffff7f0]
00894b33 : PUSH 0x200
00894b38 : PUSH ECX
00894b39 : CALL 0x006362c1
00894b3e : ADD ESP,0x18
00894b41 : MOV dword ptr [EBP + -0x4],0xffffffff
00894b48 : CMP dword ptr [EBP + 0xfffff7ec],ESI
00894b4e : JC 0x00894b5b
00894b50 : MOV ECX,dword ptr [EBP + 0xfffff7d8]
00894b56 : CALL 0x006f04e0
00894b5b : XOR EDX,EDX
00894b5d : MOV dword ptr [EBP + 0xfffff7ec],0x7
00894b67 : MOV dword ptr [EBP + 0xfffff7e8],EBX
00894b6d : MOV word ptr [EBP + 0xfffff7d8],DX
00894b74 : JMP 0x00894de0
00894b79 : CMP AX,0x4d
00894b7d : JNZ 0x00894c3c
00894b83 : MOV EAX,[0x0172491c]
00894b88 : MOV EAX,dword ptr [EAX + 0x17c]
00894b8e : PUSH -0x1
00894b90 : XOR ECX,ECX
00894b92 : ADD EAX,0xc
00894b95 : PUSH EBX
00894b96 : MOV word ptr [EBP + 0xfffff7bc],CX
00894b9d : MOV EDI,0x7
00894ba2 : PUSH EAX
00894ba3 : LEA ECX,[EBP + 0xfffff7b8]
00894ba9 : MOV dword ptr [EBP + 0xfffff7d0],EDI
00894baf : MOV dword ptr [EBP + 0xfffff7cc],EBX
00894bb5 : CALL 0x00405eb0
00894bba : MOV dword ptr [EBP + -0x4],0x2
00894bc1 : MOV EAX,dword ptr [EBP + 0xfffff7bc]
00894bc7 : CMP dword ptr [EBP + 0xfffff7d0],ESI
00894bcd : JNC 0x00894bd5
00894bcf : LEA EAX,[EBP + 0xfffff7bc]
00894bd5 : PUSH EAX
00894bd6 : LEA EDX,[EBP + 0xfffffbf0]
00894bdc : PUSH 0x200
00894be1 : PUSH EDX
00894be2 : CALL 0x0063481b
00894be7 : LEA EAX,[EBP + 0xfffffbf0]
00894bed : PUSH EAX
00894bee : LEA ECX,[EBP + 0xfffff7f0]
00894bf4 : PUSH 0x200
00894bf9 : PUSH ECX
00894bfa : CALL 0x006362c1
00894bff : ADD ESP,0x18
00894c02 : MOV dword ptr [EBP + -0x4],0xffffffff
00894c09 : CMP dword ptr [EBP + 0xfffff7d0],ESI
00894c0f : JC 0x00894c1c
00894c11 : MOV ECX,dword ptr [EBP + 0xfffff7bc]
00894c17 : CALL 0x006f04e0
00894c1c : XOR EDX,EDX
00894c1e : MOV dword ptr [EBP + 0xfffff7d0],EDI
00894c24 : MOV EDI,dword ptr [EBP + 0xfffff778]
00894c2a : MOV dword ptr [EBP + 0xfffff7cc],EBX
00894c30 : MOV word ptr [EBP + 0xfffff7bc],DX
00894c37 : JMP 0x00894de0
00894c3c : CMP AX,0x41
00894c40 : JNZ 0x00894d04
00894c46 : PUSH 0xc46568
00894c4b : LEA ECX,[EBP + 0xfffff780]
00894c51 : CALL 0x00406460
00894c56 : MOV dword ptr [EBP + -0x4],0x3
00894c5d : MOV ECX,EDI
00894c5f : CALL 0x00404730
00894c64 : MOVZX EAX,AX
00894c67 : CMP AX,BX
00894c6a : JNZ 0x00894c7a
00894c6c : LEA EAX,[EBP + 0xfffff780]
00894c72 : PUSH EAX
00894c73 : MOV EDX,0xc4656c
00894c78 : JMP 0x00894c86
00894c7a : LEA ECX,[EBP + 0xfffff780]
00894c80 : PUSH ECX
00894c81 : MOV EDX,0xc46584
00894c86 : CALL 0x00405c00
00894c8b : MOV EAX,dword ptr [EBP + 0xfffff784]
00894c91 : CMP dword ptr [EBP + 0xfffff798],ESI
00894c97 : JNC 0x00894c9f
00894c99 : LEA EAX,[EBP + 0xfffff784]
00894c9f : PUSH EAX
00894ca0 : LEA EDX,[EBP + 0xfffffbf0]
00894ca6 : PUSH 0x200
00894cab : PUSH EDX
00894cac : CALL 0x0063481b
00894cb1 : LEA EAX,[EBP + 0xfffffbf0]
00894cb7 : PUSH EAX
00894cb8 : LEA ECX,[EBP + 0xfffff7f0]
00894cbe : PUSH 0x200
00894cc3 : PUSH ECX
00894cc4 : CALL 0x006362c1
00894cc9 : ADD ESP,0x18
00894ccc : MOV dword ptr [EBP + -0x4],0xffffffff
00894cd3 : CMP dword ptr [EBP + 0xfffff798],ESI
00894cd9 : JC 0x00894ce6
00894cdb : MOV ECX,dword ptr [EBP + 0xfffff784]
00894ce1 : CALL 0x006f04e0
00894ce6 : XOR EDX,EDX
00894ce8 : MOV dword ptr [EBP + 0xfffff798],0x7
00894cf2 : MOV dword ptr [EBP + 0xfffff794],EBX
00894cf8 : MOV word ptr [EBP + 0xfffff784],DX
00894cff : JMP 0x00894de0
00894d04 : CMP AX,0x45
00894d08 : JNZ 0x00894de0
00894d0e : PUSH 0xc46598
00894d13 : LEA ECX,[EBP + 0xfffff79c]
00894d19 : CALL 0x00406460
00894d1e : MOV dword ptr [EBP + -0x4],0x4
00894d25 : MOV ECX,EDI
00894d27 : CALL 0x00404730
00894d2c : MOVZX EAX,AX
00894d2f : CMP AX,BX
00894d32 : JNZ 0x00894d42
00894d34 : LEA EAX,[EBP + 0xfffff79c]
00894d3a : PUSH EAX
00894d3b : MOV EDX,0xc4659c
00894d40 : JMP 0x00894d4e
00894d42 : LEA ECX,[EBP + 0xfffff79c]
00894d48 : PUSH ECX
00894d49 : MOV EDX,0xc465b0
00894d4e : CALL 0x00405c00
00894d53 : MOV EAX,dword ptr [EBP + 0xfffff7a0]
00894d59 : CMP dword ptr [EBP + 0xfffff7b4],ESI
00894d5f : JNC 0x00894d67
00894d61 : LEA EAX,[EBP + 0xfffff7a0]
00894d67 : PUSH EAX
00894d68 : LEA EDX,[EBP + 0xfffffbf0]
00894d6e : PUSH 0x200
00894d73 : PUSH EDX
00894d74 : CALL 0x0063481b
00894d79 : LEA EAX,[EBP + 0xfffffbf0]
00894d7f : PUSH EAX
00894d80 : LEA ECX,[EBP + 0xfffff7f0]
00894d86 : PUSH 0x200
00894d8b : PUSH ECX
00894d8c : CALL 0x006362c1
00894d91 : ADD ESP,0x18
00894d94 : MOV dword ptr [EBP + -0x4],0xffffffff
00894d9b : CMP dword ptr [EBP + 0xfffff7b4],ESI
00894da1 : JC 0x00894dae
00894da3 : MOV ECX,dword ptr [EBP + 0xfffff7a0]
00894da9 : CALL 0x006f04e0
00894dae : XOR EDX,EDX
00894db0 : MOV dword ptr [EBP + 0xfffff7b4],0x7
00894dba : MOV dword ptr [EBP + 0xfffff7b0],EBX
00894dc0 : MOV word ptr [EBP + 0xfffff7a0],DX
00894dc7 : JMP 0x00894de0
00894dc9 : PUSH 0x1
00894dcb : PUSH EAX
00894dcc : LEA EAX,[EBP + 0xfffff7f0]
00894dd2 : PUSH 0x200
00894dd7 : PUSH EAX
00894dd8 : CALL 0x0063900a
00894ddd : ADD ESP,0x10
00894de0 : ADD dword ptr [EBP + 0xfffff77c],0x2
00894de7 : MOV EAX,dword ptr [EBP + 0xfffff77c]
00894ded : CMP word ptr [EAX],BX
00894df0 : JNZ 0x00894a30
00894df6 : MOV ESI,dword ptr [EBP + 0xfffff774]
00894dfc : LEA EDX,[EBP + 0xfffff7f0]
00894e02 : MOV EAX,ESI
00894e04 : SUB EDX,ESI
00894e06 : MOVZX ECX,word ptr [EDX + EAX*0x1]
00894e0a : MOV word ptr [EAX],CX
00894e0d : ADD EAX,0x2
00894e10 : CMP CX,BX
00894e13 : JNZ 0x00894e06
00894e15 : MOV ECX,dword ptr [EBP + -0xc]
00894e18 : MOV dword ptr FS:[0x0],ECX
00894e1f : POP ECX
00894e20 : POP EDI
00894e21 : POP ESI
00894e22 : POP EBX
00894e23 : MOV ECX,dword ptr [EBP + -0x10]
00894e26 : XOR ECX,EBP
00894e28 : CALL 0x00633e6b
00894e2d : MOV ESP,EBP
00894e2f : POP EBP
00894e30 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_00481620
ENTRY    : 00481620
BODY     : [[00481620, 00481839]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00481620(void)

{
  uint in_EAX;
  int *piVar1;
  int in_ECX;
  code *pcVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  
  if (0xe < in_EAX) {
    in_EAX = 0;
  }
  piVar1 = *(int **)(in_ECX + 0xf0);
  if (*(char *)(in_ECX + 0x12) == '\0') {
    if ((*(byte *)(in_ECX + 0xc) & 2) != 0) {
      (**(code **)(*piVar1 + 0xe4))(piVar1,0xab,(&DAT_00d72d40)[in_EAX * 5]);
      (**(code **)(**(int **)(in_ECX + 0xf0) + 0xe4))
                (*(int **)(in_ECX + 0xf0),0x13,(&DAT_00d72d44)[in_EAX * 5]);
      (**(code **)(**(int **)(in_ECX + 0xf0) + 0xe4))
                (*(int **)(in_ECX + 0xf0),0x14,(&DAT_00d72d48)[in_EAX * 5]);
      if (*(char *)(in_ECX + 0xf9) != '\0') {
        return;
      }
      piVar1 = *(int **)(in_ECX + 0xf0);
      if (in_EAX != 8) {
        (**(code **)(*piVar1 + 0xe4))(piVar1,0xa8,0xf);
        return;
      }
      (**(code **)(*piVar1 + 0xe4))(piVar1,0xa8,7);
      return;
    }
    pcVar2 = *(code **)(*piVar1 + 0xe4);
    uVar4 = (&DAT_00d72c88)[in_EAX * 3];
    uVar3 = 0xab;
  }
  else {
    if ((*(byte *)(in_ECX + 0xc) & 2) != 0) {
      (**(code **)(*piVar1 + 0xe4))(piVar1,0xce,1);
      (**(code **)(**(int **)(in_ECX + 0xf0) + 0xe4))
                (*(int **)(in_ECX + 0xf0),0xab,(&DAT_00d72d40)[in_EAX * 5]);
      (**(code **)(**(int **)(in_ECX + 0xf0) + 0xe4))
                (*(int **)(in_ECX + 0xf0),0xd1,(&DAT_00d72d40)[in_EAX * 5]);
      (**(code **)(**(int **)(in_ECX + 0xf0) + 0xe4))
                (*(int **)(in_ECX + 0xf0),0x13,(&DAT_00d72d44)[in_EAX * 5]);
      (**(code **)(**(int **)(in_ECX + 0xf0) + 0xe4))
                (*(int **)(in_ECX + 0xf0),0x14,(&DAT_00d72d48)[in_EAX * 5]);
      (**(code **)(**(int **)(in_ECX + 0xf0) + 0xe4))
                (*(int **)(in_ECX + 0xf0),0xcf,(&DAT_00d72d4c)[in_EAX * 5]);
      (**(code **)(**(int **)(in_ECX + 0xf0) + 0xe4))
                (*(int **)(in_ECX + 0xf0),0xd0,(&DAT_00d72d50)[in_EAX * 5]);
      return;
    }
    (**(code **)(*piVar1 + 0xe4))(piVar1,0xab,(&DAT_00d72c88)[in_EAX * 3]);
    piVar1 = *(int **)(in_ECX + 0xf0);
    pcVar2 = *(code **)(*piVar1 + 0xe4);
    uVar4 = 0;
    uVar3 = 0xce;
  }
  (*pcVar2)(piVar1,uVar3,uVar4);
  (**(code **)(**(int **)(in_ECX + 0xf0) + 0xe4))
            (*(int **)(in_ECX + 0xf0),0x13,(&DAT_00d72c8c)[in_EAX * 3]);
  (**(code **)(**(int **)(in_ECX + 0xf0) + 0xe4))
            (*(int **)(in_ECX + 0xf0),0x14,(&DAT_00d72c90)[in_EAX * 3]);
  return;
}



============================================================
DISASSEMBLY
============================================================
00481620 : PUSH ESI
00481621 : PUSH EDI
00481622 : MOV EDI,EAX
00481624 : MOV ESI,ECX
00481626 : CMP EDI,0xf
00481629 : JC 0x0048162d
0048162b : XOR EDI,EDI
0048162d : CMP byte ptr [ESI + 0x12],0x0
00481631 : MOV EAX,dword ptr [ESI + 0xf0]
00481637 : JZ 0x00481743
0048163d : TEST byte ptr [ESI + 0xc],0x2
00481641 : MOV ECX,dword ptr [EAX]
00481643 : JZ 0x0048170c
00481649 : MOV EDX,dword ptr [ECX + 0xe4]
0048164f : PUSH 0x1
00481651 : PUSH 0xce
00481656 : PUSH EAX
00481657 : CALL EDX
00481659 : MOV EAX,dword ptr [ESI + 0xf0]
0048165f : MOV ECX,dword ptr [EAX]
00481661 : LEA EDI,[EDI + EDI*0x4]
00481664 : ADD EDI,EDI
00481666 : MOV EDX,dword ptr [EDI + EDI*0x1 + 0xd72d40]
0048166d : ADD EDI,EDI
0048166f : PUSH EDX
00481670 : PUSH 0xab
00481675 : PUSH EAX
00481676 : MOV EAX,dword ptr [ECX + 0xe4]
0048167c : CALL EAX
0048167e : MOV EDX,dword ptr [EDI + 0xd72d40]
00481684 : MOV EAX,dword ptr [ESI + 0xf0]
0048168a : MOV ECX,dword ptr [EAX]
0048168c : PUSH EDX
0048168d : PUSH 0xd1
00481692 : PUSH EAX
00481693 : MOV EAX,dword ptr [ECX + 0xe4]
00481699 : CALL EAX
0048169b : MOV EDX,dword ptr [EDI + 0xd72d44]
004816a1 : MOV EAX,dword ptr [ESI + 0xf0]
004816a7 : MOV ECX,dword ptr [EAX]
004816a9 : PUSH EDX
004816aa : PUSH 0x13
004816ac : PUSH EAX
004816ad : MOV EAX,dword ptr [ECX + 0xe4]
004816b3 : CALL EAX
004816b5 : MOV EDX,dword ptr [EDI + 0xd72d48]
004816bb : MOV EAX,dword ptr [ESI + 0xf0]
004816c1 : MOV ECX,dword ptr [EAX]
004816c3 : PUSH EDX
004816c4 : PUSH 0x14
004816c6 : PUSH EAX
004816c7 : MOV EAX,dword ptr [ECX + 0xe4]
004816cd : CALL EAX
004816cf : MOV EDX,dword ptr [EDI + 0xd72d4c]
004816d5 : MOV EAX,dword ptr [ESI + 0xf0]
004816db : MOV ECX,dword ptr [EAX]
004816dd : PUSH EDX
004816de : PUSH 0xcf
004816e3 : PUSH EAX
004816e4 : MOV EAX,dword ptr [ECX + 0xe4]
004816ea : CALL EAX
004816ec : MOV EDX,dword ptr [EDI + 0xd72d50]
004816f2 : MOV ESI,dword ptr [ESI + 0xf0]
004816f8 : MOV ECX,dword ptr [ESI]
004816fa : MOV EAX,dword ptr [ECX + 0xe4]
00481700 : PUSH EDX
00481701 : PUSH 0xd0
00481706 : PUSH ESI
00481707 : CALL EAX
00481709 : POP EDI
0048170a : POP ESI
0048170b : RET
0048170c : LEA EDI,[EDI + EDI*0x2]
0048170f : ADD EDI,EDI
00481711 : MOV EDX,dword ptr [EDI + EDI*0x1 + 0xd72c88]
00481718 : ADD EDI,EDI
0048171a : PUSH EDX
0048171b : PUSH 0xab
00481720 : PUSH EAX
00481721 : MOV EAX,dword ptr [ECX + 0xe4]
00481727 : CALL EAX
00481729 : MOV EAX,dword ptr [ESI + 0xf0]
0048172f : MOV ECX,dword ptr [EAX]
00481731 : MOV EDX,dword ptr [ECX + 0xe4]
00481737 : PUSH 0x0
00481739 : PUSH 0xce
0048173e : JMP 0x00481800
00481743 : TEST byte ptr [ESI + 0xc],0x2
00481747 : JZ 0x004817e4
0048174d : MOV ECX,dword ptr [EAX]
0048174f : PUSH EBX
00481750 : LEA EBX,[EDI + EDI*0x4]
00481753 : ADD EBX,EBX
00481755 : MOV EDX,dword ptr [EBX + EBX*0x1 + 0xd72d40]
0048175c : ADD EBX,EBX
0048175e : PUSH EDX
0048175f : PUSH 0xab
00481764 : PUSH EAX
00481765 : MOV EAX,dword ptr [ECX + 0xe4]
0048176b : CALL EAX
0048176d : MOV EDX,dword ptr [EBX + 0xd72d44]
00481773 : MOV EAX,dword ptr [ESI + 0xf0]
00481779 : MOV ECX,dword ptr [EAX]
0048177b : PUSH EDX
0048177c : PUSH 0x13
0048177e : PUSH EAX
0048177f : MOV EAX,dword ptr [ECX + 0xe4]
00481785 : CALL EAX
00481787 : MOV EDX,dword ptr [EBX + 0xd72d48]
0048178d : MOV EAX,dword ptr [ESI + 0xf0]
00481793 : MOV ECX,dword ptr [EAX]
00481795 : PUSH EDX
00481796 : PUSH 0x14
00481798 : PUSH EAX
00481799 : MOV EAX,dword ptr [ECX + 0xe4]
0048179f : CALL EAX
004817a1 : CMP byte ptr [ESI + 0xf9],0x0
004817a8 : POP EBX
004817a9 : JNZ 0x00481837
004817af : MOV ESI,dword ptr [ESI + 0xf0]
004817b5 : CMP EDI,0x8
004817b8 : JNZ 0x004817cf
004817ba : MOV ECX,dword ptr [ESI]
004817bc : MOV EDX,dword ptr [ECX + 0xe4]
004817c2 : PUSH 0x7
004817c4 : PUSH 0xa8
004817c9 : PUSH ESI
004817ca : CALL EDX
004817cc : POP EDI
004817cd : POP ESI
004817ce : RET
004817cf : MOV EAX,dword ptr [ESI]
004817d1 : MOV ECX,dword ptr [EAX + 0xe4]
004817d7 : PUSH 0xf
004817d9 : PUSH 0xa8
004817de : PUSH ESI
004817df : CALL ECX
004817e1 : POP EDI
004817e2 : POP ESI
004817e3 : RET
004817e4 : MOV EDX,dword ptr [EAX]
004817e6 : MOV EDX,dword ptr [EDX + 0xe4]
004817ec : LEA EDI,[EDI + EDI*0x2]
004817ef : ADD EDI,EDI
004817f1 : MOV ECX,dword ptr [EDI + EDI*0x1 + 0xd72c88]
004817f8 : ADD EDI,EDI
004817fa : PUSH ECX
004817fb : PUSH 0xab
00481800 : PUSH EAX
00481801 : CALL EDX
00481803 : MOV EDX,dword ptr [EDI + 0xd72c8c]
00481809 : MOV EAX,dword ptr [ESI + 0xf0]
0048180f : MOV ECX,dword ptr [EAX]
00481811 : PUSH EDX
00481812 : PUSH 0x13
00481814 : PUSH EAX
00481815 : MOV EAX,dword ptr [ECX + 0xe4]
0048181b : CALL EAX
0048181d : MOV EDX,dword ptr [EDI + 0xd72c90]
00481823 : MOV ESI,dword ptr [ESI + 0xf0]
00481829 : MOV ECX,dword ptr [ESI]
0048182b : MOV EAX,dword ptr [ECX + 0xe4]
00481831 : PUSH EDX
00481832 : PUSH 0x14
00481834 : PUSH ESI
00481835 : CALL EAX
00481837 : POP EDI
00481838 : POP ESI
00481839 : RET

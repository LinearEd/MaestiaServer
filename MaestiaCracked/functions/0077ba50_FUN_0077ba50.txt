PROGRAM  : Maestia.exe
FUNCTION : FUN_0077ba50
ENTRY    : 0077ba50
BODY     : [[0077ba50, 0077ba90]]

============================================================
DECOMPILED C CODE
============================================================

undefined * FUN_0077ba50(void)

{
  undefined *puVar1;
  int in_ECX;
  
  if (*(int *)(in_ECX + 0x18) == 0) {
    *(undefined4 *)(in_ECX + 0x14) = 1;
    puVar1 = (undefined *)WaitForSingleObject(*(HANDLE *)(in_ECX + 8),0xffffffff);
    ResetEvent(*(HANDLE *)(in_ECX + 8));
    *(undefined4 *)(in_ECX + 0x14) = 0;
    return puVar1;
  }
  return &DAT_00ff00ff;
}



============================================================
DISASSEMBLY
============================================================
0077ba50 : PUSH ESI
0077ba51 : MOV ESI,ECX
0077ba53 : MOV EAX,dword ptr [ESI + 0x18]
0077ba56 : TEST EAX,EAX
0077ba58 : JNZ 0x0077ba88
0077ba5a : MOV ECX,dword ptr [ESI + 0x8]
0077ba5d : PUSH EDI
0077ba5e : PUSH -0x1
0077ba60 : PUSH ECX
0077ba61 : MOV dword ptr [ESI + 0x14],0x1
0077ba68 : CALL dword ptr [0x00b85100]
0077ba6e : MOV EDX,dword ptr [ESI + 0x8]
0077ba71 : PUSH EDX
0077ba72 : MOV EDI,EAX
0077ba74 : CALL dword ptr [0x00b851dc]
0077ba7a : MOV EAX,EDI
0077ba7c : POP EDI
0077ba7d : MOV dword ptr [ESI + 0x14],0x0
0077ba84 : POP ESI
0077ba85 : RET 0x4
0077ba88 : MOV EAX,0xff00ff
0077ba8d : POP ESI
0077ba8e : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_00565420
ENTRY    : 00565420
BODY     : [[00565420, 00565541]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00565420(undefined4 param_1,int param_2,uint param_3)

{
  uint *puVar1;
  int iVar2;
  int *piVar3;
  uint uVar4;
  uint *puVar5;
  int *in_ECX;
  int iVar6;
  uint uVar7;
  int iVar8;
  
  piVar3 = (int *)*in_ECX;
  if (piVar3 == (int *)0x0) {
    iVar8 = 8;
  }
  else {
    if ((uint)(*piVar3 * 5) <= piVar3[1] * 4 + 4U) goto LAB_0056545c;
    iVar8 = piVar3[1] * 2 + 2;
  }
  FUN_00564280(param_1,iVar8);
LAB_0056545c:
  piVar3 = (int *)*in_ECX;
  param_3 = param_3 & piVar3[1];
  *piVar3 = *piVar3 + 1;
  iVar8 = *in_ECX;
  puVar1 = (uint *)(param_3 * 0x10 + 8 + iVar8);
  if (*puVar1 == 0xfffffffe) {
    *puVar1 = 0xffffffff;
    FUN_0051c600(param_2);
    *(undefined1 *)(puVar1 + 3) = *(undefined1 *)(param_2 + 4);
    puVar1[1] = param_3;
    return;
  }
  uVar7 = param_3;
  do {
    uVar7 = uVar7 + 1 & *(uint *)(iVar8 + 4);
  } while (*(int *)(iVar8 + 8 + uVar7 * 0x10) != -2);
  iVar2 = uVar7 * 0x10 + 8 + iVar8;
  if (puVar1[1] != param_3) {
    iVar6 = puVar1[1] * 0x10;
    uVar4 = *(uint *)(iVar6 + 8 + iVar8);
    while (puVar5 = (uint *)(iVar6 + 8 + iVar8), uVar4 != param_3) {
      iVar6 = *puVar5 * 0x10;
      uVar4 = *(uint *)(iVar6 + 8 + iVar8);
    }
    if (iVar2 != 0) {
      FUN_00562ac0(puVar1);
    }
    *puVar5 = uVar7;
    FUN_0051bc20(param_2);
    *(undefined1 *)(puVar1 + 3) = *(undefined1 *)(param_2 + 4);
    puVar1[1] = param_3;
    *puVar1 = 0xffffffff;
    return;
  }
  if (iVar2 != 0) {
    FUN_00562ac0(puVar1);
  }
  FUN_0051bc20(param_2);
  *(undefined1 *)(puVar1 + 3) = *(undefined1 *)(param_2 + 4);
  puVar1[1] = param_3;
  *puVar1 = uVar7;
  return;
}



============================================================
DISASSEMBLY
============================================================
00565420 : PUSH EBX
00565421 : PUSH EBP
00565422 : PUSH ESI
00565423 : MOV ESI,ECX
00565425 : MOV EAX,dword ptr [ESI]
00565427 : PUSH EDI
00565428 : TEST EAX,EAX
0056542a : JNZ 0x00565435
0056542c : MOV EAX,dword ptr [ESP + 0x14]
00565430 : PUSH 0x8
00565432 : PUSH EAX
00565433 : JMP 0x00565457
00565435 : MOV ECX,dword ptr [EAX + 0x4]
00565438 : LEA EDX,[ECX*0x4 + 0x4]
0056543f : MOV ECX,dword ptr [EAX]
00565441 : LEA ECX,[ECX + ECX*0x4]
00565444 : CMP ECX,EDX
00565446 : JBE 0x0056545c
00565448 : MOV EDX,dword ptr [EAX + 0x4]
0056544b : MOV ECX,dword ptr [ESP + 0x14]
0056544f : LEA EAX,[EDX + EDX*0x1 + 0x2]
00565453 : PUSH EAX
00565454 : PUSH ECX
00565455 : MOV ECX,ESI
00565457 : CALL 0x00564280
0056545c : MOV EAX,dword ptr [ESI]
0056545e : MOV EDI,dword ptr [ESP + 0x1c]
00565462 : AND EDI,dword ptr [EAX + 0x4]
00565465 : INC dword ptr [EAX]
00565467 : MOV EAX,dword ptr [ESI]
00565469 : MOV EDX,EDI
0056546b : SHL EDX,0x4
0056546e : LEA ESI,[EDX + EAX*0x1 + 0x8]
00565472 : MOV EDX,0xfffffffe
00565477 : CMP dword ptr [ESI],EDX
00565479 : JNZ 0x005654a0
0056547b : MOV EBP,dword ptr [ESP + 0x18]
0056547f : LEA EBX,[ESI + 0x8]
00565482 : PUSH EBP
00565483 : MOV ECX,EBX
00565485 : MOV dword ptr [ESI],0xffffffff
0056548b : CALL 0x0051c600
00565490 : MOV AL,byte ptr [EBP + 0x4]
00565493 : MOV byte ptr [EBX + 0x4],AL
00565496 : MOV dword ptr [ESI + 0x4],EDI
00565499 : POP EDI
0056549a : POP ESI
0056549b : POP EBP
0056549c : POP EBX
0056549d : RET 0xc
005654a0 : MOV ECX,dword ptr [EAX + 0x4]
005654a3 : MOV EBX,EDI
005654a5 : INC EBX
005654a6 : AND EBX,ECX
005654a8 : MOV EBP,EBX
005654aa : SHL EBP,0x4
005654ad : CMP dword ptr [EAX + EBP*0x1 + 0x8],EDX
005654b1 : JNZ 0x005654a5
005654b3 : MOV EDX,dword ptr [ESI + 0x4]
005654b6 : MOV ECX,EBX
005654b8 : SHL ECX,0x4
005654bb : LEA ECX,[ECX + EAX*0x1 + 0x8]
005654bf : CMP EDX,EDI
005654c1 : JNZ 0x005654f2
005654c3 : TEST ECX,ECX
005654c5 : JZ 0x005654cd
005654c7 : PUSH ESI
005654c8 : CALL 0x00562ac0
005654cd : MOV EDX,dword ptr [ESP + 0x18]
005654d1 : LEA EBP,[ESI + 0x8]
005654d4 : PUSH EDX
005654d5 : MOV ECX,EBP
005654d7 : CALL 0x0051bc20
005654dc : MOV EAX,dword ptr [ESP + 0x18]
005654e0 : MOV CL,byte ptr [EAX + 0x4]
005654e3 : MOV byte ptr [EBP + 0x4],CL
005654e6 : MOV dword ptr [ESI + 0x4],EDI
005654e9 : POP EDI
005654ea : MOV dword ptr [ESI],EBX
005654ec : POP ESI
005654ed : POP EBP
005654ee : POP EBX
005654ef : RET 0xc
005654f2 : SHL EDX,0x4
005654f5 : CMP dword ptr [EDX + EAX*0x1 + 0x8],EDI
005654f9 : LEA EBP,[EDX + EAX*0x1 + 0x8]
005654fd : JZ 0x00565510
005654ff : NOP
00565500 : MOV EDX,dword ptr [EBP]
00565503 : SHL EDX,0x4
00565506 : CMP dword ptr [EDX + EAX*0x1 + 0x8],EDI
0056550a : LEA EBP,[EDX + EAX*0x1 + 0x8]
0056550e : JNZ 0x00565500
00565510 : TEST ECX,ECX
00565512 : JZ 0x0056551a
00565514 : PUSH ESI
00565515 : CALL 0x00562ac0
0056551a : MOV dword ptr [EBP],EBX
0056551d : MOV EBP,dword ptr [ESP + 0x18]
00565521 : LEA EBX,[ESI + 0x8]
00565524 : PUSH EBP
00565525 : MOV ECX,EBX
00565527 : CALL 0x0051bc20
0056552c : MOV AL,byte ptr [EBP + 0x4]
0056552f : MOV byte ptr [EBX + 0x4],AL
00565532 : MOV dword ptr [ESI + 0x4],EDI
00565535 : POP EDI
00565536 : MOV dword ptr [ESI],0xffffffff
0056553c : POP ESI
0056553d : POP EBP
0056553e : POP EBX
0056553f : RET 0xc

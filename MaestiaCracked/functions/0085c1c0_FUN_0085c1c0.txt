PROGRAM  : Maestia.exe
FUNCTION : FUN_0085c1c0
ENTRY    : 0085c1c0
BODY     : [[0085c1c0, 0085c361]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0085c1c0(void)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int in_ECX;
  undefined1 auStack_44 [4];
  int local_40;
  int local_3c;
  undefined2 local_34;
  undefined4 local_24;
  uint local_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b37d70;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_44;
  ExceptionList = &local_14;
  local_40 = **(int **)(in_ECX + 0x1b20);
  local_3c = in_ECX;
  if ((int *)local_40 != *(int **)(in_ECX + 0x1b20)) {
    do {
      iVar2 = local_40;
      local_34 = 0;
      local_20 = 7;
      local_24 = 0;
      FUN_00405eb0(local_40 + 0xc,0,0xffffffff);
      local_c = 0;
      FUN_0070c1f0();
      iVar3 = FUN_00407c10(L".cfx",4);
      if ((iVar3 != -1) && (piVar1 = *(int **)(iVar2 + 0x28), piVar1 != (int *)0x0)) {
        (**(code **)(*piVar1 + 0x24))();
        (**(code **)(*piVar1 + 0x18))();
        (**(code **)(*piVar1 + 0x1c))();
        (**(code **)*piVar1)(1);
      }
      iVar3 = FUN_00407c10(L".psb",4);
      if ((iVar3 != -1) && (piVar1 = *(int **)(iVar2 + 0x28), piVar1 != (int *)0x0)) {
        (**(code **)(*piVar1 + 0xd4))();
        if ((int *)piVar1[0xb] != (int *)0x0) {
          (**(code **)(*(int *)piVar1[0xb] + 0x28))(piVar1 + 3);
        }
        piVar1[0xb] = 0;
        FUN_007c4290(piVar1);
      }
      local_c = 0xffffffff;
      if (7 < local_20) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_20 = 7;
      local_24 = 0;
      local_34 = 0;
      FUN_00430160();
      in_ECX = local_3c;
    } while (local_40 != *(int *)(local_3c + 0x1b20));
  }
  FUN_0044c480(*(undefined4 *)(*(int *)(in_ECX + 0x1b20) + 4));
  *(int *)(*(int *)(in_ECX + 0x1b20) + 4) = *(int *)(in_ECX + 0x1b20);
  *(undefined4 *)(in_ECX + 0x1b24) = 0;
  *(undefined4 *)*(undefined4 *)(in_ECX + 0x1b20) = *(undefined4 *)(in_ECX + 0x1b20);
  *(int *)(*(int *)(in_ECX + 0x1b20) + 8) = *(int *)(in_ECX + 0x1b20);
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_44);
  return;
}



============================================================
DISASSEMBLY
============================================================
0085c1c0 : PUSH EBP
0085c1c1 : MOV EBP,ESP
0085c1c3 : AND ESP,0xfffffff8
0085c1c6 : PUSH -0x1
0085c1c8 : PUSH 0xb37d70
0085c1cd : MOV EAX,FS:[0x0]
0085c1d3 : PUSH EAX
0085c1d4 : SUB ESP,0x30
0085c1d7 : MOV EAX,[0x00d66fa0]
0085c1dc : XOR EAX,ESP
0085c1de : MOV dword ptr [ESP + 0x28],EAX
0085c1e2 : PUSH EBX
0085c1e3 : PUSH ESI
0085c1e4 : PUSH EDI
0085c1e5 : MOV EAX,[0x00d66fa0]
0085c1ea : XOR EAX,ESP
0085c1ec : PUSH EAX
0085c1ed : LEA EAX,[ESP + 0x40]
0085c1f1 : MOV FS:[0x0],EAX
0085c1f7 : MOV ESI,ECX
0085c1f9 : MOV EAX,dword ptr [ESI + 0x1b20]
0085c1ff : MOV EDI,dword ptr [EAX]
0085c201 : XOR EBX,EBX
0085c203 : MOV dword ptr [ESP + 0x18],ESI
0085c207 : MOV dword ptr [ESP + 0x14],EDI
0085c20b : CMP EDI,EAX
0085c20d : JZ 0x0085c319
0085c213 : PUSH -0x1
0085c215 : XOR ECX,ECX
0085c217 : LEA EAX,[EDI + 0xc]
0085c21a : PUSH EBX
0085c21b : MOV word ptr [ESP + 0x28],CX
0085c220 : PUSH EAX
0085c221 : LEA ECX,[ESP + 0x28]
0085c225 : MOV dword ptr [ESP + 0x40],0x7
0085c22d : MOV dword ptr [ESP + 0x3c],EBX
0085c231 : CALL 0x00405eb0
0085c236 : MOV dword ptr [ESP + 0x48],EBX
0085c23a : LEA ECX,[ESP + 0x1c]
0085c23e : CALL 0x0070c1f0
0085c243 : PUSH 0x4
0085c245 : PUSH 0xc4005c
0085c24a : XOR EAX,EAX
0085c24c : LEA EDX,[ESP + 0x24]
0085c250 : CALL 0x00407c10
0085c255 : CMP EAX,-0x1
0085c258 : JZ 0x0085c286
0085c25a : MOV ESI,dword ptr [EDI + 0x28]
0085c25d : CMP ESI,EBX
0085c25f : JZ 0x0085c286
0085c261 : MOV EDX,dword ptr [ESI]
0085c263 : MOV EAX,dword ptr [EDX + 0x24]
0085c266 : MOV ECX,ESI
0085c268 : CALL EAX
0085c26a : MOV EDX,dword ptr [ESI]
0085c26c : MOV EAX,dword ptr [EDX + 0x18]
0085c26f : MOV ECX,ESI
0085c271 : CALL EAX
0085c273 : MOV EDX,dword ptr [ESI]
0085c275 : MOV EAX,dword ptr [EDX + 0x1c]
0085c278 : MOV ECX,ESI
0085c27a : CALL EAX
0085c27c : MOV EDX,dword ptr [ESI]
0085c27e : MOV EAX,dword ptr [EDX]
0085c280 : PUSH 0x1
0085c282 : MOV ECX,ESI
0085c284 : CALL EAX
0085c286 : PUSH 0x4
0085c288 : PUSH 0xc40068
0085c28d : XOR EAX,EAX
0085c28f : LEA EDX,[ESP + 0x24]
0085c293 : CALL 0x00407c10
0085c298 : CMP EAX,-0x1
0085c29b : JZ 0x0085c2d1
0085c29d : MOV ESI,dword ptr [EDI + 0x28]
0085c2a0 : CMP ESI,EBX
0085c2a2 : JZ 0x0085c2d1
0085c2a4 : MOV EDX,dword ptr [ESI]
0085c2a6 : MOV EAX,dword ptr [EDX + 0xd4]
0085c2ac : MOV ECX,ESI
0085c2ae : CALL EAX
0085c2b0 : MOV ECX,dword ptr [ESI + 0x2c]
0085c2b3 : CMP ECX,EBX
0085c2b5 : JZ 0x0085c2c2
0085c2b7 : MOV EDX,dword ptr [ECX]
0085c2b9 : MOV EDX,dword ptr [EDX + 0x28]
0085c2bc : LEA EAX,[ESI + 0xc]
0085c2bf : PUSH EAX
0085c2c0 : CALL EDX
0085c2c2 : MOV ECX,dword ptr [0x017251f8]
0085c2c8 : PUSH ESI
0085c2c9 : MOV dword ptr [ESI + 0x2c],EBX
0085c2cc : CALL 0x007c4290
0085c2d1 : MOV dword ptr [ESP + 0x48],0xffffffff
0085c2d9 : CMP dword ptr [ESP + 0x34],0x8
0085c2de : JC 0x0085c2e9
0085c2e0 : MOV ECX,dword ptr [ESP + 0x20]
0085c2e4 : CALL 0x006f04e0
0085c2e9 : XOR EAX,EAX
0085c2eb : LEA EDX,[ESP + 0x14]
0085c2ef : MOV dword ptr [ESP + 0x34],0x7
0085c2f7 : MOV dword ptr [ESP + 0x30],EBX
0085c2fb : MOV word ptr [ESP + 0x20],AX
0085c300 : CALL 0x00430160
0085c305 : MOV EDI,dword ptr [ESP + 0x14]
0085c309 : MOV ESI,dword ptr [ESP + 0x18]
0085c30d : CMP EDI,dword ptr [ESI + 0x1b20]
0085c313 : JNZ 0x0085c213
0085c319 : MOV ECX,dword ptr [ESI + 0x1b20]
0085c31f : MOV EDX,dword ptr [ECX + 0x4]
0085c322 : ADD ESI,0x1b1c
0085c328 : PUSH EDX
0085c329 : MOV ECX,ESI
0085c32b : CALL 0x0044c480
0085c330 : MOV EAX,dword ptr [ESI + 0x4]
0085c333 : MOV dword ptr [EAX + 0x4],EAX
0085c336 : MOV EAX,dword ptr [ESI + 0x4]
0085c339 : MOV dword ptr [ESI + 0x8],EBX
0085c33c : MOV dword ptr [EAX],EAX
0085c33e : MOV ESI,dword ptr [ESI + 0x4]
0085c341 : MOV dword ptr [ESI + 0x8],ESI
0085c344 : MOV ECX,dword ptr [ESP + 0x40]
0085c348 : MOV dword ptr FS:[0x0],ECX
0085c34f : POP ECX
0085c350 : POP EDI
0085c351 : POP ESI
0085c352 : POP EBX
0085c353 : MOV ECX,dword ptr [ESP + 0x28]
0085c357 : XOR ECX,ESP
0085c359 : CALL 0x00633e6b
0085c35e : MOV ESP,EBP
0085c360 : POP EBP
0085c361 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00904000
ENTRY    : 00904000
BODY     : [[00904000, 0090463a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00904000(uint param_1,uint param_2,uint param_3)

{
  int *piVar1;
  int *piVar2;
  ushort uVar3;
  short sVar4;
  SHORT SVar5;
  undefined2 uVar6;
  uint uVar7;
  int iVar8;
  int iVar9;
  undefined4 uVar10;
  char cVar11;
  int *in_ECX;
  uint uVar12;
  int *piVar13;
  uint uVar14;
  undefined1 local_68 [28];
  uint local_4c;
  uint local_48;
  int *local_44;
  uint local_40;
  uint local_3c;
  int *local_38;
  char local_31;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  undefined4 local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3f516;
  local_10 = ExceptionList;
  uVar7 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  piVar13 = *(int **)(in_ECX[1] + 0x128);
  local_44 = piVar13;
  local_14 = uVar7;
  if (piVar13 == (int *)0x0) goto LAB_0090461d;
  if (((short)param_2 == -1) && ((short)param_3 == -1)) {
    iVar8 = in_ECX[0xf];
    cVar11 = '\0';
    local_31 = '\0';
    local_48 = 0;
    if (*(int *)(iVar8 + 8) < 1) goto LAB_0090461d;
    do {
      if (cVar11 != '\0') goto LAB_009040e7;
      local_38 = (int *)0x0;
      if (0 < *(int *)(iVar8 + 0xc)) {
        do {
          if (cVar11 != '\0') break;
          uVar14 = local_48 & 0xffff;
          uVar12 = (uint)local_38 & 0xffff;
          iVar8 = (**(code **)(*in_ECX + 0x74))(uVar12,uVar14,uVar7);
          if (iVar8 == 0) {
            local_31 = '\x01';
            param_2 = uVar12;
            param_3 = uVar14;
          }
          local_38 = (int *)((int)local_38 + 1);
          piVar13 = local_44;
          cVar11 = local_31;
        } while ((int)local_38 < *(int *)(in_ECX[0xf] + 0xc));
      }
      iVar8 = in_ECX[0xf];
      local_48 = local_48 + 1;
    } while ((int)local_48 < *(int *)(iVar8 + 8));
    if (cVar11 == '\0') goto LAB_0090461d;
  }
LAB_009040e7:
  local_40 = param_3 & 0xffff;
  local_3c = param_2 & 0xffff;
  local_38 = (int *)(**(code **)(*in_ECX + 0x74))(local_3c,local_40);
  uVar7 = piVar13[0x10];
  if (uVar7 < 0x95) {
    if (uVar7 == 0x94) {
LAB_00904180:
      piVar1 = (int *)piVar13[0x13];
      if (piVar1 == (int *)0x0) goto LAB_0090461d;
      if (((uVar7 != param_1) || ((short)piVar13[0x11] != (short)local_3c)) ||
         (*(short *)((int)piVar13 + 0x46) != (short)local_40)) {
        SVar5 = GetKeyState(0x10);
        if (((-1 < SVar5) || (uVar3 = (**(code **)(*piVar1 + 0x40))(), uVar3 < 2)) ||
           ((*(byte *)(piVar1 + 0x48) & 1) != 0)) {
          local_44 = (int *)FUN_004049b0(piVar1[4]);
          piVar2 = local_38;
          if (local_44 != (int *)0x0) {
            if (((1 < *(ushort *)(local_44 + 0x29)) && (local_38 != (int *)0x0)) &&
               (local_38[4] == piVar1[4])) {
              uVar7 = (**(code **)(*local_38 + 0x40))();
              local_38 = (int *)((uint)*(ushort *)(local_44 + 0x29) - (uVar7 & 0xffff));
              uVar7 = (**(code **)(*piVar1 + 0x40))();
              if ((int)(uVar7 & 0xffff) < (int)local_38) {
                sVar4 = (**(code **)(*piVar1 + 0x40))();
              }
              else {
                sVar4 = (**(code **)(*piVar2 + 0x40))();
                sVar4 = (short)local_44[0x29] - sVar4;
              }
              if (sVar4 != 0) {
                FUN_008ef980(piVar13[0x10],(short)piVar13[0x11],*(undefined2 *)((int)piVar13 + 0x46)
                             ,param_1,local_3c,local_40,sVar4);
                goto LAB_0090461d;
              }
            }
            FUN_008efa90(piVar13[0x10],(short)piVar13[0x11],*(undefined2 *)((int)piVar13 + 0x46),
                         param_1,local_3c,local_40);
          }
          goto LAB_0090461d;
        }
        iVar8 = *(int *)(*DAT_00da9894 + 0x2a4);
        uVar6 = (**(code **)(*piVar1 + 0x40))();
        *(undefined2 *)(iVar8 + 0x7e) = 1;
        *(undefined2 *)(iVar8 + 0x80) = uVar6;
        FUN_009a6910();
        FUN_009a6740((short)piVar13[0x11],*(undefined2 *)((int)piVar13 + 0x46),param_1,local_3c,
                     local_40);
      }
      FUN_0097fa60();
      goto LAB_0090461d;
    }
    if (0x3f < uVar7) {
      if (uVar7 < 0x43) goto LAB_00904180;
      if (uVar7 == 0x43) {
        uVar3 = *(ushort *)(piVar13 + 0x11);
        uVar6 = *(undefined2 *)((int)piVar13 + 0x46);
        if (((DAT_00d6f0f4 != -1) && (iVar8 = FUN_008eb260(DAT_00d6f0f4), iVar8 != 0)) &&
           (*(char *)((int)*(int **)(iVar8 + 0x78) + 0x32) != '\0')) {
          (**(code **)(**(int **)(iVar8 + 0x78) + 0x20))();
        }
        FUN_008efa90(0x43,4 - (uint)uVar3,uVar6,param_1,local_3c,local_40);
        goto LAB_0090461d;
      }
    }
  }
  else if (uVar7 == 0xffffffff) {
    if (local_38 != (int *)0x0) {
      FUN_0097fb30(local_38,local_3c,local_40);
    }
    goto LAB_0090461d;
  }
  iVar8 = FUN_008eb580();
  if (iVar8 != 0) {
    local_48 = (uint)*(ushort *)(piVar13 + 0x11);
    local_4c = (uint)*(ushort *)((int)piVar13 + 0x46);
    if (((piVar13[0x13] == 0) || (uVar3 = (**(code **)(*(int *)piVar13[0x13] + 0x40))(), uVar3 < 2))
       || ((iVar8 = (**(code **)(*(int *)piVar13[0x13] + 0x20))(), iVar8 == 0 ||
           ((*(byte *)(piVar13[0x13] + 0x120) & 4) != 0)))) {
      FUN_008efa90(uVar7,local_48,local_4c,param_1,local_3c,local_40);
    }
    else {
      if ((local_38 != (int *)0x0) && (iVar8 = (**(code **)(*local_38 + 0x20))(), iVar8 == 1)) {
        if (piVar13[0x13] == 0) {
          iVar8 = 0;
        }
        else {
          iVar8 = *(int *)(piVar13[0x13] + 0x10);
        }
        if (local_38[4] == iVar8) {
          local_44 = (int *)FUN_004049b0(local_38[4]);
          if (local_44 != (int *)0x0) {
            sVar4 = (**(code **)(*local_38 + 0x40))();
            uVar3 = (short)local_44[0x29] - sVar4;
            local_38 = (int *)(uint)uVar3;
            if (uVar3 == 0) {
              local_18 = 7;
              local_1c = 0;
              local_2c = 0;
              local_8 = 0;
              FUN_00406460(L"IDS_SLOT_ITEM_MAX_OVERAY");
              local_8._0_1_ = 1;
              iVar8 = FUN_00404350(local_44 + 6);
              local_8._0_1_ = 2;
              iVar9 = FUN_0081d120(local_68);
              local_8._0_1_ = 3;
              if (*(uint *)(iVar8 + 0x18) < 8) {
                iVar8 = iVar8 + 4;
              }
              else {
                iVar8 = *(int *)(iVar8 + 4);
              }
              if (*(uint *)(iVar9 + 0x18) < 8) {
                iVar9 = iVar9 + 4;
              }
              else {
                iVar9 = *(int *)(iVar9 + 4);
              }
              uVar10 = FUN_00404750(iVar9,iVar8,(short)local_44[0x29]);
              local_8._0_1_ = 4;
              FUN_00405eb0(uVar10,0,0xffffffff);
              local_8._0_1_ = 3;
              FUN_00406560();
              local_8._0_1_ = 2;
              FUN_00406560();
              local_8._0_1_ = 1;
              FUN_00406560();
              local_8 = (uint)local_8._1_3_ << 8;
              FUN_00406560();
              (**(code **)(**(int **)(*DAT_00da9894 + 0x1a8) + 0x44))(local_30,2);
              FUN_0097fa60();
              local_8 = 0xffffffff;
              FUN_00406560();
            }
            else {
              local_44 = local_38;
              uVar3 = FUN_0097f9f0();
              piVar13 = local_44;
              if (uVar3 < (ushort)local_38) {
                uVar12 = FUN_0097f9f0();
                piVar13 = (int *)(uVar12 & 0xffff);
              }
              SVar5 = GetKeyState(0x11);
              if (SVar5 < 0) {
                FUN_008ef980(uVar7,local_48,local_4c,param_1,local_3c,local_40);
              }
              else {
                FUN_00904db0(uVar7,local_48,local_4c,param_1,local_3c,local_40,piVar13);
              }
            }
          }
          goto LAB_0090461d;
        }
      }
      SVar5 = GetKeyState(0x11);
      if (SVar5 < 0) {
        uVar6 = FUN_0097f9f0();
        FUN_008ef980(uVar7,local_48,local_4c,param_1,local_3c,local_40,uVar6);
      }
      else {
        uVar6 = FUN_0097f9f0();
        FUN_00904db0(uVar7,local_48,local_4c,param_1,local_3c,local_40,uVar6);
      }
    }
  }
LAB_0090461d:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00904000 : PUSH EBP
00904001 : MOV EBP,ESP
00904003 : PUSH -0x1
00904005 : PUSH 0xb3f516
0090400a : MOV EAX,FS:[0x0]
00904010 : PUSH EAX
00904011 : SUB ESP,0xac
00904017 : MOV EAX,[0x00d66fa0]
0090401c : XOR EAX,EBP
0090401e : MOV dword ptr [EBP + -0x10],EAX
00904021 : PUSH EBX
00904022 : PUSH ESI
00904023 : PUSH EDI
00904024 : PUSH EAX
00904025 : LEA EAX,[EBP + -0xc]
00904028 : MOV FS:[0x0],EAX
0090402e : MOV ESI,ECX
00904030 : MOV EAX,dword ptr [ESI + 0x4]
00904033 : MOV EBX,dword ptr [EAX + 0x128]
00904039 : MOV dword ptr [EBP + -0x40],EBX
0090403c : TEST EBX,EBX
0090403e : JZ 0x0090461d
00904044 : MOV ECX,0xffff
00904049 : CMP word ptr [EBP + 0xc],CX
0090404d : JNZ 0x009040e7
00904053 : MOV EDX,ECX
00904055 : CMP word ptr [EBP + 0x10],DX
00904059 : JNZ 0x009040e7
0090405f : MOV EAX,dword ptr [ESI + 0x3c]
00904062 : XOR CL,CL
00904064 : CMP dword ptr [EAX + 0x8],0x0
00904068 : MOV byte ptr [EBP + -0x2d],CL
0090406b : MOV dword ptr [EBP + -0x44],0x0
00904072 : JLE 0x0090461d
00904078 : TEST CL,CL
0090407a : JNZ 0x009040e7
0090407c : CMP dword ptr [EAX + 0xc],0x0
00904080 : MOV dword ptr [EBP + -0x34],0x0
00904087 : JLE 0x009040d0
00904089 : LEA ESP,[ESP]
00904090 : TEST CL,CL
00904092 : JNZ 0x009040d0
00904094 : MOVZX EDI,word ptr [EBP + -0x44]
00904098 : MOVZX EBX,word ptr [EBP + -0x34]
0090409c : MOV EAX,dword ptr [ESI]
0090409e : MOV EDX,dword ptr [EAX + 0x74]
009040a1 : PUSH EDI
009040a2 : PUSH EBX
009040a3 : MOV ECX,ESI
009040a5 : CALL EDX
009040a7 : TEST EAX,EAX
009040a9 : JNZ 0x009040bb
009040ab : MOVZX EAX,BX
009040ae : MOVZX ECX,DI
009040b1 : MOV dword ptr [EBP + 0xc],EAX
009040b4 : MOV dword ptr [EBP + 0x10],ECX
009040b7 : MOV byte ptr [EBP + -0x2d],0x1
009040bb : MOV EAX,dword ptr [EBP + -0x34]
009040be : MOV EDX,dword ptr [ESI + 0x3c]
009040c1 : MOV CL,byte ptr [EBP + -0x2d]
009040c4 : MOV EBX,dword ptr [EBP + -0x40]
009040c7 : INC EAX
009040c8 : CMP EAX,dword ptr [EDX + 0xc]
009040cb : MOV dword ptr [EBP + -0x34],EAX
009040ce : JL 0x00904090
009040d0 : MOV EDX,dword ptr [EBP + -0x44]
009040d3 : MOV EAX,dword ptr [ESI + 0x3c]
009040d6 : INC EDX
009040d7 : CMP EDX,dword ptr [EAX + 0x8]
009040da : MOV dword ptr [EBP + -0x44],EDX
009040dd : JL 0x00904078
009040df : TEST CL,CL
009040e1 : JZ 0x0090461d
009040e7 : MOVZX ECX,word ptr [EBP + 0x10]
009040eb : MOVZX EAX,word ptr [EBP + 0xc]
009040ef : MOV EDX,dword ptr [ESI]
009040f1 : PUSH ECX
009040f2 : MOV dword ptr [EBP + -0x38],EAX
009040f5 : MOV dword ptr [EBP + -0x3c],ECX
009040f8 : PUSH EAX
009040f9 : MOV EAX,dword ptr [EDX + 0x74]
009040fc : MOV ECX,ESI
009040fe : CALL EAX
00904100 : MOV EDI,dword ptr [EBX + 0x40]
00904103 : MOV dword ptr [EBP + -0x34],EAX
00904106 : CMP EDI,0x94
0090410c : JA 0x0090432a
00904112 : JZ 0x00904180
00904114 : CMP EDI,0x40
00904117 : JC 0x00904333
0090411d : CMP EDI,0x42
00904120 : JBE 0x00904180
00904122 : CMP EDI,0x43
00904125 : JNZ 0x00904333
0090412b : MOV EAX,[0x00d6f0f4]
00904130 : MOVZX EDI,word ptr [EBX + 0x44]
00904134 : MOVZX EBX,word ptr [EBX + 0x46]
00904138 : CMP EAX,-0x1
0090413b : JZ 0x0090415c
0090413d : MOV ESI,dword ptr [ESI + 0x4]
00904140 : PUSH EAX
00904141 : CALL 0x008eb260
00904146 : TEST EAX,EAX
00904148 : JZ 0x0090415c
0090414a : MOV EAX,dword ptr [EAX + 0x78]
0090414d : CMP byte ptr [EAX + 0x32],0x0
00904151 : JZ 0x0090415c
00904153 : MOV EDX,dword ptr [EAX]
00904155 : MOV ECX,EAX
00904157 : MOV EAX,dword ptr [EDX + 0x20]
0090415a : CALL EAX
0090415c : MOV ECX,dword ptr [EBP + -0x3c]
0090415f : MOV EDX,dword ptr [EBP + -0x38]
00904162 : MOV EAX,dword ptr [EBP + 0x8]
00904165 : PUSH ECX
00904166 : PUSH EDX
00904167 : PUSH EAX
00904168 : MOV ECX,0x4
0090416d : PUSH EBX
0090416e : SUB ECX,EDI
00904170 : PUSH ECX
00904171 : PUSH 0x43
00904173 : CALL 0x008efa90
00904178 : ADD ESP,0x18
0090417b : JMP 0x0090461d
00904180 : MOV ESI,dword ptr [EBX + 0x4c]
00904183 : TEST ESI,ESI
00904185 : JZ 0x0090461d
0090418b : CMP EDI,dword ptr [EBP + 0x8]
0090418e : JNZ 0x009041a8
00904190 : MOV DX,word ptr [EBX + 0x44]
00904194 : CMP DX,word ptr [EBP + -0x38]
00904198 : JNZ 0x009041a8
0090419a : MOV AX,word ptr [EBX + 0x46]
0090419e : CMP AX,word ptr [EBP + -0x3c]
009041a2 : JZ 0x0090423b
009041a8 : PUSH 0x10
009041aa : CALL dword ptr [0x00b85438]
009041b0 : TEST AX,AX
009041b3 : JGE 0x00904247
009041b9 : MOV EDX,dword ptr [ESI]
009041bb : MOV EAX,dword ptr [EDX + 0x40]
009041be : MOV ECX,ESI
009041c0 : CALL EAX
009041c2 : CMP AX,0x1
009041c6 : JBE 0x00904247
009041c8 : TEST byte ptr [ESI + 0x120],0x1
009041cf : JNZ 0x00904247
009041d1 : MOV ECX,dword ptr [0x00da9894]
009041d7 : MOV EDX,dword ptr [ECX]
009041d9 : MOV EAX,dword ptr [ESI]
009041db : MOV EDI,dword ptr [EDX + 0x2a4]
009041e1 : MOV EDX,dword ptr [EAX + 0x40]
009041e4 : MOV ECX,ESI
009041e6 : CALL EDX
009041e8 : MOV EDX,dword ptr [0x00da9894]
009041ee : MOVZX EAX,AX
009041f1 : MOV ECX,0x1
009041f6 : MOV word ptr [EDI + 0x7e],CX
009041fa : MOV word ptr [EDI + 0x80],AX
00904201 : MOV EAX,dword ptr [EDX]
00904203 : MOV EDI,dword ptr [EAX + 0x2a4]
00904209 : MOV ESI,ECX
0090420b : CALL 0x009a6910
00904210 : MOV ECX,dword ptr [EBP + -0x3c]
00904213 : MOV EDX,dword ptr [EBP + -0x38]
00904216 : MOV EAX,dword ptr [EBP + 0x8]
00904219 : PUSH ECX
0090421a : MOVZX ECX,word ptr [EBX + 0x46]
0090421e : PUSH EDX
0090421f : MOVZX EDX,word ptr [EBX + 0x44]
00904223 : PUSH EAX
00904224 : MOV EAX,[0x00da9894]
00904229 : PUSH ECX
0090422a : MOV ECX,dword ptr [EAX]
0090422c : MOV EAX,dword ptr [EBX + 0x40]
0090422f : MOV ECX,dword ptr [ECX + 0x2a4]
00904235 : PUSH EDX
00904236 : CALL 0x009a6740
0090423b : MOV ECX,EBX
0090423d : CALL 0x0097fa60
00904242 : JMP 0x0090461d
00904247 : MOV EAX,dword ptr [ESI + 0x10]
0090424a : PUSH EAX
0090424b : CALL 0x004049b0
00904250 : ADD ESP,0x4
00904253 : MOV dword ptr [EBP + -0x40],EAX
00904256 : TEST EAX,EAX
00904258 : JZ 0x0090461d
0090425e : CMP word ptr [EAX + 0xa4],0x1
00904266 : JBE 0x00904303
0090426c : MOV EDI,dword ptr [EBP + -0x34]
0090426f : TEST EDI,EDI
00904271 : JZ 0x00904303
00904277 : MOV EAX,dword ptr [ESI + 0x10]
0090427a : CMP dword ptr [EDI + 0x10],EAX
0090427d : JNZ 0x00904303
00904283 : MOV EDX,dword ptr [EDI]
00904285 : MOV EAX,dword ptr [EDX + 0x40]
00904288 : MOV ECX,EDI
0090428a : CALL EAX
0090428c : MOV EDX,dword ptr [EBP + -0x40]
0090428f : MOVZX ECX,AX
00904292 : MOVZX EAX,word ptr [EDX + 0xa4]
00904299 : SUB EAX,ECX
0090429b : MOV dword ptr [EBP + -0x34],EAX
0090429e : MOV EAX,dword ptr [ESI]
009042a0 : MOV EDX,dword ptr [EAX + 0x40]
009042a3 : MOV ECX,ESI
009042a5 : CALL EDX
009042a7 : MOVZX EAX,AX
009042aa : CMP dword ptr [EBP + -0x34],EAX
009042ad : JLE 0x009042bd
009042af : MOV EDX,dword ptr [ESI]
009042b1 : MOV EAX,dword ptr [EDX + 0x40]
009042b4 : MOV ECX,ESI
009042b6 : CALL EAX
009042b8 : MOVZX EAX,AX
009042bb : JMP 0x009042d6
009042bd : MOV EDX,dword ptr [EDI]
009042bf : MOV EAX,dword ptr [EDX + 0x40]
009042c2 : MOV ECX,EDI
009042c4 : CALL EAX
009042c6 : MOV ECX,dword ptr [EBP + -0x40]
009042c9 : MOV DX,word ptr [ECX + 0xa4]
009042d0 : SUB DX,AX
009042d3 : MOVZX EAX,DX
009042d6 : TEST AX,AX
009042d9 : JBE 0x00904303
009042db : MOV ECX,dword ptr [EBP + -0x38]
009042de : MOV EDX,dword ptr [EBP + 0x8]
009042e1 : PUSH EAX
009042e2 : MOV EAX,dword ptr [EBP + -0x3c]
009042e5 : PUSH EAX
009042e6 : MOVZX EAX,word ptr [EBX + 0x46]
009042ea : PUSH ECX
009042eb : MOVZX ECX,word ptr [EBX + 0x44]
009042ef : PUSH EDX
009042f0 : MOV EDX,dword ptr [EBX + 0x40]
009042f3 : PUSH EAX
009042f4 : PUSH ECX
009042f5 : PUSH EDX
009042f6 : CALL 0x008ef980
009042fb : ADD ESP,0x1c
009042fe : JMP 0x0090461d
00904303 : MOV EAX,dword ptr [EBP + -0x3c]
00904306 : MOV ECX,dword ptr [EBP + -0x38]
00904309 : MOV EDX,dword ptr [EBP + 0x8]
0090430c : PUSH EAX
0090430d : MOVZX EAX,word ptr [EBX + 0x46]
00904311 : PUSH ECX
00904312 : MOVZX ECX,word ptr [EBX + 0x44]
00904316 : PUSH EDX
00904317 : MOV EDX,dword ptr [EBX + 0x40]
0090431a : PUSH EAX
0090431b : PUSH ECX
0090431c : PUSH EDX
0090431d : CALL 0x008efa90
00904322 : ADD ESP,0x18
00904325 : JMP 0x0090461d
0090432a : CMP EDI,-0x1
0090432d : JZ 0x00904606
00904333 : MOV EAX,dword ptr [ESI + 0x4]
00904336 : CALL 0x008eb580
0090433b : TEST EAX,EAX
0090433d : JZ 0x0090461d
00904343 : CMP dword ptr [EBX + 0x4c],0x0
00904347 : MOVZX EAX,word ptr [EBX + 0x44]
0090434b : MOVZX ECX,word ptr [EBX + 0x46]
0090434f : MOV dword ptr [EBP + -0x44],EAX
00904352 : MOV dword ptr [EBP + -0x48],ECX
00904355 : JZ 0x009045e7
0090435b : MOV ECX,dword ptr [EBX + 0x4c]
0090435e : MOV EDX,dword ptr [ECX]
00904360 : MOV EAX,dword ptr [EDX + 0x40]
00904363 : CALL EAX
00904365 : MOVZX EAX,AX
00904368 : CMP AX,0x1
0090436c : JBE 0x009045e7
00904372 : MOV ECX,dword ptr [EBX + 0x4c]
00904375 : MOV EDX,dword ptr [ECX]
00904377 : MOV EAX,dword ptr [EDX + 0x20]
0090437a : CALL EAX
0090437c : TEST EAX,EAX
0090437e : JZ 0x009045e7
00904384 : MOV EAX,dword ptr [EBX + 0x4c]
00904387 : TEST byte ptr [EAX + 0x120],0x4
0090438e : JNZ 0x009045e7
00904394 : MOV ECX,dword ptr [EBP + -0x34]
00904397 : TEST ECX,ECX
00904399 : JZ 0x00904588
0090439f : MOV EDX,dword ptr [ECX]
009043a1 : MOV EAX,dword ptr [EDX + 0x20]
009043a4 : CALL EAX
009043a6 : CMP EAX,0x1
009043a9 : JNZ 0x00904588
009043af : MOV EAX,dword ptr [EBX + 0x4c]
009043b2 : MOV ECX,dword ptr [EBP + -0x34]
009043b5 : MOV ECX,dword ptr [ECX + 0x10]
009043b8 : TEST EAX,EAX
009043ba : JZ 0x009043c1
009043bc : MOV EAX,dword ptr [EAX + 0x10]
009043bf : JMP 0x009043c3
009043c1 : XOR EAX,EAX
009043c3 : CMP ECX,EAX
009043c5 : JNZ 0x00904588
009043cb : PUSH ECX
009043cc : CALL 0x004049b0
009043d1 : ADD ESP,0x4
009043d4 : MOV dword ptr [EBP + -0x40],EAX
009043d7 : TEST EAX,EAX
009043d9 : JZ 0x0090461d
009043df : MOV ECX,dword ptr [EBP + -0x34]
009043e2 : MOV EDX,dword ptr [ECX]
009043e4 : MOV EAX,dword ptr [EDX + 0x40]
009043e7 : CALL EAX
009043e9 : MOV ECX,dword ptr [EBP + -0x40]
009043ec : MOV DX,word ptr [ECX + 0xa4]
009043f3 : SUB DX,AX
009043f6 : MOVZX EAX,DX
009043f9 : XOR ECX,ECX
009043fb : MOV dword ptr [EBP + -0x34],EAX
009043fe : CMP AX,CX
00904401 : JBE 0x00904477
00904403 : MOVZX EAX,AX
00904406 : MOV dword ptr [EBP + -0x40],EAX
00904409 : MOV EAX,EBX
0090440b : CALL 0x0097f9f0
00904410 : CMP word ptr [EBP + -0x34],AX
00904414 : JBE 0x00904422
00904416 : MOV EAX,EBX
00904418 : CALL 0x0097f9f0
0090441d : MOVZX EBX,AX
00904420 : JMP 0x00904425
00904422 : MOV EBX,dword ptr [EBP + -0x40]
00904425 : PUSH 0x11
00904427 : CALL dword ptr [0x00b85438]
0090442d : PUSH EBX
0090442e : TEST AX,AX
00904431 : JGE 0x00904455
00904433 : MOV ECX,dword ptr [EBP + -0x3c]
00904436 : MOV EDX,dword ptr [EBP + -0x38]
00904439 : MOV EAX,dword ptr [EBP + 0x8]
0090443c : PUSH ECX
0090443d : MOV ECX,dword ptr [EBP + -0x48]
00904440 : PUSH EDX
00904441 : MOV EDX,dword ptr [EBP + -0x44]
00904444 : PUSH EAX
00904445 : PUSH ECX
00904446 : PUSH EDX
00904447 : PUSH EDI
00904448 : CALL 0x008ef980
0090444d : ADD ESP,0x1c
00904450 : JMP 0x0090461d
00904455 : MOV EAX,dword ptr [EBP + -0x3c]
00904458 : MOV ECX,dword ptr [EBP + -0x38]
0090445b : MOV EDX,dword ptr [EBP + 0x8]
0090445e : MOV ESI,dword ptr [ESI + 0x60]
00904461 : PUSH EAX
00904462 : MOV EAX,dword ptr [EBP + -0x48]
00904465 : PUSH ECX
00904466 : MOV ECX,dword ptr [EBP + -0x44]
00904469 : PUSH EDX
0090446a : PUSH EAX
0090446b : PUSH ECX
0090446c : PUSH EDI
0090446d : CALL 0x00904db0
00904472 : JMP 0x0090461d
00904477 : JNZ 0x0090461d
0090447d : XOR EDX,EDX
0090447f : MOV dword ptr [EBP + -0x14],0x7
00904486 : MOV dword ptr [EBP + -0x18],ECX
00904489 : MOV word ptr [EBP + -0x28],DX
0090448d : MOV dword ptr [EBP + -0x4],ECX
00904490 : PUSH 0xc64318
00904495 : LEA ECX,[EBP + -0x64]
00904498 : CALL 0x00406460
0090449d : MOV byte ptr [EBP + -0x4],0x1
009044a1 : MOV EAX,dword ptr [EBP + -0x40]
009044a4 : ADD EAX,0x18
009044a7 : PUSH EAX
009044a8 : LEA ESI,[EBP + 0xffffff48]
009044ae : CALL 0x00404350
009044b3 : ADD ESP,0x4
009044b6 : MOV ESI,EAX
009044b8 : MOV byte ptr [EBP + -0x4],0x2
009044bc : LEA ECX,[EBP + -0x64]
009044bf : PUSH ECX
009044c0 : MOV ECX,dword ptr [0x0172491c]
009044c6 : LEA EDI,[EBP + 0xffffff64]
009044cc : CALL 0x0081d120
009044d1 : MOV byte ptr [EBP + -0x4],0x3
009044d5 : MOV ECX,0x8
009044da : CMP dword ptr [ESI + 0x18],ECX
009044dd : JC 0x009044e4
009044df : MOV ESI,dword ptr [ESI + 0x4]
009044e2 : JMP 0x009044e7
009044e4 : ADD ESI,0x4
009044e7 : CMP dword ptr [EAX + 0x18],ECX
009044ea : JC 0x009044f1
009044ec : MOV EAX,dword ptr [EAX + 0x4]
009044ef : JMP 0x009044f4
009044f1 : ADD EAX,0x4
009044f4 : MOV EDX,dword ptr [EBP + -0x40]
009044f7 : MOVZX ECX,word ptr [EDX + 0xa4]
009044fe : PUSH ECX
009044ff : PUSH ESI
00904500 : PUSH EAX
00904501 : LEA ESI,[EBP + -0x80]
00904504 : CALL 0x00404750
00904509 : ADD ESP,0xc
0090450c : MOV byte ptr [EBP + -0x4],0x4
00904510 : PUSH -0x1
00904512 : PUSH 0x0
00904514 : PUSH EAX
00904515 : LEA ECX,[EBP + -0x2c]
00904518 : CALL 0x00405eb0
0090451d : MOV byte ptr [EBP + -0x4],0x3
00904521 : MOV ECX,ESI
00904523 : CALL 0x00406560
00904528 : MOV byte ptr [EBP + -0x4],0x2
0090452c : LEA ECX,[EBP + 0xffffff64]
00904532 : CALL 0x00406560
00904537 : MOV byte ptr [EBP + -0x4],0x1
0090453b : LEA ECX,[EBP + 0xffffff48]
00904541 : CALL 0x00406560
00904546 : MOV byte ptr [EBP + -0x4],0x0
0090454a : LEA ECX,[EBP + -0x64]
0090454d : CALL 0x00406560
00904552 : MOV EDX,dword ptr [0x00da9894]
00904558 : MOV EAX,dword ptr [EDX]
0090455a : MOV ECX,dword ptr [EAX + 0x1a8]
00904560 : MOV EAX,dword ptr [ECX]
00904562 : MOV EAX,dword ptr [EAX + 0x44]
00904565 : PUSH 0x2
00904567 : LEA EDX,[EBP + -0x2c]
0090456a : PUSH EDX
0090456b : CALL EAX
0090456d : MOV ECX,EBX
0090456f : CALL 0x0097fa60
00904574 : MOV dword ptr [EBP + -0x4],0xffffffff
0090457b : LEA ECX,[EBP + -0x2c]
0090457e : CALL 0x00406560
00904583 : JMP 0x0090461d
00904588 : PUSH 0x11
0090458a : CALL dword ptr [0x00b85438]
00904590 : TEST AX,AX
00904593 : MOV EAX,EBX
00904595 : JGE 0x009045bf
00904597 : CALL 0x0097f9f0
0090459c : MOV EDX,dword ptr [EBP + -0x3c]
0090459f : MOVZX ECX,AX
009045a2 : MOV EAX,dword ptr [EBP + -0x38]
009045a5 : PUSH ECX
009045a6 : MOV ECX,dword ptr [EBP + 0x8]
009045a9 : PUSH EDX
009045aa : MOV EDX,dword ptr [EBP + -0x48]
009045ad : PUSH EAX
009045ae : MOV EAX,dword ptr [EBP + -0x44]
009045b1 : PUSH ECX
009045b2 : PUSH EDX
009045b3 : PUSH EAX
009045b4 : PUSH EDI
009045b5 : CALL 0x008ef980
009045ba : ADD ESP,0x1c
009045bd : JMP 0x0090461d
009045bf : CALL 0x0097f9f0
009045c4 : MOV EDX,dword ptr [EBP + -0x3c]
009045c7 : MOV ESI,dword ptr [ESI + 0x60]
009045ca : MOVZX ECX,AX
009045cd : MOV EAX,dword ptr [EBP + -0x38]
009045d0 : PUSH ECX
009045d1 : MOV ECX,dword ptr [EBP + 0x8]
009045d4 : PUSH EDX
009045d5 : MOV EDX,dword ptr [EBP + -0x48]
009045d8 : PUSH EAX
009045d9 : MOV EAX,dword ptr [EBP + -0x44]
009045dc : PUSH ECX
009045dd : PUSH EDX
009045de : PUSH EAX
009045df : PUSH EDI
009045e0 : CALL 0x00904db0
009045e5 : JMP 0x0090461d
009045e7 : MOV ECX,dword ptr [EBP + -0x3c]
009045ea : MOV EDX,dword ptr [EBP + -0x38]
009045ed : MOV EAX,dword ptr [EBP + 0x8]
009045f0 : PUSH ECX
009045f1 : MOV ECX,dword ptr [EBP + -0x48]
009045f4 : PUSH EDX
009045f5 : MOV EDX,dword ptr [EBP + -0x44]
009045f8 : PUSH EAX
009045f9 : PUSH ECX
009045fa : PUSH EDX
009045fb : PUSH EDI
009045fc : CALL 0x008efa90
00904601 : ADD ESP,0x18
00904604 : JMP 0x0090461d
00904606 : TEST EAX,EAX
00904608 : JZ 0x0090461d
0090460a : MOV ECX,dword ptr [EBP + -0x3c]
0090460d : MOV EDX,dword ptr [EBP + -0x38]
00904610 : PUSH ECX
00904611 : PUSH EDX
00904612 : PUSH EAX
00904613 : MOV EAX,dword ptr [EBP + 0x8]
00904616 : MOV ECX,EBX
00904618 : CALL 0x0097fb30
0090461d : MOV ECX,dword ptr [EBP + -0xc]
00904620 : MOV dword ptr FS:[0x0],ECX
00904627 : POP ECX
00904628 : POP EDI
00904629 : POP ESI
0090462a : POP EBX
0090462b : MOV ECX,dword ptr [EBP + -0x10]
0090462e : XOR ECX,EBP
00904630 : CALL 0x00633e6b
00904635 : MOV ESP,EBP
00904637 : POP EBP
00904638 : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_00664540
ENTRY    : 00664540
BODY     : [[00664540, 006645a3]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00664540(undefined4 *param_1,undefined4 *param_2)

{
  int *piVar1;
  LPVOID _Dst;
  int iVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  
  puVar3 = param_2;
  puVar4 = param_1;
  for (iVar2 = 0x12; iVar2 != 0; iVar2 = iVar2 + -1) {
    *puVar4 = *puVar3;
    puVar3 = puVar3 + 1;
    puVar4 = puVar4 + 1;
  }
  if (param_2[0x10] != 0) {
    _Dst = CoTaskMemAlloc(param_2[0x10]);
    param_1[0x11] = _Dst;
    if (_Dst == (LPVOID)0x0) {
      param_1[0x10] = 0;
      return 0x8007000e;
    }
    _memcpy(_Dst,(void *)param_2[0x11],param_1[0x10]);
  }
  piVar1 = (int *)param_1[0xf];
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 4))(piVar1);
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00664540 : PUSH EBX
00664541 : MOV EBX,dword ptr [ESP + 0x8]
00664545 : PUSH EBP
00664546 : MOV EBP,dword ptr [ESP + 0x10]
0066454a : PUSH ESI
0066454b : PUSH EDI
0066454c : MOV ECX,0x12
00664551 : MOV ESI,EBP
00664553 : MOV EDI,EBX
00664555 : MOVSD.REP ES:EDI,ESI
00664557 : MOV EAX,dword ptr [EBP + 0x40]
0066455a : TEST EAX,EAX
0066455c : JZ 0x0066458c
0066455e : PUSH EAX
0066455f : CALL dword ptr [0x00b85764]
00664565 : MOV dword ptr [EBX + 0x44],EAX
00664568 : TEST EAX,EAX
0066456a : JNZ 0x0066457b
0066456c : POP EDI
0066456d : POP ESI
0066456e : MOV dword ptr [EBX + 0x40],EAX
00664571 : POP EBP
00664572 : MOV EAX,0x8007000e
00664577 : POP EBX
00664578 : RET 0x8
0066457b : MOV ECX,dword ptr [EBX + 0x40]
0066457e : MOV EDX,dword ptr [EBP + 0x44]
00664581 : PUSH ECX
00664582 : PUSH EDX
00664583 : PUSH EAX
00664584 : CALL 0x0063ae40
00664589 : ADD ESP,0xc
0066458c : MOV EBX,dword ptr [EBX + 0x3c]
0066458f : TEST EBX,EBX
00664591 : JZ 0x0066459b
00664593 : MOV EAX,dword ptr [EBX]
00664595 : MOV ECX,dword ptr [EAX + 0x4]
00664598 : PUSH EBX
00664599 : CALL ECX
0066459b : POP EDI
0066459c : POP ESI
0066459d : POP EBP
0066459e : XOR EAX,EAX
006645a0 : POP EBX
006645a1 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_006d3200
ENTRY    : 006d3200
BODY     : [[006d3200, 006d35a5]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006d3200(undefined4 param_1,int param_2,byte *param_3,byte *param_4,undefined4 param_5)

{
  byte bVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  byte local_90;
  byte local_8c;
  int local_88;
  int local_84;
  int local_80;
  byte *local_5c;
  byte *local_54;
  byte *local_50;
  uint local_4c;
  byte *local_48;
  byte *local_40;
  byte *local_38;
  byte *local_34;
  uint local_30;
  byte *local_24;
  byte *local_20;
  uint local_1c;
  byte *local_18;
  byte *local_10;
  uint local_c;
  
  switch(param_5) {
  case 0:
    break;
  case 1:
    uVar3 = *(uint *)(param_2 + 4);
    local_c = (int)(*(byte *)(param_2 + 0xb) + 7) >> 3;
    local_10 = param_3 + local_c;
    local_18 = param_3;
    for (; local_c < uVar3; local_c = local_c + 1) {
      *local_10 = *local_10 + *local_18;
      local_18 = local_18 + 1;
      local_10 = local_10 + 1;
    }
    break;
  case 2:
    uVar3 = *(uint *)(param_2 + 4);
    local_24 = param_3;
    local_20 = param_4;
    for (local_1c = 0; local_1c < uVar3; local_1c = local_1c + 1) {
      *local_24 = *local_24 + *local_20;
      local_20 = local_20 + 1;
      local_24 = local_24 + 1;
    }
    break;
  case 3:
    local_38 = param_3;
    local_34 = param_4;
    local_40 = param_3;
    uVar3 = (int)(*(byte *)(param_2 + 0xb) + 7) >> 3;
    iVar2 = *(int *)(param_2 + 4);
    for (local_30 = 0; local_30 < uVar3; local_30 = local_30 + 1) {
      *local_38 = *local_38 + *local_34 / 2;
      local_34 = local_34 + 1;
      local_38 = local_38 + 1;
    }
    for (local_30 = 0; local_30 < iVar2 - uVar3; local_30 = local_30 + 1) {
      *local_38 = *local_38 + (char)(((uint)*local_34 + (uint)*local_40) / 2);
      local_40 = local_40 + 1;
      local_34 = local_34 + 1;
      local_38 = local_38 + 1;
    }
    break;
  case 4:
    local_54 = param_3;
    local_50 = param_4;
    local_5c = param_3;
    local_48 = param_4;
    uVar3 = (int)(*(byte *)(param_2 + 0xb) + 7) >> 3;
    iVar2 = *(int *)(param_2 + 4);
    for (local_4c = 0; local_4c < uVar3; local_4c = local_4c + 1) {
      *local_54 = *local_54 + *local_50;
      local_50 = local_50 + 1;
      local_54 = local_54 + 1;
    }
    for (local_4c = 0; local_4c < iVar2 - uVar3; local_4c = local_4c + 1) {
      local_8c = *local_5c;
      local_5c = local_5c + 1;
      bVar1 = *local_50;
      local_50 = local_50 + 1;
      local_90 = *local_48;
      local_48 = local_48 + 1;
      local_88 = (uint)bVar1 - (uint)local_90;
      iVar4 = (uint)local_8c - (uint)local_90;
      local_80 = local_88;
      if (local_88 < 0) {
        local_80 = -local_88;
      }
      local_84 = iVar4;
      if (iVar4 < 0) {
        local_84 = -iVar4;
      }
      if (local_88 + iVar4 < 0) {
        local_88 = -(local_88 + iVar4);
      }
      else {
        local_88 = local_88 + iVar4;
      }
      if ((local_84 < local_80) || (local_88 < local_80)) {
        if (local_84 <= local_88) {
          local_90 = bVar1;
        }
        local_8c = local_90;
      }
      *local_54 = *local_54 + local_8c;
      local_54 = local_54 + 1;
    }
    break;
  default:
    FUN_006c24c0(param_1,"Ignoring bad adaptive filter type");
    *param_3 = 0;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
006d3200 : PUSH EBP
006d3201 : MOV EBP,ESP
006d3203 : SUB ESP,0x8c
006d3209 : MOV EAX,dword ptr [EBP + 0x18]
006d320c : MOV dword ptr [EBP + -0x78],EAX
006d320f : CMP dword ptr [EBP + -0x78],0x4
006d3213 : JA 0x006d358b
006d3219 : MOV ECX,dword ptr [EBP + -0x78]
006d321c : JMP dword ptr [ECX*0x4 + 0x6d35a8]
006d3223 : JMP 0x006d35a2
006d3228 : MOV EDX,dword ptr [EBP + 0xc]
006d322b : MOV EAX,dword ptr [EDX + 0x4]
006d322e : MOV dword ptr [EBP + -0x10],EAX
006d3231 : MOV ECX,dword ptr [EBP + 0xc]
006d3234 : MOVZX EDX,byte ptr [ECX + 0xb]
006d3238 : ADD EDX,0x7
006d323b : SAR EDX,0x3
006d323e : MOV dword ptr [EBP + -0x4],EDX
006d3241 : MOV EAX,dword ptr [EBP + 0x10]
006d3244 : ADD EAX,dword ptr [EBP + -0x4]
006d3247 : MOV dword ptr [EBP + -0xc],EAX
006d324a : MOV ECX,dword ptr [EBP + 0x10]
006d324d : MOV dword ptr [EBP + -0x14],ECX
006d3250 : MOV EDX,dword ptr [EBP + -0x4]
006d3253 : MOV dword ptr [EBP + -0x8],EDX
006d3256 : JMP 0x006d3261
006d3258 : MOV EAX,dword ptr [EBP + -0x8]
006d325b : ADD EAX,0x1
006d325e : MOV dword ptr [EBP + -0x8],EAX
006d3261 : MOV ECX,dword ptr [EBP + -0x8]
006d3264 : CMP ECX,dword ptr [EBP + -0x10]
006d3267 : JNC 0x006d3295
006d3269 : MOV EDX,dword ptr [EBP + -0xc]
006d326c : MOVZX EAX,byte ptr [EDX]
006d326f : MOV ECX,dword ptr [EBP + -0x14]
006d3272 : MOVZX EDX,byte ptr [ECX]
006d3275 : ADD EAX,EDX
006d3277 : AND EAX,0xff
006d327c : MOV ECX,dword ptr [EBP + -0xc]
006d327f : MOV byte ptr [ECX],AL
006d3281 : MOV EDX,dword ptr [EBP + -0x14]
006d3284 : ADD EDX,0x1
006d3287 : MOV dword ptr [EBP + -0x14],EDX
006d328a : MOV EAX,dword ptr [EBP + -0xc]
006d328d : ADD EAX,0x1
006d3290 : MOV dword ptr [EBP + -0xc],EAX
006d3293 : JMP 0x006d3258
006d3295 : JMP 0x006d35a2
006d329a : MOV ECX,dword ptr [EBP + 0xc]
006d329d : MOV EDX,dword ptr [ECX + 0x4]
006d32a0 : MOV dword ptr [EBP + -0x24],EDX
006d32a3 : MOV EAX,dword ptr [EBP + 0x10]
006d32a6 : MOV dword ptr [EBP + -0x20],EAX
006d32a9 : MOV ECX,dword ptr [EBP + 0x14]
006d32ac : MOV dword ptr [EBP + -0x1c],ECX
006d32af : MOV dword ptr [EBP + -0x18],0x0
006d32b6 : JMP 0x006d32c1
006d32b8 : MOV EDX,dword ptr [EBP + -0x18]
006d32bb : ADD EDX,0x1
006d32be : MOV dword ptr [EBP + -0x18],EDX
006d32c1 : MOV EAX,dword ptr [EBP + -0x18]
006d32c4 : CMP EAX,dword ptr [EBP + -0x24]
006d32c7 : JNC 0x006d32f6
006d32c9 : MOV ECX,dword ptr [EBP + -0x20]
006d32cc : MOVZX EDX,byte ptr [ECX]
006d32cf : MOV EAX,dword ptr [EBP + -0x1c]
006d32d2 : MOVZX ECX,byte ptr [EAX]
006d32d5 : ADD EDX,ECX
006d32d7 : AND EDX,0xff
006d32dd : MOV EAX,dword ptr [EBP + -0x20]
006d32e0 : MOV byte ptr [EAX],DL
006d32e2 : MOV ECX,dword ptr [EBP + -0x1c]
006d32e5 : ADD ECX,0x1
006d32e8 : MOV dword ptr [EBP + -0x1c],ECX
006d32eb : MOV EDX,dword ptr [EBP + -0x20]
006d32ee : ADD EDX,0x1
006d32f1 : MOV dword ptr [EBP + -0x20],EDX
006d32f4 : JMP 0x006d32b8
006d32f6 : JMP 0x006d35a2
006d32fb : MOV EAX,dword ptr [EBP + 0x10]
006d32fe : MOV dword ptr [EBP + -0x34],EAX
006d3301 : MOV ECX,dword ptr [EBP + 0x14]
006d3304 : MOV dword ptr [EBP + -0x30],ECX
006d3307 : MOV EDX,dword ptr [EBP + 0x10]
006d330a : MOV dword ptr [EBP + -0x3c],EDX
006d330d : MOV EAX,dword ptr [EBP + 0xc]
006d3310 : MOVZX ECX,byte ptr [EAX + 0xb]
006d3314 : ADD ECX,0x7
006d3317 : SAR ECX,0x3
006d331a : MOV dword ptr [EBP + -0x28],ECX
006d331d : MOV EDX,dword ptr [EBP + 0xc]
006d3320 : MOV EAX,dword ptr [EDX + 0x4]
006d3323 : SUB EAX,dword ptr [EBP + -0x28]
006d3326 : MOV dword ptr [EBP + -0x38],EAX
006d3329 : MOV dword ptr [EBP + -0x2c],0x0
006d3330 : JMP 0x006d333b
006d3332 : MOV ECX,dword ptr [EBP + -0x2c]
006d3335 : ADD ECX,0x1
006d3338 : MOV dword ptr [EBP + -0x2c],ECX
006d333b : MOV EDX,dword ptr [EBP + -0x2c]
006d333e : CMP EDX,dword ptr [EBP + -0x28]
006d3341 : JNC 0x006d3375
006d3343 : MOV EAX,dword ptr [EBP + -0x34]
006d3346 : MOVZX ECX,byte ptr [EAX]
006d3349 : MOV EDX,dword ptr [EBP + -0x30]
006d334c : MOVZX EAX,byte ptr [EDX]
006d334f : CDQ
006d3350 : SUB EAX,EDX
006d3352 : SAR EAX,0x1
006d3354 : ADD ECX,EAX
006d3356 : AND ECX,0xff
006d335c : MOV EAX,dword ptr [EBP + -0x34]
006d335f : MOV byte ptr [EAX],CL
006d3361 : MOV ECX,dword ptr [EBP + -0x30]
006d3364 : ADD ECX,0x1
006d3367 : MOV dword ptr [EBP + -0x30],ECX
006d336a : MOV EDX,dword ptr [EBP + -0x34]
006d336d : ADD EDX,0x1
006d3370 : MOV dword ptr [EBP + -0x34],EDX
006d3373 : JMP 0x006d3332
006d3375 : MOV dword ptr [EBP + -0x2c],0x0
006d337c : JMP 0x006d3387
006d337e : MOV EAX,dword ptr [EBP + -0x2c]
006d3381 : ADD EAX,0x1
006d3384 : MOV dword ptr [EBP + -0x2c],EAX
006d3387 : MOV ECX,dword ptr [EBP + -0x2c]
006d338a : CMP ECX,dword ptr [EBP + -0x38]
006d338d : JNC 0x006d33d2
006d338f : MOV EDX,dword ptr [EBP + -0x34]
006d3392 : MOVZX ECX,byte ptr [EDX]
006d3395 : MOV EDX,dword ptr [EBP + -0x30]
006d3398 : MOVZX EAX,byte ptr [EDX]
006d339b : MOV EDX,dword ptr [EBP + -0x3c]
006d339e : MOVZX EDX,byte ptr [EDX]
006d33a1 : ADD EAX,EDX
006d33a3 : CDQ
006d33a4 : SUB EAX,EDX
006d33a6 : SAR EAX,0x1
006d33a8 : ADD ECX,EAX
006d33aa : AND ECX,0xff
006d33b0 : MOV EAX,dword ptr [EBP + -0x34]
006d33b3 : MOV byte ptr [EAX],CL
006d33b5 : MOV ECX,dword ptr [EBP + -0x3c]
006d33b8 : ADD ECX,0x1
006d33bb : MOV dword ptr [EBP + -0x3c],ECX
006d33be : MOV EDX,dword ptr [EBP + -0x30]
006d33c1 : ADD EDX,0x1
006d33c4 : MOV dword ptr [EBP + -0x30],EDX
006d33c7 : MOV EAX,dword ptr [EBP + -0x34]
006d33ca : ADD EAX,0x1
006d33cd : MOV dword ptr [EBP + -0x34],EAX
006d33d0 : JMP 0x006d337e
006d33d2 : JMP 0x006d35a2
006d33d7 : MOV ECX,dword ptr [EBP + 0x10]
006d33da : MOV dword ptr [EBP + -0x50],ECX
006d33dd : MOV EDX,dword ptr [EBP + 0x14]
006d33e0 : MOV dword ptr [EBP + -0x4c],EDX
006d33e3 : MOV EAX,dword ptr [EBP + 0x10]
006d33e6 : MOV dword ptr [EBP + -0x58],EAX
006d33e9 : MOV ECX,dword ptr [EBP + 0x14]
006d33ec : MOV dword ptr [EBP + -0x44],ECX
006d33ef : MOV EDX,dword ptr [EBP + 0xc]
006d33f2 : MOVZX EAX,byte ptr [EDX + 0xb]
006d33f6 : ADD EAX,0x7
006d33f9 : SAR EAX,0x3
006d33fc : MOV dword ptr [EBP + -0x40],EAX
006d33ff : MOV ECX,dword ptr [EBP + 0xc]
006d3402 : MOV EDX,dword ptr [ECX + 0x4]
006d3405 : SUB EDX,dword ptr [EBP + -0x40]
006d3408 : MOV dword ptr [EBP + -0x54],EDX
006d340b : MOV dword ptr [EBP + -0x48],0x0
006d3412 : JMP 0x006d341d
006d3414 : MOV EAX,dword ptr [EBP + -0x48]
006d3417 : ADD EAX,0x1
006d341a : MOV dword ptr [EBP + -0x48],EAX
006d341d : MOV ECX,dword ptr [EBP + -0x48]
006d3420 : CMP ECX,dword ptr [EBP + -0x40]
006d3423 : JNC 0x006d3451
006d3425 : MOV EDX,dword ptr [EBP + -0x50]
006d3428 : MOVZX EAX,byte ptr [EDX]
006d342b : MOV ECX,dword ptr [EBP + -0x4c]
006d342e : MOVZX EDX,byte ptr [ECX]
006d3431 : ADD EAX,EDX
006d3433 : AND EAX,0xff
006d3438 : MOV ECX,dword ptr [EBP + -0x50]
006d343b : MOV byte ptr [ECX],AL
006d343d : MOV EDX,dword ptr [EBP + -0x4c]
006d3440 : ADD EDX,0x1
006d3443 : MOV dword ptr [EBP + -0x4c],EDX
006d3446 : MOV EAX,dword ptr [EBP + -0x50]
006d3449 : ADD EAX,0x1
006d344c : MOV dword ptr [EBP + -0x50],EAX
006d344f : JMP 0x006d3414
006d3451 : MOV dword ptr [EBP + -0x48],0x0
006d3458 : JMP 0x006d3463
006d345a : MOV ECX,dword ptr [EBP + -0x48]
006d345d : ADD ECX,0x1
006d3460 : MOV dword ptr [EBP + -0x48],ECX
006d3463 : MOV EDX,dword ptr [EBP + -0x48]
006d3466 : CMP EDX,dword ptr [EBP + -0x54]
006d3469 : JNC 0x006d3589
006d346f : MOV EAX,dword ptr [EBP + -0x58]
006d3472 : MOVZX ECX,byte ptr [EAX]
006d3475 : MOV dword ptr [EBP + -0x60],ECX
006d3478 : MOV EDX,dword ptr [EBP + -0x58]
006d347b : ADD EDX,0x1
006d347e : MOV dword ptr [EBP + -0x58],EDX
006d3481 : MOV EAX,dword ptr [EBP + -0x4c]
006d3484 : MOVZX ECX,byte ptr [EAX]
006d3487 : MOV dword ptr [EBP + -0x6c],ECX
006d348a : MOV EDX,dword ptr [EBP + -0x4c]
006d348d : ADD EDX,0x1
006d3490 : MOV dword ptr [EBP + -0x4c],EDX
006d3493 : MOV EAX,dword ptr [EBP + -0x44]
006d3496 : MOVZX ECX,byte ptr [EAX]
006d3499 : MOV dword ptr [EBP + -0x74],ECX
006d349c : MOV EDX,dword ptr [EBP + -0x44]
006d349f : ADD EDX,0x1
006d34a2 : MOV dword ptr [EBP + -0x44],EDX
006d34a5 : MOV EAX,dword ptr [EBP + -0x6c]
006d34a8 : SUB EAX,dword ptr [EBP + -0x74]
006d34ab : MOV dword ptr [EBP + -0x5c],EAX
006d34ae : MOV ECX,dword ptr [EBP + -0x60]
006d34b1 : SUB ECX,dword ptr [EBP + -0x74]
006d34b4 : MOV dword ptr [EBP + -0x64],ECX
006d34b7 : CMP dword ptr [EBP + -0x5c],0x0
006d34bb : JGE 0x006d34c7
006d34bd : MOV EDX,dword ptr [EBP + -0x5c]
006d34c0 : NEG EDX
006d34c2 : MOV dword ptr [EBP + -0x7c],EDX
006d34c5 : JMP 0x006d34cd
006d34c7 : MOV EAX,dword ptr [EBP + -0x5c]
006d34ca : MOV dword ptr [EBP + -0x7c],EAX
006d34cd : MOV ECX,dword ptr [EBP + -0x7c]
006d34d0 : MOV dword ptr [EBP + -0x68],ECX
006d34d3 : CMP dword ptr [EBP + -0x64],0x0
006d34d7 : JGE 0x006d34e3
006d34d9 : MOV EDX,dword ptr [EBP + -0x64]
006d34dc : NEG EDX
006d34de : MOV dword ptr [EBP + -0x80],EDX
006d34e1 : JMP 0x006d34e9
006d34e3 : MOV EAX,dword ptr [EBP + -0x64]
006d34e6 : MOV dword ptr [EBP + -0x80],EAX
006d34e9 : MOV ECX,dword ptr [EBP + -0x80]
006d34ec : MOV dword ptr [EBP + -0x70],ECX
006d34ef : MOV EDX,dword ptr [EBP + -0x5c]
006d34f2 : ADD EDX,dword ptr [EBP + -0x64]
006d34f5 : JNS 0x006d3507
006d34f7 : MOV EAX,dword ptr [EBP + -0x5c]
006d34fa : ADD EAX,dword ptr [EBP + -0x64]
006d34fd : NEG EAX
006d34ff : MOV dword ptr [EBP + 0xffffff7c],EAX
006d3505 : JMP 0x006d3513
006d3507 : MOV ECX,dword ptr [EBP + -0x5c]
006d350a : ADD ECX,dword ptr [EBP + -0x64]
006d350d : MOV dword ptr [EBP + 0xffffff7c],ECX
006d3513 : MOV EDX,dword ptr [EBP + 0xffffff7c]
006d3519 : MOV dword ptr [EBP + -0x64],EDX
006d351c : MOV EAX,dword ptr [EBP + -0x68]
006d351f : CMP EAX,dword ptr [EBP + -0x70]
006d3522 : JG 0x006d3537
006d3524 : MOV ECX,dword ptr [EBP + -0x68]
006d3527 : CMP ECX,dword ptr [EBP + -0x64]
006d352a : JG 0x006d3537
006d352c : MOV EDX,dword ptr [EBP + -0x60]
006d352f : MOV dword ptr [EBP + 0xffffff78],EDX
006d3535 : JMP 0x006d355f
006d3537 : MOV EAX,dword ptr [EBP + -0x70]
006d353a : CMP EAX,dword ptr [EBP + -0x64]
006d353d : JG 0x006d354a
006d353f : MOV ECX,dword ptr [EBP + -0x6c]
006d3542 : MOV dword ptr [EBP + 0xffffff74],ECX
006d3548 : JMP 0x006d3553
006d354a : MOV EDX,dword ptr [EBP + -0x74]
006d354d : MOV dword ptr [EBP + 0xffffff74],EDX
006d3553 : MOV EAX,dword ptr [EBP + 0xffffff74]
006d3559 : MOV dword ptr [EBP + 0xffffff78],EAX
006d355f : MOV ECX,dword ptr [EBP + 0xffffff78]
006d3565 : MOV dword ptr [EBP + -0x5c],ECX
006d3568 : MOV EDX,dword ptr [EBP + -0x50]
006d356b : MOVZX EAX,byte ptr [EDX]
006d356e : ADD EAX,dword ptr [EBP + -0x5c]
006d3571 : AND EAX,0xff
006d3576 : MOV ECX,dword ptr [EBP + -0x50]
006d3579 : MOV byte ptr [ECX],AL
006d357b : MOV EDX,dword ptr [EBP + -0x50]
006d357e : ADD EDX,0x1
006d3581 : MOV dword ptr [EBP + -0x50],EDX
006d3584 : JMP 0x006d345a
006d3589 : JMP 0x006d35a2
006d358b : PUSH 0xbeee70
006d3590 : MOV EAX,dword ptr [EBP + 0x8]
006d3593 : PUSH EAX
006d3594 : CALL 0x006c24c0
006d3599 : ADD ESP,0x8
006d359c : MOV ECX,dword ptr [EBP + 0x10]
006d359f : MOV byte ptr [ECX],0x0
006d35a2 : MOV ESP,EBP
006d35a4 : POP EBP
006d35a5 : RET

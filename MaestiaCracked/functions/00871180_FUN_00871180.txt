PROGRAM  : Maestia.exe
FUNCTION : FUN_00871180
ENTRY    : 00871180
BODY     : [[00871180, 0087149c] [008714a0, 0087189b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00871180(int param_1)

{
  short *psVar1;
  short sVar2;
  int *piVar3;
  char cVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  undefined4 uVar8;
  int *in_ECX;
  int iVar9;
  undefined8 uVar10;
  undefined1 auStack_27c [3];
  undefined1 uStack_279;
  uint local_278;
  int local_274;
  int local_270;
  int iStack_26c;
  int local_268 [2];
  undefined1 local_260 [4];
  int iStack_25c;
  undefined1 local_23c [4];
  undefined2 local_238;
  undefined4 local_228;
  uint local_224;
  wchar_t local_220 [258];
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b49186;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_27c;
  uVar5 = DAT_00d66fa0 ^ (uint)&stack0xfffffd78;
  ExceptionList = &local_14;
  if (in_ECX[0x110] == 0) {
    FUN_00406460(L"AniTable NULL");
    local_c = 0;
    if ((int *)*DAT_00da98e8 != (int *)0x0) {
      (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                (L"AvaMyCharacter::SetWeaponType",0x4fa,local_23c,uVar5);
    }
    local_c = 0xffffffff;
    if (7 < local_224) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_224 = 7;
    local_228 = 0;
    local_238 = 0;
    goto LAB_00871876;
  }
  iVar6 = in_ECX[0x5fc];
  local_268[0] = iVar6;
  FUN_00856fb0(param_1);
  local_278 = 0;
  *(undefined1 *)(in_ECX + 0x5a4) = 0;
  if (param_1 == 0) {
    FUN_0084fb70();
    in_ECX[0x69c] = 0;
    *(undefined4 *)(iVar6 + 0x160) = 0;
    iVar6 = FUN_004049b0(in_ECX[2]);
    if (*(int *)(iVar6 + 300) != 0) {
      local_274 = (**(code **)(*(int *)(*(int *)(iVar6 + 300) + 0x1f8) + 4))();
      while (local_274 != 0) {
        iVar6 = FUN_004f5680();
        sVar2 = *(short *)(iVar6 + 0x18);
        if ((((sVar2 == 3) || (sVar2 == 4)) || (sVar2 == 5)) || (sVar2 == 0xb)) {
          FUN_0088cc50(sVar2,iVar6);
        }
      }
    }
  }
  else {
    iVar6 = FUN_004049b0(param_1);
    piVar3 = DAT_00da9894;
    local_274 = iVar6;
    if (iVar6 == 0) {
      __snwprintf(local_220,0x100,L"[AvaMyCharacter::SetWeaponType] %d -> Invaild Weapon Proto",
                  param_1);
      FUN_008018d0(local_220);
      goto LAB_00871876;
    }
    if ((*(uint *)(iVar6 + 0x4c) & 0x100000) != 0) {
      *(undefined1 *)(in_ECX + 0x5a4) = 1;
      iVar7 = *piVar3;
      if (((iVar7 != 0) && (*(int *)(iVar7 + 0x2cc) != 0)) &&
         (*(char *)(*(int *)(iVar7 + 0x2cc) + 0x32) == '\x01')) {
        FUN_0099c7f0(*(int *)(iVar7 + 0x2cc));
      }
    }
    in_ECX[0x69c] = *(int *)(iVar6 + 0x29c);
    local_278 = (uint)*(ushort *)(iVar6 + 0x28a);
    local_224 = 7;
    local_228 = 0;
    local_238 = 0;
    local_c = 1;
    local_270 = 0;
    if ((in_ECX[0x616] == 0) ||
       (iVar7 = FUN_004049b0(*(undefined4 *)(in_ECX[0x616] + 0x28)), local_270 = iVar7, iVar7 == 0))
    {
      uVar8 = FUN_00404350(iVar6 + 400);
      local_c._0_1_ = 4;
      FUN_00405eb0(uVar8,0,0xffffffff);
      local_c._0_1_ = 1;
      FUN_00406560();
      uVar8 = FUN_00404350(iVar6 + 0x1d0);
      local_c._0_1_ = 5;
    }
    else {
      uVar8 = FUN_00404350(iVar7 + 400);
      local_c._0_1_ = 2;
      FUN_00405eb0(uVar8,0,0xffffffff);
      local_c._0_1_ = 1;
      FUN_00406560();
      uVar8 = FUN_00404350(iVar7 + 0x1d0);
      local_c._0_1_ = 3;
    }
    FUN_00405eb0(uVar8,0,0xffffffff);
    local_c = CONCAT31(local_c._1_3_,1);
    FUN_00406560();
    iVar6 = local_268[0];
    if ((char)in_ECX[0x5a4] == '\x01') {
      local_278 = 1;
    }
    FUN_0084fd30(local_278 & 0xffff);
    *(undefined1 *)(iVar6 + 0x1a8) = 0;
    if (*(int **)(iVar6 + 0x168) != (int *)0x0) {
      (**(code **)(**(int **)(iVar6 + 0x168) + 0x10))(0);
    }
    if (*(int **)(iVar6 + 0x16c) != (int *)0x0) {
      (**(code **)(**(int **)(iVar6 + 0x16c) + 0x10))(0);
    }
    cVar4 = FUN_00412ff0();
    if (cVar4 != '\0') {
      (**(code **)(*in_ECX + 0x49c))(local_278,0);
    }
    local_268[0] = (**(code **)(*(int *)(local_274 + 0x210) + 4))();
    while (local_268[0] != 0) {
      iVar7 = FUN_004f5680();
      FUN_0088ccd0(*(undefined2 *)(iVar7 + 0x18),iVar7);
    }
    uVar5 = (uint)*(ushort *)(local_274 + 0x28a);
    local_278 = uVar5;
    if (local_270 == 0) {
      (**(code **)(*in_ECX + 0x45c))(local_274,param_1,uVar5);
    }
    *(uint *)(iVar6 + 0x160) = uVar5;
    FUN_0084c320((char)in_ECX[0x663]);
    if ((char)in_ECX[0x663] != '\0') {
      *(undefined1 *)(iVar6 + 0x1a8) = 0;
      if (*(int **)(iVar6 + 0x168) != (int *)0x0) {
        (**(code **)(**(int **)(iVar6 + 0x168) + 0x10))(0);
      }
      if (*(int **)(iVar6 + 0x16c) != (int *)0x0) {
        (**(code **)(**(int **)(iVar6 + 0x16c) + 0x10))(0);
      }
    }
    local_c = 0xffffffff;
    FUN_00406560();
  }
  if ((char)in_ECX[0x5a4] == '\x01') {
    local_278 = 1;
  }
  if (((short)in_ECX[0x10f] == (short)local_278) || ((short)in_ECX[0x10f] == 6)) goto LAB_00871876;
  *(short *)(in_ECX + 0x10f) = (short)local_278;
  FUN_00404a20(local_260);
  local_c._0_1_ = 6;
  local_c._1_3_ = 0;
  psVar1 = (short *)((int)in_ECX + 0x43a);
  local_274 = FUN_0088cdd0(psVar1,&uStack_279,0,0);
  if ((in_ECX[0x62a] == 0) || (*(char *)(in_ECX[0x62a] + 0x20) == '\0')) {
    if (local_274 == 4) {
      FUN_00abdd00(&local_270,local_278,*psVar1 + 1000,0);
      local_c._0_1_ = 9;
      FUN_00463a60();
      local_c._0_1_ = 6;
      FUN_0040ed80(&local_270);
      if (iStack_25c != 0) goto LAB_008717c5;
      FUN_00abdd00(&local_270,local_278,*(undefined2 *)((int)in_ECX + 0x43a),0);
      local_c._0_1_ = 10;
      FUN_00463a60();
    }
    else {
      FUN_00abdd00(&local_270,local_278,*psVar1,0);
      local_c._0_1_ = 0xb;
      FUN_00463a60();
    }
LAB_008717c0:
    local_c._0_1_ = 6;
    FUN_0040ed80(&local_270);
  }
  else {
    uVar10 = FUN_0083ac80();
    if ((short)uVar10 != 0) {
      *psVar1 = (short)uVar10;
      uStack_279 = 0;
      FUN_00abe000(&local_270,*(undefined4 *)((int)((ulonglong)uVar10 >> 0x20) + 0x24),
                   (uint)uVar10 & 0xffff,(short)in_ECX[0x1f],1);
      local_c._0_1_ = 7;
      if (iStack_26c == 0) {
        FUN_00abe000(local_268,(short)in_ECX[0x10f],*psVar1,(short)in_ECX[0x1f],0);
        local_c._0_1_ = 8;
        FUN_00463a60();
        local_c._0_1_ = 7;
        FUN_0040ed80(local_268);
      }
      goto LAB_008717c0;
    }
  }
LAB_008717c5:
  iVar6 = 0;
  if (local_274 == 4) {
    iVar6 = 1;
  }
  else if (local_274 == 3) {
    iVar6 = 2;
  }
  iVar7 = in_ECX[0x104];
  local_270 = CONCAT31(local_270._1_3_,*(undefined1 *)(iVar6 * 0x30 + 0xb0 + iVar7));
  iVar9 = (iVar6 * 3 + 9) * 0x10;
  local_268[0] = *(int *)(iVar9 + iVar7);
  FUN_0079d530(iVar7,local_260,*(undefined2 *)((int)in_ECX + 0x43a),local_274,0,local_270,0x3f800000
               ,0x3f800000);
  *(int *)(in_ECX[0x104] + iVar9) = local_268[0];
  *(undefined1 *)(in_ECX[0x104] + 0xb6 + iVar6 * 0x30) = 1;
  (**(code **)(*(int *)in_ECX[0x104] + 0x10))();
  local_c = 0xffffffff;
  FUN_0040ed80(local_260);
LAB_00871876:
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_27c);
  return;
}



============================================================
DISASSEMBLY
============================================================
00871180 : PUSH EBP
00871181 : MOV EBP,ESP
00871183 : AND ESP,0xfffffff8
00871186 : PUSH -0x1
00871188 : PUSH 0xb49186
0087118d : MOV EAX,FS:[0x0]
00871193 : PUSH EAX
00871194 : SUB ESP,0x268
0087119a : MOV EAX,[0x00d66fa0]
0087119f : XOR EAX,ESP
008711a1 : MOV dword ptr [ESP + 0x260],EAX
008711a8 : PUSH EBX
008711a9 : PUSH ESI
008711aa : PUSH EDI
008711ab : MOV EAX,[0x00d66fa0]
008711b0 : XOR EAX,ESP
008711b2 : PUSH EAX
008711b3 : LEA EAX,[ESP + 0x278]
008711ba : MOV FS:[0x0],EAX
008711c0 : MOV EBX,ECX
008711c2 : XOR ESI,ESI
008711c4 : CMP dword ptr [EBX + 0x440],ESI
008711ca : JNZ 0x00871235
008711cc : PUSH 0xc4251c
008711d1 : LEA ECX,[ESP + 0x54]
008711d5 : CALL 0x00406460
008711da : MOV dword ptr [ESP + 0x280],ESI
008711e1 : MOV EAX,[0x00da98e8]
008711e6 : MOV ECX,dword ptr [EAX]
008711e8 : CMP ECX,ESI
008711ea : JZ 0x00871202
008711ec : MOV EDX,dword ptr [ECX]
008711ee : MOV EDX,dword ptr [EDX + 0x14]
008711f1 : LEA EAX,[ESP + 0x50]
008711f5 : PUSH EAX
008711f6 : PUSH 0x4fa
008711fb : PUSH 0xc42538
00871200 : CALL EDX
00871202 : MOV dword ptr [ESP + 0x280],0xffffffff
0087120d : CMP dword ptr [ESP + 0x68],0x8
00871212 : JC 0x0087121d
00871214 : MOV ECX,dword ptr [ESP + 0x54]
00871218 : CALL 0x006f04e0
0087121d : XOR EAX,EAX
0087121f : MOV dword ptr [ESP + 0x68],0x7
00871227 : MOV dword ptr [ESP + 0x64],ESI
0087122b : MOV word ptr [ESP + 0x54],AX
00871230 : JMP 0x00871876
00871235 : MOV ECX,dword ptr [EBP + 0x8]
00871238 : MOV EDI,dword ptr [EBX + 0x17f0]
0087123e : PUSH ECX
0087123f : MOV ESI,EBX
00871241 : MOV dword ptr [ESP + 0x28],EDI
00871245 : CALL 0x00856fb0
0087124a : MOV EAX,dword ptr [EBP + 0x8]
0087124d : MOV dword ptr [ESP + 0x14],0x0
00871255 : MOV byte ptr [EBX + 0x1690],0x0
0087125c : TEST EAX,EAX
0087125e : JZ 0x0087154c
00871264 : PUSH EAX
00871265 : CALL 0x004049b0
0087126a : MOV EDI,EAX
0087126c : XOR ESI,ESI
0087126e : ADD ESP,0x4
00871271 : MOV dword ptr [ESP + 0x18],EDI
00871275 : CMP EDI,ESI
00871277 : JNZ 0x008712a9
00871279 : MOV EDX,dword ptr [EBP + 0x8]
0087127c : PUSH EDX
0087127d : PUSH 0xc42578
00871282 : LEA EAX,[ESP + 0x74]
00871286 : PUSH 0x100
0087128b : PUSH EAX
0087128c : CALL 0x006343c8
00871291 : MOV ESI,dword ptr [0x00da98e8]
00871297 : LEA ECX,[ESP + 0x7c]
0087129b : PUSH ECX
0087129c : CALL 0x008018d0
008712a1 : ADD ESP,0x14
008712a4 : JMP 0x00871876
008712a9 : MOV ECX,dword ptr [EDI + 0x4c]
008712ac : AND ECX,0x100000
008712b2 : XOR EAX,EAX
008712b4 : OR EAX,ECX
008712b6 : JZ 0x008712e7
008712b8 : MOV EDX,dword ptr [0x00da9894]
008712be : MOV byte ptr [EBX + 0x1690],0x1
008712c5 : MOV EAX,dword ptr [EDX]
008712c7 : CMP EAX,ESI
008712c9 : JZ 0x008712e7
008712cb : CMP dword ptr [EAX + 0x2cc],ESI
008712d1 : JZ 0x008712e7
008712d3 : MOV ECX,dword ptr [EAX + 0x2cc]
008712d9 : CMP byte ptr [ECX + 0x32],0x1
008712dd : JNZ 0x008712e7
008712df : MOV EAX,ECX
008712e1 : PUSH EAX
008712e2 : CALL 0x0099c7f0
008712e7 : MOV EAX,dword ptr [EDI + 0x29c]
008712ed : MOV dword ptr [EBX + 0x1a70],EAX
008712f3 : MOVZX EAX,word ptr [EDI + 0x28a]
008712fa : XOR ECX,ECX
008712fc : MOV dword ptr [ESP + 0x14],EAX
00871300 : MOV dword ptr [ESP + 0x68],0x7
00871308 : MOV dword ptr [ESP + 0x64],ESI
0087130c : MOV word ptr [ESP + 0x54],CX
00871311 : MOV dword ptr [ESP + 0x280],0x1
0087131c : MOV EAX,dword ptr [EBX + 0x1858]
00871322 : MOV dword ptr [ESP + 0x1c],ESI
00871326 : CMP EAX,ESI
00871328 : JZ 0x00871395
0087132a : MOV EAX,dword ptr [EAX + 0x28]
0087132d : PUSH EAX
0087132e : CALL 0x004049b0
00871333 : ADD ESP,0x4
00871336 : MOV dword ptr [ESP + 0x1c],EAX
0087133a : CMP EAX,ESI
0087133c : JZ 0x00871395
0087133e : MOV EDI,EAX
00871340 : LEA EDX,[EDI + 0x190]
00871346 : PUSH EDX
00871347 : LEA ESI,[ESP + 0x38]
0087134b : CALL 0x00404350
00871350 : ADD ESP,0x4
00871353 : MOV byte ptr [ESP + 0x280],0x2
0087135b : PUSH -0x1
0087135d : PUSH 0x0
0087135f : PUSH EAX
00871360 : LEA ECX,[ESP + 0x5c]
00871364 : CALL 0x00405eb0
00871369 : MOV byte ptr [ESP + 0x280],0x1
00871371 : MOV ECX,ESI
00871373 : CALL 0x00406560
00871378 : ADD EDI,0x1d0
0087137e : PUSH EDI
0087137f : LEA ESI,[ESP + 0x38]
00871383 : CALL 0x00404350
00871388 : ADD ESP,0x4
0087138b : MOV byte ptr [ESP + 0x280],0x3
00871393 : JMP 0x008713e8
00871395 : LEA EAX,[EDI + 0x190]
0087139b : PUSH EAX
0087139c : LEA ESI,[ESP + 0x38]
008713a0 : CALL 0x00404350
008713a5 : ADD ESP,0x4
008713a8 : MOV byte ptr [ESP + 0x280],0x4
008713b0 : PUSH -0x1
008713b2 : PUSH 0x0
008713b4 : PUSH EAX
008713b5 : LEA ECX,[ESP + 0x5c]
008713b9 : CALL 0x00405eb0
008713be : MOV byte ptr [ESP + 0x280],0x1
008713c6 : MOV ECX,ESI
008713c8 : CALL 0x00406560
008713cd : ADD EDI,0x1d0
008713d3 : PUSH EDI
008713d4 : LEA ESI,[ESP + 0x38]
008713d8 : CALL 0x00404350
008713dd : ADD ESP,0x4
008713e0 : MOV byte ptr [ESP + 0x280],0x5
008713e8 : MOV ECX,dword ptr [ESP + 0x24]
008713ec : PUSH -0x1
008713ee : PUSH 0x0
008713f0 : PUSH EAX
008713f1 : ADD ECX,0x170
008713f7 : CALL 0x00405eb0
008713fc : MOV byte ptr [ESP + 0x280],0x1
00871404 : LEA ECX,[ESP + 0x34]
00871408 : CALL 0x00406560
0087140d : CMP byte ptr [EBX + 0x1690],0x1
00871414 : JNZ 0x0087141e
00871416 : MOV dword ptr [ESP + 0x14],0x1
0087141e : MOVZX ECX,word ptr [ESP + 0x14]
00871423 : MOV ESI,dword ptr [ESP + 0x24]
00871427 : PUSH ECX
00871428 : LEA EDI,[ESP + 0x54]
0087142c : CALL 0x0084fd30
00871431 : MOV EDI,ESI
00871433 : MOV ECX,dword ptr [EDI + 0x168]
00871439 : MOV byte ptr [EDI + 0x1a8],0x0
00871440 : TEST ECX,ECX
00871442 : JZ 0x0087144d
00871444 : MOV EDX,dword ptr [ECX]
00871446 : MOV EAX,dword ptr [EDX + 0x10]
00871449 : PUSH 0x0
0087144b : CALL EAX
0087144d : MOV ECX,dword ptr [EDI + 0x16c]
00871453 : TEST ECX,ECX
00871455 : JZ 0x00871460
00871457 : MOV EDX,dword ptr [ECX]
00871459 : MOV EAX,dword ptr [EDX + 0x10]
0087145c : PUSH 0x0
0087145e : CALL EAX
00871460 : CALL 0x00412ff0
00871465 : TEST AL,AL
00871467 : JZ 0x0087147c
00871469 : MOV EDX,dword ptr [EBX]
0087146b : MOV EAX,dword ptr [ESP + 0x14]
0087146f : MOV EDX,dword ptr [EDX + 0x49c]
00871475 : PUSH 0x0
00871477 : PUSH EAX
00871478 : MOV ECX,EBX
0087147a : CALL EDX
0087147c : MOV ESI,dword ptr [ESP + 0x18]
00871480 : MOV EAX,dword ptr [ESI + 0x210]
00871486 : MOV EDX,dword ptr [EAX + 0x4]
00871489 : ADD ESI,0x210
0087148f : MOV ECX,ESI
00871491 : CALL EDX
00871493 : MOV dword ptr [ESP + 0x24],EAX
00871497 : TEST EAX,EAX
00871499 : JZ 0x008714bf
0087149b : JMP 0x008714a0
008714a0 : LEA EDX,[ESP + 0x24]
008714a4 : MOV EAX,ESI
008714a6 : CALL 0x004f5680
008714ab : PUSH EAX
008714ac : MOVZX EAX,word ptr [EAX + 0x18]
008714b0 : PUSH EAX
008714b1 : MOV EAX,EBX
008714b3 : CALL 0x0088ccd0
008714b8 : CMP dword ptr [ESP + 0x24],0x0
008714bd : JNZ 0x008714a0
008714bf : CMP dword ptr [ESP + 0x1c],0x0
008714c4 : MOV EAX,dword ptr [ESP + 0x18]
008714c8 : MOVZX ESI,word ptr [EAX + 0x28a]
008714cf : MOV dword ptr [ESP + 0x14],ESI
008714d3 : JNZ 0x008714e7
008714d5 : MOV ECX,dword ptr [EBP + 0x8]
008714d8 : MOV EDX,dword ptr [EBX]
008714da : MOV EDX,dword ptr [EDX + 0x45c]
008714e0 : PUSH ESI
008714e1 : PUSH ECX
008714e2 : PUSH EAX
008714e3 : MOV ECX,EBX
008714e5 : CALL EDX
008714e7 : MOVZX EAX,SI
008714ea : MOV dword ptr [EDI + 0x160],EAX
008714f0 : MOVZX ECX,byte ptr [EBX + 0x198c]
008714f7 : PUSH ECX
008714f8 : CALL 0x0084c320
008714fd : CMP byte ptr [EBX + 0x198c],0x0
00871504 : JZ 0x00871533
00871506 : MOV ECX,dword ptr [EDI + 0x168]
0087150c : MOV byte ptr [EDI + 0x1a8],0x0
00871513 : TEST ECX,ECX
00871515 : JZ 0x00871520
00871517 : MOV EDX,dword ptr [ECX]
00871519 : MOV EAX,dword ptr [EDX + 0x10]
0087151c : PUSH 0x0
0087151e : CALL EAX
00871520 : MOV ECX,dword ptr [EDI + 0x16c]
00871526 : TEST ECX,ECX
00871528 : JZ 0x00871533
0087152a : MOV EDX,dword ptr [ECX]
0087152c : MOV EAX,dword ptr [EDX + 0x10]
0087152f : PUSH 0x0
00871531 : CALL EAX
00871533 : MOV dword ptr [ESP + 0x280],0xffffffff
0087153e : LEA ECX,[ESP + 0x50]
00871542 : CALL 0x00406560
00871547 : JMP 0x008715cb
0087154c : MOV ESI,EDI
0087154e : CALL 0x0084fb70
00871553 : XOR ESI,ESI
00871555 : MOV dword ptr [EBX + 0x1a70],ESI
0087155b : MOV dword ptr [EDI + 0x160],ESI
00871561 : MOV EAX,dword ptr [EBX + 0x8]
00871564 : PUSH EAX
00871565 : CALL 0x004049b0
0087156a : MOV EAX,dword ptr [EAX + 0x12c]
00871570 : ADD ESP,0x4
00871573 : CMP EAX,ESI
00871575 : JZ 0x008715cb
00871577 : MOV EDX,dword ptr [EAX + 0x1f8]
0087157d : LEA EDI,[EAX + 0x1f8]
00871583 : MOV EAX,dword ptr [EDX + 0x4]
00871586 : MOV ECX,EDI
00871588 : CALL EAX
0087158a : MOV dword ptr [ESP + 0x18],EAX
0087158e : CMP EAX,ESI
00871590 : JZ 0x008715cb
00871592 : LEA EDX,[ESP + 0x18]
00871596 : MOV EAX,EDI
00871598 : CALL 0x004f5680
0087159d : MOVZX ECX,word ptr [EAX + 0x18]
008715a1 : CMP CX,0x3
008715a5 : JZ 0x008715b9
008715a7 : CMP CX,0x4
008715ab : JZ 0x008715b9
008715ad : CMP CX,0x5
008715b1 : JZ 0x008715b9
008715b3 : CMP CX,0xb
008715b7 : JNZ 0x008715c5
008715b9 : MOVZX ECX,CX
008715bc : PUSH EAX
008715bd : PUSH ECX
008715be : MOV EAX,EBX
008715c0 : CALL 0x0088cc50
008715c5 : CMP dword ptr [ESP + 0x18],ESI
008715c9 : JNZ 0x00871592
008715cb : CMP byte ptr [EBX + 0x1690],0x1
008715d2 : JNZ 0x008715dc
008715d4 : MOV dword ptr [ESP + 0x14],0x1
008715dc : MOVZX ECX,word ptr [EBX + 0x43c]
008715e3 : MOV EAX,dword ptr [ESP + 0x14]
008715e7 : CMP CX,AX
008715ea : JZ 0x00871876
008715f0 : CMP CX,0x6
008715f4 : JZ 0x00871876
008715fa : LEA EDX,[ESP + 0x2c]
008715fe : PUSH EDX
008715ff : MOV word ptr [EBX + 0x43c],AX
00871606 : CALL 0x00404a20
0087160b : MOV dword ptr [ESP + 0x280],0x6
00871616 : PUSH 0x0
00871618 : PUSH 0x0
0087161a : LEA EAX,[ESP + 0x1b]
0087161e : PUSH EAX
0087161f : LEA ESI,[EBX + 0x43a]
00871625 : PUSH ESI
00871626 : MOV EDI,EBX
00871628 : CALL 0x0088cdd0
0087162d : MOV EDX,dword ptr [EBX + 0x18a8]
00871633 : MOV dword ptr [ESP + 0x18],EAX
00871637 : TEST EDX,EDX
00871639 : JZ 0x008716f2
0087163f : CMP byte ptr [EDX + 0x20],0x0
00871643 : JZ 0x008716f2
00871649 : MOV CX,word ptr [ESI]
0087164c : CALL 0x0083ac80
00871651 : MOVZX EAX,AX
00871654 : TEST AX,AX
00871657 : JBE 0x008717c5
0087165d : MOVZX ECX,word ptr [EBX + 0x7c]
00871661 : PUSH 0x1
00871663 : PUSH ECX
00871664 : MOV word ptr [ESI],AX
00871667 : MOV EDX,dword ptr [EDX + 0x24]
0087166a : PUSH EAX
0087166b : PUSH EDX
0087166c : LEA EDX,[ESP + 0x2c]
00871670 : PUSH EDX
00871671 : MOV EDX,dword ptr [EBX + 0x440]
00871677 : LEA ECX,[ESP + 0x27]
0087167b : MOV byte ptr [ESP + 0x27],0x0
00871680 : CALL 0x00abe000
00871685 : MOV byte ptr [ESP + 0x280],0x7
0087168d : CMP dword ptr [ESP + 0x20],0x0
00871692 : JNZ 0x008716e0
00871694 : MOVZX EAX,word ptr [EBX + 0x7c]
00871698 : MOVZX ECX,word ptr [ESI]
0087169b : MOVZX EDX,word ptr [EBX + 0x43c]
008716a2 : PUSH 0x0
008716a4 : PUSH EAX
008716a5 : PUSH ECX
008716a6 : PUSH EDX
008716a7 : MOV EDX,dword ptr [EBX + 0x440]
008716ad : LEA EAX,[ESP + 0x34]
008716b1 : PUSH EAX
008716b2 : LEA ECX,[ESP + 0x27]
008716b6 : CALL 0x00abe000
008716bb : MOV byte ptr [ESP + 0x280],0x8
008716c3 : MOV ESI,EAX
008716c5 : LEA EDI,[ESP + 0x1c]
008716c9 : CALL 0x00463a60
008716ce : MOV byte ptr [ESP + 0x280],0x7
008716d6 : LEA ECX,[ESP + 0x24]
008716da : PUSH ECX
008716db : CALL 0x0040ed80
008716e0 : MOV byte ptr [ESP + 0x280],0x6
008716e8 : LEA EDX,[ESP + 0x1c]
008716ec : PUSH EDX
008716ed : JMP 0x008717c0
008716f2 : PUSH 0x0
008716f4 : CMP EAX,0x4
008716f7 : JNZ 0x00871787
008716fd : MOV EDX,dword ptr [ESP + 0x18]
00871701 : MOV EAX,0x3e8
00871706 : ADD AX,word ptr [ESI]
00871709 : MOVZX ECX,AX
0087170c : PUSH ECX
0087170d : MOV ECX,dword ptr [EBX + 0x440]
00871713 : PUSH EDX
00871714 : LEA EAX,[ESP + 0x28]
00871718 : PUSH EAX
00871719 : CALL 0x00abdd00
0087171e : MOV byte ptr [ESP + 0x280],0x9
00871726 : MOV ESI,EAX
00871728 : LEA EDI,[ESP + 0x2c]
0087172c : CALL 0x00463a60
00871731 : MOV byte ptr [ESP + 0x280],0x6
00871739 : LEA ECX,[ESP + 0x1c]
0087173d : PUSH ECX
0087173e : CALL 0x0040ed80
00871743 : CMP dword ptr [ESP + 0x30],0x0
00871748 : JNZ 0x008717c5
0087174a : MOVZX EDX,word ptr [EBX + 0x43a]
00871751 : MOV EAX,dword ptr [ESP + 0x14]
00871755 : PUSH 0x0
00871757 : PUSH EDX
00871758 : PUSH EAX
00871759 : LEA ECX,[ESP + 0x28]
0087175d : PUSH ECX
0087175e : MOV ECX,dword ptr [EBX + 0x440]
00871764 : CALL 0x00abdd00
00871769 : MOV byte ptr [ESP + 0x280],0xa
00871771 : MOV ESI,EAX
00871773 : CALL 0x00463a60
00871778 : MOV byte ptr [ESP + 0x280],0x6
00871780 : LEA EDX,[ESP + 0x1c]
00871784 : PUSH EDX
00871785 : JMP 0x008717c0
00871787 : MOVZX EAX,word ptr [ESI]
0087178a : MOV ECX,dword ptr [ESP + 0x18]
0087178e : PUSH EAX
0087178f : PUSH ECX
00871790 : MOV ECX,dword ptr [EBX + 0x440]
00871796 : LEA EDX,[ESP + 0x28]
0087179a : PUSH EDX
0087179b : CALL 0x00abdd00
008717a0 : MOV byte ptr [ESP + 0x280],0xb
008717a8 : MOV ESI,EAX
008717aa : LEA EDI,[ESP + 0x2c]
008717ae : CALL 0x00463a60
008717b3 : MOV byte ptr [ESP + 0x280],0x6
008717bb : LEA EAX,[ESP + 0x1c]
008717bf : PUSH EAX
008717c0 : CALL 0x0040ed80
008717c5 : MOV ECX,dword ptr [ESP + 0x18]
008717c9 : XOR EAX,EAX
008717cb : CMP ECX,0x4
008717ce : JNZ 0x008717d5
008717d0 : LEA EAX,[ECX + -0x3]
008717d3 : JMP 0x008717df
008717d5 : CMP ECX,0x3
008717d8 : JNZ 0x008717df
008717da : MOV EAX,0x2
008717df : MOV ECX,dword ptr [EBX + 0x410]
008717e5 : FLD1
008717e7 : LEA EDI,[EAX + EAX*0x2]
008717ea : SUB ESP,0x8
008717ed : FST float ptr [ESP + 0x4]
008717f1 : SHL EDI,0x4
008717f4 : MOV DL,byte ptr [EDI + ECX*0x1 + 0xb0]
008717fb : FSTP float ptr [ESP]
008717fe : LEA ESI,[EAX + EAX*0x2 + 0x9]
00871802 : MOV byte ptr [ESP + 0x24],DL
00871806 : MOV EAX,dword ptr [ESP + 0x24]
0087180a : MOV EDX,dword ptr [ESP + 0x20]
0087180e : PUSH EAX
0087180f : MOVZX EAX,word ptr [EBX + 0x43a]
00871816 : PUSH 0x0
00871818 : PUSH EDX
00871819 : PUSH EAX
0087181a : LEA EDX,[ESP + 0x44]
0087181e : PUSH EDX
0087181f : SHL ESI,0x4
00871822 : MOVSS XMM0,dword ptr [ESI + ECX*0x1]
00871827 : PUSH ECX
00871828 : MOVSS dword ptr [ESP + 0x44],XMM0
0087182e : CALL 0x0079d530
00871833 : MOV EAX,dword ptr [EBX + 0x410]
00871839 : MOVSS XMM0,dword ptr [ESP + 0x24]
0087183f : MOVSS dword ptr [EAX + ESI*0x1],XMM0
00871844 : MOV EAX,dword ptr [EBX + 0x410]
0087184a : MOV byte ptr [EAX + EDI*0x1 + 0xb6],0x1
00871852 : MOV EBX,dword ptr [EBX + 0x410]
00871858 : MOV EAX,dword ptr [EBX]
0087185a : MOV EDX,dword ptr [EAX + 0x10]
0087185d : MOV ECX,EBX
0087185f : CALL EDX
00871861 : MOV dword ptr [ESP + 0x280],0xffffffff
0087186c : LEA EAX,[ESP + 0x2c]
00871870 : PUSH EAX
00871871 : CALL 0x0040ed80
00871876 : MOV ECX,dword ptr [ESP + 0x278]
0087187d : MOV dword ptr FS:[0x0],ECX
00871884 : POP ECX
00871885 : POP EDI
00871886 : POP ESI
00871887 : POP EBX
00871888 : MOV ECX,dword ptr [ESP + 0x260]
0087188f : XOR ECX,ESP
00871891 : CALL 0x00633e6b
00871896 : MOV ESP,EBP
00871898 : POP EBP
00871899 : RET 0x4

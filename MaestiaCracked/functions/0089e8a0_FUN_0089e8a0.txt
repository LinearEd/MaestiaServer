PROGRAM  : Maestia.exe
FUNCTION : FUN_0089e8a0
ENTRY    : 0089e8a0
BODY     : [[0089e8a0, 0089e9a9]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0089e8a0(undefined4 param_1)

{
  short *psVar1;
  short sVar2;
  short *psVar3;
  uint uVar4;
  wchar_t *pwVar5;
  wchar_t *pwVar6;
  int iVar7;
  short *psVar8;
  short *psVar9;
  int iVar10;
  int in_ECX;
  undefined4 in_EDX;
  undefined **ppuVar11;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_00b14c1b;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_8 = 0;
  *(undefined4 *)(in_ECX + 0x18) = 7;
  *(undefined4 *)(in_ECX + 0x14) = 0;
  *(undefined2 *)(in_ECX + 4) = 0;
  FUN_00406360(param_1,in_EDX);
  local_8 = 0;
  ppuVar11 = &PTR_DAT_00d6e664;
  local_14 = 2;
  do {
    pwVar6 = (wchar_t *)*ppuVar11;
    pwVar5 = (wchar_t *)FUN_00404a10(pwVar6,uVar4);
    for (pwVar6 = _wcsstr(pwVar5,pwVar6); pwVar6 != (wchar_t *)0x0;
        pwVar6 = _wcsstr((wchar_t *)(iVar10 + ((int)pwVar6 - iVar7 >> 1) * 2),pwVar5)) {
      iVar7 = FUN_00404a10();
      psVar8 = (short *)*ppuVar11;
      psVar1 = psVar8 + 1;
      do {
        sVar2 = *psVar8;
        psVar8 = psVar8 + 1;
      } while (sVar2 != 0);
      psVar3 = (short *)ppuVar11[1];
      psVar9 = psVar3;
      do {
        sVar2 = *psVar9;
        psVar9 = psVar9 + 1;
      } while (sVar2 != 0);
      FUN_00407a10((int)psVar8 - (int)psVar1 >> 1,psVar3,(int)psVar9 - (int)(psVar3 + 1) >> 1);
      pwVar5 = (wchar_t *)*ppuVar11;
      iVar10 = FUN_00404a10();
    }
    ppuVar11 = ppuVar11 + 2;
    local_14 = local_14 + -1;
  } while (local_14 != 0);
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
0089e8a0 : PUSH EBP
0089e8a1 : MOV EBP,ESP
0089e8a3 : PUSH -0x1
0089e8a5 : PUSH 0xb14c1b
0089e8aa : MOV EAX,FS:[0x0]
0089e8b0 : PUSH EAX
0089e8b1 : SUB ESP,0x14
0089e8b4 : PUSH EBX
0089e8b5 : PUSH ESI
0089e8b6 : PUSH EDI
0089e8b7 : MOV EAX,[0x00d66fa0]
0089e8bc : XOR EAX,EBP
0089e8be : PUSH EAX
0089e8bf : LEA EAX,[EBP + -0xc]
0089e8c2 : MOV FS:[0x0],EAX
0089e8c8 : XOR EDI,EDI
0089e8ca : MOV dword ptr [EBP + -0x4],EDI
0089e8cd : MOV EAX,dword ptr [EBP + 0x8]
0089e8d0 : MOV ESI,ECX
0089e8d2 : MOV dword ptr [EBP + -0x1c],EDI
0089e8d5 : XOR ECX,ECX
0089e8d7 : MOV dword ptr [ESI + 0x18],0x7
0089e8de : MOV dword ptr [ESI + 0x14],EDI
0089e8e1 : PUSH EDX
0089e8e2 : MOV word ptr [ESI + 0x4],CX
0089e8e6 : PUSH EAX
0089e8e7 : MOV ECX,ESI
0089e8e9 : MOV dword ptr [EBP + -0x20],ESI
0089e8ec : CALL 0x00406360
0089e8f1 : MOV dword ptr [EBP + -0x4],EDI
0089e8f4 : MOV dword ptr [EBP + -0x1c],0x1
0089e8fb : MOV EBX,0xd6e664
0089e900 : MOV dword ptr [EBP + -0x10],0x2
0089e907 : MOV EAX,dword ptr [EBX]
0089e909 : PUSH EAX
0089e90a : MOV ECX,ESI
0089e90c : CALL 0x00404a10
0089e911 : PUSH EAX
0089e912 : CALL 0x006347ba
0089e917 : MOV EDI,EAX
0089e919 : ADD ESP,0x8
0089e91c : TEST EDI,EDI
0089e91e : JZ 0x0089e987
0089e920 : MOV ECX,ESI
0089e922 : CALL 0x00404a10
0089e927 : SUB EDI,EAX
0089e929 : MOV EAX,dword ptr [EBX]
0089e92b : SAR EDI,0x1
0089e92d : LEA EDX,[EAX + 0x2]
0089e930 : MOV CX,word ptr [EAX]
0089e933 : ADD EAX,0x2
0089e936 : TEST CX,CX
0089e939 : JNZ 0x0089e930
0089e93b : MOV ECX,dword ptr [EBX + 0x4]
0089e93e : SUB EAX,EDX
0089e940 : SAR EAX,0x1
0089e942 : MOV dword ptr [EBP + -0x18],EAX
0089e945 : MOV EAX,ECX
0089e947 : LEA EDX,[EAX + 0x2]
0089e94a : MOV dword ptr [EBP + -0x14],EDX
0089e94d : LEA ECX,[ECX]
0089e950 : MOV DX,word ptr [EAX]
0089e953 : ADD EAX,0x2
0089e956 : TEST DX,DX
0089e959 : JNZ 0x0089e950
0089e95b : SUB EAX,dword ptr [EBP + -0x14]
0089e95e : SAR EAX,0x1
0089e960 : PUSH EAX
0089e961 : MOV EAX,dword ptr [EBP + -0x18]
0089e964 : PUSH ECX
0089e965 : PUSH EAX
0089e966 : CALL 0x00407a10
0089e96b : MOV ECX,dword ptr [EBX]
0089e96d : PUSH ECX
0089e96e : MOV ECX,ESI
0089e970 : CALL 0x00404a10
0089e975 : LEA EDX,[EAX + EDI*0x2]
0089e978 : PUSH EDX
0089e979 : CALL 0x006347ba
0089e97e : MOV EDI,EAX
0089e980 : ADD ESP,0x8
0089e983 : TEST EDI,EDI
0089e985 : JNZ 0x0089e920
0089e987 : ADD EBX,0x8
0089e98a : SUB dword ptr [EBP + -0x10],0x1
0089e98e : JNZ 0x0089e907
0089e994 : MOV EAX,ESI
0089e996 : MOV ECX,dword ptr [EBP + -0xc]
0089e999 : MOV dword ptr FS:[0x0],ECX
0089e9a0 : POP ECX
0089e9a1 : POP EDI
0089e9a2 : POP ESI
0089e9a3 : POP EBX
0089e9a4 : MOV ESP,EBP
0089e9a6 : POP EBP
0089e9a7 : RET 0x4

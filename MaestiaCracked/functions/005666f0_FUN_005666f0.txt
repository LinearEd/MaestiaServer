PROGRAM  : Maestia.exe
FUNCTION : FUN_005666f0
ENTRY    : 005666f0
BODY     : [[005666f0, 005668d6] [005668e0, 00566b60]]

============================================================
DECOMPILED C CODE
============================================================

int * FUN_005666f0(uint param_1,undefined4 *param_2,undefined4 *param_3)

{
  undefined4 *puVar1;
  char cVar2;
  undefined4 uVar3;
  int iVar4;
  int *piVar5;
  uint uVar6;
  int iVar7;
  int *in_ECX;
  int *piVar8;
  int iVar9;
  int *piVar10;
  int iStack_2c;
  uint uStack_1c;
  int iStack_18;
  int *piStack_14;
  int *piStack_10;
  int iStack_c;
  int *piStack_8;
  undefined4 uStack_4;
  
  iVar7 = *(int *)(in_ECX[7] + 0xc);
  iVar9 = *(int *)(*(int *)(iVar7 + 0x20) + 0x98);
  if (iVar9 != 0) {
    do {
      if (((*(int **)(iVar9 + 4))[5] &
          (-(uint)(((uint)param_2 & 0x300) != 0) & 0x300 | (uint)param_2 & 0x10 | 3)) ==
          ((uint)param_2 & 0x313)) {
        uVar6 = param_1;
        uVar3 = (**(code **)(**(int **)(iVar9 + 4) + 0x3c))(param_1);
        iVar4 = FUN_0051b280(uVar3,uVar6);
        if (iVar4 == 0) {
          iVar4 = in_ECX[7];
          uVar6 = *(uint *)(iVar9 + 8);
          piStack_10 = (int *)0x0;
          iStack_c = 0;
          if ((*(char *)(iVar4 + 0x3c) == '\0') || (*(uint *)(iVar4 + 0x1c) <= uVar6)) {
            FUN_00569f80(&piStack_10,uVar6);
          }
          else {
            piVar5 = (int *)(*(int *)(iVar4 + 0x20) + uVar6 * 8);
            if (((GRefCountImpl *)*piVar5 != (GRefCountImpl *)0x0) &&
               (GRefCountImpl::AddRef((GRefCountImpl *)*piVar5), piStack_10 != (int *)0x0)) {
              FUN_00524240();
            }
            piStack_10 = (int *)*piVar5;
            iStack_c = piVar5[1];
          }
          piVar5 = piStack_10;
          if (piStack_10 != (int *)0x0) {
            if (param_3 != (undefined4 *)0x0) {
              if ((~(byte)((uint)((int *)piStack_10[3])[5] >> 6) & 1) == 0) {
                *param_3 = 2;
              }
              else if ((((uint)param_2 & 3) == 0) ||
                      (cVar2 = (**(code **)(*(int *)piStack_10[3] + 0x40))(), cVar2 != '\0')) {
                *param_3 = 1;
              }
              else {
                *param_3 = 3;
              }
            }
            if (piStack_10 != (int *)0x0) {
              FUN_00524240();
            }
            return piVar5;
          }
        }
      }
      iVar9 = *(int *)(iVar9 + 0xc);
    } while (iVar9 != 0);
  }
  piVar5 = *(int **)(*(int *)(iVar7 + 0x20) + 0x90);
  do {
    if (piVar5 == (int *)0x0) {
      piVar5 = (int *)(**(code **)(*in_ECX + 0x60))(param_1);
      if (((piVar5 != (int *)0x0) &&
          (uVar6 = (**(code **)(*piVar5 + 8))(), (uVar6 & 0xff00) == 0x200)) &&
         (((-(uint)((param_1 & 0x300) != 0) & 0x300 | param_1 & 0x10 | 3) &
          *(uint *)(piVar5[3] + 0x14)) == (param_1 & 0x313))) {
        if (param_2 != (undefined4 *)0x0) {
          *param_2 = 6;
        }
        return piVar5;
      }
      if (param_2 != (undefined4 *)0x0) {
        *param_2 = 0;
      }
      return (int *)0x0;
    }
    uStack_1c = 0;
    if (piVar5[1] != 0) {
      iStack_2c = 0;
      do {
        if (param_3 != (undefined4 *)0x0) {
          piVar8 = piVar5 + 3;
          uVar6 = FUN_0051b370((piVar5[3] & 0xfffffffcU) + 8,
                               *(uint *)(piVar5[3] & 0xfffffffc) & 0x7fffffff,0x1505);
          iVar7 = param_3[1];
          if ((iVar7 == 0) || (iVar7 = FUN_00561de0(piVar8,*(uint *)(iVar7 + 4) & uVar6), iVar7 < 0)
             ) {
            FUN_00564e10(param_3 + 1,piVar8,uVar6);
          }
          else {
            FUN_0051bc20(piVar8);
          }
        }
        iStack_18 = 0;
        piStack_14 = (int *)0x0;
        cVar2 = FUN_00565560(&iStack_18,*(undefined4 *)(*piVar5 + 4 + iStack_2c));
        piVar8 = piStack_14;
        if (cVar2 != '\0') {
          iVar7 = in_ECX[7];
          piVar10 = piStack_14;
          if (iStack_18 != 0) {
            piStack_8 = (int *)0x0;
            uStack_4 = 0;
            if ((*(char *)(iVar7 + 0x3c) == '\0') || (*(int **)(iVar7 + 0x1c) <= piStack_14)) {
              FUN_00569f80(&piStack_8,piStack_14);
            }
            else {
              puVar1 = (undefined4 *)(*(int *)(iVar7 + 0x20) + (int)piStack_14 * 8);
              if (((GRefCountImpl *)*puVar1 != (GRefCountImpl *)0x0) &&
                 (GRefCountImpl::AddRef((GRefCountImpl *)*puVar1), piStack_8 != (int *)0x0)) {
                FUN_00524240();
              }
              piStack_8 = (int *)*puVar1;
              uStack_4 = puVar1[1];
            }
            piVar10 = piStack_8;
            if (piStack_8 != (int *)0x0) {
              FUN_00524240();
            }
          }
          if (((piVar10 != (int *)0x0) &&
              (uVar6 = (**(code **)(*piVar10 + 8))(), (uVar6 & 0xff00) == 0x200)) &&
             (((-(uint)(((uint)param_2 & 0x300) != 0) & 0x300 | (uint)param_2 & 0x10 | 3) &
              *(uint *)(piVar10[3] + 0x14)) == ((uint)param_2 & 0x313))) {
            iVar7 = FUN_0051b280((*(uint *)(iStack_2c + *piVar5) & 0xfffffffc) + 8,param_1);
            if (iVar7 == 0) {
LAB_00566ad2:
              if (param_3 != (undefined4 *)0x0) {
                if (((*(uint *)(piVar5[3] & 0xfffffffc) & 0x7fffffff) < 0xe) ||
                   (uVar6 = piVar5[3],
                   iVar7 = FUN_0051b280(((uVar6 & 0xfffffffc) - 6) +
                                        (*(uint *)(uVar6 & 0xfffffffc) & 0x7fffffff),
                                        "gfxfontlib.swf"), iVar7 != 0)) {
                  *param_3 = 4;
                }
                else {
                  *param_3 = 5;
                }
                FUN_0051bc20(piVar5 + 3);
              }
              if ((iStack_18 == 0) && (piVar8 != (int *)0x0)) {
                FUN_00524240();
              }
              return piVar10;
            }
            uVar3 = (**(code **)(*(int *)piVar10[3] + 0x3c))();
            iVar7 = FUN_0051b280(uVar3,param_1);
            if (iVar7 == 0) goto LAB_00566ad2;
          }
        }
        if ((iStack_18 == 0) && (piVar8 != (int *)0x0)) {
          FUN_00524240();
        }
        iStack_2c = iStack_2c + 0xc;
        uStack_1c = uStack_1c + 1;
      } while (uStack_1c < (uint)piVar5[1]);
    }
    piVar5 = (int *)piVar5[6];
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
005666f0 : SUB ESP,0x2c
005666f3 : MOV EAX,dword ptr [ECX + 0x1c]
005666f6 : MOV EDX,dword ptr [EAX + 0xc]
005666f9 : MOV EAX,dword ptr [EDX + 0x20]
005666fc : PUSH EBX
005666fd : PUSH EBP
005666fe : PUSH ESI
005666ff : ADD EAX,0x98
00566704 : PUSH EDI
00566705 : MOV EDI,dword ptr [EAX]
00566707 : XOR EBP,EBP
00566709 : MOV dword ptr [ESP + 0x18],ECX
0056670d : MOV dword ptr [ESP + 0x1c],EDX
00566711 : CMP EDI,EBP
00566713 : JZ 0x005667e4
00566719 : MOV EBX,dword ptr [ESP + 0x44]
0056671d : MOV ESI,EBX
0056671f : AND ESI,0x300
00566725 : NEG ESI
00566727 : SBB ESI,ESI
00566729 : MOV ECX,EBX
0056672b : AND ESI,0x300
00566731 : AND ECX,0x10
00566734 : OR ESI,ECX
00566736 : OR ESI,0x3
00566739 : AND EBX,0x313
0056673f : NOP
00566740 : MOV ECX,dword ptr [EDI + 0x4]
00566743 : MOV EDX,dword ptr [ECX + 0x14]
00566746 : AND EDX,ESI
00566748 : CMP EDX,EBX
0056674a : JNZ 0x005667d1
00566750 : MOV EAX,dword ptr [ESP + 0x40]
00566754 : MOV EDX,dword ptr [ECX]
00566756 : PUSH EAX
00566757 : MOV EAX,dword ptr [EDX + 0x3c]
0056675a : CALL EAX
0056675c : PUSH EAX
0056675d : CALL 0x0051b280
00566762 : TEST EAX,EAX
00566764 : JNZ 0x005667d1
00566766 : MOV ECX,dword ptr [ESP + 0x18]
0056676a : MOV ECX,dword ptr [ECX + 0x1c]
0056676d : MOV EAX,dword ptr [EDI + 0x8]
00566770 : ADD ECX,0x18
00566773 : MOV dword ptr [ESP + 0x2c],EBP
00566777 : MOV dword ptr [ESP + 0x30],EBP
0056677b : MOV DL,byte ptr [ECX + 0x24]
0056677e : TEST DL,DL
00566780 : JZ 0x005667b8
00566782 : MOV EDX,dword ptr [ECX + 0x4]
00566785 : CMP EAX,EDX
00566787 : JNC 0x005667b8
00566789 : MOV ECX,dword ptr [ECX + 0x8]
0056678c : LEA EBP,[ECX + EAX*0x8]
0056678f : MOV ECX,dword ptr [EBP]
00566792 : TEST ECX,ECX
00566794 : JZ 0x005667a8
00566796 : CALL 0x00523dd0
0056679b : MOV ECX,dword ptr [ESP + 0x2c]
0056679f : TEST ECX,ECX
005667a1 : JZ 0x005667a8
005667a3 : CALL 0x00524240
005667a8 : MOV EAX,dword ptr [EBP]
005667ab : MOV dword ptr [ESP + 0x2c],EAX
005667af : MOV EDX,dword ptr [EBP + 0x4]
005667b2 : MOV dword ptr [ESP + 0x30],EDX
005667b6 : JMP 0x005667c7
005667b8 : PUSH EAX
005667b9 : LEA EAX,[ESP + 0x30]
005667bd : PUSH EAX
005667be : CALL 0x00569f80
005667c3 : MOV EAX,dword ptr [ESP + 0x2c]
005667c7 : TEST EAX,EAX
005667c9 : JNZ 0x0056687a
005667cf : XOR EBP,EBP
005667d1 : MOV EDI,dword ptr [EDI + 0xc]
005667d4 : CMP EDI,EBP
005667d6 : JNZ 0x00566740
005667dc : MOV EDX,dword ptr [ESP + 0x1c]
005667e0 : MOV ECX,dword ptr [ESP + 0x18]
005667e4 : MOV EAX,dword ptr [EDX + 0x20]
005667e7 : MOV ESI,dword ptr [EAX + 0x90]
005667ed : ADD EAX,0x90
005667f2 : MOV dword ptr [ESP + 0x14],ESI
005667f6 : CMP ESI,EBP
005667f8 : JNZ 0x005668e4
005667fe : MOV EDX,dword ptr [ECX]
00566800 : MOV EAX,dword ptr [ESP + 0x40]
00566804 : MOV EDX,dword ptr [EDX + 0x60]
00566807 : PUSH EAX
00566808 : CALL EDX
0056680a : MOV ESI,EAX
0056680c : CMP ESI,EBP
0056680e : JZ 0x00566b4b
00566814 : MOV EAX,dword ptr [ESI]
00566816 : MOV EDX,dword ptr [EAX + 0x8]
00566819 : MOV ECX,ESI
0056681b : CALL EDX
0056681d : AND EAX,0xff00
00566822 : CMP EAX,0x200
00566827 : JNZ 0x00566b4b
0056682d : MOV EAX,dword ptr [ESP + 0x44]
00566831 : MOV ECX,EAX
00566833 : AND ECX,0x300
00566839 : NEG ECX
0056683b : SBB ECX,ECX
0056683d : AND ECX,0x300
00566843 : MOV EDX,EAX
00566845 : AND EDX,0x10
00566848 : OR ECX,EDX
0056684a : MOV EDX,dword ptr [ESI + 0xc]
0056684d : OR ECX,0x3
00566850 : AND ECX,dword ptr [EDX + 0x14]
00566853 : AND EAX,0x313
00566858 : CMP ECX,EAX
0056685a : JNZ 0x00566b4b
00566860 : MOV EAX,dword ptr [ESP + 0x48]
00566864 : CMP EAX,EBP
00566866 : JZ 0x0056686e
00566868 : MOV dword ptr [EAX],0x6
0056686e : MOV EAX,ESI
00566870 : POP EDI
00566871 : POP ESI
00566872 : POP EBP
00566873 : POP EBX
00566874 : ADD ESP,0x2c
00566877 : RET 0xc
0056687a : MOV ESI,dword ptr [ESP + 0x48]
0056687e : MOV EDI,EAX
00566880 : TEST ESI,ESI
00566882 : JZ 0x005668c0
00566884 : MOV ECX,dword ptr [EAX + 0xc]
00566887 : MOV EDX,dword ptr [ECX + 0x14]
0056688a : SHR EDX,0x6
0056688d : NOT DL
0056688f : TEST DL,0x1
00566892 : JNZ 0x0056689c
00566894 : MOV dword ptr [ESI],0x2
0056689a : JMP 0x005668c0
0056689c : TEST byte ptr [ESP + 0x44],0x3
005668a1 : JZ 0x005668ba
005668a3 : MOV EAX,dword ptr [ECX]
005668a5 : MOV EDX,dword ptr [EAX + 0x40]
005668a8 : CALL EDX
005668aa : TEST AL,AL
005668ac : MOV EAX,dword ptr [ESP + 0x2c]
005668b0 : JNZ 0x005668ba
005668b2 : MOV dword ptr [ESI],0x3
005668b8 : JMP 0x005668c0
005668ba : MOV dword ptr [ESI],0x1
005668c0 : TEST EAX,EAX
005668c2 : JZ 0x005668cb
005668c4 : MOV ECX,EAX
005668c6 : CALL 0x00524240
005668cb : MOV EAX,EDI
005668cd : POP EDI
005668ce : POP ESI
005668cf : POP EBP
005668d0 : POP EBX
005668d1 : ADD ESP,0x2c
005668d4 : RET 0xc
005668e0 : MOV ESI,dword ptr [ESP + 0x14]
005668e4 : MOV dword ptr [ESP + 0x20],EBP
005668e8 : CMP dword ptr [ESI + 0x4],EBP
005668eb : JBE 0x00566ab4
005668f1 : MOV dword ptr [ESP + 0x10],EBP
005668f5 : MOV EDI,dword ptr [ESP + 0x48]
005668f9 : CMP EDI,EBP
005668fb : JZ 0x0056695e
005668fd : MOV EAX,dword ptr [ESI + 0xc]
00566900 : ADD ESI,0xc
00566903 : MOV ECX,EAX
00566905 : AND ECX,0xfffffffc
00566908 : MOV ECX,dword ptr [ECX]
0056690a : PUSH 0x1505
0056690f : AND ECX,0x7fffffff
00566915 : AND EAX,0xfffffffc
00566918 : PUSH ECX
00566919 : ADD EAX,0x8
0056691c : PUSH EAX
0056691d : ADD EDI,0x4
00566920 : CALL 0x0051b370
00566925 : MOV EBP,dword ptr [EDI]
00566927 : MOV EBX,EAX
00566929 : TEST EBP,EBP
0056692b : JZ 0x0056694e
0056692d : MOV EDX,dword ptr [EBP + 0x4]
00566930 : AND EDX,EBX
00566932 : PUSH EDX
00566933 : PUSH ESI
00566934 : MOV ECX,EDI
00566936 : CALL 0x00561de0
0056693b : TEST EAX,EAX
0056693d : JL 0x0056694e
0056693f : LEA EAX,[EAX + EAX*0x2]
00566942 : PUSH ESI
00566943 : LEA ECX,[EBP + EAX*0x4 + 0x10]
00566947 : CALL 0x0051bc20
0056694c : JMP 0x00566958
0056694e : PUSH EBX
0056694f : PUSH ESI
00566950 : PUSH EDI
00566951 : MOV ECX,EDI
00566953 : CALL 0x00564e10
00566958 : MOV ESI,dword ptr [ESP + 0x14]
0056695c : XOR EBP,EBP
0056695e : MOV ECX,dword ptr [ESI]
00566960 : MOV EDX,dword ptr [ESP + 0x10]
00566964 : MOV EAX,dword ptr [ECX + EDX*0x1 + 0x4]
00566968 : PUSH ECX
00566969 : MOV ECX,ESP
0056696b : MOV dword ptr [ECX],EAX
0056696d : MOV EAX,dword ptr [ESP + 0x20]
00566971 : MOV ECX,dword ptr [EAX + 0x20]
00566974 : LEA EDX,[ESP + 0x28]
00566978 : PUSH EDX
00566979 : MOV dword ptr [ESP + 0x2c],EBP
0056697d : MOV dword ptr [ESP + 0x30],EBP
00566981 : CALL 0x00565560
00566986 : TEST AL,AL
00566988 : JZ 0x00566acc
0056698e : MOV EAX,dword ptr [ESP + 0x18]
00566992 : MOV ECX,dword ptr [EAX + 0x1c]
00566995 : ADD ECX,0x18
00566998 : CMP dword ptr [ESP + 0x24],EBP
0056699c : JNZ 0x005669a6
0056699e : MOV EBX,dword ptr [ESP + 0x28]
005669a2 : MOV EDI,EBX
005669a4 : JMP 0x00566a0f
005669a6 : MOV DL,byte ptr [ECX + 0x24]
005669a9 : MOV dword ptr [ESP + 0x34],EBP
005669ad : MOV dword ptr [ESP + 0x38],EBP
005669b1 : TEST DL,DL
005669b3 : JZ 0x005669f1
005669b5 : MOV EAX,dword ptr [ECX + 0x4]
005669b8 : MOV EBX,dword ptr [ESP + 0x28]
005669bc : CMP EBX,EAX
005669be : JNC 0x005669f5
005669c0 : MOV ECX,dword ptr [ECX + 0x8]
005669c3 : MOV EBX,dword ptr [ESP + 0x28]
005669c7 : LEA EDI,[ECX + EBX*0x8]
005669ca : MOV ECX,dword ptr [EDI]
005669cc : CMP ECX,EBP
005669ce : JZ 0x005669e2
005669d0 : CALL 0x00523dd0
005669d5 : MOV ECX,dword ptr [ESP + 0x34]
005669d9 : CMP ECX,EBP
005669db : JZ 0x005669e2
005669dd : CALL 0x00524240
005669e2 : MOV ECX,dword ptr [EDI]
005669e4 : MOV dword ptr [ESP + 0x34],ECX
005669e8 : MOV EDX,dword ptr [EDI + 0x4]
005669eb : MOV dword ptr [ESP + 0x38],EDX
005669ef : JMP 0x00566a04
005669f1 : MOV EBX,dword ptr [ESP + 0x28]
005669f5 : PUSH EBX
005669f6 : LEA EAX,[ESP + 0x38]
005669fa : PUSH EAX
005669fb : CALL 0x00569f80
00566a00 : MOV ECX,dword ptr [ESP + 0x34]
00566a04 : MOV EDI,ECX
00566a06 : CMP ECX,EBP
00566a08 : JZ 0x00566a0f
00566a0a : CALL 0x00524240
00566a0f : CMP EDI,EBP
00566a11 : JZ 0x00566a8c
00566a13 : MOV EDX,dword ptr [EDI]
00566a15 : MOV EAX,dword ptr [EDX + 0x8]
00566a18 : MOV ECX,EDI
00566a1a : CALL EAX
00566a1c : AND EAX,0xff00
00566a21 : CMP EAX,0x200
00566a26 : JNZ 0x00566a8c
00566a28 : MOV EAX,dword ptr [ESP + 0x44]
00566a2c : MOV ECX,EAX
00566a2e : AND ECX,0x300
00566a34 : NEG ECX
00566a36 : SBB ECX,ECX
00566a38 : AND ECX,0x300
00566a3e : MOV EDX,EAX
00566a40 : AND EDX,0x10
00566a43 : OR ECX,EDX
00566a45 : MOV EDX,dword ptr [EDI + 0xc]
00566a48 : OR ECX,0x3
00566a4b : AND ECX,dword ptr [EDX + 0x14]
00566a4e : AND EAX,0x313
00566a53 : CMP ECX,EAX
00566a55 : JNZ 0x00566a8c
00566a57 : MOV EAX,dword ptr [ESI]
00566a59 : MOV ECX,dword ptr [ESP + 0x10]
00566a5d : MOV EAX,dword ptr [ECX + EAX*0x1]
00566a60 : MOV EBP,dword ptr [ESP + 0x40]
00566a64 : AND EAX,0xfffffffc
00566a67 : PUSH EBP
00566a68 : ADD EAX,0x8
00566a6b : PUSH EAX
00566a6c : CALL 0x0051b280
00566a71 : TEST EAX,EAX
00566a73 : JZ 0x00566ad2
00566a75 : MOV ECX,dword ptr [EDI + 0xc]
00566a78 : MOV EDX,dword ptr [ECX]
00566a7a : MOV EAX,dword ptr [EDX + 0x3c]
00566a7d : CALL EAX
00566a7f : PUSH EBP
00566a80 : PUSH EAX
00566a81 : CALL 0x0051b280
00566a86 : TEST EAX,EAX
00566a88 : JZ 0x00566ad2
00566a8a : XOR EBP,EBP
00566a8c : CMP dword ptr [ESP + 0x24],EBP
00566a90 : JNZ 0x00566a9d
00566a92 : CMP EBX,EBP
00566a94 : JZ 0x00566a9d
00566a96 : MOV ECX,EBX
00566a98 : CALL 0x00524240
00566a9d : MOV EAX,dword ptr [ESP + 0x20]
00566aa1 : ADD dword ptr [ESP + 0x10],0xc
00566aa6 : INC EAX
00566aa7 : MOV dword ptr [ESP + 0x20],EAX
00566aab : CMP EAX,dword ptr [ESI + 0x4]
00566aae : JC 0x005668f5
00566ab4 : MOV ESI,dword ptr [ESI + 0x18]
00566ab7 : MOV dword ptr [ESP + 0x14],ESI
00566abb : CMP ESI,EBP
00566abd : JNZ 0x005668e0
00566ac3 : MOV ECX,dword ptr [ESP + 0x18]
00566ac7 : JMP 0x005667fe
00566acc : MOV EBX,dword ptr [ESP + 0x28]
00566ad0 : JMP 0x00566a8c
00566ad2 : MOV EBP,dword ptr [ESP + 0x48]
00566ad6 : TEST EBP,EBP
00566ad8 : JZ 0x00566b2d
00566ada : MOV ECX,dword ptr [ESI + 0xc]
00566add : ADD ESI,0xc
00566ae0 : AND ECX,0xfffffffc
00566ae3 : MOV EDX,dword ptr [ECX]
00566ae5 : AND EDX,0x7fffffff
00566aeb : CMP EDX,0xe
00566aee : JC 0x00566b1d
00566af0 : MOV EAX,dword ptr [ESI]
00566af2 : MOV ECX,EAX
00566af4 : AND EAX,0xfffffffc
00566af7 : MOV EAX,dword ptr [EAX]
00566af9 : AND ECX,0xfffffffc
00566afc : AND EAX,0x7fffffff
00566b01 : PUSH 0xb8cc50
00566b06 : LEA EAX,[ECX + EAX*0x1 + -0x6]
00566b0a : PUSH EAX
00566b0b : CALL 0x0051b280
00566b10 : TEST EAX,EAX
00566b12 : JNZ 0x00566b1d
00566b14 : MOV dword ptr [EBP],0x5
00566b1b : JMP 0x00566b24
00566b1d : MOV dword ptr [EBP],0x4
00566b24 : PUSH ESI
00566b25 : LEA ECX,[EBP + 0x8]
00566b28 : CALL 0x0051bc20
00566b2d : CMP dword ptr [ESP + 0x24],0x0
00566b32 : JNZ 0x00566b3f
00566b34 : TEST EBX,EBX
00566b36 : JZ 0x00566b3f
00566b38 : MOV ECX,EBX
00566b3a : CALL 0x00524240
00566b3f : MOV EAX,EDI
00566b41 : POP EDI
00566b42 : POP ESI
00566b43 : POP EBP
00566b44 : POP EBX
00566b45 : ADD ESP,0x2c
00566b48 : RET 0xc
00566b4b : MOV EAX,dword ptr [ESP + 0x48]
00566b4f : CMP EAX,EBP
00566b51 : JZ 0x00566b55
00566b53 : MOV dword ptr [EAX],EBP
00566b55 : POP EDI
00566b56 : POP ESI
00566b57 : POP EBP
00566b58 : XOR EAX,EAX
00566b5a : POP EBX
00566b5b : ADD ESP,0x2c
00566b5e : RET 0xc

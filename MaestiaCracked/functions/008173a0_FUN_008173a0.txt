PROGRAM  : Maestia.exe
FUNCTION : FUN_008173a0
ENTRY    : 008173a0
BODY     : [[008173a0, 0081767a]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_008173a0(undefined4 param_1)

{
  short sVar1;
  int iVar2;
  undefined2 *puVar3;
  char cVar4;
  uint uVar5;
  short *psVar6;
  uint uVar7;
  int *unaff_ESI;
  int iVar8;
  int iVar9;
  undefined1 local_2050 [4];
  undefined2 local_204c;
  undefined4 local_203c;
  uint local_2038;
  undefined4 local_2034;
  undefined4 local_2030;
  undefined4 local_202c;
  int local_2028;
  uint local_2024;
  undefined2 local_2020 [2];
  uint local_201c;
  short local_2018;
  undefined1 local_2016 [8190];
  uint local_18;
  undefined4 uStack_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3d153;
  local_10 = ExceptionList;
  uStack_14 = 0x8173bb;
  uVar5 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_202c = param_1;
  local_2028 = 0;
  local_18 = uVar5;
  while (((uint)unaff_ESI[9] < (uint)unaff_ESI[8] &&
         (cVar4 = (**(code **)(*unaff_ESI + 0x1c))(&local_2034,uVar5), cVar4 != '\0'))) {
    switch(local_2034) {
    case 0x5051:
      iVar8 = 0;
      local_2024 = FUN_006f0760(0x2c,"",0,(DAT_01725270 >> 3 & 1) == 0);
      local_8 = 0;
      if (local_2024 != 0) {
        iVar8 = FUN_00453490(local_2024);
      }
      local_8 = 0xffffffff;
      local_2028 = iVar8;
      (**(code **)(*unaff_ESI + 0xc))(iVar8,2,1);
      (**(code **)(*unaff_ESI + 0xc))(iVar8 + 2,2,1);
      (**(code **)(*unaff_ESI + 0xc))(iVar8 + 4,2,1);
      (**(code **)(*unaff_ESI + 0xc))(iVar8 + 8,4,1);
      FUN_00449610();
      break;
    case 0x5052:
      (**(code **)(*unaff_ESI + 0xc))(&local_201c,4,1);
      iVar8 = local_2028;
      local_2024 = 0;
      if (local_201c != 0) {
        iVar9 = local_2028 + 0xc;
        do {
          (**(code **)(*unaff_ESI + 0xc))(local_2020,2,1);
          iVar2 = *(int *)(iVar8 + 0x10);
          if (iVar2 == 0) {
            uVar7 = 0;
          }
          else {
            uVar7 = *(int *)(iVar8 + 0x18) - iVar2 >> 1;
          }
          puVar3 = *(undefined2 **)(iVar8 + 0x14);
          if ((uint)((int)puVar3 - iVar2 >> 1) < uVar7) {
            *puVar3 = local_2020[0];
            *(undefined2 **)(iVar8 + 0x14) = puVar3 + 1;
          }
          else {
            FUN_0041c730(iVar9,puVar3,local_2020);
          }
          local_2024 = local_2024 + 1;
        } while (local_2024 < local_201c);
      }
      break;
    case 0x5053:
      uVar7 = 0;
      local_201c = 0;
      (**(code **)(*unaff_ESI + 0xc))(&local_201c,1,1);
      if (local_201c != 0) {
        do {
          FUN_0070d080(&local_2018);
          psVar6 = &local_2018;
          local_2038 = 7;
          local_203c = 0;
          local_204c = 0;
          do {
            sVar1 = *psVar6;
            psVar6 = psVar6 + 1;
          } while (sVar1 != 0);
          FUN_00406360(&local_2018,(int)psVar6 - (int)local_2016 >> 1);
          local_8 = 1;
          FUN_00405ae0(local_2050);
          local_8 = 0xffffffff;
          if (7 < local_2038) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          uVar7 = uVar7 + 1;
          local_2038 = 7;
          local_203c = 0;
          local_204c = 0;
        } while (uVar7 < local_201c);
      }
      break;
    case 0x5054:
      goto switchD_0081741c_caseD_5054;
    default:
      (**(code **)(*unaff_ESI + 0x24))(local_2030);
    }
  }
switchD_0081741c_caseD_5054:
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008173a0 : PUSH EBP
008173a1 : MOV EBP,ESP
008173a3 : PUSH -0x1
008173a5 : PUSH 0xb3d153
008173aa : MOV EAX,FS:[0x0]
008173b0 : PUSH EAX
008173b1 : MOV EAX,0x2044
008173b6 : CALL 0x0063b780
008173bb : MOV EAX,[0x00d66fa0]
008173c0 : XOR EAX,EBP
008173c2 : MOV dword ptr [EBP + -0x14],EAX
008173c5 : PUSH EBX
008173c6 : PUSH EDI
008173c7 : PUSH EAX
008173c8 : LEA EAX,[EBP + -0xc]
008173cb : MOV FS:[0x0],EAX
008173d1 : MOV EAX,dword ptr [EBP + 0x8]
008173d4 : MOV dword ptr [EBP + 0xffffdfd8],EAX
008173da : MOV dword ptr [EBP + 0xffffdfdc],0x0
008173e4 : MOV ECX,dword ptr [ESI + 0x24]
008173e7 : CMP ECX,dword ptr [ESI + 0x20]
008173ea : JNC 0x0081765e
008173f0 : MOV EDX,dword ptr [ESI]
008173f2 : MOV EDX,dword ptr [EDX + 0x1c]
008173f5 : LEA EAX,[EBP + 0xffffdfd0]
008173fb : PUSH EAX
008173fc : MOV ECX,ESI
008173fe : CALL EDX
00817400 : TEST AL,AL
00817402 : JZ 0x0081765e
00817408 : MOV EAX,dword ptr [EBP + 0xffffdfd0]
0081740e : ADD EAX,0xffffafaf
00817413 : CMP EAX,0x3
00817416 : JA 0x00817649
0081741c : JMP dword ptr [EAX*0x4 + 0x81767c]
00817423 : MOV EAX,[0x01725270]
00817428 : SHR EAX,0x3
0081742b : MOV ECX,0x0
00817430 : AND EAX,0x1
00817433 : SETZ CL
00817436 : XOR EDI,EDI
00817438 : PUSH ECX
00817439 : PUSH EDI
0081743a : PUSH 0xbf1a4a
0081743f : PUSH 0x2c
00817441 : CALL 0x006f0760
00817446 : ADD ESP,0x10
00817449 : MOV dword ptr [EBP + 0xffffdfe0],EAX
0081744f : MOV dword ptr [EBP + -0x4],EDI
00817452 : CMP EAX,EDI
00817454 : JZ 0x0081745e
00817456 : PUSH EAX
00817457 : CALL 0x00453490
0081745c : MOV EDI,EAX
0081745e : MOV dword ptr [EBP + -0x4],0xffffffff
00817465 : MOV EDX,dword ptr [ESI]
00817467 : MOV EAX,dword ptr [EDX + 0xc]
0081746a : PUSH 0x1
0081746c : PUSH 0x2
0081746e : PUSH EDI
0081746f : MOV ECX,ESI
00817471 : MOV dword ptr [EBP + 0xffffdfdc],EDI
00817477 : CALL EAX
00817479 : MOV EDX,dword ptr [ESI]
0081747b : MOV EDX,dword ptr [EDX + 0xc]
0081747e : PUSH 0x1
00817480 : PUSH 0x2
00817482 : LEA EAX,[EDI + 0x2]
00817485 : PUSH EAX
00817486 : MOV ECX,ESI
00817488 : CALL EDX
0081748a : MOV EAX,dword ptr [ESI]
0081748c : MOV EDX,dword ptr [EAX + 0xc]
0081748f : PUSH 0x1
00817491 : PUSH 0x2
00817493 : LEA ECX,[EDI + 0x4]
00817496 : PUSH ECX
00817497 : MOV ECX,ESI
00817499 : CALL EDX
0081749b : MOV EAX,dword ptr [ESI]
0081749d : MOV EDX,dword ptr [EAX + 0xc]
008174a0 : PUSH 0x1
008174a2 : PUSH 0x4
008174a4 : ADD EDI,0x8
008174a7 : PUSH EDI
008174a8 : MOV ECX,ESI
008174aa : CALL EDX
008174ac : MOV EDX,dword ptr [EBP + 0xffffdfd8]
008174b2 : ADD EDX,0x70
008174b5 : LEA EDI,[EBP + 0xffffdfdc]
008174bb : CALL 0x00449610
008174c0 : JMP 0x008173e4
008174c5 : MOV EAX,dword ptr [ESI]
008174c7 : MOV EDX,dword ptr [EAX + 0xc]
008174ca : PUSH 0x1
008174cc : PUSH 0x4
008174ce : LEA ECX,[EBP + 0xffffdfe8]
008174d4 : PUSH ECX
008174d5 : MOV ECX,ESI
008174d7 : CALL EDX
008174d9 : CMP dword ptr [EBP + 0xffffdfe8],0x0
008174e0 : MOV dword ptr [EBP + 0xffffdfe0],0x0
008174ea : JBE 0x008173e4
008174f0 : MOV EDI,dword ptr [EBP + 0xffffdfdc]
008174f6 : ADD EDI,0xc
008174f9 : MOV EAX,dword ptr [ESI]
008174fb : MOV EDX,dword ptr [EAX + 0xc]
008174fe : PUSH 0x1
00817500 : PUSH 0x2
00817502 : LEA ECX,[EBP + 0xffffdfe4]
00817508 : PUSH ECX
00817509 : MOV ECX,ESI
0081750b : CALL EDX
0081750d : MOV ECX,dword ptr [EDI + 0x4]
00817510 : TEST ECX,ECX
00817512 : JNZ 0x00817518
00817514 : XOR EAX,EAX
00817516 : JMP 0x0081751f
00817518 : MOV EAX,dword ptr [EDI + 0xc]
0081751b : SUB EAX,ECX
0081751d : SAR EAX,0x1
0081751f : MOV EDX,dword ptr [EDI + 0x8]
00817522 : MOV EBX,EDX
00817524 : SUB EBX,ECX
00817526 : SAR EBX,0x1
00817528 : CMP EBX,EAX
0081752a : JNC 0x0081753e
0081752c : MOV AX,word ptr [EBP + 0xffffdfe4]
00817533 : MOV word ptr [EDX],AX
00817536 : ADD EDX,0x2
00817539 : MOV dword ptr [EDI + 0x8],EDX
0081753c : JMP 0x00817551
0081753e : LEA ECX,[EBP + 0xffffdfe4]
00817544 : PUSH ECX
00817545 : PUSH EDX
00817546 : PUSH EDI
00817547 : MOV ECX,0x1
0081754c : CALL 0x0041c730
00817551 : MOV EAX,dword ptr [EBP + 0xffffdfe0]
00817557 : INC EAX
00817558 : MOV dword ptr [EBP + 0xffffdfe0],EAX
0081755e : CMP EAX,dword ptr [EBP + 0xffffdfe8]
00817564 : JC 0x008174f9
00817566 : JMP 0x008173e4
0081756b : MOV EDX,dword ptr [ESI]
0081756d : MOV EDX,dword ptr [EDX + 0xc]
00817570 : PUSH 0x1
00817572 : PUSH 0x1
00817574 : LEA EAX,[EBP + 0xffffdfe8]
0081757a : XOR EBX,EBX
0081757c : PUSH EAX
0081757d : MOV ECX,ESI
0081757f : MOV dword ptr [EBP + 0xffffdfe8],EBX
00817585 : CALL EDX
00817587 : CMP dword ptr [EBP + 0xffffdfe8],EBX
0081758d : JBE 0x008173e4
00817593 : LEA EAX,[EBP + 0xffffdfec]
00817599 : PUSH EAX
0081759a : MOV EDI,ESI
0081759c : CALL 0x0070d080
008175a1 : XOR EDI,EDI
008175a3 : XOR ECX,ECX
008175a5 : LEA EAX,[EBP + 0xffffdfec]
008175ab : MOV dword ptr [EBP + 0xffffdfcc],0x7
008175b5 : MOV dword ptr [EBP + 0xffffdfc8],EDI
008175bb : MOV word ptr [EBP + 0xffffdfb8],CX
008175c2 : LEA EDX,[EAX + 0x2]
008175c5 : MOV CX,word ptr [EAX]
008175c8 : ADD EAX,0x2
008175cb : CMP CX,DI
008175ce : JNZ 0x008175c5
008175d0 : SUB EAX,EDX
008175d2 : SAR EAX,0x1
008175d4 : PUSH EAX
008175d5 : LEA EDX,[EBP + 0xffffdfec]
008175db : PUSH EDX
008175dc : LEA ECX,[EBP + 0xffffdfb4]
008175e2 : CALL 0x00406360
008175e7 : MOV dword ptr [EBP + -0x4],0x1
008175ee : LEA EAX,[EBP + 0xffffdfb4]
008175f4 : PUSH EAX
008175f5 : MOV EAX,dword ptr [EBP + 0xffffdfdc]
008175fb : ADD EAX,0x1c
008175fe : CALL 0x00405ae0
00817603 : MOV dword ptr [EBP + -0x4],0xffffffff
0081760a : CMP dword ptr [EBP + 0xffffdfcc],0x8
00817611 : JC 0x0081761e
00817613 : MOV ECX,dword ptr [EBP + 0xffffdfb8]
00817619 : CALL 0x006f04e0
0081761e : XOR ECX,ECX
00817620 : INC EBX
00817621 : MOV dword ptr [EBP + 0xffffdfcc],0x7
0081762b : MOV dword ptr [EBP + 0xffffdfc8],EDI
00817631 : MOV word ptr [EBP + 0xffffdfb8],CX
00817638 : CMP EBX,dword ptr [EBP + 0xffffdfe8]
0081763e : JC 0x00817593
00817644 : JMP 0x008173e4
00817649 : MOV EDX,dword ptr [ESI]
0081764b : MOV EAX,dword ptr [EBP + 0xffffdfd4]
00817651 : MOV EDX,dword ptr [EDX + 0x24]
00817654 : PUSH EAX
00817655 : MOV ECX,ESI
00817657 : CALL EDX
00817659 : JMP 0x008173e4
0081765e : MOV ECX,dword ptr [EBP + -0xc]
00817661 : MOV dword ptr FS:[0x0],ECX
00817668 : POP ECX
00817669 : POP EDI
0081766a : POP EBX
0081766b : MOV ECX,dword ptr [EBP + -0x14]
0081766e : XOR ECX,EBP
00817670 : CALL 0x00633e6b
00817675 : MOV ESP,EBP
00817677 : POP EBP
00817678 : RET 0x4

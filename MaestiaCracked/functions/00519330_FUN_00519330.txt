PROGRAM  : Maestia.exe
FUNCTION : FUN_00519330
ENTRY    : 00519330
BODY     : [[00519330, 0051949f]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00519330(int *param_1,undefined4 *param_2)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint *in_ECX;
  uint *puVar4;
  uint *unaff_ESI;
  
  uVar1 = *in_ECX;
  if ((uVar1 & 2) != 0) {
    param_1[2] = in_ECX[1];
  }
  if ((uVar1 & 4) != 0) {
    param_1[1] = in_ECX[2];
  }
  uVar3 = in_ECX[3];
  if ((uVar1 & 8) == 0) {
    if ((uVar1 & 0x80000) != 0) {
      uVar3 = (uVar3 / (uint)param_1[2]) * 4;
      goto LAB_00519374;
    }
  }
  else {
LAB_00519374:
    param_1[3] = uVar3;
  }
  if ((uVar1 & 0x20000) != 0) {
    param_1[6] = in_ECX[5];
  }
  if ((uVar1 & 0x1000) != 0) {
    if (in_ECX[0x11] == 0x20) {
      uVar3 = in_ECX[0x12];
      uVar2 = in_ECX[0x13];
      puVar4 = in_ECX + 0x14;
      if ((uVar3 & 4) == 0) {
        if ((uVar3 & 0x42) != 0) {
          uVar2 = *puVar4;
          if (unaff_ESI != (uint *)0x0) {
            *unaff_ESI = uVar2;
          }
          if (uVar2 == 8) {
            if ((uVar3 & 2) != 0) {
              *param_1 = 9;
            }
          }
          else if (uVar2 == 0x18) {
            *param_1 = 2;
          }
          else if (uVar2 == 0x20) {
            *param_1 = 1;
          }
          if ((uVar1 & 8) == 0) {
            param_1[3] = (uVar2 >> 3) * param_1[1];
          }
          if (unaff_ESI != (uint *)0x0) {
            unaff_ESI[1] = in_ECX[0x15];
          }
          if (unaff_ESI != (uint *)0x0) {
            unaff_ESI[2] = in_ECX[0x16];
          }
          if (unaff_ESI != (uint *)0x0) {
            unaff_ESI[3] = in_ECX[0x17];
          }
          puVar4 = in_ECX + 0x19;
          if ((unaff_ESI != (uint *)0x0) && ((uVar3 & 1) != 0)) {
            unaff_ESI[4] = in_ECX[0x18];
            *(undefined1 *)(unaff_ESI + 5) = 1;
          }
        }
      }
      else if (uVar2 == 0x35545844) {
        *param_1 = 0xc;
        puVar4 = in_ECX + 0x19;
      }
      else if (uVar2 == 0x33545844) {
        *param_1 = 0xb;
        puVar4 = in_ECX + 0x19;
      }
      else {
        if (uVar2 == 0x31545844) {
          *param_1 = 10;
        }
        puVar4 = in_ECX + 0x19;
      }
      if (*param_1 != 0) goto LAB_0051948d;
    }
    return 0;
  }
  puVar4 = in_ECX + 0x19;
LAB_0051948d:
  if (param_2 != (undefined4 *)0x0) {
    *param_2 = puVar4 + 5;
  }
  return 1;
}



============================================================
DISASSEMBLY
============================================================
00519330 : MOV EAX,dword ptr [ECX + 0x4]
00519333 : PUSH EBX
00519334 : MOV EBX,dword ptr [ECX]
00519336 : ADD ECX,0x4
00519339 : PUSH EBP
0051933a : MOV EBP,dword ptr [ESP + 0xc]
0051933e : ADD ECX,0x4
00519341 : PUSH EDI
00519342 : TEST BL,0x2
00519345 : JZ 0x0051934a
00519347 : MOV dword ptr [EBP + 0x8],EAX
0051934a : MOV EAX,dword ptr [ECX]
0051934c : ADD ECX,0x4
0051934f : TEST BL,0x4
00519352 : JZ 0x00519357
00519354 : MOV dword ptr [EBP + 0x4],EAX
00519357 : MOV EAX,dword ptr [ECX]
00519359 : MOV EDI,EBX
0051935b : ADD ECX,0x4
0051935e : AND EDI,0x8
00519361 : JNZ 0x00519374
00519363 : TEST EBX,0x80000
00519369 : JZ 0x00519377
0051936b : XOR EDX,EDX
0051936d : DIV dword ptr [EBP + 0x8]
00519370 : ADD EAX,EAX
00519372 : ADD EAX,EAX
00519374 : MOV dword ptr [EBP + 0xc],EAX
00519377 : MOV EAX,dword ptr [ECX + 0x4]
0051937a : ADD ECX,0x4
0051937d : ADD ECX,0x4
00519380 : TEST EBX,0x20000
00519386 : JZ 0x0051938b
00519388 : MOV dword ptr [EBP + 0x18],EAX
0051938b : ADD ECX,0x2c
0051938e : TEST EBX,0x1000
00519394 : JZ 0x0051948a
0051939a : MOV EAX,dword ptr [ECX]
0051939c : ADD ECX,0x4
0051939f : CMP EAX,0x20
005193a2 : JNZ 0x00519484
005193a8 : MOV EDX,dword ptr [ECX]
005193aa : MOV EAX,dword ptr [ECX + 0x4]
005193ad : ADD ECX,0x4
005193b0 : ADD ECX,0x4
005193b3 : TEST DL,0x4
005193b6 : JZ 0x005193fa
005193b8 : CMP EAX,0x35545844
005193bd : JNZ 0x005193ce
005193bf : MOV dword ptr [EBP],0xc
005193c6 : ADD ECX,0x14
005193c9 : JMP 0x0051947e
005193ce : CMP EAX,0x33545844
005193d3 : JNZ 0x005193e4
005193d5 : MOV dword ptr [EBP],0xb
005193dc : ADD ECX,0x14
005193df : JMP 0x0051947e
005193e4 : CMP EAX,0x31545844
005193e9 : JNZ 0x005193f2
005193eb : MOV dword ptr [EBP],0xa
005193f2 : ADD ECX,0x14
005193f5 : JMP 0x0051947e
005193fa : TEST DL,0x42
005193fd : JZ 0x0051947e
005193ff : MOV EAX,dword ptr [ECX]
00519401 : ADD ECX,0x4
00519404 : TEST ESI,ESI
00519406 : JZ 0x0051940a
00519408 : MOV dword ptr [ESI],EAX
0051940a : CMP EAX,0x8
0051940d : JZ 0x0051942b
0051940f : CMP EAX,0x18
00519412 : JZ 0x00519422
00519414 : CMP EAX,0x20
00519417 : JNZ 0x00519437
00519419 : MOV dword ptr [EBP],0x1
00519420 : JMP 0x00519437
00519422 : MOV dword ptr [EBP],0x2
00519429 : JMP 0x00519437
0051942b : TEST DL,0x2
0051942e : JZ 0x00519437
00519430 : MOV dword ptr [EBP],0x9
00519437 : TEST EDI,EDI
00519439 : JNZ 0x00519445
0051943b : SHR EAX,0x3
0051943e : IMUL EAX,dword ptr [EBP + 0x4]
00519442 : MOV dword ptr [EBP + 0xc],EAX
00519445 : MOV EAX,dword ptr [ECX]
00519447 : ADD ECX,0x4
0051944a : TEST ESI,ESI
0051944c : JZ 0x00519451
0051944e : MOV dword ptr [ESI + 0x4],EAX
00519451 : MOV EAX,dword ptr [ECX]
00519453 : ADD ECX,0x4
00519456 : TEST ESI,ESI
00519458 : JZ 0x0051945d
0051945a : MOV dword ptr [ESI + 0x8],EAX
0051945d : MOV EAX,dword ptr [ECX]
0051945f : ADD ECX,0x4
00519462 : TEST ESI,ESI
00519464 : JZ 0x00519469
00519466 : MOV dword ptr [ESI + 0xc],EAX
00519469 : MOV EAX,dword ptr [ECX]
0051946b : ADD ECX,0x4
0051946e : TEST ESI,ESI
00519470 : JZ 0x0051947e
00519472 : TEST DL,0x1
00519475 : JZ 0x0051947e
00519477 : MOV dword ptr [ESI + 0x10],EAX
0051947a : MOV byte ptr [ESI + 0x14],0x1
0051947e : CMP dword ptr [EBP],0x0
00519482 : JNZ 0x0051948d
00519484 : POP EDI
00519485 : POP EBP
00519486 : XOR AL,AL
00519488 : POP EBX
00519489 : RET
0051948a : ADD ECX,0x20
0051948d : MOV EAX,dword ptr [ESP + 0x14]
00519491 : TEST EAX,EAX
00519493 : JZ 0x0051949a
00519495 : ADD ECX,0x14
00519498 : MOV dword ptr [EAX],ECX
0051949a : POP EDI
0051949b : POP EBP
0051949c : MOV AL,0x1
0051949e : POP EBX
0051949f : RET

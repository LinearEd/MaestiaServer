PROGRAM  : Maestia.exe
FUNCTION : FUN_0042fd90
ENTRY    : 0042fd90
BODY     : [[0042fd90, 0042fde3]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0042fd90(void)

{
  wchar_t wVar1;
  wchar_t *_Dest;
  wchar_t *in_ECX;
  ushort *unaff_ESI;
  
  _Dest = (wchar_t *)(unaff_ESI + 4);
  *unaff_ESI = 0;
  *(undefined1 *)(unaff_ESI + 1) = 0x34;
  *(undefined1 *)((int)unaff_ESI + 3) = 0xef;
  unaff_ESI[2] = 0;
  unaff_ESI[3] = 0;
  _wcsncpy(_Dest,in_ECX,0x27);
  unaff_ESI[0x2b] = 0;
  do {
    wVar1 = *_Dest;
    _Dest = _Dest + 1;
  } while (wVar1 != L'\0');
  *unaff_ESI = *unaff_ESI ^
               ((short)((int)_Dest - (int)(unaff_ESI + 5) >> 1) * 2 + 10U ^ *unaff_ESI) & 0x1fff;
  return;
}



============================================================
DISASSEMBLY
============================================================
0042fd90 : PUSH EDI
0042fd91 : PUSH 0x27
0042fd93 : XOR EAX,EAX
0042fd95 : PUSH ECX
0042fd96 : LEA EDI,[ESI + 0x8]
0042fd99 : PUSH EDI
0042fd9a : MOV word ptr [ESI],AX
0042fd9d : MOV byte ptr [ESI + 0x2],0x34
0042fda1 : MOV byte ptr [ESI + 0x3],0xef
0042fda5 : MOV dword ptr [ESI + 0x4],EAX
0042fda8 : CALL 0x00634e39
0042fdad : ADD ESP,0xc
0042fdb0 : XOR EDX,EDX
0042fdb2 : MOV EAX,EDI
0042fdb4 : MOV word ptr [EDI + 0x4e],DX
0042fdb8 : LEA EDX,[EAX + 0x2]
0042fdbb : POP EDI
0042fdbc : LEA ESP,[ESP]
0042fdc0 : MOV CX,word ptr [EAX]
0042fdc3 : ADD EAX,0x2
0042fdc6 : TEST CX,CX
0042fdc9 : JNZ 0x0042fdc0
0042fdcb : SUB EAX,EDX
0042fdcd : SAR EAX,0x1
0042fdcf : LEA EAX,[EAX + EAX*0x1 + 0xa]
0042fdd3 : XOR AX,word ptr [ESI]
0042fdd6 : MOV ECX,0x1fff
0042fddb : AND AX,CX
0042fdde : XOR word ptr [ESI],AX
0042fde1 : MOV EAX,ESI
0042fde3 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_005986f0
ENTRY    : 005986f0
BODY     : [[005986f0, 00598815]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005986f0(undefined4 param_1)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int *in_ECX;
  int iVar5;
  int local_1c;
  int local_18;
  undefined4 local_14;
  undefined1 auStack_10 [4];
  int iStack_c;
  
  iVar5 = 0;
  local_1c = 0;
  local_18 = 0;
  local_14 = 0;
  iVar3 = local_1c;
  if (*in_ECX != 0) {
    (**(code **)(**(int **)(*in_ECX + 0x68) + 0x5c))();
    iVar3 = FUN_00525530(param_1);
    *(int *)(iVar3 + 8) = *(int *)(iVar3 + 8) + 1;
    auStack_10[0] = 5;
    *(int *)(iVar3 + 8) = *(int *)(iVar3 + 8) + 1;
    iStack_c = iVar3;
    FUN_005034e0(&local_1c,1);
    iVar5 = local_18;
    if (local_18 * 0x10 + -0x10 + local_1c != 0) {
      FUN_005266c0(auStack_10);
    }
    FUN_00526bc0();
    iVar4 = FUN_00571c40(4);
    iVar2 = *(int *)(*in_ECX + 0x68);
    *(undefined4 *)(iVar4 + 4) = 4;
    if (iVar2 != 0) {
      *(int *)(iVar2 + 4) = *(int *)(iVar2 + 4) + 1;
      iVar5 = local_18;
    }
    if (*(GRefCountNTSImpl **)(iVar4 + 8) != (GRefCountNTSImpl *)0x0) {
      GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar4 + 8));
    }
    *(int *)(iVar4 + 8) = iVar2;
    if (*(GRefCountNTSImpl **)(iVar4 + 0xc) != (GRefCountNTSImpl *)0x0) {
      GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar4 + 0xc));
    }
    *(undefined4 *)(iVar4 + 0xc) = 0;
    *(code **)(iVar4 + 0x2c) = FUN_00597210;
    FUN_00504fd0(&local_1c);
    piVar1 = (int *)(iVar3 + 8);
    *piVar1 = *piVar1 + -1;
    iVar3 = local_1c;
    if (*piVar1 == 0) {
      FUN_00525340();
      iVar3 = local_1c;
    }
  }
  for (; iVar2 = local_1c, local_1c = iVar3, iVar5 != 0; iVar5 = iVar5 + -1) {
    FUN_00526bc0();
    iVar3 = local_1c;
    local_1c = iVar2;
  }
  FUN_00515cf0(iVar2);
  return;
}



============================================================
DISASSEMBLY
============================================================
005986f0 : SUB ESP,0x1c
005986f3 : PUSH EBX
005986f4 : PUSH EBP
005986f5 : PUSH ESI
005986f6 : MOV EBX,ECX
005986f8 : MOV EAX,dword ptr [EBX]
005986fa : PUSH EDI
005986fb : XOR EDI,EDI
005986fd : XOR EBP,EBP
005986ff : MOV dword ptr [ESP + 0x10],EDI
00598703 : MOV dword ptr [ESP + 0x14],EBP
00598707 : MOV dword ptr [ESP + 0x18],EDI
0059870b : CMP EAX,EDI
0059870d : JZ 0x005987e6
00598713 : MOV ECX,dword ptr [EAX + 0x68]
00598716 : MOV EAX,dword ptr [ECX]
00598718 : MOV EDX,dword ptr [EAX + 0x5c]
0059871b : CALL EDX
0059871d : MOV ECX,dword ptr [ESP + 0x30]
00598721 : MOV EAX,dword ptr [EAX + 0x78]
00598724 : PUSH ECX
00598725 : LEA ECX,[EAX + 0x254]
0059872b : CALL 0x00525530
00598730 : MOV ESI,EAX
00598732 : MOV EAX,0x1
00598737 : ADD dword ptr [ESI + 0x8],EAX
0059873a : LEA EDX,[ESP + 0x10]
0059873e : PUSH EAX
0059873f : MOV byte ptr [ESP + 0x20],0x5
00598744 : MOV dword ptr [ESP + 0x24],ESI
00598748 : ADD dword ptr [ESI + 0x8],EAX
0059874b : PUSH EDX
0059874c : MOV ECX,EDX
0059874e : CALL 0x005034e0
00598753 : MOV EBP,dword ptr [ESP + 0x14]
00598757 : MOV ECX,dword ptr [ESP + 0x10]
0059875b : MOV EAX,EBP
0059875d : SHL EAX,0x4
00598760 : LEA ECX,[EAX + ECX*0x1 + -0x10]
00598764 : CMP ECX,EDI
00598766 : JZ 0x00598772
00598768 : LEA EDX,[ESP + 0x1c]
0059876c : PUSH EDX
0059876d : CALL 0x005266c0
00598772 : LEA ECX,[ESP + 0x1c]
00598776 : CALL 0x00526bc0
0059877b : MOV EAX,dword ptr [EBX]
0059877d : PUSH 0x4
0059877f : LEA ECX,[EAX + 0xa2c]
00598785 : CALL 0x00571c40
0059878a : MOV EDI,EAX
0059878c : MOV EAX,dword ptr [EBX]
0059878e : MOV EBX,dword ptr [EAX + 0x68]
00598791 : MOV dword ptr [EDI + 0x4],0x4
00598798 : TEST EBX,EBX
0059879a : JZ 0x005987a3
0059879c : INC dword ptr [EBX + 0x4]
0059879f : MOV EBP,dword ptr [ESP + 0x14]
005987a3 : MOV ECX,dword ptr [EDI + 0x8]
005987a6 : TEST ECX,ECX
005987a8 : JZ 0x005987af
005987aa : CALL 0x004ff7c0
005987af : MOV dword ptr [EDI + 0x8],EBX
005987b2 : MOV ECX,dword ptr [EDI + 0xc]
005987b5 : TEST ECX,ECX
005987b7 : JZ 0x005987be
005987b9 : CALL 0x004ff7c0
005987be : LEA ECX,[ESP + 0x10]
005987c2 : PUSH ECX
005987c3 : MOV dword ptr [EDI + 0xc],0x0
005987ca : LEA ECX,[EDI + 0x30]
005987cd : MOV dword ptr [EDI + 0x2c],0x597210
005987d4 : CALL 0x00504fd0
005987d9 : ADD dword ptr [ESI + 0x8],-0x1
005987dd : JNZ 0x005987e6
005987df : MOV ECX,ESI
005987e1 : CALL 0x00525340
005987e6 : MOV EDI,dword ptr [ESP + 0x10]
005987ea : MOV EDX,EBP
005987ec : SHL EDX,0x4
005987ef : LEA ESI,[EDX + EDI*0x1 + -0x10]
005987f3 : TEST EBP,EBP
005987f5 : JBE 0x00598806
005987f7 : MOV ECX,ESI
005987f9 : CALL 0x00526bc0
005987fe : SUB ESI,0x10
00598801 : SUB EBP,0x1
00598804 : JNZ 0x005987f7
00598806 : PUSH EDI
00598807 : CALL 0x00515cf0
0059880c : POP EDI
0059880d : POP ESI
0059880e : POP EBP
0059880f : POP EBX
00598810 : ADD ESP,0x1c
00598813 : RET 0x4

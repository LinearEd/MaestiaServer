PROGRAM  : Maestia.exe
FUNCTION : FUN_0050fa50
ENTRY    : 0050fa50
BODY     : [[0050fa50, 0050fbbb]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0050fa50(void)

{
  int *piVar1;
  int iVar2;
  uint uVar3;
  LONG LVar4;
  undefined4 *in_ECX;
  
  iVar2 = in_ECX[0x3b];
  *in_ECX = &PTR_FUN_00b86978;
  in_ECX[3] = &PTR_LAB_00b8696c;
  in_ECX[0x1a] = &PTR_LAB_00b86918;
  if (iVar2 != 0) {
    FUN_00504110();
    FUN_00515cf0(iVar2);
  }
  in_ECX[0x3b] = 0;
  FUN_00544c80();
  iVar2 = in_ECX[0x39];
  if (iVar2 != 0) {
    FUN_00515cf0(*(undefined4 *)(iVar2 + 0x14));
    FUN_00515cf0(*(undefined4 *)(iVar2 + 8));
    piVar1 = (int *)(*(int *)(iVar2 + 4) + 8);
    *piVar1 = *piVar1 + -1;
    if (*piVar1 == 0) {
      FUN_00525340();
    }
    FUN_00515cf0(iVar2);
  }
  uVar3 = in_ECX[0x3d];
  LVar4 = InterlockedExchangeAdd((LONG *)((uVar3 & 0xfffffffc) + 4),-1);
  if (LVar4 == 1) {
    FUN_00515cf0(uVar3 & 0xfffffffc);
  }
  uVar3 = in_ECX[0x3c];
  LVar4 = InterlockedExchangeAdd((LONG *)((uVar3 & 0xfffffffc) + 4),-1);
  if (LVar4 == 1) {
    FUN_00515cf0(uVar3 & 0xfffffffc);
  }
  if (in_ECX[0x3a] != 0) {
    FUN_00503db0();
  }
  GRefCountImplCore::~GRefCountImplCore((GRefCountImplCore *)(in_ECX + 0x36));
  piVar1 = (int *)in_ECX[0x34];
  if (piVar1 != (int *)0x0) {
    if (*(char *)(in_ECX + 0x35) != '\0') {
      *(undefined1 *)(in_ECX + 0x35) = 0;
      FUN_005039e0(piVar1[1],piVar1[2]);
      FUN_00515cf0(piVar1[1]);
      if (*piVar1 != 0) {
        FUN_00503db0();
      }
      FUN_00515cf0(piVar1);
    }
    in_ECX[0x34] = 0;
  }
  *(undefined1 *)(in_ECX + 0x35) = 0;
  uVar3 = in_ECX[0x33];
  LVar4 = InterlockedExchangeAdd((LONG *)((uVar3 & 0xfffffffc) + 4),-1);
  if (LVar4 == 1) {
    FUN_00515cf0(uVar3 & 0xfffffffc);
  }
  FUN_00526bc0();
  piVar1 = (int *)(in_ECX[0x2d] + 8);
  *piVar1 = *piVar1 + -1;
  if (*piVar1 == 0) {
    FUN_00525340();
  }
  if ((GRefCountNTSImpl *)in_ECX[0x28] != (GRefCountNTSImpl *)0x0) {
    GRefCountNTSImpl::Release((GRefCountNTSImpl *)in_ECX[0x28]);
  }
  FUN_00522630();
  return;
}



============================================================
DISASSEMBLY
============================================================
0050fa50 : PUSH EBX
0050fa51 : PUSH ESI
0050fa52 : MOV ESI,ECX
0050fa54 : PUSH EDI
0050fa55 : MOV EDI,dword ptr [ESI + 0xec]
0050fa5b : XOR EBX,EBX
0050fa5d : MOV dword ptr [ESI],0xb86978
0050fa63 : MOV dword ptr [ESI + 0xc],0xb8696c
0050fa6a : MOV dword ptr [ESI + 0x68],0xb86918
0050fa71 : CMP EDI,EBX
0050fa73 : JZ 0x0050fa82
0050fa75 : MOV ECX,EDI
0050fa77 : CALL 0x00504110
0050fa7c : PUSH EDI
0050fa7d : CALL 0x00515cf0
0050fa82 : MOV ECX,dword ptr [ESI + 0xa0]
0050fa88 : MOV dword ptr [ESI + 0xec],EBX
0050fa8e : CALL 0x00544c80
0050fa93 : MOV EDI,dword ptr [ESI + 0xe4]
0050fa99 : CMP EDI,EBX
0050fa9b : JZ 0x0050fac3
0050fa9d : MOV EAX,dword ptr [EDI + 0x14]
0050faa0 : PUSH EAX
0050faa1 : CALL 0x00515cf0
0050faa6 : MOV ECX,dword ptr [EDI + 0x8]
0050faa9 : PUSH ECX
0050faaa : CALL 0x00515cf0
0050faaf : MOV ECX,dword ptr [EDI + 0x4]
0050fab2 : ADD dword ptr [ECX + 0x8],-0x1
0050fab6 : JNZ 0x0050fabd
0050fab8 : CALL 0x00525340
0050fabd : PUSH EDI
0050fabe : CALL 0x00515cf0
0050fac3 : MOV EDI,dword ptr [ESI + 0xf4]
0050fac9 : PUSH EBP
0050faca : MOV EBP,dword ptr [0x00b851cc]
0050fad0 : AND EDI,0xfffffffc
0050fad3 : PUSH -0x1
0050fad5 : LEA EDX,[EDI + 0x4]
0050fad8 : PUSH EDX
0050fad9 : CALL EBP
0050fadb : SUB EAX,0x1
0050fade : JNZ 0x0050fae6
0050fae0 : PUSH EDI
0050fae1 : CALL 0x00515cf0
0050fae6 : MOV EDI,dword ptr [ESI + 0xf0]
0050faec : AND EDI,0xfffffffc
0050faef : PUSH -0x1
0050faf1 : LEA EAX,[EDI + 0x4]
0050faf4 : PUSH EAX
0050faf5 : CALL EBP
0050faf7 : SUB EAX,0x1
0050fafa : JNZ 0x0050fb02
0050fafc : PUSH EDI
0050fafd : CALL 0x00515cf0
0050fb02 : MOV ECX,dword ptr [ESI + 0xe8]
0050fb08 : CMP ECX,EBX
0050fb0a : JZ 0x0050fb11
0050fb0c : CALL 0x00503db0
0050fb11 : LEA ECX,[ESI + 0xd8]
0050fb17 : CALL 0x004ff7b0
0050fb1c : MOV EDI,dword ptr [ESI + 0xd0]
0050fb22 : CMP EDI,EBX
0050fb24 : JZ 0x0050fb64
0050fb26 : CMP byte ptr [ESI + 0xd4],BL
0050fb2c : JZ 0x0050fb5e
0050fb2e : MOV byte ptr [ESI + 0xd4],BL
0050fb34 : MOV ECX,dword ptr [EDI + 0x8]
0050fb37 : MOV EDX,dword ptr [EDI + 0x4]
0050fb3a : PUSH ECX
0050fb3b : PUSH EDX
0050fb3c : CALL 0x005039e0
0050fb41 : MOV EAX,dword ptr [EDI + 0x4]
0050fb44 : ADD ESP,0x8
0050fb47 : PUSH EAX
0050fb48 : CALL 0x00515cf0
0050fb4d : MOV ECX,dword ptr [EDI]
0050fb4f : CMP ECX,EBX
0050fb51 : JZ 0x0050fb58
0050fb53 : CALL 0x00503db0
0050fb58 : PUSH EDI
0050fb59 : CALL 0x00515cf0
0050fb5e : MOV dword ptr [ESI + 0xd0],EBX
0050fb64 : MOV byte ptr [ESI + 0xd4],BL
0050fb6a : MOV EDI,dword ptr [ESI + 0xcc]
0050fb70 : AND EDI,0xfffffffc
0050fb73 : PUSH -0x1
0050fb75 : LEA ECX,[EDI + 0x4]
0050fb78 : PUSH ECX
0050fb79 : CALL EBP
0050fb7b : SUB EAX,0x1
0050fb7e : POP EBP
0050fb7f : JNZ 0x0050fb87
0050fb81 : PUSH EDI
0050fb82 : CALL 0x00515cf0
0050fb87 : LEA ECX,[ESI + 0xb8]
0050fb8d : CALL 0x00526bc0
0050fb92 : MOV ECX,dword ptr [ESI + 0xb4]
0050fb98 : ADD dword ptr [ECX + 0x8],-0x1
0050fb9c : JNZ 0x0050fba3
0050fb9e : CALL 0x00525340
0050fba3 : MOV ECX,dword ptr [ESI + 0xa0]
0050fba9 : CMP ECX,EBX
0050fbab : JZ 0x0050fbb2
0050fbad : CALL 0x004ff7c0
0050fbb2 : POP EDI
0050fbb3 : MOV ECX,ESI
0050fbb5 : POP ESI
0050fbb6 : POP EBX
0050fbb7 : JMP 0x00522630

PROGRAM  : Maestia.exe
FUNCTION : FUN_0052e110
ENTRY    : 0052e110
BODY     : [[0052e110, 0052e1ad] [0052e1b0, 0052e2bb]]

============================================================
DECOMPILED C CODE
============================================================

char * FUN_0052e110(undefined4 param_1,int param_2,uint param_3,int *param_4)

{
  int *piVar1;
  int *piVar2;
  char cVar3;
  char *pcVar4;
  char *pcVar5;
  int iVar6;
  int in_ECX;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  
  if ((*(int *)(*(int *)(in_ECX + 8) + 0xc) == 0) ||
     (pcVar4 = *(char **)(*(int *)(in_ECX + 8) + 8), *pcVar4 == '\0')) {
    pcVar4 = (char *)0x0;
  }
  pcVar5 = pcVar4;
  if (*(int *)(in_ECX + 0x1c) != param_2) {
    if (*(int *)(in_ECX + 0x1c) == -1) {
      *(int *)(in_ECX + 0x1c) = param_2;
      uVar8 = (uint)CONCAT11(pcVar4[param_2 + 4],pcVar4[param_2 + 3]);
      uVar9 = param_2 + 2;
      pcVar5 = (char *)FUN_0052b460(uVar8);
      uVar7 = 0;
      if (uVar8 != 0) {
        do {
          iVar6 = FUN_00525530(pcVar4 + uVar9 + 3);
          *(int *)(iVar6 + 8) = *(int *)(iVar6 + 8) + 1;
          piVar2 = (int *)(*(int *)(in_ECX + 0xc) + uVar7 * 4);
          *(int *)(iVar6 + 8) = *(int *)(iVar6 + 8) + 1;
          piVar1 = (int *)(*piVar2 + 8);
          *piVar1 = *piVar1 + -1;
          if (*piVar1 == 0) {
            FUN_00525340();
          }
          *piVar2 = iVar6;
          piVar1 = (int *)(iVar6 + 8);
          *piVar1 = *piVar1 + -1;
          if (*piVar1 == 0) {
            FUN_00525340();
          }
          iVar6 = uVar9 + 3;
          cVar3 = pcVar4[uVar9 + 3];
          while (cVar3 != '\0') {
            if (param_3 <= uVar9) {
              pcVar4 = (char *)(**(code **)(*param_4 + 4))();
              if ((char)pcVar4 != '\0') {
                pcVar4 = (char *)FUN_0052c750(param_4,"Error: Action buffer dict length exceeded\n")
                ;
              }
              for (; uVar7 < uVar8; uVar7 = uVar7 + 1) {
                iVar6 = FUN_00525530("<invalid>");
                *(int *)(iVar6 + 8) = *(int *)(iVar6 + 8) + 1;
                pcVar4 = (char *)(*(int *)(iVar6 + 8) + 1);
                piVar2 = (int *)(*(int *)(in_ECX + 0xc) + uVar7 * 4);
                *(char **)(iVar6 + 8) = pcVar4;
                piVar1 = (int *)(*piVar2 + 8);
                *piVar1 = *piVar1 + -1;
                if (*piVar1 == 0) {
                  pcVar4 = (char *)FUN_00525340();
                }
                *piVar2 = iVar6;
                piVar1 = (int *)(iVar6 + 8);
                *piVar1 = *piVar1 + -1;
                if (*piVar1 == 0) {
                  pcVar4 = (char *)FUN_00525340();
                }
              }
              return pcVar4;
            }
            cVar3 = pcVar4[uVar9 + 4];
            uVar9 = uVar9 + 1;
          }
          uVar7 = uVar7 + 1;
          uVar9 = uVar9 + 1;
        } while (uVar7 < uVar8);
        return pcVar4 + iVar6;
      }
    }
    else {
      pcVar5 = (char *)(**(code **)(*param_4 + 4))();
      if ((char)pcVar5 != '\0') {
        pcVar4 = (char *)FUN_0052c750(param_4,
                                      "Error: ProcessDeclDict(%d, %d) - DeclDict was already processed at %d\n"
                                      ,param_2,param_3,*(undefined4 *)(in_ECX + 0x1c));
        return pcVar4;
      }
    }
  }
  return pcVar5;
}



============================================================
DISASSEMBLY
============================================================
0052e110 : SUB ESP,0x8
0052e113 : PUSH EBP
0052e114 : MOV EBP,ECX
0052e116 : MOV EAX,dword ptr [EBP + 0x8]
0052e119 : CMP dword ptr [EAX + 0xc],0x1
0052e11d : PUSH EDI
0052e11e : JC 0x0052e128
0052e120 : MOV EAX,dword ptr [EAX + 0x8]
0052e123 : CMP byte ptr [EAX],0x0
0052e126 : JNZ 0x0052e12a
0052e128 : XOR EAX,EAX
0052e12a : MOV ECX,dword ptr [EBP + 0x1c]
0052e12d : MOV EDI,dword ptr [ESP + 0x18]
0052e131 : MOV dword ptr [ESP + 0x8],EAX
0052e135 : CMP ECX,EDI
0052e137 : JZ 0x0052e2b4
0052e13d : PUSH ESI
0052e13e : CMP ECX,-0x1
0052e141 : JZ 0x0052e179
0052e143 : MOV ESI,dword ptr [ESP + 0x24]
0052e147 : MOV EAX,dword ptr [ESI]
0052e149 : MOV EDX,dword ptr [EAX + 0x4]
0052e14c : MOV ECX,ESI
0052e14e : CALL EDX
0052e150 : TEST AL,AL
0052e152 : JZ 0x0052e2b3
0052e158 : MOV EAX,dword ptr [EBP + 0x1c]
0052e15b : MOV ECX,dword ptr [ESP + 0x20]
0052e15f : PUSH EAX
0052e160 : PUSH ECX
0052e161 : PUSH EDI
0052e162 : PUSH 0xb8b4c0
0052e167 : PUSH ESI
0052e168 : CALL 0x0052c750
0052e16d : ADD ESP,0x14
0052e170 : POP ESI
0052e171 : POP EDI
0052e172 : POP EBP
0052e173 : ADD ESP,0x8
0052e176 : RET 0x10
0052e179 : MOV dword ptr [EBP + 0x1c],EDI
0052e17c : MOVZX ESI,byte ptr [EAX + EDI*0x1 + 0x4]
0052e181 : MOVZX EDX,byte ptr [EAX + EDI*0x1 + 0x3]
0052e186 : SHL ESI,0x8
0052e189 : OR ESI,EDX
0052e18b : PUSH EBX
0052e18c : ADD EBP,0xc
0052e18f : PUSH ESI
0052e190 : MOV ECX,EBP
0052e192 : MOV dword ptr [ESP + 0x24],ESI
0052e196 : ADD EDI,0x2
0052e199 : MOV dword ptr [ESP + 0x18],EBP
0052e19d : CALL 0x0052b460
0052e1a2 : XOR EBX,EBX
0052e1a4 : TEST ESI,ESI
0052e1a6 : JBE 0x0052e2b2
0052e1ac : JMP 0x0052e1b4
0052e1b0 : MOV EBP,dword ptr [ESP + 0x14]
0052e1b4 : MOV EAX,dword ptr [ESP + 0x1c]
0052e1b8 : MOV EAX,dword ptr [EAX]
0052e1ba : MOV ECX,dword ptr [ESP + 0x10]
0052e1be : LEA ECX,[ECX + EDI*0x1 + 0x3]
0052e1c2 : ADD EAX,0x8
0052e1c5 : PUSH ECX
0052e1c6 : LEA ECX,[EAX + 0x24c]
0052e1cc : CALL 0x00525530
0052e1d1 : MOV ESI,EAX
0052e1d3 : INC dword ptr [ESI + 0x8]
0052e1d6 : MOV EAX,dword ptr [ESI + 0x8]
0052e1d9 : MOV EDX,dword ptr [EBP]
0052e1dc : INC EAX
0052e1dd : LEA EBP,[EDX + EBX*0x4]
0052e1e0 : MOV dword ptr [ESI + 0x8],EAX
0052e1e3 : MOV ECX,dword ptr [EBP]
0052e1e6 : ADD dword ptr [ECX + 0x8],-0x1
0052e1ea : JNZ 0x0052e1f1
0052e1ec : CALL 0x00525340
0052e1f1 : MOV dword ptr [EBP],ESI
0052e1f4 : ADD dword ptr [ESI + 0x8],-0x1
0052e1f8 : JNZ 0x0052e201
0052e1fa : MOV ECX,ESI
0052e1fc : CALL 0x00525340
0052e201 : MOV EAX,dword ptr [ESP + 0x10]
0052e205 : CMP byte ptr [EAX + EDI*0x1 + 0x3],0x0
0052e20a : LEA EAX,[EAX + EDI*0x1 + 0x3]
0052e20e : JZ 0x0052e222
0052e210 : CMP EDI,dword ptr [ESP + 0x24]
0052e214 : JNC 0x0052e234
0052e216 : MOV ECX,dword ptr [ESP + 0x10]
0052e21a : INC EDI
0052e21b : CMP byte ptr [ECX + EDI*0x1 + 0x3],0x0
0052e220 : JNZ 0x0052e210
0052e222 : INC EBX
0052e223 : INC EDI
0052e224 : CMP EBX,dword ptr [ESP + 0x20]
0052e228 : JC 0x0052e1b0
0052e22a : POP EBX
0052e22b : POP ESI
0052e22c : POP EDI
0052e22d : POP EBP
0052e22e : ADD ESP,0x8
0052e231 : RET 0x10
0052e234 : MOV ESI,dword ptr [ESP + 0x28]
0052e238 : MOV EDX,dword ptr [ESI]
0052e23a : MOV EAX,dword ptr [EDX + 0x4]
0052e23d : MOV ECX,ESI
0052e23f : CALL EAX
0052e241 : TEST AL,AL
0052e243 : JZ 0x0052e253
0052e245 : PUSH 0xb8b490
0052e24a : PUSH ESI
0052e24b : CALL 0x0052c750
0052e250 : ADD ESP,0x8
0052e253 : CMP EBX,dword ptr [ESP + 0x20]
0052e257 : JNC 0x0052e2b2
0052e259 : LEA ESP,[ESP]
0052e260 : MOV ECX,dword ptr [ESP + 0x1c]
0052e264 : MOV EAX,dword ptr [ECX]
0052e266 : ADD EAX,0x8
0052e269 : PUSH 0xb8b484
0052e26e : LEA ECX,[EAX + 0x24c]
0052e274 : CALL 0x00525530
0052e279 : MOV EDX,dword ptr [ESP + 0x14]
0052e27d : MOV ESI,EAX
0052e27f : INC dword ptr [ESI + 0x8]
0052e282 : MOV EAX,dword ptr [ESI + 0x8]
0052e285 : MOV ECX,dword ptr [EDX]
0052e287 : INC EAX
0052e288 : LEA EDI,[ECX + EBX*0x4]
0052e28b : MOV dword ptr [ESI + 0x8],EAX
0052e28e : MOV ECX,dword ptr [EDI]
0052e290 : OR EBP,0xffffffff
0052e293 : ADD dword ptr [ECX + 0x8],EBP
0052e296 : JNZ 0x0052e29d
0052e298 : CALL 0x00525340
0052e29d : MOV dword ptr [EDI],ESI
0052e29f : ADD dword ptr [ESI + 0x8],EBP
0052e2a2 : JNZ 0x0052e2ab
0052e2a4 : MOV ECX,ESI
0052e2a6 : CALL 0x00525340
0052e2ab : INC EBX
0052e2ac : CMP EBX,dword ptr [ESP + 0x20]
0052e2b0 : JC 0x0052e260
0052e2b2 : POP EBX
0052e2b3 : POP ESI
0052e2b4 : POP EDI
0052e2b5 : POP EBP
0052e2b6 : ADD ESP,0x8
0052e2b9 : RET 0x10

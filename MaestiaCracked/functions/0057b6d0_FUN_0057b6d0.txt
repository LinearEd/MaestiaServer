PROGRAM  : Maestia.exe
FUNCTION : FUN_0057b6d0
ENTRY    : 0057b6d0
BODY     : [[0057b6d0, 0057b8da]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_0057b6d0(int *param_1,int *param_2)

{
  uint uVar1;
  char *pcVar2;
  char cVar3;
  int iVar4;
  int iVar5;
  int *piVar6;
  GRefCountNTSImpl *this;
  undefined4 unaff_retaddr;
  uint uVar7;
  int iStack_38;
  int iStack_34;
  byte bStack_30;
  undefined1 auStack_2c [28];
  undefined1 local_10 [12];
  int iStack_4;
  
  if (param_2 != (int *)0x0) {
    local_10[0] = 0;
    cVar3 = (**(code **)(*param_2 + 0x2c))(param_1 + 0x1e,param_1[0x1e] + 0x140,local_10);
    if (((cVar3 != '\0') && (iVar4 = FUN_00526fa0(param_1), iVar4 != 0)) &&
       (iVar5 = (**(code **)(*(int *)(iVar4 + 0x10) + 8))(), iVar5 == 7)) {
      *(uint *)(iVar4 + 8) = *(int *)(iVar4 + 8) + 1U & 0x8fffffff;
      if (0 < *(int *)(iVar4 + 0x38)) {
        iVar5 = FUN_00515840(0x48,0);
        if (iVar5 == 0) {
          iStack_4 = 0;
        }
        else {
          iStack_4 = FUN_00585130(param_1);
        }
        iVar5 = iStack_4;
        FUN_00585350(*(undefined4 *)(param_1[0x1e] + 0x288),iVar4);
        uVar1 = *(uint *)(iVar5 + 0x38);
        uVar7 = 0;
        if (uVar1 != 0) {
          do {
            pcVar2 = *(char **)(*(int *)(iVar5 + 0x34) + uVar7 * 4);
            if ((pcVar2 != (char *)0x0) &&
               (piVar6 = (int *)FUN_005270f0(param_1), piVar6 != (int *)0x0)) {
              this = (GRefCountNTSImpl *)0x0;
              if (*pcVar2 == '\a') {
                this = (GRefCountNTSImpl *)FUN_00525fa0(param_1);
                if (this != (GRefCountNTSImpl *)0x0) {
                  *(int *)(this + 4) = *(int *)(this + 4) + 1;
                }
                iVar4 = 0;
              }
              else {
                iVar4 = FUN_00526fa0(param_1);
                if (iVar4 != 0) {
                  *(uint *)(iVar4 + 8) = *(int *)(iVar4 + 8) + 1U & 0x8fffffff;
                }
              }
              auStack_2c[0] = 0;
              cVar3 = (**(code **)(*piVar6 + 0x2c))(param_1 + 0x1e,unaff_retaddr,auStack_2c);
              if (cVar3 != '\0') {
                FUN_00527140(&iStack_38,param_1);
                if (iStack_38 != 0) {
                  (**(code **)(*param_1 + 4))(param_1,piVar6,&iStack_38);
                }
                if (((bStack_30 & 2) == 0) && (iStack_38 != 0)) {
                  FUN_00503db0();
                }
                iStack_38 = 0;
                if (((bStack_30 & 1) == 0) && (iStack_34 != 0)) {
                  FUN_00503db0();
                }
                iStack_34 = 0;
              }
              FUN_00526bc0();
              if (this != (GRefCountNTSImpl *)0x0) {
                GRefCountNTSImpl::Release(this);
              }
              if (iVar4 != 0) {
                FUN_00503db0();
              }
            }
            uVar7 = uVar7 + 1;
            iVar5 = iStack_4;
          } while (uVar7 < uVar1);
        }
        FUN_00503db0();
      }
      FUN_00503db0();
    }
    FUN_00526bc0();
    return 1;
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
0057b6d0 : MOV ECX,dword ptr [ESP + 0x8]
0057b6d4 : SUB ESP,0x3c
0057b6d7 : TEST ECX,ECX
0057b6d9 : JNZ 0x0057b6e1
0057b6db : XOR AL,AL
0057b6dd : ADD ESP,0x3c
0057b6e0 : RET
0057b6e1 : MOV EDX,dword ptr [ECX]
0057b6e3 : PUSH EBP
0057b6e4 : MOV EBP,dword ptr [ESP + 0x44]
0057b6e8 : MOV EAX,dword ptr [EBP + 0x78]
0057b6eb : PUSH ESI
0057b6ec : PUSH EDI
0057b6ed : LEA ESI,[EBP + 0x78]
0057b6f0 : LEA EDI,[ESP + 0x38]
0057b6f4 : PUSH EDI
0057b6f5 : ADD EAX,0x140
0057b6fa : PUSH EAX
0057b6fb : MOV EAX,dword ptr [EDX + 0x2c]
0057b6fe : PUSH ESI
0057b6ff : MOV byte ptr [ESP + 0x44],0x0
0057b704 : CALL EAX
0057b706 : TEST AL,AL
0057b708 : JZ 0x0057b8c9
0057b70e : PUSH EBX
0057b70f : PUSH EBP
0057b710 : MOV ECX,EDI
0057b712 : CALL 0x00526fa0
0057b717 : MOV EBX,EAX
0057b719 : MOV dword ptr [ESP + 0x10],EBX
0057b71d : TEST EBX,EBX
0057b71f : JZ 0x0057b8c8
0057b725 : MOV EDX,dword ptr [EBX + 0x10]
0057b728 : MOV EAX,dword ptr [EDX + 0x8]
0057b72b : LEA ECX,[EBX + 0x10]
0057b72e : CALL EAX
0057b730 : CMP EAX,0x7
0057b733 : JNZ 0x0057b8c8
0057b739 : MOV ECX,dword ptr [EBX + 0x8]
0057b73c : INC ECX
0057b73d : AND ECX,0x8fffffff
0057b743 : CMP dword ptr [EBX + 0x38],0x0
0057b747 : MOV dword ptr [EBX + 0x8],ECX
0057b74a : JLE 0x0057b8c1
0057b750 : MOV EDX,dword ptr [ESI]
0057b752 : MOV ECX,dword ptr [EDX + 0x288]
0057b758 : PUSH 0x0
0057b75a : PUSH 0x48
0057b75c : CALL 0x00515840
0057b761 : TEST EAX,EAX
0057b763 : JZ 0x0057b773
0057b765 : PUSH EBP
0057b766 : MOV ECX,EAX
0057b768 : CALL 0x00585130
0057b76d : MOV dword ptr [ESP + 0x54],EAX
0057b771 : JMP 0x0057b77b
0057b773 : MOV dword ptr [ESP + 0x54],0x0
0057b77b : MOV EAX,dword ptr [ESI]
0057b77d : MOV ECX,dword ptr [EAX + 0x288]
0057b783 : MOV ESI,dword ptr [ESP + 0x54]
0057b787 : PUSH EBX
0057b788 : PUSH ECX
0057b789 : MOV ECX,ESI
0057b78b : CALL 0x00585350
0057b790 : MOV ECX,dword ptr [ESI + 0x38]
0057b793 : XOR EAX,EAX
0057b795 : MOV dword ptr [ESP + 0x14],EAX
0057b799 : MOV dword ptr [ESP + 0x1c],ECX
0057b79d : TEST ECX,ECX
0057b79f : JBE 0x0057b8ba
0057b7a5 : MOV EDX,dword ptr [ESI + 0x34]
0057b7a8 : MOV ESI,dword ptr [EDX + EAX*0x4]
0057b7ab : TEST ESI,ESI
0057b7ad : JZ 0x0057b8a3
0057b7b3 : PUSH EBP
0057b7b4 : MOV ECX,ESI
0057b7b6 : CALL 0x005270f0
0057b7bb : MOV EDI,EAX
0057b7bd : TEST EDI,EDI
0057b7bf : JZ 0x0057b8a3
0057b7c5 : XOR EBX,EBX
0057b7c7 : CMP byte ptr [ESI],0x7
0057b7ca : MOV dword ptr [ESP + 0x18],EBX
0057b7ce : PUSH EBP
0057b7cf : MOV ECX,ESI
0057b7d1 : JNZ 0x0057b7e7
0057b7d3 : CALL 0x00525fa0
0057b7d8 : TEST EAX,EAX
0057b7da : JZ 0x0057b7df
0057b7dc : INC dword ptr [EAX + 0x4]
0057b7df : MOV ESI,dword ptr [ESP + 0x18]
0057b7e3 : MOV EBX,EAX
0057b7e5 : JMP 0x0057b7ff
0057b7e7 : CALL 0x00526fa0
0057b7ec : TEST EAX,EAX
0057b7ee : JZ 0x0057b7fd
0057b7f0 : MOV ECX,dword ptr [EAX + 0x8]
0057b7f3 : INC ECX
0057b7f4 : AND ECX,0x8fffffff
0057b7fa : MOV dword ptr [EAX + 0x8],ECX
0057b7fd : MOV ESI,EAX
0057b7ff : MOV ECX,dword ptr [ESP + 0x58]
0057b803 : MOV EDX,dword ptr [EDI]
0057b805 : MOV EDX,dword ptr [EDX + 0x2c]
0057b808 : LEA EAX,[ESP + 0x2c]
0057b80c : PUSH EAX
0057b80d : PUSH ECX
0057b80e : LEA EAX,[EBP + 0x78]
0057b811 : PUSH EAX
0057b812 : MOV ECX,EDI
0057b814 : MOV byte ptr [ESP + 0x38],0x0
0057b819 : CALL EDX
0057b81b : TEST AL,AL
0057b81d : JZ 0x0057b880
0057b81f : PUSH EBP
0057b820 : LEA EAX,[ESP + 0x24]
0057b824 : PUSH EAX
0057b825 : LEA ECX,[ESP + 0x34]
0057b829 : CALL 0x00527140
0057b82e : MOV ECX,dword ptr [ESP + 0x20]
0057b832 : TEST ECX,ECX
0057b834 : JZ 0x0057b84c
0057b836 : MOV ECX,dword ptr [ESP + 0x5c]
0057b83a : MOV EDX,dword ptr [ECX]
0057b83c : MOV EDX,dword ptr [EDX + 0x4]
0057b83f : LEA EAX,[ESP + 0x20]
0057b843 : PUSH EAX
0057b844 : PUSH EDI
0057b845 : PUSH EBP
0057b846 : CALL EDX
0057b848 : MOV ECX,dword ptr [ESP + 0x20]
0057b84c : TEST byte ptr [ESP + 0x28],0x2
0057b851 : JNZ 0x0057b85c
0057b853 : TEST ECX,ECX
0057b855 : JZ 0x0057b85c
0057b857 : CALL 0x00503db0
0057b85c : TEST byte ptr [ESP + 0x28],0x1
0057b861 : MOV dword ptr [ESP + 0x20],0x0
0057b869 : JNZ 0x0057b878
0057b86b : MOV ECX,dword ptr [ESP + 0x24]
0057b86f : TEST ECX,ECX
0057b871 : JZ 0x0057b878
0057b873 : CALL 0x00503db0
0057b878 : MOV dword ptr [ESP + 0x24],0x0
0057b880 : LEA ECX,[ESP + 0x2c]
0057b884 : CALL 0x00526bc0
0057b889 : TEST EBX,EBX
0057b88b : JZ 0x0057b894
0057b88d : MOV ECX,EBX
0057b88f : CALL 0x004ff7c0
0057b894 : TEST ESI,ESI
0057b896 : JZ 0x0057b89f
0057b898 : MOV ECX,ESI
0057b89a : CALL 0x00503db0
0057b89f : MOV EBX,dword ptr [ESP + 0x10]
0057b8a3 : MOV EAX,dword ptr [ESP + 0x14]
0057b8a7 : MOV ESI,dword ptr [ESP + 0x54]
0057b8ab : INC EAX
0057b8ac : MOV dword ptr [ESP + 0x14],EAX
0057b8b0 : CMP EAX,dword ptr [ESP + 0x1c]
0057b8b4 : JC 0x0057b7a5
0057b8ba : MOV ECX,ESI
0057b8bc : CALL 0x00503db0
0057b8c1 : MOV ECX,EBX
0057b8c3 : CALL 0x00503db0
0057b8c8 : POP EBX
0057b8c9 : LEA ECX,[ESP + 0x38]
0057b8cd : CALL 0x00526bc0
0057b8d2 : POP EDI
0057b8d3 : POP ESI
0057b8d4 : MOV AL,0x1
0057b8d6 : POP EBP
0057b8d7 : ADD ESP,0x3c
0057b8da : RET

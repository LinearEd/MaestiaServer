PROGRAM  : Maestia.exe
FUNCTION : FUN_007cf510
ENTRY    : 007cf510
BODY     : [[007cf510, 007cf61a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007cf510(undefined4 *param_1)

{
  char cVar1;
  undefined4 *in_ECX;
  int *unaff_EDI;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1a0f7;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  in_ECX[0xd] = unaff_EDI;
  cVar1 = (**(code **)(*unaff_EDI + 0xc))();
  if (cVar1 == '\0') {
    local_2c = 0;
    local_18 = 7;
    local_1c = 0;
    FUN_00405eb0(in_ECX + 1,0,0xffffffff);
    local_8 = 1;
    in_ECX[0xd] = 0;
    (**(code **)*in_ECX)(1);
    FUN_00801fc0(param_1,local_30);
    local_8 = local_8 & 0xffffff00;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c = 0;
  }
  else {
    FUN_007cf300(0);
    param_1[1] = in_ECX;
    *param_1 = &PTR_FUN_00cd4964;
    InterlockedIncrement(in_ECX + 0xb);
    local_8 = 0;
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
007cf510 : PUSH EBP
007cf511 : MOV EBP,ESP
007cf513 : PUSH -0x1
007cf515 : PUSH 0xb1a0f7
007cf51a : MOV EAX,FS:[0x0]
007cf520 : PUSH EAX
007cf521 : SUB ESP,0x28
007cf524 : MOV EAX,[0x00d66fa0]
007cf529 : XOR EAX,EBP
007cf52b : MOV dword ptr [EBP + -0x10],EAX
007cf52e : PUSH EBX
007cf52f : PUSH ESI
007cf530 : PUSH EAX
007cf531 : LEA EAX,[EBP + -0xc]
007cf534 : MOV FS:[0x0],EAX
007cf53a : MOV EBX,dword ptr [EBP + 0x8]
007cf53d : MOV ESI,ECX
007cf53f : MOV dword ptr [EBP + -0x30],0x0
007cf546 : MOV dword ptr [ESI + 0x34],EDI
007cf549 : MOV EAX,dword ptr [EDI]
007cf54b : MOV EDX,dword ptr [EAX + 0xc]
007cf54e : PUSH ESI
007cf54f : MOV ECX,EDI
007cf551 : MOV dword ptr [EBP + -0x34],EBX
007cf554 : CALL EDX
007cf556 : TEST AL,AL
007cf558 : JNZ 0x007cf5d0
007cf55a : XOR ECX,ECX
007cf55c : PUSH -0x1
007cf55e : PUSH ECX
007cf55f : LEA EAX,[ESI + 0x4]
007cf562 : MOV word ptr [EBP + -0x28],CX
007cf566 : PUSH EAX
007cf567 : LEA ECX,[EBP + -0x2c]
007cf56a : MOV dword ptr [EBP + -0x14],0x7
007cf571 : MOV dword ptr [EBP + -0x18],0x0
007cf578 : CALL 0x00405eb0
007cf57d : MOV dword ptr [EBP + -0x4],0x1
007cf584 : MOV dword ptr [ESI + 0x34],0x0
007cf58b : MOV EDX,dword ptr [ESI]
007cf58d : MOV EAX,dword ptr [EDX]
007cf58f : PUSH 0x1
007cf591 : MOV ECX,ESI
007cf593 : CALL EAX
007cf595 : LEA ECX,[EBP + -0x2c]
007cf598 : PUSH ECX
007cf599 : PUSH EBX
007cf59a : MOV ECX,EDI
007cf59c : CALL 0x00801fc0
007cf5a1 : MOV dword ptr [EBP + -0x30],0x1
007cf5a8 : MOV byte ptr [EBP + -0x4],0x0
007cf5ac : CMP dword ptr [EBP + -0x14],0x8
007cf5b0 : JC 0x007cf5ba
007cf5b2 : MOV ECX,dword ptr [EBP + -0x28]
007cf5b5 : CALL 0x006f04e0
007cf5ba : XOR EDX,EDX
007cf5bc : MOV dword ptr [EBP + -0x14],0x7
007cf5c3 : MOV dword ptr [EBP + -0x18],0x0
007cf5ca : MOV word ptr [EBP + -0x28],DX
007cf5ce : JMP 0x007cf5fc
007cf5d0 : PUSH 0x0
007cf5d2 : MOV ECX,ESI
007cf5d4 : MOV EDX,EDI
007cf5d6 : CALL 0x007cf300
007cf5db : MOV dword ptr [EBX + 0x4],ESI
007cf5de : ADD ESI,0x2c
007cf5e1 : PUSH ESI
007cf5e2 : MOV dword ptr [EBX],0xcd4964
007cf5e8 : CALL dword ptr [0x00b850dc]
007cf5ee : MOV dword ptr [EBP + -0x4],0x0
007cf5f5 : MOV dword ptr [EBP + -0x30],0x1
007cf5fc : MOV EAX,EBX
007cf5fe : MOV ECX,dword ptr [EBP + -0xc]
007cf601 : MOV dword ptr FS:[0x0],ECX
007cf608 : POP ECX
007cf609 : POP ESI
007cf60a : POP EBX
007cf60b : MOV ECX,dword ptr [EBP + -0x10]
007cf60e : XOR ECX,EBP
007cf610 : CALL 0x00633e6b
007cf615 : MOV ESP,EBP
007cf617 : POP EBP
007cf618 : RET 0x4

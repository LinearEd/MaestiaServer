PROGRAM  : Maestia.exe
FUNCTION : FUN_00664160
ENTRY    : 00664160
BODY     : [[00664160, 006641e1]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00664160(undefined4 param_1,undefined4 param_2,undefined4 *param_3,int param_4,
                 undefined4 param_5)

{
  HANDLE pvVar1;
  int in_ECX;
  
  FUN_00664790(param_1,param_2);
  InitializeCriticalSection((LPCRITICAL_SECTION)(in_ECX + 0x10));
  *(undefined4 *)(in_ECX + 0x28) = 0;
  *(undefined4 *)(in_ECX + 0x2c) = 0;
  *(undefined4 *)(in_ECX + 0x30) = 0;
  *(undefined4 *)(in_ECX + 0x34) = 0;
  *(undefined4 *)(in_ECX + 0x38) = 0;
  *(undefined4 *)(in_ECX + 0x3c) = 0;
  *(undefined4 *)(in_ECX + 0x40) = 0;
  *(undefined4 *)(in_ECX + 0x44) = 0;
  *(undefined4 *)(in_ECX + 0x48) = 0;
  *(undefined4 *)(in_ECX + 0x4c) = 0;
  *(undefined4 *)(in_ECX + 0x50) = 0;
  *(undefined4 *)(in_ECX + 0x54) = 0;
  *(undefined4 *)(in_ECX + 0x58) = 0;
  *(undefined4 *)(in_ECX + 0x5c) = param_5;
  if (param_4 != 0) {
    pvVar1 = CreateSemaphoreW((LPSECURITY_ATTRIBUTES)0x0,0,0x7fffffff,(LPCWSTR)0x0);
    *(HANDLE *)(in_ECX + 0x30) = pvVar1;
    if (pvVar1 == (HANDLE)0x0) {
      *param_3 = 0x8007000e;
      return;
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00664160 : MOV EAX,dword ptr [ESP + 0x8]
00664164 : PUSH ESI
00664165 : PUSH EDI
00664166 : MOV ESI,ECX
00664168 : MOV ECX,dword ptr [ESP + 0xc]
0066416c : PUSH EAX
0066416d : PUSH ECX
0066416e : MOV ECX,ESI
00664170 : CALL 0x00664790
00664175 : LEA EDX,[ESI + 0x10]
00664178 : PUSH EDX
00664179 : CALL dword ptr [0x00b85114]
0066417f : MOV EAX,dword ptr [ESP + 0x1c]
00664183 : XOR EDI,EDI
00664185 : MOV dword ptr [ESI + 0x28],EDI
00664188 : MOV dword ptr [ESI + 0x2c],EDI
0066418b : MOV dword ptr [ESI + 0x30],EDI
0066418e : MOV dword ptr [ESI + 0x34],EDI
00664191 : MOV dword ptr [ESI + 0x38],EDI
00664194 : MOV dword ptr [ESI + 0x3c],EDI
00664197 : MOV dword ptr [ESI + 0x40],EDI
0066419a : MOV dword ptr [ESI + 0x44],EDI
0066419d : MOV dword ptr [ESI + 0x48],EDI
006641a0 : MOV dword ptr [ESI + 0x4c],EDI
006641a3 : MOV dword ptr [ESI + 0x50],EDI
006641a6 : MOV dword ptr [ESI + 0x54],EDI
006641a9 : MOV dword ptr [ESI + 0x58],EDI
006641ac : MOV dword ptr [ESI + 0x5c],EAX
006641af : CMP dword ptr [ESP + 0x18],EDI
006641b3 : JZ 0x006641db
006641b5 : PUSH EDI
006641b6 : PUSH 0x7fffffff
006641bb : PUSH EDI
006641bc : PUSH EDI
006641bd : CALL dword ptr [0x00b853ac]
006641c3 : MOV dword ptr [ESI + 0x30],EAX
006641c6 : CMP EAX,EDI
006641c8 : MOV EAX,ESI
006641ca : JNZ 0x006641dd
006641cc : MOV ECX,dword ptr [ESP + 0x14]
006641d0 : POP EDI
006641d1 : MOV dword ptr [ECX],0x8007000e
006641d7 : POP ESI
006641d8 : RET 0x14
006641db : MOV EAX,ESI
006641dd : POP EDI
006641de : POP ESI
006641df : RET 0x14

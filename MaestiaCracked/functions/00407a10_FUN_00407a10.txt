PROGRAM  : Maestia.exe
FUNCTION : FUN_00407a10
ENTRY    : 00407a10
BODY     : [[00407a10, 00407c03]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00407a10(uint param_1,undefined4 *param_2,uint param_3)

{
  int iVar1;
  undefined4 *puVar2;
  uint uVar3;
  int iVar4;
  undefined4 *puVar5;
  int iVar6;
  int unaff_ESI;
  uint unaff_EDI;
  
  if (param_2 != (undefined4 *)0x0) {
    puVar2 = (undefined4 *)(unaff_ESI + 4);
    puVar5 = puVar2;
    if (7 < *(uint *)(unaff_ESI + 0x18)) {
      puVar5 = (undefined4 *)*puVar2;
    }
    if (puVar5 <= param_2) {
      puVar5 = puVar2;
      if (7 < *(uint *)(unaff_ESI + 0x18)) {
        puVar5 = (undefined4 *)*puVar2;
      }
      if (param_2 < (undefined4 *)((int)puVar5 + *(int *)(unaff_ESI + 0x14) * 2)) {
        if (7 < *(uint *)(unaff_ESI + 0x18)) {
          puVar2 = (undefined4 *)*puVar2;
        }
        FUN_00408540(unaff_ESI,param_1,unaff_ESI,(int)param_2 - (int)puVar2 >> 1);
        return;
      }
    }
  }
  if (*(uint *)(unaff_ESI + 0x14) < unaff_EDI) {
    FUN_00622f07();
  }
  uVar3 = *(int *)(unaff_ESI + 0x14) - unaff_EDI;
  if (uVar3 < param_1) {
    param_1 = uVar3;
  }
  if (-param_3 - 1 <= *(int *)(unaff_ESI + 0x14) - param_1) {
    FUN_00622ecf();
  }
  iVar4 = (*(int *)(unaff_ESI + 0x14) - unaff_EDI) - param_1;
  if (param_3 < param_1) {
    if (*(uint *)(unaff_ESI + 0x18) < 8) {
      iVar1 = unaff_ESI + 4;
      iVar6 = unaff_ESI + 4;
    }
    else {
      iVar1 = *(int *)(unaff_ESI + 4);
      iVar6 = *(int *)(unaff_ESI + 4);
    }
    _memmove_s((void *)(iVar6 + (unaff_EDI + param_3) * 2),
               ((*(uint *)(unaff_ESI + 0x18) - unaff_EDI) - param_3) * 2,
               (void *)(iVar1 + (unaff_EDI + param_1) * 2),iVar4 * 2);
  }
  if ((param_3 != 0) || (param_1 != 0)) {
    uVar3 = (*(int *)(unaff_ESI + 0x14) - param_1) + param_3;
    if (0x7ffffffe < uVar3) {
      FUN_00622ecf();
    }
    if (*(uint *)(unaff_ESI + 0x18) < uVar3) {
      FUN_00406170(uVar3,*(undefined4 *)(unaff_ESI + 0x14));
    }
    else if (uVar3 == 0) {
      *(undefined4 *)(unaff_ESI + 0x14) = 0;
      if (*(uint *)(unaff_ESI + 0x18) < 8) {
        *(undefined2 *)(unaff_ESI + 4) = 0;
        return;
      }
      **(undefined2 **)(unaff_ESI + 4) = 0;
      return;
    }
    if (uVar3 != 0) {
      if (param_1 < param_3) {
        puVar2 = (undefined4 *)(unaff_ESI + 4);
        puVar5 = puVar2;
        if (7 < *(uint *)(unaff_ESI + 0x18)) {
          puVar5 = (undefined4 *)*puVar2;
          puVar2 = (undefined4 *)*puVar2;
        }
        FUN_00405de0((int)puVar2 + (unaff_EDI + param_3) * 2,
                     (*(uint *)(unaff_ESI + 0x18) - unaff_EDI) - param_3,
                     (int)puVar5 + (param_1 + unaff_EDI) * 2,iVar4);
      }
      if (*(uint *)(unaff_ESI + 0x18) < 8) {
        iVar4 = unaff_ESI + 4;
      }
      else {
        iVar4 = *(int *)(unaff_ESI + 4);
      }
      _memcpy_s((void *)(iVar4 + unaff_EDI * 2),(*(uint *)(unaff_ESI + 0x18) - unaff_EDI) * 2,
                param_2,param_3 * 2);
      *(uint *)(unaff_ESI + 0x14) = uVar3;
      if (7 < *(uint *)(unaff_ESI + 0x18)) {
        *(undefined2 *)(*(int *)(unaff_ESI + 4) + uVar3 * 2) = 0;
        return;
      }
      *(undefined2 *)(unaff_ESI + 4 + uVar3 * 2) = 0;
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00407a10 : PUSH EBP
00407a11 : MOV EBP,ESP
00407a13 : MOV ECX,dword ptr [EBP + 0xc]
00407a16 : SUB ESP,0xc
00407a19 : PUSH EBX
00407a1a : TEST ECX,ECX
00407a1c : JZ 0x00407a6c
00407a1e : MOV EBX,dword ptr [ESI + 0x18]
00407a21 : LEA EAX,[ESI + 0x4]
00407a24 : CMP EBX,0x8
00407a27 : JC 0x00407a2d
00407a29 : MOV EDX,dword ptr [EAX]
00407a2b : JMP 0x00407a2f
00407a2d : MOV EDX,EAX
00407a2f : CMP ECX,EDX
00407a31 : JC 0x00407a6c
00407a33 : CMP EBX,0x8
00407a36 : JC 0x00407a3c
00407a38 : MOV EDX,dword ptr [EAX]
00407a3a : JMP 0x00407a3e
00407a3c : MOV EDX,EAX
00407a3e : MOV EBX,dword ptr [ESI + 0x14]
00407a41 : LEA EDX,[EDX + EBX*0x2]
00407a44 : CMP EDX,ECX
00407a46 : JBE 0x00407a6c
00407a48 : CMP dword ptr [ESI + 0x18],0x8
00407a4c : JC 0x00407a50
00407a4e : MOV EAX,dword ptr [EAX]
00407a50 : SUB ECX,EAX
00407a52 : MOV EAX,dword ptr [EBP + 0x8]
00407a55 : SAR ECX,0x1
00407a57 : PUSH ECX
00407a58 : PUSH ESI
00407a59 : PUSH EAX
00407a5a : MOV EAX,dword ptr [EBP + 0x10]
00407a5d : PUSH ESI
00407a5e : MOV ECX,EDI
00407a60 : CALL 0x00408540
00407a65 : POP EBX
00407a66 : MOV ESP,EBP
00407a68 : POP EBP
00407a69 : RET 0xc
00407a6c : CMP dword ptr [ESI + 0x14],EDI
00407a6f : JNC 0x00407a76
00407a71 : CALL 0x00622f07
00407a76 : MOV EAX,dword ptr [ESI + 0x14]
00407a79 : MOV EBX,dword ptr [EBP + 0x8]
00407a7c : MOV ECX,EAX
00407a7e : SUB ECX,EDI
00407a80 : CMP ECX,EBX
00407a82 : JNC 0x00407a89
00407a84 : MOV dword ptr [EBP + 0x8],ECX
00407a87 : MOV EBX,ECX
00407a89 : OR ECX,0xffffffff
00407a8c : SUB ECX,dword ptr [EBP + 0x10]
00407a8f : SUB EAX,EBX
00407a91 : CMP ECX,EAX
00407a93 : JA 0x00407a9a
00407a95 : CALL 0x00622ecf
00407a9a : MOV ECX,dword ptr [ESI + 0x14]
00407a9d : SUB ECX,EDI
00407a9f : SUB ECX,EBX
00407aa1 : MOV dword ptr [EBP + -0xc],ECX
00407aa4 : CMP dword ptr [EBP + 0x10],EBX
00407aa7 : JNC 0x00407af5
00407aa9 : MOV EAX,dword ptr [ESI + 0x18]
00407aac : CMP EAX,0x8
00407aaf : JC 0x00407ab6
00407ab1 : MOV EDX,dword ptr [ESI + 0x4]
00407ab4 : JMP 0x00407ab9
00407ab6 : LEA EDX,[ESI + 0x4]
00407ab9 : MOV dword ptr [EBP + -0x4],EDX
00407abc : CMP EAX,0x8
00407abf : JC 0x00407ac6
00407ac1 : MOV EDX,dword ptr [ESI + 0x4]
00407ac4 : JMP 0x00407ac9
00407ac6 : LEA EDX,[ESI + 0x4]
00407ac9 : ADD ECX,ECX
00407acb : PUSH ECX
00407acc : MOV ECX,dword ptr [EBP + -0x4]
00407acf : MOV dword ptr [EBP + -0x8],EDX
00407ad2 : LEA EDX,[EDI + EBX*0x1]
00407ad5 : LEA EDX,[ECX + EDX*0x2]
00407ad8 : MOV ECX,dword ptr [EBP + 0x10]
00407adb : SUB EAX,EDI
00407add : SUB EAX,ECX
00407adf : PUSH EDX
00407ae0 : ADD EAX,EAX
00407ae2 : PUSH EAX
00407ae3 : LEA EAX,[EDI + ECX*0x1]
00407ae6 : MOV ECX,dword ptr [EBP + -0x8]
00407ae9 : LEA EDX,[ECX + EAX*0x2]
00407aec : PUSH EDX
00407aed : CALL 0x00634101
00407af2 : ADD ESP,0x10
00407af5 : CMP dword ptr [EBP + 0x10],0x0
00407af9 : JA 0x00407b03
00407afb : TEST EBX,EBX
00407afd : JBE 0x00407bfb
00407b03 : MOV EBX,dword ptr [ESI + 0x14]
00407b06 : SUB EBX,dword ptr [EBP + 0x8]
00407b09 : ADD EBX,dword ptr [EBP + 0x10]
00407b0c : CMP EBX,0x7ffffffe
00407b12 : JBE 0x00407b19
00407b14 : CALL 0x00622ecf
00407b19 : MOV EAX,dword ptr [ESI + 0x18]
00407b1c : CMP EAX,EBX
00407b1e : JNC 0x00407b4b
00407b20 : MOV EAX,dword ptr [ESI + 0x14]
00407b23 : PUSH EAX
00407b24 : PUSH EBX
00407b25 : MOV ECX,ESI
00407b27 : CALL 0x00406170
00407b2c : TEST EBX,EBX
00407b2e : JBE 0x00407bfb
00407b34 : MOV EDX,dword ptr [EBP + 0x10]
00407b37 : CMP dword ptr [EBP + 0x8],EDX
00407b3a : JNC 0x00407bac
00407b3c : MOV EAX,dword ptr [ESI + 0x18]
00407b3f : LEA ECX,[ESI + 0x4]
00407b42 : CMP EAX,0x8
00407b45 : JC 0x00407b79
00407b47 : MOV EDX,dword ptr [ECX]
00407b49 : JMP 0x00407b7b
00407b4b : TEST EBX,EBX
00407b4d : JNZ 0x00407b2e
00407b4f : MOV dword ptr [ESI + 0x14],EBX
00407b52 : CMP EAX,0x8
00407b55 : JC 0x00407b68
00407b57 : MOV EAX,dword ptr [ESI + 0x4]
00407b5a : XOR ECX,ECX
00407b5c : MOV word ptr [EAX],CX
00407b5f : MOV EAX,ESI
00407b61 : POP EBX
00407b62 : MOV ESP,EBP
00407b64 : POP EBP
00407b65 : RET 0xc
00407b68 : LEA EAX,[ESI + 0x4]
00407b6b : XOR ECX,ECX
00407b6d : MOV word ptr [EAX],CX
00407b70 : MOV EAX,ESI
00407b72 : POP EBX
00407b73 : MOV ESP,EBP
00407b75 : POP EBP
00407b76 : RET 0xc
00407b79 : MOV EDX,ECX
00407b7b : CMP EAX,0x8
00407b7e : JC 0x00407b82
00407b80 : MOV ECX,dword ptr [ECX]
00407b82 : MOV dword ptr [EBP + -0x8],ECX
00407b85 : MOV ECX,dword ptr [EBP + -0xc]
00407b88 : PUSH ECX
00407b89 : MOV ECX,dword ptr [EBP + 0x8]
00407b8c : ADD ECX,EDI
00407b8e : LEA EDX,[EDX + ECX*0x2]
00407b91 : MOV ECX,dword ptr [EBP + 0x10]
00407b94 : SUB EAX,EDI
00407b96 : PUSH EDX
00407b97 : SUB EAX,ECX
00407b99 : PUSH EAX
00407b9a : LEA EAX,[EDI + ECX*0x1]
00407b9d : MOV ECX,dword ptr [EBP + -0x8]
00407ba0 : LEA EDX,[ECX + EAX*0x2]
00407ba3 : PUSH EDX
00407ba4 : CALL 0x00405de0
00407ba9 : ADD ESP,0x10
00407bac : MOV EAX,dword ptr [ESI + 0x18]
00407baf : CMP EAX,0x8
00407bb2 : JC 0x00407bb9
00407bb4 : MOV ECX,dword ptr [ESI + 0x4]
00407bb7 : JMP 0x00407bbc
00407bb9 : LEA ECX,[ESI + 0x4]
00407bbc : MOV EDX,dword ptr [EBP + 0x10]
00407bbf : ADD EDX,EDX
00407bc1 : PUSH EDX
00407bc2 : MOV EDX,dword ptr [EBP + 0xc]
00407bc5 : SUB EAX,EDI
00407bc7 : PUSH EDX
00407bc8 : ADD EAX,EAX
00407bca : PUSH EAX
00407bcb : LEA EAX,[ECX + EDI*0x2]
00407bce : PUSH EAX
00407bcf : CALL 0x00633ea4
00407bd4 : ADD ESP,0x10
00407bd7 : CMP dword ptr [ESI + 0x18],0x8
00407bdb : MOV dword ptr [ESI + 0x14],EBX
00407bde : JC 0x00407bf2
00407be0 : MOV EAX,dword ptr [ESI + 0x4]
00407be3 : XOR ECX,ECX
00407be5 : MOV word ptr [EAX + EBX*0x2],CX
00407be9 : MOV EAX,ESI
00407beb : POP EBX
00407bec : MOV ESP,EBP
00407bee : POP EBP
00407bef : RET 0xc
00407bf2 : LEA EAX,[ESI + 0x4]
00407bf5 : XOR ECX,ECX
00407bf7 : MOV word ptr [EAX + EBX*0x2],CX
00407bfb : MOV EAX,ESI
00407bfd : POP EBX
00407bfe : MOV ESP,EBP
00407c00 : POP EBP
00407c01 : RET 0xc

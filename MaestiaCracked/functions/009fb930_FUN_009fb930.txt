PROGRAM  : Maestia.exe
FUNCTION : FUN_009fb930
ENTRY    : 009fb930
BODY     : [[009fb930, 009fbbbc] [009fbbc0, 009fbf7e]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009fb930(void)

{
  uint uVar1;
  char cVar2;
  undefined4 uVar3;
  int iVar4;
  int iVar5;
  int *in_ECX;
  int *piVar6;
  short sVar7;
  uint uVar8;
  int *piVar9;
  undefined1 local_54 [4];
  undefined2 local_50;
  undefined4 local_40;
  uint local_3c;
  undefined1 local_38 [4];
  undefined2 local_34;
  undefined4 local_24;
  uint local_20;
  uint local_1c;
  undefined4 local_18;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b5e42a;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_14 = in_ECX;
  cVar2 = (**(code **)(*in_ECX + 0xc))(DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
  if (cVar2 == '\0') {
    ExceptionList = local_10;
    return;
  }
  cVar2 = FUN_009f8bb0(in_ECX);
  iVar4 = DAT_0172491c;
  if (cVar2 == '\0') {
    FUN_00406460(L"IDS_MISMATCH_CHR_CLASS");
    local_8 = 0;
    piVar6 = *(int **)(*DAT_00da9894 + 0x1a8);
    uVar3 = FUN_0081d120(local_38);
    local_8._0_1_ = 1;
    (**(code **)(*piVar6 + 0x44))(uVar3,3);
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_3c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_3c = 7;
    local_40 = 0;
    local_50 = 0;
    local_8 = 0xffffffff;
    if (7 < local_20) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_20 = 7;
    local_24 = 0;
    local_34 = 0;
  }
  else {
    if (((DAT_0172491c != 0) && (*(int *)(DAT_0172491c + 0x17c) != 0)) &&
       (*(char *)(*(int *)(DAT_0172491c + 0x17c) + 0x1fdc) != '\0')) {
      FUN_008018d0(L"%d : [%s] Failed : Now weapon set swapping",0x46,L"AvaItemEquip::OnUse");
      ExceptionList = local_10;
      return;
    }
    if ((char)in_ECX[0xf] == '\0') {
      local_1c = FUN_004049b0(in_ECX[4]);
      if (local_1c == 0) {
        ExceptionList = local_10;
        return;
      }
      if (*(uint *)(*(int *)(iVar4 + 0x17c) + 0xa0) < (uint)*(byte *)(local_1c + 0x40)) {
        FUN_00406460(L"IDS_ITEM_NOT_ENOUGH_LEVEL");
        local_8 = 4;
        piVar6 = *(int **)(*DAT_00da9894 + 0x1a8);
        uVar3 = FUN_0081d120(local_54);
        local_8._0_1_ = 5;
        (**(code **)(*piVar6 + 0x44))(uVar3,3);
        local_8 = CONCAT31(local_8._1_3_,4);
      }
      else {
        if (in_ECX[10] == 0) {
          ExceptionList = local_10;
          return;
        }
        cVar2 = (**(code **)(*in_ECX + 0x7c))();
        if (cVar2 != '\0') {
          uVar8 = 0;
          while (cVar2 = FUN_009a08d0(uVar8), piVar6 = local_14, cVar2 == '\0') {
            uVar8 = uVar8 + 1;
            if (0x1d < (ushort)uVar8) {
              ExceptionList = local_10;
              return;
            }
          }
          local_18 = *(undefined4 *)(local_14[10] + 0x2c);
          sVar7 = (short)uVar8;
          if (sVar7 == 0) {
            iVar4 = FUN_004049b0(local_14[4]);
            if (((iVar4 != 0) && (*(char *)(iVar4 + 0x288) == '\x06')) &&
               (cVar2 = FUN_009a0860(), piVar6 = local_14, cVar2 != '\0')) {
              uVar8 = 1;
            }
          }
          else if ((sVar7 == 10) || (sVar7 == 6)) {
            iVar4 = *(int *)(*DAT_00da9894 + 0x130);
            if (iVar4 == 0) {
              ExceptionList = local_10;
              return;
            }
            if (*(int *)(iVar4 + 0x3c) == 0) {
              ExceptionList = local_10;
              return;
            }
            if (iVar4 == 0) {
              piVar6 = (int *)0x0;
            }
            else {
              piVar6 = *(int **)(iVar4 + 0x3c);
            }
            iVar4 = (**(code **)(*piVar6 + 0x98))(10);
            if (*(int *)(*DAT_00da9894 + 0x130) == 0) {
              piVar6 = (int *)0x0;
            }
            else {
              piVar6 = *(int **)(*(int *)(*DAT_00da9894 + 0x130) + 0x3c);
            }
            iVar5 = (**(code **)(*piVar6 + 0x98))(6);
            if ((iVar4 != 0) && (*(int *)(iVar4 + 8) == 0)) {
              uVar8 = 10;
            }
            piVar6 = local_14;
            if ((iVar5 != 0) && (*(int *)(iVar5 + 8) == 0)) {
              uVar8 = 6;
            }
          }
          else if ((ushort)(sVar7 - 0xeU) < 6) {
            iVar4 = FUN_00703c00(0x1602);
            if (((iVar4 != 0) &&
                (uVar1 = *(uint *)(*(int *)(DAT_0172491c + 0x17c) + 0xa0),
                uVar1 < *(uint *)(iVar4 + 0x10 + (uVar8 & 0xffff) * 4))) &&
               (*(uint *)(iVar4 + 0x48) <= uVar1)) {
              uVar8 = 0xe;
            }
          }
          else if ((((sVar7 == 0x1a) && (iVar4 = FUN_004049b0(local_14[4]), iVar4 != 0)) &&
                   (*(char *)(iVar4 + 0x288) == '\x06')) &&
                  (cVar2 = FUN_009a07f0(), piVar6 = local_14, cVar2 != '\0')) {
            uVar8 = 0x1b;
          }
          if ((*(uint *)(local_1c + 0x4c) & 0x800000) == 0) {
            if (((*(uint *)(local_1c + 0x48) & 0x1000) != 0) && ((piVar6[0x48] & 1U) == 0)) {
              FUN_00406460(L"IDS_BINDS_ON_EQUIP_DLGMSG");
              local_8 = 10;
              uVar3 = FUN_0081d120(local_54);
              local_8._0_1_ = 0xb;
              iVar4 = FUN_008ede80(uVar3,2);
              local_8 = CONCAT31(local_8._1_3_,10);
              FUN_00406560();
              local_8 = 0xffffffff;
              FUN_00406560();
              if (iVar4 == 0) {
                ExceptionList = local_10;
                return;
              }
              FUN_009a67d0((short)local_14[0xb],*(undefined2 *)((int)local_14 + 0x2e),0,uVar8,0);
              ExceptionList = local_10;
              return;
            }
            piVar9 = (int *)0x0;
            uVar3 = 0;
          }
          else {
            iVar4 = *DAT_00da9894;
            if (((*(int *)(iVar4 + 0x290) == 0) ||
                (piVar9 = *(int **)(iVar4 + 0x290), piVar9[0x1b] == 0)) ||
               (*(char *)((int)piVar9 + 0x32) == '\0')) {
              if (DAT_0172491c == 0) {
                ExceptionList = local_10;
                return;
              }
              if (iVar4 == 0) {
                ExceptionList = local_10;
                return;
              }
              if (*(int *)(iVar4 + 0x1a8) == 0) {
                ExceptionList = local_10;
                return;
              }
              FUN_00406460(L"IDS_ONLY_PET_ACC");
              local_8 = 8;
              piVar6 = *(int **)(*DAT_00da9894 + 0x1a8);
              uVar3 = FUN_0081d120(local_54);
              local_8._0_1_ = 9;
              (**(code **)(*piVar6 + 0x44))(uVar3,3);
              local_8 = CONCAT31(local_8._1_3_,8);
              FUN_00406560();
              local_8 = 0xffffffff;
              FUN_00406560();
              ExceptionList = local_10;
              return;
            }
            local_1c = 0;
            local_14 = (int *)0x0;
            iVar4 = (**(code **)(*piVar9 + 0xa0))(piVar9[0x1b],&local_1c,&local_14);
            if (iVar4 == 0) {
              ExceptionList = local_10;
              return;
            }
            piVar9 = local_14 + 0xf;
            uVar3 = 0xd1;
            uVar8 = local_1c;
          }
          FUN_008efa90(local_18,(short)piVar6[0xb],*(undefined2 *)((int)piVar6 + 0x2e),uVar3,uVar8,
                       piVar9);
          ExceptionList = local_10;
          return;
        }
        FUN_00406460(L"IDS_MISMATCH_CHR_CLASS");
        local_8 = 6;
        piVar6 = *(int **)(*DAT_00da9894 + 0x1a8);
        uVar3 = FUN_0081d120(local_54);
        local_8._0_1_ = 7;
        (**(code **)(*piVar6 + 0x44))(uVar3,3);
        local_8 = CONCAT31(local_8._1_3_,6);
      }
    }
    else {
      FUN_00406460(L"IDS_ITEMEQUIP_CANTEQUIP_USINGITEM");
      local_8 = 2;
      piVar6 = *(int **)(*DAT_00da9894 + 0x1a8);
      uVar3 = FUN_0081d120(local_54);
      local_8._0_1_ = 3;
      (**(code **)(*piVar6 + 0x44))(uVar3,3);
      local_8 = CONCAT31(local_8._1_3_,2);
    }
    FUN_00406560();
    local_8 = 0xffffffff;
    FUN_00406560();
  }
  FUN_008a1050(0xca);
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
009fb930 : PUSH EBP
009fb931 : MOV EBP,ESP
009fb933 : PUSH -0x1
009fb935 : PUSH 0xb5e42a
009fb93a : MOV EAX,FS:[0x0]
009fb940 : PUSH EAX
009fb941 : SUB ESP,0x44
009fb944 : PUSH EBX
009fb945 : PUSH ESI
009fb946 : PUSH EDI
009fb947 : MOV EAX,[0x00d66fa0]
009fb94c : XOR EAX,EBP
009fb94e : PUSH EAX
009fb94f : LEA EAX,[EBP + -0xc]
009fb952 : MOV FS:[0x0],EAX
009fb958 : MOV EDI,ECX
009fb95a : MOV dword ptr [EBP + -0x10],EDI
009fb95d : MOV EAX,dword ptr [EDI]
009fb95f : MOV EDX,dword ptr [EAX + 0xc]
009fb962 : CALL EDX
009fb964 : TEST AL,AL
009fb966 : JZ 0x009fbf6d
009fb96c : PUSH EDI
009fb96d : CALL 0x009f8bb0
009fb972 : TEST AL,AL
009fb974 : JNZ 0x009fba0b
009fb97a : PUSH 0xca5cf0
009fb97f : LEA ECX,[EBP + -0x34]
009fb982 : CALL 0x00406460
009fb987 : MOV dword ptr [EBP + -0x4],0x0
009fb98e : MOV EAX,[0x00da9894]
009fb993 : MOV EAX,dword ptr [EAX]
009fb995 : MOV ESI,dword ptr [EAX + 0x1a8]
009fb99b : LEA ECX,[EBP + -0x34]
009fb99e : PUSH ECX
009fb99f : MOV ECX,dword ptr [0x0172491c]
009fb9a5 : LEA EDI,[EBP + -0x50]
009fb9a8 : CALL 0x0081d120
009fb9ad : MOV byte ptr [EBP + -0x4],0x1
009fb9b1 : MOV EDX,dword ptr [ESI]
009fb9b3 : PUSH 0x3
009fb9b5 : PUSH EAX
009fb9b6 : MOV EAX,dword ptr [EDX + 0x44]
009fb9b9 : MOV ECX,ESI
009fb9bb : CALL EAX
009fb9bd : MOV byte ptr [EBP + -0x4],0x0
009fb9c1 : MOV EBX,0x8
009fb9c6 : CMP dword ptr [EBP + -0x38],EBX
009fb9c9 : JC 0x009fb9d3
009fb9cb : MOV ECX,dword ptr [EBP + -0x4c]
009fb9ce : CALL 0x006f04e0
009fb9d3 : MOV EDI,0x7
009fb9d8 : XOR ESI,ESI
009fb9da : XOR ECX,ECX
009fb9dc : MOV dword ptr [EBP + -0x38],EDI
009fb9df : MOV dword ptr [EBP + -0x3c],ESI
009fb9e2 : MOV word ptr [EBP + -0x4c],CX
009fb9e6 : MOV dword ptr [EBP + -0x4],0xffffffff
009fb9ed : CMP dword ptr [EBP + -0x1c],EBX
009fb9f0 : JC 0x009fb9fa
009fb9f2 : MOV ECX,dword ptr [EBP + -0x30]
009fb9f5 : CALL 0x006f04e0
009fb9fa : XOR EDX,EDX
009fb9fc : MOV dword ptr [EBP + -0x1c],EDI
009fb9ff : MOV dword ptr [EBP + -0x20],ESI
009fba02 : MOV word ptr [EBP + -0x30],DX
009fba06 : JMP 0x009fbb97
009fba0b : MOV ESI,dword ptr [0x0172491c]
009fba11 : TEST ESI,ESI
009fba13 : JZ 0x009fba54
009fba15 : MOV EAX,dword ptr [ESI + 0x17c]
009fba1b : TEST EAX,EAX
009fba1d : JZ 0x009fba54
009fba1f : CMP byte ptr [EAX + 0x1fdc],0x0
009fba26 : JZ 0x009fba54
009fba28 : MOV ESI,dword ptr [0x00da98e8]
009fba2e : PUSH 0xca5d20
009fba33 : PUSH 0x46
009fba35 : PUSH 0xca5d48
009fba3a : CALL 0x008018d0
009fba3f : ADD ESP,0xc
009fba42 : MOV ECX,dword ptr [EBP + -0xc]
009fba45 : MOV dword ptr FS:[0x0],ECX
009fba4c : POP ECX
009fba4d : POP EDI
009fba4e : POP ESI
009fba4f : POP EBX
009fba50 : MOV ESP,EBP
009fba52 : POP EBP
009fba53 : RET
009fba54 : CMP byte ptr [EDI + 0x3c],0x0
009fba58 : JZ 0x009fbaa6
009fba5a : PUSH 0xca5da0
009fba5f : LEA ECX,[EBP + -0x50]
009fba62 : CALL 0x00406460
009fba67 : MOV EBX,0x2
009fba6c : MOV dword ptr [EBP + -0x4],EBX
009fba6f : MOV EAX,[0x00da9894]
009fba74 : MOV EAX,dword ptr [EAX]
009fba76 : MOV ESI,dword ptr [EAX + 0x1a8]
009fba7c : LEA ECX,[EBP + -0x50]
009fba7f : PUSH ECX
009fba80 : MOV ECX,dword ptr [0x0172491c]
009fba86 : LEA EDI,[EBP + -0x34]
009fba89 : CALL 0x0081d120
009fba8e : MOV byte ptr [EBP + -0x4],0x3
009fba92 : MOV EDX,dword ptr [ESI]
009fba94 : PUSH 0x3
009fba96 : PUSH EAX
009fba97 : MOV EAX,dword ptr [EDX + 0x44]
009fba9a : MOV ECX,ESI
009fba9c : CALL EAX
009fba9e : MOV byte ptr [EBP + -0x4],BL
009fbaa1 : JMP 0x009fbb80
009fbaa6 : MOV EAX,dword ptr [EDI + 0x10]
009fbaa9 : PUSH EAX
009fbaaa : CALL 0x004049b0
009fbaaf : MOV ECX,EAX
009fbab1 : ADD ESP,0x4
009fbab4 : MOV dword ptr [EBP + -0x18],ECX
009fbab7 : TEST ECX,ECX
009fbab9 : JZ 0x009fbf6d
009fbabf : MOV EAX,dword ptr [ESI + 0x17c]
009fbac5 : MOVZX ECX,byte ptr [ECX + 0x40]
009fbac9 : MOV EAX,dword ptr [EAX + 0xa0]
009fbacf : CMP ECX,EAX
009fbad1 : JBE 0x009fbb1d
009fbad3 : PUSH 0xca5de4
009fbad8 : LEA ECX,[EBP + -0x50]
009fbadb : CALL 0x00406460
009fbae0 : MOV EBX,0x4
009fbae5 : MOV dword ptr [EBP + -0x4],EBX
009fbae8 : MOV EDX,dword ptr [0x00da9894]
009fbaee : MOV EAX,dword ptr [EDX]
009fbaf0 : MOV ESI,dword ptr [EAX + 0x1a8]
009fbaf6 : MOV ECX,dword ptr [0x0172491c]
009fbafc : LEA EAX,[EBP + -0x50]
009fbaff : PUSH EAX
009fbb00 : LEA EDI,[EBP + -0x34]
009fbb03 : CALL 0x0081d120
009fbb08 : MOV byte ptr [EBP + -0x4],0x5
009fbb0c : MOV EDX,dword ptr [ESI]
009fbb0e : PUSH 0x3
009fbb10 : PUSH EAX
009fbb11 : MOV EAX,dword ptr [EDX + 0x44]
009fbb14 : MOV ECX,ESI
009fbb16 : CALL EAX
009fbb18 : MOV byte ptr [EBP + -0x4],BL
009fbb1b : JMP 0x009fbb80
009fbb1d : CMP dword ptr [EDI + 0x28],0x0
009fbb21 : JZ 0x009fbf6d
009fbb27 : MOV EDX,dword ptr [EDI]
009fbb29 : MOV EAX,dword ptr [EDX + 0x7c]
009fbb2c : MOV ECX,EDI
009fbb2e : CALL EAX
009fbb30 : TEST AL,AL
009fbb32 : JNZ 0x009fbbb9
009fbb38 : PUSH 0xca5e18
009fbb3d : LEA ECX,[EBP + -0x50]
009fbb40 : CALL 0x00406460
009fbb45 : MOV dword ptr [EBP + -0x4],0x6
009fbb4c : MOV ECX,dword ptr [0x00da9894]
009fbb52 : MOV EAX,dword ptr [ECX]
009fbb54 : MOV ECX,dword ptr [0x0172491c]
009fbb5a : MOV ESI,dword ptr [EAX + 0x1a8]
009fbb60 : LEA EDX,[EBP + -0x50]
009fbb63 : PUSH EDX
009fbb64 : LEA EDI,[EBP + -0x34]
009fbb67 : CALL 0x0081d120
009fbb6c : MOV byte ptr [EBP + -0x4],0x7
009fbb70 : MOV EDX,dword ptr [ESI]
009fbb72 : PUSH 0x3
009fbb74 : PUSH EAX
009fbb75 : MOV EAX,dword ptr [EDX + 0x44]
009fbb78 : MOV ECX,ESI
009fbb7a : CALL EAX
009fbb7c : MOV byte ptr [EBP + -0x4],0x6
009fbb80 : LEA ECX,[EBP + -0x34]
009fbb83 : CALL 0x00406560
009fbb88 : MOV dword ptr [EBP + -0x4],0xffffffff
009fbb8f : LEA ECX,[EBP + -0x50]
009fbb92 : CALL 0x00406560
009fbb97 : MOV ECX,dword ptr [0x017248dc]
009fbb9d : PUSH 0xca
009fbba2 : CALL 0x008a1050
009fbba7 : MOV ECX,dword ptr [EBP + -0xc]
009fbbaa : MOV dword ptr FS:[0x0],ECX
009fbbb1 : POP ECX
009fbbb2 : POP EDI
009fbbb3 : POP ESI
009fbbb4 : POP EBX
009fbbb5 : MOV ESP,EBP
009fbbb7 : POP EBP
009fbbb8 : RET
009fbbb9 : XOR EBX,EBX
009fbbbb : JMP 0x009fbbc3
009fbbc0 : MOV EDI,dword ptr [EBP + -0x10]
009fbbc3 : MOV ECX,dword ptr [0x00da9894]
009fbbc9 : MOV ECX,dword ptr [ECX]
009fbbcb : MOV ECX,dword ptr [ECX + 0x130]
009fbbd1 : MOV EAX,dword ptr [EDI + 0x10]
009fbbd4 : TEST ECX,ECX
009fbbd6 : JZ 0x009fbbdb
009fbbd8 : MOV ECX,dword ptr [ECX + 0x3c]
009fbbdb : PUSH EBX
009fbbdc : MOV EDI,ECX
009fbbde : CALL 0x009a08d0
009fbbe3 : TEST AL,AL
009fbbe5 : JNZ 0x009fbc00
009fbbe7 : INC EBX
009fbbe8 : CMP BX,0x1e
009fbbec : JC 0x009fbbc0
009fbbee : MOV ECX,dword ptr [EBP + -0xc]
009fbbf1 : MOV dword ptr FS:[0x0],ECX
009fbbf8 : POP ECX
009fbbf9 : POP EDI
009fbbfa : POP ESI
009fbbfb : POP EBX
009fbbfc : MOV ESP,EBP
009fbbfe : POP EBP
009fbbff : RET
009fbc00 : MOV ESI,dword ptr [EBP + -0x10]
009fbc03 : MOV EDX,dword ptr [ESI + 0x28]
009fbc06 : MOV EAX,dword ptr [EDX + 0x2c]
009fbc09 : MOV dword ptr [EBP + -0x14],EAX
009fbc0c : TEST BX,BX
009fbc0f : JNZ 0x009fbc63
009fbc11 : MOV EAX,dword ptr [ESI + 0x10]
009fbc14 : PUSH EAX
009fbc15 : CALL 0x004049b0
009fbc1a : ADD ESP,0x4
009fbc1d : TEST EAX,EAX
009fbc1f : JZ 0x009fbda5
009fbc25 : CMP byte ptr [EAX + 0x288],0x6
009fbc2c : JNZ 0x009fbda5
009fbc32 : MOV ECX,dword ptr [0x00da9894]
009fbc38 : MOV EAX,dword ptr [ECX]
009fbc3a : MOV EAX,dword ptr [EAX + 0x130]
009fbc40 : TEST EAX,EAX
009fbc42 : JZ 0x009fbc47
009fbc44 : MOV EAX,dword ptr [EAX + 0x3c]
009fbc47 : MOV ESI,EAX
009fbc49 : CALL 0x009a0860
009fbc4e : MOV ESI,dword ptr [EBP + -0x10]
009fbc51 : TEST AL,AL
009fbc53 : JZ 0x009fbda5
009fbc59 : MOV EBX,0x1
009fbc5e : JMP 0x009fbda5
009fbc63 : CMP BX,0xa
009fbc67 : JZ 0x009fbd27
009fbc6d : CMP BX,0x6
009fbc71 : JZ 0x009fbd27
009fbc77 : LEA EDX,[EBX + -0xe]
009fbc7a : CMP DX,0x5
009fbc7e : JA 0x009fbcce
009fbc80 : PUSH 0x1602
009fbc85 : MOV EDI,0x271b
009fbc8a : CALL 0x00703c00
009fbc8f : ADD ESP,0x4
009fbc92 : TEST EAX,EAX
009fbc94 : JZ 0x009fbda5
009fbc9a : MOV ECX,dword ptr [0x0172491c]
009fbca0 : MOV ECX,dword ptr [ECX + 0x17c]
009fbca6 : MOV EDX,dword ptr [ECX + 0xa0]
009fbcac : MOVZX EDI,BX
009fbcaf : CMP dword ptr [EAX + EDI*0x4 + 0x10],EDX
009fbcb3 : JBE 0x009fbda5
009fbcb9 : MOV ECX,EDX
009fbcbb : CMP dword ptr [EAX + 0x48],ECX
009fbcbe : JA 0x009fbda5
009fbcc4 : MOV EBX,0xe
009fbcc9 : JMP 0x009fbda5
009fbcce : CMP BX,0x1a
009fbcd2 : JNZ 0x009fbda5
009fbcd8 : MOV EAX,dword ptr [ESI + 0x10]
009fbcdb : PUSH EAX
009fbcdc : CALL 0x004049b0
009fbce1 : ADD ESP,0x4
009fbce4 : TEST EAX,EAX
009fbce6 : JZ 0x009fbda5
009fbcec : CMP byte ptr [EAX + 0x288],0x6
009fbcf3 : JNZ 0x009fbda5
009fbcf9 : MOV EDX,dword ptr [0x00da9894]
009fbcff : MOV EAX,dword ptr [EDX]
009fbd01 : MOV EAX,dword ptr [EAX + 0x130]
009fbd07 : TEST EAX,EAX
009fbd09 : JZ 0x009fbd0e
009fbd0b : MOV EAX,dword ptr [EAX + 0x3c]
009fbd0e : MOV ESI,EAX
009fbd10 : CALL 0x009a07f0
009fbd15 : MOV ESI,dword ptr [EBP + -0x10]
009fbd18 : TEST AL,AL
009fbd1a : JZ 0x009fbda5
009fbd20 : MOV EBX,0x1b
009fbd25 : JMP 0x009fbda5
009fbd27 : MOV EAX,[0x00da9894]
009fbd2c : MOV ECX,dword ptr [EAX]
009fbd2e : MOV EAX,dword ptr [ECX + 0x130]
009fbd34 : TEST EAX,EAX
009fbd36 : JZ 0x009fbf6d
009fbd3c : CMP dword ptr [EAX + 0x3c],0x0
009fbd40 : JZ 0x009fbf6d
009fbd46 : TEST EAX,EAX
009fbd48 : JNZ 0x009fbd4e
009fbd4a : XOR ECX,ECX
009fbd4c : JMP 0x009fbd51
009fbd4e : MOV ECX,dword ptr [EAX + 0x3c]
009fbd51 : MOV EDX,dword ptr [ECX]
009fbd53 : MOV EAX,dword ptr [EDX + 0x98]
009fbd59 : PUSH 0xa
009fbd5b : CALL EAX
009fbd5d : MOV ECX,dword ptr [0x00da9894]
009fbd63 : MOV ESI,EAX
009fbd65 : MOV EAX,dword ptr [ECX]
009fbd67 : MOV EAX,dword ptr [EAX + 0x130]
009fbd6d : TEST EAX,EAX
009fbd6f : JNZ 0x009fbd75
009fbd71 : XOR ECX,ECX
009fbd73 : JMP 0x009fbd78
009fbd75 : MOV ECX,dword ptr [EAX + 0x3c]
009fbd78 : MOV EDX,dword ptr [ECX]
009fbd7a : MOV EAX,dword ptr [EDX + 0x98]
009fbd80 : PUSH 0x6
009fbd82 : CALL EAX
009fbd84 : TEST ESI,ESI
009fbd86 : JZ 0x009fbd93
009fbd88 : CMP dword ptr [ESI + 0x8],0x0
009fbd8c : JNZ 0x009fbd93
009fbd8e : MOV EBX,0xa
009fbd93 : TEST EAX,EAX
009fbd95 : JZ 0x009fbda2
009fbd97 : CMP dword ptr [EAX + 0x8],0x0
009fbd9b : JNZ 0x009fbda2
009fbd9d : MOV EBX,0x6
009fbda2 : MOV ESI,dword ptr [EBP + -0x10]
009fbda5 : MOV EAX,dword ptr [EBP + -0x18]
009fbda8 : MOV EDX,dword ptr [EAX + 0x48]
009fbdab : MOV EAX,dword ptr [EAX + 0x4c]
009fbdae : AND EAX,0x800000
009fbdb3 : XOR ECX,ECX
009fbdb5 : XOR EDI,EDI
009fbdb7 : OR ECX,EAX
009fbdb9 : JZ 0x009fbeac
009fbdbf : MOV ECX,dword ptr [0x00da9894]
009fbdc5 : MOV EAX,dword ptr [ECX]
009fbdc7 : CMP dword ptr [EAX + 0x290],EDI
009fbdcd : JZ 0x009fbe1d
009fbdcf : MOV ECX,dword ptr [EAX + 0x290]
009fbdd5 : CMP dword ptr [ECX + 0x6c],EDI
009fbdd8 : JZ 0x009fbe1d
009fbdda : CMP byte ptr [ECX + 0x32],0x0
009fbdde : JZ 0x009fbe1d
009fbde0 : MOV dword ptr [EBP + -0x18],EDI
009fbde3 : MOV dword ptr [EBP + -0x10],EDI
009fbde6 : MOV EAX,ECX
009fbde8 : MOV ECX,dword ptr [EAX + 0x6c]
009fbdeb : MOV EDX,dword ptr [EAX]
009fbded : LEA EDI,[EBP + -0x10]
009fbdf0 : PUSH EDI
009fbdf1 : LEA EDI,[EBP + -0x18]
009fbdf4 : PUSH EDI
009fbdf5 : PUSH ECX
009fbdf6 : MOV ECX,EAX
009fbdf8 : MOV EAX,dword ptr [EDX + 0xa0]
009fbdfe : CALL EAX
009fbe00 : TEST EAX,EAX
009fbe02 : JZ 0x009fbf6d
009fbe08 : MOV ECX,dword ptr [EBP + -0x10]
009fbe0b : MOV EDX,dword ptr [EBP + -0x18]
009fbe0e : ADD ECX,0x3c
009fbe11 : PUSH ECX
009fbe12 : PUSH EDX
009fbe13 : PUSH 0xd1
009fbe18 : JMP 0x009fbf57
009fbe1d : CMP dword ptr [0x0172491c],EDI
009fbe23 : JZ 0x009fbf6d
009fbe29 : CMP EAX,EDI
009fbe2b : JZ 0x009fbf6d
009fbe31 : CMP dword ptr [EAX + 0x1a8],EDI
009fbe37 : JZ 0x009fbf6d
009fbe3d : PUSH 0xca5e48
009fbe42 : LEA ECX,[EBP + -0x50]
009fbe45 : CALL 0x00406460
009fbe4a : MOV EBX,0x8
009fbe4f : MOV dword ptr [EBP + -0x4],EBX
009fbe52 : MOV EAX,[0x00da9894]
009fbe57 : MOV EAX,dword ptr [EAX]
009fbe59 : MOV ESI,dword ptr [EAX + 0x1a8]
009fbe5f : LEA ECX,[EBP + -0x50]
009fbe62 : PUSH ECX
009fbe63 : MOV ECX,dword ptr [0x0172491c]
009fbe69 : LEA EDI,[EBP + -0x34]
009fbe6c : CALL 0x0081d120
009fbe71 : MOV byte ptr [EBP + -0x4],0x9
009fbe75 : MOV EDX,dword ptr [ESI]
009fbe77 : PUSH 0x3
009fbe79 : PUSH EAX
009fbe7a : MOV EAX,dword ptr [EDX + 0x44]
009fbe7d : MOV ECX,ESI
009fbe7f : CALL EAX
009fbe81 : MOV byte ptr [EBP + -0x4],BL
009fbe84 : MOV ECX,EDI
009fbe86 : CALL 0x00406560
009fbe8b : MOV dword ptr [EBP + -0x4],0xffffffff
009fbe92 : LEA ECX,[EBP + -0x50]
009fbe95 : CALL 0x00406560
009fbe9a : MOV ECX,dword ptr [EBP + -0xc]
009fbe9d : MOV dword ptr FS:[0x0],ECX
009fbea4 : POP ECX
009fbea5 : POP EDI
009fbea6 : POP ESI
009fbea7 : POP EBX
009fbea8 : MOV ESP,EBP
009fbeaa : POP EBP
009fbeab : RET
009fbeac : AND EDX,0x1000
009fbeb2 : XOR EAX,EAX
009fbeb4 : OR EDX,EAX
009fbeb6 : JZ 0x009fbf54
009fbebc : TEST dword ptr [ESI + 0x120],0x1
009fbec6 : JNZ 0x009fbf54
009fbecc : PUSH 0xca5e6c
009fbed1 : LEA ECX,[EBP + -0x50]
009fbed4 : CALL 0x00406460
009fbed9 : MOV dword ptr [EBP + -0x4],0xa
009fbee0 : LEA ECX,[EBP + -0x50]
009fbee3 : PUSH ECX
009fbee4 : MOV ECX,dword ptr [0x0172491c]
009fbeea : LEA EDI,[EBP + -0x34]
009fbeed : CALL 0x0081d120
009fbef2 : MOV byte ptr [EBP + -0x4],0xb
009fbef6 : MOV EDX,dword ptr [0x00da9894]
009fbefc : MOV ECX,dword ptr [EDX]
009fbefe : PUSH 0x2
009fbf00 : PUSH EAX
009fbf01 : CALL 0x008ede80
009fbf06 : MOV ESI,EAX
009fbf08 : MOV byte ptr [EBP + -0x4],0xa
009fbf0c : MOV ECX,EDI
009fbf0e : CALL 0x00406560
009fbf13 : MOV dword ptr [EBP + -0x4],0xffffffff
009fbf1a : LEA ECX,[EBP + -0x50]
009fbf1d : CALL 0x00406560
009fbf22 : TEST ESI,ESI
009fbf24 : JZ 0x009fbf6d
009fbf26 : MOV EAX,dword ptr [EBP + -0x10]
009fbf29 : MOVZX ECX,word ptr [EAX + 0x2e]
009fbf2d : MOVZX EDX,word ptr [EAX + 0x2c]
009fbf31 : PUSH 0x0
009fbf33 : PUSH EBX
009fbf34 : PUSH 0x0
009fbf36 : PUSH ECX
009fbf37 : MOV ECX,dword ptr [EBP + -0x14]
009fbf3a : PUSH EDX
009fbf3b : MOV EAX,ESI
009fbf3d : CALL 0x009a67d0
009fbf42 : MOV ECX,dword ptr [EBP + -0xc]
009fbf45 : MOV dword ptr FS:[0x0],ECX
009fbf4c : POP ECX
009fbf4d : POP EDI
009fbf4e : POP ESI
009fbf4f : POP EBX
009fbf50 : MOV ESP,EBP
009fbf52 : POP EBP
009fbf53 : RET
009fbf54 : PUSH EDI
009fbf55 : PUSH EBX
009fbf56 : PUSH EDI
009fbf57 : MOVZX EAX,word ptr [ESI + 0x2e]
009fbf5b : MOVZX ECX,word ptr [ESI + 0x2c]
009fbf5f : MOV EDX,dword ptr [EBP + -0x14]
009fbf62 : PUSH EAX
009fbf63 : PUSH ECX
009fbf64 : PUSH EDX
009fbf65 : CALL 0x008efa90
009fbf6a : ADD ESP,0x18
009fbf6d : MOV ECX,dword ptr [EBP + -0xc]
009fbf70 : MOV dword ptr FS:[0x0],ECX
009fbf77 : POP ECX
009fbf78 : POP EDI
009fbf79 : POP ESI
009fbf7a : POP EBX
009fbf7b : MOV ESP,EBP
009fbf7d : POP EBP
009fbf7e : RET

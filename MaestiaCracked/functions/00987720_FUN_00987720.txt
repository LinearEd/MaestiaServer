PROGRAM  : Maestia.exe
FUNCTION : FUN_00987720
ENTRY    : 00987720
BODY     : [[00987720, 009878ac]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00987720(void)

{
  int *piVar1;
  int iVar2;
  int *unaff_ESI;
  uint local_3c;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b38caa;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  piVar1 = (int *)FUN_008eb580();
  (**(code **)(*piVar1 + 0x74))();
  iVar2 = (**(code **)(*unaff_ESI + 0x74))();
  local_18 = 7;
  local_1c = 0;
  local_2c = 0;
  local_8 = 0;
  (**(code **)(*unaff_ESI + 0x58))();
  FUN_00405eb0(local_30,0,0xffffffff);
  local_8 = local_8 & 0xffffff00;
  FUN_008f75f0();
  local_8._0_1_ = 2;
  FUN_00405eb0();
  local_8 = (uint)local_8._1_3_ << 8;
  if (7 < local_3c) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  if (iVar2 == 0) {
    (**(code **)(*piVar1 + 0x78))();
  }
  else {
    (**(code **)(*piVar1 + 0x78))();
    (**(code **)(*unaff_ESI + 0x78))();
    FUN_00941640();
  }
  (**(code **)(*unaff_ESI + 0x70))();
  local_8 = 0xffffffff;
  if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_18 = 7;
  local_1c = 0;
  local_2c = 0;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00987720 : PUSH EBP
00987721 : MOV EBP,ESP
00987723 : PUSH -0x1
00987725 : PUSH 0xb38caa
0098772a : MOV EAX,FS:[0x0]
00987730 : PUSH EAX
00987731 : SUB ESP,0x44
00987734 : MOV EAX,[0x00d66fa0]
00987739 : XOR EAX,EBP
0098773b : MOV dword ptr [EBP + -0x10],EAX
0098773e : PUSH EBX
0098773f : PUSH EDI
00987740 : PUSH EAX
00987741 : LEA EAX,[EBP + -0xc]
00987744 : MOV FS:[0x0],EAX
0098774a : MOV EAX,dword ptr [ESI + 0x4]
0098774d : MOV EDI,ECX
0098774f : CALL 0x008eb580
00987754 : MOV ECX,dword ptr [EBP + 0xc]
00987757 : MOV EDX,dword ptr [EBP + 0x8]
0098775a : MOV EDI,EAX
0098775c : MOV EAX,dword ptr [EDI]
0098775e : MOV EAX,dword ptr [EAX + 0x74]
00987761 : PUSH ECX
00987762 : PUSH EDX
00987763 : MOV ECX,EDI
00987765 : CALL EAX
00987767 : MOV ECX,dword ptr [EBP + 0x10]
0098776a : MOV EDX,dword ptr [ESI]
0098776c : MOV EDX,dword ptr [EDX + 0x74]
0098776f : MOV EBX,EAX
00987771 : MOV EAX,dword ptr [EBP + 0x14]
00987774 : PUSH EAX
00987775 : PUSH ECX
00987776 : MOV ECX,ESI
00987778 : CALL EDX
0098777a : MOV dword ptr [EBP + -0x30],EAX
0098777d : MOV EAX,dword ptr [EBX + 0x10]
00987780 : XOR ECX,ECX
00987782 : XOR EDX,EDX
00987784 : MOV dword ptr [EBP + -0x14],0x7
0098778b : MOV dword ptr [EBP + -0x18],ECX
0098778e : MOV word ptr [EBP + -0x28],DX
00987792 : MOV dword ptr [EBP + -0x4],ECX
00987795 : MOV EDX,dword ptr [ESI]
00987797 : MOV EDX,dword ptr [EDX + 0x58]
0098779a : LEA ECX,[EBP + -0x2c]
0098779d : PUSH ECX
0098779e : PUSH EAX
0098779f : MOV ECX,ESI
009877a1 : CALL EDX
009877a3 : SUB ESP,0x1c
009877a6 : MOV ECX,ESP
009877a8 : MOV dword ptr [EBP + -0x34],ESP
009877ab : XOR EAX,EAX
009877ad : PUSH -0x1
009877af : PUSH EAX
009877b0 : LEA EDX,[EBP + -0x2c]
009877b3 : MOV dword ptr [ECX + 0x18],0x7
009877ba : MOV dword ptr [ECX + 0x14],0x0
009877c1 : PUSH EDX
009877c2 : MOV word ptr [ECX + 0x4],AX
009877c6 : CALL 0x00405eb0
009877cb : MOV byte ptr [EBP + -0x4],0x1
009877cf : MOV byte ptr [EBP + -0x4],0x0
009877d3 : LEA ECX,[EBP + -0x50]
009877d6 : CALL 0x008f75f0
009877db : ADD ESP,0x1c
009877de : MOV byte ptr [EBP + -0x4],0x2
009877e2 : PUSH -0x1
009877e4 : PUSH 0x0
009877e6 : PUSH EAX
009877e7 : LEA ECX,[EBP + -0x2c]
009877ea : CALL 0x00405eb0
009877ef : MOV byte ptr [EBP + -0x4],0x0
009877f3 : CMP dword ptr [EBP + -0x38],0x8
009877f7 : JC 0x00987801
009877f9 : MOV ECX,dword ptr [EBP + -0x4c]
009877fc : CALL 0x006f04e0
00987801 : MOV ECX,dword ptr [EBP + 0x8]
00987804 : MOV EDX,dword ptr [EDI]
00987806 : MOV EDX,dword ptr [EDX + 0x78]
00987809 : XOR EAX,EAX
0098780b : CMP dword ptr [EBP + -0x30],EAX
0098780e : MOV word ptr [EBP + -0x4c],AX
00987812 : MOV EAX,dword ptr [EBP + 0xc]
00987815 : PUSH EAX
00987816 : PUSH ECX
00987817 : MOV dword ptr [EBP + -0x38],0x7
0098781e : MOV dword ptr [EBP + -0x3c],0x0
00987825 : MOV ECX,EDI
00987827 : JNZ 0x0098782d
00987829 : CALL EDX
0098782b : JMP 0x00987855
0098782d : CALL EDX
0098782f : MOV ECX,dword ptr [EBP + 0x14]
00987832 : MOV EAX,dword ptr [ESI]
00987834 : MOV EDX,dword ptr [EBP + 0x10]
00987837 : MOV EAX,dword ptr [EAX + 0x78]
0098783a : PUSH ECX
0098783b : PUSH EDX
0098783c : MOV ECX,ESI
0098783e : CALL EAX
00987840 : MOV ECX,dword ptr [EBP + 0xc]
00987843 : MOV EDX,dword ptr [EBP + 0x8]
00987846 : PUSH 0x0
00987848 : PUSH 0x0
0098784a : PUSH ECX
0098784b : PUSH EDX
0098784c : PUSH EDI
0098784d : MOV EDI,dword ptr [EBP + -0x30]
00987850 : CALL 0x00941640
00987855 : MOV ECX,dword ptr [EBP + 0x14]
00987858 : MOV EDX,dword ptr [EBP + 0x10]
0098785b : MOV EAX,dword ptr [ESI]
0098785d : MOV EAX,dword ptr [EAX + 0x70]
00987860 : PUSH ECX
00987861 : PUSH EDX
00987862 : PUSH EBX
00987863 : MOV ECX,ESI
00987865 : CALL EAX
00987867 : MOV dword ptr [EBP + -0x4],0xffffffff
0098786e : CMP dword ptr [EBP + -0x14],0x8
00987872 : JC 0x0098787c
00987874 : MOV ECX,dword ptr [EBP + -0x28]
00987877 : CALL 0x006f04e0
0098787c : XOR ECX,ECX
0098787e : MOV dword ptr [EBP + -0x14],0x7
00987885 : MOV dword ptr [EBP + -0x18],0x0
0098788c : MOV word ptr [EBP + -0x28],CX
00987890 : MOV ECX,dword ptr [EBP + -0xc]
00987893 : MOV dword ptr FS:[0x0],ECX
0098789a : POP ECX
0098789b : POP EDI
0098789c : POP EBX
0098789d : MOV ECX,dword ptr [EBP + -0x10]
009878a0 : XOR ECX,EBP
009878a2 : CALL 0x00633e6b
009878a7 : MOV ESP,EBP
009878a9 : POP EBP
009878aa : RET 0x10

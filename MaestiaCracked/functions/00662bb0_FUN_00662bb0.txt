PROGRAM  : Maestia.exe
FUNCTION : FUN_00662bb0
ENTRY    : 00662bb0
BODY     : [[00662bb0, 00662c02]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00662bb0(int param_1,undefined4 *param_2)

{
  LPCRITICAL_SECTION lpCriticalSection;
  
  if (param_2 == (undefined4 *)0x0) {
    return 0x80004003;
  }
  if (param_1 == 0xc) {
    lpCriticalSection = (LPCRITICAL_SECTION)0x0;
  }
  else {
    lpCriticalSection = (LPCRITICAL_SECTION)(param_1 + 4);
  }
  EnterCriticalSection(lpCriticalSection);
  param_2[1] = *(undefined4 *)(param_1 + 0x34);
  *param_2 = *(undefined4 *)(param_1 + 0x2c);
  param_2[2] = *(undefined4 *)(param_1 + 0x38);
  param_2[3] = *(undefined4 *)(param_1 + 0x3c);
  LeaveCriticalSection(lpCriticalSection);
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00662bb0 : PUSH EDI
00662bb1 : MOV EDI,dword ptr [ESP + 0xc]
00662bb5 : TEST EDI,EDI
00662bb7 : JNZ 0x00662bc2
00662bb9 : MOV EAX,0x80004003
00662bbe : POP EDI
00662bbf : RET 0x8
00662bc2 : PUSH EBX
00662bc3 : PUSH ESI
00662bc4 : MOV ESI,dword ptr [ESP + 0x10]
00662bc8 : LEA EAX,[ESI + -0xc]
00662bcb : TEST EAX,EAX
00662bcd : JZ 0x00662bd4
00662bcf : LEA EBX,[ESI + 0x4]
00662bd2 : JMP 0x00662bd6
00662bd4 : XOR EBX,EBX
00662bd6 : PUSH EBX
00662bd7 : CALL dword ptr [0x00b85118]
00662bdd : MOV ECX,dword ptr [ESI + 0x34]
00662be0 : MOV dword ptr [EDI + 0x4],ECX
00662be3 : MOV EDX,dword ptr [ESI + 0x2c]
00662be6 : MOV dword ptr [EDI],EDX
00662be8 : MOV EAX,dword ptr [ESI + 0x38]
00662beb : MOV dword ptr [EDI + 0x8],EAX
00662bee : MOV ECX,dword ptr [ESI + 0x3c]
00662bf1 : PUSH EBX
00662bf2 : MOV dword ptr [EDI + 0xc],ECX
00662bf5 : CALL dword ptr [0x00b8511c]
00662bfb : POP ESI
00662bfc : POP EBX
00662bfd : XOR EAX,EAX
00662bff : POP EDI
00662c00 : RET 0x8

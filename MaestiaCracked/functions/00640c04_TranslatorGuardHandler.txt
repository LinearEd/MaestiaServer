PROGRAM  : Maestia.exe
FUNCTION : TranslatorGuardHandler
ENTRY    : 00640c04
BODY     : [[00640c04, 00640c33] [00640c36, 00640c9c] [00640ca0, 00640ca2]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    enum _EXCEPTION_DISPOSITION __cdecl TranslatorGuardHandler(struct EHExceptionRecord *,struct
   TranslatorGuardRN *,void *,void *)
   
   Libraries: Visual Studio 2005 Release, Visual Studio 2008 Release, Visual Studio 2010 Release */

_EXCEPTION_DISPOSITION __cdecl
TranslatorGuardHandler
          (EHExceptionRecord *param_1,TranslatorGuardRN *param_2,void *param_3,void *param_4)

{
  _EXCEPTION_DISPOSITION _Var1;
  code *local_8;
  
  __security_check_cookie(*(uint *)(param_2 + 8) ^ (uint)param_2);
  if ((*(uint *)(param_1 + 4) & 0x66) != 0) {
    *(undefined4 *)(param_2 + 0x24) = 1;
    return 1;
  }
  ___InternalCxxFrameHandler
            (param_1,*(undefined4 *)(param_2 + 0x10),param_3,0,*(undefined4 *)(param_2 + 0xc),
             *(undefined4 *)(param_2 + 0x14),*(undefined4 *)(param_2 + 0x18),1);
  if (*(int *)(param_2 + 0x24) == 0) {
    _UnwindNestedFrames((EHRegistrationNode *)param_2,param_1);
  }
  _CallSETranslator((EHExceptionRecord *)0x123,(EHRegistrationNode *)&local_8,(void *)0x0,
                    (void *)0x0,(_s_FuncInfo *)0x0,0,(EHRegistrationNode *)0x0);
                    /* WARNING: Could not recover jumptable at 0x00640c9b. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  _Var1 = (*local_8)();
  return _Var1;
}



============================================================
DISASSEMBLY
============================================================
00640c04 : MOV EDI,EDI
00640c06 : PUSH EBP
00640c07 : MOV EBP,ESP
00640c09 : PUSH ECX
00640c0a : PUSH EBX
00640c0b : CLD
00640c0c : MOV EAX,dword ptr [EBP + 0xc]
00640c0f : MOV ECX,dword ptr [EAX + 0x8]
00640c12 : XOR ECX,dword ptr [EBP + 0xc]
00640c15 : CALL 0x00633e6b
00640c1a : MOV EAX,dword ptr [EBP + 0x8]
00640c1d : MOV EAX,dword ptr [EAX + 0x4]
00640c20 : AND EAX,0x66
00640c23 : JZ 0x00640c36
00640c25 : MOV EAX,dword ptr [EBP + 0xc]
00640c28 : MOV dword ptr [EAX + 0x24],0x1
00640c2f : XOR EAX,EAX
00640c31 : INC EAX
00640c32 : JMP 0x00640ca0
00640c36 : PUSH 0x1
00640c38 : MOV EAX,dword ptr [EBP + 0xc]
00640c3b : PUSH dword ptr [EAX + 0x18]
00640c3e : MOV EAX,dword ptr [EBP + 0xc]
00640c41 : PUSH dword ptr [EAX + 0x14]
00640c44 : MOV EAX,dword ptr [EBP + 0xc]
00640c47 : PUSH dword ptr [EAX + 0xc]
00640c4a : PUSH 0x0
00640c4c : PUSH dword ptr [EBP + 0x10]
00640c4f : MOV EAX,dword ptr [EBP + 0xc]
00640c52 : PUSH dword ptr [EAX + 0x10]
00640c55 : PUSH dword ptr [EBP + 0x8]
00640c58 : CALL 0x006436bc
00640c5d : ADD ESP,0x20
00640c60 : MOV EAX,dword ptr [EBP + 0xc]
00640c63 : CMP dword ptr [EAX + 0x24],0x0
00640c67 : JNZ 0x00640c74
00640c69 : PUSH dword ptr [EBP + 0x8]
00640c6c : PUSH dword ptr [EBP + 0xc]
00640c6f : CALL 0x00640a70
00640c74 : PUSH 0x0
00640c76 : PUSH 0x0
00640c78 : PUSH 0x0
00640c7a : PUSH 0x0
00640c7c : PUSH 0x0
00640c7e : LEA EAX,[EBP + -0x4]
00640c81 : PUSH EAX
00640c82 : PUSH 0x123
00640c87 : CALL 0x00640b2d
00640c8c : ADD ESP,0x1c
00640c8f : MOV EAX,dword ptr [EBP + -0x4]
00640c92 : MOV EBX,dword ptr [EBP + 0xc]
00640c95 : MOV ESP,dword ptr [EBX + 0x1c]
00640c98 : MOV EBP,dword ptr [EBX + 0x20]
00640c9b : JMP EAX
00640ca0 : POP EBX
00640ca1 : LEAVE
00640ca2 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_005ba4d0
ENTRY    : 005ba4d0
BODY     : [[005ba4d0, 005ba60d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005ba4d0(undefined4 param_1,undefined4 *param_2,uint param_3)

{
  uint *puVar1;
  int iVar2;
  int *piVar3;
  uint *puVar4;
  uint uVar5;
  int *in_ECX;
  uint uVar6;
  int iVar7;
  
  piVar3 = (int *)*in_ECX;
  if (piVar3 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar3 * 5) <= piVar3[1] * 4 + 4U) goto LAB_005ba50c;
    iVar7 = piVar3[1] * 2 + 2;
  }
  FUN_005b9e30(param_1,iVar7);
LAB_005ba50c:
  piVar3 = (int *)*in_ECX;
  param_3 = param_3 & piVar3[1];
  *piVar3 = *piVar3 + 1;
  iVar7 = *in_ECX;
  puVar1 = (uint *)(iVar7 + 8 + param_3 * 0x14);
  if (*puVar1 == 0xfffffffe) {
    *puVar1 = 0xffffffff;
    FUN_0051c2c0(*param_2);
    puVar4 = (uint *)param_2[1];
    puVar1[3] = *puVar4;
    puVar1[4] = puVar4[1];
    puVar1[1] = param_3;
    return;
  }
  uVar6 = param_3;
  do {
    uVar6 = uVar6 + 1 & *(uint *)(iVar7 + 4);
  } while (*(int *)(iVar7 + 8 + uVar6 * 0x14) != -2);
  uVar5 = puVar1[1];
  iVar2 = iVar7 + 8 + uVar6 * 0x14;
  if (uVar5 != param_3) {
    puVar4 = (uint *)(iVar7 + 8 + uVar5 * 0x14);
    for (uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x14); uVar5 != param_3;
        uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x14)) {
      uVar5 = *puVar4;
      puVar4 = (uint *)(iVar7 + 8 + uVar5 * 0x14);
    }
    if (iVar2 != 0) {
      FUN_005b9c20(puVar1);
    }
    *puVar4 = uVar6;
    FUN_0051bc20(*param_2);
    puVar4 = (uint *)param_2[1];
    puVar1[3] = *puVar4;
    puVar1[4] = puVar4[1];
    puVar1[1] = param_3;
    *puVar1 = 0xffffffff;
    return;
  }
  if (iVar2 != 0) {
    FUN_005b9c20(puVar1);
  }
  FUN_0051bc20(*param_2);
  puVar4 = (uint *)param_2[1];
  puVar1[3] = *puVar4;
  puVar1[4] = puVar4[1];
  puVar1[1] = param_3;
  *puVar1 = uVar6;
  return;
}



============================================================
DISASSEMBLY
============================================================
005ba4d0 : PUSH EBX
005ba4d1 : PUSH EBP
005ba4d2 : PUSH ESI
005ba4d3 : MOV ESI,ECX
005ba4d5 : MOV EAX,dword ptr [ESI]
005ba4d7 : PUSH EDI
005ba4d8 : TEST EAX,EAX
005ba4da : JNZ 0x005ba4e5
005ba4dc : MOV EAX,dword ptr [ESP + 0x14]
005ba4e0 : PUSH 0x8
005ba4e2 : PUSH EAX
005ba4e3 : JMP 0x005ba507
005ba4e5 : MOV ECX,dword ptr [EAX + 0x4]
005ba4e8 : LEA EDX,[ECX*0x4 + 0x4]
005ba4ef : MOV ECX,dword ptr [EAX]
005ba4f1 : LEA ECX,[ECX + ECX*0x4]
005ba4f4 : CMP ECX,EDX
005ba4f6 : JBE 0x005ba50c
005ba4f8 : MOV EDX,dword ptr [EAX + 0x4]
005ba4fb : MOV ECX,dword ptr [ESP + 0x14]
005ba4ff : LEA EAX,[EDX + EDX*0x1 + 0x2]
005ba503 : PUSH EAX
005ba504 : PUSH ECX
005ba505 : MOV ECX,ESI
005ba507 : CALL 0x005b9e30
005ba50c : MOV EAX,dword ptr [ESI]
005ba50e : MOV EDI,dword ptr [ESP + 0x1c]
005ba512 : AND EDI,dword ptr [EAX + 0x4]
005ba515 : INC dword ptr [EAX]
005ba517 : MOV EAX,dword ptr [ESI]
005ba519 : LEA EDX,[EDI + EDI*0x4]
005ba51c : LEA ESI,[EAX + EDX*0x4 + 0x8]
005ba520 : MOV EDX,0xfffffffe
005ba525 : CMP dword ptr [ESI],EDX
005ba527 : JNZ 0x005ba559
005ba529 : MOV EBP,dword ptr [ESP + 0x18]
005ba52d : MOV dword ptr [ESI],0xffffffff
005ba533 : MOV EAX,dword ptr [EBP]
005ba536 : LEA EBX,[ESI + 0x8]
005ba539 : PUSH EAX
005ba53a : MOV ECX,EBX
005ba53c : CALL 0x0051c2c0
005ba541 : MOV EAX,dword ptr [EBP + 0x4]
005ba544 : MOV ECX,dword ptr [EAX]
005ba546 : MOV dword ptr [EBX + 0x4],ECX
005ba549 : MOV EDX,dword ptr [EAX + 0x4]
005ba54c : MOV dword ptr [EBX + 0x8],EDX
005ba54f : MOV dword ptr [ESI + 0x4],EDI
005ba552 : POP EDI
005ba553 : POP ESI
005ba554 : POP EBP
005ba555 : POP EBX
005ba556 : RET 0xc
005ba559 : MOV ECX,dword ptr [EAX + 0x4]
005ba55c : MOV EBX,EDI
005ba55e : MOV EDI,EDI
005ba560 : INC EBX
005ba561 : AND EBX,ECX
005ba563 : LEA EBP,[EBX + EBX*0x4]
005ba566 : CMP dword ptr [EAX + EBP*0x4 + 0x8],EDX
005ba56a : JNZ 0x005ba560
005ba56c : MOV EDX,dword ptr [ESI + 0x4]
005ba56f : LEA ECX,[EBX + EBX*0x4]
005ba572 : LEA ECX,[EAX + ECX*0x4 + 0x8]
005ba576 : CMP EDX,EDI
005ba578 : JNZ 0x005ba5b3
005ba57a : TEST ECX,ECX
005ba57c : JZ 0x005ba584
005ba57e : PUSH ESI
005ba57f : CALL 0x005b9c20
005ba584 : MOV EDX,dword ptr [ESP + 0x18]
005ba588 : MOV EAX,dword ptr [EDX]
005ba58a : LEA EBP,[ESI + 0x8]
005ba58d : PUSH EAX
005ba58e : MOV ECX,EBP
005ba590 : CALL 0x0051bc20
005ba595 : MOV ECX,dword ptr [ESP + 0x18]
005ba599 : MOV EAX,dword ptr [ECX + 0x4]
005ba59c : MOV EDX,dword ptr [EAX]
005ba59e : MOV dword ptr [EBP + 0x4],EDX
005ba5a1 : MOV EAX,dword ptr [EAX + 0x4]
005ba5a4 : MOV dword ptr [EBP + 0x8],EAX
005ba5a7 : MOV dword ptr [ESI + 0x4],EDI
005ba5aa : POP EDI
005ba5ab : MOV dword ptr [ESI],EBX
005ba5ad : POP ESI
005ba5ae : POP EBP
005ba5af : POP EBX
005ba5b0 : RET 0xc
005ba5b3 : LEA EDX,[EDX + EDX*0x4]
005ba5b6 : CMP dword ptr [EAX + EDX*0x4 + 0x8],EDI
005ba5ba : LEA EBP,[EAX + EDX*0x4 + 0x8]
005ba5be : JZ 0x005ba5d1
005ba5c0 : MOV EBP,dword ptr [EBP]
005ba5c3 : LEA EDX,[EBP + EBP*0x4]
005ba5c7 : CMP dword ptr [EAX + EDX*0x4 + 0x8],EDI
005ba5cb : LEA EBP,[EAX + EDX*0x4 + 0x8]
005ba5cf : JNZ 0x005ba5c0
005ba5d1 : TEST ECX,ECX
005ba5d3 : JZ 0x005ba5db
005ba5d5 : PUSH ESI
005ba5d6 : CALL 0x005b9c20
005ba5db : MOV dword ptr [EBP],EBX
005ba5de : MOV EBP,dword ptr [ESP + 0x18]
005ba5e2 : MOV EAX,dword ptr [EBP]
005ba5e5 : LEA EBX,[ESI + 0x8]
005ba5e8 : PUSH EAX
005ba5e9 : MOV ECX,EBX
005ba5eb : CALL 0x0051bc20
005ba5f0 : MOV EAX,dword ptr [EBP + 0x4]
005ba5f3 : MOV ECX,dword ptr [EAX]
005ba5f5 : MOV dword ptr [EBX + 0x4],ECX
005ba5f8 : MOV EDX,dword ptr [EAX + 0x4]
005ba5fb : MOV dword ptr [EBX + 0x8],EDX
005ba5fe : MOV dword ptr [ESI + 0x4],EDI
005ba601 : POP EDI
005ba602 : MOV dword ptr [ESI],0xffffffff
005ba608 : POP ESI
005ba609 : POP EBP
005ba60a : POP EBX
005ba60b : RET 0xc

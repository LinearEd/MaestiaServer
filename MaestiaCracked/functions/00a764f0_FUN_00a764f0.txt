PROGRAM  : Maestia.exe
FUNCTION : FUN_00a764f0
ENTRY    : 00a764f0
BODY     : [[00a764f0, 00a766f0]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x00a766bf) */

void FUN_00a764f0(int *param_1,undefined4 param_2)

{
  uint uVar1;
  int iVar2;
  int *in_ECX;
  uint local_34;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3840e;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar2 = (**(code **)(*in_ECX + 0x98))();
  if (iVar2 == 0) {
    FUN_008018d0();
  }
  else if (param_1 == (int *)0x0) {
    FUN_008018d0();
  }
  else {
    iVar2 = (**(code **)(*in_ECX + 0x98))();
    FUN_00908f50();
    *(int **)(iVar2 + 8) = param_1;
    FUN_00405eb0();
    local_8 = 0;
    (**(code **)(*param_1 + 0xb0))();
    (**(code **)(*in_ECX + 0x60))(param_1);
    FUN_00405eb0(param_2,0,0xffffffff);
    local_8 = local_8 & 0xffffff00;
    FUN_008f75f0();
    local_8 = CONCAT31(local_8._1_3_,2);
    iVar2 = *DAT_00da9894;
    if ((iVar2 != 0) && (*(int *)(iVar2 + 0x114) != 0)) {
      (**(code **)(**(int **)(iVar2 + 0x114) + 4))();
    }
    if (((*(char *)((int)in_ECX + 0x32) != '\0') && (iVar2 = *DAT_00da9894, iVar2 != 0)) &&
       (*(int *)(iVar2 + 0x114) != 0)) {
      (**(code **)(**(int **)(iVar2 + 0x114) + 4))();
    }
    local_8 = local_8 & 0xffffff00;
    if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_8 = 0xffffffff;
  }
  ExceptionList = local_10;
  __security_check_cookie(uVar1 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a764f0 : PUSH EBP
00a764f1 : MOV EBP,ESP
00a764f3 : PUSH -0x1
00a764f5 : PUSH 0xb3840e
00a764fa : MOV EAX,FS:[0x0]
00a76500 : PUSH EAX
00a76501 : SUB ESP,0x44
00a76504 : MOV EAX,[0x00d66fa0]
00a76509 : XOR EAX,EBP
00a7650b : MOV dword ptr [EBP + -0x10],EAX
00a7650e : PUSH EBX
00a7650f : PUSH ESI
00a76510 : PUSH EDI
00a76511 : PUSH EAX
00a76512 : LEA EAX,[EBP + -0xc]
00a76515 : MOV FS:[0x0],EAX
00a7651b : MOV EAX,dword ptr [EBP + 0xc]
00a7651e : MOV EBX,dword ptr [EBP + 0x10]
00a76521 : MOV EDI,dword ptr [EBP + 0x8]
00a76524 : MOV ESI,ECX
00a76526 : MOV EDX,dword ptr [ESI]
00a76528 : MOV dword ptr [EBP + -0x4c],EAX
00a7652b : MOV EAX,dword ptr [EDX + 0x98]
00a76531 : PUSH EBX
00a76532 : CALL EAX
00a76534 : TEST EAX,EAX
00a76536 : JNZ 0x00a76554
00a76538 : MOV ESI,dword ptr [0x00da98e8]
00a7653e : MOVZX ECX,BX
00a76541 : PUSH ECX
00a76542 : PUSH 0xc507f8
00a76547 : CALL 0x008018d0
00a7654c : ADD ESP,0x8
00a7654f : JMP 0x00a766d3
00a76554 : TEST EDI,EDI
00a76556 : JNZ 0x00a76570
00a76558 : MOV ESI,dword ptr [0x00da98e8]
00a7655e : PUSH 0xc50870
00a76563 : CALL 0x008018d0
00a76568 : ADD ESP,0x4
00a7656b : JMP 0x00a766d3
00a76570 : MOV EDX,dword ptr [ESI]
00a76572 : MOV EAX,dword ptr [EDX + 0x98]
00a76578 : PUSH EBX
00a76579 : MOV ECX,ESI
00a7657b : CALL EAX
00a7657d : MOV EBX,EAX
00a7657f : MOV ECX,EBX
00a76581 : CALL 0x00908f50
00a76586 : MOV ECX,dword ptr [EBP + -0x4c]
00a76589 : PUSH -0x1
00a7658b : PUSH 0x0
00a7658d : PUSH ECX
00a7658e : LEA ECX,[EBX + 0x20]
00a76591 : MOV dword ptr [EBX + 0x8],EDI
00a76594 : CALL 0x00405eb0
00a76599 : XOR EBX,EBX
00a7659b : XOR EDX,EDX
00a7659d : MOV dword ptr [EBP + -0x14],0x7
00a765a4 : MOV dword ptr [EBP + -0x18],EBX
00a765a7 : MOV word ptr [EBP + -0x28],DX
00a765ab : MOV dword ptr [EBP + -0x4],EBX
00a765ae : MOV EDX,dword ptr [EBP + 0x10]
00a765b1 : MOV EAX,dword ptr [EDI]
00a765b3 : MOV EAX,dword ptr [EAX + 0xb0]
00a765b9 : PUSH 0x1
00a765bb : LEA ECX,[EBP + -0x2c]
00a765be : PUSH ECX
00a765bf : PUSH 0xffff
00a765c4 : PUSH EDX
00a765c5 : PUSH ESI
00a765c6 : MOV ECX,EDI
00a765c8 : CALL EAX
00a765ca : MOV EDX,dword ptr [ESI]
00a765cc : MOV EDX,dword ptr [EDX + 0x60]
00a765cf : LEA EAX,[EBP + -0x2c]
00a765d2 : PUSH EAX
00a765d3 : PUSH EDI
00a765d4 : MOV ECX,ESI
00a765d6 : CALL EDX
00a765d8 : MOV EDX,dword ptr [EBP + -0x4c]
00a765db : SUB ESP,0x1c
00a765de : MOV ECX,ESP
00a765e0 : MOV dword ptr [EBP + -0x50],ESP
00a765e3 : PUSH -0x1
00a765e5 : PUSH EBX
00a765e6 : MOV EDI,0x7
00a765eb : XOR EAX,EAX
00a765ed : MOV dword ptr [ECX + 0x18],EDI
00a765f0 : MOV dword ptr [ECX + 0x14],EBX
00a765f3 : PUSH EDX
00a765f4 : MOV word ptr [ECX + 0x4],AX
00a765f8 : CALL 0x00405eb0
00a765fd : MOV byte ptr [EBP + -0x4],0x1
00a76601 : MOV byte ptr [EBP + -0x4],BL
00a76604 : LEA ECX,[EBP + -0x48]
00a76607 : CALL 0x008f75f0
00a7660c : ADD ESP,0x1c
00a7660f : MOV byte ptr [EBP + -0x4],0x2
00a76613 : MOV EAX,[0x00da9894]
00a76618 : MOV EAX,dword ptr [EAX]
00a7661a : CMP EAX,EBX
00a7661c : JZ 0x00a76658
00a7661e : CMP dword ptr [EAX + 0x114],EBX
00a76624 : JZ 0x00a76658
00a76626 : CMP dword ptr [EBP + -0x30],0x8
00a7662a : MOV EAX,dword ptr [EAX + 0x114]
00a76630 : MOV ECX,dword ptr [EBP + -0x44]
00a76633 : JNC 0x00a76638
00a76635 : LEA ECX,[EBP + -0x44]
00a76638 : MOV EDX,dword ptr [EAX]
00a7663a : MOV EDX,dword ptr [EDX + 0x4]
00a7663d : PUSH 0x186a0
00a76642 : PUSH ECX
00a76643 : MOVZX ECX,word ptr [EBP + 0x10]
00a76647 : PUSH ECX
00a76648 : PUSH 0xc508d8
00a7664d : PUSH 0xc508e4
00a76652 : PUSH EAX
00a76653 : CALL EDX
00a76655 : ADD ESP,0x18
00a76658 : CMP byte ptr [ESI + 0x32],0x0
00a7665c : JZ 0x00a76691
00a7665e : MOV EAX,[0x00da9894]
00a76663 : MOV EAX,dword ptr [EAX]
00a76665 : CMP EAX,EBX
00a76667 : JZ 0x00a76691
00a76669 : CMP dword ptr [EAX + 0x114],EBX
00a7666f : JZ 0x00a76691
00a76671 : MOVZX EDX,word ptr [EBP + 0x10]
00a76675 : MOV EAX,dword ptr [EAX + 0x114]
00a7667b : MOV ECX,dword ptr [EAX]
00a7667d : PUSH EDX
00a7667e : PUSH 0xc508f8
00a76683 : PUSH 0xc508fc
00a76688 : PUSH EAX
00a76689 : MOV EAX,dword ptr [ECX + 0x4]
00a7668c : CALL EAX
00a7668e : ADD ESP,0x10
00a76691 : MOV byte ptr [EBP + -0x4],0x0
00a76695 : MOV ESI,0x8
00a7669a : CMP dword ptr [EBP + -0x30],ESI
00a7669d : JC 0x00a766a7
00a7669f : MOV ECX,dword ptr [EBP + -0x44]
00a766a2 : CALL 0x006f04e0
00a766a7 : XOR ECX,ECX
00a766a9 : MOV dword ptr [EBP + -0x30],EDI
00a766ac : MOV dword ptr [EBP + -0x34],EBX
00a766af : MOV word ptr [EBP + -0x44],CX
00a766b3 : MOV dword ptr [EBP + -0x4],0xffffffff
00a766ba : CMP dword ptr [EBP + -0x14],ESI
00a766bd : JC 0x00a766c7
00a766bf : MOV ECX,dword ptr [EBP + -0x28]
00a766c2 : CALL 0x006f04e0
00a766c7 : XOR EDX,EDX
00a766c9 : MOV dword ptr [EBP + -0x14],EDI
00a766cc : MOV dword ptr [EBP + -0x18],EBX
00a766cf : MOV word ptr [EBP + -0x28],DX
00a766d3 : MOV ECX,dword ptr [EBP + -0xc]
00a766d6 : MOV dword ptr FS:[0x0],ECX
00a766dd : POP ECX
00a766de : POP EDI
00a766df : POP ESI
00a766e0 : POP EBX
00a766e1 : MOV ECX,dword ptr [EBP + -0x10]
00a766e4 : XOR ECX,EBP
00a766e6 : CALL 0x00633e6b
00a766eb : MOV ESP,EBP
00a766ed : POP EBP
00a766ee : RET 0xc

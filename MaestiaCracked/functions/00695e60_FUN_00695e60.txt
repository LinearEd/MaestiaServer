PROGRAM  : Maestia.exe
FUNCTION : FUN_00695e60
ENTRY    : 00695e60
BODY     : [[00695e60, 006960bf]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00695e60(int param_1)

{
  byte bVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  short *psVar4;
  int iVar5;
  char *pcVar6;
  int iVar7;
  byte *pbVar8;
  int iVar9;
  uint uVar10;
  byte *local_10;
  int local_c;
  int local_8;
  byte *local_4;
  
  iVar5 = 0;
  local_10 = (byte *)0x0;
  if (*(int *)(param_1 + 0x2c0) != 0) {
    return;
  }
  iVar9 = -1;
  iVar7 = -1;
  if (*(short *)(param_1 + 0x158) == 0) goto LAB_006960b0;
  psVar4 = *(short **)(param_1 + 0x168);
  do {
    if ((psVar4[3] == 6) && (psVar4[4] != 0)) {
      if ((*psVar4 == 3) && ((psVar4[1] == 1 && (psVar4[2] == 0x409)))) {
        iVar9 = iVar5;
      }
      if (((*psVar4 == 1) && (psVar4[1] == 0)) && (psVar4[2] == 0)) {
        iVar7 = iVar5;
      }
    }
    iVar5 = iVar5 + 1;
    psVar4 = psVar4 + 10;
  } while (iVar5 < (int)(uint)*(ushort *)(param_1 + 0x158));
  if (iVar9 == -1) {
    if (iVar7 == -1) goto LAB_006960b0;
    uVar2 = *(undefined4 *)(param_1 + 100);
    uVar10 = (uint)*(ushort *)(*(int *)(param_1 + 0x168) + 8 + iVar7 * 0x14);
    iVar5 = *(int *)(param_1 + 0x168) + iVar7 * 0x14;
    local_c = 0;
    local_10 = (byte *)FUN_00688c00(uVar2,uVar10 + 1,&local_c);
    if (local_c != 0) goto LAB_006960b0;
    uVar3 = *(undefined4 *)(param_1 + 0x16c);
    local_c = FUN_006877c0(uVar3,*(undefined4 *)(iVar5 + 0xc));
    if ((local_c == 0) && (local_c = FUN_006888a0(uVar3,local_10,uVar10), local_c == 0)) {
      local_10[uVar10] = 0;
      *(byte **)(param_1 + 0x2c0) = local_10;
      return;
    }
    *(undefined4 *)(iVar5 + 0xc) = 0;
    *(undefined2 *)(iVar5 + 8) = 0;
    FUN_00687f30(uVar2,*(undefined4 *)(iVar5 + 0x10));
    *(undefined4 *)(iVar5 + 0x10) = 0;
    FUN_00687f30(uVar2,local_10);
  }
  else {
    uVar2 = *(undefined4 *)(param_1 + 100);
    iVar5 = *(int *)(param_1 + 0x168) + iVar9 * 0x14;
    local_c = 0;
    uVar10 = (uint)(*(ushort *)(*(int *)(param_1 + 0x168) + 8 + iVar9 * 0x14) >> 1);
    local_10 = (byte *)FUN_00688c00(uVar2,*(ushort *)(iVar5 + 8) + 1,&local_c);
    if (local_c != 0) goto LAB_006960b0;
    local_8 = *(int *)(param_1 + 0x16c);
    local_4 = local_10;
    local_c = FUN_006877c0(local_8,*(undefined4 *)(iVar5 + 0xc));
    if ((local_c == 0) && (local_c = FUN_00688900(local_8,*(undefined2 *)(iVar5 + 8)), local_c == 0)
       ) {
      pcVar6 = *(char **)(local_8 + 0x20);
      pbVar8 = local_10;
      for (; uVar10 != 0; uVar10 = uVar10 - 1) {
        if (((*pcVar6 == '\0') && (bVar1 = pcVar6[1], 0x1f < bVar1)) && (bVar1 < 0x80)) {
          *pbVar8 = bVar1;
          pbVar8 = pbVar8 + 1;
        }
        pcVar6 = pcVar6 + 2;
      }
      *pbVar8 = 0;
      FUN_006889b0(local_8);
      *(byte **)(param_1 + 0x2c0) = local_10;
      return;
    }
    FUN_00687f30(uVar2,local_10);
    *(undefined2 *)(iVar5 + 8) = 0;
    *(undefined4 *)(iVar5 + 0xc) = 0;
    FUN_00687f30(uVar2,*(undefined4 *)(iVar5 + 0x10));
    *(undefined4 *)(iVar5 + 0x10) = 0;
  }
  local_10 = (byte *)0x0;
LAB_006960b0:
  *(byte **)(param_1 + 0x2c0) = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00695e60 : SUB ESP,0x10
00695e63 : PUSH EBX
00695e64 : MOV EBX,dword ptr [ESP + 0x18]
00695e68 : MOV EAX,dword ptr [EBX + 0x2c0]
00695e6e : XOR ECX,ECX
00695e70 : MOV dword ptr [ESP + 0x4],ECX
00695e74 : CMP EAX,ECX
00695e76 : JNZ 0x006960bb
00695e7c : PUSH ESI
00695e7d : OR ESI,0xffffffff
00695e80 : XOR EAX,EAX
00695e82 : OR EDX,ESI
00695e84 : CMP AX,word ptr [EBX + 0x158]
00695e8b : JNC 0x006960b0
00695e91 : MOV EAX,dword ptr [EBX + 0x168]
00695e97 : PUSH EBP
00695e98 : PUSH EDI
00695e99 : LEA ESP,[ESP]
00695ea0 : CMP word ptr [EAX + 0x6],0x6
00695ea5 : JNZ 0x00695ee1
00695ea7 : CMP word ptr [EAX + 0x8],0x0
00695eac : JBE 0x00695ee1
00695eae : MOVZX EDI,word ptr [EAX]
00695eb1 : CMP DI,0x3
00695eb5 : JNZ 0x00695ecb
00695eb7 : CMP word ptr [EAX + 0x2],0x1
00695ebc : JNZ 0x00695ecb
00695ebe : MOV EBP,0x409
00695ec3 : CMP word ptr [EAX + 0x4],BP
00695ec7 : JNZ 0x00695ecb
00695ec9 : MOV ESI,ECX
00695ecb : CMP DI,0x1
00695ecf : JNZ 0x00695ee1
00695ed1 : CMP word ptr [EAX + 0x2],0x0
00695ed6 : JNZ 0x00695ee1
00695ed8 : CMP word ptr [EAX + 0x4],0x0
00695edd : JNZ 0x00695ee1
00695edf : MOV EDX,ECX
00695ee1 : MOVZX EDI,word ptr [EBX + 0x158]
00695ee8 : INC ECX
00695ee9 : ADD EAX,0x14
00695eec : CMP ECX,EDI
00695eee : JL 0x00695ea0
00695ef0 : CMP ESI,-0x1
00695ef3 : JZ 0x00695fed
00695ef9 : MOV EBP,dword ptr [EBX + 0x64]
00695efc : LEA ECX,[ESI + ESI*0x4]
00695eff : MOV ESI,dword ptr [EBX + 0x168]
00695f05 : MOVZX EDI,word ptr [ESI + ECX*0x4 + 0x8]
00695f0a : LEA ESI,[ESI + ECX*0x4]
00695f0d : MOV dword ptr [ESP + 0x14],0x0
00695f15 : MOVZX EAX,word ptr [ESI + 0x8]
00695f19 : LEA EDX,[ESP + 0x14]
00695f1d : PUSH EDX
00695f1e : INC EAX
00695f1f : PUSH EAX
00695f20 : PUSH EBP
00695f21 : SHR EDI,0x1
00695f23 : CALL 0x00688c00
00695f28 : ADD ESP,0xc
00695f2b : CMP dword ptr [ESP + 0x14],0x0
00695f30 : MOV dword ptr [ESP + 0x10],EAX
00695f34 : JNZ 0x006960ae
00695f3a : MOV EAX,dword ptr [EBX + 0x16c]
00695f40 : MOV ECX,dword ptr [ESI + 0xc]
00695f43 : MOV EBX,dword ptr [ESP + 0x10]
00695f47 : PUSH ECX
00695f48 : PUSH EAX
00695f49 : MOV dword ptr [ESP + 0x20],EAX
00695f4d : MOV dword ptr [ESP + 0x24],EBX
00695f51 : CALL 0x006877c0
00695f56 : ADD ESP,0x8
00695f59 : MOV dword ptr [ESP + 0x14],EAX
00695f5d : TEST EAX,EAX
00695f5f : JNZ 0x00695fc5
00695f61 : MOVZX EDX,word ptr [ESI + 0x8]
00695f65 : MOV EAX,dword ptr [ESP + 0x18]
00695f69 : PUSH EDX
00695f6a : PUSH EAX
00695f6b : CALL 0x00688900
00695f70 : ADD ESP,0x8
00695f73 : MOV dword ptr [ESP + 0x14],EAX
00695f77 : TEST EAX,EAX
00695f79 : JNZ 0x00695fc5
00695f7b : MOV ESI,dword ptr [ESP + 0x18]
00695f7f : MOV ECX,dword ptr [ESI + 0x20]
00695f82 : MOV EDX,EBX
00695f84 : TEST EDI,EDI
00695f86 : JBE 0x00695fa3
00695f88 : CMP byte ptr [ECX],0x0
00695f8b : JNZ 0x00695f9b
00695f8d : MOV AL,byte ptr [ECX + 0x1]
00695f90 : CMP AL,0x20
00695f92 : JC 0x00695f9b
00695f94 : CMP AL,0x80
00695f96 : JNC 0x00695f9b
00695f98 : MOV byte ptr [EDX],AL
00695f9a : INC EDX
00695f9b : DEC EDI
00695f9c : ADD ECX,0x2
00695f9f : TEST EDI,EDI
00695fa1 : JA 0x00695f88
00695fa3 : PUSH ESI
00695fa4 : MOV byte ptr [EDX],0x0
00695fa7 : CALL 0x006889b0
00695fac : MOV EBX,dword ptr [ESP + 0x28]
00695fb0 : MOV EAX,dword ptr [ESP + 0x14]
00695fb4 : ADD ESP,0x4
00695fb7 : POP EDI
00695fb8 : POP EBP
00695fb9 : POP ESI
00695fba : MOV dword ptr [EBX + 0x2c0],EAX
00695fc0 : POP EBX
00695fc1 : ADD ESP,0x10
00695fc4 : RET
00695fc5 : PUSH EBX
00695fc6 : PUSH EBP
00695fc7 : CALL 0x00687f30
00695fcc : MOV EDX,dword ptr [ESI + 0x10]
00695fcf : XOR EDI,EDI
00695fd1 : PUSH EDX
00695fd2 : XOR ECX,ECX
00695fd4 : PUSH EBP
00695fd5 : MOV dword ptr [ESP + 0x20],EDI
00695fd9 : MOV word ptr [ESI + 0x8],CX
00695fdd : MOV dword ptr [ESI + 0xc],EDI
00695fe0 : CALL 0x00687f30
00695fe5 : MOV dword ptr [ESI + 0x10],EDI
00695fe8 : JMP 0x006960a7
00695fed : CMP EDX,-0x1
00695ff0 : JZ 0x006960ae
00695ff6 : MOV ESI,dword ptr [EBX + 0x168]
00695ffc : MOV EBP,dword ptr [EBX + 0x64]
00695fff : LEA EAX,[EDX + EDX*0x4]
00696002 : MOVZX EDI,word ptr [ESI + EAX*0x4 + 0x8]
00696007 : LEA ESI,[ESI + EAX*0x4]
0069600a : LEA ECX,[ESP + 0x14]
0069600e : PUSH ECX
0069600f : LEA EDX,[EDI + 0x1]
00696012 : PUSH EDX
00696013 : PUSH EBP
00696014 : MOV dword ptr [ESP + 0x20],0x0
0069601c : CALL 0x00688c00
00696021 : ADD ESP,0xc
00696024 : CMP dword ptr [ESP + 0x14],0x0
00696029 : MOV dword ptr [ESP + 0x10],EAX
0069602d : JNZ 0x006960ae
0069602f : MOV EAX,dword ptr [ESI + 0xc]
00696032 : MOV EBX,dword ptr [EBX + 0x16c]
00696038 : PUSH EAX
00696039 : PUSH EBX
0069603a : CALL 0x006877c0
0069603f : ADD ESP,0x8
00696042 : MOV dword ptr [ESP + 0x14],EAX
00696046 : TEST EAX,EAX
00696048 : JNZ 0x0069607c
0069604a : MOV ECX,dword ptr [ESP + 0x10]
0069604e : PUSH EDI
0069604f : PUSH ECX
00696050 : PUSH EBX
00696051 : CALL 0x006888a0
00696056 : ADD ESP,0xc
00696059 : MOV dword ptr [ESP + 0x14],EAX
0069605d : TEST EAX,EAX
0069605f : JNZ 0x0069607c
00696061 : MOV EDX,dword ptr [ESP + 0x10]
00696065 : MOV EBX,dword ptr [ESP + 0x24]
00696069 : MOV byte ptr [EDI + EDX*0x1],AL
0069606c : POP EDI
0069606d : POP EBP
0069606e : MOV EAX,EDX
00696070 : POP ESI
00696071 : MOV dword ptr [EBX + 0x2c0],EAX
00696077 : POP EBX
00696078 : ADD ESP,0x10
0069607b : RET
0069607c : MOV ECX,dword ptr [ESI + 0x10]
0069607f : PUSH ECX
00696080 : XOR EAX,EAX
00696082 : PUSH EBP
00696083 : MOV dword ptr [ESI + 0xc],0x0
0069608a : MOV word ptr [ESI + 0x8],AX
0069608e : CALL 0x00687f30
00696093 : MOV EDX,dword ptr [ESP + 0x18]
00696097 : PUSH EDX
00696098 : XOR EDI,EDI
0069609a : PUSH EBP
0069609b : MOV dword ptr [ESI + 0x10],EDI
0069609e : CALL 0x00687f30
006960a3 : MOV dword ptr [ESP + 0x20],EDI
006960a7 : MOV EBX,dword ptr [ESP + 0x34]
006960ab : ADD ESP,0x10
006960ae : POP EDI
006960af : POP EBP
006960b0 : MOV EAX,dword ptr [ESP + 0x8]
006960b4 : MOV dword ptr [EBX + 0x2c0],EAX
006960ba : POP ESI
006960bb : POP EBX
006960bc : ADD ESP,0x10
006960bf : RET

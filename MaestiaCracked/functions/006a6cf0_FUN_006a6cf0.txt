PROGRAM  : Maestia.exe
FUNCTION : FUN_006a6cf0
ENTRY    : 006a6cf0
BODY     : [[006a6cf0, 006a6fd6]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006a6cf0(int param_1,byte *param_2,byte *param_3)

{
  byte bVar1;
  int iVar2;
  undefined4 uVar3;
  byte *pbVar4;
  byte *pbVar5;
  uint uVar6;
  byte *pbVar7;
  byte bVar8;
  int *piVar9;
  byte *pbVar10;
  byte *pbVar11;
  byte *pbVar12;
  byte *pbVar13;
  byte *pbVar14;
  int local_14 [2];
  uint local_c;
  uint local_8;
  uint local_4;
  
  local_14[0] = 0;
  local_4 = **(undefined4 **)(param_1 + 0x1c);
  pbVar12 = param_2 + 1;
  if (pbVar12 <= param_3) {
    bVar1 = *param_2;
    if ((char)bVar1 < '\0') {
      local_8 = bVar1 & 0x3f;
      if (((bVar1 & 8) != 0) && (local_14[0] = FUN_006a6590(), local_14[0] != 0)) {
        return local_14[0];
      }
      iVar2 = *(int *)(param_1 + 0x10);
      uVar6 = local_8 + iVar2;
      if (*(uint *)(param_1 + 0x14) < uVar6) {
        uVar6 = uVar6 + 3 & 0xfffffffc;
        uVar3 = FUN_0068a220(local_4,0x18,*(uint *)(param_1 + 0x14),uVar6,
                             *(undefined4 *)(param_1 + 0x18),local_14);
        *(undefined4 *)(param_1 + 0x18) = uVar3;
        if (local_14[0] != 0) {
          return local_14[0];
        }
        *(uint *)(param_1 + 0x14) = uVar6;
      }
      piVar9 = (int *)(*(int *)(param_1 + 0x18) + iVar2 * 0x18);
      local_4 = 0;
      if (local_8 == 0) {
        return local_14[0];
      }
      pbVar5 = param_2 + 3;
      pbVar14 = param_2 + 4;
      param_2 = param_2 + 2;
      while (local_c = 0, param_2 <= param_3) {
        bVar1 = *pbVar12;
        pbVar10 = pbVar12 + 1;
        pbVar7 = param_2 + 1;
        pbVar13 = pbVar14 + 1;
        pbVar4 = pbVar5 + 1;
        *piVar9 = 0x10000;
        if ((bVar1 & 0x10) != 0) {
          if (param_3 < pbVar4) {
            return 8;
          }
          bVar8 = *pbVar10;
          pbVar10 = pbVar12 + 3;
          pbVar7 = param_2 + 3;
          pbVar13 = pbVar14 + 3;
          pbVar4 = pbVar5 + 3;
          *piVar9 = ((int)(short)((short)(char)bVar8 << 8) | (uint)pbVar12[2]) << 4;
        }
        piVar9[1] = 0x10000;
        if ((bVar1 & 0x20) != 0) {
          if (param_3 < pbVar4) {
            return 8;
          }
          bVar8 = *pbVar10;
          pbVar12 = pbVar10 + 1;
          pbVar10 = pbVar10 + 2;
          pbVar7 = pbVar7 + 2;
          pbVar13 = pbVar13 + 2;
          pbVar4 = pbVar4 + 2;
          piVar9[1] = ((int)(short)((short)(char)bVar8 << 8) | (uint)*pbVar12) << 4;
        }
        if ((bVar1 & 3) == 1) {
          if (param_3 < pbVar4) {
            return 8;
          }
          bVar8 = *pbVar10;
          pbVar12 = pbVar10 + 1;
          pbVar10 = pbVar10 + 2;
          pbVar7 = pbVar7 + 2;
          pbVar13 = pbVar13 + 2;
          pbVar4 = pbVar4 + 2;
          local_c = (int)(short)((short)(char)bVar8 << 8) | (uint)*pbVar12;
        }
        else if ((bVar1 & 3) == 2) {
          if (param_3 < pbVar7) {
            return 8;
          }
          local_c = (uint)(char)*pbVar10;
          pbVar10 = pbVar10 + 1;
          pbVar7 = pbVar7 + 1;
          pbVar13 = pbVar13 + 1;
          pbVar4 = pbVar4 + 1;
        }
        uVar6 = 0;
        bVar8 = bVar1 >> 2 & 3;
        if (bVar8 == 1) {
          if (param_3 < pbVar4) {
            return 8;
          }
          bVar8 = *pbVar10;
          pbVar12 = pbVar10 + 1;
          pbVar10 = pbVar10 + 2;
          pbVar7 = pbVar7 + 2;
          pbVar13 = pbVar13 + 2;
          pbVar4 = pbVar4 + 2;
          uVar6 = (int)(short)((short)(char)bVar8 << 8) | (uint)*pbVar12;
        }
        else if (bVar8 == 2) {
          if (param_3 < pbVar7) {
            return 8;
          }
          uVar6 = (uint)(char)*pbVar10;
          pbVar10 = pbVar10 + 1;
          pbVar7 = pbVar7 + 1;
          pbVar13 = pbVar13 + 1;
          pbVar4 = pbVar4 + 1;
        }
        piVar9[2] = local_c;
        piVar9[3] = uVar6;
        if ((bVar1 & 0x40) == 0) {
          if (param_3 < pbVar7) {
            return 8;
          }
          pbVar11 = pbVar10 + 1;
          pbVar7 = pbVar7 + 1;
          pbVar13 = pbVar13 + 1;
          piVar9[5] = (uint)*pbVar10;
          pbVar4 = pbVar4 + 1;
        }
        else {
          if (param_3 < pbVar4) {
            return 8;
          }
          pbVar11 = pbVar10 + 2;
          pbVar7 = pbVar7 + 2;
          pbVar13 = pbVar13 + 2;
          pbVar4 = pbVar4 + 2;
          piVar9[5] = (uint)CONCAT11(*pbVar10,pbVar10[1]);
        }
        if ((bVar1 & 0x80) == 0) {
          if (param_3 < pbVar4) {
            return 8;
          }
          pbVar12 = pbVar11 + 2;
          param_2 = pbVar7 + 2;
          pbVar14 = pbVar13 + 2;
          pbVar5 = pbVar4 + 2;
          uVar6 = (uint)*pbVar11;
        }
        else {
          if (param_3 < pbVar13) {
            return 8;
          }
          pbVar12 = pbVar11 + 3;
          uVar6 = (uint)CONCAT11(*pbVar11,pbVar11[1]);
          param_2 = pbVar7 + 3;
          pbVar14 = pbVar13 + 3;
          pbVar5 = pbVar4 + 3;
        }
        piVar9[4] = uVar6 << 8 | (uint)pbVar12[-1];
        *(int *)(param_1 + 0x10) = *(int *)(param_1 + 0x10) + 1;
        local_4 = local_4 + 1;
        piVar9 = piVar9 + 6;
        if (local_8 <= local_4) {
          return local_14[0];
        }
      }
    }
  }
  return 8;
}



============================================================
DISASSEMBLY
============================================================
006a6cf0 : SUB ESP,0x14
006a6cf3 : MOV ECX,dword ptr [ESP + 0x1c]
006a6cf7 : PUSH EBX
006a6cf8 : MOV EBX,dword ptr [ESP + 0x24]
006a6cfc : PUSH EBP
006a6cfd : MOV EBP,dword ptr [ESP + 0x20]
006a6d01 : MOV EDX,dword ptr [EBP + 0x1c]
006a6d04 : XOR EAX,EAX
006a6d06 : PUSH ESI
006a6d07 : MOV dword ptr [ESP + 0xc],EAX
006a6d0b : MOV EDX,dword ptr [EDX]
006a6d0d : LEA ESI,[ECX + 0x1]
006a6d10 : PUSH EDI
006a6d11 : MOV dword ptr [ESP + 0x20],EDX
006a6d15 : CMP ESI,EBX
006a6d17 : JA 0x006a6fca
006a6d1d : MOVZX ECX,byte ptr [ECX]
006a6d20 : MOV dword ptr [ESP + 0x2c],ESI
006a6d24 : TEST CL,CL
006a6d26 : JNS 0x006a6fca
006a6d2c : MOV EDX,ECX
006a6d2e : AND EDX,0x3f
006a6d31 : MOV dword ptr [ESP + 0x1c],EDX
006a6d35 : TEST CL,0x8
006a6d38 : JZ 0x006a6d53
006a6d3a : LEA EAX,[ESP + 0x2c]
006a6d3e : CALL 0x006a6590
006a6d43 : MOV dword ptr [ESP + 0x10],EAX
006a6d47 : TEST EAX,EAX
006a6d49 : JNZ 0x006a6fcf
006a6d4f : MOV ESI,dword ptr [ESP + 0x2c]
006a6d53 : MOV EDI,dword ptr [EBP + 0x10]
006a6d56 : MOV ECX,dword ptr [ESP + 0x1c]
006a6d5a : MOV EDX,dword ptr [EBP + 0x14]
006a6d5d : ADD ECX,EDI
006a6d5f : CMP ECX,EDX
006a6d61 : JBE 0x006a6d95
006a6d63 : LEA EBX,[ECX + 0x3]
006a6d66 : MOV ECX,dword ptr [EBP + 0x18]
006a6d69 : LEA EAX,[ESP + 0x10]
006a6d6d : PUSH EAX
006a6d6e : PUSH ECX
006a6d6f : AND EBX,0xfffffffc
006a6d72 : PUSH EBX
006a6d73 : PUSH EDX
006a6d74 : MOV EDX,dword ptr [ESP + 0x30]
006a6d78 : PUSH 0x18
006a6d7a : PUSH EDX
006a6d7b : CALL 0x0068a220
006a6d80 : MOV dword ptr [EBP + 0x18],EAX
006a6d83 : MOV EAX,dword ptr [ESP + 0x28]
006a6d87 : ADD ESP,0x18
006a6d8a : TEST EAX,EAX
006a6d8c : JNZ 0x006a6fcf
006a6d92 : MOV dword ptr [EBP + 0x14],EBX
006a6d95 : CMP dword ptr [ESP + 0x1c],0x0
006a6d9a : MOV EDX,dword ptr [EBP + 0x18]
006a6d9d : LEA ECX,[EDI + EDI*0x2]
006a6da0 : LEA EBP,[EDX + ECX*0x8]
006a6da3 : MOV dword ptr [ESP + 0x20],0x0
006a6dab : JBE 0x006a6fcf
006a6db1 : LEA EAX,[ESI + 0x2]
006a6db4 : LEA EDI,[ESI + 0x3]
006a6db7 : LEA ECX,[ESI + 0x1]
006a6dba : LEA EBX,[EBX]
006a6dc0 : XOR EDX,EDX
006a6dc2 : MOV dword ptr [ESP + 0x18],EDX
006a6dc6 : MOV dword ptr [ESP + 0x14],EDX
006a6dca : CMP ECX,dword ptr [ESP + 0x30]
006a6dce : JA 0x006a6fca
006a6dd4 : MOVZX EBX,byte ptr [ESI]
006a6dd7 : INC ESI
006a6dd8 : INC ECX
006a6dd9 : INC EDI
006a6dda : INC EAX
006a6ddb : MOV dword ptr [ESP + 0x2c],EBX
006a6ddf : MOV dword ptr [EBP],0x10000
006a6de6 : TEST BL,0x10
006a6de9 : JZ 0x006a6e20
006a6deb : CMP EAX,dword ptr [ESP + 0x30]
006a6def : JA 0x006a6fca
006a6df5 : MOVSX DX,byte ptr [ESI]
006a6df9 : MOVZX EBX,byte ptr [ESI + 0x1]
006a6dfd : ADD ESI,0x2
006a6e00 : SHL DX,0x8
006a6e04 : MOVSX EDX,DX
006a6e07 : OR EDX,EBX
006a6e09 : MOV EBX,dword ptr [ESP + 0x2c]
006a6e0d : ADD ECX,0x2
006a6e10 : ADD EDI,0x2
006a6e13 : ADD EAX,0x2
006a6e16 : SHL EDX,0x4
006a6e19 : MOV dword ptr [EBP],EDX
006a6e1c : MOV EDX,dword ptr [ESP + 0x14]
006a6e20 : MOV dword ptr [EBP + 0x4],0x10000
006a6e27 : TEST BL,0x20
006a6e2a : JZ 0x006a6e61
006a6e2c : CMP EAX,dword ptr [ESP + 0x30]
006a6e30 : JA 0x006a6fca
006a6e36 : MOVSX DX,byte ptr [ESI]
006a6e3a : MOVZX EBX,byte ptr [ESI + 0x1]
006a6e3e : ADD ESI,0x2
006a6e41 : SHL DX,0x8
006a6e45 : MOVSX EDX,DX
006a6e48 : OR EDX,EBX
006a6e4a : MOV EBX,dword ptr [ESP + 0x2c]
006a6e4e : ADD ECX,0x2
006a6e51 : ADD EDI,0x2
006a6e54 : ADD EAX,0x2
006a6e57 : SHL EDX,0x4
006a6e5a : MOV dword ptr [EBP + 0x4],EDX
006a6e5d : MOV EDX,dword ptr [ESP + 0x14]
006a6e61 : AND EBX,0x3
006a6e64 : SUB EBX,0x1
006a6e67 : JZ 0x006a6e85
006a6e69 : SUB EBX,0x1
006a6e6c : JNZ 0x006a6eb4
006a6e6e : CMP ECX,dword ptr [ESP + 0x30]
006a6e72 : JA 0x006a6fca
006a6e78 : MOVSX EBX,byte ptr [ESI]
006a6e7b : INC ESI
006a6e7c : INC ECX
006a6e7d : INC EDI
006a6e7e : MOV dword ptr [ESP + 0x18],EBX
006a6e82 : INC EAX
006a6e83 : JMP 0x006a6eb4
006a6e85 : CMP EAX,dword ptr [ESP + 0x30]
006a6e89 : JA 0x006a6fca
006a6e8f : MOVSX DX,byte ptr [ESI]
006a6e93 : MOVZX EBX,byte ptr [ESI + 0x1]
006a6e97 : ADD ESI,0x2
006a6e9a : SHL DX,0x8
006a6e9e : MOVSX EDX,DX
006a6ea1 : ADD ECX,0x2
006a6ea4 : ADD EDI,0x2
006a6ea7 : ADD EAX,0x2
006a6eaa : OR EDX,EBX
006a6eac : MOV dword ptr [ESP + 0x18],EDX
006a6eb0 : MOV EDX,dword ptr [ESP + 0x14]
006a6eb4 : MOV EBX,dword ptr [ESP + 0x2c]
006a6eb8 : SHR EBX,0x2
006a6ebb : AND EBX,0x3
006a6ebe : SUB EBX,0x1
006a6ec1 : JZ 0x006a6edb
006a6ec3 : SUB EBX,0x1
006a6ec6 : JNZ 0x006a6f02
006a6ec8 : CMP ECX,dword ptr [ESP + 0x30]
006a6ecc : JA 0x006a6fca
006a6ed2 : MOVSX EDX,byte ptr [ESI]
006a6ed5 : INC ESI
006a6ed6 : INC ECX
006a6ed7 : INC EDI
006a6ed8 : INC EAX
006a6ed9 : JMP 0x006a6f02
006a6edb : CMP EAX,dword ptr [ESP + 0x30]
006a6edf : JA 0x006a6fca
006a6ee5 : MOVSX DX,byte ptr [ESI]
006a6ee9 : MOVZX EBX,byte ptr [ESI + 0x1]
006a6eed : ADD ESI,0x2
006a6ef0 : SHL DX,0x8
006a6ef4 : MOVSX EDX,DX
006a6ef7 : ADD ECX,0x2
006a6efa : ADD EDI,0x2
006a6efd : ADD EAX,0x2
006a6f00 : OR EDX,EBX
006a6f02 : TEST byte ptr [ESP + 0x2c],0x40
006a6f07 : MOV EBX,dword ptr [ESP + 0x18]
006a6f0b : MOV dword ptr [EBP + 0x8],EBX
006a6f0e : MOV dword ptr [EBP + 0xc],EDX
006a6f11 : JZ 0x006a6f43
006a6f13 : CMP EAX,dword ptr [ESP + 0x30]
006a6f17 : JA 0x006a6fca
006a6f1d : MOVZX DX,byte ptr [ESI]
006a6f21 : MOVZX EBX,byte ptr [ESI + 0x1]
006a6f25 : ADD ESI,0x2
006a6f28 : SHL DX,0x8
006a6f2c : MOVZX EDX,DX
006a6f2f : ADD ECX,0x2
006a6f32 : ADD EDI,0x2
006a6f35 : ADD EAX,0x2
006a6f38 : OR EDX,EBX
006a6f3a : MOV dword ptr [EBP + 0x14],EDX
006a6f3d : MOV EDX,dword ptr [ESP + 0x30]
006a6f41 : JMP 0x006a6f55
006a6f43 : MOV EDX,dword ptr [ESP + 0x30]
006a6f47 : CMP ECX,EDX
006a6f49 : JA 0x006a6fca
006a6f4b : MOVZX EBX,byte ptr [ESI]
006a6f4e : INC ESI
006a6f4f : INC ECX
006a6f50 : INC EDI
006a6f51 : MOV dword ptr [EBP + 0x14],EBX
006a6f54 : INC EAX
006a6f55 : TEST byte ptr [ESP + 0x2c],0x80
006a6f5a : JZ 0x006a6f7d
006a6f5c : CMP EDI,EDX
006a6f5e : JA 0x006a6fca
006a6f60 : MOVSX EDX,byte ptr [ESI]
006a6f63 : MOVZX EBX,byte ptr [ESI + 0x1]
006a6f67 : ADD ESI,0x3
006a6f6a : SHL EDX,0x8
006a6f6d : OR EDX,EBX
006a6f6f : ADD ECX,0x3
006a6f72 : ADD EDI,0x3
006a6f75 : ADD EAX,0x3
006a6f78 : SHL EDX,0x8
006a6f7b : JMP 0x006a6f98
006a6f7d : CMP EAX,EDX
006a6f7f : JA 0x006a6fca
006a6f81 : MOVZX DX,byte ptr [ESI]
006a6f85 : ADD ESI,0x2
006a6f88 : ADD ECX,0x2
006a6f8b : ADD EDI,0x2
006a6f8e : ADD EAX,0x2
006a6f91 : SHL DX,0x8
006a6f95 : MOVZX EDX,DX
006a6f98 : MOVZX EBX,byte ptr [ESI + -0x1]
006a6f9c : OR EDX,EBX
006a6f9e : MOV dword ptr [EBP + 0x10],EDX
006a6fa1 : MOV EDX,dword ptr [ESP + 0x28]
006a6fa5 : INC dword ptr [EDX + 0x10]
006a6fa8 : MOV EDX,dword ptr [ESP + 0x20]
006a6fac : INC EDX
006a6fad : ADD EBP,0x18
006a6fb0 : MOV dword ptr [ESP + 0x20],EDX
006a6fb4 : CMP EDX,dword ptr [ESP + 0x1c]
006a6fb8 : JC 0x006a6dc0
006a6fbe : MOV EAX,dword ptr [ESP + 0x10]
006a6fc2 : POP EDI
006a6fc3 : POP ESI
006a6fc4 : POP EBP
006a6fc5 : POP EBX
006a6fc6 : ADD ESP,0x14
006a6fc9 : RET
006a6fca : MOV EAX,0x8
006a6fcf : POP EDI
006a6fd0 : POP ESI
006a6fd1 : POP EBP
006a6fd2 : POP EBX
006a6fd3 : ADD ESP,0x14
006a6fd6 : RET

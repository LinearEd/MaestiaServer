PROGRAM  : Maestia.exe
FUNCTION : FUN_0060f6b0
ENTRY    : 0060f6b0
BODY     : [[0060f6b0, 0060f849] [0060f850, 0060f98c] [0060f990, 0060fa23]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0060f6b0(int param_1,uint param_2,int param_3,uint param_4)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  int in_ECX;
  uint uVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int local_18;
  int local_4;
  
  iVar2 = param_3 - param_1;
  iVar5 = param_3 >> 8;
  iVar8 = param_4 - param_2;
  iVar7 = param_1 >> 8;
  iVar6 = (int)param_4 >> 8;
  uVar4 = param_2 & 0xff;
  uVar3 = param_4 & 0xff;
  iVar9 = (int)param_2 >> 8;
  if (iVar7 < *(int *)(in_ECX + 0x4c)) {
    *(int *)(in_ECX + 0x4c) = iVar7;
  }
  if (*(int *)(in_ECX + 0x54) < iVar7) {
    *(int *)(in_ECX + 0x54) = iVar7;
  }
  if (iVar9 < *(int *)(in_ECX + 0x50)) {
    *(int *)(in_ECX + 0x50) = iVar9;
  }
  if (*(int *)(in_ECX + 0x58) < iVar9) {
    *(int *)(in_ECX + 0x58) = iVar9;
  }
  if (iVar5 < *(int *)(in_ECX + 0x4c)) {
    *(int *)(in_ECX + 0x4c) = iVar5;
  }
  if (*(int *)(in_ECX + 0x54) < iVar5) {
    *(int *)(in_ECX + 0x54) = iVar5;
  }
  if (iVar6 < *(int *)(in_ECX + 0x50)) {
    *(int *)(in_ECX + 0x50) = iVar6;
  }
  if (*(int *)(in_ECX + 0x58) < iVar6) {
    *(int *)(in_ECX + 0x58) = iVar6;
  }
  if (*(int *)(in_ECX + 0x40) != iVar9 || *(int *)(in_ECX + 0x3c) != iVar7) {
    if (*(int *)(in_ECX + 0x44) != 0 || *(int *)(in_ECX + 0x48) != 0) {
      FUN_0060f3e0(in_ECX + 0x3c);
    }
    *(int *)(in_ECX + 0x3c) = iVar7;
    *(int *)(in_ECX + 0x40) = iVar9;
    *(undefined4 *)(in_ECX + 0x44) = 0;
    *(undefined4 *)(in_ECX + 0x48) = 0;
  }
  if (iVar9 != iVar6) {
    local_18 = 1;
    param_4 = 0x100;
    if (iVar2 != 0) {
      uVar1 = 0x100 - uVar4;
      if (iVar8 < 0) {
        iVar8 = -iVar8;
        param_4 = 0;
        local_18 = -1;
        uVar1 = uVar4;
      }
      iVar5 = (int)(uVar1 * iVar2) / iVar8;
      param_2 = (int)(uVar1 * iVar2) % iVar8;
      if ((int)param_2 < 0) {
        iVar5 = iVar5 + -1;
        param_2 = param_2 + iVar8;
      }
      iVar5 = iVar5 + param_1;
      FUN_0060f4a0(iVar9,param_1,uVar4,iVar5,param_4);
      iVar9 = iVar9 + local_18;
      if (*(int *)(in_ECX + 0x3c) != iVar5 >> 8 || *(int *)(in_ECX + 0x40) != iVar9) {
        if (*(int *)(in_ECX + 0x44) != 0 || *(int *)(in_ECX + 0x48) != 0) {
          FUN_0060f3e0(in_ECX + 0x3c);
        }
        *(int *)(in_ECX + 0x3c) = iVar5 >> 8;
        *(int *)(in_ECX + 0x40) = iVar9;
        *(undefined4 *)(in_ECX + 0x44) = 0;
        *(undefined4 *)(in_ECX + 0x48) = 0;
      }
      if (iVar9 != iVar6) {
        iVar7 = (iVar2 * 0x100) / iVar8;
        local_4 = (iVar2 * 0x100) % iVar8;
        if (local_4 < 0) {
          iVar7 = iVar7 + -1;
          local_4 = local_4 + iVar8;
        }
        param_2 = param_2 - iVar8;
        iVar2 = iVar5;
        do {
          param_2 = param_2 + local_4;
          iVar5 = iVar7;
          if (-1 < (int)param_2) {
            param_2 = param_2 - iVar8;
            iVar5 = iVar7 + 1;
          }
          iVar5 = iVar5 + iVar2;
          FUN_0060f4a0(iVar9,iVar2,0x100 - param_4,iVar5,param_4);
          iVar9 = iVar9 + local_18;
          if (*(int *)(in_ECX + 0x3c) != iVar5 >> 8 || *(int *)(in_ECX + 0x40) != iVar9) {
            if (*(int *)(in_ECX + 0x44) != 0 || *(int *)(in_ECX + 0x48) != 0) {
              FUN_0060f3e0(in_ECX + 0x3c);
            }
            *(int *)(in_ECX + 0x3c) = iVar5 >> 8;
            *(int *)(in_ECX + 0x40) = iVar9;
            *(undefined4 *)(in_ECX + 0x44) = 0;
            *(undefined4 *)(in_ECX + 0x48) = 0;
          }
          iVar2 = iVar5;
        } while (iVar9 != iVar6);
      }
      FUN_0060f4a0(iVar9,iVar5,0x100 - param_4,param_3,uVar3);
      return;
    }
    iVar2 = (param_1 + iVar7 * -0x100) * 2;
    if (iVar8 < 0) {
      param_4 = 0;
      local_18 = -1;
    }
    iVar9 = iVar9 + local_18;
    *(int *)(in_ECX + 0x44) = *(int *)(in_ECX + 0x44) + (param_4 - uVar4);
    *(int *)(in_ECX + 0x48) = *(int *)(in_ECX + 0x48) + (param_4 - uVar4) * iVar2;
    if (*(int *)(in_ECX + 0x3c) != iVar7 || *(int *)(in_ECX + 0x40) != iVar9) {
      if (*(int *)(in_ECX + 0x48) != 0 || *(int *)(in_ECX + 0x44) != 0) {
        FUN_0060f3e0((int *)(in_ECX + 0x3c));
      }
      *(int *)(in_ECX + 0x3c) = iVar7;
      *(int *)(in_ECX + 0x40) = iVar9;
      *(undefined4 *)(in_ECX + 0x44) = 0;
      *(undefined4 *)(in_ECX + 0x48) = 0;
    }
    iVar5 = param_4 * 2 + -0x100;
    while (iVar9 != iVar6) {
      iVar9 = iVar9 + local_18;
      *(int *)(in_ECX + 0x44) = iVar5;
      *(int *)(in_ECX + 0x48) = iVar5 * iVar2;
      if (*(int *)(in_ECX + 0x3c) != iVar7 || *(int *)(in_ECX + 0x40) != iVar9) {
        if (iVar5 * iVar2 != 0 || iVar5 != 0) {
          FUN_0060f3e0((int *)(in_ECX + 0x3c));
        }
        *(int *)(in_ECX + 0x3c) = iVar7;
        *(int *)(in_ECX + 0x40) = iVar9;
        *(undefined4 *)(in_ECX + 0x44) = 0;
        *(undefined4 *)(in_ECX + 0x48) = 0;
      }
    }
    iVar9 = param_4 + -0x100 + uVar3;
    *(int *)(in_ECX + 0x44) = *(int *)(in_ECX + 0x44) + iVar9;
    *(int *)(in_ECX + 0x48) = *(int *)(in_ECX + 0x48) + iVar9 * iVar2;
    return;
  }
  FUN_0060f4a0(iVar9,param_1,uVar4,param_3,uVar3);
  return;
}



============================================================
DISASSEMBLY
============================================================
0060f6b0 : SUB ESP,0x18
0060f6b3 : MOV EDX,dword ptr [ESP + 0x24]
0060f6b7 : PUSH EBX
0060f6b8 : MOV EBX,dword ptr [ESP + 0x20]
0060f6bc : MOV EAX,EDX
0060f6be : SUB EAX,EBX
0060f6c0 : PUSH EBP
0060f6c1 : SAR EDX,0x8
0060f6c4 : PUSH ESI
0060f6c5 : MOV ESI,ECX
0060f6c7 : MOV ECX,dword ptr [ESP + 0x2c]
0060f6cb : MOV dword ptr [ESP + 0x20],EAX
0060f6cf : MOV EAX,dword ptr [ESP + 0x34]
0060f6d3 : PUSH EDI
0060f6d4 : MOV EBP,EAX
0060f6d6 : MOV dword ptr [ESP + 0x38],EDX
0060f6da : SUB EBP,ECX
0060f6dc : MOV EDI,ECX
0060f6de : MOV EDX,EAX
0060f6e0 : SAR EBX,0x8
0060f6e3 : SAR EDX,0x8
0060f6e6 : AND ECX,0xff
0060f6ec : AND EAX,0xff
0060f6f1 : SAR EDI,0x8
0060f6f4 : CMP EBX,dword ptr [ESI + 0x4c]
0060f6f7 : MOV dword ptr [ESP + 0x1c],EBP
0060f6fb : MOV dword ptr [ESP + 0x14],EDX
0060f6ff : MOV dword ptr [ESP + 0x18],ECX
0060f703 : MOV dword ptr [ESP + 0x20],EAX
0060f707 : JGE 0x0060f70c
0060f709 : MOV dword ptr [ESI + 0x4c],EBX
0060f70c : CMP EBX,dword ptr [ESI + 0x54]
0060f70f : JLE 0x0060f714
0060f711 : MOV dword ptr [ESI + 0x54],EBX
0060f714 : CMP EDI,dword ptr [ESI + 0x50]
0060f717 : JGE 0x0060f71c
0060f719 : MOV dword ptr [ESI + 0x50],EDI
0060f71c : CMP EDI,dword ptr [ESI + 0x58]
0060f71f : JLE 0x0060f724
0060f721 : MOV dword ptr [ESI + 0x58],EDI
0060f724 : MOV EAX,dword ptr [ESP + 0x38]
0060f728 : CMP EAX,dword ptr [ESI + 0x4c]
0060f72b : JGE 0x0060f730
0060f72d : MOV dword ptr [ESI + 0x4c],EAX
0060f730 : CMP EAX,dword ptr [ESI + 0x54]
0060f733 : JLE 0x0060f738
0060f735 : MOV dword ptr [ESI + 0x54],EAX
0060f738 : CMP EDX,dword ptr [ESI + 0x50]
0060f73b : JGE 0x0060f740
0060f73d : MOV dword ptr [ESI + 0x50],EDX
0060f740 : CMP EDX,dword ptr [ESI + 0x58]
0060f743 : JLE 0x0060f748
0060f745 : MOV dword ptr [ESI + 0x58],EDX
0060f748 : MOV EAX,dword ptr [ESI + 0x40]
0060f74b : MOV EDX,dword ptr [ESI + 0x3c]
0060f74e : LEA ECX,[ESI + 0x3c]
0060f751 : SUB EAX,EDI
0060f753 : SUB EDX,EBX
0060f755 : OR EAX,EDX
0060f757 : JZ 0x0060f77a
0060f759 : MOV EAX,dword ptr [ESI + 0x44]
0060f75c : OR EAX,dword ptr [ESI + 0x48]
0060f75f : JZ 0x0060f76a
0060f761 : PUSH ECX
0060f762 : LEA ECX,[ESI + 0x14]
0060f765 : CALL 0x0060f3e0
0060f76a : XOR EAX,EAX
0060f76c : LEA ECX,[ESI + 0x3c]
0060f76f : MOV dword ptr [ECX],EBX
0060f771 : MOV dword ptr [ESI + 0x40],EDI
0060f774 : MOV dword ptr [ESI + 0x44],EAX
0060f777 : MOV dword ptr [ESI + 0x48],EAX
0060f77a : CMP EDI,dword ptr [ESP + 0x14]
0060f77e : JNZ 0x0060f7a6
0060f780 : MOV ECX,dword ptr [ESP + 0x20]
0060f784 : MOV EDX,dword ptr [ESP + 0x34]
0060f788 : MOV EAX,dword ptr [ESP + 0x18]
0060f78c : PUSH ECX
0060f78d : MOV ECX,dword ptr [ESP + 0x30]
0060f791 : PUSH EDX
0060f792 : PUSH EAX
0060f793 : PUSH ECX
0060f794 : PUSH EDI
0060f795 : MOV ECX,ESI
0060f797 : CALL 0x0060f4a0
0060f79c : POP EDI
0060f79d : POP ESI
0060f79e : POP EBP
0060f79f : POP EBX
0060f7a0 : ADD ESP,0x18
0060f7a3 : RET 0x10
0060f7a6 : MOV EDX,dword ptr [ESP + 0x24]
0060f7aa : MOV dword ptr [ESP + 0x10],0x1
0060f7b2 : MOV dword ptr [ESP + 0x38],0x100
0060f7ba : TEST EDX,EDX
0060f7bc : JNZ 0x0060f8b6
0060f7c2 : MOV EAX,dword ptr [ESP + 0x2c]
0060f7c6 : MOV EDX,EBX
0060f7c8 : SHL EDX,0x8
0060f7cb : SUB EAX,EDX
0060f7cd : ADD EAX,EAX
0060f7cf : MOV EDX,EAX
0060f7d1 : MOV dword ptr [ESP + 0x34],EDX
0060f7d5 : TEST EBP,EBP
0060f7d7 : JGE 0x0060f7e9
0060f7d9 : MOV dword ptr [ESP + 0x38],0x0
0060f7e1 : MOV dword ptr [ESP + 0x10],0xffffffff
0060f7e9 : MOV EAX,dword ptr [ESP + 0x38]
0060f7ed : SUB EAX,dword ptr [ESP + 0x18]
0060f7f1 : ADD EDI,dword ptr [ESP + 0x10]
0060f7f5 : ADD dword ptr [ESI + 0x44],EAX
0060f7f8 : IMUL EAX,EDX
0060f7fb : MOV EDX,dword ptr [ECX]
0060f7fd : MOV EBP,dword ptr [ESI + 0x40]
0060f800 : ADD dword ptr [ESI + 0x48],EAX
0060f803 : MOV EAX,dword ptr [ESI + 0x48]
0060f806 : SUB EDX,EBX
0060f808 : SUB EBP,EDI
0060f80a : OR EDX,EBP
0060f80c : JZ 0x0060f82c
0060f80e : OR EAX,dword ptr [ESI + 0x44]
0060f811 : JZ 0x0060f81c
0060f813 : PUSH ECX
0060f814 : LEA ECX,[ESI + 0x14]
0060f817 : CALL 0x0060f3e0
0060f81c : XOR EAX,EAX
0060f81e : LEA ECX,[ESI + 0x3c]
0060f821 : MOV dword ptr [ECX],EBX
0060f823 : MOV dword ptr [ESI + 0x40],EDI
0060f826 : MOV dword ptr [ESI + 0x44],EAX
0060f829 : MOV dword ptr [ESI + 0x48],EAX
0060f82c : MOV EAX,dword ptr [ESP + 0x38]
0060f830 : LEA EAX,[EAX + EAX*0x1 + 0xffffff00]
0060f837 : MOV EBP,EAX
0060f839 : IMUL EBP,dword ptr [ESP + 0x34]
0060f83e : MOV dword ptr [ESP + 0x2c],EAX
0060f842 : CMP EDI,dword ptr [ESP + 0x14]
0060f846 : JZ 0x0060f892
0060f848 : JMP 0x0060f854
0060f850 : MOV EAX,dword ptr [ESP + 0x2c]
0060f854 : ADD EDI,dword ptr [ESP + 0x10]
0060f858 : MOV EDX,dword ptr [ESI + 0x40]
0060f85b : MOV dword ptr [ESI + 0x44],EAX
0060f85e : MOV EAX,dword ptr [ECX]
0060f860 : SUB EAX,EBX
0060f862 : SUB EDX,EDI
0060f864 : OR EAX,EDX
0060f866 : MOV dword ptr [ESI + 0x48],EBP
0060f869 : JZ 0x0060f88c
0060f86b : MOV EAX,EBP
0060f86d : OR EAX,dword ptr [ESP + 0x2c]
0060f871 : JZ 0x0060f87c
0060f873 : PUSH ECX
0060f874 : LEA ECX,[ESI + 0x14]
0060f877 : CALL 0x0060f3e0
0060f87c : XOR EAX,EAX
0060f87e : LEA ECX,[ESI + 0x3c]
0060f881 : MOV dword ptr [ECX],EBX
0060f883 : MOV dword ptr [ESI + 0x40],EDI
0060f886 : MOV dword ptr [ESI + 0x44],EAX
0060f889 : MOV dword ptr [ESI + 0x48],EAX
0060f88c : CMP EDI,dword ptr [ESP + 0x14]
0060f890 : JNZ 0x0060f850
0060f892 : MOV ECX,dword ptr [ESP + 0x20]
0060f896 : MOV EDX,dword ptr [ESP + 0x38]
0060f89a : LEA EAX,[EDX + ECX*0x1 + 0xffffff00]
0060f8a1 : ADD dword ptr [ESI + 0x44],EAX
0060f8a4 : IMUL EAX,dword ptr [ESP + 0x34]
0060f8a9 : ADD dword ptr [ESI + 0x48],EAX
0060f8ac : POP EDI
0060f8ad : POP ESI
0060f8ae : POP EBP
0060f8af : POP EBX
0060f8b0 : ADD ESP,0x18
0060f8b3 : RET 0x10
0060f8b6 : MOV ECX,dword ptr [ESP + 0x18]
0060f8ba : MOV EAX,0x100
0060f8bf : SUB EAX,ECX
0060f8c1 : IMUL EAX,EDX
0060f8c4 : TEST EBP,EBP
0060f8c6 : JGE 0x0060f8e3
0060f8c8 : MOV EAX,ECX
0060f8ca : IMUL EAX,EDX
0060f8cd : NEG EBP
0060f8cf : MOV dword ptr [ESP + 0x38],0x0
0060f8d7 : MOV dword ptr [ESP + 0x10],0xffffffff
0060f8df : MOV dword ptr [ESP + 0x1c],EBP
0060f8e3 : CDQ
0060f8e4 : IDIV EBP
0060f8e6 : MOV ECX,EDX
0060f8e8 : MOV dword ptr [ESP + 0x30],EDX
0060f8ec : TEST ECX,ECX
0060f8ee : JGE 0x0060f8f7
0060f8f0 : DEC EAX
0060f8f1 : ADD ECX,EBP
0060f8f3 : MOV dword ptr [ESP + 0x30],ECX
0060f8f7 : MOV ECX,dword ptr [ESP + 0x2c]
0060f8fb : MOV EDX,dword ptr [ESP + 0x38]
0060f8ff : PUSH EDX
0060f900 : LEA EBP,[EAX + ECX*0x1]
0060f903 : MOV EAX,dword ptr [ESP + 0x1c]
0060f907 : PUSH EBP
0060f908 : PUSH EAX
0060f909 : PUSH ECX
0060f90a : PUSH EDI
0060f90b : MOV ECX,ESI
0060f90d : CALL 0x0060f4a0
0060f912 : ADD EDI,dword ptr [ESP + 0x10]
0060f916 : MOV EDX,dword ptr [ESI + 0x3c]
0060f919 : MOV ECX,dword ptr [ESI + 0x40]
0060f91c : MOV EBX,EBP
0060f91e : LEA EAX,[ESI + 0x3c]
0060f921 : SAR EBX,0x8
0060f924 : SUB EDX,EBX
0060f926 : SUB ECX,EDI
0060f928 : OR EDX,ECX
0060f92a : JZ 0x0060f94b
0060f92c : MOV EDX,dword ptr [ESI + 0x44]
0060f92f : OR EDX,dword ptr [ESI + 0x48]
0060f932 : JZ 0x0060f93d
0060f934 : PUSH EAX
0060f935 : LEA ECX,[ESI + 0x14]
0060f938 : CALL 0x0060f3e0
0060f93d : XOR EAX,EAX
0060f93f : MOV dword ptr [ESI + 0x3c],EBX
0060f942 : MOV dword ptr [ESI + 0x40],EDI
0060f945 : MOV dword ptr [ESI + 0x44],EAX
0060f948 : MOV dword ptr [ESI + 0x48],EAX
0060f94b : CMP EDI,dword ptr [ESP + 0x14]
0060f94f : JZ 0x0060f9fd
0060f955 : MOV EAX,dword ptr [ESP + 0x24]
0060f959 : MOV ECX,dword ptr [ESP + 0x1c]
0060f95d : SHL EAX,0x8
0060f960 : CDQ
0060f961 : IDIV ECX
0060f963 : MOV dword ptr [ESP + 0x2c],EAX
0060f967 : MOV dword ptr [ESP + 0x24],EDX
0060f96b : TEST EDX,EDX
0060f96d : JGE 0x0060f97a
0060f96f : DEC EAX
0060f970 : ADD EDX,ECX
0060f972 : MOV dword ptr [ESP + 0x2c],EAX
0060f976 : MOV dword ptr [ESP + 0x24],EDX
0060f97a : SUB dword ptr [ESP + 0x30],ECX
0060f97e : MOV EDX,0x100
0060f983 : SUB EDX,dword ptr [ESP + 0x38]
0060f987 : MOV dword ptr [ESP + 0x18],EDX
0060f98b : JMP 0x0060f99c
0060f990 : MOV EAX,dword ptr [ESP + 0x2c]
0060f994 : MOV ECX,dword ptr [ESP + 0x1c]
0060f998 : MOV EDX,dword ptr [ESP + 0x18]
0060f99c : MOV EBX,dword ptr [ESP + 0x24]
0060f9a0 : ADD dword ptr [ESP + 0x30],EBX
0060f9a4 : JS 0x0060f9ab
0060f9a6 : SUB dword ptr [ESP + 0x30],ECX
0060f9aa : INC EAX
0060f9ab : LEA EBX,[EAX + EBP*0x1]
0060f9ae : MOV EAX,dword ptr [ESP + 0x38]
0060f9b2 : PUSH EAX
0060f9b3 : PUSH EBX
0060f9b4 : PUSH EDX
0060f9b5 : PUSH EBP
0060f9b6 : PUSH EDI
0060f9b7 : MOV ECX,ESI
0060f9b9 : CALL 0x0060f4a0
0060f9be : ADD EDI,dword ptr [ESP + 0x10]
0060f9c2 : MOV ECX,dword ptr [ESI + 0x3c]
0060f9c5 : MOV EDX,dword ptr [ESI + 0x40]
0060f9c8 : LEA EAX,[ESI + 0x3c]
0060f9cb : MOV EBP,EBX
0060f9cd : SAR EBX,0x8
0060f9d0 : SUB ECX,EBX
0060f9d2 : SUB EDX,EDI
0060f9d4 : OR ECX,EDX
0060f9d6 : JZ 0x0060f9f7
0060f9d8 : MOV ECX,dword ptr [ESI + 0x44]
0060f9db : OR ECX,dword ptr [ESI + 0x48]
0060f9de : JZ 0x0060f9e9
0060f9e0 : PUSH EAX
0060f9e1 : LEA ECX,[ESI + 0x14]
0060f9e4 : CALL 0x0060f3e0
0060f9e9 : XOR EAX,EAX
0060f9eb : MOV dword ptr [ESI + 0x3c],EBX
0060f9ee : MOV dword ptr [ESI + 0x40],EDI
0060f9f1 : MOV dword ptr [ESI + 0x44],EAX
0060f9f4 : MOV dword ptr [ESI + 0x48],EAX
0060f9f7 : CMP EDI,dword ptr [ESP + 0x14]
0060f9fb : JNZ 0x0060f990
0060f9fd : MOV EDX,dword ptr [ESP + 0x20]
0060fa01 : MOV EAX,dword ptr [ESP + 0x34]
0060fa05 : PUSH EDX
0060fa06 : PUSH EAX
0060fa07 : MOV ECX,0x100
0060fa0c : SUB ECX,dword ptr [ESP + 0x40]
0060fa10 : PUSH ECX
0060fa11 : PUSH EBP
0060fa12 : PUSH EDI
0060fa13 : MOV ECX,ESI
0060fa15 : CALL 0x0060f4a0
0060fa1a : POP EDI
0060fa1b : POP ESI
0060fa1c : POP EBP
0060fa1d : POP EBX
0060fa1e : ADD ESP,0x18
0060fa21 : RET 0x10

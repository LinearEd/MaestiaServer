PROGRAM  : Maestia.exe
FUNCTION : FUN_00663030
ENTRY    : 00663030
BODY     : [[00663030, 00663072]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00663030(void)

{
  int *piVar1;
  int iVar2;
  int in_ECX;
  
  while (piVar1 = *(int **)(in_ECX + 0x28), piVar1 != (int *)0x0) {
    iVar2 = piVar1[7];
    *(int *)(in_ECX + 0x2c) = *(int *)(in_ECX + 0x2c) + -1;
    *(int *)(in_ECX + 0x28) = iVar2;
    (**(code **)(*piVar1 + 0x54))(1);
  }
  *(undefined4 *)(in_ECX + 0x3c) = 0;
  if (*(LPVOID *)(in_ECX + 0x60) != (LPVOID)0x0) {
    VirtualFree(*(LPVOID *)(in_ECX + 0x60),0,0x8000);
    *(undefined4 *)(in_ECX + 0x60) = 0;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00663030 : PUSH ESI
00663031 : MOV ESI,ECX
00663033 : MOV ECX,dword ptr [ESI + 0x28]
00663036 : TEST ECX,ECX
00663038 : JZ 0x0066304e
0066303a : MOV EAX,dword ptr [ECX + 0x1c]
0066303d : DEC dword ptr [ESI + 0x2c]
00663040 : MOV dword ptr [ESI + 0x28],EAX
00663043 : MOV EDX,dword ptr [ECX]
00663045 : MOV EAX,dword ptr [EDX + 0x54]
00663048 : PUSH 0x1
0066304a : CALL EAX
0066304c : JMP 0x00663033
0066304e : MOV EAX,dword ptr [ESI + 0x60]
00663051 : MOV dword ptr [ESI + 0x3c],0x0
00663058 : TEST EAX,EAX
0066305a : JZ 0x00663071
0066305c : PUSH 0x8000
00663061 : PUSH 0x0
00663063 : PUSH EAX
00663064 : CALL dword ptr [0x00b8524c]
0066306a : MOV dword ptr [ESI + 0x60],0x0
00663071 : POP ESI
00663072 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_006964d0
ENTRY    : 006964d0
BODY     : [[006964d0, 006967b5]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006964d0(int param_1,uint param_2)

{
  uint uVar1;
  int iVar2;
  undefined2 uVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  undefined2 *puVar7;
  int iVar8;
  undefined4 uVar9;
  int iVar10;
  int *piVar11;
  int local_8;
  undefined4 local_4;
  
  iVar2 = param_2;
  local_4 = *(undefined4 *)(param_2 + 0x1c);
  local_8 = 0;
  *(undefined4 *)(param_1 + 0x264) = 0;
  local_8 = (**(code **)(param_1 + 0x1fc))(param_1,0x45424c43,param_2,0);
  if ((local_8 == 0) ||
     (local_8 = (**(code **)(param_1 + 0x1fc))(param_1,0x626c6f63,param_2,0), local_8 == 0)) {
    iVar4 = FUN_00687830(param_2);
    local_8 = FUN_00688900(param_2,8);
    if (local_8 == 0) {
      iVar5 = FUN_006879a0(param_2);
      uVar6 = FUN_006879a0(param_2);
      FUN_006889b0(param_2);
      if ((iVar5 != 0x20000) || (0xffff < uVar6)) {
        return 3;
      }
      iVar5 = FUN_0068a220(local_4,0x30,0,uVar6,0,&local_8);
      *(int *)(param_1 + 0x268) = iVar5;
      if (local_8 == 0) {
        *(uint *)(param_1 + 0x264) = uVar6;
        local_8 = FUN_00688900(param_2,uVar6 * 0x30);
        uVar1 = uVar6;
        if (local_8 == 0) {
          while ((((uVar1 != 0 &&
                   (local_8 = FUN_006889e0(param_2,&DAT_00bd9844,iVar5), local_8 == 0)) &&
                  (local_8 = FUN_006889e0(param_2,&DAT_00bd9810,iVar5 + 0x10), local_8 == 0)) &&
                 ((local_8 = FUN_006889e0(param_2,&DAT_00bd9810,iVar5 + 0x1c), local_8 == 0 &&
                  (local_8 = FUN_006889e0(param_2,&DAT_00bd9858,iVar5), local_8 == 0))))) {
            iVar5 = iVar5 + 0x30;
            uVar1 = uVar1 - 1;
          }
          FUN_006889b0(param_2);
          piVar11 = *(int **)(param_1 + 0x268);
          param_2 = uVar6;
          if (uVar6 != 0) {
            while( true ) {
              iVar5 = *piVar11;
              local_8 = FUN_006877c0(iVar2,piVar11[2] + iVar4);
              if ((local_8 != 0) || (local_8 = FUN_00688900(iVar2,*piVar11 * 8), local_8 != 0))
              break;
              puVar7 = (undefined2 *)FUN_0068a220(local_4,0x28,0,*piVar11,0,&local_8);
              piVar11[1] = (int)puVar7;
              if (local_8 != 0) {
                return local_8;
              }
              local_8 = 0;
              for (; iVar5 != 0; iVar5 = iVar5 + -1) {
                uVar3 = FUN_00687940(iVar2);
                *puVar7 = uVar3;
                uVar3 = FUN_00687940(iVar2);
                puVar7[1] = uVar3;
                iVar8 = FUN_006879a0(iVar2);
                *(int *)(puVar7 + 0x12) = iVar8 + piVar11[2] + iVar4;
                puVar7 = puVar7 + 0x14;
              }
              FUN_006889b0(iVar2);
              iVar5 = *piVar11;
              iVar8 = piVar11[1];
              if (iVar5 != 0) {
                do {
                  local_8 = FUN_006877c0(iVar2,*(undefined4 *)(iVar8 + 0x24));
                  if (local_8 != 0) {
                    return local_8;
                  }
                  local_8 = FUN_00688900(iVar2,8);
                  if (local_8 != 0) {
                    return local_8;
                  }
                  uVar3 = FUN_00687940(iVar2);
                  *(undefined2 *)(iVar8 + 4) = uVar3;
                  uVar3 = FUN_00687940(iVar2);
                  *(undefined2 *)(iVar8 + 6) = uVar3;
                  uVar9 = FUN_006879a0(iVar2);
                  *(undefined4 *)(iVar8 + 8) = uVar9;
                  FUN_006889b0(iVar2);
                  iVar10 = FUN_00696380();
                  if (iVar10 != 0) {
                    return iVar10;
                  }
                  iVar5 = iVar5 + -1;
                  iVar8 = iVar8 + 0x28;
                  local_8 = 0;
                } while (iVar5 != 0);
                local_8 = 0;
              }
              param_2 = param_2 - 1;
              piVar11 = piVar11 + 0xc;
              if (param_2 == 0) {
                return local_8;
              }
            }
          }
        }
      }
    }
  }
  return local_8;
}



============================================================
DISASSEMBLY
============================================================
006964d0 : SUB ESP,0x8
006964d3 : PUSH EBX
006964d4 : PUSH ESI
006964d5 : MOV ESI,dword ptr [ESP + 0x18]
006964d9 : MOV EAX,dword ptr [ESI + 0x1c]
006964dc : PUSH EDI
006964dd : MOV EDI,dword ptr [ESP + 0x18]
006964e1 : MOV ECX,dword ptr [EDI + 0x1fc]
006964e7 : XOR EBX,EBX
006964e9 : PUSH EBX
006964ea : PUSH ESI
006964eb : PUSH 0x45424c43
006964f0 : PUSH EDI
006964f1 : MOV dword ptr [ESP + 0x1c],EBX
006964f5 : MOV dword ptr [ESP + 0x20],EAX
006964f9 : MOV dword ptr [EDI + 0x264],EBX
006964ff : CALL ECX
00696501 : ADD ESP,0x10
00696504 : MOV dword ptr [ESP + 0xc],EAX
00696508 : CMP EAX,EBX
0069650a : JZ 0x0069652b
0069650c : MOV EDX,dword ptr [EDI + 0x1fc]
00696512 : PUSH EBX
00696513 : PUSH ESI
00696514 : PUSH 0x626c6f63
00696519 : PUSH EDI
0069651a : CALL EDX
0069651c : ADD ESP,0x10
0069651f : MOV dword ptr [ESP + 0xc],EAX
00696523 : CMP EAX,EBX
00696525 : JNZ 0x006967af
0069652b : PUSH ESI
0069652c : CALL 0x00687830
00696531 : PUSH 0x8
00696533 : PUSH ESI
00696534 : MOV dword ptr [ESP + 0x24],EAX
00696538 : CALL 0x00688900
0069653d : ADD ESP,0xc
00696540 : MOV dword ptr [ESP + 0xc],EAX
00696544 : CMP EAX,EBX
00696546 : JNZ 0x006967af
0069654c : PUSH EBP
0069654d : PUSH ESI
0069654e : CALL 0x006879a0
00696553 : PUSH ESI
00696554 : MOV EBX,EAX
00696556 : CALL 0x006879a0
0069655b : PUSH ESI
0069655c : MOV EBP,EAX
0069655e : CALL 0x006889b0
00696563 : ADD ESP,0xc
00696566 : CMP EBX,0x20000
0069656c : JNZ 0x0069679d
00696572 : CMP EBP,0x10000
00696578 : JNC 0x0069679d
0069657e : MOV ECX,dword ptr [ESP + 0x14]
00696582 : LEA EAX,[ESP + 0x10]
00696586 : PUSH EAX
00696587 : PUSH 0x0
00696589 : PUSH EBP
0069658a : PUSH 0x0
0069658c : PUSH 0x30
0069658e : PUSH ECX
0069658f : CALL 0x0068a220
00696594 : MOV EBX,EAX
00696596 : MOV EAX,dword ptr [ESP + 0x28]
0069659a : ADD ESP,0x18
0069659d : MOV dword ptr [EDI + 0x268],EBX
006965a3 : TEST EAX,EAX
006965a5 : JNZ 0x006967ae
006965ab : LEA EDX,[EBP + EBP*0x2]
006965af : SHL EDX,0x4
006965b2 : PUSH EDX
006965b3 : PUSH ESI
006965b4 : MOV dword ptr [EDI + 0x264],EBP
006965ba : MOV dword ptr [ESP + 0x28],EBP
006965be : CALL 0x00688900
006965c3 : ADD ESP,0x8
006965c6 : MOV dword ptr [ESP + 0x10],EAX
006965ca : TEST EAX,EAX
006965cc : JNZ 0x006967ae
006965d2 : TEST EBP,EBP
006965d4 : JBE 0x00696648
006965d6 : PUSH EBX
006965d7 : PUSH 0xbd9844
006965dc : PUSH ESI
006965dd : CALL 0x006889e0
006965e2 : ADD ESP,0xc
006965e5 : MOV dword ptr [ESP + 0x10],EAX
006965e9 : TEST EAX,EAX
006965eb : JNZ 0x00696648
006965ed : LEA EAX,[EBX + 0x10]
006965f0 : PUSH EAX
006965f1 : PUSH 0xbd9810
006965f6 : PUSH ESI
006965f7 : CALL 0x006889e0
006965fc : ADD ESP,0xc
006965ff : MOV dword ptr [ESP + 0x10],EAX
00696603 : TEST EAX,EAX
00696605 : JNZ 0x00696648
00696607 : LEA ECX,[EBX + 0x1c]
0069660a : PUSH ECX
0069660b : PUSH 0xbd9810
00696610 : PUSH ESI
00696611 : CALL 0x006889e0
00696616 : ADD ESP,0xc
00696619 : MOV dword ptr [ESP + 0x10],EAX
0069661d : TEST EAX,EAX
0069661f : JNZ 0x00696648
00696621 : PUSH EBX
00696622 : PUSH 0xbd9858
00696627 : PUSH ESI
00696628 : CALL 0x006889e0
0069662d : ADD ESP,0xc
00696630 : MOV dword ptr [ESP + 0x10],EAX
00696634 : TEST EAX,EAX
00696636 : JNZ 0x00696648
00696638 : MOV EAX,dword ptr [ESP + 0x20]
0069663c : DEC EAX
0069663d : ADD EBX,0x30
00696640 : MOV dword ptr [ESP + 0x20],EAX
00696644 : TEST EAX,EAX
00696646 : JA 0x006965d6
00696648 : PUSH ESI
00696649 : CALL 0x006889b0
0069664e : MOV EBX,dword ptr [EDI + 0x268]
00696654 : ADD ESP,0x4
00696657 : MOV dword ptr [ESP + 0x20],EBP
0069665b : TEST EBP,EBP
0069665d : JBE 0x006967aa
00696663 : MOV EDX,dword ptr [EBX + 0x8]
00696666 : ADD EDX,dword ptr [ESP + 0x1c]
0069666a : MOV EBP,dword ptr [EBX]
0069666c : PUSH EDX
0069666d : PUSH ESI
0069666e : CALL 0x006877c0
00696673 : ADD ESP,0x8
00696676 : MOV dword ptr [ESP + 0x10],EAX
0069667a : TEST EAX,EAX
0069667c : JNZ 0x006967ae
00696682 : MOV EAX,dword ptr [EBX]
00696684 : ADD EAX,EAX
00696686 : ADD EAX,EAX
00696688 : ADD EAX,EAX
0069668a : PUSH EAX
0069668b : PUSH ESI
0069668c : CALL 0x00688900
00696691 : ADD ESP,0x8
00696694 : MOV dword ptr [ESP + 0x10],EAX
00696698 : TEST EAX,EAX
0069669a : JNZ 0x006967ae
006966a0 : MOV EDX,dword ptr [EBX]
006966a2 : LEA ECX,[ESP + 0x10]
006966a6 : PUSH ECX
006966a7 : PUSH EAX
006966a8 : PUSH EDX
006966a9 : PUSH EAX
006966aa : MOV EAX,dword ptr [ESP + 0x24]
006966ae : PUSH 0x28
006966b0 : PUSH EAX
006966b1 : CALL 0x0068a220
006966b6 : MOV EDI,EAX
006966b8 : MOV dword ptr [EBX + 0x4],EDI
006966bb : MOV EAX,dword ptr [ESP + 0x28]
006966bf : ADD ESP,0x18
006966c2 : TEST EAX,EAX
006966c4 : JNZ 0x006967ae
006966ca : TEST EBP,EBP
006966cc : JBE 0x006966fe
006966ce : MOV EDI,EDI
006966d0 : PUSH ESI
006966d1 : CALL 0x00687940
006966d6 : PUSH ESI
006966d7 : MOV word ptr [EDI],AX
006966da : CALL 0x00687940
006966df : PUSH ESI
006966e0 : MOV word ptr [EDI + 0x2],AX
006966e4 : CALL 0x006879a0
006966e9 : ADD EAX,dword ptr [EBX + 0x8]
006966ec : DEC EBP
006966ed : ADD EAX,dword ptr [ESP + 0x28]
006966f1 : ADD ESP,0xc
006966f4 : MOV dword ptr [EDI + 0x24],EAX
006966f7 : ADD EDI,0x28
006966fa : TEST EBP,EBP
006966fc : JA 0x006966d0
006966fe : PUSH ESI
006966ff : CALL 0x006889b0
00696704 : MOV EBP,dword ptr [EBX]
00696706 : MOV EDI,dword ptr [EBX + 0x4]
00696709 : ADD ESP,0x4
0069670c : TEST EBP,EBP
0069670e : JBE 0x0069677d
00696710 : MOV ECX,dword ptr [EDI + 0x24]
00696713 : PUSH ECX
00696714 : PUSH ESI
00696715 : CALL 0x006877c0
0069671a : ADD ESP,0x8
0069671d : MOV dword ptr [ESP + 0x10],EAX
00696721 : TEST EAX,EAX
00696723 : JNZ 0x006967ae
00696729 : PUSH 0x8
0069672b : PUSH ESI
0069672c : CALL 0x00688900
00696731 : ADD ESP,0x8
00696734 : MOV dword ptr [ESP + 0x10],EAX
00696738 : TEST EAX,EAX
0069673a : JNZ 0x006967ae
0069673c : PUSH ESI
0069673d : CALL 0x00687940
00696742 : PUSH ESI
00696743 : MOV word ptr [EDI + 0x4],AX
00696747 : CALL 0x00687940
0069674c : PUSH ESI
0069674d : MOV word ptr [EDI + 0x6],AX
00696751 : CALL 0x006879a0
00696756 : PUSH ESI
00696757 : MOV dword ptr [EDI + 0x8],EAX
0069675a : CALL 0x006889b0
0069675f : ADD ESP,0x10
00696762 : MOV EAX,ESI
00696764 : MOV ECX,EDI
00696766 : CALL 0x00696380
0069676b : MOV dword ptr [ESP + 0x10],EAX
0069676f : TEST EAX,EAX
00696771 : JNZ 0x006967ae
00696773 : DEC EBP
00696774 : ADD EDI,0x28
00696777 : TEST EBP,EBP
00696779 : JA 0x00696710
0069677b : JMP 0x00696781
0069677d : MOV EAX,dword ptr [ESP + 0x10]
00696781 : MOV ECX,dword ptr [ESP + 0x20]
00696785 : DEC ECX
00696786 : ADD EBX,0x30
00696789 : MOV dword ptr [ESP + 0x20],ECX
0069678d : TEST ECX,ECX
0069678f : JA 0x00696663
00696795 : POP EBP
00696796 : POP EDI
00696797 : POP ESI
00696798 : POP EBX
00696799 : ADD ESP,0x8
0069679c : RET
0069679d : POP EBP
0069679e : POP EDI
0069679f : POP ESI
006967a0 : MOV EAX,0x3
006967a5 : POP EBX
006967a6 : ADD ESP,0x8
006967a9 : RET
006967aa : MOV EAX,dword ptr [ESP + 0x10]
006967ae : POP EBP
006967af : POP EDI
006967b0 : POP ESI
006967b1 : POP EBX
006967b2 : ADD ESP,0x8
006967b5 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00550960
ENTRY    : 00550960
BODY     : [[00550960, 00550a7d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00550960(undefined4 param_1,undefined4 *param_2,uint param_3)

{
  uint *puVar1;
  int iVar2;
  uint *puVar3;
  int *piVar4;
  int *in_ECX;
  uint uVar5;
  uint uVar6;
  int iVar7;
  
  piVar4 = (int *)*in_ECX;
  if (piVar4 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar4 * 5) <= piVar4[1] * 4 + 4U) goto LAB_0055099b;
    iVar7 = piVar4[1] * 2 + 2;
  }
  FUN_0054fa60(param_1,iVar7);
LAB_0055099b:
  piVar4 = (int *)*in_ECX;
  param_3 = param_3 & piVar4[1];
  *piVar4 = *piVar4 + 1;
  iVar7 = *in_ECX;
  puVar1 = (uint *)(iVar7 + 8 + param_3 * 0x18);
  if (*puVar1 == 0xfffffffe) {
    *puVar1 = 0xffffffff;
    uVar6 = *(uint *)*param_2;
    puVar1[1] = uVar6;
    piVar4 = (int *)(uVar6 + 8);
    *piVar4 = *piVar4 + 1;
    iVar7 = param_2[1];
    FUN_005266c0(iVar7);
    *(undefined1 *)((int)puVar1 + 9) = *(undefined1 *)(iVar7 + 1);
    return;
  }
  uVar6 = param_3;
  do {
    uVar6 = uVar6 + 1 & *(uint *)(iVar7 + 4);
  } while (*(int *)(iVar7 + 8 + uVar6 * 0x18) != -2);
  iVar2 = iVar7 + 8 + uVar6 * 0x18;
  uVar5 = *(uint *)(puVar1[1] + 0xc) & *(uint *)(iVar7 + 4);
  if (uVar5 != param_3) {
    puVar3 = (uint *)(iVar7 + 8 + uVar5 * 0x18);
    for (uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x18); uVar5 != param_3;
        uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x18)) {
      uVar5 = *puVar3;
      puVar3 = (uint *)(iVar7 + 8 + uVar5 * 0x18);
    }
    if (iVar2 != 0) {
      FUN_0054f130(puVar1);
    }
    *puVar3 = uVar6;
    FUN_0054f170(param_2);
    *puVar1 = 0xffffffff;
    return;
  }
  if (iVar2 != 0) {
    FUN_0054f130(puVar1);
  }
  FUN_0054f170(param_2);
  *puVar1 = uVar6;
  return;
}



============================================================
DISASSEMBLY
============================================================
00550960 : PUSH EBX
00550961 : PUSH ESI
00550962 : MOV ESI,ECX
00550964 : MOV EAX,dword ptr [ESI]
00550966 : PUSH EDI
00550967 : TEST EAX,EAX
00550969 : JNZ 0x00550974
0055096b : MOV EAX,dword ptr [ESP + 0x10]
0055096f : PUSH 0x8
00550971 : PUSH EAX
00550972 : JMP 0x00550996
00550974 : MOV ECX,dword ptr [EAX + 0x4]
00550977 : LEA EDX,[ECX*0x4 + 0x4]
0055097e : MOV ECX,dword ptr [EAX]
00550980 : LEA ECX,[ECX + ECX*0x4]
00550983 : CMP ECX,EDX
00550985 : JBE 0x0055099b
00550987 : MOV EDX,dword ptr [EAX + 0x4]
0055098a : MOV ECX,dword ptr [ESP + 0x10]
0055098e : LEA EAX,[EDX + EDX*0x1 + 0x2]
00550992 : PUSH EAX
00550993 : PUSH ECX
00550994 : MOV ECX,ESI
00550996 : CALL 0x0054fa60
0055099b : MOV ECX,dword ptr [ESI]
0055099d : MOV EAX,dword ptr [ESP + 0x18]
005509a1 : AND EAX,dword ptr [ECX + 0x4]
005509a4 : INC dword ptr [ECX]
005509a6 : MOV EDX,dword ptr [ESI]
005509a8 : LEA ECX,[EAX + EAX*0x2]
005509ab : LEA EDI,[EDX + ECX*0x8 + 0x8]
005509af : MOV EBX,0xfffffffe
005509b4 : CMP dword ptr [EDI],EBX
005509b6 : JNZ 0x005509e6
005509b8 : MOV ECX,dword ptr [ESP + 0x14]
005509bc : MOV dword ptr [EDI],0xffffffff
005509c2 : MOV EDX,dword ptr [ECX]
005509c4 : MOV EAX,dword ptr [EDX]
005509c6 : MOV dword ptr [EDI + 0x4],EAX
005509c9 : INC dword ptr [EAX + 0x8]
005509cc : MOV ESI,dword ptr [ECX + 0x4]
005509cf : ADD EDI,0x8
005509d2 : PUSH ESI
005509d3 : MOV ECX,EDI
005509d5 : CALL 0x005266c0
005509da : MOV AL,byte ptr [ESI + 0x1]
005509dd : MOV byte ptr [EDI + 0x1],AL
005509e0 : POP EDI
005509e1 : POP ESI
005509e2 : POP EBX
005509e3 : RET 0xc
005509e6 : MOV ECX,dword ptr [EDX + 0x4]
005509e9 : MOV ESI,EAX
005509eb : PUSH EBP
005509ec : LEA ESP,[ESP]
005509f0 : INC ESI
005509f1 : AND ESI,ECX
005509f3 : LEA EBP,[ESI + ESI*0x2]
005509f6 : CMP dword ptr [EDX + EBP*0x8 + 0x8],EBX
005509fa : JNZ 0x005509f0
005509fc : LEA EBX,[ESI + ESI*0x2]
005509ff : LEA EBX,[EDX + EBX*0x8 + 0x8]
00550a03 : MOV dword ptr [ESP + 0x14],EBX
00550a07 : MOV EBX,dword ptr [EDI + 0x4]
00550a0a : MOV EBX,dword ptr [EBX + 0xc]
00550a0d : LEA EBP,[EDI + 0x4]
00550a10 : AND EBX,ECX
00550a12 : CMP EBX,EAX
00550a14 : JNZ 0x00550a39
00550a16 : MOV ECX,dword ptr [ESP + 0x14]
00550a1a : TEST ECX,ECX
00550a1c : JZ 0x00550a24
00550a1e : PUSH EDI
00550a1f : CALL 0x0054f130
00550a24 : MOV ECX,dword ptr [ESP + 0x18]
00550a28 : PUSH ECX
00550a29 : MOV ECX,EBP
00550a2b : CALL 0x0054f170
00550a30 : POP EBP
00550a31 : MOV dword ptr [EDI],ESI
00550a33 : POP EDI
00550a34 : POP ESI
00550a35 : POP EBX
00550a36 : RET 0xc
00550a39 : LEA ECX,[EBX + EBX*0x2]
00550a3c : CMP dword ptr [EDX + ECX*0x8 + 0x8],EAX
00550a40 : LEA EBX,[EDX + ECX*0x8 + 0x8]
00550a44 : JZ 0x00550a55
00550a46 : MOV EBX,dword ptr [EBX]
00550a48 : LEA ECX,[EBX + EBX*0x2]
00550a4b : CMP dword ptr [EDX + ECX*0x8 + 0x8],EAX
00550a4f : LEA EBX,[EDX + ECX*0x8 + 0x8]
00550a53 : JNZ 0x00550a46
00550a55 : MOV ECX,dword ptr [ESP + 0x14]
00550a59 : TEST ECX,ECX
00550a5b : JZ 0x00550a63
00550a5d : PUSH EDI
00550a5e : CALL 0x0054f130
00550a63 : MOV EDX,dword ptr [ESP + 0x18]
00550a67 : PUSH EDX
00550a68 : MOV ECX,EBP
00550a6a : MOV dword ptr [EBX],ESI
00550a6c : CALL 0x0054f170
00550a71 : POP EBP
00550a72 : MOV dword ptr [EDI],0xffffffff
00550a78 : POP EDI
00550a79 : POP ESI
00550a7a : POP EBX
00550a7b : RET 0xc

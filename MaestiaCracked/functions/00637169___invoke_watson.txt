PROGRAM  : Maestia.exe
FUNCTION : __invoke_watson
ENTRY    : 00637169
BODY     : [[00637169, 00637290]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    __invoke_watson
   
   Library: Visual Studio 2008 Release */

void __cdecl
__invoke_watson(wchar_t *param_1,wchar_t *param_2,wchar_t *param_3,uint param_4,uintptr_t param_5)

{
  uint uVar1;
  BOOL BVar2;
  LONG LVar3;
  HANDLE hProcess;
  UINT uExitCode;
  EXCEPTION_RECORD local_32c;
  _EXCEPTION_POINTERS local_2dc;
  undefined4 local_2d4;
  
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_32c.ExceptionCode = 0;
  _memset(&local_32c.ExceptionFlags,0,0x4c);
  local_2dc.ExceptionRecord = &local_32c;
  local_2dc.ContextRecord = (PCONTEXT)&local_2d4;
  local_2d4 = 0x10001;
  local_32c.ExceptionCode = 0xc0000417;
  local_32c.ExceptionFlags = 1;
  BVar2 = IsDebuggerPresent();
  SetUnhandledExceptionFilter((LPTOP_LEVEL_EXCEPTION_FILTER)0x0);
  LVar3 = UnhandledExceptionFilter(&local_2dc);
  if ((LVar3 == 0) && (BVar2 == 0)) {
    FUN_006504cd();
  }
  uExitCode = 0xc0000417;
  hProcess = GetCurrentProcess();
  TerminateProcess(hProcess,uExitCode);
  __security_check_cookie(uVar1 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00637169 : MOV EDI,EDI
0063716b : PUSH EBP
0063716c : MOV EBP,ESP
0063716e : SUB ESP,0x328
00637174 : MOV EAX,[0x00d66fa0]
00637179 : XOR EAX,EBP
0063717b : MOV dword ptr [EBP + -0x4],EAX
0063717e : AND dword ptr [EBP + 0xfffffcd8],0x0
00637185 : PUSH EBX
00637186 : PUSH 0x4c
00637188 : LEA EAX,[EBP + 0xfffffcdc]
0063718e : PUSH 0x0
00637190 : PUSH EAX
00637191 : CALL 0x0063b700
00637196 : LEA EAX,[EBP + 0xfffffcd8]
0063719c : MOV dword ptr [EBP + 0xfffffd28],EAX
006371a2 : LEA EAX,[EBP + 0xfffffd30]
006371a8 : ADD ESP,0xc
006371ab : MOV dword ptr [EBP + 0xfffffd2c],EAX
006371b1 : MOV dword ptr [EBP + 0xfffffde0],EAX
006371b7 : MOV dword ptr [EBP + 0xfffffddc],ECX
006371bd : MOV dword ptr [EBP + 0xfffffdd8],EDX
006371c3 : MOV dword ptr [EBP + 0xfffffdd4],EBX
006371c9 : MOV dword ptr [EBP + 0xfffffdd0],ESI
006371cf : MOV dword ptr [EBP + 0xfffffdcc],EDI
006371d5 : MOV word ptr [EBP + 0xfffffdf8],SS
006371dc : MOV word ptr [EBP + 0xfffffdec],CS
006371e3 : MOV word ptr [EBP + 0xfffffdc8],DS
006371ea : MOV word ptr [EBP + 0xfffffdc4],ES
006371f1 : MOV word ptr [EBP + 0xfffffdc0],FS
006371f8 : MOV word ptr [EBP + 0xfffffdbc],GS
006371ff : PUSHFD
00637200 : POP dword ptr [EBP + 0xfffffdf0]
00637206 : MOV EAX,dword ptr [EBP + 0x4]
00637209 : LEA ECX,[EBP + 0x4]
0063720c : MOV dword ptr [EBP + 0xfffffd30],0x10001
00637216 : MOV dword ptr [EBP + 0xfffffde8],EAX
0063721c : MOV dword ptr [EBP + 0xfffffdf4],ECX
00637222 : MOV ECX,dword ptr [ECX + -0x4]
00637225 : MOV dword ptr [EBP + 0xfffffde4],ECX
0063722b : MOV dword ptr [EBP + 0xfffffcd8],0xc0000417
00637235 : MOV dword ptr [EBP + 0xfffffcdc],0x1
0063723f : MOV dword ptr [EBP + 0xfffffce4],EAX
00637245 : CALL dword ptr [0x00b852dc]
0063724b : PUSH 0x0
0063724d : MOV EBX,EAX
0063724f : CALL dword ptr [0x00b8514c]
00637255 : LEA EAX,[EBP + 0xfffffd28]
0063725b : PUSH EAX
0063725c : CALL dword ptr [0x00b852bc]
00637262 : TEST EAX,EAX
00637264 : JNZ 0x00637272
00637266 : TEST EBX,EBX
00637268 : JNZ 0x00637272
0063726a : PUSH 0x2
0063726c : CALL 0x006504cd
00637271 : POP ECX
00637272 : PUSH 0xc0000417
00637277 : CALL dword ptr [0x00b85134]
0063727d : PUSH EAX
0063727e : CALL dword ptr [0x00b852c0]
00637284 : MOV ECX,dword ptr [EBP + -0x4]
00637287 : XOR ECX,EBP
00637289 : POP EBX
0063728a : CALL 0x00633e6b
0063728f : LEAVE
00637290 : RET

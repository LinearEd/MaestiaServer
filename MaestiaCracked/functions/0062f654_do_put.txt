PROGRAM  : Maestia.exe
FUNCTION : do_put
ENTRY    : 0062f654
BODY     : [[0062f654, 0062f729]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __EH_prolog3_GS replaced with injection: EH_prolog3 */
/* Library Function - Multiple Matches With Same Base Name
    protected: virtual class std::ostreambuf_iterator<unsigned short,struct
   std::char_traits<unsigned short> > __thiscall std::money_put<unsigned short,class
   std::ostreambuf_iterator<unsigned short,struct std::char_traits<unsigned short> > >::do_put(class
   std::ostreambuf_iterator<unsigned short,struct std::char_traits<unsigned short> >,bool,class
   std::ios_base &,unsigned short,class std::basic_string<unsigned short,struct
   std::char_traits<unsigned short>,class std::allocator<unsigned short> > const &)const 
    protected: virtual class std::ostreambuf_iterator<wchar_t,struct std::char_traits<wchar_t> >
   __thiscall std::money_put<wchar_t,class std::ostreambuf_iterator<wchar_t,struct
   std::char_traits<wchar_t> > >::do_put(class std::ostreambuf_iterator<wchar_t,struct
   std::char_traits<wchar_t> >,bool,class std::ios_base &,wchar_t,class
   std::basic_string<wchar_t,struct std::char_traits<wchar_t>,class std::allocator<wchar_t> > const
   &)const 
   
   Library: Visual Studio 2008 Release */

void do_put(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
           undefined4 param_5,undefined4 param_6,int param_7)

{
  ushort uVar1;
  ushort uVar2;
  int in_ECX;
  ushort *puVar3;
  uint uVar4;
  undefined1 auStack_68 [12];
  undefined4 uStack_5c;
  undefined4 uStack_58;
  ushort *puStack_54;
  uint uStack_50;
  undefined1 *local_3c;
  uint local_34;
  undefined1 local_30 [40];
  undefined4 local_8;
  undefined4 uStack_4;
  
  uStack_4 = 0x2c;
  local_8 = 0x62f660;
  puStack_54 = (ushort *)0x0;
  uStack_58 = 0x30;
  uStack_5c = 0x62f675;
  uStack_50 = in_ECX + 8;
  uVar1 = _Maklocchr<>();
  if (*(uint *)(param_7 + 0x18) < 8) {
    puVar3 = (ushort *)(param_7 + 4);
  }
  else {
    puVar3 = *(ushort **)(param_7 + 4);
  }
  uVar4 = 0;
  puStack_54 = (ushort *)0x0;
  uStack_58 = 0x2d;
  local_34 = local_34 & 0xffffff00;
  uStack_5c = 0x62f698;
  uStack_50 = in_ECX + 8;
  uVar2 = _Maklocchr<>();
  if (*puVar3 == uVar2) {
    local_34 = CONCAT31(local_34._1_3_,1);
    puVar3 = puVar3 + 1;
  }
  uVar2 = *puVar3;
  if (uVar1 <= uVar2) {
    do {
      if (uVar1 + 9 < (uint)uVar2) break;
      uVar4 = uVar4 + 1;
      uVar2 = puVar3[uVar4];
    } while (uVar1 <= uVar2);
  }
  uStack_58 = 0x62f6d2;
  puStack_54 = puVar3;
  uStack_50 = uVar4;
  basic_string<>();
  local_8 = 0;
  if (uVar4 == 0) {
    puStack_54 = (ushort *)0x1;
    uStack_58 = 0x62f6e5;
    uStack_50 = (uint)uVar1;
    FID_conflict_append();
  }
  local_3c = auStack_68;
  basic_string<>(local_30);
  Putmfld(param_1,param_2,param_3,param_4,param_5,param_6,local_34);
  uStack_50 = 0;
  puStack_54 = (ushort *)0x1;
  uStack_58 = 0x62f71f;
  FID_conflict__Tidy();
  uStack_50 = 0x62f727;
  FUN_00640ed0();
  return;
}



============================================================
DISASSEMBLY
============================================================
0062f654 : PUSH 0x2c
0062f656 : MOV EAX,0xb0c0ce
0062f65b : CALL 0x00640e86
0062f660 : MOV ESI,dword ptr [EBP + 0x20]
0062f663 : MOV EDI,ECX
0062f665 : MOV dword ptr [EBP + -0x34],EDI
0062f668 : ADD EDI,0x8
0062f66b : PUSH EDI
0062f66c : PUSH 0x0
0062f66e : PUSH 0x30
0062f670 : CALL 0x00624d6c
0062f675 : ADD ESP,0xc
0062f678 : CMP dword ptr [ESI + 0x18],0x8
0062f67c : MOVZX EBX,AX
0062f67f : JC 0x0062f686
0062f681 : MOV ESI,dword ptr [ESI + 0x4]
0062f684 : JMP 0x0062f689
0062f686 : ADD ESI,0x4
0062f689 : PUSH EDI
0062f68a : XOR EDI,EDI
0062f68c : PUSH EDI
0062f68d : PUSH 0x2d
0062f68f : MOV byte ptr [EBP + -0x30],0x0
0062f693 : CALL 0x00624d6c
0062f698 : ADD ESP,0xc
0062f69b : CMP word ptr [ESI],AX
0062f69e : JNZ 0x0062f6a6
0062f6a0 : INC ESI
0062f6a1 : MOV byte ptr [EBP + -0x30],0x1
0062f6a5 : INC ESI
0062f6a6 : MOVZX EAX,word ptr [ESI]
0062f6a9 : CMP BX,AX
0062f6ac : JA 0x0062f6c8
0062f6ae : MOVZX ECX,BX
0062f6b1 : MOVZX EAX,AX
0062f6b4 : ADD ECX,0x9
0062f6b7 : MOVZX EAX,AX
0062f6ba : CMP EAX,ECX
0062f6bc : JG 0x0062f6c8
0062f6be : INC EDI
0062f6bf : MOVZX EAX,word ptr [ESI + EDI*0x2]
0062f6c3 : CMP BX,AX
0062f6c6 : JBE 0x0062f6b7
0062f6c8 : PUSH EDI
0062f6c9 : PUSH ESI
0062f6ca : LEA ECX,[EBP + -0x2c]
0062f6cd : CALL 0x00627073
0062f6d2 : AND dword ptr [EBP + -0x4],0x0
0062f6d6 : TEST EDI,EDI
0062f6d8 : JNZ 0x0062f6e5
0062f6da : PUSH EBX
0062f6db : PUSH 0x1
0062f6dd : LEA ECX,[EBP + -0x2c]
0062f6e0 : CALL 0x00626b22
0062f6e5 : SUB ESP,0x1c
0062f6e8 : LEA EAX,[EBP + -0x2c]
0062f6eb : MOV ECX,ESP
0062f6ed : MOV dword ptr [EBP + -0x38],ESP
0062f6f0 : PUSH EAX
0062f6f1 : CALL 0x006270ee
0062f6f6 : PUSH dword ptr [EBP + -0x30]
0062f6f9 : MOV ECX,dword ptr [EBP + -0x34]
0062f6fc : PUSH dword ptr [EBP + 0x1c]
0062f6ff : PUSH dword ptr [EBP + 0x18]
0062f702 : PUSH dword ptr [EBP + 0x14]
0062f705 : PUSH dword ptr [EBP + 0x10]
0062f708 : PUSH dword ptr [EBP + 0xc]
0062f70b : PUSH dword ptr [EBP + 0x8]
0062f70e : CALL 0x0062c7ff
0062f713 : PUSH 0x0
0062f715 : PUSH 0x1
0062f717 : LEA ECX,[EBP + -0x2c]
0062f71a : CALL 0x006266c9
0062f71f : MOV EAX,dword ptr [EBP + 0x8]
0062f722 : CALL 0x00640ed0
0062f727 : RET 0x1c

PROGRAM  : Maestia.exe
FUNCTION : FUN_00813cb0
ENTRY    : 00813cb0
BODY     : [[00813cb0, 00813fe0]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00813cb0(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined2 *param_4)

{
  uint uVar1;
  char cVar2;
  undefined4 uVar3;
  int iVar4;
  undefined1 local_e0 [4];
  undefined2 local_dc;
  undefined4 local_cc;
  uint local_c8;
  uint local_c4;
  char local_bd;
  undefined1 local_bc [20];
  int aiStack_a8 [16];
  undefined1 local_68 [4];
  undefined4 ***local_64 [5];
  uint local_50;
  undefined4 ***local_48 [5];
  uint local_34;
  undefined4 ***local_2c [5];
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1aa7b;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_c4 = (uint)(ushort)param_4[1];
  local_c4 = FUN_00407c10(&local_c4,1);
  _eh_vector_constructor_iterator_(local_bc,0x1c,3,FUN_00405d90,FUN_00406560);
  local_8 = 0;
  _eh_vector_constructor_iterator_(local_68,0x1c,3,FUN_00405d90,FUN_00406560);
  local_8._0_1_ = 1;
  uVar3 = FUN_0040e420(param_2,local_e0);
  local_8._0_1_ = 2;
  FUN_00405eb0(uVar3,0,0xffffffff);
  local_8._0_1_ = 1;
  if (7 < local_c8) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_dc = 0;
  local_c8 = 7;
  local_cc = 0;
  uVar3 = FUN_0040e420(param_2,local_e0);
  local_8._0_1_ = 3;
  FUN_00405eb0(uVar3,0,0xffffffff);
  uVar1 = local_c4;
  local_8._0_1_ = 1;
  if (7 < local_c8) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_c8 = 7;
  local_cc = 0;
  local_dc = 0;
  if (local_c4 != 0xffffffff) {
    uVar3 = FUN_0040e420(param_2,local_e0);
    local_8._0_1_ = 4;
    FUN_00405eb0(uVar3,0,0xffffffff);
    local_8._0_1_ = 1;
    if (7 < local_c8) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  local_8._0_1_ = 1;
  local_c8 = 7;
  local_cc = 0;
  local_dc = 0;
  cVar2 = '\x01';
  local_bd = '\x01';
  iVar4 = 0;
  do {
    if (cVar2 == '\0') goto LAB_00813f8b;
    if (*(int *)((int)aiStack_a8 + iVar4) != 0) {
      local_bd = FUN_0081a1e0(local_bc + iVar4,param_3,1,local_68 + iVar4,0);
      cVar2 = local_bd;
    }
    iVar4 = iVar4 + 0x1c;
  } while (iVar4 < 0x54);
  if (cVar2 != '\0') {
    if (uVar1 == 0xffffffff) {
      if (local_34 < 8) {
        local_48[0] = local_48;
      }
      if (local_50 < 8) {
        local_64[0] = local_64;
      }
      uVar3 = FUN_00404750(L"%s%c%s",local_64[0],*param_4,local_48[0]);
      local_8._0_1_ = 6;
    }
    else {
      if (local_18 < 8) {
        local_2c[0] = local_2c;
      }
      if (local_34 < 8) {
        local_48[0] = local_48;
      }
      if (local_50 < 8) {
        local_64[0] = local_64;
      }
      uVar3 = FUN_00404750(L"%s%c%s%c%s",local_64[0],*param_4,local_48[0],param_4[1],local_2c[0]);
      local_8._0_1_ = 5;
    }
    FUN_00405eb0(uVar3,0,0xffffffff);
    local_8._0_1_ = 1;
    if (7 < local_c8) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_dc = 0;
    local_cc = 0;
    local_c8 = 7;
  }
LAB_00813f8b:
  local_8 = (uint)local_8._1_3_ << 8;
  _eh_vector_destructor_iterator_(local_68,0x1c,3,FUN_00406560);
  local_8 = 0xffffffff;
  _eh_vector_destructor_iterator_(local_bc,0x1c,3,FUN_00406560);
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00813cb0 : PUSH EBP
00813cb1 : MOV EBP,ESP
00813cb3 : PUSH -0x1
00813cb5 : PUSH 0xb1aa7b
00813cba : MOV EAX,FS:[0x0]
00813cc0 : PUSH EAX
00813cc1 : SUB ESP,0xd8
00813cc7 : MOV EAX,[0x00d66fa0]
00813ccc : XOR EAX,EBP
00813cce : MOV dword ptr [EBP + -0x10],EAX
00813cd1 : PUSH EBX
00813cd2 : PUSH ESI
00813cd3 : PUSH EDI
00813cd4 : PUSH EAX
00813cd5 : LEA EAX,[EBP + -0xc]
00813cd8 : MOV FS:[0x0],EAX
00813cde : MOV EDI,EDX
00813ce0 : MOV EAX,dword ptr [EBP + 0x8]
00813ce3 : MOV EBX,dword ptr [EBP + 0x14]
00813ce6 : MOVZX EDX,word ptr [EBX + 0x2]
00813cea : MOV ESI,dword ptr [EBP + 0xc]
00813ced : MOV dword ptr [EBP + 0xffffff1c],EAX
00813cf3 : PUSH 0x1
00813cf5 : LEA EAX,[EBP + 0xffffff40]
00813cfb : MOV dword ptr [EBP + 0xffffff40],EDX
00813d01 : PUSH EAX
00813d02 : MOV EAX,EDI
00813d04 : MOV EDX,ESI
00813d06 : MOV dword ptr [EBP + 0xffffff20],ECX
00813d0c : CALL 0x00407c10
00813d11 : PUSH 0x406560
00813d16 : PUSH 0x405d90
00813d1b : PUSH 0x3
00813d1d : PUSH 0x1c
00813d1f : LEA ECX,[EBP + 0xffffff48]
00813d25 : PUSH ECX
00813d26 : MOV dword ptr [EBP + 0xffffff40],EAX
00813d2c : CALL 0x0063619b
00813d31 : MOV dword ptr [EBP + -0x4],0x0
00813d38 : PUSH 0x406560
00813d3d : PUSH 0x405d90
00813d42 : PUSH 0x3
00813d44 : PUSH 0x1c
00813d46 : LEA EDX,[EBP + -0x64]
00813d49 : PUSH EDX
00813d4a : CALL 0x0063619b
00813d4f : MOV byte ptr [EBP + -0x4],0x1
00813d53 : LEA EAX,[EBP + 0xffffff24]
00813d59 : PUSH EAX
00813d5a : PUSH ESI
00813d5b : MOV ECX,EDI
00813d5d : XOR EDX,EDX
00813d5f : CALL 0x0040e420
00813d64 : MOV byte ptr [EBP + -0x4],0x2
00813d68 : PUSH -0x1
00813d6a : PUSH 0x0
00813d6c : PUSH EAX
00813d6d : LEA ECX,[EBP + 0xffffff48]
00813d73 : CALL 0x00405eb0
00813d78 : MOV byte ptr [EBP + -0x4],0x1
00813d7c : CMP dword ptr [EBP + 0xffffff3c],0x8
00813d83 : JC 0x00813d90
00813d85 : MOV ECX,dword ptr [EBP + 0xffffff28]
00813d8b : CALL 0x006f04e0
00813d90 : XOR ECX,ECX
00813d92 : MOV word ptr [EBP + 0xffffff28],CX
00813d99 : MOV ECX,dword ptr [EBP + 0xffffff40]
00813d9f : LEA EAX,[EBP + 0xffffff24]
00813da5 : SUB ECX,EDI
00813da7 : PUSH EAX
00813da8 : DEC ECX
00813da9 : LEA EDX,[EDI + 0x1]
00813dac : PUSH ESI
00813dad : MOV dword ptr [EBP + 0xffffff3c],0x7
00813db7 : MOV dword ptr [EBP + 0xffffff38],0x0
00813dc1 : CALL 0x0040e420
00813dc6 : MOV byte ptr [EBP + -0x4],0x3
00813dca : PUSH -0x1
00813dcc : PUSH 0x0
00813dce : PUSH EAX
00813dcf : LEA ECX,[EBP + 0xffffff64]
00813dd5 : CALL 0x00405eb0
00813dda : MOV byte ptr [EBP + -0x4],0x1
00813dde : CMP dword ptr [EBP + 0xffffff3c],0x8
00813de5 : JC 0x00813df2
00813de7 : MOV ECX,dword ptr [EBP + 0xffffff28]
00813ded : CALL 0x006f04e0
00813df2 : MOV EDI,dword ptr [EBP + 0xffffff40]
00813df8 : XOR ECX,ECX
00813dfa : MOV dword ptr [EBP + 0xffffff3c],0x7
00813e04 : MOV dword ptr [EBP + 0xffffff38],0x0
00813e0e : MOV word ptr [EBP + 0xffffff28],CX
00813e15 : CMP EDI,-0x1
00813e18 : JZ 0x00813e73
00813e1a : LEA EAX,[EBP + 0xffffff24]
00813e20 : PUSH EAX
00813e21 : LEA EDX,[EDI + 0x1]
00813e24 : PUSH ESI
00813e25 : OR ECX,0xffffffff
00813e28 : CALL 0x0040e420
00813e2d : MOV byte ptr [EBP + -0x4],0x4
00813e31 : PUSH -0x1
00813e33 : PUSH 0x0
00813e35 : PUSH EAX
00813e36 : LEA ECX,[EBP + -0x80]
00813e39 : CALL 0x00405eb0
00813e3e : MOV byte ptr [EBP + -0x4],0x1
00813e42 : CMP dword ptr [EBP + 0xffffff3c],0x8
00813e49 : JC 0x00813e56
00813e4b : MOV ECX,dword ptr [EBP + 0xffffff28]
00813e51 : CALL 0x006f04e0
00813e56 : XOR ECX,ECX
00813e58 : MOV dword ptr [EBP + 0xffffff3c],0x7
00813e62 : MOV dword ptr [EBP + 0xffffff38],0x0
00813e6c : MOV word ptr [EBP + 0xffffff28],CX
00813e73 : MOV AL,0x1
00813e75 : MOV byte ptr [EBP + 0xffffff47],AL
00813e7b : XOR ESI,ESI
00813e7d : LEA ECX,[ECX]
00813e80 : TEST AL,AL
00813e82 : JZ 0x00813f8b
00813e88 : CMP dword ptr [EBP + ESI*0x1 + 0xffffff5c],0x0
00813e90 : JZ 0x00813eb8
00813e92 : MOV EAX,dword ptr [EBP + 0x10]
00813e95 : PUSH 0x0
00813e97 : LEA EDX,[EBP + ESI*0x1 + -0x64]
00813e9b : PUSH EDX
00813e9c : PUSH 0x1
00813e9e : PUSH EAX
00813e9f : LEA ECX,[EBP + ESI*0x1 + 0xffffff48]
00813ea6 : PUSH ECX
00813ea7 : MOV ECX,dword ptr [EBP + 0xffffff1c]
00813ead : CALL 0x0081a1e0
00813eb2 : MOV byte ptr [EBP + 0xffffff47],AL
00813eb8 : ADD ESI,0x1c
00813ebb : CMP ESI,0x54
00813ebe : JL 0x00813e80
00813ec0 : TEST AL,AL
00813ec2 : JZ 0x00813f8b
00813ec8 : CMP EDI,-0x1
00813ecb : MOV EDI,0x8
00813ed0 : JZ 0x00813f18
00813ed2 : MOV EDX,dword ptr [EBP + -0x28]
00813ed5 : CMP dword ptr [EBP + -0x14],EDI
00813ed8 : JNC 0x00813edd
00813eda : LEA EDX,[EBP + -0x28]
00813edd : MOV ECX,dword ptr [EBP + -0x44]
00813ee0 : CMP dword ptr [EBP + -0x30],EDI
00813ee3 : JNC 0x00813ee8
00813ee5 : LEA ECX,[EBP + -0x44]
00813ee8 : MOV EAX,dword ptr [EBP + -0x60]
00813eeb : CMP dword ptr [EBP + -0x4c],EDI
00813eee : JNC 0x00813ef3
00813ef0 : LEA EAX,[EBP + -0x60]
00813ef3 : PUSH EDX
00813ef4 : MOVZX EDX,word ptr [EBX + 0x2]
00813ef8 : PUSH EDX
00813ef9 : PUSH ECX
00813efa : MOVZX ECX,word ptr [EBX]
00813efd : PUSH ECX
00813efe : PUSH EAX
00813eff : PUSH 0xc2e1d0
00813f04 : LEA ESI,[EBP + 0xffffff24]
00813f0a : CALL 0x00404750
00813f0f : ADD ESP,0x18
00813f12 : MOV byte ptr [EBP + -0x4],0x5
00813f16 : JMP 0x00813f4b
00813f18 : MOV ECX,dword ptr [EBP + -0x44]
00813f1b : CMP dword ptr [EBP + -0x30],EDI
00813f1e : JNC 0x00813f23
00813f20 : LEA ECX,[EBP + -0x44]
00813f23 : MOV EAX,dword ptr [EBP + -0x60]
00813f26 : CMP dword ptr [EBP + -0x4c],EDI
00813f29 : JNC 0x00813f2e
00813f2b : LEA EAX,[EBP + -0x60]
00813f2e : PUSH ECX
00813f2f : MOVZX ECX,word ptr [EBX]
00813f32 : PUSH ECX
00813f33 : PUSH EAX
00813f34 : PUSH 0xc2e1e8
00813f39 : LEA ESI,[EBP + 0xffffff24]
00813f3f : CALL 0x00404750
00813f44 : ADD ESP,0x10
00813f47 : MOV byte ptr [EBP + -0x4],0x6
00813f4b : MOV ECX,dword ptr [EBP + 0xffffff20]
00813f51 : PUSH -0x1
00813f53 : PUSH 0x0
00813f55 : PUSH EAX
00813f56 : CALL 0x00405eb0
00813f5b : MOV byte ptr [EBP + -0x4],0x1
00813f5f : CMP dword ptr [EBP + 0xffffff3c],EDI
00813f65 : JC 0x00813f72
00813f67 : MOV ECX,dword ptr [EBP + 0xffffff28]
00813f6d : CALL 0x006f04e0
00813f72 : XOR EDX,EDX
00813f74 : MOV word ptr [EBP + 0xffffff28],DX
00813f7b : MOV dword ptr [EBP + 0xffffff38],EDX
00813f81 : MOV dword ptr [EBP + 0xffffff3c],0x7
00813f8b : MOV byte ptr [EBP + -0x4],0x0
00813f8f : PUSH 0x406560
00813f94 : PUSH 0x3
00813f96 : PUSH 0x1c
00813f98 : LEA EAX,[EBP + -0x64]
00813f9b : PUSH EAX
00813f9c : CALL 0x0063625e
00813fa1 : MOV dword ptr [EBP + -0x4],0xffffffff
00813fa8 : PUSH 0x406560
00813fad : PUSH 0x3
00813faf : PUSH 0x1c
00813fb1 : LEA ECX,[EBP + 0xffffff48]
00813fb7 : PUSH ECX
00813fb8 : CALL 0x0063625e
00813fbd : MOV AL,byte ptr [EBP + 0xffffff47]
00813fc3 : MOV ECX,dword ptr [EBP + -0xc]
00813fc6 : MOV dword ptr FS:[0x0],ECX
00813fcd : POP ECX
00813fce : POP EDI
00813fcf : POP ESI
00813fd0 : POP EBX
00813fd1 : MOV ECX,dword ptr [EBP + -0x10]
00813fd4 : XOR ECX,EBP
00813fd6 : CALL 0x00633e6b
00813fdb : MOV ESP,EBP
00813fdd : POP EBP
00813fde : RET 0x10

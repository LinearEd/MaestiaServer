PROGRAM  : Maestia.exe
FUNCTION : FUN_00521590
ENTRY    : 00521590
BODY     : [[00521590, 00521aa2]]

============================================================
DECOMPILED C CODE
============================================================

bool FUN_00521590(int *param_1)

{
  int *piVar1;
  GRefCountNTSImpl *pGVar2;
  char cVar3;
  int iVar4;
  int iVar5;
  undefined4 *puVar6;
  GRefCountNTSImpl *in_ECX;
  bool bVar7;
  GThread *pGStack_90;
  int iStack_8c;
  int iStack_88;
  GRefCountNTSImpl *local_84;
  char acStack_80 [16];
  int *piStack_70;
  int iStack_6c;
  byte bStack_68;
  int iStack_64;
  int iStack_60;
  byte bStack_5c;
  GRefCountNTSImpl *pGStack_58;
  int iStack_54;
  int iStack_50;
  byte bStack_4c;
  int iStack_48;
  int iStack_44;
  byte bStack_40;
  int iStack_3c;
  int iStack_38;
  byte bStack_34;
  undefined1 auStack_30 [16];
  undefined1 auStack_20 [4];
  uint uStack_1c;
  undefined1 auStack_10 [4];
  int iStack_c;
  
  if (in_ECX != (GRefCountNTSImpl *)0x0) {
    *(int *)(in_ECX + 4) = *(int *)(in_ECX + 4) + 1;
  }
  local_84 = in_ECX;
  iVar4 = (**(code **)(*(int *)in_ECX + 0x5c))();
  pGStack_58 = *(GRefCountNTSImpl **)(iVar4 + 0x74);
  if (pGStack_58 != (GRefCountNTSImpl *)0x0) {
    *(int *)(pGStack_58 + 4) = *(int *)(pGStack_58 + 4) + 1;
  }
  if (((*param_1 == 0x40) || (*param_1 == 0x80)) && (iVar5 = FUN_005296a0(), iVar5 != 0)) {
    FUN_005b0ab0((short)param_1[2],*(undefined1 *)((int)param_1 + 10),param_1[1]);
  }
  iStack_8c = 0;
  acStack_80[0] = '\0';
  cVar3 = FUN_00520600(param_1);
  if ((cVar3 != '\0') && ((char)param_1[3] == '\0')) {
    FUN_005206c0(iVar4,param_1);
    iStack_8c = 1;
  }
  piVar1 = (int *)(iVar4 + 0x78);
  FUN_00529910(&pGStack_90,piVar1);
  if ((*(int *)(pGStack_90 + 0x10) != 0) &&
     (cVar3 = (**(code **)(*(int *)(in_ECX + 0x68) + 0x2c))(piVar1,&pGStack_90,acStack_80),
     cVar3 != '\0')) {
    if (acStack_80[0] == '\t') {
      auStack_30[0] = 0;
      FUN_00526d80(iVar4,in_ECX + 0x68,auStack_30);
      FUN_005268b0(auStack_30);
      FUN_00526bc0();
    }
    if (acStack_80[0] != '\x01') {
      if (*(char *)(*piVar1 + 0x2a4) == '\x01') {
        iStack_88 = 0;
        bVar7 = true;
        if ((char)param_1[3] != '\0') {
          FUN_00527140(&piStack_70,iVar4);
          if ((piStack_70 != (int *)0x0) && (iVar5 = (**(code **)(*piStack_70 + 0x40))(), iVar5 < 2)
             ) {
            bVar7 = false;
          }
          if (((bStack_68 & 2) == 0) && (piStack_70 != (int *)0x0)) {
            FUN_00503db0();
          }
          piStack_70 = (int *)0x0;
          if (((bStack_68 & 1) == 0) && (iStack_6c != 0)) {
            FUN_00503db0();
          }
          if (!bVar7) goto LAB_00521a57;
        }
        iStack_8c = iStack_8c + 1;
        cVar3 = FUN_0052a360();
        if (cVar3 != '\0') {
          if (*(int *)(local_84 + 0x80) == 0) {
            FUN_00520df0();
          }
          FUN_00527140(&iStack_64,iVar4);
          GThread::OnExit(pGStack_90);
          if (((bStack_5c & 2) == 0) && (iStack_64 != 0)) {
            FUN_00503db0();
          }
          iStack_64 = 0;
          if (((bStack_5c & 1) == 0) && (iStack_60 != 0)) {
            FUN_00503db0();
          }
        }
        iVar5 = *param_1;
        if ((((iVar5 == 0x2000) || (iVar5 == 0x4000)) || (iVar5 == 0x8000)) || (iVar5 == 0x10000)) {
          uStack_1c = (uint)*(byte *)(param_1 + 3);
          *(int *)(iVar4 + 8) = *(int *)(iVar4 + 8) + 0x10;
          auStack_20[0] = 4;
          if (*(uint *)(iVar4 + 0x10) <= *(uint *)(iVar4 + 8)) {
            FUN_00504050();
          }
          if (*(uint *)(iVar4 + 8) != 0) {
            FUN_005266c0(auStack_20);
          }
          FUN_00526bc0();
          iStack_88 = 1;
        }
        cVar3 = *(char *)((int)param_1 + 0xb);
        if ((-1 < cVar3) || (iStack_88 != 0)) {
          *(int *)(iVar4 + 8) = *(int *)(iVar4 + 8) + 0x10;
          iStack_c = (int)cVar3;
          auStack_10[0] = 4;
          if (*(uint *)(iVar4 + 0x10) <= *(uint *)(iVar4 + 8)) {
            FUN_00504050();
          }
          if (*(uint *)(iVar4 + 8) != 0) {
            FUN_005266c0(auStack_10);
          }
          FUN_00526bc0();
          iStack_88 = iStack_88 + 1;
        }
        pGVar2 = local_84;
        iVar5 = iStack_88;
        FUN_0052c930(acStack_80,0,local_84 + 0x68,iVar4,iStack_88,
                     (*(int *)(iVar4 + 8) - *(int *)(iVar4 + 0xc) >> 4) + -0x20 +
                     *(int *)(iVar4 + 0x1c) * 0x20,*(undefined4 *)pGStack_90);
        if (iVar5 != 0) {
          FUN_00520a70(iVar5);
        }
        cVar3 = FUN_0052a360();
        if (cVar3 == '\0') goto LAB_00521a57;
        if (*(int *)(pGVar2 + 0x80) == 0) {
          FUN_00520df0();
        }
        FUN_00527140(&iStack_54,iVar4);
        GThread::OnExit(*(GThread **)pGStack_90);
        if (((bStack_4c & 2) == 0) && (iStack_54 != 0)) {
          FUN_00503db0();
        }
        iStack_54 = 0;
        iStack_44 = iStack_50;
        bStack_40 = bStack_4c;
      }
      else {
        if ((char)param_1[3] != '\0') goto LAB_00521a57;
        iStack_8c = iStack_8c + 1;
        cVar3 = FUN_0052a360();
        if (cVar3 != '\0') {
          if (*(int *)(in_ECX + 0x80) == 0) {
            FUN_00520df0();
          }
          puVar6 = (undefined4 *)FUN_00527140(&iStack_3c,iVar4);
          GThread::OnExit((GThread *)*puVar6);
          if (((bStack_34 & 2) == 0) && (iStack_3c != 0)) {
            FUN_00503db0();
          }
          iStack_3c = 0;
          if (((bStack_34 & 1) == 0) && (iStack_38 != 0)) {
            FUN_00503db0();
          }
        }
        FUN_0052c930(acStack_80,0,in_ECX + 0x68,iVar4,0,
                     (*(int *)(iVar4 + 8) - *(int *)(iVar4 + 0xc) >> 4) + -0x1f +
                     *(int *)(iVar4 + 0x1c) * 0x20,0);
        cVar3 = FUN_0052a360();
        if (cVar3 == '\0') goto LAB_00521a57;
        if (*(int *)(in_ECX + 0x80) == 0) {
          FUN_00520df0();
        }
        puVar6 = (undefined4 *)FUN_00527140(&iStack_48,iVar4);
        GThread::OnExit((GThread *)*puVar6);
        if (((bStack_40 & 2) == 0) && (iStack_48 != 0)) {
          FUN_00503db0();
        }
        iStack_48 = 0;
      }
      if (((bStack_40 & 1) == 0) && (iStack_44 != 0)) {
        FUN_00503db0();
      }
    }
  }
LAB_00521a57:
  bVar7 = iStack_8c != 0;
  *(int *)(pGStack_90 + 8) = *(int *)(pGStack_90 + 8) + -1;
  if (*(int *)(pGStack_90 + 8) == 0) {
    FUN_00525340();
  }
  FUN_00526bc0();
  if (pGStack_58 != (GRefCountNTSImpl *)0x0) {
    GRefCountNTSImpl::Release(pGStack_58);
  }
  GRefCountNTSImpl::Release(local_84);
  return bVar7;
}



============================================================
DISASSEMBLY
============================================================
00521590 : SUB ESP,0x90
00521596 : PUSH EBX
00521597 : MOV EBX,ECX
00521599 : PUSH EDI
0052159a : MOV dword ptr [ESP + 0x14],EBX
0052159e : MOV EDI,0x1
005215a3 : TEST EBX,EBX
005215a5 : JZ 0x005215aa
005215a7 : ADD dword ptr [EBX + 0x4],EDI
005215aa : MOV EAX,dword ptr [EBX]
005215ac : MOV EDX,dword ptr [EAX + 0x5c]
005215af : PUSH EBP
005215b0 : PUSH ESI
005215b1 : CALL EDX
005215b3 : MOV ESI,EAX
005215b5 : MOV EAX,dword ptr [ESI + 0x74]
005215b8 : MOV dword ptr [ESP + 0x48],EAX
005215bc : TEST EAX,EAX
005215be : JZ 0x005215c3
005215c0 : ADD dword ptr [EAX + 0x4],EDI
005215c3 : MOV EBP,dword ptr [ESP + 0xa4]
005215ca : MOV EAX,dword ptr [EBP]
005215cd : CMP EAX,0x40
005215d0 : JZ 0x005215d9
005215d2 : CMP EAX,0x80
005215d7 : JNZ 0x005215fd
005215d9 : MOV ECX,ESI
005215db : CALL 0x005296a0
005215e0 : TEST EAX,EAX
005215e2 : JZ 0x005215fd
005215e4 : MOV ECX,dword ptr [EBP + 0x4]
005215e7 : MOVZX EDX,byte ptr [EBP + 0xa]
005215eb : PUSH ECX
005215ec : MOVZX ECX,word ptr [EBP + 0x8]
005215f0 : PUSH EDX
005215f1 : PUSH ECX
005215f2 : MOV ECX,dword ptr [EAX + 0x9e4]
005215f8 : CALL 0x005b0ab0
005215fd : PUSH EBP
005215fe : MOV ECX,EBX
00521600 : MOV dword ptr [ESP + 0x18],0x0
00521608 : MOV byte ptr [ESP + 0x24],0x0
0052160d : CALL 0x00520600
00521612 : TEST AL,AL
00521614 : JZ 0x00521629
00521616 : CMP byte ptr [EBP + 0xc],0x0
0052161a : JNZ 0x00521629
0052161c : PUSH EBP
0052161d : PUSH ESI
0052161e : MOV ECX,EBX
00521620 : CALL 0x005206c0
00521625 : MOV dword ptr [ESP + 0x14],EDI
00521629 : LEA EDI,[ESI + 0x78]
0052162c : PUSH EDI
0052162d : LEA EDX,[ESP + 0x14]
00521631 : PUSH EDX
00521632 : MOV ECX,EBP
00521634 : CALL 0x00529910
00521639 : MOV EAX,dword ptr [ESP + 0x10]
0052163d : CMP dword ptr [EAX + 0x10],0x0
00521641 : JBE 0x00521a57
00521647 : MOV EDX,dword ptr [EBX + 0x68]
0052164a : MOV EDX,dword ptr [EDX + 0x2c]
0052164d : LEA EAX,[ESP + 0x20]
00521651 : PUSH EAX
00521652 : LEA ECX,[EBX + 0x68]
00521655 : LEA EAX,[ESP + 0x14]
00521659 : PUSH EAX
0052165a : PUSH EDI
0052165b : CALL EDX
0052165d : TEST AL,AL
0052165f : JZ 0x00521a57
00521665 : CMP byte ptr [ESP + 0x20],0x9
0052166a : JNZ 0x0052169b
0052166c : LEA EAX,[ESP + 0x70]
00521670 : PUSH EAX
00521671 : LEA EAX,[EBX + 0x68]
00521674 : PUSH EAX
00521675 : PUSH ESI
00521676 : LEA ECX,[ESP + 0x2c]
0052167a : MOV byte ptr [ESP + 0x7c],0x0
0052167f : CALL 0x00526d80
00521684 : LEA ECX,[ESP + 0x70]
00521688 : PUSH ECX
00521689 : LEA ECX,[ESP + 0x24]
0052168d : CALL 0x005268b0
00521692 : LEA ECX,[ESP + 0x70]
00521696 : CALL 0x00526bc0
0052169b : CMP byte ptr [ESP + 0x20],0x1
005216a0 : JZ 0x00521a57
005216a6 : MOV EDX,dword ptr [EDI]
005216a8 : CMP byte ptr [EDX + 0x2a4],0x1
005216af : JNZ 0x0052192b
005216b5 : CMP byte ptr [EBP + 0xc],0x0
005216b9 : MOV dword ptr [ESP + 0x18],0x0
005216c1 : MOV BL,0x1
005216c3 : JZ 0x00521722
005216c5 : PUSH ESI
005216c6 : LEA EAX,[ESP + 0x34]
005216ca : PUSH EAX
005216cb : LEA ECX,[ESP + 0x28]
005216cf : CALL 0x00527140
005216d4 : MOV ECX,dword ptr [ESP + 0x30]
005216d8 : TEST ECX,ECX
005216da : JZ 0x005216ee
005216dc : MOV EDX,dword ptr [ECX]
005216de : MOV EAX,dword ptr [EDX + 0x40]
005216e1 : CALL EAX
005216e3 : CMP EAX,0x2
005216e6 : MOV ECX,dword ptr [ESP + 0x30]
005216ea : JGE 0x005216ee
005216ec : XOR BL,BL
005216ee : TEST byte ptr [ESP + 0x38],0x2
005216f3 : JNZ 0x005216fe
005216f5 : TEST ECX,ECX
005216f7 : JZ 0x005216fe
005216f9 : CALL 0x00503db0
005216fe : TEST byte ptr [ESP + 0x38],0x1
00521703 : MOV dword ptr [ESP + 0x30],0x0
0052170b : JNZ 0x0052171a
0052170d : MOV ECX,dword ptr [ESP + 0x34]
00521711 : TEST ECX,ECX
00521713 : JZ 0x0052171a
00521715 : CALL 0x00503db0
0052171a : TEST BL,BL
0052171c : JZ 0x00521a57
00521722 : INC dword ptr [ESP + 0x14]
00521726 : MOV ECX,ESI
00521728 : CALL 0x0052a360
0052172d : TEST AL,AL
0052172f : JZ 0x005217a1
00521731 : MOV ECX,dword ptr [ESP + 0x1c]
00521735 : MOV EAX,dword ptr [ECX + 0x80]
0052173b : TEST EAX,EAX
0052173d : JNZ 0x00521744
0052173f : CALL 0x00520df0
00521744 : MOV ECX,dword ptr [EAX + 0xc]
00521747 : MOV EDI,dword ptr [ECX]
00521749 : PUSH ESI
0052174a : LEA EDX,[ESP + 0x40]
0052174e : PUSH EDX
0052174f : LEA ECX,[ESP + 0x28]
00521753 : CALL 0x00527140
00521758 : MOV EAX,dword ptr [EAX]
0052175a : MOV ECX,dword ptr [ESP + 0x10]
0052175e : MOV EDX,dword ptr [ECX]
00521760 : PUSH EDI
00521761 : PUSH EAX
00521762 : PUSH EDX
00521763 : PUSH 0xb8abe0
00521768 : PUSH ESI
00521769 : CALL 0x0051d420
0052176e : ADD ESP,0x14
00521771 : TEST byte ptr [ESP + 0x44],0x2
00521776 : JNZ 0x00521785
00521778 : MOV ECX,dword ptr [ESP + 0x3c]
0052177c : TEST ECX,ECX
0052177e : JZ 0x00521785
00521780 : CALL 0x00503db0
00521785 : TEST byte ptr [ESP + 0x44],0x1
0052178a : MOV dword ptr [ESP + 0x3c],0x0
00521792 : JNZ 0x005217a1
00521794 : MOV ECX,dword ptr [ESP + 0x40]
00521798 : TEST ECX,ECX
0052179a : JZ 0x005217a1
0052179c : CALL 0x00503db0
005217a1 : MOV EAX,dword ptr [EBP]
005217a4 : MOV BL,0x4
005217a6 : CMP EAX,0x2000
005217ab : JZ 0x005217c2
005217ad : CMP EAX,0x4000
005217b2 : JZ 0x005217c2
005217b4 : CMP EAX,0x8000
005217b9 : JZ 0x005217c2
005217bb : CMP EAX,0x10000
005217c0 : JNZ 0x00521810
005217c2 : MOVZX EAX,byte ptr [EBP + 0xc]
005217c6 : ADD dword ptr [ESI + 0x8],0x10
005217ca : LEA EDI,[ESI + 0x8]
005217cd : MOV dword ptr [ESP + 0x84],EAX
005217d4 : MOV EAX,dword ptr [EDI]
005217d6 : MOV byte ptr [ESP + 0x80],BL
005217dd : CMP EAX,dword ptr [EDI + 0x8]
005217e0 : JC 0x005217e9
005217e2 : MOV ECX,EDI
005217e4 : CALL 0x00504050
005217e9 : MOV ECX,dword ptr [EDI]
005217eb : TEST ECX,ECX
005217ed : JZ 0x005217fc
005217ef : LEA EDX,[ESP + 0x80]
005217f6 : PUSH EDX
005217f7 : CALL 0x005266c0
005217fc : LEA ECX,[ESP + 0x80]
00521803 : CALL 0x00526bc0
00521808 : MOV dword ptr [ESP + 0x18],0x1
00521810 : MOV AL,byte ptr [EBP + 0xb]
00521813 : TEST AL,AL
00521815 : JGE 0x0052181e
00521817 : CMP dword ptr [ESP + 0x18],0x0
0052181c : JBE 0x00521867
0052181e : ADD dword ptr [ESI + 0x8],0x10
00521822 : MOVSX EAX,AL
00521825 : LEA EDI,[ESI + 0x8]
00521828 : MOV dword ptr [ESP + 0x94],EAX
0052182f : MOV EAX,dword ptr [EDI]
00521831 : MOV byte ptr [ESP + 0x90],BL
00521838 : CMP EAX,dword ptr [EDI + 0x8]
0052183b : JC 0x00521844
0052183d : MOV ECX,EDI
0052183f : CALL 0x00504050
00521844 : MOV ECX,dword ptr [EDI]
00521846 : TEST ECX,ECX
00521848 : JZ 0x00521857
0052184a : LEA EDX,[ESP + 0x90]
00521851 : PUSH EDX
00521852 : CALL 0x005266c0
00521857 : LEA ECX,[ESP + 0x90]
0052185e : CALL 0x00526bc0
00521863 : INC dword ptr [ESP + 0x18]
00521867 : MOV EAX,dword ptr [ESP + 0x10]
0052186b : MOV ECX,dword ptr [EAX]
0052186d : MOV EDX,dword ptr [ESI + 0x8]
00521870 : SUB EDX,dword ptr [ESI + 0xc]
00521873 : MOV EAX,dword ptr [ESI + 0x1c]
00521876 : MOV EBP,dword ptr [ESP + 0x18]
0052187a : MOV EBX,dword ptr [ESP + 0x1c]
0052187e : LEA EDI,[ESI + 0x8]
00521881 : PUSH ECX
00521882 : SAR EDX,0x4
00521885 : SHL EAX,0x5
00521888 : LEA ECX,[EDX + EAX*0x1 + -0x20]
0052188c : PUSH ECX
0052188d : PUSH EBP
0052188e : PUSH ESI
0052188f : LEA EAX,[EBX + 0x68]
00521892 : PUSH EAX
00521893 : LEA EDX,[ESP + 0x34]
00521897 : PUSH 0x0
00521899 : PUSH EDX
0052189a : CALL 0x0052c930
0052189f : ADD ESP,0x1c
005218a2 : TEST EBP,EBP
005218a4 : JBE 0x005218ae
005218a6 : PUSH EBP
005218a7 : MOV ECX,EDI
005218a9 : CALL 0x00520a70
005218ae : MOV ECX,ESI
005218b0 : CALL 0x0052a360
005218b5 : TEST AL,AL
005218b7 : JZ 0x00521a57
005218bd : MOV EAX,dword ptr [EBX + 0x80]
005218c3 : TEST EAX,EAX
005218c5 : JNZ 0x005218ce
005218c7 : MOV ECX,EBX
005218c9 : CALL 0x00520df0
005218ce : MOV EAX,dword ptr [EAX + 0xc]
005218d1 : MOV EDI,dword ptr [EAX]
005218d3 : PUSH ESI
005218d4 : LEA ECX,[ESP + 0x50]
005218d8 : PUSH ECX
005218d9 : LEA ECX,[ESP + 0x28]
005218dd : CALL 0x00527140
005218e2 : MOV EDX,dword ptr [EAX]
005218e4 : MOV EAX,dword ptr [ESP + 0x10]
005218e8 : MOV ECX,dword ptr [EAX]
005218ea : PUSH EDI
005218eb : PUSH EDX
005218ec : PUSH ECX
005218ed : PUSH 0xb8abb0
005218f2 : PUSH ESI
005218f3 : CALL 0x0051d420
005218f8 : ADD ESP,0x14
005218fb : TEST byte ptr [ESP + 0x54],0x2
00521900 : JNZ 0x0052190f
00521902 : MOV ECX,dword ptr [ESP + 0x4c]
00521906 : TEST ECX,ECX
00521908 : JZ 0x0052190f
0052190a : CALL 0x00503db0
0052190f : TEST byte ptr [ESP + 0x54],0x1
00521914 : MOV dword ptr [ESP + 0x4c],0x0
0052191c : JNZ 0x00521a57
00521922 : MOV ECX,dword ptr [ESP + 0x50]
00521926 : JMP 0x00521a4e
0052192b : CMP byte ptr [EBP + 0xc],0x0
0052192f : JNZ 0x00521a57
00521935 : INC dword ptr [ESP + 0x14]
00521939 : MOV ECX,ESI
0052193b : CALL 0x0052a360
00521940 : TEST AL,AL
00521942 : JZ 0x005219b2
00521944 : MOV EAX,dword ptr [EBX + 0x80]
0052194a : TEST EAX,EAX
0052194c : JNZ 0x00521955
0052194e : MOV ECX,EBX
00521950 : CALL 0x00520df0
00521955 : MOV EDX,dword ptr [EAX + 0xc]
00521958 : MOV EDI,dword ptr [EDX]
0052195a : PUSH ESI
0052195b : LEA EAX,[ESP + 0x68]
0052195f : PUSH EAX
00521960 : LEA ECX,[ESP + 0x28]
00521964 : CALL 0x00527140
00521969 : MOV ECX,dword ptr [EAX]
0052196b : MOV EDX,dword ptr [ESP + 0x10]
0052196f : MOV EAX,dword ptr [EDX]
00521971 : PUSH EDI
00521972 : PUSH ECX
00521973 : PUSH EAX
00521974 : PUSH 0xb8abe0
00521979 : PUSH ESI
0052197a : CALL 0x0051d420
0052197f : ADD ESP,0x14
00521982 : TEST byte ptr [ESP + 0x6c],0x2
00521987 : JNZ 0x00521996
00521989 : MOV ECX,dword ptr [ESP + 0x64]
0052198d : TEST ECX,ECX
0052198f : JZ 0x00521996
00521991 : CALL 0x00503db0
00521996 : TEST byte ptr [ESP + 0x6c],0x1
0052199b : MOV dword ptr [ESP + 0x64],0x0
005219a3 : JNZ 0x005219b2
005219a5 : MOV ECX,dword ptr [ESP + 0x68]
005219a9 : TEST ECX,ECX
005219ab : JZ 0x005219b2
005219ad : CALL 0x00503db0
005219b2 : MOV ECX,dword ptr [ESI + 0x8]
005219b5 : SUB ECX,dword ptr [ESI + 0xc]
005219b8 : MOV EDX,dword ptr [ESI + 0x1c]
005219bb : PUSH 0x0
005219bd : SAR ECX,0x4
005219c0 : SHL EDX,0x5
005219c3 : LEA EAX,[ECX + EDX*0x1 + -0x1f]
005219c7 : PUSH EAX
005219c8 : PUSH 0x0
005219ca : PUSH ESI
005219cb : LEA EAX,[EBX + 0x68]
005219ce : PUSH EAX
005219cf : LEA ECX,[ESP + 0x34]
005219d3 : PUSH 0x0
005219d5 : PUSH ECX
005219d6 : CALL 0x0052c930
005219db : ADD ESP,0x1c
005219de : MOV ECX,ESI
005219e0 : CALL 0x0052a360
005219e5 : TEST AL,AL
005219e7 : JZ 0x00521a57
005219e9 : MOV EAX,dword ptr [EBX + 0x80]
005219ef : TEST EAX,EAX
005219f1 : JNZ 0x005219fa
005219f3 : MOV ECX,EBX
005219f5 : CALL 0x00520df0
005219fa : MOV EDX,dword ptr [EAX + 0xc]
005219fd : MOV EDI,dword ptr [EDX]
005219ff : PUSH ESI
00521a00 : LEA EAX,[ESP + 0x5c]
00521a04 : PUSH EAX
00521a05 : LEA ECX,[ESP + 0x28]
00521a09 : CALL 0x00527140
00521a0e : MOV ECX,dword ptr [EAX]
00521a10 : MOV EDX,dword ptr [ESP + 0x10]
00521a14 : MOV EAX,dword ptr [EDX]
00521a16 : PUSH EDI
00521a17 : PUSH ECX
00521a18 : PUSH EAX
00521a19 : PUSH 0xb8abb0
00521a1e : PUSH ESI
00521a1f : CALL 0x0051d420
00521a24 : ADD ESP,0x14
00521a27 : TEST byte ptr [ESP + 0x60],0x2
00521a2c : JNZ 0x00521a3b
00521a2e : MOV ECX,dword ptr [ESP + 0x58]
00521a32 : TEST ECX,ECX
00521a34 : JZ 0x00521a3b
00521a36 : CALL 0x00503db0
00521a3b : TEST byte ptr [ESP + 0x60],0x1
00521a40 : MOV dword ptr [ESP + 0x58],0x0
00521a48 : JNZ 0x00521a57
00521a4a : MOV ECX,dword ptr [ESP + 0x5c]
00521a4e : TEST ECX,ECX
00521a50 : JZ 0x00521a57
00521a52 : CALL 0x00503db0
00521a57 : CMP dword ptr [ESP + 0x14],0x0
00521a5c : MOV EAX,dword ptr [ESP + 0x10]
00521a60 : SETNZ BL
00521a63 : DEC dword ptr [EAX + 0x8]
00521a66 : MOV ECX,EAX
00521a68 : ADD EAX,0x8
00521a6b : CMP dword ptr [EAX],0x0
00521a6e : POP ESI
00521a6f : POP EBP
00521a70 : JNZ 0x00521a77
00521a72 : CALL 0x00525340
00521a77 : LEA ECX,[ESP + 0x18]
00521a7b : CALL 0x00526bc0
00521a80 : MOV ECX,dword ptr [ESP + 0x40]
00521a84 : TEST ECX,ECX
00521a86 : JZ 0x00521a8d
00521a88 : CALL 0x004ff7c0
00521a8d : MOV ECX,dword ptr [ESP + 0x14]
00521a91 : CALL 0x004ff7c0
00521a96 : POP EDI
00521a97 : MOV AL,BL
00521a99 : POP EBX
00521a9a : ADD ESP,0x90
00521aa0 : RET 0x4

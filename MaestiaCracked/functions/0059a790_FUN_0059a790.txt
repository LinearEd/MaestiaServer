PROGRAM  : Maestia.exe
FUNCTION : FUN_0059a790
ENTRY    : 0059a790
BODY     : [[0059a790, 0059a823]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_0059a790(undefined4 param_1,int param_2)

{
  uint uVar1;
  uint uVar2;
  int *in_ECX;
  int iVar3;
  int iVar4;
  uint uVar5;
  
  if (param_2 != 0) {
    iVar3 = *in_ECX;
    if (iVar3 < 0) {
      uVar1 = in_ECX[2] & 0xffffff;
      if (uVar1 == 0xffffff) {
        uVar1 = 0xffffffff;
      }
    }
    else {
      uVar1 = in_ECX[2];
    }
    iVar4 = (int)in_ECX + 0x1e;
    if (iVar3 < 0) {
      uVar2 = (uint)*(byte *)(in_ECX + 7);
    }
    else {
      uVar2 = in_ECX[1];
      iVar4 = (int)in_ECX + 0x2a;
    }
    if (iVar3 < 0) {
      uVar5 = (uint)*(byte *)(in_ECX + 7);
      iVar3 = (int)in_ECX + 0x1e;
    }
    else {
      uVar5 = in_ECX[1];
      iVar3 = (int)in_ECX + 0x2a;
    }
    FUN_0059a6c0(iVar3,uVar5,iVar4 + uVar2 * 8 + 3 & 0xfffffffc,param_2,uVar1);
    return param_1;
  }
  FUN_005461c0(param_1);
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
0059a790 : PUSH EBP
0059a791 : MOV EBP,dword ptr [ESP + 0xc]
0059a795 : PUSH ESI
0059a796 : TEST EBP,EBP
0059a798 : JZ 0x0059a813
0059a79a : MOV EDX,dword ptr [ECX]
0059a79c : SHR EDX,0x1f
0059a79f : AND DL,0x1
0059a7a2 : PUSH EBX
0059a7a3 : PUSH EDI
0059a7a4 : JZ 0x0059a7be
0059a7a6 : MOV EAX,dword ptr [ECX + 0x8]
0059a7a9 : AND EAX,0xffffff
0059a7ae : CMP EAX,0xffffff
0059a7b3 : JNZ 0x0059a7ba
0059a7b5 : OR EBX,0xffffffff
0059a7b8 : JMP 0x0059a7c1
0059a7ba : MOV EBX,EAX
0059a7bc : JMP 0x0059a7c1
0059a7be : MOV EBX,dword ptr [ECX + 0x8]
0059a7c1 : LEA ESI,[ECX + 0x1e]
0059a7c4 : TEST DL,DL
0059a7c6 : JNZ 0x0059a7e3
0059a7c8 : MOV EAX,dword ptr [ECX + 0x4]
0059a7cb : LEA ESI,[ECX + 0x2a]
0059a7ce : LEA ESI,[ESI + EAX*0x8]
0059a7d1 : LEA EAX,[ESI + 0x3]
0059a7d4 : AND EAX,0xfffffffc
0059a7d7 : SUB EAX,ESI
0059a7d9 : TEST DL,DL
0059a7db : JZ 0x0059a7e9
0059a7dd : MOVZX EDI,byte ptr [ECX + 0x1c]
0059a7e1 : JMP 0x0059a7ec
0059a7e3 : MOVZX EAX,byte ptr [ECX + 0x1c]
0059a7e7 : JMP 0x0059a7ce
0059a7e9 : MOV EDI,dword ptr [ECX + 0x4]
0059a7ec : TEST DL,DL
0059a7ee : JZ 0x0059a7f5
0059a7f0 : ADD ECX,0x1e
0059a7f3 : JMP 0x0059a7f8
0059a7f5 : ADD ECX,0x2a
0059a7f8 : PUSH EBX
0059a7f9 : PUSH EBP
0059a7fa : ADD EAX,ESI
0059a7fc : MOV ESI,dword ptr [ESP + 0x1c]
0059a800 : PUSH EAX
0059a801 : PUSH EDI
0059a802 : PUSH ECX
0059a803 : MOV ECX,ESI
0059a805 : CALL 0x0059a6c0
0059a80a : POP EDI
0059a80b : POP EBX
0059a80c : MOV EAX,ESI
0059a80e : POP ESI
0059a80f : POP EBP
0059a810 : RET 0x8
0059a813 : MOV ESI,dword ptr [ESP + 0xc]
0059a817 : PUSH ESI
0059a818 : CALL 0x005461c0
0059a81d : MOV EAX,ESI
0059a81f : POP ESI
0059a820 : POP EBP
0059a821 : RET 0x8

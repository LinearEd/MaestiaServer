PROGRAM  : Maestia.exe
FUNCTION : FUN_00a0fe90
ENTRY    : 00a0fe90
BODY     : [[00a0fe90, 00a100a0]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00a0fe90(int param_1,int param_2)

{
  int iVar1;
  int *piVar2;
  int local_48;
  int iStack_44;
  int iStack_40;
  undefined1 auStack_3c [8];
  undefined1 local_34 [4];
  undefined2 local_30;
  undefined4 uStack_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b2fc18;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  iVar1 = *(int *)(param_2 + 8);
  local_48 = *(int *)(iVar1 + 8);
  if (local_48 == -1) {
    local_48 = *(int *)(param_1 + 0x14);
    FUN_008018d0(L"Packet Main : %d, Sub : %d",*(undefined1 *)(iVar1 + 2),*(undefined1 *)(iVar1 + 3)
                 ,DAT_00d66fa0 ^ (uint)&stack0xffffffa8);
    FUN_00406460(L"Invalid Tick");
    local_c = 0;
    if ((int *)*DAT_00da98e8 != (int *)0x0) {
      (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                (L"AvaActionQueueMgr::QueueActionToCharacter",0x1d8,local_34);
    }
    local_c = 0xffffffff;
    if (7 < local_1c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_1c = 7;
    uStack_20 = 0;
    local_30 = 0;
  }
  local_c = 0xffffffff;
  FUN_00a0fdc0(param_1);
  piVar2 = (int *)(iVar1 + 4);
  FUN_004437f0(piVar2);
  if (iStack_44 == *(int *)(param_1 + 4)) {
    iStack_44 = FUN_006f0760(0x8c,"",0,(DAT_01725270 >> 3 & 1) == 0);
    local_c = 1;
    if (iStack_44 == 0) {
      iVar1 = 0;
    }
    else {
      iVar1 = FUN_00a0fb50(iStack_44,*piVar2);
    }
    local_c = 0xffffffff;
    if (iVar1 == 0) {
      FUN_00406460(L"pActionQueu Alloc Failed");
      local_c = 2;
      if ((int *)*DAT_00da98e8 != (int *)0x0) {
        (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                  (L"AvaActionQueueMgr::QueueActionToCharacter",0x1f1,local_34);
      }
      local_c = 0xffffffff;
      if (local_1c < 8) {
        ExceptionList = local_14;
        return 0;
      }
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    iStack_44 = *piVar2;
    iStack_40 = iVar1;
    FUN_00451e00(auStack_3c,&iStack_44);
  }
  else {
    iVar1 = *(int *)(iStack_44 + 0x10);
  }
  if (iVar1 == 0) {
    ExceptionList = local_14;
    return 0;
  }
  FUN_00a0fbf0(local_48,param_2);
  ExceptionList = local_14;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
00a0fe90 : PUSH EBP
00a0fe91 : MOV EBP,ESP
00a0fe93 : AND ESP,0xfffffff8
00a0fe96 : PUSH -0x1
00a0fe98 : PUSH 0xb2fc18
00a0fe9d : MOV EAX,FS:[0x0]
00a0fea3 : PUSH EAX
00a0fea4 : SUB ESP,0x38
00a0fea7 : PUSH EBX
00a0fea8 : PUSH ESI
00a0fea9 : PUSH EDI
00a0feaa : MOV EAX,[0x00d66fa0]
00a0feaf : XOR EAX,ESP
00a0feb1 : PUSH EAX
00a0feb2 : LEA EAX,[ESP + 0x48]
00a0feb6 : MOV FS:[0x0],EAX
00a0febc : MOV EBX,dword ptr [EBP + 0x8]
00a0febf : MOV EAX,dword ptr [EBP + 0xc]
00a0fec2 : MOV EDI,dword ptr [EAX + 0x8]
00a0fec5 : MOV ECX,dword ptr [EDI + 0x8]
00a0fec8 : MOV dword ptr [ESP + 0x14],ECX
00a0fecc : CMP ECX,-0x1
00a0fecf : JNZ 0x00a0ff5e
00a0fed5 : MOVZX EDX,byte ptr [EDI + 0x3]
00a0fed9 : MOVZX EAX,byte ptr [EDI + 0x2]
00a0fedd : MOV ECX,dword ptr [EBX + 0x14]
00a0fee0 : MOV ESI,dword ptr [0x00da98e8]
00a0fee6 : PUSH EDX
00a0fee7 : PUSH EAX
00a0fee8 : PUSH 0xcbd9f0
00a0feed : MOV dword ptr [ESP + 0x20],ECX
00a0fef1 : CALL 0x008018d0
00a0fef6 : ADD ESP,0xc
00a0fef9 : PUSH 0xcbda28
00a0fefe : LEA ECX,[ESP + 0x2c]
00a0ff02 : CALL 0x00406460
00a0ff07 : XOR ESI,ESI
00a0ff09 : MOV dword ptr [ESP + 0x50],ESI
00a0ff0d : MOV ECX,dword ptr [0x00da98e8]
00a0ff13 : MOV ECX,dword ptr [ECX]
00a0ff15 : CMP ECX,ESI
00a0ff17 : JZ 0x00a0ff2f
00a0ff19 : MOV EDX,dword ptr [ECX]
00a0ff1b : MOV EDX,dword ptr [EDX + 0x14]
00a0ff1e : LEA EAX,[ESP + 0x28]
00a0ff22 : PUSH EAX
00a0ff23 : PUSH 0x1d8
00a0ff28 : PUSH 0xcbda48
00a0ff2d : CALL EDX
00a0ff2f : MOV dword ptr [ESP + 0x50],0xffffffff
00a0ff37 : CMP dword ptr [ESP + 0x40],0x8
00a0ff3c : JC 0x00a0ff47
00a0ff3e : MOV ECX,dword ptr [ESP + 0x2c]
00a0ff42 : CALL 0x006f04e0
00a0ff47 : MOV ECX,dword ptr [ESP + 0x14]
00a0ff4b : XOR EAX,EAX
00a0ff4d : MOV dword ptr [ESP + 0x40],0x7
00a0ff55 : MOV dword ptr [ESP + 0x3c],ESI
00a0ff59 : MOV word ptr [ESP + 0x2c],AX
00a0ff5e : PUSH EBX
00a0ff5f : CALL 0x00a0fdc0
00a0ff64 : ADD EDI,0x4
00a0ff67 : PUSH EDI
00a0ff68 : LEA EAX,[ESP + 0x1c]
00a0ff6c : MOV ECX,EBX
00a0ff6e : CALL 0x004437f0
00a0ff73 : MOV EAX,dword ptr [EBX + 0x4]
00a0ff76 : MOV ECX,dword ptr [ESP + 0x18]
00a0ff7a : CMP ECX,EAX
00a0ff7c : JZ 0x00a0ff86
00a0ff7e : MOV ESI,dword ptr [ECX + 0x10]
00a0ff81 : JMP 0x00a10073
00a0ff86 : MOV ECX,dword ptr [0x01725270]
00a0ff8c : SHR ECX,0x3
00a0ff8f : MOV EDX,0x0
00a0ff94 : AND ECX,0x1
00a0ff97 : SETZ DL
00a0ff9a : PUSH EDX
00a0ff9b : PUSH 0x0
00a0ff9d : PUSH 0xbf1a4a
00a0ffa2 : PUSH 0x8c
00a0ffa7 : CALL 0x006f0760
00a0ffac : ADD ESP,0x10
00a0ffaf : MOV dword ptr [ESP + 0x18],EAX
00a0ffb3 : MOV dword ptr [ESP + 0x50],0x1
00a0ffbb : TEST EAX,EAX
00a0ffbd : JZ 0x00a0ffca
00a0ffbf : MOV ECX,dword ptr [EDI]
00a0ffc1 : PUSH ECX
00a0ffc2 : PUSH EAX
00a0ffc3 : CALL 0x00a0fb50
00a0ffc8 : JMP 0x00a0ffcc
00a0ffca : XOR EAX,EAX
00a0ffcc : MOV dword ptr [ESP + 0x50],0xffffffff
00a0ffd4 : MOV ESI,EAX
00a0ffd6 : TEST EAX,EAX
00a0ffd8 : JNZ 0x00a10058
00a0ffda : PUSH 0xcbda9c
00a0ffdf : LEA ECX,[ESP + 0x2c]
00a0ffe3 : CALL 0x00406460
00a0ffe8 : MOV dword ptr [ESP + 0x50],0x2
00a0fff0 : MOV EDX,dword ptr [0x00da98e8]
00a0fff6 : MOV ECX,dword ptr [EDX]
00a0fff8 : TEST ECX,ECX
00a0fffa : JZ 0x00a10012
00a0fffc : MOV EAX,dword ptr [ECX]
00a0fffe : MOV EAX,dword ptr [EAX + 0x14]
00a10001 : LEA EDX,[ESP + 0x28]
00a10005 : PUSH EDX
00a10006 : PUSH 0x1f1
00a1000b : PUSH 0xcbdad0
00a10010 : CALL EAX
00a10012 : MOV dword ptr [ESP + 0x50],0xffffffff
00a1001a : CMP dword ptr [ESP + 0x40],0x8
00a1001f : JC 0x00a1002a
00a10021 : MOV ECX,dword ptr [ESP + 0x2c]
00a10025 : CALL 0x006f04e0
00a1002a : XOR ECX,ECX
00a1002c : MOV dword ptr [ESP + 0x40],0x7
00a10034 : MOV dword ptr [ESP + 0x3c],0x0
00a1003c : MOV word ptr [ESP + 0x2c],CX
00a10041 : XOR EAX,EAX
00a10043 : MOV ECX,dword ptr [ESP + 0x48]
00a10047 : MOV dword ptr FS:[0x0],ECX
00a1004e : POP ECX
00a1004f : POP EDI
00a10050 : POP ESI
00a10051 : POP EBX
00a10052 : MOV ESP,EBP
00a10054 : POP EBP
00a10055 : RET 0x8
00a10058 : MOV EDX,dword ptr [EDI]
00a1005a : MOV dword ptr [ESP + 0x1c],EAX
00a1005e : LEA EAX,[ESP + 0x18]
00a10062 : PUSH EAX
00a10063 : LEA ECX,[ESP + 0x24]
00a10067 : PUSH ECX
00a10068 : MOV EAX,EBX
00a1006a : MOV dword ptr [ESP + 0x20],EDX
00a1006e : CALL 0x00451e00
00a10073 : TEST ESI,ESI
00a10075 : JZ 0x00a10041
00a10077 : MOV EDX,dword ptr [EBP + 0xc]
00a1007a : MOV EAX,dword ptr [ESP + 0x14]
00a1007e : PUSH EDX
00a1007f : PUSH EAX
00a10080 : MOV ECX,ESI
00a10082 : CALL 0x00a0fbf0
00a10087 : MOV EAX,0x1
00a1008c : MOV ECX,dword ptr [ESP + 0x48]
00a10090 : MOV dword ptr FS:[0x0],ECX
00a10097 : POP ECX
00a10098 : POP EDI
00a10099 : POP ESI
00a1009a : POP EBX
00a1009b : MOV ESP,EBP
00a1009d : POP EBP
00a1009e : RET 0x8

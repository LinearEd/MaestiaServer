PROGRAM  : Maestia.exe
FUNCTION : FUN_005ed030
ENTRY    : 005ed030
BODY     : [[005ed030, 005ed0ba]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005ed030(void)

{
  uint uVar1;
  int iVar2;
  int *in_ECX;
  undefined4 *puVar3;
  int iVar4;
  uint uVar5;
  
  uVar1 = in_ECX[1];
  uVar5 = 0;
  in_ECX[3] = 0;
  if (uVar1 != 0) {
    do {
      iVar2 = *in_ECX;
      iVar4 = uVar5 * 4;
      (**(code **)(**(int **)(iVar2 + uVar5 * 4) + 0x74))();
      uVar5 = uVar5 + 1;
      *(undefined4 *)(*(int *)(iVar2 + iVar4) + 0x20) = 0;
    } while (uVar5 < uVar1);
  }
  iVar4 = in_ECX[1];
  if (iVar4 == 0) {
    if (in_ECX[2] == 0) {
      FUN_005b5ef0(in_ECX,0);
    }
  }
  else {
    puVar3 = (undefined4 *)(*in_ECX + -4 + iVar4 * 4);
    do {
      if ((GRefCountNTSImpl *)*puVar3 != (GRefCountNTSImpl *)0x0) {
        GRefCountNTSImpl::Release((GRefCountNTSImpl *)*puVar3);
      }
      puVar3 = puVar3 + -1;
      iVar4 = iVar4 + -1;
    } while (iVar4 != 0);
    if ((in_ECX[2] & 0xfffffffeU) != 0) {
      if (*in_ECX != 0) {
        FUN_00515cf0(*in_ECX);
        *in_ECX = 0;
      }
      in_ECX[2] = 0;
      in_ECX[1] = 0;
      return;
    }
  }
  in_ECX[1] = 0;
  return;
}



============================================================
DISASSEMBLY
============================================================
005ed030 : PUSH EBX
005ed031 : PUSH EBP
005ed032 : PUSH ESI
005ed033 : MOV ESI,ECX
005ed035 : MOV EBP,dword ptr [ESI + 0x4]
005ed038 : PUSH EDI
005ed039 : XOR EDI,EDI
005ed03b : MOV dword ptr [ESI + 0xc],EDI
005ed03e : CMP EBP,EDI
005ed040 : JBE 0x005ed061
005ed042 : MOV EAX,dword ptr [ESI]
005ed044 : MOV ECX,dword ptr [EAX + EDI*0x4]
005ed047 : MOV EDX,dword ptr [ECX]
005ed049 : LEA EBX,[EAX + EDI*0x4]
005ed04c : MOV EAX,dword ptr [EDX + 0x74]
005ed04f : CALL EAX
005ed051 : MOV ECX,dword ptr [EBX]
005ed053 : INC EDI
005ed054 : MOV dword ptr [ECX + 0x20],0x0
005ed05b : CMP EDI,EBP
005ed05d : JC 0x005ed042
005ed05f : XOR EDI,EDI
005ed061 : MOV EAX,dword ptr [ESI + 0x4]
005ed064 : CMP EAX,EDI
005ed066 : JBE 0x005ed0a5
005ed068 : MOV EDX,dword ptr [ESI]
005ed06a : LEA EBX,[EDX + EAX*0x4 + -0x4]
005ed06e : MOV EBP,EAX
005ed070 : MOV ECX,dword ptr [EBX]
005ed072 : CMP ECX,EDI
005ed074 : JZ 0x005ed07b
005ed076 : CALL 0x004ff7c0
005ed07b : SUB EBX,0x4
005ed07e : SUB EBP,0x1
005ed081 : JNZ 0x005ed070
005ed083 : TEST dword ptr [ESI + 0x8],0xfffffffe
005ed08a : JBE 0x005ed0b3
005ed08c : MOV EAX,dword ptr [ESI]
005ed08e : CMP EAX,EDI
005ed090 : JZ 0x005ed09a
005ed092 : PUSH EAX
005ed093 : CALL 0x00515cf0
005ed098 : MOV dword ptr [ESI],EDI
005ed09a : MOV dword ptr [ESI + 0x8],EDI
005ed09d : MOV dword ptr [ESI + 0x4],EDI
005ed0a0 : POP EDI
005ed0a1 : POP ESI
005ed0a2 : POP EBP
005ed0a3 : POP EBX
005ed0a4 : RET
005ed0a5 : CMP dword ptr [ESI + 0x8],EDI
005ed0a8 : JA 0x005ed0b3
005ed0aa : PUSH EDI
005ed0ab : PUSH ESI
005ed0ac : MOV ECX,ESI
005ed0ae : CALL 0x005b5ef0
005ed0b3 : MOV dword ptr [ESI + 0x4],EDI
005ed0b6 : POP EDI
005ed0b7 : POP ESI
005ed0b8 : POP EBP
005ed0b9 : POP EBX
005ed0ba : RET

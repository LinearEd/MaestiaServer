PROGRAM  : Maestia.exe
FUNCTION : FUN_0082fea0
ENTRY    : 0082fea0
BODY     : [[0082fea0, 008300a6]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0082fea0(int param_1)

{
  int *piVar1;
  uint uVar2;
  undefined4 uVar3;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b48c97;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  *(undefined4 *)(param_1 + 0xc4) = 0;
  *(undefined4 *)(param_1 + 0xc0) = 1;
  *(undefined4 *)(param_1 + 0xcc) = 0;
  *(undefined4 *)(param_1 + 0x74) = 0;
  FUN_00406360();
  uVar2 = *(uint *)(param_1 + 0xf4);
  if (uVar2 < 2) {
    uVar2 = 1;
  }
  *(uint *)(param_1 + 0xf4) = uVar2;
  piVar1 = DAT_00da9894;
  *(undefined4 *)(*(int *)(*DAT_00da9894 + 0x260) + 0x50) = 1;
  *(undefined4 *)(*(int *)(*piVar1 + 0x284) + 0x138) = 1;
  piVar1 = *(int **)(*piVar1 + 0x1a8);
  FUN_00404750();
  local_8 = 0;
  (**(code **)(*piVar1 + 0x44))();
  local_8 = 0xffffffff;
  if (7 < local_14) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  FUN_00405eb0(*(int *)(param_1 + 0x7c) + 0x1c,0,0xffffffff);
  local_8 = 0xffffffff;
  uVar3 = FUN_0082fdd0();
  *(undefined4 *)(param_1 + 0xc4) = uVar3;
  piVar1 = DAT_00da9894;
  *(undefined4 *)(*(int *)(*DAT_00da9894 + 0x260) + 0x50) = 0;
  piVar1 = *(int **)(*piVar1 + 0x284);
  if (piVar1[0x4e] != 0) {
    (**(code **)(*piVar1 + 0x24))();
    piVar1[0x4e] = 0;
  }
  FUN_0082d5c0();
  FUN_0082d5c0();
  FUN_0082d5c0();
  if (*(FILE **)(param_1 + 0x130) != (FILE *)0x0) {
    _fclose(*(FILE **)(param_1 + 0x130));
    *(undefined4 *)(param_1 + 0x130) = 0;
    ShellExecuteA((HWND)0x0,"open",(LPCSTR)(param_1 + 0x134),(LPCSTR)0x0,(LPCSTR)0x0,5);
  }
  if (*(HANDLE *)(param_1 + 0x6c) != (HANDLE)0x0) {
    CloseHandle(*(HANDLE *)(param_1 + 0x6c));
    *(undefined4 *)(param_1 + 0x6c) = 0;
  }
  if (*(HANDLE *)(param_1 + 0x70) != (HANDLE)0x0) {
    CloseHandle(*(HANDLE *)(param_1 + 0x70));
    *(undefined4 *)(param_1 + 0x70) = 0;
  }
  *(undefined4 *)(param_1 + 0x74) = 0;
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
0082fea0 : PUSH EBP
0082fea1 : MOV EBP,ESP
0082fea3 : PUSH -0x1
0082fea5 : PUSH 0xb48c97
0082feaa : MOV EAX,FS:[0x0]
0082feb0 : PUSH EAX
0082feb1 : SUB ESP,0x20
0082feb4 : PUSH EBX
0082feb5 : PUSH ESI
0082feb6 : PUSH EDI
0082feb7 : MOV EAX,[0x00d66fa0]
0082febc : XOR EAX,EBP
0082febe : PUSH EAX
0082febf : LEA EAX,[EBP + -0xc]
0082fec2 : MOV FS:[0x0],EAX
0082fec8 : MOV EBX,dword ptr [EBP + 0x8]
0082fecb : XOR EAX,EAX
0082fecd : PUSH EAX
0082fece : MOV ESI,0x1
0082fed3 : PUSH 0xc35e4c
0082fed8 : LEA ECX,[EBX + 0xa4]
0082fede : MOV dword ptr [EBX + 0xc4],EAX
0082fee4 : MOV dword ptr [EBX + 0xc0],ESI
0082feea : MOV dword ptr [EBX + 0xcc],EAX
0082fef0 : MOV dword ptr [EBX + 0x74],EAX
0082fef3 : CALL 0x00406360
0082fef8 : MOV EAX,dword ptr [EBX + 0xf4]
0082fefe : CMP EAX,ESI
0082ff00 : JA 0x0082ff04
0082ff02 : MOV EAX,ESI
0082ff04 : MOV dword ptr [EBX + 0xf4],EAX
0082ff0a : MOV EAX,[0x00da9894]
0082ff0f : MOV ECX,dword ptr [EAX]
0082ff11 : MOV ECX,dword ptr [ECX + 0x260]
0082ff17 : MOV dword ptr [ECX + 0x50],ESI
0082ff1a : MOV ECX,dword ptr [EAX]
0082ff1c : MOV ECX,dword ptr [ECX + 0x284]
0082ff22 : MOV dword ptr [ECX + 0x138],ESI
0082ff28 : MOV EAX,dword ptr [EAX]
0082ff2a : MOV EDI,dword ptr [EAX + 0x1a8]
0082ff30 : MOV EAX,dword ptr [EBX + 0x7c]
0082ff33 : ADD EAX,0x1c
0082ff36 : CMP dword ptr [EAX + 0x18],0x8
0082ff3a : JC 0x0082ff41
0082ff3c : MOV EAX,dword ptr [EAX + 0x4]
0082ff3f : JMP 0x0082ff44
0082ff41 : ADD EAX,0x4
0082ff44 : MOV ECX,dword ptr [EBX + 0xf4]
0082ff4a : PUSH ECX
0082ff4b : PUSH EAX
0082ff4c : PUSH 0xc35e90
0082ff51 : LEA ESI,[EBP + -0x28]
0082ff54 : CALL 0x00404750
0082ff59 : ADD ESP,0xc
0082ff5c : XOR ESI,ESI
0082ff5e : MOV dword ptr [EBP + -0x4],ESI
0082ff61 : MOV EDX,dword ptr [EDI]
0082ff63 : PUSH 0x13
0082ff65 : PUSH EAX
0082ff66 : MOV EAX,dword ptr [EDX + 0x44]
0082ff69 : MOV ECX,EDI
0082ff6b : CALL EAX
0082ff6d : MOV dword ptr [EBP + -0x4],0xffffffff
0082ff74 : CMP dword ptr [EBP + -0x10],0x8
0082ff78 : JC 0x0082ff82
0082ff7a : MOV ECX,dword ptr [EBP + -0x24]
0082ff7d : CALL 0x006f04e0
0082ff82 : MOV EAX,dword ptr [EBX + 0xf4]
0082ff88 : PUSH EAX
0082ff89 : MOV EAX,dword ptr [EBX + 0x7c]
0082ff8c : SUB ESP,0x1c
0082ff8f : XOR ECX,ECX
0082ff91 : MOV dword ptr [EBP + 0x8],ESP
0082ff94 : MOV word ptr [EBP + -0x24],CX
0082ff98 : MOV ECX,ESP
0082ff9a : MOV EDX,0x7
0082ff9f : PUSH -0x1
0082ffa1 : MOV dword ptr [ECX + 0x18],EDX
0082ffa4 : MOV dword ptr [EBP + -0x10],EDX
0082ffa7 : ADD EAX,0x1c
0082ffaa : PUSH ESI
0082ffab : XOR EDX,EDX
0082ffad : MOV dword ptr [ECX + 0x14],ESI
0082ffb0 : PUSH EAX
0082ffb1 : MOV dword ptr [EBP + -0x14],ESI
0082ffb4 : LEA EDI,[EBX + 0x78]
0082ffb7 : MOV word ptr [ECX + 0x4],DX
0082ffbb : CALL 0x00405eb0
0082ffc0 : MOV dword ptr [EBP + -0x4],0x1
0082ffc7 : MOV dword ptr [EBP + -0x4],0xffffffff
0082ffce : MOV ECX,EBX
0082ffd0 : CALL 0x0082fdd0
0082ffd5 : MOV dword ptr [EBX + 0xc4],EAX
0082ffdb : MOV EAX,[0x00da9894]
0082ffe0 : MOV ECX,dword ptr [EAX]
0082ffe2 : MOV EDX,dword ptr [ECX + 0x260]
0082ffe8 : XOR EDI,EDI
0082ffea : MOV dword ptr [EDX + 0x50],EDI
0082ffed : MOV EAX,dword ptr [EAX]
0082ffef : MOV ESI,dword ptr [EAX + 0x284]
0082fff5 : CMP dword ptr [ESI + 0x138],EDI
0082fffb : JZ 0x0083000c
0082fffd : MOV EDX,dword ptr [ESI]
0082ffff : MOV EAX,dword ptr [EDX + 0x24]
00830002 : MOV ECX,ESI
00830004 : CALL EAX
00830006 : MOV dword ptr [ESI + 0x138],EDI
0083000c : PUSH 0xc35f00
00830011 : MOV ESI,EBX
00830013 : CALL 0x0082d5c0
00830018 : MOV ECX,dword ptr [EBX + 0xc4]
0083001e : MOV EDX,dword ptr [EBX + 0x74]
00830021 : ADD ESP,0x4
00830024 : PUSH ECX
00830025 : PUSH EDX
00830026 : PUSH 0xc35f88
0083002b : CALL 0x0082d5c0
00830030 : ADD ESP,0xc
00830033 : PUSH 0xc35fd8
00830038 : CALL 0x0082d5c0
0083003d : MOV EAX,dword ptr [EBX + 0x130]
00830043 : ADD ESP,0x4
00830046 : CMP EAX,EDI
00830048 : JZ 0x00830070
0083004a : PUSH EAX
0083004b : CALL 0x006366db
00830050 : ADD ESP,0x4
00830053 : PUSH 0x5
00830055 : PUSH EDI
00830056 : PUSH EDI
00830057 : LEA EAX,[EBX + 0x134]
0083005d : PUSH EAX
0083005e : PUSH 0xc36358
00830063 : PUSH EDI
00830064 : MOV dword ptr [EBX + 0x130],EDI
0083006a : CALL dword ptr [0x00b853f8]
00830070 : MOV EAX,dword ptr [EBX + 0x6c]
00830073 : MOV ESI,dword ptr [0x00b85104]
00830079 : CMP EAX,EDI
0083007b : JZ 0x00830083
0083007d : PUSH EAX
0083007e : CALL ESI
00830080 : MOV dword ptr [EBX + 0x6c],EDI
00830083 : MOV EAX,dword ptr [EBX + 0x70]
00830086 : CMP EAX,EDI
00830088 : JZ 0x00830090
0083008a : PUSH EAX
0083008b : CALL ESI
0083008d : MOV dword ptr [EBX + 0x70],EDI
00830090 : MOV dword ptr [EBX + 0x74],EDI
00830093 : MOV ECX,dword ptr [EBP + -0xc]
00830096 : MOV dword ptr FS:[0x0],ECX
0083009d : POP ECX
0083009e : POP EDI
0083009f : POP ESI
008300a0 : POP EBX
008300a1 : MOV ESP,EBP
008300a3 : POP EBP
008300a4 : RET 0x4

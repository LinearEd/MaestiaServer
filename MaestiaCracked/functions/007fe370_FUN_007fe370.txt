PROGRAM  : Maestia.exe
FUNCTION : FUN_007fe370
ENTRY    : 007fe370
BODY     : [[007fe370, 007fe6f2]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007fe370(void)

{
  int *piVar1;
  uint uVar2;
  undefined4 *in_ECX;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  puStack_c = &LAB_00b2965b;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *in_ECX = &PTR_FUN_00cd43f8;
  local_8 = 8;
  if ((undefined4 *)in_ECX[0x66] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)in_ECX[0x66])(1,uVar2);
    in_ECX[0x66] = 0;
  }
  if ((undefined4 *)in_ECX[0x67] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)in_ECX[0x67])(1);
    in_ECX[0x67] = 0;
  }
  if ((GRefCountImpl *)in_ECX[0x129] != (GRefCountImpl *)0x0) {
    GRefCountImpl::Release((GRefCountImpl *)in_ECX[0x129]);
    in_ECX[0x129] = 0;
  }
  if ((undefined4 *)in_ECX[0x5f] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)in_ECX[0x5f])(1);
    in_ECX[0x5f] = 0;
  }
  if ((undefined4 *)in_ECX[0x5d] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)in_ECX[0x5d])(1);
    in_ECX[0x5d] = 0;
  }
  if ((undefined4 *)in_ECX[0x62] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)in_ECX[0x62])(1);
    in_ECX[0x62] = 0;
  }
  if ((undefined4 *)in_ECX[99] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)in_ECX[99])(1);
    in_ECX[99] = 0;
  }
  if ((undefined4 *)in_ECX[0x65] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)in_ECX[0x65])(1);
    in_ECX[0x65] = 0;
  }
  if ((undefined4 *)in_ECX[100] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)in_ECX[100])(1);
    in_ECX[100] = 0;
  }
  if ((undefined4 *)in_ECX[0x68] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)in_ECX[0x68])(1);
    in_ECX[0x68] = 0;
  }
  piVar1 = (int *)in_ECX[0xde];
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
    in_ECX[0xde] = 0;
  }
  piVar1 = (int *)in_ECX[0xdf];
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
    in_ECX[0xdf] = 0;
  }
  piVar1 = (int *)in_ECX[0xe0];
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
    in_ECX[0xe0] = 0;
  }
  piVar1 = (int *)in_ECX[0x10f];
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
    in_ECX[0x10f] = 0;
  }
  if ((undefined4 *)in_ECX[0x5e] != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)in_ECX[0x5e])(1);
    in_ECX[0x5e] = 0;
  }
  piVar1 = (int *)in_ECX[0x9c];
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
    in_ECX[0x9c] = 0;
  }
  piVar1 = (int *)in_ECX[0x9a];
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
    in_ECX[0x9a] = 0;
  }
  piVar1 = (int *)in_ECX[0x99];
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
    in_ECX[0x99] = 0;
  }
  piVar1 = (int *)in_ECX[0x9b];
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
    in_ECX[0x9b] = 0;
  }
  piVar1 = (int *)in_ECX[5];
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
    in_ECX[5] = 0;
  }
  if (in_ECX[0x12d] != -1) {
    uVar2 = 0;
    if (in_ECX[0x12e] != 0) {
      do {
        PostQueuedCompletionStatus((HANDLE)in_ECX[0x12d],0,0,(LPOVERLAPPED)0x0);
        uVar2 = uVar2 + 1;
      } while (uVar2 < (uint)in_ECX[0x12e]);
    }
    WaitForMultipleObjects(in_ECX[0x12e],(HANDLE *)(in_ECX + 0x12f),1,3000);
    CloseHandle((HANDLE)in_ECX[0x12d]);
  }
  local_8._0_1_ = 7;
  in_ECX[0x108] = &PTR_FUN_00cdec94;
  DeleteCriticalSection((LPCRITICAL_SECTION)(in_ECX + 0x109));
  local_8._0_1_ = 6;
  in_ECX[0x101] = &PTR_FUN_00cdec94;
  DeleteCriticalSection((LPCRITICAL_SECTION)(in_ECX + 0x102));
  local_8 = CONCAT31(local_8._1_3_,5);
  if (in_ECX[0xcb] != 0) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  in_ECX[0xcb] = 0;
  in_ECX[0xcc] = 0;
  in_ECX[0xcd] = 0;
  local_8 = CONCAT31(local_8._1_3_,4);
  if (7 < (uint)in_ECX[0xb8]) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  in_ECX[0xb8] = 7;
  in_ECX[0xb7] = 0;
  *(undefined2 *)(in_ECX + 0xb3) = 0;
  local_8 = CONCAT31(local_8._1_3_,3);
  if (7 < (uint)in_ECX[0xac]) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  in_ECX[0xac] = 7;
  in_ECX[0xab] = 0;
  *(undefined2 *)(in_ECX + 0xa7) = 0;
  local_8 = CONCAT31(local_8._1_3_,2);
  if (7 < (uint)in_ECX[0xa5]) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  in_ECX[0xa5] = 7;
  in_ECX[0xa4] = 0;
  *(undefined2 *)(in_ECX + 0xa0) = 0;
  in_ECX[0x6a] = &PTR_FUN_00cd083c;
  local_8 = (uint)local_8._1_3_ << 8;
  FUN_00401120(in_ECX + 2);
  DAT_017251ac = 0;
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
007fe370 : PUSH EBP
007fe371 : MOV EBP,ESP
007fe373 : PUSH -0x1
007fe375 : PUSH 0xb2965b
007fe37a : MOV EAX,FS:[0x0]
007fe380 : PUSH EAX
007fe381 : PUSH ECX
007fe382 : PUSH EBX
007fe383 : PUSH ESI
007fe384 : PUSH EDI
007fe385 : MOV EAX,[0x00d66fa0]
007fe38a : XOR EAX,EBP
007fe38c : PUSH EAX
007fe38d : LEA EAX,[EBP + -0xc]
007fe390 : MOV FS:[0x0],EAX
007fe396 : MOV ESI,ECX
007fe398 : MOV dword ptr [EBP + -0x10],ESI
007fe39b : MOV dword ptr [ESI],0xcd43f8
007fe3a1 : MOV dword ptr [EBP + -0x4],0x8
007fe3a8 : MOV ECX,dword ptr [ESI + 0x198]
007fe3ae : XOR EBX,EBX
007fe3b0 : CMP ECX,EBX
007fe3b2 : JZ 0x007fe3c2
007fe3b4 : MOV EAX,dword ptr [ECX]
007fe3b6 : MOV EDX,dword ptr [EAX]
007fe3b8 : PUSH 0x1
007fe3ba : CALL EDX
007fe3bc : MOV dword ptr [ESI + 0x198],EBX
007fe3c2 : MOV ECX,dword ptr [ESI + 0x19c]
007fe3c8 : CMP ECX,EBX
007fe3ca : JZ 0x007fe3da
007fe3cc : MOV EAX,dword ptr [ECX]
007fe3ce : MOV EDX,dword ptr [EAX]
007fe3d0 : PUSH 0x1
007fe3d2 : CALL EDX
007fe3d4 : MOV dword ptr [ESI + 0x19c],EBX
007fe3da : MOV ECX,dword ptr [ESI + 0x4a4]
007fe3e0 : CMP ECX,EBX
007fe3e2 : JZ 0x007fe3ef
007fe3e4 : CALL 0x004ff7e0
007fe3e9 : MOV dword ptr [ESI + 0x4a4],EBX
007fe3ef : MOV ECX,dword ptr [ESI + 0x17c]
007fe3f5 : CMP ECX,EBX
007fe3f7 : JZ 0x007fe407
007fe3f9 : MOV EAX,dword ptr [ECX]
007fe3fb : MOV EDX,dword ptr [EAX]
007fe3fd : PUSH 0x1
007fe3ff : CALL EDX
007fe401 : MOV dword ptr [ESI + 0x17c],EBX
007fe407 : MOV ECX,dword ptr [ESI + 0x174]
007fe40d : CMP ECX,EBX
007fe40f : JZ 0x007fe41f
007fe411 : MOV EAX,dword ptr [ECX]
007fe413 : MOV EDX,dword ptr [EAX]
007fe415 : PUSH 0x1
007fe417 : CALL EDX
007fe419 : MOV dword ptr [ESI + 0x174],EBX
007fe41f : MOV ECX,dword ptr [ESI + 0x188]
007fe425 : CMP ECX,EBX
007fe427 : JZ 0x007fe437
007fe429 : MOV EAX,dword ptr [ECX]
007fe42b : MOV EDX,dword ptr [EAX]
007fe42d : PUSH 0x1
007fe42f : CALL EDX
007fe431 : MOV dword ptr [ESI + 0x188],EBX
007fe437 : MOV ECX,dword ptr [ESI + 0x18c]
007fe43d : CMP ECX,EBX
007fe43f : JZ 0x007fe44f
007fe441 : MOV EAX,dword ptr [ECX]
007fe443 : MOV EDX,dword ptr [EAX]
007fe445 : PUSH 0x1
007fe447 : CALL EDX
007fe449 : MOV dword ptr [ESI + 0x18c],EBX
007fe44f : MOV ECX,dword ptr [ESI + 0x194]
007fe455 : CMP ECX,EBX
007fe457 : JZ 0x007fe467
007fe459 : MOV EAX,dword ptr [ECX]
007fe45b : MOV EDX,dword ptr [EAX]
007fe45d : PUSH 0x1
007fe45f : CALL EDX
007fe461 : MOV dword ptr [ESI + 0x194],EBX
007fe467 : MOV ECX,dword ptr [ESI + 0x190]
007fe46d : CMP ECX,EBX
007fe46f : JZ 0x007fe47f
007fe471 : MOV EAX,dword ptr [ECX]
007fe473 : MOV EDX,dword ptr [EAX]
007fe475 : PUSH 0x1
007fe477 : CALL EDX
007fe479 : MOV dword ptr [ESI + 0x190],EBX
007fe47f : MOV ECX,dword ptr [ESI + 0x1a0]
007fe485 : CMP ECX,EBX
007fe487 : JZ 0x007fe497
007fe489 : MOV EAX,dword ptr [ECX]
007fe48b : MOV EDX,dword ptr [EAX]
007fe48d : PUSH 0x1
007fe48f : CALL EDX
007fe491 : MOV dword ptr [ESI + 0x1a0],EBX
007fe497 : MOV EAX,dword ptr [ESI + 0x378]
007fe49d : CMP EAX,EBX
007fe49f : JZ 0x007fe4af
007fe4a1 : MOV ECX,dword ptr [EAX]
007fe4a3 : MOV EDX,dword ptr [ECX + 0x8]
007fe4a6 : PUSH EAX
007fe4a7 : CALL EDX
007fe4a9 : MOV dword ptr [ESI + 0x378],EBX
007fe4af : MOV EAX,dword ptr [ESI + 0x37c]
007fe4b5 : CMP EAX,EBX
007fe4b7 : JZ 0x007fe4c7
007fe4b9 : MOV ECX,dword ptr [EAX]
007fe4bb : MOV EDX,dword ptr [ECX + 0x8]
007fe4be : PUSH EAX
007fe4bf : CALL EDX
007fe4c1 : MOV dword ptr [ESI + 0x37c],EBX
007fe4c7 : MOV EAX,dword ptr [ESI + 0x380]
007fe4cd : CMP EAX,EBX
007fe4cf : JZ 0x007fe4df
007fe4d1 : MOV ECX,dword ptr [EAX]
007fe4d3 : MOV EDX,dword ptr [ECX + 0x8]
007fe4d6 : PUSH EAX
007fe4d7 : CALL EDX
007fe4d9 : MOV dword ptr [ESI + 0x380],EBX
007fe4df : MOV EAX,dword ptr [ESI + 0x43c]
007fe4e5 : CMP EAX,EBX
007fe4e7 : JZ 0x007fe4f7
007fe4e9 : MOV ECX,dword ptr [EAX]
007fe4eb : MOV EDX,dword ptr [ECX + 0x8]
007fe4ee : PUSH EAX
007fe4ef : CALL EDX
007fe4f1 : MOV dword ptr [ESI + 0x43c],EBX
007fe4f7 : MOV ECX,dword ptr [ESI + 0x178]
007fe4fd : CMP ECX,EBX
007fe4ff : JZ 0x007fe50f
007fe501 : MOV EAX,dword ptr [ECX]
007fe503 : MOV EDX,dword ptr [EAX]
007fe505 : PUSH 0x1
007fe507 : CALL EDX
007fe509 : MOV dword ptr [ESI + 0x178],EBX
007fe50f : MOV EAX,dword ptr [ESI + 0x270]
007fe515 : CMP EAX,EBX
007fe517 : JZ 0x007fe527
007fe519 : MOV ECX,dword ptr [EAX]
007fe51b : MOV EDX,dword ptr [ECX + 0x8]
007fe51e : PUSH EAX
007fe51f : CALL EDX
007fe521 : MOV dword ptr [ESI + 0x270],EBX
007fe527 : MOV EAX,dword ptr [ESI + 0x268]
007fe52d : CMP EAX,EBX
007fe52f : JZ 0x007fe53f
007fe531 : MOV ECX,dword ptr [EAX]
007fe533 : MOV EDX,dword ptr [ECX + 0x8]
007fe536 : PUSH EAX
007fe537 : CALL EDX
007fe539 : MOV dword ptr [ESI + 0x268],EBX
007fe53f : MOV EAX,dword ptr [ESI + 0x264]
007fe545 : CMP EAX,EBX
007fe547 : JZ 0x007fe557
007fe549 : MOV ECX,dword ptr [EAX]
007fe54b : MOV EDX,dword ptr [ECX + 0x8]
007fe54e : PUSH EAX
007fe54f : CALL EDX
007fe551 : MOV dword ptr [ESI + 0x264],EBX
007fe557 : MOV EAX,dword ptr [ESI + 0x26c]
007fe55d : CMP EAX,EBX
007fe55f : JZ 0x007fe56f
007fe561 : MOV ECX,dword ptr [EAX]
007fe563 : MOV EDX,dword ptr [ECX + 0x8]
007fe566 : PUSH EAX
007fe567 : CALL EDX
007fe569 : MOV dword ptr [ESI + 0x26c],EBX
007fe56f : MOV EAX,dword ptr [ESI + 0x14]
007fe572 : CMP EAX,EBX
007fe574 : JZ 0x007fe581
007fe576 : MOV ECX,dword ptr [EAX]
007fe578 : MOV EDX,dword ptr [ECX + 0x8]
007fe57b : PUSH EAX
007fe57c : CALL EDX
007fe57e : MOV dword ptr [ESI + 0x14],EBX
007fe581 : CMP dword ptr [ESI + 0x4b4],-0x1
007fe588 : JZ 0x007fe5d5
007fe58a : XOR EDI,EDI
007fe58c : CMP dword ptr [ESI + 0x4b8],EBX
007fe592 : JBE 0x007fe5ad
007fe594 : MOV EAX,dword ptr [ESI + 0x4b4]
007fe59a : PUSH EBX
007fe59b : PUSH EBX
007fe59c : PUSH EBX
007fe59d : PUSH EAX
007fe59e : CALL dword ptr [0x00b85388]
007fe5a4 : INC EDI
007fe5a5 : CMP EDI,dword ptr [ESI + 0x4b8]
007fe5ab : JC 0x007fe594
007fe5ad : MOV EDX,dword ptr [ESI + 0x4b8]
007fe5b3 : PUSH 0xbb8
007fe5b8 : PUSH 0x1
007fe5ba : LEA ECX,[ESI + 0x4bc]
007fe5c0 : PUSH ECX
007fe5c1 : PUSH EDX
007fe5c2 : CALL dword ptr [0x00b85384]
007fe5c8 : MOV EAX,dword ptr [ESI + 0x4b4]
007fe5ce : PUSH EAX
007fe5cf : CALL dword ptr [0x00b85104]
007fe5d5 : MOV byte ptr [EBP + -0x4],0x7
007fe5d9 : MOV EDI,dword ptr [0x00b850fc]
007fe5df : LEA ECX,[ESI + 0x424]
007fe5e5 : PUSH ECX
007fe5e6 : MOV dword ptr [ESI + 0x420],0xcdec94
007fe5f0 : CALL EDI
007fe5f2 : MOV byte ptr [EBP + -0x4],0x6
007fe5f6 : LEA EDX,[ESI + 0x408]
007fe5fc : PUSH EDX
007fe5fd : MOV dword ptr [ESI + 0x404],0xcdec94
007fe607 : CALL EDI
007fe609 : MOV byte ptr [EBP + -0x4],0x5
007fe60d : MOV ECX,dword ptr [ESI + 0x32c]
007fe613 : CMP ECX,EBX
007fe615 : JZ 0x007fe61c
007fe617 : CALL 0x006f04e0
007fe61c : MOV dword ptr [ESI + 0x32c],EBX
007fe622 : MOV dword ptr [ESI + 0x330],EBX
007fe628 : MOV dword ptr [ESI + 0x334],EBX
007fe62e : MOV byte ptr [EBP + -0x4],0x4
007fe632 : CMP dword ptr [ESI + 0x2e0],0x8
007fe639 : JC 0x007fe646
007fe63b : MOV ECX,dword ptr [ESI + 0x2cc]
007fe641 : CALL 0x006f04e0
007fe646 : MOV EDI,0x7
007fe64b : MOV dword ptr [ESI + 0x2e0],EDI
007fe651 : MOV dword ptr [ESI + 0x2dc],EBX
007fe657 : XOR EAX,EAX
007fe659 : MOV word ptr [ESI + 0x2cc],AX
007fe660 : MOV byte ptr [EBP + -0x4],0x3
007fe664 : CMP dword ptr [ESI + 0x2b0],0x8
007fe66b : JC 0x007fe678
007fe66d : MOV ECX,dword ptr [ESI + 0x29c]
007fe673 : CALL 0x006f04e0
007fe678 : MOV dword ptr [ESI + 0x2b0],EDI
007fe67e : MOV dword ptr [ESI + 0x2ac],EBX
007fe684 : XOR ECX,ECX
007fe686 : MOV word ptr [ESI + 0x29c],CX
007fe68d : MOV byte ptr [EBP + -0x4],0x2
007fe691 : CMP dword ptr [ESI + 0x294],0x8
007fe698 : JC 0x007fe6a5
007fe69a : MOV ECX,dword ptr [ESI + 0x280]
007fe6a0 : CALL 0x006f04e0
007fe6a5 : MOV dword ptr [ESI + 0x294],EDI
007fe6ab : MOV dword ptr [ESI + 0x290],EBX
007fe6b1 : XOR EDX,EDX
007fe6b3 : MOV word ptr [ESI + 0x280],DX
007fe6ba : MOV byte ptr [EBP + -0x4],0x1
007fe6be : MOV dword ptr [ESI + 0x1a8],0xcd083c
007fe6c8 : MOV byte ptr [EBP + -0x4],BL
007fe6cb : ADD ESI,0x8
007fe6ce : PUSH ESI
007fe6cf : CALL 0x00401120
007fe6d4 : MOV dword ptr [EBP + -0x4],0xffffffff
007fe6db : MOV dword ptr [0x017251ac],EBX
007fe6e1 : MOV ECX,dword ptr [EBP + -0xc]
007fe6e4 : MOV dword ptr FS:[0x0],ECX
007fe6eb : POP ECX
007fe6ec : POP EDI
007fe6ed : POP ESI
007fe6ee : POP EBX
007fe6ef : MOV ESP,EBP
007fe6f1 : POP EBP
007fe6f2 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_006cbb50
ENTRY    : 006cbb50
BODY     : [[006cbb50, 006cbe0d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006cbb50(uint *param_1,byte *param_2,int param_3,int param_4)

{
  byte bVar1;
  byte *pbVar2;
  byte *pbVar3;
  uint local_3c;
  uint local_38;
  byte *local_10;
  byte *local_c;
  uint local_8;
  
  local_38 = *param_1;
  if ((((char)param_1[2] == '\x02') && (param_3 != 0)) && (*(char *)((int)param_1 + 9) == '\b')) {
    local_c = param_2;
    local_10 = param_2;
    for (local_8 = 0; local_8 < local_38; local_8 = local_8 + 1) {
      bVar1 = *local_c;
      pbVar2 = local_c + 1;
      pbVar3 = local_c + 2;
      local_c = local_c + 3;
      *local_10 = *(byte *)(param_3 +
                           (((int)(uint)bVar1 >> 3) << 10 | ((int)(uint)*pbVar2 >> 3) << 5 |
                           (int)(uint)*pbVar3 >> 3));
      local_10 = local_10 + 1;
    }
    *(undefined1 *)(param_1 + 2) = 3;
    *(undefined1 *)((int)param_1 + 10) = 1;
    *(undefined1 *)((int)param_1 + 0xb) = *(undefined1 *)((int)param_1 + 9);
    if (*(byte *)((int)param_1 + 0xb) < 8) {
      local_38 = *(byte *)((int)param_1 + 0xb) * local_38 + 7 >> 3;
    }
    else {
      local_38 = (*(byte *)((int)param_1 + 0xb) >> 3) * local_38;
    }
    param_1[1] = local_38;
  }
  else if ((((char)param_1[2] == '\x06') && (param_3 != 0)) && (*(char *)((int)param_1 + 9) == '\b')
          ) {
    local_c = param_2;
    local_10 = param_2;
    for (local_8 = 0; local_8 < local_38; local_8 = local_8 + 1) {
      bVar1 = *local_c;
      pbVar2 = local_c + 1;
      pbVar3 = local_c + 2;
      local_c = local_c + 4;
      *local_10 = *(byte *)(param_3 +
                           (((int)(uint)bVar1 >> 3) << 10 | ((int)(uint)*pbVar2 >> 3) << 5 |
                           (int)(uint)*pbVar3 >> 3));
      local_10 = local_10 + 1;
    }
    *(undefined1 *)(param_1 + 2) = 3;
    *(undefined1 *)((int)param_1 + 10) = 1;
    *(undefined1 *)((int)param_1 + 0xb) = *(undefined1 *)((int)param_1 + 9);
    if (*(byte *)((int)param_1 + 0xb) < 8) {
      local_3c = *(byte *)((int)param_1 + 0xb) * local_38 + 7 >> 3;
    }
    else {
      local_3c = (*(byte *)((int)param_1 + 0xb) >> 3) * local_38;
    }
    param_1[1] = local_3c;
  }
  else if ((((char)param_1[2] == '\x03') && (param_4 != 0)) && (*(char *)((int)param_1 + 9) == '\b')
          ) {
    local_c = param_2;
    for (local_8 = 0; local_8 < local_38; local_8 = local_8 + 1) {
      *local_c = *(byte *)(param_4 + (uint)*local_c);
      local_c = local_c + 1;
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
006cbb50 : PUSH EBP
006cbb51 : MOV EBP,ESP
006cbb53 : SUB ESP,0x38
006cbb56 : MOV EAX,dword ptr [EBP + 0x8]
006cbb59 : MOV ECX,dword ptr [EAX]
006cbb5b : MOV dword ptr [EBP + -0x10],ECX
006cbb5e : MOV EDX,dword ptr [EBP + 0x8]
006cbb61 : MOVZX EAX,byte ptr [EDX + 0x8]
006cbb65 : CMP EAX,0x2
006cbb68 : JNZ 0x006cbc82
006cbb6e : CMP dword ptr [EBP + 0x10],0x0
006cbb72 : JZ 0x006cbc82
006cbb78 : MOV ECX,dword ptr [EBP + 0x8]
006cbb7b : MOVZX EDX,byte ptr [ECX + 0x9]
006cbb7f : CMP EDX,0x8
006cbb82 : JNZ 0x006cbc82
006cbb88 : MOV EAX,dword ptr [EBP + 0xc]
006cbb8b : MOV dword ptr [EBP + -0x8],EAX
006cbb8e : MOV ECX,dword ptr [EBP + 0xc]
006cbb91 : MOV dword ptr [EBP + -0xc],ECX
006cbb94 : MOV dword ptr [EBP + -0x4],0x0
006cbb9b : JMP 0x006cbba6
006cbb9d : MOV EDX,dword ptr [EBP + -0x4]
006cbba0 : ADD EDX,0x1
006cbba3 : MOV dword ptr [EBP + -0x4],EDX
006cbba6 : MOV EAX,dword ptr [EBP + -0x4]
006cbba9 : CMP EAX,dword ptr [EBP + -0x10]
006cbbac : JNC 0x006cbc27
006cbbae : MOV ECX,dword ptr [EBP + -0x8]
006cbbb1 : MOVZX EDX,byte ptr [ECX]
006cbbb4 : MOV dword ptr [EBP + -0x20],EDX
006cbbb7 : MOV EAX,dword ptr [EBP + -0x8]
006cbbba : ADD EAX,0x1
006cbbbd : MOV dword ptr [EBP + -0x8],EAX
006cbbc0 : MOV ECX,dword ptr [EBP + -0x8]
006cbbc3 : MOVZX EDX,byte ptr [ECX]
006cbbc6 : MOV dword ptr [EBP + -0x1c],EDX
006cbbc9 : MOV EAX,dword ptr [EBP + -0x8]
006cbbcc : ADD EAX,0x1
006cbbcf : MOV dword ptr [EBP + -0x8],EAX
006cbbd2 : MOV ECX,dword ptr [EBP + -0x8]
006cbbd5 : MOVZX EDX,byte ptr [ECX]
006cbbd8 : MOV dword ptr [EBP + -0x18],EDX
006cbbdb : MOV EAX,dword ptr [EBP + -0x8]
006cbbde : ADD EAX,0x1
006cbbe1 : MOV dword ptr [EBP + -0x8],EAX
006cbbe4 : MOV ECX,dword ptr [EBP + -0x20]
006cbbe7 : SAR ECX,0x3
006cbbea : AND ECX,0x1f
006cbbed : SHL ECX,0xa
006cbbf0 : MOV EDX,dword ptr [EBP + -0x1c]
006cbbf3 : SAR EDX,0x3
006cbbf6 : AND EDX,0x1f
006cbbf9 : SHL EDX,0x5
006cbbfc : OR ECX,EDX
006cbbfe : MOV EAX,dword ptr [EBP + -0x18]
006cbc01 : SAR EAX,0x3
006cbc04 : AND EAX,0x1f
006cbc07 : OR ECX,EAX
006cbc09 : MOV dword ptr [EBP + -0x14],ECX
006cbc0c : MOV ECX,dword ptr [EBP + 0x10]
006cbc0f : ADD ECX,dword ptr [EBP + -0x14]
006cbc12 : MOV EDX,dword ptr [EBP + -0xc]
006cbc15 : MOV AL,byte ptr [ECX]
006cbc17 : MOV byte ptr [EDX],AL
006cbc19 : MOV ECX,dword ptr [EBP + -0xc]
006cbc1c : ADD ECX,0x1
006cbc1f : MOV dword ptr [EBP + -0xc],ECX
006cbc22 : JMP 0x006cbb9d
006cbc27 : MOV EDX,dword ptr [EBP + 0x8]
006cbc2a : MOV byte ptr [EDX + 0x8],0x3
006cbc2e : MOV EAX,dword ptr [EBP + 0x8]
006cbc31 : MOV byte ptr [EAX + 0xa],0x1
006cbc35 : MOV ECX,dword ptr [EBP + 0x8]
006cbc38 : MOV EDX,dword ptr [EBP + 0x8]
006cbc3b : MOV AL,byte ptr [EDX + 0x9]
006cbc3e : MOV byte ptr [ECX + 0xb],AL
006cbc41 : MOV ECX,dword ptr [EBP + 0x8]
006cbc44 : MOVZX EDX,byte ptr [ECX + 0xb]
006cbc48 : CMP EDX,0x8
006cbc4b : JL 0x006cbc60
006cbc4d : MOV EAX,dword ptr [EBP + 0x8]
006cbc50 : MOVZX ECX,byte ptr [EAX + 0xb]
006cbc54 : SHR ECX,0x3
006cbc57 : IMUL ECX,dword ptr [EBP + -0x10]
006cbc5b : MOV dword ptr [EBP + -0x34],ECX
006cbc5e : JMP 0x006cbc74
006cbc60 : MOV EDX,dword ptr [EBP + 0x8]
006cbc63 : MOVZX EAX,byte ptr [EDX + 0xb]
006cbc67 : IMUL EAX,dword ptr [EBP + -0x10]
006cbc6b : ADD EAX,0x7
006cbc6e : SHR EAX,0x3
006cbc71 : MOV dword ptr [EBP + -0x34],EAX
006cbc74 : MOV ECX,dword ptr [EBP + 0x8]
006cbc77 : MOV EDX,dword ptr [EBP + -0x34]
006cbc7a : MOV dword ptr [ECX + 0x4],EDX
006cbc7d : JMP 0x006cbe0a
006cbc82 : MOV EAX,dword ptr [EBP + 0x8]
006cbc85 : MOVZX ECX,byte ptr [EAX + 0x8]
006cbc89 : CMP ECX,0x6
006cbc8c : JNZ 0x006cbdb0
006cbc92 : CMP dword ptr [EBP + 0x10],0x0
006cbc96 : JZ 0x006cbdb0
006cbc9c : MOV EDX,dword ptr [EBP + 0x8]
006cbc9f : MOVZX EAX,byte ptr [EDX + 0x9]
006cbca3 : CMP EAX,0x8
006cbca6 : JNZ 0x006cbdb0
006cbcac : MOV ECX,dword ptr [EBP + 0xc]
006cbcaf : MOV dword ptr [EBP + -0x8],ECX
006cbcb2 : MOV EDX,dword ptr [EBP + 0xc]
006cbcb5 : MOV dword ptr [EBP + -0xc],EDX
006cbcb8 : MOV dword ptr [EBP + -0x4],0x0
006cbcbf : JMP 0x006cbcca
006cbcc1 : MOV EAX,dword ptr [EBP + -0x4]
006cbcc4 : ADD EAX,0x1
006cbcc7 : MOV dword ptr [EBP + -0x4],EAX
006cbcca : MOV ECX,dword ptr [EBP + -0x4]
006cbccd : CMP ECX,dword ptr [EBP + -0x10]
006cbcd0 : JNC 0x006cbd58
006cbcd6 : MOV EDX,dword ptr [EBP + -0x8]
006cbcd9 : MOVZX EAX,byte ptr [EDX]
006cbcdc : MOV dword ptr [EBP + -0x30],EAX
006cbcdf : MOV ECX,dword ptr [EBP + -0x8]
006cbce2 : ADD ECX,0x1
006cbce5 : MOV dword ptr [EBP + -0x8],ECX
006cbce8 : MOV EDX,dword ptr [EBP + -0x8]
006cbceb : MOVZX EAX,byte ptr [EDX]
006cbcee : MOV dword ptr [EBP + -0x2c],EAX
006cbcf1 : MOV ECX,dword ptr [EBP + -0x8]
006cbcf4 : ADD ECX,0x1
006cbcf7 : MOV dword ptr [EBP + -0x8],ECX
006cbcfa : MOV EDX,dword ptr [EBP + -0x8]
006cbcfd : MOVZX EAX,byte ptr [EDX]
006cbd00 : MOV dword ptr [EBP + -0x28],EAX
006cbd03 : MOV ECX,dword ptr [EBP + -0x8]
006cbd06 : ADD ECX,0x1
006cbd09 : MOV dword ptr [EBP + -0x8],ECX
006cbd0c : MOV EDX,dword ptr [EBP + -0x8]
006cbd0f : ADD EDX,0x1
006cbd12 : MOV dword ptr [EBP + -0x8],EDX
006cbd15 : MOV EAX,dword ptr [EBP + -0x30]
006cbd18 : SAR EAX,0x3
006cbd1b : AND EAX,0x1f
006cbd1e : SHL EAX,0xa
006cbd21 : MOV ECX,dword ptr [EBP + -0x2c]
006cbd24 : SAR ECX,0x3
006cbd27 : AND ECX,0x1f
006cbd2a : SHL ECX,0x5
006cbd2d : OR EAX,ECX
006cbd2f : MOV EDX,dword ptr [EBP + -0x28]
006cbd32 : SAR EDX,0x3
006cbd35 : AND EDX,0x1f
006cbd38 : OR EAX,EDX
006cbd3a : MOV dword ptr [EBP + -0x24],EAX
006cbd3d : MOV EAX,dword ptr [EBP + 0x10]
006cbd40 : ADD EAX,dword ptr [EBP + -0x24]
006cbd43 : MOV ECX,dword ptr [EBP + -0xc]
006cbd46 : MOV DL,byte ptr [EAX]
006cbd48 : MOV byte ptr [ECX],DL
006cbd4a : MOV EAX,dword ptr [EBP + -0xc]
006cbd4d : ADD EAX,0x1
006cbd50 : MOV dword ptr [EBP + -0xc],EAX
006cbd53 : JMP 0x006cbcc1
006cbd58 : MOV ECX,dword ptr [EBP + 0x8]
006cbd5b : MOV byte ptr [ECX + 0x8],0x3
006cbd5f : MOV EDX,dword ptr [EBP + 0x8]
006cbd62 : MOV byte ptr [EDX + 0xa],0x1
006cbd66 : MOV EAX,dword ptr [EBP + 0x8]
006cbd69 : MOV ECX,dword ptr [EBP + 0x8]
006cbd6c : MOV DL,byte ptr [ECX + 0x9]
006cbd6f : MOV byte ptr [EAX + 0xb],DL
006cbd72 : MOV EAX,dword ptr [EBP + 0x8]
006cbd75 : MOVZX ECX,byte ptr [EAX + 0xb]
006cbd79 : CMP ECX,0x8
006cbd7c : JL 0x006cbd91
006cbd7e : MOV EDX,dword ptr [EBP + 0x8]
006cbd81 : MOVZX EAX,byte ptr [EDX + 0xb]
006cbd85 : SHR EAX,0x3
006cbd88 : IMUL EAX,dword ptr [EBP + -0x10]
006cbd8c : MOV dword ptr [EBP + -0x38],EAX
006cbd8f : JMP 0x006cbda5
006cbd91 : MOV ECX,dword ptr [EBP + 0x8]
006cbd94 : MOVZX EDX,byte ptr [ECX + 0xb]
006cbd98 : IMUL EDX,dword ptr [EBP + -0x10]
006cbd9c : ADD EDX,0x7
006cbd9f : SHR EDX,0x3
006cbda2 : MOV dword ptr [EBP + -0x38],EDX
006cbda5 : MOV EAX,dword ptr [EBP + 0x8]
006cbda8 : MOV ECX,dword ptr [EBP + -0x38]
006cbdab : MOV dword ptr [EAX + 0x4],ECX
006cbdae : JMP 0x006cbe0a
006cbdb0 : MOV EDX,dword ptr [EBP + 0x8]
006cbdb3 : MOVZX EAX,byte ptr [EDX + 0x8]
006cbdb7 : CMP EAX,0x3
006cbdba : JNZ 0x006cbe0a
006cbdbc : CMP dword ptr [EBP + 0x14],0x0
006cbdc0 : JZ 0x006cbe0a
006cbdc2 : MOV ECX,dword ptr [EBP + 0x8]
006cbdc5 : MOVZX EDX,byte ptr [ECX + 0x9]
006cbdc9 : CMP EDX,0x8
006cbdcc : JNZ 0x006cbe0a
006cbdce : MOV EAX,dword ptr [EBP + 0xc]
006cbdd1 : MOV dword ptr [EBP + -0x8],EAX
006cbdd4 : MOV dword ptr [EBP + -0x4],0x0
006cbddb : JMP 0x006cbdef
006cbddd : MOV ECX,dword ptr [EBP + -0x4]
006cbde0 : ADD ECX,0x1
006cbde3 : MOV dword ptr [EBP + -0x4],ECX
006cbde6 : MOV EDX,dword ptr [EBP + -0x8]
006cbde9 : ADD EDX,0x1
006cbdec : MOV dword ptr [EBP + -0x8],EDX
006cbdef : MOV EAX,dword ptr [EBP + -0x4]
006cbdf2 : CMP EAX,dword ptr [EBP + -0x10]
006cbdf5 : JNC 0x006cbe0a
006cbdf7 : MOV ECX,dword ptr [EBP + -0x8]
006cbdfa : MOVZX EDX,byte ptr [ECX]
006cbdfd : MOV EAX,dword ptr [EBP + -0x8]
006cbe00 : MOV ECX,dword ptr [EBP + 0x14]
006cbe03 : MOV DL,byte ptr [ECX + EDX*0x1]
006cbe06 : MOV byte ptr [EAX],DL
006cbe08 : JMP 0x006cbddd
006cbe0a : MOV ESP,EBP
006cbe0c : POP EBP
006cbe0d : RET

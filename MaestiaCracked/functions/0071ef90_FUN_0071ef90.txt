PROGRAM  : Maestia.exe
FUNCTION : FUN_0071ef90
ENTRY    : 0071ef90
BODY     : [[0071ef90, 0071efc6] [0071efd0, 0071f19f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0071ef90(int *param_1)

{
  short sVar1;
  char cVar2;
  uint uVar3;
  short *psVar4;
  int in_ECX;
  undefined1 local_23c [4];
  undefined2 local_238;
  undefined4 local_228;
  uint local_224;
  undefined4 local_220;
  undefined4 local_21c;
  undefined4 local_218;
  short local_214;
  undefined1 local_212 [510];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b17ca1;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_14 = uVar3;
  while ((uint)param_1[9] < (uint)param_1[8]) {
    cVar2 = (**(code **)(*param_1 + 0x1c))(&local_220,uVar3);
    if (cVar2 == '\0') goto LAB_0071f182;
    switch(local_220) {
    case 0x10:
      FUN_0070d320(&local_214);
      psVar4 = &local_214;
      local_238 = 0;
      local_224 = 7;
      local_228 = 0;
      do {
        sVar1 = *psVar4;
        psVar4 = psVar4 + 1;
      } while (sVar1 != 0);
      FUN_00406360(&local_214,(int)psVar4 - (int)local_212 >> 1);
      local_8 = 0;
      FUN_00405eb0(local_23c,0,0xffffffff);
      local_8 = 0xffffffff;
      if (7 < local_224) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_224 = 7;
      local_228 = 0;
      local_238 = 0;
      break;
    default:
      (**(code **)(*param_1 + 0x24))(local_21c);
      break;
    case 0x13:
      local_218 = 0xffffffff;
      (**(code **)(*param_1 + 0xc))(&local_218,4,1);
      break;
    case 0x51:
      (**(code **)(*param_1 + 0xc))(in_ECX + 0x11,1,1);
      break;
    case 0x52:
      (**(code **)(*param_1 + 0xc))(in_ECX + 0x12,1,1);
      break;
    case 0x72:
      goto switchD_0071f00d_caseD_72;
    case 0x73:
      (**(code **)(*param_1 + 0xc))(in_ECX + 0x58,4,1);
      break;
    case 0x74:
      (**(code **)(*param_1 + 0xc))(in_ECX + 0x5c,4,1);
      (**(code **)(*param_1 + 0xc))(in_ECX + 0x60,4,1);
      break;
    case 0x75:
      (**(code **)(*param_1 + 0xc))(in_ECX + 100,4,1);
      (**(code **)(*param_1 + 0xc))(in_ECX + 0x68,4,1);
    }
  }
switchD_0071f00d_caseD_72:
LAB_0071f182:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0071ef90 : PUSH EBP
0071ef91 : MOV EBP,ESP
0071ef93 : PUSH -0x1
0071ef95 : PUSH 0xb17ca1
0071ef9a : MOV EAX,FS:[0x0]
0071efa0 : PUSH EAX
0071efa1 : SUB ESP,0x22c
0071efa7 : MOV EAX,[0x00d66fa0]
0071efac : XOR EAX,EBP
0071efae : MOV dword ptr [EBP + -0x10],EAX
0071efb1 : PUSH EBX
0071efb2 : PUSH ESI
0071efb3 : PUSH EDI
0071efb4 : PUSH EAX
0071efb5 : LEA EAX,[EBP + -0xc]
0071efb8 : MOV FS:[0x0],EAX
0071efbe : MOV ESI,dword ptr [EBP + 0x8]
0071efc1 : MOV EDI,ECX
0071efc3 : XOR EBX,EBX
0071efc5 : JMP 0x0071efd0
0071efd0 : MOV EAX,dword ptr [ESI + 0x24]
0071efd3 : CMP EAX,dword ptr [ESI + 0x20]
0071efd6 : JNC 0x0071f180
0071efdc : MOV EDX,dword ptr [ESI]
0071efde : MOV EDX,dword ptr [EDX + 0x1c]
0071efe1 : LEA EAX,[EBP + 0xfffffde4]
0071efe7 : PUSH EAX
0071efe8 : MOV ECX,ESI
0071efea : CALL EDX
0071efec : TEST AL,AL
0071efee : JZ 0x0071f17c
0071eff4 : MOV EAX,dword ptr [EBP + 0xfffffde4]
0071effa : ADD EAX,-0x10
0071effd : CMP EAX,0x65
0071f000 : JA 0x0071f167
0071f006 : MOVZX EAX,byte ptr [EAX + 0x71f1c4]
0071f00d : JMP dword ptr [EAX*0x4 + 0x71f1a0]
0071f014 : LEA ECX,[EBP + 0xfffffdf0]
0071f01a : PUSH ECX
0071f01b : MOV ECX,ESI
0071f01d : CALL 0x0070d320
0071f022 : XOR EDX,EDX
0071f024 : LEA EAX,[EBP + 0xfffffdf0]
0071f02a : MOV word ptr [EBP + 0xfffffdcc],DX
0071f031 : MOV dword ptr [EBP + 0xfffffde0],0x7
0071f03b : MOV dword ptr [EBP + 0xfffffddc],EBX
0071f041 : LEA EDX,[EAX + 0x2]
0071f044 : MOV CX,word ptr [EAX]
0071f047 : ADD EAX,0x2
0071f04a : CMP CX,BX
0071f04d : JNZ 0x0071f044
0071f04f : SUB EAX,EDX
0071f051 : SAR EAX,0x1
0071f053 : PUSH EAX
0071f054 : LEA EAX,[EBP + 0xfffffdf0]
0071f05a : PUSH EAX
0071f05b : LEA ECX,[EBP + 0xfffffdc8]
0071f061 : CALL 0x00406360
0071f066 : MOV dword ptr [EBP + -0x4],EBX
0071f069 : PUSH -0x1
0071f06b : PUSH EBX
0071f06c : LEA ECX,[EBP + 0xfffffdc8]
0071f072 : PUSH ECX
0071f073 : LEA ECX,[EDI + 0x14]
0071f076 : CALL 0x00405eb0
0071f07b : MOV dword ptr [EBP + -0x4],0xffffffff
0071f082 : CMP dword ptr [EBP + 0xfffffde0],0x8
0071f089 : JC 0x0071f096
0071f08b : MOV ECX,dword ptr [EBP + 0xfffffdcc]
0071f091 : CALL 0x006f04e0
0071f096 : XOR EDX,EDX
0071f098 : MOV dword ptr [EBP + 0xfffffde0],0x7
0071f0a2 : MOV dword ptr [EBP + 0xfffffddc],EBX
0071f0a8 : MOV word ptr [EBP + 0xfffffdcc],DX
0071f0af : JMP 0x0071efd0
0071f0b4 : MOV EAX,dword ptr [ESI]
0071f0b6 : MOV EDX,dword ptr [EAX + 0xc]
0071f0b9 : PUSH 0x1
0071f0bb : PUSH 0x4
0071f0bd : LEA ECX,[EBP + 0xfffffdec]
0071f0c3 : PUSH ECX
0071f0c4 : MOV ECX,ESI
0071f0c6 : MOV dword ptr [EBP + 0xfffffdec],0xffffffff
0071f0d0 : CALL EDX
0071f0d2 : JMP 0x0071efd0
0071f0d7 : MOV EAX,dword ptr [ESI]
0071f0d9 : MOV EDX,dword ptr [EAX + 0xc]
0071f0dc : PUSH 0x1
0071f0de : PUSH 0x1
0071f0e0 : LEA ECX,[EDI + 0x11]
0071f0e3 : PUSH ECX
0071f0e4 : MOV ECX,ESI
0071f0e6 : CALL EDX
0071f0e8 : JMP 0x0071efd0
0071f0ed : MOV EAX,dword ptr [ESI]
0071f0ef : MOV EDX,dword ptr [EAX + 0xc]
0071f0f2 : PUSH 0x1
0071f0f4 : PUSH 0x1
0071f0f6 : LEA ECX,[EDI + 0x12]
0071f0f9 : PUSH ECX
0071f0fa : MOV ECX,ESI
0071f0fc : CALL EDX
0071f0fe : JMP 0x0071efd0
0071f103 : MOV EAX,dword ptr [ESI]
0071f105 : MOV EDX,dword ptr [EAX + 0xc]
0071f108 : PUSH 0x1
0071f10a : PUSH 0x4
0071f10c : LEA ECX,[EDI + 0x58]
0071f10f : PUSH ECX
0071f110 : MOV ECX,ESI
0071f112 : CALL EDX
0071f114 : JMP 0x0071efd0
0071f119 : MOV EAX,dword ptr [ESI]
0071f11b : MOV EDX,dword ptr [EAX + 0xc]
0071f11e : PUSH 0x1
0071f120 : PUSH 0x4
0071f122 : LEA ECX,[EDI + 0x5c]
0071f125 : PUSH ECX
0071f126 : MOV ECX,ESI
0071f128 : CALL EDX
0071f12a : MOV EAX,dword ptr [ESI]
0071f12c : MOV EDX,dword ptr [EAX + 0xc]
0071f12f : PUSH 0x1
0071f131 : PUSH 0x4
0071f133 : LEA ECX,[EDI + 0x60]
0071f136 : PUSH ECX
0071f137 : MOV ECX,ESI
0071f139 : CALL EDX
0071f13b : JMP 0x0071efd0
0071f140 : MOV EAX,dword ptr [ESI]
0071f142 : MOV EDX,dword ptr [EAX + 0xc]
0071f145 : PUSH 0x1
0071f147 : PUSH 0x4
0071f149 : LEA ECX,[EDI + 0x64]
0071f14c : PUSH ECX
0071f14d : MOV ECX,ESI
0071f14f : CALL EDX
0071f151 : MOV EAX,dword ptr [ESI]
0071f153 : MOV EDX,dword ptr [EAX + 0xc]
0071f156 : PUSH 0x1
0071f158 : PUSH 0x4
0071f15a : LEA ECX,[EDI + 0x68]
0071f15d : PUSH ECX
0071f15e : MOV ECX,ESI
0071f160 : CALL EDX
0071f162 : JMP 0x0071efd0
0071f167 : MOV ECX,dword ptr [EBP + 0xfffffde8]
0071f16d : MOV EAX,dword ptr [ESI]
0071f16f : MOV EDX,dword ptr [EAX + 0x24]
0071f172 : PUSH ECX
0071f173 : MOV ECX,ESI
0071f175 : CALL EDX
0071f177 : JMP 0x0071efd0
0071f17c : XOR AL,AL
0071f17e : JMP 0x0071f182
0071f180 : MOV AL,0x1
0071f182 : MOV ECX,dword ptr [EBP + -0xc]
0071f185 : MOV dword ptr FS:[0x0],ECX
0071f18c : POP ECX
0071f18d : POP EDI
0071f18e : POP ESI
0071f18f : POP EBX
0071f190 : MOV ECX,dword ptr [EBP + -0x10]
0071f193 : XOR ECX,EBP
0071f195 : CALL 0x00633e6b
0071f19a : MOV ESP,EBP
0071f19c : POP EBP
0071f19d : RET 0x4

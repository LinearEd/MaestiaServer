PROGRAM  : Maestia.exe
FUNCTION : FUN_006e0a90
ENTRY    : 006e0a90
BODY     : [[006e0a90, 006e0b45] [006e0b50, 006e0bdf]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006e0a90(int param_1,int *param_2,int param_3,undefined4 *param_4,int param_5)

{
  int *piVar1;
  int *piVar2;
  int *piVar3;
  byte bVar4;
  byte bVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  byte *pbVar12;
  undefined1 *puVar13;
  int iVar14;
  int iVar15;
  uint uVar16;
  int iVar17;
  
  param_5 = param_5 + -1;
  iVar6 = *(int *)(param_1 + 0x5c);
  iVar7 = *(int *)(param_1 + 0x1a4);
  iVar8 = *(int *)(param_1 + 0x120);
  iVar9 = *(int *)(iVar7 + 8);
  iVar10 = *(int *)(iVar7 + 0xc);
  iVar11 = *(int *)(iVar7 + 0x10);
  iVar7 = *(int *)(iVar7 + 0x14);
  if (-1 < param_5) {
    param_3 = param_3 * 4;
    do {
      piVar1 = (int *)(param_3 + *param_2);
      piVar2 = (int *)(param_3 + param_2[2]);
      pbVar12 = *(byte **)(param_3 + param_2[1]);
      piVar3 = (int *)(param_3 + param_2[3]);
      puVar13 = (undefined1 *)*param_4;
      param_4 = param_4 + 1;
      param_3 = param_3 + 4;
      if (iVar6 != 0) {
        iVar15 = *piVar1 - (int)pbVar12;
        iVar14 = *piVar2 - (int)pbVar12;
        iVar17 = *piVar3 - (int)pbVar12;
        param_1 = iVar6;
        do {
          bVar4 = pbVar12[iVar14];
          uVar16 = (uint)pbVar12[iVar15];
          bVar5 = *pbVar12;
          *puVar13 = *(undefined1 *)(((iVar8 - *(int *)(iVar9 + (uint)bVar4 * 4)) - uVar16) + 0xff);
          puVar13[1] = *(undefined1 *)
                        (((iVar8 - (*(int *)(iVar7 + (uint)bVar5 * 4) +
                                    *(int *)(iVar11 + (uint)bVar4 * 4) >> 0x10)) - uVar16) + 0xff);
          puVar13[2] = *(undefined1 *)
                        (((iVar8 - *(int *)(iVar10 + (uint)bVar5 * 4)) - uVar16) + 0xff);
          puVar13[3] = pbVar12[iVar17];
          pbVar12 = pbVar12 + 1;
          param_1 = param_1 + -1;
          puVar13 = puVar13 + 4;
        } while (param_1 != 0);
      }
      param_5 = param_5 + -1;
    } while (-1 < param_5);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
006e0a90 : SUB ESP,0x28
006e0a93 : SUB dword ptr [ESP + 0x3c],0x1
006e0a98 : MOV ECX,dword ptr [ESP + 0x2c]
006e0a9c : MOV EDX,dword ptr [ECX + 0x5c]
006e0a9f : MOV EAX,dword ptr [ECX + 0x1a4]
006e0aa5 : MOV dword ptr [ESP],EDX
006e0aa8 : MOV EDX,dword ptr [ECX + 0x120]
006e0aae : MOV ECX,dword ptr [EAX + 0x8]
006e0ab1 : MOV dword ptr [ESP + 0x10],ECX
006e0ab5 : MOV ECX,dword ptr [EAX + 0xc]
006e0ab8 : MOV dword ptr [ESP + 0x20],ECX
006e0abc : MOV ECX,dword ptr [EAX + 0x10]
006e0abf : MOV EAX,dword ptr [EAX + 0x14]
006e0ac2 : MOV dword ptr [ESP + 0x1c],EDX
006e0ac6 : MOV dword ptr [ESP + 0x18],ECX
006e0aca : MOV dword ptr [ESP + 0x14],EAX
006e0ace : JS 0x006e0bdc
006e0ad4 : PUSH EBX
006e0ad5 : PUSH EBP
006e0ad6 : PUSH ESI
006e0ad7 : MOV ESI,dword ptr [ESP + 0x40]
006e0adb : ADD ESI,ESI
006e0add : PUSH EDI
006e0ade : MOV EDI,dword ptr [ESP + 0x40]
006e0ae2 : ADD ESI,ESI
006e0ae4 : MOV ECX,dword ptr [EDI]
006e0ae6 : MOV EBX,dword ptr [ESI + ECX*0x1]
006e0ae9 : MOV ECX,dword ptr [EDI + 0x8]
006e0aec : MOV ECX,dword ptr [ESI + ECX*0x1]
006e0aef : MOV EBP,dword ptr [ESP + 0x48]
006e0af3 : MOV EAX,dword ptr [EDI + 0x4]
006e0af6 : MOV EAX,dword ptr [ESI + EAX*0x1]
006e0af9 : MOV dword ptr [ESP + 0x3c],ECX
006e0afd : MOV ECX,dword ptr [EDI + 0xc]
006e0b00 : MOV ECX,dword ptr [ESI + ECX*0x1]
006e0b03 : MOV dword ptr [ESP + 0x14],ECX
006e0b07 : MOV ECX,dword ptr [EBP]
006e0b0a : ADD EBP,0x4
006e0b0d : MOV dword ptr [ESP + 0x48],EBP
006e0b11 : MOV EBP,dword ptr [ESP + 0x10]
006e0b15 : ADD ESI,0x4
006e0b18 : MOV dword ptr [ESP + 0x34],ESI
006e0b1c : TEST EBP,EBP
006e0b1e : JBE 0x006e0bcd
006e0b24 : MOV EDI,dword ptr [ESP + 0x14]
006e0b28 : MOV ESI,EBX
006e0b2a : MOV EBX,dword ptr [ESP + 0x3c]
006e0b2e : SUB ESI,EAX
006e0b30 : SUB EBX,EAX
006e0b32 : SUB EDI,EAX
006e0b34 : MOV dword ptr [ESP + 0x18],ESI
006e0b38 : MOV dword ptr [ESP + 0x1c],EBX
006e0b3c : MOV dword ptr [ESP + 0x14],EDI
006e0b40 : MOV dword ptr [ESP + 0x3c],EBP
006e0b44 : JMP 0x006e0b58
006e0b50 : MOV ESI,dword ptr [ESP + 0x18]
006e0b54 : MOV EBX,dword ptr [ESP + 0x1c]
006e0b58 : MOVZX EBP,byte ptr [EBX + EAX*0x1]
006e0b5c : MOVZX ESI,byte ptr [ESI + EAX*0x1]
006e0b60 : MOV EBX,dword ptr [ESP + 0x20]
006e0b64 : SUB EDX,dword ptr [EBX + EBP*0x4]
006e0b67 : MOVZX EDI,byte ptr [EAX]
006e0b6a : SUB EDX,ESI
006e0b6c : MOV DL,byte ptr [EDX + 0xff]
006e0b72 : MOV byte ptr [ECX],DL
006e0b74 : MOV EDX,dword ptr [ESP + 0x24]
006e0b78 : MOV EBX,dword ptr [EDX + EDI*0x4]
006e0b7b : MOV EDX,dword ptr [ESP + 0x28]
006e0b7f : ADD EBX,dword ptr [EDX + EBP*0x4]
006e0b82 : MOV EDX,dword ptr [ESP + 0x2c]
006e0b86 : SAR EBX,0x10
006e0b89 : MOV EBP,EDX
006e0b8b : SUB EBP,EBX
006e0b8d : SUB EBP,ESI
006e0b8f : MOVZX EBX,byte ptr [EBP + 0xff]
006e0b96 : MOV EBP,dword ptr [ESP + 0x30]
006e0b9a : MOV byte ptr [ECX + 0x1],BL
006e0b9d : MOV EBX,EDX
006e0b9f : SUB EBX,dword ptr [EBP + EDI*0x4]
006e0ba3 : ADD ECX,0x4
006e0ba6 : SUB EBX,ESI
006e0ba8 : MOVZX EBX,byte ptr [EBX + 0xff]
006e0baf : MOV ESI,dword ptr [ESP + 0x14]
006e0bb3 : MOV byte ptr [ECX + -0x2],BL
006e0bb6 : MOVZX EBX,byte ptr [ESI + EAX*0x1]
006e0bba : MOV byte ptr [ECX + -0x1],BL
006e0bbd : INC EAX
006e0bbe : SUB dword ptr [ESP + 0x3c],0x1
006e0bc3 : JNZ 0x006e0b50
006e0bc5 : MOV EDI,dword ptr [ESP + 0x40]
006e0bc9 : MOV ESI,dword ptr [ESP + 0x34]
006e0bcd : SUB dword ptr [ESP + 0x4c],0x1
006e0bd2 : JNS 0x006e0ae4
006e0bd8 : POP EDI
006e0bd9 : POP ESI
006e0bda : POP EBP
006e0bdb : POP EBX
006e0bdc : ADD ESP,0x28
006e0bdf : RET

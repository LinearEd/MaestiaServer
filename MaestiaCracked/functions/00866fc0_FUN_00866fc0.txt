PROGRAM  : Maestia.exe
FUNCTION : FUN_00866fc0
ENTRY    : 00866fc0
BODY     : [[00866fc0, 008672a1]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00866fc0(int param_1,undefined4 param_2)

{
  undefined1 *puVar1;
  int *piVar2;
  int iVar3;
  undefined4 uVar4;
  int *piVar5;
  undefined1 auStack_170 [20];
  undefined4 uStack_15c;
  undefined ***pppuStack_158;
  int iStack_154;
  int iStack_150;
  int iStack_14c;
  undefined4 *****pppppuStack_148;
  uint uStack_144;
  undefined **local_134 [48];
  undefined2 local_74;
  undefined4 local_64;
  uint local_60;
  int local_5c;
  undefined1 *local_58;
  int local_54;
  int *local_50;
  undefined4 *****local_2c [4];
  int local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  iVar3 = DAT_00d7c54c;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b5f3cb;
  local_10 = ExceptionList;
  uStack_144 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_5c = *(int *)(*(int *)(param_1 + 0x18a8) + 0x24);
  local_14 = uStack_144;
  if (local_5c != 0) {
    pppppuStack_148 = (undefined4 *****)&local_54;
    iStack_14c = 0x86701f;
    local_54 = local_5c;
    FUN_004437f0();
    if (((local_58 != *(undefined1 **)(iVar3 + 0x44)) && (*(int *)(local_58 + 0x10) != 0)) &&
       (puVar1 = *(undefined1 **)(*(int *)(local_58 + 0x10) + 0x1ac), local_58 = puVar1,
       puVar1 != (undefined1 *)0x0)) {
      local_18 = 7;
      local_1c = 0;
      local_2c[0] = (undefined4 *****)((uint)local_2c[0] & 0xffff0000);
      local_8 = 0;
      piVar5 = (int *)(puVar1 + 0x1c4);
      pppppuStack_148 = (undefined4 *****)0x867072;
      local_50 = piVar5;
      local_54 = (**(code **)(*(int *)(puVar1 + 0x1c4) + 4))();
      while (local_54 != 0) {
        pppppuStack_148 = (undefined4 *****)0x86708a;
        iVar3 = FUN_004f5680();
        if (iVar3 != 0) {
          pppppuStack_148 = (undefined4 *****)(iVar3 + 0x18);
          iStack_14c = 0x86709a;
          iStack_150 = FUN_00404350();
          local_8._0_1_ = 1;
          pppppuStack_148 = (undefined4 *****)0xffffffff;
          iStack_14c = 0;
          iStack_154 = 0x8670ae;
          FUN_00405eb0();
          local_8 = (uint)local_8._1_3_ << 8;
          if (7 < local_60) {
                    /* WARNING: Subroutine does not return */
            pppppuStack_148 = (undefined4 *****)0x8670c0;
            FUN_006f04e0();
          }
          local_60 = 7;
          local_64 = 0;
          local_74 = 0;
          puVar1 = local_58;
        }
      }
      pppppuStack_148 = local_2c[0];
      if (local_18 < 8) {
        pppppuStack_148 = local_2c;
      }
      iStack_14c = 0x8670f6;
      iVar3 = FUN_00405b70();
      if ((iVar3 != 0) || (local_1c != 0)) {
        pppppuStack_148 = (undefined4 *****)(puVar1 + 0x59);
        iStack_14c = 0x867117;
        FUN_00404350();
        local_8 = CONCAT31(local_8._1_3_,2);
        iStack_150 = *(undefined4 *)(param_1 + 0x18a8);
        pppppuStack_148 = (undefined4 *****)param_2;
        iStack_14c = param_1;
        iStack_154 = 0x867134;
        FUN_0083c0e0();
        piVar2 = *(int **)(*(int *)(param_1 + 0x18a8) + 0x30);
        if (piVar2 != (int *)0x0) {
          pppppuStack_148 = (undefined4 *****)0x8;
          iStack_14c = 0x86714d;
          (**(code **)(*piVar2 + 0x9c))();
        }
        pppppuStack_148 = (undefined4 *****)0x1;
        iStack_14c = 0x86715c;
        FUN_0083bb00();
        pppppuStack_148 = (undefined4 *****)0x1;
        iStack_14c = 0;
        iStack_150 = 1;
        iStack_154 = param_1 + 0x6d8;
        pppuStack_158 = (undefined ***)0x867185;
        (**(code **)(*(int *)(*(int *)(*(int *)(param_1 + 0x138) + 4) + 0x138 + param_1) + 0x10))();
        iVar3 = *(int *)(*(int *)(param_1 + 0x18a8) + 0x30);
        if ((iVar3 != 0) && (*(int *)(iVar3 + 0x288) != 0)) {
          local_58 = auStack_170;
          FUN_00406460(L"BIP01 L TOE0");
          local_8 = CONCAT31((int3)(local_8 >> 8),2);
          uVar4 = FUN_00a664c0();
          *(undefined4 *)(param_1 + 0x19ec) = uVar4;
          piVar5 = local_50;
        }
        if ((*(int *)(*(int *)(param_1 + 0x18a8) + 0x30) != 0) && (*(int *)(param_1 + 0x19ec) != 0))
        {
          pppuStack_158 = local_134;
          uStack_15c = 0x867202;
          local_50 = (int *)FUN_007d5b60();
          local_8._0_1_ = 4;
          pppuStack_158 = (undefined ***)0x867214;
          iVar3 = FUN_007cc270();
          *(float *)(param_1 + 0x1a68) = (float)local_50[9] - *(float *)(iVar3 + 4);
          local_8 = CONCAT31(local_8._1_3_,2);
          local_134[0] = &PTR_FUN_00cd083c;
        }
        pppuStack_158 = (undefined ***)0x867240;
        local_50 = (int *)(**(code **)(*piVar5 + 4))();
        if (local_50 != (int *)0x0) {
          pppppuStack_148 = (undefined4 *****)0x867251;
          FUN_004f5680();
          pppppuStack_148 = (undefined4 *****)0x0;
          iStack_14c = 1;
          iStack_150 = param_1;
          iStack_154 = 0x86725e;
          FUN_00863440();
        }
        pppppuStack_148 = (undefined4 *****)local_5c;
        iStack_14c = 0x867269;
        FUN_00865580();
        local_8 = local_8 & 0xffffff00;
        pppppuStack_148 = (undefined4 *****)0x867275;
        FUN_00406560();
      }
      local_8 = 0xffffffff;
      pppppuStack_148 = (undefined4 *****)0x867284;
      FUN_00406560();
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00866fc0 : PUSH EBP
00866fc1 : MOV EBP,ESP
00866fc3 : PUSH -0x1
00866fc5 : PUSH 0xb5f3cb
00866fca : MOV EAX,FS:[0x0]
00866fd0 : PUSH EAX
00866fd1 : SUB ESP,0x124
00866fd7 : MOV EAX,[0x00d66fa0]
00866fdc : XOR EAX,EBP
00866fde : MOV dword ptr [EBP + -0x10],EAX
00866fe1 : PUSH EBX
00866fe2 : PUSH ESI
00866fe3 : PUSH EDI
00866fe4 : PUSH EAX
00866fe5 : LEA EAX,[EBP + -0xc]
00866fe8 : MOV FS:[0x0],EAX
00866fee : MOV EBX,dword ptr [EBP + 0x8]
00866ff1 : MOV EAX,dword ptr [EBX + 0x18a8]
00866ff7 : MOV EAX,dword ptr [EAX + 0x24]
00866ffa : XOR EDI,EDI
00866ffc : MOV dword ptr [EBP + -0x58],EAX
00866fff : CMP EAX,EDI
00867001 : JZ 0x00867284
00867007 : MOV ESI,dword ptr [0x00d7c54c]
0086700d : LEA ECX,[EBP + -0x50]
00867010 : MOV dword ptr [EBP + -0x50],EAX
00867013 : PUSH ECX
00867014 : LEA ECX,[ESI + 0x40]
00867017 : LEA EAX,[EBP + -0x54]
0086701a : CALL 0x004437f0
0086701f : MOV ESI,dword ptr [ESI + 0x44]
00867022 : MOV EAX,dword ptr [EBP + -0x54]
00867025 : CMP EAX,ESI
00867027 : JZ 0x00867284
0086702d : MOV EAX,dword ptr [EAX + 0x10]
00867030 : CMP EAX,EDI
00867032 : JZ 0x00867284
00867038 : MOV ESI,dword ptr [EAX + 0x1ac]
0086703e : MOV dword ptr [EBP + -0x54],ESI
00867041 : CMP ESI,EDI
00867043 : JZ 0x00867284
00867049 : XOR EDX,EDX
0086704b : MOV dword ptr [EBP + -0x14],0x7
00867052 : MOV dword ptr [EBP + -0x18],EDI
00867055 : MOV word ptr [EBP + -0x28],DX
00867059 : MOV dword ptr [EBP + -0x4],EDI
0086705c : MOV EAX,dword ptr [ESI + 0x1c4]
00867062 : MOV EDX,dword ptr [EAX + 0x4]
00867065 : LEA EDI,[ESI + 0x1c4]
0086706b : MOV ECX,EDI
0086706d : MOV dword ptr [EBP + -0x4c],EDI
00867070 : CALL EDX
00867072 : MOV dword ptr [EBP + -0x50],EAX
00867075 : TEST EAX,EAX
00867077 : JZ 0x008670dd
00867079 : LEA ESP,[ESP]
00867080 : LEA EDX,[EBP + -0x50]
00867083 : MOV EAX,EDI
00867085 : CALL 0x004f5680
0086708a : TEST EAX,EAX
0086708c : JZ 0x008670d7
0086708e : ADD EAX,0x18
00867091 : PUSH EAX
00867092 : LEA ESI,[EBP + -0x74]
00867095 : CALL 0x00404350
0086709a : ADD ESP,0x4
0086709d : MOV byte ptr [EBP + -0x4],0x1
008670a1 : PUSH -0x1
008670a3 : PUSH 0x0
008670a5 : PUSH EAX
008670a6 : LEA ECX,[EBP + -0x2c]
008670a9 : CALL 0x00405eb0
008670ae : MOV byte ptr [EBP + -0x4],0x0
008670b2 : CMP dword ptr [EBP + -0x5c],0x8
008670b6 : JC 0x008670c0
008670b8 : MOV ECX,dword ptr [EBP + -0x70]
008670bb : CALL 0x006f04e0
008670c0 : MOV ESI,dword ptr [EBP + -0x54]
008670c3 : XOR EAX,EAX
008670c5 : MOV dword ptr [EBP + -0x5c],0x7
008670cc : MOV dword ptr [EBP + -0x60],0x0
008670d3 : MOV word ptr [EBP + -0x70],AX
008670d7 : CMP dword ptr [EBP + -0x50],0x0
008670db : JNZ 0x00867080
008670dd : CMP dword ptr [EBP + -0x14],0x8
008670e1 : MOV EAX,dword ptr [EBP + -0x28]
008670e4 : JNC 0x008670e9
008670e6 : LEA EAX,[EBP + -0x28]
008670e9 : PUSH EAX
008670ea : XOR EDX,EDX
008670ec : MOV ECX,0xc3f338
008670f1 : CALL 0x00405b70
008670f6 : ADD ESP,0x4
008670f9 : TEST EAX,EAX
008670fb : JNZ 0x0086710b
008670fd : CMP dword ptr [EBP + -0x18],EAX
00867100 : SETNZ AL
00867103 : TEST EAX,EAX
00867105 : JZ 0x00867275
0086710b : ADD ESI,0x59
0086710e : PUSH ESI
0086710f : LEA ESI,[EBP + -0x48]
00867112 : CALL 0x00404350
00867117 : ADD ESP,0x4
0086711a : MOV byte ptr [EBP + -0x4],0x2
0086711e : MOV ECX,dword ptr [EBP + 0xc]
00867121 : MOV EDX,dword ptr [EBX + 0x18a8]
00867127 : PUSH ECX
00867128 : PUSH EBX
00867129 : PUSH EDX
0086712a : MOV EDX,ESI
0086712c : LEA ECX,[EBP + -0x2c]
0086712f : CALL 0x0083c0e0
00867134 : MOV EAX,dword ptr [EBX + 0x18a8]
0086713a : MOV ECX,dword ptr [EAX + 0x30]
0086713d : TEST ECX,ECX
0086713f : JZ 0x0086714d
00867141 : MOV EDX,dword ptr [ECX]
00867143 : MOV EAX,dword ptr [EDX + 0x9c]
00867149 : PUSH 0x8
0086714b : CALL EAX
0086714d : MOV ECX,dword ptr [EBX + 0x18a8]
00867153 : PUSH 0x1
00867155 : MOV AL,0x1
00867157 : CALL 0x0083bb00
0086715c : MOV ECX,dword ptr [EBX + 0x138]
00867162 : MOV EDX,dword ptr [ECX + 0x4]
00867165 : MOV EAX,dword ptr [EDX + EBX*0x1 + 0x138]
0086716c : MOV EAX,dword ptr [EAX + 0x10]
0086716f : PUSH 0x1
00867171 : LEA ECX,[EDX + EBX*0x1 + 0x138]
00867178 : PUSH 0x0
0086717a : PUSH 0x1
0086717c : LEA EDX,[EBX + 0x6d8]
00867182 : PUSH EDX
00867183 : CALL EAX
00867185 : MOV EAX,dword ptr [EBX + 0x18a8]
0086718b : MOV EAX,dword ptr [EAX + 0x30]
0086718e : TEST EAX,EAX
00867190 : JZ 0x008671dc
00867192 : CMP dword ptr [EAX + 0x288],0x0
00867199 : JZ 0x008671dc
0086719b : SUB ESP,0x1c
0086719e : MOV ECX,ESP
008671a0 : MOV dword ptr [EBP + -0x54],ESP
008671a3 : PUSH 0xc3f33c
008671a8 : CALL 0x00406460
008671ad : MOV byte ptr [EBP + -0x4],0x3
008671b1 : MOV EAX,dword ptr [EBX + 0x18a8]
008671b7 : MOV EAX,dword ptr [EAX + 0x30]
008671ba : TEST EAX,EAX
008671bc : JZ 0x008671c6
008671be : MOV EAX,dword ptr [EAX + 0x288]
008671c4 : JMP 0x008671c8
008671c6 : XOR EAX,EAX
008671c8 : MOV byte ptr [EBP + -0x4],0x2
008671cc : MOV EDI,EAX
008671ce : CALL 0x00a664c0
008671d3 : MOV EDI,dword ptr [EBP + -0x4c]
008671d6 : MOV dword ptr [EBX + 0x19ec],EAX
008671dc : MOV EAX,dword ptr [EBX + 0x18a8]
008671e2 : CMP dword ptr [EAX + 0x30],0x0
008671e6 : JZ 0x00867237
008671e8 : CMP dword ptr [EBX + 0x19ec],0x0
008671ef : JZ 0x00867237
008671f1 : MOV EAX,dword ptr [EAX + 0x30]
008671f4 : LEA ECX,[EBP + 0xfffffed0]
008671fa : PUSH ECX
008671fb : MOV ECX,EAX
008671fd : CALL 0x007d5b60
00867202 : MOV dword ptr [EBP + -0x4c],EAX
00867205 : MOV byte ptr [EBP + -0x4],0x4
00867209 : MOV ESI,dword ptr [EBX + 0x19ec]
0086720f : CALL 0x007cc270
00867214 : MOV EDX,dword ptr [EBP + -0x4c]
00867217 : MOVSS XMM0,dword ptr [EDX + 0x24]
0086721c : SUBSS XMM0,dword ptr [EAX + 0x4]
00867221 : MOVSS dword ptr [EBX + 0x1a68],XMM0
00867229 : MOV byte ptr [EBP + -0x4],0x2
0086722d : MOV dword ptr [EBP + 0xfffffed0],0xcd083c
00867237 : MOV EAX,dword ptr [EDI]
00867239 : MOV EDX,dword ptr [EAX + 0x4]
0086723c : MOV ECX,EDI
0086723e : CALL EDX
00867240 : MOV dword ptr [EBP + -0x4c],EAX
00867243 : TEST EAX,EAX
00867245 : JZ 0x0086725e
00867247 : LEA EDX,[EBP + -0x4c]
0086724a : MOV EAX,EDI
0086724c : CALL 0x004f5680
00867251 : PUSH 0x0
00867253 : PUSH 0x1
00867255 : LEA ECX,[EAX + 0x58]
00867258 : PUSH EBX
00867259 : CALL 0x00863440
0086725e : MOV EAX,dword ptr [EBP + -0x58]
00867261 : PUSH EAX
00867262 : MOV ESI,EBX
00867264 : CALL 0x00865580
00867269 : MOV byte ptr [EBP + -0x4],0x0
0086726d : LEA ECX,[EBP + -0x48]
00867270 : CALL 0x00406560
00867275 : MOV dword ptr [EBP + -0x4],0xffffffff
0086727c : LEA ECX,[EBP + -0x2c]
0086727f : CALL 0x00406560
00867284 : MOV ECX,dword ptr [EBP + -0xc]
00867287 : MOV dword ptr FS:[0x0],ECX
0086728e : POP ECX
0086728f : POP EDI
00867290 : POP ESI
00867291 : POP EBX
00867292 : MOV ECX,dword ptr [EBP + -0x10]
00867295 : XOR ECX,EBP
00867297 : CALL 0x00633e6b
0086729c : MOV ESP,EBP
0086729e : POP EBP
0086729f : RET 0x8

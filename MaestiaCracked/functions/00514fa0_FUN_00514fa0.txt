PROGRAM  : Maestia.exe
FUNCTION : FUN_00514fa0
ENTRY    : 00514fa0
BODY     : [[00514fa0, 00514ff5]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00514fa0(int *param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int *in_ECX;
  int *piVar3;
  
  iVar1 = *in_ECX;
  piVar3 = (int *)(iVar1 + 8 + param_2 * 0xc);
  if ((*(int *)(iVar1 + 8 + param_2 * 0xc) != -2) && (iVar2 = param_2, piVar3[1] == param_2)) {
    while ((piVar3[1] != param_2 || (*(int *)(piVar3[2] + 8) != *(int *)(*param_1 + 8)))) {
      iVar2 = *piVar3;
      if (iVar2 == -1) {
        return -1;
      }
      piVar3 = (int *)(iVar1 + 8 + iVar2 * 0xc);
    }
    return iVar2;
  }
  return -1;
}



============================================================
DISASSEMBLY
============================================================
00514fa0 : MOV EDX,dword ptr [ESP + 0x8]
00514fa4 : PUSH ESI
00514fa5 : MOV ESI,dword ptr [ECX]
00514fa7 : LEA ECX,[EDX + EDX*0x2]
00514faa : CMP dword ptr [ESI + ECX*0x4 + 0x8],-0x2
00514faf : LEA ECX,[ESI + ECX*0x4 + 0x8]
00514fb3 : MOV EAX,EDX
00514fb5 : JZ 0x00514fef
00514fb7 : CMP dword ptr [ECX + 0x4],EDX
00514fba : JNZ 0x00514fef
00514fbc : PUSH EDI
00514fbd : MOV EDI,dword ptr [ESP + 0xc]
00514fc1 : PUSH EBX
00514fc2 : PUSH EBP
00514fc3 : CMP dword ptr [ECX + 0x4],EDX
00514fc6 : JNZ 0x00514fd5
00514fc8 : MOV EBX,dword ptr [ECX + 0x8]
00514fcb : MOV EBP,dword ptr [EDI]
00514fcd : MOV EBX,dword ptr [EBX + 0x8]
00514fd0 : CMP EBX,dword ptr [EBP + 0x8]
00514fd3 : JZ 0x00514fe8
00514fd5 : MOV EAX,dword ptr [ECX]
00514fd7 : CMP EAX,-0x1
00514fda : JZ 0x00514fe5
00514fdc : LEA ECX,[EAX + EAX*0x2]
00514fdf : LEA ECX,[ESI + ECX*0x4 + 0x8]
00514fe3 : JMP 0x00514fc3
00514fe5 : OR EAX,0xffffffff
00514fe8 : POP EBP
00514fe9 : POP EBX
00514fea : POP EDI
00514feb : POP ESI
00514fec : RET 0x8
00514fef : OR EAX,0xffffffff
00514ff2 : POP ESI
00514ff3 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_00687bd0
ENTRY    : 00687bd0
BODY     : [[00687bd0, 00687c41]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00687bd0(int *param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  int iVar2;
  undefined4 *puVar3;
  
  puVar3 = param_2;
  uVar1 = 0;
  *param_2 = 0;
  iVar2 = param_1[2];
  if ((uint)param_1[1] <= iVar2 + 3U) {
LAB_00687c37:
    *puVar3 = 0x55;
    return 0;
  }
  if ((code *)param_1[5] == (code *)0x0) {
    puVar3 = (undefined4 *)(*param_1 + iVar2);
    if (puVar3 == (undefined4 *)0x0) goto LAB_00687c30;
  }
  else {
    iVar2 = (*(code *)param_1[5])(param_1,iVar2,&param_2,4);
    if (iVar2 != 4) goto LAB_00687c37;
    puVar3 = &param_2;
  }
  uVar1 = CONCAT31(CONCAT21(CONCAT11(*(undefined1 *)puVar3,*(undefined1 *)((int)puVar3 + 1)),
                            *(undefined1 *)((int)puVar3 + 2)),*(undefined1 *)((int)puVar3 + 3));
LAB_00687c30:
  param_1[2] = param_1[2] + 4;
  return uVar1;
}



============================================================
DISASSEMBLY
============================================================
00687bd0 : PUSH ESI
00687bd1 : MOV ESI,dword ptr [ESP + 0x8]
00687bd5 : PUSH EDI
00687bd6 : MOV EDI,dword ptr [ESP + 0x10]
00687bda : XOR EAX,EAX
00687bdc : MOV dword ptr [EDI],EAX
00687bde : MOV EDX,dword ptr [ESI + 0x8]
00687be1 : LEA ECX,[EDX + 0x3]
00687be4 : CMP ECX,dword ptr [ESI + 0x4]
00687be7 : JNC 0x00687c37
00687be9 : MOV ECX,dword ptr [ESI + 0x14]
00687bec : TEST ECX,ECX
00687bee : JZ 0x00687c09
00687bf0 : PUSH 0x4
00687bf2 : LEA EAX,[ESP + 0x14]
00687bf6 : PUSH EAX
00687bf7 : PUSH EDX
00687bf8 : PUSH ESI
00687bf9 : CALL ECX
00687bfb : ADD ESP,0x10
00687bfe : CMP EAX,0x4
00687c01 : JNZ 0x00687c37
00687c03 : LEA ECX,[ESP + 0x10]
00687c07 : JMP 0x00687c0f
00687c09 : MOV ECX,dword ptr [ESI]
00687c0b : ADD ECX,EDX
00687c0d : JZ 0x00687c30
00687c0f : MOVSX EAX,byte ptr [ECX]
00687c12 : MOVZX EDX,byte ptr [ECX + 0x1]
00687c16 : ADD ECX,0x4
00687c19 : SHL EAX,0x8
00687c1c : OR EAX,EDX
00687c1e : MOVZX EDX,byte ptr [ECX + -0x2]
00687c22 : MOVZX ECX,byte ptr [ECX + -0x1]
00687c26 : SHL EAX,0x8
00687c29 : OR EAX,EDX
00687c2b : SHL EAX,0x8
00687c2e : OR EAX,ECX
00687c30 : ADD dword ptr [ESI + 0x8],0x4
00687c34 : POP EDI
00687c35 : POP ESI
00687c36 : RET
00687c37 : MOV dword ptr [EDI],0x55
00687c3d : POP EDI
00687c3e : XOR EAX,EAX
00687c40 : POP ESI
00687c41 : RET

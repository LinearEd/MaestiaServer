PROGRAM  : Maestia.exe
FUNCTION : FUN_006109a0
ENTRY    : 006109a0
BODY     : [[006109a0, 00610b15]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006109a0(void)

{
  short *psVar1;
  uint uVar2;
  short sVar3;
  int iVar4;
  uint uVar5;
  undefined4 uVar6;
  short sVar7;
  short sVar8;
  short sVar9;
  short sVar10;
  short sVar11;
  int in_ECX;
  uint uVar12;
  short sVar13;
  int local_c;
  uint local_8;
  
  sVar13 = 0x7fff;
  *(undefined2 *)(in_ECX + 0x58) = 0x7fff;
  *(undefined2 *)(in_ECX + 0x5a) = 0x7fff;
  sVar7 = 0x7fff;
  sVar8 = 0x7fff;
  sVar9 = -0x7fff;
  sVar10 = -0x7fff;
  *(undefined2 *)(in_ECX + 0x5c) = 0x8001;
  *(undefined2 *)(in_ECX + 0x5e) = 0x8001;
  local_8 = 0;
  if (*(int *)(in_ECX + 4) != 0) {
    do {
      iVar4 = *(int *)(*(int *)(in_ECX + 0x10) + (local_8 >> 4) * 4);
      uVar5 = *(uint *)(iVar4 + 4 + (local_8 & 0xf) * 8);
      if (2 < uVar5) {
        uVar12 = *(uint *)(iVar4 + (local_8 & 0xf) * 8);
        uVar2 = (uVar12 - 1) + uVar5;
        uVar6 = *(undefined4 *)
                 (*(int *)(*(int *)(in_ECX + 0x20) + (uVar2 >> 6) * 4) + (uVar2 & 0x3f) * 4);
        local_c = 0;
        for (; uVar5 != 0; uVar5 = uVar5 - 1) {
          psVar1 = (short *)(*(int *)(*(int *)(in_ECX + 0x20) + (uVar12 >> 6) * 4) +
                            (uVar12 & 0x3f) * 4);
          sVar3 = *psVar1;
          if (sVar3 < sVar13) {
            sVar7 = sVar3;
          }
          sVar13 = psVar1[1];
          if (sVar13 < sVar8) {
            sVar8 = sVar13;
          }
          if (sVar9 < sVar3) {
            sVar9 = sVar3;
          }
          if (sVar10 < sVar13) {
            sVar10 = sVar13;
          }
          uVar2 = (uint)uVar6 >> 0x10;
          sVar11 = (short)uVar6;
          uVar6 = *(undefined4 *)psVar1;
          local_c = local_c + ((int)sVar13 * (int)sVar11 - (int)(short)uVar2 * (int)sVar3);
          uVar12 = uVar12 + 1;
          sVar13 = sVar7;
        }
        if ((((sVar13 < *(short *)(in_ECX + 0x58)) || (sVar8 < *(short *)(in_ECX + 0x5a))) ||
            (*(short *)(in_ECX + 0x5c) < sVar9)) || (*(short *)(in_ECX + 0x5e) < sVar10)) {
          *(short *)(in_ECX + 0x5c) = sVar9;
          *(short *)(in_ECX + 0x5a) = sVar8;
          *(short *)(in_ECX + 0x58) = sVar13;
          *(short *)(in_ECX + 0x5e) = sVar10;
          *(uint *)(in_ECX + 0x60) = (0 < local_c) + 1;
        }
      }
      local_8 = local_8 + 1;
    } while (local_8 < *(uint *)(in_ECX + 4));
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
006109a0 : SUB ESP,0x1c
006109a3 : PUSH EBP
006109a4 : MOV EBP,0x7fff
006109a9 : MOV EAX,0xffff8001
006109ae : MOV EDX,EBP
006109b0 : PUSH ESI
006109b1 : XOR ESI,ESI
006109b3 : MOV word ptr [ECX + 0x58],DX
006109b7 : MOV word ptr [ECX + 0x5a],DX
006109bb : MOV EDX,EAX
006109bd : MOV dword ptr [ESP + 0x14],EBP
006109c1 : MOV dword ptr [ESP + 0x8],EBP
006109c5 : MOV dword ptr [ESP + 0xc],EAX
006109c9 : MOV dword ptr [ESP + 0x10],EAX
006109cd : MOV word ptr [ECX + 0x5c],DX
006109d1 : MOV word ptr [ECX + 0x5e],AX
006109d5 : MOV dword ptr [ESP + 0x1c],ESI
006109d9 : CMP dword ptr [ECX + 0x4],ESI
006109dc : JBE 0x00610b10
006109e2 : PUSH EBX
006109e3 : PUSH EDI
006109e4 : MOV EAX,dword ptr [ECX + 0x10]
006109e7 : MOV EDX,ESI
006109e9 : SHR EDX,0x4
006109ec : MOV EAX,dword ptr [EAX + EDX*0x4]
006109ef : MOV EDI,ESI
006109f1 : AND EDI,0xf
006109f4 : MOV EDX,dword ptr [EAX + EDI*0x8 + 0x4]
006109f8 : LEA EAX,[EAX + EDI*0x8]
006109fb : CMP EDX,0x2
006109fe : JBE 0x00610b00
00610a04 : MOV EBX,dword ptr [EAX]
00610a06 : MOV ESI,dword ptr [ECX + 0x20]
00610a09 : LEA EAX,[EBX + EDX*0x1 + -0x1]
00610a0d : MOV EDI,EAX
00610a0f : SHR EDI,0x6
00610a12 : MOV ESI,dword ptr [ESI + EDI*0x4]
00610a15 : AND EAX,0x3f
00610a18 : MOV EAX,dword ptr [ESI + EAX*0x4]
00610a1b : MOV dword ptr [ESP + 0x20],0x0
00610a23 : TEST EDX,EDX
00610a25 : JBE 0x00610aa9
00610a2b : MOV dword ptr [ESP + 0x28],EDX
00610a2f : NOP
00610a30 : MOV EDX,dword ptr [ECX + 0x20]
00610a33 : MOV ESI,EBX
00610a35 : SHR ESI,0x6
00610a38 : MOV EDX,dword ptr [EDX + ESI*0x4]
00610a3b : MOV EDI,EBX
00610a3d : AND EDI,0x3f
00610a40 : LEA EDI,[EDX + EDI*0x4]
00610a43 : MOVZX EDX,word ptr [EDI]
00610a46 : CMP DX,BP
00610a49 : JGE 0x00610a52
00610a4b : MOVZX ESI,DX
00610a4e : MOV dword ptr [ESP + 0x1c],ESI
00610a52 : MOVZX ESI,word ptr [EDI + 0x2]
00610a56 : CMP SI,word ptr [ESP + 0x10]
00610a5b : JGE 0x00610a64
00610a5d : MOVZX EBP,SI
00610a60 : MOV dword ptr [ESP + 0x10],EBP
00610a64 : CMP DX,word ptr [ESP + 0x14]
00610a69 : JLE 0x00610a72
00610a6b : MOVZX EBP,DX
00610a6e : MOV dword ptr [ESP + 0x14],EBP
00610a72 : CMP SI,word ptr [ESP + 0x18]
00610a77 : JLE 0x00610a80
00610a79 : MOVZX EBP,SI
00610a7c : MOV dword ptr [ESP + 0x18],EBP
00610a80 : MOV EBP,EAX
00610a82 : SHR EBP,0x10
00610a85 : MOVSX EDX,DX
00610a88 : MOVSX EBP,BP
00610a8b : IMUL EBP,EDX
00610a8e : CWDE
00610a8f : MOVSX EDX,SI
00610a92 : IMUL EDX,EAX
00610a95 : MOV EAX,dword ptr [EDI]
00610a97 : SUB EDX,EBP
00610a99 : ADD dword ptr [ESP + 0x20],EDX
00610a9d : MOV EBP,dword ptr [ESP + 0x1c]
00610aa1 : INC EBX
00610aa2 : SUB dword ptr [ESP + 0x28],0x1
00610aa7 : JNZ 0x00610a30
00610aa9 : CMP BP,word ptr [ECX + 0x58]
00610aad : MOV ESI,dword ptr [ESP + 0x24]
00610ab1 : JL 0x00610ad4
00610ab3 : MOV DX,word ptr [ESP + 0x10]
00610ab8 : CMP DX,word ptr [ECX + 0x5a]
00610abc : JL 0x00610ad4
00610abe : MOV AX,word ptr [ESP + 0x14]
00610ac3 : CMP AX,word ptr [ECX + 0x5c]
00610ac7 : JG 0x00610ad4
00610ac9 : MOV DX,word ptr [ESP + 0x18]
00610ace : CMP DX,word ptr [ECX + 0x5e]
00610ad2 : JLE 0x00610b00
00610ad4 : MOV DX,word ptr [ESP + 0x14]
00610ad9 : MOVZX EAX,word ptr [ESP + 0x10]
00610ade : MOV word ptr [ECX + 0x5c],DX
00610ae2 : XOR EDX,EDX
00610ae4 : CMP dword ptr [ESP + 0x20],EDX
00610ae8 : MOV word ptr [ECX + 0x5a],AX
00610aec : MOVZX EAX,word ptr [ESP + 0x18]
00610af1 : SETG DL
00610af4 : MOV word ptr [ECX + 0x58],BP
00610af8 : MOV word ptr [ECX + 0x5e],AX
00610afc : INC EDX
00610afd : MOV dword ptr [ECX + 0x60],EDX
00610b00 : INC ESI
00610b01 : MOV dword ptr [ESP + 0x24],ESI
00610b05 : CMP ESI,dword ptr [ECX + 0x4]
00610b08 : JC 0x006109e4
00610b0e : POP EDI
00610b0f : POP EBX
00610b10 : POP ESI
00610b11 : POP EBP
00610b12 : ADD ESP,0x1c
00610b15 : RET

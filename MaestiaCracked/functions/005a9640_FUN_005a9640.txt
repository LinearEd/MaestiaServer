PROGRAM  : Maestia.exe
FUNCTION : FUN_005a9640
ENTRY    : 005a9640
BODY     : [[005a9640, 005a9931]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005a9640(undefined4 param_1,undefined4 param_2,uint param_3,uint param_4,int param_5,
                 int param_6,undefined4 param_7,undefined4 param_8)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  byte bVar3;
  int iVar4;
  undefined4 *in_ECX;
  uint uVar5;
  undefined4 local_18;
  uint local_14;
  uint local_10;
  uint local_c;
  undefined4 local_8;
  undefined4 local_4;
  
  *in_ECX = param_2;
  in_ECX[1] = param_1;
  in_ECX[2] = DAT_00d7324c + 0x118;
  if ((param_4 & 0xffff0000) == 0) {
    if ((param_4 & 0xff00) == 0) {
      bVar3 = *(byte *)((int)&PTR_DAT_00b94fc8 + (param_4 & 0xff));
    }
    else {
      bVar3 = *(char *)((int)&PTR_DAT_00b94fc8 + (param_4 >> 8 & 0xff)) + 8;
    }
  }
  else if ((param_4 & 0xff000000) == 0) {
    bVar3 = *(char *)((int)&PTR_DAT_00b94fc8 + (param_4 >> 0x10 & 0xff)) + 0x10;
  }
  else {
    bVar3 = *(char *)((int)&PTR_DAT_00b94fc8 + (param_4 >> 0x18)) + 0x18;
  }
  in_ECX[3] = (uint)bVar3;
  in_ECX[4] = (1 << (bVar3 & 0x1f)) + -1;
  FUN_005f6b80((uint)bVar3);
  puVar1 = in_ECX + 0x6b;
  *puVar1 = puVar1;
  in_ECX[0x6c] = puVar1;
  puVar2 = in_ECX + 0x6d;
  puVar1 = in_ECX + 0x6f;
  in_ECX[0x70] = puVar1;
  *puVar1 = puVar1;
  puVar1 = in_ECX + 0x71;
  in_ECX[0x72] = puVar1;
  *puVar1 = puVar1;
  *puVar2 = puVar2;
  in_ECX[0x6e] = puVar2;
  puVar1 = in_ECX + 0x73;
  in_ECX[0x74] = puVar1;
  *puVar1 = puVar1;
  puVar1 = in_ECX + 0x75;
  in_ECX[0x76] = puVar1;
  *puVar1 = puVar1;
  puVar1 = in_ECX + 0x77;
  in_ECX[0x78] = puVar1;
  *puVar1 = puVar1;
  puVar1 = in_ECX + 0x79;
  in_ECX[0x7a] = puVar1;
  *puVar1 = puVar1;
  puVar1 = in_ECX + 0x7b;
  in_ECX[0x7c] = puVar1;
  *puVar1 = puVar1;
  *(byte *)(in_ECX + 0x7d) = (byte)(param_3 >> 4) & 1;
  *(byte *)((int)in_ECX + 0x1f5) = (byte)(param_3 >> 5) & 1;
  uVar5 = param_5 + 0xfffU & 0xfffff000;
  in_ECX[0x7f] = uVar5;
  *(undefined1 *)((int)in_ECX + 0x1f6) = 0;
  *(undefined1 *)((int)in_ECX + 0x1f7) = 0;
  in_ECX[0x7e] = 0x1000;
  in_ECX[0x82] = 0;
  in_ECX[0x83] = 0;
  in_ECX[0x84] = 0;
  in_ECX[0x85] = 0;
  in_ECX[0x86] = 0;
  in_ECX[0x87] = 0;
  in_ECX[0x89] = 0;
  in_ECX[0x80] = (((uVar5 - 1) + param_6) / uVar5) * uVar5;
  in_ECX[0x81] = param_7;
  in_ECX[0x88] = param_8;
  local_18 = 0;
  local_14 = 0;
  local_10 = 0;
  local_c = 0;
  local_8 = 0;
  local_4 = 0;
  (*(code *)**(undefined4 **)in_ECX[1])(&local_18);
  *(undefined1 *)((int)in_ECX + 0x1f7) = (undefined1)local_8;
  if (local_14 < 0x1000) {
    local_14 = 0x1000;
  }
  in_ECX[0x7e] = local_14;
  in_ECX[0x82] = local_10;
  uVar5 = ((in_ECX[0x7f] + -1 + local_14) / local_14) * local_14;
  in_ECX[0x7f] = uVar5;
  if (local_c != 0) {
    local_c = local_c + 0xfff & 0xfffff000;
    if (local_c <= uVar5 && uVar5 - local_c != 0) {
      in_ECX[0x7f] = local_c;
      *(undefined1 *)(in_ECX + 0x7d) = 0;
      *(undefined1 *)((int)in_ECX + 0x1f5) = 0;
    }
  }
  if (((uint)in_ECX[0x81] < local_14 << 5) && (in_ECX[0x81] != 0)) {
    in_ECX[0x81] = local_14 << 5;
  }
  if (local_10 != 0) {
    if (local_10 < (uint)in_ECX[0x81]) {
      in_ECX[0x81] = local_10;
    }
    if (((uint)in_ECX[0x81] < 0x1000) && (in_ECX[0x81] != 0)) {
      in_ECX[0x81] = 0x1000;
    }
    if (local_10 < (uint)in_ECX[0x7f]) {
      in_ECX[0x7f] = local_10 + 0xfff & 0xfffff000;
    }
    if (local_10 < local_14) {
      in_ECX[0x7e] = local_10 + 0xfff & 0xfffff000;
    }
    if (local_10 < (uint)in_ECX[0x80]) {
      in_ECX[0x80] = local_10;
    }
    *(undefined1 *)((int)in_ECX + 0x1f5) = 0;
  }
  if (in_ECX[0x80] != 0) {
    iVar4 = FUN_005a8cc0(in_ECX[0x80],param_3,in_ECX[0x7f],&param_3);
    *(bool *)((int)in_ECX + 0x1f6) = iVar4 != 0;
    return;
  }
  *(undefined1 *)((int)in_ECX + 0x1f6) = 1;
  return;
}



============================================================
DISASSEMBLY
============================================================
005a9640 : MOV EAX,dword ptr [ESP + 0x8]
005a9644 : SUB ESP,0x18
005a9647 : PUSH ESI
005a9648 : MOV ESI,ECX
005a964a : MOV ECX,dword ptr [ESP + 0x20]
005a964e : MOV dword ptr [ESI],EAX
005a9650 : MOV EAX,dword ptr [ESP + 0x2c]
005a9654 : MOV dword ptr [ESI + 0x4],ECX
005a9657 : MOV EDX,dword ptr [0x00d7324c]
005a965d : ADD EDX,0x118
005a9663 : MOV dword ptr [ESI + 0x8],EDX
005a9666 : TEST EAX,0xffff0000
005a966b : JZ 0x005a9693
005a966d : TEST EAX,0xff000000
005a9672 : JZ 0x005a9681
005a9674 : SHR EAX,0x18
005a9677 : MOV AL,byte ptr [EAX + 0xb94fc8]
005a967d : ADD AL,0x18
005a967f : JMP 0x005a96b7
005a9681 : SHR EAX,0x10
005a9684 : AND EAX,0xff
005a9689 : MOV AL,byte ptr [EAX + 0xb94fc8]
005a968f : ADD AL,0x10
005a9691 : JMP 0x005a96b7
005a9693 : TEST EAX,0xff00
005a9698 : JZ 0x005a96ac
005a969a : SHR EAX,0x8
005a969d : AND EAX,0xff
005a96a2 : MOV AL,byte ptr [EAX + 0xb94fc8]
005a96a8 : ADD AL,0x8
005a96aa : JMP 0x005a96b7
005a96ac : AND EAX,0xff
005a96b1 : MOV AL,byte ptr [EAX + 0xb94fc8]
005a96b7 : MOVZX ECX,AL
005a96ba : MOV EAX,0x1
005a96bf : SHL EAX,CL
005a96c1 : PUSH EBX
005a96c2 : PUSH EDI
005a96c3 : MOV dword ptr [ESI + 0xc],ECX
005a96c6 : DEC EAX
005a96c7 : PUSH ECX
005a96c8 : LEA ECX,[ESI + 0x14]
005a96cb : MOV dword ptr [ESI + 0x10],EAX
005a96ce : CALL 0x005f6b80
005a96d3 : LEA EAX,[ESI + 0x1ac]
005a96d9 : MOV dword ptr [EAX],EAX
005a96db : MOV dword ptr [EAX + 0x4],EAX
005a96de : LEA EAX,[ESI + 0x1b4]
005a96e4 : LEA ECX,[EAX + 0x8]
005a96e7 : MOV dword ptr [EAX + 0xc],ECX
005a96ea : MOV dword ptr [ECX],ECX
005a96ec : LEA ECX,[EAX + 0x10]
005a96ef : MOV dword ptr [EAX + 0x14],ECX
005a96f2 : MOV dword ptr [ECX],ECX
005a96f4 : MOV dword ptr [EAX],EAX
005a96f6 : MOV dword ptr [EAX + 0x4],EAX
005a96f9 : LEA ECX,[EAX + 0x18]
005a96fc : MOV dword ptr [EAX + 0x1c],ECX
005a96ff : MOV dword ptr [ECX],ECX
005a9701 : LEA ECX,[EAX + 0x20]
005a9704 : MOV dword ptr [EAX + 0x24],ECX
005a9707 : MOV dword ptr [ECX],ECX
005a9709 : LEA ECX,[EAX + 0x28]
005a970c : MOV dword ptr [EAX + 0x2c],ECX
005a970f : MOV dword ptr [ECX],ECX
005a9711 : MOV EDX,dword ptr [ESP + 0x3c]
005a9715 : LEA ECX,[EAX + 0x30]
005a9718 : MOV dword ptr [EAX + 0x34],ECX
005a971b : MOV dword ptr [ECX],ECX
005a971d : LEA ECX,[EAX + 0x38]
005a9720 : MOV dword ptr [EAX + 0x3c],ECX
005a9723 : MOV EAX,dword ptr [ESP + 0x30]
005a9727 : MOV dword ptr [ECX],ECX
005a9729 : MOV ECX,EAX
005a972b : SHR ECX,0x4
005a972e : AND CL,0x1
005a9731 : MOV byte ptr [ESI + 0x1f4],CL
005a9737 : MOV ECX,dword ptr [ESP + 0x38]
005a973b : SHR EAX,0x5
005a973e : AND AL,0x1
005a9740 : MOV byte ptr [ESI + 0x1f5],AL
005a9746 : ADD ECX,0xfff
005a974c : AND ECX,0xfffff000
005a9752 : LEA EAX,[ECX + EDX*0x1 + -0x1]
005a9756 : XOR EDX,EDX
005a9758 : DIV ECX
005a975a : XOR EBX,EBX
005a975c : MOV dword ptr [ESI + 0x1fc],ECX
005a9762 : MOV byte ptr [ESI + 0x1f6],BL
005a9768 : MOV byte ptr [ESI + 0x1f7],BL
005a976e : MOV dword ptr [ESI + 0x1f8],0x1000
005a9778 : MOV dword ptr [ESI + 0x208],EBX
005a977e : MOV dword ptr [ESI + 0x20c],EBX
005a9784 : MOV dword ptr [ESI + 0x210],EBX
005a978a : MOV dword ptr [ESI + 0x214],EBX
005a9790 : MOV dword ptr [ESI + 0x218],EBX
005a9796 : MOV dword ptr [ESI + 0x21c],EBX
005a979c : MOV dword ptr [ESI + 0x224],EBX
005a97a2 : IMUL EAX,ECX
005a97a5 : MOV ECX,dword ptr [ESP + 0x44]
005a97a9 : MOV dword ptr [ESI + 0x200],EAX
005a97af : MOV EAX,dword ptr [ESP + 0x40]
005a97b3 : MOV dword ptr [ESI + 0x204],EAX
005a97b9 : XOR EAX,EAX
005a97bb : MOV dword ptr [ESI + 0x220],ECX
005a97c1 : MOV ECX,dword ptr [ESI + 0x4]
005a97c4 : MOV dword ptr [ESP + 0xc],EAX
005a97c8 : MOV dword ptr [ESP + 0x10],EAX
005a97cc : MOV dword ptr [ESP + 0x14],EAX
005a97d0 : MOV dword ptr [ESP + 0x18],EAX
005a97d4 : MOV dword ptr [ESP + 0x1c],EAX
005a97d8 : MOV dword ptr [ESP + 0x20],EAX
005a97dc : MOV EDX,dword ptr [ECX]
005a97de : LEA EAX,[ESP + 0xc]
005a97e2 : MOV EDX,dword ptr [EDX]
005a97e4 : PUSH EAX
005a97e5 : CALL EDX
005a97e7 : MOV ECX,dword ptr [ESP + 0x14]
005a97eb : MOV AL,byte ptr [ESP + 0x20]
005a97ef : MOV byte ptr [ESI + 0x1f7],AL
005a97f5 : CMP ECX,0x1000
005a97fb : JNC 0x005a9806
005a97fd : MOV ECX,0x1000
005a9802 : MOV dword ptr [ESP + 0x14],ECX
005a9806 : MOV EDX,dword ptr [ESI + 0x1fc]
005a980c : LEA EAX,[EDX + ECX*0x1 + -0x1]
005a9810 : XOR EDX,EDX
005a9812 : DIV ECX
005a9814 : MOV EDX,dword ptr [ESP + 0x1c]
005a9818 : MOV EDI,dword ptr [ESP + 0x18]
005a981c : MOV dword ptr [ESI + 0x1f8],ECX
005a9822 : MOV dword ptr [ESI + 0x208],EDI
005a9828 : IMUL EAX,ECX
005a982b : MOV dword ptr [ESI + 0x1fc],EAX
005a9831 : CMP EDX,EBX
005a9833 : JZ 0x005a985b
005a9835 : ADD EDX,0xfff
005a983b : AND EDX,0xfffff000
005a9841 : MOV dword ptr [ESP + 0x1c],EDX
005a9845 : CMP EAX,EDX
005a9847 : JBE 0x005a985b
005a9849 : MOV dword ptr [ESI + 0x1fc],EDX
005a984f : MOV byte ptr [ESI + 0x1f4],BL
005a9855 : MOV byte ptr [ESI + 0x1f5],BL
005a985b : MOV EDX,dword ptr [ESI + 0x204]
005a9861 : MOV EAX,ECX
005a9863 : SHL EAX,0x5
005a9866 : CMP EDX,EAX
005a9868 : JNC 0x005a9874
005a986a : CMP EDX,EBX
005a986c : JZ 0x005a9874
005a986e : MOV dword ptr [ESI + 0x204],EAX
005a9874 : CMP EDI,EBX
005a9876 : JZ 0x005a98e4
005a9878 : CMP dword ptr [ESI + 0x204],EDI
005a987e : JBE 0x005a9886
005a9880 : MOV dword ptr [ESI + 0x204],EDI
005a9886 : MOV EAX,dword ptr [ESI + 0x204]
005a988c : CMP EAX,0x1000
005a9891 : JNC 0x005a98a1
005a9893 : CMP EAX,EBX
005a9895 : JZ 0x005a98a1
005a9897 : MOV dword ptr [ESI + 0x204],0x1000
005a98a1 : CMP dword ptr [ESI + 0x1fc],EDI
005a98a7 : JBE 0x005a98ba
005a98a9 : LEA EAX,[EDI + 0xfff]
005a98af : AND EAX,0xfffff000
005a98b4 : MOV dword ptr [ESI + 0x1fc],EAX
005a98ba : CMP ECX,EDI
005a98bc : JBE 0x005a98d0
005a98be : LEA ECX,[EDI + 0xfff]
005a98c4 : AND ECX,0xfffff000
005a98ca : MOV dword ptr [ESI + 0x1f8],ECX
005a98d0 : CMP dword ptr [ESI + 0x200],EDI
005a98d6 : JBE 0x005a98de
005a98d8 : MOV dword ptr [ESI + 0x200],EDI
005a98de : MOV byte ptr [ESI + 0x1f5],BL
005a98e4 : MOV EAX,dword ptr [ESI + 0x200]
005a98ea : POP EDI
005a98eb : CMP EAX,EBX
005a98ed : POP EBX
005a98ee : JZ 0x005a991e
005a98f0 : MOV ECX,dword ptr [ESI + 0x1fc]
005a98f6 : LEA EDX,[ESP + 0x2c]
005a98fa : PUSH EDX
005a98fb : MOV EDX,dword ptr [ESP + 0x30]
005a98ff : PUSH ECX
005a9900 : PUSH EDX
005a9901 : PUSH EAX
005a9902 : MOV ECX,ESI
005a9904 : CALL 0x005a8cc0
005a9909 : NEG EAX
005a990b : SBB EAX,EAX
005a990d : NEG EAX
005a990f : MOV byte ptr [ESI + 0x1f6],AL
005a9915 : MOV EAX,ESI
005a9917 : POP ESI
005a9918 : ADD ESP,0x18
005a991b : RET 0x20
005a991e : MOV EAX,0x1
005a9923 : MOV byte ptr [ESI + 0x1f6],AL
005a9929 : MOV EAX,ESI
005a992b : POP ESI
005a992c : ADD ESP,0x18
005a992f : RET 0x20

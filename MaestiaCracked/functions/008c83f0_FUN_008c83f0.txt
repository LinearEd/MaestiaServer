PROGRAM  : Maestia.exe
FUNCTION : FUN_008c83f0
ENTRY    : 008c83f0
BODY     : [[008c83f0, 008c8603]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008c83f0(int param_1)

{
  int *piVar1;
  char cVar2;
  undefined4 uVar3;
  int iVar4;
  int iVar5;
  int *in_ECX;
  undefined1 local_70 [28];
  undefined1 local_54 [28];
  uint local_38;
  uint local_34;
  undefined1 local_30 [28];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b45114;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (((char)in_ECX[2] == '\0') || (iVar5 = *(int *)(in_ECX[1] + 0x128), iVar5 == 0))
  goto LAB_008c85e6;
  uVar3 = (**(code **)(*in_ECX + 0x74))(param_1,0,local_14);
  if (*(int *)(iVar5 + 0x40) == -1) {
    FUN_0097fb30(uVar3,param_1,0);
    goto LAB_008c85e6;
  }
  iVar4 = FUN_008eb580();
  if (iVar4 == 0) goto LAB_008c85e6;
  local_34 = (uint)*(ushort *)(iVar5 + 0x44);
  local_38 = (uint)*(ushort *)(iVar5 + 0x46);
  if (param_1 == 3) {
    piVar1 = *(int **)(iVar5 + 0x4c);
    if (piVar1 == (int *)0x0) {
      iVar5 = 0;
    }
    else {
      iVar5 = piVar1[4];
    }
    iVar5 = FUN_004049b0(iVar5);
    if (iVar5 == 0) {
      FUN_00406460(L"IDS_NEED_HALIDOM_INSURANCE");
      local_8 = 0;
      FUN_0081d120(local_54);
      local_8 = CONCAT31(local_8._1_3_,2);
      goto LAB_008c859e;
    }
    if ((((*(short *)(iVar5 + 0x180) == 0xb) && (*(int *)(*DAT_00da9894 + 0x1e8) != 0)) &&
        (*(char *)(*(int *)(*DAT_00da9894 + 0x1e8) + 0x32) != '\0')) && (piVar1 != (int *)0x0)) {
      (**(code **)(*piVar1 + 0xb4))();
      FUN_0097fa60();
      goto LAB_008c85e6;
    }
  }
  else {
    iVar4 = *(int *)(iVar5 + 0x4c);
    if (iVar4 == 0) {
      cVar2 = '\0';
    }
    else {
      cVar2 = (char)((uint)*(undefined4 *)(iVar4 + 0x10) >> 0x10);
    }
    if (cVar2 == -0x74) {
      if (iVar4 == 0) {
        uVar3 = 0;
      }
      else {
        uVar3 = *(undefined4 *)(iVar4 + 0x10);
      }
      cVar2 = FUN_008c7a70(uVar3);
      if (cVar2 != '\0') {
        FUN_008efa90(*(undefined4 *)(iVar5 + 0x40),local_34,local_38,0x97,param_1,0);
        FUN_0097fa60();
        goto LAB_008c85e6;
      }
    }
    else {
      FUN_00406460(L"IDS_NEED_HALIDOM");
      local_8 = 3;
      FUN_0081d120(local_70);
      local_8 = CONCAT31(local_8._1_3_,5);
LAB_008c859e:
      FUN_00406560();
      (**(code **)(**(int **)(*DAT_00da9894 + 0x1a8) + 0x44))(local_30,3);
      local_8 = 0xffffffff;
      FUN_00406560();
    }
  }
  FUN_0097fa60();
LAB_008c85e6:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008c83f0 : PUSH EBP
008c83f1 : MOV EBP,ESP
008c83f3 : PUSH -0x1
008c83f5 : PUSH 0xb45114
008c83fa : MOV EAX,FS:[0x0]
008c8400 : PUSH EAX
008c8401 : SUB ESP,0x60
008c8404 : MOV EAX,[0x00d66fa0]
008c8409 : XOR EAX,EBP
008c840b : MOV dword ptr [EBP + -0x10],EAX
008c840e : PUSH EBX
008c840f : PUSH ESI
008c8410 : PUSH EDI
008c8411 : PUSH EAX
008c8412 : LEA EAX,[EBP + -0xc]
008c8415 : MOV FS:[0x0],EAX
008c841b : MOV ESI,ECX
008c841d : MOV AL,byte ptr [ESI + 0x8]
008c8420 : TEST AL,AL
008c8422 : JZ 0x008c85e6
008c8428 : MOV EAX,dword ptr [ESI + 0x4]
008c842b : MOV EBX,dword ptr [EAX + 0x128]
008c8431 : TEST EBX,EBX
008c8433 : JZ 0x008c85e6
008c8439 : MOV EDX,dword ptr [ESI]
008c843b : MOV EDI,dword ptr [EBP + 0x8]
008c843e : MOV EAX,dword ptr [EDX + 0x74]
008c8441 : PUSH 0x0
008c8443 : PUSH EDI
008c8444 : CALL EAX
008c8446 : MOV ECX,dword ptr [EBX + 0x40]
008c8449 : CMP ECX,-0x1
008c844c : JZ 0x008c85d6
008c8452 : MOV EAX,dword ptr [ESI + 0x4]
008c8455 : MOV EDI,ECX
008c8457 : CALL 0x008eb580
008c845c : TEST EAX,EAX
008c845e : JZ 0x008c85e6
008c8464 : CMP dword ptr [EBP + 0x8],0x3
008c8468 : MOVZX ECX,word ptr [EBX + 0x44]
008c846c : MOVZX EDX,word ptr [EBX + 0x46]
008c8470 : MOV dword ptr [EBP + -0x30],ECX
008c8473 : MOV dword ptr [EBP + -0x34],EDX
008c8476 : JZ 0x008c84da
008c8478 : MOV EAX,dword ptr [EBX + 0x4c]
008c847b : TEST EAX,EAX
008c847d : JZ 0x008c8484
008c847f : MOV EDI,dword ptr [EAX + 0x10]
008c8482 : JMP 0x008c8486
008c8484 : XOR EDI,EDI
008c8486 : MOV ECX,EDI
008c8488 : SHR ECX,0x10
008c848b : CMP CL,0x8c
008c848e : JNZ 0x008c8571
008c8494 : TEST EAX,EAX
008c8496 : JZ 0x008c849d
008c8498 : MOV EAX,dword ptr [EAX + 0x10]
008c849b : JMP 0x008c849f
008c849d : XOR EAX,EAX
008c849f : PUSH EAX
008c84a0 : MOV ECX,ESI
008c84a2 : CALL 0x008c7a70
008c84a7 : TEST AL,AL
008c84a9 : JZ 0x008c85cd
008c84af : MOV EDX,dword ptr [EBP + 0x8]
008c84b2 : MOV EAX,dword ptr [EBP + -0x34]
008c84b5 : MOV ECX,dword ptr [EBP + -0x30]
008c84b8 : PUSH 0x0
008c84ba : PUSH EDX
008c84bb : MOV EDX,dword ptr [EBX + 0x40]
008c84be : PUSH 0x97
008c84c3 : PUSH EAX
008c84c4 : PUSH ECX
008c84c5 : PUSH EDX
008c84c6 : CALL 0x008efa90
008c84cb : ADD ESP,0x18
008c84ce : MOV ECX,EBX
008c84d0 : CALL 0x0097fa60
008c84d5 : JMP 0x008c85e6
008c84da : MOV ESI,dword ptr [EBX + 0x4c]
008c84dd : TEST ESI,ESI
008c84df : JZ 0x008c84e6
008c84e1 : MOV EAX,dword ptr [ESI + 0x10]
008c84e4 : JMP 0x008c84e8
008c84e6 : XOR EAX,EAX
008c84e8 : PUSH EAX
008c84e9 : CALL 0x004049b0
008c84ee : ADD ESP,0x4
008c84f1 : TEST EAX,EAX
008c84f3 : JZ 0x008c8542
008c84f5 : CMP word ptr [EAX + 0x180],0xb
008c84fd : JNZ 0x008c85cd
008c8503 : MOV EAX,[0x00da9894]
008c8508 : MOV ECX,dword ptr [EAX]
008c850a : MOV EAX,dword ptr [ECX + 0x1e8]
008c8510 : TEST EAX,EAX
008c8512 : JZ 0x008c85cd
008c8518 : CMP byte ptr [EAX + 0x32],0x0
008c851c : JZ 0x008c85cd
008c8522 : TEST ESI,ESI
008c8524 : JZ 0x008c85cd
008c852a : MOV EDX,dword ptr [ESI]
008c852c : MOV EAX,dword ptr [EDX + 0xb4]
008c8532 : MOV ECX,ESI
008c8534 : CALL EAX
008c8536 : MOV ECX,EBX
008c8538 : CALL 0x0097fa60
008c853d : JMP 0x008c85e6
008c8542 : PUSH 0xc519ac
008c8547 : LEA ECX,[EBP + -0x50]
008c854a : CALL 0x00406460
008c854f : MOV dword ptr [EBP + -0x4],0x0
008c8556 : LEA ECX,[EBP + -0x50]
008c8559 : PUSH ECX
008c855a : MOV ECX,dword ptr [0x0172491c]
008c8560 : LEA EDI,[EBP + -0x2c]
008c8563 : CALL 0x0081d120
008c8568 : MOV byte ptr [EBP + -0x4],0x2
008c856c : LEA ECX,[EBP + -0x50]
008c856f : JMP 0x008c859e
008c8571 : PUSH 0xc519e4
008c8576 : LEA ECX,[EBP + -0x6c]
008c8579 : CALL 0x00406460
008c857e : MOV dword ptr [EBP + -0x4],0x3
008c8585 : LEA ECX,[EBP + -0x6c]
008c8588 : PUSH ECX
008c8589 : MOV ECX,dword ptr [0x0172491c]
008c858f : LEA EDI,[EBP + -0x2c]
008c8592 : CALL 0x0081d120
008c8597 : MOV byte ptr [EBP + -0x4],0x5
008c859b : LEA ECX,[EBP + -0x6c]
008c859e : CALL 0x00406560
008c85a3 : MOV EDX,dword ptr [0x00da9894]
008c85a9 : MOV EAX,dword ptr [EDX]
008c85ab : MOV ECX,dword ptr [EAX + 0x1a8]
008c85b1 : MOV EAX,dword ptr [ECX]
008c85b3 : MOV EAX,dword ptr [EAX + 0x44]
008c85b6 : PUSH 0x3
008c85b8 : LEA EDX,[EBP + -0x2c]
008c85bb : PUSH EDX
008c85bc : CALL EAX
008c85be : MOV dword ptr [EBP + -0x4],0xffffffff
008c85c5 : LEA ECX,[EBP + -0x2c]
008c85c8 : CALL 0x00406560
008c85cd : MOV ECX,EBX
008c85cf : CALL 0x0097fa60
008c85d4 : JMP 0x008c85e6
008c85d6 : PUSH 0x0
008c85d8 : PUSH EDI
008c85d9 : PUSH EAX
008c85da : MOV EAX,0x97
008c85df : MOV ECX,EBX
008c85e1 : CALL 0x0097fb30
008c85e6 : MOV ECX,dword ptr [EBP + -0xc]
008c85e9 : MOV dword ptr FS:[0x0],ECX
008c85f0 : POP ECX
008c85f1 : POP EDI
008c85f2 : POP ESI
008c85f3 : POP EBX
008c85f4 : MOV ECX,dword ptr [EBP + -0x10]
008c85f7 : XOR ECX,EBP
008c85f9 : CALL 0x00633e6b
008c85fe : MOV ESP,EBP
008c8600 : POP EBP
008c8601 : RET 0x4

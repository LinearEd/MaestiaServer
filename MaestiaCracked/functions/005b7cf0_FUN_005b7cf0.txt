PROGRAM  : Maestia.exe
FUNCTION : FUN_005b7cf0
ENTRY    : 005b7cf0
BODY     : [[005b7cf0, 005b7d5c]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_005b7cf0(void)

{
  int iVar1;
  uint uVar2;
  int *in_ECX;
  undefined4 uStack_10;
  undefined4 uStack_c;
  undefined2 uStack_8;
  undefined1 uStack_6;
  undefined1 uStack_5;
  undefined1 uStack_4;
  undefined1 uStack_3;
  
  iVar1 = (**(code **)(*in_ECX + 0x40))();
  if (((*(uint *)(iVar1 + 0xb00) >> 0x10 & 1) != 0) &&
     ((uVar2 = *(uint *)(iVar1 + 0xb00) >> 0x1c & 3, uVar2 == 3 || (uVar2 != 1)))) {
    uStack_c = 0;
    uStack_6 = 0;
    uStack_4 = 0;
    uStack_3 = 0;
    uStack_8 = 0;
    uStack_10 = 0x4000;
    uStack_5 = 0xff;
    (**(code **)(*in_ECX + 0xe8))(&uStack_10);
  }
  return 1;
}



============================================================
DISASSEMBLY
============================================================
005b7cf0 : SUB ESP,0x10
005b7cf3 : PUSH ESI
005b7cf4 : MOV ESI,ECX
005b7cf6 : MOV EAX,dword ptr [ESI]
005b7cf8 : MOV EDX,dword ptr [EAX + 0x40]
005b7cfb : CALL EDX
005b7cfd : MOV EAX,dword ptr [EAX + 0xb00]
005b7d03 : MOV ECX,EAX
005b7d05 : SHR ECX,0x10
005b7d08 : TEST CL,0x1
005b7d0b : JZ 0x005b7d54
005b7d0d : SHR EAX,0x1c
005b7d10 : AND EAX,0x3
005b7d13 : CMP EAX,0x3
005b7d16 : JZ 0x005b7d1d
005b7d18 : CMP EAX,0x1
005b7d1b : JZ 0x005b7d54
005b7d1d : XOR EAX,EAX
005b7d1f : XOR EDX,EDX
005b7d21 : MOV dword ptr [ESP + 0x8],EAX
005b7d25 : MOV byte ptr [ESP + 0xe],AL
005b7d29 : MOV byte ptr [ESP + 0x10],AL
005b7d2d : MOV byte ptr [ESP + 0x11],AL
005b7d31 : MOV EAX,dword ptr [ESI]
005b7d33 : LEA ECX,[ESP + 0x4]
005b7d37 : MOV word ptr [ESP + 0xc],DX
005b7d3c : MOV EDX,dword ptr [EAX + 0xe8]
005b7d42 : PUSH ECX
005b7d43 : MOV ECX,ESI
005b7d45 : MOV dword ptr [ESP + 0x8],0x4000
005b7d4d : MOV byte ptr [ESP + 0x13],0xff
005b7d52 : CALL EDX
005b7d54 : MOV AL,0x1
005b7d56 : POP ESI
005b7d57 : ADD ESP,0x10
005b7d5a : RET 0x8

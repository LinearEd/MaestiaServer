PROGRAM  : Maestia.exe
FUNCTION : FUN_0067c670
ENTRY    : 0067c670
BODY     : [[0067c670, 0067c68c] [0067c690, 0067c779]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_0067c670(char *param_1)

{
  char cVar1;
  undefined4 uVar2;
  char *pcVar3;
  uint uVar4;
  LONG LVar5;
  int iVar6;
  int *piVar7;
  int in_ECX;
  uint local_18;
  uint local_14;
  int local_10;
  uint local_c;
  uint local_8;
  int local_4;
  
  FUN_0051b6e0();
  pcVar3 = param_1;
  do {
    cVar1 = *pcVar3;
    pcVar3 = pcVar3 + 1;
  } while (cVar1 != '\0');
  uVar4 = FUN_0051b370(param_1,(int)pcVar3 - (int)(param_1 + 1),0x1505);
  FUN_0051c480(param_1);
  local_8 = uVar4 & 0xffffff;
  local_4 = (int)pcVar3 - (int)(param_1 + 1);
  FUN_0051bc20(&local_c);
  local_14 = local_8;
  local_10 = local_4;
  LVar5 = InterlockedExchangeAdd((LONG *)((local_c & 0xfffffffc) + 4),-1);
  if (LVar5 == 1) {
    FUN_00515cf0(local_c & 0xfffffffc);
  }
  if (*(int *)(in_ECX + 4) != 0) {
    iVar6 = FUN_0067c140(&local_18,*(uint *)(*(int *)(in_ECX + 4) + 4) & local_14);
    if (-1 < iVar6) {
      piVar7 = (int *)(*(int *)(in_ECX + 4) + 0xc + iVar6 * 8);
      goto LAB_0067c72b;
    }
  }
  piVar7 = (int *)0x0;
LAB_0067c72b:
  uVar4 = local_18 & 0xfffffffc;
  if (*piVar7 != 0) {
    uVar2 = *(undefined4 *)(*piVar7 + 8);
    LVar5 = InterlockedExchangeAdd((LONG *)(uVar4 + 4),-1);
    if (LVar5 == 1) {
      FUN_00515cf0(uVar4);
    }
    return uVar2;
  }
  LVar5 = InterlockedExchangeAdd((LONG *)(uVar4 + 4),-1);
  if (LVar5 == 1) {
    FUN_00515cf0(uVar4);
  }
  return 0x1000000;
}



============================================================
DISASSEMBLY
============================================================
0067c670 : SUB ESP,0x18
0067c673 : PUSH EBX
0067c674 : PUSH EBP
0067c675 : PUSH ESI
0067c676 : MOV EBP,ECX
0067c678 : PUSH EDI
0067c679 : LEA ECX,[ESP + 0x10]
0067c67d : CALL 0x0051b6e0
0067c682 : MOV EBX,dword ptr [ESP + 0x2c]
0067c686 : MOV EAX,EBX
0067c688 : LEA EDX,[EAX + 0x1]
0067c68b : JMP 0x0067c690
0067c690 : MOV CL,byte ptr [EAX]
0067c692 : INC EAX
0067c693 : TEST CL,CL
0067c695 : JNZ 0x0067c690
0067c697 : SUB EAX,EDX
0067c699 : PUSH 0x1505
0067c69e : MOV EDI,EAX
0067c6a0 : PUSH EDI
0067c6a1 : PUSH EBX
0067c6a2 : CALL 0x0051b370
0067c6a7 : MOV ESI,EAX
0067c6a9 : PUSH EBX
0067c6aa : LEA ECX,[ESP + 0x20]
0067c6ae : AND ESI,0xffffff
0067c6b4 : CALL 0x0051c480
0067c6b9 : LEA EAX,[ESP + 0x1c]
0067c6bd : PUSH EAX
0067c6be : LEA ECX,[ESP + 0x14]
0067c6c2 : MOV dword ptr [ESP + 0x24],ESI
0067c6c6 : MOV dword ptr [ESP + 0x28],EDI
0067c6ca : CALL 0x0051bc20
0067c6cf : MOV ESI,dword ptr [ESP + 0x1c]
0067c6d3 : MOV ECX,dword ptr [ESP + 0x20]
0067c6d7 : MOV EDX,dword ptr [ESP + 0x24]
0067c6db : MOV EDI,dword ptr [0x00b851cc]
0067c6e1 : AND ESI,0xfffffffc
0067c6e4 : PUSH -0x1
0067c6e6 : LEA EAX,[ESI + 0x4]
0067c6e9 : PUSH EAX
0067c6ea : MOV dword ptr [ESP + 0x1c],ECX
0067c6ee : MOV dword ptr [ESP + 0x20],EDX
0067c6f2 : CALL EDI
0067c6f4 : SUB EAX,0x1
0067c6f7 : JNZ 0x0067c6ff
0067c6f9 : PUSH ESI
0067c6fa : CALL 0x00515cf0
0067c6ff : MOV EAX,dword ptr [EBP + 0x4]
0067c702 : LEA ESI,[EBP + 0x4]
0067c705 : TEST EAX,EAX
0067c707 : JZ 0x0067c729
0067c709 : MOV EAX,dword ptr [EAX + 0x4]
0067c70c : AND EAX,dword ptr [ESP + 0x14]
0067c710 : LEA ECX,[ESP + 0x10]
0067c714 : PUSH EAX
0067c715 : PUSH ECX
0067c716 : MOV ECX,ESI
0067c718 : CALL 0x0067c140
0067c71d : TEST EAX,EAX
0067c71f : JL 0x0067c729
0067c721 : MOV EDX,dword ptr [ESI]
0067c723 : LEA EAX,[EDX + EAX*0x8 + 0xc]
0067c727 : JMP 0x0067c72b
0067c729 : XOR EAX,EAX
0067c72b : MOV ESI,dword ptr [ESP + 0x10]
0067c72f : MOV EAX,dword ptr [EAX]
0067c731 : AND ESI,0xfffffffc
0067c734 : PUSH -0x1
0067c736 : TEST EAX,EAX
0067c738 : JZ 0x0067c75a
0067c73a : MOV EBX,dword ptr [EAX + 0x8]
0067c73d : LEA EAX,[ESI + 0x4]
0067c740 : PUSH EAX
0067c741 : CALL EDI
0067c743 : SUB EAX,0x1
0067c746 : JNZ 0x0067c74e
0067c748 : PUSH ESI
0067c749 : CALL 0x00515cf0
0067c74e : POP EDI
0067c74f : POP ESI
0067c750 : POP EBP
0067c751 : MOV EAX,EBX
0067c753 : POP EBX
0067c754 : ADD ESP,0x18
0067c757 : RET 0x4
0067c75a : LEA ECX,[ESI + 0x4]
0067c75d : PUSH ECX
0067c75e : CALL EDI
0067c760 : SUB EAX,0x1
0067c763 : JNZ 0x0067c76b
0067c765 : PUSH ESI
0067c766 : CALL 0x00515cf0
0067c76b : POP EDI
0067c76c : POP ESI
0067c76d : POP EBP
0067c76e : MOV EAX,0x1000000
0067c773 : POP EBX
0067c774 : ADD ESP,0x18
0067c777 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_009a2060
ENTRY    : 009a2060
BODY     : [[009a2060, 009a224c]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009a2060(void)

{
  int iVar1;
  int iVar2;
  int *unaff_EDI;
  uint local_44;
  int local_3c;
  int local_34;
  undefined1 local_30 [4];
  uint local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4af1d;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_34 = 0xe;
  do {
    iVar2 = (**(code **)(*unaff_EDI + 0x74))();
    iVar1 = DAT_00d7c54c;
    if (((iVar2 != 0) && (FUN_004437f0(), local_3c != *(int *)(iVar1 + 0x44))) &&
       (*(int *)(local_3c + 0x10) != 0)) {
      local_18 = 7;
      local_1c = 0;
      local_2c = local_2c & 0xffff0000;
      local_8 = 0;
      (**(code **)(*unaff_EDI + 0x58))();
      FUN_00405eb0(local_30,0,0xffffffff);
      local_8 = local_8 & 0xffffff00;
      FUN_008f75f0();
      local_8._0_1_ = 2;
      FUN_00405eb0();
      local_8 = (uint)local_8._1_3_ << 8;
      if (7 < local_44) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_44 = 7;
      iVar1 = *DAT_00da9894;
      if ((iVar1 != 0) && (*(int *)(iVar1 + 0x114) != 0)) {
        (**(code **)(**(int **)(iVar1 + 0x114) + 4))();
      }
      FUN_00a08b70();
      iVar1 = *DAT_00da9894;
      if ((iVar1 != 0) && (*(int *)(iVar1 + 0x114) != 0)) {
        (**(code **)(**(int **)(iVar1 + 0x114) + 4))();
      }
      local_8 = 0xffffffff;
      if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_18 = 7;
      local_1c = 0;
      local_2c = local_2c & 0xffff0000;
    }
    local_34 = local_34 + 1;
    if (0x13 < local_34) {
      FUN_009a0fa0();
      ExceptionList = local_10;
      __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
      return;
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
009a2060 : PUSH EBP
009a2061 : MOV EBP,ESP
009a2063 : PUSH -0x1
009a2065 : PUSH 0xb4af1d
009a206a : MOV EAX,FS:[0x0]
009a2070 : PUSH EAX
009a2071 : SUB ESP,0x50
009a2074 : MOV EAX,[0x00d66fa0]
009a2079 : XOR EAX,EBP
009a207b : MOV dword ptr [EBP + -0x10],EAX
009a207e : PUSH EBX
009a207f : PUSH ESI
009a2080 : PUSH EAX
009a2081 : LEA EAX,[EBP + -0xc]
009a2084 : MOV FS:[0x0],EAX
009a208a : MOV EAX,0xe
009a208f : MOV dword ptr [EBP + -0x30],EAX
009a2092 : XOR EBX,EBX
009a2094 : MOV EDX,dword ptr [EDI]
009a2096 : PUSH EBX
009a2097 : PUSH EAX
009a2098 : MOV EAX,dword ptr [EDX + 0x74]
009a209b : MOV ECX,EDI
009a209d : CALL EAX
009a209f : MOV dword ptr [EBP + -0x3c],EAX
009a20a2 : CMP EAX,EBX
009a20a4 : JZ 0x009a2209
009a20aa : MOV ECX,dword ptr [EAX + 0x10]
009a20ad : MOV ESI,dword ptr [0x00d7c54c]
009a20b3 : LEA EDX,[EBP + -0x34]
009a20b6 : MOV dword ptr [EBP + -0x34],ECX
009a20b9 : PUSH EDX
009a20ba : LEA ECX,[ESI + 0x40]
009a20bd : LEA EAX,[EBP + -0x38]
009a20c0 : CALL 0x004437f0
009a20c5 : MOV ESI,dword ptr [ESI + 0x44]
009a20c8 : MOV EAX,dword ptr [EBP + -0x38]
009a20cb : CMP EAX,ESI
009a20cd : JZ 0x009a2209
009a20d3 : MOV EAX,dword ptr [EAX + 0x10]
009a20d6 : CMP EAX,EBX
009a20d8 : JZ 0x009a2209
009a20de : MOV ESI,0x7
009a20e3 : XOR ECX,ECX
009a20e5 : MOV dword ptr [EBP + -0x14],ESI
009a20e8 : MOV dword ptr [EBP + -0x18],EBX
009a20eb : MOV word ptr [EBP + -0x28],CX
009a20ef : MOV dword ptr [EBP + -0x4],EBX
009a20f2 : MOV EDX,dword ptr [EDI]
009a20f4 : MOV EDX,dword ptr [EDX + 0x58]
009a20f7 : LEA ECX,[EBP + -0x2c]
009a20fa : PUSH ECX
009a20fb : MOVZX ECX,word ptr [EAX + 0x4]
009a20ff : MOVZX EAX,word ptr [EAX + 0x6]
009a2103 : SHL ECX,0x10
009a2106 : OR ECX,EAX
009a2108 : PUSH ECX
009a2109 : MOV ECX,EDI
009a210b : CALL EDX
009a210d : SUB ESP,0x1c
009a2110 : MOV ECX,ESP
009a2112 : MOV dword ptr [EBP + -0x34],ESP
009a2115 : PUSH -0x1
009a2117 : PUSH EBX
009a2118 : LEA EDX,[EBP + -0x2c]
009a211b : XOR EAX,EAX
009a211d : MOV dword ptr [ECX + 0x18],ESI
009a2120 : MOV dword ptr [ECX + 0x14],EBX
009a2123 : PUSH EDX
009a2124 : MOV word ptr [ECX + 0x4],AX
009a2128 : CALL 0x00405eb0
009a212d : MOV byte ptr [EBP + -0x4],0x1
009a2131 : MOV byte ptr [EBP + -0x4],BL
009a2134 : LEA ECX,[EBP + -0x58]
009a2137 : CALL 0x008f75f0
009a213c : ADD ESP,0x1c
009a213f : MOV byte ptr [EBP + -0x4],0x2
009a2143 : PUSH -0x1
009a2145 : PUSH EBX
009a2146 : PUSH EAX
009a2147 : LEA ECX,[EBP + -0x2c]
009a214a : CALL 0x00405eb0
009a214f : MOV byte ptr [EBP + -0x4],BL
009a2152 : CMP dword ptr [EBP + -0x40],0x8
009a2156 : JC 0x009a2160
009a2158 : MOV ECX,dword ptr [EBP + -0x54]
009a215b : CALL 0x006f04e0
009a2160 : MOV ECX,dword ptr [0x00da9894]
009a2166 : XOR EAX,EAX
009a2168 : MOV dword ptr [EBP + -0x40],ESI
009a216b : MOV dword ptr [EBP + -0x44],EBX
009a216e : MOV word ptr [EBP + -0x54],AX
009a2172 : MOV EAX,dword ptr [ECX]
009a2174 : CMP EAX,EBX
009a2176 : JZ 0x009a21ac
009a2178 : CMP dword ptr [EAX + 0x114],EBX
009a217e : JZ 0x009a21ac
009a2180 : CMP dword ptr [EBP + -0x14],0x8
009a2184 : MOV EAX,dword ptr [EAX + 0x114]
009a218a : MOV ECX,dword ptr [EBP + -0x28]
009a218d : JNC 0x009a2192
009a218f : LEA ECX,[EBP + -0x28]
009a2192 : MOV EDX,dword ptr [EAX]
009a2194 : MOV EDX,dword ptr [EDX + 0x4]
009a2197 : PUSH ECX
009a2198 : MOV ECX,dword ptr [EBP + -0x30]
009a219b : PUSH ECX
009a219c : PUSH 0xc89564
009a21a1 : PUSH 0xc8956c
009a21a6 : PUSH EAX
009a21a7 : CALL EDX
009a21a9 : ADD ESP,0x14
009a21ac : MOV ECX,dword ptr [EBP + -0x3c]
009a21af : CALL 0x00a08b70
009a21b4 : MOV ECX,dword ptr [0x00da9894]
009a21ba : MOV ECX,dword ptr [ECX]
009a21bc : CMP ECX,EBX
009a21be : JZ 0x009a21e8
009a21c0 : CMP dword ptr [ECX + 0x114],EBX
009a21c6 : JZ 0x009a21e8
009a21c8 : MOV ECX,dword ptr [ECX + 0x114]
009a21ce : MOV EDX,dword ptr [ECX]
009a21d0 : PUSH EAX
009a21d1 : MOV EAX,dword ptr [EBP + -0x30]
009a21d4 : PUSH EAX
009a21d5 : PUSH 0xc8957c
009a21da : PUSH 0xc89584
009a21df : PUSH ECX
009a21e0 : MOV ECX,dword ptr [EDX + 0x4]
009a21e3 : CALL ECX
009a21e5 : ADD ESP,0x14
009a21e8 : MOV dword ptr [EBP + -0x4],0xffffffff
009a21ef : CMP dword ptr [EBP + -0x14],0x8
009a21f3 : JC 0x009a21fd
009a21f5 : MOV ECX,dword ptr [EBP + -0x28]
009a21f8 : CALL 0x006f04e0
009a21fd : XOR EDX,EDX
009a21ff : MOV dword ptr [EBP + -0x14],ESI
009a2202 : MOV dword ptr [EBP + -0x18],EBX
009a2205 : MOV word ptr [EBP + -0x28],DX
009a2209 : MOV EAX,dword ptr [EBP + -0x30]
009a220c : INC EAX
009a220d : CMP EAX,0x13
009a2210 : MOV dword ptr [EBP + -0x30],EAX
009a2213 : JLE 0x009a2094
009a2219 : MOV EAX,[0x0172491c]
009a221e : MOV ECX,dword ptr [EAX + 0x17c]
009a2224 : MOVZX EDX,word ptr [ECX + 0xa0]
009a222b : PUSH EDX
009a222c : PUSH EDI
009a222d : CALL 0x009a0fa0
009a2232 : MOV ECX,dword ptr [EBP + -0xc]
009a2235 : MOV dword ptr FS:[0x0],ECX
009a223c : POP ECX
009a223d : POP ESI
009a223e : POP EBX
009a223f : MOV ECX,dword ptr [EBP + -0x10]
009a2242 : XOR ECX,EBP
009a2244 : CALL 0x00633e6b
009a2249 : MOV ESP,EBP
009a224b : POP EBP
009a224c : RET

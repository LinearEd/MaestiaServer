PROGRAM  : Maestia.exe
FUNCTION : FUN_00565b30
ENTRY    : 00565b30
BODY     : [[00565b30, 00565c66]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00565b30(undefined4 param_1,undefined4 *param_2,uint param_3)

{
  uint *puVar1;
  int iVar2;
  int *piVar3;
  uint uVar4;
  uint *puVar5;
  int *in_ECX;
  int iVar6;
  uint uVar7;
  int iVar8;
  
  piVar3 = (int *)*in_ECX;
  if (piVar3 == (int *)0x0) {
    iVar8 = 8;
  }
  else {
    if ((uint)(*piVar3 * 5) <= piVar3[1] * 4 + 4U) goto LAB_00565b6c;
    iVar8 = piVar3[1] * 2 + 2;
  }
  FUN_005640d0(param_1,iVar8);
LAB_00565b6c:
  piVar3 = (int *)*in_ECX;
  param_3 = param_3 & piVar3[1];
  *piVar3 = *piVar3 + 1;
  iVar8 = *in_ECX;
  puVar1 = (uint *)(param_3 * 0x10 + 8 + iVar8);
  if (*puVar1 == 0xfffffffe) {
    *puVar1 = 0xffffffff;
    FUN_0051c2c0(*param_2);
    puVar1[3] = *(uint *)param_2[1];
    puVar1[1] = param_3;
    return;
  }
  uVar7 = param_3;
  do {
    uVar7 = uVar7 + 1 & *(uint *)(iVar8 + 4);
  } while (*(int *)(iVar8 + 8 + uVar7 * 0x10) != -2);
  iVar2 = uVar7 * 0x10 + 8 + iVar8;
  if (puVar1[1] == param_3) {
    if (iVar2 != 0) {
      FUN_00562a90(puVar1);
    }
    FUN_0051bc20(*param_2);
    puVar1[3] = *(uint *)param_2[1];
    puVar1[1] = param_3;
    *puVar1 = uVar7;
    return;
  }
  iVar6 = puVar1[1] * 0x10;
  uVar4 = *(uint *)(iVar6 + 8 + iVar8);
  while (puVar5 = (uint *)(iVar6 + 8 + iVar8), uVar4 != param_3) {
    iVar6 = *puVar5 * 0x10;
    uVar4 = *(uint *)(iVar6 + 8 + iVar8);
  }
  if (iVar2 != 0) {
    FUN_00562a90(puVar1);
  }
  *puVar5 = uVar7;
  FUN_0051bc20(*param_2);
  puVar1[3] = *(uint *)param_2[1];
  puVar1[1] = param_3;
  *puVar1 = 0xffffffff;
  return;
}



============================================================
DISASSEMBLY
============================================================
00565b30 : PUSH EBX
00565b31 : PUSH EBP
00565b32 : PUSH ESI
00565b33 : MOV ESI,ECX
00565b35 : MOV EAX,dword ptr [ESI]
00565b37 : PUSH EDI
00565b38 : TEST EAX,EAX
00565b3a : JNZ 0x00565b45
00565b3c : MOV EAX,dword ptr [ESP + 0x14]
00565b40 : PUSH 0x8
00565b42 : PUSH EAX
00565b43 : JMP 0x00565b67
00565b45 : MOV ECX,dword ptr [EAX + 0x4]
00565b48 : LEA EDX,[ECX*0x4 + 0x4]
00565b4f : MOV ECX,dword ptr [EAX]
00565b51 : LEA ECX,[ECX + ECX*0x4]
00565b54 : CMP ECX,EDX
00565b56 : JBE 0x00565b6c
00565b58 : MOV EDX,dword ptr [EAX + 0x4]
00565b5b : MOV ECX,dword ptr [ESP + 0x14]
00565b5f : LEA EAX,[EDX + EDX*0x1 + 0x2]
00565b63 : PUSH EAX
00565b64 : PUSH ECX
00565b65 : MOV ECX,ESI
00565b67 : CALL 0x005640d0
00565b6c : MOV EAX,dword ptr [ESI]
00565b6e : MOV EDI,dword ptr [ESP + 0x1c]
00565b72 : AND EDI,dword ptr [EAX + 0x4]
00565b75 : INC dword ptr [EAX]
00565b77 : MOV EAX,dword ptr [ESI]
00565b79 : MOV EDX,EDI
00565b7b : SHL EDX,0x4
00565b7e : LEA ESI,[EDX + EAX*0x1 + 0x8]
00565b82 : MOV EDX,0xfffffffe
00565b87 : CMP dword ptr [ESI],EDX
00565b89 : JNZ 0x00565bb5
00565b8b : MOV EBP,dword ptr [ESP + 0x18]
00565b8f : MOV dword ptr [ESI],0xffffffff
00565b95 : MOV EAX,dword ptr [EBP]
00565b98 : LEA EBX,[ESI + 0x8]
00565b9b : PUSH EAX
00565b9c : MOV ECX,EBX
00565b9e : CALL 0x0051c2c0
00565ba3 : MOV ECX,dword ptr [EBP + 0x4]
00565ba6 : MOV EDX,dword ptr [ECX]
00565ba8 : MOV dword ptr [EBX + 0x4],EDX
00565bab : MOV dword ptr [ESI + 0x4],EDI
00565bae : POP EDI
00565baf : POP ESI
00565bb0 : POP EBP
00565bb1 : POP EBX
00565bb2 : RET 0xc
00565bb5 : MOV ECX,dword ptr [EAX + 0x4]
00565bb8 : MOV EBX,EDI
00565bba : LEA EBX,[EBX]
00565bc0 : INC EBX
00565bc1 : AND EBX,ECX
00565bc3 : MOV EBP,EBX
00565bc5 : SHL EBP,0x4
00565bc8 : CMP dword ptr [EAX + EBP*0x1 + 0x8],EDX
00565bcc : JNZ 0x00565bc0
00565bce : MOV EDX,dword ptr [ESI + 0x4]
00565bd1 : MOV ECX,EBX
00565bd3 : SHL ECX,0x4
00565bd6 : LEA ECX,[ECX + EAX*0x1 + 0x8]
00565bda : CMP EDX,EDI
00565bdc : JNZ 0x00565c11
00565bde : TEST ECX,ECX
00565be0 : JZ 0x00565be8
00565be2 : PUSH ESI
00565be3 : CALL 0x00562a90
00565be8 : MOV EDX,dword ptr [ESP + 0x18]
00565bec : MOV EAX,dword ptr [EDX]
00565bee : LEA EBP,[ESI + 0x8]
00565bf1 : PUSH EAX
00565bf2 : MOV ECX,EBP
00565bf4 : CALL 0x0051bc20
00565bf9 : MOV ECX,dword ptr [ESP + 0x18]
00565bfd : MOV EDX,dword ptr [ECX + 0x4]
00565c00 : MOV EAX,dword ptr [EDX]
00565c02 : MOV dword ptr [EBP + 0x4],EAX
00565c05 : MOV dword ptr [ESI + 0x4],EDI
00565c08 : POP EDI
00565c09 : MOV dword ptr [ESI],EBX
00565c0b : POP ESI
00565c0c : POP EBP
00565c0d : POP EBX
00565c0e : RET 0xc
00565c11 : SHL EDX,0x4
00565c14 : CMP dword ptr [EDX + EAX*0x1 + 0x8],EDI
00565c18 : LEA EBP,[EDX + EAX*0x1 + 0x8]
00565c1c : JZ 0x00565c30
00565c1e : MOV EDI,EDI
00565c20 : MOV EDX,dword ptr [EBP]
00565c23 : SHL EDX,0x4
00565c26 : CMP dword ptr [EDX + EAX*0x1 + 0x8],EDI
00565c2a : LEA EBP,[EDX + EAX*0x1 + 0x8]
00565c2e : JNZ 0x00565c20
00565c30 : TEST ECX,ECX
00565c32 : JZ 0x00565c3a
00565c34 : PUSH ESI
00565c35 : CALL 0x00562a90
00565c3a : MOV dword ptr [EBP],EBX
00565c3d : MOV EBP,dword ptr [ESP + 0x18]
00565c41 : MOV EAX,dword ptr [EBP]
00565c44 : LEA EBX,[ESI + 0x8]
00565c47 : PUSH EAX
00565c48 : MOV ECX,EBX
00565c4a : CALL 0x0051bc20
00565c4f : MOV ECX,dword ptr [EBP + 0x4]
00565c52 : MOV EDX,dword ptr [ECX]
00565c54 : MOV dword ptr [EBX + 0x4],EDX
00565c57 : MOV dword ptr [ESI + 0x4],EDI
00565c5a : POP EDI
00565c5b : MOV dword ptr [ESI],0xffffffff
00565c61 : POP ESI
00565c62 : POP EBP
00565c63 : POP EBX
00565c64 : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_0042c080
ENTRY    : 0042c080
BODY     : [[0042c080, 0042c1b8] [0042c1ca, 0042c29b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0042c080(uint param_1,undefined4 *param_2)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  undefined4 uVar4;
  uint in_ECX;
  uint uVar5;
  uint extraout_ECX;
  undefined4 *puVar6;
  int iVar7;
  uint local_20;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  iVar2 = param_1;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7bb60;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  iVar3 = *(int *)(param_1 + 4);
  if (iVar3 == 0) {
    uVar5 = 0;
  }
  else {
    uVar5 = *(int *)(param_1 + 0xc) - iVar3 >> 2;
  }
  if (in_ECX != 0) {
    iVar7 = *(int *)(param_1 + 8);
    iVar3 = iVar7 - iVar3 >> 2;
    if (0x3fffffffU - iVar3 < in_ECX) {
      iVar3 = FUN_00452880();
      uVar5 = extraout_ECX;
    }
    uVar1 = iVar3 + in_ECX;
    if (uVar5 < uVar1) {
      if (0x3fffffff - (uVar5 >> 1) < uVar5) {
        param_1 = 0;
      }
      else {
        param_1 = uVar5 + (uVar5 >> 1);
      }
      if (param_1 < uVar1) {
        param_1 = uVar1;
      }
      iVar3 = FUN_004c1790();
      local_8 = 0;
      FUN_004c1760();
      FUN_004c17f0(*(undefined4 *)(iVar2 + 4),param_2);
      FUN_004c17f0(param_2,*(undefined4 *)(iVar2 + 8));
      local_8 = 0xffffffff;
      if (*(int *)(iVar2 + 4) == 0) {
        *(uint *)(iVar2 + 0xc) = iVar3 + param_1 * 4;
        *(uint *)(iVar2 + 8) =
             iVar3 + (in_ECX + (*(int *)(iVar2 + 8) - *(int *)(iVar2 + 4) >> 2)) * 4;
        *(int *)(iVar2 + 4) = iVar3;
        ExceptionList = local_10;
        return;
      }
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    if ((uint)(iVar7 - (int)param_2 >> 2) < in_ECX) {
      FUN_004c17f0(param_2,iVar7);
      local_8 = 2;
      local_20 = local_20 & 0xffffff00;
      FUN_004c1940(*(int *)(param_1 + 8),in_ECX - (*(int *)(param_1 + 8) - (int)param_2 >> 2),
                   param_2,local_20);
      local_8 = 0xffffffff;
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + in_ECX * 4;
    }
    else {
      puVar6 = (undefined4 *)(iVar7 + in_ECX * -4);
      uVar4 = FUN_004c17f0(puVar6,iVar7);
      *(undefined4 *)(param_1 + 8) = uVar4;
      if (param_2 != puVar6) {
        iVar7 = iVar7 - (int)puVar6;
        do {
          puVar6 = puVar6 + -1;
          *(undefined4 *)(iVar7 + (int)puVar6) = *puVar6;
        } while (puVar6 != param_2);
      }
    }
    FUN_00422490(param_2);
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
0042c080 : PUSH EBP
0042c081 : MOV EBP,ESP
0042c083 : PUSH -0x1
0042c085 : PUSH 0xb7bb60
0042c08a : MOV EAX,FS:[0x0]
0042c090 : PUSH EAX
0042c091 : SUB ESP,0x10
0042c094 : PUSH EBX
0042c095 : PUSH ESI
0042c096 : PUSH EDI
0042c097 : MOV EAX,[0x00d66fa0]
0042c09c : XOR EAX,EBP
0042c09e : PUSH EAX
0042c09f : LEA EAX,[EBP + -0xc]
0042c0a2 : MOV FS:[0x0],EAX
0042c0a8 : MOV dword ptr [EBP + -0x10],ESP
0042c0ab : MOV ESI,ECX
0042c0ad : MOV EBX,dword ptr [EBP + 0x8]
0042c0b0 : MOV EDX,dword ptr [EBX + 0x4]
0042c0b3 : TEST EDX,EDX
0042c0b5 : JNZ 0x0042c0bb
0042c0b7 : XOR ECX,ECX
0042c0b9 : JMP 0x0042c0c5
0042c0bb : MOV EAX,dword ptr [EBX + 0xc]
0042c0be : SUB EAX,EDX
0042c0c0 : SAR EAX,0x2
0042c0c3 : MOV ECX,EAX
0042c0c5 : TEST ESI,ESI
0042c0c7 : JZ 0x0042c288
0042c0cd : MOV EDI,dword ptr [EBX + 0x8]
0042c0d0 : MOV EAX,EDI
0042c0d2 : SUB EAX,EDX
0042c0d4 : SAR EAX,0x2
0042c0d7 : MOV EDX,0x3fffffff
0042c0dc : SUB EDX,EAX
0042c0de : CMP EDX,ESI
0042c0e0 : JNC 0x0042c0e7
0042c0e2 : CALL 0x00452880
0042c0e7 : LEA EDX,[EAX + ESI*0x1]
0042c0ea : CMP ECX,EDX
0042c0ec : JNC 0x0042c1ca
0042c0f2 : MOV EAX,ECX
0042c0f4 : SHR EAX,0x1
0042c0f6 : MOV EDI,0x3fffffff
0042c0fb : SUB EDI,EAX
0042c0fd : CMP EDI,ECX
0042c0ff : JNC 0x0042c10d
0042c101 : MOV dword ptr [EBP + 0x8],0x0
0042c108 : MOV ECX,dword ptr [EBP + 0x8]
0042c10b : JMP 0x0042c112
0042c10d : ADD ECX,EAX
0042c10f : MOV dword ptr [EBP + 0x8],ECX
0042c112 : CMP ECX,EDX
0042c114 : JNC 0x0042c11b
0042c116 : MOV dword ptr [EBP + 0x8],EDX
0042c119 : MOV ECX,EDX
0042c11b : CALL 0x004c1790
0042c120 : MOV dword ptr [EBP + -0x14],EAX
0042c123 : MOV ECX,dword ptr [EBP + 0xc]
0042c126 : SUB ECX,dword ptr [EBX + 0x4]
0042c129 : SAR ECX,0x2
0042c12c : MOV dword ptr [EBP + -0x1c],ECX
0042c12f : MOV dword ptr [EBP + -0x4],0x0
0042c136 : LEA EDI,[EAX + ECX*0x4]
0042c139 : MOV EDX,dword ptr [EBP + 0x10]
0042c13c : CALL 0x004c1760
0042c141 : MOV dword ptr [EBP + -0x18],0x1
0042c148 : MOV EAX,dword ptr [EBP + 0xc]
0042c14b : PUSH EAX
0042c14c : MOV ECX,dword ptr [EBX + 0x4]
0042c14f : PUSH ECX
0042c150 : MOV EDI,dword ptr [EBP + -0x14]
0042c153 : MOV EDX,EDI
0042c155 : CALL 0x004c17f0
0042c15a : MOV dword ptr [EBP + -0x18],0x2
0042c161 : MOV EDX,dword ptr [EBP + -0x1c]
0042c164 : ADD EDX,ESI
0042c166 : LEA EDX,[EDI + EDX*0x4]
0042c169 : MOV EAX,dword ptr [EBX + 0x8]
0042c16c : PUSH EAX
0042c16d : MOV ECX,dword ptr [EBP + 0xc]
0042c170 : PUSH ECX
0042c171 : CALL 0x004c17f0
0042c176 : MOV dword ptr [EBP + -0x4],0xffffffff
0042c17d : MOV ECX,dword ptr [EBX + 0x4]
0042c180 : MOV EDX,dword ptr [EBX + 0x8]
0042c183 : SUB EDX,ECX
0042c185 : SAR EDX,0x2
0042c188 : ADD ESI,EDX
0042c18a : TEST ECX,ECX
0042c18c : JZ 0x0042c193
0042c18e : CALL 0x006f04e0
0042c193 : MOV EAX,dword ptr [EBP + 0x8]
0042c196 : LEA ECX,[EDI + EAX*0x4]
0042c199 : MOV dword ptr [EBX + 0xc],ECX
0042c19c : LEA EDX,[EDI + ESI*0x4]
0042c19f : MOV dword ptr [EBX + 0x8],EDX
0042c1a2 : MOV dword ptr [EBX + 0x4],EDI
0042c1a5 : MOV ECX,dword ptr [EBP + -0xc]
0042c1a8 : MOV dword ptr FS:[0x0],ECX
0042c1af : POP ECX
0042c1b0 : POP EDI
0042c1b1 : POP ESI
0042c1b2 : POP EBX
0042c1b3 : MOV ESP,EBP
0042c1b5 : POP EBP
0042c1b6 : RET 0xc
0042c1ca : MOV ECX,EDI
0042c1cc : MOV EAX,dword ptr [EBP + 0xc]
0042c1cf : SUB ECX,EAX
0042c1d1 : SAR ECX,0x2
0042c1d4 : PUSH EDI
0042c1d5 : CMP ECX,ESI
0042c1d7 : JNC 0x0042c239
0042c1d9 : MOV EDX,dword ptr [EBP + 0x10]
0042c1dc : MOV ECX,dword ptr [EDX]
0042c1de : MOV dword ptr [EBP + 0x8],ECX
0042c1e1 : LEA ECX,[ESI*0x4 + 0x0]
0042c1e8 : MOV dword ptr [EBP + 0x10],ECX
0042c1eb : LEA EDX,[ECX + EAX*0x1]
0042c1ee : PUSH EAX
0042c1ef : CALL 0x004c17f0
0042c1f4 : MOV dword ptr [EBP + -0x4],0x2
0042c1fb : MOV EAX,dword ptr [EBX + 0x8]
0042c1fe : MOV EDX,EAX
0042c200 : SUB EDX,dword ptr [EBP + 0xc]
0042c203 : SAR EDX,0x2
0042c206 : SUB ESI,EDX
0042c208 : MOV byte ptr [EBP + -0x1c],0x0
0042c20c : MOV ECX,dword ptr [EBP + -0x1c]
0042c20f : PUSH ECX
0042c210 : MOV EDX,dword ptr [EBP + 0xc]
0042c213 : PUSH EDX
0042c214 : PUSH ESI
0042c215 : PUSH EAX
0042c216 : LEA EDX,[EBP + 0x8]
0042c219 : CALL 0x004c1940
0042c21e : ADD ESP,0x10
0042c221 : MOV dword ptr [EBP + -0x4],0xffffffff
0042c228 : MOV EAX,dword ptr [EBP + 0x10]
0042c22b : ADD dword ptr [EBX + 0x8],EAX
0042c22e : MOV ECX,dword ptr [EBX + 0x8]
0042c231 : SUB ECX,EAX
0042c233 : MOV EAX,dword ptr [EBP + 0xc]
0042c236 : PUSH EAX
0042c237 : JMP 0x0042c27d
0042c239 : MOV ECX,dword ptr [EBP + 0x10]
0042c23c : MOV EDX,dword ptr [ECX]
0042c23e : MOV dword ptr [EBP + 0x8],EDX
0042c241 : LEA EAX,[ESI*0x4 + 0x0]
0042c248 : MOV dword ptr [EBP + 0x10],EAX
0042c24b : MOV ESI,EDI
0042c24d : SUB ESI,EAX
0042c24f : PUSH ESI
0042c250 : MOV EDX,EDI
0042c252 : CALL 0x004c17f0
0042c257 : MOV dword ptr [EBX + 0x8],EAX
0042c25a : MOV EAX,ESI
0042c25c : MOV EDX,dword ptr [EBP + 0xc]
0042c25f : MOV ECX,EDX
0042c261 : CMP EDX,EAX
0042c263 : JZ 0x0042c276
0042c265 : SUB EDI,ESI
0042c267 : SUB EAX,0x4
0042c26a : MOV EDX,dword ptr [EAX]
0042c26c : MOV dword ptr [EDI + EAX*0x1],EDX
0042c26f : CMP EAX,ECX
0042c271 : JNZ 0x0042c267
0042c273 : MOV EDX,dword ptr [EBP + 0xc]
0042c276 : MOV EAX,dword ptr [EBP + 0x10]
0042c279 : LEA ECX,[EAX + EDX*0x1]
0042c27c : PUSH EDX
0042c27d : LEA EDX,[EBP + 0x8]
0042c280 : CALL 0x00422490
0042c285 : ADD ESP,0x4
0042c288 : MOV ECX,dword ptr [EBP + -0xc]
0042c28b : MOV dword ptr FS:[0x0],ECX
0042c292 : POP ECX
0042c293 : POP EDI
0042c294 : POP ESI
0042c295 : POP EBX
0042c296 : MOV ESP,EBP
0042c298 : POP EBP
0042c299 : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_00429830
ENTRY    : 00429830
BODY     : [[00429830, 004299dd] [004299ea, 00429a0d] [00429a67, 00429b1f] [00429b45, 00429bde]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00429830(int param_1,int param_2,undefined4 param_3)

{
  uint *puVar1;
  undefined *puVar2;
  int iVar3;
  undefined4 uVar4;
  int extraout_ECX;
  int iVar5;
  uint uStack_138;
  undefined *local_114;
  undefined1 local_110 [244];
  uint local_1c;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7bc2a;
  local_10 = ExceptionList;
  uStack_138 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&uStack_138;
  ExceptionList = &local_10;
  iVar3 = *(int *)(param_1 + 4);
  if (iVar3 == 0) {
    local_114 = (undefined *)0x0;
  }
  else {
    local_114 = (undefined *)((*(int *)(param_1 + 0xc) - iVar3) / 0xf0);
  }
  iVar5 = *(int *)(param_1 + 8);
  puVar2 = (undefined *)((iVar5 - iVar3) / 0xf0);
  local_1c = uStack_138;
  puVar1 = &uStack_138;
  if (puVar2 == &DAT_01111111) {
    puVar2 = (undefined *)FUN_00429be0();
    iVar5 = extraout_ECX;
    puVar1 = (uint *)local_14;
  }
  local_14 = (undefined1 *)puVar1;
  puVar2 = puVar2 + 1;
  if (local_114 < puVar2) {
    if (&DAT_01111111 + -((uint)local_114 >> 1) < local_114) {
      local_114 = (undefined *)0x0;
    }
    else {
      local_114 = local_114 + ((uint)local_114 >> 1);
    }
    if (local_114 < puVar2) {
      local_114 = puVar2;
    }
    iVar3 = FUN_0042a190();
    local_8 = 0;
    FUN_00429710(param_3);
    FUN_0042a130(*(undefined4 *)(param_1 + 4),param_2);
    FUN_0042a130(param_2,*(undefined4 *)(param_1 + 8));
    local_8 = 0xffffffff;
    if (*(int *)(param_1 + 4) != 0) {
      FUN_004296a0();
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    *(int *)(param_1 + 0xc) = (int)local_114 * 0xf0 + iVar3;
    *(int *)(param_1 + 8) =
         ((*(int *)(param_1 + 8) - *(int *)(param_1 + 4)) / 0xf0 + 1) * 0xf0 + iVar3;
    *(int *)(param_1 + 4) = iVar3;
  }
  else {
    iVar3 = iVar5 - param_2 >> 0x1f;
    if ((iVar5 - param_2) / 0xf0 + iVar3 == iVar3) {
      FUN_00429f20(local_110);
      local_8 = 2;
      FUN_0042a130(param_2,*(undefined4 *)(param_1 + 8));
      local_8 = CONCAT31(local_8._1_3_,3);
      FUN_00429710(local_110);
      local_8 = 2;
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 0xf0;
      FUN_0042a160(*(int *)(param_1 + 8) + -0xf0);
    }
    else {
      FUN_00429f20(local_110);
      local_8 = 5;
      iVar3 = *(int *)(param_1 + 8) + -0xf0;
      uVar4 = FUN_0042a130(iVar3,*(int *)(param_1 + 8));
      *(undefined4 *)(param_1 + 8) = uVar4;
      for (; param_2 != iVar3; iVar3 = iVar3 + -0xf0) {
        FUN_0042a3a0();
      }
      FUN_0042a160(param_2 + 0xf0);
    }
    local_8 = 0xffffffff;
    FUN_00429340(local_110);
  }
  ExceptionList = local_10;
  __security_check_cookie(local_1c ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00429830 : PUSH EBP
00429831 : MOV EBP,ESP
00429833 : PUSH -0x1
00429835 : PUSH 0xb7bc2a
0042983a : MOV EAX,FS:[0x0]
00429840 : PUSH EAX
00429841 : SUB ESP,0x118
00429847 : MOV EAX,[0x00d66fa0]
0042984c : XOR EAX,EBP
0042984e : MOV dword ptr [EBP + -0x18],EAX
00429851 : PUSH EBX
00429852 : PUSH ESI
00429853 : PUSH EDI
00429854 : PUSH EAX
00429855 : LEA EAX,[EBP + -0xc]
00429858 : MOV FS:[0x0],EAX
0042985e : MOV dword ptr [EBP + -0x10],ESP
00429861 : MOV EBX,dword ptr [EBP + 0x8]
00429864 : MOV dword ptr [EBP + 0xfffffee8],EBX
0042986a : MOV EAX,dword ptr [EBP + 0x10]
0042986d : MOV dword ptr [EBP + 0xfffffeec],EAX
00429873 : MOV EDI,dword ptr [EBX + 0x4]
00429876 : TEST EDI,EDI
00429878 : JNZ 0x00429882
0042987a : MOV dword ptr [EBP + 0xfffffef0],EDI
00429880 : JMP 0x004298a0
00429882 : MOV ECX,dword ptr [EBX + 0xc]
00429885 : SUB ECX,EDI
00429887 : MOV EAX,0x88888889
0042988c : IMUL ECX
0042988e : ADD EDX,ECX
00429890 : SAR EDX,0x7
00429893 : MOV EAX,EDX
00429895 : SHR EAX,0x1f
00429898 : ADD EAX,EDX
0042989a : MOV dword ptr [EBP + 0xfffffef0],EAX
004298a0 : MOV ECX,dword ptr [EBX + 0x8]
004298a3 : MOV ESI,ECX
004298a5 : SUB ESI,EDI
004298a7 : MOV EAX,0x88888889
004298ac : IMUL ESI
004298ae : ADD EDX,ESI
004298b0 : SAR EDX,0x7
004298b3 : MOV EAX,EDX
004298b5 : SHR EAX,0x1f
004298b8 : ADD EAX,EDX
004298ba : MOV EDX,0x1111111
004298bf : SUB EDX,EAX
004298c1 : CMP EDX,0x1
004298c4 : JNC 0x004298cb
004298c6 : CALL 0x00429be0
004298cb : INC EAX
004298cc : MOV EDX,dword ptr [EBP + 0xfffffef0]
004298d2 : CMP EDX,EAX
004298d4 : JNC 0x00429a67
004298da : MOV ECX,EDX
004298dc : SHR ECX,0x1
004298de : MOV ESI,0x1111111
004298e3 : SUB ESI,ECX
004298e5 : CMP ESI,EDX
004298e7 : JNC 0x004298f5
004298e9 : XOR EDI,EDI
004298eb : MOV dword ptr [EBP + 0xfffffef0],EDI
004298f1 : MOV EDX,EDI
004298f3 : JMP 0x004298ff
004298f5 : ADD EDX,ECX
004298f7 : MOV dword ptr [EBP + 0xfffffef0],EDX
004298fd : XOR EDI,EDI
004298ff : CMP EDX,EAX
00429901 : JNC 0x0042990b
00429903 : MOV dword ptr [EBP + 0xfffffef0],EAX
00429909 : MOV EDX,EAX
0042990b : MOV ECX,EDX
0042990d : CALL 0x0042a190
00429912 : MOV ESI,EAX
00429914 : MOV dword ptr [EBP + 0xfffffee0],ESI
0042991a : MOV ECX,dword ptr [EBP + 0xc]
0042991d : SUB ECX,dword ptr [EBX + 0x4]
00429920 : MOV EAX,0x88888889
00429925 : IMUL ECX
00429927 : ADD EDX,ECX
00429929 : SAR EDX,0x7
0042992c : MOV EAX,EDX
0042992e : SHR EAX,0x1f
00429931 : ADD EAX,EDX
00429933 : MOV dword ptr [EBP + 0xfffffee8],EAX
00429939 : MOV dword ptr [EBP + 0xfffffee4],EDI
0042993f : MOV dword ptr [EBP + -0x4],EDI
00429942 : MOV ECX,dword ptr [EBP + 0xfffffeec]
00429948 : PUSH ECX
00429949 : MOV EDI,EAX
0042994b : IMUL EDI,EDI,0xf0
00429951 : ADD EDI,ESI
00429953 : MOV ESI,0x1
00429958 : CALL 0x00429710
0042995d : MOV dword ptr [EBP + 0xfffffee4],ESI
00429963 : MOV EDX,dword ptr [EBP + 0xc]
00429966 : PUSH EDX
00429967 : MOV EAX,dword ptr [EBX + 0x4]
0042996a : PUSH EAX
0042996b : MOV EDI,dword ptr [EBP + 0xfffffee0]
00429971 : MOV EDX,EDI
00429973 : CALL 0x0042a130
00429978 : MOV dword ptr [EBP + 0xfffffee4],0x2
00429982 : MOV EDX,dword ptr [EBP + 0xfffffee8]
00429988 : INC EDX
00429989 : IMUL EDX,EDX,0xf0
0042998f : ADD EDX,EDI
00429991 : MOV ECX,dword ptr [EBX + 0x8]
00429994 : PUSH ECX
00429995 : MOV EAX,dword ptr [EBP + 0xc]
00429998 : PUSH EAX
00429999 : CALL 0x0042a130
0042999e : MOV dword ptr [EBP + -0x4],0xffffffff
004299a5 : MOV ECX,dword ptr [EBX + 0x8]
004299a8 : MOV ESI,dword ptr [EBX + 0x4]
004299ab : SUB ECX,ESI
004299ad : MOV EAX,0x88888889
004299b2 : IMUL ECX
004299b4 : ADD EDX,ECX
004299b6 : SAR EDX,0x7
004299b9 : MOV ECX,EDX
004299bb : SHR ECX,0x1f
004299be : LEA EDX,[EDX + ECX*0x1 + 0x1]
004299c2 : MOV dword ptr [EBP + 0xfffffeec],EDX
004299c8 : TEST ESI,ESI
004299ca : JZ 0x004299ea
004299cc : MOV EDI,dword ptr [EBX + 0x8]
004299cf : MOV EAX,ESI
004299d1 : CALL 0x004296a0
004299d6 : MOV ECX,dword ptr [EBX + 0x4]
004299d9 : CALL 0x006f04e0
004299ea : MOV EAX,dword ptr [EBP + 0xfffffef0]
004299f0 : IMUL EAX,EAX,0xf0
004299f6 : ADD EAX,EDI
004299f8 : MOV dword ptr [EBX + 0xc],EAX
004299fb : IMUL EDX,EDX,0xf0
00429a01 : ADD EDX,EDI
00429a03 : MOV dword ptr [EBX + 0x8],EDX
00429a06 : MOV dword ptr [EBX + 0x4],EDI
00429a09 : JMP 0x00429bc1
00429a67 : SUB ECX,dword ptr [EBP + 0xc]
00429a6a : MOV EAX,0x88888889
00429a6f : IMUL ECX
00429a71 : ADD EDX,ECX
00429a73 : SAR EDX,0x7
00429a76 : MOV EAX,EDX
00429a78 : SHR EAX,0x1f
00429a7b : ADD EAX,EDX
00429a7d : MOV EDI,dword ptr [EBP + 0xfffffeec]
00429a83 : CMP EAX,0x1
00429a86 : JNC 0x00429b45
00429a8c : LEA ECX,[EBP + 0xfffffef4]
00429a92 : PUSH ECX
00429a93 : CALL 0x00429f20
00429a98 : MOV dword ptr [EBP + -0x4],0x2
00429a9f : MOV EAX,dword ptr [EBP + 0xc]
00429aa2 : LEA EDX,[EAX + 0xf0]
00429aa8 : MOV ECX,dword ptr [EBX + 0x8]
00429aab : PUSH ECX
00429aac : PUSH EAX
00429aad : CALL 0x0042a130
00429ab2 : MOV byte ptr [EBP + -0x4],0x3
00429ab6 : MOV EDI,dword ptr [EBX + 0x8]
00429ab9 : LEA EDX,[EBP + 0xfffffef4]
00429abf : PUSH EDX
00429ac0 : MOV ECX,EDI
00429ac2 : SUB ECX,dword ptr [EBP + 0xc]
00429ac5 : MOV EAX,0x88888889
00429aca : IMUL ECX
00429acc : ADD EDX,ECX
00429ace : SAR EDX,0x7
00429ad1 : MOV EAX,EDX
00429ad3 : SHR EAX,0x1f
00429ad6 : ADD EAX,EDX
00429ad8 : MOV ESI,0x1
00429add : SUB ESI,EAX
00429adf : CALL 0x00429710
00429ae4 : MOV dword ptr [EBP + -0x4],0x2
00429aeb : ADD dword ptr [EBX + 0x8],0xf0
00429af2 : MOV EBX,dword ptr [EBX + 0x8]
00429af5 : ADD EBX,0xffffff10
00429afb : PUSH EBX
00429afc : LEA EAX,[EBP + 0xfffffef4]
00429b02 : MOV ECX,dword ptr [EBP + 0xc]
00429b05 : CALL 0x0042a160
00429b0a : ADD ESP,0x4
00429b0d : MOV dword ptr [EBP + -0x4],0xffffffff
00429b14 : LEA ECX,[EBP + 0xfffffef4]
00429b1a : PUSH ECX
00429b1b : JMP 0x00429bbc
00429b45 : LEA EAX,[EBP + 0xfffffef4]
00429b4b : PUSH EAX
00429b4c : CALL 0x00429f20
00429b51 : MOV dword ptr [EBP + -0x4],0x5
00429b58 : MOV ESI,dword ptr [EBX + 0x8]
00429b5b : LEA EDI,[ESI + 0xffffff10]
00429b61 : PUSH ESI
00429b62 : PUSH EDI
00429b63 : MOV EDX,ESI
00429b65 : CALL 0x0042a130
00429b6a : MOV dword ptr [EBX + 0x8],EAX
00429b6d : MOV ECX,dword ptr [EBP + 0xc]
00429b70 : MOV dword ptr [EBP + 0xfffffeec],ECX
00429b76 : CMP ECX,EDI
00429b78 : JZ 0x00429b99
00429b7a : MOV EBX,ESI
00429b7c : SUB EBX,EDI
00429b7e : MOV EDI,EDI
00429b80 : SUB EDI,0xf0
00429b86 : LEA ESI,[EBX + EDI*0x1]
00429b89 : CALL 0x0042a3a0
00429b8e : CMP EDI,dword ptr [EBP + 0xfffffeec]
00429b94 : JNZ 0x00429b80
00429b96 : MOV ECX,dword ptr [EBP + 0xc]
00429b99 : LEA EDX,[ECX + 0xf0]
00429b9f : PUSH EDX
00429ba0 : LEA EAX,[EBP + 0xfffffef4]
00429ba6 : CALL 0x0042a160
00429bab : ADD ESP,0x4
00429bae : MOV dword ptr [EBP + -0x4],0xffffffff
00429bb5 : LEA EAX,[EBP + 0xfffffef4]
00429bbb : PUSH EAX
00429bbc : CALL 0x00429340
00429bc1 : MOV ECX,dword ptr [EBP + -0xc]
00429bc4 : MOV dword ptr FS:[0x0],ECX
00429bcb : POP ECX
00429bcc : POP EDI
00429bcd : POP ESI
00429bce : POP EBX
00429bcf : MOV ECX,dword ptr [EBP + -0x18]
00429bd2 : XOR ECX,EBP
00429bd4 : CALL 0x00633e6b
00429bd9 : MOV ESP,EBP
00429bdb : POP EBP
00429bdc : RET 0xc

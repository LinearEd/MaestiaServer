PROGRAM  : Maestia.exe
FUNCTION : FUN_0045bf80
ENTRY    : 0045bf80
BODY     : [[0045bf80, 0045c033]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x0045bfc2) */

undefined4 * FUN_0045bf80(void)

{
  uint uVar1;
  uint uVar2;
  int in_EAX;
  int in_ECX;
  ushort *puVar3;
  ushort *puVar4;
  uint uVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  undefined4 *local_c;
  
  local_c = *(undefined4 **)(in_EAX + 4);
  if (*(char *)((int)local_c[1] + 0x2d) == '\0') {
    uVar1 = *(uint *)(in_ECX + 0x14);
    puVar6 = (undefined4 *)local_c[1];
    do {
      puVar3 = (ushort *)(in_ECX + 4);
      if (7 < *(uint *)(in_ECX + 0x18)) {
        puVar3 = *(ushort **)(in_ECX + 4);
      }
      uVar2 = puVar6[8];
      uVar5 = uVar2;
      if (uVar1 <= uVar2) {
        uVar5 = uVar1;
      }
      if ((uint)puVar6[9] < 8) {
        puVar4 = (ushort *)(puVar6 + 4);
      }
      else {
        puVar4 = (ushort *)puVar6[4];
      }
      for (; uVar5 != 0; uVar5 = uVar5 - 1) {
        if (*puVar4 != *puVar3) {
          uVar5 = (-(uint)(*puVar4 < *puVar3) & 0xfffffffe) + 1;
          if (uVar5 != 0) goto LAB_0045c001;
          break;
        }
        puVar4 = puVar4 + 1;
        puVar3 = puVar3 + 1;
      }
      if (uVar2 < uVar1) {
LAB_0045c005:
        puVar7 = (undefined4 *)puVar6[2];
      }
      else {
        uVar5 = (uint)(uVar2 != uVar1);
LAB_0045c001:
        if ((int)uVar5 < 0) goto LAB_0045c005;
        puVar7 = (undefined4 *)*puVar6;
        local_c = puVar6;
      }
      puVar6 = puVar7;
    } while (*(char *)((int)puVar7 + 0x2d) == '\0');
  }
  return local_c;
}



============================================================
DISASSEMBLY
============================================================
0045bf80 : PUSH EBP
0045bf81 : MOV EBP,ESP
0045bf83 : SUB ESP,0x10
0045bf86 : MOV EAX,dword ptr [EAX + 0x4]
0045bf89 : PUSH EDI
0045bf8a : MOV EDI,dword ptr [EAX + 0x4]
0045bf8d : CMP byte ptr [EDI + 0x2d],0x0
0045bf91 : MOV dword ptr [EBP + -0x8],EAX
0045bf94 : JNZ 0x0045c02f
0045bf9a : MOV EAX,dword ptr [ECX + 0x14]
0045bf9d : MOV EDX,dword ptr [ECX + 0x18]
0045bfa0 : PUSH EBX
0045bfa1 : ADD ECX,0x4
0045bfa4 : PUSH ESI
0045bfa5 : MOV dword ptr [EBP + -0x4],EAX
0045bfa8 : MOV dword ptr [EBP + -0x10],EDX
0045bfab : MOV dword ptr [EBP + -0xc],ECX
0045bfae : JMP 0x0045bfb3
0045bfb0 : MOV ECX,dword ptr [EBP + -0xc]
0045bfb3 : CMP dword ptr [EBP + -0x10],0x8
0045bfb7 : JC 0x0045bfbb
0045bfb9 : MOV ECX,dword ptr [ECX]
0045bfbb : MOV EBX,dword ptr [EDI + 0x20]
0045bfbe : MOV EDX,EBX
0045bfc0 : CMP EDX,EBX
0045bfc2 : CMOVC EBX,EDX
0045bfc5 : MOV ESI,EBX
0045bfc7 : CMP EBX,EAX
0045bfc9 : JC 0x0045bfcd
0045bfcb : MOV ESI,EAX
0045bfcd : CMP dword ptr [EDI + 0x24],0x8
0045bfd1 : JC 0x0045bfd8
0045bfd3 : MOV EDX,dword ptr [EDI + 0x10]
0045bfd6 : JMP 0x0045bfdb
0045bfd8 : LEA EDX,[EDI + 0x10]
0045bfdb : TEST ESI,ESI
0045bfdd : JBE 0x0045bff6
0045bfdf : NOP
0045bfe0 : MOV AX,word ptr [EDX]
0045bfe3 : CMP AX,word ptr [ECX]
0045bfe6 : JNZ 0x0045c00a
0045bfe8 : ADD EDX,0x2
0045bfeb : ADD ECX,0x2
0045bfee : SUB ESI,0x1
0045bff1 : JNZ 0x0045bfe0
0045bff3 : MOV EAX,dword ptr [EBP + -0x4]
0045bff6 : CMP EBX,EAX
0045bff8 : JC 0x0045c005
0045bffa : XOR ECX,ECX
0045bffc : CMP EBX,EAX
0045bffe : SETNZ CL
0045c001 : TEST ECX,ECX
0045c003 : JGE 0x0045c01f
0045c005 : MOV EDI,dword ptr [EDI + 0x8]
0045c008 : JMP 0x0045c024
0045c00a : MOV DX,AX
0045c00d : CMP DX,word ptr [ECX]
0045c010 : SBB ECX,ECX
0045c012 : AND ECX,0xfffffffe
0045c015 : ADD ECX,0x1
0045c018 : JZ 0x0045bff3
0045c01a : MOV EAX,dword ptr [EBP + -0x4]
0045c01d : JMP 0x0045c001
0045c01f : MOV dword ptr [EBP + -0x8],EDI
0045c022 : MOV EDI,dword ptr [EDI]
0045c024 : CMP byte ptr [EDI + 0x2d],0x0
0045c028 : JZ 0x0045bfb0
0045c02a : MOV EAX,dword ptr [EBP + -0x8]
0045c02d : POP ESI
0045c02e : POP EBX
0045c02f : POP EDI
0045c030 : MOV ESP,EBP
0045c032 : POP EBP
0045c033 : RET

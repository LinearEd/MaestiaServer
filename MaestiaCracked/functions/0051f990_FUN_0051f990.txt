PROGRAM  : Maestia.exe
FUNCTION : FUN_0051f990
ENTRY    : 0051f990
BODY     : [[0051f990, 0051fada]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0051f990(undefined4 param_1,undefined4 *param_2,uint param_3)

{
  uint *puVar1;
  uint *puVar2;
  uint *puVar3;
  int *piVar4;
  int *in_ECX;
  uint uVar5;
  uint uVar6;
  int iVar7;
  
  piVar4 = (int *)*in_ECX;
  if (piVar4 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar4 * 5) <= piVar4[1] * 4 + 4U) goto LAB_0051f9ca;
    iVar7 = piVar4[1] * 2 + 2;
  }
  FUN_0051f6f0(param_1,iVar7);
LAB_0051f9ca:
  piVar4 = (int *)*in_ECX;
  param_3 = param_3 & piVar4[1];
  *piVar4 = *piVar4 + 1;
  iVar7 = *in_ECX;
  puVar1 = (uint *)(iVar7 + 8 + param_3 * 0xc);
  if (*puVar1 == 0xfffffffe) {
    *puVar1 = 0xffffffff;
    uVar6 = *(uint *)*param_2;
    puVar1[1] = uVar6;
    piVar4 = (int *)(uVar6 + 8);
    *piVar4 = *piVar4 + 1;
    *(undefined1 *)(puVar1 + 2) = *(undefined1 *)param_2[1];
    return;
  }
  uVar6 = param_3;
  do {
    uVar6 = uVar6 + 1 & *(uint *)(iVar7 + 4);
  } while (*(int *)(iVar7 + 8 + uVar6 * 0xc) != -2);
  puVar2 = (uint *)(iVar7 + 8 + uVar6 * 0xc);
  uVar5 = *(uint *)(puVar1[1] + 0xc) & *(uint *)(iVar7 + 4);
  if (uVar5 != param_3) {
    puVar3 = (uint *)(iVar7 + 8 + uVar5 * 0xc);
    for (uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0xc); uVar5 != param_3;
        uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0xc)) {
      uVar5 = *puVar3;
      puVar3 = (uint *)(iVar7 + 8 + uVar5 * 0xc);
    }
    if (puVar2 != (uint *)0x0) {
      *puVar2 = *puVar1;
      uVar5 = puVar1[1];
      puVar2[1] = uVar5;
      piVar4 = (int *)(uVar5 + 8);
      *piVar4 = *piVar4 + 1;
      *(char *)(puVar2 + 2) = (char)puVar1[2];
    }
    *puVar3 = uVar6;
    uVar6 = *(uint *)*param_2;
    piVar4 = (int *)(uVar6 + 8);
    *piVar4 = *piVar4 + 1;
    piVar4 = (int *)(puVar1[1] + 8);
    *piVar4 = *piVar4 + -1;
    if (*piVar4 == 0) {
      FUN_00525340();
    }
    puVar1[1] = uVar6;
    *(undefined1 *)(puVar1 + 2) = *(undefined1 *)param_2[1];
    *puVar1 = 0xffffffff;
    return;
  }
  if (puVar2 != (uint *)0x0) {
    *puVar2 = *puVar1;
    uVar5 = puVar1[1];
    puVar2[1] = uVar5;
    piVar4 = (int *)(uVar5 + 8);
    *piVar4 = *piVar4 + 1;
    *(char *)(puVar2 + 2) = (char)puVar1[2];
  }
  uVar5 = *(uint *)*param_2;
  piVar4 = (int *)(uVar5 + 8);
  *piVar4 = *piVar4 + 1;
  piVar4 = (int *)(puVar1[1] + 8);
  *piVar4 = *piVar4 + -1;
  if (*piVar4 == 0) {
    FUN_00525340();
  }
  puVar1[1] = uVar5;
  *(undefined1 *)(puVar1 + 2) = *(undefined1 *)param_2[1];
  *puVar1 = uVar6;
  return;
}



============================================================
DISASSEMBLY
============================================================
0051f990 : PUSH EBX
0051f991 : PUSH ESI
0051f992 : MOV ESI,ECX
0051f994 : MOV EAX,dword ptr [ESI]
0051f996 : TEST EAX,EAX
0051f998 : JNZ 0x0051f9a3
0051f99a : MOV EAX,dword ptr [ESP + 0xc]
0051f99e : PUSH 0x8
0051f9a0 : PUSH EAX
0051f9a1 : JMP 0x0051f9c5
0051f9a3 : MOV ECX,dword ptr [EAX + 0x4]
0051f9a6 : LEA EDX,[ECX*0x4 + 0x4]
0051f9ad : MOV ECX,dword ptr [EAX]
0051f9af : LEA ECX,[ECX + ECX*0x4]
0051f9b2 : CMP ECX,EDX
0051f9b4 : JBE 0x0051f9ca
0051f9b6 : MOV EDX,dword ptr [EAX + 0x4]
0051f9b9 : MOV ECX,dword ptr [ESP + 0xc]
0051f9bd : LEA EAX,[EDX + EDX*0x1 + 0x2]
0051f9c1 : PUSH EAX
0051f9c2 : PUSH ECX
0051f9c3 : MOV ECX,ESI
0051f9c5 : CALL 0x0051f6f0
0051f9ca : MOV ECX,dword ptr [ESI]
0051f9cc : MOV EAX,dword ptr [ESP + 0x14]
0051f9d0 : AND EAX,dword ptr [ECX + 0x4]
0051f9d3 : INC dword ptr [ECX]
0051f9d5 : MOV ECX,dword ptr [ESI]
0051f9d7 : LEA EDX,[EAX + EAX*0x2]
0051f9da : LEA ESI,[ECX + EDX*0x4 + 0x8]
0051f9de : MOV EDX,dword ptr [ESI]
0051f9e0 : MOV EBX,0xfffffffe
0051f9e5 : CMP EDX,EBX
0051f9e7 : JNZ 0x0051fa0a
0051f9e9 : MOV ECX,dword ptr [ESP + 0x10]
0051f9ed : MOV dword ptr [ESI],0xffffffff
0051f9f3 : MOV EAX,dword ptr [ECX]
0051f9f5 : MOV EAX,dword ptr [EAX]
0051f9f7 : MOV dword ptr [ESI + 0x4],EAX
0051f9fa : INC dword ptr [EAX + 0x8]
0051f9fd : MOV ECX,dword ptr [ECX + 0x4]
0051fa00 : MOV DL,byte ptr [ECX]
0051fa02 : MOV byte ptr [ESI + 0x8],DL
0051fa05 : POP ESI
0051fa06 : POP EBX
0051fa07 : RET 0xc
0051fa0a : PUSH EBP
0051fa0b : MOV EBP,dword ptr [ECX + 0x4]
0051fa0e : PUSH EDI
0051fa0f : MOV EDI,EAX
0051fa11 : INC EDI
0051fa12 : AND EDI,EBP
0051fa14 : LEA EDX,[EDI + EDI*0x2]
0051fa17 : CMP dword ptr [ECX + EDX*0x4 + 0x8],EBX
0051fa1b : JNZ 0x0051fa11
0051fa1d : LEA EDX,[EDI + EDI*0x2]
0051fa20 : LEA EBX,[ECX + EDX*0x4 + 0x8]
0051fa24 : MOV EDX,dword ptr [ESI + 0x4]
0051fa27 : MOV EDX,dword ptr [EDX + 0xc]
0051fa2a : AND EDX,EBP
0051fa2c : CMP EDX,EAX
0051fa2e : JNZ 0x0051fa75
0051fa30 : TEST EBX,EBX
0051fa32 : JZ 0x0051fa47
0051fa34 : MOV EAX,dword ptr [ESI]
0051fa36 : MOV dword ptr [EBX],EAX
0051fa38 : MOV EAX,dword ptr [ESI + 0x4]
0051fa3b : MOV dword ptr [EBX + 0x4],EAX
0051fa3e : INC dword ptr [EAX + 0x8]
0051fa41 : MOV AL,byte ptr [ESI + 0x8]
0051fa44 : MOV byte ptr [EBX + 0x8],AL
0051fa47 : MOV EBP,dword ptr [ESP + 0x18]
0051fa4b : MOV ECX,dword ptr [EBP]
0051fa4e : MOV EBX,dword ptr [ECX]
0051fa50 : INC dword ptr [EBX + 0x8]
0051fa53 : MOV ECX,dword ptr [ESI + 0x4]
0051fa56 : ADD dword ptr [ECX + 0x8],-0x1
0051fa5a : JNZ 0x0051fa61
0051fa5c : CALL 0x00525340
0051fa61 : MOV dword ptr [ESI + 0x4],EBX
0051fa64 : MOV EDX,dword ptr [EBP + 0x4]
0051fa67 : MOV AL,byte ptr [EDX]
0051fa69 : MOV byte ptr [ESI + 0x8],AL
0051fa6c : MOV dword ptr [ESI],EDI
0051fa6e : POP EDI
0051fa6f : POP EBP
0051fa70 : POP ESI
0051fa71 : POP EBX
0051fa72 : RET 0xc
0051fa75 : LEA EDX,[EDX + EDX*0x2]
0051fa78 : CMP dword ptr [ECX + EDX*0x4 + 0x8],EAX
0051fa7c : LEA EDX,[ECX + EDX*0x4 + 0x8]
0051fa80 : JZ 0x0051fa91
0051fa82 : MOV EDX,dword ptr [EDX]
0051fa84 : LEA EDX,[EDX + EDX*0x2]
0051fa87 : CMP dword ptr [ECX + EDX*0x4 + 0x8],EAX
0051fa8b : LEA EDX,[ECX + EDX*0x4 + 0x8]
0051fa8f : JNZ 0x0051fa82
0051fa91 : TEST EBX,EBX
0051fa93 : JZ 0x0051faa8
0051fa95 : MOV EAX,dword ptr [ESI]
0051fa97 : MOV dword ptr [EBX],EAX
0051fa99 : MOV EAX,dword ptr [ESI + 0x4]
0051fa9c : MOV dword ptr [EBX + 0x4],EAX
0051fa9f : INC dword ptr [EAX + 0x8]
0051faa2 : MOV AL,byte ptr [ESI + 0x8]
0051faa5 : MOV byte ptr [EBX + 0x8],AL
0051faa8 : MOV EBX,dword ptr [ESP + 0x18]
0051faac : MOV dword ptr [EDX],EDI
0051faae : MOV ECX,dword ptr [EBX]
0051fab0 : MOV EDI,dword ptr [ECX]
0051fab2 : INC dword ptr [EDI + 0x8]
0051fab5 : MOV ECX,dword ptr [ESI + 0x4]
0051fab8 : ADD dword ptr [ECX + 0x8],-0x1
0051fabc : JNZ 0x0051fac3
0051fabe : CALL 0x00525340
0051fac3 : MOV dword ptr [ESI + 0x4],EDI
0051fac6 : MOV EDX,dword ptr [EBX + 0x4]
0051fac9 : MOV AL,byte ptr [EDX]
0051facb : POP EDI
0051facc : MOV byte ptr [ESI + 0x8],AL
0051facf : POP EBP
0051fad0 : MOV dword ptr [ESI],0xffffffff
0051fad6 : POP ESI
0051fad7 : POP EBX
0051fad8 : RET 0xc

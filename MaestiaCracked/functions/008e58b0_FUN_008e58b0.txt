PROGRAM  : Maestia.exe
FUNCTION : FUN_008e58b0
ENTRY    : 008e58b0
BODY     : [[008e58b0, 008e5adf]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x008e5aae) */

void FUN_008e58b0(void)

{
  int iVar1;
  int *piVar2;
  int *in_ECX;
  uint local_58;
  undefined1 local_30 [4];
  undefined4 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4a279;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  FUN_00992f20();
  piVar2 = (int *)(**(code **)(*in_ECX + 0x74))();
  if (piVar2 != (int *)0x0) {
    local_8 = 0;
    (**(code **)(*in_ECX + 0x60))();
    (**(code **)(*piVar2 + 0xb0))();
    local_18 = 7;
    local_1c = 0;
    local_2c = (uint)local_2c._2_2_ << 0x10;
    local_8._0_1_ = 1;
    (**(code **)(*in_ECX + 0x58))();
    FUN_00405eb0(local_30,0,0xffffffff);
    local_8._0_1_ = 1;
    FUN_008f75f0();
    local_8._0_1_ = 3;
    FUN_00405eb0();
    local_8 = CONCAT31(local_8._1_3_,1);
    if (7 < local_58) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    iVar1 = **(int **)(*DAT_00da9894 + 0x114);
    (**(code **)(*piVar2 + 0x40))();
    (**(code **)(iVar1 + 4))();
    FUN_00a08b70();
    iVar1 = *DAT_00da9894;
    if ((iVar1 != 0) && (*(int *)(iVar1 + 0x114) != 0)) {
      (**(code **)(**(int **)(iVar1 + 0x114) + 4))();
    }
    local_8 = local_8 & 0xffffff00;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c = local_2c & 0xffff0000;
    local_8 = 0xffffffff;
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008e58b0 : PUSH EBP
008e58b1 : MOV EBP,ESP
008e58b3 : PUSH -0x1
008e58b5 : PUSH 0xb4a279
008e58ba : MOV EAX,FS:[0x0]
008e58c0 : PUSH EAX
008e58c1 : SUB ESP,0x60
008e58c4 : MOV EAX,[0x00d66fa0]
008e58c9 : XOR EAX,EBP
008e58cb : MOV dword ptr [EBP + -0x10],EAX
008e58ce : PUSH EBX
008e58cf : PUSH ESI
008e58d0 : PUSH EDI
008e58d1 : PUSH EAX
008e58d2 : LEA EAX,[EBP + -0xc]
008e58d5 : MOV FS:[0x0],EAX
008e58db : MOV EAX,dword ptr [EBP + 0x10]
008e58de : MOV ESI,dword ptr [EBP + 0xc]
008e58e1 : MOV EBX,dword ptr [EBP + 0x8]
008e58e4 : PUSH EAX
008e58e5 : PUSH ESI
008e58e6 : PUSH EBX
008e58e7 : MOV EDI,ECX
008e58e9 : CALL 0x00992f20
008e58ee : MOV EDX,dword ptr [EDI]
008e58f0 : MOV EAX,dword ptr [EDX + 0x74]
008e58f3 : PUSH ESI
008e58f4 : PUSH EBX
008e58f5 : MOV ECX,EDI
008e58f7 : CALL EAX
008e58f9 : MOV ESI,EAX
008e58fb : XOR EAX,EAX
008e58fd : CMP ESI,EAX
008e58ff : JZ 0x008e5ac2
008e5905 : XOR ECX,ECX
008e5907 : MOV dword ptr [EBP + -0x30],0x7
008e590e : MOV dword ptr [EBP + -0x34],EAX
008e5911 : MOV word ptr [EBP + -0x44],CX
008e5915 : MOV dword ptr [EBP + -0x4],EAX
008e5918 : MOV EDX,dword ptr [EDI]
008e591a : MOV EDX,dword ptr [EDX + 0x60]
008e591d : LEA EAX,[EBP + -0x48]
008e5920 : PUSH EAX
008e5921 : PUSH ESI
008e5922 : MOV ECX,EDI
008e5924 : CALL EDX
008e5926 : MOV EAX,dword ptr [ESI + 0x24]
008e5929 : TEST EAX,EAX
008e592b : JZ 0x008e5935
008e592d : MOV AL,byte ptr [EAX + 0xb1]
008e5933 : JMP 0x008e5937
008e5935 : XOR AL,AL
008e5937 : MOV ECX,dword ptr [EBP + 0xc]
008e593a : MOV EDX,dword ptr [ESI]
008e593c : MOV EDX,dword ptr [EDX + 0xb0]
008e5942 : PUSH EAX
008e5943 : LEA EAX,[EBP + -0x48]
008e5946 : PUSH EAX
008e5947 : PUSH ECX
008e5948 : PUSH EBX
008e5949 : PUSH EDI
008e594a : MOV ECX,ESI
008e594c : CALL EDX
008e594e : MOV EAX,dword ptr [ESI + 0x10]
008e5951 : XOR ECX,ECX
008e5953 : MOV dword ptr [EBP + -0x14],0x7
008e595a : MOV dword ptr [EBP + -0x18],0x0
008e5961 : MOV word ptr [EBP + -0x28],CX
008e5965 : MOV byte ptr [EBP + -0x4],0x1
008e5969 : MOV EDX,dword ptr [EDI]
008e596b : MOV EDX,dword ptr [EDX + 0x58]
008e596e : LEA ECX,[EBP + -0x2c]
008e5971 : PUSH ECX
008e5972 : PUSH EAX
008e5973 : MOV ECX,EDI
008e5975 : CALL EDX
008e5977 : SUB ESP,0x1c
008e597a : MOV ECX,ESP
008e597c : MOV dword ptr [EBP + -0x50],ESP
008e597f : PUSH -0x1
008e5981 : XOR EDI,EDI
008e5983 : PUSH EDI
008e5984 : LEA EDX,[EBP + -0x2c]
008e5987 : XOR EAX,EAX
008e5989 : MOV dword ptr [ECX + 0x18],0x7
008e5990 : MOV dword ptr [ECX + 0x14],EDI
008e5993 : PUSH EDX
008e5994 : MOV word ptr [ECX + 0x4],AX
008e5998 : CALL 0x00405eb0
008e599d : MOV byte ptr [EBP + -0x4],0x2
008e59a1 : MOV byte ptr [EBP + -0x4],0x1
008e59a5 : LEA ECX,[EBP + -0x6c]
008e59a8 : CALL 0x008f75f0
008e59ad : ADD ESP,0x1c
008e59b0 : MOV byte ptr [EBP + -0x4],0x3
008e59b4 : PUSH -0x1
008e59b6 : PUSH EDI
008e59b7 : PUSH EAX
008e59b8 : LEA ECX,[EBP + -0x2c]
008e59bb : CALL 0x00405eb0
008e59c0 : MOV byte ptr [EBP + -0x4],0x1
008e59c4 : CMP dword ptr [EBP + -0x54],0x8
008e59c8 : JC 0x008e59d2
008e59ca : MOV ECX,dword ptr [EBP + -0x68]
008e59cd : CALL 0x006f04e0
008e59d2 : MOV ECX,dword ptr [0x00da9894]
008e59d8 : XOR EAX,EAX
008e59da : MOV word ptr [EBP + -0x68],AX
008e59de : MOV dword ptr [EBP + -0x58],EDI
008e59e1 : MOV dword ptr [EBP + -0x54],0x7
008e59e8 : MOV EAX,dword ptr [ECX]
008e59ea : MOV EDI,dword ptr [EAX + 0x114]
008e59f0 : MOV EAX,dword ptr [ESI + 0x120]
008e59f6 : SHR EAX,0x2
008e59f9 : AND EAX,0x1
008e59fc : CMP dword ptr [EBP + -0x14],0x8
008e5a00 : JC 0x008e5a0a
008e5a02 : MOV EDX,dword ptr [EBP + -0x28]
008e5a05 : MOV dword ptr [EBP + -0x4c],EDX
008e5a08 : JMP 0x008e5a10
008e5a0a : LEA ECX,[EBP + -0x28]
008e5a0d : MOV dword ptr [EBP + -0x4c],ECX
008e5a10 : MOV EDX,dword ptr [EDI]
008e5a12 : PUSH EAX
008e5a13 : MOV EAX,dword ptr [ESI]
008e5a15 : MOV dword ptr [EBP + -0x50],EDX
008e5a18 : MOV EDX,dword ptr [EAX + 0x40]
008e5a1b : MOV ECX,ESI
008e5a1d : MOVZX EBX,BX
008e5a20 : CALL EDX
008e5a22 : MOV ECX,dword ptr [EBP + -0x4c]
008e5a25 : MOV EDX,dword ptr [EBP + -0x50]
008e5a28 : MOVZX EAX,AX
008e5a2b : PUSH EAX
008e5a2c : MOV EAX,dword ptr [EDX + 0x4]
008e5a2f : PUSH EBX
008e5a30 : PUSH ECX
008e5a31 : PUSH 0xc5a03c
008e5a36 : PUSH 0xc5a04c
008e5a3b : PUSH EDI
008e5a3c : CALL EAX
008e5a3e : ADD ESP,0x1c
008e5a41 : MOV ECX,ESI
008e5a43 : CALL 0x00a08b70
008e5a48 : MOV ECX,dword ptr [0x00da9894]
008e5a4e : MOV ECX,dword ptr [ECX]
008e5a50 : XOR EDI,EDI
008e5a52 : CMP ECX,EDI
008e5a54 : JZ 0x008e5a7b
008e5a56 : CMP dword ptr [ECX + 0x114],EDI
008e5a5c : JZ 0x008e5a7b
008e5a5e : MOV ECX,dword ptr [ECX + 0x114]
008e5a64 : MOV EDX,dword ptr [ECX]
008e5a66 : PUSH EAX
008e5a67 : MOV EAX,dword ptr [EDX + 0x4]
008e5a6a : PUSH EBX
008e5a6b : PUSH 0xc5a060
008e5a70 : PUSH 0xc5a068
008e5a75 : PUSH ECX
008e5a76 : CALL EAX
008e5a78 : ADD ESP,0x14
008e5a7b : MOV byte ptr [EBP + -0x4],0x0
008e5a7f : MOV EBX,0x8
008e5a84 : CMP dword ptr [EBP + -0x14],EBX
008e5a87 : JC 0x008e5a91
008e5a89 : MOV ECX,dword ptr [EBP + -0x28]
008e5a8c : CALL 0x006f04e0
008e5a91 : MOV ESI,0x7
008e5a96 : XOR ECX,ECX
008e5a98 : MOV dword ptr [EBP + -0x14],ESI
008e5a9b : MOV dword ptr [EBP + -0x18],EDI
008e5a9e : MOV word ptr [EBP + -0x28],CX
008e5aa2 : MOV dword ptr [EBP + -0x4],0xffffffff
008e5aa9 : CMP dword ptr [EBP + -0x30],EBX
008e5aac : JC 0x008e5ab6
008e5aae : MOV ECX,dword ptr [EBP + -0x44]
008e5ab1 : CALL 0x006f04e0
008e5ab6 : XOR EDX,EDX
008e5ab8 : MOV dword ptr [EBP + -0x30],ESI
008e5abb : MOV dword ptr [EBP + -0x34],EDI
008e5abe : MOV word ptr [EBP + -0x44],DX
008e5ac2 : MOV ECX,dword ptr [EBP + -0xc]
008e5ac5 : MOV dword ptr FS:[0x0],ECX
008e5acc : POP ECX
008e5acd : POP EDI
008e5ace : POP ESI
008e5acf : POP EBX
008e5ad0 : MOV ECX,dword ptr [EBP + -0x10]
008e5ad3 : XOR ECX,EBP
008e5ad5 : CALL 0x00633e6b
008e5ada : MOV ESP,EBP
008e5adc : POP EBP
008e5add : RET 0xc

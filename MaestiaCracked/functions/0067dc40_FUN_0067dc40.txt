PROGRAM  : Maestia.exe
FUNCTION : FUN_0067dc40
ENTRY    : 0067dc40
BODY     : [[0067dc40, 0067df49]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_0067dc40(char *param_1,char *param_2)

{
  int iVar1;
  uint uVar2;
  LONG LVar3;
  int *in_ECX;
  int *piVar4;
  uint uVar5;
  uint uVar6;
  undefined **ppuVar7;
  uint uVar8;
  undefined4 uStack_c;
  uint local_8;
  int local_4;
  
  FUN_0051b6e0();
  uVar5 = 0;
  uStack_c = uStack_c & 0xffffff;
  local_4 = 0x2000000;
  if (in_ECX[0x2a] != 0) {
    ppuVar7 = &PTR_s_Chinese__Traditional____Phonetic_00d68888;
    do {
      if (((param_1 != (char *)0x0) && (iVar1 = __stricmp(param_1,*ppuVar7), iVar1 == 0)) &&
         ((&DAT_00d7c380)[uVar5] == 0)) {
        FUN_0051bb20((&PTR_s_Chinese__Traditional____Phonetic_00d68888)[uVar5 * 4]);
        (&DAT_00d7c380)[uVar5] = 1;
        goto LAB_0067dd5d;
      }
      uVar5 = uVar5 + 1;
      ppuVar7 = ppuVar7 + 4;
    } while (uVar5 < (uint)in_ECX[0x2a]);
  }
  uVar5 = 0;
  if (in_ECX[0x2a] != 0) {
    ppuVar7 = &PTR_s_Chinese__Traditional____Phonetic_00d68888;
    do {
      if ((param_2 != (char *)0x0) && (iVar1 = __stricmp(param_2,*ppuVar7), iVar1 == 0)) {
        FUN_0051bb20((&PTR_s_Phonetic_00d6888c)[uVar5 * 4]);
        local_4 = (&DAT_00d68890)[uVar5 * 4];
        (&DAT_00d7c380)[uVar5] = 2;
        uStack_c = CONCAT13(1,(undefined3)uStack_c);
        break;
      }
      uVar5 = uVar5 + 1;
      ppuVar7 = ppuVar7 + 4;
    } while (uVar5 < (uint)in_ECX[0x2a]);
  }
  uVar2 = 0;
  if (in_ECX[0x2a] != 0) {
    piVar4 = &DAT_00d68890;
    do {
      if (((&DAT_00d7c380)[uVar2] == 1) && (*piVar4 == local_4)) goto LAB_0067df1f;
      uVar2 = uVar2 + 1;
      piVar4 = piVar4 + 4;
    } while (uVar2 < (uint)in_ECX[0x2a]);
  }
  if (uStack_c._3_1_ != '\x01') {
LAB_0067df1f:
    LVar3 = InterlockedExchangeAdd((LONG *)((local_8 & 0xfffffffc) + 4),-1);
    if (LVar3 == 1) {
      FUN_00515cf0(local_8 & 0xfffffffc);
    }
    return 0xffffffff;
  }
LAB_0067dd5d:
  uVar2 = (**(code **)(*in_ECX + 0xc))((&DAT_00d68890)[uVar5 * 4]);
  if ((uVar2 & 0xf00) != 0) {
    piVar4 = in_ECX + 2;
    uVar6 = in_ECX[3] + 1;
    if (uVar6 < (uint)in_ECX[3]) {
      FUN_0067ad00(*piVar4 + uVar6 * 4,in_ECX[3] - uVar6);
      uVar8 = uVar6;
      if (uVar6 < (uint)in_ECX[4] >> 1) {
LAB_0067ddb6:
        FUN_0057c3a0(piVar4,uVar8);
      }
    }
    else if ((uint)in_ECX[4] <= uVar6) {
      uVar8 = (uVar6 >> 2) + uVar6;
      goto LAB_0067ddb6;
    }
    in_ECX[3] = uVar6;
    if (*piVar4 + -4 + uVar6 * 4 != 0) {
      FUN_0051c600(&uStack_c);
    }
  }
  if ((uVar2 & 0xf000) != 0) {
    piVar4 = in_ECX + 5;
    uVar6 = in_ECX[6] + 1;
    if (uVar6 < (uint)in_ECX[6]) {
      FUN_0067ad00(*piVar4 + uVar6 * 4,in_ECX[6] - uVar6);
      uVar8 = uVar6;
      if (uVar6 < (uint)in_ECX[7] >> 1) {
LAB_0067de17:
        FUN_0057c3a0(piVar4,uVar8);
      }
    }
    else if ((uint)in_ECX[7] <= uVar6) {
      uVar8 = (uVar6 >> 2) + uVar6;
      goto LAB_0067de17;
    }
    in_ECX[6] = uVar6;
    if (*piVar4 + -4 + uVar6 * 4 != 0) {
      FUN_0051c600(&uStack_c);
    }
  }
  if ((uVar2 & 0xf0000) != 0) {
    piVar4 = in_ECX + 8;
    uVar6 = in_ECX[9] + 1;
    if (uVar6 < (uint)in_ECX[9]) {
      FUN_0067ad00(*piVar4 + uVar6 * 4,in_ECX[9] - uVar6);
      uVar8 = uVar6;
      if (uVar6 < (uint)in_ECX[10] >> 1) {
LAB_0067de78:
        FUN_0057c3a0(piVar4,uVar8);
      }
    }
    else if ((uint)in_ECX[10] <= uVar6) {
      uVar8 = (uVar6 >> 2) + uVar6;
      goto LAB_0067de78;
    }
    in_ECX[9] = uVar6;
    if (*piVar4 + -4 + uVar6 * 4 != 0) {
      FUN_0051c600(&uStack_c);
    }
  }
  if ((uVar2 & 0xf) == 0) goto LAB_0067def5;
  piVar4 = in_ECX + 0xb;
  uVar2 = in_ECX[0xc] + 1;
  if (uVar2 < (uint)in_ECX[0xc]) {
    FUN_0067ad00(*piVar4 + uVar2 * 4,in_ECX[0xc] - uVar2);
    uVar6 = uVar2;
    if (uVar2 < (uint)in_ECX[0xd] >> 1) {
LAB_0067ded6:
      FUN_0057c3a0(piVar4,uVar6);
    }
  }
  else if ((uint)in_ECX[0xd] <= uVar2) {
    uVar6 = (uVar2 >> 2) + uVar2;
    goto LAB_0067ded6;
  }
  in_ECX[0xc] = uVar2;
  if (*piVar4 + -4 + uVar2 * 4 != 0) {
    FUN_0051c600(&uStack_c);
  }
LAB_0067def5:
  uVar2 = uStack_c & 0xfffffffc;
  LVar3 = InterlockedExchangeAdd((LONG *)(uVar2 + 4),-1);
  if (LVar3 == 1) {
    FUN_00515cf0(uVar2);
  }
  return uVar5;
}



============================================================
DISASSEMBLY
============================================================
0067dc40 : SUB ESP,0xc
0067dc43 : PUSH EBX
0067dc44 : PUSH EBP
0067dc45 : PUSH ESI
0067dc46 : MOV EBP,ECX
0067dc48 : PUSH EDI
0067dc49 : LEA ECX,[ESP + 0x14]
0067dc4d : CALL 0x0051b6e0
0067dc52 : XOR EBX,EBX
0067dc54 : MOV byte ptr [ESP + 0x13],0x0
0067dc59 : MOV dword ptr [ESP + 0x18],0x2000000
0067dc61 : CMP dword ptr [EBP + 0xa8],EBX
0067dc67 : JBE 0x0067dc9b
0067dc69 : MOV ESI,dword ptr [ESP + 0x20]
0067dc6d : MOV EDI,0xd68888
0067dc72 : TEST ESI,ESI
0067dc74 : JZ 0x0067dc8f
0067dc76 : MOV EAX,dword ptr [EDI]
0067dc78 : PUSH EAX
0067dc79 : PUSH ESI
0067dc7a : CALL 0x0051c970
0067dc7f : ADD ESP,0x8
0067dc82 : TEST EAX,EAX
0067dc84 : JNZ 0x0067dc8f
0067dc86 : CMP dword ptr [EBX*0x4 + 0xd7c380],EAX
0067dc8d : JZ 0x0067dcd2
0067dc8f : INC EBX
0067dc90 : ADD EDI,0x10
0067dc93 : CMP EBX,dword ptr [EBP + 0xa8]
0067dc99 : JC 0x0067dc72
0067dc9b : XOR EBX,EBX
0067dc9d : CMP dword ptr [EBP + 0xa8],EBX
0067dca3 : JBE 0x0067dd23
0067dca5 : MOV ESI,dword ptr [ESP + 0x24]
0067dca9 : MOV EDI,0xd68888
0067dcae : MOV EDI,EDI
0067dcb0 : TEST ESI,ESI
0067dcb2 : JZ 0x0067dcc4
0067dcb4 : MOV EAX,dword ptr [EDI]
0067dcb6 : PUSH EAX
0067dcb7 : PUSH ESI
0067dcb8 : CALL 0x0051c970
0067dcbd : ADD ESP,0x8
0067dcc0 : TEST EAX,EAX
0067dcc2 : JZ 0x0067dcf4
0067dcc4 : INC EBX
0067dcc5 : ADD EDI,0x10
0067dcc8 : CMP EBX,dword ptr [EBP + 0xa8]
0067dcce : JC 0x0067dcb0
0067dcd0 : JMP 0x0067dd23
0067dcd2 : MOV ECX,EBX
0067dcd4 : SHL ECX,0x4
0067dcd7 : MOV EDX,dword ptr [ECX + 0xd68888]
0067dcdd : PUSH EDX
0067dcde : LEA ECX,[ESP + 0x18]
0067dce2 : CALL 0x0051bb20
0067dce7 : MOV dword ptr [EBX*0x4 + 0xd7c380],0x1
0067dcf2 : JMP 0x0067dd5d
0067dcf4 : MOV ESI,EBX
0067dcf6 : SHL ESI,0x4
0067dcf9 : MOV ECX,dword ptr [ESI + 0xd6888c]
0067dcff : PUSH ECX
0067dd00 : LEA ECX,[ESP + 0x18]
0067dd04 : CALL 0x0051bb20
0067dd09 : MOV EDX,dword ptr [ESI + 0xd68890]
0067dd0f : MOV dword ptr [EBX*0x4 + 0xd7c380],0x2
0067dd1a : MOV byte ptr [ESP + 0x13],0x1
0067dd1f : MOV dword ptr [ESP + 0x18],EDX
0067dd23 : MOV ECX,dword ptr [EBP + 0xa8]
0067dd29 : XOR EAX,EAX
0067dd2b : TEST ECX,ECX
0067dd2d : JBE 0x0067dd52
0067dd2f : MOV EDX,0xd68890
0067dd34 : CMP dword ptr [EAX*0x4 + 0xd7c380],0x1
0067dd3c : JNZ 0x0067dd4a
0067dd3e : MOV ESI,dword ptr [ESP + 0x18]
0067dd42 : CMP dword ptr [EDX],ESI
0067dd44 : JZ 0x0067df1f
0067dd4a : INC EAX
0067dd4b : ADD EDX,0x10
0067dd4e : CMP EAX,ECX
0067dd50 : JC 0x0067dd34
0067dd52 : CMP byte ptr [ESP + 0x13],0x1
0067dd57 : JNZ 0x0067df1f
0067dd5d : MOV EAX,dword ptr [EBP]
0067dd60 : MOV EAX,dword ptr [EAX + 0xc]
0067dd63 : MOV ECX,EBX
0067dd65 : SHL ECX,0x4
0067dd68 : MOV EDX,dword ptr [ECX + 0xd68890]
0067dd6e : PUSH EDX
0067dd6f : MOV ECX,EBP
0067dd71 : CALL EAX
0067dd73 : MOV dword ptr [ESP + 0x20],EAX
0067dd77 : TEST EAX,0xf00
0067dd7c : JZ 0x0067ddd5
0067dd7e : MOV ESI,dword ptr [EBP + 0xc]
0067dd81 : MOV EAX,dword ptr [EBP + 0xc]
0067dd84 : LEA EDI,[EBP + 0x8]
0067dd87 : INC ESI
0067dd88 : CMP ESI,EAX
0067dd8a : JNC 0x0067dda9
0067dd8c : MOV ECX,dword ptr [EDI]
0067dd8e : SUB EAX,ESI
0067dd90 : PUSH EAX
0067dd91 : LEA EDX,[ECX + ESI*0x4]
0067dd94 : PUSH EDX
0067dd95 : CALL 0x0067ad00
0067dd9a : MOV EAX,dword ptr [EDI + 0x8]
0067dd9d : SHR EAX,0x1
0067dd9f : ADD ESP,0x8
0067dda2 : CMP ESI,EAX
0067dda4 : JNC 0x0067ddbe
0067dda6 : PUSH ESI
0067dda7 : JMP 0x0067ddb6
0067dda9 : CMP ESI,dword ptr [EDI + 0x8]
0067ddac : JC 0x0067ddbe
0067ddae : MOV ECX,ESI
0067ddb0 : SHR ECX,0x2
0067ddb3 : ADD ECX,ESI
0067ddb5 : PUSH ECX
0067ddb6 : PUSH EDI
0067ddb7 : MOV ECX,EDI
0067ddb9 : CALL 0x0057c3a0
0067ddbe : MOV EDX,dword ptr [EDI]
0067ddc0 : LEA ECX,[EDX + ESI*0x4 + -0x4]
0067ddc4 : MOV dword ptr [EDI + 0x4],ESI
0067ddc7 : TEST ECX,ECX
0067ddc9 : JZ 0x0067ddd5
0067ddcb : LEA EAX,[ESP + 0x14]
0067ddcf : PUSH EAX
0067ddd0 : CALL 0x0051c600
0067ddd5 : TEST dword ptr [ESP + 0x20],0xf000
0067dddd : JZ 0x0067de36
0067dddf : MOV ESI,dword ptr [EBP + 0x18]
0067dde2 : MOV EAX,dword ptr [EBP + 0x18]
0067dde5 : LEA EDI,[EBP + 0x14]
0067dde8 : INC ESI
0067dde9 : CMP ESI,EAX
0067ddeb : JNC 0x0067de0a
0067dded : MOV ECX,dword ptr [EDI]
0067ddef : SUB EAX,ESI
0067ddf1 : PUSH EAX
0067ddf2 : LEA EDX,[ECX + ESI*0x4]
0067ddf5 : PUSH EDX
0067ddf6 : CALL 0x0067ad00
0067ddfb : MOV EAX,dword ptr [EDI + 0x8]
0067ddfe : SHR EAX,0x1
0067de00 : ADD ESP,0x8
0067de03 : CMP ESI,EAX
0067de05 : JNC 0x0067de1f
0067de07 : PUSH ESI
0067de08 : JMP 0x0067de17
0067de0a : CMP ESI,dword ptr [EDI + 0x8]
0067de0d : JC 0x0067de1f
0067de0f : MOV ECX,ESI
0067de11 : SHR ECX,0x2
0067de14 : ADD ECX,ESI
0067de16 : PUSH ECX
0067de17 : PUSH EDI
0067de18 : MOV ECX,EDI
0067de1a : CALL 0x0057c3a0
0067de1f : MOV EDX,dword ptr [EDI]
0067de21 : LEA ECX,[EDX + ESI*0x4 + -0x4]
0067de25 : MOV dword ptr [EDI + 0x4],ESI
0067de28 : TEST ECX,ECX
0067de2a : JZ 0x0067de36
0067de2c : LEA EAX,[ESP + 0x14]
0067de30 : PUSH EAX
0067de31 : CALL 0x0051c600
0067de36 : TEST dword ptr [ESP + 0x20],0xf0000
0067de3e : JZ 0x0067de97
0067de40 : MOV ESI,dword ptr [EBP + 0x24]
0067de43 : MOV EAX,dword ptr [EBP + 0x24]
0067de46 : LEA EDI,[EBP + 0x20]
0067de49 : INC ESI
0067de4a : CMP ESI,EAX
0067de4c : JNC 0x0067de6b
0067de4e : MOV ECX,dword ptr [EDI]
0067de50 : SUB EAX,ESI
0067de52 : PUSH EAX
0067de53 : LEA EDX,[ECX + ESI*0x4]
0067de56 : PUSH EDX
0067de57 : CALL 0x0067ad00
0067de5c : MOV EAX,dword ptr [EDI + 0x8]
0067de5f : SHR EAX,0x1
0067de61 : ADD ESP,0x8
0067de64 : CMP ESI,EAX
0067de66 : JNC 0x0067de80
0067de68 : PUSH ESI
0067de69 : JMP 0x0067de78
0067de6b : CMP ESI,dword ptr [EDI + 0x8]
0067de6e : JC 0x0067de80
0067de70 : MOV ECX,ESI
0067de72 : SHR ECX,0x2
0067de75 : ADD ECX,ESI
0067de77 : PUSH ECX
0067de78 : PUSH EDI
0067de79 : MOV ECX,EDI
0067de7b : CALL 0x0057c3a0
0067de80 : MOV EDX,dword ptr [EDI]
0067de82 : LEA ECX,[EDX + ESI*0x4 + -0x4]
0067de86 : MOV dword ptr [EDI + 0x4],ESI
0067de89 : TEST ECX,ECX
0067de8b : JZ 0x0067de97
0067de8d : LEA EAX,[ESP + 0x14]
0067de91 : PUSH EAX
0067de92 : CALL 0x0051c600
0067de97 : TEST byte ptr [ESP + 0x20],0xf
0067de9c : JZ 0x0067def5
0067de9e : MOV ESI,dword ptr [EBP + 0x30]
0067dea1 : MOV EAX,dword ptr [EBP + 0x30]
0067dea4 : LEA EDI,[EBP + 0x2c]
0067dea7 : INC ESI
0067dea8 : CMP ESI,EAX
0067deaa : JNC 0x0067dec9
0067deac : MOV ECX,dword ptr [EDI]
0067deae : SUB EAX,ESI
0067deb0 : PUSH EAX
0067deb1 : LEA EDX,[ECX + ESI*0x4]
0067deb4 : PUSH EDX
0067deb5 : CALL 0x0067ad00
0067deba : MOV EAX,dword ptr [EDI + 0x8]
0067debd : SHR EAX,0x1
0067debf : ADD ESP,0x8
0067dec2 : CMP ESI,EAX
0067dec4 : JNC 0x0067dede
0067dec6 : PUSH ESI
0067dec7 : JMP 0x0067ded6
0067dec9 : CMP ESI,dword ptr [EDI + 0x8]
0067decc : JC 0x0067dede
0067dece : MOV ECX,ESI
0067ded0 : SHR ECX,0x2
0067ded3 : ADD ECX,ESI
0067ded5 : PUSH ECX
0067ded6 : PUSH EDI
0067ded7 : MOV ECX,EDI
0067ded9 : CALL 0x0057c3a0
0067dede : MOV EDX,dword ptr [EDI]
0067dee0 : LEA ECX,[EDX + ESI*0x4 + -0x4]
0067dee4 : MOV dword ptr [EDI + 0x4],ESI
0067dee7 : TEST ECX,ECX
0067dee9 : JZ 0x0067def5
0067deeb : LEA EAX,[ESP + 0x14]
0067deef : PUSH EAX
0067def0 : CALL 0x0051c600
0067def5 : MOV ESI,dword ptr [ESP + 0x14]
0067def9 : AND ESI,0xfffffffc
0067defc : PUSH -0x1
0067defe : LEA ECX,[ESI + 0x4]
0067df01 : PUSH ECX
0067df02 : CALL dword ptr [0x00b851cc]
0067df08 : SUB EAX,0x1
0067df0b : JNZ 0x0067df13
0067df0d : PUSH ESI
0067df0e : CALL 0x00515cf0
0067df13 : POP EDI
0067df14 : POP ESI
0067df15 : POP EBP
0067df16 : MOV EAX,EBX
0067df18 : POP EBX
0067df19 : ADD ESP,0xc
0067df1c : RET 0x8
0067df1f : MOV ESI,dword ptr [ESP + 0x14]
0067df23 : AND ESI,0xfffffffc
0067df26 : PUSH -0x1
0067df28 : LEA EDX,[ESI + 0x4]
0067df2b : PUSH EDX
0067df2c : CALL dword ptr [0x00b851cc]
0067df32 : SUB EAX,0x1
0067df35 : JNZ 0x0067df3d
0067df37 : PUSH ESI
0067df38 : CALL 0x00515cf0
0067df3d : POP EDI
0067df3e : POP ESI
0067df3f : POP EBP
0067df40 : OR EAX,0xffffffff
0067df43 : POP EBX
0067df44 : ADD ESP,0xc
0067df47 : RET 0x8

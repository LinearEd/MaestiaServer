PROGRAM  : Maestia.exe
FUNCTION : FUN_00ac6380
ENTRY    : 00ac6380
BODY     : [[00ac6380, 00ac69e0] [00ac69e3, 00ac6c55]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00ac6380(int *param_1)

{
  undefined1 uVar1;
  char cVar2;
  uint uVar3;
  int iVar4;
  LPCWSTR ***ppppWVar5;
  undefined4 ****ppppuVar6;
  LPCVOID lpBuffer;
  uint in_stack_00000020;
  DWORD local_13c;
  undefined1 local_138 [4];
  undefined2 local_134;
  undefined1 local_12c [4];
  int local_128;
  int local_124;
  uint local_120;
  int local_11c;
  DWORD local_118;
  HANDLE local_114;
  undefined **local_110;
  undefined1 local_10c;
  undefined4 local_108;
  undefined4 local_104;
  FILE *local_100;
  int *local_fc;
  char local_f5;
  undefined4 local_d8;
  undefined1 local_a0 [4];
  undefined4 ***local_9c [4];
  undefined4 local_8c;
  uint local_88;
  undefined1 local_84 [4];
  undefined2 local_80;
  undefined4 local_70;
  uint local_6c;
  undefined1 local_68 [4];
  LPCWSTR **local_64 [4];
  undefined4 local_54;
  uint local_50;
  undefined1 local_4c [4];
  undefined2 local_48;
  undefined4 local_38;
  uint local_34;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  puStack_c = &LAB_00b41fe3;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_fc = param_1;
  local_8 = 0;
  local_14 = uVar3;
  FUN_008b6db0(DAT_017248c8,local_138);
  local_8._0_1_ = 1;
  FUN_00403510(local_4c,uVar3);
  local_8._0_1_ = 2;
  FUN_00403510(local_84);
  local_8 = CONCAT31(local_8._1_3_,4);
  if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_34 = 7;
  local_38 = 0;
  local_48 = 0;
  local_8 = CONCAT31(local_8._1_3_,5);
  if (7 < local_120) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_120 = 7;
  local_124 = 0;
  local_134 = 0;
  local_10c = 0;
  local_108 = 0;
  local_104 = 0;
  local_110 = &PTR_FUN_00cda538;
  local_100 = (FILE *)0x0;
  local_8._0_1_ = 6;
  local_18 = 7;
  local_1c = 0;
  local_2c = 0;
  FUN_00406360(&PTR_LAB_00c9498c,2);
  local_8._0_1_ = 7;
  local_f5 = FUN_0070a9a0(local_84,local_30);
  local_8._0_1_ = 6;
  if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_18 = 7;
  local_1c = 0;
  local_2c = 0;
  if (local_f5 != '\0') {
    FUN_0070aa30(local_30);
    local_8._0_1_ = 8;
    FUN_00406460(&DAT_00c94994);
    local_8._0_1_ = 9;
    FUN_0070cd60(local_12c,local_30,local_4c,0);
    local_8._0_1_ = 0xb;
    uVar1 = (undefined1)local_8;
    local_8._0_1_ = 0xb;
    if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_48 = 0;
    local_34 = 7;
    local_38 = 0;
    if ((uint)((local_124 - local_128) / 0x1c) < 3) {
      if (local_100 != (FILE *)0x0) {
        _fflush(local_100);
        _fclose(local_100);
        local_100 = (FILE *)0x0;
      }
      FUN_008018d0(L"[AvaGuiBannerDownLoader::IsUpdaterChange] LOCAL_UPDATER_VERSIONFILE_ERROR");
      local_8._0_1_ = 8;
      FUN_004042c0();
      local_8 = CONCAT31(local_8._1_3_,6);
      if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_18 = 7;
      local_1c = 0;
      local_2c = 0;
      local_8._0_1_ = 5;
      local_110 = &PTR_FUN_00cda538;
      if (local_100 != (FILE *)0x0) {
        _fflush(local_100);
        _fclose(local_100);
        local_100 = (FILE *)0x0;
      }
      local_8 = (uint)local_8._1_3_ << 8;
      if (7 < local_6c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_6c = 7;
      local_70 = 0;
      local_80 = 0;
      local_8 = 0xffffffff;
      if (7 < in_stack_00000020) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      goto LAB_00ac6b59;
    }
    if (*(uint *)(local_128 + 0x34) < 8) {
      iVar4 = local_128 + 0x20;
    }
    else {
      iVar4 = *(int *)(local_128 + 0x20);
    }
    local_8._0_1_ = uVar1;
    iVar4 = FUN_00634f4d(iVar4);
    *local_fc = iVar4;
    local_8._0_1_ = 8;
    FUN_004042c0();
    local_8._0_1_ = 6;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  local_8._0_1_ = 6;
  local_18 = 7;
  local_1c = 0;
  local_2c = 0;
  if (local_100 != (FILE *)0x0) {
    _fflush(local_100);
    _fclose(local_100);
    local_100 = (FILE *)0x0;
  }
  FUN_00403510(local_a0);
  local_8._0_1_ = 0xc;
  FUN_008b6db0(DAT_017248c8,local_30);
  local_8._0_1_ = 0xd;
  FUN_00403510(local_4c);
  local_8._0_1_ = 0xe;
  FUN_00403510(local_68);
  local_8 = CONCAT31(local_8._1_3_,0x10);
  if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_34 = 7;
  local_38 = 0;
  local_48 = 0;
  local_8._0_1_ = 0x11;
  if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_18 = 7;
  local_1c = 0;
  local_2c = 0;
  iVar4 = InternetOpenA(&DAT_00bf26a2,1,0,0,0);
  local_fc[0x1f] = iVar4;
  if (iVar4 == 0) {
    local_8 = CONCAT31(local_8._1_3_,0xc);
    if (7 < local_50) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_50 = 7;
    local_54 = 0;
    local_64[0] = (LPCWSTR **)((uint)local_64[0] & 0xffff0000);
    local_8 = CONCAT31(local_8._1_3_,6);
    if (7 < local_88) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_88 = 7;
    local_8c = 0;
    local_9c[0] = (undefined4 ***)((uint)local_9c[0] & 0xffff0000);
    local_8._0_1_ = 5;
    local_110 = &PTR_FUN_00cda538;
    if (local_100 != (FILE *)0x0) {
      _fflush(local_100);
      _fclose(local_100);
      local_100 = (FILE *)0x0;
    }
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_6c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_6c = 7;
    local_70 = 0;
    local_80 = 0;
    local_8 = 0xffffffff;
    if (7 < in_stack_00000020) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    goto LAB_00ac6b59;
  }
  ppppuVar6 = (undefined4 ****)local_9c[0];
  if (local_88 < 8) {
    ppppuVar6 = local_9c;
  }
  iVar4 = InternetOpenUrlW(iVar4,ppppuVar6,0,0,0x84000000,0);
  if (iVar4 == 0) {
    local_8 = CONCAT31(local_8._1_3_,0xc);
    if (7 < local_50) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_50 = 7;
    local_54 = 0;
    local_64[0] = (LPCWSTR **)((uint)local_64[0] & 0xffff0000);
    local_8 = CONCAT31(local_8._1_3_,6);
    if (7 < local_88) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_88 = 7;
    local_8c = 0;
    local_9c[0] = (undefined4 ***)((uint)local_9c[0] & 0xffff0000);
    local_8._0_1_ = 5;
    local_110 = &PTR_FUN_00cda538;
    if (local_100 != (FILE *)0x0) {
      _fflush(local_100);
      _fclose(local_100);
      local_100 = (FILE *)0x0;
    }
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_6c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_6c = 7;
    local_70 = 0;
    local_80 = 0;
    local_8 = 0xffffffff;
    if (7 < in_stack_00000020) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    goto LAB_00ac6b59;
  }
  ppppWVar5 = (LPCWSTR ***)local_64[0];
  if (local_50 < 8) {
    ppppWVar5 = local_64;
  }
  SetFileAttributesW((LPCWSTR)ppppWVar5,0x80);
  ppppWVar5 = (LPCWSTR ***)local_64[0];
  if (local_50 < 8) {
    ppppWVar5 = local_64;
  }
  local_114 = CreateFileW((LPCWSTR)ppppWVar5,0x40000000,0,(LPSECURITY_ATTRIBUTES)0x0,2,0x80,
                          (HANDLE)0x0);
  if (local_114 == (HANDLE)0xffffffff) {
    InternetCloseHandle(local_fc[0x1e]);
  }
  else {
    lpBuffer = (LPCVOID)0x0;
    do {
      InternetQueryDataAvailable(iVar4,&local_11c,0,0);
      if (local_11c != 0) {
        lpBuffer = (LPCVOID)FUN_006f0760(local_11c,".\\Gui\\AvaGuiBannerDownLoader.cpp",0x117,0);
      }
      InternetReadFile(iVar4,lpBuffer,local_11c,&local_118);
      WriteFile(local_114,lpBuffer,local_118,&local_13c,(LPOVERLAPPED)0x0);
      if (lpBuffer != (LPCVOID)0x0) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
    } while (local_118 != 0);
    CloseHandle(local_114);
    InternetCloseHandle(iVar4);
    iVar4 = 0;
    FUN_0070d390();
    local_8._0_1_ = 0x12;
    FUN_00406460(&PTR_LAB_00c94a98);
    local_8._0_1_ = 0x13;
    cVar2 = FUN_0070d850(local_68,local_4c,0,0);
    local_f5 = cVar2 == '\x01';
    local_8._0_1_ = 0x12;
    FUN_00406560();
    if (local_f5 == '\0') {
LAB_00ac6bc3:
      FUN_0070d4c0();
      FUN_008018d0(L"IsUpdaterChange ftp down ver : %d / now save ver  : %d ",iVar4,*local_fc);
      if (*local_fc != iVar4) {
        local_fc[1] = iVar4;
        local_8._0_1_ = 0x11;
        FUN_0070d710();
        local_8._0_1_ = 0xc;
        FUN_00406560();
        local_8._0_1_ = 6;
        FUN_00406560();
        local_8._0_1_ = 5;
        FUN_0070a930();
        local_8 = (uint)local_8._1_3_ << 8;
        FUN_00406560();
        local_8 = 0xffffffff;
        FUN_00406560();
        goto LAB_00ac6b59;
      }
    }
    else {
      FUN_00404350(local_d8);
      local_8._0_1_ = 0x14;
      FUN_00406460(&DAT_00c94aa0);
      local_8._0_1_ = 0x15;
      FUN_0070cd60(local_12c,local_4c,local_30,0);
      local_8._0_1_ = 0x17;
      FUN_00406560();
      if (2 < (uint)((local_124 - local_128) / 0x1c)) {
        if (*(uint *)(local_128 + 0x34) < 8) {
          iVar4 = local_128 + 0x20;
        }
        else {
          iVar4 = *(int *)(local_128 + 0x20);
        }
        iVar4 = FUN_00634f4d(iVar4);
        FUN_00405d70(local_128 + 0x38);
        local_8._0_1_ = 0x14;
        FUN_004042c0();
        local_8._0_1_ = 0x12;
        FUN_00406560();
        goto LAB_00ac6bc3;
      }
      FUN_0070d4c0();
      FUN_008018d0(L"[AvaGuiBannerDownLoader::IsUpdaterChange] DOWNLOAD_UPDATER_VERSIONFILE_ERROR");
      local_8._0_1_ = 0x14;
      FUN_004042c0();
      local_8._0_1_ = 0x12;
      FUN_00406560();
    }
    local_8._0_1_ = 0x11;
    FUN_0070d710();
  }
  local_8._0_1_ = 0xc;
  FUN_00406560();
  local_8._0_1_ = 6;
  FUN_00406560();
  local_8._0_1_ = 5;
  FUN_0070a930();
  local_8 = (uint)local_8._1_3_ << 8;
  FUN_00406560();
  local_8 = 0xffffffff;
  FUN_00406560();
LAB_00ac6b59:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00ac6380 : PUSH EBP
00ac6381 : MOV EBP,ESP
00ac6383 : PUSH -0x1
00ac6385 : PUSH 0xb41fe3
00ac638a : MOV EAX,FS:[0x0]
00ac6390 : PUSH EAX
00ac6391 : SUB ESP,0x12c
00ac6397 : MOV EAX,[0x00d66fa0]
00ac639c : XOR EAX,EBP
00ac639e : MOV dword ptr [EBP + -0x10],EAX
00ac63a1 : PUSH EBX
00ac63a2 : PUSH ESI
00ac63a3 : PUSH EDI
00ac63a4 : PUSH EAX
00ac63a5 : LEA EAX,[EBP + -0xc]
00ac63a8 : MOV FS:[0x0],EAX
00ac63ae : MOV EAX,dword ptr [EBP + 0x8]
00ac63b1 : MOV dword ptr [EBP + 0xffffff08],EAX
00ac63b7 : XOR EBX,EBX
00ac63b9 : MOV dword ptr [EBP + -0x4],EBX
00ac63bc : MOV EDX,dword ptr [0x017248c8]
00ac63c2 : LEA ECX,[EBP + 0xfffffecc]
00ac63c8 : PUSH ECX
00ac63c9 : PUSH EDX
00ac63ca : CALL 0x008b6db0
00ac63cf : MOV byte ptr [EBP + -0x4],0x1
00ac63d3 : LEA ECX,[EBP + -0x48]
00ac63d6 : PUSH ECX
00ac63d7 : MOV EDX,0xc9497c
00ac63dc : MOV ECX,EAX
00ac63de : CALL 0x00403510
00ac63e3 : MOV byte ptr [EBP + -0x4],0x2
00ac63e7 : LEA EDX,[EBP + -0x80]
00ac63ea : PUSH EDX
00ac63eb : MOV EDX,0xc94960
00ac63f0 : MOV ECX,EAX
00ac63f2 : CALL 0x00403510
00ac63f7 : ADD ESP,0x8
00ac63fa : MOV byte ptr [EBP + -0x4],0x4
00ac63fe : MOV ESI,0x8
00ac6403 : CMP dword ptr [EBP + -0x30],ESI
00ac6406 : JC 0x00ac6410
00ac6408 : MOV ECX,dword ptr [EBP + -0x44]
00ac640b : CALL 0x006f04e0
00ac6410 : MOV EDI,0x7
00ac6415 : XOR EAX,EAX
00ac6417 : MOV dword ptr [EBP + -0x30],EDI
00ac641a : MOV dword ptr [EBP + -0x34],EBX
00ac641d : MOV word ptr [EBP + -0x44],AX
00ac6421 : MOV byte ptr [EBP + -0x4],0x5
00ac6425 : CMP dword ptr [EBP + 0xfffffee4],ESI
00ac642b : JC 0x00ac6438
00ac642d : MOV ECX,dword ptr [EBP + 0xfffffed0]
00ac6433 : CALL 0x006f04e0
00ac6438 : XOR ECX,ECX
00ac643a : MOV dword ptr [EBP + 0xfffffef4],0xcd4c80
00ac6444 : MOV dword ptr [EBP + 0xfffffee4],EDI
00ac644a : MOV dword ptr [EBP + 0xfffffee0],EBX
00ac6450 : MOV word ptr [EBP + 0xfffffed0],CX
00ac6457 : MOV byte ptr [EBP + 0xfffffef8],BL
00ac645d : MOV dword ptr [EBP + 0xfffffefc],EBX
00ac6463 : MOV dword ptr [EBP + 0xffffff00],EBX
00ac6469 : MOV dword ptr [EBP + 0xfffffef4],0xcda538
00ac6473 : MOV dword ptr [EBP + 0xffffff04],EBX
00ac6479 : MOV byte ptr [EBP + -0x4],0x6
00ac647d : PUSH 0x2
00ac647f : XOR EDX,EDX
00ac6481 : PUSH 0xc9498c
00ac6486 : LEA ECX,[EBP + -0x2c]
00ac6489 : MOV dword ptr [EBP + -0x14],EDI
00ac648c : MOV dword ptr [EBP + -0x18],EBX
00ac648f : MOV word ptr [EBP + -0x28],DX
00ac6493 : CALL 0x00406360
00ac6498 : MOV byte ptr [EBP + -0x4],0x7
00ac649c : LEA EAX,[EBP + -0x2c]
00ac649f : PUSH EAX
00ac64a0 : LEA ECX,[EBP + -0x80]
00ac64a3 : PUSH ECX
00ac64a4 : LEA ECX,[EBP + 0xfffffef4]
00ac64aa : CALL 0x0070a9a0
00ac64af : MOV byte ptr [EBP + 0xffffff0f],AL
00ac64b5 : MOV byte ptr [EBP + -0x4],0x6
00ac64b9 : CMP dword ptr [EBP + -0x14],ESI
00ac64bc : JC 0x00ac64c6
00ac64be : MOV ECX,dword ptr [EBP + -0x28]
00ac64c1 : CALL 0x006f04e0
00ac64c6 : XOR EDX,EDX
00ac64c8 : MOV dword ptr [EBP + -0x14],EDI
00ac64cb : MOV dword ptr [EBP + -0x18],EBX
00ac64ce : MOV word ptr [EBP + -0x28],DX
00ac64d2 : CMP byte ptr [EBP + 0xffffff0f],BL
00ac64d8 : JZ 0x00ac668d
00ac64de : LEA EAX,[EBP + -0x2c]
00ac64e1 : PUSH EAX
00ac64e2 : LEA ECX,[EBP + 0xfffffef4]
00ac64e8 : CALL 0x0070aa30
00ac64ed : MOV byte ptr [EBP + -0x4],0x8
00ac64f1 : PUSH 0xc94994
00ac64f6 : LEA ECX,[EBP + -0x48]
00ac64f9 : CALL 0x00406460
00ac64fe : MOV byte ptr [EBP + -0x4],0x9
00ac6502 : PUSH EBX
00ac6503 : LEA ECX,[EBP + -0x48]
00ac6506 : PUSH ECX
00ac6507 : LEA EDX,[EBP + -0x2c]
00ac650a : PUSH EDX
00ac650b : LEA EAX,[EBP + 0xfffffed8]
00ac6511 : PUSH EAX
00ac6512 : CALL 0x0070cd60
00ac6517 : ADD ESP,0x10
00ac651a : MOV byte ptr [EBP + -0x4],0xb
00ac651e : CMP dword ptr [EBP + -0x30],ESI
00ac6521 : JC 0x00ac652b
00ac6523 : MOV ECX,dword ptr [EBP + -0x44]
00ac6526 : CALL 0x006f04e0
00ac652b : MOV ESI,dword ptr [EBP + 0xfffffedc]
00ac6531 : XOR ECX,ECX
00ac6533 : MOV word ptr [EBP + -0x44],CX
00ac6537 : MOV ECX,dword ptr [EBP + 0xfffffee0]
00ac653d : SUB ECX,ESI
00ac653f : MOV EAX,0x92492493
00ac6544 : IMUL ECX
00ac6546 : ADD EDX,ECX
00ac6548 : SAR EDX,0x4
00ac654b : MOV EAX,EDX
00ac654d : SHR EAX,0x1f
00ac6550 : ADD EAX,EDX
00ac6552 : MOV dword ptr [EBP + -0x30],EDI
00ac6555 : MOV dword ptr [EBP + -0x34],EBX
00ac6558 : CMP EAX,0x3
00ac655b : JNC 0x00ac663e
00ac6561 : MOV EAX,dword ptr [EBP + 0xffffff04]
00ac6567 : CMP EAX,EBX
00ac6569 : JZ 0x00ac6586
00ac656b : PUSH EAX
00ac656c : CALL 0x006395f7
00ac6571 : MOV ECX,dword ptr [EBP + 0xffffff04]
00ac6577 : PUSH ECX
00ac6578 : CALL 0x006366db
00ac657d : ADD ESP,0x8
00ac6580 : MOV dword ptr [EBP + 0xffffff04],EBX
00ac6586 : MOV ESI,dword ptr [0x00da98e8]
00ac658c : PUSH 0xc94998
00ac6591 : CALL 0x008018d0
00ac6596 : ADD ESP,0x4
00ac6599 : MOV byte ptr [EBP + -0x4],0x8
00ac659d : LEA ESI,[EBP + 0xfffffed8]
00ac65a3 : CALL 0x004042c0
00ac65a8 : MOV byte ptr [EBP + -0x4],0x6
00ac65ac : MOV ESI,0x8
00ac65b1 : CMP dword ptr [EBP + -0x14],ESI
00ac65b4 : JC 0x00ac65be
00ac65b6 : MOV ECX,dword ptr [EBP + -0x28]
00ac65b9 : CALL 0x006f04e0
00ac65be : XOR EDX,EDX
00ac65c0 : MOV dword ptr [EBP + -0x14],EDI
00ac65c3 : MOV dword ptr [EBP + -0x18],EBX
00ac65c6 : MOV word ptr [EBP + -0x28],DX
00ac65ca : MOV byte ptr [EBP + -0x4],0x5
00ac65ce : MOV EAX,dword ptr [EBP + 0xffffff04]
00ac65d4 : MOV dword ptr [EBP + 0xfffffef4],0xcda538
00ac65de : CMP EAX,EBX
00ac65e0 : JZ 0x00ac65fd
00ac65e2 : PUSH EAX
00ac65e3 : CALL 0x006395f7
00ac65e8 : MOV EAX,dword ptr [EBP + 0xffffff04]
00ac65ee : PUSH EAX
00ac65ef : CALL 0x006366db
00ac65f4 : ADD ESP,0x8
00ac65f7 : MOV dword ptr [EBP + 0xffffff04],EBX
00ac65fd : MOV byte ptr [EBP + -0x4],BL
00ac6600 : CMP dword ptr [EBP + -0x68],ESI
00ac6603 : JC 0x00ac660d
00ac6605 : MOV ECX,dword ptr [EBP + -0x7c]
00ac6608 : CALL 0x006f04e0
00ac660d : XOR ECX,ECX
00ac660f : MOV dword ptr [EBP + -0x68],EDI
00ac6612 : MOV dword ptr [EBP + -0x6c],EBX
00ac6615 : MOV word ptr [EBP + -0x7c],CX
00ac6619 : MOV dword ptr [EBP + -0x4],0xffffffff
00ac6620 : CMP dword ptr [EBP + 0x24],ESI
00ac6623 : JC 0x00ac662d
00ac6625 : MOV ECX,dword ptr [EBP + 0x10]
00ac6628 : CALL 0x006f04e0
00ac662d : XOR EDX,EDX
00ac662f : MOV dword ptr [EBP + 0x24],EDI
00ac6632 : MOV dword ptr [EBP + 0x20],EBX
00ac6635 : MOV word ptr [EBP + 0x10],DX
00ac6639 : JMP 0x00ac6b57
00ac663e : CMP dword ptr [ESI + 0x34],0x8
00ac6642 : JC 0x00ac6649
00ac6644 : MOV ESI,dword ptr [ESI + 0x20]
00ac6647 : JMP 0x00ac664c
00ac6649 : ADD ESI,0x20
00ac664c : PUSH ESI
00ac664d : CALL 0x00634f4d
00ac6652 : MOV ECX,dword ptr [EBP + 0xffffff08]
00ac6658 : ADD ESP,0x4
00ac665b : MOV dword ptr [ECX],EAX
00ac665d : MOV byte ptr [EBP + -0x4],0x8
00ac6661 : LEA ESI,[EBP + 0xfffffed8]
00ac6667 : CALL 0x004042c0
00ac666c : MOV byte ptr [EBP + -0x4],0x6
00ac6670 : CMP dword ptr [EBP + -0x14],0x8
00ac6674 : JC 0x00ac667e
00ac6676 : MOV ECX,dword ptr [EBP + -0x28]
00ac6679 : CALL 0x006f04e0
00ac667e : XOR EDX,EDX
00ac6680 : MOV dword ptr [EBP + -0x14],EDI
00ac6683 : MOV dword ptr [EBP + -0x18],EBX
00ac6686 : MOV word ptr [EBP + -0x28],DX
00ac668a : LEA ESI,[EDX + 0x8]
00ac668d : MOV EAX,dword ptr [EBP + 0xffffff04]
00ac6693 : CMP EAX,EBX
00ac6695 : JZ 0x00ac66b2
00ac6697 : PUSH EAX
00ac6698 : CALL 0x006395f7
00ac669d : MOV EAX,dword ptr [EBP + 0xffffff04]
00ac66a3 : PUSH EAX
00ac66a4 : CALL 0x006366db
00ac66a9 : ADD ESP,0x8
00ac66ac : MOV dword ptr [EBP + 0xffffff04],EBX
00ac66b2 : LEA ECX,[EBP + 0xffffff64]
00ac66b8 : PUSH ECX
00ac66b9 : MOV EDX,0xc94a2c
00ac66be : LEA ECX,[EBP + 0xc]
00ac66c1 : CALL 0x00403510
00ac66c6 : ADD ESP,0x4
00ac66c9 : MOV byte ptr [EBP + -0x4],0xc
00ac66cd : MOV EAX,[0x017248c8]
00ac66d2 : LEA EDX,[EBP + -0x2c]
00ac66d5 : PUSH EDX
00ac66d6 : PUSH EAX
00ac66d7 : CALL 0x008b6db0
00ac66dc : MOV byte ptr [EBP + -0x4],0xd
00ac66e0 : LEA ECX,[EBP + -0x48]
00ac66e3 : PUSH ECX
00ac66e4 : MOV EDX,0xc94a64
00ac66e9 : MOV ECX,EAX
00ac66eb : CALL 0x00403510
00ac66f0 : MOV byte ptr [EBP + -0x4],0xe
00ac66f4 : LEA EDX,[EBP + -0x64]
00ac66f7 : PUSH EDX
00ac66f8 : MOV EDX,0xc94a48
00ac66fd : MOV ECX,EAX
00ac66ff : CALL 0x00403510
00ac6704 : ADD ESP,0x8
00ac6707 : MOV byte ptr [EBP + -0x4],0x10
00ac670b : CMP dword ptr [EBP + -0x30],ESI
00ac670e : JC 0x00ac6718
00ac6710 : MOV ECX,dword ptr [EBP + -0x44]
00ac6713 : CALL 0x006f04e0
00ac6718 : XOR EAX,EAX
00ac671a : MOV dword ptr [EBP + -0x30],EDI
00ac671d : MOV dword ptr [EBP + -0x34],EBX
00ac6720 : MOV word ptr [EBP + -0x44],AX
00ac6724 : MOV byte ptr [EBP + -0x4],0x11
00ac6728 : CMP dword ptr [EBP + -0x14],ESI
00ac672b : JC 0x00ac6735
00ac672d : MOV ECX,dword ptr [EBP + -0x28]
00ac6730 : CALL 0x006f04e0
00ac6735 : PUSH EBX
00ac6736 : PUSH EBX
00ac6737 : PUSH EBX
00ac6738 : PUSH 0x1
00ac673a : XOR ECX,ECX
00ac673c : PUSH 0xbf26a2
00ac6741 : MOV dword ptr [EBP + -0x14],EDI
00ac6744 : MOV dword ptr [EBP + -0x18],EBX
00ac6747 : MOV word ptr [EBP + -0x28],CX
00ac674b : CALL dword ptr [0x00b85554]
00ac6751 : MOV EDX,dword ptr [EBP + 0xffffff08]
00ac6757 : MOV dword ptr [EDX + 0x7c],EAX
00ac675a : CMP EAX,EBX
00ac675c : JNZ 0x00ac681f
00ac6762 : MOV byte ptr [EBP + -0x4],0xc
00ac6766 : CMP dword ptr [EBP + -0x4c],ESI
00ac6769 : JC 0x00ac6773
00ac676b : MOV ECX,dword ptr [EBP + -0x60]
00ac676e : CALL 0x006f04e0
00ac6773 : XOR EAX,EAX
00ac6775 : MOV dword ptr [EBP + -0x4c],EDI
00ac6778 : MOV dword ptr [EBP + -0x50],EBX
00ac677b : MOV word ptr [EBP + -0x60],AX
00ac677f : MOV byte ptr [EBP + -0x4],0x6
00ac6783 : CMP dword ptr [EBP + 0xffffff7c],ESI
00ac6789 : JC 0x00ac6796
00ac678b : MOV ECX,dword ptr [EBP + 0xffffff68]
00ac6791 : CALL 0x006f04e0
00ac6796 : XOR ECX,ECX
00ac6798 : MOV dword ptr [EBP + 0xffffff7c],EDI
00ac679e : MOV dword ptr [EBP + 0xffffff78],EBX
00ac67a4 : MOV word ptr [EBP + 0xffffff68],CX
00ac67ab : MOV byte ptr [EBP + -0x4],0x5
00ac67af : MOV EAX,dword ptr [EBP + 0xffffff04]
00ac67b5 : MOV dword ptr [EBP + 0xfffffef4],0xcda538
00ac67bf : CMP EAX,EBX
00ac67c1 : JZ 0x00ac67de
00ac67c3 : PUSH EAX
00ac67c4 : CALL 0x006395f7
00ac67c9 : MOV EDX,dword ptr [EBP + 0xffffff04]
00ac67cf : PUSH EDX
00ac67d0 : CALL 0x006366db
00ac67d5 : ADD ESP,0x8
00ac67d8 : MOV dword ptr [EBP + 0xffffff04],EBX
00ac67de : MOV byte ptr [EBP + -0x4],BL
00ac67e1 : CMP dword ptr [EBP + -0x68],ESI
00ac67e4 : JC 0x00ac67ee
00ac67e6 : MOV ECX,dword ptr [EBP + -0x7c]
00ac67e9 : CALL 0x006f04e0
00ac67ee : XOR EAX,EAX
00ac67f0 : MOV dword ptr [EBP + -0x68],EDI
00ac67f3 : MOV dword ptr [EBP + -0x6c],EBX
00ac67f6 : MOV word ptr [EBP + -0x7c],AX
00ac67fa : MOV dword ptr [EBP + -0x4],0xffffffff
00ac6801 : CMP dword ptr [EBP + 0x24],ESI
00ac6804 : JC 0x00ac680e
00ac6806 : MOV ECX,dword ptr [EBP + 0x10]
00ac6809 : CALL 0x006f04e0
00ac680e : XOR ECX,ECX
00ac6810 : MOV dword ptr [EBP + 0x24],EDI
00ac6813 : MOV dword ptr [EBP + 0x20],EBX
00ac6816 : MOV word ptr [EBP + 0x10],CX
00ac681a : JMP 0x00ac6b57
00ac681f : MOV ECX,dword ptr [EBP + 0xffffff68]
00ac6825 : CMP dword ptr [EBP + 0xffffff7c],ESI
00ac682b : JNC 0x00ac6833
00ac682d : LEA ECX,[EBP + 0xffffff68]
00ac6833 : PUSH EBX
00ac6834 : PUSH 0x84000000
00ac6839 : PUSH EBX
00ac683a : PUSH EBX
00ac683b : PUSH ECX
00ac683c : PUSH EAX
00ac683d : CALL dword ptr [0x00b85550]
00ac6843 : MOV EDI,EAX
00ac6845 : CMP EDI,EBX
00ac6847 : JNZ 0x00ac6914
00ac684d : MOV byte ptr [EBP + -0x4],0xc
00ac6851 : MOV EDI,0x8
00ac6856 : CMP dword ptr [EBP + -0x4c],EDI
00ac6859 : JC 0x00ac6863
00ac685b : MOV ECX,dword ptr [EBP + -0x60]
00ac685e : CALL 0x006f04e0
00ac6863 : MOV ESI,0x7
00ac6868 : XOR EDX,EDX
00ac686a : MOV dword ptr [EBP + -0x4c],ESI
00ac686d : MOV dword ptr [EBP + -0x50],EBX
00ac6870 : MOV word ptr [EBP + -0x60],DX
00ac6874 : MOV byte ptr [EBP + -0x4],0x6
00ac6878 : CMP dword ptr [EBP + 0xffffff7c],EDI
00ac687e : JC 0x00ac688b
00ac6880 : MOV ECX,dword ptr [EBP + 0xffffff68]
00ac6886 : CALL 0x006f04e0
00ac688b : XOR EAX,EAX
00ac688d : MOV dword ptr [EBP + 0xffffff7c],ESI
00ac6893 : MOV dword ptr [EBP + 0xffffff78],EBX
00ac6899 : MOV word ptr [EBP + 0xffffff68],AX
00ac68a0 : MOV byte ptr [EBP + -0x4],0x5
00ac68a4 : MOV EAX,dword ptr [EBP + 0xffffff04]
00ac68aa : MOV dword ptr [EBP + 0xfffffef4],0xcda538
00ac68b4 : CMP EAX,EBX
00ac68b6 : JZ 0x00ac68d3
00ac68b8 : PUSH EAX
00ac68b9 : CALL 0x006395f7
00ac68be : MOV ECX,dword ptr [EBP + 0xffffff04]
00ac68c4 : PUSH ECX
00ac68c5 : CALL 0x006366db
00ac68ca : ADD ESP,0x8
00ac68cd : MOV dword ptr [EBP + 0xffffff04],EBX
00ac68d3 : MOV byte ptr [EBP + -0x4],BL
00ac68d6 : CMP dword ptr [EBP + -0x68],EDI
00ac68d9 : JC 0x00ac68e3
00ac68db : MOV ECX,dword ptr [EBP + -0x7c]
00ac68de : CALL 0x006f04e0
00ac68e3 : XOR EDX,EDX
00ac68e5 : MOV dword ptr [EBP + -0x68],ESI
00ac68e8 : MOV dword ptr [EBP + -0x6c],EBX
00ac68eb : MOV word ptr [EBP + -0x7c],DX
00ac68ef : MOV dword ptr [EBP + -0x4],0xffffffff
00ac68f6 : CMP dword ptr [EBP + 0x24],EDI
00ac68f9 : JC 0x00ac6903
00ac68fb : MOV ECX,dword ptr [EBP + 0x10]
00ac68fe : CALL 0x006f04e0
00ac6903 : XOR EAX,EAX
00ac6905 : MOV dword ptr [EBP + 0x24],ESI
00ac6908 : MOV dword ptr [EBP + 0x20],EBX
00ac690b : MOV word ptr [EBP + 0x10],AX
00ac690f : JMP 0x00ac6b57
00ac6914 : MOV EAX,dword ptr [EBP + -0x60]
00ac6917 : MOV ESI,0x8
00ac691c : CMP dword ptr [EBP + -0x4c],ESI
00ac691f : JNC 0x00ac6924
00ac6921 : LEA EAX,[EBP + -0x60]
00ac6924 : PUSH 0x80
00ac6929 : PUSH EAX
00ac692a : CALL dword ptr [0x00b851c4]
00ac6930 : MOV EAX,dword ptr [EBP + -0x60]
00ac6933 : CMP dword ptr [EBP + -0x4c],ESI
00ac6936 : JNC 0x00ac693b
00ac6938 : LEA EAX,[EBP + -0x60]
00ac693b : PUSH EBX
00ac693c : PUSH 0x80
00ac6941 : PUSH 0x2
00ac6943 : PUSH EBX
00ac6944 : PUSH EBX
00ac6945 : PUSH 0x40000000
00ac694a : PUSH EAX
00ac694b : CALL dword ptr [0x00b85164]
00ac6951 : MOV dword ptr [EBP + 0xfffffef0],EAX
00ac6957 : CMP EAX,-0x1
00ac695a : JNZ 0x00ac6971
00ac695c : MOV ECX,dword ptr [EBP + 0xffffff08]
00ac6962 : MOV EDX,dword ptr [ECX + 0x78]
00ac6965 : PUSH EDX
00ac6966 : CALL dword ptr [0x00b8558c]
00ac696c : JMP 0x00ac6b13
00ac6971 : XOR ESI,ESI
00ac6973 : PUSH EBX
00ac6974 : PUSH EBX
00ac6975 : LEA EAX,[EBP + 0xfffffee8]
00ac697b : PUSH EAX
00ac697c : PUSH EDI
00ac697d : CALL dword ptr [0x00b8554c]
00ac6983 : MOV EAX,dword ptr [EBP + 0xfffffee8]
00ac6989 : CMP EAX,EBX
00ac698b : JZ 0x00ac69a9
00ac698d : PUSH EBX
00ac698e : PUSH 0x117
00ac6993 : PUSH 0xc94a74
00ac6998 : PUSH EAX
00ac6999 : CALL 0x006f0760
00ac699e : MOV ESI,EAX
00ac69a0 : MOV EAX,dword ptr [EBP + 0xfffffee8]
00ac69a6 : ADD ESP,0x10
00ac69a9 : LEA ECX,[EBP + 0xfffffeec]
00ac69af : PUSH ECX
00ac69b0 : PUSH EAX
00ac69b1 : PUSH ESI
00ac69b2 : PUSH EDI
00ac69b3 : CALL dword ptr [0x00b85590]
00ac69b9 : MOV EAX,dword ptr [EBP + 0xfffffeec]
00ac69bf : MOV ECX,dword ptr [EBP + 0xfffffef0]
00ac69c5 : PUSH EBX
00ac69c6 : LEA EDX,[EBP + 0xfffffec8]
00ac69cc : PUSH EDX
00ac69cd : PUSH EAX
00ac69ce : PUSH ESI
00ac69cf : PUSH ECX
00ac69d0 : CALL dword ptr [0x00b851c0]
00ac69d6 : CMP ESI,EBX
00ac69d8 : JZ 0x00ac69e3
00ac69da : MOV ECX,ESI
00ac69dc : CALL 0x006f04e0
00ac69e3 : CMP dword ptr [EBP + 0xfffffeec],EBX
00ac69e9 : JNZ 0x00ac6973
00ac69eb : MOV EDX,dword ptr [EBP + 0xfffffef0]
00ac69f1 : PUSH EDX
00ac69f2 : CALL dword ptr [0x00b85104]
00ac69f8 : PUSH EDI
00ac69f9 : CALL dword ptr [0x00b8558c]
00ac69ff : LEA ECX,[EBP + 0xffffff10]
00ac6a05 : XOR EDI,EDI
00ac6a07 : CALL 0x0070d390
00ac6a0c : MOV byte ptr [EBP + -0x4],0x12
00ac6a10 : PUSH 0xc94a98
00ac6a15 : LEA ECX,[EBP + -0x48]
00ac6a18 : CALL 0x00406460
00ac6a1d : MOV byte ptr [EBP + -0x4],0x13
00ac6a21 : PUSH EBX
00ac6a22 : PUSH EBX
00ac6a23 : LEA EAX,[EBP + -0x48]
00ac6a26 : PUSH EAX
00ac6a27 : LEA ECX,[EBP + -0x64]
00ac6a2a : PUSH ECX
00ac6a2b : LEA EAX,[EBP + 0xffffff10]
00ac6a31 : CALL 0x0070d850
00ac6a36 : CMP AL,0x1
00ac6a38 : SETZ byte ptr [EBP + 0xffffff0f]
00ac6a3f : MOV byte ptr [EBP + -0x4],0x12
00ac6a43 : LEA ECX,[EBP + -0x48]
00ac6a46 : CALL 0x00406560
00ac6a4b : CMP byte ptr [EBP + 0xffffff0f],BL
00ac6a51 : JZ 0x00ac6bc3
00ac6a57 : MOV EDX,dword ptr [EBP + 0xffffff2c]
00ac6a5d : PUSH EDX
00ac6a5e : LEA ESI,[EBP + -0x48]
00ac6a61 : CALL 0x00404350
00ac6a66 : ADD ESP,0x4
00ac6a69 : MOV byte ptr [EBP + -0x4],0x14
00ac6a6d : PUSH 0xc94aa0
00ac6a72 : LEA ECX,[EBP + -0x2c]
00ac6a75 : CALL 0x00406460
00ac6a7a : MOV byte ptr [EBP + -0x4],0x15
00ac6a7e : PUSH EBX
00ac6a7f : LEA EAX,[EBP + -0x2c]
00ac6a82 : PUSH EAX
00ac6a83 : MOV ECX,ESI
00ac6a85 : PUSH ECX
00ac6a86 : LEA EDX,[EBP + 0xfffffed8]
00ac6a8c : PUSH EDX
00ac6a8d : CALL 0x0070cd60
00ac6a92 : ADD ESP,0x10
00ac6a95 : MOV byte ptr [EBP + -0x4],0x17
00ac6a99 : LEA ECX,[EBP + -0x2c]
00ac6a9c : CALL 0x00406560
00ac6aa1 : MOV ECX,dword ptr [EBP + 0xfffffee0]
00ac6aa7 : MOV ESI,dword ptr [EBP + 0xfffffedc]
00ac6aad : SUB ECX,ESI
00ac6aaf : MOV EAX,0x92492493
00ac6ab4 : IMUL ECX
00ac6ab6 : ADD EDX,ECX
00ac6ab8 : SAR EDX,0x4
00ac6abb : MOV EAX,EDX
00ac6abd : SHR EAX,0x1f
00ac6ac0 : ADD EAX,EDX
00ac6ac2 : CMP EAX,0x3
00ac6ac5 : JNC 0x00ac6b77
00ac6acb : LEA ECX,[EBP + 0xffffff10]
00ac6ad1 : CALL 0x0070d4c0
00ac6ad6 : MOV ESI,dword ptr [0x00da98e8]
00ac6adc : PUSH 0xc94aa8
00ac6ae1 : CALL 0x008018d0
00ac6ae6 : ADD ESP,0x4
00ac6ae9 : MOV byte ptr [EBP + -0x4],0x14
00ac6aed : LEA ESI,[EBP + 0xfffffed8]
00ac6af3 : CALL 0x004042c0
00ac6af8 : MOV byte ptr [EBP + -0x4],0x12
00ac6afc : LEA ECX,[EBP + -0x48]
00ac6aff : CALL 0x00406560
00ac6b04 : MOV byte ptr [EBP + -0x4],0x11
00ac6b08 : LEA ECX,[EBP + 0xffffff10]
00ac6b0e : CALL 0x0070d710
00ac6b13 : MOV byte ptr [EBP + -0x4],0xc
00ac6b17 : LEA ECX,[EBP + -0x64]
00ac6b1a : CALL 0x00406560
00ac6b1f : MOV byte ptr [EBP + -0x4],0x6
00ac6b23 : LEA ECX,[EBP + 0xffffff64]
00ac6b29 : CALL 0x00406560
00ac6b2e : MOV byte ptr [EBP + -0x4],0x5
00ac6b32 : LEA ECX,[EBP + 0xfffffef4]
00ac6b38 : CALL 0x0070a930
00ac6b3d : MOV byte ptr [EBP + -0x4],BL
00ac6b40 : LEA ECX,[EBP + -0x80]
00ac6b43 : CALL 0x00406560
00ac6b48 : MOV dword ptr [EBP + -0x4],0xffffffff
00ac6b4f : LEA ECX,[EBP + 0xc]
00ac6b52 : CALL 0x00406560
00ac6b57 : XOR AL,AL
00ac6b59 : MOV ECX,dword ptr [EBP + -0xc]
00ac6b5c : MOV dword ptr FS:[0x0],ECX
00ac6b63 : POP ECX
00ac6b64 : POP EDI
00ac6b65 : POP ESI
00ac6b66 : POP EBX
00ac6b67 : MOV ECX,dword ptr [EBP + -0x10]
00ac6b6a : XOR ECX,EBP
00ac6b6c : CALL 0x00633e6b
00ac6b71 : MOV ESP,EBP
00ac6b73 : POP EBP
00ac6b74 : RET 0x20
00ac6b77 : CMP dword ptr [ESI + 0x34],0x8
00ac6b7b : JC 0x00ac6b82
00ac6b7d : MOV ESI,dword ptr [ESI + 0x20]
00ac6b80 : JMP 0x00ac6b85
00ac6b82 : ADD ESI,0x20
00ac6b85 : PUSH ESI
00ac6b86 : CALL 0x00634f4d
00ac6b8b : MOV ECX,dword ptr [EBP + 0xfffffedc]
00ac6b91 : ADD ECX,0x38
00ac6b94 : ADD ESP,0x4
00ac6b97 : PUSH ECX
00ac6b98 : MOV ECX,dword ptr [EBP + 0xffffff08]
00ac6b9e : ADD ECX,0x8
00ac6ba1 : MOV EDI,EAX
00ac6ba3 : CALL 0x00405d70
00ac6ba8 : MOV byte ptr [EBP + -0x4],0x14
00ac6bac : LEA ESI,[EBP + 0xfffffed8]
00ac6bb2 : CALL 0x004042c0
00ac6bb7 : MOV byte ptr [EBP + -0x4],0x12
00ac6bbb : LEA ECX,[EBP + -0x48]
00ac6bbe : CALL 0x00406560
00ac6bc3 : LEA ECX,[EBP + 0xffffff10]
00ac6bc9 : CALL 0x0070d4c0
00ac6bce : MOV EDX,dword ptr [EBP + 0xffffff08]
00ac6bd4 : MOV EAX,dword ptr [EDX]
00ac6bd6 : MOV ESI,dword ptr [0x00da98e8]
00ac6bdc : PUSH EAX
00ac6bdd : PUSH EDI
00ac6bde : PUSH 0xc94b48
00ac6be3 : CALL 0x008018d0
00ac6be8 : MOV EAX,dword ptr [EBP + 0xffffff08]
00ac6bee : ADD ESP,0xc
00ac6bf1 : CMP dword ptr [EAX],EDI
00ac6bf3 : JZ 0x00ac6b04
00ac6bf9 : MOV dword ptr [EAX + 0x4],EDI
00ac6bfc : MOV byte ptr [EBP + -0x4],0x11
00ac6c00 : LEA ECX,[EBP + 0xffffff10]
00ac6c06 : CALL 0x0070d710
00ac6c0b : MOV byte ptr [EBP + -0x4],0xc
00ac6c0f : LEA ECX,[EBP + -0x64]
00ac6c12 : CALL 0x00406560
00ac6c17 : MOV byte ptr [EBP + -0x4],0x6
00ac6c1b : LEA ECX,[EBP + 0xffffff64]
00ac6c21 : CALL 0x00406560
00ac6c26 : MOV byte ptr [EBP + -0x4],0x5
00ac6c2a : LEA ECX,[EBP + 0xfffffef4]
00ac6c30 : CALL 0x0070a930
00ac6c35 : MOV byte ptr [EBP + -0x4],BL
00ac6c38 : LEA ECX,[EBP + -0x80]
00ac6c3b : CALL 0x00406560
00ac6c40 : MOV dword ptr [EBP + -0x4],0xffffffff
00ac6c47 : LEA ECX,[EBP + 0xc]
00ac6c4a : CALL 0x00406560
00ac6c4f : MOV AL,0x1
00ac6c51 : JMP 0x00ac6b59

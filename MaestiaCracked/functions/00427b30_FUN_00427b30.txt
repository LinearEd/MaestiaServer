PROGRAM  : Maestia.exe
FUNCTION : FUN_00427b30
ENTRY    : 00427b30
BODY     : [[00427b30, 00427c46]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00427b30(undefined4 *param_1,uint param_2)

{
  undefined4 *puVar1;
  int in_ECX;
  undefined4 *puVar2;
  int iVar3;
  uint uVar4;
  
  if (param_1 != (undefined4 *)0x0) {
    uVar4 = *(uint *)(in_ECX + 0x18);
    puVar1 = (undefined4 *)(in_ECX + 4);
    puVar2 = puVar1;
    if (0xf < uVar4) {
      puVar2 = (undefined4 *)*puVar1;
    }
    if (puVar2 <= param_1) {
      puVar2 = puVar1;
      if (0xf < uVar4) {
        puVar2 = (undefined4 *)*puVar1;
      }
      if (param_1 < (undefined4 *)(*(int *)(in_ECX + 0x14) + (int)puVar2)) {
        if (0xf < uVar4) {
          puVar1 = (undefined4 *)*puVar1;
        }
        FUN_00427a20(in_ECX,(int)param_1 - (int)puVar1,param_2);
        return;
      }
    }
  }
  uVar4 = *(uint *)(in_ECX + 0x14);
  if ((-uVar4 - 1 <= param_2) || (uVar4 + param_2 < uVar4)) {
    FUN_00622ecf();
  }
  if (param_2 != 0) {
    uVar4 = *(int *)(in_ECX + 0x14) + param_2;
    if (uVar4 == 0xffffffff) {
      FUN_00622ecf();
    }
    if (*(uint *)(in_ECX + 0x18) < uVar4) {
      FUN_00404ef0(uVar4,*(undefined4 *)(in_ECX + 0x14));
    }
    else if (uVar4 == 0) {
      *(undefined4 *)(in_ECX + 0x14) = 0;
      if (*(uint *)(in_ECX + 0x18) < 0x10) {
        *(undefined1 *)(in_ECX + 4) = 0;
        return;
      }
      **(undefined1 **)(in_ECX + 4) = 0;
      return;
    }
    if (uVar4 != 0) {
      if (*(uint *)(in_ECX + 0x18) < 0x10) {
        iVar3 = in_ECX + 4;
      }
      else {
        iVar3 = *(int *)(in_ECX + 4);
      }
      _memcpy_s((void *)(*(int *)(in_ECX + 0x14) + iVar3),
                *(uint *)(in_ECX + 0x18) - *(int *)(in_ECX + 0x14),param_1,param_2);
      *(uint *)(in_ECX + 0x14) = uVar4;
      if (0xf < *(uint *)(in_ECX + 0x18)) {
        *(undefined1 *)(*(int *)(in_ECX + 4) + uVar4) = 0;
        return;
      }
      *(undefined1 *)(in_ECX + 4 + uVar4) = 0;
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00427b30 : PUSH EBP
00427b31 : MOV EBP,ESP
00427b33 : MOV EDX,dword ptr [EBP + 0x8]
00427b36 : PUSH EBX
00427b37 : PUSH ESI
00427b38 : PUSH EDI
00427b39 : MOV ESI,ECX
00427b3b : TEST EDX,EDX
00427b3d : JZ 0x00427b85
00427b3f : MOV EDI,dword ptr [ESI + 0x18]
00427b42 : LEA EAX,[ESI + 0x4]
00427b45 : CMP EDI,0x10
00427b48 : JC 0x00427b4e
00427b4a : MOV ECX,dword ptr [EAX]
00427b4c : JMP 0x00427b50
00427b4e : MOV ECX,EAX
00427b50 : CMP EDX,ECX
00427b52 : JC 0x00427b85
00427b54 : CMP EDI,0x10
00427b57 : JC 0x00427b5d
00427b59 : MOV ECX,dword ptr [EAX]
00427b5b : JMP 0x00427b5f
00427b5d : MOV ECX,EAX
00427b5f : MOV EBX,dword ptr [ESI + 0x14]
00427b62 : ADD EBX,ECX
00427b64 : CMP EBX,EDX
00427b66 : JBE 0x00427b85
00427b68 : CMP EDI,0x10
00427b6b : JC 0x00427b6f
00427b6d : MOV EAX,dword ptr [EAX]
00427b6f : MOV ECX,dword ptr [EBP + 0xc]
00427b72 : PUSH ECX
00427b73 : SUB EDX,EAX
00427b75 : PUSH EDX
00427b76 : PUSH ESI
00427b77 : MOV ECX,ESI
00427b79 : CALL 0x00427a20
00427b7e : POP EDI
00427b7f : POP ESI
00427b80 : POP EBX
00427b81 : POP EBP
00427b82 : RET 0x8
00427b85 : MOV EAX,dword ptr [ESI + 0x14]
00427b88 : MOV EBX,dword ptr [EBP + 0xc]
00427b8b : OR EDX,0xffffffff
00427b8e : SUB EDX,EAX
00427b90 : CMP EDX,EBX
00427b92 : JBE 0x00427b9b
00427b94 : LEA ECX,[EAX + EBX*0x1]
00427b97 : CMP ECX,EAX
00427b99 : JNC 0x00427ba0
00427b9b : CALL 0x00622ecf
00427ba0 : TEST EBX,EBX
00427ba2 : JBE 0x00427c3e
00427ba8 : MOV EDI,dword ptr [ESI + 0x14]
00427bab : ADD EDI,EBX
00427bad : CMP EDI,-0x2
00427bb0 : JBE 0x00427bb7
00427bb2 : CALL 0x00622ecf
00427bb7 : MOV EAX,dword ptr [ESI + 0x18]
00427bba : CMP EAX,EDI
00427bbc : JNC 0x00427bdb
00427bbe : MOV EDX,dword ptr [ESI + 0x14]
00427bc1 : PUSH EDX
00427bc2 : PUSH EDI
00427bc3 : MOV ECX,ESI
00427bc5 : CALL 0x00404ef0
00427bca : TEST EDI,EDI
00427bcc : JBE 0x00427c3e
00427bce : MOV EAX,dword ptr [ESI + 0x18]
00427bd1 : CMP EAX,0x10
00427bd4 : JC 0x00427c05
00427bd6 : MOV EDX,dword ptr [ESI + 0x4]
00427bd9 : JMP 0x00427c08
00427bdb : TEST EDI,EDI
00427bdd : JNZ 0x00427bcc
00427bdf : MOV dword ptr [ESI + 0x14],EDI
00427be2 : CMP EAX,0x10
00427be5 : JC 0x00427bf6
00427be7 : MOV EAX,dword ptr [ESI + 0x4]
00427bea : POP EDI
00427beb : MOV byte ptr [EAX],0x0
00427bee : MOV EAX,ESI
00427bf0 : POP ESI
00427bf1 : POP EBX
00427bf2 : POP EBP
00427bf3 : RET 0x8
00427bf6 : LEA EAX,[ESI + 0x4]
00427bf9 : POP EDI
00427bfa : MOV byte ptr [EAX],0x0
00427bfd : MOV EAX,ESI
00427bff : POP ESI
00427c00 : POP EBX
00427c01 : POP EBP
00427c02 : RET 0x8
00427c05 : LEA EDX,[ESI + 0x4]
00427c08 : MOV ECX,dword ptr [ESI + 0x14]
00427c0b : PUSH EBX
00427c0c : MOV EBX,dword ptr [EBP + 0x8]
00427c0f : SUB EAX,ECX
00427c11 : PUSH EBX
00427c12 : PUSH EAX
00427c13 : ADD ECX,EDX
00427c15 : PUSH ECX
00427c16 : CALL 0x00633ea4
00427c1b : ADD ESP,0x10
00427c1e : CMP dword ptr [ESI + 0x18],0x10
00427c22 : MOV dword ptr [ESI + 0x14],EDI
00427c25 : JC 0x00427c37
00427c27 : MOV EAX,dword ptr [ESI + 0x4]
00427c2a : MOV byte ptr [EAX + EDI*0x1],0x0
00427c2e : POP EDI
00427c2f : MOV EAX,ESI
00427c31 : POP ESI
00427c32 : POP EBX
00427c33 : POP EBP
00427c34 : RET 0x8
00427c37 : LEA EAX,[ESI + 0x4]
00427c3a : MOV byte ptr [EAX + EDI*0x1],0x0
00427c3e : POP EDI
00427c3f : MOV EAX,ESI
00427c41 : POP ESI
00427c42 : POP EBX
00427c43 : POP EBP
00427c44 : RET 0x8

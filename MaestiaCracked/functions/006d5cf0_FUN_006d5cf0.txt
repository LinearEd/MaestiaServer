PROGRAM  : Maestia.exe
FUNCTION : FUN_006d5cf0
ENTRY    : 006d5cf0
BODY     : [[006d5cf0, 006d5de2]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_006d5cf0(int *param_1)

{
  undefined1 uVar1;
  undefined1 uVar2;
  undefined4 *puVar3;
  char cVar4;
  undefined1 *puVar5;
  undefined1 *puVar6;
  int iVar7;
  
  puVar3 = (undefined4 *)param_1[6];
  puVar5 = (undefined1 *)*puVar3;
  iVar7 = puVar3[1];
  if (iVar7 == 0) {
    cVar4 = (*(code *)puVar3[3])(param_1);
    if (cVar4 == '\0') {
      return 0;
    }
    puVar5 = (undefined1 *)*puVar3;
    iVar7 = puVar3[1];
  }
  uVar1 = *puVar5;
  iVar7 = iVar7 + -1;
  puVar5 = puVar5 + 1;
  if (iVar7 == 0) {
    cVar4 = (*(code *)puVar3[3])(param_1);
    if (cVar4 == '\0') {
      return 0;
    }
    puVar5 = (undefined1 *)*puVar3;
    iVar7 = puVar3[1];
  }
  iVar7 = iVar7 + -1;
  puVar6 = puVar5 + 1;
  if (CONCAT11(uVar1,*puVar5) != 4) {
    *(undefined4 *)(*param_1 + 0x14) = 0xb;
    (**(code **)*param_1)(param_1);
  }
  if (iVar7 == 0) {
    cVar4 = (*(code *)puVar3[3])(param_1);
    if (cVar4 == '\0') {
      return 0;
    }
    puVar6 = (undefined1 *)*puVar3;
    iVar7 = puVar3[1];
  }
  uVar1 = *puVar6;
  iVar7 = iVar7 + -1;
  puVar6 = puVar6 + 1;
  if (iVar7 == 0) {
    cVar4 = (*(code *)puVar3[3])(param_1);
    if (cVar4 == '\0') {
      return 0;
    }
    puVar6 = (undefined1 *)*puVar3;
    iVar7 = puVar3[1];
  }
  uVar2 = *puVar6;
  *(undefined4 *)(*param_1 + 0x14) = 0x52;
  *(uint *)(*param_1 + 0x18) = (uint)CONCAT11(uVar1,uVar2);
  (**(code **)(*param_1 + 4))(param_1,1);
  param_1[0x3f] = (uint)CONCAT11(uVar1,uVar2);
  puVar3[1] = iVar7 + -1;
  *puVar3 = puVar6 + 1;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
006d5cf0 : PUSH EBX
006d5cf1 : PUSH EBP
006d5cf2 : MOV EBP,dword ptr [ESP + 0xc]
006d5cf6 : MOV EBX,dword ptr [EBP + 0x18]
006d5cf9 : PUSH ESI
006d5cfa : MOV ESI,dword ptr [EBX]
006d5cfc : PUSH EDI
006d5cfd : MOV EDI,dword ptr [EBX + 0x4]
006d5d00 : TEST EDI,EDI
006d5d02 : JNZ 0x006d5d1d
006d5d04 : MOV EAX,dword ptr [EBX + 0xc]
006d5d07 : PUSH EBP
006d5d08 : CALL EAX
006d5d0a : ADD ESP,0x4
006d5d0d : TEST AL,AL
006d5d0f : JNZ 0x006d5d18
006d5d11 : POP EDI
006d5d12 : POP ESI
006d5d13 : POP EBP
006d5d14 : XOR AL,AL
006d5d16 : POP EBX
006d5d17 : RET
006d5d18 : MOV ESI,dword ptr [EBX]
006d5d1a : MOV EDI,dword ptr [EBX + 0x4]
006d5d1d : MOVZX EAX,byte ptr [ESI]
006d5d20 : DEC EDI
006d5d21 : SHL EAX,0x8
006d5d24 : INC ESI
006d5d25 : MOV dword ptr [ESP + 0x14],EAX
006d5d29 : TEST EDI,EDI
006d5d2b : JNZ 0x006d5d43
006d5d2d : MOV ECX,dword ptr [EBX + 0xc]
006d5d30 : PUSH EBP
006d5d31 : CALL ECX
006d5d33 : ADD ESP,0x4
006d5d36 : TEST AL,AL
006d5d38 : JZ 0x006d5d11
006d5d3a : MOV ESI,dword ptr [EBX]
006d5d3c : MOV EDI,dword ptr [EBX + 0x4]
006d5d3f : MOV EAX,dword ptr [ESP + 0x14]
006d5d43 : MOVZX EDX,byte ptr [ESI]
006d5d46 : ADD EAX,EDX
006d5d48 : DEC EDI
006d5d49 : INC ESI
006d5d4a : CMP EAX,0x4
006d5d4d : JZ 0x006d5d64
006d5d4f : MOV EAX,dword ptr [EBP]
006d5d52 : MOV dword ptr [EAX + 0x14],0xb
006d5d59 : MOV ECX,dword ptr [EBP]
006d5d5c : MOV EDX,dword ptr [ECX]
006d5d5e : PUSH EBP
006d5d5f : CALL EDX
006d5d61 : ADD ESP,0x4
006d5d64 : TEST EDI,EDI
006d5d66 : JNZ 0x006d5d7a
006d5d68 : MOV EAX,dword ptr [EBX + 0xc]
006d5d6b : PUSH EBP
006d5d6c : CALL EAX
006d5d6e : ADD ESP,0x4
006d5d71 : TEST AL,AL
006d5d73 : JZ 0x006d5d11
006d5d75 : MOV ESI,dword ptr [EBX]
006d5d77 : MOV EDI,dword ptr [EBX + 0x4]
006d5d7a : MOVZX EAX,byte ptr [ESI]
006d5d7d : DEC EDI
006d5d7e : SHL EAX,0x8
006d5d81 : INC ESI
006d5d82 : MOV dword ptr [ESP + 0x14],EAX
006d5d86 : TEST EDI,EDI
006d5d88 : JNZ 0x006d5da4
006d5d8a : MOV ECX,dword ptr [EBX + 0xc]
006d5d8d : PUSH EBP
006d5d8e : CALL ECX
006d5d90 : ADD ESP,0x4
006d5d93 : TEST AL,AL
006d5d95 : JZ 0x006d5d11
006d5d9b : MOV ESI,dword ptr [EBX]
006d5d9d : MOV EDI,dword ptr [EBX + 0x4]
006d5da0 : MOV EAX,dword ptr [ESP + 0x14]
006d5da4 : MOVZX EDX,byte ptr [ESI]
006d5da7 : MOV ECX,dword ptr [EBP]
006d5daa : ADD EAX,EDX
006d5dac : MOV dword ptr [ECX + 0x14],0x52
006d5db3 : MOV EDX,dword ptr [EBP]
006d5db6 : MOV dword ptr [EDX + 0x18],EAX
006d5db9 : MOV dword ptr [ESP + 0x14],EAX
006d5dbd : MOV EAX,dword ptr [EBP]
006d5dc0 : MOV ECX,dword ptr [EAX + 0x4]
006d5dc3 : PUSH 0x1
006d5dc5 : PUSH EBP
006d5dc6 : CALL ECX
006d5dc8 : MOV EDX,dword ptr [ESP + 0x1c]
006d5dcc : ADD ESP,0x8
006d5dcf : MOV dword ptr [EBP + 0xfc],EDX
006d5dd5 : DEC EDI
006d5dd6 : INC ESI
006d5dd7 : MOV dword ptr [EBX + 0x4],EDI
006d5dda : POP EDI
006d5ddb : MOV dword ptr [EBX],ESI
006d5ddd : POP ESI
006d5dde : POP EBP
006d5ddf : MOV AL,0x1
006d5de1 : POP EBX
006d5de2 : RET

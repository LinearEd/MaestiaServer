PROGRAM  : Maestia.exe
FUNCTION : FUN_006865d0
ENTRY    : 006865d0
BODY     : [[006865d0, 006866bf]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_006865d0(int param_1,int *param_2,char param_3,int *param_4)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  int iVar6;
  
  if ((*(byte *)(param_1 + 8) & 2) == 0) {
    return 0x23;
  }
  if (*param_2 == 0) {
    iVar6 = param_2[1];
    iVar5 = iVar6;
    if (param_2[3] != 0) {
      iVar5 = (iVar6 * param_2[3] + 0x24) / 0x48;
    }
    iVar1 = param_2[2];
    iVar2 = iVar1;
    if (param_2[4] != 0) {
      iVar2 = (iVar1 * param_2[4] + 0x24) / 0x48;
    }
    if (((iVar6 == 0) || ((iVar3 = iVar5, iVar1 != 0 && (iVar3 = iVar2, iVar6 == 0)))) &&
       (iVar3 = iVar2, iVar1 != 0)) {
      iVar5 = iVar2;
    }
    iVar6 = 0;
    if (0 < *(int *)(param_1 + 0x1c)) {
      piVar4 = (int *)(*(int *)(param_1 + 0x20) + 8);
      do {
        if (((iVar3 + 0x20U & 0xffffffc0) == (piVar4[1] + 0x20U & 0xffffffc0)) &&
           (((iVar5 + 0x20U & 0xffffffc0) == (*piVar4 + 0x20U & 0xffffffc0) || (param_3 != '\0'))))
        {
          if (param_4 != (int *)0x0) {
            *param_4 = iVar6;
          }
          return 0;
        }
        iVar6 = iVar6 + 1;
        piVar4 = piVar4 + 4;
      } while (iVar6 < *(int *)(param_1 + 0x1c));
    }
    return 0x17;
  }
  return 7;
}



============================================================
DISASSEMBLY
============================================================
006865d0 : PUSH EBP
006865d1 : MOV EBP,dword ptr [ESP + 0x8]
006865d5 : TEST byte ptr [EBP + 0x8],0x2
006865d9 : JNZ 0x006865e2
006865db : MOV EAX,0x23
006865e0 : POP EBP
006865e1 : RET
006865e2 : PUSH EDI
006865e3 : MOV EDI,dword ptr [ESP + 0x10]
006865e7 : CMP dword ptr [EDI],0x0
006865ea : JZ 0x006865f4
006865ec : POP EDI
006865ed : MOV EAX,0x7
006865f2 : POP EBP
006865f3 : RET
006865f4 : MOV EAX,dword ptr [EDI + 0xc]
006865f7 : PUSH EBX
006865f8 : MOV EBX,dword ptr [EDI + 0x4]
006865fb : PUSH ESI
006865fc : TEST EAX,EAX
006865fe : JZ 0x0068661b
00686600 : MOV ECX,EBX
00686602 : IMUL ECX,EAX
00686605 : ADD ECX,0x24
00686608 : MOV EAX,0x38e38e39
0068660d : IMUL ECX
0068660f : SAR EDX,0x4
00686612 : MOV ESI,EDX
00686614 : SHR ESI,0x1f
00686617 : ADD ESI,EDX
00686619 : JMP 0x0068661d
0068661b : MOV ESI,EBX
0068661d : MOV EAX,dword ptr [EDI + 0x10]
00686620 : MOV EDI,dword ptr [EDI + 0x8]
00686623 : TEST EAX,EAX
00686625 : JZ 0x00686642
00686627 : MOV ECX,EDI
00686629 : IMUL ECX,EAX
0068662c : ADD ECX,0x24
0068662f : MOV EAX,0x38e38e39
00686634 : IMUL ECX
00686636 : SAR EDX,0x4
00686639 : MOV EAX,EDX
0068663b : SHR EAX,0x1f
0068663e : ADD EAX,EDX
00686640 : JMP 0x00686644
00686642 : MOV EAX,EDI
00686644 : TEST EBX,EBX
00686646 : JZ 0x00686654
00686648 : TEST EDI,EDI
0068664a : JNZ 0x00686650
0068664c : MOV EAX,ESI
0068664e : JMP 0x0068665a
00686650 : TEST EBX,EBX
00686652 : JNZ 0x0068665a
00686654 : TEST EDI,EDI
00686656 : JZ 0x0068665a
00686658 : MOV ESI,EAX
0068665a : MOV EBP,dword ptr [EBP + 0x1c]
0068665d : LEA ECX,[ESI + 0x20]
00686660 : LEA ESI,[EAX + 0x20]
00686663 : AND ECX,0xffffffc0
00686666 : AND ESI,0xffffffc0
00686669 : XOR EDI,EDI
0068666b : TEST EBP,EBP
0068666d : JLE 0x006866a5
0068666f : MOV EAX,dword ptr [ESP + 0x14]
00686673 : MOV EAX,dword ptr [EAX + 0x20]
00686676 : MOV DL,byte ptr [ESP + 0x1c]
0068667a : ADD EAX,0x8
0068667d : LEA ECX,[ECX]
00686680 : MOV EBX,dword ptr [EAX + 0x4]
00686683 : ADD EBX,0x20
00686686 : AND EBX,0xffffffc0
00686689 : CMP ESI,EBX
0068668b : JNZ 0x0068669d
0068668d : MOV EBX,dword ptr [EAX]
0068668f : ADD EBX,0x20
00686692 : AND EBX,0xffffffc0
00686695 : CMP ECX,EBX
00686697 : JZ 0x006866af
00686699 : TEST DL,DL
0068669b : JNZ 0x006866af
0068669d : INC EDI
0068669e : ADD EAX,0x10
006866a1 : CMP EDI,EBP
006866a3 : JL 0x00686680
006866a5 : POP ESI
006866a6 : POP EBX
006866a7 : POP EDI
006866a8 : MOV EAX,0x17
006866ad : POP EBP
006866ae : RET
006866af : MOV EAX,dword ptr [ESP + 0x20]
006866b3 : TEST EAX,EAX
006866b5 : JZ 0x006866b9
006866b7 : MOV dword ptr [EAX],EDI
006866b9 : POP ESI
006866ba : POP EBX
006866bb : POP EDI
006866bc : XOR EAX,EAX
006866be : POP EBP
006866bf : RET

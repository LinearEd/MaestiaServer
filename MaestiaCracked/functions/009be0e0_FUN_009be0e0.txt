PROGRAM  : Maestia.exe
FUNCTION : FUN_009be0e0
ENTRY    : 009be0e0
BODY     : [[009be0e0, 009be392]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009be0e0(int param_1,int param_2)

{
  uint uVar1;
  tm *ptVar2;
  int iVar3;
  ushort *packet;
  int iVar4;
  byte bVar5;
  undefined4 *puVar6;
  undefined1 auStack_84 [7];
  char local_7d;
  undefined4 *local_7c;
  undefined8 local_78;
  undefined4 local_6c;
  undefined4 uStack_5c;
  uint local_58;
  undefined4 local_50;
  undefined4 uStack_40;
  uint local_3c;
  undefined2 uStack_34;
  undefined4 uStack_24;
  uint uStack_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  int local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b41b03;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_84;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xffffff70;
  ExceptionList = &local_14;
  if (param_1 == 0) {
    local_78 = __time64((__time64_t *)0x0);
    ptVar2 = __localtime64(&local_78);
    FUN_009aea50();
    local_c = 0;
    local_7d = ((char)*(undefined2 *)(*(int *)(DAT_0172491c + 0x17c) + 0x7c) + -1) * '\x04' +
               (char)*(undefined4 *)(*(int *)(DAT_0172491c + 0x17c) + 0x16d8);
    FUN_00404750(L"%d.%02d.%02d %02d:%02d",ptVar2->tm_year + 0x76c,ptVar2->tm_mon + 1,
                 ptVar2->tm_mday,ptVar2->tm_hour,ptVar2->tm_min);
    local_c._0_1_ = 1;
    if (local_3c < 8) {
      local_7c = &local_50;
    }
    else {
      local_7c = local_50;
    }
    puVar6 = local_6c;
    if (local_58 < 8) {
      puVar6 = &local_6c;
    }
    iVar3 = *(int *)(DAT_0172491c + 0x17c);
    if (*(uint *)(iVar3 + 0x24) < 8) {
      iVar4 = iVar3 + 0x10;
    }
    else {
      iVar4 = *(int *)(iVar3 + 0x10);
    }
    FUN_00404750(&DAT_00c8f170,*(undefined4 *)(DAT_0172491c + 0x16c),iVar4,
                 *(undefined4 *)(iVar3 + 0xa0),local_7d,puVar6,local_7c,
                 *(undefined2 *)(param_2 + 0x24),*(undefined4 *)(param_2 + 0x20));
    iVar3 = *(int *)ThreadLocalStoragePointer;
    bVar5 = (byte)((ulonglong)(*(byte *)(iVar3 + 0x18) + 1) % 3);
    *(byte *)(iVar3 + 0x18) = bVar5;
    local_7c = (undefined4 *)((uint)bVar5 * 0x2000 + 0x122cb8 + iVar3);
    local_c._0_1_ = 3;
    if (local_7c == (undefined4 *)0x0) {
      packet = (ushort *)0x0;
    }
    else {
      if (*(uint *)(param_2 + 0x18) < 8) {
        iVar3 = param_2 + 4;
      }
      else {
        iVar3 = *(int *)(param_2 + 4);
      }
      packet = (ushort *)
               FUN_0041eb70(*(undefined2 *)(param_2 + 0x1c),*(undefined4 *)(param_2 + 0x20),iVar3);
    }
    local_c._0_1_ = 2;
    if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
      FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),*packet & 0x1fff,(uint8_t *)packet);
    }
    (**(code **)(**(int **)(*DAT_00da9894 + 0x250) + 0x20))();
    local_c = CONCAT31(local_c._1_3_,1);
    if (7 < uStack_20) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    uStack_20 = 7;
    uStack_24 = 0;
    uStack_34 = 0;
    local_c = (uint)local_c._1_3_ << 8;
    if (7 < local_3c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_3c = 7;
    uStack_40 = 0;
    local_50 = (undefined4 *)((uint)local_50._2_2_ << 0x10);
    local_c = 0xffffffff;
    if (7 < local_58) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_58 = 7;
    uStack_5c = 0;
    local_6c = (undefined4 *)((uint)local_6c._2_2_ << 0x10);
  }
  local_c = 0xffffffff;
  if (param_2 != 0) {
    FUN_0044cb00(param_2);
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0(uVar1);
  }
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_84);
  return;
}



============================================================
DISASSEMBLY
============================================================
009be0e0 : PUSH EBP
009be0e1 : MOV EBP,ESP
009be0e3 : AND ESP,0xfffffff8
009be0e6 : PUSH -0x1
009be0e8 : PUSH 0xb41b03
009be0ed : MOV EAX,FS:[0x0]
009be0f3 : PUSH EAX
009be0f4 : SUB ESP,0x70
009be0f7 : MOV EAX,[0x00d66fa0]
009be0fc : XOR EAX,ESP
009be0fe : MOV dword ptr [ESP + 0x68],EAX
009be102 : PUSH EBX
009be103 : PUSH ESI
009be104 : PUSH EDI
009be105 : MOV EAX,[0x00d66fa0]
009be10a : XOR EAX,ESP
009be10c : PUSH EAX
009be10d : LEA EAX,[ESP + 0x80]
009be114 : MOV FS:[0x0],EAX
009be11a : CMP dword ptr [EBP + 0x8],0x0
009be11e : MOV EBX,dword ptr [EBP + 0xc]
009be121 : JNZ 0x009be35f
009be127 : PUSH 0x0
009be129 : CALL 0x006381ab
009be12e : MOV dword ptr [ESP + 0x20],EAX
009be132 : LEA EAX,[ESP + 0x20]
009be136 : ADD ESP,0x4
009be139 : PUSH EAX
009be13a : MOV dword ptr [ESP + 0x24],EDX
009be13e : CALL 0x00635226
009be143 : ADD ESP,0x4
009be146 : MOV ECX,EBX
009be148 : LEA ESI,[ESP + 0x24]
009be14c : MOV EDI,EAX
009be14e : CALL 0x009aea50
009be153 : MOV dword ptr [ESP + 0x88],0x0
009be15e : MOV ECX,dword ptr [0x0172491c]
009be164 : MOV EAX,dword ptr [ECX + 0x17c]
009be16a : MOV ECX,dword ptr [EAX + 0x16d8]
009be170 : MOVZX EAX,word ptr [EAX + 0x7c]
009be174 : MOV EDX,dword ptr [EDI + 0x4]
009be177 : DEC AL
009be179 : ADD AL,AL
009be17b : ADD AL,AL
009be17d : ADD AL,CL
009be17f : MOV ECX,dword ptr [EDI + 0xc]
009be182 : PUSH EDX
009be183 : MOV EDX,dword ptr [EDI + 0x10]
009be186 : MOV byte ptr [ESP + 0x1b],AL
009be18a : MOV EAX,dword ptr [EDI + 0x8]
009be18d : PUSH EAX
009be18e : MOV EAX,dword ptr [EDI + 0x14]
009be191 : PUSH ECX
009be192 : INC EDX
009be193 : PUSH EDX
009be194 : ADD EAX,0x76c
009be199 : PUSH EAX
009be19a : PUSH 0xc8f140
009be19f : LEA ESI,[ESP + 0x58]
009be1a3 : CALL 0x00404750
009be1a8 : ADD ESP,0x18
009be1ab : MOV byte ptr [ESP + 0x88],0x1
009be1b3 : MOV EDI,0x8
009be1b8 : CMP dword ptr [ESP + 0x58],EDI
009be1bc : JC 0x009be1c8
009be1be : MOV ECX,dword ptr [ESP + 0x44]
009be1c2 : MOV dword ptr [ESP + 0x18],ECX
009be1c6 : JMP 0x009be1d0
009be1c8 : LEA EDX,[ESP + 0x44]
009be1cc : MOV dword ptr [ESP + 0x18],EDX
009be1d0 : MOV ESI,dword ptr [ESP + 0x28]
009be1d4 : CMP dword ptr [ESP + 0x3c],EDI
009be1d8 : JNC 0x009be1de
009be1da : LEA ESI,[ESP + 0x28]
009be1de : MOV EAX,[0x0172491c]
009be1e3 : MOV ECX,dword ptr [EAX + 0x17c]
009be1e9 : MOV EDX,dword ptr [ECX + 0xa0]
009be1ef : CMP dword ptr [ECX + 0x24],EDI
009be1f2 : JC 0x009be1f9
009be1f4 : MOV ECX,dword ptr [ECX + 0x10]
009be1f7 : JMP 0x009be1fc
009be1f9 : ADD ECX,0x10
009be1fc : MOV EDI,dword ptr [EBX + 0x20]
009be1ff : MOV EAX,dword ptr [EAX + 0x16c]
009be205 : PUSH EDI
009be206 : MOVZX EDI,word ptr [EBX + 0x24]
009be20a : PUSH EDI
009be20b : MOV EDI,dword ptr [ESP + 0x20]
009be20f : PUSH EDI
009be210 : PUSH ESI
009be211 : MOVZX ESI,byte ptr [ESP + 0x27]
009be216 : PUSH ESI
009be217 : PUSH EDX
009be218 : PUSH ECX
009be219 : PUSH EAX
009be21a : PUSH 0xc8f170
009be21f : LEA ESI,[ESP + 0x80]
009be226 : CALL 0x00404750
009be22b : ADD ESP,0x24
009be22e : MOV byte ptr [ESP + 0x88],0x2
009be236 : MOV EAX,FS:[0x2c]
009be23c : MOV ECX,dword ptr [EAX]
009be23e : MOVZX EAX,byte ptr [ECX + 0x18]
009be242 : INC EAX
009be243 : CDQ
009be244 : MOV ESI,0x3
009be249 : IDIV ESI
009be24b : MOV byte ptr [ECX + 0x18],DL
009be24e : MOVZX EDX,DL
009be251 : SHL EDX,0xd
009be254 : LEA ESI,[EDX + ECX*0x1 + 0x122cb8]
009be25b : MOV dword ptr [ESP + 0x18],ESI
009be25f : MOV byte ptr [ESP + 0x88],0x3
009be267 : MOV EDI,0x8
009be26c : TEST ESI,ESI
009be26e : JZ 0x009be292
009be270 : CMP dword ptr [EBX + 0x18],EDI
009be273 : JC 0x009be27a
009be275 : MOV EAX,dword ptr [EBX + 0x4]
009be278 : JMP 0x009be27d
009be27a : LEA EAX,[EBX + 0x4]
009be27d : MOVZX ECX,word ptr [EBX + 0x1c]
009be281 : PUSH EAX
009be282 : MOV EAX,dword ptr [EBX + 0x20]
009be285 : PUSH EAX
009be286 : PUSH ECX
009be287 : MOV CX,word ptr [EBX + 0x24]
009be28b : CALL 0x0041eb70
009be290 : JMP 0x009be294
009be292 : XOR EAX,EAX
009be294 : MOV byte ptr [ESP + 0x88],0x2
009be29c : MOV EDX,dword ptr [0x017247d4]
009be2a2 : MOV ECX,dword ptr [EDX + 0x4]
009be2a5 : TEST ECX,ECX
009be2a7 : JZ 0x009be2c6
009be2a9 : CMP byte ptr [EDX + 0x8],0x0
009be2ad : JZ 0x009be2c6
009be2af : MOVZX EDX,word ptr [EAX]
009be2b2 : AND EDX,0x1fff
009be2b8 : PUSH EDX
009be2b9 : PUSH ECX
009be2ba : MOV EDI,EAX
009be2bc : CALL 0x00a0dd40
009be2c1 : MOV EDI,0x8
009be2c6 : MOV EAX,[0x00da9894]
009be2cb : MOV EAX,dword ptr [EAX]
009be2cd : MOV ECX,dword ptr [EAX + 0x250]
009be2d3 : MOV EDX,dword ptr [ECX]
009be2d5 : MOV EAX,dword ptr [EDX + 0x20]
009be2d8 : CALL EAX
009be2da : MOV byte ptr [ESP + 0x88],0x1
009be2e2 : CMP dword ptr [ESP + 0x74],EDI
009be2e6 : JC 0x009be2f1
009be2e8 : MOV ECX,dword ptr [ESP + 0x60]
009be2ec : CALL 0x006f04e0
009be2f1 : XOR ECX,ECX
009be2f3 : MOV ESI,0x7
009be2f8 : MOV dword ptr [ESP + 0x74],ESI
009be2fc : MOV dword ptr [ESP + 0x70],0x0
009be304 : MOV word ptr [ESP + 0x60],CX
009be309 : MOV byte ptr [ESP + 0x88],CL
009be310 : CMP dword ptr [ESP + 0x58],EDI
009be314 : JC 0x009be31f
009be316 : MOV ECX,dword ptr [ESP + 0x44]
009be31a : CALL 0x006f04e0
009be31f : XOR EDX,EDX
009be321 : MOV dword ptr [ESP + 0x58],ESI
009be325 : MOV dword ptr [ESP + 0x54],0x0
009be32d : MOV word ptr [ESP + 0x44],DX
009be332 : MOV dword ptr [ESP + 0x88],0xffffffff
009be33d : CMP dword ptr [ESP + 0x3c],EDI
009be341 : JC 0x009be34c
009be343 : MOV ECX,dword ptr [ESP + 0x28]
009be347 : CALL 0x006f04e0
009be34c : XOR EAX,EAX
009be34e : MOV dword ptr [ESP + 0x3c],ESI
009be352 : MOV dword ptr [ESP + 0x38],0x0
009be35a : MOV word ptr [ESP + 0x28],AX
009be35f : TEST EBX,EBX
009be361 : JZ 0x009be370
009be363 : PUSH EBX
009be364 : CALL 0x0044cb00
009be369 : MOV ECX,EBX
009be36b : CALL 0x006f04e0
009be370 : MOV ECX,dword ptr [ESP + 0x80]
009be377 : MOV dword ptr FS:[0x0],ECX
009be37e : POP ECX
009be37f : POP EDI
009be380 : POP ESI
009be381 : POP EBX
009be382 : MOV ECX,dword ptr [ESP + 0x68]
009be386 : XOR ECX,ESP
009be388 : CALL 0x00633e6b
009be38d : MOV ESP,EBP
009be38f : POP EBP
009be390 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : _strncpy
ENTRY    : 00636e50
BODY     : [[00636e50, 00636f73]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    _strncpy
   
   Library: Visual Studio */

char * __cdecl _strncpy(char *_Dest,char *_Source,size_t _Count)

{
  uint uVar1;
  uint uVar2;
  char cVar3;
  uint uVar4;
  uint *puVar5;
  
  if (_Count == 0) {
    return _Dest;
  }
  puVar5 = (uint *)_Dest;
  if (((uint)_Source & 3) != 0) {
    while( true ) {
      uVar4 = *(uint *)_Source;
      _Source = (char *)((int)_Source + 1);
      *(char *)puVar5 = (char)uVar4;
      puVar5 = (uint *)((int)puVar5 + 1);
      _Count = _Count - 1;
      if (_Count == 0) {
        return _Dest;
      }
      if ((char)uVar4 == '\0') break;
      if (((uint)_Source & 3) == 0) {
        uVar4 = _Count >> 2;
        goto joined_r0x00636e9c;
      }
    }
    do {
      if (((uint)puVar5 & 3) == 0) {
        uVar4 = _Count >> 2;
        cVar3 = '\0';
        if (uVar4 == 0) goto LAB_00636ee3;
        goto LAB_00636f59;
      }
      *(char *)puVar5 = '\0';
      puVar5 = (uint *)((int)puVar5 + 1);
      _Count = _Count - 1;
    } while (_Count != 0);
    return _Dest;
  }
  uVar4 = _Count >> 2;
  if (uVar4 != 0) {
    do {
      uVar1 = *(uint *)_Source;
      uVar2 = *(uint *)_Source;
      _Source = (char *)((int)_Source + 4);
      if (((uVar1 ^ 0xffffffff ^ uVar1 + 0x7efefeff) & 0x81010100) != 0) {
        if ((char)uVar2 == '\0') {
          *puVar5 = 0;
joined_r0x00636f55:
          while( true ) {
            uVar4 = uVar4 - 1;
            puVar5 = puVar5 + 1;
            if (uVar4 == 0) break;
LAB_00636f59:
            *puVar5 = 0;
          }
          cVar3 = '\0';
          _Count = _Count & 3;
          if (_Count != 0) goto LAB_00636ee3;
          return _Dest;
        }
        if ((char)(uVar2 >> 8) == '\0') {
          *puVar5 = uVar2 & 0xff;
          goto joined_r0x00636f55;
        }
        if ((uVar2 & 0xff0000) == 0) {
          *puVar5 = uVar2 & 0xffff;
          goto joined_r0x00636f55;
        }
        if ((uVar2 & 0xff000000) == 0) {
          *puVar5 = uVar2;
          goto joined_r0x00636f55;
        }
      }
      *puVar5 = uVar2;
      puVar5 = puVar5 + 1;
      uVar4 = uVar4 - 1;
joined_r0x00636e9c:
    } while (uVar4 != 0);
    _Count = _Count & 3;
    if (_Count == 0) {
      return _Dest;
    }
  }
  do {
    cVar3 = (char)*(uint *)_Source;
    _Source = (char *)((int)_Source + 1);
    *(char *)puVar5 = cVar3;
    puVar5 = (uint *)((int)puVar5 + 1);
    if (cVar3 == '\0') {
      while (_Count = _Count - 1, _Count != 0) {
LAB_00636ee3:
        *(char *)puVar5 = cVar3;
        puVar5 = (uint *)((int)puVar5 + 1);
      }
      return _Dest;
    }
    _Count = _Count - 1;
  } while (_Count != 0);
  return _Dest;
}



============================================================
DISASSEMBLY
============================================================
00636e50 : MOV ECX,dword ptr [ESP + 0xc]
00636e54 : PUSH EDI
00636e55 : TEST ECX,ECX
00636e57 : JZ 0x00636eef
00636e5d : PUSH ESI
00636e5e : PUSH EBX
00636e5f : MOV EBX,ECX
00636e61 : MOV ESI,dword ptr [ESP + 0x14]
00636e65 : TEST ESI,0x3
00636e6b : MOV EDI,dword ptr [ESP + 0x10]
00636e6f : JNZ 0x00636e7c
00636e71 : SHR ECX,0x2
00636e74 : JNZ 0x00636eff
00636e7a : JMP 0x00636ea3
00636e7c : MOV AL,byte ptr [ESI]
00636e7e : ADD ESI,0x1
00636e81 : MOV byte ptr [EDI],AL
00636e83 : ADD EDI,0x1
00636e86 : SUB ECX,0x1
00636e89 : JZ 0x00636eb6
00636e8b : TEST AL,AL
00636e8d : JZ 0x00636ebe
00636e8f : TEST ESI,0x3
00636e95 : JNZ 0x00636e7c
00636e97 : MOV EBX,ECX
00636e99 : SHR ECX,0x2
00636e9c : JNZ 0x00636eff
00636e9e : AND EBX,0x3
00636ea1 : JZ 0x00636eb6
00636ea3 : MOV AL,byte ptr [ESI]
00636ea5 : ADD ESI,0x1
00636ea8 : MOV byte ptr [EDI],AL
00636eaa : ADD EDI,0x1
00636ead : TEST AL,AL
00636eaf : JZ 0x00636ee8
00636eb1 : SUB EBX,0x1
00636eb4 : JNZ 0x00636ea3
00636eb6 : MOV EAX,dword ptr [ESP + 0x10]
00636eba : POP EBX
00636ebb : POP ESI
00636ebc : POP EDI
00636ebd : RET
00636ebe : TEST EDI,0x3
00636ec4 : JZ 0x00636edc
00636ec6 : MOV byte ptr [EDI],AL
00636ec8 : ADD EDI,0x1
00636ecb : SUB ECX,0x1
00636ece : JZ 0x00636f6c
00636ed4 : TEST EDI,0x3
00636eda : JNZ 0x00636ec6
00636edc : MOV EBX,ECX
00636ede : SHR ECX,0x2
00636ee1 : JNZ 0x00636f57
00636ee3 : MOV byte ptr [EDI],AL
00636ee5 : ADD EDI,0x1
00636ee8 : SUB EBX,0x1
00636eeb : JNZ 0x00636ee3
00636eed : POP EBX
00636eee : POP ESI
00636eef : MOV EAX,dword ptr [ESP + 0x8]
00636ef3 : POP EDI
00636ef4 : RET
00636ef5 : MOV dword ptr [EDI],EDX
00636ef7 : ADD EDI,0x4
00636efa : SUB ECX,0x1
00636efd : JZ 0x00636e9e
00636eff : MOV EDX,0x7efefeff
00636f04 : MOV EAX,dword ptr [ESI]
00636f06 : ADD EDX,EAX
00636f08 : XOR EAX,0xffffffff
00636f0b : XOR EAX,EDX
00636f0d : MOV EDX,dword ptr [ESI]
00636f0f : ADD ESI,0x4
00636f12 : TEST EAX,0x81010100
00636f17 : JZ 0x00636ef5
00636f19 : TEST DL,DL
00636f1b : JZ 0x00636f49
00636f1d : TEST DH,DH
00636f1f : JZ 0x00636f3f
00636f21 : TEST EDX,0xff0000
00636f27 : JZ 0x00636f35
00636f29 : TEST EDX,0xff000000
00636f2f : JNZ 0x00636ef5
00636f31 : MOV dword ptr [EDI],EDX
00636f33 : JMP 0x00636f4d
00636f35 : AND EDX,0xffff
00636f3b : MOV dword ptr [EDI],EDX
00636f3d : JMP 0x00636f4d
00636f3f : AND EDX,0xff
00636f45 : MOV dword ptr [EDI],EDX
00636f47 : JMP 0x00636f4d
00636f49 : XOR EDX,EDX
00636f4b : MOV dword ptr [EDI],EDX
00636f4d : ADD EDI,0x4
00636f50 : XOR EAX,EAX
00636f52 : SUB ECX,0x1
00636f55 : JZ 0x00636f63
00636f57 : XOR EAX,EAX
00636f59 : MOV dword ptr [EDI],EAX
00636f5b : ADD EDI,0x4
00636f5e : SUB ECX,0x1
00636f61 : JNZ 0x00636f59
00636f63 : AND EBX,0x3
00636f66 : JNZ 0x00636ee3
00636f6c : MOV EAX,dword ptr [ESP + 0x10]
00636f70 : POP EBX
00636f71 : POP ESI
00636f72 : POP EDI
00636f73 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_006e70d0
ENTRY    : 006e70d0
BODY     : [[006e70d0, 006e7108] [006e7110, 006e753f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006e70d0(int param_1,int param_2,int param_3,int *param_4,int param_5)

{
  undefined1 uVar1;
  int iVar2;
  short *psVar3;
  int *piVar4;
  int iVar5;
  undefined1 *puVar6;
  int iVar7;
  int *piVar8;
  bool bVar9;
  int local_40 [7];
  int local_24;
  int local_20 [7];
  int local_4;
  
  piVar4 = *(int **)(param_2 + 0x50);
  iVar2 = *(int *)(param_1 + 0x120) + 0x80;
  psVar3 = (short *)(param_3 + 0x30);
  param_1 = 6;
  piVar8 = local_40 + 1;
  do {
    if (((param_1 != 4) && (param_1 != 2)) && (param_1 != 0)) {
      if (((psVar3[-0x10] == 0) && (*psVar3 == 0)) && ((psVar3[0x10] == 0 && (psVar3[0x20] == 0))))
      {
        iVar5 = (int)psVar3[-0x18] * *piVar4 * 4;
        piVar8[-1] = iVar5;
      }
      else {
        iVar7 = (int)psVar3[0x10] * piVar4[0x28] * 0x1b37 +
                (int)psVar3[0x20] * piVar4[0x38] * -0x1712 + (int)psVar3[-0x10] * piVar4[8] * 0x73fc
                + (int)*psVar3 * piVar4[0x18] * -0x28ba;
        iVar5 = (int)psVar3[-0x18] * *piVar4 * 0x8000;
        piVar8[-1] = iVar7 + 0x1000 + iVar5 >> 0xd;
        iVar5 = (iVar5 - iVar7) + 0x1000 >> 0xd;
      }
      piVar8[7] = iVar5;
    }
    if (((param_1 != 5) && (param_1 != 3)) && (param_1 != 1)) {
      if ((((psVar3[-0xf] == 0) && (psVar3[1] == 0)) && (psVar3[0x11] == 0)) && (psVar3[0x21] == 0))
      {
        iVar5 = (int)psVar3[-0x17] * piVar4[1] * 4;
        *piVar8 = iVar5;
      }
      else {
        iVar7 = (int)psVar3[0x11] * piVar4[0x29] * 0x1b37 +
                (int)psVar3[0x21] * piVar4[0x39] * -0x1712 + (int)psVar3[1] * piVar4[0x19] * -0x28ba
                + (int)psVar3[-0xf] * piVar4[9] * 0x73fc;
        iVar5 = (int)psVar3[-0x17] * piVar4[1] * 0x8000;
        *piVar8 = iVar7 + 0x1000 + iVar5 >> 0xd;
        iVar5 = (iVar5 - iVar7) + 0x1000 >> 0xd;
      }
      piVar8[8] = iVar5;
    }
    if (((param_1 != 6) && (param_1 != 4)) && (param_1 != 2)) {
      if (((psVar3[-0xe] == 0) && (psVar3[2] == 0)) && ((psVar3[0x12] == 0 && (psVar3[0x22] == 0))))
      {
        iVar5 = (int)psVar3[-0x16] * piVar4[2] * 4;
        piVar8[1] = iVar5;
      }
      else {
        iVar7 = (int)psVar3[0x12] * piVar4[0x2a] * 0x1b37 +
                (int)psVar3[0x22] * piVar4[0x3a] * -0x1712 + (int)psVar3[2] * piVar4[0x1a] * -0x28ba
                + (int)psVar3[-0xe] * piVar4[10] * 0x73fc;
        iVar5 = (int)psVar3[-0x16] * piVar4[2] * 0x8000;
        piVar8[1] = iVar7 + 0x1000 + iVar5 >> 0xd;
        iVar5 = (iVar5 - iVar7) + 0x1000 >> 0xd;
      }
      piVar8[9] = iVar5;
    }
    if (((param_1 != 7) && (param_1 != 5)) && (param_1 != 3)) {
      if (((psVar3[-0xd] == 0) && (psVar3[3] == 0)) && ((psVar3[0x13] == 0 && (psVar3[0x23] == 0))))
      {
        iVar5 = (int)psVar3[-0x15] * piVar4[3] * 4;
        piVar8[2] = iVar5;
      }
      else {
        iVar7 = (int)psVar3[0x13] * piVar4[0x2b] * 0x1b37 +
                (int)psVar3[0x23] * piVar4[0x3b] * -0x1712 + (int)psVar3[3] * piVar4[0x1b] * -0x28ba
                + (int)psVar3[-0xd] * piVar4[0xb] * 0x73fc;
        iVar5 = (int)psVar3[-0x15] * piVar4[3] * 0x8000;
        piVar8[2] = iVar7 + 0x1000 + iVar5 >> 0xd;
        iVar5 = (iVar5 - iVar7) + 0x1000 >> 0xd;
      }
      piVar8[10] = iVar5;
    }
    iVar5 = param_1 + -2;
    psVar3 = psVar3 + 4;
    piVar4 = piVar4 + 4;
    piVar8 = piVar8 + 4;
    bVar9 = param_1 != 2;
    param_1 = param_1 + -4;
  } while (bVar9 && -1 < iVar5);
  puVar6 = (undefined1 *)(*param_4 + param_5);
  if (((local_40[1] == 0) && (local_40[3] == 0)) && ((local_40[5] == 0 && (local_24 == 0)))) {
    uVar1 = *(undefined1 *)((local_40[0] + 0x10 >> 5 & 0x3ffU) + iVar2);
    *puVar6 = uVar1;
  }
  else {
    iVar5 = local_40[1] * 0x73fc + local_40[3] * -0x28ba + local_40[5] * 0x1b37 + local_24 * -0x1712
    ;
    *puVar6 = *(undefined1 *)((iVar5 + 0x80000 + local_40[0] * 0x8000 >> 0x14 & 0x3ffU) + iVar2);
    uVar1 = *(undefined1 *)(((local_40[0] * 0x8000 - iVar5) + 0x80000 >> 0x14 & 0x3ffU) + iVar2);
  }
  puVar6[1] = uVar1;
  puVar6 = (undefined1 *)(param_4[1] + param_5);
  if ((((local_20[1] == 0) && (local_20[3] == 0)) && (local_20[5] == 0)) && (local_4 == 0)) {
    uVar1 = *(undefined1 *)((local_20[0] + 0x10 >> 5 & 0x3ffU) + iVar2);
    *puVar6 = uVar1;
    puVar6[1] = uVar1;
    return;
  }
  iVar5 = local_20[1] * 0x73fc + local_20[5] * 0x1b37 + local_4 * -0x1712 + local_20[3] * -0x28ba;
  *puVar6 = *(undefined1 *)((iVar5 + 0x80000 + local_20[0] * 0x8000 >> 0x14 & 0x3ffU) + iVar2);
  puVar6[1] = *(undefined1 *)(((local_20[0] * 0x8000 - iVar5) + 0x80000 >> 0x14 & 0x3ffU) + iVar2);
  return;
}



============================================================
DISASSEMBLY
============================================================
006e70d0 : SUB ESP,0x44
006e70d3 : MOV EAX,dword ptr [ESP + 0x48]
006e70d7 : MOV EAX,dword ptr [EAX + 0x120]
006e70dd : MOV ECX,dword ptr [ESP + 0x4c]
006e70e1 : MOV ECX,dword ptr [ECX + 0x50]
006e70e4 : SUB EAX,-0x80
006e70e7 : PUSH EBX
006e70e8 : MOV dword ptr [ESP + 0x4],EAX
006e70ec : MOV EAX,dword ptr [ESP + 0x54]
006e70f0 : PUSH EBP
006e70f1 : PUSH ESI
006e70f2 : MOV EDX,ECX
006e70f4 : ADD EAX,0x30
006e70f7 : MOV ESI,0x6
006e70fc : SUB EDX,ECX
006e70fe : PUSH EDI
006e70ff : MOV dword ptr [ESP + 0x58],ESI
006e7103 : LEA EDI,[ESP + EDX*0x1 + 0x18]
006e7107 : JMP 0x006e7110
006e7110 : LEA EDX,[ESI + 0x2]
006e7113 : CMP EDX,0x6
006e7116 : JZ 0x006e71c3
006e711c : CMP EDX,0x4
006e711f : JZ 0x006e71c3
006e7125 : CMP EDX,0x2
006e7128 : JZ 0x006e71c3
006e712e : MOVZX EBX,word ptr [EAX + -0x20]
006e7132 : TEST BX,BX
006e7135 : JNZ 0x006e7158
006e7137 : CMP word ptr [EAX],BX
006e713a : JNZ 0x006e7158
006e713c : CMP word ptr [EAX + 0x20],BX
006e7140 : JNZ 0x006e7158
006e7142 : CMP word ptr [EAX + 0x40],BX
006e7146 : JNZ 0x006e7158
006e7148 : MOVSX EDX,word ptr [EAX + -0x30]
006e714c : IMUL EDX,dword ptr [ECX]
006e714f : ADD EDX,EDX
006e7151 : ADD EDX,EDX
006e7153 : MOV dword ptr [EDI + -0x4],EDX
006e7156 : JMP 0x006e71c0
006e7158 : MOVSX ESI,word ptr [EAX + 0x20]
006e715c : IMUL ESI,dword ptr [ECX + 0xa0]
006e7163 : MOVSX EBP,word ptr [EAX + 0x40]
006e7167 : IMUL ESI,ESI,0x1b37
006e716d : IMUL EBP,dword ptr [ECX + 0xe0]
006e7174 : MOVSX EBX,BX
006e7177 : IMUL EBP,EBP,0x1712
006e717d : IMUL EBX,dword ptr [ECX + 0x20]
006e7181 : MOVSX EDX,word ptr [EAX + -0x30]
006e7185 : IMUL EBX,EBX,0x73fc
006e718b : IMUL EDX,dword ptr [ECX]
006e718e : SUB ESI,EBP
006e7190 : ADD ESI,EBX
006e7192 : MOVSX EBX,word ptr [EAX]
006e7195 : IMUL EBX,dword ptr [ECX + 0x60]
006e7199 : IMUL EBX,EBX,0x28ba
006e719f : SUB ESI,EBX
006e71a1 : SHL EDX,0xf
006e71a4 : LEA EBX,[ESI + EDX*0x1 + 0x1000]
006e71ab : SUB EDX,ESI
006e71ad : MOV ESI,dword ptr [ESP + 0x58]
006e71b1 : SAR EBX,0xd
006e71b4 : ADD EDX,0x1000
006e71ba : MOV dword ptr [EDI + -0x4],EBX
006e71bd : SAR EDX,0xd
006e71c0 : MOV dword ptr [EDI + 0x1c],EDX
006e71c3 : LEA EDX,[ESI + 0x1]
006e71c6 : CMP EDX,0x6
006e71c9 : JZ 0x006e7278
006e71cf : CMP EDX,0x4
006e71d2 : JZ 0x006e7278
006e71d8 : CMP EDX,0x2
006e71db : JZ 0x006e7278
006e71e1 : MOVZX EBX,word ptr [EAX + -0x1e]
006e71e5 : TEST BX,BX
006e71e8 : JNZ 0x006e720c
006e71ea : CMP word ptr [EAX + 0x2],BX
006e71ee : JNZ 0x006e720c
006e71f0 : CMP word ptr [EAX + 0x22],BX
006e71f4 : JNZ 0x006e720c
006e71f6 : CMP word ptr [EAX + 0x42],BX
006e71fa : JNZ 0x006e720c
006e71fc : MOVSX EDX,word ptr [EAX + -0x2e]
006e7200 : IMUL EDX,dword ptr [ECX + 0x4]
006e7204 : ADD EDX,EDX
006e7206 : ADD EDX,EDX
006e7208 : MOV dword ptr [EDI],EDX
006e720a : JMP 0x006e7275
006e720c : MOVSX ESI,word ptr [EAX + 0x22]
006e7210 : IMUL ESI,dword ptr [ECX + 0xa4]
006e7217 : MOVSX EBP,word ptr [EAX + 0x42]
006e721b : IMUL ESI,ESI,0x1b37
006e7221 : IMUL EBP,dword ptr [ECX + 0xe4]
006e7228 : MOVSX EDX,word ptr [EAX + -0x2e]
006e722c : IMUL EBP,EBP,0x1712
006e7232 : IMUL EDX,dword ptr [ECX + 0x4]
006e7236 : SUB ESI,EBP
006e7238 : MOVSX EBP,word ptr [EAX + 0x2]
006e723c : IMUL EBP,dword ptr [ECX + 0x64]
006e7240 : MOVSX EBX,BX
006e7243 : IMUL EBP,EBP,0x28ba
006e7249 : IMUL EBX,dword ptr [ECX + 0x24]
006e724d : IMUL EBX,EBX,0x73fc
006e7253 : SUB ESI,EBP
006e7255 : ADD ESI,EBX
006e7257 : SHL EDX,0xf
006e725a : LEA EBX,[ESI + EDX*0x1 + 0x1000]
006e7261 : SUB EDX,ESI
006e7263 : MOV ESI,dword ptr [ESP + 0x58]
006e7267 : SAR EBX,0xd
006e726a : ADD EDX,0x1000
006e7270 : MOV dword ptr [EDI],EBX
006e7272 : SAR EDX,0xd
006e7275 : MOV dword ptr [EDI + 0x20],EDX
006e7278 : CMP ESI,0x6
006e727b : JZ 0x006e732c
006e7281 : CMP ESI,0x4
006e7284 : JZ 0x006e732c
006e728a : CMP ESI,0x2
006e728d : JZ 0x006e732c
006e7293 : MOVZX EBX,word ptr [EAX + -0x1c]
006e7297 : TEST BX,BX
006e729a : JNZ 0x006e72bf
006e729c : CMP word ptr [EAX + 0x4],BX
006e72a0 : JNZ 0x006e72bf
006e72a2 : CMP word ptr [EAX + 0x24],BX
006e72a6 : JNZ 0x006e72bf
006e72a8 : CMP word ptr [EAX + 0x44],BX
006e72ac : JNZ 0x006e72bf
006e72ae : MOVSX EDX,word ptr [EAX + -0x2c]
006e72b2 : IMUL EDX,dword ptr [ECX + 0x8]
006e72b6 : ADD EDX,EDX
006e72b8 : ADD EDX,EDX
006e72ba : MOV dword ptr [EDI + 0x4],EDX
006e72bd : JMP 0x006e7329
006e72bf : MOVSX ESI,word ptr [EAX + 0x24]
006e72c3 : IMUL ESI,dword ptr [ECX + 0xa8]
006e72ca : MOVSX EBP,word ptr [EAX + 0x44]
006e72ce : IMUL ESI,ESI,0x1b37
006e72d4 : IMUL EBP,dword ptr [ECX + 0xe8]
006e72db : MOVSX EDX,word ptr [EAX + -0x2c]
006e72df : IMUL EBP,EBP,0x1712
006e72e5 : IMUL EDX,dword ptr [ECX + 0x8]
006e72e9 : SUB ESI,EBP
006e72eb : MOVSX EBP,word ptr [EAX + 0x4]
006e72ef : IMUL EBP,dword ptr [ECX + 0x68]
006e72f3 : MOVSX EBX,BX
006e72f6 : IMUL EBP,EBP,0x28ba
006e72fc : IMUL EBX,dword ptr [ECX + 0x28]
006e7300 : IMUL EBX,EBX,0x73fc
006e7306 : SUB ESI,EBP
006e7308 : ADD ESI,EBX
006e730a : SHL EDX,0xf
006e730d : LEA EBX,[ESI + EDX*0x1 + 0x1000]
006e7314 : SUB EDX,ESI
006e7316 : MOV ESI,dword ptr [ESP + 0x58]
006e731a : SAR EBX,0xd
006e731d : ADD EDX,0x1000
006e7323 : MOV dword ptr [EDI + 0x4],EBX
006e7326 : SAR EDX,0xd
006e7329 : MOV dword ptr [EDI + 0x24],EDX
006e732c : LEA EDX,[ESI + -0x1]
006e732f : CMP EDX,0x6
006e7332 : JZ 0x006e73e3
006e7338 : CMP EDX,0x4
006e733b : JZ 0x006e73e3
006e7341 : CMP EDX,0x2
006e7344 : JZ 0x006e73e3
006e734a : MOVZX EBX,word ptr [EAX + -0x1a]
006e734e : TEST BX,BX
006e7351 : JNZ 0x006e7376
006e7353 : CMP word ptr [EAX + 0x6],BX
006e7357 : JNZ 0x006e7376
006e7359 : CMP word ptr [EAX + 0x26],BX
006e735d : JNZ 0x006e7376
006e735f : CMP word ptr [EAX + 0x46],BX
006e7363 : JNZ 0x006e7376
006e7365 : MOVSX EDX,word ptr [EAX + -0x2a]
006e7369 : IMUL EDX,dword ptr [ECX + 0xc]
006e736d : ADD EDX,EDX
006e736f : ADD EDX,EDX
006e7371 : MOV dword ptr [EDI + 0x8],EDX
006e7374 : JMP 0x006e73e0
006e7376 : MOVSX ESI,word ptr [EAX + 0x26]
006e737a : IMUL ESI,dword ptr [ECX + 0xac]
006e7381 : MOVSX EBP,word ptr [EAX + 0x46]
006e7385 : IMUL ESI,ESI,0x1b37
006e738b : IMUL EBP,dword ptr [ECX + 0xec]
006e7392 : MOVSX EDX,word ptr [EAX + -0x2a]
006e7396 : IMUL EBP,EBP,0x1712
006e739c : IMUL EDX,dword ptr [ECX + 0xc]
006e73a0 : SUB ESI,EBP
006e73a2 : MOVSX EBP,word ptr [EAX + 0x6]
006e73a6 : IMUL EBP,dword ptr [ECX + 0x6c]
006e73aa : MOVSX EBX,BX
006e73ad : IMUL EBP,EBP,0x28ba
006e73b3 : IMUL EBX,dword ptr [ECX + 0x2c]
006e73b7 : IMUL EBX,EBX,0x73fc
006e73bd : SUB ESI,EBP
006e73bf : ADD ESI,EBX
006e73c1 : SHL EDX,0xf
006e73c4 : LEA EBX,[ESI + EDX*0x1 + 0x1000]
006e73cb : SUB EDX,ESI
006e73cd : MOV ESI,dword ptr [ESP + 0x58]
006e73d1 : SAR EBX,0xd
006e73d4 : ADD EDX,0x1000
006e73da : MOV dword ptr [EDI + 0x8],EBX
006e73dd : SAR EDX,0xd
006e73e0 : MOV dword ptr [EDI + 0x28],EDX
006e73e3 : SUB ESI,0x4
006e73e6 : LEA EDX,[ESI + 0x2]
006e73e9 : ADD EAX,0x8
006e73ec : ADD ECX,0x10
006e73ef : ADD EDI,0x10
006e73f2 : MOV dword ptr [ESP + 0x58],ESI
006e73f6 : TEST EDX,EDX
006e73f8 : JG 0x006e7110
006e73fe : MOV EBP,dword ptr [ESP + 0x64]
006e7402 : MOV EDX,dword ptr [EBP]
006e7405 : MOV ECX,dword ptr [ESP + 0x18]
006e7409 : ADD EDX,dword ptr [ESP + 0x68]
006e740d : MOV ESI,dword ptr [ESP + 0x30]
006e7411 : MOV EDI,dword ptr [ESP + 0x28]
006e7415 : MOV EBX,dword ptr [ESP + 0x20]
006e7419 : TEST ECX,ECX
006e741b : JNZ 0x006e7443
006e741d : TEST EBX,EBX
006e741f : JNZ 0x006e7443
006e7421 : TEST EDI,EDI
006e7423 : JNZ 0x006e7443
006e7425 : TEST ESI,ESI
006e7427 : JNZ 0x006e7443
006e7429 : MOV EAX,dword ptr [ESP + 0x14]
006e742d : MOV ECX,dword ptr [ESP + 0x10]
006e7431 : ADD EAX,0x10
006e7434 : SAR EAX,0x5
006e7437 : AND EAX,0x3ff
006e743c : MOV AL,byte ptr [EAX + ECX*0x1]
006e743f : MOV byte ptr [EDX],AL
006e7441 : JMP 0x006e7495
006e7443 : MOV EAX,dword ptr [ESP + 0x14]
006e7447 : IMUL ECX,ECX,0x73fc
006e744d : IMUL EBX,EBX,0x28ba
006e7453 : IMUL EDI,EDI,0x1b37
006e7459 : IMUL ESI,ESI,0x1712
006e745f : SUB ECX,EBX
006e7461 : ADD ECX,EDI
006e7463 : MOV EDI,dword ptr [ESP + 0x10]
006e7467 : SUB ECX,ESI
006e7469 : SHL EAX,0xf
006e746c : MOV ESI,ECX
006e746e : LEA ECX,[ESI + EAX*0x1 + 0x80000]
006e7475 : SUB EAX,ESI
006e7477 : SAR ECX,0x14
006e747a : ADD EAX,0x80000
006e747f : AND ECX,0x3ff
006e7485 : MOV CL,byte ptr [ECX + EDI*0x1]
006e7488 : SAR EAX,0x14
006e748b : AND EAX,0x3ff
006e7490 : MOV byte ptr [EDX],CL
006e7492 : MOV AL,byte ptr [EAX + EDI*0x1]
006e7495 : MOV ECX,dword ptr [ESP + 0x38]
006e7499 : MOV ESI,dword ptr [ESP + 0x50]
006e749d : MOV EDI,dword ptr [ESP + 0x48]
006e74a1 : MOV EBX,dword ptr [ESP + 0x40]
006e74a5 : MOV byte ptr [EDX + 0x1],AL
006e74a8 : MOV EDX,dword ptr [EBP + 0x4]
006e74ab : ADD EDX,dword ptr [ESP + 0x68]
006e74af : TEST ECX,ECX
006e74b1 : JNZ 0x006e74e3
006e74b3 : TEST EBX,EBX
006e74b5 : JNZ 0x006e74e3
006e74b7 : TEST EDI,EDI
006e74b9 : JNZ 0x006e74e3
006e74bb : TEST ESI,ESI
006e74bd : JNZ 0x006e74e3
006e74bf : MOV ECX,dword ptr [ESP + 0x34]
006e74c3 : MOV EAX,dword ptr [ESP + 0x10]
006e74c7 : ADD ECX,0x10
006e74ca : POP EDI
006e74cb : SAR ECX,0x5
006e74ce : AND ECX,0x3ff
006e74d4 : MOV AL,byte ptr [ECX + EAX*0x1]
006e74d7 : POP ESI
006e74d8 : POP EBP
006e74d9 : MOV byte ptr [EDX],AL
006e74db : MOV byte ptr [EDX + 0x1],AL
006e74de : POP EBX
006e74df : ADD ESP,0x44
006e74e2 : RET
006e74e3 : MOV EAX,dword ptr [ESP + 0x34]
006e74e7 : IMUL ECX,ECX,0x73fc
006e74ed : IMUL EDI,EDI,0x1b37
006e74f3 : IMUL ESI,ESI,0x1712
006e74f9 : IMUL EBX,EBX,0x28ba
006e74ff : ADD ECX,EDI
006e7501 : MOV EDI,dword ptr [ESP + 0x10]
006e7505 : SUB ECX,ESI
006e7507 : SUB ECX,EBX
006e7509 : SHL EAX,0xf
006e750c : MOV ESI,ECX
006e750e : LEA ECX,[ESI + EAX*0x1 + 0x80000]
006e7515 : SUB EAX,ESI
006e7517 : SAR ECX,0x14
006e751a : ADD EAX,0x80000
006e751f : AND ECX,0x3ff
006e7525 : MOV CL,byte ptr [ECX + EDI*0x1]
006e7528 : SAR EAX,0x14
006e752b : MOV byte ptr [EDX],CL
006e752d : AND EAX,0x3ff
006e7532 : MOV AL,byte ptr [EAX + EDI*0x1]
006e7535 : POP EDI
006e7536 : POP ESI
006e7537 : POP EBP
006e7538 : MOV byte ptr [EDX + 0x1],AL
006e753b : POP EBX
006e753c : ADD ESP,0x44
006e753f : RET

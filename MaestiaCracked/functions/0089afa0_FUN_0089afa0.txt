PROGRAM  : Maestia.exe
FUNCTION : FUN_0089afa0
ENTRY    : 0089afa0
BODY     : [[0089afa0, 0089b1d5] [0089b1e0, 0089b3f8] [0089b400, 0089b446]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0089afa0(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  uint uVar1;
  int *piVar2;
  undefined4 *puVar3;
  int in_ECX;
  int iVar4;
  undefined1 auStack_cc [4];
  uint local_c8;
  undefined4 local_c4;
  undefined4 local_c0;
  undefined4 local_bc;
  undefined4 local_b8;
  undefined4 local_b4;
  undefined4 local_b0;
  undefined1 local_ac [4];
  undefined2 uStack_a8;
  undefined4 uStack_98;
  uint uStack_94;
  undefined1 auStack_90 [4];
  int iStack_8c;
  undefined4 uStack_88;
  int iStack_84;
  undefined4 uStack_80;
  undefined4 uStack_7c;
  undefined4 uStack_78;
  undefined1 uStack_3b;
  undefined4 uStack_28;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b5fac2;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_cc;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xffffff28;
  ExceptionList = &local_14;
  if (*(uint *)(in_ECX + 0x314) < 2) {
    if ((*(int *)(in_ECX + 0x44c) != 0) && (*(short *)(*(int *)(in_ECX + 0x44c) + 0xe4) != 0)) {
      local_c8 = *(uint *)(in_ECX + 0x274);
      local_c4 = DAT_00da93ec;
      piVar2 = (int *)FUN_00a1a840(local_c8);
      if ((piVar2 != (int *)0x0) ||
         ((piVar2 = (int *)FUN_00a1a6d0(local_c8), piVar2 != (int *)0x0 ||
          (piVar2 = (int *)FUN_00a1a780(local_c8), piVar2 != (int *)0x0)))) {
        FUN_00406460(&DAT_00c46c04);
        local_c = 0;
        local_c0 = CONCAT31(local_c0._1_3_,*(undefined1 *)(in_ECX + 0xcc));
        local_c8 = CONCAT31(local_c8._1_3_,*(undefined1 *)(in_ECX + 0xda));
        local_bc = CONCAT31(local_bc._1_3_,*(undefined1 *)(in_ECX + 0xd8));
        local_c4 = CONCAT31(local_c4._1_3_,*(undefined1 *)(in_ECX + 0xd9));
        (**(code **)(*piVar2 + 0x2fc))
                  (*(undefined4 *)(in_ECX + 4),*(undefined4 *)(in_ECX + 0x2c4),local_bc,local_c8,
                   local_c4,local_ac,local_c0,param_3,uVar1);
        local_c = 0xffffffff;
        FUN_00406560();
        if ((char)param_3 == '\0') goto LAB_0089b421;
        FUN_0040e250(auStack_90);
        local_c = 1;
        uStack_88 = *(undefined4 *)(in_ECX + 0x1d4);
        auStack_90[0] = *(undefined1 *)(in_ECX + 0x1be);
        iStack_8c = *(int *)(in_ECX + 0xec);
        iStack_84 = piVar2[1];
        uStack_7c = *(undefined4 *)(in_ECX + 0x224);
        uStack_3b = *(undefined1 *)(in_ECX + 0xd9);
        uStack_80 = *(undefined4 *)(in_ECX + 4);
        uStack_78 = 0;
        if (*(char *)(in_ECX + 0xda) == '\x06') {
          uStack_28 = 0x17;
        }
        else if (iStack_8c == 0) {
          if ((*(int *)(in_ECX + 0x2c4) != 0) ||
             (uStack_28 = 0x14, *(char *)(in_ECX + 0xda) != '\x01')) {
            uStack_28 = 0;
          }
        }
        else {
          uStack_28 = 2;
        }
        FUN_00883670(DAT_017248e4);
        local_c = 0xffffffff;
        FUN_00406bd0(auStack_90);
      }
    }
  }
  else {
    local_c8 = 0;
    if (*(uint *)(in_ECX + 0x314) != 0) {
      puVar3 = (undefined4 *)(in_ECX + 0x2c4);
      do {
        if ((*(int *)(in_ECX + 0x44c) != 0) && (*(short *)(*(int *)(in_ECX + 0x44c) + 0xe4) != 0)) {
          local_c4 = puVar3[-0x14];
          local_c0 = DAT_00da93ec;
          piVar2 = (int *)FUN_00a1a840(local_c4);
          if ((piVar2 != (int *)0x0) ||
             ((piVar2 = (int *)FUN_00a1a6d0(local_c4), piVar2 != (int *)0x0 ||
              (piVar2 = (int *)FUN_00a1a780(local_c4), piVar2 != (int *)0x0)))) {
            FUN_00406460(&DAT_00c46c08);
            local_c = 2;
            local_bc = CONCAT31(local_bc._1_3_,*(undefined1 *)(in_ECX + 0xcc));
            local_b4 = CONCAT31(local_b4._1_3_,*(undefined1 *)(in_ECX + 0xd8));
            local_b8 = CONCAT31(local_b8._1_3_,*(undefined1 *)(in_ECX + 0xd9));
            local_b0 = CONCAT31(local_b0._1_3_,*(undefined1 *)(in_ECX + 0xda));
            (**(code **)(*piVar2 + 0x2fc))
                      (*(undefined4 *)(in_ECX + 4),*puVar3,local_b4,local_b0,local_b8,local_ac,
                       local_bc,param_3);
            local_c = 0xffffffff;
            if (7 < uStack_94) {
                    /* WARNING: Subroutine does not return */
              FUN_006f04e0();
            }
            uStack_94 = 7;
            uStack_98 = 0;
            uStack_a8 = 0;
            if ((char)param_3 != '\0') {
              FUN_0040e250(auStack_90);
              local_c = 3;
              auStack_90[0] = *(undefined1 *)(in_ECX + 0x1be + local_c8);
              uStack_88 = puVar3[-0x3c];
              iStack_8c = *(int *)(in_ECX + 0xec);
              iStack_84 = piVar2[1];
              uStack_80 = *(undefined4 *)(in_ECX + 4);
              uStack_3b = *(undefined1 *)(in_ECX + 0xd9);
              uStack_7c = puVar3[-0x28];
              uStack_78 = 0;
              if (*(char *)(in_ECX + 0xda) == '\x06') {
                uStack_28 = 0x17;
              }
              else if (iStack_8c == 0) {
                if ((*(int *)(in_ECX + 0x2c4) != 0) ||
                   (uStack_28 = 0x14, *(char *)(in_ECX + 0xda) != '\x01')) {
                  uStack_28 = 0;
                }
              }
              else {
                uStack_28 = 2;
              }
              FUN_00883670(DAT_017248e4);
              local_c = 0xffffffff;
              FUN_00406bd0(auStack_90);
            }
          }
        }
        local_c8 = local_c8 + 1;
        puVar3 = puVar3 + 1;
      } while (local_c8 < *(uint *)(in_ECX + 0x314));
    }
  }
  if ((char)param_3 != '\0') {
    *(undefined4 *)(in_ECX + 0x314) = 0;
    iVar4 = 0;
    puVar3 = (undefined4 *)(in_ECX + 0x2c4);
    do {
      puVar3[-0x14] = 0;
      *puVar3 = 0;
      puVar3[-0x28] = 0;
      puVar3[-0x3c] = 0;
      *(undefined1 *)(in_ECX + 0x1be + iVar4) = 0xff;
      iVar4 = iVar4 + 1;
      puVar3 = puVar3 + 1;
    } while (iVar4 < 0x14);
  }
LAB_0089b421:
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_cc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0089afa0 : PUSH EBP
0089afa1 : MOV EBP,ESP
0089afa3 : AND ESP,0xfffffff8
0089afa6 : PUSH -0x1
0089afa8 : PUSH 0xb5fac2
0089afad : MOV EAX,FS:[0x0]
0089afb3 : PUSH EAX
0089afb4 : SUB ESP,0xb8
0089afba : MOV EAX,[0x00d66fa0]
0089afbf : XOR EAX,ESP
0089afc1 : MOV dword ptr [ESP + 0xb0],EAX
0089afc8 : PUSH EBX
0089afc9 : PUSH ESI
0089afca : PUSH EDI
0089afcb : MOV EAX,[0x00d66fa0]
0089afd0 : XOR EAX,ESP
0089afd2 : PUSH EAX
0089afd3 : LEA EAX,[ESP + 0xc8]
0089afda : MOV FS:[0x0],EAX
0089afe0 : MOV ESI,ECX
0089afe2 : MOV EAX,dword ptr [ESI + 0x314]
0089afe8 : CMP EAX,0x2
0089afeb : JNC 0x0089b1be
0089aff1 : MOV EAX,dword ptr [ESI + 0x44c]
0089aff7 : XOR EBX,EBX
0089aff9 : CMP EAX,EBX
0089affb : JZ 0x0089b3e1
0089b001 : MOVZX EAX,word ptr [EAX + 0xe4]
0089b008 : CMP AX,BX
0089b00b : JZ 0x0089b3e1
0089b011 : MOV EAX,dword ptr [ESI + 0x274]
0089b017 : MOV ECX,dword ptr [0x00da93ec]
0089b01d : PUSH EAX
0089b01e : MOV dword ptr [ESP + 0x1c],ECX
0089b022 : MOV dword ptr [ESP + 0x18],EAX
0089b026 : CALL 0x00a1a840
0089b02b : MOV EDI,EAX
0089b02d : CMP EDI,EBX
0089b02f : JNZ 0x0089b05d
0089b031 : MOV EAX,dword ptr [ESP + 0x14]
0089b035 : MOV ECX,dword ptr [ESP + 0x18]
0089b039 : PUSH EAX
0089b03a : CALL 0x00a1a6d0
0089b03f : MOV EDI,EAX
0089b041 : CMP EDI,EBX
0089b043 : JNZ 0x0089b05d
0089b045 : MOV ECX,dword ptr [ESP + 0x14]
0089b049 : PUSH ECX
0089b04a : MOV ECX,dword ptr [ESP + 0x1c]
0089b04e : CALL 0x00a1a780
0089b053 : MOV EDI,EAX
0089b055 : CMP EDI,EBX
0089b057 : JZ 0x0089b3e1
0089b05d : PUSH 0xc46c04
0089b062 : LEA ECX,[ESP + 0x34]
0089b066 : CALL 0x00406460
0089b06b : MOV dword ptr [ESP + 0xd0],EBX
0089b072 : MOVZX EDX,byte ptr [ESI + 0xcc]
0089b079 : MOV CL,byte ptr [ESI + 0xda]
0089b07f : MOV AL,byte ptr [ESI + 0xd9]
0089b085 : MOV byte ptr [ESP + 0x1c],DL
0089b089 : MOVZX EDX,byte ptr [ESI + 0xd8]
0089b090 : MOV byte ptr [ESP + 0x14],CL
0089b094 : MOV ECX,dword ptr [EBP + 0x10]
0089b097 : PUSH ECX
0089b098 : MOV byte ptr [ESP + 0x24],DL
0089b09c : MOV EDX,dword ptr [ESP + 0x20]
0089b0a0 : PUSH EDX
0089b0a1 : MOV byte ptr [ESP + 0x20],AL
0089b0a5 : MOV EDX,dword ptr [ESP + 0x20]
0089b0a9 : MOV EAX,dword ptr [EDI]
0089b0ab : MOV EAX,dword ptr [EAX + 0x2fc]
0089b0b1 : LEA ECX,[ESP + 0x38]
0089b0b5 : PUSH ECX
0089b0b6 : MOV ECX,dword ptr [ESP + 0x20]
0089b0ba : PUSH EDX
0089b0bb : MOV EDX,dword ptr [ESP + 0x30]
0089b0bf : PUSH ECX
0089b0c0 : MOV ECX,dword ptr [ESI + 0x2c4]
0089b0c6 : PUSH EDX
0089b0c7 : MOV EDX,dword ptr [ESI + 0x4]
0089b0ca : PUSH ECX
0089b0cb : PUSH EDX
0089b0cc : MOV ECX,EDI
0089b0ce : CALL EAX
0089b0d0 : FSTP ST0
0089b0d2 : MOV dword ptr [ESP + 0xd0],0xffffffff
0089b0dd : LEA ECX,[ESP + 0x30]
0089b0e1 : CALL 0x00406560
0089b0e6 : CMP byte ptr [EBP + 0x10],0x0
0089b0ea : JZ 0x0089b421
0089b0f0 : LEA ECX,[ESP + 0x4c]
0089b0f4 : PUSH ECX
0089b0f5 : CALL 0x0040e250
0089b0fa : MOV dword ptr [ESP + 0xd0],0x1
0089b105 : MOV ECX,dword ptr [ESI + 0x1d4]
0089b10b : MOV DL,byte ptr [ESI + 0x1be]
0089b111 : MOV EAX,dword ptr [ESI + 0xec]
0089b117 : MOV EDI,dword ptr [EDI + 0x4]
0089b11a : MOV dword ptr [ESP + 0x54],ECX
0089b11e : MOV ECX,dword ptr [ESI + 0x224]
0089b124 : MOV dword ptr [ESP + 0x60],ECX
0089b128 : MOV CL,byte ptr [ESI + 0xd9]
0089b12e : MOV byte ptr [ESP + 0xa1],CL
0089b135 : MOV CL,byte ptr [ESI + 0xda]
0089b13b : MOV byte ptr [ESP + 0x4c],DL
0089b13f : MOV EDX,dword ptr [ESI + 0x4]
0089b142 : MOV dword ptr [ESP + 0x50],EAX
0089b146 : MOV dword ptr [ESP + 0x58],EDI
0089b14a : MOV dword ptr [ESP + 0x5c],EDX
0089b14e : MOV dword ptr [ESP + 0x64],EBX
0089b152 : CMP CL,0x6
0089b155 : JNZ 0x0089b164
0089b157 : MOV dword ptr [ESP + 0xb4],0x17
0089b162 : JMP 0x0089b194
0089b164 : CMP EAX,EBX
0089b166 : JZ 0x0089b175
0089b168 : MOV dword ptr [ESP + 0xb4],0x2
0089b173 : JMP 0x0089b194
0089b175 : CMP dword ptr [ESI + 0x2c4],EBX
0089b17b : JA 0x0089b18d
0089b17d : MOV dword ptr [ESP + 0xb4],0x14
0089b188 : CMP CL,0x1
0089b18b : JZ 0x0089b194
0089b18d : MOV dword ptr [ESP + 0xb4],EBX
0089b194 : MOV EDX,dword ptr [0x017248e4]
0089b19a : PUSH EDX
0089b19b : LEA ECX,[ESP + 0x50]
0089b19f : CALL 0x00883670
0089b1a4 : MOV dword ptr [ESP + 0xd0],0xffffffff
0089b1af : LEA EAX,[ESP + 0x4c]
0089b1b3 : PUSH EAX
0089b1b4 : CALL 0x00406bd0
0089b1b9 : JMP 0x0089b3e1
0089b1be : MOV dword ptr [ESP + 0x14],0x0
0089b1c6 : TEST EAX,EAX
0089b1c8 : JBE 0x0089b3df
0089b1ce : LEA EBX,[ESI + 0x2c4]
0089b1d4 : JMP 0x0089b1e0
0089b1e0 : MOV EAX,dword ptr [ESI + 0x44c]
0089b1e6 : TEST EAX,EAX
0089b1e8 : JZ 0x0089b3c7
0089b1ee : MOVZX EAX,word ptr [EAX + 0xe4]
0089b1f5 : TEST AX,AX
0089b1f8 : JZ 0x0089b3c7
0089b1fe : MOV EAX,dword ptr [EBX + -0x50]
0089b201 : MOV ECX,dword ptr [0x00da93ec]
0089b207 : PUSH EAX
0089b208 : MOV dword ptr [ESP + 0x20],ECX
0089b20c : MOV dword ptr [ESP + 0x1c],EAX
0089b210 : CALL 0x00a1a840
0089b215 : MOV EDI,EAX
0089b217 : TEST EDI,EDI
0089b219 : JNZ 0x0089b247
0089b21b : MOV ECX,dword ptr [ESP + 0x18]
0089b21f : PUSH ECX
0089b220 : MOV ECX,dword ptr [ESP + 0x20]
0089b224 : CALL 0x00a1a6d0
0089b229 : MOV EDI,EAX
0089b22b : TEST EDI,EDI
0089b22d : JNZ 0x0089b247
0089b22f : MOV EDX,dword ptr [ESP + 0x18]
0089b233 : MOV ECX,dword ptr [ESP + 0x1c]
0089b237 : PUSH EDX
0089b238 : CALL 0x00a1a780
0089b23d : MOV EDI,EAX
0089b23f : TEST EDI,EDI
0089b241 : JZ 0x0089b3c7
0089b247 : PUSH 0xc46c08
0089b24c : LEA ECX,[ESP + 0x34]
0089b250 : CALL 0x00406460
0089b255 : MOV dword ptr [ESP + 0xd0],0x2
0089b260 : MOVZX EAX,byte ptr [ESI + 0xcc]
0089b267 : MOV CL,byte ptr [ESI + 0xd9]
0089b26d : MOV DL,byte ptr [ESI + 0xda]
0089b273 : MOV byte ptr [ESP + 0x20],AL
0089b277 : MOVZX EAX,byte ptr [ESI + 0xd8]
0089b27e : MOV byte ptr [ESP + 0x28],AL
0089b282 : MOV EAX,dword ptr [EBP + 0x10]
0089b285 : PUSH EAX
0089b286 : MOV byte ptr [ESP + 0x28],CL
0089b28a : MOV ECX,dword ptr [ESP + 0x24]
0089b28e : PUSH ECX
0089b28f : MOV ECX,dword ptr [ESP + 0x2c]
0089b293 : MOV byte ptr [ESP + 0x34],DL
0089b297 : MOV EDX,dword ptr [EDI]
0089b299 : MOV EDX,dword ptr [EDX + 0x2fc]
0089b29f : LEA EAX,[ESP + 0x38]
0089b2a3 : PUSH EAX
0089b2a4 : MOV EAX,dword ptr [ESP + 0x38]
0089b2a8 : PUSH ECX
0089b2a9 : MOV ECX,dword ptr [ESP + 0x38]
0089b2ad : PUSH EAX
0089b2ae : MOV EAX,dword ptr [EBX]
0089b2b0 : PUSH ECX
0089b2b1 : MOV ECX,dword ptr [ESI + 0x4]
0089b2b4 : PUSH EAX
0089b2b5 : PUSH ECX
0089b2b6 : MOV ECX,EDI
0089b2b8 : CALL EDX
0089b2ba : FSTP ST0
0089b2bc : MOV dword ptr [ESP + 0xd0],0xffffffff
0089b2c7 : CMP dword ptr [ESP + 0x48],0x8
0089b2cc : JC 0x0089b2d7
0089b2ce : MOV ECX,dword ptr [ESP + 0x34]
0089b2d2 : CALL 0x006f04e0
0089b2d7 : XOR EAX,EAX
0089b2d9 : MOV dword ptr [ESP + 0x48],0x7
0089b2e1 : MOV dword ptr [ESP + 0x44],0x0
0089b2e9 : MOV word ptr [ESP + 0x34],AX
0089b2ee : CMP byte ptr [EBP + 0x10],AL
0089b2f1 : JZ 0x0089b3c7
0089b2f7 : LEA ECX,[ESP + 0x4c]
0089b2fb : PUSH ECX
0089b2fc : CALL 0x0040e250
0089b301 : MOV dword ptr [ESP + 0xd0],0x3
0089b30c : MOV EDX,dword ptr [ESP + 0x14]
0089b310 : MOVZX ECX,byte ptr [ESI + EDX*0x1 + 0x1be]
0089b318 : MOV EDX,dword ptr [EBX + 0xffffff10]
0089b31e : MOV EAX,dword ptr [ESI + 0xec]
0089b324 : MOV EDI,dword ptr [EDI + 0x4]
0089b327 : MOV byte ptr [ESP + 0x4c],CL
0089b32b : MOV ECX,dword ptr [ESI + 0x4]
0089b32e : MOV dword ptr [ESP + 0x5c],ECX
0089b332 : MOV CL,byte ptr [ESI + 0xd9]
0089b338 : MOV dword ptr [ESP + 0x54],EDX
0089b33c : MOV EDX,dword ptr [EBX + 0xffffff60]
0089b342 : MOV byte ptr [ESP + 0xa1],CL
0089b349 : MOV CL,byte ptr [ESI + 0xda]
0089b34f : MOV dword ptr [ESP + 0x60],EDX
0089b353 : XOR EDX,EDX
0089b355 : MOV dword ptr [ESP + 0x50],EAX
0089b359 : MOV dword ptr [ESP + 0x58],EDI
0089b35d : MOV dword ptr [ESP + 0x64],EDX
0089b361 : CMP CL,0x6
0089b364 : JNZ 0x0089b373
0089b366 : MOV dword ptr [ESP + 0xb4],0x17
0089b371 : JMP 0x0089b3a3
0089b373 : CMP EAX,EDX
0089b375 : JZ 0x0089b384
0089b377 : MOV dword ptr [ESP + 0xb4],0x2
0089b382 : JMP 0x0089b3a3
0089b384 : CMP dword ptr [ESI + 0x2c4],EDX
0089b38a : JA 0x0089b39c
0089b38c : MOV dword ptr [ESP + 0xb4],0x14
0089b397 : CMP CL,0x1
0089b39a : JZ 0x0089b3a3
0089b39c : MOV dword ptr [ESP + 0xb4],EDX
0089b3a3 : MOV EAX,[0x017248e4]
0089b3a8 : PUSH EAX
0089b3a9 : LEA ECX,[ESP + 0x50]
0089b3ad : CALL 0x00883670
0089b3b2 : MOV dword ptr [ESP + 0xd0],0xffffffff
0089b3bd : LEA ECX,[ESP + 0x4c]
0089b3c1 : PUSH ECX
0089b3c2 : CALL 0x00406bd0
0089b3c7 : MOV EAX,dword ptr [ESP + 0x14]
0089b3cb : INC EAX
0089b3cc : ADD EBX,0x4
0089b3cf : MOV dword ptr [ESP + 0x14],EAX
0089b3d3 : CMP EAX,dword ptr [ESI + 0x314]
0089b3d9 : JC 0x0089b1e0
0089b3df : XOR EBX,EBX
0089b3e1 : CMP byte ptr [EBP + 0x10],0x0
0089b3e5 : JZ 0x0089b421
0089b3e7 : MOV dword ptr [ESI + 0x314],EBX
0089b3ed : XOR ECX,ECX
0089b3ef : LEA EAX,[ESI + 0x2c4]
0089b3f5 : MOV DL,0xff
0089b3f7 : JMP 0x0089b400
0089b400 : MOV dword ptr [EAX + -0x50],EBX
0089b403 : MOV dword ptr [EAX],EBX
0089b405 : MOV dword ptr [EAX + 0xffffff60],EBX
0089b40b : MOV dword ptr [EAX + 0xffffff10],EBX
0089b411 : MOV byte ptr [ESI + ECX*0x1 + 0x1be],DL
0089b418 : INC ECX
0089b419 : ADD EAX,0x4
0089b41c : CMP ECX,0x14
0089b41f : JL 0x0089b400
0089b421 : MOV ECX,dword ptr [ESP + 0xc8]
0089b428 : MOV dword ptr FS:[0x0],ECX
0089b42f : POP ECX
0089b430 : POP EDI
0089b431 : POP ESI
0089b432 : POP EBX
0089b433 : MOV ECX,dword ptr [ESP + 0xb0]
0089b43a : XOR ECX,ESP
0089b43c : CALL 0x00633e6b
0089b441 : MOV ESP,EBP
0089b443 : POP EBP
0089b444 : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_008be8a0
ENTRY    : 008be8a0
BODY     : [[008be8a0, 008bed3d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008be8a0(int *param_1)

{
  uint uVar1;
  int *piVar2;
  int *piVar3;
  int iVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  int *in_ECX;
  uint local_5c;
  undefined1 local_58 [4];
  undefined2 local_54;
  undefined4 local_44;
  uint local_40;
  int local_3c;
  int *local_38;
  int *local_34;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b51422;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_38 = in_ECX;
  local_14 = uVar1;
  if (*(char *)((int)in_ECX + 10) == '\0') {
    piVar2 = (int *)FUN_009f2a00(in_ECX[1]);
    if (piVar2 != (int *)0x0) {
      FUN_00a07b80();
      (**(code **)(*piVar2 + 0x58))(0);
      local_18 = 7;
      local_1c = 0;
      local_2c = 0;
      local_8 = 3;
      (**(code **)(*param_1 + 0x60))(piVar2,local_30);
      (**(code **)(*param_1 + 0x48))(local_30,0,0);
      local_8 = 0xffffffff;
      if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_18 = 7;
      local_1c = 0;
      local_2c = 0;
    }
    FUN_00406460(L"IDS_UPGRADE_FAILED");
    local_8 = 4;
    local_34 = *(int **)(*DAT_00da9894 + 0x1a8);
    uVar5 = FUN_0081d120(local_58);
    local_8._0_1_ = 5;
    (**(code **)(*local_34 + 0x44))(uVar5,3);
    local_8 = CONCAT31(local_8._1_3_,4);
    if (7 < local_5c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_8 = 0xffffffff;
    if (7 < local_40) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_40 = 7;
    local_44 = 0;
    local_54 = 0;
    FUN_008bd640();
    iVar4 = *DAT_00da9894;
    if ((iVar4 != 0) && (*(int *)(iVar4 + 0x114) != 0)) {
      (**(code **)(**(int **)(iVar4 + 0x114) + 4))
                (*(int **)(iVar4 + 0x114),"TransferPlayEffect",&DAT_00c4e160,0);
    }
    FUN_008a1050(0x33);
    iVar4 = DAT_00d7c54c;
    local_34 = *(int **)((int)local_38 + 0xb);
    FUN_004437f0(&local_34);
    if (local_3c == *(int *)(iVar4 + 0x44)) {
      local_34 = (int *)0x0;
LAB_008bec2d:
      iVar4 = (**(code **)(*param_1 + 0x74))(1,0);
      if ((iVar4 == 0) || (local_3c = FUN_004049b0(*(undefined4 *)(iVar4 + 0x10)), local_3c == 0))
      goto LAB_008bed14;
      uVar5 = FUN_00a08b70();
      if (*(int *)(*DAT_00da9894 + 700) != 0) {
        uVar6 = FUN_00824a20(DAT_0172491c,0);
        local_8 = 6;
        FUN_00968ef0(uVar6,*(undefined2 *)(iVar4 + 0xac),uVar5,3);
        local_8 = 0xffffffff;
        FUN_00406560();
      }
    }
    else {
      local_34 = *(int **)(local_3c + 0x10);
      if (local_34 == (int *)0x0) goto LAB_008bec2d;
    }
    piVar3 = local_34;
    piVar2 = local_38;
    if (((*(byte *)((int)local_38 + 0xf) < 7) || (local_34 == (int *)0x0)) ||
       (*(int *)(*DAT_00da9894 + 700) == 0)) goto LAB_008bed14;
    uVar5 = FUN_00824a20(DAT_0172491c,0);
    local_8 = 7;
    FUN_00968ef0(uVar5,*(undefined1 *)((int)piVar2 + 0xf),piVar3[0x14],4);
  }
  else {
    if (*(char *)((int)in_ECX + 10) != '\x01') goto LAB_008bed14;
    piVar2 = (int *)FUN_009f2a00(in_ECX[1]);
    if (piVar2 == (int *)0x0) {
LAB_008bea5d:
      if ((*DAT_00da9894 != 0) && (piVar2 = *(int **)(*DAT_00da9894 + 0x114), piVar2 != (int *)0x0))
      {
        (**(code **)(*piVar2 + 4))(piVar2,"TransferPlayEffect",&DAT_00c4e120,1);
      }
      FUN_008a1050(0x32);
      goto LAB_008bed14;
    }
    FUN_00a07b80(uVar1);
    (**(code **)(*piVar2 + 0x58))(0);
    local_18 = 7;
    local_1c = 0;
    local_2c = 0;
    local_8 = 0;
    (**(code **)(*param_1 + 0x60))(piVar2,local_30);
    (**(code **)(*param_1 + 0x48))(local_30,0,0);
    piVar3 = (int *)FUN_004049b0(piVar2[4]);
    if (piVar3 != (int *)0x0) {
      iVar4 = (**(code **)(*piVar3 + 0x3c))();
      if ((iVar4 != 0) && (iVar4 = (**(code **)(*piVar3 + 0x40))(), iVar4 == 0)) {
        FUN_008bd640();
      }
      local_38 = piVar3 + 6;
      iVar4 = FUN_00824a20(DAT_0172491c,0);
      local_8._0_1_ = 1;
      if (*(uint *)(iVar4 + 0x18) < 8) {
        iVar4 = iVar4 + 4;
      }
      else {
        iVar4 = *(int *)(iVar4 + 4);
      }
      FUN_009adfc0(*(undefined4 *)(*DAT_00da9894 + 0x1a8),0x13,iVar4);
      local_8._0_1_ = 0;
      FUN_00406560();
      if ((6 < *(ushort *)(piVar2 + 0x2b)) &&
         (uVar5 = FUN_00a08b70(), *(int *)(*DAT_00da9894 + 700) != 0)) {
        uVar6 = FUN_00824a20(DAT_0172491c,0);
        local_8._0_1_ = 2;
        FUN_00968ef0(uVar6,(short)piVar2[0x2b],uVar5,2);
        local_8 = (uint)local_8._1_3_ << 8;
        FUN_00406560();
      }
      local_8 = 0xffffffff;
      FUN_00406560();
      goto LAB_008bea5d;
    }
  }
  local_8 = 0xffffffff;
  FUN_00406560();
LAB_008bed14:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008be8a0 : PUSH EBP
008be8a1 : MOV EBP,ESP
008be8a3 : PUSH -0x1
008be8a5 : PUSH 0xb51422
008be8aa : MOV EAX,FS:[0x0]
008be8b0 : PUSH EAX
008be8b1 : SUB ESP,0xd8
008be8b7 : MOV EAX,[0x00d66fa0]
008be8bc : XOR EAX,EBP
008be8be : MOV dword ptr [EBP + -0x10],EAX
008be8c1 : PUSH EBX
008be8c2 : PUSH ESI
008be8c3 : PUSH EDI
008be8c4 : PUSH EAX
008be8c5 : LEA EAX,[EBP + -0xc]
008be8c8 : MOV FS:[0x0],EAX
008be8ce : MOV EBX,dword ptr [EBP + 0x8]
008be8d1 : MOV EDI,ECX
008be8d3 : MOVZX EAX,byte ptr [EDI + 0xa]
008be8d7 : SUB EAX,0x0
008be8da : MOV dword ptr [EBP + -0x34],EDI
008be8dd : JZ 0x008bea9c
008be8e3 : SUB EAX,0x1
008be8e6 : JNZ 0x008bed14
008be8ec : MOV EAX,dword ptr [EDI + 0x4]
008be8ef : MOV ECX,dword ptr [0x017247f0]
008be8f5 : PUSH EAX
008be8f6 : CALL 0x009f2a00
008be8fb : MOV EDI,EAX
008be8fd : TEST EDI,EDI
008be8ff : JZ 0x008bea5d
008be905 : MOV ECX,dword ptr [EBP + -0x34]
008be908 : MOV AX,word ptr [ECX + 0x8]
008be90c : MOV ESI,EDI
008be90e : CALL 0x00a07b80
008be913 : MOV EDX,dword ptr [EDI]
008be915 : MOV EAX,dword ptr [EDX + 0x58]
008be918 : XOR ESI,ESI
008be91a : PUSH ESI
008be91b : MOV ECX,EDI
008be91d : CALL EAX
008be91f : XOR ECX,ECX
008be921 : MOV dword ptr [EBP + -0x14],0x7
008be928 : MOV dword ptr [EBP + -0x18],ESI
008be92b : MOV word ptr [EBP + -0x28],CX
008be92f : MOV dword ptr [EBP + -0x4],ESI
008be932 : MOV EDX,dword ptr [EBX]
008be934 : MOV EDX,dword ptr [EDX + 0x60]
008be937 : LEA EAX,[EBP + -0x2c]
008be93a : PUSH EAX
008be93b : PUSH EDI
008be93c : MOV ECX,EBX
008be93e : CALL EDX
008be940 : MOV EAX,dword ptr [EBX]
008be942 : MOV EDX,dword ptr [EAX + 0x48]
008be945 : PUSH ESI
008be946 : PUSH ESI
008be947 : LEA ECX,[EBP + -0x2c]
008be94a : PUSH ECX
008be94b : MOV ECX,EBX
008be94d : CALL EDX
008be94f : MOV EAX,dword ptr [EDI + 0x10]
008be952 : PUSH EAX
008be953 : CALL 0x004049b0
008be958 : MOV ESI,EAX
008be95a : ADD ESP,0x4
008be95d : TEST ESI,ESI
008be95f : JZ 0x008be9aa
008be961 : MOV EAX,dword ptr [ESI]
008be963 : MOV EDX,dword ptr [EAX + 0x3c]
008be966 : MOV ECX,ESI
008be968 : CALL EDX
008be96a : TEST EAX,EAX
008be96c : JZ 0x008be982
008be96e : MOV EAX,dword ptr [ESI]
008be970 : MOV EDX,dword ptr [EAX + 0x40]
008be973 : MOV ECX,ESI
008be975 : CALL EDX
008be977 : TEST EAX,EAX
008be979 : JNZ 0x008be982
008be97b : MOV EAX,EBX
008be97d : CALL 0x008bd640
008be982 : MOV EAX,[0x0172491c]
008be987 : LEA EDX,[ESI + 0x18]
008be98a : PUSH 0x0
008be98c : PUSH EAX
008be98d : LEA ESI,[EBP + 0xffffff3c]
008be993 : MOV dword ptr [EBP + -0x34],EDX
008be996 : CALL 0x00824a20
008be99b : MOV byte ptr [EBP + -0x4],0x1
008be99f : CMP dword ptr [EAX + 0x18],0x8
008be9a3 : JC 0x008be9b9
008be9a5 : MOV ECX,dword ptr [EAX + 0x4]
008be9a8 : JMP 0x008be9bc
008be9aa : MOV dword ptr [EBP + -0x4],0xffffffff
008be9b1 : LEA ECX,[EBP + -0x2c]
008be9b4 : JMP 0x008bed0f
008be9b9 : LEA ECX,[EAX + 0x4]
008be9bc : MOV EDX,dword ptr [0x00da9894]
008be9c2 : MOV EAX,dword ptr [EDX]
008be9c4 : MOV EAX,dword ptr [EAX + 0x1a8]
008be9ca : PUSH ECX
008be9cb : PUSH 0x13
008be9cd : PUSH EAX
008be9ce : MOV ECX,0xc4e0f8
008be9d3 : CALL 0x009adfc0
008be9d8 : ADD ESP,0xc
008be9db : MOV byte ptr [EBP + -0x4],0x0
008be9df : LEA ECX,[EBP + 0xffffff3c]
008be9e5 : CALL 0x00406560
008be9ea : MOVZX EAX,word ptr [EDI + 0xac]
008be9f1 : MOV ECX,0x7
008be9f6 : CMP CX,AX
008be9f9 : JA 0x008bea4e
008be9fb : MOV ECX,EDI
008be9fd : CALL 0x00a08b70
008bea02 : MOV EDX,dword ptr [0x00da9894]
008bea08 : MOV EBX,EAX
008bea0a : MOV EAX,dword ptr [EDX]
008bea0c : CMP dword ptr [EAX + 0x2bc],0x0
008bea13 : JZ 0x008bea4e
008bea15 : MOV EAX,[0x0172491c]
008bea1a : MOV EDX,dword ptr [EBP + -0x34]
008bea1d : PUSH 0x0
008bea1f : PUSH EAX
008bea20 : LEA ESI,[EBP + 0xffffff74]
008bea26 : CALL 0x00824a20
008bea2b : MOV byte ptr [EBP + -0x4],0x2
008bea2f : MOVZX ECX,word ptr [EDI + 0xac]
008bea36 : PUSH 0x2
008bea38 : MOVZX ECX,CX
008bea3b : PUSH EBX
008bea3c : PUSH ECX
008bea3d : PUSH EAX
008bea3e : CALL 0x00968ef0
008bea43 : MOV byte ptr [EBP + -0x4],0x0
008bea47 : MOV ECX,ESI
008bea49 : CALL 0x00406560
008bea4e : MOV dword ptr [EBP + -0x4],0xffffffff
008bea55 : LEA ECX,[EBP + -0x2c]
008bea58 : CALL 0x00406560
008bea5d : MOV EDX,dword ptr [0x00da9894]
008bea63 : MOV EAX,dword ptr [EDX]
008bea65 : TEST EAX,EAX
008bea67 : JZ 0x008bea8a
008bea69 : MOV EAX,dword ptr [EAX + 0x114]
008bea6f : TEST EAX,EAX
008bea71 : JZ 0x008bea8a
008bea73 : MOV ECX,dword ptr [EAX]
008bea75 : MOV EDX,dword ptr [ECX + 0x4]
008bea78 : PUSH 0x1
008bea7a : PUSH 0xc4e120
008bea7f : PUSH 0xc4e124
008bea84 : PUSH EAX
008bea85 : CALL EDX
008bea87 : ADD ESP,0x10
008bea8a : MOV ECX,dword ptr [0x017248dc]
008bea90 : PUSH 0x32
008bea92 : CALL 0x008a1050
008bea97 : JMP 0x008bed14
008bea9c : MOV EAX,dword ptr [EDI + 0x4]
008bea9f : MOV ECX,dword ptr [0x017247f0]
008beaa5 : PUSH EAX
008beaa6 : CALL 0x009f2a00
008beaab : MOV ESI,EAX
008beaad : TEST ESI,ESI
008beaaf : JZ 0x008beb1f
008beab1 : MOV AX,word ptr [EDI + 0x8]
008beab5 : CALL 0x00a07b80
008beaba : MOV EDX,dword ptr [ESI]
008beabc : MOV EAX,dword ptr [EDX + 0x58]
008beabf : XOR EDI,EDI
008beac1 : PUSH EDI
008beac2 : MOV ECX,ESI
008beac4 : CALL EAX
008beac6 : XOR ECX,ECX
008beac8 : MOV dword ptr [EBP + -0x14],0x7
008beacf : MOV dword ptr [EBP + -0x18],EDI
008bead2 : MOV word ptr [EBP + -0x28],CX
008bead6 : MOV dword ptr [EBP + -0x4],0x3
008beadd : MOV EDX,dword ptr [EBX]
008beadf : MOV EDX,dword ptr [EDX + 0x60]
008beae2 : LEA EAX,[EBP + -0x2c]
008beae5 : PUSH EAX
008beae6 : PUSH ESI
008beae7 : MOV ECX,EBX
008beae9 : CALL EDX
008beaeb : MOV EAX,dword ptr [EBX]
008beaed : MOV EDX,dword ptr [EAX + 0x48]
008beaf0 : PUSH EDI
008beaf1 : PUSH EDI
008beaf2 : LEA ECX,[EBP + -0x2c]
008beaf5 : PUSH ECX
008beaf6 : MOV ECX,EBX
008beaf8 : CALL EDX
008beafa : MOV dword ptr [EBP + -0x4],0xffffffff
008beb01 : CMP dword ptr [EBP + -0x14],0x8
008beb05 : JC 0x008beb0f
008beb07 : MOV ECX,dword ptr [EBP + -0x28]
008beb0a : CALL 0x006f04e0
008beb0f : XOR EAX,EAX
008beb11 : MOV dword ptr [EBP + -0x14],0x7
008beb18 : MOV dword ptr [EBP + -0x18],EDI
008beb1b : MOV word ptr [EBP + -0x28],AX
008beb1f : PUSH 0xc4e138
008beb24 : LEA ECX,[EBP + -0x54]
008beb27 : CALL 0x00406460
008beb2c : MOV dword ptr [EBP + -0x4],0x4
008beb33 : MOV ECX,dword ptr [0x00da9894]
008beb39 : MOV EAX,dword ptr [ECX]
008beb3b : MOV EDX,dword ptr [EAX + 0x1a8]
008beb41 : MOV ECX,dword ptr [0x0172491c]
008beb47 : LEA EAX,[EBP + -0x54]
008beb4a : PUSH EAX
008beb4b : LEA EDI,[EBP + -0x70]
008beb4e : MOV dword ptr [EBP + -0x30],EDX
008beb51 : CALL 0x0081d120
008beb56 : MOV byte ptr [EBP + -0x4],0x5
008beb5a : MOV ECX,dword ptr [EBP + -0x30]
008beb5d : MOV EDX,dword ptr [ECX]
008beb5f : PUSH 0x3
008beb61 : PUSH EAX
008beb62 : MOV EAX,dword ptr [EDX + 0x44]
008beb65 : CALL EAX
008beb67 : MOV byte ptr [EBP + -0x4],0x4
008beb6b : CMP dword ptr [EBP + -0x58],0x8
008beb6f : JC 0x008beb79
008beb71 : MOV ECX,dword ptr [EBP + -0x6c]
008beb74 : CALL 0x006f04e0
008beb79 : XOR EDI,EDI
008beb7b : XOR ECX,ECX
008beb7d : MOV dword ptr [EBP + -0x58],0x7
008beb84 : MOV dword ptr [EBP + -0x5c],EDI
008beb87 : MOV word ptr [EBP + -0x6c],CX
008beb8b : MOV dword ptr [EBP + -0x4],0xffffffff
008beb92 : CMP dword ptr [EBP + -0x3c],0x8
008beb96 : JC 0x008beba0
008beb98 : MOV ECX,dword ptr [EBP + -0x50]
008beb9b : CALL 0x006f04e0
008beba0 : XOR EDX,EDX
008beba2 : MOV EAX,EBX
008beba4 : MOV dword ptr [EBP + -0x3c],0x7
008bebab : MOV dword ptr [EBP + -0x40],EDI
008bebae : MOV word ptr [EBP + -0x50],DX
008bebb2 : CALL 0x008bd640
008bebb7 : MOV EAX,[0x00da9894]
008bebbc : MOV EAX,dword ptr [EAX]
008bebbe : CMP EAX,EDI
008bebc0 : JZ 0x008bebe6
008bebc2 : CMP dword ptr [EAX + 0x114],EDI
008bebc8 : JZ 0x008bebe6
008bebca : MOV EAX,dword ptr [EAX + 0x114]
008bebd0 : MOV ECX,dword ptr [EAX]
008bebd2 : MOV EDX,dword ptr [ECX + 0x4]
008bebd5 : PUSH EDI
008bebd6 : PUSH 0xc4e160
008bebdb : PUSH 0xc4e164
008bebe0 : PUSH EAX
008bebe1 : CALL EDX
008bebe3 : ADD ESP,0x10
008bebe6 : MOV ECX,dword ptr [0x017248dc]
008bebec : PUSH 0x33
008bebee : CALL 0x008a1050
008bebf3 : MOV EAX,dword ptr [EBP + -0x34]
008bebf6 : MOV ECX,dword ptr [EAX + 0xb]
008bebf9 : MOV EDI,dword ptr [0x00d7c54c]
008bebff : LEA EDX,[EBP + -0x30]
008bec02 : MOV dword ptr [EBP + -0x30],ECX
008bec05 : PUSH EDX
008bec06 : LEA ECX,[EDI + 0x40]
008bec09 : LEA EAX,[EBP + -0x38]
008bec0c : CALL 0x004437f0
008bec11 : MOV EDI,dword ptr [EDI + 0x44]
008bec14 : MOV EAX,dword ptr [EBP + -0x38]
008bec17 : CMP EAX,EDI
008bec19 : JZ 0x008bed32
008bec1f : MOV EDI,dword ptr [EAX + 0x10]
008bec22 : MOV dword ptr [EBP + -0x30],EDI
008bec25 : TEST EDI,EDI
008bec27 : JNZ 0x008becba
008bec2d : MOV EAX,dword ptr [EBX]
008bec2f : MOV EDX,dword ptr [EAX + 0x74]
008bec32 : PUSH 0x0
008bec34 : PUSH 0x1
008bec36 : MOV ECX,EBX
008bec38 : CALL EDX
008bec3a : MOV EBX,EAX
008bec3c : TEST EBX,EBX
008bec3e : JZ 0x008bed14
008bec44 : MOV EAX,dword ptr [EBX + 0x10]
008bec47 : PUSH EAX
008bec48 : CALL 0x004049b0
008bec4d : ADD ESP,0x4
008bec50 : MOV dword ptr [EBP + -0x38],EAX
008bec53 : TEST EAX,EAX
008bec55 : JZ 0x008bed14
008bec5b : MOV ECX,ESI
008bec5d : CALL 0x00a08b70
008bec62 : MOV EDI,EAX
008bec64 : MOV EAX,[0x00da9894]
008bec69 : MOV EAX,dword ptr [EAX]
008bec6b : CMP dword ptr [EAX + 0x2bc],0x0
008bec72 : JZ 0x008becb7
008bec74 : MOV ECX,dword ptr [0x0172491c]
008bec7a : MOV EDX,dword ptr [EBP + -0x38]
008bec7d : PUSH 0x0
008bec7f : ADD EDX,0x18
008bec82 : PUSH ECX
008bec83 : LEA ESI,[EBP + 0xffffff58]
008bec89 : CALL 0x00824a20
008bec8e : MOV dword ptr [EBP + -0x4],0x6
008bec95 : MOVZX ECX,word ptr [EBX + 0xac]
008bec9c : PUSH 0x3
008bec9e : MOVZX EDX,CX
008beca1 : PUSH EDI
008beca2 : PUSH EDX
008beca3 : PUSH EAX
008beca4 : CALL 0x00968ef0
008beca9 : MOV dword ptr [EBP + -0x4],0xffffffff
008becb0 : MOV ECX,ESI
008becb2 : CALL 0x00406560
008becb7 : MOV EDI,dword ptr [EBP + -0x30]
008becba : MOV EBX,dword ptr [EBP + -0x34]
008becbd : CMP byte ptr [EBX + 0xf],0x7
008becc1 : JC 0x008bed14
008becc3 : TEST EDI,EDI
008becc5 : JZ 0x008bed14
008becc7 : MOV EAX,[0x00da9894]
008beccc : MOV EAX,dword ptr [EAX]
008becce : CMP dword ptr [EAX + 0x2bc],0x0
008becd5 : JZ 0x008bed14
008becd7 : MOV ECX,dword ptr [0x0172491c]
008becdd : PUSH 0x0
008becdf : LEA EDX,[EDI + 0x18]
008bece2 : PUSH ECX
008bece3 : LEA ESI,[EBP + 0xffffff20]
008bece9 : CALL 0x00824a20
008becee : MOV dword ptr [EBP + -0x4],0x7
008becf5 : MOV EDX,dword ptr [EDI + 0x50]
008becf8 : MOVZX ECX,byte ptr [EBX + 0xf]
008becfc : PUSH 0x4
008becfe : PUSH EDX
008becff : PUSH ECX
008bed00 : PUSH EAX
008bed01 : CALL 0x00968ef0
008bed06 : MOV dword ptr [EBP + -0x4],0xffffffff
008bed0d : MOV ECX,ESI
008bed0f : CALL 0x00406560
008bed14 : MOV ECX,dword ptr [EBP + -0xc]
008bed17 : MOV dword ptr FS:[0x0],ECX
008bed1e : POP ECX
008bed1f : POP EDI
008bed20 : POP ESI
008bed21 : POP EBX
008bed22 : MOV ECX,dword ptr [EBP + -0x10]
008bed25 : XOR ECX,EBP
008bed27 : CALL 0x00633e6b
008bed2c : MOV ESP,EBP
008bed2e : POP EBP
008bed2f : RET 0x4
008bed32 : MOV dword ptr [EBP + -0x30],0x0
008bed39 : JMP 0x008bec2d

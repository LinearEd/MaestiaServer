PROGRAM  : Maestia.exe
FUNCTION : FUN_006ce940
ENTRY    : 006ce940
BODY     : [[006ce940, 006ceaf7]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006ce940(int param_1,int param_2,int param_3,int param_4)

{
  void *_Dst;
  undefined4 *puVar1;
  size_t sVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  int local_8;
  
  if ((param_1 != 0) && (param_2 != 0)) {
    _Dst = (void *)FUN_006cef50(param_1,(*(int *)(param_2 + 0xd8) + param_4) * 0x10);
    if (_Dst == (void *)0x0) {
      FUN_006c24c0(param_1,"No memory for sPLT palettes.");
    }
    else {
      _memcpy(_Dst,*(void **)(param_2 + 0xd4),*(int *)(param_2 + 0xd8) << 4);
      FUN_006ceee0(param_1,*(undefined4 *)(param_2 + 0xd4));
      *(undefined4 *)(param_2 + 0xd4) = 0;
      for (local_8 = 0; local_8 < param_4; local_8 = local_8 + 1) {
        puVar4 = (undefined4 *)((int)_Dst + local_8 * 0x10 + *(int *)(param_2 + 0xd8) * 0x10);
        puVar1 = (undefined4 *)(local_8 * 0x10 + param_3);
        sVar2 = _strlen((char *)*puVar1);
        uVar3 = FUN_006cee20(param_1,sVar2 + 1);
        *puVar4 = uVar3;
        _strcpy((char *)*puVar4,(char *)*puVar1);
        uVar3 = FUN_006cee20(param_1,puVar1[3] * 10);
        puVar4[2] = uVar3;
        _memcpy((void *)puVar4[2],(void *)puVar1[2],puVar1[3] * 10);
        puVar4[3] = puVar1[3];
        *(undefined1 *)(puVar4 + 1) = *(undefined1 *)(puVar1 + 1);
      }
      *(void **)(param_2 + 0xd4) = _Dst;
      *(int *)(param_2 + 0xd8) = *(int *)(param_2 + 0xd8) + param_4;
      *(uint *)(param_2 + 8) = *(uint *)(param_2 + 8) | 0x2000;
      *(uint *)(param_2 + 0xb8) = *(uint *)(param_2 + 0xb8) | 0x20;
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
006ce940 : PUSH EBP
006ce941 : MOV EBP,ESP
006ce943 : SUB ESP,0x10
006ce946 : CMP dword ptr [EBP + 0x8],0x0
006ce94a : JZ 0x006ce952
006ce94c : CMP dword ptr [EBP + 0xc],0x0
006ce950 : JNZ 0x006ce957
006ce952 : JMP 0x006ceaf4
006ce957 : MOV EAX,dword ptr [EBP + 0xc]
006ce95a : MOV ECX,dword ptr [EAX + 0xd8]
006ce960 : ADD ECX,dword ptr [EBP + 0x14]
006ce963 : SHL ECX,0x4
006ce966 : PUSH ECX
006ce967 : MOV EDX,dword ptr [EBP + 0x8]
006ce96a : PUSH EDX
006ce96b : CALL 0x006cef50
006ce970 : ADD ESP,0x8
006ce973 : MOV dword ptr [EBP + -0x8],EAX
006ce976 : CMP dword ptr [EBP + -0x8],0x0
006ce97a : JNZ 0x006ce992
006ce97c : PUSH 0xbedf24
006ce981 : MOV EAX,dword ptr [EBP + 0x8]
006ce984 : PUSH EAX
006ce985 : CALL 0x006c24c0
006ce98a : ADD ESP,0x8
006ce98d : JMP 0x006ceaf4
006ce992 : MOV ECX,dword ptr [EBP + 0xc]
006ce995 : MOV EDX,dword ptr [ECX + 0xd8]
006ce99b : SHL EDX,0x4
006ce99e : PUSH EDX
006ce99f : MOV EAX,dword ptr [EBP + 0xc]
006ce9a2 : MOV ECX,dword ptr [EAX + 0xd4]
006ce9a8 : PUSH ECX
006ce9a9 : MOV EDX,dword ptr [EBP + -0x8]
006ce9ac : PUSH EDX
006ce9ad : CALL 0x0063ae40
006ce9b2 : ADD ESP,0xc
006ce9b5 : MOV EAX,dword ptr [EBP + 0xc]
006ce9b8 : MOV ECX,dword ptr [EAX + 0xd4]
006ce9be : PUSH ECX
006ce9bf : MOV EDX,dword ptr [EBP + 0x8]
006ce9c2 : PUSH EDX
006ce9c3 : CALL 0x006ceee0
006ce9c8 : ADD ESP,0x8
006ce9cb : MOV EAX,dword ptr [EBP + 0xc]
006ce9ce : MOV dword ptr [EAX + 0xd4],0x0
006ce9d8 : MOV dword ptr [EBP + -0x4],0x0
006ce9df : JMP 0x006ce9ea
006ce9e1 : MOV ECX,dword ptr [EBP + -0x4]
006ce9e4 : ADD ECX,0x1
006ce9e7 : MOV dword ptr [EBP + -0x4],ECX
006ce9ea : MOV EDX,dword ptr [EBP + -0x4]
006ce9ed : CMP EDX,dword ptr [EBP + 0x14]
006ce9f0 : JGE 0x006ceaac
006ce9f6 : MOV EAX,dword ptr [EBP + 0xc]
006ce9f9 : MOV ECX,dword ptr [EAX + 0xd8]
006ce9ff : SHL ECX,0x4
006cea02 : ADD ECX,dword ptr [EBP + -0x8]
006cea05 : MOV EDX,dword ptr [EBP + -0x4]
006cea08 : SHL EDX,0x4
006cea0b : ADD ECX,EDX
006cea0d : MOV dword ptr [EBP + -0xc],ECX
006cea10 : MOV EAX,dword ptr [EBP + -0x4]
006cea13 : SHL EAX,0x4
006cea16 : ADD EAX,dword ptr [EBP + 0x10]
006cea19 : MOV dword ptr [EBP + -0x10],EAX
006cea1c : MOV ECX,dword ptr [EBP + -0x10]
006cea1f : MOV EDX,dword ptr [ECX]
006cea21 : PUSH EDX
006cea22 : CALL 0x00640960
006cea27 : ADD ESP,0x4
006cea2a : ADD EAX,0x1
006cea2d : PUSH EAX
006cea2e : MOV EAX,dword ptr [EBP + 0x8]
006cea31 : PUSH EAX
006cea32 : CALL 0x006cee20
006cea37 : ADD ESP,0x8
006cea3a : MOV ECX,dword ptr [EBP + -0xc]
006cea3d : MOV dword ptr [ECX],EAX
006cea3f : MOV EDX,dword ptr [EBP + -0x10]
006cea42 : MOV EAX,dword ptr [EDX]
006cea44 : PUSH EAX
006cea45 : MOV ECX,dword ptr [EBP + -0xc]
006cea48 : MOV EDX,dword ptr [ECX]
006cea4a : PUSH EDX
006cea4b : CALL 0x006d4a70
006cea50 : ADD ESP,0x8
006cea53 : MOV EAX,dword ptr [EBP + -0x10]
006cea56 : MOV ECX,dword ptr [EAX + 0xc]
006cea59 : IMUL ECX,ECX,0xa
006cea5c : PUSH ECX
006cea5d : MOV EDX,dword ptr [EBP + 0x8]
006cea60 : PUSH EDX
006cea61 : CALL 0x006cee20
006cea66 : ADD ESP,0x8
006cea69 : MOV ECX,dword ptr [EBP + -0xc]
006cea6c : MOV dword ptr [ECX + 0x8],EAX
006cea6f : MOV EDX,dword ptr [EBP + -0x10]
006cea72 : MOV EAX,dword ptr [EDX + 0xc]
006cea75 : IMUL EAX,EAX,0xa
006cea78 : PUSH EAX
006cea79 : MOV ECX,dword ptr [EBP + -0x10]
006cea7c : MOV EDX,dword ptr [ECX + 0x8]
006cea7f : PUSH EDX
006cea80 : MOV EAX,dword ptr [EBP + -0xc]
006cea83 : MOV ECX,dword ptr [EAX + 0x8]
006cea86 : PUSH ECX
006cea87 : CALL 0x0063ae40
006cea8c : ADD ESP,0xc
006cea8f : MOV EDX,dword ptr [EBP + -0xc]
006cea92 : MOV EAX,dword ptr [EBP + -0x10]
006cea95 : MOV ECX,dword ptr [EAX + 0xc]
006cea98 : MOV dword ptr [EDX + 0xc],ECX
006cea9b : MOV EDX,dword ptr [EBP + -0xc]
006cea9e : MOV EAX,dword ptr [EBP + -0x10]
006ceaa1 : MOV CL,byte ptr [EAX + 0x4]
006ceaa4 : MOV byte ptr [EDX + 0x4],CL
006ceaa7 : JMP 0x006ce9e1
006ceaac : MOV EDX,dword ptr [EBP + 0xc]
006ceaaf : MOV EAX,dword ptr [EBP + -0x8]
006ceab2 : MOV dword ptr [EDX + 0xd4],EAX
006ceab8 : MOV ECX,dword ptr [EBP + 0xc]
006ceabb : MOV EDX,dword ptr [ECX + 0xd8]
006ceac1 : ADD EDX,dword ptr [EBP + 0x14]
006ceac4 : MOV EAX,dword ptr [EBP + 0xc]
006ceac7 : MOV dword ptr [EAX + 0xd8],EDX
006ceacd : MOV ECX,dword ptr [EBP + 0xc]
006cead0 : MOV EDX,dword ptr [ECX + 0x8]
006cead3 : OR EDX,0x2000
006cead9 : MOV EAX,dword ptr [EBP + 0xc]
006ceadc : MOV dword ptr [EAX + 0x8],EDX
006ceadf : MOV ECX,dword ptr [EBP + 0xc]
006ceae2 : MOV EDX,dword ptr [ECX + 0xb8]
006ceae8 : OR EDX,0x20
006ceaeb : MOV EAX,dword ptr [EBP + 0xc]
006ceaee : MOV dword ptr [EAX + 0xb8],EDX
006ceaf4 : MOV ESP,EBP
006ceaf6 : POP EBP
006ceaf7 : RET

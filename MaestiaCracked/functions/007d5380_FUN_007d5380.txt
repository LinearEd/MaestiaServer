PROGRAM  : Maestia.exe
FUNCTION : FUN_007d5380
ENTRY    : 007d5380
BODY     : [[007d5380, 007d546f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007d5380(undefined4 param_1)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  uint uVar3;
  int *piVar4;
  int iVar5;
  int in_ECX;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b0f2fb;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(int *)(in_ECX + 8) != 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  piVar4 = (int *)**(int **)(in_ECX + 0x188);
  if (piVar4 != *(int **)(in_ECX + 0x188)) {
    do {
      *(undefined1 *)(piVar4[9] + 0x1b5) = (undefined1)param_1;
      piVar4 = (int *)*piVar4;
    } while (piVar4 != (int *)*(int *)(in_ECX + 0x188));
  }
  local_8 = 0xffffffff;
  if (*(int *)(in_ECX + 8) != 0) {
    LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  if (*(int *)(in_ECX + 8) != 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  local_8 = 1;
  puVar1 = *(undefined4 **)(in_ECX + 0x38);
  for (puVar2 = (undefined4 *)*puVar1; puVar2 != puVar1; puVar2 = (undefined4 *)*puVar2) {
    iVar5 = (**(code **)(*(int *)puVar2[9] + 0x1c))(uVar3);
    if (iVar5 - 2U < 8) {
      FUN_007d5380(param_1);
    }
  }
  local_8 = 0xffffffff;
  if (*(int *)(in_ECX + 8) != 0) {
    LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
007d5380 : PUSH EBP
007d5381 : MOV EBP,ESP
007d5383 : PUSH -0x1
007d5385 : PUSH 0xb0f2fb
007d538a : MOV EAX,FS:[0x0]
007d5390 : PUSH EAX
007d5391 : PUSH ECX
007d5392 : PUSH EBX
007d5393 : PUSH ESI
007d5394 : PUSH EDI
007d5395 : MOV EAX,[0x00d66fa0]
007d539a : XOR EAX,EBP
007d539c : PUSH EAX
007d539d : LEA EAX,[EBP + -0xc]
007d53a0 : MOV FS:[0x0],EAX
007d53a6 : MOV ESI,ECX
007d53a8 : MOV EAX,dword ptr [ESI + 0x8]
007d53ab : MOV EDI,dword ptr [0x00b85118]
007d53b1 : MOV dword ptr [EBP + -0x10],ESI
007d53b4 : TEST EAX,EAX
007d53b6 : JZ 0x007d53be
007d53b8 : ADD EAX,0x4
007d53bb : PUSH EAX
007d53bc : CALL EDI
007d53be : MOV dword ptr [EBP + -0x4],0x0
007d53c5 : MOV ECX,dword ptr [ESI + 0x188]
007d53cb : MOV EAX,dword ptr [ECX]
007d53cd : CMP EAX,ECX
007d53cf : JZ 0x007d53e7
007d53d1 : MOV ECX,dword ptr [EAX + 0x24]
007d53d4 : MOV DL,byte ptr [EBP + 0x8]
007d53d7 : MOV byte ptr [ECX + 0x1b5],DL
007d53dd : MOV EAX,dword ptr [EAX]
007d53df : CMP EAX,dword ptr [ESI + 0x188]
007d53e5 : JNZ 0x007d53d1
007d53e7 : MOV dword ptr [EBP + -0x4],0xffffffff
007d53ee : MOV EAX,dword ptr [ESI + 0x8]
007d53f1 : TEST EAX,EAX
007d53f3 : JZ 0x007d53ff
007d53f5 : ADD EAX,0x4
007d53f8 : PUSH EAX
007d53f9 : CALL dword ptr [0x00b8511c]
007d53ff : MOV EAX,dword ptr [ESI + 0x8]
007d5402 : MOV dword ptr [EBP + -0x10],ESI
007d5405 : TEST EAX,EAX
007d5407 : JZ 0x007d540f
007d5409 : ADD EAX,0x4
007d540c : PUSH EAX
007d540d : CALL EDI
007d540f : MOV dword ptr [EBP + -0x4],0x1
007d5416 : MOV EBX,dword ptr [ESI + 0x38]
007d5419 : MOV EDI,dword ptr [EBX]
007d541b : CMP EDI,EBX
007d541d : JZ 0x007d5444
007d541f : NOP
007d5420 : MOV ECX,dword ptr [EDI + 0x24]
007d5423 : MOV EAX,dword ptr [ECX]
007d5425 : MOV EDX,dword ptr [EAX + 0x1c]
007d5428 : CALL EDX
007d542a : ADD EAX,-0x2
007d542d : CMP EAX,0x7
007d5430 : JA 0x007d543e
007d5432 : MOV EAX,dword ptr [EBP + 0x8]
007d5435 : MOV ECX,dword ptr [EDI + 0x24]
007d5438 : PUSH EAX
007d5439 : CALL 0x007d5380
007d543e : MOV EDI,dword ptr [EDI]
007d5440 : CMP EDI,EBX
007d5442 : JNZ 0x007d5420
007d5444 : MOV dword ptr [EBP + -0x4],0xffffffff
007d544b : MOV ESI,dword ptr [ESI + 0x8]
007d544e : TEST ESI,ESI
007d5450 : JZ 0x007d545c
007d5452 : ADD ESI,0x4
007d5455 : PUSH ESI
007d5456 : CALL dword ptr [0x00b8511c]
007d545c : MOV ECX,dword ptr [EBP + -0xc]
007d545f : MOV dword ptr FS:[0x0],ECX
007d5466 : POP ECX
007d5467 : POP EDI
007d5468 : POP ESI
007d5469 : POP EBX
007d546a : MOV ESP,EBP
007d546c : POP EBP
007d546d : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_0070bca0
ENTRY    : 0070bca0
BODY     : [[0070bca0, 0070bd91]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0070bca0(int param_1)

{
  int *piVar1;
  uint local_80c;
  wchar_t local_808 [1024];
  uint local_8;
  
  local_8 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  OutputDebugStringW(
                    L"--------------------------------------------------------------------------------\n"
                    );
  OutputDebugStringW(
                    L"------------------------------Memory Usage--------------------------------------\n"
                    );
  OutputDebugStringW(
                    L"--------------------------------------------------------------------------------\n"
                    );
  __snwprintf(local_808,0x400,L"\tBlockSize %d, poolcount %d\n",*(undefined4 *)(param_1 + 0x1c10),
              *(undefined4 *)(param_1 + 0x1c0c));
  OutputDebugStringW(
                    L"--------------------------------------------------------------------------------\n"
                    );
  local_80c = 0;
  if (*(int *)(param_1 + 0x1c0c) != 0) {
    piVar1 = (int *)(param_1 + 0x34);
    do {
      if (piVar1[-1] != 0) {
        __snwprintf(local_808,0x400,L"(%d) : Total(%d) Free(%d) Grow(%d) Use(%d)\n",piVar1[-4],
                    piVar1[-2],*piVar1,piVar1[-1],piVar1[-2] - *piVar1);
        OutputDebugStringW(local_808);
      }
      local_80c = local_80c + 1;
      piVar1 = piVar1 + 0xe;
    } while (local_80c < *(uint *)(param_1 + 0x1c0c));
  }
  OutputDebugStringW(
                    L"--------------------------------------------------------------------------------\n"
                    );
  __security_check_cookie(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0070bca0 : PUSH EBP
0070bca1 : MOV EBP,ESP
0070bca3 : SUB ESP,0x80c
0070bca9 : MOV EAX,[0x00d66fa0]
0070bcae : XOR EAX,EBP
0070bcb0 : MOV dword ptr [EBP + -0x4],EAX
0070bcb3 : PUSH EBX
0070bcb4 : MOV EBX,dword ptr [EBP + 0x8]
0070bcb7 : PUSH EDI
0070bcb8 : MOV EDI,dword ptr [0x00b8512c]
0070bcbe : PUSH 0xbfd378
0070bcc3 : MOV dword ptr [EBP + 0xfffff7f4],EBX
0070bcc9 : CALL EDI
0070bccb : PUSH 0xbfd458
0070bcd0 : CALL EDI
0070bcd2 : PUSH 0xbfd508
0070bcd7 : CALL EDI
0070bcd9 : MOV EAX,dword ptr [EBX + 0x1c0c]
0070bcdf : MOV ECX,dword ptr [EBX + 0x1c10]
0070bce5 : PUSH EAX
0070bce6 : PUSH ECX
0070bce7 : PUSH 0xbfd41c
0070bcec : LEA EDX,[EBP + 0xfffff7fc]
0070bcf2 : PUSH 0x400
0070bcf7 : PUSH EDX
0070bcf8 : CALL 0x006343c8
0070bcfd : ADD ESP,0x14
0070bd00 : PUSH 0xbfd5b0
0070bd05 : CALL EDI
0070bd07 : CMP dword ptr [EBX + 0x1c0c],0x0
0070bd0e : MOV dword ptr [EBP + 0xfffff7f8],0x0
0070bd18 : JBE 0x0070bd79
0070bd1a : PUSH ESI
0070bd1b : LEA ESI,[EBX + 0x34]
0070bd1e : MOV EDI,EDI
0070bd20 : MOV EDX,dword ptr [ESI + -0x4]
0070bd23 : TEST EDX,EDX
0070bd25 : JZ 0x0070bd60
0070bd27 : MOV ECX,dword ptr [ESI + -0x8]
0070bd2a : MOV EAX,dword ptr [ESI]
0070bd2c : MOV EBX,ECX
0070bd2e : SUB EBX,EAX
0070bd30 : PUSH EBX
0070bd31 : PUSH EDX
0070bd32 : PUSH EAX
0070bd33 : MOV EAX,dword ptr [ESI + -0x10]
0070bd36 : PUSH ECX
0070bd37 : PUSH EAX
0070bd38 : PUSH 0xbfd658
0070bd3d : LEA ECX,[EBP + 0xfffff7fc]
0070bd43 : PUSH 0x400
0070bd48 : PUSH ECX
0070bd49 : CALL 0x006343c8
0070bd4e : ADD ESP,0x20
0070bd51 : LEA EDX,[EBP + 0xfffff7fc]
0070bd57 : PUSH EDX
0070bd58 : CALL EDI
0070bd5a : MOV EBX,dword ptr [EBP + 0xfffff7f4]
0070bd60 : MOV EAX,dword ptr [EBP + 0xfffff7f8]
0070bd66 : INC EAX
0070bd67 : ADD ESI,0x38
0070bd6a : MOV dword ptr [EBP + 0xfffff7f8],EAX
0070bd70 : CMP EAX,dword ptr [EBX + 0x1c0c]
0070bd76 : JC 0x0070bd20
0070bd78 : POP ESI
0070bd79 : PUSH 0xbfd6b0
0070bd7e : CALL EDI
0070bd80 : MOV ECX,dword ptr [EBP + -0x4]
0070bd83 : POP EDI
0070bd84 : XOR ECX,EBP
0070bd86 : POP EBX
0070bd87 : CALL 0x00633e6b
0070bd8c : MOV ESP,EBP
0070bd8e : POP EBP
0070bd8f : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_00a2db00
ENTRY    : 00a2db00
BODY     : [[00a2db00, 00a2df3e]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a2db00(int param_1,float *param_2,char param_3,char param_4)

{
  float fVar1;
  float fVar2;
  undefined4 *puVar3;
  float *pfVar4;
  bool bVar5;
  byte bVar6;
  SHORT SVar7;
  float *in_EAX;
  DWORD DVar8;
  BOOL BVar9;
  undefined4 uVar10;
  int iVar11;
  uintptr_t uVar12;
  int *piVar13;
  int iVar14;
  undefined4 uStack_1c;
  float fStack_14;
  float fStack_10;
  float fStack_c;
  
  bVar5 = true;
  if (*(char *)(param_1 + 0x264) != '\0') {
    *(undefined1 *)(param_1 + 0x264) = 0;
  }
  if (*(int *)(param_1 + 0x580) != 0) {
    iVar11 = *(int *)(*(int *)(param_1 + 0xc) + 0x2ac4);
    if (iVar11 != 0) {
      *(undefined1 *)(iVar11 + 0x2eee9) = 1;
    }
    DVar8 = WaitForSingleObject(*(HANDLE *)(param_1 + 0x580),0xffffffff);
    if (DVar8 == 0) {
      BVar9 = CloseHandle(*(HANDLE *)(param_1 + 0x580));
      if (BVar9 == 0) {
        FUN_008018d0(L"Pathfinder CloseHandle Error");
      }
    }
    else {
      FUN_008018d0(L"WaitForSigleObject Error");
      bVar5 = false;
    }
    InterlockedExchange((LONG *)(DAT_00da93ec + 0x57c),0);
    *(undefined4 *)(param_1 + 0x580) = 0;
  }
  piVar13 = *(int **)(param_1 + 0x59c);
  if (piVar13 == (int *)0x0) {
    piVar13 = *(int **)(param_1 + 0xac);
  }
  (**(code **)(*piVar13 + 0x4f4))();
  puVar3 = *(undefined4 **)(param_1 + 0x588);
  if (puVar3 != (undefined4 *)0x0) {
    *puVar3 = 0xbf800000;
    puVar3[1] = 0xbf800000;
    puVar3[2] = 0xbf800000;
    puVar3[3] = 0xbf800000;
    puVar3[4] = 0xbf800000;
    puVar3[5] = 0xbf800000;
    *(undefined1 *)(puVar3 + 6) = 0;
    *(undefined1 *)((int)puVar3 + 0x19) = 0;
    *(undefined1 *)((int)puVar3 + 0x1a) = 0;
    puVar3[7] = 0;
    pfVar4 = *(float **)(param_1 + 0x588);
    *pfVar4 = *in_EAX;
    pfVar4[1] = in_EAX[1];
    pfVar4[2] = in_EAX[2];
    iVar11 = *(int *)(param_1 + 0x588);
    *(float *)(iVar11 + 0xc) = *param_2;
    *(float *)(iVar11 + 0x10) = param_2[1];
    *(float *)(iVar11 + 0x14) = param_2[2];
    *(char *)(*(int *)(param_1 + 0x588) + 0x18) = param_3;
    *(char *)(*(int *)(param_1 + 0x588) + 0x19) = param_4;
    if (*(int *)(param_1 + 0x59c) == 0) {
      if (*(int *)(param_1 + 0xac) != 0) {
        fStack_14 = *param_2 - *in_EAX;
        fStack_10 = param_2[1] - in_EAX[1];
        fStack_c = param_2[2] - in_EAX[2];
        D3DXVec3Normalize(&fStack_14,&fStack_14);
        (**(code **)(**(int **)(param_1 + 0xac) + 0x2b0))(uStack_1c,fStack_14,0);
      }
    }
    else {
      fStack_14 = *param_2 - *in_EAX;
      fStack_10 = param_2[1] - in_EAX[1];
      fStack_c = param_2[2] - in_EAX[2];
      D3DXVec3Normalize(&fStack_14,&fStack_14);
      (**(code **)(**(int **)(param_1 + 0x59c) + 0x2b0))(uStack_1c,fStack_14,0);
    }
    FUN_00a2da80();
    *(undefined1 *)(*(int *)(param_1 + 0x588) + 0x1a) = 0xff;
    iVar11 = *(int *)(param_1 + 0xc);
    if ((*(char *)(iVar11 + 0x2a4c) == -1) && ((*(byte *)(iVar11 + 0x2a6c) & 0x80) != 0)) {
      uVar10 = 4;
    }
    else {
      uVar10 = 0;
    }
    if ((param_3 != '\0') || (*(char *)(param_1 + 0x4c9) != '\0')) {
      uVar10 = 4;
    }
    iVar14 = *(int *)(param_1 + 0x59c);
    if (iVar14 == 0) {
      iVar14 = *(int *)(param_1 + 0xac);
    }
    bVar6 = FUN_0077a5a0(in_EAX,param_2,(int)(float)*(ushort *)(iVar14 + 0x41c) & 0xffff,
                         *(float *)(*(int *)(iVar11 + 0x9c) + 100) * 0.1,uVar10);
    if (bVar6 == 0) {
      if (bVar5) {
        uVar12 = __beginthreadex((void *)0x0,0,FUN_00a2a9b0,*(void **)(param_1 + 0x588),0,
                                 (uint *)(param_1 + 0x584));
        *(uintptr_t *)(param_1 + 0x580) = uVar12;
      }
    }
    else {
      InterlockedExchange((LONG *)(param_1 + 0x57c),(uint)bVar6);
      iVar11 = *(int *)(param_1 + 0x18c);
      *(float *)(iVar11 + 0x68) = *param_2;
      *(float *)(iVar11 + 0x6c) = param_2[1];
      *(float *)(iVar11 + 0x70) = param_2[2];
      *(undefined1 *)(iVar11 + 0x5d) = 1;
      *(undefined1 *)(iVar11 + 0x134) = 1;
      *(undefined1 *)(iVar11 + 0x5c) = 1;
      if (*(int **)(iVar11 + 0x2c) != (int *)0x0) {
        (**(code **)(**(int **)(iVar11 + 0x2c) + 0x60))(iVar11);
      }
      if (*(int **)(param_1 + 400) != (int *)0x0) {
        (**(code **)(**(int **)(param_1 + 400) + 0x24))();
        (**(code **)(**(int **)(param_1 + 400) + 0x20))();
      }
      fVar1 = param_2[1];
      fVar2 = param_2[2];
      iVar11 = 0;
      if (*(int *)(*DAT_00da9894 + 300) != 0) {
        iVar11 = *(int *)(*(int *)(*DAT_00da9894 + 300) + 0x18);
      }
      *(float *)(iVar11 + 200) = *param_2;
      *(float *)(iVar11 + 0xcc) = fVar1;
      *(float *)(iVar11 + 0xd0) = fVar2;
      SVar7 = GetKeyState(0x10);
      if ((SVar7 < 0) && (param_4 == '\x01')) {
        if (*(int *)(*DAT_00da9894 + 300) == 0) {
          FUN_00981ad0(1);
          return;
        }
        FUN_00981ad0(1);
        return;
      }
      FUN_00981ad0(0);
      if (*(int *)(param_1 + 0xac) != 0) {
        FUN_00476f00();
        return;
      }
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00a2db00 : PUSH EBP
00a2db01 : MOV EBP,ESP
00a2db03 : AND ESP,0xfffffff8
00a2db06 : SUB ESP,0x14
00a2db09 : PUSH EBX
00a2db0a : MOV EBX,dword ptr [EBP + 0x8]
00a2db0d : CMP byte ptr [EBX + 0x264],0x0
00a2db14 : PUSH ESI
00a2db15 : PUSH EDI
00a2db16 : MOV EDI,EAX
00a2db18 : MOV dword ptr [ESP + 0x10],0x1
00a2db20 : JZ 0x00a2db29
00a2db22 : MOV byte ptr [EBX + 0x264],0x0
00a2db29 : CMP dword ptr [EBX + 0x580],0x0
00a2db30 : JZ 0x00a2dbba
00a2db36 : MOV EAX,dword ptr [EBX + 0xc]
00a2db39 : MOV EAX,dword ptr [EAX + 0x2ac4]
00a2db3f : TEST EAX,EAX
00a2db41 : JZ 0x00a2db4a
00a2db43 : MOV byte ptr [EAX + 0x2eee9],0x1
00a2db4a : MOV EAX,dword ptr [EBX + 0x580]
00a2db50 : PUSH -0x1
00a2db52 : PUSH EAX
00a2db53 : CALL dword ptr [0x00b85100]
00a2db59 : TEST EAX,EAX
00a2db5b : JNZ 0x00a2db80
00a2db5d : MOV ECX,dword ptr [EBX + 0x580]
00a2db63 : PUSH ECX
00a2db64 : CALL dword ptr [0x00b85104]
00a2db6a : TEST EAX,EAX
00a2db6c : JNZ 0x00a2db9b
00a2db6e : MOV ESI,dword ptr [0x00da98e8]
00a2db74 : PUSH 0xcc4458
00a2db79 : CALL 0x008018d0
00a2db7e : JMP 0x00a2db98
00a2db80 : MOV ESI,dword ptr [0x00da98e8]
00a2db86 : PUSH 0xcc4494
00a2db8b : CALL 0x008018d0
00a2db90 : MOV dword ptr [ESP + 0x14],0x0
00a2db98 : ADD ESP,0x4
00a2db9b : MOV EDX,dword ptr [0x00da93ec]
00a2dba1 : PUSH 0x0
00a2dba3 : ADD EDX,0x57c
00a2dba9 : PUSH EDX
00a2dbaa : CALL dword ptr [0x00b85108]
00a2dbb0 : MOV dword ptr [EBX + 0x580],0x0
00a2dbba : MOV ECX,dword ptr [EBX + 0x59c]
00a2dbc0 : TEST ECX,ECX
00a2dbc2 : JNZ 0x00a2dbca
00a2dbc4 : MOV ECX,dword ptr [EBX + 0xac]
00a2dbca : MOV EAX,dword ptr [ECX]
00a2dbcc : MOV EDX,dword ptr [EAX + 0x4f4]
00a2dbd2 : CALL EDX
00a2dbd4 : MOV EAX,dword ptr [EBX + 0x588]
00a2dbda : TEST EAX,EAX
00a2dbdc : JZ 0x00a2df36
00a2dbe2 : MOVSS XMM0,dword ptr [0x00cdf0d0]
00a2dbea : MOVSS dword ptr [EAX],XMM0
00a2dbee : MOVSS dword ptr [EAX + 0x4],XMM0
00a2dbf3 : MOVSS dword ptr [EAX + 0x8],XMM0
00a2dbf8 : MOVSS dword ptr [EAX + 0xc],XMM0
00a2dbfd : MOVSS dword ptr [EAX + 0x10],XMM0
00a2dc02 : MOVSS dword ptr [EAX + 0x14],XMM0
00a2dc07 : MOV ESI,dword ptr [EBP + 0xc]
00a2dc0a : MOV byte ptr [EAX + 0x18],0x0
00a2dc0e : MOV byte ptr [EAX + 0x19],0x0
00a2dc12 : MOV byte ptr [EAX + 0x1a],0x0
00a2dc16 : MOV dword ptr [EAX + 0x1c],0x0
00a2dc1d : FLD float ptr [EDI]
00a2dc1f : MOV EAX,dword ptr [EBX + 0x588]
00a2dc25 : FSTP float ptr [EAX]
00a2dc27 : MOV CL,byte ptr [EBP + 0x10]
00a2dc2a : FLD float ptr [EDI + 0x4]
00a2dc2d : FSTP float ptr [EAX + 0x4]
00a2dc30 : FLD float ptr [EDI + 0x8]
00a2dc33 : FSTP float ptr [EAX + 0x8]
00a2dc36 : MOV EAX,dword ptr [EBX + 0x588]
00a2dc3c : FLD float ptr [ESI]
00a2dc3e : ADD EAX,0xc
00a2dc41 : FSTP float ptr [EAX]
00a2dc43 : FLD float ptr [ESI + 0x4]
00a2dc46 : FSTP float ptr [EAX + 0x4]
00a2dc49 : FLD float ptr [ESI + 0x8]
00a2dc4c : FSTP float ptr [EAX + 0x8]
00a2dc4f : MOV EAX,dword ptr [EBX + 0x588]
00a2dc55 : MOV byte ptr [EAX + 0x18],CL
00a2dc58 : MOV EDX,dword ptr [EBX + 0x588]
00a2dc5e : MOV AL,byte ptr [EBP + 0x14]
00a2dc61 : MOV byte ptr [EDX + 0x19],AL
00a2dc64 : CMP dword ptr [EBX + 0x59c],0x0
00a2dc6b : JZ 0x00a2dcce
00a2dc6d : MOVSS XMM0,dword ptr [ESI]
00a2dc71 : MOVSS XMM1,dword ptr [ESI + 0x4]
00a2dc76 : MOVSS XMM2,dword ptr [ESI + 0x8]
00a2dc7b : SUBSS XMM0,dword ptr [EDI]
00a2dc7f : SUBSS XMM1,dword ptr [EDI + 0x4]
00a2dc84 : SUBSS XMM2,dword ptr [EDI + 0x8]
00a2dc89 : LEA ECX,[ESP + 0x14]
00a2dc8d : PUSH ECX
00a2dc8e : MOV EDX,ECX
00a2dc90 : PUSH EDX
00a2dc91 : MOVSS dword ptr [ESP + 0x1c],XMM0
00a2dc97 : MOVSS dword ptr [ESP + 0x20],XMM1
00a2dc9d : MOVSS dword ptr [ESP + 0x24],XMM2
00a2dca3 : CALL 0x004ff722
00a2dca8 : FLD float ptr [ESP + 0x1c]
00a2dcac : MOV ECX,dword ptr [EBX + 0x59c]
00a2dcb2 : MOV EAX,dword ptr [ECX]
00a2dcb4 : MOV EDX,dword ptr [EAX + 0x2b0]
00a2dcba : PUSH 0x0
00a2dcbc : SUB ESP,0x8
00a2dcbf : FSTP float ptr [ESP + 0x4]
00a2dcc3 : FLD float ptr [ESP + 0x20]
00a2dcc7 : FSTP float ptr [ESP]
00a2dcca : CALL EDX
00a2dccc : JMP 0x00a2dd36
00a2dcce : CMP dword ptr [EBX + 0xac],0x0
00a2dcd5 : JZ 0x00a2dd36
00a2dcd7 : MOVSS XMM0,dword ptr [ESI]
00a2dcdb : MOVSS XMM1,dword ptr [ESI + 0x4]
00a2dce0 : MOVSS XMM2,dword ptr [ESI + 0x8]
00a2dce5 : SUBSS XMM0,dword ptr [EDI]
00a2dce9 : SUBSS XMM1,dword ptr [EDI + 0x4]
00a2dcee : SUBSS XMM2,dword ptr [EDI + 0x8]
00a2dcf3 : LEA EAX,[ESP + 0x14]
00a2dcf7 : PUSH EAX
00a2dcf8 : MOV ECX,EAX
00a2dcfa : PUSH ECX
00a2dcfb : MOVSS dword ptr [ESP + 0x1c],XMM0
00a2dd01 : MOVSS dword ptr [ESP + 0x20],XMM1
00a2dd07 : MOVSS dword ptr [ESP + 0x24],XMM2
00a2dd0d : CALL 0x004ff722
00a2dd12 : FLD float ptr [ESP + 0x1c]
00a2dd16 : MOV ECX,dword ptr [EBX + 0xac]
00a2dd1c : MOV EDX,dword ptr [ECX]
00a2dd1e : MOV EAX,dword ptr [EDX + 0x2b0]
00a2dd24 : PUSH 0x0
00a2dd26 : SUB ESP,0x8
00a2dd29 : FSTP float ptr [ESP + 0x4]
00a2dd2d : FLD float ptr [ESP + 0x20]
00a2dd31 : FSTP float ptr [ESP]
00a2dd34 : CALL EAX
00a2dd36 : LEA EDX,[ESP + 0xf]
00a2dd3a : MOV EAX,EBX
00a2dd3c : MOV byte ptr [ESP + 0xf],0xff
00a2dd41 : CALL 0x00a2da80
00a2dd46 : MOV AL,byte ptr [ESP + 0xf]
00a2dd4a : MOV ECX,dword ptr [EBX + 0x588]
00a2dd50 : MOV byte ptr [ECX + 0x1a],AL
00a2dd53 : MOV EDX,dword ptr [EBX + 0xc]
00a2dd56 : MOVZX ECX,AL
00a2dd59 : LEA ECX,[ECX + ECX*0x4]
00a2dd5c : CMP byte ptr [EDX + ECX*0x8 + 0x274],AL
00a2dd63 : LEA ECX,[EDX + ECX*0x8]
00a2dd66 : JNZ 0x00a2dd78
00a2dd68 : TEST byte ptr [ECX + 0x294],0x80
00a2dd6f : JZ 0x00a2dd78
00a2dd71 : MOV EAX,0x4
00a2dd76 : JMP 0x00a2dd7a
00a2dd78 : XOR EAX,EAX
00a2dd7a : CMP byte ptr [EBP + 0x10],0x0
00a2dd7e : JNZ 0x00a2dd89
00a2dd80 : CMP byte ptr [EBX + 0x4c9],0x0
00a2dd87 : JZ 0x00a2dd8e
00a2dd89 : MOV EAX,0x4
00a2dd8e : MOV ECX,dword ptr [EBX + 0x59c]
00a2dd94 : TEST ECX,ECX
00a2dd96 : JNZ 0x00a2dd9e
00a2dd98 : MOV ECX,dword ptr [EBX + 0xac]
00a2dd9e : MOVZX ECX,word ptr [ECX + 0x41c]
00a2dda5 : PUSH EAX
00a2dda6 : CVTSI2SS XMM1,ECX
00a2ddaa : MOV ECX,dword ptr [EDX + 0x9c]
00a2ddb0 : MOVSS XMM0,dword ptr [ECX + 0x64]
00a2ddb5 : MULSS XMM0,dword ptr [0x00cdf0f0]
00a2ddbd : PUSH ECX
00a2ddbe : CVTTSS2SI EAX,XMM1
00a2ddc2 : MOVZX ECX,AX
00a2ddc5 : MOVSS dword ptr [ESP],XMM0
00a2ddca : PUSH ECX
00a2ddcb : PUSH ESI
00a2ddcc : PUSH EDI
00a2ddcd : MOV EDI,dword ptr [EDX + 0x2ac4]
00a2ddd3 : CALL 0x0077a5a0
00a2ddd8 : TEST AL,AL
00a2ddda : JZ 0x00a2df08
00a2dde0 : MOVZX EDX,AL
00a2dde3 : PUSH EDX
00a2dde4 : LEA EAX,[EBX + 0x57c]
00a2ddea : PUSH EAX
00a2ddeb : CALL dword ptr [0x00b85108]
00a2ddf1 : MOV EAX,dword ptr [EBX + 0x18c]
00a2ddf7 : FLD float ptr [ESI]
00a2ddf9 : FSTP float ptr [EAX + 0x68]
00a2ddfc : FLD float ptr [ESI + 0x4]
00a2ddff : FSTP float ptr [EAX + 0x6c]
00a2de02 : FLD float ptr [ESI + 0x8]
00a2de05 : FSTP float ptr [EAX + 0x70]
00a2de08 : MOV ECX,dword ptr [EAX + 0x2c]
00a2de0b : MOV byte ptr [EAX + 0x5d],0x1
00a2de0f : MOV byte ptr [EAX + 0x134],0x1
00a2de16 : MOV byte ptr [EAX + 0x5c],0x1
00a2de1a : TEST ECX,ECX
00a2de1c : JZ 0x00a2de26
00a2de1e : MOV EDX,dword ptr [ECX]
00a2de20 : PUSH EAX
00a2de21 : MOV EAX,dword ptr [EDX + 0x60]
00a2de24 : CALL EAX
00a2de26 : MOV ECX,dword ptr [EBX + 0x190]
00a2de2c : TEST ECX,ECX
00a2de2e : JZ 0x00a2de44
00a2de30 : MOV EDX,dword ptr [ECX]
00a2de32 : MOV EAX,dword ptr [EDX + 0x24]
00a2de35 : CALL EAX
00a2de37 : MOV ECX,dword ptr [EBX + 0x190]
00a2de3d : MOV EDX,dword ptr [ECX]
00a2de3f : MOV EAX,dword ptr [EDX + 0x20]
00a2de42 : CALL EAX
00a2de44 : MOV ECX,dword ptr [0x00da9894]
00a2de4a : MOV EAX,dword ptr [ECX]
00a2de4c : MOV EAX,dword ptr [EAX + 0x12c]
00a2de52 : MOVSS XMM0,dword ptr [ESI]
00a2de56 : MOVSS XMM1,dword ptr [ESI + 0x4]
00a2de5b : MOVSS XMM2,dword ptr [ESI + 0x8]
00a2de60 : TEST EAX,EAX
00a2de62 : JZ 0x00a2de67
00a2de64 : MOV EAX,dword ptr [EAX + 0x18]
00a2de67 : PUSH 0x10
00a2de69 : MOVSS dword ptr [EAX + 0xc8],XMM0
00a2de71 : MOVSS dword ptr [EAX + 0xcc],XMM1
00a2de79 : MOVSS dword ptr [EAX + 0xd0],XMM2
00a2de81 : CALL dword ptr [0x00b85438]
00a2de87 : TEST AX,AX
00a2de8a : JGE 0x00a2decb
00a2de8c : CMP byte ptr [EBP + 0x14],0x1
00a2de90 : JNZ 0x00a2decb
00a2de92 : MOV EDX,dword ptr [0x00da9894]
00a2de98 : MOV EAX,dword ptr [EDX]
00a2de9a : MOV EAX,dword ptr [EAX + 0x12c]
00a2dea0 : TEST EAX,EAX
00a2dea2 : JNZ 0x00a2deb6
00a2dea4 : PUSH 0x1
00a2dea6 : MOV ESI,EAX
00a2dea8 : CALL 0x00981ad0
00a2dead : POP EDI
00a2deae : POP ESI
00a2deaf : POP EBX
00a2deb0 : MOV ESP,EBP
00a2deb2 : POP EBP
00a2deb3 : RET 0x10
00a2deb6 : MOV EAX,dword ptr [EAX + 0x18]
00a2deb9 : PUSH 0x1
00a2debb : MOV ESI,EAX
00a2debd : CALL 0x00981ad0
00a2dec2 : POP EDI
00a2dec3 : POP ESI
00a2dec4 : POP EBX
00a2dec5 : MOV ESP,EBP
00a2dec7 : POP EBP
00a2dec8 : RET 0x10
00a2decb : MOV EAX,[0x00da9894]
00a2ded0 : MOV EAX,dword ptr [EAX]
00a2ded2 : MOV EAX,dword ptr [EAX + 0x12c]
00a2ded8 : TEST EAX,EAX
00a2deda : JNZ 0x00a2dee0
00a2dedc : XOR ESI,ESI
00a2dede : JMP 0x00a2dee3
00a2dee0 : MOV ESI,dword ptr [EAX + 0x18]
00a2dee3 : PUSH 0x0
00a2dee5 : CALL 0x00981ad0
00a2deea : MOV EBX,dword ptr [EBX + 0xac]
00a2def0 : TEST EBX,EBX
00a2def2 : JZ 0x00a2df36
00a2def4 : LEA ESI,[EBX + 0x59c]
00a2defa : CALL 0x00476f00
00a2deff : POP EDI
00a2df00 : POP ESI
00a2df01 : POP EBX
00a2df02 : MOV ESP,EBP
00a2df04 : POP EBP
00a2df05 : RET 0x10
00a2df08 : CMP dword ptr [ESP + 0x10],0x0
00a2df0d : JZ 0x00a2df36
00a2df0f : MOV EDX,dword ptr [EBX + 0x588]
00a2df15 : LEA ECX,[EBX + 0x584]
00a2df1b : PUSH ECX
00a2df1c : PUSH 0x0
00a2df1e : PUSH EDX
00a2df1f : PUSH 0xa2a9b0
00a2df24 : PUSH 0x0
00a2df26 : PUSH 0x0
00a2df28 : CALL 0x00635f44
00a2df2d : ADD ESP,0x18
00a2df30 : MOV dword ptr [EBX + 0x580],EAX
00a2df36 : POP EDI
00a2df37 : POP ESI
00a2df38 : POP EBX
00a2df39 : MOV ESP,EBP
00a2df3b : POP EBP
00a2df3c : RET 0x10

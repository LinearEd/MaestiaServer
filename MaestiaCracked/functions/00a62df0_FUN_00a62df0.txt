PROGRAM  : Maestia.exe
FUNCTION : FUN_00a62df0
ENTRY    : 00a62df0
BODY     : [[00a62df0, 00a62fad]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a62df0(int param_1)

{
  LPCWSTR lpWideCharStr;
  FILE *_File;
  long lVar1;
  undefined4 in_ECX;
  undefined4 local_114;
  undefined4 local_110;
  long local_10c;
  CHAR local_108 [256];
  uint local_8;
  
  local_8 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  if (*(uint *)(param_1 + 0x18) < 8) {
    lpWideCharStr = (LPCWSTR)(param_1 + 4);
  }
  else {
    lpWideCharStr = *(LPCWSTR *)(param_1 + 4);
  }
  WideCharToMultiByte(0,0,lpWideCharStr,-1,local_108,0x100,(LPCSTR)0x0,(LPBOOL)0x0);
  _File = _fopen(local_108,"wb");
  if (_File == (FILE *)0x0) {
    __security_check_cookie(local_8 ^ (uint)&stack0xfffffffc);
    return;
  }
  local_114 = 0x19880901;
  local_110 = 0x3837acd8;
  lVar1 = _ftell(_File);
  _fwrite(&local_110,4,1,_File);
  local_10c = _ftell(_File);
  _fwrite(&local_10c,4,1,_File);
  _fwrite(&local_114,4,1,_File);
  FUN_00767e10(local_10c,lVar1);
  local_114 = 0x20061027;
  local_110 = 0x46cd328a;
  lVar1 = _ftell(_File);
  _fwrite(&local_110,4,1,_File);
  local_10c = _ftell(_File);
  _fwrite(&local_10c,4,1,_File);
  _fwrite(&local_114,4,1,_File);
  FUN_00767e10(local_10c,lVar1);
  local_110 = 0x937437da;
  lVar1 = _ftell(_File);
  _fwrite(&local_110,4,1,_File);
  local_10c = _ftell(_File);
  _fwrite(&local_10c,4,1,_File);
  FUN_00a62b90(in_ECX);
  FUN_00767e10(local_10c,lVar1);
  _fclose(_File);
  __security_check_cookie(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a62df0 : PUSH EBP
00a62df1 : MOV EBP,ESP
00a62df3 : SUB ESP,0x110
00a62df9 : MOV EAX,[0x00d66fa0]
00a62dfe : XOR EAX,EBP
00a62e00 : MOV dword ptr [EBP + -0x4],EAX
00a62e03 : MOV EAX,dword ptr [EBP + 0x8]
00a62e06 : CMP dword ptr [EAX + 0x18],0x8
00a62e0a : PUSH EBX
00a62e0b : PUSH ESI
00a62e0c : MOV EBX,ECX
00a62e0e : JC 0x00a62e15
00a62e10 : MOV EAX,dword ptr [EAX + 0x4]
00a62e13 : JMP 0x00a62e18
00a62e15 : ADD EAX,0x4
00a62e18 : PUSH 0x0
00a62e1a : PUSH 0x0
00a62e1c : PUSH 0x100
00a62e21 : LEA ECX,[EBP + 0xfffffefc]
00a62e27 : PUSH ECX
00a62e28 : PUSH -0x1
00a62e2a : PUSH EAX
00a62e2b : PUSH 0x0
00a62e2d : PUSH 0x0
00a62e2f : CALL dword ptr [0x00b85130]
00a62e35 : LEA EDX,[EBP + 0xfffffefc]
00a62e3b : PUSH 0xc050cc
00a62e40 : PUSH EDX
00a62e41 : CALL 0x00638fa0
00a62e46 : MOV ESI,EAX
00a62e48 : ADD ESP,0x8
00a62e4b : TEST ESI,ESI
00a62e4d : JNZ 0x00a62e63
00a62e4f : POP ESI
00a62e50 : XOR AL,AL
00a62e52 : POP EBX
00a62e53 : MOV ECX,dword ptr [EBP + -0x4]
00a62e56 : XOR ECX,EBP
00a62e58 : CALL 0x00633e6b
00a62e5d : MOV ESP,EBP
00a62e5f : POP EBP
00a62e60 : RET 0x4
00a62e63 : PUSH EDI
00a62e64 : PUSH ESI
00a62e65 : MOV dword ptr [EBP + 0xfffffef0],0x19880901
00a62e6f : MOV dword ptr [EBP + 0xfffffef4],0x3837acd8
00a62e79 : CALL 0x0063751f
00a62e7e : PUSH ESI
00a62e7f : PUSH 0x1
00a62e81 : MOV EDI,EAX
00a62e83 : LEA EAX,[EBP + 0xfffffef4]
00a62e89 : PUSH 0x4
00a62e8b : PUSH EAX
00a62e8c : CALL 0x006376ef
00a62e91 : PUSH ESI
00a62e92 : CALL 0x0063751f
00a62e97 : PUSH ESI
00a62e98 : PUSH 0x1
00a62e9a : LEA ECX,[EBP + 0xfffffef8]
00a62ea0 : PUSH 0x4
00a62ea2 : PUSH ECX
00a62ea3 : MOV dword ptr [EBP + 0xfffffef8],EAX
00a62ea9 : CALL 0x006376ef
00a62eae : PUSH ESI
00a62eaf : PUSH 0x1
00a62eb1 : LEA EDX,[EBP + 0xfffffef0]
00a62eb7 : PUSH 0x4
00a62eb9 : PUSH EDX
00a62eba : CALL 0x006376ef
00a62ebf : MOV EAX,dword ptr [EBP + 0xfffffef8]
00a62ec5 : PUSH EDI
00a62ec6 : PUSH EAX
00a62ec7 : CALL 0x00767e10
00a62ecc : ADD ESP,0x40
00a62ecf : PUSH ESI
00a62ed0 : MOV dword ptr [EBP + 0xfffffef0],0x20061027
00a62eda : MOV dword ptr [EBP + 0xfffffef4],0x46cd328a
00a62ee4 : CALL 0x0063751f
00a62ee9 : PUSH ESI
00a62eea : PUSH 0x1
00a62eec : LEA ECX,[EBP + 0xfffffef4]
00a62ef2 : PUSH 0x4
00a62ef4 : PUSH ECX
00a62ef5 : MOV EDI,EAX
00a62ef7 : CALL 0x006376ef
00a62efc : PUSH ESI
00a62efd : CALL 0x0063751f
00a62f02 : PUSH ESI
00a62f03 : PUSH 0x1
00a62f05 : LEA EDX,[EBP + 0xfffffef8]
00a62f0b : PUSH 0x4
00a62f0d : PUSH EDX
00a62f0e : MOV dword ptr [EBP + 0xfffffef8],EAX
00a62f14 : CALL 0x006376ef
00a62f19 : PUSH ESI
00a62f1a : PUSH 0x1
00a62f1c : LEA EAX,[EBP + 0xfffffef0]
00a62f22 : PUSH 0x4
00a62f24 : PUSH EAX
00a62f25 : CALL 0x006376ef
00a62f2a : MOV ECX,dword ptr [EBP + 0xfffffef8]
00a62f30 : PUSH EDI
00a62f31 : PUSH ECX
00a62f32 : CALL 0x00767e10
00a62f37 : ADD ESP,0x40
00a62f3a : PUSH ESI
00a62f3b : MOV dword ptr [EBP + 0xfffffef4],0x937437da
00a62f45 : CALL 0x0063751f
00a62f4a : PUSH ESI
00a62f4b : PUSH 0x1
00a62f4d : LEA EDX,[EBP + 0xfffffef4]
00a62f53 : PUSH 0x4
00a62f55 : PUSH EDX
00a62f56 : MOV EDI,EAX
00a62f58 : CALL 0x006376ef
00a62f5d : PUSH ESI
00a62f5e : CALL 0x0063751f
00a62f63 : PUSH ESI
00a62f64 : PUSH 0x1
00a62f66 : MOV dword ptr [EBP + 0xfffffef8],EAX
00a62f6c : PUSH 0x4
00a62f6e : LEA EAX,[EBP + 0xfffffef8]
00a62f74 : PUSH EAX
00a62f75 : CALL 0x006376ef
00a62f7a : ADD ESP,0x28
00a62f7d : PUSH EBX
00a62f7e : CALL 0x00a62b90
00a62f83 : MOV ECX,dword ptr [EBP + 0xfffffef8]
00a62f89 : PUSH EDI
00a62f8a : PUSH ECX
00a62f8b : CALL 0x00767e10
00a62f90 : PUSH ESI
00a62f91 : CALL 0x006366db
00a62f96 : MOV ECX,dword ptr [EBP + -0x4]
00a62f99 : ADD ESP,0xc
00a62f9c : POP EDI
00a62f9d : POP ESI
00a62f9e : XOR ECX,EBP
00a62fa0 : MOV AL,0x1
00a62fa2 : POP EBX
00a62fa3 : CALL 0x00633e6b
00a62fa8 : MOV ESP,EBP
00a62faa : POP EBP
00a62fab : RET 0x4

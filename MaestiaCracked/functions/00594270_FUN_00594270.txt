PROGRAM  : Maestia.exe
FUNCTION : FUN_00594270
ENTRY    : 00594270
BODY     : [[00594270, 005945ec] [005945f0, 005949dc] [005949e0, 00594dcb]]

============================================================
DECOMPILED C CODE
============================================================

GRefCountNTSImpl *
FUN_00594270(int param_1,int *param_2,uint param_3,undefined4 param_4,int param_5,uint param_6,
            int *param_7)

{
  undefined2 uVar1;
  code *pcVar2;
  char cVar3;
  char cVar4;
  int iVar5;
  int *piVar6;
  int *piVar7;
  int iVar8;
  int iVar9;
  GRefCountNTSImpl *pGVar10;
  uint *puVar11;
  uint uVar12;
  int iVar13;
  int in_ECX;
  byte unaff_BP;
  uint uVar14;
  uint3 unaff_ESI;
  int *unaff_retaddr;
  undefined4 uVar15;
  uint uVar16;
  undefined4 uStack_130;
  undefined4 local_12c;
  int iStack_128;
  int local_124;
  int iStack_120;
  undefined4 uStack_11c;
  GRefCountNTSImpl *pGStack_118;
  int iStack_114;
  int iStack_110;
  int iStack_10c;
  byte bStack_108;
  undefined4 uStack_104;
  undefined4 uStack_100;
  undefined4 uStack_fc;
  uint uStack_f8;
  undefined4 uStack_f4;
  undefined4 uStack_f0;
  undefined4 uStack_ec;
  uint uStack_e8;
  int iStack_e4;
  int iStack_e0;
  undefined4 uStack_dc;
  undefined4 uStack_d8;
  int iStack_d4;
  undefined4 uStack_d0;
  int iStack_cc;
  undefined4 uStack_c4;
  int *local_c0;
  int local_bc;
  undefined1 uStack_b8;
  undefined1 uStack_b7;
  undefined4 uStack_b4;
  undefined4 uStack_b0;
  undefined4 uStack_ac;
  undefined4 uStack_a8;
  undefined4 uStack_a4;
  undefined1 auStack_a0 [16];
  undefined1 auStack_90 [16];
  undefined1 auStack_80 [4];
  int iStack_7c;
  undefined1 auStack_70 [28];
  undefined1 local_54 [8];
  GRefCountNTSImpl *apGStack_4c [17];
  undefined4 uStack_8;
  int *piStack_4;
  
  uStack_130 = (int *)(CONCAT13(uStack_130._3_1_,
                                CONCAT12((char)(param_6 >> 2),(undefined2)uStack_130)) & 0xff01ffff)
  ;
  local_12c = CONCAT31(local_12c._1_3_,(char)param_6) & 0xffffff01;
  local_124 = in_ECX;
  if (param_7 == (int *)0x0) {
    param_7 = (int *)FUN_00565f40(local_54,*(undefined4 *)(param_1 + 0x44));
  }
  local_c0 = (int *)*param_7;
  local_bc = param_7[1];
  if (local_c0 == (int *)0x0) {
    iVar5 = *(int *)(in_ECX + 0x80);
    uVar1 = *(undefined2 *)(param_1 + 0x44);
    if (iVar5 == 0) {
      iVar5 = FUN_00520df0();
    }
    FUN_0058c450(in_ECX + 0xc,"%s, GFxSprite::AddDisplayObject(): unknown cid = %d\n",
                 **(undefined4 **)(iVar5 + 0xc),uVar1);
    return (GRefCountNTSImpl *)0x0;
  }
  local_12c._0_3_ = (uint3)(ushort)local_12c;
  piVar6 = (int *)FUN_005ecc60(*(undefined4 *)(param_1 + 0x40),(int)&local_12c + 2);
  if (uStack_130._2_1_ == '\0') {
    local_12c = CONCAT31(local_12c._1_3_,1);
  }
  else {
    if (local_12c._2_1_ == '\0') {
      if (piVar6 == (int *)0x0) goto LAB_005944b7;
      cVar3 = (**(code **)(*piVar6 + 0x10))();
      if (cVar3 == '\0') {
        return (GRefCountNTSImpl *)0x0;
      }
    }
    if (((piVar6 != (int *)0x0) && (-2 < piVar6[5])) && (piVar6[4] == *(int *)(param_1 + 0x44))) {
      if ((*(byte *)((int)piVar6 + 0x66) & 0x80) == 0) {
        piVar7 = (int *)(*(int *)(in_ECX + 0x144) + 8);
      }
      else {
        piVar7 = (int *)FUN_005214b0();
      }
      iVar5 = *piVar7;
      iVar9 = *(int *)(iVar5 + 8);
      iStack_120 = iVar9 + 1;
      *(int *)(iVar5 + 8) = iStack_120;
      if ((*(byte *)((int)piVar6 + 0x66) & 0x80) == 0) {
LAB_005943d8:
        iVar8 = param_5;
        if (param_5 == -1) {
          iVar8 = *(int *)(in_ECX + 0xbc);
        }
        if (piVar6[6] == iVar8) {
          FUN_0058afd0(param_1);
          if (((*(byte *)(param_1 + 0x4b) & 0x80) == 0) &&
             (iVar9 = (**(code **)(*piVar6 + 0xc))(), iVar9 != 0)) {
            uVar16 = (uint)piStack_4 >> 0x18;
            piStack_4._0_3_ = (uint3)(ushort)piStack_4;
            piStack_4 = (int *)(CONCAT13((char)uVar16,(uint3)piStack_4) | 0x80000000);
          }
          if (((*(byte *)(param_1 + 0x4b) & 8) == 0) && (cVar3 = FUN_0059d020(), cVar3 == '\0')) {
            piStack_4 = (int *)((uint)piStack_4 | 0x8000000);
            FUN_0059d000();
          }
          FUN_0058b050(apGStack_4c);
          if (apGStack_4c[0] != (GRefCountNTSImpl *)0x0) {
            GRefCountNTSImpl::Release(apGStack_4c[0]);
          }
          piVar6 = (int *)(iVar5 + 8);
          *piVar6 = *piVar6 + -1;
          if (*piVar6 == 0) {
            FUN_00525340();
          }
          return (GRefCountNTSImpl *)0x0;
        }
        local_12c = CONCAT31(local_12c._1_3_,1);
      }
      else if (*(int *)(*param_2 + 0x10) == 0) {
        if ((*(int *)(iVar5 + 0x10) == 0) || (((uint)piVar6[0x23] >> 0xe & 1) != 0))
        goto LAB_005943d8;
      }
      else if (iVar5 == *param_2) goto LAB_005943d8;
      *(int *)(iVar5 + 8) = iVar9;
      if (iVar9 == 0) {
        FUN_00525340();
      }
    }
  }
LAB_005944b7:
  puVar11 = (uint *)(*(int *)(in_ECX + 0xa0) + 0xb00);
  *puVar11 = *puVar11 | 0x400;
  pGVar10 = (GRefCountNTSImpl *)(**(code **)(*local_c0 + 0x24))();
  piVar6 = (int *)(-(uint)(((byte)pGVar10[0x66] & 0x80) != 0) & (uint)pGVar10);
  pGStack_118 = pGVar10;
  if (piVar6 == (int *)0x0) {
    iStack_128 = 0;
  }
  else {
    iStack_128 = FUN_0054ed10();
  }
  piVar7 = *(int **)(pGVar10 + 0x20);
  pGVar10[0x66] = (GRefCountNTSImpl)((byte)pGVar10[0x66] & 0xfe);
  uVar16 = (uint)unaff_BP;
  for (; piVar7 != (int *)0x0; piVar7 = (int *)piVar7[8]) {
    iVar5 = (**(code **)(*piVar7 + 0x38))();
    if (iVar5 != 0) {
      pcVar2 = *(code **)(*(int *)pGVar10 + 0x3c);
      pGVar10[0x66] = (GRefCountNTSImpl)((byte)pGVar10[0x66] | 1);
      (*pcVar2)();
      break;
    }
  }
  if (piVar6 != (int *)0x0) {
    if (*(int *)(*piStack_4 + 0x10) != 0) {
      (**(code **)(*(int *)pGVar10 + 0x24))(piStack_4);
      uVar16 = (uint)CONCAT11(1,unaff_BP);
    }
    if (param_5 != 0) {
      (**(code **)(*piVar6 + 0xd8))(param_5);
    }
    if ((param_3 & 4) == 0) {
      (**(code **)(*piVar6 + 0x14))(0);
    }
  }
  if (param_2 == (int *)0xffffffff) {
    param_2 = (int *)uStack_130[0x2f];
  }
  *(int **)(pGVar10 + 0x18) = param_2;
  uVar12 = CONCAT13(1,unaff_ESI);
  iVar5 = (**(code **)(*uStack_130 + 0x40))();
  cVar3 = (char)(unaff_ESI >> 0x10);
  if ((piVar6 != (int *)0x0) && (unaff_retaddr != (int *)0x0)) {
    local_12c = unaff_retaddr[1];
    uVar14 = 0;
    if (local_12c != 0) {
      do {
        FUN_00573e60(piVar6);
        if (((iStack_128 != 0) && ((**(uint **)(*unaff_retaddr + uVar14 * 4) & 0x3fc00) != 0)) &&
           (iVar9 = FUN_00593d00(), iVar9 != 0)) {
          *(undefined1 *)(iVar9 + 0x35) = 1;
        }
        if ((((cVar3 != '\0') && (piVar7 = *(int **)(*unaff_retaddr + uVar14 * 4), *piVar7 == 0x200)
             ) && ((iVar9 = piVar7[4], iVar9 != 0 &&
                   ((*(int *)(iVar9 + 0xc) != 0 && (**(char **)(iVar9 + 8) != '\0')))))) &&
           (iVar9 = FUN_00571c40(1), iVar9 != 0)) {
          FUN_004ffe70(0x200);
          *(undefined4 *)(iVar9 + 4) = 2;
          piVar6[1] = piVar6[1] + 1;
          if (*(GRefCountNTSImpl **)(iVar9 + 8) != (GRefCountNTSImpl *)0x0) {
            GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar9 + 8));
          }
          *(int **)(iVar9 + 8) = piVar6;
          if (*(GRefCountNTSImpl **)(iVar9 + 0xc) != (GRefCountNTSImpl *)0x0) {
            GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar9 + 0xc));
          }
          *(undefined4 *)(iVar9 + 0xc) = 0;
          *(undefined4 *)(iVar9 + 0x10) = uStack_b0;
          *(undefined4 *)(iVar9 + 0x14) = uStack_ac;
          *(undefined4 *)(iVar9 + 0x18) = uStack_a8;
          *(undefined4 *)(iVar9 + 0x1c) = uStack_a4;
        }
        uVar14 = uVar14 + 1;
      } while (uVar14 < local_12c);
    }
  }
  local_12c = 0;
  if (piVar6 == (int *)0x0) goto LAB_00594ca7;
  (**(code **)(*uStack_130 + 0xb0))();
  uVar15 = *(undefined4 *)(iStack_cc + 0xc);
  bStack_108 = 0;
  iStack_110 = 0;
  iStack_10c = 0;
  (**(code **)(*(int *)pGStack_118 + 0x48))(uVar15);
  puVar11 = (uint *)FUN_00564c70(uVar15);
  local_12c = FUN_0056a470(&uStack_b4);
  if (puVar11 != (uint *)0x0) {
    (**(code **)(*uStack_130 + 0x5c))();
    iStack_114 = FUN_00525450((*puVar11 & 0xfffffffc) + 8,
                              *(uint *)(*puVar11 & 0xfffffffc) & 0x7fffffff);
    *(int *)(iStack_114 + 8) = *(int *)(iStack_114 + 8) + 1;
    iVar9 = (**(code **)(*uStack_130 + 0x5c))();
    cVar4 = FUN_005304f0(iVar9 + 0x78,&iStack_114,&iStack_110);
    if (cVar4 == '\0') {
      if (cVar3 != '\0') {
        auStack_80[0] = 5;
        iStack_7c = iStack_114;
        *(int *)(iStack_114 + 8) = *(int *)(iStack_114 + 8) + 1;
        iStack_e4 = 0;
        iStack_e0 = 0;
        uStack_dc = 0;
        FUN_00504f00(auStack_80);
        FUN_00526bc0();
        iVar13 = FUN_00571c40(3);
        iVar9 = iStack_e4;
        iVar8 = iStack_e0;
        if (iVar13 != 0) {
          *(undefined4 *)(iVar13 + 4) = 4;
          piVar6[1] = piVar6[1] + 1;
          if (*(GRefCountNTSImpl **)(iVar13 + 8) != (GRefCountNTSImpl *)0x0) {
            GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar13 + 8));
          }
          *(int **)(iVar13 + 8) = piVar6;
          if (*(GRefCountNTSImpl **)(iVar13 + 0xc) != (GRefCountNTSImpl *)0x0) {
            GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar13 + 0xc));
          }
          *(undefined4 *)(iVar13 + 0xc) = 0;
          *(undefined1 **)(iVar13 + 0x2c) = &LAB_00592dd0;
          FUN_00504fd0(&iStack_e4);
          iVar9 = iStack_e4;
          iVar8 = iStack_e0;
        }
        for (; iStack_e4 = iVar9, iVar8 != 0; iVar8 = iVar8 + -1) {
          FUN_00526bc0();
          iVar9 = iStack_e4;
        }
        goto LAB_00594ac7;
      }
    }
    else {
      local_124 = 0;
      iStack_120 = 0;
      uStack_11c = 0;
      iVar9 = FUN_00571c40(1);
      FUN_00526210(&iStack_110);
      FUN_005034e0(&local_124,1);
      if (iStack_120 * 0x10 + -0x10 + local_124 != 0) {
        FUN_005266c0(auStack_70);
      }
      FUN_00526bc0();
      if (iVar9 != 0) {
        *(undefined4 *)(iVar9 + 4) = 4;
        piVar6[1] = piVar6[1] + 1;
        if (*(GRefCountNTSImpl **)(iVar9 + 8) != (GRefCountNTSImpl *)0x0) {
          GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar9 + 8));
        }
        *(int **)(iVar9 + 8) = piVar6;
        if (*(GRefCountNTSImpl **)(iVar9 + 0xc) != (GRefCountNTSImpl *)0x0) {
          GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar9 + 0xc));
        }
        *(undefined4 *)(iVar9 + 0xc) = 0;
        *(code **)(iVar9 + 0x2c) = FUN_00590eb0;
        FUN_00504fd0(&local_124);
      }
      iVar9 = FUN_00571c40(3);
      if (iVar9 != 0) {
        *(undefined4 *)(iVar9 + 4) = 2;
        uStack_104 = 0x40000;
        uStack_100 = 0;
        uStack_fc = 0xff000000;
        uStack_f8 = uStack_f8 & 0xffff0000;
        piVar6[1] = piVar6[1] + 1;
        if (*(GRefCountNTSImpl **)(iVar9 + 8) != (GRefCountNTSImpl *)0x0) {
          GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar9 + 8));
        }
        *(int **)(iVar9 + 8) = piVar6;
        if (*(GRefCountNTSImpl **)(iVar9 + 0xc) != (GRefCountNTSImpl *)0x0) {
          GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar9 + 0xc));
        }
        *(undefined4 *)(iVar9 + 0xc) = 0;
        *(undefined4 *)(iVar9 + 0x10) = uStack_104;
        *(undefined4 *)(iVar9 + 0x14) = uStack_100;
        *(undefined4 *)(iVar9 + 0x18) = uStack_fc;
        *(uint *)(iVar9 + 0x1c) = uStack_f8;
      }
      uVar12 = FUN_0051cf20();
      if ((5 < uVar12) && (param_1 != 0)) {
        FUN_00504ec0(0);
        auStack_a0[0] = 0;
        FUN_00527270(param_1);
        FUN_00504f00(auStack_a0);
        iVar9 = FUN_00571c40(3);
        if (iVar9 != 0) {
          *(undefined4 *)(iVar9 + 4) = 4;
          piVar6[1] = piVar6[1] + 1;
          if (*(GRefCountNTSImpl **)(iVar9 + 8) != (GRefCountNTSImpl *)0x0) {
            GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar9 + 8));
          }
          *(int **)(iVar9 + 8) = piVar6;
          if (*(GRefCountNTSImpl **)(iVar9 + 0xc) != (GRefCountNTSImpl *)0x0) {
            GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar9 + 0xc));
          }
          *(undefined4 *)(iVar9 + 0xc) = 0;
          *(code **)(iVar9 + 0x2c) = FUN_0058c9a0;
          FUN_00504fd0(&local_124);
        }
        FUN_00526bc0();
      }
      uVar16 = CONCAT13(1,(int3)uVar16);
      iVar13 = FUN_00571c40(3);
      iVar9 = local_124;
      iVar8 = iStack_120;
      if (iVar13 != 0) {
        *(undefined4 *)(iVar13 + 4) = 3;
        piVar6[1] = piVar6[1] + 1;
        if (*(GRefCountNTSImpl **)(iVar13 + 8) != (GRefCountNTSImpl *)0x0) {
          GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar13 + 8));
        }
        *(int **)(iVar13 + 8) = piVar6;
        if (*(GRefCountNTSImpl **)(iVar13 + 0xc) != (GRefCountNTSImpl *)0x0) {
          GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar13 + 0xc));
        }
        *(undefined4 *)(iVar13 + 0xc) = 0;
        FUN_00568a50(&iStack_110);
        iVar9 = local_124;
        iVar8 = iStack_120;
      }
      for (; local_124 = iVar9, iVar8 != 0; iVar8 = iVar8 + -1) {
        FUN_00526bc0();
        iVar9 = local_124;
      }
LAB_00594ac7:
      uVar12 = (uint)unaff_ESI;
      FUN_00515cf0(iVar9);
    }
    *(int *)(iStack_114 + 8) = *(int *)(iStack_114 + 8) + -1;
    if (*(int *)(iStack_114 + 8) == 0) {
      FUN_00525340();
    }
  }
  if ((char)(uVar12 >> 0x10) == '\0') {
    if ((((char)(uVar16 >> 0x18) == '\0') && (uVar14 = FUN_0051cf20(), 5 < uVar14)) &&
       (param_1 != 0)) {
      uStack_d8 = 0;
      iStack_d4 = 0;
      uStack_d0 = 0;
      auStack_90[0] = 0;
      FUN_00527270(param_1);
      FUN_00504f00(auStack_90);
      iVar9 = FUN_00571c40(3);
      if (iVar9 != 0) {
        *(undefined4 *)(iVar9 + 4) = 4;
        piVar6[1] = piVar6[1] + 1;
        if (*(GRefCountNTSImpl **)(iVar9 + 8) != (GRefCountNTSImpl *)0x0) {
          GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar9 + 8));
        }
        *(int **)(iVar9 + 8) = piVar6;
        if (*(GRefCountNTSImpl **)(iVar9 + 0xc) != (GRefCountNTSImpl *)0x0) {
          GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar9 + 0xc));
        }
        *(undefined4 *)(iVar9 + 0xc) = 0;
        *(code **)(iVar9 + 0x2c) = FUN_0058c9a0;
        FUN_00504fd0(&uStack_d8);
      }
      FUN_00526bc0();
      for (iVar9 = iStack_d4; iVar9 != 0; iVar9 = iVar9 + -1) {
        FUN_00526bc0();
      }
      FUN_00515cf0(uStack_d8);
    }
  }
  else if (((char)(uVar12 >> 0x18) != '\0') && (iVar9 = FUN_00571c40(3), iVar9 != 0)) {
    *(undefined4 *)(iVar9 + 4) = 2;
    uStack_f4 = 0x40000;
    uStack_f0 = 0;
    uStack_ec = 0xff000000;
    uStack_e8 = uStack_e8 & 0xffff0000;
    piVar6[1] = piVar6[1] + 1;
    if (*(GRefCountNTSImpl **)(iVar9 + 8) != (GRefCountNTSImpl *)0x0) {
      GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar9 + 8));
    }
    *(int **)(iVar9 + 8) = piVar6;
    if (*(GRefCountNTSImpl **)(iVar9 + 0xc) != (GRefCountNTSImpl *)0x0) {
      GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar9 + 0xc));
    }
    *(undefined4 *)(iVar9 + 0xc) = 0;
    *(undefined4 *)(iVar9 + 0x10) = uStack_f4;
    *(undefined4 *)(iVar9 + 0x14) = uStack_f0;
    *(undefined4 *)(iVar9 + 0x18) = uStack_ec;
    *(uint *)(iVar9 + 0x1c) = uStack_e8;
  }
  *(undefined4 *)(iVar5 + 0xa7c) = uStack_b4;
  if (((bStack_108 & 2) == 0) && (iStack_110 != 0)) {
    FUN_00503db0();
  }
  iStack_110 = 0;
  if (((bStack_108 & 1) == 0) && (iStack_10c != 0)) {
    FUN_00503db0();
  }
LAB_00594ca7:
  param_3 = param_3 & 0xfffffffe;
  if ((char)uVar16 != '\0') {
    param_3 = param_3 | 1;
  }
  if (piVar6 != (int *)0x0) {
    FUN_0051d570(iVar5);
    FUN_0051dcd0(iVar5);
  }
  FUN_005ed1a0(uStack_8,pGStack_118,param_3);
  cVar3 = (char)(uVar16 >> 8);
  if (cVar3 != '\0') {
    FUN_00576ae0(piVar6);
  }
  if ((piVar6 == (int *)0x0) || ((char)(uVar12 >> 0x10) != '\0')) {
    if (iStack_128 != 0) {
      *(byte *)(iStack_128 + 0x1c4) = *(byte *)(iStack_128 + 0x1c4) | 0x80;
    }
  }
  else {
    FUN_00575df0(local_12c);
    iVar5 = iStack_128;
    if (iStack_128 != 0) {
      uStack_c4 = 1;
      local_c0 = (int *)0x0;
      local_bc = -0x1000000;
      uStack_b8 = 0;
      uStack_b7 = 0;
      cVar4 = FUN_0058b3a0(&uStack_c4);
      if (cVar4 != '\0') {
        *(byte *)(iVar5 + 0x1c4) = *(byte *)(iVar5 + 0x1c4) | 0x80;
      }
    }
  }
  if (((piVar6 != (int *)0x0) && (cVar3 != '\0')) &&
     (*piStack_4 == *(int *)(uStack_130[0x51] + 0x204))) {
    FUN_00593440(piVar6);
  }
  pGVar10 = pGStack_118;
  GRefCountNTSImpl::Release(pGStack_118);
  return pGVar10;
}



============================================================
DISASSEMBLY
============================================================
00594270 : SUB ESP,0x130
00594276 : PUSH EBX
00594277 : PUSH EBP
00594278 : MOV EBP,dword ptr [ESP + 0x13c]
0059427f : PUSH ESI
00594280 : PUSH EDI
00594281 : MOV EDI,ECX
00594283 : MOV ECX,dword ptr [ESP + 0x158]
0059428a : MOV EAX,ECX
0059428c : SHR EAX,0x2
0059428f : AND AL,0x1
00594291 : MOV byte ptr [ESP + 0x12],AL
00594295 : MOV AL,CL
00594297 : AND AL,0x1
00594299 : MOV byte ptr [ESP + 0x14],AL
0059429d : MOV EAX,dword ptr [ESP + 0x15c]
005942a4 : XOR EBX,EBX
005942a6 : MOV dword ptr [ESP + 0x1c],EDI
005942aa : CMP EAX,EBX
005942ac : JNZ 0x005942c6
005942ae : PUSH ECX
005942af : MOV ECX,dword ptr [EBP + 0x44]
005942b2 : MOV EAX,ESP
005942b4 : LEA EDX,[ESP + 0xf0]
005942bb : MOV dword ptr [EAX],ECX
005942bd : MOV ECX,dword ptr [EDI + 0x7c]
005942c0 : PUSH EDX
005942c1 : CALL 0x00565f40
005942c6 : MOV ECX,dword ptr [EAX]
005942c8 : MOV EAX,dword ptr [EAX + 0x4]
005942cb : MOV dword ptr [ESP + 0x80],ECX
005942d2 : MOV dword ptr [ESP + 0x84],EAX
005942d9 : CMP ECX,EBX
005942db : JNZ 0x00594319
005942dd : MOV EAX,dword ptr [EDI + 0x80]
005942e3 : MOVZX ESI,word ptr [EBP + 0x44]
005942e7 : CMP EAX,EBX
005942e9 : JNZ 0x005942f2
005942eb : MOV ECX,EDI
005942ed : CALL 0x00520df0
005942f2 : MOV ECX,dword ptr [EAX + 0xc]
005942f5 : MOV EDX,dword ptr [ECX]
005942f7 : PUSH ESI
005942f8 : PUSH EDX
005942f9 : PUSH 0xb8e934
005942fe : ADD EDI,0xc
00594301 : PUSH EDI
00594302 : CALL 0x0058c450
00594307 : ADD ESP,0x10
0059430a : XOR EAX,EAX
0059430c : POP EDI
0059430d : POP ESI
0059430e : POP EBP
0059430f : POP EBX
00594310 : ADD ESP,0x130
00594316 : RET 0x20
00594319 : MOV EDX,dword ptr [EBP + 0x40]
0059431c : LEA EAX,[ESP + 0x16]
00594320 : PUSH EAX
00594321 : LEA ECX,[EDI + 0xa8]
00594327 : PUSH EDX
00594328 : MOV byte ptr [ESP + 0x1e],BL
0059432c : CALL 0x005ecc60
00594331 : MOV ESI,EAX
00594333 : CMP byte ptr [ESP + 0x12],BL
00594337 : JZ 0x005944b2
0059433d : CMP byte ptr [ESP + 0x16],BL
00594341 : JNZ 0x00594358
00594343 : CMP ESI,EBX
00594345 : JZ 0x005944b7
0059434b : MOV EAX,dword ptr [ESI]
0059434d : MOV EDX,dword ptr [EAX + 0x10]
00594350 : MOV ECX,ESI
00594352 : CALL EDX
00594354 : TEST AL,AL
00594356 : JZ 0x0059430a
00594358 : CMP ESI,EBX
0059435a : JZ 0x005944b7
00594360 : CMP dword ptr [ESI + 0x14],-0x1
00594364 : JL 0x005944b7
0059436a : MOV EAX,dword ptr [ESI + 0x10]
0059436d : CMP EAX,dword ptr [EBP + 0x44]
00594370 : JNZ 0x005944b7
00594376 : TEST byte ptr [ESI + 0x66],0x80
0059437a : JZ 0x00594385
0059437c : MOV ECX,ESI
0059437e : CALL 0x005214b0
00594383 : JMP 0x0059438e
00594385 : MOV EAX,dword ptr [EDI + 0x144]
0059438b : ADD EAX,0x8
0059438e : MOV EBP,dword ptr [EAX]
00594390 : MOV EAX,dword ptr [EBP + 0x8]
00594393 : INC EAX
00594394 : MOV dword ptr [EBP + 0x8],EAX
00594397 : TEST byte ptr [ESI + 0x66],0x80
0059439b : MOV dword ptr [ESP + 0x20],EAX
0059439f : JZ 0x005943d8
005943a1 : MOV EAX,dword ptr [ESP + 0x148]
005943a8 : MOV ECX,dword ptr [EAX]
005943aa : MOV EAX,dword ptr [ECX + 0x10]
005943ad : CMP EAX,EBX
005943af : JNZ 0x005943d0
005943b1 : CMP dword ptr [EBP + 0x10],EBX
005943b4 : JZ 0x005943d8
005943b6 : CMP EAX,EBX
005943b8 : JNZ 0x005943d0
005943ba : MOV EDX,dword ptr [ESI + 0x8c]
005943c0 : SHR EDX,0xe
005943c3 : TEST DL,0x1
005943c6 : JNZ 0x005943d8
005943c8 : CMP EAX,EBX
005943ca : JZ 0x0059449d
005943d0 : CMP EBP,ECX
005943d2 : JNZ 0x0059449d
005943d8 : MOV EAX,dword ptr [ESP + 0x154]
005943df : CMP EAX,-0x1
005943e2 : JNZ 0x005943ea
005943e4 : MOV EAX,dword ptr [EDI + 0xbc]
005943ea : CMP dword ptr [ESI + 0x18],EAX
005943ed : JNZ 0x00594498
005943f3 : MOV EAX,dword ptr [ESP + 0x144]
005943fa : PUSH EAX
005943fb : LEA ECX,[ESP + 0xf8]
00594402 : CALL 0x0058afd0
00594407 : MOV ECX,dword ptr [ESP + 0x144]
0059440e : TEST byte ptr [ECX + 0x4b],0x80
00594412 : JNZ 0x00594430
00594414 : MOV EDX,dword ptr [ESI]
00594416 : MOV EAX,dword ptr [EDX + 0xc]
00594419 : MOV ECX,ESI
0059441b : CALL EAX
0059441d : TEST EAX,EAX
0059441f : JZ 0x00594430
00594421 : OR byte ptr [ESP + 0x13f],0x80
00594429 : MOV byte ptr [ESP + 0x13e],BL
00594430 : MOV ECX,dword ptr [ESP + 0x144]
00594437 : TEST byte ptr [ECX + 0x4b],0x8
0059443b : JNZ 0x0059445d
0059443d : LEA ECX,[ESI + 0x24]
00594440 : CALL 0x0059d020
00594445 : TEST AL,AL
00594447 : JNZ 0x0059445d
00594449 : OR byte ptr [ESP + 0x13f],0x8
00594451 : LEA ECX,[ESP + 0xf8]
00594458 : CALL 0x0059d000
0059445d : LEA EDX,[ESP + 0xf4]
00594464 : PUSH EDX
00594465 : MOV ECX,EDI
00594467 : CALL 0x0058b050
0059446c : MOV ECX,dword ptr [ESP + 0xf4]
00594473 : CMP ECX,EBX
00594475 : JZ 0x0059447c
00594477 : CALL 0x004ff7c0
0059447c : ADD dword ptr [EBP + 0x8],-0x1
00594480 : JNZ 0x00594489
00594482 : MOV ECX,EBP
00594484 : CALL 0x00525340
00594489 : XOR EAX,EAX
0059448b : POP EDI
0059448c : POP ESI
0059448d : POP EBP
0059448e : POP EBX
0059448f : ADD ESP,0x130
00594495 : RET 0x20
00594498 : MOV byte ptr [ESP + 0x14],0x1
0059449d : MOV EAX,dword ptr [ESP + 0x20]
005944a1 : DEC EAX
005944a2 : MOV dword ptr [EBP + 0x8],EAX
005944a5 : CMP EAX,EBX
005944a7 : JNZ 0x005944b7
005944a9 : MOV ECX,EBP
005944ab : CALL 0x00525340
005944b0 : JMP 0x005944b7
005944b2 : MOV byte ptr [ESP + 0x14],0x1
005944b7 : MOV EAX,dword ptr [EDI + 0xa0]
005944bd : OR dword ptr [EAX + 0xb00],0x400
005944c7 : MOV EAX,dword ptr [ESP + 0x84]
005944ce : PUSH EAX
005944cf : PUSH ECX
005944d0 : MOV ECX,dword ptr [ESP + 0x14c]
005944d7 : MOV EDX,dword ptr [ECX + 0x44]
005944da : MOV ECX,dword ptr [ESP + 0x88]
005944e1 : MOV EAX,ESP
005944e3 : MOV dword ptr [EAX],EDX
005944e5 : MOV EAX,dword ptr [ECX]
005944e7 : MOV EDX,dword ptr [EAX + 0x24]
005944ea : PUSH EDI
005944eb : CALL EDX
005944ed : MOV EBP,EAX
005944ef : MOV AL,byte ptr [EBP + 0x66]
005944f2 : AND AL,0x80
005944f4 : MOVZX ESI,AL
005944f7 : NEG ESI
005944f9 : SBB ESI,ESI
005944fb : AND ESI,EBP
005944fd : MOV dword ptr [ESP + 0x34],EBP
00594501 : JZ 0x00594511
00594503 : LEA ECX,[ESI + 0x68]
00594506 : CALL 0x0054ed10
0059450b : MOV dword ptr [ESP + 0x24],EAX
0059450f : JMP 0x00594515
00594511 : MOV dword ptr [ESP + 0x24],EBX
00594515 : MOV EDI,dword ptr [EBP + 0x20]
00594518 : AND byte ptr [EBP + 0x66],0xfe
0059451c : MOV byte ptr [ESP + 0x15],BL
00594520 : CMP EDI,EBX
00594522 : JZ 0x00594548
00594524 : MOV EDX,dword ptr [EDI]
00594526 : MOV EAX,dword ptr [EDX + 0x38]
00594529 : MOV ECX,EDI
0059452b : CALL EAX
0059452d : TEST EAX,EAX
0059452f : JNZ 0x0059453a
00594531 : MOV EDI,dword ptr [EDI + 0x20]
00594534 : CMP EDI,EBX
00594536 : JNZ 0x00594524
00594538 : JMP 0x00594548
0059453a : MOV EDX,dword ptr [EBP]
0059453d : MOV EAX,dword ptr [EDX + 0x3c]
00594540 : OR byte ptr [EBP + 0x66],0x1
00594544 : MOV ECX,EBP
00594546 : CALL EAX
00594548 : CMP ESI,EBX
0059454a : JZ 0x00594596
0059454c : MOV ECX,dword ptr [ESP + 0x148]
00594553 : MOV EDX,dword ptr [ECX]
00594555 : CMP dword ptr [EDX + 0x10],EBX
00594558 : JZ 0x0059456a
0059455a : MOV EAX,dword ptr [EBP]
0059455d : MOV EDX,dword ptr [EAX + 0x24]
00594560 : PUSH ECX
00594561 : MOV ECX,EBP
00594563 : CALL EDX
00594565 : MOV byte ptr [ESP + 0x15],0x1
0059456a : MOV EAX,dword ptr [ESP + 0x160]
00594571 : CMP EAX,EBX
00594573 : JZ 0x00594582
00594575 : MOV EDX,dword ptr [ESI]
00594577 : PUSH EAX
00594578 : MOV EAX,dword ptr [EDX + 0xd8]
0059457e : MOV ECX,ESI
00594580 : CALL EAX
00594582 : TEST byte ptr [ESP + 0x158],0x4
0059458a : JNZ 0x00594596
0059458c : MOV EDX,dword ptr [ESI]
0059458e : MOV EAX,dword ptr [EDX + 0x14]
00594591 : PUSH EBX
00594592 : MOV ECX,ESI
00594594 : CALL EAX
00594596 : MOV EAX,dword ptr [ESP + 0x154]
0059459d : CMP EAX,-0x1
005945a0 : JNZ 0x005945ac
005945a2 : MOV ECX,dword ptr [ESP + 0x1c]
005945a6 : MOV EAX,dword ptr [ECX + 0xbc]
005945ac : MOV ECX,dword ptr [ESP + 0x1c]
005945b0 : MOV dword ptr [EBP + 0x18],EAX
005945b3 : MOV EDX,dword ptr [ECX]
005945b5 : MOV EAX,dword ptr [EDX + 0x40]
005945b8 : MOV byte ptr [ESP + 0x13],0x1
005945bd : CALL EAX
005945bf : MOV dword ptr [ESP + 0x18],EAX
005945c3 : CMP ESI,EBX
005945c5 : JZ 0x005946de
005945cb : MOV EDI,dword ptr [ESP + 0x14c]
005945d2 : CMP EDI,EBX
005945d4 : JZ 0x005946de
005945da : MOV EAX,dword ptr [EDI + 0x4]
005945dd : XOR EBP,EBP
005945df : MOV dword ptr [ESP + 0x20],EAX
005945e3 : CMP EAX,EBX
005945e5 : JBE 0x005946de
005945eb : JMP 0x005945f0
005945f0 : MOV ECX,dword ptr [EDI]
005945f2 : MOV ECX,dword ptr [ECX + EBP*0x4]
005945f5 : PUSH ESI
005945f6 : CALL 0x00573e60
005945fb : MOV ECX,dword ptr [ESP + 0x24]
005945ff : CMP ECX,EBX
00594601 : JZ 0x0059461d
00594603 : MOV EDX,dword ptr [EDI]
00594605 : MOV EAX,dword ptr [EDX + EBP*0x4]
00594608 : TEST dword ptr [EAX],0x3fc00
0059460e : JZ 0x0059461d
00594610 : CALL 0x00593d00
00594615 : CMP EAX,EBX
00594617 : JZ 0x0059461d
00594619 : MOV byte ptr [EAX + 0x35],0x1
0059461d : CMP byte ptr [ESP + 0x12],BL
00594621 : JZ 0x005946d3
00594627 : MOV EAX,dword ptr [EDI]
00594629 : MOV EAX,dword ptr [EAX + EBP*0x4]
0059462c : CMP dword ptr [EAX],0x200
00594632 : JNZ 0x005946d3
00594638 : MOV EAX,dword ptr [EAX + 0x10]
0059463b : CMP EAX,EBX
0059463d : JZ 0x005946d3
00594643 : CMP dword ptr [EAX + 0xc],0x1
00594647 : JC 0x005946d3
0059464d : MOV ECX,dword ptr [EAX + 0x8]
00594650 : CMP byte ptr [ECX],BL
00594652 : JZ 0x005946d3
00594654 : MOV ECX,dword ptr [ESP + 0x18]
00594658 : PUSH 0x1
0059465a : ADD ECX,0xa2c
00594660 : CALL 0x00571c40
00594665 : MOV EDI,EAX
00594667 : CMP EDI,EBX
00594669 : JZ 0x005946cc
0059466b : PUSH 0x200
00594670 : LEA ECX,[ESP + 0xa0]
00594677 : CALL 0x004ffe70
0059467c : MOV dword ptr [EDI + 0x4],0x2
00594683 : INC dword ptr [ESI + 0x4]
00594686 : MOV ECX,dword ptr [EDI + 0x8]
00594689 : CMP ECX,EBX
0059468b : JZ 0x00594692
0059468d : CALL 0x004ff7c0
00594692 : MOV dword ptr [EDI + 0x8],ESI
00594695 : MOV ECX,dword ptr [EDI + 0xc]
00594698 : CMP ECX,EBX
0059469a : JZ 0x005946a1
0059469c : CALL 0x004ff7c0
005946a1 : MOV EDX,dword ptr [ESP + 0x9c]
005946a8 : MOV EAX,dword ptr [ESP + 0xa0]
005946af : MOV ECX,dword ptr [ESP + 0xa4]
005946b6 : MOV dword ptr [EDI + 0xc],EBX
005946b9 : MOV dword ptr [EDI + 0x10],EDX
005946bc : MOV EDX,dword ptr [ESP + 0xa8]
005946c3 : MOV dword ptr [EDI + 0x14],EAX
005946c6 : MOV dword ptr [EDI + 0x18],ECX
005946c9 : MOV dword ptr [EDI + 0x1c],EDX
005946cc : MOV EDI,dword ptr [ESP + 0x14c]
005946d3 : INC EBP
005946d4 : CMP EBP,dword ptr [ESP + 0x20]
005946d8 : JC 0x005945f0
005946de : MOV dword ptr [ESP + 0x20],EBX
005946e2 : CMP ESI,EBX
005946e4 : JZ 0x00594ca7
005946ea : MOV ECX,dword ptr [ESP + 0x1c]
005946ee : MOV EAX,dword ptr [ECX]
005946f0 : MOV EDX,dword ptr [EAX + 0xb0]
005946f6 : CALL EDX
005946f8 : PUSH ECX
005946f9 : MOV ECX,dword ptr [ESP + 0x84]
00594700 : MOV EDX,dword ptr [ECX + 0xc]
00594703 : MOV ECX,dword ptr [ESP + 0x38]
00594707 : MOV EBP,EAX
00594709 : MOV EAX,ESP
0059470b : MOV byte ptr [ESP + 0x48],BL
0059470f : MOV dword ptr [ESP + 0x40],EBX
00594713 : MOV dword ptr [ESP + 0x44],EBX
00594717 : MOV dword ptr [EAX],EDX
00594719 : MOV EAX,dword ptr [ECX]
0059471b : MOV EDX,dword ptr [EAX + 0x48]
0059471e : CALL EDX
00594720 : MOV ECX,EAX
00594722 : CALL 0x00564c70
00594727 : MOV ECX,dword ptr [ESP + 0x18]
0059472b : MOV EDI,EAX
0059472d : LEA EAX,[ESP + 0x98]
00594734 : ADD ECX,0xa2c
0059473a : PUSH EAX
0059473b : CALL 0x0056a470
00594740 : MOV dword ptr [ESP + 0x20],EAX
00594744 : MOV byte ptr [ESP + 0x17],BL
00594748 : CMP EDI,EBX
0059474a : JZ 0x00594ae2
00594750 : MOV ECX,dword ptr [ESP + 0x1c]
00594754 : MOV EDX,dword ptr [ECX]
00594756 : MOV EAX,dword ptr [EDX + 0x5c]
00594759 : CALL EAX
0059475b : MOV EDX,dword ptr [EAX + 0x78]
0059475e : MOV EAX,dword ptr [EDI]
00594760 : MOV ECX,EAX
00594762 : AND ECX,0xfffffffc
00594765 : MOV ECX,dword ptr [ECX]
00594767 : AND ECX,0x7fffffff
0059476d : AND EAX,0xfffffffc
00594770 : PUSH ECX
00594771 : ADD EAX,0x8
00594774 : PUSH EAX
00594775 : LEA ECX,[EDX + 0x254]
0059477b : CALL 0x00525450
00594780 : MOV ECX,dword ptr [ESP + 0x1c]
00594784 : MOV dword ptr [ESP + 0x38],EAX
00594788 : INC dword ptr [EAX + 0x8]
0059478b : MOV EDX,dword ptr [ECX]
0059478d : MOV EAX,dword ptr [EDX + 0x5c]
00594790 : CALL EAX
00594792 : LEA ECX,[ESP + 0x3c]
00594796 : PUSH ECX
00594797 : LEA EDX,[ESP + 0x3c]
0059479b : PUSH EDX
0059479c : ADD EAX,0x78
0059479f : PUSH EAX
005947a0 : MOV ECX,EBP
005947a2 : CALL 0x005304f0
005947a7 : TEST AL,AL
005947a9 : JZ 0x005949f8
005947af : MOV EBP,dword ptr [ESP + 0x18]
005947b3 : ADD EBP,0xa2c
005947b9 : PUSH 0x1
005947bb : MOV ECX,EBP
005947bd : MOV dword ptr [ESP + 0x2c],EBX
005947c1 : MOV dword ptr [ESP + 0x30],EBX
005947c5 : MOV dword ptr [ESP + 0x34],EBX
005947c9 : CALL 0x00571c40
005947ce : MOV EDI,EAX
005947d0 : LEA EAX,[ESP + 0x3c]
005947d4 : PUSH EAX
005947d5 : LEA ECX,[ESP + 0xe0]
005947dc : CALL 0x00526210
005947e1 : PUSH 0x1
005947e3 : LEA ECX,[ESP + 0x2c]
005947e7 : PUSH ECX
005947e8 : CALL 0x005034e0
005947ed : MOV EDX,dword ptr [ESP + 0x2c]
005947f1 : MOV EAX,dword ptr [ESP + 0x28]
005947f5 : SHL EDX,0x4
005947f8 : LEA ECX,[EDX + EAX*0x1 + -0x10]
005947fc : CMP ECX,EBX
005947fe : JZ 0x0059480d
00594800 : LEA EDX,[ESP + 0xdc]
00594807 : PUSH EDX
00594808 : CALL 0x005266c0
0059480d : LEA ECX,[ESP + 0xdc]
00594814 : CALL 0x00526bc0
00594819 : CMP EDI,EBX
0059481b : JZ 0x00594859
0059481d : MOV dword ptr [EDI + 0x4],0x4
00594824 : INC dword ptr [ESI + 0x4]
00594827 : MOV ECX,dword ptr [EDI + 0x8]
0059482a : CMP ECX,EBX
0059482c : JZ 0x00594833
0059482e : CALL 0x004ff7c0
00594833 : MOV dword ptr [EDI + 0x8],ESI
00594836 : MOV ECX,dword ptr [EDI + 0xc]
00594839 : CMP ECX,EBX
0059483b : JZ 0x00594842
0059483d : CALL 0x004ff7c0
00594842 : LEA EAX,[ESP + 0x28]
00594846 : MOV dword ptr [EDI + 0xc],EBX
00594849 : PUSH EAX
0059484a : LEA ECX,[EDI + 0x30]
0059484d : MOV dword ptr [EDI + 0x2c],0x590eb0
00594854 : CALL 0x00504fd0
00594859 : PUSH 0x3
0059485b : MOV ECX,EBP
0059485d : CALL 0x00571c40
00594862 : MOV EDI,EAX
00594864 : CMP EDI,EBX
00594866 : JZ 0x005948d0
00594868 : XOR ECX,ECX
0059486a : MOV word ptr [ESP + 0x50],CX
0059486f : MOV dword ptr [EDI + 0x4],0x2
00594876 : MOV dword ptr [ESP + 0x48],0x40000
0059487e : MOV dword ptr [ESP + 0x4c],EBX
00594882 : MOV byte ptr [ESP + 0x52],BL
00594886 : MOV byte ptr [ESP + 0x53],0xff
0059488b : MOV byte ptr [ESP + 0x54],BL
0059488f : MOV byte ptr [ESP + 0x55],BL
00594893 : INC dword ptr [ESI + 0x4]
00594896 : MOV ECX,dword ptr [EDI + 0x8]
00594899 : CMP ECX,EBX
0059489b : JZ 0x005948a2
0059489d : CALL 0x004ff7c0
005948a2 : MOV dword ptr [EDI + 0x8],ESI
005948a5 : MOV ECX,dword ptr [EDI + 0xc]
005948a8 : CMP ECX,EBX
005948aa : JZ 0x005948b1
005948ac : CALL 0x004ff7c0
005948b1 : MOV EDX,dword ptr [ESP + 0x48]
005948b5 : MOV EAX,dword ptr [ESP + 0x4c]
005948b9 : MOV ECX,dword ptr [ESP + 0x50]
005948bd : MOV dword ptr [EDI + 0xc],EBX
005948c0 : MOV dword ptr [EDI + 0x10],EDX
005948c3 : MOV EDX,dword ptr [ESP + 0x54]
005948c7 : MOV dword ptr [EDI + 0x14],EAX
005948ca : MOV dword ptr [EDI + 0x18],ECX
005948cd : MOV dword ptr [EDI + 0x1c],EDX
005948d0 : MOV ECX,dword ptr [ESP + 0x1c]
005948d4 : MOV byte ptr [ESP + 0x13],BL
005948d8 : CALL 0x0051cf20
005948dd : CMP EAX,0x6
005948e0 : JC 0x0059497b
005948e6 : MOV EDI,dword ptr [ESP + 0x150]
005948ed : CMP EDI,EBX
005948ef : JZ 0x0059497b
005948f5 : PUSH EBX
005948f6 : LEA ECX,[ESP + 0x2c]
005948fa : CALL 0x00504ec0
005948ff : PUSH EDI
00594900 : LEA ECX,[ESP + 0xb0]
00594907 : MOV byte ptr [ESP + 0xb0],BL
0059490e : CALL 0x00527270
00594913 : LEA EAX,[ESP + 0xac]
0059491a : PUSH EAX
0059491b : LEA ECX,[ESP + 0x2c]
0059491f : CALL 0x00504f00
00594924 : PUSH 0x3
00594926 : MOV ECX,EBP
00594928 : CALL 0x00571c40
0059492d : MOV EDI,EAX
0059492f : CMP EDI,EBX
00594931 : JZ 0x0059496f
00594933 : MOV dword ptr [EDI + 0x4],0x4
0059493a : INC dword ptr [ESI + 0x4]
0059493d : MOV ECX,dword ptr [EDI + 0x8]
00594940 : CMP ECX,EBX
00594942 : JZ 0x00594949
00594944 : CALL 0x004ff7c0
00594949 : MOV dword ptr [EDI + 0x8],ESI
0059494c : MOV ECX,dword ptr [EDI + 0xc]
0059494f : CMP ECX,EBX
00594951 : JZ 0x00594958
00594953 : CALL 0x004ff7c0
00594958 : LEA ECX,[ESP + 0x28]
0059495c : PUSH ECX
0059495d : MOV dword ptr [EDI + 0xc],EBX
00594960 : LEA ECX,[EDI + 0x30]
00594963 : MOV dword ptr [EDI + 0x2c],0x58c9a0
0059496a : CALL 0x00504fd0
0059496f : LEA ECX,[ESP + 0xac]
00594976 : CALL 0x00526bc0
0059497b : PUSH 0x3
0059497d : MOV ECX,EBP
0059497f : MOV byte ptr [ESP + 0x1b],0x1
00594984 : CALL 0x00571c40
00594989 : MOV EDI,EAX
0059498b : CMP EDI,EBX
0059498d : JZ 0x005949c4
0059498f : MOV dword ptr [EDI + 0x4],0x3
00594996 : INC dword ptr [ESI + 0x4]
00594999 : MOV ECX,dword ptr [EDI + 0x8]
0059499c : CMP ECX,EBX
0059499e : JZ 0x005949a5
005949a0 : CALL 0x004ff7c0
005949a5 : MOV dword ptr [EDI + 0x8],ESI
005949a8 : MOV ECX,dword ptr [EDI + 0xc]
005949ab : CMP ECX,EBX
005949ad : JZ 0x005949b4
005949af : CALL 0x004ff7c0
005949b4 : LEA EDX,[ESP + 0x3c]
005949b8 : PUSH EDX
005949b9 : LEA ECX,[EDI + 0x20]
005949bc : MOV dword ptr [EDI + 0xc],EBX
005949bf : CALL 0x00568a50
005949c4 : MOV EAX,dword ptr [ESP + 0x2c]
005949c8 : MOV EDX,dword ptr [ESP + 0x28]
005949cc : MOV ECX,EAX
005949ce : SHL ECX,0x4
005949d1 : LEA EDI,[ECX + EDX*0x1 + -0x10]
005949d5 : CMP EAX,EBX
005949d7 : JBE 0x005949ef
005949d9 : MOV EBP,EAX
005949db : JMP 0x005949e0
005949e0 : MOV ECX,EDI
005949e2 : CALL 0x00526bc0
005949e7 : SUB EDI,0x10
005949ea : SUB EBP,0x1
005949ed : JNZ 0x005949e0
005949ef : MOV EAX,dword ptr [ESP + 0x28]
005949f3 : JMP 0x00594ac7
005949f8 : CMP byte ptr [ESP + 0x12],BL
005949fc : JZ 0x00594acd
00594a02 : MOV EAX,dword ptr [ESP + 0x38]
00594a06 : LEA ECX,[ESP + 0xcc]
00594a0d : PUSH ECX
00594a0e : MOV byte ptr [ESP + 0xd0],0x5
00594a16 : MOV dword ptr [ESP + 0xd4],EAX
00594a1d : MOV EBP,0x1
00594a22 : ADD dword ptr [EAX + 0x8],EBP
00594a25 : LEA ECX,[ESP + 0x6c]
00594a29 : MOV dword ptr [ESP + 0x6c],EBX
00594a2d : MOV dword ptr [ESP + 0x70],EBX
00594a31 : MOV dword ptr [ESP + 0x74],EBX
00594a35 : CALL 0x00504f00
00594a3a : LEA ECX,[ESP + 0xcc]
00594a41 : CALL 0x00526bc0
00594a46 : MOV ECX,dword ptr [ESP + 0x18]
00594a4a : PUSH 0x3
00594a4c : ADD ECX,0xa2c
00594a52 : CALL 0x00571c40
00594a57 : MOV EDI,EAX
00594a59 : CMP EDI,EBX
00594a5b : JZ 0x00594a99
00594a5d : MOV dword ptr [EDI + 0x4],0x4
00594a64 : ADD dword ptr [ESI + 0x4],EBP
00594a67 : MOV ECX,dword ptr [EDI + 0x8]
00594a6a : CMP ECX,EBX
00594a6c : JZ 0x00594a73
00594a6e : CALL 0x004ff7c0
00594a73 : MOV dword ptr [EDI + 0x8],ESI
00594a76 : MOV ECX,dword ptr [EDI + 0xc]
00594a79 : CMP ECX,EBX
00594a7b : JZ 0x00594a82
00594a7d : CALL 0x004ff7c0
00594a82 : LEA EDX,[ESP + 0x68]
00594a86 : MOV dword ptr [EDI + 0xc],EBX
00594a89 : PUSH EDX
00594a8a : LEA ECX,[EDI + 0x30]
00594a8d : MOV dword ptr [EDI + 0x2c],0x592dd0
00594a94 : CALL 0x00504fd0
00594a99 : MOV EAX,dword ptr [ESP + 0x6c]
00594a9d : MOV EDX,dword ptr [ESP + 0x68]
00594aa1 : MOV ECX,EAX
00594aa3 : SHL ECX,0x4
00594aa6 : MOV byte ptr [ESP + 0x13],BL
00594aaa : LEA EDI,[ECX + EDX*0x1 + -0x10]
00594aae : CMP EAX,EBX
00594ab0 : JBE 0x00594ac3
00594ab2 : MOV EBP,EAX
00594ab4 : MOV ECX,EDI
00594ab6 : CALL 0x00526bc0
00594abb : SUB EDI,0x10
00594abe : SUB EBP,0x1
00594ac1 : JNZ 0x00594ab4
00594ac3 : MOV EAX,dword ptr [ESP + 0x68]
00594ac7 : PUSH EAX
00594ac8 : CALL 0x00515cf0
00594acd : MOV EAX,dword ptr [ESP + 0x38]
00594ad1 : DEC dword ptr [EAX + 0x8]
00594ad4 : MOV ECX,EAX
00594ad6 : ADD EAX,0x8
00594ad9 : CMP dword ptr [EAX],EBX
00594adb : JNZ 0x00594ae2
00594add : CALL 0x00525340
00594ae2 : CMP byte ptr [ESP + 0x12],BL
00594ae6 : JZ 0x00594b7e
00594aec : CMP byte ptr [ESP + 0x13],BL
00594af0 : JZ 0x00594c6a
00594af6 : MOV ECX,dword ptr [ESP + 0x18]
00594afa : PUSH 0x3
00594afc : ADD ECX,0xa2c
00594b02 : CALL 0x00571c40
00594b07 : MOV EDI,EAX
00594b09 : CMP EDI,EBX
00594b0b : JZ 0x00594c6a
00594b11 : XOR ECX,ECX
00594b13 : MOV word ptr [ESP + 0x60],CX
00594b18 : MOV dword ptr [EDI + 0x4],0x2
00594b1f : MOV dword ptr [ESP + 0x58],0x40000
00594b27 : MOV dword ptr [ESP + 0x5c],EBX
00594b2b : MOV byte ptr [ESP + 0x62],BL
00594b2f : MOV byte ptr [ESP + 0x63],0xff
00594b34 : MOV byte ptr [ESP + 0x64],BL
00594b38 : MOV byte ptr [ESP + 0x65],BL
00594b3c : INC dword ptr [ESI + 0x4]
00594b3f : MOV ECX,dword ptr [EDI + 0x8]
00594b42 : CMP ECX,EBX
00594b44 : JZ 0x00594b4b
00594b46 : CALL 0x004ff7c0
00594b4b : MOV dword ptr [EDI + 0x8],ESI
00594b4e : MOV ECX,dword ptr [EDI + 0xc]
00594b51 : CMP ECX,EBX
00594b53 : JZ 0x00594b5a
00594b55 : CALL 0x004ff7c0
00594b5a : MOV EDX,dword ptr [ESP + 0x58]
00594b5e : MOV EAX,dword ptr [ESP + 0x5c]
00594b62 : MOV ECX,dword ptr [ESP + 0x60]
00594b66 : MOV dword ptr [EDI + 0xc],EBX
00594b69 : MOV dword ptr [EDI + 0x10],EDX
00594b6c : MOV EDX,dword ptr [ESP + 0x64]
00594b70 : MOV dword ptr [EDI + 0x14],EAX
00594b73 : MOV dword ptr [EDI + 0x18],ECX
00594b76 : MOV dword ptr [EDI + 0x1c],EDX
00594b79 : JMP 0x00594c6a
00594b7e : CMP byte ptr [ESP + 0x17],BL
00594b82 : JNZ 0x00594c6a
00594b88 : MOV ECX,dword ptr [ESP + 0x1c]
00594b8c : CALL 0x0051cf20
00594b91 : CMP EAX,0x6
00594b94 : JC 0x00594c6a
00594b9a : MOV EAX,dword ptr [ESP + 0x150]
00594ba1 : CMP EAX,EBX
00594ba3 : JZ 0x00594c6a
00594ba9 : PUSH EAX
00594baa : LEA ECX,[ESP + 0xc0]
00594bb1 : MOV dword ptr [ESP + 0x78],EBX
00594bb5 : MOV dword ptr [ESP + 0x7c],EBX
00594bb9 : MOV dword ptr [ESP + 0x80],EBX
00594bc0 : MOV byte ptr [ESP + 0xc0],BL
00594bc7 : CALL 0x00527270
00594bcc : LEA EAX,[ESP + 0xbc]
00594bd3 : PUSH EAX
00594bd4 : LEA ECX,[ESP + 0x78]
00594bd8 : CALL 0x00504f00
00594bdd : MOV ECX,dword ptr [ESP + 0x18]
00594be1 : PUSH 0x3
00594be3 : ADD ECX,0xa2c
00594be9 : CALL 0x00571c40
00594bee : MOV EDI,EAX
00594bf0 : CMP EDI,EBX
00594bf2 : JZ 0x00594c30
00594bf4 : MOV dword ptr [EDI + 0x4],0x4
00594bfb : INC dword ptr [ESI + 0x4]
00594bfe : MOV ECX,dword ptr [EDI + 0x8]
00594c01 : CMP ECX,EBX
00594c03 : JZ 0x00594c0a
00594c05 : CALL 0x004ff7c0
00594c0a : MOV dword ptr [EDI + 0x8],ESI
00594c0d : MOV ECX,dword ptr [EDI + 0xc]
00594c10 : CMP ECX,EBX
00594c12 : JZ 0x00594c19
00594c14 : CALL 0x004ff7c0
00594c19 : LEA ECX,[ESP + 0x74]
00594c1d : PUSH ECX
00594c1e : MOV dword ptr [EDI + 0xc],EBX
00594c21 : LEA ECX,[EDI + 0x30]
00594c24 : MOV dword ptr [EDI + 0x2c],0x58c9a0
00594c2b : CALL 0x00504fd0
00594c30 : LEA ECX,[ESP + 0xbc]
00594c37 : CALL 0x00526bc0
00594c3c : MOV EBP,dword ptr [ESP + 0x78]
00594c40 : MOV EAX,dword ptr [ESP + 0x74]
00594c44 : MOV EDX,EBP
00594c46 : SHL EDX,0x4
00594c49 : LEA EDI,[EDX + EAX*0x1 + -0x10]
00594c4d : CMP EBP,EBX
00594c4f : JBE 0x00594c60
00594c51 : MOV ECX,EDI
00594c53 : CALL 0x00526bc0
00594c58 : SUB EDI,0x10
00594c5b : SUB EBP,0x1
00594c5e : JNZ 0x00594c51
00594c60 : MOV ECX,dword ptr [ESP + 0x74]
00594c64 : PUSH ECX
00594c65 : CALL 0x00515cf0
00594c6a : TEST byte ptr [ESP + 0x44],0x2
00594c6f : MOV EDX,dword ptr [ESP + 0x98]
00594c76 : MOV EAX,dword ptr [ESP + 0x18]
00594c7a : MOV dword ptr [EAX + 0xa7c],EDX
00594c80 : JNZ 0x00594c8f
00594c82 : MOV ECX,dword ptr [ESP + 0x3c]
00594c86 : CMP ECX,EBX
00594c88 : JZ 0x00594c8f
00594c8a : CALL 0x00503db0
00594c8f : TEST byte ptr [ESP + 0x44],0x1
00594c94 : MOV dword ptr [ESP + 0x3c],EBX
00594c98 : JNZ 0x00594ca7
00594c9a : MOV ECX,dword ptr [ESP + 0x40]
00594c9e : CMP ECX,EBX
00594ca0 : JZ 0x00594ca7
00594ca2 : CALL 0x00503db0
00594ca7 : AND dword ptr [ESP + 0x158],0xfffffffe
00594caf : CMP byte ptr [ESP + 0x14],BL
00594cb3 : JZ 0x00594cbd
00594cb5 : OR dword ptr [ESP + 0x158],0x1
00594cbd : MOV EDI,dword ptr [ESP + 0x18]
00594cc1 : CMP ESI,EBX
00594cc3 : JZ 0x00594cd5
00594cc5 : PUSH EDI
00594cc6 : MOV ECX,ESI
00594cc8 : CALL 0x0051d570
00594ccd : PUSH EDI
00594cce : MOV ECX,ESI
00594cd0 : CALL 0x0051dcd0
00594cd5 : MOV ECX,dword ptr [ESP + 0x158]
00594cdc : MOV EDX,dword ptr [ESP + 0x34]
00594ce0 : MOV EAX,dword ptr [ESP + 0x144]
00594ce7 : MOV EBP,dword ptr [ESP + 0x1c]
00594ceb : PUSH ECX
00594cec : PUSH EDX
00594ced : PUSH EAX
00594cee : LEA ECX,[EBP + 0xa8]
00594cf4 : CALL 0x005ed1a0
00594cf9 : CMP byte ptr [ESP + 0x15],BL
00594cfd : JZ 0x00594d07
00594cff : PUSH ESI
00594d00 : MOV ECX,EDI
00594d02 : CALL 0x00576ae0
00594d07 : CMP ESI,EBX
00594d09 : JZ 0x00594d7a
00594d0b : CMP byte ptr [ESP + 0x12],BL
00594d0f : JNZ 0x00594d7a
00594d11 : MOV ECX,dword ptr [ESP + 0x20]
00594d15 : PUSH ECX
00594d16 : MOV ECX,EDI
00594d18 : CALL 0x00575df0
00594d1d : MOV EDI,dword ptr [ESP + 0x24]
00594d21 : CMP EDI,EBX
00594d23 : JZ 0x00594d89
00594d25 : LEA EAX,[ESP + 0x88]
00594d2c : XOR EDX,EDX
00594d2e : PUSH EAX
00594d2f : MOV ECX,EDI
00594d31 : MOV dword ptr [ESP + 0x8c],0x1
00594d3c : MOV dword ptr [ESP + 0x90],EBX
00594d43 : MOV word ptr [ESP + 0x94],DX
00594d4b : MOV byte ptr [ESP + 0x96],BL
00594d52 : MOV byte ptr [ESP + 0x97],0xff
00594d5a : MOV byte ptr [ESP + 0x98],BL
00594d61 : MOV byte ptr [ESP + 0x99],BL
00594d68 : CALL 0x0058b3a0
00594d6d : TEST AL,AL
00594d6f : JZ 0x00594d89
00594d71 : OR byte ptr [EDI + 0x1c4],0x80
00594d78 : JMP 0x00594d89
00594d7a : MOV EAX,dword ptr [ESP + 0x24]
00594d7e : CMP EAX,EBX
00594d80 : JZ 0x00594d89
00594d82 : OR byte ptr [EAX + 0x1c4],0x80
00594d89 : CMP ESI,EBX
00594d8b : JZ 0x00594db2
00594d8d : CMP byte ptr [ESP + 0x15],BL
00594d91 : JZ 0x00594db2
00594d93 : MOV EDX,dword ptr [ESP + 0x148]
00594d9a : MOV ECX,dword ptr [EBP + 0x144]
00594da0 : MOV EAX,dword ptr [EDX]
00594da2 : CMP EAX,dword ptr [ECX + 0x204]
00594da8 : JNZ 0x00594db2
00594daa : PUSH ESI
00594dab : MOV ECX,EBP
00594dad : CALL 0x00593440
00594db2 : MOV ESI,dword ptr [ESP + 0x34]
00594db6 : MOV ECX,ESI
00594db8 : CALL 0x004ff7c0
00594dbd : POP EDI
00594dbe : MOV EAX,ESI
00594dc0 : POP ESI
00594dc1 : POP EBP
00594dc2 : POP EBX
00594dc3 : ADD ESP,0x130
00594dc9 : RET 0x20

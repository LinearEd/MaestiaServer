PROGRAM  : Maestia.exe
FUNCTION : _strcat_s
ENTRY    : 0063db33
BODY     : [[0063db33, 0063dba6]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    _strcat_s
   
   Library: Visual Studio 2008 Release */

errno_t __cdecl _strcat_s(char *_Dst,rsize_t _SizeInBytes,char *_Src)

{
  char cVar1;
  int *piVar2;
  char *pcVar3;
  errno_t eVar4;
  
  if ((_Dst != (char *)0x0) && (_SizeInBytes != 0)) {
    pcVar3 = _Dst;
    if (_Src != (char *)0x0) {
      do {
        if (*pcVar3 == '\0') break;
        pcVar3 = pcVar3 + 1;
        _SizeInBytes = _SizeInBytes - 1;
      } while (_SizeInBytes != 0);
      if (_SizeInBytes != 0) {
        do {
          cVar1 = *_Src;
          *pcVar3 = cVar1;
          pcVar3 = pcVar3 + 1;
          _Src = _Src + 1;
          if (cVar1 == '\0') break;
          _SizeInBytes = _SizeInBytes - 1;
        } while (_SizeInBytes != 0);
        if (_SizeInBytes != 0) {
          return 0;
        }
        *_Dst = '\0';
        piVar2 = __errno();
        eVar4 = 0x22;
        *piVar2 = 0x22;
        goto LAB_0063db55;
      }
    }
    *_Dst = '\0';
  }
  piVar2 = __errno();
  eVar4 = 0x16;
  *piVar2 = 0x16;
LAB_0063db55:
  __invalid_parameter(0,0,0,0,0);
  return eVar4;
}



============================================================
DISASSEMBLY
============================================================
0063db33 : MOV EDI,EDI
0063db35 : PUSH EBP
0063db36 : MOV EBP,ESP
0063db38 : MOV EAX,dword ptr [EBP + 0x8]
0063db3b : PUSH EBX
0063db3c : XOR EBX,EBX
0063db3e : PUSH ESI
0063db3f : PUSH EDI
0063db40 : CMP EAX,EBX
0063db42 : JZ 0x0063db4b
0063db44 : MOV EDI,dword ptr [EBP + 0xc]
0063db47 : CMP EDI,EBX
0063db49 : JA 0x0063db66
0063db4b : CALL 0x0063ab82
0063db50 : PUSH 0x16
0063db52 : POP ESI
0063db53 : MOV dword ptr [EAX],ESI
0063db55 : PUSH EBX
0063db56 : PUSH EBX
0063db57 : PUSH EBX
0063db58 : PUSH EBX
0063db59 : PUSH EBX
0063db5a : CALL 0x006372b8
0063db5f : ADD ESP,0x14
0063db62 : MOV EAX,ESI
0063db64 : JMP 0x0063dba2
0063db66 : MOV ESI,dword ptr [EBP + 0x10]
0063db69 : CMP ESI,EBX
0063db6b : JNZ 0x0063db71
0063db6d : MOV byte ptr [EAX],BL
0063db6f : JMP 0x0063db4b
0063db71 : MOV EDX,EAX
0063db73 : CMP byte ptr [EDX],BL
0063db75 : JZ 0x0063db7b
0063db77 : INC EDX
0063db78 : DEC EDI
0063db79 : JNZ 0x0063db73
0063db7b : CMP EDI,EBX
0063db7d : JZ 0x0063db6d
0063db7f : MOV CL,byte ptr [ESI]
0063db81 : MOV byte ptr [EDX],CL
0063db83 : INC EDX
0063db84 : INC ESI
0063db85 : CMP CL,BL
0063db87 : JZ 0x0063db8c
0063db89 : DEC EDI
0063db8a : JNZ 0x0063db7f
0063db8c : CMP EDI,EBX
0063db8e : JNZ 0x0063dba0
0063db90 : MOV byte ptr [EAX],BL
0063db92 : CALL 0x0063ab82
0063db97 : PUSH 0x22
0063db99 : POP ECX
0063db9a : MOV dword ptr [EAX],ECX
0063db9c : MOV ESI,ECX
0063db9e : JMP 0x0063db55
0063dba0 : XOR EAX,EAX
0063dba2 : POP EDI
0063dba3 : POP ESI
0063dba4 : POP EBX
0063dba5 : POP EBP
0063dba6 : RET

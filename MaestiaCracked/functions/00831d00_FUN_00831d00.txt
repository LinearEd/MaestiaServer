PROGRAM  : Maestia.exe
FUNCTION : FUN_00831d00
ENTRY    : 00831d00
BODY     : [[00831d00, 00831f56]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00831d00(void)

{
  wchar_t wVar1;
  bool bVar2;
  bool bVar3;
  short sVar4;
  uint uVar5;
  int iVar6;
  wchar_t *pwVar7;
  wchar_t *in_ECX;
  int iVar8;
  uint local_13c;
  uint local_120;
  int local_11c;
  wchar_t local_114;
  undefined1 local_112 [252];
  undefined2 local_16;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1b43c;
  local_10 = ExceptionList;
  uVar5 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  bVar3 = false;
  pwVar7 = in_ECX;
  do {
    wVar1 = *pwVar7;
    pwVar7 = pwVar7 + 1;
  } while (wVar1 != L'\0');
  local_14 = uVar5;
  if ((int)pwVar7 - (int)(in_ECX + 1) >> 1 != 0) {
    _memset(&local_114,0,0x100);
    pwVar7 = in_ECX;
    do {
      wVar1 = *pwVar7;
      pwVar7 = pwVar7 + 1;
    } while (wVar1 != L'\0');
    _wcsncpy(&local_114,in_ECX,(int)pwVar7 - (int)(in_ECX + 1) >> 1);
    local_16 = 0;
    sVar4 = FUN_00634f4d(&local_114);
    if (sVar4 == 0) {
      pwVar7 = &local_114;
      do {
        wVar1 = *pwVar7;
        pwVar7 = pwVar7 + 1;
      } while (wVar1 != L'\0');
      iVar6 = (int)pwVar7 - (int)local_112 >> 1;
      iVar8 = 0;
      if (0 < iVar6) {
        do {
          if (*(short *)(local_112 + iVar8 * 2 + -2) == 0x5f) {
            *(undefined2 *)(local_112 + iVar8 * 2 + -2) = 0x20;
          }
          iVar8 = iVar8 + 1;
        } while (iVar8 < iVar6);
      }
      local_11c = 1;
      do {
        iVar6 = FUN_00703c00(0x600);
        if (iVar6 == 0) {
LAB_00831e3a:
          bVar2 = true;
        }
        else {
          iVar8 = FUN_00404350(iVar6 + 0x18);
          bVar3 = true;
          if (*(int *)(iVar8 + 0x14) == 0) goto LAB_00831e3a;
          bVar2 = false;
        }
        local_8 = 0xffffffff;
        if (bVar3) {
          bVar3 = false;
          if (7 < local_120) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          local_120 = 7;
        }
        if (!bVar2) {
          iVar6 = FUN_00404350(iVar6 + 0x18);
          local_8 = 1;
          if (*(uint *)(iVar6 + 0x18) < 8) {
            pwVar7 = (wchar_t *)(iVar6 + 4);
          }
          else {
            pwVar7 = *(wchar_t **)(iVar6 + 4);
          }
          pwVar7 = _wcsstr(&local_114,pwVar7);
          local_8 = 0xffffffff;
          if (7 < local_13c) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          local_13c = 7;
          if (pwVar7 != (wchar_t *)0x0) break;
        }
        local_8 = 0xffffffff;
        local_11c = local_11c + 1;
      } while (local_11c < 0xffff);
    }
    else {
      FUN_00703c00(0x600,uVar5);
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00831d00 : PUSH EBP
00831d01 : MOV EBP,ESP
00831d03 : PUSH -0x1
00831d05 : PUSH 0xb1b43c
00831d0a : MOV EAX,FS:[0x0]
00831d10 : PUSH EAX
00831d11 : SUB ESP,0x144
00831d17 : MOV EAX,[0x00d66fa0]
00831d1c : XOR EAX,EBP
00831d1e : MOV dword ptr [EBP + -0x10],EAX
00831d21 : PUSH EBX
00831d22 : PUSH ESI
00831d23 : PUSH EDI
00831d24 : PUSH EAX
00831d25 : LEA EAX,[EBP + -0xc]
00831d28 : MOV FS:[0x0],EAX
00831d2e : MOV ESI,ECX
00831d30 : MOV EAX,ESI
00831d32 : MOV dword ptr [EBP + 0xfffffeec],0x0
00831d3c : LEA EDX,[EAX + 0x2]
00831d3f : NOP
00831d40 : MOV CX,word ptr [EAX]
00831d43 : ADD EAX,0x2
00831d46 : TEST CX,CX
00831d49 : JNZ 0x00831d40
00831d4b : SUB EAX,EDX
00831d4d : SAR EAX,0x1
00831d4f : JZ 0x00831f1c
00831d55 : PUSH 0x100
00831d5a : LEA EAX,[EBP + 0xfffffef0]
00831d60 : PUSH 0x0
00831d62 : PUSH EAX
00831d63 : CALL 0x0063b700
00831d68 : MOV EAX,ESI
00831d6a : ADD ESP,0xc
00831d6d : LEA EDX,[EAX + 0x2]
00831d70 : MOV CX,word ptr [EAX]
00831d73 : ADD EAX,0x2
00831d76 : TEST CX,CX
00831d79 : JNZ 0x00831d70
00831d7b : SUB EAX,EDX
00831d7d : SAR EAX,0x1
00831d7f : PUSH EAX
00831d80 : LEA ECX,[EBP + 0xfffffef0]
00831d86 : PUSH ESI
00831d87 : PUSH ECX
00831d88 : CALL 0x00634e39
00831d8d : LEA EAX,[EBP + 0xfffffef0]
00831d93 : XOR EDX,EDX
00831d95 : PUSH EAX
00831d96 : MOV word ptr [EBP + -0x12],DX
00831d9a : CALL 0x00634f4d
00831d9f : MOVZX EDI,AX
00831da2 : ADD ESP,0x10
00831da5 : TEST DI,DI
00831da8 : JNZ 0x00831f40
00831dae : LEA EAX,[EBP + 0xfffffef0]
00831db4 : LEA EDX,[EAX + 0x2]
00831db7 : MOV CX,word ptr [EAX]
00831dba : ADD EAX,0x2
00831dbd : TEST CX,CX
00831dc0 : JNZ 0x00831db7
00831dc2 : SUB EAX,EDX
00831dc4 : SAR EAX,0x1
00831dc6 : XOR ECX,ECX
00831dc8 : TEST EAX,EAX
00831dca : JLE 0x00831ded
00831dcc : LEA ESP,[ESP]
00831dd0 : CMP word ptr [EBP + ECX*0x2 + 0xfffffef0],0x5f
00831dd9 : JNZ 0x00831de8
00831ddb : MOV EDX,0x20
00831de0 : MOV word ptr [EBP + ECX*0x2 + 0xfffffef0],DX
00831de8 : INC ECX
00831de9 : CMP ECX,EAX
00831deb : JL 0x00831dd0
00831ded : MOV dword ptr [EBP + 0xfffffee8],0x1
00831df7 : MOV EDI,dword ptr [EBP + 0xfffffee8]
00831dfd : PUSH 0x600
00831e02 : CALL 0x00703c00
00831e07 : MOV EDI,EAX
00831e09 : ADD ESP,0x4
00831e0c : TEST EDI,EDI
00831e0e : JZ 0x00831e3a
00831e10 : LEA EAX,[EDI + 0x18]
00831e13 : PUSH EAX
00831e14 : LEA ESI,[EBP + 0xfffffecc]
00831e1a : CALL 0x00404350
00831e1f : ADD ESP,0x4
00831e22 : MOV dword ptr [EBP + -0x4],0x0
00831e29 : OR dword ptr [EBP + 0xfffffeec],0x1
00831e30 : CMP dword ptr [EAX + 0x14],0x0
00831e34 : JZ 0x00831e3a
00831e36 : XOR BL,BL
00831e38 : JMP 0x00831e3c
00831e3a : MOV BL,0x1
00831e3c : MOV dword ptr [EBP + -0x4],0xffffffff
00831e43 : TEST byte ptr [EBP + 0xfffffeec],0x1
00831e4a : JZ 0x00831e84
00831e4c : AND dword ptr [EBP + 0xfffffeec],0xfffffffe
00831e53 : CMP dword ptr [EBP + 0xfffffee4],0x8
00831e5a : JC 0x00831e67
00831e5c : MOV ECX,dword ptr [EBP + 0xfffffed0]
00831e62 : CALL 0x006f04e0
00831e67 : XOR ECX,ECX
00831e69 : MOV dword ptr [EBP + 0xfffffee4],0x7
00831e73 : MOV dword ptr [EBP + 0xfffffee0],0x0
00831e7d : MOV word ptr [EBP + 0xfffffed0],CX
00831e84 : TEST BL,BL
00831e86 : JNZ 0x00831f04
00831e8c : LEA EDX,[EDI + 0x18]
00831e8f : PUSH EDX
00831e90 : LEA ESI,[EBP + 0xfffffeb0]
00831e96 : CALL 0x00404350
00831e9b : ADD ESP,0x4
00831e9e : MOV dword ptr [EBP + -0x4],0x1
00831ea5 : CMP dword ptr [EAX + 0x18],0x8
00831ea9 : JC 0x00831eb0
00831eab : MOV EAX,dword ptr [EAX + 0x4]
00831eae : JMP 0x00831eb3
00831eb0 : ADD EAX,0x4
00831eb3 : PUSH EAX
00831eb4 : LEA EAX,[EBP + 0xfffffef0]
00831eba : PUSH EAX
00831ebb : CALL 0x006347ba
00831ec0 : ADD ESP,0x8
00831ec3 : TEST EAX,EAX
00831ec5 : SETNZ BL
00831ec8 : MOV dword ptr [EBP + -0x4],0xffffffff
00831ecf : CMP dword ptr [EBP + 0xfffffec8],0x8
00831ed6 : JC 0x00831ee3
00831ed8 : MOV ECX,dword ptr [EBP + 0xfffffeb4]
00831ede : CALL 0x006f04e0
00831ee3 : XOR ECX,ECX
00831ee5 : MOV dword ptr [EBP + 0xfffffec8],0x7
00831eef : MOV dword ptr [EBP + 0xfffffec4],0x0
00831ef9 : MOV word ptr [EBP + 0xfffffeb4],CX
00831f00 : TEST BL,BL
00831f02 : JNZ 0x00831f3a
00831f04 : MOV EAX,dword ptr [EBP + 0xfffffee8]
00831f0a : INC EAX
00831f0b : CMP EAX,0xffff
00831f10 : MOV dword ptr [EBP + 0xfffffee8],EAX
00831f16 : JL 0x00831df7
00831f1c : XOR EAX,EAX
00831f1e : MOV ECX,dword ptr [EBP + -0xc]
00831f21 : MOV dword ptr FS:[0x0],ECX
00831f28 : POP ECX
00831f29 : POP EDI
00831f2a : POP ESI
00831f2b : POP EBX
00831f2c : MOV ECX,dword ptr [EBP + -0x10]
00831f2f : XOR ECX,EBP
00831f31 : CALL 0x00633e6b
00831f36 : MOV ESP,EBP
00831f38 : POP EBP
00831f39 : RET
00831f3a : MOV AX,word ptr [EDI + 0x6]
00831f3e : JMP 0x00831f1e
00831f40 : PUSH 0x600
00831f45 : CALL 0x00703c00
00831f4a : ADD ESP,0x4
00831f4d : TEST EAX,EAX
00831f4f : JZ 0x00831f1c
00831f51 : MOV AX,word ptr [EAX + 0x6]
00831f55 : JMP 0x00831f1e

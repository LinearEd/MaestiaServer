PROGRAM  : Maestia.exe
FUNCTION : FUN_00994880
ENTRY    : 00994880
BODY     : [[00994880, 00994ca4]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_00994880(int param_1,ushort param_2)

{
  short sVar1;
  int iVar2;
  uint3 uVar3;
  int iVar4;
  short *psVar5;
  int *in_ECX;
  char *pcStack_40c0;
  undefined4 local_40bc;
  undefined4 ****ppppuStack_40b8;
  undefined1 *puStack_40b4;
  short *local_40b0;
  int *local_40ac;
  undefined1 *local_40a8;
  uint uStack_40a4;
  int local_4094;
  int *local_4090;
  undefined1 *local_408c;
  int local_4088;
  undefined2 local_4080;
  undefined4 local_4070;
  uint local_406c;
  undefined1 local_4068 [4];
  undefined4 ****local_4064 [4];
  undefined4 local_4054;
  uint local_4050;
  undefined1 local_404c [4];
  undefined2 local_4048;
  undefined4 local_4038;
  uint local_4034;
  undefined1 local_4030 [4];
  undefined4 local_402c;
  int local_401c;
  uint local_4018;
  short local_4014;
  undefined1 local_4012 [16382];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  puStack_c = &LAB_00b5b435;
  local_10 = ExceptionList;
  uStack_40a4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_4088 = param_1;
  local_4050 = 7;
  local_4054 = 0;
  local_4064[0] = (undefined4 ****)((uint)local_4064[0] & 0xffff0000);
  local_8 = 0;
  local_40a8 = (undefined1 *)0x9948ef;
  local_4090 = in_ECX;
  local_14 = uStack_40a4;
  FUN_009941b0();
  local_408c = (undefined1 *)&pcStack_40c0;
  local_40a8 = (undefined1 *)0x7;
  local_40ac = (int *)0x0;
  local_40bc = (char *)((uint)local_40bc._2_2_ << 0x10);
  FUN_00405eb0(local_4068,0,0xffffffff);
  local_8 = local_8 & 0xffffff00;
  local_40b0 = (short *)FUN_008f75f0();
  local_8._0_1_ = 2;
  local_40a8 = (undefined1 *)0xffffffff;
  local_40ac = (int *)0x0;
  puStack_40b4 = (undefined1 *)0x994942;
  FUN_00405eb0();
  uVar3 = local_8._1_3_;
  local_8 = (uint)local_8._1_3_ << 8;
  if (7 < local_4034) {
                    /* WARNING: Subroutine does not return */
    local_40a8 = (undefined1 *)0x994959;
    FUN_006f04e0();
  }
  local_4034 = 7;
  local_4038 = 0;
  local_4048 = 0;
  local_4018 = 7;
  local_401c = 0;
  local_402c = (undefined4 *)((uint)local_402c._2_2_ << 0x10);
  local_8._0_1_ = 3;
  local_40a8 = local_4030;
  local_40ac = (int *)0x994997;
  local_8._1_3_ = uVar3;
  (**(code **)(*in_ECX + 0x78))();
  local_40ac = local_402c;
  if (local_4018 < 8) {
    local_40ac = &local_402c;
  }
  local_40b0 = (short *)0x9949b9;
  iVar4 = FUN_00405b70();
  iVar2 = DAT_00d7c54c;
  if (((iVar4 == 0) && (local_401c == 0)) || (3 < param_2)) {
    local_4094 = in_ECX[4];
    local_40ac = &local_4094;
    local_40b0 = (short *)0x994a07;
    FUN_004437f0();
    if ((local_408c != *(undefined1 **)(iVar2 + 0x44)) && (*(int *)(local_408c + 0x10) != 0)) {
      local_40ac = (int *)0x0;
      local_40b0 = (short *)DAT_0172491c;
      puStack_40b4 = (undefined1 *)0x994a38;
      FUN_00824a20();
      local_8._0_1_ = 4;
      if (param_2 == 4) {
        if (local_401c == 0) {
          local_40ac = (int *)0xffffffff;
          local_40b0 = (short *)0x0;
          ppppuStack_40b8 = (undefined4 ****)0x994a5b;
          puStack_40b4 = local_404c;
          FUN_00405eb0();
        }
        local_40b0 = &local_4014;
        local_40ac = (int *)0xc;
        puStack_40b4 = (undefined1 *)0x994a83;
        FUN_008f8070();
        psVar5 = &local_4014;
        do {
          sVar1 = *psVar5;
          psVar5 = psVar5 + 1;
        } while (sVar1 != 0);
        local_40ac = (int *)((int)psVar5 - (int)local_4012 >> 1);
        local_40b0 = &local_4014;
        puStack_40b4 = (undefined1 *)0x994ab5;
        FUN_00406360();
      }
      else if (param_2 == 5) {
        if (local_401c == 0) {
          local_40ac = (int *)0xffffffff;
          local_40b0 = (short *)0x0;
          puStack_40b4 = local_404c;
          ppppuStack_40b8 = (undefined4 ****)0x994ada;
          FUN_00405eb0();
        }
        local_40b0 = &local_4014;
        local_40ac = (int *)0xc;
        puStack_40b4 = (undefined1 *)0x994b02;
        FUN_008f8070();
        local_40ac = (int *)(local_4088 + 0x7c);
        local_40b0 = (short *)0x994b1a;
        FUN_00405c00();
      }
      local_40ac = (int *)0xffffffff;
      local_40b0 = (short *)0x0;
      puStack_40b4 = local_404c;
      ppppuStack_40b8 = (undefined4 ****)0x994b2f;
      FUN_00405eb0();
      local_8._0_1_ = 3;
      if (7 < local_4034) {
                    /* WARNING: Subroutine does not return */
        local_40ac = (int *)0x994b47;
        FUN_006f04e0();
      }
      local_4034 = 7;
      local_4038 = 0;
      local_4048 = 0;
    }
  }
  local_40b0 = &local_4014;
  local_40ac = (int *)0xc;
  puStack_40b4 = (undefined1 *)0x994b88;
  FUN_008f8070();
  ppppuStack_40b8 = local_4064[0];
  if (local_4050 < 8) {
    ppppuStack_40b8 = local_4064;
  }
  local_40ac = (int *)&local_4014;
  local_40b0 = (short *)0x0;
  local_40bc = "%ls,%d,%d,%ls";
  pcStack_40c0 = "GambleBoxInsertItem";
  puStack_40b4 = (undefined1 *)(uint)param_2;
  (**(code **)(**(int **)(*DAT_00da9894 + 0x114) + 4))(*(int **)(*DAT_00da9894 + 0x114));
  *(int *)(local_4088 + 0x3c + (uint)param_2 * 4) = local_4090[3];
  local_40ac = (int *)local_4090[3];
  local_40b0 = (short *)&DAT_00c86024;
  puStack_40b4 = (undefined1 *)0x994bf8;
  FUN_00404750();
  if (7 < local_406c) {
                    /* WARNING: Subroutine does not return */
    local_40ac = (int *)0x994c13;
    FUN_006f04e0();
  }
  local_406c = 7;
  local_4070 = 0;
  local_4080 = 0;
  local_8 = (uint)local_8._1_3_ << 8;
  if (7 < local_4018) {
                    /* WARNING: Subroutine does not return */
    local_40ac = (int *)0x994c43;
    FUN_006f04e0();
  }
  local_4018 = 7;
  local_401c = 0;
  local_402c = (undefined4 *)((uint)local_402c & 0xffff0000);
  local_8 = 0xffffffff;
  if (7 < local_4050) {
                    /* WARNING: Subroutine does not return */
    local_40ac = (int *)0x994c72;
    FUN_006f04e0();
  }
  local_4050 = 7;
  local_4054 = 0;
  local_4064[0] = (undefined4 ****)((uint)local_4064[0] & 0xffff0000);
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00994880 : PUSH EBP
00994881 : MOV EBP,ESP
00994883 : PUSH -0x1
00994885 : PUSH 0xb5b435
0099488a : MOV EAX,FS:[0x0]
00994890 : PUSH EAX
00994891 : MOV EAX,0x4084
00994896 : CALL 0x0063b780
0099489b : MOV EAX,[0x00d66fa0]
009948a0 : XOR EAX,EBP
009948a2 : MOV dword ptr [EBP + -0x10],EAX
009948a5 : PUSH EBX
009948a6 : PUSH ESI
009948a7 : PUSH EDI
009948a8 : PUSH EAX
009948a9 : LEA EAX,[EBP + -0xc]
009948ac : MOV FS:[0x0],EAX
009948b2 : MOV EAX,dword ptr [EBP + 0x8]
009948b5 : MOV ESI,ECX
009948b7 : MOV ECX,dword ptr [ESI + 0x10]
009948ba : XOR EBX,EBX
009948bc : XOR EDX,EDX
009948be : MOV dword ptr [EBP + 0xffffbf7c],EAX
009948c4 : MOV dword ptr [EBP + 0xffffbf74],ESI
009948ca : MOV dword ptr [EBP + 0xffffbfb4],0x7
009948d4 : MOV dword ptr [EBP + 0xffffbfb0],EBX
009948da : MOV word ptr [EBP + 0xffffbfa0],DX
009948e1 : MOV dword ptr [EBP + -0x4],EBX
009948e4 : LEA EDI,[EBP + 0xffffbf9c]
009948ea : CALL 0x009941b0
009948ef : SUB ESP,0x1c
009948f2 : MOV ECX,ESP
009948f4 : MOV dword ptr [EBP + 0xffffbf78],ESP
009948fa : PUSH -0x1
009948fc : PUSH EBX
009948fd : LEA EDX,[EBP + 0xffffbf9c]
00994903 : MOV EDI,0x7
00994908 : XOR EAX,EAX
0099490a : MOV dword ptr [ECX + 0x18],EDI
0099490d : MOV dword ptr [ECX + 0x14],EBX
00994910 : PUSH EDX
00994911 : MOV word ptr [ECX + 0x4],AX
00994915 : CALL 0x00405eb0
0099491a : MOV byte ptr [EBP + -0x4],0x1
0099491e : MOV byte ptr [EBP + -0x4],BL
00994921 : LEA ECX,[EBP + 0xffffbfb8]
00994927 : CALL 0x008f75f0
0099492c : ADD ESP,0x1c
0099492f : MOV byte ptr [EBP + -0x4],0x2
00994933 : PUSH -0x1
00994935 : PUSH EBX
00994936 : PUSH EAX
00994937 : LEA ECX,[EBP + 0xffffbf9c]
0099493d : CALL 0x00405eb0
00994942 : MOV byte ptr [EBP + -0x4],BL
00994945 : CMP dword ptr [EBP + 0xffffbfd0],0x8
0099494c : JC 0x00994959
0099494e : MOV ECX,dword ptr [EBP + 0xffffbfbc]
00994954 : CALL 0x006f04e0
00994959 : XOR EAX,EAX
0099495b : XOR ECX,ECX
0099495d : MOV dword ptr [EBP + 0xffffbfd0],EDI
00994963 : MOV dword ptr [EBP + 0xffffbfcc],EBX
00994969 : MOV word ptr [EBP + 0xffffbfbc],AX
00994970 : MOV dword ptr [EBP + 0xffffbfec],EDI
00994976 : MOV dword ptr [EBP + 0xffffbfe8],EBX
0099497c : MOV word ptr [EBP + 0xffffbfd8],CX
00994983 : MOV byte ptr [EBP + -0x4],0x3
00994987 : MOV EDX,dword ptr [ESI]
00994989 : MOV EDX,dword ptr [EDX + 0x78]
0099498c : LEA EAX,[EBP + 0xffffbfd4]
00994992 : PUSH EAX
00994993 : MOV ECX,ESI
00994995 : CALL EDX
00994997 : CMP dword ptr [EBP + 0xffffbfec],0x8
0099499e : MOV EAX,dword ptr [EBP + 0xffffbfd8]
009949a4 : JNC 0x009949ac
009949a6 : LEA EAX,[EBP + 0xffffbfd8]
009949ac : PUSH EAX
009949ad : XOR EDX,EDX
009949af : MOV ECX,0xc85ffc
009949b4 : CALL 0x00405b70
009949b9 : ADD ESP,0x4
009949bc : CMP EAX,EBX
009949be : JNZ 0x009949cf
009949c0 : XOR EAX,EAX
009949c2 : CMP dword ptr [EBP + 0xffffbfe8],EBX
009949c8 : SETNZ AL
009949cb : CMP EAX,EBX
009949cd : JZ 0x009949df
009949cf : MOV DI,word ptr [EBP + 0xc]
009949d3 : CMP DI,0x3
009949d7 : JBE 0x00994b60
009949dd : JMP 0x009949e3
009949df : MOV DI,word ptr [EBP + 0xc]
009949e3 : MOV EAX,dword ptr [ESI + 0x10]
009949e6 : MOV ESI,dword ptr [0x00d7c54c]
009949ec : LEA ECX,[EBP + 0xffffbf70]
009949f2 : MOV dword ptr [EBP + 0xffffbf70],EAX
009949f8 : PUSH ECX
009949f9 : LEA ECX,[ESI + 0x40]
009949fc : LEA EAX,[EBP + 0xffffbf78]
00994a02 : CALL 0x004437f0
00994a07 : MOV ESI,dword ptr [ESI + 0x44]
00994a0a : MOV EAX,dword ptr [EBP + 0xffffbf78]
00994a10 : CMP EAX,ESI
00994a12 : JZ 0x00994b60
00994a18 : MOV EAX,dword ptr [EAX + 0x10]
00994a1b : CMP EAX,EBX
00994a1d : JZ 0x00994b60
00994a23 : LEA EDX,[EAX + 0x18]
00994a26 : MOV EAX,[0x0172491c]
00994a2b : PUSH EBX
00994a2c : PUSH EAX
00994a2d : LEA ESI,[EBP + 0xffffbfb8]
00994a33 : CALL 0x00824a20
00994a38 : MOV byte ptr [EBP + -0x4],0x4
00994a3c : CMP DI,0x4
00994a40 : JNZ 0x00994ab7
00994a42 : CMP dword ptr [EBP + 0xffffbfe8],EBX
00994a48 : JNZ 0x00994a5b
00994a4a : PUSH -0x1
00994a4c : PUSH EBX
00994a4d : MOV ECX,ESI
00994a4f : PUSH ECX
00994a50 : LEA ECX,[EBP + 0xffffbfd4]
00994a56 : CALL 0x00405eb0
00994a5b : CMP dword ptr [EBP + 0xffffbfec],0x8
00994a62 : MOV ESI,dword ptr [EBP + 0xffffbfd8]
00994a68 : JNC 0x00994a70
00994a6a : LEA ESI,[EBP + 0xffffbfd8]
00994a70 : LEA EDX,[EBP + 0xffffbff0]
00994a76 : PUSH 0xc
00994a78 : PUSH EDX
00994a79 : MOV EDI,0xffffff
00994a7e : CALL 0x008f8070
00994a83 : LEA EAX,[EBP + 0xffffbff0]
00994a89 : ADD ESP,0x8
00994a8c : LEA EDX,[EAX + 0x2]
00994a8f : NOP
00994a90 : MOV CX,word ptr [EAX]
00994a93 : ADD EAX,0x2
00994a96 : CMP CX,BX
00994a99 : JNZ 0x00994a90
00994a9b : MOV ECX,dword ptr [EBP + 0xffffbf7c]
00994aa1 : SUB EAX,EDX
00994aa3 : SAR EAX,0x1
00994aa5 : PUSH EAX
00994aa6 : LEA EAX,[EBP + 0xffffbff0]
00994aac : PUSH EAX
00994aad : ADD ECX,0x60
00994ab0 : CALL 0x00406360
00994ab5 : JMP 0x00994b1a
00994ab7 : CMP DI,0x5
00994abb : JNZ 0x00994b1a
00994abd : CMP dword ptr [EBP + 0xffffbfe8],EBX
00994ac3 : JNZ 0x00994ada
00994ac5 : PUSH -0x1
00994ac7 : PUSH EBX
00994ac8 : LEA ECX,[EBP + 0xffffbfb8]
00994ace : PUSH ECX
00994acf : LEA ECX,[EBP + 0xffffbfd4]
00994ad5 : CALL 0x00405eb0
00994ada : CMP dword ptr [EBP + 0xffffbfec],0x8
00994ae1 : MOV ESI,dword ptr [EBP + 0xffffbfd8]
00994ae7 : JNC 0x00994aef
00994ae9 : LEA ESI,[EBP + 0xffffbfd8]
00994aef : LEA EDX,[EBP + 0xffffbff0]
00994af5 : PUSH 0xc
00994af7 : PUSH EDX
00994af8 : MOV EDI,0xffffff
00994afd : CALL 0x008f8070
00994b02 : MOV EAX,dword ptr [EBP + 0xffffbf7c]
00994b08 : ADD ESP,0x8
00994b0b : ADD EAX,0x7c
00994b0e : PUSH EAX
00994b0f : LEA EDX,[EBP + 0xffffbff0]
00994b15 : CALL 0x00405c00
00994b1a : PUSH -0x1
00994b1c : PUSH EBX
00994b1d : LEA ECX,[EBP + 0xffffbfb8]
00994b23 : PUSH ECX
00994b24 : LEA ECX,[EBP + 0xffffbfd4]
00994b2a : CALL 0x00405eb0
00994b2f : MOV byte ptr [EBP + -0x4],0x3
00994b33 : CMP dword ptr [EBP + 0xffffbfd0],0x8
00994b3a : JC 0x00994b47
00994b3c : MOV ECX,dword ptr [EBP + 0xffffbfbc]
00994b42 : CALL 0x006f04e0
00994b47 : XOR EDX,EDX
00994b49 : MOV dword ptr [EBP + 0xffffbfd0],0x7
00994b53 : MOV dword ptr [EBP + 0xffffbfcc],EBX
00994b59 : MOV word ptr [EBP + 0xffffbfbc],DX
00994b60 : CMP dword ptr [EBP + 0xffffbfec],0x8
00994b67 : MOV ESI,dword ptr [EBP + 0xffffbfd8]
00994b6d : JNC 0x00994b75
00994b6f : LEA ESI,[EBP + 0xffffbfd8]
00994b75 : LEA EAX,[EBP + 0xffffbff0]
00994b7b : PUSH 0xc
00994b7d : PUSH EAX
00994b7e : MOV EDI,0xffffff
00994b83 : CALL 0x008f8070
00994b88 : MOV ECX,dword ptr [0x00da9894]
00994b8e : MOV EAX,dword ptr [ECX]
00994b90 : MOV EAX,dword ptr [EAX + 0x114]
00994b96 : MOV ECX,dword ptr [EBP + 0xffffbfa0]
00994b9c : ADD ESP,0x8
00994b9f : CMP dword ptr [EBP + 0xffffbfb4],0x8
00994ba6 : JNC 0x00994bae
00994ba8 : LEA ECX,[EBP + 0xffffbfa0]
00994bae : MOVZX ESI,word ptr [EBP + 0xc]
00994bb2 : MOV EDX,dword ptr [EAX]
00994bb4 : LEA EDI,[EBP + 0xffffbff0]
00994bba : PUSH EDI
00994bbb : PUSH EBX
00994bbc : PUSH ESI
00994bbd : PUSH ECX
00994bbe : PUSH 0xc86000
00994bc3 : PUSH 0xc86010
00994bc8 : PUSH EAX
00994bc9 : MOV EAX,dword ptr [EDX + 0x4]
00994bcc : CALL EAX
00994bce : MOV ECX,dword ptr [EBP + 0xffffbf74]
00994bd4 : MOV EAX,dword ptr [ECX + 0xc]
00994bd7 : MOV EDX,dword ptr [EBP + 0xffffbf7c]
00994bdd : MOV dword ptr [EDX + ESI*0x4 + 0x3c],EAX
00994be1 : MOV EAX,dword ptr [ECX + 0xc]
00994be4 : ADD ESP,0x1c
00994be7 : PUSH EAX
00994be8 : PUSH 0xc86024
00994bed : LEA ESI,[EBP + 0xffffbf80]
00994bf3 : CALL 0x00404750
00994bf8 : MOV ESI,0x8
00994bfd : ADD ESP,0x8
00994c00 : CMP dword ptr [EBP + 0xffffbf98],ESI
00994c06 : JC 0x00994c13
00994c08 : MOV ECX,dword ptr [EBP + 0xffffbf84]
00994c0e : CALL 0x006f04e0
00994c13 : MOV EDI,0x7
00994c18 : XOR EAX,EAX
00994c1a : MOV dword ptr [EBP + 0xffffbf98],EDI
00994c20 : MOV dword ptr [EBP + 0xffffbf94],EBX
00994c26 : MOV word ptr [EBP + 0xffffbf84],AX
00994c2d : MOV byte ptr [EBP + -0x4],BL
00994c30 : CMP dword ptr [EBP + 0xffffbfec],ESI
00994c36 : JC 0x00994c43
00994c38 : MOV ECX,dword ptr [EBP + 0xffffbfd8]
00994c3e : CALL 0x006f04e0
00994c43 : XOR ECX,ECX
00994c45 : MOV dword ptr [EBP + 0xffffbfec],EDI
00994c4b : MOV dword ptr [EBP + 0xffffbfe8],EBX
00994c51 : MOV word ptr [EBP + 0xffffbfd8],CX
00994c58 : MOV dword ptr [EBP + -0x4],0xffffffff
00994c5f : CMP dword ptr [EBP + 0xffffbfb4],ESI
00994c65 : JC 0x00994c72
00994c67 : MOV ECX,dword ptr [EBP + 0xffffbfa0]
00994c6d : CALL 0x006f04e0
00994c72 : XOR EDX,EDX
00994c74 : MOV dword ptr [EBP + 0xffffbfb4],EDI
00994c7a : MOV dword ptr [EBP + 0xffffbfb0],EBX
00994c80 : MOV word ptr [EBP + 0xffffbfa0],DX
00994c87 : MOV ECX,dword ptr [EBP + -0xc]
00994c8a : MOV dword ptr FS:[0x0],ECX
00994c91 : POP ECX
00994c92 : POP EDI
00994c93 : POP ESI
00994c94 : POP EBX
00994c95 : MOV ECX,dword ptr [EBP + -0x10]
00994c98 : XOR ECX,EBP
00994c9a : CALL 0x00633e6b
00994c9f : MOV ESP,EBP
00994ca1 : POP EBP
00994ca2 : RET 0x8

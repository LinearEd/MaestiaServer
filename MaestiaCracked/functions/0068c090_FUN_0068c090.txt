PROGRAM  : Maestia.exe
FUNCTION : FUN_0068c090
ENTRY    : 0068c090
BODY     : [[0068c090, 0068c0fc] [0068c100, 0068c2a8]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0068c090(byte *param_1,int param_2)

{
  byte bVar1;
  bool bVar2;
  byte *pbVar3;
  int iVar4;
  int *in_ECX;
  byte *in_EDX;
  int iVar5;
  byte *pbVar6;
  byte *pbVar7;
  int local_30;
  int local_2c;
  byte *local_28;
  byte local_24 [32];
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)&local_30;
  local_30 = 0;
  in_ECX[2] = 0;
  if ((param_2 == 0) || (*param_1 == 0)) {
    __security_check_cookie(local_4 ^ (uint)&local_30);
    return;
  }
  if ((in_EDX == (byte *)0x0) || (*in_EDX == 0)) {
    __security_check_cookie(local_4 ^ (uint)&local_30);
    return;
  }
  local_24[0] = 0;
  local_24[1] = 0;
  local_24[2] = 0;
  local_24[3] = 0;
  local_24[4] = 0;
  local_24[5] = 0;
  local_24[6] = 0;
  local_24[7] = 0;
  local_24[8] = 0;
  local_24[9] = 0;
  local_24[10] = 0;
  local_24[0xb] = 0;
  local_24[0xc] = 0;
  local_24[0xd] = 0;
  local_24[0xe] = 0;
  local_24[0xf] = 0;
  local_24[0x10] = 0;
  local_24[0x11] = 0;
  local_24[0x12] = 0;
  local_24[0x13] = 0;
  local_24[0x14] = 0;
  local_24[0x15] = 0;
  local_24[0x16] = 0;
  local_24[0x17] = 0;
  local_24[0x18] = 0;
  local_24[0x19] = 0;
  local_24[0x1a] = 0;
  local_24[0x1b] = 0;
  local_24[0x1c] = 0;
  local_24[0x1d] = 0;
  local_24[0x1e] = 0;
  local_24[0x1f] = 0;
  local_2c = 0;
  do {
    bVar1 = *in_EDX;
    if (bVar1 == 0) break;
    if ((bVar1 == 0x2b) && (in_EDX[1] == 0)) {
      local_2c = 1;
    }
    else {
      local_24[bVar1 >> 3] = local_24[bVar1 >> 3] | '\x01' << (bVar1 & 7);
    }
    in_EDX = in_EDX + 1;
  } while (in_EDX != (byte *)0x0);
  pbVar3 = param_1 + param_2;
  iVar5 = 0;
  local_28 = pbVar3;
  if (param_1 < pbVar3) {
    do {
      if (*param_1 == 0) break;
      bVar1 = *param_1;
      pbVar6 = param_1;
      while ((bVar1 != 0 && (((int)(char)local_24[*pbVar6 >> 3] & 1 << (*pbVar6 & 7)) == 0))) {
        pbVar6 = pbVar6 + 1;
        bVar1 = *pbVar6;
      }
      if ((in_ECX[2] == in_ECX[1]) &&
         (local_30 = FUN_0068bf70(in_ECX[2] + 1), pbVar3 = local_28, local_30 != 0))
      goto LAB_0068c237;
      if (pbVar6 <= param_1) {
        param_1 = &DAT_00bd900c;
      }
      *(byte **)(*in_ECX + in_ECX[2] * 4) = param_1;
      in_ECX[2] = in_ECX[2] + 1;
      if (local_2c == 0) {
        if (*pbVar6 != 0) {
          *pbVar6 = 0;
          pbVar7 = pbVar6 + 1;
          goto LAB_0068c202;
        }
LAB_0068c212:
        iVar5 = 0;
      }
      else {
        pbVar7 = pbVar6;
        if (*pbVar6 == 0) goto LAB_0068c212;
        do {
          if (((int)(char)local_24[*pbVar7 >> 3] & 1 << (*pbVar7 & 7)) == 0) break;
          *pbVar7 = 0;
          pbVar7 = pbVar7 + 1;
        } while (*pbVar7 != 0);
LAB_0068c202:
        bVar2 = pbVar7 <= pbVar6;
        pbVar6 = pbVar7;
        if ((bVar2) || (*pbVar7 != 0)) goto LAB_0068c212;
        iVar5 = 1;
      }
      param_1 = pbVar6;
    } while (pbVar6 < pbVar3);
  }
  if (((uint)(in_ECX[2] + iVar5) < (uint)in_ECX[1]) ||
     (iVar4 = FUN_0068bf70(in_ECX[2] + iVar5 + 1), iVar4 == 0)) {
    if (iVar5 != 0) {
      *(undefined **)(*in_ECX + in_ECX[2] * 4) = &DAT_00bd900c;
      in_ECX[2] = in_ECX[2] + 1;
    }
    *(undefined4 *)(*in_ECX + in_ECX[2] * 4) = 0;
    __security_check_cookie(local_4 ^ (uint)&local_30);
    return;
  }
LAB_0068c237:
  __security_check_cookie(local_4 ^ (uint)&local_30);
  return;
}



============================================================
DISASSEMBLY
============================================================
0068c090 : SUB ESP,0x30
0068c093 : MOV EAX,[0x00d66fa0]
0068c098 : XOR EAX,ESP
0068c09a : MOV dword ptr [ESP + 0x2c],EAX
0068c09e : MOV EAX,dword ptr [ESP + 0x38]
0068c0a2 : PUSH ESI
0068c0a3 : MOV ESI,ECX
0068c0a5 : XOR ECX,ECX
0068c0a7 : PUSH EDI
0068c0a8 : MOV EDI,dword ptr [ESP + 0x3c]
0068c0ac : MOV dword ptr [ESP + 0x8],ECX
0068c0b0 : MOV dword ptr [ESI + 0x8],ECX
0068c0b3 : CMP EAX,ECX
0068c0b5 : JZ 0x0068c296
0068c0bb : CMP byte ptr [EDI],CL
0068c0bd : JZ 0x0068c296
0068c0c3 : CMP EDX,ECX
0068c0c5 : JZ 0x0068c280
0068c0cb : CMP byte ptr [EDX],CL
0068c0cd : JZ 0x0068c280
0068c0d3 : PUSH EBP
0068c0d4 : MOV dword ptr [ESP + 0x18],ECX
0068c0d8 : MOV dword ptr [ESP + 0x1c],ECX
0068c0dc : MOV dword ptr [ESP + 0x20],ECX
0068c0e0 : MOV dword ptr [ESP + 0x24],ECX
0068c0e4 : MOV dword ptr [ESP + 0x28],ECX
0068c0e8 : MOV dword ptr [ESP + 0x2c],ECX
0068c0ec : MOV dword ptr [ESP + 0x30],ECX
0068c0f0 : MOV dword ptr [ESP + 0x34],ECX
0068c0f4 : MOV dword ptr [ESP + 0x10],ECX
0068c0f8 : MOV EBP,EDX
0068c0fa : PUSH EBX
0068c0fb : JMP 0x0068c100
0068c100 : MOV CL,byte ptr [EBP]
0068c103 : TEST CL,CL
0068c105 : JZ 0x0068c137
0068c107 : CMP CL,0x2b
0068c10a : JNZ 0x0068c11c
0068c10c : CMP byte ptr [EBP + 0x1],0x0
0068c110 : JNZ 0x0068c11c
0068c112 : MOV dword ptr [ESP + 0x14],0x1
0068c11a : JMP 0x0068c132
0068c11c : MOVZX EDX,CL
0068c11f : MOVSX ECX,CL
0068c122 : AND ECX,0x7
0068c125 : MOV BL,0x1
0068c127 : SHR EDX,0x3
0068c12a : SHL BL,CL
0068c12c : LEA EDX,[ESP + EDX*0x1 + 0x1c]
0068c130 : OR byte ptr [EDX],BL
0068c132 : ADD EBP,0x1
0068c135 : JNZ 0x0068c100
0068c137 : ADD EAX,EDI
0068c139 : XOR EBP,EBP
0068c13b : MOV EBX,EDI
0068c13d : MOV dword ptr [ESP + 0x18],EAX
0068c141 : CMP EDI,EAX
0068c143 : JNC 0x0068c21e
0068c149 : LEA ESP,[ESP]
0068c150 : CMP byte ptr [EBX],0x0
0068c153 : JZ 0x0068c21e
0068c159 : CMP byte ptr [EDI],0x0
0068c15c : JZ 0x0068c184
0068c15e : MOV EDI,EDI
0068c160 : MOV DL,byte ptr [EDI]
0068c162 : MOVSX ECX,DL
0068c165 : AND ECX,0x7
0068c168 : MOV EBP,0x1
0068c16d : SHL EBP,CL
0068c16f : MOVZX ECX,DL
0068c172 : SHR ECX,0x3
0068c175 : MOVSX EDX,byte ptr [ESP + ECX*0x1 + 0x1c]
0068c17a : TEST EDX,EBP
0068c17c : JNZ 0x0068c184
0068c17e : INC EDI
0068c17f : CMP byte ptr [EDI],0x0
0068c182 : JNZ 0x0068c160
0068c184 : MOV ECX,dword ptr [ESI + 0x8]
0068c187 : CMP ECX,dword ptr [ESI + 0x4]
0068c18a : JNZ 0x0068c1a6
0068c18c : INC ECX
0068c18d : PUSH ECX
0068c18e : CALL 0x0068bf70
0068c193 : ADD ESP,0x4
0068c196 : MOV dword ptr [ESP + 0x10],EAX
0068c19a : TEST EAX,EAX
0068c19c : JNZ 0x0068c237
0068c1a2 : MOV EAX,dword ptr [ESP + 0x18]
0068c1a6 : MOV ECX,EBX
0068c1a8 : CMP EDI,EBX
0068c1aa : JA 0x0068c1b1
0068c1ac : MOV ECX,0xbd900c
0068c1b1 : MOV EDX,dword ptr [ESI + 0x8]
0068c1b4 : MOV EBX,dword ptr [ESI]
0068c1b6 : MOV dword ptr [EBX + EDX*0x4],ECX
0068c1b9 : INC dword ptr [ESI + 0x8]
0068c1bc : CMP dword ptr [ESP + 0x14],0x0
0068c1c1 : MOV EBX,EDI
0068c1c3 : JZ 0x0068c1f9
0068c1c5 : CMP byte ptr [EDI],0x0
0068c1c8 : JZ 0x0068c212
0068c1ca : LEA EBX,[EBX]
0068c1d0 : MOV DL,byte ptr [EDI]
0068c1d2 : MOVSX ECX,DL
0068c1d5 : AND ECX,0x7
0068c1d8 : MOV EBP,0x1
0068c1dd : SHL EBP,CL
0068c1df : MOVZX ECX,DL
0068c1e2 : SHR ECX,0x3
0068c1e5 : MOVSX EDX,byte ptr [ESP + ECX*0x1 + 0x1c]
0068c1ea : TEST EDX,EBP
0068c1ec : JZ 0x0068c202
0068c1ee : MOV byte ptr [EDI],0x0
0068c1f1 : INC EDI
0068c1f2 : CMP byte ptr [EDI],0x0
0068c1f5 : JNZ 0x0068c1d0
0068c1f7 : JMP 0x0068c202
0068c1f9 : CMP byte ptr [EDI],0x0
0068c1fc : JZ 0x0068c212
0068c1fe : MOV byte ptr [EDI],0x0
0068c201 : INC EDI
0068c202 : CMP EDI,EBX
0068c204 : JBE 0x0068c212
0068c206 : CMP byte ptr [EDI],0x0
0068c209 : JNZ 0x0068c212
0068c20b : MOV EBP,0x1
0068c210 : JMP 0x0068c214
0068c212 : XOR EBP,EBP
0068c214 : MOV EBX,EDI
0068c216 : CMP EDI,EAX
0068c218 : JC 0x0068c150
0068c21e : MOV EAX,dword ptr [ESI + 0x8]
0068c221 : LEA ECX,[EAX + EBP*0x1]
0068c224 : CMP ECX,dword ptr [ESI + 0x4]
0068c227 : JC 0x0068c24a
0068c229 : INC ECX
0068c22a : PUSH ECX
0068c22b : CALL 0x0068bf70
0068c230 : ADD ESP,0x4
0068c233 : TEST EAX,EAX
0068c235 : JZ 0x0068c24e
0068c237 : POP EBX
0068c238 : POP EBP
0068c239 : POP EDI
0068c23a : POP ESI
0068c23b : MOV ECX,dword ptr [ESP + 0x2c]
0068c23f : XOR ECX,ESP
0068c241 : CALL 0x00633e6b
0068c246 : ADD ESP,0x30
0068c249 : RET
0068c24a : MOV EAX,dword ptr [ESP + 0x10]
0068c24e : TEST EBP,EBP
0068c250 : JZ 0x0068c261
0068c252 : MOV ECX,dword ptr [ESI + 0x8]
0068c255 : MOV EDX,dword ptr [ESI]
0068c257 : MOV dword ptr [EDX + ECX*0x4],0xbd900c
0068c25e : INC dword ptr [ESI + 0x8]
0068c261 : MOV ECX,dword ptr [ESI + 0x8]
0068c264 : MOV EDX,dword ptr [ESI]
0068c266 : POP EBX
0068c267 : POP EBP
0068c268 : POP EDI
0068c269 : MOV dword ptr [EDX + ECX*0x4],0x0
0068c270 : POP ESI
0068c271 : MOV ECX,dword ptr [ESP + 0x2c]
0068c275 : XOR ECX,ESP
0068c277 : CALL 0x00633e6b
0068c27c : ADD ESP,0x30
0068c27f : RET
0068c280 : POP EDI
0068c281 : MOV EAX,0x6
0068c286 : POP ESI
0068c287 : MOV ECX,dword ptr [ESP + 0x2c]
0068c28b : XOR ECX,ESP
0068c28d : CALL 0x00633e6b
0068c292 : ADD ESP,0x30
0068c295 : RET
0068c296 : MOV EAX,ECX
0068c298 : MOV ECX,dword ptr [ESP + 0x34]
0068c29c : POP EDI
0068c29d : POP ESI
0068c29e : XOR ECX,ESP
0068c2a0 : CALL 0x00633e6b
0068c2a5 : ADD ESP,0x30
0068c2a8 : RET

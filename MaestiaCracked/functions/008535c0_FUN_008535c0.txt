PROGRAM  : Maestia.exe
FUNCTION : FUN_008535c0
ENTRY    : 008535c0
BODY     : [[008535c0, 00853839]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008535c0(void)

{
  char cVar1;
  int *piVar2;
  int iVar3;
  int in_ECX;
  undefined1 auStack_3c [4];
  undefined1 local_38;
  undefined1 local_37;
  undefined4 local_34;
  undefined4 local_30;
  undefined2 local_2c;
  undefined1 local_2a;
  undefined4 local_28;
  undefined1 local_24;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_00b62c47;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_3c;
  ExceptionList = &local_14;
  FUN_00856e00(DAT_00d66fa0 ^ (uint)&stack0xffffffb8);
  if (*(char *)(in_ECX + 0x65d) == '\0') {
    local_34 = 0;
    local_30 = 0;
    local_2c = 0;
    local_24 = 0;
    local_38 = 0;
    local_2a = 1;
    local_28 = 1;
    local_37 = 0x28;
    FUN_0041dea0(&local_38);
  }
  else if (*(char *)(*(int *)(in_ECX + 0x18a8) + 0x20) != '\0') {
    (**(code **)(*(int *)(*(int *)(*(int *)(in_ECX + 0x138) + 4) + 0x138 + in_ECX) + 0x10))
              (in_ECX + 0x1d38,1,1,1);
    piVar2 = (int *)FUN_004049b0(*(undefined4 *)(*(int *)(in_ECX + 0x18a8) + 0x28));
    if (piVar2 != (int *)0x0) {
      iVar3 = (**(code **)(*piVar2 + 0x38))();
      if (iVar3 != 0) {
        FUN_00404350(piVar2 + 0x31);
        local_1c = 0;
        cVar1 = FUN_004049e0();
        if (cVar1 != '\0') {
          FUN_008980b0(&stack0xffffffb8,1);
        }
        FUN_0088e570(0x12);
        local_1c = 0xffffffff;
        FUN_00406560();
      }
    }
    FUN_0085bfe0(in_ECX,1);
    FUN_0085c1c0();
    FUN_0083bb00(0);
    FUN_0083ba10();
    (**(code **)(*(int *)(*(int *)(*(int *)(in_ECX + 0x138) + 4) + 0x138 + in_ECX) + 0x10))
              (in_ECX + 0x6d8,1,0,1);
    *(undefined4 *)(in_ECX + 0x19ec) = 0;
    *(undefined4 *)(in_ECX + 0x1a68) = 0;
    FUN_00856310(&DAT_00d720f0);
    if (*(char *)(in_ECX + 0x4d4) != '\0') {
      FUN_0084c320(1);
      iVar3 = *(int *)(in_ECX + 0x17f0);
      *(undefined1 *)(iVar3 + 0x1a8) = 0;
      if (*(int **)(iVar3 + 0x168) != (int *)0x0) {
        (**(code **)(**(int **)(iVar3 + 0x168) + 0x10))(0);
      }
      if (*(int **)(iVar3 + 0x16c) != (int *)0x0) {
        (**(code **)(**(int **)(iVar3 + 0x16c) + 0x10))(0);
      }
      FUN_0084c320(1);
      iVar3 = *(int *)(in_ECX + 0x1870);
      *(undefined1 *)(iVar3 + 0x1a8) = 0;
      if (*(int **)(iVar3 + 0x168) != (int *)0x0) {
        (**(code **)(**(int **)(iVar3 + 0x168) + 0x10))(0);
      }
      if (*(int **)(iVar3 + 0x16c) != (int *)0x0) {
        (**(code **)(**(int **)(iVar3 + 0x16c) + 0x10))(0);
      }
      FUN_0084c320(1);
      *(undefined1 *)(in_ECX + 0x198c) = 1;
      *(undefined1 *)(in_ECX + 0x4d4) = 0;
    }
  }
  FUN_00887160();
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_3c);
  return;
}



============================================================
DISASSEMBLY
============================================================
008535c0 : PUSH EBP
008535c1 : MOV EBP,ESP
008535c3 : AND ESP,0xfffffff8
008535c6 : PUSH -0x1
008535c8 : PUSH 0xb62c47
008535cd : MOV EAX,FS:[0x0]
008535d3 : PUSH EAX
008535d4 : SUB ESP,0x28
008535d7 : MOV EAX,[0x00d66fa0]
008535dc : XOR EAX,ESP
008535de : MOV dword ptr [ESP + 0x20],EAX
008535e2 : PUSH EBX
008535e3 : PUSH ESI
008535e4 : PUSH EDI
008535e5 : MOV EAX,[0x00d66fa0]
008535ea : XOR EAX,ESP
008535ec : PUSH EAX
008535ed : LEA EAX,[ESP + 0x38]
008535f1 : MOV FS:[0x0],EAX
008535f7 : MOV EBX,ECX
008535f9 : MOV EAX,dword ptr [EBX + 0x19e4]
008535ff : MOV ESI,EBX
00853601 : CALL 0x00856e00
00853606 : CMP byte ptr [EBX + 0x65d],0x0
0085360d : JNZ 0x0085364d
0085360f : XOR EAX,EAX
00853611 : LEA ECX,[ESP + 0x14]
00853615 : MOV dword ptr [ESP + 0x18],EAX
00853619 : MOV dword ptr [ESP + 0x1c],EAX
0085361d : MOV word ptr [ESP + 0x20],AX
00853622 : MOV byte ptr [ESP + 0x28],AL
00853626 : MOV byte ptr [ESP + 0x14],AL
0085362a : PUSH ECX
0085362b : LEA EAX,[EBX + 0x19a4]
00853631 : MOV byte ptr [ESP + 0x26],0x1
00853636 : MOV dword ptr [ESP + 0x28],0x1
0085363e : MOV byte ptr [ESP + 0x19],0x28
00853643 : CALL 0x0041dea0
00853648 : JMP 0x00853815
0085364d : MOV EDX,dword ptr [EBX + 0x18a8]
00853653 : CMP byte ptr [EDX + 0x20],0x0
00853657 : JZ 0x00853815
0085365d : MOV EAX,dword ptr [EBX + 0x138]
00853663 : MOV ECX,dword ptr [EAX + 0x4]
00853666 : MOV EDX,dword ptr [ECX + EBX*0x1 + 0x138]
0085366d : MOV EDX,dword ptr [EDX + 0x10]
00853670 : PUSH 0x1
00853672 : PUSH 0x1
00853674 : LEA ECX,[ECX + EBX*0x1 + 0x138]
0085367b : PUSH 0x1
0085367d : LEA EAX,[EBX + 0x1d38]
00853683 : PUSH EAX
00853684 : CALL EDX
00853686 : MOV EAX,dword ptr [EBX + 0x18a8]
0085368c : MOV EAX,dword ptr [EAX + 0x28]
0085368f : PUSH EAX
00853690 : CALL 0x004049b0
00853695 : MOV ESI,EAX
00853697 : XOR EDI,EDI
00853699 : ADD ESP,0x4
0085369c : CMP ESI,EDI
0085369e : JZ 0x008536fe
008536a0 : MOV EDX,dword ptr [ESI]
008536a2 : MOV EAX,dword ptr [EDX + 0x38]
008536a5 : MOV ECX,ESI
008536a7 : CALL EAX
008536a9 : TEST EAX,EAX
008536ab : JZ 0x008536fe
008536ad : ADD ESI,0xc4
008536b3 : PUSH ESI
008536b4 : LEA ESI,[ESP + 0x18]
008536b8 : CALL 0x00404350
008536bd : ADD ESP,0x4
008536c0 : MOV dword ptr [ESP + 0x40],EDI
008536c4 : MOV ESI,0xc3f4c8
008536c9 : LEA ECX,[ESP + 0x14]
008536cd : CALL 0x004049e0
008536d2 : TEST AL,AL
008536d4 : JZ 0x008536e4
008536d6 : PUSH 0x1
008536d8 : LEA ECX,[ESP + 0x18]
008536dc : PUSH ECX
008536dd : MOV ESI,EBX
008536df : CALL 0x008980b0
008536e4 : PUSH 0x12
008536e6 : MOV ECX,EBX
008536e8 : CALL 0x0088e570
008536ed : MOV dword ptr [ESP + 0x40],0xffffffff
008536f5 : LEA ECX,[ESP + 0x14]
008536f9 : CALL 0x00406560
008536fe : PUSH 0x1
00853700 : PUSH EBX
00853701 : CALL 0x0085bfe0
00853706 : MOV ECX,EBX
00853708 : CALL 0x0085c1c0
0085370d : MOV ECX,dword ptr [EBX + 0x18a8]
00853713 : PUSH EDI
00853714 : XOR AL,AL
00853716 : CALL 0x0083bb00
0085371b : MOV ESI,dword ptr [EBX + 0x18a8]
00853721 : CALL 0x0083ba10
00853726 : MOV EDX,dword ptr [EBX + 0x138]
0085372c : MOV EAX,dword ptr [EDX + 0x4]
0085372f : MOV EDX,dword ptr [EAX + EBX*0x1 + 0x138]
00853736 : MOV EDX,dword ptr [EDX + 0x10]
00853739 : PUSH 0x1
0085373b : LEA ECX,[EAX + EBX*0x1 + 0x138]
00853742 : PUSH EDI
00853743 : PUSH 0x1
00853745 : LEA EAX,[EBX + 0x6d8]
0085374b : PUSH EAX
0085374c : CALL EDX
0085374e : XORPS XMM0,XMM0
00853751 : PUSH 0xd720f0
00853756 : MOV ESI,EBX
00853758 : MOV dword ptr [EBX + 0x19ec],EDI
0085375e : MOVSS dword ptr [EBX + 0x1a68],XMM0
00853766 : CALL 0x00856310
0085376b : CMP byte ptr [EBX + 0x4d4],0x0
00853772 : JZ 0x00853815
00853778 : MOV EDI,dword ptr [EBX + 0x17f0]
0085377e : PUSH 0x1
00853780 : CALL 0x0084c320
00853785 : MOV ESI,dword ptr [EBX + 0x17f0]
0085378b : MOV ECX,dword ptr [ESI + 0x168]
00853791 : MOV byte ptr [ESI + 0x1a8],0x0
00853798 : TEST ECX,ECX
0085379a : JZ 0x008537a5
0085379c : MOV EAX,dword ptr [ECX]
0085379e : MOV EDX,dword ptr [EAX + 0x10]
008537a1 : PUSH 0x0
008537a3 : CALL EDX
008537a5 : MOV ECX,dword ptr [ESI + 0x16c]
008537ab : TEST ECX,ECX
008537ad : JZ 0x008537b8
008537af : MOV EAX,dword ptr [ECX]
008537b1 : MOV EDX,dword ptr [EAX + 0x10]
008537b4 : PUSH 0x0
008537b6 : CALL EDX
008537b8 : MOV EDI,dword ptr [EBX + 0x1870]
008537be : PUSH 0x1
008537c0 : CALL 0x0084c320
008537c5 : MOV ESI,dword ptr [EBX + 0x1870]
008537cb : MOV ECX,dword ptr [ESI + 0x168]
008537d1 : MOV byte ptr [ESI + 0x1a8],0x0
008537d8 : TEST ECX,ECX
008537da : JZ 0x008537e5
008537dc : MOV EAX,dword ptr [ECX]
008537de : MOV EDX,dword ptr [EAX + 0x10]
008537e1 : PUSH 0x0
008537e3 : CALL EDX
008537e5 : MOV ESI,dword ptr [ESI + 0x16c]
008537eb : TEST ESI,ESI
008537ed : JZ 0x008537fa
008537ef : MOV EAX,dword ptr [ESI]
008537f1 : MOV EDX,dword ptr [EAX + 0x10]
008537f4 : PUSH 0x0
008537f6 : MOV ECX,ESI
008537f8 : CALL EDX
008537fa : MOV EDI,dword ptr [EBX + 0x17f4]
00853800 : PUSH 0x1
00853802 : CALL 0x0084c320
00853807 : MOV byte ptr [EBX + 0x198c],0x1
0085380e : MOV byte ptr [EBX + 0x4d4],0x0
00853815 : MOV ECX,EBX
00853817 : CALL 0x00887160
0085381c : MOV ECX,dword ptr [ESP + 0x38]
00853820 : MOV dword ptr FS:[0x0],ECX
00853827 : POP ECX
00853828 : POP EDI
00853829 : POP ESI
0085382a : POP EBX
0085382b : MOV ECX,dword ptr [ESP + 0x20]
0085382f : XOR ECX,ESP
00853831 : CALL 0x00633e6b
00853836 : MOV ESP,EBP
00853838 : POP EBP
00853839 : RET

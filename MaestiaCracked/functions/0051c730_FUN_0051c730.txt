PROGRAM  : Maestia.exe
FUNCTION : FUN_0051c730
ENTRY    : 0051c730
BODY     : [[0051c730, 0051c808]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_0051c730(undefined4 *param_1,uint param_2,uint param_3)

{
  uint uVar1;
  undefined4 uVar2;
  int iVar3;
  uint *in_ECX;
  uint *puVar4;
  uint uVar5;
  int *piVar6;
  bool bVar7;
  
  puVar4 = (uint *)(*in_ECX & 0xfffffffc);
  uVar5 = *puVar4 & 0x7fffffff;
  if ((-1 < (int)*puVar4) &&
     (uVar1 = FUN_0051b0c0(puVar4 + 2,uVar5), bVar7 = uVar1 == uVar5, uVar5 = uVar1, bVar7)) {
    *puVar4 = *puVar4 | 0x80000000;
  }
  if ((param_2 < uVar5) && (param_2 < param_3)) {
    piVar6 = (int *)(*in_ECX & 0xfffffffc);
    if (-1 < *piVar6) {
      iVar3 = FUN_0051b130(param_2,piVar6 + 2,0xffffffff);
      iVar3 = iVar3 + 8 + (int)piVar6;
      uVar2 = FUN_0051b130(param_3 - param_2,iVar3,0xffffffff);
      uVar2 = FUN_0051b700(DAT_00d73250,uVar2,0,iVar3,uVar2);
      *param_1 = uVar2;
      return param_1;
    }
    uVar2 = FUN_0051b700(DAT_00d73250,param_3 - param_2,0,(int)piVar6 + param_2 + 8,
                         param_3 - param_2);
    *param_1 = uVar2;
    return param_1;
  }
  *param_1 = &DAT_00d65130;
  InterlockedExchangeAdd((LONG *)&DAT_00d65134,1);
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
0051c730 : PUSH EBX
0051c731 : PUSH EBP
0051c732 : PUSH ESI
0051c733 : MOV EBP,ECX
0051c735 : MOV ESI,dword ptr [EBP]
0051c738 : AND ESI,0xfffffffc
0051c73b : MOV EAX,dword ptr [ESI]
0051c73d : PUSH EDI
0051c73e : MOV EDI,EAX
0051c740 : SHR EAX,0x1f
0051c743 : AND EDI,0x7fffffff
0051c749 : TEST AL,0x1
0051c74b : JZ 0x0051c751
0051c74d : MOV EAX,EDI
0051c74f : JMP 0x0051c765
0051c751 : PUSH EDI
0051c752 : LEA EAX,[ESI + 0x8]
0051c755 : PUSH EAX
0051c756 : CALL 0x0051b0c0
0051c75b : CMP EAX,EDI
0051c75d : JNZ 0x0051c765
0051c75f : OR dword ptr [ESI],0x80000000
0051c765 : MOV EBX,dword ptr [ESP + 0x18]
0051c769 : CMP EBX,EAX
0051c76b : JNC 0x0051c7e9
0051c76d : MOV ESI,dword ptr [ESP + 0x1c]
0051c771 : CMP EBX,ESI
0051c773 : JNC 0x0051c7e9
0051c775 : MOV EDI,dword ptr [EBP]
0051c778 : AND EDI,0xfffffffc
0051c77b : MOV ECX,dword ptr [EDI]
0051c77d : SHR ECX,0x1f
0051c780 : TEST CL,0x1
0051c783 : JZ 0x0051c7ac
0051c785 : MOV EAX,[0x00d73250]
0051c78a : SUB ESI,EBX
0051c78c : PUSH ESI
0051c78d : LEA EDX,[EDI + EBX*0x1 + 0x8]
0051c791 : PUSH EDX
0051c792 : PUSH 0x0
0051c794 : PUSH ESI
0051c795 : MOV ESI,dword ptr [ESP + 0x24]
0051c799 : PUSH EAX
0051c79a : MOV ECX,ESI
0051c79c : CALL 0x0051b700
0051c7a1 : POP EDI
0051c7a2 : MOV dword ptr [ESI],EAX
0051c7a4 : MOV EAX,ESI
0051c7a6 : POP ESI
0051c7a7 : POP EBP
0051c7a8 : POP EBX
0051c7a9 : RET 0xc
0051c7ac : PUSH -0x1
0051c7ae : LEA ECX,[EDI + 0x8]
0051c7b1 : PUSH ECX
0051c7b2 : PUSH EBX
0051c7b3 : CALL 0x0051b130
0051c7b8 : PUSH -0x1
0051c7ba : LEA EDI,[EAX + EDI*0x1 + 0x8]
0051c7be : PUSH EDI
0051c7bf : SUB ESI,EBX
0051c7c1 : PUSH ESI
0051c7c2 : CALL 0x0051b130
0051c7c7 : MOV EDX,dword ptr [0x00d73250]
0051c7cd : MOV ESI,dword ptr [ESP + 0x14]
0051c7d1 : PUSH EAX
0051c7d2 : PUSH EDI
0051c7d3 : PUSH 0x0
0051c7d5 : PUSH EAX
0051c7d6 : PUSH EDX
0051c7d7 : MOV ECX,ESI
0051c7d9 : CALL 0x0051b700
0051c7de : POP EDI
0051c7df : MOV dword ptr [ESI],EAX
0051c7e1 : MOV EAX,ESI
0051c7e3 : POP ESI
0051c7e4 : POP EBP
0051c7e5 : POP EBX
0051c7e6 : RET 0xc
0051c7e9 : MOV ESI,dword ptr [ESP + 0x14]
0051c7ed : PUSH 0x1
0051c7ef : PUSH 0xd65134
0051c7f4 : MOV dword ptr [ESI],0xd65130
0051c7fa : CALL dword ptr [0x00b851cc]
0051c800 : POP EDI
0051c801 : MOV EAX,ESI
0051c803 : POP ESI
0051c804 : POP EBP
0051c805 : POP EBX
0051c806 : RET 0xc

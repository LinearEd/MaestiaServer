PROGRAM  : Maestia.exe
FUNCTION : FUN_006b26f0
ENTRY    : 006b26f0
BODY     : [[006b26f0, 006b287e]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006b26f0(int param_1,int param_2)

{
  undefined1 *puVar1;
  int iVar2;
  int iVar3;
  undefined4 uVar4;
  uint uVar5;
  uint uVar6;
  undefined1 *puVar7;
  uint uVar8;
  uint local_c;
  undefined4 local_8;
  undefined1 *puStack_4;
  
  iVar3 = param_2;
  iVar2 = param_1;
  local_8 = *(undefined4 *)(param_2 + 0x1c);
  param_1 = (**(code **)(param_1 + 0x1fc))(param_1,0x68646d78,param_2,&local_c);
  if ((param_1 != 0) || (local_c < 8)) {
    return 0;
  }
  param_1 = FUN_0068a1f0(iVar3,local_c,(undefined4 *)(iVar2 + 0x2e8));
  if (param_1 == 0) {
    puVar1 = *(undefined1 **)(iVar2 + 0x2e8);
    puStack_4 = puVar1 + local_c;
    puVar7 = puVar1 + 8;
    uVar6 = (uint)CONCAT11(puVar1[2],puVar1[3]);
    uVar8 = CONCAT31(CONCAT21(CONCAT11(puVar1[4],puVar1[5]),puVar1[6]),puVar1[7]);
    if (0xfffeffff < uVar8) {
      uVar8 = uVar8 & 0xffff;
    }
    if (((CONCAT11(*puVar1,puVar1[1]) == 0) && (uVar6 < 0x100)) && (uVar8 < 0x10002)) {
      uVar4 = FUN_0068a220(local_8,1,0,uVar6,0,&param_1);
      *(undefined4 *)(iVar2 + 0x2f8) = uVar4;
      if (param_1 == 0) {
        uVar5 = 0;
        if (uVar6 != 0) {
          do {
            if (puStack_4 < puVar7 + uVar8) break;
            *(undefined1 *)(uVar5 + *(int *)(iVar2 + 0x2f8)) = *puVar7;
            uVar5 = uVar5 + 1;
            puVar7 = puVar7 + uVar8;
          } while (uVar5 < uVar6);
        }
        *(uint *)(iVar2 + 0x2f0) = uVar5;
        *(uint *)(iVar2 + 0x2f4) = uVar8;
        *(uint *)(iVar2 + 0x2ec) = local_c;
        return 0;
      }
    }
    else {
      param_1 = 3;
    }
    FUN_006888c0(param_2,iVar2 + 0x2e8);
    *(undefined4 *)(iVar2 + 0x2ec) = 0;
  }
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
006b26f0 : SUB ESP,0xc
006b26f3 : PUSH EBP
006b26f4 : MOV EBP,dword ptr [ESP + 0x14]
006b26f8 : MOV EDX,dword ptr [EBP + 0x1fc]
006b26fe : PUSH EDI
006b26ff : MOV EDI,dword ptr [ESP + 0x1c]
006b2703 : MOV EAX,dword ptr [EDI + 0x1c]
006b2706 : LEA ECX,[ESP + 0x8]
006b270a : PUSH ECX
006b270b : PUSH EDI
006b270c : PUSH 0x68646d78
006b2711 : PUSH EBP
006b2712 : MOV dword ptr [ESP + 0x1c],EAX
006b2716 : CALL EDX
006b2718 : ADD ESP,0x10
006b271b : MOV dword ptr [ESP + 0x18],EAX
006b271f : TEST EAX,EAX
006b2721 : JNZ 0x006b2877
006b2727 : MOV EAX,dword ptr [ESP + 0x8]
006b272b : CMP EAX,0x8
006b272e : JC 0x006b2877
006b2734 : PUSH ESI
006b2735 : LEA ESI,[EBP + 0x2e8]
006b273b : PUSH ESI
006b273c : PUSH EAX
006b273d : PUSH EDI
006b273e : CALL 0x0068a1f0
006b2743 : ADD ESP,0xc
006b2746 : MOV dword ptr [ESP + 0x1c],EAX
006b274a : TEST EAX,EAX
006b274c : JNZ 0x006b286c
006b2752 : MOV ESI,dword ptr [ESI]
006b2754 : MOV EAX,dword ptr [ESP + 0xc]
006b2758 : MOVZX EDX,byte ptr [ESI]
006b275b : LEA ECX,[ESI + EAX*0x1]
006b275e : ADD ESI,0x2
006b2761 : SHL DX,0x8
006b2765 : MOVZX EAX,DX
006b2768 : MOVZX EDX,byte ptr [ESI]
006b276b : MOV dword ptr [ESP + 0x14],ECX
006b276f : MOVZX ECX,byte ptr [ESI + -0x1]
006b2773 : ADD ESI,0x2
006b2776 : MOVZX EDI,byte ptr [ESI]
006b2779 : OR EAX,ECX
006b277b : MOVZX ECX,byte ptr [ESI + -0x1]
006b277f : ADD ESI,0x4
006b2782 : SHL DX,0x8
006b2786 : PUSH EBX
006b2787 : MOVZX EBX,DX
006b278a : MOVZX EDX,byte ptr [ESI + -0x3]
006b278e : SHL EDI,0x8
006b2791 : OR EDI,EDX
006b2793 : MOVZX EDX,byte ptr [ESI + -0x1]
006b2797 : OR EBX,ECX
006b2799 : MOVZX ECX,byte ptr [ESI + -0x2]
006b279d : SHL EDI,0x8
006b27a0 : OR EDI,ECX
006b27a2 : SHL EDI,0x8
006b27a5 : OR EDI,EDX
006b27a7 : CMP EDI,0xffff0000
006b27ad : JC 0x006b27b5
006b27af : AND EDI,0xffff
006b27b5 : TEST EAX,EAX
006b27b7 : JNZ 0x006b2845
006b27bd : CMP EBX,0xff
006b27c3 : JA 0x006b2845
006b27c9 : CMP EDI,0x10001
006b27cf : JA 0x006b2845
006b27d1 : MOV ECX,dword ptr [ESP + 0x14]
006b27d5 : LEA EAX,[ESP + 0x20]
006b27d9 : PUSH EAX
006b27da : PUSH 0x0
006b27dc : PUSH EBX
006b27dd : PUSH 0x0
006b27df : PUSH 0x1
006b27e1 : PUSH ECX
006b27e2 : CALL 0x0068a220
006b27e7 : ADD ESP,0x18
006b27ea : CMP dword ptr [ESP + 0x20],0x0
006b27ef : MOV dword ptr [EBP + 0x2f8],EAX
006b27f5 : JNZ 0x006b284d
006b27f7 : XOR EAX,EAX
006b27f9 : TEST EBX,EBX
006b27fb : JBE 0x006b2823
006b27fd : LEA ECX,[ECX]
006b2800 : LEA ECX,[EDI + ESI*0x1]
006b2803 : CMP ECX,dword ptr [ESP + 0x18]
006b2807 : JA 0x006b2823
006b2809 : MOV EDX,dword ptr [EBP + 0x2f8]
006b280f : MOV dword ptr [ESP + 0x24],EBX
006b2813 : MOV BL,byte ptr [ESI]
006b2815 : MOV byte ptr [EAX + EDX*0x1],BL
006b2818 : MOV EBX,dword ptr [ESP + 0x24]
006b281c : INC EAX
006b281d : MOV ESI,ECX
006b281f : CMP EAX,EBX
006b2821 : JC 0x006b2800
006b2823 : POP EBX
006b2824 : MOV dword ptr [EBP + 0x2f0],EAX
006b282a : MOV EAX,dword ptr [ESP + 0xc]
006b282e : POP ESI
006b282f : MOV dword ptr [EBP + 0x2f4],EDI
006b2835 : MOV dword ptr [EBP + 0x2ec],EAX
006b283b : MOV EAX,dword ptr [ESP + 0x18]
006b283f : POP EDI
006b2840 : POP EBP
006b2841 : ADD ESP,0xc
006b2844 : RET
006b2845 : MOV dword ptr [ESP + 0x20],0x3
006b284d : MOV ECX,dword ptr [ESP + 0x24]
006b2851 : LEA EAX,[EBP + 0x2e8]
006b2857 : PUSH EAX
006b2858 : PUSH ECX
006b2859 : CALL 0x006888c0
006b285e : ADD ESP,0x8
006b2861 : MOV dword ptr [EBP + 0x2ec],0x0
006b286b : POP EBX
006b286c : MOV EAX,dword ptr [ESP + 0x1c]
006b2870 : POP ESI
006b2871 : POP EDI
006b2872 : POP EBP
006b2873 : ADD ESP,0xc
006b2876 : RET
006b2877 : POP EDI
006b2878 : XOR EAX,EAX
006b287a : POP EBP
006b287b : ADD ESP,0xc
006b287e : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_0081fc10
ENTRY    : 0081fc10
BODY     : [[0081fc10, 0081fc8c] [0081fc90, 0081fdb8]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0081fc10(void)

{
  wchar_t wVar1;
  short sVar2;
  uint3 uVar3;
  char cVar4;
  uint uVar5;
  short ****ppppsVar6;
  undefined4 uVar7;
  wchar_t *pwVar8;
  short ****ppppsVar9;
  wchar_t *unaff_EDI;
  undefined1 *puVar10;
  undefined1 *puVar11;
  undefined1 local_6c [4];
  undefined2 local_68;
  undefined4 local_58;
  uint local_54;
  undefined1 local_4d;
  short ***local_48 [4];
  undefined4 local_38;
  uint local_34;
  undefined1 local_30 [4];
  undefined4 local_2c;
  size_t local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3a6fb;
  local_10 = ExceptionList;
  uVar5 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_48[0] = (short ***)((uint)local_48[0] & 0xffff0000);
  local_34 = 7;
  local_38 = 0;
  pwVar8 = unaff_EDI;
  do {
    wVar1 = *pwVar8;
    pwVar8 = pwVar8 + 1;
  } while (wVar1 != L'\0');
  local_14 = uVar5;
  FUN_00406360(unaff_EDI,(int)pwVar8 - (int)(unaff_EDI + 1) >> 1);
  local_8 = 0;
  ppppsVar9 = (short ****)local_48[0];
  if (local_34 < 8) {
    ppppsVar9 = local_48;
  }
  local_18 = 7;
  local_1c = 0;
  local_2c._0_2_ = L'\0';
  ppppsVar6 = ppppsVar9;
  do {
    sVar2 = *(short *)ppppsVar6;
    ppppsVar6 = (short ****)((int)ppppsVar6 + 2);
  } while (sVar2 != 0);
  FUN_00406360(ppppsVar9,(int)ppppsVar6 - (int)((int)ppppsVar9 + 2) >> 1);
  local_8._0_1_ = 1;
  uVar7 = FUN_0041f000(uVar5);
  cVar4 = FUN_006ef6f0(uVar7);
  uVar3 = local_8._1_3_;
  local_4d = cVar4 == '\0';
  local_8 = (uint)local_8._1_3_ << 8;
  if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  uVar5 = (uint)local_2c._2_2_;
  if ((bool)local_4d) {
    local_18 = 7;
    local_1c = 0;
    local_2c = (wchar_t *)((uint)local_2c._2_2_ << 0x10);
    local_8._0_1_ = 2;
    local_8._1_3_ = uVar3;
    FUN_00406460(unaff_EDI);
    local_8._0_1_ = 3;
    puVar11 = local_6c;
    puVar10 = local_30;
    uVar7 = FUN_0041f000(puVar10,puVar11);
    FUN_006ef7a0(uVar7,puVar10,puVar11);
    local_8._0_1_ = 2;
    if (7 < local_54) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_68 = 0;
    local_54 = 7;
    local_58 = 0;
    pwVar8 = local_2c;
    if (local_18 < 8) {
      pwVar8 = (wchar_t *)&local_2c;
    }
    _wcsncpy(unaff_EDI,pwVar8,local_1c);
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    uVar5 = (uint)local_2c >> 0x10;
  }
  local_2c = (wchar_t *)(uVar5 << 0x10);
  local_18 = 7;
  local_1c = 0;
  local_8 = 0xffffffff;
  if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_34 = 7;
  local_38 = 0;
  local_48[0] = (short ***)((uint)local_48[0] & 0xffff0000);
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0081fc10 : PUSH EBP
0081fc11 : MOV EBP,ESP
0081fc13 : PUSH -0x1
0081fc15 : PUSH 0xb3a6fb
0081fc1a : MOV EAX,FS:[0x0]
0081fc20 : PUSH EAX
0081fc21 : SUB ESP,0x60
0081fc24 : MOV EAX,[0x00d66fa0]
0081fc29 : XOR EAX,EBP
0081fc2b : MOV dword ptr [EBP + -0x10],EAX
0081fc2e : PUSH EBX
0081fc2f : PUSH ESI
0081fc30 : PUSH EAX
0081fc31 : LEA EAX,[EBP + -0xc]
0081fc34 : MOV FS:[0x0],EAX
0081fc3a : XOR EBX,EBX
0081fc3c : XOR EAX,EAX
0081fc3e : MOV word ptr [EBP + -0x44],AX
0081fc42 : MOV ESI,0x7
0081fc47 : MOV EAX,EDI
0081fc49 : MOV dword ptr [EBP + -0x30],ESI
0081fc4c : MOV dword ptr [EBP + -0x34],EBX
0081fc4f : LEA EDX,[EAX + 0x2]
0081fc52 : MOV CX,word ptr [EAX]
0081fc55 : ADD EAX,0x2
0081fc58 : CMP CX,BX
0081fc5b : JNZ 0x0081fc52
0081fc5d : SUB EAX,EDX
0081fc5f : SAR EAX,0x1
0081fc61 : PUSH EAX
0081fc62 : PUSH EDI
0081fc63 : LEA ECX,[EBP + -0x48]
0081fc66 : CALL 0x00406360
0081fc6b : MOV dword ptr [EBP + -0x4],EBX
0081fc6e : CMP dword ptr [EBP + -0x30],0x8
0081fc72 : MOV EDX,dword ptr [EBP + -0x44]
0081fc75 : JNC 0x0081fc7a
0081fc77 : LEA EDX,[EBP + -0x44]
0081fc7a : XOR ECX,ECX
0081fc7c : MOV EAX,EDX
0081fc7e : MOV dword ptr [EBP + -0x14],ESI
0081fc81 : MOV dword ptr [EBP + -0x18],EBX
0081fc84 : MOV word ptr [EBP + -0x28],CX
0081fc88 : LEA ESI,[EAX + 0x2]
0081fc8b : JMP 0x0081fc90
0081fc90 : MOV CX,word ptr [EAX]
0081fc93 : ADD EAX,0x2
0081fc96 : CMP CX,BX
0081fc99 : JNZ 0x0081fc90
0081fc9b : SUB EAX,ESI
0081fc9d : SAR EAX,0x1
0081fc9f : PUSH EAX
0081fca0 : PUSH EDX
0081fca1 : LEA ECX,[EBP + -0x2c]
0081fca4 : CALL 0x00406360
0081fca9 : MOV byte ptr [EBP + -0x4],0x1
0081fcad : CALL 0x0041f000
0081fcb2 : PUSH EAX
0081fcb3 : LEA ECX,[EBP + -0x2c]
0081fcb6 : CALL 0x006ef6f0
0081fcbb : TEST AL,AL
0081fcbd : SETZ byte ptr [EBP + -0x49]
0081fcc1 : MOV byte ptr [EBP + -0x4],BL
0081fcc4 : MOV ESI,0x8
0081fcc9 : CMP dword ptr [EBP + -0x14],ESI
0081fccc : JC 0x0081fcd6
0081fcce : MOV ECX,dword ptr [EBP + -0x28]
0081fcd1 : CALL 0x006f04e0
0081fcd6 : XOR EDX,EDX
0081fcd8 : MOV EAX,0x7
0081fcdd : MOV dword ptr [EBP + -0x14],EAX
0081fce0 : MOV dword ptr [EBP + -0x18],EBX
0081fce3 : MOV word ptr [EBP + -0x28],DX
0081fce7 : CMP byte ptr [EBP + -0x49],BL
0081fcea : JZ 0x0081fd7a
0081fcf0 : MOV dword ptr [EBP + -0x14],EAX
0081fcf3 : XOR EAX,EAX
0081fcf5 : MOV dword ptr [EBP + -0x18],EBX
0081fcf8 : MOV word ptr [EBP + -0x28],AX
0081fcfc : MOV byte ptr [EBP + -0x4],0x2
0081fd00 : PUSH EDI
0081fd01 : LEA ECX,[EBP + -0x68]
0081fd04 : CALL 0x00406460
0081fd09 : MOV byte ptr [EBP + -0x4],0x3
0081fd0d : LEA ECX,[EBP + -0x68]
0081fd10 : PUSH ECX
0081fd11 : LEA EDX,[EBP + -0x2c]
0081fd14 : PUSH EDX
0081fd15 : CALL 0x0041f000
0081fd1a : PUSH EAX
0081fd1b : CALL 0x006ef7a0
0081fd20 : MOV byte ptr [EBP + -0x4],0x2
0081fd24 : CMP dword ptr [EBP + -0x50],ESI
0081fd27 : JC 0x0081fd31
0081fd29 : MOV ECX,dword ptr [EBP + -0x64]
0081fd2c : CALL 0x006f04e0
0081fd31 : XOR EAX,EAX
0081fd33 : MOV word ptr [EBP + -0x64],AX
0081fd37 : MOV EAX,dword ptr [EBP + -0x28]
0081fd3a : MOV dword ptr [EBP + -0x50],0x7
0081fd41 : MOV dword ptr [EBP + -0x54],EBX
0081fd44 : CMP dword ptr [EBP + -0x14],ESI
0081fd47 : JNC 0x0081fd4c
0081fd49 : LEA EAX,[EBP + -0x28]
0081fd4c : MOV ECX,dword ptr [EBP + -0x18]
0081fd4f : PUSH ECX
0081fd50 : PUSH EAX
0081fd51 : PUSH EDI
0081fd52 : CALL 0x00634e39
0081fd57 : ADD ESP,0xc
0081fd5a : MOV byte ptr [EBP + -0x4],BL
0081fd5d : CMP dword ptr [EBP + -0x14],ESI
0081fd60 : JC 0x0081fd6a
0081fd62 : MOV ECX,dword ptr [EBP + -0x28]
0081fd65 : CALL 0x006f04e0
0081fd6a : XOR EDX,EDX
0081fd6c : MOV dword ptr [EBP + -0x14],0x7
0081fd73 : MOV dword ptr [EBP + -0x18],EBX
0081fd76 : MOV word ptr [EBP + -0x28],DX
0081fd7a : MOV dword ptr [EBP + -0x4],0xffffffff
0081fd81 : CMP dword ptr [EBP + -0x30],ESI
0081fd84 : JC 0x0081fd8e
0081fd86 : MOV ECX,dword ptr [EBP + -0x44]
0081fd89 : CALL 0x006f04e0
0081fd8e : XOR EAX,EAX
0081fd90 : MOV dword ptr [EBP + -0x30],0x7
0081fd97 : MOV dword ptr [EBP + -0x34],EBX
0081fd9a : MOV word ptr [EBP + -0x44],AX
0081fd9e : MOV ECX,dword ptr [EBP + -0xc]
0081fda1 : MOV dword ptr FS:[0x0],ECX
0081fda8 : POP ECX
0081fda9 : POP ESI
0081fdaa : POP EBX
0081fdab : MOV ECX,dword ptr [EBP + -0x10]
0081fdae : XOR ECX,EBP
0081fdb0 : CALL 0x00633e6b
0081fdb5 : MOV ESP,EBP
0081fdb7 : POP EBP
0081fdb8 : RET

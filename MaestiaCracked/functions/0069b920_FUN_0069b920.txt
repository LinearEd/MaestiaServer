PROGRAM  : Maestia.exe
FUNCTION : FUN_0069b920
ENTRY    : 0069b920
BODY     : [[0069b920, 0069ba4d] [0069ba50, 0069bb95]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_0069b920(uint *param_1,short *param_2,int param_3,uint *param_4)

{
  short sVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  char cVar5;
  uint uVar6;
  undefined4 *puVar7;
  int *piVar8;
  int *piVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  uint *puVar13;
  uint local_20;
  int local_1c;
  uint local_18;
  int *local_14;
  undefined4 local_10;
  int local_c;
  int local_8;
  uint local_4;
  
  _memset(param_1,0,0x80);
  uVar2 = *param_4;
  param_1[4] = uVar2;
  local_4 = uVar2;
  uVar6 = FUN_0068a220(uVar2,0x30,0,(int)param_2[1],0,&local_1c);
  param_1[2] = uVar6;
  if (local_1c == 0) {
    puVar7 = (undefined4 *)FUN_0068a220(uVar2,8,0,(int)*param_2,0,&local_1c);
    param_1[3] = (uint)puVar7;
    if (local_1c != 0) {
      return local_1c;
    }
    *param_1 = (int)param_2[1];
    sVar1 = *param_2;
    uVar2 = param_1[2];
    param_1[1] = (int)sVar1;
    local_18 = 0;
    if ((int)sVar1 != 0) {
      iVar12 = 0;
      do {
        iVar11 = *(short *)(*(int *)(param_2 + 6) + local_18 * 2) + 1;
        iVar10 = iVar11 - iVar12;
        local_14 = (int *)(iVar12 * 0x30 + uVar2);
        *puVar7 = local_14;
        puVar7[1] = iVar10;
        if (0 < iVar10) {
          *local_14 = iVar11 * 0x30 + -0x30 + uVar2;
          local_14[2] = (int)puVar7;
          piVar9 = local_14;
          if (1 < iVar10) {
            iVar10 = iVar10 + -1;
            piVar8 = local_14;
            do {
              iVar10 = iVar10 + -1;
              piVar9 = piVar8 + 0xc;
              piVar8[1] = (int)piVar9;
              *piVar9 = (int)piVar8;
              piVar8[0xe] = (int)puVar7;
              piVar8 = piVar9;
            } while (iVar10 != 0);
          }
          piVar9[1] = (int)local_14;
        }
        local_18 = local_18 + 1;
        puVar7 = puVar7 + 2;
        iVar12 = iVar11;
      } while (local_18 < param_1[1]);
    }
    local_18 = param_1[2];
    iVar12 = *(int *)(param_2 + 2);
    local_20 = 0;
    if (*param_1 != 0) {
      puVar13 = (uint *)(local_18 + 0xc);
      do {
        iVar10 = (int)(puVar13[-3] - local_18) / 0x30;
        local_14 = (int *)((int)(puVar13[-2] - local_18) / 0x30);
        if ((*(byte *)(local_20 + *(int *)(param_2 + 4)) & 1) == 0) {
          *puVar13 = 1;
        }
        local_8 = *(int *)(iVar12 + local_20 * 8) - *(int *)(iVar12 + iVar10 * 8);
        local_c = *(int *)(iVar12 + 4 + local_20 * 8) - *(int *)(iVar12 + 4 + iVar10 * 8);
        local_10 = FUN_0069b830();
        *(char *)(puVar13 + 2) = (char)local_10;
        iVar10 = *(int *)(iVar12 + (int)local_14 * 8);
        iVar11 = *(int *)(iVar12 + 4 + (int)local_14 * 8);
        iVar3 = *(int *)(iVar12 + local_20 * 8);
        iVar4 = *(int *)(iVar12 + 4 + local_20 * 8);
        cVar5 = FUN_0069b830();
        *(char *)((int)puVar13 + 9) = cVar5;
        if ((*puVar13 & 1) == 0) {
          if (((char)local_10 == cVar5) &&
             ((cVar5 != '\x04' ||
              (iVar10 = FUN_006862b0(local_8,local_c,iVar10 - iVar3,iVar11 - iVar4), iVar10 != 0))))
          {
            *puVar13 = *puVar13 | 2;
          }
        }
        else {
          *puVar13 = *puVar13 | 2;
        }
        local_20 = local_20 + 1;
        puVar13 = puVar13 + 0xc;
      } while (local_20 < *param_1);
    }
    param_1[5] = (uint)param_2;
    param_1[6] = (uint)param_4;
    FUN_0069b880();
    FUN_0069b650(param_1);
    local_1c = FUN_0069b100(param_3 + 0x10,param_3 + 0x1c);
    if (local_1c == 0) {
      local_1c = FUN_0069b100(param_3 + 0x34,param_3 + 0x40);
    }
  }
  return local_1c;
}



============================================================
DISASSEMBLY
============================================================
0069b920 : SUB ESP,0x20
0069b923 : PUSH EBP
0069b924 : MOV EBP,dword ptr [ESP + 0x28]
0069b928 : PUSH ESI
0069b929 : PUSH EDI
0069b92a : PUSH 0x80
0069b92f : PUSH 0x0
0069b931 : PUSH EBP
0069b932 : CALL 0x0063b700
0069b937 : MOV EAX,dword ptr [ESP + 0x48]
0069b93b : MOV ESI,dword ptr [EAX]
0069b93d : MOV EDI,dword ptr [ESP + 0x40]
0069b941 : LEA ECX,[ESP + 0x1c]
0069b945 : PUSH ECX
0069b946 : MOV dword ptr [EBP + 0x10],ESI
0069b949 : MOVSX EDX,word ptr [EDI + 0x2]
0069b94d : PUSH 0x0
0069b94f : PUSH EDX
0069b950 : PUSH 0x0
0069b952 : PUSH 0x30
0069b954 : PUSH ESI
0069b955 : MOV dword ptr [ESP + 0x4c],ESI
0069b959 : CALL 0x0068a220
0069b95e : MOV dword ptr [EBP + 0x8],EAX
0069b961 : MOV EAX,dword ptr [ESP + 0x34]
0069b965 : ADD ESP,0x24
0069b968 : TEST EAX,EAX
0069b96a : JNZ 0x0069bb86
0069b970 : MOVSX ECX,word ptr [EDI]
0069b973 : LEA EAX,[ESP + 0x10]
0069b977 : PUSH EAX
0069b978 : PUSH 0x0
0069b97a : PUSH ECX
0069b97b : PUSH 0x0
0069b97d : PUSH 0x8
0069b97f : PUSH ESI
0069b980 : CALL 0x0068a220
0069b985 : MOV ECX,dword ptr [ESP + 0x28]
0069b989 : ADD ESP,0x18
0069b98c : MOV dword ptr [EBP + 0xc],EAX
0069b98f : TEST ECX,ECX
0069b991 : JNZ 0x0069bb8d
0069b997 : MOVSX EDX,word ptr [EDI + 0x2]
0069b99b : MOV dword ptr [EBP],EDX
0069b99e : MOVSX ECX,word ptr [EDI]
0069b9a1 : MOV EDX,dword ptr [EBP + 0x8]
0069b9a4 : PUSH EBX
0069b9a5 : MOV ESI,EAX
0069b9a7 : XOR EAX,EAX
0069b9a9 : XOR EBX,EBX
0069b9ab : MOV dword ptr [EBP + 0x4],ECX
0069b9ae : MOV dword ptr [ESP + 0x10],EDX
0069b9b2 : MOV dword ptr [ESP + 0x18],EAX
0069b9b6 : TEST ECX,ECX
0069b9b8 : JBE 0x0069ba30
0069b9ba : LEA EBX,[EBX]
0069b9c0 : MOV ECX,dword ptr [EDI + 0xc]
0069b9c3 : MOVSX EDX,word ptr [ECX + EAX*0x2]
0069b9c7 : INC EDX
0069b9c8 : MOV ECX,EDX
0069b9ca : SUB ECX,EBX
0069b9cc : LEA EAX,[EBX + EBX*0x2]
0069b9cf : MOV EBX,dword ptr [ESP + 0x10]
0069b9d3 : SHL EAX,0x4
0069b9d6 : ADD EAX,EBX
0069b9d8 : MOV dword ptr [ESP + 0x1c],EAX
0069b9dc : MOV dword ptr [ESI],EAX
0069b9de : MOV dword ptr [ESI + 0x4],ECX
0069b9e1 : TEST ECX,ECX
0069b9e3 : JLE 0x0069ba1d
0069b9e5 : LEA EDI,[EDX + EDX*0x2]
0069b9e8 : SHL EDI,0x4
0069b9eb : CMP ECX,0x1
0069b9ee : LEA EDI,[EDI + EBX*0x1 + -0x30]
0069b9f2 : MOV dword ptr [EAX],EDI
0069b9f4 : MOV dword ptr [EAX + 0x8],ESI
0069b9f7 : JLE 0x0069ba12
0069b9f9 : DEC ECX
0069b9fa : LEA EBX,[EBX]
0069ba00 : SUB ECX,0x1
0069ba03 : LEA EBX,[EAX + 0x30]
0069ba06 : MOV dword ptr [EAX + 0x4],EBX
0069ba09 : MOV dword ptr [EBX],EAX
0069ba0b : MOV EAX,EBX
0069ba0d : MOV dword ptr [EAX + 0x8],ESI
0069ba10 : JNZ 0x0069ba00
0069ba12 : MOV ECX,dword ptr [ESP + 0x1c]
0069ba16 : MOV EDI,dword ptr [ESP + 0x38]
0069ba1a : MOV dword ptr [EAX + 0x4],ECX
0069ba1d : MOV EAX,dword ptr [ESP + 0x18]
0069ba21 : INC EAX
0069ba22 : ADD ESI,0x8
0069ba25 : MOV EBX,EDX
0069ba27 : MOV dword ptr [ESP + 0x18],EAX
0069ba2b : CMP EAX,dword ptr [EBP + 0x4]
0069ba2e : JC 0x0069b9c0
0069ba30 : MOV EAX,dword ptr [EBP + 0x8]
0069ba33 : MOV EBX,dword ptr [EDI + 0x4]
0069ba36 : XOR ESI,ESI
0069ba38 : MOV dword ptr [ESP + 0x18],EAX
0069ba3c : MOV dword ptr [ESP + 0x10],ESI
0069ba40 : CMP dword ptr [EBP],ESI
0069ba43 : JBE 0x0069bb32
0069ba49 : LEA EBP,[EAX + 0xc]
0069ba4c : JMP 0x0069ba58
0069ba50 : MOV ESI,dword ptr [ESP + 0x10]
0069ba54 : MOV EAX,dword ptr [ESP + 0x18]
0069ba58 : MOV ECX,dword ptr [EBP + -0xc]
0069ba5b : SUB ECX,EAX
0069ba5d : MOV EAX,0x2aaaaaab
0069ba62 : IMUL ECX
0069ba64 : SAR EDX,0x3
0069ba67 : MOV ECX,EDX
0069ba69 : SHR ECX,0x1f
0069ba6c : ADD ECX,EDX
0069ba6e : MOV EDX,dword ptr [EBP + -0x8]
0069ba71 : SUB EDX,dword ptr [ESP + 0x18]
0069ba75 : MOV EAX,0x2aaaaaab
0069ba7a : IMUL EDX
0069ba7c : SAR EDX,0x3
0069ba7f : MOV EAX,EDX
0069ba81 : SHR EAX,0x1f
0069ba84 : ADD EAX,EDX
0069ba86 : MOV EDX,dword ptr [EDI + 0x8]
0069ba89 : TEST byte ptr [ESI + EDX*0x1],0x1
0069ba8d : MOV dword ptr [ESP + 0x1c],EAX
0069ba91 : JNZ 0x0069ba9a
0069ba93 : MOV dword ptr [EBP],0x1
0069ba9a : MOV EAX,dword ptr [ESP + 0x10]
0069ba9e : MOV EDI,dword ptr [EBX + EAX*0x8 + 0x4]
0069baa2 : MOV ESI,dword ptr [EBX + ESI*0x8]
0069baa5 : SUB ESI,dword ptr [EBX + ECX*0x8]
0069baa8 : SUB EDI,dword ptr [EBX + ECX*0x8 + 0x4]
0069baac : MOV dword ptr [ESP + 0x28],ESI
0069bab0 : MOV dword ptr [ESP + 0x24],EDI
0069bab4 : CALL 0x0069b830
0069bab9 : MOV ECX,dword ptr [ESP + 0x1c]
0069babd : MOV byte ptr [EBP + 0x8],AL
0069bac0 : MOV ESI,dword ptr [EBX + ECX*0x8]
0069bac3 : MOV EDI,dword ptr [EBX + ECX*0x8 + 0x4]
0069bac7 : MOV dword ptr [ESP + 0x20],EAX
0069bacb : MOV EAX,dword ptr [ESP + 0x10]
0069bacf : SUB ESI,dword ptr [EBX + EAX*0x8]
0069bad2 : SUB EDI,dword ptr [EBX + EAX*0x8 + 0x4]
0069bad6 : CALL 0x0069b830
0069badb : MOV ECX,dword ptr [EBP]
0069bade : MOV byte ptr [EBP + 0x9],AL
0069bae1 : TEST CL,0x1
0069bae4 : JZ 0x0069baee
0069bae6 : OR ECX,0x2
0069bae9 : MOV dword ptr [EBP],ECX
0069baec : JMP 0x0069bb14
0069baee : CMP byte ptr [ESP + 0x20],AL
0069baf2 : JNZ 0x0069bb14
0069baf4 : CMP AL,0x4
0069baf6 : JNZ 0x0069bb10
0069baf8 : MOV ECX,dword ptr [ESP + 0x24]
0069bafc : MOV EDX,dword ptr [ESP + 0x28]
0069bb00 : PUSH EDI
0069bb01 : PUSH ESI
0069bb02 : PUSH ECX
0069bb03 : PUSH EDX
0069bb04 : CALL 0x006862b0
0069bb09 : ADD ESP,0x10
0069bb0c : TEST EAX,EAX
0069bb0e : JZ 0x0069bb14
0069bb10 : OR dword ptr [EBP],0x2
0069bb14 : MOV EAX,dword ptr [ESP + 0x10]
0069bb18 : MOV ECX,dword ptr [ESP + 0x34]
0069bb1c : MOV EDI,dword ptr [ESP + 0x38]
0069bb20 : INC EAX
0069bb21 : ADD EBP,0x30
0069bb24 : MOV dword ptr [ESP + 0x10],EAX
0069bb28 : CMP EAX,dword ptr [ECX]
0069bb2a : JC 0x0069ba50
0069bb30 : MOV EBP,ECX
0069bb32 : MOV EDX,dword ptr [ESP + 0x40]
0069bb36 : XOR EBX,EBX
0069bb38 : MOV EAX,EBP
0069bb3a : MOV dword ptr [EBP + 0x14],EDI
0069bb3d : MOV dword ptr [EBP + 0x18],EDX
0069bb40 : CALL 0x0069b880
0069bb45 : PUSH EBP
0069bb46 : CALL 0x0069b650
0069bb4b : MOV EDI,dword ptr [ESP + 0x40]
0069bb4f : MOV EBX,dword ptr [ESP + 0x30]
0069bb53 : LEA EAX,[EDI + 0x1c]
0069bb56 : PUSH EAX
0069bb57 : LEA ECX,[EDI + 0x10]
0069bb5a : PUSH ECX
0069bb5b : LEA ESI,[EBP + 0x1c]
0069bb5e : MOV EAX,EBX
0069bb60 : CALL 0x0069b100
0069bb65 : ADD ESP,0xc
0069bb68 : MOV dword ptr [ESP + 0x14],EAX
0069bb6c : TEST EAX,EAX
0069bb6e : JNZ 0x0069bb85
0069bb70 : LEA EDX,[EDI + 0x40]
0069bb73 : PUSH EDX
0069bb74 : ADD EDI,0x34
0069bb77 : PUSH EDI
0069bb78 : LEA ESI,[EBP + 0x44]
0069bb7b : MOV EAX,EBX
0069bb7d : CALL 0x0069b100
0069bb82 : ADD ESP,0x8
0069bb85 : POP EBX
0069bb86 : POP EDI
0069bb87 : POP ESI
0069bb88 : POP EBP
0069bb89 : ADD ESP,0x20
0069bb8c : RET
0069bb8d : POP EDI
0069bb8e : POP ESI
0069bb8f : MOV EAX,ECX
0069bb91 : POP EBP
0069bb92 : ADD ESP,0x20
0069bb95 : RET

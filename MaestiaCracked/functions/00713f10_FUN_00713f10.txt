PROGRAM  : Maestia.exe
FUNCTION : FUN_00713f10
ENTRY    : 00713f10
BODY     : [[00713f10, 007140fb]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00713f10(void)

{
  int iVar1;
  long lVar2;
  void *_DstBuf;
  int in_ECX;
  undefined1 local_44 [4];
  undefined2 local_40;
  undefined4 local_30;
  uint local_2c;
  undefined **local_28;
  undefined1 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  FILE *local_18;
  char local_11;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3b81e;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  FUN_00713070(DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
  iVar1 = *(int *)(in_ECX + 4);
  if (((*(char *)(iVar1 + 0x5c) != '\0') &&
      (*(int *)(iVar1 + 0x80) + *(int *)(iVar1 + 0x78) == *(int *)(iVar1 + 0x88))) &&
     (iVar1 != -0x58)) {
    *(undefined4 *)(in_ECX + 0x58) = *(undefined4 *)(iVar1 + 0x74);
    *(undefined4 *)(in_ECX + 0x60) = *(undefined4 *)(iVar1 + 0x78);
    ExceptionList = local_10;
    return 1;
  }
  local_24 = 0;
  local_20 = 0;
  local_1c = 0;
  local_28 = &PTR_FUN_00cda538;
  local_18 = (FILE *)0x0;
  local_8 = 0;
  FUN_00406460(&PTR_LAB_00c00dc8);
  local_8._0_1_ = 1;
  local_11 = FUN_0070a9a0(in_ECX + 0x28,local_44);
  local_8 = (uint)local_8._1_3_ << 8;
  if (7 < local_2c) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_2c = 7;
  local_30 = 0;
  local_40 = 0;
  if (local_11 == '\0') {
    local_8 = 0xffffffff;
    local_28 = &PTR_FUN_00cda538;
    if (local_18 != (FILE *)0x0) {
      _fflush(local_18);
      _fclose(local_18);
    }
    ExceptionList = local_10;
    return 0;
  }
  if (local_18 != (FILE *)0x0) {
    __fseek_nolock(local_18,0,2);
    if (local_18 != (FILE *)0x0) {
      lVar2 = __ftell_nolock(local_18);
      goto LAB_00714014;
    }
  }
  lVar2 = -1;
LAB_00714014:
  *(long *)(in_ECX + 0x60) = lVar2;
  if (local_18 != (FILE *)0x0) {
    __fseek_nolock(local_18,0,0);
  }
  _DstBuf = (void *)FUN_0070a3a0();
  *(void **)(in_ECX + 0x58) = _DstBuf;
  if (local_18 != (FILE *)0x0) {
    __fread_nolock(_DstBuf,1,*(size_t *)(in_ECX + 0x60),local_18);
    if (local_18 != (FILE *)0x0) {
      _fflush(local_18);
      _fclose(local_18);
      local_18 = (FILE *)0x0;
    }
  }
  *(undefined1 *)(in_ECX + 0xd4) = 1;
  *(undefined8 *)(in_ECX + 0x47) = 0;
  *(undefined8 *)(in_ECX + 0x4f) = 0;
  local_8 = 0xffffffff;
  local_28 = &PTR_FUN_00cda538;
  if (local_18 != (FILE *)0x0) {
    _fflush(local_18);
    _fclose(local_18);
  }
  ExceptionList = local_10;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
00713f10 : PUSH EBP
00713f11 : MOV EBP,ESP
00713f13 : PUSH -0x1
00713f15 : PUSH 0xb3b81e
00713f1a : MOV EAX,FS:[0x0]
00713f20 : PUSH EAX
00713f21 : SUB ESP,0x38
00713f24 : PUSH EBX
00713f25 : PUSH ESI
00713f26 : MOV EAX,[0x00d66fa0]
00713f2b : XOR EAX,EBP
00713f2d : PUSH EAX
00713f2e : LEA EAX,[EBP + -0xc]
00713f31 : MOV FS:[0x0],EAX
00713f37 : MOV ESI,ECX
00713f39 : CALL 0x00713070
00713f3e : MOV EAX,dword ptr [ESI + 0x4]
00713f41 : MOV CL,byte ptr [EAX + 0x5c]
00713f44 : XOR EBX,EBX
00713f46 : CMP CL,BL
00713f48 : JZ 0x00713f7e
00713f4a : MOV ECX,dword ptr [EAX + 0x80]
00713f50 : ADD ECX,dword ptr [EAX + 0x78]
00713f53 : ADD EAX,0x58
00713f56 : CMP ECX,dword ptr [EAX + 0x30]
00713f59 : JNZ 0x00713f7e
00713f5b : CMP EAX,EBX
00713f5d : JZ 0x00713f7e
00713f5f : MOV EDX,dword ptr [EAX + 0x1c]
00713f62 : MOV dword ptr [ESI + 0x58],EDX
00713f65 : MOV EAX,dword ptr [EAX + 0x20]
00713f68 : MOV dword ptr [ESI + 0x60],EAX
00713f6b : MOV AL,0x1
00713f6d : MOV ECX,dword ptr [EBP + -0xc]
00713f70 : MOV dword ptr FS:[0x0],ECX
00713f77 : POP ECX
00713f78 : POP ESI
00713f79 : POP EBX
00713f7a : MOV ESP,EBP
00713f7c : POP EBP
00713f7d : RET
00713f7e : MOV dword ptr [EBP + -0x24],0xcd4c80
00713f85 : MOV byte ptr [EBP + -0x20],BL
00713f88 : MOV dword ptr [EBP + -0x1c],EBX
00713f8b : MOV dword ptr [EBP + -0x18],EBX
00713f8e : MOV dword ptr [EBP + -0x24],0xcda538
00713f95 : MOV dword ptr [EBP + -0x14],EBX
00713f98 : MOV dword ptr [EBP + -0x4],EBX
00713f9b : PUSH 0xc00dc8
00713fa0 : LEA ECX,[EBP + -0x40]
00713fa3 : CALL 0x00406460
00713fa8 : MOV byte ptr [EBP + -0x4],0x1
00713fac : LEA ECX,[EBP + -0x40]
00713faf : PUSH ECX
00713fb0 : LEA EDX,[ESI + 0x28]
00713fb3 : PUSH EDX
00713fb4 : LEA ECX,[EBP + -0x24]
00713fb7 : CALL 0x0070a9a0
00713fbc : MOV byte ptr [EBP + -0xd],AL
00713fbf : MOV byte ptr [EBP + -0x4],BL
00713fc2 : CMP dword ptr [EBP + -0x28],0x8
00713fc6 : JC 0x00713fd0
00713fc8 : MOV ECX,dword ptr [EBP + -0x3c]
00713fcb : CALL 0x006f04e0
00713fd0 : XOR EAX,EAX
00713fd2 : MOV dword ptr [EBP + -0x28],0x7
00713fd9 : MOV dword ptr [EBP + -0x2c],EBX
00713fdc : MOV word ptr [EBP + -0x3c],AX
00713fe0 : CMP byte ptr [EBP + -0xd],BL
00713fe3 : JZ 0x007140bc
00713fe9 : MOV ECX,dword ptr [EBP + -0x14]
00713fec : CMP ECX,EBX
00713fee : JZ 0x00714003
00713ff0 : PUSH 0x2
00713ff2 : PUSH EBX
00713ff3 : PUSH ECX
00713ff4 : CALL 0x00637771
00713ff9 : MOV ECX,dword ptr [EBP + -0x14]
00713ffc : ADD ESP,0xc
00713fff : CMP ECX,EBX
00714001 : JNZ 0x00714008
00714003 : OR EAX,0xffffffff
00714006 : JMP 0x00714014
00714008 : PUSH ECX
00714009 : CALL 0x00637382
0071400e : MOV ECX,dword ptr [EBP + -0x14]
00714011 : ADD ESP,0x4
00714014 : MOV dword ptr [ESI + 0x60],EAX
00714017 : CMP ECX,EBX
00714019 : JZ 0x00714026
0071401b : PUSH EBX
0071401c : PUSH EBX
0071401d : PUSH ECX
0071401e : CALL 0x00637771
00714023 : ADD ESP,0xc
00714026 : MOV ECX,dword ptr [ESI + 0x60]
00714029 : CALL 0x0070a3a0
0071402e : MOV EDX,dword ptr [EBP + -0x14]
00714031 : MOV ECX,dword ptr [ESI + 0x60]
00714034 : MOV dword ptr [ESI + 0x58],EAX
00714037 : CMP EDX,EBX
00714039 : JZ 0x00714067
0071403b : PUSH EDX
0071403c : PUSH ECX
0071403d : PUSH 0x1
0071403f : PUSH EAX
00714040 : CALL 0x00638ac8
00714045 : MOV EAX,dword ptr [EBP + -0x14]
00714048 : ADD ESP,0x10
0071404b : CMP EAX,EBX
0071404d : JZ 0x00714067
0071404f : PUSH EAX
00714050 : CALL 0x006395f7
00714055 : MOV ECX,dword ptr [EBP + -0x14]
00714058 : ADD ESP,0x4
0071405b : PUSH ECX
0071405c : CALL 0x006366db
00714061 : ADD ESP,0x4
00714064 : MOV dword ptr [EBP + -0x14],EBX
00714067 : MOV byte ptr [ESI + 0xd4],0x1
0071406e : PXOR XMM0,XMM0
00714072 : MOVQ qword ptr [ESI + 0x47],XMM0
00714077 : MOVQ qword ptr [ESI + 0x4f],XMM0
0071407c : MOV dword ptr [EBP + -0x4],0xffffffff
00714083 : MOV EAX,dword ptr [EBP + -0x14]
00714086 : MOV dword ptr [EBP + -0x24],0xcda538
0071408d : CMP EAX,EBX
0071408f : JZ 0x007140a9
00714091 : PUSH EAX
00714092 : CALL 0x006395f7
00714097 : MOV EDX,dword ptr [EBP + -0x14]
0071409a : ADD ESP,0x4
0071409d : PUSH EDX
0071409e : CALL 0x006366db
007140a3 : ADD ESP,0x4
007140a6 : MOV dword ptr [EBP + -0x14],EBX
007140a9 : MOV AL,0x1
007140ab : MOV ECX,dword ptr [EBP + -0xc]
007140ae : MOV dword ptr FS:[0x0],ECX
007140b5 : POP ECX
007140b6 : POP ESI
007140b7 : POP EBX
007140b8 : MOV ESP,EBP
007140ba : POP EBP
007140bb : RET
007140bc : MOV dword ptr [EBP + -0x4],0xffffffff
007140c3 : MOV EAX,dword ptr [EBP + -0x14]
007140c6 : MOV dword ptr [EBP + -0x24],0xcda538
007140cd : CMP EAX,EBX
007140cf : JZ 0x007140e9
007140d1 : PUSH EAX
007140d2 : CALL 0x006395f7
007140d7 : MOV EAX,dword ptr [EBP + -0x14]
007140da : ADD ESP,0x4
007140dd : PUSH EAX
007140de : CALL 0x006366db
007140e3 : ADD ESP,0x4
007140e6 : MOV dword ptr [EBP + -0x14],EBX
007140e9 : XOR AL,AL
007140eb : MOV ECX,dword ptr [EBP + -0xc]
007140ee : MOV dword ptr FS:[0x0],ECX
007140f5 : POP ECX
007140f6 : POP ESI
007140f7 : POP EBX
007140f8 : MOV ESP,EBP
007140fa : POP EBP
007140fb : RET

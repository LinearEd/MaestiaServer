PROGRAM  : Maestia.exe
FUNCTION : FUN_005abad0
ENTRY    : 005abad0
BODY     : [[005abad0, 005abc25]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005abad0(int param_1,int *param_2,uint param_3,int *param_4)

{
  uint uVar1;
  int *piVar2;
  int *piVar3;
  int *piVar4;
  int iVar5;
  undefined4 *in_ECX;
  
  uVar1 = in_ECX[1];
  if (param_3 < uVar1) {
    param_3 = uVar1;
  }
  if (param_4 < uVar1) {
    param_4 = (int *)uVar1;
  }
  param_3 = (param_3 - 1) + (int)param_4 & ~((int)param_4 - 1U);
  piVar4 = (int *)FUN_005ab7c0(param_2);
  param_4 = (int *)FUN_005ab730(param_3 + (int)param_2);
  if (((piVar4 == (int *)0x0) || (piVar4[8] != param_1)) ||
     ((int *)((piVar4[9] << ((byte)*in_ECX & 0x1f)) + (int)piVar4) != param_2)) {
    piVar4 = (int *)0x0;
  }
  if (((param_4 == (int *)0x0) || (param_4[8] != param_1)) ||
     (param_4 != (int *)(param_3 + (int)param_2))) {
    param_4 = (int *)0x0;
  }
  param_3 = param_3 >> ((byte)*in_ECX & 0x1f);
  param_2[8] = param_1;
  param_2[9] = param_3;
  if (piVar4 != (int *)0x0) {
    param_3 = param_3 + piVar4[9];
    in_ECX[5] = in_ECX[5] - piVar4[9];
    piVar2 = (int *)*piVar4;
    if (piVar2 == piVar4) {
      FUN_005ab630(piVar4);
    }
    else {
      piVar3 = (int *)piVar4[1];
      *piVar3 = (int)piVar2;
      piVar2[1] = (int)piVar3;
      FUN_005ab5d0(piVar4,piVar2);
    }
    FUN_005ab6e0(piVar4);
    param_2 = piVar4;
  }
  if (param_4 != (int *)0x0) {
    iVar5 = param_4[9];
    in_ECX[5] = in_ECX[5] - iVar5;
    param_3 = param_3 + iVar5;
    piVar4 = (int *)*param_4;
    if (piVar4 == param_4) {
      FUN_005ab630(param_4);
    }
    else {
      piVar2 = (int *)param_4[1];
      *piVar2 = (int)piVar4;
      piVar4[1] = (int)piVar2;
      FUN_005ab5d0(param_4,piVar4);
    }
    FUN_005ab6e0(param_4);
  }
  param_2[8] = param_1;
  param_2[9] = param_3;
  *param_2 = (int)param_2;
  param_2[1] = (int)param_2;
  iVar5 = FUN_005ab560(param_2);
  if (iVar5 != 0) {
    param_2[1] = *(int *)(iVar5 + 4);
    *param_2 = iVar5;
    *(int **)(iVar5 + 4) = param_2;
    *(int **)param_2[1] = param_2;
  }
  FUN_005ab500(param_2);
  in_ECX[5] = in_ECX[5] + param_3;
  return;
}



============================================================
DISASSEMBLY
============================================================
005abad0 : PUSH EBX
005abad1 : MOV EBX,dword ptr [ESP + 0x10]
005abad5 : PUSH EDI
005abad6 : MOV EDI,ECX
005abad8 : MOV ECX,dword ptr [EDI + 0x4]
005abadb : CMP EBX,ECX
005abadd : JNC 0x005abae1
005abadf : MOV EBX,ECX
005abae1 : MOV EAX,dword ptr [ESP + 0x18]
005abae5 : CMP EAX,ECX
005abae7 : JNC 0x005abaeb
005abae9 : MOV EAX,ECX
005abaeb : PUSH EBP
005abaec : MOV EBP,dword ptr [ESP + 0x14]
005abaf0 : LEA EBX,[EBX + EAX*0x1 + -0x1]
005abaf4 : DEC EAX
005abaf5 : PUSH ESI
005abaf6 : NOT EAX
005abaf8 : LEA ECX,[EDI + 0x10]
005abafb : PUSH EBP
005abafc : AND EBX,EAX
005abafe : CALL 0x005ab7c0
005abb03 : MOV ESI,EAX
005abb05 : LEA EAX,[EBX + EBP*0x1]
005abb08 : PUSH EAX
005abb09 : LEA ECX,[EDI + 0x10]
005abb0c : CALL 0x005ab730
005abb11 : MOV dword ptr [ESP + 0x20],EAX
005abb15 : TEST ESI,ESI
005abb17 : JZ 0x005abb2f
005abb19 : MOV ECX,dword ptr [ESI + 0x20]
005abb1c : CMP ECX,dword ptr [ESP + 0x14]
005abb20 : JNZ 0x005abb2f
005abb22 : MOV EDX,dword ptr [ESI + 0x24]
005abb25 : MOV ECX,dword ptr [EDI]
005abb27 : SHL EDX,CL
005abb29 : ADD EDX,ESI
005abb2b : CMP EDX,EBP
005abb2d : JZ 0x005abb31
005abb2f : XOR ESI,ESI
005abb31 : TEST EAX,EAX
005abb33 : JZ 0x005abb45
005abb35 : MOV ECX,dword ptr [EAX + 0x20]
005abb38 : CMP ECX,dword ptr [ESP + 0x14]
005abb3c : JNZ 0x005abb45
005abb3e : LEA ECX,[EBX + EBP*0x1]
005abb41 : CMP EAX,ECX
005abb43 : JZ 0x005abb51
005abb45 : MOV dword ptr [ESP + 0x20],0x0
005abb4d : MOV EAX,dword ptr [ESP + 0x20]
005abb51 : MOV ECX,dword ptr [EDI]
005abb53 : MOV EDX,dword ptr [ESP + 0x14]
005abb57 : SHR EBX,CL
005abb59 : MOV dword ptr [EBP + 0x20],EDX
005abb5c : MOV ECX,EBX
005abb5e : MOV dword ptr [EBP + 0x24],EBX
005abb61 : MOV dword ptr [ESP + 0x1c],ECX
005abb65 : MOV EBX,EBP
005abb67 : TEST ESI,ESI
005abb69 : JZ 0x005abba4
005abb6b : MOV EAX,dword ptr [ESI + 0x24]
005abb6e : ADD dword ptr [ESP + 0x1c],EAX
005abb72 : SUB dword ptr [EDI + 0x14],EAX
005abb75 : MOV EAX,dword ptr [ESI]
005abb77 : MOV EBX,ESI
005abb79 : LEA ECX,[EDI + 0xc]
005abb7c : CMP EAX,ESI
005abb7e : JZ 0x005abb91
005abb80 : MOV EDX,dword ptr [ESI + 0x4]
005abb83 : PUSH EAX
005abb84 : MOV dword ptr [EDX],EAX
005abb86 : PUSH ESI
005abb87 : MOV dword ptr [EAX + 0x4],EDX
005abb8a : CALL 0x005ab5d0
005abb8f : JMP 0x005abb97
005abb91 : PUSH ESI
005abb92 : CALL 0x005ab630
005abb97 : PUSH ESI
005abb98 : LEA ECX,[EDI + 0x10]
005abb9b : CALL 0x005ab6e0
005abba0 : MOV EAX,dword ptr [ESP + 0x20]
005abba4 : TEST EAX,EAX
005abba6 : JZ 0x005abbdf
005abba8 : MOV ECX,dword ptr [EAX + 0x24]
005abbab : SUB dword ptr [EDI + 0x14],ECX
005abbae : ADD dword ptr [ESP + 0x1c],ECX
005abbb2 : MOV EDX,dword ptr [EAX]
005abbb4 : LEA ECX,[EDI + 0xc]
005abbb7 : CMP EDX,EAX
005abbb9 : JZ 0x005abbcc
005abbbb : MOV ESI,dword ptr [EAX + 0x4]
005abbbe : PUSH EDX
005abbbf : MOV dword ptr [ESI],EDX
005abbc1 : PUSH EAX
005abbc2 : MOV dword ptr [EDX + 0x4],ESI
005abbc5 : CALL 0x005ab5d0
005abbca : JMP 0x005abbd2
005abbcc : PUSH EAX
005abbcd : CALL 0x005ab630
005abbd2 : MOV EDX,dword ptr [ESP + 0x20]
005abbd6 : PUSH EDX
005abbd7 : LEA ECX,[EDI + 0x10]
005abbda : CALL 0x005ab6e0
005abbdf : MOV ECX,dword ptr [ESP + 0x14]
005abbe3 : MOV EAX,dword ptr [ESP + 0x1c]
005abbe7 : MOV dword ptr [EBX + 0x20],ECX
005abbea : PUSH EBX
005abbeb : LEA ECX,[EDI + 0xc]
005abbee : MOV dword ptr [EBX + 0x24],EAX
005abbf1 : MOV dword ptr [EBX],EBX
005abbf3 : MOV dword ptr [EBX + 0x4],EBX
005abbf6 : CALL 0x005ab560
005abbfb : POP ESI
005abbfc : POP EBP
005abbfd : TEST EAX,EAX
005abbff : JZ 0x005abc11
005abc01 : MOV EDX,dword ptr [EAX + 0x4]
005abc04 : MOV dword ptr [EBX + 0x4],EDX
005abc07 : MOV dword ptr [EBX],EAX
005abc09 : MOV dword ptr [EAX + 0x4],EBX
005abc0c : MOV EAX,dword ptr [EBX + 0x4]
005abc0f : MOV dword ptr [EAX],EBX
005abc11 : PUSH EBX
005abc12 : LEA ECX,[EDI + 0x10]
005abc15 : CALL 0x005ab500
005abc1a : MOV ECX,dword ptr [ESP + 0x14]
005abc1e : ADD dword ptr [EDI + 0x14],ECX
005abc21 : POP EDI
005abc22 : POP EBX
005abc23 : RET 0x10

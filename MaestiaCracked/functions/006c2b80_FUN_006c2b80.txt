PROGRAM  : Maestia.exe
FUNCTION : FUN_006c2b80
ENTRY    : 006c2b80
BODY     : [[006c2b80, 006c2e74]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006c2b80(char *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
                 undefined4 param_5,undefined4 param_6,undefined4 param_7)

{
  char *pcVar1;
  int iVar2;
  undefined4 uVar3;
  char local_64 [84];
  uint local_10;
  int local_c;
  int local_8;
  
  local_10 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_c = FUN_006cecd0(1,param_6,param_5);
  if (local_c != 0) {
    *(undefined4 *)(local_c + 0x260) = 1000000;
    *(undefined4 *)(local_c + 0x264) = 1000000;
    iVar2 = __setjmp3(local_c,0);
    if (iVar2 == 0) {
      FUN_006cf020(local_c,param_5,param_6,param_7);
      FUN_006c2920(local_c,param_2,param_3,param_4);
      local_8 = 0;
      do {
        if (param_1[local_8] != (&DAT_00bed878)[local_8]) {
          *(uint *)(local_c + 0x6c) = *(uint *)(local_c + 0x6c) | 0x20000;
        }
        pcVar1 = &DAT_00bed878 + local_8;
        local_8 = local_8 + 1;
      } while (*pcVar1 != '\0');
      if (((*(uint *)(local_c + 0x6c) & 0x20000) != 0) &&
         ((((param_1 == (char *)0x0 || (*param_1 != '1')) ||
           ((*param_1 == '1' && (param_1[2] != '2')))) || ((*param_1 == '0' && (param_1[2] < '9'))))
         )) {
        if (param_1 != (char *)0x0) {
          _sprintf(local_64,"Application was compiled with png.h from libpng-%.20s",param_1);
          FUN_006c24c0(local_c,local_64);
        }
        _sprintf(local_64,"Application  is  running with png.c from libpng-%.20s",&DAT_00bed878);
        FUN_006c24c0(local_c,local_64);
        *(undefined4 *)(local_c + 0x6c) = 0;
        FUN_006c23a0(local_c,"Incompatible libpng version in application and library");
      }
      *(undefined4 *)(local_c + 0xb0) = 0x2000;
      uVar3 = FUN_006cee20(local_c,*(undefined4 *)(local_c + 0xb0));
      *(undefined4 *)(local_c + 0xac) = uVar3;
      *(code **)(local_c + 0x94) = FUN_006cc9b0;
      *(code **)(local_c + 0x98) = FUN_006cca30;
      *(int *)(local_c + 0x9c) = local_c;
      uVar3 = FUN_00711480(local_c + 0x74,"1.2.3",0x38);
      switch(uVar3) {
      case 0:
        break;
      case 0xfffffffa:
        FUN_006c23a0(local_c,"zlib version error");
        break;
      default:
        FUN_006c23a0(local_c,"Unknown zlib error");
        break;
      case 0xfffffffc:
      case 0xfffffffe:
        FUN_006c23a0(local_c,"zlib memory error");
      }
      *(undefined4 *)(local_c + 0x80) = *(undefined4 *)(local_c + 0xac);
      *(undefined4 *)(local_c + 0x84) = *(undefined4 *)(local_c + 0xb0);
      FUN_006cd360(local_c,0,0);
      iVar2 = __setjmp3(local_c,0);
      if (iVar2 != 0) {
                    /* WARNING: Subroutine does not return */
        _abort();
      }
    }
    else {
      FUN_006ceee0(local_c,*(undefined4 *)(local_c + 0xac));
      *(undefined4 *)(local_c + 0xac) = 0;
      FUN_006cedb0(local_c,param_7,param_5);
    }
  }
  __security_check_cookie(local_10 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
006c2b80 : PUSH EBP
006c2b81 : MOV EBP,ESP
006c2b83 : SUB ESP,0x64
006c2b86 : MOV EAX,[0x00d66fa0]
006c2b8b : XOR EAX,EBP
006c2b8d : MOV dword ptr [EBP + -0xc],EAX
006c2b90 : MOV EAX,dword ptr [EBP + 0x18]
006c2b93 : PUSH EAX
006c2b94 : MOV ECX,dword ptr [EBP + 0x1c]
006c2b97 : PUSH ECX
006c2b98 : PUSH 0x1
006c2b9a : CALL 0x006cecd0
006c2b9f : ADD ESP,0xc
006c2ba2 : MOV dword ptr [EBP + -0x8],EAX
006c2ba5 : CMP dword ptr [EBP + -0x8],0x0
006c2ba9 : JNZ 0x006c2bb2
006c2bab : XOR EAX,EAX
006c2bad : JMP 0x006c2e67
006c2bb2 : MOV EDX,dword ptr [EBP + -0x8]
006c2bb5 : MOV dword ptr [EDX + 0x260],0xf4240
006c2bbf : MOV EAX,dword ptr [EBP + -0x8]
006c2bc2 : MOV dword ptr [EAX + 0x264],0xf4240
006c2bcc : MOV ECX,dword ptr [EBP + -0x8]
006c2bcf : PUSH 0x0
006c2bd1 : PUSH ECX
006c2bd2 : CALL 0x006d4930
006c2bd7 : ADD ESP,0x8
006c2bda : TEST EAX,EAX
006c2bdc : JZ 0x006c2c1c
006c2bde : MOV EDX,dword ptr [EBP + -0x8]
006c2be1 : MOV EAX,dword ptr [EDX + 0xac]
006c2be7 : PUSH EAX
006c2be8 : MOV ECX,dword ptr [EBP + -0x8]
006c2beb : PUSH ECX
006c2bec : CALL 0x006ceee0
006c2bf1 : ADD ESP,0x8
006c2bf4 : MOV EDX,dword ptr [EBP + -0x8]
006c2bf7 : MOV dword ptr [EDX + 0xac],0x0
006c2c01 : MOV EAX,dword ptr [EBP + 0x18]
006c2c04 : PUSH EAX
006c2c05 : MOV ECX,dword ptr [EBP + 0x20]
006c2c08 : PUSH ECX
006c2c09 : MOV EDX,dword ptr [EBP + -0x8]
006c2c0c : PUSH EDX
006c2c0d : CALL 0x006cedb0
006c2c12 : ADD ESP,0xc
006c2c15 : XOR EAX,EAX
006c2c17 : JMP 0x006c2e67
006c2c1c : MOV EAX,dword ptr [EBP + 0x20]
006c2c1f : PUSH EAX
006c2c20 : MOV ECX,dword ptr [EBP + 0x1c]
006c2c23 : PUSH ECX
006c2c24 : MOV EDX,dword ptr [EBP + 0x18]
006c2c27 : PUSH EDX
006c2c28 : MOV EAX,dword ptr [EBP + -0x8]
006c2c2b : PUSH EAX
006c2c2c : CALL 0x006cf020
006c2c31 : ADD ESP,0x10
006c2c34 : MOV ECX,dword ptr [EBP + 0x14]
006c2c37 : PUSH ECX
006c2c38 : MOV EDX,dword ptr [EBP + 0x10]
006c2c3b : PUSH EDX
006c2c3c : MOV EAX,dword ptr [EBP + 0xc]
006c2c3f : PUSH EAX
006c2c40 : MOV ECX,dword ptr [EBP + -0x8]
006c2c43 : PUSH ECX
006c2c44 : CALL 0x006c2920
006c2c49 : ADD ESP,0x10
006c2c4c : MOV dword ptr [EBP + -0x4],0x0
006c2c53 : MOV EDX,dword ptr [EBP + 0x8]
006c2c56 : ADD EDX,dword ptr [EBP + -0x4]
006c2c59 : MOVSX EAX,byte ptr [EDX]
006c2c5c : MOV ECX,dword ptr [EBP + -0x4]
006c2c5f : MOVSX EDX,byte ptr [ECX + 0xbed878]
006c2c66 : CMP EAX,EDX
006c2c68 : JZ 0x006c2c7c
006c2c6a : MOV EAX,dword ptr [EBP + -0x8]
006c2c6d : MOV ECX,dword ptr [EAX + 0x6c]
006c2c70 : OR ECX,0x20000
006c2c76 : MOV EDX,dword ptr [EBP + -0x8]
006c2c79 : MOV dword ptr [EDX + 0x6c],ECX
006c2c7c : MOV EAX,dword ptr [EBP + -0x4]
006c2c7f : MOVSX ECX,byte ptr [EAX + 0xbed878]
006c2c86 : MOV EDX,dword ptr [EBP + -0x4]
006c2c89 : ADD EDX,0x1
006c2c8c : MOV dword ptr [EBP + -0x4],EDX
006c2c8f : TEST ECX,ECX
006c2c91 : JNZ 0x006c2c53
006c2c93 : MOV EAX,dword ptr [EBP + -0x8]
006c2c96 : MOV ECX,dword ptr [EAX + 0x6c]
006c2c99 : AND ECX,0x20000
006c2c9f : JZ 0x006c2d5c
006c2ca5 : CMP dword ptr [EBP + 0x8],0x0
006c2ca9 : JZ 0x006c2cf0
006c2cab : MOV EDX,dword ptr [EBP + 0x8]
006c2cae : MOVSX EAX,byte ptr [EDX]
006c2cb1 : MOVSX ECX,byte ptr [0x00bed878]
006c2cb8 : CMP EAX,ECX
006c2cba : JNZ 0x006c2cf0
006c2cbc : MOV EDX,dword ptr [EBP + 0x8]
006c2cbf : MOVSX EAX,byte ptr [EDX]
006c2cc2 : CMP EAX,0x31
006c2cc5 : JNZ 0x006c2cd9
006c2cc7 : MOV ECX,dword ptr [EBP + 0x8]
006c2cca : MOVSX EDX,byte ptr [ECX + 0x2]
006c2cce : MOVSX EAX,byte ptr [0x00bed87a]
006c2cd5 : CMP EDX,EAX
006c2cd7 : JNZ 0x006c2cf0
006c2cd9 : MOV ECX,dword ptr [EBP + 0x8]
006c2cdc : MOVSX EDX,byte ptr [ECX]
006c2cdf : CMP EDX,0x30
006c2ce2 : JNZ 0x006c2d5c
006c2ce4 : MOV EAX,dword ptr [EBP + 0x8]
006c2ce7 : MOVSX ECX,byte ptr [EAX + 0x2]
006c2ceb : CMP ECX,0x39
006c2cee : JGE 0x006c2d5c
006c2cf0 : CMP dword ptr [EBP + 0x8],0x0
006c2cf4 : JZ 0x006c2d1b
006c2cf6 : MOV EDX,dword ptr [EBP + 0x8]
006c2cf9 : PUSH EDX
006c2cfa : PUSH 0xbed650
006c2cff : LEA EAX,[EBP + -0x60]
006c2d02 : PUSH EAX
006c2d03 : CALL 0x00637ddb
006c2d08 : ADD ESP,0xc
006c2d0b : LEA ECX,[EBP + -0x60]
006c2d0e : PUSH ECX
006c2d0f : MOV EDX,dword ptr [EBP + -0x8]
006c2d12 : PUSH EDX
006c2d13 : CALL 0x006c24c0
006c2d18 : ADD ESP,0x8
006c2d1b : PUSH 0xbed878
006c2d20 : PUSH 0xbed618
006c2d25 : LEA EAX,[EBP + -0x60]
006c2d28 : PUSH EAX
006c2d29 : CALL 0x00637ddb
006c2d2e : ADD ESP,0xc
006c2d31 : LEA ECX,[EBP + -0x60]
006c2d34 : PUSH ECX
006c2d35 : MOV EDX,dword ptr [EBP + -0x8]
006c2d38 : PUSH EDX
006c2d39 : CALL 0x006c24c0
006c2d3e : ADD ESP,0x8
006c2d41 : MOV EAX,dword ptr [EBP + -0x8]
006c2d44 : MOV dword ptr [EAX + 0x6c],0x0
006c2d4b : PUSH 0xbed5e0
006c2d50 : MOV ECX,dword ptr [EBP + -0x8]
006c2d53 : PUSH ECX
006c2d54 : CALL 0x006c23a0
006c2d59 : ADD ESP,0x8
006c2d5c : MOV EDX,dword ptr [EBP + -0x8]
006c2d5f : MOV dword ptr [EDX + 0xb0],0x2000
006c2d69 : MOV EAX,dword ptr [EBP + -0x8]
006c2d6c : MOV ECX,dword ptr [EAX + 0xb0]
006c2d72 : PUSH ECX
006c2d73 : MOV EDX,dword ptr [EBP + -0x8]
006c2d76 : PUSH EDX
006c2d77 : CALL 0x006cee20
006c2d7c : ADD ESP,0x8
006c2d7f : MOV ECX,dword ptr [EBP + -0x8]
006c2d82 : MOV dword ptr [ECX + 0xac],EAX
006c2d88 : MOV EDX,dword ptr [EBP + -0x8]
006c2d8b : MOV dword ptr [EDX + 0x94],0x6cc9b0
006c2d95 : MOV EAX,dword ptr [EBP + -0x8]
006c2d98 : MOV dword ptr [EAX + 0x98],0x6cca30
006c2da2 : MOV ECX,dword ptr [EBP + -0x8]
006c2da5 : MOV EDX,dword ptr [EBP + -0x8]
006c2da8 : MOV dword ptr [ECX + 0x9c],EDX
006c2dae : PUSH 0x38
006c2db0 : PUSH 0xbd63fc
006c2db5 : MOV EAX,dword ptr [EBP + -0x8]
006c2db8 : ADD EAX,0x74
006c2dbb : PUSH EAX
006c2dbc : CALL 0x00711480
006c2dc1 : ADD ESP,0xc
006c2dc4 : MOV dword ptr [EBP + -0x64],EAX
006c2dc7 : MOV ECX,dword ptr [EBP + -0x64]
006c2dca : ADD ECX,0x6
006c2dcd : MOV dword ptr [EBP + -0x64],ECX
006c2dd0 : CMP dword ptr [EBP + -0x64],0x6
006c2dd4 : JA 0x006c2e08
006c2dd6 : MOV EDX,dword ptr [EBP + -0x64]
006c2dd9 : JMP dword ptr [EDX*0x4 + 0x6c2e78]
006c2de0 : JMP 0x006c2e19
006c2de2 : PUSH 0xbed5cc
006c2de7 : MOV EAX,dword ptr [EBP + -0x8]
006c2dea : PUSH EAX
006c2deb : CALL 0x006c23a0
006c2df0 : ADD ESP,0x8
006c2df3 : JMP 0x006c2e19
006c2df5 : PUSH 0xbed5b8
006c2dfa : MOV ECX,dword ptr [EBP + -0x8]
006c2dfd : PUSH ECX
006c2dfe : CALL 0x006c23a0
006c2e03 : ADD ESP,0x8
006c2e06 : JMP 0x006c2e19
006c2e08 : PUSH 0xbed5a4
006c2e0d : MOV EDX,dword ptr [EBP + -0x8]
006c2e10 : PUSH EDX
006c2e11 : CALL 0x006c23a0
006c2e16 : ADD ESP,0x8
006c2e19 : MOV EAX,dword ptr [EBP + -0x8]
006c2e1c : MOV ECX,dword ptr [EBP + -0x8]
006c2e1f : MOV EDX,dword ptr [ECX + 0xac]
006c2e25 : MOV dword ptr [EAX + 0x80],EDX
006c2e2b : MOV EAX,dword ptr [EBP + -0x8]
006c2e2e : MOV ECX,dword ptr [EBP + -0x8]
006c2e31 : MOV EDX,dword ptr [ECX + 0xb0]
006c2e37 : MOV dword ptr [EAX + 0x84],EDX
006c2e3d : PUSH 0x0
006c2e3f : PUSH 0x0
006c2e41 : MOV EAX,dword ptr [EBP + -0x8]
006c2e44 : PUSH EAX
006c2e45 : CALL 0x006cd360
006c2e4a : ADD ESP,0xc
006c2e4d : MOV ECX,dword ptr [EBP + -0x8]
006c2e50 : PUSH 0x0
006c2e52 : PUSH ECX
006c2e53 : CALL 0x006d4930
006c2e58 : ADD ESP,0x8
006c2e5b : TEST EAX,EAX
006c2e5d : JZ 0x006c2e64
006c2e5f : CALL 0x0063e6fa
006c2e64 : MOV EAX,dword ptr [EBP + -0x8]
006c2e67 : MOV ECX,dword ptr [EBP + -0xc]
006c2e6a : XOR ECX,EBP
006c2e6c : CALL 0x00633e6b
006c2e71 : MOV ESP,EBP
006c2e73 : POP EBP
006c2e74 : RET

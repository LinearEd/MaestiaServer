PROGRAM  : Maestia.exe
FUNCTION : FUN_004090e0
ENTRY    : 004090e0
BODY     : [[004090e0, 00409239] [00409240, 0040926f] [004092b7, 0040934f] [0040936d, 004093e4]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_004090e0(int param_1,int param_2,uint param_3)

{
  uint *puVar1;
  int iVar2;
  uint uVar3;
  undefined4 uVar4;
  uint extraout_ECX;
  int iVar5;
  uint uStack_68;
  undefined1 local_54 [48];
  int local_24;
  undefined4 local_20;
  uint local_1c;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7fbc4;
  local_10 = ExceptionList;
  uStack_68 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&uStack_68;
  ExceptionList = &local_10;
  iVar2 = *(int *)(param_1 + 4);
  if (iVar2 == 0) {
    local_1c = 0;
  }
  else {
    local_1c = (*(int *)(param_1 + 0xc) - iVar2) / 0x30;
  }
  iVar5 = *(int *)(param_1 + 8);
  iVar2 = (iVar5 - iVar2) / 0x30;
  puVar1 = &uStack_68;
  if (iVar2 == 0x5555555) {
    iVar2 = FUN_00429be0();
    local_1c = extraout_ECX;
    puVar1 = (uint *)local_14;
  }
  local_14 = (undefined1 *)puVar1;
  uVar3 = iVar2 + 1;
  if (local_1c < uVar3) {
    if (0x5555555 - (local_1c >> 1) < local_1c) {
      local_1c = 0;
    }
    else {
      local_1c = local_1c + (local_1c >> 1);
    }
    if (local_1c < uVar3) {
      local_1c = uVar3;
    }
    iVar2 = FUN_00488430();
    local_24 = (param_2 - *(int *)(param_1 + 4)) / 0x30;
    local_20 = 0;
    local_8 = 0;
    FUN_00408160();
    local_20 = 1;
    FUN_0040c220(*(undefined4 *)(param_1 + 4),param_2);
    local_20 = 2;
    FUN_0040c220(param_2,*(undefined4 *)(param_1 + 8));
    local_8 = 0xffffffff;
    if (*(int *)(param_1 + 4) != 0) {
      FUN_004090c0();
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    *(uint *)(param_1 + 0xc) = local_1c * 0x30 + iVar2;
    *(int *)(param_1 + 8) =
         ((*(int *)(param_1 + 8) - *(int *)(param_1 + 4)) / 0x30 + 1) * 0x30 + iVar2;
    *(int *)(param_1 + 4) = iVar2;
    ExceptionList = local_10;
    return;
  }
  iVar5 = iVar5 - param_2;
  iVar2 = iVar5 >> 0x1f;
  if (iVar5 / 0x30 + iVar2 == iVar2) {
    FUN_0040a390(local_54,param_3);
    local_8 = 2;
    FUN_0040c220(param_2,*(undefined4 *)(param_1 + 8));
    local_8 = CONCAT31(local_8._1_3_,3);
    FUN_00408160();
    local_8 = 2;
    *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 0x30;
    FUN_0040c9a0(*(int *)(param_1 + 8) + -0x30);
  }
  else {
    FUN_0040a390(local_54,param_3);
    local_8 = 5;
    uVar4 = FUN_0040c220(*(int *)(param_1 + 8) + -0x30,*(int *)(param_1 + 8));
    *(undefined4 *)(param_1 + 8) = uVar4;
    param_3 = param_3 & 0xffffff00;
    FUN_0040d060(param_2,param_2,param_2,param_3);
    FUN_0040c9a0(param_2 + 0x30);
  }
  local_8 = 0xffffffff;
  FUN_00406c60(local_54);
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
004090e0 : PUSH EBP
004090e1 : MOV EBP,ESP
004090e3 : PUSH -0x1
004090e5 : PUSH 0xb7fbc4
004090ea : MOV EAX,FS:[0x0]
004090f0 : PUSH EAX
004090f1 : SUB ESP,0x48
004090f4 : PUSH EBX
004090f5 : PUSH ESI
004090f6 : PUSH EDI
004090f7 : MOV EAX,[0x00d66fa0]
004090fc : XOR EAX,EBP
004090fe : PUSH EAX
004090ff : LEA EAX,[EBP + -0xc]
00409102 : MOV FS:[0x0],EAX
00409108 : MOV dword ptr [EBP + -0x10],ESP
0040910b : MOV EBX,dword ptr [EBP + 0x8]
0040910e : MOV ESI,dword ptr [EBX + 0x4]
00409111 : TEST ESI,ESI
00409113 : JNZ 0x00409119
00409115 : XOR ECX,ECX
00409117 : JMP 0x00409131
00409119 : MOV ECX,dword ptr [EBX + 0xc]
0040911c : SUB ECX,ESI
0040911e : MOV EAX,0x2aaaaaab
00409123 : IMUL ECX
00409125 : SAR EDX,0x3
00409128 : MOV EAX,EDX
0040912a : SHR EAX,0x1f
0040912d : ADD EAX,EDX
0040912f : MOV ECX,EAX
00409131 : MOV EDI,dword ptr [EBX + 0x8]
00409134 : MOV EDX,EDI
00409136 : SUB EDX,ESI
00409138 : MOV EAX,0x2aaaaaab
0040913d : IMUL EDX
0040913f : SAR EDX,0x3
00409142 : MOV EAX,EDX
00409144 : SHR EAX,0x1f
00409147 : ADD EAX,EDX
00409149 : MOV EDX,0x5555555
0040914e : SUB EDX,EAX
00409150 : CMP EDX,0x1
00409153 : JNC 0x0040915a
00409155 : CALL 0x00429be0
0040915a : INC EAX
0040915b : CMP ECX,EAX
0040915d : JNC 0x004092b7
00409163 : MOV EDX,ECX
00409165 : SHR EDX,0x1
00409167 : MOV ESI,0x5555555
0040916c : SUB ESI,EDX
0040916e : CMP ESI,ECX
00409170 : JNC 0x0040917b
00409172 : XOR EDI,EDI
00409174 : MOV dword ptr [EBP + -0x18],EDI
00409177 : MOV ECX,EDI
00409179 : JMP 0x00409182
0040917b : ADD ECX,EDX
0040917d : MOV dword ptr [EBP + -0x18],ECX
00409180 : XOR EDI,EDI
00409182 : CMP ECX,EAX
00409184 : JNC 0x0040918b
00409186 : MOV dword ptr [EBP + -0x18],EAX
00409189 : MOV ECX,EAX
0040918b : CALL 0x00488430
00409190 : MOV ESI,EAX
00409192 : MOV dword ptr [EBP + 0x8],ESI
00409195 : MOV ECX,dword ptr [EBP + 0xc]
00409198 : SUB ECX,dword ptr [EBX + 0x4]
0040919b : MOV EAX,0x2aaaaaab
004091a0 : IMUL ECX
004091a2 : SAR EDX,0x3
004091a5 : MOV EAX,EDX
004091a7 : SHR EAX,0x1f
004091aa : ADD EAX,EDX
004091ac : MOV dword ptr [EBP + -0x20],EAX
004091af : MOV dword ptr [EBP + -0x1c],EDI
004091b2 : MOV dword ptr [EBP + -0x4],EDI
004091b5 : LEA EDI,[EAX + EAX*0x2]
004091b8 : SHL EDI,0x4
004091bb : ADD EDI,ESI
004091bd : MOV EDX,dword ptr [EBP + 0x10]
004091c0 : MOV ESI,0x1
004091c5 : CALL 0x00408160
004091ca : MOV dword ptr [EBP + -0x1c],ESI
004091cd : MOV EAX,dword ptr [EBP + 0xc]
004091d0 : PUSH EAX
004091d1 : MOV ECX,dword ptr [EBX + 0x4]
004091d4 : PUSH ECX
004091d5 : MOV EDI,dword ptr [EBP + 0x8]
004091d8 : MOV EDX,EDI
004091da : CALL 0x0040c220
004091df : MOV dword ptr [EBP + -0x1c],0x2
004091e6 : MOV EAX,dword ptr [EBP + -0x20]
004091e9 : LEA EDX,[EAX + EAX*0x2 + 0x3]
004091ed : SHL EDX,0x4
004091f0 : ADD EDX,EDI
004091f2 : MOV EAX,dword ptr [EBX + 0x8]
004091f5 : PUSH EAX
004091f6 : MOV ECX,dword ptr [EBP + 0xc]
004091f9 : PUSH ECX
004091fa : CALL 0x0040c220
004091ff : MOV dword ptr [EBP + -0x4],0xffffffff
00409206 : MOV ECX,dword ptr [EBX + 0x8]
00409209 : MOV ESI,dword ptr [EBX + 0x4]
0040920c : SUB ECX,ESI
0040920e : MOV EAX,0x2aaaaaab
00409213 : IMUL ECX
00409215 : SAR EDX,0x3
00409218 : MOV EAX,EDX
0040921a : SHR EAX,0x1f
0040921d : LEA EDX,[EDX + EAX*0x1 + 0x1]
00409221 : MOV dword ptr [EBP + 0x10],EDX
00409224 : TEST ESI,ESI
00409226 : JZ 0x00409240
00409228 : MOV EDI,dword ptr [EBX + 0x8]
0040922b : MOV EAX,ESI
0040922d : CALL 0x004090c0
00409232 : MOV ECX,dword ptr [EBX + 0x4]
00409235 : CALL 0x006f04e0
00409240 : MOV EAX,dword ptr [EBP + -0x18]
00409243 : LEA ECX,[EAX + EAX*0x2]
00409246 : SHL ECX,0x4
00409249 : ADD ECX,EDI
0040924b : MOV dword ptr [EBX + 0xc],ECX
0040924e : LEA EDX,[EDX + EDX*0x2]
00409251 : SHL EDX,0x4
00409254 : ADD EDX,EDI
00409256 : MOV dword ptr [EBX + 0x8],EDX
00409259 : MOV dword ptr [EBX + 0x4],EDI
0040925c : MOV ECX,dword ptr [EBP + -0xc]
0040925f : MOV dword ptr FS:[0x0],ECX
00409266 : POP ECX
00409267 : POP EDI
00409268 : POP ESI
00409269 : POP EBX
0040926a : MOV ESP,EBP
0040926c : POP EBP
0040926d : RET 0xc
004092b7 : SUB EDI,dword ptr [EBP + 0xc]
004092ba : MOV EAX,0x2aaaaaab
004092bf : IMUL EDI
004092c1 : SAR EDX,0x3
004092c4 : MOV EAX,EDX
004092c6 : SHR EAX,0x1f
004092c9 : ADD EAX,EDX
004092cb : CMP EAX,0x1
004092ce : JNC 0x0040936d
004092d4 : MOV ECX,dword ptr [EBP + 0x10]
004092d7 : PUSH ECX
004092d8 : LEA EDX,[EBP + -0x50]
004092db : PUSH EDX
004092dc : CALL 0x0040a390
004092e1 : MOV dword ptr [EBP + -0x4],0x2
004092e8 : MOV EAX,dword ptr [EBP + 0xc]
004092eb : LEA EDX,[EAX + 0x30]
004092ee : MOV ECX,dword ptr [EBX + 0x8]
004092f1 : PUSH ECX
004092f2 : PUSH EAX
004092f3 : CALL 0x0040c220
004092f8 : MOV byte ptr [EBP + -0x4],0x3
004092fc : MOV EDI,dword ptr [EBX + 0x8]
004092ff : MOV ECX,EDI
00409301 : SUB ECX,dword ptr [EBP + 0xc]
00409304 : MOV EAX,0x2aaaaaab
00409309 : IMUL ECX
0040930b : SAR EDX,0x3
0040930e : MOV EAX,EDX
00409310 : SHR EAX,0x1f
00409313 : ADD EAX,EDX
00409315 : MOV ESI,0x1
0040931a : SUB ESI,EAX
0040931c : LEA EDX,[EBP + -0x50]
0040931f : CALL 0x00408160
00409324 : MOV dword ptr [EBP + -0x4],0x2
0040932b : ADD dword ptr [EBX + 0x8],0x30
0040932f : MOV EBX,dword ptr [EBX + 0x8]
00409332 : LEA EAX,[EBX + -0x30]
00409335 : PUSH EAX
00409336 : LEA EDI,[EBP + -0x50]
00409339 : MOV EAX,dword ptr [EBP + 0xc]
0040933c : CALL 0x0040c9a0
00409341 : ADD ESP,0x4
00409344 : MOV dword ptr [EBP + -0x4],0xffffffff
0040934b : MOV ECX,EDI
0040934d : PUSH ECX
0040934e : JMP 0x004093cc
0040936d : MOV EAX,dword ptr [EBP + 0x10]
00409370 : PUSH EAX
00409371 : LEA ECX,[EBP + -0x50]
00409374 : PUSH ECX
00409375 : CALL 0x0040a390
0040937a : MOV dword ptr [EBP + -0x4],0x5
00409381 : MOV ESI,dword ptr [EBX + 0x8]
00409384 : LEA EDI,[ESI + -0x30]
00409387 : PUSH ESI
00409388 : PUSH EDI
00409389 : MOV EDX,ESI
0040938b : CALL 0x0040c220
00409390 : MOV dword ptr [EBX + 0x8],EAX
00409393 : MOV byte ptr [EBP + 0x10],0x0
00409397 : MOV EDX,dword ptr [EBP + 0x10]
0040939a : PUSH EDX
0040939b : MOV EAX,dword ptr [EBP + 0xc]
0040939e : PUSH EAX
0040939f : MOV ECX,dword ptr [EBP + 0xc]
004093a2 : PUSH ECX
004093a3 : MOV EDX,dword ptr [EBP + 0xc]
004093a6 : PUSH EDX
004093a7 : MOV EAX,ESI
004093a9 : MOV ECX,EDI
004093ab : CALL 0x0040d060
004093b0 : MOV EAX,dword ptr [EBP + 0xc]
004093b3 : LEA ECX,[EAX + 0x30]
004093b6 : PUSH ECX
004093b7 : LEA EDI,[EBP + -0x50]
004093ba : CALL 0x0040c9a0
004093bf : ADD ESP,0x14
004093c2 : MOV dword ptr [EBP + -0x4],0xffffffff
004093c9 : MOV EDX,EDI
004093cb : PUSH EDX
004093cc : CALL 0x00406c60
004093d1 : MOV ECX,dword ptr [EBP + -0xc]
004093d4 : MOV dword ptr FS:[0x0],ECX
004093db : POP ECX
004093dc : POP EDI
004093dd : POP ESI
004093de : POP EBX
004093df : MOV ESP,EBP
004093e1 : POP EBP
004093e2 : RET 0xc

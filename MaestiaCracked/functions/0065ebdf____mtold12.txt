PROGRAM  : Maestia.exe
FUNCTION : ___mtold12
ENTRY    : 0065ebdf
BODY     : [[0065ebdf, 0065edac]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    ___mtold12
   
   Library: Visual Studio 2008 Release */

void ___mtold12(char *param_1,int param_2,uint *param_3)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  bool bVar4;
  bool bVar5;
  short sVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  
  uVar7 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  sVar6 = 0x404e;
  *param_3 = 0;
  param_3[1] = 0;
  param_3[2] = 0;
  for (; param_2 != 0; param_2 = param_2 + -1) {
    uVar2 = *param_3;
    uVar10 = *param_3;
    uVar1 = param_3[1];
    uVar11 = param_3[2];
    uVar9 = param_3[1] * 2;
    bVar4 = false;
    uVar8 = (param_3[2] * 2 | param_3[1] >> 0x1f) * 2 | uVar9 >> 0x1f;
    uVar3 = uVar2 * 4;
    uVar9 = (uVar9 | uVar2 >> 0x1f) * 2 | uVar2 * 2 >> 0x1f;
    uVar2 = uVar3 + uVar10;
    *param_3 = uVar3;
    param_3[1] = uVar9;
    param_3[2] = uVar8;
    if ((uVar2 < uVar3) || (uVar2 < uVar10)) {
      bVar4 = true;
    }
    bVar5 = false;
    *param_3 = uVar2;
    if (bVar4) {
      uVar10 = uVar9 + 1;
      if ((uVar10 < uVar9) || (uVar10 == 0)) {
        bVar5 = true;
      }
      param_3[1] = uVar10;
      if (bVar5) {
        param_3[2] = uVar8 + 1;
      }
    }
    uVar10 = param_3[1] + uVar1;
    bVar4 = false;
    if ((uVar10 < param_3[1]) || (uVar10 < uVar1)) {
      bVar4 = true;
    }
    param_3[1] = uVar10;
    if (bVar4) {
      param_3[2] = param_3[2] + 1;
    }
    param_3[2] = param_3[2] + uVar11;
    bVar4 = false;
    uVar1 = uVar2 * 2;
    uVar11 = uVar10 * 2 | uVar2 >> 0x1f;
    uVar10 = param_3[2] * 2 | uVar10 >> 0x1f;
    *param_3 = uVar1;
    param_3[1] = uVar11;
    param_3[2] = uVar10;
    uVar2 = uVar1 + (int)*param_1;
    if ((uVar2 < uVar1) || (uVar2 < (uint)(int)*param_1)) {
      bVar4 = true;
    }
    *param_3 = uVar2;
    if (bVar4) {
      uVar2 = uVar11 + 1;
      bVar4 = false;
      if ((uVar2 < uVar11) || (uVar2 == 0)) {
        bVar4 = true;
      }
      param_3[1] = uVar2;
      if (bVar4) {
        param_3[2] = uVar10 + 1;
      }
    }
    param_1 = param_1 + 1;
  }
  while (param_3[2] == 0) {
    param_3[2] = param_3[1] >> 0x10;
    sVar6 = sVar6 + -0x10;
    param_3[1] = param_3[1] << 0x10 | *param_3 >> 0x10;
    *param_3 = *param_3 << 0x10;
  }
  uVar2 = param_3[2];
  while ((uVar2 & 0x8000) == 0) {
    uVar10 = *param_3;
    uVar1 = param_3[1];
    sVar6 = sVar6 + -1;
    *param_3 = uVar10 * 2;
    uVar2 = param_3[2] * 2;
    param_3[1] = uVar1 * 2 | uVar10 >> 0x1f;
    param_3[2] = uVar2 | uVar1 >> 0x1f;
  }
  *(short *)((int)param_3 + 10) = sVar6;
  __security_check_cookie(uVar7 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0065ebdf : MOV EDI,EDI
0065ebe1 : PUSH EBP
0065ebe2 : MOV EBP,ESP
0065ebe4 : SUB ESP,0x18
0065ebe7 : MOV EAX,[0x00d66fa0]
0065ebec : XOR EAX,EBP
0065ebee : MOV dword ptr [EBP + -0x4],EAX
0065ebf1 : MOV EAX,dword ptr [EBP + 0x10]
0065ebf4 : PUSH EBX
0065ebf5 : PUSH ESI
0065ebf6 : XOR ESI,ESI
0065ebf8 : PUSH EDI
0065ebf9 : MOV dword ptr [EBP + -0x18],0x404e
0065ec00 : MOV dword ptr [EAX],ESI
0065ec02 : MOV dword ptr [EAX + 0x4],ESI
0065ec05 : MOV dword ptr [EAX + 0x8],ESI
0065ec08 : CMP dword ptr [EBP + 0xc],ESI
0065ec0b : JBE 0x0065ed57
0065ec11 : MOV EDX,dword ptr [EAX]
0065ec13 : MOV EBX,dword ptr [EAX + 0x4]
0065ec16 : MOV ESI,EAX
0065ec18 : LEA EDI,[EBP + -0x10]
0065ec1b : MOVSD ES:EDI,ESI
0065ec1c : MOVSD ES:EDI,ESI
0065ec1d : MOVSD ES:EDI,ESI
0065ec1e : MOV ECX,EDX
0065ec20 : SHR ECX,0x1f
0065ec23 : LEA EDI,[EDX + EDX*0x1]
0065ec26 : LEA EDX,[EBX + EBX*0x1]
0065ec29 : OR EDX,ECX
0065ec2b : MOV ECX,dword ptr [EAX + 0x8]
0065ec2e : MOV ESI,EBX
0065ec30 : SHR ESI,0x1f
0065ec33 : ADD ECX,ECX
0065ec35 : OR ECX,ESI
0065ec37 : MOV dword ptr [EBP + -0x14],EDI
0065ec3a : MOV ESI,EDI
0065ec3c : AND dword ptr [EBP + -0x14],0x0
0065ec40 : MOV EBX,EDX
0065ec42 : SHR EBX,0x1f
0065ec45 : ADD ECX,ECX
0065ec47 : SHR EDI,0x1f
0065ec4a : OR ECX,EBX
0065ec4c : MOV EBX,dword ptr [EBP + -0x10]
0065ec4f : ADD ESI,ESI
0065ec51 : ADD EDX,EDX
0065ec53 : OR EDX,EDI
0065ec55 : LEA EDI,[ESI + EBX*0x1]
0065ec58 : MOV dword ptr [EAX],ESI
0065ec5a : MOV dword ptr [EAX + 0x4],EDX
0065ec5d : MOV dword ptr [EAX + 0x8],ECX
0065ec60 : CMP EDI,ESI
0065ec62 : JC 0x0065ec68
0065ec64 : CMP EDI,EBX
0065ec66 : JNC 0x0065ec6f
0065ec68 : MOV dword ptr [EBP + -0x14],0x1
0065ec6f : XOR EBX,EBX
0065ec71 : MOV dword ptr [EAX],EDI
0065ec73 : CMP dword ptr [EBP + -0x14],EBX
0065ec76 : JZ 0x0065ec92
0065ec78 : LEA ESI,[EDX + 0x1]
0065ec7b : CMP ESI,EDX
0065ec7d : JC 0x0065ec84
0065ec7f : CMP ESI,0x1
0065ec82 : JNC 0x0065ec87
0065ec84 : XOR EBX,EBX
0065ec86 : INC EBX
0065ec87 : MOV dword ptr [EAX + 0x4],ESI
0065ec8a : TEST EBX,EBX
0065ec8c : JZ 0x0065ec92
0065ec8e : INC ECX
0065ec8f : MOV dword ptr [EAX + 0x8],ECX
0065ec92 : MOV ECX,dword ptr [EAX + 0x4]
0065ec95 : MOV EDX,dword ptr [EBP + -0xc]
0065ec98 : LEA EBX,[ECX + EDX*0x1]
0065ec9b : XOR ESI,ESI
0065ec9d : CMP EBX,ECX
0065ec9f : JC 0x0065eca5
0065eca1 : CMP EBX,EDX
0065eca3 : JNC 0x0065eca8
0065eca5 : XOR ESI,ESI
0065eca7 : INC ESI
0065eca8 : MOV dword ptr [EAX + 0x4],EBX
0065ecab : TEST ESI,ESI
0065ecad : JZ 0x0065ecb2
0065ecaf : INC dword ptr [EAX + 0x8]
0065ecb2 : MOV ECX,dword ptr [EBP + -0x8]
0065ecb5 : ADD dword ptr [EAX + 0x8],ECX
0065ecb8 : AND dword ptr [EBP + -0x14],0x0
0065ecbc : LEA ECX,[EDI + EDI*0x1]
0065ecbf : MOV EDX,EDI
0065ecc1 : SHR EDX,0x1f
0065ecc4 : LEA EDI,[EBX + EBX*0x1]
0065ecc7 : OR EDI,EDX
0065ecc9 : MOV EDX,dword ptr [EAX + 0x8]
0065eccc : MOV ESI,EBX
0065ecce : SHR ESI,0x1f
0065ecd1 : LEA EBX,[EDX + EDX*0x1]
0065ecd4 : MOV EDX,dword ptr [EBP + 0x8]
0065ecd7 : OR EBX,ESI
0065ecd9 : MOV dword ptr [EAX],ECX
0065ecdb : MOV dword ptr [EAX + 0x4],EDI
0065ecde : MOV dword ptr [EAX + 0x8],EBX
0065ece1 : MOVSX EDX,byte ptr [EDX]
0065ece4 : LEA ESI,[ECX + EDX*0x1]
0065ece7 : MOV dword ptr [EBP + -0x10],EDX
0065ecea : CMP ESI,ECX
0065ecec : JC 0x0065ecf2
0065ecee : CMP ESI,EDX
0065ecf0 : JNC 0x0065ecf9
0065ecf2 : MOV dword ptr [EBP + -0x14],0x1
0065ecf9 : CMP dword ptr [EBP + -0x14],0x0
0065ecfd : MOV dword ptr [EAX],ESI
0065ecff : JZ 0x0065ed1d
0065ed01 : LEA ECX,[EDI + 0x1]
0065ed04 : XOR EDX,EDX
0065ed06 : CMP ECX,EDI
0065ed08 : JC 0x0065ed0f
0065ed0a : CMP ECX,0x1
0065ed0d : JNC 0x0065ed12
0065ed0f : XOR EDX,EDX
0065ed11 : INC EDX
0065ed12 : MOV dword ptr [EAX + 0x4],ECX
0065ed15 : TEST EDX,EDX
0065ed17 : JZ 0x0065ed1d
0065ed19 : INC EBX
0065ed1a : MOV dword ptr [EAX + 0x8],EBX
0065ed1d : DEC dword ptr [EBP + 0xc]
0065ed20 : INC dword ptr [EBP + 0x8]
0065ed23 : CMP dword ptr [EBP + 0xc],0x0
0065ed27 : JA 0x0065ec11
0065ed2d : XOR ESI,ESI
0065ed2f : JMP 0x0065ed57
0065ed31 : MOV ECX,dword ptr [EAX + 0x4]
0065ed34 : MOV EDX,ECX
0065ed36 : SHR EDX,0x10
0065ed39 : MOV dword ptr [EAX + 0x8],EDX
0065ed3c : MOV EDX,dword ptr [EAX]
0065ed3e : MOV EDI,EDX
0065ed40 : SHL ECX,0x10
0065ed43 : SHR EDI,0x10
0065ed46 : OR ECX,EDI
0065ed48 : SHL EDX,0x10
0065ed4b : ADD dword ptr [EBP + -0x18],0xfff0
0065ed52 : MOV dword ptr [EAX + 0x4],ECX
0065ed55 : MOV dword ptr [EAX],EDX
0065ed57 : CMP dword ptr [EAX + 0x8],ESI
0065ed5a : JZ 0x0065ed31
0065ed5c : MOV EBX,0x8000
0065ed61 : TEST dword ptr [EAX + 0x8],EBX
0065ed64 : JNZ 0x0065ed96
0065ed66 : MOV ESI,dword ptr [EAX]
0065ed68 : MOV EDI,dword ptr [EAX + 0x4]
0065ed6b : ADD dword ptr [EBP + -0x18],0xffff
0065ed72 : MOV ECX,ESI
0065ed74 : ADD ESI,ESI
0065ed76 : SHR ECX,0x1f
0065ed79 : MOV dword ptr [EAX],ESI
0065ed7b : LEA ESI,[EDI + EDI*0x1]
0065ed7e : OR ESI,ECX
0065ed80 : MOV ECX,dword ptr [EAX + 0x8]
0065ed83 : MOV EDX,EDI
0065ed85 : SHR EDX,0x1f
0065ed88 : ADD ECX,ECX
0065ed8a : OR ECX,EDX
0065ed8c : MOV dword ptr [EAX + 0x4],ESI
0065ed8f : MOV dword ptr [EAX + 0x8],ECX
0065ed92 : TEST EBX,ECX
0065ed94 : JZ 0x0065ed66
0065ed96 : MOV CX,word ptr [EBP + -0x18]
0065ed9a : MOV word ptr [EAX + 0xa],CX
0065ed9e : MOV ECX,dword ptr [EBP + -0x4]
0065eda1 : POP EDI
0065eda2 : POP ESI
0065eda3 : XOR ECX,EBP
0065eda5 : POP EBX
0065eda6 : CALL 0x00633e6b
0065edab : LEAVE
0065edac : RET

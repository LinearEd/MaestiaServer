PROGRAM  : Maestia.exe
FUNCTION : FUN_005eb970
ENTRY    : 005eb970
BODY     : [[005eb970, 005ebada]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005eb970(undefined4 param_1,int *param_2,uint param_3)

{
  uint *puVar1;
  int *piVar2;
  int iVar3;
  uint *puVar4;
  uint uVar5;
  int *in_ECX;
  uint uVar6;
  int iVar7;
  
  piVar2 = (int *)*in_ECX;
  if (piVar2 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar2 * 5) <= piVar2[1] * 4 + 4U) goto LAB_005eb9ab;
    iVar7 = piVar2[1] * 2 + 2;
  }
  FUN_005eaf80(param_1,iVar7);
LAB_005eb9ab:
  piVar2 = (int *)*in_ECX;
  param_3 = param_3 & piVar2[1];
  *piVar2 = *piVar2 + 1;
  iVar7 = *in_ECX;
  iVar3 = *(int *)(iVar7 + 8 + param_3 * 0x18);
  puVar1 = (uint *)(iVar7 + 8 + param_3 * 0x18);
  if (iVar3 == -2) {
    *puVar1 = 0xffffffff;
    puVar4 = (uint *)*param_2;
    puVar1[2] = *puVar4;
    puVar1[3] = puVar4[1];
    puVar1[4] = puVar4[2];
    puVar1[5] = *(uint *)param_2[1];
    puVar1[1] = param_3;
    return;
  }
  uVar6 = param_3;
  do {
    uVar6 = uVar6 + 1 & *(uint *)(iVar7 + 4);
  } while (*(int *)(iVar7 + 8 + uVar6 * 0x18) != -2);
  uVar5 = puVar1[1];
  piVar2 = (int *)(iVar7 + 8 + uVar6 * 0x18);
  if (uVar5 != param_3) {
    puVar4 = (uint *)(iVar7 + 8 + uVar5 * 0x18);
    for (uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x18); uVar5 != param_3;
        uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x18)) {
      uVar5 = *puVar4;
      puVar4 = (uint *)(iVar7 + 8 + uVar5 * 0x18);
    }
    if (piVar2 != (int *)0x0) {
      *piVar2 = iVar3;
      piVar2[1] = puVar1[1];
      piVar2[2] = puVar1[2];
      piVar2[3] = puVar1[3];
      piVar2[4] = puVar1[4];
      piVar2[5] = puVar1[5];
    }
    *puVar4 = uVar6;
    puVar4 = (uint *)*param_2;
    puVar1[2] = *puVar4;
    puVar1[3] = puVar4[1];
    puVar1[4] = puVar4[2];
    puVar1[5] = *(uint *)param_2[1];
    *puVar1 = 0xffffffff;
    puVar1[1] = param_3;
    return;
  }
  if (piVar2 != (int *)0x0) {
    *piVar2 = iVar3;
    piVar2[1] = puVar1[1];
    piVar2[2] = puVar1[2];
    piVar2[3] = puVar1[3];
    piVar2[4] = puVar1[4];
    piVar2[5] = puVar1[5];
  }
  puVar4 = (uint *)*param_2;
  puVar1[2] = *puVar4;
  puVar1[3] = puVar4[1];
  puVar1[4] = puVar4[2];
  puVar1[5] = *(uint *)param_2[1];
  *puVar1 = uVar6;
  puVar1[1] = param_3;
  return;
}



============================================================
DISASSEMBLY
============================================================
005eb970 : PUSH EBP
005eb971 : PUSH ESI
005eb972 : MOV ESI,ECX
005eb974 : MOV EAX,dword ptr [ESI]
005eb976 : PUSH EDI
005eb977 : TEST EAX,EAX
005eb979 : JNZ 0x005eb984
005eb97b : MOV EAX,dword ptr [ESP + 0x10]
005eb97f : PUSH 0x8
005eb981 : PUSH EAX
005eb982 : JMP 0x005eb9a6
005eb984 : MOV ECX,dword ptr [EAX + 0x4]
005eb987 : LEA EDX,[ECX*0x4 + 0x4]
005eb98e : MOV ECX,dword ptr [EAX]
005eb990 : LEA ECX,[ECX + ECX*0x4]
005eb993 : CMP ECX,EDX
005eb995 : JBE 0x005eb9ab
005eb997 : MOV EDX,dword ptr [EAX + 0x4]
005eb99a : MOV ECX,dword ptr [ESP + 0x10]
005eb99e : LEA EAX,[EDX + EDX*0x1 + 0x2]
005eb9a2 : PUSH EAX
005eb9a3 : PUSH ECX
005eb9a4 : MOV ECX,ESI
005eb9a6 : CALL 0x005eaf80
005eb9ab : MOV EAX,dword ptr [ESI]
005eb9ad : MOV ECX,dword ptr [ESP + 0x18]
005eb9b1 : AND ECX,dword ptr [EAX + 0x4]
005eb9b4 : INC dword ptr [EAX]
005eb9b6 : MOV ESI,dword ptr [ESI]
005eb9b8 : LEA EDX,[ECX + ECX*0x2]
005eb9bb : MOV EBP,dword ptr [ESI + EDX*0x8 + 0x8]
005eb9bf : LEA EAX,[ESI + EDX*0x8 + 0x8]
005eb9c3 : CMP EBP,-0x2
005eb9c6 : JNZ 0x005eb9f6
005eb9c8 : MOV ESI,dword ptr [ESP + 0x14]
005eb9cc : MOV dword ptr [EAX],0xffffffff
005eb9d2 : MOV EDX,dword ptr [ESI]
005eb9d4 : MOV EDI,dword ptr [EDX]
005eb9d6 : MOV dword ptr [EAX + 0x8],EDI
005eb9d9 : MOV EDI,dword ptr [EDX + 0x4]
005eb9dc : MOV dword ptr [EAX + 0xc],EDI
005eb9df : MOV EDX,dword ptr [EDX + 0x8]
005eb9e2 : MOV dword ptr [EAX + 0x10],EDX
005eb9e5 : MOV EDX,dword ptr [ESI + 0x4]
005eb9e8 : MOV EDX,dword ptr [EDX]
005eb9ea : POP EDI
005eb9eb : POP ESI
005eb9ec : MOV dword ptr [EAX + 0x14],EDX
005eb9ef : MOV dword ptr [EAX + 0x4],ECX
005eb9f2 : POP EBP
005eb9f3 : RET 0xc
005eb9f6 : MOV EDI,dword ptr [ESI + 0x4]
005eb9f9 : MOV EDX,ECX
005eb9fb : PUSH EBX
005eb9fc : LEA ESP,[ESP]
005eba00 : INC EDX
005eba01 : AND EDX,EDI
005eba03 : LEA EBX,[EDX + EDX*0x2]
005eba06 : CMP dword ptr [ESI + EBX*0x8 + 0x8],-0x2
005eba0b : JNZ 0x005eba00
005eba0d : MOV EBX,dword ptr [EAX + 0x4]
005eba10 : LEA EDI,[EDX + EDX*0x2]
005eba13 : LEA EDI,[ESI + EDI*0x8 + 0x8]
005eba17 : CMP EBX,ECX
005eba19 : JNZ 0x005eba6a
005eba1b : TEST EDI,EDI
005eba1d : JZ 0x005eba3f
005eba1f : MOV dword ptr [EDI],EBP
005eba21 : MOV ESI,dword ptr [EAX + 0x4]
005eba24 : MOV dword ptr [EDI + 0x4],ESI
005eba27 : MOV ESI,dword ptr [EAX + 0x8]
005eba2a : MOV dword ptr [EDI + 0x8],ESI
005eba2d : MOV ESI,dword ptr [EAX + 0xc]
005eba30 : MOV dword ptr [EDI + 0xc],ESI
005eba33 : MOV ESI,dword ptr [EAX + 0x10]
005eba36 : MOV dword ptr [EDI + 0x10],ESI
005eba39 : MOV ESI,dword ptr [EAX + 0x14]
005eba3c : MOV dword ptr [EDI + 0x14],ESI
005eba3f : MOV EDI,dword ptr [ESP + 0x18]
005eba43 : MOV ESI,dword ptr [EDI]
005eba45 : MOV EBX,dword ptr [ESI]
005eba47 : MOV dword ptr [EAX + 0x8],EBX
005eba4a : MOV EBX,dword ptr [ESI + 0x4]
005eba4d : MOV dword ptr [EAX + 0xc],EBX
005eba50 : MOV ESI,dword ptr [ESI + 0x8]
005eba53 : MOV dword ptr [EAX + 0x10],ESI
005eba56 : MOV ESI,dword ptr [EDI + 0x4]
005eba59 : MOV ESI,dword ptr [ESI]
005eba5b : POP EBX
005eba5c : MOV dword ptr [EAX + 0x14],ESI
005eba5f : POP EDI
005eba60 : POP ESI
005eba61 : MOV dword ptr [EAX],EDX
005eba63 : MOV dword ptr [EAX + 0x4],ECX
005eba66 : POP EBP
005eba67 : RET 0xc
005eba6a : LEA EBX,[EBX + EBX*0x2]
005eba6d : CMP dword ptr [ESI + EBX*0x8 + 0x8],ECX
005eba71 : LEA EBX,[ESI + EBX*0x8 + 0x8]
005eba75 : JZ 0x005eba86
005eba77 : MOV EBX,dword ptr [EBX]
005eba79 : LEA EBX,[EBX + EBX*0x2]
005eba7c : CMP dword ptr [ESI + EBX*0x8 + 0x8],ECX
005eba80 : LEA EBX,[ESI + EBX*0x8 + 0x8]
005eba84 : JNZ 0x005eba77
005eba86 : TEST EDI,EDI
005eba88 : JZ 0x005ebaaa
005eba8a : MOV dword ptr [EDI],EBP
005eba8c : MOV ESI,dword ptr [EAX + 0x4]
005eba8f : MOV dword ptr [EDI + 0x4],ESI
005eba92 : MOV ESI,dword ptr [EAX + 0x8]
005eba95 : MOV dword ptr [EDI + 0x8],ESI
005eba98 : MOV ESI,dword ptr [EAX + 0xc]
005eba9b : MOV dword ptr [EDI + 0xc],ESI
005eba9e : MOV ESI,dword ptr [EAX + 0x10]
005ebaa1 : MOV dword ptr [EDI + 0x10],ESI
005ebaa4 : MOV ESI,dword ptr [EAX + 0x14]
005ebaa7 : MOV dword ptr [EDI + 0x14],ESI
005ebaaa : MOV ESI,dword ptr [ESP + 0x18]
005ebaae : MOV dword ptr [EBX],EDX
005ebab0 : MOV EDX,dword ptr [ESI]
005ebab2 : MOV EDI,dword ptr [EDX]
005ebab4 : MOV dword ptr [EAX + 0x8],EDI
005ebab7 : MOV EDI,dword ptr [EDX + 0x4]
005ebaba : MOV dword ptr [EAX + 0xc],EDI
005ebabd : MOV EDX,dword ptr [EDX + 0x8]
005ebac0 : MOV dword ptr [EAX + 0x10],EDX
005ebac3 : MOV EDX,dword ptr [ESI + 0x4]
005ebac6 : MOV EDX,dword ptr [EDX]
005ebac8 : POP EBX
005ebac9 : POP EDI
005ebaca : MOV dword ptr [EAX + 0x14],EDX
005ebacd : POP ESI
005ebace : MOV dword ptr [EAX],0xffffffff
005ebad4 : MOV dword ptr [EAX + 0x4],ECX
005ebad7 : POP EBP
005ebad8 : RET 0xc

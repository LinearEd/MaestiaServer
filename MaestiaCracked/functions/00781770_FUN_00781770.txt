PROGRAM  : Maestia.exe
FUNCTION : FUN_00781770
ENTRY    : 00781770
BODY     : [[00781770, 00781955]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00781770(void)

{
  float fVar1;
  float *in_EAX;
  byte bVar2;
  byte bVar3;
  int in_ECX;
  float *pfVar4;
  int iVar5;
  float fVar6;
  int iVar7;
  float *unaff_EDI;
  float fVar8;
  float fVar9;
  float fVar10;
  float afStack_5c [12];
  undefined8 local_2c;
  float local_24;
  float *local_1c;
  float local_18;
  float local_14;
  float local_10;
  float local_c;
  byte local_5;
  
  local_c = *unaff_EDI;
  fVar6 = unaff_EDI[2];
  fVar1 = unaff_EDI[1];
  iVar5 = 0;
  local_18 = in_EAX[2];
  local_14 = in_EAX[1];
  local_5 = 0;
  local_10 = *in_EAX;
  pfVar4 = (float *)(in_ECX + 8);
  iVar7 = 6;
  do {
    fVar9 = pfVar4[-2] * local_10 + pfVar4[-1] * local_14 + *pfVar4 * local_18;
    in_EAX = (float *)((uint)CONCAT21((short)((uint)in_EAX >> 0x10),
                                      (fVar9 == 0.0) << 6 | NAN(fVar9) << 2 | 2U | fVar9 < 0.0) << 8
                      );
    fVar8 = pfVar4[-2] * local_c + pfVar4[-1] * fVar1 + *pfVar4 * fVar6 + pfVar4[1];
    if (fVar9 == 0.0) {
      if (fVar8 <= unaff_EDI[3]) {
        fVar10 = 1e+32;
        fVar8 = 0.0;
LAB_00781868:
        afStack_5c[iVar5] = fVar8;
        iVar5 = iVar5 + 1;
        goto LAB_0078186f;
      }
    }
    else {
      fVar10 = (unaff_EDI[3] - fVar8) * (1.0 / fVar9);
      fVar9 = (-unaff_EDI[3] - fVar8) * (1.0 / fVar9);
      fVar8 = fVar9;
      if (fVar10 < fVar9) {
        fVar8 = fVar10;
      }
      if (fVar10 <= fVar9) {
        fVar10 = fVar9;
      }
      if (0.0 <= fVar8) goto LAB_00781868;
LAB_0078186f:
      if (0.0 <= fVar10) {
        afStack_5c[iVar5] = fVar10;
        iVar5 = iVar5 + 1;
      }
    }
    pfVar4 = pfVar4 + 4;
    iVar7 = iVar7 + -1;
    if (iVar7 == 0) {
      local_c = (float)iVar5;
      if (0 < iVar5) {
        local_1c = (float *)(in_ECX + 4);
        iVar7 = 0;
        fVar6 = (float)iVar5;
        do {
          local_2c = *(undefined8 *)unaff_EDI;
          fVar1 = afStack_5c[iVar7];
          local_2c._4_4_ = (float)((ulonglong)local_2c >> 0x20);
          local_24 = unaff_EDI[2];
          bVar2 = 1;
          in_EAX = (float *)0x0;
          pfVar4 = (float *)(in_ECX + 4);
          do {
            bVar3 = 0;
            if (bVar2 == 0) break;
            bVar2 = bVar2 & 0.0 <= pfVar4[1] * (unaff_EDI[2] + local_18 * fVar1) +
                                   pfVar4[-1] * (local_10 * fVar1 + (float)local_2c) +
                                   *pfVar4 * (local_2c._4_4_ + local_14 * fVar1) + pfVar4[2] +
                                   unaff_EDI[3] * 1.1;
            in_EAX = (float *)((int)in_EAX + 1);
            pfVar4 = pfVar4 + 4;
            fVar6 = local_c;
            bVar3 = bVar2;
          } while ((int)in_EAX < 6);
          local_5 = local_5 | bVar3;
          iVar7 = iVar7 + 1;
        } while (iVar7 < (int)fVar6);
      }
      return CONCAT31((int3)((uint)in_EAX >> 8),local_5);
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
00781770 : PUSH EBP
00781771 : MOV EBP,ESP
00781773 : SUB ESP,0x58
00781776 : MOVSS XMM0,dword ptr [EDI]
0078177a : MOVSS XMM4,dword ptr [EDI + 0x8]
0078177f : MOVSS XMM6,dword ptr [EDI + 0x4]
00781784 : XORPS XMM5,XMM5
00781787 : XOR EDX,EDX
00781789 : MOV dword ptr [EBP + -0x8],EDX
0078178c : MOVSS dword ptr [EBP + -0x8],XMM0
00781791 : MOVSS XMM0,dword ptr [EAX + 0x8]
00781796 : PUSH EBX
00781797 : MOVSS dword ptr [EBP + -0x14],XMM0
0078179c : MOVSS XMM0,dword ptr [EAX + 0x4]
007817a1 : PUSH ESI
007817a2 : MOV ESI,ECX
007817a4 : MOVSS dword ptr [EBP + -0x10],XMM0
007817a9 : MOVSS XMM0,dword ptr [EAX]
007817ad : MOV byte ptr [EBP + -0x1],DL
007817b0 : MOVSS dword ptr [EBP + -0xc],XMM0
007817b5 : LEA ECX,[ESI + 0x8]
007817b8 : LEA EBX,[EDX + 0x6]
007817bb : MOVSS XMM3,dword ptr [ECX + -0x4]
007817c0 : MOVSS XMM1,dword ptr [ECX + -0x8]
007817c5 : MOVSS XMM2,dword ptr [ECX]
007817c9 : MOVAPS XMM0,XMM1
007817cc : MULSS XMM0,dword ptr [EBP + -0x8]
007817d1 : MULSS XMM1,dword ptr [EBP + -0xc]
007817d6 : MOVAPS XMM7,XMM3
007817d9 : MULSS XMM3,dword ptr [EBP + -0x10]
007817de : MULSS XMM7,XMM6
007817e2 : ADDSS XMM0,XMM7
007817e6 : MOVAPS XMM7,XMM2
007817e9 : MULSS XMM2,dword ptr [EBP + -0x14]
007817ee : ADDSS XMM1,XMM3
007817f2 : ADDSS XMM1,XMM2
007817f6 : UCOMISS XMM1,XMM5
007817f9 : LAHF
007817fa : MULSS XMM7,XMM4
007817fe : ADDSS XMM0,XMM7
00781802 : ADDSS XMM0,dword ptr [ECX + 0x4]
00781807 : TEST AH,0x44
0078180a : JP 0x00781823
0078180c : MOVSS XMM1,dword ptr [EDI + 0xc]
00781811 : COMISS XMM1,XMM0
00781814 : JC 0x0078187b
00781816 : MOVSS XMM1,dword ptr [0x00cdf174]
0078181e : MOVAPS XMM0,XMM5
00781821 : JMP 0x00781868
00781823 : MOVSS XMM2,dword ptr [EDI + 0xc]
00781828 : MOVSS XMM3,dword ptr [0x00c10fc4]
00781830 : DIVSS XMM3,XMM1
00781834 : MOVAPS XMM1,XMM2
00781837 : XORPS XMM2,xmmword ptr [0x00cdf0c0]
0078183e : SUBSS XMM1,XMM0
00781842 : SUBSS XMM2,XMM0
00781846 : MULSS XMM1,XMM3
0078184a : MULSS XMM2,XMM3
0078184e : COMISS XMM2,XMM1
00781851 : JBE 0x00781858
00781853 : MOVAPS XMM0,XMM1
00781856 : JMP 0x0078185b
00781858 : MOVAPS XMM0,XMM2
0078185b : COMISS XMM1,XMM2
0078185e : JA 0x00781863
00781860 : MOVAPS XMM1,XMM2
00781863 : COMISS XMM0,XMM5
00781866 : JC 0x0078186f
00781868 : MOVSS dword ptr [EBP + EDX*0x4 + -0x58],XMM0
0078186e : INC EDX
0078186f : COMISS XMM1,XMM5
00781872 : JC 0x0078187b
00781874 : MOVSS dword ptr [EBP + EDX*0x4 + -0x58],XMM1
0078187a : INC EDX
0078187b : ADD ECX,0x10
0078187e : SUB EBX,0x1
00781881 : JNZ 0x007817bb
00781887 : MOV dword ptr [EBP + -0x8],EDX
0078188a : TEST EDX,EDX
0078188c : JLE 0x0078194d
00781892 : MOVSS XMM6,dword ptr [EDI + 0xc]
00781897 : ADD ESI,0x4
0078189a : MOV dword ptr [EBP + -0x18],ESI
0078189d : MOVQ XMM0,qword ptr [EDI]
007818a1 : MOVSS XMM2,dword ptr [EBP + EBX*0x4 + -0x58]
007818a7 : MOV EAX,dword ptr [EDI + 0x8]
007818aa : MOVSS XMM3,dword ptr [EBP + -0x10]
007818af : MOVSS XMM4,dword ptr [EBP + -0x14]
007818b4 : MOV ESI,dword ptr [EBP + -0x18]
007818b7 : MOVQ qword ptr [EBP + -0x28],XMM0
007818bc : MOVSS XMM0,dword ptr [EBP + -0xc]
007818c1 : MULSS XMM3,XMM2
007818c5 : MULSS XMM0,XMM2
007818c9 : ADDSS XMM0,dword ptr [EBP + -0x28]
007818ce : MULSS XMM4,XMM2
007818d2 : MOVSS XMM2,dword ptr [EBP + -0x24]
007818d7 : MOV dword ptr [EBP + -0x20],EAX
007818da : ADDSS XMM2,XMM3
007818de : MOVSS XMM3,dword ptr [EBP + -0x20]
007818e3 : MOVAPS XMM1,XMM6
007818e6 : MULSS XMM1,dword ptr [0x00cdf3ec]
007818ee : ADDSS XMM3,XMM4
007818f2 : MOV CL,0x1
007818f4 : XOR EAX,EAX
007818f6 : TEST CL,CL
007818f8 : JZ 0x00781941
007818fa : MOVSS XMM4,dword ptr [ESI + 0x4]
007818ff : MOVSS XMM7,dword ptr [ESI + -0x4]
00781904 : MULSS XMM4,XMM3
00781908 : MULSS XMM7,XMM0
0078190c : ADDSS XMM4,XMM7
00781910 : MOVSS XMM7,dword ptr [ESI]
00781914 : MULSS XMM7,XMM2
00781918 : ADDSS XMM4,XMM7
0078191c : ADDSS XMM4,dword ptr [ESI + 0x8]
00781921 : ADDSS XMM4,XMM1
00781925 : COMISS XMM4,XMM5
00781928 : JC 0x00781931
0078192a : MOV EDX,0x1
0078192f : JMP 0x00781933
00781931 : XOR EDX,EDX
00781933 : AND CL,DL
00781935 : MOV EDX,dword ptr [EBP + -0x8]
00781938 : INC EAX
00781939 : ADD ESI,0x10
0078193c : CMP EAX,0x6
0078193f : JL 0x007818f6
00781941 : OR byte ptr [EBP + -0x1],CL
00781944 : INC EBX
00781945 : CMP EBX,EDX
00781947 : JL 0x0078189d
0078194d : MOV AL,byte ptr [EBP + -0x1]
00781950 : POP ESI
00781951 : POP EBX
00781952 : MOV ESP,EBP
00781954 : POP EBP
00781955 : RET

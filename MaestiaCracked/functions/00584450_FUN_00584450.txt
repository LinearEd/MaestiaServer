PROGRAM  : Maestia.exe
FUNCTION : FUN_00584450
ENTRY    : 00584450
BODY     : [[00584450, 00584591]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_00584450(undefined4 *param_1,uint param_2)

{
  undefined4 *puVar1;
  int iVar2;
  undefined4 *puVar3;
  int iVar4;
  undefined4 uVar5;
  uint uVar6;
  int local_18;
  undefined1 local_14;
  
  iVar2 = param_2;
  local_18 = param_2;
  local_14 = 8;
  puVar3 = (undefined4 *)FUN_00515840(0x34,0);
  if (puVar3 == (undefined4 *)0x0) {
    puVar3 = (undefined4 *)0x0;
  }
  else {
    FUN_00568960(&local_18,FUN_00583bd0);
    *puVar3 = &PTR_LAB_00b8dd80;
    puVar3[4] = &PTR_LAB_00b90510;
    FUN_00530a70(puVar3 + 4,&local_18,&PTR_s_loadBitmap_00b8dc20,7);
  }
  puVar1 = param_1;
  *(undefined1 *)(param_1 + 2) = 0;
  *param_1 = puVar3;
  param_1[1] = 0;
  iVar4 = FUN_00515840(0x58,0);
  if (iVar4 == 0) {
    uVar6 = 0;
  }
  else {
    puVar3 = puVar1;
    uVar5 = FUN_00530910(1);
    uVar6 = FUN_00584310(&local_18,uVar5,puVar3);
    if (uVar6 != 0) {
      *(uint *)(uVar6 + 8) = *(int *)(uVar6 + 8) + 1U & 0x8fffffff;
    }
  }
  param_1 = (undefined4 *)0x1e;
  param_2 = uVar6;
  FUN_0050ff10(&param_1,&param_2);
  if (param_2 != 0) {
    FUN_00503db0();
  }
  puVar3 = &param_2;
  param_2 = param_2 & 0xffffff00;
  iVar4 = *(int *)(*(int *)(iVar2 + 0x298) + 0x10);
  uVar5 = FUN_00526210(puVar1);
  (**(code **)(iVar4 + 0x28))(&local_18,iVar2 + 0x80,uVar5,puVar3);
  FUN_00526bc0();
  if (uVar6 != 0) {
    FUN_00503db0();
  }
  return puVar1;
}



============================================================
DISASSEMBLY
============================================================
00584450 : SUB ESP,0x18
00584453 : PUSH EBP
00584454 : PUSH ESI
00584455 : MOV ESI,dword ptr [ESP + 0x28]
00584459 : MOV ECX,dword ptr [ESI + 0x288]
0058445f : PUSH EDI
00584460 : PUSH 0x0
00584462 : PUSH 0x34
00584464 : MOV dword ptr [ESP + 0x14],ESI
00584468 : MOV byte ptr [ESP + 0x18],0x8
0058446d : CALL 0x00515840
00584472 : MOV EDI,EAX
00584474 : TEST EDI,EDI
00584476 : JZ 0x005844b1
00584478 : PUSH 0x583bd0
0058447d : LEA EAX,[ESP + 0x10]
00584481 : PUSH EAX
00584482 : MOV ECX,EDI
00584484 : CALL 0x00568960
00584489 : PUSH 0x7
0058448b : PUSH 0xb8dc20
00584490 : LEA ECX,[ESP + 0x14]
00584494 : LEA EAX,[EDI + 0x10]
00584497 : PUSH ECX
00584498 : PUSH EAX
00584499 : MOV dword ptr [EDI],0xb8dd80
0058449f : MOV dword ptr [EAX],0xb90510
005844a5 : CALL 0x00530a70
005844aa : ADD ESP,0x10
005844ad : MOV EAX,EDI
005844af : JMP 0x005844b3
005844b1 : XOR EAX,EAX
005844b3 : MOV EDI,dword ptr [ESP + 0x28]
005844b7 : PUSH 0x0
005844b9 : MOV byte ptr [EDI + 0x8],0x0
005844bd : MOV dword ptr [EDI],EAX
005844bf : MOV dword ptr [EDI + 0x4],0x0
005844c6 : MOV ECX,dword ptr [ESI + 0x288]
005844cc : PUSH 0x58
005844ce : CALL 0x00515840
005844d3 : MOV EBP,EAX
005844d5 : TEST EBP,EBP
005844d7 : JZ 0x0058458b
005844dd : PUSH EDI
005844de : PUSH 0x1
005844e0 : MOV ECX,ESI
005844e2 : CALL 0x00530910
005844e7 : PUSH EAX
005844e8 : LEA EDX,[ESP + 0x14]
005844ec : PUSH EDX
005844ed : MOV ECX,EBP
005844ef : CALL 0x00584310
005844f4 : MOV EBP,EAX
005844f6 : TEST EBP,EBP
005844f8 : JZ 0x00584506
005844fa : MOV EAX,dword ptr [EBP + 0x8]
005844fd : INC EAX
005844fe : AND EAX,0x8fffffff
00584503 : MOV dword ptr [EBP + 0x8],EAX
00584506 : LEA ECX,[ESP + 0x2c]
0058450a : PUSH ECX
0058450b : LEA EDX,[ESP + 0x2c]
0058450f : PUSH EDX
00584510 : LEA ECX,[ESI + 0x278]
00584516 : MOV dword ptr [ESP + 0x34],EBP
0058451a : MOV dword ptr [ESP + 0x30],0x1e
00584522 : CALL 0x0050ff10
00584527 : MOV ECX,dword ptr [ESP + 0x2c]
0058452b : TEST ECX,ECX
0058452d : JZ 0x00584534
0058452f : CALL 0x00503db0
00584534 : MOV EAX,dword ptr [ESI + 0x298]
0058453a : PUSH EBX
0058453b : LEA ECX,[ESP + 0x30]
0058453f : PUSH ECX
00584540 : MOV byte ptr [ESP + 0x34],0x0
00584545 : MOV EBX,dword ptr [EAX + 0x10]
00584548 : PUSH EDI
00584549 : LEA ECX,[ESP + 0x20]
0058454d : CALL 0x00526210
00584552 : MOV ECX,dword ptr [ESI + 0x298]
00584558 : PUSH EAX
00584559 : LEA EDX,[ESI + 0x80]
0058455f : PUSH EDX
00584560 : MOV EDX,dword ptr [EBX + 0x28]
00584563 : LEA EAX,[ESP + 0x1c]
00584567 : PUSH EAX
00584568 : ADD ECX,0x10
0058456b : CALL EDX
0058456d : LEA ECX,[ESP + 0x18]
00584571 : CALL 0x00526bc0
00584576 : POP EBX
00584577 : TEST EBP,EBP
00584579 : JZ 0x00584582
0058457b : MOV ECX,EBP
0058457d : CALL 0x00503db0
00584582 : MOV EAX,EDI
00584584 : POP EDI
00584585 : POP ESI
00584586 : POP EBP
00584587 : ADD ESP,0x18
0058458a : RET
0058458b : XOR EBP,EBP
0058458d : JMP 0x00584506

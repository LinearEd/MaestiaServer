PROGRAM  : Maestia.exe
FUNCTION : FUN_0070c8c0
ENTRY    : 0070c8c0
BODY     : [[0070c8c0, 0070cab8]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x0070ca23) */
/* WARNING: Removing unreachable block (ram,0x0070ca79) */
/* WARNING: Removing unreachable block (ram,0x0070c9cd) */

void FUN_0070c8c0(int param_1)

{
  uint uVar1;
  wchar_t *_FullPath;
  undefined4 uVar2;
  uint local_a24;
  wchar_t local_a20 [1024];
  wchar_t local_220 [128];
  wchar_t local_120 [128];
  wchar_t local_20 [6];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b17842;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_14 = uVar1;
  if (*(uint *)(param_1 + 0x14) < 0x401) {
    if (*(uint *)(param_1 + 0x18) < 8) {
      _FullPath = (wchar_t *)(param_1 + 4);
    }
    else {
      _FullPath = *(wchar_t **)(param_1 + 4);
    }
    __wsplitpath(_FullPath,local_20,local_a20,local_120,local_220);
    uVar2 = FUN_00406460(local_20);
    local_8 = 0;
    FUN_00405eb0(uVar2,0,0xffffffff);
    local_8 = 0xffffffff;
    if (7 < local_a24) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0(uVar1);
    }
    uVar2 = FUN_00406460(local_a20);
    local_8 = 1;
    FUN_00405eb0(uVar2,0,0xffffffff);
    local_8 = 0xffffffff;
    uVar2 = FUN_00406460(local_120);
    local_8 = 2;
    FUN_00405eb0(uVar2,0,0xffffffff);
    local_8 = 0xffffffff;
    uVar2 = FUN_00406460(local_220);
    local_8 = 3;
    FUN_00405eb0(uVar2,0,0xffffffff);
  }
  local_8 = 0xffffffff;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0070c8c0 : PUSH EBP
0070c8c1 : MOV EBP,ESP
0070c8c3 : PUSH -0x1
0070c8c5 : PUSH 0xb17842
0070c8ca : MOV EAX,FS:[0x0]
0070c8d0 : PUSH EAX
0070c8d1 : SUB ESP,0xa38
0070c8d7 : MOV EAX,[0x00d66fa0]
0070c8dc : XOR EAX,EBP
0070c8de : MOV dword ptr [EBP + -0x10],EAX
0070c8e1 : PUSH EBX
0070c8e2 : PUSH ESI
0070c8e3 : PUSH EDI
0070c8e4 : PUSH EAX
0070c8e5 : LEA EAX,[EBP + -0xc]
0070c8e8 : MOV FS:[0x0],EAX
0070c8ee : MOV EAX,dword ptr [EBP + 0x8]
0070c8f1 : CMP dword ptr [EAX + 0x14],0x400
0070c8f8 : MOV ESI,dword ptr [EBP + 0xc]
0070c8fb : MOV dword ptr [EBP + 0xfffff5c4],ECX
0070c901 : MOV ECX,dword ptr [EBP + 0x10]
0070c904 : MOV dword ptr [EBP + 0xfffff5bc],EDX
0070c90a : MOV dword ptr [EBP + 0xfffff5c0],ECX
0070c910 : JA 0x0070ca9d
0070c916 : CMP dword ptr [EAX + 0x18],0x8
0070c91a : JC 0x0070c921
0070c91c : MOV EAX,dword ptr [EAX + 0x4]
0070c91f : JMP 0x0070c924
0070c921 : ADD EAX,0x4
0070c924 : LEA EDX,[EBP + 0xfffffde4]
0070c92a : PUSH EDX
0070c92b : LEA ECX,[EBP + 0xfffffee4]
0070c931 : PUSH ECX
0070c932 : LEA EDX,[EBP + 0xfffff5e4]
0070c938 : PUSH EDX
0070c939 : LEA ECX,[EBP + -0x1c]
0070c93c : PUSH ECX
0070c93d : PUSH EAX
0070c93e : CALL 0x00636e00
0070c943 : ADD ESP,0x14
0070c946 : LEA EDX,[EBP + -0x1c]
0070c949 : PUSH EDX
0070c94a : LEA ECX,[EBP + 0xfffff5c8]
0070c950 : CALL 0x00406460
0070c955 : XOR EDI,EDI
0070c957 : MOV dword ptr [EBP + -0x4],EDI
0070c95a : OR EBX,0xffffffff
0070c95d : PUSH EBX
0070c95e : PUSH EDI
0070c95f : PUSH EAX
0070c960 : MOV ECX,ESI
0070c962 : CALL 0x00405eb0
0070c967 : MOV dword ptr [EBP + -0x4],EBX
0070c96a : MOV ESI,0x8
0070c96f : CMP dword ptr [EBP + 0xfffff5e0],ESI
0070c975 : JC 0x0070c982
0070c977 : MOV ECX,dword ptr [EBP + 0xfffff5cc]
0070c97d : CALL 0x006f04e0
0070c982 : LEA ECX,[EBP + 0xfffff5e4]
0070c988 : XOR EAX,EAX
0070c98a : PUSH ECX
0070c98b : LEA ECX,[EBP + 0xfffff5c8]
0070c991 : MOV dword ptr [EBP + 0xfffff5e0],0x7
0070c99b : MOV dword ptr [EBP + 0xfffff5dc],EDI
0070c9a1 : MOV word ptr [EBP + 0xfffff5cc],AX
0070c9a8 : CALL 0x00406460
0070c9ad : MOV dword ptr [EBP + -0x4],0x1
0070c9b4 : MOV ECX,dword ptr [EBP + 0xfffff5c4]
0070c9ba : PUSH EBX
0070c9bb : PUSH EDI
0070c9bc : PUSH EAX
0070c9bd : CALL 0x00405eb0
0070c9c2 : MOV dword ptr [EBP + -0x4],EBX
0070c9c5 : CMP dword ptr [EBP + 0xfffff5e0],ESI
0070c9cb : JC 0x0070c9d8
0070c9cd : MOV ECX,dword ptr [EBP + 0xfffff5cc]
0070c9d3 : CALL 0x006f04e0
0070c9d8 : LEA EAX,[EBP + 0xfffffee4]
0070c9de : XOR EDX,EDX
0070c9e0 : PUSH EAX
0070c9e1 : LEA ECX,[EBP + 0xfffff5c8]
0070c9e7 : MOV dword ptr [EBP + 0xfffff5e0],0x7
0070c9f1 : MOV dword ptr [EBP + 0xfffff5dc],EDI
0070c9f7 : MOV word ptr [EBP + 0xfffff5cc],DX
0070c9fe : CALL 0x00406460
0070ca03 : MOV dword ptr [EBP + -0x4],0x2
0070ca0a : MOV ECX,dword ptr [EBP + 0xfffff5bc]
0070ca10 : PUSH EBX
0070ca11 : PUSH EDI
0070ca12 : PUSH EAX
0070ca13 : CALL 0x00405eb0
0070ca18 : MOV dword ptr [EBP + -0x4],EBX
0070ca1b : CMP dword ptr [EBP + 0xfffff5e0],ESI
0070ca21 : JC 0x0070ca2e
0070ca23 : MOV ECX,dword ptr [EBP + 0xfffff5cc]
0070ca29 : CALL 0x006f04e0
0070ca2e : XOR ECX,ECX
0070ca30 : LEA EDX,[EBP + 0xfffffde4]
0070ca36 : MOV word ptr [EBP + 0xfffff5cc],CX
0070ca3d : PUSH EDX
0070ca3e : LEA ECX,[EBP + 0xfffff5c8]
0070ca44 : MOV dword ptr [EBP + 0xfffff5e0],0x7
0070ca4e : MOV dword ptr [EBP + 0xfffff5dc],EDI
0070ca54 : CALL 0x00406460
0070ca59 : MOV dword ptr [EBP + -0x4],0x3
0070ca60 : MOV ECX,dword ptr [EBP + 0xfffff5c0]
0070ca66 : PUSH EBX
0070ca67 : PUSH EDI
0070ca68 : PUSH EAX
0070ca69 : CALL 0x00405eb0
0070ca6e : MOV dword ptr [EBP + -0x4],EBX
0070ca71 : CMP dword ptr [EBP + 0xfffff5e0],ESI
0070ca77 : JC 0x0070ca84
0070ca79 : MOV ECX,dword ptr [EBP + 0xfffff5cc]
0070ca7f : CALL 0x006f04e0
0070ca84 : XOR EAX,EAX
0070ca86 : MOV dword ptr [EBP + 0xfffff5e0],0x7
0070ca90 : MOV dword ptr [EBP + 0xfffff5dc],EDI
0070ca96 : MOV word ptr [EBP + 0xfffff5cc],AX
0070ca9d : MOV ECX,dword ptr [EBP + -0xc]
0070caa0 : MOV dword ptr FS:[0x0],ECX
0070caa7 : POP ECX
0070caa8 : POP EDI
0070caa9 : POP ESI
0070caaa : POP EBX
0070caab : MOV ECX,dword ptr [EBP + -0x10]
0070caae : XOR ECX,EBP
0070cab0 : CALL 0x00633e6b
0070cab5 : MOV ESP,EBP
0070cab7 : POP EBP
0070cab8 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_008628f0
ENTRY    : 008628f0
BODY     : [[008628f0, 00862d6a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008628f0(uint param_1,int param_2,undefined4 param_3,undefined1 *param_4,int param_5)

{
  int iVar1;
  char cVar2;
  undefined1 uVar3;
  int iVar4;
  undefined4 uVar5;
  int *in_ECX;
  byte bVar6;
  undefined1 local_5c [28];
  int local_40;
  undefined1 *local_3c;
  uint local_38;
  byte local_31;
  undefined1 local_30 [4];
  undefined4 ***local_2c [5];
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4de62;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_3c = param_4;
  bVar6 = (byte)param_1;
  if (bVar6 < 0x21) {
    local_38 = param_1 & 0xff;
    local_40 = in_ECX[local_38 + 0x5fc];
    if (((local_40 != 0) && (iVar4 = FUN_004049b0(param_2,local_14), iVar4 != 0)) &&
       ((*(uint *)(iVar4 + 0x18c) & 1 << ((byte)local_38 & 0x1f)) != 0)) {
      if (param_5 != 0) {
        in_ECX[local_38 + 0x5ba] = param_2;
      }
      *(int *)(local_40 + 0x28) = param_2;
      if (((bVar6 == 4) || (iVar4 = FUN_00854a90(), iVar4 != 0)) &&
         (iVar4 = FUN_0085af40(param_3,0), iVar4 != 0)) {
        if ((byte)(bVar6 - 0x14) < 10) {
          local_31 = FUN_00859cb0(local_38);
        }
        else {
          local_31 = (byte)local_38;
        }
        if ((bVar6 == 0x1a) || (bVar6 == 0x1b)) {
          FUN_00406460(&DAT_00c3f414);
          local_8 = 1;
          if (local_31 == 0) {
            iVar4 = in_ECX[0x5fc];
            if ((iVar4 != 0) && (local_38 = FUN_004049b0(param_2), local_38 != 0)) {
              uVar5 = FUN_00404350(local_38 + 400);
              local_8._0_1_ = 2;
              FUN_00405eb0(uVar5,0,0xffffffff);
              local_8._0_1_ = 1;
              FUN_00406560();
              uVar5 = FUN_00404350(local_38 + 0x1d0);
              local_8._0_1_ = 3;
              FUN_00405eb0(uVar5,0,0xffffffff);
              local_8 = CONCAT31(local_8._1_3_,1);
              FUN_00406560();
              if ((*(short *)(local_38 + 0x28a) == 5) && (in_ECX[0x61c] != 0)) {
                FUN_0084faa0();
              }
              FUN_0084fb70();
              *(uint *)(iVar4 + 0x160) = (uint)*(ushort *)(local_38 + 0x28a);
              FUN_0084fd30(*(undefined2 *)(local_38 + 0x28a));
              *(undefined1 *)(iVar4 + 0x1a8) = 0;
              if (*(int **)(iVar4 + 0x168) != (int *)0x0) {
                (**(code **)(**(int **)(iVar4 + 0x168) + 0x10))(0);
              }
              if (*(int **)(iVar4 + 0x16c) != (int *)0x0) {
                (**(code **)(**(int **)(iVar4 + 0x16c) + 0x10))(0);
              }
            }
          }
          else if (local_31 == 1) {
            local_3c = (undefined1 *)FUN_004049b0(param_2);
            iVar4 = FUN_004049b0(param_2);
            if (((local_3c == (undefined1 *)0x0) || (iVar4 == 0)) ||
               (*(short *)(local_3c + 4) != 0x61e)) {
              iVar1 = in_ECX[0x61c];
              if ((iVar1 != 0) && (iVar4 != 0)) {
                uVar5 = FUN_00404350(iVar4 + 400);
                local_8._0_1_ = 5;
                FUN_00405eb0(uVar5,0,0xffffffff);
                local_8._0_1_ = 1;
                FUN_00406560();
                uVar5 = FUN_00404350(iVar4 + 0x1d0);
                local_8._0_1_ = 6;
                FUN_00405eb0(uVar5,0,0xffffffff);
                local_8 = CONCAT31(local_8._1_3_,1);
                FUN_00406560();
                FUN_0084faa0();
                FUN_0084fce0(*(undefined2 *)(iVar4 + 0x28a));
                *(undefined1 *)(iVar1 + 0x1a8) = 0;
                if (*(int **)(iVar1 + 0x168) != (int *)0x0) {
                  (**(code **)(**(int **)(iVar1 + 0x168) + 0x10))(0);
                }
                if (*(int **)(iVar1 + 0x16c) != (int *)0x0) {
                  (**(code **)(**(int **)(iVar1 + 0x16c) + 0x10))(0);
                }
              }
            }
            else {
              uVar5 = FUN_00404350((uint)*(byte *)((int)in_ECX + 0x7e) * 0x40 + 400 + iVar4);
              local_8._0_1_ = 4;
              FUN_00405eb0(uVar5,0,0xffffffff);
              local_8 = CONCAT31(local_8._1_3_,1);
              FUN_00406560();
              FUN_0084ceb0(local_30,param_2);
            }
          }
          local_8 = 0xffffffff;
          FUN_00406560();
        }
        else if ((local_31 != 2) || ((char)in_ECX[0x6af] != '\0')) {
          FUN_0085ad10(local_30,param_1);
          local_8 = 7;
          cVar2 = FUN_004049e0();
          if (cVar2 != '\0') {
            if (local_18 < 8) {
              local_2c[0] = local_2c;
            }
            FUN_00406460(local_2c[0]);
            local_8._0_1_ = 8;
            uVar3 = (**(code **)(*in_ECX + 0x21c))();
            FUN_0084e210(local_5c,in_ECX,1,0,1,uVar3);
            local_8 = CONCAT31(local_8._1_3_,7);
            FUN_00406560();
            FUN_00861620();
            if ((bVar6 != local_31) && (cVar2 = FUN_00404010(), cVar2 != '\0')) {
              FUN_0085c380();
            }
            if (local_31 == 2) {
              FUN_0085a780(in_ECX,1,(char)in_ECX[0x6af],1);
            }
            *local_3c = 1;
          }
          local_8 = 0xffffffff;
          FUN_00406560();
        }
      }
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008628f0 : PUSH EBP
008628f1 : MOV EBP,ESP
008628f3 : PUSH -0x1
008628f5 : PUSH 0xb4de62
008628fa : MOV EAX,FS:[0x0]
00862900 : PUSH EAX
00862901 : SUB ESP,0x50
00862904 : MOV EAX,[0x00d66fa0]
00862909 : XOR EAX,EBP
0086290b : MOV dword ptr [EBP + -0x10],EAX
0086290e : PUSH EBX
0086290f : PUSH ESI
00862910 : PUSH EDI
00862911 : PUSH EAX
00862912 : LEA EAX,[EBP + -0xc]
00862915 : MOV FS:[0x0],EAX
0086291b : MOV EBX,dword ptr [EBP + 0x8]
0086291e : MOV EAX,dword ptr [EBP + 0x14]
00862921 : MOV EDI,ECX
00862923 : MOV dword ptr [EBP + -0x38],EAX
00862926 : CMP BL,0x21
00862929 : JNC 0x00862d44
0086292f : MOVZX EAX,BL
00862932 : MOV dword ptr [EBP + -0x34],EAX
00862935 : MOV EAX,dword ptr [EDI + EAX*0x4 + 0x17f0]
0086293c : MOV dword ptr [EBP + -0x3c],EAX
0086293f : TEST EAX,EAX
00862941 : JZ 0x00862d4b
00862947 : MOV ESI,dword ptr [EBP + 0xc]
0086294a : PUSH ESI
0086294b : CALL 0x004049b0
00862950 : ADD ESP,0x4
00862953 : TEST EAX,EAX
00862955 : JZ 0x00862d4b
0086295b : MOV ECX,dword ptr [EBP + -0x34]
0086295e : MOV EDX,0x1
00862963 : SHL EDX,CL
00862965 : TEST dword ptr [EAX + 0x18c],EDX
0086296b : JZ 0x00862d4b
00862971 : CMP dword ptr [EBP + 0x18],0x0
00862975 : JZ 0x00862980
00862977 : MOV EAX,ECX
00862979 : MOV dword ptr [EDI + EAX*0x4 + 0x16e8],ESI
00862980 : MOV ECX,dword ptr [EBP + -0x3c]
00862983 : MOV dword ptr [ECX + 0x28],ESI
00862986 : CMP BL,0x4
00862989 : JZ 0x0086299a
0086298b : MOV AL,BL
0086298d : CALL 0x00854a90
00862992 : TEST EAX,EAX
00862994 : JZ 0x00862d44
0086299a : MOV EDX,dword ptr [EBP + 0x10]
0086299d : PUSH 0x0
0086299f : PUSH EDX
008629a0 : MOV CL,BL
008629a2 : CALL 0x0085af40
008629a7 : TEST EAX,EAX
008629a9 : JZ 0x00862d4b
008629af : MOV AL,BL
008629b1 : SUB AL,0x14
008629b3 : CMP AL,0x9
008629b5 : JA 0x008629c8
008629b7 : MOV ECX,dword ptr [EBP + -0x34]
008629ba : PUSH ECX
008629bb : CALL 0x00859cb0
008629c0 : ADD ESP,0x4
008629c3 : MOV byte ptr [EBP + -0x2d],AL
008629c6 : JMP 0x008629ce
008629c8 : MOV DL,byte ptr [EBP + -0x34]
008629cb : MOV byte ptr [EBP + -0x2d],DL
008629ce : CMP BL,0x1a
008629d1 : JZ 0x00862ada
008629d7 : CMP BL,0x1b
008629da : JZ 0x00862ada
008629e0 : CMP byte ptr [EBP + -0x2d],0x2
008629e4 : JNZ 0x008629f3
008629e6 : CMP byte ptr [EDI + 0x1abc],0x0
008629ed : JZ 0x00862ad0
008629f3 : PUSH EBX
008629f4 : LEA EAX,[EBP + -0x2c]
008629f7 : PUSH EAX
008629f8 : MOV ECX,ESI
008629fa : MOV EDX,EDI
008629fc : CALL 0x0085ad10
00862a01 : MOV dword ptr [EBP + -0x4],0x7
00862a08 : MOV ESI,0xc3f418
00862a0d : LEA ECX,[EBP + -0x2c]
00862a10 : CALL 0x004049e0
00862a15 : TEST AL,AL
00862a17 : JZ 0x00862ac1
00862a1d : CMP dword ptr [EBP + -0x14],0x8
00862a21 : MOV EAX,dword ptr [EBP + -0x28]
00862a24 : JNC 0x00862a29
00862a26 : LEA EAX,[EBP + -0x28]
00862a29 : PUSH EAX
00862a2a : LEA ECX,[EBP + -0x58]
00862a2d : CALL 0x00406460
00862a32 : MOV byte ptr [EBP + -0x4],0x8
00862a36 : MOV EDX,dword ptr [EDI]
00862a38 : MOV EAX,dword ptr [EDX + 0x21c]
00862a3e : MOV ECX,EDI
00862a40 : CALL EAX
00862a42 : MOVZX ECX,AL
00862a45 : MOV EAX,dword ptr [EBP + -0x34]
00862a48 : PUSH ECX
00862a49 : MOV ECX,dword ptr [EDI + EAX*0x4 + 0x17f0]
00862a50 : PUSH 0x1
00862a52 : PUSH 0x0
00862a54 : PUSH 0x1
00862a56 : PUSH EDI
00862a57 : LEA EDX,[EBP + -0x58]
00862a5a : PUSH EDX
00862a5b : CALL 0x0084e210
00862a60 : MOV byte ptr [EBP + -0x4],0x7
00862a64 : LEA ECX,[EBP + -0x58]
00862a67 : CALL 0x00406560
00862a6c : CALL 0x00861620
00862a71 : MOV CL,byte ptr [EBP + -0x2d]
00862a74 : CMP BL,CL
00862a76 : JZ 0x00862aa3
00862a78 : MOV EDX,dword ptr [EBP + -0x34]
00862a7b : MOV EAX,dword ptr [EDI + EDX*0x4 + 0x17f0]
00862a82 : MOVZX ECX,CL
00862a85 : MOV ECX,dword ptr [EDI + ECX*0x4 + 0x17f0]
00862a8c : ADD EAX,0x60
00862a8f : ADD ECX,0x60
00862a92 : CALL 0x00404010
00862a97 : TEST AL,AL
00862a99 : JZ 0x00862aa3
00862a9b : MOV AL,byte ptr [EBP + -0x2d]
00862a9e : CALL 0x0085c380
00862aa3 : CMP byte ptr [EBP + -0x2d],0x2
00862aa7 : JNZ 0x00862abb
00862aa9 : MOVZX EDX,byte ptr [EDI + 0x1abc]
00862ab0 : PUSH 0x1
00862ab2 : PUSH EDX
00862ab3 : PUSH 0x1
00862ab5 : PUSH EDI
00862ab6 : CALL 0x0085a780
00862abb : MOV EAX,dword ptr [EBP + -0x38]
00862abe : MOV byte ptr [EAX],0x1
00862ac1 : MOV dword ptr [EBP + -0x4],0xffffffff
00862ac8 : LEA ECX,[EBP + -0x2c]
00862acb : CALL 0x00406560
00862ad0 : MOV EAX,0x1
00862ad5 : JMP 0x00862d4d
00862ada : PUSH 0xc3f414
00862adf : LEA ECX,[EBP + -0x2c]
00862ae2 : CALL 0x00406460
00862ae7 : MOV dword ptr [EBP + -0x4],0x1
00862aee : MOV AL,byte ptr [EBP + -0x2d]
00862af1 : TEST AL,AL
00862af3 : JNZ 0x00862bf7
00862af9 : MOV EBX,dword ptr [EDI + 0x17f0]
00862aff : TEST EBX,EBX
00862b01 : JZ 0x00862d35
00862b07 : PUSH ESI
00862b08 : CALL 0x004049b0
00862b0d : ADD ESP,0x4
00862b10 : MOV dword ptr [EBP + -0x34],EAX
00862b13 : TEST EAX,EAX
00862b15 : JZ 0x00862d35
00862b1b : ADD EAX,0x190
00862b20 : PUSH EAX
00862b21 : LEA ESI,[EBP + -0x58]
00862b24 : CALL 0x00404350
00862b29 : ADD ESP,0x4
00862b2c : MOV byte ptr [EBP + -0x4],0x2
00862b30 : PUSH -0x1
00862b32 : PUSH 0x0
00862b34 : PUSH EAX
00862b35 : LEA ECX,[EBP + -0x2c]
00862b38 : CALL 0x00405eb0
00862b3d : MOV byte ptr [EBP + -0x4],0x1
00862b41 : MOV ECX,ESI
00862b43 : CALL 0x00406560
00862b48 : MOV ECX,dword ptr [EBP + -0x34]
00862b4b : ADD ECX,0x1d0
00862b51 : PUSH ECX
00862b52 : LEA ESI,[EBP + -0x58]
00862b55 : CALL 0x00404350
00862b5a : ADD ESP,0x4
00862b5d : MOV byte ptr [EBP + -0x4],0x3
00862b61 : PUSH -0x1
00862b63 : PUSH 0x0
00862b65 : PUSH EAX
00862b66 : LEA ECX,[EBX + 0x170]
00862b6c : CALL 0x00405eb0
00862b71 : MOV byte ptr [EBP + -0x4],0x1
00862b75 : MOV ECX,ESI
00862b77 : CALL 0x00406560
00862b7c : MOV EDX,dword ptr [EBP + -0x34]
00862b7f : CMP word ptr [EDX + 0x28a],0x5
00862b87 : JNZ 0x00862b98
00862b89 : MOV EDI,dword ptr [EDI + 0x1870]
00862b8f : TEST EDI,EDI
00862b91 : JZ 0x00862b98
00862b93 : CALL 0x0084faa0
00862b98 : MOV ESI,EBX
00862b9a : CALL 0x0084fb70
00862b9f : MOV ECX,dword ptr [EBP + -0x34]
00862ba2 : MOVZX EAX,word ptr [ECX + 0x28a]
00862ba9 : MOV dword ptr [EBX + 0x160],EAX
00862baf : MOVZX EAX,word ptr [ECX + 0x28a]
00862bb6 : PUSH EAX
00862bb7 : LEA EDI,[EBP + -0x2c]
00862bba : CALL 0x0084fd30
00862bbf : MOV ECX,dword ptr [EBX + 0x168]
00862bc5 : MOV byte ptr [EBX + 0x1a8],0x0
00862bcc : TEST ECX,ECX
00862bce : JZ 0x00862bd9
00862bd0 : MOV EDX,dword ptr [ECX]
00862bd2 : MOV EAX,dword ptr [EDX + 0x10]
00862bd5 : PUSH 0x0
00862bd7 : CALL EAX
00862bd9 : MOV EBX,dword ptr [EBX + 0x16c]
00862bdf : TEST EBX,EBX
00862be1 : JZ 0x00862d35
00862be7 : MOV EDX,dword ptr [EBX]
00862be9 : MOV EAX,dword ptr [EDX + 0x10]
00862bec : PUSH 0x0
00862bee : MOV ECX,EBX
00862bf0 : CALL EAX
00862bf2 : JMP 0x00862d35
00862bf7 : CMP AL,0x1
00862bf9 : JNZ 0x00862d35
00862bff : PUSH ESI
00862c00 : CALL 0x004049b0
00862c05 : ADD ESP,0x4
00862c08 : PUSH ESI
00862c09 : MOV dword ptr [EBP + -0x38],EAX
00862c0c : CALL 0x004049b0
00862c11 : MOV EBX,EAX
00862c13 : MOV EAX,dword ptr [EBP + -0x38]
00862c16 : ADD ESP,0x4
00862c19 : TEST EAX,EAX
00862c1b : JZ 0x00862c7a
00862c1d : TEST EBX,EBX
00862c1f : JZ 0x00862c7a
00862c21 : MOV ECX,0x61e
00862c26 : CMP word ptr [EAX + 0x4],CX
00862c2a : JNZ 0x00862c7a
00862c2c : MOVZX EDX,byte ptr [EDI + 0x7e]
00862c30 : SHL EDX,0x6
00862c33 : LEA EAX,[EDX + EBX*0x1 + 0x190]
00862c3a : PUSH EAX
00862c3b : LEA ESI,[EBP + -0x58]
00862c3e : CALL 0x00404350
00862c43 : ADD ESP,0x4
00862c46 : MOV byte ptr [EBP + -0x4],0x4
00862c4a : PUSH -0x1
00862c4c : PUSH 0x0
00862c4e : PUSH EAX
00862c4f : LEA ECX,[EBP + -0x2c]
00862c52 : CALL 0x00405eb0
00862c57 : MOV byte ptr [EBP + -0x4],0x1
00862c5b : MOV ECX,ESI
00862c5d : CALL 0x00406560
00862c62 : MOV ECX,dword ptr [EBP + 0xc]
00862c65 : PUSH ECX
00862c66 : MOV ECX,dword ptr [EDI + 0x17f4]
00862c6c : LEA EDX,[EBP + -0x2c]
00862c6f : PUSH EDX
00862c70 : CALL 0x0084ceb0
00862c75 : JMP 0x00862d35
00862c7a : MOV EDI,dword ptr [EDI + 0x1870]
00862c80 : TEST EDI,EDI
00862c82 : JZ 0x00862d35
00862c88 : TEST EBX,EBX
00862c8a : JZ 0x00862d35
00862c90 : LEA EAX,[EBX + 0x190]
00862c96 : PUSH EAX
00862c97 : LEA ESI,[EBP + -0x58]
00862c9a : CALL 0x00404350
00862c9f : ADD ESP,0x4
00862ca2 : MOV byte ptr [EBP + -0x4],0x5
00862ca6 : PUSH -0x1
00862ca8 : PUSH 0x0
00862caa : PUSH EAX
00862cab : LEA ECX,[EBP + -0x2c]
00862cae : CALL 0x00405eb0
00862cb3 : MOV byte ptr [EBP + -0x4],0x1
00862cb7 : MOV ECX,ESI
00862cb9 : CALL 0x00406560
00862cbe : LEA ECX,[EBX + 0x1d0]
00862cc4 : PUSH ECX
00862cc5 : LEA ESI,[EBP + -0x58]
00862cc8 : CALL 0x00404350
00862ccd : ADD ESP,0x4
00862cd0 : MOV byte ptr [EBP + -0x4],0x6
00862cd4 : PUSH -0x1
00862cd6 : PUSH 0x0
00862cd8 : PUSH EAX
00862cd9 : LEA ECX,[EDI + 0x170]
00862cdf : CALL 0x00405eb0
00862ce4 : MOV byte ptr [EBP + -0x4],0x1
00862ce8 : MOV ECX,ESI
00862cea : CALL 0x00406560
00862cef : CALL 0x0084faa0
00862cf4 : MOVZX EDX,word ptr [EBX + 0x28a]
00862cfb : PUSH EDX
00862cfc : LEA EAX,[EBP + -0x2c]
00862cff : MOV ESI,EDI
00862d01 : CALL 0x0084fce0
00862d06 : MOV ECX,dword ptr [EDI + 0x168]
00862d0c : MOV byte ptr [EDI + 0x1a8],0x0
00862d13 : TEST ECX,ECX
00862d15 : JZ 0x00862d20
00862d17 : MOV EAX,dword ptr [ECX]
00862d19 : MOV EDX,dword ptr [EAX + 0x10]
00862d1c : PUSH 0x0
00862d1e : CALL EDX
00862d20 : MOV EDI,dword ptr [EDI + 0x16c]
00862d26 : TEST EDI,EDI
00862d28 : JZ 0x00862d35
00862d2a : MOV EAX,dword ptr [EDI]
00862d2c : MOV EDX,dword ptr [EAX + 0x10]
00862d2f : PUSH 0x0
00862d31 : MOV ECX,EDI
00862d33 : CALL EDX
00862d35 : MOV dword ptr [EBP + -0x4],0xffffffff
00862d3c : LEA ECX,[EBP + -0x2c]
00862d3f : CALL 0x00406560
00862d44 : MOV EAX,0x1
00862d49 : JMP 0x00862d4d
00862d4b : XOR EAX,EAX
00862d4d : MOV ECX,dword ptr [EBP + -0xc]
00862d50 : MOV dword ptr FS:[0x0],ECX
00862d57 : POP ECX
00862d58 : POP EDI
00862d59 : POP ESI
00862d5a : POP EBX
00862d5b : MOV ECX,dword ptr [EBP + -0x10]
00862d5e : XOR ECX,EBP
00862d60 : CALL 0x00633e6b
00862d65 : MOV ESP,EBP
00862d67 : POP EBP
00862d68 : RET 0x14

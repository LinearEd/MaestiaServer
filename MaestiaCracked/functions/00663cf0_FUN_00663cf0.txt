PROGRAM  : Maestia.exe
FUNCTION : FUN_00663cf0
ENTRY    : 00663cf0
BODY     : [[00663cf0, 00663da6]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00663cf0(int param_1)

{
  LPCRITICAL_SECTION lpCriticalSection;
  uint uVar1;
  int iVar2;
  void *local_c;
  undefined1 *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00b0c7d8;
  local_c = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xffffffec;
  ExceptionList = &local_c;
  lpCriticalSection = *(LPCRITICAL_SECTION *)(param_1 + 0x14);
  EnterCriticalSection(lpCriticalSection);
  local_4 = 0;
  if (*(int *)(*(int *)(param_1 + 0x1c) + 0x14) == 0) {
    if (*(int *)(param_1 + 0xc) == 0) {
      iVar2 = 1;
    }
    else {
      iVar2 = (**(code **)(*(int *)(param_1 + -0xc) + 0x2c))(uVar1);
      if (-1 < iVar2) {
        (**(code **)(**(int **)(param_1 + 0xc) + 8))(*(int **)(param_1 + 0xc));
        *(undefined4 *)(param_1 + 0xc) = 0;
        iVar2 = 0;
      }
    }
    LeaveCriticalSection(lpCriticalSection);
    ExceptionList = local_c;
    return iVar2;
  }
  LeaveCriticalSection(lpCriticalSection);
  ExceptionList = local_c;
  return -0x7ffbfddc;
}



============================================================
DISASSEMBLY
============================================================
00663cf0 : PUSH -0x1
00663cf2 : PUSH 0xb0c7d8
00663cf7 : MOV EAX,FS:[0x0]
00663cfd : PUSH EAX
00663cfe : PUSH EBX
00663cff : PUSH ESI
00663d00 : MOV EAX,[0x00d66fa0]
00663d05 : XOR EAX,ESP
00663d07 : PUSH EAX
00663d08 : LEA EAX,[ESP + 0xc]
00663d0c : MOV FS:[0x0],EAX
00663d12 : MOV ESI,dword ptr [ESP + 0x1c]
00663d16 : MOV EBX,dword ptr [ESI + 0x14]
00663d19 : PUSH EBX
00663d1a : MOV dword ptr [ESP + 0x20],EBX
00663d1e : CALL dword ptr [0x00b85118]
00663d24 : MOV EAX,dword ptr [ESI + 0x1c]
00663d27 : CMP dword ptr [EAX + 0x14],0x0
00663d2b : MOV dword ptr [ESP + 0x14],0x0
00663d33 : JZ 0x00663d55
00663d35 : PUSH EBX
00663d36 : CALL dword ptr [0x00b8511c]
00663d3c : MOV EAX,0x80040224
00663d41 : MOV ECX,dword ptr [ESP + 0xc]
00663d45 : MOV dword ptr FS:[0x0],ECX
00663d4c : POP ECX
00663d4d : POP ESI
00663d4e : POP EBX
00663d4f : ADD ESP,0xc
00663d52 : RET 0x4
00663d55 : ADD ESI,-0xc
00663d58 : CMP dword ptr [ESI + 0x18],0x0
00663d5c : JZ 0x00663d85
00663d5e : MOV EDX,dword ptr [ESI]
00663d60 : MOV EAX,dword ptr [EDX + 0x2c]
00663d63 : MOV ECX,ESI
00663d65 : CALL EAX
00663d67 : TEST EAX,EAX
00663d69 : JGE 0x00663d6f
00663d6b : MOV ESI,EAX
00663d6d : JMP 0x00663d8a
00663d6f : MOV EAX,dword ptr [ESI + 0x18]
00663d72 : MOV ECX,dword ptr [EAX]
00663d74 : MOV EDX,dword ptr [ECX + 0x8]
00663d77 : PUSH EAX
00663d78 : CALL EDX
00663d7a : MOV dword ptr [ESI + 0x18],0x0
00663d81 : XOR ESI,ESI
00663d83 : JMP 0x00663d8a
00663d85 : MOV ESI,0x1
00663d8a : PUSH EBX
00663d8b : CALL dword ptr [0x00b8511c]
00663d91 : MOV EAX,ESI
00663d93 : MOV ECX,dword ptr [ESP + 0xc]
00663d97 : MOV dword ptr FS:[0x0],ECX
00663d9e : POP ECX
00663d9f : POP ESI
00663da0 : POP EBX
00663da1 : ADD ESP,0xc
00663da4 : RET 0x4

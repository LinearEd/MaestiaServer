PROGRAM  : Maestia.exe
FUNCTION : FUN_007d59d0
ENTRY    : 007d59d0
BODY     : [[007d59d0, 007d5b59]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_007d59d0(undefined4 param_1)

{
  int *piVar1;
  int iVar2;
  int in_ECX;
  int extraout_ECX;
  int *piVar3;
  undefined **local_dc [47];
  undefined4 local_20;
  int *local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  puStack_c = &LAB_00b10082;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_8 = 0;
  local_20 = 0;
  local_14 = in_ECX;
  FUN_0079fd70(DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
  local_20 = 1;
  if (*(int *)(in_ECX + 8) != extraout_ECX) {
    EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  local_8 = 1;
  local_18 = *(int **)(in_ECX + 0x38);
  piVar3 = (int *)*local_18;
  if (piVar3 != local_18) {
    do {
      piVar1 = (int *)piVar3[9];
      iVar2 = (**(code **)(*piVar1 + 0x1c))();
      if (((iVar2 - 2U < 8) || (iVar2 = (**(code **)(*piVar1 + 0x1c))(), iVar2 - 5U < 3)) ||
         (iVar2 = (**(code **)(*piVar1 + 0x1c))(), iVar2 == 4)) {
        FUN_007d59d0(local_dc);
        local_8._0_1_ = 2;
        FUN_007a08e0();
        local_8 = CONCAT31(local_8._1_3_,1);
        local_dc[0] = &PTR_FUN_00cd083c;
      }
      piVar3 = (int *)*piVar3;
      in_ECX = local_14;
    } while (piVar3 != local_18);
  }
  local_8 = local_8 & 0xffffff00;
  if (*(int *)(in_ECX + 8) != 0) {
    LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  if (*(int *)(in_ECX + 8) != 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  local_8._1_3_ = 0;
  piVar3 = (int *)**(int **)(in_ECX + 0x188);
  if (piVar3 != *(int **)(in_ECX + 0x188)) {
    do {
      local_8._0_1_ = 3;
      (**(code **)(*(int *)piVar3[9] + 0x34))(local_dc);
      local_8._0_1_ = 4;
      FUN_004399a0();
      FUN_007a08e0();
      piVar3 = (int *)*piVar3;
      local_dc[0] = &PTR_FUN_00cd083c;
    } while (piVar3 != (int *)*(int *)(local_14 + 0x188));
  }
  local_8 = (uint)local_8._1_3_ << 8;
  if (*(int *)(local_14 + 8) != 0) {
    LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(local_14 + 8) + 4));
  }
  ExceptionList = local_10;
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
007d59d0 : PUSH EBP
007d59d1 : MOV EBP,ESP
007d59d3 : PUSH -0x1
007d59d5 : PUSH 0xb10082
007d59da : MOV EAX,FS:[0x0]
007d59e0 : PUSH EAX
007d59e1 : SUB ESP,0xcc
007d59e7 : PUSH EBX
007d59e8 : PUSH ESI
007d59e9 : PUSH EDI
007d59ea : MOV EAX,[0x00d66fa0]
007d59ef : XOR EAX,EBP
007d59f1 : PUSH EAX
007d59f2 : LEA EAX,[EBP + -0xc]
007d59f5 : MOV FS:[0x0],EAX
007d59fb : MOV EDI,ECX
007d59fd : MOV dword ptr [EBP + -0x10],EDI
007d5a00 : XOR ECX,ECX
007d5a02 : MOV dword ptr [EBP + -0x4],ECX
007d5a05 : MOV dword ptr [EBP + -0x1c],ECX
007d5a08 : MOV ESI,dword ptr [EBP + 0x8]
007d5a0b : MOV EAX,ESI
007d5a0d : CALL 0x0079fd70
007d5a12 : MOV dword ptr [EBP + -0x4],ECX
007d5a15 : MOV EAX,dword ptr [EDI + 0x8]
007d5a18 : MOV EBX,0x1
007d5a1d : MOV dword ptr [EBP + -0x1c],EBX
007d5a20 : MOV dword ptr [EBP + -0x18],EDI
007d5a23 : CMP EAX,ECX
007d5a25 : JZ 0x007d5a31
007d5a27 : ADD EAX,0x4
007d5a2a : PUSH EAX
007d5a2b : CALL dword ptr [0x00b85118]
007d5a31 : MOV dword ptr [EBP + -0x4],EBX
007d5a34 : MOV EAX,dword ptr [EDI + 0x38]
007d5a37 : MOV EBX,dword ptr [EAX]
007d5a39 : MOV dword ptr [EBP + -0x14],EAX
007d5a3c : CMP EBX,EAX
007d5a3e : JZ 0x007d5aa8
007d5a40 : MOV EDI,dword ptr [EBX + 0x24]
007d5a43 : MOV EAX,dword ptr [EDI]
007d5a45 : MOV EDX,dword ptr [EAX + 0x1c]
007d5a48 : MOV ECX,EDI
007d5a4a : CALL EDX
007d5a4c : ADD EAX,-0x2
007d5a4f : CMP EAX,0x7
007d5a52 : JBE 0x007d5a73
007d5a54 : MOV EAX,dword ptr [EDI]
007d5a56 : MOV EDX,dword ptr [EAX + 0x1c]
007d5a59 : MOV ECX,EDI
007d5a5b : CALL EDX
007d5a5d : ADD EAX,-0x5
007d5a60 : CMP EAX,0x2
007d5a63 : JBE 0x007d5a73
007d5a65 : MOV EAX,dword ptr [EDI]
007d5a67 : MOV EDX,dword ptr [EAX + 0x1c]
007d5a6a : MOV ECX,EDI
007d5a6c : CALL EDX
007d5a6e : CMP EAX,0x4
007d5a71 : JNZ 0x007d5a9e
007d5a73 : LEA EAX,[EBP + 0xffffff28]
007d5a79 : PUSH EAX
007d5a7a : MOV ECX,EDI
007d5a7c : CALL 0x007d59d0
007d5a81 : MOV byte ptr [EBP + -0x4],0x2
007d5a85 : LEA EDI,[EBP + 0xffffff28]
007d5a8b : CALL 0x007a08e0
007d5a90 : MOV byte ptr [EBP + -0x4],0x1
007d5a94 : MOV dword ptr [EBP + 0xffffff28],0xcd083c
007d5a9e : MOV EBX,dword ptr [EBX]
007d5aa0 : CMP EBX,dword ptr [EBP + -0x14]
007d5aa3 : JNZ 0x007d5a40
007d5aa5 : MOV EDI,dword ptr [EBP + -0x10]
007d5aa8 : MOV byte ptr [EBP + -0x4],0x0
007d5aac : MOV EAX,dword ptr [EDI + 0x8]
007d5aaf : TEST EAX,EAX
007d5ab1 : JZ 0x007d5abd
007d5ab3 : ADD EAX,0x4
007d5ab6 : PUSH EAX
007d5ab7 : CALL dword ptr [0x00b8511c]
007d5abd : MOV EAX,dword ptr [EDI + 0x8]
007d5ac0 : MOV dword ptr [EBP + -0x18],EDI
007d5ac3 : TEST EAX,EAX
007d5ac5 : JZ 0x007d5ad1
007d5ac7 : ADD EAX,0x4
007d5aca : PUSH EAX
007d5acb : CALL dword ptr [0x00b85118]
007d5ad1 : MOV dword ptr [EBP + -0x4],0x3
007d5ad8 : MOV EDI,dword ptr [EDI + 0x188]
007d5ade : MOV EBX,dword ptr [EDI]
007d5ae0 : CMP EBX,EDI
007d5ae2 : JZ 0x007d5b2c
007d5ae4 : MOV ECX,dword ptr [EBX + 0x24]
007d5ae7 : MOV EDX,dword ptr [ECX]
007d5ae9 : MOV EDX,dword ptr [EDX + 0x34]
007d5aec : LEA EAX,[EBP + 0xffffff28]
007d5af2 : PUSH EAX
007d5af3 : CALL EDX
007d5af5 : MOV byte ptr [EBP + -0x4],0x4
007d5af9 : LEA ECX,[EBP + 0xffffff28]
007d5aff : MOV EAX,ESI
007d5b01 : CALL 0x004399a0
007d5b06 : LEA EDI,[EBP + 0xffffff28]
007d5b0c : CALL 0x007a08e0
007d5b11 : MOV byte ptr [EBP + -0x4],0x3
007d5b15 : MOV EBX,dword ptr [EBX]
007d5b17 : MOV EAX,dword ptr [EBP + -0x10]
007d5b1a : MOV dword ptr [EBP + 0xffffff28],0xcd083c
007d5b24 : CMP EBX,dword ptr [EAX + 0x188]
007d5b2a : JNZ 0x007d5ae4
007d5b2c : MOV byte ptr [EBP + -0x4],0x0
007d5b30 : MOV ECX,dword ptr [EBP + -0x10]
007d5b33 : MOV EAX,dword ptr [ECX + 0x8]
007d5b36 : TEST EAX,EAX
007d5b38 : JZ 0x007d5b44
007d5b3a : ADD EAX,0x4
007d5b3d : PUSH EAX
007d5b3e : CALL dword ptr [0x00b8511c]
007d5b44 : MOV EAX,ESI
007d5b46 : MOV ECX,dword ptr [EBP + -0xc]
007d5b49 : MOV dword ptr FS:[0x0],ECX
007d5b50 : POP ECX
007d5b51 : POP EDI
007d5b52 : POP ESI
007d5b53 : POP EBX
007d5b54 : MOV ESP,EBP
007d5b56 : POP EBP
007d5b57 : RET 0x4

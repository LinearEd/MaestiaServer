PROGRAM  : Maestia.exe
FUNCTION : FUN_0041b4b0
ENTRY    : 0041b4b0
BODY     : [[0041b4b0, 0041b539]]

============================================================
DECOMPILED C CODE
============================================================

ushort * FUN_0041b4b0(ushort *param_1,undefined4 *param_2,ushort param_3,undefined1 param_4)

{
  int iVar1;
  undefined4 *puVar2;
  
  *param_1 = 0;
  *(undefined1 *)((int)param_1 + 7) = 0;
  *(undefined1 *)(param_1 + 4) = 0;
  *(undefined1 *)((int)param_1 + 9) = 0;
  *(undefined1 *)(param_1 + 5) = 0;
  *(undefined1 *)((int)param_1 + 0xb) = 0;
  param_1[6] = 0;
  *(undefined1 *)(param_1 + 7) = 0;
  *(undefined1 *)((int)param_1 + 0xf) = 0;
  *(undefined1 *)(param_1 + 8) = 0;
  *(undefined2 *)((int)param_1 + 0x11) = 0;
  *(undefined1 *)(param_1 + 1) = 0x61;
  *(undefined1 *)((int)param_1 + 3) = 1;
  puVar2 = (undefined4 *)((int)param_1 + 7);
  for (iVar1 = 0x16; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar2 = *param_2;
    param_2 = param_2 + 1;
    puVar2 = puVar2 + 1;
  }
  *(undefined2 *)puVar2 = *(undefined2 *)param_2;
  param_1[2] = param_3;
  *(undefined1 *)(param_1 + 3) = param_4;
  _memset((void *)((int)param_1 + 99),0,0x800);
  *param_1 = *param_1 ^ (param_1[6] * 2 + 99 ^ *param_1) & 0x1fff;
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
0041b4b0 : PUSH EBP
0041b4b1 : MOV EBP,ESP
0041b4b3 : XOR EAX,EAX
0041b4b5 : PUSH EBX
0041b4b6 : MOV EBX,dword ptr [EBP + 0x8]
0041b4b9 : MOV word ptr [EBX],AX
0041b4bc : PUSH ESI
0041b4bd : MOV ESI,dword ptr [EBP + 0xc]
0041b4c0 : PUSH EDI
0041b4c1 : LEA EDI,[EBX + 0x7]
0041b4c4 : MOV byte ptr [EDI],AL
0041b4c6 : MOV byte ptr [EDI + 0x1],AL
0041b4c9 : MOV byte ptr [EDI + 0x2],AL
0041b4cc : MOV byte ptr [EDI + 0x3],AL
0041b4cf : MOV byte ptr [EDI + 0x4],AL
0041b4d2 : XOR ECX,ECX
0041b4d4 : MOV word ptr [EDI + 0x5],CX
0041b4d8 : MOV byte ptr [EDI + 0x7],AL
0041b4db : MOV byte ptr [EDI + 0x8],AL
0041b4de : MOV byte ptr [EDI + 0x9],AL
0041b4e1 : XOR EDX,EDX
0041b4e3 : MOV word ptr [EDI + 0xa],DX
0041b4e7 : MOV DL,byte ptr [EBP + 0x14]
0041b4ea : MOV byte ptr [EBX + 0x2],0x61
0041b4ee : MOV byte ptr [EBX + 0x3],0x1
0041b4f2 : MOV ECX,0x16
0041b4f7 : MOVSD.REP ES:EDI,ESI
0041b4f9 : MOV CX,word ptr [EBP + 0x10]
0041b4fd : PUSH 0x800
0041b502 : PUSH EAX
0041b503 : LEA EAX,[EBX + 0x63]
0041b506 : MOVSW ES:EDI,ESI
0041b508 : PUSH EAX
0041b509 : MOV word ptr [EBX + 0x4],CX
0041b50d : MOV byte ptr [EBX + 0x6],DL
0041b510 : CALL 0x0063b700
0041b515 : MOVZX ECX,word ptr [EBX + 0xc]
0041b519 : ADD CX,CX
0041b51c : ADD CX,0x63
0041b520 : XOR CX,word ptr [EBX]
0041b523 : ADD ESP,0xc
0041b526 : MOV EDX,0x1fff
0041b52b : POP EDI
0041b52c : AND CX,DX
0041b52f : XOR word ptr [EBX],CX
0041b532 : POP ESI
0041b533 : MOV EAX,EBX
0041b535 : POP EBX
0041b536 : POP EBP
0041b537 : RET 0x10

PROGRAM  : Maestia.exe
FUNCTION : FUN_008167d0
ENTRY    : 008167d0
BODY     : [[008167d0, 00816816] [00816820, 00816a0f]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_008167d0(undefined4 param_1)

{
  short sVar1;
  char cVar2;
  uint uVar3;
  short *psVar4;
  undefined4 *puVar5;
  int *in_ECX;
  uint uVar6;
  undefined1 local_2058 [8];
  undefined1 local_2050 [4];
  undefined2 local_204c;
  undefined4 local_203c;
  uint local_2038;
  undefined4 local_2034;
  undefined4 *local_2030;
  int local_202c;
  undefined4 local_2028;
  undefined4 local_2024;
  uint local_2020;
  undefined4 *local_201c;
  short local_2018;
  undefined1 local_2016 [8190];
  uint local_18;
  undefined4 uStack_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3d02b;
  local_10 = ExceptionList;
  uStack_14 = 0x8167eb;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_2024 = param_1;
  local_201c = (undefined4 *)0x0;
  local_18 = uVar3;
  while (((uint)in_ECX[9] < (uint)in_ECX[8] &&
         (cVar2 = (**(code **)(*in_ECX + 0x1c))(&local_202c,uVar3), cVar2 != '\0'))) {
    if (local_202c == 0x5121) {
      local_201c = (undefined4 *)FUN_006f0760(0x18,"",0,(DAT_01725270 >> 3 & 1) == 0);
      local_8 = 0;
      if (local_201c == (undefined4 *)0x0) {
        puVar5 = (undefined4 *)0x0;
      }
      else {
        puVar5 = (undefined4 *)FUN_004531f0(local_201c);
      }
      local_8 = 0xffffffff;
      local_201c = puVar5;
      (**(code **)(*in_ECX + 0xc))(puVar5,2,1);
      (**(code **)(*in_ECX + 0xc))(puVar5 + 1,2,1);
      local_2034 = *puVar5;
      local_2030 = puVar5;
      FUN_00451e00(local_2058,&local_2034);
    }
    else if (local_202c == 0x5122) {
      local_2020 = 0;
      (**(code **)(*in_ECX + 0xc))(&local_2020,1,1);
      uVar6 = 0;
      if (local_2020 != 0) {
        do {
          FUN_0070d080(&local_2018);
          psVar4 = &local_2018;
          local_2038 = 7;
          local_203c = 0;
          local_204c = 0;
          do {
            sVar1 = *psVar4;
            psVar4 = psVar4 + 1;
          } while (sVar1 != 0);
          FUN_00406360(&local_2018,(int)psVar4 - (int)local_2016 >> 1);
          local_8 = 1;
          FUN_00405ae0(local_2050);
          local_8 = 0xffffffff;
          if (7 < local_2038) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          uVar6 = uVar6 + 1;
          local_2038 = 7;
          local_203c = 0;
          local_204c = 0;
        } while (uVar6 < local_2020);
      }
    }
    else {
      if (local_202c == 0x5123) break;
      (**(code **)(*in_ECX + 0x24))(local_2028);
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008167d0 : PUSH EBP
008167d1 : MOV EBP,ESP
008167d3 : PUSH -0x1
008167d5 : PUSH 0xb3d02b
008167da : MOV EAX,FS:[0x0]
008167e0 : PUSH EAX
008167e1 : MOV EAX,0x2048
008167e6 : CALL 0x0063b780
008167eb : MOV EAX,[0x00d66fa0]
008167f0 : XOR EAX,EBP
008167f2 : MOV dword ptr [EBP + -0x14],EAX
008167f5 : PUSH EBX
008167f6 : PUSH ESI
008167f7 : PUSH EDI
008167f8 : PUSH EAX
008167f9 : LEA EAX,[EBP + -0xc]
008167fc : MOV FS:[0x0],EAX
00816802 : MOV EAX,dword ptr [EBP + 0x8]
00816805 : XOR EBX,EBX
00816807 : MOV dword ptr [EBP + 0xffffdfe0],EAX
0081680d : MOV EDI,ECX
0081680f : MOV dword ptr [EBP + 0xffffdfe8],EBX
00816815 : JMP 0x00816820
00816820 : MOV ECX,dword ptr [EDI + 0x24]
00816823 : CMP ECX,dword ptr [EDI + 0x20]
00816826 : JNC 0x008169f2
0081682c : MOV EDX,dword ptr [EDI]
0081682e : MOV EDX,dword ptr [EDX + 0x1c]
00816831 : LEA EAX,[EBP + 0xffffdfd8]
00816837 : PUSH EAX
00816838 : MOV ECX,EDI
0081683a : CALL EDX
0081683c : TEST AL,AL
0081683e : JZ 0x008169f2
00816844 : MOV EAX,dword ptr [EBP + 0xffffdfd8]
0081684a : SUB EAX,0x5121
0081684f : JZ 0x00816957
00816855 : SUB EAX,0x1
00816858 : JZ 0x00816875
0081685a : SUB EAX,0x1
0081685d : JZ 0x008169f2
00816863 : MOV ECX,dword ptr [EBP + 0xffffdfdc]
00816869 : MOV EAX,dword ptr [EDI]
0081686b : MOV EDX,dword ptr [EAX + 0x24]
0081686e : PUSH ECX
0081686f : MOV ECX,EDI
00816871 : CALL EDX
00816873 : JMP 0x00816820
00816875 : MOV EAX,dword ptr [EDI]
00816877 : MOV EDX,dword ptr [EAX + 0xc]
0081687a : PUSH 0x1
0081687c : PUSH 0x1
0081687e : LEA ECX,[EBP + 0xffffdfe4]
00816884 : PUSH ECX
00816885 : MOV ECX,EDI
00816887 : MOV dword ptr [EBP + 0xffffdfe4],EBX
0081688d : CALL EDX
0081688f : XOR ESI,ESI
00816891 : CMP dword ptr [EBP + 0xffffdfe4],EBX
00816897 : JBE 0x00816820
00816899 : MOV EBX,dword ptr [EBP + 0xffffdfe8]
0081689f : ADD EBX,0x8
008168a2 : LEA EAX,[EBP + 0xffffdfec]
008168a8 : PUSH EAX
008168a9 : CALL 0x0070d080
008168ae : XOR ECX,ECX
008168b0 : LEA EAX,[EBP + 0xffffdfec]
008168b6 : MOV dword ptr [EBP + 0xffffdfcc],0x7
008168c0 : MOV dword ptr [EBP + 0xffffdfc8],0x0
008168ca : MOV word ptr [EBP + 0xffffdfb8],CX
008168d1 : LEA EDX,[EAX + 0x2]
008168d4 : MOV CX,word ptr [EAX]
008168d7 : ADD EAX,0x2
008168da : TEST CX,CX
008168dd : JNZ 0x008168d4
008168df : SUB EAX,EDX
008168e1 : SAR EAX,0x1
008168e3 : PUSH EAX
008168e4 : LEA EDX,[EBP + 0xffffdfec]
008168ea : PUSH EDX
008168eb : LEA ECX,[EBP + 0xffffdfb4]
008168f1 : CALL 0x00406360
008168f6 : MOV dword ptr [EBP + -0x4],0x1
008168fd : LEA EAX,[EBP + 0xffffdfb4]
00816903 : PUSH EAX
00816904 : MOV EAX,EBX
00816906 : CALL 0x00405ae0
0081690b : MOV dword ptr [EBP + -0x4],0xffffffff
00816912 : CMP dword ptr [EBP + 0xffffdfcc],0x8
00816919 : JC 0x00816926
0081691b : MOV ECX,dword ptr [EBP + 0xffffdfb8]
00816921 : CALL 0x006f04e0
00816926 : XOR ECX,ECX
00816928 : INC ESI
00816929 : MOV dword ptr [EBP + 0xffffdfcc],0x7
00816933 : MOV dword ptr [EBP + 0xffffdfc8],0x0
0081693d : MOV word ptr [EBP + 0xffffdfb8],CX
00816944 : CMP ESI,dword ptr [EBP + 0xffffdfe4]
0081694a : JC 0x008168a2
00816950 : XOR EBX,EBX
00816952 : JMP 0x00816820
00816957 : MOV EDX,dword ptr [0x01725270]
0081695d : SHR EDX,0x3
00816960 : MOV EAX,0x0
00816965 : AND EDX,0x1
00816968 : SETZ AL
0081696b : PUSH EAX
0081696c : PUSH EBX
0081696d : PUSH 0xbf1a4a
00816972 : PUSH 0x18
00816974 : CALL 0x006f0760
00816979 : ADD ESP,0x10
0081697c : MOV dword ptr [EBP + 0xffffdfe8],EAX
00816982 : MOV dword ptr [EBP + -0x4],EBX
00816985 : CMP EAX,EBX
00816987 : JZ 0x00816993
00816989 : PUSH EAX
0081698a : CALL 0x004531f0
0081698f : MOV ESI,EAX
00816991 : JMP 0x00816995
00816993 : XOR ESI,ESI
00816995 : MOV dword ptr [EBP + -0x4],0xffffffff
0081699c : MOV EDX,dword ptr [EDI]
0081699e : MOV EAX,dword ptr [EDX + 0xc]
008169a1 : PUSH 0x1
008169a3 : PUSH 0x2
008169a5 : PUSH ESI
008169a6 : MOV ECX,EDI
008169a8 : MOV dword ptr [EBP + 0xffffdfe8],ESI
008169ae : CALL EAX
008169b0 : MOV EDX,dword ptr [EDI]
008169b2 : MOV EDX,dword ptr [EDX + 0xc]
008169b5 : PUSH 0x1
008169b7 : PUSH 0x2
008169b9 : LEA EAX,[ESI + 0x4]
008169bc : PUSH EAX
008169bd : MOV ECX,EDI
008169bf : CALL EDX
008169c1 : MOV EAX,dword ptr [ESI]
008169c3 : MOV dword ptr [EBP + 0xffffdfd0],EAX
008169c9 : MOV EAX,dword ptr [EBP + 0xffffdfe0]
008169cf : LEA ECX,[EBP + 0xffffdfd0]
008169d5 : PUSH ECX
008169d6 : LEA EDX,[EBP + 0xffffdfac]
008169dc : PUSH EDX
008169dd : ADD EAX,0xa4
008169e2 : MOV dword ptr [EBP + 0xffffdfd4],ESI
008169e8 : CALL 0x00451e00
008169ed : JMP 0x00816820
008169f2 : MOV ECX,dword ptr [EBP + -0xc]
008169f5 : MOV dword ptr FS:[0x0],ECX
008169fc : POP ECX
008169fd : POP EDI
008169fe : POP ESI
008169ff : POP EBX
00816a00 : MOV ECX,dword ptr [EBP + -0x14]
00816a03 : XOR ECX,EBP
00816a05 : CALL 0x00633e6b
00816a0a : MOV ESP,EBP
00816a0c : POP EBP
00816a0d : RET 0x4

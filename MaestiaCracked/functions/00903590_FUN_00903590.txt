PROGRAM  : Maestia.exe
FUNCTION : FUN_00903590
ENTRY    : 00903590
BODY     : [[00903590, 00903885]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00903590(int param_1,int param_2)

{
  wchar_t wVar1;
  uint uVar2;
  char cVar3;
  int iVar4;
  undefined4 uVar5;
  wchar_t *pwVar6;
  int in_ECX;
  wchar_t *pwVar7;
  wchar_t *pwVar8;
  bool bVar9;
  undefined1 local_60 [16];
  undefined1 local_50 [60];
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b601f6;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  uVar2 = *(uint *)(param_1 + 0x18);
  pwVar6 = (wchar_t *)(param_1 + 4);
  pwVar8 = pwVar6;
  if (7 < uVar2) {
    pwVar8 = *(wchar_t **)pwVar6;
  }
  pwVar7 = L"PopupTrade";
  do {
    wVar1 = *pwVar8;
    bVar9 = (ushort)wVar1 < (ushort)*pwVar7;
    if (wVar1 != *pwVar7) {
LAB_00903606:
      iVar4 = (1 - (uint)bVar9) - (uint)(bVar9 != 0);
      goto LAB_0090360b;
    }
    if (wVar1 == L'\0') break;
    wVar1 = pwVar8[1];
    bVar9 = (ushort)wVar1 < (ushort)pwVar7[1];
    if (wVar1 != pwVar7[1]) goto LAB_00903606;
    pwVar8 = pwVar8 + 2;
    pwVar7 = pwVar7 + 2;
  } while (wVar1 != L'\0');
  iVar4 = 0;
LAB_0090360b:
  if (iVar4 != 0) {
    pwVar8 = pwVar6;
    if (7 < uVar2) {
      pwVar8 = *(wchar_t **)pwVar6;
    }
    pwVar7 = L"PopupParty";
    do {
      wVar1 = *pwVar8;
      bVar9 = (ushort)wVar1 < (ushort)*pwVar7;
      if (wVar1 != *pwVar7) {
LAB_00903649:
        iVar4 = (1 - (uint)bVar9) - (uint)(bVar9 != 0);
        goto LAB_0090364e;
      }
      if (wVar1 == L'\0') break;
      wVar1 = pwVar8[1];
      bVar9 = (ushort)wVar1 < (ushort)pwVar7[1];
      if (wVar1 != pwVar7[1]) goto LAB_00903649;
      pwVar8 = pwVar8 + 2;
      pwVar7 = pwVar7 + 2;
    } while (wVar1 != L'\0');
    iVar4 = 0;
LAB_0090364e:
    if (iVar4 == 0) {
      if ((*(int *)(*DAT_00da9894 + 0x14c) != 0) &&
         (iVar4 = *(int *)(*(int *)(*DAT_00da9894 + 0x14c) + 0x94), iVar4 != 0)) {
        FUN_00959ab0(iVar4);
        ExceptionList = local_14;
        return;
      }
    }
    else {
      pwVar8 = pwVar6;
      if (7 < uVar2) {
        pwVar8 = *(wchar_t **)pwVar6;
      }
      pwVar7 = L"Popup";
      do {
        wVar1 = *pwVar8;
        bVar9 = (ushort)wVar1 < (ushort)*pwVar7;
        if (wVar1 != *pwVar7) {
LAB_009036cb:
          iVar4 = (1 - (uint)bVar9) - (uint)(bVar9 != 0);
          goto LAB_009036d0;
        }
        if (wVar1 == L'\0') break;
        wVar1 = pwVar8[1];
        bVar9 = (ushort)wVar1 < (ushort)pwVar7[1];
        if (wVar1 != pwVar7[1]) goto LAB_009036cb;
        pwVar8 = pwVar8 + 2;
        pwVar7 = pwVar7 + 2;
      } while (wVar1 != L'\0');
      iVar4 = 0;
LAB_009036d0:
      if (iVar4 == 0) {
        if (param_2 != 0) {
          FUN_00406460(&DAT_00c63710);
          local_c = 0;
          uVar5 = FUN_00404350(param_2);
          local_c._0_1_ = 1;
          FUN_0070cd60(local_60,uVar5,local_50,0);
          local_c._0_1_ = 3;
          FUN_00406560();
          local_c = CONCAT31(local_c._1_3_,4);
          FUN_00406560();
          FUN_00902860(*(undefined4 *)(in_ECX + 0x38));
          local_c = 0xffffffff;
          FUN_004042c0();
          ExceptionList = local_14;
          return;
        }
      }
      else {
        pwVar8 = pwVar6;
        if (7 < uVar2) {
          pwVar8 = *(wchar_t **)pwVar6;
        }
        pwVar7 = L"onInit";
        do {
          wVar1 = *pwVar8;
          bVar9 = (ushort)wVar1 < (ushort)*pwVar7;
          if (wVar1 != *pwVar7) {
LAB_009037a7:
            iVar4 = (1 - (uint)bVar9) - (uint)(bVar9 != 0);
            goto LAB_009037ac;
          }
          if (wVar1 == L'\0') break;
          wVar1 = pwVar8[1];
          bVar9 = (ushort)wVar1 < (ushort)pwVar7[1];
          if (wVar1 != pwVar7[1]) goto LAB_009037a7;
          pwVar8 = pwVar8 + 2;
          pwVar7 = pwVar7 + 2;
        } while (wVar1 != L'\0');
        iVar4 = 0;
LAB_009037ac:
        if (iVar4 == 0) {
          FUN_00901e60();
          ExceptionList = local_14;
          return;
        }
        if (7 < uVar2) {
          pwVar6 = *(wchar_t **)pwVar6;
        }
        pwVar8 = L"PeepWall";
        do {
          wVar1 = *pwVar6;
          bVar9 = (ushort)wVar1 < (ushort)*pwVar8;
          if (wVar1 != *pwVar8) {
LAB_00903806:
            iVar4 = (1 - (uint)bVar9) - (uint)(bVar9 != 0);
            goto LAB_0090380b;
          }
          if (wVar1 == L'\0') break;
          wVar1 = pwVar6[1];
          bVar9 = (ushort)wVar1 < (ushort)pwVar8[1];
          if (wVar1 != pwVar8[1]) goto LAB_00903806;
          pwVar6 = pwVar6 + 2;
          pwVar8 = pwVar8 + 2;
        } while (wVar1 != L'\0');
        iVar4 = 0;
LAB_0090380b:
        if (iVar4 == 0) {
          FUN_00954400(0,*(undefined4 *)(DAT_00da93ec + 0x24c));
          ExceptionList = local_14;
          return;
        }
        cVar3 = FUN_00403810(DAT_00d66fa0 ^ (uint)&stack0xffffff90);
        if ((cVar3 != '\0') && (*(int *)(in_ECX + 0xe0) != 0)) {
          FUN_00a0d390(DAT_017247d4,1);
        }
      }
    }
  }
  ExceptionList = local_14;
  return;
}



============================================================
DISASSEMBLY
============================================================
00903590 : PUSH EBP
00903591 : MOV EBP,ESP
00903593 : AND ESP,0xfffffff8
00903596 : PUSH -0x1
00903598 : PUSH 0xb601f6
0090359d : MOV EAX,FS:[0x0]
009035a3 : PUSH EAX
009035a4 : SUB ESP,0x50
009035a7 : PUSH EBX
009035a8 : PUSH ESI
009035a9 : PUSH EDI
009035aa : MOV EAX,[0x00d66fa0]
009035af : XOR EAX,ESP
009035b1 : PUSH EAX
009035b2 : LEA EAX,[ESP + 0x60]
009035b6 : MOV FS:[0x0],EAX
009035bc : MOV dword ptr [ESP + 0x10],ECX
009035c0 : MOV EDI,dword ptr [EBP + 0x8]
009035c3 : MOV ECX,dword ptr [EDI + 0x18]
009035c6 : LEA EBX,[EDI + 0x4]
009035c9 : CMP ECX,0x8
009035cc : JC 0x009035d2
009035ce : MOV EAX,dword ptr [EBX]
009035d0 : JMP 0x009035d4
009035d2 : MOV EAX,EBX
009035d4 : MOV EDX,0xc636d4
009035d9 : LEA ESP,[ESP]
009035e0 : MOV SI,word ptr [EAX]
009035e3 : CMP SI,word ptr [EDX]
009035e6 : JNZ 0x00903606
009035e8 : TEST SI,SI
009035eb : JZ 0x00903602
009035ed : MOV SI,word ptr [EAX + 0x2]
009035f1 : CMP SI,word ptr [EDX + 0x2]
009035f5 : JNZ 0x00903606
009035f7 : ADD EAX,0x4
009035fa : ADD EDX,0x4
009035fd : TEST SI,SI
00903600 : JNZ 0x009035e0
00903602 : XOR EAX,EAX
00903604 : JMP 0x0090360b
00903606 : SBB EAX,EAX
00903608 : SBB EAX,-0x1
0090360b : TEST EAX,EAX
0090360d : JZ 0x00903871
00903613 : CMP ECX,0x8
00903616 : JC 0x0090361c
00903618 : MOV EAX,dword ptr [EBX]
0090361a : JMP 0x0090361e
0090361c : MOV EAX,EBX
0090361e : MOV EDX,0xc636ec
00903623 : MOV SI,word ptr [EAX]
00903626 : CMP SI,word ptr [EDX]
00903629 : JNZ 0x00903649
0090362b : TEST SI,SI
0090362e : JZ 0x00903645
00903630 : MOV SI,word ptr [EAX + 0x2]
00903634 : CMP SI,word ptr [EDX + 0x2]
00903638 : JNZ 0x00903649
0090363a : ADD EAX,0x4
0090363d : ADD EDX,0x4
00903640 : TEST SI,SI
00903643 : JNZ 0x00903623
00903645 : XOR EAX,EAX
00903647 : JMP 0x0090364e
00903649 : SBB EAX,EAX
0090364b : SBB EAX,-0x1
0090364e : TEST EAX,EAX
00903650 : JNZ 0x00903695
00903652 : MOV EAX,[0x00da9894]
00903657 : MOV ECX,dword ptr [EAX]
00903659 : MOV EAX,dword ptr [ECX + 0x14c]
0090365f : TEST EAX,EAX
00903661 : JZ 0x00903871
00903667 : MOV EAX,dword ptr [EAX + 0x94]
0090366d : TEST EAX,EAX
0090366f : JZ 0x00903871
00903675 : PUSH EAX
00903676 : MOV ECX,0x2969
0090367b : CALL 0x00959ab0
00903680 : MOV ECX,dword ptr [ESP + 0x60]
00903684 : MOV dword ptr FS:[0x0],ECX
0090368b : POP ECX
0090368c : POP EDI
0090368d : POP ESI
0090368e : POP EBX
0090368f : MOV ESP,EBP
00903691 : POP EBP
00903692 : RET 0x8
00903695 : CMP ECX,0x8
00903698 : JC 0x0090369e
0090369a : MOV EAX,dword ptr [EBX]
0090369c : JMP 0x009036a0
0090369e : MOV EAX,EBX
009036a0 : MOV EDX,0xc63704
009036a5 : MOV SI,word ptr [EAX]
009036a8 : CMP SI,word ptr [EDX]
009036ab : JNZ 0x009036cb
009036ad : TEST SI,SI
009036b0 : JZ 0x009036c7
009036b2 : MOV SI,word ptr [EAX + 0x2]
009036b6 : CMP SI,word ptr [EDX + 0x2]
009036ba : JNZ 0x009036cb
009036bc : ADD EAX,0x4
009036bf : ADD EDX,0x4
009036c2 : TEST SI,SI
009036c5 : JNZ 0x009036a5
009036c7 : XOR EAX,EAX
009036c9 : JMP 0x009036d0
009036cb : SBB EAX,EAX
009036cd : SBB EAX,-0x1
009036d0 : TEST EAX,EAX
009036d2 : JNZ 0x00903771
009036d8 : MOV ESI,dword ptr [EBP + 0xc]
009036db : TEST ESI,ESI
009036dd : JZ 0x00903871
009036e3 : PUSH 0xc63710
009036e8 : LEA ECX,[ESP + 0x28]
009036ec : CALL 0x00406460
009036f1 : MOV dword ptr [ESP + 0x68],0x0
009036f9 : PUSH ESI
009036fa : LEA ESI,[ESP + 0x44]
009036fe : CALL 0x00404350
00903703 : ADD ESP,0x4
00903706 : MOV byte ptr [ESP + 0x68],0x1
0090370b : PUSH 0x0
0090370d : LEA EDX,[ESP + 0x28]
00903711 : PUSH EDX
00903712 : PUSH EAX
00903713 : LEA EAX,[ESP + 0x20]
00903717 : PUSH EAX
00903718 : CALL 0x0070cd60
0090371d : ADD ESP,0x10
00903720 : MOV byte ptr [ESP + 0x68],0x3
00903725 : MOV ECX,ESI
00903727 : CALL 0x00406560
0090372c : MOV byte ptr [ESP + 0x68],0x4
00903731 : LEA ECX,[ESP + 0x24]
00903735 : CALL 0x00406560
0090373a : MOV ECX,dword ptr [ESP + 0x10]
0090373e : MOV EDX,dword ptr [ECX + 0x38]
00903741 : PUSH EDX
00903742 : LEA ECX,[ESP + 0x18]
00903746 : CALL 0x00902860
0090374b : MOV dword ptr [ESP + 0x68],0xffffffff
00903753 : LEA ESI,[ESP + 0x14]
00903757 : CALL 0x004042c0
0090375c : MOV ECX,dword ptr [ESP + 0x60]
00903760 : MOV dword ptr FS:[0x0],ECX
00903767 : POP ECX
00903768 : POP EDI
00903769 : POP ESI
0090376a : POP EBX
0090376b : MOV ESP,EBP
0090376d : POP EBP
0090376e : RET 0x8
00903771 : CMP ECX,0x8
00903774 : JC 0x0090377a
00903776 : MOV EAX,dword ptr [EBX]
00903778 : JMP 0x0090377c
0090377a : MOV EAX,EBX
0090377c : MOV EDX,0xc63714
00903781 : MOV SI,word ptr [EAX]
00903784 : CMP SI,word ptr [EDX]
00903787 : JNZ 0x009037a7
00903789 : TEST SI,SI
0090378c : JZ 0x009037a3
0090378e : MOV SI,word ptr [EAX + 0x2]
00903792 : CMP SI,word ptr [EDX + 0x2]
00903796 : JNZ 0x009037a7
00903798 : ADD EAX,0x4
0090379b : ADD EDX,0x4
0090379e : TEST SI,SI
009037a1 : JNZ 0x00903781
009037a3 : XOR EAX,EAX
009037a5 : JMP 0x009037ac
009037a7 : SBB EAX,EAX
009037a9 : SBB EAX,-0x1
009037ac : TEST EAX,EAX
009037ae : JNZ 0x009037ce
009037b0 : MOV EDI,dword ptr [ESP + 0x10]
009037b4 : CALL 0x00901e60
009037b9 : MOV ECX,dword ptr [ESP + 0x60]
009037bd : MOV dword ptr FS:[0x0],ECX
009037c4 : POP ECX
009037c5 : POP EDI
009037c6 : POP ESI
009037c7 : POP EBX
009037c8 : MOV ESP,EBP
009037ca : POP EBP
009037cb : RET 0x8
009037ce : CMP ECX,0x8
009037d1 : JC 0x009037d7
009037d3 : MOV EAX,dword ptr [EBX]
009037d5 : JMP 0x009037d9
009037d7 : MOV EAX,EBX
009037d9 : MOV EDX,0xc63724
009037de : MOV EDI,EDI
009037e0 : MOV SI,word ptr [EAX]
009037e3 : CMP SI,word ptr [EDX]
009037e6 : JNZ 0x00903806
009037e8 : TEST SI,SI
009037eb : JZ 0x00903802
009037ed : MOV SI,word ptr [EAX + 0x2]
009037f1 : CMP SI,word ptr [EDX + 0x2]
009037f5 : JNZ 0x00903806
009037f7 : ADD EAX,0x4
009037fa : ADD EDX,0x4
009037fd : TEST SI,SI
00903800 : JNZ 0x009037e0
00903802 : XOR EAX,EAX
00903804 : JMP 0x0090380b
00903806 : SBB EAX,EAX
00903808 : SBB EAX,-0x1
0090380b : TEST EAX,EAX
0090380d : JNZ 0x00903845
0090380f : MOV EAX,[0x00da93ec]
00903814 : MOV ECX,dword ptr [EAX + 0x24c]
0090381a : MOV EDX,dword ptr [0x00da9894]
00903820 : MOV EAX,dword ptr [EDX]
00903822 : PUSH ECX
00903823 : MOV ECX,dword ptr [EAX + 0x254]
00903829 : PUSH 0x0
0090382b : CALL 0x00954400
00903830 : MOV ECX,dword ptr [ESP + 0x60]
00903834 : MOV dword ptr FS:[0x0],ECX
0090383b : POP ECX
0090383c : POP EDI
0090383d : POP ESI
0090383e : POP EBX
0090383f : MOV ESP,EBP
00903841 : POP EBP
00903842 : RET 0x8
00903845 : MOV ESI,0xc63738
0090384a : MOV ECX,EDI
0090384c : CALL 0x00403810
00903851 : TEST AL,AL
00903853 : JZ 0x00903871
00903855 : MOV ECX,dword ptr [ESP + 0x10]
00903859 : MOV ECX,dword ptr [ECX + 0xe0]
0090385f : TEST ECX,ECX
00903861 : JZ 0x00903871
00903863 : MOV EDX,dword ptr [0x017247d4]
00903869 : PUSH 0x1
0090386b : PUSH EDX
0090386c : CALL 0x00a0d390
00903871 : MOV ECX,dword ptr [ESP + 0x60]
00903875 : MOV dword ptr FS:[0x0],ECX
0090387c : POP ECX
0090387d : POP EDI
0090387e : POP ESI
0090387f : POP EBX
00903880 : MOV ESP,EBP
00903882 : POP EBP
00903883 : RET 0x8

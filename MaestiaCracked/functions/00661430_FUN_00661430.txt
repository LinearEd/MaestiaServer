PROGRAM  : Maestia.exe
FUNCTION : FUN_00661430
ENTRY    : 00661430
BODY     : [[00661430, 006614e0]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00661430(int param_1)

{
  LPCRITICAL_SECTION lpCriticalSection;
  uint uVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  void *local_c;
  undefined1 *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00b0c508;
  local_c = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xffffffe0;
  ExceptionList = &local_c;
  lpCriticalSection = *(LPCRITICAL_SECTION *)(param_1 + 0x2c);
  EnterCriticalSection(lpCriticalSection);
  iVar5 = 0;
  local_4 = 0;
  if (*(int *)(param_1 + 8) != 0) {
    iVar2 = (**(code **)(*(int *)(param_1 + -0xc) + 0x18))(uVar1);
    iVar6 = 0;
    if (0 < iVar2) {
      do {
        piVar3 = (int *)(**(code **)(*(int *)(param_1 + -0xc) + 0x1c))(iVar6);
        if (piVar3 == (int *)0x0) break;
        if (((piVar3[6] != 0) && (iVar4 = (**(code **)(*piVar3 + 0x18))(), iVar4 < 0)) &&
           (-1 < iVar5)) {
          iVar5 = iVar4;
        }
        iVar6 = iVar6 + 1;
      } while (iVar6 < iVar2);
    }
  }
  *(undefined4 *)(param_1 + 8) = 0;
  LeaveCriticalSection(lpCriticalSection);
  ExceptionList = local_c;
  return iVar5;
}



============================================================
DISASSEMBLY
============================================================
00661430 : PUSH -0x1
00661432 : PUSH 0xb0c508
00661437 : MOV EAX,FS:[0x0]
0066143d : PUSH EAX
0066143e : PUSH ECX
0066143f : PUSH EBX
00661440 : PUSH EBP
00661441 : PUSH ESI
00661442 : PUSH EDI
00661443 : MOV EAX,[0x00d66fa0]
00661448 : XOR EAX,ESP
0066144a : PUSH EAX
0066144b : LEA EAX,[ESP + 0x18]
0066144f : MOV FS:[0x0],EAX
00661455 : MOV ESI,dword ptr [ESP + 0x28]
00661459 : MOV EDI,dword ptr [ESI + 0x2c]
0066145c : PUSH EDI
0066145d : MOV dword ptr [ESP + 0x18],EDI
00661461 : CALL dword ptr [0x00b85118]
00661467 : XOR EBP,EBP
00661469 : MOV dword ptr [ESP + 0x20],EBP
0066146d : CMP dword ptr [ESI + 0x8],EBP
00661470 : JZ 0x006614bb
00661472 : MOV EAX,dword ptr [ESI + -0xc]
00661475 : MOV EDX,dword ptr [EAX + 0x18]
00661478 : ADD ESI,-0xc
0066147b : MOV ECX,ESI
0066147d : CALL EDX
0066147f : MOV EBX,EAX
00661481 : XOR EDI,EDI
00661483 : TEST EBX,EBX
00661485 : JLE 0x006614b3
00661487 : MOV EAX,dword ptr [ESI]
00661489 : MOV EDX,dword ptr [EAX + 0x1c]
0066148c : PUSH EDI
0066148d : MOV ECX,ESI
0066148f : CALL EDX
00661491 : TEST EAX,EAX
00661493 : JZ 0x006614b3
00661495 : CMP dword ptr [EAX + 0x18],0x0
00661499 : JZ 0x006614ae
0066149b : MOV EDX,dword ptr [EAX]
0066149d : MOV ECX,EAX
0066149f : MOV EAX,dword ptr [EDX + 0x18]
006614a2 : CALL EAX
006614a4 : TEST EAX,EAX
006614a6 : JGE 0x006614ae
006614a8 : TEST EBP,EBP
006614aa : JL 0x006614ae
006614ac : MOV EBP,EAX
006614ae : INC EDI
006614af : CMP EDI,EBX
006614b1 : JL 0x00661487
006614b3 : MOV ESI,dword ptr [ESP + 0x28]
006614b7 : MOV EDI,dword ptr [ESP + 0x14]
006614bb : PUSH EDI
006614bc : MOV dword ptr [ESI + 0x8],0x0
006614c3 : CALL dword ptr [0x00b8511c]
006614c9 : MOV EAX,EBP
006614cb : MOV ECX,dword ptr [ESP + 0x18]
006614cf : MOV dword ptr FS:[0x0],ECX
006614d6 : POP ECX
006614d7 : POP EDI
006614d8 : POP ESI
006614d9 : POP EBP
006614da : POP EBX
006614db : ADD ESP,0x10
006614de : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_0059fb70
ENTRY    : 0059fb70
BODY     : [[0059fb70, 0059fc66]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0059fb70(undefined4 param_1)

{
  undefined1 uVar1;
  int iVar2;
  int in_ECX;
  int iVar3;
  short *psVar4;
  
  psVar4 = *(short **)(in_ECX + 0xc);
  if (psVar4 != (short *)0x0) {
    iVar2 = *(int *)(in_ECX + 0x10);
    if (*psVar4 == -0x101) {
      psVar4 = psVar4 + 1;
      iVar2 = iVar2 / 2 + -1;
      iVar3 = 0;
      *(undefined4 *)(in_ECX + 8) = 1;
      if (0 < iVar2) {
        do {
          iVar3 = iVar3 + 1;
        } while (iVar3 < iVar2);
      }
    }
    else if (*psVar4 == -2) {
      psVar4 = psVar4 + 1;
      iVar2 = iVar2 / 2 + -1;
      iVar3 = 0;
      *(undefined4 *)(in_ECX + 8) = 1;
      if (0 < iVar2) {
        do {
          psVar4[iVar3] = psVar4[iVar3] << 8 | (ushort)psVar4[iVar3] >> 8;
          iVar3 = iVar3 + 1;
        } while (iVar3 < iVar2);
      }
    }
    else if ((((2 < iVar2) && ((char)*psVar4 == -0x11)) && (*(char *)((int)psVar4 + 1) == -0x45)) &&
            ((char)psVar4[1] == -0x41)) {
      psVar4 = (short *)((int)psVar4 + 3);
      iVar2 = iVar2 + -3;
    }
    if (*(int *)(in_ECX + 8) == 1) {
      uVar1 = thunk_FUN_0057dc00(psVar4,iVar2);
    }
    else {
      uVar1 = FUN_0057dde0(psVar4,iVar2);
    }
    FUN_00515cf0(*(undefined4 *)(in_ECX + 0xc));
    *(undefined4 *)(in_ECX + 0xc) = 0;
    FUN_005bb9d0(param_1,uVar1);
    return;
  }
  FUN_005bb9d0(param_1,0);
  return;
}



============================================================
DISASSEMBLY
============================================================
0059fb70 : PUSH ESI
0059fb71 : MOV ESI,ECX
0059fb73 : MOV ECX,dword ptr [ESI + 0xc]
0059fb76 : TEST ECX,ECX
0059fb78 : JNZ 0x0059fb8d
0059fb7a : MOV EAX,dword ptr [ESP + 0x8]
0059fb7e : PUSH ECX
0059fb7f : MOV ECX,dword ptr [ESP + 0x10]
0059fb83 : PUSH EAX
0059fb84 : CALL 0x005bb9d0
0059fb89 : POP ESI
0059fb8a : RET 0x8
0059fb8d : MOVZX EDX,word ptr [ECX]
0059fb90 : MOV EAX,dword ptr [ESI + 0x10]
0059fb93 : PUSH EBP
0059fb94 : MOV EBP,0xfeff
0059fb99 : PUSH EDI
0059fb9a : MOV EDI,ECX
0059fb9c : CMP DX,BP
0059fb9f : JNZ 0x0059fbc7
0059fba1 : CDQ
0059fba2 : SUB EAX,EDX
0059fba4 : ADD ECX,0x2
0059fba7 : SAR EAX,0x1
0059fba9 : MOV EDI,ECX
0059fbab : DEC EAX
0059fbac : XOR ECX,ECX
0059fbae : MOV dword ptr [ESI + 0x8],0x1
0059fbb5 : TEST EAX,EAX
0059fbb7 : JLE 0x0059fc1f
0059fbb9 : LEA ESP,[ESP]
0059fbc0 : INC ECX
0059fbc1 : CMP ECX,EAX
0059fbc3 : JL 0x0059fbc0
0059fbc5 : JMP 0x0059fc1f
0059fbc7 : MOV EBP,0xfffe
0059fbcc : CMP DX,BP
0059fbcf : JNZ 0x0059fc03
0059fbd1 : CDQ
0059fbd2 : SUB EAX,EDX
0059fbd4 : SAR EAX,0x1
0059fbd6 : ADD ECX,0x2
0059fbd9 : DEC EAX
0059fbda : XOR EDX,EDX
0059fbdc : MOV EDI,ECX
0059fbde : MOV dword ptr [ESI + 0x8],0x1
0059fbe5 : TEST EAX,EAX
0059fbe7 : JLE 0x0059fc1f
0059fbe9 : LEA ESP,[ESP]
0059fbf0 : MOV BP,word ptr [ECX + EDX*0x2]
0059fbf4 : ROL BP,0x8
0059fbf8 : MOV word ptr [ECX + EDX*0x2],BP
0059fbfc : INC EDX
0059fbfd : CMP EDX,EAX
0059fbff : JL 0x0059fbf0
0059fc01 : JMP 0x0059fc1f
0059fc03 : CMP EAX,0x2
0059fc06 : JLE 0x0059fc1f
0059fc08 : CMP byte ptr [ECX],0xef
0059fc0b : JNZ 0x0059fc1f
0059fc0d : CMP byte ptr [ECX + 0x1],0xbb
0059fc11 : JNZ 0x0059fc1f
0059fc13 : CMP byte ptr [ECX + 0x2],0xbf
0059fc17 : JNZ 0x0059fc1f
0059fc19 : ADD EDI,0x3
0059fc1c : SUB EAX,0x3
0059fc1f : MOV ECX,dword ptr [ESI + 0x8]
0059fc22 : PUSH EAX
0059fc23 : PUSH EDI
0059fc24 : MOV EDI,dword ptr [ESP + 0x1c]
0059fc28 : SUB ECX,0x1
0059fc2b : LEA ECX,[EDI + 0x30]
0059fc2e : JZ 0x0059fc37
0059fc30 : CALL 0x0057dde0
0059fc35 : JMP 0x0059fc3c
0059fc37 : CALL 0x0057de30
0059fc3c : MOV ECX,dword ptr [ESI + 0xc]
0059fc3f : PUSH ECX
0059fc40 : MOV byte ptr [ESP + 0x18],AL
0059fc44 : CALL 0x00515cf0
0059fc49 : MOV EDX,dword ptr [ESP + 0x14]
0059fc4d : MOV EAX,dword ptr [ESP + 0x10]
0059fc51 : PUSH EDX
0059fc52 : PUSH EAX
0059fc53 : MOV ECX,EDI
0059fc55 : MOV dword ptr [ESI + 0xc],0x0
0059fc5c : CALL 0x005bb9d0
0059fc61 : POP EDI
0059fc62 : POP EBP
0059fc63 : POP ESI
0059fc64 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_0051c810
ENTRY    : 0051c810
BODY     : [[0051c810, 0051c8be]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0051c810(undefined4 *param_1)

{
  int iVar1;
  undefined4 uVar2;
  uint *in_ECX;
  int local_20c;
  int local_208;
  undefined1 local_204 [512];
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)&local_20c;
  local_208 = (*in_ECX & 0xfffffffc) + 8;
  *param_1 = &DAT_00d65130;
  InterlockedExchangeAdd((LONG *)&DAT_00d65134,1);
  local_20c = 0;
LAB_0051c854:
  do {
    iVar1 = FUN_0051aa70(&local_208);
    if (iVar1 != 0) {
      uVar2 = FUN_0051caf0(iVar1);
      FUN_0051ad90(local_204,&local_20c,uVar2);
      if (local_20c < 0x1f8) goto LAB_0051c854;
    }
    FUN_0051b950(local_204,local_20c);
    local_20c = 0;
    if (iVar1 == 0) {
      __security_check_cookie(local_4 ^ (uint)&local_20c);
      return;
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
0051c810 : SUB ESP,0x20c
0051c816 : MOV EAX,[0x00d66fa0]
0051c81b : XOR EAX,ESP
0051c81d : MOV dword ptr [ESP + 0x208],EAX
0051c824 : MOV EAX,dword ptr [ECX]
0051c826 : PUSH ESI
0051c827 : PUSH EDI
0051c828 : MOV EDI,dword ptr [ESP + 0x218]
0051c82f : AND EAX,0xfffffffc
0051c832 : PUSH 0x1
0051c834 : ADD EAX,0x8
0051c837 : PUSH 0xd65134
0051c83c : MOV dword ptr [ESP + 0x14],EAX
0051c840 : MOV dword ptr [EDI],0xd65130
0051c846 : CALL dword ptr [0x00b851cc]
0051c84c : MOV dword ptr [ESP + 0x8],0x0
0051c854 : LEA EAX,[ESP + 0xc]
0051c858 : PUSH EAX
0051c859 : CALL 0x0051aa70
0051c85e : MOV ESI,EAX
0051c860 : TEST ESI,ESI
0051c862 : JZ 0x0051c887
0051c864 : PUSH ESI
0051c865 : CALL 0x0051caf0
0051c86a : ADD ESP,0x4
0051c86d : PUSH EAX
0051c86e : LEA ECX,[ESP + 0xc]
0051c872 : PUSH ECX
0051c873 : LEA EDX,[ESP + 0x18]
0051c877 : PUSH EDX
0051c878 : CALL 0x0051ad90
0051c87d : CMP dword ptr [ESP + 0x8],0x1f8
0051c885 : JL 0x0051c854
0051c887 : MOV EAX,dword ptr [ESP + 0x8]
0051c88b : PUSH EAX
0051c88c : LEA ECX,[ESP + 0x14]
0051c890 : PUSH ECX
0051c891 : MOV ECX,EDI
0051c893 : CALL 0x0051b950
0051c898 : MOV dword ptr [ESP + 0x8],0x0
0051c8a0 : TEST ESI,ESI
0051c8a2 : JNZ 0x0051c854
0051c8a4 : MOV ECX,dword ptr [ESP + 0x210]
0051c8ab : MOV EAX,EDI
0051c8ad : POP EDI
0051c8ae : POP ESI
0051c8af : XOR ECX,ESP
0051c8b1 : CALL 0x00633e6b
0051c8b6 : ADD ESP,0x20c
0051c8bc : RET 0x4

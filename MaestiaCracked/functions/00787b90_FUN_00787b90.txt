PROGRAM  : Maestia.exe
FUNCTION : FUN_00787b90
ENTRY    : 00787b90
BODY     : [[00787b90, 00787bcc] [00787bd0, 00787cb8]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00787b90(undefined2 *param_1,int param_2,int param_3,undefined2 *param_4,int param_5,
                 int param_6)

{
  int in_EAX;
  undefined2 *puVar1;
  int in_ECX;
  undefined2 *puVar2;
  size_t unaff_EDI;
  int local_c;
  int local_8;
  
  if (in_EAX == 1) {
    if (0 < param_6) {
      local_c = param_6;
      do {
        _memcpy(param_1,param_4,unaff_EDI);
        _memset((void *)((int)param_1 + unaff_EDI),0,param_3 - unaff_EDI);
        param_1 = (undefined2 *)((int)param_1 + param_3);
        param_4 = (undefined2 *)((int)param_4 + unaff_EDI);
        local_c = local_c + -1;
      } while (local_c != 0);
    }
  }
  else if (in_EAX == 3) {
    if (0 < param_6) {
      local_8 = param_6;
      do {
        if (0 < param_5) {
          local_c = param_5;
          puVar1 = param_1;
          puVar2 = param_4;
          do {
            *puVar1 = *puVar2;
            *(undefined1 *)(puVar1 + 1) = *(undefined1 *)(puVar2 + 1);
            *(undefined1 *)((int)puVar1 + 3) = 0xff;
            puVar2 = (undefined2 *)((int)puVar2 + 3);
            puVar1 = puVar1 + 2;
            local_c = local_c + -1;
          } while (local_c != 0);
        }
        _memset(param_1 + param_5 * 2,0,(in_ECX - param_5) * 4);
        param_1 = (undefined2 *)((int)param_1 + param_3);
        param_4 = (undefined2 *)((int)param_4 + unaff_EDI);
        local_8 = local_8 + -1;
      } while (local_8 != 0);
    }
  }
  else {
    if (in_EAX != 4) {
      return;
    }
    if (0 < param_6) {
      local_c = param_6;
      do {
        _memcpy(param_1,param_4,unaff_EDI);
        _memset((void *)((int)param_1 + unaff_EDI),0,param_3 - unaff_EDI);
        param_1 = (undefined2 *)((int)param_1 + param_3);
        param_4 = (undefined2 *)((int)param_4 + unaff_EDI);
        local_c = local_c + -1;
      } while (local_c != 0);
    }
  }
  _memset(param_1,0,(param_2 - param_6) * param_3);
  return;
}



============================================================
DISASSEMBLY
============================================================
00787b90 : PUSH EBP
00787b91 : MOV EBP,ESP
00787b93 : SUB ESP,0xc
00787b96 : SUB EAX,0x1
00787b99 : PUSH EBX
00787b9a : MOV EBX,dword ptr [EBP + 0x14]
00787b9d : PUSH ESI
00787b9e : MOV ESI,dword ptr [EBP + 0x8]
00787ba1 : JZ 0x00787c64
00787ba7 : SUB EAX,0x2
00787baa : JZ 0x00787bfa
00787bac : SUB EAX,0x1
00787baf : JNZ 0x00787cb3
00787bb5 : MOV ECX,dword ptr [EBP + 0x1c]
00787bb8 : TEST ECX,ECX
00787bba : JLE 0x00787c9e
00787bc0 : MOV EAX,dword ptr [EBP + 0x10]
00787bc3 : SUB EAX,EDI
00787bc5 : MOV dword ptr [EBP + -0x4],EAX
00787bc8 : MOV dword ptr [EBP + -0x8],ECX
00787bcb : JMP 0x00787bd0
00787bd0 : PUSH EDI
00787bd1 : PUSH EBX
00787bd2 : PUSH ESI
00787bd3 : CALL 0x0063ae40
00787bd8 : MOV EAX,dword ptr [EBP + -0x4]
00787bdb : PUSH EAX
00787bdc : LEA ECX,[ESI + EDI*0x1]
00787bdf : PUSH 0x0
00787be1 : PUSH ECX
00787be2 : CALL 0x0063b700
00787be7 : ADD ESI,dword ptr [EBP + 0x10]
00787bea : ADD ESP,0x18
00787bed : ADD EBX,EDI
00787bef : SUB dword ptr [EBP + -0x8],0x1
00787bf3 : JNZ 0x00787bd0
00787bf5 : JMP 0x00787c9b
00787bfa : MOV EAX,dword ptr [EBP + 0x1c]
00787bfd : TEST EAX,EAX
00787bff : JLE 0x00787c5c
00787c01 : MOV EDX,dword ptr [EBP + 0x18]
00787c04 : SUB ECX,EDX
00787c06 : ADD ECX,ECX
00787c08 : ADD ECX,ECX
00787c0a : MOV dword ptr [EBP + -0xc],ECX
00787c0d : MOV dword ptr [EBP + -0x4],EAX
00787c10 : JMP 0x00787c15
00787c12 : MOV EDX,dword ptr [EBP + 0x18]
00787c15 : TEST EDX,EDX
00787c17 : JLE 0x00787c3f
00787c19 : MOV EAX,ESI
00787c1b : MOV ECX,EBX
00787c1d : MOV dword ptr [EBP + -0x8],EDX
00787c20 : MOV DX,word ptr [ECX]
00787c23 : MOV word ptr [EAX],DX
00787c26 : MOV DL,byte ptr [ECX + 0x2]
00787c29 : MOV byte ptr [EAX + 0x2],DL
00787c2c : MOV byte ptr [EAX + 0x3],0xff
00787c30 : ADD ECX,0x3
00787c33 : ADD EAX,0x4
00787c36 : SUB dword ptr [EBP + -0x8],0x1
00787c3a : JNZ 0x00787c20
00787c3c : MOV EDX,dword ptr [EBP + 0x18]
00787c3f : MOV EAX,dword ptr [EBP + -0xc]
00787c42 : PUSH EAX
00787c43 : LEA ECX,[ESI + EDX*0x4]
00787c46 : PUSH 0x0
00787c48 : PUSH ECX
00787c49 : CALL 0x0063b700
00787c4e : ADD ESI,dword ptr [EBP + 0x10]
00787c51 : ADD ESP,0xc
00787c54 : ADD EBX,EDI
00787c56 : SUB dword ptr [EBP + -0x4],0x1
00787c5a : JNZ 0x00787c12
00787c5c : MOV EAX,dword ptr [EBP + 0xc]
00787c5f : SUB EAX,dword ptr [EBP + 0x1c]
00787c62 : JMP 0x00787ca3
00787c64 : MOV ECX,dword ptr [EBP + 0x1c]
00787c67 : TEST ECX,ECX
00787c69 : JLE 0x00787c9e
00787c6b : MOV EAX,dword ptr [EBP + 0x10]
00787c6e : SUB EAX,EDI
00787c70 : MOV dword ptr [EBP + -0x4],EAX
00787c73 : MOV dword ptr [EBP + -0x8],ECX
00787c76 : PUSH EDI
00787c77 : PUSH EBX
00787c78 : PUSH ESI
00787c79 : CALL 0x0063ae40
00787c7e : MOV EDX,dword ptr [EBP + -0x4]
00787c81 : PUSH EDX
00787c82 : LEA EAX,[ESI + EDI*0x1]
00787c85 : PUSH 0x0
00787c87 : PUSH EAX
00787c88 : CALL 0x0063b700
00787c8d : ADD ESI,dword ptr [EBP + 0x10]
00787c90 : ADD ESP,0x18
00787c93 : ADD EBX,EDI
00787c95 : SUB dword ptr [EBP + -0x8],0x1
00787c99 : JNZ 0x00787c76
00787c9b : MOV ECX,dword ptr [EBP + 0x1c]
00787c9e : MOV EAX,dword ptr [EBP + 0xc]
00787ca1 : SUB EAX,ECX
00787ca3 : IMUL EAX,dword ptr [EBP + 0x10]
00787ca7 : PUSH EAX
00787ca8 : PUSH 0x0
00787caa : PUSH ESI
00787cab : CALL 0x0063b700
00787cb0 : ADD ESP,0xc
00787cb3 : POP ESI
00787cb4 : POP EBX
00787cb5 : MOV ESP,EBP
00787cb7 : POP EBP
00787cb8 : RET

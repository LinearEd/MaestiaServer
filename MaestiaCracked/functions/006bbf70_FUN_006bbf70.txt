PROGRAM  : Maestia.exe
FUNCTION : FUN_006bbf70
ENTRY    : 006bbf70
BODY     : [[006bbf70, 006bc029] [006bc030, 006bc04c] [006bc050, 006bc154]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006bbf70(int param_1)

{
  ushort *puVar1;
  undefined4 *puVar2;
  ushort *puVar3;
  ushort *puVar4;
  ushort *puVar5;
  ushort uVar6;
  int in_EAX;
  undefined4 *puVar7;
  ushort *puVar8;
  int iVar9;
  ushort *puVar10;
  
  puVar7 = *(undefined4 **)(in_EAX + 0x2c);
  puVar3 = *(ushort **)(in_EAX + 0x20);
  puVar1 = puVar3 + *(int *)(in_EAX + 0x1c) * 0x14;
  puVar2 = puVar7 + *(int *)(in_EAX + 0x28);
  if (param_1 == 0) {
    uVar6 = 0x40;
    if (puVar3 < puVar1) {
      puVar8 = puVar3 + 0xc;
      iVar9 = (uint)((int)puVar1 + (-1 - (int)puVar3)) / 0x28 + 1;
      do {
        *(undefined4 *)puVar8 = *(undefined4 *)(puVar8 + -4);
        *(undefined4 *)(puVar8 + 2) = *(undefined4 *)(puVar8 + -10);
        puVar8 = puVar8 + 0x14;
        iVar9 = iVar9 + -1;
      } while (iVar9 != 0);
    }
  }
  else {
    uVar6 = 0x80;
    if (puVar3 < puVar1) {
      puVar8 = puVar3 + 0xc;
      iVar9 = (uint)((int)puVar1 + (-1 - (int)puVar3)) / 0x28 + 1;
      do {
        *(undefined4 *)puVar8 = *(undefined4 *)(puVar8 + -2);
        *(undefined4 *)(puVar8 + 2) = *(undefined4 *)(puVar8 + -8);
        puVar8 = puVar8 + 0x14;
        iVar9 = iVar9 + -1;
      } while (iVar9 != 0);
    }
  }
  do {
    if (puVar2 <= puVar7) {
      if (param_1 == 0) {
        if (puVar3 < puVar1) {
          puVar8 = puVar3 + 8;
          iVar9 = (uint)((int)puVar1 + (-1 - (int)puVar3)) / 0x28 + 1;
          do {
            *(undefined4 *)puVar8 = *(undefined4 *)(puVar8 + 4);
            puVar8 = puVar8 + 0x14;
            iVar9 = iVar9 + -1;
          } while (iVar9 != 0);
          return;
        }
      }
      else if (puVar3 < puVar1) {
        puVar8 = puVar3 + 10;
        iVar9 = (uint)((int)puVar1 + (-1 - (int)puVar3)) / 0x28 + 1;
        do {
          *(undefined4 *)puVar8 = *(undefined4 *)(puVar8 + 2);
          puVar8 = puVar8 + 0x14;
          iVar9 = iVar9 + -1;
        } while (iVar9 != 0);
      }
      return;
    }
    puVar8 = (ushort *)*puVar7;
    puVar4 = *(ushort **)(puVar8 + 0x12);
    for (; puVar8 <= puVar4; puVar8 = puVar8 + 0x14) {
      puVar5 = puVar8;
      if ((uVar6 & *puVar8) != 0) {
        do {
          for (; (puVar10 = puVar5, puVar5 < puVar4 && ((uVar6 & puVar5[0x14]) != 0));
              puVar5 = puVar5 + 0x14) {
          }
          do {
            puVar10 = puVar10 + 0x14;
            if (puVar4 < puVar10) {
              if (puVar5 == puVar8) {
                FUN_006bbdf0();
              }
              else {
                if (puVar5 < puVar4) {
                  FUN_006bbe40(puVar8);
                }
                if (puVar3 < puVar8) {
                  FUN_006bbe40(puVar8);
                }
              }
              goto LAB_006bc0df;
            }
          } while ((uVar6 & *puVar10) == 0);
          FUN_006bbe40(puVar10);
          puVar5 = puVar10;
        } while( true );
      }
    }
LAB_006bc0df:
    puVar7 = puVar7 + 1;
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
006bbf70 : SUB ESP,0x1c
006bbf73 : CMP dword ptr [ESP + 0x20],0x0
006bbf78 : MOV ECX,dword ptr [EAX + 0x1c]
006bbf7b : MOV EDX,dword ptr [EAX + 0x28]
006bbf7e : PUSH EBX
006bbf7f : PUSH EBP
006bbf80 : PUSH ESI
006bbf81 : MOV ESI,dword ptr [EAX + 0x2c]
006bbf84 : PUSH EDI
006bbf85 : MOV EDI,dword ptr [EAX + 0x20]
006bbf88 : LEA ECX,[ECX + ECX*0x4]
006bbf8b : LEA EBX,[EDI + ECX*0x8]
006bbf8e : LEA EBP,[ESI + EDX*0x4]
006bbf91 : MOV dword ptr [ESP + 0x24],EDI
006bbf95 : MOV dword ptr [ESP + 0x14],EBX
006bbf99 : MOV dword ptr [ESP + 0x18],ESI
006bbf9d : MOV dword ptr [ESP + 0x28],EBP
006bbfa1 : JNZ 0x006bbfd7
006bbfa3 : MOV dword ptr [ESP + 0x10],0x40
006bbfab : CMP EDI,EBX
006bbfad : JNC 0x006bc009
006bbfaf : MOV EDX,EBX
006bbfb1 : SUB EDX,EDI
006bbfb3 : DEC EDX
006bbfb4 : MOV EAX,0xcccccccd
006bbfb9 : MUL EDX
006bbfbb : SHR EDX,0x5
006bbfbe : LEA ECX,[EDI + 0x18]
006bbfc1 : INC EDX
006bbfc2 : MOV EAX,dword ptr [ECX + -0x8]
006bbfc5 : MOV dword ptr [ECX],EAX
006bbfc7 : MOV EAX,dword ptr [ECX + -0x14]
006bbfca : MOV dword ptr [ECX + 0x4],EAX
006bbfcd : ADD ECX,0x28
006bbfd0 : SUB EDX,0x1
006bbfd3 : JNZ 0x006bbfc2
006bbfd5 : JMP 0x006bc009
006bbfd7 : MOV dword ptr [ESP + 0x10],0x80
006bbfdf : CMP EDI,EBX
006bbfe1 : JNC 0x006bc009
006bbfe3 : MOV EDX,EBX
006bbfe5 : SUB EDX,EDI
006bbfe7 : DEC EDX
006bbfe8 : MOV EAX,0xcccccccd
006bbfed : MUL EDX
006bbfef : SHR EDX,0x5
006bbff2 : LEA ECX,[EDI + 0x18]
006bbff5 : INC EDX
006bbff6 : MOV EAX,dword ptr [ECX + -0x4]
006bbff9 : MOV dword ptr [ECX],EAX
006bbffb : MOV EAX,dword ptr [ECX + -0x10]
006bbffe : MOV dword ptr [ECX + 0x4],EAX
006bc001 : ADD ECX,0x28
006bc004 : SUB EDX,0x1
006bc007 : JNZ 0x006bbff6
006bc009 : CMP ESI,EBP
006bc00b : JNC 0x006bc0f4
006bc011 : JMP 0x006bc017
006bc013 : MOV ESI,dword ptr [ESP + 0x18]
006bc017 : MOV ESI,dword ptr [ESI]
006bc019 : MOV EBP,dword ptr [ESI + 0x24]
006bc01c : MOV dword ptr [ESP + 0x20],ESI
006bc020 : CMP ESI,EBP
006bc022 : JA 0x006bc0df
006bc028 : JMP 0x006bc030
006bc030 : MOVZX ECX,word ptr [ESI]
006bc033 : MOV EAX,dword ptr [ESP + 0x10]
006bc037 : TEST EAX,ECX
006bc039 : JNZ 0x006bc047
006bc03b : ADD ESI,0x28
006bc03e : CMP ESI,EBP
006bc040 : JBE 0x006bc030
006bc042 : JMP 0x006bc0df
006bc047 : MOV dword ptr [ESP + 0x1c],ESI
006bc04b : JMP 0x006bc050
006bc050 : CMP ESI,EBP
006bc052 : JNC 0x006bc063
006bc054 : MOVZX EDX,word ptr [ESI + 0x28]
006bc058 : TEST EAX,EDX
006bc05a : JZ 0x006bc063
006bc05c : ADD ESI,0x28
006bc05f : CMP ESI,EBP
006bc061 : JC 0x006bc054
006bc063 : LEA EAX,[ESI + 0x28]
006bc066 : MOV EBX,ESI
006bc068 : MOV ESI,EAX
006bc06a : LEA EBX,[EBX]
006bc070 : CMP ESI,EBP
006bc072 : JA 0x006bc096
006bc074 : MOVZX ECX,word ptr [ESI]
006bc077 : MOV EDX,dword ptr [ESP + 0x10]
006bc07b : TEST EDX,ECX
006bc07d : JNZ 0x006bc084
006bc07f : ADD ESI,0x28
006bc082 : JMP 0x006bc070
006bc084 : PUSH ESI
006bc085 : LEA ECX,[ESI + -0x28]
006bc088 : CALL 0x006bbe40
006bc08d : MOV EAX,dword ptr [ESP + 0x14]
006bc091 : ADD ESP,0x4
006bc094 : JMP 0x006bc050
006bc096 : MOV EAX,dword ptr [ESP + 0x1c]
006bc09a : CMP EBX,EAX
006bc09c : JNZ 0x006bc0b1
006bc09e : MOV EDI,EAX
006bc0a0 : MOV EAX,dword ptr [ESP + 0x20]
006bc0a4 : MOV EBX,EBP
006bc0a6 : CALL 0x006bbdf0
006bc0ab : MOV EDI,dword ptr [ESP + 0x24]
006bc0af : JMP 0x006bc0db
006bc0b1 : CMP EBX,EBP
006bc0b3 : JNC 0x006bc0c3
006bc0b5 : PUSH EAX
006bc0b6 : LEA EAX,[EBX + 0x28]
006bc0b9 : MOV ECX,EBP
006bc0bb : CALL 0x006bbe40
006bc0c0 : ADD ESP,0x4
006bc0c3 : MOV EAX,dword ptr [ESP + 0x1c]
006bc0c7 : CMP EAX,EDI
006bc0c9 : JBE 0x006bc0db
006bc0cb : PUSH EAX
006bc0cc : LEA ECX,[EAX + -0x28]
006bc0cf : MOV EAX,dword ptr [ESP + 0x24]
006bc0d3 : CALL 0x006bbe40
006bc0d8 : ADD ESP,0x4
006bc0db : MOV EBX,dword ptr [ESP + 0x14]
006bc0df : MOV EAX,dword ptr [ESP + 0x18]
006bc0e3 : ADD EAX,0x4
006bc0e6 : MOV dword ptr [ESP + 0x18],EAX
006bc0ea : CMP EAX,dword ptr [ESP + 0x28]
006bc0ee : JC 0x006bc013
006bc0f4 : CMP dword ptr [ESP + 0x30],0x0
006bc0f9 : JNZ 0x006bc125
006bc0fb : CMP EDI,EBX
006bc0fd : JNC 0x006bc14d
006bc0ff : SUB EBX,EDI
006bc101 : DEC EBX
006bc102 : MOV EAX,0xcccccccd
006bc107 : MUL EBX
006bc109 : SHR EDX,0x5
006bc10c : LEA ECX,[EDI + 0x10]
006bc10f : INC EDX
006bc110 : MOV EAX,dword ptr [ECX + 0x8]
006bc113 : MOV dword ptr [ECX],EAX
006bc115 : ADD ECX,0x28
006bc118 : SUB EDX,0x1
006bc11b : JNZ 0x006bc110
006bc11d : POP EDI
006bc11e : POP ESI
006bc11f : POP EBP
006bc120 : POP EBX
006bc121 : ADD ESP,0x1c
006bc124 : RET
006bc125 : CMP EDI,EBX
006bc127 : JNC 0x006bc14d
006bc129 : SUB EBX,EDI
006bc12b : DEC EBX
006bc12c : MOV EAX,0xcccccccd
006bc131 : MUL EBX
006bc133 : SHR EDX,0x5
006bc136 : LEA ECX,[EDI + 0x14]
006bc139 : INC EDX
006bc13a : LEA EBX,[EBX]
006bc140 : MOV EAX,dword ptr [ECX + 0x4]
006bc143 : MOV dword ptr [ECX],EAX
006bc145 : ADD ECX,0x28
006bc148 : SUB EDX,0x1
006bc14b : JNZ 0x006bc140
006bc14d : POP EDI
006bc14e : POP ESI
006bc14f : POP EBP
006bc150 : POP EBX
006bc151 : ADD ESP,0x1c
006bc154 : RET

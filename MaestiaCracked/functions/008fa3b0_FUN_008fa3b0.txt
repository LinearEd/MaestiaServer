PROGRAM  : Maestia.exe
FUNCTION : FUN_008fa3b0
ENTRY    : 008fa3b0
BODY     : [[008fa3b0, 008fa6f8]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008fa3b0(undefined4 param_1,int *param_2)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  undefined4 in_ECX;
  undefined4 extraout_EDX;
  undefined4 extraout_EDX_00;
  undefined4 extraout_EDX_01;
  undefined4 extraout_EDX_02;
  undefined4 extraout_EDX_03;
  undefined4 extraout_EDX_04;
  undefined4 uVar4;
  int *piVar5;
  undefined8 uVar6;
  int local_5c;
  int local_54;
  undefined1 local_4d [5];
  undefined2 local_48;
  undefined4 local_38;
  uint local_34;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b66a1c;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_14 = uVar1;
  uVar6 = FUN_00703c00(0x600,uVar1);
  uVar4 = (undefined4)((ulonglong)uVar6 >> 0x20);
  if ((int)uVar6 != 0) {
    FUN_00406460(&DAT_00c618b4);
    local_8 = 0;
    uVar4 = extraout_EDX;
    if ((char)((uint)in_ECX >> 0x10) == -0x74) {
      FUN_00406460(&DAT_00c618b8);
      local_8._0_1_ = 1;
      iVar3 = *(int *)((int)uVar6 + 0x280);
      if (iVar3 == 0) {
LAB_008fa43c:
        local_8 = (uint)local_8._1_3_ << 8;
        FUN_00406560();
        local_8 = 0xffffffff;
        FUN_00406560();
        uVar4 = extraout_EDX_01;
        goto LAB_008fa690;
      }
      piVar5 = (int *)(iVar3 + 0x4fc);
      local_5c = 1;
      uVar4 = extraout_EDX_00;
      do {
        if (*piVar5 == 0) break;
        uVar6 = FUN_00703c00(0x700,uVar1);
        uVar4 = (undefined4)((ulonglong)uVar6 >> 0x20);
        iVar2 = (int)uVar6;
        if (iVar2 != 0) {
          if (*(int *)(DAT_0172491c + 0x17c) == 0) goto LAB_008fa43c;
          local_4d[0] = 0;
          FUN_00ab4680(CONCAT22(*(undefined2 *)(iVar2 + 4),*(undefined2 *)(iVar2 + 6)),local_30,
                       local_4d,1);
          *param_2 = *param_2 + 1;
          FUN_008f9b20(local_30,3,0);
          uVar4 = extraout_EDX_02;
        }
        local_5c = local_5c + 1;
        piVar5 = piVar5 + 1;
      } while (local_5c < 10);
      piVar5 = (int *)(iVar3 + 0x524);
      local_54 = 1;
      do {
        if (*piVar5 == 0) break;
        uVar6 = FUN_00703c00(0x700);
        uVar4 = (undefined4)((ulonglong)uVar6 >> 0x20);
        iVar2 = (int)uVar6;
        if (iVar2 != 0) {
          if (*(int *)(DAT_0172491c + 0x17c) == 0) goto LAB_008fa6ae;
          local_4d[0] = 0;
          FUN_00ab4680(CONCAT22(*(undefined2 *)(iVar2 + 4),*(undefined2 *)(iVar2 + 6)),local_30,
                       local_4d,1);
          *param_2 = *param_2 + 1;
          FUN_008f9b20(local_30,3,0);
          uVar4 = extraout_EDX_03;
        }
        local_54 = local_54 + 1;
        piVar5 = piVar5 + 1;
      } while (local_54 < 10);
      piVar5 = (int *)(iVar3 + 0x4d4);
      local_54 = 1;
      do {
        if (*piVar5 == 0) break;
        uVar6 = FUN_00703c00(0x700);
        uVar4 = (undefined4)((ulonglong)uVar6 >> 0x20);
        iVar3 = (int)uVar6;
        if (iVar3 != 0) {
          if (*(int *)(DAT_0172491c + 0x17c) == 0) goto LAB_008fa6ae;
          local_4d[0] = 0;
          FUN_00ab4680(CONCAT22(*(undefined2 *)(iVar3 + 4),*(undefined2 *)(iVar3 + 6)),local_30,
                       local_4d,1);
          *param_2 = *param_2 + 1;
          FUN_008f9b20(local_30,3,0);
          uVar4 = extraout_EDX_04;
        }
        local_54 = local_54 + 1;
        piVar5 = piVar5 + 1;
      } while (local_54 < 10);
      local_8 = (uint)local_8._1_3_ << 8;
      if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_18 = 7;
      local_1c = 0;
      local_2c = 0;
    }
    local_8 = 0xffffffff;
    if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_34 = 7;
    local_38 = 0;
    local_48 = 0;
  }
  goto LAB_008fa690;
LAB_008fa6ae:
  local_8 = (uint)local_8._1_3_ << 8;
  if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_18 = 7;
  local_1c = 0;
  local_2c = 0;
  local_8 = 0xffffffff;
  if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  uVar4 = 0;
  local_34 = 7;
  local_38 = 0;
  local_48 = 0;
LAB_008fa690:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc,uVar4,param_1);
  return;
}



============================================================
DISASSEMBLY
============================================================
008fa3b0 : PUSH EBP
008fa3b1 : MOV EBP,ESP
008fa3b3 : PUSH -0x1
008fa3b5 : PUSH 0xb66a1c
008fa3ba : MOV EAX,FS:[0x0]
008fa3c0 : PUSH EAX
008fa3c1 : SUB ESP,0x54
008fa3c4 : MOV EAX,[0x00d66fa0]
008fa3c9 : XOR EAX,EBP
008fa3cb : MOV dword ptr [EBP + -0x10],EAX
008fa3ce : PUSH EBX
008fa3cf : PUSH ESI
008fa3d0 : PUSH EDI
008fa3d1 : PUSH EAX
008fa3d2 : LEA EAX,[EBP + -0xc]
008fa3d5 : MOV FS:[0x0],EAX
008fa3db : MOV EDI,ECX
008fa3dd : MOV EAX,dword ptr [EBP + 0x8]
008fa3e0 : MOV EBX,dword ptr [EBP + 0xc]
008fa3e3 : PUSH 0x600
008fa3e8 : MOV dword ptr [EBP + -0x60],EAX
008fa3eb : CALL 0x00703c00
008fa3f0 : MOV ESI,EAX
008fa3f2 : ADD ESP,0x4
008fa3f5 : TEST ESI,ESI
008fa3f7 : JZ 0x008fa690
008fa3fd : PUSH 0xc618b4
008fa402 : LEA ECX,[EBP + -0x48]
008fa405 : CALL 0x00406460
008fa40a : MOV dword ptr [EBP + -0x4],0x0
008fa411 : MOV EAX,EDI
008fa413 : SHR EAX,0x10
008fa416 : CMP AL,0x8c
008fa418 : JNZ 0x008fa667
008fa41e : PUSH 0xc618b8
008fa423 : LEA ECX,[EBP + -0x2c]
008fa426 : CALL 0x00406460
008fa42b : MOV byte ptr [EBP + -0x4],0x1
008fa42f : MOV ESI,dword ptr [ESI + 0x280]
008fa435 : MOV dword ptr [EBP + -0x5c],ESI
008fa438 : TEST ESI,ESI
008fa43a : JNZ 0x008fa45c
008fa43c : MOV byte ptr [EBP + -0x4],0x0
008fa440 : LEA ECX,[EBP + -0x2c]
008fa443 : CALL 0x00406560
008fa448 : MOV dword ptr [EBP + -0x4],0xffffffff
008fa44f : LEA ECX,[EBP + -0x48]
008fa452 : CALL 0x00406560
008fa457 : JMP 0x008fa690
008fa45c : ADD ESI,0x4fc
008fa462 : MOV dword ptr [EBP + -0x58],0x1
008fa469 : MOV dword ptr [EBP + -0x50],ESI
008fa46c : CMP dword ptr [ESI],0x0
008fa46f : JZ 0x008fa4f7
008fa475 : MOVZX ECX,word ptr [ESI]
008fa478 : MOVZX EDI,word ptr [ESI + 0x2]
008fa47c : PUSH 0x700
008fa481 : MOV dword ptr [EBP + -0x54],ECX
008fa484 : CALL 0x00703c00
008fa489 : ADD ESP,0x4
008fa48c : TEST EAX,EAX
008fa48e : JZ 0x008fa4e1
008fa490 : MOV EDX,dword ptr [0x0172491c]
008fa496 : CMP dword ptr [EDX + 0x17c],0x0
008fa49d : JZ 0x008fa43c
008fa49f : MOV ECX,dword ptr [EBP + -0x54]
008fa4a2 : PUSH 0x1
008fa4a4 : LEA EDX,[EBP + -0x49]
008fa4a7 : PUSH EDX
008fa4a8 : LEA EDX,[EBP + -0x2c]
008fa4ab : PUSH EDX
008fa4ac : MOVZX EDX,word ptr [EAX + 0x4]
008fa4b0 : MOVZX EAX,word ptr [EAX + 0x6]
008fa4b4 : SHL EDX,0x10
008fa4b7 : OR EDX,EAX
008fa4b9 : DEC ECX
008fa4ba : PUSH EDX
008fa4bb : MOV byte ptr [EBP + -0x49],0x0
008fa4bf : CALL 0x00ab4680
008fa4c4 : MOV ECX,dword ptr [EBX]
008fa4c6 : MOV ESI,dword ptr [EBP + -0x60]
008fa4c9 : ADD ESP,0x10
008fa4cc : PUSH 0x0
008fa4ce : PUSH 0x3
008fa4d0 : LEA EAX,[EBP + -0x2c]
008fa4d3 : LEA EDX,[ECX + 0x1]
008fa4d6 : PUSH EAX
008fa4d7 : MOV dword ptr [EBX],EDX
008fa4d9 : CALL 0x008f9b20
008fa4de : MOV ESI,dword ptr [EBP + -0x50]
008fa4e1 : MOV EAX,dword ptr [EBP + -0x58]
008fa4e4 : INC EAX
008fa4e5 : ADD ESI,0x4
008fa4e8 : CMP EAX,0xa
008fa4eb : MOV dword ptr [EBP + -0x58],EAX
008fa4ee : MOV dword ptr [EBP + -0x50],ESI
008fa4f1 : JL 0x008fa46c
008fa4f7 : MOV ESI,dword ptr [EBP + -0x5c]
008fa4fa : ADD ESI,0x524
008fa500 : MOV dword ptr [EBP + -0x50],0x1
008fa507 : MOV dword ptr [EBP + -0x58],ESI
008fa50a : LEA EBX,[EBX]
008fa510 : CMP dword ptr [ESI],0x0
008fa513 : JZ 0x008fa59f
008fa519 : MOVZX ECX,word ptr [ESI]
008fa51c : MOVZX EDI,word ptr [ESI + 0x2]
008fa520 : PUSH 0x700
008fa525 : MOV dword ptr [EBP + -0x54],ECX
008fa528 : CALL 0x00703c00
008fa52d : ADD ESP,0x4
008fa530 : TEST EAX,EAX
008fa532 : JZ 0x008fa589
008fa534 : MOV EDX,dword ptr [0x0172491c]
008fa53a : CMP dword ptr [EDX + 0x17c],0x0
008fa541 : JZ 0x008fa6ae
008fa547 : MOV ECX,dword ptr [EBP + -0x54]
008fa54a : PUSH 0x1
008fa54c : LEA EDX,[EBP + -0x49]
008fa54f : PUSH EDX
008fa550 : LEA EDX,[EBP + -0x2c]
008fa553 : PUSH EDX
008fa554 : MOVZX EDX,word ptr [EAX + 0x4]
008fa558 : MOVZX EAX,word ptr [EAX + 0x6]
008fa55c : SHL EDX,0x10
008fa55f : OR EDX,EAX
008fa561 : DEC ECX
008fa562 : PUSH EDX
008fa563 : MOV byte ptr [EBP + -0x49],0x0
008fa567 : CALL 0x00ab4680
008fa56c : MOV ECX,dword ptr [EBX]
008fa56e : MOV ESI,dword ptr [EBP + -0x60]
008fa571 : ADD ESP,0x10
008fa574 : PUSH 0x0
008fa576 : PUSH 0x3
008fa578 : LEA EAX,[EBP + -0x2c]
008fa57b : LEA EDX,[ECX + 0x1]
008fa57e : PUSH EAX
008fa57f : MOV dword ptr [EBX],EDX
008fa581 : CALL 0x008f9b20
008fa586 : MOV ESI,dword ptr [EBP + -0x58]
008fa589 : MOV EAX,dword ptr [EBP + -0x50]
008fa58c : INC EAX
008fa58d : ADD ESI,0x4
008fa590 : CMP EAX,0xa
008fa593 : MOV dword ptr [EBP + -0x50],EAX
008fa596 : MOV dword ptr [EBP + -0x58],ESI
008fa599 : JL 0x008fa510
008fa59f : MOV ESI,dword ptr [EBP + -0x5c]
008fa5a2 : ADD ESI,0x4d4
008fa5a8 : MOV dword ptr [EBP + -0x50],0x1
008fa5af : MOV dword ptr [EBP + -0x5c],ESI
008fa5b2 : CMP dword ptr [ESI],0x0
008fa5b5 : JZ 0x008fa641
008fa5bb : MOVZX EAX,word ptr [ESI]
008fa5be : MOVZX EDI,word ptr [ESI + 0x2]
008fa5c2 : PUSH 0x700
008fa5c7 : MOV dword ptr [EBP + -0x54],EAX
008fa5ca : CALL 0x00703c00
008fa5cf : ADD ESP,0x4
008fa5d2 : TEST EAX,EAX
008fa5d4 : JZ 0x008fa62b
008fa5d6 : MOV ECX,dword ptr [0x0172491c]
008fa5dc : CMP dword ptr [ECX + 0x17c],0x0
008fa5e3 : JZ 0x008fa6ae
008fa5e9 : MOV ECX,dword ptr [EBP + -0x54]
008fa5ec : PUSH 0x1
008fa5ee : LEA EDX,[EBP + -0x49]
008fa5f1 : PUSH EDX
008fa5f2 : LEA EDX,[EBP + -0x2c]
008fa5f5 : PUSH EDX
008fa5f6 : MOVZX EDX,word ptr [EAX + 0x4]
008fa5fa : MOVZX EAX,word ptr [EAX + 0x6]
008fa5fe : SHL EDX,0x10
008fa601 : OR EDX,EAX
008fa603 : DEC ECX
008fa604 : PUSH EDX
008fa605 : MOV byte ptr [EBP + -0x49],0x0
008fa609 : CALL 0x00ab4680
008fa60e : MOV ECX,dword ptr [EBX]
008fa610 : MOV ESI,dword ptr [EBP + -0x60]
008fa613 : ADD ESP,0x10
008fa616 : PUSH 0x0
008fa618 : PUSH 0x3
008fa61a : LEA EAX,[EBP + -0x2c]
008fa61d : LEA EDX,[ECX + 0x1]
008fa620 : PUSH EAX
008fa621 : MOV dword ptr [EBX],EDX
008fa623 : CALL 0x008f9b20
008fa628 : MOV ESI,dword ptr [EBP + -0x5c]
008fa62b : MOV EAX,dword ptr [EBP + -0x50]
008fa62e : INC EAX
008fa62f : ADD ESI,0x4
008fa632 : CMP EAX,0xa
008fa635 : MOV dword ptr [EBP + -0x50],EAX
008fa638 : MOV dword ptr [EBP + -0x5c],ESI
008fa63b : JL 0x008fa5b2
008fa641 : MOV byte ptr [EBP + -0x4],0x0
008fa645 : CMP dword ptr [EBP + -0x14],0x8
008fa649 : JC 0x008fa653
008fa64b : MOV ECX,dword ptr [EBP + -0x28]
008fa64e : CALL 0x006f04e0
008fa653 : XOR EAX,EAX
008fa655 : MOV dword ptr [EBP + -0x14],0x7
008fa65c : MOV dword ptr [EBP + -0x18],0x0
008fa663 : MOV word ptr [EBP + -0x28],AX
008fa667 : MOV dword ptr [EBP + -0x4],0xffffffff
008fa66e : CMP dword ptr [EBP + -0x30],0x8
008fa672 : JC 0x008fa67c
008fa674 : MOV ECX,dword ptr [EBP + -0x44]
008fa677 : CALL 0x006f04e0
008fa67c : XOR ECX,ECX
008fa67e : MOV dword ptr [EBP + -0x30],0x7
008fa685 : MOV dword ptr [EBP + -0x34],0x0
008fa68c : MOV word ptr [EBP + -0x44],CX
008fa690 : MOV ECX,dword ptr [EBP + -0xc]
008fa693 : MOV dword ptr FS:[0x0],ECX
008fa69a : POP ECX
008fa69b : POP EDI
008fa69c : POP ESI
008fa69d : POP EBX
008fa69e : MOV ECX,dword ptr [EBP + -0x10]
008fa6a1 : XOR ECX,EBP
008fa6a3 : CALL 0x00633e6b
008fa6a8 : MOV ESP,EBP
008fa6aa : POP EBP
008fa6ab : RET 0x8
008fa6ae : MOV byte ptr [EBP + -0x4],0x0
008fa6b2 : MOV EDI,0x8
008fa6b7 : CMP dword ptr [EBP + -0x14],EDI
008fa6ba : JC 0x008fa6c4
008fa6bc : MOV ECX,dword ptr [EBP + -0x28]
008fa6bf : CALL 0x006f04e0
008fa6c4 : MOV ESI,0x7
008fa6c9 : XOR EBX,EBX
008fa6cb : XOR ECX,ECX
008fa6cd : MOV dword ptr [EBP + -0x14],ESI
008fa6d0 : MOV dword ptr [EBP + -0x18],EBX
008fa6d3 : MOV word ptr [EBP + -0x28],CX
008fa6d7 : MOV dword ptr [EBP + -0x4],0xffffffff
008fa6de : CMP dword ptr [EBP + -0x30],EDI
008fa6e1 : JC 0x008fa6eb
008fa6e3 : MOV ECX,dword ptr [EBP + -0x44]
008fa6e6 : CALL 0x006f04e0
008fa6eb : XOR EDX,EDX
008fa6ed : MOV dword ptr [EBP + -0x30],ESI
008fa6f0 : MOV dword ptr [EBP + -0x34],EBX
008fa6f3 : MOV word ptr [EBP + -0x44],DX
008fa6f7 : JMP 0x008fa690

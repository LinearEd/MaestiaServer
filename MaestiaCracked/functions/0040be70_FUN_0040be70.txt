PROGRAM  : Maestia.exe
FUNCTION : FUN_0040be70
ENTRY    : 0040be70
BODY     : [[0040be70, 0040c0b6] [0040c0bd, 0040c0c3] [0040c0cb, 0040c0de]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Type propagation algorithm not settling */

void FUN_0040be70(int **param_1,undefined4 param_2)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  int *piVar6;
  int **ppiVar7;
  undefined1 *puVar8;
  uint uVar9;
  int *local_164 [3];
  undefined1 local_158 [276];
  undefined1 local_44 [28];
  int local_28;
  int local_24;
  int *local_20;
  int *local_1c;
  int *local_18;
  int **local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7ed7e;
  local_10 = ExceptionList;
  if (param_1[2] < (int *)0x2) {
    return;
  }
  ExceptionList = &local_10;
  piVar6 = (int *)FUN_00408190(DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
  local_18 = (int *)0x0;
  local_8 = 0;
  local_1c = piVar6;
  _eh_vector_constructor_iterator_(local_164,0xc,0x1a,FUN_004072f0,FUN_00407310);
  local_8 = CONCAT31(local_8._1_3_,1);
  local_14 = (int **)0x0;
  piVar1 = param_1[2];
  do {
    if (piVar1 == (int *)0x0) {
      if (1 < local_14) {
        local_24 = (int)local_14 - 1;
        puVar8 = local_158;
        do {
          FUN_0040c460(puVar8,puVar8 + -0xc,param_2);
          puVar8 = puVar8 + 0xc;
          local_24 = local_24 + -1;
        } while (local_24 != 0);
      }
      local_28 = *param_1[1];
      iVar2 = (int)local_14 * 0xc;
      local_14 = (int **)(local_158 + iVar2 + -0x18);
      if ((param_1 != (int **)(local_158 + iVar2 + -0x18)) &&
         (local_24 = *(int *)(local_158 + iVar2 + -0x10), *(int *)(local_158 + iVar2 + -0x10) != 0))
      {
        piVar1 = *(int **)(local_158 + iVar2 + -0x14);
        iVar2 = *piVar1;
        FUN_004093f0();
        local_14[2] = (int *)((int)local_14[2] - local_24);
        **(int **)(iVar2 + 4) = (int)piVar1;
        *(int *)piVar1[1] = local_28;
        **(int **)(local_28 + 4) = iVar2;
        uVar5 = *(undefined4 *)(local_28 + 4);
        *(int *)(local_28 + 4) = piVar1[1];
        piVar1[1] = *(int *)(iVar2 + 4);
        *(undefined4 *)(iVar2 + 4) = uVar5;
      }
      local_8 = local_8 & 0xffffff00;
      _eh_vector_destructor_iterator_(local_164,0xc,0x1a,FUN_00407310);
      local_8 = 0xffffffff;
      piVar1 = (int *)*piVar6;
      *piVar6 = (int)piVar6;
      piVar6[1] = (int)piVar6;
      local_18 = (int *)0x0;
      if (piVar1 != piVar6) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    piVar1 = (int *)*param_1[1];
    iVar2 = *piVar1;
    iVar3 = *piVar6;
    if (&local_20 != param_1) {
      FUN_004093f0();
      param_1[2] = (int *)((int)param_1[2] + -1);
    }
    *(int *)piVar1[1] = iVar2;
    **(int **)(iVar2 + 4) = iVar3;
    **(int **)(iVar3 + 4) = (int)piVar1;
    iVar4 = *(int *)(iVar3 + 4);
    *(undefined4 *)(iVar3 + 4) = *(undefined4 *)(iVar2 + 4);
    *(int *)(iVar2 + 4) = piVar1[1];
    piVar1[1] = iVar4;
    uVar9 = 0;
    if (local_14 == (int **)0x0) {
LAB_0040bf9f:
      if (local_164 + uVar9 * 3 != &local_20) {
        ppiVar7 = local_164 + uVar9 * 3 + 1;
        if (ppiVar7 != &local_1c) {
          piVar1 = *ppiVar7;
          *ppiVar7 = local_1c;
          local_1c = piVar1;
        }
        ppiVar7 = (int **)(local_158 + uVar9 * 0xc + -4);
        if (ppiVar7 != &local_18) {
          piVar1 = *ppiVar7;
          *ppiVar7 = local_18;
          local_18 = piVar1;
        }
      }
      if ((int **)uVar9 == local_14) {
        local_14 = (int **)((int)local_14 + 1);
      }
    }
    else {
      ppiVar7 = local_164 + 2;
      do {
        if (*ppiVar7 == (int *)0x0) break;
        FUN_0040c460(ppiVar7 + -2,&local_20,param_2);
        if (ppiVar7 + -2 != &local_20) {
          if (ppiVar7 + -1 != &local_1c) {
            piVar1 = ppiVar7[-1];
            ppiVar7[-1] = local_1c;
            local_1c = piVar1;
          }
          if (ppiVar7 != &local_18) {
            piVar1 = *ppiVar7;
            *ppiVar7 = local_18;
            local_18 = piVar1;
          }
        }
        uVar9 = uVar9 + 1;
        ppiVar7 = ppiVar7 + 3;
      } while (uVar9 < local_14);
      if (uVar9 != 0x19) goto LAB_0040bf9f;
      FUN_0040c460(local_44,&local_20,param_2);
    }
    piVar1 = param_1[2];
    piVar6 = local_1c;
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
0040be70 : PUSH EBP
0040be71 : MOV EBP,ESP
0040be73 : PUSH -0x1
0040be75 : PUSH 0xb7ed7e
0040be7a : MOV EAX,FS:[0x0]
0040be80 : PUSH EAX
0040be81 : SUB ESP,0x154
0040be87 : PUSH EBX
0040be88 : PUSH ESI
0040be89 : PUSH EDI
0040be8a : MOV EAX,[0x00d66fa0]
0040be8f : XOR EAX,EBP
0040be91 : PUSH EAX
0040be92 : LEA EAX,[EBP + -0xc]
0040be95 : MOV FS:[0x0],EAX
0040be9b : MOV EDI,dword ptr [EBP + 0x8]
0040be9e : CMP dword ptr [EDI + 0x8],0x2
0040bea2 : JC 0x0040c0cb
0040bea8 : CALL 0x00408190
0040bead : MOV EBX,EAX
0040beaf : XOR ESI,ESI
0040beb1 : MOV dword ptr [EBP + -0x18],EBX
0040beb4 : MOV dword ptr [EBP + -0x14],ESI
0040beb7 : MOV dword ptr [EBP + -0x4],ESI
0040beba : PUSH 0x407310
0040bebf : PUSH 0x4072f0
0040bec4 : PUSH 0x1a
0040bec6 : PUSH 0xc
0040bec8 : LEA EAX,[EBP + 0xfffffea0]
0040bece : PUSH EAX
0040becf : CALL 0x0063619b
0040bed4 : MOV byte ptr [EBP + -0x4],0x1
0040bed8 : XOR EAX,EAX
0040beda : MOV dword ptr [EBP + -0x10],EAX
0040bedd : CMP dword ptr [EDI + 0x8],ESI
0040bee0 : JZ 0x0040bff5
0040bee6 : MOV EAX,dword ptr [EDI + 0x4]
0040bee9 : MOV ECX,dword ptr [EAX]
0040beeb : MOV ESI,dword ptr [ECX]
0040beed : MOV EBX,dword ptr [EBX]
0040beef : LEA EDX,[EBP + -0x1c]
0040bef2 : MOV EDI,ECX
0040bef4 : CMP EDX,dword ptr [EBP + 0x8]
0040bef7 : JZ 0x0040bf09
0040bef9 : MOV ECX,0x1
0040befe : CALL 0x004093f0
0040bf03 : MOV EAX,dword ptr [EBP + 0x8]
0040bf06 : DEC dword ptr [EAX + 0x8]
0040bf09 : MOV EAX,dword ptr [EDI + 0x4]
0040bf0c : MOV dword ptr [EAX],ESI
0040bf0e : MOV EAX,dword ptr [ESI + 0x4]
0040bf11 : MOV dword ptr [EAX],EBX
0040bf13 : MOV EAX,dword ptr [EBX + 0x4]
0040bf16 : MOV dword ptr [EAX],EDI
0040bf18 : MOV ECX,dword ptr [ESI + 0x4]
0040bf1b : MOV EAX,dword ptr [EBX + 0x4]
0040bf1e : MOV dword ptr [EBX + 0x4],ECX
0040bf21 : MOV EDX,dword ptr [EDI + 0x4]
0040bf24 : MOV dword ptr [ESI + 0x4],EDX
0040bf27 : MOV dword ptr [EDI + 0x4],EAX
0040bf2a : XOR EDI,EDI
0040bf2c : CMP dword ptr [EBP + -0x10],EDI
0040bf2f : JBE 0x0040bf9f
0040bf31 : LEA ESI,[EBP + 0xfffffea8]
0040bf37 : CMP dword ptr [ESI],0x0
0040bf3a : JZ 0x0040bf87
0040bf3c : MOV EAX,dword ptr [EBP + 0xc]
0040bf3f : PUSH EAX
0040bf40 : LEA ECX,[EBP + -0x1c]
0040bf43 : PUSH ECX
0040bf44 : LEA EDX,[ESI + -0x8]
0040bf47 : PUSH EDX
0040bf48 : CALL 0x0040c460
0040bf4d : LEA EAX,[ESI + -0x8]
0040bf50 : LEA ECX,[EBP + -0x1c]
0040bf53 : CMP EAX,ECX
0040bf55 : JZ 0x0040bf7e
0040bf57 : LEA EDX,[ESI + -0x4]
0040bf5a : LEA EAX,[EBP + -0x18]
0040bf5d : CMP EDX,EAX
0040bf5f : JZ 0x0040bf6d
0040bf61 : MOV EAX,dword ptr [ESI + -0x4]
0040bf64 : MOV ECX,dword ptr [EBP + -0x18]
0040bf67 : MOV dword ptr [ESI + -0x4],ECX
0040bf6a : MOV dword ptr [EBP + -0x18],EAX
0040bf6d : LEA EDX,[EBP + -0x14]
0040bf70 : CMP ESI,EDX
0040bf72 : JZ 0x0040bf7e
0040bf74 : MOV EAX,dword ptr [ESI]
0040bf76 : MOV ECX,dword ptr [EBP + -0x14]
0040bf79 : MOV dword ptr [ESI],ECX
0040bf7b : MOV dword ptr [EBP + -0x14],EAX
0040bf7e : INC EDI
0040bf7f : ADD ESI,0xc
0040bf82 : CMP EDI,dword ptr [EBP + -0x10]
0040bf85 : JC 0x0040bf37
0040bf87 : CMP EDI,0x19
0040bf8a : JNZ 0x0040bf9f
0040bf8c : MOV EDX,dword ptr [EBP + 0xc]
0040bf8f : PUSH EDX
0040bf90 : LEA EAX,[EBP + -0x1c]
0040bf93 : PUSH EAX
0040bf94 : LEA ECX,[EBP + -0x40]
0040bf97 : PUSH ECX
0040bf98 : CALL 0x0040c460
0040bf9d : JMP 0x0040bfe0
0040bf9f : LEA ECX,[EDI + EDI*0x2]
0040bfa2 : LEA ECX,[EBP + ECX*0x4 + 0xfffffea0]
0040bfa9 : LEA EDX,[EBP + -0x1c]
0040bfac : CMP ECX,EDX
0040bfae : JZ 0x0040bfd8
0040bfb0 : LEA EAX,[ECX + 0x4]
0040bfb3 : LEA EDX,[EBP + -0x18]
0040bfb6 : CMP EAX,EDX
0040bfb8 : JZ 0x0040bfc4
0040bfba : MOV EDX,dword ptr [EAX]
0040bfbc : MOV ESI,dword ptr [EBP + -0x18]
0040bfbf : MOV dword ptr [EAX],ESI
0040bfc1 : MOV dword ptr [EBP + -0x18],EDX
0040bfc4 : LEA EAX,[ECX + 0x8]
0040bfc7 : LEA ECX,[EBP + -0x14]
0040bfca : CMP EAX,ECX
0040bfcc : JZ 0x0040bfd8
0040bfce : MOV ECX,dword ptr [EAX]
0040bfd0 : MOV EDX,dword ptr [EBP + -0x14]
0040bfd3 : MOV dword ptr [EAX],EDX
0040bfd5 : MOV dword ptr [EBP + -0x14],ECX
0040bfd8 : CMP EDI,dword ptr [EBP + -0x10]
0040bfdb : JNZ 0x0040bfe0
0040bfdd : INC dword ptr [EBP + -0x10]
0040bfe0 : MOV EAX,dword ptr [EBP + 0x8]
0040bfe3 : CMP dword ptr [EAX + 0x8],0x0
0040bfe7 : MOV EBX,dword ptr [EBP + -0x18]
0040bfea : MOV EDI,EAX
0040bfec : JNZ 0x0040bee6
0040bff2 : MOV EAX,dword ptr [EBP + -0x10]
0040bff5 : CMP EAX,0x1
0040bff8 : JBE 0x0040c01b
0040bffa : DEC EAX
0040bffb : LEA ESI,[EBP + 0xfffffeac]
0040c001 : MOV dword ptr [EBP + -0x20],EAX
0040c004 : MOV ECX,dword ptr [EBP + 0xc]
0040c007 : PUSH ECX
0040c008 : LEA EDX,[ESI + -0xc]
0040c00b : PUSH EDX
0040c00c : PUSH ESI
0040c00d : CALL 0x0040c460
0040c012 : ADD ESI,0xc
0040c015 : SUB dword ptr [EBP + -0x20],0x1
0040c019 : JNZ 0x0040c004
0040c01b : MOV EAX,dword ptr [EDI + 0x4]
0040c01e : MOV EAX,dword ptr [EAX]
0040c020 : MOV dword ptr [EBP + -0x24],EAX
0040c023 : MOV EAX,dword ptr [EBP + -0x10]
0040c026 : LEA EAX,[EAX + EAX*0x2]
0040c029 : LEA EAX,[EBP + EAX*0x4 + 0xfffffe94]
0040c030 : MOV dword ptr [EBP + -0x10],EAX
0040c033 : CMP EDI,EAX
0040c035 : JZ 0x0040c07b
0040c037 : MOV ECX,dword ptr [EAX + 0x8]
0040c03a : MOV dword ptr [EBP + -0x20],ECX
0040c03d : TEST ECX,ECX
0040c03f : JZ 0x0040c07b
0040c041 : MOV ESI,dword ptr [EAX + 0x4]
0040c044 : MOV EDX,dword ptr [EBP + 0x8]
0040c047 : MOV EDI,dword ptr [ESI]
0040c049 : CALL 0x004093f0
0040c04e : MOV ECX,dword ptr [EBP + -0x20]
0040c051 : MOV EAX,dword ptr [EBP + -0x10]
0040c054 : SUB dword ptr [EAX + 0x8],ECX
0040c057 : MOV EAX,dword ptr [EDI + 0x4]
0040c05a : MOV dword ptr [EAX],ESI
0040c05c : MOV ECX,dword ptr [ESI + 0x4]
0040c05f : MOV EAX,dword ptr [EBP + -0x24]
0040c062 : MOV dword ptr [ECX],EAX
0040c064 : MOV ECX,dword ptr [EAX + 0x4]
0040c067 : MOV dword ptr [ECX],EDI
0040c069 : MOV ECX,dword ptr [EAX + 0x4]
0040c06c : MOV EDX,dword ptr [ESI + 0x4]
0040c06f : MOV dword ptr [EAX + 0x4],EDX
0040c072 : MOV EAX,dword ptr [EDI + 0x4]
0040c075 : MOV dword ptr [ESI + 0x4],EAX
0040c078 : MOV dword ptr [EDI + 0x4],ECX
0040c07b : MOV byte ptr [EBP + -0x4],0x0
0040c07f : PUSH 0x407310
0040c084 : PUSH 0x1a
0040c086 : PUSH 0xc
0040c088 : LEA ECX,[EBP + 0xfffffea0]
0040c08e : PUSH ECX
0040c08f : CALL 0x0063625e
0040c094 : MOV dword ptr [EBP + -0x4],0xffffffff
0040c09b : MOV ECX,dword ptr [EBX]
0040c09d : MOV dword ptr [EBX],EBX
0040c09f : MOV dword ptr [EBX + 0x4],EBX
0040c0a2 : MOV dword ptr [EBP + -0x14],0x0
0040c0a9 : CMP ECX,EBX
0040c0ab : JZ 0x0040c0bd
0040c0ad : LEA ECX,[ECX]
0040c0b0 : MOV ESI,dword ptr [ECX]
0040c0b2 : CALL 0x006f04e0
0040c0bd : MOV ECX,EBX
0040c0bf : CALL 0x006f04e0
0040c0cb : MOV ECX,dword ptr [EBP + -0xc]
0040c0ce : MOV dword ptr FS:[0x0],ECX
0040c0d5 : POP ECX
0040c0d6 : POP EDI
0040c0d7 : POP ESI
0040c0d8 : POP EBX
0040c0d9 : MOV ESP,EBP
0040c0db : POP EBP
0040c0dc : RET 0x8

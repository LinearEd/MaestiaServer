PROGRAM  : Maestia.exe
FUNCTION : FUN_0070d550
ENTRY    : 0070d550
BODY     : [[0070d550, 0070d70e]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe_16 replaced with injection: alloca_probe */

void FUN_0070d550(LPCSTR param_1,LPCSTR param_2)

{
  char cVar1;
  short sVar2;
  int iVar3;
  LPCSTR pCVar4;
  short *psVar5;
  uint *puVar6;
  uint *puVar7;
  uint local_60;
  undefined1 local_50 [4];
  undefined2 local_4c;
  undefined4 local_3c;
  uint local_38;
  undefined1 local_34 [4];
  undefined2 local_30;
  undefined4 local_20;
  uint local_1c;
  int *local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b178d7;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_60 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (param_2 == (LPCSTR)0x0) {
    puVar6 = (uint *)&DAT_00bfd7b4;
  }
  else {
    iVar3 = lstrlenA(param_2);
    if (iVar3 + 1 < 0x40000000) {
      puVar6 = &local_60;
      pCVar4 = param_2;
      do {
        cVar1 = *pCVar4;
        pCVar4 = pCVar4 + 1;
      } while (cVar1 != '\0');
      iVar3 = MultiByteToWideChar(0,0,param_2,-1,(LPWSTR)&local_60,
                                  (int)(pCVar4 + (1 - (int)(param_2 + 1))));
      if (iVar3 == 0) {
        puVar6 = (uint *)&DAT_00cca49c;
      }
    }
    else {
      puVar6 = (uint *)&DAT_00bfd7b8;
    }
  }
  if (param_1 == (LPCSTR)0x0) {
    puVar7 = (uint *)&DAT_00bfd7bc;
  }
  else {
    iVar3 = lstrlenA(param_1);
    if (iVar3 + 1 < 0x40000000) {
      puVar7 = &local_60;
      pCVar4 = param_1;
      do {
        cVar1 = *pCVar4;
        pCVar4 = pCVar4 + 1;
      } while (cVar1 != '\0');
      iVar3 = MultiByteToWideChar(0,0,param_1,-1,(LPWSTR)&local_60,
                                  (int)(pCVar4 + (1 - (int)(param_1 + 1))));
      if (iVar3 == 0) {
        puVar7 = (uint *)&DAT_00cca49c;
      }
    }
    else {
      puVar7 = (uint *)&DAT_00bfd7c0;
    }
  }
  local_4c = 0;
  local_38 = 7;
  local_3c = 0;
  psVar5 = (short *)puVar6;
  do {
    sVar2 = *psVar5;
    psVar5 = psVar5 + 1;
  } while (sVar2 != 0);
  FUN_00406360(puVar6,(int)psVar5 - (int)((int)puVar6 + 2) >> 1);
  local_8 = 0;
  local_1c = 7;
  local_20 = 0;
  local_30 = 0;
  psVar5 = (short *)puVar7;
  do {
    sVar2 = *psVar5;
    psVar5 = psVar5 + 1;
  } while (sVar2 != 0);
  FUN_00406360(puVar7,(int)psVar5 - (int)((int)puVar7 + 2) >> 1);
  local_8._0_1_ = 1;
  (**(code **)(*local_18 + 4))(local_34,local_50);
  local_8 = (uint)local_8._1_3_ << 8;
  if (local_1c < 8) {
    local_1c = 7;
    local_20 = 0;
    local_30 = 0;
    local_8 = 0xffffffff;
    if (local_38 < 8) {
      local_38 = 7;
      local_3c = 0;
      local_4c = 0;
      ExceptionList = local_10;
      __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
      return;
    }
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
0070d550 : PUSH EBP
0070d551 : MOV EBP,ESP
0070d553 : PUSH -0x1
0070d555 : PUSH 0xb178d7
0070d55a : MOV EAX,FS:[0x0]
0070d560 : PUSH EAX
0070d561 : SUB ESP,0x40
0070d564 : MOV EAX,[0x00d66fa0]
0070d569 : XOR EAX,EBP
0070d56b : MOV dword ptr [EBP + -0x10],EAX
0070d56e : PUSH EBX
0070d56f : PUSH ESI
0070d570 : PUSH EDI
0070d571 : PUSH EAX
0070d572 : LEA EAX,[EBP + -0xc]
0070d575 : MOV FS:[0x0],EAX
0070d57b : MOV dword ptr [EBP + -0x14],ECX
0070d57e : MOV ESI,dword ptr [EBP + 0xc]
0070d581 : TEST ESI,ESI
0070d583 : JNZ 0x0070d58c
0070d585 : MOV EBX,0xbfd7b4
0070d58a : JMP 0x0070d5d4
0070d58c : PUSH ESI
0070d58d : CALL dword ptr [0x00b85190]
0070d593 : INC EAX
0070d594 : CMP EAX,0x3fffffff
0070d599 : JLE 0x0070d5a2
0070d59b : MOV EDI,0xbfd7b8
0070d5a0 : JMP 0x0070d5d2
0070d5a2 : ADD EAX,EAX
0070d5a4 : CALL 0x0065bd80
0070d5a9 : MOV EAX,ESI
0070d5ab : MOV EDI,ESP
0070d5ad : LEA EDX,[EAX + 0x1]
0070d5b0 : MOV CL,byte ptr [EAX]
0070d5b2 : INC EAX
0070d5b3 : TEST CL,CL
0070d5b5 : JNZ 0x0070d5b0
0070d5b7 : SUB EAX,EDX
0070d5b9 : INC EAX
0070d5ba : PUSH EAX
0070d5bb : PUSH EDI
0070d5bc : PUSH -0x1
0070d5be : PUSH ESI
0070d5bf : PUSH 0x0
0070d5c1 : PUSH 0x0
0070d5c3 : CALL dword ptr [0x00b850e0]
0070d5c9 : TEST EAX,EAX
0070d5cb : JNZ 0x0070d5d2
0070d5cd : MOV EDI,0xcca49c
0070d5d2 : MOV EBX,EDI
0070d5d4 : MOV ESI,dword ptr [EBP + 0x8]
0070d5d7 : TEST ESI,ESI
0070d5d9 : JNZ 0x0070d5e2
0070d5db : MOV ESI,0xbfd7bc
0070d5e0 : JMP 0x0070d62a
0070d5e2 : PUSH ESI
0070d5e3 : CALL dword ptr [0x00b85190]
0070d5e9 : INC EAX
0070d5ea : CMP EAX,0x3fffffff
0070d5ef : JLE 0x0070d5f8
0070d5f1 : MOV EDI,0xbfd7c0
0070d5f6 : JMP 0x0070d628
0070d5f8 : ADD EAX,EAX
0070d5fa : CALL 0x0065bd80
0070d5ff : MOV EAX,ESI
0070d601 : MOV EDI,ESP
0070d603 : LEA EDX,[EAX + 0x1]
0070d606 : MOV CL,byte ptr [EAX]
0070d608 : INC EAX
0070d609 : TEST CL,CL
0070d60b : JNZ 0x0070d606
0070d60d : SUB EAX,EDX
0070d60f : INC EAX
0070d610 : PUSH EAX
0070d611 : PUSH EDI
0070d612 : PUSH -0x1
0070d614 : PUSH ESI
0070d615 : PUSH 0x0
0070d617 : PUSH 0x0
0070d619 : CALL dword ptr [0x00b850e0]
0070d61f : TEST EAX,EAX
0070d621 : JNZ 0x0070d628
0070d623 : MOV EDI,0xcca49c
0070d628 : MOV ESI,EDI
0070d62a : XOR EAX,EAX
0070d62c : MOV word ptr [EBP + -0x48],AX
0070d630 : MOV EDI,0x7
0070d635 : MOV EAX,EBX
0070d637 : MOV dword ptr [EBP + -0x34],EDI
0070d63a : MOV dword ptr [EBP + -0x38],0x0
0070d641 : LEA EDX,[EAX + 0x2]
0070d644 : MOV CX,word ptr [EAX]
0070d647 : ADD EAX,0x2
0070d64a : TEST CX,CX
0070d64d : JNZ 0x0070d644
0070d64f : SUB EAX,EDX
0070d651 : SAR EAX,0x1
0070d653 : PUSH EAX
0070d654 : PUSH EBX
0070d655 : LEA ECX,[EBP + -0x4c]
0070d658 : CALL 0x00406360
0070d65d : XOR EBX,EBX
0070d65f : MOV dword ptr [EBP + -0x4],EBX
0070d662 : XOR ECX,ECX
0070d664 : MOV EAX,ESI
0070d666 : MOV dword ptr [EBP + -0x18],EDI
0070d669 : MOV dword ptr [EBP + -0x1c],EBX
0070d66c : MOV word ptr [EBP + -0x2c],CX
0070d670 : LEA EDX,[EAX + 0x2]
0070d673 : MOV CX,word ptr [EAX]
0070d676 : ADD EAX,0x2
0070d679 : CMP CX,BX
0070d67c : JNZ 0x0070d673
0070d67e : SUB EAX,EDX
0070d680 : SAR EAX,0x1
0070d682 : PUSH EAX
0070d683 : PUSH ESI
0070d684 : LEA ECX,[EBP + -0x30]
0070d687 : CALL 0x00406360
0070d68c : MOV byte ptr [EBP + -0x4],0x1
0070d690 : MOV ECX,dword ptr [EBP + -0x14]
0070d693 : MOV EDX,dword ptr [ECX]
0070d695 : MOV EDX,dword ptr [EDX + 0x4]
0070d698 : LEA EAX,[EBP + -0x4c]
0070d69b : PUSH EAX
0070d69c : LEA EAX,[EBP + -0x30]
0070d69f : PUSH EAX
0070d6a0 : CALL EDX
0070d6a2 : MOV BL,AL
0070d6a4 : MOV byte ptr [EBP + -0x4],0x0
0070d6a8 : MOV ESI,0x8
0070d6ad : CMP dword ptr [EBP + -0x18],ESI
0070d6b0 : JC 0x0070d6ba
0070d6b2 : MOV ECX,dword ptr [EBP + -0x2c]
0070d6b5 : CALL 0x006f04e0
0070d6ba : MOV dword ptr [EBP + -0x18],EDI
0070d6bd : XOR EDI,EDI
0070d6bf : XOR EAX,EAX
0070d6c1 : MOV dword ptr [EBP + -0x1c],EDI
0070d6c4 : MOV word ptr [EBP + -0x2c],AX
0070d6c8 : MOV dword ptr [EBP + -0x4],0xffffffff
0070d6cf : CMP dword ptr [EBP + -0x34],ESI
0070d6d2 : JC 0x0070d6dc
0070d6d4 : MOV ECX,dword ptr [EBP + -0x48]
0070d6d7 : CALL 0x006f04e0
0070d6dc : XOR ECX,ECX
0070d6de : MOV dword ptr [EBP + -0x34],0x7
0070d6e5 : MOV dword ptr [EBP + -0x38],EDI
0070d6e8 : MOV word ptr [EBP + -0x48],CX
0070d6ec : MOV AL,BL
0070d6ee : LEA ESP,[EBP + -0x5c]
0070d6f1 : MOV ECX,dword ptr [EBP + -0xc]
0070d6f4 : MOV dword ptr FS:[0x0],ECX
0070d6fb : POP ECX
0070d6fc : POP EDI
0070d6fd : POP ESI
0070d6fe : POP EBX
0070d6ff : MOV ECX,dword ptr [EBP + -0x10]
0070d702 : XOR ECX,EBP
0070d704 : CALL 0x00633e6b
0070d709 : MOV ESP,EBP
0070d70b : POP EBP
0070d70c : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_0084aa60
ENTRY    : 0084aa60
BODY     : [[0084aa60, 0084b235]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0084aa60(uint *param_1,uint param_2,int param_3,uint *param_4,uint param_5)

{
  short sVar1;
  uint *puVar2;
  int iVar3;
  undefined4 uVar4;
  undefined4 ******ppppppuVar5;
  short *psVar6;
  undefined1 uVar7;
  int iVar8;
  short *psVar9;
  ushort *puVar10;
  uint uVar11;
  uint local_88;
  undefined1 local_84 [4];
  int local_80;
  uint local_7c;
  uint *local_78;
  undefined2 local_70;
  undefined4 local_60;
  uint local_5c;
  undefined1 local_58 [4];
  undefined2 local_54;
  undefined4 local_44;
  uint local_40;
  uint local_3c;
  uint local_38;
  undefined1 local_34 [4];
  undefined4 *****local_30 [4];
  undefined4 local_20;
  uint local_1c;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b5f15b;
  local_10 = ExceptionList;
  local_18 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_78 = param_1;
  local_80 = FUN_006f0760(0x110,"",0,(DAT_01725270 >> 3 & 1) == 0,local_18);
  local_8 = 0;
  if (local_80 == 0) {
    puVar2 = (uint *)0x0;
  }
  else {
    puVar2 = (uint *)FUN_00449360(local_80);
  }
  local_8 = 0xffffffff;
  *(undefined2 *)(puVar2 + 2) = (undefined2)param_3;
  *puVar2 = param_2;
  puVar2[3] = *param_4;
  puVar2[5] = param_5;
  local_3c = param_2;
  FUN_004437f0(&local_3c);
  if ((local_38 != DAT_017245e4) &&
     (uVar11 = *(uint *)(local_38 + 0x10), local_38 = uVar11, uVar11 != 0)) {
    puVar2[1] = uVar11;
    puVar2[4] = 0;
    iVar3 = FUN_006f0c10(local_58,1);
    local_8 = 1;
    if (*(uint *)(iVar3 + 0x18) < 8) {
      psVar9 = (short *)(iVar3 + 4);
    }
    else {
      psVar9 = *(short **)(iVar3 + 4);
    }
    local_30[0] = (undefined4 *****)((uint)local_30[0] & 0xffff0000);
    local_1c = 7;
    local_20 = 0;
    psVar6 = psVar9;
    do {
      sVar1 = *psVar6;
      psVar6 = psVar6 + 1;
    } while (sVar1 != 0);
    FUN_00406360(psVar9,(int)psVar6 - (int)(psVar9 + 1) >> 1);
    local_8._0_1_ = 3;
    if (7 < local_40) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_54 = 0;
    local_40 = 7;
    local_44 = 0;
    FUN_00848d40(local_34,0);
    ppppppuVar5 = (undefined4 ******)local_30[0];
    if (local_1c < 8) {
      ppppppuVar5 = local_30;
    }
    uVar4 = FUN_00404750(L"Lv.%d %s",*(undefined1 *)(uVar11 + 0x98),ppppppuVar5);
    local_8._0_1_ = 4;
    FUN_00405eb0(uVar4,0,0xffffffff);
    local_8._0_1_ = 3;
    uVar7 = (undefined1)local_8;
    local_8._0_1_ = 3;
    if (7 < local_40) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_40 = 7;
    local_44 = 0;
    local_54 = 0;
    if (*(char *)(uVar11 + 0x10) == '\x01') {
      ppppppuVar5 = (undefined4 ******)local_30[0];
      if (local_1c < 8) {
        ppppppuVar5 = local_30;
      }
      uVar4 = FUN_00404750(L"<font color=\'#3a1300\' size = \'13\' >Lv.%d </font> <font color=\'#093142\' size = \'16\' >%s</font>"
                           ,*(undefined1 *)(local_38 + 0x98),ppppppuVar5);
      local_8._0_1_ = 5;
    }
    else {
      ppppppuVar5 = (undefined4 ******)local_30[0];
      if (local_1c < 8) {
        ppppppuVar5 = local_30;
      }
      local_8._0_1_ = uVar7;
      uVar4 = FUN_00404750(L"<font color=\'#3a1300\' size = \'13\' >Lv.%d </font> <font color=\'#093142\' size = \'16\' >%s</font>"
                           ,*(undefined1 *)(local_38 + 0x98),ppppppuVar5);
      local_8._0_1_ = 6;
    }
    FUN_00405eb0(uVar4,0,0xffffffff);
    local_8._0_1_ = 3;
    if (7 < local_40) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_54 = 0;
    local_44 = 0;
    local_40 = 7;
    if (param_3 == 2) {
      ppppppuVar5 = (undefined4 ******)local_30[0];
      if (local_1c < 8) {
        ppppppuVar5 = local_30;
      }
      uVar4 = FUN_00404750(L"<font color=\'#3a1300\' size = \'13\' >Lv.%d </font> <font color=\'#920606\' size = \'16\' >%s</font>"
                           ,*(undefined1 *)(local_38 + 0x98),ppppppuVar5);
      local_8._0_1_ = 7;
      FUN_00405eb0(uVar4,0,0xffffffff);
      local_8._0_1_ = 3;
      if (7 < local_40) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
    }
    local_8._0_1_ = 3;
    local_40 = 7;
    local_44 = 0;
    local_54 = 0;
    iVar3 = FUN_006f0c10(local_58,1);
    local_8._0_1_ = 8;
    if (*(uint *)(iVar3 + 0x18) < 8) {
      psVar9 = (short *)(iVar3 + 4);
    }
    else {
      psVar9 = *(short **)(iVar3 + 4);
    }
    psVar6 = psVar9;
    do {
      sVar1 = *psVar6;
      psVar6 = psVar6 + 1;
    } while (sVar1 != 0);
    FUN_00406360(psVar9,(int)psVar6 - (int)(psVar9 + 1) >> 1);
    local_8._0_1_ = 3;
    if (7 < local_40) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_54 = 0;
    local_40 = 7;
    local_44 = 0;
    FUN_00406360(&DAT_00c3be5c,0);
    if (*(int *)(local_38 + 0xac) == 0) {
      iVar3 = FUN_00703c00(0x600);
      if (iVar3 != 0) {
        uVar4 = FUN_00824a20(DAT_0172491c,0);
        local_8._0_1_ = 9;
        FUN_00405eb0(uVar4,0,0xffffffff);
        local_8._0_1_ = 3;
        if (7 < local_88) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_88 = 7;
      }
    }
    else if ((*(int *)(local_38 + 0xac) == 1) && (iVar3 = FUN_00703c00(0x500), iVar3 != 0)) {
      uVar4 = FUN_00824a20(DAT_0172491c,0);
      local_8._0_1_ = 10;
      FUN_00405eb0(uVar4,0,0xffffffff);
      local_8._0_1_ = 3;
      if (7 < local_40) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_40 = 7;
      local_44 = 0;
      local_54 = 0;
    }
    FUN_00406360(&DAT_00c3bf1c,0);
    iVar8 = DAT_00d7c54c;
    iVar3 = *(int *)(local_38 + 0xb4);
    if (iVar3 == 0) {
      iVar3 = FUN_00703c00(0x600);
      if (iVar3 != 0) {
        uVar4 = FUN_00824a20(DAT_0172491c,0);
        local_8._0_1_ = 0xb;
        FUN_00405eb0(uVar4,0,0xffffffff);
        local_8._0_1_ = 3;
        if (7 < local_5c) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_5c = 7;
        local_60 = 0;
        local_70 = 0;
      }
    }
    else if (iVar3 == 1) {
      local_3c = *(ushort *)(local_38 + 0xb8) | 0x66000000;
      FUN_004437f0(&local_3c);
      if ((local_80 != *(int *)(iVar8 + 0x44)) && (*(int *)(local_80 + 0x10) != 0)) {
        uVar4 = FUN_00824a20(DAT_0172491c,0);
        local_8._0_1_ = 0xc;
        FUN_00405eb0(uVar4,0,0xffffffff);
        local_8._0_1_ = 3;
        if (7 < local_40) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_40 = 7;
        local_44 = 0;
        local_54 = 0;
      }
    }
    else if ((iVar3 == 3) && (iVar3 = FUN_00703c00(0x301), iVar3 != 0)) {
      local_3c = (**(code **)(*(int *)(iVar3 + 0x200) + 4))();
joined_r0x0084aef0:
      if (local_3c != 0) {
        iVar3 = FUN_004f5680();
        if (iVar3 != 0) {
          iVar8 = 0;
          puVar10 = (ushort *)(local_38 + 0xc0);
          do {
            if ((ushort)*(byte *)(iVar3 + 0x18) == *puVar10) {
              uVar4 = FUN_00824a20(DAT_0172491c,0);
              local_8._0_1_ = 0xd;
              FUN_00405eb0(uVar4,0,0xffffffff);
              local_8._0_1_ = 3;
              if (7 < local_88) {
                    /* WARNING: Subroutine does not return */
                FUN_006f04e0();
              }
              local_88 = 7;
              break;
            }
            iVar8 = iVar8 + 1;
            puVar10 = puVar10 + 1;
          } while (iVar8 < 1);
        }
        goto joined_r0x0084aef0;
      }
    }
    uVar11 = local_38;
    FUN_00849970(local_38,0);
    iVar3 = FUN_00703c00(0x600);
    if (iVar3 != 0) {
      uVar4 = FUN_00824a20(DAT_0172491c,0);
      local_8._0_1_ = 0xe;
      FUN_00405eb0(uVar4,0,0xffffffff);
      local_8._0_1_ = 3;
      if (7 < local_5c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_5c = 7;
      local_60 = 0;
      local_70 = 0;
      uVar11 = local_38;
    }
    FUN_00406360(&DAT_00c3bfdc,0);
    iVar3 = FUN_00703c00(0x600);
    if (iVar3 != 0) {
      uVar4 = FUN_00824a20(DAT_0172491c,0);
      local_8._0_1_ = 0xf;
      FUN_00405eb0(uVar4,0,0xffffffff);
      local_8._0_1_ = 3;
      if (7 < local_5c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_5c = 7;
      local_60 = 0;
      local_70 = 0;
      uVar11 = local_38;
    }
    *(undefined1 *)(puVar2 + 7) = 1;
    *(undefined1 *)((int)puVar2 + 0x1d) = 0;
    puVar2[6] = 0;
    puVar2[0x43] = local_78[3];
    local_78[3] = local_78[3] + 1;
    *(bool *)(puVar2 + 0x40) = *(char *)(uVar11 + 0x10) == '\x01';
    *(bool *)((int)puVar2 + 0x102) = *(int *)(uVar11 + 0xd8) != 0;
    if ((*(int *)(uVar11 + 0xac) == 2) || (*(int *)(uVar11 + 0xb4) == 2)) {
      uVar7 = 1;
    }
    else {
      uVar7 = 0;
    }
    *(undefined1 *)((int)puVar2 + 0x101) = uVar7;
    local_7c = param_2;
    *(undefined1 *)(puVar2 + 0x42) = 1;
    local_78 = puVar2;
    FUN_00451e00(local_84,&local_7c);
    local_8 = 0xffffffff;
    if (7 < local_1c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_1c = 7;
    local_20 = 0;
    local_30[0] = (undefined4 *****)((uint)local_30[0] & 0xffff0000);
  }
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0084aa60 : PUSH EBP
0084aa61 : MOV EBP,ESP
0084aa63 : PUSH -0x1
0084aa65 : PUSH 0xb5f15b
0084aa6a : MOV EAX,FS:[0x0]
0084aa70 : PUSH EAX
0084aa71 : SUB ESP,0x90
0084aa77 : MOV EAX,[0x00d66fa0]
0084aa7c : XOR EAX,EBP
0084aa7e : MOV dword ptr [EBP + -0x14],EAX
0084aa81 : PUSH EBX
0084aa82 : PUSH ESI
0084aa83 : PUSH EDI
0084aa84 : PUSH EAX
0084aa85 : LEA EAX,[EBP + -0xc]
0084aa88 : MOV FS:[0x0],EAX
0084aa8e : MOV EDI,dword ptr [EBP + 0xc]
0084aa91 : MOV ECX,dword ptr [0x01725270]
0084aa97 : MOV EAX,dword ptr [EBP + 0x8]
0084aa9a : SHR ECX,0x3
0084aa9d : MOV EDX,0x0
0084aaa2 : AND ECX,0x1
0084aaa5 : SETZ DL
0084aaa8 : XOR ESI,ESI
0084aaaa : MOV dword ptr [EBP + -0x74],EAX
0084aaad : PUSH EDX
0084aaae : PUSH ESI
0084aaaf : PUSH 0xbf1a4a
0084aab4 : PUSH 0x110
0084aab9 : CALL 0x006f0760
0084aabe : ADD ESP,0x10
0084aac1 : MOV dword ptr [EBP + -0x7c],EAX
0084aac4 : MOV dword ptr [EBP + -0x4],ESI
0084aac7 : CMP EAX,ESI
0084aac9 : JZ 0x0084aad5
0084aacb : PUSH EAX
0084aacc : CALL 0x00449360
0084aad1 : MOV EBX,EAX
0084aad3 : JMP 0x0084aad7
0084aad5 : XOR EBX,EBX
0084aad7 : MOV dword ptr [EBP + -0x4],0xffffffff
0084aade : MOV AX,word ptr [EBP + 0x10]
0084aae2 : MOV ECX,dword ptr [EBP + 0x14]
0084aae5 : MOV word ptr [EBX + 0x8],AX
0084aae9 : MOV EAX,dword ptr [EBP + 0x18]
0084aaec : MOV dword ptr [EBX],EDI
0084aaee : MOV EDX,dword ptr [ECX]
0084aaf0 : LEA ECX,[EBP + -0x38]
0084aaf3 : MOV dword ptr [EBX + 0xc],EDX
0084aaf6 : MOV dword ptr [EBX + 0x14],EAX
0084aaf9 : PUSH ECX
0084aafa : LEA EAX,[EBP + -0x34]
0084aafd : MOV ECX,0x17245e0
0084ab02 : MOV dword ptr [EBP + -0x38],EDI
0084ab05 : CALL 0x004437f0
0084ab0a : MOV EAX,dword ptr [EBP + -0x34]
0084ab0d : CMP EAX,dword ptr [0x017245e4]
0084ab13 : JZ 0x0084b218
0084ab19 : MOV EDI,dword ptr [EAX + 0x10]
0084ab1c : MOV dword ptr [EBP + -0x34],EDI
0084ab1f : CMP EDI,ESI
0084ab21 : JZ 0x0084b218
0084ab27 : PUSH 0x1
0084ab29 : LEA EDX,[EBP + -0x54]
0084ab2c : MOV dword ptr [EBX + 0x4],EDI
0084ab2f : MOV dword ptr [EBX + 0x10],ESI
0084ab32 : PUSH EDX
0084ab33 : MOV EDX,dword ptr [EDI + 0x8]
0084ab36 : MOV ECX,0x1724628
0084ab3b : CALL 0x006f0c10
0084ab40 : MOV dword ptr [EBP + -0x4],0x1
0084ab47 : CMP dword ptr [EAX + 0x18],0x8
0084ab4b : JC 0x0084ab52
0084ab4d : MOV EDX,dword ptr [EAX + 0x4]
0084ab50 : JMP 0x0084ab55
0084ab52 : LEA EDX,[EAX + 0x4]
0084ab55 : XOR EAX,EAX
0084ab57 : MOV word ptr [EBP + -0x2c],AX
0084ab5b : MOV EAX,EDX
0084ab5d : MOV dword ptr [EBP + -0x18],0x7
0084ab64 : MOV dword ptr [EBP + -0x1c],0x0
0084ab6b : LEA ESI,[EAX + 0x2]
0084ab6e : MOV EDI,EDI
0084ab70 : MOV CX,word ptr [EAX]
0084ab73 : ADD EAX,0x2
0084ab76 : TEST CX,CX
0084ab79 : JNZ 0x0084ab70
0084ab7b : SUB EAX,ESI
0084ab7d : SAR EAX,0x1
0084ab7f : PUSH EAX
0084ab80 : PUSH EDX
0084ab81 : LEA ECX,[EBP + -0x30]
0084ab84 : CALL 0x00406360
0084ab89 : MOV byte ptr [EBP + -0x4],0x3
0084ab8d : CMP dword ptr [EBP + -0x3c],0x8
0084ab91 : JC 0x0084ab9b
0084ab93 : MOV ECX,dword ptr [EBP + -0x50]
0084ab96 : CALL 0x006f04e0
0084ab9b : XOR ECX,ECX
0084ab9d : PUSH ECX
0084ab9e : LEA EDX,[EBP + -0x30]
0084aba1 : MOV word ptr [EBP + -0x50],CX
0084aba5 : PUSH EDX
0084aba6 : MOV ECX,EDX
0084aba8 : MOV dword ptr [EBP + -0x3c],0x7
0084abaf : MOV dword ptr [EBP + -0x40],0x0
0084abb6 : CALL 0x00848d40
0084abbb : CMP dword ptr [EBP + -0x18],0x8
0084abbf : MOV EAX,dword ptr [EBP + -0x2c]
0084abc2 : JNC 0x0084abc7
0084abc4 : LEA EAX,[EBP + -0x2c]
0084abc7 : PUSH EAX
0084abc8 : MOVZX EAX,byte ptr [EDI + 0x98]
0084abcf : PUSH EAX
0084abd0 : PUSH 0xc3bd8c
0084abd5 : LEA ESI,[EBP + -0x54]
0084abd8 : CALL 0x00404750
0084abdd : ADD ESP,0xc
0084abe0 : MOV byte ptr [EBP + -0x4],0x4
0084abe4 : PUSH -0x1
0084abe6 : PUSH 0x0
0084abe8 : LEA ECX,[EBX + 0x20]
0084abeb : PUSH EAX
0084abec : CALL 0x00405eb0
0084abf1 : MOV byte ptr [EBP + -0x4],0x3
0084abf5 : CMP dword ptr [EBP + -0x3c],0x8
0084abf9 : JC 0x0084ac03
0084abfb : MOV ECX,dword ptr [EBP + -0x50]
0084abfe : CALL 0x006f04e0
0084ac03 : MOV EAX,dword ptr [EBP + -0x2c]
0084ac06 : XOR ECX,ECX
0084ac08 : CMP byte ptr [EDI + 0x10],0x1
0084ac0c : MOV dword ptr [EBP + -0x3c],0x7
0084ac13 : MOV dword ptr [EBP + -0x40],0x0
0084ac1a : MOV word ptr [EBP + -0x50],CX
0084ac1e : JNZ 0x0084ac4b
0084ac20 : CMP dword ptr [EBP + -0x18],0x8
0084ac24 : JNC 0x0084ac29
0084ac26 : LEA EAX,[EBP + -0x2c]
0084ac29 : MOV EDX,dword ptr [EBP + -0x34]
0084ac2c : PUSH EAX
0084ac2d : MOVZX EAX,byte ptr [EDX + 0x98]
0084ac34 : PUSH EAX
0084ac35 : PUSH 0xc3bda0
0084ac3a : LEA ESI,[EBP + -0x54]
0084ac3d : CALL 0x00404750
0084ac42 : ADD ESP,0xc
0084ac45 : MOV byte ptr [EBP + -0x4],0x5
0084ac49 : JMP 0x0084ac74
0084ac4b : CMP dword ptr [EBP + -0x18],0x8
0084ac4f : JNC 0x0084ac54
0084ac51 : LEA EAX,[EBP + -0x2c]
0084ac54 : MOV EDX,dword ptr [EBP + -0x34]
0084ac57 : PUSH EAX
0084ac58 : MOVZX EAX,byte ptr [EDX + 0x98]
0084ac5f : PUSH EAX
0084ac60 : PUSH 0xc3be60
0084ac65 : LEA ESI,[EBP + -0x54]
0084ac68 : CALL 0x00404750
0084ac6d : ADD ESP,0xc
0084ac70 : MOV byte ptr [EBP + -0x4],0x6
0084ac74 : PUSH -0x1
0084ac76 : PUSH 0x0
0084ac78 : LEA EDI,[EBX + 0x3c]
0084ac7b : PUSH EAX
0084ac7c : MOV ECX,EDI
0084ac7e : CALL 0x00405eb0
0084ac83 : MOV byte ptr [EBP + -0x4],0x3
0084ac87 : CMP dword ptr [EBP + -0x3c],0x8
0084ac8b : JC 0x0084ac95
0084ac8d : MOV ECX,dword ptr [EBP + -0x50]
0084ac90 : CALL 0x006f04e0
0084ac95 : XOR ECX,ECX
0084ac97 : CMP dword ptr [EBP + 0x10],0x2
0084ac9b : MOV word ptr [EBP + -0x50],CX
0084ac9f : MOV dword ptr [EBP + -0x40],ECX
0084aca2 : MOV dword ptr [EBP + -0x3c],0x7
0084aca9 : JNZ 0x0084ad09
0084acab : CMP dword ptr [EBP + -0x18],0x8
0084acaf : MOV EAX,dword ptr [EBP + -0x2c]
0084acb2 : JNC 0x0084acb7
0084acb4 : LEA EAX,[EBP + -0x2c]
0084acb7 : MOV EDX,dword ptr [EBP + -0x34]
0084acba : PUSH EAX
0084acbb : MOVZX EAX,byte ptr [EDX + 0x98]
0084acc2 : PUSH EAX
0084acc3 : PUSH 0xc3bf20
0084acc8 : LEA ESI,[EBP + -0x54]
0084accb : CALL 0x00404750
0084acd0 : ADD ESP,0xc
0084acd3 : MOV byte ptr [EBP + -0x4],0x7
0084acd7 : PUSH -0x1
0084acd9 : PUSH 0x0
0084acdb : PUSH EAX
0084acdc : MOV ECX,EDI
0084acde : CALL 0x00405eb0
0084ace3 : MOV byte ptr [EBP + -0x4],0x3
0084ace7 : CMP dword ptr [EBP + -0x3c],0x8
0084aceb : JC 0x0084acf5
0084aced : MOV ECX,dword ptr [EBP + -0x50]
0084acf0 : CALL 0x006f04e0
0084acf5 : XOR ECX,ECX
0084acf7 : MOV dword ptr [EBP + -0x3c],0x7
0084acfe : MOV dword ptr [EBP + -0x40],0x0
0084ad05 : MOV word ptr [EBP + -0x50],CX
0084ad09 : MOV EAX,dword ptr [EBP + -0x34]
0084ad0c : PUSH 0x1
0084ad0e : LEA EDX,[EBP + -0x54]
0084ad11 : PUSH EDX
0084ad12 : MOV EDX,dword ptr [EAX + 0xc]
0084ad15 : MOV ECX,0x1724628
0084ad1a : CALL 0x006f0c10
0084ad1f : MOV byte ptr [EBP + -0x4],0x8
0084ad23 : CMP dword ptr [EAX + 0x18],0x8
0084ad27 : JC 0x0084ad2e
0084ad29 : MOV ESI,dword ptr [EAX + 0x4]
0084ad2c : JMP 0x0084ad31
0084ad2e : LEA ESI,[EAX + 0x4]
0084ad31 : MOV EAX,ESI
0084ad33 : LEA ECX,[EBX + 0x58]
0084ad36 : LEA EDI,[EAX + 0x2]
0084ad39 : LEA ESP,[ESP]
0084ad40 : MOV DX,word ptr [EAX]
0084ad43 : ADD EAX,0x2
0084ad46 : TEST DX,DX
0084ad49 : JNZ 0x0084ad40
0084ad4b : SUB EAX,EDI
0084ad4d : SAR EAX,0x1
0084ad4f : PUSH EAX
0084ad50 : PUSH ESI
0084ad51 : CALL 0x00406360
0084ad56 : MOV byte ptr [EBP + -0x4],0x3
0084ad5a : CMP dword ptr [EBP + -0x3c],0x8
0084ad5e : JC 0x0084ad68
0084ad60 : MOV ECX,dword ptr [EBP + -0x50]
0084ad63 : CALL 0x006f04e0
0084ad68 : XOR ECX,ECX
0084ad6a : PUSH 0x0
0084ad6c : MOV word ptr [EBP + -0x50],CX
0084ad70 : LEA ECX,[EBX + 0x74]
0084ad73 : PUSH 0xc3be5c
0084ad78 : MOV dword ptr [EBP + -0x3c],0x7
0084ad7f : MOV dword ptr [EBP + -0x40],0x0
0084ad86 : CALL 0x00406360
0084ad8b : MOV EDX,dword ptr [EBP + -0x34]
0084ad8e : MOV EAX,dword ptr [EDX + 0xac]
0084ad94 : SUB EAX,0x0
0084ad97 : JZ 0x0084ae0d
0084ad99 : SUB EAX,0x1
0084ad9c : JNZ 0x0084ae84
0084ada2 : MOV EAX,EDX
0084ada4 : MOV DI,word ptr [EAX + 0xb0]
0084adab : PUSH 0x500
0084adb0 : CALL 0x00703c00
0084adb5 : ADD ESP,0x4
0084adb8 : TEST EAX,EAX
0084adba : JZ 0x0084ae84
0084adc0 : MOV ECX,dword ptr [0x0172491c]
0084adc6 : PUSH 0x0
0084adc8 : LEA EDX,[EAX + 0x18]
0084adcb : PUSH ECX
0084adcc : LEA ESI,[EBP + -0x54]
0084adcf : CALL 0x00824a20
0084add4 : MOV byte ptr [EBP + -0x4],0xa
0084add8 : PUSH -0x1
0084adda : PUSH 0x0
0084addc : PUSH EAX
0084addd : LEA ECX,[EBX + 0x74]
0084ade0 : CALL 0x00405eb0
0084ade5 : MOV byte ptr [EBP + -0x4],0x3
0084ade9 : CMP dword ptr [EBP + -0x3c],0x8
0084aded : JC 0x0084adf7
0084adef : MOV ECX,dword ptr [EBP + -0x50]
0084adf2 : CALL 0x006f04e0
0084adf7 : XOR EDX,EDX
0084adf9 : MOV dword ptr [EBP + -0x3c],0x7
0084ae00 : MOV dword ptr [EBP + -0x40],0x0
0084ae07 : MOV word ptr [EBP + -0x50],DX
0084ae0b : JMP 0x0084ae84
0084ae0d : MOV EAX,EDX
0084ae0f : MOV DI,word ptr [EAX + 0xb0]
0084ae16 : PUSH 0x600
0084ae1b : CALL 0x00703c00
0084ae20 : ADD ESP,0x4
0084ae23 : TEST EAX,EAX
0084ae25 : JZ 0x0084ae84
0084ae27 : MOV ECX,dword ptr [0x0172491c]
0084ae2d : PUSH 0x0
0084ae2f : LEA EDX,[EAX + 0x18]
0084ae32 : PUSH ECX
0084ae33 : LEA ESI,[EBP + 0xffffff64]
0084ae39 : CALL 0x00824a20
0084ae3e : MOV byte ptr [EBP + -0x4],0x9
0084ae42 : PUSH -0x1
0084ae44 : PUSH 0x0
0084ae46 : PUSH EAX
0084ae47 : LEA ECX,[EBX + 0x74]
0084ae4a : CALL 0x00405eb0
0084ae4f : MOV byte ptr [EBP + -0x4],0x3
0084ae53 : CMP dword ptr [EBP + 0xffffff7c],0x8
0084ae5a : JC 0x0084ae67
0084ae5c : MOV ECX,dword ptr [EBP + 0xffffff68]
0084ae62 : CALL 0x006f04e0
0084ae67 : XOR EDX,EDX
0084ae69 : MOV dword ptr [EBP + 0xffffff7c],0x7
0084ae73 : MOV dword ptr [EBP + 0xffffff78],0x0
0084ae7d : MOV word ptr [EBP + 0xffffff68],DX
0084ae84 : PUSH 0x0
0084ae86 : LEA ECX,[EBX + 0x90]
0084ae8c : PUSH 0xc3bf1c
0084ae91 : CALL 0x00406360
0084ae96 : MOV ECX,dword ptr [EBP + -0x34]
0084ae99 : MOV EAX,dword ptr [ECX + 0xb4]
0084ae9f : SUB EAX,0x0
0084aea2 : JZ 0x0084b023
0084aea8 : SUB EAX,0x1
0084aeab : JZ 0x0084af97
0084aeb1 : SUB EAX,0x2
0084aeb4 : JNZ 0x0084b08a
0084aeba : MOV EAX,ECX
0084aebc : MOV DI,word ptr [EAX + 0xb8]
0084aec3 : PUSH 0x301
0084aec8 : CALL 0x00703c00
0084aecd : ADD ESP,0x4
0084aed0 : TEST EAX,EAX
0084aed2 : JZ 0x0084b08a
0084aed8 : MOV EDX,dword ptr [EAX + 0x200]
0084aede : LEA EDI,[EAX + 0x200]
0084aee4 : MOV EAX,dword ptr [EDX + 0x4]
0084aee7 : MOV ECX,EDI
0084aee9 : CALL EAX
0084aeeb : MOV dword ptr [EBP + -0x38],EAX
0084aeee : TEST EAX,EAX
0084aef0 : JZ 0x0084b08a
0084aef6 : LEA EDX,[EBP + -0x38]
0084aef9 : MOV EAX,EDI
0084aefb : CALL 0x004f5680
0084af00 : TEST EAX,EAX
0084af02 : JZ 0x0084af88
0084af08 : MOV EDX,dword ptr [EBP + -0x34]
0084af0b : MOVZX SI,byte ptr [EAX + 0x18]
0084af10 : XOR ECX,ECX
0084af12 : ADD EDX,0xc0
0084af18 : CMP SI,word ptr [EDX]
0084af1b : JZ 0x0084af28
0084af1d : INC ECX
0084af1e : ADD EDX,0x2
0084af21 : CMP ECX,0x1
0084af24 : JL 0x0084af18
0084af26 : JMP 0x0084af88
0084af28 : MOV ECX,dword ptr [0x0172491c]
0084af2e : PUSH 0x0
0084af30 : LEA EDX,[EAX + 0x19]
0084af33 : PUSH ECX
0084af34 : LEA ESI,[EBP + 0xffffff64]
0084af3a : CALL 0x00824a20
0084af3f : MOV byte ptr [EBP + -0x4],0xd
0084af43 : PUSH -0x1
0084af45 : PUSH 0x0
0084af47 : PUSH EAX
0084af48 : LEA ECX,[EBX + 0x90]
0084af4e : CALL 0x00405eb0
0084af53 : MOV byte ptr [EBP + -0x4],0x3
0084af57 : CMP dword ptr [EBP + 0xffffff7c],0x8
0084af5e : JC 0x0084af6b
0084af60 : MOV ECX,dword ptr [EBP + 0xffffff68]
0084af66 : CALL 0x006f04e0
0084af6b : XOR EDX,EDX
0084af6d : MOV dword ptr [EBP + 0xffffff7c],0x7
0084af77 : MOV dword ptr [EBP + 0xffffff78],0x0
0084af81 : MOV word ptr [EBP + 0xffffff68],DX
0084af88 : CMP dword ptr [EBP + -0x38],0x0
0084af8c : JNZ 0x0084aef6
0084af92 : JMP 0x0084b08a
0084af97 : MOVZX EAX,word ptr [ECX + 0xb8]
0084af9e : MOV ESI,dword ptr [0x00d7c54c]
0084afa4 : OR EAX,0x66000000
0084afa9 : LEA ECX,[EBP + -0x38]
0084afac : MOV dword ptr [EBP + -0x38],EAX
0084afaf : PUSH ECX
0084afb0 : LEA ECX,[ESI + 0x40]
0084afb3 : LEA EAX,[EBP + -0x7c]
0084afb6 : CALL 0x004437f0
0084afbb : MOV ESI,dword ptr [ESI + 0x44]
0084afbe : MOV EAX,dword ptr [EBP + -0x7c]
0084afc1 : CMP EAX,ESI
0084afc3 : JZ 0x0084b08a
0084afc9 : MOV EAX,dword ptr [EAX + 0x10]
0084afcc : TEST EAX,EAX
0084afce : JZ 0x0084b08a
0084afd4 : LEA EDX,[EAX + 0x18]
0084afd7 : MOV EAX,[0x0172491c]
0084afdc : PUSH 0x0
0084afde : PUSH EAX
0084afdf : LEA ESI,[EBP + -0x54]
0084afe2 : CALL 0x00824a20
0084afe7 : MOV byte ptr [EBP + -0x4],0xc
0084afeb : PUSH -0x1
0084afed : PUSH 0x0
0084afef : PUSH EAX
0084aff0 : LEA ECX,[EBX + 0x90]
0084aff6 : CALL 0x00405eb0
0084affb : MOV byte ptr [EBP + -0x4],0x3
0084afff : CMP dword ptr [EBP + -0x3c],0x8
0084b003 : JC 0x0084b00d
0084b005 : MOV ECX,dword ptr [EBP + -0x50]
0084b008 : CALL 0x006f04e0
0084b00d : XOR ECX,ECX
0084b00f : MOV dword ptr [EBP + -0x3c],0x7
0084b016 : MOV dword ptr [EBP + -0x40],0x0
0084b01d : MOV word ptr [EBP + -0x50],CX
0084b021 : JMP 0x0084b08a
0084b023 : MOV EDX,ECX
0084b025 : MOV DI,word ptr [EDX + 0xb8]
0084b02c : PUSH 0x600
0084b031 : CALL 0x00703c00
0084b036 : ADD ESP,0x4
0084b039 : TEST EAX,EAX
0084b03b : JZ 0x0084b08a
0084b03d : LEA EDX,[EAX + 0x18]
0084b040 : MOV EAX,[0x0172491c]
0084b045 : PUSH 0x0
0084b047 : PUSH EAX
0084b048 : LEA ESI,[EBP + -0x70]
0084b04b : CALL 0x00824a20
0084b050 : MOV byte ptr [EBP + -0x4],0xb
0084b054 : PUSH -0x1
0084b056 : PUSH 0x0
0084b058 : PUSH EAX
0084b059 : LEA ECX,[EBX + 0x90]
0084b05f : CALL 0x00405eb0
0084b064 : MOV byte ptr [EBP + -0x4],0x3
0084b068 : CMP dword ptr [EBP + -0x58],0x8
0084b06c : JC 0x0084b076
0084b06e : MOV ECX,dword ptr [EBP + -0x6c]
0084b071 : CALL 0x006f04e0
0084b076 : XOR ECX,ECX
0084b078 : MOV dword ptr [EBP + -0x58],0x7
0084b07f : MOV dword ptr [EBP + -0x5c],0x0
0084b086 : MOV word ptr [EBP + -0x6c],CX
0084b08a : MOV ESI,dword ptr [EBP + -0x34]
0084b08d : PUSH 0x0
0084b08f : LEA ECX,[EBX + 0xac]
0084b095 : PUSH ESI
0084b096 : CALL 0x00849970
0084b09b : MOV DI,word ptr [ESI + 0xce]
0084b0a2 : PUSH 0x600
0084b0a7 : CALL 0x00703c00
0084b0ac : ADD ESP,0xc
0084b0af : TEST EAX,EAX
0084b0b1 : JZ 0x0084b103
0084b0b3 : LEA EDX,[EAX + 0x18]
0084b0b6 : MOV EAX,[0x0172491c]
0084b0bb : PUSH 0x0
0084b0bd : PUSH EAX
0084b0be : LEA ESI,[EBP + -0x70]
0084b0c1 : CALL 0x00824a20
0084b0c6 : MOV byte ptr [EBP + -0x4],0xe
0084b0ca : PUSH -0x1
0084b0cc : PUSH 0x0
0084b0ce : LEA ECX,[EBX + 0xc8]
0084b0d4 : PUSH EAX
0084b0d5 : CALL 0x00405eb0
0084b0da : MOV byte ptr [EBP + -0x4],0x3
0084b0de : CMP dword ptr [EBP + -0x58],0x8
0084b0e2 : JC 0x0084b0ec
0084b0e4 : MOV ECX,dword ptr [EBP + -0x6c]
0084b0e7 : CALL 0x006f04e0
0084b0ec : MOV ESI,dword ptr [EBP + -0x34]
0084b0ef : XOR ECX,ECX
0084b0f1 : MOV dword ptr [EBP + -0x58],0x7
0084b0f8 : MOV dword ptr [EBP + -0x5c],0x0
0084b0ff : MOV word ptr [EBP + -0x6c],CX
0084b103 : PUSH 0x0
0084b105 : LEA ECX,[EBX + 0xe4]
0084b10b : PUSH 0xc3bfdc
0084b110 : CALL 0x00406360
0084b115 : MOV DI,word ptr [ESI + 0xd0]
0084b11c : PUSH 0x600
0084b121 : CALL 0x00703c00
0084b126 : ADD ESP,0x4
0084b129 : TEST EAX,EAX
0084b12b : JZ 0x0084b17d
0084b12d : LEA EDX,[EAX + 0x18]
0084b130 : MOV EAX,[0x0172491c]
0084b135 : PUSH 0x0
0084b137 : PUSH EAX
0084b138 : LEA ESI,[EBP + -0x70]
0084b13b : CALL 0x00824a20
0084b140 : MOV byte ptr [EBP + -0x4],0xf
0084b144 : PUSH -0x1
0084b146 : PUSH 0x0
0084b148 : PUSH EAX
0084b149 : LEA ECX,[EBX + 0xe4]
0084b14f : CALL 0x00405eb0
0084b154 : MOV byte ptr [EBP + -0x4],0x3
0084b158 : CMP dword ptr [EBP + -0x58],0x8
0084b15c : JC 0x0084b166
0084b15e : MOV ECX,dword ptr [EBP + -0x6c]
0084b161 : CALL 0x006f04e0
0084b166 : MOV ESI,dword ptr [EBP + -0x34]
0084b169 : XOR ECX,ECX
0084b16b : MOV dword ptr [EBP + -0x58],0x7
0084b172 : MOV dword ptr [EBP + -0x5c],0x0
0084b179 : MOV word ptr [EBP + -0x6c],CX
0084b17d : MOV EAX,dword ptr [EBP + -0x74]
0084b180 : XOR EDI,EDI
0084b182 : MOV byte ptr [EBX + 0x1c],0x1
0084b186 : MOV byte ptr [EBX + 0x1d],0x0
0084b18a : MOV dword ptr [EBX + 0x18],EDI
0084b18d : MOV EDX,dword ptr [EAX + 0xc]
0084b190 : MOV dword ptr [EBX + 0x10c],EDX
0084b196 : INC dword ptr [EAX + 0xc]
0084b199 : CMP byte ptr [ESI + 0x10],0x1
0084b19d : SETZ CL
0084b1a0 : MOV byte ptr [EBX + 0x100],CL
0084b1a6 : CMP dword ptr [ESI + 0xd8],EDI
0084b1ac : MOV ECX,0x2
0084b1b1 : SETA DL
0084b1b4 : MOV byte ptr [EBX + 0x102],DL
0084b1ba : CMP dword ptr [ESI + 0xac],ECX
0084b1c0 : JZ 0x0084b1ce
0084b1c2 : CMP dword ptr [ESI + 0xb4],ECX
0084b1c8 : JZ 0x0084b1ce
0084b1ca : XOR CL,CL
0084b1cc : JMP 0x0084b1d0
0084b1ce : MOV CL,0x1
0084b1d0 : MOV byte ptr [EBX + 0x101],CL
0084b1d6 : MOV ECX,dword ptr [EBP + 0xc]
0084b1d9 : LEA EDX,[EBP + -0x78]
0084b1dc : MOV dword ptr [EBP + -0x78],ECX
0084b1df : PUSH EDX
0084b1e0 : LEA ECX,[EBP + -0x80]
0084b1e3 : PUSH ECX
0084b1e4 : MOV byte ptr [EBX + 0x108],0x1
0084b1eb : MOV dword ptr [EBP + -0x74],EBX
0084b1ee : CALL 0x00451e00
0084b1f3 : MOV dword ptr [EBP + -0x4],0xffffffff
0084b1fa : CMP dword ptr [EBP + -0x18],0x8
0084b1fe : JC 0x0084b208
0084b200 : MOV ECX,dword ptr [EBP + -0x2c]
0084b203 : CALL 0x006f04e0
0084b208 : XOR EDX,EDX
0084b20a : MOV dword ptr [EBP + -0x18],0x7
0084b211 : MOV dword ptr [EBP + -0x1c],EDI
0084b214 : MOV word ptr [EBP + -0x2c],DX
0084b218 : MOV ECX,dword ptr [EBP + -0xc]
0084b21b : MOV dword ptr FS:[0x0],ECX
0084b222 : POP ECX
0084b223 : POP EDI
0084b224 : POP ESI
0084b225 : POP EBX
0084b226 : MOV ECX,dword ptr [EBP + -0x14]
0084b229 : XOR ECX,EBP
0084b22b : CALL 0x00633e6b
0084b230 : MOV ESP,EBP
0084b232 : POP EBP
0084b233 : RET 0x14

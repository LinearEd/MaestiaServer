PROGRAM  : Maestia.exe
FUNCTION : FUN_00803bf0
ENTRY    : 00803bf0
BODY     : [[00803bf0, 00803c80]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_00803bf0(undefined4 *param_1)

{
  BOOL BVar1;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_00b297a7;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if (param_1 + 1 == (undefined4 *)0x0) {
    DAT_017251a0 = (undefined4 *)0x0;
  }
  else {
    DAT_017251a0 = param_1;
  }
  local_8 = 0;
  *param_1 = &PTR_FUN_00cd4394;
  FUN_004580b0(param_1 + 1);
  local_8 = CONCAT31(local_8._1_3_,1);
  param_1[4] = &PTR_FUN_00cdec94;
  BVar1 = InitializeCriticalSectionAndSpinCount((LPCRITICAL_SECTION)(param_1 + 5),4000);
  if (BVar1 == 0) {
    InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 5));
  }
  ExceptionList = local_10;
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
00803bf0 : PUSH EBP
00803bf1 : MOV EBP,ESP
00803bf3 : PUSH -0x1
00803bf5 : PUSH 0xb297a7
00803bfa : MOV EAX,FS:[0x0]
00803c00 : PUSH EAX
00803c01 : PUSH ESI
00803c02 : PUSH EDI
00803c03 : MOV EAX,[0x00d66fa0]
00803c08 : XOR EAX,EBP
00803c0a : PUSH EAX
00803c0b : LEA EAX,[EBP + -0xc]
00803c0e : MOV FS:[0x0],EAX
00803c14 : MOV ESI,dword ptr [EBP + 0x8]
00803c17 : LEA EAX,[ESI + 0x4]
00803c1a : XOR ECX,ECX
00803c1c : CMP EAX,ECX
00803c1e : JZ 0x00803c2b
00803c20 : LEA EDX,[EAX + -0x4]
00803c23 : MOV dword ptr [0x017251a0],EDX
00803c29 : JMP 0x00803c31
00803c2b : MOV dword ptr [0x017251a0],ECX
00803c31 : MOV dword ptr [EBP + -0x4],ECX
00803c34 : PUSH EAX
00803c35 : MOV dword ptr [ESI],0xcd4394
00803c3b : CALL 0x004580b0
00803c40 : MOV byte ptr [EBP + -0x4],0x1
00803c44 : PUSH 0xfa0
00803c49 : LEA EDI,[ESI + 0x14]
00803c4c : PUSH EDI
00803c4d : MOV dword ptr [ESI + 0x10],0xcdec94
00803c54 : CALL dword ptr [0x00b85110]
00803c5a : TEST EAX,EAX
00803c5c : JNZ 0x00803c65
00803c5e : PUSH EDI
00803c5f : CALL dword ptr [0x00b85114]
00803c65 : MOV dword ptr [EBP + -0x4],0xffffffff
00803c6c : MOV EAX,ESI
00803c6e : MOV ECX,dword ptr [EBP + -0xc]
00803c71 : MOV dword ptr FS:[0x0],ECX
00803c78 : POP ECX
00803c79 : POP EDI
00803c7a : POP ESI
00803c7b : MOV ESP,EBP
00803c7d : POP EBP
00803c7e : RET 0x4

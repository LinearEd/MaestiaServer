PROGRAM  : Maestia.exe
FUNCTION : FUN_00865f30
ENTRY    : 00865f30
BODY     : [[00865f30, 008661ac]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00865f30(int param_1,char param_2,char param_3)

{
  char cVar1;
  int *piVar2;
  int iVar3;
  undefined1 auStack_3c [4];
  undefined1 local_38;
  undefined1 local_37;
  undefined4 local_34;
  undefined4 local_30;
  undefined2 local_2c;
  undefined1 local_2a;
  undefined4 local_28;
  undefined1 local_24;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_00b5f253;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_3c;
  ExceptionList = &local_14;
  if ((*(char *)(param_1 + 0x65d) == '\0') && (param_3 == '\0')) {
    local_34 = 0;
    local_30 = 0;
    local_2c = 0;
    local_24 = 0;
    local_38 = 0;
    local_2a = 1;
    local_28 = 1;
    local_37 = 0x28;
    FUN_0041dea0(&local_38);
  }
  else if (*(char *)(*(int *)(param_1 + 0x18a8) + 0x20) != '\0') {
    (**(code **)(*(int *)(*(int *)(*(int *)(param_1 + 0x138) + 4) + 0x138 + param_1) + 0x10))
              (param_1 + 0x1d38,1,1,1,DAT_00d66fa0 ^ (uint)&stack0xffffffb8);
    if (param_2 != '\0') {
      piVar2 = (int *)FUN_004049b0(*(undefined4 *)(*(int *)(param_1 + 0x18a8) + 0x28));
      if (piVar2 != (int *)0x0) {
        iVar3 = (**(code **)(*piVar2 + 0x38))();
        if (iVar3 != 0) {
          FUN_00404350(piVar2 + 0x31);
          local_1c = 0;
          cVar1 = FUN_004049e0();
          if (cVar1 != '\0') {
            FUN_008980b0(&stack0xffffffb8,1);
          }
          FUN_0088e570(0x12);
          local_1c = 0xffffffff;
          FUN_00406560();
        }
      }
    }
    FUN_0085bfe0(param_1,1);
    FUN_0085c1c0();
    FUN_0083bb00(0);
    FUN_0083ba10();
    (**(code **)(*(int *)(*(int *)(*(int *)(param_1 + 0x138) + 4) + 0x138 + param_1) + 0x10))
              (param_1 + 0x6d8,1,0,1);
    *(undefined4 *)(param_1 + 0x19ec) = 0;
    *(undefined4 *)(param_1 + 0x1a68) = 0;
    FUN_00856310(&DAT_00d720f0);
    if (*(char *)(param_1 + 0x4d4) != '\0') {
      FUN_0084c320(1);
      iVar3 = *(int *)(param_1 + 0x17f0);
      *(undefined1 *)(iVar3 + 0x1a8) = 0;
      if (*(int **)(iVar3 + 0x168) != (int *)0x0) {
        (**(code **)(**(int **)(iVar3 + 0x168) + 0x10))(0);
      }
      if (*(int **)(iVar3 + 0x16c) != (int *)0x0) {
        (**(code **)(**(int **)(iVar3 + 0x16c) + 0x10))(0);
      }
      FUN_0084c320(1);
      iVar3 = *(int *)(param_1 + 0x1870);
      *(undefined1 *)(iVar3 + 0x1a8) = 0;
      if (*(int **)(iVar3 + 0x168) != (int *)0x0) {
        (**(code **)(**(int **)(iVar3 + 0x168) + 0x10))(0);
      }
      if (*(int **)(iVar3 + 0x16c) != (int *)0x0) {
        (**(code **)(**(int **)(iVar3 + 0x16c) + 0x10))(0);
      }
      FUN_0084c320(1);
      *(undefined1 *)(param_1 + 0x198c) = 1;
      *(undefined1 *)(param_1 + 0x4d4) = 0;
    }
  }
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_3c);
  return;
}



============================================================
DISASSEMBLY
============================================================
00865f30 : PUSH EBP
00865f31 : MOV EBP,ESP
00865f33 : AND ESP,0xfffffff8
00865f36 : PUSH -0x1
00865f38 : PUSH 0xb5f253
00865f3d : MOV EAX,FS:[0x0]
00865f43 : PUSH EAX
00865f44 : SUB ESP,0x28
00865f47 : MOV EAX,[0x00d66fa0]
00865f4c : XOR EAX,ESP
00865f4e : MOV dword ptr [ESP + 0x20],EAX
00865f52 : PUSH EBX
00865f53 : PUSH ESI
00865f54 : PUSH EDI
00865f55 : MOV EAX,[0x00d66fa0]
00865f5a : XOR EAX,ESP
00865f5c : PUSH EAX
00865f5d : LEA EAX,[ESP + 0x38]
00865f61 : MOV FS:[0x0],EAX
00865f67 : MOV EBX,dword ptr [EBP + 0x8]
00865f6a : CMP byte ptr [EBX + 0x65d],0x0
00865f71 : JNZ 0x00865fb7
00865f73 : CMP byte ptr [EBP + 0x10],0x0
00865f77 : JNZ 0x00865fb7
00865f79 : XOR EAX,EAX
00865f7b : LEA ECX,[ESP + 0x14]
00865f7f : MOV dword ptr [ESP + 0x18],EAX
00865f83 : MOV dword ptr [ESP + 0x1c],EAX
00865f87 : MOV word ptr [ESP + 0x20],AX
00865f8c : MOV byte ptr [ESP + 0x28],AL
00865f90 : MOV byte ptr [ESP + 0x14],AL
00865f94 : PUSH ECX
00865f95 : LEA EAX,[EBX + 0x19a4]
00865f9b : MOV byte ptr [ESP + 0x26],0x1
00865fa0 : MOV dword ptr [ESP + 0x28],0x1
00865fa8 : MOV byte ptr [ESP + 0x19],0x28
00865fad : CALL 0x0041dea0
00865fb2 : JMP 0x0086618d
00865fb7 : MOV EDX,dword ptr [EBX + 0x18a8]
00865fbd : CMP byte ptr [EDX + 0x20],0x0
00865fc1 : JZ 0x0086618d
00865fc7 : MOV EAX,dword ptr [EBX + 0x138]
00865fcd : MOV ECX,dword ptr [EAX + 0x4]
00865fd0 : MOV EDX,dword ptr [ECX + EBX*0x1 + 0x138]
00865fd7 : MOV EDX,dword ptr [EDX + 0x10]
00865fda : PUSH 0x1
00865fdc : PUSH 0x1
00865fde : LEA ECX,[ECX + EBX*0x1 + 0x138]
00865fe5 : PUSH 0x1
00865fe7 : LEA EAX,[EBX + 0x1d38]
00865fed : PUSH EAX
00865fee : CALL EDX
00865ff0 : CMP byte ptr [EBP + 0xc],0x0
00865ff4 : JZ 0x00866070
00865ff6 : MOV EAX,dword ptr [EBX + 0x18a8]
00865ffc : MOV EAX,dword ptr [EAX + 0x28]
00865fff : PUSH EAX
00866000 : CALL 0x004049b0
00866005 : MOV ESI,EAX
00866007 : ADD ESP,0x4
0086600a : TEST ESI,ESI
0086600c : JZ 0x00866070
0086600e : MOV EDX,dword ptr [ESI]
00866010 : MOV EAX,dword ptr [EDX + 0x38]
00866013 : MOV ECX,ESI
00866015 : CALL EAX
00866017 : TEST EAX,EAX
00866019 : JZ 0x00866070
0086601b : ADD ESI,0xc4
00866021 : PUSH ESI
00866022 : LEA ESI,[ESP + 0x18]
00866026 : CALL 0x00404350
0086602b : ADD ESP,0x4
0086602e : MOV dword ptr [ESP + 0x40],0x0
00866036 : MOV ESI,0xc3f4c8
0086603b : LEA ECX,[ESP + 0x14]
0086603f : CALL 0x004049e0
00866044 : TEST AL,AL
00866046 : JZ 0x00866056
00866048 : PUSH 0x1
0086604a : LEA ECX,[ESP + 0x18]
0086604e : PUSH ECX
0086604f : MOV ESI,EBX
00866051 : CALL 0x008980b0
00866056 : PUSH 0x12
00866058 : MOV ECX,EBX
0086605a : CALL 0x0088e570
0086605f : MOV dword ptr [ESP + 0x40],0xffffffff
00866067 : LEA ECX,[ESP + 0x14]
0086606b : CALL 0x00406560
00866070 : PUSH 0x1
00866072 : PUSH EBX
00866073 : CALL 0x0085bfe0
00866078 : MOV ECX,EBX
0086607a : CALL 0x0085c1c0
0086607f : MOV ECX,dword ptr [EBX + 0x18a8]
00866085 : PUSH 0x0
00866087 : XOR AL,AL
00866089 : CALL 0x0083bb00
0086608e : MOV ESI,dword ptr [EBX + 0x18a8]
00866094 : CALL 0x0083ba10
00866099 : MOV EDX,dword ptr [EBX + 0x138]
0086609f : MOV EAX,dword ptr [EDX + 0x4]
008660a2 : MOV EDX,dword ptr [EAX + EBX*0x1 + 0x138]
008660a9 : MOV EDX,dword ptr [EDX + 0x10]
008660ac : PUSH 0x1
008660ae : LEA ECX,[EAX + EBX*0x1 + 0x138]
008660b5 : PUSH 0x0
008660b7 : PUSH 0x1
008660b9 : LEA EAX,[EBX + 0x6d8]
008660bf : PUSH EAX
008660c0 : CALL EDX
008660c2 : XORPS XMM0,XMM0
008660c5 : PUSH 0xd720f0
008660ca : MOV ESI,EBX
008660cc : MOV dword ptr [EBX + 0x19ec],0x0
008660d6 : MOVSS dword ptr [EBX + 0x1a68],XMM0
008660de : CALL 0x00856310
008660e3 : CMP byte ptr [EBX + 0x4d4],0x0
008660ea : JZ 0x0086618d
008660f0 : MOV EDI,dword ptr [EBX + 0x17f0]
008660f6 : PUSH 0x1
008660f8 : CALL 0x0084c320
008660fd : MOV ESI,dword ptr [EBX + 0x17f0]
00866103 : MOV ECX,dword ptr [ESI + 0x168]
00866109 : MOV byte ptr [ESI + 0x1a8],0x0
00866110 : TEST ECX,ECX
00866112 : JZ 0x0086611d
00866114 : MOV EAX,dword ptr [ECX]
00866116 : MOV EDX,dword ptr [EAX + 0x10]
00866119 : PUSH 0x0
0086611b : CALL EDX
0086611d : MOV ECX,dword ptr [ESI + 0x16c]
00866123 : TEST ECX,ECX
00866125 : JZ 0x00866130
00866127 : MOV EAX,dword ptr [ECX]
00866129 : MOV EDX,dword ptr [EAX + 0x10]
0086612c : PUSH 0x0
0086612e : CALL EDX
00866130 : MOV EDI,dword ptr [EBX + 0x1870]
00866136 : PUSH 0x1
00866138 : CALL 0x0084c320
0086613d : MOV ESI,dword ptr [EBX + 0x1870]
00866143 : MOV ECX,dword ptr [ESI + 0x168]
00866149 : MOV byte ptr [ESI + 0x1a8],0x0
00866150 : TEST ECX,ECX
00866152 : JZ 0x0086615d
00866154 : MOV EAX,dword ptr [ECX]
00866156 : MOV EDX,dword ptr [EAX + 0x10]
00866159 : PUSH 0x0
0086615b : CALL EDX
0086615d : MOV ESI,dword ptr [ESI + 0x16c]
00866163 : TEST ESI,ESI
00866165 : JZ 0x00866172
00866167 : MOV EAX,dword ptr [ESI]
00866169 : MOV EDX,dword ptr [EAX + 0x10]
0086616c : PUSH 0x0
0086616e : MOV ECX,ESI
00866170 : CALL EDX
00866172 : MOV EDI,dword ptr [EBX + 0x17f4]
00866178 : PUSH 0x1
0086617a : CALL 0x0084c320
0086617f : MOV byte ptr [EBX + 0x198c],0x1
00866186 : MOV byte ptr [EBX + 0x4d4],0x0
0086618d : MOV ECX,dword ptr [ESP + 0x38]
00866191 : MOV dword ptr FS:[0x0],ECX
00866198 : POP ECX
00866199 : POP EDI
0086619a : POP ESI
0086619b : POP EBX
0086619c : MOV ECX,dword ptr [ESP + 0x20]
008661a0 : XOR ECX,ESP
008661a2 : CALL 0x00633e6b
008661a7 : MOV ESP,EBP
008661a9 : POP EBP
008661aa : RET 0xc

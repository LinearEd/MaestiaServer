PROGRAM  : Maestia.exe
FUNCTION : FUN_006d4cd0
ENTRY    : 006d4cd0
BODY     : [[006d4cd0, 006d4e90]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006d4cd0(void)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int *unaff_ESI;
  
  iVar1 = unaff_ESI[9];
  if (iVar1 == 1) {
    unaff_ESI[10] = 1;
    unaff_ESI[0xb] = 1;
    goto LAB_006d4e50;
  }
  if (iVar1 != 3) {
    if (iVar1 == 4) {
      if (((char)unaff_ESI[0x42] == '\0') || (*(char *)((int)unaff_ESI + 0x109) == '\0')) {
        unaff_ESI[10] = 4;
        unaff_ESI[0xb] = 4;
      }
      else {
        if (*(char *)((int)unaff_ESI + 0x109) != '\x02') {
          *(undefined4 *)(*unaff_ESI + 0x14) = 0x72;
          *(uint *)(*unaff_ESI + 0x18) = (uint)*(byte *)((int)unaff_ESI + 0x109);
          (**(code **)(*unaff_ESI + 4))();
        }
        unaff_ESI[10] = 5;
        unaff_ESI[0xb] = 4;
      }
    }
    else {
      unaff_ESI[10] = 0;
      unaff_ESI[0xb] = 0;
    }
    goto LAB_006d4e50;
  }
  if ((char)unaff_ESI[0x40] == '\0') {
    if ((char)unaff_ESI[0x42] == '\0') {
      piVar2 = (int *)unaff_ESI[0x31];
      iVar1 = *piVar2;
      iVar3 = piVar2[0x15];
      iVar4 = piVar2[0x2a];
      if (iVar1 == 1) {
        if ((iVar3 == 2) && (iVar4 == 3)) {
          unaff_ESI[10] = 3;
          unaff_ESI[0xb] = 2;
          goto LAB_006d4e50;
        }
      }
      else if (((iVar1 == 0x52) && (iVar3 == 0x47)) && (iVar4 == 0x42)) goto LAB_006d4e01;
      iVar5 = *unaff_ESI;
      *(int *)(iVar5 + 0x18) = iVar1;
      *(int *)(iVar5 + 0x1c) = iVar3;
      *(int *)(iVar5 + 0x20) = iVar4;
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x6f;
      (**(code **)(*unaff_ESI + 4))();
      unaff_ESI[10] = 3;
      unaff_ESI[0xb] = 2;
      goto LAB_006d4e50;
    }
    if (*(char *)((int)unaff_ESI + 0x109) == '\0') {
LAB_006d4e01:
      unaff_ESI[10] = 2;
      unaff_ESI[0xb] = 2;
      goto LAB_006d4e50;
    }
    if (*(char *)((int)unaff_ESI + 0x109) != '\x01') {
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x72;
      *(uint *)(*unaff_ESI + 0x18) = (uint)*(byte *)((int)unaff_ESI + 0x109);
      (**(code **)(*unaff_ESI + 4))();
      unaff_ESI[10] = 3;
      unaff_ESI[0xb] = 2;
      goto LAB_006d4e50;
    }
  }
  unaff_ESI[10] = 3;
  unaff_ESI[0xb] = 2;
LAB_006d4e50:
  unaff_ESI[0xc] = 1;
  unaff_ESI[0xe] = 0;
  unaff_ESI[0xf] = 0x3ff00000;
  unaff_ESI[0xd] = 1;
  *(undefined1 *)(unaff_ESI + 0x10) = 0;
  *(undefined1 *)((int)unaff_ESI + 0x41) = 0;
  unaff_ESI[0x11] = 0;
  *(undefined1 *)((int)unaff_ESI + 0x4a) = 0;
  unaff_ESI[0x1d] = 0;
  *(undefined1 *)(unaff_ESI + 0x16) = 0;
  *(undefined1 *)((int)unaff_ESI + 0x59) = 0;
  *(undefined1 *)((int)unaff_ESI + 0x5a) = 0;
  *(undefined1 *)(unaff_ESI + 0x12) = 1;
  *(undefined1 *)((int)unaff_ESI + 0x49) = 1;
  unaff_ESI[0x13] = 2;
  *(undefined1 *)(unaff_ESI + 0x14) = 1;
  unaff_ESI[0x15] = 0x100;
  return;
}



============================================================
DISASSEMBLY
============================================================
006d4cd0 : MOV EAX,dword ptr [ESI + 0x24]
006d4cd3 : PUSH EBX
006d4cd4 : PUSH EBP
006d4cd5 : MOV EBP,0x1
006d4cda : SUB EAX,EBP
006d4cdc : PUSH EDI
006d4cdd : LEA EBX,[EBP + -0x1]
006d4ce0 : JZ 0x006d4e4a
006d4ce6 : SUB EAX,0x2
006d4ce9 : JZ 0x006d4d53
006d4ceb : SUB EAX,EBP
006d4ced : JZ 0x006d4cfa
006d4cef : MOV dword ptr [ESI + 0x28],EBX
006d4cf2 : MOV dword ptr [ESI + 0x2c],EBX
006d4cf5 : JMP 0x006d4e50
006d4cfa : MOV EDI,0x4
006d4cff : CMP byte ptr [ESI + 0x108],BL
006d4d05 : JZ 0x006d4d48
006d4d07 : MOVZX EAX,byte ptr [ESI + 0x109]
006d4d0e : SUB EAX,EBX
006d4d10 : JZ 0x006d4d48
006d4d12 : SUB EAX,0x2
006d4d15 : JZ 0x006d4d39
006d4d17 : MOV EAX,dword ptr [ESI]
006d4d19 : MOV dword ptr [EAX + 0x14],0x72
006d4d20 : MOVZX ECX,byte ptr [ESI + 0x109]
006d4d27 : MOV EDX,dword ptr [ESI]
006d4d29 : MOV dword ptr [EDX + 0x18],ECX
006d4d2c : MOV EAX,dword ptr [ESI]
006d4d2e : MOV ECX,dword ptr [EAX + 0x4]
006d4d31 : PUSH -0x1
006d4d33 : PUSH ESI
006d4d34 : CALL ECX
006d4d36 : ADD ESP,0x8
006d4d39 : MOV dword ptr [ESI + 0x28],0x5
006d4d40 : MOV dword ptr [ESI + 0x2c],EDI
006d4d43 : JMP 0x006d4e50
006d4d48 : MOV dword ptr [ESI + 0x28],EDI
006d4d4b : MOV dword ptr [ESI + 0x2c],EDI
006d4d4e : JMP 0x006d4e50
006d4d53 : CMP byte ptr [ESI + 0x100],BL
006d4d59 : JZ 0x006d4d73
006d4d5b : MOV dword ptr [ESI + 0x28],0x3
006d4d62 : MOV dword ptr [ESI + 0x2c],0x2
006d4d69 : MOV EBP,0x1
006d4d6e : JMP 0x006d4e50
006d4d73 : CMP byte ptr [ESI + 0x108],BL
006d4d79 : JZ 0x006d4dc4
006d4d7b : MOVZX EAX,byte ptr [ESI + 0x109]
006d4d82 : SUB EAX,EBX
006d4d84 : JZ 0x006d4e01
006d4d86 : SUB EAX,EBP
006d4d88 : JZ 0x006d4d5b
006d4d8a : MOV EDX,dword ptr [ESI]
006d4d8c : MOV dword ptr [EDX + 0x14],0x72
006d4d93 : MOVZX EAX,byte ptr [ESI + 0x109]
006d4d9a : MOV ECX,dword ptr [ESI]
006d4d9c : MOV dword ptr [ECX + 0x18],EAX
006d4d9f : MOV EDX,dword ptr [ESI]
006d4da1 : MOV EAX,dword ptr [EDX + 0x4]
006d4da4 : PUSH -0x1
006d4da6 : PUSH ESI
006d4da7 : CALL EAX
006d4da9 : MOV dword ptr [ESI + 0x28],0x3
006d4db0 : ADD ESP,0x8
006d4db3 : MOV dword ptr [ESI + 0x2c],0x2
006d4dba : MOV EBP,0x1
006d4dbf : JMP 0x006d4e50
006d4dc4 : MOV EAX,dword ptr [ESI + 0xc4]
006d4dca : MOV ECX,dword ptr [EAX]
006d4dcc : MOV EDX,dword ptr [EAX + 0x54]
006d4dcf : MOV EDI,dword ptr [EAX + 0xa8]
006d4dd5 : MOV EBP,0x3
006d4dda : CMP ECX,0x1
006d4ddd : JNZ 0x006d4df2
006d4ddf : CMP EDX,0x2
006d4de2 : JNZ 0x006d4e16
006d4de4 : CMP EDI,EBP
006d4de6 : JNZ 0x006d4e16
006d4de8 : MOV dword ptr [ESI + 0x28],EBP
006d4deb : MOV dword ptr [ESI + 0x2c],EDX
006d4dee : MOV EBP,ECX
006d4df0 : JMP 0x006d4e50
006d4df2 : CMP ECX,0x52
006d4df5 : JNZ 0x006d4e16
006d4df7 : CMP EDX,0x47
006d4dfa : JNZ 0x006d4e16
006d4dfc : CMP EDI,0x42
006d4dff : JNZ 0x006d4e16
006d4e01 : MOV dword ptr [ESI + 0x28],0x2
006d4e08 : MOV dword ptr [ESI + 0x2c],0x2
006d4e0f : MOV EBP,0x1
006d4e14 : JMP 0x006d4e50
006d4e16 : MOV EAX,dword ptr [ESI]
006d4e18 : ADD EAX,0x18
006d4e1b : MOV dword ptr [EAX],ECX
006d4e1d : MOV dword ptr [EAX + 0x4],EDX
006d4e20 : MOV dword ptr [EAX + 0x8],EDI
006d4e23 : MOV ECX,dword ptr [ESI]
006d4e25 : MOV dword ptr [ECX + 0x14],0x6f
006d4e2c : MOV EDX,dword ptr [ESI]
006d4e2e : MOV EAX,dword ptr [EDX + 0x4]
006d4e31 : PUSH 0x1
006d4e33 : PUSH ESI
006d4e34 : CALL EAX
006d4e36 : MOV dword ptr [ESI + 0x28],EBP
006d4e39 : ADD ESP,0x8
006d4e3c : MOV dword ptr [ESI + 0x2c],0x2
006d4e43 : MOV EBP,0x1
006d4e48 : JMP 0x006d4e50
006d4e4a : MOV dword ptr [ESI + 0x28],EBP
006d4e4d : MOV dword ptr [ESI + 0x2c],EBP
006d4e50 : FLD1
006d4e52 : POP EDI
006d4e53 : MOV dword ptr [ESI + 0x30],EBP
006d4e56 : FSTP double ptr [ESI + 0x38]
006d4e59 : MOV dword ptr [ESI + 0x34],EBP
006d4e5c : POP EBP
006d4e5d : MOV byte ptr [ESI + 0x40],BL
006d4e60 : MOV byte ptr [ESI + 0x41],BL
006d4e63 : MOV dword ptr [ESI + 0x44],EBX
006d4e66 : MOV byte ptr [ESI + 0x4a],BL
006d4e69 : MOV dword ptr [ESI + 0x74],EBX
006d4e6c : MOV byte ptr [ESI + 0x58],BL
006d4e6f : MOV byte ptr [ESI + 0x59],BL
006d4e72 : MOV byte ptr [ESI + 0x5a],BL
006d4e75 : MOV byte ptr [ESI + 0x48],0x1
006d4e79 : MOV byte ptr [ESI + 0x49],0x1
006d4e7d : MOV dword ptr [ESI + 0x4c],0x2
006d4e84 : MOV byte ptr [ESI + 0x50],0x1
006d4e88 : MOV dword ptr [ESI + 0x54],0x100
006d4e8f : POP EBX
006d4e90 : RET

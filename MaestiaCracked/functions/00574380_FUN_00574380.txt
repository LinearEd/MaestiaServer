PROGRAM  : Maestia.exe
FUNCTION : FUN_00574380
ENTRY    : 00574380
BODY     : [[00574380, 0057463d] [00574640, 00574756]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00574380(int *param_1)

{
  byte *pbVar1;
  byte bVar2;
  byte bVar3;
  int iVar4;
  int iVar5;
  undefined4 *puVar6;
  byte bVar7;
  int in_ECX;
  undefined4 *puVar8;
  int *piVar9;
  undefined1 *puVar10;
  uint uVar11;
  uint uVar12;
  byte *local_40;
  undefined4 local_3c;
  int local_38;
  int local_34;
  undefined1 local_30 [48];
  
  local_40 = (byte *)(in_ECX + 4);
  local_3c = 0xffffffff;
  bVar2 = *local_40;
  iVar4 = 1;
  if ((bVar2 & 0x80) != 0) {
    iVar4 = 5;
  }
  bVar3 = local_40[iVar4];
  local_38 = iVar4 + 3;
  param_1[0x10] = (uint)CONCAT11(*(undefined1 *)(in_ECX + 5 + iVar4 + 1),local_40[iVar4 + 1]);
  if ((bVar2 & 2) != 0) {
    *(byte *)((int)param_1 + 0x4b) = *(byte *)((int)param_1 + 0x4b) | 2;
    puVar10 = (undefined1 *)(in_ECX + 5 + local_38);
    pbVar1 = local_40 + local_38;
    local_38 = iVar4 + 5;
    param_1[0x11] = (uint)CONCAT11(*puVar10,*pbVar1);
  }
  local_34 = 0;
  if ((bVar2 & 4) != 0) {
    *(byte *)((int)param_1 + 0x4b) = *(byte *)((int)param_1 + 0x4b) | 4;
    FUN_0053a210(param_1 + 9);
  }
  if ((bVar2 & 8) != 0) {
    *(byte *)((int)param_1 + 0x4b) = *(byte *)((int)param_1 + 0x4b) | 8;
    FUN_0053a570(param_1 + 1);
  }
  if ((bVar2 & 0x10) != 0) {
    *(byte *)((int)param_1 + 0x4b) = *(byte *)((int)param_1 + 0x4b) | 0x10;
    if (local_34 != 0) {
      local_38 = local_38 + 1;
    }
    local_34 = 0;
    iVar4 = local_38 + 1;
    pbVar1 = local_40 + local_38;
    local_38 = local_38 + 2;
    param_1[0xf] = (int)((float)CONCAT11(local_40[iVar4],*pbVar1) / 65535.0);
  }
  if ((bVar2 & 0x20) == 0) {
    param_1[0x14] = 0;
  }
  else {
    if (local_34 != 0) {
      local_38 = local_38 + 1;
    }
    param_1[0x14] = local_38 + 4 + in_ECX;
    do {
      local_34 = 0;
      pbVar1 = local_40 + local_38;
      local_38 = local_38 + 1;
    } while (*pbVar1 != 0);
  }
  if ((bVar2 & 0x40) != 0) {
    if (local_34 != 0) {
      local_38 = local_38 + 1;
    }
    local_34 = 0;
    iVar4 = local_38 + 1;
    pbVar1 = local_40 + local_38;
    local_38 = local_38 + 2;
    *(ushort *)(param_1 + 0x12) = CONCAT11(local_40[iVar4],*pbVar1);
    *(byte *)((int)param_1 + 0x4b) = *(byte *)((int)param_1 + 0x4b) | 0x40;
  }
  if ((bVar3 & 1) != 0) {
    *(byte *)((int)param_1 + 0x4b) = *(byte *)((int)param_1 + 0x4b) | 0x20;
    iVar4 = FUN_0059d9a0(&local_40,local_30,4);
    if (iVar4 != 0) {
      if (*param_1 == 0) {
        FUN_00515dd0(in_ECX);
        iVar5 = FUN_00515840(0x1c,0);
        if (iVar5 == 0) {
          iVar5 = 0;
        }
        else {
          iVar5 = FUN_0050b5a0();
        }
        if ((GRefCountNTSImpl *)*param_1 != (GRefCountNTSImpl *)0x0) {
          GRefCountNTSImpl::Release((GRefCountNTSImpl *)*param_1);
        }
        *param_1 = iVar5;
      }
      if (iVar4 != 0) {
        puVar10 = local_30;
        do {
          FUN_0059d2e0(puVar10);
          puVar10 = puVar10 + 0xc;
          iVar4 = iVar4 + -1;
        } while (iVar4 != 0);
      }
    }
  }
  if ((bVar3 & 2) != 0) {
    *(byte *)((int)param_1 + 0x4b) = *(byte *)((int)param_1 + 0x4b) | 0x80;
    if (local_34 != 0) {
      local_38 = local_38 + 1;
    }
    local_34 = 0;
    bVar7 = local_40[local_38];
    local_38 = local_38 + 1;
    if ((bVar7 == 0) || (0xe < bVar7)) {
      bVar7 = 1;
    }
    *(byte *)((int)param_1 + 0x4a) = bVar7;
  }
  if ((bVar3 & 4) != 0) {
    if (local_34 != 0) {
      local_38 = local_38 + 1;
    }
    local_34 = 0;
    local_38 = local_38 + 1;
  }
  piVar9 = (int *)0x0;
  if (((bVar2 & 0x80) != 0) && (piVar9 = *(int **)(in_ECX + 5), piVar9 == (int *)0x0)) {
    if (local_34 != 0) {
      local_38 = local_38 + 1;
    }
    local_38 = local_38 + 6;
    local_34 = 0;
    FUN_00515dd0(in_ECX);
    piVar9 = (int *)FUN_00515840(0xc,0);
    if (piVar9 == (int *)0x0) {
      piVar9 = (int *)0x0;
    }
    else {
      *piVar9 = 0;
      piVar9[1] = 0;
      piVar9[2] = 0;
    }
    while( true ) {
      if (local_34 != 0) {
        local_38 = local_38 + 1;
      }
      local_34 = 0;
      iVar4 = CONCAT31(CONCAT21(CONCAT11(local_40[local_38 + 3],local_40[local_38 + 2]),
                                local_40[local_38 + 1]),local_40[local_38]);
      local_38 = local_38 + 4;
      if (iVar4 == 0) break;
      FUN_00515dd0(in_ECX);
      puVar6 = (undefined4 *)FUN_00515840(0x14,0);
      puVar8 = (undefined4 *)0x0;
      if (puVar6 != (undefined4 *)0x0) {
        *puVar6 = 0;
        puVar6[1] = 0;
        *(undefined2 *)(puVar6 + 2) = 0;
        *(undefined1 *)((int)puVar6 + 10) = 0;
        *(undefined1 *)((int)puVar6 + 0xb) = 0xff;
        *(undefined1 *)(puVar6 + 3) = 0;
        *(undefined1 *)((int)puVar6 + 0xd) = 0;
        puVar6[4] = 0;
        puVar8 = puVar6;
      }
      FUN_0056bd40(&local_40,iVar4);
      uVar11 = piVar9[1] + 1;
      if (uVar11 < (uint)piVar9[1]) {
        uVar12 = uVar11;
        if (uVar11 < (uint)piVar9[2] >> 1) {
LAB_005746ee:
          FUN_0056c310(piVar9,uVar12);
        }
      }
      else if ((uint)piVar9[2] <= uVar11) {
        uVar12 = (uVar11 >> 2) + uVar11;
        goto LAB_005746ee;
      }
      puVar6 = (undefined4 *)(*piVar9 + -4 + uVar11 * 4);
      piVar9[1] = uVar11;
      if (puVar6 != (undefined4 *)0x0) {
        *puVar6 = puVar8;
      }
    }
    *(int **)(in_ECX + 5) = piVar9;
  }
  param_1[0x13] = (int)piVar9;
  param_1[0x15] = 0;
  if ((bVar2 >> 1 & 1) == 0) {
    if ((bVar2 & 1) != 0) {
      param_1[0x15] = 1;
    }
  }
  else if ((bVar2 & 1) != 0) {
    param_1[0x15] = 2;
    return;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00574380 : SUB ESP,0x48
00574383 : PUSH EBX
00574384 : XOR EBX,EBX
00574386 : MOV dword ptr [ESP + 0x8],ECX
0057438a : ADD ECX,0x4
0057438d : MOV dword ptr [ESP + 0x14],EBX
00574391 : MOV dword ptr [ESP + 0xc],ECX
00574395 : MOV dword ptr [ESP + 0x10],0xffffffff
0057439d : MOV dword ptr [ESP + 0x18],EBX
005743a1 : MOV DL,byte ptr [ECX]
005743a3 : PUSH EBP
005743a4 : MOV byte ptr [ESP + 0x9],DL
005743a8 : PUSH ESI
005743a9 : MOV EAX,0x1
005743ae : AND DL,0x80
005743b1 : PUSH EDI
005743b2 : MOV dword ptr [ESP + 0x20],EAX
005743b6 : MOV byte ptr [ESP + 0x13],DL
005743ba : JZ 0x005743c5
005743bc : MOV EAX,0x5
005743c1 : MOV dword ptr [ESP + 0x20],EAX
005743c5 : MOV dword ptr [ESP + 0x24],EBX
005743c9 : MOV DL,byte ptr [ECX + EAX*0x1]
005743cc : INC EAX
005743cd : MOV byte ptr [ESP + 0x12],DL
005743d1 : MOV dword ptr [ESP + 0x20],EAX
005743d5 : XOR ESI,ESI
005743d7 : MOV dword ptr [ESP + 0x24],ESI
005743db : MOVZX DX,byte ptr [ECX + EAX*0x1 + 0x1]
005743e1 : MOVZX DI,byte ptr [ECX + EAX*0x1]
005743e6 : SHL DX,0x8
005743ea : OR DX,DI
005743ed : MOV EDI,dword ptr [ESP + 0x5c]
005743f1 : MOVZX EDX,DX
005743f4 : MOVZX EDX,DX
005743f7 : ADD EAX,0x2
005743fa : TEST byte ptr [ESP + 0x11],0x2
005743ff : MOV dword ptr [ESP + 0x20],EAX
00574403 : MOV dword ptr [EDI + 0x40],EDX
00574406 : JZ 0x00574432
00574408 : OR byte ptr [EDI + 0x4b],0x2
0057440c : MOV dword ptr [ESP + 0x24],ESI
00574410 : MOVZX DX,byte ptr [ECX + EAX*0x1 + 0x1]
00574416 : MOVZX BP,byte ptr [ECX + EAX*0x1]
0057441b : SHL DX,0x8
0057441f : OR DX,BP
00574422 : MOVZX EDX,DX
00574425 : MOVZX EDX,DX
00574428 : ADD EAX,0x2
0057442b : MOV dword ptr [ESP + 0x20],EAX
0057442f : MOV dword ptr [EDI + 0x44],EDX
00574432 : TEST byte ptr [ESP + 0x11],0x4
00574437 : JZ 0x00574456
00574439 : OR byte ptr [EDI + 0x4b],0x4
0057443d : LEA EAX,[EDI + 0x24]
00574440 : PUSH EAX
00574441 : LEA ECX,[ESP + 0x1c]
00574445 : CALL 0x0053a210
0057444a : MOV ESI,dword ptr [ESP + 0x24]
0057444e : MOV EAX,dword ptr [ESP + 0x20]
00574452 : MOV ECX,dword ptr [ESP + 0x18]
00574456 : TEST byte ptr [ESP + 0x11],0x8
0057445b : JZ 0x0057447a
0057445d : OR byte ptr [EDI + 0x4b],0x8
00574461 : LEA ECX,[EDI + 0x4]
00574464 : PUSH ECX
00574465 : LEA ECX,[ESP + 0x1c]
00574469 : CALL 0x0053a570
0057446e : MOV ESI,dword ptr [ESP + 0x24]
00574472 : MOV EAX,dword ptr [ESP + 0x20]
00574476 : MOV ECX,dword ptr [ESP + 0x18]
0057447a : TEST byte ptr [ESP + 0x11],0x10
0057447f : JZ 0x005744c4
00574481 : OR byte ptr [EDI + 0x4b],0x10
00574485 : CMP ESI,EBX
00574487 : JZ 0x0057448e
00574489 : INC EAX
0057448a : MOV dword ptr [ESP + 0x20],EAX
0057448e : XOR ESI,ESI
00574490 : MOV dword ptr [ESP + 0x24],ESI
00574494 : MOVZX DX,byte ptr [ECX + EAX*0x1 + 0x1]
0057449a : MOVZX BP,byte ptr [ECX + EAX*0x1]
0057449f : SHL DX,0x8
005744a3 : OR DX,BP
005744a6 : MOVZX EDX,DX
005744a9 : MOVZX EDX,DX
005744ac : MOV dword ptr [ESP + 0x5c],EDX
005744b0 : ADD EAX,0x2
005744b3 : MOV dword ptr [ESP + 0x20],EAX
005744b7 : FILD dword ptr [ESP + 0x5c]
005744bb : FDIV double ptr [0x00b8d220]
005744c1 : FSTP float ptr [EDI + 0x3c]
005744c4 : TEST byte ptr [ESP + 0x11],0x20
005744c9 : JZ 0x005744f4
005744cb : CMP ESI,EBX
005744cd : JZ 0x005744d4
005744cf : INC EAX
005744d0 : MOV dword ptr [ESP + 0x20],EAX
005744d4 : MOV EDX,dword ptr [ESP + 0x14]
005744d8 : LEA EDX,[EAX + EDX*0x1 + 0x4]
005744dc : MOV dword ptr [EDI + 0x50],EDX
005744df : NOP
005744e0 : XOR ESI,ESI
005744e2 : MOV dword ptr [ESP + 0x24],ESI
005744e6 : MOV DL,byte ptr [ECX + EAX*0x1]
005744e9 : INC EAX
005744ea : MOV dword ptr [ESP + 0x20],EAX
005744ee : TEST DL,DL
005744f0 : JNZ 0x005744e0
005744f2 : JMP 0x005744f7
005744f4 : MOV dword ptr [EDI + 0x50],EBX
005744f7 : TEST byte ptr [ESP + 0x11],0x40
005744fc : JZ 0x00574531
005744fe : CMP ESI,EBX
00574500 : JZ 0x00574507
00574502 : INC EAX
00574503 : MOV dword ptr [ESP + 0x20],EAX
00574507 : XOR ESI,ESI
00574509 : MOV dword ptr [ESP + 0x24],ESI
0057450d : MOVZX DX,byte ptr [ECX + EAX*0x1 + 0x1]
00574513 : MOVZX BP,byte ptr [ECX + EAX*0x1]
00574518 : SHL DX,0x8
0057451c : OR DX,BP
0057451f : MOVZX EDX,DX
00574522 : ADD EAX,0x2
00574525 : MOV word ptr [EDI + 0x48],DX
00574529 : OR byte ptr [EDI + 0x4b],0x40
0057452d : MOV dword ptr [ESP + 0x20],EAX
00574531 : TEST byte ptr [ESP + 0x12],0x1
00574536 : JZ 0x005745b0
00574538 : OR byte ptr [EDI + 0x4b],0x20
0057453c : PUSH 0x4
0057453e : LEA EAX,[ESP + 0x2c]
00574542 : PUSH EAX
00574543 : LEA ECX,[ESP + 0x20]
00574547 : PUSH ECX
00574548 : CALL 0x0059d9a0
0057454d : MOV EBP,EAX
0057454f : ADD ESP,0xc
00574552 : CMP EBP,EBX
00574554 : JZ 0x005745a4
00574556 : CMP dword ptr [EDI],EBX
00574558 : JNZ 0x0057458c
0057455a : MOV EDX,dword ptr [ESP + 0x14]
0057455e : PUSH EDX
0057455f : CALL 0x00515dd0
00574564 : PUSH EBX
00574565 : PUSH 0x1c
00574567 : MOV ECX,EAX
00574569 : CALL 0x00515840
0057456e : CMP EAX,EBX
00574570 : JZ 0x0057457d
00574572 : MOV ECX,EAX
00574574 : CALL 0x0050b5a0
00574579 : MOV ESI,EAX
0057457b : JMP 0x0057457f
0057457d : XOR ESI,ESI
0057457f : MOV ECX,dword ptr [EDI]
00574581 : CMP ECX,EBX
00574583 : JZ 0x0057458a
00574585 : CALL 0x004ff7c0
0057458a : MOV dword ptr [EDI],ESI
0057458c : CMP EBP,EBX
0057458e : JBE 0x005745a4
00574590 : LEA ESI,[ESP + 0x28]
00574594 : MOV ECX,dword ptr [EDI]
00574596 : PUSH ESI
00574597 : CALL 0x0059d2e0
0057459c : ADD ESI,0xc
0057459f : SUB EBP,0x1
005745a2 : JNZ 0x00574594
005745a4 : MOV ECX,dword ptr [ESP + 0x18]
005745a8 : MOV EAX,dword ptr [ESP + 0x20]
005745ac : MOV ESI,dword ptr [ESP + 0x24]
005745b0 : MOV DL,byte ptr [ESP + 0x12]
005745b4 : TEST DL,0x2
005745b7 : JZ 0x005745df
005745b9 : OR byte ptr [EDI + 0x4b],0x80
005745bd : CMP ESI,EBX
005745bf : JZ 0x005745c6
005745c1 : INC EAX
005745c2 : MOV dword ptr [ESP + 0x20],EAX
005745c6 : XOR ESI,ESI
005745c8 : MOV dword ptr [ESP + 0x24],ESI
005745cc : MOV CL,byte ptr [ECX + EAX*0x1]
005745cf : INC EAX
005745d0 : CMP CL,0x1
005745d3 : JC 0x005745da
005745d5 : CMP CL,0xe
005745d8 : JBE 0x005745dc
005745da : MOV CL,0x1
005745dc : MOV byte ptr [EDI + 0x4a],CL
005745df : TEST DL,0x4
005745e2 : JZ 0x005745ec
005745e4 : CMP ESI,EBX
005745e6 : JZ 0x005745e9
005745e8 : INC EAX
005745e9 : XOR ESI,ESI
005745eb : INC EAX
005745ec : XOR EBP,EBP
005745ee : CMP byte ptr [ESP + 0x13],BL
005745f2 : JZ 0x00574716
005745f8 : MOV ECX,dword ptr [ESP + 0x14]
005745fc : MOV EBP,dword ptr [ECX + 0x5]
005745ff : CMP EBP,EBX
00574601 : JNZ 0x00574716
00574607 : CMP ESI,EBX
00574609 : JZ 0x0057460c
0057460b : INC EAX
0057460c : ADD EAX,0x2
0057460f : ADD EAX,0x4
00574612 : PUSH ECX
00574613 : MOV dword ptr [ESP + 0x28],EBX
00574617 : MOV dword ptr [ESP + 0x24],EAX
0057461b : CALL 0x00515dd0
00574620 : PUSH EBX
00574621 : PUSH 0xc
00574623 : MOV ECX,EAX
00574625 : CALL 0x00515840
0057462a : CMP EAX,EBX
0057462c : JZ 0x0057463a
0057462e : MOV dword ptr [EAX],EBX
00574630 : MOV dword ptr [EAX + 0x4],EBX
00574633 : MOV dword ptr [EAX + 0x8],EBX
00574636 : MOV EBP,EAX
00574638 : JMP 0x00574642
0057463a : XOR EBP,EBP
0057463c : JMP 0x00574642
00574640 : XOR EBX,EBX
00574642 : MOV EAX,dword ptr [ESP + 0x20]
00574646 : CMP dword ptr [ESP + 0x24],EBX
0057464a : JZ 0x00574651
0057464c : INC EAX
0057464d : MOV dword ptr [ESP + 0x20],EAX
00574651 : MOV ECX,dword ptr [ESP + 0x18]
00574655 : MOV dword ptr [ESP + 0x24],EBX
00574659 : MOVZX ESI,byte ptr [ECX + EAX*0x1 + 0x3]
0057465e : MOVZX EDX,byte ptr [ECX + EAX*0x1 + 0x2]
00574663 : SHL ESI,0x8
00574666 : OR ESI,EDX
00574668 : MOVZX EDX,byte ptr [ECX + EAX*0x1 + 0x1]
0057466d : MOVZX ECX,byte ptr [ECX + EAX*0x1]
00574671 : SHL ESI,0x8
00574674 : OR ESI,EDX
00574676 : SHL ESI,0x8
00574679 : OR ESI,ECX
0057467b : ADD EAX,0x4
0057467e : MOV dword ptr [ESP + 0x20],EAX
00574682 : CMP ESI,EBX
00574684 : JZ 0x0057470f
0057468a : MOV EDX,dword ptr [ESP + 0x14]
0057468e : PUSH EDX
0057468f : CALL 0x00515dd0
00574694 : PUSH EBX
00574695 : PUSH 0x14
00574697 : MOV ECX,EAX
00574699 : CALL 0x00515840
0057469e : CMP EAX,EBX
005746a0 : JZ 0x005746bf
005746a2 : XOR ECX,ECX
005746a4 : MOV dword ptr [EAX],EBX
005746a6 : MOV dword ptr [EAX + 0x4],EBX
005746a9 : MOV word ptr [EAX + 0x8],CX
005746ad : MOV byte ptr [EAX + 0xa],CL
005746b0 : MOV byte ptr [EAX + 0xb],0xff
005746b4 : MOV byte ptr [EAX + 0xc],CL
005746b7 : MOV byte ptr [EAX + 0xd],CL
005746ba : MOV dword ptr [EAX + 0x10],EBX
005746bd : MOV EBX,EAX
005746bf : PUSH ESI
005746c0 : LEA EDX,[ESP + 0x1c]
005746c4 : PUSH EDX
005746c5 : MOV ECX,EBX
005746c7 : CALL 0x0056bd40
005746cc : MOV ESI,dword ptr [EBP + 0x4]
005746cf : INC ESI
005746d0 : CMP ESI,dword ptr [EBP + 0x4]
005746d3 : JNC 0x005746e1
005746d5 : MOV EAX,dword ptr [EBP + 0x8]
005746d8 : SHR EAX,0x1
005746da : CMP ESI,EAX
005746dc : JNC 0x005746f6
005746de : PUSH ESI
005746df : JMP 0x005746ee
005746e1 : CMP ESI,dword ptr [EBP + 0x8]
005746e4 : JC 0x005746f6
005746e6 : MOV ECX,ESI
005746e8 : SHR ECX,0x2
005746eb : ADD ECX,ESI
005746ed : PUSH ECX
005746ee : PUSH EBP
005746ef : MOV ECX,EBP
005746f1 : CALL 0x0056c310
005746f6 : MOV EDX,dword ptr [EBP]
005746f9 : LEA EAX,[EDX + ESI*0x4 + -0x4]
005746fd : MOV dword ptr [EBP + 0x4],ESI
00574700 : TEST EAX,EAX
00574702 : JZ 0x00574640
00574708 : MOV dword ptr [EAX],EBX
0057470a : JMP 0x00574640
0057470f : MOV EAX,dword ptr [ESP + 0x14]
00574713 : MOV dword ptr [EAX + 0x5],EBP
00574716 : MOV CL,byte ptr [ESP + 0x11]
0057471a : MOV AL,CL
0057471c : SHR AL,0x1
0057471e : AND AL,0x1
00574720 : AND CL,0x1
00574723 : MOV dword ptr [EDI + 0x4c],EBP
00574726 : MOV dword ptr [EDI + 0x54],EBX
00574729 : TEST AL,AL
0057472b : JZ 0x00574742
0057472d : TEST CL,CL
0057472f : JZ 0x0057474d
00574731 : MOV dword ptr [EDI + 0x54],0x2
00574738 : POP EDI
00574739 : POP ESI
0057473a : POP EBP
0057473b : POP EBX
0057473c : ADD ESP,0x48
0057473f : RET 0x4
00574742 : TEST CL,CL
00574744 : JZ 0x0057474d
00574746 : MOV dword ptr [EDI + 0x54],0x1
0057474d : POP EDI
0057474e : POP ESI
0057474f : POP EBP
00574750 : POP EBX
00574751 : ADD ESP,0x48
00574754 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_00a40cd0
ENTRY    : 00a40cd0
BODY     : [[00a40cd0, 00a40edd]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00a40cd0(void)

{
  int iVar1;
  int *piVar2;
  uint uVar3;
  undefined4 uVar4;
  int in_ECX;
  int iVar5;
  float10 extraout_ST0;
  float fVar6;
  float fVar7;
  float local_58;
  int local_54;
  undefined1 local_50 [60];
  void *local_14;
  undefined1 *puStack_10;
  int local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b6832a;
  local_14 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xffffff98;
  ExceptionList = &local_14;
  iVar1 = *DAT_00da9894;
  local_58 = *(float *)(*(int *)(iVar1 + 0x174) + 0x38);
  iVar5 = *(int *)(DAT_017248f8 + 0x1c);
  FUN_004437f0(&local_58);
  if ((local_54 != *(int *)(iVar5 + 4)) && (*(int *)(local_54 + 0x10) != 0)) {
    fVar6 = *(float *)(*(int *)(in_ECX + 0xac) + 0x1a4) - *(float *)(in_ECX + 0x2a0);
    fVar7 = *(float *)(*(int *)(in_ECX + 0xac) + 0x1ac) - *(float *)(in_ECX + 0x2a8);
    FUN_0040f460(fVar6 * fVar6 + fVar7 * fVar7,uVar3);
    local_58 = (float)extraout_ST0;
    iVar1 = *(int *)(iVar1 + 300);
    iVar5 = 0;
    if (iVar1 != 0) {
      iVar5 = *(int *)(iVar1 + 0x18);
    }
    if (*(int *)(iVar5 + 0x120) == 2) {
      fVar6 = 100.0;
    }
    else {
      fVar6 = 30.0;
    }
    if (*(char *)(in_ECX + 0x2ac) == '\x01') {
      if ((local_58 < fVar6) && (*(char *)(in_ECX + 0x2ad) == '\0')) {
        *(undefined1 *)(in_ECX + 0x2ac) = 0;
        FUN_00a1b180();
        if ((((*(int *)(in_ECX + 0xac) != 0) && (*(uint *)(*(int *)(in_ECX + 0xac) + 0xa0) < 0xb))
            && (DAT_0172491c != 0)) &&
           ((*DAT_00da9894 != 0 && (*(int *)(*DAT_00da9894 + 0x1a8) != 0)))) {
          FUN_00406460(L"IDS_QUEST_BOOKMARK_ARRIVED");
          local_c = 0;
          piVar2 = *(int **)(*DAT_00da9894 + 0x1a8);
          uVar4 = FUN_0081d120(local_50);
          local_c._0_1_ = 1;
          (**(code **)(*piVar2 + 0x44))(uVar4,0x13);
          local_c = (uint)local_c._1_3_ << 8;
          FUN_00406560();
          local_c = 0xffffffff;
          FUN_00406560();
        }
        ExceptionList = local_14;
        return 1;
      }
    }
    else if (fVar6 <= local_58) {
      *(undefined1 *)(in_ECX + 0x2ac) = 1;
      FUN_00933dd0();
      FUN_00934ef0();
    }
  }
  ExceptionList = local_14;
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00a40cd0 : PUSH EBP
00a40cd1 : MOV EBP,ESP
00a40cd3 : AND ESP,0xfffffff8
00a40cd6 : PUSH -0x1
00a40cd8 : PUSH 0xb6832a
00a40cdd : MOV EAX,FS:[0x0]
00a40ce3 : PUSH EAX
00a40ce4 : SUB ESP,0x48
00a40ce7 : PUSH EBX
00a40ce8 : PUSH ESI
00a40ce9 : PUSH EDI
00a40cea : MOV EAX,[0x00d66fa0]
00a40cef : XOR EAX,ESP
00a40cf1 : PUSH EAX
00a40cf2 : LEA EAX,[ESP + 0x58]
00a40cf6 : MOV FS:[0x0],EAX
00a40cfc : MOV ESI,ECX
00a40cfe : MOV EAX,[0x00da9894]
00a40d03 : MOV EBX,dword ptr [EAX]
00a40d05 : MOV EAX,dword ptr [EBX + 0x174]
00a40d0b : MOV ECX,dword ptr [EAX + 0x38]
00a40d0e : MOV EDX,dword ptr [0x017248f8]
00a40d14 : MOV EDI,dword ptr [EDX + 0x1c]
00a40d17 : LEA EAX,[ESP + 0x14]
00a40d1b : MOV dword ptr [ESP + 0x14],ECX
00a40d1f : PUSH EAX
00a40d20 : LEA EAX,[ESP + 0x1c]
00a40d24 : MOV ECX,EDI
00a40d26 : CALL 0x004437f0
00a40d2b : MOV EDI,dword ptr [EDI + 0x4]
00a40d2e : MOV EAX,dword ptr [ESP + 0x18]
00a40d32 : CMP EAX,EDI
00a40d34 : JZ 0x00a40ec9
00a40d3a : MOV EAX,dword ptr [EAX + 0x10]
00a40d3d : TEST EAX,EAX
00a40d3f : JZ 0x00a40ec9
00a40d45 : MOV EAX,dword ptr [ESI + 0xac]
00a40d4b : MOVSS XMM0,dword ptr [EAX + 0x1a4]
00a40d53 : SUBSS XMM0,dword ptr [ESI + 0x2a0]
00a40d5b : MOVSS XMM1,dword ptr [EAX + 0x1ac]
00a40d63 : SUBSS XMM1,dword ptr [ESI + 0x2a8]
00a40d6b : MOVAPS XMM2,XMM0
00a40d6e : MULSS XMM2,XMM0
00a40d72 : MOVAPS XMM0,XMM1
00a40d75 : MULSS XMM0,XMM1
00a40d79 : PUSH ECX
00a40d7a : ADDSS XMM2,XMM0
00a40d7e : MOVSS dword ptr [ESP],XMM2
00a40d83 : CALL 0x0040f460
00a40d88 : FSTP float ptr [ESP + 0x18]
00a40d8c : MOV EBX,dword ptr [EBX + 0x12c]
00a40d92 : ADD ESP,0x4
00a40d95 : TEST EBX,EBX
00a40d97 : JZ 0x00a40d9c
00a40d99 : MOV EBX,dword ptr [EBX + 0x18]
00a40d9c : CMP dword ptr [EBX + 0x120],0x2
00a40da3 : JNZ 0x00a40daf
00a40da5 : MOVSS XMM0,dword ptr [0x00cdf230]
00a40dad : JMP 0x00a40db7
00a40daf : MOVSS XMM0,dword ptr [0x00cdf12c]
00a40db7 : MOV BL,0x1
00a40db9 : CMP byte ptr [ESI + 0x2ac],BL
00a40dbf : JNZ 0x00a40e9e
00a40dc5 : COMISS XMM0,dword ptr [ESP + 0x14]
00a40dca : JBE 0x00a40ec9
00a40dd0 : CMP byte ptr [ESI + 0x2ad],0x0
00a40dd7 : JNZ 0x00a40ec9
00a40ddd : MOV EAX,ESI
00a40ddf : MOV byte ptr [ESI + 0x2ac],0x0
00a40de6 : CALL 0x00a1b180
00a40deb : MOV ESI,dword ptr [ESI + 0xac]
00a40df1 : TEST ESI,ESI
00a40df3 : JZ 0x00a40e89
00a40df9 : CMP dword ptr [ESI + 0xa0],0xa
00a40e00 : JA 0x00a40e89
00a40e06 : CMP dword ptr [0x0172491c],0x0
00a40e0d : JZ 0x00a40e89
00a40e0f : MOV ECX,dword ptr [0x00da9894]
00a40e15 : MOV EAX,dword ptr [ECX]
00a40e17 : TEST EAX,EAX
00a40e19 : JZ 0x00a40e89
00a40e1b : CMP dword ptr [EAX + 0x1a8],0x0
00a40e22 : JZ 0x00a40e89
00a40e24 : PUSH 0xcbece0
00a40e29 : LEA ECX,[ESP + 0x20]
00a40e2d : CALL 0x00406460
00a40e32 : MOV dword ptr [ESP + 0x60],0x0
00a40e3a : MOV EDX,dword ptr [0x00da9894]
00a40e40 : MOV EAX,dword ptr [EDX]
00a40e42 : MOV ESI,dword ptr [EAX + 0x1a8]
00a40e48 : MOV ECX,dword ptr [0x0172491c]
00a40e4e : LEA EAX,[ESP + 0x1c]
00a40e52 : PUSH EAX
00a40e53 : LEA EDI,[ESP + 0x3c]
00a40e57 : CALL 0x0081d120
00a40e5c : MOV byte ptr [ESP + 0x60],BL
00a40e60 : MOV EDX,dword ptr [ESI]
00a40e62 : PUSH 0x13
00a40e64 : PUSH EAX
00a40e65 : MOV EAX,dword ptr [EDX + 0x44]
00a40e68 : MOV ECX,ESI
00a40e6a : CALL EAX
00a40e6c : MOV byte ptr [ESP + 0x60],0x0
00a40e71 : MOV ECX,EDI
00a40e73 : CALL 0x00406560
00a40e78 : MOV dword ptr [ESP + 0x60],0xffffffff
00a40e80 : LEA ECX,[ESP + 0x1c]
00a40e84 : CALL 0x00406560
00a40e89 : MOV AL,BL
00a40e8b : MOV ECX,dword ptr [ESP + 0x58]
00a40e8f : MOV dword ptr FS:[0x0],ECX
00a40e96 : POP ECX
00a40e97 : POP EDI
00a40e98 : POP ESI
00a40e99 : POP EBX
00a40e9a : MOV ESP,EBP
00a40e9c : POP EBP
00a40e9d : RET
00a40e9e : MOVSS XMM1,dword ptr [ESP + 0x14]
00a40ea4 : COMISS XMM1,XMM0
00a40ea7 : JC 0x00a40ec9
00a40ea9 : MOV ECX,dword ptr [0x00da9894]
00a40eaf : MOV byte ptr [ESI + 0x2ac],BL
00a40eb5 : MOV EDX,dword ptr [ECX]
00a40eb7 : MOV EAX,dword ptr [EDX + 0x174]
00a40ebd : CALL 0x00933dd0
00a40ec2 : MOV ECX,EAX
00a40ec4 : CALL 0x00934ef0
00a40ec9 : XOR AL,AL
00a40ecb : MOV ECX,dword ptr [ESP + 0x58]
00a40ecf : MOV dword ptr FS:[0x0],ECX
00a40ed6 : POP ECX
00a40ed7 : POP EDI
00a40ed8 : POP ESI
00a40ed9 : POP EBX
00a40eda : MOV ESP,EBP
00a40edc : POP EBP
00a40edd : RET

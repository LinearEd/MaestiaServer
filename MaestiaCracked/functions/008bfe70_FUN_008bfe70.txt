PROGRAM  : Maestia.exe
FUNCTION : FUN_008bfe70
ENTRY    : 008bfe70
BODY     : [[008bfe70, 008bff64]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008bfe70(void)

{
  uint uVar1;
  int iVar2;
  int *piVar3;
  undefined4 in_ECX;
  int iVar4;
  undefined1 local_24 [4];
  int local_20;
  int local_1c;
  int local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b44fa2;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  FUN_0040e750(in_ECX,local_24);
  local_8 = 0;
  if (local_1c != 0) {
    iVar4 = 0x26;
    do {
      local_14 = iVar4;
      FUN_00484470(&local_14);
      if ((((local_18 != local_20) && (iVar2 = FUN_00703c00(0x700,uVar1), iVar2 != 0)) &&
          (iVar2 = FUN_008410a0(), iVar2 != 0)) &&
         (piVar3 = (int *)FUN_009f2840(*(undefined4 *)(iVar2 + 4)), piVar3 != (int *)0x0)) {
        (**(code **)(*piVar3 + 0xb4))();
      }
      iVar4 = iVar4 + 1;
    } while (iVar4 < 0x4b);
  }
  local_8 = 0xffffffff;
  FUN_0040f3f0(local_24);
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
008bfe70 : PUSH EBP
008bfe71 : MOV EBP,ESP
008bfe73 : PUSH -0x1
008bfe75 : PUSH 0xb44fa2
008bfe7a : MOV EAX,FS:[0x0]
008bfe80 : PUSH EAX
008bfe81 : SUB ESP,0x14
008bfe84 : PUSH EBX
008bfe85 : PUSH ESI
008bfe86 : PUSH EDI
008bfe87 : MOV EAX,[0x00d66fa0]
008bfe8c : XOR EAX,EBP
008bfe8e : PUSH EAX
008bfe8f : LEA EAX,[EBP + -0xc]
008bfe92 : MOV FS:[0x0],EAX
008bfe98 : LEA EAX,[EBP + -0x20]
008bfe9b : PUSH EAX
008bfe9c : PUSH ECX
008bfe9d : CALL 0x0040e750
008bfea2 : MOV dword ptr [EBP + -0x4],0x0
008bfea9 : CMP dword ptr [EBP + -0x18],0x0
008bfead : JNZ 0x008bfebf
008bfeaf : MOV dword ptr [EBP + -0x4],0xffffffff
008bfeb6 : LEA EDX,[EBP + -0x20]
008bfeb9 : PUSH EDX
008bfeba : JMP 0x008bff4e
008bfebf : MOV EBX,0x26
008bfec4 : LEA EAX,[EBP + -0x10]
008bfec7 : PUSH EAX
008bfec8 : LEA EAX,[EBP + -0x14]
008bfecb : LEA ECX,[EBP + -0x20]
008bfece : MOV dword ptr [EBP + -0x10],EBX
008bfed1 : CALL 0x00484470
008bfed6 : MOV EAX,dword ptr [EBP + -0x14]
008bfed9 : CMP EAX,dword ptr [EBP + -0x1c]
008bfedc : JZ 0x008bff3d
008bfede : MOVZX EDI,word ptr [EAX + 0x12]
008bfee2 : PUSH 0x700
008bfee7 : CALL 0x00703c00
008bfeec : MOV EDI,EAX
008bfeee : ADD ESP,0x4
008bfef1 : TEST EDI,EDI
008bfef3 : JZ 0x008bff3d
008bfef5 : MOVZX ESI,word ptr [EDI + 0x4]
008bfef9 : MOVZX ECX,word ptr [EDI + 0x6]
008bfefd : MOV EDX,dword ptr [0x01724910]
008bff03 : SHL ESI,0x10
008bff06 : OR ESI,ECX
008bff08 : CALL 0x008410a0
008bff0d : TEST EAX,EAX
008bff0f : JZ 0x008bff3d
008bff11 : MOV ECX,dword ptr [EAX + 0x4]
008bff14 : MOVZX EAX,word ptr [EDI + 0x4]
008bff18 : MOVZX EDX,word ptr [EDI + 0x6]
008bff1c : SHL EAX,0x10
008bff1f : PUSH ECX
008bff20 : MOV ECX,dword ptr [0x017247f0]
008bff26 : OR EAX,EDX
008bff28 : CALL 0x009f2840
008bff2d : TEST EAX,EAX
008bff2f : JZ 0x008bff3d
008bff31 : MOV EDX,dword ptr [EAX]
008bff33 : MOV ECX,EAX
008bff35 : MOV EAX,dword ptr [EDX + 0xb4]
008bff3b : CALL EAX
008bff3d : INC EBX
008bff3e : CMP EBX,0x4b
008bff41 : JL 0x008bfec4
008bff43 : MOV dword ptr [EBP + -0x4],0xffffffff
008bff4a : LEA ECX,[EBP + -0x20]
008bff4d : PUSH ECX
008bff4e : CALL 0x0040f3f0
008bff53 : MOV ECX,dword ptr [EBP + -0xc]
008bff56 : MOV dword ptr FS:[0x0],ECX
008bff5d : POP ECX
008bff5e : POP EDI
008bff5f : POP ESI
008bff60 : POP EBX
008bff61 : MOV ESP,EBP
008bff63 : POP EBP
008bff64 : RET

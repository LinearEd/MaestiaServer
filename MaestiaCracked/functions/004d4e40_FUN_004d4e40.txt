PROGRAM  : Maestia.exe
FUNCTION : FUN_004d4e40
ENTRY    : 004d4e40
BODY     : [[004d4e40, 004d5010]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_004d4e40(void)

{
  uint uVar1;
  undefined4 *puVar2;
  undefined1 auStack_1470 [4];
  WCHAR *local_146c;
  undefined1 local_1468 [4];
  undefined2 local_1464;
  undefined4 local_1454;
  uint local_1450;
  undefined1 local_144c [4];
  undefined2 local_1448;
  undefined4 local_1438;
  uint local_1434;
  undefined1 local_1228 [6];
  undefined1 local_1222 [1538];
  WCHAR local_c20 [512];
  WCHAR local_820 [1026];
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b79d76;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_1470;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xffffeb88;
  ExceptionList = &local_14;
  DAT_01724530 = 10000;
  GetModuleFileNameW((HMODULE)0x0,local_c20,0x200);
  FUN_004d6470(local_c20);
  local_146c = local_c20;
  FUN_004d6450(L"%s%s",local_1228,local_1222,uVar1);
  FUN_0040e4a0(L"%sConsoleVar",local_c20);
  GetCurrentDirectoryW(0x100,local_820);
  local_1464 = 0;
  local_1450 = 7;
  local_1454 = 0;
  FUN_00406360(L"pv_LastRecvPacket_WaitTime",0x1a);
  local_c = 0;
  puVar2 = (undefined4 *)FUN_004d52b0(local_1468);
  *puVar2 = &DAT_017244f0;
  local_c = 0xffffffff;
  if (7 < local_1450) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_1448 = 0;
  local_1450 = 7;
  local_1454 = 0;
  local_1464 = 0;
  local_1434 = 7;
  local_1438 = 0;
  FUN_00406360(L"pv_AVM_LOGIN_CHECK_LONGTIME",0x1b);
  local_c = 1;
  puVar2 = (undefined4 *)FUN_004d52b0(local_144c);
  *puVar2 = &DAT_01724558;
  local_c = 0xffffffff;
  if (7 < local_1434) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_1434 = 7;
  local_1438 = 0;
  local_1448 = 0;
  __wchdir(local_820);
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_1470);
  return;
}



============================================================
DISASSEMBLY
============================================================
004d4e40 : PUSH EBP
004d4e41 : MOV EBP,ESP
004d4e43 : AND ESP,0xfffffff8
004d4e46 : PUSH -0x1
004d4e48 : PUSH 0xb79d76
004d4e4d : MOV EAX,FS:[0x0]
004d4e53 : PUSH EAX
004d4e54 : PUSH ECX
004d4e55 : MOV EAX,0x1458
004d4e5a : CALL 0x0063b780
004d4e5f : MOV EAX,[0x00d66fa0]
004d4e64 : XOR EAX,ESP
004d4e66 : MOV dword ptr [ESP + 0x1454],EAX
004d4e6d : PUSH ESI
004d4e6e : PUSH EDI
004d4e6f : MOV EAX,[0x00d66fa0]
004d4e74 : XOR EAX,ESP
004d4e76 : PUSH EAX
004d4e77 : LEA EAX,[ESP + 0x1468]
004d4e7e : MOV FS:[0x0],EAX
004d4e84 : PUSH 0x200
004d4e89 : LEA EAX,[ESP + 0x860]
004d4e90 : PUSH EAX
004d4e91 : XOR EDI,EDI
004d4e93 : PUSH EDI
004d4e94 : MOV dword ptr [0x01724530],0x2710
004d4e9e : CALL dword ptr [0x00b85144]
004d4ea4 : LEA ECX,[ESP + 0x85c]
004d4eab : PUSH ECX
004d4eac : LEA ESI,[ESP + 0x50]
004d4eb0 : CALL 0x004d6470
004d4eb5 : LEA EAX,[ESP + 0x25a]
004d4ebc : PUSH EAX
004d4ebd : LEA ECX,[ESP + 0x258]
004d4ec4 : PUSH ECX
004d4ec5 : LEA EDX,[ESP + 0x864]
004d4ecc : PUSH 0xcda878
004d4ed1 : LEA EAX,[ESP + 0x1c]
004d4ed5 : MOV dword ptr [ESP + 0x1c],EDX
004d4ed9 : CALL 0x004d6450
004d4ede : ADD ESP,0xc
004d4ee1 : LEA EDX,[ESP + 0x85c]
004d4ee8 : PUSH EDX
004d4ee9 : PUSH 0xcda7b4
004d4eee : LEA EDX,[ESP + 0xa64]
004d4ef5 : CALL 0x0040e4a0
004d4efa : ADD ESP,0x8
004d4efd : LEA EAX,[ESP + 0xc5c]
004d4f04 : PUSH EAX
004d4f05 : PUSH 0x100
004d4f0a : CALL dword ptr [0x00b851d4]
004d4f10 : XOR ECX,ECX
004d4f12 : PUSH 0x1a
004d4f14 : MOV word ptr [ESP + 0x1c],CX
004d4f19 : MOV ESI,0x7
004d4f1e : PUSH 0xcda660
004d4f23 : LEA ECX,[ESP + 0x1c]
004d4f27 : MOV dword ptr [ESP + 0x34],ESI
004d4f2b : MOV dword ptr [ESP + 0x30],EDI
004d4f2f : CALL 0x00406360
004d4f34 : LEA EDX,[ESP + 0x14]
004d4f38 : PUSH EDX
004d4f39 : MOV dword ptr [ESP + 0x1474],EDI
004d4f40 : CALL 0x004d52b0
004d4f45 : MOV dword ptr [EAX],0x17244f0
004d4f4b : MOV dword ptr [ESP + 0x1470],0xffffffff
004d4f56 : CMP dword ptr [ESP + 0x2c],0x8
004d4f5b : JC 0x004d4f66
004d4f5d : MOV ECX,dword ptr [ESP + 0x18]
004d4f61 : CALL 0x006f04e0
004d4f66 : XOR ECX,ECX
004d4f68 : PUSH 0x1b
004d4f6a : XOR EAX,EAX
004d4f6c : MOV word ptr [ESP + 0x38],CX
004d4f71 : PUSH 0xcda77c
004d4f76 : LEA ECX,[ESP + 0x38]
004d4f7a : MOV dword ptr [ESP + 0x34],ESI
004d4f7e : MOV dword ptr [ESP + 0x30],EDI
004d4f82 : MOV word ptr [ESP + 0x20],AX
004d4f87 : MOV dword ptr [ESP + 0x50],ESI
004d4f8b : MOV dword ptr [ESP + 0x4c],EDI
004d4f8f : CALL 0x00406360
004d4f94 : LEA EDX,[ESP + 0x30]
004d4f98 : PUSH EDX
004d4f99 : MOV dword ptr [ESP + 0x1474],0x1
004d4fa4 : CALL 0x004d52b0
004d4fa9 : MOV dword ptr [EAX],0x1724558
004d4faf : MOV dword ptr [ESP + 0x1470],0xffffffff
004d4fba : CMP dword ptr [ESP + 0x48],0x8
004d4fbf : JC 0x004d4fca
004d4fc1 : MOV ECX,dword ptr [ESP + 0x34]
004d4fc5 : CALL 0x006f04e0
004d4fca : LEA ECX,[ESP + 0xc5c]
004d4fd1 : XOR EAX,EAX
004d4fd3 : PUSH ECX
004d4fd4 : MOV dword ptr [ESP + 0x4c],ESI
004d4fd8 : MOV dword ptr [ESP + 0x48],EDI
004d4fdc : MOV word ptr [ESP + 0x38],AX
004d4fe1 : CALL 0x0063fd19
004d4fe6 : ADD ESP,0x4
004d4fe9 : MOV EAX,0x17245cc
004d4fee : MOV ECX,dword ptr [ESP + 0x1468]
004d4ff5 : MOV dword ptr FS:[0x0],ECX
004d4ffc : POP ECX
004d4ffd : POP EDI
004d4ffe : POP ESI
004d4fff : MOV ECX,dword ptr [ESP + 0x1454]
004d5006 : XOR ECX,ESP
004d5008 : CALL 0x00633e6b
004d500d : MOV ESP,EBP
004d500f : POP EBP
004d5010 : RET

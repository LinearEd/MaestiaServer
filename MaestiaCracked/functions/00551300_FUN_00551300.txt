PROGRAM  : Maestia.exe
FUNCTION : FUN_00551300
ENTRY    : 00551300
BODY     : [[00551300, 005514f2]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00551300(int param_1)

{
  char cVar1;
  int iVar2;
  undefined1 uVar3;
  char *pcVar4;
  int iVar5;
  int iVar6;
  int unaff_EBX;
  int unaff_EBP;
  uint unaff_EDI;
  int *piVar7;
  float10 fVar8;
  undefined1 local_2c [12];
  char local_20 [16];
  undefined1 local_10 [4];
  double local_c;
  
  iVar2 = param_1;
  if (*(int *)(param_1 + 0x1c) < 1) goto LAB_0055140c;
  pcVar4 = (char *)FUN_00526260(0);
  local_20[0] = '\0';
  cVar1 = *pcVar4;
  if ((cVar1 == '\x03') || (cVar1 == '\x04')) {
    fVar8 = (float10)FUN_00527730(*(undefined4 *)(iVar2 + 0x18));
    local_c = (double)fVar8;
    local_10[0] = 3;
LAB_00551365:
    FUN_005268b0(local_10);
    FUN_00526bc0();
LAB_005513e0:
    if (local_20[0] != '\0') {
      FUN_005268b0(local_20);
      FUN_00526bc0();
      return;
    }
  }
  else {
    if (cVar1 == '\x02') {
      uVar3 = FUN_00526120(*(undefined4 *)(iVar2 + 0x18));
      local_c = (double)CONCAT71(local_c._1_7_,uVar3);
      local_10[0] = 2;
      goto LAB_00551365;
    }
    if (cVar1 == '\x05') {
      FUN_005272e0(&param_1,*(undefined4 *)(iVar2 + 0x18),0xffffffff,0);
      local_10[0] = 5;
      local_c = (double)CONCAT44(local_c._4_4_,param_1);
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 1;
      FUN_005268b0(local_10);
      FUN_00526bc0();
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + -1;
      if (*(int *)(param_1 + 8) == 0) {
        FUN_00525340();
      }
      goto LAB_005513e0;
    }
    if ((cVar1 == '\x06') || (cVar1 == '\a')) {
      FUN_005268b0(pcVar4);
      goto LAB_005513e0;
    }
  }
  FUN_00526bc0();
LAB_0055140c:
  iVar5 = *(int *)(iVar2 + 8);
  if (iVar5 == 0) {
    iVar5 = FUN_00515840(0x30,0);
    if (iVar5 == 0) {
      iVar6 = 0;
    }
    else {
      iVar6 = FUN_00551210(*(undefined4 *)(iVar2 + 0x18));
    }
  }
  else {
    iVar6 = iVar5 + -0x10;
    if (iVar6 != 0) {
      *(uint *)(iVar5 + -8) = *(int *)(iVar5 + -8) + 1U & 0x8fffffff;
    }
  }
  FUN_0052e7f0(local_2c,1);
  piVar7 = (int *)(*(int *)(iVar2 + 0x18) + 0x78);
  param_1 = CONCAT31(param_1._1_3_,3);
  FUN_00526210(local_2c);
  (**(code **)(*(int *)(iVar6 + 0x10) + 0x28))(piVar7,*piVar7 + 0x138,local_10,&param_1);
  FUN_00526bc0();
  FUN_005271c0(iVar6);
  if (((unaff_EDI & 2) == 0) && (unaff_EBP != 0)) {
    FUN_00503db0();
  }
  if (((unaff_EDI & 1) == 0) && (unaff_EBX != 0)) {
    FUN_00503db0();
  }
  if (iVar6 != 0) {
    FUN_00503db0();
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00551300 : SUB ESP,0x2c
00551303 : PUSH ESI
00551304 : MOV ESI,dword ptr [ESP + 0x34]
00551308 : PUSH EDI
00551309 : MOV EDI,0x1
0055130e : CMP dword ptr [ESI + 0x1c],EDI
00551311 : JL 0x0055140c
00551317 : PUSH 0x0
00551319 : MOV ECX,ESI
0055131b : CALL 0x00526260
00551320 : MOV ECX,EAX
00551322 : MOV byte ptr [ESP + 0x14],0x0
00551327 : MOV AL,byte ptr [ECX]
00551329 : CMP AL,0x3
0055132b : JZ 0x00551331
0055132d : CMP AL,0x4
0055132f : JNZ 0x0055134a
00551331 : MOV EAX,dword ptr [ESI + 0x18]
00551334 : PUSH EAX
00551335 : CALL 0x00527730
0055133a : FSTP double ptr [ESP + 0x28]
0055133e : LEA ECX,[ESP + 0x24]
00551342 : MOV byte ptr [ESP + 0x24],0x3
00551347 : PUSH ECX
00551348 : JMP 0x00551365
0055134a : CMP AL,0x2
0055134c : JNZ 0x00551379
0055134e : MOV EDX,dword ptr [ESI + 0x18]
00551351 : PUSH EDX
00551352 : CALL 0x00526120
00551357 : MOV byte ptr [ESP + 0x28],AL
0055135b : LEA EAX,[ESP + 0x24]
0055135f : MOV byte ptr [ESP + 0x24],0x2
00551364 : PUSH EAX
00551365 : LEA ECX,[ESP + 0x18]
00551369 : CALL 0x005268b0
0055136e : LEA ECX,[ESP + 0x24]
00551372 : CALL 0x00526bc0
00551377 : JMP 0x005513e0
00551379 : CMP AL,0x5
0055137b : JNZ 0x005513ce
0055137d : MOV EDX,dword ptr [ESI + 0x18]
00551380 : PUSH 0x0
00551382 : PUSH -0x1
00551384 : PUSH EDX
00551385 : LEA EAX,[ESP + 0x44]
00551389 : PUSH EAX
0055138a : CALL 0x005272e0
0055138f : MOV EAX,dword ptr [ESP + 0x38]
00551393 : LEA ECX,[ESP + 0x24]
00551397 : PUSH ECX
00551398 : MOV byte ptr [ESP + 0x28],0x5
0055139d : MOV dword ptr [ESP + 0x2c],EAX
005513a1 : ADD dword ptr [EAX + 0x8],EDI
005513a4 : LEA ECX,[ESP + 0x18]
005513a8 : CALL 0x005268b0
005513ad : LEA ECX,[ESP + 0x24]
005513b1 : CALL 0x00526bc0
005513b6 : MOV EAX,dword ptr [ESP + 0x38]
005513ba : DEC dword ptr [EAX + 0x8]
005513bd : MOV ECX,EAX
005513bf : ADD EAX,0x8
005513c2 : CMP dword ptr [EAX],0x0
005513c5 : JNZ 0x005513e0
005513c7 : CALL 0x00525340
005513cc : JMP 0x005513e0
005513ce : CMP AL,0x6
005513d0 : JZ 0x005513d6
005513d2 : CMP AL,0x7
005513d4 : JNZ 0x00551403
005513d6 : PUSH ECX
005513d7 : LEA ECX,[ESP + 0x18]
005513db : CALL 0x005268b0
005513e0 : CMP byte ptr [ESP + 0x14],0x0
005513e5 : JZ 0x00551403
005513e7 : MOV ECX,dword ptr [ESI + 0x4]
005513ea : LEA EDX,[ESP + 0x14]
005513ee : PUSH EDX
005513ef : CALL 0x005268b0
005513f4 : LEA ECX,[ESP + 0x14]
005513f8 : CALL 0x00526bc0
005513fd : POP EDI
005513fe : POP ESI
005513ff : ADD ESP,0x2c
00551402 : RET
00551403 : LEA ECX,[ESP + 0x14]
00551407 : CALL 0x00526bc0
0055140c : MOV EAX,dword ptr [ESI + 0x8]
0055140f : PUSH EBX
00551410 : TEST EAX,EAX
00551412 : JZ 0x0055142a
00551414 : LEA EBX,[EAX + -0x10]
00551417 : TEST EBX,EBX
00551419 : JZ 0x00551454
0055141b : MOV EAX,dword ptr [EBX + 0x8]
0055141e : ADD EAX,EDI
00551420 : AND EAX,0x8fffffff
00551425 : MOV dword ptr [EBX + 0x8],EAX
00551428 : JMP 0x00551454
0055142a : MOV ECX,dword ptr [ESI + 0x18]
0055142d : MOV EDX,dword ptr [ECX + 0x78]
00551430 : MOV ECX,dword ptr [EDX + 0x288]
00551436 : PUSH 0x0
00551438 : PUSH 0x30
0055143a : CALL 0x00515840
0055143f : TEST EAX,EAX
00551441 : JZ 0x00551450
00551443 : MOV ECX,dword ptr [ESI + 0x18]
00551446 : PUSH ECX
00551447 : MOV ECX,EAX
00551449 : CALL 0x00551210
0055144e : JMP 0x00551452
00551450 : XOR EAX,EAX
00551452 : MOV EBX,EAX
00551454 : MOV ECX,dword ptr [ESI + 0x18]
00551457 : PUSH EBP
00551458 : PUSH EDI
00551459 : LEA EDX,[ESP + 0x14]
0055145d : PUSH EDX
0055145e : CALL 0x0052e7f0
00551463 : MOV EDI,dword ptr [ESI + 0x18]
00551466 : LEA EAX,[ESP + 0x10]
0055146a : PUSH EAX
0055146b : LEA ECX,[ESP + 0x30]
0055146f : ADD EDI,0x78
00551472 : LEA EBP,[EBX + 0x10]
00551475 : MOV byte ptr [ESP + 0x44],0x3
0055147a : CALL 0x00526210
0055147f : MOV EDX,dword ptr [EBP]
00551482 : MOV EDX,dword ptr [EDX + 0x28]
00551485 : LEA EAX,[ESP + 0x40]
00551489 : PUSH EAX
0055148a : MOV EAX,dword ptr [EDI]
0055148c : LEA ECX,[ESP + 0x30]
00551490 : PUSH ECX
00551491 : ADD EAX,0x138
00551496 : PUSH EAX
00551497 : PUSH EDI
00551498 : MOV ECX,EBP
0055149a : CALL EDX
0055149c : LEA ECX,[ESP + 0x2c]
005514a0 : CALL 0x00526bc0
005514a5 : MOV ECX,dword ptr [ESI + 0x4]
005514a8 : PUSH EBX
005514a9 : CALL 0x005271c0
005514ae : TEST byte ptr [ESP + 0x18],0x2
005514b3 : POP EBP
005514b4 : JNZ 0x005514c3
005514b6 : MOV ECX,dword ptr [ESP + 0xc]
005514ba : TEST ECX,ECX
005514bc : JZ 0x005514c3
005514be : CALL 0x00503db0
005514c3 : XOR ESI,ESI
005514c5 : TEST byte ptr [ESP + 0x14],0x1
005514ca : MOV dword ptr [ESP + 0xc],ESI
005514ce : JNZ 0x005514dd
005514d0 : MOV ECX,dword ptr [ESP + 0x10]
005514d4 : CMP ECX,ESI
005514d6 : JZ 0x005514dd
005514d8 : CALL 0x00503db0
005514dd : MOV dword ptr [ESP + 0x10],ESI
005514e1 : CMP EBX,ESI
005514e3 : JZ 0x005514ec
005514e5 : MOV ECX,EBX
005514e7 : CALL 0x00503db0
005514ec : POP EBX
005514ed : POP EDI
005514ee : POP ESI
005514ef : ADD ESP,0x2c
005514f2 : RET

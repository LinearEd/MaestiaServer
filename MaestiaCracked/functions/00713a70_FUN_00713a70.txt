PROGRAM  : Maestia.exe
FUNCTION : FUN_00713a70
ENTRY    : 00713a70
BODY     : [[00713a70, 00713c40]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00713a70(void)

{
  byte *pbVar1;
  undefined4 uVar2;
  uint uVar3;
  int unaff_ESI;
  undefined1 local_74 [4];
  undefined2 local_70;
  undefined4 local_60;
  uint local_5c;
  LPCRITICAL_SECTION local_58;
  char *local_54;
  undefined4 local_50;
  int local_4c;
  undefined4 local_48;
  undefined **local_44;
  undefined1 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  FILE *local_34;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3b78e;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  uVar2 = FUN_0070a3a0(local_14);
  *(undefined4 *)(unaff_ESI + 0x58) = uVar2;
  *(undefined1 *)(unaff_ESI + 0xd4) = 1;
  FUN_00a5d9f0(*(undefined4 *)(unaff_ESI + 4),local_30);
  local_40 = 0;
  local_3c = 0;
  local_38 = 0;
  local_44 = &PTR_FUN_00cda538;
  local_34 = (FILE *)0x0;
  local_8._0_1_ = 1;
  local_8._1_3_ = 0;
  local_58 = (LPCRITICAL_SECTION)(*(int *)(unaff_ESI + 4) + 0xad8);
  local_4c = 0;
  local_54 = ".\\MoVDFile.cpp";
  local_50 = 500;
  local_48 = 1;
  FUN_006ef1a0(&local_58);
  local_8._0_1_ = 2;
  local_5c = 7;
  local_60 = 0;
  local_70 = 0;
  FUN_00406360(&PTR_LAB_00c00df0,2);
  local_8._0_1_ = 3;
  FUN_0070a9a0(local_30,local_74);
  local_8 = CONCAT31(local_8._1_3_,2);
  if (7 < local_5c) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_70 = 0;
  local_5c = 7;
  local_60 = 0;
  if (local_34 != (FILE *)0x0) {
    __fseek_nolock(local_34,*(long *)(unaff_ESI + 0x5c),0);
  }
  if ((local_34 != (FILE *)0x0) &&
     (__fread_nolock(*(void **)(unaff_ESI + 0x58),*(size_t *)(unaff_ESI + 0x60),1,local_34),
     local_34 != (FILE *)0x0)) {
    _fflush(local_34);
    _fclose(local_34);
    local_34 = (FILE *)0x0;
  }
  uVar3 = 0;
  if (*(int *)(unaff_ESI + 0x60) != 0) {
    do {
      pbVar1 = (byte *)(*(int *)(unaff_ESI + 0x58) + uVar3);
      *pbVar1 = *pbVar1 ^ *(byte *)(unaff_ESI + 0x46);
      uVar3 = uVar3 + 1;
    } while (uVar3 < *(uint *)(unaff_ESI + 0x60));
  }
  local_8._0_1_ = 1;
  if (local_4c != 0) {
    LeaveCriticalSection(local_58);
    local_4c = 0;
  }
  local_8 = (uint)local_8._1_3_ << 8;
  local_44 = &PTR_FUN_00cda538;
  if (local_34 != (FILE *)0x0) {
    _fflush(local_34);
    _fclose(local_34);
    local_34 = (FILE *)0x0;
  }
  local_8 = 0xffffffff;
  if (local_18 < 8) {
    local_18 = 7;
    local_1c = 0;
    local_2c = 0;
    ExceptionList = local_10;
    __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
    return;
  }
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
00713a70 : PUSH EBP
00713a71 : MOV EBP,ESP
00713a73 : PUSH -0x1
00713a75 : PUSH 0xb3b78e
00713a7a : MOV EAX,FS:[0x0]
00713a80 : PUSH EAX
00713a81 : SUB ESP,0x64
00713a84 : MOV EAX,[0x00d66fa0]
00713a89 : XOR EAX,EBP
00713a8b : MOV dword ptr [EBP + -0x10],EAX
00713a8e : PUSH EBX
00713a8f : PUSH EDI
00713a90 : PUSH EAX
00713a91 : LEA EAX,[EBP + -0xc]
00713a94 : MOV FS:[0x0],EAX
00713a9a : MOV ECX,dword ptr [ESI + 0x60]
00713a9d : CALL 0x0070a3a0
00713aa2 : MOV ECX,dword ptr [ESI + 0x4]
00713aa5 : MOV dword ptr [ESI + 0x58],EAX
00713aa8 : LEA EAX,[EBP + -0x2c]
00713aab : PUSH EAX
00713aac : PUSH ECX
00713aad : MOV byte ptr [ESI + 0xd4],0x1
00713ab4 : CALL 0x00a5d9f0
00713ab9 : XOR EBX,EBX
00713abb : MOV dword ptr [EBP + -0x4],EBX
00713abe : MOV dword ptr [EBP + -0x40],0xcd4c80
00713ac5 : MOV byte ptr [EBP + -0x3c],BL
00713ac8 : MOV dword ptr [EBP + -0x38],EBX
00713acb : MOV dword ptr [EBP + -0x34],EBX
00713ace : MOV dword ptr [EBP + -0x40],0xcda538
00713ad5 : MOV dword ptr [EBP + -0x30],EBX
00713ad8 : MOV byte ptr [EBP + -0x4],0x1
00713adc : MOV EAX,dword ptr [ESI + 0x4]
00713adf : LEA EDX,[EBP + -0x54]
00713ae2 : ADD EAX,0xad8
00713ae7 : PUSH EDX
00713ae8 : MOV dword ptr [EBP + -0x48],EBX
00713aeb : MOV dword ptr [EBP + -0x54],EAX
00713aee : MOV dword ptr [EBP + -0x50],0xc00de0
00713af5 : MOV dword ptr [EBP + -0x4c],0x1f4
00713afc : MOV dword ptr [EBP + -0x44],0x1
00713b03 : CALL 0x006ef1a0
00713b08 : MOV byte ptr [EBP + -0x4],0x2
00713b0c : PUSH 0x2
00713b0e : XOR EAX,EAX
00713b10 : MOV EDI,0x7
00713b15 : PUSH 0xc00df0
00713b1a : LEA ECX,[EBP + -0x70]
00713b1d : MOV dword ptr [EBP + -0x58],EDI
00713b20 : MOV dword ptr [EBP + -0x5c],EBX
00713b23 : MOV word ptr [EBP + -0x6c],AX
00713b27 : CALL 0x00406360
00713b2c : MOV byte ptr [EBP + -0x4],0x3
00713b30 : LEA ECX,[EBP + -0x70]
00713b33 : PUSH ECX
00713b34 : LEA EDX,[EBP + -0x2c]
00713b37 : PUSH EDX
00713b38 : LEA ECX,[EBP + -0x40]
00713b3b : CALL 0x0070a9a0
00713b40 : MOV byte ptr [EBP + -0x4],0x2
00713b44 : CMP dword ptr [EBP + -0x58],0x8
00713b48 : JC 0x00713b52
00713b4a : MOV ECX,dword ptr [EBP + -0x6c]
00713b4d : CALL 0x006f04e0
00713b52 : MOV ECX,dword ptr [ESI + 0x5c]
00713b55 : XOR EAX,EAX
00713b57 : MOV word ptr [EBP + -0x6c],AX
00713b5b : MOV EAX,dword ptr [EBP + -0x30]
00713b5e : MOV dword ptr [EBP + -0x58],EDI
00713b61 : MOV dword ptr [EBP + -0x5c],EBX
00713b64 : CMP EAX,EBX
00713b66 : JZ 0x00713b76
00713b68 : PUSH EBX
00713b69 : PUSH ECX
00713b6a : PUSH EAX
00713b6b : CALL 0x00637771
00713b70 : MOV EAX,dword ptr [EBP + -0x30]
00713b73 : ADD ESP,0xc
00713b76 : MOV ECX,dword ptr [ESI + 0x60]
00713b79 : MOV EDX,dword ptr [ESI + 0x58]
00713b7c : CMP EAX,EBX
00713b7e : JZ 0x00713ba9
00713b80 : PUSH EAX
00713b81 : PUSH 0x1
00713b83 : PUSH ECX
00713b84 : PUSH EDX
00713b85 : CALL 0x00638ac8
00713b8a : MOV EAX,dword ptr [EBP + -0x30]
00713b8d : ADD ESP,0x10
00713b90 : CMP EAX,EBX
00713b92 : JZ 0x00713ba9
00713b94 : PUSH EAX
00713b95 : CALL 0x006395f7
00713b9a : MOV ECX,dword ptr [EBP + -0x30]
00713b9d : PUSH ECX
00713b9e : CALL 0x006366db
00713ba3 : ADD ESP,0x8
00713ba6 : MOV dword ptr [EBP + -0x30],EBX
00713ba9 : XOR EAX,EAX
00713bab : CMP dword ptr [ESI + 0x60],EBX
00713bae : JBE 0x00713bc7
00713bb0 : MOV EDX,dword ptr [ESI + 0x58]
00713bb3 : MOV CL,byte ptr [ESI + 0x46]
00713bb6 : XOR byte ptr [EDX + EAX*0x1],CL
00713bb9 : LEA EDI,[EDX + EAX*0x1]
00713bbc : INC EAX
00713bbd : CMP EAX,dword ptr [ESI + 0x60]
00713bc0 : JC 0x00713bb0
00713bc2 : MOV EDI,0x7
00713bc7 : MOV byte ptr [EBP + -0x4],0x1
00713bcb : CMP dword ptr [EBP + -0x48],EBX
00713bce : JZ 0x00713bdd
00713bd0 : MOV EDX,dword ptr [EBP + -0x54]
00713bd3 : PUSH EDX
00713bd4 : CALL dword ptr [0x00b8511c]
00713bda : MOV dword ptr [EBP + -0x48],EBX
00713bdd : MOV byte ptr [EBP + -0x4],BL
00713be0 : MOV EAX,dword ptr [EBP + -0x30]
00713be3 : MOV dword ptr [EBP + -0x40],0xcda538
00713bea : CMP EAX,EBX
00713bec : JZ 0x00713c03
00713bee : PUSH EAX
00713bef : CALL 0x006395f7
00713bf4 : MOV EAX,dword ptr [EBP + -0x30]
00713bf7 : PUSH EAX
00713bf8 : CALL 0x006366db
00713bfd : ADD ESP,0x8
00713c00 : MOV dword ptr [EBP + -0x30],EBX
00713c03 : MOV dword ptr [EBP + -0x4],0xffffffff
00713c0a : CMP dword ptr [EBP + -0x14],0x8
00713c0e : JC 0x00713c18
00713c10 : MOV ECX,dword ptr [EBP + -0x28]
00713c13 : CALL 0x006f04e0
00713c18 : XOR ECX,ECX
00713c1a : MOV dword ptr [EBP + -0x14],EDI
00713c1d : MOV dword ptr [EBP + -0x18],EBX
00713c20 : MOV word ptr [EBP + -0x28],CX
00713c24 : MOV AL,0x1
00713c26 : MOV ECX,dword ptr [EBP + -0xc]
00713c29 : MOV dword ptr FS:[0x0],ECX
00713c30 : POP ECX
00713c31 : POP EDI
00713c32 : POP EBX
00713c33 : MOV ECX,dword ptr [EBP + -0x10]
00713c36 : XOR ECX,EBP
00713c38 : CALL 0x00633e6b
00713c3d : MOV ESP,EBP
00713c3f : POP EBP
00713c40 : RET

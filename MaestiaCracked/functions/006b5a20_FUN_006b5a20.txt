PROGRAM  : Maestia.exe
FUNCTION : FUN_006b5a20
ENTRY    : 006b5a20
BODY     : [[006b5a20, 006b5b3e]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_006b5a20(uint *param_1,uint *param_2,int *param_3)

{
  ushort uVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  ushort *in_EDX;
  int *unaff_EBX;
  int *piVar5;
  int *piVar6;
  int local_24 [2];
  ushort local_1c;
  
  iVar4 = 9;
  piVar6 = local_24;
  if ((*(byte *)(unaff_EBX + 0x5c) & 1) == 0) {
    uVar1 = *(ushort *)(unaff_EBX + 0x48);
    piVar5 = unaff_EBX + 0x12;
  }
  else {
    uVar1 = *(ushort *)((int)unaff_EBX + 0x11e);
    piVar5 = unaff_EBX + 9;
  }
  for (; iVar4 != 0; iVar4 = iVar4 + -1) {
    *piVar6 = *piVar5;
    piVar5 = piVar5 + 1;
    piVar6 = piVar6 + 1;
  }
  if (local_1c <= uVar1) {
    if (*(char *)((int)unaff_EBX + 0x231) != '\0') {
      unaff_EBX[3] = 0x86;
    }
    *in_EDX = 0;
    return 1;
  }
  piVar6 = local_24;
  for (iVar4 = 9; iVar4 != 0; iVar4 = iVar4 + -1) {
    *param_3 = *piVar6;
    piVar6 = piVar6 + 1;
    param_3 = param_3 + 1;
  }
  *in_EDX = uVar1;
  uVar2 = (*(code *)unaff_EBX[0x8f])();
  if (*(char *)(*unaff_EBX + 0x2b4) != '\0') {
    if (*(char *)((int)unaff_EBX + 0x12e) != '\0') {
      *param_1 = uVar2;
      *param_2 = 0;
      return uVar2 & 0xffffff00;
    }
    *param_1 = 0;
    *param_2 = uVar2;
    return (uint)param_1 & 0xffffff00;
  }
  uVar3 = FUN_00685d60(uVar2,(int)*(short *)((int)unaff_EBX + 0x12a) << 0x10,unaff_EBX[0x8d]);
  *param_1 = uVar3;
  uVar2 = FUN_00685d60(uVar2,(int)(short)unaff_EBX[0x4b] << 0x10,unaff_EBX[0x8d]);
  *param_2 = uVar2;
  return uVar2 & 0xffffff00;
}



============================================================
DISASSEMBLY
============================================================
006b5a20 : SUB ESP,0x24
006b5a23 : TEST byte ptr [EBX + 0x170],0x1
006b5a2a : PUSH EBP
006b5a2b : MOV EBP,dword ptr [ESP + 0x30]
006b5a2f : PUSH ESI
006b5a30 : PUSH EDI
006b5a31 : MOV ECX,0x9
006b5a36 : LEA EDI,[ESP + 0xc]
006b5a3a : JZ 0x006b5a48
006b5a3c : MOVZX EAX,word ptr [EBX + 0x11e]
006b5a43 : LEA ESI,[EBX + 0x24]
006b5a46 : JMP 0x006b5a52
006b5a48 : MOVZX EAX,word ptr [EBX + 0x120]
006b5a4f : LEA ESI,[EBX + 0x48]
006b5a52 : MOVSD.REP ES:EDI,ESI
006b5a54 : CMP AX,word ptr [ESP + 0x14]
006b5a59 : JC 0x006b5a79
006b5a5b : CMP byte ptr [EBX + 0x231],0x0
006b5a62 : JZ 0x006b5a6b
006b5a64 : MOV dword ptr [EBX + 0xc],0x86
006b5a6b : POP EDI
006b5a6c : XOR EAX,EAX
006b5a6e : POP ESI
006b5a6f : MOV word ptr [EDX],AX
006b5a72 : MOV AL,0x1
006b5a74 : POP EBP
006b5a75 : ADD ESP,0x24
006b5a78 : RET
006b5a79 : MOV EDI,dword ptr [ESP + 0x3c]
006b5a7d : MOV ECX,0x9
006b5a82 : LEA ESI,[ESP + 0xc]
006b5a86 : MOVSD.REP ES:EDI,ESI
006b5a88 : MOV ECX,dword ptr [ESP + 0x18]
006b5a8c : MOV word ptr [EDX],AX
006b5a8f : MOV EDX,dword ptr [ESP + 0x1c]
006b5a93 : MOVZX EAX,AX
006b5a96 : ADD EAX,EAX
006b5a98 : ADD EAX,EAX
006b5a9a : ADD EAX,EAX
006b5a9c : MOV ESI,dword ptr [EAX + EDX*0x1 + 0x4]
006b5aa0 : SUB ESI,dword ptr [EAX + ECX*0x1 + 0x4]
006b5aa4 : MOV EDX,dword ptr [EAX + EDX*0x1]
006b5aa7 : SUB EDX,dword ptr [EAX + ECX*0x1]
006b5aaa : MOV EAX,dword ptr [EBX + 0x23c]
006b5ab0 : PUSH ESI
006b5ab1 : PUSH EDX
006b5ab2 : PUSH EBX
006b5ab3 : CALL EAX
006b5ab5 : MOV ECX,dword ptr [EBX]
006b5ab7 : ADD ESP,0xc
006b5aba : CMP byte ptr [ECX + 0x2b4],0x0
006b5ac1 : MOV ESI,EAX
006b5ac3 : JZ 0x006b5afa
006b5ac5 : CMP byte ptr [EBX + 0x12e],0x0
006b5acc : JZ 0x006b5ae4
006b5ace : MOV EDX,dword ptr [ESP + 0x34]
006b5ad2 : POP EDI
006b5ad3 : MOV dword ptr [EDX],ESI
006b5ad5 : POP ESI
006b5ad6 : MOV dword ptr [EBP],0x0
006b5add : XOR AL,AL
006b5adf : POP EBP
006b5ae0 : ADD ESP,0x24
006b5ae3 : RET
006b5ae4 : MOV EAX,dword ptr [ESP + 0x34]
006b5ae8 : MOV dword ptr [EAX],0x0
006b5aee : POP EDI
006b5aef : MOV dword ptr [EBP],ESI
006b5af2 : POP ESI
006b5af3 : XOR AL,AL
006b5af5 : POP EBP
006b5af6 : ADD ESP,0x24
006b5af9 : RET
006b5afa : MOVSX EDX,word ptr [EBX + 0x12a]
006b5b01 : MOV ECX,dword ptr [EBX + 0x234]
006b5b07 : PUSH ECX
006b5b08 : SHL EDX,0x10
006b5b0b : PUSH EDX
006b5b0c : PUSH ESI
006b5b0d : CALL 0x00685d60
006b5b12 : MOV ECX,dword ptr [ESP + 0x40]
006b5b16 : MOV dword ptr [ECX],EAX
006b5b18 : MOVSX EAX,word ptr [EBX + 0x12c]
006b5b1f : MOV EDX,dword ptr [EBX + 0x234]
006b5b25 : PUSH EDX
006b5b26 : SHL EAX,0x10
006b5b29 : PUSH EAX
006b5b2a : PUSH ESI
006b5b2b : CALL 0x00685d60
006b5b30 : ADD ESP,0x18
006b5b33 : POP EDI
006b5b34 : MOV dword ptr [EBP],EAX
006b5b37 : POP ESI
006b5b38 : XOR AL,AL
006b5b3a : POP EBP
006b5b3b : ADD ESP,0x24
006b5b3e : RET

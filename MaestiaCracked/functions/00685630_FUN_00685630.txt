PROGRAM  : Maestia.exe
FUNCTION : FUN_00685630
ENTRY    : 00685630
BODY     : [[00685630, 00685b48]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00685630(int param_1,int *param_2)

{
  uint uVar1;
  int **ppiVar2;
  int iVar3;
  uint *puVar4;
  GRefCountImpl *this;
  int **ppiVar5;
  int iVar6;
  GRefCountNTSImpl *this_00;
  undefined4 uVar7;
  int **ppiVar8;
  int **ppiVar9;
  int *piVar10;
  int **unaff_ESI;
  int *unaff_EDI;
  int **ppiVar11;
  int *piVar12;
  int *piVar13;
  int **ppiVar14;
  int **ppiStack_ac;
  int *piStack_a8;
  int **ppiStack_a4;
  int **ppiStack_a0;
  int *piStack_9c;
  int **ppiStack_98;
  int *piStack_94;
  int **ppiStack_90;
  int *piStack_8c;
  int **ppiStack_88;
  int **ppiStack_84;
  int *piStack_80;
  int *piStack_7c;
  int *piStack_78;
  int *piStack_74;
  int **ppiStack_70;
  int *piStack_5c;
  undefined4 local_58;
  undefined4 local_4c;
  int *apiStack_38 [3];
  int *local_2c [10];
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)&piStack_5c;
  piVar10 = (int *)0x0;
  local_4c = 0;
  local_58 = 0;
  iVar3 = *(int *)(*(int *)(param_1 + 4) + 0x5c);
  if ((iVar3 != 0x1000000) && (iVar3 != 0x2000000)) {
    piStack_78 = *(int **)(param_1 + 0x14);
    ppiStack_70 = local_2c;
    piStack_74 = (int *)&DAT_00bd8360;
    piStack_7c = (int *)0x685680;
    iVar3 = (**(code **)*piStack_78)();
    if (-1 < iVar3) {
      ppiStack_70 = &piStack_5c;
      piStack_74 = param_2;
      piStack_78 = local_2c[0];
      piStack_7c = (int *)0x68569e;
      (**(code **)(*local_2c[0] + 0x18))();
      piStack_7c = (int *)&stack0xffffff9c;
      piStack_80 = (int *)&DAT_00bd83d8;
      ppiStack_88 = (int **)0x6856b3;
      ppiStack_84 = unaff_ESI;
      iVar3 = (*(code *)**unaff_ESI)();
      if (-1 < iVar3) {
        ppiStack_88 = ppiStack_70;
        piStack_8c = (int *)0x6856c3;
        (*(code *)(*ppiStack_70)[2])();
      }
      ppiStack_88 = local_2c;
      piStack_8c = piStack_74;
      ppiStack_90 = (int **)0x6856d4;
      (**(code **)(*piStack_74 + 0x10))();
      ppiStack_90 = apiStack_38;
      piStack_94 = piStack_7c;
      ppiStack_98 = (int **)0x6856e5;
      (**(code **)(*piStack_7c + 0xc))();
      ppiStack_98 = &piStack_74;
      piStack_9c = (int *)&DAT_00bd83c8;
      ppiStack_a0 = ppiStack_84;
      ppiStack_a4 = (int **)0x6856fa;
      iVar3 = (*(code *)**ppiStack_84)();
      if (-1 < iVar3) {
        ppiStack_a4 = (int **)&stack0xffffff9c;
        piStack_a8 = piStack_80;
        ppiStack_ac = (int **)0x685713;
        (**(code **)(*piStack_80 + 0x24))();
        *(int **)(param_1 + 0x30) = param_2;
        if (unaff_EDI != (int *)0x0) {
          if (*(char *)(*(int *)(param_1 + 4) + 0x6c) == '\0') {
            FUN_0051bb60();
          }
          else {
            FUN_0051bb60();
            (**(code **)(**(int **)(param_1 + 4) + 0x50))();
          }
        }
        if (*(int *)(*(int *)(param_1 + 4) + 4) != 0) {
          ppiStack_ac = (int **)0x685756;
          iVar3 = FUN_0051b1a0();
          if (iVar3 != 0) {
            ppiStack_ac = (int **)0xbd83b8;
            puVar4 = (uint *)FUN_0051c6e0(&stack0xffffff9c);
            ppiStack_ac = (int **)&DAT_00cca874;
            FUN_00678eb0(*(undefined4 *)(*(int *)(param_1 + 4) + 4),(*puVar4 & 0xfffffffc) + 8);
            ppiStack_ac = (int **)0x685795;
            FUN_0045b730();
          }
        }
        if (*(char *)(param_1 + 0x39) == '\x01') {
          if (*(int *)(*(int *)(param_1 + 4) + 4) != 0) {
            ppiStack_ac = (int **)0x6857ab;
            iVar3 = FUN_0051b1a0();
            if (iVar3 != 0) {
              ppiStack_ac = (int **)0xbd7f7c;
              puVar4 = (uint *)FUN_0051c6e0(&piStack_5c);
              ppiStack_ac = (int **)&DAT_00cca874;
              FUN_00678eb0(*(undefined4 *)(*(int *)(param_1 + 4) + 4),(*puVar4 & 0xfffffffc) + 8);
              ppiStack_ac = (int **)0x6857ea;
              FUN_0045b730();
            }
          }
          *(undefined1 *)(param_1 + 0x3a) = 0;
        }
        *(undefined1 *)(param_1 + 0x39) = 1;
        ppiStack_ac = ppiStack_88;
        (*(code *)(*ppiStack_88)[2])();
      }
      ppiStack_a4 = &piStack_8c;
      piStack_a8 = (int *)&DAT_00bd83d8;
      ppiStack_ac = ppiStack_90;
      iVar3 = (*(code *)**ppiStack_90)();
      if (-1 < iVar3) {
        *(int **)(param_1 + 0x40) = param_2;
        *(undefined1 *)(param_1 + 0x39) = 0;
        if (*(char *)(param_1 + 0x3a) == '\0') {
          iVar3 = *(int *)(*(int *)(param_1 + 4) + 0x5c);
          uVar7 = 1;
          if (((iVar3 == 0xd00001) || (iVar3 == 5)) || (iVar3 == 6)) {
            uVar7 = 0;
          }
          iVar3 = FUN_0051b1a0();
          if (iVar3 != 0) {
            puVar4 = (uint *)FUN_0051c6e0(&piStack_5c,".CreateList");
            FUN_00678eb0(*(undefined4 *)(*(int *)(param_1 + 4) + 4),(*puVar4 & 0xfffffffc) + 8,
                         "%d %d",10,uVar7);
            FUN_0045b730();
            this = (GRefCountImpl *)
                   (**(code **)(*(int *)(*(int *)(*(int *)(param_1 + 4) + 4) + 8) + 0xc))(0x1b);
            *(undefined1 *)(param_1 + 0x3a) = 1;
            if (this != (GRefCountImpl *)0x0) {
              GRefCountImpl::Release(this);
            }
          }
        }
        (*(code *)(*ppiStack_98)[9])(ppiStack_98,&ppiStack_88);
        if (ppiStack_88 != (int **)0x0) {
          ppiVar14 = &piStack_94;
          piStack_7c = (int *)0x0;
          piStack_74 = (int *)0x0;
          piStack_94 = (int *)0x0;
          ppiStack_84 = (int **)0x0;
          *(int **)(param_1 + 0x2c) = param_2;
          piVar13 = (int *)0x0;
          piVar12 = piStack_9c;
          (**(code **)(*piStack_9c + 0x30))(piStack_9c,0,0);
          ppiVar2 = ppiStack_ac;
          ppiVar11 = &piStack_74;
          (*(code *)(*ppiStack_ac)[7])();
          if (((((uint)piStack_7c >> 2 & 1) == 0) && (((uint)piStack_7c >> 5 & 1) == 0)) ||
             (((uint)piStack_7c >> 3 & 1) != 0)) {
            *(undefined1 *)(param_1 + 0x38) = 1;
          }
          else {
            *(byte *)(param_1 + 0x38) = (byte)((uint)piStack_7c >> 3) & 1;
          }
          if (ppiStack_ac != (int **)0x0) {
            piVar10 = (int *)FUN_0045b5a0((int)ppiStack_ac * 4 + 4);
            (*(code *)(*ppiVar14)[0xc])(ppiVar14,piVar10,ppiStack_ac,&ppiStack_ac);
          }
          ppiVar8 = ppiStack_a0;
          if ((int **)0x1 < ppiStack_ac) {
            ppiVar8 = (int **)(piVar10[1] - *piVar10);
          }
          (*(code *)(*ppiVar14)[0xe])(ppiVar14,&piStack_94);
          (**(code **)(*piVar13 + 0x28))(piVar13,&piStack_94);
          piStack_a8 = (int *)piVar10[(int)ppiStack_a4];
          *(int **)(param_1 + 0x3c) = piStack_a8;
          uVar1 = *(uint *)(*(int *)(param_1 + 4) + 0x5c);
          if (((uVar1 & 0xf00) == 0) && ((uVar1 & 0xf) == 0)) {
            if (ppiStack_a4 == (int **)((int)piVar12 + -1)) {
              ppiVar9 = (int **)((int)ppiVar14 - (int)piStack_a8);
            }
            else {
              ppiVar9 = (int **)(piVar10[(int)((int)ppiStack_a4 + 1)] - piVar10[(int)ppiStack_a4]);
            }
          }
          else {
            ppiVar9 = ppiVar14;
            if ((ppiVar8 <= ppiVar14) &&
               (ppiVar5 = (int **)((int)((int)ppiStack_a4 + 1) * (int)ppiVar8), ppiVar9 = ppiVar8,
               ppiVar14 <= ppiVar5 && (int)ppiVar5 - (int)ppiVar14 != 0)) {
              ppiVar9 = (int **)((uint)ppiVar14 % (uint)ppiVar8);
            }
          }
          if ((uVar1 & 0xf00000) != 0) {
            piStack_a8 = (int *)0x0;
            ppiVar9 = ppiVar14;
          }
          if (piVar10 != (int *)0x0) {
            FUN_00515cf0(piVar10);
          }
          iVar3 = 0;
          FUN_00684a80();
          ppiStack_a0 = (int **)0x0;
          if (ppiVar9 != (int **)0x0) {
            do {
              (*(code *)(*ppiVar2)[0xb])
                        (ppiVar2,(undefined *)((int)ppiStack_a0 + (int)piStack_a8),&ppiStack_ac);
              if (ppiStack_ac == (int **)0x0) {
                iVar3 = iVar3 + 1;
              }
              else {
                iVar6 = FUN_0051aeb0(ppiStack_ac,0xffffffff);
                uVar7 = FUN_00515840(iVar6 + 1,0);
                FUN_0051af70(uVar7,ppiStack_ac,0xffffffff);
                iVar6 = FUN_00515840(0x10,0);
                if (iVar6 == 0) {
                  this_00 = (GRefCountNTSImpl *)0x0;
                }
                else {
                  this_00 = (GRefCountNTSImpl *)FUN_0067e7f0(uVar7);
                }
                if (this_00 != (GRefCountNTSImpl *)0x0) {
                  *(int *)(this_00 + 4) = *(int *)(this_00 + 4) + 1;
                }
                FUN_00684a30(this_00,0);
                FUN_00515cf0(uVar7);
                if (this_00 != (GRefCountNTSImpl *)0x0) {
                  GRefCountNTSImpl::Release(this_00);
                }
              }
              ppiStack_a0 = (int **)((int)ppiStack_a0 + 1);
            } while (ppiStack_a0 < ppiVar9);
          }
          *(int *)(param_1 + 0x34) = (int)ppiVar9 - iVar3;
          if (-1 < (int)piStack_9c) {
            FUN_006847b0((int)piStack_9c - (int)piStack_a8);
          }
          FUN_00684870();
          *(undefined1 *)(*(int *)(param_1 + 4) + 0x6d) = 1;
          (*(code *)(*ppiVar11)[2])(ppiVar11);
        }
      }
      (**(code **)(*unaff_EDI + 8))(unaff_EDI);
      (*(code *)(*ppiStack_a0)[2])(ppiStack_a0);
    }
  }
  __security_check_cookie(local_4 ^ (uint)&piStack_5c);
  return;
}



============================================================
DISASSEMBLY
============================================================
00685630 : SUB ESP,0x5c
00685633 : MOV EAX,[0x00d66fa0]
00685638 : XOR EAX,ESP
0068563a : MOV dword ptr [ESP + 0x58],EAX
0068563e : PUSH EBX
0068563f : PUSH EBP
00685640 : PUSH ESI
00685641 : MOV ESI,dword ptr [ESP + 0x6c]
00685645 : MOV EAX,dword ptr [ESI + 0x4]
00685648 : XOR EBP,EBP
0068564a : MOV dword ptr [ESP + 0x1c],EBP
0068564e : MOV dword ptr [ESP + 0x10],EBP
00685652 : MOV EAX,dword ptr [EAX + 0x5c]
00685655 : PUSH EDI
00685656 : CMP EAX,0x1000000
0068565b : JZ 0x00685b32
00685661 : CMP EAX,0x2000000
00685666 : JZ 0x00685b32
0068566c : MOV EAX,dword ptr [ESI + 0x14]
0068566f : MOV ECX,dword ptr [EAX]
00685671 : LEA EDX,[ESP + 0x40]
00685675 : PUSH EDX
00685676 : PUSH 0xbd8360
0068567b : PUSH EAX
0068567c : MOV EAX,dword ptr [ECX]
0068567e : CALL EAX
00685680 : TEST EAX,EAX
00685682 : JL 0x00685b32
00685688 : MOV EAX,dword ptr [ESP + 0x40]
0068568c : MOV EDI,dword ptr [ESP + 0x74]
00685690 : MOV ECX,dword ptr [EAX]
00685692 : LEA EDX,[ESP + 0x10]
00685696 : PUSH EDX
00685697 : PUSH EDI
00685698 : PUSH EAX
00685699 : MOV EAX,dword ptr [ECX + 0x18]
0068569c : CALL EAX
0068569e : MOV EAX,dword ptr [ESP + 0x10]
006856a2 : MOV ECX,dword ptr [EAX]
006856a4 : LEA EDX,[ESP + 0x14]
006856a8 : PUSH EDX
006856a9 : PUSH 0xbd83d8
006856ae : PUSH EAX
006856af : MOV EAX,dword ptr [ECX]
006856b1 : CALL EAX
006856b3 : TEST EAX,EAX
006856b5 : JL 0x006856c3
006856b7 : MOV EAX,dword ptr [ESP + 0x14]
006856bb : MOV ECX,dword ptr [EAX]
006856bd : MOV EDX,dword ptr [ECX + 0x8]
006856c0 : PUSH EAX
006856c1 : CALL EDX
006856c3 : MOV EAX,dword ptr [ESP + 0x10]
006856c7 : MOV ECX,dword ptr [EAX]
006856c9 : LEA EDX,[ESP + 0x58]
006856cd : PUSH EDX
006856ce : PUSH EAX
006856cf : MOV EAX,dword ptr [ECX + 0x10]
006856d2 : CALL EAX
006856d4 : MOV EAX,dword ptr [ESP + 0x10]
006856d8 : MOV ECX,dword ptr [EAX]
006856da : LEA EDX,[ESP + 0x54]
006856de : PUSH EDX
006856df : PUSH EAX
006856e0 : MOV EAX,dword ptr [ECX + 0xc]
006856e3 : CALL EAX
006856e5 : MOV EAX,dword ptr [ESP + 0x10]
006856e9 : MOV ECX,dword ptr [EAX]
006856eb : LEA EDX,[ESP + 0x20]
006856ef : PUSH EDX
006856f0 : PUSH 0xbd83c8
006856f5 : PUSH EAX
006856f6 : MOV EAX,dword ptr [ECX]
006856f8 : CALL EAX
006856fa : TEST EAX,EAX
006856fc : JL 0x006857fe
00685702 : MOV EAX,dword ptr [ESP + 0x20]
00685706 : MOV ECX,dword ptr [EAX]
00685708 : LEA EDX,[ESP + 0x3c]
0068570c : PUSH EDX
0068570d : PUSH EAX
0068570e : MOV EAX,dword ptr [ECX + 0x24]
00685711 : CALL EAX
00685713 : MOV ECX,dword ptr [ESP + 0x3c]
00685717 : MOV dword ptr [ESI + 0x30],EDI
0068571a : CMP ECX,EBP
0068571c : JZ 0x00685746
0068571e : MOV EAX,dword ptr [ESI + 0x4]
00685721 : CMP byte ptr [EAX + 0x6c],0x0
00685725 : PUSH ECX
00685726 : LEA ECX,[EAX + 0x68]
00685729 : JNZ 0x00685732
0068572b : CALL 0x0051bb60
00685730 : JMP 0x00685746
00685732 : CALL 0x0051bb60
00685737 : MOV ECX,dword ptr [ESI + 0x4]
0068573a : MOV EDX,dword ptr [ECX]
0068573c : MOV EAX,dword ptr [ESP + 0x3c]
00685740 : MOV EDX,dword ptr [EDX + 0x50]
00685743 : PUSH EAX
00685744 : CALL EDX
00685746 : MOV EAX,dword ptr [ESI + 0x4]
00685749 : CMP dword ptr [EAX + 0x4],EBP
0068574c : JZ 0x00685795
0068574e : LEA ECX,[EAX + 0x8]
00685751 : CALL 0x0051b1a0
00685756 : TEST EAX,EAX
00685758 : JBE 0x00685795
0068575a : MOV ECX,dword ptr [ESI + 0x4]
0068575d : PUSH 0xbd83b8
00685762 : LEA EAX,[ESP + 0x48]
00685766 : PUSH EAX
00685767 : ADD ECX,0x8
0068576a : CALL 0x0051c6e0
0068576f : MOV EAX,dword ptr [EAX]
00685771 : MOV ECX,dword ptr [ESI + 0x4]
00685774 : MOV EDX,dword ptr [ECX + 0x4]
00685777 : AND EAX,0xfffffffc
0068577a : PUSH 0xcca874
0068577f : ADD EAX,0x8
00685782 : PUSH EAX
00685783 : PUSH EDX
00685784 : CALL 0x00678eb0
00685789 : ADD ESP,0xc
0068578c : LEA ECX,[ESP + 0x44]
00685790 : CALL 0x0045b730
00685795 : CMP byte ptr [ESI + 0x39],0x1
00685799 : JNZ 0x006857ee
0068579b : MOV EAX,dword ptr [ESI + 0x4]
0068579e : CMP dword ptr [EAX + 0x4],EBP
006857a1 : JZ 0x006857ea
006857a3 : LEA ECX,[EAX + 0x8]
006857a6 : CALL 0x0051b1a0
006857ab : TEST EAX,EAX
006857ad : JBE 0x006857ea
006857af : MOV ECX,dword ptr [ESI + 0x4]
006857b2 : PUSH 0xbd7f7c
006857b7 : LEA EAX,[ESP + 0x50]
006857bb : PUSH EAX
006857bc : ADD ECX,0x8
006857bf : CALL 0x0051c6e0
006857c4 : MOV EAX,dword ptr [EAX]
006857c6 : MOV ECX,dword ptr [ESI + 0x4]
006857c9 : MOV EDX,dword ptr [ECX + 0x4]
006857cc : AND EAX,0xfffffffc
006857cf : PUSH 0xcca874
006857d4 : ADD EAX,0x8
006857d7 : PUSH EAX
006857d8 : PUSH EDX
006857d9 : CALL 0x00678eb0
006857de : ADD ESP,0xc
006857e1 : LEA ECX,[ESP + 0x4c]
006857e5 : CALL 0x0045b730
006857ea : MOV byte ptr [ESI + 0x3a],0x0
006857ee : MOV EAX,dword ptr [ESP + 0x20]
006857f2 : MOV byte ptr [ESI + 0x39],0x1
006857f6 : MOV ECX,dword ptr [EAX]
006857f8 : MOV EDX,dword ptr [ECX + 0x8]
006857fb : PUSH EAX
006857fc : CALL EDX
006857fe : MOV EAX,dword ptr [ESP + 0x10]
00685802 : MOV ECX,dword ptr [EAX]
00685804 : LEA EDX,[ESP + 0x14]
00685808 : PUSH EDX
00685809 : PUSH 0xbd83d8
0068580e : PUSH EAX
0068580f : MOV EAX,dword ptr [ECX]
00685811 : CALL EAX
00685813 : TEST EAX,EAX
00685815 : JL 0x00685b1a
0068581b : CMP byte ptr [ESI + 0x3a],0x0
0068581f : MOV dword ptr [ESI + 0x40],EDI
00685822 : MOV byte ptr [ESI + 0x39],0x0
00685826 : JNZ 0x006858b6
0068582c : MOV ECX,dword ptr [ESI + 0x4]
0068582f : MOV EAX,dword ptr [ECX + 0x5c]
00685832 : MOV EBX,0x1
00685837 : CMP EAX,0xd00001
0068583c : JZ 0x00685848
0068583e : CMP EAX,0x5
00685841 : JZ 0x00685848
00685843 : CMP EAX,0x6
00685846 : JNZ 0x0068584a
00685848 : XOR EBX,EBX
0068584a : ADD ECX,0x8
0068584d : CALL 0x0051b1a0
00685852 : TEST EAX,EAX
00685854 : JBE 0x006858b6
00685856 : PUSH 0xbd7fcc
0068585b : LEA ECX,[ESP + 0x54]
0068585f : PUSH ECX
00685860 : MOV ECX,dword ptr [ESI + 0x4]
00685863 : ADD ECX,0x8
00685866 : CALL 0x0051c6e0
0068586b : MOV EAX,dword ptr [EAX]
0068586d : MOV EDX,dword ptr [ESI + 0x4]
00685870 : PUSH EBX
00685871 : AND EAX,0xfffffffc
00685874 : PUSH 0xa
00685876 : ADD EAX,0x8
00685879 : PUSH 0xbd6554
0068587e : PUSH EAX
0068587f : MOV EAX,dword ptr [EDX + 0x4]
00685882 : PUSH EAX
00685883 : CALL 0x00678eb0
00685888 : ADD ESP,0x14
0068588b : LEA ECX,[ESP + 0x50]
0068588f : CALL 0x0045b730
00685894 : MOV ECX,dword ptr [ESI + 0x4]
00685897 : MOV ECX,dword ptr [ECX + 0x4]
0068589a : MOV EDX,dword ptr [ECX + 0x8]
0068589d : MOV EAX,dword ptr [EDX + 0xc]
006858a0 : ADD ECX,0x8
006858a3 : PUSH 0x1b
006858a5 : CALL EAX
006858a7 : MOV byte ptr [ESI + 0x3a],0x1
006858ab : CMP EAX,EBP
006858ad : JZ 0x006858b6
006858af : MOV ECX,EAX
006858b1 : CALL 0x004ff7e0
006858b6 : MOV EAX,dword ptr [ESP + 0x14]
006858ba : MOV ECX,dword ptr [EAX]
006858bc : LEA EDX,[ESP + 0x24]
006858c0 : PUSH EDX
006858c1 : PUSH EAX
006858c2 : MOV EAX,dword ptr [ECX + 0x24]
006858c5 : CALL EAX
006858c7 : CMP dword ptr [ESP + 0x24],EBP
006858cb : JZ 0x00685b1a
006858d1 : MOV EAX,dword ptr [ESP + 0x10]
006858d5 : LEA EDX,[ESP + 0x18]
006858d9 : PUSH EDX
006858da : PUSH EBP
006858db : MOV dword ptr [ESP + 0x38],EBP
006858df : MOV dword ptr [ESP + 0x40],EBP
006858e3 : MOV dword ptr [ESP + 0x20],EBP
006858e7 : MOV dword ptr [ESP + 0x30],EBP
006858eb : MOV dword ptr [ESI + 0x2c],EDI
006858ee : MOV ECX,dword ptr [EAX]
006858f0 : PUSH EBP
006858f1 : PUSH EAX
006858f2 : MOV EAX,dword ptr [ECX + 0x30]
006858f5 : CALL EAX
006858f7 : MOV EAX,dword ptr [ESP + 0x10]
006858fb : MOV ECX,dword ptr [EAX]
006858fd : LEA EDX,[ESP + 0x48]
00685901 : PUSH EDX
00685902 : PUSH EAX
00685903 : MOV EAX,dword ptr [ECX + 0x1c]
00685906 : CALL EAX
00685908 : MOV ECX,dword ptr [ESP + 0x48]
0068590c : MOV EAX,ECX
0068590e : MOV EDX,ECX
00685910 : SHR EAX,0x2
00685913 : SHR EDX,0x3
00685916 : SHR ECX,0x5
00685919 : AND AL,0x1
0068591b : AND DL,0x1
0068591e : AND CL,0x1
00685921 : TEST AL,AL
00685923 : JNZ 0x00685929
00685925 : TEST CL,CL
00685927 : JZ 0x00685932
00685929 : TEST DL,DL
0068592b : JNZ 0x00685932
0068592d : MOV byte ptr [ESI + 0x38],DL
00685930 : JMP 0x00685936
00685932 : MOV byte ptr [ESI + 0x38],0x1
00685936 : MOV EAX,dword ptr [ESP + 0x18]
0068593a : CMP EAX,EBP
0068593c : JZ 0x00685968
0068593e : LEA ECX,[EAX*0x4 + 0x4]
00685945 : PUSH ECX
00685946 : CALL 0x0045b5a0
0068594b : LEA ECX,[ESP + 0x18]
0068594f : PUSH ECX
00685950 : MOV ECX,dword ptr [ESP + 0x1c]
00685954 : MOV EBP,EAX
00685956 : MOV EAX,dword ptr [ESP + 0x18]
0068595a : MOV EDX,dword ptr [EAX]
0068595c : MOV EDX,dword ptr [EDX + 0x30]
0068595f : PUSH ECX
00685960 : PUSH EBP
00685961 : PUSH EAX
00685962 : CALL EDX
00685964 : MOV EAX,dword ptr [ESP + 0x18]
00685968 : CMP EAX,0x1
0068596b : JBE 0x00685975
0068596d : MOV EBX,dword ptr [EBP + 0x4]
00685970 : SUB EBX,dword ptr [EBP]
00685973 : JMP 0x00685979
00685975 : MOV EBX,dword ptr [ESP + 0x24]
00685979 : MOV EAX,dword ptr [ESP + 0x14]
0068597d : MOV ECX,dword ptr [EAX]
0068597f : LEA EDX,[ESP + 0x30]
00685983 : PUSH EDX
00685984 : PUSH EAX
00685985 : MOV EAX,dword ptr [ECX + 0x38]
00685988 : CALL EAX
0068598a : MOV EAX,dword ptr [ESP + 0x14]
0068598e : MOV ECX,dword ptr [EAX]
00685990 : LEA EDX,[ESP + 0x38]
00685994 : PUSH EDX
00685995 : PUSH EAX
00685996 : MOV EAX,dword ptr [ECX + 0x28]
00685999 : CALL EAX
0068599b : MOV EAX,dword ptr [ESP + 0x30]
0068599f : MOV EDX,dword ptr [EBP + EAX*0x4]
006859a3 : MOV ECX,dword ptr [ESI + 0x4]
006859a6 : MOV EDI,dword ptr [ESP + 0x24]
006859aa : MOV dword ptr [ESI + 0x3c],EDX
006859ad : MOV ECX,dword ptr [ECX + 0x5c]
006859b0 : MOV dword ptr [ESP + 0x2c],EDX
006859b4 : MOV dword ptr [ESP + 0x1c],ECX
006859b8 : TEST ECX,0xf00
006859be : JNZ 0x006859de
006859c0 : TEST CL,0xf
006859c3 : JNZ 0x006859de
006859c5 : MOV ECX,dword ptr [ESP + 0x18]
006859c9 : DEC ECX
006859ca : CMP EAX,ECX
006859cc : JNZ 0x006859d4
006859ce : MOV EBX,EDI
006859d0 : SUB EBX,EDX
006859d2 : JMP 0x006859f6
006859d4 : MOV EBX,dword ptr [EBP + EAX*0x4 + 0x4]
006859d8 : SUB EBX,dword ptr [EBP + EAX*0x4]
006859dc : JMP 0x006859f6
006859de : CMP EDI,EBX
006859e0 : JNC 0x006859e6
006859e2 : MOV EBX,EDI
006859e4 : JMP 0x006859f6
006859e6 : INC EAX
006859e7 : IMUL EAX,EBX
006859ea : CMP EAX,EDI
006859ec : JBE 0x006859f6
006859ee : MOV EAX,EDI
006859f0 : XOR EDX,EDX
006859f2 : DIV EBX
006859f4 : MOV EBX,EDX
006859f6 : TEST dword ptr [ESP + 0x1c],0xf00000
006859fe : JZ 0x00685a0a
00685a00 : MOV EBX,EDI
00685a02 : MOV dword ptr [ESP + 0x2c],0x0
00685a0a : TEST EBP,EBP
00685a0c : JZ 0x00685a14
00685a0e : PUSH EBP
00685a0f : CALL 0x00515cf0
00685a14 : MOV EDX,dword ptr [ESI + 0x4]
00685a17 : MOV ECX,dword ptr [EDX + 0x18]
00685a1a : MOV dword ptr [ESP + 0x1c],0x0
00685a22 : CALL 0x00684a80
00685a27 : XOR ECX,ECX
00685a29 : MOV dword ptr [ESP + 0x34],ECX
00685a2d : TEST EBX,EBX
00685a2f : JBE 0x00685add
00685a35 : MOV EAX,dword ptr [ESP + 0x10]
00685a39 : MOV EDX,dword ptr [EAX]
00685a3b : LEA EDI,[ESP + 0x28]
00685a3f : PUSH EDI
00685a40 : MOV EDI,dword ptr [ESP + 0x30]
00685a44 : ADD ECX,EDI
00685a46 : PUSH ECX
00685a47 : PUSH EAX
00685a48 : MOV EAX,dword ptr [EDX + 0x2c]
00685a4b : CALL EAX
00685a4d : MOV EAX,dword ptr [ESP + 0x28]
00685a51 : TEST EAX,EAX
00685a53 : JZ 0x00685ac8
00685a55 : PUSH -0x1
00685a57 : PUSH EAX
00685a58 : CALL 0x0051aeb0
00685a5d : MOV ECX,dword ptr [0x00d73250]
00685a63 : PUSH 0x0
00685a65 : INC EAX
00685a66 : PUSH EAX
00685a67 : CALL 0x00515840
00685a6c : MOV ECX,dword ptr [ESP + 0x28]
00685a70 : PUSH -0x1
00685a72 : MOV EBP,EAX
00685a74 : PUSH ECX
00685a75 : PUSH EBP
00685a76 : CALL 0x0051af70
00685a7b : MOV ECX,dword ptr [0x00d73250]
00685a81 : PUSH 0x0
00685a83 : PUSH 0x10
00685a85 : CALL 0x00515840
00685a8a : TEST EAX,EAX
00685a8c : JZ 0x00685a9a
00685a8e : PUSH EBP
00685a8f : MOV ECX,EAX
00685a91 : CALL 0x0067e7f0
00685a96 : MOV EDI,EAX
00685a98 : JMP 0x00685a9c
00685a9a : XOR EDI,EDI
00685a9c : PUSH 0x0
00685a9e : PUSH ECX
00685a9f : MOV EAX,ESP
00685aa1 : TEST EDI,EDI
00685aa3 : JZ 0x00685aa8
00685aa5 : INC dword ptr [EDI + 0x4]
00685aa8 : MOV dword ptr [EAX],EDI
00685aaa : MOV EDX,dword ptr [ESI + 0x4]
00685aad : MOV ECX,dword ptr [EDX + 0x18]
00685ab0 : CALL 0x00684a30
00685ab5 : PUSH EBP
00685ab6 : CALL 0x00515cf0
00685abb : TEST EDI,EDI
00685abd : JZ 0x00685acc
00685abf : MOV ECX,EDI
00685ac1 : CALL 0x004ff7c0
00685ac6 : JMP 0x00685acc
00685ac8 : INC dword ptr [ESP + 0x1c]
00685acc : MOV ECX,dword ptr [ESP + 0x34]
00685ad0 : INC ECX
00685ad1 : MOV dword ptr [ESP + 0x34],ECX
00685ad5 : CMP ECX,EBX
00685ad7 : JC 0x00685a35
00685add : SUB EBX,dword ptr [ESP + 0x1c]
00685ae1 : MOV EAX,dword ptr [ESP + 0x38]
00685ae5 : MOV dword ptr [ESI + 0x34],EBX
00685ae8 : TEST EAX,EAX
00685aea : JL 0x00685afc
00685aec : SUB EAX,dword ptr [ESP + 0x2c]
00685af0 : PUSH EAX
00685af1 : MOV EAX,dword ptr [ESI + 0x4]
00685af4 : MOV ECX,dword ptr [EAX + 0x18]
00685af7 : CALL 0x006847b0
00685afc : MOV ECX,dword ptr [ESI + 0x4]
00685aff : MOV ECX,dword ptr [ECX + 0x18]
00685b02 : CALL 0x00684870
00685b07 : MOV EDX,dword ptr [ESI + 0x4]
00685b0a : MOV byte ptr [EDX + 0x6d],0x1
00685b0e : MOV EAX,dword ptr [ESP + 0x14]
00685b12 : MOV ECX,dword ptr [EAX]
00685b14 : MOV EDX,dword ptr [ECX + 0x8]
00685b17 : PUSH EAX
00685b18 : CALL EDX
00685b1a : MOV EAX,dword ptr [ESP + 0x40]
00685b1e : MOV ECX,dword ptr [EAX]
00685b20 : MOV EDX,dword ptr [ECX + 0x8]
00685b23 : PUSH EAX
00685b24 : CALL EDX
00685b26 : MOV EAX,dword ptr [ESP + 0x10]
00685b2a : MOV ECX,dword ptr [EAX]
00685b2c : MOV EDX,dword ptr [ECX + 0x8]
00685b2f : PUSH EAX
00685b30 : CALL EDX
00685b32 : MOV ECX,dword ptr [ESP + 0x68]
00685b36 : POP EDI
00685b37 : POP ESI
00685b38 : POP EBP
00685b39 : POP EBX
00685b3a : XOR ECX,ESP
00685b3c : XOR EAX,EAX
00685b3e : CALL 0x00633e6b
00685b43 : ADD ESP,0x5c
00685b46 : RET 0x8

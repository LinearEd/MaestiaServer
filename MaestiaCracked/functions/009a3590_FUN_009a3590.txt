PROGRAM  : Maestia.exe
FUNCTION : FUN_009a3590
ENTRY    : 009a3590
BODY     : [[009a3590, 009a38ff]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009a3590(undefined4 param_1)

{
  undefined2 uVar1;
  undefined2 uVar2;
  int iVar3;
  int *piVar4;
  char cVar5;
  uint uVar6;
  int iVar7;
  undefined4 uVar8;
  int iVar9;
  int *in_ECX;
  undefined1 local_2c [28];
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b63fba;
  local_10 = ExceptionList;
  uVar6 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if ((((char)in_ECX[2] != '\0') && (iVar3 = *(int *)(in_ECX[1] + 0x128), iVar3 != 0)) &&
     ((*(int *)(iVar3 + 0x40) != 0 || (cVar5 = FUN_00907c00(0), cVar5 == '\0')))) {
    iVar7 = (**(code **)(*in_ECX + 0x74))(param_1,0,uVar6);
    cVar5 = (**(code **)(*in_ECX + 0x5c))(iVar7,iVar3);
    if (cVar5 == '\0') {
      cVar5 = FUN_008896f0();
      if (cVar5 == '\0') {
        iVar9 = *(int *)(iVar3 + 0x40);
        if (iVar9 == 0) {
          if (*(short *)(iVar3 + 0x48) != (short)param_1) {
            if (*(int *)(iVar3 + 0x4c) == 0) {
              uVar8 = 0;
            }
            else {
              uVar8 = *(undefined4 *)(*(int *)(iVar3 + 0x4c) + 0x10);
            }
            iVar7 = FUN_004049b0(uVar8);
            if (iVar7 == 0) {
              ExceptionList = local_10;
              return;
            }
            uVar8 = FUN_004046b0();
            iVar9 = FUN_004049b0(uVar8);
            if (iVar9 == 0) {
              ExceptionList = local_10;
              return;
            }
            if ((*(char *)(iVar7 + 0x288) == '\x06') && (*(char *)(iVar9 + 0x288) == '\x06')) {
              uVar1 = *(undefined2 *)(iVar3 + 0x44);
              uVar2 = *(undefined2 *)(iVar3 + 0x46);
              cVar5 = FUN_009a02f0();
              if (cVar5 != '\0') {
                FUN_008efa90(0,uVar1,uVar2,0,param_1,0);
                ExceptionList = local_10;
                return;
              }
              FUN_008018d0(L"Only the lefthand can not be!!!");
              ExceptionList = local_10;
              return;
            }
          }
        }
        else {
          if (iVar9 == 0x80) {
            ExceptionList = local_10;
            return;
          }
          if (iVar9 == -1) {
            if (iVar7 == 0) {
              ExceptionList = local_10;
              return;
            }
            if (*(char *)(*(int *)(in_ECX[1] + 0x178) + 0x32) == '\0') {
              FUN_0097fb30(iVar7,param_1,0);
              ExceptionList = local_10;
              return;
            }
            FUN_00406460(L"IDS_GUI_REMOVE_EQUIP_DEDICATION");
            local_8 = 2;
            piVar4 = *(int **)(in_ECX[1] + 0x1a8);
            uVar8 = FUN_0081d120(local_2c);
            local_8._0_1_ = 3;
            (**(code **)(*piVar4 + 0x44))(uVar8,3);
            local_8 = CONCAT31(local_8._1_3_,2);
            FUN_00406560();
            local_8 = 0xffffffff;
            FUN_00406560();
          }
          else {
            iVar7 = FUN_008eb580();
            if (iVar7 == 0) {
              ExceptionList = local_10;
              return;
            }
            if (*(int *)(iVar3 + 0x4c) == 0) {
              uVar8 = 0;
            }
            else {
              uVar8 = *(undefined4 *)(*(int *)(iVar3 + 0x4c) + 0x10);
            }
            iVar7 = FUN_004049b0(uVar8);
            if (iVar7 == 0) {
              ExceptionList = local_10;
              return;
            }
            cVar5 = FUN_009a3060(param_1);
            if (cVar5 != '\0') {
              uVar1 = *(undefined2 *)(iVar3 + 0x44);
              if ((((short)param_1 == 1) &&
                  (*(short *)(*(int *)(DAT_0172491c + 0x17c) + 0x16d8) == 3)) &&
                 (cVar5 = FUN_009a0860(), cVar5 == '\0')) {
                FUN_008efa90(*(undefined4 *)(iVar3 + 0x40),uVar1,*(undefined2 *)(iVar3 + 0x46),0,0,0
                            );
                ExceptionList = local_10;
                return;
              }
              FUN_008efa90(*(undefined4 *)(iVar3 + 0x40),uVar1,*(undefined2 *)(iVar3 + 0x46),0,
                           param_1,0);
              ExceptionList = local_10;
              return;
            }
          }
        }
      }
      else {
        FUN_00406460(L"IDS_DISABLE_DEAD");
        local_8 = 0;
        piVar4 = *(int **)(*DAT_00da9894 + 0x1a8);
        uVar8 = FUN_0081d120(local_2c);
        local_8._0_1_ = 1;
        (**(code **)(*piVar4 + 0x44))(uVar8,3);
        local_8 = (uint)local_8._1_3_ << 8;
        FUN_00406560();
        local_8 = 0xffffffff;
        FUN_00406560();
        FUN_008a1050(0xca);
      }
      FUN_0097fa60();
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
009a3590 : PUSH EBP
009a3591 : MOV EBP,ESP
009a3593 : PUSH -0x1
009a3595 : PUSH 0xb63fba
009a359a : MOV EAX,FS:[0x0]
009a35a0 : PUSH EAX
009a35a1 : SUB ESP,0x38
009a35a4 : PUSH EBX
009a35a5 : PUSH ESI
009a35a6 : PUSH EDI
009a35a7 : MOV EAX,[0x00d66fa0]
009a35ac : XOR EAX,EBP
009a35ae : PUSH EAX
009a35af : LEA EAX,[EBP + -0xc]
009a35b2 : MOV FS:[0x0],EAX
009a35b8 : MOV ESI,ECX
009a35ba : MOV AL,byte ptr [ESI + 0x8]
009a35bd : TEST AL,AL
009a35bf : JZ 0x009a36a1
009a35c5 : MOV EAX,dword ptr [ESI + 0x4]
009a35c8 : MOV EBX,dword ptr [EAX + 0x128]
009a35ce : TEST EBX,EBX
009a35d0 : JZ 0x009a36a1
009a35d6 : CMP dword ptr [EBX + 0x40],0x0
009a35da : JNZ 0x009a35f0
009a35dc : MOV EDI,dword ptr [EBP + 0x8]
009a35df : PUSH 0x0
009a35e1 : MOV ECX,EBX
009a35e3 : CALL 0x00907c00
009a35e8 : TEST AL,AL
009a35ea : JNZ 0x009a36a1
009a35f0 : MOV EDX,dword ptr [ESI]
009a35f2 : MOV EAX,dword ptr [EBP + 0x8]
009a35f5 : MOV EDX,dword ptr [EDX + 0x74]
009a35f8 : PUSH 0x0
009a35fa : PUSH EAX
009a35fb : MOV ECX,ESI
009a35fd : CALL EDX
009a35ff : MOV EDI,EAX
009a3601 : MOV EAX,dword ptr [ESI]
009a3603 : MOV EDX,dword ptr [EAX + 0x5c]
009a3606 : PUSH EBX
009a3607 : PUSH EDI
009a3608 : MOV ECX,ESI
009a360a : CALL EDX
009a360c : TEST AL,AL
009a360e : JNZ 0x009a36a1
009a3614 : MOV EAX,[0x0172491c]
009a3619 : MOV EAX,dword ptr [EAX + 0x17c]
009a361f : CALL 0x008896f0
009a3624 : TEST AL,AL
009a3626 : JZ 0x009a36b5
009a362c : PUSH 0xc88fac
009a3631 : LEA ECX,[EBP + -0x28]
009a3634 : CALL 0x00406460
009a3639 : MOV dword ptr [EBP + -0x4],0x0
009a3640 : MOV ECX,dword ptr [0x00da9894]
009a3646 : MOV EAX,dword ptr [ECX]
009a3648 : MOV ECX,dword ptr [0x0172491c]
009a364e : MOV ESI,dword ptr [EAX + 0x1a8]
009a3654 : LEA EDX,[EBP + -0x28]
009a3657 : PUSH EDX
009a3658 : LEA EDI,[EBP + -0x44]
009a365b : CALL 0x0081d120
009a3660 : MOV byte ptr [EBP + -0x4],0x1
009a3664 : MOV EDX,dword ptr [ESI]
009a3666 : PUSH 0x3
009a3668 : PUSH EAX
009a3669 : MOV EAX,dword ptr [EDX + 0x44]
009a366c : MOV ECX,ESI
009a366e : CALL EAX
009a3670 : MOV byte ptr [EBP + -0x4],0x0
009a3674 : MOV ECX,EDI
009a3676 : CALL 0x00406560
009a367b : MOV dword ptr [EBP + -0x4],0xffffffff
009a3682 : LEA ECX,[EBP + -0x28]
009a3685 : CALL 0x00406560
009a368a : MOV ECX,dword ptr [0x017248dc]
009a3690 : PUSH 0xca
009a3695 : CALL 0x008a1050
009a369a : MOV ECX,EBX
009a369c : CALL 0x0097fa60
009a36a1 : MOV ECX,dword ptr [EBP + -0xc]
009a36a4 : MOV dword ptr FS:[0x0],ECX
009a36ab : POP ECX
009a36ac : POP EDI
009a36ad : POP ESI
009a36ae : POP EBX
009a36af : MOV ESP,EBP
009a36b1 : POP EBP
009a36b2 : RET 0x4
009a36b5 : MOV EAX,dword ptr [EBX + 0x40]
009a36b8 : TEST EAX,EAX
009a36ba : JZ 0x009a3836
009a36c0 : CMP EAX,0x80
009a36c5 : JZ 0x009a36a1
009a36c7 : CMP EAX,-0x1
009a36ca : JZ 0x009a379d
009a36d0 : MOV EDI,EAX
009a36d2 : MOV EAX,dword ptr [ESI + 0x4]
009a36d5 : CALL 0x008eb580
009a36da : TEST EAX,EAX
009a36dc : JZ 0x009a36a1
009a36de : MOV EDI,dword ptr [EBX + 0x4c]
009a36e1 : TEST EDI,EDI
009a36e3 : JZ 0x009a36ea
009a36e5 : MOV EAX,dword ptr [EDI + 0x10]
009a36e8 : JMP 0x009a36ec
009a36ea : XOR EAX,EAX
009a36ec : PUSH EAX
009a36ed : CALL 0x004049b0
009a36f2 : ADD ESP,0x4
009a36f5 : TEST EAX,EAX
009a36f7 : JZ 0x009a36a1
009a36f9 : TEST EDI,EDI
009a36fb : JZ 0x009a3702
009a36fd : MOV ECX,dword ptr [EDI + 0x10]
009a3700 : JMP 0x009a3704
009a3702 : XOR ECX,ECX
009a3704 : MOV EDX,dword ptr [EBP + 0x8]
009a3707 : PUSH EDX
009a3708 : MOV EDX,ESI
009a370a : CALL 0x009a3060
009a370f : TEST AL,AL
009a3711 : JZ 0x009a369a
009a3713 : CMP word ptr [EBP + 0x8],0x1
009a3718 : MOVZX EDI,word ptr [EBX + 0x44]
009a371c : JNZ 0x009a376f
009a371e : MOV EAX,[0x0172491c]
009a3723 : MOV ECX,dword ptr [EAX + 0x17c]
009a3729 : MOV DX,word ptr [ECX + 0x16d8]
009a3730 : DEC DX
009a3732 : MOVZX EAX,DX
009a3735 : SUB EAX,0x2
009a3738 : JNZ 0x009a376f
009a373a : CALL 0x009a0860
009a373f : TEST AL,AL
009a3741 : JNZ 0x009a376f
009a3743 : MOVZX EAX,word ptr [EBX + 0x46]
009a3747 : PUSH 0x0
009a3749 : PUSH 0x0
009a374b : PUSH 0x0
009a374d : PUSH EAX
009a374e : MOV EAX,dword ptr [EBX + 0x40]
009a3751 : PUSH EDI
009a3752 : PUSH EAX
009a3753 : CALL 0x008efa90
009a3758 : ADD ESP,0x18
009a375b : MOV ECX,dword ptr [EBP + -0xc]
009a375e : MOV dword ptr FS:[0x0],ECX
009a3765 : POP ECX
009a3766 : POP EDI
009a3767 : POP ESI
009a3768 : POP EBX
009a3769 : MOV ESP,EBP
009a376b : POP EBP
009a376c : RET 0x4
009a376f : MOV ECX,dword ptr [EBP + 0x8]
009a3772 : MOVZX EAX,word ptr [EBX + 0x46]
009a3776 : MOV EDX,dword ptr [EBX + 0x40]
009a3779 : PUSH 0x0
009a377b : PUSH ECX
009a377c : PUSH 0x0
009a377e : PUSH EAX
009a377f : PUSH EDI
009a3780 : PUSH EDX
009a3781 : CALL 0x008efa90
009a3786 : ADD ESP,0x18
009a3789 : MOV ECX,dword ptr [EBP + -0xc]
009a378c : MOV dword ptr FS:[0x0],ECX
009a3793 : POP ECX
009a3794 : POP EDI
009a3795 : POP ESI
009a3796 : POP EBX
009a3797 : MOV ESP,EBP
009a3799 : POP EBP
009a379a : RET 0x4
009a379d : TEST EDI,EDI
009a379f : JZ 0x009a36a1
009a37a5 : MOV EAX,dword ptr [ESI + 0x4]
009a37a8 : MOV EAX,dword ptr [EAX + 0x178]
009a37ae : CMP byte ptr [EAX + 0x32],0x0
009a37b2 : JZ 0x009a3812
009a37b4 : PUSH 0xc89120
009a37b9 : LEA ECX,[EBP + -0x28]
009a37bc : CALL 0x00406460
009a37c1 : MOV dword ptr [EBP + -0x4],0x2
009a37c8 : MOV ECX,dword ptr [ESI + 0x4]
009a37cb : MOV ESI,dword ptr [ECX + 0x1a8]
009a37d1 : MOV ECX,dword ptr [0x0172491c]
009a37d7 : LEA EDX,[EBP + -0x28]
009a37da : PUSH EDX
009a37db : LEA EDI,[EBP + -0x44]
009a37de : CALL 0x0081d120
009a37e3 : MOV byte ptr [EBP + -0x4],0x3
009a37e7 : MOV EDX,dword ptr [ESI]
009a37e9 : PUSH 0x3
009a37eb : PUSH EAX
009a37ec : MOV EAX,dword ptr [EDX + 0x44]
009a37ef : MOV ECX,ESI
009a37f1 : CALL EAX
009a37f3 : MOV byte ptr [EBP + -0x4],0x2
009a37f7 : MOV ECX,EDI
009a37f9 : CALL 0x00406560
009a37fe : MOV dword ptr [EBP + -0x4],0xffffffff
009a3805 : LEA ECX,[EBP + -0x28]
009a3808 : CALL 0x00406560
009a380d : JMP 0x009a369a
009a3812 : MOV ECX,dword ptr [EBP + 0x8]
009a3815 : PUSH 0x0
009a3817 : PUSH ECX
009a3818 : PUSH EDI
009a3819 : XOR EAX,EAX
009a381b : MOV ECX,EBX
009a381d : CALL 0x0097fb30
009a3822 : MOV ECX,dword ptr [EBP + -0xc]
009a3825 : MOV dword ptr FS:[0x0],ECX
009a382c : POP ECX
009a382d : POP EDI
009a382e : POP ESI
009a382f : POP EBX
009a3830 : MOV ESP,EBP
009a3832 : POP EBP
009a3833 : RET 0x4
009a3836 : MOV DX,word ptr [EBP + 0x8]
009a383a : CMP word ptr [EBX + 0x48],DX
009a383e : JZ 0x009a369a
009a3844 : MOV EAX,dword ptr [EBX + 0x4c]
009a3847 : TEST EAX,EAX
009a3849 : JZ 0x009a3850
009a384b : MOV EAX,dword ptr [EAX + 0x10]
009a384e : JMP 0x009a3852
009a3850 : XOR EAX,EAX
009a3852 : PUSH EAX
009a3853 : CALL 0x004049b0
009a3858 : MOV EDI,EAX
009a385a : ADD ESP,0x4
009a385d : TEST EDI,EDI
009a385f : JZ 0x009a36a1
009a3865 : MOV EAX,[0x0172491c]
009a386a : MOV EAX,dword ptr [EAX + 0x17c]
009a3870 : CALL 0x004046b0
009a3875 : PUSH EAX
009a3876 : CALL 0x004049b0
009a387b : ADD ESP,0x4
009a387e : TEST EAX,EAX
009a3880 : JZ 0x009a36a1
009a3886 : MOV CL,0x6
009a3888 : CMP byte ptr [EDI + 0x288],CL
009a388e : JNZ 0x009a369a
009a3894 : CMP byte ptr [EAX + 0x288],CL
009a389a : JNZ 0x009a369a
009a38a0 : MOVZX EDI,word ptr [EBX + 0x44]
009a38a4 : MOVZX EBX,word ptr [EBX + 0x46]
009a38a8 : CALL 0x009a02f0
009a38ad : TEST AL,AL
009a38af : JNZ 0x009a38d8
009a38b1 : MOV ESI,dword ptr [0x00da98e8]
009a38b7 : PUSH 0xc89160
009a38bc : CALL 0x008018d0
009a38c1 : ADD ESP,0x4
009a38c4 : MOV ECX,dword ptr [EBP + -0xc]
009a38c7 : MOV dword ptr FS:[0x0],ECX
009a38ce : POP ECX
009a38cf : POP EDI
009a38d0 : POP ESI
009a38d1 : POP EBX
009a38d2 : MOV ESP,EBP
009a38d4 : POP EBP
009a38d5 : RET 0x4
009a38d8 : MOV ECX,dword ptr [EBP + 0x8]
009a38db : PUSH 0x0
009a38dd : PUSH ECX
009a38de : PUSH 0x0
009a38e0 : PUSH EBX
009a38e1 : PUSH EDI
009a38e2 : PUSH 0x0
009a38e4 : CALL 0x008efa90
009a38e9 : ADD ESP,0x18
009a38ec : MOV ECX,dword ptr [EBP + -0xc]
009a38ef : MOV dword ptr FS:[0x0],ECX
009a38f6 : POP ECX
009a38f7 : POP EDI
009a38f8 : POP ESI
009a38f9 : POP EBX
009a38fa : MOV ESP,EBP
009a38fc : POP EBP
009a38fd : RET 0x4

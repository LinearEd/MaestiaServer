PROGRAM  : Maestia.exe
FUNCTION : FUN_0056bbf0
ENTRY    : 0056bbf0
BODY     : [[0056bbf0, 0056bd34]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0056bbf0(void)

{
  GRefCountImpl *this;
  LONG LVar1;
  int in_ECX;
  int iVar2;
  uint uVar3;
  undefined8 uVar4;
  ulonglong uVar5;
  uint uStack_64;
  undefined1 auStack_58 [4];
  undefined **ppuStack_54;
  undefined4 uStack_40;
  uint uStack_10;
  uint uStack_8;
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)auStack_58;
  uStack_64 = 0x24;
  this = (GRefCountImpl *)(**(code **)(*(int *)(in_ECX + 8) + 0xc))();
  if (this == (GRefCountImpl *)0x0) {
    uVar4 = FUN_005aa2b0();
    uVar4 = __aulldiv(uVar4,1000,0);
    __security_check_cookie
              (uStack_8 ^ (uint)&stack0xffffffa4,
               ((int)((ulonglong)uVar4 >> 0x20) - *(int *)(in_ECX + 0xaac)) -
               (uint)((uint)uVar4 < *(uint *)(in_ECX + 0xaa8)));
    return;
  }
  GRefCountImpl::Release(this);
  if (*(int *)(this + 0xc) == 0) {
    uVar4 = FUN_005aa2b0();
    uVar4 = __aulldiv(uVar4,1000,0);
    iVar2 = ((int)((ulonglong)uVar4 >> 0x20) - *(int *)(in_ECX + 0xaac)) -
            (uint)((uint)uVar4 < *(uint *)(in_ECX + 0xaa8));
    FUN_005ae0e0((uint)uVar4 - *(uint *)(in_ECX + 0xaa8),iVar2);
    FUN_005ae280();
    (**(code **)(*(int *)this + 8))("timer",uStack_40);
    ppuStack_54 = &PTR_LAB_00b85ff8;
    FUN_005ad950();
    __security_check_cookie(uStack_10 ^ (uint)&uStack_64,iVar2);
    return;
  }
  FUN_0051b6e0();
  (**(code **)(*(int *)this + 4))("timer",&stack0xffffffa4);
  uVar5 = __strtoui64((char *)((uStack_64 & 0xfffffffc) + 8),(char **)0x0,10);
  uVar3 = uStack_64 & 0xfffffffc;
  LVar1 = InterlockedExchangeAdd((LONG *)(uVar3 + 4),-1);
  if (LVar1 == 1) {
    FUN_00515cf0(uVar3);
  }
  __security_check_cookie(uStack_10 ^ (uint)&uStack_64,(int)(uVar5 >> 0x20));
  return;
}



============================================================
DISASSEMBLY
============================================================
0056bbf0 : SUB ESP,0x58
0056bbf3 : MOV EAX,[0x00d66fa0]
0056bbf8 : XOR EAX,ESP
0056bbfa : MOV dword ptr [ESP + 0x54],EAX
0056bbfe : PUSH ESI
0056bbff : PUSH EDI
0056bc00 : MOV EDI,ECX
0056bc02 : MOV EAX,dword ptr [EDI + 0x8]
0056bc05 : MOV EDX,dword ptr [EAX + 0xc]
0056bc08 : LEA ECX,[EDI + 0x8]
0056bc0b : PUSH 0x24
0056bc0d : CALL EDX
0056bc0f : MOV ESI,EAX
0056bc11 : TEST ESI,ESI
0056bc13 : JZ 0x0056bd05
0056bc19 : PUSH EBX
0056bc1a : MOV ECX,ESI
0056bc1c : CALL 0x004ff7e0
0056bc21 : CMP dword ptr [ESI + 0xc],0x0
0056bc25 : JNZ 0x0056bc9a
0056bc27 : PUSH EBP
0056bc28 : CALL 0x005aa2b0
0056bc2d : PUSH 0x0
0056bc2f : PUSH 0x3e8
0056bc34 : PUSH EDX
0056bc35 : PUSH EAX
0056bc36 : CALL 0x0063c250
0056bc3b : MOV EBX,EAX
0056bc3d : SUB EBX,dword ptr [EDI + 0xaa8]
0056bc43 : MOV EBP,EDX
0056bc45 : SBB EBP,dword ptr [EDI + 0xaac]
0056bc4b : LEA ECX,[ESP + 0x14]
0056bc4f : PUSH EBP
0056bc50 : PUSH EBX
0056bc51 : CALL 0x005ae0e0
0056bc56 : LEA ECX,[ESP + 0x14]
0056bc5a : CALL 0x005ae280
0056bc5f : MOV ECX,dword ptr [ESP + 0x2c]
0056bc63 : MOV EAX,dword ptr [ESI]
0056bc65 : MOV EDX,dword ptr [EAX + 0x8]
0056bc68 : PUSH ECX
0056bc69 : PUSH 0xb8d0bc
0056bc6e : MOV ECX,ESI
0056bc70 : CALL EDX
0056bc72 : LEA ECX,[ESP + 0x14]
0056bc76 : MOV dword ptr [ESP + 0x20],0xb85ff8
0056bc7e : CALL 0x005ad950
0056bc83 : MOV EDX,EBP
0056bc85 : POP EBP
0056bc86 : MOV EAX,EBX
0056bc88 : POP EBX
0056bc89 : POP EDI
0056bc8a : POP ESI
0056bc8b : MOV ECX,dword ptr [ESP + 0x54]
0056bc8f : XOR ECX,ESP
0056bc91 : CALL 0x00633e6b
0056bc96 : ADD ESP,0x58
0056bc99 : RET
0056bc9a : LEA ECX,[ESP + 0xc]
0056bc9e : CALL 0x0051b6e0
0056bca3 : MOV EAX,dword ptr [ESI]
0056bca5 : MOV EDX,dword ptr [EAX + 0x4]
0056bca8 : LEA ECX,[ESP + 0xc]
0056bcac : PUSH ECX
0056bcad : PUSH 0xb8d0bc
0056bcb2 : MOV ECX,ESI
0056bcb4 : CALL EDX
0056bcb6 : MOV EAX,dword ptr [ESP + 0xc]
0056bcba : AND EAX,0xfffffffc
0056bcbd : PUSH 0xa
0056bcbf : ADD EAX,0x8
0056bcc2 : PUSH 0x0
0056bcc4 : PUSH EAX
0056bcc5 : CALL 0x0063c54f
0056bcca : MOV ESI,dword ptr [ESP + 0x18]
0056bcce : ADD ESP,0xc
0056bcd1 : MOV EDI,EAX
0056bcd3 : AND ESI,0xfffffffc
0056bcd6 : PUSH -0x1
0056bcd8 : LEA EAX,[ESI + 0x4]
0056bcdb : PUSH EAX
0056bcdc : MOV EBX,EDX
0056bcde : CALL dword ptr [0x00b851cc]
0056bce4 : SUB EAX,0x1
0056bce7 : JNZ 0x0056bcef
0056bce9 : PUSH ESI
0056bcea : CALL 0x00515cf0
0056bcef : MOV EDX,EBX
0056bcf1 : POP EBX
0056bcf2 : MOV EAX,EDI
0056bcf4 : POP EDI
0056bcf5 : POP ESI
0056bcf6 : MOV ECX,dword ptr [ESP + 0x54]
0056bcfa : XOR ECX,ESP
0056bcfc : CALL 0x00633e6b
0056bd01 : ADD ESP,0x58
0056bd04 : RET
0056bd05 : CALL 0x005aa2b0
0056bd0a : PUSH 0x0
0056bd0c : PUSH 0x3e8
0056bd11 : PUSH EDX
0056bd12 : PUSH EAX
0056bd13 : CALL 0x0063c250
0056bd18 : SUB EAX,dword ptr [EDI + 0xaa8]
0056bd1e : MOV ECX,dword ptr [ESP + 0x5c]
0056bd22 : SBB EDX,dword ptr [EDI + 0xaac]
0056bd28 : POP EDI
0056bd29 : POP ESI
0056bd2a : XOR ECX,ESP
0056bd2c : CALL 0x00633e6b
0056bd31 : ADD ESP,0x58
0056bd34 : RET

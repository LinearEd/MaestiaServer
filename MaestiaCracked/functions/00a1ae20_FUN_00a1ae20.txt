PROGRAM  : Maestia.exe
FUNCTION : FUN_00a1ae20
ENTRY    : 00a1ae20
BODY     : [[00a1ae20, 00a1b173]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_00a1ae20(void)

{
  int *piVar1;
  DWORD DVar2;
  int iVar3;
  float *pfVar4;
  DWORD DVar5;
  int unaff_EDI;
  float fVar6;
  double dVar7;
  float fVar8;
  undefined4 uStack_ac;
  undefined4 uStack_a8;
  undefined4 uStack_a4;
  undefined4 uStack_a0;
  float fStack_9c;
  float fStack_94;
  float fStack_84;
  float fStack_80;
  float fStack_7c;
  float fStack_78;
  float fStack_74;
  undefined4 uStack_70;
  undefined4 uStack_6c;
  float fStack_68;
  undefined1 local_64 [4];
  undefined4 uStack_60;
  
  (**(code **)(**(int **)(unaff_EDI + 0x74) + 8))(local_64);
  uStack_70 = 0;
  fStack_74 = fStack_68;
  uStack_6c = uStack_60;
  fStack_7c = fStack_68;
  fStack_78 = (float)uStack_60;
  D3DXVec2Normalize(&fStack_7c,&fStack_7c);
  iVar3 = *(int *)(unaff_EDI + 0xac);
  fVar6 = fStack_9c + fStack_84;
  if (*(char *)(*(int *)(iVar3 + 0x18a8) + 0x20) == '\0') {
    fVar8 = *(float *)(iVar3 + 0x1a8);
  }
  else {
    fVar8 = *(float *)(*(int *)(iVar3 + 0x18a8) + 0xe8) + *(float *)(iVar3 + 0x1a8);
  }
  fStack_7c = fVar6 - *(float *)(unaff_EDI + 0x2a0);
  fStack_74 = (fStack_94 + fStack_80) - *(float *)(unaff_EDI + 0x2a8);
  fStack_78 = (fVar8 + 17.0) - *(float *)(unaff_EDI + 0x2a4);
  D3DXVec3Normalize(&fStack_7c,&fStack_7c);
  if ((*(int *)(unaff_EDI + 0xac) == 0) || (10 < *(uint *)(*(int *)(unaff_EDI + 0xac) + 0xa0))) {
    iVar3 = *(int *)(unaff_EDI + 0x1b0);
    *(undefined4 *)(iVar3 + 0x68) = 0xbf800000;
    *(undefined4 *)(iVar3 + 0x6c) = 0xc3960000;
    *(undefined4 *)(iVar3 + 0x70) = 0xc1200000;
  }
  else {
    iVar3 = *(int *)(unaff_EDI + 0x1b0);
    *(undefined4 *)(iVar3 + 0x68) = uStack_a4;
    *(undefined4 *)(iVar3 + 0x6c) = uStack_a0;
    *(float *)(iVar3 + 0x70) = fVar6;
    *(undefined1 *)(iVar3 + 0x5d) = 1;
    *(undefined1 *)(iVar3 + 0x134) = 1;
    *(undefined1 *)(iVar3 + 0x5c) = 1;
    if (*(int **)(iVar3 + 0x2c) != (int *)0x0) {
      (**(code **)(**(int **)(iVar3 + 0x2c) + 0x60))(iVar3);
    }
    FUN_007cc680();
    (**(code **)(**(int **)(unaff_EDI + 0x1b0) + 0x114))(1,0x96);
    iVar3 = *(int *)(unaff_EDI + 0x1b0);
    *(undefined4 *)(iVar3 + 0x84) = 0x40000000;
    *(undefined4 *)(iVar3 + 0x88) = 0x40000000;
    *(undefined4 *)(iVar3 + 0x8c) = 0x40000000;
  }
  *(undefined1 *)(iVar3 + 0x5c) = 1;
  *(undefined1 *)(iVar3 + 0x134) = 1;
  *(undefined1 *)(iVar3 + 0x5d) = 1;
  if (*(int **)(iVar3 + 0x2c) != (int *)0x0) {
    (**(code **)(**(int **)(iVar3 + 0x2c) + 0x60))(iVar3);
  }
  pfVar4 = (float *)(**(code **)(**(int **)(unaff_EDI + 0x74) + 8))(&uStack_6c);
  fVar8 = *pfVar4;
  piVar1 = *(int **)(unaff_EDI + 0x74);
  FUN_00b0b091();
  uStack_a8 = SUB84((double)fVar8,0);
  (**(code **)(*piVar1 + 8))(local_64);
  dVar7 = (double)CONCAT44(uStack_a8,uStack_ac);
  FUN_00b0b091();
  fVar6 = fVar6 - (float)dVar7 * 57.295826;
  DVar5 = timeGetTime();
  if (((*(char *)(unaff_EDI + 0x2ae) != '\0') ||
      (DVar2 = _DAT_01724794, 100 < DVar5 - _DAT_01724794)) &&
     (DVar2 = DVar5, DAT_00d72a8c != fVar6)) {
    if ((*DAT_00da9894 != 0) && (piVar1 = *(int **)(*DAT_00da9894 + 0x114), piVar1 != (int *)0x0)) {
      (**(code **)(*piVar1 + 4))(piVar1,"mc_questshortcut.SetDirection","%d,%f",0,(double)fVar6);
    }
    DAT_00d72a8c = fVar6;
    *(undefined1 *)(unaff_EDI + 0x2ae) = 0;
  }
  _DAT_01724794 = DVar2;
  return;
}



============================================================
DISASSEMBLY
============================================================
00a1ae20 : PUSH EBP
00a1ae21 : MOV EBP,ESP
00a1ae23 : AND ESP,0xffffffc0
00a1ae26 : SUB ESP,0x78
00a1ae29 : MOV EAX,dword ptr [EDI + 0xac]
00a1ae2f : MOVSS XMM0,dword ptr [EAX + 0x1a4]
00a1ae37 : MOV ECX,dword ptr [EDI + 0x74]
00a1ae3a : ADD EAX,0x1a4
00a1ae3f : PUSH EBX
00a1ae40 : MOVSS dword ptr [ESP + 0x2c],XMM0
00a1ae46 : MOVSS XMM0,dword ptr [EAX + 0x8]
00a1ae4b : MOV EAX,dword ptr [ECX]
00a1ae4d : MOV EAX,dword ptr [EAX + 0x8]
00a1ae50 : PUSH ESI
00a1ae51 : LEA EDX,[ESP + 0x5c]
00a1ae55 : PUSH EDX
00a1ae56 : MOVSS dword ptr [ESP + 0x3c],XMM0
00a1ae5c : CALL EAX
00a1ae5e : XORPS XMM0,XMM0
00a1ae61 : MOVSS XMM1,dword ptr [ESP + 0x64]
00a1ae67 : LEA ECX,[ESP + 0x48]
00a1ae6b : PUSH ECX
00a1ae6c : MOV EDX,ECX
00a1ae6e : MOVSS dword ptr [ESP + 0x58],XMM0
00a1ae74 : MOVSS XMM0,dword ptr [ESP + 0x60]
00a1ae7a : PUSH EDX
00a1ae7b : MOVSS dword ptr [ESP + 0x58],XMM0
00a1ae81 : MOVSS dword ptr [ESP + 0x60],XMM1
00a1ae87 : MOVSS dword ptr [ESP + 0x50],XMM0
00a1ae8d : MOVSS dword ptr [ESP + 0x54],XMM1
00a1ae93 : CALL 0x004ff71c
00a1ae98 : MOVSS XMM1,dword ptr [ESP + 0x48]
00a1ae9e : MOVSS XMM2,dword ptr [ESP + 0x4c]
00a1aea4 : MOVSS XMM0,dword ptr [ESP + 0x30]
00a1aeaa : MOV EAX,dword ptr [EDI + 0xac]
00a1aeb0 : MOVSS dword ptr [ESP + 0x50],XMM1
00a1aeb6 : MOVSS dword ptr [ESP + 0x58],XMM2
00a1aebc : MOV ECX,dword ptr [EAX + 0x18a8]
00a1aec2 : CMP byte ptr [ECX + 0x20],0x0
00a1aec6 : ADDSS XMM0,XMM1
00a1aeca : MOVSS XMM1,dword ptr [ESP + 0x38]
00a1aed0 : ADDSS XMM1,XMM2
00a1aed4 : MOVAPS XMM2,XMM1
00a1aed7 : MOVSS dword ptr [ESP + 0x30],XMM0
00a1aedd : MOVSS dword ptr [ESP + 0x38],XMM2
00a1aee3 : JZ 0x00a1aef7
00a1aee5 : MOVSS XMM1,dword ptr [ECX + 0xe8]
00a1aeed : ADDSS XMM1,dword ptr [EAX + 0x1a8]
00a1aef5 : JMP 0x00a1aeff
00a1aef7 : MOVSS XMM1,dword ptr [EAX + 0x1a8]
00a1aeff : ADDSS XMM1,dword ptr [0x00cdf4c0]
00a1af07 : SUBSS XMM0,dword ptr [EDI + 0x2a0]
00a1af0f : SUBSS XMM2,dword ptr [EDI + 0x2a8]
00a1af17 : LEA EAX,[ESP + 0x50]
00a1af1b : PUSH EAX
00a1af1c : MOV ECX,EAX
00a1af1e : MOVSS dword ptr [ESP + 0x38],XMM1
00a1af24 : SUBSS XMM1,dword ptr [EDI + 0x2a4]
00a1af2c : PUSH ECX
00a1af2d : MOVSS dword ptr [ESP + 0x58],XMM0
00a1af33 : MOVSS dword ptr [ESP + 0x5c],XMM1
00a1af39 : MOVSS dword ptr [ESP + 0x60],XMM2
00a1af3f : CALL 0x004ff722
00a1af44 : MOVSS XMM0,dword ptr [ESP + 0x50]
00a1af4a : MOV EAX,dword ptr [EDI + 0xac]
00a1af50 : MOVSS dword ptr [ESP + 0x40],XMM0
00a1af56 : MOVSS XMM0,dword ptr [ESP + 0x58]
00a1af5c : MOVSS dword ptr [ESP + 0x44],XMM0
00a1af62 : TEST EAX,EAX
00a1af64 : JZ 0x00a1b00b
00a1af6a : CMP dword ptr [EAX + 0xa0],0xa
00a1af71 : JA 0x00a1b00b
00a1af77 : MOV EAX,dword ptr [EDI + 0x1b0]
00a1af7d : MOVSS XMM0,dword ptr [ESP + 0x30]
00a1af83 : MOVSS dword ptr [EAX + 0x68],XMM0
00a1af88 : MOVSS XMM0,dword ptr [ESP + 0x34]
00a1af8e : MOVSS dword ptr [EAX + 0x6c],XMM0
00a1af93 : MOVSS XMM0,dword ptr [ESP + 0x38]
00a1af99 : MOVSS dword ptr [EAX + 0x70],XMM0
00a1af9e : MOV ECX,dword ptr [EAX + 0x2c]
00a1afa1 : MOV EBX,0x1
00a1afa6 : MOV byte ptr [EAX + 0x5d],BL
00a1afa9 : MOV byte ptr [EAX + 0x134],BL
00a1afaf : MOV byte ptr [EAX + 0x5c],BL
00a1afb2 : TEST ECX,ECX
00a1afb4 : JZ 0x00a1afbe
00a1afb6 : MOV EDX,dword ptr [ECX]
00a1afb8 : PUSH EAX
00a1afb9 : MOV EAX,dword ptr [EDX + 0x60]
00a1afbc : CALL EAX
00a1afbe : MOV ESI,dword ptr [EDI + 0x1b0]
00a1afc4 : LEA EAX,[ESP + 0x40]
00a1afc8 : CALL 0x007cc680
00a1afcd : MOV ECX,dword ptr [EDI + 0x1b0]
00a1afd3 : MOV EDX,dword ptr [ECX]
00a1afd5 : MOV EAX,dword ptr [EDX + 0x114]
00a1afdb : PUSH 0x96
00a1afe0 : PUSH EBX
00a1afe1 : CALL EAX
00a1afe3 : MOV EAX,dword ptr [EDI + 0x1b0]
00a1afe9 : MOVSS XMM0,dword ptr [0x00cdf144]
00a1aff1 : MOVSS dword ptr [EAX + 0x84],XMM0
00a1aff9 : MOVSS dword ptr [EAX + 0x88],XMM0
00a1b001 : MOVSS dword ptr [EAX + 0x8c],XMM0
00a1b009 : JMP 0x00a1b03d
00a1b00b : MOV EAX,dword ptr [EDI + 0x1b0]
00a1b011 : MOVSS XMM0,dword ptr [0x00cdf0d0]
00a1b019 : MOVSS dword ptr [EAX + 0x68],XMM0
00a1b01e : MOVSS XMM0,dword ptr [0x00cdf4bc]
00a1b026 : MOVSS dword ptr [EAX + 0x6c],XMM0
00a1b02b : MOVSS XMM0,dword ptr [0x00cdf26c]
00a1b033 : MOVSS dword ptr [EAX + 0x70],XMM0
00a1b038 : MOV EBX,0x1
00a1b03d : MOV ECX,dword ptr [EAX + 0x2c]
00a1b040 : MOV byte ptr [EAX + 0x5c],BL
00a1b043 : MOV byte ptr [EAX + 0x134],BL
00a1b049 : MOV byte ptr [EAX + 0x5d],BL
00a1b04c : TEST ECX,ECX
00a1b04e : JZ 0x00a1b058
00a1b050 : MOV EDX,dword ptr [ECX]
00a1b052 : PUSH EAX
00a1b053 : MOV EAX,dword ptr [EDX + 0x60]
00a1b056 : CALL EAX
00a1b058 : MOV ECX,dword ptr [EDI + 0x74]
00a1b05b : MOV EDX,dword ptr [ECX]
00a1b05d : MOV EDX,dword ptr [EDX + 0x8]
00a1b060 : LEA EAX,[ESP + 0x68]
00a1b064 : PUSH EAX
00a1b065 : CALL EDX
00a1b067 : MOVSS XMM0,dword ptr [EAX]
00a1b06b : MOV ESI,dword ptr [EDI + 0x74]
00a1b06e : CVTSS2SD XMM1,dword ptr [ESP + 0x44]
00a1b074 : MOVSS dword ptr [ESP + 0x30],XMM0
00a1b07a : CVTSS2SD XMM0,dword ptr [ESP + 0x40]
00a1b080 : CALL 0x00b0b091
00a1b085 : MOV EAX,dword ptr [ESI]
00a1b087 : MOV EDX,dword ptr [EAX + 0x8]
00a1b08a : CVTSD2SS XMM0,XMM0
00a1b08e : MULSS XMM0,dword ptr [0x00cdf4a8]
00a1b096 : ADDSS XMM0,dword ptr [0x00cdf4b8]
00a1b09e : LEA ECX,[ESP + 0x74]
00a1b0a2 : MOVSS dword ptr [ESP + 0x40],XMM0
00a1b0a8 : CVTSS2SD XMM0,dword ptr [ESP + 0x30]
00a1b0ae : PUSH ECX
00a1b0af : MOV ECX,ESI
00a1b0b1 : MOVSD qword ptr [ESP + 0x34],XMM0
00a1b0b7 : CALL EDX
00a1b0b9 : MOVSS XMM0,dword ptr [EAX + 0x8]
00a1b0be : CVTPS2PD XMM1,XMM0
00a1b0c1 : MOVSD XMM0,qword ptr [ESP + 0x30]
00a1b0c7 : CALL 0x00b0b091
00a1b0cc : CVTSD2SS XMM1,XMM0
00a1b0d0 : MULSS XMM1,dword ptr [0x00cdf4a8]
00a1b0d8 : MOVSS XMM0,dword ptr [ESP + 0x40]
00a1b0de : SUBSS XMM0,XMM1
00a1b0e2 : MOVSS dword ptr [ESP + 0x30],XMM0
00a1b0e8 : CALL dword ptr [0x00b85598]
00a1b0ee : CMP byte ptr [EDI + 0x2ae],0x0
00a1b0f5 : MOV ESI,EAX
00a1b0f7 : JNZ 0x00a1b104
00a1b0f9 : SUB EAX,dword ptr [0x01724794]
00a1b0ff : CMP EAX,0x64
00a1b102 : JBE 0x00a1b16e
00a1b104 : MOVSS XMM1,dword ptr [0x00d72a8c]
00a1b10c : MOVSS XMM0,dword ptr [ESP + 0x30]
00a1b112 : UCOMISS XMM1,XMM0
00a1b115 : LAHF
00a1b116 : TEST AH,0x44
00a1b119 : JNP 0x00a1b168
00a1b11b : MOV ECX,dword ptr [0x00da9894]
00a1b121 : MOV EAX,dword ptr [ECX]
00a1b123 : TEST EAX,EAX
00a1b125 : JZ 0x00a1b159
00a1b127 : MOV EAX,dword ptr [EAX + 0x114]
00a1b12d : TEST EAX,EAX
00a1b12f : JZ 0x00a1b159
00a1b131 : MOV EDX,dword ptr [EAX]
00a1b133 : SUB ESP,0x8
00a1b136 : CVTPS2PD XMM0,XMM0
00a1b139 : MOVSD qword ptr [ESP],XMM0
00a1b13e : PUSH 0x0
00a1b140 : PUSH 0xcbecb8
00a1b145 : PUSH 0xcbecc0
00a1b14a : PUSH EAX
00a1b14b : MOV EAX,dword ptr [EDX + 0x4]
00a1b14e : CALL EAX
00a1b150 : MOVSS XMM0,dword ptr [ESP + 0x48]
00a1b156 : ADD ESP,0x18
00a1b159 : MOVSS dword ptr [0x00d72a8c],XMM0
00a1b161 : MOV byte ptr [EDI + 0x2ae],0x0
00a1b168 : MOV dword ptr [0x01724794],ESI
00a1b16e : POP ESI
00a1b16f : POP EBX
00a1b170 : MOV ESP,EBP
00a1b172 : POP EBP
00a1b173 : RET

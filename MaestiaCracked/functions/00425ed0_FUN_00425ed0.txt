PROGRAM  : Maestia.exe
FUNCTION : FUN_00425ed0
ENTRY    : 00425ed0
BODY     : [[00425ed0, 00425f0c] [00425f10, 004261be]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00425ed0(undefined4 *param_1,undefined4 *param_2,undefined4 *param_3,code *param_4)

{
  undefined4 uVar1;
  char cVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  undefined4 *puVar8;
  undefined4 *puVar9;
  undefined4 *puVar10;
  undefined4 *local_10;
  undefined4 *local_c;
  undefined4 *local_8;
  
  puVar5 = param_2 + (((int)param_3 - (int)param_2 >> 3) - ((int)param_3 - (int)param_2 >> 0x1f) >>
                     1) * 2;
  FUN_004261c0(param_2,puVar5,param_3 + -2,param_4);
  puVar7 = puVar5;
  while (((param_2 < puVar7 &&
          (cVar2 = (*param_4)(puVar7[-2],puVar7[-1],*puVar7,puVar7[1]), cVar2 == '\0')) &&
         (cVar2 = (*param_4)(*puVar7,puVar7[1],puVar7[-2],puVar7[-1]), cVar2 == '\0'))) {
    puVar7 = puVar7 + -2;
  }
  do {
    puVar5 = puVar5 + 2;
    puVar3 = puVar7;
    puVar9 = puVar5;
    local_c = puVar5;
    local_8 = puVar7;
    if ((param_3 <= puVar5) ||
       (cVar2 = (*param_4)(*puVar5,puVar5[1],*puVar7,puVar7[1]), cVar2 != '\0')) break;
    cVar2 = (*param_4)(*puVar7,puVar7[1],*puVar5,puVar5[1]);
  } while (cVar2 == '\0');
  do {
    puVar6 = puVar5;
    if (puVar5 < param_3) {
      local_10 = puVar5 + 1;
      puVar4 = puVar9;
      do {
        cVar2 = (*param_4)(*puVar7,puVar7[1],*puVar5,puVar5[1]);
        puVar9 = puVar4;
        puVar3 = local_8;
        if (cVar2 == '\0') {
          cVar2 = (*param_4)(*puVar5,puVar5[1],*puVar7,puVar7[1]);
          puVar6 = puVar5;
          if (cVar2 != '\0') break;
          puVar9 = puVar4 + 2;
          local_c = puVar9;
          if (puVar4 != puVar5) {
            uVar1 = *puVar4;
            *puVar4 = *puVar5;
            puVar4 = puVar4 + 1;
            *puVar5 = uVar1;
            if (puVar4 != local_10) {
              uVar1 = *puVar4;
              *puVar4 = *local_10;
              *local_10 = uVar1;
            }
          }
        }
        local_10 = local_10 + 2;
        puVar5 = puVar5 + 2;
        puVar6 = puVar5;
        puVar4 = puVar9;
      } while (puVar5 < param_3);
    }
    puVar4 = puVar3;
    puVar8 = puVar7;
    puVar10 = puVar9;
    if (param_2 < puVar3) {
      local_10 = puVar7 + 1;
      puVar3 = puVar3 + -1;
      do {
        cVar2 = (*param_4)(puVar3[-1],*puVar3,*puVar7,puVar7[1]);
        puVar10 = local_c;
        if (cVar2 == '\0') {
          cVar2 = (*param_4)(*puVar7,puVar7[1],puVar3[-1],*puVar3);
          puVar4 = local_8;
          puVar8 = puVar7;
          if (cVar2 != '\0') break;
          puVar7 = puVar7 + -2;
          local_10 = local_10 + -2;
          if (puVar7 != puVar3 + -1) {
            uVar1 = *puVar7;
            *puVar7 = puVar3[-1];
            puVar3[-1] = uVar1;
            if (local_10 != puVar3) {
              uVar1 = *local_10;
              *local_10 = *puVar3;
              *puVar3 = uVar1;
            }
          }
        }
        puVar4 = local_8 + -2;
        puVar3 = puVar3 + -2;
        puVar8 = puVar7;
        local_8 = puVar4;
      } while (param_2 < puVar4);
    }
    if (puVar4 == param_2) {
      if (puVar6 == param_3) {
        param_1[1] = puVar10;
        *param_1 = puVar8;
        return;
      }
      if ((puVar10 != puVar6) && (puVar8 != puVar10)) {
        uVar1 = *puVar8;
        *puVar8 = *puVar10;
        *puVar10 = uVar1;
        puVar5 = puVar8 + 1;
        if (puVar5 != puVar10 + 1) {
          uVar1 = *puVar5;
          *puVar5 = puVar10[1];
          puVar10[1] = uVar1;
        }
      }
      puVar9 = puVar10 + 2;
      puVar5 = puVar6 + 2;
      puVar7 = puVar8 + 2;
      puVar3 = puVar4;
      local_c = puVar9;
      if (puVar8 != puVar6) {
        uVar1 = *puVar8;
        *puVar8 = *puVar6;
        *puVar6 = uVar1;
        puVar6 = puVar6 + 1;
        puVar8 = puVar8 + 1;
        puVar3 = local_8;
        if (puVar8 != puVar6) {
          uVar1 = *puVar8;
          *puVar8 = *puVar6;
          *puVar6 = uVar1;
        }
      }
    }
    else {
      puVar3 = puVar4 + -2;
      local_8 = puVar3;
      if (puVar6 == param_3) {
        puVar7 = puVar8 + -2;
        if (puVar3 != puVar7) {
          uVar1 = *puVar3;
          *puVar3 = *puVar7;
          *puVar7 = uVar1;
          puVar4 = puVar4 + -1;
          if (puVar4 != puVar8 + -1) {
            uVar1 = *puVar4;
            *puVar4 = puVar8[-1];
            puVar8[-1] = uVar1;
          }
        }
        puVar9 = puVar10 + -2;
        puVar5 = puVar6;
        local_c = puVar9;
        if (puVar7 != puVar9) {
          uVar1 = *puVar7;
          *puVar7 = *puVar9;
          *puVar9 = uVar1;
          puVar8 = puVar8 + -1;
          if (puVar8 != puVar10 + -1) {
            uVar1 = *puVar8;
            *puVar8 = puVar10[-1];
            puVar10[-1] = uVar1;
          }
        }
      }
      else {
        puVar5 = puVar6 + 2;
        puVar7 = puVar8;
        puVar9 = puVar10;
        if (puVar6 != puVar3) {
          uVar1 = *puVar6;
          *puVar6 = *puVar3;
          *puVar3 = uVar1;
          puVar6 = puVar6 + 1;
          if (puVar6 != puVar4 + -1) {
            uVar1 = *puVar6;
            *puVar6 = puVar4[-1];
            puVar4[-1] = uVar1;
          }
        }
      }
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
00425ed0 : PUSH EBP
00425ed1 : MOV EBP,ESP
00425ed3 : SUB ESP,0xc
00425ed6 : MOV ECX,dword ptr [EBP + 0xc]
00425ed9 : PUSH EBX
00425eda : MOV EBX,dword ptr [EBP + 0x14]
00425edd : PUSH ESI
00425ede : PUSH EDI
00425edf : MOV EDI,dword ptr [EBP + 0x10]
00425ee2 : MOV EAX,EDI
00425ee4 : SUB EAX,ECX
00425ee6 : SAR EAX,0x3
00425ee9 : CDQ
00425eea : SUB EAX,EDX
00425eec : SAR EAX,0x1
00425eee : LEA ESI,[ECX + EAX*0x8]
00425ef1 : PUSH EBX
00425ef2 : LEA EAX,[EDI + -0x8]
00425ef5 : PUSH EAX
00425ef6 : PUSH ESI
00425ef7 : PUSH ECX
00425ef8 : CALL 0x004261c0
00425efd : ADD ESP,0x10
00425f00 : LEA EDI,[ESI + 0x8]
00425f03 : MOV dword ptr [EBP + -0x8],EDI
00425f06 : CMP dword ptr [EBP + 0xc],ESI
00425f09 : JNC 0x00425f48
00425f0b : JMP 0x00425f10
00425f10 : MOV EAX,dword ptr [ESI + 0x4]
00425f13 : MOV ECX,dword ptr [ESI]
00425f15 : MOV EDX,dword ptr [ESI + -0x4]
00425f18 : PUSH EAX
00425f19 : MOV EAX,dword ptr [ESI + -0x8]
00425f1c : PUSH ECX
00425f1d : PUSH EDX
00425f1e : PUSH EAX
00425f1f : CALL EBX
00425f21 : ADD ESP,0x10
00425f24 : TEST AL,AL
00425f26 : JNZ 0x00425f48
00425f28 : MOV ECX,dword ptr [ESI + -0x4]
00425f2b : MOV EDX,dword ptr [ESI + -0x8]
00425f2e : MOV EAX,dword ptr [ESI + 0x4]
00425f31 : PUSH ECX
00425f32 : MOV ECX,dword ptr [ESI]
00425f34 : PUSH EDX
00425f35 : PUSH EAX
00425f36 : PUSH ECX
00425f37 : CALL EBX
00425f39 : ADD ESP,0x10
00425f3c : TEST AL,AL
00425f3e : JNZ 0x00425f48
00425f40 : ADD ESI,-0x8
00425f43 : CMP dword ptr [EBP + 0xc],ESI
00425f46 : JC 0x00425f10
00425f48 : CMP EDI,dword ptr [EBP + 0x10]
00425f4b : JNC 0x00425f89
00425f4d : LEA ECX,[ECX]
00425f50 : MOV EDX,dword ptr [ESI + 0x4]
00425f53 : MOV EAX,dword ptr [ESI]
00425f55 : MOV ECX,dword ptr [EDI + 0x4]
00425f58 : PUSH EDX
00425f59 : MOV EDX,dword ptr [EDI]
00425f5b : PUSH EAX
00425f5c : PUSH ECX
00425f5d : PUSH EDX
00425f5e : CALL EBX
00425f60 : ADD ESP,0x10
00425f63 : TEST AL,AL
00425f65 : JNZ 0x00425f89
00425f67 : MOV EAX,dword ptr [EDI + 0x4]
00425f6a : MOV ECX,dword ptr [EDI]
00425f6c : MOV EDX,dword ptr [ESI + 0x4]
00425f6f : PUSH EAX
00425f70 : MOV EAX,dword ptr [ESI]
00425f72 : PUSH ECX
00425f73 : PUSH EDX
00425f74 : PUSH EAX
00425f75 : CALL EBX
00425f77 : ADD ESP,0x10
00425f7a : TEST AL,AL
00425f7c : JNZ 0x00425f89
00425f7e : ADD EDI,0x8
00425f81 : MOV dword ptr [EBP + -0x8],EDI
00425f84 : CMP EDI,dword ptr [EBP + 0x10]
00425f87 : JC 0x00425f50
00425f89 : MOV EDX,ESI
00425f8b : MOV EBX,EDI
00425f8d : MOV dword ptr [EBP + -0x4],EDX
00425f90 : JMP 0x00425f95
00425f92 : MOV EDX,dword ptr [EBP + -0x4]
00425f95 : CMP EBX,dword ptr [EBP + 0x10]
00425f98 : JNC 0x00426008
00425f9a : LEA ECX,[EBX + 0x4]
00425f9d : MOV dword ptr [EBP + -0xc],ECX
00425fa0 : MOV EDX,dword ptr [EBX + 0x4]
00425fa3 : MOV EAX,dword ptr [EBX]
00425fa5 : MOV ECX,dword ptr [ESI + 0x4]
00425fa8 : PUSH EDX
00425fa9 : MOV EDX,dword ptr [ESI]
00425fab : PUSH EAX
00425fac : PUSH ECX
00425fad : PUSH EDX
00425fae : CALL dword ptr [EBP + 0x14]
00425fb1 : ADD ESP,0x10
00425fb4 : TEST AL,AL
00425fb6 : JNZ 0x00425ff9
00425fb8 : MOV EAX,dword ptr [ESI + 0x4]
00425fbb : MOV ECX,dword ptr [ESI]
00425fbd : MOV EDX,dword ptr [EBX + 0x4]
00425fc0 : PUSH EAX
00425fc1 : MOV EAX,dword ptr [EBX]
00425fc3 : PUSH ECX
00425fc4 : PUSH EDX
00425fc5 : PUSH EAX
00425fc6 : CALL dword ptr [EBP + 0x14]
00425fc9 : ADD ESP,0x10
00425fcc : TEST AL,AL
00425fce : JNZ 0x00426005
00425fd0 : MOV EAX,EDI
00425fd2 : ADD EDI,0x8
00425fd5 : MOV dword ptr [EBP + -0x8],EDI
00425fd8 : CMP EAX,EBX
00425fda : JZ 0x00425ff9
00425fdc : MOV EDX,dword ptr [EBX]
00425fde : MOV ECX,dword ptr [EAX]
00425fe0 : MOV dword ptr [EAX],EDX
00425fe2 : MOV EDX,dword ptr [EBP + -0xc]
00425fe5 : ADD EAX,0x4
00425fe8 : MOV dword ptr [EBX],ECX
00425fea : CMP EAX,EDX
00425fec : JZ 0x00425ff9
00425fee : MOV ECX,dword ptr [EAX]
00425ff0 : MOV EDX,dword ptr [EDX]
00425ff2 : MOV dword ptr [EAX],EDX
00425ff4 : MOV EAX,dword ptr [EBP + -0xc]
00425ff7 : MOV dword ptr [EAX],ECX
00425ff9 : ADD dword ptr [EBP + -0xc],0x8
00425ffd : ADD EBX,0x8
00426000 : CMP EBX,dword ptr [EBP + 0x10]
00426003 : JC 0x00425fa0
00426005 : MOV EDX,dword ptr [EBP + -0x4]
00426008 : CMP EDX,dword ptr [EBP + 0xc]
0042600b : JBE 0x00426089
0042600d : LEA ECX,[ESI + 0x4]
00426010 : MOV dword ptr [EBP + -0xc],ECX
00426013 : LEA EDI,[EDX + -0x4]
00426016 : MOV EDX,dword ptr [ESI + 0x4]
00426019 : MOV EAX,dword ptr [ESI]
0042601b : MOV ECX,dword ptr [EDI]
0042601d : PUSH EDX
0042601e : MOV EDX,dword ptr [EDI + -0x4]
00426021 : PUSH EAX
00426022 : PUSH ECX
00426023 : PUSH EDX
00426024 : CALL dword ptr [EBP + 0x14]
00426027 : ADD ESP,0x10
0042602a : TEST AL,AL
0042602c : JNZ 0x0042606f
0042602e : MOV EAX,dword ptr [EDI]
00426030 : MOV ECX,dword ptr [EDI + -0x4]
00426033 : MOV EDX,dword ptr [ESI + 0x4]
00426036 : PUSH EAX
00426037 : MOV EAX,dword ptr [ESI]
00426039 : PUSH ECX
0042603a : PUSH EDX
0042603b : PUSH EAX
0042603c : CALL dword ptr [EBP + 0x14]
0042603f : ADD ESP,0x10
00426042 : TEST AL,AL
00426044 : JNZ 0x00426080
00426046 : MOV EAX,dword ptr [EBP + -0xc]
00426049 : SUB ESI,0x8
0042604c : SUB EAX,0x8
0042604f : LEA ECX,[EDI + -0x4]
00426052 : MOV dword ptr [EBP + -0xc],EAX
00426055 : CMP ESI,ECX
00426057 : JZ 0x0042606f
00426059 : MOV EDX,dword ptr [EDI + -0x4]
0042605c : MOV ECX,dword ptr [ESI]
0042605e : MOV dword ptr [ESI],EDX
00426060 : MOV dword ptr [EDI + -0x4],ECX
00426063 : CMP EAX,EDI
00426065 : JZ 0x0042606f
00426067 : MOV EDX,dword ptr [EDI]
00426069 : MOV ECX,dword ptr [EAX]
0042606b : MOV dword ptr [EAX],EDX
0042606d : MOV dword ptr [EDI],ECX
0042606f : MOV EAX,dword ptr [EBP + -0x4]
00426072 : SUB EAX,0x8
00426075 : SUB EDI,0x8
00426078 : MOV dword ptr [EBP + -0x4],EAX
0042607b : CMP dword ptr [EBP + 0xc],EAX
0042607e : JC 0x00426016
00426080 : MOV EDX,dword ptr [EBP + -0x4]
00426083 : MOV EDI,dword ptr [EBP + -0x8]
00426086 : CMP EDX,dword ptr [EBP + 0xc]
00426089 : JNZ 0x00426105
0042608b : CMP EBX,dword ptr [EBP + 0x10]
0042608e : JZ 0x004261b0
00426094 : CMP EDI,EBX
00426096 : JZ 0x004260be
00426098 : CMP ESI,EDI
0042609a : JZ 0x004260be
0042609c : MOV ECX,dword ptr [EDI]
0042609e : MOV EAX,dword ptr [ESI]
004260a0 : MOV dword ptr [ESI],ECX
004260a2 : MOV dword ptr [EDI],EAX
004260a4 : LEA ECX,[EDI + 0x4]
004260a7 : LEA EAX,[ESI + 0x4]
004260aa : CMP EAX,ECX
004260ac : JZ 0x004260be
004260ae : MOV ECX,dword ptr [EAX]
004260b0 : MOV dword ptr [EBP + -0xc],ECX
004260b3 : MOV ECX,dword ptr [EDI + 0x4]
004260b6 : MOV dword ptr [EAX],ECX
004260b8 : MOV EAX,dword ptr [EBP + -0xc]
004260bb : MOV dword ptr [EDI + 0x4],EAX
004260be : MOV EAX,EBX
004260c0 : MOV ECX,ESI
004260c2 : ADD EDI,0x8
004260c5 : ADD EBX,0x8
004260c8 : ADD ESI,0x8
004260cb : MOV dword ptr [EBP + -0x8],EDI
004260ce : CMP ECX,EAX
004260d0 : JZ 0x00425f95
004260d6 : MOV EDX,dword ptr [ECX]
004260d8 : MOV dword ptr [EBP + -0xc],EDX
004260db : MOV EDX,dword ptr [EAX]
004260dd : MOV dword ptr [ECX],EDX
004260df : MOV EDX,dword ptr [EBP + -0xc]
004260e2 : MOV dword ptr [EAX],EDX
004260e4 : ADD EAX,0x4
004260e7 : ADD ECX,0x4
004260ea : CMP ECX,EAX
004260ec : JZ 0x00425f92
004260f2 : MOV EDX,dword ptr [ECX]
004260f4 : MOV dword ptr [EBP + -0xc],EDX
004260f7 : MOV EDX,dword ptr [EAX]
004260f9 : MOV dword ptr [ECX],EDX
004260fb : MOV ECX,dword ptr [EBP + -0xc]
004260fe : MOV dword ptr [EAX],ECX
00426100 : JMP 0x00425f92
00426105 : SUB EDX,0x8
00426108 : MOV dword ptr [EBP + -0x4],EDX
0042610b : CMP EBX,dword ptr [EBP + 0x10]
0042610e : JNZ 0x00426172
00426110 : SUB ESI,0x8
00426113 : CMP EDX,ESI
00426115 : JZ 0x00426139
00426117 : MOV ECX,dword ptr [ESI]
00426119 : MOV EAX,dword ptr [EDX]
0042611b : MOV dword ptr [EDX],ECX
0042611d : MOV dword ptr [ESI],EAX
0042611f : LEA ECX,[ESI + 0x4]
00426122 : LEA EAX,[EDX + 0x4]
00426125 : CMP EAX,ECX
00426127 : JZ 0x00426139
00426129 : MOV ECX,dword ptr [EAX]
0042612b : MOV dword ptr [EBP + -0xc],ECX
0042612e : MOV ECX,dword ptr [ESI + 0x4]
00426131 : MOV dword ptr [EAX],ECX
00426133 : MOV EAX,dword ptr [EBP + -0xc]
00426136 : MOV dword ptr [ESI + 0x4],EAX
00426139 : SUB EDI,0x8
0042613c : MOV dword ptr [EBP + -0x8],EDI
0042613f : CMP ESI,EDI
00426141 : JZ 0x00425f95
00426147 : MOV ECX,dword ptr [EDI]
00426149 : MOV EAX,dword ptr [ESI]
0042614b : MOV dword ptr [ESI],ECX
0042614d : MOV dword ptr [EDI],EAX
0042614f : LEA ECX,[EDI + 0x4]
00426152 : LEA EAX,[ESI + 0x4]
00426155 : CMP EAX,ECX
00426157 : JZ 0x00425f95
0042615d : MOV ECX,dword ptr [EAX]
0042615f : MOV dword ptr [EBP + -0xc],ECX
00426162 : MOV ECX,dword ptr [EDI + 0x4]
00426165 : MOV dword ptr [EAX],ECX
00426167 : MOV EAX,dword ptr [EBP + -0xc]
0042616a : MOV dword ptr [EDI + 0x4],EAX
0042616d : JMP 0x00425f95
00426172 : MOV EAX,EBX
00426174 : ADD EBX,0x8
00426177 : CMP EAX,EDX
00426179 : JZ 0x00425f95
0042617f : MOV ECX,dword ptr [EAX]
00426181 : MOV dword ptr [EBP + -0xc],ECX
00426184 : MOV ECX,dword ptr [EDX]
00426186 : MOV dword ptr [EAX],ECX
00426188 : MOV ECX,dword ptr [EBP + -0xc]
0042618b : MOV dword ptr [EDX],ECX
0042618d : LEA ECX,[EDX + 0x4]
00426190 : ADD EAX,0x4
00426193 : CMP EAX,ECX
00426195 : JZ 0x00425f95
0042619b : MOV ECX,dword ptr [EAX]
0042619d : MOV dword ptr [EBP + -0xc],ECX
004261a0 : MOV ECX,dword ptr [EDX + 0x4]
004261a3 : MOV dword ptr [EAX],ECX
004261a5 : MOV EAX,dword ptr [EBP + -0xc]
004261a8 : MOV dword ptr [EDX + 0x4],EAX
004261ab : JMP 0x00425f95
004261b0 : MOV EAX,dword ptr [EBP + 0x8]
004261b3 : MOV dword ptr [EAX + 0x4],EDI
004261b6 : POP EDI
004261b7 : MOV dword ptr [EAX],ESI
004261b9 : POP ESI
004261ba : POP EBX
004261bb : MOV ESP,EBP
004261bd : POP EBP
004261be : RET

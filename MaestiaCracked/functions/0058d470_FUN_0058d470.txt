PROGRAM  : Maestia.exe
FUNCTION : FUN_0058d470
ENTRY    : 0058d470
BODY     : [[0058d470, 0058d644]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0058d470(int param_1)

{
  int *piVar1;
  undefined1 *puVar2;
  float fVar3;
  int iVar4;
  int iVar5;
  int *piVar6;
  GMatrix2D *this;
  float10 fVar7;
  int iStack_78;
  undefined8 uStack_74;
  float fStack_6c;
  undefined1 *puStack_68;
  char cStack_50;
  undefined1 auStack_44 [4];
  char cStack_40;
  undefined1 local_38;
  undefined1 auStack_30 [8];
  undefined1 local_28 [4];
  undefined1 auStack_24 [16];
  undefined1 auStack_14 [20];
  
  iVar4 = param_1;
  puVar2 = *(undefined1 **)(param_1 + 4);
  FUN_00526400();
  *puVar2 = 0;
  if (*(int **)(param_1 + 8) == (int *)0x0) {
    param_1 = *(int *)(*(int *)(param_1 + 0x18) + 0x74);
  }
  else {
    iVar5 = (**(code **)(**(int **)(param_1 + 8) + 8))();
    if (iVar5 != 2) {
      return;
    }
    if (*(int *)(param_1 + 8) == 0) {
      return;
    }
    param_1 = *(int *)(param_1 + 8) + -0x68;
  }
  if ((param_1 != 0) && (0 < *(int *)(iVar4 + 0x1c))) {
    puStack_68 = *(undefined1 **)(iVar4 + 0x18);
    fStack_6c = 0.0;
    piVar1 = (int *)(puStack_68 + 0x78);
    uStack_74 = (double)CONCAT44(0x58d4e1,(undefined4)uStack_74);
    FUN_00526260();
    fStack_6c = 8.1579e-39;
    piVar6 = (int *)FUN_005270f0();
    if (piVar6 != (int *)0x0) {
      local_28[0] = 0;
      local_38 = 0;
      puStack_68 = local_28;
      fStack_6c = (float)(*piVar1 + 0x1ec);
      uStack_74._0_4_ = 0x58d512;
      uStack_74._4_4_ = piVar1;
      (**(code **)(*piVar6 + 0x2c))();
      uStack_74 = (double)CONCAT44(uStack_74._4_4_,auStack_44);
      iStack_78 = *piVar1 + 0x1f0;
      (**(code **)(*piVar6 + 0x2c))(piVar1);
      if (((cStack_40 == '\x03') || (cStack_40 == '\x04')) &&
         ((cStack_50 == '\x03' || (cStack_50 == '\x04')))) {
        fVar7 = (float10)FUN_00527730(*(undefined4 *)(iVar4 + 0x18));
        puStack_68 = (undefined1 *)(float)fVar7;
        fVar7 = (float10)FUN_00527730(*(undefined4 *)(iVar4 + 0x18));
        fStack_6c = (float)fVar7;
        this = (GMatrix2D *)FUN_0050aa60(auStack_30);
        GMatrix2D::Transform(this,(GPoint<float> *)&puStack_68,(GPoint<float> *)&stack0xffffffa8);
        fVar3 = (float)puStack_68 / 20.0;
        puStack_68 = (undefined1 *)CONCAT31(puStack_68._1_3_,3);
        auStack_14[0] = 0;
        (**(code **)(*piVar6 + 0x28))(piVar1,*piVar1 + 0x1ec,&puStack_68,auStack_14);
        FUN_00526bc0();
        iStack_78 = CONCAT31(iStack_78._1_3_,3);
        auStack_24[0] = 0;
        uStack_74 = (double)(SUB84((double)fVar3,0) / 20.0);
        (**(code **)(*piVar6 + 0x28))(piVar1,*piVar1 + 0x1f0,&iStack_78,auStack_24);
        FUN_00526bc0();
      }
      FUN_00526bc0();
      FUN_00526bc0();
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
0058d470 : SUB ESP,0x54
0058d473 : PUSH EBX
0058d474 : PUSH EBP
0058d475 : MOV EBP,dword ptr [ESP + 0x60]
0058d479 : PUSH ESI
0058d47a : MOV ESI,dword ptr [EBP + 0x4]
0058d47d : MOV ECX,ESI
0058d47f : CALL 0x00526400
0058d484 : XOR EBX,EBX
0058d486 : MOV byte ptr [ESI],BL
0058d488 : MOV ECX,dword ptr [EBP + 0x8]
0058d48b : CMP ECX,EBX
0058d48d : JNZ 0x0058d49b
0058d48f : MOV EAX,dword ptr [EBP + 0x18]
0058d492 : MOV ECX,dword ptr [EAX + 0x74]
0058d495 : MOV dword ptr [ESP + 0x64],ECX
0058d499 : JMP 0x0058d4bd
0058d49b : MOV EDX,dword ptr [ECX]
0058d49d : MOV EAX,dword ptr [EDX + 0x8]
0058d4a0 : CALL EAX
0058d4a2 : CMP EAX,0x2
0058d4a5 : JNZ 0x0058d63e
0058d4ab : MOV EAX,dword ptr [EBP + 0x8]
0058d4ae : CMP EAX,EBX
0058d4b0 : JZ 0x0058d63e
0058d4b6 : ADD EAX,-0x68
0058d4b9 : MOV dword ptr [ESP + 0x64],EAX
0058d4bd : CMP dword ptr [ESP + 0x64],EBX
0058d4c1 : JZ 0x0058d63e
0058d4c7 : CMP dword ptr [EBP + 0x1c],0x1
0058d4cb : JL 0x0058d63e
0058d4d1 : MOV EAX,dword ptr [EBP + 0x18]
0058d4d4 : PUSH EDI
0058d4d5 : PUSH EAX
0058d4d6 : PUSH EBX
0058d4d7 : MOV ECX,EBP
0058d4d9 : LEA EDI,[EAX + 0x78]
0058d4dc : CALL 0x00526260
0058d4e1 : MOV ECX,EAX
0058d4e3 : CALL 0x005270f0
0058d4e8 : MOV ESI,EAX
0058d4ea : CMP ESI,EBX
0058d4ec : JZ 0x0058d63d
0058d4f2 : MOV byte ptr [ESP + 0x3c],BL
0058d4f6 : MOV byte ptr [ESP + 0x2c],BL
0058d4fa : MOV ECX,dword ptr [EDI]
0058d4fc : MOV EDX,dword ptr [ESI]
0058d4fe : MOV EDX,dword ptr [EDX + 0x2c]
0058d501 : LEA EAX,[ESP + 0x3c]
0058d505 : PUSH EAX
0058d506 : ADD ECX,0x1ec
0058d50c : PUSH ECX
0058d50d : PUSH EDI
0058d50e : MOV ECX,ESI
0058d510 : CALL EDX
0058d512 : MOV EDX,dword ptr [EDI]
0058d514 : MOV EAX,dword ptr [ESI]
0058d516 : MOV EAX,dword ptr [EAX + 0x2c]
0058d519 : LEA ECX,[ESP + 0x2c]
0058d51d : PUSH ECX
0058d51e : ADD EDX,0x1f0
0058d524 : PUSH EDX
0058d525 : PUSH EDI
0058d526 : MOV ECX,ESI
0058d528 : CALL EAX
0058d52a : MOV AL,byte ptr [ESP + 0x3c]
0058d52e : CMP AL,0x3
0058d530 : JZ 0x0058d53a
0058d532 : CMP AL,0x4
0058d534 : JNZ 0x0058d62b
0058d53a : MOV AL,byte ptr [ESP + 0x2c]
0058d53e : CMP AL,0x3
0058d540 : JZ 0x0058d54a
0058d542 : CMP AL,0x4
0058d544 : JNZ 0x0058d62b
0058d54a : MOV ECX,dword ptr [EBP + 0x18]
0058d54d : PUSH ECX
0058d54e : LEA ECX,[ESP + 0x30]
0058d552 : CALL 0x00527730
0058d557 : FSTP float ptr [ESP + 0x14]
0058d55b : MOV EDX,dword ptr [EBP + 0x18]
0058d55e : PUSH EDX
0058d55f : LEA ECX,[ESP + 0x40]
0058d563 : CALL 0x00527730
0058d568 : FSTP float ptr [ESP + 0x10]
0058d56c : FLD float ptr [ESP + 0x10]
0058d570 : MOV ECX,dword ptr [ESP + 0x68]
0058d574 : FLD double ptr [0x00b86058]
0058d57a : LEA EAX,[ESP + 0x4c]
0058d57e : FMUL ST1
0058d580 : PUSH EAX
0058d581 : FXCH
0058d583 : FSTP float ptr [ESP + 0x28]
0058d587 : FMUL float ptr [ESP + 0x18]
0058d58b : FSTP float ptr [ESP + 0x2c]
0058d58f : CALL 0x0050aa60
0058d594 : LEA ECX,[ESP + 0x24]
0058d598 : PUSH ECX
0058d599 : LEA EDX,[ESP + 0x18]
0058d59d : PUSH EDX
0058d59e : MOV ECX,EAX
0058d5a0 : CALL 0x00522c50
0058d5a5 : FLD float ptr [ESP + 0x14]
0058d5a9 : FST float ptr [ESP + 0x24]
0058d5ad : LEA ECX,[ESP + 0x68]
0058d5b1 : FLD float ptr [ESP + 0x18]
0058d5b5 : PUSH ECX
0058d5b6 : FSTP float ptr [ESP + 0x2c]
0058d5ba : MOV ECX,dword ptr [EDI]
0058d5bc : MOV EAX,dword ptr [ESI]
0058d5be : FDIV double ptr [0x00b86058]
0058d5c4 : LEA EDX,[ESP + 0x18]
0058d5c8 : PUSH EDX
0058d5c9 : MOV EDX,dword ptr [EAX + 0x28]
0058d5cc : ADD ECX,0x1ec
0058d5d2 : PUSH ECX
0058d5d3 : PUSH EDI
0058d5d4 : MOV ECX,ESI
0058d5d6 : MOV byte ptr [ESP + 0x24],0x3
0058d5db : MOV byte ptr [ESP + 0x78],BL
0058d5df : FSTP double ptr [ESP + 0x28]
0058d5e3 : CALL EDX
0058d5e5 : LEA ECX,[ESP + 0x14]
0058d5e9 : CALL 0x00526bc0
0058d5ee : FLD float ptr [ESP + 0x28]
0058d5f2 : FDIV double ptr [0x00b86058]
0058d5f8 : MOV EAX,dword ptr [ESI]
0058d5fa : LEA ECX,[ESP + 0x68]
0058d5fe : PUSH ECX
0058d5ff : MOV ECX,dword ptr [EDI]
0058d601 : LEA EDX,[ESP + 0x18]
0058d605 : PUSH EDX
0058d606 : MOV EDX,dword ptr [EAX + 0x28]
0058d609 : ADD ECX,0x1f0
0058d60f : PUSH ECX
0058d610 : PUSH EDI
0058d611 : MOV ECX,ESI
0058d613 : MOV byte ptr [ESP + 0x24],0x3
0058d618 : MOV byte ptr [ESP + 0x78],BL
0058d61c : FSTP double ptr [ESP + 0x28]
0058d620 : CALL EDX
0058d622 : LEA ECX,[ESP + 0x14]
0058d626 : CALL 0x00526bc0
0058d62b : LEA ECX,[ESP + 0x2c]
0058d62f : CALL 0x00526bc0
0058d634 : LEA ECX,[ESP + 0x3c]
0058d638 : CALL 0x00526bc0
0058d63d : POP EDI
0058d63e : POP ESI
0058d63f : POP EBP
0058d640 : POP EBX
0058d641 : ADD ESP,0x54
0058d644 : RET

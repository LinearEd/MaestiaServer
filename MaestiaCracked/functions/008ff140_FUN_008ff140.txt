PROGRAM  : Maestia.exe
FUNCTION : FUN_008ff140
ENTRY    : 008ff140
BODY     : [[008ff140, 008ff1d6] [008ff1e0, 008ff606]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x008ff3a8) */

void FUN_008ff140(ushort *param_1)

{
  undefined1 *puVar1;
  ushort uVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  ushort *puVar6;
  uint uVar7;
  undefined4 uVar8;
  int *piVar9;
  int *in_ECX;
  int iVar10;
  byte bVar11;
  ushort *puVar12;
  ushort *puVar13;
  uint uVar14;
  double dVar15;
  undefined4 local_258;
  undefined4 uStack_254;
  _SYSTEMTIME local_250;
  uint local_240;
  uint local_23c;
  int *local_238;
  uint local_234;
  int local_230;
  ushort *local_22c;
  int local_228;
  uint local_224;
  ushort *local_220;
  undefined1 local_21a;
  undefined1 local_219;
  char local_218 [256];
  char local_118 [256];
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b600ff;
  local_10 = ExceptionList;
  uVar5 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_22c = param_1;
  local_238 = in_ECX;
  local_18 = uVar5;
  if (*(char *)((int)in_ECX + 0x32) == '\0') {
    (**(code **)(*in_ECX + 0x18))(1,300);
    piVar9 = in_ECX + 0xe;
    for (iVar10 = 0x102; iVar10 != 0; iVar10 = iVar10 + -1) {
      *piVar9 = *(int *)param_1;
      param_1 = param_1 + 2;
      piVar9 = piVar9 + 1;
    }
  }
  else {
    puVar13 = param_1 + 4;
    local_228 = 0;
    if (*(char *)((int)param_1 + 7) != '\0') {
      local_230 = 1;
      local_234 = (*param_1 & 0x1fff) - 8;
      do {
        if ((((puVar13 == (ushort *)0x0) || (local_234 < 2)) || ((short)*puVar13 < 0)) ||
           (iVar10 = (int)(short)*puVar13, (int)local_234 < iVar10 + 2)) {
          local_220 = (ushort *)0x0;
LAB_008ff2aa:
          local_234 = 0;
          puVar13 = (ushort *)0x0;
        }
        else {
          local_220 = puVar13 + 1;
          puVar1 = (undefined1 *)((int)puVar13 + iVar10 + 2);
          iVar10 = local_234 + (-2 - iVar10);
          if ((puVar1 == (undefined1 *)0x0) || (iVar10 == 0)) goto LAB_008ff2aa;
          local_219 = *puVar1;
          if ((puVar1 + 1 == (undefined1 *)0x0) || (iVar10 == 1)) goto LAB_008ff2aa;
          local_21a = puVar1[1];
          if (((uint *)(puVar1 + 2) == (uint *)0x0) || (iVar10 - 2U < 4)) goto LAB_008ff2aa;
          local_23c = *(uint *)(puVar1 + 2);
          if (((ushort *)(puVar1 + 6) == (ushort *)0x0) || (iVar10 - 6U < 2)) goto LAB_008ff2aa;
          local_240 = (uint)*(ushort *)(puVar1 + 6);
          if (((undefined4 *)(puVar1 + 8) == (undefined4 *)0x0) || (iVar10 - 8U < 8))
          goto LAB_008ff2aa;
          local_258 = *(undefined4 *)(puVar1 + 8);
          uStack_254 = *(undefined4 *)(puVar1 + 0xc);
          local_234 = iVar10 - 0x10;
          puVar13 = (ushort *)(puVar1 + 0x10);
        }
        dVar15 = (double)((float)(local_240 & 0xffff) * 0.01);
        __snprintf(local_118,0x100,"%02d:%02d:%02d (%.f%%)",local_23c / 0xe10,
                   (local_23c / 0x3c) % 0x3c,local_23c % 0x3c,SUB84(dVar15,0),
                   (int)((ulonglong)dVar15 >> 0x20),uVar5);
        VariantTimeToSystemTime((DOUBLE)CONCAT44(uStack_254,local_258),&local_250);
        __snprintf(local_218,0x100,"%d-%02d-%02d %02d:%02d",(uint)local_250.wYear,
                   (uint)local_250.wMonth,(uint)local_250.wDay,(uint)local_250.wHour,
                   (uint)local_250.wSecond);
        iVar10 = *(int *)(DAT_0172491c + 0x17c);
        puVar6 = local_220;
        do {
          uVar2 = *puVar6;
          puVar6 = puVar6 + 1;
        } while (uVar2 != 0);
        uVar7 = (int)puVar6 - (int)(local_220 + 1) >> 1;
        uVar3 = *(uint *)(iVar10 + 0x20);
        uVar14 = uVar3;
        if (uVar7 <= uVar3) {
          uVar14 = uVar7;
        }
        puVar6 = local_220;
        if (*(uint *)(iVar10 + 0x24) < 8) {
          puVar12 = (ushort *)(iVar10 + 0x10);
        }
        else {
          puVar12 = *(ushort **)(iVar10 + 0x10);
        }
        for (; uVar14 != 0; uVar14 = uVar14 - 1) {
          if (*puVar12 != *puVar6) {
            uVar14 = (-(uint)(*puVar12 < *puVar6) & 0xfffffffe) + 1;
            if (uVar14 != 0) goto LAB_008ff40c;
            break;
          }
          puVar12 = puVar12 + 1;
          puVar6 = puVar6 + 1;
        }
        if (uVar3 < uVar7) {
          uVar14 = 0xffffffff;
        }
        else {
          uVar14 = (uint)(uVar3 != uVar7);
        }
LAB_008ff40c:
        local_224 = (uint)(uVar14 == 0);
        uVar8 = FUN_008fd6d0();
        iVar4 = local_230;
        iVar10 = *DAT_00da9894;
        if ((iVar10 != 0) && (*(int *)(iVar10 + 0x114) != 0)) {
          (**(code **)(**(int **)(iVar10 + 0x114) + 4))
                    (*(int **)(iVar10 + 0x114),"mc_timeattackrank.AddRank",
                     "%d,%d,%ls,%d,%d,%s,%s,%d,%d",local_230,local_230,local_220,local_219,local_21a
                     ,local_118,local_218,local_224,uVar8);
        }
        if (((local_224 != 0) && (iVar10 = *DAT_00da9894, iVar10 != 0)) &&
           (*(int *)(iVar10 + 0x114) != 0)) {
          (**(code **)(**(int **)(iVar10 + 0x114) + 4))
                    (*(int **)(iVar10 + 0x114),"mc_timeattackrank.AddRank",
                     "%d,%d,%ls,%d,%d,%s,%s,%d,%d",0xb,iVar4,local_220,local_219,local_21a,local_118
                     ,local_218,1,uVar8);
        }
        if ((local_228 != 0) || (local_228 = 0, local_224 != 0)) {
          local_228 = 1;
        }
        local_230 = iVar4 + 1;
      } while (iVar4 < (int)(uint)*(byte *)((int)local_22c + 7));
    }
    piVar9 = local_238;
    local_238[0x111] = (uint)*(byte *)((int)local_22c + 7);
    if (*(ushort *)(local_238 + 0x110) != local_22c[2]) {
      *(ushort *)(local_238 + 0x110) = local_22c[2];
      FUN_008fe000(local_238);
    }
    if (local_228 == 0) {
      iVar10 = *(int *)ThreadLocalStoragePointer;
      bVar11 = (byte)((ulonglong)(*(byte *)(iVar10 + 0x18) + 1) % 3);
      *(byte *)(iVar10 + 0x18) = bVar11;
      local_238 = (int *)((uint)bVar11 * 0x2000 + 0x122cb8 + iVar10);
      if (local_238 == (int *)0x0) {
        piVar9 = (int *)0x0;
      }
      else {
        iVar10 = piVar9[0x110];
        *(undefined2 *)local_238 = 0;
        *(undefined1 *)((int)local_238 + 2) = 0x3f;
        *(undefined1 *)((int)local_238 + 3) = 0x13;
        *(short *)(local_238 + 1) = (short)iVar10;
        piVar9 = local_238;
      }
      local_8 = 0xffffffff;
      if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
        FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),6,(uint8_t *)piVar9);
      }
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008ff140 : PUSH EBP
008ff141 : MOV EBP,ESP
008ff143 : PUSH -0x1
008ff145 : PUSH 0xb600ff
008ff14a : MOV EAX,FS:[0x0]
008ff150 : PUSH EAX
008ff151 : SUB ESP,0x248
008ff157 : MOV EAX,[0x00d66fa0]
008ff15c : XOR EAX,EBP
008ff15e : MOV dword ptr [EBP + -0x14],EAX
008ff161 : PUSH EBX
008ff162 : PUSH ESI
008ff163 : PUSH EDI
008ff164 : PUSH EAX
008ff165 : LEA EAX,[EBP + -0xc]
008ff168 : MOV FS:[0x0],EAX
008ff16e : MOV EBX,dword ptr [EBP + 0x8]
008ff171 : MOV EDI,ECX
008ff173 : MOV AL,byte ptr [EDI + 0x32]
008ff176 : MOV dword ptr [EBP + 0xfffffdcc],EDI
008ff17c : MOV dword ptr [EBP + 0xfffffdd8],EBX
008ff182 : TEST AL,AL
008ff184 : JNZ 0x008ff1a5
008ff186 : MOV EAX,dword ptr [EDI]
008ff188 : MOV EDX,dword ptr [EAX + 0x18]
008ff18b : PUSH 0x12c
008ff190 : PUSH 0x1
008ff192 : CALL EDX
008ff194 : ADD EDI,0x38
008ff197 : MOV ECX,0x102
008ff19c : MOV ESI,EBX
008ff19e : MOVSD.REP ES:EDI,ESI
008ff1a0 : JMP 0x008ff5e9
008ff1a5 : MOV ECX,dword ptr [EBP + 0xfffffdd8]
008ff1ab : MOVZX EAX,word ptr [ECX]
008ff1ae : AND EAX,0x1fff
008ff1b3 : XOR ESI,ESI
008ff1b5 : ADD EBX,0x8
008ff1b8 : SUB EAX,0x8
008ff1bb : CMP byte ptr [ECX + 0x7],0x0
008ff1bf : MOV dword ptr [EBP + 0xfffffddc],ESI
008ff1c5 : JBE 0x008ff545
008ff1cb : MOV dword ptr [EBP + 0xfffffdd4],0x1
008ff1d5 : JMP 0x008ff1e6
008ff1e0 : MOV EAX,dword ptr [EBP + 0xfffffdd0]
008ff1e6 : CMP EBX,ESI
008ff1e8 : JZ 0x008ff2a4
008ff1ee : CMP EAX,0x2
008ff1f1 : JC 0x008ff2a4
008ff1f7 : MOVZX ECX,word ptr [EBX]
008ff1fa : CMP CX,SI
008ff1fd : JL 0x008ff2a4
008ff203 : MOVSX ECX,CX
008ff206 : LEA EDX,[ECX + 0x2]
008ff209 : CMP EAX,EDX
008ff20b : JL 0x008ff2a4
008ff211 : LEA EDX,[EBX + 0x2]
008ff214 : MOV dword ptr [EBP + 0xfffffde4],EDX
008ff21a : MOV EDX,0xfffffffe
008ff21f : SUB EDX,ECX
008ff221 : LEA EBX,[EBX + ECX*0x1 + 0x2]
008ff225 : ADD EAX,EDX
008ff227 : CMP EBX,ESI
008ff229 : JZ 0x008ff2aa
008ff22b : CMP EAX,0x1
008ff22e : JC 0x008ff2aa
008ff230 : MOV CL,byte ptr [EBX]
008ff232 : INC EBX
008ff233 : DEC EAX
008ff234 : MOV byte ptr [EBP + 0xfffffdeb],CL
008ff23a : CMP EBX,ESI
008ff23c : JZ 0x008ff2aa
008ff23e : CMP EAX,0x1
008ff241 : JC 0x008ff2aa
008ff243 : MOV DL,byte ptr [EBX]
008ff245 : INC EBX
008ff246 : DEC EAX
008ff247 : MOV byte ptr [EBP + 0xfffffdea],DL
008ff24d : CMP EBX,ESI
008ff24f : JZ 0x008ff2aa
008ff251 : CMP EAX,0x4
008ff254 : JC 0x008ff2aa
008ff256 : MOV ECX,dword ptr [EBX]
008ff258 : ADD EBX,0x4
008ff25b : SUB EAX,0x4
008ff25e : MOV dword ptr [EBP + 0xfffffdc8],ECX
008ff264 : CMP EBX,ESI
008ff266 : JZ 0x008ff2aa
008ff268 : CMP EAX,0x2
008ff26b : JC 0x008ff2aa
008ff26d : MOVZX EDX,word ptr [EBX]
008ff270 : ADD EBX,0x2
008ff273 : SUB EAX,0x2
008ff276 : MOV dword ptr [EBP + 0xfffffdc4],EDX
008ff27c : CMP EBX,ESI
008ff27e : JZ 0x008ff2aa
008ff280 : CMP EAX,0x8
008ff283 : JC 0x008ff2aa
008ff285 : MOV EDX,dword ptr [EBX]
008ff287 : MOV dword ptr [EBP + 0xfffffdac],EDX
008ff28d : MOV EDX,dword ptr [EBX + 0x4]
008ff290 : SUB EAX,0x8
008ff293 : MOV dword ptr [EBP + 0xfffffdb0],EDX
008ff299 : MOV dword ptr [EBP + 0xfffffdd0],EAX
008ff29f : ADD EBX,0x8
008ff2a2 : JMP 0x008ff2b8
008ff2a4 : MOV dword ptr [EBP + 0xfffffde4],ESI
008ff2aa : MOV ECX,dword ptr [EBP + 0xfffffdc8]
008ff2b0 : MOV dword ptr [EBP + 0xfffffdd0],ESI
008ff2b6 : XOR EBX,EBX
008ff2b8 : MOV EAX,0x88888889
008ff2bd : MUL ECX
008ff2bf : MOV EAX,EDX
008ff2c1 : MOVZX EDX,word ptr [EBP + 0xfffffdc4]
008ff2c8 : CVTSI2SS XMM0,EDX
008ff2cc : MULSS XMM0,dword ptr [0x00cdf23c]
008ff2d4 : SHR EAX,0x5
008ff2d7 : MOV EDX,EAX
008ff2d9 : SHL EDX,0x4
008ff2dc : SUB EDX,EAX
008ff2de : ADD EDX,EDX
008ff2e0 : SUB ESP,0x8
008ff2e3 : ADD EDX,EDX
008ff2e5 : MOV EDI,ECX
008ff2e7 : SUB EDI,EDX
008ff2e9 : CVTSS2SD XMM0,XMM0
008ff2ed : MOVSD qword ptr [ESP],XMM0
008ff2f2 : PUSH EDI
008ff2f3 : XOR EDX,EDX
008ff2f5 : MOV EDI,0x3c
008ff2fa : DIV EDI
008ff2fc : MOV EAX,0x91a2b3c5
008ff301 : PUSH EDX
008ff302 : MUL ECX
008ff304 : SHR EDX,0xb
008ff307 : PUSH EDX
008ff308 : PUSH 0xc62a60
008ff30d : LEA EAX,[EBP + 0xfffffeec]
008ff313 : PUSH 0x100
008ff318 : PUSH EAX
008ff319 : CALL 0x00638607
008ff31e : ADD ESP,0x20
008ff321 : FLD double ptr [EBP + 0xfffffdac]
008ff327 : LEA ECX,[EBP + 0xfffffdb4]
008ff32d : PUSH ECX
008ff32e : SUB ESP,0x8
008ff331 : FSTP double ptr [ESP]
008ff334 : CALL dword ptr [0x00b853d4]
008ff33a : MOVZX EDX,word ptr [EBP + 0xfffffdc0]
008ff341 : MOVZX EAX,word ptr [EBP + 0xfffffdbc]
008ff348 : MOVZX ECX,word ptr [EBP + 0xfffffdba]
008ff34f : PUSH EDX
008ff350 : MOVZX EDX,word ptr [EBP + 0xfffffdb6]
008ff357 : PUSH EAX
008ff358 : MOVZX EAX,word ptr [EBP + 0xfffffdb4]
008ff35f : PUSH ECX
008ff360 : PUSH EDX
008ff361 : PUSH EAX
008ff362 : PUSH 0xc62a78
008ff367 : LEA ECX,[EBP + 0xfffffdec]
008ff36d : PUSH 0x100
008ff372 : PUSH ECX
008ff373 : CALL 0x00638607
008ff378 : MOV EDX,dword ptr [0x0172491c]
008ff37e : MOV EAX,dword ptr [EBP + 0xfffffde4]
008ff384 : MOV ECX,dword ptr [EDX + 0x17c]
008ff38a : ADD ESP,0x20
008ff38d : LEA EDI,[EAX + 0x2]
008ff390 : MOV DX,word ptr [EAX]
008ff393 : ADD EAX,0x2
008ff396 : CMP DX,SI
008ff399 : JNZ 0x008ff390
008ff39b : SUB EAX,EDI
008ff39d : SAR EAX,0x1
008ff39f : MOV ESI,EAX
008ff3a1 : MOV EAX,dword ptr [ECX + 0x20]
008ff3a4 : MOV EDX,EAX
008ff3a6 : CMP EDX,EAX
008ff3a8 : CMOVC EAX,EDX
008ff3ab : MOV dword ptr [EBP + 0xfffffde0],ESI
008ff3b1 : MOV EDI,EAX
008ff3b3 : CMP EAX,ESI
008ff3b5 : JC 0x008ff3b9
008ff3b7 : MOV EDI,ESI
008ff3b9 : CMP dword ptr [ECX + 0x24],0x8
008ff3bd : JC 0x008ff3c4
008ff3bf : MOV EDX,dword ptr [ECX + 0x10]
008ff3c2 : JMP 0x008ff3c7
008ff3c4 : LEA EDX,[ECX + 0x10]
008ff3c7 : MOV ECX,dword ptr [EBP + 0xfffffde4]
008ff3cd : TEST EDI,EDI
008ff3cf : JBE 0x008ff3fc
008ff3d1 : MOV SI,word ptr [EDX]
008ff3d4 : CMP SI,word ptr [ECX]
008ff3d7 : JNZ 0x008ff3e6
008ff3d9 : ADD EDX,0x2
008ff3dc : ADD ECX,0x2
008ff3df : SUB EDI,0x1
008ff3e2 : JNZ 0x008ff3d1
008ff3e4 : JMP 0x008ff3f6
008ff3e6 : MOV DX,SI
008ff3e9 : CMP DX,word ptr [ECX]
008ff3ec : SBB ECX,ECX
008ff3ee : AND ECX,0xfffffffe
008ff3f1 : ADD ECX,0x1
008ff3f4 : JNZ 0x008ff40c
008ff3f6 : MOV ESI,dword ptr [EBP + 0xfffffde0]
008ff3fc : CMP EAX,ESI
008ff3fe : JNC 0x008ff405
008ff400 : OR ECX,0xffffffff
008ff403 : JMP 0x008ff40c
008ff405 : XOR ECX,ECX
008ff407 : CMP EAX,ESI
008ff409 : SETNZ CL
008ff40c : MOV EDI,dword ptr [EBP + 0xfffffdc8]
008ff412 : XOR EAX,EAX
008ff414 : TEST ECX,ECX
008ff416 : MOV ECX,dword ptr [EBP + 0xfffffdd8]
008ff41c : MOV DX,word ptr [ECX + 0x4]
008ff420 : SETZ AL
008ff423 : MOV dword ptr [EBP + 0xfffffde0],EAX
008ff429 : CALL 0x008fd6d0
008ff42e : MOV EDX,dword ptr [0x00da9894]
008ff434 : MOV ESI,EAX
008ff436 : MOV EAX,dword ptr [EDX]
008ff438 : TEST EAX,EAX
008ff43a : JZ 0x008ff497
008ff43c : CMP dword ptr [EAX + 0x114],0x0
008ff443 : JZ 0x008ff497
008ff445 : MOV EDX,dword ptr [EBP + 0xfffffde0]
008ff44b : MOV EDI,dword ptr [EBP + 0xfffffdd4]
008ff451 : PUSH ESI
008ff452 : PUSH EDX
008ff453 : MOV EAX,dword ptr [EAX + 0x114]
008ff459 : MOV ECX,dword ptr [EAX]
008ff45b : LEA EDX,[EBP + 0xfffffdec]
008ff461 : PUSH EDX
008ff462 : LEA EDX,[EBP + 0xfffffeec]
008ff468 : PUSH EDX
008ff469 : MOVZX EDX,byte ptr [EBP + 0xfffffdea]
008ff470 : PUSH EDX
008ff471 : MOVZX EDX,byte ptr [EBP + 0xfffffdeb]
008ff478 : PUSH EDX
008ff479 : MOV EDX,dword ptr [EBP + 0xfffffde4]
008ff47f : PUSH EDX
008ff480 : PUSH EDI
008ff481 : PUSH EDI
008ff482 : PUSH 0xc62a90
008ff487 : PUSH 0xc62aac
008ff48c : PUSH EAX
008ff48d : MOV EAX,dword ptr [ECX + 0x4]
008ff490 : CALL EAX
008ff492 : ADD ESP,0x30
008ff495 : JMP 0x008ff49d
008ff497 : MOV EDI,dword ptr [EBP + 0xfffffdd4]
008ff49d : CMP dword ptr [EBP + 0xfffffde0],0x0
008ff4a4 : JZ 0x008ff501
008ff4a6 : MOV ECX,dword ptr [0x00da9894]
008ff4ac : MOV EAX,dword ptr [ECX]
008ff4ae : TEST EAX,EAX
008ff4b0 : JZ 0x008ff501
008ff4b2 : CMP dword ptr [EAX + 0x114],0x0
008ff4b9 : JZ 0x008ff501
008ff4bb : PUSH ESI
008ff4bc : MOV EAX,dword ptr [EAX + 0x114]
008ff4c2 : PUSH 0x1
008ff4c4 : MOV EDX,dword ptr [EAX]
008ff4c6 : MOV EDX,dword ptr [EDX + 0x4]
008ff4c9 : LEA ECX,[EBP + 0xfffffdec]
008ff4cf : PUSH ECX
008ff4d0 : LEA ECX,[EBP + 0xfffffeec]
008ff4d6 : PUSH ECX
008ff4d7 : MOVZX ECX,byte ptr [EBP + 0xfffffdea]
008ff4de : PUSH ECX
008ff4df : MOVZX ECX,byte ptr [EBP + 0xfffffdeb]
008ff4e6 : PUSH ECX
008ff4e7 : MOV ECX,dword ptr [EBP + 0xfffffde4]
008ff4ed : PUSH ECX
008ff4ee : PUSH EDI
008ff4ef : PUSH 0xb
008ff4f1 : PUSH 0xc62ac8
008ff4f6 : PUSH 0xc62ae4
008ff4fb : PUSH EAX
008ff4fc : CALL EDX
008ff4fe : ADD ESP,0x30
008ff501 : CMP dword ptr [EBP + 0xfffffddc],0x0
008ff508 : JNZ 0x008ff51d
008ff50a : CMP dword ptr [EBP + 0xfffffde0],0x0
008ff511 : MOV dword ptr [EBP + 0xfffffddc],0x0
008ff51b : JZ 0x008ff527
008ff51d : MOV dword ptr [EBP + 0xfffffddc],0x1
008ff527 : MOV EAX,dword ptr [EBP + 0xfffffdd8]
008ff52d : MOVZX ECX,byte ptr [EAX + 0x7]
008ff531 : INC EDI
008ff532 : MOV dword ptr [EBP + 0xfffffdd4],EDI
008ff538 : DEC EDI
008ff539 : XOR ESI,ESI
008ff53b : CMP EDI,ECX
008ff53d : JL 0x008ff1e0
008ff543 : MOV ECX,EAX
008ff545 : MOVZX EDX,byte ptr [ECX + 0x7]
008ff549 : MOV EDI,dword ptr [EBP + 0xfffffdcc]
008ff54f : MOV dword ptr [EDI + 0x444],EDX
008ff555 : MOVZX EAX,word ptr [ECX + 0x4]
008ff559 : CMP word ptr [EDI + 0x440],AX
008ff560 : JZ 0x008ff56f
008ff562 : PUSH EDI
008ff563 : MOV word ptr [EDI + 0x440],AX
008ff56a : CALL 0x008fe000
008ff56f : CMP dword ptr [EBP + 0xfffffddc],ESI
008ff575 : JNZ 0x008ff5e9
008ff577 : MOV EAX,FS:[0x2c]
008ff57d : MOV ECX,dword ptr [EAX]
008ff57f : MOVZX EAX,byte ptr [ECX + 0x18]
008ff583 : INC EAX
008ff584 : CDQ
008ff585 : MOV EBX,0x3
008ff58a : IDIV EBX
008ff58c : MOV byte ptr [ECX + 0x18],DL
008ff58f : MOVZX EDX,DL
008ff592 : SHL EDX,0xd
008ff595 : LEA EAX,[EDX + ECX*0x1 + 0x122cb8]
008ff59c : MOV dword ptr [EBP + 0xfffffdcc],EAX
008ff5a2 : MOV dword ptr [EBP + -0x4],ESI
008ff5a5 : CMP EAX,ESI
008ff5a7 : JZ 0x008ff5c3
008ff5a9 : MOVZX ECX,word ptr [EDI + 0x440]
008ff5b0 : XOR EDX,EDX
008ff5b2 : MOV word ptr [EAX],DX
008ff5b5 : MOV byte ptr [EAX + 0x2],0x3f
008ff5b9 : MOV byte ptr [EAX + 0x3],0x13
008ff5bd : MOV word ptr [EAX + 0x4],CX
008ff5c1 : JMP 0x008ff5c5
008ff5c3 : XOR EAX,EAX
008ff5c5 : MOV dword ptr [EBP + -0x4],0xffffffff
008ff5cc : MOV EDX,dword ptr [0x017247d4]
008ff5d2 : MOV ECX,dword ptr [EDX + 0x4]
008ff5d5 : CMP ECX,ESI
008ff5d7 : JZ 0x008ff5e9
008ff5d9 : CMP byte ptr [EDX + 0x8],0x0
008ff5dd : JZ 0x008ff5e9
008ff5df : PUSH 0x6
008ff5e1 : PUSH ECX
008ff5e2 : MOV EDI,EAX
008ff5e4 : CALL 0x00a0dd40
008ff5e9 : MOV ECX,dword ptr [EBP + -0xc]
008ff5ec : MOV dword ptr FS:[0x0],ECX
008ff5f3 : POP ECX
008ff5f4 : POP EDI
008ff5f5 : POP ESI
008ff5f6 : POP EBX
008ff5f7 : MOV ECX,dword ptr [EBP + -0x14]
008ff5fa : XOR ECX,EBP
008ff5fc : CALL 0x00633e6b
008ff601 : MOV ESP,EBP
008ff603 : POP EBP
008ff604 : RET 0x4

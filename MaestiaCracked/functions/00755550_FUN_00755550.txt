PROGRAM  : Maestia.exe
FUNCTION : FUN_00755550
ENTRY    : 00755550
BODY     : [[00755550, 00755870]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00755550(void)

{
  uint uVar1;
  int *piVar2;
  float fVar3;
  DWORD DVar4;
  int iVar5;
  int in_ECX;
  undefined **ppuStack_5c;
  int *piStack_58;
  float local_54;
  float local_50;
  undefined4 local_4c;
  undefined4 local_48;
  float local_44;
  float local_40;
  float local_3c;
  float local_38;
  undefined1 auStack_34 [4];
  undefined2 uStack_30;
  undefined4 uStack_20;
  uint uStack_1c;
  void *local_14;
  undefined1 *puStack_10;
  int iStack_c;
  
  iStack_c = 0xffffffff;
  puStack_10 = &LAB_00b18b77;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  if (*(int *)(in_ECX + 4) != 0) {
    local_4c = 0;
    local_48 = 0;
    uVar1 = *(uint *)(DAT_017251ac + 0x20c);
    local_54 = 1.0 / (*(float *)(DAT_017251ac + 0x218) - *(float *)(DAT_017251ac + 0x214));
    local_50 = local_54 * -1.0;
    local_54 = local_54 * *(float *)(DAT_017251ac + 0x218);
    local_44 = (float)(uVar1 >> 0x10 & 0xff) * 0.003921569;
    local_40 = (float)(uVar1 >> 8 & 0xff) * 0.003921569;
    local_3c = (float)(uVar1 & 0xff) * 0.003921569;
    local_38 = (float)(uVar1 >> 0x18) * 0.003921569;
    (**(code **)(**(int **)(in_ECX + 4) + 0x50))
              (*(int **)(in_ECX + 4),"vFogParam",&local_54,0x10,
               DAT_00d66fa0 ^ (uint)&stack0xffffff98);
    (**(code **)(**(int **)(in_ECX + 4) + 0x50))(*(int **)(in_ECX + 4),"vFogColor",&local_54,0x10);
    DVar4 = GetTickCount();
    fVar3 = (float)(int)DVar4;
    if ((int)DVar4 < 0) {
      fVar3 = fVar3 + 4.2949673e+09;
    }
    (**(code **)(**(int **)(in_ECX + 4) + 0x78))(*(int **)(in_ECX + 4),"fTime",fVar3 * 0.001);
    if (*(int *)(in_ECX + 0xc) == 0) {
      FUN_00406460(L"WaterTile.bmp");
      iStack_c = 0;
      iVar5 = (**(code **)(*DAT_01725204 + 4))(&ppuStack_5c,auStack_34);
      iStack_c._0_1_ = 1;
      piVar2 = *(int **)(in_ECX + 0xc);
      if (piVar2 != *(int **)(iVar5 + 4)) {
        if (piVar2 != (int *)0x0) {
          (**(code **)(*piVar2 + 0x30))();
        }
        if (*(int *)(iVar5 + 4) != 0) {
          InterlockedIncrement((LONG *)(*(int *)(iVar5 + 4) + 0x2c));
        }
        *(undefined4 *)(in_ECX + 0xc) = *(undefined4 *)(iVar5 + 4);
      }
      iStack_c = (uint)iStack_c._1_3_ << 8;
      ppuStack_5c = &PTR_FUN_00cd4964;
      if (piStack_58 != (int *)0x0) {
        (**(code **)(*piStack_58 + 0x30))();
        piStack_58 = (int *)0x0;
      }
      iStack_c = 0xffffffff;
      if (7 < uStack_1c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      uStack_1c = 7;
      uStack_20 = 0;
      uStack_30 = 0;
    }
    if (*(int *)(in_ECX + 0x14) == 0) {
      FUN_00406460(L"oceanBump.tga");
      iStack_c = 2;
      iVar5 = (**(code **)(*DAT_01725204 + 4))(&ppuStack_5c,auStack_34);
      iStack_c._0_1_ = 3;
      piVar2 = *(int **)(in_ECX + 0x14);
      if (piVar2 != *(int **)(iVar5 + 4)) {
        if (piVar2 != (int *)0x0) {
          (**(code **)(*piVar2 + 0x30))();
        }
        if (*(int *)(iVar5 + 4) != 0) {
          InterlockedIncrement((LONG *)(*(int *)(iVar5 + 4) + 0x2c));
        }
        *(undefined4 *)(in_ECX + 0x14) = *(undefined4 *)(iVar5 + 4);
      }
      iStack_c = CONCAT31(iStack_c._1_3_,2);
      ppuStack_5c = &PTR_FUN_00cd4964;
      if (piStack_58 != (int *)0x0) {
        (**(code **)(*piStack_58 + 0x30))();
        piStack_58 = (int *)0x0;
      }
      iStack_c = 0xffffffff;
      if (7 < uStack_1c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      uStack_1c = 7;
      uStack_20 = 0;
      uStack_30 = 0;
    }
    piVar2 = *(int **)(in_ECX + 0xc);
    if (piVar2 != (int *)0x0) {
      (**(code **)(*piVar2 + 0x20))();
      (**(code **)(**(int **)(in_ECX + 4) + 0xd0))(*(int **)(in_ECX + 4),"texSrc1",piVar2[0xe]);
    }
    piVar2 = *(int **)(in_ECX + 0x14);
    if (piVar2 != (int *)0x0) {
      (**(code **)(*piVar2 + 0x20))();
      (**(code **)(**(int **)(in_ECX + 4) + 0xd0))(*(int **)(in_ECX + 4),"texSrc2",piVar2[0xe]);
    }
  }
  ExceptionList = local_14;
  return;
}



============================================================
DISASSEMBLY
============================================================
00755550 : PUSH EBP
00755551 : MOV EBP,ESP
00755553 : AND ESP,0xfffffff8
00755556 : PUSH -0x1
00755558 : PUSH 0xb18b77
0075555d : MOV EAX,FS:[0x0]
00755563 : PUSH EAX
00755564 : SUB ESP,0x4c
00755567 : PUSH ESI
00755568 : PUSH EDI
00755569 : MOV EAX,[0x00d66fa0]
0075556e : XOR EAX,ESP
00755570 : PUSH EAX
00755571 : LEA EAX,[ESP + 0x58]
00755575 : MOV FS:[0x0],EAX
0075557b : MOV ESI,ECX
0075557d : CMP dword ptr [ESI + 0x4],0x0
00755581 : JZ 0x0075585d
00755587 : XORPS XMM0,XMM0
0075558a : MOV EAX,[0x017251ac]
0075558f : MOVSS XMM1,dword ptr [EAX + 0x218]
00755597 : MOVSS dword ptr [ESP + 0x20],XMM0
0075559d : MOVSS dword ptr [ESP + 0x24],XMM0
007555a3 : MOVSS XMM0,dword ptr [EAX + 0x214]
007555ab : MOV EAX,dword ptr [EAX + 0x20c]
007555b1 : MOVAPS XMM2,XMM1
007555b4 : SUBSS XMM2,XMM0
007555b8 : MOVSS XMM0,dword ptr [0x00c10fc4]
007555c0 : MOV ECX,EAX
007555c2 : SHR ECX,0x10
007555c5 : MOVZX EDX,CL
007555c8 : DIVSS XMM0,XMM2
007555cc : MOV ECX,EAX
007555ce : MOVAPS XMM2,XMM0
007555d1 : MULSS XMM0,dword ptr [0x00cdf0d0]
007555d9 : MULSS XMM2,XMM1
007555dd : CVTSI2SS XMM1,EDX
007555e1 : SHR ECX,0x8
007555e4 : MOVZX EDX,CL
007555e7 : MOVSS dword ptr [ESP + 0x1c],XMM0
007555ed : MOVSS XMM0,dword ptr [0x00cdf178]
007555f5 : MULSS XMM1,XMM0
007555f9 : MOVSS dword ptr [ESP + 0x28],XMM1
007555ff : MOVZX ECX,AL
00755602 : CVTSI2SS XMM1,EDX
00755606 : MULSS XMM1,XMM0
0075560a : MOVSS dword ptr [ESP + 0x2c],XMM1
00755610 : CVTSI2SS XMM1,ECX
00755614 : MULSS XMM1,XMM0
00755618 : MOVSS dword ptr [ESP + 0x30],XMM1
0075561e : SHR EAX,0x18
00755621 : PUSH 0x10
00755623 : CVTSI2SS XMM1,EAX
00755627 : MOV EAX,dword ptr [ESI + 0x4]
0075562a : LEA ECX,[ESP + 0x1c]
0075562e : PUSH ECX
0075562f : MULSS XMM1,XMM0
00755633 : MOVSS dword ptr [ESP + 0x20],XMM2
00755639 : MOVSS dword ptr [ESP + 0x3c],XMM1
0075563f : MOV EDX,dword ptr [EAX]
00755641 : MOV EDX,dword ptr [EDX + 0x50]
00755644 : PUSH 0xc0aacc
00755649 : PUSH EAX
0075564a : CALL EDX
0075564c : MOV EAX,dword ptr [ESI + 0x4]
0075564f : MOV ECX,dword ptr [EAX]
00755651 : PUSH 0x10
00755653 : LEA EDX,[ESP + 0x2c]
00755657 : PUSH EDX
00755658 : PUSH 0xc0aad8
0075565d : PUSH EAX
0075565e : MOV EAX,dword ptr [ECX + 0x50]
00755661 : CALL EAX
00755663 : CALL dword ptr [0x00b850d8]
00755669 : MOV dword ptr [ESP + 0x10],EAX
0075566d : FILD dword ptr [ESP + 0x10]
00755671 : TEST EAX,EAX
00755673 : JGE 0x0075567b
00755675 : FADD float ptr [0x00cdf0e0]
0075567b : MOV EAX,dword ptr [ESI + 0x4]
0075567e : FMUL float ptr [0x00cdf128]
00755684 : MOV ECX,dword ptr [EAX]
00755686 : MOV EDX,dword ptr [ECX + 0x78]
00755689 : PUSH ECX
0075568a : FSTP float ptr [ESP]
0075568d : PUSH 0xc0aae4
00755692 : PUSH EAX
00755693 : CALL EDX
00755695 : CMP dword ptr [ESI + 0xc],0x0
00755699 : JNZ 0x00755752
0075569f : PUSH 0xc0aaec
007556a4 : LEA ECX,[ESP + 0x3c]
007556a8 : CALL 0x00406460
007556ad : MOV dword ptr [ESP + 0x60],0x0
007556b5 : MOV ECX,dword ptr [0x01725204]
007556bb : MOV EAX,dword ptr [ECX]
007556bd : MOV EAX,dword ptr [EAX + 0x4]
007556c0 : LEA EDX,[ESP + 0x38]
007556c4 : PUSH EDX
007556c5 : LEA EDX,[ESP + 0x14]
007556c9 : PUSH EDX
007556ca : CALL EAX
007556cc : MOV EDI,EAX
007556ce : MOV byte ptr [ESP + 0x60],0x1
007556d3 : MOV EAX,dword ptr [EDI + 0x4]
007556d6 : MOV ECX,dword ptr [ESI + 0xc]
007556d9 : CMP ECX,EAX
007556db : JZ 0x007556ff
007556dd : TEST ECX,ECX
007556df : JZ 0x007556e8
007556e1 : MOV EDX,dword ptr [ECX]
007556e3 : MOV EAX,dword ptr [EDX + 0x30]
007556e6 : CALL EAX
007556e8 : MOV EAX,dword ptr [EDI + 0x4]
007556eb : TEST EAX,EAX
007556ed : JZ 0x007556f9
007556ef : ADD EAX,0x2c
007556f2 : PUSH EAX
007556f3 : CALL dword ptr [0x00b850dc]
007556f9 : MOV ECX,dword ptr [EDI + 0x4]
007556fc : MOV dword ptr [ESI + 0xc],ECX
007556ff : MOV byte ptr [ESP + 0x60],0x0
00755704 : MOV ECX,dword ptr [ESP + 0x14]
00755708 : MOV dword ptr [ESP + 0x10],0xcd4964
00755710 : TEST ECX,ECX
00755712 : JZ 0x00755723
00755714 : MOV EDX,dword ptr [ECX]
00755716 : MOV EAX,dword ptr [EDX + 0x30]
00755719 : CALL EAX
0075571b : MOV dword ptr [ESP + 0x14],0x0
00755723 : MOV dword ptr [ESP + 0x60],0xffffffff
0075572b : CMP dword ptr [ESP + 0x50],0x8
00755730 : JC 0x0075573b
00755732 : MOV ECX,dword ptr [ESP + 0x3c]
00755736 : CALL 0x006f04e0
0075573b : XOR ECX,ECX
0075573d : MOV dword ptr [ESP + 0x50],0x7
00755745 : MOV dword ptr [ESP + 0x4c],0x0
0075574d : MOV word ptr [ESP + 0x3c],CX
00755752 : CMP dword ptr [ESI + 0x14],0x0
00755756 : JNZ 0x0075580f
0075575c : PUSH 0xc0ab08
00755761 : LEA ECX,[ESP + 0x3c]
00755765 : CALL 0x00406460
0075576a : MOV dword ptr [ESP + 0x60],0x2
00755772 : MOV ECX,dword ptr [0x01725204]
00755778 : MOV EDX,dword ptr [ECX]
0075577a : MOV EDX,dword ptr [EDX + 0x4]
0075577d : LEA EAX,[ESP + 0x38]
00755781 : PUSH EAX
00755782 : LEA EAX,[ESP + 0x14]
00755786 : PUSH EAX
00755787 : CALL EDX
00755789 : MOV EDI,EAX
0075578b : MOV byte ptr [ESP + 0x60],0x3
00755790 : MOV EAX,dword ptr [EDI + 0x4]
00755793 : MOV ECX,dword ptr [ESI + 0x14]
00755796 : CMP ECX,EAX
00755798 : JZ 0x007557bc
0075579a : TEST ECX,ECX
0075579c : JZ 0x007557a5
0075579e : MOV EAX,dword ptr [ECX]
007557a0 : MOV EDX,dword ptr [EAX + 0x30]
007557a3 : CALL EDX
007557a5 : MOV EAX,dword ptr [EDI + 0x4]
007557a8 : TEST EAX,EAX
007557aa : JZ 0x007557b6
007557ac : ADD EAX,0x2c
007557af : PUSH EAX
007557b0 : CALL dword ptr [0x00b850dc]
007557b6 : MOV EAX,dword ptr [EDI + 0x4]
007557b9 : MOV dword ptr [ESI + 0x14],EAX
007557bc : MOV byte ptr [ESP + 0x60],0x2
007557c1 : MOV ECX,dword ptr [ESP + 0x14]
007557c5 : MOV dword ptr [ESP + 0x10],0xcd4964
007557cd : TEST ECX,ECX
007557cf : JZ 0x007557e0
007557d1 : MOV EDX,dword ptr [ECX]
007557d3 : MOV EAX,dword ptr [EDX + 0x30]
007557d6 : CALL EAX
007557d8 : MOV dword ptr [ESP + 0x14],0x0
007557e0 : MOV dword ptr [ESP + 0x60],0xffffffff
007557e8 : CMP dword ptr [ESP + 0x50],0x8
007557ed : JC 0x007557f8
007557ef : MOV ECX,dword ptr [ESP + 0x3c]
007557f3 : CALL 0x006f04e0
007557f8 : XOR ECX,ECX
007557fa : MOV dword ptr [ESP + 0x50],0x7
00755802 : MOV dword ptr [ESP + 0x4c],0x0
0075580a : MOV word ptr [ESP + 0x3c],CX
0075580f : MOV EDI,dword ptr [ESI + 0xc]
00755812 : TEST EDI,EDI
00755814 : JZ 0x00755836
00755816 : MOV EDX,dword ptr [EDI]
00755818 : MOV EAX,dword ptr [EDX + 0x20]
0075581b : MOV ECX,EDI
0075581d : CALL EAX
0075581f : MOV EDX,dword ptr [EDI + 0x38]
00755822 : MOV EAX,dword ptr [ESI + 0x4]
00755825 : MOV ECX,dword ptr [EAX]
00755827 : PUSH EDX
00755828 : PUSH 0xc0ab24
0075582d : PUSH EAX
0075582e : MOV EAX,dword ptr [ECX + 0xd0]
00755834 : CALL EAX
00755836 : MOV EDI,dword ptr [ESI + 0x14]
00755839 : TEST EDI,EDI
0075583b : JZ 0x0075585d
0075583d : MOV EDX,dword ptr [EDI]
0075583f : MOV EAX,dword ptr [EDX + 0x20]
00755842 : MOV ECX,EDI
00755844 : CALL EAX
00755846 : MOV EDX,dword ptr [EDI + 0x38]
00755849 : MOV ESI,dword ptr [ESI + 0x4]
0075584c : MOV ECX,dword ptr [ESI]
0075584e : MOV EAX,dword ptr [ECX + 0xd0]
00755854 : PUSH EDX
00755855 : PUSH 0xc0ab2c
0075585a : PUSH ESI
0075585b : CALL EAX
0075585d : MOV ECX,dword ptr [ESP + 0x58]
00755861 : MOV dword ptr FS:[0x0],ECX
00755868 : POP ECX
00755869 : POP EDI
0075586a : POP ESI
0075586b : MOV ESP,EBP
0075586d : POP EBP
0075586e : RET 0x4

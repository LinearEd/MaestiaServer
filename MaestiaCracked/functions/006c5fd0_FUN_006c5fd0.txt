PROGRAM  : Maestia.exe
FUNCTION : FUN_006c5fd0
ENTRY    : 006c5fd0
BODY     : [[006c5fd0, 006c631b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006c5fd0(int param_1,int *param_2)

{
  uint local_8;
  
  if ((*(uint *)(param_1 + 0x70) & 0x1000) != 0) {
    if (*(char *)((int)param_2 + 0x19) == '\x03') {
      if ((*(short *)(param_1 + 0x11a) == 0) || ((*(uint *)(param_1 + 0x70) & 0x2000000) == 0)) {
        *(undefined1 *)((int)param_2 + 0x19) = 2;
      }
      else {
        *(undefined1 *)((int)param_2 + 0x19) = 6;
      }
      *(undefined1 *)(param_2 + 6) = 8;
      *(undefined2 *)((int)param_2 + 0x16) = 0;
    }
    else {
      if (*(short *)(param_1 + 0x11a) != 0) {
        if ((*(uint *)(param_1 + 0x70) & 0x2000000) == 0) {
          *(byte *)((int)param_2 + 0x19) = *(byte *)((int)param_2 + 0x19) | 2;
        }
        else {
          *(byte *)((int)param_2 + 0x19) = *(byte *)((int)param_2 + 0x19) | 4;
        }
      }
      if (*(byte *)(param_2 + 6) < 8) {
        *(undefined1 *)(param_2 + 6) = 8;
      }
      *(undefined2 *)((int)param_2 + 0x16) = 0;
    }
  }
  if ((*(uint *)(param_1 + 0x70) & 0x80) != 0) {
    *(byte *)((int)param_2 + 0x19) = *(byte *)((int)param_2 + 0x19) & 0xfb;
    *(undefined2 *)((int)param_2 + 0x16) = 0;
    *(undefined4 *)((int)param_2 + 0x5a) = *(undefined4 *)(param_1 + 0x138);
    *(undefined4 *)((int)param_2 + 0x5e) = *(undefined4 *)(param_1 + 0x13c);
    *(undefined2 *)((int)param_2 + 0x62) = *(undefined2 *)(param_1 + 0x140);
  }
  if ((*(uint *)(param_1 + 0x70) & 0x2000) != 0) {
    param_2[10] = *(int *)(param_1 + 0x15c);
    param_2[0x3f] = *(int *)(param_1 + 0x234);
  }
  if (((*(uint *)(param_1 + 0x70) & 0x400) != 0) && ((char)param_2[6] == '\x10')) {
    *(undefined1 *)(param_2 + 6) = 8;
  }
  if ((*(uint *)(param_1 + 0x70) & 0x4000) != 0) {
    *(byte *)((int)param_2 + 0x19) = *(byte *)((int)param_2 + 0x19) | 2;
  }
  if ((*(uint *)(param_1 + 0x70) & 0x600000) != 0) {
    *(byte *)((int)param_2 + 0x19) = *(byte *)((int)param_2 + 0x19) & 0xfd;
  }
  if (((*(uint *)(param_1 + 0x70) & 0x40) != 0) &&
     ((((*(char *)((int)param_2 + 0x19) == '\x02' || (*(char *)((int)param_2 + 0x19) == '\x06')) &&
       (*(int *)(param_1 + 0x1ec) != 0)) && ((char)param_2[6] == '\b')))) {
    *(undefined1 *)((int)param_2 + 0x19) = 3;
  }
  if (((*(uint *)(param_1 + 0x70) & 4) != 0) && (*(byte *)(param_2 + 6) < 8)) {
    *(undefined1 *)(param_2 + 6) = 8;
  }
  if (*(char *)((int)param_2 + 0x19) == '\x03') {
    *(undefined1 *)((int)param_2 + 0x1d) = 1;
  }
  else if ((*(byte *)((int)param_2 + 0x19) & 2) == 0) {
    *(undefined1 *)((int)param_2 + 0x1d) = 1;
  }
  else {
    *(undefined1 *)((int)param_2 + 0x1d) = 3;
  }
  if ((*(uint *)(param_1 + 0x6c) & 0x400000) != 0) {
    *(byte *)((int)param_2 + 0x19) = *(byte *)((int)param_2 + 0x19) & 0xfb;
  }
  if ((*(byte *)((int)param_2 + 0x19) & 4) != 0) {
    *(char *)((int)param_2 + 0x1d) = *(char *)((int)param_2 + 0x1d) + '\x01';
  }
  if ((((*(uint *)(param_1 + 0x70) & 0x8000) != 0) &&
      ((*(char *)((int)param_2 + 0x19) == '\x02' || (*(char *)((int)param_2 + 0x19) == '\0')))) &&
     (*(char *)((int)param_2 + 0x1d) = *(char *)((int)param_2 + 0x1d) + '\x01',
     (*(uint *)(param_1 + 0x70) & 0x1000000) != 0)) {
    *(byte *)((int)param_2 + 0x19) = *(byte *)((int)param_2 + 0x19) | 4;
  }
  if ((*(uint *)(param_1 + 0x70) & 0x100000) != 0) {
    if (*(byte *)(param_2 + 6) < *(byte *)(param_1 + 100)) {
      *(undefined1 *)(param_2 + 6) = *(undefined1 *)(param_1 + 100);
    }
    if (*(byte *)((int)param_2 + 0x1d) < *(byte *)(param_1 + 0x65)) {
      *(undefined1 *)((int)param_2 + 0x1d) = *(undefined1 *)(param_1 + 0x65);
    }
  }
  *(char *)((int)param_2 + 0x1e) = *(char *)((int)param_2 + 0x1d) * (char)param_2[6];
  if (*(byte *)((int)param_2 + 0x1e) < 8) {
    local_8 = (uint)*(byte *)((int)param_2 + 0x1e) * *param_2 + 7 >> 3;
  }
  else {
    local_8 = (uint)(*(byte *)((int)param_2 + 0x1e) >> 3) * *param_2;
  }
  param_2[3] = local_8;
  return;
}



============================================================
DISASSEMBLY
============================================================
006c5fd0 : PUSH EBP
006c5fd1 : MOV EBP,ESP
006c5fd3 : PUSH ECX
006c5fd4 : MOV EAX,dword ptr [EBP + 0x8]
006c5fd7 : MOV ECX,dword ptr [EAX + 0x70]
006c5fda : AND ECX,0x1000
006c5fe0 : JZ 0x006c608a
006c5fe6 : MOV EDX,dword ptr [EBP + 0xc]
006c5fe9 : MOVZX EAX,byte ptr [EDX + 0x19]
006c5fed : CMP EAX,0x3
006c5ff0 : JNZ 0x006c6030
006c5ff2 : MOV ECX,dword ptr [EBP + 0x8]
006c5ff5 : MOVZX EDX,word ptr [ECX + 0x11a]
006c5ffc : TEST EDX,EDX
006c5ffe : JZ 0x006c6017
006c6000 : MOV EAX,dword ptr [EBP + 0x8]
006c6003 : MOV ECX,dword ptr [EAX + 0x70]
006c6006 : AND ECX,0x2000000
006c600c : JZ 0x006c6017
006c600e : MOV EDX,dword ptr [EBP + 0xc]
006c6011 : MOV byte ptr [EDX + 0x19],0x6
006c6015 : JMP 0x006c601e
006c6017 : MOV EAX,dword ptr [EBP + 0xc]
006c601a : MOV byte ptr [EAX + 0x19],0x2
006c601e : MOV ECX,dword ptr [EBP + 0xc]
006c6021 : MOV byte ptr [ECX + 0x18],0x8
006c6025 : XOR EDX,EDX
006c6027 : MOV EAX,dword ptr [EBP + 0xc]
006c602a : MOV word ptr [EAX + 0x16],DX
006c602e : JMP 0x006c608a
006c6030 : MOV ECX,dword ptr [EBP + 0x8]
006c6033 : MOVZX EDX,word ptr [ECX + 0x11a]
006c603a : TEST EDX,EDX
006c603c : JZ 0x006c606e
006c603e : MOV EAX,dword ptr [EBP + 0x8]
006c6041 : MOV ECX,dword ptr [EAX + 0x70]
006c6044 : AND ECX,0x2000000
006c604a : JZ 0x006c605e
006c604c : MOV EDX,dword ptr [EBP + 0xc]
006c604f : MOVZX EAX,byte ptr [EDX + 0x19]
006c6053 : OR EAX,0x4
006c6056 : MOV ECX,dword ptr [EBP + 0xc]
006c6059 : MOV byte ptr [ECX + 0x19],AL
006c605c : JMP 0x006c606e
006c605e : MOV EDX,dword ptr [EBP + 0xc]
006c6061 : MOVZX EAX,byte ptr [EDX + 0x19]
006c6065 : OR EAX,0x2
006c6068 : MOV ECX,dword ptr [EBP + 0xc]
006c606b : MOV byte ptr [ECX + 0x19],AL
006c606e : MOV EDX,dword ptr [EBP + 0xc]
006c6071 : MOVZX EAX,byte ptr [EDX + 0x18]
006c6075 : CMP EAX,0x8
006c6078 : JGE 0x006c6081
006c607a : MOV ECX,dword ptr [EBP + 0xc]
006c607d : MOV byte ptr [ECX + 0x18],0x8
006c6081 : XOR EDX,EDX
006c6083 : MOV EAX,dword ptr [EBP + 0xc]
006c6086 : MOV word ptr [EAX + 0x16],DX
006c608a : MOV ECX,dword ptr [EBP + 0x8]
006c608d : MOV EDX,dword ptr [ECX + 0x70]
006c6090 : AND EDX,0x80
006c6096 : JZ 0x006c60d2
006c6098 : MOV EAX,dword ptr [EBP + 0xc]
006c609b : MOVZX ECX,byte ptr [EAX + 0x19]
006c609f : AND ECX,0xfffffffb
006c60a2 : MOV EDX,dword ptr [EBP + 0xc]
006c60a5 : MOV byte ptr [EDX + 0x19],CL
006c60a8 : XOR EAX,EAX
006c60aa : MOV ECX,dword ptr [EBP + 0xc]
006c60ad : MOV word ptr [ECX + 0x16],AX
006c60b1 : MOV EDX,dword ptr [EBP + 0x8]
006c60b4 : ADD EDX,0x138
006c60ba : MOV EAX,dword ptr [EBP + 0xc]
006c60bd : ADD EAX,0x5a
006c60c0 : MOV ECX,dword ptr [EDX]
006c60c2 : MOV dword ptr [EAX],ECX
006c60c4 : MOV ECX,dword ptr [EDX + 0x4]
006c60c7 : MOV dword ptr [EAX + 0x4],ECX
006c60ca : MOV DX,word ptr [EDX + 0x8]
006c60ce : MOV word ptr [EAX + 0x8],DX
006c60d2 : MOV EAX,dword ptr [EBP + 0x8]
006c60d5 : MOV ECX,dword ptr [EAX + 0x70]
006c60d8 : AND ECX,0x2000
006c60de : JZ 0x006c6101
006c60e0 : MOV EDX,dword ptr [EBP + 0xc]
006c60e3 : MOV EAX,dword ptr [EBP + 0x8]
006c60e6 : FLD float ptr [EAX + 0x15c]
006c60ec : FSTP float ptr [EDX + 0x28]
006c60ef : MOV ECX,dword ptr [EBP + 0xc]
006c60f2 : MOV EDX,dword ptr [EBP + 0x8]
006c60f5 : MOV EAX,dword ptr [EDX + 0x234]
006c60fb : MOV dword ptr [ECX + 0xfc],EAX
006c6101 : MOV ECX,dword ptr [EBP + 0x8]
006c6104 : MOV EDX,dword ptr [ECX + 0x70]
006c6107 : AND EDX,0x400
006c610d : JZ 0x006c6122
006c610f : MOV EAX,dword ptr [EBP + 0xc]
006c6112 : MOVZX ECX,byte ptr [EAX + 0x18]
006c6116 : CMP ECX,0x10
006c6119 : JNZ 0x006c6122
006c611b : MOV EDX,dword ptr [EBP + 0xc]
006c611e : MOV byte ptr [EDX + 0x18],0x8
006c6122 : MOV EAX,dword ptr [EBP + 0x8]
006c6125 : MOV ECX,dword ptr [EAX + 0x70]
006c6128 : AND ECX,0x4000
006c612e : JZ 0x006c6140
006c6130 : MOV EDX,dword ptr [EBP + 0xc]
006c6133 : MOVZX EAX,byte ptr [EDX + 0x19]
006c6137 : OR EAX,0x2
006c613a : MOV ECX,dword ptr [EBP + 0xc]
006c613d : MOV byte ptr [ECX + 0x19],AL
006c6140 : MOV EDX,dword ptr [EBP + 0x8]
006c6143 : MOV EAX,dword ptr [EDX + 0x70]
006c6146 : AND EAX,0x600000
006c614b : JZ 0x006c615d
006c614d : MOV ECX,dword ptr [EBP + 0xc]
006c6150 : MOVZX EDX,byte ptr [ECX + 0x19]
006c6154 : AND EDX,0xfffffffd
006c6157 : MOV EAX,dword ptr [EBP + 0xc]
006c615a : MOV byte ptr [EAX + 0x19],DL
006c615d : MOV ECX,dword ptr [EBP + 0x8]
006c6160 : MOV EDX,dword ptr [ECX + 0x70]
006c6163 : AND EDX,0x40
006c6166 : JZ 0x006c619f
006c6168 : MOV EAX,dword ptr [EBP + 0xc]
006c616b : MOVZX ECX,byte ptr [EAX + 0x19]
006c616f : CMP ECX,0x2
006c6172 : JZ 0x006c6180
006c6174 : MOV EDX,dword ptr [EBP + 0xc]
006c6177 : MOVZX EAX,byte ptr [EDX + 0x19]
006c617b : CMP EAX,0x6
006c617e : JNZ 0x006c619f
006c6180 : MOV ECX,dword ptr [EBP + 0x8]
006c6183 : CMP dword ptr [ECX + 0x1ec],0x0
006c618a : JZ 0x006c619f
006c618c : MOV EDX,dword ptr [EBP + 0xc]
006c618f : MOVZX EAX,byte ptr [EDX + 0x18]
006c6193 : CMP EAX,0x8
006c6196 : JNZ 0x006c619f
006c6198 : MOV ECX,dword ptr [EBP + 0xc]
006c619b : MOV byte ptr [ECX + 0x19],0x3
006c619f : MOV EDX,dword ptr [EBP + 0x8]
006c61a2 : MOV EAX,dword ptr [EDX + 0x70]
006c61a5 : AND EAX,0x4
006c61a8 : JZ 0x006c61bd
006c61aa : MOV ECX,dword ptr [EBP + 0xc]
006c61ad : MOVZX EDX,byte ptr [ECX + 0x18]
006c61b1 : CMP EDX,0x8
006c61b4 : JGE 0x006c61bd
006c61b6 : MOV EAX,dword ptr [EBP + 0xc]
006c61b9 : MOV byte ptr [EAX + 0x18],0x8
006c61bd : MOV ECX,dword ptr [EBP + 0xc]
006c61c0 : MOVZX EDX,byte ptr [ECX + 0x19]
006c61c4 : CMP EDX,0x3
006c61c7 : JNZ 0x006c61d2
006c61c9 : MOV EAX,dword ptr [EBP + 0xc]
006c61cc : MOV byte ptr [EAX + 0x1d],0x1
006c61d0 : JMP 0x006c61ee
006c61d2 : MOV ECX,dword ptr [EBP + 0xc]
006c61d5 : MOVZX EDX,byte ptr [ECX + 0x19]
006c61d9 : AND EDX,0x2
006c61dc : JZ 0x006c61e7
006c61de : MOV EAX,dword ptr [EBP + 0xc]
006c61e1 : MOV byte ptr [EAX + 0x1d],0x3
006c61e5 : JMP 0x006c61ee
006c61e7 : MOV ECX,dword ptr [EBP + 0xc]
006c61ea : MOV byte ptr [ECX + 0x1d],0x1
006c61ee : MOV EDX,dword ptr [EBP + 0x8]
006c61f1 : MOV EAX,dword ptr [EDX + 0x6c]
006c61f4 : AND EAX,0x400000
006c61f9 : JZ 0x006c620b
006c61fb : MOV ECX,dword ptr [EBP + 0xc]
006c61fe : MOVZX EDX,byte ptr [ECX + 0x19]
006c6202 : AND EDX,0xfffffffb
006c6205 : MOV EAX,dword ptr [EBP + 0xc]
006c6208 : MOV byte ptr [EAX + 0x19],DL
006c620b : MOV ECX,dword ptr [EBP + 0xc]
006c620e : MOVZX EDX,byte ptr [ECX + 0x19]
006c6212 : AND EDX,0x4
006c6215 : JZ 0x006c6226
006c6217 : MOV EAX,dword ptr [EBP + 0xc]
006c621a : MOV CL,byte ptr [EAX + 0x1d]
006c621d : ADD CL,0x1
006c6220 : MOV EDX,dword ptr [EBP + 0xc]
006c6223 : MOV byte ptr [EDX + 0x1d],CL
006c6226 : MOV EAX,dword ptr [EBP + 0x8]
006c6229 : MOV ECX,dword ptr [EAX + 0x70]
006c622c : AND ECX,0x8000
006c6232 : JZ 0x006c6278
006c6234 : MOV EDX,dword ptr [EBP + 0xc]
006c6237 : MOVZX EAX,byte ptr [EDX + 0x19]
006c623b : CMP EAX,0x2
006c623e : JZ 0x006c624b
006c6240 : MOV ECX,dword ptr [EBP + 0xc]
006c6243 : MOVZX EDX,byte ptr [ECX + 0x19]
006c6247 : TEST EDX,EDX
006c6249 : JNZ 0x006c6278
006c624b : MOV EAX,dword ptr [EBP + 0xc]
006c624e : MOV CL,byte ptr [EAX + 0x1d]
006c6251 : ADD CL,0x1
006c6254 : MOV EDX,dword ptr [EBP + 0xc]
006c6257 : MOV byte ptr [EDX + 0x1d],CL
006c625a : MOV EAX,dword ptr [EBP + 0x8]
006c625d : MOV ECX,dword ptr [EAX + 0x70]
006c6260 : AND ECX,0x1000000
006c6266 : JZ 0x006c6278
006c6268 : MOV EDX,dword ptr [EBP + 0xc]
006c626b : MOVZX EAX,byte ptr [EDX + 0x19]
006c626f : OR EAX,0x4
006c6272 : MOV ECX,dword ptr [EBP + 0xc]
006c6275 : MOV byte ptr [ECX + 0x19],AL
006c6278 : MOV EDX,dword ptr [EBP + 0x8]
006c627b : MOV EAX,dword ptr [EDX + 0x70]
006c627e : AND EAX,0x100000
006c6283 : JZ 0x006c62c1
006c6285 : MOV ECX,dword ptr [EBP + 0xc]
006c6288 : MOVZX EDX,byte ptr [ECX + 0x18]
006c628c : MOV EAX,dword ptr [EBP + 0x8]
006c628f : MOVZX ECX,byte ptr [EAX + 0x64]
006c6293 : CMP EDX,ECX
006c6295 : JGE 0x006c62a3
006c6297 : MOV EDX,dword ptr [EBP + 0xc]
006c629a : MOV EAX,dword ptr [EBP + 0x8]
006c629d : MOV CL,byte ptr [EAX + 0x64]
006c62a0 : MOV byte ptr [EDX + 0x18],CL
006c62a3 : MOV EDX,dword ptr [EBP + 0xc]
006c62a6 : MOVZX EAX,byte ptr [EDX + 0x1d]
006c62aa : MOV ECX,dword ptr [EBP + 0x8]
006c62ad : MOVZX EDX,byte ptr [ECX + 0x65]
006c62b1 : CMP EAX,EDX
006c62b3 : JGE 0x006c62c1
006c62b5 : MOV EAX,dword ptr [EBP + 0xc]
006c62b8 : MOV ECX,dword ptr [EBP + 0x8]
006c62bb : MOV DL,byte ptr [ECX + 0x65]
006c62be : MOV byte ptr [EAX + 0x1d],DL
006c62c1 : MOV EAX,dword ptr [EBP + 0xc]
006c62c4 : MOVZX ECX,byte ptr [EAX + 0x1d]
006c62c8 : MOV EDX,dword ptr [EBP + 0xc]
006c62cb : MOVZX EAX,byte ptr [EDX + 0x18]
006c62cf : IMUL ECX,EAX
006c62d2 : MOV EDX,dword ptr [EBP + 0xc]
006c62d5 : MOV byte ptr [EDX + 0x1e],CL
006c62d8 : MOV EAX,dword ptr [EBP + 0xc]
006c62db : MOVZX ECX,byte ptr [EAX + 0x1e]
006c62df : CMP ECX,0x8
006c62e2 : JL 0x006c62f9
006c62e4 : MOV EDX,dword ptr [EBP + 0xc]
006c62e7 : MOVZX EAX,byte ptr [EDX + 0x1e]
006c62eb : SHR EAX,0x3
006c62ee : MOV ECX,dword ptr [EBP + 0xc]
006c62f1 : IMUL EAX,dword ptr [ECX]
006c62f4 : MOV dword ptr [EBP + -0x4],EAX
006c62f7 : JMP 0x006c630f
006c62f9 : MOV EDX,dword ptr [EBP + 0xc]
006c62fc : MOVZX EAX,byte ptr [EDX + 0x1e]
006c6300 : MOV ECX,dword ptr [EBP + 0xc]
006c6303 : IMUL EAX,dword ptr [ECX]
006c6306 : ADD EAX,0x7
006c6309 : SHR EAX,0x3
006c630c : MOV dword ptr [EBP + -0x4],EAX
006c630f : MOV EDX,dword ptr [EBP + 0xc]
006c6312 : MOV EAX,dword ptr [EBP + -0x4]
006c6315 : MOV dword ptr [EDX + 0xc],EAX
006c6318 : MOV ESP,EBP
006c631a : POP EBP
006c631b : RET

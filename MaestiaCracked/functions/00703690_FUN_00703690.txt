PROGRAM  : Maestia.exe
FUNCTION : FUN_00703690
ENTRY    : 00703690
BODY     : [[00703690, 0070388a]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00703690(int *param_1,uint param_2)

{
  float fVar1;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  int iVar5;
  undefined4 local_40 [7];
  undefined4 local_24;
  longlong local_20;
  uint local_18;
  undefined4 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b302d4;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  FUN_006ed4b0(DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
  local_14 = local_40;
  local_40[0] = 0x12345678;
  local_24 = 0x12345678;
  if (*(uint *)(*(int *)ThreadLocalStoragePointer + 0x1c) < 0x80) {
    FUN_006ed5d0(&local_14);
  }
  iVar5 = 0;
  local_8 = 0;
  if (((param_1 != (int *)0x0) && ((char)param_1[0x10] != '\0')) && (param_2 != 0)) {
    uVar2 = FUN_006fec70();
    if (((uVar2 & 0xff) != 0xb) && (9 < (uVar2 & 0xff) - 0x14)) {
      uVar2 = FUN_006fec70();
      iVar3 = (**(code **)(*param_1 + 0x68))();
      if (iVar3 == 0) {
        if ((uVar2 & 0xff) < 10) {
          local_18 = (byte)(&DAT_00d6ab04)[uVar2 & 0xff] + 6;
          goto LAB_007037de;
        }
        if (DAT_00d72ee0 != 0) {
          uVar4 = FUN_006ee420(".\\ShareValue.cpp",0x88);
          FUN_006ee470(L"[ERROR] %s %d\n",uVar4);
          DAT_00d72ee0 = 0;
        }
      }
      else {
        if (*(byte *)(param_1 + 0xa2) < 9) {
          local_18 = (uint)(byte)(&DAT_00d6aaf8)[*(byte *)(param_1 + 0xa2)];
LAB_007037de:
          uVar2 = 1;
          if (param_2 != 0) {
            do {
              iVar3 = FUN_004049b0(uVar2 & 0xffff | 0x9a000000);
              if (iVar3 == 0) goto LAB_00703779;
              fVar1 = (float)iVar5;
              if (iVar5 < 0) {
                fVar1 = fVar1 + 4.2949673e+09;
              }
              uVar2 = uVar2 + 1;
              local_20 = (longlong)
                         ROUND(fVar1 + (float)*(ushort *)(iVar3 + 0x1e) * 0.0001 *
                                       (float)*(int *)(&DAT_00d6ab0c +
                                                      (local_18 * 0x7d +
                                                      (uint)*(byte *)(param_1 + 0x10)) * 4) + 0.9);
              iVar5 = (int)local_20;
            } while (uVar2 <= param_2);
          }
          local_8 = 0xffffffff;
          FUN_006ed550();
          ExceptionList = local_10;
          return iVar5;
        }
        if (DAT_00d72edc != 0) {
          uVar4 = FUN_006ee420(".\\ShareValue.cpp",0x7e);
          FUN_006ee470(L"[ERROR] %s %d\n",uVar4);
          DAT_00d72edc = 0;
        }
      }
    }
  }
LAB_00703779:
  local_8 = 0xffffffff;
  FUN_006ed550();
  ExceptionList = local_10;
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00703690 : PUSH EBP
00703691 : MOV EBP,ESP
00703693 : PUSH -0x1
00703695 : PUSH 0xb302d4
0070369a : MOV EAX,FS:[0x0]
007036a0 : PUSH EAX
007036a1 : SUB ESP,0x30
007036a4 : PUSH EBX
007036a5 : PUSH ESI
007036a6 : PUSH EDI
007036a7 : MOV EAX,[0x00d66fa0]
007036ac : XOR EAX,EBP
007036ae : PUSH EAX
007036af : LEA EAX,[EBP + -0xc]
007036b2 : MOV FS:[0x0],EAX
007036b8 : MOV EBX,dword ptr [EBP + 0x8]
007036bb : CALL 0x006ed4b0
007036c0 : MOV EDX,dword ptr FS:[0x2c]
007036c7 : LEA ECX,[EBP + -0x3c]
007036ca : MOV dword ptr [EBP + -0x10],ECX
007036cd : MOV ECX,0x12345678
007036d2 : MOV dword ptr [EBP + -0x3c],ECX
007036d5 : MOV dword ptr [EBP + -0x20],ECX
007036d8 : MOV ECX,dword ptr [EDX]
007036da : CMP dword ptr [ECX + 0x1c],0x80
007036e1 : JNC 0x007036ec
007036e3 : LEA EDX,[EBP + -0x10]
007036e6 : PUSH EDX
007036e7 : CALL 0x006ed5d0
007036ec : XOR EDI,EDI
007036ee : MOV dword ptr [EBP + -0x4],EDI
007036f1 : CMP EBX,EDI
007036f3 : JZ 0x00703779
007036f9 : CMP byte ptr [EBX + 0x40],0x0
007036fd : JZ 0x00703779
007036ff : CMP dword ptr [EBP + 0xc],EDI
00703702 : JZ 0x00703779
00703704 : MOV ECX,EBX
00703706 : CALL 0x006fec70
0070370b : MOVZX EAX,AL
0070370e : CMP EAX,0xb
00703711 : JZ 0x00703779
00703713 : ADD EAX,-0x14
00703716 : CMP EAX,0x9
00703719 : JBE 0x00703779
0070371b : MOV ECX,EBX
0070371d : CALL 0x006fec70
00703722 : MOVZX ESI,AL
00703725 : MOV EAX,dword ptr [EBX]
00703727 : MOV EDX,dword ptr [EAX + 0x68]
0070372a : MOV ECX,EBX
0070372c : CALL EDX
0070372e : TEST EAX,EAX
00703730 : JZ 0x0070379c
00703732 : MOV AL,byte ptr [EBX + 0x288]
00703738 : CMP AL,0x9
0070373a : JNC 0x0070374e
0070373c : MOVZX EAX,AL
0070373f : MOVZX ECX,byte ptr [EAX + 0xd6aaf8]
00703746 : MOV dword ptr [EBP + -0x14],ECX
00703749 : JMP 0x007037de
0070374e : CMP dword ptr [0x00d72edc],EDI
00703754 : JZ 0x00703779
00703756 : PUSH 0x7e
00703758 : PUSH 0xbf9eb8
0070375d : CALL 0x006ee420
00703762 : ADD ESP,0x4
00703765 : PUSH EAX
00703766 : PUSH 0xbf9ecc
0070376b : CALL 0x006ee470
00703770 : ADD ESP,0xc
00703773 : MOV dword ptr [0x00d72edc],EDI
00703779 : MOV dword ptr [EBP + -0x4],0xffffffff
00703780 : LEA EAX,[EBP + -0x10]
00703783 : CALL 0x006ed550
00703788 : XOR EAX,EAX
0070378a : MOV ECX,dword ptr [EBP + -0xc]
0070378d : MOV dword ptr FS:[0x0],ECX
00703794 : POP ECX
00703795 : POP EDI
00703796 : POP ESI
00703797 : POP EBX
00703798 : MOV ESP,EBP
0070379a : POP EBP
0070379b : RET
0070379c : CMP ESI,0xa
0070379f : JL 0x007037d1
007037a1 : CMP dword ptr [0x00d72ee0],EDI
007037a7 : JZ 0x00703779
007037a9 : PUSH 0x88
007037ae : PUSH 0xbf9eec
007037b3 : CALL 0x006ee420
007037b8 : ADD ESP,0x4
007037bb : PUSH EAX
007037bc : PUSH 0xbf9f00
007037c1 : CALL 0x006ee470
007037c6 : ADD ESP,0xc
007037c9 : MOV dword ptr [0x00d72ee0],EDI
007037cf : JMP 0x00703779
007037d1 : MOVZX EAX,byte ptr [ESI + 0xd6ab04]
007037d8 : ADD EAX,0x6
007037db : MOV dword ptr [EBP + -0x14],EAX
007037de : MOV ESI,0x1
007037e3 : CMP dword ptr [EBP + 0xc],ESI
007037e6 : JC 0x00703868
007037ec : LEA ESP,[ESP]
007037f0 : MOVZX EDX,SI
007037f3 : OR EDX,0x9a000000
007037f9 : PUSH EDX
007037fa : CALL 0x004049b0
007037ff : ADD ESP,0x4
00703802 : TEST EAX,EAX
00703804 : JZ 0x00703779
0070380a : MOV ECX,dword ptr [EBP + -0x14]
0070380d : MOVZX EDX,byte ptr [EBX + 0x40]
00703811 : IMUL ECX,ECX,0x7d
00703814 : MOVZX EAX,word ptr [EAX + 0x1e]
00703818 : ADD ECX,EDX
0070381a : MOV dword ptr [EBP + 0x8],EAX
0070381d : FILD dword ptr [ECX*0x4 + 0xd6ab0c]
00703824 : FILD dword ptr [EBP + 0x8]
00703827 : MOV dword ptr [EBP + 0x8],EDI
0070382a : FMUL float ptr [0x00cdf398]
00703830 : FMULP
00703832 : FILD dword ptr [EBP + 0x8]
00703835 : TEST EDI,EDI
00703837 : JGE 0x0070383f
00703839 : FADD float ptr [0x00cdf0e0]
0070383f : FNSTCW word ptr [EBP + 0xa]
00703842 : INC ESI
00703843 : MOVZX EAX,word ptr [EBP + 0xa]
00703847 : FADDP
00703849 : OR EAX,0xc00
0070384e : MOV dword ptr [EBP + -0x18],EAX
00703851 : FADD float ptr [0x00cdf1c4]
00703857 : FLDCW word ptr [EBP + -0x18]
0070385a : FISTP qword ptr [EBP + -0x1c]
0070385d : MOV EDI,dword ptr [EBP + -0x1c]
00703860 : FLDCW word ptr [EBP + 0xa]
00703863 : CMP ESI,dword ptr [EBP + 0xc]
00703866 : JBE 0x007037f0
00703868 : MOV dword ptr [EBP + -0x4],0xffffffff
0070386f : LEA EAX,[EBP + -0x10]
00703872 : CALL 0x006ed550
00703877 : MOV EAX,EDI
00703879 : MOV ECX,dword ptr [EBP + -0xc]
0070387c : MOV dword ptr FS:[0x0],ECX
00703883 : POP ECX
00703884 : POP EDI
00703885 : POP ESI
00703886 : POP EBX
00703887 : MOV ESP,EBP
00703889 : POP EBP
0070388a : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00687840
ENTRY    : 00687840
BODY     : [[00687840, 006878b5]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00687840(int *param_1,uint param_2,void *param_3,uint param_4)

{
  uint _Size;
  undefined4 uVar1;
  
  if ((uint)param_1[1] <= param_2) {
    return 0x55;
  }
  if ((code *)param_1[5] == (code *)0x0) {
    _Size = param_1[1] - param_2;
    if (param_4 < _Size) {
      _Size = param_4;
    }
    _memcpy(param_3,(void *)(*param_1 + param_2),_Size);
  }
  else {
    _Size = (*(code *)param_1[5])(param_1,param_2,param_3,param_4);
  }
  param_1[2] = _Size + param_2;
  uVar1 = 0x55;
  if (param_4 <= _Size) {
    uVar1 = 0;
  }
  return uVar1;
}



============================================================
DISASSEMBLY
============================================================
00687840 : PUSH ECX
00687841 : PUSH EBX
00687842 : MOV EBX,dword ptr [ESP + 0xc]
00687846 : PUSH ESI
00687847 : MOV ESI,dword ptr [EBX + 0x4]
0068784a : PUSH EDI
0068784b : MOV EDI,dword ptr [ESP + 0x18]
0068784f : MOV dword ptr [ESP + 0xc],0x0
00687857 : CMP EDI,ESI
00687859 : JC 0x00687865
0068785b : POP EDI
0068785c : POP ESI
0068785d : MOV EAX,0x55
00687862 : POP EBX
00687863 : POP ECX
00687864 : RET
00687865 : MOV EAX,dword ptr [EBX + 0x14]
00687868 : PUSH EBP
00687869 : MOV EBP,dword ptr [ESP + 0x24]
0068786d : TEST EAX,EAX
0068786f : JZ 0x00687882
00687871 : MOV ECX,dword ptr [ESP + 0x20]
00687875 : PUSH EBP
00687876 : PUSH ECX
00687877 : PUSH EDI
00687878 : PUSH EBX
00687879 : CALL EAX
0068787b : ADD ESP,0x10
0068787e : MOV ESI,EAX
00687880 : JMP 0x0068789d
00687882 : SUB ESI,EDI
00687884 : CMP ESI,EBP
00687886 : JBE 0x0068788a
00687888 : MOV ESI,EBP
0068788a : MOV EDX,dword ptr [EBX]
0068788c : MOV EAX,dword ptr [ESP + 0x20]
00687890 : PUSH ESI
00687891 : ADD EDX,EDI
00687893 : PUSH EDX
00687894 : PUSH EAX
00687895 : CALL 0x0063ae40
0068789a : ADD ESP,0xc
0068789d : LEA ECX,[ESI + EDI*0x1]
006878a0 : CMP ESI,EBP
006878a2 : MOV dword ptr [EBX + 0x8],ECX
006878a5 : POP EBP
006878a6 : MOV EAX,0x55
006878ab : JC 0x006878b1
006878ad : MOV EAX,dword ptr [ESP + 0xc]
006878b1 : POP EDI
006878b2 : POP ESI
006878b3 : POP EBX
006878b4 : POP ECX
006878b5 : RET

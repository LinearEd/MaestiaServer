PROGRAM  : Maestia.exe
FUNCTION : FUN_00a635b0
ENTRY    : 00a635b0
BODY     : [[00a635b0, 00a636c5]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a635b0(int param_1)

{
  char cVar1;
  int in_ECX;
  undefined1 local_414 [1024];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b477f6;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(char *)(in_ECX + 0x24) == '\0') {
    FUN_0070d390(local_14);
    local_8 = 0;
    cVar1 = FUN_008036f0(*(undefined4 *)(in_ECX + 0x34),param_1);
    if (cVar1 != '\0') {
      cVar1 = FUN_00a634d0(in_ECX);
      if (cVar1 != '\0') {
        FUN_00405eb0(param_1,0,0xffffffff);
        *(undefined1 *)(in_ECX + 0x24) = 1;
        FUN_0070d4c0();
        local_8 = 0xffffffff;
        FUN_0070d710();
        goto LAB_00a636a8;
      }
      if (*(uint *)(param_1 + 0x18) < 8) {
        param_1 = param_1 + 4;
      }
      else {
        param_1 = *(int *)(param_1 + 4);
      }
      FUN_0040e4a0(L"[AvaAniEventData::Read] Corrupted File %s",param_1);
      FUN_008018d0(local_414);
    }
    FUN_0070d4c0();
    local_8 = 0xffffffff;
    FUN_0070d710();
  }
LAB_00a636a8:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a635b0 : PUSH EBP
00a635b1 : MOV EBP,ESP
00a635b3 : PUSH -0x1
00a635b5 : PUSH 0xb477f6
00a635ba : MOV EAX,FS:[0x0]
00a635c0 : PUSH EAX
00a635c1 : SUB ESP,0x458
00a635c7 : MOV EAX,[0x00d66fa0]
00a635cc : XOR EAX,EBP
00a635ce : MOV dword ptr [EBP + -0x10],EAX
00a635d1 : PUSH EBX
00a635d2 : PUSH ESI
00a635d3 : PUSH EDI
00a635d4 : PUSH EAX
00a635d5 : LEA EAX,[EBP + -0xc]
00a635d8 : MOV FS:[0x0],EAX
00a635de : MOV EBX,dword ptr [EBP + 0x8]
00a635e1 : MOV EDI,ECX
00a635e3 : CMP byte ptr [EDI + 0x24],0x0
00a635e7 : JNZ 0x00a63674
00a635ed : LEA ECX,[EBP + 0xfffffb9c]
00a635f3 : CALL 0x0070d390
00a635f8 : MOV dword ptr [EBP + -0x4],0x0
00a635ff : MOV EAX,dword ptr [EDI + 0x34]
00a63602 : PUSH EBX
00a63603 : PUSH EAX
00a63604 : LEA ECX,[EBP + 0xfffffb9c]
00a6360a : CALL 0x008036f0
00a6360f : TEST AL,AL
00a63611 : JZ 0x00a63657
00a63613 : PUSH EDI
00a63614 : LEA ESI,[EBP + 0xfffffb9c]
00a6361a : CALL 0x00a634d0
00a6361f : TEST AL,AL
00a63621 : JNZ 0x00a63678
00a63623 : CMP dword ptr [EBX + 0x18],0x8
00a63627 : JC 0x00a6362e
00a63629 : MOV EBX,dword ptr [EBX + 0x4]
00a6362c : JMP 0x00a63631
00a6362e : ADD EBX,0x4
00a63631 : PUSH EBX
00a63632 : PUSH 0xc05078
00a63637 : LEA EDX,[EBP + 0xfffffbf0]
00a6363d : CALL 0x0040e4a0
00a63642 : MOV ESI,dword ptr [0x00da98e8]
00a63648 : LEA ECX,[EBP + 0xfffffbf0]
00a6364e : PUSH ECX
00a6364f : CALL 0x008018d0
00a63654 : ADD ESP,0xc
00a63657 : LEA ECX,[EBP + 0xfffffb9c]
00a6365d : CALL 0x0070d4c0
00a63662 : MOV dword ptr [EBP + -0x4],0xffffffff
00a63669 : LEA ECX,[EBP + 0xfffffb9c]
00a6366f : CALL 0x0070d710
00a63674 : XOR AL,AL
00a63676 : JMP 0x00a636a8
00a63678 : PUSH -0x1
00a6367a : PUSH 0x0
00a6367c : PUSH EBX
00a6367d : LEA ECX,[EDI + 0x4]
00a63680 : CALL 0x00405eb0
00a63685 : LEA ECX,[EBP + 0xfffffb9c]
00a6368b : MOV byte ptr [EDI + 0x24],0x1
00a6368f : CALL 0x0070d4c0
00a63694 : MOV dword ptr [EBP + -0x4],0xffffffff
00a6369b : LEA ECX,[EBP + 0xfffffb9c]
00a636a1 : CALL 0x0070d710
00a636a6 : MOV AL,0x1
00a636a8 : MOV ECX,dword ptr [EBP + -0xc]
00a636ab : MOV dword ptr FS:[0x0],ECX
00a636b2 : POP ECX
00a636b3 : POP EDI
00a636b4 : POP ESI
00a636b5 : POP EBX
00a636b6 : MOV ECX,dword ptr [EBP + -0x10]
00a636b9 : XOR ECX,EBP
00a636bb : CALL 0x00633e6b
00a636c0 : MOV ESP,EBP
00a636c2 : POP EBP
00a636c3 : RET 0x4

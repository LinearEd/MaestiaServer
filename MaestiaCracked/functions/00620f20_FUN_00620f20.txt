PROGRAM  : Maestia.exe
FUNCTION : FUN_00620f20
ENTRY    : 00620f20
BODY     : [[00620f20, 00621274]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00620f20(int param_1,float param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  float10 fVar4;
  float fVar5;
  float fVar6;
  
  iVar3 = 0;
  *(undefined4 *)(param_1 + 0x26c) = 0;
  if ((*(byte *)(param_1 + 0x100) & 2) == 0) {
    return;
  }
  param_2 = *(float *)(*(int *)(param_1 + 0x164) + 0x110) * param_2;
  *(float *)(param_1 + 0x26c) = param_2;
  *(undefined4 *)(param_1 + 0x150) = DAT_00d66240;
  *(undefined4 *)(param_1 + 0x154) = DAT_00d66244;
  *(undefined4 *)(param_1 + 0x158) = DAT_00d66248;
  fVar6 = *(float *)(param_1 + 0x330);
  *(float *)(param_1 + 0x150) = *(float *)(param_1 + 0x150) * fVar6;
  *(float *)(param_1 + 0x154) = fVar6 * *(float *)(param_1 + 0x154);
  *(float *)(param_1 + 0x158) = *(float *)(param_1 + 0x158) * fVar6;
  fVar6 = param_2;
  if ((*(uint *)(*(int *)(param_1 + 0x164) + 0x68) & 0x80000000) == 0) {
    if (*(code **)(param_1 + 0x29c) != (code *)0x0) {
      fVar4 = (float10)(**(code **)(param_1 + 0x29c))(param_1);
      *(float *)(param_1 + 0x308) = (float)fVar4;
    }
    if (DAT_00d6625c != 0) {
      FUN_0061c6a0(param_1);
    }
  }
  if ((*(byte *)(param_1 + 0x100) & 1) != 0) {
    *(undefined4 *)(param_1 + 0x15c) = 0;
    *(undefined4 *)(param_1 + 0x26c) = 0;
    return;
  }
  if ((*(uint *)(*(int *)(param_1 + 0x164) + 0x68) & 0x200) != 0) {
    FUN_0061e8c0(param_1,param_2);
    fVar6 = param_2;
  }
  fVar5 = *(float *)(param_1 + 0x108) + fVar6;
  *(float *)(param_1 + 0x108) = fVar5;
  if (((0.0 < *(float *)(param_1 + 0x324)) && (*(float *)(param_1 + 0x324) <= fVar5)) &&
     (*(code **)(param_1 + 0x328) != (code *)0x0)) {
    (**(code **)(param_1 + 0x328))(param_1);
    fVar6 = param_2;
  }
  if ((*(byte *)(param_1 + 0x100) & 8) != 0) goto LAB_00621258;
  if (*(code **)(param_1 + 0x27c) == (code *)0x0) {
    iVar1 = *(int *)(param_1 + 0x164);
    fVar5 = *(float *)(iVar1 + 0xcc) * *(float *)(param_1 + 0x334) * *(float *)(param_1 + 0x30c) *
            fVar6;
    iVar3 = (int)fVar5;
    fVar5 = (fVar5 - (float)iVar3) + *(float *)(param_1 + 0x10c);
    *(float *)(param_1 + 0x10c) = fVar5;
    if (1.0 <= fVar5) {
      *(undefined4 *)(param_1 + 0x10c) = 0;
      iVar3 = iVar3 + 1;
    }
    if (0 < *(int *)(iVar1 + 0x104)) {
      fVar5 = *(float *)(iVar1 + 0x1e8);
      iVar2 = _rand();
      fVar5 = (float)(iVar2 % 100) * 0.01 * (*(float *)(iVar1 + 0x1ec) - fVar5) + fVar5;
      *(float *)(param_1 + 0x350) = fVar5;
      if ((param_2 <= fVar5) || (fVar5 <= 0.0)) {
        fVar6 = param_2;
        if ((*(float *)(param_1 + 0x34c) <= fVar5) || (fVar5 <= 0.0)) goto LAB_006211f9;
        fVar6 = *(float *)(iVar1 + 0xe4) - (float)*(int *)(*(int *)(param_1 + 0x104) + 0x120);
        if ((float)*(int *)(iVar1 + 0x104) < fVar6) {
          fVar6 = (float)*(int *)(iVar1 + 0x104);
        }
      }
      else {
        fVar5 = (*(float *)(param_1 + 0x34c) / fVar5) * (float)*(int *)(iVar1 + 0x104);
        fVar6 = *(float *)(iVar1 + 0xe4) - (float)*(int *)(*(int *)(param_1 + 0x104) + 0x120);
        if (fVar5 < fVar6) {
          fVar6 = fVar5;
        }
      }
      iVar3 = iVar3 + (int)fVar6;
      *(undefined4 *)(param_1 + 0x34c) = 0;
      fVar6 = param_2;
    }
LAB_006211f9:
    *(float *)(param_1 + 0x34c) = *(float *)(param_1 + 0x34c) + fVar6;
    if (((*(uint *)(iVar1 + 0x68) & 0x40000000) != 0) && (1 < iVar3)) {
      iVar3 = 1;
    }
  }
  else {
    iVar3 = (**(code **)(param_1 + 0x27c))(param_1,param_2);
  }
  iVar1 = *(int *)(*(int *)(param_1 + 0x104) + 0x120);
  iVar2 = (int)(*(float *)(*(int *)(param_1 + 0x164) + 0xe4) * *(float *)(param_1 + 0x30c));
  if (iVar2 < iVar1 + iVar3) {
    iVar3 = iVar2 - iVar1;
  }
  if (iVar3 < 0) {
    iVar3 = 0;
  }
LAB_00621258:
  *(int *)(param_1 + 0x15c) = iVar3;
  return;
}



============================================================
DISASSEMBLY
============================================================
00620f20 : XORPS XMM0,XMM0
00620f23 : PUSH ESI
00620f24 : MOV ESI,dword ptr [ESP + 0x8]
00620f28 : PUSH EDI
00620f29 : XOR EDI,EDI
00620f2b : TEST byte ptr [ESI + 0x100],0x2
00620f32 : MOVSS dword ptr [ESI + 0x26c],XMM0
00620f3a : JZ 0x0062125e
00620f40 : MOV EAX,dword ptr [ESI + 0x164]
00620f46 : MOVSS XMM4,dword ptr [EAX + 0x110]
00620f4e : MULSS XMM4,dword ptr [ESP + 0x10]
00620f54 : MOVSS dword ptr [ESI + 0x26c],XMM4
00620f5c : MOVSS XMM0,dword ptr [0x00d66240]
00620f64 : MOVSS dword ptr [ESI + 0x150],XMM0
00620f6c : MOVSS XMM0,dword ptr [0x00d66244]
00620f74 : MOVSS XMM1,dword ptr [ESI + 0x150]
00620f7c : MOVSS dword ptr [ESI + 0x154],XMM0
00620f84 : MOVSS XMM0,dword ptr [0x00d66248]
00620f8c : MOVSS dword ptr [ESI + 0x158],XMM0
00620f94 : MOVSS XMM0,dword ptr [ESI + 0x330]
00620f9c : MULSS XMM1,XMM0
00620fa0 : MOVSS dword ptr [ESI + 0x150],XMM1
00620fa8 : MOVAPS XMM1,XMM0
00620fab : MULSS XMM1,dword ptr [ESI + 0x154]
00620fb3 : MOVSS dword ptr [ESI + 0x154],XMM1
00620fbb : MOVSS XMM1,dword ptr [ESI + 0x158]
00620fc3 : MULSS XMM1,XMM0
00620fc7 : MOVSS dword ptr [ESI + 0x158],XMM1
00620fcf : TEST dword ptr [EAX + 0x68],0x80000000
00620fd6 : MOVSS dword ptr [ESP + 0x10],XMM4
00620fdc : JNZ 0x00621011
00620fde : MOV EAX,dword ptr [ESI + 0x29c]
00620fe4 : MOV dword ptr [ESP + 0xc],EAX
00620fe8 : TEST EAX,EAX
00620fea : JZ 0x00621000
00620fec : PUSH ESI
00620fed : CALL dword ptr [ESP + 0x10]
00620ff1 : FSTP float ptr [ESI + 0x308]
00620ff7 : MOVSS XMM4,dword ptr [ESP + 0x14]
00620ffd : ADD ESP,0x4
00621000 : CMP dword ptr [0x00d6625c],EDI
00621006 : JZ 0x00621011
00621008 : PUSH ESI
00621009 : CALL 0x0061c6a0
0062100e : ADD ESP,0x4
00621011 : TEST byte ptr [ESI + 0x100],0x1
00621018 : JNZ 0x00621261
0062101e : MOV EAX,dword ptr [ESI + 0x164]
00621024 : TEST dword ptr [EAX + 0x68],0x200
0062102b : JZ 0x00621044
0062102d : FLD float ptr [ESP + 0x10]
00621031 : PUSH ECX
00621032 : FSTP float ptr [ESP]
00621035 : PUSH ESI
00621036 : CALL 0x0061e8c0
0062103b : MOVSS XMM4,dword ptr [ESP + 0x18]
00621041 : ADD ESP,0x8
00621044 : MOVSS XMM0,dword ptr [ESI + 0x108]
0062104c : MOVSS XMM1,dword ptr [ESI + 0x324]
00621054 : COMISS XMM1,dword ptr [0x00b9b0b4]
0062105b : ADDSS XMM0,XMM4
0062105f : MOVSS dword ptr [ESI + 0x108],XMM0
00621067 : JBE 0x00621084
00621069 : COMISS XMM0,XMM1
0062106c : JC 0x00621084
0062106e : MOV EAX,dword ptr [ESI + 0x328]
00621074 : TEST EAX,EAX
00621076 : JZ 0x00621084
00621078 : PUSH ESI
00621079 : CALL EAX
0062107b : MOVSS XMM4,dword ptr [ESP + 0x14]
00621081 : ADD ESP,0x4
00621084 : TEST byte ptr [ESI + 0x100],0x8
0062108b : JNZ 0x00621258
00621091 : MOV EAX,dword ptr [ESI + 0x27c]
00621097 : TEST EAX,EAX
00621099 : JZ 0x006210b0
0062109b : FLD float ptr [ESP + 0x10]
0062109f : PUSH ECX
006210a0 : FSTP float ptr [ESP]
006210a3 : PUSH ESI
006210a4 : CALL EAX
006210a6 : ADD ESP,0x8
006210a9 : MOV EDI,EAX
006210ab : JMP 0x00621221
006210b0 : PUSH EBX
006210b1 : MOV EBX,dword ptr [ESI + 0x164]
006210b7 : MOVSS XMM0,dword ptr [EBX + 0xcc]
006210bf : MULSS XMM0,dword ptr [ESI + 0x334]
006210c7 : MULSS XMM0,dword ptr [ESI + 0x30c]
006210cf : MULSS XMM0,XMM4
006210d3 : CVTTSS2SI EDI,XMM0
006210d7 : CVTSI2SS XMM1,EDI
006210db : SUBSS XMM0,XMM1
006210df : ADDSS XMM0,dword ptr [ESI + 0x10c]
006210e7 : COMISS XMM0,dword ptr [0x00b86060]
006210ee : MOVSS dword ptr [ESI + 0x10c],XMM0
006210f6 : JC 0x00621104
006210f8 : XORPS XMM0,XMM0
006210fb : MOVSS dword ptr [ESI + 0x10c],XMM0
00621103 : INC EDI
00621104 : CMP dword ptr [EBX + 0x104],0x0
0062110b : JLE 0x006211f9
00621111 : MOVSS XMM0,dword ptr [EBX + 0x1e8]
00621119 : MOVSS dword ptr [ESP + 0x10],XMM0
0062111f : CALL 0x00635d2f
00621124 : CDQ
00621125 : MOV ECX,0x64
0062112a : IDIV ECX
0062112c : MOVSS XMM2,dword ptr [EBX + 0x1ec]
00621134 : MOVSS XMM1,dword ptr [ESP + 0x10]
0062113a : MOVSS XMM4,dword ptr [ESP + 0x14]
00621140 : SUBSS XMM2,XMM1
00621144 : CVTSI2SS XMM0,EDX
00621148 : MULSS XMM0,dword ptr [0x00cdf23c]
00621150 : MULSS XMM0,XMM2
00621154 : XORPS XMM2,XMM2
00621157 : ADDSS XMM0,XMM1
0062115b : COMISS XMM4,XMM0
0062115e : MOVSS dword ptr [ESI + 0x350],XMM0
00621166 : JBE 0x006211af
00621168 : COMISS XMM0,XMM2
0062116b : JBE 0x006211af
0062116d : MOVSS XMM1,dword ptr [ESI + 0x34c]
00621175 : MOV EDX,dword ptr [ESI + 0x104]
0062117b : CVTSI2SS XMM3,dword ptr [EDX + 0x120]
00621183 : DIVSS XMM1,XMM0
00621187 : CVTSI2SS XMM0,dword ptr [EBX + 0x104]
0062118f : MULSS XMM1,XMM0
00621193 : MOVSS XMM0,dword ptr [EBX + 0xe4]
0062119b : SUBSS XMM0,XMM3
0062119f : COMISS XMM0,XMM1
006211a2 : JBE 0x006211a7
006211a4 : MOVAPS XMM0,XMM1
006211a7 : CVTTSS2SI EAX,XMM0
006211ab : ADD EDI,EAX
006211ad : JMP 0x006211f1
006211af : MOVSS XMM1,dword ptr [ESI + 0x34c]
006211b7 : COMISS XMM1,XMM0
006211ba : JBE 0x006211f9
006211bc : COMISS XMM0,XMM2
006211bf : JBE 0x006211f9
006211c1 : MOV ECX,dword ptr [ESI + 0x104]
006211c7 : CVTSI2SS XMM3,dword ptr [ECX + 0x120]
006211cf : MOVSS XMM0,dword ptr [EBX + 0xe4]
006211d7 : CVTSI2SS XMM1,dword ptr [EBX + 0x104]
006211df : SUBSS XMM0,XMM3
006211e3 : COMISS XMM0,XMM1
006211e6 : JBE 0x006211eb
006211e8 : MOVAPS XMM0,XMM1
006211eb : CVTTSS2SI EDX,XMM0
006211ef : ADD EDI,EDX
006211f1 : MOVSS dword ptr [ESI + 0x34c],XMM2
006211f9 : MOVSS XMM0,dword ptr [ESI + 0x34c]
00621201 : ADDSS XMM0,XMM4
00621205 : MOVSS dword ptr [ESI + 0x34c],XMM0
0062120d : TEST dword ptr [EBX + 0x68],0x40000000
00621214 : POP EBX
00621215 : JZ 0x00621221
00621217 : CMP EDI,0x1
0062121a : JLE 0x00621221
0062121c : MOV EDI,0x1
00621221 : MOV EAX,dword ptr [ESI + 0x164]
00621227 : MOV ECX,dword ptr [ESI + 0x104]
0062122d : MOVSS XMM0,dword ptr [EAX + 0xe4]
00621235 : MOV ECX,dword ptr [ECX + 0x120]
0062123b : MULSS XMM0,dword ptr [ESI + 0x30c]
00621243 : LEA EDX,[ECX + EDI*0x1]
00621246 : CVTTSS2SI EAX,XMM0
0062124a : CMP EDX,EAX
0062124c : JLE 0x00621252
0062124e : SUB EAX,ECX
00621250 : MOV EDI,EAX
00621252 : TEST EDI,EDI
00621254 : JGE 0x00621258
00621256 : XOR EDI,EDI
00621258 : MOV dword ptr [ESI + 0x15c],EDI
0062125e : POP EDI
0062125f : POP ESI
00621260 : RET
00621261 : XORPS XMM0,XMM0
00621264 : MOV dword ptr [ESI + 0x15c],EDI
0062126a : POP EDI
0062126b : MOVSS dword ptr [ESI + 0x26c],XMM0
00621273 : POP ESI
00621274 : RET

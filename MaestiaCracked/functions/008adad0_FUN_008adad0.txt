PROGRAM  : Maestia.exe
FUNCTION : FUN_008adad0
ENTRY    : 008adad0
BODY     : [[008adad0, 008adcf8]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008adad0(ushort *param_1)

{
  undefined1 *puVar1;
  short sVar2;
  int *piVar3;
  uint *puVar4;
  uint uVar5;
  int iVar6;
  short *psVar7;
  uint uVar8;
  int in_ECX;
  short *psVar9;
  uint uVar10;
  uint *puVar11;
  uint local_64;
  uint local_60;
  uint local_5c;
  int local_58;
  undefined1 local_49;
  uint local_48;
  uint local_44;
  uint local_40;
  undefined2 local_38;
  undefined4 local_28;
  undefined4 local_24;
  undefined1 local_20;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b44d89;
  local_10 = ExceptionList;
  uVar5 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  uVar10 = (*param_1 & 0x1fff) - 0xd;
  puVar11 = (uint *)((int)param_1 + 0xd);
  local_58 = 0;
  local_18 = uVar5;
  if (0 < *(int *)((int)param_1 + 5)) {
    do {
      if ((puVar11 == (uint *)0x0) || (uVar10 < 8)) {
LAB_008adb9a:
        psVar9 = (short *)0x0;
LAB_008adb9c:
        uVar10 = 0;
        puVar11 = (uint *)0x0;
      }
      else {
        local_60 = *puVar11;
        local_5c = puVar11[1];
        if ((puVar11 + 2 == (uint *)0x0) || (uVar10 - 8 < 4)) goto LAB_008adb9a;
        local_64 = puVar11[2];
        uVar10 = uVar10 - 0xc;
        if ((((puVar11 + 3 == (uint *)0x0) || (uVar10 < 2)) ||
            (sVar2 = (short)puVar11[3], sVar2 < 0)) || (iVar6 = (int)sVar2, (int)uVar10 < iVar6 + 2)
           ) goto LAB_008adb9a;
        psVar9 = (short *)((int)puVar11 + 0xe);
        puVar1 = (undefined1 *)((int)puVar11 + iVar6 + 0xe);
        iVar6 = uVar10 + (-2 - iVar6);
        if ((puVar1 == (undefined1 *)0x0) || (iVar6 == 0)) goto LAB_008adb9c;
        local_49 = *puVar1;
        if ((puVar1 == (undefined1 *)0xffffffff) || (iVar6 - 1U < 2)) goto LAB_008adb9c;
        uVar10 = iVar6 - 3;
        puVar11 = (uint *)(puVar1 + 3);
      }
      local_24 = 7;
      local_28 = 0;
      local_38 = 0;
      local_8 = 1;
      local_48 = local_60;
      local_40 = local_64;
      local_44 = local_5c;
      psVar7 = psVar9;
      do {
        sVar2 = *psVar7;
        psVar7 = psVar7 + 1;
      } while (sVar2 != 0);
      FUN_00406360(psVar9,(int)psVar7 - (int)(psVar9 + 1) >> 1);
      local_20 = local_49;
      if (*(int *)(in_ECX + 0x140) == 0) {
LAB_008adc5a:
        FUN_004309a0(&local_48);
      }
      else {
        uVar8 = *(uint *)(in_ECX + 0x13c);
        piVar3 = *(int **)(in_ECX + 0x124);
        if (piVar3 == (int *)0x0) {
          iVar6 = 0;
        }
        else {
          iVar6 = *piVar3;
        }
        if (*(uint *)(iVar6 + 0x14) <= uVar8) {
          if (piVar3 == (int *)0x0) {
            iVar6 = 0;
          }
          else {
            iVar6 = *piVar3;
          }
          uVar8 = uVar8 - *(int *)(iVar6 + 0x14);
        }
        if (piVar3 == (int *)0x0) {
          iVar6 = 0;
        }
        else {
          iVar6 = *piVar3;
        }
        puVar4 = *(uint **)(*(int *)(iVar6 + 0x10) + uVar8 * 4);
        uVar8 = puVar4[1];
        if (((int)local_44 < (int)uVar8) || (((int)local_44 <= (int)uVar8 && (local_48 <= *puVar4)))
           ) goto LAB_008adc5a;
        FUN_00430920();
      }
      local_8 = 0xffffffff;
      FUN_004199f0(&local_48);
      local_58 = local_58 + 1;
    } while (local_58 < *(int *)((int)param_1 + 5));
  }
  iVar6 = *(int *)(in_ECX + 0x140) + *(int *)(in_ECX + 0x13c);
  FUN_00430f80(iVar6 - *(int *)(in_ECX + 0x13c),FUN_008ab2f0,*(undefined4 *)(in_ECX + 0x124),
               *(int *)(in_ECX + 0x13c),*(undefined4 *)(in_ECX + 0x124),iVar6,uVar5);
  *(undefined4 *)(in_ECX + 0x144) = *(undefined4 *)((int)param_1 + 9);
  FUN_008acbb0(*(undefined2 *)(in_ECX + 0xb2),0);
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008adad0 : PUSH EBP
008adad1 : MOV EBP,ESP
008adad3 : PUSH -0x1
008adad5 : PUSH 0xb44d89
008adada : MOV EAX,FS:[0x0]
008adae0 : PUSH EAX
008adae1 : SUB ESP,0x58
008adae4 : MOV EAX,[0x00d66fa0]
008adae9 : XOR EAX,EBP
008adaeb : MOV dword ptr [EBP + -0x14],EAX
008adaee : PUSH EBX
008adaef : PUSH ESI
008adaf0 : PUSH EDI
008adaf1 : PUSH EAX
008adaf2 : LEA EAX,[EBP + -0xc]
008adaf5 : MOV FS:[0x0],EAX
008adafb : MOV EAX,dword ptr [EBP + 0x8]
008adafe : MOVZX EBX,word ptr [EAX]
008adb01 : AND EBX,0x1fff
008adb07 : MOV EDI,ECX
008adb09 : SUB EBX,0xd
008adb0c : CMP dword ptr [EAX + 0x5],0x0
008adb10 : MOV dword ptr [EBP + -0x4c],EDI
008adb13 : MOV dword ptr [EBP + -0x50],EAX
008adb16 : LEA ESI,[EAX + 0xd]
008adb19 : MOV dword ptr [EBP + -0x54],0x0
008adb20 : JLE 0x008adc8e
008adb26 : TEST ESI,ESI
008adb28 : JZ 0x008adb9a
008adb2a : CMP EBX,0x8
008adb2d : JC 0x008adb9a
008adb2f : MOV EAX,dword ptr [ESI]
008adb31 : MOV ECX,dword ptr [ESI + 0x4]
008adb34 : SUB EBX,0x8
008adb37 : ADD ESI,0x8
008adb3a : MOV dword ptr [EBP + -0x5c],EAX
008adb3d : MOV dword ptr [EBP + -0x58],ECX
008adb40 : JZ 0x008adb9a
008adb42 : CMP EBX,0x4
008adb45 : JC 0x008adb9a
008adb47 : MOV EDX,dword ptr [ESI]
008adb49 : SUB EBX,0x4
008adb4c : ADD ESI,0x4
008adb4f : MOV dword ptr [EBP + -0x60],EDX
008adb52 : JZ 0x008adb9a
008adb54 : CMP EBX,0x2
008adb57 : JC 0x008adb9a
008adb59 : MOVZX EAX,word ptr [ESI]
008adb5c : TEST AX,AX
008adb5f : JL 0x008adb9a
008adb61 : CWDE
008adb62 : LEA ECX,[EAX + 0x2]
008adb65 : CMP EBX,ECX
008adb67 : JL 0x008adb9a
008adb69 : MOV ECX,0xfffffffe
008adb6e : SUB ECX,EAX
008adb70 : LEA EDX,[ESI + 0x2]
008adb73 : LEA ESI,[ESI + EAX*0x1 + 0x2]
008adb77 : ADD EBX,ECX
008adb79 : TEST ESI,ESI
008adb7b : JZ 0x008adb9c
008adb7d : CMP EBX,0x1
008adb80 : JC 0x008adb9c
008adb82 : MOV AL,byte ptr [ESI]
008adb84 : DEC EBX
008adb85 : ADD ESI,0x1
008adb88 : MOV byte ptr [EBP + -0x45],AL
008adb8b : JZ 0x008adb9c
008adb8d : CMP EBX,0x2
008adb90 : JC 0x008adb9c
008adb92 : SUB EBX,0x2
008adb95 : ADD ESI,0x2
008adb98 : JMP 0x008adba0
008adb9a : XOR EDX,EDX
008adb9c : XOR EBX,EBX
008adb9e : XOR ESI,ESI
008adba0 : XOR ECX,ECX
008adba2 : MOV dword ptr [EBP + -0x20],0x7
008adba9 : MOV dword ptr [EBP + -0x24],0x0
008adbb0 : MOV word ptr [EBP + -0x34],CX
008adbb4 : MOV dword ptr [EBP + -0x4],0x1
008adbbb : MOV EAX,dword ptr [EBP + -0x5c]
008adbbe : MOV ECX,dword ptr [EBP + -0x58]
008adbc1 : MOV dword ptr [EBP + -0x44],EAX
008adbc4 : MOV EAX,dword ptr [EBP + -0x60]
008adbc7 : MOV dword ptr [EBP + -0x3c],EAX
008adbca : MOV EAX,EDX
008adbcc : MOV dword ptr [EBP + -0x40],ECX
008adbcf : LEA EDI,[EAX + 0x2]
008adbd2 : MOV CX,word ptr [EAX]
008adbd5 : ADD EAX,0x2
008adbd8 : TEST CX,CX
008adbdb : JNZ 0x008adbd2
008adbdd : SUB EAX,EDI
008adbdf : SAR EAX,0x1
008adbe1 : PUSH EAX
008adbe2 : PUSH EDX
008adbe3 : LEA ECX,[EBP + -0x38]
008adbe6 : CALL 0x00406360
008adbeb : MOV EAX,dword ptr [EBP + -0x4c]
008adbee : CMP dword ptr [EAX + 0x140],0x0
008adbf5 : MOV CL,byte ptr [EBP + -0x45]
008adbf8 : MOV byte ptr [EBP + -0x1c],CL
008adbfb : JZ 0x008adc5a
008adbfd : LEA ECX,[EAX + 0x124]
008adc03 : MOV EAX,dword ptr [ECX + 0x18]
008adc06 : MOV ECX,dword ptr [ECX]
008adc08 : TEST ECX,ECX
008adc0a : JZ 0x008adc10
008adc0c : MOV EDX,dword ptr [ECX]
008adc0e : JMP 0x008adc12
008adc10 : XOR EDX,EDX
008adc12 : CMP dword ptr [EDX + 0x14],EAX
008adc15 : JA 0x008adc24
008adc17 : TEST ECX,ECX
008adc19 : JZ 0x008adc1f
008adc1b : MOV EDX,dword ptr [ECX]
008adc1d : JMP 0x008adc21
008adc1f : XOR EDX,EDX
008adc21 : SUB EAX,dword ptr [EDX + 0x14]
008adc24 : TEST ECX,ECX
008adc26 : JZ 0x008adc2c
008adc28 : MOV ECX,dword ptr [ECX]
008adc2a : JMP 0x008adc2e
008adc2c : XOR ECX,ECX
008adc2e : MOV EDX,dword ptr [ECX + 0x10]
008adc31 : MOV EAX,dword ptr [EDX + EAX*0x4]
008adc34 : MOV ECX,dword ptr [EAX + 0x4]
008adc37 : CMP ECX,dword ptr [EBP + -0x40]
008adc3a : JG 0x008adc57
008adc3c : JL 0x008adc45
008adc3e : MOV EDX,dword ptr [EAX]
008adc40 : CMP EDX,dword ptr [EBP + -0x44]
008adc43 : JNC 0x008adc57
008adc45 : MOV EAX,dword ptr [EBP + -0x4c]
008adc48 : LEA EDI,[EBP + -0x44]
008adc4b : ADD EAX,0x124
008adc50 : CALL 0x00430920
008adc55 : JMP 0x008adc68
008adc57 : MOV EAX,dword ptr [EBP + -0x4c]
008adc5a : LEA ECX,[EBP + -0x44]
008adc5d : PUSH ECX
008adc5e : ADD EAX,0x124
008adc63 : CALL 0x004309a0
008adc68 : MOV dword ptr [EBP + -0x4],0xffffffff
008adc6f : LEA EDX,[EBP + -0x44]
008adc72 : PUSH EDX
008adc73 : CALL 0x004199f0
008adc78 : MOV EAX,dword ptr [EBP + -0x54]
008adc7b : MOV ECX,dword ptr [EBP + -0x50]
008adc7e : INC EAX
008adc7f : CMP EAX,dword ptr [ECX + 0x5]
008adc82 : MOV dword ptr [EBP + -0x54],EAX
008adc85 : JL 0x008adb26
008adc8b : MOV EDI,dword ptr [EBP + -0x4c]
008adc8e : MOV EAX,dword ptr [EDI + 0x140]
008adc94 : ADD EAX,dword ptr [EDI + 0x13c]
008adc9a : MOV ESI,dword ptr [EDI + 0x124]
008adca0 : MOV EDX,dword ptr [EDI + 0x13c]
008adca6 : PUSH EAX
008adca7 : PUSH ESI
008adca8 : PUSH EDX
008adca9 : MOV EBX,ESI
008adcab : MOV ECX,EAX
008adcad : PUSH EBX
008adcae : SUB ECX,EDX
008adcb0 : PUSH 0x8ab2f0
008adcb5 : PUSH ECX
008adcb6 : CALL 0x00430f80
008adcbb : MOVZX ECX,word ptr [EDI + 0xb2]
008adcc2 : MOV EDX,dword ptr [EBP + -0x50]
008adcc5 : MOV EAX,dword ptr [EDX + 0x9]
008adcc8 : ADD ESP,0x18
008adccb : PUSH 0x0
008adccd : PUSH ECX
008adcce : MOV ECX,EDI
008adcd0 : MOV dword ptr [EDI + 0x144],EAX
008adcd6 : CALL 0x008acbb0
008adcdb : MOV ECX,dword ptr [EBP + -0xc]
008adcde : MOV dword ptr FS:[0x0],ECX
008adce5 : POP ECX
008adce6 : POP EDI
008adce7 : POP ESI
008adce8 : POP EBX
008adce9 : MOV ECX,dword ptr [EBP + -0x14]
008adcec : XOR ECX,EBP
008adcee : CALL 0x00633e6b
008adcf3 : MOV ESP,EBP
008adcf5 : POP EBP
008adcf6 : RET 0x4

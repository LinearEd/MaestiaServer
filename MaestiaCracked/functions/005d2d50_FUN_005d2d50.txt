PROGRAM  : Maestia.exe
FUNCTION : FUN_005d2d50
ENTRY    : 005d2d50
BODY     : [[005d2d50, 005d2f36]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005d2d50(void)

{
  byte bVar1;
  uint uVar2;
  uint uVar3;
  byte *pbVar4;
  int *in_ECX;
  uint uVar5;
  uint uVar6;
  int iVar7;
  uint uVar8;
  int iVar9;
  uint local_3c;
  int *local_38;
  int local_34;
  int local_28;
  int local_24;
  int local_20;
  int local_14;
  int local_10;
  int local_c;
  int local_8;
  byte local_4;
  
  iVar9 = 0;
  iVar7 = 0;
  local_28 = -1;
  local_24 = 0;
  local_20 = -1;
  uVar8 = 0;
  local_14 = 0;
  local_8 = 0;
  local_c = 0;
  local_10 = 0;
  local_4 = 0;
  do {
    local_34 = ((undefined4 *)*in_ECX)[1];
    uVar5 = 0xffffffff;
    local_3c = 0xffffffff;
    if (local_34 != 0) {
      local_38 = *(int **)*in_ECX;
      pbVar4 = (byte *)(local_38 + 9);
      do {
        if (((uint)*pbVar4 & in_ECX[0xd]) != 0) {
          uVar2 = in_ECX[1];
          if (((*(int *)(pbVar4 + -0x14) != 0) &&
              (uVar3 = *(uint *)(pbVar4 + -0x18), uVar3 <= uVar2)) &&
             (uVar6 = *(int *)(pbVar4 + -0x14) + uVar3, uVar5 = local_3c, uVar2 < uVar6)) {
            if (local_24 == 0) {
              local_28 = *local_38;
              local_24 = *(int *)(pbVar4 + -0x20);
              local_20 = *(int *)(pbVar4 + -0x1c);
              local_14 = *(int *)(pbVar4 + -0x10);
              local_10 = *(int *)(pbVar4 + -0xc);
              local_c = *(int *)(pbVar4 + -8);
              local_8 = *(int *)(pbVar4 + -4);
              local_4 = *pbVar4;
              iVar9 = *(int *)(pbVar4 + -0x14) + (uVar3 - uVar2);
              uVar8 = uVar2;
              if (local_3c < iVar9 + uVar2) {
                iVar9 = local_3c - uVar2;
                local_3c = iVar9 + uVar2;
                uVar5 = local_3c;
              }
            }
            else if (((uint)*pbVar4 & in_ECX[0xd]) != in_ECX[0xd]) {
              if ((*pbVar4 & 7) != 0) {
                local_4 = local_4 & 0xf8 | *pbVar4 & 7;
              }
              bVar1 = *pbVar4;
              if ((bVar1 & 8) != 0) {
                local_10 = *(int *)(pbVar4 + -0xc);
                local_4 = local_4 | 8;
              }
              if ((bVar1 & 0x10) != 0) {
                local_c = *(int *)(pbVar4 + -8);
                local_4 = local_4 | 0x10;
              }
              if ((bVar1 & 0x20) != 0) {
                local_8 = *(int *)(pbVar4 + -4);
                local_4 = local_4 | 0x20;
              }
              uVar5 = iVar9 + uVar8;
              if (uVar6 < iVar9 + uVar8) {
                uVar5 = uVar6;
              }
              iVar9 = uVar5 - uVar8;
              local_3c = iVar9 + uVar8;
              uVar5 = local_3c;
            }
          }
          uVar3 = *(uint *)(pbVar4 + -0x18);
          if (uVar2 < uVar3) {
            if (uVar3 <= uVar5) {
              uVar5 = uVar3;
              local_3c = uVar3;
            }
            if ((local_24 != 0) && (uVar5 < iVar9 + uVar8)) {
              iVar9 = uVar5 - uVar8;
            }
          }
        }
        local_38 = local_38 + 10;
        pbVar4 = pbVar4 + 0x28;
        local_34 = local_34 + -1;
        iVar7 = local_24;
      } while (local_34 != 0);
    }
    in_ECX[3] = local_28;
    in_ECX[5] = local_20;
    in_ECX[8] = local_14;
    in_ECX[4] = iVar7;
    in_ECX[6] = uVar8;
    in_ECX[7] = iVar9;
    in_ECX[9] = local_10;
    in_ECX[10] = local_c;
    in_ECX[0xb] = local_8;
    *(byte *)(in_ECX + 0xc) = local_4;
    in_ECX[1] = uVar5;
  } while ((iVar7 == 0) && (uVar5 != 0xffffffff));
  return;
}



============================================================
DISASSEMBLY
============================================================
005d2d50 : SUB ESP,0x3c
005d2d53 : PUSH EBX
005d2d54 : PUSH EBP
005d2d55 : PUSH ESI
005d2d56 : XOR ESI,ESI
005d2d58 : OR EAX,0xffffffff
005d2d5b : XOR EBX,EBX
005d2d5d : PUSH EDI
005d2d5e : MOV EDI,ECX
005d2d60 : MOV dword ptr [ESP + 0x24],EAX
005d2d64 : MOV dword ptr [ESP + 0x28],EBX
005d2d68 : MOV dword ptr [ESP + 0x2c],EAX
005d2d6c : XOR EBP,EBP
005d2d6e : MOV dword ptr [ESP + 0x38],ESI
005d2d72 : MOV dword ptr [ESP + 0x44],ESI
005d2d76 : MOV dword ptr [ESP + 0x40],ESI
005d2d7a : MOV dword ptr [ESP + 0x3c],ESI
005d2d7e : MOV byte ptr [ESP + 0x48],BL
005d2d82 : MOV EAX,dword ptr [EDI]
005d2d84 : MOV EDX,dword ptr [EAX + 0x4]
005d2d87 : OR ECX,0xffffffff
005d2d8a : MOV dword ptr [ESP + 0x10],ECX
005d2d8e : TEST EDX,EDX
005d2d90 : JBE 0x005d2ee5
005d2d96 : MOV EAX,dword ptr [EAX]
005d2d98 : MOV dword ptr [ESP + 0x14],EAX
005d2d9c : ADD EAX,0x24
005d2d9f : MOV dword ptr [ESP + 0x18],EDX
005d2da3 : MOVZX EDX,byte ptr [EAX]
005d2da6 : AND EDX,dword ptr [EDI + 0x34]
005d2da9 : MOV dword ptr [ESP + 0x1c],EDX
005d2dad : JZ 0x005d2ece
005d2db3 : CMP dword ptr [EAX + -0x14],0x0
005d2db7 : MOV EBX,dword ptr [EDI + 0x4]
005d2dba : JBE 0x005d2eab
005d2dc0 : MOV EDX,dword ptr [EAX + -0x18]
005d2dc3 : CMP EBX,EDX
005d2dc5 : JC 0x005d2eab
005d2dcb : MOV ECX,dword ptr [EAX + -0x14]
005d2dce : ADD ECX,EDX
005d2dd0 : MOV dword ptr [ESP + 0x20],ECX
005d2dd4 : CMP EBX,ECX
005d2dd6 : JNC 0x005d2ea7
005d2ddc : CMP dword ptr [ESP + 0x28],0x0
005d2de1 : JNZ 0x005d2e3e
005d2de3 : MOV ECX,dword ptr [ESP + 0x14]
005d2de7 : MOV ECX,dword ptr [ECX]
005d2de9 : MOV ESI,dword ptr [EAX + -0x14]
005d2dec : MOV dword ptr [ESP + 0x24],ECX
005d2df0 : MOV ECX,dword ptr [EAX + -0x20]
005d2df3 : MOV dword ptr [ESP + 0x28],ECX
005d2df7 : MOV ECX,dword ptr [EAX + -0x1c]
005d2dfa : MOV dword ptr [ESP + 0x2c],ECX
005d2dfe : MOV ECX,dword ptr [EAX + -0x10]
005d2e01 : MOV dword ptr [ESP + 0x38],ECX
005d2e05 : MOV ECX,dword ptr [EAX + -0xc]
005d2e08 : MOV dword ptr [ESP + 0x3c],ECX
005d2e0c : MOV ECX,dword ptr [EAX + -0x8]
005d2e0f : MOV dword ptr [ESP + 0x40],ECX
005d2e13 : MOV ECX,dword ptr [EAX + -0x4]
005d2e16 : SUB EDX,EBX
005d2e18 : MOV dword ptr [ESP + 0x44],ECX
005d2e1c : MOV CL,byte ptr [EAX]
005d2e1e : ADD ESI,EDX
005d2e20 : MOV EBP,EBX
005d2e22 : MOV byte ptr [ESP + 0x48],CL
005d2e26 : MOV ECX,dword ptr [ESP + 0x10]
005d2e2a : LEA EDX,[ESI + EBP*0x1]
005d2e2d : CMP EDX,ECX
005d2e2f : JBE 0x005d2eab
005d2e31 : MOV ESI,ECX
005d2e33 : SUB ESI,EBP
005d2e35 : LEA ECX,[ESI + EBP*0x1]
005d2e38 : MOV dword ptr [ESP + 0x10],ECX
005d2e3c : JMP 0x005d2eab
005d2e3e : MOV ECX,dword ptr [EDI + 0x34]
005d2e41 : CMP dword ptr [ESP + 0x1c],ECX
005d2e45 : JZ 0x005d2ea7
005d2e47 : MOV DL,byte ptr [EAX]
005d2e49 : AND DL,0x7
005d2e4c : JZ 0x005d2e5b
005d2e4e : MOV CL,byte ptr [ESP + 0x48]
005d2e52 : AND CL,0xf8
005d2e55 : OR CL,DL
005d2e57 : MOV byte ptr [ESP + 0x48],CL
005d2e5b : MOV DL,byte ptr [EAX]
005d2e5d : TEST DL,0x8
005d2e60 : JZ 0x005d2e6e
005d2e62 : MOV ECX,dword ptr [EAX + -0xc]
005d2e65 : OR byte ptr [ESP + 0x48],0x8
005d2e6a : MOV dword ptr [ESP + 0x3c],ECX
005d2e6e : TEST DL,0x10
005d2e71 : JZ 0x005d2e7f
005d2e73 : MOV ECX,dword ptr [EAX + -0x8]
005d2e76 : OR byte ptr [ESP + 0x48],0x10
005d2e7b : MOV dword ptr [ESP + 0x40],ECX
005d2e7f : TEST DL,0x20
005d2e82 : JZ 0x005d2e90
005d2e84 : MOV EDX,dword ptr [EAX + -0x4]
005d2e87 : OR byte ptr [ESP + 0x48],0x20
005d2e8c : MOV dword ptr [ESP + 0x44],EDX
005d2e90 : MOV ECX,dword ptr [ESP + 0x20]
005d2e94 : ADD ESI,EBP
005d2e96 : CMP ECX,ESI
005d2e98 : JNC 0x005d2e9c
005d2e9a : MOV ESI,ECX
005d2e9c : SUB ESI,EBP
005d2e9e : LEA ECX,[ESI + EBP*0x1]
005d2ea1 : MOV dword ptr [ESP + 0x10],ECX
005d2ea5 : JMP 0x005d2eab
005d2ea7 : MOV ECX,dword ptr [ESP + 0x10]
005d2eab : MOV EDX,dword ptr [EAX + -0x18]
005d2eae : CMP EDX,EBX
005d2eb0 : JBE 0x005d2ece
005d2eb2 : CMP ECX,EDX
005d2eb4 : JC 0x005d2ebc
005d2eb6 : MOV ECX,EDX
005d2eb8 : MOV dword ptr [ESP + 0x10],ECX
005d2ebc : CMP dword ptr [ESP + 0x28],0x0
005d2ec1 : JZ 0x005d2ece
005d2ec3 : LEA EDX,[ESI + EBP*0x1]
005d2ec6 : CMP EDX,ECX
005d2ec8 : JBE 0x005d2ece
005d2eca : MOV ESI,ECX
005d2ecc : SUB ESI,EBP
005d2ece : ADD dword ptr [ESP + 0x14],0x28
005d2ed3 : ADD EAX,0x28
005d2ed6 : SUB dword ptr [ESP + 0x18],0x1
005d2edb : JNZ 0x005d2da3
005d2ee1 : MOV EBX,dword ptr [ESP + 0x28]
005d2ee5 : MOV EAX,dword ptr [ESP + 0x24]
005d2ee9 : MOV EDX,dword ptr [ESP + 0x2c]
005d2eed : MOV dword ptr [EDI + 0xc],EAX
005d2ef0 : MOV EAX,dword ptr [ESP + 0x38]
005d2ef4 : MOV dword ptr [EDI + 0x14],EDX
005d2ef7 : MOV EDX,dword ptr [ESP + 0x3c]
005d2efb : MOV dword ptr [EDI + 0x20],EAX
005d2efe : MOV EAX,dword ptr [ESP + 0x40]
005d2f02 : MOV dword ptr [EDI + 0x10],EBX
005d2f05 : MOV dword ptr [EDI + 0x18],EBP
005d2f08 : MOV dword ptr [EDI + 0x1c],ESI
005d2f0b : MOV dword ptr [EDI + 0x24],EDX
005d2f0e : MOV EDX,dword ptr [ESP + 0x44]
005d2f12 : MOV dword ptr [EDI + 0x28],EAX
005d2f15 : MOV AL,byte ptr [ESP + 0x48]
005d2f19 : MOV dword ptr [EDI + 0x2c],EDX
005d2f1c : MOV byte ptr [EDI + 0x30],AL
005d2f1f : MOV dword ptr [EDI + 0x4],ECX
005d2f22 : TEST EBX,EBX
005d2f24 : JNZ 0x005d2f2f
005d2f26 : CMP ECX,-0x1
005d2f29 : JNZ 0x005d2d82
005d2f2f : POP EDI
005d2f30 : POP ESI
005d2f31 : POP EBP
005d2f32 : POP EBX
005d2f33 : ADD ESP,0x3c
005d2f36 : RET

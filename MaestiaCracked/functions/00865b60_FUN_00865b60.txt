PROGRAM  : Maestia.exe
FUNCTION : FUN_00865b60
ENTRY    : 00865b60
BODY     : [[00865b60, 00865f22]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00865b60(int *param_1)

{
  int *piVar1;
  char cVar2;
  undefined2 uVar3;
  uint uVar4;
  undefined4 *puVar5;
  int iVar6;
  float *in_ECX;
  float10 fVar7;
  float fVar8;
  float fVar9;
  float fVar10;
  undefined1 local_90 [4];
  undefined2 local_8c;
  undefined4 local_7c;
  uint local_78;
  undefined1 local_74 [4];
  float local_70;
  float local_68;
  float local_64;
  float local_60;
  undefined4 local_5c;
  undefined4 local_58;
  undefined4 local_54;
  undefined4 local_50;
  undefined4 local_4c;
  undefined4 local_48;
  undefined4 local_44;
  float local_40;
  float local_3c;
  float local_38;
  float *local_34;
  undefined1 local_30 [4];
  undefined4 local_2c;
  int local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b5f223;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  param_1[0x11f] = 0;
  *(undefined1 *)(param_1 + 0x132) = 0;
  *(undefined1 *)(param_1 + 0x109) = 0;
  *(undefined1 *)((int)param_1 + 0x425) = 0;
  local_34 = in_ECX;
  local_14 = uVar4;
  FUN_00406360(&DAT_00c3f554,0);
  param_1[0x139] = 0;
  FUN_00406360(&DAT_00c3f61c,0);
  FUN_00406360(&DAT_00c3f840,0);
  iVar6 = param_1[0xfa];
  *(undefined1 *)((int)param_1 + 0x427) = 1;
  fVar8 = *in_ECX - *(float *)(iVar6 + 0x68);
  fVar9 = in_ECX[1] - *(float *)(iVar6 + 0x6c);
  fVar10 = in_ECX[2] - *(float *)(iVar6 + 0x70);
  fVar7 = (float10)FUN_0040f460(fVar8 * fVar8 + fVar9 * fVar9 + fVar10 * fVar10,uVar4);
  if (fVar7 < (float10)10.0) {
    FUN_00406460(L"ID_EF_REBIRTH_BY_SCROLL");
    local_8 = 0;
    FUN_0081cfe0(DAT_0172491c,local_90);
    local_8 = CONCAT31(local_8._1_3_,2);
    if (7 < local_78) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_78 = 7;
    local_7c = 0;
    local_8c = 0;
    puVar5 = local_2c;
    if (local_18 < 8) {
      puVar5 = &local_2c;
    }
    iVar6 = FUN_00405b70(puVar5);
    if ((iVar6 != 0) || (local_1c != 0)) {
      FUN_008980b0(local_30,1);
    }
    local_8 = 0xffffffff;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c = (undefined4 *)((uint)local_2c._2_2_ << 0x10);
  }
  iVar6 = param_1[0xfa];
  *(undefined8 *)(iVar6 + 0x74) = *(undefined8 *)(param_1 + 199);
  *(undefined8 *)(iVar6 + 0x7c) = *(undefined8 *)(param_1 + 0xc9);
  *(undefined1 *)(iVar6 + 0x5d) = 1;
  *(undefined1 *)(iVar6 + 0x134) = 1;
  *(undefined1 *)(iVar6 + 0x5c) = 1;
  if (*(int **)(iVar6 + 0x2c) != (int *)0x0) {
    (**(code **)(**(int **)(iVar6 + 0x2c) + 0x60))(iVar6);
  }
  local_40 = *in_ECX;
  local_3c = in_ECX[1];
  local_38 = in_ECX[2];
  if ((*(int *)(DAT_0172491c + 0x90) != 0) &&
     (iVar6 = *(int *)(*(int *)(DAT_0172491c + 0x90) + 0xf0), iVar6 != 0)) {
    local_64 = local_3c + 30.0;
    local_70 = 0.0;
    local_5c = 0;
    local_58 = 0;
    local_54 = 0;
    local_50 = 0;
    local_4c = 0xbf800000;
    local_48 = 0;
    local_44 = 0;
    local_68 = local_40;
    local_60 = local_38;
    iVar6 = FUN_007e9d70(iVar6,&local_50,local_74,&local_5c,&local_44);
    if ((iVar6 != 0) && (local_3c = local_34[1], local_3c < local_70)) {
      local_3c = local_70;
    }
  }
  (**(code **)(*param_1 + 0x2a0))(&local_40,1);
  *(undefined4 *)(*(int *)(param_1[0x4e] + 4) + 0x148 + (int)param_1) = 0;
  *(undefined4 *)(*(int *)(param_1[0x4e] + 4) + 0x14c + (int)param_1) = 0;
  *(undefined4 *)(*(int *)(param_1[0x4e] + 4) + 0x150 + (int)param_1) = 0;
  cVar2 = (**(code **)(*param_1 + 0x200))();
  (**(code **)(*(int *)(*(int *)(param_1[0x4e] + 4) + 0x138 + (int)param_1) + 0x10))
            (param_1 + 0x1b6,1,1,cVar2 != '\0');
  (**(code **)(*(int *)(*(int *)(param_1[0x4e] + 4) + 0x138 + (int)param_1) + 0x10))
            (param_1 + 0x322,1,1,0);
  if ((*DAT_00da9894 != 0) && (piVar1 = *(int **)(*DAT_00da9894 + 0x114), piVar1 != (int *)0x0)) {
    (**(code **)(*piVar1 + 4))(piVar1,"mc_party.SetPetDeadState","%d,%d",param_1[1],0);
  }
  iVar6 = *param_1;
  uVar3 = (**(code **)(iVar6 + 0x504))();
  (**(code **)(iVar6 + 0x4fc))(uVar3);
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00865b60 : PUSH EBP
00865b61 : MOV EBP,ESP
00865b63 : PUSH -0x1
00865b65 : PUSH 0xb5f223
00865b6a : MOV EAX,FS:[0x0]
00865b70 : PUSH EAX
00865b71 : SUB ESP,0x80
00865b77 : MOV EAX,[0x00d66fa0]
00865b7c : XOR EAX,EBP
00865b7e : MOV dword ptr [EBP + -0x10],EAX
00865b81 : PUSH EBX
00865b82 : PUSH ESI
00865b83 : PUSH EDI
00865b84 : PUSH EAX
00865b85 : LEA EAX,[EBP + -0xc]
00865b88 : MOV FS:[0x0],EAX
00865b8e : MOV EBX,dword ptr [EBP + 0x8]
00865b91 : XOR ESI,ESI
00865b93 : MOV EDI,ECX
00865b95 : PUSH ESI
00865b96 : PUSH 0xc3f554
00865b9b : LEA ECX,[EBX + 0x187c]
00865ba1 : MOV dword ptr [EBP + -0x30],EDI
00865ba4 : MOV dword ptr [EBX + 0x47c],ESI
00865baa : MOV byte ptr [EBX + 0x4c8],0x0
00865bb1 : MOV byte ptr [EBX + 0x424],0x0
00865bb8 : MOV byte ptr [EBX + 0x425],0x0
00865bbf : CALL 0x00406360
00865bc4 : PUSH ESI
00865bc5 : PUSH 0xc3f61c
00865bca : LEA ECX,[EBX + 0x558]
00865bd0 : MOV dword ptr [EBX + 0x4e4],ESI
00865bd6 : CALL 0x00406360
00865bdb : PUSH ESI
00865bdc : PUSH 0xc3f840
00865be1 : LEA ECX,[EBX + 0x574]
00865be7 : CALL 0x00406360
00865bec : MOV EAX,dword ptr [EBX + 0x3e8]
00865bf2 : MOV byte ptr [EBX + 0x427],0x1
00865bf9 : MOVSS XMM0,dword ptr [EDI]
00865bfd : SUBSS XMM0,dword ptr [EAX + 0x68]
00865c02 : MOVSS XMM1,dword ptr [EDI + 0x4]
00865c07 : SUBSS XMM1,dword ptr [EAX + 0x6c]
00865c0c : MOVSS XMM2,dword ptr [EDI + 0x8]
00865c11 : SUBSS XMM2,dword ptr [EAX + 0x70]
00865c16 : ADD EAX,0x68
00865c19 : MOVAPS XMM3,XMM0
00865c1c : MULSS XMM3,XMM0
00865c20 : MOVAPS XMM0,XMM1
00865c23 : MULSS XMM0,XMM1
00865c27 : ADDSS XMM3,XMM0
00865c2b : MOVAPS XMM0,XMM2
00865c2e : MULSS XMM0,XMM2
00865c32 : PUSH ECX
00865c33 : ADDSS XMM3,XMM0
00865c37 : MOVSS dword ptr [ESP],XMM3
00865c3c : CALL 0x0040f460
00865c41 : FLD float ptr [0x00c18874]
00865c47 : ADD ESP,0x4
00865c4a : FCOMIP ST0,ST1
00865c4c : FSTP ST0
00865c4e : JBE 0x00865d12
00865c54 : PUSH 0xc3f844
00865c59 : LEA ECX,[EBP + 0xffffff74]
00865c5f : CALL 0x00406460
00865c64 : MOV dword ptr [EBP + -0x4],ESI
00865c67 : MOV ECX,dword ptr [0x0172491c]
00865c6d : LEA EAX,[EBP + 0xffffff74]
00865c73 : PUSH EAX
00865c74 : PUSH ECX
00865c75 : LEA ESI,[EBP + -0x2c]
00865c78 : CALL 0x0081cfe0
00865c7d : MOV byte ptr [EBP + -0x4],0x2
00865c81 : MOV ESI,0x8
00865c86 : CMP dword ptr [EBP + -0x74],ESI
00865c89 : JC 0x00865c96
00865c8b : MOV ECX,dword ptr [EBP + 0xffffff78]
00865c91 : CALL 0x006f04e0
00865c96 : MOV EAX,dword ptr [EBP + -0x28]
00865c99 : XOR EDX,EDX
00865c9b : MOV dword ptr [EBP + -0x74],0x7
00865ca2 : MOV dword ptr [EBP + -0x78],0x0
00865ca9 : MOV word ptr [EBP + 0xffffff78],DX
00865cb0 : CMP dword ptr [EBP + -0x14],ESI
00865cb3 : JNC 0x00865cb8
00865cb5 : LEA EAX,[EBP + -0x28]
00865cb8 : PUSH EAX
00865cb9 : XOR EDX,EDX
00865cbb : MOV ECX,0xc3f874
00865cc0 : CALL 0x00405b70
00865cc5 : ADD ESP,0x4
00865cc8 : TEST EAX,EAX
00865cca : JNZ 0x00865cd6
00865ccc : CMP dword ptr [EBP + -0x18],EAX
00865ccf : SETNZ AL
00865cd2 : TEST EAX,EAX
00865cd4 : JZ 0x00865ce8
00865cd6 : PUSH 0x1
00865cd8 : LEA EAX,[EBP + -0x2c]
00865cdb : PUSH EAX
00865cdc : MOV ESI,EBX
00865cde : CALL 0x008980b0
00865ce3 : MOV ESI,0x8
00865ce8 : MOV dword ptr [EBP + -0x4],0xffffffff
00865cef : CMP dword ptr [EBP + -0x14],ESI
00865cf2 : JC 0x00865cfc
00865cf4 : MOV ECX,dword ptr [EBP + -0x28]
00865cf7 : CALL 0x006f04e0
00865cfc : XOR ECX,ECX
00865cfe : MOV dword ptr [EBP + -0x14],0x7
00865d05 : MOV dword ptr [EBP + -0x18],0x0
00865d0c : MOV word ptr [EBP + -0x28],CX
00865d10 : XOR ESI,ESI
00865d12 : MOV EAX,dword ptr [EBX + 0x3e8]
00865d18 : MOVQ XMM0,qword ptr [EBX + 0x31c]
00865d20 : MOV ECX,dword ptr [EAX + 0x2c]
00865d23 : MOVQ qword ptr [EAX + 0x74],XMM0
00865d28 : MOVQ XMM0,qword ptr [EBX + 0x324]
00865d30 : MOVQ qword ptr [EAX + 0x7c],XMM0
00865d35 : MOV byte ptr [EAX + 0x5d],0x1
00865d39 : MOV byte ptr [EAX + 0x134],0x1
00865d40 : MOV byte ptr [EAX + 0x5c],0x1
00865d44 : CMP ECX,ESI
00865d46 : JZ 0x00865d50
00865d48 : MOV EDX,dword ptr [ECX]
00865d4a : PUSH EAX
00865d4b : MOV EAX,dword ptr [EDX + 0x60]
00865d4e : CALL EAX
00865d50 : MOVSS XMM1,dword ptr [EDI]
00865d54 : MOVSS XMM0,dword ptr [EDI + 0x4]
00865d59 : MOVSS XMM2,dword ptr [EDI + 0x8]
00865d5e : MOV ECX,dword ptr [0x0172491c]
00865d64 : MOVSS dword ptr [EBP + -0x3c],XMM1
00865d69 : MOVSS dword ptr [EBP + -0x38],XMM0
00865d6e : MOVSS dword ptr [EBP + -0x34],XMM2
00865d73 : MOV EAX,dword ptr [ECX + 0x90]
00865d79 : CMP EAX,ESI
00865d7b : JZ 0x00865e16
00865d81 : MOV EAX,dword ptr [EAX + 0xf0]
00865d87 : CMP EAX,ESI
00865d89 : JZ 0x00865e16
00865d8f : ADDSS XMM0,dword ptr [0x00cdf12c]
00865d97 : LEA EDX,[EBP + -0x40]
00865d9a : PUSH EDX
00865d9b : LEA ECX,[EBP + -0x58]
00865d9e : PUSH ECX
00865d9f : LEA EDX,[EBP + -0x70]
00865da2 : PUSH EDX
00865da3 : LEA ECX,[EBP + -0x4c]
00865da6 : PUSH ECX
00865da7 : MOVSS dword ptr [EBP + -0x64],XMM1
00865dac : MOVSS XMM1,dword ptr [0x00cdf0d0]
00865db4 : MOVSS dword ptr [EBP + -0x60],XMM0
00865db9 : XORPS XMM0,XMM0
00865dbc : PUSH EAX
00865dbd : LEA EDI,[EBP + -0x64]
00865dc0 : MOVSS dword ptr [EBP + -0x5c],XMM2
00865dc5 : MOVSS dword ptr [EBP + -0x6c],XMM0
00865dca : MOVSS dword ptr [EBP + -0x58],XMM0
00865dcf : MOVSS dword ptr [EBP + -0x54],XMM0
00865dd4 : MOVSS dword ptr [EBP + -0x50],XMM0
00865dd9 : MOVSS dword ptr [EBP + -0x4c],XMM0
00865dde : MOVSS dword ptr [EBP + -0x48],XMM1
00865de3 : MOVSS dword ptr [EBP + -0x44],XMM0
00865de8 : MOVSS dword ptr [EBP + -0x40],XMM0
00865ded : CALL 0x007e9d70
00865df2 : XOR ESI,ESI
00865df4 : TEST EAX,EAX
00865df6 : JZ 0x00865e16
00865df8 : MOV EDX,dword ptr [EBP + -0x30]
00865dfb : MOVSS XMM0,dword ptr [EDX + 0x4]
00865e00 : MOVSS XMM1,dword ptr [EBP + -0x6c]
00865e05 : COMISS XMM1,XMM0
00865e08 : JBE 0x00865e11
00865e0a : MOVSS dword ptr [EBP + -0x38],XMM1
00865e0f : JMP 0x00865e16
00865e11 : MOVSS dword ptr [EBP + -0x38],XMM0
00865e16 : MOV EAX,dword ptr [EBX]
00865e18 : MOV EDX,dword ptr [EAX + 0x2a0]
00865e1e : PUSH 0x1
00865e20 : LEA ECX,[EBP + -0x3c]
00865e23 : PUSH ECX
00865e24 : MOV ECX,EBX
00865e26 : CALL EDX
00865e28 : MOV EAX,dword ptr [EBX + 0x138]
00865e2e : MOV ECX,dword ptr [EAX + 0x4]
00865e31 : MOV dword ptr [ECX + EBX*0x1 + 0x148],ESI
00865e38 : MOV EDX,dword ptr [EBX + 0x138]
00865e3e : MOV EAX,dword ptr [EDX + 0x4]
00865e41 : MOV dword ptr [EAX + EBX*0x1 + 0x14c],ESI
00865e48 : MOV ECX,dword ptr [EBX + 0x138]
00865e4e : MOV EDX,dword ptr [ECX + 0x4]
00865e51 : MOV dword ptr [EDX + EBX*0x1 + 0x150],ESI
00865e58 : MOV EAX,dword ptr [EBX]
00865e5a : MOV EDX,dword ptr [EAX + 0x200]
00865e60 : MOV ECX,EBX
00865e62 : CALL EDX
00865e64 : TEST AL,AL
00865e66 : MOV EAX,dword ptr [EBX + 0x138]
00865e6c : MOV ECX,dword ptr [EAX + 0x4]
00865e6f : MOV EDX,dword ptr [ECX + EBX*0x1 + 0x138]
00865e76 : MOV EDX,dword ptr [EDX + 0x10]
00865e79 : LEA ECX,[ECX + EBX*0x1 + 0x138]
00865e80 : LEA EAX,[EBX + 0x6d8]
00865e86 : JZ 0x00865e8c
00865e88 : PUSH 0x1
00865e8a : JMP 0x00865e8d
00865e8c : PUSH ESI
00865e8d : PUSH 0x1
00865e8f : PUSH 0x1
00865e91 : PUSH EAX
00865e92 : CALL EDX
00865e94 : MOV EAX,dword ptr [EBX + 0x138]
00865e9a : MOV ECX,dword ptr [EAX + 0x4]
00865e9d : MOV EDX,dword ptr [ECX + EBX*0x1 + 0x138]
00865ea4 : MOV EDX,dword ptr [EDX + 0x10]
00865ea7 : PUSH ESI
00865ea8 : PUSH 0x1
00865eaa : LEA ECX,[ECX + EBX*0x1 + 0x138]
00865eb1 : PUSH 0x1
00865eb3 : LEA EAX,[EBX + 0xc88]
00865eb9 : PUSH EAX
00865eba : CALL EDX
00865ebc : MOV EAX,[0x00da9894]
00865ec1 : MOV EAX,dword ptr [EAX]
00865ec3 : CMP EAX,ESI
00865ec5 : JZ 0x00865eeb
00865ec7 : MOV EAX,dword ptr [EAX + 0x114]
00865ecd : CMP EAX,ESI
00865ecf : JZ 0x00865eeb
00865ed1 : MOV EDX,dword ptr [EBX + 0x4]
00865ed4 : MOV ECX,dword ptr [EAX]
00865ed6 : PUSH ESI
00865ed7 : PUSH EDX
00865ed8 : PUSH 0xc3f878
00865edd : PUSH 0xc3f880
00865ee2 : PUSH EAX
00865ee3 : MOV EAX,dword ptr [ECX + 0x4]
00865ee6 : CALL EAX
00865ee8 : ADD ESP,0x14
00865eeb : MOV ESI,dword ptr [EBX]
00865eed : MOV EDX,dword ptr [ESI + 0x504]
00865ef3 : MOV ECX,EBX
00865ef5 : CALL EDX
00865ef7 : MOV EDX,dword ptr [ESI + 0x4fc]
00865efd : MOVZX EAX,AX
00865f00 : PUSH EAX
00865f01 : MOV ECX,EBX
00865f03 : CALL EDX
00865f05 : MOV ECX,dword ptr [EBP + -0xc]
00865f08 : MOV dword ptr FS:[0x0],ECX
00865f0f : POP ECX
00865f10 : POP EDI
00865f11 : POP ESI
00865f12 : POP EBX
00865f13 : MOV ECX,dword ptr [EBP + -0x10]
00865f16 : XOR ECX,EBP
00865f18 : CALL 0x00633e6b
00865f1d : MOV ESP,EBP
00865f1f : POP EBP
00865f20 : RET 0x4

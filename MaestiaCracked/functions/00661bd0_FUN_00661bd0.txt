PROGRAM  : Maestia.exe
FUNCTION : FUN_00661bd0
ENTRY    : 00661bd0
BODY     : [[00661bd0, 00661c87]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00661bd0(int param_1,int param_2)

{
  int iVar1;
  undefined1 auStack_58 [72];
  uint local_10;
  void *local_c;
  undefined1 *puStack_8;
  undefined4 uStack_4;
  
  uStack_4 = 0xffffffff;
  puStack_8 = &LAB_00b0c5f8;
  local_c = ExceptionList;
  local_10 = DAT_00d66fa0 ^ (uint)auStack_58;
  ExceptionList = &local_c;
  if ((param_2 != 0) &&
     (iVar1 = (**(code **)(**(int **)(param_1 + 8) + 0x10))(DAT_00d66fa0 ^ (uint)&stack0xffffffa0),
     iVar1 == *(int *)(param_1 + 0xc))) {
    *(int *)(param_1 + 4) = *(int *)(param_1 + 4) + param_2;
    FUN_006645f0();
    uStack_4 = 0;
    (**(code **)(**(int **)(param_1 + 8) + 0x34))(*(int *)(param_1 + 4) + -1,auStack_58);
    uStack_4 = 0xffffffff;
    FUN_006645b0();
  }
  ExceptionList = local_c;
  __security_check_cookie(local_10 ^ (uint)auStack_58);
  return;
}



============================================================
DISASSEMBLY
============================================================
00661bd0 : PUSH -0x1
00661bd2 : PUSH 0xb0c5f8
00661bd7 : MOV EAX,FS:[0x0]
00661bdd : PUSH EAX
00661bde : SUB ESP,0x4c
00661be1 : MOV EAX,[0x00d66fa0]
00661be6 : XOR EAX,ESP
00661be8 : MOV dword ptr [ESP + 0x48],EAX
00661bec : PUSH ESI
00661bed : PUSH EDI
00661bee : MOV EAX,[0x00d66fa0]
00661bf3 : XOR EAX,ESP
00661bf5 : PUSH EAX
00661bf6 : LEA EAX,[ESP + 0x58]
00661bfa : MOV FS:[0x0],EAX
00661c00 : MOV EDI,dword ptr [ESP + 0x6c]
00661c04 : MOV ESI,dword ptr [ESP + 0x68]
00661c08 : TEST EDI,EDI
00661c0a : JNZ 0x00661c10
00661c0c : XOR EAX,EAX
00661c0e : JMP 0x00661c69
00661c10 : MOV ECX,dword ptr [ESI + 0x8]
00661c13 : MOV EAX,dword ptr [ECX]
00661c15 : MOV EDX,dword ptr [EAX + 0x10]
00661c18 : CALL EDX
00661c1a : CMP EAX,dword ptr [ESI + 0xc]
00661c1d : JZ 0x00661c26
00661c1f : MOV EAX,0x80040203
00661c24 : JMP 0x00661c69
00661c26 : ADD dword ptr [ESI + 0x4],EDI
00661c29 : LEA ECX,[ESP + 0xc]
00661c2d : CALL 0x006645f0
00661c32 : MOV ECX,dword ptr [ESI + 0x8]
00661c35 : MOV EAX,dword ptr [ECX]
00661c37 : MOV EAX,dword ptr [EAX + 0x34]
00661c3a : LEA EDX,[ESP + 0xc]
00661c3e : PUSH EDX
00661c3f : MOV EDX,dword ptr [ESI + 0x4]
00661c42 : DEC EDX
00661c43 : PUSH EDX
00661c44 : MOV dword ptr [ESP + 0x68],0x0
00661c4c : CALL EAX
00661c4e : MOV ESI,EAX
00661c50 : NEG ESI
00661c52 : SBB ESI,ESI
00661c54 : LEA ECX,[ESP + 0xc]
00661c58 : NEG ESI
00661c5a : MOV dword ptr [ESP + 0x60],0xffffffff
00661c62 : CALL 0x006645b0
00661c67 : MOV EAX,ESI
00661c69 : MOV ECX,dword ptr [ESP + 0x58]
00661c6d : MOV dword ptr FS:[0x0],ECX
00661c74 : POP ECX
00661c75 : POP EDI
00661c76 : POP ESI
00661c77 : MOV ECX,dword ptr [ESP + 0x48]
00661c7b : XOR ECX,ESP
00661c7d : CALL 0x00633e6b
00661c82 : ADD ESP,0x58
00661c85 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_005c4690
ENTRY    : 005c4690
BODY     : [[005c4690, 005c47a5]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005c4690(undefined4 param_1,uint *param_2,uint param_3)

{
  uint *puVar1;
  uint *puVar2;
  uint *puVar3;
  int *piVar4;
  int *in_ECX;
  uint uVar5;
  uint uVar6;
  int iVar7;
  
  piVar4 = (int *)*in_ECX;
  if (piVar4 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar4 * 5) <= piVar4[1] * 4 + 4U) goto LAB_005c46ca;
    iVar7 = piVar4[1] * 2 + 2;
  }
  FUN_005c4520(param_1,iVar7);
LAB_005c46ca:
  piVar4 = (int *)*in_ECX;
  param_3 = param_3 & piVar4[1];
  *piVar4 = *piVar4 + 1;
  iVar7 = *in_ECX;
  puVar1 = (uint *)(iVar7 + 8 + param_3 * 0xc);
  if (*(int *)(iVar7 + 8 + param_3 * 0xc) == -2) {
    *puVar1 = 0xffffffff;
    puVar1[1] = *param_2;
    puVar1[2] = param_2[1];
    return;
  }
  uVar5 = param_3;
  do {
    uVar5 = uVar5 + 1 & *(uint *)(iVar7 + 4);
  } while (*(int *)(iVar7 + 8 + uVar5 * 0xc) != -2);
  puVar2 = (uint *)(iVar7 + 8 + uVar5 * 0xc);
  uVar6 = puVar1[1] & *(uint *)(iVar7 + 4);
  if (uVar6 != param_3) {
    puVar3 = (uint *)(iVar7 + 8 + uVar6 * 0xc);
    for (uVar6 = *(uint *)(iVar7 + 8 + uVar6 * 0xc); uVar6 != param_3;
        uVar6 = *(uint *)(iVar7 + 8 + uVar6 * 0xc)) {
      uVar6 = *puVar3;
      puVar3 = (uint *)(iVar7 + 8 + uVar6 * 0xc);
    }
    if (puVar2 != (uint *)0x0) {
      *puVar2 = *puVar1;
      puVar2[1] = puVar1[1];
      puVar2[2] = puVar1[2];
    }
    *puVar3 = uVar5;
    puVar1[1] = *param_2;
    uVar5 = param_2[1];
    *puVar1 = 0xffffffff;
    puVar1[2] = uVar5;
    return;
  }
  if (puVar2 != (uint *)0x0) {
    *puVar2 = *puVar1;
    puVar2[1] = puVar1[1];
    puVar2[2] = puVar1[2];
  }
  puVar1[1] = *param_2;
  uVar6 = param_2[1];
  *puVar1 = uVar5;
  puVar1[2] = uVar6;
  return;
}



============================================================
DISASSEMBLY
============================================================
005c4690 : PUSH ESI
005c4691 : MOV ESI,ECX
005c4693 : MOV EAX,dword ptr [ESI]
005c4695 : PUSH EDI
005c4696 : TEST EAX,EAX
005c4698 : JNZ 0x005c46a3
005c469a : MOV EAX,dword ptr [ESP + 0xc]
005c469e : PUSH 0x8
005c46a0 : PUSH EAX
005c46a1 : JMP 0x005c46c5
005c46a3 : MOV ECX,dword ptr [EAX + 0x4]
005c46a6 : LEA EDX,[ECX*0x4 + 0x4]
005c46ad : MOV ECX,dword ptr [EAX]
005c46af : LEA ECX,[ECX + ECX*0x4]
005c46b2 : CMP ECX,EDX
005c46b4 : JBE 0x005c46ca
005c46b6 : MOV EDX,dword ptr [EAX + 0x4]
005c46b9 : MOV ECX,dword ptr [ESP + 0xc]
005c46bd : LEA EAX,[EDX + EDX*0x1 + 0x2]
005c46c1 : PUSH EAX
005c46c2 : PUSH ECX
005c46c3 : MOV ECX,ESI
005c46c5 : CALL 0x005c4520
005c46ca : MOV ECX,dword ptr [ESI]
005c46cc : MOV EAX,dword ptr [ESP + 0x14]
005c46d0 : AND EAX,dword ptr [ECX + 0x4]
005c46d3 : INC dword ptr [ECX]
005c46d5 : MOV ESI,dword ptr [ESI]
005c46d7 : LEA EDX,[EAX + EAX*0x2]
005c46da : MOV ECX,dword ptr [ESI + EDX*0x4 + 0x8]
005c46de : LEA EDX,[ESI + EDX*0x4 + 0x8]
005c46e2 : MOV EDI,0xfffffffe
005c46e7 : CMP ECX,EDI
005c46e9 : JNZ 0x005c4705
005c46eb : MOV EAX,dword ptr [ESP + 0x10]
005c46ef : MOV dword ptr [EDX],0xffffffff
005c46f5 : MOV ECX,dword ptr [EAX]
005c46f7 : MOV dword ptr [EDX + 0x4],ECX
005c46fa : MOV EAX,dword ptr [EAX + 0x4]
005c46fd : POP EDI
005c46fe : MOV dword ptr [EDX + 0x8],EAX
005c4701 : POP ESI
005c4702 : RET 0xc
005c4705 : PUSH EBX
005c4706 : PUSH EBP
005c4707 : MOV EBP,dword ptr [ESI + 0x4]
005c470a : MOV ECX,EAX
005c470c : LEA ESP,[ESP]
005c4710 : INC ECX
005c4711 : AND ECX,EBP
005c4713 : LEA EBX,[ECX + ECX*0x2]
005c4716 : CMP dword ptr [ESI + EBX*0x4 + 0x8],EDI
005c471a : JNZ 0x005c4710
005c471c : LEA EDI,[ECX + ECX*0x2]
005c471f : LEA EBX,[ESI + EDI*0x4 + 0x8]
005c4723 : MOV EDI,dword ptr [EDX + 0x4]
005c4726 : AND EDI,EBP
005c4728 : CMP EDI,EAX
005c472a : JNZ 0x005c4758
005c472c : TEST EBX,EBX
005c472e : JZ 0x005c4740
005c4730 : MOV EAX,dword ptr [EDX]
005c4732 : MOV dword ptr [EBX],EAX
005c4734 : MOV EAX,dword ptr [EDX + 0x4]
005c4737 : MOV dword ptr [EBX + 0x4],EAX
005c473a : MOV EAX,dword ptr [EDX + 0x8]
005c473d : MOV dword ptr [EBX + 0x8],EAX
005c4740 : MOV EAX,dword ptr [ESP + 0x18]
005c4744 : MOV ESI,dword ptr [EAX]
005c4746 : POP EBP
005c4747 : MOV dword ptr [EDX + 0x4],ESI
005c474a : MOV EAX,dword ptr [EAX + 0x4]
005c474d : POP EBX
005c474e : POP EDI
005c474f : MOV dword ptr [EDX],ECX
005c4751 : MOV dword ptr [EDX + 0x8],EAX
005c4754 : POP ESI
005c4755 : RET 0xc
005c4758 : LEA EDI,[EDI + EDI*0x2]
005c475b : CMP dword ptr [ESI + EDI*0x4 + 0x8],EAX
005c475f : LEA EDI,[ESI + EDI*0x4 + 0x8]
005c4763 : JZ 0x005c4774
005c4765 : MOV EDI,dword ptr [EDI]
005c4767 : LEA EDI,[EDI + EDI*0x2]
005c476a : CMP dword ptr [ESI + EDI*0x4 + 0x8],EAX
005c476e : LEA EDI,[ESI + EDI*0x4 + 0x8]
005c4772 : JNZ 0x005c4765
005c4774 : TEST EBX,EBX
005c4776 : JZ 0x005c4788
005c4778 : MOV EAX,dword ptr [EDX]
005c477a : MOV dword ptr [EBX],EAX
005c477c : MOV EAX,dword ptr [EDX + 0x4]
005c477f : MOV dword ptr [EBX + 0x4],EAX
005c4782 : MOV EAX,dword ptr [EDX + 0x8]
005c4785 : MOV dword ptr [EBX + 0x8],EAX
005c4788 : MOV EAX,dword ptr [ESP + 0x18]
005c478c : MOV dword ptr [EDI],ECX
005c478e : MOV ECX,dword ptr [EAX]
005c4790 : POP EBP
005c4791 : POP EBX
005c4792 : MOV dword ptr [EDX + 0x4],ECX
005c4795 : MOV EAX,dword ptr [EAX + 0x4]
005c4798 : POP EDI
005c4799 : MOV dword ptr [EDX],0xffffffff
005c479f : MOV dword ptr [EDX + 0x8],EAX
005c47a2 : POP ESI
005c47a3 : RET 0xc

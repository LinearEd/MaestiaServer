PROGRAM  : Maestia.exe
FUNCTION : FUN_008d0470
ENTRY    : 008d0470
BODY     : [[008d0470, 008d04ad] [008d04b0, 008d063b] [008d066b, 008d0685]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_008d0470(int param_1,char param_2)

{
  int iVar1;
  int iVar2;
  ushort uVar3;
  code *pcVar4;
  uint uVar5;
  short sVar6;
  ushort uVar7;
  int iVar8;
  undefined4 *puVar9;
  undefined4 uVar10;
  ushort uVar11;
  bool bVar12;
  undefined4 local_1c;
  uint local_18;
  code *local_14;
  uint local_c;
  int *local_8;
  
  local_c = 0;
  local_18 = 0;
  local_8 = *(int **)(param_1 + 0xac);
  local_1c = 0xffffffff;
  local_14 = FUN_00989680;
  uVar10 = 0xffffffff;
  if (local_8 != *(int **)(param_1 + 0xb0)) {
    do {
      uVar10 = *(undefined4 *)*local_8;
      iVar8 = FUN_00a1a840(uVar10);
      if (((iVar8 == 0) && (iVar8 = FUN_00a1a6d0(uVar10), iVar8 == 0)) &&
         (iVar8 = FUN_00a1a780(uVar10), iVar8 == 0)) {
LAB_008d0632:
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      iVar1 = iVar8 + 0x1158;
      iVar2 = *(int *)(*(int *)(iVar8 + 0x138) + 4) + 0x138 + iVar8;
      sVar6 = FUN_0043d970();
      if (sVar6 == 1000) {
        bVar12 = *(int *)(iVar2 + 4) == iVar1;
      }
      else if (sVar6 == 2000) {
        bVar12 = *(int *)(iVar2 + 8) == iVar1;
      }
      else {
        bVar12 = *(int *)(iVar2 + 0xc) == iVar1;
      }
      if ((bVar12) || (*(char *)(iVar8 + 0x3ad) == '\0')) goto LAB_008d0632;
      uVar3 = *(ushort *)(iVar8 + 0x80);
      if (uVar3 == 0) {
        uVar3 = *(ushort *)(iVar8 + 0x7c);
      }
      iVar1 = *(int *)(DAT_0172491c + 0x17c);
      uVar7 = *(ushort *)(iVar1 + 0x80);
      uVar11 = uVar7;
      if (uVar7 == 0) {
        uVar11 = *(ushort *)(iVar1 + 0x7c);
      }
      if ((uVar11 < 5) || (4 < uVar3)) {
        if (uVar7 == 0) {
          uVar7 = *(ushort *)(iVar1 + 0x7c);
        }
      }
      else {
        uVar7 = FUN_0042a760();
      }
      if (uVar7 == uVar3) goto LAB_008d0632;
      if ((param_2 == '\0') || ((uint)(*(int *)(param_1 + 0xc4) == 0) != *(uint *)(*local_8 + 4))) {
        pcVar4 = *(code **)(iVar8 + 0xa4);
        if (pcVar4 < local_14) {
          puVar9 = (undefined4 *)*local_8;
LAB_008d0612:
          local_1c = *puVar9;
          local_c = puVar9[2];
          local_18 = puVar9[3];
          local_14 = pcVar4;
        }
        else if (local_14 == pcVar4) {
          puVar9 = (undefined4 *)*local_8;
          uVar5 = puVar9[2];
          if (local_c < uVar5) {
            local_1c = *puVar9;
            local_18 = puVar9[3];
            local_14 = pcVar4;
            local_c = uVar5;
          }
          if ((local_c == uVar5) && ((uint)puVar9[3] < local_18)) goto LAB_008d0612;
        }
      }
      local_8 = local_8 + 1;
      uVar10 = local_1c;
    } while (local_8 != *(int **)(param_1 + 0xb0));
  }
  return uVar10;
}



============================================================
DISASSEMBLY
============================================================
008d0470 : PUSH EBP
008d0471 : MOV EBP,ESP
008d0473 : SUB ESP,0x18
008d0476 : XOR ECX,ECX
008d0478 : MOV dword ptr [EBP + -0x8],ECX
008d047b : MOV dword ptr [EBP + -0x14],ECX
008d047e : MOV ECX,dword ptr [EBP + 0x8]
008d0481 : MOV EDX,dword ptr [ECX + 0xac]
008d0487 : OR EAX,0xffffffff
008d048a : MOV dword ptr [EBP + -0x18],EAX
008d048d : MOV dword ptr [EBP + -0x10],0x989680
008d0494 : MOV dword ptr [EBP + -0x4],EDX
008d0497 : CMP EDX,dword ptr [ECX + 0xb0]
008d049d : JZ 0x008d0680
008d04a3 : PUSH EBX
008d04a4 : PUSH ESI
008d04a5 : LEA EAX,[EDX + 0x4]
008d04a8 : PUSH EDI
008d04a9 : MOV dword ptr [EBP + -0xc],EAX
008d04ac : JMP 0x008d04b3
008d04b0 : MOV EDX,dword ptr [EBP + -0x4]
008d04b3 : MOV EDX,dword ptr [EDX]
008d04b5 : MOV EDI,dword ptr [EDX]
008d04b7 : MOV ECX,dword ptr [0x00da93ec]
008d04bd : PUSH EDI
008d04be : MOV EBX,ECX
008d04c0 : CALL 0x00a1a840
008d04c5 : MOV ESI,EAX
008d04c7 : TEST ESI,ESI
008d04c9 : JNZ 0x008d04eb
008d04cb : PUSH EDI
008d04cc : MOV ECX,EBX
008d04ce : CALL 0x00a1a6d0
008d04d3 : MOV ESI,EAX
008d04d5 : TEST ESI,ESI
008d04d7 : JNZ 0x008d04eb
008d04d9 : PUSH EDI
008d04da : MOV ECX,EBX
008d04dc : CALL 0x00a1a780
008d04e1 : MOV ESI,EAX
008d04e3 : TEST ESI,ESI
008d04e5 : JZ 0x008d0632
008d04eb : MOV EAX,dword ptr [ESI + 0x138]
008d04f1 : MOV ECX,dword ptr [EAX + 0x4]
008d04f4 : MOV AX,word ptr [ESI + 0x1182]
008d04fb : LEA EDI,[ESI + 0x1158]
008d0501 : LEA EBX,[ECX + ESI*0x1 + 0x138]
008d0508 : CALL 0x0043d970
008d050d : MOV EDX,0x3e8
008d0512 : CMP AX,DX
008d0515 : JNZ 0x008d051c
008d0517 : CMP dword ptr [EBX + 0x4],EDI
008d051a : JMP 0x008d052e
008d051c : MOV ECX,0x7d0
008d0521 : CMP AX,CX
008d0524 : JNZ 0x008d052b
008d0526 : CMP dword ptr [EBX + 0x8],EDI
008d0529 : JMP 0x008d052e
008d052b : CMP dword ptr [EBX + 0xc],EDI
008d052e : SETZ AL
008d0531 : TEST AL,AL
008d0533 : JNZ 0x008d0632
008d0539 : CMP byte ptr [ESI + 0x3ad],AL
008d053f : JZ 0x008d0632
008d0545 : MOVZX EAX,word ptr [ESI + 0x80]
008d054c : MOVZX EDI,AX
008d054f : TEST AX,AX
008d0552 : JNZ 0x008d0558
008d0554 : MOVZX EDI,word ptr [ESI + 0x7c]
008d0558 : MOV EDX,dword ptr [0x0172491c]
008d055e : MOV ECX,dword ptr [EDX + 0x17c]
008d0564 : MOVZX EAX,word ptr [ECX + 0x80]
008d056b : MOVZX EDX,AX
008d056e : TEST AX,AX
008d0571 : JNZ 0x008d0577
008d0573 : MOVZX EDX,word ptr [ECX + 0x7c]
008d0577 : CMP DX,0x5
008d057b : JC 0x008d058d
008d057d : CMP DI,0x5
008d0581 : JNC 0x008d058d
008d0583 : CALL 0x0042a760
008d0588 : CMP AX,DI
008d058b : JMP 0x008d059c
008d058d : TEST AX,AX
008d0590 : MOVZX EAX,AX
008d0593 : JNZ 0x008d0599
008d0595 : MOVZX EAX,word ptr [ECX + 0x7c]
008d0599 : CMP DI,AX
008d059c : SETZ AL
008d059f : TEST AL,AL
008d05a1 : JNZ 0x008d0632
008d05a7 : CMP byte ptr [EBP + 0xc],AL
008d05aa : JZ 0x008d05d3
008d05ac : MOV ECX,dword ptr [EBP + 0x8]
008d05af : XOR EAX,EAX
008d05b1 : CMP dword ptr [ECX + 0xc4],EAX
008d05b7 : MOV ECX,dword ptr [EBP + -0x4]
008d05ba : MOV EDX,dword ptr [ECX]
008d05bc : SETZ AL
008d05bf : CMP EAX,dword ptr [EDX + 0x4]
008d05c2 : JNZ 0x008d05d6
008d05c4 : ADD ECX,0x4
008d05c7 : ADD dword ptr [EBP + -0xc],0x4
008d05cb : MOV dword ptr [EBP + -0x4],ECX
008d05ce : JMP 0x008d066b
008d05d3 : MOV ECX,dword ptr [EBP + -0x4]
008d05d6 : MOV ESI,dword ptr [ESI + 0xa4]
008d05dc : MOV EAX,dword ptr [EBP + -0x10]
008d05df : CMP EAX,ESI
008d05e1 : JBE 0x008d05e7
008d05e3 : MOV EAX,dword ptr [ECX]
008d05e5 : JMP 0x008d0612
008d05e7 : JNZ 0x008d0626
008d05e9 : MOV EAX,dword ptr [ECX]
008d05eb : MOV EDX,dword ptr [EAX + 0x8]
008d05ee : CMP dword ptr [EBP + -0x8],EDX
008d05f1 : JNC 0x008d0608
008d05f3 : MOV EDI,dword ptr [EAX]
008d05f5 : MOV dword ptr [EBP + -0x18],EDI
008d05f8 : MOV EDI,EDX
008d05fa : MOV dword ptr [EBP + -0x8],EDI
008d05fd : MOV EDI,dword ptr [EAX + 0xc]
008d0600 : MOV dword ptr [EBP + -0x10],ESI
008d0603 : MOV dword ptr [EBP + -0x14],EDI
008d0606 : CMP EDX,EDX
008d0608 : JNZ 0x008d0626
008d060a : MOV EDX,dword ptr [EBP + -0x14]
008d060d : CMP EDX,dword ptr [EAX + 0xc]
008d0610 : JBE 0x008d0626
008d0612 : MOV EDX,dword ptr [EAX]
008d0614 : MOV dword ptr [EBP + -0x18],EDX
008d0617 : MOV EDX,dword ptr [EAX + 0x8]
008d061a : MOV EAX,dword ptr [EAX + 0xc]
008d061d : MOV dword ptr [EBP + -0x14],EAX
008d0620 : MOV dword ptr [EBP + -0x8],EDX
008d0623 : MOV dword ptr [EBP + -0x10],ESI
008d0626 : ADD ECX,0x4
008d0629 : ADD dword ptr [EBP + -0xc],0x4
008d062d : MOV dword ptr [EBP + -0x4],ECX
008d0630 : JMP 0x008d066b
008d0632 : MOV ESI,dword ptr [EBP + -0x4]
008d0635 : MOV ECX,dword ptr [ESI]
008d0637 : CALL 0x006f04e0
008d066b : MOV EDX,dword ptr [EBP + 0x8]
008d066e : CMP ECX,dword ptr [EDX + 0xb0]
008d0674 : JNZ 0x008d04b0
008d067a : MOV EAX,dword ptr [EBP + -0x18]
008d067d : POP EDI
008d067e : POP ESI
008d067f : POP EBX
008d0680 : MOV ESP,EBP
008d0682 : POP EBP
008d0683 : RET 0x8

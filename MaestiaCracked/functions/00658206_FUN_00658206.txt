PROGRAM  : Maestia.exe
FUNCTION : FUN_00658206
ENTRY    : 00658206
BODY     : [[00658206, 0065840b]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 FUN_00658206(undefined4 param_1,uint param_2,ushort param_3)

{
  undefined4 in_EAX;
  int iVar1;
  float10 fVar2;
  float10 fVar3;
  undefined4 in_stack_0000001c;
  undefined2 uStack00000020;
  undefined2 uStack00000022;
  ushort in_stack_00000024;
  
  if ((((((CONCAT22(param_3,param_2._2_2_) ^ 0x700) & 0x700) == 0) &&
       ((&DAT_00d6800c)[(param_2._2_2_ & 0x7800) >> 0xb] != '\0')) && ((param_3 & 0x7fff) != 0x7fff)
      ) && ((((in_stack_00000024 & 0x7fff) != 0 && ((in_stack_00000024 & 0x7fff) != 0x7fff)) &&
            (((_uStack00000020 & 0x7fffffff) == 0 && ((param_2 & 0x7fffffff) == 0)))))) {
    if ((ushort)((param_3 & 0x7fff) + 0x3f) < (in_stack_00000024 & 0x7fff)) {
      iVar1 = ((in_stack_00000024 & 0x7fff) - (param_3 & 0x7fff) & 0x3f | 0x20) + 1;
      fVar3 = ABS((float10)CONCAT28(in_stack_00000024 & 0x7fff | param_3 & 0x8000,
                                    CONCAT26(param_2._2_2_,CONCAT24((undefined2)param_2,param_1))));
      fVar2 = ABS((float10)CONCAT28(in_stack_00000024,
                                    CONCAT26(uStack00000022,
                                             CONCAT24(uStack00000020,in_stack_0000001c))));
      do {
        if (fVar3 <= fVar2) {
          fVar2 = fVar2 - fVar3;
        }
        fVar3 = fVar3 * (float10)_DAT_00d6803c;
        iVar1 = iVar1 + -1;
      } while (iVar1 != 0);
    }
    else {
      while (-1 < (int)((in_stack_00000024 & 0x7fff) - ((param_3 & 0x7fff) + 10))) {
        fVar2 = (float10)CONCAT28(in_stack_00000024,
                                  CONCAT26(uStack00000022,CONCAT24(uStack00000020,in_stack_0000001c)
                                          ));
        fVar3 = (float10)CONCAT28((in_stack_00000024 & 0x7fff) -
                                  ((in_stack_00000024 & 0x7fff) - param_3 & 7 | 4) |
                                  param_3 & 0x8000,
                                  CONCAT26(param_2._2_2_,CONCAT24((undefined2)param_2,param_1)));
        fVar2 = fVar2 - (fVar2 / fVar3) * fVar3;
        in_stack_0000001c = SUB104(fVar2,0);
        uStack00000020 = (undefined2)((unkuint10)fVar2 >> 0x20);
        uStack00000022 = (undefined2)((unkuint10)fVar2 >> 0x30);
        in_stack_00000024 = (ushort)((unkuint10)fVar2 >> 0x40);
      }
    }
  }
  return in_EAX;
}



============================================================
DISASSEMBLY
============================================================
00658206 : PUSH EAX
00658207 : PUSH EBX
00658208 : PUSH ECX
00658209 : MOV EAX,dword ptr [ESP + 0x16]
0065820d : XOR EAX,0x700
00658212 : TEST EAX,0x700
00658217 : JNZ 0x006583a0
0065821d : SHR EAX,0xb
00658220 : AND EAX,0xf
00658223 : CMP byte ptr [EAX + 0xd6800c],0x0
0065822a : JZ 0x006583a0
00658230 : MOV EAX,dword ptr [ESP + 0x16]
00658234 : AND EAX,0x7fff0000
00658239 : CMP EAX,0x7fff0000
0065823e : JZ 0x006583a0
00658244 : MOV EAX,dword ptr [ESP + 0x2e]
00658248 : AND EAX,0x7fff0000
0065824d : JZ 0x006583a0
00658253 : CMP EAX,0x7fff0000
00658258 : JZ 0x006583a0
0065825e : MOV EAX,dword ptr [ESP + 0x2c]
00658262 : ADD EAX,EAX
00658264 : JNZ 0x006583a0
0065826a : MOV EAX,dword ptr [ESP + 0x14]
0065826e : ADD EAX,EAX
00658270 : JNZ 0x006583a0
00658276 : MOV EAX,dword ptr [ESP + 0x18]
0065827a : AND EAX,0x7fff
0065827f : ADD EAX,0x3f
00658282 : MOV EBX,dword ptr [ESP + 0x30]
00658286 : AND EBX,0x7fff
0065828c : SUB EBX,EAX
0065828e : JA 0x006582ee
00658290 : MOV EAX,dword ptr [ESP + 0x18]
00658294 : AND EAX,0x7fff
00658299 : ADD EAX,0xa
0065829c : MOV EBX,dword ptr [ESP + 0x30]
006582a0 : AND EBX,0x7fff
006582a6 : SUB EBX,EAX
006582a8 : JS 0x006583a0
006582ae : FLD extended double ptr [ESP + 0x28]
006582b2 : MOV EAX,dword ptr [ESP + 0x18]
006582b6 : MOV EBX,dword ptr [ESP + 0x30]
006582ba : AND EBX,0x7fff
006582c0 : MOV ECX,EBX
006582c2 : SUB EBX,EAX
006582c4 : AND EBX,0x7
006582c7 : OR EBX,0x4
006582ca : SUB ECX,EBX
006582cc : MOV EBX,EAX
006582ce : AND EBX,0x8000
006582d4 : OR ECX,EBX
006582d6 : MOV dword ptr [ESP + 0x18],ECX
006582da : FLD extended double ptr [ESP + 0x10]
006582de : MOV dword ptr [ESP + 0x18],EAX
006582e2 : FXCH
006582e4 : FPREM
006582e6 : FSTP extended double ptr [ESP + 0x28]
006582ea : FSTP ST0
006582ec : JMP 0x00658290
006582ee : TEST EDX,0x2
006582f4 : JNZ 0x006582fe
006582f6 : FLD extended double ptr [ESP + 0x10]
006582fa : FSTP extended double ptr [ESP + 0x1c]
006582fe : FNSTCW word ptr [ESP + 0x34]
00658302 : MOV EAX,dword ptr [ESP + 0x34]
00658306 : OR EAX,0x33f
0065830b : MOV dword ptr [ESP + 0x38],EAX
0065830f : FLDCW word ptr [ESP + 0x38]
00658313 : MOV EAX,dword ptr [ESP + 0x18]
00658317 : AND EAX,0x7fff
0065831c : MOV EBX,dword ptr [ESP + 0x30]
00658320 : AND EBX,0x7fff
00658326 : SUB EBX,EAX
00658328 : AND EBX,0x3f
0065832b : OR EBX,0x20
0065832e : ADD EBX,0x1
00658331 : MOV ECX,EBX
00658333 : MOV EAX,dword ptr [ESP + 0x18]
00658337 : MOV EBX,dword ptr [ESP + 0x30]
0065833b : AND EBX,0x7fff
00658341 : AND EAX,0x8000
00658346 : OR EBX,EAX
00658348 : MOV dword ptr [ESP + 0x18],EBX
0065834c : FLD extended double ptr [ESP + 0x10]
00658350 : FABS
00658352 : FLD extended double ptr [ESP + 0x28]
00658356 : FABS
00658358 : FCOM
0065835a : FNSTSW AX
0065835c : AND EAX,0x100
00658361 : JNZ 0x00658365
00658363 : FSUB ST0,ST1
00658365 : FXCH
00658367 : FMUL double ptr [0x00d6803c]
0065836d : FXCH
0065836f : SUB ECX,0x1
00658372 : JNZ 0x00658358
00658374 : MOV EBX,dword ptr [ESP + 0x30]
00658378 : FSTP extended double ptr [ESP + 0x28]
0065837c : FSTP ST0
0065837e : FLD extended double ptr [ESP + 0x1c]
00658382 : FLD extended double ptr [0x00d68044]
00658388 : FPREM
0065838a : FSTP ST0
0065838c : FLD extended double ptr [ESP + 0x28]
00658390 : FLDCW word ptr [ESP + 0x34]
00658394 : AND EBX,0x8000
0065839a : JZ 0x006583aa
0065839c : FCHS
0065839e : JMP 0x006583aa
006583a0 : FLD extended double ptr [ESP + 0x10]
006583a4 : FLD extended double ptr [ESP + 0x28]
006583a8 : FPREM
006583aa : TEST EDX,0x3
006583b0 : JZ 0x00658408
006583b2 : FNSTSW word ptr [ESP + 0x3c]
006583b6 : TEST EDX,0x1
006583bc : JZ 0x006583dd
006583be : FNSTCW word ptr [ESP + 0x34]
006583c2 : MOV EAX,dword ptr [ESP + 0x34]
006583c6 : OR EAX,0x300
006583cb : MOV dword ptr [ESP + 0x38],EAX
006583cf : FLDCW word ptr [ESP + 0x38]
006583d3 : FMUL double ptr [0x00d6802c]
006583d9 : FLDCW word ptr [ESP + 0x34]
006583dd : MOV EAX,dword ptr [ESP + 0x3c]
006583e1 : FXCH
006583e3 : FSTP ST0
006583e5 : FLD extended double ptr [ESP + 0x1c]
006583e9 : FXCH
006583eb : AND EAX,0x4300
006583f0 : SUB ESP,0x1c
006583f3 : FNSTENV [ESP]
006583f6 : AND dword ptr [ESP + 0x4],0xbcff
006583fe : OR dword ptr [ESP + 0x4],EAX
00658402 : FLDENV [ESP]
00658405 : ADD ESP,0x1c
00658408 : POP ECX
00658409 : POP EBX
0065840a : POP EAX
0065840b : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_0051b7e0
ENTRY    : 0051b7e0
BODY     : [[0051b7e0, 0051b892]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0051b7e0(undefined4 param_1)

{
  uint uVar1;
  uint uVar2;
  LONG LVar3;
  uint *in_ECX;
  uint uVar4;
  uint *puVar5;
  int local_10;
  undefined1 local_c [8];
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)&local_10;
  puVar5 = (uint *)(*in_ECX & 0xfffffffc);
  uVar2 = *puVar5;
  local_10 = 0;
  FUN_0051ad90(local_c,&local_10,param_1);
  uVar4 = *in_ECX & 3;
  uVar1 = DAT_00d73250;
  if (uVar4 != 0) {
    if (uVar4 == 1) {
      uVar1 = FUN_00515dd0(in_ECX);
    }
    else {
      uVar1 = 0;
      if (uVar4 == 2) {
        uVar1 = in_ECX[1];
      }
    }
  }
  uVar2 = FUN_0051b760(uVar1,local_10 + (uVar2 & 0x7fffffff),0,puVar5 + 2,uVar2 & 0x7fffffff,local_c
                       ,local_10);
  *in_ECX = *in_ECX & 3 | uVar2;
  LVar3 = InterlockedExchangeAdd((LONG *)(puVar5 + 1),-1);
  if (LVar3 == 1) {
    FUN_00515cf0(puVar5);
  }
  __security_check_cookie(local_4 ^ (uint)&local_10);
  return;
}



============================================================
DISASSEMBLY
============================================================
0051b7e0 : SUB ESP,0x10
0051b7e3 : MOV EAX,[0x00d66fa0]
0051b7e8 : XOR EAX,ESP
0051b7ea : MOV dword ptr [ESP + 0xc],EAX
0051b7ee : MOV EAX,dword ptr [ESP + 0x14]
0051b7f2 : PUSH EBX
0051b7f3 : PUSH ESI
0051b7f4 : PUSH EDI
0051b7f5 : MOV ESI,ECX
0051b7f7 : MOV EDI,dword ptr [ESI]
0051b7f9 : PUSH EAX
0051b7fa : LEA ECX,[ESP + 0x10]
0051b7fe : AND EDI,0xfffffffc
0051b801 : MOV EBX,dword ptr [EDI]
0051b803 : PUSH ECX
0051b804 : LEA EDX,[ESP + 0x18]
0051b808 : PUSH EDX
0051b809 : AND EBX,0x7fffffff
0051b80f : MOV dword ptr [ESP + 0x18],0x0
0051b817 : CALL 0x0051ad90
0051b81c : MOV ECX,dword ptr [ESI]
0051b81e : XOR EAX,EAX
0051b820 : AND ECX,0x3
0051b823 : SUB ECX,EAX
0051b825 : JZ 0x0051b83e
0051b827 : SUB ECX,0x1
0051b82a : JZ 0x0051b836
0051b82c : SUB ECX,0x1
0051b82f : JNZ 0x0051b843
0051b831 : MOV EAX,dword ptr [ESI + 0x4]
0051b834 : JMP 0x0051b843
0051b836 : PUSH ESI
0051b837 : CALL 0x00515dd0
0051b83c : JMP 0x0051b843
0051b83e : MOV EAX,[0x00d73250]
0051b843 : MOV ECX,dword ptr [ESP + 0xc]
0051b847 : PUSH ECX
0051b848 : LEA EDX,[ESP + 0x14]
0051b84c : PUSH EDX
0051b84d : PUSH EBX
0051b84e : LEA EDX,[EDI + 0x8]
0051b851 : PUSH EDX
0051b852 : PUSH 0x0
0051b854 : ADD ECX,EBX
0051b856 : PUSH ECX
0051b857 : PUSH EAX
0051b858 : MOV ECX,ESI
0051b85a : CALL 0x0051b760
0051b85f : MOV ECX,dword ptr [ESI]
0051b861 : AND ECX,0x3
0051b864 : OR ECX,EAX
0051b866 : PUSH -0x1
0051b868 : LEA EAX,[EDI + 0x4]
0051b86b : PUSH EAX
0051b86c : MOV dword ptr [ESI],ECX
0051b86e : CALL dword ptr [0x00b851cc]
0051b874 : SUB EAX,0x1
0051b877 : JNZ 0x0051b87f
0051b879 : PUSH EDI
0051b87a : CALL 0x00515cf0
0051b87f : MOV ECX,dword ptr [ESP + 0x18]
0051b883 : POP EDI
0051b884 : POP ESI
0051b885 : POP EBX
0051b886 : XOR ECX,ESP
0051b888 : CALL 0x00633e6b
0051b88d : ADD ESP,0x10
0051b890 : RET 0x4

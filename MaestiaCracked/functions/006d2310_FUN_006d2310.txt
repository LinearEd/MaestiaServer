PROGRAM  : Maestia.exe
FUNCTION : FUN_006d2310
ENTRY    : 006d2310
BODY     : [[006d2310, 006d2507]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006d2310(int param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_8;
  
  local_8 = 0;
  if ((*(uint *)(param_1 + 0x68) & 4) != 0) {
    iVar1 = _memcmp((void *)(param_1 + 0x11c),&DAT_00bed89c,4);
    if (iVar1 != 0) {
      *(uint *)(param_1 + 0x68) = *(uint *)(param_1 + 0x68) | 8;
    }
  }
  FUN_006d2510(param_1,param_1 + 0x11c);
  if ((*(byte *)(param_1 + 0x11c) & 0x20) == 0) {
    iVar1 = FUN_006cd240(param_1,param_1 + 0x11c);
    if ((iVar1 != 3) && (*(int *)(param_1 + 0x21c) == 0)) {
      FUN_006c2560(param_1,"unknown critical chunk");
    }
  }
  if (((*(uint *)(param_1 + 0x6c) & 0x8000) == 0) && (*(int *)(param_1 + 0x21c) == 0)) {
    local_8 = param_3;
  }
  else {
    _strcpy((char *)(param_1 + 0x268),(char *)(param_1 + 0x11c));
    uVar2 = FUN_006cee20(param_1,param_3);
    *(undefined4 *)(param_1 + 0x270) = uVar2;
    *(undefined4 *)(param_1 + 0x274) = param_3;
    FUN_006cf100(param_1,*(undefined4 *)(param_1 + 0x270),param_3);
    if (*(int *)(param_1 + 0x21c) != 0) {
      iVar1 = (**(code **)(param_1 + 0x21c))(param_1,param_1 + 0x268);
      if (iVar1 < 0) {
        FUN_006c2560(param_1,"error in user chunk");
      }
      if (iVar1 == 0) {
        if ((*(byte *)(param_1 + 0x11c) & 0x20) == 0) {
          iVar1 = FUN_006cd240(param_1,param_1 + 0x11c);
          if (iVar1 != 3) {
            FUN_006c2560(param_1,"unknown critical chunk");
          }
        }
        FUN_006ceb00(param_1,param_2,param_1 + 0x268,1);
      }
    }
    FUN_006ceee0(param_1,*(undefined4 *)(param_1 + 0x270));
    *(undefined4 *)(param_1 + 0x270) = 0;
  }
  FUN_006cf140(param_1,local_8);
  return;
}



============================================================
DISASSEMBLY
============================================================
006d2310 : PUSH EBP
006d2311 : MOV EBP,ESP
006d2313 : SUB ESP,0x8
006d2316 : MOV dword ptr [EBP + -0x4],0x0
006d231d : MOV EAX,dword ptr [EBP + 0x8]
006d2320 : MOV ECX,dword ptr [EAX + 0x68]
006d2323 : AND ECX,0x4
006d2326 : JZ 0x006d2354
006d2328 : PUSH 0x4
006d232a : PUSH 0xbed89c
006d232f : MOV EDX,dword ptr [EBP + 0x8]
006d2332 : ADD EDX,0x11c
006d2338 : PUSH EDX
006d2339 : CALL 0x00640edf
006d233e : ADD ESP,0xc
006d2341 : TEST EAX,EAX
006d2343 : JZ 0x006d2354
006d2345 : MOV EAX,dword ptr [EBP + 0x8]
006d2348 : MOV ECX,dword ptr [EAX + 0x68]
006d234b : OR ECX,0x8
006d234e : MOV EDX,dword ptr [EBP + 0x8]
006d2351 : MOV dword ptr [EDX + 0x68],ECX
006d2354 : MOV EAX,dword ptr [EBP + 0x8]
006d2357 : ADD EAX,0x11c
006d235c : PUSH EAX
006d235d : MOV ECX,dword ptr [EBP + 0x8]
006d2360 : PUSH ECX
006d2361 : CALL 0x006d2510
006d2366 : ADD ESP,0x8
006d2369 : MOV EDX,dword ptr [EBP + 0x8]
006d236c : MOVZX EAX,byte ptr [EDX + 0x11c]
006d2373 : AND EAX,0x20
006d2376 : JNZ 0x006d23b0
006d2378 : MOV ECX,dword ptr [EBP + 0x8]
006d237b : ADD ECX,0x11c
006d2381 : PUSH ECX
006d2382 : MOV EDX,dword ptr [EBP + 0x8]
006d2385 : PUSH EDX
006d2386 : CALL 0x006cd240
006d238b : ADD ESP,0x8
006d238e : CMP EAX,0x3
006d2391 : JZ 0x006d23b0
006d2393 : MOV EAX,dword ptr [EBP + 0x8]
006d2396 : CMP dword ptr [EAX + 0x21c],0x0
006d239d : JNZ 0x006d23b0
006d239f : PUSH 0xbeee44
006d23a4 : MOV ECX,dword ptr [EBP + 0x8]
006d23a7 : PUSH ECX
006d23a8 : CALL 0x006c2560
006d23ad : ADD ESP,0x8
006d23b0 : MOV EDX,dword ptr [EBP + 0x8]
006d23b3 : MOV EAX,dword ptr [EDX + 0x6c]
006d23b6 : AND EAX,0x8000
006d23bb : JNZ 0x006d23cd
006d23bd : MOV ECX,dword ptr [EBP + 0x8]
006d23c0 : CMP dword ptr [ECX + 0x21c],0x0
006d23c7 : JZ 0x006d24ee
006d23cd : MOV EDX,dword ptr [EBP + 0x8]
006d23d0 : ADD EDX,0x11c
006d23d6 : PUSH EDX
006d23d7 : MOV EAX,dword ptr [EBP + 0x8]
006d23da : ADD EAX,0x268
006d23df : PUSH EAX
006d23e0 : CALL 0x006d4a70
006d23e5 : ADD ESP,0x8
006d23e8 : MOV ECX,dword ptr [EBP + 0x10]
006d23eb : PUSH ECX
006d23ec : MOV EDX,dword ptr [EBP + 0x8]
006d23ef : PUSH EDX
006d23f0 : CALL 0x006cee20
006d23f5 : ADD ESP,0x8
006d23f8 : MOV ECX,dword ptr [EBP + 0x8]
006d23fb : MOV dword ptr [ECX + 0x270],EAX
006d2401 : MOV EDX,dword ptr [EBP + 0x8]
006d2404 : MOV EAX,dword ptr [EBP + 0x10]
006d2407 : MOV dword ptr [EDX + 0x274],EAX
006d240d : MOV ECX,dword ptr [EBP + 0x10]
006d2410 : PUSH ECX
006d2411 : MOV EDX,dword ptr [EBP + 0x8]
006d2414 : MOV EAX,dword ptr [EDX + 0x270]
006d241a : PUSH EAX
006d241b : MOV ECX,dword ptr [EBP + 0x8]
006d241e : PUSH ECX
006d241f : CALL 0x006cf100
006d2424 : ADD ESP,0xc
006d2427 : MOV EDX,dword ptr [EBP + 0x8]
006d242a : CMP dword ptr [EDX + 0x21c],0x0
006d2431 : JZ 0x006d24c9
006d2437 : MOV EAX,dword ptr [EBP + 0x8]
006d243a : ADD EAX,0x268
006d243f : PUSH EAX
006d2440 : MOV ECX,dword ptr [EBP + 0x8]
006d2443 : PUSH ECX
006d2444 : MOV EDX,dword ptr [EBP + 0x8]
006d2447 : MOV EAX,dword ptr [EDX + 0x21c]
006d244d : CALL EAX
006d244f : ADD ESP,0x8
006d2452 : MOV dword ptr [EBP + -0x8],EAX
006d2455 : CMP dword ptr [EBP + -0x8],0x0
006d2459 : JGE 0x006d246c
006d245b : PUSH 0xbeee30
006d2460 : MOV ECX,dword ptr [EBP + 0x8]
006d2463 : PUSH ECX
006d2464 : CALL 0x006c2560
006d2469 : ADD ESP,0x8
006d246c : CMP dword ptr [EBP + -0x8],0x0
006d2470 : JNZ 0x006d24c9
006d2472 : MOV EDX,dword ptr [EBP + 0x8]
006d2475 : MOVZX EAX,byte ptr [EDX + 0x11c]
006d247c : AND EAX,0x20
006d247f : JNZ 0x006d24ad
006d2481 : MOV ECX,dword ptr [EBP + 0x8]
006d2484 : ADD ECX,0x11c
006d248a : PUSH ECX
006d248b : MOV EDX,dword ptr [EBP + 0x8]
006d248e : PUSH EDX
006d248f : CALL 0x006cd240
006d2494 : ADD ESP,0x8
006d2497 : CMP EAX,0x3
006d249a : JZ 0x006d24ad
006d249c : PUSH 0xbeee44
006d24a1 : MOV EAX,dword ptr [EBP + 0x8]
006d24a4 : PUSH EAX
006d24a5 : CALL 0x006c2560
006d24aa : ADD ESP,0x8
006d24ad : PUSH 0x1
006d24af : MOV ECX,dword ptr [EBP + 0x8]
006d24b2 : ADD ECX,0x268
006d24b8 : PUSH ECX
006d24b9 : MOV EDX,dword ptr [EBP + 0xc]
006d24bc : PUSH EDX
006d24bd : MOV EAX,dword ptr [EBP + 0x8]
006d24c0 : PUSH EAX
006d24c1 : CALL 0x006ceb00
006d24c6 : ADD ESP,0x10
006d24c9 : MOV ECX,dword ptr [EBP + 0x8]
006d24cc : MOV EDX,dword ptr [ECX + 0x270]
006d24d2 : PUSH EDX
006d24d3 : MOV EAX,dword ptr [EBP + 0x8]
006d24d6 : PUSH EAX
006d24d7 : CALL 0x006ceee0
006d24dc : ADD ESP,0x8
006d24df : MOV ECX,dword ptr [EBP + 0x8]
006d24e2 : MOV dword ptr [ECX + 0x270],0x0
006d24ec : JMP 0x006d24f4
006d24ee : MOV EDX,dword ptr [EBP + 0x10]
006d24f1 : MOV dword ptr [EBP + -0x4],EDX
006d24f4 : MOV EAX,dword ptr [EBP + -0x4]
006d24f7 : PUSH EAX
006d24f8 : MOV ECX,dword ptr [EBP + 0x8]
006d24fb : PUSH ECX
006d24fc : CALL 0x006cf140
006d2501 : ADD ESP,0x8
006d2504 : MOV ESP,EBP
006d2506 : POP EBP
006d2507 : RET

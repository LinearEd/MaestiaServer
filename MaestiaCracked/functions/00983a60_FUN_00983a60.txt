PROGRAM  : Maestia.exe
FUNCTION : FUN_00983a60
ENTRY    : 00983a60
BODY     : [[00983a60, 00983ad6] [00983ae0, 00983da7]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Type propagation algorithm not settling */

void FUN_00983a60(void)

{
  int *piVar1;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  short *psVar5;
  short *psVar6;
  undefined4 *******pppppppuVar7;
  short sVar8;
  int *local_d4;
  int *local_d0;
  undefined1 local_cc [4];
  int *local_c8;
  undefined4 uStack_c4;
  undefined1 local_c0 [8];
  undefined2 uStack_b8;
  undefined4 uStack_a8;
  uint uStack_a4;
  undefined1 auStack_a0 [8];
  undefined1 auStack_98 [64];
  undefined1 local_58 [4];
  undefined4 *******apppppppuStack_54 [5];
  uint uStack_40;
  uint uStack_24;
  uint uStack_20;
  uint local_1c;
  void *pvStack_18;
  void *local_14;
  undefined1 *puStack_10;
  int local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b5ae74;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)&local_d4;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xffffff20;
  ExceptionList = &local_14;
  FUN_00423410(local_cc);
  local_c = 0;
  if (DAT_01724800 != 0) {
    local_d4 = (int *)-(uint)(*(int *)(DAT_01724800 + 0x28) != 0);
    while (local_d4 != (int *)0x0) {
      if (DAT_01724800 != 0) {
        local_d0 = (int *)0x0;
        FUN_00404160(&local_d4,local_c0,&local_d0);
        piVar1 = local_d0;
        if ((((local_d0 != (int *)0x0) &&
             (iVar3 = (**(code **)(*local_d0 + 0x38))(uVar2), iVar3 == 0)) &&
            ((piVar1[0x10] & 0x10U) == 0)) &&
           (((piVar1[0x10] & 0x10000U) == 0 && (*(char *)((int)piVar1 + 0x4a) != '\0')))) {
          FUN_004231a0();
          local_c._0_1_ = 1;
          uVar4 = FUN_00824a20(DAT_0172491c,0);
          local_c._0_1_ = 2;
          FUN_00405eb0(uVar4,0,0xffffffff);
          local_c._0_1_ = 1;
          if (7 < uStack_a4) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          uStack_24 = (uint)*(ushort *)((int)piVar1 + 6);
          uStack_20 = (uint)*(ushort *)((int)piVar1 + 0x1e6);
          uStack_b8 = 0;
          local_d0 = (int *)(uint)*(byte *)((int)piVar1 + 0x4a);
          uStack_a4 = 7;
          uStack_a8 = 0;
          uVar4 = FUN_004237d0(auStack_98,&local_d0);
          local_c._0_1_ = 3;
          FUN_004234b0(auStack_a0,uVar4);
          local_c._0_1_ = 1;
          FUN_00423210(auStack_98);
          local_c = (uint)local_c._1_3_ << 8;
          FUN_00486950();
        }
      }
    }
  }
  local_d4 = (int *)*local_c8;
  if (local_d4 != local_c8) {
    do {
      sVar8 = 0;
      FUN_00423260(local_58);
      local_c._0_1_ = 4;
      if (DAT_0172491c != 0) {
        psVar6 = *(short **)(DAT_0172491c + 0x3b4);
        for (psVar5 = psVar6; psVar5 != *(short **)(DAT_0172491c + 0x3b8); psVar5 = psVar5 + 3) {
          if (*psVar5 == (short)uStack_24) {
            sVar8 = psVar5[1];
            if (sVar8 == 0) goto LAB_00983c99;
            goto LAB_00983cc2;
          }
        }
        sVar8 = 0;
LAB_00983c99:
        if (uStack_20 != 0) {
          for (; psVar6 != *(short **)(DAT_0172491c + 0x3b8); psVar6 = psVar6 + 3) {
            if (*psVar6 == (short)uStack_20) {
              sVar8 = psVar6[1];
              goto LAB_00983cc2;
            }
          }
          sVar8 = 0;
        }
      }
LAB_00983cc2:
      iVar3 = *DAT_00da9894;
      if ((iVar3 != 0) && (*(int *)(iVar3 + 0x114) != 0)) {
        pppppppuVar7 = apppppppuStack_54[0];
        if (uStack_40 < 8) {
          pppppppuVar7 = apppppppuStack_54;
        }
        (**(code **)(**(int **)(iVar3 + 0x114) + 4))
                  (*(int **)(iVar3 + 0x114),"AddMapZoneList","%ls,%d,%d",pppppppuVar7,uStack_24,
                   sVar8);
      }
      local_c = (uint)local_c._1_3_ << 8;
      FUN_00486950();
      FUN_00424440();
    } while (local_d4 != local_c8);
  }
  FUN_00423910(local_c8[1]);
  local_c8[1] = (int)local_c8;
  uStack_c4 = 0;
  *local_c8 = (int)local_c8;
  local_c8[2] = (int)local_c8;
  local_c = 0xffffffff;
  FUN_004230d0(local_cc);
  ExceptionList = pvStack_18;
  __security_check_cookie(uStack_20 ^ (uint)&stack0xffffff28);
  return;
}



============================================================
DISASSEMBLY
============================================================
00983a60 : PUSH EBP
00983a61 : MOV EBP,ESP
00983a63 : AND ESP,0xfffffff8
00983a66 : PUSH -0x1
00983a68 : PUSH 0xb5ae74
00983a6d : MOV EAX,FS:[0x0]
00983a73 : PUSH EAX
00983a74 : SUB ESP,0xc0
00983a7a : MOV EAX,[0x00d66fa0]
00983a7f : XOR EAX,ESP
00983a81 : MOV dword ptr [ESP + 0xb8],EAX
00983a88 : PUSH EBX
00983a89 : PUSH ESI
00983a8a : PUSH EDI
00983a8b : MOV EAX,[0x00d66fa0]
00983a90 : XOR EAX,ESP
00983a92 : PUSH EAX
00983a93 : LEA EAX,[ESP + 0xd0]
00983a9a : MOV FS:[0x0],EAX
00983aa0 : LEA EAX,[ESP + 0x18]
00983aa4 : PUSH EAX
00983aa5 : CALL 0x00423410
00983aaa : MOV dword ptr [ESP + 0xd8],0x0
00983ab5 : MOV EAX,[0x01724800]
00983aba : TEST EAX,EAX
00983abc : JZ 0x00983c2e
00983ac2 : MOV ECX,dword ptr [EAX + 0x28]
00983ac5 : NEG ECX
00983ac7 : SBB ECX,ECX
00983ac9 : MOV dword ptr [ESP + 0x10],ECX
00983acd : JZ 0x00983c2e
00983ad3 : MOV BL,0x1
00983ad5 : JMP 0x00983ae5
00983ae0 : MOV EAX,[0x01724800]
00983ae5 : TEST EAX,EAX
00983ae7 : JZ 0x00983c23
00983aed : LEA ECX,[ESP + 0x14]
00983af1 : PUSH ECX
00983af2 : LEA EDX,[ESP + 0x28]
00983af6 : PUSH EDX
00983af7 : LEA ECX,[ESP + 0x18]
00983afb : PUSH ECX
00983afc : MOV dword ptr [ESP + 0x20],0x0
00983b04 : CALL 0x00404160
00983b09 : MOV EDI,dword ptr [ESP + 0x14]
00983b0d : TEST EDI,EDI
00983b0f : JZ 0x00983c23
00983b15 : MOV EDX,dword ptr [EDI]
00983b17 : MOV EAX,dword ptr [EDX + 0x38]
00983b1a : MOV ECX,EDI
00983b1c : CALL EAX
00983b1e : TEST EAX,EAX
00983b20 : JNZ 0x00983c23
00983b26 : MOV EAX,dword ptr [EDI + 0x40]
00983b29 : TEST AL,0x10
00983b2b : JNZ 0x00983c23
00983b31 : TEST EAX,0x10000
00983b36 : JNZ 0x00983c23
00983b3c : CMP byte ptr [EDI + 0x4a],0x0
00983b40 : JZ 0x00983c23
00983b46 : LEA ECX,[ESP + 0x8c]
00983b4d : CALL 0x004231a0
00983b52 : MOV byte ptr [ESP + 0xd8],BL
00983b59 : MOV ECX,dword ptr [0x0172491c]
00983b5f : PUSH 0x0
00983b61 : LEA EDX,[EDI + 0x18]
00983b64 : PUSH ECX
00983b65 : LEA ESI,[ESP + 0x30]
00983b69 : CALL 0x00824a20
00983b6e : MOV byte ptr [ESP + 0xd8],0x2
00983b76 : PUSH -0x1
00983b78 : PUSH 0x0
00983b7a : PUSH EAX
00983b7b : LEA ECX,[ESP + 0x98]
00983b82 : CALL 0x00405eb0
00983b87 : MOV byte ptr [ESP + 0xd8],BL
00983b8e : CMP dword ptr [ESP + 0x40],0x8
00983b93 : JC 0x00983b9e
00983b95 : MOV ECX,dword ptr [ESP + 0x2c]
00983b99 : CALL 0x006f04e0
00983b9e : MOVZX EAX,word ptr [EDI + 0x6]
00983ba2 : MOVZX ECX,word ptr [EDI + 0x1e6]
00983ba9 : XOR EDX,EDX
00983bab : MOV dword ptr [ESP + 0xc0],EAX
00983bb2 : MOV word ptr [ESP + 0x2c],DX
00983bb7 : MOVZX EDX,byte ptr [EDI + 0x4a]
00983bbb : LEA EAX,[ESP + 0x14]
00983bbf : MOV dword ptr [ESP + 0xc4],ECX
00983bc6 : PUSH EAX
00983bc7 : LEA ECX,[ESP + 0x50]
00983bcb : PUSH ECX
00983bcc : LEA EDI,[ESP + 0x94]
00983bd3 : MOV dword ptr [ESP + 0x48],0x7
00983bdb : MOV dword ptr [ESP + 0x44],0x0
00983be3 : MOV dword ptr [ESP + 0x1c],EDX
00983be7 : CALL 0x004237d0
00983bec : MOV byte ptr [ESP + 0xd8],0x3
00983bf4 : PUSH EAX
00983bf5 : LEA EDX,[ESP + 0x48]
00983bf9 : PUSH EDX
00983bfa : LEA EAX,[ESP + 0x20]
00983bfe : CALL 0x004234b0
00983c03 : MOV byte ptr [ESP + 0xd8],BL
00983c0a : LEA EAX,[ESP + 0x4c]
00983c0e : PUSH EAX
00983c0f : CALL 0x00423210
00983c14 : MOV byte ptr [ESP + 0xd8],0x0
00983c1c : MOV ECX,EDI
00983c1e : CALL 0x00486950
00983c23 : CMP dword ptr [ESP + 0x10],0x0
00983c28 : JNZ 0x00983ae0
00983c2e : MOV ECX,dword ptr [ESP + 0x1c]
00983c32 : MOV EAX,dword ptr [ECX]
00983c34 : MOV dword ptr [ESP + 0x10],EAX
00983c38 : CMP EAX,ECX
00983c3a : JZ 0x00983d3d
00983c40 : LEA ECX,[ESP + 0x8c]
00983c47 : LEA EDI,[EAX + 0x10]
00983c4a : PUSH ECX
00983c4b : XOR ESI,ESI
00983c4d : CALL 0x00423260
00983c52 : MOV byte ptr [ESP + 0xd8],0x4
00983c5a : MOV ECX,dword ptr [0x0172491c]
00983c60 : MOV EBX,dword ptr [ESP + 0xc0]
00983c67 : TEST ECX,ECX
00983c69 : JZ 0x00983cc2
00983c6b : MOV EDX,dword ptr [ECX + 0x3b4]
00983c71 : MOV ECX,dword ptr [ECX + 0x3b8]
00983c77 : MOV EAX,EDX
00983c79 : CMP EAX,ECX
00983c7b : JZ 0x00983c8c
00983c7d : LEA ECX,[ECX]
00983c80 : CMP word ptr [EAX],BX
00983c83 : JZ 0x00983c90
00983c85 : ADD EAX,0x6
00983c88 : CMP EAX,ECX
00983c8a : JNZ 0x00983c80
00983c8c : XOR ESI,ESI
00983c8e : JMP 0x00983c99
00983c90 : MOVZX ESI,word ptr [EAX + 0x2]
00983c94 : TEST SI,SI
00983c97 : JNZ 0x00983cc2
00983c99 : MOV EDI,dword ptr [ESP + 0xc4]
00983ca0 : TEST EDI,EDI
00983ca2 : JBE 0x00983cc2
00983ca4 : MOV EAX,EDX
00983ca6 : CMP EAX,ECX
00983ca8 : JZ 0x00983cc0
00983caa : LEA EBX,[EBX]
00983cb0 : CMP word ptr [EAX],DI
00983cb3 : JZ 0x00983d9f
00983cb9 : ADD EAX,0x6
00983cbc : CMP EAX,ECX
00983cbe : JNZ 0x00983cb0
00983cc0 : XOR ESI,ESI
00983cc2 : MOV EDX,dword ptr [0x00da9894]
00983cc8 : MOV EAX,dword ptr [EDX]
00983cca : TEST EAX,EAX
00983ccc : JZ 0x00983d10
00983cce : CMP dword ptr [EAX + 0x114],0x0
00983cd5 : JZ 0x00983d10
00983cd7 : CMP dword ptr [ESP + 0xa4],0x8
00983cdf : MOV EAX,dword ptr [EAX + 0x114]
00983ce5 : MOV ECX,dword ptr [ESP + 0x90]
00983cec : JNC 0x00983cf5
00983cee : LEA ECX,[ESP + 0x90]
00983cf5 : MOV EDX,dword ptr [EAX]
00983cf7 : MOVZX ESI,SI
00983cfa : PUSH ESI
00983cfb : PUSH EBX
00983cfc : PUSH ECX
00983cfd : PUSH 0xc803a0
00983d02 : PUSH 0xc803ac
00983d07 : PUSH EAX
00983d08 : MOV EAX,dword ptr [EDX + 0x4]
00983d0b : CALL EAX
00983d0d : ADD ESP,0x18
00983d10 : MOV byte ptr [ESP + 0xd8],0x0
00983d18 : LEA ECX,[ESP + 0x8c]
00983d1f : CALL 0x00486950
00983d24 : LEA EDX,[ESP + 0x10]
00983d28 : CALL 0x00424440
00983d2d : MOV EAX,dword ptr [ESP + 0x10]
00983d31 : MOV ECX,dword ptr [ESP + 0x1c]
00983d35 : CMP EAX,ECX
00983d37 : JNZ 0x00983c40
00983d3d : MOV ECX,dword ptr [ECX + 0x4]
00983d40 : PUSH ECX
00983d41 : LEA ECX,[ESP + 0x1c]
00983d45 : CALL 0x00423910
00983d4a : MOV EAX,dword ptr [ESP + 0x1c]
00983d4e : MOV dword ptr [EAX + 0x4],EAX
00983d51 : MOV EAX,dword ptr [ESP + 0x1c]
00983d55 : MOV dword ptr [ESP + 0x20],0x0
00983d5d : MOV dword ptr [EAX],EAX
00983d5f : MOV EAX,dword ptr [ESP + 0x1c]
00983d63 : MOV dword ptr [EAX + 0x8],EAX
00983d66 : MOV dword ptr [ESP + 0xd8],0xffffffff
00983d71 : LEA EDX,[ESP + 0x18]
00983d75 : PUSH EDX
00983d76 : CALL 0x004230d0
00983d7b : MOV ECX,dword ptr [ESP + 0xd0]
00983d82 : MOV dword ptr FS:[0x0],ECX
00983d89 : POP ECX
00983d8a : POP EDI
00983d8b : POP ESI
00983d8c : POP EBX
00983d8d : MOV ECX,dword ptr [ESP + 0xb8]
00983d94 : XOR ECX,ESP
00983d96 : CALL 0x00633e6b
00983d9b : MOV ESP,EBP
00983d9d : POP EBP
00983d9e : RET
00983d9f : MOVZX ESI,word ptr [EAX + 0x2]
00983da3 : JMP 0x00983cc2

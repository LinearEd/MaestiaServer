PROGRAM  : Maestia.exe
FUNCTION : FUN_00a22f80
ENTRY    : 00a22f80
BODY     : [[00a22f80, 00a2311f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a22f80(int param_1)

{
  byte *pbVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  undefined4 uVar6;
  uint local_50;
  int local_48;
  int local_44;
  byte local_40;
  undefined1 local_3c [28];
  undefined4 local_20;
  undefined4 local_1c;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  iVar2 = DAT_00d7c54c;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b2661e;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_44 = param_1;
  local_18 = uVar3;
  FUN_004437f0(&local_44);
  if ((((local_48 != *(int *)(iVar2 + 0x44)) && (iVar2 = *(int *)(local_48 + 0x10), iVar2 != 0)) &&
      (DAT_0172491c != 0)) &&
     ((*(int *)(DAT_0172491c + 0x90) != 0 &&
      (iVar5 = *(int *)(*(int *)(DAT_0172491c + 0x90) + 0xf0), local_44 = iVar5, iVar5 != 0)))) {
    FUN_007e06a0(uVar3);
    iVar4 = (**(code **)(*(int *)(iVar2 + 0x200) + 4))();
    while (iVar4 != 0) {
      iVar5 = FUN_004f5680();
      FUN_004068c0();
      local_8 = 0;
      local_40 = *(byte *)(iVar5 + 0x18);
      local_20 = *(undefined4 *)(iVar5 + 0x5c);
      local_1c = *(undefined4 *)(iVar5 + 0x60);
      uVar6 = FUN_0040eef0(iVar5 + 0x19);
      local_8._0_1_ = 1;
      FUN_00405eb0(uVar6,0,0xffffffff);
      local_8 = (uint)local_8._1_3_ << 8;
      if (7 < local_50) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      pbVar1 = (byte *)(local_44 + 0x274 + (uint)local_40 * 0x28);
      *pbVar1 = local_40;
      local_50 = 7;
      FUN_00405eb0(local_3c,0,0xffffffff);
      *(undefined4 *)(pbVar1 + 0x20) = local_20;
      *(undefined4 *)(pbVar1 + 0x24) = local_1c;
      local_8 = 0xffffffff;
      FUN_00406920();
      iVar5 = local_44;
    }
    *(short *)(iVar5 + 0x270) = (short)(*(int *)(iVar2 + 0x22c) - *(int *)(iVar2 + 0x228) >> 3);
  }
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a22f80 : PUSH EBP
00a22f81 : MOV EBP,ESP
00a22f83 : PUSH -0x1
00a22f85 : PUSH 0xb2661e
00a22f8a : MOV EAX,FS:[0x0]
00a22f90 : PUSH EAX
00a22f91 : SUB ESP,0x58
00a22f94 : MOV EAX,[0x00d66fa0]
00a22f99 : XOR EAX,EBP
00a22f9b : MOV dword ptr [EBP + -0x14],EAX
00a22f9e : PUSH EBX
00a22f9f : PUSH ESI
00a22fa0 : PUSH EDI
00a22fa1 : PUSH EAX
00a22fa2 : LEA EAX,[EBP + -0xc]
00a22fa5 : MOV FS:[0x0],EAX
00a22fab : MOV EAX,dword ptr [EBP + 0x8]
00a22fae : MOV ESI,dword ptr [0x00d7c54c]
00a22fb4 : LEA ECX,[EBP + -0x40]
00a22fb7 : MOV dword ptr [EBP + -0x40],EAX
00a22fba : PUSH ECX
00a22fbb : LEA ECX,[ESI + 0x40]
00a22fbe : LEA EAX,[EBP + -0x44]
00a22fc1 : CALL 0x004437f0
00a22fc6 : MOV ESI,dword ptr [ESI + 0x44]
00a22fc9 : MOV EAX,dword ptr [EBP + -0x44]
00a22fcc : CMP EAX,ESI
00a22fce : JZ 0x00a23102
00a22fd4 : MOV EDI,dword ptr [EAX + 0x10]
00a22fd7 : XOR EBX,EBX
00a22fd9 : MOV dword ptr [EBP + -0x48],EDI
00a22fdc : CMP EDI,EBX
00a22fde : JZ 0x00a23102
00a22fe4 : MOV EAX,[0x0172491c]
00a22fe9 : CMP EAX,EBX
00a22feb : JZ 0x00a23102
00a22ff1 : MOV EAX,dword ptr [EAX + 0x90]
00a22ff7 : CMP EAX,EBX
00a22ff9 : JZ 0x00a23102
00a22fff : MOV ESI,dword ptr [EAX + 0xf0]
00a23005 : MOV dword ptr [EBP + -0x40],ESI
00a23008 : CMP ESI,EBX
00a2300a : JZ 0x00a23102
00a23010 : MOV EAX,ESI
00a23012 : CALL 0x007e06a0
00a23017 : MOV EDX,dword ptr [EDI + 0x200]
00a2301d : MOV EAX,dword ptr [EDX + 0x4]
00a23020 : ADD EDI,0x200
00a23026 : MOV ECX,EDI
00a23028 : CALL EAX
00a2302a : MOV dword ptr [EBP + -0x44],EAX
00a2302d : CMP EAX,EBX
00a2302f : JZ 0x00a230e9
00a23035 : LEA EDX,[EBP + -0x44]
00a23038 : MOV EAX,EDI
00a2303a : CALL 0x004f5680
00a2303f : LEA ECX,[EBP + -0x3c]
00a23042 : MOV ESI,EAX
00a23044 : CALL 0x004068c0
00a23049 : MOV dword ptr [EBP + -0x4],EBX
00a2304c : MOV CL,byte ptr [ESI + 0x18]
00a2304f : MOV byte ptr [EBP + -0x3c],CL
00a23052 : MOV EDX,dword ptr [ESI + 0x5c]
00a23055 : MOV dword ptr [EBP + -0x1c],EDX
00a23058 : MOV EAX,dword ptr [ESI + 0x60]
00a2305b : ADD ESI,0x19
00a2305e : PUSH ESI
00a2305f : LEA ESI,[EBP + -0x64]
00a23062 : MOV dword ptr [EBP + -0x18],EAX
00a23065 : CALL 0x0040eef0
00a2306a : ADD ESP,0x4
00a2306d : MOV byte ptr [EBP + -0x4],0x1
00a23071 : PUSH -0x1
00a23073 : PUSH EBX
00a23074 : PUSH EAX
00a23075 : LEA ECX,[EBP + -0x38]
00a23078 : CALL 0x00405eb0
00a2307d : MOV byte ptr [EBP + -0x4],BL
00a23080 : CMP dword ptr [EBP + -0x4c],0x8
00a23084 : JC 0x00a2308e
00a23086 : MOV ECX,dword ptr [EBP + -0x60]
00a23089 : CALL 0x006f04e0
00a2308e : XOR ECX,ECX
00a23090 : MOV word ptr [EBP + -0x60],CX
00a23094 : MOV CL,byte ptr [EBP + -0x3c]
00a23097 : MOVZX EAX,CL
00a2309a : LEA EDX,[EAX + EAX*0x4]
00a2309d : MOV EAX,dword ptr [EBP + -0x40]
00a230a0 : LEA ESI,[EAX + EDX*0x8 + 0x274]
00a230a7 : PUSH -0x1
00a230a9 : MOV byte ptr [ESI],CL
00a230ab : PUSH EBX
00a230ac : LEA ECX,[EBP + -0x38]
00a230af : PUSH ECX
00a230b0 : LEA ECX,[ESI + 0x4]
00a230b3 : MOV dword ptr [EBP + -0x4c],0x7
00a230ba : MOV dword ptr [EBP + -0x50],EBX
00a230bd : CALL 0x00405eb0
00a230c2 : MOV EDX,dword ptr [EBP + -0x1c]
00a230c5 : MOV dword ptr [ESI + 0x20],EDX
00a230c8 : MOV EAX,dword ptr [EBP + -0x18]
00a230cb : MOV dword ptr [ESI + 0x24],EAX
00a230ce : MOV dword ptr [EBP + -0x4],0xffffffff
00a230d5 : LEA ECX,[EBP + -0x3c]
00a230d8 : CALL 0x00406920
00a230dd : CMP dword ptr [EBP + -0x44],EBX
00a230e0 : JNZ 0x00a23035
00a230e6 : MOV ESI,dword ptr [EBP + -0x40]
00a230e9 : MOV EAX,dword ptr [EBP + -0x48]
00a230ec : MOV ECX,dword ptr [EAX + 0x22c]
00a230f2 : SUB ECX,dword ptr [EAX + 0x228]
00a230f8 : SAR ECX,0x3
00a230fb : MOV word ptr [ESI + 0x270],CX
00a23102 : MOV ECX,dword ptr [EBP + -0xc]
00a23105 : MOV dword ptr FS:[0x0],ECX
00a2310c : POP ECX
00a2310d : POP EDI
00a2310e : POP ESI
00a2310f : POP EBX
00a23110 : MOV ECX,dword ptr [EBP + -0x14]
00a23113 : XOR ECX,EBP
00a23115 : CALL 0x00633e6b
00a2311a : MOV ESP,EBP
00a2311c : POP EBP
00a2311d : RET 0x4

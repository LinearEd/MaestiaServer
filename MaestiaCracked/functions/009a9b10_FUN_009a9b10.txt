PROGRAM  : Maestia.exe
FUNCTION : FUN_009a9b10
ENTRY    : 009a9b10
BODY     : [[009a9b10, 009a9d61]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009a9b10(int *param_1)

{
  int iVar1;
  int *piVar2;
  ushort uVar3;
  uint uVar4;
  int iVar5;
  undefined4 uVar6;
  int in_ECX;
  int iVar7;
  undefined1 local_3c [28];
  int local_20;
  int local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  piVar2 = param_1;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b413af;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (((char)param_1[2] != '\0') && (iVar1 = *(int *)(param_1[1] + 0x128), iVar1 != 0)) {
    iVar7 = in_ECX;
    if (in_ECX == -1) {
      iVar7 = 0;
      do {
        iVar5 = (**(code **)(*param_1 + 0x74))(iVar7,0,uVar4);
        if (iVar5 == 0) {
          if (iVar7 != -1) goto LAB_009a9b88;
          break;
        }
        iVar7 = iVar7 + 1;
      } while (iVar7 < 2);
      param_1 = (int *)0x0;
      iVar7 = (int)param_1;
    }
LAB_009a9b88:
    param_1 = (int *)iVar7;
    if (*(int *)(iVar1 + 0x40) == -1) {
      iVar7 = (**(code **)(*piVar2 + 0x74))(param_1,0);
      if ((iVar7 != 0) && (*(char *)(iVar1 + 0x59) == '\0')) {
        *(undefined2 *)(iVar1 + 0x44) = param_1._0_2_;
        *(undefined2 *)(iVar1 + 0x48) = 0xffff;
        *(undefined4 *)(iVar1 + 0x40) = 0x11;
        *(undefined2 *)(iVar1 + 0x46) = 0;
        FUN_0097fac0();
      }
    }
    else {
      iVar7 = FUN_008eb580();
      if (iVar7 != 0) {
        local_18 = (uint)*(ushort *)(iVar1 + 0x44);
        local_14 = (uint)*(ushort *)(iVar1 + 0x46);
        piVar2 = *(int **)(iVar1 + 0x4c);
        if (piVar2 == (int *)0x0) {
          local_1c = 0;
        }
        else {
          local_1c = piVar2[4];
        }
        FUN_004437f0(&local_1c);
        if (((local_20 != *(int *)(DAT_00d7c54c + 0x44)) && (*(int *)(local_20 + 0x10) != 0)) &&
           ((*(uint *)(*(int *)(local_20 + 0x10) + 0x48) & 0x80) != 0)) {
          FUN_00406460(L"IDS_CLTNET_ERR_CANTDEDICATIONITEM");
          local_8 = 0;
          uVar6 = FUN_0081d120(local_3c);
          local_8._0_1_ = 1;
          FUN_0096b1e0(uVar6,0xffff0000,0x12);
          local_8 = (uint)local_8._1_3_ << 8;
          FUN_00406560();
          local_8 = 0xffffffff;
          FUN_00406560();
          FUN_0097fa60();
          ExceptionList = local_10;
          return;
        }
        if (((piVar2 != (int *)0x0) && (uVar3 = (**(code **)(*piVar2 + 0x40))(), 1 < uVar3)) &&
           (iVar7 = (**(code **)(**(int **)(iVar1 + 0x4c) + 0x20))(), iVar7 != 0)) {
          if (*(int **)(iVar1 + 0x4c) != (int *)0x0) {
            (**(code **)(**(int **)(iVar1 + 0x4c) + 0x40))();
          }
          FUN_009a8c50(*(undefined4 *)(iVar1 + 0x40),local_18,local_14,param_1,0);
          ExceptionList = local_10;
          return;
        }
        FUN_008efa90(*(undefined4 *)(iVar1 + 0x40),local_18,local_14,0x11,param_1,0);
        ExceptionList = local_10;
        return;
      }
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
009a9b10 : PUSH EBP
009a9b11 : MOV EBP,ESP
009a9b13 : PUSH -0x1
009a9b15 : PUSH 0xb413af
009a9b1a : MOV EAX,FS:[0x0]
009a9b20 : PUSH EAX
009a9b21 : SUB ESP,0x48
009a9b24 : PUSH EBX
009a9b25 : PUSH ESI
009a9b26 : PUSH EDI
009a9b27 : MOV EAX,[0x00d66fa0]
009a9b2c : XOR EAX,EBP
009a9b2e : PUSH EAX
009a9b2f : LEA EAX,[EBP + -0xc]
009a9b32 : MOV FS:[0x0],EAX
009a9b38 : MOV EBX,dword ptr [EBP + 0x8]
009a9b3b : MOV AL,byte ptr [EBX + 0x8]
009a9b3e : TEST AL,AL
009a9b40 : JZ 0x009a9d4e
009a9b46 : MOV EAX,dword ptr [EBX + 0x4]
009a9b49 : MOV ESI,dword ptr [EAX + 0x128]
009a9b4f : TEST ESI,ESI
009a9b51 : JZ 0x009a9d4e
009a9b57 : MOV dword ptr [EBP + 0x8],ECX
009a9b5a : CMP ECX,-0x1
009a9b5d : JNZ 0x009a9b88
009a9b5f : XOR EDI,EDI
009a9b61 : MOV EDX,dword ptr [EBX]
009a9b63 : MOV EAX,dword ptr [EDX + 0x74]
009a9b66 : PUSH 0x0
009a9b68 : PUSH EDI
009a9b69 : MOV ECX,EBX
009a9b6b : CALL EAX
009a9b6d : TEST EAX,EAX
009a9b6f : JZ 0x009a9b79
009a9b71 : INC EDI
009a9b72 : CMP EDI,0x2
009a9b75 : JL 0x009a9b61
009a9b77 : JMP 0x009a9b81
009a9b79 : MOV dword ptr [EBP + 0x8],EDI
009a9b7c : CMP EDI,-0x1
009a9b7f : JNZ 0x009a9b88
009a9b81 : MOV dword ptr [EBP + 0x8],0x0
009a9b88 : MOV EDI,dword ptr [ESI + 0x40]
009a9b8b : CMP EDI,-0x1
009a9b8e : JZ 0x009a9d10
009a9b94 : MOV EAX,dword ptr [EBX + 0x4]
009a9b97 : CALL 0x008eb580
009a9b9c : TEST EAX,EAX
009a9b9e : JZ 0x009a9d4e
009a9ba4 : MOVZX ECX,word ptr [ESI + 0x44]
009a9ba8 : MOVZX EDX,word ptr [ESI + 0x46]
009a9bac : MOV EDI,dword ptr [ESI + 0x4c]
009a9baf : MOV dword ptr [EBP + -0x14],ECX
009a9bb2 : MOV dword ptr [EBP + -0x10],EDX
009a9bb5 : TEST EDI,EDI
009a9bb7 : JZ 0x009a9bbe
009a9bb9 : MOV EAX,dword ptr [EDI + 0x10]
009a9bbc : JMP 0x009a9bc0
009a9bbe : XOR EAX,EAX
009a9bc0 : MOV ECX,dword ptr [0x00d7c54c]
009a9bc6 : MOV dword ptr [EBP + -0x18],EAX
009a9bc9 : LEA EAX,[EBP + -0x18]
009a9bcc : PUSH EAX
009a9bcd : ADD ECX,0x40
009a9bd0 : LEA EAX,[EBP + -0x1c]
009a9bd3 : CALL 0x004437f0
009a9bd8 : MOV ECX,dword ptr [0x00d7c54c]
009a9bde : MOV EAX,dword ptr [ECX + 0x44]
009a9be1 : MOV ECX,dword ptr [EBP + -0x1c]
009a9be4 : CMP ECX,EAX
009a9be6 : JZ 0x009a9c7a
009a9bec : MOV EAX,dword ptr [ECX + 0x10]
009a9bef : TEST EAX,EAX
009a9bf1 : JZ 0x009a9c7a
009a9bf7 : MOV EAX,dword ptr [EAX + 0x48]
009a9bfa : AND EAX,0x80
009a9bff : XOR ECX,ECX
009a9c01 : OR EAX,ECX
009a9c03 : JZ 0x009a9c7a
009a9c05 : PUSH 0xc8a7b8
009a9c0a : LEA ECX,[EBP + -0x38]
009a9c0d : CALL 0x00406460
009a9c12 : MOV dword ptr [EBP + -0x4],0x0
009a9c19 : MOV ECX,dword ptr [0x0172491c]
009a9c1f : LEA EDX,[EBP + -0x38]
009a9c22 : PUSH EDX
009a9c23 : LEA EDI,[EBP + -0x54]
009a9c26 : CALL 0x0081d120
009a9c2b : MOV byte ptr [EBP + -0x4],0x1
009a9c2f : MOV ECX,dword ptr [EBX + 0x4]
009a9c32 : MOV ECX,dword ptr [ECX + 0x134]
009a9c38 : PUSH 0x12
009a9c3a : PUSH 0xffff0000
009a9c3f : PUSH EAX
009a9c40 : CALL 0x0096b1e0
009a9c45 : MOV byte ptr [EBP + -0x4],0x0
009a9c49 : MOV ECX,EDI
009a9c4b : CALL 0x00406560
009a9c50 : MOV dword ptr [EBP + -0x4],0xffffffff
009a9c57 : LEA ECX,[EBP + -0x38]
009a9c5a : CALL 0x00406560
009a9c5f : MOV ECX,ESI
009a9c61 : CALL 0x0097fa60
009a9c66 : MOV ECX,dword ptr [EBP + -0xc]
009a9c69 : MOV dword ptr FS:[0x0],ECX
009a9c70 : POP ECX
009a9c71 : POP EDI
009a9c72 : POP ESI
009a9c73 : POP EBX
009a9c74 : MOV ESP,EBP
009a9c76 : POP EBP
009a9c77 : RET 0x4
009a9c7a : TEST EDI,EDI
009a9c7c : JZ 0x009a9ce0
009a9c7e : MOV EDX,dword ptr [EDI]
009a9c80 : MOV EAX,dword ptr [EDX + 0x40]
009a9c83 : MOV ECX,EDI
009a9c85 : CALL EAX
009a9c87 : MOVZX EAX,AX
009a9c8a : CMP AX,0x1
009a9c8e : JBE 0x009a9ce0
009a9c90 : MOV ECX,dword ptr [ESI + 0x4c]
009a9c93 : MOV EDX,dword ptr [ECX]
009a9c95 : MOV EAX,dword ptr [EDX + 0x20]
009a9c98 : CALL EAX
009a9c9a : TEST EAX,EAX
009a9c9c : JZ 0x009a9ce0
009a9c9e : MOV ECX,dword ptr [ESI + 0x4c]
009a9ca1 : TEST ECX,ECX
009a9ca3 : JZ 0x009a9cb1
009a9ca5 : MOV EDX,dword ptr [ECX]
009a9ca7 : MOV EAX,dword ptr [EDX + 0x40]
009a9caa : CALL EAX
009a9cac : MOVZX EDX,AX
009a9caf : JMP 0x009a9cb3
009a9cb1 : XOR EDX,EDX
009a9cb3 : MOV ECX,dword ptr [EBP + 0x8]
009a9cb6 : MOV EAX,dword ptr [EBP + -0x10]
009a9cb9 : PUSH 0x0
009a9cbb : PUSH ECX
009a9cbc : MOV ECX,dword ptr [EBP + -0x14]
009a9cbf : PUSH EAX
009a9cc0 : MOV EAX,dword ptr [ESI + 0x40]
009a9cc3 : PUSH ECX
009a9cc4 : PUSH EAX
009a9cc5 : MOV ESI,EBX
009a9cc7 : CALL 0x009a8c50
009a9ccc : MOV ECX,dword ptr [EBP + -0xc]
009a9ccf : MOV dword ptr FS:[0x0],ECX
009a9cd6 : POP ECX
009a9cd7 : POP EDI
009a9cd8 : POP ESI
009a9cd9 : POP EBX
009a9cda : MOV ESP,EBP
009a9cdc : POP EBP
009a9cdd : RET 0x4
009a9ce0 : MOV ECX,dword ptr [EBP + 0x8]
009a9ce3 : MOV EDX,dword ptr [EBP + -0x10]
009a9ce6 : MOV EAX,dword ptr [EBP + -0x14]
009a9ce9 : PUSH 0x0
009a9ceb : PUSH ECX
009a9cec : MOV ECX,dword ptr [ESI + 0x40]
009a9cef : PUSH 0x11
009a9cf1 : PUSH EDX
009a9cf2 : PUSH EAX
009a9cf3 : PUSH ECX
009a9cf4 : CALL 0x008efa90
009a9cf9 : ADD ESP,0x18
009a9cfc : MOV ECX,dword ptr [EBP + -0xc]
009a9cff : MOV dword ptr FS:[0x0],ECX
009a9d06 : POP ECX
009a9d07 : POP EDI
009a9d08 : POP ESI
009a9d09 : POP EBX
009a9d0a : MOV ESP,EBP
009a9d0c : POP EBP
009a9d0d : RET 0x4
009a9d10 : MOV EDX,dword ptr [EBX]
009a9d12 : MOV EAX,dword ptr [EBP + 0x8]
009a9d15 : MOV EDX,dword ptr [EDX + 0x74]
009a9d18 : PUSH 0x0
009a9d1a : PUSH EAX
009a9d1b : MOV ECX,EBX
009a9d1d : CALL EDX
009a9d1f : TEST EAX,EAX
009a9d21 : JZ 0x009a9d4e
009a9d23 : CMP byte ptr [ESI + 0x59],0x0
009a9d27 : JNZ 0x009a9d4e
009a9d29 : MOV CX,word ptr [EBP + 0x8]
009a9d2d : MOV word ptr [ESI + 0x44],CX
009a9d31 : MOV ECX,0xffff
009a9d36 : XOR EDX,EDX
009a9d38 : MOV word ptr [ESI + 0x48],CX
009a9d3c : MOV ECX,ESI
009a9d3e : MOV dword ptr [ESI + 0x40],0x11
009a9d45 : MOV word ptr [ESI + 0x46],DX
009a9d49 : CALL 0x0097fac0
009a9d4e : MOV ECX,dword ptr [EBP + -0xc]
009a9d51 : MOV dword ptr FS:[0x0],ECX
009a9d58 : POP ECX
009a9d59 : POP EDI
009a9d5a : POP ESI
009a9d5b : POP EBX
009a9d5c : MOV ESP,EBP
009a9d5e : POP EBP
009a9d5f : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : xtow_s
ENTRY    : 00636f74
BODY     : [[00636f74, 00637069]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    _xtow_s@20
   
   Library: Visual Studio 2008 Release
   __stdcall xtow_s,20 */

int xtow_s(uint param_1,uint param_2,uint param_3,int param_4)

{
  short *psVar1;
  short *in_EAX;
  int *piVar2;
  short *psVar3;
  short *psVar4;
  short sVar5;
  int iVar6;
  uint local_8;
  
  if (in_EAX == (short *)0x0) {
    piVar2 = __errno();
    *piVar2 = 0x16;
    __invalid_parameter(0,0,0,0,0);
    return 0x16;
  }
  if (param_2 == 0) {
LAB_00636fa8:
    piVar2 = __errno();
    iVar6 = 0x16;
  }
  else {
    *in_EAX = 0;
    if ((param_4 != 0) + 1 < param_2) {
      if (0x22 < param_3 - 2) goto LAB_00636fa8;
      psVar3 = in_EAX;
      if (param_4 != 0) {
        param_1 = -param_1;
        *in_EAX = 0x2d;
        psVar3 = in_EAX + 1;
      }
      local_8 = (uint)(param_4 != 0);
      psVar1 = psVar3;
      do {
        psVar4 = psVar1;
        sVar5 = (short)(param_1 % param_3);
        if (param_1 % param_3 < 10) {
          sVar5 = sVar5 + 0x30;
        }
        else {
          sVar5 = sVar5 + 0x57;
        }
        *psVar4 = sVar5;
        local_8 = local_8 + 1;
      } while ((param_1 / param_3 != 0) &&
              (psVar1 = psVar4 + 1, param_1 = param_1 / param_3, local_8 < param_2));
      if (local_8 < param_2) {
        psVar4[1] = 0;
        do {
          sVar5 = *psVar4;
          *psVar4 = *psVar3;
          *psVar3 = sVar5;
          psVar4 = psVar4 + -1;
          psVar3 = psVar3 + 1;
        } while (psVar3 < psVar4);
        return 0;
      }
      *in_EAX = 0;
    }
    piVar2 = __errno();
    iVar6 = 0x22;
  }
  *piVar2 = iVar6;
  __invalid_parameter(0,0,0,0,0);
  return iVar6;
}



============================================================
DISASSEMBLY
============================================================
00636f74 : MOV EDI,EDI
00636f76 : PUSH EBP
00636f77 : MOV EBP,ESP
00636f79 : PUSH ECX
00636f7a : PUSH EBX
00636f7b : PUSH ESI
00636f7c : MOV ESI,EAX
00636f7e : XOR EBX,EBX
00636f80 : CMP ESI,EBX
00636f82 : JNZ 0x00636fa2
00636f84 : CALL 0x0063ab82
00636f89 : PUSH 0x16
00636f8b : POP ESI
00636f8c : PUSH EBX
00636f8d : PUSH EBX
00636f8e : PUSH EBX
00636f8f : PUSH EBX
00636f90 : PUSH EBX
00636f91 : MOV dword ptr [EAX],ESI
00636f93 : CALL 0x006372b8
00636f98 : ADD ESP,0x14
00636f9b : MOV EAX,ESI
00636f9d : JMP 0x00637064
00636fa2 : PUSH EDI
00636fa3 : CMP dword ptr [EBP + 0xc],EBX
00636fa6 : JA 0x00636fc6
00636fa8 : CALL 0x0063ab82
00636fad : PUSH 0x16
00636faf : POP ESI
00636fb0 : PUSH EBX
00636fb1 : PUSH EBX
00636fb2 : PUSH EBX
00636fb3 : PUSH EBX
00636fb4 : PUSH EBX
00636fb5 : MOV dword ptr [EAX],ESI
00636fb7 : CALL 0x006372b8
00636fbc : ADD ESP,0x14
00636fbf : MOV EAX,ESI
00636fc1 : JMP 0x00637063
00636fc6 : XOR EAX,EAX
00636fc8 : CMP dword ptr [EBP + 0x14],EBX
00636fcb : MOV word ptr [ESI],AX
00636fce : SETNZ AL
00636fd1 : INC EAX
00636fd2 : CMP dword ptr [EBP + 0xc],EAX
00636fd5 : JA 0x00636fe0
00636fd7 : CALL 0x0063ab82
00636fdc : PUSH 0x22
00636fde : JMP 0x00636faf
00636fe0 : MOV EAX,dword ptr [EBP + 0x10]
00636fe3 : ADD EAX,-0x2
00636fe6 : CMP EAX,0x22
00636fe9 : JA 0x00636fa8
00636feb : MOV dword ptr [EBP + -0x4],EBX
00636fee : MOV ECX,ESI
00636ff0 : CMP dword ptr [EBP + 0x14],EBX
00636ff3 : JZ 0x00637008
00636ff5 : NEG dword ptr [EBP + 0x8]
00636ff8 : PUSH 0x2d
00636ffa : POP EAX
00636ffb : MOV word ptr [ESI],AX
00636ffe : LEA ECX,[ESI + 0x2]
00637001 : MOV dword ptr [EBP + -0x4],0x1
00637008 : MOV EDI,ECX
0063700a : MOV EAX,dword ptr [EBP + 0x8]
0063700d : XOR EDX,EDX
0063700f : DIV dword ptr [EBP + 0x10]
00637012 : MOV dword ptr [EBP + 0x8],EAX
00637015 : CMP EDX,0x9
00637018 : JBE 0x0063701f
0063701a : ADD EDX,0x57
0063701d : JMP 0x00637022
0063701f : ADD EDX,0x30
00637022 : MOV EAX,dword ptr [EBP + -0x4]
00637025 : MOV word ptr [ECX],DX
00637028 : INC ECX
00637029 : INC ECX
0063702a : INC EAX
0063702b : XOR EBX,EBX
0063702d : MOV dword ptr [EBP + -0x4],EAX
00637030 : CMP dword ptr [EBP + 0x8],EBX
00637033 : JBE 0x0063703a
00637035 : CMP EAX,dword ptr [EBP + 0xc]
00637038 : JC 0x0063700a
0063703a : CMP EAX,dword ptr [EBP + 0xc]
0063703d : JC 0x00637046
0063703f : XOR EAX,EAX
00637041 : MOV word ptr [ESI],AX
00637044 : JMP 0x00636fd7
00637046 : XOR EAX,EAX
00637048 : MOV word ptr [ECX],AX
0063704b : DEC ECX
0063704c : DEC ECX
0063704d : MOV DX,word ptr [EDI]
00637050 : MOVZX EAX,word ptr [ECX]
00637053 : MOV word ptr [ECX],DX
00637056 : DEC ECX
00637057 : MOV word ptr [EDI],AX
0063705a : DEC ECX
0063705b : INC EDI
0063705c : INC EDI
0063705d : CMP EDI,ECX
0063705f : JC 0x0063704d
00637061 : XOR EAX,EAX
00637063 : POP EDI
00637064 : POP ESI
00637065 : POP EBX
00637066 : LEAVE
00637067 : RET 0x10

PROGRAM  : Maestia.exe
FUNCTION : FUN_0070ae80
ENTRY    : 0070ae80
BODY     : [[0070ae80, 0070af56]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 *
FUN_0070ae80(undefined4 *param_1,undefined4 param_2,undefined4 param_3,undefined1 param_4,
            undefined1 param_5)

{
  uint uVar1;
  BOOL BVar2;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b15a29;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = &PTR_FUN_00cda51c;
  param_1[1] = &PTR_FUN_00cdec94;
  BVar2 = InitializeCriticalSectionAndSpinCount((LPCRITICAL_SECTION)(param_1 + 2),4000);
  if (BVar2 == 0) {
    InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 2));
  }
  local_8 = 0;
  param_1[8] = 0;
  param_1[0xf] = 7;
  param_1[0xe] = 0;
  *(undefined2 *)(param_1 + 10) = 0;
  FUN_00405eb0(param_2,0,0xffffffff);
  local_8._0_1_ = 1;
  param_1[0x16] = 7;
  param_1[0x15] = 0;
  *(undefined2 *)(param_1 + 0x11) = 0;
  FUN_00405eb0(param_3,0,0xffffffff);
  local_8 = CONCAT31(local_8._1_3_,2);
  *(undefined1 *)(param_1 + 0x17) = param_4;
  *(undefined1 *)((int)param_1 + 0x5d) = param_5;
  *(undefined1 *)(param_1 + 0x18) = 0;
  param_1[0x19] = 0;
  param_1[0x1a] = 0;
  FUN_0070ad60(uVar1);
  DAT_00d8acfc = param_1;
  ExceptionList = local_10;
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
0070ae80 : PUSH EBP
0070ae81 : MOV EBP,ESP
0070ae83 : PUSH -0x1
0070ae85 : PUSH 0xb15a29
0070ae8a : MOV EAX,FS:[0x0]
0070ae90 : PUSH EAX
0070ae91 : PUSH EBX
0070ae92 : PUSH ESI
0070ae93 : PUSH EDI
0070ae94 : MOV EAX,[0x00d66fa0]
0070ae99 : XOR EAX,EBP
0070ae9b : PUSH EAX
0070ae9c : LEA EAX,[EBP + -0xc]
0070ae9f : MOV FS:[0x0],EAX
0070aea5 : MOV ESI,dword ptr [EBP + 0x8]
0070aea8 : PUSH 0xfa0
0070aead : LEA EDI,[ESI + 0x8]
0070aeb0 : MOV dword ptr [ESI],0xcda51c
0070aeb6 : PUSH EDI
0070aeb7 : MOV dword ptr [ESI + 0x4],0xcdec94
0070aebe : CALL dword ptr [0x00b85110]
0070aec4 : TEST EAX,EAX
0070aec6 : JNZ 0x0070aecf
0070aec8 : PUSH EDI
0070aec9 : CALL dword ptr [0x00b85114]
0070aecf : XOR EBX,EBX
0070aed1 : MOV dword ptr [EBP + -0x4],EBX
0070aed4 : MOV EDX,dword ptr [EBP + 0xc]
0070aed7 : PUSH -0x1
0070aed9 : LEA ECX,[ESI + 0x24]
0070aedc : MOV dword ptr [ESI + 0x20],EBX
0070aedf : PUSH EBX
0070aee0 : MOV EDI,0x7
0070aee5 : XOR EAX,EAX
0070aee7 : MOV dword ptr [ECX + 0x18],EDI
0070aeea : MOV dword ptr [ECX + 0x14],EBX
0070aeed : PUSH EDX
0070aeee : MOV word ptr [ECX + 0x4],AX
0070aef2 : CALL 0x00405eb0
0070aef7 : MOV byte ptr [EBP + -0x4],0x1
0070aefb : MOV EDX,dword ptr [EBP + 0x10]
0070aefe : PUSH -0x1
0070af00 : LEA ECX,[ESI + 0x40]
0070af03 : PUSH EBX
0070af04 : XOR EAX,EAX
0070af06 : MOV dword ptr [ECX + 0x18],EDI
0070af09 : MOV dword ptr [ECX + 0x14],EBX
0070af0c : PUSH EDX
0070af0d : MOV word ptr [ECX + 0x4],AX
0070af11 : CALL 0x00405eb0
0070af16 : MOV byte ptr [EBP + -0x4],0x2
0070af1a : MOV AL,byte ptr [EBP + 0x14]
0070af1d : MOV CL,byte ptr [EBP + 0x18]
0070af20 : MOV byte ptr [ESI + 0x5c],AL
0070af23 : MOV byte ptr [ESI + 0x5d],CL
0070af26 : MOV byte ptr [ESI + 0x60],BL
0070af29 : MOV dword ptr [ESI + 0x64],EBX
0070af2c : MOV dword ptr [ESI + 0x68],EBX
0070af2f : CALL 0x0070ad60
0070af34 : MOV dword ptr [0x00d8acfc],ESI
0070af3a : MOV dword ptr [EBP + -0x4],0xffffffff
0070af41 : MOV EAX,ESI
0070af43 : MOV ECX,dword ptr [EBP + -0xc]
0070af46 : MOV dword ptr FS:[0x0],ECX
0070af4d : POP ECX
0070af4e : POP EDI
0070af4f : POP ESI
0070af50 : POP EBX
0070af51 : MOV ESP,EBP
0070af53 : POP EBP
0070af54 : RET 0x14

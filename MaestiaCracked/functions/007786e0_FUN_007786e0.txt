PROGRAM  : Maestia.exe
FUNCTION : FUN_007786e0
ENTRY    : 007786e0
BODY     : [[007786e0, 007788f7]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_007786e0(undefined4 *param_1)

{
  uint uVar1;
  BOOL BVar2;
  int iVar3;
  undefined4 uVar4;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3100c;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = &PTR_FUN_00cd7de8;
  FUN_004869c0(param_1 + 4);
  local_8 = 0;
  param_1[0x3a] = 0;
  param_1[0x43] = &PTR_FUN_00cdec94;
  BVar2 = InitializeCriticalSectionAndSpinCount((LPCRITICAL_SECTION)(param_1 + 0x44),4000);
  if (BVar2 == 0) {
    InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x44));
  }
  iVar3 = DAT_017251ac;
  local_8._0_1_ = 1;
  *(undefined1 *)(param_1 + 3) = 0;
  *(undefined1 *)((int)param_1 + 0xd) = 0;
  param_1[0x3b] = 0;
  param_1[0x3c] = 0;
  param_1[0x3d] = 0;
  param_1[0x3e] = 0;
  param_1[0x3f] = 0;
  *(undefined1 *)(param_1 + 0x40) = 0;
  param_1[0x41] = 0;
  *(undefined2 *)(param_1 + 0x42) = 0x100;
  *(undefined2 *)((int)param_1 + 0x10a) = 0x100;
  if ((*(ushort *)(*(int *)(iVar3 + 0x17c) + 0x52) < 4) || (*(char *)(iVar3 + 0x154) == '\0')) {
    iVar3 = FUN_006f0760(0x168,"",0,(DAT_01725270 >> 3 & 1) == 0,uVar1);
    local_8._0_1_ = 4;
    if (iVar3 == 0) {
      uVar4 = 0;
    }
    else {
      uVar4 = FUN_00a62a10(iVar3,param_1);
    }
    local_8._0_1_ = 1;
    uVar1 = DAT_01725270 >> 3;
    param_1[0x3c] = uVar4;
    iVar3 = FUN_006f0760(0x20,"",0,(uVar1 & 1) == 0);
    local_8 = CONCAT31(local_8._1_3_,5);
    if (iVar3 != 0) {
      uVar4 = FUN_00a606f0(iVar3,param_1);
      goto LAB_007788c5;
    }
  }
  else {
    iVar3 = FUN_006f0760(0x168,"",0,(DAT_01725270 >> 3 & 1) == 0,uVar1);
    local_8._0_1_ = 2;
    if (iVar3 == 0) {
      uVar4 = 0;
    }
    else {
      uVar4 = FUN_00a62b30(iVar3,param_1);
    }
    local_8._0_1_ = 1;
    param_1[0x3c] = uVar4;
    iVar3 = FUN_006f0760(0x20,"",0,(DAT_01725270 >> 3 & 1) == 0);
    local_8 = CONCAT31(local_8._1_3_,3);
    if (iVar3 != 0) {
      uVar4 = FUN_00a60d40(iVar3,param_1);
      goto LAB_007788c5;
    }
  }
  uVar4 = 0;
LAB_007788c5:
  param_1[0x3d] = uVar4;
  *(undefined1 *)(param_1[0x3c] + 0xc) = *(undefined1 *)(param_1 + 3);
  ExceptionList = local_10;
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
007786e0 : PUSH EBP
007786e1 : MOV EBP,ESP
007786e3 : PUSH -0x1
007786e5 : PUSH 0xb3100c
007786ea : MOV EAX,FS:[0x0]
007786f0 : PUSH EAX
007786f1 : SUB ESP,0x8
007786f4 : PUSH EBX
007786f5 : PUSH ESI
007786f6 : PUSH EDI
007786f7 : MOV EAX,[0x00d66fa0]
007786fc : XOR EAX,EBP
007786fe : PUSH EAX
007786ff : LEA EAX,[EBP + -0xc]
00778702 : MOV FS:[0x0],EAX
00778708 : MOV ESI,dword ptr [EBP + 0x8]
0077870b : LEA EAX,[ESI + 0x10]
0077870e : PUSH EAX
0077870f : MOV dword ptr [ESI],0xcd7de8
00778715 : CALL 0x004869c0
0077871a : XOR EBX,EBX
0077871c : MOV dword ptr [EBP + -0x4],EBX
0077871f : PUSH 0xfa0
00778724 : LEA EDI,[ESI + 0x110]
0077872a : MOV dword ptr [ESI + 0xe8],EBX
00778730 : PUSH EDI
00778731 : MOV dword ptr [ESI + 0x10c],0xcdec94
0077873b : CALL dword ptr [0x00b85110]
00778741 : TEST EAX,EAX
00778743 : JNZ 0x0077874c
00778745 : PUSH EDI
00778746 : CALL dword ptr [0x00b85114]
0077874c : MOV byte ptr [EBP + -0x4],0x1
00778750 : MOV EAX,[0x017251ac]
00778755 : MOV ECX,0x100
0077875a : MOV EDX,ECX
0077875c : MOV byte ptr [ESI + 0xc],BL
0077875f : MOV byte ptr [ESI + 0xd],BL
00778762 : MOV dword ptr [ESI + 0xec],EBX
00778768 : MOV dword ptr [ESI + 0xf0],EBX
0077876e : MOV dword ptr [ESI + 0xf4],EBX
00778774 : MOV dword ptr [ESI + 0xf8],EBX
0077877a : MOV dword ptr [ESI + 0xfc],EBX
00778780 : MOV byte ptr [ESI + 0x100],BL
00778786 : MOV dword ptr [ESI + 0x104],EBX
0077878c : MOV word ptr [ESI + 0x108],CX
00778793 : MOV word ptr [ESI + 0x10a],DX
0077879a : MOV CL,byte ptr [EAX + 0x154]
007787a0 : MOV EAX,dword ptr [EAX + 0x17c]
007787a6 : MOVZX EAX,word ptr [EAX + 0x52]
007787aa : CMP EAX,0x4
007787ad : JC 0x00778842
007787b3 : CMP CL,BL
007787b5 : JZ 0x00778842
007787bb : MOV ECX,dword ptr [0x01725270]
007787c1 : SHR ECX,0x3
007787c4 : MOV EDX,0x0
007787c9 : AND ECX,0x1
007787cc : SETZ DL
007787cf : PUSH EDX
007787d0 : PUSH EBX
007787d1 : PUSH 0xbf1a4a
007787d6 : PUSH 0x168
007787db : CALL 0x006f0760
007787e0 : ADD ESP,0x10
007787e3 : MOV dword ptr [EBP + -0x10],EAX
007787e6 : MOV byte ptr [EBP + -0x4],0x2
007787ea : CMP EAX,EBX
007787ec : JZ 0x007787f7
007787ee : PUSH ESI
007787ef : PUSH EAX
007787f0 : CALL 0x00a62b30
007787f5 : JMP 0x007787f9
007787f7 : XOR EAX,EAX
007787f9 : MOV byte ptr [EBP + -0x4],0x1
007787fd : MOV dword ptr [ESI + 0xf0],EAX
00778803 : MOV EAX,[0x01725270]
00778808 : SHR EAX,0x3
0077880b : MOV ECX,0x0
00778810 : AND EAX,0x1
00778813 : SETZ CL
00778816 : PUSH ECX
00778817 : PUSH EBX
00778818 : PUSH 0xbf1a4a
0077881d : PUSH 0x20
0077881f : CALL 0x006f0760
00778824 : ADD ESP,0x10
00778827 : MOV dword ptr [EBP + -0x10],EAX
0077882a : MOV byte ptr [EBP + -0x4],0x3
0077882e : CMP EAX,EBX
00778830 : JZ 0x007788c3
00778836 : PUSH ESI
00778837 : PUSH EAX
00778838 : CALL 0x00a60d40
0077883d : JMP 0x007788c5
00778842 : MOV EDX,dword ptr [0x01725270]
00778848 : SHR EDX,0x3
0077884b : MOV EAX,0x0
00778850 : AND EDX,0x1
00778853 : SETZ AL
00778856 : PUSH EAX
00778857 : PUSH EBX
00778858 : PUSH 0xbf1a4a
0077885d : PUSH 0x168
00778862 : CALL 0x006f0760
00778867 : ADD ESP,0x10
0077886a : MOV dword ptr [EBP + -0x10],EAX
0077886d : MOV byte ptr [EBP + -0x4],0x4
00778871 : CMP EAX,EBX
00778873 : JZ 0x0077887e
00778875 : PUSH ESI
00778876 : PUSH EAX
00778877 : CALL 0x00a62a10
0077887c : JMP 0x00778880
0077887e : XOR EAX,EAX
00778880 : MOV byte ptr [EBP + -0x4],0x1
00778884 : MOV ECX,dword ptr [0x01725270]
0077888a : SHR ECX,0x3
0077888d : MOV EDX,0x0
00778892 : AND ECX,0x1
00778895 : SETZ DL
00778898 : MOV dword ptr [ESI + 0xf0],EAX
0077889e : PUSH EDX
0077889f : PUSH EBX
007788a0 : PUSH 0xbf1a4a
007788a5 : PUSH 0x20
007788a7 : CALL 0x006f0760
007788ac : ADD ESP,0x10
007788af : MOV dword ptr [EBP + -0x10],EAX
007788b2 : MOV byte ptr [EBP + -0x4],0x5
007788b6 : CMP EAX,EBX
007788b8 : JZ 0x007788c3
007788ba : PUSH ESI
007788bb : PUSH EAX
007788bc : CALL 0x00a606f0
007788c1 : JMP 0x007788c5
007788c3 : XOR EAX,EAX
007788c5 : MOV byte ptr [EBP + -0x4],0x1
007788c9 : MOV ECX,dword ptr [ESI + 0xf0]
007788cf : MOV dword ptr [ESI + 0xf4],EAX
007788d5 : MOV AL,byte ptr [ESI + 0xc]
007788d8 : MOV byte ptr [ECX + 0xc],AL
007788db : MOV dword ptr [EBP + -0x4],0xffffffff
007788e2 : MOV EAX,ESI
007788e4 : MOV ECX,dword ptr [EBP + -0xc]
007788e7 : MOV dword ptr FS:[0x0],ECX
007788ee : POP ECX
007788ef : POP EDI
007788f0 : POP ESI
007788f1 : POP EBX
007788f2 : MOV ESP,EBP
007788f4 : POP EBP
007788f5 : RET 0x4

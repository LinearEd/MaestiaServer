PROGRAM  : Maestia.exe
FUNCTION : FUN_006edbe0
ENTRY    : 006edbe0
BODY     : [[006edbe0, 006edf91]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */
/* WARNING: Removing unreachable block (ram,0x006edd22) */
/* WARNING: Removing unreachable block (ram,0x006edcfa) */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_006edbe0(void)

{
  short *psVar1;
  HANDLE hObject;
  short local_1034;
  char local_e34;
  short local_d34;
  char local_b34;
  short local_a34;
  char local_834;
  undefined1 local_2dc [4];
  undefined1 local_2d8;
  undefined4 local_2c8;
  uint local_2c4;
  CHAR local_2c0 [256];
  char local_1c0 [424];
  uint local_18;
  undefined4 uStack_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b172a5;
  local_10 = ExceptionList;
  uStack_14 = 0x6edbfb;
  local_18 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  FUN_004f88b0();
  FUN_004f88b0();
  local_2c4 = 0xf;
  local_2c8 = 0;
  local_2d8 = 0;
  FUN_00404b50();
  local_8 = 0;
  FUN_00404b50();
  local_8._0_1_ = 1;
  FUN_00404b50();
  local_8._0_1_ = 2;
  FUN_004f85c0();
  local_8 = (uint)local_8._1_3_ << 8;
  GetModuleFileNameA((HMODULE)0x0,local_2c0,0x100);
  FUN_004f88d0();
  FUN_004118a0();
  if ((local_834 == '\0') && (local_a34 != 0)) {
    FUN_004d6be0();
  }
  FUN_004118a0();
  if ((local_b34 == '\0') && (local_d34 != 0)) {
    FUN_004d6be0();
  }
  FUN_00405110(local_2dc,0,0xffffffff);
  local_8 = local_8 & 0xffffff00;
  psVar1 = (short *)FUN_004f8610();
  if (((char)psVar1[0x100] == '\0') && (*psVar1 != 0)) {
    FUN_004d6be0();
  }
  FUN_004118a0();
  if ((local_e34 == '\0') && (local_1034 != 0)) {
    FUN_004d6be0();
  }
  __snprintf(local_1c0,0x103,"%s_[%s]_%s_(%s@%s).dmp");
  _DAT_01725278 = _DAT_01725278 + 1;
  if (DAT_01725274 == '\0') {
    DAT_01725274 = '\x01';
  }
  hObject = CreateFileA(local_1c0,0x40000000,1,(LPSECURITY_ATTRIBUTES)0x0,2,0,(HANDLE)0x0);
  if (hObject == (HANDLE)0xffffffff) {
    GetLastError();
    FUN_006ed630();
  }
  else {
    GetCurrentThreadId();
    GetCurrentProcessId();
    GetCurrentProcess();
    MiniDumpWriteDump();
    CloseHandle(hObject);
    FUN_006ed630();
  }
  local_8 = 0xffffffff;
  if (0xf < local_2c4) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_2c4 = 0xf;
  local_2c8 = 0;
  local_2d8 = 0;
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
006edbe0 : PUSH EBP
006edbe1 : MOV EBP,ESP
006edbe3 : PUSH -0x1
006edbe5 : PUSH 0xb172a5
006edbea : MOV EAX,FS:[0x0]
006edbf0 : PUSH EAX
006edbf1 : MOV EAX,0x1328
006edbf6 : CALL 0x0063b780
006edbfb : MOV EAX,[0x00d66fa0]
006edc00 : XOR EAX,EBP
006edc02 : MOV dword ptr [EBP + -0x14],EAX
006edc05 : PUSH EBX
006edc06 : PUSH ESI
006edc07 : PUSH EDI
006edc08 : PUSH EAX
006edc09 : LEA EAX,[EBP + -0xc]
006edc0c : MOV FS:[0x0],EAX
006edc12 : MOV ESI,ECX
006edc14 : MOV EAX,dword ptr [ESI]
006edc16 : MOV ECX,dword ptr [EAX + 0xc]
006edc19 : MOV EDX,dword ptr [ESI + 0x4]
006edc1c : MOV EAX,dword ptr [EDX + 0xbc]
006edc22 : PUSH ECX
006edc23 : PUSH EAX
006edc24 : PUSH 0xbf2a40
006edc29 : LEA EDX,[EBP + 0xffffff4c]
006edc2f : MOV dword ptr [EBP + 0xfffff914],ESI
006edc35 : CALL 0x004f88b0
006edc3a : MOV ECX,dword ptr [ESI]
006edc3c : MOV EDX,dword ptr [ECX]
006edc3e : PUSH EDX
006edc3f : PUSH 0xbf2a4c
006edc44 : LEA EDX,[EBP + -0x64]
006edc47 : CALL 0x004f88b0
006edc4c : ADD ESP,0x14
006edc4f : PUSH 0x18
006edc51 : XOR EBX,EBX
006edc53 : MOV ESI,0xf
006edc58 : PUSH 0xbf2a54
006edc5d : LEA ECX,[EBP + 0xfffffd28]
006edc63 : MOV dword ptr [EBP + 0xfffffd40],ESI
006edc69 : MOV dword ptr [EBP + 0xfffffd3c],EBX
006edc6f : MOV byte ptr [EBP + 0xfffffd2c],BL
006edc75 : CALL 0x00404b50
006edc7a : MOV dword ptr [EBP + -0x4],EBX
006edc7d : PUSH 0x1
006edc7f : PUSH 0xbf2a70
006edc84 : LEA ECX,[EBP + 0xfffff8dc]
006edc8a : MOV dword ptr [EBP + 0xfffff8f4],ESI
006edc90 : MOV dword ptr [EBP + 0xfffff8f0],EBX
006edc96 : MOV byte ptr [EBP + 0xfffff8e0],BL
006edc9c : CALL 0x00404b50
006edca1 : MOV byte ptr [EBP + -0x4],0x1
006edca5 : PUSH 0x1
006edca7 : PUSH 0xbf2a74
006edcac : LEA ECX,[EBP + 0xfffff8f8]
006edcb2 : MOV dword ptr [EBP + 0xfffff910],ESI
006edcb8 : MOV dword ptr [EBP + 0xfffff90c],EBX
006edcbe : MOV byte ptr [EBP + 0xfffff8fc],BL
006edcc4 : CALL 0x00404b50
006edcc9 : MOV byte ptr [EBP + -0x4],0x2
006edccd : LEA EAX,[EBP + 0xfffff8dc]
006edcd3 : PUSH EAX
006edcd4 : LEA ECX,[EBP + 0xfffff8f8]
006edcda : PUSH ECX
006edcdb : LEA EAX,[EBP + 0xfffffd28]
006edce1 : CALL 0x004f85c0
006edce6 : ADD ESP,0x8
006edce9 : MOV byte ptr [EBP + -0x4],0x1
006edced : MOV EDI,0x10
006edcf2 : CMP dword ptr [EBP + 0xfffff910],EDI
006edcf8 : JC 0x006edd05
006edcfa : MOV ECX,dword ptr [EBP + 0xfffff8fc]
006edd00 : CALL 0x006f04e0
006edd05 : MOV dword ptr [EBP + 0xfffff910],ESI
006edd0b : MOV dword ptr [EBP + 0xfffff90c],EBX
006edd11 : MOV byte ptr [EBP + 0xfffff8fc],BL
006edd17 : MOV byte ptr [EBP + -0x4],BL
006edd1a : CMP dword ptr [EBP + 0xfffff8f4],EDI
006edd20 : JC 0x006edd2d
006edd22 : MOV ECX,dword ptr [EBP + 0xfffff8e0]
006edd28 : CALL 0x006f04e0
006edd2d : PUSH 0x100
006edd32 : LEA EDX,[EBP + 0xfffffd44]
006edd38 : PUSH EDX
006edd39 : PUSH EBX
006edd3a : MOV dword ptr [EBP + 0xfffff8f4],ESI
006edd40 : MOV dword ptr [EBP + 0xfffff8f0],EBX
006edd46 : MOV byte ptr [EBP + 0xfffff8e0],BL
006edd4c : CALL dword ptr [0x00b852e0]
006edd52 : LEA EAX,[EBP + 0xfffffd44]
006edd58 : PUSH EAX
006edd59 : LEA ESI,[EBP + 0xfffff91c]
006edd5f : CALL 0x004f88d0
006edd64 : LEA ECX,[EBP + 0xffffff4c]
006edd6a : LEA EDI,[EBP + 0xfffff5d0]
006edd70 : CALL 0x004118a0
006edd75 : CMP byte ptr [EBP + 0xfffff7d0],BL
006edd7b : JNZ 0x006edd93
006edd7d : CMP word ptr [EBP + 0xfffff5d0],BX
006edd84 : JZ 0x006edd93
006edd86 : MOV EAX,EDI
006edd88 : LEA ESI,[EBP + 0xfffff7d0]
006edd8e : CALL 0x004d6be0
006edd93 : LEA ECX,[EBP + 0xfffff7d0]
006edd99 : PUSH ECX
006edd9a : LEA ECX,[EBP + -0x64]
006edd9d : LEA EDI,[EBP + 0xfffff2d0]
006edda3 : CALL 0x004118a0
006edda8 : CMP byte ptr [EBP + 0xfffff4d0],BL
006eddae : JNZ 0x006eddc6
006eddb0 : CMP word ptr [EBP + 0xfffff2d0],BX
006eddb7 : JZ 0x006eddc6
006eddb9 : MOV EAX,EDI
006eddbb : LEA ESI,[EBP + 0xfffff4d0]
006eddc1 : CALL 0x004d6be0
006eddc6 : LEA EDX,[EBP + 0xfffff4d0]
006eddcc : PUSH EDX
006eddcd : SUB ESP,0x1c
006eddd0 : MOV ECX,ESP
006eddd2 : MOV dword ptr [EBP + 0xfffff918],ESP
006eddd8 : PUSH -0x1
006eddda : PUSH EBX
006edddb : LEA EAX,[EBP + 0xfffffd28]
006edde1 : MOV dword ptr [ECX + 0x18],0xf
006edde8 : MOV dword ptr [ECX + 0x14],EBX
006eddeb : PUSH EAX
006eddec : MOV byte ptr [ECX + 0x4],BL
006eddef : CALL 0x00405110
006eddf4 : MOV byte ptr [EBP + -0x4],0x3
006eddf8 : MOV byte ptr [EBP + -0x4],BL
006eddfb : LEA ECX,[EBP + 0xffffecd0]
006ede01 : CALL 0x004f8610
006ede06 : LEA ESI,[EAX + 0x200]
006ede0c : MOV dword ptr [EBP + 0xfffff918],ESI
006ede12 : CMP byte ptr [ESI],BL
006ede14 : JNZ 0x006ede20
006ede16 : CMP word ptr [EAX],BX
006ede19 : JZ 0x006ede20
006ede1b : CALL 0x004d6be0
006ede20 : LEA ECX,[EBP + 0xfffffb23]
006ede26 : LEA EDI,[EBP + 0xffffefd0]
006ede2c : CALL 0x004118a0
006ede31 : CMP byte ptr [EBP + 0xfffff1d0],BL
006ede37 : JNZ 0x006ede55
006ede39 : CMP word ptr [EBP + 0xffffefd0],BX
006ede40 : JZ 0x006ede55
006ede42 : MOV EAX,EDI
006ede44 : LEA ESI,[EBP + 0xfffff1d0]
006ede4a : CALL 0x004d6be0
006ede4f : MOV ESI,dword ptr [EBP + 0xfffff918]
006ede55 : PUSH ESI
006ede56 : PUSH 0x1728948
006ede5b : LEA ECX,[EBP + 0xfffff1d0]
006ede61 : PUSH ECX
006ede62 : PUSH 0xbf2a78
006ede67 : LEA EDX,[EBP + 0xfffffe44]
006ede6d : PUSH 0x103
006ede72 : PUSH EDX
006ede73 : CALL 0x00638607
006ede78 : INC dword ptr [0x01725278]
006ede7e : ADD ESP,0x20
006ede81 : CMP byte ptr [0x01725274],BL
006ede87 : JNZ 0x006ede97
006ede89 : MOV ESI,0x1
006ede8e : MOV byte ptr [0x01725274],0x1
006ede95 : JMP 0x006ede9a
006ede97 : MOV ESI,dword ptr [EBP + 0x8]
006ede9a : PUSH EBX
006ede9b : PUSH EBX
006ede9c : PUSH 0x2
006ede9e : PUSH EBX
006ede9f : PUSH 0x1
006edea1 : PUSH 0x40000000
006edea6 : LEA EAX,[EBP + 0xfffffe44]
006edeac : PUSH EAX
006edead : CALL dword ptr [0x00b85318]
006edeb3 : MOV EDI,EAX
006edeb5 : CMP EDI,-0x1
006edeb8 : JZ 0x006edf23
006edeba : MOV ECX,dword ptr [EBP + 0xfffff914]
006edec0 : MOV dword ptr [EBP + 0xfffff8d4],ECX
006edec6 : MOV dword ptr [EBP + 0xfffff8d8],0x1
006eded0 : CALL dword ptr [0x00b85168]
006eded6 : PUSH EBX
006eded7 : PUSH EBX
006eded8 : NEG ESI
006ededa : LEA EDX,[EBP + 0xfffff8d0]
006edee0 : SBB ESI,ESI
006edee2 : PUSH EDX
006edee3 : AND ESI,0x2
006edee6 : PUSH ESI
006edee7 : PUSH EDI
006edee8 : MOV dword ptr [EBP + 0xfffff8d0],EAX
006edeee : CALL dword ptr [0x00b850e4]
006edef4 : PUSH EAX
006edef5 : CALL dword ptr [0x00b85134]
006edefb : PUSH EAX
006edefc : CALL 0x00676508
006edf01 : PUSH EDI
006edf02 : CALL dword ptr [0x00b85104]
006edf08 : LEA EAX,[EBP + 0xfffffe44]
006edf0e : PUSH EAX
006edf0f : PUSH 0xbf2a90
006edf14 : MOV ESI,0x1727938
006edf19 : CALL 0x006ed630
006edf1e : ADD ESP,0x8
006edf21 : JMP 0x006edf43
006edf23 : CALL dword ptr [0x00b85128]
006edf29 : PUSH EAX
006edf2a : LEA ECX,[EBP + 0xfffffe44]
006edf30 : PUSH ECX
006edf31 : PUSH 0xbf2ab0
006edf36 : MOV ESI,0x1727938
006edf3b : CALL 0x006ed630
006edf40 : ADD ESP,0xc
006edf43 : MOV dword ptr [EBP + -0x4],0xffffffff
006edf4a : CMP dword ptr [EBP + 0xfffffd40],0x10
006edf51 : JC 0x006edf5e
006edf53 : MOV ECX,dword ptr [EBP + 0xfffffd2c]
006edf59 : CALL 0x006f04e0
006edf5e : MOV dword ptr [EBP + 0xfffffd40],0xf
006edf68 : MOV dword ptr [EBP + 0xfffffd3c],EBX
006edf6e : MOV byte ptr [EBP + 0xfffffd2c],BL
006edf74 : MOV ECX,dword ptr [EBP + -0xc]
006edf77 : MOV dword ptr FS:[0x0],ECX
006edf7e : POP ECX
006edf7f : POP EDI
006edf80 : POP ESI
006edf81 : POP EBX
006edf82 : MOV ECX,dword ptr [EBP + -0x14]
006edf85 : XOR ECX,EBP
006edf87 : CALL 0x00633e6b
006edf8c : MOV ESP,EBP
006edf8e : POP EBP
006edf8f : RET 0x4

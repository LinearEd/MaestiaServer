PROGRAM  : Maestia.exe
FUNCTION : FUN_006a9610
ENTRY    : 006a9610
BODY     : [[006a9610, 006a982e]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006a9610(undefined4 *param_1,byte *param_2)

{
  byte *in_EAX;
  uint uVar1;
  int iVar2;
  uint uVar3;
  int *piVar4;
  int *piVar5;
  byte *local_c;
  int local_8;
  int local_4;
  
  local_8 = 0;
  param_1[100] = param_1 + 3;
  *param_1 = in_EAX;
  param_1[1] = param_2;
  param_1[2] = in_EAX;
  local_c = in_EAX;
  if (param_2 <= in_EAX) {
    return 0;
  }
  while ((uVar1 = (uint)*local_c, 0x1a < uVar1 && (uVar1 != 0x1f))) {
    if (0x17f < (int)((int)param_1[100] + (-0xc - (int)param_1) & 0xfffffffcU)) {
      return 6;
    }
    *(byte **)param_1[100] = local_c;
    param_1[100] = param_1[100] + 4;
    if (uVar1 == 0x1e) {
      do {
        local_c = local_c + 1;
        if (param_2 <= local_c) {
          return 6;
        }
      } while (((*local_c & 0xf0) != 0xf0) && ((*local_c & 0xf) != 0xf));
    }
    else if (uVar1 == 0x1c) {
      local_c = local_c + 2;
    }
    else if (uVar1 == 0x1d) {
      local_c = local_c + 4;
    }
    else if (0xf6 < uVar1) {
      local_c = local_c + 1;
    }
LAB_006a97ed:
    local_c = local_c + 1;
    if (param_2 <= local_c) {
      return local_8;
    }
  }
  uVar3 = (int)param_1[100] + (-0xc - (int)param_1) >> 2;
  *(byte **)param_1[100] = local_c;
  if (uVar1 == 0xc) {
    local_c = local_c + 1;
    if (param_2 <= local_c) {
      return 6;
    }
    uVar1 = *local_c | 0x100;
  }
  piVar4 = (int *)&DAT_00bea2a8;
  while (piVar4[1] != (uVar1 | param_1[0x65])) {
    piVar4 = piVar4 + 7;
    if (*piVar4 == 0) goto LAB_006a97e0;
  }
  piVar5 = (int *)(piVar4[2] + param_1[0x66]);
  if ((*piVar4 != 6) && (uVar3 == 0)) {
    return 6;
  }
  switch(*piVar4) {
  case 1:
  case 4:
  case 5:
    iVar2 = FUN_006a9320();
    break;
  case 2:
    iVar2 = FUN_006a9350();
    break;
  case 3:
    iVar2 = FUN_006a9380();
    break;
  case 6:
    if ((uint)piVar4[5] < uVar3) {
      uVar3 = piVar4[5];
    }
    *(char *)(piVar4[6] + param_1[0x66]) = (char)uVar3;
    local_4 = 0;
    for (; uVar3 != 0; uVar3 = uVar3 - 1) {
      iVar2 = FUN_006a9320();
      local_4 = local_4 + iVar2;
      if ((char)piVar4[3] == '\x01') {
        *(char *)piVar5 = (char)local_4;
      }
      else if ((char)piVar4[3] == '\x02') {
        *(short *)piVar5 = (short)local_4;
      }
      else {
        *piVar5 = local_4;
      }
      piVar5 = (int *)((int)piVar5 + (uint)*(byte *)(piVar4 + 3));
    }
LAB_006a97e0:
    param_1[100] = param_1 + 3;
    goto LAB_006a97ed;
  default:
    local_8 = (*(code *)piVar4[4])(param_1);
    if (local_8 != 0) {
      return local_8;
    }
    goto LAB_006a97e0;
  }
  if ((char)piVar4[3] == '\x01') {
    *(char *)piVar5 = (char)iVar2;
  }
  else if ((char)piVar4[3] == '\x02') {
    *(short *)piVar5 = (short)iVar2;
  }
  else {
    *piVar5 = iVar2;
  }
  goto LAB_006a97e0;
}



============================================================
DISASSEMBLY
============================================================
006a9610 : SUB ESP,0xc
006a9613 : PUSH EBP
006a9614 : MOV EBP,dword ptr [ESP + 0x14]
006a9618 : PUSH ESI
006a9619 : MOV ESI,dword ptr [ESP + 0x1c]
006a961d : PUSH EDI
006a961e : XOR EDI,EDI
006a9620 : MOV EDX,EAX
006a9622 : LEA ECX,[EBP + 0xc]
006a9625 : MOV dword ptr [ESP + 0xc],EDX
006a9629 : MOV dword ptr [ESP + 0x10],EDI
006a962d : MOV dword ptr [EBP + 0x190],ECX
006a9633 : MOV dword ptr [EBP],EAX
006a9636 : MOV dword ptr [EBP + 0x4],ESI
006a9639 : MOV dword ptr [EBP + 0x8],EAX
006a963c : CMP EAX,ESI
006a963e : JNC 0x006a9826
006a9644 : PUSH EBX
006a9645 : MOVZX EAX,byte ptr [EDX]
006a9648 : CMP EAX,0x1b
006a964b : JC 0x006a96cc
006a964d : CMP EAX,0x1f
006a9650 : JZ 0x006a96cc
006a9652 : MOV ECX,dword ptr [EBP + 0x190]
006a9658 : MOV EDI,ECX
006a965a : SUB EDI,EBP
006a965c : SUB EDI,0xc
006a965f : AND EDI,0xfffffffc
006a9662 : CMP EDI,0x180
006a9668 : JGE 0x006a9819
006a966e : MOV dword ptr [ECX],EDX
006a9670 : ADD dword ptr [EBP + 0x190],0x4
006a9677 : CMP EAX,0x1e
006a967a : JNZ 0x006a96a1
006a967c : INC EDX
006a967d : CMP EDX,ESI
006a967f : JNC 0x006a9819
006a9685 : MOV AL,byte ptr [EDX]
006a9687 : MOV CL,AL
006a9689 : AND CL,0xf0
006a968c : CMP CL,0xf0
006a968f : JZ 0x006a97ed
006a9695 : AND AL,0xf
006a9697 : CMP AL,0xf
006a9699 : JZ 0x006a97ed
006a969f : JMP 0x006a967c
006a96a1 : CMP EAX,0x1c
006a96a4 : JNZ 0x006a96ae
006a96a6 : ADD EDX,0x2
006a96a9 : JMP 0x006a97ed
006a96ae : CMP EAX,0x1d
006a96b1 : JNZ 0x006a96bb
006a96b3 : ADD EDX,0x4
006a96b6 : JMP 0x006a97ed
006a96bb : CMP EAX,0xf6
006a96c0 : JBE 0x006a97ed
006a96c6 : INC EDX
006a96c7 : JMP 0x006a97ed
006a96cc : MOV ECX,dword ptr [EBP + 0x190]
006a96d2 : MOV EBX,ECX
006a96d4 : SUB EBX,EBP
006a96d6 : SUB EBX,0xc
006a96d9 : SAR EBX,0x2
006a96dc : MOV dword ptr [ECX],EDX
006a96de : CMP EAX,0xc
006a96e1 : JNZ 0x006a96f8
006a96e3 : INC EDX
006a96e4 : MOV dword ptr [ESP + 0x10],EDX
006a96e8 : CMP EDX,ESI
006a96ea : JNC 0x006a9819
006a96f0 : MOVZX EAX,byte ptr [EDX]
006a96f3 : OR EAX,0x100
006a96f8 : OR EAX,dword ptr [EBP + 0x194]
006a96fe : MOV ESI,0xbea2a8
006a9703 : CMP dword ptr [ESI + 0x4],EAX
006a9706 : JZ 0x006a9715
006a9708 : ADD ESI,0x1c
006a970b : CMP dword ptr [ESI],0x0
006a970e : JNZ 0x006a9703
006a9710 : JMP 0x006a97e0
006a9715 : MOV ECX,dword ptr [EBP + 0x198]
006a971b : MOV EDI,dword ptr [ESI + 0x8]
006a971e : MOV EAX,dword ptr [ESI]
006a9720 : ADD EDI,ECX
006a9722 : CMP EAX,0x6
006a9725 : JZ 0x006a9730
006a9727 : CMP EBX,0x1
006a972a : JC 0x006a9819
006a9730 : DEC EAX
006a9731 : CMP EAX,0x5
006a9734 : JA 0x006a9806
006a973a : JMP dword ptr [EAX*0x4 + 0x6a9830]
006a9741 : LEA ECX,[EBP + 0xc]
006a9744 : CALL 0x006a9320
006a9749 : JMP 0x006a9762
006a974b : LEA ECX,[EBP + 0xc]
006a974e : CALL 0x006a9350
006a9753 : JMP 0x006a9762
006a9755 : MOV EDX,0x3
006a975a : LEA ECX,[EBP + 0xc]
006a975d : CALL 0x006a9380
006a9762 : MOVZX ECX,byte ptr [ESI + 0xc]
006a9766 : SUB ECX,0x1
006a9769 : JZ 0x006a9779
006a976b : SUB ECX,0x1
006a976e : JZ 0x006a9774
006a9770 : MOV dword ptr [EDI],EAX
006a9772 : JMP 0x006a97dc
006a9774 : MOV word ptr [EDI],AX
006a9777 : JMP 0x006a97dc
006a9779 : MOV byte ptr [EDI],AL
006a977b : JMP 0x006a97dc
006a977d : MOV EAX,dword ptr [ESI + 0x18]
006a9780 : ADD EAX,ECX
006a9782 : MOV ECX,dword ptr [ESI + 0x14]
006a9785 : ADD EBP,0xc
006a9788 : CMP EBX,ECX
006a978a : JBE 0x006a978e
006a978c : MOV EBX,ECX
006a978e : MOV byte ptr [EAX],BL
006a9790 : MOV dword ptr [ESP + 0x18],0x0
006a9798 : TEST EBX,EBX
006a979a : JBE 0x006a97d8
006a979c : LEA ESP,[ESP]
006a97a0 : MOV ECX,EBP
006a97a2 : CALL 0x006a9320
006a97a7 : MOV ECX,dword ptr [ESP + 0x18]
006a97ab : ADD ECX,EAX
006a97ad : MOVZX EAX,byte ptr [ESI + 0xc]
006a97b1 : ADD EBP,0x4
006a97b4 : SUB EAX,0x1
006a97b7 : MOV dword ptr [ESP + 0x18],ECX
006a97bb : JZ 0x006a97cb
006a97bd : SUB EAX,0x1
006a97c0 : JZ 0x006a97c6
006a97c2 : MOV dword ptr [EDI],ECX
006a97c4 : JMP 0x006a97cd
006a97c6 : MOV word ptr [EDI],CX
006a97c9 : JMP 0x006a97cd
006a97cb : MOV byte ptr [EDI],CL
006a97cd : MOVZX EDX,byte ptr [ESI + 0xc]
006a97d1 : ADD EDI,EDX
006a97d3 : SUB EBX,0x1
006a97d6 : JNZ 0x006a97a0
006a97d8 : MOV EBP,dword ptr [ESP + 0x20]
006a97dc : MOV EDX,dword ptr [ESP + 0x10]
006a97e0 : MOV ESI,dword ptr [ESP + 0x24]
006a97e4 : LEA EAX,[EBP + 0xc]
006a97e7 : MOV dword ptr [EBP + 0x190],EAX
006a97ed : INC EDX
006a97ee : MOV dword ptr [ESP + 0x10],EDX
006a97f2 : CMP EDX,ESI
006a97f4 : JC 0x006a9645
006a97fa : MOV EAX,dword ptr [ESP + 0x14]
006a97fe : POP EBX
006a97ff : POP EDI
006a9800 : POP ESI
006a9801 : POP EBP
006a9802 : ADD ESP,0xc
006a9805 : RET
006a9806 : MOV EAX,dword ptr [ESI + 0x10]
006a9809 : PUSH EBP
006a980a : CALL EAX
006a980c : ADD ESP,0x4
006a980f : MOV dword ptr [ESP + 0x14],EAX
006a9813 : TEST EAX,EAX
006a9815 : JNZ 0x006a97fa
006a9817 : JMP 0x006a97dc
006a9819 : POP EBX
006a981a : POP EDI
006a981b : POP ESI
006a981c : MOV EAX,0x6
006a9821 : POP EBP
006a9822 : ADD ESP,0xc
006a9825 : RET
006a9826 : MOV EAX,EDI
006a9828 : POP EDI
006a9829 : POP ESI
006a982a : POP EBP
006a982b : ADD ESP,0xc
006a982e : RET

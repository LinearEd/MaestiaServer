PROGRAM  : Maestia.exe
FUNCTION : FUN_004ce240
ENTRY    : 004ce240
BODY     : [[004ce240, 004ce368]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_004ce240(void)

{
  void *pvVar1;
  int iVar2;
  undefined4 *unaff_EDI;
  undefined1 local_1008 [4096];
  uint local_8;
  
  local_8 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  if (unaff_EDI[0x118] != 0) {
    unaff_EDI[0x103] = 0x400;
    *unaff_EDI = unaff_EDI + 2;
    _memset(unaff_EDI + 2,0,0x401);
    unaff_EDI[0x10c] = 0;
    unaff_EDI[0x10d] = 0;
    unaff_EDI[0x10e] = 0;
    unaff_EDI[0x113] = 0;
    unaff_EDI[0x104] = 0;
    unaff_EDI[0x107] = 0;
    unaff_EDI[0x108] = 0;
    unaff_EDI[0x105] = 0;
    unaff_EDI[0x112] = 0;
    unaff_EDI[0x115] = 0;
    unaff_EDI[0x116] = 0;
    unaff_EDI[0x114] = 0;
    pvVar1 = _malloc(0x1000);
    unaff_EDI[0x113] = pvVar1;
    unaff_EDI[0x104] = pvVar1;
    iVar2 = FUN_007113b0(0x38);
    if ((iVar2 == 0) && (unaff_EDI[0x113] != 0)) {
      unaff_EDI[0x108] = 0x1000;
      FUN_004ce370();
      iVar2 = FUN_004ce4a0(local_1008);
      while (0 < iVar2) {
        FUN_004ce710(local_1008,iVar2);
        iVar2 = FUN_004ce4a0(local_1008);
      }
    }
    FUN_004ce7b0();
    __security_check_cookie(local_8 ^ (uint)&stack0xfffffffc);
    return;
  }
  *unaff_EDI = 0;
  unaff_EDI[1] = 0;
  __security_check_cookie(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
004ce240 : PUSH EBP
004ce241 : MOV EBP,ESP
004ce243 : MOV EAX,0x1004
004ce248 : CALL 0x0063b780
004ce24d : MOV EAX,[0x00d66fa0]
004ce252 : XOR EAX,EBP
004ce254 : MOV dword ptr [EBP + -0x4],EAX
004ce257 : PUSH EBX
004ce258 : XOR EBX,EBX
004ce25a : CMP dword ptr [EDI + 0x460],EBX
004ce260 : JNZ 0x004ce276
004ce262 : MOV dword ptr [EDI],EBX
004ce264 : MOV dword ptr [EDI + 0x4],EBX
004ce267 : POP EBX
004ce268 : MOV ECX,dword ptr [EBP + -0x4]
004ce26b : XOR ECX,EBP
004ce26d : CALL 0x00633e6b
004ce272 : MOV ESP,EBP
004ce274 : POP EBP
004ce275 : RET
004ce276 : PUSH ESI
004ce277 : PUSH 0x401
004ce27c : LEA EAX,[EDI + 0x8]
004ce27f : PUSH EBX
004ce280 : PUSH EAX
004ce281 : MOV dword ptr [EDI + 0x40c],0x400
004ce28b : MOV dword ptr [EDI],EAX
004ce28d : CALL 0x0063b700
004ce292 : LEA ESI,[EDI + 0x410]
004ce298 : PUSH 0x1000
004ce29d : MOV dword ptr [EDI + 0x430],EBX
004ce2a3 : MOV dword ptr [EDI + 0x434],EBX
004ce2a9 : MOV dword ptr [EDI + 0x438],EBX
004ce2af : MOV dword ptr [EDI + 0x44c],EBX
004ce2b5 : MOV dword ptr [ESI],EBX
004ce2b7 : MOV dword ptr [EDI + 0x41c],EBX
004ce2bd : MOV dword ptr [EDI + 0x420],EBX
004ce2c3 : MOV dword ptr [EDI + 0x414],EBX
004ce2c9 : MOV dword ptr [EDI + 0x448],EBX
004ce2cf : MOV dword ptr [EDI + 0x454],EBX
004ce2d5 : MOV dword ptr [EDI + 0x458],EBX
004ce2db : MOV dword ptr [EDI + 0x450],EBX
004ce2e1 : CALL 0x00636043
004ce2e6 : MOV dword ptr [EDI + 0x44c],EAX
004ce2ec : MOV dword ptr [ESI],EAX
004ce2ee : PUSH 0x38
004ce2f0 : MOV EAX,0xcda510
004ce2f5 : MOV ECX,0xfffffff1
004ce2fa : CALL 0x007113b0
004ce2ff : ADD ESP,0x14
004ce302 : TEST EAX,EAX
004ce304 : JNZ 0x004ce352
004ce306 : CMP dword ptr [EDI + 0x44c],EBX
004ce30c : JZ 0x004ce352
004ce30e : MOV ESI,EDI
004ce310 : MOV dword ptr [EDI + 0x420],0x1000
004ce31a : CALL 0x004ce370
004ce31f : LEA EAX,[EBP + 0xffffeffc]
004ce325 : PUSH EAX
004ce326 : MOV EAX,EDI
004ce328 : CALL 0x004ce4a0
004ce32d : CMP EAX,EBX
004ce32f : JLE 0x004ce352
004ce331 : PUSH EAX
004ce332 : LEA ECX,[EBP + 0xffffeffc]
004ce338 : PUSH ECX
004ce339 : MOV ESI,EDI
004ce33b : CALL 0x004ce710
004ce340 : LEA EDX,[EBP + 0xffffeffc]
004ce346 : PUSH EDX
004ce347 : MOV EAX,EDI
004ce349 : CALL 0x004ce4a0
004ce34e : CMP EAX,EBX
004ce350 : JG 0x004ce331
004ce352 : MOV EAX,EDI
004ce354 : CALL 0x004ce7b0
004ce359 : MOV ECX,dword ptr [EBP + -0x4]
004ce35c : POP ESI
004ce35d : XOR ECX,EBP
004ce35f : POP EBX
004ce360 : CALL 0x00633e6b
004ce365 : MOV ESP,EBP
004ce367 : POP EBP
004ce368 : RET

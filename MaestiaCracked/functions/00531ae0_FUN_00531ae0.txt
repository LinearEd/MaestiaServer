PROGRAM  : Maestia.exe
FUNCTION : FUN_00531ae0
ENTRY    : 00531ae0
BODY     : [[00531ae0, 00531bac] [00531bb0, 00531e56] [00531e60, 00531f5a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00531ae0(uint param_1)

{
  int *piVar1;
  char *pcVar2;
  uint *puVar3;
  byte *pbVar4;
  undefined1 uVar5;
  undefined1 uVar6;
  char cVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  uint uVar11;
  char *pcVar12;
  undefined4 uVar13;
  undefined4 *puVar14;
  int *in_ECX;
  int *piVar15;
  uint uVar16;
  int iVar17;
  uint uVar18;
  int local_38;
  int local_34;
  int *local_30;
  int local_2c;
  uint local_28;
  uint local_24;
  uint local_20;
  int local_1c;
  int local_18;
  byte local_14;
  undefined1 local_10 [16];
  
  iVar10 = FUN_00515840(0x68,0);
  if (iVar10 == 0) {
    local_34 = 0;
  }
  else {
    local_34 = FUN_00569220(*in_ECX,param_1,in_ECX[5],0,in_ECX[8],2);
  }
  iVar9 = local_34;
  iVar10 = in_ECX[6];
  local_38 = FUN_00525530(in_ECX[2] + iVar10 + 3);
  *(int *)(local_38 + 8) = *(int *)(local_38 + 8) + 1;
  iVar17 = in_ECX[2];
  iVar10 = iVar10 + 4 + *(int *)(local_38 + 0x10);
  uVar5 = *(undefined1 *)(iVar17 + iVar10);
  uVar6 = *(undefined1 *)(iVar17 + 1 + iVar10);
  *(undefined1 *)(iVar9 + 0x67) = *(undefined1 *)(iVar17 + 2 + iVar10);
  uVar11 = (uint)CONCAT11(uVar6,uVar5);
  iVar17 = iVar10 + 5;
  *(undefined2 *)(iVar9 + 100) = *(undefined2 *)(in_ECX[2] + iVar10 + 3);
  local_1c = iVar9;
  if (uVar11 != 0) {
    piVar15 = (int *)(iVar9 + 0x50);
    local_28 = uVar11;
    do {
      local_20 = (uint)*(byte *)(in_ECX[2] + iVar17);
      pcVar2 = (char *)(in_ECX[2] + iVar17 + 1);
      pcVar12 = pcVar2;
      do {
        cVar7 = *pcVar12;
        pcVar12 = pcVar12 + 1;
      } while (cVar7 != '\0');
      uVar11 = FUN_00525450(pcVar2,(int)pcVar12 - (int)(pcVar2 + 1));
      *(int *)(uVar11 + 8) = *(int *)(uVar11 + 8) + 1;
      local_24 = *(uint *)(iVar9 + 0x54);
      uVar16 = *(int *)(local_34 + 0x54) + 1;
      param_1 = uVar11;
      if (uVar16 < local_24) {
        local_2c = local_24 - uVar16;
        if (local_2c != 0) {
          local_30 = (int *)(*piVar15 + (local_2c + uVar16) * 8 + -4);
          do {
            piVar1 = (int *)(*local_30 + 8);
            *piVar1 = *piVar1 + -1;
            if (*piVar1 == 0) {
              FUN_00525340();
              uVar11 = param_1;
            }
            local_30 = local_30 + -2;
            local_2c = local_2c + -1;
          } while (local_2c != 0);
        }
        uVar18 = uVar16;
        if (uVar16 < *(uint *)(iVar9 + 0x58) >> 1) {
LAB_00531c5c:
          FUN_0052a990(piVar15,uVar18);
          uVar11 = param_1;
        }
      }
      else if (*(uint *)(iVar9 + 0x58) <= uVar16) {
        uVar18 = (uVar16 >> 2) + uVar16;
        goto LAB_00531c5c;
      }
      *(uint *)(iVar9 + 0x54) = uVar16;
      if (local_24 < uVar16) {
        puVar14 = (undefined4 *)(*piVar15 + local_24 * 8);
        for (iVar10 = uVar16 - local_24; iVar10 != 0; iVar10 = iVar10 + -1) {
          if (puVar14 != (undefined4 *)0x0) {
            *puVar14 = *(undefined4 *)(iVar9 + 0x5c);
            iVar8 = *(int *)(iVar9 + 0x60);
            puVar14[1] = iVar8;
            piVar1 = (int *)(iVar8 + 8);
            *piVar1 = *piVar1 + 1;
          }
          puVar14 = puVar14 + 2;
        }
      }
      puVar3 = (uint *)(*piVar15 + -8 + *(int *)(iVar9 + 0x54) * 8);
      *puVar3 = local_20;
      *(int *)(uVar11 + 8) = *(int *)(uVar11 + 8) + 1;
      piVar1 = (int *)(puVar3[1] + 8);
      *piVar1 = *piVar1 + -1;
      if (*piVar1 == 0) {
        FUN_00525340();
        uVar11 = param_1;
      }
      puVar3[1] = uVar11;
      piVar1 = (int *)(uVar11 + 8);
      *piVar1 = *piVar1 + -1;
      iVar17 = iVar17 + 2 + *(int *)(uVar11 + 0x10);
      if (*piVar1 == 0) {
        FUN_00525340();
      }
      local_28 = local_28 - 1;
    } while (local_28 != 0);
    local_28 = 0;
    local_1c = local_34;
  }
  uVar11 = (uint)CONCAT11(*(undefined1 *)(iVar17 + 1 + in_ECX[2]),
                          *(undefined1 *)(iVar17 + in_ECX[2]));
  *(uint *)(local_1c + 0x4c) = uVar11;
  in_ECX[5] = in_ECX[5] + uVar11;
  local_14 = 0;
  *(uint *)(local_1c + 8) = *(int *)(local_1c + 8) + 1U & 0x8fffffff;
  local_18 = 0;
  iVar10 = *(int *)(*in_ECX + 0xcc);
  if ((iVar10 != 0) && (iVar10 = *(int *)(*(int *)(*in_ECX + 200) + -4 + iVar10 * 4), iVar10 != 0))
  {
    FUN_005686c0(iVar10,0);
  }
  FUN_00526210(&local_1c);
  if (*(int *)(local_38 + 0x10) != 0) {
    param_1 = param_1 & 0xffffff00;
    (**(code **)(*(int *)(*(int *)(*in_ECX + 0x74) + 0x68) + 0x28))
              (*in_ECX + 0x78,&local_38,local_10,&param_1);
  }
  iVar10 = *in_ECX;
  local_24 = iVar10 + 0x78;
  iVar17 = FUN_00515840(0x50,0);
  if (iVar17 == 0) {
    local_28 = 0;
  }
  else {
    uVar13 = FUN_00530910(1);
    local_28 = FUN_00568ed0(iVar10 + 0x78,uVar13,&local_1c,0);
  }
  local_20 = *(int *)(*in_ECX + 0x78);
  iVar10 = *(int *)(local_20 + 0x278);
  piVar15 = (int *)(local_20 + 0x278);
  param_1 = 7;
  if (iVar10 == 0) {
LAB_00531e3c:
    FUN_005307e0(local_20 + 0x24);
    iVar10 = *piVar15;
    if (iVar10 != 0) {
      uVar11 = 0x1505;
      iVar17 = 4;
      do {
        pbVar4 = &stack0x00000003 + iVar17;
        iVar17 = iVar17 + -1;
        uVar11 = uVar11 * 0x1003f + (uint)*pbVar4;
      } while (iVar17 != 0);
      iVar17 = FUN_0052bfd0(&param_1,*(uint *)(iVar10 + 4) & uVar11);
      if (((-1 < iVar17) && (iVar10 = iVar10 + (iVar17 * 3 + 3) * 4, iVar10 != 0)) &&
         (puVar14 = (undefined4 *)(iVar10 + 4), puVar14 != (undefined4 *)0x0)) goto LAB_00531e98;
    }
    uVar13 = 0;
  }
  else {
    iVar17 = 4;
    uVar11 = 0x1505;
    do {
      pbVar4 = &stack0x00000003 + iVar17;
      iVar17 = iVar17 + -1;
      uVar11 = uVar11 * 0x1003f + (uint)*pbVar4;
    } while (iVar17 != 0);
    iVar17 = FUN_0052bfd0(&param_1,*(uint *)(iVar10 + 4) & uVar11);
    if (((iVar17 < 0) || (iVar10 = iVar10 + (iVar17 * 3 + 3) * 4, iVar10 == 0)) ||
       (puVar14 = (undefined4 *)(iVar10 + 4), puVar14 == (undefined4 *)0x0)) goto LAB_00531e3c;
LAB_00531e98:
    uVar13 = *puVar14;
  }
  uVar16 = local_24;
  FUN_00568840(local_24,uVar13);
  uVar11 = local_28;
  FUN_00568300(uVar16,local_28);
  if (*(int *)(local_38 + 0x10) == 0) {
    iVar10 = *in_ECX;
    *(int *)(iVar10 + 8) = *(int *)(iVar10 + 8) + 0x10;
    if (*(uint *)(iVar10 + 0x10) <= *(uint *)(iVar10 + 8)) {
      FUN_00504050();
    }
    if (*(int *)(iVar10 + 8) != 0) {
      FUN_005266c0(local_10);
    }
  }
  if (uVar11 != 0) {
    FUN_00503db0();
  }
  FUN_00526bc0();
  if (((local_14 & 2) == 0) && (local_1c != 0)) {
    FUN_00503db0();
  }
  local_1c = 0;
  if (((local_14 & 1) == 0) && (local_18 != 0)) {
    FUN_00503db0();
  }
  local_18 = 0;
  *(int *)(local_38 + 8) = *(int *)(local_38 + 8) + -1;
  if (*(int *)(local_38 + 8) == 0) {
    FUN_00525340();
  }
  FUN_00503db0();
  return;
}



============================================================
DISASSEMBLY
============================================================
00531ae0 : SUB ESP,0x38
00531ae3 : PUSH EBX
00531ae4 : PUSH EBP
00531ae5 : MOV EBP,ECX
00531ae7 : MOV EAX,dword ptr [EBP]
00531aea : MOV ECX,dword ptr [EAX + 0x78]
00531aed : MOV ECX,dword ptr [ECX + 0x288]
00531af3 : PUSH 0x0
00531af5 : PUSH 0x68
00531af7 : CALL 0x00515840
00531afc : TEST EAX,EAX
00531afe : JZ 0x00531b24
00531b00 : MOV ECX,dword ptr [EBP + 0x20]
00531b03 : MOV EDX,dword ptr [EBP + 0x14]
00531b06 : PUSH 0x2
00531b08 : PUSH ECX
00531b09 : MOV ECX,dword ptr [ESP + 0x4c]
00531b0d : PUSH 0x0
00531b0f : PUSH EDX
00531b10 : MOV EDX,dword ptr [EBP]
00531b13 : PUSH ECX
00531b14 : PUSH EDX
00531b15 : MOV ECX,EAX
00531b17 : CALL 0x00569220
00531b1c : MOV EBX,EAX
00531b1e : MOV dword ptr [ESP + 0xc],EBX
00531b22 : JMP 0x00531b30
00531b24 : MOV dword ptr [ESP + 0xc],0x0
00531b2c : MOV EBX,dword ptr [ESP + 0xc]
00531b30 : MOV EAX,dword ptr [EBP + 0x8]
00531b33 : MOV ECX,dword ptr [EBP]
00531b36 : MOV ECX,dword ptr [ECX + 0x78]
00531b39 : PUSH ESI
00531b3a : MOV ESI,dword ptr [EBP + 0x18]
00531b3d : ADD ESI,0x3
00531b40 : PUSH EDI
00531b41 : ADD EAX,ESI
00531b43 : PUSH EAX
00531b44 : ADD ECX,0x254
00531b4a : CALL 0x00525530
00531b4f : MOV dword ptr [ESP + 0x10],EAX
00531b53 : INC dword ptr [EAX + 0x8]
00531b56 : MOV EDX,dword ptr [ESP + 0x10]
00531b5a : MOV EAX,dword ptr [EDX + 0x10]
00531b5d : MOV ECX,dword ptr [EBP + 0x8]
00531b60 : LEA EDI,[ESI + EAX*0x1 + 0x1]
00531b64 : MOVZX EDX,byte ptr [ECX + EDI*0x1]
00531b68 : MOVZX EAX,byte ptr [ECX + EDI*0x1 + 0x1]
00531b6d : MOV CL,byte ptr [ECX + EDI*0x1 + 0x2]
00531b71 : ADD EDI,0x2
00531b74 : MOV byte ptr [EBX + 0x67],CL
00531b77 : MOV ECX,dword ptr [EBP + 0x8]
00531b7a : INC EDI
00531b7b : ADD ECX,EDI
00531b7d : SHL EAX,0x8
00531b80 : OR EAX,EDX
00531b82 : MOVZX DX,byte ptr [ECX + 0x1]
00531b87 : MOVZX CX,byte ptr [ECX]
00531b8b : SHL DX,0x8
00531b8f : OR DX,CX
00531b92 : MOVZX ECX,DX
00531b95 : ADD EDI,0x2
00531b98 : MOV word ptr [EBX + 0x64],CX
00531b9c : TEST EAX,EAX
00531b9e : JLE 0x00531ce6
00531ba4 : ADD EBX,0x50
00531ba7 : MOV dword ptr [ESP + 0x20],EAX
00531bab : JMP 0x00531bb0
00531bb0 : MOV EAX,dword ptr [EBP + 0x8]
00531bb3 : MOVZX EDX,byte ptr [EAX + EDI*0x1]
00531bb7 : INC EDI
00531bb8 : LEA ESI,[EAX + EDI*0x1]
00531bbb : MOV EAX,ESI
00531bbd : MOV dword ptr [ESP + 0x28],EDX
00531bc1 : LEA ECX,[EAX + 0x1]
00531bc4 : MOV DL,byte ptr [EAX]
00531bc6 : INC EAX
00531bc7 : TEST DL,DL
00531bc9 : JNZ 0x00531bc4
00531bcb : SUB EAX,ECX
00531bcd : MOV ECX,dword ptr [EBP]
00531bd0 : MOV ECX,dword ptr [ECX + 0x78]
00531bd3 : PUSH EAX
00531bd4 : PUSH ESI
00531bd5 : ADD ECX,0x254
00531bdb : CALL 0x00525450
00531be0 : INC dword ptr [EAX + 0x8]
00531be3 : MOV EDX,dword ptr [ESP + 0x14]
00531be7 : MOV ESI,dword ptr [EDX + 0x54]
00531bea : MOV ECX,dword ptr [EBX + 0x4]
00531bed : INC ESI
00531bee : MOV dword ptr [ESP + 0x4c],EAX
00531bf2 : MOV dword ptr [ESP + 0x24],ECX
00531bf6 : CMP ESI,ECX
00531bf8 : JNC 0x00531c4f
00531bfa : MOV EDX,dword ptr [EBX]
00531bfc : SUB ECX,ESI
00531bfe : MOV dword ptr [ESP + 0x1c],ECX
00531c02 : LEA ECX,[ECX + ESI*0x1]
00531c05 : LEA ECX,[EDX + ECX*0x8 + -0x8]
00531c09 : JZ 0x00531c43
00531c0b : MOV EDX,dword ptr [ESP + 0x1c]
00531c0f : ADD ECX,0x4
00531c12 : MOV dword ptr [ESP + 0x18],ECX
00531c16 : MOV dword ptr [ESP + 0x1c],EDX
00531c1a : LEA EBX,[EBX]
00531c20 : MOV ECX,dword ptr [ECX]
00531c22 : ADD dword ptr [ECX + 0x8],-0x1
00531c26 : JNZ 0x00531c31
00531c28 : CALL 0x00525340
00531c2d : MOV EAX,dword ptr [ESP + 0x4c]
00531c31 : MOV ECX,dword ptr [ESP + 0x18]
00531c35 : SUB ECX,0x8
00531c38 : SUB dword ptr [ESP + 0x1c],0x1
00531c3d : MOV dword ptr [ESP + 0x18],ECX
00531c41 : JNZ 0x00531c20
00531c43 : MOV ECX,dword ptr [EBX + 0x8]
00531c46 : SHR ECX,0x1
00531c48 : CMP ESI,ECX
00531c4a : JNC 0x00531c68
00531c4c : PUSH ESI
00531c4d : JMP 0x00531c5c
00531c4f : CMP ESI,dword ptr [EBX + 0x8]
00531c52 : JC 0x00531c68
00531c54 : MOV EDX,ESI
00531c56 : SHR EDX,0x2
00531c59 : ADD EDX,ESI
00531c5b : PUSH EDX
00531c5c : PUSH EBX
00531c5d : MOV ECX,EBX
00531c5f : CALL 0x0052a990
00531c64 : MOV EAX,dword ptr [ESP + 0x4c]
00531c68 : MOV EDX,dword ptr [ESP + 0x24]
00531c6c : MOV dword ptr [EBX + 0x4],ESI
00531c6f : CMP ESI,EDX
00531c71 : JBE 0x00531c9a
00531c73 : SUB ESI,EDX
00531c75 : MOV ECX,dword ptr [EBX]
00531c77 : LEA ECX,[ECX + EDX*0x8]
00531c7a : JZ 0x00531c9a
00531c7c : LEA ESP,[ESP]
00531c80 : TEST ECX,ECX
00531c82 : JZ 0x00531c92
00531c84 : MOV EDX,dword ptr [EBX + 0xc]
00531c87 : MOV dword ptr [ECX],EDX
00531c89 : MOV EDX,dword ptr [EBX + 0x10]
00531c8c : MOV dword ptr [ECX + 0x4],EDX
00531c8f : INC dword ptr [EDX + 0x8]
00531c92 : ADD ECX,0x8
00531c95 : SUB ESI,0x1
00531c98 : JNZ 0x00531c80
00531c9a : MOV ECX,dword ptr [EBX + 0x4]
00531c9d : MOV EDX,dword ptr [EBX]
00531c9f : LEA ESI,[EDX + ECX*0x8 + -0x8]
00531ca3 : MOV ECX,dword ptr [ESP + 0x28]
00531ca7 : MOV dword ptr [ESI],ECX
00531ca9 : INC dword ptr [EAX + 0x8]
00531cac : MOV ECX,dword ptr [ESI + 0x4]
00531caf : ADD dword ptr [ECX + 0x8],-0x1
00531cb3 : JNZ 0x00531cbe
00531cb5 : CALL 0x00525340
00531cba : MOV EAX,dword ptr [ESP + 0x4c]
00531cbe : MOV dword ptr [ESI + 0x4],EAX
00531cc1 : MOV EDX,EAX
00531cc3 : MOV ECX,dword ptr [EDX + 0x10]
00531cc6 : ADD dword ptr [EAX + 0x8],-0x1
00531cca : LEA EDI,[EDI + ECX*0x1 + 0x1]
00531cce : JNZ 0x00531cd7
00531cd0 : MOV ECX,EAX
00531cd2 : CALL 0x00525340
00531cd7 : SUB dword ptr [ESP + 0x20],0x1
00531cdc : JNZ 0x00531bb0
00531ce2 : MOV EBX,dword ptr [ESP + 0x14]
00531ce6 : MOV EDX,dword ptr [EBP + 0x8]
00531ce9 : MOVZX EAX,byte ptr [EDI + EDX*0x1 + 0x1]
00531cee : MOVZX ECX,byte ptr [EDI + EDX*0x1]
00531cf2 : ADD EDI,EDX
00531cf4 : SHL EAX,0x8
00531cf7 : OR EAX,ECX
00531cf9 : MOV dword ptr [EBX + 0x4c],EAX
00531cfc : ADD dword ptr [EBP + 0x14],EAX
00531cff : MOV byte ptr [ESP + 0x34],0x0
00531d04 : MOV dword ptr [ESP + 0x2c],EBX
00531d08 : MOV EDX,dword ptr [EBX + 0x8]
00531d0b : INC EDX
00531d0c : AND EDX,0x8fffffff
00531d12 : MOV dword ptr [EBX + 0x8],EDX
00531d15 : MOV EAX,dword ptr [EBP]
00531d18 : MOV dword ptr [ESP + 0x30],0x0
00531d20 : MOV ECX,dword ptr [EAX + 0xcc]
00531d26 : TEST ECX,ECX
00531d28 : JBE 0x00531d44
00531d2a : MOV EAX,dword ptr [EAX + 0xc8]
00531d30 : MOV ECX,dword ptr [EAX + ECX*0x4 + -0x4]
00531d34 : TEST ECX,ECX
00531d36 : JZ 0x00531d44
00531d38 : PUSH 0x0
00531d3a : PUSH ECX
00531d3b : LEA ECX,[ESP + 0x34]
00531d3f : CALL 0x005686c0
00531d44 : LEA ECX,[ESP + 0x2c]
00531d48 : PUSH ECX
00531d49 : LEA ECX,[ESP + 0x3c]
00531d4d : CALL 0x00526210
00531d52 : MOV EDX,dword ptr [ESP + 0x10]
00531d56 : CMP dword ptr [EDX + 0x10],0x0
00531d5a : JZ 0x00531d84
00531d5c : MOV EAX,dword ptr [EBP]
00531d5f : MOV ECX,dword ptr [EAX + 0x74]
00531d62 : LEA ESI,[ESP + 0x4c]
00531d66 : PUSH ESI
00531d67 : LEA ESI,[ESP + 0x3c]
00531d6b : PUSH ESI
00531d6c : ADD ECX,0x68
00531d6f : LEA ESI,[ESP + 0x18]
00531d73 : ADD EAX,0x78
00531d76 : MOV byte ptr [ESP + 0x54],0x0
00531d7b : MOV EDX,dword ptr [ECX]
00531d7d : PUSH ESI
00531d7e : PUSH EAX
00531d7f : MOV EAX,dword ptr [EDX + 0x28]
00531d82 : CALL EAX
00531d84 : MOV ESI,dword ptr [EBP]
00531d87 : MOV ECX,dword ptr [ESI + 0x78]
00531d8a : MOV ECX,dword ptr [ECX + 0x288]
00531d90 : ADD ESI,0x78
00531d93 : PUSH 0x0
00531d95 : PUSH 0x50
00531d97 : MOV dword ptr [ESP + 0x2c],ESI
00531d9b : CALL 0x00515840
00531da0 : MOV EDI,EAX
00531da2 : TEST EDI,EDI
00531da4 : JZ 0x00531dc9
00531da6 : MOV EDX,dword ptr [EBP]
00531da9 : MOV ECX,dword ptr [EDX + 0x78]
00531dac : PUSH 0x1
00531dae : CALL 0x00530910
00531db3 : PUSH 0x0
00531db5 : LEA ECX,[ESP + 0x30]
00531db9 : PUSH ECX
00531dba : PUSH EAX
00531dbb : PUSH ESI
00531dbc : MOV ECX,EDI
00531dbe : CALL 0x00568ed0
00531dc3 : MOV dword ptr [ESP + 0x20],EAX
00531dc7 : JMP 0x00531dd1
00531dc9 : MOV dword ptr [ESP + 0x20],0x0
00531dd1 : MOV EDX,dword ptr [EBP]
00531dd4 : MOV ECX,dword ptr [EDX + 0x78]
00531dd7 : MOV EDI,dword ptr [ECX + 0x278]
00531ddd : LEA ESI,[ECX + 0x278]
00531de3 : MOV dword ptr [ESP + 0x28],ECX
00531de7 : MOV dword ptr [ESP + 0x4c],0x7
00531def : TEST EDI,EDI
00531df1 : JZ 0x00531e3c
00531df3 : MOV ECX,0x1505
00531df8 : MOV EAX,0x4
00531dfd : LEA ECX,[ECX]
00531e00 : MOVZX EDX,byte ptr [ESP + EAX*0x1 + 0x4b]
00531e05 : IMUL ECX,ECX,0x1003f
00531e0b : DEC EAX
00531e0c : ADD ECX,EDX
00531e0e : TEST EAX,EAX
00531e10 : JA 0x00531e00
00531e12 : MOV EAX,dword ptr [EDI + 0x4]
00531e15 : AND EAX,ECX
00531e17 : PUSH EAX
00531e18 : LEA ECX,[ESP + 0x50]
00531e1c : PUSH ECX
00531e1d : MOV ECX,ESI
00531e1f : CALL 0x0052bfd0
00531e24 : TEST EAX,EAX
00531e26 : JL 0x00531e38
00531e28 : LEA EDX,[EAX + EAX*0x2 + 0x3]
00531e2c : LEA EAX,[EDI + EDX*0x4]
00531e2f : TEST EAX,EAX
00531e31 : JZ 0x00531e38
00531e33 : ADD EAX,0x4
00531e36 : JNZ 0x00531e98
00531e38 : MOV ECX,dword ptr [ESP + 0x28]
00531e3c : LEA EAX,[ECX + 0x24]
00531e3f : PUSH EAX
00531e40 : CALL 0x005307e0
00531e45 : MOV EDI,dword ptr [ESI]
00531e47 : TEST EDI,EDI
00531e49 : JZ 0x00531e9c
00531e4b : MOV ECX,0x1505
00531e50 : MOV EAX,0x4
00531e55 : JMP 0x00531e60
00531e60 : MOVZX EDX,byte ptr [ESP + EAX*0x1 + 0x4b]
00531e65 : IMUL ECX,ECX,0x1003f
00531e6b : DEC EAX
00531e6c : ADD ECX,EDX
00531e6e : TEST EAX,EAX
00531e70 : JA 0x00531e60
00531e72 : MOV EAX,dword ptr [EDI + 0x4]
00531e75 : AND EAX,ECX
00531e77 : PUSH EAX
00531e78 : LEA ECX,[ESP + 0x50]
00531e7c : PUSH ECX
00531e7d : MOV ECX,ESI
00531e7f : CALL 0x0052bfd0
00531e84 : TEST EAX,EAX
00531e86 : JL 0x00531e9c
00531e88 : LEA EDX,[EAX + EAX*0x2 + 0x3]
00531e8c : LEA EAX,[EDI + EDX*0x4]
00531e8f : TEST EAX,EAX
00531e91 : JZ 0x00531e9c
00531e93 : ADD EAX,0x4
00531e96 : JZ 0x00531e9c
00531e98 : MOV EAX,dword ptr [EAX]
00531e9a : JMP 0x00531e9e
00531e9c : XOR EAX,EAX
00531e9e : MOV ESI,dword ptr [ESP + 0x24]
00531ea2 : MOV ECX,dword ptr [ESP + 0x2c]
00531ea6 : PUSH EAX
00531ea7 : PUSH ESI
00531ea8 : CALL 0x00568840
00531ead : MOV EDI,dword ptr [ESP + 0x20]
00531eb1 : PUSH EDI
00531eb2 : PUSH ESI
00531eb3 : MOV ECX,EBX
00531eb5 : CALL 0x00568300
00531eba : MOV EAX,dword ptr [ESP + 0x10]
00531ebe : XOR ESI,ESI
00531ec0 : CMP dword ptr [EAX + 0x10],ESI
00531ec3 : JNZ 0x00531ef1
00531ec5 : MOV EBP,dword ptr [EBP]
00531ec8 : ADD dword ptr [EBP + 0x8],0x10
00531ecc : MOV EAX,dword ptr [EBP + 0x8]
00531ecf : ADD EBP,0x8
00531ed2 : CMP EAX,dword ptr [EBP + 0x8]
00531ed5 : JC 0x00531ede
00531ed7 : MOV ECX,EBP
00531ed9 : CALL 0x00504050
00531ede : MOV EBP,dword ptr [EBP]
00531ee1 : CMP EBP,ESI
00531ee3 : JZ 0x00531ef1
00531ee5 : LEA ECX,[ESP + 0x38]
00531ee9 : PUSH ECX
00531eea : MOV ECX,EBP
00531eec : CALL 0x005266c0
00531ef1 : CMP EDI,ESI
00531ef3 : JZ 0x00531efc
00531ef5 : MOV ECX,EDI
00531ef7 : CALL 0x00503db0
00531efc : LEA ECX,[ESP + 0x38]
00531f00 : CALL 0x00526bc0
00531f05 : TEST byte ptr [ESP + 0x34],0x2
00531f0a : JNZ 0x00531f19
00531f0c : MOV ECX,dword ptr [ESP + 0x2c]
00531f10 : CMP ECX,ESI
00531f12 : JZ 0x00531f19
00531f14 : CALL 0x00503db0
00531f19 : TEST byte ptr [ESP + 0x34],0x1
00531f1e : MOV dword ptr [ESP + 0x2c],ESI
00531f22 : JNZ 0x00531f31
00531f24 : MOV ECX,dword ptr [ESP + 0x30]
00531f28 : CMP ECX,ESI
00531f2a : JZ 0x00531f31
00531f2c : CALL 0x00503db0
00531f31 : MOV EAX,dword ptr [ESP + 0x10]
00531f35 : MOV dword ptr [ESP + 0x30],ESI
00531f39 : DEC dword ptr [EAX + 0x8]
00531f3c : MOV ECX,EAX
00531f3e : ADD EAX,0x8
00531f41 : CMP dword ptr [EAX],ESI
00531f43 : POP EDI
00531f44 : POP ESI
00531f45 : JNZ 0x00531f4c
00531f47 : CALL 0x00525340
00531f4c : MOV ECX,EBX
00531f4e : CALL 0x00503db0
00531f53 : POP EBP
00531f54 : POP EBX
00531f55 : ADD ESP,0x38
00531f58 : RET 0x4

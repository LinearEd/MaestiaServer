PROGRAM  : Maestia.exe
FUNCTION : FUN_006b96a0
ENTRY    : 006b96a0
BODY     : [[006b96a0, 006b977d]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006b96a0(int param_1)

{
  undefined2 *puVar1;
  undefined2 uVar2;
  undefined4 uVar3;
  int iVar4;
  uint in_ECX;
  int unaff_ESI;
  undefined2 *puVar5;
  
  iVar4 = param_1;
  uVar3 = *(undefined4 *)(param_1 + 0x1c);
  param_1 = (**(code **)(unaff_ESI + 0x1fc))();
  if (param_1 != 0) {
    *(undefined4 *)(unaff_ESI + 0x29c) = 0;
    *(undefined4 *)(unaff_ESI + 0x2a0) = 0;
    return 0;
  }
  *(uint *)(unaff_ESI + 0x29c) = in_ECX >> 1;
  uVar3 = FUN_0068a220(uVar3,2,0,in_ECX >> 1,0,&param_1);
  *(undefined4 *)(unaff_ESI + 0x2a0) = uVar3;
  if ((param_1 == 0) &&
     (param_1 = FUN_00688900(iVar4,*(int *)(unaff_ESI + 0x29c) * 2), param_1 == 0)) {
    puVar5 = *(undefined2 **)(unaff_ESI + 0x2a0);
    puVar1 = puVar5 + *(int *)(unaff_ESI + 0x29c);
    for (; puVar5 < puVar1; puVar5 = puVar5 + 1) {
      uVar2 = FUN_00687940(iVar4);
      *puVar5 = uVar2;
    }
    FUN_006889b0(iVar4);
    if (*(char *)(unaff_ESI + 0x2c8) != '\0') {
      iVar4 = FUN_006b8c90();
      return iVar4;
    }
  }
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
006b96a0 : PUSH ECX
006b96a1 : MOV ECX,dword ptr [ESI + 0x1fc]
006b96a7 : PUSH EBX
006b96a8 : PUSH EBP
006b96a9 : MOV EBP,dword ptr [ESP + 0x10]
006b96ad : PUSH EDI
006b96ae : MOV EDI,dword ptr [EBP + 0x1c]
006b96b1 : LEA EAX,[ESP + 0xc]
006b96b5 : PUSH EAX
006b96b6 : PUSH EBP
006b96b7 : PUSH 0x63767420
006b96bc : PUSH ESI
006b96bd : CALL ECX
006b96bf : XOR EBX,EBX
006b96c1 : ADD ESP,0x10
006b96c4 : MOV dword ptr [ESP + 0x14],EAX
006b96c8 : CMP EAX,EBX
006b96ca : JZ 0x006b96df
006b96cc : POP EDI
006b96cd : POP EBP
006b96ce : MOV dword ptr [ESI + 0x29c],EBX
006b96d4 : MOV dword ptr [ESI + 0x2a0],EBX
006b96da : XOR EAX,EAX
006b96dc : POP EBX
006b96dd : POP ECX
006b96de : RET
006b96df : MOV EAX,dword ptr [ESP + 0xc]
006b96e3 : LEA EDX,[ESP + 0x14]
006b96e7 : PUSH EDX
006b96e8 : PUSH EBX
006b96e9 : SHR EAX,0x1
006b96eb : PUSH EAX
006b96ec : PUSH EBX
006b96ed : PUSH 0x2
006b96ef : PUSH EDI
006b96f0 : MOV dword ptr [ESI + 0x29c],EAX
006b96f6 : CALL 0x0068a220
006b96fb : MOV dword ptr [ESI + 0x2a0],EAX
006b9701 : MOV EAX,dword ptr [ESP + 0x2c]
006b9705 : ADD ESP,0x18
006b9708 : CMP EAX,EBX
006b970a : JNZ 0x006b9779
006b970c : MOV EAX,dword ptr [ESI + 0x29c]
006b9712 : ADD EAX,EAX
006b9714 : PUSH EAX
006b9715 : PUSH EBP
006b9716 : CALL 0x00688900
006b971b : ADD ESP,0x8
006b971e : MOV dword ptr [ESP + 0x14],EAX
006b9722 : CMP EAX,EBX
006b9724 : JNZ 0x006b9779
006b9726 : MOV EDI,dword ptr [ESI + 0x2a0]
006b972c : MOV ECX,dword ptr [ESI + 0x29c]
006b9732 : LEA EBX,[EDI + ECX*0x2]
006b9735 : CMP EDI,EBX
006b9737 : JNC 0x006b9753
006b9739 : LEA ESP,[ESP]
006b9740 : PUSH EBP
006b9741 : CALL 0x00687940
006b9746 : MOV word ptr [EDI],AX
006b9749 : ADD EDI,0x2
006b974c : ADD ESP,0x4
006b974f : CMP EDI,EBX
006b9751 : JC 0x006b9740
006b9753 : PUSH EBP
006b9754 : CALL 0x006889b0
006b9759 : ADD ESP,0x4
006b975c : CMP byte ptr [ESI + 0x2c8],0x0
006b9763 : JZ 0x006b9775
006b9765 : PUSH ESI
006b9766 : MOV EAX,EBP
006b9768 : CALL 0x006b8c90
006b976d : ADD ESP,0x4
006b9770 : POP EDI
006b9771 : POP EBP
006b9772 : POP EBX
006b9773 : POP ECX
006b9774 : RET
006b9775 : MOV EAX,dword ptr [ESP + 0x14]
006b9779 : POP EDI
006b977a : POP EBP
006b977b : POP EBX
006b977c : POP ECX
006b977d : RET

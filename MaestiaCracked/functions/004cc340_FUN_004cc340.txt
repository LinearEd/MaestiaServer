PROGRAM  : Maestia.exe
FUNCTION : FUN_004cc340
ENTRY    : 004cc340
BODY     : [[004cc340, 004cc4c1]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_004cc340(float param_1,float *param_2)

{
  int iVar1;
  float *pfVar2;
  float fVar3;
  int in_EAX;
  float *pfVar4;
  float *pfVar5;
  int in_ECX;
  float *pfVar6;
  int local_c;
  
  if (in_EAX == 0) {
    in_EAX = in_ECX + 0x54;
  }
  if (*(int *)(in_ECX + 100) != in_EAX) {
    if ((uint)((*(int *)(in_EAX + 8) - *(int *)(in_EAX + 4)) / 0xc) < 2) {
      *(undefined4 *)(in_ECX + 100) = 0;
      return 1;
    }
    *(int *)(in_ECX + 100) = in_EAX;
    *(undefined4 *)(in_ECX + 0x6c) = *(undefined4 *)(*(int *)(in_EAX + 8) + -0xc);
    *(undefined4 *)(in_ECX + 0x70) = 0;
  }
  iVar1 = *(int *)(in_ECX + 100);
  param_1 = *(float *)(in_ECX + 0x68) + param_1;
  *(float *)(in_ECX + 0x68) = param_1;
  if (*(int *)(in_ECX + 0x70) + 1U < (uint)((*(int *)(iVar1 + 8) - *(int *)(iVar1 + 4)) / 0xc)) {
    pfVar2 = *(float **)(iVar1 + 8);
    pfVar6 = (float *)(*(int *)(iVar1 + 4) + *(int *)(in_ECX + 0x70) * 0xc);
    pfVar5 = pfVar6 + 3;
    pfVar4 = pfVar5;
    if (pfVar6[3] <= param_1 && param_1 != pfVar6[3]) {
      do {
        *(int *)(in_ECX + 0x70) = *(int *)(in_ECX + 0x70) + 1;
        pfVar5 = pfVar4 + 3;
        pfVar6 = pfVar4;
        if (pfVar5 == pfVar2) {
          if (*(char *)(in_ECX + 0x11) == '\0') {
            *(undefined4 *)(in_ECX + 0x70) = 0;
            *(undefined4 *)(in_ECX + 0x68) = 0;
            *param_2 = pfVar4[2];
            return 4;
          }
          local_c = (int)(longlong)ROUND(*(float *)(in_ECX + 0x68) / *(float *)(in_ECX + 0x6c));
          fVar3 = (float)local_c;
          if (local_c < 0) {
            fVar3 = fVar3 + 4.2949673e+09;
          }
          *(float *)(in_ECX + 0x68) = *(float *)(in_ECX + 0x68) - fVar3 * *(float *)(in_ECX + 0x6c);
          pfVar6 = *(float **)(iVar1 + 4);
          pfVar5 = pfVar6 + 3;
          *(undefined4 *)(in_ECX + 0x70) = 0;
        }
        pfVar4 = pfVar5;
      } while (*pfVar5 <= *(float *)(in_ECX + 0x68) && *(float *)(in_ECX + 0x68) != *pfVar5);
    }
    *param_2 = ((*(float *)(in_ECX + 0x68) - *pfVar6) / (*pfVar5 - *pfVar6)) *
               (pfVar5[2] - pfVar6[2]) + pfVar6[2];
    return 2;
  }
  *(undefined4 *)(in_ECX + 100) = 0;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
004cc340 : PUSH EBP
004cc341 : MOV EBP,ESP
004cc343 : SUB ESP,0x8
004cc346 : PUSH EBX
004cc347 : PUSH ESI
004cc348 : MOV ESI,EAX
004cc34a : XOR EBX,EBX
004cc34c : CMP ESI,EBX
004cc34e : JNZ 0x004cc353
004cc350 : LEA ESI,[ECX + 0x54]
004cc353 : CMP dword ptr [ECX + 0x64],ESI
004cc356 : JZ 0x004cc395
004cc358 : MOV EDX,dword ptr [ESI + 0x8]
004cc35b : SUB EDX,dword ptr [ESI + 0x4]
004cc35e : MOV EAX,0x2aaaaaab
004cc363 : IMUL EDX
004cc365 : SAR EDX,0x1
004cc367 : MOV EAX,EDX
004cc369 : SHR EAX,0x1f
004cc36c : ADD EAX,EDX
004cc36e : CMP EAX,0x2
004cc371 : JNC 0x004cc383
004cc373 : POP ESI
004cc374 : MOV dword ptr [ECX + 0x64],EBX
004cc377 : MOV EAX,0x1
004cc37c : POP EBX
004cc37d : MOV ESP,EBP
004cc37f : POP EBP
004cc380 : RET 0x8
004cc383 : MOV dword ptr [ECX + 0x64],ESI
004cc386 : MOV ESI,dword ptr [ESI + 0x8]
004cc389 : FLD float ptr [ESI + -0xc]
004cc38c : SUB ESI,0xc
004cc38f : FSTP float ptr [ECX + 0x6c]
004cc392 : MOV dword ptr [ECX + 0x70],EBX
004cc395 : MOVSS XMM0,dword ptr [ECX + 0x68]
004cc39a : MOV ESI,dword ptr [ECX + 0x64]
004cc39d : ADDSS XMM0,dword ptr [EBP + 0x8]
004cc3a2 : MOVSS dword ptr [ECX + 0x68],XMM0
004cc3a7 : MOV EDX,dword ptr [ESI + 0x8]
004cc3aa : SUB EDX,dword ptr [ESI + 0x4]
004cc3ad : MOV EAX,0x2aaaaaab
004cc3b2 : IMUL EDX
004cc3b4 : SAR EDX,0x1
004cc3b6 : MOV EAX,EDX
004cc3b8 : SHR EAX,0x1f
004cc3bb : PUSH EDI
004cc3bc : MOV EDI,dword ptr [ECX + 0x70]
004cc3bf : ADD EAX,EDX
004cc3c1 : LEA EDX,[EDI + 0x1]
004cc3c4 : CMP EAX,EDX
004cc3c6 : JA 0x004cc3d9
004cc3c8 : POP EDI
004cc3c9 : POP ESI
004cc3ca : MOV dword ptr [ECX + 0x64],EBX
004cc3cd : MOV EAX,0x1
004cc3d2 : POP EBX
004cc3d3 : MOV ESP,EBP
004cc3d5 : POP EBP
004cc3d6 : RET 0x8
004cc3d9 : MOV EDX,dword ptr [ESI + 0x4]
004cc3dc : LEA EAX,[EDI + EDI*0x2]
004cc3df : MOV EDI,dword ptr [ESI + 0x8]
004cc3e2 : LEA EDX,[EDX + EAX*0x4]
004cc3e5 : COMISS XMM0,dword ptr [EDX + 0xc]
004cc3e9 : LEA EAX,[EDX + 0xc]
004cc3ec : JBE 0x004cc459
004cc3ee : MOV EBX,0x1
004cc3f3 : ADD dword ptr [ECX + 0x70],EBX
004cc3f6 : MOV EDX,EAX
004cc3f8 : ADD EAX,0xc
004cc3fb : CMP EAX,EDI
004cc3fd : JNZ 0x004cc44f
004cc3ff : CMP byte ptr [ECX + 0x11],0x0
004cc403 : JZ 0x004cc49d
004cc409 : FLD float ptr [ECX + 0x6c]
004cc40c : FLD float ptr [ECX + 0x68]
004cc40f : FLD ST0
004cc411 : FDIV ST0,ST2
004cc413 : FNSTCW word ptr [EBP + 0xa]
004cc416 : MOVZX EAX,word ptr [EBP + 0xa]
004cc41a : OR EAX,0xc00
004cc41f : MOV dword ptr [EBP + -0x4],EAX
004cc422 : FLDCW word ptr [EBP + -0x4]
004cc425 : FISTP qword ptr [EBP + -0x8]
004cc428 : MOV EAX,dword ptr [EBP + -0x8]
004cc42b : FLDCW word ptr [EBP + 0xa]
004cc42e : FILD dword ptr [EBP + -0x8]
004cc431 : TEST EAX,EAX
004cc433 : JGE 0x004cc43b
004cc435 : FADD float ptr [0x00cdf0e0]
004cc43b : FMULP ST2
004cc43d : FSUBRP
004cc43f : FSTP float ptr [ECX + 0x68]
004cc442 : MOV EDX,dword ptr [ESI + 0x4]
004cc445 : LEA EAX,[EDX + 0xc]
004cc448 : MOV dword ptr [ECX + 0x70],0x0
004cc44f : MOVSS XMM0,dword ptr [ECX + 0x68]
004cc454 : COMISS XMM0,dword ptr [EAX]
004cc457 : JA 0x004cc3f3
004cc459 : MOVSS XMM0,dword ptr [EDX]
004cc45d : MOVSS XMM3,dword ptr [EAX]
004cc461 : MOVSS XMM1,dword ptr [EDX + 0x8]
004cc466 : MOVSS XMM2,dword ptr [ECX + 0x68]
004cc46b : MOV EDX,dword ptr [EBP + 0xc]
004cc46e : SUBSS XMM2,XMM0
004cc472 : SUBSS XMM3,XMM0
004cc476 : MOVSS XMM0,dword ptr [EAX + 0x8]
004cc47b : POP EDI
004cc47c : DIVSS XMM2,XMM3
004cc480 : SUBSS XMM0,XMM1
004cc484 : MULSS XMM2,XMM0
004cc488 : POP ESI
004cc489 : ADDSS XMM2,XMM1
004cc48d : MOVSS dword ptr [EDX],XMM2
004cc491 : MOV EAX,0x2
004cc496 : POP EBX
004cc497 : MOV ESP,EBP
004cc499 : POP EBP
004cc49a : RET 0x8
004cc49d : XORPS XMM0,XMM0
004cc4a0 : MOV dword ptr [ECX + 0x70],0x0
004cc4a7 : MOVSS dword ptr [ECX + 0x68],XMM0
004cc4ac : FLD float ptr [EDX + 0x8]
004cc4af : MOV ECX,dword ptr [EBP + 0xc]
004cc4b2 : POP EDI
004cc4b3 : FSTP float ptr [ECX]
004cc4b5 : POP ESI
004cc4b6 : MOV EAX,0x4
004cc4bb : POP EBX
004cc4bc : MOV ESP,EBP
004cc4be : POP EBP
004cc4bf : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_008612e0
ENTRY    : 008612e0
BODY     : [[008612e0, 00861611]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008612e0(int param_1)

{
  int iVar1;
  int *piVar2;
  float fVar3;
  bool bVar4;
  float *pfVar5;
  DWORD DVar6;
  int *in_ECX;
  undefined4 uVar7;
  float *pfStack_c8;
  undefined4 uStack_c4;
  float **ppfStack_c0;
  float **ppfStack_bc;
  float *pfStack_b8;
  undefined4 *puStack_b4;
  undefined4 uStack_b0;
  undefined4 *puStack_ac;
  float *pfStack_a8;
  float *pfStack_a4;
  float local_80;
  float local_7c;
  float local_78;
  undefined4 local_74;
  undefined4 local_70;
  undefined4 local_6c;
  undefined4 local_68;
  undefined4 local_64;
  undefined4 local_60;
  undefined4 local_5c;
  float *local_58;
  undefined4 local_54;
  int local_50;
  undefined4 local_4c;
  undefined4 local_48 [17];
  
  bVar4 = false;
  if (((param_1 == 0xe1) || (param_1 == 0x87)) || (param_1 == 0xb4)) {
    bVar4 = true;
  }
  iVar1 = in_ECX[0xfa];
  local_60 = *(undefined4 *)(iVar1 + 0x6c);
  local_5c = *(undefined4 *)(iVar1 + 0x70);
  local_64 = *(undefined4 *)(iVar1 + 0x68);
  if (*(int *)(DAT_017248cc + 0x20) == 0) {
    piVar2 = *(int **)(DAT_0172491c + 0x94);
    local_80 = 0.0;
    local_7c = 0.0;
    local_78 = 0.0;
    pfStack_a4 = (float *)0x861385;
    pfVar5 = (float *)(**(code **)(*piVar2 + 0x14))();
    local_80 = (float)piVar2[0x5c] - *pfVar5;
    local_7c = (float)piVar2[0x5d] - pfVar5[1];
    local_78 = (float)piVar2[0x5e] - pfVar5[2];
    pfStack_a8 = &local_80;
    puStack_ac = (undefined4 *)0x8613ca;
    pfStack_a4 = pfStack_a8;
    D3DXVec3Normalize();
    in_ECX[0xee] = (int)local_80;
    in_ECX[0xef] = (int)local_78;
  }
  pfVar5 = (float *)in_ECX[0xee];
  local_50 = in_ECX[0xef];
  local_48[0] = 0;
  local_74 = 0;
  local_70 = 0;
  local_6c = 0;
  local_68 = 0;
  local_54 = 0;
  local_4c = 0x3f800000;
  if (bVar4) {
    param_1 = param_1 + 0xb4;
  }
  local_80 = 0.0;
  local_78 = 0.0;
  pfStack_a4 = (float *)((float)param_1 * 0.017453292);
  pfStack_a8 = &local_80;
  puStack_ac = local_48;
  local_7c = 1.0;
  uStack_b0 = (undefined4 *)0x861487;
  local_58 = pfVar5;
  D3DXMatrixRotationAxis();
  uStack_b0 = &local_54;
  puStack_b4 = &local_64;
  pfStack_b8 = &local_80;
  ppfStack_bc = (float **)0x86149b;
  D3DXVec4Transform();
  ppfStack_c0 = &pfStack_a4;
  uStack_c4 = 0x8614c0;
  ppfStack_bc = ppfStack_c0;
  pfStack_a4 = pfVar5;
  D3DXVec2Normalize();
  if (*(char *)(DAT_00da93ec + 0x264) == '\0') {
    uStack_c4 = 0x8614ff;
    FUN_007cc680();
  }
  else {
    uStack_c4 = 0;
    pfStack_c8 = pfStack_a8;
    (**(code **)(*in_ECX + 0x2b0))(puStack_ac);
  }
  iVar1 = in_ECX[0x11f];
  uStack_c4 = 0x86150b;
  DVar6 = timeGetTime();
  in_ECX[0x11f] = DVar6;
  if ((float)in_ECX[0x11c] <= 1e-05) {
    in_ECX[0x11c] = in_ECX[0x11b];
  }
  fVar3 = (float)(int)(DVar6 - iVar1);
  if ((int)(DVar6 - iVar1) < 0) {
    fVar3 = fVar3 + 4.2949673e+09;
  }
  pfStack_a4 = (float *)(fVar3 * (float)in_ECX[0x11c]);
  if (30.0 < (float)pfStack_a4) {
    pfStack_a4 = (float *)0x41f00000;
  }
  uStack_c4 = 0x3f800000;
  pfStack_c8 = (float *)0x0;
  if (uStack_b0._3_1_ == '\0') {
    (**(code **)(*in_ECX + 0x188))(7,1,0,0);
    uVar7 = 7;
  }
  else {
    pfStack_a4 = (float *)((float)pfStack_a4 * DAT_00d72c24);
    puStack_ac = (undefined4 *)((uint)puStack_ac ^ 0x80000000);
    pfStack_a8 = (float *)((uint)pfStack_a8 ^ 0x80000000);
    (**(code **)(*in_ECX + 0x188))(8,1,0,0);
    uVar7 = 8;
  }
  (**(code **)(*in_ECX + 0x19c))(uVar7);
  FUN_0085f410(in_ECX,ppfStack_c0,&pfStack_c8);
  iVar1 = DAT_00da93ec;
  *(undefined1 *)(in_ECX + 0x7ae) = 0;
  *(undefined2 *)(iVar1 + 0x770) = 0;
  return;
}



============================================================
DISASSEMBLY
============================================================
008612e0 : PUSH EBP
008612e1 : MOV EBP,ESP
008612e3 : AND ESP,0xfffffff8
008612e6 : SUB ESP,0x8c
008612ec : PUSH EBX
008612ed : MOV EBX,dword ptr [EBP + 0x8]
008612f0 : PUSH ESI
008612f1 : PUSH EDI
008612f2 : MOV EDI,ECX
008612f4 : MOV byte ptr [ESP + 0x13],0x0
008612f9 : CMP EBX,0xe1
008612ff : JZ 0x00861311
00861301 : CMP EBX,0x87
00861307 : JZ 0x00861311
00861309 : CMP EBX,0xb4
0086130f : JNZ 0x00861316
00861311 : MOV byte ptr [ESP + 0x13],0x1
00861316 : MOV EAX,dword ptr [EDI + 0x3e8]
0086131c : MOVSS XMM0,dword ptr [EAX + 0x6c]
00861321 : MOVSS XMM1,dword ptr [EAX + 0x70]
00861326 : MOVSS XMM2,dword ptr [EAX + 0x68]
0086132b : ADD EAX,0x68
0086132e : MOV EAX,[0x017248cc]
00861333 : CMP dword ptr [EAX + 0x20],0x0
00861337 : MOVSS dword ptr [ESP + 0x40],XMM0
0086133d : XORPS XMM0,XMM0
00861340 : MOVSS dword ptr [ESP + 0x3c],XMM2
00861346 : MOVSS dword ptr [ESP + 0x44],XMM1
0086134c : MOVSS dword ptr [ESP + 0x14],XMM0
00861352 : MOVSS dword ptr [ESP + 0x18],XMM0
00861358 : JNZ 0x008613e9
0086135e : MOV ECX,dword ptr [0x0172491c]
00861364 : MOV ESI,dword ptr [ECX + 0x94]
0086136a : MOVSS dword ptr [ESP + 0x20],XMM0
00861370 : MOVSS dword ptr [ESP + 0x24],XMM0
00861376 : MOVSS dword ptr [ESP + 0x28],XMM0
0086137c : MOV EDX,dword ptr [ESI]
0086137e : MOV EAX,dword ptr [EDX + 0x14]
00861381 : MOV ECX,ESI
00861383 : CALL EAX
00861385 : MOVSS XMM0,dword ptr [ESI + 0x170]
0086138d : MOVSS XMM1,dword ptr [ESI + 0x174]
00861395 : MOVSS XMM2,dword ptr [ESI + 0x178]
0086139d : SUBSS XMM0,dword ptr [EAX]
008613a1 : SUBSS XMM1,dword ptr [EAX + 0x4]
008613a6 : SUBSS XMM2,dword ptr [EAX + 0x8]
008613ab : LEA ECX,[ESP + 0x20]
008613af : PUSH ECX
008613b0 : MOV EDX,ECX
008613b2 : PUSH EDX
008613b3 : MOVSS dword ptr [ESP + 0x28],XMM0
008613b9 : MOVSS dword ptr [ESP + 0x2c],XMM1
008613bf : MOVSS dword ptr [ESP + 0x30],XMM2
008613c5 : CALL 0x004ff722
008613ca : MOVSS XMM0,dword ptr [ESP + 0x20]
008613d0 : MOVSS dword ptr [EDI + 0x3b8],XMM0
008613d8 : MOVSS XMM0,dword ptr [ESP + 0x28]
008613de : MOVSS dword ptr [EDI + 0x3bc],XMM0
008613e6 : XORPS XMM0,XMM0
008613e9 : CMP byte ptr [ESP + 0x13],0x0
008613ee : MOV EAX,dword ptr [EDI + 0x3b8]
008613f4 : MOV ECX,dword ptr [EDI + 0x3bc]
008613fa : MOV dword ptr [ESP + 0x14],EAX
008613fe : MOVSS XMM1,dword ptr [ESP + 0x14]
00861404 : MOVSS dword ptr [ESP + 0x48],XMM1
0086140a : MOV dword ptr [ESP + 0x18],ECX
0086140e : MOVSS XMM1,dword ptr [ESP + 0x18]
00861414 : MOVSS dword ptr [ESP + 0x50],XMM1
0086141a : MOVSS XMM1,dword ptr [0x00c10fc4]
00861422 : MOVSS dword ptr [ESP + 0x58],XMM0
00861428 : MOVSS dword ptr [ESP + 0x2c],XMM0
0086142e : MOVSS dword ptr [ESP + 0x30],XMM0
00861434 : MOVSS dword ptr [ESP + 0x34],XMM0
0086143a : MOVSS dword ptr [ESP + 0x38],XMM0
00861440 : MOVSS dword ptr [ESP + 0x4c],XMM0
00861446 : MOVSS dword ptr [ESP + 0x54],XMM1
0086144c : JZ 0x00861454
0086144e : ADD EBX,0xb4
00861454 : MOVSS dword ptr [ESP + 0x20],XMM0
0086145a : MOVSS dword ptr [ESP + 0x28],XMM0
00861460 : PUSH ECX
00861461 : CVTSI2SS XMM0,EBX
00861465 : MULSS XMM0,dword ptr [0x00cdf170]
0086146d : MOVSS dword ptr [ESP],XMM0
00861472 : LEA EDX,[ESP + 0x24]
00861476 : PUSH EDX
00861477 : LEA EAX,[ESP + 0x60]
0086147b : PUSH EAX
0086147c : MOVSS dword ptr [ESP + 0x30],XMM1
00861482 : CALL 0x004ff746
00861487 : LEA ECX,[ESP + 0x58]
0086148b : PUSH ECX
0086148c : LEA EDX,[ESP + 0x4c]
00861490 : PUSH EDX
00861491 : LEA EAX,[ESP + 0x34]
00861495 : PUSH EAX
00861496 : CALL 0x004ff74c
0086149b : MOVSS XMM0,dword ptr [ESP + 0x2c]
008614a1 : LEA ECX,[ESP + 0x14]
008614a5 : PUSH ECX
008614a6 : MOV EDX,ECX
008614a8 : MOVSS dword ptr [ESP + 0x18],XMM0
008614ae : MOVSS XMM0,dword ptr [ESP + 0x38]
008614b4 : PUSH EDX
008614b5 : MOVSS dword ptr [ESP + 0x20],XMM0
008614bb : CALL 0x004ff71c
008614c0 : MOV EAX,[0x00da93ec]
008614c5 : CMP byte ptr [EAX + 0x264],0x0
008614cc : JZ 0x008614f0
008614ce : FLD float ptr [ESP + 0x18]
008614d2 : MOV EDX,dword ptr [EDI]
008614d4 : MOV EAX,dword ptr [EDX + 0x2b0]
008614da : PUSH 0x0
008614dc : SUB ESP,0x8
008614df : FSTP float ptr [ESP + 0x4]
008614e3 : MOV ECX,EDI
008614e5 : FLD float ptr [ESP + 0x20]
008614e9 : FSTP float ptr [ESP]
008614ec : CALL EAX
008614ee : JMP 0x008614ff
008614f0 : MOV ESI,dword ptr [EDI + 0x3e8]
008614f6 : LEA EAX,[ESP + 0x14]
008614fa : CALL 0x007cc680
008614ff : MOV ESI,dword ptr [EDI + 0x47c]
00861505 : CALL dword ptr [0x00b85598]
0086150b : MOVSS XMM0,dword ptr [0x00cdf32c]
00861513 : COMISS XMM0,dword ptr [EDI + 0x470]
0086151a : MOV dword ptr [EDI + 0x47c],EAX
00861520 : JC 0x0086152e
00861522 : FLD float ptr [EDI + 0x46c]
00861528 : FSTP float ptr [EDI + 0x470]
0086152e : SUB EAX,ESI
00861530 : MOV dword ptr [ESP + 0x1c],EAX
00861534 : FILD dword ptr [ESP + 0x1c]
00861538 : TEST EAX,EAX
0086153a : JGE 0x00861542
0086153c : FADD float ptr [0x00cdf0e0]
00861542 : FMUL float ptr [EDI + 0x470]
00861548 : FST float ptr [ESP + 0x1c]
0086154c : FLD float ptr [0x00cdf12c]
00861552 : FXCH
00861554 : FCOMIP ST0,ST1
00861556 : FSTP ST0
00861558 : JBE 0x0086156a
0086155a : MOVSS XMM0,dword ptr [0x00cdf12c]
00861562 : MOVSS dword ptr [ESP + 0x1c],XMM0
00861568 : JMP 0x00861570
0086156a : MOVSS XMM0,dword ptr [ESP + 0x1c]
00861570 : CMP byte ptr [ESP + 0x13],0x0
00861575 : FLD1
00861577 : MOV EDX,dword ptr [EDI]
00861579 : MOV EAX,dword ptr [EDX + 0x188]
0086157f : PUSH ECX
00861580 : FSTP float ptr [ESP]
00861583 : PUSH 0x0
00861585 : PUSH 0x0
00861587 : PUSH 0x0
00861589 : MOV ECX,EDI
0086158b : PUSH 0x1
0086158d : JZ 0x008615cb
0086158f : MOVSS XMM2,dword ptr [ESP + 0x28]
00861595 : MOVSS XMM1,dword ptr [0x00cdf0c0]
0086159d : MULSS XMM0,dword ptr [0x00d72c24]
008615a5 : XORPS XMM2,XMM1
008615a8 : MOVSS dword ptr [ESP + 0x28],XMM2
008615ae : MOVSS XMM2,dword ptr [ESP + 0x2c]
008615b4 : XORPS XMM2,XMM1
008615b7 : PUSH 0x8
008615b9 : MOVSS dword ptr [ESP + 0x30],XMM2
008615bf : MOVSS dword ptr [ESP + 0x34],XMM0
008615c5 : CALL EAX
008615c7 : PUSH 0x8
008615c9 : JMP 0x008615d1
008615cb : PUSH 0x7
008615cd : CALL EAX
008615cf : PUSH 0x7
008615d1 : MOV EDX,dword ptr [EDI]
008615d3 : MOV EAX,dword ptr [EDX + 0x19c]
008615d9 : MOV ECX,EDI
008615db : CALL EAX
008615dd : FLD float ptr [ESP + 0x1c]
008615e1 : LEA ECX,[ESP + 0x14]
008615e5 : PUSH ECX
008615e6 : PUSH ECX
008615e7 : FSTP float ptr [ESP]
008615ea : PUSH EDI
008615eb : LEA EAX,[ESP + 0x48]
008615ef : CALL 0x0085f410
008615f4 : MOV EAX,[0x00da93ec]
008615f9 : MOV byte ptr [EDI + 0x1eb8],0x0
00861600 : POP EDI
00861601 : XOR EDX,EDX
00861603 : POP ESI
00861604 : MOV word ptr [EAX + 0x770],DX
0086160b : POP EBX
0086160c : MOV ESP,EBP
0086160e : POP EBP
0086160f : RET 0x4

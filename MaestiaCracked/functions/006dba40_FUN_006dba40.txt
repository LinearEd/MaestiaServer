PROGRAM  : Maestia.exe
FUNCTION : FUN_006dba40
ENTRY    : 006dba40
BODY     : [[006dba40, 006dbaec] [006dbaf0, 006dbc7b]]

============================================================
DECOMPILED C CODE
============================================================

undefined1 FUN_006dba40(int param_1,int *param_2)

{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  int iVar4;
  int iVar5;
  char cVar6;
  uint uVar7;
  int iVar8;
  undefined4 uVar9;
  uint uVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  undefined4 local_14;
  undefined4 local_10;
  int local_c;
  int local_8;
  int local_4;
  
  iVar1 = *(int *)(param_1 + 0x198);
  iVar2 = *(int *)(param_1 + 0x170);
  uVar3 = *(undefined4 *)(param_1 + 0x178);
  if (((*(int *)(param_1 + 0xfc) != 0) && (*(int *)(iVar1 + 0x28) == 0)) &&
     (cVar6 = FUN_006db780(), cVar6 == '\0')) {
    return 0;
  }
  if (*(char *)(iVar1 + 8) == '\0') {
    if (*(int *)(iVar1 + 0x14) != 0) {
      *(int *)(iVar1 + 0x28) = *(int *)(iVar1 + 0x28) + -1;
      *(int *)(iVar1 + 0x14) = *(int *)(iVar1 + 0x14) + -1;
      return 1;
    }
    local_14 = **(undefined4 **)(param_1 + 0x18);
    local_10 = (*(undefined4 **)(param_1 + 0x18))[1];
    iVar4 = *param_2;
    iVar13 = *(int *)(iVar1 + 0xc);
    iVar8 = *(int *)(iVar1 + 0x10);
    iVar5 = *(int *)(iVar1 + 0x3c);
    iVar14 = 0;
    local_4 = param_1;
    for (iVar12 = *(int *)(param_1 + 0x16c); iVar12 <= iVar2; iVar12 = iVar12 + 1) {
      if (iVar8 < 8) {
        cVar6 = FUN_006daf40(&local_14,iVar13,iVar8,0);
        if (cVar6 == '\0') {
          return 0;
        }
        iVar8 = local_8;
        iVar13 = local_c;
        if (7 < local_8) goto LAB_006dbb26;
        uVar9 = 1;
LAB_006dbb53:
        uVar7 = FUN_006db060(&local_14,iVar13,iVar8,iVar5,uVar9);
        iVar8 = local_8;
        iVar13 = local_c;
        if ((int)uVar7 < 0) {
          return 0;
        }
      }
      else {
LAB_006dbb26:
        uVar7 = iVar13 >> ((char)iVar8 - 8U & 0x1f) & 0xff;
        iVar11 = *(int *)(iVar5 + 0x90 + uVar7 * 4);
        if (iVar11 == 0) {
          uVar9 = 9;
          goto LAB_006dbb53;
        }
        uVar7 = (uint)*(byte *)(uVar7 + 0x490 + iVar5);
        iVar8 = iVar8 - iVar11;
      }
      iVar11 = (int)uVar7 >> 4;
      uVar7 = uVar7 & 0xf;
      if (uVar7 == 0) {
        if (iVar11 != 0xf) {
          iVar14 = 1 << ((byte)iVar11 & 0x1f);
          if (iVar11 != 0) {
            if ((iVar8 < iVar11) &&
               (cVar6 = FUN_006daf40(&local_14,iVar13,iVar8,iVar11), iVar8 = local_8,
               iVar13 = local_c, cVar6 == '\0')) {
              return 0;
            }
            iVar8 = iVar8 - iVar11;
            iVar14 = iVar14 + (iVar13 >> ((byte)iVar8 & 0x1f) & iVar14 - 1U);
          }
          iVar14 = iVar14 + -1;
          break;
        }
        iVar12 = iVar12 + 0xf;
      }
      else {
        iVar12 = iVar12 + iVar11;
        if ((iVar8 < (int)uVar7) &&
           (cVar6 = FUN_006daf40(&local_14,iVar13,iVar8,uVar7), iVar8 = local_8, iVar13 = local_c,
           cVar6 == '\0')) {
          return 0;
        }
        iVar8 = iVar8 - uVar7;
        uVar10 = (1 << (sbyte)uVar7) - 1U & iVar13 >> ((byte)iVar8 & 0x1f);
        if ((int)uVar10 < *(int *)(&DAT_00bf1730 + uVar7 * 4)) {
          uVar10 = *(int *)(&DAT_00bf1770 + uVar7 * 4) + uVar10;
        }
        *(short *)(iVar4 + (&DAT_00bf1570)[iVar12] * 2) = (short)(uVar10 << ((byte)uVar3 & 0x1f));
      }
    }
    **(undefined4 **)(param_1 + 0x18) = local_14;
    *(undefined4 *)(*(int *)(param_1 + 0x18) + 4) = local_10;
    *(int *)(iVar1 + 0xc) = iVar13;
    *(int *)(iVar1 + 0x10) = iVar8;
    *(int *)(iVar1 + 0x14) = iVar14;
  }
  *(int *)(iVar1 + 0x28) = *(int *)(iVar1 + 0x28) + -1;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
006dba40 : SUB ESP,0x2c
006dba43 : PUSH EBX
006dba44 : PUSH ESI
006dba45 : PUSH EDI
006dba46 : MOV EDI,dword ptr [ESP + 0x3c]
006dba4a : CMP dword ptr [EDI + 0xfc],0x0
006dba51 : MOV EBX,dword ptr [EDI + 0x198]
006dba57 : MOV EAX,dword ptr [EDI + 0x170]
006dba5d : MOV ECX,dword ptr [EDI + 0x178]
006dba63 : MOV dword ptr [ESP + 0x18],EBX
006dba67 : MOV dword ptr [ESP + 0x14],EAX
006dba6b : MOV dword ptr [ESP + 0x1c],ECX
006dba6f : JZ 0x006dba89
006dba71 : CMP dword ptr [EBX + 0x28],0x0
006dba75 : JNZ 0x006dba89
006dba77 : MOV ESI,EDI
006dba79 : CALL 0x006db780
006dba7e : TEST AL,AL
006dba80 : JNZ 0x006dba89
006dba82 : POP EDI
006dba83 : POP ESI
006dba84 : POP EBX
006dba85 : ADD ESP,0x2c
006dba88 : RET
006dba89 : CMP byte ptr [EBX + 0x8],0x0
006dba8d : PUSH EBP
006dba8e : JNZ 0x006dbc6f
006dba94 : MOV ECX,dword ptr [EBX + 0x14]
006dba97 : MOV dword ptr [ESP + 0x10],ECX
006dba9b : TEST ECX,ECX
006dba9d : JBE 0x006dbab0
006dba9f : POP EBP
006dbaa0 : POP EDI
006dbaa1 : DEC ECX
006dbaa2 : DEC dword ptr [EBX + 0x28]
006dbaa5 : POP ESI
006dbaa6 : MOV dword ptr [EBX + 0x14],ECX
006dbaa9 : MOV AL,0x1
006dbaab : POP EBX
006dbaac : ADD ESP,0x2c
006dbaaf : RET
006dbab0 : MOV EAX,dword ptr [EDI + 0x18]
006dbab3 : MOV EBP,dword ptr [EDI + 0x16c]
006dbab9 : CMP EBP,dword ptr [ESP + 0x18]
006dbabd : MOV dword ptr [ESP + 0x38],EDI
006dbac1 : MOV EDX,dword ptr [EAX]
006dbac3 : MOV dword ptr [ESP + 0x28],EDX
006dbac7 : MOV EDX,dword ptr [ESP + 0x44]
006dbacb : MOV EAX,dword ptr [EAX + 0x4]
006dbace : MOV EDX,dword ptr [EDX]
006dbad0 : MOV dword ptr [ESP + 0x2c],EAX
006dbad4 : MOV ESI,dword ptr [EBX + 0xc]
006dbad7 : MOV EAX,dword ptr [EBX + 0x10]
006dbada : MOV dword ptr [ESP + 0x24],EDX
006dbade : MOV EDX,dword ptr [EBX + 0x3c]
006dbae1 : MOV dword ptr [ESP + 0x14],EDX
006dbae5 : JG 0x006dbc53
006dbaeb : JMP 0x006dbaf0
006dbaf0 : CMP EAX,0x8
006dbaf3 : JGE 0x006dbb26
006dbaf5 : PUSH 0x0
006dbaf7 : PUSH EAX
006dbaf8 : LEA EAX,[ESP + 0x30]
006dbafc : PUSH ESI
006dbafd : PUSH EAX
006dbafe : CALL 0x006daf40
006dbb03 : ADD ESP,0x10
006dbb06 : TEST AL,AL
006dbb08 : JZ 0x006dbc23
006dbb0e : MOV EAX,dword ptr [ESP + 0x34]
006dbb12 : CMP EAX,0x8
006dbb15 : MOV ESI,dword ptr [ESP + 0x30]
006dbb19 : JGE 0x006dbb26
006dbb1b : MOV EDI,dword ptr [ESP + 0x14]
006dbb1f : MOV ECX,0x1
006dbb24 : JMP 0x006dbb53
006dbb26 : MOV EDI,dword ptr [ESP + 0x14]
006dbb2a : LEA ECX,[EAX + -0x8]
006dbb2d : MOV EDX,ESI
006dbb2f : SAR EDX,CL
006dbb31 : AND EDX,0xff
006dbb37 : MOV ECX,dword ptr [EDI + EDX*0x4 + 0x90]
006dbb3e : TEST ECX,ECX
006dbb40 : JZ 0x006dbb4e
006dbb42 : MOVZX EDI,byte ptr [EDX + EDI*0x1 + 0x490]
006dbb4a : SUB EAX,ECX
006dbb4c : JMP 0x006dbb76
006dbb4e : MOV ECX,0x9
006dbb53 : PUSH ECX
006dbb54 : PUSH EDI
006dbb55 : PUSH EAX
006dbb56 : LEA ECX,[ESP + 0x34]
006dbb5a : PUSH ESI
006dbb5b : PUSH ECX
006dbb5c : CALL 0x006db060
006dbb61 : MOV EDI,EAX
006dbb63 : ADD ESP,0x14
006dbb66 : TEST EDI,EDI
006dbb68 : JL 0x006dbc23
006dbb6e : MOV ESI,dword ptr [ESP + 0x30]
006dbb72 : MOV EAX,dword ptr [ESP + 0x34]
006dbb76 : MOV EBX,EDI
006dbb78 : SAR EBX,0x4
006dbb7b : AND EDI,0xf
006dbb7e : JZ 0x006dbbe7
006dbb80 : ADD EBP,EBX
006dbb82 : CMP EAX,EDI
006dbb84 : JGE 0x006dbba6
006dbb86 : PUSH EDI
006dbb87 : PUSH EAX
006dbb88 : LEA EDX,[ESP + 0x30]
006dbb8c : PUSH ESI
006dbb8d : PUSH EDX
006dbb8e : CALL 0x006daf40
006dbb93 : ADD ESP,0x10
006dbb96 : TEST AL,AL
006dbb98 : JZ 0x006dbc23
006dbb9e : MOV ESI,dword ptr [ESP + 0x30]
006dbba2 : MOV EAX,dword ptr [ESP + 0x34]
006dbba6 : MOV ECX,EDI
006dbba8 : SUB EAX,EDI
006dbbaa : MOV EDX,0x1
006dbbaf : SHL EDX,CL
006dbbb1 : MOV EBX,ESI
006dbbb3 : MOV ECX,EAX
006dbbb5 : SAR EBX,CL
006dbbb7 : DEC EDX
006dbbb8 : AND EDX,EBX
006dbbba : CMP EDX,dword ptr [EDI*0x4 + 0xbf1730]
006dbbc1 : JGE 0x006dbbce
006dbbc3 : MOV EDI,dword ptr [EDI*0x4 + 0xbf1770]
006dbbca : ADD EDI,EDX
006dbbcc : JMP 0x006dbbd0
006dbbce : MOV EDI,EDX
006dbbd0 : MOV ECX,dword ptr [ESP + 0x20]
006dbbd4 : MOV EDX,dword ptr [ESP + 0x24]
006dbbd8 : SHL EDI,CL
006dbbda : MOV ECX,dword ptr [EBP*0x4 + 0xbf1570]
006dbbe1 : MOV word ptr [EDX + ECX*0x2],DI
006dbbe5 : JMP 0x006dbbef
006dbbe7 : CMP EBX,0xf
006dbbea : JNZ 0x006dbbfc
006dbbec : ADD EBP,0xf
006dbbef : INC EBP
006dbbf0 : CMP EBP,dword ptr [ESP + 0x18]
006dbbf4 : JLE 0x006dbaf0
006dbbfa : JMP 0x006dbc47
006dbbfc : MOV EDI,0x1
006dbc01 : MOV ECX,EBX
006dbc03 : SHL EDI,CL
006dbc05 : MOV EBP,EDI
006dbc07 : TEST EBX,EBX
006dbc09 : JZ 0x006dbc42
006dbc0b : CMP EAX,EBX
006dbc0d : JGE 0x006dbc35
006dbc0f : PUSH EBX
006dbc10 : PUSH EAX
006dbc11 : LEA EAX,[ESP + 0x30]
006dbc15 : PUSH ESI
006dbc16 : PUSH EAX
006dbc17 : CALL 0x006daf40
006dbc1c : ADD ESP,0x10
006dbc1f : TEST AL,AL
006dbc21 : JNZ 0x006dbc2d
006dbc23 : POP EBP
006dbc24 : POP EDI
006dbc25 : POP ESI
006dbc26 : XOR AL,AL
006dbc28 : POP EBX
006dbc29 : ADD ESP,0x2c
006dbc2c : RET
006dbc2d : MOV ESI,dword ptr [ESP + 0x30]
006dbc31 : MOV EAX,dword ptr [ESP + 0x34]
006dbc35 : SUB EAX,EBX
006dbc37 : MOV EDX,ESI
006dbc39 : MOV ECX,EAX
006dbc3b : SAR EDX,CL
006dbc3d : DEC EDI
006dbc3e : AND EDX,EDI
006dbc40 : ADD EBP,EDX
006dbc42 : DEC EBP
006dbc43 : MOV dword ptr [ESP + 0x10],EBP
006dbc47 : MOV ECX,dword ptr [ESP + 0x10]
006dbc4b : MOV EDI,dword ptr [ESP + 0x40]
006dbc4f : MOV EBX,dword ptr [ESP + 0x1c]
006dbc53 : MOV EDX,dword ptr [EDI + 0x18]
006dbc56 : MOV EBP,dword ptr [ESP + 0x28]
006dbc5a : MOV dword ptr [EDX],EBP
006dbc5c : MOV EDX,dword ptr [EDI + 0x18]
006dbc5f : MOV EDI,dword ptr [ESP + 0x2c]
006dbc63 : MOV dword ptr [EDX + 0x4],EDI
006dbc66 : MOV dword ptr [EBX + 0xc],ESI
006dbc69 : MOV dword ptr [EBX + 0x10],EAX
006dbc6c : MOV dword ptr [EBX + 0x14],ECX
006dbc6f : DEC dword ptr [EBX + 0x28]
006dbc72 : POP EBP
006dbc73 : POP EDI
006dbc74 : POP ESI
006dbc75 : MOV AL,0x1
006dbc77 : POP EBX
006dbc78 : ADD ESP,0x2c
006dbc7b : RET

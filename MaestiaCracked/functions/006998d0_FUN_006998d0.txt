PROGRAM  : Maestia.exe
FUNCTION : FUN_006998d0
ENTRY    : 006998d0
BODY     : [[006998d0, 00699a0c]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_006998d0(int *param_1,int *param_2)

{
  short *psVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  
  psVar1 = (short *)param_2[1];
  piVar2 = (int *)*param_2;
  if (((param_1 == (int *)0x0) || (*param_1 == 0)) || (param_1[1] == 0)) {
    return 0x60;
  }
  if (psVar1 == (short *)0x0) {
    return 0x14;
  }
  if ((psVar1[1] != 0) && (0 < *psVar1)) {
    if ((*(int *)(psVar1 + 6) != 0) &&
       ((*(int *)(psVar1 + 2) != 0 &&
        ((int)psVar1[1] == *(short *)(*(int *)(psVar1 + 6) + -2 + *psVar1 * 2) + 1)))) {
      iVar3 = param_1[3];
      if ((*(byte *)(param_2 + 2) & 2) != 0) {
        return 0x13;
      }
      if (piVar2 != (int *)0x0) {
        if (piVar2[1] == 0) {
          return 0;
        }
        if (*piVar2 == 0) {
          return 0;
        }
        if (piVar2[3] != 0) {
          *(undefined4 *)(iVar3 + 0x84) = *(undefined4 *)psVar1;
          *(undefined4 *)(iVar3 + 0x88) = *(undefined4 *)(psVar1 + 2);
          *(undefined4 *)(iVar3 + 0x8c) = *(undefined4 *)(psVar1 + 4);
          *(undefined4 *)(iVar3 + 0x90) = *(undefined4 *)(psVar1 + 6);
          *(undefined4 *)(iVar3 + 0x94) = *(undefined4 *)(psVar1 + 8);
          *(int *)(iVar3 + 0x6c) = *piVar2;
          *(int *)(iVar3 + 0x70) = piVar2[1];
          *(int *)(iVar3 + 0x74) = piVar2[2];
          *(int *)(iVar3 + 0x78) = piVar2[3];
          *(int *)(iVar3 + 0x7c) = piVar2[4];
          *(int *)(iVar3 + 0x80) = piVar2[5];
          iVar4 = *param_1;
          *(int *)(iVar3 + 0x20) = iVar4;
          *(uint *)(iVar3 + 0x24) = iVar4 + (param_1[1] & 0xfffffffcU);
          if ((*(byte *)(param_2 + 2) & 1) == 0) {
            uVar5 = FUN_006996e0();
            return uVar5;
          }
          uVar5 = FUN_00699810();
          return uVar5;
        }
      }
    }
    return 0x14;
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
006998d0 : PUSH EBP
006998d1 : MOV EBP,dword ptr [ESP + 0xc]
006998d5 : MOV ECX,dword ptr [EBP + 0x4]
006998d8 : MOV EDX,dword ptr [EBP]
006998db : PUSH ESI
006998dc : MOV ESI,dword ptr [ESP + 0xc]
006998e0 : TEST ESI,ESI
006998e2 : JZ 0x00699a05
006998e8 : CMP dword ptr [ESI],0x0
006998eb : JZ 0x00699a05
006998f1 : CMP dword ptr [ESI + 0x4],0x0
006998f5 : JZ 0x00699a05
006998fb : TEST ECX,ECX
006998fd : JNZ 0x00699905
006998ff : POP ESI
00699900 : LEA EAX,[ECX + 0x14]
00699903 : POP EBP
00699904 : RET
00699905 : PUSH EBX
00699906 : MOVZX EBX,word ptr [ECX + 0x2]
0069990a : PUSH EDI
0069990b : TEST BX,BX
0069990e : JZ 0x006999fe
00699914 : MOVZX EDI,word ptr [ECX]
00699917 : TEST DI,DI
0069991a : JLE 0x006999fe
00699920 : MOV EAX,dword ptr [ECX + 0xc]
00699923 : TEST EAX,EAX
00699925 : JZ 0x006999f4
0069992b : CMP dword ptr [ECX + 0x4],0x0
0069992f : JZ 0x006999f4
00699935 : MOVSX EDI,DI
00699938 : MOVSX EAX,word ptr [EAX + EDI*0x2 + -0x2]
0069993d : MOVSX EDI,BX
00699940 : INC EAX
00699941 : CMP EDI,EAX
00699943 : JNZ 0x006999f4
00699949 : TEST byte ptr [EBP + 0x8],0x2
0069994d : MOV EAX,dword ptr [ESI + 0xc]
00699950 : JZ 0x0069995c
00699952 : POP EDI
00699953 : POP EBX
00699954 : POP ESI
00699955 : MOV EAX,0x13
0069995a : POP EBP
0069995b : RET
0069995c : TEST EDX,EDX
0069995e : JZ 0x006999f4
00699964 : CMP dword ptr [EDX + 0x4],0x0
00699968 : JZ 0x006999fe
0069996e : CMP dword ptr [EDX],0x0
00699971 : JZ 0x006999fe
00699977 : CMP dword ptr [EDX + 0xc],0x0
0069997b : JZ 0x006999f4
0069997d : MOV EDI,dword ptr [ECX]
0069997f : MOV dword ptr [EAX + 0x84],EDI
00699985 : MOV EDI,dword ptr [ECX + 0x4]
00699988 : MOV dword ptr [EAX + 0x88],EDI
0069998e : MOV EDI,dword ptr [ECX + 0x8]
00699991 : MOV dword ptr [EAX + 0x8c],EDI
00699997 : MOV EDI,dword ptr [ECX + 0xc]
0069999a : MOV dword ptr [EAX + 0x90],EDI
006999a0 : MOV ECX,dword ptr [ECX + 0x10]
006999a3 : MOV dword ptr [EAX + 0x94],ECX
006999a9 : MOV ECX,dword ptr [EDX]
006999ab : MOV dword ptr [EAX + 0x6c],ECX
006999ae : MOV ECX,dword ptr [EDX + 0x4]
006999b1 : MOV dword ptr [EAX + 0x70],ECX
006999b4 : MOV ECX,dword ptr [EDX + 0x8]
006999b7 : MOV dword ptr [EAX + 0x74],ECX
006999ba : MOV ECX,dword ptr [EDX + 0xc]
006999bd : MOV dword ptr [EAX + 0x78],ECX
006999c0 : MOV ECX,dword ptr [EDX + 0x10]
006999c3 : MOV dword ptr [EAX + 0x7c],ECX
006999c6 : MOV EDX,dword ptr [EDX + 0x14]
006999c9 : MOV dword ptr [EAX + 0x80],EDX
006999cf : MOV ECX,dword ptr [ESI]
006999d1 : MOV dword ptr [EAX + 0x20],ECX
006999d4 : MOV EDX,dword ptr [ESI + 0x4]
006999d7 : POP EDI
006999d8 : SHR EDX,0x2
006999db : POP EBX
006999dc : LEA ECX,[ECX + EDX*0x4]
006999df : MOV dword ptr [EAX + 0x24],ECX
006999e2 : TEST byte ptr [EBP + 0x8],0x1
006999e6 : POP ESI
006999e7 : POP EBP
006999e8 : JZ 0x006999ef
006999ea : JMP 0x00699810
006999ef : JMP 0x006996e0
006999f4 : POP EDI
006999f5 : POP EBX
006999f6 : POP ESI
006999f7 : MOV EAX,0x14
006999fc : POP EBP
006999fd : RET
006999fe : POP EDI
006999ff : POP EBX
00699a00 : POP ESI
00699a01 : XOR EAX,EAX
00699a03 : POP EBP
00699a04 : RET
00699a05 : POP ESI
00699a06 : MOV EAX,0x60
00699a0b : POP EBP
00699a0c : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_0091c080
ENTRY    : 0091c080
BODY     : [[0091c080, 0091c0d9] [0091c0e0, 0091c1db]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0091c080(ushort *param_1)

{
  undefined4 *puVar1;
  DWORD DVar2;
  int iVar3;
  uint uVar4;
  undefined4 *puVar5;
  undefined4 local_18;
  int local_14;
  short local_10;
  int local_c;
  byte local_5;
  
  iVar3 = DAT_00da93ec;
  puVar1 = *(undefined4 **)(DAT_00da93ec + 0x38c);
  uVar4 = (*param_1 & 0x1fff) - 5;
  puVar5 = (undefined4 *)((int)param_1 + 5);
  if (puVar1 != *(undefined4 **)(DAT_00da93ec + 0x390)) {
    do {
      if (*(char *)(puVar1 + 2) == '\x01') {
        *puVar1 = 0;
      }
      puVar1 = puVar1 + 0xc;
    } while (puVar1 != *(undefined4 **)(iVar3 + 0x390));
  }
  local_c = 0;
  if ((char)param_1[2] != '\0') {
    do {
      if ((puVar5 == (undefined4 *)0x0) || (uVar4 < 4)) {
LAB_0091c134:
        uVar4 = 0;
        puVar5 = (undefined4 *)0x0;
      }
      else {
        local_18 = *puVar5;
        if (((short *)(puVar5 + 1) == (short *)0x0) || (uVar4 - 4 < 2)) goto LAB_0091c134;
        local_10 = *(short *)(puVar5 + 1);
        if (((byte *)((int)puVar5 + 6) == (byte *)0x0) || (uVar4 == 6)) goto LAB_0091c134;
        local_5 = *(byte *)((int)puVar5 + 6);
        if (((int *)((int)puVar5 + 7) == (int *)0x0) || (uVar4 - 7 < 4)) goto LAB_0091c134;
        local_14 = *(int *)((int)puVar5 + 7);
        uVar4 = uVar4 - 0xb;
        puVar5 = (undefined4 *)((int)puVar5 + 0xb);
      }
      for (puVar1 = *(undefined4 **)(iVar3 + 0x38c); puVar1 != *(undefined4 **)(iVar3 + 0x390);
          puVar1 = puVar1 + 0xc) {
        if (*(short *)(puVar1 + 1) == local_10) {
          *(ushort *)((int)puVar1 + 6) = (ushort)local_5;
          DVar2 = GetTickCount();
          puVar1[4] = DVar2 + local_14 * 1000;
          *puVar1 = local_18;
          goto LAB_0091c16c;
        }
      }
      FUN_008018d0(L"[AvaGuiRvREvent::ReceiveTowerList] tower %d not found\n",local_10);
LAB_0091c16c:
      local_c = local_c + 1;
      iVar3 = DAT_00da93ec;
    } while (local_c < (int)(uint)(byte)param_1[2]);
  }
  if (*(int *)(*DAT_00da9894 + 300) == 0) {
    FUN_009823b0(0,0);
    return;
  }
  FUN_009823b0(*(undefined4 *)(*(int *)(*DAT_00da9894 + 300) + 0x18),0);
  return;
}



============================================================
DISASSEMBLY
============================================================
0091c080 : PUSH EBP
0091c081 : MOV EBP,ESP
0091c083 : MOV ECX,dword ptr [EBP + 0x8]
0091c086 : MOV EDX,dword ptr [0x00da93ec]
0091c08c : MOV EAX,dword ptr [EDX + 0x38c]
0091c092 : SUB ESP,0x18
0091c095 : PUSH EBX
0091c096 : MOVZX EBX,word ptr [ECX]
0091c099 : AND EBX,0x1fff
0091c09f : PUSH ESI
0091c0a0 : SUB EBX,0x5
0091c0a3 : PUSH EDI
0091c0a4 : LEA EDI,[ECX + 0x5]
0091c0a7 : CMP EAX,dword ptr [EDX + 0x390]
0091c0ad : JZ 0x0091c0c7
0091c0af : NOP
0091c0b0 : CMP byte ptr [EAX + 0x8],0x1
0091c0b4 : JNZ 0x0091c0bc
0091c0b6 : MOV dword ptr [EAX],0x0
0091c0bc : ADD EAX,0x30
0091c0bf : CMP EAX,dword ptr [EDX + 0x390]
0091c0c5 : JNZ 0x0091c0b0
0091c0c7 : CMP byte ptr [ECX + 0x4],0x0
0091c0cb : MOV dword ptr [EBP + -0x8],0x0
0091c0d2 : JBE 0x0091c182
0091c0d8 : JMP 0x0091c0e6
0091c0e0 : MOV EDX,dword ptr [0x00da93ec]
0091c0e6 : TEST EDI,EDI
0091c0e8 : JZ 0x0091c131
0091c0ea : CMP EBX,0x4
0091c0ed : JC 0x0091c131
0091c0ef : MOV EAX,dword ptr [EDI]
0091c0f1 : SUB EBX,0x4
0091c0f4 : ADD EDI,0x4
0091c0f7 : MOV dword ptr [EBP + -0x14],EAX
0091c0fa : JZ 0x0091c131
0091c0fc : CMP EBX,0x2
0091c0ff : JC 0x0091c131
0091c101 : MOVZX ECX,word ptr [EDI]
0091c104 : SUB EBX,0x2
0091c107 : ADD EDI,0x2
0091c10a : MOV dword ptr [EBP + -0xc],ECX
0091c10d : JZ 0x0091c134
0091c10f : CMP EBX,0x1
0091c112 : JC 0x0091c134
0091c114 : MOV AL,byte ptr [EDI]
0091c116 : DEC EBX
0091c117 : ADD EDI,0x1
0091c11a : MOV byte ptr [EBP + -0x1],AL
0091c11d : JZ 0x0091c134
0091c11f : CMP EBX,0x4
0091c122 : JC 0x0091c134
0091c124 : MOV EAX,dword ptr [EDI]
0091c126 : SUB EBX,0x4
0091c129 : MOV dword ptr [EBP + -0x10],EAX
0091c12c : ADD EDI,0x4
0091c12f : JMP 0x0091c138
0091c131 : MOV ECX,dword ptr [EBP + -0xc]
0091c134 : XOR EBX,EBX
0091c136 : XOR EDI,EDI
0091c138 : MOV ESI,dword ptr [EDX + 0x38c]
0091c13e : MOV EAX,dword ptr [EDX + 0x390]
0091c144 : CMP ESI,EAX
0091c146 : JZ 0x0091c155
0091c148 : CMP word ptr [ESI + 0x4],CX
0091c14c : JZ 0x0091c1a4
0091c14e : ADD ESI,0x30
0091c151 : CMP ESI,EAX
0091c153 : JNZ 0x0091c148
0091c155 : MOV ESI,dword ptr [0x00da98e8]
0091c15b : MOVZX ECX,CX
0091c15e : PUSH ECX
0091c15f : PUSH 0xc68520
0091c164 : CALL 0x008018d0
0091c169 : ADD ESP,0x8
0091c16c : MOV EDX,dword ptr [EBP + 0x8]
0091c16f : MOV EAX,dword ptr [EBP + -0x8]
0091c172 : MOVZX ECX,byte ptr [EDX + 0x4]
0091c176 : INC EAX
0091c177 : CMP EAX,ECX
0091c179 : MOV dword ptr [EBP + -0x8],EAX
0091c17c : JL 0x0091c0e0
0091c182 : MOV EDX,dword ptr [0x00da9894]
0091c188 : MOV EAX,dword ptr [EDX]
0091c18a : MOV EAX,dword ptr [EAX + 0x12c]
0091c190 : TEST EAX,EAX
0091c192 : JNZ 0x0091c1c8
0091c194 : PUSH EAX
0091c195 : PUSH EAX
0091c196 : CALL 0x009823b0
0091c19b : POP EDI
0091c19c : POP ESI
0091c19d : POP EBX
0091c19e : MOV ESP,EBP
0091c1a0 : POP EBP
0091c1a1 : RET 0x4
0091c1a4 : MOVZX CX,byte ptr [EBP + -0x1]
0091c1a9 : MOV word ptr [ESI + 0x6],CX
0091c1ad : CALL dword ptr [0x00b850d8]
0091c1b3 : MOV EDX,dword ptr [EBP + -0x10]
0091c1b6 : IMUL EDX,EDX,0x3e8
0091c1bc : ADD EAX,EDX
0091c1be : MOV dword ptr [ESI + 0x10],EAX
0091c1c1 : MOV EAX,dword ptr [EBP + -0x14]
0091c1c4 : MOV dword ptr [ESI],EAX
0091c1c6 : JMP 0x0091c16c
0091c1c8 : MOV EAX,dword ptr [EAX + 0x18]
0091c1cb : PUSH 0x0
0091c1cd : PUSH EAX
0091c1ce : CALL 0x009823b0
0091c1d3 : POP EDI
0091c1d4 : POP ESI
0091c1d5 : POP EBX
0091c1d6 : MOV ESP,EBP
0091c1d8 : POP EBP
0091c1d9 : RET 0x4

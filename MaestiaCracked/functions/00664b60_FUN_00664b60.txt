PROGRAM  : Maestia.exe
FUNCTION : FUN_00664b60
ENTRY    : 00664b60
BODY     : [[00664b60, 00664bd3]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00664b60(int *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  undefined4 *in_ECX;
  
  iVar1 = *param_1;
  do {
    if (iVar1 == 0) {
      return 1;
    }
    uVar2 = *(undefined4 *)(iVar1 + 8);
    puVar4 = (undefined4 *)in_ECX[5];
    iVar1 = *(int *)(iVar1 + 4);
    if (puVar4 == (undefined4 *)0x0) {
LAB_00664b8c:
      puVar4 = (undefined4 *)FUN_006f0300(0xc);
      if (puVar4 == (undefined4 *)0x0) {
        return 0;
      }
    }
    else {
      uVar3 = puVar4[1];
      in_ECX[4] = in_ECX[4] + -1;
      in_ECX[5] = uVar3;
      if (puVar4 == (undefined4 *)0x0) goto LAB_00664b8c;
    }
    puVar4[2] = uVar2;
    puVar4[1] = 0;
    *puVar4 = in_ECX[1];
    if (in_ECX[1] == 0) {
      *in_ECX = puVar4;
    }
    else {
      *(undefined4 **)(in_ECX[1] + 4) = puVar4;
    }
    in_ECX[2] = in_ECX[2] + 1;
    in_ECX[1] = puVar4;
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
00664b60 : MOV EAX,dword ptr [ESP + 0x4]
00664b64 : PUSH EBX
00664b65 : PUSH ESI
00664b66 : PUSH EDI
00664b67 : MOV EDI,dword ptr [EAX]
00664b69 : MOV ESI,ECX
00664b6b : TEST EDI,EDI
00664b6d : JZ 0x00664bc1
00664b6f : NOP
00664b70 : MOV EAX,EDI
00664b72 : MOV EBX,dword ptr [EAX + 0x8]
00664b75 : MOV EAX,dword ptr [ESI + 0x14]
00664b78 : MOV EDI,dword ptr [EDI + 0x4]
00664b7b : TEST EAX,EAX
00664b7d : JZ 0x00664b8c
00664b7f : MOV ECX,dword ptr [EAX + 0x4]
00664b82 : DEC dword ptr [ESI + 0x10]
00664b85 : MOV dword ptr [ESI + 0x14],ECX
00664b88 : TEST EAX,EAX
00664b8a : JNZ 0x00664b9a
00664b8c : PUSH 0xc
00664b8e : CALL 0x006f0300
00664b93 : ADD ESP,0x4
00664b96 : TEST EAX,EAX
00664b98 : JZ 0x00664bcc
00664b9a : MOV dword ptr [EAX + 0x8],EBX
00664b9d : MOV dword ptr [EAX + 0x4],0x0
00664ba4 : MOV EDX,dword ptr [ESI + 0x4]
00664ba7 : MOV dword ptr [EAX],EDX
00664ba9 : MOV ECX,dword ptr [ESI + 0x4]
00664bac : TEST ECX,ECX
00664bae : JNZ 0x00664bb4
00664bb0 : MOV dword ptr [ESI],EAX
00664bb2 : JMP 0x00664bb7
00664bb4 : MOV dword ptr [ECX + 0x4],EAX
00664bb7 : INC dword ptr [ESI + 0x8]
00664bba : MOV dword ptr [ESI + 0x4],EAX
00664bbd : TEST EDI,EDI
00664bbf : JNZ 0x00664b70
00664bc1 : POP EDI
00664bc2 : POP ESI
00664bc3 : MOV EAX,0x1
00664bc8 : POP EBX
00664bc9 : RET 0x4
00664bcc : POP EDI
00664bcd : POP ESI
00664bce : XOR EAX,EAX
00664bd0 : POP EBX
00664bd1 : RET 0x4

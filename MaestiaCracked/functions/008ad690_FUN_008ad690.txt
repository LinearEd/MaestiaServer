PROGRAM  : Maestia.exe
FUNCTION : FUN_008ad690
ENTRY    : 008ad690
BODY     : [[008ad690, 008ad91d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008ad690(int param_1,undefined4 param_2,int param_3)

{
  short sVar1;
  int *piVar2;
  int iVar3;
  undefined4 uVar4;
  uint8_t *puVar5;
  int iVar6;
  int iVar7;
  undefined1 local_50 [52];
  void *pvStack_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b44d0c;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  if (param_1 == 0) {
    if (*DAT_00da9894 != 0) {
      if (*(uint *)(param_3 + 0x18) < 8) {
        param_3 = param_3 + 4;
      }
      else {
        param_3 = *(int *)(param_3 + 4);
      }
      iVar3 = FUN_00634f4d(param_3,DAT_00d66fa0 ^ (uint)&stack0xffffffa0);
      if (0 < iVar3) {
        iVar7 = 0;
        iVar6 = iVar3;
        if ((DAT_00d7cd6c != 0) && (DAT_00d7cd6c != 2)) {
          iVar6 = 0;
          iVar7 = iVar3;
        }
        iVar3 = *DAT_00da9894;
        sVar1 = *(short *)(**(int **)(iVar3 + 0x188) + 0xb2);
        if ((DAT_00d7cd6c == 0) || (DAT_00d7cd6c == 1)) {
          puVar5 = (uint8_t *)FUN_006f4590();
          if (puVar5 == (uint8_t *)0x0) {
            puVar5 = (uint8_t *)0x0;
          }
          else {
            puVar5[0] = '\0';
            puVar5[1] = '\0';
            puVar5[2] = 'F';
            puVar5[3] = '\\';
            *(int *)(puVar5 + 4) = iVar6;
            *(int *)(puVar5 + 8) = iVar7;
          }
          local_c = 0xffffffff;
          if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
            FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),0xc,puVar5);
          }
        }
        else {
          if (*(int *)(DAT_0172491c + 0x17c) == 0) {
            ExceptionList = local_14;
            return;
          }
          if (1000000000 < (uint)(*(int *)(*(int *)(DAT_0172491c + 0x17c) + 0x1ed0) + iVar6)) {
            if (iVar3 == 0) {
              ExceptionList = local_14;
              return;
            }
            if (*(int *)(iVar3 + 0x1a8) == 0) {
              ExceptionList = local_14;
              return;
            }
            FUN_00406460(L"IDS_ERROR_HAVE_MONEY_BURN");
            local_c = 1;
            piVar2 = *(int **)(*DAT_00da9894 + 0x1a8);
            uVar4 = FUN_0081d120(local_50);
            local_c = CONCAT31(local_c._1_3_,2);
            (**(code **)(*piVar2 + 0x44))(uVar4,3);
            local_14 = (void *)CONCAT31(local_14._1_3_,1);
            FUN_00406560();
            local_14 = (void *)0xffffffff;
            FUN_00406560();
            ExceptionList = pvStack_1c;
            return;
          }
          puVar5 = (uint8_t *)FUN_006f4590();
          if (puVar5 == (uint8_t *)0x0) {
            puVar5 = (uint8_t *)0x0;
          }
          else {
            puVar5[0] = '\0';
            puVar5[1] = '\0';
            puVar5[2] = 'F';
            puVar5[3] = ']';
            *(int *)(puVar5 + 4) = iVar6;
            *(int *)(puVar5 + 8) = iVar7;
          }
          local_c = 0xffffffff;
          if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
            FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),0xc,puVar5);
          }
        }
        if (sVar1 == 1) {
          FUN_008ad130(1,1);
        }
      }
    }
  }
  else if (param_1 == 1) {
    (**(code **)(**(int **)(*DAT_00da9894 + 0x114) + 4))
              (*(int **)(*DAT_00da9894 + 0x114),"InitInputDlg",&DAT_00bf243f);
    ExceptionList = local_14;
    return;
  }
  ExceptionList = local_14;
  return;
}



============================================================
DISASSEMBLY
============================================================
008ad690 : PUSH EBP
008ad691 : MOV EBP,ESP
008ad693 : AND ESP,0xfffffff8
008ad696 : PUSH -0x1
008ad698 : PUSH 0xb44d0c
008ad69d : MOV EAX,FS:[0x0]
008ad6a3 : PUSH EAX
008ad6a4 : SUB ESP,0x40
008ad6a7 : PUSH EBX
008ad6a8 : PUSH ESI
008ad6a9 : PUSH EDI
008ad6aa : MOV EAX,[0x00d66fa0]
008ad6af : XOR EAX,ESP
008ad6b1 : PUSH EAX
008ad6b2 : LEA EAX,[ESP + 0x50]
008ad6b6 : MOV FS:[0x0],EAX
008ad6bc : MOV EAX,dword ptr [EBP + 0x8]
008ad6bf : SUB EAX,0x0
008ad6c2 : JZ 0x008ad704
008ad6c4 : SUB EAX,0x1
008ad6c7 : JNZ 0x008ad909
008ad6cd : MOV EAX,[0x00da9894]
008ad6d2 : MOV ECX,dword ptr [EAX]
008ad6d4 : MOV EAX,dword ptr [ECX + 0x114]
008ad6da : MOV EDX,dword ptr [EAX]
008ad6dc : PUSH 0xbf243f
008ad6e1 : PUSH 0xc4b898
008ad6e6 : PUSH EAX
008ad6e7 : MOV EAX,dword ptr [EDX + 0x4]
008ad6ea : CALL EAX
008ad6ec : ADD ESP,0xc
008ad6ef : MOV ECX,dword ptr [ESP + 0x50]
008ad6f3 : MOV dword ptr FS:[0x0],ECX
008ad6fa : POP ECX
008ad6fb : POP EDI
008ad6fc : POP ESI
008ad6fd : POP EBX
008ad6fe : MOV ESP,EBP
008ad700 : POP EBP
008ad701 : RET 0xc
008ad704 : MOV ECX,dword ptr [0x00da9894]
008ad70a : CMP dword ptr [ECX],0x0
008ad70d : JZ 0x008ad909
008ad713 : MOV EAX,dword ptr [EBP + 0x10]
008ad716 : CMP dword ptr [EAX + 0x18],0x8
008ad71a : JC 0x008ad721
008ad71c : MOV EAX,dword ptr [EAX + 0x4]
008ad71f : JMP 0x008ad724
008ad721 : ADD EAX,0x4
008ad724 : PUSH EAX
008ad725 : CALL 0x00634f4d
008ad72a : ADD ESP,0x4
008ad72d : TEST EAX,EAX
008ad72f : JLE 0x008ad909
008ad735 : MOV EDX,dword ptr [0x00d7cd6c]
008ad73b : XOR ESI,ESI
008ad73d : XOR EDI,EDI
008ad73f : TEST EDX,EDX
008ad741 : JZ 0x008ad74c
008ad743 : CMP EDX,0x2
008ad746 : JZ 0x008ad74c
008ad748 : MOV EDI,EAX
008ad74a : JMP 0x008ad74e
008ad74c : MOV ESI,EAX
008ad74e : MOV EAX,[0x00da9894]
008ad753 : MOV EAX,dword ptr [EAX]
008ad755 : MOV ECX,dword ptr [EAX + 0x188]
008ad75b : MOV ECX,dword ptr [ECX]
008ad75d : MOVZX EBX,word ptr [ECX + 0xb2]
008ad764 : TEST EDX,EDX
008ad766 : JZ 0x008ad89a
008ad76c : CMP EDX,0x1
008ad76f : JZ 0x008ad89a
008ad775 : MOV ECX,dword ptr [0x0172491c]
008ad77b : MOV ECX,dword ptr [ECX + 0x17c]
008ad781 : TEST ECX,ECX
008ad783 : JZ 0x008ad909
008ad789 : MOV ECX,dword ptr [ECX + 0x1ed0]
008ad78f : ADD ECX,ESI
008ad791 : CMP ECX,0x3b9aca00
008ad797 : JBE 0x008ad82d
008ad79d : TEST EAX,EAX
008ad79f : JZ 0x008ad909
008ad7a5 : CMP dword ptr [EAX + 0x1a8],0x0
008ad7ac : JZ 0x008ad909
008ad7b2 : PUSH 0xc4b864
008ad7b7 : LEA ECX,[ESP + 0x18]
008ad7bb : CALL 0x00406460
008ad7c0 : MOV dword ptr [ESP + 0x58],0x1
008ad7c8 : MOV EDX,dword ptr [0x00da9894]
008ad7ce : MOV EAX,dword ptr [EDX]
008ad7d0 : MOV ESI,dword ptr [EAX + 0x1a8]
008ad7d6 : MOV ECX,dword ptr [0x0172491c]
008ad7dc : LEA EAX,[ESP + 0x14]
008ad7e0 : PUSH EAX
008ad7e1 : LEA EDI,[ESP + 0x34]
008ad7e5 : CALL 0x0081d120
008ad7ea : MOV byte ptr [ESP + 0x58],0x2
008ad7ef : MOV EDX,dword ptr [ESI]
008ad7f1 : PUSH 0x3
008ad7f3 : PUSH EAX
008ad7f4 : MOV EAX,dword ptr [EDX + 0x44]
008ad7f7 : MOV ECX,ESI
008ad7f9 : CALL EAX
008ad7fb : MOV byte ptr [ESP + 0x58],0x1
008ad800 : MOV ECX,EDI
008ad802 : CALL 0x00406560
008ad807 : MOV dword ptr [ESP + 0x58],0xffffffff
008ad80f : LEA ECX,[ESP + 0x14]
008ad813 : CALL 0x00406560
008ad818 : MOV ECX,dword ptr [ESP + 0x50]
008ad81c : MOV dword ptr FS:[0x0],ECX
008ad823 : POP ECX
008ad824 : POP EDI
008ad825 : POP ESI
008ad826 : POP EBX
008ad827 : MOV ESP,EBP
008ad829 : POP EBP
008ad82a : RET 0xc
008ad82d : CALL 0x006f4590
008ad832 : MOV dword ptr [ESP + 0x10],EAX
008ad836 : MOV dword ptr [ESP + 0x58],0x3
008ad83e : TEST EAX,EAX
008ad840 : JZ 0x008ad857
008ad842 : XOR ECX,ECX
008ad844 : MOV word ptr [EAX],CX
008ad847 : MOV byte ptr [EAX + 0x2],0x46
008ad84b : MOV byte ptr [EAX + 0x3],0x5d
008ad84f : MOV dword ptr [EAX + 0x4],ESI
008ad852 : MOV dword ptr [EAX + 0x8],EDI
008ad855 : JMP 0x008ad859
008ad857 : XOR EAX,EAX
008ad859 : MOV dword ptr [ESP + 0x58],0xffffffff
008ad861 : MOV EDX,dword ptr [0x017247d4]
008ad867 : MOV ECX,dword ptr [EDX + 0x4]
008ad86a : TEST ECX,ECX
008ad86c : JZ 0x008ad87e
008ad86e : CMP byte ptr [EDX + 0x8],0x0
008ad872 : JZ 0x008ad87e
008ad874 : PUSH 0xc
008ad876 : PUSH ECX
008ad877 : MOV EDI,EAX
008ad879 : CALL 0x00a0dd40
008ad87e : CMP BX,0x1
008ad882 : JNZ 0x008ad909
008ad888 : MOV EDX,dword ptr [0x00da9894]
008ad88e : MOV EAX,dword ptr [EDX]
008ad890 : MOV ECX,dword ptr [EAX + 0x188]
008ad896 : MOV ECX,dword ptr [ECX]
008ad898 : JMP 0x008ad900
008ad89a : CALL 0x006f4590
008ad89f : MOV dword ptr [ESP + 0x10],EAX
008ad8a3 : MOV dword ptr [ESP + 0x58],0x0
008ad8ab : TEST EAX,EAX
008ad8ad : JZ 0x008ad8c4
008ad8af : XOR EDX,EDX
008ad8b1 : MOV word ptr [EAX],DX
008ad8b4 : MOV byte ptr [EAX + 0x2],0x46
008ad8b8 : MOV byte ptr [EAX + 0x3],0x5c
008ad8bc : MOV dword ptr [EAX + 0x4],ESI
008ad8bf : MOV dword ptr [EAX + 0x8],EDI
008ad8c2 : JMP 0x008ad8c6
008ad8c4 : XOR EAX,EAX
008ad8c6 : MOV dword ptr [ESP + 0x58],0xffffffff
008ad8ce : MOV EDX,dword ptr [0x017247d4]
008ad8d4 : MOV ECX,dword ptr [EDX + 0x4]
008ad8d7 : TEST ECX,ECX
008ad8d9 : JZ 0x008ad8eb
008ad8db : CMP byte ptr [EDX + 0x8],0x0
008ad8df : JZ 0x008ad8eb
008ad8e1 : PUSH 0xc
008ad8e3 : PUSH ECX
008ad8e4 : MOV EDI,EAX
008ad8e6 : CALL 0x00a0dd40
008ad8eb : CMP BX,0x1
008ad8ef : JNZ 0x008ad909
008ad8f1 : MOV EAX,[0x00da9894]
008ad8f6 : MOV ECX,dword ptr [EAX]
008ad8f8 : MOV EDX,dword ptr [ECX + 0x188]
008ad8fe : MOV ECX,dword ptr [EDX]
008ad900 : PUSH 0x1
008ad902 : PUSH 0x1
008ad904 : CALL 0x008ad130
008ad909 : MOV ECX,dword ptr [ESP + 0x50]
008ad90d : MOV dword ptr FS:[0x0],ECX
008ad914 : POP ECX
008ad915 : POP EDI
008ad916 : POP ESI
008ad917 : POP EBX
008ad918 : MOV ESP,EBP
008ad91a : POP EBP
008ad91b : RET 0xc

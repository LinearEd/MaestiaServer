PROGRAM  : Maestia.exe
FUNCTION : FUN_00557960
ENTRY    : 00557960
BODY     : [[00557960, 00557af0]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_00557960(void)

{
  byte *pbVar1;
  int iVar2;
  int iVar3;
  int *in_ECX;
  uint uVar4;
  byte abStack_c0 [4];
  undefined4 uStack_bc;
  byte abStack_b8 [8];
  undefined1 *local_b0;
  undefined4 local_ac;
  undefined4 uStack_a8;
  undefined4 uStack_a4;
  undefined4 uStack_a0;
  undefined1 auStack_9c [16];
  int iStack_8c;
  undefined1 auStack_88 [20];
  undefined4 uStack_74;
  undefined4 uStack_70;
  undefined4 uStack_6c;
  char cStack_68;
  int iStack_58;
  float fStack_1c;
  byte bStack_18;
  
  local_ac = 0;
  local_b0 = (undefined1 *)0x0;
  (**(code **)(*in_ECX + 0x44))(&local_ac,&local_b0);
  uVar4 = 0x1505;
  iVar3 = 4;
  do {
    iVar2 = iVar3 + 3;
    iVar3 = iVar3 + -1;
    uVar4 = (uint)abStack_b8[iVar2] ^ uVar4 * 0x21;
  } while (iVar3 != 0);
  iVar3 = 4;
  do {
    iVar2 = iVar3 + -1;
    iVar3 = iVar3 + -1;
    uVar4 = (uint)abStack_b8[iVar2] ^ uVar4 * 0x21;
  } while (iVar3 != 0);
  FUN_005560e0(in_ECX);
  while (cStack_68 != '\x01') {
    uStack_a8 = uStack_74;
    uStack_a0 = uStack_6c;
    uStack_a4 = uStack_70;
    iVar3 = 0xc;
    do {
      iVar2 = iVar3 + 3;
      iVar3 = iVar3 + -1;
      uVar4 = (uint)*(byte *)((int)&local_ac + iVar2) ^ uVar4 * 0x21;
    } while (iVar3 != 0);
    local_b0 = auStack_88;
    local_ac = 0;
    if ((-1 < cStack_68) && (cStack_68 != '\x01')) {
      do {
        FUN_00553740();
      } while (cStack_68 == '\x03');
    }
    uStack_bc = (float)iStack_58;
    if ((bStack_18 & 0x80) != 0) {
      uStack_bc = fStack_1c * (float)iStack_58;
    }
    iVar3 = 8;
    do {
      pbVar1 = &stack0xffffff3f + iVar3;
      iVar3 = iVar3 + -1;
      uVar4 = (uint)*pbVar1 ^ uVar4 * 0x21;
    } while (iVar3 != 0);
    while ((local_b0[0x20] != '\x01' && ((char)local_b0[0x20] < '\0'))) {
      FUN_00554440(auStack_9c);
      for (iVar3 = iStack_8c * 4; iVar3 != 0; iVar3 = iVar3 + -1) {
        uVar4 = (uint)(byte)auStack_9c[iVar3 + -1] ^ uVar4 * 0x21;
      }
    }
  }
  return uVar4;
}



============================================================
DISASSEMBLY
============================================================
00557960 : PUSH EBP
00557961 : MOV EBP,ESP
00557963 : AND ESP,0xfffffff8
00557966 : SUB ESP,0xb4
0055796c : PUSH EBP
0055796d : PUSH ESI
0055796e : PUSH EDI
0055796f : MOV EDI,ECX
00557971 : MOV EAX,dword ptr [EDI]
00557973 : MOV EAX,dword ptr [EAX + 0x44]
00557976 : LEA ECX,[ESP + 0x18]
0055797a : PUSH ECX
0055797b : XOR EBP,EBP
0055797d : LEA EDX,[ESP + 0x20]
00557981 : PUSH EDX
00557982 : MOV ECX,EDI
00557984 : MOV dword ptr [ESP + 0x24],EBP
00557988 : MOV dword ptr [ESP + 0x20],EBP
0055798c : CALL EAX
0055798e : MOV ESI,0x1505
00557993 : MOV EAX,0x4
00557998 : MOVZX ECX,byte ptr [ESP + EAX*0x1 + 0x1b]
0055799d : DEC EAX
0055799e : MOV EDX,ESI
005579a0 : SHL EDX,0x5
005579a3 : ADD EDX,ESI
005579a5 : XOR ECX,EDX
005579a7 : MOV ESI,ECX
005579a9 : CMP EAX,EBP
005579ab : JNZ 0x00557998
005579ad : MOV EAX,0x4
005579b2 : MOVZX ECX,byte ptr [ESP + EAX*0x1 + 0x17]
005579b7 : DEC EAX
005579b8 : MOV EDX,ESI
005579ba : SHL EDX,0x5
005579bd : ADD EDX,ESI
005579bf : XOR ECX,EDX
005579c1 : MOV ESI,ECX
005579c3 : CMP EAX,EBP
005579c5 : JNZ 0x005579b2
005579c7 : PUSH EDI
005579c8 : LEA ECX,[ESP + 0x4c]
005579cc : CALL 0x005560e0
005579d1 : MOV CL,byte ptr [ESP + 0x68]
005579d5 : CMP CL,0x1
005579d8 : JZ 0x00557ae8
005579de : MOV EDI,EDI
005579e0 : MOV EAX,dword ptr [ESP + 0x5c]
005579e4 : MOV EDX,dword ptr [ESP + 0x60]
005579e8 : MOV dword ptr [ESP + 0x28],EAX
005579ec : MOV EAX,dword ptr [ESP + 0x64]
005579f0 : MOV dword ptr [ESP + 0x30],EAX
005579f4 : MOV dword ptr [ESP + 0x2c],EDX
005579f8 : MOV EAX,0xc
005579fd : LEA ECX,[ECX]
00557a00 : MOVZX EDX,byte ptr [ESP + EAX*0x1 + 0x27]
00557a05 : DEC EAX
00557a06 : MOV EDI,ESI
00557a08 : SHL EDI,0x5
00557a0b : ADD EDI,ESI
00557a0d : XOR EDX,EDI
00557a0f : MOV ESI,EDX
00557a11 : CMP EAX,EBP
00557a13 : JNZ 0x00557a00
00557a15 : LEA EAX,[ESP + 0x48]
00557a19 : MOV dword ptr [ESP + 0x20],EAX
00557a1d : MOV dword ptr [ESP + 0x24],EBP
00557a21 : TEST CL,CL
00557a23 : JS 0x00557a40
00557a25 : CMP CL,0x1
00557a28 : JZ 0x00557a40
00557a2a : LEA EBX,[EBX]
00557a30 : LEA ECX,[ESP + 0x48]
00557a34 : CALL 0x00553740
00557a39 : CMP byte ptr [ESP + 0x68],0x3
00557a3e : JZ 0x00557a30
00557a40 : TEST byte ptr [ESP + 0xb8],0x80
00557a48 : FILD dword ptr [ESP + 0x74]
00557a4c : FSTP float ptr [ESP + 0x10]
00557a50 : FILD dword ptr [ESP + 0x78]
00557a54 : FSTP float ptr [ESP + 0x14]
00557a58 : JZ 0x00557a73
00557a5a : FLD float ptr [ESP + 0xb4]
00557a61 : FLD ST0
00557a63 : FMUL float ptr [ESP + 0x10]
00557a67 : FSTP float ptr [ESP + 0x10]
00557a6b : FMUL float ptr [ESP + 0x14]
00557a6f : FSTP float ptr [ESP + 0x14]
00557a73 : MOV ECX,0x8
00557a78 : MOV EAX,ESI
00557a7a : LEA EBX,[EBX]
00557a80 : MOVZX EDX,byte ptr [ESP + ECX*0x1 + 0xf]
00557a85 : DEC ECX
00557a86 : MOV ESI,EAX
00557a88 : SHL ESI,0x5
00557a8b : ADD ESI,EAX
00557a8d : XOR EDX,ESI
00557a8f : MOV EAX,EDX
00557a91 : CMP ECX,EBP
00557a93 : JNZ 0x00557a80
00557a95 : MOV ESI,EAX
00557a97 : MOV EAX,dword ptr [ESP + 0x20]
00557a9b : MOV AL,byte ptr [EAX + 0x20]
00557a9e : CMP AL,0x1
00557aa0 : JZ 0x00557adb
00557aa2 : TEST AL,AL
00557aa4 : JNS 0x00557adb
00557aa6 : LEA ECX,[ESP + 0x34]
00557aaa : PUSH ECX
00557aab : LEA ECX,[ESP + 0x24]
00557aaf : CALL 0x00554440
00557ab4 : MOV EAX,dword ptr [ESP + 0x44]
00557ab8 : ADD EAX,EAX
00557aba : ADD EAX,EAX
00557abc : MOV ECX,ESI
00557abe : CMP EAX,EBP
00557ac0 : JZ 0x00557ad7
00557ac2 : MOVZX EDX,byte ptr [ESP + EAX*0x1 + 0x33]
00557ac7 : DEC EAX
00557ac8 : MOV ESI,ECX
00557aca : SHL ESI,0x5
00557acd : ADD ESI,ECX
00557acf : XOR EDX,ESI
00557ad1 : MOV ECX,EDX
00557ad3 : CMP EAX,EBP
00557ad5 : JNZ 0x00557ac2
00557ad7 : MOV ESI,ECX
00557ad9 : JMP 0x00557a97
00557adb : MOV CL,byte ptr [ESP + 0x68]
00557adf : CMP CL,0x1
00557ae2 : JNZ 0x005579e0
00557ae8 : POP EDI
00557ae9 : MOV EAX,ESI
00557aeb : POP ESI
00557aec : POP EBP
00557aed : MOV ESP,EBP
00557aef : POP EBP
00557af0 : RET

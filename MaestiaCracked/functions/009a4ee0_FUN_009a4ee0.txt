PROGRAM  : Maestia.exe
FUNCTION : FUN_009a4ee0
ENTRY    : 009a4ee0
BODY     : [[009a4ee0, 009a52c1]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x009a514c) */

void FUN_009a4ee0(uint param_1,int param_2)

{
  float fVar1;
  int *piVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  uint uVar8;
  int *piVar9;
  int *unaff_EDI;
  uint local_70;
  undefined4 local_4c;
  int local_48;
  int local_44;
  uint local_40;
  uint local_3c;
  int *local_38;
  int *local_34;
  undefined1 local_30 [4];
  undefined4 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b21423;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_38 = unaff_EDI + 0x1d;
  if (param_1 != 0) {
    local_38 = unaff_EDI + 0x21;
  }
  iVar5 = local_38[2] - local_38[1] >> 2;
  if (iVar5 == 0) {
    FUN_00406460();
    local_8 = 0;
    if ((int *)*DAT_00da98e8 != (int *)0x0) {
      (**(code **)(*(int *)*DAT_00da98e8 + 0x14))(L"AvaGuiEmoticon::ShowEmoticons",0x249,local_30);
    }
    local_8 = 0xffffffff;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c = (uint)local_2c._2_2_ << 0x10;
  }
  else {
    uVar3 = *(int *)(unaff_EDI[0xf] + 0xc) * *(int *)(unaff_EDI[0xf] + 8);
    fVar1 = (float)iVar5;
    if (iVar5 < 0) {
      fVar1 = fVar1 + 4.2949673e+09;
    }
    local_44 = iVar5;
    local_40 = uVar3;
    FUN_00638370((double)(fVar1 / (float)(int)uVar3),local_14);
    uVar4 = FUN_0063b380();
    uVar8 = (uint)*(ushort *)((int)unaff_EDI + 0x96);
    uVar6 = (uint)*(ushort *)(unaff_EDI + 0x25) + param_2;
    if ((int)uVar8 < (int)((uint)*(ushort *)(unaff_EDI + 0x25) + param_2)) {
      uVar6 = uVar8;
    }
    if ((int)uVar6 < 1) {
      uVar6 = 1;
    }
    if (((*(ushort *)(unaff_EDI + 0x25) != uVar6) || (uVar8 != uVar4)) ||
       (*(ushort *)(unaff_EDI + 0x26) != param_1)) {
      *(undefined2 *)(unaff_EDI + 0x26) = (undefined2)param_1;
      piVar9 = DAT_00da9894;
      *(short *)(unaff_EDI + 0x25) = (short)uVar6;
      *(short *)((int)unaff_EDI + 0x96) = (short)uVar4;
      iVar5 = *piVar9;
      if ((iVar5 != 0) && (*(int *)(iVar5 + 0x114) != 0)) {
        (**(code **)(**(int **)(iVar5 + 0x114) + 4))
                  (*(int **)(iVar5 + 0x114),"mc_emoticon.EmoticonSetPage","%d,%d",uVar6 & 0xffff,
                   uVar4 & 0xffff);
      }
      (**(code **)(*unaff_EDI + 0x80))();
      iVar5 = (*(ushort *)(unaff_EDI + 0x25) - 1) * uVar3;
      iVar7 = local_38[2] - local_38[1] >> 2;
      local_3c = 0;
      if (iVar7 < iVar5) {
        FUN_00404750(L"Over size... container size: %d / start index : %d",iVar7,iVar5);
        local_8 = 1;
        if ((int *)*DAT_00da98e8 != (int *)0x0) {
          (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                    (L"AvaGuiEmoticon::ShowEmoticons",0x271,local_30);
        }
        local_8 = 0xffffffff;
        if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_18 = 7;
        local_1c = 0;
        local_2c = (uint)local_2c._2_2_ << 0x10;
      }
      else {
        local_34 = (int *)(local_38[1] + iVar5 * 4);
        piVar9 = local_38;
        if (local_34 != (int *)local_38[2]) {
          do {
            piVar2 = local_34;
            if (*local_34 == 0) {
              FUN_00406360(L"Iterator is null!!",0x12);
              local_8 = 2;
              if ((int *)*DAT_00da98e8 != (int *)0x0) {
                (**(code **)(*(int *)*DAT_00da98e8 + 0x14))(L"AvaGuiEmoticon::ShowEmoticons");
              }
              local_8 = 0xffffffff;
              local_34 = piVar2 + 1;
            }
            else {
              iVar5 = FUN_009f2740();
              if (((iVar5 == 0) || (FUN_004437f0(), local_48 == *(int *)(iVar5 + 0xc))) ||
                 (iVar5 = *(int *)(local_48 + 0x10), iVar5 == 0)) {
                FUN_00404750(L"Can\'t find item.. proto : %u / key : %u",*(undefined4 *)*local_34,
                             ((undefined4 *)*local_34)[1]);
                local_8 = 3;
                FUN_00406460();
                local_8._0_1_ = 4;
                if ((int *)*DAT_00da98e8 != (int *)0x0) {
                  (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                            (L"AvaGuiEmoticon::ShowEmoticons",0x287);
                }
                local_8 = CONCAT31(local_8._1_3_,3);
                if (7 < local_70) {
                    /* WARNING: Subroutine does not return */
                  FUN_006f04e0();
                }
                local_70 = 7;
                local_8 = 0xffffffff;
                if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
                  FUN_006f04e0();
                }
                local_18 = 7;
                local_1c = 0;
                local_2c = local_2c & 0xffff0000;
              }
              else {
                (**(code **)(*unaff_EDI + 0x9c))(&local_44);
                (**(code **)(*unaff_EDI + 0x70))(iVar5,local_44,local_4c);
              }
              local_34 = local_34 + 1;
              local_3c = local_3c + 1;
              piVar9 = local_38;
              if ((local_3c & 0xffff) == local_40) break;
            }
          } while (local_34 != (int *)piVar9[2]);
        }
      }
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
009a4ee0 : PUSH EBP
009a4ee1 : MOV EBP,ESP
009a4ee3 : PUSH -0x1
009a4ee5 : PUSH 0xb21423
009a4eea : MOV EAX,FS:[0x0]
009a4ef0 : PUSH EAX
009a4ef1 : SUB ESP,0x78
009a4ef4 : MOV EAX,[0x00d66fa0]
009a4ef9 : XOR EAX,EBP
009a4efb : MOV dword ptr [EBP + -0x10],EAX
009a4efe : PUSH EBX
009a4eff : PUSH ESI
009a4f00 : PUSH EAX
009a4f01 : LEA EAX,[EBP + -0xc]
009a4f04 : MOV FS:[0x0],EAX
009a4f0a : XOR ESI,ESI
009a4f0c : LEA EAX,[EDI + 0x74]
009a4f0f : CMP dword ptr [EBP + 0x8],ESI
009a4f12 : JZ 0x009a4f1a
009a4f14 : LEA EAX,[EDI + 0x84]
009a4f1a : MOV ECX,dword ptr [EAX + 0x8]
009a4f1d : SUB ECX,dword ptr [EAX + 0x4]
009a4f20 : MOV dword ptr [EBP + -0x34],EAX
009a4f23 : SAR ECX,0x2
009a4f26 : CMP ECX,ESI
009a4f28 : JNZ 0x009a4f85
009a4f2a : PUSH 0xc89c18
009a4f2f : LEA ECX,[EBP + -0x2c]
009a4f32 : CALL 0x00406460
009a4f37 : MOV dword ptr [EBP + -0x4],ESI
009a4f3a : MOV ECX,dword ptr [0x00da98e8]
009a4f40 : MOV ECX,dword ptr [ECX]
009a4f42 : CMP ECX,ESI
009a4f44 : JZ 0x009a4f5b
009a4f46 : MOV EDX,dword ptr [ECX]
009a4f48 : MOV EDX,dword ptr [EDX + 0x14]
009a4f4b : LEA EAX,[EBP + -0x2c]
009a4f4e : PUSH EAX
009a4f4f : PUSH 0x249
009a4f54 : PUSH 0xc89c3c
009a4f59 : CALL EDX
009a4f5b : MOV dword ptr [EBP + -0x4],0xffffffff
009a4f62 : CMP dword ptr [EBP + -0x14],0x8
009a4f66 : JC 0x009a4f70
009a4f68 : MOV ECX,dword ptr [EBP + -0x28]
009a4f6b : CALL 0x006f04e0
009a4f70 : XOR EAX,EAX
009a4f72 : MOV dword ptr [EBP + -0x14],0x7
009a4f79 : MOV dword ptr [EBP + -0x18],ESI
009a4f7c : MOV word ptr [EBP + -0x28],AX
009a4f80 : JMP 0x009a52a5
009a4f85 : MOV EAX,dword ptr [EDI + 0x3c]
009a4f88 : MOV EDX,dword ptr [EAX + 0x8]
009a4f8b : MOV EAX,dword ptr [EAX + 0xc]
009a4f8e : IMUL EAX,EDX
009a4f91 : MOV ESI,EAX
009a4f93 : MOV dword ptr [EBP + -0x40],ECX
009a4f96 : MOV dword ptr [EBP + -0x3c],ESI
009a4f99 : FILD dword ptr [EBP + -0x40]
009a4f9c : TEST ECX,ECX
009a4f9e : JGE 0x009a4fa6
009a4fa0 : FADD float ptr [0x00cdf0e0]
009a4fa6 : FIDIV dword ptr [EBP + -0x3c]
009a4fa9 : SUB ESP,0x8
009a4fac : FSTP double ptr [ESP]
009a4faf : CALL 0x00638370
009a4fb4 : ADD ESP,0x8
009a4fb7 : CALL 0x0063b380
009a4fbc : MOVZX ECX,word ptr [EDI + 0x94]
009a4fc3 : ADD ECX,dword ptr [EBP + 0xc]
009a4fc6 : MOVZX EDX,word ptr [EDI + 0x96]
009a4fcd : CMP ECX,EDX
009a4fcf : CMOVG ECX,EDX
009a4fd2 : CMP ECX,0x1
009a4fd5 : JGE 0x009a4fdc
009a4fd7 : MOV ECX,0x1
009a4fdc : MOVZX EBX,word ptr [EDI + 0x94]
009a4fe3 : CMP EBX,ECX
009a4fe5 : JNZ 0x009a4ffb
009a4fe7 : CMP EDX,EAX
009a4fe9 : JNZ 0x009a4ffb
009a4feb : MOVZX EDX,word ptr [EDI + 0x98]
009a4ff2 : CMP EDX,dword ptr [EBP + 0x8]
009a4ff5 : JZ 0x009a52a5
009a4ffb : MOV DX,word ptr [EBP + 0x8]
009a4fff : MOV word ptr [EDI + 0x98],DX
009a5006 : MOV EDX,dword ptr [0x00da9894]
009a500c : MOV word ptr [EDI + 0x94],CX
009a5013 : MOV word ptr [EDI + 0x96],AX
009a501a : MOV EDX,dword ptr [EDX]
009a501c : TEST EDX,EDX
009a501e : JZ 0x009a504c
009a5020 : CMP dword ptr [EDX + 0x114],0x0
009a5027 : JZ 0x009a504c
009a5029 : MOV EDX,dword ptr [EDX + 0x114]
009a502f : MOV EBX,dword ptr [EDX]
009a5031 : MOVZX EAX,AX
009a5034 : PUSH EAX
009a5035 : MOVZX ECX,CX
009a5038 : PUSH ECX
009a5039 : PUSH 0xc89c78
009a503e : PUSH 0xc89c80
009a5043 : PUSH EDX
009a5044 : MOV EDX,dword ptr [EBX + 0x4]
009a5047 : CALL EDX
009a5049 : ADD ESP,0x14
009a504c : MOV EAX,dword ptr [EDI]
009a504e : MOV EDX,dword ptr [EAX + 0x80]
009a5054 : MOV ECX,EDI
009a5056 : CALL EDX
009a5058 : MOVZX EAX,word ptr [EDI + 0x94]
009a505f : MOV EBX,dword ptr [EBP + -0x34]
009a5062 : MOV EDX,dword ptr [EBX + 0x8]
009a5065 : DEC EAX
009a5066 : IMUL EAX,ESI
009a5069 : MOV ESI,dword ptr [EBX + 0x4]
009a506c : MOV ECX,EDX
009a506e : SUB ECX,ESI
009a5070 : SAR ECX,0x2
009a5073 : CMP ECX,EAX
009a5075 : MOV dword ptr [EBP + -0x38],0x0
009a507c : JGE 0x009a50e4
009a507e : PUSH EAX
009a507f : PUSH ECX
009a5080 : PUSH 0xc89cd8
009a5085 : LEA ESI,[EBP + -0x2c]
009a5088 : CALL 0x00404750
009a508d : ADD ESP,0xc
009a5090 : MOV dword ptr [EBP + -0x4],0x1
009a5097 : MOV EAX,[0x00da98e8]
009a509c : MOV ECX,dword ptr [EAX]
009a509e : TEST ECX,ECX
009a50a0 : JZ 0x009a50b6
009a50a2 : MOV EDX,dword ptr [ECX]
009a50a4 : MOV EDX,dword ptr [EDX + 0x14]
009a50a7 : MOV EAX,ESI
009a50a9 : PUSH EAX
009a50aa : PUSH 0x271
009a50af : PUSH 0xc89c9c
009a50b4 : CALL EDX
009a50b6 : MOV dword ptr [EBP + -0x4],0xffffffff
009a50bd : CMP dword ptr [EBP + -0x14],0x8
009a50c1 : JC 0x009a50cb
009a50c3 : MOV ECX,dword ptr [EBP + -0x28]
009a50c6 : CALL 0x006f04e0
009a50cb : XOR EAX,EAX
009a50cd : MOV dword ptr [EBP + -0x14],0x7
009a50d4 : MOV dword ptr [EBP + -0x18],0x0
009a50db : MOV word ptr [EBP + -0x28],AX
009a50df : JMP 0x009a52a5
009a50e4 : LEA ESI,[ESI + EAX*0x4]
009a50e7 : MOV dword ptr [EBP + -0x30],ESI
009a50ea : CMP ESI,EDX
009a50ec : JZ 0x009a52a5
009a50f2 : MOV EAX,dword ptr [ESI]
009a50f4 : TEST EAX,EAX
009a50f6 : JNZ 0x009a5173
009a50f8 : XOR ECX,ECX
009a50fa : PUSH 0x12
009a50fc : MOV word ptr [EBP + -0x64],CX
009a5100 : PUSH 0xc89d40
009a5105 : LEA ECX,[EBP + -0x68]
009a5108 : MOV dword ptr [EBP + -0x50],0x7
009a510f : MOV dword ptr [EBP + -0x54],EAX
009a5112 : CALL 0x00406360
009a5117 : MOV dword ptr [EBP + -0x4],0x2
009a511e : MOV EDX,dword ptr [0x00da98e8]
009a5124 : MOV ECX,dword ptr [EDX]
009a5126 : TEST ECX,ECX
009a5128 : JZ 0x009a513f
009a512a : MOV EAX,dword ptr [ECX]
009a512c : MOV EAX,dword ptr [EAX + 0x14]
009a512f : LEA EDX,[EBP + -0x68]
009a5132 : PUSH EDX
009a5133 : PUSH 0x279
009a5138 : PUSH 0xc89d68
009a513d : CALL EAX
009a513f : MOV dword ptr [EBP + -0x4],0xffffffff
009a5146 : CMP dword ptr [EBP + -0x50],0x8
009a514a : JC 0x009a5154
009a514c : MOV ECX,dword ptr [EBP + -0x64]
009a514f : CALL 0x006f04e0
009a5154 : XOR ECX,ECX
009a5156 : ADD ESI,0x4
009a5159 : MOV dword ptr [EBP + -0x50],0x7
009a5160 : MOV dword ptr [EBP + -0x54],0x0
009a5167 : MOV word ptr [EBP + -0x64],CX
009a516b : MOV dword ptr [EBP + -0x30],ESI
009a516e : JMP 0x009a529c
009a5173 : MOV EBX,dword ptr [EAX + 0x4]
009a5176 : MOV EAX,dword ptr [EAX]
009a5178 : MOV ECX,dword ptr [0x017247f0]
009a517e : PUSH EAX
009a517f : CALL 0x009f2740
009a5184 : MOV ESI,EAX
009a5186 : TEST ESI,ESI
009a5188 : JZ 0x009a51d8
009a518a : LEA EDX,[EBP + -0x4c]
009a518d : PUSH EDX
009a518e : LEA ECX,[ESI + 0x8]
009a5191 : LEA EAX,[EBP + -0x44]
009a5194 : MOV dword ptr [EBP + -0x4c],EBX
009a5197 : CALL 0x004437f0
009a519c : MOV ESI,dword ptr [ESI + 0xc]
009a519f : MOV EAX,dword ptr [EBP + -0x44]
009a51a2 : CMP EAX,ESI
009a51a4 : JZ 0x009a51d8
009a51a6 : MOV ESI,dword ptr [EAX + 0x10]
009a51a9 : TEST ESI,ESI
009a51ab : JZ 0x009a51d8
009a51ad : MOV EAX,dword ptr [EDI]
009a51af : MOV EAX,dword ptr [EAX + 0x9c]
009a51b5 : LEA ECX,[EBP + -0x48]
009a51b8 : PUSH ECX
009a51b9 : LEA EDX,[EBP + -0x40]
009a51bc : PUSH EDX
009a51bd : MOV ECX,EDI
009a51bf : CALL EAX
009a51c1 : MOV EAX,dword ptr [EBP + -0x48]
009a51c4 : MOV ECX,dword ptr [EBP + -0x40]
009a51c7 : MOV EDX,dword ptr [EDI]
009a51c9 : MOV EDX,dword ptr [EDX + 0x70]
009a51cc : PUSH EAX
009a51cd : PUSH ECX
009a51ce : PUSH ESI
009a51cf : MOV ECX,EDI
009a51d1 : CALL EDX
009a51d3 : JMP 0x009a5283
009a51d8 : MOV EAX,dword ptr [EBP + -0x30]
009a51db : MOV EAX,dword ptr [EAX]
009a51dd : MOV ECX,dword ptr [EAX + 0x4]
009a51e0 : MOV EDX,dword ptr [EAX]
009a51e2 : PUSH ECX
009a51e3 : PUSH EDX
009a51e4 : PUSH 0xc89de0
009a51e9 : LEA ESI,[EBP + -0x2c]
009a51ec : CALL 0x00404750
009a51f1 : ADD ESP,0xc
009a51f4 : MOV dword ptr [EBP + -0x4],0x3
009a51fb : MOV EAX,dword ptr [EBP + -0x28]
009a51fe : MOV ESI,0x8
009a5203 : CMP dword ptr [EBP + -0x14],ESI
009a5206 : JNC 0x009a520b
009a5208 : LEA EAX,[EBP + -0x28]
009a520b : PUSH EAX
009a520c : LEA ECX,[EBP + 0xffffff7c]
009a5212 : CALL 0x00406460
009a5217 : MOV byte ptr [EBP + -0x4],0x4
009a521b : MOV EAX,[0x00da98e8]
009a5220 : MOV ECX,dword ptr [EAX]
009a5222 : XOR EBX,EBX
009a5224 : CMP ECX,EBX
009a5226 : JZ 0x009a5240
009a5228 : MOV EDX,dword ptr [ECX]
009a522a : MOV EDX,dword ptr [EDX + 0x14]
009a522d : LEA EAX,[EBP + 0xffffff7c]
009a5233 : PUSH EAX
009a5234 : PUSH 0x287
009a5239 : PUSH 0xc89da4
009a523e : CALL EDX
009a5240 : MOV byte ptr [EBP + -0x4],0x3
009a5244 : CMP dword ptr [EBP + -0x6c],ESI
009a5247 : JC 0x009a5251
009a5249 : MOV ECX,dword ptr [EBP + -0x80]
009a524c : CALL 0x006f04e0
009a5251 : MOV ESI,0x7
009a5256 : XOR EAX,EAX
009a5258 : MOV dword ptr [EBP + -0x6c],ESI
009a525b : MOV dword ptr [EBP + -0x70],EBX
009a525e : MOV word ptr [EBP + -0x80],AX
009a5262 : MOV dword ptr [EBP + -0x4],0xffffffff
009a5269 : CMP dword ptr [EBP + -0x14],0x8
009a526d : JC 0x009a5277
009a526f : MOV ECX,dword ptr [EBP + -0x28]
009a5272 : CALL 0x006f04e0
009a5277 : XOR ECX,ECX
009a5279 : MOV dword ptr [EBP + -0x14],ESI
009a527c : MOV dword ptr [EBP + -0x18],EBX
009a527f : MOV word ptr [EBP + -0x28],CX
009a5283 : MOV EAX,dword ptr [EBP + -0x38]
009a5286 : ADD dword ptr [EBP + -0x30],0x4
009a528a : INC EAX
009a528b : MOVZX EDX,AX
009a528e : MOV dword ptr [EBP + -0x38],EAX
009a5291 : CMP EDX,dword ptr [EBP + -0x3c]
009a5294 : JZ 0x009a52a5
009a5296 : MOV ESI,dword ptr [EBP + -0x30]
009a5299 : MOV EBX,dword ptr [EBP + -0x34]
009a529c : CMP ESI,dword ptr [EBX + 0x8]
009a529f : JNZ 0x009a50f2
009a52a5 : MOV ECX,dword ptr [EBP + -0xc]
009a52a8 : MOV dword ptr FS:[0x0],ECX
009a52af : POP ECX
009a52b0 : POP ESI
009a52b1 : POP EBX
009a52b2 : MOV ECX,dword ptr [EBP + -0x10]
009a52b5 : XOR ECX,EBP
009a52b7 : CALL 0x00633e6b
009a52bc : MOV ESP,EBP
009a52be : POP EBP
009a52bf : RET 0x8

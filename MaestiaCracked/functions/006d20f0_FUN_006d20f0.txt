PROGRAM  : Maestia.exe
FUNCTION : FUN_006d20f0
ENTRY    : 006d20f0
BODY     : [[006d20f0, 006d2302]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006d20f0(int param_1,undefined4 param_2,int param_3)

{
  char *pcVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  char *local_14;
  int local_10;
  int local_8;
  
  if ((*(uint *)(param_1 + 0x68) & 1) == 0) {
    FUN_006c23a0(param_1,"Missing IHDR before zTXt");
  }
  if ((*(uint *)(param_1 + 0x68) & 4) != 0) {
    *(uint *)(param_1 + 0x68) = *(uint *)(param_1 + 0x68) | 8;
  }
  pcVar1 = (char *)FUN_006cef50(param_1,param_3 + 1);
  if (pcVar1 == (char *)0x0) {
    FUN_006c24c0(param_1,"Out of memory processing zTXt chunk.");
  }
  else {
    FUN_006cf100(param_1,pcVar1,param_3);
    iVar2 = FUN_006cf140(param_1,0);
    if (iVar2 == 0) {
      pcVar1[param_3] = '\0';
      for (local_14 = pcVar1; *local_14 != '\0'; local_14 = local_14 + 1) {
      }
      if (local_14 == pcVar1 + param_3) {
        local_10 = -1;
        FUN_006c24c0(param_1,"Zero length zTXt chunk");
      }
      else {
        local_10 = (int)local_14[1];
        if (local_10 != 0) {
          FUN_006c24c0(param_1,"Unknown compression type in zTXt chunk");
          local_10 = 0;
        }
        local_14 = local_14 + 2;
      }
      iVar2 = FUN_006cf2c0(param_1,local_10,pcVar1,param_3,(int)local_14 - (int)pcVar1,&local_8);
      piVar3 = (int *)FUN_006cef50(param_1,0x10);
      if (piVar3 == (int *)0x0) {
        FUN_006c24c0(param_1,"Not enough memory to process zTXt chunk.");
        FUN_006ceee0(param_1,iVar2);
      }
      else {
        *piVar3 = local_10;
        piVar3[1] = iVar2;
        piVar3[2] = iVar2 + ((int)local_14 - (int)pcVar1);
        piVar3[3] = local_8;
        iVar4 = FUN_006ce520(param_1,param_2,piVar3,1);
        FUN_006ceee0(param_1,piVar3);
        FUN_006ceee0(param_1,iVar2);
        if (iVar4 != 0) {
          FUN_006c23a0(param_1,"Insufficient memory to store zTXt chunk.");
        }
      }
    }
    else {
      FUN_006ceee0(param_1,pcVar1);
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
006d20f0 : PUSH EBP
006d20f1 : MOV EBP,ESP
006d20f3 : SUB ESP,0x20
006d20f6 : MOV EAX,dword ptr [EBP + 0x8]
006d20f9 : MOV ECX,dword ptr [EAX + 0x68]
006d20fc : AND ECX,0x1
006d20ff : JNZ 0x006d2112
006d2101 : PUSH 0xbeee14
006d2106 : MOV EDX,dword ptr [EBP + 0x8]
006d2109 : PUSH EDX
006d210a : CALL 0x006c23a0
006d210f : ADD ESP,0x8
006d2112 : MOV EAX,dword ptr [EBP + 0x8]
006d2115 : MOV ECX,dword ptr [EAX + 0x68]
006d2118 : AND ECX,0x4
006d211b : JZ 0x006d212c
006d211d : MOV EDX,dword ptr [EBP + 0x8]
006d2120 : MOV EAX,dword ptr [EDX + 0x68]
006d2123 : OR EAX,0x8
006d2126 : MOV ECX,dword ptr [EBP + 0x8]
006d2129 : MOV dword ptr [ECX + 0x68],EAX
006d212c : MOV EDX,dword ptr [EBP + 0x10]
006d212f : ADD EDX,0x1
006d2132 : PUSH EDX
006d2133 : MOV EAX,dword ptr [EBP + 0x8]
006d2136 : PUSH EAX
006d2137 : CALL 0x006cef50
006d213c : ADD ESP,0x8
006d213f : MOV dword ptr [EBP + -0x18],EAX
006d2142 : CMP dword ptr [EBP + -0x18],0x0
006d2146 : JNZ 0x006d215e
006d2148 : PUSH 0xbeedec
006d214d : MOV ECX,dword ptr [EBP + 0x8]
006d2150 : PUSH ECX
006d2151 : CALL 0x006c24c0
006d2156 : ADD ESP,0x8
006d2159 : JMP 0x006d22ff
006d215e : MOV EDX,dword ptr [EBP + 0x10]
006d2161 : MOV dword ptr [EBP + -0x8],EDX
006d2164 : MOV EAX,dword ptr [EBP + -0x8]
006d2167 : PUSH EAX
006d2168 : MOV ECX,dword ptr [EBP + -0x18]
006d216b : PUSH ECX
006d216c : MOV EDX,dword ptr [EBP + 0x8]
006d216f : PUSH EDX
006d2170 : CALL 0x006cf100
006d2175 : ADD ESP,0xc
006d2178 : PUSH 0x0
006d217a : MOV EAX,dword ptr [EBP + 0x8]
006d217d : PUSH EAX
006d217e : CALL 0x006cf140
006d2183 : ADD ESP,0x8
006d2186 : TEST EAX,EAX
006d2188 : JZ 0x006d219f
006d218a : MOV ECX,dword ptr [EBP + -0x18]
006d218d : PUSH ECX
006d218e : MOV EDX,dword ptr [EBP + 0x8]
006d2191 : PUSH EDX
006d2192 : CALL 0x006ceee0
006d2197 : ADD ESP,0x8
006d219a : JMP 0x006d22ff
006d219f : MOV EAX,dword ptr [EBP + -0x18]
006d21a2 : ADD EAX,dword ptr [EBP + -0x8]
006d21a5 : MOV byte ptr [EAX],0x0
006d21a8 : MOV ECX,dword ptr [EBP + -0x18]
006d21ab : MOV dword ptr [EBP + -0x10],ECX
006d21ae : JMP 0x006d21b9
006d21b0 : MOV EDX,dword ptr [EBP + -0x10]
006d21b3 : ADD EDX,0x1
006d21b6 : MOV dword ptr [EBP + -0x10],EDX
006d21b9 : MOV EAX,dword ptr [EBP + -0x10]
006d21bc : MOVSX ECX,byte ptr [EAX]
006d21bf : TEST ECX,ECX
006d21c1 : JZ 0x006d21c5
006d21c3 : JMP 0x006d21b0
006d21c5 : MOV EDX,dword ptr [EBP + -0x18]
006d21c8 : ADD EDX,dword ptr [EBP + -0x8]
006d21cb : CMP dword ptr [EBP + -0x10],EDX
006d21ce : JNZ 0x006d21ea
006d21d0 : MOV dword ptr [EBP + -0xc],0xffffffff
006d21d7 : PUSH 0xbeedd4
006d21dc : MOV EAX,dword ptr [EBP + 0x8]
006d21df : PUSH EAX
006d21e0 : CALL 0x006c24c0
006d21e5 : ADD ESP,0x8
006d21e8 : JMP 0x006d2223
006d21ea : MOV ECX,dword ptr [EBP + -0x10]
006d21ed : ADD ECX,0x1
006d21f0 : MOV dword ptr [EBP + -0x10],ECX
006d21f3 : MOV EDX,dword ptr [EBP + -0x10]
006d21f6 : MOVSX EAX,byte ptr [EDX]
006d21f9 : MOV dword ptr [EBP + -0xc],EAX
006d21fc : CMP dword ptr [EBP + -0xc],0x0
006d2200 : JZ 0x006d221a
006d2202 : PUSH 0xbeedac
006d2207 : MOV ECX,dword ptr [EBP + 0x8]
006d220a : PUSH ECX
006d220b : CALL 0x006c24c0
006d2210 : ADD ESP,0x8
006d2213 : MOV dword ptr [EBP + -0xc],0x0
006d221a : MOV EDX,dword ptr [EBP + -0x10]
006d221d : ADD EDX,0x1
006d2220 : MOV dword ptr [EBP + -0x10],EDX
006d2223 : MOV EAX,dword ptr [EBP + -0x10]
006d2226 : SUB EAX,dword ptr [EBP + -0x18]
006d2229 : MOV dword ptr [EBP + -0x14],EAX
006d222c : LEA ECX,[EBP + -0x4]
006d222f : PUSH ECX
006d2230 : MOV EDX,dword ptr [EBP + -0x14]
006d2233 : PUSH EDX
006d2234 : MOV EAX,dword ptr [EBP + 0x10]
006d2237 : PUSH EAX
006d2238 : MOV ECX,dword ptr [EBP + -0x18]
006d223b : PUSH ECX
006d223c : MOV EDX,dword ptr [EBP + -0xc]
006d223f : PUSH EDX
006d2240 : MOV EAX,dword ptr [EBP + 0x8]
006d2243 : PUSH EAX
006d2244 : CALL 0x006cf2c0
006d2249 : ADD ESP,0x18
006d224c : MOV dword ptr [EBP + -0x18],EAX
006d224f : PUSH 0x10
006d2251 : MOV ECX,dword ptr [EBP + 0x8]
006d2254 : PUSH ECX
006d2255 : CALL 0x006cef50
006d225a : ADD ESP,0x8
006d225d : MOV dword ptr [EBP + -0x20],EAX
006d2260 : CMP dword ptr [EBP + -0x20],0x0
006d2264 : JNZ 0x006d2289
006d2266 : PUSH 0xbeed80
006d226b : MOV EDX,dword ptr [EBP + 0x8]
006d226e : PUSH EDX
006d226f : CALL 0x006c24c0
006d2274 : ADD ESP,0x8
006d2277 : MOV EAX,dword ptr [EBP + -0x18]
006d227a : PUSH EAX
006d227b : MOV ECX,dword ptr [EBP + 0x8]
006d227e : PUSH ECX
006d227f : CALL 0x006ceee0
006d2284 : ADD ESP,0x8
006d2287 : JMP 0x006d22ff
006d2289 : MOV EDX,dword ptr [EBP + -0x20]
006d228c : MOV EAX,dword ptr [EBP + -0xc]
006d228f : MOV dword ptr [EDX],EAX
006d2291 : MOV ECX,dword ptr [EBP + -0x20]
006d2294 : MOV EDX,dword ptr [EBP + -0x18]
006d2297 : MOV dword ptr [ECX + 0x4],EDX
006d229a : MOV EAX,dword ptr [EBP + -0x18]
006d229d : ADD EAX,dword ptr [EBP + -0x14]
006d22a0 : MOV ECX,dword ptr [EBP + -0x20]
006d22a3 : MOV dword ptr [ECX + 0x8],EAX
006d22a6 : MOV EDX,dword ptr [EBP + -0x20]
006d22a9 : MOV EAX,dword ptr [EBP + -0x4]
006d22ac : MOV dword ptr [EDX + 0xc],EAX
006d22af : PUSH 0x1
006d22b1 : MOV ECX,dword ptr [EBP + -0x20]
006d22b4 : PUSH ECX
006d22b5 : MOV EDX,dword ptr [EBP + 0xc]
006d22b8 : PUSH EDX
006d22b9 : MOV EAX,dword ptr [EBP + 0x8]
006d22bc : PUSH EAX
006d22bd : CALL 0x006ce520
006d22c2 : ADD ESP,0x10
006d22c5 : MOV dword ptr [EBP + -0x1c],EAX
006d22c8 : MOV ECX,dword ptr [EBP + -0x20]
006d22cb : PUSH ECX
006d22cc : MOV EDX,dword ptr [EBP + 0x8]
006d22cf : PUSH EDX
006d22d0 : CALL 0x006ceee0
006d22d5 : ADD ESP,0x8
006d22d8 : MOV EAX,dword ptr [EBP + -0x18]
006d22db : PUSH EAX
006d22dc : MOV ECX,dword ptr [EBP + 0x8]
006d22df : PUSH ECX
006d22e0 : CALL 0x006ceee0
006d22e5 : ADD ESP,0x8
006d22e8 : CMP dword ptr [EBP + -0x1c],0x0
006d22ec : JZ 0x006d22ff
006d22ee : PUSH 0xbeed54
006d22f3 : MOV EDX,dword ptr [EBP + 0x8]
006d22f6 : PUSH EDX
006d22f7 : CALL 0x006c23a0
006d22fc : ADD ESP,0x8
006d22ff : MOV ESP,EBP
006d2301 : POP EBP
006d2302 : RET

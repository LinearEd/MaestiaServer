PROGRAM  : Maestia.exe
FUNCTION : FUN_0053dc30
ENTRY    : 0053dc30
BODY     : [[0053dc30, 0053de79]]

============================================================
DECOMPILED C CODE
============================================================

bool FUN_0053dc30(undefined4 *param_1,int *param_2)

{
  uint *puVar1;
  char cVar2;
  ushort *puVar3;
  bool bVar4;
  uint uVar5;
  int iVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  int in_ECX;
  uint uVar9;
  
  if (*(int *)(in_ECX + 4) == 3) {
    puVar1 = (uint *)(in_ECX + 8);
    *param_1 = *(undefined4 *)(in_ECX + 8);
    *param_2 = 0;
    cVar2 = *(char *)(in_ECX + 0x18);
    bVar4 = false;
    *(undefined1 *)(in_ECX + 0x18) = 1;
    if ((cVar2 == '\0') && (*(short *)*puVar1 == 0x26)) {
      FUN_0053bdd0();
    }
    if (*puVar1 < *(uint *)(in_ECX + 0x10)) {
      do {
        if ((*(uint *)(in_ECX + 0x14) == 0x3c) &&
           ((*(char *)(in_ECX + 0x18) == '\0' || (*(short *)*puVar1 != 0x26)))) break;
        uVar5 = *(uint *)(in_ECX + 0x14) & 0xffff;
        uVar9 = (uint)*(ushort *)(&DAT_00b88408 + (uVar5 >> 8) * 2);
        if ((uVar9 == 0) ||
           (((uVar9 != 1 &&
             ((1 << ((byte)uVar5 & 0xf) &
              (uint)*(ushort *)(&DAT_00b88408 + ((uVar5 >> 4 & 0xf) + uVar9) * 2)) == 0)) ||
            (*(char *)(in_ECX + 0x28) == '\0')))) {
          if ((*(char *)(in_ECX + 0x18) == '\0') || (*(short *)*puVar1 != 0x26)) {
            if (bVar4) {
              FUN_0053b7f0(*puVar1,(int)(*(int *)(in_ECX + 0xc) - *puVar1) >> 1);
            }
            else {
              *param_2 = *param_2 + ((int)(*(int *)(in_ECX + 0xc) - *puVar1) >> 1);
            }
          }
          else {
            if (!bVar4) {
              *(undefined4 *)(in_ECX + 0x24) = 0;
              FUN_0053b7f0(*param_1,*param_2);
              bVar4 = true;
            }
            uVar7 = *(undefined4 *)(in_ECX + 0x14);
            if (*(uint *)(in_ECX + 0x20) < *(int *)(in_ECX + 0x24) + 6U) {
              iVar6 = *(uint *)(in_ECX + 0x20) + 6;
              *(int *)(in_ECX + 0x20) = iVar6;
              iVar6 = iVar6 * 2;
              if (*(int *)(in_ECX + 0x1c) == 0) {
                uVar8 = FUN_00515840(iVar6,0);
              }
              else {
                uVar8 = FUN_00515c80(*(int *)(in_ECX + 0x1c),iVar6);
              }
              *(undefined4 *)(in_ECX + 0x1c) = uVar8;
            }
            *(short *)(*(int *)(in_ECX + 0x1c) + *(int *)(in_ECX + 0x24) * 2) = (short)uVar7;
            *(int *)(in_ECX + 0x24) = *(int *)(in_ECX + 0x24) + 1;
          }
          puVar3 = *(ushort **)(in_ECX + 0xc);
          *puVar1 = (uint)puVar3;
          if ((*(char *)(in_ECX + 0x18) == '\0') || (*puVar3 != 0x26)) {
            if (puVar3 < *(ushort **)(in_ECX + 0x10)) {
              *(uint *)(in_ECX + 0x14) = (uint)*puVar3;
              *(ushort **)(in_ECX + 0xc) = puVar3 + 1;
            }
          }
          else {
            FUN_0053bdd0();
          }
        }
        else {
          if (!bVar4) {
            *(undefined4 *)(in_ECX + 0x24) = 0;
            FUN_0053b7f0(*param_1,*param_2);
            bVar4 = true;
          }
          if (*(uint *)(in_ECX + 0x20) < *(int *)(in_ECX + 0x24) + 6U) {
            iVar6 = *(uint *)(in_ECX + 0x20) + 6;
            *(int *)(in_ECX + 0x20) = iVar6;
            iVar6 = iVar6 * 2;
            if (*(int *)(in_ECX + 0x1c) == 0) {
              uVar7 = FUN_00515840(iVar6,0);
            }
            else {
              uVar7 = FUN_00515c80(*(int *)(in_ECX + 0x1c),iVar6);
            }
            *(undefined4 *)(in_ECX + 0x1c) = uVar7;
          }
          *(undefined2 *)(*(int *)(in_ECX + 0x1c) + *(int *)(in_ECX + 0x24) * 2) = 0x20;
          *(int *)(in_ECX + 0x24) = *(int *)(in_ECX + 0x24) + 1;
          FUN_0053c7a0();
        }
      } while (*puVar1 < *(uint *)(in_ECX + 0x10));
      if (bVar4) {
        *param_1 = *(undefined4 *)(in_ECX + 0x1c);
        *param_2 = *(int *)(in_ECX + 0x24);
      }
    }
    if (((short *)*puVar1 < *(short **)(in_ECX + 0x10)) &&
       ((*(int *)(in_ECX + 0x14) != 0x3c ||
        ((*(char *)(in_ECX + 0x18) != '\0' && (*(short *)*puVar1 == 0x26)))))) {
      *(undefined4 *)(in_ECX + 4) = 1;
    }
    else {
      *(uint *)(in_ECX + 4) = *(uint *)(in_ECX + 4) | 0x8000;
    }
    *(undefined1 *)(in_ECX + 0x18) = 0;
  }
  return *(int *)(in_ECX + 4) != 1;
}



============================================================
DISASSEMBLY
============================================================
0053dc30 : PUSH ECX
0053dc31 : PUSH ESI
0053dc32 : MOV ESI,ECX
0053dc34 : CMP dword ptr [ESI + 0x4],0x3
0053dc38 : JNZ 0x0053de6c
0053dc3e : MOV EAX,dword ptr [ESI + 0x8]
0053dc41 : MOV ECX,dword ptr [ESP + 0xc]
0053dc45 : PUSH EBX
0053dc46 : PUSH EBP
0053dc47 : MOV EBP,dword ptr [ESP + 0x18]
0053dc4b : PUSH EDI
0053dc4c : LEA EDI,[ESI + 0x8]
0053dc4f : MOV dword ptr [ECX],EAX
0053dc51 : MOV dword ptr [EBP],0x0
0053dc58 : MOV AL,byte ptr [EDI + 0x10]
0053dc5b : XOR BL,BL
0053dc5d : MOV byte ptr [EDI + 0x10],0x1
0053dc61 : TEST AL,AL
0053dc63 : JNZ 0x0053dc74
0053dc65 : MOV EDX,dword ptr [EDI]
0053dc67 : CMP word ptr [EDX],0x26
0053dc6b : JNZ 0x0053dc74
0053dc6d : MOV ECX,EDI
0053dc6f : CALL 0x0053bdd0
0053dc74 : MOV EAX,dword ptr [EDI]
0053dc76 : CMP EAX,dword ptr [EDI + 0x8]
0053dc79 : JNC 0x0053de3a
0053dc7f : NOP
0053dc80 : MOV EAX,dword ptr [ESI + 0x14]
0053dc83 : CMP EAX,0x3c
0053dc86 : JNZ 0x0053dc9e
0053dc88 : CMP byte ptr [EDI + 0x10],0x0
0053dc8c : JZ 0x0053de27
0053dc92 : MOV ECX,dword ptr [EDI]
0053dc94 : CMP word ptr [ECX],0x26
0053dc98 : JNZ 0x0053de27
0053dc9e : MOVZX EAX,AX
0053dca1 : MOV EDX,EAX
0053dca3 : SHR EDX,0x8
0053dca6 : MOVZX EDX,word ptr [EDX*0x2 + 0xb88408]
0053dcae : TEST EDX,EDX
0053dcb0 : JZ 0x0053dd5a
0053dcb6 : CMP EDX,0x1
0053dcb9 : JZ 0x0053dce5
0053dcbb : MOV ECX,EAX
0053dcbd : SHR EAX,0x4
0053dcc0 : AND EAX,0xf
0053dcc3 : AND ECX,0xf
0053dcc6 : ADD EAX,EDX
0053dcc8 : MOVZX EAX,word ptr [EAX*0x2 + 0xb88408]
0053dcd0 : MOV EBP,0x1
0053dcd5 : SHL EBP,CL
0053dcd7 : AND EBP,EAX
0053dcd9 : NEG EBP
0053dcdb : SBB EBP,EBP
0053dcdd : NEG EBP
0053dcdf : MOV EBP,dword ptr [ESP + 0x1c]
0053dce3 : JZ 0x0053dd5a
0053dce5 : CMP byte ptr [ESI + 0x28],0x0
0053dce9 : JZ 0x0053dd5a
0053dceb : TEST BL,BL
0053dced : JNZ 0x0053dd0a
0053dcef : MOV EDX,dword ptr [ESP + 0x18]
0053dcf3 : MOV dword ptr [ESI + 0x24],0x0
0053dcfa : MOV ECX,dword ptr [EBP]
0053dcfd : MOV EAX,dword ptr [EDX]
0053dcff : PUSH ECX
0053dd00 : PUSH EAX
0053dd01 : MOV ECX,ESI
0053dd03 : CALL 0x0053b7f0
0053dd08 : MOV BL,0x1
0053dd0a : MOV ECX,dword ptr [ESI + 0x24]
0053dd0d : MOV EAX,dword ptr [ESI + 0x20]
0053dd10 : ADD ECX,0x6
0053dd13 : CMP ECX,EAX
0053dd15 : JBE 0x0053dd3c
0053dd17 : MOV ECX,dword ptr [ESI + 0x1c]
0053dd1a : ADD EAX,0x6
0053dd1d : MOV dword ptr [ESI + 0x20],EAX
0053dd20 : ADD EAX,EAX
0053dd22 : TEST ECX,ECX
0053dd24 : JNZ 0x0053dd32
0053dd26 : MOV ECX,dword ptr [ESI]
0053dd28 : PUSH 0x0
0053dd2a : PUSH EAX
0053dd2b : CALL 0x00515840
0053dd30 : JMP 0x0053dd39
0053dd32 : PUSH EAX
0053dd33 : PUSH ECX
0053dd34 : CALL 0x00515c80
0053dd39 : MOV dword ptr [ESI + 0x1c],EAX
0053dd3c : MOV EDX,dword ptr [ESI + 0x24]
0053dd3f : MOV EAX,dword ptr [ESI + 0x1c]
0053dd42 : MOV ECX,0x20
0053dd47 : MOV word ptr [EAX + EDX*0x2],CX
0053dd4b : INC dword ptr [ESI + 0x24]
0053dd4e : MOV ECX,ESI
0053dd50 : CALL 0x0053c7a0
0053dd55 : JMP 0x0053de1c
0053dd5a : CMP byte ptr [EDI + 0x10],0x0
0053dd5e : JZ 0x0053ddcf
0053dd60 : MOV EDX,dword ptr [EDI]
0053dd62 : CMP word ptr [EDX],0x26
0053dd66 : JNZ 0x0053ddcf
0053dd68 : TEST BL,BL
0053dd6a : JNZ 0x0053dd87
0053dd6c : MOV ECX,dword ptr [ESP + 0x18]
0053dd70 : MOV dword ptr [ESI + 0x24],0x0
0053dd77 : MOV EAX,dword ptr [EBP]
0053dd7a : MOV EDX,dword ptr [ECX]
0053dd7c : PUSH EAX
0053dd7d : PUSH EDX
0053dd7e : MOV ECX,ESI
0053dd80 : CALL 0x0053b7f0
0053dd85 : MOV BL,0x1
0053dd87 : MOV ECX,dword ptr [ESI + 0x24]
0053dd8a : MOV EAX,dword ptr [ESI + 0x20]
0053dd8d : MOV EBP,dword ptr [ESI + 0x14]
0053dd90 : ADD ECX,0x6
0053dd93 : CMP ECX,EAX
0053dd95 : JBE 0x0053ddbc
0053dd97 : MOV ECX,dword ptr [ESI + 0x1c]
0053dd9a : ADD EAX,0x6
0053dd9d : MOV dword ptr [ESI + 0x20],EAX
0053dda0 : ADD EAX,EAX
0053dda2 : TEST ECX,ECX
0053dda4 : JNZ 0x0053ddb2
0053dda6 : MOV ECX,dword ptr [ESI]
0053dda8 : PUSH 0x0
0053ddaa : PUSH EAX
0053ddab : CALL 0x00515840
0053ddb0 : JMP 0x0053ddb9
0053ddb2 : PUSH EAX
0053ddb3 : PUSH ECX
0053ddb4 : CALL 0x00515c80
0053ddb9 : MOV dword ptr [ESI + 0x1c],EAX
0053ddbc : MOV EDX,dword ptr [ESI + 0x24]
0053ddbf : MOV EAX,dword ptr [ESI + 0x1c]
0053ddc2 : MOV word ptr [EAX + EDX*0x2],BP
0053ddc6 : INC dword ptr [ESI + 0x24]
0053ddc9 : MOV EBP,dword ptr [ESP + 0x1c]
0053ddcd : JMP 0x0053ddf1
0053ddcf : TEST BL,BL
0053ddd1 : JZ 0x0053dde7
0053ddd3 : MOV ECX,dword ptr [EDI + 0x4]
0053ddd6 : SUB ECX,dword ptr [EDI]
0053ddd8 : MOV EDX,dword ptr [EDI]
0053ddda : SAR ECX,0x1
0053dddc : PUSH ECX
0053dddd : PUSH EDX
0053ddde : MOV ECX,ESI
0053dde0 : CALL 0x0053b7f0
0053dde5 : JMP 0x0053ddf1
0053dde7 : MOV EAX,dword ptr [EDI + 0x4]
0053ddea : SUB EAX,dword ptr [EDI]
0053ddec : SAR EAX,0x1
0053ddee : ADD dword ptr [EBP],EAX
0053ddf1 : CMP byte ptr [EDI + 0x10],0x0
0053ddf5 : MOV EAX,dword ptr [EDI + 0x4]
0053ddf8 : MOV dword ptr [EDI],EAX
0053ddfa : JZ 0x0053de0b
0053ddfc : CMP word ptr [EAX],0x26
0053de00 : JNZ 0x0053de0b
0053de02 : MOV ECX,EDI
0053de04 : CALL 0x0053bdd0
0053de09 : JMP 0x0053de1c
0053de0b : CMP EAX,dword ptr [EDI + 0x8]
0053de0e : JNC 0x0053de1c
0053de10 : MOVZX ECX,word ptr [EAX]
0053de13 : ADD EAX,0x2
0053de16 : MOV dword ptr [EDI + 0xc],ECX
0053de19 : MOV dword ptr [EDI + 0x4],EAX
0053de1c : MOV EDX,dword ptr [EDI]
0053de1e : CMP EDX,dword ptr [EDI + 0x8]
0053de21 : JC 0x0053dc80
0053de27 : TEST BL,BL
0053de29 : JZ 0x0053de3a
0053de2b : MOV EAX,dword ptr [ESI + 0x1c]
0053de2e : MOV ECX,dword ptr [ESP + 0x18]
0053de32 : MOV dword ptr [ECX],EAX
0053de34 : MOV EDX,dword ptr [ESI + 0x24]
0053de37 : MOV dword ptr [EBP],EDX
0053de3a : MOV EAX,dword ptr [EDI]
0053de3c : CMP EAX,dword ptr [EDI + 0x8]
0053de3f : JNC 0x0053de5e
0053de41 : CMP dword ptr [ESI + 0x14],0x3c
0053de45 : JNZ 0x0053de55
0053de47 : CMP byte ptr [EDI + 0x10],0x0
0053de4b : JZ 0x0053de5e
0053de4d : MOV ECX,EAX
0053de4f : CMP word ptr [ECX],0x26
0053de53 : JNZ 0x0053de5e
0053de55 : MOV dword ptr [ESI + 0x4],0x1
0053de5c : JMP 0x0053de65
0053de5e : OR dword ptr [ESI + 0x4],0x8000
0053de65 : POP EDI
0053de66 : POP EBP
0053de67 : MOV byte ptr [ESI + 0x18],0x0
0053de6b : POP EBX
0053de6c : XOR EAX,EAX
0053de6e : CMP dword ptr [ESI + 0x4],0x1
0053de72 : POP ESI
0053de73 : SETNZ AL
0053de76 : POP ECX
0053de77 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_009a98f0
ENTRY    : 009a98f0
BODY     : [[009a98f0, 009a9a6c]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009a98f0(void)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  uint8_t *packet;
  undefined4 uVar4;
  int *in_ECX;
  byte bVar5;
  uint local_34;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint8_t *local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4135e;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  iVar2 = (**(code **)(*in_ECX + 0x74))(0,0,DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
  iVar3 = (**(code **)(*in_ECX + 0x74))(1,0);
  if ((iVar2 == 0) || (iVar3 == 0)) {
    local_18 = 7;
    local_1c = 0;
    local_2c = 0;
    FUN_00406360(L"IDS_DEDICATION_NOT_SLOT_ITEM",0x1c);
    local_8 = 0;
    piVar1 = *(int **)(*DAT_00da9894 + 0x1a8);
    uVar4 = FUN_0081d120(local_30);
    local_8._0_1_ = 1;
    (**(code **)(*piVar1 + 0x44))(uVar4,3);
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_8 = 0xffffffff;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  else {
    iVar2 = *(int *)ThreadLocalStoragePointer;
    bVar5 = (byte)((ulonglong)(*(byte *)(iVar2 + 0x18) + 1) % 3);
    *(byte *)(iVar2 + 0x18) = bVar5;
    local_14 = (uint8_t *)((uint)bVar5 * 0x2000 + 0x122cb8 + iVar2);
    if (local_14 == (uint8_t *)0x0) {
      packet = (uint8_t *)0x0;
    }
    else {
      local_14[0] = '\0';
      local_14[1] = '\0';
      local_14[2] = '6';
      local_14[3] = 'i';
      packet = local_14;
    }
    local_8 = 0xffffffff;
    if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
      FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),4,packet);
      ExceptionList = local_10;
      return;
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
009a98f0 : PUSH EBP
009a98f1 : MOV EBP,ESP
009a98f3 : PUSH -0x1
009a98f5 : PUSH 0xb4135e
009a98fa : MOV EAX,FS:[0x0]
009a9900 : PUSH EAX
009a9901 : SUB ESP,0x3c
009a9904 : PUSH EBX
009a9905 : PUSH ESI
009a9906 : PUSH EDI
009a9907 : MOV EAX,[0x00d66fa0]
009a990c : XOR EAX,EBP
009a990e : PUSH EAX
009a990f : LEA EAX,[EBP + -0xc]
009a9912 : MOV FS:[0x0],EAX
009a9918 : MOV ESI,ECX
009a991a : MOV EAX,dword ptr [ESI]
009a991c : MOV EDX,dword ptr [EAX + 0x74]
009a991f : XOR EBX,EBX
009a9921 : PUSH EBX
009a9922 : PUSH EBX
009a9923 : CALL EDX
009a9925 : MOV EDI,EAX
009a9927 : MOV EAX,dword ptr [ESI]
009a9929 : MOV EDX,dword ptr [EAX + 0x74]
009a992c : PUSH EBX
009a992d : PUSH 0x1
009a992f : MOV ECX,ESI
009a9931 : CALL EDX
009a9933 : CMP EDI,EBX
009a9935 : JZ 0x009a99c4
009a993b : CMP EAX,EBX
009a993d : JZ 0x009a99c4
009a9943 : MOV EAX,FS:[0x2c]
009a9949 : MOV ECX,dword ptr [EAX]
009a994b : MOVZX EAX,byte ptr [ECX + 0x18]
009a994f : INC EAX
009a9950 : CDQ
009a9951 : MOV ESI,0x3
009a9956 : IDIV ESI
009a9958 : MOV byte ptr [ECX + 0x18],DL
009a995b : MOVZX EDX,DL
009a995e : SHL EDX,0xd
009a9961 : LEA EAX,[EDX + ECX*0x1 + 0x122cb8]
009a9968 : MOV dword ptr [EBP + -0x10],EAX
009a996b : MOV dword ptr [EBP + -0x4],0x2
009a9972 : CMP EAX,EBX
009a9974 : JZ 0x009a9985
009a9976 : XOR ECX,ECX
009a9978 : MOV word ptr [EAX],CX
009a997b : MOV byte ptr [EAX + 0x2],0x36
009a997f : MOV byte ptr [EAX + 0x3],0x69
009a9983 : JMP 0x009a9987
009a9985 : XOR EAX,EAX
009a9987 : MOV dword ptr [EBP + -0x4],0xffffffff
009a998e : MOV EDX,dword ptr [0x017247d4]
009a9994 : MOV ECX,dword ptr [EDX + 0x4]
009a9997 : CMP ECX,EBX
009a9999 : JZ 0x009a9a5b
009a999f : CMP byte ptr [EDX + 0x8],BL
009a99a2 : JZ 0x009a9a5b
009a99a8 : PUSH 0x4
009a99aa : PUSH ECX
009a99ab : MOV EDI,EAX
009a99ad : CALL 0x00a0dd40
009a99b2 : MOV ECX,dword ptr [EBP + -0xc]
009a99b5 : MOV dword ptr FS:[0x0],ECX
009a99bc : POP ECX
009a99bd : POP EDI
009a99be : POP ESI
009a99bf : POP EBX
009a99c0 : MOV ESP,EBP
009a99c2 : POP EBP
009a99c3 : RET
009a99c4 : PUSH 0x1c
009a99c6 : XOR EDX,EDX
009a99c8 : PUSH 0xc8a7fc
009a99cd : LEA ECX,[EBP + -0x2c]
009a99d0 : MOV dword ptr [EBP + -0x14],0x7
009a99d7 : MOV dword ptr [EBP + -0x18],EBX
009a99da : MOV word ptr [EBP + -0x28],DX
009a99de : CALL 0x00406360
009a99e3 : MOV dword ptr [EBP + -0x4],EBX
009a99e6 : MOV EAX,[0x00da9894]
009a99eb : MOV EAX,dword ptr [EAX]
009a99ed : MOV ESI,dword ptr [EAX + 0x1a8]
009a99f3 : LEA ECX,[EBP + -0x2c]
009a99f6 : PUSH ECX
009a99f7 : MOV ECX,dword ptr [0x0172491c]
009a99fd : LEA EDI,[EBP + -0x48]
009a9a00 : CALL 0x0081d120
009a9a05 : MOV byte ptr [EBP + -0x4],0x1
009a9a09 : MOV EDX,dword ptr [ESI]
009a9a0b : PUSH 0x3
009a9a0d : PUSH EAX
009a9a0e : MOV EAX,dword ptr [EDX + 0x44]
009a9a11 : MOV ECX,ESI
009a9a13 : CALL EAX
009a9a15 : MOV byte ptr [EBP + -0x4],BL
009a9a18 : MOV ESI,0x8
009a9a1d : CMP dword ptr [EBP + -0x30],ESI
009a9a20 : JC 0x009a9a2a
009a9a22 : MOV ECX,dword ptr [EBP + -0x44]
009a9a25 : CALL 0x006f04e0
009a9a2a : MOV EDI,0x7
009a9a2f : XOR ECX,ECX
009a9a31 : MOV dword ptr [EBP + -0x30],EDI
009a9a34 : MOV dword ptr [EBP + -0x34],EBX
009a9a37 : MOV word ptr [EBP + -0x44],CX
009a9a3b : MOV dword ptr [EBP + -0x4],0xffffffff
009a9a42 : CMP dword ptr [EBP + -0x14],ESI
009a9a45 : JC 0x009a9a4f
009a9a47 : MOV ECX,dword ptr [EBP + -0x28]
009a9a4a : CALL 0x006f04e0
009a9a4f : XOR EDX,EDX
009a9a51 : MOV dword ptr [EBP + -0x14],EDI
009a9a54 : MOV dword ptr [EBP + -0x18],EBX
009a9a57 : MOV word ptr [EBP + -0x28],DX
009a9a5b : MOV ECX,dword ptr [EBP + -0xc]
009a9a5e : MOV dword ptr FS:[0x0],ECX
009a9a65 : POP ECX
009a9a66 : POP EDI
009a9a67 : POP ESI
009a9a68 : POP EBX
009a9a69 : MOV ESP,EBP
009a9a6b : POP EBP
009a9a6c : RET

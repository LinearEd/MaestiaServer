PROGRAM  : Maestia.exe
FUNCTION : FUN_00794540
ENTRY    : 00794540
BODY     : [[00794540, 007945da]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00794540(void)

{
  code *pcVar1;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  int *in_ECX;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b197f4;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if ((((char)in_ECX[0x11] != '\0') && (in_ECX[6] == 0)) && (*(char *)((int)in_ECX + 0x45) != '\0'))
  {
    ResetEvent((HANDLE)in_ECX[0x14]);
    in_ECX[0x15] = 1;
    iVar3 = FUN_006f0300(0x5c,uVar2);
    local_8 = 0;
    if (iVar3 == 0) {
      uVar4 = 0;
    }
    else {
      uVar4 = FUN_00746300();
    }
    local_8 = 0xffffffff;
    FUN_00747140(uVar4);
    pcVar1 = *(code **)(*in_ECX + 0x1c);
    in_ECX[0x16] = in_ECX[0x16] | 1;
    (*pcVar1)();
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00794540 : PUSH EBP
00794541 : MOV EBP,ESP
00794543 : PUSH -0x1
00794545 : PUSH 0xb197f4
0079454a : MOV EAX,FS:[0x0]
00794550 : PUSH EAX
00794551 : PUSH ECX
00794552 : PUSH ESI
00794553 : PUSH EDI
00794554 : MOV EAX,[0x00d66fa0]
00794559 : XOR EAX,EBP
0079455b : PUSH EAX
0079455c : LEA EAX,[EBP + -0xc]
0079455f : MOV FS:[0x0],EAX
00794565 : MOV EDI,ECX
00794567 : CMP byte ptr [EDI + 0x44],0x0
0079456b : JZ 0x007945ca
0079456d : MOV EAX,dword ptr [EDI + 0x18]
00794570 : TEST EAX,EAX
00794572 : JNZ 0x007945ca
00794574 : CMP byte ptr [EDI + 0x45],AL
00794577 : JZ 0x007945ca
00794579 : MOV ECX,dword ptr [EDI + 0x50]
0079457c : PUSH ECX
0079457d : CALL dword ptr [0x00b851dc]
00794583 : PUSH 0x5c
00794585 : MOV dword ptr [EDI + 0x54],0x1
0079458c : CALL 0x006f0300
00794591 : ADD ESP,0x4
00794594 : MOV dword ptr [EBP + -0x10],EAX
00794597 : MOV dword ptr [EBP + -0x4],0x0
0079459e : TEST EAX,EAX
007945a0 : JZ 0x007945ab
007945a2 : MOV ESI,EAX
007945a4 : CALL 0x00746300
007945a9 : JMP 0x007945ad
007945ab : XOR EAX,EAX
007945ad : MOV dword ptr [EBP + -0x4],0xffffffff
007945b4 : MOV ESI,dword ptr [EDI + 0x40]
007945b7 : PUSH EAX
007945b8 : CALL 0x00747140
007945bd : MOV EDX,dword ptr [EDI]
007945bf : MOV EAX,dword ptr [EDX + 0x1c]
007945c2 : OR dword ptr [EDI + 0x58],0x1
007945c6 : MOV ECX,EDI
007945c8 : CALL EAX
007945ca : MOV ECX,dword ptr [EBP + -0xc]
007945cd : MOV dword ptr FS:[0x0],ECX
007945d4 : POP ECX
007945d5 : POP EDI
007945d6 : POP ESI
007945d7 : MOV ESP,EBP
007945d9 : POP EBP
007945da : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00512160
ENTRY    : 00512160
BODY     : [[00512160, 005121ba]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00512160(int *param_1)

{
  undefined4 *puVar1;
  undefined4 *in_ECX;
  
  *in_ECX = &PTR_FUN_00cd3f2c;
  puVar1 = in_ECX + 2;
  in_ECX[1] = 1;
  *puVar1 = &PTR_LAB_00b86c5c;
  *in_ECX = &PTR_FUN_00b86ca0;
  *puVar1 = &PTR_LAB_00b86c94;
  if (param_1 != (int *)0x0) {
    InterlockedExchangeAdd(param_1 + 1,1);
  }
  in_ECX[3] = param_1;
  if (param_1 != (int *)0x0) {
    (**(code **)(*param_1 + 0x2c))(puVar1);
  }
  in_ECX[4] = 1;
  return;
}



============================================================
DISASSEMBLY
============================================================
00512160 : PUSH EBX
00512161 : PUSH ESI
00512162 : MOV ESI,ECX
00512164 : MOV dword ptr [ESI],0xcd3f2c
0051216a : PUSH EDI
0051216b : MOV EDI,dword ptr [ESP + 0x10]
0051216f : LEA EBX,[ESI + 0x8]
00512172 : MOV dword ptr [ESI + 0x4],0x1
00512179 : MOV dword ptr [EBX],0xb86c5c
0051217f : MOV dword ptr [ESI],0xb86ca0
00512185 : MOV dword ptr [EBX],0xb86c94
0051218b : TEST EDI,EDI
0051218d : JZ 0x0051219b
0051218f : PUSH 0x1
00512191 : LEA EAX,[EDI + 0x4]
00512194 : PUSH EAX
00512195 : CALL dword ptr [0x00b851cc]
0051219b : MOV dword ptr [ESI + 0xc],EDI
0051219e : TEST EDI,EDI
005121a0 : JZ 0x005121ac
005121a2 : MOV EDX,dword ptr [EDI]
005121a4 : MOV EAX,dword ptr [EDX + 0x2c]
005121a7 : PUSH EBX
005121a8 : MOV ECX,EDI
005121aa : CALL EAX
005121ac : POP EDI
005121ad : MOV EAX,ESI
005121af : MOV dword ptr [ESI + 0x10],0x1
005121b6 : POP ESI
005121b7 : POP EBX
005121b8 : RET 0x4

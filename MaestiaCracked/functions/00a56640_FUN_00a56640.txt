PROGRAM  : Maestia.exe
FUNCTION : FUN_00a56640
ENTRY    : 00a56640
BODY     : [[00a56640, 00a56d96]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x00a56be1) */
/* WARNING: Removing unreachable block (ram,0x00a56ca8) */
/* WARNING: Removing unreachable block (ram,0x00a56a8e) */
/* WARNING: Removing unreachable block (ram,0x00a56c7a) */

void FUN_00a56640(int param_1)

{
  ushort uVar1;
  int *piVar2;
  int iVar3;
  uint local_48;
  uint uStack_2c;
  void *pvStack_24;
  void *pvStack_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_00b6fdd4;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  iVar3 = *(int *)(DAT_0172491c + 0x98);
  if (iVar3 != 0) {
    local_48 = 0;
    *(undefined8 *)(iVar3 + 0x10) = 0;
    *(undefined8 *)(iVar3 + 0x18) = 0x3f80000000000000;
  }
  if (*(undefined4 **)(param_1 + 0x50) != (undefined4 *)0x0) {
    (**(code **)**(undefined4 **)(param_1 + 0x50))();
  }
  iVar3 = DAT_017251ac;
  *(bool *)(param_1 + 0xd2) = *(short *)(DAT_017248cc + 0x6c) != 0;
  *(undefined1 *)(iVar3 + 0x3d0) = 1;
  piVar2 = (int *)FUN_007f91b0();
  *(int **)(param_1 + 0x34) = piVar2;
  if (piVar2 != (int *)0x0) {
    (**(code **)(*piVar2 + 0x14))();
    (**(code **)(**(int **)(param_1 + 0x34) + 0xc))();
    iVar3 = FUN_007f91b0();
    *(int *)(param_1 + 0x38) = iVar3;
    if (iVar3 == 0) {
      FUN_008018d0();
      ExceptionList = pvStack_1c;
      return;
    }
    FUN_00a48f10();
    (**(code **)(**(int **)(param_1 + 0x38) + 0x14))();
    (**(code **)(**(int **)(param_1 + 0x38) + 0xc))();
    if ((DAT_00d71cd4 == 0) && (DAT_00d71cf0 == 0)) {
      (**(code **)(**(int **)(param_1 + 0x38) + 4))();
    }
    FUN_00401c40();
    iVar3 = DAT_0172491c;
    *(int *)(*(int *)(param_1 + 0x114) + 4) = *(int *)(param_1 + 0x114);
    *(undefined4 *)(param_1 + 0x118) = 0;
    *(undefined4 *)*(undefined4 *)(param_1 + 0x114) = *(undefined4 *)(param_1 + 0x114);
    *(int *)(*(int *)(param_1 + 0x114) + 8) = *(int *)(param_1 + 0x114);
    *(undefined1 *)(param_1 + 0x11c) = 0;
    *(undefined1 *)(param_1 + 0x1e1) = 0;
    *(undefined1 *)(iVar3 + 0xb5) = 0;
    if (*(int **)(param_1 + 0x38) != (int *)0x0) {
      (**(code **)(**(int **)(param_1 + 0x38) + 4))();
      (**(code **)(**(int **)(param_1 + 0x38) + 4))();
      (**(code **)(**(int **)(param_1 + 0x38) + 4))();
      (**(code **)(**(int **)(param_1 + 0x38) + 4))(*(int **)(param_1 + 0x38));
      (**(code **)(**(int **)(param_1 + 0x38) + 4))();
      iVar3 = *(int *)(DAT_017248cc + 0xb8);
      piVar2 = (int *)(DAT_017248cc + 0xbc);
      if (iVar3 != *piVar2) {
        do {
          (**(code **)(**(int **)(param_1 + 0x38) + 4))();
          iVar3 = iVar3 + 0x1c;
        } while (iVar3 != *piVar2);
      }
      FUN_0081cbe0();
      FUN_0081cbe0();
      (**(code **)(**(int **)(param_1 + 0x38) + 4))();
      if (7 < uStack_2c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      uStack_2c = 7;
      if (7 < local_48) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      iVar3 = FUN_006f0760();
      if (iVar3 != 0) {
        FUN_00a16020();
      }
      (**(code **)(**(int **)(param_1 + 0x38) + 4))();
    }
    FUN_00406360();
    if (DAT_00d6ab0f != '\0') {
      FUN_008a0a00();
    }
    (*(code *)**(undefined4 **)(param_1 + 4))();
    if (((DAT_017251ac != 0) && (*(int *)(DAT_017251ac + 0x1a4) != 0)) &&
       (*(int *)(*(int *)(DAT_017251ac + 0x1a4) + 0xf0) != 0)) {
      FUN_008b7050();
      FUN_00406460(L"lobby.mvd");
      FUN_007ebed0();
    }
    if (*(int **)(param_1 + 0x34) != (int *)0x0) {
      (**(code **)(**(int **)(param_1 + 0x34) + 4))();
      (**(code **)(**(int **)(param_1 + 0x34) + 4))();
    }
    if ((DAT_00d6c963 != '\0') && (uVar1 = GetAsyncKeyState(0x10), (uVar1 & 0x8000) != 0)) {
      DAT_00d6c963 = '\0';
    }
    if ((DAT_00da98b8 != '\0') && (DAT_00d6c963 != '\0')) {
      FUN_00406460();
      FUN_00406460();
      FUN_008b78a0();
      if (7 < uStack_2c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      FUN_00406460();
      FUN_00406460();
      FUN_008b78a0();
      iVar3 = FUN_00405bb0();
      if ((iVar3 == 0) || (iVar3 = FUN_00405bb0(), iVar3 == 0)) {
        DAT_00d6c963 = '\0';
      }
      else {
        *(undefined4 *)(param_1 + 0xd4) = 1;
        FUN_00a562e0();
      }
    }
    if ((DAT_00d71cd4 != 0) && (DAT_00d71cf0 != 0)) {
      FUN_00405eb0();
      FUN_00405eb0();
      *(undefined4 *)(param_1 + 0xd4) = 1;
      FUN_00a562e0();
      FUN_00401440();
      FUN_00401440();
    }
    FUN_0081c150();
    ExceptionList = pvStack_24;
    return;
  }
  FUN_008018d0();
  ExceptionList = local_14;
  return;
}



============================================================
DISASSEMBLY
============================================================
00a56640 : PUSH EBP
00a56641 : MOV EBP,ESP
00a56643 : AND ESP,0xfffffff8
00a56646 : PUSH -0x1
00a56648 : PUSH 0xb6fdd4
00a5664d : MOV EAX,FS:[0x0]
00a56653 : PUSH EAX
00a56654 : SUB ESP,0x48
00a56657 : PUSH EBX
00a56658 : PUSH ESI
00a56659 : PUSH EDI
00a5665a : MOV EAX,[0x00d66fa0]
00a5665f : XOR EAX,ESP
00a56661 : PUSH EAX
00a56662 : LEA EAX,[ESP + 0x58]
00a56666 : MOV FS:[0x0],EAX
00a5666c : MOV EBX,dword ptr [EBP + 0x8]
00a5666f : MOV EAX,[0x0172491c]
00a56674 : MOV EAX,dword ptr [EAX + 0x98]
00a5667a : TEST EAX,EAX
00a5667c : JZ 0x00a566b7
00a5667e : XORPS XMM0,XMM0
00a56681 : MOVSS dword ptr [ESP + 0x1c],XMM0
00a56687 : MOVSS dword ptr [ESP + 0x20],XMM0
00a5668d : MOVSS dword ptr [ESP + 0x24],XMM0
00a56693 : MOVSS XMM0,dword ptr [0x00c10fc4]
00a5669b : MOVSS dword ptr [ESP + 0x28],XMM0
00a566a1 : MOVQ XMM0,qword ptr [ESP + 0x1c]
00a566a7 : MOVQ qword ptr [EAX + 0x10],XMM0
00a566ac : MOVQ XMM0,qword ptr [ESP + 0x24]
00a566b2 : MOVQ qword ptr [EAX + 0x18],XMM0
00a566b7 : MOV ECX,dword ptr [EBX + 0x50]
00a566ba : TEST ECX,ECX
00a566bc : JZ 0x00a566c9
00a566be : MOV EDX,dword ptr [ECX]
00a566c0 : MOV EAX,dword ptr [EDX]
00a566c2 : PUSH 0xcc6ba0
00a566c7 : CALL EAX
00a566c9 : MOV ECX,dword ptr [0x017248cc]
00a566cf : MOVZX EAX,word ptr [ECX + 0x6c]
00a566d3 : MOV ECX,dword ptr [0x0172491c]
00a566d9 : TEST AX,AX
00a566dc : MOV EAX,[0x017251ac]
00a566e1 : SETNZ DL
00a566e4 : MOV byte ptr [EBX + 0xd2],DL
00a566ea : PUSH 0x1
00a566ec : MOV byte ptr [EAX + 0x3d0],0x1
00a566f3 : MOV EAX,dword ptr [ECX + 0x90]
00a566f9 : PUSH EBX
00a566fa : PUSH EAX
00a566fb : MOV ECX,0xcc5d00
00a56700 : CALL 0x007f91b0
00a56705 : MOV dword ptr [EBX + 0x34],EAX
00a56708 : TEST EAX,EAX
00a5670a : JNZ 0x00a56734
00a5670c : MOV ESI,dword ptr [0x00da98e8]
00a56712 : PUSH 0xcc5d10
00a56717 : CALL 0x008018d0
00a5671c : ADD ESP,0x4
00a5671f : MOV ECX,dword ptr [ESP + 0x58]
00a56723 : MOV dword ptr FS:[0x0],ECX
00a5672a : POP ECX
00a5672b : POP EDI
00a5672c : POP ESI
00a5672d : POP EBX
00a5672e : MOV ESP,EBP
00a56730 : POP EBP
00a56731 : RET 0x4
00a56734 : MOV EDX,dword ptr [EAX]
00a56736 : MOV ECX,EAX
00a56738 : MOV EAX,dword ptr [EDX + 0x14]
00a5673b : PUSH 0x0
00a5673d : CALL EAX
00a5673f : MOV ECX,dword ptr [EBX + 0x34]
00a56742 : MOV EDX,dword ptr [ECX]
00a56744 : MOV EAX,dword ptr [EDX + 0xc]
00a56747 : PUSH 0x1
00a56749 : CALL EAX
00a5674b : MOV ECX,dword ptr [0x0172491c]
00a56751 : MOV EAX,dword ptr [ECX + 0x90]
00a56757 : PUSH 0x1
00a56759 : PUSH EBX
00a5675a : PUSH EAX
00a5675b : MOV ECX,0xcc5d7c
00a56760 : CALL 0x007f91b0
00a56765 : MOV dword ptr [EBX + 0x38],EAX
00a56768 : TEST EAX,EAX
00a5676a : JNZ 0x00a56794
00a5676c : MOV ESI,dword ptr [0x00da98e8]
00a56772 : PUSH 0xcc5d88
00a56777 : CALL 0x008018d0
00a5677c : ADD ESP,0x4
00a5677f : MOV ECX,dword ptr [ESP + 0x58]
00a56783 : MOV dword ptr FS:[0x0],ECX
00a5678a : POP ECX
00a5678b : POP EDI
00a5678c : POP ESI
00a5678d : POP EBX
00a5678e : MOV ESP,EBP
00a56790 : POP EBP
00a56791 : RET 0x4
00a56794 : MOV ESI,EBX
00a56796 : CALL 0x00a48f10
00a5679b : MOV ECX,dword ptr [EBX + 0x38]
00a5679e : MOV EDX,dword ptr [ECX]
00a567a0 : MOV EAX,dword ptr [EDX + 0x14]
00a567a3 : PUSH 0x1
00a567a5 : CALL EAX
00a567a7 : MOV ECX,dword ptr [EBX + 0x38]
00a567aa : MOV EDX,dword ptr [ECX]
00a567ac : MOV EAX,dword ptr [EDX + 0xc]
00a567af : PUSH 0x1
00a567b1 : CALL EAX
00a567b3 : CMP dword ptr [0x00d71cd4],0x0
00a567ba : JNZ 0x00a567df
00a567bc : CMP dword ptr [0x00d71cf0],0x0
00a567c3 : JNZ 0x00a567df
00a567c5 : MOV EAX,dword ptr [EBX + 0x38]
00a567c8 : MOV ECX,dword ptr [EAX]
00a567ca : MOV EDX,dword ptr [ECX + 0x4]
00a567cd : PUSH 0x1
00a567cf : PUSH 0xcc5df4
00a567d4 : PUSH 0xcc5df8
00a567d9 : PUSH EAX
00a567da : CALL EDX
00a567dc : ADD ESP,0x10
00a567df : MOV EAX,dword ptr [EBX + 0x114]
00a567e5 : MOV ECX,dword ptr [EAX + 0x4]
00a567e8 : LEA ESI,[EBX + 0x110]
00a567ee : PUSH ECX
00a567ef : MOV ECX,ESI
00a567f1 : CALL 0x00401c40
00a567f6 : MOV EAX,dword ptr [ESI + 0x4]
00a567f9 : MOV EDX,dword ptr [0x0172491c]
00a567ff : MOV dword ptr [EAX + 0x4],EAX
00a56802 : MOV EAX,dword ptr [ESI + 0x4]
00a56805 : MOV dword ptr [ESI + 0x8],0x0
00a5680c : MOV dword ptr [EAX],EAX
00a5680e : MOV ESI,dword ptr [ESI + 0x4]
00a56811 : MOV dword ptr [ESI + 0x8],ESI
00a56814 : MOV byte ptr [EBX + 0x11c],0x0
00a5681b : MOV byte ptr [EBX + 0x1e1],0x0
00a56822 : MOV byte ptr [EDX + 0xb5],0x0
00a56829 : MOV EAX,dword ptr [EBX + 0x38]
00a5682c : TEST EAX,EAX
00a5682e : JZ 0x00a56a3e
00a56834 : MOV ECX,dword ptr [EAX]
00a56836 : MOV EDX,dword ptr [ECX + 0x4]
00a56839 : PUSH 0x0
00a5683b : PUSH 0xcc5e0c
00a56840 : PUSH 0xcc5e10
00a56845 : PUSH EAX
00a56846 : CALL EDX
00a56848 : MOV EAX,dword ptr [EBX + 0x38]
00a5684b : MOV ECX,dword ptr [EAX]
00a5684d : MOV EDX,dword ptr [ECX + 0x4]
00a56850 : PUSH 0x1
00a56852 : PUSH 0xcc5e24
00a56857 : PUSH 0xcc5e28
00a5685c : PUSH EAX
00a5685d : CALL EDX
00a5685f : MOV EAX,dword ptr [EBX + 0x38]
00a56862 : MOV ECX,dword ptr [EAX]
00a56864 : MOV EDX,dword ptr [ECX + 0x4]
00a56867 : PUSH 0x1
00a56869 : PUSH 0xcc5e38
00a5686e : PUSH 0xcc5e3c
00a56873 : PUSH EAX
00a56874 : CALL EDX
00a56876 : MOV EAX,dword ptr [EBX + 0x38]
00a56879 : MOV ECX,dword ptr [EAX]
00a5687b : MOV EDX,dword ptr [ECX + 0x4]
00a5687e : PUSH 0x2
00a56880 : PUSH 0xcc5e4c
00a56885 : PUSH 0xcc5e50
00a5688a : PUSH EAX
00a5688b : CALL EDX
00a5688d : MOV EAX,[0x017248cc]
00a56892 : MOV CL,byte ptr [EAX + 0xc4]
00a56898 : MOV EAX,dword ptr [EBX + 0x38]
00a5689b : MOV EDX,dword ptr [EAX]
00a5689d : MOV EDX,dword ptr [EDX + 0x4]
00a568a0 : ADD ESP,0x40
00a568a3 : MOVZX ECX,CL
00a568a6 : PUSH ECX
00a568a7 : PUSH 0xcc5e60
00a568ac : PUSH 0xcc5e64
00a568b1 : PUSH EAX
00a568b2 : CALL EDX
00a568b4 : MOV EAX,[0x017248cc]
00a568b9 : MOV ESI,dword ptr [EAX + 0xb8]
00a568bf : MOV EDI,dword ptr [EAX + 0xc8]
00a568c5 : ADD EAX,0xbc
00a568ca : ADD ESP,0x10
00a568cd : MOV dword ptr [ESP + 0x10],0x0
00a568d5 : MOV dword ptr [ESP + 0x18],EAX
00a568d9 : CMP ESI,dword ptr [EAX]
00a568db : JZ 0x00a5692c
00a568dd : LEA ECX,[ECX]
00a568e0 : CMP dword ptr [ESI + 0x18],0x8
00a568e4 : JC 0x00a568ef
00a568e6 : MOV EAX,dword ptr [ESI + 0x4]
00a568e9 : MOV dword ptr [ESP + 0x14],EAX
00a568ed : JMP 0x00a568f6
00a568ef : LEA ECX,[ESI + 0x4]
00a568f2 : MOV dword ptr [ESP + 0x14],ECX
00a568f6 : MOV EAX,dword ptr [EBX + 0x38]
00a568f9 : MOV EDX,dword ptr [EAX]
00a568fb : MOV EDX,dword ptr [EDX + 0x4]
00a568fe : XOR ECX,ECX
00a56900 : CMP dword ptr [ESP + 0x10],EDI
00a56904 : SETZ CL
00a56907 : PUSH ECX
00a56908 : MOV ECX,dword ptr [ESP + 0x18]
00a5690c : PUSH ECX
00a5690d : PUSH 0xcc5e74
00a56912 : PUSH 0xcc5e7c
00a56917 : PUSH EAX
00a56918 : CALL EDX
00a5691a : MOV EAX,dword ptr [ESP + 0x2c]
00a5691e : INC dword ptr [ESP + 0x24]
00a56922 : ADD ESI,0x1c
00a56925 : ADD ESP,0x14
00a56928 : CMP ESI,dword ptr [EAX]
00a5692a : JNZ 0x00a568e0
00a5692c : MOV ECX,dword ptr [0x0172491c]
00a56932 : PUSH ECX
00a56933 : MOV ECX,0xcc5e88
00a56938 : LEA ESI,[ESP + 0x20]
00a5693c : CALL 0x0081cbe0
00a56941 : MOV EDI,EAX
00a56943 : MOV dword ptr [ESP + 0x60],0x0
00a5694b : MOV EDX,dword ptr [0x0172491c]
00a56951 : PUSH EDX
00a56952 : MOV ECX,0xcc5e94
00a56957 : LEA ESI,[ESP + 0x3c]
00a5695b : CALL 0x0081cbe0
00a56960 : MOV byte ptr [ESP + 0x60],0x1
00a56965 : MOV ESI,0x8
00a5696a : CMP dword ptr [EDI + 0x18],ESI
00a5696d : JC 0x00a56974
00a5696f : MOV EDI,dword ptr [EDI + 0x4]
00a56972 : JMP 0x00a56977
00a56974 : ADD EDI,0x4
00a56977 : CMP dword ptr [EAX + 0x18],ESI
00a5697a : JC 0x00a56981
00a5697c : MOV ECX,dword ptr [EAX + 0x4]
00a5697f : JMP 0x00a56984
00a56981 : LEA ECX,[EAX + 0x4]
00a56984 : MOV EAX,dword ptr [EBX + 0x38]
00a56987 : MOV EDX,dword ptr [EAX]
00a56989 : PUSH EDI
00a5698a : PUSH ECX
00a5698b : PUSH 0xcc5ea0
00a56990 : PUSH 0xcc5ea8
00a56995 : PUSH EAX
00a56996 : MOV EAX,dword ptr [EDX + 0x4]
00a56999 : CALL EAX
00a5699b : ADD ESP,0x14
00a5699e : MOV byte ptr [ESP + 0x60],0x0
00a569a3 : CMP dword ptr [ESP + 0x50],ESI
00a569a7 : JC 0x00a569b2
00a569a9 : MOV ECX,dword ptr [ESP + 0x3c]
00a569ad : CALL 0x006f04e0
00a569b2 : MOV ESI,0x7
00a569b7 : XOR EDI,EDI
00a569b9 : XOR ECX,ECX
00a569bb : MOV dword ptr [ESP + 0x50],ESI
00a569bf : MOV dword ptr [ESP + 0x4c],EDI
00a569c3 : MOV word ptr [ESP + 0x3c],CX
00a569c8 : MOV dword ptr [ESP + 0x60],0xffffffff
00a569d0 : CMP dword ptr [ESP + 0x34],0x8
00a569d5 : JC 0x00a569e0
00a569d7 : MOV ECX,dword ptr [ESP + 0x20]
00a569db : CALL 0x006f04e0
00a569e0 : PUSH EDI
00a569e1 : PUSH 0x41b
00a569e6 : XOR EDX,EDX
00a569e8 : PUSH 0xcc5eb4
00a569ed : PUSH 0x10
00a569ef : MOV dword ptr [ESP + 0x44],ESI
00a569f3 : MOV dword ptr [ESP + 0x40],EDI
00a569f7 : MOV word ptr [ESP + 0x30],DX
00a569fc : CALL 0x006f0760
00a56a01 : ADD ESP,0x10
00a56a04 : MOV dword ptr [ESP + 0x18],EAX
00a56a08 : MOV dword ptr [ESP + 0x60],0x2
00a56a10 : CMP EAX,EDI
00a56a12 : JZ 0x00a56a1a
00a56a14 : PUSH EAX
00a56a15 : CALL 0x00a16020
00a56a1a : MOV dword ptr [ESP + 0x60],0xffffffff
00a56a22 : MOV EAX,dword ptr [EBX + 0x38]
00a56a25 : MOV ECX,dword ptr [EAX]
00a56a27 : MOV EDX,dword ptr [ECX + 0x4]
00a56a2a : PUSH 0x1
00a56a2c : PUSH 0xcc5ee4
00a56a31 : PUSH 0xcc5ee8
00a56a36 : PUSH EAX
00a56a37 : CALL EDX
00a56a39 : ADD ESP,0x10
00a56a3c : JMP 0x00a56a43
00a56a3e : MOV ESI,0x7
00a56a43 : PUSH 0x12
00a56a45 : XOR EAX,EAX
00a56a47 : XOR EDI,EDI
00a56a49 : PUSH 0xcc5f00
00a56a4e : LEA ECX,[ESP + 0x24]
00a56a52 : MOV dword ptr [ESP + 0x3c],ESI
00a56a56 : MOV dword ptr [ESP + 0x38],EDI
00a56a5a : MOV word ptr [ESP + 0x28],AX
00a56a5f : CALL 0x00406360
00a56a64 : MOV dword ptr [ESP + 0x60],0x3
00a56a6c : CMP byte ptr [0x00d6ab0f],0x0
00a56a73 : JZ 0x00a56a7f
00a56a75 : LEA ECX,[ESP + 0x1c]
00a56a79 : PUSH ECX
00a56a7a : CALL 0x008a0a00
00a56a7f : MOV dword ptr [ESP + 0x60],0xffffffff
00a56a87 : CMP dword ptr [ESP + 0x34],0x8
00a56a8c : JC 0x00a56a97
00a56a8e : MOV ECX,dword ptr [ESP + 0x20]
00a56a92 : CALL 0x006f04e0
00a56a97 : MOV EAX,dword ptr [EBX + 0x4]
00a56a9a : XOR EDX,EDX
00a56a9c : LEA ECX,[EBX + 0x4]
00a56a9f : MOV word ptr [ESP + 0x20],DX
00a56aa4 : MOV EDX,dword ptr [EAX]
00a56aa6 : MOV dword ptr [ESP + 0x34],ESI
00a56aaa : MOV dword ptr [ESP + 0x30],EDI
00a56aae : CALL EDX
00a56ab0 : MOV EAX,[0x017251ac]
00a56ab5 : CMP EAX,EDI
00a56ab7 : JZ 0x00a56b1b
00a56ab9 : MOV EAX,dword ptr [EAX + 0x1a4]
00a56abf : CMP EAX,EDI
00a56ac1 : JZ 0x00a56b1b
00a56ac3 : MOV EDI,dword ptr [EAX + 0xf0]
00a56ac9 : TEST EDI,EDI
00a56acb : JZ 0x00a56b1b
00a56acd : MOV EAX,[0x017248c8]
00a56ad2 : PUSH 0x1
00a56ad4 : SUB ESP,0x1c
00a56ad7 : MOV ESI,ESP
00a56ad9 : MOV dword ptr [ESP + 0x38],ESP
00a56add : PUSH EAX
00a56ade : CALL 0x008b7050
00a56ae3 : MOV dword ptr [ESP + 0x80],0x4
00a56aee : SUB ESP,0x1c
00a56af1 : MOV ECX,ESP
00a56af3 : MOV dword ptr [ESP + 0x50],ESP
00a56af7 : PUSH 0xcc5f28
00a56afc : CALL 0x00406460
00a56b01 : MOV byte ptr [ESP + 0x9c],0x5
00a56b09 : MOV dword ptr [ESP + 0x9c],0xffffffff
00a56b14 : MOV ECX,EDI
00a56b16 : CALL 0x007ebed0
00a56b1b : MOV EAX,dword ptr [EBX + 0x34]
00a56b1e : TEST EAX,EAX
00a56b20 : JZ 0x00a56b50
00a56b22 : MOV ECX,dword ptr [EAX]
00a56b24 : MOV EDX,dword ptr [ECX + 0x4]
00a56b27 : PUSH 0x0
00a56b29 : PUSH 0xcc5f3c
00a56b2e : PUSH 0xcc5f40
00a56b33 : PUSH EAX
00a56b34 : CALL EDX
00a56b36 : MOV EAX,dword ptr [EBX + 0x34]
00a56b39 : MOV ECX,dword ptr [EAX]
00a56b3b : MOV EDX,dword ptr [ECX + 0x4]
00a56b3e : PUSH 0x1
00a56b40 : PUSH 0xcc5f58
00a56b45 : PUSH 0xcc5f5c
00a56b4a : PUSH EAX
00a56b4b : CALL EDX
00a56b4d : ADD ESP,0x20
00a56b50 : CMP byte ptr [0x00d6c963],0x0
00a56b57 : JZ 0x00a56b72
00a56b59 : PUSH 0x10
00a56b5b : CALL dword ptr [0x00b8542c]
00a56b61 : MOV ECX,0x8000
00a56b66 : TEST CX,AX
00a56b69 : JZ 0x00a56b72
00a56b6b : MOV byte ptr [0x00d6c963],0x0
00a56b72 : CMP byte ptr [0x00da98b8],0x0
00a56b79 : JZ 0x00a56d12
00a56b7f : CMP byte ptr [0x00d6c963],0x0
00a56b86 : JZ 0x00a56d12
00a56b8c : PUSH 0xcc5f70
00a56b91 : LEA ECX,[ESP + 0x3c]
00a56b95 : CALL 0x00406460
00a56b9a : MOV dword ptr [ESP + 0x60],0x6
00a56ba2 : PUSH 0xcc5f80
00a56ba7 : LEA ECX,[ESP + 0x20]
00a56bab : CALL 0x00406460
00a56bb0 : MOV byte ptr [ESP + 0x60],0x7
00a56bb5 : MOV EAX,[0x017248c8]
00a56bba : LEA EDX,[ESP + 0x38]
00a56bbe : PUSH EDX
00a56bbf : LEA ESI,[EBX + 0xd8]
00a56bc5 : PUSH EAX
00a56bc6 : MOV ECX,ESI
00a56bc8 : LEA EDX,[ESP + 0x24]
00a56bcc : CALL 0x008b78a0
00a56bd1 : MOV byte ptr [ESP + 0x60],0x6
00a56bd6 : MOV EDI,0x8
00a56bdb : CMP dword ptr [ESP + 0x34],EDI
00a56bdf : JC 0x00a56bea
00a56be1 : MOV ECX,dword ptr [ESP + 0x20]
00a56be5 : CALL 0x006f04e0
00a56bea : XOR ECX,ECX
00a56bec : MOV dword ptr [ESP + 0x34],0x7
00a56bf4 : MOV dword ptr [ESP + 0x30],0x0
00a56bfc : MOV word ptr [ESP + 0x20],CX
00a56c01 : MOV dword ptr [ESP + 0x60],0xffffffff
00a56c09 : CMP dword ptr [ESP + 0x50],EDI
00a56c0d : JC 0x00a56c18
00a56c0f : MOV ECX,dword ptr [ESP + 0x3c]
00a56c13 : CALL 0x006f04e0
00a56c18 : XOR EDX,EDX
00a56c1a : PUSH 0xcc5f94
00a56c1f : LEA ECX,[ESP + 0x20]
00a56c23 : MOV dword ptr [ESP + 0x54],0x7
00a56c2b : MOV dword ptr [ESP + 0x50],0x0
00a56c33 : MOV word ptr [ESP + 0x40],DX
00a56c38 : CALL 0x00406460
00a56c3d : MOV dword ptr [ESP + 0x60],EDI
00a56c41 : PUSH 0xcc5fa4
00a56c46 : LEA ECX,[ESP + 0x3c]
00a56c4a : CALL 0x00406460
00a56c4f : MOV byte ptr [ESP + 0x60],0x9
00a56c54 : MOV EDX,dword ptr [0x017248c8]
00a56c5a : LEA EAX,[ESP + 0x1c]
00a56c5e : PUSH EAX
00a56c5f : PUSH EDX
00a56c60 : LEA ECX,[EBX + 0xf4]
00a56c66 : LEA EDX,[ESP + 0x40]
00a56c6a : CALL 0x008b78a0
00a56c6f : MOV byte ptr [ESP + 0x60],0x8
00a56c74 : CMP dword ptr [ESP + 0x50],EDI
00a56c78 : JC 0x00a56c83
00a56c7a : MOV ECX,dword ptr [ESP + 0x3c]
00a56c7e : CALL 0x006f04e0
00a56c83 : XOR EAX,EAX
00a56c85 : MOV dword ptr [ESP + 0x50],0x7
00a56c8d : MOV dword ptr [ESP + 0x4c],0x0
00a56c95 : MOV word ptr [ESP + 0x3c],AX
00a56c9a : MOV dword ptr [ESP + 0x60],0xffffffff
00a56ca2 : CMP dword ptr [ESP + 0x34],EDI
00a56ca6 : JC 0x00a56cb1
00a56ca8 : MOV ECX,dword ptr [ESP + 0x20]
00a56cac : CALL 0x006f04e0
00a56cb1 : MOV EAX,dword ptr [ESI + 0x14]
00a56cb4 : XOR ECX,ECX
00a56cb6 : MOV word ptr [ESP + 0x20],CX
00a56cbb : LEA EDI,[ECX + 0xf]
00a56cbe : PUSH 0xcc5fb8
00a56cc3 : MOV ECX,ESI
00a56cc5 : MOV dword ptr [ESP + 0x38],0x7
00a56ccd : MOV dword ptr [ESP + 0x34],0x0
00a56cd5 : CALL 0x00405bb0
00a56cda : TEST EAX,EAX
00a56cdc : JZ 0x00a56d0b
00a56cde : MOV EAX,dword ptr [EBX + 0x108]
00a56ce4 : LEA ECX,[EBX + 0xf4]
00a56cea : PUSH 0xcc5fd8
00a56cef : CALL 0x00405bb0
00a56cf4 : TEST EAX,EAX
00a56cf6 : JZ 0x00a56d0b
00a56cf8 : MOV ECX,EBX
00a56cfa : MOV dword ptr [EBX + 0xd4],0x1
00a56d04 : CALL 0x00a562e0
00a56d09 : JMP 0x00a56d12
00a56d0b : MOV byte ptr [0x00d6c963],0x0
00a56d12 : CMP dword ptr [0x00d71cd4],0x0
00a56d19 : JZ 0x00a56d71
00a56d1b : CMP dword ptr [0x00d71cf0],0x0
00a56d22 : JZ 0x00a56d71
00a56d24 : PUSH -0x1
00a56d26 : PUSH 0x0
00a56d28 : PUSH 0xd71cc0
00a56d2d : LEA ECX,[EBX + 0xd8]
00a56d33 : CALL 0x00405eb0
00a56d38 : PUSH -0x1
00a56d3a : PUSH 0x0
00a56d3c : PUSH 0xd71cdc
00a56d41 : LEA ECX,[EBX + 0xf4]
00a56d47 : CALL 0x00405eb0
00a56d4c : MOV ECX,EBX
00a56d4e : MOV dword ptr [EBX + 0xd4],0x1
00a56d58 : CALL 0x00a562e0
00a56d5d : MOV EAX,0xd71cc0
00a56d62 : CALL 0x00401440
00a56d67 : MOV EAX,0xd71cdc
00a56d6c : CALL 0x00401440
00a56d71 : MOV EDX,dword ptr [0x0172491c]
00a56d77 : PUSH EDX
00a56d78 : MOV EAX,0x1
00a56d7d : CALL 0x0081c150
00a56d82 : MOV ECX,dword ptr [ESP + 0x58]
00a56d86 : MOV dword ptr FS:[0x0],ECX
00a56d8d : POP ECX
00a56d8e : POP EDI
00a56d8f : POP ESI
00a56d90 : POP EBX
00a56d91 : MOV ESP,EBP
00a56d93 : POP EBP
00a56d94 : RET 0x4

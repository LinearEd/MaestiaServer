PROGRAM  : Maestia.exe
FUNCTION : FUN_00684590
ENTRY    : 00684590
BODY     : [[00684590, 006846d7]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00684590(undefined4 param_1,undefined4 *param_2,uint param_3)

{
  uint *puVar1;
  int *piVar2;
  int iVar3;
  uint *puVar4;
  uint uVar5;
  int *in_ECX;
  uint uVar6;
  int iVar7;
  
  piVar2 = (int *)*in_ECX;
  if (piVar2 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar2 * 5) <= piVar2[1] * 4 + 4U) goto LAB_006845ca;
    iVar7 = piVar2[1] * 2 + 2;
  }
  FUN_00684240(param_1,iVar7);
LAB_006845ca:
  piVar2 = (int *)*in_ECX;
  param_3 = param_3 & piVar2[1];
  *piVar2 = *piVar2 + 1;
  iVar7 = *in_ECX;
  iVar3 = *(int *)(iVar7 + 8 + param_3 * 0x14);
  puVar1 = (uint *)(iVar7 + 8 + param_3 * 0x14);
  if (iVar3 == -2) {
    *puVar1 = 0xffffffff;
    puVar1[2] = *(uint *)*param_2;
    puVar4 = (uint *)param_2[1];
    puVar1[3] = *puVar4;
    puVar1[4] = puVar4[1];
    puVar1[1] = param_3;
    return;
  }
  uVar6 = param_3;
  do {
    uVar6 = uVar6 + 1 & *(uint *)(iVar7 + 4);
  } while (*(int *)(iVar7 + 8 + uVar6 * 0x14) != -2);
  piVar2 = (int *)(iVar7 + 8 + uVar6 * 0x14);
  uVar5 = puVar1[1];
  if (uVar5 != param_3) {
    puVar4 = (uint *)(iVar7 + 8 + uVar5 * 0x14);
    for (uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x14); uVar5 != param_3;
        uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x14)) {
      uVar5 = *puVar4;
      puVar4 = (uint *)(iVar7 + 8 + uVar5 * 0x14);
    }
    if (piVar2 != (int *)0x0) {
      *piVar2 = iVar3;
      piVar2[1] = puVar1[1];
      piVar2[2] = puVar1[2];
      piVar2[3] = puVar1[3];
      piVar2[4] = puVar1[4];
    }
    *puVar4 = uVar6;
    puVar1[2] = *(uint *)*param_2;
    puVar4 = (uint *)param_2[1];
    puVar1[3] = *puVar4;
    puVar1[4] = puVar4[1];
    *puVar1 = 0xffffffff;
    puVar1[1] = param_3;
    return;
  }
  if (piVar2 != (int *)0x0) {
    *piVar2 = iVar3;
    piVar2[1] = puVar1[1];
    piVar2[2] = puVar1[2];
    piVar2[3] = puVar1[3];
    piVar2[4] = puVar1[4];
  }
  puVar1[2] = *(uint *)*param_2;
  puVar4 = (uint *)param_2[1];
  puVar1[3] = *puVar4;
  puVar1[4] = puVar4[1];
  *puVar1 = uVar6;
  puVar1[1] = param_3;
  return;
}



============================================================
DISASSEMBLY
============================================================
00684590 : PUSH EBP
00684591 : PUSH ESI
00684592 : MOV ESI,ECX
00684594 : MOV EAX,dword ptr [ESI]
00684596 : TEST EAX,EAX
00684598 : JNZ 0x006845a3
0068459a : MOV EAX,dword ptr [ESP + 0xc]
0068459e : PUSH 0x8
006845a0 : PUSH EAX
006845a1 : JMP 0x006845c5
006845a3 : MOV ECX,dword ptr [EAX + 0x4]
006845a6 : LEA EDX,[ECX*0x4 + 0x4]
006845ad : MOV ECX,dword ptr [EAX]
006845af : LEA ECX,[ECX + ECX*0x4]
006845b2 : CMP ECX,EDX
006845b4 : JBE 0x006845ca
006845b6 : MOV EDX,dword ptr [EAX + 0x4]
006845b9 : MOV ECX,dword ptr [ESP + 0xc]
006845bd : LEA EAX,[EDX + EDX*0x1 + 0x2]
006845c1 : PUSH EAX
006845c2 : PUSH ECX
006845c3 : MOV ECX,ESI
006845c5 : CALL 0x00684240
006845ca : MOV EAX,dword ptr [ESI]
006845cc : MOV ECX,dword ptr [ESP + 0x14]
006845d0 : AND ECX,dword ptr [EAX + 0x4]
006845d3 : INC dword ptr [EAX]
006845d5 : MOV ESI,dword ptr [ESI]
006845d7 : LEA EDX,[ECX + ECX*0x4]
006845da : MOV EBP,dword ptr [ESI + EDX*0x4 + 0x8]
006845de : LEA EAX,[ESI + EDX*0x4 + 0x8]
006845e2 : CMP EBP,-0x2
006845e5 : JNZ 0x0068460e
006845e7 : MOV EDX,dword ptr [ESP + 0x10]
006845eb : MOV dword ptr [EAX],0xffffffff
006845f1 : MOV ESI,dword ptr [EDX]
006845f3 : MOV ESI,dword ptr [ESI]
006845f5 : MOV dword ptr [EAX + 0x8],ESI
006845f8 : MOV EDX,dword ptr [EDX + 0x4]
006845fb : MOV ESI,dword ptr [EDX]
006845fd : MOV dword ptr [EAX + 0xc],ESI
00684600 : MOV EDX,dword ptr [EDX + 0x4]
00684603 : POP ESI
00684604 : MOV dword ptr [EAX + 0x10],EDX
00684607 : MOV dword ptr [EAX + 0x4],ECX
0068460a : POP EBP
0068460b : RET 0xc
0068460e : PUSH EDI
0068460f : MOV EDI,dword ptr [ESI + 0x4]
00684612 : MOV EDX,ECX
00684614 : PUSH EBX
00684615 : INC EDX
00684616 : AND EDX,EDI
00684618 : LEA EBX,[EDX + EDX*0x4]
0068461b : CMP dword ptr [ESI + EBX*0x4 + 0x8],-0x2
00684620 : JNZ 0x00684615
00684622 : LEA EDI,[EDX + EDX*0x4]
00684625 : LEA EBX,[ESI + EDI*0x4 + 0x8]
00684629 : MOV EDI,dword ptr [EAX + 0x4]
0068462c : CMP EDI,ECX
0068462e : JNZ 0x00684673
00684630 : TEST EBX,EBX
00684632 : JZ 0x0068464e
00684634 : MOV dword ptr [EBX],EBP
00684636 : MOV ESI,dword ptr [EAX + 0x4]
00684639 : MOV dword ptr [EBX + 0x4],ESI
0068463c : MOV ESI,dword ptr [EAX + 0x8]
0068463f : MOV dword ptr [EBX + 0x8],ESI
00684642 : MOV ESI,dword ptr [EAX + 0xc]
00684645 : MOV dword ptr [EBX + 0xc],ESI
00684648 : MOV ESI,dword ptr [EAX + 0x10]
0068464b : MOV dword ptr [EBX + 0x10],ESI
0068464e : MOV ESI,dword ptr [ESP + 0x18]
00684652 : MOV EDI,dword ptr [ESI]
00684654 : MOV EDI,dword ptr [EDI]
00684656 : MOV dword ptr [EAX + 0x8],EDI
00684659 : MOV ESI,dword ptr [ESI + 0x4]
0068465c : MOV EDI,dword ptr [ESI]
0068465e : MOV dword ptr [EAX + 0xc],EDI
00684661 : MOV ESI,dword ptr [ESI + 0x4]
00684664 : POP EBX
00684665 : MOV dword ptr [EAX + 0x10],ESI
00684668 : POP EDI
00684669 : POP ESI
0068466a : MOV dword ptr [EAX],EDX
0068466c : MOV dword ptr [EAX + 0x4],ECX
0068466f : POP EBP
00684670 : RET 0xc
00684673 : LEA EDI,[EDI + EDI*0x4]
00684676 : CMP dword ptr [ESI + EDI*0x4 + 0x8],ECX
0068467a : LEA EDI,[ESI + EDI*0x4 + 0x8]
0068467e : JZ 0x0068468f
00684680 : MOV EDI,dword ptr [EDI]
00684682 : LEA EDI,[EDI + EDI*0x4]
00684685 : CMP dword ptr [ESI + EDI*0x4 + 0x8],ECX
00684689 : LEA EDI,[ESI + EDI*0x4 + 0x8]
0068468d : JNZ 0x00684680
0068468f : TEST EBX,EBX
00684691 : JZ 0x006846ad
00684693 : MOV dword ptr [EBX],EBP
00684695 : MOV ESI,dword ptr [EAX + 0x4]
00684698 : MOV dword ptr [EBX + 0x4],ESI
0068469b : MOV ESI,dword ptr [EAX + 0x8]
0068469e : MOV dword ptr [EBX + 0x8],ESI
006846a1 : MOV ESI,dword ptr [EAX + 0xc]
006846a4 : MOV dword ptr [EBX + 0xc],ESI
006846a7 : MOV ESI,dword ptr [EAX + 0x10]
006846aa : MOV dword ptr [EBX + 0x10],ESI
006846ad : MOV dword ptr [EDI],EDX
006846af : MOV EDX,dword ptr [ESP + 0x18]
006846b3 : MOV ESI,dword ptr [EDX]
006846b5 : MOV ESI,dword ptr [ESI]
006846b7 : MOV dword ptr [EAX + 0x8],ESI
006846ba : MOV EDX,dword ptr [EDX + 0x4]
006846bd : MOV ESI,dword ptr [EDX]
006846bf : POP EBX
006846c0 : MOV dword ptr [EAX + 0xc],ESI
006846c3 : MOV EDX,dword ptr [EDX + 0x4]
006846c6 : POP EDI
006846c7 : MOV dword ptr [EAX + 0x10],EDX
006846ca : POP ESI
006846cb : MOV dword ptr [EAX],0xffffffff
006846d1 : MOV dword ptr [EAX + 0x4],ECX
006846d4 : POP EBP
006846d5 : RET 0xc

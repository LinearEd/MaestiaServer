PROGRAM  : Maestia.exe
FUNCTION : FUN_00520600
ENTRY    : 00520600
BODY     : [[00520600, 005206b3]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00520600(uint *param_1)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  int in_ECX;
  uint local_10;
  uint local_c;
  uint local_8;
  uint local_4;
  
  local_10 = *param_1;
  if ((local_10 == 0x40) || (local_10 == 0x80)) {
    local_c = 0;
    local_8 = 0xff000000;
    local_4 = local_4 & 0xffff0000;
  }
  else {
    local_8 = param_1[2];
    local_c = param_1[1];
    local_4 = param_1[3];
  }
  iVar3 = *(int *)(in_ECX + 0x88);
  if (iVar3 != 0) {
    uVar1 = local_c;
    if ((local_10 & 0x20000) != 0) {
      uVar1 = (int)(short)local_8 ^ local_c;
    }
    iVar2 = FUN_0051dae0(&local_10,*(uint *)(iVar3 + 4) & uVar1);
    if ((-1 < iVar2) && (iVar3 = iVar3 + 0x10 + iVar2 * 0x24, iVar3 != 0)) {
      iVar3 = iVar3 + 0x10;
      return CONCAT31((int3)((uint)iVar3 >> 8),iVar3 != 0);
    }
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00520600 : MOV EAX,dword ptr [ESP + 0x4]
00520604 : MOV EDX,dword ptr [EAX]
00520606 : SUB ESP,0x10
00520609 : PUSH ESI
0052060a : PUSH EDI
0052060b : CMP EDX,0x40
0052060e : JZ 0x0052062b
00520610 : CMP EDX,0x80
00520616 : JZ 0x0052062b
00520618 : MOV ESI,dword ptr [EAX + 0x8]
0052061b : MOV EDI,dword ptr [EAX + 0x4]
0052061e : MOV EAX,dword ptr [EAX + 0xc]
00520621 : MOV dword ptr [ESP + 0x10],ESI
00520625 : MOV dword ptr [ESP + 0x14],EAX
00520629 : JMP 0x00520645
0052062b : XOR EDI,EDI
0052062d : XOR EAX,EAX
0052062f : MOV word ptr [ESP + 0x10],AX
00520634 : MOV byte ptr [ESP + 0x12],AL
00520638 : MOV byte ptr [ESP + 0x13],0xff
0052063d : MOV byte ptr [ESP + 0x14],AL
00520641 : MOV byte ptr [ESP + 0x15],AL
00520645 : MOV ESI,dword ptr [ECX + 0x88]
0052064b : ADD ECX,0x88
00520651 : MOV dword ptr [ESP + 0xc],EDI
00520655 : MOV dword ptr [ESP + 0x8],EDX
00520659 : TEST ESI,ESI
0052065b : JZ 0x005206a1
0052065d : MOV EAX,EDI
0052065f : TEST EDX,0x20000
00520665 : JZ 0x0052066e
00520667 : MOVSX EAX,word ptr [ESP + 0x10]
0052066c : XOR EAX,EDI
0052066e : MOV EDX,dword ptr [ESI + 0x4]
00520671 : AND EDX,EAX
00520673 : PUSH EDX
00520674 : LEA EAX,[ESP + 0xc]
00520678 : PUSH EAX
00520679 : CALL 0x0051dae0
0052067e : TEST EAX,EAX
00520680 : JL 0x005206a1
00520682 : LEA ECX,[EAX + EAX*0x8]
00520685 : LEA EAX,[ESI + ECX*0x4 + 0x10]
00520689 : TEST EAX,EAX
0052068b : JZ 0x005206a1
0052068d : ADD EAX,0x10
00520690 : XOR EDX,EDX
00520692 : TEST EAX,EAX
00520694 : SETNZ DL
00520697 : POP EDI
00520698 : MOV AL,DL
0052069a : POP ESI
0052069b : ADD ESP,0x10
0052069e : RET 0x4
005206a1 : XOR EAX,EAX
005206a3 : XOR EDX,EDX
005206a5 : TEST EAX,EAX
005206a7 : SETNZ DL
005206aa : POP EDI
005206ab : MOV AL,DL
005206ad : POP ESI
005206ae : ADD ESP,0x10
005206b1 : RET 0x4

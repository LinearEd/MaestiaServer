PROGRAM  : Maestia.exe
FUNCTION : FUN_00522380
ENTRY    : 00522380
BODY     : [[00522380, 005224d4]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00522380(undefined4 param_1,undefined4 *param_2,uint param_3)

{
  uint *puVar1;
  uint *puVar2;
  uint *puVar3;
  int *piVar4;
  uint uVar5;
  uint uVar6;
  int *in_ECX;
  uint uVar7;
  int iVar8;
  
  piVar4 = (int *)*in_ECX;
  if (piVar4 == (int *)0x0) {
    iVar8 = 8;
  }
  else {
    if ((uint)(*piVar4 * 5) <= piVar4[1] * 4 + 4U) goto LAB_005223ba;
    iVar8 = piVar4[1] * 2 + 2;
  }
  FUN_005221a0(param_1,iVar8);
LAB_005223ba:
  piVar4 = (int *)*in_ECX;
  param_3 = param_3 & piVar4[1];
  *piVar4 = *piVar4 + 1;
  iVar8 = *in_ECX;
  puVar1 = (uint *)(iVar8 + 8 + param_3 * 0x24);
  uVar5 = *puVar1;
  if (uVar5 == 0xfffffffe) {
    *puVar1 = 0xffffffff;
    FUN_00520b10(param_2);
    puVar1[1] = param_3;
    return;
  }
  uVar7 = param_3;
  do {
    uVar7 = uVar7 + 1 & *(uint *)(iVar8 + 4);
  } while (*(int *)(iVar8 + 8 + uVar7 * 0x24) != -2);
  uVar6 = puVar1[1];
  puVar2 = (uint *)(iVar8 + 8 + uVar7 * 0x24);
  if (uVar6 == param_3) {
    if (puVar2 != (uint *)0x0) {
      *puVar2 = uVar5;
      puVar2[1] = puVar1[1];
      FUN_005213f0(puVar1 + 2);
    }
    puVar2 = (uint *)*param_2;
    puVar1[2] = *puVar2;
    puVar1[3] = puVar2[1];
    puVar1[4] = puVar2[2];
    puVar1[5] = puVar2[3];
    FUN_0051f920(param_2[1]);
    *puVar1 = uVar7;
    puVar1[1] = param_3;
    return;
  }
  puVar3 = (uint *)(iVar8 + 8 + uVar6 * 0x24);
  for (uVar6 = *(uint *)(iVar8 + 8 + uVar6 * 0x24); uVar6 != param_3;
      uVar6 = *(uint *)(iVar8 + 8 + uVar6 * 0x24)) {
    uVar6 = *puVar3;
    puVar3 = (uint *)(iVar8 + 8 + uVar6 * 0x24);
  }
  if (puVar2 != (uint *)0x0) {
    *puVar2 = uVar5;
    puVar2[1] = puVar1[1];
    FUN_005213f0(puVar1 + 2);
  }
  *puVar3 = uVar7;
  puVar2 = (uint *)*param_2;
  puVar1[2] = *puVar2;
  puVar1[3] = puVar2[1];
  puVar1[4] = puVar2[2];
  puVar1[5] = puVar2[3];
  FUN_0051f920(param_2[1]);
  puVar1[1] = param_3;
  *puVar1 = 0xffffffff;
  return;
}



============================================================
DISASSEMBLY
============================================================
00522380 : PUSH ESI
00522381 : MOV ESI,ECX
00522383 : MOV EAX,dword ptr [ESI]
00522385 : PUSH EDI
00522386 : TEST EAX,EAX
00522388 : JNZ 0x00522393
0052238a : MOV EAX,dword ptr [ESP + 0xc]
0052238e : PUSH 0x8
00522390 : PUSH EAX
00522391 : JMP 0x005223b5
00522393 : MOV ECX,dword ptr [EAX + 0x4]
00522396 : LEA EDX,[ECX*0x4 + 0x4]
0052239d : MOV ECX,dword ptr [EAX]
0052239f : LEA ECX,[ECX + ECX*0x4]
005223a2 : CMP ECX,EDX
005223a4 : JBE 0x005223ba
005223a6 : MOV EDX,dword ptr [EAX + 0x4]
005223a9 : MOV ECX,dword ptr [ESP + 0xc]
005223ad : LEA EAX,[EDX + EDX*0x1 + 0x2]
005223b1 : PUSH EAX
005223b2 : PUSH ECX
005223b3 : MOV ECX,ESI
005223b5 : CALL 0x005221a0
005223ba : MOV EAX,dword ptr [ESI]
005223bc : MOV EDI,dword ptr [ESP + 0x14]
005223c0 : AND EDI,dword ptr [EAX + 0x4]
005223c3 : INC dword ptr [EAX]
005223c5 : MOV EAX,dword ptr [ESI]
005223c7 : LEA EDX,[EDI + EDI*0x8]
005223ca : LEA ESI,[EAX + EDX*0x4 + 0x8]
005223ce : MOV EDX,dword ptr [ESI]
005223d0 : CMP EDX,-0x2
005223d3 : JNZ 0x005223f0
005223d5 : MOV EAX,dword ptr [ESP + 0x10]
005223d9 : PUSH EAX
005223da : LEA ECX,[ESI + 0x8]
005223dd : MOV dword ptr [ESI],0xffffffff
005223e3 : CALL 0x00520b10
005223e8 : MOV dword ptr [ESI + 0x4],EDI
005223eb : POP EDI
005223ec : POP ESI
005223ed : RET 0xc
005223f0 : MOV ECX,dword ptr [EAX + 0x4]
005223f3 : PUSH EBX
005223f4 : MOV EBX,EDI
005223f6 : PUSH EBP
005223f7 : INC EBX
005223f8 : AND EBX,ECX
005223fa : LEA EBP,[EBX + EBX*0x8]
005223fd : CMP dword ptr [EAX + EBP*0x4 + 0x8],-0x2
00522402 : JNZ 0x005223f7
00522404 : MOV EBP,dword ptr [ESI + 0x4]
00522407 : LEA ECX,[EBX + EBX*0x8]
0052240a : LEA ECX,[EAX + ECX*0x4 + 0x8]
0052240e : CMP EBP,EDI
00522410 : JNZ 0x0052245f
00522412 : TEST ECX,ECX
00522414 : JZ 0x0052242a
00522416 : MOV dword ptr [ECX],EDX
00522418 : MOV EDX,dword ptr [ESI + 0x4]
0052241b : LEA EAX,[ESI + 0x8]
0052241e : MOV dword ptr [ECX + 0x4],EDX
00522421 : PUSH EAX
00522422 : ADD ECX,0x8
00522425 : CALL 0x005213f0
0052242a : MOV ECX,dword ptr [ESP + 0x18]
0052242e : MOV EAX,dword ptr [ECX]
00522430 : MOV EDX,dword ptr [EAX]
00522432 : MOV dword ptr [ESI + 0x8],EDX
00522435 : MOV EDX,dword ptr [EAX + 0x4]
00522438 : MOV dword ptr [ESI + 0xc],EDX
0052243b : MOV EDX,dword ptr [EAX + 0x8]
0052243e : MOV dword ptr [ESI + 0x10],EDX
00522441 : MOV EAX,dword ptr [EAX + 0xc]
00522444 : MOV dword ptr [ESI + 0x14],EAX
00522447 : MOV ECX,dword ptr [ECX + 0x4]
0052244a : PUSH ECX
0052244b : LEA ECX,[ESI + 0x18]
0052244e : CALL 0x0051f920
00522453 : POP EBP
00522454 : MOV dword ptr [ESI],EBX
00522456 : POP EBX
00522457 : MOV dword ptr [ESI + 0x4],EDI
0052245a : POP EDI
0052245b : POP ESI
0052245c : RET 0xc
0052245f : LEA EBP,[EBP + EBP*0x8]
00522463 : CMP dword ptr [EAX + EBP*0x4 + 0x8],EDI
00522467 : LEA EBP,[EAX + EBP*0x4 + 0x8]
0052246b : JZ 0x00522481
0052246d : LEA ECX,[ECX]
00522470 : MOV EBP,dword ptr [EBP]
00522473 : LEA EBP,[EBP + EBP*0x8]
00522477 : CMP dword ptr [EAX + EBP*0x4 + 0x8],EDI
0052247b : LEA EBP,[EAX + EBP*0x4 + 0x8]
0052247f : JNZ 0x00522470
00522481 : TEST ECX,ECX
00522483 : JZ 0x00522499
00522485 : MOV dword ptr [ECX],EDX
00522487 : MOV EDX,dword ptr [ESI + 0x4]
0052248a : LEA EAX,[ESI + 0x8]
0052248d : MOV dword ptr [ECX + 0x4],EDX
00522490 : PUSH EAX
00522491 : ADD ECX,0x8
00522494 : CALL 0x005213f0
00522499 : MOV ECX,dword ptr [ESP + 0x18]
0052249d : MOV dword ptr [EBP],EBX
005224a0 : MOV EAX,dword ptr [ECX]
005224a2 : MOV EDX,dword ptr [EAX]
005224a4 : MOV dword ptr [ESI + 0x8],EDX
005224a7 : MOV EDX,dword ptr [EAX + 0x4]
005224aa : MOV dword ptr [ESI + 0xc],EDX
005224ad : MOV EDX,dword ptr [EAX + 0x8]
005224b0 : MOV dword ptr [ESI + 0x10],EDX
005224b3 : MOV EAX,dword ptr [EAX + 0xc]
005224b6 : MOV dword ptr [ESI + 0x14],EAX
005224b9 : MOV ECX,dword ptr [ECX + 0x4]
005224bc : PUSH ECX
005224bd : LEA ECX,[ESI + 0x18]
005224c0 : CALL 0x0051f920
005224c5 : POP EBP
005224c6 : POP EBX
005224c7 : MOV dword ptr [ESI + 0x4],EDI
005224ca : POP EDI
005224cb : MOV dword ptr [ESI],0xffffffff
005224d1 : POP ESI
005224d2 : RET 0xc

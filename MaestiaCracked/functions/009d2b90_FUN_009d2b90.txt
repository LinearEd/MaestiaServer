PROGRAM  : Maestia.exe
FUNCTION : FUN_009d2b90
ENTRY    : 009d2b90
BODY     : [[009d2b90, 009d2bdc] [009d2be0, 009d2fec] [009d2ff0, 009d30a0]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009d2b90(int param_1,undefined1 param_2,undefined1 param_3,undefined1 param_4,
                 undefined1 param_5,undefined1 param_6,undefined1 param_7,undefined2 param_8,
                 undefined4 param_9)

{
  short sVar1;
  uint3 uVar2;
  short *psVar3;
  DWORD DVar4;
  uint8_t *packet;
  undefined4 uVar5;
  ushort *packet_00;
  short *in_ECX;
  int iVar6;
  int iVar7;
  byte bVar8;
  undefined4 ***pppuVar9;
  undefined4 *puVar10;
  void *_Src;
  undefined4 *puVar11;
  uint uStack_f8;
  undefined1 local_e4 [4];
  undefined2 local_e0;
  undefined4 local_d0;
  uint local_cc;
  undefined2 local_c0;
  undefined4 local_b0;
  uint local_ac;
  undefined4 **local_a8;
  undefined1 local_a4 [4];
  uint local_a0;
  void *local_9c;
  undefined4 local_98;
  undefined1 local_94;
  undefined1 local_91;
  undefined1 local_90;
  undefined1 local_8f;
  undefined1 local_38 [4];
  undefined4 **local_34 [4];
  int local_24;
  uint local_20;
  uint local_1c;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4222a;
  local_10 = ExceptionList;
  uStack_f8 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&uStack_f8;
  ExceptionList = &local_10;
  local_20 = 7;
  local_24 = 0;
  local_34[0] = (undefined4 **)((uint)local_34[0] & 0xffff0000);
  psVar3 = in_ECX;
  do {
    sVar1 = *psVar3;
    psVar3 = psVar3 + 1;
  } while (sVar1 != 0);
  local_1c = uStack_f8;
  FUN_00406360(in_ECX,(int)psVar3 - (int)(in_ECX + 1) >> 1);
  local_8 = 0;
  if (local_20 < 8) {
    local_a8 = local_34;
  }
  else {
    local_a8 = local_34[0];
  }
  pppuVar9 = (undefined4 ***)local_34[0];
  if (local_20 < 8) {
    pppuVar9 = local_34;
  }
  local_a0 = local_a0 & 0xffffff00;
  FUN_00412c80(local_a4,0xfffffffc,pppuVar9,0xfffffffc,(int)local_a8 + local_24 * 2,0xfffffffc,
               local_a8,local_a0,local_a0);
  _memset(&local_98,0,0x5a);
  local_98._0_1_ = param_2;
  local_98._1_1_ = param_3;
  local_98._2_1_ = param_4;
  local_98._3_1_ = param_5;
  local_94 = param_6;
  local_8f = param_7;
  local_90 = (char)*(undefined4 *)(DAT_017248c8 + 0x150);
  local_91 = *(undefined1 *)(param_1 + 0x78);
  if (local_24 == 0) {
    if ((*(int *)(param_1 + 0xcc) == 0) ||
       (DVar4 = timeGetTime(), 3000 < DVar4 - *(int *)(param_1 + 0xcc))) {
      puVar10 = &local_98;
      puVar11 = (undefined4 *)(param_1 + 0x71);
      for (iVar6 = 0x16; iVar6 != 0; iVar6 = iVar6 + -1) {
        *puVar11 = *puVar10;
        puVar10 = puVar10 + 1;
        puVar11 = puVar11 + 1;
      }
      *(undefined2 *)puVar11 = *(undefined2 *)puVar10;
      *(undefined2 *)(param_1 + 0x114) = param_8;
      FUN_00405eb0(local_38,0,0xffffffff);
      *(char *)(param_1 + 0x116) = (char)param_9;
      iVar6 = *(int *)ThreadLocalStoragePointer;
      bVar8 = (byte)((ulonglong)(*(byte *)(iVar6 + 0x18) + 1) % 3);
      *(byte *)(iVar6 + 0x18) = bVar8;
      local_a0 = (uint)bVar8 * 0x2000 + 0x122cb8 + iVar6;
      local_8._0_1_ = 1;
      if (local_a0 == 0) {
        packet = (uint8_t *)0x0;
      }
      else {
        packet = (uint8_t *)
                 FUN_0041b4b0(local_a0,param_1 + 0x71,*(undefined2 *)(param_1 + 0x114),param_9);
      }
      local_8 = (uint)local_8._1_3_ << 8;
      if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
        FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),0x863,packet);
      }
      DVar4 = timeGetTime();
      *(DWORD *)(param_1 + 0xcc) = DVar4;
    }
  }
  else {
    puVar10 = &local_98;
    puVar11 = (undefined4 *)(param_1 + 0x71);
    for (iVar6 = 0x16; iVar6 != 0; iVar6 = iVar6 + -1) {
      *puVar11 = *puVar10;
      puVar10 = puVar10 + 1;
      puVar11 = puVar11 + 1;
    }
    *(undefined2 *)puVar11 = *(undefined2 *)puVar10;
    *(undefined2 *)(param_1 + 0x7b) = 0;
    FUN_009d1f20(param_1,local_38);
    iVar7 = *(int *)(param_1 + 0x15c) - *(int *)(param_1 + 0x158);
    iVar6 = iVar7 >> 0x1f;
    if (iVar7 / 0x28 + iVar6 == iVar6) {
      FUN_00406460(L"IDS_PRIVATESHOP_ITEM_NOT_FOUND");
      local_8._0_1_ = 2;
      uVar5 = FUN_0081d120(local_e4);
      local_8._0_1_ = 3;
      FUN_008ede80(uVar5,0);
      local_8 = CONCAT31(local_8._1_3_,2);
      if (7 < local_ac) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_ac = 7;
      local_b0 = 0;
      local_c0 = 0;
      local_8 = (uint)local_8._1_3_ << 8;
      if (7 < local_cc) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_cc = 7;
      local_d0 = 0;
      local_e0 = 0;
      local_8 = 0xffffffff;
      if (7 < local_20) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_20 = 7;
      local_24 = 0;
      local_34[0] = (undefined4 **)((uint)local_34[0] & 0xffff0000);
      goto LAB_009d3083;
    }
    iVar6 = *(int *)(param_1 + 0x15c) - *(int *)(param_1 + 0x158);
    *(short *)(param_1 + 0x76) =
         ((short)(iVar6 / 0x28) + (short)(iVar6 >> 0x1f)) -
         (short)((longlong)iVar6 * 0x66666667 >> 0x3f);
    *(undefined2 *)(param_1 + 0x114) = param_8;
    FUN_00405eb0(local_38,0,0xffffffff);
    *(char *)(param_1 + 0x116) = (char)param_9;
    if (0x3ff < *(ushort *)(param_1 + 0x76)) {
      *(undefined2 *)(param_1 + 0x76) = 0x400;
    }
    iVar6 = *(int *)ThreadLocalStoragePointer;
    bVar8 = (byte)((ulonglong)(*(byte *)(iVar6 + 0x18) + 1) % 3);
    *(byte *)(iVar6 + 0x18) = bVar8;
    local_a0 = (uint)bVar8 * 0x2000 + 0x122cb8 + iVar6;
    local_8._0_1_ = 4;
    if (local_a0 == 0) {
      packet_00 = (ushort *)0x0;
    }
    else {
      packet_00 = (ushort *)
                  FUN_0041b4b0(local_a0,param_1 + 0x71,*(undefined2 *)(param_1 + 0x114),
                               *(undefined1 *)(param_1 + 0x116));
    }
    uVar2 = local_8._1_3_;
    local_8 = (uint)local_8._1_3_ << 8;
    if (packet_00 == (ushort *)0x0) {
      local_8 = 0xffffffff;
      FUN_00406560();
      goto LAB_009d3083;
    }
    _Src = (void *)0x0;
    local_9c = (void *)0x0;
    if (*(short *)(param_1 + 0x76) != 0) {
      local_8 = CONCAT31(uVar2,5);
      _Src = (void *)FUN_006f0820((uint)*(ushort *)(param_1 + 0x76) * 2);
      local_8 = 0;
      local_9c = _Src;
      FUN_0041a860(*(undefined4 *)(param_1 + 0x158),*(undefined4 *)(param_1 + 0x15c));
      iVar6 = 0;
      if (*(short *)(param_1 + 0x76) != 0) {
        do {
          *(undefined2 *)((int)_Src + iVar6 * 2) =
               *(undefined2 *)(*(int *)(param_1 + 0x158) + iVar6 * 0x28 + 0x20);
          iVar6 = iVar6 + 1;
        } while (iVar6 < (int)(uint)*(ushort *)(param_1 + 0x76));
      }
      _memcpy((void *)((int)packet_00 + 99),_Src,(uint)*(ushort *)(param_1 + 0x76) * 2);
    }
    if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
      FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),*packet_00 & 0x1fff,(uint8_t *)packet_00);
    }
    DVar4 = timeGetTime();
    *(DWORD *)(param_1 + 0xcc) = DVar4;
    if (_Src != (void *)0x0) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  local_8 = 0xffffffff;
  if (7 < local_20) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_20 = 7;
  local_24 = 0;
  local_34[0] = (undefined4 **)((uint)local_34[0] & 0xffff0000);
LAB_009d3083:
  ExceptionList = local_10;
  __security_check_cookie(local_1c ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
009d2b90 : PUSH EBP
009d2b91 : MOV EBP,ESP
009d2b93 : PUSH -0x1
009d2b95 : PUSH 0xb4222a
009d2b9a : MOV EAX,FS:[0x0]
009d2ba0 : PUSH EAX
009d2ba1 : SUB ESP,0xd8
009d2ba7 : MOV EAX,[0x00d66fa0]
009d2bac : XOR EAX,EBP
009d2bae : MOV dword ptr [EBP + -0x18],EAX
009d2bb1 : PUSH EBX
009d2bb2 : PUSH ESI
009d2bb3 : PUSH EDI
009d2bb4 : PUSH EAX
009d2bb5 : LEA EAX,[EBP + -0xc]
009d2bb8 : MOV FS:[0x0],EAX
009d2bbe : MOV dword ptr [EBP + -0x10],ESP
009d2bc1 : MOV EBX,dword ptr [EBP + 0x8]
009d2bc4 : MOV dword ptr [EBP + -0x1c],0x7
009d2bcb : XOR EDI,EDI
009d2bcd : MOV dword ptr [EBP + -0x20],EDI
009d2bd0 : XOR EAX,EAX
009d2bd2 : MOV word ptr [EBP + -0x30],AX
009d2bd6 : MOV EAX,ECX
009d2bd8 : LEA EDX,[EAX + 0x2]
009d2bdb : JMP 0x009d2be0
009d2be0 : MOV SI,word ptr [EAX]
009d2be3 : ADD EAX,0x2
009d2be6 : CMP SI,DI
009d2be9 : JNZ 0x009d2be0
009d2beb : SUB EAX,EDX
009d2bed : SAR EAX,0x1
009d2bef : PUSH EAX
009d2bf0 : PUSH ECX
009d2bf1 : LEA ECX,[EBP + -0x34]
009d2bf4 : CALL 0x00406360
009d2bf9 : MOV dword ptr [EBP + -0x4],EDI
009d2bfc : MOV EAX,dword ptr [EBP + -0x1c]
009d2bff : MOV ESI,dword ptr [EBP + -0x30]
009d2c02 : CMP EAX,0x8
009d2c05 : JC 0x009d2c0f
009d2c07 : MOV dword ptr [EBP + 0xffffff5c],ESI
009d2c0d : JMP 0x009d2c18
009d2c0f : LEA ECX,[EBP + -0x30]
009d2c12 : MOV dword ptr [EBP + 0xffffff5c],ECX
009d2c18 : CMP EAX,0x8
009d2c1b : MOV ECX,ESI
009d2c1d : JNC 0x009d2c22
009d2c1f : LEA ECX,[EBP + -0x30]
009d2c22 : MOV EDX,dword ptr [EBP + -0x20]
009d2c25 : LEA ECX,[ECX + EDX*0x2]
009d2c28 : MOV EDX,0xfffffffc
009d2c2d : CMP EAX,0x8
009d2c30 : JNC 0x009d2c35
009d2c32 : LEA ESI,[EBP + -0x30]
009d2c35 : MOV EAX,EDX
009d2c37 : MOV byte ptr [EBP + 0xffffff64],0x0
009d2c3e : MOV EDI,dword ptr [EBP + 0xffffff64]
009d2c44 : PUSH EDI
009d2c45 : MOV EDI,dword ptr [EBP + 0xffffff64]
009d2c4b : PUSH EDI
009d2c4c : MOV EDI,dword ptr [EBP + 0xffffff5c]
009d2c52 : PUSH EDI
009d2c53 : MOV EDI,EAX
009d2c55 : PUSH EDI
009d2c56 : PUSH ECX
009d2c57 : PUSH EDX
009d2c58 : PUSH ESI
009d2c59 : PUSH EAX
009d2c5a : LEA EAX,[EBP + 0xffffff60]
009d2c60 : PUSH EAX
009d2c61 : MOV EDI,0x9d04e0
009d2c66 : CALL 0x00412c80
009d2c6b : ADD ESP,0x24
009d2c6e : PUSH 0x5a
009d2c70 : PUSH 0x0
009d2c72 : LEA ECX,[EBP + 0xffffff6c]
009d2c78 : PUSH ECX
009d2c79 : CALL 0x0063b700
009d2c7e : ADD ESP,0xc
009d2c81 : MOV DL,byte ptr [EBP + 0xc]
009d2c84 : MOV byte ptr [EBP + 0xffffff6c],DL
009d2c8a : MOV AL,byte ptr [EBP + 0x10]
009d2c8d : MOV byte ptr [EBP + 0xffffff6d],AL
009d2c93 : MOV CL,byte ptr [EBP + 0x14]
009d2c96 : MOV byte ptr [EBP + 0xffffff6e],CL
009d2c9c : MOV DL,byte ptr [EBP + 0x18]
009d2c9f : MOV byte ptr [EBP + 0xffffff6f],DL
009d2ca5 : MOV AL,byte ptr [EBP + 0x1c]
009d2ca8 : MOV byte ptr [EBP + 0xffffff70],AL
009d2cae : MOV CL,byte ptr [EBP + 0x20]
009d2cb1 : MOV byte ptr [EBP + 0xffffff75],CL
009d2cb7 : MOV EDX,dword ptr [0x017248c8]
009d2cbd : MOV EAX,dword ptr [EDX + 0x150]
009d2cc3 : MOV byte ptr [EBP + 0xffffff74],AL
009d2cc9 : MOVZX EAX,byte ptr [EBX + 0x78]
009d2ccd : MOV byte ptr [EBP + 0xffffff73],AL
009d2cd3 : CMP dword ptr [EBP + -0x20],0x0
009d2cd7 : JNZ 0x009d2db5
009d2cdd : CMP dword ptr [EBX + 0xcc],0x0
009d2ce4 : JZ 0x009d2cfd
009d2ce6 : CALL dword ptr [0x00b85598]
009d2cec : SUB EAX,dword ptr [EBX + 0xcc]
009d2cf2 : CMP EAX,0xbb8
009d2cf7 : JBE 0x009d305a
009d2cfd : LEA EDI,[EBX + 0x71]
009d2d00 : MOV ECX,0x16
009d2d05 : LEA ESI,[EBP + 0xffffff6c]
009d2d0b : MOVSD.REP ES:EDI,ESI
009d2d0d : MOVSW ES:EDI,ESI
009d2d0f : MOV CX,word ptr [EBP + 0x24]
009d2d13 : MOV word ptr [EBX + 0x114],CX
009d2d1a : PUSH -0x1
009d2d1c : PUSH 0x0
009d2d1e : LEA EDX,[EBP + -0x34]
009d2d21 : PUSH EDX
009d2d22 : LEA ECX,[EBX + 0x118]
009d2d28 : CALL 0x00405eb0
009d2d2d : MOV ECX,dword ptr [EBP + 0x28]
009d2d30 : MOV byte ptr [EBX + 0x116],CL
009d2d36 : MOV EAX,FS:[0x2c]
009d2d3c : MOV ESI,dword ptr [EAX]
009d2d3e : MOVZX EAX,byte ptr [ESI + 0x18]
009d2d42 : INC EAX
009d2d43 : CDQ
009d2d44 : MOV EDI,0x3
009d2d49 : IDIV EDI
009d2d4b : MOV byte ptr [ESI + 0x18],DL
009d2d4e : MOVZX EDX,DL
009d2d51 : SHL EDX,0xd
009d2d54 : LEA ESI,[EDX + ESI*0x1 + 0x122cb8]
009d2d5b : MOV dword ptr [EBP + 0xffffff64],ESI
009d2d61 : MOV byte ptr [EBP + -0x4],0x1
009d2d65 : TEST ESI,ESI
009d2d67 : JZ 0x009d2d7e
009d2d69 : PUSH ECX
009d2d6a : MOVZX EAX,word ptr [EBX + 0x114]
009d2d71 : PUSH EAX
009d2d72 : LEA EAX,[EBX + 0x71]
009d2d75 : PUSH EAX
009d2d76 : PUSH ESI
009d2d77 : CALL 0x0041b4b0
009d2d7c : JMP 0x009d2d80
009d2d7e : XOR EAX,EAX
009d2d80 : MOV byte ptr [EBP + -0x4],0x0
009d2d84 : MOV EDX,dword ptr [0x017247d4]
009d2d8a : MOV ECX,dword ptr [EDX + 0x4]
009d2d8d : TEST ECX,ECX
009d2d8f : JZ 0x009d2da4
009d2d91 : CMP byte ptr [EDX + 0x8],0x0
009d2d95 : JZ 0x009d2da4
009d2d97 : PUSH 0x863
009d2d9c : PUSH ECX
009d2d9d : MOV EDI,EAX
009d2d9f : CALL 0x00a0dd40
009d2da4 : CALL dword ptr [0x00b85598]
009d2daa : MOV dword ptr [EBX + 0xcc],EAX
009d2db0 : JMP 0x009d305a
009d2db5 : LEA EDI,[EBX + 0x71]
009d2db8 : MOV ECX,0x16
009d2dbd : LEA ESI,[EBP + 0xffffff6c]
009d2dc3 : MOVSD.REP ES:EDI,ESI
009d2dc5 : MOVSW ES:EDI,ESI
009d2dc7 : XOR ECX,ECX
009d2dc9 : MOV word ptr [EBX + 0x7b],CX
009d2dcd : LEA EDX,[EBP + -0x34]
009d2dd0 : PUSH EDX
009d2dd1 : PUSH EBX
009d2dd2 : CALL 0x009d1f20
009d2dd7 : MOV ECX,dword ptr [EBX + 0x15c]
009d2ddd : SUB ECX,dword ptr [EBX + 0x158]
009d2de3 : MOV EAX,0x66666667
009d2de8 : IMUL ECX
009d2dea : SAR EDX,0x4
009d2ded : MOV EAX,EDX
009d2def : SHR EAX,0x1f
009d2df2 : ADD EAX,EDX
009d2df4 : JNZ 0x009d2ec1
009d2dfa : PUSH 0xc97360
009d2dff : LEA ECX,[EBP + 0xffffff20]
009d2e05 : CALL 0x00406460
009d2e0a : MOV byte ptr [EBP + -0x4],0x2
009d2e0e : LEA ECX,[EBP + 0xffffff20]
009d2e14 : PUSH ECX
009d2e15 : LEA EDI,[EBP + 0xffffff40]
009d2e1b : MOV ECX,dword ptr [0x0172491c]
009d2e21 : CALL 0x0081d120
009d2e26 : MOV byte ptr [EBP + -0x4],0x3
009d2e2a : MOV EDX,dword ptr [0x00da9894]
009d2e30 : MOV ECX,dword ptr [EDX]
009d2e32 : XOR EBX,EBX
009d2e34 : PUSH EBX
009d2e35 : PUSH EAX
009d2e36 : CALL 0x008ede80
009d2e3b : MOV byte ptr [EBP + -0x4],0x2
009d2e3f : MOV ESI,0x8
009d2e44 : CMP dword ptr [EBP + 0xffffff58],ESI
009d2e4a : JC 0x009d2e57
009d2e4c : MOV ECX,dword ptr [EBP + 0xffffff44]
009d2e52 : CALL 0x006f04e0
009d2e57 : MOV EDI,0x7
009d2e5c : MOV dword ptr [EBP + 0xffffff58],EDI
009d2e62 : MOV dword ptr [EBP + 0xffffff54],EBX
009d2e68 : XOR EAX,EAX
009d2e6a : MOV word ptr [EBP + 0xffffff44],AX
009d2e71 : MOV byte ptr [EBP + -0x4],BL
009d2e74 : CMP dword ptr [EBP + 0xffffff38],ESI
009d2e7a : JC 0x009d2e87
009d2e7c : MOV ECX,dword ptr [EBP + 0xffffff24]
009d2e82 : CALL 0x006f04e0
009d2e87 : MOV dword ptr [EBP + 0xffffff38],EDI
009d2e8d : MOV dword ptr [EBP + 0xffffff34],EBX
009d2e93 : XOR ECX,ECX
009d2e95 : MOV word ptr [EBP + 0xffffff24],CX
009d2e9c : MOV dword ptr [EBP + -0x4],0xffffffff
009d2ea3 : CMP dword ptr [EBP + -0x1c],ESI
009d2ea6 : JC 0x009d2eb0
009d2ea8 : MOV ECX,dword ptr [EBP + -0x30]
009d2eab : CALL 0x006f04e0
009d2eb0 : MOV dword ptr [EBP + -0x1c],EDI
009d2eb3 : MOV dword ptr [EBP + -0x20],EBX
009d2eb6 : XOR EDX,EDX
009d2eb8 : MOV word ptr [EBP + -0x30],DX
009d2ebc : JMP 0x009d3083
009d2ec1 : MOV ECX,dword ptr [EBX + 0x15c]
009d2ec7 : SUB ECX,dword ptr [EBX + 0x158]
009d2ecd : MOV EAX,0x66666667
009d2ed2 : IMUL ECX
009d2ed4 : SAR EDX,0x4
009d2ed7 : MOV EAX,EDX
009d2ed9 : SHR EAX,0x1f
009d2edc : ADD EAX,EDX
009d2ede : MOV word ptr [EBX + 0x76],AX
009d2ee2 : MOV CX,word ptr [EBP + 0x24]
009d2ee6 : MOV word ptr [EBX + 0x114],CX
009d2eed : PUSH -0x1
009d2eef : PUSH 0x0
009d2ef1 : LEA EDX,[EBP + -0x34]
009d2ef4 : PUSH EDX
009d2ef5 : LEA ECX,[EBX + 0x118]
009d2efb : CALL 0x00405eb0
009d2f00 : MOV AL,byte ptr [EBP + 0x28]
009d2f03 : MOV byte ptr [EBX + 0x116],AL
009d2f09 : MOV ECX,0x400
009d2f0e : CMP CX,word ptr [EBX + 0x76]
009d2f12 : JA 0x009d2f1a
009d2f14 : MOV EDX,ECX
009d2f16 : MOV word ptr [EBX + 0x76],DX
009d2f1a : MOV EAX,FS:[0x2c]
009d2f20 : MOV ECX,dword ptr [EAX]
009d2f22 : MOVZX EAX,byte ptr [ECX + 0x18]
009d2f26 : INC EAX
009d2f27 : CDQ
009d2f28 : MOV ESI,0x3
009d2f2d : IDIV ESI
009d2f2f : MOV byte ptr [ECX + 0x18],DL
009d2f32 : MOVZX EDX,DL
009d2f35 : SHL EDX,0xd
009d2f38 : LEA EAX,[EDX + ECX*0x1 + 0x122cb8]
009d2f3f : MOV dword ptr [EBP + 0xffffff64],EAX
009d2f45 : MOV byte ptr [EBP + -0x4],0x4
009d2f49 : TEST EAX,EAX
009d2f4b : JZ 0x009d2f6b
009d2f4d : MOVZX ECX,byte ptr [EBX + 0x116]
009d2f54 : PUSH ECX
009d2f55 : MOVZX EDX,word ptr [EBX + 0x114]
009d2f5c : PUSH EDX
009d2f5d : LEA ECX,[EBX + 0x71]
009d2f60 : PUSH ECX
009d2f61 : PUSH EAX
009d2f62 : CALL 0x0041b4b0
009d2f67 : MOV EDI,EAX
009d2f69 : JMP 0x009d2f6d
009d2f6b : XOR EDI,EDI
009d2f6d : MOV byte ptr [EBP + -0x4],0x0
009d2f71 : TEST EDI,EDI
009d2f73 : JNZ 0x009d2f89
009d2f75 : MOV dword ptr [EBP + -0x4],0xffffffff
009d2f7c : LEA ECX,[EBP + -0x34]
009d2f7f : CALL 0x00406560
009d2f84 : JMP 0x009d3083
009d2f89 : XOR ESI,ESI
009d2f8b : MOV dword ptr [EBP + 0xffffff68],ESI
009d2f91 : CMP word ptr [EBX + 0x76],SI
009d2f95 : JBE 0x009d3021
009d2f9b : MOV byte ptr [EBP + -0x4],0x5
009d2f9f : MOVZX EAX,word ptr [EBX + 0x76]
009d2fa3 : XOR ECX,ECX
009d2fa5 : MOV EDX,0x2
009d2faa : MUL EDX
009d2fac : SETO CL
009d2faf : NEG ECX
009d2fb1 : OR ECX,EAX
009d2fb3 : PUSH ECX
009d2fb4 : CALL 0x006f0820
009d2fb9 : ADD ESP,0x4
009d2fbc : MOV ESI,EAX
009d2fbe : MOV dword ptr [EBP + 0xffffff68],ESI
009d2fc4 : MOV dword ptr [EBP + -0x4],0x0
009d2fcb : MOV EAX,dword ptr [EBX + 0x15c]
009d2fd1 : MOV ECX,dword ptr [EBX + 0x158]
009d2fd7 : PUSH EAX
009d2fd8 : PUSH ECX
009d2fd9 : CALL 0x0041a860
009d2fde : ADD ESP,0x8
009d2fe1 : XOR EAX,EAX
009d2fe3 : XOR ECX,ECX
009d2fe5 : CMP CX,word ptr [EBX + 0x76]
009d2fe9 : JNC 0x009d300d
009d2feb : JMP 0x009d2ff0
009d2ff0 : LEA EDX,[EAX + EAX*0x4]
009d2ff3 : MOV ECX,dword ptr [EBX + 0x158]
009d2ff9 : LEA ECX,[ECX + EDX*0x8]
009d2ffc : MOV DX,word ptr [ECX + 0x20]
009d3000 : MOV word ptr [ESI + EAX*0x2],DX
009d3004 : INC EAX
009d3005 : MOVZX ECX,word ptr [EBX + 0x76]
009d3009 : CMP EAX,ECX
009d300b : JL 0x009d2ff0
009d300d : MOVZX EDX,word ptr [EBX + 0x76]
009d3011 : ADD EDX,EDX
009d3013 : PUSH EDX
009d3014 : PUSH ESI
009d3015 : LEA EAX,[EDI + 0x63]
009d3018 : PUSH EAX
009d3019 : CALL 0x0063ae40
009d301e : ADD ESP,0xc
009d3021 : MOVZX EAX,word ptr [EDI]
009d3024 : AND EAX,0x1fff
009d3029 : MOV EDX,dword ptr [0x017247d4]
009d302f : MOV ECX,dword ptr [EDX + 0x4]
009d3032 : TEST ECX,ECX
009d3034 : JZ 0x009d3043
009d3036 : CMP byte ptr [EDX + 0x8],0x0
009d303a : JZ 0x009d3043
009d303c : PUSH EAX
009d303d : PUSH ECX
009d303e : CALL 0x00a0dd40
009d3043 : CALL dword ptr [0x00b85598]
009d3049 : MOV dword ptr [EBX + 0xcc],EAX
009d304f : TEST ESI,ESI
009d3051 : JZ 0x009d305a
009d3053 : MOV ECX,ESI
009d3055 : CALL 0x006f04e0
009d305a : MOV dword ptr [EBP + -0x4],0xffffffff
009d3061 : CMP dword ptr [EBP + -0x1c],0x8
009d3065 : JC 0x009d306f
009d3067 : MOV ECX,dword ptr [EBP + -0x30]
009d306a : CALL 0x006f04e0
009d306f : MOV dword ptr [EBP + -0x1c],0x7
009d3076 : MOV dword ptr [EBP + -0x20],0x0
009d307d : XOR EAX,EAX
009d307f : MOV word ptr [EBP + -0x30],AX
009d3083 : MOV ECX,dword ptr [EBP + -0xc]
009d3086 : MOV dword ptr FS:[0x0],ECX
009d308d : POP ECX
009d308e : POP EDI
009d308f : POP ESI
009d3090 : POP EBX
009d3091 : MOV ECX,dword ptr [EBP + -0x18]
009d3094 : XOR ECX,EBP
009d3096 : CALL 0x00633e6b
009d309b : MOV ESP,EBP
009d309d : POP EBP
009d309e : RET 0x24

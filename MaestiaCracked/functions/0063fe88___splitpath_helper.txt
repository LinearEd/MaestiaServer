PROGRAM  : Maestia.exe
FUNCTION : __splitpath_helper
ENTRY    : 0063fe88
BODY     : [[0063fe88, 00640079]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    __splitpath_helper
   
   Library: Visual Studio 2008 Release */

undefined4
__splitpath_helper(uchar *param_1,uchar *param_2,uint param_3,uchar *param_4,uint param_5,
                  uchar *param_6,uint param_7,uchar *param_8,uint param_9)

{
  uchar uVar1;
  bool bVar2;
  int iVar3;
  int *piVar4;
  undefined4 uVar5;
  uchar *puVar6;
  uchar *puVar7;
  uchar *local_8;
  
  bVar2 = false;
  if (param_1 != (uchar *)0x0) {
    if (param_2 == (uchar *)0x0) {
      if (param_3 == 0) {
LAB_0063feaf:
        if (param_4 == (uchar *)0x0) {
          if (param_5 == 0) {
LAB_0063fec0:
            if (param_6 == (uchar *)0x0) {
              if (param_7 == 0) {
LAB_0063fed1:
                if (param_8 == (uchar *)0x0) {
                  if (param_9 == 0) {
LAB_0063fedb:
                    iVar3 = 1;
                    puVar6 = param_1;
                    do {
                      if (*puVar6 == '\0') break;
                      iVar3 = iVar3 + -1;
                      puVar6 = puVar6 + 1;
                    } while (iVar3 != 0);
                    if (*puVar6 == ':') {
                      if (param_2 != (uchar *)0x0) {
                        if (param_3 < 3) goto LAB_0063fff3;
                        __mbsnbcpy_s(param_2,0xffffffff,param_1,2);
                      }
                      param_1 = puVar6 + 1;
                    }
                    else if (param_2 != (uchar *)0x0) {
                      *param_2 = '\0';
                    }
                    puVar6 = (uchar *)0x0;
                    local_8 = (uchar *)0x0;
                    puVar7 = param_1;
                    if (*param_1 == '\0') {
LAB_0063ff8c:
                      puVar6 = param_1;
                      if (param_4 != (uchar *)0x0) {
                        *param_4 = '\0';
                      }
                    }
                    else {
                      do {
                        iVar3 = __ismbblead((int)(char)*puVar7);
                        if (iVar3 == 0) {
                          uVar1 = *puVar7;
                          if ((uVar1 == '/') || (uVar1 == '\\')) {
                            puVar6 = puVar7 + 1;
                          }
                          else if (uVar1 == '.') {
                            local_8 = puVar7;
                          }
                        }
                        else {
                          puVar7 = puVar7 + 1;
                        }
                        puVar7 = puVar7 + 1;
                      } while (*puVar7 != '\0');
                      if (puVar6 == (uchar *)0x0) goto LAB_0063ff8c;
                      if (param_4 != (uchar *)0x0) {
                        if (param_5 <= (uint)((int)puVar6 - (int)param_1)) goto LAB_0063fff3;
                        __mbsnbcpy_s(param_4,0xffffffff,param_1,(int)puVar6 - (int)param_1);
                      }
                    }
                    param_1 = puVar6;
                    if ((local_8 == (uchar *)0x0) || (local_8 < param_1)) {
                      if (param_6 != (uchar *)0x0) {
                        if (param_7 <= (uint)((int)puVar7 - (int)param_1)) goto LAB_0063fff3;
                        __mbsnbcpy_s(param_6,0xffffffff,param_1,(int)puVar7 - (int)param_1);
                      }
                      if (param_8 != (uchar *)0x0) {
                        *param_8 = '\0';
                      }
                      return 0;
                    }
                    if (param_6 != (uchar *)0x0) {
                      if (param_7 <= (uint)((int)local_8 - (int)param_1)) goto LAB_0063fff3;
                      __mbsnbcpy_s(param_6,0xffffffff,param_1,(int)local_8 - (int)param_1);
                    }
                    if (param_8 == (uchar *)0x0) {
                      return 0;
                    }
                    if ((uint)((int)puVar7 - (int)local_8) < param_9) {
                      __mbsnbcpy_s(param_8,0xffffffff,local_8,(int)puVar7 - (int)local_8);
                      return 0;
                    }
                    goto LAB_0063fff3;
                  }
                }
                else if (param_9 != 0) goto LAB_0063fedb;
              }
            }
            else if (param_7 != 0) goto LAB_0063fed1;
          }
        }
        else if (param_5 != 0) goto LAB_0063fec0;
      }
    }
    else if (param_3 != 0) goto LAB_0063feaf;
  }
  bVar2 = true;
LAB_0063fff3:
  if ((param_2 != (uchar *)0x0) && (param_3 != 0)) {
    *param_2 = '\0';
  }
  if ((param_4 != (uchar *)0x0) && (param_5 != 0)) {
    *param_4 = '\0';
  }
  if ((param_6 != (uchar *)0x0) && (param_7 != 0)) {
    *param_6 = '\0';
  }
  if ((param_8 != (uchar *)0x0) && (param_9 != 0)) {
    *param_8 = '\0';
  }
  piVar4 = __errno();
  if ((param_1 == (uchar *)0x0) || (bVar2)) {
    uVar5 = 0x16;
    *piVar4 = 0x16;
    __invalid_parameter(0,0,0,0,0);
  }
  else {
    uVar5 = 0x22;
    *piVar4 = 0x22;
  }
  return uVar5;
}



============================================================
DISASSEMBLY
============================================================
0063fe88 : MOV EDI,EDI
0063fe8a : PUSH EBP
0063fe8b : MOV EBP,ESP
0063fe8d : PUSH ECX
0063fe8e : PUSH ECX
0063fe8f : PUSH EBX
0063fe90 : XOR EBX,EBX
0063fe92 : PUSH ESI
0063fe93 : PUSH EDI
0063fe94 : MOV dword ptr [EBP + -0x8],EBX
0063fe97 : CMP dword ptr [EBP + 0x8],EBX
0063fe9a : JZ 0x0063ff19
0063fe9c : MOV ECX,dword ptr [EBP + 0xc]
0063fe9f : CMP ECX,EBX
0063fea1 : JNZ 0x0063feaa
0063fea3 : CMP dword ptr [EBP + 0x10],EBX
0063fea6 : JNZ 0x0063ff19
0063fea8 : JMP 0x0063feaf
0063feaa : CMP dword ptr [EBP + 0x10],EBX
0063fead : JZ 0x0063ff19
0063feaf : CMP dword ptr [EBP + 0x14],EBX
0063feb2 : JNZ 0x0063febb
0063feb4 : CMP dword ptr [EBP + 0x18],EBX
0063feb7 : JNZ 0x0063ff19
0063feb9 : JMP 0x0063fec0
0063febb : CMP dword ptr [EBP + 0x18],EBX
0063febe : JZ 0x0063ff19
0063fec0 : CMP dword ptr [EBP + 0x1c],EBX
0063fec3 : JNZ 0x0063fecc
0063fec5 : CMP dword ptr [EBP + 0x20],EBX
0063fec8 : JNZ 0x0063ff19
0063feca : JMP 0x0063fed1
0063fecc : CMP dword ptr [EBP + 0x20],EBX
0063fecf : JZ 0x0063ff19
0063fed1 : CMP dword ptr [EBP + 0x24],EBX
0063fed4 : JNZ 0x0063ff14
0063fed6 : CMP dword ptr [EBP + 0x28],EBX
0063fed9 : JNZ 0x0063ff19
0063fedb : MOV ESI,dword ptr [EBP + 0x8]
0063fede : XOR EAX,EAX
0063fee0 : INC EAX
0063fee1 : CMP byte ptr [ESI],BL
0063fee3 : JZ 0x0063feeb
0063fee5 : DEC EAX
0063fee6 : INC ESI
0063fee7 : CMP EAX,EBX
0063fee9 : JA 0x0063fee1
0063feeb : CMP byte ptr [ESI],0x3a
0063feee : JNZ 0x0063ff25
0063fef0 : CMP ECX,EBX
0063fef2 : JZ 0x0063ff0e
0063fef4 : CMP dword ptr [EBP + 0x10],0x3
0063fef8 : JC 0x0063fff3
0063fefe : PUSH 0x2
0063ff00 : PUSH dword ptr [EBP + 0x8]
0063ff03 : PUSH -0x1
0063ff05 : PUSH ECX
0063ff06 : CALL 0x0065be4d
0063ff0b : ADD ESP,0x10
0063ff0e : INC ESI
0063ff0f : MOV dword ptr [EBP + 0x8],ESI
0063ff12 : JMP 0x0063ff2b
0063ff14 : CMP dword ptr [EBP + 0x28],EBX
0063ff17 : JNZ 0x0063fedb
0063ff19 : MOV dword ptr [EBP + -0x8],0x1
0063ff20 : JMP 0x0063fff3
0063ff25 : CMP ECX,EBX
0063ff27 : JZ 0x0063ff2b
0063ff29 : MOV byte ptr [ECX],BL
0063ff2b : MOV ESI,dword ptr [EBP + 0x8]
0063ff2e : XOR EDI,EDI
0063ff30 : MOV dword ptr [EBP + -0x4],EBX
0063ff33 : CMP byte ptr [ESI],BL
0063ff35 : JZ 0x0063ff8c
0063ff37 : MOVSX EAX,byte ptr [ESI]
0063ff3a : PUSH EAX
0063ff3b : CALL 0x0065be35
0063ff40 : POP ECX
0063ff41 : TEST EAX,EAX
0063ff43 : JZ 0x0063ff48
0063ff45 : INC ESI
0063ff46 : JMP 0x0063ff5e
0063ff48 : MOV AL,byte ptr [ESI]
0063ff4a : CMP AL,0x2f
0063ff4c : JZ 0x0063ff5b
0063ff4e : CMP AL,0x5c
0063ff50 : JZ 0x0063ff5b
0063ff52 : CMP AL,0x2e
0063ff54 : JNZ 0x0063ff5e
0063ff56 : MOV dword ptr [EBP + -0x4],ESI
0063ff59 : JMP 0x0063ff5e
0063ff5b : LEA EDI,[ESI + 0x1]
0063ff5e : INC ESI
0063ff5f : CMP byte ptr [ESI],BL
0063ff61 : JNZ 0x0063ff37
0063ff63 : CMP EDI,EBX
0063ff65 : JZ 0x0063ff8c
0063ff67 : CMP dword ptr [EBP + 0x14],EBX
0063ff6a : JZ 0x0063ff87
0063ff6c : MOV EAX,EDI
0063ff6e : SUB EAX,dword ptr [EBP + 0x8]
0063ff71 : CMP dword ptr [EBP + 0x18],EAX
0063ff74 : JBE 0x0063fff3
0063ff76 : PUSH EAX
0063ff77 : PUSH dword ptr [EBP + 0x8]
0063ff7a : PUSH -0x1
0063ff7c : PUSH dword ptr [EBP + 0x14]
0063ff7f : CALL 0x0065be4d
0063ff84 : ADD ESP,0x10
0063ff87 : MOV dword ptr [EBP + 0x8],EDI
0063ff8a : JMP 0x0063ff95
0063ff8c : MOV EAX,dword ptr [EBP + 0x14]
0063ff8f : CMP EAX,EBX
0063ff91 : JZ 0x0063ff95
0063ff93 : MOV byte ptr [EAX],BL
0063ff95 : MOV EAX,dword ptr [EBP + -0x4]
0063ff98 : CMP EAX,EBX
0063ff9a : JZ 0x0063ffe6
0063ff9c : CMP EAX,dword ptr [EBP + 0x8]
0063ff9f : JC 0x0063ffe6
0063ffa1 : CMP dword ptr [EBP + 0x1c],EBX
0063ffa4 : JZ 0x0063ffbf
0063ffa6 : SUB EAX,dword ptr [EBP + 0x8]
0063ffa9 : CMP dword ptr [EBP + 0x20],EAX
0063ffac : JBE 0x0063fff3
0063ffae : PUSH EAX
0063ffaf : PUSH dword ptr [EBP + 0x8]
0063ffb2 : PUSH -0x1
0063ffb4 : PUSH dword ptr [EBP + 0x1c]
0063ffb7 : CALL 0x0065be4d
0063ffbc : ADD ESP,0x10
0063ffbf : CMP dword ptr [EBP + 0x24],EBX
0063ffc2 : JZ 0x00640073
0063ffc8 : SUB ESI,dword ptr [EBP + -0x4]
0063ffcb : CMP dword ptr [EBP + 0x28],ESI
0063ffce : JBE 0x0063fff3
0063ffd0 : PUSH ESI
0063ffd1 : PUSH dword ptr [EBP + -0x4]
0063ffd4 : PUSH -0x1
0063ffd6 : PUSH dword ptr [EBP + 0x24]
0063ffd9 : CALL 0x0065be4d
0063ffde : ADD ESP,0x10
0063ffe1 : JMP 0x00640073
0063ffe6 : CMP dword ptr [EBP + 0x1c],EBX
0063ffe9 : JZ 0x0064006a
0063ffeb : SUB ESI,dword ptr [EBP + 0x8]
0063ffee : CMP dword ptr [EBP + 0x20],ESI
0063fff1 : JA 0x00640059
0063fff3 : MOV EAX,dword ptr [EBP + 0xc]
0063fff6 : CMP EAX,EBX
0063fff8 : JZ 0x00640001
0063fffa : CMP dword ptr [EBP + 0x10],EBX
0063fffd : JBE 0x00640001
0063ffff : MOV byte ptr [EAX],BL
00640001 : MOV EAX,dword ptr [EBP + 0x14]
00640004 : CMP EAX,EBX
00640006 : JZ 0x0064000f
00640008 : CMP dword ptr [EBP + 0x18],EBX
0064000b : JBE 0x0064000f
0064000d : MOV byte ptr [EAX],BL
0064000f : MOV EAX,dword ptr [EBP + 0x1c]
00640012 : CMP EAX,EBX
00640014 : JZ 0x0064001d
00640016 : CMP dword ptr [EBP + 0x20],EBX
00640019 : JBE 0x0064001d
0064001b : MOV byte ptr [EAX],BL
0064001d : MOV EAX,dword ptr [EBP + 0x24]
00640020 : CMP EAX,EBX
00640022 : JZ 0x0064002b
00640024 : CMP dword ptr [EBP + 0x28],EBX
00640027 : JBE 0x0064002b
00640029 : MOV byte ptr [EAX],BL
0064002b : CALL 0x0063ab82
00640030 : CMP dword ptr [EBP + 0x8],EBX
00640033 : JNZ 0x0064004b
00640035 : PUSH 0x16
00640037 : POP ESI
00640038 : PUSH EBX
00640039 : PUSH EBX
0064003a : PUSH EBX
0064003b : PUSH EBX
0064003c : PUSH EBX
0064003d : MOV dword ptr [EAX],ESI
0064003f : CALL 0x006372b8
00640044 : ADD ESP,0x14
00640047 : MOV EAX,ESI
00640049 : JMP 0x00640075
0064004b : CMP dword ptr [EBP + -0x8],EBX
0064004e : JNZ 0x00640035
00640050 : PUSH 0x22
00640052 : POP ECX
00640053 : MOV dword ptr [EAX],ECX
00640055 : MOV EAX,ECX
00640057 : JMP 0x00640075
00640059 : PUSH ESI
0064005a : PUSH dword ptr [EBP + 0x8]
0064005d : PUSH -0x1
0064005f : PUSH dword ptr [EBP + 0x1c]
00640062 : CALL 0x0065be4d
00640067 : ADD ESP,0x10
0064006a : MOV EAX,dword ptr [EBP + 0x24]
0064006d : CMP EAX,EBX
0064006f : JZ 0x00640073
00640071 : MOV byte ptr [EAX],BL
00640073 : XOR EAX,EAX
00640075 : POP EDI
00640076 : POP ESI
00640077 : POP EBX
00640078 : LEAVE
00640079 : RET

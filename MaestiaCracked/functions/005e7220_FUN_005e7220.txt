PROGRAM  : Maestia.exe
FUNCTION : FUN_005e7220
ENTRY    : 005e7220
BODY     : [[005e7220, 005e7459]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005e7220(uint param_1,undefined4 param_2)

{
  undefined1 uVar1;
  undefined1 uVar2;
  undefined1 uVar3;
  undefined1 uVar4;
  int iVar5;
  LONG LVar6;
  int iVar7;
  uint uVar8;
  uint local_14;
  int local_10;
  uint local_c;
  GThread *local_8;
  int local_4;
  
  uVar8 = param_1;
  local_10 = *(int *)(param_1 + 0x314);
  if (local_10 == 0) {
    local_10 = param_1 + 0x28;
  }
  iVar7 = local_10;
  *(undefined1 *)(local_10 + 0x15) = 0;
  if (*(int *)(local_10 + 0x30) - *(int *)(local_10 + 0x2c) < 2) {
    FUN_00539fb0(2);
  }
  local_8 = (GThread *)(uint)*(ushort *)(*(int *)(iVar7 + 0x3c) + *(int *)(iVar7 + 0x2c));
  *(int *)(iVar7 + 0x2c) = *(int *)(iVar7 + 0x2c) + 2;
  iVar7 = *(int *)(uVar8 + 0x314);
  if (iVar7 == 0) {
    iVar7 = uVar8 + 0x28;
  }
  *(undefined1 *)(iVar7 + 0x15) = 0;
  if (*(int *)(iVar7 + 0x30) - *(int *)(iVar7 + 0x2c) < 2) {
    FUN_00539fb0(2);
  }
  iVar5 = *(int *)(iVar7 + 0x2c);
  local_c = (uint)CONCAT11(*(undefined1 *)(*(int *)(iVar7 + 0x3c) + 1 + iVar5),
                           *(undefined1 *)(*(int *)(iVar7 + 0x3c) + iVar5));
  *(int *)(iVar7 + 0x2c) = iVar5 + 2;
  iVar7 = *(int *)(uVar8 + 0x314);
  if (iVar7 == 0) {
    iVar7 = uVar8 + 0x28;
  }
  *(undefined1 *)(iVar7 + 0x15) = 0;
  if (*(int *)(iVar7 + 0x30) - *(int *)(iVar7 + 0x2c) < 2) {
    FUN_00539fb0(2);
  }
  iVar5 = *(int *)(iVar7 + 0x2c);
  uVar1 = *(undefined1 *)(*(int *)(iVar7 + 0x3c) + 1 + iVar5);
  uVar2 = *(undefined1 *)(*(int *)(iVar7 + 0x3c) + iVar5);
  *(int *)(iVar7 + 0x2c) = iVar5 + 2;
  iVar7 = *(int *)(uVar8 + 0x314);
  if (iVar7 == 0) {
    iVar7 = uVar8 + 0x28;
  }
  *(undefined1 *)(iVar7 + 0x15) = 0;
  if (*(int *)(iVar7 + 0x30) - *(int *)(iVar7 + 0x2c) < 2) {
    FUN_00539fb0(2);
  }
  iVar5 = *(int *)(iVar7 + 0x2c);
  uVar3 = *(undefined1 *)(*(int *)(iVar7 + 0x3c) + 1 + iVar5);
  uVar4 = *(undefined1 *)(*(int *)(iVar7 + 0x3c) + iVar5);
  *(int *)(iVar7 + 0x2c) = iVar5 + 2;
  FUN_0051b6e0();
  FUN_0051b6e0();
  FUN_0053a9b0(&local_14);
  FUN_0053a9b0(&param_1);
  GThread::OnExit(local_8);
  FUN_005e70e0(uVar8,local_8,(param_1 & 0xfffffffc) + 8,(local_14 & 0xfffffffc) + 8,local_c,
               CONCAT11(uVar1,uVar2),CONCAT11(uVar3,uVar4));
  if ((local_8 == (GThread *)0x0) && (local_4 != 0)) {
    FUN_00524240();
  }
  uVar8 = param_1 & 0xfffffffc;
  LVar6 = InterlockedExchangeAdd((LONG *)(uVar8 + 4),-1);
  if (LVar6 == 1) {
    FUN_00515cf0(uVar8);
  }
  LVar6 = InterlockedExchangeAdd((LONG *)((local_14 & 0xfffffffc) + 4),-1);
  if (LVar6 == 1) {
    FUN_00515cf0(local_14 & 0xfffffffc);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005e7220 : SUB ESP,0x14
005e7223 : PUSH EBX
005e7224 : PUSH EBP
005e7225 : MOV EBP,dword ptr [ESP + 0x20]
005e7229 : PUSH ESI
005e722a : MOV ESI,dword ptr [EBP + 0x314]
005e7230 : PUSH EDI
005e7231 : TEST ESI,ESI
005e7233 : JNZ 0x005e723e
005e7235 : LEA EAX,[EBP + 0x28]
005e7238 : MOV dword ptr [ESP + 0x14],EAX
005e723c : JMP 0x005e7242
005e723e : MOV dword ptr [ESP + 0x14],ESI
005e7242 : TEST ESI,ESI
005e7244 : JNZ 0x005e7249
005e7246 : LEA ESI,[EBP + 0x28]
005e7249 : MOV ECX,dword ptr [ESI + 0x30]
005e724c : SUB ECX,dword ptr [ESI + 0x2c]
005e724f : MOV byte ptr [ESI + 0x15],0x0
005e7253 : CMP ECX,0x2
005e7256 : JGE 0x005e7261
005e7258 : PUSH 0x2
005e725a : MOV ECX,ESI
005e725c : CALL 0x00539fb0
005e7261 : MOV EAX,dword ptr [ESI + 0x2c]
005e7264 : MOV EDX,dword ptr [ESI + 0x3c]
005e7267 : LEA ECX,[EDX + EAX*0x1]
005e726a : MOVZX DX,byte ptr [ECX + 0x1]
005e726f : MOVZX CX,byte ptr [ECX]
005e7273 : SHL DX,0x8
005e7277 : OR DX,CX
005e727a : MOVZX ECX,DX
005e727d : ADD EAX,0x2
005e7280 : MOV dword ptr [ESI + 0x2c],EAX
005e7283 : MOV ESI,dword ptr [EBP + 0x314]
005e7289 : MOVZX EDX,CX
005e728c : MOV dword ptr [ESP + 0x1c],EDX
005e7290 : TEST ESI,ESI
005e7292 : JNZ 0x005e7297
005e7294 : LEA ESI,[EBP + 0x28]
005e7297 : MOV EAX,dword ptr [ESI + 0x30]
005e729a : SUB EAX,dword ptr [ESI + 0x2c]
005e729d : MOV byte ptr [ESI + 0x15],0x0
005e72a1 : CMP EAX,0x2
005e72a4 : JGE 0x005e72af
005e72a6 : PUSH 0x2
005e72a8 : MOV ECX,ESI
005e72aa : CALL 0x00539fb0
005e72af : MOV EAX,dword ptr [ESI + 0x2c]
005e72b2 : MOV ECX,dword ptr [ESI + 0x3c]
005e72b5 : MOVZX DX,byte ptr [ECX + EAX*0x1 + 0x1]
005e72bb : ADD ECX,EAX
005e72bd : MOVZX CX,byte ptr [ECX]
005e72c1 : SHL DX,0x8
005e72c5 : OR DX,CX
005e72c8 : ADD EAX,0x2
005e72cb : MOVZX EDX,DX
005e72ce : MOV dword ptr [ESI + 0x2c],EAX
005e72d1 : MOV ESI,dword ptr [EBP + 0x314]
005e72d7 : MOV dword ptr [ESP + 0x18],EDX
005e72db : TEST ESI,ESI
005e72dd : JNZ 0x005e72e2
005e72df : LEA ESI,[EBP + 0x28]
005e72e2 : MOV EAX,dword ptr [ESI + 0x30]
005e72e5 : SUB EAX,dword ptr [ESI + 0x2c]
005e72e8 : MOV byte ptr [ESI + 0x15],0x0
005e72ec : CMP EAX,0x2
005e72ef : JGE 0x005e72fa
005e72f1 : PUSH 0x2
005e72f3 : MOV ECX,ESI
005e72f5 : CALL 0x00539fb0
005e72fa : MOV EAX,dword ptr [ESI + 0x2c]
005e72fd : MOV ECX,dword ptr [ESI + 0x3c]
005e7300 : MOVZX DX,byte ptr [ECX + EAX*0x1 + 0x1]
005e7306 : ADD ECX,EAX
005e7308 : MOVZX CX,byte ptr [ECX]
005e730c : ADD EAX,0x2
005e730f : SHL DX,0x8
005e7313 : MOV dword ptr [ESI + 0x2c],EAX
005e7316 : MOV ESI,dword ptr [EBP + 0x314]
005e731c : OR DX,CX
005e731f : MOVZX EBX,DX
005e7322 : TEST ESI,ESI
005e7324 : JNZ 0x005e7329
005e7326 : LEA ESI,[EBP + 0x28]
005e7329 : MOV EDX,dword ptr [ESI + 0x30]
005e732c : SUB EDX,dword ptr [ESI + 0x2c]
005e732f : MOV byte ptr [ESI + 0x15],0x0
005e7333 : CMP EDX,0x2
005e7336 : JGE 0x005e7341
005e7338 : PUSH 0x2
005e733a : MOV ECX,ESI
005e733c : CALL 0x00539fb0
005e7341 : MOV EAX,dword ptr [ESI + 0x2c]
005e7344 : MOV ECX,dword ptr [ESI + 0x3c]
005e7347 : MOVZX DX,byte ptr [ECX + EAX*0x1 + 0x1]
005e734d : ADD ECX,EAX
005e734f : MOVZX CX,byte ptr [ECX]
005e7353 : SHL DX,0x8
005e7357 : OR DX,CX
005e735a : ADD EAX,0x2
005e735d : LEA ECX,[ESP + 0x10]
005e7361 : MOVZX EDI,DX
005e7364 : MOV dword ptr [ESI + 0x2c],EAX
005e7367 : CALL 0x0051b6e0
005e736c : LEA ECX,[ESP + 0x28]
005e7370 : CALL 0x0051b6e0
005e7375 : MOV ESI,dword ptr [ESP + 0x14]
005e7379 : LEA EDX,[ESP + 0x10]
005e737d : PUSH EDX
005e737e : MOV ECX,ESI
005e7380 : CALL 0x0053a9b0
005e7385 : LEA EAX,[ESP + 0x28]
005e7389 : PUSH EAX
005e738a : MOV ECX,ESI
005e738c : CALL 0x0053a9b0
005e7391 : MOV EAX,dword ptr [ESP + 0x10]
005e7395 : MOV ECX,dword ptr [ESP + 0x28]
005e7399 : MOVZX EDX,DI
005e739c : PUSH EDX
005e739d : AND EAX,0xfffffffc
005e73a0 : MOVZX EDX,BX
005e73a3 : PUSH EDX
005e73a4 : MOV EDX,dword ptr [ESP + 0x34]
005e73a8 : ADD EAX,0x8
005e73ab : PUSH EAX
005e73ac : MOVZX EAX,word ptr [ESP + 0x24]
005e73b1 : AND ECX,0xfffffffc
005e73b4 : ADD ECX,0x8
005e73b7 : PUSH ECX
005e73b8 : MOV ECX,dword ptr [ESP + 0x2c]
005e73bc : PUSH EAX
005e73bd : MOV EAX,dword ptr [EDX]
005e73bf : PUSH ECX
005e73c0 : PUSH EAX
005e73c1 : PUSH 0xb94158
005e73c6 : PUSH ESI
005e73c7 : CALL 0x0051d420
005e73cc : MOV EAX,dword ptr [ESP + 0x34]
005e73d0 : MOV ECX,dword ptr [ESP + 0x4c]
005e73d4 : MOV EDX,dword ptr [ESP + 0x3c]
005e73d8 : ADD ESP,0x24
005e73db : PUSH EDI
005e73dc : PUSH EBX
005e73dd : AND EAX,0xfffffffc
005e73e0 : PUSH EDX
005e73e1 : AND ECX,0xfffffffc
005e73e4 : ADD EAX,0x8
005e73e7 : PUSH EAX
005e73e8 : ADD ECX,0x8
005e73eb : PUSH ECX
005e73ec : PUSH ECX
005e73ed : MOV ECX,dword ptr [ESP + 0x34]
005e73f1 : MOV EAX,ESP
005e73f3 : PUSH EBP
005e73f4 : LEA EBX,[ESP + 0x38]
005e73f8 : MOV dword ptr [EAX],ECX
005e73fa : CALL 0x005e70e0
005e73ff : ADD ESP,0x1c
005e7402 : CMP dword ptr [ESP + 0x1c],0x0
005e7407 : JNZ 0x005e7416
005e7409 : MOV ECX,dword ptr [ESP + 0x20]
005e740d : TEST ECX,ECX
005e740f : JZ 0x005e7416
005e7411 : CALL 0x00524240
005e7416 : MOV ESI,dword ptr [ESP + 0x28]
005e741a : MOV EDI,dword ptr [0x00b851cc]
005e7420 : AND ESI,0xfffffffc
005e7423 : PUSH -0x1
005e7425 : LEA EDX,[ESI + 0x4]
005e7428 : PUSH EDX
005e7429 : CALL EDI
005e742b : SUB EAX,0x1
005e742e : JNZ 0x005e7436
005e7430 : PUSH ESI
005e7431 : CALL 0x00515cf0
005e7436 : MOV ESI,dword ptr [ESP + 0x10]
005e743a : AND ESI,0xfffffffc
005e743d : PUSH -0x1
005e743f : LEA EAX,[ESI + 0x4]
005e7442 : PUSH EAX
005e7443 : CALL EDI
005e7445 : SUB EAX,0x1
005e7448 : JNZ 0x005e7450
005e744a : PUSH ESI
005e744b : CALL 0x00515cf0
005e7450 : POP EDI
005e7451 : POP ESI
005e7452 : POP EBP
005e7453 : POP EBX
005e7454 : ADD ESP,0x14
005e7457 : RET 0x8

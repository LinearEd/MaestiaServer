PROGRAM  : Maestia.exe
FUNCTION : __handle_exc
ENTRY    : 0065dae9
BODY     : [[0065dae9, 0065dcca]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* Library Function - Single Match
    __handle_exc
   
   Library: Visual Studio 2008 Release */

bool __handle_exc(uint param_1,double *param_2,uint param_3)

{
  double dVar1;
  double dVar2;
  bool bVar3;
  double dVar4;
  uint uVar5;
  bool bVar6;
  float10 fVar7;
  uint local_18;
  byte bStack_14;
  undefined1 uStack_13;
  ushort uStack_12;
  int local_c;
  uint local_8;
  
  uVar5 = param_1 & 0x1f;
  bVar3 = true;
  local_8 = uVar5;
  if (((param_1 & 8) != 0) && ((param_3 & 1) != 0)) {
    FUN_0065e08d(1);
    uVar5 = param_1 & 0x17;
    goto LAB_0065dca9;
  }
  if (((param_1 & 4) != 0) && ((param_3 & 4) != 0)) {
    FUN_0065e08d(4);
    uVar5 = param_1 & 0x1b;
    goto LAB_0065dca9;
  }
  if (((param_1 & 1) == 0) || ((param_3 & 8) == 0)) {
    if (((param_1 & 2) == 0) || ((param_3 & 0x10) == 0)) goto LAB_0065dca9;
    bVar6 = (param_1 & 0x10) != 0;
    if (*param_2 != 0.0) {
      fVar7 = (float10)FUN_0065df8a(*param_2,&local_c);
      dVar2 = (double)fVar7;
      local_18 = SUB84(dVar2,0);
      bStack_14 = (byte)((ulonglong)dVar2 >> 0x20);
      uStack_13 = (undefined1)((ulonglong)dVar2 >> 0x28);
      uStack_12 = (ushort)((ulonglong)dVar2 >> 0x30);
      local_c = local_c + -0x600;
      if (local_c < -0x432) {
        dVar2 = dVar2 * 0.0;
        bVar6 = bVar3;
LAB_0065dc89:
        local_18 = SUB84(dVar2,0);
        bStack_14 = (byte)((ulonglong)dVar2 >> 0x20);
        uStack_13 = (undefined1)((ulonglong)dVar2 >> 0x28);
        uStack_12 = (ushort)((ulonglong)dVar2 >> 0x30);
      }
      else {
        uStack_12 = uStack_12 & 0xf | 0x10;
        if (local_c < -0x3fd) {
          local_c = -0x3fd - local_c;
          do {
            if (((local_18 & 1) != 0) && (!bVar6)) {
              bVar6 = bVar3;
            }
            local_18 = local_18 >> 1;
            if ((bStack_14 & 1) != 0) {
              local_18 = local_18 | 0x80000000;
            }
            uVar5 = CONCAT22(uStack_12,CONCAT11(uStack_13,bStack_14)) >> 1;
            bStack_14 = (byte)uVar5;
            uStack_13 = (undefined1)(uVar5 >> 8);
            uStack_12 = uStack_12 >> 1;
            local_c = local_c + -1;
          } while (local_c != 0);
        }
        if (dVar2 < 0.0) {
          dVar2 = -(double)CONCAT26(uStack_12,CONCAT15(uStack_13,CONCAT14(bStack_14,local_18)));
          goto LAB_0065dc89;
        }
      }
      *param_2 = (double)CONCAT26(uStack_12,CONCAT15(uStack_13,CONCAT14(bStack_14,local_18)));
      bVar3 = bVar6;
    }
    if (bVar3) {
      FUN_0065e08d(0x10);
    }
    uVar5 = local_8 & 0xfffffffd;
    local_8 = uVar5;
    goto LAB_0065dca9;
  }
  FUN_0065e08d(8);
  uVar5 = param_3 & 0xc00;
  dVar2 = _DAT_00d68370;
  dVar4 = _DAT_00d68370;
  if (uVar5 == 0) {
    dVar1 = *param_2;
joined_r0x0065db8d:
    if (dVar1 <= 0.0) {
      dVar2 = -dVar4;
    }
    *param_2 = dVar2;
  }
  else {
    if (uVar5 == 0x400) {
      dVar1 = *param_2;
      dVar2 = _DAT_00d68380;
      goto joined_r0x0065db8d;
    }
    dVar4 = _DAT_00d68380;
    if (uVar5 == 0x800) {
      dVar1 = *param_2;
      goto joined_r0x0065db8d;
    }
    if (uVar5 == 0xc00) {
      dVar1 = *param_2;
      dVar2 = _DAT_00d68380;
      goto joined_r0x0065db8d;
    }
  }
  uVar5 = param_1 & 0x1e;
LAB_0065dca9:
  if (((param_1 & 0x10) != 0) && ((param_3 & 0x20) != 0)) {
    FUN_0065e08d(0x20);
    uVar5 = uVar5 & 0xffffffef;
  }
  return uVar5 == 0;
}



============================================================
DISASSEMBLY
============================================================
0065dae9 : MOV EDI,EDI
0065daeb : PUSH EBP
0065daec : MOV EBP,ESP
0065daee : SUB ESP,0x14
0065daf1 : MOV EAX,dword ptr [EBP + 0x8]
0065daf4 : PUSH EBX
0065daf5 : PUSH ESI
0065daf6 : XOR EBX,EBX
0065daf8 : MOV ESI,EAX
0065dafa : AND ESI,0x1f
0065dafd : INC EBX
0065dafe : MOV dword ptr [EBP + -0x4],ESI
0065db01 : TEST AL,0x8
0065db03 : JZ 0x0065db19
0065db05 : TEST byte ptr [EBP + 0x10],BL
0065db08 : JZ 0x0065db19
0065db0a : PUSH EBX
0065db0b : CALL 0x0065e08d
0065db10 : POP ECX
0065db11 : AND ESI,0xfffffff7
0065db14 : JMP 0x0065dca9
0065db19 : TEST AL,0x4
0065db1b : JZ 0x0065db33
0065db1d : TEST byte ptr [EBP + 0x10],0x4
0065db21 : JZ 0x0065db33
0065db23 : PUSH 0x4
0065db25 : CALL 0x0065e08d
0065db2a : POP ECX
0065db2b : AND ESI,0xfffffffb
0065db2e : JMP 0x0065dca9
0065db33 : TEST BL,AL
0065db35 : JZ 0x0065dbd5
0065db3b : TEST byte ptr [EBP + 0x10],0x8
0065db3f : JZ 0x0065dbd5
0065db45 : PUSH 0x8
0065db47 : CALL 0x0065e08d
0065db4c : MOV EAX,dword ptr [EBP + 0x10]
0065db4f : POP ECX
0065db50 : MOV ECX,0xc00
0065db55 : AND EAX,ECX
0065db57 : JZ 0x0065dbad
0065db59 : CMP EAX,0x400
0065db5e : JZ 0x0065db97
0065db60 : CMP EAX,0x800
0065db65 : JZ 0x0065db81
0065db67 : CMP EAX,ECX
0065db69 : JNZ 0x0065dbcd
0065db6b : FLDZ
0065db6d : MOV ECX,dword ptr [EBP + 0xc]
0065db70 : FCOMP double ptr [ECX]
0065db72 : FNSTSW AX
0065db74 : FLD double ptr [0x00d68380]
0065db7a : TEST AH,0x5
0065db7d : JNP 0x0065dbcb
0065db7f : JMP 0x0065dbc9
0065db81 : FLDZ
0065db83 : MOV ECX,dword ptr [EBP + 0xc]
0065db86 : FCOMP double ptr [ECX]
0065db88 : FNSTSW AX
0065db8a : TEST AH,0x5
0065db8d : JNP 0x0065dbbb
0065db8f : FLD double ptr [0x00d68380]
0065db95 : JMP 0x0065dbc9
0065db97 : FLDZ
0065db99 : MOV ECX,dword ptr [EBP + 0xc]
0065db9c : FCOMP double ptr [ECX]
0065db9e : FNSTSW AX
0065dba0 : TEST AH,0x5
0065dba3 : JP 0x0065dbc3
0065dba5 : FLD double ptr [0x00d68380]
0065dbab : JMP 0x0065dbcb
0065dbad : FLDZ
0065dbaf : MOV ECX,dword ptr [EBP + 0xc]
0065dbb2 : FCOMP double ptr [ECX]
0065dbb4 : FNSTSW AX
0065dbb6 : TEST AH,0x5
0065dbb9 : JP 0x0065dbc3
0065dbbb : FLD double ptr [0x00d68370]
0065dbc1 : JMP 0x0065dbcb
0065dbc3 : FLD double ptr [0x00d68370]
0065dbc9 : FCHS
0065dbcb : FSTP double ptr [ECX]
0065dbcd : AND ESI,0xfffffffe
0065dbd0 : JMP 0x0065dca9
0065dbd5 : TEST AL,0x2
0065dbd7 : JZ 0x0065dca9
0065dbdd : TEST byte ptr [EBP + 0x10],0x10
0065dbe1 : JZ 0x0065dca9
0065dbe7 : XOR ESI,ESI
0065dbe9 : TEST AL,0x10
0065dbeb : JZ 0x0065dbef
0065dbed : MOV ESI,EBX
0065dbef : FLDZ
0065dbf1 : PUSH EDI
0065dbf2 : MOV EDI,dword ptr [EBP + 0xc]
0065dbf5 : FCOMP double ptr [EDI]
0065dbf7 : FNSTSW AX
0065dbf9 : TEST AH,0x44
0065dbfc : JNP 0x0065dc93
0065dc02 : FLD double ptr [EDI]
0065dc04 : LEA EAX,[EBP + -0x8]
0065dc07 : PUSH EAX
0065dc08 : PUSH ECX
0065dc09 : PUSH ECX
0065dc0a : FSTP double ptr [ESP]
0065dc0d : CALL 0x0065df8a
0065dc12 : MOV ECX,dword ptr [EBP + -0x8]
0065dc15 : FSTP double ptr [EBP + -0x14]
0065dc18 : ADD ECX,0xfffffa00
0065dc1e : ADD ESP,0xc
0065dc21 : CMP ECX,0xfffffbce
0065dc27 : JGE 0x0065dc36
0065dc29 : FLD double ptr [EBP + -0x14]
0065dc2c : MOV ESI,EBX
0065dc2e : FMUL double ptr [0x00cdf338]
0065dc34 : JMP 0x0065dc89
0065dc36 : FLDZ
0065dc38 : FCOMP double ptr [EBP + -0x14]
0065dc3b : FNSTSW AX
0065dc3d : TEST AH,0x41
0065dc40 : JNZ 0x0065dc46
0065dc42 : MOV EDX,EBX
0065dc44 : JMP 0x0065dc48
0065dc46 : XOR EDX,EDX
0065dc48 : MOV EAX,dword ptr [EBP + -0xe]
0065dc4b : AND EAX,0xf
0065dc4e : OR EAX,0x10
0065dc51 : MOV word ptr [EBP + -0xe],AX
0065dc55 : MOV EAX,0xfffffc03
0065dc5a : CMP ECX,EAX
0065dc5c : JGE 0x0065dc80
0065dc5e : SUB EAX,ECX
0065dc60 : TEST byte ptr [EBP + -0x14],BL
0065dc63 : JZ 0x0065dc6b
0065dc65 : TEST ESI,ESI
0065dc67 : JNZ 0x0065dc6b
0065dc69 : MOV ESI,EBX
0065dc6b : SHR dword ptr [EBP + -0x14],0x1
0065dc6e : TEST byte ptr [EBP + -0x10],BL
0065dc71 : JZ 0x0065dc7a
0065dc73 : OR dword ptr [EBP + -0x14],0x80000000
0065dc7a : SHR dword ptr [EBP + -0x10],0x1
0065dc7d : DEC EAX
0065dc7e : JNZ 0x0065dc60
0065dc80 : TEST EDX,EDX
0065dc82 : JZ 0x0065dc8c
0065dc84 : FLD double ptr [EBP + -0x14]
0065dc87 : FCHS
0065dc89 : FSTP double ptr [EBP + -0x14]
0065dc8c : FLD double ptr [EBP + -0x14]
0065dc8f : FSTP double ptr [EDI]
0065dc91 : JMP 0x0065dc95
0065dc93 : MOV ESI,EBX
0065dc95 : POP EDI
0065dc96 : TEST ESI,ESI
0065dc98 : JZ 0x0065dca2
0065dc9a : PUSH 0x10
0065dc9c : CALL 0x0065e08d
0065dca1 : POP ECX
0065dca2 : AND dword ptr [EBP + -0x4],0xfffffffd
0065dca6 : MOV ESI,dword ptr [EBP + -0x4]
0065dca9 : TEST byte ptr [EBP + 0x8],0x10
0065dcad : JZ 0x0065dcc0
0065dcaf : TEST byte ptr [EBP + 0x10],0x20
0065dcb3 : JZ 0x0065dcc0
0065dcb5 : PUSH 0x20
0065dcb7 : CALL 0x0065e08d
0065dcbc : POP ECX
0065dcbd : AND ESI,0xffffffef
0065dcc0 : XOR EAX,EAX
0065dcc2 : TEST ESI,ESI
0065dcc4 : POP ESI
0065dcc5 : SETZ AL
0065dcc8 : POP EBX
0065dcc9 : LEAVE
0065dcca : RET

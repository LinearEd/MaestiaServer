PROGRAM  : Maestia.exe
FUNCTION : FUN_00a6be30
ENTRY    : 00a6be30
BODY     : [[00a6be30, 00a6bfda]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a6be30(int param_1)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int unaff_ESI;
  undefined1 local_44 [4];
  undefined2 local_40;
  undefined4 local_30;
  uint local_2c;
  LPCRITICAL_SECTION local_28;
  char *local_24;
  undefined4 local_20;
  int local_1c;
  undefined4 local_18;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b14b4e;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_28 = (LPCRITICAL_SECTION)(param_1 + 0x70);
  local_1c = 0;
  local_24 = ".\\Objects\\AvaEffectMgr.cpp";
  local_20 = 0x3b2;
  local_18 = 1;
  FUN_006ef1a0(&local_28);
  local_8 = 0;
  iVar3 = *(int *)(param_1 + 0x3c) - *(int *)(param_1 + 0x38);
  iVar2 = iVar3 >> 0x1f;
  if (iVar3 / 0xc + iVar2 == iVar2) {
    local_8 = 0xffffffff;
    if (local_1c != 0) {
      LeaveCriticalSection(local_28);
      ExceptionList = local_10;
      return;
    }
  }
  else {
    piVar4 = *(int **)(param_1 + 0x38);
    local_14 = piVar4;
    if (piVar4 != *(int **)(param_1 + 0x3c)) {
      do {
        local_14 = piVar4;
        if ((char)piVar4[2] == '\0') {
LAB_00a6bfa9:
          if (*piVar4 != 0) {
            if (*(uint *)(unaff_ESI + 0x18) < 8) {
              iVar2 = unaff_ESI + 4;
            }
            else {
              iVar2 = *(int *)(unaff_ESI + 4);
            }
            iVar2 = FUN_00405bb0(iVar2);
            if (iVar2 == 0) {
              (**(code **)(*(int *)*piVar4 + 0x24))(uVar1);
            }
          }
        }
        else if (piVar4[1] == 0) {
          if ((char)piVar4[2] == '\0') goto LAB_00a6bfa9;
        }
        else {
          FUN_0043d360(piVar4[1],local_44);
          local_8._0_1_ = 1;
          if (*(uint *)(unaff_ESI + 0x18) < 8) {
            iVar2 = unaff_ESI + 4;
          }
          else {
            iVar2 = *(int *)(unaff_ESI + 4);
          }
          iVar2 = FUN_00405bb0(iVar2);
          local_8 = (uint)local_8._1_3_ << 8;
          if (7 < local_2c) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          local_2c = 7;
          local_30 = 0;
          local_40 = 0;
          piVar4 = local_14;
          if (iVar2 == 0) {
            (**(code **)(*(int *)local_14[1] + 0xd4))();
            piVar4 = local_14;
          }
        }
        piVar4 = piVar4 + 3;
        local_14 = piVar4;
      } while (piVar4 != *(int **)(param_1 + 0x3c));
    }
    local_8 = 0xffffffff;
    if (local_1c != 0) {
      LeaveCriticalSection(local_28);
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00a6be30 : PUSH EBP
00a6be31 : MOV EBP,ESP
00a6be33 : PUSH -0x1
00a6be35 : PUSH 0xb14b4e
00a6be3a : MOV EAX,FS:[0x0]
00a6be40 : PUSH EAX
00a6be41 : SUB ESP,0x34
00a6be44 : PUSH EBX
00a6be45 : PUSH EDI
00a6be46 : MOV EAX,[0x00d66fa0]
00a6be4b : XOR EAX,EBP
00a6be4d : PUSH EAX
00a6be4e : LEA EAX,[EBP + -0xc]
00a6be51 : MOV FS:[0x0],EAX
00a6be57 : MOV EDI,dword ptr [EBP + 0x8]
00a6be5a : LEA ECX,[EBP + -0x24]
00a6be5d : LEA EAX,[EDI + 0x70]
00a6be60 : XOR EBX,EBX
00a6be62 : PUSH ECX
00a6be63 : MOV dword ptr [EBP + -0x18],EBX
00a6be66 : MOV dword ptr [EBP + -0x24],EAX
00a6be69 : MOV dword ptr [EBP + -0x20],0xc43ef0
00a6be70 : MOV dword ptr [EBP + -0x1c],0x3b2
00a6be77 : MOV dword ptr [EBP + -0x14],0x1
00a6be7e : CALL 0x006ef1a0
00a6be83 : MOV dword ptr [EBP + -0x4],EBX
00a6be86 : MOV ECX,dword ptr [EDI + 0x3c]
00a6be89 : SUB ECX,dword ptr [EDI + 0x38]
00a6be8c : MOV EAX,0x2aaaaaab
00a6be91 : IMUL ECX
00a6be93 : SAR EDX,0x1
00a6be95 : MOV EAX,EDX
00a6be97 : SHR EAX,0x1f
00a6be9a : ADD EAX,EDX
00a6be9c : JNZ 0x00a6bece
00a6be9e : MOV dword ptr [EBP + -0x4],0xffffffff
00a6bea5 : CMP dword ptr [EBP + -0x18],EBX
00a6bea8 : JZ 0x00a6bf92
00a6beae : MOV ECX,dword ptr [EBP + -0x24]
00a6beb1 : PUSH ECX
00a6beb2 : CALL dword ptr [0x00b8511c]
00a6beb8 : MOV dword ptr [EBP + -0x18],EBX
00a6bebb : MOV ECX,dword ptr [EBP + -0xc]
00a6bebe : MOV dword ptr FS:[0x0],ECX
00a6bec5 : POP ECX
00a6bec6 : POP EDI
00a6bec7 : POP EBX
00a6bec8 : MOV ESP,EBP
00a6beca : POP EBP
00a6becb : RET 0x4
00a6bece : MOV EBX,dword ptr [EDI + 0x38]
00a6bed1 : MOV dword ptr [EBP + -0x10],EBX
00a6bed4 : CMP EBX,dword ptr [EDI + 0x3c]
00a6bed7 : JZ 0x00a6bf74
00a6bedd : LEA ECX,[ECX]
00a6bee0 : MOV CL,byte ptr [EBX + 0x8]
00a6bee3 : TEST CL,CL
00a6bee5 : JZ 0x00a6bfa9
00a6beeb : MOV EAX,dword ptr [EBX + 0x4]
00a6beee : TEST EAX,EAX
00a6bef0 : JZ 0x00a6bfa5
00a6bef6 : LEA EDX,[EBP + -0x40]
00a6bef9 : PUSH EDX
00a6befa : PUSH EAX
00a6befb : CALL 0x0043d360
00a6bf00 : MOV ECX,EAX
00a6bf02 : MOV byte ptr [EBP + -0x4],0x1
00a6bf06 : CMP dword ptr [ESI + 0x18],0x8
00a6bf0a : MOV EDI,dword ptr [ESI + 0x14]
00a6bf0d : JC 0x00a6bf14
00a6bf0f : MOV EAX,dword ptr [ESI + 0x4]
00a6bf12 : JMP 0x00a6bf17
00a6bf14 : LEA EAX,[ESI + 0x4]
00a6bf17 : PUSH EAX
00a6bf18 : MOV EAX,dword ptr [ECX + 0x14]
00a6bf1b : CALL 0x00405bb0
00a6bf20 : TEST EAX,EAX
00a6bf22 : SETZ BL
00a6bf25 : MOV byte ptr [EBP + -0x4],0x0
00a6bf29 : CMP dword ptr [EBP + -0x28],0x8
00a6bf2d : JC 0x00a6bf37
00a6bf2f : MOV ECX,dword ptr [EBP + -0x3c]
00a6bf32 : CALL 0x006f04e0
00a6bf37 : XOR EAX,EAX
00a6bf39 : MOV dword ptr [EBP + -0x28],0x7
00a6bf40 : MOV dword ptr [EBP + -0x2c],0x0
00a6bf47 : MOV word ptr [EBP + -0x3c],AX
00a6bf4b : TEST BL,BL
00a6bf4d : JZ 0x00a6bf5f
00a6bf4f : MOV ECX,dword ptr [EBP + -0x10]
00a6bf52 : MOV ECX,dword ptr [ECX + 0x4]
00a6bf55 : MOV EDX,dword ptr [ECX]
00a6bf57 : MOV EAX,dword ptr [EDX + 0xd4]
00a6bf5d : CALL EAX
00a6bf5f : MOV EBX,dword ptr [EBP + -0x10]
00a6bf62 : MOV ECX,dword ptr [EBP + 0x8]
00a6bf65 : ADD EBX,0xc
00a6bf68 : MOV dword ptr [EBP + -0x10],EBX
00a6bf6b : CMP EBX,dword ptr [ECX + 0x3c]
00a6bf6e : JNZ 0x00a6bee0
00a6bf74 : MOV dword ptr [EBP + -0x4],0xffffffff
00a6bf7b : CMP dword ptr [EBP + -0x18],0x0
00a6bf7f : JZ 0x00a6bf92
00a6bf81 : MOV EDX,dword ptr [EBP + -0x24]
00a6bf84 : PUSH EDX
00a6bf85 : CALL dword ptr [0x00b8511c]
00a6bf8b : MOV dword ptr [EBP + -0x18],0x0
00a6bf92 : MOV ECX,dword ptr [EBP + -0xc]
00a6bf95 : MOV dword ptr FS:[0x0],ECX
00a6bf9c : POP ECX
00a6bf9d : POP EDI
00a6bf9e : POP EBX
00a6bf9f : MOV ESP,EBP
00a6bfa1 : POP EBP
00a6bfa2 : RET 0x4
00a6bfa5 : TEST CL,CL
00a6bfa7 : JNZ 0x00a6bf62
00a6bfa9 : MOV EAX,dword ptr [EBX]
00a6bfab : TEST EAX,EAX
00a6bfad : JZ 0x00a6bf62
00a6bfaf : CMP dword ptr [ESI + 0x18],0x8
00a6bfb3 : MOV EDI,dword ptr [ESI + 0x14]
00a6bfb6 : LEA ECX,[EAX + 0x58]
00a6bfb9 : JC 0x00a6bfc0
00a6bfbb : MOV EAX,dword ptr [ESI + 0x4]
00a6bfbe : JMP 0x00a6bfc3
00a6bfc0 : LEA EAX,[ESI + 0x4]
00a6bfc3 : PUSH EAX
00a6bfc4 : MOV EAX,dword ptr [ECX + 0x14]
00a6bfc7 : CALL 0x00405bb0
00a6bfcc : TEST EAX,EAX
00a6bfce : JNZ 0x00a6bf62
00a6bfd0 : MOV ECX,dword ptr [EBX]
00a6bfd2 : MOV EDX,dword ptr [ECX]
00a6bfd4 : MOV EAX,dword ptr [EDX + 0x24]
00a6bfd7 : CALL EAX
00a6bfd9 : JMP 0x00a6bf62

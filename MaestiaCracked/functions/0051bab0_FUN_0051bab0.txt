PROGRAM  : Maestia.exe
FUNCTION : FUN_0051bab0
ENTRY    : 0051bab0
BODY     : [[0051bab0, 0051bb19]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0051bab0(undefined4 param_1,undefined4 param_2)

{
  uint uVar1;
  LONG LVar2;
  uint *in_ECX;
  uint uVar3;
  uint uVar4;
  
  uVar3 = *in_ECX & 3;
  uVar4 = *in_ECX & 0xfffffffc;
  uVar1 = DAT_00d73250;
  if (uVar3 != 0) {
    if (uVar3 == 1) {
      uVar1 = FUN_00515dd0(in_ECX);
    }
    else {
      uVar1 = 0;
      if (uVar3 == 2) {
        uVar1 = in_ECX[1];
      }
    }
  }
  uVar1 = FUN_0051b700(uVar1,param_2,0,param_1,param_2);
  *in_ECX = *in_ECX & 3 | uVar1;
  LVar2 = InterlockedExchangeAdd((LONG *)(uVar4 + 4),-1);
  if (LVar2 == 1) {
    FUN_00515cf0(uVar4);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
0051bab0 : PUSH ESI
0051bab1 : MOV ESI,ECX
0051bab3 : MOV ECX,dword ptr [ESI]
0051bab5 : PUSH EDI
0051bab6 : MOV EDI,ECX
0051bab8 : XOR EAX,EAX
0051baba : AND ECX,0x3
0051babd : AND EDI,0xfffffffc
0051bac0 : SUB ECX,EAX
0051bac2 : JZ 0x0051badb
0051bac4 : SUB ECX,0x1
0051bac7 : JZ 0x0051bad3
0051bac9 : SUB ECX,0x1
0051bacc : JNZ 0x0051bae0
0051bace : MOV EAX,dword ptr [ESI + 0x4]
0051bad1 : JMP 0x0051bae0
0051bad3 : PUSH ESI
0051bad4 : CALL 0x00515dd0
0051bad9 : JMP 0x0051bae0
0051badb : MOV EAX,[0x00d73250]
0051bae0 : MOV ECX,dword ptr [ESP + 0x10]
0051bae4 : MOV EDX,dword ptr [ESP + 0xc]
0051bae8 : PUSH ECX
0051bae9 : PUSH EDX
0051baea : PUSH 0x0
0051baec : PUSH ECX
0051baed : PUSH EAX
0051baee : MOV ECX,ESI
0051baf0 : CALL 0x0051b700
0051baf5 : MOV ECX,dword ptr [ESI]
0051baf7 : AND ECX,0x3
0051bafa : OR ECX,EAX
0051bafc : PUSH -0x1
0051bafe : LEA EAX,[EDI + 0x4]
0051bb01 : PUSH EAX
0051bb02 : MOV dword ptr [ESI],ECX
0051bb04 : CALL dword ptr [0x00b851cc]
0051bb0a : SUB EAX,0x1
0051bb0d : JNZ 0x0051bb15
0051bb0f : PUSH EDI
0051bb10 : CALL 0x00515cf0
0051bb15 : POP EDI
0051bb16 : POP ESI
0051bb17 : RET 0x8

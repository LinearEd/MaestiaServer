PROGRAM  : Maestia.exe
FUNCTION : FUN_009c9e90
ENTRY    : 009c9e90
BODY     : [[009c9e90, 009ca197]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009c9e90(int param_1,int param_2)

{
  short sVar1;
  uint uVar2;
  short *psVar3;
  int iVar4;
  undefined4 ****ppppuVar5;
  uint local_a8;
  uint local_8c;
  undefined1 local_88 [4];
  undefined2 local_84;
  undefined4 local_74;
  uint local_70;
  undefined1 local_6c [4];
  undefined2 local_68;
  undefined4 local_58;
  uint local_54;
  int local_50;
  undefined1 local_4c [4];
  undefined2 local_48;
  undefined4 local_38;
  uint local_34;
  undefined4 ***local_2c [4];
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b22663;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_50 = param_2;
  local_2c[0] = (undefined4 ***)((uint)local_2c[0] & 0xffff0000);
  local_18 = 7;
  local_1c = 0;
  psVar3 = (short *)(param_2 + 8);
  do {
    sVar1 = *psVar3;
    psVar3 = psVar3 + 1;
  } while (sVar1 != 0);
  local_14 = uVar2;
  FUN_00406360((short *)(param_2 + 8),(int)psVar3 - (param_2 + 10) >> 1);
  local_8 = 0;
  if (*(int *)(param_1 + 0x38) == 1) {
    FUN_00406460(L"IDS_BATTLESTAGE_OUT_OF_STAGE");
    local_8._0_1_ = 1;
    iVar4 = FUN_0081d120(local_6c);
    local_8._0_1_ = 2;
    ppppuVar5 = (undefined4 ****)local_2c[0];
    if (local_18 < 8) {
      ppppuVar5 = local_2c;
    }
    if (*(uint *)(iVar4 + 0x18) < 8) {
      iVar4 = iVar4 + 4;
    }
    else {
      iVar4 = *(int *)(iVar4 + 4);
    }
    FUN_00404750(iVar4,ppppuVar5,uVar2);
    local_8 = CONCAT31(local_8._1_3_,4);
    if (7 < local_a8) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_8 = CONCAT31(local_8._1_3_,5);
    if (7 < local_54) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_68 = 0;
    local_54 = 7;
    local_58 = 0;
    (**(code **)(**(int **)(*(int *)(param_1 + 4) + 0x1a8) + 0x44))(local_4c,3);
    iVar4 = local_50;
    FUN_009c9030(param_1,*(undefined4 *)(local_50 + 4));
    if (*(int *)(*(int *)(DAT_0172491c + 0x17c) + 4) == *(int *)(iVar4 + 4)) {
      FUN_009c8f60(param_1);
    }
    local_8 = local_8 & 0xffffff00;
    if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  else {
    if (*(int *)(param_1 + 0x38) != 2) goto LAB_009ca151;
    FUN_00406460(L"IDS_BATTLESTAGE_OUT_OF_STAGE_PARTY");
    local_8._0_1_ = 6;
    iVar4 = FUN_0081d120(local_88);
    local_8._0_1_ = 7;
    ppppuVar5 = (undefined4 ****)local_2c[0];
    if (local_18 < 8) {
      ppppuVar5 = local_2c;
    }
    if (*(uint *)(iVar4 + 0x18) < 8) {
      iVar4 = iVar4 + 4;
    }
    else {
      iVar4 = *(int *)(iVar4 + 4);
    }
    FUN_00404750(iVar4,ppppuVar5,uVar2);
    local_8 = CONCAT31(local_8._1_3_,9);
    if (7 < local_8c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_8 = CONCAT31(local_8._1_3_,10);
    if (7 < local_70) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_84 = 0;
    local_70 = 7;
    local_74 = 0;
    (**(code **)(**(int **)(*(int *)(param_1 + 4) + 0x1a8) + 0x44))(local_4c,3);
    iVar4 = local_50;
    FUN_009c9030(param_1,*(undefined4 *)(local_50 + 4));
    if (*(int *)(*(int *)(DAT_0172491c + 0x17c) + 4) == *(int *)(iVar4 + 4)) {
      FUN_009c8f60(param_1);
      *(undefined1 *)(param_1 + 0x8c) = 0;
      if ((*(char *)(param_1 + 0x8d) != '\0') && (*(int *)(*DAT_00da9894 + 0x1a8) != 0)) {
        FUN_009adfc0(*(undefined4 *)(*DAT_00da9894 + 0x1a8),0x17);
      }
    }
    local_8 = local_8 & 0xffffff00;
    if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  local_48 = 0;
  local_38 = 0;
  local_34 = 7;
LAB_009ca151:
  local_8 = 0xffffffff;
  if (local_18 < 8) {
    local_18 = 7;
    local_1c = 0;
    local_2c[0] = (undefined4 ***)((uint)local_2c[0] & 0xffff0000);
    ExceptionList = local_10;
    __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
    return;
  }
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
009c9e90 : PUSH EBP
009c9e91 : MOV EBP,ESP
009c9e93 : PUSH -0x1
009c9e95 : PUSH 0xb22663
009c9e9a : MOV EAX,FS:[0x0]
009c9ea0 : PUSH EAX
009c9ea1 : SUB ESP,0xb0
009c9ea7 : MOV EAX,[0x00d66fa0]
009c9eac : XOR EAX,EBP
009c9eae : MOV dword ptr [EBP + -0x10],EAX
009c9eb1 : PUSH EBX
009c9eb2 : PUSH ESI
009c9eb3 : PUSH EDI
009c9eb4 : PUSH EAX
009c9eb5 : LEA EAX,[EBP + -0xc]
009c9eb8 : MOV FS:[0x0],EAX
009c9ebe : MOV EAX,dword ptr [EBP + 0xc]
009c9ec1 : MOV EBX,dword ptr [EBP + 0x8]
009c9ec4 : MOV dword ptr [EBP + -0x4c],EAX
009c9ec7 : LEA ECX,[EAX + 0x8]
009c9eca : XOR EDI,EDI
009c9ecc : XOR EAX,EAX
009c9ece : MOV word ptr [EBP + -0x28],AX
009c9ed2 : MOV EAX,ECX
009c9ed4 : MOV dword ptr [EBP + -0x14],0x7
009c9edb : MOV dword ptr [EBP + -0x18],EDI
009c9ede : LEA ESI,[EAX + 0x2]
009c9ee1 : MOV DX,word ptr [EAX]
009c9ee4 : ADD EAX,0x2
009c9ee7 : CMP DX,DI
009c9eea : JNZ 0x009c9ee1
009c9eec : SUB EAX,ESI
009c9eee : SAR EAX,0x1
009c9ef0 : PUSH EAX
009c9ef1 : PUSH ECX
009c9ef2 : LEA ECX,[EBP + -0x2c]
009c9ef5 : CALL 0x00406360
009c9efa : MOV dword ptr [EBP + -0x4],EDI
009c9efd : MOV EAX,dword ptr [EBX + 0x38]
009c9f00 : SUB EAX,0x1
009c9f03 : JZ 0x009ca04d
009c9f09 : SUB EAX,0x1
009c9f0c : JNZ 0x009ca151
009c9f12 : PUSH 0xc92e90
009c9f17 : LEA ECX,[EBP + 0xffffff7c]
009c9f1d : CALL 0x00406460
009c9f22 : MOV byte ptr [EBP + -0x4],0x6
009c9f26 : LEA ECX,[EBP + 0xffffff7c]
009c9f2c : PUSH ECX
009c9f2d : MOV ECX,dword ptr [0x0172491c]
009c9f33 : LEA EDI,[EBP + 0xffffff60]
009c9f39 : CALL 0x0081d120
009c9f3e : MOV byte ptr [EBP + -0x4],0x7
009c9f42 : MOV ECX,dword ptr [EBP + -0x28]
009c9f45 : MOV EDI,0x8
009c9f4a : CMP dword ptr [EBP + -0x14],EDI
009c9f4d : JNC 0x009c9f52
009c9f4f : LEA ECX,[EBP + -0x28]
009c9f52 : CMP dword ptr [EAX + 0x18],EDI
009c9f55 : JC 0x009c9f5c
009c9f57 : MOV EAX,dword ptr [EAX + 0x4]
009c9f5a : JMP 0x009c9f5f
009c9f5c : ADD EAX,0x4
009c9f5f : PUSH ECX
009c9f60 : PUSH EAX
009c9f61 : LEA ESI,[EBP + -0x48]
009c9f64 : CALL 0x00404750
009c9f69 : ADD ESP,0x8
009c9f6c : MOV byte ptr [EBP + -0x4],0x9
009c9f70 : CMP dword ptr [EBP + 0xffffff78],EDI
009c9f76 : JC 0x009c9f83
009c9f78 : MOV ECX,dword ptr [EBP + 0xffffff64]
009c9f7e : CALL 0x006f04e0
009c9f83 : MOV ESI,0x7
009c9f88 : XOR EDI,EDI
009c9f8a : XOR EDX,EDX
009c9f8c : MOV dword ptr [EBP + 0xffffff78],ESI
009c9f92 : MOV dword ptr [EBP + 0xffffff74],EDI
009c9f98 : MOV word ptr [EBP + 0xffffff64],DX
009c9f9f : MOV byte ptr [EBP + -0x4],0xa
009c9fa3 : CMP dword ptr [EBP + -0x6c],0x8
009c9fa7 : JC 0x009c9fb1
009c9fa9 : MOV ECX,dword ptr [EBP + -0x80]
009c9fac : CALL 0x006f04e0
009c9fb1 : MOV ECX,dword ptr [EBX + 0x4]
009c9fb4 : XOR EAX,EAX
009c9fb6 : MOV word ptr [EBP + -0x80],AX
009c9fba : MOV dword ptr [EBP + -0x6c],ESI
009c9fbd : MOV dword ptr [EBP + -0x70],EDI
009c9fc0 : MOV ECX,dword ptr [ECX + 0x1a8]
009c9fc6 : MOV EDX,dword ptr [ECX]
009c9fc8 : MOV EDX,dword ptr [EDX + 0x44]
009c9fcb : PUSH 0x3
009c9fcd : LEA EAX,[EBP + -0x48]
009c9fd0 : PUSH EAX
009c9fd1 : CALL EDX
009c9fd3 : MOV ESI,dword ptr [EBP + -0x4c]
009c9fd6 : MOV EAX,dword ptr [ESI + 0x4]
009c9fd9 : PUSH EAX
009c9fda : PUSH EBX
009c9fdb : CALL 0x009c9030
009c9fe0 : MOV ECX,dword ptr [0x0172491c]
009c9fe6 : MOV EAX,dword ptr [ECX + 0x17c]
009c9fec : MOV EAX,dword ptr [EAX + 0x4]
009c9fef : CMP EAX,dword ptr [ESI + 0x4]
009c9ff2 : JNZ 0x009ca030
009c9ff4 : PUSH EBX
009c9ff5 : CALL 0x009c8f60
009c9ffa : CMP byte ptr [EBX + 0x8d],0x0
009ca001 : MOV byte ptr [EBX + 0x8c],0x0
009ca008 : JZ 0x009ca030
009ca00a : MOV EDX,dword ptr [0x00da9894]
009ca010 : MOV EAX,dword ptr [EDX]
009ca012 : CMP dword ptr [EAX + 0x1a8],EDI
009ca018 : JZ 0x009ca030
009ca01a : MOV EAX,dword ptr [EAX + 0x1a8]
009ca020 : PUSH 0x17
009ca022 : PUSH EAX
009ca023 : MOV ECX,0xc92ed8
009ca028 : CALL 0x009adfc0
009ca02d : ADD ESP,0x8
009ca030 : MOV byte ptr [EBP + -0x4],0x0
009ca034 : CMP dword ptr [EBP + -0x30],0x8
009ca038 : JC 0x009ca042
009ca03a : MOV ECX,dword ptr [EBP + -0x44]
009ca03d : CALL 0x006f04e0
009ca042 : XOR EAX,EAX
009ca044 : MOV word ptr [EBP + -0x44],AX
009ca048 : JMP 0x009ca147
009ca04d : PUSH 0xc92e50
009ca052 : LEA ECX,[EBP + -0x68]
009ca055 : CALL 0x00406460
009ca05a : MOV byte ptr [EBP + -0x4],0x1
009ca05e : LEA ECX,[EBP + -0x68]
009ca061 : PUSH ECX
009ca062 : MOV ECX,dword ptr [0x0172491c]
009ca068 : LEA EDI,[EBP + 0xffffff44]
009ca06e : CALL 0x0081d120
009ca073 : MOV byte ptr [EBP + -0x4],0x2
009ca077 : MOV ECX,dword ptr [EBP + -0x28]
009ca07a : MOV EDI,0x8
009ca07f : CMP dword ptr [EBP + -0x14],EDI
009ca082 : JNC 0x009ca087
009ca084 : LEA ECX,[EBP + -0x28]
009ca087 : CMP dword ptr [EAX + 0x18],EDI
009ca08a : JC 0x009ca091
009ca08c : MOV EAX,dword ptr [EAX + 0x4]
009ca08f : JMP 0x009ca094
009ca091 : ADD EAX,0x4
009ca094 : PUSH ECX
009ca095 : PUSH EAX
009ca096 : LEA ESI,[EBP + -0x48]
009ca099 : CALL 0x00404750
009ca09e : ADD ESP,0x8
009ca0a1 : MOV byte ptr [EBP + -0x4],0x4
009ca0a5 : CMP dword ptr [EBP + 0xffffff5c],EDI
009ca0ab : JC 0x009ca0b8
009ca0ad : MOV ECX,dword ptr [EBP + 0xffffff48]
009ca0b3 : CALL 0x006f04e0
009ca0b8 : MOV ESI,0x7
009ca0bd : XOR EDI,EDI
009ca0bf : XOR EDX,EDX
009ca0c1 : MOV dword ptr [EBP + 0xffffff5c],ESI
009ca0c7 : MOV dword ptr [EBP + 0xffffff58],EDI
009ca0cd : MOV word ptr [EBP + 0xffffff48],DX
009ca0d4 : MOV byte ptr [EBP + -0x4],0x5
009ca0d8 : CMP dword ptr [EBP + -0x50],0x8
009ca0dc : JC 0x009ca0e6
009ca0de : MOV ECX,dword ptr [EBP + -0x64]
009ca0e1 : CALL 0x006f04e0
009ca0e6 : MOV ECX,dword ptr [EBX + 0x4]
009ca0e9 : XOR EAX,EAX
009ca0eb : MOV word ptr [EBP + -0x64],AX
009ca0ef : MOV dword ptr [EBP + -0x50],ESI
009ca0f2 : MOV dword ptr [EBP + -0x54],EDI
009ca0f5 : MOV ECX,dword ptr [ECX + 0x1a8]
009ca0fb : MOV EDX,dword ptr [ECX]
009ca0fd : MOV EDX,dword ptr [EDX + 0x44]
009ca100 : PUSH 0x3
009ca102 : LEA EAX,[EBP + -0x48]
009ca105 : PUSH EAX
009ca106 : CALL EDX
009ca108 : MOV ESI,dword ptr [EBP + -0x4c]
009ca10b : MOV EAX,dword ptr [ESI + 0x4]
009ca10e : PUSH EAX
009ca10f : PUSH EBX
009ca110 : CALL 0x009c9030
009ca115 : MOV ECX,dword ptr [0x0172491c]
009ca11b : MOV EAX,dword ptr [ECX + 0x17c]
009ca121 : MOV EAX,dword ptr [EAX + 0x4]
009ca124 : CMP EAX,dword ptr [ESI + 0x4]
009ca127 : JNZ 0x009ca12f
009ca129 : PUSH EBX
009ca12a : CALL 0x009c8f60
009ca12f : MOV byte ptr [EBP + -0x4],0x0
009ca133 : CMP dword ptr [EBP + -0x30],0x8
009ca137 : JC 0x009ca141
009ca139 : MOV ECX,dword ptr [EBP + -0x44]
009ca13c : CALL 0x006f04e0
009ca141 : XOR EDX,EDX
009ca143 : MOV word ptr [EBP + -0x44],DX
009ca147 : MOV dword ptr [EBP + -0x34],EDI
009ca14a : MOV dword ptr [EBP + -0x30],0x7
009ca151 : MOV dword ptr [EBP + -0x4],0xffffffff
009ca158 : CMP dword ptr [EBP + -0x14],0x8
009ca15c : JC 0x009ca166
009ca15e : MOV ECX,dword ptr [EBP + -0x28]
009ca161 : CALL 0x006f04e0
009ca166 : XOR EAX,EAX
009ca168 : MOV dword ptr [EBP + -0x14],0x7
009ca16f : MOV dword ptr [EBP + -0x18],0x0
009ca176 : MOV word ptr [EBP + -0x28],AX
009ca17a : MOV ECX,dword ptr [EBP + -0xc]
009ca17d : MOV dword ptr FS:[0x0],ECX
009ca184 : POP ECX
009ca185 : POP EDI
009ca186 : POP ESI
009ca187 : POP EBX
009ca188 : MOV ECX,dword ptr [EBP + -0x10]
009ca18b : XOR ECX,EBP
009ca18d : CALL 0x00633e6b
009ca192 : MOV ESP,EBP
009ca194 : POP EBP
009ca195 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_0051c0f0
ENTRY    : 0051c0f0
BODY     : [[0051c0f0, 0051c24b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0051c0f0(char *param_1)

{
  int iVar1;
  undefined4 uVar2;
  int local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined1 local_8;
  undefined4 local_4;
  
  local_18 = 0;
  local_14 = 0;
  local_10 = 0;
  local_c = 0x200;
  local_8 = 0;
  local_4 = DAT_00d73250;
  iVar1 = FUN_0051aa70(&param_1);
  do {
    if (iVar1 == 0) {
LAB_0051c229:
      FUN_0051bcf0(&local_18);
      if (local_18 != 0) {
        FUN_00515cf0(local_18);
      }
      return;
    }
    if (iVar1 == 0x26) {
      iVar1 = _strncmp(param_1,"quot;",5);
      if (iVar1 == 0) {
        FUN_0051b4e0(0x22);
        param_1 = param_1 + 5;
      }
      else {
        iVar1 = _strncmp(param_1,"apos;",5);
        if (iVar1 == 0) {
          FUN_0051b4e0(0x27);
          param_1 = param_1 + 5;
        }
        else {
          iVar1 = _strncmp(param_1,"amp;",4);
          if (iVar1 == 0) {
            FUN_0051b4e0(0x26);
            param_1 = param_1 + 4;
          }
          else {
            iVar1 = _strncmp(param_1,"lt;",3);
            if (iVar1 == 0) {
              uVar2 = 0x3c;
            }
            else {
              iVar1 = _strncmp(param_1,"gt;",3);
              if (iVar1 != 0) {
                iVar1 = 0x26;
                goto LAB_0051c1c6;
              }
              uVar2 = 0x3e;
            }
            FUN_0051b4e0(uVar2);
            param_1 = param_1 + 3;
          }
        }
      }
      goto LAB_0051c229;
    }
LAB_0051c1c6:
    FUN_0051b4e0(iVar1);
    iVar1 = FUN_0051aa70(&param_1);
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
0051c0f0 : SUB ESP,0x18
0051c0f3 : MOV EAX,[0x00d73250]
0051c0f8 : PUSH EBX
0051c0f9 : XOR EBX,EBX
0051c0fb : LEA ECX,[ESP + 0x20]
0051c0ff : PUSH ECX
0051c100 : MOV dword ptr [ESP + 0x8],EBX
0051c104 : MOV dword ptr [ESP + 0xc],EBX
0051c108 : MOV dword ptr [ESP + 0x10],EBX
0051c10c : MOV dword ptr [ESP + 0x14],0x200
0051c114 : MOV byte ptr [ESP + 0x18],BL
0051c118 : MOV dword ptr [ESP + 0x1c],EAX
0051c11c : CALL 0x0051aa70
0051c121 : CMP EAX,EBX
0051c123 : JZ 0x0051c229
0051c129 : LEA ESP,[ESP]
0051c130 : CMP EAX,0x26
0051c133 : JNZ 0x0051c1c1
0051c139 : MOV EDX,dword ptr [ESP + 0x20]
0051c13d : PUSH 0x5
0051c13f : PUSH 0xb872fc
0051c144 : PUSH EDX
0051c145 : CALL 0x0063abcb
0051c14a : ADD ESP,0xc
0051c14d : TEST EAX,EAX
0051c14f : JZ 0x0051c1df
0051c155 : MOV EAX,dword ptr [ESP + 0x20]
0051c159 : PUSH 0x5
0051c15b : PUSH 0xb872f4
0051c160 : PUSH EAX
0051c161 : CALL 0x0063abcb
0051c166 : ADD ESP,0xc
0051c169 : TEST EAX,EAX
0051c16b : JZ 0x0051c1f1
0051c171 : MOV ECX,dword ptr [ESP + 0x20]
0051c175 : PUSH 0x4
0051c177 : PUSH 0xb872ec
0051c17c : PUSH ECX
0051c17d : CALL 0x0063abcb
0051c182 : ADD ESP,0xc
0051c185 : TEST EAX,EAX
0051c187 : JZ 0x0051c203
0051c189 : MOV EDX,dword ptr [ESP + 0x20]
0051c18d : PUSH 0x3
0051c18f : PUSH 0xb872e8
0051c194 : PUSH EDX
0051c195 : CALL 0x0063abcb
0051c19a : ADD ESP,0xc
0051c19d : TEST EAX,EAX
0051c19f : JZ 0x0051c215
0051c1a1 : MOV EAX,dword ptr [ESP + 0x20]
0051c1a5 : PUSH 0x3
0051c1a7 : PUSH 0xb872e4
0051c1ac : PUSH EAX
0051c1ad : CALL 0x0063abcb
0051c1b2 : ADD ESP,0xc
0051c1b5 : LEA ECX,[ESP + 0x4]
0051c1b9 : TEST EAX,EAX
0051c1bb : JZ 0x0051c21d
0051c1bd : PUSH 0x26
0051c1bf : JMP 0x0051c1c6
0051c1c1 : PUSH EAX
0051c1c2 : LEA ECX,[ESP + 0x8]
0051c1c6 : CALL 0x0051b4e0
0051c1cb : LEA ECX,[ESP + 0x20]
0051c1cf : PUSH ECX
0051c1d0 : CALL 0x0051aa70
0051c1d5 : CMP EAX,EBX
0051c1d7 : JNZ 0x0051c130
0051c1dd : JMP 0x0051c229
0051c1df : PUSH 0x22
0051c1e1 : LEA ECX,[ESP + 0x8]
0051c1e5 : CALL 0x0051b4e0
0051c1ea : ADD dword ptr [ESP + 0x20],0x5
0051c1ef : JMP 0x0051c229
0051c1f1 : PUSH 0x27
0051c1f3 : LEA ECX,[ESP + 0x8]
0051c1f7 : CALL 0x0051b4e0
0051c1fc : ADD dword ptr [ESP + 0x20],0x5
0051c201 : JMP 0x0051c229
0051c203 : PUSH 0x26
0051c205 : LEA ECX,[ESP + 0x8]
0051c209 : CALL 0x0051b4e0
0051c20e : ADD dword ptr [ESP + 0x20],0x4
0051c213 : JMP 0x0051c229
0051c215 : PUSH 0x3c
0051c217 : LEA ECX,[ESP + 0x8]
0051c21b : JMP 0x0051c21f
0051c21d : PUSH 0x3e
0051c21f : CALL 0x0051b4e0
0051c224 : ADD dword ptr [ESP + 0x20],0x3
0051c229 : MOV ECX,dword ptr [ESP + 0x28]
0051c22d : LEA EDX,[ESP + 0x4]
0051c231 : PUSH EDX
0051c232 : CALL 0x0051bcf0
0051c237 : MOV EAX,dword ptr [ESP + 0x4]
0051c23b : CMP EAX,EBX
0051c23d : POP EBX
0051c23e : JZ 0x0051c246
0051c240 : PUSH EAX
0051c241 : CALL 0x00515cf0
0051c246 : ADD ESP,0x18
0051c249 : RET 0xc

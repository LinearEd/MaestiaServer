PROGRAM  : Maestia.exe
FUNCTION : FUN_005dfe40
ENTRY    : 005dfe40
BODY     : [[005dfe40, 005dfe9d]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_005dfe40(short *param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int *in_ECX;
  int *piVar3;
  
  iVar1 = *in_ECX;
  piVar3 = (int *)(param_2 * 0x10 + 8 + iVar1);
  if ((*(int *)(param_2 * 0x10 + 8 + iVar1) != -2) && (iVar2 = param_2, piVar3[1] == param_2)) {
    while (((piVar3[1] != param_2 || ((short)piVar3[2] != *param_1)) ||
           (*(short *)((int)piVar3 + 10) != param_1[1]))) {
      iVar2 = *piVar3;
      if (iVar2 == -1) {
        return -1;
      }
      piVar3 = (int *)(iVar2 * 0x10 + 8 + iVar1);
    }
    return iVar2;
  }
  return -1;
}



============================================================
DISASSEMBLY
============================================================
005dfe40 : MOV EDX,dword ptr [ESP + 0x8]
005dfe44 : PUSH ESI
005dfe45 : MOV ESI,dword ptr [ECX]
005dfe47 : MOV ECX,EDX
005dfe49 : SHL ECX,0x4
005dfe4c : CMP dword ptr [ECX + ESI*0x1 + 0x8],-0x2
005dfe51 : LEA ECX,[ECX + ESI*0x1 + 0x8]
005dfe55 : MOV EAX,EDX
005dfe57 : JZ 0x005dfe97
005dfe59 : CMP dword ptr [ECX + 0x4],EDX
005dfe5c : JNZ 0x005dfe97
005dfe5e : PUSH EDI
005dfe5f : MOV EDI,dword ptr [ESP + 0xc]
005dfe63 : PUSH EBX
005dfe64 : CMP dword ptr [ECX + 0x4],EDX
005dfe67 : JNZ 0x005dfe7c
005dfe69 : MOV BX,word ptr [ECX + 0x8]
005dfe6d : CMP BX,word ptr [EDI]
005dfe70 : JNZ 0x005dfe7c
005dfe72 : MOV BX,word ptr [ECX + 0xa]
005dfe76 : CMP BX,word ptr [EDI + 0x2]
005dfe7a : JZ 0x005dfe91
005dfe7c : MOV EAX,dword ptr [ECX]
005dfe7e : CMP EAX,-0x1
005dfe81 : JZ 0x005dfe8e
005dfe83 : MOV ECX,EAX
005dfe85 : SHL ECX,0x4
005dfe88 : LEA ECX,[ECX + ESI*0x1 + 0x8]
005dfe8c : JMP 0x005dfe64
005dfe8e : OR EAX,0xffffffff
005dfe91 : POP EBX
005dfe92 : POP EDI
005dfe93 : POP ESI
005dfe94 : RET 0x8
005dfe97 : OR EAX,0xffffffff
005dfe9a : POP ESI
005dfe9b : RET 0x8

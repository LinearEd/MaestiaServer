PROGRAM  : Maestia.exe
FUNCTION : FUN_0041eb70
ENTRY    : 0041eb70
BODY     : [[0041eb70, 0041ebd8]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0041eb70(undefined1 param_1,undefined4 param_2,wchar_t *param_3)

{
  wchar_t wVar1;
  wchar_t *_Dest;
  ushort in_CX;
  ushort *unaff_ESI;
  
  unaff_ESI[2] = in_CX;
  *unaff_ESI = 0;
  _Dest = (wchar_t *)((int)unaff_ESI + 0xb);
  *(undefined1 *)(unaff_ESI + 1) = 0x90;
  *(undefined1 *)((int)unaff_ESI + 3) = 1;
  *(undefined1 *)(unaff_ESI + 3) = param_1;
  *(undefined4 *)((int)unaff_ESI + 7) = param_2;
  _wcsncpy(_Dest,param_3,99);
  *(undefined2 *)((int)unaff_ESI + 0xd1) = 0;
  do {
    wVar1 = *_Dest;
    _Dest = _Dest + 1;
  } while (wVar1 != L'\0');
  *unaff_ESI = *unaff_ESI ^
               ((short)((int)_Dest - ((int)unaff_ESI + 0xd) >> 1) * 2 + 0xdU ^ *unaff_ESI) & 0x1fff;
  return;
}



============================================================
DISASSEMBLY
============================================================
0041eb70 : PUSH EBP
0041eb71 : MOV EBP,ESP
0041eb73 : MOV DL,byte ptr [EBP + 0x8]
0041eb76 : PUSH EDI
0041eb77 : XOR EAX,EAX
0041eb79 : MOV word ptr [ESI + 0x4],CX
0041eb7d : MOV ECX,dword ptr [EBP + 0x10]
0041eb80 : PUSH 0x63
0041eb82 : MOV word ptr [ESI],AX
0041eb85 : MOV EAX,dword ptr [EBP + 0xc]
0041eb88 : PUSH ECX
0041eb89 : LEA EDI,[ESI + 0xb]
0041eb8c : PUSH EDI
0041eb8d : MOV byte ptr [ESI + 0x2],0x90
0041eb91 : MOV byte ptr [ESI + 0x3],0x1
0041eb95 : MOV byte ptr [ESI + 0x6],DL
0041eb98 : MOV dword ptr [ESI + 0x7],EAX
0041eb9b : CALL 0x00634e39
0041eba0 : ADD ESP,0xc
0041eba3 : XOR EDX,EDX
0041eba5 : MOV EAX,EDI
0041eba7 : MOV word ptr [EDI + 0xc6],DX
0041ebae : LEA EDX,[EAX + 0x2]
0041ebb1 : POP EDI
0041ebb2 : MOV CX,word ptr [EAX]
0041ebb5 : ADD EAX,0x2
0041ebb8 : TEST CX,CX
0041ebbb : JNZ 0x0041ebb2
0041ebbd : SUB EAX,EDX
0041ebbf : SAR EAX,0x1
0041ebc1 : LEA EAX,[EAX + EAX*0x1 + 0xd]
0041ebc5 : XOR AX,word ptr [ESI]
0041ebc8 : MOV ECX,0x1fff
0041ebcd : AND AX,CX
0041ebd0 : XOR word ptr [ESI],AX
0041ebd3 : MOV EAX,ESI
0041ebd5 : POP EBP
0041ebd6 : RET 0xc

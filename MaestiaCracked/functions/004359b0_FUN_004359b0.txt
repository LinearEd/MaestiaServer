PROGRAM  : Maestia.exe
FUNCTION : FUN_004359b0
ENTRY    : 004359b0
BODY     : [[004359b0, 004359d8] [004359e0, 00435aba]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_004359b0(int param_1,undefined4 *param_2)

{
  char cVar1;
  undefined4 *puVar2;
  int in_EAX;
  undefined4 *puVar3;
  int iVar4;
  undefined4 *puVar5;
  bool bVar6;
  
  puVar2 = param_2;
  puVar5 = (undefined4 *)(*(undefined4 **)(param_1 + 4))[1];
  bVar6 = true;
  cVar1 = *(char *)((int)puVar5 + 0x2d);
  puVar3 = *(undefined4 **)(param_1 + 4);
  while (cVar1 == '\0') {
    if ((uint)puVar5[9] < 0x10) {
      puVar3 = puVar5 + 4;
    }
    else {
      puVar3 = (undefined4 *)puVar5[4];
    }
    param_2 = puVar5;
    iVar4 = FUN_00438a40(0,*(undefined4 *)(in_EAX + 0x14),puVar3,puVar5[8]);
    bVar6 = iVar4 < 0;
    if (bVar6) {
      puVar5 = (undefined4 *)*puVar5;
    }
    else {
      puVar5 = (undefined4 *)puVar5[2];
    }
    puVar3 = param_2;
    cVar1 = *(char *)((int)puVar5 + 0x2d);
  }
  param_2 = puVar3;
  if (bVar6) {
    if (puVar3 == (undefined4 *)**(int **)(param_1 + 4)) {
      puVar5 = (undefined4 *)FUN_00435e20(&param_1,1,in_EAX);
      *puVar2 = *puVar5;
      *(undefined1 *)(puVar2 + 1) = 1;
      return puVar2;
    }
    FUN_004d6300();
  }
  if (*(uint *)(in_EAX + 0x18) < 0x10) {
    iVar4 = in_EAX + 4;
  }
  else {
    iVar4 = *(int *)(in_EAX + 4);
  }
  iVar4 = FUN_00438a40(0,puVar3[8],iVar4,*(undefined4 *)(in_EAX + 0x14));
  if (iVar4 < 0) {
    puVar5 = (undefined4 *)FUN_00435e20(&param_1,bVar6,in_EAX);
    *puVar2 = *puVar5;
    *(undefined1 *)(puVar2 + 1) = 1;
    return puVar2;
  }
  *puVar2 = puVar3;
  *(undefined1 *)(puVar2 + 1) = 0;
  return puVar2;
}



============================================================
DISASSEMBLY
============================================================
004359b0 : PUSH EBP
004359b1 : MOV EBP,ESP
004359b3 : SUB ESP,0xc
004359b6 : MOV EDX,dword ptr [EBP + 0x8]
004359b9 : PUSH EBX
004359ba : MOV EBX,dword ptr [EBP + 0xc]
004359bd : PUSH ESI
004359be : PUSH EDI
004359bf : MOV EDI,EAX
004359c1 : MOV EAX,dword ptr [EDX + 0x4]
004359c4 : MOV ESI,dword ptr [EAX + 0x4]
004359c7 : CMP byte ptr [ESI + 0x2d],0x0
004359cb : MOV ECX,EAX
004359cd : MOV AL,0x1
004359cf : MOV dword ptr [EBP + 0xc],ECX
004359d2 : MOV byte ptr [EBP + -0x8],AL
004359d5 : JNZ 0x00435a22
004359d7 : JMP 0x004359e0
004359e0 : CMP dword ptr [ESI + 0x24],0x10
004359e4 : MOV ECX,dword ptr [ESI + 0x20]
004359e7 : MOV dword ptr [EBP + 0xc],ESI
004359ea : JC 0x004359f1
004359ec : MOV EAX,dword ptr [ESI + 0x10]
004359ef : JMP 0x004359f4
004359f1 : LEA EAX,[ESI + 0x10]
004359f4 : PUSH ECX
004359f5 : PUSH EAX
004359f6 : MOV EAX,dword ptr [EDI + 0x14]
004359f9 : PUSH EAX
004359fa : PUSH 0x0
004359fc : MOV ECX,EDI
004359fe : CALL 0x00438a40
00435a03 : TEST EAX,EAX
00435a05 : SETL AL
00435a08 : MOV byte ptr [EBP + -0x8],AL
00435a0b : TEST AL,AL
00435a0d : JZ 0x00435a13
00435a0f : MOV ESI,dword ptr [ESI]
00435a11 : JMP 0x00435a16
00435a13 : MOV ESI,dword ptr [ESI + 0x8]
00435a16 : CMP byte ptr [ESI + 0x2d],0x0
00435a1a : JZ 0x004359e0
00435a1c : MOV ECX,dword ptr [EBP + 0xc]
00435a1f : MOV EDX,dword ptr [EBP + 0x8]
00435a22 : MOV ESI,ECX
00435a24 : MOV dword ptr [EBP + -0x4],ESI
00435a27 : TEST AL,AL
00435a29 : JZ 0x00435a5e
00435a2b : MOV EAX,dword ptr [EDX + 0x4]
00435a2e : CMP ECX,dword ptr [EAX]
00435a30 : JNZ 0x00435a53
00435a32 : PUSH EDI
00435a33 : PUSH 0x1
00435a35 : LEA EAX,[EBP + 0x8]
00435a38 : PUSH EAX
00435a39 : MOV EDI,EDX
00435a3b : CALL 0x00435e20
00435a40 : MOV ECX,dword ptr [EAX]
00435a42 : MOV dword ptr [EBX],ECX
00435a44 : MOV byte ptr [EBX + 0x4],0x1
00435a48 : MOV EAX,EBX
00435a4a : POP EDI
00435a4b : POP ESI
00435a4c : POP EBX
00435a4d : MOV ESP,EBP
00435a4f : POP EBP
00435a50 : RET 0x8
00435a53 : LEA EDX,[EBP + -0x4]
00435a56 : CALL 0x004d6300
00435a5b : MOV ESI,dword ptr [EBP + -0x4]
00435a5e : CMP dword ptr [EDI + 0x18],0x10
00435a62 : MOV EDX,dword ptr [EDI + 0x14]
00435a65 : LEA ECX,[ESI + 0xc]
00435a68 : JC 0x00435a6f
00435a6a : MOV EAX,dword ptr [EDI + 0x4]
00435a6d : JMP 0x00435a72
00435a6f : LEA EAX,[EDI + 0x4]
00435a72 : PUSH EDX
00435a73 : MOV EDX,dword ptr [ECX + 0x14]
00435a76 : PUSH EAX
00435a77 : PUSH EDX
00435a78 : PUSH 0x0
00435a7a : CALL 0x00438a40
00435a7f : TEST EAX,EAX
00435a81 : JGE 0x00435aaa
00435a83 : MOV EAX,dword ptr [EBP + -0x8]
00435a86 : PUSH EDI
00435a87 : MOV EDI,dword ptr [EBP + 0x8]
00435a8a : PUSH EAX
00435a8b : LEA ECX,[EBP + 0x8]
00435a8e : PUSH ECX
00435a8f : MOV ECX,dword ptr [EBP + 0xc]
00435a92 : CALL 0x00435e20
00435a97 : MOV EDX,dword ptr [EAX]
00435a99 : MOV dword ptr [EBX],EDX
00435a9b : MOV byte ptr [EBX + 0x4],0x1
00435a9f : MOV EAX,EBX
00435aa1 : POP EDI
00435aa2 : POP ESI
00435aa3 : POP EBX
00435aa4 : MOV ESP,EBP
00435aa6 : POP EBP
00435aa7 : RET 0x8
00435aaa : POP EDI
00435aab : MOV dword ptr [EBX],ESI
00435aad : POP ESI
00435aae : MOV byte ptr [EBX + 0x4],0x0
00435ab2 : MOV EAX,EBX
00435ab4 : POP EBX
00435ab5 : MOV ESP,EBP
00435ab7 : POP EBP
00435ab8 : RET 0x8

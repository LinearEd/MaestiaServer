PROGRAM  : Maestia.exe
FUNCTION : FUN_005479f0
ENTRY    : 005479f0
BODY     : [[005479f0, 00547b93]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_005479f0(void)

{
  ushort *puVar1;
  int iVar2;
  int *piVar3;
  bool bVar4;
  char cVar5;
  undefined4 uVar6;
  int iVar7;
  int *in_ECX;
  uint uVar8;
  int local_c0;
  int local_bc;
  int local_b8;
  int local_b4;
  int local_b0;
  
  if ((((in_ECX[0xba] != 1) || ((*(byte *)(*in_ECX + 0x141) & 8) == 0)) ||
      ((char)in_ECX[0x14a] != '\0')) ||
     ((float)(in_ECX[0x148] + in_ECX[0x147] + in_ECX[0x23] + in_ECX[0x22]) <=
      (float)in_ECX[0xb6] - (float)in_ECX[0x24])) {
    if (in_ECX[0xba] != 2) {
      return 0;
    }
    if (in_ECX[0x2e] != in_ECX[0xbc]) {
      return 0;
    }
  }
  cVar5 = FUN_00547360();
  if (cVar5 == '\0') {
    in_ECX[0x148] = 0;
    bVar4 = false;
    if ((in_ECX[0xa4] != 0) && ((uint)in_ECX[0xa5] < *(uint *)(in_ECX[0xa4] + 4))) {
      local_b8 = in_ECX[0xae];
      local_c0 = in_ECX[0xac];
      local_bc = in_ECX[0xad];
      local_b4 = in_ECX[0xaf];
      local_b0 = in_ECX[0xb0];
      FUN_0059a3e0(&local_c0);
      FUN_00545fe0(in_ECX + 0x8b);
      *(undefined1 *)(in_ECX + 0x14a) = 0;
      bVar4 = true;
      in_ECX[0xb9] = 0;
    }
    uVar6 = FUN_00545cb0();
    FUN_00545fe0(uVar6);
    FUN_00545f90();
    iVar2 = *(int *)(in_ECX[1] + 0x1c);
    iVar7 = FUN_00545e30();
    uVar8 = *(int *)(iVar7 + 4) + iVar2;
    if (in_ECX[4] != 0) {
      puVar1 = (ushort *)(in_ECX[4] + 6);
      *puVar1 = *puVar1 | 8;
    }
    FUN_00546200();
    FUN_00544610();
    piVar3 = (int *)in_ECX[3];
    in_ECX[0xb8] = 0;
    if (*piVar3 < 0) {
      piVar3[2] = piVar3[2] ^ (piVar3[2] ^ uVar8) & 0xffffff;
    }
    else {
      piVar3[2] = uVar8;
    }
    if (!bVar4) {
      return 0;
    }
    in_ECX[0x11] = 0;
  }
  return 1;
}



============================================================
DISASSEMBLY
============================================================
005479f0 : SUB ESP,0xc8
005479f6 : PUSH EBX
005479f7 : PUSH ESI
005479f8 : MOV ESI,ECX
005479fa : MOV ECX,dword ptr [ESI + 0x2e8]
00547a00 : CMP ECX,0x1
00547a03 : JNZ 0x00547a4e
00547a05 : MOV EAX,dword ptr [ESI]
00547a07 : TEST byte ptr [EAX + 0x141],0x8
00547a0e : JZ 0x00547a4e
00547a10 : CMP byte ptr [ESI + 0x528],0x0
00547a17 : JNZ 0x00547a4e
00547a19 : MOV EDX,dword ptr [ESI + 0x520]
00547a1f : ADD EDX,dword ptr [ESI + 0x51c]
00547a25 : ADD EDX,dword ptr [ESI + 0x8c]
00547a2b : ADD EDX,dword ptr [ESI + 0x88]
00547a31 : MOV dword ptr [ESP + 0xc],EDX
00547a35 : FILD dword ptr [ESP + 0xc]
00547a39 : FLD float ptr [ESI + 0x2d8]
00547a3f : FISUB dword ptr [ESI + 0x90]
00547a45 : FCOMPP
00547a47 : FNSTSW AX
00547a49 : TEST AH,0x5
00547a4c : JNP 0x00547a69
00547a4e : CMP ECX,0x2
00547a51 : JNZ 0x00547b89
00547a57 : MOV EAX,dword ptr [ESI + 0xb8]
00547a5d : CMP EAX,dword ptr [ESI + 0x2f0]
00547a63 : JNZ 0x00547b89
00547a69 : MOV ECX,ESI
00547a6b : CALL 0x00547360
00547a70 : TEST AL,AL
00547a72 : JNZ 0x00547b7e
00547a78 : PUSH EBP
00547a79 : PUSH EDI
00547a7a : XOR EDI,EDI
00547a7c : MOV dword ptr [ESI + 0x520],EDI
00547a82 : MOV EAX,dword ptr [ESI + 0x290]
00547a88 : MOV byte ptr [ESP + 0x13],0x0
00547a8d : CMP EAX,EDI
00547a8f : JZ 0x00547aff
00547a91 : MOV ECX,dword ptr [ESI + 0x294]
00547a97 : CMP ECX,dword ptr [EAX + 0x4]
00547a9a : JNC 0x00547aff
00547a9c : MOV ECX,dword ptr [ESI + 0x2b8]
00547aa2 : MOV EDX,dword ptr [ESI + 0x2b0]
00547aa8 : MOV EAX,dword ptr [ESI + 0x2b4]
00547aae : MOV dword ptr [ESP + 0x20],ECX
00547ab2 : LEA ECX,[ESP + 0x18]
00547ab6 : MOV dword ptr [ESP + 0x18],EDX
00547aba : MOV EDX,dword ptr [ESI + 0x2bc]
00547ac0 : MOV dword ptr [ESP + 0x1c],EAX
00547ac4 : MOV EAX,dword ptr [ESI + 0x2c0]
00547aca : PUSH ECX
00547acb : LEA ECX,[ESI + 0x94]
00547ad1 : MOV dword ptr [ESP + 0x28],EDX
00547ad5 : MOV dword ptr [ESP + 0x2c],EAX
00547ad9 : CALL 0x0059a3e0
00547ade : LEA EDX,[ESI + 0x22c]
00547ae4 : PUSH EDX
00547ae5 : LEA ECX,[ESI + 0x10]
00547ae8 : CALL 0x00545fe0
00547aed : MOV byte ptr [ESI + 0x528],0x0
00547af4 : MOV byte ptr [ESP + 0x13],0x1
00547af9 : MOV dword ptr [ESI + 0x2e4],EDI
00547aff : LEA ECX,[ESP + 0x2c]
00547b03 : CALL 0x00545cb0
00547b08 : PUSH EAX
00547b09 : LEA ECX,[ESI + 0x22c]
00547b0f : CALL 0x00545fe0
00547b14 : LEA ECX,[ESP + 0x2c]
00547b18 : CALL 0x00545f90
00547b1d : MOV EAX,dword ptr [ESI + 0x4]
00547b20 : MOV EBX,dword ptr [EAX + 0x1c]
00547b23 : LEA EDI,[ESI + 0x10]
00547b26 : MOV ECX,EDI
00547b28 : CALL 0x00545e30
00547b2d : MOV EBP,dword ptr [EAX + 0x4]
00547b30 : MOV EAX,dword ptr [EDI]
00547b32 : ADD EBP,EBX
00547b34 : XOR EBX,EBX
00547b36 : CMP EAX,EBX
00547b38 : JZ 0x00547b3f
00547b3a : OR word ptr [EAX + 0x6],0x8
00547b3f : MOV ECX,ESI
00547b41 : CALL 0x00546200
00547b46 : MOV ECX,EDI
00547b48 : CALL 0x00544610
00547b4d : MOV EAX,dword ptr [ESI + 0xc]
00547b50 : MOV dword ptr [ESI + 0x2e0],EBX
00547b56 : MOV ECX,dword ptr [EAX]
00547b58 : SHR ECX,0x1f
00547b5b : TEST CL,0x1
00547b5e : JZ 0x00547b70
00547b60 : MOV EDX,dword ptr [EAX + 0x8]
00547b63 : XOR EDX,EBP
00547b65 : AND EDX,0xffffff
00547b6b : XOR dword ptr [EAX + 0x8],EDX
00547b6e : JMP 0x00547b73
00547b70 : MOV dword ptr [EAX + 0x8],EBP
00547b73 : POP EDI
00547b74 : POP EBP
00547b75 : CMP byte ptr [ESP + 0xb],BL
00547b79 : JZ 0x00547b89
00547b7b : MOV dword ptr [ESI + 0x44],EBX
00547b7e : POP ESI
00547b7f : MOV AL,0x1
00547b81 : POP EBX
00547b82 : ADD ESP,0xc8
00547b88 : RET
00547b89 : POP ESI
00547b8a : XOR AL,AL
00547b8c : POP EBX
00547b8d : ADD ESP,0xc8
00547b93 : RET

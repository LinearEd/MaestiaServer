PROGRAM  : Maestia.exe
FUNCTION : FUN_00ab7ff0
ENTRY    : 00ab7ff0
BODY     : [[00ab7ff0, 00ab81fc] [00ab8200, 00ab85ff]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x00ab8182) */
/* WARNING: Type propagation algorithm not settling */

void FUN_00ab7ff0(undefined4 param_1,short param_2,undefined2 param_3)

{
  uint8_t uVar1;
  short sVar2;
  uint uVar3;
  uint *puVar4;
  uint8_t *puVar5;
  ulonglong uVar6;
  int *piVar7;
  uint *puVar8;
  uint8_t *puVar9;
  uint uVar10;
  ushort *puVar11;
  uint8_t *puVar12;
  short *psVar13;
  int in_ECX;
  ushort *puVar14;
  int iVar15;
  uint *puVar16;
  undefined1 local_47c [4];
  undefined2 local_478;
  undefined4 local_468;
  uint local_464;
  LPCRITICAL_SECTION local_460;
  char *local_45c;
  undefined4 local_458;
  int local_454;
  undefined4 local_450;
  uint local_44c;
  uint8_t *local_448;
  uint local_444;
  int local_440;
  int local_43c;
  uint *local_438;
  undefined1 local_434 [4];
  undefined2 local_430;
  undefined4 local_420;
  uint local_41c;
  short local_418;
  undefined1 local_416 [1022];
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3db5f;
  local_10 = ExceptionList;
  uVar10 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_43c = in_ECX;
  local_18 = uVar10;
  FUN_004437f0(&param_1);
  local_460 = (LPCRITICAL_SECTION)(in_ECX + 8);
  local_454 = 0;
  local_45c = ".\\Objects\\AvaMyParty.cpp";
  local_458 = 0x262;
  local_450 = 1;
  FUN_006ef1a0(&local_460);
  puVar8 = local_438;
  local_8 = 0;
  if (local_438 == *(uint **)(in_ECX + 0x2c)) {
    iVar15 = *(int *)ThreadLocalStoragePointer;
    uVar6 = (ulonglong)(*(byte *)(iVar15 + 0x18) + 1) % 3;
    local_448 = (uint8_t *)((int)uVar6 * 0x2000 + 0x122cb8 + iVar15);
    *(char *)(iVar15 + 0x18) = (char)uVar6;
    if (local_448 == (uint8_t *)0x0) {
      puVar12 = (uint8_t *)0x0;
    }
    else {
      local_448[0] = '\0';
      local_448[1] = '\0';
      local_448[2] = '9';
      local_448[3] = '\v';
      puVar12 = local_448;
    }
    local_8 = 0;
    if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
      FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),4,puVar12);
    }
    FUN_00404750(L"Can\'t find player in MyParty. then [SPKUZ_PARTY_RQ_LEAVE] Send  ",uVar10);
    local_8 = CONCAT31(local_8._1_3_,2);
    if ((int *)*DAT_00da98e8 != (int *)0x0) {
      (**(code **)(*(int *)*DAT_00da98e8 + 0x14))(L"AvaMyParty::OnMsgPartyPlayerHi",0x2b3,local_434)
      ;
    }
    local_438 = (uint *)**(uint **)(local_43c + 0x2c);
    if (local_438 != *(uint **)(local_43c + 0x2c)) {
      do {
        psVar13 = &local_418;
        for (iVar15 = 0x100; iVar15 != 0; iVar15 = iVar15 + -1) {
          psVar13[0] = 0;
          psVar13[1] = 0;
          psVar13 = psVar13 + 2;
        }
        uVar10 = local_438[4];
        if (*(uint *)(uVar10 + 0x34) < 8) {
          iVar15 = uVar10 + 0x20;
        }
        else {
          iVar15 = *(int *)(uVar10 + 0x20);
        }
        FUN_0040e4a0(L"CharKey:%d, Nick:%s",*(undefined4 *)(uVar10 + 0x58),iVar15);
        local_478 = 0;
        psVar13 = &local_418;
        local_464 = 7;
        local_468 = 0;
        do {
          sVar2 = *psVar13;
          psVar13 = psVar13 + 1;
        } while (sVar2 != 0);
        FUN_00406360(&local_418,(int)psVar13 - (int)local_416 >> 1);
        local_8._0_1_ = 3;
        if ((int *)*DAT_00da98e8 != (int *)0x0) {
          (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                    (L"AvaMyParty::OnMsgPartyPlayerHi",0x2ba,local_47c);
        }
        local_8 = CONCAT31(local_8._1_3_,2);
        if (7 < local_464) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_464 = 7;
        local_468 = 0;
        local_478 = 0;
        FUN_00416210();
      } while (local_438 != *(uint **)(local_43c + 0x2c));
    }
    local_8 = local_8 & 0xffffff00;
    if (7 < local_41c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_41c = 7;
    local_420 = 0;
    local_430 = 0;
  }
  else {
    *(short *)(local_438[4] + 0x70) = param_2;
    *(undefined2 *)(local_438[4] + 0x72) = param_3;
    uVar10 = local_438[4];
    *(undefined4 *)(uVar10 + 0x7c) = 0;
    *(undefined4 *)(uVar10 + 0x80) = 0;
    *(undefined4 *)(uVar10 + 0x84) = 0;
    local_438 = (uint *)**(uint **)(in_ECX + 0x2c);
    local_440 = 0;
    local_444 = 0;
    if (local_438 != *(uint **)(in_ECX + 0x2c)) {
      do {
        uVar10 = local_438[4];
        if (((uVar10 != 0) && (*(int *)(uVar10 + 0x14) != *(int *)(puVar8[4] + 0x14))) &&
           (*(int *)(uVar10 + 0x18) == *(int *)(puVar8[4] + 0x14))) {
          *(undefined2 *)(local_438[4] + 0x70) = *(undefined2 *)(puVar8[4] + 0x70);
          uVar10 = puVar8[4];
          uVar3 = local_438[4];
          *(undefined4 *)(uVar3 + 0x7c) = *(undefined4 *)(uVar10 + 0x7c);
          *(undefined4 *)(uVar3 + 0x80) = *(undefined4 *)(uVar10 + 0x80);
          *(undefined4 *)(uVar3 + 0x84) = *(undefined4 *)(uVar10 + 0x84);
          *(undefined2 *)(local_438[4] + 0x72) = *(undefined2 *)(puVar8[4] + 0x72);
          local_444 = (uint)*(ushort *)(local_438[4] + 0x72);
          local_440 = *(int *)(local_438[4] + 0x58);
        }
        FUN_00416210();
      } while (local_438 != *(uint **)(in_ECX + 0x2c));
    }
    uVar10 = puVar8[4];
    local_438 = *(uint **)(uVar10 + 0x30);
    iVar15 = *(int *)(DAT_0172491c + 0x17c);
    if (*(uint *)(uVar10 + 0x34) < 8) {
      puVar11 = (ushort *)(uVar10 + 0x20);
    }
    else {
      puVar11 = *(ushort **)(uVar10 + 0x20);
    }
    puVar4 = *(uint **)(iVar15 + 0x20);
    puVar16 = puVar4;
    if (local_438 <= puVar4) {
      puVar16 = local_438;
    }
    if (*(uint *)(iVar15 + 0x24) < 8) {
      puVar14 = (ushort *)(iVar15 + 0x10);
    }
    else {
      puVar14 = *(ushort **)(iVar15 + 0x10);
    }
    for (; puVar16 != (uint *)0x0; puVar16 = (uint *)((int)puVar16 - 1)) {
      if (*puVar14 != *puVar11) {
        uVar10 = (-(uint)(*puVar14 < *puVar11) & 0xfffffffe) + 1;
        if (uVar10 != 0) goto LAB_00ab81da;
        break;
      }
      puVar14 = puVar14 + 1;
      puVar11 = puVar11 + 1;
    }
    if (local_438 <= puVar4) {
      uVar10 = (uint)(puVar4 != local_438);
LAB_00ab81da:
      if (uVar10 == 0) {
        local_448 = *(uint8_t **)(local_43c + 0x2c);
        puVar12 = *(uint8_t **)local_448;
        if (puVar12 != local_448) {
          do {
            piVar7 = DAT_00da9894;
            iVar15 = *(int *)(puVar12 + 0x10);
            if (*(short *)(iVar15 + 0x70) == param_2) {
              *(undefined1 *)(iVar15 + 0x54) = 1;
              iVar15 = *(int *)(*piVar7 + 0x14c);
              local_44c = (uint)*(ushort *)(*(int *)(puVar12 + 0x10) + 0x72);
              local_438 = *(uint **)(*(int *)(puVar12 + 0x10) + 0x58);
              FUN_004437f0(&local_438);
              if ((local_43c != *(int *)(iVar15 + 0x3c)) && (*(int *)(local_43c + 0x10) != 0)) {
                FUN_0095bb40(*(int *)(local_43c + 0x10),local_44c);
              }
              if (*(int *)(*(int *)(DAT_0172491c + 0x17c) + 0x1f54) != 0) {
                FUN_00ab6980(1);
              }
            }
            else {
              *(undefined1 *)(iVar15 + 0x54) = 0;
              FUN_00a90060(*(undefined2 *)(*(int *)(puVar12 + 0x10) + 0x72));
              if (local_440 != 0) {
                FUN_00a90060(local_444);
              }
            }
            if (puVar12[0x15] == '\0') {
              puVar5 = *(uint8_t **)(puVar12 + 8);
              if (puVar5[0x15] == '\0') {
                uVar1 = (*(uint8_t **)puVar5)[0x15];
                puVar12 = puVar5;
                puVar5 = *(uint8_t **)puVar5;
                while (uVar1 == '\0') {
                  uVar1 = (*(uint8_t **)puVar5)[0x15];
                  puVar12 = puVar5;
                  puVar5 = *(uint8_t **)puVar5;
                }
              }
              else {
                uVar1 = (*(uint8_t **)(puVar12 + 4))[0x15];
                puVar9 = *(uint8_t **)(puVar12 + 4);
                puVar5 = puVar12;
                while ((puVar12 = puVar9, uVar1 == '\0' && (puVar5 == *(uint8_t **)(puVar12 + 8))))
                {
                  uVar1 = (*(uint8_t **)(puVar12 + 4))[0x15];
                  puVar9 = *(uint8_t **)(puVar12 + 4);
                  puVar5 = puVar12;
                }
              }
            }
          } while (puVar12 != local_448);
        }
        goto LAB_00ab85bb;
      }
    }
    if (*(short *)(DAT_00da93ec + 0x450) == param_2) {
      *(undefined1 *)(puVar8[4] + 0x54) = 1;
      FUN_00a90910(*(undefined2 *)(puVar8[4] + 0x72));
    }
    else {
      *(undefined1 *)(puVar8[4] + 0x54) = 0;
      FUN_00a90060(*(undefined2 *)(puVar8[4] + 0x72));
      if (local_440 != 0) {
        FUN_00a90060(local_444);
      }
    }
  }
LAB_00ab85bb:
  local_8 = 0xffffffff;
  if (local_454 != 0) {
    LeaveCriticalSection(local_460);
    local_454 = 0;
  }
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00ab7ff0 : PUSH EBP
00ab7ff1 : MOV EBP,ESP
00ab7ff3 : PUSH -0x1
00ab7ff5 : PUSH 0xb3db5f
00ab7ffa : MOV EAX,FS:[0x0]
00ab8000 : PUSH EAX
00ab8001 : SUB ESP,0x470
00ab8007 : MOV EAX,[0x00d66fa0]
00ab800c : XOR EAX,EBP
00ab800e : MOV dword ptr [EBP + -0x14],EAX
00ab8011 : PUSH EBX
00ab8012 : PUSH ESI
00ab8013 : PUSH EDI
00ab8014 : PUSH EAX
00ab8015 : LEA EAX,[EBP + -0xc]
00ab8018 : MOV FS:[0x0],EAX
00ab801e : MOV ESI,ECX
00ab8020 : LEA EAX,[EBP + 0x8]
00ab8023 : PUSH EAX
00ab8024 : LEA ECX,[ESI + 0x28]
00ab8027 : LEA EAX,[EBP + 0xfffffbcc]
00ab802d : MOV dword ptr [EBP + 0xfffffbc8],ESI
00ab8033 : CALL 0x004437f0
00ab8038 : LEA EDX,[EBP + 0xfffffba4]
00ab803e : LEA ECX,[ESI + 0x8]
00ab8041 : XOR EBX,EBX
00ab8043 : PUSH EDX
00ab8044 : MOV dword ptr [EBP + 0xfffffbb0],EBX
00ab804a : MOV dword ptr [EBP + 0xfffffba4],ECX
00ab8050 : MOV dword ptr [EBP + 0xfffffba8],0xc41c38
00ab805a : MOV dword ptr [EBP + 0xfffffbac],0x262
00ab8064 : MOV dword ptr [EBP + 0xfffffbb4],0x1
00ab806e : CALL 0x006ef1a0
00ab8073 : MOV dword ptr [EBP + -0x4],EBX
00ab8076 : MOV EAX,dword ptr [ESI + 0x2c]
00ab8079 : MOV EDI,dword ptr [EBP + 0xfffffbcc]
00ab807f : CMP EDI,EAX
00ab8081 : JZ 0x00ab83bc
00ab8087 : MOV EAX,dword ptr [EDI + 0x10]
00ab808a : MOV CX,word ptr [EBP + 0xc]
00ab808e : XORPS XMM0,XMM0
00ab8091 : MOV word ptr [EAX + 0x70],CX
00ab8095 : MOV EDX,dword ptr [EDI + 0x10]
00ab8098 : MOV AX,word ptr [EBP + 0x10]
00ab809c : MOV word ptr [EDX + 0x72],AX
00ab80a0 : MOV EAX,dword ptr [EDI + 0x10]
00ab80a3 : ADD EAX,0x7c
00ab80a6 : MOVSS dword ptr [EAX],XMM0
00ab80aa : MOVSS dword ptr [EAX + 0x4],XMM0
00ab80af : MOVSS dword ptr [EAX + 0x8],XMM0
00ab80b4 : MOV EAX,dword ptr [ESI + 0x2c]
00ab80b7 : MOV EDX,dword ptr [EAX]
00ab80b9 : MOV dword ptr [EBP + 0xfffffbc4],EBX
00ab80bf : MOV dword ptr [EBP + 0xfffffbc0],EBX
00ab80c5 : MOV dword ptr [EBP + 0xfffffbcc],EDX
00ab80cb : CMP EDX,EAX
00ab80cd : JZ 0x00ab8152
00ab80d3 : MOV EAX,dword ptr [EDX + 0x10]
00ab80d6 : CMP EAX,EBX
00ab80d8 : JZ 0x00ab813a
00ab80da : MOV ECX,dword ptr [EDI + 0x10]
00ab80dd : MOV ECX,dword ptr [ECX + 0x14]
00ab80e0 : CMP dword ptr [EAX + 0x14],ECX
00ab80e3 : JZ 0x00ab813a
00ab80e5 : CMP dword ptr [EAX + 0x18],ECX
00ab80e8 : JNZ 0x00ab813a
00ab80ea : MOV EAX,dword ptr [EDI + 0x10]
00ab80ed : MOV AX,word ptr [EAX + 0x70]
00ab80f1 : MOV ECX,dword ptr [EDX + 0x10]
00ab80f4 : MOV word ptr [ECX + 0x70],AX
00ab80f8 : MOV EAX,dword ptr [EDI + 0x10]
00ab80fb : MOV ECX,dword ptr [EDX + 0x10]
00ab80fe : FLD float ptr [EAX + 0x7c]
00ab8101 : FSTP float ptr [ECX + 0x7c]
00ab8104 : ADD EAX,0x7c
00ab8107 : FLD float ptr [EAX + 0x4]
00ab810a : ADD ECX,0x7c
00ab810d : FSTP float ptr [ECX + 0x4]
00ab8110 : FLD float ptr [EAX + 0x8]
00ab8113 : FSTP float ptr [ECX + 0x8]
00ab8116 : MOV ECX,dword ptr [EDI + 0x10]
00ab8119 : MOV EAX,dword ptr [EDX + 0x10]
00ab811c : MOV CX,word ptr [ECX + 0x72]
00ab8120 : MOV word ptr [EAX + 0x72],CX
00ab8124 : MOV EDX,dword ptr [EDX + 0x10]
00ab8127 : MOVZX ECX,word ptr [EDX + 0x72]
00ab812b : MOV EAX,dword ptr [EDX + 0x58]
00ab812e : MOV dword ptr [EBP + 0xfffffbc4],EAX
00ab8134 : MOV dword ptr [EBP + 0xfffffbc0],ECX
00ab813a : LEA EDX,[EBP + 0xfffffbcc]
00ab8140 : CALL 0x00416210
00ab8145 : MOV EAX,dword ptr [ESI + 0x2c]
00ab8148 : MOV EDX,dword ptr [EBP + 0xfffffbcc]
00ab814e : CMP EDX,EAX
00ab8150 : JNZ 0x00ab80d3
00ab8152 : MOV EAX,dword ptr [EDI + 0x10]
00ab8155 : MOV EDX,dword ptr [0x0172491c]
00ab815b : MOV EBX,dword ptr [EAX + 0x30]
00ab815e : MOV ECX,dword ptr [EDX + 0x17c]
00ab8164 : ADD EAX,0x1c
00ab8167 : CMP dword ptr [EAX + 0x18],0x8
00ab816b : MOV dword ptr [EBP + 0xfffffbcc],EBX
00ab8171 : JC 0x00ab8178
00ab8173 : MOV EAX,dword ptr [EAX + 0x4]
00ab8176 : JMP 0x00ab817b
00ab8178 : ADD EAX,0x4
00ab817b : MOV ESI,dword ptr [ECX + 0x20]
00ab817e : MOV EDX,ESI
00ab8180 : CMP EDX,ESI
00ab8182 : CMOVC ESI,EDX
00ab8185 : MOV EDX,ESI
00ab8187 : CMP ESI,EBX
00ab8189 : JC 0x00ab818d
00ab818b : MOV EDX,EBX
00ab818d : CMP dword ptr [ECX + 0x24],0x8
00ab8191 : JC 0x00ab8198
00ab8193 : MOV ECX,dword ptr [ECX + 0x10]
00ab8196 : JMP 0x00ab819b
00ab8198 : ADD ECX,0x10
00ab819b : TEST EDX,EDX
00ab819d : JBE 0x00ab81cb
00ab819f : NOP
00ab81a0 : MOV BX,word ptr [ECX]
00ab81a3 : CMP BX,word ptr [EAX]
00ab81a6 : JNZ 0x00ab81b5
00ab81a8 : ADD ECX,0x2
00ab81ab : ADD EAX,0x2
00ab81ae : SUB EDX,0x1
00ab81b1 : JNZ 0x00ab81a0
00ab81b3 : JMP 0x00ab81c5
00ab81b5 : MOV CX,BX
00ab81b8 : CMP CX,word ptr [EAX]
00ab81bb : SBB EAX,EAX
00ab81bd : AND EAX,0xfffffffe
00ab81c0 : ADD EAX,0x1
00ab81c3 : JNZ 0x00ab81da
00ab81c5 : MOV EBX,dword ptr [EBP + 0xfffffbcc]
00ab81cb : CMP ESI,EBX
00ab81cd : JC 0x00ab8329
00ab81d3 : XOR EAX,EAX
00ab81d5 : CMP ESI,EBX
00ab81d7 : SETNZ AL
00ab81da : TEST EAX,EAX
00ab81dc : JNZ 0x00ab8329
00ab81e2 : MOV EDX,dword ptr [EBP + 0xfffffbc8]
00ab81e8 : MOV EAX,dword ptr [EDX + 0x2c]
00ab81eb : MOV EDI,dword ptr [EAX]
00ab81ed : MOV dword ptr [EBP + 0xfffffbbc],EAX
00ab81f3 : CMP EDI,EAX
00ab81f5 : JZ 0x00ab85bb
00ab81fb : JMP 0x00ab8200
00ab8200 : MOV EAX,dword ptr [EDI + 0x10]
00ab8203 : MOV CX,word ptr [EBP + 0xc]
00ab8207 : CMP word ptr [EAX + 0x70],CX
00ab820b : JNZ 0x00ab8291
00ab8211 : MOV EDX,EAX
00ab8213 : MOV EAX,[0x00da9894]
00ab8218 : MOV byte ptr [EDX + 0x54],0x1
00ab821c : MOV EAX,dword ptr [EAX]
00ab821e : MOV ESI,dword ptr [EAX + 0x14c]
00ab8224 : MOV EAX,dword ptr [EDI + 0x10]
00ab8227 : MOVZX ECX,word ptr [EAX + 0x72]
00ab822b : MOV EBX,dword ptr [EAX + 0x58]
00ab822e : LEA EDX,[EBP + 0xfffffbcc]
00ab8234 : MOV dword ptr [EBP + 0xfffffbb8],ECX
00ab823a : PUSH EDX
00ab823b : LEA ECX,[ESI + 0x38]
00ab823e : LEA EAX,[EBP + 0xfffffbc8]
00ab8244 : MOV dword ptr [EBP + 0xfffffbcc],EBX
00ab824a : CALL 0x004437f0
00ab824f : MOV ESI,dword ptr [ESI + 0x3c]
00ab8252 : MOV EAX,dword ptr [EBP + 0xfffffbc8]
00ab8258 : CMP EAX,ESI
00ab825a : JZ 0x00ab8270
00ab825c : MOV EAX,dword ptr [EAX + 0x10]
00ab825f : TEST EAX,EAX
00ab8261 : JZ 0x00ab8270
00ab8263 : MOV ECX,dword ptr [EBP + 0xfffffbb8]
00ab8269 : PUSH ECX
00ab826a : PUSH EAX
00ab826b : CALL 0x0095bb40
00ab8270 : MOV EDX,dword ptr [0x0172491c]
00ab8276 : MOV EAX,dword ptr [EDX + 0x17c]
00ab827c : MOV ECX,dword ptr [EAX + 0x1f54]
00ab8282 : TEST ECX,ECX
00ab8284 : JZ 0x00ab82d8
00ab8286 : PUSH 0x1
00ab8288 : MOV EAX,EBX
00ab828a : CALL 0x00ab6980
00ab828f : JMP 0x00ab82d8
00ab8291 : MOV ECX,dword ptr [0x00da9894]
00ab8297 : MOV byte ptr [EAX + 0x54],0x0
00ab829b : MOV EAX,dword ptr [ECX]
00ab829d : MOV ECX,dword ptr [EAX + 0x14c]
00ab82a3 : MOV EAX,dword ptr [EDI + 0x10]
00ab82a6 : MOVZX EDX,word ptr [EAX + 0x72]
00ab82aa : MOV ESI,dword ptr [EAX + 0x58]
00ab82ad : PUSH EDX
00ab82ae : CALL 0x00a90060
00ab82b3 : MOV ESI,dword ptr [EBP + 0xfffffbc4]
00ab82b9 : TEST ESI,ESI
00ab82bb : JZ 0x00ab82d8
00ab82bd : MOV EAX,[0x00da9894]
00ab82c2 : MOV EAX,dword ptr [EAX]
00ab82c4 : MOV ECX,dword ptr [EBP + 0xfffffbc0]
00ab82ca : MOV EAX,dword ptr [EAX + 0x14c]
00ab82d0 : PUSH ECX
00ab82d1 : MOV ECX,EAX
00ab82d3 : CALL 0x00a90060
00ab82d8 : CMP byte ptr [EDI + 0x15],0x0
00ab82dc : JNZ 0x00ab8318
00ab82de : MOV EAX,dword ptr [EDI + 0x8]
00ab82e1 : CMP byte ptr [EAX + 0x15],0x0
00ab82e5 : JNZ 0x00ab82fd
00ab82e7 : MOV EDI,EAX
00ab82e9 : MOV EAX,dword ptr [EDI]
00ab82eb : CMP byte ptr [EAX + 0x15],0x0
00ab82ef : JNZ 0x00ab8318
00ab82f1 : MOV EDI,EAX
00ab82f3 : MOV EAX,dword ptr [EDI]
00ab82f5 : CMP byte ptr [EAX + 0x15],0x0
00ab82f9 : JZ 0x00ab82f1
00ab82fb : JMP 0x00ab8318
00ab82fd : MOV EAX,dword ptr [EDI + 0x4]
00ab8300 : CMP byte ptr [EAX + 0x15],0x0
00ab8304 : JNZ 0x00ab8316
00ab8306 : CMP EDI,dword ptr [EAX + 0x8]
00ab8309 : JNZ 0x00ab8316
00ab830b : MOV EDI,EAX
00ab830d : MOV EAX,dword ptr [EAX + 0x4]
00ab8310 : CMP byte ptr [EAX + 0x15],0x0
00ab8314 : JZ 0x00ab8306
00ab8316 : MOV EDI,EAX
00ab8318 : CMP EDI,dword ptr [EBP + 0xfffffbbc]
00ab831e : JNZ 0x00ab8200
00ab8324 : JMP 0x00ab85bb
00ab8329 : MOV EDX,dword ptr [0x00da93ec]
00ab832f : MOV AX,word ptr [EBP + 0xc]
00ab8333 : CMP word ptr [EDX + 0x450],AX
00ab833a : JNZ 0x00ab8368
00ab833c : MOV ECX,dword ptr [EDI + 0x10]
00ab833f : MOV EDX,dword ptr [0x00da9894]
00ab8345 : MOV byte ptr [ECX + 0x54],0x1
00ab8349 : MOV EDI,dword ptr [EDI + 0x10]
00ab834c : MOVZX ECX,word ptr [EDI + 0x72]
00ab8350 : MOV EAX,dword ptr [EDX]
00ab8352 : MOV EAX,dword ptr [EAX + 0x14c]
00ab8358 : MOV EDI,dword ptr [EDI + 0x58]
00ab835b : PUSH ECX
00ab835c : MOV ESI,EAX
00ab835e : CALL 0x00a90910
00ab8363 : JMP 0x00ab85bb
00ab8368 : MOV EDX,dword ptr [EDI + 0x10]
00ab836b : MOV EAX,[0x00da9894]
00ab8370 : MOV ESI,dword ptr [EBP + 0x8]
00ab8373 : MOV byte ptr [EDX + 0x54],0x0
00ab8377 : MOV ECX,dword ptr [EDI + 0x10]
00ab837a : MOVZX EDX,word ptr [ECX + 0x72]
00ab837e : MOV EAX,dword ptr [EAX]
00ab8380 : MOV EAX,dword ptr [EAX + 0x14c]
00ab8386 : PUSH EDX
00ab8387 : MOV ECX,EAX
00ab8389 : CALL 0x00a90060
00ab838e : MOV ESI,dword ptr [EBP + 0xfffffbc4]
00ab8394 : TEST ESI,ESI
00ab8396 : JZ 0x00ab85bb
00ab839c : MOV EAX,[0x00da9894]
00ab83a1 : MOV EAX,dword ptr [EAX]
00ab83a3 : MOV ECX,dword ptr [EBP + 0xfffffbc0]
00ab83a9 : MOV EAX,dword ptr [EAX + 0x14c]
00ab83af : PUSH ECX
00ab83b0 : MOV ECX,EAX
00ab83b2 : CALL 0x00a90060
00ab83b7 : JMP 0x00ab85bb
00ab83bc : MOV EDX,dword ptr FS:[0x2c]
00ab83c3 : MOV ECX,dword ptr [EDX]
00ab83c5 : MOVZX EAX,byte ptr [ECX + 0x18]
00ab83c9 : INC EAX
00ab83ca : CDQ
00ab83cb : MOV ESI,0x3
00ab83d0 : IDIV ESI
00ab83d2 : MOVZX EAX,DL
00ab83d5 : SHL EAX,0xd
00ab83d8 : LEA EAX,[EAX + ECX*0x1 + 0x122cb8]
00ab83df : MOV byte ptr [ECX + 0x18],DL
00ab83e2 : MOV dword ptr [EBP + 0xfffffbbc],EAX
00ab83e8 : MOV byte ptr [EBP + -0x4],0x1
00ab83ec : CMP EAX,EBX
00ab83ee : JZ 0x00ab83ff
00ab83f0 : XOR ECX,ECX
00ab83f2 : MOV word ptr [EAX],CX
00ab83f5 : MOV byte ptr [EAX + 0x2],0x39
00ab83f9 : MOV byte ptr [EAX + 0x3],0xb
00ab83fd : JMP 0x00ab8401
00ab83ff : XOR EAX,EAX
00ab8401 : MOV byte ptr [EBP + -0x4],0x0
00ab8405 : MOV EDX,dword ptr [0x017247d4]
00ab840b : MOV ECX,dword ptr [EDX + 0x4]
00ab840e : CMP ECX,EBX
00ab8410 : JZ 0x00ab8422
00ab8412 : CMP byte ptr [EDX + 0x8],0x0
00ab8416 : JZ 0x00ab8422
00ab8418 : PUSH 0x4
00ab841a : PUSH ECX
00ab841b : MOV EDI,EAX
00ab841d : CALL 0x00a0dd40
00ab8422 : PUSH 0xc41c58
00ab8427 : LEA ESI,[EBP + 0xfffffbd0]
00ab842d : CALL 0x00404750
00ab8432 : ADD ESP,0x4
00ab8435 : MOV byte ptr [EBP + -0x4],0x2
00ab8439 : MOV EDX,dword ptr [0x00da98e8]
00ab843f : MOV ECX,dword ptr [EDX]
00ab8441 : XOR ESI,ESI
00ab8443 : CMP ECX,ESI
00ab8445 : JZ 0x00ab845f
00ab8447 : MOV EAX,dword ptr [ECX]
00ab8449 : MOV EAX,dword ptr [EAX + 0x14]
00ab844c : LEA EDX,[EBP + 0xfffffbd0]
00ab8452 : PUSH EDX
00ab8453 : PUSH 0x2b3
00ab8458 : PUSH 0xc41cdc
00ab845d : CALL EAX
00ab845f : MOV ECX,dword ptr [EBP + 0xfffffbc8]
00ab8465 : MOV EAX,dword ptr [ECX + 0x2c]
00ab8468 : MOV EDX,dword ptr [EAX]
00ab846a : MOV dword ptr [EBP + 0xfffffbcc],EDX
00ab8470 : MOV EDI,0x7
00ab8475 : CMP EDX,EAX
00ab8477 : JZ 0x00ab858a
00ab847d : LEA ECX,[ECX]
00ab8480 : XOR EAX,EAX
00ab8482 : MOVZX EBX,AX
00ab8485 : MOV EAX,EBX
00ab8487 : SHL EBX,0x10
00ab848a : OR EAX,EBX
00ab848c : MOV ECX,0x100
00ab8491 : LEA EDI,[EBP + 0xfffffbec]
00ab8497 : STOSD.REP ES:EDI
00ab8499 : MOV EAX,dword ptr [EDX + 0x10]
00ab849c : MOV EBX,0x8
00ab84a1 : CMP dword ptr [EAX + 0x34],EBX
00ab84a4 : JC 0x00ab84ab
00ab84a6 : MOV ECX,dword ptr [EAX + 0x20]
00ab84a9 : JMP 0x00ab84ae
00ab84ab : LEA ECX,[EAX + 0x20]
00ab84ae : MOV EDX,dword ptr [EAX + 0x58]
00ab84b1 : PUSH ECX
00ab84b2 : PUSH EDX
00ab84b3 : PUSH 0xc41d1c
00ab84b8 : LEA EDX,[EBP + 0xfffffbec]
00ab84be : CALL 0x0040e4a0
00ab84c3 : ADD ESP,0xc
00ab84c6 : XOR EAX,EAX
00ab84c8 : MOV word ptr [EBP + 0xfffffb8c],AX
00ab84cf : MOV EDI,0x7
00ab84d4 : LEA EAX,[EBP + 0xfffffbec]
00ab84da : MOV dword ptr [EBP + 0xfffffba0],EDI
00ab84e0 : MOV dword ptr [EBP + 0xfffffb9c],ESI
00ab84e6 : LEA EDX,[EAX + 0x2]
00ab84e9 : LEA ESP,[ESP]
00ab84f0 : MOV CX,word ptr [EAX]
00ab84f3 : ADD EAX,0x2
00ab84f6 : CMP CX,SI
00ab84f9 : JNZ 0x00ab84f0
00ab84fb : SUB EAX,EDX
00ab84fd : SAR EAX,0x1
00ab84ff : PUSH EAX
00ab8500 : LEA ECX,[EBP + 0xfffffbec]
00ab8506 : PUSH ECX
00ab8507 : LEA ECX,[EBP + 0xfffffb88]
00ab850d : CALL 0x00406360
00ab8512 : MOV byte ptr [EBP + -0x4],0x3
00ab8516 : MOV EDX,dword ptr [0x00da98e8]
00ab851c : MOV ECX,dword ptr [EDX]
00ab851e : CMP ECX,ESI
00ab8520 : JZ 0x00ab853a
00ab8522 : MOV EAX,dword ptr [ECX]
00ab8524 : MOV EAX,dword ptr [EAX + 0x14]
00ab8527 : LEA EDX,[EBP + 0xfffffb88]
00ab852d : PUSH EDX
00ab852e : PUSH 0x2ba
00ab8533 : PUSH 0xc41d44
00ab8538 : CALL EAX
00ab853a : MOV byte ptr [EBP + -0x4],0x2
00ab853e : CMP dword ptr [EBP + 0xfffffba0],EBX
00ab8544 : JC 0x00ab8551
00ab8546 : MOV ECX,dword ptr [EBP + 0xfffffb8c]
00ab854c : CALL 0x006f04e0
00ab8551 : XOR ECX,ECX
00ab8553 : LEA EDX,[EBP + 0xfffffbcc]
00ab8559 : MOV dword ptr [EBP + 0xfffffba0],EDI
00ab855f : MOV dword ptr [EBP + 0xfffffb9c],ESI
00ab8565 : MOV word ptr [EBP + 0xfffffb8c],CX
00ab856c : CALL 0x00416210
00ab8571 : MOV EDX,dword ptr [EBP + 0xfffffbc8]
00ab8577 : MOV EAX,dword ptr [EDX + 0x2c]
00ab857a : MOV EDX,dword ptr [EBP + 0xfffffbcc]
00ab8580 : CMP EDX,EAX
00ab8582 : JNZ 0x00ab8480
00ab8588 : JMP 0x00ab858f
00ab858a : MOV EBX,0x8
00ab858f : MOV byte ptr [EBP + -0x4],0x0
00ab8593 : CMP dword ptr [EBP + 0xfffffbe8],EBX
00ab8599 : JC 0x00ab85a6
00ab859b : MOV ECX,dword ptr [EBP + 0xfffffbd4]
00ab85a1 : CALL 0x006f04e0
00ab85a6 : XOR EAX,EAX
00ab85a8 : MOV dword ptr [EBP + 0xfffffbe8],EDI
00ab85ae : MOV dword ptr [EBP + 0xfffffbe4],ESI
00ab85b4 : MOV word ptr [EBP + 0xfffffbd4],AX
00ab85bb : MOV dword ptr [EBP + -0x4],0xffffffff
00ab85c2 : CMP dword ptr [EBP + 0xfffffbb0],0x0
00ab85c9 : JZ 0x00ab85e2
00ab85cb : MOV ECX,dword ptr [EBP + 0xfffffba4]
00ab85d1 : PUSH ECX
00ab85d2 : CALL dword ptr [0x00b8511c]
00ab85d8 : MOV dword ptr [EBP + 0xfffffbb0],0x0
00ab85e2 : MOV ECX,dword ptr [EBP + -0xc]
00ab85e5 : MOV dword ptr FS:[0x0],ECX
00ab85ec : POP ECX
00ab85ed : POP EDI
00ab85ee : POP ESI
00ab85ef : POP EBX
00ab85f0 : MOV ECX,dword ptr [EBP + -0x14]
00ab85f3 : XOR ECX,EBP
00ab85f5 : CALL 0x00633e6b
00ab85fa : MOV ESP,EBP
00ab85fc : POP EBP
00ab85fd : RET 0xc

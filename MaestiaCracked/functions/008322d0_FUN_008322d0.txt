PROGRAM  : Maestia.exe
FUNCTION : FUN_008322d0
ENTRY    : 008322d0
BODY     : [[008322d0, 0083261e]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008322d0(undefined4 param_1,short *param_2,char *param_3)

{
  short sVar1;
  char cVar2;
  short *psVar3;
  char *pcVar4;
  char *pcVar5;
  char *pcVar6;
  int iVar7;
  undefined4 uVar8;
  undefined4 *in_ECX;
  undefined4 uVar9;
  undefined4 *puVar10;
  char local_118 [256];
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_00b29f42;
  local_10 = ExceptionList;
  local_18 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  in_ECX[7] = 7;
  in_ECX[6] = 0;
  *(undefined2 *)(in_ECX + 2) = 0;
  local_8 = 0;
  FUN_00831f60(local_18);
  *in_ECX = param_1;
  psVar3 = param_2;
  do {
    sVar1 = *psVar3;
    psVar3 = psVar3 + 1;
  } while (sVar1 != 0);
  FUN_00406360(param_2,(int)psVar3 - (int)(param_2 + 1) >> 1);
  *(undefined8 *)(in_ECX + 8) = 0;
  *(undefined8 *)(in_ECX + 10) = 0;
  puVar10 = in_ECX + 8;
  *(undefined8 *)(in_ECX + 0xc) = 0;
  *(undefined8 *)(in_ECX + 0xe) = 0;
  *(undefined8 *)(in_ECX + 0x10) = 0;
  *(undefined8 *)(in_ECX + 0x12) = 0;
  *(undefined8 *)(in_ECX + 0x14) = 0;
  *(undefined8 *)(in_ECX + 0x16) = 0;
  *(undefined8 *)(in_ECX + 0x18) = 0;
  *(undefined8 *)(in_ECX + 0x1a) = 0;
  _strcpy_s(local_118,0x100,param_3);
  uVar9 = 0;
  pcVar4 = _strtok(local_118,",");
  do {
    if (pcVar4 == (char *)0x0) {
LAB_008325f4:
      local_8 = 0xffffffff;
      ExceptionList = local_10;
      __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
      return;
    }
    if (*pcVar4 == ' ') {
      cVar2 = ' ';
      do {
        if (cVar2 == '\0') break;
        cVar2 = pcVar4[1];
        pcVar4 = pcVar4 + 1;
      } while (cVar2 == ' ');
    }
    pcVar5 = pcVar4;
    do {
      cVar2 = *pcVar5;
      pcVar5 = pcVar5 + 1;
    } while (cVar2 != '\0');
    pcVar6 = pcVar4 + (int)(pcVar5 + (-1 - (int)(pcVar4 + 1)));
    cVar2 = pcVar4[(int)(pcVar5 + (-1 - (int)(pcVar4 + 1)))];
    while (cVar2 == ' ') {
      *pcVar6 = '\0';
      pcVar6 = pcVar6 + -1;
      cVar2 = *pcVar6;
    }
    pcVar5 = pcVar4;
    if (*pcVar4 == '[') {
      pcVar5 = pcVar4 + 1;
      uVar9 = 1;
      pcVar6 = pcVar5;
      do {
        cVar2 = *pcVar6;
        pcVar6 = pcVar6 + 1;
      } while (cVar2 != '\0');
      if (pcVar5[(int)(pcVar6 + (-1 - (int)(pcVar4 + 2)))] == ']') {
        pcVar6 = pcVar5;
        do {
          cVar2 = *pcVar6;
          pcVar6 = pcVar6 + 1;
        } while (cVar2 != '\0');
        pcVar5[(int)(pcVar6 + (-1 - (int)(pcVar4 + 2)))] = '\0';
      }
    }
    iVar7 = __stricmp(pcVar5,"i");
    if (iVar7 == 0) {
      uVar8 = 1;
    }
    else {
      iVar7 = __stricmp(pcVar5,"s");
      if (iVar7 == 0) {
        uVar8 = 2;
      }
      else {
        iVar7 = __stricmp(pcVar5,"o");
        if (iVar7 == 0) {
          uVar8 = 4;
        }
        else {
          iVar7 = __stricmp(pcVar5,"b");
          if (iVar7 == 0) {
            uVar8 = 5;
          }
          else {
            iVar7 = __stricmp(pcVar5,"p");
            if (iVar7 == 0) {
              uVar8 = 6;
            }
            else {
              iVar7 = __stricmp(pcVar5,"a");
              if (iVar7 == 0) {
                uVar8 = 7;
              }
              else {
                iVar7 = __stricmp(pcVar5,"nick");
                if (iVar7 == 0) {
                  uVar8 = 3;
                }
                else {
                  iVar7 = __stricmp(pcVar5,"slot");
                  if (iVar7 == 0) {
                    uVar8 = 8;
                  }
                  else {
                    iVar7 = __stricmp(pcVar5,"skill");
                    if (iVar7 == 0) {
                      uVar8 = 9;
                    }
                    else {
                      iVar7 = __stricmp(pcVar5,"item");
                      if (iVar7 == 0) {
                        uVar8 = 10;
                      }
                      else {
                        iVar7 = __stricmp(pcVar5,"target");
                        if (iVar7 == 0) {
                          uVar8 = 0xb;
                        }
                        else {
                          iVar7 = __stricmp(pcVar5,"npc");
                          if (iVar7 == 0) {
                            uVar8 = 0xc;
                          }
                          else {
                            iVar7 = __stricmp(pcVar5,"zone");
                            if (iVar7 == 0) {
                              uVar8 = 0xd;
                            }
                            else {
                              iVar7 = __stricmp(pcVar5,"tool");
                              if (iVar7 != 0) {
                                FUN_008018d0(L"Admin Command Type: command = \'%s\', param name = \'%S\' unknown\n"
                                             ,param_2,pcVar5);
                                goto LAB_008325f4;
                              }
                              uVar8 = 0xe;
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
    puVar10[10] = uVar9;
    *puVar10 = uVar8;
    puVar10 = puVar10 + 1;
    pcVar4 = _strtok((char *)0x0,",");
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
008322d0 : PUSH EBP
008322d1 : MOV EBP,ESP
008322d3 : PUSH -0x1
008322d5 : PUSH 0xb29f42
008322da : MOV EAX,FS:[0x0]
008322e0 : PUSH EAX
008322e1 : SUB ESP,0x110
008322e7 : MOV EAX,[0x00d66fa0]
008322ec : XOR EAX,EBP
008322ee : MOV dword ptr [EBP + -0x14],EAX
008322f1 : PUSH EBX
008322f2 : PUSH ESI
008322f3 : PUSH EDI
008322f4 : PUSH EAX
008322f5 : LEA EAX,[EBP + -0xc]
008322f8 : MOV FS:[0x0],EAX
008322fe : MOV EAX,dword ptr [EBP + 0xc]
00832301 : MOV EBX,dword ptr [EBP + 0x10]
00832304 : MOV EDI,ECX
00832306 : LEA ESI,[EDI + 0x4]
00832309 : MOV dword ptr [EBP + 0xfffffee4],EAX
0083230f : XOR EAX,EAX
00832311 : XOR ECX,ECX
00832313 : MOV dword ptr [ESI + 0x18],0x7
0083231a : MOV dword ptr [ESI + 0x14],EAX
0083231d : MOV dword ptr [EBP + 0xfffffee8],EDI
00832323 : MOV word ptr [ESI + 0x4],CX
00832327 : MOV dword ptr [EBP + -0x4],EAX
0083232a : CALL 0x00831f60
0083232f : MOV EDX,dword ptr [EBP + 0x8]
00832332 : MOV EAX,dword ptr [EBP + 0xfffffee4]
00832338 : MOV dword ptr [EDI],EDX
0083233a : LEA ECX,[EAX + 0x2]
0083233d : LEA ECX,[ECX]
00832340 : MOV DX,word ptr [EAX]
00832343 : ADD EAX,0x2
00832346 : TEST DX,DX
00832349 : JNZ 0x00832340
0083234b : SUB EAX,ECX
0083234d : SAR EAX,0x1
0083234f : PUSH EAX
00832350 : MOV EAX,dword ptr [EBP + 0xfffffee4]
00832356 : PUSH EAX
00832357 : MOV ECX,ESI
00832359 : CALL 0x00406360
0083235e : MOV EAX,dword ptr [EBP + 0xfffffee8]
00832364 : PXOR XMM0,XMM0
00832368 : MOVQ qword ptr [EDI + 0x20],XMM0
0083236d : MOVQ qword ptr [EDI + 0x28],XMM0
00832372 : ADD EDI,0x20
00832375 : MOVQ qword ptr [EDI + 0x10],XMM0
0083237a : MOVQ qword ptr [EDI + 0x18],XMM0
0083237f : MOVQ qword ptr [EDI + 0x20],XMM0
00832384 : PXOR XMM0,XMM0
00832388 : MOVQ qword ptr [EAX + 0x48],XMM0
0083238d : MOVQ qword ptr [EAX + 0x50],XMM0
00832392 : PUSH EBX
00832393 : MOVQ qword ptr [EAX + 0x58],XMM0
00832398 : LEA ECX,[EBP + 0xfffffeec]
0083239e : PUSH 0x100
008323a3 : MOVQ qword ptr [EAX + 0x60],XMM0
008323a8 : PUSH ECX
008323a9 : MOVQ qword ptr [EAX + 0x68],XMM0
008323ae : CALL 0x00638300
008323b3 : ADD ESP,0xc
008323b6 : LEA EDX,[EBP + 0xfffffeec]
008323bc : PUSH 0xc365cc
008323c1 : PUSH EDX
008323c2 : XOR EBX,EBX
008323c4 : CALL 0x0063872d
008323c9 : MOV ESI,EAX
008323cb : ADD ESP,0x8
008323ce : TEST ESI,ESI
008323d0 : JZ 0x008325f4
008323d6 : MOV AL,byte ptr [ESI]
008323d8 : CMP AL,0x20
008323da : JNZ 0x008323ec
008323dc : LEA ESP,[ESP]
008323e0 : TEST AL,AL
008323e2 : JZ 0x008323ec
008323e4 : MOV AL,byte ptr [ESI + 0x1]
008323e7 : INC ESI
008323e8 : CMP AL,0x20
008323ea : JZ 0x008323e0
008323ec : MOV EAX,ESI
008323ee : LEA EDX,[EAX + 0x1]
008323f1 : MOV CL,byte ptr [EAX]
008323f3 : INC EAX
008323f4 : TEST CL,CL
008323f6 : JNZ 0x008323f1
008323f8 : SUB EAX,EDX
008323fa : CMP byte ptr [EAX + ESI*0x1 + -0x1],0x20
008323ff : LEA EAX,[EAX + ESI*0x1 + -0x1]
00832403 : JNZ 0x0083240e
00832405 : MOV byte ptr [EAX],0x0
00832408 : DEC EAX
00832409 : CMP byte ptr [EAX],0x20
0083240c : JZ 0x00832405
0083240e : CMP byte ptr [ESI],0x5b
00832411 : JNZ 0x00832442
00832413 : INC ESI
00832414 : MOV EAX,ESI
00832416 : MOV EBX,0x1
0083241b : LEA EDX,[EAX + 0x1]
0083241e : MOV EDI,EDI
00832420 : MOV CL,byte ptr [EAX]
00832422 : INC EAX
00832423 : TEST CL,CL
00832425 : JNZ 0x00832420
00832427 : SUB EAX,EDX
00832429 : CMP byte ptr [EAX + ESI*0x1 + -0x1],0x5d
0083242e : JNZ 0x00832442
00832430 : MOV EAX,ESI
00832432 : LEA EDX,[EAX + 0x1]
00832435 : MOV CL,byte ptr [EAX]
00832437 : INC EAX
00832438 : TEST CL,CL
0083243a : JNZ 0x00832435
0083243c : SUB EAX,EDX
0083243e : MOV byte ptr [EAX + ESI*0x1 + -0x1],CL
00832442 : PUSH 0xc365d0
00832447 : PUSH ESI
00832448 : CALL 0x0063b8b9
0083244d : ADD ESP,0x8
00832450 : TEST EAX,EAX
00832452 : JNZ 0x0083245e
00832454 : MOV EAX,0x1
00832459 : JMP 0x008325b6
0083245e : PUSH 0xc365d4
00832463 : PUSH ESI
00832464 : CALL 0x0063b8b9
00832469 : ADD ESP,0x8
0083246c : TEST EAX,EAX
0083246e : JNZ 0x0083247a
00832470 : MOV EAX,0x2
00832475 : JMP 0x008325b6
0083247a : PUSH 0xc365d8
0083247f : PUSH ESI
00832480 : CALL 0x0063b8b9
00832485 : ADD ESP,0x8
00832488 : TEST EAX,EAX
0083248a : JNZ 0x00832496
0083248c : MOV EAX,0x4
00832491 : JMP 0x008325b6
00832496 : PUSH 0xc365dc
0083249b : PUSH ESI
0083249c : CALL 0x0063b8b9
008324a1 : ADD ESP,0x8
008324a4 : TEST EAX,EAX
008324a6 : JNZ 0x008324b2
008324a8 : MOV EAX,0x5
008324ad : JMP 0x008325b6
008324b2 : PUSH 0xc365e0
008324b7 : PUSH ESI
008324b8 : CALL 0x0063b8b9
008324bd : ADD ESP,0x8
008324c0 : TEST EAX,EAX
008324c2 : JNZ 0x008324ce
008324c4 : MOV EAX,0x6
008324c9 : JMP 0x008325b6
008324ce : PUSH 0xc365e4
008324d3 : PUSH ESI
008324d4 : CALL 0x0063b8b9
008324d9 : ADD ESP,0x8
008324dc : TEST EAX,EAX
008324de : JNZ 0x008324ea
008324e0 : MOV EAX,0x7
008324e5 : JMP 0x008325b6
008324ea : PUSH 0xc365e8
008324ef : PUSH ESI
008324f0 : CALL 0x0063b8b9
008324f5 : ADD ESP,0x8
008324f8 : TEST EAX,EAX
008324fa : JNZ 0x00832506
008324fc : MOV EAX,0x3
00832501 : JMP 0x008325b6
00832506 : PUSH 0xc365f0
0083250b : PUSH ESI
0083250c : CALL 0x0063b8b9
00832511 : ADD ESP,0x8
00832514 : TEST EAX,EAX
00832516 : JNZ 0x00832522
00832518 : MOV EAX,0x8
0083251d : JMP 0x008325b6
00832522 : PUSH 0xc365f8
00832527 : PUSH ESI
00832528 : CALL 0x0063b8b9
0083252d : ADD ESP,0x8
00832530 : TEST EAX,EAX
00832532 : JNZ 0x0083253b
00832534 : MOV EAX,0x9
00832539 : JMP 0x008325b6
0083253b : PUSH 0xc36600
00832540 : PUSH ESI
00832541 : CALL 0x0063b8b9
00832546 : ADD ESP,0x8
00832549 : TEST EAX,EAX
0083254b : JNZ 0x00832554
0083254d : MOV EAX,0xa
00832552 : JMP 0x008325b6
00832554 : PUSH 0xc36608
00832559 : PUSH ESI
0083255a : CALL 0x0063b8b9
0083255f : ADD ESP,0x8
00832562 : TEST EAX,EAX
00832564 : JNZ 0x0083256d
00832566 : MOV EAX,0xb
0083256b : JMP 0x008325b6
0083256d : PUSH 0xc36610
00832572 : PUSH ESI
00832573 : CALL 0x0063b8b9
00832578 : ADD ESP,0x8
0083257b : TEST EAX,EAX
0083257d : JNZ 0x00832586
0083257f : MOV EAX,0xc
00832584 : JMP 0x008325b6
00832586 : PUSH 0xc36614
0083258b : PUSH ESI
0083258c : CALL 0x0063b8b9
00832591 : ADD ESP,0x8
00832594 : TEST EAX,EAX
00832596 : JNZ 0x0083259f
00832598 : MOV EAX,0xd
0083259d : JMP 0x008325b6
0083259f : PUSH 0xc3661c
008325a4 : PUSH ESI
008325a5 : CALL 0x0063b8b9
008325aa : ADD ESP,0x8
008325ad : TEST EAX,EAX
008325af : JNZ 0x008325d9
008325b1 : MOV EAX,0xe
008325b6 : PUSH 0xc366a8
008325bb : MOV dword ptr [EDI + 0x28],EBX
008325be : MOV dword ptr [EDI],EAX
008325c0 : PUSH 0x0
008325c2 : ADD EDI,0x4
008325c5 : CALL 0x0063872d
008325ca : MOV ESI,EAX
008325cc : ADD ESP,0x8
008325cf : TEST ESI,ESI
008325d1 : JNZ 0x008323d6
008325d7 : JMP 0x008325f4
008325d9 : MOV EAX,dword ptr [EBP + 0xfffffee4]
008325df : PUSH ESI
008325e0 : MOV ESI,dword ptr [0x00da98e8]
008325e6 : PUSH EAX
008325e7 : PUSH 0xc36628
008325ec : CALL 0x008018d0
008325f1 : ADD ESP,0xc
008325f4 : MOV dword ptr [EBP + -0x4],0xffffffff
008325fb : MOV EAX,dword ptr [EBP + 0xfffffee8]
00832601 : MOV ECX,dword ptr [EBP + -0xc]
00832604 : MOV dword ptr FS:[0x0],ECX
0083260b : POP ECX
0083260c : POP EDI
0083260d : POP ESI
0083260e : POP EBX
0083260f : MOV ECX,dword ptr [EBP + -0x14]
00832612 : XOR ECX,EBP
00832614 : CALL 0x00633e6b
00832619 : MOV ESP,EBP
0083261b : POP EBP
0083261c : RET 0xc

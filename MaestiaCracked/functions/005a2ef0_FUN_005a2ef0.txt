PROGRAM  : Maestia.exe
FUNCTION : FUN_005a2ef0
ENTRY    : 005a2ef0
BODY     : [[005a2ef0, 005a2fef]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005a2ef0(undefined4 param_1,uint *param_2,uint param_3)

{
  uint *puVar1;
  uint *puVar2;
  int *piVar3;
  int iVar4;
  uint uVar5;
  int *in_ECX;
  uint uVar6;
  int iVar7;
  
  piVar3 = (int *)*in_ECX;
  if (piVar3 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar3 * 5) <= piVar3[1] * 4 + 4U) goto LAB_005a2f2a;
    iVar7 = piVar3[1] * 2 + 2;
  }
  FUN_005a3970(param_1,iVar7);
LAB_005a2f2a:
  piVar3 = (int *)*in_ECX;
  param_3 = param_3 & piVar3[1];
  *piVar3 = *piVar3 + 1;
  iVar7 = *in_ECX;
  iVar4 = *(int *)(iVar7 + 8 + param_3 * 0xc);
  puVar1 = (uint *)(iVar7 + 8 + param_3 * 0xc);
  if (iVar4 == -2) {
    *puVar1 = 0xffffffff;
    puVar1[2] = *param_2;
    puVar1[1] = param_3;
    return;
  }
  uVar6 = param_3;
  do {
    uVar6 = uVar6 + 1 & *(uint *)(iVar7 + 4);
  } while (*(int *)(iVar7 + 8 + uVar6 * 0xc) != -2);
  piVar3 = (int *)(iVar7 + 8 + uVar6 * 0xc);
  uVar5 = puVar1[1];
  if (uVar5 != param_3) {
    puVar2 = (uint *)(iVar7 + 8 + uVar5 * 0xc);
    for (uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0xc); uVar5 != param_3;
        uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0xc)) {
      uVar5 = *puVar2;
      puVar2 = (uint *)(iVar7 + 8 + uVar5 * 0xc);
    }
    if (piVar3 != (int *)0x0) {
      *piVar3 = iVar4;
      piVar3[1] = puVar1[1];
      piVar3[2] = puVar1[2];
    }
    *puVar2 = uVar6;
    puVar1[2] = *param_2;
    *puVar1 = 0xffffffff;
    puVar1[1] = param_3;
    return;
  }
  if (piVar3 != (int *)0x0) {
    *piVar3 = iVar4;
    piVar3[1] = puVar1[1];
    piVar3[2] = puVar1[2];
  }
  puVar1[2] = *param_2;
  *puVar1 = uVar6;
  puVar1[1] = param_3;
  return;
}



============================================================
DISASSEMBLY
============================================================
005a2ef0 : PUSH EBP
005a2ef1 : PUSH ESI
005a2ef2 : MOV ESI,ECX
005a2ef4 : MOV EAX,dword ptr [ESI]
005a2ef6 : TEST EAX,EAX
005a2ef8 : JNZ 0x005a2f03
005a2efa : MOV EAX,dword ptr [ESP + 0xc]
005a2efe : PUSH 0x8
005a2f00 : PUSH EAX
005a2f01 : JMP 0x005a2f25
005a2f03 : MOV ECX,dword ptr [EAX + 0x4]
005a2f06 : LEA EDX,[ECX*0x4 + 0x4]
005a2f0d : MOV ECX,dword ptr [EAX]
005a2f0f : LEA ECX,[ECX + ECX*0x4]
005a2f12 : CMP ECX,EDX
005a2f14 : JBE 0x005a2f2a
005a2f16 : MOV EDX,dword ptr [EAX + 0x4]
005a2f19 : MOV ECX,dword ptr [ESP + 0xc]
005a2f1d : LEA EAX,[EDX + EDX*0x1 + 0x2]
005a2f21 : PUSH EAX
005a2f22 : PUSH ECX
005a2f23 : MOV ECX,ESI
005a2f25 : CALL 0x005a3970
005a2f2a : MOV ECX,dword ptr [ESI]
005a2f2c : MOV EAX,dword ptr [ESP + 0x14]
005a2f30 : AND EAX,dword ptr [ECX + 0x4]
005a2f33 : INC dword ptr [ECX]
005a2f35 : MOV ESI,dword ptr [ESI]
005a2f37 : LEA EDX,[EAX + EAX*0x2]
005a2f3a : MOV EBP,dword ptr [ESI + EDX*0x4 + 0x8]
005a2f3e : LEA ECX,[ESI + EDX*0x4 + 0x8]
005a2f42 : CMP EBP,-0x2
005a2f45 : JNZ 0x005a2f5e
005a2f47 : MOV EDX,dword ptr [ESP + 0x10]
005a2f4b : MOV dword ptr [ECX],0xffffffff
005a2f51 : MOV EDX,dword ptr [EDX]
005a2f53 : POP ESI
005a2f54 : MOV dword ptr [ECX + 0x8],EDX
005a2f57 : MOV dword ptr [ECX + 0x4],EAX
005a2f5a : POP EBP
005a2f5b : RET 0xc
005a2f5e : PUSH EDI
005a2f5f : MOV EDI,dword ptr [ESI + 0x4]
005a2f62 : MOV EDX,EAX
005a2f64 : PUSH EBX
005a2f65 : INC EDX
005a2f66 : AND EDX,EDI
005a2f68 : LEA EBX,[EDX + EDX*0x2]
005a2f6b : CMP dword ptr [ESI + EBX*0x4 + 0x8],-0x2
005a2f70 : JNZ 0x005a2f65
005a2f72 : LEA EDI,[EDX + EDX*0x2]
005a2f75 : LEA EBX,[ESI + EDI*0x4 + 0x8]
005a2f79 : MOV EDI,dword ptr [ECX + 0x4]
005a2f7c : CMP EDI,EAX
005a2f7e : JNZ 0x005a2fa7
005a2f80 : TEST EBX,EBX
005a2f82 : JZ 0x005a2f92
005a2f84 : MOV dword ptr [EBX],EBP
005a2f86 : MOV ESI,dword ptr [ECX + 0x4]
005a2f89 : MOV dword ptr [EBX + 0x4],ESI
005a2f8c : MOV ESI,dword ptr [ECX + 0x8]
005a2f8f : MOV dword ptr [EBX + 0x8],ESI
005a2f92 : MOV ESI,dword ptr [ESP + 0x18]
005a2f96 : MOV ESI,dword ptr [ESI]
005a2f98 : POP EBX
005a2f99 : POP EDI
005a2f9a : MOV dword ptr [ECX + 0x8],ESI
005a2f9d : POP ESI
005a2f9e : MOV dword ptr [ECX],EDX
005a2fa0 : MOV dword ptr [ECX + 0x4],EAX
005a2fa3 : POP EBP
005a2fa4 : RET 0xc
005a2fa7 : LEA EDI,[EDI + EDI*0x2]
005a2faa : CMP dword ptr [ESI + EDI*0x4 + 0x8],EAX
005a2fae : LEA EDI,[ESI + EDI*0x4 + 0x8]
005a2fb2 : JZ 0x005a2fc3
005a2fb4 : MOV EDI,dword ptr [EDI]
005a2fb6 : LEA EDI,[EDI + EDI*0x2]
005a2fb9 : CMP dword ptr [ESI + EDI*0x4 + 0x8],EAX
005a2fbd : LEA EDI,[ESI + EDI*0x4 + 0x8]
005a2fc1 : JNZ 0x005a2fb4
005a2fc3 : TEST EBX,EBX
005a2fc5 : JZ 0x005a2fd5
005a2fc7 : MOV dword ptr [EBX],EBP
005a2fc9 : MOV ESI,dword ptr [ECX + 0x4]
005a2fcc : MOV dword ptr [EBX + 0x4],ESI
005a2fcf : MOV ESI,dword ptr [ECX + 0x8]
005a2fd2 : MOV dword ptr [EBX + 0x8],ESI
005a2fd5 : MOV dword ptr [EDI],EDX
005a2fd7 : MOV EDX,dword ptr [ESP + 0x18]
005a2fdb : MOV EDX,dword ptr [EDX]
005a2fdd : POP EBX
005a2fde : POP EDI
005a2fdf : POP ESI
005a2fe0 : MOV dword ptr [ECX + 0x8],EDX
005a2fe3 : MOV dword ptr [ECX],0xffffffff
005a2fe9 : MOV dword ptr [ECX + 0x4],EAX
005a2fec : POP EBP
005a2fed : RET 0xc

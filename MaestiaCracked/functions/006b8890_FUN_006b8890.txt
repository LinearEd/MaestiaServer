PROGRAM  : Maestia.exe
FUNCTION : FUN_006b8890
ENTRY    : 006b8890
BODY     : [[006b8890, 006b8c89]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006b8890(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  int iVar2;
  uint *puVar3;
  uint *puVar4;
  uint uVar5;
  undefined4 uVar6;
  undefined4 *puVar7;
  int iVar8;
  int *piVar9;
  int local_34;
  uint local_30;
  undefined4 local_2c;
  int iStack_28;
  int iStack_24;
  ushort uStack_20;
  short sStack_1e;
  ushort uStack_1c;
  short sStack_1a;
  ushort uStack_18;
  ushort uStack_16;
  int iStack_14;
  int iStack_10;
  int iStack_c;
  int iStack_8;
  ushort uStack_2;
  
  uVar1 = *(undefined4 *)(param_1 + 0x68);
  uVar6 = *(undefined4 *)(param_1 + 100);
  local_34 = 0;
  local_2c = uVar6;
  if (*(int *)(param_1 + 0x2cc) == 0) {
    local_34 = (**(code **)(param_1 + 0x1fc))(param_1,0x67766172,uVar1,&local_30);
    if (local_34 != 0) {
      return local_34;
    }
    local_34 = (**(code **)(param_1 + 0x1fc))(param_1,0x66766172,uVar1,&local_30);
    if (local_34 != 0) {
      return local_34;
    }
    iStack_28 = FUN_00687830(uVar1);
    local_34 = FUN_006889e0(uVar1,&DAT_00bebc18,&iStack_24);
    if (local_34 != 0) {
      return local_34;
    }
    if (((iStack_24 != 0x10000) || (sStack_1e != 2)) || (sStack_1a != 0x14)) {
      return 8;
    }
    if ((uint)uStack_16 != (uint)uStack_1c * 4 + 4) {
      return 8;
    }
    if (local_30 < (uint)uStack_18 * (uint)uStack_16 + (uint)uStack_1c * 0x14 + (uint)uStack_20) {
      return 8;
    }
    iVar2 = FUN_00688c00(uVar6,0x28,&local_34);
    *(int *)(param_1 + 0x2cc) = iVar2;
    if (local_34 != 0) {
      return local_34;
    }
    *(uint *)(iVar2 + 0xc) =
         ((uint)uStack_18 * 4 + 0x1d) * (uint)uStack_1c + 0x14 + (uint)uStack_18 * 8;
    puVar3 = (uint *)FUN_00688c00(uVar6,*(undefined4 *)(*(int *)(param_1 + 0x2cc) + 0xc),&local_34);
    if (local_34 != 0) {
      return local_34;
    }
    *(uint **)(*(int *)(param_1 + 0x2cc) + 8) = puVar3;
    *puVar3 = (uint)uStack_1c;
    puVar3[1] = 0xffffffff;
    puVar3[2] = (uint)uStack_18;
    puVar4 = puVar3 + 5;
    puVar3[3] = (uint)puVar4;
    puVar3[4] = (uint)(puVar4 + (uint)uStack_1c * 6);
    iVar2 = 0;
    puVar4 = puVar4 + (uint)uStack_1c * 6 + (uint)uStack_18 * 2;
    if (uStack_18 != 0) {
      do {
        *(uint **)(puVar3[4] + iVar2 * 8) = puVar4;
        puVar4 = puVar4 + uStack_1c;
        iVar2 = iVar2 + 1;
      } while (iVar2 < (int)(uint)uStack_18);
    }
    iVar8 = 0;
    iVar2 = 0;
    if (uStack_1c != 0) {
      do {
        *(uint **)(iVar8 + puVar3[3]) = puVar4;
        iVar2 = iVar2 + 1;
        puVar4 = (uint *)((int)puVar4 + 5);
        iVar8 = iVar8 + 0x18;
      } while (iVar2 < (int)(uint)uStack_1c);
    }
    iVar2 = FUN_006877c0(uVar1,(uint)uStack_20 + iStack_28);
    if (iVar2 != 0) {
      return iVar2;
    }
    piVar9 = (int *)puVar3[3];
    iVar2 = 0;
    if (uStack_1c != 0) {
      do {
        local_34 = 0;
        iVar8 = FUN_006889e0(uVar1,&DAT_00bebc3c,&iStack_14);
        if (iVar8 != 0) {
          return iVar8;
        }
        piVar9[1] = iStack_10;
        piVar9[2] = iStack_c;
        piVar9[4] = iStack_14;
        piVar9[3] = iStack_8;
        piVar9[5] = (uint)uStack_2;
        *(char *)*piVar9 = (char)((uint)iStack_14 >> 0x18);
        *(undefined1 *)(*piVar9 + 1) = *(undefined1 *)((int)piVar9 + 0x12);
        *(undefined1 *)(*piVar9 + 2) = *(undefined1 *)((int)piVar9 + 0x11);
        *(char *)(*piVar9 + 3) = (char)piVar9[4];
        *(undefined1 *)(*piVar9 + 4) = 0;
        iVar2 = iVar2 + 1;
        piVar9 = piVar9 + 6;
      } while (iVar2 < (int)(uint)uStack_1c);
    }
    local_34 = 0;
    piVar9 = (int *)puVar3[4];
    iVar2 = 0;
    if (uStack_18 != 0) {
      do {
        local_34 = FUN_00688900(uVar1,(uint)uStack_1c * 4 + 4);
        if (local_34 != 0) {
          return local_34;
        }
        uVar5 = FUN_00687940(uVar1);
        piVar9[1] = uVar5 & 0xffff;
        FUN_00687940(uVar1);
        iVar8 = 0;
        if (uStack_1c != 0) {
          do {
            uVar6 = FUN_006879a0(uVar1);
            *(undefined4 *)(*piVar9 + iVar8 * 4) = uVar6;
            iVar8 = iVar8 + 1;
          } while (iVar8 < (int)(uint)uStack_1c);
        }
        FUN_006889b0(uVar1);
        iVar2 = iVar2 + 1;
        piVar9 = piVar9 + 2;
      } while (iVar2 < (int)(uint)uStack_18);
    }
  }
  if ((param_2 != (undefined4 *)0x0) &&
     (puVar3 = (uint *)FUN_00688c00(local_2c,*(undefined4 *)(*(int *)(param_1 + 0x2cc) + 0xc),
                                    &local_34), local_34 == 0)) {
    _memcpy(puVar3,*(void **)(*(int *)(param_1 + 0x2cc) + 8),
            *(size_t *)(*(int *)(param_1 + 0x2cc) + 0xc));
    puVar4 = puVar3 + 5;
    puVar3[3] = (uint)puVar4;
    puVar3[4] = (uint)(puVar4 + *puVar3 * 6);
    puVar4 = puVar4 + *puVar3 * 6 + puVar3[2] * 2;
    uVar5 = 0;
    if (puVar3[2] != 0) {
      do {
        *(uint **)(puVar3[4] + uVar5 * 8) = puVar4;
        uVar5 = uVar5 + 1;
        puVar4 = puVar4 + *puVar3;
      } while (uVar5 < puVar3[2]);
    }
    puVar7 = (undefined4 *)puVar3[3];
    uVar5 = 0;
    if (*puVar3 != 0) {
      do {
        iVar2 = puVar7[4];
        *puVar7 = puVar4;
        if (iVar2 == 0x77676874) {
          *puVar7 = &DAT_00be87fc;
        }
        else if (iVar2 == 0x77647468) {
          *puVar7 = "Width";
        }
        else if (iVar2 == 0x6f70737a) {
          *puVar7 = "OpticalSize";
        }
        else if (iVar2 == 0x736c6e74) {
          *puVar7 = "Slant";
        }
        uVar5 = uVar5 + 1;
        puVar4 = (uint *)((int)puVar4 + 5);
        puVar7 = puVar7 + 6;
      } while (uVar5 < *puVar3);
    }
    *param_2 = puVar3;
  }
  return local_34;
}



============================================================
DISASSEMBLY
============================================================
006b8890 : SUB ESP,0x34
006b8893 : PUSH EBX
006b8894 : MOV EBX,dword ptr [ESP + 0x3c]
006b8898 : PUSH EBP
006b8899 : MOV EBP,dword ptr [EBX + 0x68]
006b889c : PUSH ESI
006b889d : XOR EAX,EAX
006b889f : PUSH EDI
006b88a0 : MOV EDI,dword ptr [EBX + 0x64]
006b88a3 : MOV dword ptr [ESP + 0x18],EDI
006b88a7 : MOV dword ptr [ESP + 0x10],EAX
006b88ab : CMP dword ptr [EBX + 0x2cc],EAX
006b88b1 : JNZ 0x006b8b9c
006b88b7 : MOV ECX,dword ptr [EBX + 0x1fc]
006b88bd : LEA EAX,[ESP + 0x14]
006b88c1 : PUSH EAX
006b88c2 : PUSH EBP
006b88c3 : PUSH 0x67766172
006b88c8 : PUSH EBX
006b88c9 : CALL ECX
006b88cb : ADD ESP,0x10
006b88ce : MOV dword ptr [ESP + 0x10],EAX
006b88d2 : TEST EAX,EAX
006b88d4 : JNZ 0x006b8c82
006b88da : MOV EAX,dword ptr [EBX + 0x1fc]
006b88e0 : LEA EDX,[ESP + 0x14]
006b88e4 : PUSH EDX
006b88e5 : PUSH EBP
006b88e6 : PUSH 0x66766172
006b88eb : PUSH EBX
006b88ec : CALL EAX
006b88ee : ADD ESP,0x10
006b88f1 : MOV dword ptr [ESP + 0x10],EAX
006b88f5 : TEST EAX,EAX
006b88f7 : JNZ 0x006b8c82
006b88fd : PUSH EBP
006b88fe : CALL 0x00687830
006b8903 : LEA ECX,[ESP + 0x24]
006b8907 : PUSH ECX
006b8908 : PUSH 0xbebc18
006b890d : PUSH EBP
006b890e : MOV dword ptr [ESP + 0x2c],EAX
006b8912 : CALL 0x006889e0
006b8917 : ADD ESP,0x10
006b891a : MOV dword ptr [ESP + 0x10],EAX
006b891e : TEST EAX,EAX
006b8920 : JNZ 0x006b8c82
006b8926 : CMP dword ptr [ESP + 0x20],0x10000
006b892e : JNZ 0x006b8c35
006b8934 : CMP word ptr [ESP + 0x26],0x2
006b893a : JNZ 0x006b8c35
006b8940 : CMP word ptr [ESP + 0x2a],0x14
006b8946 : JNZ 0x006b8c35
006b894c : MOVZX EAX,word ptr [ESP + 0x28]
006b8951 : MOVZX ECX,word ptr [ESP + 0x2e]
006b8956 : LEA EDX,[EAX*0x4 + 0x4]
006b895d : CMP ECX,EDX
006b895f : JNZ 0x006b8c35
006b8965 : MOVZX EDX,word ptr [ESP + 0x2c]
006b896a : IMUL EDX,ECX
006b896d : LEA EAX,[EAX + EAX*0x4]
006b8970 : LEA ECX,[EDX + EAX*0x4]
006b8973 : MOVZX EDX,word ptr [ESP + 0x24]
006b8978 : ADD ECX,EDX
006b897a : CMP ECX,dword ptr [ESP + 0x14]
006b897e : JA 0x006b8c35
006b8984 : LEA EAX,[ESP + 0x10]
006b8988 : PUSH EAX
006b8989 : PUSH 0x28
006b898b : PUSH EDI
006b898c : CALL 0x00688c00
006b8991 : MOV ECX,EAX
006b8993 : MOV EAX,dword ptr [ESP + 0x1c]
006b8997 : ADD ESP,0xc
006b899a : MOV dword ptr [EBX + 0x2cc],ECX
006b89a0 : TEST EAX,EAX
006b89a2 : JNZ 0x006b8c82
006b89a8 : MOVZX EAX,word ptr [ESP + 0x2c]
006b89ad : MOVZX ESI,word ptr [ESP + 0x28]
006b89b2 : LEA EDX,[EAX*0x4 + 0x1d]
006b89b9 : IMUL EDX,ESI
006b89bc : LEA EAX,[EDX + EAX*0x8 + 0x14]
006b89c0 : MOV dword ptr [ECX + 0xc],EAX
006b89c3 : MOV EDX,dword ptr [EBX + 0x2cc]
006b89c9 : MOV EAX,dword ptr [EDX + 0xc]
006b89cc : LEA ECX,[ESP + 0x10]
006b89d0 : PUSH ECX
006b89d1 : PUSH EAX
006b89d2 : PUSH EDI
006b89d3 : CALL 0x00688c00
006b89d8 : MOV EDI,EAX
006b89da : MOV EAX,dword ptr [ESP + 0x1c]
006b89de : ADD ESP,0xc
006b89e1 : TEST EAX,EAX
006b89e3 : JNZ 0x006b8c82
006b89e9 : MOV ECX,dword ptr [EBX + 0x2cc]
006b89ef : MOV dword ptr [ECX + 0x8],EDI
006b89f2 : MOVZX EDX,word ptr [ESP + 0x28]
006b89f7 : MOV dword ptr [EDI],EDX
006b89f9 : MOV dword ptr [EDI + 0x4],0xffffffff
006b8a00 : MOVZX EAX,word ptr [ESP + 0x2c]
006b8a05 : MOV dword ptr [EDI + 0x8],EAX
006b8a08 : LEA EAX,[EDI + 0x14]
006b8a0b : MOV dword ptr [EDI + 0xc],EAX
006b8a0e : MOVZX ECX,word ptr [ESP + 0x28]
006b8a13 : LEA ECX,[ECX + ECX*0x2]
006b8a16 : LEA EAX,[EAX + ECX*0x8]
006b8a19 : MOV dword ptr [EDI + 0x10],EAX
006b8a1c : MOVZX EDX,word ptr [ESP + 0x2c]
006b8a21 : XOR ECX,ECX
006b8a23 : LEA EAX,[EAX + EDX*0x8]
006b8a26 : TEST EDX,EDX
006b8a28 : JLE 0x006b8a48
006b8a2a : LEA EBX,[EBX]
006b8a30 : MOV EDX,dword ptr [EDI + 0x10]
006b8a33 : MOV dword ptr [EDX + ECX*0x8],EAX
006b8a36 : MOVZX EDX,word ptr [ESP + 0x28]
006b8a3b : LEA EAX,[EAX + EDX*0x4]
006b8a3e : MOVZX EDX,word ptr [ESP + 0x2c]
006b8a43 : INC ECX
006b8a44 : CMP ECX,EDX
006b8a46 : JL 0x006b8a30
006b8a48 : XOR EDX,EDX
006b8a4a : XOR ECX,ECX
006b8a4c : CMP DX,word ptr [ESP + 0x28]
006b8a51 : JNC 0x006b8a69
006b8a53 : MOV ESI,dword ptr [EDI + 0xc]
006b8a56 : MOV dword ptr [EDX + ESI*0x1],EAX
006b8a59 : MOVZX ESI,word ptr [ESP + 0x28]
006b8a5e : INC ECX
006b8a5f : ADD EAX,0x5
006b8a62 : ADD EDX,0x18
006b8a65 : CMP ECX,ESI
006b8a67 : JL 0x006b8a53
006b8a69 : MOVZX EAX,word ptr [ESP + 0x24]
006b8a6e : ADD EAX,dword ptr [ESP + 0x1c]
006b8a72 : PUSH EAX
006b8a73 : PUSH EBP
006b8a74 : CALL 0x006877c0
006b8a79 : ADD ESP,0x8
006b8a7c : MOV dword ptr [ESP + 0x10],EAX
006b8a80 : TEST EAX,EAX
006b8a82 : JNZ 0x006b8c82
006b8a88 : MOV ESI,dword ptr [EDI + 0xc]
006b8a8b : XOR ECX,ECX
006b8a8d : XOR EBX,EBX
006b8a8f : CMP CX,word ptr [ESP + 0x28]
006b8a94 : JNC 0x006b8b0f
006b8a96 : LEA EDX,[ESP + 0x30]
006b8a9a : PUSH EDX
006b8a9b : PUSH 0xbebc3c
006b8aa0 : PUSH EBP
006b8aa1 : CALL 0x006889e0
006b8aa6 : ADD ESP,0xc
006b8aa9 : MOV dword ptr [ESP + 0x10],EAX
006b8aad : TEST EAX,EAX
006b8aaf : JNZ 0x006b8c82
006b8ab5 : MOV ECX,dword ptr [ESP + 0x34]
006b8ab9 : MOV EDX,dword ptr [ESP + 0x38]
006b8abd : MOV EAX,dword ptr [ESP + 0x30]
006b8ac1 : MOV dword ptr [ESI + 0x4],ECX
006b8ac4 : MOV ECX,dword ptr [ESP + 0x3c]
006b8ac8 : MOV dword ptr [ESI + 0x8],EDX
006b8acb : MOVZX EDX,word ptr [ESP + 0x42]
006b8ad0 : MOV dword ptr [ESI + 0x10],EAX
006b8ad3 : MOV dword ptr [ESI + 0xc],ECX
006b8ad6 : MOV ECX,dword ptr [ESI]
006b8ad8 : MOV dword ptr [ESI + 0x14],EDX
006b8adb : SHR EAX,0x18
006b8ade : MOV byte ptr [ECX],AL
006b8ae0 : MOV EDX,dword ptr [ESI]
006b8ae2 : MOV AL,byte ptr [ESI + 0x12]
006b8ae5 : MOV byte ptr [EDX + 0x1],AL
006b8ae8 : MOV ECX,dword ptr [ESI]
006b8aea : MOV DL,byte ptr [ESI + 0x11]
006b8aed : MOV byte ptr [ECX + 0x2],DL
006b8af0 : MOV EAX,dword ptr [ESI]
006b8af2 : MOV CL,byte ptr [ESI + 0x10]
006b8af5 : MOV byte ptr [EAX + 0x3],CL
006b8af8 : MOV EDX,dword ptr [ESI]
006b8afa : MOV byte ptr [EDX + 0x4],0x0
006b8afe : MOVZX EAX,word ptr [ESP + 0x28]
006b8b03 : INC EBX
006b8b04 : ADD ESI,0x18
006b8b07 : CMP EBX,EAX
006b8b09 : JL 0x006b8a96
006b8b0b : MOV EAX,dword ptr [ESP + 0x10]
006b8b0f : MOV EDI,dword ptr [EDI + 0x10]
006b8b12 : XOR ECX,ECX
006b8b14 : XOR EBX,EBX
006b8b16 : CMP CX,word ptr [ESP + 0x2c]
006b8b1b : JNC 0x006b8b94
006b8b1d : LEA ECX,[ECX]
006b8b20 : MOVZX EDX,word ptr [ESP + 0x28]
006b8b25 : LEA EAX,[EDX*0x4 + 0x4]
006b8b2c : PUSH EAX
006b8b2d : PUSH EBP
006b8b2e : CALL 0x00688900
006b8b33 : ADD ESP,0x8
006b8b36 : MOV dword ptr [ESP + 0x10],EAX
006b8b3a : TEST EAX,EAX
006b8b3c : JNZ 0x006b8c82
006b8b42 : PUSH EBP
006b8b43 : CALL 0x00687940
006b8b48 : MOVZX ECX,AX
006b8b4b : PUSH EBP
006b8b4c : MOV dword ptr [EDI + 0x4],ECX
006b8b4f : CALL 0x00687940
006b8b54 : XOR EDX,EDX
006b8b56 : ADD ESP,0x8
006b8b59 : XOR ESI,ESI
006b8b5b : CMP DX,word ptr [ESP + 0x28]
006b8b60 : JNC 0x006b8b7a
006b8b62 : PUSH EBP
006b8b63 : CALL 0x006879a0
006b8b68 : MOV ECX,dword ptr [EDI]
006b8b6a : MOV dword ptr [ECX + ESI*0x4],EAX
006b8b6d : MOVZX EDX,word ptr [ESP + 0x2c]
006b8b72 : INC ESI
006b8b73 : ADD ESP,0x4
006b8b76 : CMP ESI,EDX
006b8b78 : JL 0x006b8b62
006b8b7a : PUSH EBP
006b8b7b : CALL 0x006889b0
006b8b80 : MOVZX EAX,word ptr [ESP + 0x30]
006b8b85 : INC EBX
006b8b86 : ADD ESP,0x4
006b8b89 : ADD EDI,0x8
006b8b8c : CMP EBX,EAX
006b8b8e : JL 0x006b8b20
006b8b90 : MOV EAX,dword ptr [ESP + 0x10]
006b8b94 : MOV EBX,dword ptr [ESP + 0x48]
006b8b98 : MOV EDI,dword ptr [ESP + 0x18]
006b8b9c : MOV EBP,dword ptr [ESP + 0x4c]
006b8ba0 : TEST EBP,EBP
006b8ba2 : JZ 0x006b8c82
006b8ba8 : MOV EDX,dword ptr [EBX + 0x2cc]
006b8bae : MOV EAX,dword ptr [EDX + 0xc]
006b8bb1 : LEA ECX,[ESP + 0x10]
006b8bb5 : PUSH ECX
006b8bb6 : PUSH EAX
006b8bb7 : PUSH EDI
006b8bb8 : CALL 0x00688c00
006b8bbd : MOV ESI,EAX
006b8bbf : MOV EAX,dword ptr [ESP + 0x1c]
006b8bc3 : ADD ESP,0xc
006b8bc6 : TEST EAX,EAX
006b8bc8 : JNZ 0x006b8c82
006b8bce : MOV EAX,dword ptr [EBX + 0x2cc]
006b8bd4 : MOV ECX,dword ptr [EAX + 0xc]
006b8bd7 : MOV EDX,dword ptr [EAX + 0x8]
006b8bda : PUSH ECX
006b8bdb : PUSH EDX
006b8bdc : PUSH ESI
006b8bdd : CALL 0x0063ae40
006b8be2 : MOV ECX,dword ptr [ESI]
006b8be4 : MOV EDX,dword ptr [ESI + 0x8]
006b8be7 : LEA EAX,[ESI + 0x14]
006b8bea : LEA ECX,[ECX + ECX*0x2]
006b8bed : MOV dword ptr [ESI + 0xc],EAX
006b8bf0 : LEA EAX,[EAX + ECX*0x8]
006b8bf3 : MOV dword ptr [ESI + 0x10],EAX
006b8bf6 : LEA ECX,[EAX + EDX*0x8]
006b8bf9 : ADD ESP,0xc
006b8bfc : XOR EAX,EAX
006b8bfe : TEST EDX,EDX
006b8c00 : JBE 0x006b8c13
006b8c02 : MOV EDX,dword ptr [ESI + 0x10]
006b8c05 : MOV dword ptr [EDX + EAX*0x8],ECX
006b8c08 : MOV EDX,dword ptr [ESI]
006b8c0a : INC EAX
006b8c0b : LEA ECX,[ECX + EDX*0x4]
006b8c0e : CMP EAX,dword ptr [ESI + 0x8]
006b8c11 : JC 0x006b8c02
006b8c13 : MOV EAX,dword ptr [ESI + 0xc]
006b8c16 : XOR EDI,EDI
006b8c18 : CMP dword ptr [ESI],EDI
006b8c1a : JBE 0x006b8c7b
006b8c1c : LEA ESP,[ESP]
006b8c20 : MOV EDX,dword ptr [EAX + 0x10]
006b8c23 : MOV dword ptr [EAX],ECX
006b8c25 : CMP EDX,0x77676874
006b8c2b : JNZ 0x006b8c42
006b8c2d : MOV dword ptr [EAX],0xbe87fc
006b8c33 : JMP 0x006b8c70
006b8c35 : POP EDI
006b8c36 : POP ESI
006b8c37 : POP EBP
006b8c38 : MOV EAX,0x8
006b8c3d : POP EBX
006b8c3e : ADD ESP,0x34
006b8c41 : RET
006b8c42 : CMP EDX,0x77647468
006b8c48 : JNZ 0x006b8c52
006b8c4a : MOV dword ptr [EAX],0xbeb870
006b8c50 : JMP 0x006b8c70
006b8c52 : CMP EDX,0x6f70737a
006b8c58 : JNZ 0x006b8c62
006b8c5a : MOV dword ptr [EAX],0xbeb864
006b8c60 : JMP 0x006b8c70
006b8c62 : CMP EDX,0x736c6e74
006b8c68 : JNZ 0x006b8c70
006b8c6a : MOV dword ptr [EAX],0xbebc5c
006b8c70 : INC EDI
006b8c71 : ADD ECX,0x5
006b8c74 : ADD EAX,0x18
006b8c77 : CMP EDI,dword ptr [ESI]
006b8c79 : JC 0x006b8c20
006b8c7b : MOV EAX,dword ptr [ESP + 0x10]
006b8c7f : MOV dword ptr [EBP],ESI
006b8c82 : POP EDI
006b8c83 : POP ESI
006b8c84 : POP EBP
006b8c85 : POP EBX
006b8c86 : ADD ESP,0x34
006b8c89 : RET

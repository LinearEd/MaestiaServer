PROGRAM  : Maestia.exe
FUNCTION : FUN_007d68b0
ENTRY    : 007d68b0
BODY     : [[007d68b0, 007d6a84]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007d68b0(undefined4 param_1,undefined4 param_2,int param_3)

{
  int *piVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  uint uVar4;
  int iVar5;
  int in_ECX;
  int *piVar6;
  undefined1 *puVar7;
  int *piStack_34;
  int *piStack_30;
  undefined1 auStack_28 [8];
  undefined1 auStack_20 [12];
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_00b1a283;
  local_14 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xffffffc0;
  ExceptionList = &local_14;
  *(undefined1 *)(in_ECX + 0x254) = 0;
  if (*(char *)(in_ECX + 0x259) != '\0') {
    if (*(char *)(in_ECX + 0x25a) != '\0') {
      if (param_3 == 2) {
        param_3 = FUN_007f2d40(uVar4);
      }
      if (param_3 == 0) {
        ExceptionList = local_14;
        return;
      }
    }
    if (*(int **)(in_ECX + 0x28c) != (int *)0x0) {
      (**(code **)(**(int **)(in_ECX + 0x28c) + 8))();
      if (*(int **)(in_ECX + 0x288) != (int *)0x0) {
        (**(code **)(**(int **)(in_ECX + 0x288) + 8))();
      }
      *(undefined1 *)(in_ECX + 0x254) = 1;
    }
    if (*(int *)(in_ECX + 8) != 0) {
      EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
    }
    uStack_c = 0;
    piStack_30 = *(int **)(in_ECX + 0x188);
    piVar6 = (int *)*piStack_30;
    if (piVar6 != piStack_30) {
      do {
        piVar1 = (int *)piVar6[9];
        piStack_34 = piVar1;
        if (((piVar1 != (int *)0x0) && (*(char *)((int)piVar1 + 0x71) != '\0')) &&
           ((iVar5 = (**(code **)(*piVar1 + 4))(), iVar5 < 8 || ((10 < iVar5 && (iVar5 != 0x12))))))
        {
          (**(code **)(*piVar1 + 4))();
          if (*(char *)(in_ECX + 0x25a) == '\0') {
            puVar7 = auStack_28;
          }
          else {
            iVar5 = param_3;
            if (param_3 == 2) {
              (**(code **)(*piVar1 + 0x2c))();
              iVar5 = FUN_007f2d40();
            }
            if (iVar5 == 0) goto LAB_007d69ed;
            puVar7 = auStack_20;
          }
          FUN_0045fe50(puVar7,&piStack_34);
        }
LAB_007d69ed:
        piVar6 = (int *)*piVar6;
      } while (piVar6 != piStack_30);
    }
    uStack_c = 0xffffffff;
    if (*(int *)(in_ECX + 8) != 0) {
      LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
    }
    if (*(int *)(in_ECX + 8) != 0) {
      EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
    }
    uStack_c = 1;
    puVar2 = *(undefined4 **)(in_ECX + 0x38);
    for (puVar3 = (undefined4 *)*puVar2; puVar3 != puVar2; puVar3 = (undefined4 *)*puVar3) {
      if ((int *)puVar3[9] != (int *)0x0) {
        (**(code **)(*(int *)puVar3[9] + 0x88))(param_1,param_2,param_3);
      }
    }
    uStack_c = 0xffffffff;
    if (*(int *)(in_ECX + 8) != 0) {
      LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
    }
  }
  ExceptionList = local_14;
  return;
}



============================================================
DISASSEMBLY
============================================================
007d68b0 : PUSH EBP
007d68b1 : MOV EBP,ESP
007d68b3 : AND ESP,0xfffffff8
007d68b6 : PUSH -0x1
007d68b8 : PUSH 0xb1a283
007d68bd : MOV EAX,FS:[0x0]
007d68c3 : PUSH EAX
007d68c4 : SUB ESP,0x20
007d68c7 : PUSH EBX
007d68c8 : PUSH ESI
007d68c9 : PUSH EDI
007d68ca : MOV EAX,[0x00d66fa0]
007d68cf : XOR EAX,ESP
007d68d1 : PUSH EAX
007d68d2 : LEA EAX,[ESP + 0x30]
007d68d6 : MOV FS:[0x0],EAX
007d68dc : MOV EDI,ECX
007d68de : CMP byte ptr [EDI + 0x259],0x0
007d68e5 : MOV byte ptr [EDI + 0x254],0x0
007d68ec : JZ 0x007d6a70
007d68f2 : MOV AL,byte ptr [EDI + 0x25a]
007d68f8 : TEST AL,AL
007d68fa : JZ 0x007d691d
007d68fc : CMP dword ptr [EBP + 0x10],0x2
007d6900 : JNZ 0x007d6913
007d6902 : MOV EDX,dword ptr [EBP + 0x8]
007d6905 : LEA EAX,[EDI + 0x1ac]
007d690b : CALL 0x007f2d40
007d6910 : MOV dword ptr [EBP + 0x10],EAX
007d6913 : CMP dword ptr [EBP + 0x10],0x0
007d6917 : JZ 0x007d6a70
007d691d : MOV ECX,dword ptr [EDI + 0x28c]
007d6923 : TEST ECX,ECX
007d6925 : JZ 0x007d6946
007d6927 : MOV EAX,dword ptr [ECX]
007d6929 : MOV EDX,dword ptr [EAX + 0x8]
007d692c : CALL EDX
007d692e : MOV ECX,dword ptr [EDI + 0x288]
007d6934 : TEST ECX,ECX
007d6936 : JZ 0x007d693f
007d6938 : MOV EAX,dword ptr [ECX]
007d693a : MOV EDX,dword ptr [EAX + 0x8]
007d693d : CALL EDX
007d693f : MOV byte ptr [EDI + 0x254],0x1
007d6946 : MOV EAX,dword ptr [EDI + 0x8]
007d6949 : MOV dword ptr [ESP + 0x18],EDI
007d694d : TEST EAX,EAX
007d694f : JZ 0x007d695b
007d6951 : ADD EAX,0x4
007d6954 : PUSH EAX
007d6955 : CALL dword ptr [0x00b85118]
007d695b : MOV dword ptr [ESP + 0x38],0x0
007d6963 : MOV EAX,dword ptr [EDI + 0x188]
007d6969 : MOV EBX,dword ptr [EAX]
007d696b : MOV dword ptr [ESP + 0x14],EAX
007d696f : CMP EBX,EAX
007d6971 : JZ 0x007d69f5
007d6977 : MOV ESI,dword ptr [EBX + 0x24]
007d697a : MOV dword ptr [ESP + 0x10],ESI
007d697e : TEST ESI,ESI
007d6980 : JZ 0x007d69ed
007d6982 : CMP byte ptr [ESI + 0x71],0x0
007d6986 : JZ 0x007d69ed
007d6988 : MOV EAX,dword ptr [ESI]
007d698a : MOV EDX,dword ptr [EAX + 0x4]
007d698d : MOV ECX,ESI
007d698f : CALL EDX
007d6991 : CMP EAX,0x8
007d6994 : JL 0x007d69a0
007d6996 : CMP EAX,0xa
007d6999 : JLE 0x007d69ed
007d699b : CMP EAX,0x12
007d699e : JZ 0x007d69ed
007d69a0 : MOV EAX,dword ptr [ESI]
007d69a2 : MOV EDX,dword ptr [EAX + 0x4]
007d69a5 : MOV ECX,ESI
007d69a7 : CALL EDX
007d69a9 : CMP byte ptr [EDI + 0x25a],0x0
007d69b0 : MOV EAX,dword ptr [EBP + 0x10]
007d69b3 : JNZ 0x007d69c1
007d69b5 : LEA EAX,[ESP + 0x10]
007d69b9 : PUSH EAX
007d69ba : LEA ECX,[ESP + 0x20]
007d69be : PUSH ECX
007d69bf : JMP 0x007d69e5
007d69c1 : CMP EAX,0x2
007d69c4 : JNZ 0x007d69d7
007d69c6 : MOV EDX,dword ptr [ESI]
007d69c8 : MOV EAX,dword ptr [EDX + 0x2c]
007d69cb : MOV ECX,ESI
007d69cd : CALL EAX
007d69cf : MOV EDX,dword ptr [EBP + 0x8]
007d69d2 : CALL 0x007f2d40
007d69d7 : TEST EAX,EAX
007d69d9 : JZ 0x007d69ed
007d69db : LEA ECX,[ESP + 0x10]
007d69df : PUSH ECX
007d69e0 : LEA EDX,[ESP + 0x28]
007d69e4 : PUSH EDX
007d69e5 : MOV EAX,dword ptr [EBP + 0xc]
007d69e8 : CALL 0x0045fe50
007d69ed : MOV EBX,dword ptr [EBX]
007d69ef : CMP EBX,dword ptr [ESP + 0x14]
007d69f3 : JNZ 0x007d6977
007d69f5 : MOV dword ptr [ESP + 0x38],0xffffffff
007d69fd : MOV EAX,dword ptr [EDI + 0x8]
007d6a00 : TEST EAX,EAX
007d6a02 : JZ 0x007d6a0e
007d6a04 : ADD EAX,0x4
007d6a07 : PUSH EAX
007d6a08 : CALL dword ptr [0x00b8511c]
007d6a0e : MOV EAX,dword ptr [EDI + 0x8]
007d6a11 : MOV dword ptr [ESP + 0x18],EDI
007d6a15 : TEST EAX,EAX
007d6a17 : JZ 0x007d6a23
007d6a19 : ADD EAX,0x4
007d6a1c : PUSH EAX
007d6a1d : CALL dword ptr [0x00b85118]
007d6a23 : MOV dword ptr [ESP + 0x38],0x1
007d6a2b : MOV EBX,dword ptr [EDI + 0x38]
007d6a2e : MOV ESI,dword ptr [EBX]
007d6a30 : CMP ESI,EBX
007d6a32 : JZ 0x007d6a57
007d6a34 : MOV ECX,dword ptr [ESI + 0x24]
007d6a37 : TEST ECX,ECX
007d6a39 : JZ 0x007d6a51
007d6a3b : MOV EDX,dword ptr [EBP + 0x10]
007d6a3e : MOV EAX,dword ptr [ECX]
007d6a40 : MOV EAX,dword ptr [EAX + 0x88]
007d6a46 : PUSH EDX
007d6a47 : MOV EDX,dword ptr [EBP + 0xc]
007d6a4a : PUSH EDX
007d6a4b : MOV EDX,dword ptr [EBP + 0x8]
007d6a4e : PUSH EDX
007d6a4f : CALL EAX
007d6a51 : MOV ESI,dword ptr [ESI]
007d6a53 : CMP ESI,EBX
007d6a55 : JNZ 0x007d6a34
007d6a57 : MOV dword ptr [ESP + 0x38],0xffffffff
007d6a5f : MOV EDI,dword ptr [EDI + 0x8]
007d6a62 : TEST EDI,EDI
007d6a64 : JZ 0x007d6a70
007d6a66 : ADD EDI,0x4
007d6a69 : PUSH EDI
007d6a6a : CALL dword ptr [0x00b8511c]
007d6a70 : MOV ECX,dword ptr [ESP + 0x30]
007d6a74 : MOV dword ptr FS:[0x0],ECX
007d6a7b : POP ECX
007d6a7c : POP EDI
007d6a7d : POP ESI
007d6a7e : POP EBX
007d6a7f : MOV ESP,EBP
007d6a81 : POP EBP
007d6a82 : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_00407cc0
ENTRY    : 00407cc0
BODY     : [[00407cc0, 00407d6e]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_00407cc0(short *param_1,uint param_2)

{
  int *piVar1;
  short sVar2;
  uint uVar3;
  int iVar4;
  short *psVar5;
  uint uVar6;
  uint in_ECX;
  int *piVar7;
  short *psVar8;
  int unaff_EDI;
  
  uVar6 = *(uint *)(unaff_EDI + 0x14);
  if (param_2 == 0) {
    if (in_ECX < uVar6) {
      return in_ECX;
    }
  }
  else {
    if (param_2 <= uVar6) {
      uVar3 = uVar6 - param_2;
      if (in_ECX < uVar6 - param_2) {
        uVar3 = in_ECX;
      }
      uVar6 = *(uint *)(unaff_EDI + 0x18);
      piVar1 = (int *)(unaff_EDI + 4);
      piVar7 = piVar1;
      if (7 < uVar6) {
        piVar7 = (int *)*piVar1;
      }
      psVar8 = (short *)((int)piVar7 + uVar3 * 2);
      sVar2 = *param_1;
      while( true ) {
        if ((*psVar8 == sVar2) && (iVar4 = FUN_00405b70(psVar8), iVar4 == 0)) {
          if (uVar6 < 8) {
            return (int)psVar8 - (int)piVar1 >> 1;
          }
          return (int)psVar8 - *piVar1 >> 1;
        }
        psVar5 = (short *)FUN_00404a10();
        if (psVar8 == psVar5) break;
        psVar8 = psVar8 + -1;
      }
    }
    uVar6 = 0xffffffff;
  }
  return uVar6;
}



============================================================
DISASSEMBLY
============================================================
00407cc0 : PUSH EBP
00407cc1 : MOV EBP,ESP
00407cc3 : MOV EDX,dword ptr [EBP + 0xc]
00407cc6 : MOV EAX,dword ptr [EDI + 0x14]
00407cc9 : SUB ESP,0x8
00407ccc : TEST EDX,EDX
00407cce : JNZ 0x00407ce0
00407cd0 : CMP ECX,EAX
00407cd2 : JNC 0x00407d69
00407cd8 : MOV EAX,ECX
00407cda : MOV ESP,EBP
00407cdc : POP EBP
00407cdd : RET 0x8
00407ce0 : PUSH EBX
00407ce1 : PUSH ESI
00407ce2 : CMP EDX,EAX
00407ce4 : JA 0x00407d64
00407cea : SUB EAX,EDX
00407cec : CMP ECX,EAX
00407cee : JNC 0x00407cf2
00407cf0 : MOV EAX,ECX
00407cf2 : MOV ECX,dword ptr [EDI + 0x18]
00407cf5 : MOV dword ptr [EBP + -0x8],ECX
00407cf8 : LEA EBX,[EDI + 0x4]
00407cfb : CMP ECX,0x8
00407cfe : JC 0x00407d04
00407d00 : MOV ECX,dword ptr [EBX]
00407d02 : JMP 0x00407d06
00407d04 : MOV ECX,EBX
00407d06 : LEA ESI,[ECX + EAX*0x2]
00407d09 : MOV EAX,dword ptr [EBP + 0x8]
00407d0c : MOVZX ECX,word ptr [EAX]
00407d0f : MOV dword ptr [EBP + -0x4],ECX
00407d12 : MOV AX,word ptr [EBP + -0x4]
00407d16 : CMP word ptr [ESI],AX
00407d19 : JNZ 0x00407d2b
00407d1b : MOV ECX,dword ptr [EBP + 0x8]
00407d1e : PUSH ESI
00407d1f : CALL 0x00405b70
00407d24 : ADD ESP,0x4
00407d27 : TEST EAX,EAX
00407d29 : JZ 0x00407d3e
00407d2b : MOV ECX,EDI
00407d2d : CALL 0x00404a10
00407d32 : CMP ESI,EAX
00407d34 : JZ 0x00407d64
00407d36 : MOV EDX,dword ptr [EBP + 0xc]
00407d39 : SUB ESI,0x2
00407d3c : JMP 0x00407d12
00407d3e : CMP dword ptr [EBP + -0x8],0x8
00407d42 : JC 0x00407d54
00407d44 : MOV ECX,dword ptr [EBX]
00407d46 : MOV EAX,ESI
00407d48 : SUB EAX,ECX
00407d4a : POP ESI
00407d4b : SAR EAX,0x1
00407d4d : POP EBX
00407d4e : MOV ESP,EBP
00407d50 : POP EBP
00407d51 : RET 0x8
00407d54 : MOV ECX,EBX
00407d56 : MOV EAX,ESI
00407d58 : SUB EAX,ECX
00407d5a : POP ESI
00407d5b : SAR EAX,0x1
00407d5d : POP EBX
00407d5e : MOV ESP,EBP
00407d60 : POP EBP
00407d61 : RET 0x8
00407d64 : POP ESI
00407d65 : OR EAX,0xffffffff
00407d68 : POP EBX
00407d69 : MOV ESP,EBP
00407d6b : POP EBP
00407d6c : RET 0x8

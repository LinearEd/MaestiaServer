PROGRAM  : Maestia.exe
FUNCTION : FUN_005e41f0
ENTRY    : 005e41f0
BODY     : [[005e41f0, 005e431a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005e41f0(undefined4 param_1,undefined4 *param_2,uint param_3)

{
  uint *puVar1;
  int iVar2;
  int *piVar3;
  uint *puVar4;
  GRefCountImpl *this;
  uint uVar5;
  int *in_ECX;
  uint uVar6;
  int iVar7;
  
  piVar3 = (int *)*in_ECX;
  if (piVar3 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar3 * 5) <= piVar3[1] * 4 + 4U) goto LAB_005e422a;
    iVar7 = piVar3[1] * 2 + 2;
  }
  FUN_005e2170(param_1,iVar7);
LAB_005e422a:
  piVar3 = (int *)*in_ECX;
  param_3 = param_3 & piVar3[1];
  *piVar3 = *piVar3 + 1;
  iVar7 = *in_ECX;
  puVar1 = (uint *)(iVar7 + 8 + param_3 * 0x14);
  if (*puVar1 == 0xfffffffe) {
    *puVar1 = 0xffffffff;
    puVar1[2] = *(uint *)*param_2;
    puVar4 = (uint *)param_2[1];
    uVar6 = *puVar4;
    puVar1[3] = uVar6;
    this = (GRefCountImpl *)puVar4[1];
    puVar1[4] = (uint)this;
    if ((uVar6 == 0) && (this != (GRefCountImpl *)0x0)) {
      GRefCountImpl::AddRef(this);
      puVar1[1] = param_3;
      return;
    }
  }
  else {
    uVar6 = param_3;
    do {
      uVar6 = uVar6 + 1 & *(uint *)(iVar7 + 4);
    } while (*(int *)(iVar7 + 8 + uVar6 * 0x14) != -2);
    iVar2 = iVar7 + 8 + uVar6 * 0x14;
    uVar5 = puVar1[1];
    if (uVar5 == param_3) {
      if (iVar2 != 0) {
        FUN_005e1060(puVar1);
      }
      FUN_005de5b0(param_2);
      *puVar1 = uVar6;
      puVar1[1] = param_3;
      return;
    }
    puVar4 = (uint *)(iVar7 + 8 + uVar5 * 0x14);
    for (uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x14); uVar5 != param_3;
        uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x14)) {
      uVar5 = *puVar4;
      puVar4 = (uint *)(iVar7 + 8 + uVar5 * 0x14);
    }
    if (iVar2 != 0) {
      FUN_005e1060(puVar1);
    }
    *puVar4 = uVar6;
    FUN_005de5b0(param_2);
    *puVar1 = 0xffffffff;
  }
  puVar1[1] = param_3;
  return;
}



============================================================
DISASSEMBLY
============================================================
005e41f0 : PUSH ESI
005e41f1 : MOV ESI,ECX
005e41f3 : MOV EAX,dword ptr [ESI]
005e41f5 : PUSH EDI
005e41f6 : TEST EAX,EAX
005e41f8 : JNZ 0x005e4203
005e41fa : MOV EAX,dword ptr [ESP + 0xc]
005e41fe : PUSH 0x8
005e4200 : PUSH EAX
005e4201 : JMP 0x005e4225
005e4203 : MOV ECX,dword ptr [EAX + 0x4]
005e4206 : LEA EDX,[ECX*0x4 + 0x4]
005e420d : MOV ECX,dword ptr [EAX]
005e420f : LEA ECX,[ECX + ECX*0x4]
005e4212 : CMP ECX,EDX
005e4214 : JBE 0x005e422a
005e4216 : MOV EDX,dword ptr [EAX + 0x4]
005e4219 : MOV ECX,dword ptr [ESP + 0xc]
005e421d : LEA EAX,[EDX + EDX*0x1 + 0x2]
005e4221 : PUSH EAX
005e4222 : PUSH ECX
005e4223 : MOV ECX,ESI
005e4225 : CALL 0x005e2170
005e422a : MOV EAX,dword ptr [ESI]
005e422c : MOV EDI,dword ptr [ESP + 0x14]
005e4230 : AND EDI,dword ptr [EAX + 0x4]
005e4233 : INC dword ptr [EAX]
005e4235 : MOV EAX,dword ptr [ESI]
005e4237 : LEA EDX,[EDI + EDI*0x4]
005e423a : LEA ESI,[EAX + EDX*0x4 + 0x8]
005e423e : MOV EDX,0xfffffffe
005e4243 : CMP dword ptr [ESI],EDX
005e4245 : JNZ 0x005e4285
005e4247 : MOV EAX,dword ptr [ESP + 0x10]
005e424b : MOV dword ptr [ESI],0xffffffff
005e4251 : MOV ECX,dword ptr [EAX]
005e4253 : MOV EDX,dword ptr [ECX]
005e4255 : MOV dword ptr [ESI + 0x8],EDX
005e4258 : MOV EAX,dword ptr [EAX + 0x4]
005e425b : MOV ECX,dword ptr [EAX]
005e425d : MOV dword ptr [ESI + 0xc],ECX
005e4260 : MOV EAX,dword ptr [EAX + 0x4]
005e4263 : MOV dword ptr [ESI + 0x10],EAX
005e4266 : TEST ECX,ECX
005e4268 : JNZ 0x005e4313
005e426e : TEST EAX,EAX
005e4270 : JZ 0x005e4313
005e4276 : MOV ECX,EAX
005e4278 : CALL 0x00523dd0
005e427d : MOV dword ptr [ESI + 0x4],EDI
005e4280 : POP EDI
005e4281 : POP ESI
005e4282 : RET 0xc
005e4285 : MOV ECX,dword ptr [EAX + 0x4]
005e4288 : PUSH EBX
005e4289 : MOV EBX,EDI
005e428b : PUSH EBP
005e428c : LEA ESP,[ESP]
005e4290 : INC EBX
005e4291 : AND EBX,ECX
005e4293 : LEA EBP,[EBX + EBX*0x4]
005e4296 : CMP dword ptr [EAX + EBP*0x4 + 0x8],EDX
005e429a : JNZ 0x005e4290
005e429c : LEA EDX,[EBX + EBX*0x4]
005e429f : LEA ECX,[EAX + EDX*0x4 + 0x8]
005e42a3 : MOV EDX,dword ptr [ESI + 0x4]
005e42a6 : CMP EDX,EDI
005e42a8 : JNZ 0x005e42cd
005e42aa : TEST ECX,ECX
005e42ac : JZ 0x005e42b4
005e42ae : PUSH ESI
005e42af : CALL 0x005e1060
005e42b4 : MOV EAX,dword ptr [ESP + 0x18]
005e42b8 : PUSH EAX
005e42b9 : LEA ECX,[ESI + 0x8]
005e42bc : CALL 0x005de5b0
005e42c1 : POP EBP
005e42c2 : MOV dword ptr [ESI],EBX
005e42c4 : POP EBX
005e42c5 : MOV dword ptr [ESI + 0x4],EDI
005e42c8 : POP EDI
005e42c9 : POP ESI
005e42ca : RET 0xc
005e42cd : LEA EDX,[EDX + EDX*0x4]
005e42d0 : CMP dword ptr [EAX + EDX*0x4 + 0x8],EDI
005e42d4 : LEA EBP,[EAX + EDX*0x4 + 0x8]
005e42d8 : JZ 0x005e42f1
005e42da : LEA EBX,[EBX]
005e42e0 : MOV EBP,dword ptr [EBP]
005e42e3 : LEA EDX,[EBP + EBP*0x4]
005e42e7 : CMP dword ptr [EAX + EDX*0x4 + 0x8],EDI
005e42eb : LEA EBP,[EAX + EDX*0x4 + 0x8]
005e42ef : JNZ 0x005e42e0
005e42f1 : TEST ECX,ECX
005e42f3 : JZ 0x005e42fb
005e42f5 : PUSH ESI
005e42f6 : CALL 0x005e1060
005e42fb : MOV EAX,dword ptr [ESP + 0x18]
005e42ff : PUSH EAX
005e4300 : LEA ECX,[ESI + 0x8]
005e4303 : MOV dword ptr [EBP],EBX
005e4306 : CALL 0x005de5b0
005e430b : POP EBP
005e430c : MOV dword ptr [ESI],0xffffffff
005e4312 : POP EBX
005e4313 : MOV dword ptr [ESI + 0x4],EDI
005e4316 : POP EDI
005e4317 : POP ESI
005e4318 : RET 0xc

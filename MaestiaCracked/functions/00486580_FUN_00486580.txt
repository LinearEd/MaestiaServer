PROGRAM  : Maestia.exe
FUNCTION : FUN_00486580
ENTRY    : 00486580
BODY     : [[00486580, 00486695]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x004865fd) */
/* WARNING: Removing unreachable block (ram,0x0048662d) */

void FUN_00486580(void)

{
  uint uVar1;
  int unaff_EDI;
  LPCRITICAL_SECTION local_24;
  char *local_20;
  undefined4 local_1c;
  int local_18;
  undefined4 local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b757d8;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_24 = (LPCRITICAL_SECTION)(unaff_EDI + 0x2eef0);
  local_18 = 0;
  local_20 = 
  "d:\\maestiaproject\\maestiasrc\\client\\main\\client\\avalib\\terrain\\AvaPathFinder.inl";
  local_1c = 0x16;
  local_14 = 1;
  FUN_006ef1a0(&local_24);
  local_8 = 0;
  FUN_00476f00(uVar1);
  if (*(int *)(unaff_EDI + 0x24) != *(int *)(unaff_EDI + 0x28)) {
    *(int *)(unaff_EDI + 0x28) = *(int *)(unaff_EDI + 0x24);
  }
  if (*(int *)(unaff_EDI + 0x14) != *(int *)(unaff_EDI + 0x18)) {
    *(int *)(unaff_EDI + 0x18) = *(int *)(unaff_EDI + 0x14);
  }
  FUN_00401c00(*(undefined4 *)(*(int *)(unaff_EDI + 8) + 4));
  *(int *)(*(int *)(unaff_EDI + 8) + 4) = *(int *)(unaff_EDI + 8);
  *(undefined4 *)(unaff_EDI + 0xc) = 0;
  *(undefined4 *)*(undefined4 *)(unaff_EDI + 8) = *(undefined4 *)(unaff_EDI + 8);
  *(int *)(*(int *)(unaff_EDI + 8) + 8) = *(int *)(unaff_EDI + 8);
  *(undefined2 *)(unaff_EDI + 0x2eec0) = 0;
  local_8 = 0xffffffff;
  if (local_18 != 0) {
    LeaveCriticalSection(local_24);
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00486580 : PUSH EBP
00486581 : MOV EBP,ESP
00486583 : PUSH -0x1
00486585 : PUSH 0xb757d8
0048658a : MOV EAX,FS:[0x0]
00486590 : PUSH EAX
00486591 : SUB ESP,0x14
00486594 : PUSH EBX
00486595 : PUSH ESI
00486596 : MOV EAX,[0x00d66fa0]
0048659b : XOR EAX,EBP
0048659d : PUSH EAX
0048659e : LEA EAX,[EBP + -0xc]
004865a1 : MOV FS:[0x0],EAX
004865a7 : LEA ECX,[EBP + -0x20]
004865aa : LEA EAX,[EDI + 0x2eef0]
004865b0 : XOR EBX,EBX
004865b2 : PUSH ECX
004865b3 : MOV dword ptr [EBP + -0x14],EBX
004865b6 : MOV dword ptr [EBP + -0x20],EAX
004865b9 : MOV dword ptr [EBP + -0x1c],0xcd4908
004865c0 : MOV dword ptr [EBP + -0x18],0x16
004865c7 : MOV dword ptr [EBP + -0x10],0x1
004865ce : CALL 0x006ef1a0
004865d3 : MOV dword ptr [EBP + -0x4],EBX
004865d6 : LEA ESI,[EDI + 0x30]
004865d9 : CALL 0x00476f00
004865de : MOV ECX,dword ptr [EDI + 0x28]
004865e1 : MOV ESI,dword ptr [EDI + 0x24]
004865e4 : CMP ESI,ECX
004865e6 : JZ 0x0048660e
004865e8 : MOV EAX,ECX
004865ea : SUB EAX,ECX
004865ec : SAR EAX,0x2
004865ef : LEA EDX,[EAX*0x4 + 0x0]
004865f6 : LEA EBX,[EDX + ESI*0x1]
004865f9 : TEST EAX,EAX
004865fb : JLE 0x00486609
004865fd : PUSH EDX
004865fe : PUSH ECX
004865ff : PUSH EDX
00486600 : PUSH ESI
00486601 : CALL 0x00634101
00486606 : ADD ESP,0x10
00486609 : MOV dword ptr [EDI + 0x28],EBX
0048660c : XOR EBX,EBX
0048660e : MOV ECX,dword ptr [EDI + 0x18]
00486611 : MOV ESI,dword ptr [EDI + 0x14]
00486614 : CMP ESI,ECX
00486616 : JZ 0x0048663e
00486618 : MOV EAX,ECX
0048661a : SUB EAX,ECX
0048661c : SAR EAX,0x2
0048661f : LEA EDX,[EAX*0x4 + 0x0]
00486626 : LEA EBX,[EDX + ESI*0x1]
00486629 : TEST EAX,EAX
0048662b : JLE 0x00486639
0048662d : PUSH EDX
0048662e : PUSH ECX
0048662f : PUSH EDX
00486630 : PUSH ESI
00486631 : CALL 0x00634101
00486636 : ADD ESP,0x10
00486639 : MOV dword ptr [EDI + 0x18],EBX
0048663c : XOR EBX,EBX
0048663e : MOV EDX,dword ptr [EDI + 0x8]
00486641 : MOV EAX,dword ptr [EDX + 0x4]
00486644 : LEA ESI,[EDI + 0x4]
00486647 : PUSH EAX
00486648 : MOV ECX,ESI
0048664a : CALL 0x00401c00
0048664f : MOV EAX,dword ptr [ESI + 0x4]
00486652 : MOV dword ptr [EAX + 0x4],EAX
00486655 : MOV EAX,dword ptr [ESI + 0x4]
00486658 : MOV dword ptr [ESI + 0x8],EBX
0048665b : MOV dword ptr [EAX],EAX
0048665d : MOV ESI,dword ptr [ESI + 0x4]
00486660 : MOV dword ptr [ESI + 0x8],ESI
00486663 : XOR ECX,ECX
00486665 : MOV word ptr [EDI + 0x2eec0],CX
0048666c : MOV dword ptr [EBP + -0x4],0xffffffff
00486673 : CMP dword ptr [EBP + -0x14],EBX
00486676 : JZ 0x00486685
00486678 : MOV EDX,dword ptr [EBP + -0x20]
0048667b : PUSH EDX
0048667c : CALL dword ptr [0x00b8511c]
00486682 : MOV dword ptr [EBP + -0x14],EBX
00486685 : MOV ECX,dword ptr [EBP + -0xc]
00486688 : MOV dword ptr FS:[0x0],ECX
0048668f : POP ECX
00486690 : POP ESI
00486691 : POP EBX
00486692 : MOV ESP,EBP
00486694 : POP EBP
00486695 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_008fa700
ENTRY    : 008fa700
BODY     : [[008fa700, 008faa80]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008fa700(int param_1,int *param_2,int param_3,undefined4 param_4)

{
  char cVar1;
  int iVar2;
  int ****in_ECX;
  undefined1 auStack_100 [4];
  undefined4 uStack_fc;
  int *piStack_f8;
  char *pcStack_f4;
  char *pcStack_f0;
  int ***pppiStack_ec;
  int **ppiStack_e8;
  uint uStack_e4;
  int *local_9c;
  int *local_98;
  int local_94;
  int local_90;
  undefined1 *local_8c;
  int *local_88;
  undefined1 local_84 [28];
  undefined1 local_68 [28];
  undefined1 local_4c [4];
  int ***local_48 [5];
  uint local_34;
  undefined1 local_30 [4];
  int ***local_2c [5];
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  iVar2 = DAT_00d7c54c;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b66a9a;
  local_10 = ExceptionList;
  uStack_e4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  ppiStack_e8 = &local_88;
  local_88 = param_2;
  local_90 = param_1;
  pppiStack_ec = (int ***)0x8fa75d;
  local_14 = uStack_e4;
  FUN_004437f0();
  if (((local_8c != *(undefined1 **)(iVar2 + 0x44)) && (*(int *)(local_8c + 0x10) != 0)) &&
     (*(undefined4 *)(param_1 + 0x20) = 2, in_ECX != (int ****)0x0)) {
    ppiStack_e8 = (int **)0x8fa791;
    cVar1 = (*(code *)(*in_ECX)[0xc])();
    if (cVar1 == '\0') {
      ppiStack_e8 = &local_9c;
      pcStack_f0 = (char *)0x8fa7a6;
      pppiStack_ec = (int ***)in_ECX;
      FUN_0040e750();
      local_8 = 0;
      if (local_94 == 0) {
        ppiStack_e8 = (int **)&param_3;
        pppiStack_ec = (int ***)param_1;
        pcStack_f0 = (char *)0x8faa4d;
        FUN_008fa3b0();
      }
      else {
        local_88 = (int *)*local_98;
        if (local_88 != local_98) {
          do {
            iVar2 = local_88[3];
            if (iVar2 == 0x26) {
              ppiStack_e8 = (int **)0x700;
              pppiStack_ec = (int ***)0x8fa7ee;
              iVar2 = FUN_00703c00();
              if (iVar2 != 0) {
                ppiStack_e8 = (int **)&DAT_00c617dc;
                pppiStack_ec = (int ***)0x8fa808;
                FUN_00406460();
                local_8._0_1_ = 1;
                pppiStack_ec = (int ***)0x8fa817;
                ppiStack_e8 = (int **)iVar2;
                FUN_008fa350();
                ppiStack_e8 = (int **)param_4;
                pppiStack_ec = (int ***)0x2;
                pcStack_f4 = (char *)0x8fa82e;
                pcStack_f0 = local_84;
                FUN_008f9b20();
                ppiStack_e8 = (int **)&DAT_00c61878;
                pppiStack_ec = (int ***)0x8fa83b;
                FUN_00406460();
                local_8._0_1_ = 2;
                ppiStack_e8 = (int **)0x8fa854;
                FUN_00a23120();
                local_8c = auStack_100;
                FUN_00405660(local_30);
                local_8._0_1_ = 2;
                pcStack_f0 = (char *)FUN_008f75f0();
                local_8._0_1_ = 4;
                ppiStack_e8 = (int **)0xffffffff;
                pppiStack_ec = (int ***)0x0;
                pcStack_f4 = (char *)0x8fa88d;
                FUN_00405eb0();
                local_8 = CONCAT31(local_8._1_3_,2);
                ppiStack_e8 = (int **)0x8fa89c;
                FUN_00406560();
                iVar2 = *DAT_00da9894;
                if ((iVar2 != 0) && (*(int *)(iVar2 + 0x114) != 0)) {
                  piStack_f8 = *(int **)(iVar2 + 0x114);
                  pppiStack_ec = local_2c[0];
                  if (local_18 < 8) {
                    pppiStack_ec = (int ***)local_2c;
                  }
                  ppiStack_e8 = (int **)param_3;
                  pcStack_f0 = "%ls,%d";
                  pcStack_f4 = "SetTooltipIcon";
                  uStack_fc = 0x8fa8da;
                  (**(code **)(*piStack_f8 + 4))();
                }
                param_3 = param_3 + 1;
                local_8._0_1_ = 1;
                ppiStack_e8 = (int **)0x8fa8ec;
                FUN_00406560();
LAB_008faa1c:
                local_8 = (uint)local_8._1_3_ << 8;
                ppiStack_e8 = (int **)0x8faa21;
                FUN_00406560();
              }
            }
            else if ((iVar2 == 0x27) || (iVar2 == 0x28)) {
              ppiStack_e8 = (int **)0x700;
              pppiStack_ec = (int ***)0x8fa918;
              iVar2 = FUN_00703c00();
              if (iVar2 != 0) {
                ppiStack_e8 = (int **)&DAT_00c61894;
                pppiStack_ec = (int ***)0x8fa932;
                FUN_00406460();
                local_8._0_1_ = 5;
                pppiStack_ec = (int ***)0x8fa941;
                ppiStack_e8 = (int **)iVar2;
                FUN_008fa350();
                ppiStack_e8 = (int **)param_4;
                pppiStack_ec = (int ***)0x2;
                pcStack_f4 = (char *)0x8fa958;
                pcStack_f0 = local_68;
                FUN_008f9b20();
                ppiStack_e8 = (int **)&DAT_00c61898;
                pppiStack_ec = (int ***)0x8fa965;
                FUN_00406460();
                local_8._0_1_ = 6;
                ppiStack_e8 = (int **)0x8fa97e;
                FUN_00a23120();
                local_8c = auStack_100;
                FUN_00405660(local_4c);
                local_8._0_1_ = 6;
                pcStack_f0 = (char *)FUN_008f75f0();
                local_8._0_1_ = 8;
                ppiStack_e8 = (int **)0xffffffff;
                pppiStack_ec = (int ***)0x0;
                pcStack_f4 = (char *)0x8fa9b7;
                FUN_00405eb0();
                local_8 = CONCAT31(local_8._1_3_,6);
                ppiStack_e8 = (int **)0x8fa9c6;
                FUN_00406560();
                iVar2 = *DAT_00da9894;
                if ((iVar2 != 0) && (*(int *)(iVar2 + 0x114) != 0)) {
                  piStack_f8 = *(int **)(iVar2 + 0x114);
                  pppiStack_ec = local_48[0];
                  if (local_34 < 8) {
                    pppiStack_ec = (int ***)local_48;
                  }
                  ppiStack_e8 = (int **)param_3;
                  pcStack_f0 = "%ls,%d";
                  pcStack_f4 = "SetTooltipIcon";
                  uStack_fc = 0x8faa03;
                  (**(code **)(*piStack_f8 + 4))();
                }
                param_3 = param_3 + 1;
                local_8._0_1_ = 5;
                ppiStack_e8 = (int **)0x8faa15;
                FUN_00406560();
                goto LAB_008faa1c;
              }
            }
            ppiStack_e8 = (int **)0x8faa2c;
            FUN_00416210();
          } while (local_88 != local_98);
        }
      }
      local_8 = 0xffffffff;
      ppiStack_e8 = &local_9c;
      pppiStack_ec = (int ***)0x8faa60;
      FUN_0040f3f0();
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008fa700 : PUSH EBP
008fa701 : MOV EBP,ESP
008fa703 : PUSH -0x1
008fa705 : PUSH 0xb66a9a
008fa70a : MOV EAX,FS:[0x0]
008fa710 : PUSH EAX
008fa711 : SUB ESP,0xc4
008fa717 : MOV EAX,[0x00d66fa0]
008fa71c : XOR EAX,EBP
008fa71e : MOV dword ptr [EBP + -0x10],EAX
008fa721 : PUSH EBX
008fa722 : PUSH ESI
008fa723 : PUSH EDI
008fa724 : PUSH EAX
008fa725 : LEA EAX,[EBP + -0xc]
008fa728 : MOV FS:[0x0],EAX
008fa72e : MOV EAX,dword ptr [EBP + 0xc]
008fa731 : MOV ESI,dword ptr [0x00d7c54c]
008fa737 : MOV EBX,dword ptr [EBP + 0x8]
008fa73a : MOV EDI,ECX
008fa73c : LEA ECX,[EBP + 0xffffff7c]
008fa742 : MOV dword ptr [EBP + 0xffffff7c],EAX
008fa748 : PUSH ECX
008fa749 : LEA ECX,[ESI + 0x40]
008fa74c : LEA EAX,[EBP + 0xffffff78]
008fa752 : MOV dword ptr [EBP + 0xffffff74],EBX
008fa758 : CALL 0x004437f0
008fa75d : MOV ESI,dword ptr [ESI + 0x44]
008fa760 : MOV EAX,dword ptr [EBP + 0xffffff78]
008fa766 : CMP EAX,ESI
008fa768 : JZ 0x008faa60
008fa76e : MOV EAX,dword ptr [EAX + 0x10]
008fa771 : TEST EAX,EAX
008fa773 : JZ 0x008faa60
008fa779 : MOV dword ptr [EBX + 0x20],0x2
008fa780 : TEST EDI,EDI
008fa782 : JZ 0x008faa60
008fa788 : MOV EDX,dword ptr [EDI]
008fa78a : MOV EAX,dword ptr [EDX + 0x30]
008fa78d : MOV ECX,EDI
008fa78f : CALL EAX
008fa791 : TEST AL,AL
008fa793 : JNZ 0x008faa60
008fa799 : LEA ECX,[EBP + 0xffffff68]
008fa79f : PUSH ECX
008fa7a0 : PUSH EDI
008fa7a1 : CALL 0x0040e750
008fa7a6 : MOV dword ptr [EBP + -0x4],0x0
008fa7ad : CMP dword ptr [EBP + 0xffffff70],0x0
008fa7b4 : JZ 0x008faa40
008fa7ba : MOV ECX,dword ptr [EBP + 0xffffff6c]
008fa7c0 : MOV EAX,dword ptr [ECX]
008fa7c2 : MOV dword ptr [EBP + 0xffffff7c],EAX
008fa7c8 : CMP EAX,ECX
008fa7ca : JZ 0x008faa4d
008fa7d0 : MOV ECX,dword ptr [EAX + 0xc]
008fa7d3 : CMP ECX,0x26
008fa7d6 : JNZ 0x008fa8f8
008fa7dc : MOVZX EDI,word ptr [EAX + 0x12]
008fa7e0 : MOVZX ESI,word ptr [EAX + 0x10]
008fa7e4 : PUSH 0x700
008fa7e9 : CALL 0x00703c00
008fa7ee : MOV EBX,EAX
008fa7f0 : ADD ESP,0x4
008fa7f3 : TEST EBX,EBX
008fa7f5 : JZ 0x008faa21
008fa7fb : PUSH 0xc617dc
008fa800 : LEA ECX,[EBP + -0x80]
008fa803 : CALL 0x00406460
008fa808 : MOV byte ptr [EBP + -0x4],0x1
008fa80c : PUSH EBX
008fa80d : MOV EAX,ESI
008fa80f : LEA EDI,[EBP + -0x80]
008fa812 : CALL 0x008fa350
008fa817 : MOV EDX,dword ptr [EBP + 0x14]
008fa81a : MOV ECX,dword ptr [EBP + 0x10]
008fa81d : MOV ESI,dword ptr [EBP + 0xffffff74]
008fa823 : PUSH EDX
008fa824 : PUSH 0x2
008fa826 : MOV EAX,EDI
008fa828 : PUSH EAX
008fa829 : CALL 0x008f9b20
008fa82e : PUSH 0xc61878
008fa833 : LEA ECX,[EBP + -0x2c]
008fa836 : CALL 0x00406460
008fa83b : MOV byte ptr [EBP + -0x4],0x2
008fa83f : MOVZX ECX,word ptr [EBX + 0x4]
008fa843 : MOVZX EDX,word ptr [EBX + 0x6]
008fa847 : SHL ECX,0x10
008fa84a : OR ECX,EDX
008fa84c : LEA EDI,[EBP + -0x2c]
008fa84f : CALL 0x00a23120
008fa854 : SUB ESP,0x1c
008fa857 : MOV EAX,EDI
008fa859 : MOV ECX,ESP
008fa85b : MOV dword ptr [EBP + 0xffffff78],ESP
008fa861 : PUSH EAX
008fa862 : CALL 0x00405660
008fa867 : MOV byte ptr [EBP + -0x4],0x3
008fa86b : MOV byte ptr [EBP + -0x4],0x2
008fa86f : LEA ECX,[EBP + 0xffffff4c]
008fa875 : CALL 0x008f75f0
008fa87a : ADD ESP,0x1c
008fa87d : MOV byte ptr [EBP + -0x4],0x4
008fa881 : PUSH -0x1
008fa883 : PUSH 0x0
008fa885 : PUSH EAX
008fa886 : MOV ECX,EDI
008fa888 : CALL 0x00405eb0
008fa88d : MOV byte ptr [EBP + -0x4],0x2
008fa891 : LEA ECX,[EBP + 0xffffff4c]
008fa897 : CALL 0x00406560
008fa89c : MOV ECX,dword ptr [0x00da9894]
008fa8a2 : MOV EAX,dword ptr [ECX]
008fa8a4 : TEST EAX,EAX
008fa8a6 : JZ 0x008fa8dd
008fa8a8 : CMP dword ptr [EAX + 0x114],0x0
008fa8af : JZ 0x008fa8dd
008fa8b1 : CMP dword ptr [EBP + -0x14],0x8
008fa8b5 : MOV EAX,dword ptr [EAX + 0x114]
008fa8bb : MOV ECX,dword ptr [EBP + -0x28]
008fa8be : JNC 0x008fa8c3
008fa8c0 : LEA ECX,[EBP + -0x28]
008fa8c3 : MOV ESI,dword ptr [EBP + 0x10]
008fa8c6 : MOV EDX,dword ptr [EAX]
008fa8c8 : PUSH ESI
008fa8c9 : PUSH ECX
008fa8ca : PUSH 0xc6187c
008fa8cf : PUSH 0xc61884
008fa8d4 : PUSH EAX
008fa8d5 : MOV EAX,dword ptr [EDX + 0x4]
008fa8d8 : CALL EAX
008fa8da : ADD ESP,0x14
008fa8dd : INC dword ptr [EBP + 0x10]
008fa8e0 : MOV byte ptr [EBP + -0x4],0x1
008fa8e4 : LEA ECX,[EBP + -0x2c]
008fa8e7 : CALL 0x00406560
008fa8ec : MOV byte ptr [EBP + -0x4],0x0
008fa8f0 : LEA ECX,[EBP + -0x80]
008fa8f3 : JMP 0x008faa1c
008fa8f8 : CMP ECX,0x27
008fa8fb : JZ 0x008fa906
008fa8fd : CMP ECX,0x28
008fa900 : JNZ 0x008faa21
008fa906 : MOVZX EDI,word ptr [EAX + 0x12]
008fa90a : MOVZX ESI,word ptr [EAX + 0x10]
008fa90e : PUSH 0x700
008fa913 : CALL 0x00703c00
008fa918 : MOV EBX,EAX
008fa91a : ADD ESP,0x4
008fa91d : TEST EBX,EBX
008fa91f : JZ 0x008faa21
008fa925 : PUSH 0xc61894
008fa92a : LEA ECX,[EBP + -0x64]
008fa92d : CALL 0x00406460
008fa932 : MOV byte ptr [EBP + -0x4],0x5
008fa936 : PUSH EBX
008fa937 : MOV EAX,ESI
008fa939 : LEA EDI,[EBP + -0x64]
008fa93c : CALL 0x008fa350
008fa941 : MOV ECX,dword ptr [EBP + 0x14]
008fa944 : MOV ESI,dword ptr [EBP + 0xffffff74]
008fa94a : PUSH ECX
008fa94b : MOV ECX,dword ptr [EBP + 0x10]
008fa94e : PUSH 0x2
008fa950 : MOV EDX,EDI
008fa952 : PUSH EDX
008fa953 : CALL 0x008f9b20
008fa958 : PUSH 0xc61898
008fa95d : LEA ECX,[EBP + -0x48]
008fa960 : CALL 0x00406460
008fa965 : MOV byte ptr [EBP + -0x4],0x6
008fa969 : MOVZX ECX,word ptr [EBX + 0x4]
008fa96d : MOVZX EAX,word ptr [EBX + 0x6]
008fa971 : SHL ECX,0x10
008fa974 : OR ECX,EAX
008fa976 : LEA EDI,[EBP + -0x48]
008fa979 : CALL 0x00a23120
008fa97e : SUB ESP,0x1c
008fa981 : MOV EDX,EDI
008fa983 : MOV ECX,ESP
008fa985 : MOV dword ptr [EBP + 0xffffff78],ESP
008fa98b : PUSH EDX
008fa98c : CALL 0x00405660
008fa991 : MOV byte ptr [EBP + -0x4],0x7
008fa995 : MOV byte ptr [EBP + -0x4],0x6
008fa999 : LEA ECX,[EBP + 0xffffff30]
008fa99f : CALL 0x008f75f0
008fa9a4 : ADD ESP,0x1c
008fa9a7 : MOV byte ptr [EBP + -0x4],0x8
008fa9ab : PUSH -0x1
008fa9ad : PUSH 0x0
008fa9af : PUSH EAX
008fa9b0 : MOV ECX,EDI
008fa9b2 : CALL 0x00405eb0
008fa9b7 : MOV byte ptr [EBP + -0x4],0x6
008fa9bb : LEA ECX,[EBP + 0xffffff30]
008fa9c1 : CALL 0x00406560
008fa9c6 : MOV EAX,[0x00da9894]
008fa9cb : MOV EAX,dword ptr [EAX]
008fa9cd : TEST EAX,EAX
008fa9cf : JZ 0x008faa06
008fa9d1 : CMP dword ptr [EAX + 0x114],0x0
008fa9d8 : JZ 0x008faa06
008fa9da : CMP dword ptr [EBP + -0x30],0x8
008fa9de : MOV EAX,dword ptr [EAX + 0x114]
008fa9e4 : MOV ECX,dword ptr [EBP + -0x44]
008fa9e7 : JNC 0x008fa9ec
008fa9e9 : LEA ECX,[EBP + -0x44]
008fa9ec : MOV ESI,dword ptr [EBP + 0x10]
008fa9ef : MOV EDX,dword ptr [EAX]
008fa9f1 : PUSH ESI
008fa9f2 : PUSH ECX
008fa9f3 : PUSH 0xc6189c
008fa9f8 : PUSH 0xc618a4
008fa9fd : PUSH EAX
008fa9fe : MOV EAX,dword ptr [EDX + 0x4]
008faa01 : CALL EAX
008faa03 : ADD ESP,0x14
008faa06 : INC dword ptr [EBP + 0x10]
008faa09 : MOV byte ptr [EBP + -0x4],0x5
008faa0d : LEA ECX,[EBP + -0x48]
008faa10 : CALL 0x00406560
008faa15 : MOV byte ptr [EBP + -0x4],0x0
008faa19 : LEA ECX,[EBP + -0x64]
008faa1c : CALL 0x00406560
008faa21 : LEA EDX,[EBP + 0xffffff7c]
008faa27 : CALL 0x00416210
008faa2c : MOV EAX,dword ptr [EBP + 0xffffff7c]
008faa32 : CMP EAX,dword ptr [EBP + 0xffffff6c]
008faa38 : JNZ 0x008fa7d0
008faa3e : JMP 0x008faa4d
008faa40 : LEA ECX,[EBP + 0x10]
008faa43 : PUSH ECX
008faa44 : MOV ECX,dword ptr [EBP + 0xc]
008faa47 : PUSH EBX
008faa48 : CALL 0x008fa3b0
008faa4d : MOV dword ptr [EBP + -0x4],0xffffffff
008faa54 : LEA EDX,[EBP + 0xffffff68]
008faa5a : PUSH EDX
008faa5b : CALL 0x0040f3f0
008faa60 : MOV EAX,dword ptr [EBP + 0x10]
008faa63 : MOV ECX,dword ptr [EBP + -0xc]
008faa66 : MOV dword ptr FS:[0x0],ECX
008faa6d : POP ECX
008faa6e : POP EDI
008faa6f : POP ESI
008faa70 : POP EBX
008faa71 : MOV ECX,dword ptr [EBP + -0x10]
008faa74 : XOR ECX,EBP
008faa76 : CALL 0x00633e6b
008faa7b : MOV ESP,EBP
008faa7d : POP EBP
008faa7e : RET 0x10

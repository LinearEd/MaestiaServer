PROGRAM  : Maestia.exe
FUNCTION : FUN_006f29e0
ENTRY    : 006f29e0
BODY     : [[006f29e0, 006f2b90]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006f29e0(void)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int *piVar3;
  int iVar4;
  uint uVar5;
  int unaff_ESI;
  LPCRITICAL_SECTION local_28;
  char *local_24;
  undefined4 local_20;
  int local_1c;
  undefined4 local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b111e5;
  local_10 = ExceptionList;
  uVar5 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_28 = (LPCRITICAL_SECTION)(unaff_ESI + 0xf44);
  local_1c = 0;
  local_24 = ".\\AvSocket.cpp";
  local_20 = 0x91;
  local_18 = 1;
  FUN_006ef1a0(&local_28);
  local_8 = 0;
  puVar1 = *(undefined4 **)(unaff_ESI + 0x23f0);
  while (puVar1 != (undefined4 *)0x0) {
    puVar2 = (undefined4 *)*puVar1;
    puVar1 = (undefined4 *)puVar1[0x801];
    (*(code *)*puVar2)(1,uVar5);
  }
  *(undefined4 *)(unaff_ESI + 0x23f4) = 0;
  *(undefined4 *)(unaff_ESI + 0x23f0) = 0;
  local_8 = 0xffffffff;
  if (local_1c != 0) {
    LeaveCriticalSection(local_28);
  }
  local_28 = (LPCRITICAL_SECTION)(unaff_ESI + 0xe98);
  local_1c = 0;
  local_24 = ".\\AvSocket.cpp";
  local_20 = 0x98;
  local_18 = 1;
  FUN_006ef1a0(&local_28);
  local_8 = 1;
  if (*(int *)(unaff_ESI + 0xeb8) != 0) {
    do {
      piVar3 = *(int **)(unaff_ESI + 0xeb8);
      local_14 = *piVar3;
      if (piVar3 != (int *)0x0) {
        if (piVar3[2] == 0) {
          piVar3[2] = 0;
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      *(int *)(unaff_ESI + 0xeb8) = local_14;
    } while (local_14 != 0);
    local_14 = 0;
  }
  local_8 = 0xffffffff;
  if (local_1c != 0) {
    LeaveCriticalSection(local_28);
  }
  local_28 = (LPCRITICAL_SECTION)(unaff_ESI + 0xe7c);
  local_1c = 0;
  local_24 = ".\\AvSocket.cpp";
  local_20 = 0xa3;
  local_18 = 1;
  FUN_006ef1a0(&local_28);
  local_8 = 2;
  iVar4 = *(int *)(unaff_ESI + 0xeb0);
  while( true ) {
    if (iVar4 == 0) {
      local_8 = 0xffffffff;
      if (local_1c != 0) {
        LeaveCriticalSection(local_28);
      }
      ExceptionList = local_10;
      return;
    }
    piVar3 = *(int **)(unaff_ESI + 0xeb0);
    local_14 = *piVar3;
    if (piVar3 != (int *)0x0) break;
    *(int *)(unaff_ESI + 0xeb0) = local_14;
    iVar4 = local_14;
  }
  if (piVar3[2] == 0) {
    piVar3[2] = 0;
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
006f29e0 : PUSH EBP
006f29e1 : MOV EBP,ESP
006f29e3 : PUSH -0x1
006f29e5 : PUSH 0xb111e5
006f29ea : MOV EAX,FS:[0x0]
006f29f0 : PUSH EAX
006f29f1 : SUB ESP,0x18
006f29f4 : PUSH EBX
006f29f5 : PUSH EDI
006f29f6 : MOV EAX,[0x00d66fa0]
006f29fb : XOR EAX,EBP
006f29fd : PUSH EAX
006f29fe : LEA EAX,[EBP + -0xc]
006f2a01 : MOV FS:[0x0],EAX
006f2a07 : LEA ECX,[EBP + -0x24]
006f2a0a : LEA EAX,[ESI + 0xf44]
006f2a10 : XOR EBX,EBX
006f2a12 : MOV EDI,0x1
006f2a17 : PUSH ECX
006f2a18 : MOV dword ptr [EBP + -0x18],EBX
006f2a1b : MOV dword ptr [EBP + -0x24],EAX
006f2a1e : MOV dword ptr [EBP + -0x20],0xbf6300
006f2a25 : MOV dword ptr [EBP + -0x1c],0x91
006f2a2c : MOV dword ptr [EBP + -0x14],EDI
006f2a2f : CALL 0x006ef1a0
006f2a34 : MOV dword ptr [EBP + -0x4],EBX
006f2a37 : MOV ECX,dword ptr [ESI + 0x23f0]
006f2a3d : CMP ECX,EBX
006f2a3f : JZ 0x006f2a5a
006f2a41 : MOV EDX,dword ptr [ECX]
006f2a43 : MOV EAX,dword ptr [EDX]
006f2a45 : MOV EDI,dword ptr [ECX + 0x2004]
006f2a4b : PUSH 0x1
006f2a4d : CALL EAX
006f2a4f : MOV ECX,EDI
006f2a51 : CMP EDI,EBX
006f2a53 : JNZ 0x006f2a41
006f2a55 : MOV EDI,0x1
006f2a5a : MOV dword ptr [ESI + 0x23f4],EBX
006f2a60 : MOV dword ptr [ESI + 0x23f0],EBX
006f2a66 : MOV dword ptr [EBP + -0x4],0xffffffff
006f2a6d : CMP dword ptr [EBP + -0x18],EBX
006f2a70 : JZ 0x006f2a7f
006f2a72 : MOV ECX,dword ptr [EBP + -0x24]
006f2a75 : PUSH ECX
006f2a76 : CALL dword ptr [0x00b8511c]
006f2a7c : MOV dword ptr [EBP + -0x18],EBX
006f2a7f : LEA EAX,[EBP + -0x24]
006f2a82 : LEA EDX,[ESI + 0xe98]
006f2a88 : PUSH EAX
006f2a89 : MOV dword ptr [EBP + -0x18],EBX
006f2a8c : MOV dword ptr [EBP + -0x24],EDX
006f2a8f : MOV dword ptr [EBP + -0x20],0xbf6310
006f2a96 : MOV dword ptr [EBP + -0x1c],0x98
006f2a9d : MOV dword ptr [EBP + -0x14],EDI
006f2aa0 : CALL 0x006ef1a0
006f2aa5 : MOV dword ptr [EBP + -0x4],EDI
006f2aa8 : CMP dword ptr [ESI + 0xeb8],EBX
006f2aae : JZ 0x006f2ae7
006f2ab0 : MOV EDI,dword ptr [ESI + 0xeb8]
006f2ab6 : MOV ECX,dword ptr [EDI]
006f2ab8 : MOV dword ptr [EBP + -0x10],ECX
006f2abb : CMP EDI,EBX
006f2abd : JZ 0x006f2ad5
006f2abf : MOV ECX,dword ptr [EDI + 0x8]
006f2ac2 : CMP ECX,EBX
006f2ac4 : JZ 0x006f2acb
006f2ac6 : CALL 0x006f04e0
006f2acb : MOV ECX,EDI
006f2acd : MOV dword ptr [EDI + 0x8],EBX
006f2ad0 : CALL 0x006f04e0
006f2ad5 : MOV EDX,dword ptr [EBP + -0x10]
006f2ad8 : MOV dword ptr [ESI + 0xeb8],EDX
006f2ade : CMP EDX,EBX
006f2ae0 : JNZ 0x006f2ab0
006f2ae2 : MOV EDI,0x1
006f2ae7 : MOV dword ptr [EBP + -0x4],0xffffffff
006f2aee : CMP dword ptr [EBP + -0x18],EBX
006f2af1 : JZ 0x006f2b00
006f2af3 : MOV EAX,dword ptr [EBP + -0x24]
006f2af6 : PUSH EAX
006f2af7 : CALL dword ptr [0x00b8511c]
006f2afd : MOV dword ptr [EBP + -0x18],EBX
006f2b00 : LEA EDX,[EBP + -0x24]
006f2b03 : LEA ECX,[ESI + 0xe7c]
006f2b09 : PUSH EDX
006f2b0a : MOV dword ptr [EBP + -0x18],EBX
006f2b0d : MOV dword ptr [EBP + -0x24],ECX
006f2b10 : MOV dword ptr [EBP + -0x20],0xbf6320
006f2b17 : MOV dword ptr [EBP + -0x1c],0xa3
006f2b1e : MOV dword ptr [EBP + -0x14],EDI
006f2b21 : CALL 0x006ef1a0
006f2b26 : MOV dword ptr [EBP + -0x4],0x2
006f2b2d : CMP dword ptr [ESI + 0xeb0],EBX
006f2b33 : JZ 0x006f2b67
006f2b35 : MOV EDI,dword ptr [ESI + 0xeb0]
006f2b3b : MOV EAX,dword ptr [EDI]
006f2b3d : MOV dword ptr [EBP + -0x10],EAX
006f2b40 : CMP EDI,EBX
006f2b42 : JZ 0x006f2b5a
006f2b44 : MOV ECX,dword ptr [EDI + 0x8]
006f2b47 : CMP ECX,EBX
006f2b49 : JZ 0x006f2b50
006f2b4b : CALL 0x006f04e0
006f2b50 : MOV ECX,EDI
006f2b52 : MOV dword ptr [EDI + 0x8],EBX
006f2b55 : CALL 0x006f04e0
006f2b5a : MOV ECX,dword ptr [EBP + -0x10]
006f2b5d : MOV dword ptr [ESI + 0xeb0],ECX
006f2b63 : CMP ECX,EBX
006f2b65 : JNZ 0x006f2b35
006f2b67 : MOV dword ptr [EBP + -0x4],0xffffffff
006f2b6e : CMP dword ptr [EBP + -0x18],EBX
006f2b71 : JZ 0x006f2b80
006f2b73 : MOV EDX,dword ptr [EBP + -0x24]
006f2b76 : PUSH EDX
006f2b77 : CALL dword ptr [0x00b8511c]
006f2b7d : MOV dword ptr [EBP + -0x18],EBX
006f2b80 : MOV ECX,dword ptr [EBP + -0xc]
006f2b83 : MOV dword ptr FS:[0x0],ECX
006f2b8a : POP ECX
006f2b8b : POP EDI
006f2b8c : POP EBX
006f2b8d : MOV ESP,EBP
006f2b8f : POP EBP
006f2b90 : RET

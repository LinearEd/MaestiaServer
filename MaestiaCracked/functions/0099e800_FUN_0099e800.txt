PROGRAM  : Maestia.exe
FUNCTION : FUN_0099e800
ENTRY    : 0099e800
BODY     : [[0099e800, 0099eac9] [0099eacf, 0099eba6]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0099e800(int param_1,int param_2,undefined4 *param_3,uint *param_4,int param_5)

{
  short sVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  uint uVar4;
  int iVar5;
  byte *pbVar6;
  int *piVar7;
  uint uVar8;
  byte *pbVar9;
  int local_24;
  byte *local_20;
  int local_1c;
  byte *local_18;
  byte *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b2133a;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_1c = *(int *)(param_1 + 0x58);
  if ((param_2 == 1) && ((*(int *)(param_1 + 0x5c) - local_1c & 0xfffffffcU) == 0)) {
    param_2 = 0;
  }
  local_24 = 0;
  if (0 < param_5) {
    while( true ) {
      pbVar9 = (byte *)0x0;
      iVar5 = FUN_006f0760(0x70,"",0,(DAT_01725270 >> 3 & 1) == 0,uVar4);
      local_8 = 0;
      if (iVar5 != 0) {
        pbVar9 = (byte *)FUN_00421060(iVar5);
      }
      local_8 = 0xffffffff;
      pbVar6 = (byte *)*param_3;
      if ((pbVar6 == (byte *)0x0) || (uVar8 = *param_4, uVar8 == 0)) {
        *param_4 = 0;
        pbVar6 = (byte *)0x0;
      }
      else {
        *pbVar9 = *pbVar6;
        *param_4 = uVar8 - 1;
        pbVar6 = pbVar6 + 1;
      }
      *param_3 = pbVar6;
      if ((pbVar6 == (byte *)0x0) || (uVar8 = *param_4, uVar8 < 4)) {
        *param_4 = 0;
        pbVar6 = (byte *)0x0;
      }
      else {
        *(undefined4 *)(pbVar9 + 4) = *(undefined4 *)pbVar6;
        *param_4 = uVar8 - 4;
        pbVar6 = pbVar6 + 4;
      }
      *param_3 = pbVar6;
      if ((pbVar6 == (byte *)0x0) || (uVar8 = *param_4, uVar8 < 8)) {
        *param_4 = 0;
        pbVar6 = (byte *)0x0;
      }
      else {
        *(undefined4 *)(pbVar9 + 8) = *(undefined4 *)pbVar6;
        uVar2 = *(undefined4 *)(pbVar6 + 4);
        *param_4 = uVar8 - 8;
        *(undefined4 *)(pbVar9 + 0xc) = uVar2;
        pbVar6 = pbVar6 + 8;
      }
      *param_3 = pbVar6;
      if ((pbVar6 == (byte *)0x0) || (uVar8 = *param_4, uVar8 < 2)) {
        local_18 = (byte *)0x0;
        *param_4 = 0;
        pbVar6 = (byte *)0x0;
      }
      else if ((*(short *)pbVar6 < 0) || (iVar5 = (int)*(short *)pbVar6, (int)uVar8 < iVar5 + 2)) {
        pbVar6 = (byte *)0x0;
        local_18 = (byte *)0x0;
        *param_4 = 0;
      }
      else {
        local_18 = pbVar6 + 2;
        *param_4 = (uVar8 - iVar5) - 2;
        pbVar6 = pbVar6 + iVar5 + 2;
      }
      *param_3 = pbVar6;
      if ((pbVar6 == (byte *)0x0) || (uVar8 = *param_4, uVar8 < 2)) {
        local_14 = (byte *)0x0;
        *param_4 = 0;
        pbVar6 = (byte *)0x0;
      }
      else if ((*(short *)pbVar6 < 0) || (iVar5 = (int)*(short *)pbVar6, (int)uVar8 < iVar5 + 2)) {
        pbVar6 = (byte *)0x0;
        local_14 = (byte *)0x0;
        *param_4 = 0;
      }
      else {
        local_14 = pbVar6 + 2;
        *param_4 = (uVar8 - iVar5) - 2;
        pbVar6 = pbVar6 + iVar5 + 2;
      }
      *param_3 = pbVar6;
      if ((pbVar6 == (byte *)0x0) || (uVar8 = *param_4, uVar8 == 0)) {
        *param_4 = 0;
        pbVar6 = (byte *)0x0;
      }
      else {
        pbVar9[100] = *pbVar6;
        *param_4 = uVar8 - 1;
        pbVar6 = pbVar6 + 1;
      }
      *param_3 = pbVar6;
      if ((pbVar6 == (byte *)0x0) || (uVar8 = *param_4, uVar8 < 8)) {
        *param_4 = 0;
        pbVar6 = (byte *)0x0;
      }
      else {
        *(undefined4 *)(pbVar9 + 0x68) = *(undefined4 *)pbVar6;
        *(undefined4 *)(pbVar9 + 0x6c) = *(undefined4 *)(pbVar6 + 4);
        *param_4 = uVar8 - 8;
        pbVar6 = pbVar6 + 8;
      }
      *param_3 = pbVar6;
      local_20 = pbVar9;
      if ((local_18 == (byte *)0x0) || (local_14 == (byte *)0x0)) break;
      piVar7 = *(int **)(param_1 + 0x58);
      if (piVar7 != *(int **)(param_1 + 0x5c)) {
        do {
          if ((*(int *)(*piVar7 + 8) == *(int *)(pbVar9 + 8)) &&
             (*(int *)(*piVar7 + 0xc) == *(int *)(pbVar9 + 0xc))) {
            FUN_00421150(pbVar9);
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          piVar7 = piVar7 + 1;
        } while (piVar7 != *(int **)(param_1 + 0x5c));
      }
      pbVar6 = local_18;
      do {
        sVar1 = *(short *)pbVar6;
        pbVar6 = pbVar6 + 2;
      } while (sVar1 != 0);
      FUN_00406360(local_18,(int)pbVar6 - (int)(local_18 + 2) >> 1);
      pbVar6 = local_14;
      do {
        sVar1 = *(short *)pbVar6;
        pbVar6 = pbVar6 + 2;
      } while (sVar1 != 0);
      FUN_00406360(local_14,(int)pbVar6 - (int)(local_14 + 2) >> 1);
      if ((char)*pbVar9 < '\0') {
        *pbVar9 = *pbVar9 & 0x7f;
        pbVar6 = local_14;
        do {
          sVar1 = *(short *)pbVar6;
          pbVar6 = pbVar6 + 2;
        } while (sVar1 != 0);
        FUN_00406360(local_14,(int)pbVar6 - (int)(local_14 + 2) >> 1);
      }
      else {
        FUN_00404870(L" ...",4);
      }
      if (param_2 == 1) {
        if ((*(int *)(param_1 + 0x5c) - *(int *)(param_1 + 0x58) & 0xfffffffcU) == 0) {
          iVar5 = 0;
        }
        else {
          iVar5 = local_1c - *(int *)(param_1 + 0x58) >> 2;
        }
        FUN_0042fe80(param_1 + 0x54,local_1c,&local_20);
        local_1c = *(int *)(param_1 + 0x58) + iVar5 * 4 + 4;
      }
      else {
        iVar5 = *(int *)(param_1 + 0x58);
        if (iVar5 == 0) {
          uVar8 = 0;
        }
        else {
          uVar8 = *(int *)(param_1 + 0x60) - iVar5 >> 2;
        }
        puVar3 = *(undefined4 **)(param_1 + 0x5c);
        if ((uint)((int)puVar3 - iVar5 >> 2) < uVar8) {
          *puVar3 = pbVar9;
          *(undefined4 **)(param_1 + 0x5c) = puVar3 + 1;
        }
        else {
          FUN_0042fe80(param_1 + 0x54,puVar3,&local_20);
        }
      }
      local_24 = local_24 + 1;
      if (param_5 <= local_24) {
        ExceptionList = local_10;
        return;
      }
    }
    if (pbVar9 != (byte *)0x0) {
      FUN_00421150(pbVar9);
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
0099e800 : PUSH EBP
0099e801 : MOV EBP,ESP
0099e803 : PUSH -0x1
0099e805 : PUSH 0xb2133a
0099e80a : MOV EAX,FS:[0x0]
0099e810 : PUSH EAX
0099e811 : SUB ESP,0x18
0099e814 : PUSH EBX
0099e815 : PUSH ESI
0099e816 : PUSH EDI
0099e817 : MOV EAX,[0x00d66fa0]
0099e81c : XOR EAX,EBP
0099e81e : PUSH EAX
0099e81f : LEA EAX,[EBP + -0xc]
0099e822 : MOV FS:[0x0],EAX
0099e828 : MOV EBX,dword ptr [EBP + 0x14]
0099e82b : CMP dword ptr [EBP + 0xc],0x1
0099e82f : MOV EAX,dword ptr [EBP + 0x8]
0099e832 : MOV ECX,dword ptr [EAX + 0x58]
0099e835 : MOV dword ptr [EBP + -0x18],ECX
0099e838 : JNZ 0x0099e84e
0099e83a : MOV EDX,dword ptr [EAX + 0x5c]
0099e83d : SUB EDX,ECX
0099e83f : TEST EDX,0xfffffffc
0099e845 : JNZ 0x0099e84e
0099e847 : MOV dword ptr [EBP + 0xc],0x0
0099e84e : CMP dword ptr [EBP + 0x18],0x0
0099e852 : MOV dword ptr [EBP + -0x20],0x0
0099e859 : JLE 0x0099eb93
0099e85f : MOV EAX,[0x01725270]
0099e864 : SHR EAX,0x3
0099e867 : MOV ECX,0x0
0099e86c : AND EAX,0x1
0099e86f : SETZ CL
0099e872 : XOR EDI,EDI
0099e874 : PUSH ECX
0099e875 : PUSH EDI
0099e876 : PUSH 0xbf1a4a
0099e87b : PUSH 0x70
0099e87d : CALL 0x006f0760
0099e882 : ADD ESP,0x10
0099e885 : MOV dword ptr [EBP + -0x24],EAX
0099e888 : MOV dword ptr [EBP + -0x4],EDI
0099e88b : CMP EAX,EDI
0099e88d : JZ 0x0099e897
0099e88f : PUSH EAX
0099e890 : CALL 0x00421060
0099e895 : MOV EDI,EAX
0099e897 : MOV dword ptr [EBP + -0x4],0xffffffff
0099e89e : MOV ESI,dword ptr [EBP + 0x10]
0099e8a1 : MOV EAX,dword ptr [ESI]
0099e8a3 : MOV dword ptr [EBP + -0x1c],EDI
0099e8a6 : TEST EAX,EAX
0099e8a8 : JZ 0x0099e8bb
0099e8aa : MOV ECX,dword ptr [EBX]
0099e8ac : CMP ECX,0x1
0099e8af : JC 0x0099e8bb
0099e8b1 : MOV DL,byte ptr [EAX]
0099e8b3 : DEC ECX
0099e8b4 : MOV byte ptr [EDI],DL
0099e8b6 : MOV dword ptr [EBX],ECX
0099e8b8 : INC EAX
0099e8b9 : JMP 0x0099e8c3
0099e8bb : MOV dword ptr [EBX],0x0
0099e8c1 : XOR EAX,EAX
0099e8c3 : MOV dword ptr [ESI],EAX
0099e8c5 : TEST EAX,EAX
0099e8c7 : JZ 0x0099e8df
0099e8c9 : MOV ECX,dword ptr [EBX]
0099e8cb : CMP ECX,0x4
0099e8ce : JC 0x0099e8df
0099e8d0 : MOV EDX,dword ptr [EAX]
0099e8d2 : ADD ECX,-0x4
0099e8d5 : MOV dword ptr [EDI + 0x4],EDX
0099e8d8 : MOV dword ptr [EBX],ECX
0099e8da : ADD EAX,0x4
0099e8dd : JMP 0x0099e8e7
0099e8df : MOV dword ptr [EBX],0x0
0099e8e5 : XOR EAX,EAX
0099e8e7 : MOV dword ptr [ESI],EAX
0099e8e9 : TEST EAX,EAX
0099e8eb : JZ 0x0099e909
0099e8ed : MOV ECX,dword ptr [EBX]
0099e8ef : CMP ECX,0x8
0099e8f2 : JC 0x0099e909
0099e8f4 : MOV EDX,dword ptr [EAX]
0099e8f6 : ADD ECX,-0x8
0099e8f9 : MOV dword ptr [EDI + 0x8],EDX
0099e8fc : MOV EDX,dword ptr [EAX + 0x4]
0099e8ff : MOV dword ptr [EBX],ECX
0099e901 : MOV dword ptr [EDI + 0xc],EDX
0099e904 : LEA ECX,[EAX + 0x8]
0099e907 : JMP 0x0099e911
0099e909 : MOV dword ptr [EBX],0x0
0099e90f : XOR ECX,ECX
0099e911 : MOV dword ptr [ESI],ECX
0099e913 : TEST ECX,ECX
0099e915 : JZ 0x0099e952
0099e917 : MOV EAX,dword ptr [EBX]
0099e919 : CMP EAX,0x2
0099e91c : JC 0x0099e952
0099e91e : MOVZX EDX,word ptr [ECX]
0099e921 : TEST DX,DX
0099e924 : JL 0x0099e949
0099e926 : MOVSX EDX,DX
0099e929 : LEA ESI,[EDX + 0x2]
0099e92c : CMP EAX,ESI
0099e92e : JL 0x0099e946
0099e930 : LEA ESI,[ECX + 0x2]
0099e933 : SUB EAX,EDX
0099e935 : SUB EAX,0x2
0099e938 : MOV dword ptr [EBP + -0x14],ESI
0099e93b : MOV ESI,dword ptr [EBP + 0x10]
0099e93e : MOV dword ptr [EBX],EAX
0099e940 : LEA ECX,[EDX + ECX*0x1 + 0x2]
0099e944 : JMP 0x0099e961
0099e946 : MOV ESI,dword ptr [EBP + 0x10]
0099e949 : XOR ECX,ECX
0099e94b : MOV dword ptr [EBP + -0x14],ECX
0099e94e : MOV dword ptr [EBX],ECX
0099e950 : JMP 0x0099e961
0099e952 : MOV dword ptr [EBP + -0x14],0x0
0099e959 : MOV dword ptr [EBX],0x0
0099e95f : XOR ECX,ECX
0099e961 : MOV dword ptr [ESI],ECX
0099e963 : TEST ECX,ECX
0099e965 : JZ 0x0099e9a2
0099e967 : MOV EAX,dword ptr [EBX]
0099e969 : CMP EAX,0x2
0099e96c : JC 0x0099e9a2
0099e96e : MOVZX EDX,word ptr [ECX]
0099e971 : TEST DX,DX
0099e974 : JL 0x0099e999
0099e976 : MOVSX EDX,DX
0099e979 : LEA ESI,[EDX + 0x2]
0099e97c : CMP EAX,ESI
0099e97e : JL 0x0099e996
0099e980 : SUB EAX,EDX
0099e982 : LEA ESI,[ECX + 0x2]
0099e985 : SUB EAX,0x2
0099e988 : MOV dword ptr [EBP + -0x10],ESI
0099e98b : MOV ESI,dword ptr [EBP + 0x10]
0099e98e : MOV dword ptr [EBX],EAX
0099e990 : LEA EAX,[EDX + ECX*0x1 + 0x2]
0099e994 : JMP 0x0099e9b1
0099e996 : MOV ESI,dword ptr [EBP + 0x10]
0099e999 : XOR EAX,EAX
0099e99b : MOV dword ptr [EBP + -0x10],EAX
0099e99e : MOV dword ptr [EBX],EAX
0099e9a0 : JMP 0x0099e9b1
0099e9a2 : MOV dword ptr [EBP + -0x10],0x0
0099e9a9 : MOV dword ptr [EBX],0x0
0099e9af : XOR EAX,EAX
0099e9b1 : MOV dword ptr [ESI],EAX
0099e9b3 : TEST EAX,EAX
0099e9b5 : JZ 0x0099e9cc
0099e9b7 : MOV ECX,dword ptr [EBX]
0099e9b9 : CMP ECX,0x1
0099e9bc : JC 0x0099e9cc
0099e9be : MOV DL,byte ptr [EAX]
0099e9c0 : MOV ESI,dword ptr [EBP + 0x10]
0099e9c3 : DEC ECX
0099e9c4 : MOV byte ptr [EDI + 0x64],DL
0099e9c7 : MOV dword ptr [EBX],ECX
0099e9c9 : INC EAX
0099e9ca : JMP 0x0099e9d4
0099e9cc : MOV dword ptr [EBX],0x0
0099e9d2 : XOR EAX,EAX
0099e9d4 : MOV dword ptr [ESI],EAX
0099e9d6 : TEST EAX,EAX
0099e9d8 : JZ 0x0099e9f6
0099e9da : MOV ECX,dword ptr [EBX]
0099e9dc : CMP ECX,0x8
0099e9df : JC 0x0099e9f6
0099e9e1 : MOV EDX,dword ptr [EAX]
0099e9e3 : MOV dword ptr [EDI + 0x68],EDX
0099e9e6 : MOV EDX,dword ptr [EAX + 0x4]
0099e9e9 : ADD ECX,-0x8
0099e9ec : MOV dword ptr [EDI + 0x6c],EDX
0099e9ef : MOV dword ptr [EBX],ECX
0099e9f1 : ADD EAX,0x8
0099e9f4 : JMP 0x0099e9fe
0099e9f6 : MOV dword ptr [EBX],0x0
0099e9fc : XOR EAX,EAX
0099e9fe : CMP dword ptr [EBP + -0x14],0x0
0099ea02 : MOV dword ptr [ESI],EAX
0099ea04 : JZ 0x0099eb82
0099ea0a : CMP dword ptr [EBP + -0x10],0x0
0099ea0e : JZ 0x0099eb82
0099ea14 : MOV ECX,dword ptr [EBP + 0x8]
0099ea17 : MOV EAX,dword ptr [ECX + 0x58]
0099ea1a : MOV ECX,dword ptr [ECX + 0x5c]
0099ea1d : MOV dword ptr [EBP + -0x24],ECX
0099ea20 : CMP EAX,ECX
0099ea22 : JZ 0x0099ea44
0099ea24 : MOV EDX,dword ptr [EDI + 0x8]
0099ea27 : MOV ECX,dword ptr [EAX]
0099ea29 : MOV ESI,dword ptr [ECX + 0x8]
0099ea2c : CMP ESI,EDX
0099ea2e : JNZ 0x0099ea3c
0099ea30 : MOV ECX,dword ptr [ECX + 0xc]
0099ea33 : CMP ECX,dword ptr [EDI + 0xc]
0099ea36 : JZ 0x0099eabd
0099ea3c : ADD EAX,0x4
0099ea3f : CMP EAX,dword ptr [EBP + -0x24]
0099ea42 : JNZ 0x0099ea27
0099ea44 : MOV EAX,dword ptr [EBP + -0x14]
0099ea47 : LEA EDX,[EAX + 0x2]
0099ea4a : LEA EBX,[EBX]
0099ea50 : MOV CX,word ptr [EAX]
0099ea53 : ADD EAX,0x2
0099ea56 : TEST CX,CX
0099ea59 : JNZ 0x0099ea50
0099ea5b : SUB EAX,EDX
0099ea5d : MOV EDX,dword ptr [EBP + -0x14]
0099ea60 : SAR EAX,0x1
0099ea62 : PUSH EAX
0099ea63 : PUSH EDX
0099ea64 : LEA ECX,[EDI + 0x10]
0099ea67 : CALL 0x00406360
0099ea6c : MOV EAX,dword ptr [EBP + -0x10]
0099ea6f : LEA EDX,[EAX + 0x2]
0099ea72 : MOV CX,word ptr [EAX]
0099ea75 : ADD EAX,0x2
0099ea78 : TEST CX,CX
0099ea7b : JNZ 0x0099ea72
0099ea7d : SUB EAX,EDX
0099ea7f : SAR EAX,0x1
0099ea81 : PUSH EAX
0099ea82 : MOV EAX,dword ptr [EBP + -0x10]
0099ea85 : LEA ESI,[EDI + 0x48]
0099ea88 : PUSH EAX
0099ea89 : MOV ECX,ESI
0099ea8b : CALL 0x00406360
0099ea90 : MOV AL,byte ptr [EDI]
0099ea92 : TEST AL,AL
0099ea94 : JNS 0x0099eacf
0099ea96 : MOV EDX,dword ptr [EBP + -0x10]
0099ea99 : AND AL,0x7f
0099ea9b : MOV byte ptr [EDI],AL
0099ea9d : MOV EAX,EDX
0099ea9f : LEA ESI,[EAX + 0x2]
0099eaa2 : MOV CX,word ptr [EAX]
0099eaa5 : ADD EAX,0x2
0099eaa8 : TEST CX,CX
0099eaab : JNZ 0x0099eaa2
0099eaad : SUB EAX,ESI
0099eaaf : SAR EAX,0x1
0099eab1 : PUSH EAX
0099eab2 : PUSH EDX
0099eab3 : LEA ECX,[EDI + 0x2c]
0099eab6 : CALL 0x00406360
0099eabb : JMP 0x0099eadb
0099eabd : PUSH EDI
0099eabe : CALL 0x00421150
0099eac3 : MOV ECX,EDI
0099eac5 : CALL 0x006f04e0
0099eacf : PUSH 0x4
0099ead1 : PUSH 0xc8882c
0099ead6 : CALL 0x00404870
0099eadb : CMP dword ptr [EBP + 0xc],0x1
0099eadf : JNZ 0x0099eb1f
0099eae1 : MOV EDI,dword ptr [EBP + 0x8]
0099eae4 : MOV EAX,dword ptr [EDI + 0x58]
0099eae7 : MOV ECX,dword ptr [EDI + 0x5c]
0099eaea : ADD EDI,0x54
0099eaed : SUB ECX,EAX
0099eaef : TEST ECX,0xfffffffc
0099eaf5 : JNZ 0x0099eafb
0099eaf7 : XOR ESI,ESI
0099eaf9 : JMP 0x0099eb03
0099eafb : MOV ESI,dword ptr [EBP + -0x18]
0099eafe : SUB ESI,EAX
0099eb00 : SAR ESI,0x2
0099eb03 : MOV EAX,dword ptr [EBP + -0x18]
0099eb06 : LEA EDX,[EBP + -0x1c]
0099eb09 : PUSH EDX
0099eb0a : PUSH EAX
0099eb0b : PUSH EDI
0099eb0c : CALL 0x0042fe80
0099eb11 : MOV ECX,dword ptr [EDI + 0x4]
0099eb14 : LEA ESI,[ECX + ESI*0x4]
0099eb17 : ADD ESI,0x4
0099eb1a : MOV dword ptr [EBP + -0x18],ESI
0099eb1d : JMP 0x0099eb5e
0099eb1f : MOV EAX,dword ptr [EBP + 0x8]
0099eb22 : MOV ESI,dword ptr [EAX + 0x58]
0099eb25 : ADD EAX,0x54
0099eb28 : TEST ESI,ESI
0099eb2a : JNZ 0x0099eb30
0099eb2c : XOR ECX,ECX
0099eb2e : JMP 0x0099eb38
0099eb30 : MOV ECX,dword ptr [EAX + 0xc]
0099eb33 : SUB ECX,ESI
0099eb35 : SAR ECX,0x2
0099eb38 : MOV EDX,dword ptr [EAX + 0x8]
0099eb3b : MOV EBX,EDX
0099eb3d : SUB EBX,ESI
0099eb3f : SAR EBX,0x2
0099eb42 : CMP EBX,ECX
0099eb44 : JNC 0x0099eb50
0099eb46 : MOV dword ptr [EDX],EDI
0099eb48 : ADD EDX,0x4
0099eb4b : MOV dword ptr [EAX + 0x8],EDX
0099eb4e : JMP 0x0099eb5b
0099eb50 : LEA ECX,[EBP + -0x1c]
0099eb53 : PUSH ECX
0099eb54 : PUSH EDX
0099eb55 : PUSH EAX
0099eb56 : CALL 0x0042fe80
0099eb5b : MOV EBX,dword ptr [EBP + 0x14]
0099eb5e : MOV EAX,dword ptr [EBP + -0x20]
0099eb61 : INC EAX
0099eb62 : CMP EAX,dword ptr [EBP + 0x18]
0099eb65 : MOV dword ptr [EBP + -0x20],EAX
0099eb68 : JL 0x0099e85f
0099eb6e : MOV ECX,dword ptr [EBP + -0xc]
0099eb71 : MOV dword ptr FS:[0x0],ECX
0099eb78 : POP ECX
0099eb79 : POP EDI
0099eb7a : POP ESI
0099eb7b : POP EBX
0099eb7c : MOV ESP,EBP
0099eb7e : POP EBP
0099eb7f : RET 0x14
0099eb82 : TEST EDI,EDI
0099eb84 : JZ 0x0099eb93
0099eb86 : PUSH EDI
0099eb87 : CALL 0x00421150
0099eb8c : MOV ECX,EDI
0099eb8e : CALL 0x006f04e0
0099eb93 : MOV ECX,dword ptr [EBP + -0xc]
0099eb96 : MOV dword ptr FS:[0x0],ECX
0099eb9d : POP ECX
0099eb9e : POP EDI
0099eb9f : POP ESI
0099eba0 : POP EBX
0099eba1 : MOV ESP,EBP
0099eba3 : POP EBP
0099eba4 : RET 0x14

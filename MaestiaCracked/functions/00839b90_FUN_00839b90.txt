PROGRAM  : Maestia.exe
FUNCTION : FUN_00839b90
ENTRY    : 00839b90
BODY     : [[00839b90, 0083a266] [0083a2ae, 0083a400] [0083a43f, 0083a474]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_00839b90(int param_1,undefined4 *param_2)

{
  undefined1 uVar1;
  char cVar2;
  uint uVar3;
  short *psVar4;
  undefined4 uVar5;
  int iVar6;
  int iVar7;
  short *psVar8;
  wchar_t *pwVar9;
  undefined4 *puVar10;
  int in_ECX;
  byte bVar11;
  ushort *puVar12;
  undefined2 *puVar13;
  double dVar14;
  undefined1 auStack_4cec [4];
  undefined1 local_4ce8 [4];
  int local_4ce4;
  int local_4ce0;
  undefined4 local_4cdc;
  ushort *local_4cd8;
  uint local_4cd4;
  int local_4cd0;
  undefined4 *local_4ccc;
  int local_4cc8;
  undefined1 local_4cc4 [4];
  undefined2 local_4cc0;
  undefined4 local_4cb0;
  uint local_4cac;
  float local_4ca8;
  undefined4 local_4ca4;
  float local_4ca0;
  float local_4c98;
  undefined1 local_4c90 [56];
  undefined1 local_4c58 [2560];
  undefined1 local_4258 [254];
  undefined2 local_415a [8065];
  undefined1 local_258 [4];
  undefined4 local_254;
  undefined4 local_244;
  uint local_240;
  undefined4 local_238;
  undefined4 local_228;
  uint local_224;
  undefined2 local_220;
  undefined1 local_21e [514];
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  int local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b5efbc;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_4cec;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xffffb308;
  ExceptionList = &local_14;
  local_4ccc = param_2;
  *(undefined4 *)(in_ECX + 0x30) = 0;
  local_4cd0 = in_ECX;
  FUN_00406360(&DAT_00c397c8,0);
  FUN_00406360(&DAT_00c397cc,0);
  *local_4ccc = 0;
  local_224 = 7;
  local_228 = 0;
  local_238 = (undefined4 *)((uint)local_238._2_2_ << 0x10);
  local_c._0_1_ = 0;
  local_c._1_3_ = 0;
  if (*(uint *)(param_1 + 0x18) < 8) {
    psVar4 = (short *)(param_1 + 4);
  }
  else {
    psVar4 = *(short **)(param_1 + 4);
  }
  if (*psVar4 == 0x24) {
    uVar5 = FUN_0040e420(param_1,local_4cc4);
    local_c._0_1_ = 1;
    FUN_00405eb0(uVar5,0,0xffffffff);
    local_c._0_1_ = 0;
    if (7 < local_4cac) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0(uVar3);
    }
    local_4cac = 7;
    local_4cb0 = 0;
    local_4cc0 = 0;
  }
  else {
    FUN_00405eb0(param_1,0,0xffffffff);
  }
  local_4ce4 = 0;
  local_4ce0 = 0;
  local_4cdc = 0;
  local_c._0_1_ = 2;
  iVar6 = FUN_00838580(local_4ce8);
  if (iVar6 == 0) {
    local_c = (uint)local_c._1_3_ << 8;
    if (local_4ce4 != 0) {
      FUN_00405450(local_4cd8);
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_4ce4 = 0;
    local_4ce0 = 0;
    local_4cdc = 0;
    local_c = 0xffffffff;
    if (7 < local_224) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  else {
    iVar7 = FUN_00830340(local_4ce8,local_4ccc);
    iVar6 = local_4ce4;
    if (iVar7 == 0) {
      if (*(int *)(in_ECX + 0x6c) != 0) {
        FUN_00405eb0(local_4ce4,0,0xffffffff);
      }
      if (*(uint *)(iVar6 + 0x18) < 8) {
        iVar7 = iVar6 + 4;
      }
      else {
        iVar7 = *(int *)(iVar6 + 4);
      }
      FUN_00406460(iVar7);
      local_c._0_1_ = 3;
      FUN_0044ad70(in_ECX,&local_4cc8);
      local_c._0_1_ = 2;
      uVar1 = (undefined1)local_c;
      local_c._0_1_ = 2;
      if (7 < local_240) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_240 = 7;
      local_244 = 0;
      local_254 = (wchar_t *)((uint)local_254._2_2_ << 0x10);
      if (local_4cc8 != *(int *)(in_ECX + 4)) {
        local_c._0_1_ = uVar1;
        iVar7 = FUN_00405bb0(L"MOVETOPOS");
        if (((iVar7 == 0) || (cVar2 = FUN_00403810(), cVar2 != '\0')) &&
           ((local_4ce0 - iVar6) / 0x1c == 4)) {
          local_4c98 = 0.0;
          if (*(uint *)(iVar6 + 0x50) < 8) {
            pwVar9 = (wchar_t *)(iVar6 + 0x3c);
          }
          else {
            pwVar9 = *(wchar_t **)(iVar6 + 0x3c);
          }
          dVar14 = __wtof(pwVar9);
          local_4ca8 = (float)dVar14;
          local_4ca4 = 0;
          if (*(uint *)(iVar6 + 0x6c) < 8) {
            pwVar9 = (wchar_t *)(iVar6 + 0x58);
          }
          else {
            pwVar9 = *(wchar_t **)(iVar6 + 0x58);
          }
          dVar14 = __wtof(pwVar9);
          local_4ca0 = (float)dVar14;
          FUN_007dec50(*(undefined4 *)(DAT_00da93ec + 0xc));
          local_220 = 0;
          _memset(local_21e,0,0x1fe);
          FUN_0040e4a0(&DAT_00c3983c,(int)local_4c98);
          FUN_00405c00(iVar6 + 0x54);
        }
        _memset(local_4c58,0,0xa00);
        _memset(local_4258,0,0x4000);
        local_4cd8 = (ushort *)((local_4ce0 - iVar6) / 0x1c);
        local_4cd4 = 1;
        if (1 < local_4cd8) {
          puVar13 = local_415a;
          psVar4 = (short *)(iVar6 + 0x20);
          do {
            if (10 < (int)local_4cd4) break;
            local_240 = 7;
            local_244 = 0;
            local_254 = (wchar_t *)((uint)local_254 & 0xffff0000);
            FUN_00405eb0(psVar4 + -2,0,0xffffffff);
            local_c._0_1_ = 0xb;
            psVar8 = psVar4;
            if (7 < *(uint *)(psVar4 + 10)) {
              psVar8 = *(short **)psVar4;
            }
            if (*psVar8 == 0x24) {
              FUN_0082da20(psVar4 + -2,local_258);
            }
            pwVar9 = local_254;
            if (local_240 < 8) {
              pwVar9 = (wchar_t *)&local_254;
            }
            _wcsncpy(puVar13 + -0x7f,pwVar9,0x7f);
            *puVar13 = 0;
            pwVar9 = local_254;
            if (local_240 < 8) {
              pwVar9 = (wchar_t *)&local_254;
            }
            _wcsncpy(puVar13 + -0x57f,pwVar9,0x7f);
            puVar13[-0x500] = 0;
            local_c._0_1_ = 2;
            uVar1 = (undefined1)local_c;
            local_c._0_1_ = 2;
            if (7 < local_240) {
                    /* WARNING: Subroutine does not return */
              FUN_006f04e0();
            }
            local_4cd4 = local_4cd4 + 1;
            psVar4 = psVar4 + 0xe;
            puVar13 = puVar13 + 0x80;
            local_240 = 7;
            local_244 = 0;
            local_254 = (wchar_t *)((uint)local_254 & 0xffff0000);
            local_c._0_1_ = uVar1;
          } while (local_4cd4 < local_4cd8);
        }
        iVar6 = *(int *)ThreadLocalStoragePointer;
        bVar11 = (byte)((ulonglong)(*(byte *)(iVar6 + 0x18) + 1) % 3);
        *(byte *)(iVar6 + 0x18) = bVar11;
        local_4cd8 = (ushort *)((uint)bVar11 * 0x2000 + 0x122cb8 + iVar6);
        puVar12 = (ushort *)0x0;
        if (local_4cd8 != (ushort *)0x0) {
          local_4cd8[2] = 0;
          local_4cd8[3] = 0;
          *local_4cd8 = 0;
          *(undefined1 *)(local_4cd8 + 1) = 0x43;
          *(undefined1 *)((int)local_4cd8 + 3) = 1;
          local_4cd8[4] = 0;
          local_4cd8[5] = 0;
          local_4cd8[6] = 0;
          local_4cd8[7] = 0;
          local_4cd8[8] = 0;
          local_4cd8[9] = 0;
          local_4cd8[10] = 0;
          local_4cd8[0xb] = 0;
          local_4cd8[0xc] = 0;
          local_4cd8[0xd] = 0;
          local_4cd8[0xe] = 0;
          local_4cd8[0xf] = 0;
          puVar12 = local_4cd8;
        }
        local_c._0_1_ = 2;
        *(undefined4 *)(puVar12 + 2) = *(undefined4 *)(local_4cc8 + 0x28);
        iVar6 = FUN_00839060(puVar12,local_4cc8 + 0x28);
        if (iVar6 == 0) {
          local_c = (uint)local_c._1_3_ << 8;
          FUN_00405450(local_4cd8);
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        if (*(int *)(local_4cd0 + 0x6c) == 0) {
          FUN_00831a60();
          puVar10 = local_238;
          if (local_224 < 8) {
            puVar10 = &local_238;
          }
          FUN_00404750(L"Admin command [%s] sent to server",puVar10);
          local_c._0_1_ = 0xd;
          puVar10 = (undefined4 *)local_254;
          if (local_240 < 8) {
            puVar10 = &local_254;
          }
          FUN_00406460(puVar10);
          local_c._0_1_ = 0xe;
          (**(code **)(**(int **)(*DAT_00da9894 + 0x1a8) + 0x44))(local_4cc4,0x13);
          local_c = CONCAT31(local_c._1_3_,0xd);
          if (7 < local_4cac) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          local_4cac = 7;
          local_4cb0 = 0;
          local_4cc0 = 0;
          local_c._0_1_ = 2;
          if (7 < local_240) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          local_240 = 7;
          local_244 = 0;
          local_254 = (wchar_t *)((uint)local_254 & 0xffff0000);
        }
        *puVar12 = *puVar12 ^ ((puVar12[0xe] + 0x10) * 2 ^ *puVar12) & 0x1fff;
        *local_4ccc = puVar12;
        *(undefined4 *)(local_4cd0 + 0xc0) = 1;
        local_c = (uint)local_c._1_3_ << 8;
        FUN_00405450(local_4cd8);
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      FUN_00406460(L"IDS_ERROR_INVALID_ADMIN_COMMAND");
      local_c._0_1_ = 4;
      FUN_00824120(DAT_0172491c);
      local_c._0_1_ = 5;
      FUN_00403510(local_4c90);
      local_c._0_1_ = 6;
      FUN_00403450(local_258,iVar6);
      local_c._0_1_ = 8;
      FUN_00406560();
      local_c._0_1_ = 9;
      FUN_00406560();
      local_c._0_1_ = 10;
      FUN_00406560();
      (**(code **)(**(int **)(*DAT_00da9894 + 0x1a8) + 0x44))(local_258,3);
      local_c._0_1_ = 2;
      FUN_00406560();
      local_c = (uint)local_c._1_3_ << 8;
      FUN_004042c0();
      local_c = 0xffffffff;
      FUN_00406560();
      goto LAB_0083a44f;
    }
    local_c = (uint)local_c._1_3_ << 8;
    FUN_004042c0();
    local_c = 0xffffffff;
    if (7 < local_224) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  local_c = 0xffffffff;
  local_228 = 0;
  local_238 = (undefined4 *)((uint)local_238 & 0xffff0000);
  local_224 = 7;
LAB_0083a44f:
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_4cec);
  return;
}



============================================================
DISASSEMBLY
============================================================
00839b90 : PUSH EBP
00839b91 : MOV EBP,ESP
00839b93 : AND ESP,0xfffffff8
00839b96 : PUSH -0x1
00839b98 : PUSH 0xb5efbc
00839b9d : MOV EAX,FS:[0x0]
00839ba3 : PUSH EAX
00839ba4 : PUSH ECX
00839ba5 : MOV EAX,0x4cd4
00839baa : CALL 0x0063b780
00839baf : MOV EAX,[0x00d66fa0]
00839bb4 : XOR EAX,ESP
00839bb6 : MOV dword ptr [ESP + 0x4cd0],EAX
00839bbd : PUSH EBX
00839bbe : PUSH ESI
00839bbf : PUSH EDI
00839bc0 : MOV EAX,[0x00d66fa0]
00839bc5 : XOR EAX,ESP
00839bc7 : PUSH EAX
00839bc8 : LEA EAX,[ESP + 0x4ce8]
00839bcf : MOV FS:[0x0],EAX
00839bd5 : MOV EAX,dword ptr [EBP + 0xc]
00839bd8 : MOV ESI,dword ptr [EBP + 0x8]
00839bdb : MOV EDI,ECX
00839bdd : XOR EBX,EBX
00839bdf : PUSH EBX
00839be0 : PUSH 0xc397c8
00839be5 : LEA ECX,[EDI + 0x50]
00839be8 : MOV dword ptr [ESP + 0x34],EDI
00839bec : MOV dword ptr [ESP + 0x38],EAX
00839bf0 : MOV dword ptr [EDI + 0x30],EBX
00839bf3 : CALL 0x00406360
00839bf8 : PUSH EBX
00839bf9 : PUSH 0xc397cc
00839bfe : LEA ECX,[EDI + 0x34]
00839c01 : CALL 0x00406360
00839c06 : MOV ECX,dword ptr [ESP + 0x30]
00839c0a : XOR EDX,EDX
00839c0c : MOV dword ptr [ECX],EBX
00839c0e : MOV dword ptr [ESP + 0x4ad8],0x7
00839c19 : MOV dword ptr [ESP + 0x4ad4],EBX
00839c20 : MOV word ptr [ESP + 0x4ac4],DX
00839c28 : MOV dword ptr [ESP + 0x4cf0],EBX
00839c2f : CMP dword ptr [ESI + 0x18],0x8
00839c33 : JC 0x00839c3a
00839c35 : MOV EAX,dword ptr [ESI + 0x4]
00839c38 : JMP 0x00839c3d
00839c3a : LEA EAX,[ESI + 0x4]
00839c3d : CMP word ptr [EAX],0x24
00839c41 : JNZ 0x00839c9b
00839c43 : LEA EAX,[ESP + 0x38]
00839c47 : PUSH EAX
00839c48 : PUSH ESI
00839c49 : OR ECX,0xffffffff
00839c4c : MOV EDX,0x1
00839c51 : CALL 0x0040e420
00839c56 : MOV byte ptr [ESP + 0x4cf0],0x1
00839c5e : PUSH -0x1
00839c60 : PUSH EBX
00839c61 : PUSH EAX
00839c62 : LEA ECX,[ESP + 0x4acc]
00839c69 : CALL 0x00405eb0
00839c6e : MOV byte ptr [ESP + 0x4cf0],0x0
00839c76 : CMP dword ptr [ESP + 0x50],0x8
00839c7b : JC 0x00839c86
00839c7d : MOV ECX,dword ptr [ESP + 0x3c]
00839c81 : CALL 0x006f04e0
00839c86 : XOR ECX,ECX
00839c88 : MOV dword ptr [ESP + 0x50],0x7
00839c90 : MOV dword ptr [ESP + 0x4c],EBX
00839c94 : MOV word ptr [ESP + 0x3c],CX
00839c99 : JMP 0x00839cab
00839c9b : PUSH -0x1
00839c9d : PUSH EBX
00839c9e : PUSH ESI
00839c9f : LEA ECX,[ESP + 0x4acc]
00839ca6 : CALL 0x00405eb0
00839cab : MOV dword ptr [ESP + 0x18],EBX
00839caf : MOV dword ptr [ESP + 0x1c],EBX
00839cb3 : MOV dword ptr [ESP + 0x20],EBX
00839cb7 : MOV byte ptr [ESP + 0x4cf0],0x2
00839cbf : LEA EDX,[ESP + 0x14]
00839cc3 : PUSH EDX
00839cc4 : LEA ECX,[ESP + 0x4ac4]
00839ccb : CALL 0x00838580
00839cd0 : TEST EAX,EAX
00839cd2 : JNZ 0x00839d42
00839cd4 : MOV byte ptr [ESP + 0x4cf0],AL
00839cdb : MOV ESI,dword ptr [ESP + 0x18]
00839cdf : CMP ESI,EBX
00839ce1 : JZ 0x00839cfd
00839ce3 : MOV EAX,dword ptr [ESP + 0x24]
00839ce7 : MOV EDI,dword ptr [ESP + 0x1c]
00839ceb : PUSH EAX
00839cec : MOV EAX,ESI
00839cee : CALL 0x00405450
00839cf3 : ADD ESP,0x4
00839cf6 : MOV ECX,ESI
00839cf8 : CALL 0x006f04e0
00839cfd : MOV dword ptr [ESP + 0x18],EBX
00839d01 : MOV dword ptr [ESP + 0x1c],EBX
00839d05 : MOV dword ptr [ESP + 0x20],EBX
00839d09 : MOV dword ptr [ESP + 0x4cf0],0xffffffff
00839d14 : CMP dword ptr [ESP + 0x4ad8],0x8
00839d1c : JC 0x00839d2a
00839d1e : MOV ECX,dword ptr [ESP + 0x4ac4]
00839d25 : CALL 0x006f04e0
00839d2a : XOR ECX,ECX
00839d2c : MOV dword ptr [ESP + 0x4ad4],EBX
00839d33 : MOV word ptr [ESP + 0x4ac4],CX
00839d3b : XOR EAX,EAX
00839d3d : JMP 0x0083a444
00839d42 : MOV EDX,dword ptr [ESP + 0x30]
00839d46 : PUSH EDX
00839d47 : LEA EAX,[ESP + 0x18]
00839d4b : PUSH EAX
00839d4c : MOV ECX,EDI
00839d4e : CALL 0x00830340
00839d53 : TEST EAX,EAX
00839d55 : JZ 0x00839d9f
00839d57 : MOV byte ptr [ESP + 0x4cf0],0x0
00839d5f : LEA ESI,[ESP + 0x14]
00839d63 : CALL 0x004042c0
00839d68 : MOV dword ptr [ESP + 0x4cf0],0xffffffff
00839d73 : CMP dword ptr [ESP + 0x4ad8],0x8
00839d7b : JC 0x00839d89
00839d7d : MOV ECX,dword ptr [ESP + 0x4ac4]
00839d84 : CALL 0x006f04e0
00839d89 : XOR ECX,ECX
00839d8b : MOV dword ptr [ESP + 0x4ad4],EBX
00839d92 : MOV word ptr [ESP + 0x4ac4],CX
00839d9a : JMP 0x0083a43f
00839d9f : CMP dword ptr [EDI + 0x6c],EBX
00839da2 : JZ 0x00839db9
00839da4 : PUSH -0x1
00839da6 : PUSH EBX
00839da7 : MOV EBX,dword ptr [ESP + 0x20]
00839dab : PUSH EBX
00839dac : LEA ECX,[EDI + 0x88]
00839db2 : CALL 0x00405eb0
00839db7 : JMP 0x00839dbd
00839db9 : MOV EBX,dword ptr [ESP + 0x18]
00839dbd : CMP dword ptr [EBX + 0x18],0x8
00839dc1 : JC 0x00839dc8
00839dc3 : MOV EAX,dword ptr [EBX + 0x4]
00839dc6 : JMP 0x00839dcb
00839dc8 : LEA EAX,[EBX + 0x4]
00839dcb : PUSH EAX
00839dcc : LEA ECX,[ESP + 0x4aa8]
00839dd3 : CALL 0x00406460
00839dd8 : MOV byte ptr [ESP + 0x4cf0],0x3
00839de0 : LEA EDX,[ESP + 0x34]
00839de4 : PUSH EDX
00839de5 : PUSH EDI
00839de6 : LEA ESI,[ESP + 0x4aac]
00839ded : CALL 0x0044ad70
00839df2 : MOV byte ptr [ESP + 0x4cf0],0x2
00839dfa : CMP dword ptr [ESP + 0x4abc],0x8
00839e02 : JC 0x00839e10
00839e04 : MOV ECX,dword ptr [ESP + 0x4aa8]
00839e0b : CALL 0x006f04e0
00839e10 : MOV EDI,dword ptr [EDI + 0x4]
00839e13 : XOR EAX,EAX
00839e15 : MOV dword ptr [ESP + 0x4abc],0x7
00839e20 : MOV dword ptr [ESP + 0x4ab8],0x0
00839e2b : MOV word ptr [ESP + 0x4aa8],AX
00839e33 : CMP dword ptr [ESP + 0x34],EDI
00839e37 : JNZ 0x00839f34
00839e3d : PUSH 0xc397e0
00839e42 : LEA ECX,[ESP + 0x3c]
00839e46 : CALL 0x00406460
00839e4b : MOV byte ptr [ESP + 0x4cf0],0x4
00839e53 : MOV ECX,dword ptr [0x0172491c]
00839e59 : PUSH ECX
00839e5a : LEA EDX,[ESP + 0x3c]
00839e5e : LEA EDI,[ESP + 0x8c]
00839e65 : CALL 0x00824120
00839e6a : MOV byte ptr [ESP + 0x4cf0],0x5
00839e72 : LEA EDX,[ESP + 0x6c]
00839e76 : PUSH EDX
00839e77 : MOV EDX,0xc397d4
00839e7c : MOV ECX,EAX
00839e7e : CALL 0x00403510
00839e83 : ADD ESP,0x4
00839e86 : MOV byte ptr [ESP + 0x4cf0],0x6
00839e8e : LEA ECX,[ESP + 0x4aa4]
00839e95 : PUSH EBX
00839e96 : PUSH ECX
00839e97 : MOV ECX,EAX
00839e99 : CALL 0x00403450
00839e9e : ADD ESP,0x8
00839ea1 : MOV byte ptr [ESP + 0x4cf0],0x8
00839ea9 : LEA ECX,[ESP + 0x6c]
00839ead : CALL 0x00406560
00839eb2 : MOV byte ptr [ESP + 0x4cf0],0x9
00839eba : MOV ECX,EDI
00839ebc : CALL 0x00406560
00839ec1 : MOV byte ptr [ESP + 0x4cf0],0xa
00839ec9 : LEA ECX,[ESP + 0x38]
00839ecd : CALL 0x00406560
00839ed2 : MOV EDX,dword ptr [0x00da9894]
00839ed8 : MOV EAX,dword ptr [EDX]
00839eda : MOV ECX,dword ptr [EAX + 0x1a8]
00839ee0 : MOV EAX,dword ptr [ECX]
00839ee2 : MOV EAX,dword ptr [EAX + 0x44]
00839ee5 : PUSH 0x3
00839ee7 : LEA EDX,[ESP + 0x4aa8]
00839eee : PUSH EDX
00839eef : CALL EAX
00839ef1 : MOV byte ptr [ESP + 0x4cf0],0x2
00839ef9 : LEA ECX,[ESP + 0x4aa4]
00839f00 : CALL 0x00406560
00839f05 : MOV byte ptr [ESP + 0x4cf0],0x0
00839f0d : LEA ESI,[ESP + 0x14]
00839f11 : CALL 0x004042c0
00839f16 : MOV dword ptr [ESP + 0x4cf0],0xffffffff
00839f21 : LEA ECX,[ESP + 0x4ac0]
00839f28 : CALL 0x00406560
00839f2d : XOR EAX,EAX
00839f2f : JMP 0x0083a44f
00839f34 : MOV EAX,dword ptr [EBX + 0x14]
00839f37 : PUSH 0xc39820
00839f3c : MOV EDI,0x9
00839f41 : MOV ECX,EBX
00839f43 : CALL 0x00405bb0
00839f48 : TEST EAX,EAX
00839f4a : JZ 0x00839f60
00839f4c : MOV ESI,0xc39834
00839f51 : MOV ECX,EBX
00839f53 : CALL 0x00403810
00839f58 : TEST AL,AL
00839f5a : JZ 0x0083a02f
00839f60 : MOV ECX,dword ptr [ESP + 0x1c]
00839f64 : SUB ECX,EBX
00839f66 : MOV EAX,0x92492493
00839f6b : IMUL ECX
00839f6d : ADD EDX,ECX
00839f6f : SAR EDX,0x4
00839f72 : MOV ECX,EDX
00839f74 : SHR ECX,0x1f
00839f77 : ADD ECX,EDX
00839f79 : CMP ECX,0x4
00839f7c : JNZ 0x0083a02f
00839f82 : XORPS XMM0,XMM0
00839f85 : MOV EDI,0x8
00839f8a : MOVSS dword ptr [ESP + 0x64],XMM0
00839f90 : CMP dword ptr [EBX + 0x50],EDI
00839f93 : JC 0x00839f9a
00839f95 : MOV EAX,dword ptr [EBX + 0x3c]
00839f98 : JMP 0x00839f9d
00839f9a : LEA EAX,[EBX + 0x3c]
00839f9d : PUSH EAX
00839f9e : CALL 0x00638519
00839fa3 : FSTP float ptr [ESP + 0x58]
00839fa7 : XORPS XMM0,XMM0
00839faa : LEA ESI,[EBX + 0x54]
00839fad : ADD ESP,0x4
00839fb0 : MOVSS dword ptr [ESP + 0x58],XMM0
00839fb6 : CMP dword ptr [ESI + 0x18],EDI
00839fb9 : JC 0x00839fc0
00839fbb : MOV EAX,dword ptr [ESI + 0x4]
00839fbe : JMP 0x00839fc3
00839fc0 : LEA EAX,[ESI + 0x4]
00839fc3 : PUSH EAX
00839fc4 : CALL 0x00638519
00839fc9 : FSTP float ptr [ESP + 0x60]
00839fcd : MOV EDX,dword ptr [0x00da93ec]
00839fd3 : MOV EAX,dword ptr [EDX + 0xc]
00839fd6 : ADD ESP,0x4
00839fd9 : PUSH EAX
00839fda : LEA EAX,[ESP + 0x64]
00839fde : LEA ECX,[ESP + 0x58]
00839fe2 : CALL 0x007dec50
00839fe7 : XOR EAX,EAX
00839fe9 : PUSH 0x1fe
00839fee : PUSH EAX
00839fef : LEA ECX,[ESP + 0x4ae6]
00839ff6 : PUSH ECX
00839ff7 : MOV word ptr [ESP + 0x4ae8],AX
00839fff : CALL 0x0063b700
0083a004 : CVTTSS2SI EDX,dword ptr [ESP + 0x70]
0083a00a : ADD ESP,0xc
0083a00d : PUSH EDX
0083a00e : PUSH 0xc3983c
0083a013 : LEA EDX,[ESP + 0x4ae4]
0083a01a : CALL 0x0040e4a0
0083a01f : ADD ESP,0x8
0083a022 : PUSH ESI
0083a023 : LEA EDX,[ESP + 0x4ae0]
0083a02a : CALL 0x00405c00
0083a02f : PUSH 0xa00
0083a034 : LEA EAX,[ESP + 0xa8]
0083a03b : PUSH 0x0
0083a03d : PUSH EAX
0083a03e : CALL 0x0063b700
0083a043 : ADD ESP,0xc
0083a046 : PUSH 0x4000
0083a04b : LEA ECX,[ESP + 0xaa8]
0083a052 : PUSH 0x0
0083a054 : PUSH ECX
0083a055 : CALL 0x0063b700
0083a05a : MOV ECX,dword ptr [ESP + 0x28]
0083a05e : SUB ECX,EBX
0083a060 : MOV EAX,0x92492493
0083a065 : IMUL ECX
0083a067 : ADD EDX,ECX
0083a069 : SAR EDX,0x4
0083a06c : MOV EAX,EDX
0083a06e : SHR EAX,0x1f
0083a071 : ADD EAX,EDX
0083a073 : ADD ESP,0xc
0083a076 : MOV dword ptr [ESP + 0x28],0x1
0083a07e : MOV dword ptr [ESP + 0x24],EAX
0083a082 : CMP EAX,0x1
0083a085 : JBE 0x0083a1be
0083a08b : LEA ESI,[ESP + 0xba2]
0083a092 : LEA EDI,[EBX + 0x20]
0083a095 : CMP dword ptr [ESP + 0x28],0xa
0083a09a : JG 0x0083a1be
0083a0a0 : XOR EDX,EDX
0083a0a2 : PUSH -0x1
0083a0a4 : PUSH EDX
0083a0a5 : LEA EBX,[EDI + -0x4]
0083a0a8 : PUSH EBX
0083a0a9 : LEA ECX,[ESP + 0x4ab0]
0083a0b0 : MOV dword ptr [ESP + 0x4ac8],0x7
0083a0bb : MOV dword ptr [ESP + 0x4ac4],0x0
0083a0c6 : MOV word ptr [ESP + 0x4ab4],DX
0083a0ce : CALL 0x00405eb0
0083a0d3 : MOV byte ptr [ESP + 0x4cf0],0xb
0083a0db : CMP dword ptr [EDI + 0x14],0x8
0083a0df : JC 0x0083a0e5
0083a0e1 : MOV EAX,dword ptr [EDI]
0083a0e3 : JMP 0x0083a0e7
0083a0e5 : MOV EAX,EDI
0083a0e7 : CMP word ptr [EAX],0x24
0083a0eb : JNZ 0x0083a0ff
0083a0ed : MOV ECX,dword ptr [ESP + 0x2c]
0083a0f1 : LEA EAX,[ESP + 0x4aa4]
0083a0f8 : PUSH EAX
0083a0f9 : PUSH EBX
0083a0fa : CALL 0x0082da20
0083a0ff : CMP dword ptr [ESP + 0x4abc],0x8
0083a107 : MOV EAX,dword ptr [ESP + 0x4aa8]
0083a10e : JNC 0x0083a117
0083a110 : LEA EAX,[ESP + 0x4aa8]
0083a117 : PUSH 0x7f
0083a119 : PUSH EAX
0083a11a : LEA ECX,[ESI + 0xffffff02]
0083a120 : PUSH ECX
0083a121 : CALL 0x00634e39
0083a126 : MOV EAX,dword ptr [ESP + 0x4ab4]
0083a12d : XOR EDX,EDX
0083a12f : MOV EBX,0x8
0083a134 : ADD ESP,0xc
0083a137 : MOV word ptr [ESI],DX
0083a13a : CMP dword ptr [ESP + 0x4abc],EBX
0083a141 : JNC 0x0083a14a
0083a143 : LEA EAX,[ESP + 0x4aa8]
0083a14a : PUSH 0x7f
0083a14c : PUSH EAX
0083a14d : LEA EAX,[ESI + 0xfffff502]
0083a153 : PUSH EAX
0083a154 : CALL 0x00634e39
0083a159 : XOR ECX,ECX
0083a15b : ADD ESP,0xc
0083a15e : MOV word ptr [ESI + 0xfffff600],CX
0083a165 : MOV byte ptr [ESP + 0x4cf0],0x2
0083a16d : CMP dword ptr [ESP + 0x4abc],EBX
0083a174 : JC 0x0083a182
0083a176 : MOV ECX,dword ptr [ESP + 0x4aa8]
0083a17d : CALL 0x006f04e0
0083a182 : MOV EAX,dword ptr [ESP + 0x28]
0083a186 : INC EAX
0083a187 : XOR EDX,EDX
0083a189 : ADD EDI,0x1c
0083a18c : ADD ESI,0x100
0083a192 : MOV dword ptr [ESP + 0x4abc],0x7
0083a19d : MOV dword ptr [ESP + 0x4ab8],0x0
0083a1a8 : MOV word ptr [ESP + 0x4aa8],DX
0083a1b0 : MOV dword ptr [ESP + 0x28],EAX
0083a1b4 : CMP EAX,dword ptr [ESP + 0x24]
0083a1b8 : JC 0x0083a095
0083a1be : MOV EAX,FS:[0x2c]
0083a1c4 : MOV ECX,dword ptr [EAX]
0083a1c6 : MOVZX EAX,byte ptr [ECX + 0x18]
0083a1ca : INC EAX
0083a1cb : CDQ
0083a1cc : MOV ESI,0x3
0083a1d1 : IDIV ESI
0083a1d3 : MOV byte ptr [ECX + 0x18],DL
0083a1d6 : MOVZX EDX,DL
0083a1d9 : SHL EDX,0xd
0083a1dc : LEA EAX,[EDX + ECX*0x1 + 0x122cb8]
0083a1e3 : MOV dword ptr [ESP + 0x24],EAX
0083a1e7 : MOV byte ptr [ESP + 0x4cf0],0xc
0083a1ef : XOR EBX,EBX
0083a1f1 : CMP EAX,EBX
0083a1f3 : JZ 0x0083a21b
0083a1f5 : MOV dword ptr [EAX + 0x4],EBX
0083a1f8 : XOR ECX,ECX
0083a1fa : MOV word ptr [EAX],CX
0083a1fd : MOV byte ptr [EAX + 0x2],0x43
0083a201 : MOV byte ptr [EAX + 0x3],0x1
0083a205 : PXOR XMM0,XMM0
0083a209 : MOVQ qword ptr [EAX + 0x8],XMM0
0083a20e : MOVQ qword ptr [EAX + 0x10],XMM0
0083a213 : MOV dword ptr [EAX + 0x18],EBX
0083a216 : MOV dword ptr [EAX + 0x1c],EBX
0083a219 : MOV EBX,EAX
0083a21b : MOV byte ptr [ESP + 0x4cf0],0x2
0083a223 : MOV EAX,dword ptr [ESP + 0x34]
0083a227 : MOV EDX,dword ptr [EAX + 0x28]
0083a22a : ADD EAX,0x28
0083a22d : PUSH EAX
0083a22e : PUSH EBX
0083a22f : LEA ECX,[ESP + 0xac]
0083a236 : MOV dword ptr [EBX + 0x4],EDX
0083a239 : CALL 0x00839060
0083a23e : TEST EAX,EAX
0083a240 : JNZ 0x0083a2ae
0083a242 : MOV byte ptr [ESP + 0x4cf0],AL
0083a249 : MOV EAX,dword ptr [ESP + 0x24]
0083a24d : MOV ESI,dword ptr [ESP + 0x18]
0083a251 : MOV EDI,dword ptr [ESP + 0x1c]
0083a255 : PUSH EAX
0083a256 : MOV EAX,ESI
0083a258 : CALL 0x00405450
0083a25d : ADD ESP,0x4
0083a260 : MOV ECX,ESI
0083a262 : CALL 0x006f04e0
0083a2ae : MOV EAX,dword ptr [ESP + 0x2c]
0083a2b2 : XOR ESI,ESI
0083a2b4 : CMP dword ptr [EAX + 0x6c],ESI
0083a2b7 : JNZ 0x0083a3b2
0083a2bd : LEA EDI,[ESP + 0x4ac0]
0083a2c4 : MOV ESI,EAX
0083a2c6 : CALL 0x00831a60
0083a2cb : MOV EAX,dword ptr [ESP + 0x4ac4]
0083a2d2 : MOV EDI,0x8
0083a2d7 : CMP dword ptr [ESP + 0x4ad8],EDI
0083a2de : JNC 0x0083a2e7
0083a2e0 : LEA EAX,[ESP + 0x4ac4]
0083a2e7 : PUSH EAX
0083a2e8 : PUSH 0xc39848
0083a2ed : LEA ESI,[ESP + 0x4aac]
0083a2f4 : CALL 0x00404750
0083a2f9 : ADD ESP,0x8
0083a2fc : MOV byte ptr [ESP + 0x4cf0],0xd
0083a304 : MOV EAX,dword ptr [ESP + 0x4aa8]
0083a30b : CMP dword ptr [ESP + 0x4abc],EDI
0083a312 : JNC 0x0083a31b
0083a314 : LEA EAX,[ESP + 0x4aa8]
0083a31b : PUSH EAX
0083a31c : LEA ECX,[ESP + 0x3c]
0083a320 : CALL 0x00406460
0083a325 : MOV byte ptr [ESP + 0x4cf0],0xe
0083a32d : MOV EDX,dword ptr [0x00da9894]
0083a333 : MOV EAX,dword ptr [EDX]
0083a335 : MOV ECX,dword ptr [EAX + 0x1a8]
0083a33b : MOV EAX,dword ptr [ECX]
0083a33d : MOV EAX,dword ptr [EAX + 0x44]
0083a340 : PUSH 0x13
0083a342 : LEA EDX,[ESP + 0x3c]
0083a346 : PUSH EDX
0083a347 : CALL EAX
0083a349 : MOV byte ptr [ESP + 0x4cf0],0xd
0083a351 : CMP dword ptr [ESP + 0x50],EDI
0083a355 : JC 0x0083a360
0083a357 : MOV ECX,dword ptr [ESP + 0x3c]
0083a35b : CALL 0x006f04e0
0083a360 : MOV ESI,0x7
0083a365 : XOR EDI,EDI
0083a367 : XOR ECX,ECX
0083a369 : MOV dword ptr [ESP + 0x50],ESI
0083a36d : MOV dword ptr [ESP + 0x4c],EDI
0083a371 : MOV word ptr [ESP + 0x3c],CX
0083a376 : MOV byte ptr [ESP + 0x4cf0],0x2
0083a37e : CMP dword ptr [ESP + 0x4abc],0x8
0083a386 : JC 0x0083a394
0083a388 : MOV ECX,dword ptr [ESP + 0x4aa8]
0083a38f : CALL 0x006f04e0
0083a394 : MOV EAX,dword ptr [ESP + 0x2c]
0083a398 : XOR EDX,EDX
0083a39a : MOV dword ptr [ESP + 0x4abc],ESI
0083a3a1 : MOV dword ptr [ESP + 0x4ab8],EDI
0083a3a8 : MOV word ptr [ESP + 0x4aa8],DX
0083a3b0 : XOR ESI,ESI
0083a3b2 : MOV CX,word ptr [EBX + 0x1c]
0083a3b6 : ADD CX,0x10
0083a3ba : ADD CX,CX
0083a3bd : XOR CX,word ptr [EBX]
0083a3c0 : MOV EDX,0x1fff
0083a3c5 : AND CX,DX
0083a3c8 : XOR word ptr [EBX],CX
0083a3cb : MOV ECX,dword ptr [ESP + 0x30]
0083a3cf : MOV dword ptr [ECX],EBX
0083a3d1 : MOV dword ptr [EAX + 0xc0],0x1
0083a3db : MOV byte ptr [ESP + 0x4cf0],0x0
0083a3e3 : MOV EDX,dword ptr [ESP + 0x24]
0083a3e7 : MOV EBX,dword ptr [ESP + 0x18]
0083a3eb : MOV EDI,dword ptr [ESP + 0x1c]
0083a3ef : PUSH EDX
0083a3f0 : MOV EAX,EBX
0083a3f2 : CALL 0x00405450
0083a3f7 : ADD ESP,0x4
0083a3fa : MOV ECX,EBX
0083a3fc : CALL 0x006f04e0
0083a43f : MOV EAX,0x1
0083a444 : MOV dword ptr [ESP + 0x4ad8],0x7
0083a44f : MOV ECX,dword ptr [ESP + 0x4ce8]
0083a456 : MOV dword ptr FS:[0x0],ECX
0083a45d : POP ECX
0083a45e : POP EDI
0083a45f : POP ESI
0083a460 : POP EBX
0083a461 : MOV ECX,dword ptr [ESP + 0x4cd0]
0083a468 : XOR ECX,ESP
0083a46a : CALL 0x00633e6b
0083a46f : MOV ESP,EBP
0083a471 : POP EBP
0083a472 : RET 0x8

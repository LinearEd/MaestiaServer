PROGRAM  : Maestia.exe
FUNCTION : FUN_00a1bbd0
ENTRY    : 00a1bbd0
BODY     : [[00a1bbd0, 00a1bca9]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00a1bbd0(undefined4 param_1,int *param_2)

{
  LPCRITICAL_SECTION lpCriticalSection;
  int iVar1;
  int in_ECX;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b10c60;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if (in_ECX == 0x10) {
    iVar1 = 0;
  }
  else {
    iVar1 = in_ECX + 8;
  }
  lpCriticalSection = (LPCRITICAL_SECTION)(iVar1 + 4);
  EnterCriticalSection(lpCriticalSection);
  local_8 = 0;
  iVar1 = FUN_00a1a840(param_1);
  if (iVar1 == 0) {
    iVar1 = FUN_00a1a6d0(param_1);
    if (iVar1 == 0) {
      iVar1 = FUN_00a1a780(param_1);
      if (iVar1 == 0) {
        *param_2 = 0;
        local_8 = 0xffffffff;
        LeaveCriticalSection(lpCriticalSection);
        ExceptionList = local_10;
        return 0;
      }
    }
  }
  *param_2 = *(int *)(*(int *)(iVar1 + 0x138) + 8) + 0x138 + iVar1;
  local_8 = 0xffffffff;
  LeaveCriticalSection(lpCriticalSection);
  ExceptionList = local_10;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
00a1bbd0 : PUSH EBP
00a1bbd1 : MOV EBP,ESP
00a1bbd3 : PUSH -0x1
00a1bbd5 : PUSH 0xb10c60
00a1bbda : MOV EAX,FS:[0x0]
00a1bbe0 : PUSH EAX
00a1bbe1 : PUSH ECX
00a1bbe2 : PUSH EBX
00a1bbe3 : PUSH ESI
00a1bbe4 : PUSH EDI
00a1bbe5 : MOV EAX,[0x00d66fa0]
00a1bbea : XOR EAX,EBP
00a1bbec : PUSH EAX
00a1bbed : LEA EAX,[EBP + -0xc]
00a1bbf0 : MOV FS:[0x0],EAX
00a1bbf6 : MOV ESI,ECX
00a1bbf8 : LEA EAX,[ESI + -0x10]
00a1bbfb : TEST EAX,EAX
00a1bbfd : JZ 0x00a1bc04
00a1bbff : LEA EAX,[ESI + 0x8]
00a1bc02 : JMP 0x00a1bc06
00a1bc04 : XOR EAX,EAX
00a1bc06 : LEA EBX,[EAX + 0x4]
00a1bc09 : PUSH EBX
00a1bc0a : MOV dword ptr [EBP + -0x10],EAX
00a1bc0d : CALL dword ptr [0x00b85118]
00a1bc13 : MOV dword ptr [EBP + -0x4],0x0
00a1bc1a : MOV EDI,dword ptr [EBP + 0x8]
00a1bc1d : ADD ESI,-0x10
00a1bc20 : PUSH EDI
00a1bc21 : MOV ECX,ESI
00a1bc23 : CALL 0x00a1a840
00a1bc28 : TEST EAX,EAX
00a1bc2a : JNZ 0x00a1bc44
00a1bc2c : PUSH EDI
00a1bc2d : MOV ECX,ESI
00a1bc2f : CALL 0x00a1a6d0
00a1bc34 : TEST EAX,EAX
00a1bc36 : JNZ 0x00a1bc44
00a1bc38 : PUSH EDI
00a1bc39 : MOV ECX,ESI
00a1bc3b : CALL 0x00a1a780
00a1bc40 : TEST EAX,EAX
00a1bc42 : JZ 0x00a1bc7d
00a1bc44 : MOV ECX,dword ptr [EAX + 0x138]
00a1bc4a : MOV EDX,dword ptr [ECX + 0x8]
00a1bc4d : MOV ECX,dword ptr [EBP + 0xc]
00a1bc50 : LEA EAX,[EDX + EAX*0x1 + 0x138]
00a1bc57 : MOV dword ptr [ECX],EAX
00a1bc59 : MOV dword ptr [EBP + -0x4],0xffffffff
00a1bc60 : PUSH EBX
00a1bc61 : CALL dword ptr [0x00b8511c]
00a1bc67 : MOV AL,0x1
00a1bc69 : MOV ECX,dword ptr [EBP + -0xc]
00a1bc6c : MOV dword ptr FS:[0x0],ECX
00a1bc73 : POP ECX
00a1bc74 : POP EDI
00a1bc75 : POP ESI
00a1bc76 : POP EBX
00a1bc77 : MOV ESP,EBP
00a1bc79 : POP EBP
00a1bc7a : RET 0x8
00a1bc7d : MOV EDX,dword ptr [EBP + 0xc]
00a1bc80 : MOV dword ptr [EDX],0x0
00a1bc86 : MOV dword ptr [EBP + -0x4],0xffffffff
00a1bc8d : PUSH EBX
00a1bc8e : CALL dword ptr [0x00b8511c]
00a1bc94 : XOR AL,AL
00a1bc96 : MOV ECX,dword ptr [EBP + -0xc]
00a1bc99 : MOV dword ptr FS:[0x0],ECX
00a1bca0 : POP ECX
00a1bca1 : POP EDI
00a1bca2 : POP ESI
00a1bca3 : POP EBX
00a1bca4 : MOV ESP,EBP
00a1bca6 : POP EBP
00a1bca7 : RET 0x8

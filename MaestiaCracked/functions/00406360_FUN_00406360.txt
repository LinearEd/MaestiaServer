PROGRAM  : Maestia.exe
FUNCTION : FUN_00406360
ENTRY    : 00406360
BODY     : [[00406360, 0040645d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00406360(undefined4 *param_1,uint param_2)

{
  uint uVar1;
  rsize_t _MaxCount;
  undefined4 *puVar2;
  void *_Dst;
  int in_ECX;
  undefined4 *puVar3;
  
  if (param_1 != (undefined4 *)0x0) {
    uVar1 = *(uint *)(in_ECX + 0x18);
    puVar2 = (undefined4 *)(in_ECX + 4);
    puVar3 = puVar2;
    if (7 < uVar1) {
      puVar3 = (undefined4 *)*puVar2;
    }
    if (puVar3 <= param_1) {
      puVar3 = puVar2;
      if (7 < uVar1) {
        puVar3 = (undefined4 *)*puVar2;
      }
      if (param_1 < (undefined4 *)((int)puVar3 + *(int *)(in_ECX + 0x14) * 2)) {
        if (7 < uVar1) {
          puVar2 = (undefined4 *)*puVar2;
        }
        FUN_00405eb0(in_ECX,(int)param_1 - (int)puVar2 >> 1,param_2);
        return;
      }
    }
  }
  if (0x7ffffffe < param_2) {
    FUN_00622ecf();
  }
  if (*(uint *)(in_ECX + 0x18) < param_2) {
    FUN_00406170(param_2,*(undefined4 *)(in_ECX + 0x14));
  }
  else if (param_2 == 0) {
    *(undefined4 *)(in_ECX + 0x14) = 0;
    if (*(uint *)(in_ECX + 0x18) < 8) {
      *(undefined2 *)(in_ECX + 4) = 0;
      return;
    }
    **(undefined2 **)(in_ECX + 4) = 0;
    return;
  }
  if (param_2 != 0) {
    if (*(uint *)(in_ECX + 0x18) < 8) {
      _Dst = (void *)(in_ECX + 4);
    }
    else {
      _Dst = *(void **)(in_ECX + 4);
    }
    _MaxCount = param_2 * 2;
    _memcpy_s(_Dst,*(uint *)(in_ECX + 0x18) * 2,param_1,_MaxCount);
    *(uint *)(in_ECX + 0x14) = param_2;
    if (7 < *(uint *)(in_ECX + 0x18)) {
      *(undefined2 *)(_MaxCount + *(int *)(in_ECX + 4)) = 0;
      return;
    }
    *(undefined2 *)(_MaxCount + in_ECX + 4) = 0;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00406360 : PUSH EBP
00406361 : MOV EBP,ESP
00406363 : PUSH EBX
00406364 : PUSH ESI
00406365 : MOV ESI,ECX
00406367 : MOV ECX,dword ptr [EBP + 0x8]
0040636a : PUSH EDI
0040636b : TEST ECX,ECX
0040636d : JZ 0x004063b8
0040636f : MOV EDI,dword ptr [ESI + 0x18]
00406372 : LEA EAX,[ESI + 0x4]
00406375 : CMP EDI,0x8
00406378 : JC 0x0040637e
0040637a : MOV EDX,dword ptr [EAX]
0040637c : JMP 0x00406380
0040637e : MOV EDX,EAX
00406380 : CMP ECX,EDX
00406382 : JC 0x004063b8
00406384 : CMP EDI,0x8
00406387 : JC 0x0040638d
00406389 : MOV EDX,dword ptr [EAX]
0040638b : JMP 0x0040638f
0040638d : MOV EDX,EAX
0040638f : MOV EBX,dword ptr [ESI + 0x14]
00406392 : LEA EDX,[EDX + EBX*0x2]
00406395 : CMP EDX,ECX
00406397 : JBE 0x004063b8
00406399 : CMP EDI,0x8
0040639c : JC 0x004063a0
0040639e : MOV EAX,dword ptr [EAX]
004063a0 : MOV EDX,dword ptr [EBP + 0xc]
004063a3 : SUB ECX,EAX
004063a5 : PUSH EDX
004063a6 : SAR ECX,0x1
004063a8 : PUSH ECX
004063a9 : PUSH ESI
004063aa : MOV ECX,ESI
004063ac : CALL 0x00405eb0
004063b1 : POP EDI
004063b2 : POP ESI
004063b3 : POP EBX
004063b4 : POP EBP
004063b5 : RET 0x8
004063b8 : MOV EDI,dword ptr [EBP + 0xc]
004063bb : CMP EDI,0x7ffffffe
004063c1 : JBE 0x004063c8
004063c3 : CALL 0x00622ecf
004063c8 : MOV EAX,dword ptr [ESI + 0x18]
004063cb : CMP EAX,EDI
004063cd : JNC 0x004063ec
004063cf : MOV EAX,dword ptr [ESI + 0x14]
004063d2 : PUSH EAX
004063d3 : PUSH EDI
004063d4 : MOV ECX,ESI
004063d6 : CALL 0x00406170
004063db : TEST EDI,EDI
004063dd : JBE 0x00406455
004063df : MOV ECX,dword ptr [ESI + 0x18]
004063e2 : CMP ECX,0x8
004063e5 : JC 0x0040641a
004063e7 : MOV EAX,dword ptr [ESI + 0x4]
004063ea : JMP 0x0040641d
004063ec : TEST EDI,EDI
004063ee : JNZ 0x004063dd
004063f0 : MOV dword ptr [ESI + 0x14],EDI
004063f3 : CMP EAX,0x8
004063f6 : JC 0x00406409
004063f8 : MOV EAX,dword ptr [ESI + 0x4]
004063fb : XOR ECX,ECX
004063fd : POP EDI
004063fe : MOV word ptr [EAX],CX
00406401 : MOV EAX,ESI
00406403 : POP ESI
00406404 : POP EBX
00406405 : POP EBP
00406406 : RET 0x8
00406409 : LEA EAX,[ESI + 0x4]
0040640c : XOR ECX,ECX
0040640e : POP EDI
0040640f : MOV word ptr [EAX],CX
00406412 : MOV EAX,ESI
00406414 : POP ESI
00406415 : POP EBX
00406416 : POP EBP
00406417 : RET 0x8
0040641a : LEA EAX,[ESI + 0x4]
0040641d : MOV EDX,dword ptr [EBP + 0x8]
00406420 : LEA EBX,[EDI + EDI*0x1]
00406423 : PUSH EBX
00406424 : PUSH EDX
00406425 : ADD ECX,ECX
00406427 : PUSH ECX
00406428 : PUSH EAX
00406429 : CALL 0x00633ea4
0040642e : ADD ESP,0x10
00406431 : CMP dword ptr [ESI + 0x18],0x8
00406435 : MOV dword ptr [ESI + 0x14],EDI
00406438 : JC 0x0040644c
0040643a : MOV EAX,dword ptr [ESI + 0x4]
0040643d : XOR EDX,EDX
0040643f : MOV word ptr [EBX + EAX*0x1],DX
00406443 : POP EDI
00406444 : MOV EAX,ESI
00406446 : POP ESI
00406447 : POP EBX
00406448 : POP EBP
00406449 : RET 0x8
0040644c : LEA EAX,[ESI + 0x4]
0040644f : XOR EDX,EDX
00406451 : MOV word ptr [EBX + EAX*0x1],DX
00406455 : POP EDI
00406456 : MOV EAX,ESI
00406458 : POP ESI
00406459 : POP EBX
0040645a : POP EBP
0040645b : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_00678490
ENTRY    : 00678490
BODY     : [[00678490, 0067857b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00678490(undefined4 param_1)

{
  int *piVar1;
  int iVar2;
  LONG LVar3;
  undefined4 *in_ECX;
  uint local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  undefined4 local_4;
  
  *in_ECX = &PTR_FUN_00cd3f2c;
  in_ECX[1] = 1;
  in_ECX[2] = 0x14;
  *in_ECX = &PTR_FUN_00bd62f4;
  in_ECX[3] = 0;
  in_ECX[4] = 0;
  in_ECX[5] = 0;
  in_ECX[6] = param_1;
  in_ECX[7] = 1;
  *(undefined1 *)(in_ECX + 8) = 0;
  *(undefined1 *)((int)in_ECX + 0x21) = 0x60;
  *(undefined1 *)((int)in_ECX + 0x22) = 0xc0;
  *(undefined1 *)((int)in_ECX + 0x23) = 0xf0;
  *(undefined1 *)(in_ECX + 9) = 0xff;
  piVar1 = in_ECX + 0x48;
  *piVar1 = 0;
  in_ECX[0x49] = 0;
  in_ECX[0x4a] = 0;
  FUN_0051b6e0();
  local_10 = 1;
  local_c = 0;
  local_8 = 0x18;
  local_4 = 0x18;
  FUN_00677450(piVar1,in_ECX[0x49] + 1);
  iVar2 = *piVar1 + -0x14 + in_ECX[0x49] * 0x14;
  if (iVar2 != 0) {
    FUN_0051c600(&local_14);
    *(undefined4 *)(iVar2 + 4) = local_10;
    *(undefined4 *)(iVar2 + 8) = local_c;
    *(undefined4 *)(iVar2 + 0xc) = local_8;
    *(undefined4 *)(iVar2 + 0x10) = local_4;
  }
  LVar3 = InterlockedExchangeAdd((LONG *)((local_14 & 0xfffffffc) + 4),-1);
  if (LVar3 == 1) {
    FUN_00515cf0(local_14 & 0xfffffffc);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00678490 : SUB ESP,0x14
00678493 : MOV EAX,dword ptr [ESP + 0x18]
00678497 : PUSH EBX
00678498 : XOR EBX,EBX
0067849a : PUSH ESI
0067849b : MOV ESI,ECX
0067849d : MOV dword ptr [ESI],0xcd3f2c
006784a3 : MOV dword ptr [ESI + 0x4],0x1
006784aa : MOV dword ptr [ESI + 0x8],0x14
006784b1 : MOV dword ptr [ESI],0xbd62f4
006784b7 : MOV dword ptr [ESI + 0xc],EBX
006784ba : MOV dword ptr [ESI + 0x10],EBX
006784bd : MOV dword ptr [ESI + 0x14],EBX
006784c0 : PUSH EDI
006784c1 : MOV dword ptr [ESI + 0x18],EAX
006784c4 : MOV dword ptr [ESI + 0x1c],0x1
006784cb : MOV byte ptr [ESI + 0x20],BL
006784ce : MOV byte ptr [ESI + 0x21],0x60
006784d2 : MOV byte ptr [ESI + 0x22],0xc0
006784d6 : MOV byte ptr [ESI + 0x23],0xf0
006784da : MOV byte ptr [ESI + 0x24],0xff
006784de : LEA EDI,[ESI + 0x120]
006784e4 : MOV dword ptr [EDI],EBX
006784e6 : MOV dword ptr [EDI + 0x4],EBX
006784e9 : LEA ECX,[ESP + 0xc]
006784ed : MOV dword ptr [EDI + 0x8],EBX
006784f0 : CALL 0x0051b6e0
006784f5 : MOV ECX,dword ptr [EDI + 0x4]
006784f8 : INC ECX
006784f9 : PUSH ECX
006784fa : MOV EAX,0x18
006784ff : PUSH EDI
00678500 : MOV ECX,EDI
00678502 : MOV dword ptr [ESP + 0x18],0x1
0067850a : MOV dword ptr [ESP + 0x1c],EBX
0067850e : MOV dword ptr [ESP + 0x20],EAX
00678512 : MOV dword ptr [ESP + 0x24],EAX
00678516 : CALL 0x00677450
0067851b : MOV EAX,dword ptr [EDI + 0x4]
0067851e : LEA EDX,[EAX + EAX*0x4]
00678521 : MOV EAX,dword ptr [EDI]
00678523 : LEA EDI,[EAX + EDX*0x4 + -0x14]
00678527 : CMP EDI,EBX
00678529 : JZ 0x00678553
0067852b : LEA ECX,[ESP + 0xc]
0067852f : PUSH ECX
00678530 : MOV ECX,EDI
00678532 : CALL 0x0051c600
00678537 : MOV EDX,dword ptr [ESP + 0x10]
0067853b : MOV dword ptr [EDI + 0x4],EDX
0067853e : MOV EAX,dword ptr [ESP + 0x14]
00678542 : MOV dword ptr [EDI + 0x8],EAX
00678545 : MOV ECX,dword ptr [ESP + 0x18]
00678549 : MOV dword ptr [EDI + 0xc],ECX
0067854c : MOV EDX,dword ptr [ESP + 0x1c]
00678550 : MOV dword ptr [EDI + 0x10],EDX
00678553 : MOV EDI,dword ptr [ESP + 0xc]
00678557 : AND EDI,0xfffffffc
0067855a : PUSH -0x1
0067855c : LEA EAX,[EDI + 0x4]
0067855f : PUSH EAX
00678560 : CALL dword ptr [0x00b851cc]
00678566 : SUB EAX,0x1
00678569 : JNZ 0x00678571
0067856b : PUSH EDI
0067856c : CALL 0x00515cf0
00678571 : POP EDI
00678572 : MOV EAX,ESI
00678574 : POP ESI
00678575 : POP EBX
00678576 : ADD ESP,0x14
00678579 : RET 0x4

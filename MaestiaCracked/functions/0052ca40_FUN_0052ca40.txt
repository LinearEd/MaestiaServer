PROGRAM  : Maestia.exe
FUNCTION : FUN_0052ca40
ENTRY    : 0052ca40
BODY     : [[0052ca40, 0052cd2d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0052ca40(int param_1)

{
  int iVar1;
  byte bVar2;
  char cVar3;
  int *piVar4;
  char *pcVar5;
  int *piVar6;
  int iVar7;
  int iVar8;
  undefined4 uVar9;
  int local_2c;
  uint local_28;
  int local_24;
  int iStack_20;
  int local_1c;
  int iStack_18;
  int local_14;
  undefined4 local_10;
  int *local_c;
  int local_8;
  byte local_4;
  byte local_3;
  
  iVar1 = param_1;
  iVar8 = *(int *)(param_1 + 0x18);
  local_28 = (uint)*(byte *)(iVar8 + 0x7c);
  FUN_00526260(0);
  piVar4 = (int *)FUN_005270f0(iVar8);
  if (piVar4 != (int *)0x0) {
    pcVar5 = (char *)FUN_00526260(1);
    cVar3 = *pcVar5;
    local_2c = 0;
    if (cVar3 == '\x05') {
      FUN_005272e0(&local_24,*(undefined4 *)(param_1 + 0x18),0xffffffff,0);
      piVar6 = (int *)FUN_005b2c50(&local_1c,*(undefined4 *)(param_1 + 0x18),&local_24,&DAT_00b8b334
                                   ,0x3fffffff);
      iVar8 = *piVar6;
      if (iVar8 != 0) {
        *(uint *)(iVar8 + 8) = *(int *)(iVar8 + 8) + 1U & 0x8fffffff;
      }
      local_2c = *piVar6;
      if (local_1c != 0) {
        FUN_00503db0();
      }
      *(int *)(local_24 + 8) = *(int *)(local_24 + 8) + -1;
      if (*(int *)(local_24 + 8) == 0) {
        FUN_00525340();
      }
    }
    else if (cVar3 == '\x06') {
      uVar9 = *(undefined4 *)(param_1 + 0x18);
      FUN_00526260(1);
      iVar8 = FUN_00526fa0(uVar9);
      if (iVar8 != 0) {
        iVar7 = (**(code **)(*(int *)(iVar8 + 0x10) + 8))();
        if (iVar7 == 7) {
          *(uint *)(iVar8 + 8) = *(int *)(iVar8 + 8) + 1U & 0x8fffffff;
          local_2c = iVar8;
        }
        else {
          iVar8 = (**(code **)(*(int *)(iVar8 + 0x10) + 8))();
          if (iVar8 != 8) {
            return;
          }
          FUN_005272e0(&iStack_20,*(undefined4 *)(param_1 + 0x18),0xffffffff,0);
          piVar6 = (int *)FUN_005b2c50(&iStack_18,*(undefined4 *)(param_1 + 0x18),&iStack_20,
                                       &DAT_00b8b334,0x3fffffff);
          iVar8 = *piVar6;
          if (iVar8 != 0) {
            *(uint *)(iVar8 + 8) = *(int *)(iVar8 + 8) + 1U & 0x8fffffff;
          }
          local_2c = *piVar6;
          if (iStack_18 != 0) {
            FUN_00503db0();
          }
          *(int *)(iStack_20 + 8) = *(int *)(iStack_20 + 8) + -1;
          if (*(int *)(iStack_20 + 8) == 0) {
            FUN_00525340();
          }
        }
      }
    }
    else if (cVar3 != '\x01') {
      return;
    }
    uVar9 = *(undefined4 *)(param_1 + 0x18);
    FUN_00526260(2);
    local_4 = FUN_00527990(uVar9);
    piVar6 = (int *)(param_1 + 0x1c);
    param_1._0_1_ = local_4 & 7;
    if (*piVar6 == 3) {
      bVar2 = (local_28 != 5) - 1;
    }
    else {
      uVar9 = *(undefined4 *)(iVar1 + 0x18);
      FUN_00526260(3);
      bVar2 = FUN_00527a80(uVar9);
    }
    local_4 = local_4 & 7;
    iVar8 = *(int *)(iVar1 + 0x18) + 0x78;
    if (local_2c == 0) {
      local_10 = &PTR_LAB_00b8b164;
      local_c = piVar4;
      local_8 = iVar8;
      local_3 = bVar2 & 7;
      (**(code **)(*piVar4 + 0x20))(iVar8,&local_10,4);
      return;
    }
    local_14 = *(int *)(local_2c + 0x38);
    iVar7 = 0;
    if (0 < local_14) {
      do {
        if (*(int *)(*(int *)(local_2c + 0x34) + iVar7 * 4) != 0) {
          FUN_005272e0(&local_28,*(undefined4 *)(iVar1 + 0x18),0xffffffff,0);
          local_10 = (undefined **)((uint)local_10 & 0xffff0000);
          cVar3 = (**(code **)(*piVar4 + 0x14))(iVar8,&local_28,&local_10);
          if (cVar3 != '\0') {
            (**(code **)(*piVar4 + 0x1c))
                      (iVar8,&local_28,~(bVar2 & 7) & local_10._1_1_ | (byte)param_1);
          }
          FUN_00526bc0();
          *(int *)(local_28 + 8) = *(int *)(local_28 + 8) + -1;
          if (*(int *)(local_28 + 8) == 0) {
            FUN_00525340();
          }
        }
        iVar7 = iVar7 + 1;
      } while (iVar7 < local_14);
    }
    FUN_00503db0();
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
0052ca40 : SUB ESP,0x30
0052ca43 : PUSH EBX
0052ca44 : PUSH ESI
0052ca45 : MOV ESI,dword ptr [ESP + 0x3c]
0052ca49 : MOV EAX,dword ptr [ESI + 0x18]
0052ca4c : MOVZX ECX,byte ptr [EAX + 0x7c]
0052ca50 : PUSH EAX
0052ca51 : MOV dword ptr [ESP + 0x14],ECX
0052ca55 : PUSH 0x0
0052ca57 : MOV ECX,ESI
0052ca59 : CALL 0x00526260
0052ca5e : MOV ECX,EAX
0052ca60 : CALL 0x005270f0
0052ca65 : MOV EBX,EAX
0052ca67 : MOV dword ptr [ESP + 0x3c],EBX
0052ca6b : TEST EBX,EBX
0052ca6d : JZ 0x0052cd28
0052ca73 : PUSH EBP
0052ca74 : PUSH EDI
0052ca75 : PUSH 0x1
0052ca77 : MOV ECX,ESI
0052ca79 : CALL 0x00526260
0052ca7e : MOV EDI,EAX
0052ca80 : MOV AL,byte ptr [EDI]
0052ca82 : MOV dword ptr [ESP + 0x14],0x0
0052ca8a : CMP AL,0x5
0052ca8c : JNZ 0x0052cb00
0052ca8e : MOV EDX,dword ptr [ESI + 0x18]
0052ca91 : PUSH 0x0
0052ca93 : PUSH -0x1
0052ca95 : PUSH EDX
0052ca96 : LEA EAX,[ESP + 0x28]
0052ca9a : PUSH EAX
0052ca9b : MOV ECX,EDI
0052ca9d : CALL 0x005272e0
0052caa2 : MOV EDX,dword ptr [ESI + 0x18]
0052caa5 : PUSH 0x3fffffff
0052caaa : PUSH 0xb8b334
0052caaf : LEA ECX,[ESP + 0x24]
0052cab3 : PUSH ECX
0052cab4 : PUSH EDX
0052cab5 : LEA EAX,[ESP + 0x34]
0052cab9 : PUSH EAX
0052caba : CALL 0x005b2c50
0052cabf : MOV ECX,dword ptr [EAX]
0052cac1 : ADD ESP,0x14
0052cac4 : TEST ECX,ECX
0052cac6 : JZ 0x0052cad5
0052cac8 : MOV EDX,dword ptr [ECX + 0x8]
0052cacb : INC EDX
0052cacc : AND EDX,0x8fffffff
0052cad2 : MOV dword ptr [ECX + 0x8],EDX
0052cad5 : MOV ECX,dword ptr [ESP + 0x24]
0052cad9 : MOV EAX,dword ptr [EAX]
0052cadb : MOV dword ptr [ESP + 0x14],EAX
0052cadf : TEST ECX,ECX
0052cae1 : JZ 0x0052cae8
0052cae3 : CALL 0x00503db0
0052cae8 : MOV EAX,dword ptr [ESP + 0x1c]
0052caec : DEC dword ptr [EAX + 0x8]
0052caef : MOV ECX,EAX
0052caf1 : ADD EAX,0x8
0052caf4 : CMP dword ptr [EAX],0x0
0052caf7 : JNZ 0x0052cb49
0052caf9 : CALL 0x00525340
0052cafe : JMP 0x0052cb49
0052cb00 : CMP AL,0x6
0052cb02 : JNZ 0x0052cc0b
0052cb08 : MOV ECX,dword ptr [ESI + 0x18]
0052cb0b : PUSH ECX
0052cb0c : PUSH 0x1
0052cb0e : MOV ECX,ESI
0052cb10 : CALL 0x00526260
0052cb15 : MOV ECX,EAX
0052cb17 : CALL 0x00526fa0
0052cb1c : MOV EBP,EAX
0052cb1e : TEST EBP,EBP
0052cb20 : JZ 0x0052cb49
0052cb22 : MOV EDX,dword ptr [EBP + 0x10]
0052cb25 : MOV EAX,dword ptr [EDX + 0x8]
0052cb28 : LEA EBX,[EBP + 0x10]
0052cb2b : MOV ECX,EBX
0052cb2d : CALL EAX
0052cb2f : CMP EAX,0x7
0052cb32 : JNZ 0x0052cb80
0052cb34 : MOV ECX,dword ptr [EBP + 0x8]
0052cb37 : INC ECX
0052cb38 : AND ECX,0x8fffffff
0052cb3e : MOV dword ptr [EBP + 0x8],ECX
0052cb41 : MOV dword ptr [ESP + 0x14],EBP
0052cb45 : MOV EBX,dword ptr [ESP + 0x44]
0052cb49 : MOV ECX,dword ptr [ESI + 0x18]
0052cb4c : PUSH ECX
0052cb4d : PUSH 0x2
0052cb4f : MOV ECX,ESI
0052cb51 : CALL 0x00526260
0052cb56 : MOV ECX,EAX
0052cb58 : CALL 0x00527990
0052cb5d : MOV ECX,EAX
0052cb5f : AND CL,0x7
0052cb62 : CMP dword ptr [ESI + 0x1c],0x3
0052cb66 : MOV byte ptr [ESP + 0x44],CL
0052cb6a : JNZ 0x0052cc18
0052cb70 : XOR EAX,EAX
0052cb72 : CMP dword ptr [ESP + 0x18],0x5
0052cb77 : SETNZ AL
0052cb7a : DEC EAX
0052cb7b : JMP 0x0052cc30
0052cb80 : MOV EDX,dword ptr [EBX]
0052cb82 : MOV EAX,dword ptr [EDX + 0x8]
0052cb85 : MOV ECX,EBX
0052cb87 : CALL EAX
0052cb89 : CMP EAX,0x8
0052cb8c : JNZ 0x0052cd26
0052cb92 : MOV ECX,dword ptr [ESI + 0x18]
0052cb95 : PUSH 0x0
0052cb97 : PUSH -0x1
0052cb99 : PUSH ECX
0052cb9a : LEA EDX,[ESP + 0x2c]
0052cb9e : PUSH EDX
0052cb9f : MOV ECX,EDI
0052cba1 : CALL 0x005272e0
0052cba6 : MOV ECX,dword ptr [ESI + 0x18]
0052cba9 : PUSH 0x3fffffff
0052cbae : PUSH 0xb8b334
0052cbb3 : LEA EAX,[ESP + 0x28]
0052cbb7 : PUSH EAX
0052cbb8 : PUSH ECX
0052cbb9 : LEA EDX,[ESP + 0x38]
0052cbbd : PUSH EDX
0052cbbe : CALL 0x005b2c50
0052cbc3 : MOV ECX,dword ptr [EAX]
0052cbc5 : ADD ESP,0x14
0052cbc8 : TEST ECX,ECX
0052cbca : JZ 0x0052cbd9
0052cbcc : MOV EDX,dword ptr [ECX + 0x8]
0052cbcf : INC EDX
0052cbd0 : AND EDX,0x8fffffff
0052cbd6 : MOV dword ptr [ECX + 0x8],EDX
0052cbd9 : MOV ECX,dword ptr [ESP + 0x28]
0052cbdd : MOV EAX,dword ptr [EAX]
0052cbdf : MOV dword ptr [ESP + 0x14],EAX
0052cbe3 : TEST ECX,ECX
0052cbe5 : JZ 0x0052cbec
0052cbe7 : CALL 0x00503db0
0052cbec : MOV EAX,dword ptr [ESP + 0x20]
0052cbf0 : DEC dword ptr [EAX + 0x8]
0052cbf3 : MOV ECX,EAX
0052cbf5 : ADD EAX,0x8
0052cbf8 : CMP dword ptr [EAX],0x0
0052cbfb : JNZ 0x0052cb45
0052cc01 : CALL 0x00525340
0052cc06 : JMP 0x0052cb45
0052cc0b : CMP AL,0x1
0052cc0d : JNZ 0x0052cd26
0052cc13 : JMP 0x0052cb49
0052cc18 : MOV EDX,dword ptr [ESI + 0x18]
0052cc1b : PUSH EDX
0052cc1c : PUSH 0x3
0052cc1e : MOV ECX,ESI
0052cc20 : CALL 0x00526260
0052cc25 : MOV ECX,EAX
0052cc27 : CALL 0x00527a80
0052cc2c : MOV CL,byte ptr [ESP + 0x44]
0052cc30 : MOV EDI,dword ptr [ESI + 0x18]
0052cc33 : AND AL,0x7
0052cc35 : ADD EDI,0x78
0052cc38 : CMP dword ptr [ESP + 0x14],0x0
0052cc3d : MOV byte ptr [ESP + 0x13],AL
0052cc41 : JNZ 0x0052cc74
0052cc43 : MOV byte ptr [ESP + 0x3c],CL
0052cc47 : PUSH 0x4
0052cc49 : LEA ECX,[ESP + 0x34]
0052cc4d : MOV byte ptr [ESP + 0x41],AL
0052cc51 : MOV EAX,dword ptr [EBX]
0052cc53 : MOV EDX,dword ptr [EAX + 0x20]
0052cc56 : PUSH ECX
0052cc57 : PUSH EDI
0052cc58 : MOV ECX,EBX
0052cc5a : MOV dword ptr [ESP + 0x3c],0xb8b164
0052cc62 : MOV dword ptr [ESP + 0x40],EBX
0052cc66 : MOV dword ptr [ESP + 0x44],EDI
0052cc6a : CALL EDX
0052cc6c : POP EDI
0052cc6d : POP EBP
0052cc6e : POP ESI
0052cc6f : POP EBX
0052cc70 : ADD ESP,0x30
0052cc73 : RET
0052cc74 : MOV EAX,dword ptr [ESP + 0x14]
0052cc78 : MOV EAX,dword ptr [EAX + 0x38]
0052cc7b : XOR EBP,EBP
0052cc7d : MOV dword ptr [ESP + 0x2c],EAX
0052cc81 : TEST EAX,EAX
0052cc83 : JLE 0x0052cd1d
0052cc89 : LEA ESP,[ESP]
0052cc90 : MOV ECX,dword ptr [ESP + 0x14]
0052cc94 : MOV EDX,dword ptr [ECX + 0x34]
0052cc97 : MOV ECX,dword ptr [EDX + EBP*0x4]
0052cc9a : TEST ECX,ECX
0052cc9c : JZ 0x0052cd12
0052cc9e : MOV EAX,dword ptr [ESI + 0x18]
0052cca1 : PUSH 0x0
0052cca3 : PUSH -0x1
0052cca5 : PUSH EAX
0052cca6 : LEA EDX,[ESP + 0x24]
0052ccaa : PUSH EDX
0052ccab : CALL 0x005272e0
0052ccb0 : MOV EAX,dword ptr [EBX]
0052ccb2 : MOV EAX,dword ptr [EAX + 0x14]
0052ccb5 : LEA ECX,[ESP + 0x30]
0052ccb9 : PUSH ECX
0052ccba : LEA EDX,[ESP + 0x1c]
0052ccbe : PUSH EDX
0052ccbf : PUSH EDI
0052ccc0 : MOV ECX,EBX
0052ccc2 : MOV byte ptr [ESP + 0x3c],0x0
0052ccc7 : MOV byte ptr [ESP + 0x3d],0x0
0052cccc : CALL EAX
0052ccce : TEST AL,AL
0052ccd0 : JZ 0x0052ccf3
0052ccd2 : MOV AL,byte ptr [ESP + 0x13]
0052ccd6 : MOV EDX,dword ptr [EBX]
0052ccd8 : MOV EDX,dword ptr [EDX + 0x1c]
0052ccdb : NOT AL
0052ccdd : AND AL,byte ptr [ESP + 0x31]
0052cce1 : OR AL,byte ptr [ESP + 0x44]
0052cce5 : MOVZX ECX,AL
0052cce8 : PUSH ECX
0052cce9 : LEA EAX,[ESP + 0x1c]
0052cced : PUSH EAX
0052ccee : PUSH EDI
0052ccef : MOV ECX,EBX
0052ccf1 : CALL EDX
0052ccf3 : LEA ECX,[ESP + 0x30]
0052ccf7 : CALL 0x00526bc0
0052ccfc : MOV EAX,dword ptr [ESP + 0x18]
0052cd00 : DEC dword ptr [EAX + 0x8]
0052cd03 : MOV ECX,EAX
0052cd05 : ADD EAX,0x8
0052cd08 : CMP dword ptr [EAX],0x0
0052cd0b : JNZ 0x0052cd12
0052cd0d : CALL 0x00525340
0052cd12 : INC EBP
0052cd13 : CMP EBP,dword ptr [ESP + 0x2c]
0052cd17 : JL 0x0052cc90
0052cd1d : MOV ECX,dword ptr [ESP + 0x14]
0052cd21 : CALL 0x00503db0
0052cd26 : POP EDI
0052cd27 : POP EBP
0052cd28 : POP ESI
0052cd29 : POP EBX
0052cd2a : ADD ESP,0x30
0052cd2d : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_0052add0
ENTRY    : 0052add0
BODY     : [[0052add0, 0052ae3c] [0052ae40, 0052af39]]

============================================================
DECOMPILED C CODE
============================================================

int * FUN_0052add0(undefined4 *param_1,byte param_2)

{
  int *piVar1;
  char cVar2;
  char *pcVar3;
  int iVar4;
  int in_ECX;
  char *pcVar5;
  int local_c;
  int *local_8;
  uint local_4;
  
  if (((undefined4 *)*param_1)[4] == 0) {
    if ((*(byte *)(in_ECX + 0xc6) & 2) != 0) {
      return (int *)0x0;
    }
    return *(int **)(in_ECX + 0x74);
  }
  local_8 = *(int **)(in_ECX + 0x74);
  pcVar5 = *(char **)*param_1;
  local_c = *(int *)(*(int *)(in_ECX + 0x78) + 8);
  *(int *)(local_c + 8) = *(int *)(local_c + 8) + 1;
  if (*pcVar5 == '/') {
    local_8 = (int *)(**(code **)(*local_8 + 0x54))(0);
    pcVar5 = pcVar5 + 1;
  }
  local_4 = CONCAT31(local_4._1_3_,1);
  do {
    cVar2 = *pcVar5;
    pcVar3 = pcVar5;
    while (cVar2 != '\0') {
      if (*pcVar3 == '.') {
        if (pcVar3[1] != '.') goto LAB_0052ae5c;
        pcVar3 = pcVar3 + 1;
      }
      else if (*pcVar3 == '/') goto LAB_0052ae5c;
      pcVar3 = pcVar3 + 1;
      cVar2 = *pcVar3;
    }
    pcVar3 = (char *)0x0;
LAB_0052ae5c:
    if (pcVar3 == pcVar5) {
      if ((param_2 & 4) == 0) {
        FUN_0052ab30();
      }
LAB_0052af16:
      *(int *)(local_c + 8) = *(int *)(local_c + 8) + -1;
      if (*(int *)(local_c + 8) == 0) {
        FUN_00525340();
      }
      return local_8;
    }
    if (pcVar3 == (char *)0x0) {
      iVar4 = FUN_00525530(pcVar5);
    }
    else {
      iVar4 = FUN_00525450(pcVar5,(int)pcVar3 - (int)pcVar5);
    }
    *(int *)(iVar4 + 8) = *(int *)(iVar4 + 8) + 2;
    *(int *)(local_c + 8) = *(int *)(local_c + 8) + -1;
    if (*(int *)(local_c + 8) == 0) {
      FUN_00525340();
    }
    piVar1 = (int *)(iVar4 + 8);
    *piVar1 = *piVar1 + -1;
    local_c = iVar4;
    if (*piVar1 == 0) {
      FUN_00525340();
    }
    if (*(int *)(local_c + 0x10) != 0) {
      local_8 = (int *)(**(code **)(*local_8 + 0xec))(&local_c,local_4);
    }
    if ((local_8 == (int *)0x0) || (pcVar3 == (char *)0x0)) goto LAB_0052af16;
    pcVar5 = pcVar3 + 1;
    local_4 = local_4 & 0xffffff00;
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
0052add0 : MOV EAX,dword ptr [ESP + 0x4]
0052add4 : MOV EAX,dword ptr [EAX]
0052add6 : SUB ESP,0xc
0052add9 : CMP dword ptr [EAX + 0x10],0x0
0052addd : PUSH EBP
0052adde : MOV EBP,ECX
0052ade0 : JNZ 0x0052adfe
0052ade2 : TEST byte ptr [EBP + 0xc6],0x2
0052ade9 : JZ 0x0052adf4
0052adeb : XOR EAX,EAX
0052aded : POP EBP
0052adee : ADD ESP,0xc
0052adf1 : RET 0x8
0052adf4 : MOV EAX,dword ptr [EBP + 0x74]
0052adf7 : POP EBP
0052adf8 : ADD ESP,0xc
0052adfb : RET 0x8
0052adfe : MOV EDX,dword ptr [EBP + 0x78]
0052ae01 : MOV ECX,dword ptr [EBP + 0x74]
0052ae04 : PUSH EBX
0052ae05 : PUSH ESI
0052ae06 : MOV ESI,dword ptr [EAX]
0052ae08 : MOV EAX,dword ptr [EDX + 0x8]
0052ae0b : MOV dword ptr [ESP + 0xc],EAX
0052ae0f : INC dword ptr [EAX + 0x8]
0052ae12 : CMP byte ptr [ESI],0x2f
0052ae15 : PUSH EDI
0052ae16 : MOV dword ptr [ESP + 0x14],ECX
0052ae1a : JNZ 0x0052ae2a
0052ae1c : MOV EAX,dword ptr [ECX]
0052ae1e : MOV EDX,dword ptr [EAX + 0x54]
0052ae21 : PUSH 0x0
0052ae23 : CALL EDX
0052ae25 : MOV dword ptr [ESP + 0x14],EAX
0052ae29 : INC ESI
0052ae2a : MOV byte ptr [ESP + 0x18],0x1
0052ae2f : MOV EBX,0x2
0052ae34 : CMP byte ptr [ESI],0x0
0052ae37 : MOV EAX,ESI
0052ae39 : JZ 0x0052ae5a
0052ae3b : JMP 0x0052ae40
0052ae40 : MOV CL,byte ptr [EAX]
0052ae42 : CMP CL,0x2e
0052ae45 : JNZ 0x0052ae4f
0052ae47 : CMP byte ptr [EAX + 0x1],CL
0052ae4a : JNZ 0x0052ae7e
0052ae4c : INC EAX
0052ae4d : JMP 0x0052ae54
0052ae4f : CMP CL,0x2f
0052ae52 : JZ 0x0052ae7e
0052ae54 : INC EAX
0052ae55 : CMP byte ptr [EAX],0x0
0052ae58 : JNZ 0x0052ae40
0052ae5a : XOR EDI,EDI
0052ae5c : CMP EDI,ESI
0052ae5e : JZ 0x0052aef8
0052ae64 : MOV EAX,dword ptr [EBP + 0x78]
0052ae67 : TEST EDI,EDI
0052ae69 : JZ 0x0052ae82
0052ae6b : MOV ECX,EDI
0052ae6d : SUB ECX,ESI
0052ae6f : PUSH ECX
0052ae70 : PUSH ESI
0052ae71 : LEA ECX,[EAX + 0x254]
0052ae77 : CALL 0x00525450
0052ae7c : JMP 0x0052ae8e
0052ae7e : MOV EDI,EAX
0052ae80 : JMP 0x0052ae5c
0052ae82 : PUSH ESI
0052ae83 : LEA ECX,[EAX + 0x254]
0052ae89 : CALL 0x00525530
0052ae8e : MOV ESI,EAX
0052ae90 : ADD dword ptr [ESI + 0x8],EBX
0052ae93 : MOV EAX,dword ptr [ESP + 0x10]
0052ae97 : DEC dword ptr [EAX + 0x8]
0052ae9a : MOV ECX,EAX
0052ae9c : ADD EAX,0x8
0052ae9f : CMP dword ptr [EAX],0x0
0052aea2 : JNZ 0x0052aea9
0052aea4 : CALL 0x00525340
0052aea9 : MOV dword ptr [ESP + 0x10],ESI
0052aead : ADD dword ptr [ESI + 0x8],-0x1
0052aeb1 : JNZ 0x0052aeba
0052aeb3 : MOV ECX,ESI
0052aeb5 : CALL 0x00525340
0052aeba : MOV EDX,dword ptr [ESP + 0x10]
0052aebe : CMP dword ptr [EDX + 0x10],0x0
0052aec2 : JZ 0x0052aee0
0052aec4 : MOV EDX,dword ptr [ESP + 0x18]
0052aec8 : MOV ECX,dword ptr [ESP + 0x14]
0052aecc : MOV EAX,dword ptr [ECX]
0052aece : MOV EAX,dword ptr [EAX + 0xec]
0052aed4 : PUSH EDX
0052aed5 : LEA EDX,[ESP + 0x14]
0052aed9 : PUSH EDX
0052aeda : CALL EAX
0052aedc : MOV dword ptr [ESP + 0x14],EAX
0052aee0 : CMP dword ptr [ESP + 0x14],0x0
0052aee5 : JZ 0x0052af16
0052aee7 : TEST EDI,EDI
0052aee9 : JZ 0x0052af16
0052aeeb : LEA ESI,[EDI + 0x1]
0052aeee : MOV byte ptr [ESP + 0x18],0x0
0052aef3 : JMP 0x0052ae34
0052aef8 : TEST byte ptr [ESP + 0x24],0x4
0052aefd : JNZ 0x0052af16
0052aeff : MOV ECX,dword ptr [ESP + 0x20]
0052af03 : MOV EDX,dword ptr [ECX]
0052af05 : MOV EAX,dword ptr [EDX]
0052af07 : PUSH EAX
0052af08 : PUSH 0xb8b28c
0052af0d : PUSH EBP
0052af0e : CALL 0x0052ab30
0052af13 : ADD ESP,0xc
0052af16 : MOV EAX,dword ptr [ESP + 0x10]
0052af1a : DEC dword ptr [EAX + 0x8]
0052af1d : MOV ECX,EAX
0052af1f : ADD EAX,0x8
0052af22 : CMP dword ptr [EAX],0x0
0052af25 : POP EDI
0052af26 : POP ESI
0052af27 : POP EBX
0052af28 : JNZ 0x0052af2f
0052af2a : CALL 0x00525340
0052af2f : MOV EAX,dword ptr [ESP + 0x8]
0052af33 : POP EBP
0052af34 : ADD ESP,0xc
0052af37 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_006a65a0
ENTRY    : 006a65a0
BODY     : [[006a65a0, 006a684d]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006a65a0(int param_1,char param_2)

{
  byte bVar1;
  byte bVar2;
  undefined1 *puVar3;
  uint uVar4;
  uint uVar5;
  byte *pbVar6;
  uint in_ECX;
  int iVar7;
  int iVar8;
  uint *unaff_ESI;
  byte *pbVar9;
  int local_10;
  byte *local_c;
  byte *local_8;
  uint local_4;
  
  local_10 = FUN_006877c0(param_1);
  if (local_10 == 0) {
    uVar4 = FUN_00687a80(param_1,&local_10);
    if (local_10 == 0) {
      if ((uVar4 & 0xffff) <= in_ECX) {
        return 6;
      }
      local_10 = FUN_00687800(param_1,in_ECX * 5);
      if (local_10 == 0) {
        uVar4 = FUN_00687a80(param_1,&local_10);
        uVar4 = uVar4 & 0xffff;
        if ((local_10 == 0) && (uVar5 = FUN_00687b60(param_1,&local_10), local_10 == 0)) {
          *unaff_ESI = uVar4;
          unaff_ESI[1] = uVar5;
          local_10 = FUN_006877c0(param_1,uVar5);
          if ((local_10 == 0) && (local_10 = FUN_00688900(param_1,uVar4), local_10 == 0)) {
            puVar3 = *(undefined1 **)(param_1 + 0x20);
            pbVar9 = puVar3 + uVar4;
            local_8 = pbVar9;
            if (puVar3 + 0xd <= pbVar9) {
              unaff_ESI[2] = (int)CONCAT21(CONCAT11(*puVar3,puVar3[1]),puVar3[2]);
              unaff_ESI[3] = (int)CONCAT21(CONCAT11(puVar3[3],puVar3[4]),puVar3[5]);
              unaff_ESI[4] = (int)CONCAT21(CONCAT11(puVar3[6],puVar3[7]),puVar3[8]);
              unaff_ESI[5] = (int)CONCAT21(CONCAT11(puVar3[9],puVar3[10]),puVar3[0xb]);
              bVar1 = puVar3[0xc];
              local_c = puVar3 + 0xd;
              iVar7 = 0;
              if ((bVar1 & 4) != 0) {
                iVar7 = 1;
                if ((bVar1 & 8) != 0) {
                  iVar7 = 2;
                }
                if ((bVar1 & 3) == 0) {
                  iVar7 = iVar7 + 3;
                }
              }
              local_4 = bVar1 & 0x10;
              iVar8 = iVar7;
              if (((bVar1 & 0x10) != 0) && (iVar8 = iVar7 + 1, (bVar1 & 0x20) != 0)) {
                iVar8 = iVar7 + 2;
              }
              if (local_c + iVar8 <= pbVar9) {
                if ((bVar1 & 4) != 0) {
                  if ((bVar1 & 8) == 0) {
                    uVar4 = (uint)*local_c;
                    pbVar6 = puVar3 + 0xe;
                  }
                  else {
                    pbVar6 = puVar3 + 0xf;
                    uVar4 = (int)(short)((short)(char)*local_c << 8) | (uint)(byte)puVar3[0xe];
                  }
                  unaff_ESI[7] = uVar4;
                  local_c = pbVar6;
                  if ((bVar1 & 3) == 0) {
                    local_c = pbVar6 + 3;
                    unaff_ESI[9] = (int)CONCAT21(CONCAT11(*pbVar6,pbVar6[1]),pbVar6[2]);
                  }
                }
                if ((bVar1 & 0x10) != 0) {
                  if ((bVar1 & 0x20) == 0) {
                    uVar4 = (uint)*local_c;
                    local_c = local_c + 1;
                  }
                  else {
                    bVar2 = *local_c;
                    pbVar6 = local_c + 1;
                    local_c = local_c + 2;
                    uVar4 = (int)(short)((short)(char)bVar2 << 8) | (uint)*pbVar6;
                  }
                  unaff_ESI[8] = uVar4;
                }
                iVar7 = 0;
                if (((bVar1 & 0x40) == 0) ||
                   (local_10 = FUN_006a6590(), iVar7 = local_10, local_10 == 0)) {
                  local_10 = iVar7;
                  if (pbVar9 < local_c + 5) goto LAB_006a6815;
                  unaff_ESI[10] = (uint)CONCAT11(*local_c,local_c[1]);
                  unaff_ESI[0xb] = (uint)CONCAT21(CONCAT11(local_c[2],local_c[3]),local_c[4]);
                  if (param_2 != '\0') {
                    if (pbVar9 < local_c + 6) goto LAB_006a6815;
                    unaff_ESI[10] = unaff_ESI[10] + (uint)local_c[5] * 0x10000;
                  }
                }
                FUN_006889b0(param_1);
                return local_10;
              }
            }
LAB_006a6815:
            local_10 = 8;
            FUN_006889b0(param_1);
            return local_10;
          }
        }
      }
    }
  }
  return local_10;
}



============================================================
DISASSEMBLY
============================================================
006a65a0 : SUB ESP,0x10
006a65a3 : PUSH EBP
006a65a4 : MOV EBP,dword ptr [ESP + 0x18]
006a65a8 : PUSH EDI
006a65a9 : PUSH EAX
006a65aa : PUSH EBP
006a65ab : MOV EDI,ECX
006a65ad : CALL 0x006877c0
006a65b2 : ADD ESP,0x8
006a65b5 : MOV dword ptr [ESP + 0x8],EAX
006a65b9 : TEST EAX,EAX
006a65bb : JNZ 0x006a6848
006a65c1 : LEA ECX,[ESP + 0x8]
006a65c5 : PUSH ECX
006a65c6 : PUSH EBP
006a65c7 : CALL 0x00687a80
006a65cc : MOVZX ECX,AX
006a65cf : MOV EAX,dword ptr [ESP + 0x10]
006a65d3 : ADD ESP,0x8
006a65d6 : TEST EAX,EAX
006a65d8 : JNZ 0x006a6848
006a65de : CMP EDI,ECX
006a65e0 : JC 0x006a65ed
006a65e2 : POP EDI
006a65e3 : MOV EAX,0x6
006a65e8 : POP EBP
006a65e9 : ADD ESP,0x10
006a65ec : RET
006a65ed : LEA EDX,[EDI + EDI*0x4]
006a65f0 : PUSH EDX
006a65f1 : PUSH EBP
006a65f2 : CALL 0x00687800
006a65f7 : ADD ESP,0x8
006a65fa : MOV dword ptr [ESP + 0x8],EAX
006a65fe : TEST EAX,EAX
006a6600 : JNZ 0x006a6848
006a6606 : LEA EAX,[ESP + 0x8]
006a660a : PUSH EAX
006a660b : PUSH EBP
006a660c : CALL 0x00687a80
006a6611 : MOVZX EDI,AX
006a6614 : MOV EAX,dword ptr [ESP + 0x10]
006a6618 : ADD ESP,0x8
006a661b : TEST EAX,EAX
006a661d : JNZ 0x006a6848
006a6623 : LEA ECX,[ESP + 0x8]
006a6627 : PUSH ECX
006a6628 : PUSH EBP
006a6629 : CALL 0x00687b60
006a662e : MOV ECX,EAX
006a6630 : MOV EAX,dword ptr [ESP + 0x10]
006a6634 : ADD ESP,0x8
006a6637 : TEST EAX,EAX
006a6639 : JNZ 0x006a6848
006a663f : PUSH ECX
006a6640 : PUSH EBP
006a6641 : MOV dword ptr [ESI],EDI
006a6643 : MOV dword ptr [ESI + 0x4],ECX
006a6646 : CALL 0x006877c0
006a664b : ADD ESP,0x8
006a664e : MOV dword ptr [ESP + 0x8],EAX
006a6652 : TEST EAX,EAX
006a6654 : JNZ 0x006a6848
006a665a : PUSH EDI
006a665b : PUSH EBP
006a665c : CALL 0x00688900
006a6661 : ADD ESP,0x8
006a6664 : MOV dword ptr [ESP + 0x8],EAX
006a6668 : TEST EAX,EAX
006a666a : JNZ 0x006a6848
006a6670 : MOV EAX,dword ptr [EBP + 0x20]
006a6673 : ADD EDI,EAX
006a6675 : LEA EDX,[EAX + 0xd]
006a6678 : PUSH EBX
006a6679 : MOV dword ptr [ESP + 0x14],EDI
006a667d : CMP EDX,EDI
006a667f : JA 0x006a6815
006a6685 : MOVSX ECX,byte ptr [EAX]
006a6688 : MOVZX EDX,byte ptr [EAX + 0x1]
006a668c : SHL ECX,0x8
006a668f : OR ECX,EDX
006a6691 : MOVZX EDX,byte ptr [EAX + 0x2]
006a6695 : ADD EAX,0x3
006a6698 : SHL ECX,0x8
006a669b : OR ECX,EDX
006a669d : MOV dword ptr [ESI + 0x8],ECX
006a66a0 : MOVSX ECX,byte ptr [EAX]
006a66a3 : MOVZX EDX,byte ptr [EAX + 0x1]
006a66a7 : SHL ECX,0x8
006a66aa : OR ECX,EDX
006a66ac : MOVZX EDX,byte ptr [EAX + 0x2]
006a66b0 : ADD EAX,0x3
006a66b3 : SHL ECX,0x8
006a66b6 : OR ECX,EDX
006a66b8 : MOV dword ptr [ESI + 0xc],ECX
006a66bb : MOVSX ECX,byte ptr [EAX]
006a66be : MOVZX EDX,byte ptr [EAX + 0x1]
006a66c2 : ADD EAX,0x3
006a66c5 : SHL ECX,0x8
006a66c8 : OR ECX,EDX
006a66ca : MOVZX EDX,byte ptr [EAX + -0x1]
006a66ce : SHL ECX,0x8
006a66d1 : OR ECX,EDX
006a66d3 : MOV dword ptr [ESI + 0x10],ECX
006a66d6 : MOVSX ECX,byte ptr [EAX]
006a66d9 : MOVZX EDX,byte ptr [EAX + 0x1]
006a66dd : ADD EAX,0x3
006a66e0 : SHL ECX,0x8
006a66e3 : OR ECX,EDX
006a66e5 : MOVZX EDX,byte ptr [EAX + -0x1]
006a66e9 : SHL ECX,0x8
006a66ec : OR ECX,EDX
006a66ee : MOV dword ptr [ESI + 0x14],ECX
006a66f1 : MOVZX ECX,byte ptr [EAX]
006a66f4 : INC EAX
006a66f5 : MOV EDI,ECX
006a66f7 : XOR EDX,EDX
006a66f9 : AND EDI,0x4
006a66fc : MOV dword ptr [ESP + 0x10],EAX
006a6700 : JZ 0x006a6719
006a6702 : MOV EDX,0x1
006a6707 : TEST CL,0x8
006a670a : JZ 0x006a6711
006a670c : MOV EDX,0x2
006a6711 : TEST CL,0x3
006a6714 : JNZ 0x006a6719
006a6716 : ADD EDX,0x3
006a6719 : MOV EBX,ECX
006a671b : AND EBX,0x10
006a671e : MOV dword ptr [ESP + 0x18],EBX
006a6722 : JZ 0x006a672b
006a6724 : INC EDX
006a6725 : TEST CL,0x20
006a6728 : JZ 0x006a672b
006a672a : INC EDX
006a672b : MOV EBX,dword ptr [ESP + 0x14]
006a672f : ADD EDX,EAX
006a6731 : CMP EDX,EBX
006a6733 : JA 0x006a6815
006a6739 : TEST EDI,EDI
006a673b : JZ 0x006a6787
006a673d : TEST CL,0x8
006a6740 : JZ 0x006a6758
006a6742 : MOVSX DX,byte ptr [EAX]
006a6746 : MOVZX EDI,byte ptr [EAX + 0x1]
006a674a : ADD EAX,0x2
006a674d : SHL DX,0x8
006a6751 : MOVSX EDX,DX
006a6754 : OR EDX,EDI
006a6756 : JMP 0x006a675c
006a6758 : MOVZX EDX,byte ptr [EAX]
006a675b : INC EAX
006a675c : MOV dword ptr [ESP + 0x10],EAX
006a6760 : MOV dword ptr [ESI + 0x1c],EDX
006a6763 : TEST CL,0x3
006a6766 : JNZ 0x006a6787
006a6768 : MOVSX EDX,byte ptr [EAX]
006a676b : MOVZX EDI,byte ptr [EAX + 0x1]
006a676f : ADD EAX,0x3
006a6772 : SHL EDX,0x8
006a6775 : OR EDX,EDI
006a6777 : MOVZX EDI,byte ptr [EAX + -0x1]
006a677b : SHL EDX,0x8
006a677e : OR EDX,EDI
006a6780 : MOV dword ptr [ESP + 0x10],EAX
006a6784 : MOV dword ptr [ESI + 0x24],EDX
006a6787 : CMP dword ptr [ESP + 0x18],0x0
006a678c : JZ 0x006a67b4
006a678e : TEST CL,0x20
006a6791 : JZ 0x006a67a9
006a6793 : MOVSX DX,byte ptr [EAX]
006a6797 : MOVZX EDI,byte ptr [EAX + 0x1]
006a679b : ADD EAX,0x2
006a679e : SHL DX,0x8
006a67a2 : MOVSX EDX,DX
006a67a5 : OR EDX,EDI
006a67a7 : JMP 0x006a67ad
006a67a9 : MOVZX EDX,byte ptr [EAX]
006a67ac : INC EAX
006a67ad : MOV dword ptr [ESP + 0x10],EAX
006a67b1 : MOV dword ptr [ESI + 0x20],EDX
006a67b4 : TEST CL,0x40
006a67b7 : JZ 0x006a67ce
006a67b9 : LEA EAX,[ESP + 0x10]
006a67bd : CALL 0x006a6590
006a67c2 : MOV dword ptr [ESP + 0xc],EAX
006a67c6 : TEST EAX,EAX
006a67c8 : JNZ 0x006a683a
006a67ca : MOV EAX,dword ptr [ESP + 0x10]
006a67ce : LEA ECX,[EAX + 0x5]
006a67d1 : CMP ECX,EBX
006a67d3 : JA 0x006a6815
006a67d5 : MOVZX DX,byte ptr [EAX]
006a67d9 : ADD EAX,0x2
006a67dc : SHL DX,0x8
006a67e0 : MOVZX ECX,DX
006a67e3 : MOVZX EDX,byte ptr [EAX + -0x1]
006a67e7 : OR ECX,EDX
006a67e9 : MOV dword ptr [ESI + 0x28],ECX
006a67ec : MOVZX ECX,byte ptr [EAX]
006a67ef : MOVZX EDX,byte ptr [EAX + 0x1]
006a67f3 : ADD EAX,0x3
006a67f6 : SHL ECX,0x8
006a67f9 : OR ECX,EDX
006a67fb : MOVZX EDX,byte ptr [EAX + -0x1]
006a67ff : SHL ECX,0x8
006a6802 : OR ECX,EDX
006a6804 : CMP byte ptr [ESP + 0x24],0x0
006a6809 : MOV dword ptr [ESI + 0x2c],ECX
006a680c : JZ 0x006a683a
006a680e : LEA ECX,[EAX + 0x1]
006a6811 : CMP ECX,EBX
006a6813 : JBE 0x006a6831
006a6815 : PUSH EBP
006a6816 : MOV dword ptr [ESP + 0x10],0x8
006a681e : CALL 0x006889b0
006a6823 : MOV EAX,dword ptr [ESP + 0x10]
006a6827 : ADD ESP,0x4
006a682a : POP EBX
006a682b : POP EDI
006a682c : POP EBP
006a682d : ADD ESP,0x10
006a6830 : RET
006a6831 : MOVZX EDX,byte ptr [EAX]
006a6834 : SHL EDX,0x10
006a6837 : ADD dword ptr [ESI + 0x28],EDX
006a683a : PUSH EBP
006a683b : CALL 0x006889b0
006a6840 : MOV EAX,dword ptr [ESP + 0x10]
006a6844 : ADD ESP,0x4
006a6847 : POP EBX
006a6848 : POP EDI
006a6849 : POP EBP
006a684a : ADD ESP,0x10
006a684d : RET

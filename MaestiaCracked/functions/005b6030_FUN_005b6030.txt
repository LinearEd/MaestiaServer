PROGRAM  : Maestia.exe
FUNCTION : FUN_005b6030
ENTRY    : 005b6030
BODY     : [[005b6030, 005b64ad]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005b6030(undefined4 param_1,undefined4 *param_2)

{
  int *piVar1;
  int iVar2;
  undefined4 uVar3;
  GRefCountNTSImpl *this;
  GRefCountNTSImpl *this_00;
  undefined4 uStack_90;
  undefined4 uStack_8c;
  undefined2 uStack_88;
  undefined1 uStack_86;
  undefined1 uStack_85;
  GRefCountNTSImpl GStack_84;
  undefined1 uStack_83;
  undefined4 local_80;
  undefined4 local_7c;
  undefined2 local_78;
  undefined1 local_76;
  undefined1 local_75;
  GRefCountNTSImpl local_74;
  undefined1 local_73;
  undefined4 uStack_70;
  undefined4 uStack_6c;
  undefined2 uStack_68;
  undefined1 uStack_66;
  undefined1 uStack_65;
  GRefCountNTSImpl GStack_64;
  undefined1 uStack_63;
  undefined4 uStack_60;
  undefined4 uStack_5c;
  undefined2 uStack_58;
  undefined1 uStack_56;
  undefined1 uStack_55;
  GRefCountNTSImpl GStack_54;
  undefined1 uStack_53;
  undefined4 uStack_50;
  undefined4 uStack_4c;
  undefined2 uStack_48;
  undefined1 uStack_46;
  undefined1 uStack_45;
  undefined1 uStack_44;
  undefined1 uStack_43;
  undefined4 local_40;
  undefined4 local_3c;
  undefined2 local_38;
  undefined1 local_36;
  undefined1 local_35;
  GRefCountNTSImpl local_34;
  undefined1 local_33;
  undefined4 uStack_30;
  undefined4 uStack_2c;
  undefined2 uStack_28;
  undefined1 uStack_26;
  undefined1 uStack_25;
  undefined1 uStack_24;
  undefined1 uStack_23;
  undefined4 uStack_20;
  undefined4 uStack_1c;
  undefined2 uStack_18;
  undefined1 uStack_16;
  undefined1 uStack_15;
  undefined1 uStack_14;
  undefined1 uStack_13;
  
  piVar1 = (int *)param_2[2];
  this = (GRefCountNTSImpl *)0x0;
  if (piVar1 == (int *)0x0) {
LAB_005b6067:
    if (this != (GRefCountNTSImpl *)0x0) {
      GRefCountNTSImpl::Release(this);
    }
  }
  else {
    if (piVar1[1] == 0) {
      *piVar1 = *piVar1 + -1;
      if (*piVar1 == 0) {
        FUN_00515cf0(piVar1);
      }
      param_2[2] = 0;
      goto LAB_005b6067;
    }
    this = (GRefCountNTSImpl *)piVar1[1];
    if (this != (GRefCountNTSImpl *)0x0) {
      *(int *)(this + 4) = *(int *)(this + 4) + 1;
      *(int *)(this + 4) = *(int *)(this + 4) + 1;
      goto LAB_005b6067;
    }
  }
  piVar1 = (int *)*param_2;
  this_00 = (GRefCountNTSImpl *)0x0;
  if (piVar1 != (int *)0x0) {
    if (piVar1[1] == 0) {
      *piVar1 = *piVar1 + -1;
      if (*piVar1 == 0) {
        FUN_00515cf0(piVar1);
      }
      *param_2 = 0;
    }
    else {
      this_00 = (GRefCountNTSImpl *)piVar1[1];
      if (this_00 != (GRefCountNTSImpl *)0x0) {
        *(int *)(this_00 + 4) = *(int *)(this_00 + 4) + 1;
        *(int *)(this_00 + 4) = *(int *)(this_00 + 4) + 1;
        GRefCountNTSImpl::Release(this_00);
      }
    }
  }
  if ((*(byte *)(param_2 + 4) & 1) != 0) {
    if ((*(byte *)(param_2 + 8) & 4) == 0) {
      if (this_00 == this) {
        if (this != (GRefCountNTSImpl *)0x0) {
          local_74 = this[0x93];
          this[0x93] = (GRefCountNTSImpl)((char)local_74 + '\x01');
          local_78 = 0;
          local_75 = (undefined1)param_1;
          local_80 = 0x8000;
          local_7c = 0;
          local_76 = 0;
          local_73 = 0;
          (**(code **)(*(int *)this + 0xe8))(&local_80);
        }
        *(byte *)(param_2 + 8) = *(byte *)(param_2 + 8) | 4;
      }
    }
    else if (this_00 != this) {
      if (this != (GRefCountNTSImpl *)0x0) {
        if (this[0x93] == (GRefCountNTSImpl)0x0) {
          local_34 = (GRefCountNTSImpl)0xff;
        }
        else {
          local_34 = (GRefCountNTSImpl)((char)this[0x93] + -1);
          this[0x93] = local_34;
        }
        local_38 = 0;
        local_35 = (undefined1)param_1;
        local_40 = 0x10000;
        local_3c = 0;
        local_36 = 0;
        local_33 = 0;
        (**(code **)(*(int *)this + 0xe8))(&local_40);
      }
      *(byte *)(param_2 + 8) = *(byte *)(param_2 + 8) & 0xfb;
    }
    if ((((this == (GRefCountNTSImpl *)0x0) || ((*(uint *)(this + 0x8c) >> 0xd & 1) != 0)) &&
        (this_00 != (GRefCountNTSImpl *)0x0)) &&
       ((this_00 != this && ((*(uint *)(this_00 + 0x8c) >> 0xd & 1) != 0)))) {
      *(int *)(this_00 + 4) = *(int *)(this_00 + 4) + 1;
      if (this != (GRefCountNTSImpl *)0x0) {
        GRefCountNTSImpl::Release(this);
      }
      GStack_54 = this_00[0x93];
      this_00[0x93] = (GRefCountNTSImpl)((char)GStack_54 + '\x01');
      uStack_58 = 0;
      uStack_55 = (undefined1)param_1;
      uStack_60 = 0x8000;
      uStack_5c = 0;
      uStack_56 = 0;
      uStack_53 = 0;
      (**(code **)(*(int *)this_00 + 0xe8))(&uStack_60);
      *(byte *)(param_2 + 8) = *(byte *)(param_2 + 8) | 4;
      this = this_00;
    }
    if (((*(byte *)(param_2 + 3) & 1) == 0) && (this != (GRefCountNTSImpl *)0x0)) {
      if ((*(byte *)(param_2 + 8) & 4) == 0) {
        if ((*(uint *)(this + 0x8c) >> 0xd & 1) == 0) {
          iVar2 = *(int *)this;
          uVar3 = FUN_0056a200(0x1000,param_1,0);
          (**(code **)(iVar2 + 0xe8))(uVar3);
        }
        GRefCountNTSImpl::Release(this);
        this = (GRefCountNTSImpl *)0x0;
      }
      else {
        uStack_18 = 0;
        uStack_15 = (undefined1)param_1;
        uStack_20 = 0x800;
        uStack_1c = 0;
        uStack_16 = 0;
        uStack_13 = 0;
        uStack_14 = 0;
        (**(code **)(*(int *)this + 0xe8))(&uStack_20);
      }
    }
    if ((*(byte *)(param_2 + 4) & 1) != 0) goto LAB_005b643d;
  }
  if (this_00 == this) {
    if ((this != (GRefCountNTSImpl *)0x0) && ((*(byte *)(param_2 + 8) & 8) != 0)) {
      uStack_50 = 8;
      uStack_48 = 0;
      uStack_45 = (undefined1)param_1;
      uStack_4c = 0;
      uStack_46 = 0;
      uStack_43 = 0;
      uStack_44 = 0;
      (**(code **)(*(int *)this + 0xe8))(&uStack_50);
    }
  }
  else {
    if (this != (GRefCountNTSImpl *)0x0) {
      if (this[0x93] == (GRefCountNTSImpl)0x0) {
        GStack_84 = (GRefCountNTSImpl)0xff;
      }
      else {
        GStack_84 = (GRefCountNTSImpl)((char)this[0x93] + -1);
        this[0x93] = GStack_84;
      }
      uStack_88 = 0;
      uStack_85 = (undefined1)param_1;
      uStack_90 = 0x4000;
      uStack_8c = 0;
      uStack_86 = 0;
      uStack_83 = 0;
      (**(code **)(*(int *)this + 0xe8))(&uStack_90);
    }
    if (this_00 != (GRefCountNTSImpl *)0x0) {
      *(int *)(this_00 + 4) = *(int *)(this_00 + 4) + 1;
    }
    if (this != (GRefCountNTSImpl *)0x0) {
      GRefCountNTSImpl::Release(this);
    }
    if (this_00 != (GRefCountNTSImpl *)0x0) {
      GStack_64 = this_00[0x93];
      this_00[0x93] = (GRefCountNTSImpl)((char)GStack_64 + '\x01');
      uStack_68 = 0;
      uStack_65 = (undefined1)param_1;
      uStack_70 = 0x2000;
      uStack_6c = 0;
      uStack_66 = 0;
      uStack_63 = 0;
      (**(code **)(*(int *)this_00 + 0xe8))(&uStack_70);
    }
    *(byte *)(param_2 + 8) = *(byte *)(param_2 + 8) | 4;
    this = this_00;
  }
  if ((*(byte *)(param_2 + 3) & 1) != 0) {
    if (this != (GRefCountNTSImpl *)0x0) {
      uStack_28 = 0;
      uStack_25 = (undefined1)param_1;
      uStack_30 = 0x400;
      uStack_2c = 0;
      uStack_26 = 0;
      uStack_23 = 0;
      uStack_24 = 0;
      (**(code **)(*(int *)this + 0xe8))(&uStack_30);
    }
    *(byte *)(param_2 + 8) = *(byte *)(param_2 + 8) | 4;
  }
LAB_005b643d:
  if (this == (GRefCountNTSImpl *)0x0) {
    piVar1 = (int *)param_2[2];
    if ((piVar1 != (int *)0x0) && (*piVar1 = *piVar1 + -1, *piVar1 == 0)) {
      FUN_00515cf0(piVar1);
    }
    param_2[2] = 0;
  }
  else {
    uVar3 = FUN_004ff840();
    piVar1 = (int *)param_2[2];
    if ((piVar1 != (int *)0x0) && (*piVar1 = *piVar1 + -1, *piVar1 == 0)) {
      FUN_00515cf0(piVar1);
    }
    param_2[2] = uVar3;
  }
  if (this_00 != (GRefCountNTSImpl *)0x0) {
    GRefCountNTSImpl::Release(this_00);
  }
  if (this != (GRefCountNTSImpl *)0x0) {
    GRefCountNTSImpl::Release(this);
    return;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005b6030 : SUB ESP,0x90
005b6036 : PUSH EBX
005b6037 : PUSH EBP
005b6038 : MOV EBP,dword ptr [ESP + 0xa0]
005b603f : MOV EAX,dword ptr [EBP + 0x8]
005b6042 : PUSH ESI
005b6043 : XOR EBX,EBX
005b6045 : XOR ESI,ESI
005b6047 : PUSH EDI
005b6048 : CMP EAX,EBX
005b604a : JZ 0x005b6067
005b604c : CMP dword ptr [EAX + 0x4],EBX
005b604f : JZ 0x005b6112
005b6055 : MOV ESI,dword ptr [EAX + 0x4]
005b6058 : CMP ESI,EBX
005b605a : JZ 0x005b6072
005b605c : MOV EAX,0x1
005b6061 : ADD dword ptr [ESI + 0x4],EAX
005b6064 : ADD dword ptr [ESI + 0x4],EAX
005b6067 : CMP ESI,EBX
005b6069 : JZ 0x005b6072
005b606b : MOV ECX,ESI
005b606d : CALL 0x004ff7c0
005b6072 : MOV EAX,dword ptr [EBP]
005b6075 : XOR EDI,EDI
005b6077 : CMP EAX,EBX
005b6079 : JZ 0x005b609d
005b607b : CMP dword ptr [EAX + 0x4],EBX
005b607e : JZ 0x005b6125
005b6084 : MOV EDI,dword ptr [EAX + 0x4]
005b6087 : CMP EDI,EBX
005b6089 : JZ 0x005b609d
005b608b : MOV EAX,0x1
005b6090 : ADD dword ptr [EDI + 0x4],EAX
005b6093 : ADD dword ptr [EDI + 0x4],EAX
005b6096 : MOV ECX,EDI
005b6098 : CALL 0x004ff7c0
005b609d : TEST byte ptr [EBP + 0x10],0x1
005b60a1 : JZ 0x005b62de
005b60a7 : TEST byte ptr [EBP + 0x20],0x4
005b60ab : JNZ 0x005b6138
005b60b1 : CMP EDI,ESI
005b60b3 : JNZ 0x005b6199
005b60b9 : CMP ESI,EBX
005b60bb : JZ 0x005b6109
005b60bd : MOV AL,byte ptr [ESI + 0x93]
005b60c3 : MOV DL,byte ptr [ESP + 0xa4]
005b60ca : MOVZX ECX,AL
005b60cd : INC AL
005b60cf : MOV byte ptr [ESI + 0x93],AL
005b60d5 : XOR EAX,EAX
005b60d7 : MOV byte ptr [ESP + 0x2c],CL
005b60db : MOV word ptr [ESP + 0x28],AX
005b60e0 : MOV EAX,dword ptr [ESI]
005b60e2 : LEA ECX,[ESP + 0x20]
005b60e6 : MOV byte ptr [ESP + 0x2b],DL
005b60ea : MOV EDX,dword ptr [EAX + 0xe8]
005b60f0 : PUSH ECX
005b60f1 : MOV ECX,ESI
005b60f3 : MOV dword ptr [ESP + 0x24],0x8000
005b60fb : MOV dword ptr [ESP + 0x28],EBX
005b60ff : MOV byte ptr [ESP + 0x2e],BL
005b6103 : MOV byte ptr [ESP + 0x31],BL
005b6107 : CALL EDX
005b6109 : OR byte ptr [EBP + 0x20],0x4
005b610d : JMP 0x005b6199
005b6112 : ADD dword ptr [EAX],-0x1
005b6115 : JNZ 0x005b611d
005b6117 : PUSH EAX
005b6118 : CALL 0x00515cf0
005b611d : MOV dword ptr [EBP + 0x8],EBX
005b6120 : JMP 0x005b6067
005b6125 : ADD dword ptr [EAX],-0x1
005b6128 : JNZ 0x005b6130
005b612a : PUSH EAX
005b612b : CALL 0x00515cf0
005b6130 : MOV dword ptr [EBP],EBX
005b6133 : JMP 0x005b609d
005b6138 : CMP EDI,ESI
005b613a : JZ 0x005b6199
005b613c : CMP ESI,EBX
005b613e : JZ 0x005b6195
005b6140 : MOV AL,byte ptr [ESI + 0x93]
005b6146 : CMP AL,BL
005b6148 : JZ 0x005b6157
005b614a : DEC AL
005b614c : MOV byte ptr [ESI + 0x93],AL
005b6152 : MOVZX EAX,AL
005b6155 : JMP 0x005b615a
005b6157 : OR EAX,0xffffffff
005b615a : MOV DL,byte ptr [ESP + 0xa4]
005b6161 : XOR ECX,ECX
005b6163 : MOV word ptr [ESP + 0x68],CX
005b6168 : MOV byte ptr [ESP + 0x6c],AL
005b616c : MOV EAX,dword ptr [ESI]
005b616e : LEA ECX,[ESP + 0x60]
005b6172 : MOV byte ptr [ESP + 0x6b],DL
005b6176 : MOV EDX,dword ptr [EAX + 0xe8]
005b617c : PUSH ECX
005b617d : MOV ECX,ESI
005b617f : MOV dword ptr [ESP + 0x64],0x10000
005b6187 : MOV dword ptr [ESP + 0x68],EBX
005b618b : MOV byte ptr [ESP + 0x6e],BL
005b618f : MOV byte ptr [ESP + 0x71],BL
005b6193 : CALL EDX
005b6195 : AND byte ptr [EBP + 0x20],0xfb
005b6199 : CMP ESI,EBX
005b619b : JZ 0x005b61aa
005b619d : MOV EAX,dword ptr [ESI + 0x8c]
005b61a3 : SHR EAX,0xd
005b61a6 : TEST AL,0x1
005b61a8 : JZ 0x005b6220
005b61aa : CMP EDI,EBX
005b61ac : JZ 0x005b6220
005b61ae : CMP EDI,ESI
005b61b0 : JZ 0x005b6220
005b61b2 : MOV ECX,dword ptr [EDI + 0x8c]
005b61b8 : SHR ECX,0xd
005b61bb : TEST CL,0x1
005b61be : JZ 0x005b6220
005b61c0 : INC dword ptr [EDI + 0x4]
005b61c3 : CMP ESI,EBX
005b61c5 : JZ 0x005b61ce
005b61c7 : MOV ECX,ESI
005b61c9 : CALL 0x004ff7c0
005b61ce : MOV AL,byte ptr [EDI + 0x93]
005b61d4 : MOVZX ECX,AL
005b61d7 : INC AL
005b61d9 : MOV byte ptr [EDI + 0x93],AL
005b61df : MOV AL,byte ptr [ESP + 0xa4]
005b61e6 : XOR EDX,EDX
005b61e8 : MOV word ptr [ESP + 0x48],DX
005b61ed : MOV EDX,dword ptr [EDI]
005b61ef : MOV EDX,dword ptr [EDX + 0xe8]
005b61f5 : MOV byte ptr [ESP + 0x4b],AL
005b61f9 : LEA EAX,[ESP + 0x40]
005b61fd : MOV byte ptr [ESP + 0x4c],CL
005b6201 : PUSH EAX
005b6202 : MOV ECX,EDI
005b6204 : MOV ESI,EDI
005b6206 : MOV dword ptr [ESP + 0x44],0x8000
005b620e : MOV dword ptr [ESP + 0x48],EBX
005b6212 : MOV byte ptr [ESP + 0x4e],BL
005b6216 : MOV byte ptr [ESP + 0x51],BL
005b621a : CALL EDX
005b621c : OR byte ptr [EBP + 0x20],0x4
005b6220 : TEST byte ptr [EBP + 0xc],0x1
005b6224 : JNZ 0x005b62d4
005b622a : CMP ESI,EBX
005b622c : JZ 0x005b62d4
005b6232 : TEST byte ptr [EBP + 0x20],0x4
005b6236 : JZ 0x005b628d
005b6238 : MOV CL,byte ptr [ESP + 0xa4]
005b623f : MOV EDX,dword ptr [ESI]
005b6241 : MOV EDX,dword ptr [EDX + 0xe8]
005b6247 : XOR EAX,EAX
005b6249 : MOV word ptr [ESP + 0x88],AX
005b6251 : LEA EAX,[ESP + 0x80]
005b6258 : MOV byte ptr [ESP + 0x8b],CL
005b625f : PUSH EAX
005b6260 : MOV ECX,ESI
005b6262 : MOV dword ptr [ESP + 0x84],0x800
005b626d : MOV dword ptr [ESP + 0x88],EBX
005b6274 : MOV byte ptr [ESP + 0x8e],BL
005b627b : MOV byte ptr [ESP + 0x91],BL
005b6282 : MOV byte ptr [ESP + 0x90],BL
005b6289 : CALL EDX
005b628b : JMP 0x005b62d4
005b628d : MOV EAX,dword ptr [ESI + 0x8c]
005b6293 : SHR EAX,0xd
005b6296 : TEST AL,0x1
005b6298 : JNZ 0x005b62cb
005b629a : MOV ECX,dword ptr [ESP + 0xa4]
005b62a1 : MOV EBP,dword ptr [ESI]
005b62a3 : PUSH EBX
005b62a4 : PUSH ECX
005b62a5 : PUSH 0x1000
005b62aa : LEA ECX,[ESP + 0x9c]
005b62b1 : ADD EBP,0xe8
005b62b7 : CALL 0x0056a200
005b62bc : MOV EDX,dword ptr [EBP]
005b62bf : PUSH EAX
005b62c0 : MOV ECX,ESI
005b62c2 : CALL EDX
005b62c4 : MOV EBP,dword ptr [ESP + 0xa8]
005b62cb : MOV ECX,ESI
005b62cd : CALL 0x004ff7c0
005b62d2 : XOR ESI,ESI
005b62d4 : TEST byte ptr [EBP + 0x10],0x1
005b62d8 : JNZ 0x005b643d
005b62de : CMP EDI,ESI
005b62e0 : JZ 0x005b63a9
005b62e6 : CMP ESI,EBX
005b62e8 : JZ 0x005b633f
005b62ea : MOV AL,byte ptr [ESI + 0x93]
005b62f0 : CMP AL,BL
005b62f2 : JZ 0x005b6301
005b62f4 : DEC AL
005b62f6 : MOV byte ptr [ESI + 0x93],AL
005b62fc : MOVZX EAX,AL
005b62ff : JMP 0x005b6304
005b6301 : OR EAX,0xffffffff
005b6304 : MOV DL,byte ptr [ESP + 0xa4]
005b630b : XOR ECX,ECX
005b630d : MOV word ptr [ESP + 0x18],CX
005b6312 : MOV byte ptr [ESP + 0x1c],AL
005b6316 : MOV EAX,dword ptr [ESI]
005b6318 : LEA ECX,[ESP + 0x10]
005b631c : MOV byte ptr [ESP + 0x1b],DL
005b6320 : MOV EDX,dword ptr [EAX + 0xe8]
005b6326 : PUSH ECX
005b6327 : MOV ECX,ESI
005b6329 : MOV dword ptr [ESP + 0x14],0x4000
005b6331 : MOV dword ptr [ESP + 0x18],EBX
005b6335 : MOV byte ptr [ESP + 0x1e],BL
005b6339 : MOV byte ptr [ESP + 0x21],BL
005b633d : CALL EDX
005b633f : CMP EDI,EBX
005b6341 : JZ 0x005b6346
005b6343 : INC dword ptr [EDI + 0x4]
005b6346 : CMP ESI,EBX
005b6348 : JZ 0x005b6351
005b634a : MOV ECX,ESI
005b634c : CALL 0x004ff7c0
005b6351 : MOV ESI,EDI
005b6353 : CMP EDI,EBX
005b6355 : JZ 0x005b63a3
005b6357 : MOV AL,byte ptr [EDI + 0x93]
005b635d : MOV DL,byte ptr [ESP + 0xa4]
005b6364 : MOVZX ECX,AL
005b6367 : INC AL
005b6369 : MOV byte ptr [EDI + 0x93],AL
005b636f : XOR EAX,EAX
005b6371 : MOV byte ptr [ESP + 0x3c],CL
005b6375 : MOV word ptr [ESP + 0x38],AX
005b637a : MOV EAX,dword ptr [EDI]
005b637c : LEA ECX,[ESP + 0x30]
005b6380 : MOV byte ptr [ESP + 0x3b],DL
005b6384 : MOV EDX,dword ptr [EAX + 0xe8]
005b638a : PUSH ECX
005b638b : MOV ECX,EDI
005b638d : MOV dword ptr [ESP + 0x34],0x2000
005b6395 : MOV dword ptr [ESP + 0x38],EBX
005b6399 : MOV byte ptr [ESP + 0x3e],BL
005b639d : MOV byte ptr [ESP + 0x41],BL
005b63a1 : CALL EDX
005b63a3 : OR byte ptr [EBP + 0x20],0x4
005b63a7 : JMP 0x005b63ee
005b63a9 : CMP ESI,EBX
005b63ab : JZ 0x005b63ee
005b63ad : MOV EAX,0x8
005b63b2 : TEST byte ptr [EBP + 0x20],AL
005b63b5 : JZ 0x005b63ee
005b63b7 : MOV CL,byte ptr [ESP + 0xa4]
005b63be : MOV EDX,dword ptr [ESI]
005b63c0 : MOV EDX,dword ptr [EDX + 0xe8]
005b63c6 : MOV dword ptr [ESP + 0x50],EAX
005b63ca : XOR EAX,EAX
005b63cc : MOV word ptr [ESP + 0x58],AX
005b63d1 : LEA EAX,[ESP + 0x50]
005b63d5 : MOV byte ptr [ESP + 0x5b],CL
005b63d9 : PUSH EAX
005b63da : MOV ECX,ESI
005b63dc : MOV dword ptr [ESP + 0x58],EBX
005b63e0 : MOV byte ptr [ESP + 0x5e],BL
005b63e4 : MOV byte ptr [ESP + 0x61],BL
005b63e8 : MOV byte ptr [ESP + 0x60],BL
005b63ec : CALL EDX
005b63ee : TEST byte ptr [EBP + 0xc],0x1
005b63f2 : JZ 0x005b643d
005b63f4 : CMP ESI,EBX
005b63f6 : JZ 0x005b6439
005b63f8 : MOV CL,byte ptr [ESP + 0xa4]
005b63ff : MOV EDX,dword ptr [ESI]
005b6401 : MOV EDX,dword ptr [EDX + 0xe8]
005b6407 : XOR EAX,EAX
005b6409 : MOV word ptr [ESP + 0x78],AX
005b640e : LEA EAX,[ESP + 0x70]
005b6412 : MOV byte ptr [ESP + 0x7b],CL
005b6416 : PUSH EAX
005b6417 : MOV ECX,ESI
005b6419 : MOV dword ptr [ESP + 0x74],0x400
005b6421 : MOV dword ptr [ESP + 0x78],EBX
005b6425 : MOV byte ptr [ESP + 0x7e],BL
005b6429 : MOV byte ptr [ESP + 0x81],BL
005b6430 : MOV byte ptr [ESP + 0x80],BL
005b6437 : CALL EDX
005b6439 : OR byte ptr [EBP + 0x20],0x4
005b643d : CMP ESI,EBX
005b643f : JZ 0x005b646f
005b6441 : MOV ECX,ESI
005b6443 : CALL 0x004ff840
005b6448 : MOV EBP,EAX
005b644a : MOV EAX,dword ptr [ESP + 0xa8]
005b6451 : MOV EAX,dword ptr [EAX + 0x8]
005b6454 : CMP EAX,EBX
005b6456 : JZ 0x005b6463
005b6458 : ADD dword ptr [EAX],-0x1
005b645b : JNZ 0x005b6463
005b645d : PUSH EAX
005b645e : CALL 0x00515cf0
005b6463 : MOV ECX,dword ptr [ESP + 0xa8]
005b646a : MOV dword ptr [ECX + 0x8],EBP
005b646d : JMP 0x005b6484
005b646f : MOV EAX,dword ptr [EBP + 0x8]
005b6472 : CMP EAX,EBX
005b6474 : JZ 0x005b6481
005b6476 : ADD dword ptr [EAX],-0x1
005b6479 : JNZ 0x005b6481
005b647b : PUSH EAX
005b647c : CALL 0x00515cf0
005b6481 : MOV dword ptr [EBP + 0x8],EBX
005b6484 : CMP EDI,EBX
005b6486 : JZ 0x005b648f
005b6488 : MOV ECX,EDI
005b648a : CALL 0x004ff7c0
005b648f : POP EDI
005b6490 : CMP ESI,EBX
005b6492 : JZ 0x005b64a4
005b6494 : MOV ECX,ESI
005b6496 : POP ESI
005b6497 : POP EBP
005b6498 : POP EBX
005b6499 : ADD ESP,0x90
005b649f : JMP 0x004ff7c0
005b64a4 : POP ESI
005b64a5 : POP EBP
005b64a6 : POP EBX
005b64a7 : ADD ESP,0x90
005b64ad : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00723760
ENTRY    : 00723760
BODY     : [[00723760, 007237a8] [007237b0, 00723943]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00723760(int *param_1)

{
  short sVar1;
  char cVar2;
  uint uVar3;
  short *psVar4;
  int in_ECX;
  undefined1 auStack_24c [4];
  undefined4 uStack_248;
  uint local_244;
  undefined4 uStack_240;
  undefined1 auStack_23c [4];
  undefined2 uStack_238;
  undefined4 uStack_228;
  uint uStack_224;
  short sStack_220;
  undefined1 auStack_21e [514];
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_00b3692d;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_24c;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffda8;
  ExceptionList = &local_14;
LAB_007237b0:
  do {
    while( true ) {
      if (((uint)param_1[8] <= (uint)param_1[9]) ||
         (cVar2 = (**(code **)(*param_1 + 0x1c))(&local_244,uVar3), cVar2 == '\0'))
      goto LAB_0072391e;
      if (0x52 < local_244) break;
      if (local_244 == 0x52) {
        (**(code **)(*param_1 + 0xc))(in_ECX + 0x12,1,1);
      }
      else if (local_244 == 0x10) {
        FUN_0070d320(&sStack_220);
        psVar4 = &sStack_220;
        uStack_224 = 7;
        uStack_228 = 0;
        uStack_238 = 0;
        do {
          sVar1 = *psVar4;
          psVar4 = psVar4 + 1;
        } while (sVar1 != 0);
        FUN_00406360(&sStack_220,(int)psVar4 - (int)auStack_21e >> 1);
        uStack_c = 0;
        FUN_00405eb0(auStack_23c,0,0xffffffff);
        uStack_c = 0xffffffff;
        if (7 < uStack_224) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        uStack_224 = 7;
        uStack_228 = 0;
        uStack_238 = 0;
      }
      else if (local_244 == 0x13) {
        uStack_248 = 0xffffffff;
        (**(code **)(*param_1 + 0xc))(&uStack_248,4,1);
      }
      else if (local_244 == 0x51) {
        (**(code **)(*param_1 + 0xc))(in_ECX + 0x11,1,1);
      }
      else {
LAB_007238df:
        (**(code **)(*param_1 + 0x24))(uStack_240);
      }
    }
    if (local_244 != 0x53) break;
    (**(code **)(*param_1 + 0xc))(in_ECX + 0x13,1,1);
  } while( true );
  if (local_244 != 0x61) {
    if (local_244 != 0x122) goto LAB_007238df;
    goto LAB_0072391e;
  }
  cVar2 = FUN_004cd4c0(param_1);
  if (cVar2 == '\0') {
LAB_0072391e:
    ExceptionList = local_14;
    __security_check_cookie(local_1c ^ (uint)auStack_24c);
    return;
  }
  goto LAB_007237b0;
}



============================================================
DISASSEMBLY
============================================================
00723760 : PUSH EBP
00723761 : MOV EBP,ESP
00723763 : AND ESP,0xfffffff8
00723766 : PUSH -0x1
00723768 : PUSH 0xb3692d
0072376d : MOV EAX,FS:[0x0]
00723773 : PUSH EAX
00723774 : SUB ESP,0x238
0072377a : MOV EAX,[0x00d66fa0]
0072377f : XOR EAX,ESP
00723781 : MOV dword ptr [ESP + 0x230],EAX
00723788 : PUSH EBX
00723789 : PUSH ESI
0072378a : PUSH EDI
0072378b : MOV EAX,[0x00d66fa0]
00723790 : XOR EAX,ESP
00723792 : PUSH EAX
00723793 : LEA EAX,[ESP + 0x248]
0072379a : MOV FS:[0x0],EAX
007237a0 : MOV ESI,dword ptr [EBP + 0x8]
007237a3 : MOV EDI,ECX
007237a5 : XOR EBX,EBX
007237a7 : JMP 0x007237b0
007237b0 : MOV EAX,dword ptr [ESI + 0x24]
007237b3 : CMP EAX,dword ptr [ESI + 0x20]
007237b6 : JNC 0x0072391c
007237bc : MOV EDX,dword ptr [ESI]
007237be : MOV EDX,dword ptr [EDX + 0x1c]
007237c1 : LEA EAX,[ESP + 0x18]
007237c5 : PUSH EAX
007237c6 : MOV ECX,ESI
007237c8 : CALL EDX
007237ca : TEST AL,AL
007237cc : JZ 0x00723902
007237d2 : MOV EAX,dword ptr [ESP + 0x18]
007237d6 : CMP EAX,0x52
007237d9 : JA 0x007238ce
007237df : JZ 0x007238b8
007237e5 : CMP EAX,0x10
007237e8 : JZ 0x00723827
007237ea : CMP EAX,0x13
007237ed : JZ 0x0072380b
007237ef : CMP EAX,0x51
007237f2 : JNZ 0x007238df
007237f8 : MOV EAX,dword ptr [ESI]
007237fa : MOV EDX,dword ptr [EAX + 0xc]
007237fd : PUSH 0x1
007237ff : PUSH 0x1
00723801 : LEA ECX,[EDI + 0x11]
00723804 : PUSH ECX
00723805 : MOV ECX,ESI
00723807 : CALL EDX
00723809 : JMP 0x007237b0
0072380b : MOV EAX,dword ptr [ESI]
0072380d : MOV EDX,dword ptr [EAX + 0xc]
00723810 : PUSH 0x1
00723812 : PUSH 0x4
00723814 : LEA ECX,[ESP + 0x1c]
00723818 : PUSH ECX
00723819 : MOV ECX,ESI
0072381b : MOV dword ptr [ESP + 0x20],0xffffffff
00723823 : CALL EDX
00723825 : JMP 0x007237b0
00723827 : LEA EAX,[ESP + 0x3c]
0072382b : PUSH EAX
0072382c : MOV ECX,ESI
0072382e : CALL 0x0070d320
00723833 : XOR ECX,ECX
00723835 : LEA EAX,[ESP + 0x3c]
00723839 : MOV dword ptr [ESP + 0x38],0x7
00723841 : MOV dword ptr [ESP + 0x34],EBX
00723845 : MOV word ptr [ESP + 0x24],CX
0072384a : LEA EDX,[EAX + 0x2]
0072384d : LEA ECX,[ECX]
00723850 : MOV CX,word ptr [EAX]
00723853 : ADD EAX,0x2
00723856 : CMP CX,BX
00723859 : JNZ 0x00723850
0072385b : SUB EAX,EDX
0072385d : SAR EAX,0x1
0072385f : PUSH EAX
00723860 : LEA EDX,[ESP + 0x40]
00723864 : PUSH EDX
00723865 : LEA ECX,[ESP + 0x28]
00723869 : CALL 0x00406360
0072386e : MOV dword ptr [ESP + 0x250],EBX
00723875 : PUSH -0x1
00723877 : PUSH EBX
00723878 : LEA EAX,[ESP + 0x28]
0072387c : PUSH EAX
0072387d : LEA ECX,[EDI + 0x14]
00723880 : CALL 0x00405eb0
00723885 : MOV dword ptr [ESP + 0x250],0xffffffff
00723890 : CMP dword ptr [ESP + 0x38],0x8
00723895 : JC 0x007238a0
00723897 : MOV ECX,dword ptr [ESP + 0x24]
0072389b : CALL 0x006f04e0
007238a0 : XOR ECX,ECX
007238a2 : MOV dword ptr [ESP + 0x38],0x7
007238aa : MOV dword ptr [ESP + 0x34],EBX
007238ae : MOV word ptr [ESP + 0x24],CX
007238b3 : JMP 0x007237b0
007238b8 : MOV EDX,dword ptr [ESI]
007238ba : MOV EDX,dword ptr [EDX + 0xc]
007238bd : PUSH 0x1
007238bf : PUSH 0x1
007238c1 : LEA EAX,[EDI + 0x12]
007238c4 : PUSH EAX
007238c5 : MOV ECX,ESI
007238c7 : CALL EDX
007238c9 : JMP 0x007237b0
007238ce : CMP EAX,0x53
007238d1 : JZ 0x00723906
007238d3 : CMP EAX,0x61
007238d6 : JZ 0x007238f2
007238d8 : CMP EAX,0x122
007238dd : JZ 0x0072391c
007238df : MOV ECX,dword ptr [ESP + 0x1c]
007238e3 : MOV EAX,dword ptr [ESI]
007238e5 : MOV EDX,dword ptr [EAX + 0x24]
007238e8 : PUSH ECX
007238e9 : MOV ECX,ESI
007238eb : CALL EDX
007238ed : JMP 0x007237b0
007238f2 : PUSH ESI
007238f3 : MOV ECX,EDI
007238f5 : CALL 0x004cd4c0
007238fa : TEST AL,AL
007238fc : JNZ 0x007237b0
00723902 : XOR AL,AL
00723904 : JMP 0x0072391e
00723906 : MOV EAX,dword ptr [ESI]
00723908 : MOV EDX,dword ptr [EAX + 0xc]
0072390b : PUSH 0x1
0072390d : PUSH 0x1
0072390f : LEA ECX,[EDI + 0x13]
00723912 : PUSH ECX
00723913 : MOV ECX,ESI
00723915 : CALL EDX
00723917 : JMP 0x007237b0
0072391c : MOV AL,0x1
0072391e : MOV ECX,dword ptr [ESP + 0x248]
00723925 : MOV dword ptr FS:[0x0],ECX
0072392c : POP ECX
0072392d : POP EDI
0072392e : POP ESI
0072392f : POP EBX
00723930 : MOV ECX,dword ptr [ESP + 0x230]
00723937 : XOR ECX,ESP
00723939 : CALL 0x00633e6b
0072393e : MOV ESP,EBP
00723940 : POP EBP
00723941 : RET 0x4

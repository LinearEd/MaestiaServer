PROGRAM  : Maestia.exe
FUNCTION : FUN_0072ddd0
ENTRY    : 0072ddd0
BODY     : [[0072ddd0, 0072de43]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_0072ddd0(void)

{
  int unaff_ESI;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b0df9d;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  EnterCriticalSection((LPCRITICAL_SECTION)(unaff_ESI + 0x1c));
  local_8 = 0;
  *(undefined4 *)(unaff_ESI + 0x34) = 0;
  if (*(int *)(unaff_ESI + 0x58) < 1) {
    ResetEvent(*(HANDLE *)(unaff_ESI + 0x6c));
  }
  else {
    SetEvent(*(HANDLE *)(unaff_ESI + 0x6c));
  }
  local_8 = 0xffffffff;
  LeaveCriticalSection((LPCRITICAL_SECTION)(unaff_ESI + 0x1c));
  ExceptionList = local_10;
  return 0;
}



============================================================
DISASSEMBLY
============================================================
0072ddd0 : PUSH EBP
0072ddd1 : MOV EBP,ESP
0072ddd3 : PUSH -0x1
0072ddd5 : PUSH 0xb0df9d
0072ddda : MOV EAX,FS:[0x0]
0072dde0 : PUSH EAX
0072dde1 : PUSH ECX
0072dde2 : PUSH EDI
0072dde3 : MOV EAX,[0x00d66fa0]
0072dde8 : XOR EAX,EBP
0072ddea : PUSH EAX
0072ddeb : LEA EAX,[EBP + -0xc]
0072ddee : MOV FS:[0x0],EAX
0072ddf4 : LEA EDI,[ESI + 0x1c]
0072ddf7 : PUSH EDI
0072ddf8 : MOV dword ptr [EBP + -0x10],EDI
0072ddfb : CALL dword ptr [0x00b85118]
0072de01 : XOR EAX,EAX
0072de03 : MOV dword ptr [EBP + -0x4],EAX
0072de06 : CMP dword ptr [ESI + 0x58],EAX
0072de09 : MOV dword ptr [ESI + 0x34],EAX
0072de0c : JLE 0x0072de1a
0072de0e : MOV EAX,dword ptr [ESI + 0x6c]
0072de11 : PUSH EAX
0072de12 : CALL dword ptr [0x00b851e8]
0072de18 : JMP 0x0072de24
0072de1a : MOV ECX,dword ptr [ESI + 0x6c]
0072de1d : PUSH ECX
0072de1e : CALL dword ptr [0x00b851dc]
0072de24 : MOV dword ptr [EBP + -0x4],0xffffffff
0072de2b : PUSH EDI
0072de2c : CALL dword ptr [0x00b8511c]
0072de32 : XOR EAX,EAX
0072de34 : MOV ECX,dword ptr [EBP + -0xc]
0072de37 : MOV dword ptr FS:[0x0],ECX
0072de3e : POP ECX
0072de3f : POP EDI
0072de40 : MOV ESP,EBP
0072de42 : POP EBP
0072de43 : RET

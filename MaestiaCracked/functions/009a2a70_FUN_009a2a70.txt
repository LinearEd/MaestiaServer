PROGRAM  : Maestia.exe
FUNCTION : FUN_009a2a70
ENTRY    : 009a2a70
BODY     : [[009a2a70, 009a2c61]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009a2a70(int *param_1,undefined4 param_2)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  int *in_ECX;
  int local_38;
  int local_34;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4e465;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if ((param_1 != (int *)0x0) && ((char)in_ECX[2] != '\0')) {
    (**(code **)(*in_ECX + 0x9c))(param_1,param_2,local_14);
  }
  FUN_009a0750();
  if (param_1 != (int *)0x0) {
    iVar3 = FUN_009f2740(param_1[4]);
    if (iVar3 != 0) {
      FUN_00406460(&DAT_00c8920c);
      local_8 = 0;
      (**(code **)(*param_1 + 0x78))(local_30);
      local_34 = CONCAT31(local_34._1_3_,*(undefined1 *)(iVar3 + 0xb1));
      iVar3 = (**(code **)(*in_ECX + 0x98))(param_2);
      if (iVar3 != 0) {
        FUN_009a1370(local_34);
      }
      local_8 = 0xffffffff;
      if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_18 = 7;
      local_1c = 0;
      local_2c = 0;
    }
    iVar3 = DAT_00d7c54c;
    local_34 = param_1[4];
    FUN_004437f0(&local_34);
    if (local_38 == *(int *)(iVar3 + 0x44)) {
      iVar3 = 0;
    }
    else {
      iVar3 = *(int *)(local_38 + 0x10);
      if ((((iVar3 != 0) && ((*(uint *)(iVar3 + 0x4c) & 0x100000) != 0)) && (*DAT_00da9894 != 0)) &&
         ((iVar1 = *(int *)(*DAT_00da9894 + 0x2cc), iVar1 != 0 &&
          (*(char *)(iVar1 + 0x32) == '\x01')))) {
        FUN_0099c7f0(iVar1);
      }
    }
    piVar2 = *(int **)(*DAT_00da9894 + 0x1f0);
    if (piVar2 != (int *)0x0) {
      if (*(char *)((int)piVar2 + 0x32) == '\0') {
        if (((piVar2 != (int *)0x0) && (param_1[0x2c] / 1000 < 0x33)) &&
           ((iVar3 != 0 && ((*(uint *)(iVar3 + 0x4c) & 0x100000) == 0)))) {
          (**(code **)(*piVar2 + 0x18))(0,300);
        }
      }
      else {
        FUN_008c9710(piVar2,1);
      }
    }
  }
  FUN_009a2650(in_ECX,param_1);
  if (DAT_017247f0 != 0) {
    FUN_009f3180(2,*(undefined4 *)(*(int *)(DAT_0172491c + 0x17c) + 0xa8),1);
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
009a2a70 : PUSH EBP
009a2a71 : MOV EBP,ESP
009a2a73 : PUSH -0x1
009a2a75 : PUSH 0xb4e465
009a2a7a : MOV EAX,FS:[0x0]
009a2a80 : PUSH EAX
009a2a81 : SUB ESP,0x28
009a2a84 : MOV EAX,[0x00d66fa0]
009a2a89 : XOR EAX,EBP
009a2a8b : MOV dword ptr [EBP + -0x10],EAX
009a2a8e : PUSH EBX
009a2a8f : PUSH ESI
009a2a90 : PUSH EDI
009a2a91 : PUSH EAX
009a2a92 : LEA EAX,[EBP + -0xc]
009a2a95 : MOV FS:[0x0],EAX
009a2a9b : MOV EDI,dword ptr [EBP + 0x8]
009a2a9e : MOV EBX,ECX
009a2aa0 : TEST EDI,EDI
009a2aa2 : JZ 0x009a2abb
009a2aa4 : CMP byte ptr [EBX + 0x8],0x0
009a2aa8 : JZ 0x009a2abb
009a2aaa : MOV ECX,dword ptr [EBP + 0xc]
009a2aad : MOV EAX,dword ptr [EBX]
009a2aaf : MOV EDX,dword ptr [EAX + 0x9c]
009a2ab5 : PUSH ECX
009a2ab6 : PUSH EDI
009a2ab7 : MOV ECX,EBX
009a2ab9 : CALL EDX
009a2abb : MOV ESI,EBX
009a2abd : CALL 0x009a0750
009a2ac2 : TEST EDI,EDI
009a2ac4 : JZ 0x009a2c14
009a2aca : MOV EAX,dword ptr [EDI + 0x10]
009a2acd : MOV ECX,dword ptr [0x017247f0]
009a2ad3 : PUSH EAX
009a2ad4 : CALL 0x009f2740
009a2ad9 : MOV ESI,EAX
009a2adb : TEST ESI,ESI
009a2add : JZ 0x009a2b54
009a2adf : PUSH 0xc8920c
009a2ae4 : LEA ECX,[EBP + -0x2c]
009a2ae7 : CALL 0x00406460
009a2aec : MOV dword ptr [EBP + -0x4],0x0
009a2af3 : MOV EAX,dword ptr [EDI]
009a2af5 : MOV EDX,dword ptr [EAX + 0x78]
009a2af8 : LEA ECX,[EBP + -0x2c]
009a2afb : PUSH ECX
009a2afc : MOV ECX,EDI
009a2afe : CALL EDX
009a2b00 : MOV AL,byte ptr [ESI + 0xb1]
009a2b06 : MOV EDX,dword ptr [EBX]
009a2b08 : MOV EDX,dword ptr [EDX + 0x98]
009a2b0e : MOV byte ptr [EBP + -0x30],AL
009a2b11 : MOV EAX,dword ptr [EBP + 0xc]
009a2b14 : PUSH EAX
009a2b15 : MOV ECX,EBX
009a2b17 : CALL EDX
009a2b19 : TEST EAX,EAX
009a2b1b : JZ 0x009a2b2b
009a2b1d : MOV ECX,dword ptr [EBP + -0x30]
009a2b20 : PUSH ECX
009a2b21 : MOV ESI,EAX
009a2b23 : LEA ECX,[EBP + -0x2c]
009a2b26 : CALL 0x009a1370
009a2b2b : MOV dword ptr [EBP + -0x4],0xffffffff
009a2b32 : CMP dword ptr [EBP + -0x14],0x8
009a2b36 : JC 0x009a2b40
009a2b38 : MOV ECX,dword ptr [EBP + -0x28]
009a2b3b : CALL 0x006f04e0
009a2b40 : XOR EDX,EDX
009a2b42 : MOV dword ptr [EBP + -0x14],0x7
009a2b49 : MOV dword ptr [EBP + -0x18],0x0
009a2b50 : MOV word ptr [EBP + -0x28],DX
009a2b54 : MOV EAX,dword ptr [EDI + 0x10]
009a2b57 : MOV ESI,dword ptr [0x00d7c54c]
009a2b5d : LEA ECX,[EBP + -0x30]
009a2b60 : MOV dword ptr [EBP + -0x30],EAX
009a2b63 : PUSH ECX
009a2b64 : LEA ECX,[ESI + 0x40]
009a2b67 : LEA EAX,[EBP + -0x34]
009a2b6a : CALL 0x004437f0
009a2b6f : MOV EAX,dword ptr [EBP + -0x34]
009a2b72 : CMP EAX,dword ptr [ESI + 0x44]
009a2b75 : JZ 0x009a2bd0
009a2b77 : MOV ESI,dword ptr [EAX + 0x10]
009a2b7a : TEST ESI,ESI
009a2b7c : JZ 0x009a2baf
009a2b7e : MOV ECX,dword ptr [ESI + 0x4c]
009a2b81 : AND ECX,0x100000
009a2b87 : XOR EAX,EAX
009a2b89 : OR EAX,ECX
009a2b8b : JZ 0x009a2baf
009a2b8d : MOV EDX,dword ptr [0x00da9894]
009a2b93 : MOV EAX,dword ptr [EDX]
009a2b95 : TEST EAX,EAX
009a2b97 : JZ 0x009a2baf
009a2b99 : MOV EAX,dword ptr [EAX + 0x2cc]
009a2b9f : TEST EAX,EAX
009a2ba1 : JZ 0x009a2baf
009a2ba3 : CMP byte ptr [EAX + 0x32],0x1
009a2ba7 : JNZ 0x009a2baf
009a2ba9 : PUSH EAX
009a2baa : CALL 0x0099c7f0
009a2baf : MOV EAX,[0x00da9894]
009a2bb4 : MOV ECX,dword ptr [EAX]
009a2bb6 : MOV ECX,dword ptr [ECX + 0x1f0]
009a2bbc : TEST ECX,ECX
009a2bbe : JZ 0x009a2c14
009a2bc0 : CMP byte ptr [ECX + 0x32],0x0
009a2bc4 : JZ 0x009a2bd4
009a2bc6 : PUSH 0x1
009a2bc8 : PUSH ECX
009a2bc9 : CALL 0x008c9710
009a2bce : JMP 0x009a2c14
009a2bd0 : XOR ESI,ESI
009a2bd2 : JMP 0x009a2baf
009a2bd4 : TEST ECX,ECX
009a2bd6 : JZ 0x009a2c14
009a2bd8 : MOV EDX,dword ptr [EDI + 0xb0]
009a2bde : MOV EAX,0x10624dd3
009a2be3 : IMUL EDX
009a2be5 : SAR EDX,0x6
009a2be8 : MOV EAX,EDX
009a2bea : SHR EAX,0x1f
009a2bed : ADD EAX,EDX
009a2bef : CMP EAX,0x32
009a2bf2 : JG 0x009a2c14
009a2bf4 : TEST ESI,ESI
009a2bf6 : JZ 0x009a2c14
009a2bf8 : MOV EDX,dword ptr [ESI + 0x4c]
009a2bfb : AND EDX,0x100000
009a2c01 : XOR EAX,EAX
009a2c03 : OR EAX,EDX
009a2c05 : JNZ 0x009a2c14
009a2c07 : MOV EDX,dword ptr [ECX]
009a2c09 : PUSH 0x12c
009a2c0e : PUSH EAX
009a2c0f : MOV EAX,dword ptr [EDX + 0x18]
009a2c12 : CALL EAX
009a2c14 : MOV ECX,dword ptr [EBP + 0xc]
009a2c17 : PUSH EDI
009a2c18 : PUSH EBX
009a2c19 : CALL 0x009a2650
009a2c1e : MOV ECX,dword ptr [0x017247f0]
009a2c24 : TEST ECX,ECX
009a2c26 : JZ 0x009a2c44
009a2c28 : MOV EDX,dword ptr [0x0172491c]
009a2c2e : MOV EAX,dword ptr [EDX + 0x17c]
009a2c34 : MOV EDX,dword ptr [EAX + 0xa8]
009a2c3a : PUSH 0x1
009a2c3c : PUSH EDX
009a2c3d : PUSH 0x2
009a2c3f : CALL 0x009f3180
009a2c44 : MOV ECX,dword ptr [EBP + -0xc]
009a2c47 : MOV dword ptr FS:[0x0],ECX
009a2c4e : POP ECX
009a2c4f : POP EDI
009a2c50 : POP ESI
009a2c51 : POP EBX
009a2c52 : MOV ECX,dword ptr [EBP + -0x10]
009a2c55 : XOR ECX,EBP
009a2c57 : CALL 0x00633e6b
009a2c5c : MOV ESP,EBP
009a2c5e : POP EBP
009a2c5f : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_0096a000
ENTRY    : 0096a000
BODY     : [[0096a000, 0096a16c]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0096a000(void)

{
  short *psVar1;
  short sVar2;
  uint uVar3;
  uint uVar4;
  short *psVar5;
  int iVar6;
  undefined4 ***pppuVar7;
  int in_ECX;
  uint local_34;
  undefined1 local_30 [4];
  undefined4 **local_2c [4];
  int local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b540ec;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  psVar1 = (short *)(in_ECX + 0x19);
  psVar5 = psVar1;
  do {
    sVar2 = *psVar5;
    psVar5 = psVar5 + 1;
  } while (sVar2 != 0);
  local_14 = uVar4;
  iVar6 = FUN_00405bb0(psVar1);
  if (iVar6 != 0) {
    FUN_00406460(psVar1);
    local_8 = 0;
    FUN_00969770(local_30,*(undefined4 *)(in_ECX + 0xd),*(undefined4 *)(in_ECX + 0x11),
                 *(undefined4 *)(in_ECX + 9),*(undefined4 *)(in_ECX + 0x15),
                 *(undefined1 *)(in_ECX + 4),*(undefined2 *)(in_ECX + 7),*(undefined2 *)(in_ECX + 5)
                );
    uVar3 = local_18;
    local_8 = CONCAT31(local_8._1_3_,2);
    if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    pppuVar7 = (undefined4 ***)local_2c[0];
    if (local_18 < 8) {
      pppuVar7 = local_2c;
    }
    iVar6 = FUN_00405b70(pppuVar7,uVar4);
    if ((((iVar6 != 0) || (local_1c != 0)) && (iVar6 = *DAT_00da9894, iVar6 != 0)) &&
       (*(int *)(iVar6 + 0x114) != 0)) {
      pppuVar7 = (undefined4 ***)local_2c[0];
      if (uVar3 < 8) {
        pppuVar7 = local_2c;
      }
      (**(code **)(**(int **)(iVar6 + 0x114) + 4))
                (*(int **)(iVar6 + 0x114),"ServerEventMsg","%ls, %d",pppuVar7,
                 *(undefined4 *)(in_ECX + 9));
    }
    local_8 = 0xffffffff;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c[0] = (undefined4 **)((uint)local_2c[0] & 0xffff0000);
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0096a000 : PUSH EBP
0096a001 : MOV EBP,ESP
0096a003 : PUSH -0x1
0096a005 : PUSH 0xb540ec
0096a00a : MOV EAX,FS:[0x0]
0096a010 : PUSH EAX
0096a011 : SUB ESP,0x3c
0096a014 : MOV EAX,[0x00d66fa0]
0096a019 : XOR EAX,EBP
0096a01b : MOV dword ptr [EBP + -0x10],EAX
0096a01e : PUSH EBX
0096a01f : PUSH ESI
0096a020 : PUSH EDI
0096a021 : PUSH EAX
0096a022 : LEA EAX,[EBP + -0xc]
0096a025 : MOV FS:[0x0],EAX
0096a02b : MOV EAX,[0x0172491c]
0096a030 : MOV EAX,dword ptr [EAX + 0x17c]
0096a036 : MOV ESI,ECX
0096a038 : LEA EBX,[ESI + 0x19]
0096a03b : LEA ECX,[EAX + 0xc]
0096a03e : MOV EAX,EBX
0096a040 : LEA EDI,[EAX + 0x2]
0096a043 : MOV DX,word ptr [EAX]
0096a046 : ADD EAX,0x2
0096a049 : TEST DX,DX
0096a04c : JNZ 0x0096a043
0096a04e : SUB EAX,EDI
0096a050 : SAR EAX,0x1
0096a052 : MOV EDI,EAX
0096a054 : MOV EAX,dword ptr [ECX + 0x14]
0096a057 : PUSH EBX
0096a058 : CALL 0x00405bb0
0096a05d : TEST EAX,EAX
0096a05f : JZ 0x0096a151
0096a065 : PUSH EBX
0096a066 : LEA ECX,[EBP + -0x48]
0096a069 : CALL 0x00406460
0096a06e : XOR EBX,EBX
0096a070 : MOV dword ptr [EBP + -0x4],EBX
0096a073 : MOVZX ECX,word ptr [ESI + 0x5]
0096a077 : MOVZX EDX,word ptr [ESI + 0x7]
0096a07b : PUSH ECX
0096a07c : MOVZX ECX,byte ptr [ESI + 0x4]
0096a080 : PUSH EDX
0096a081 : MOV EDX,dword ptr [ESI + 0x15]
0096a084 : PUSH ECX
0096a085 : MOV ECX,dword ptr [ESI + 0x9]
0096a088 : PUSH EDX
0096a089 : MOV EDX,dword ptr [ESI + 0x11]
0096a08c : PUSH ECX
0096a08d : MOV ECX,dword ptr [ESI + 0xd]
0096a090 : PUSH EDX
0096a091 : PUSH ECX
0096a092 : LEA EDX,[EBP + -0x2c]
0096a095 : PUSH EDX
0096a096 : MOV ECX,EAX
0096a098 : CALL 0x00969770
0096a09d : MOV byte ptr [EBP + -0x4],0x2
0096a0a1 : CMP dword ptr [EBP + -0x30],0x8
0096a0a5 : JC 0x0096a0af
0096a0a7 : MOV ECX,dword ptr [EBP + -0x44]
0096a0aa : CALL 0x006f04e0
0096a0af : MOV EDI,dword ptr [EBP + -0x14]
0096a0b2 : XOR EAX,EAX
0096a0b4 : MOV word ptr [EBP + -0x44],AX
0096a0b8 : MOV EAX,dword ptr [EBP + -0x28]
0096a0bb : MOV dword ptr [EBP + -0x30],0x7
0096a0c2 : MOV dword ptr [EBP + -0x34],EBX
0096a0c5 : CMP EDI,0x8
0096a0c8 : JNC 0x0096a0cd
0096a0ca : LEA EAX,[EBP + -0x28]
0096a0cd : PUSH EAX
0096a0ce : XOR EDX,EDX
0096a0d0 : MOV ECX,0xc7b124
0096a0d5 : CALL 0x00405b70
0096a0da : ADD ESP,0x4
0096a0dd : CMP EAX,EBX
0096a0df : JNZ 0x0096a0ed
0096a0e1 : XOR EAX,EAX
0096a0e3 : CMP dword ptr [EBP + -0x18],EBX
0096a0e6 : SETNZ AL
0096a0e9 : CMP EAX,EBX
0096a0eb : JZ 0x0096a12c
0096a0ed : MOV ECX,dword ptr [0x00da9894]
0096a0f3 : MOV EAX,dword ptr [ECX]
0096a0f5 : CMP EAX,EBX
0096a0f7 : JZ 0x0096a12c
0096a0f9 : CMP dword ptr [EAX + 0x114],EBX
0096a0ff : JZ 0x0096a12c
0096a101 : MOV EAX,dword ptr [EAX + 0x114]
0096a107 : MOV ECX,dword ptr [EBP + -0x28]
0096a10a : CMP EDI,0x8
0096a10d : JNC 0x0096a112
0096a10f : LEA ECX,[EBP + -0x28]
0096a112 : MOV ESI,dword ptr [ESI + 0x9]
0096a115 : MOV EDX,dword ptr [EAX]
0096a117 : PUSH ESI
0096a118 : PUSH ECX
0096a119 : PUSH 0xc7b128
0096a11e : PUSH 0xc7b130
0096a123 : PUSH EAX
0096a124 : MOV EAX,dword ptr [EDX + 0x4]
0096a127 : CALL EAX
0096a129 : ADD ESP,0x14
0096a12c : MOV dword ptr [EBP + -0x4],0xffffffff
0096a133 : CMP dword ptr [EBP + -0x14],0x8
0096a137 : JC 0x0096a141
0096a139 : MOV ECX,dword ptr [EBP + -0x28]
0096a13c : CALL 0x006f04e0
0096a141 : XOR ECX,ECX
0096a143 : MOV dword ptr [EBP + -0x14],0x7
0096a14a : MOV dword ptr [EBP + -0x18],EBX
0096a14d : MOV word ptr [EBP + -0x28],CX
0096a151 : MOV ECX,dword ptr [EBP + -0xc]
0096a154 : MOV dword ptr FS:[0x0],ECX
0096a15b : POP ECX
0096a15c : POP EDI
0096a15d : POP ESI
0096a15e : POP EBX
0096a15f : MOV ECX,dword ptr [EBP + -0x10]
0096a162 : XOR ECX,EBP
0096a164 : CALL 0x00633e6b
0096a169 : MOV ESP,EBP
0096a16b : POP EBP
0096a16c : RET

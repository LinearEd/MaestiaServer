PROGRAM  : Maestia.exe
FUNCTION : FUN_00a6e4f0
ENTRY    : 00a6e4f0
BODY     : [[00a6e4f0, 00a6e5c8]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a6e4f0(void)

{
  int *piVar1;
  int unaff_ESI;
  char local_64;
  undefined1 local_3c [32];
  undefined4 local_1c;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b5f602;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  piVar1 = (int *)**(int **)(unaff_ESI + 0x48);
  if (piVar1 != *(int **)(unaff_ESI + 0x48)) {
    do {
      FUN_00440460();
      local_8 = 0;
      if (local_64 == '\0') {
        FUN_00405eb0(local_3c,0,0xffffffff);
        local_8 = local_8 & 0xffffff00;
        FUN_00a6d930(unaff_ESI,1,local_1c,0);
      }
      else {
        FUN_00a6d180();
      }
      local_8 = 0xffffffff;
      FUN_004403d0();
      piVar1 = (int *)*piVar1;
    } while (piVar1 != (int *)*(int *)(unaff_ESI + 0x48));
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a6e4f0 : PUSH EBP
00a6e4f1 : MOV EBP,ESP
00a6e4f3 : PUSH -0x1
00a6e4f5 : PUSH 0xb5f602
00a6e4fa : MOV EAX,FS:[0x0]
00a6e500 : PUSH EAX
00a6e501 : SUB ESP,0x58
00a6e504 : MOV EAX,[0x00d66fa0]
00a6e509 : XOR EAX,EBP
00a6e50b : MOV dword ptr [EBP + -0x10],EAX
00a6e50e : PUSH EBX
00a6e50f : PUSH EDI
00a6e510 : PUSH EAX
00a6e511 : LEA EAX,[EBP + -0xc]
00a6e514 : MOV FS:[0x0],EAX
00a6e51a : MOV EAX,dword ptr [ESI + 0x48]
00a6e51d : MOV EBX,dword ptr [EAX]
00a6e51f : CMP EBX,EAX
00a6e521 : JZ 0x00a6e5ae
00a6e527 : LEA EAX,[EBP + -0x60]
00a6e52a : LEA EDI,[EBX + 0x8]
00a6e52d : PUSH EAX
00a6e52e : CALL 0x00440460
00a6e533 : XOR EDI,EDI
00a6e535 : MOV dword ptr [EBP + -0x4],EDI
00a6e538 : CMP byte ptr [EBP + -0x60],0x0
00a6e53c : JZ 0x00a6e550
00a6e53e : MOV ECX,dword ptr [EBP + -0x58]
00a6e541 : PUSH EDI
00a6e542 : PUSH ECX
00a6e543 : MOV ECX,dword ptr [EBP + -0x5c]
00a6e546 : PUSH 0x1
00a6e548 : PUSH ESI
00a6e549 : CALL 0x00a6d180
00a6e54e : JMP 0x00a6e593
00a6e550 : MOV EDX,dword ptr [EBP + -0x57]
00a6e553 : PUSH EDX
00a6e554 : SUB ESP,0x1c
00a6e557 : MOV ECX,ESP
00a6e559 : MOV dword ptr [EBP + -0x64],ESP
00a6e55c : PUSH -0x1
00a6e55e : PUSH EDI
00a6e55f : LEA EDX,[EBP + -0x38]
00a6e562 : XOR EAX,EAX
00a6e564 : MOV dword ptr [ECX + 0x18],0x7
00a6e56b : MOV dword ptr [ECX + 0x14],EDI
00a6e56e : PUSH EDX
00a6e56f : MOV word ptr [ECX + 0x4],AX
00a6e573 : CALL 0x00405eb0
00a6e578 : MOV byte ptr [EBP + -0x4],0x1
00a6e57c : MOV EAX,dword ptr [EBP + -0x18]
00a6e57f : PUSH EDI
00a6e580 : PUSH EAX
00a6e581 : PUSH 0x1
00a6e583 : PUSH ESI
00a6e584 : MOV byte ptr [EBP + -0x4],0x0
00a6e588 : MOV EDX,dword ptr [EBP + -0x1c]
00a6e58b : LEA ECX,[EBP + -0x54]
00a6e58e : CALL 0x00a6d930
00a6e593 : MOV dword ptr [EBP + -0x4],0xffffffff
00a6e59a : LEA ECX,[EBP + -0x60]
00a6e59d : PUSH ECX
00a6e59e : CALL 0x004403d0
00a6e5a3 : MOV EBX,dword ptr [EBX]
00a6e5a5 : CMP EBX,dword ptr [ESI + 0x48]
00a6e5a8 : JNZ 0x00a6e527
00a6e5ae : MOV ECX,dword ptr [EBP + -0xc]
00a6e5b1 : MOV dword ptr FS:[0x0],ECX
00a6e5b8 : POP ECX
00a6e5b9 : POP EDI
00a6e5ba : POP EBX
00a6e5bb : MOV ECX,dword ptr [EBP + -0x10]
00a6e5be : XOR ECX,EBP
00a6e5c0 : CALL 0x00633e6b
00a6e5c5 : MOV ESP,EBP
00a6e5c7 : POP EBP
00a6e5c8 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_006d6cb0
ENTRY    : 006d6cb0
BODY     : [[006d6cb0, 006d6d77]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_006d6cb0(void)

{
  uint *puVar1;
  uint uVar2;
  uint uVar3;
  int unaff_ESI;
  
  if (*(int *)(unaff_ESI + 0x14) != 0xcc) {
    (*(code *)**(undefined4 **)(unaff_ESI + 0x180))();
    *(undefined4 *)(unaff_ESI + 0x78) = 0;
    *(undefined4 *)(unaff_ESI + 0x14) = 0xcc;
  }
  if (*(char *)(*(int *)(unaff_ESI + 0x180) + 8) != '\0') {
    puVar1 = (uint *)(unaff_ESI + 0x78);
    do {
      uVar3 = *puVar1;
      if (uVar3 < *(uint *)(unaff_ESI + 0x60)) {
        do {
          if (*(int *)(unaff_ESI + 8) != 0) {
            *(uint *)(*(int *)(unaff_ESI + 8) + 4) = uVar3;
            *(undefined4 *)(*(int *)(unaff_ESI + 8) + 8) = *(undefined4 *)(unaff_ESI + 0x60);
            (*(code *)**(undefined4 **)(unaff_ESI + 8))();
          }
          uVar2 = *puVar1;
          (**(code **)(*(int *)(unaff_ESI + 0x184) + 4))();
          uVar3 = *puVar1;
          if (uVar3 == uVar2) {
            return 0;
          }
        } while (uVar3 < *(uint *)(unaff_ESI + 0x60));
      }
      (**(code **)(*(int *)(unaff_ESI + 0x180) + 4))();
      (*(code *)**(undefined4 **)(unaff_ESI + 0x180))();
      *puVar1 = 0;
    } while (*(char *)(*(int *)(unaff_ESI + 0x180) + 8) != '\0');
  }
  *(uint *)(unaff_ESI + 0x14) = (*(char *)(unaff_ESI + 0x41) != '\0') + 0xcd;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
006d6cb0 : PUSH EBX
006d6cb1 : PUSH EDI
006d6cb2 : MOV EDI,0xcc
006d6cb7 : CMP dword ptr [ESI + 0x14],EDI
006d6cba : JZ 0x006d6cd4
006d6cbc : MOV EAX,dword ptr [ESI + 0x180]
006d6cc2 : MOV ECX,dword ptr [EAX]
006d6cc4 : PUSH ESI
006d6cc5 : CALL ECX
006d6cc7 : ADD ESP,0x4
006d6cca : MOV dword ptr [ESI + 0x78],0x0
006d6cd1 : MOV dword ptr [ESI + 0x14],EDI
006d6cd4 : MOV EDX,dword ptr [ESI + 0x180]
006d6cda : CMP byte ptr [EDX + 0x8],0x0
006d6cde : JZ 0x006d6d5d
006d6ce0 : LEA EDI,[ESI + 0x78]
006d6ce3 : MOV EAX,dword ptr [EDI]
006d6ce5 : CMP EAX,dword ptr [ESI + 0x60]
006d6ce8 : JNC 0x006d6d31
006d6cea : LEA EBX,[EBX]
006d6cf0 : MOV ECX,dword ptr [ESI + 0x8]
006d6cf3 : TEST ECX,ECX
006d6cf5 : JZ 0x006d6d0e
006d6cf7 : MOV dword ptr [ECX + 0x4],EAX
006d6cfa : MOV EAX,dword ptr [ESI + 0x8]
006d6cfd : MOV ECX,dword ptr [ESI + 0x60]
006d6d00 : MOV dword ptr [EAX + 0x8],ECX
006d6d03 : MOV EDX,dword ptr [ESI + 0x8]
006d6d06 : MOV EAX,dword ptr [EDX]
006d6d08 : PUSH ESI
006d6d09 : CALL EAX
006d6d0b : ADD ESP,0x4
006d6d0e : MOV ECX,dword ptr [ESI + 0x184]
006d6d14 : MOV EDX,dword ptr [ECX + 0x4]
006d6d17 : MOV EBX,dword ptr [EDI]
006d6d19 : PUSH 0x0
006d6d1b : PUSH EDI
006d6d1c : PUSH 0x0
006d6d1e : PUSH ESI
006d6d1f : CALL EDX
006d6d21 : MOV EAX,dword ptr [EDI]
006d6d23 : ADD ESP,0x10
006d6d26 : CMP EAX,EBX
006d6d28 : JZ 0x006d6d73
006d6d2a : MOV ECX,EAX
006d6d2c : CMP ECX,dword ptr [ESI + 0x60]
006d6d2f : JC 0x006d6cf0
006d6d31 : MOV EDX,dword ptr [ESI + 0x180]
006d6d37 : MOV EAX,dword ptr [EDX + 0x4]
006d6d3a : PUSH ESI
006d6d3b : CALL EAX
006d6d3d : MOV ECX,dword ptr [ESI + 0x180]
006d6d43 : MOV EDX,dword ptr [ECX]
006d6d45 : PUSH ESI
006d6d46 : CALL EDX
006d6d48 : MOV dword ptr [EDI],0x0
006d6d4e : MOV EAX,dword ptr [ESI + 0x180]
006d6d54 : ADD ESP,0x8
006d6d57 : CMP byte ptr [EAX + 0x8],0x0
006d6d5b : JNZ 0x006d6ce3
006d6d5d : XOR ECX,ECX
006d6d5f : CMP byte ptr [ESI + 0x41],CL
006d6d62 : POP EDI
006d6d63 : SETNZ CL
006d6d66 : MOV AL,0x1
006d6d68 : POP EBX
006d6d69 : ADD ECX,0xcd
006d6d6f : MOV dword ptr [ESI + 0x14],ECX
006d6d72 : RET
006d6d73 : POP EDI
006d6d74 : XOR AL,AL
006d6d76 : POP EBX
006d6d77 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_0041fbd0
ENTRY    : 0041fbd0
BODY     : [[0041fbd0, 0041fd38]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0041fbd0(void)

{
  void *_Src;
  rsize_t _DstSize;
  uint uVar1;
  undefined4 *_Dst;
  int iVar2;
  uint extraout_ECX;
  uint uVar3;
  uint uVar4;
  int iVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  uint local_8;
  
  local_8 = 1;
  uVar3 = DAT_017210f4;
  if (DAT_017210f4 == 0x71c71c7) {
    FUN_00442c50();
    uVar3 = extraout_ECX;
  }
  uVar4 = DAT_017210f8;
  uVar1 = uVar3 >> 1;
  if (uVar1 < 8) {
    uVar1 = 8;
  }
  else if (uVar1 < 2) goto LAB_0041fc1c;
  if (uVar3 <= 0x71c71c7 - uVar1) {
    local_8 = uVar1;
  }
LAB_0041fc1c:
  _Dst = (undefined4 *)FUN_004c1790();
  iVar5 = uVar4 * 4;
  iVar2 = (int)((DAT_017210f4 * 4 - (iVar5 + (int)DAT_017210f0)) + (int)DAT_017210f0) >> 2;
  puVar7 = _Dst + uVar4 + iVar2;
  if (iVar2 != 0) {
    _memmove_s(_Dst + uVar4,iVar2 * 4,(void *)(iVar5 + (int)DAT_017210f0),iVar2 * 4);
  }
  if (local_8 < uVar4) {
    iVar2 = (int)(local_8 * 4) >> 2;
    if (iVar2 != 0) {
      _DstSize = iVar2 * 4;
      _memmove_s(puVar7,_DstSize,DAT_017210f0,_DstSize);
    }
    _Src = (void *)(local_8 * 4 + (int)DAT_017210f0);
    iVar5 = (iVar5 - (int)_Src) + (int)DAT_017210f0 >> 2;
    puVar7 = _Dst + iVar5;
    uVar4 = local_8;
    if (iVar5 != 0) {
      _memmove_s(_Dst,iVar5 * 4,_Src,iVar5 * 4);
    }
  }
  else {
    iVar5 = iVar5 >> 2;
    puVar6 = puVar7 + iVar5;
    if (iVar5 != 0) {
      _memmove_s(puVar7,iVar5 * 4,DAT_017210f0,iVar5 * 4);
    }
    iVar5 = local_8 - uVar4;
    puVar7 = _Dst;
    if (iVar5 != 0) {
      for (; iVar5 != 0; iVar5 = iVar5 + -1) {
        *puVar6 = 0;
        puVar6 = puVar6 + 1;
      }
    }
  }
  if (uVar4 != 0) {
    for (; uVar4 != 0; uVar4 = uVar4 - 1) {
      *puVar7 = 0;
      puVar7 = puVar7 + 1;
    }
  }
  if (DAT_017210f0 == (void *)0x0) {
    DAT_017210f4 = DAT_017210f4 + local_8;
    DAT_017210f0 = _Dst;
    return;
  }
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
0041fbd0 : PUSH EBP
0041fbd1 : MOV EBP,ESP
0041fbd3 : SUB ESP,0x14
0041fbd6 : MOV ECX,dword ptr [0x017210f4]
0041fbdc : PUSH EBX
0041fbdd : MOV EAX,0x71c71c7
0041fbe2 : MOV EDX,0x1
0041fbe7 : SUB EAX,ECX
0041fbe9 : PUSH ESI
0041fbea : PUSH EDI
0041fbeb : MOV dword ptr [EBP + -0x4],EDX
0041fbee : CMP EAX,EDX
0041fbf0 : JNC 0x0041fbf7
0041fbf2 : CALL 0x00442c50
0041fbf7 : MOV EAX,ECX
0041fbf9 : SHR EAX,0x1
0041fbfb : CMP EAX,0x8
0041fbfe : JNC 0x0041fc07
0041fc00 : MOV EAX,0x8
0041fc05 : JMP 0x0041fc0c
0041fc07 : CMP EAX,0x1
0041fc0a : JBE 0x0041fc1c
0041fc0c : MOV ESI,0x71c71c7
0041fc11 : SUB ESI,EAX
0041fc13 : CMP ECX,ESI
0041fc15 : JA 0x0041fc1c
0041fc17 : MOV EDX,EAX
0041fc19 : MOV dword ptr [EBP + -0x4],EAX
0041fc1c : MOV ESI,dword ptr [0x017210f8]
0041fc22 : ADD ECX,EDX
0041fc24 : MOV dword ptr [EBP + -0xc],ESI
0041fc27 : CALL 0x004c1790
0041fc2c : MOV ECX,dword ptr [0x017210f0]
0041fc32 : MOV dword ptr [EBP + -0x8],EAX
0041fc35 : ADD ESI,ESI
0041fc37 : ADD ESI,ESI
0041fc39 : LEA EDX,[ESI + EAX*0x1]
0041fc3c : MOV EAX,[0x017210f4]
0041fc41 : ADD EAX,EAX
0041fc43 : ADD EAX,EAX
0041fc45 : LEA EDI,[ESI + ECX*0x1]
0041fc48 : SUB EAX,EDI
0041fc4a : ADD EAX,ECX
0041fc4c : SAR EAX,0x2
0041fc4f : LEA ECX,[EAX*0x4 + 0x0]
0041fc56 : LEA EBX,[ECX + EDX*0x1]
0041fc59 : TEST EAX,EAX
0041fc5b : JBE 0x0041fc69
0041fc5d : PUSH ECX
0041fc5e : PUSH EDI
0041fc5f : PUSH ECX
0041fc60 : PUSH EDX
0041fc61 : CALL 0x00634101
0041fc66 : ADD ESP,0x10
0041fc69 : MOV EDI,dword ptr [EBP + -0xc]
0041fc6c : MOV EAX,dword ptr [EBP + -0x4]
0041fc6f : CMP EDI,EAX
0041fc71 : JA 0x0041fcb7
0041fc73 : SAR ESI,0x2
0041fc76 : LEA EAX,[ESI*0x4 + 0x0]
0041fc7d : LEA ECX,[EAX + EBX*0x1]
0041fc80 : MOV dword ptr [EBP + -0x10],ECX
0041fc83 : TEST ESI,ESI
0041fc85 : JBE 0x0041fc99
0041fc87 : MOV EDX,dword ptr [0x017210f0]
0041fc8d : PUSH EAX
0041fc8e : PUSH EDX
0041fc8f : PUSH EAX
0041fc90 : PUSH EBX
0041fc91 : CALL 0x00634101
0041fc96 : ADD ESP,0x10
0041fc99 : MOV ECX,dword ptr [EBP + -0x4]
0041fc9c : SUB ECX,EDI
0041fc9e : JZ 0x0041fcaa
0041fca0 : MOV EDI,dword ptr [EBP + -0x10]
0041fca3 : XOR EAX,EAX
0041fca5 : STOSD.REP ES:EDI
0041fca7 : MOV EDI,dword ptr [EBP + -0xc]
0041fcaa : MOV EBX,dword ptr [EBP + -0x8]
0041fcad : TEST EDI,EDI
0041fcaf : JBE 0x0041fd14
0041fcb1 : MOV ECX,EDI
0041fcb3 : MOV EDI,EBX
0041fcb5 : JMP 0x0041fd10
0041fcb7 : LEA EDI,[EAX*0x4 + 0x0]
0041fcbe : MOV EAX,EDI
0041fcc0 : SAR EAX,0x2
0041fcc3 : TEST EAX,EAX
0041fcc5 : JBE 0x0041fcdd
0041fcc7 : MOV ECX,dword ptr [0x017210f0]
0041fccd : ADD EAX,EAX
0041fccf : ADD EAX,EAX
0041fcd1 : PUSH EAX
0041fcd2 : PUSH ECX
0041fcd3 : PUSH EAX
0041fcd4 : PUSH EBX
0041fcd5 : CALL 0x00634101
0041fcda : ADD ESP,0x10
0041fcdd : MOV EAX,[0x017210f0]
0041fce2 : MOV EBX,dword ptr [EBP + -0x8]
0041fce5 : LEA ECX,[EDI + EAX*0x1]
0041fce8 : SUB ESI,ECX
0041fcea : ADD ESI,EAX
0041fcec : SAR ESI,0x2
0041fcef : LEA EAX,[ESI*0x4 + 0x0]
0041fcf6 : LEA EDI,[EAX + EBX*0x1]
0041fcf9 : TEST ESI,ESI
0041fcfb : JBE 0x0041fd09
0041fcfd : PUSH EAX
0041fcfe : PUSH ECX
0041fcff : PUSH EAX
0041fd00 : PUSH EBX
0041fd01 : CALL 0x00634101
0041fd06 : ADD ESP,0x10
0041fd09 : MOV ECX,dword ptr [EBP + -0x4]
0041fd0c : TEST ECX,ECX
0041fd0e : JBE 0x0041fd14
0041fd10 : XOR EAX,EAX
0041fd12 : STOSD.REP ES:EDI
0041fd14 : MOV ECX,dword ptr [0x017210f0]
0041fd1a : TEST ECX,ECX
0041fd1c : JZ 0x0041fd23
0041fd1e : CALL 0x006f04e0
0041fd23 : MOV EDX,dword ptr [EBP + -0x4]
0041fd26 : ADD dword ptr [0x017210f4],EDX
0041fd2c : POP EDI
0041fd2d : POP ESI
0041fd2e : MOV dword ptr [0x017210f0],EBX
0041fd34 : POP EBX
0041fd35 : MOV ESP,EBP
0041fd37 : POP EBP
0041fd38 : RET

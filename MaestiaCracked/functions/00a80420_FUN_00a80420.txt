PROGRAM  : Maestia.exe
FUNCTION : FUN_00a80420
ENTRY    : 00a80420
BODY     : [[00a80420, 00a80807]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a80420(int param_1,uint param_2,char param_3)

{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  int *piVar4;
  uint uVar5;
  undefined1 uVar6;
  undefined1 local_2c [28];
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b350d8;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  iVar2 = FUN_00a7ffb0(DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
  if ((iVar2 < 0x14) || (param_3 == '\0')) {
    iVar1 = *(int *)(*(int *)(param_1 + 0x6c) + 0x1bc);
    if (iVar1 == 0) {
      if ((uint)(*(int *)(param_1 + 0x40) - *(int *)(param_1 + 0x3c) >> 2) <= param_2) {
        FUN_008018d0(L"AvaGuiPremiumShopItemBuy::SetBuyCheck sizeover");
        ExceptionList = local_10;
        return;
      }
      uVar5 = 0;
      for (piVar4 = *(int **)(param_1 + 0x3c); piVar4 != *(int **)(param_1 + 0x40);
          piVar4 = piVar4 + 1) {
        if (uVar5 == param_2) {
          if ((param_3 == '\0') || ((int)(iVar2 + (uint)*(ushort *)(*piVar4 + 0xd2)) < 0x14)) {
LAB_00a807e5:
            *(char *)(*piVar4 + 0xf0) = param_3;
          }
          else if (((DAT_0172491c != 0) && (*DAT_00da9894 != 0)) &&
                  (*(int *)(*DAT_00da9894 + 0x1a8) != 0)) {
            FUN_00406460(L"IDS_PREMIUMSHOP_BASKET_MAXIMUM_ITEMCOUNT");
            uVar6 = 2;
            local_8 = 2;
            piVar4 = *(int **)(*DAT_00da9894 + 0x1a8);
            uVar3 = FUN_0081d120(local_2c);
            local_8._0_1_ = 3;
LAB_00a807ba:
            (**(code **)(*piVar4 + 0x44))(uVar3,3);
            local_8 = CONCAT31(local_8._1_3_,uVar6);
            FUN_00406560();
            local_8 = 0xffffffff;
            FUN_00406560();
          }
          break;
        }
        uVar5 = uVar5 + 1;
      }
    }
    else if (iVar1 == 1) {
      if ((uint)(*(int *)(param_1 + 0x50) - *(int *)(param_1 + 0x4c) >> 2) <= param_2) {
        FUN_008018d0(L"AvaGuiPremiumShopItemBuy::SetBuyCheck(miliage) sizeover");
        ExceptionList = local_10;
        return;
      }
      uVar5 = 0;
      for (piVar4 = *(int **)(param_1 + 0x4c); piVar4 != *(int **)(param_1 + 0x50);
          piVar4 = piVar4 + 1) {
        if (uVar5 == param_2) {
          if ((param_3 == '\0') || ((int)(iVar2 + (uint)*(ushort *)(*piVar4 + 0xd2)) < 0x14))
          goto LAB_00a807e5;
          if ((DAT_0172491c != 0) &&
             ((*DAT_00da9894 != 0 && (*(int *)(*DAT_00da9894 + 0x1a8) != 0)))) {
            FUN_00406460(L"IDS_PREMIUMSHOP_BASKET_MAXIMUM_ITEMCOUNT");
            local_8 = 4;
            piVar4 = *(int **)(*DAT_00da9894 + 0x1a8);
            uVar3 = FUN_0081d120(local_2c);
            local_8._0_1_ = 5;
            (**(code **)(*piVar4 + 0x44))(uVar3,3);
            local_8 = CONCAT31(local_8._1_3_,4);
            goto LAB_00a804d6;
          }
          break;
        }
        uVar5 = uVar5 + 1;
      }
    }
    else if (iVar1 == 2) {
      if ((uint)(*(int *)(param_1 + 0x60) - *(int *)(param_1 + 0x5c) >> 2) <= param_2) {
        FUN_008018d0(L"AvaGuiPremiumShopItemBuy::SetBuyCheck(gold) sizeover");
        ExceptionList = local_10;
        return;
      }
      uVar5 = 0;
      for (piVar4 = *(int **)(param_1 + 0x5c); piVar4 != *(int **)(param_1 + 0x60);
          piVar4 = piVar4 + 1) {
        if (uVar5 == param_2) {
          if ((param_3 == '\0') || ((int)(iVar2 + (uint)*(ushort *)(*piVar4 + 0xd2)) < 0x14))
          goto LAB_00a807e5;
          if ((DAT_0172491c != 0) &&
             ((*DAT_00da9894 != 0 && (*(int *)(*DAT_00da9894 + 0x1a8) != 0)))) {
            FUN_00406460(L"IDS_PREMIUMSHOP_BASKET_MAXIMUM_ITEMCOUNT");
            uVar6 = 6;
            local_8 = 6;
            piVar4 = *(int **)(*DAT_00da9894 + 0x1a8);
            uVar3 = FUN_0081d120(local_2c);
            local_8._0_1_ = 7;
            goto LAB_00a807ba;
          }
          break;
        }
        uVar5 = uVar5 + 1;
      }
    }
  }
  else if (((DAT_0172491c != 0) && (*DAT_00da9894 != 0)) && (*(int *)(*DAT_00da9894 + 0x1a8) != 0))
  {
    FUN_00406460(L"IDS_PREMIUMSHOP_BASKET_MAXIMUM_ITEMCOUNT");
    local_8 = 0;
    piVar4 = *(int **)(*DAT_00da9894 + 0x1a8);
    uVar3 = FUN_0081d120(local_2c);
    local_8._0_1_ = 1;
    (**(code **)(*piVar4 + 0x44))(uVar3,3);
    local_8 = (uint)local_8._1_3_ << 8;
LAB_00a804d6:
    FUN_00406560();
    local_8 = 0xffffffff;
    FUN_00406560();
  }
  FUN_00a7f960();
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00a80420 : PUSH EBP
00a80421 : MOV EBP,ESP
00a80423 : PUSH -0x1
00a80425 : PUSH 0xb350d8
00a8042a : MOV EAX,FS:[0x0]
00a80430 : PUSH EAX
00a80431 : SUB ESP,0x38
00a80434 : PUSH EBX
00a80435 : PUSH ESI
00a80436 : PUSH EDI
00a80437 : MOV EAX,[0x00d66fa0]
00a8043c : XOR EAX,EBP
00a8043e : PUSH EAX
00a8043f : LEA EAX,[EBP + -0xc]
00a80442 : MOV FS:[0x0],EAX
00a80448 : MOV EBX,dword ptr [EBP + 0x8]
00a8044b : MOV EDI,EBX
00a8044d : CALL 0x00a7ffb0
00a80452 : CMP EAX,0x14
00a80455 : JL 0x00a804f2
00a8045b : CMP byte ptr [EBP + 0x10],0x0
00a8045f : JZ 0x00a804f2
00a80465 : CMP dword ptr [0x0172491c],0x0
00a8046c : JZ 0x00a807ed
00a80472 : MOV EAX,[0x00da9894]
00a80477 : MOV EAX,dword ptr [EAX]
00a80479 : TEST EAX,EAX
00a8047b : JZ 0x00a807ed
00a80481 : CMP dword ptr [EAX + 0x1a8],0x0
00a80488 : JZ 0x00a807ed
00a8048e : PUSH 0xc55370
00a80493 : LEA ECX,[EBP + -0x28]
00a80496 : CALL 0x00406460
00a8049b : MOV dword ptr [EBP + -0x4],0x0
00a804a2 : MOV ECX,dword ptr [0x00da9894]
00a804a8 : MOV EAX,dword ptr [ECX]
00a804aa : MOV ECX,dword ptr [0x0172491c]
00a804b0 : MOV ESI,dword ptr [EAX + 0x1a8]
00a804b6 : LEA EDX,[EBP + -0x28]
00a804b9 : PUSH EDX
00a804ba : LEA EDI,[EBP + -0x44]
00a804bd : CALL 0x0081d120
00a804c2 : MOV byte ptr [EBP + -0x4],0x1
00a804c6 : MOV EDX,dword ptr [ESI]
00a804c8 : PUSH 0x3
00a804ca : PUSH EAX
00a804cb : MOV EAX,dword ptr [EDX + 0x44]
00a804ce : MOV ECX,ESI
00a804d0 : CALL EAX
00a804d2 : MOV byte ptr [EBP + -0x4],0x0
00a804d6 : LEA ECX,[EBP + -0x44]
00a804d9 : CALL 0x00406560
00a804de : MOV dword ptr [EBP + -0x4],0xffffffff
00a804e5 : LEA ECX,[EBP + -0x28]
00a804e8 : CALL 0x00406560
00a804ed : JMP 0x00a807ed
00a804f2 : MOV ECX,dword ptr [EBX + 0x6c]
00a804f5 : MOV ECX,dword ptr [ECX + 0x1bc]
00a804fb : TEST ECX,ECX
00a804fd : JNZ 0x00a805e7
00a80503 : MOV EDX,dword ptr [EBX + 0x40]
00a80506 : SUB EDX,dword ptr [EBX + 0x3c]
00a80509 : MOV EDI,dword ptr [EBP + 0xc]
00a8050c : SAR EDX,0x2
00a8050f : CMP EDX,EDI
00a80511 : JA 0x00a8053a
00a80513 : MOV ESI,dword ptr [0x00da98e8]
00a80519 : PUSH 0xc553c8
00a8051e : CALL 0x008018d0
00a80523 : ADD ESP,0x4
00a80526 : MOV ECX,dword ptr [EBP + -0xc]
00a80529 : MOV dword ptr FS:[0x0],ECX
00a80530 : POP ECX
00a80531 : POP EDI
00a80532 : POP ESI
00a80533 : POP EBX
00a80534 : MOV ESP,EBP
00a80536 : POP EBP
00a80537 : RET 0xc
00a8053a : MOV ECX,dword ptr [EBX + 0x3c]
00a8053d : MOV ESI,dword ptr [EBX + 0x40]
00a80540 : XOR EDX,EDX
00a80542 : CMP ECX,ESI
00a80544 : JZ 0x00a807ed
00a8054a : LEA EBX,[EBX]
00a80550 : CMP EDX,EDI
00a80552 : JZ 0x00a80561
00a80554 : ADD ECX,0x4
00a80557 : INC EDX
00a80558 : CMP ECX,ESI
00a8055a : JNZ 0x00a80550
00a8055c : JMP 0x00a807ed
00a80561 : MOV DL,byte ptr [EBP + 0x10]
00a80564 : TEST DL,DL
00a80566 : JZ 0x00a807e5
00a8056c : MOV ESI,dword ptr [ECX]
00a8056e : MOVZX ESI,word ptr [ESI + 0xd2]
00a80575 : ADD EAX,ESI
00a80577 : CMP EAX,0x14
00a8057a : JL 0x00a807e5
00a80580 : CMP dword ptr [0x0172491c],0x0
00a80587 : JZ 0x00a807ed
00a8058d : MOV EAX,[0x00da9894]
00a80592 : MOV EAX,dword ptr [EAX]
00a80594 : TEST EAX,EAX
00a80596 : JZ 0x00a807ed
00a8059c : CMP dword ptr [EAX + 0x1a8],0x0
00a805a3 : JZ 0x00a807ed
00a805a9 : PUSH 0xc55428
00a805ae : LEA ECX,[EBP + -0x28]
00a805b1 : CALL 0x00406460
00a805b6 : MOV EBX,0x2
00a805bb : MOV dword ptr [EBP + -0x4],EBX
00a805be : MOV ECX,dword ptr [0x00da9894]
00a805c4 : MOV EAX,dword ptr [ECX]
00a805c6 : MOV ECX,dword ptr [0x0172491c]
00a805cc : MOV ESI,dword ptr [EAX + 0x1a8]
00a805d2 : LEA EDX,[EBP + -0x28]
00a805d5 : PUSH EDX
00a805d6 : LEA EDI,[EBP + -0x44]
00a805d9 : CALL 0x0081d120
00a805de : MOV byte ptr [EBP + -0x4],0x3
00a805e2 : JMP 0x00a807ba
00a805e7 : CMP ECX,0x1
00a805ea : JNZ 0x00a806dd
00a805f0 : MOV EDX,dword ptr [EBX + 0x50]
00a805f3 : SUB EDX,dword ptr [EBX + 0x4c]
00a805f6 : MOV EDI,dword ptr [EBP + 0xc]
00a805f9 : SAR EDX,0x2
00a805fc : CMP EDX,EDI
00a805fe : JA 0x00a80627
00a80600 : MOV ESI,dword ptr [0x00da98e8]
00a80606 : PUSH 0xc55480
00a8060b : CALL 0x008018d0
00a80610 : ADD ESP,0x4
00a80613 : MOV ECX,dword ptr [EBP + -0xc]
00a80616 : MOV dword ptr FS:[0x0],ECX
00a8061d : POP ECX
00a8061e : POP EDI
00a8061f : POP ESI
00a80620 : POP EBX
00a80621 : MOV ESP,EBP
00a80623 : POP EBP
00a80624 : RET 0xc
00a80627 : MOV ECX,dword ptr [EBX + 0x4c]
00a8062a : MOV ESI,dword ptr [EBX + 0x50]
00a8062d : XOR EDX,EDX
00a8062f : CMP ECX,ESI
00a80631 : JZ 0x00a807ed
00a80637 : CMP EDX,EDI
00a80639 : JZ 0x00a80648
00a8063b : ADD ECX,0x4
00a8063e : INC EDX
00a8063f : CMP ECX,ESI
00a80641 : JNZ 0x00a80637
00a80643 : JMP 0x00a807ed
00a80648 : MOV DL,byte ptr [EBP + 0x10]
00a8064b : TEST DL,DL
00a8064d : JZ 0x00a807e5
00a80653 : MOV ESI,dword ptr [ECX]
00a80655 : MOVZX ESI,word ptr [ESI + 0xd2]
00a8065c : ADD EAX,ESI
00a8065e : CMP EAX,0x14
00a80661 : JL 0x00a807e5
00a80667 : CMP dword ptr [0x0172491c],0x0
00a8066e : JZ 0x00a807ed
00a80674 : MOV EAX,[0x00da9894]
00a80679 : MOV EAX,dword ptr [EAX]
00a8067b : TEST EAX,EAX
00a8067d : JZ 0x00a807ed
00a80683 : CMP dword ptr [EAX + 0x1a8],0x0
00a8068a : JZ 0x00a807ed
00a80690 : PUSH 0xc554f0
00a80695 : LEA ECX,[EBP + -0x28]
00a80698 : CALL 0x00406460
00a8069d : MOV dword ptr [EBP + -0x4],0x4
00a806a4 : MOV ECX,dword ptr [0x00da9894]
00a806aa : MOV EAX,dword ptr [ECX]
00a806ac : MOV ECX,dword ptr [0x0172491c]
00a806b2 : MOV ESI,dword ptr [EAX + 0x1a8]
00a806b8 : LEA EDX,[EBP + -0x28]
00a806bb : PUSH EDX
00a806bc : LEA EDI,[EBP + -0x44]
00a806bf : CALL 0x0081d120
00a806c4 : MOV byte ptr [EBP + -0x4],0x5
00a806c8 : MOV EDX,dword ptr [ESI]
00a806ca : PUSH 0x3
00a806cc : PUSH EAX
00a806cd : MOV EAX,dword ptr [EDX + 0x44]
00a806d0 : MOV ECX,ESI
00a806d2 : CALL EAX
00a806d4 : MOV byte ptr [EBP + -0x4],0x4
00a806d8 : JMP 0x00a804d6
00a806dd : CMP ECX,0x2
00a806e0 : JNZ 0x00a807ed
00a806e6 : MOV EDX,dword ptr [EBX + 0x60]
00a806e9 : SUB EDX,dword ptr [EBX + 0x5c]
00a806ec : MOV EDI,dword ptr [EBP + 0xc]
00a806ef : SAR EDX,0x2
00a806f2 : CMP EDX,EDI
00a806f4 : JA 0x00a8071d
00a806f6 : MOV ESI,dword ptr [0x00da98e8]
00a806fc : PUSH 0xc55548
00a80701 : CALL 0x008018d0
00a80706 : ADD ESP,0x4
00a80709 : MOV ECX,dword ptr [EBP + -0xc]
00a8070c : MOV dword ptr FS:[0x0],ECX
00a80713 : POP ECX
00a80714 : POP EDI
00a80715 : POP ESI
00a80716 : POP EBX
00a80717 : MOV ESP,EBP
00a80719 : POP EBP
00a8071a : RET 0xc
00a8071d : MOV ECX,dword ptr [EBX + 0x5c]
00a80720 : MOV ESI,dword ptr [EBX + 0x60]
00a80723 : XOR EDX,EDX
00a80725 : CMP ECX,ESI
00a80727 : JZ 0x00a807ed
00a8072d : LEA ECX,[ECX]
00a80730 : CMP EDX,EDI
00a80732 : JZ 0x00a80741
00a80734 : ADD ECX,0x4
00a80737 : INC EDX
00a80738 : CMP ECX,ESI
00a8073a : JNZ 0x00a80730
00a8073c : JMP 0x00a807ed
00a80741 : MOV DL,byte ptr [EBP + 0x10]
00a80744 : TEST DL,DL
00a80746 : JZ 0x00a807e5
00a8074c : MOV ESI,dword ptr [ECX]
00a8074e : MOVZX ESI,word ptr [ESI + 0xd2]
00a80755 : ADD EAX,ESI
00a80757 : CMP EAX,0x14
00a8075a : JL 0x00a807e5
00a80760 : CMP dword ptr [0x0172491c],0x0
00a80767 : JZ 0x00a807ed
00a8076d : MOV EAX,[0x00da9894]
00a80772 : MOV EAX,dword ptr [EAX]
00a80774 : TEST EAX,EAX
00a80776 : JZ 0x00a807ed
00a80778 : CMP dword ptr [EAX + 0x1a8],0x0
00a8077f : JZ 0x00a807ed
00a80781 : PUSH 0xc555b8
00a80786 : LEA ECX,[EBP + -0x28]
00a80789 : CALL 0x00406460
00a8078e : MOV EBX,0x6
00a80793 : MOV dword ptr [EBP + -0x4],EBX
00a80796 : MOV ECX,dword ptr [0x00da9894]
00a8079c : MOV EAX,dword ptr [ECX]
00a8079e : MOV ECX,dword ptr [0x0172491c]
00a807a4 : MOV ESI,dword ptr [EAX + 0x1a8]
00a807aa : LEA EDX,[EBP + -0x28]
00a807ad : PUSH EDX
00a807ae : LEA EDI,[EBP + -0x44]
00a807b1 : CALL 0x0081d120
00a807b6 : MOV byte ptr [EBP + -0x4],0x7
00a807ba : MOV EDX,dword ptr [ESI]
00a807bc : PUSH 0x3
00a807be : PUSH EAX
00a807bf : MOV EAX,dword ptr [EDX + 0x44]
00a807c2 : MOV ECX,ESI
00a807c4 : CALL EAX
00a807c6 : MOV byte ptr [EBP + -0x4],BL
00a807c9 : LEA ECX,[EBP + -0x44]
00a807cc : CALL 0x00406560
00a807d1 : MOV dword ptr [EBP + -0x4],0xffffffff
00a807d8 : LEA ECX,[EBP + -0x28]
00a807db : CALL 0x00406560
00a807e0 : MOV EBX,dword ptr [EBP + 0x8]
00a807e3 : JMP 0x00a807ed
00a807e5 : MOV ECX,dword ptr [ECX]
00a807e7 : MOV byte ptr [ECX + 0xf0],DL
00a807ed : MOV ECX,EBX
00a807ef : CALL 0x00a7f960
00a807f4 : MOV ECX,dword ptr [EBP + -0xc]
00a807f7 : MOV dword ptr FS:[0x0],ECX
00a807fe : POP ECX
00a807ff : POP EDI
00a80800 : POP ESI
00a80801 : POP EBX
00a80802 : MOV ESP,EBP
00a80804 : POP EBP
00a80805 : RET 0xc

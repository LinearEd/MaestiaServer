PROGRAM  : Maestia.exe
FUNCTION : FUN_006827a0
ENTRY    : 006827a0
BODY     : [[006827a0, 00682911]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006827a0(void)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int *in_ECX;
  int *unaff_EBP;
  uint uVar3;
  int iVar4;
  int *local_4;
  
  uVar3 = 0;
  local_4 = in_ECX;
  if (in_ECX[0x2a] != 0) {
    local_4 = &DAT_00d68894;
    do {
      puVar2 = (undefined4 *)*local_4;
      while (puVar2 != (undefined4 *)0x0) {
        FUN_00515cf0(*puVar2);
        puVar1 = (undefined4 *)puVar2[1];
        FUN_00515cf0(puVar2);
        puVar2 = puVar1;
      }
      local_4 = local_4 + 4;
      uVar3 = uVar3 + 1;
    } while (uVar3 < (uint)in_ECX[0x2a]);
  }
  uVar3 = 0;
  if (in_ECX[0x2c] != 0) {
    iVar4 = 0;
    do {
      FUN_00515cf0(*(undefined4 *)(in_ECX[0x2b] + 4 + iVar4));
      FUN_00515cf0(*(undefined4 *)(in_ECX[0x2b] + iVar4));
      uVar3 = uVar3 + 1;
      iVar4 = iVar4 + 0x10;
    } while (uVar3 < (uint)in_ECX[0x2c]);
  }
  uVar3 = 0;
  if (in_ECX[0x10] != 0) {
    iVar4 = 0;
    do {
      if (*(int *)(iVar4 + in_ECX[0x13]) != 0) {
        FUN_00515cf0(*(int *)(iVar4 + in_ECX[0x13]));
      }
      uVar3 = uVar3 + 1;
      iVar4 = iVar4 + 0x10;
    } while (uVar3 < (uint)in_ECX[0x10]);
  }
  if (in_ECX[0x34] != -1) {
    iVar4 = (*(code *)**(undefined4 **)in_ECX[0x37])
                      ((undefined4 *)in_ECX[0x37],&DAT_00befb70,&local_4);
    if (-1 < iVar4) {
      iVar4 = (**(code **)(*local_4 + 0x10))(local_4,in_ECX[0x34]);
      if (iVar4 == -0x7ffbfe00) {
        (**(code **)(in_ECX[0x30] + 8))(in_ECX + 0x30);
      }
      (**(code **)(*unaff_EBP + 8))(unaff_EBP);
    }
    in_ECX[0x34] = -1;
  }
  if (in_ECX[0x32] != -1) {
    iVar4 = (*(code *)**(undefined4 **)in_ECX[0x37])
                      ((undefined4 *)in_ECX[0x37],&DAT_00befb70,&local_4);
    if (-1 < iVar4) {
      (**(code **)(*local_4 + 0x10))(local_4,in_ECX[0x32]);
      (**(code **)(*unaff_EBP + 8))(unaff_EBP);
    }
    in_ECX[0x32] = -1;
  }
  (**(code **)(in_ECX[0x30] + 8))(in_ECX + 0x30);
  return;
}



============================================================
DISASSEMBLY
============================================================
006827a0 : PUSH ECX
006827a1 : PUSH EBX
006827a2 : PUSH EBP
006827a3 : PUSH ESI
006827a4 : MOV ESI,ECX
006827a6 : XOR EBP,EBP
006827a8 : PUSH EDI
006827a9 : CMP dword ptr [ESI + 0xa8],EBP
006827af : JBE 0x006827f5
006827b1 : MOV dword ptr [ESP + 0x10],0xd68894
006827b9 : LEA ESP,[ESP]
006827c0 : MOV EAX,dword ptr [ESP + 0x10]
006827c4 : MOV EDI,dword ptr [EAX]
006827c6 : TEST EDI,EDI
006827c8 : JZ 0x006827e7
006827ca : LEA EBX,[EBX]
006827d0 : MOV ECX,dword ptr [EDI]
006827d2 : PUSH ECX
006827d3 : CALL 0x00515cf0
006827d8 : MOV EBX,dword ptr [EDI + 0x4]
006827db : PUSH EDI
006827dc : CALL 0x00515cf0
006827e1 : MOV EDI,EBX
006827e3 : TEST EBX,EBX
006827e5 : JNZ 0x006827d0
006827e7 : ADD dword ptr [ESP + 0x10],0x10
006827ec : INC EBP
006827ed : CMP EBP,dword ptr [ESI + 0xa8]
006827f3 : JC 0x006827c0
006827f5 : XOR EBX,EBX
006827f7 : CMP dword ptr [ESI + 0xb0],EBX
006827fd : JBE 0x0068282c
006827ff : XOR EDI,EDI
00682801 : MOV EDX,dword ptr [ESI + 0xac]
00682807 : MOV EAX,dword ptr [EDX + EDI*0x1 + 0x4]
0068280b : PUSH EAX
0068280c : CALL 0x00515cf0
00682811 : MOV ECX,dword ptr [ESI + 0xac]
00682817 : MOV EDX,dword ptr [ECX + EDI*0x1]
0068281a : PUSH EDX
0068281b : CALL 0x00515cf0
00682820 : INC EBX
00682821 : ADD EDI,0x10
00682824 : CMP EBX,dword ptr [ESI + 0xb0]
0068282a : JC 0x00682801
0068282c : XOR EBX,EBX
0068282e : CMP dword ptr [ESI + 0x40],EBX
00682831 : JBE 0x0068284e
00682833 : XOR EDI,EDI
00682835 : MOV EAX,dword ptr [ESI + 0x4c]
00682838 : MOV EAX,dword ptr [EDI + EAX*0x1]
0068283b : TEST EAX,EAX
0068283d : JZ 0x00682845
0068283f : PUSH EAX
00682840 : CALL 0x00515cf0
00682845 : INC EBX
00682846 : ADD EDI,0x10
00682849 : CMP EBX,dword ptr [ESI + 0x40]
0068284c : JC 0x00682835
0068284e : OR EDI,0xffffffff
00682851 : CMP dword ptr [ESI + 0xd0],EDI
00682857 : JZ 0x006828b2
00682859 : MOV EAX,dword ptr [ESI + 0xdc]
0068285f : MOV ECX,dword ptr [EAX]
00682861 : LEA EDX,[ESP + 0x10]
00682865 : PUSH EDX
00682866 : PUSH 0xbefb70
0068286b : PUSH EAX
0068286c : MOV EAX,dword ptr [ECX]
0068286e : CALL EAX
00682870 : TEST EAX,EAX
00682872 : JL 0x006828ac
00682874 : MOV EAX,dword ptr [ESP + 0x10]
00682878 : MOV EDX,dword ptr [ESI + 0xd0]
0068287e : MOV ECX,dword ptr [EAX]
00682880 : PUSH EDX
00682881 : PUSH EAX
00682882 : MOV EAX,dword ptr [ECX + 0x10]
00682885 : CALL EAX
00682887 : CMP EAX,0x80040200
0068288c : JNZ 0x006828a0
0068288e : MOV ECX,dword ptr [ESI + 0xc0]
00682894 : MOV EDX,dword ptr [ECX + 0x8]
00682897 : LEA EAX,[ESI + 0xc0]
0068289d : PUSH EAX
0068289e : CALL EDX
006828a0 : MOV EAX,dword ptr [ESP + 0x10]
006828a4 : MOV ECX,dword ptr [EAX]
006828a6 : MOV EDX,dword ptr [ECX + 0x8]
006828a9 : PUSH EAX
006828aa : CALL EDX
006828ac : MOV dword ptr [ESI + 0xd0],EDI
006828b2 : CMP dword ptr [ESI + 0xc8],EDI
006828b8 : JZ 0x006828fa
006828ba : MOV EAX,dword ptr [ESI + 0xdc]
006828c0 : MOV ECX,dword ptr [EAX]
006828c2 : LEA EDX,[ESP + 0x10]
006828c6 : PUSH EDX
006828c7 : PUSH 0xbefb70
006828cc : PUSH EAX
006828cd : MOV EAX,dword ptr [ECX]
006828cf : CALL EAX
006828d1 : TEST EAX,EAX
006828d3 : JL 0x006828f4
006828d5 : MOV EAX,dword ptr [ESP + 0x10]
006828d9 : MOV EDX,dword ptr [ESI + 0xc8]
006828df : MOV ECX,dword ptr [EAX]
006828e1 : PUSH EDX
006828e2 : PUSH EAX
006828e3 : MOV EAX,dword ptr [ECX + 0x10]
006828e6 : CALL EAX
006828e8 : MOV EAX,dword ptr [ESP + 0x10]
006828ec : MOV ECX,dword ptr [EAX]
006828ee : MOV EDX,dword ptr [ECX + 0x8]
006828f1 : PUSH EAX
006828f2 : CALL EDX
006828f4 : MOV dword ptr [ESI + 0xc8],EDI
006828fa : MOV ECX,dword ptr [ESI + 0xc0]
00682900 : MOV EDX,dword ptr [ECX + 0x8]
00682903 : LEA EAX,[ESI + 0xc0]
00682909 : PUSH EAX
0068290a : CALL EDX
0068290c : POP EDI
0068290d : POP ESI
0068290e : POP EBP
0068290f : POP EBX
00682910 : POP ECX
00682911 : RET

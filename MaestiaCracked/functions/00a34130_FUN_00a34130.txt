PROGRAM  : Maestia.exe
FUNCTION : FUN_00a34130
ENTRY    : 00a34130
BODY     : [[00a34130, 00a343d7] [00a343e0, 00a347e0]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a34130(int param_1)

{
  char cVar1;
  char *pcVar2;
  int *piVar3;
  int iVar4;
  int iVar5;
  undefined4 uVar6;
  uint uVar7;
  int iVar8;
  undefined8 uVar9;
  undefined1 local_64 [4];
  undefined2 local_60;
  undefined4 local_50;
  uint local_4c;
  undefined1 local_48 [4];
  undefined2 local_44;
  _SYSTEMTIME local_3c;
  int local_2c;
  int local_28;
  int local_24;
  int local_20;
  int *local_1c;
  int *local_18 [2];
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b5eaaf;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if (*(char *)(param_1 + 0x294) == '\0') {
    if (DAT_017247f0 != 0) {
      FUN_009f2650(DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
    }
    if (*(int *)(*(int *)(*DAT_00da9894 + 0x140) + 0x38) != 0) {
      FUN_009c4ea0();
    }
    uVar6 = 0;
    if (*(int *)(*DAT_00da9894 + 300) != 0) {
      uVar6 = *(undefined4 *)(*(int *)(*DAT_00da9894 + 300) + 8);
    }
    FUN_00906d10(uVar6);
    if (*(int *)(*DAT_00da9894 + 300) == 0) {
      iVar8 = 0;
    }
    else {
      iVar8 = *(int *)(*(int *)(*DAT_00da9894 + 300) + 0x14);
    }
    if (*(char *)(iVar8 + 8) != '\0') {
      iVar5 = *(int *)(*(int *)(param_1 + 0xac) + 0x1ec4);
      if (iVar5 != 0) {
        *(int *)(iVar8 + 0x40) = iVar5;
      }
      FUN_0099dd40(iVar8);
    }
    FUN_00905060(*(undefined4 *)(*(int *)(param_1 + 0xac) + 8));
    FUN_008c13a0();
    piVar3 = *(int **)(*DAT_00da9894 + 0x168);
    local_1c = piVar3;
    if ((char)piVar3[0x17] == '\0') {
      (**(code **)(*piVar3 + 0x80))();
      iVar8 = 0;
      if (DAT_01724848 != 0) {
        local_24 = -(uint)(*(int *)(DAT_01724848 + 0x28) != 0);
        while (local_24 != 0) {
          piVar3 = local_1c;
          if (DAT_01724848 != 0) {
            local_20 = 0;
            FUN_00404160(&local_24,local_18,&local_20);
            iVar5 = local_20;
            piVar3 = local_1c;
            if (local_20 != 0) {
              pcVar2 = (char *)(local_20 + 0x40);
              do {
                cVar1 = *pcVar2;
                pcVar2 = pcVar2 + 1;
              } while (cVar1 != '\0');
              if (pcVar2 != (char *)(local_20 + 0x41)) {
                if ((*(byte *)(local_20 + 0x80) & 2) == 0) {
                  iVar4 = FUN_009f2740(CONCAT22(*(undefined2 *)(local_20 + 4),
                                                *(undefined2 *)(local_20 + 6)));
                  if (iVar4 == 0) {
LAB_00a344e4:
                    iVar4 = FUN_00b04230(iVar8);
                    if (iVar4 == 0) {
                      FUN_00406460(L"Alloc failed");
                      local_8 = 1;
                      piVar3 = (int *)*DAT_00da98e8;
                      if (piVar3 != (int *)0x0) {
                        uVar9 = 0x10300c89b0c;
                        goto LAB_00a3457e;
                      }
                      goto LAB_00a34585;
                    }
                    FUN_009f3690(DAT_017247f0);
                  }
                  else {
                    local_20 = iVar8;
                    FUN_004437f0(&local_20);
                    if (local_2c == *(int *)(iVar4 + 0xc)) {
                      iVar4 = 0;
                    }
                    else {
                      iVar4 = *(int *)(local_2c + 0x10);
                    }
                    if (iVar4 == 0) goto LAB_00a344e4;
                  }
                  FUN_009a52d0(iVar8);
                  if (*(short *)(iVar5 + 0xa0) == 1) {
                    *(short *)((int)local_1c + 0x5e) = (short)*(undefined4 *)(iVar4 + 0x10);
                  }
                  iVar8 = iVar8 + 1;
                  piVar3 = local_1c;
                }
                else {
                  iVar5 = FUN_009f2740(CONCAT22(*(undefined2 *)(local_20 + 4),
                                                *(undefined2 *)(local_20 + 6)));
                  if (((iVar5 == 0) ||
                      (local_20 = iVar8, FUN_004437f0(&local_20), local_28 == *(int *)(iVar5 + 0xc))
                      ) || (piVar3 = local_1c, *(int *)(local_28 + 0x10) == 0)) {
                    iVar5 = FUN_00b04230(iVar8);
                    if (iVar5 == 0) {
                      FUN_00406460(L"Alloc failed");
                      local_8 = 0;
                      piVar3 = (int *)*DAT_00da98e8;
                      if (piVar3 != (int *)0x0) {
                        uVar9 = 0xea00c89ab4;
LAB_00a3457e:
                        (**(code **)(*piVar3 + 0x14))(uVar9,local_48);
                      }
LAB_00a34585:
                      local_8 = 0xffffffff;
                      if (7 < (uint)local_3c._12_4_) {
                    /* WARNING: Subroutine does not return */
                        FUN_006f04e0();
                      }
                      local_3c.wSecond = 7;
                      local_3c.wMilliseconds = 0;
                      local_3c.wHour = 0;
                      local_3c.wMinute = 0;
                      local_44 = 0;
                      goto LAB_00a3468d;
                    }
                    FUN_009f3690(DAT_017247f0);
                    piVar3 = local_1c;
                  }
                }
              }
            }
          }
        }
      }
      local_18[0] = (int *)piVar3[0x1a];
      if (local_18[0] != (int *)piVar3[0x1b]) {
        do {
          iVar5 = DAT_00d7c54c;
          local_2c = *(int *)*local_18[0];
          FUN_004437f0(&local_2c);
          if ((local_28 != *(int *)(iVar5 + 0x44)) &&
             (iVar5 = *(int *)(local_28 + 0x10), iVar5 != 0)) {
            pcVar2 = (char *)(iVar5 + 0x40);
            do {
              cVar1 = *pcVar2;
              pcVar2 = pcVar2 + 1;
            } while (cVar1 != '\0');
            if (pcVar2 != (char *)(iVar5 + 0x41)) {
              piVar3 = (int *)FUN_009f2840(iVar8);
              if (piVar3 == (int *)0x0) {
                piVar3 = (int *)FUN_00b04230(iVar8);
                if (piVar3 == (int *)0x0) {
                  FUN_00406460(L"Alloc failed");
                  local_8 = 2;
                  if ((int *)*DAT_00da98e8 != (int *)0x0) {
                    (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                              (L"AvaGuiEmoticon::SetEmoticons",0x136,local_64);
                  }
                  local_8 = 0xffffffff;
                  if (7 < local_4c) {
                    /* WARNING: Subroutine does not return */
                    FUN_006f04e0();
                  }
                  local_4c = 7;
                  local_50 = 0;
                  local_60 = 0;
                }
                else {
                  VariantTimeToSystemTime(*(DOUBLE *)(*local_18[0] + 8),&local_3c);
                  iVar4 = FUN_00411e00();
                  if (iVar4 == 0) {
                    (**(code **)(*piVar3 + 0x9c))(1);
                    (**(code **)(*piVar3 + 0xa4))();
                  }
                  FUN_009f3690(DAT_017247f0);
                }
                if (piVar3 == (int *)0x0) goto LAB_00a34671;
              }
              FUN_009a52d0(iVar8);
              if (*(short *)(iVar5 + 0xa0) == 1) {
                *(short *)((int)local_1c + 0x5e) = (short)piVar3[4];
              }
              iVar8 = iVar8 + 1;
            }
          }
LAB_00a34671:
          local_18[0] = local_18[0] + 1;
        } while (local_18[0] != (int *)local_1c[0x1b]);
      }
      *(undefined1 *)(local_1c + 0x17) = 1;
    }
LAB_00a3468d:
    uVar6 = 0;
    if (*(int *)(*DAT_00da9894 + 300) != 0) {
      uVar6 = *(undefined4 *)(*(int *)(*DAT_00da9894 + 300) + 0xc);
    }
    FUN_00931e60(uVar6);
    FUN_00a96790();
    (**(code **)(**(int **)(param_1 + 0xac) + 0x46c))(1);
    FUN_00a96790();
    if ((*DAT_00da9894 != 0) && (piVar3 = *(int **)(*DAT_00da9894 + 0x114), piVar3 != (int *)0x0)) {
      (**(code **)(*piVar3 + 4))
                (piVar3,"SetMyMileage",&DAT_00c83bd4,
                 *(undefined4 *)(*(int *)(param_1 + 0xac) + 0x1f38));
    }
    uVar7 = *(uint *)(*(int *)(param_1 + 0xac) + 0x1fbc);
    if ((uVar7 & 4) != 0) {
      FUN_008bf1c0();
    }
    if ((uVar7 & 8) != 0) {
      FUN_008bf1c0();
    }
    if ((uVar7 & 0x10) != 0) {
      FUN_008bf1c0();
    }
    FUN_009a0fa0();
    iVar8 = *(int *)(*(int *)(param_1 + 0xac) + 0xa0);
    iVar5 = *(int *)(*DAT_00da9894 + 700);
    if (((*(int *)(DAT_0172491c + 0x144) != 0) && (0 < iVar8)) &&
       (uVar7 = FUN_00812460(iVar8), *(uint *)(iVar5 + 0x3c) < uVar7)) {
      *(uint *)(iVar5 + 0x3c) = uVar7;
    }
    *(undefined1 *)(param_1 + 0x294) = 1;
  }
  else if (*(char *)(param_1 + 0x4c0) != '\0') {
    FUN_009a5cc0();
    if (*(int *)(*DAT_00da9894 + 300) == 0) {
      FUN_00931e60(0);
      ExceptionList = local_10;
      return;
    }
    FUN_00931e60(*(undefined4 *)(*(int *)(*DAT_00da9894 + 300) + 0xc));
    ExceptionList = local_10;
    return;
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00a34130 : PUSH EBP
00a34131 : MOV EBP,ESP
00a34133 : PUSH -0x1
00a34135 : PUSH 0xb5eaaf
00a3413a : MOV EAX,FS:[0x0]
00a34140 : PUSH EAX
00a34141 : SUB ESP,0x58
00a34144 : PUSH EBX
00a34145 : PUSH ESI
00a34146 : PUSH EDI
00a34147 : MOV EAX,[0x00d66fa0]
00a3414c : XOR EAX,EBP
00a3414e : PUSH EAX
00a3414f : LEA EAX,[EBP + -0xc]
00a34152 : MOV FS:[0x0],EAX
00a34158 : MOV EDI,dword ptr [EBP + 0x8]
00a3415b : CMP byte ptr [EDI + 0x294],0x0
00a34162 : JZ 0x00a341ce
00a34164 : CMP byte ptr [EDI + 0x4c0],0x0
00a3416b : JZ 0x00a347cd
00a34171 : MOV EAX,[0x00da9894]
00a34176 : MOV ECX,dword ptr [EAX]
00a34178 : MOV EDX,dword ptr [ECX + 0x168]
00a3417e : PUSH 0x1
00a34180 : PUSH EDX
00a34181 : CALL 0x009a5cc0
00a34186 : MOV EAX,[0x00da9894]
00a3418b : MOV EAX,dword ptr [EAX]
00a3418d : MOV EAX,dword ptr [EAX + 0x12c]
00a34193 : TEST EAX,EAX
00a34195 : JNZ 0x00a341b1
00a34197 : PUSH EAX
00a34198 : CALL 0x00931e60
00a3419d : MOV ECX,dword ptr [EBP + -0xc]
00a341a0 : MOV dword ptr FS:[0x0],ECX
00a341a7 : POP ECX
00a341a8 : POP EDI
00a341a9 : POP ESI
00a341aa : POP EBX
00a341ab : MOV ESP,EBP
00a341ad : POP EBP
00a341ae : RET 0x4
00a341b1 : MOV EAX,dword ptr [EAX + 0xc]
00a341b4 : PUSH EAX
00a341b5 : CALL 0x00931e60
00a341ba : MOV ECX,dword ptr [EBP + -0xc]
00a341bd : MOV dword ptr FS:[0x0],ECX
00a341c4 : POP ECX
00a341c5 : POP EDI
00a341c6 : POP ESI
00a341c7 : POP EBX
00a341c8 : MOV ESP,EBP
00a341ca : POP EBP
00a341cb : RET 0x4
00a341ce : MOV ECX,dword ptr [0x017247f0]
00a341d4 : TEST ECX,ECX
00a341d6 : JZ 0x00a341dd
00a341d8 : CALL 0x009f2650
00a341dd : MOV ECX,dword ptr [0x00da9894]
00a341e3 : MOV EAX,dword ptr [ECX]
00a341e5 : MOV ECX,dword ptr [EAX + 0x140]
00a341eb : CMP dword ptr [ECX + 0x38],0x0
00a341ef : JZ 0x00a34201
00a341f1 : MOV EAX,ECX
00a341f3 : MOV ECX,dword ptr [EAX + 0x38]
00a341f6 : MOV EAX,dword ptr [EDI + 0xac]
00a341fc : CALL 0x009c4ea0
00a34201 : MOV EDX,dword ptr [0x00da9894]
00a34207 : MOV EAX,dword ptr [EDX]
00a34209 : MOV EAX,dword ptr [EAX + 0x12c]
00a3420f : TEST EAX,EAX
00a34211 : JZ 0x00a34216
00a34213 : MOV EAX,dword ptr [EAX + 0x8]
00a34216 : MOV ECX,dword ptr [EDI + 0xac]
00a3421c : PUSH EAX
00a3421d : CALL 0x00906d10
00a34222 : MOV EAX,[0x00da9894]
00a34227 : MOV EAX,dword ptr [EAX]
00a34229 : MOV EAX,dword ptr [EAX + 0x12c]
00a3422f : TEST EAX,EAX
00a34231 : JNZ 0x00a34237
00a34233 : XOR ESI,ESI
00a34235 : JMP 0x00a3423a
00a34237 : MOV ESI,dword ptr [EAX + 0x14]
00a3423a : CMP byte ptr [ESI + 0x8],0x0
00a3423e : MOV EAX,dword ptr [EDI + 0xac]
00a34244 : JZ 0x00a34267
00a34246 : MOV ECX,dword ptr [EAX + 0x1ec4]
00a3424c : TEST ECX,ECX
00a3424e : JZ 0x00a34253
00a34250 : MOV dword ptr [ESI + 0x40],ECX
00a34253 : MOV ECX,dword ptr [EAX + 0x1ecc]
00a34259 : MOV EAX,dword ptr [EAX + 0x1ec8]
00a3425f : PUSH ESI
00a34260 : MOV EDX,EAX
00a34262 : CALL 0x0099dd40
00a34267 : MOV ECX,dword ptr [EDI + 0xac]
00a3426d : MOV EAX,dword ptr [ECX + 0x8]
00a34270 : PUSH EAX
00a34271 : CALL 0x00905060
00a34276 : MOV EDX,dword ptr [0x00da9894]
00a3427c : MOV EAX,dword ptr [EDI + 0xac]
00a34282 : MOV EDX,dword ptr [EDX]
00a34284 : MOV EDX,dword ptr [EDX + 0x1ec]
00a3428a : MOV ECX,dword ptr [EAX + 0x1ee0]
00a34290 : MOV EAX,dword ptr [EAX + 0x1edc]
00a34296 : MOV ESI,EDX
00a34298 : CALL 0x008c13a0
00a3429d : MOV EAX,[0x00da9894]
00a342a2 : MOV EAX,dword ptr [EAX]
00a342a4 : MOV EAX,dword ptr [EAX + 0x168]
00a342aa : CMP byte ptr [EAX + 0x5c],0x0
00a342ae : MOV dword ptr [EBP + -0x18],EAX
00a342b1 : JNZ 0x00a3468d
00a342b7 : MOV ESI,EAX
00a342b9 : MOV EDX,dword ptr [ESI]
00a342bb : MOV EAX,dword ptr [EDX + 0x80]
00a342c1 : MOV ECX,ESI
00a342c3 : CALL EAX
00a342c5 : MOV EAX,[0x01724848]
00a342ca : XOR EBX,EBX
00a342cc : TEST EAX,EAX
00a342ce : JZ 0x00a342e0
00a342d0 : MOV ECX,dword ptr [EAX + 0x28]
00a342d3 : NEG ECX
00a342d5 : SBB ECX,ECX
00a342d7 : MOV dword ptr [EBP + -0x20],ECX
00a342da : JNZ 0x00a343e5
00a342e0 : MOV EAX,dword ptr [ESI + 0x68]
00a342e3 : MOV dword ptr [EBP + -0x14],EAX
00a342e6 : CMP EAX,dword ptr [ESI + 0x6c]
00a342e9 : JZ 0x00a34686
00a342ef : NOP
00a342f0 : MOV EDX,dword ptr [EBP + -0x14]
00a342f3 : MOV EAX,dword ptr [EDX]
00a342f5 : MOV ECX,dword ptr [EAX]
00a342f7 : MOV ESI,dword ptr [0x00d7c54c]
00a342fd : LEA EDX,[EBP + -0x28]
00a34300 : MOV dword ptr [EBP + -0x28],ECX
00a34303 : PUSH EDX
00a34304 : LEA ECX,[ESI + 0x40]
00a34307 : LEA EAX,[EBP + -0x24]
00a3430a : CALL 0x004437f0
00a3430f : MOV EAX,dword ptr [ESI + 0x44]
00a34312 : MOV ECX,dword ptr [EBP + -0x24]
00a34315 : CMP ECX,EAX
00a34317 : JZ 0x00a34671
00a3431d : MOV ESI,dword ptr [ECX + 0x10]
00a34320 : TEST ESI,ESI
00a34322 : JZ 0x00a34671
00a34328 : LEA EAX,[ESI + 0x40]
00a3432b : LEA EDX,[EAX + 0x1]
00a3432e : MOV EDI,EDI
00a34330 : MOV CL,byte ptr [EAX]
00a34332 : INC EAX
00a34333 : TEST CL,CL
00a34335 : JNZ 0x00a34330
00a34337 : SUB EAX,EDX
00a34339 : JZ 0x00a34671
00a3433f : MOVZX EAX,word ptr [ESI + 0x4]
00a34343 : MOVZX ECX,word ptr [ESI + 0x6]
00a34347 : SHL EAX,0x10
00a3434a : OR EAX,ECX
00a3434c : MOV ECX,dword ptr [0x017247f0]
00a34352 : PUSH EBX
00a34353 : CALL 0x009f2840
00a34358 : MOV EDI,EAX
00a3435a : TEST EDI,EDI
00a3435c : JNZ 0x00a34645
00a34362 : MOVZX ECX,word ptr [ESI + 0x4]
00a34366 : MOVZX EDX,word ptr [ESI + 0x6]
00a3436a : SHL ECX,0x10
00a3436d : OR ECX,EDX
00a3436f : PUSH EBX
00a34370 : CALL 0x00b04230
00a34375 : MOV EDI,EAX
00a34377 : ADD ESP,0x4
00a3437a : TEST EDI,EDI
00a3437c : JZ 0x00a345e3
00a34382 : MOV ECX,dword ptr [EBP + -0x14]
00a34385 : MOV EDX,dword ptr [ECX]
00a34387 : FLD double ptr [EDX + 0x8]
00a3438a : LEA EAX,[EBP + -0x38]
00a3438d : PUSH EAX
00a3438e : SUB ESP,0x8
00a34391 : FSTP double ptr [ESP]
00a34394 : CALL dword ptr [0x00b853d4]
00a3439a : MOV EAX,ESI
00a3439c : CALL 0x00411e00
00a343a1 : TEST EAX,EAX
00a343a3 : JNZ 0x00a343c3
00a343a5 : MOV EAX,dword ptr [EDI]
00a343a7 : MOV EDX,dword ptr [EAX + 0x9c]
00a343ad : PUSH 0x1
00a343af : MOV ECX,EDI
00a343b1 : CALL EDX
00a343b3 : MOV EAX,dword ptr [EDI]
00a343b5 : MOV EDX,dword ptr [EAX + 0xa4]
00a343bb : LEA ECX,[EBP + -0x38]
00a343be : PUSH ECX
00a343bf : MOV ECX,EDI
00a343c1 : CALL EDX
00a343c3 : MOV EAX,[0x017247f0]
00a343c8 : MOV ECX,dword ptr [EDI + 0x10]
00a343cb : PUSH EAX
00a343cc : MOV EAX,EDI
00a343ce : CALL 0x009f3690
00a343d3 : JMP 0x00a34641
00a343e0 : MOV EAX,[0x01724848]
00a343e5 : TEST EAX,EAX
00a343e7 : JZ 0x00a3453e
00a343ed : LEA ECX,[EBP + -0x1c]
00a343f0 : PUSH ECX
00a343f1 : LEA EDX,[EBP + -0x14]
00a343f4 : PUSH EDX
00a343f5 : LEA ECX,[EBP + -0x20]
00a343f8 : PUSH ECX
00a343f9 : MOV dword ptr [EBP + -0x1c],0x0
00a34400 : CALL 0x00404160
00a34405 : MOV ESI,dword ptr [EBP + -0x1c]
00a34408 : TEST ESI,ESI
00a3440a : JZ 0x00a3453e
00a34410 : LEA EAX,[ESI + 0x40]
00a34413 : LEA EDX,[EAX + 0x1]
00a34416 : MOV CL,byte ptr [EAX]
00a34418 : INC EAX
00a34419 : TEST CL,CL
00a3441b : JNZ 0x00a34416
00a3441d : SUB EAX,EDX
00a3441f : JZ 0x00a3453e
00a34425 : MOVZX EAX,word ptr [ESI + 0x4]
00a34429 : SHL EAX,0x10
00a3442c : TEST byte ptr [ESI + 0x80],0x2
00a34433 : JZ 0x00a344a5
00a34435 : MOVZX EDX,word ptr [ESI + 0x6]
00a34439 : MOV ECX,dword ptr [0x017247f0]
00a3443f : OR EAX,EDX
00a34441 : PUSH EAX
00a34442 : CALL 0x009f2740
00a34447 : MOV EDI,EAX
00a34449 : TEST EDI,EDI
00a3444b : JZ 0x00a34473
00a3444d : LEA EAX,[EBP + -0x1c]
00a34450 : PUSH EAX
00a34451 : LEA ECX,[EDI + 0x8]
00a34454 : LEA EAX,[EBP + -0x24]
00a34457 : MOV dword ptr [EBP + -0x1c],EBX
00a3445a : CALL 0x004437f0
00a3445f : MOV EDI,dword ptr [EDI + 0xc]
00a34462 : MOV EAX,dword ptr [EBP + -0x24]
00a34465 : CMP EAX,EDI
00a34467 : JZ 0x00a34473
00a34469 : CMP dword ptr [EAX + 0x10],0x0
00a3446d : JNZ 0x00a3453e
00a34473 : MOVZX ECX,word ptr [ESI + 0x4]
00a34477 : MOVZX EDX,word ptr [ESI + 0x6]
00a3447b : SHL ECX,0x10
00a3447e : OR ECX,EDX
00a34480 : PUSH EBX
00a34481 : CALL 0x00b04230
00a34486 : ADD ESP,0x4
00a34489 : TEST EAX,EAX
00a3448b : JZ 0x00a34550
00a34491 : MOV EDX,dword ptr [0x017247f0]
00a34497 : MOV ECX,dword ptr [EAX + 0x10]
00a3449a : PUSH EDX
00a3449b : CALL 0x009f3690
00a344a0 : JMP 0x00a3453e
00a344a5 : MOVZX ECX,word ptr [ESI + 0x6]
00a344a9 : OR EAX,ECX
00a344ab : MOV ECX,dword ptr [0x017247f0]
00a344b1 : PUSH EAX
00a344b2 : CALL 0x009f2740
00a344b7 : MOV EDI,EAX
00a344b9 : TEST EDI,EDI
00a344bb : JZ 0x00a344e4
00a344bd : LEA EDX,[EBP + -0x1c]
00a344c0 : PUSH EDX
00a344c1 : LEA ECX,[EDI + 0x8]
00a344c4 : LEA EAX,[EBP + -0x28]
00a344c7 : MOV dword ptr [EBP + -0x1c],EBX
00a344ca : CALL 0x004437f0
00a344cf : MOV EDI,dword ptr [EDI + 0xc]
00a344d2 : MOV EAX,dword ptr [EBP + -0x28]
00a344d5 : CMP EAX,EDI
00a344d7 : JNZ 0x00a344dd
00a344d9 : XOR EDI,EDI
00a344db : JMP 0x00a344e0
00a344dd : MOV EDI,dword ptr [EAX + 0x10]
00a344e0 : TEST EDI,EDI
00a344e2 : JNZ 0x00a34513
00a344e4 : MOVZX ECX,word ptr [ESI + 0x4]
00a344e8 : MOVZX EAX,word ptr [ESI + 0x6]
00a344ec : SHL ECX,0x10
00a344ef : OR ECX,EAX
00a344f1 : PUSH EBX
00a344f2 : CALL 0x00b04230
00a344f7 : MOV EDI,EAX
00a344f9 : ADD ESP,0x4
00a344fc : TEST EDI,EDI
00a344fe : JZ 0x00a345b3
00a34504 : MOV EDX,dword ptr [0x017247f0]
00a3450a : MOV ECX,dword ptr [EDI + 0x10]
00a3450d : PUSH EDX
00a3450e : CALL 0x009f3690
00a34513 : MOVZX ECX,word ptr [ESI + 0x4]
00a34517 : MOVZX EAX,word ptr [ESI + 0x6]
00a3451b : MOV EDX,dword ptr [EBP + -0x18]
00a3451e : SHL ECX,0x10
00a34521 : PUSH EBX
00a34522 : OR ECX,EAX
00a34524 : CALL 0x009a52d0
00a34529 : CMP word ptr [ESI + 0xa0],0x1
00a34531 : JNZ 0x00a3453d
00a34533 : MOV EDI,dword ptr [EDI + 0x10]
00a34536 : MOV ECX,dword ptr [EBP + -0x18]
00a34539 : MOV word ptr [ECX + 0x5e],DI
00a3453d : INC EBX
00a3453e : CMP dword ptr [EBP + -0x20],0x0
00a34542 : JNZ 0x00a343e0
00a34548 : MOV ESI,dword ptr [EBP + -0x18]
00a3454b : JMP 0x00a342e0
00a34550 : PUSH 0xc89a98
00a34555 : LEA ECX,[EBP + -0x44]
00a34558 : CALL 0x00406460
00a3455d : MOV dword ptr [EBP + -0x4],0x0
00a34564 : MOV EDX,dword ptr [0x00da98e8]
00a3456a : MOV ECX,dword ptr [EDX]
00a3456c : TEST ECX,ECX
00a3456e : JZ 0x00a34585
00a34570 : LEA EDX,[EBP + -0x44]
00a34573 : PUSH EDX
00a34574 : PUSH 0xea
00a34579 : PUSH 0xc89ab4
00a3457e : MOV EAX,dword ptr [ECX]
00a34580 : MOV EAX,dword ptr [EAX + 0x14]
00a34583 : CALL EAX
00a34585 : MOV dword ptr [EBP + -0x4],0xffffffff
00a3458c : CMP dword ptr [EBP + -0x2c],0x8
00a34590 : JC 0x00a3459a
00a34592 : MOV ECX,dword ptr [EBP + -0x40]
00a34595 : CALL 0x006f04e0
00a3459a : XOR ECX,ECX
00a3459c : MOV dword ptr [EBP + -0x2c],0x7
00a345a3 : MOV dword ptr [EBP + -0x30],0x0
00a345aa : MOV word ptr [EBP + -0x40],CX
00a345ae : JMP 0x00a3468d
00a345b3 : PUSH 0xc89af0
00a345b8 : LEA ECX,[EBP + -0x44]
00a345bb : CALL 0x00406460
00a345c0 : MOV dword ptr [EBP + -0x4],0x1
00a345c7 : MOV EDX,dword ptr [0x00da98e8]
00a345cd : MOV ECX,dword ptr [EDX]
00a345cf : TEST ECX,ECX
00a345d1 : JZ 0x00a34585
00a345d3 : LEA EDX,[EBP + -0x44]
00a345d6 : PUSH EDX
00a345d7 : PUSH 0x103
00a345dc : PUSH 0xc89b0c
00a345e1 : JMP 0x00a3457e
00a345e3 : PUSH 0xc89b48
00a345e8 : LEA ECX,[EBP + -0x60]
00a345eb : CALL 0x00406460
00a345f0 : MOV dword ptr [EBP + -0x4],0x2
00a345f7 : MOV ECX,dword ptr [0x00da98e8]
00a345fd : MOV ECX,dword ptr [ECX]
00a345ff : TEST ECX,ECX
00a34601 : JZ 0x00a34618
00a34603 : MOV EDX,dword ptr [ECX]
00a34605 : MOV EDX,dword ptr [EDX + 0x14]
00a34608 : LEA EAX,[EBP + -0x60]
00a3460b : PUSH EAX
00a3460c : PUSH 0x136
00a34611 : PUSH 0xc89b64
00a34616 : CALL EDX
00a34618 : MOV dword ptr [EBP + -0x4],0xffffffff
00a3461f : CMP dword ptr [EBP + -0x48],0x8
00a34623 : JC 0x00a3462d
00a34625 : MOV ECX,dword ptr [EBP + -0x5c]
00a34628 : CALL 0x006f04e0
00a3462d : XOR EAX,EAX
00a3462f : MOV dword ptr [EBP + -0x48],0x7
00a34636 : MOV dword ptr [EBP + -0x4c],0x0
00a3463d : MOV word ptr [EBP + -0x5c],AX
00a34641 : TEST EDI,EDI
00a34643 : JZ 0x00a34671
00a34645 : MOVZX ECX,word ptr [ESI + 0x4]
00a34649 : MOVZX EDX,word ptr [ESI + 0x6]
00a3464d : SHL ECX,0x10
00a34650 : OR ECX,EDX
00a34652 : MOV EDX,dword ptr [EBP + -0x18]
00a34655 : PUSH EBX
00a34656 : CALL 0x009a52d0
00a3465b : CMP word ptr [ESI + 0xa0],0x1
00a34663 : JNZ 0x00a34670
00a34665 : MOV AX,word ptr [EDI + 0x10]
00a34669 : MOV ECX,dword ptr [EBP + -0x18]
00a3466c : MOV word ptr [ECX + 0x5e],AX
00a34670 : INC EBX
00a34671 : MOV EAX,dword ptr [EBP + -0x14]
00a34674 : MOV EDX,dword ptr [EBP + -0x18]
00a34677 : ADD EAX,0x4
00a3467a : MOV dword ptr [EBP + -0x14],EAX
00a3467d : CMP EAX,dword ptr [EDX + 0x6c]
00a34680 : JNZ 0x00a342f0
00a34686 : MOV EAX,dword ptr [EBP + -0x18]
00a34689 : MOV byte ptr [EAX + 0x5c],0x1
00a3468d : MOV ECX,dword ptr [0x00da9894]
00a34693 : MOV EAX,dword ptr [ECX]
00a34695 : MOV EAX,dword ptr [EAX + 0x12c]
00a3469b : TEST EAX,EAX
00a3469d : JZ 0x00a346a2
00a3469f : MOV EAX,dword ptr [EAX + 0xc]
00a346a2 : PUSH EAX
00a346a3 : CALL 0x00931e60
00a346a8 : MOV ESI,dword ptr [EBP + 0x8]
00a346ab : MOV EDX,dword ptr [ESI + 0xac]
00a346b1 : MOV EAX,dword ptr [EDX + 0x1ed0]
00a346b7 : PUSH 0x0
00a346b9 : PUSH EAX
00a346ba : CALL 0x00a96790
00a346bf : MOV ECX,dword ptr [ESI + 0xac]
00a346c5 : MOV EDX,dword ptr [ECX]
00a346c7 : MOV EAX,dword ptr [EDX + 0x46c]
00a346cd : PUSH 0x1
00a346cf : CALL EAX
00a346d1 : PUSH EAX
00a346d2 : CALL 0x00a96790
00a346d7 : MOV ECX,dword ptr [0x00da9894]
00a346dd : MOV EAX,dword ptr [ECX]
00a346df : TEST EAX,EAX
00a346e1 : JZ 0x00a3470f
00a346e3 : MOV EAX,dword ptr [EAX + 0x114]
00a346e9 : TEST EAX,EAX
00a346eb : JZ 0x00a3470f
00a346ed : MOV ECX,dword ptr [ESI + 0xac]
00a346f3 : MOV ECX,dword ptr [ECX + 0x1f38]
00a346f9 : MOV EDX,dword ptr [EAX]
00a346fb : MOV EDX,dword ptr [EDX + 0x4]
00a346fe : PUSH ECX
00a346ff : PUSH 0xc83bd4
00a34704 : PUSH 0xc83bd8
00a34709 : PUSH EAX
00a3470a : CALL EDX
00a3470c : ADD ESP,0x10
00a3470f : MOV EAX,[0x00da9894]
00a34714 : MOV ECX,dword ptr [EAX]
00a34716 : MOV EDI,dword ptr [ECX + 0x200]
00a3471c : MOV EDX,ESI
00a3471e : MOV EAX,dword ptr [EDX + 0xac]
00a34724 : MOV EBX,dword ptr [EAX + 0x1fbc]
00a3472a : TEST BL,0x4
00a3472d : JZ 0x00a34736
00a3472f : XOR ESI,ESI
00a34731 : CALL 0x008bf1c0
00a34736 : TEST BL,0x8
00a34739 : JZ 0x00a34745
00a3473b : MOV ESI,0x1
00a34740 : CALL 0x008bf1c0
00a34745 : TEST BL,0x10
00a34748 : JZ 0x00a34754
00a3474a : MOV ESI,0x2
00a3474f : CALL 0x008bf1c0
00a34754 : MOV EDX,dword ptr [EBP + 0x8]
00a34757 : MOV EAX,dword ptr [EDX + 0xac]
00a3475d : XOR ECX,ECX
00a3475f : TEST EAX,EAX
00a34761 : JZ 0x00a3476a
00a34763 : MOVZX ECX,word ptr [EAX + 0xa0]
00a3476a : MOV EAX,[0x00da9894]
00a3476f : MOV EAX,dword ptr [EAX]
00a34771 : MOV EAX,dword ptr [EAX + 0x130]
00a34777 : TEST EAX,EAX
00a34779 : JZ 0x00a3477e
00a3477b : MOV EAX,dword ptr [EAX + 0x3c]
00a3477e : PUSH ECX
00a3477f : PUSH EAX
00a34780 : CALL 0x009a0fa0
00a34785 : MOV EDI,dword ptr [EBP + 0x8]
00a34788 : MOV ECX,dword ptr [EDI + 0xac]
00a3478e : MOV EDX,dword ptr [0x00da9894]
00a34794 : MOV EAX,dword ptr [ECX + 0xa0]
00a3479a : MOV ECX,dword ptr [EDX]
00a3479c : MOV EDX,dword ptr [0x0172491c]
00a347a2 : MOV ESI,dword ptr [ECX + 0x2bc]
00a347a8 : MOV ECX,dword ptr [EDX + 0x144]
00a347ae : TEST ECX,ECX
00a347b0 : JZ 0x00a347c6
00a347b2 : TEST EAX,EAX
00a347b4 : JLE 0x00a347c6
00a347b6 : PUSH EAX
00a347b7 : XOR AL,AL
00a347b9 : CALL 0x00812460
00a347be : CMP dword ptr [ESI + 0x3c],EAX
00a347c1 : JNC 0x00a347c6
00a347c3 : MOV dword ptr [ESI + 0x3c],EAX
00a347c6 : MOV byte ptr [EDI + 0x294],0x1
00a347cd : MOV ECX,dword ptr [EBP + -0xc]
00a347d0 : MOV dword ptr FS:[0x0],ECX
00a347d7 : POP ECX
00a347d8 : POP EDI
00a347d9 : POP ESI
00a347da : POP EBX
00a347db : MOV ESP,EBP
00a347dd : POP EBP
00a347de : RET 0x4

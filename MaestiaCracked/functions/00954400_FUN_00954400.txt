PROGRAM  : Maestia.exe
FUNCTION : FUN_00954400
ENTRY    : 00954400
BODY     : [[00954400, 00954e0e]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00954400(byte param_1,int *param_2)

{
  char cVar1;
  short sVar2;
  uint uVar3;
  undefined4 uVar4;
  int *piVar5;
  int iVar6;
  int *in_ECX;
  int *piVar7;
  int *piVar8;
  __time64_t _Var9;
  int *local_2ac;
  int *local_2a8;
  int *local_2a4;
  int *local_2a0;
  uint local_29c;
  int *local_298;
  undefined4 local_294;
  int local_290;
  undefined4 local_284;
  uint local_280;
  undefined1 local_1b0 [404];
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b539f4;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)&local_2ac;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffd48;
  ExceptionList = &local_14;
  if (*(char *)(DAT_00da93ec + 0x1d5) != '\0') goto LAB_00954de9;
  piVar7 = in_ECX + 0x16;
  in_ECX[0x20] = 0;
  local_2a8 = in_ECX;
  FUN_00406360(&DAT_00c7587c,0);
  uVar4 = FUN_0081cbe0(DAT_0172491c);
  local_c = 0;
  FUN_00405eb0(uVar4,0,0xffffffff);
  local_c = 0xffffffff;
  if (7 < local_280) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_29c = (uint)param_1;
  *(undefined1 *)(local_2a8 + 0xe) = 0;
  local_294 = (uint)local_294._2_2_ << 0x10;
  local_280 = 7;
  local_284 = 0;
  local_2a0 = param_2;
  switch(local_29c) {
  case 0:
    local_2a4 = (int *)FUN_00a1a840(param_2);
    if (local_2a4 == (int *)0x0) {
      piVar5 = (int *)FUN_00a1a6d0(param_2);
      if (piVar5 != (int *)0x0) {
        local_2a4 = piVar5;
        sVar2 = (**(code **)(*piVar5 + 0x1e4))();
        if (sVar2 == 1) {
          param_2 = (int *)piVar5[0x5b1];
          uVar4 = FUN_0081cbe0(DAT_0172491c);
          local_c = 2;
          FUN_00405d70(uVar4);
        }
        else {
          param_2 = (int *)piVar5[2];
          uVar4 = FUN_0081cbe0(DAT_0172491c);
          local_c = 3;
          FUN_00405d70(uVar4);
        }
        local_c = 0xffffffff;
        FUN_00406560();
        FUN_00405d70(local_2a4 + 3);
        local_29c = 2;
        param_1 = 2;
        local_2a0 = param_2;
      }
    }
    else {
      uVar4 = FUN_0081cbe0(DAT_0172491c);
      local_c = 1;
      FUN_00405d70(uVar4);
      local_c = 0xffffffff;
      FUN_00406560();
      FUN_00405d70(local_2a4 + 3);
      *(undefined1 *)(local_2a8 + 0xe) = 1;
      local_2a4 = *(int **)local_2a8[0x25];
      if (local_2a4 != (int *)local_2a8[0x25]) {
        do {
          cVar1 = FUN_00404700();
          if (cVar1 != '\0') {
            FUN_00953590();
            goto LAB_00954de9;
          }
          FUN_00442590();
        } while (local_2a4 != (int *)local_2a8[0x25]);
      }
    }
    piVar8 = local_2a8;
    local_2a4 = local_2a0;
    FUN_00427010(&local_2a4);
    piVar5 = local_2ac;
    if (local_2ac != (int *)piVar8[0x22]) {
      param_1 = __allshr();
      param_2 = (int *)piVar5[6];
      local_29c = (uint)param_1;
      local_2a0 = param_2;
    }
    break;
  case 2:
    cVar1 = (char)((uint)param_2 >> 0x18);
    if (cVar1 == '\x06') {
      local_2ac = (int *)FUN_004049b0();
      if (local_2ac != (int *)0x0) {
        uVar4 = FUN_0081cbe0(DAT_0172491c);
        local_c = 4;
        FUN_00405d70(uVar4);
        local_c = 0xffffffff;
        FUN_00406560();
        uVar4 = FUN_00824a20(DAT_0172491c,0);
        local_c = 5;
        FUN_00405d70(uVar4);
        goto LAB_00954bec;
      }
    }
    else if (cVar1 == '\a') {
      local_2ac = (int *)FUN_004049b0();
      if (local_2ac != (int *)0x0) {
        uVar4 = FUN_0081cbe0(DAT_0172491c);
        local_c = 6;
        FUN_00405d70(uVar4);
        local_c = 0xffffffff;
        FUN_00406560();
        uVar4 = FUN_00824a20(DAT_0172491c,0);
        local_c = 7;
        FUN_00405d70(uVar4);
        goto LAB_00954bec;
      }
    }
    else if (cVar1 == '\x05') {
      local_2ac = (int *)FUN_004049b0();
      if (local_2ac != (int *)0x0) {
        uVar4 = FUN_0081cbe0(DAT_0172491c);
        local_c = 8;
        FUN_00405d70(uVar4);
        local_c = 0xffffffff;
        FUN_00406560();
        uVar4 = FUN_00824a20(DAT_0172491c,0);
        local_c = 9;
        FUN_00405d70(uVar4);
        goto LAB_00954bec;
      }
    }
    else {
      if (cVar1 != 'f') {
        FUN_008018d0(L"OpenPeepWall: fail to find indexType (%d, %d)\n",2,param_2);
        goto LAB_00954de9;
      }
      local_2ac = (int *)FUN_004049b0();
      if (local_2ac != (int *)0x0) {
        if (local_2ac[0x3c] != 0) {
          uVar4 = FUN_00824a20(DAT_0172491c,0);
          local_c = 10;
          FUN_00405d70(uVar4);
          local_c = 0xffffffff;
          FUN_00406560();
        }
        if (local_2a8[0x1b] == 0) {
          uVar4 = FUN_00824a20(DAT_0172491c,0);
          local_c = 0xb;
          FUN_00405d70(uVar4);
          local_c = 0xffffffff;
          FUN_00406560();
        }
        uVar4 = FUN_0081cbe0(DAT_0172491c);
        local_c = 0xc;
        FUN_00405d70(uVar4);
        goto LAB_00954bec;
      }
    }
    break;
  case 3:
    iVar6 = FUN_00703c00(0x301,uVar3);
    if (iVar6 != 0) {
      uVar4 = FUN_0081cbe0(DAT_0172491c);
      local_c = 0xf;
      FUN_00405d70(uVar4);
      local_c = 0xffffffff;
      FUN_00406560();
      iVar6 = FUN_00824a20(DAT_0172491c,0);
      local_c = 0x10;
      if (*(uint *)(iVar6 + 0x18) < 8) {
        iVar6 = iVar6 + 4;
      }
      else {
        iVar6 = *(int *)(iVar6 + 4);
      }
      uVar4 = FUN_00404750(L"%s:%d",iVar6,(uint)param_2 & 0xffff);
      local_c._0_1_ = 0x11;
      FUN_00405d70(uVar4);
      local_c = CONCAT31(local_c._1_3_,0x10);
      FUN_00406560();
      goto LAB_00954bec;
    }
    break;
  case 4:
    local_2ac = (int *)FUN_006f19c0(param_2);
    if (local_2ac != (int *)0x0) {
      uVar4 = FUN_0081cbe0(DAT_0172491c);
      local_c = 0xd;
      FUN_00405d70(uVar4);
      local_c = 0xffffffff;
      FUN_00406560();
      iVar6 = FUN_006f0c10(local_1b0,1);
      local_c = 0xe;
      if (*(uint *)(iVar6 + 0x18) < 8) {
        FUN_00405c00(piVar7);
      }
      else {
        FUN_00405c00(piVar7);
      }
      goto LAB_00954bec;
    }
    break;
  case 5:
    uVar4 = FUN_0081cbe0(DAT_0172491c);
    local_c = 0x12;
    FUN_00405d70(uVar4);
    local_c = 0xffffffff;
    FUN_00406560();
    FUN_0040f680("helpwall_%d",param_2);
    uVar4 = FUN_0081cbe0(DAT_0172491c);
    local_c = 0x13;
    FUN_00405d70(uVar4);
LAB_00954bec:
    local_c = 0xffffffff;
    FUN_00406560();
  }
  if (local_2a8[0x1b] == 0) {
    FUN_008018d0(L"OpenPeepWall: fail to find name (%d, %d)\n",param_1,param_2);
  }
  local_2a8[0x1d] = 0;
  local_2a8[0x1e] = 0;
  local_2a8[0x1f] = 0;
  piVar8 = local_2a8 + 0x24;
  FUN_00426f10(&local_2ac);
  piVar5 = local_2a8;
  if (local_2ac == (int *)local_2a8[0x25]) {
    local_2ac = (int *)FUN_006f0760(0x68,"",0,(DAT_01725270 >> 3 & 1) == 0);
    local_c = 0x14;
    if (local_2ac == (int *)0x0) {
      local_290 = 0;
    }
    else {
      local_290 = FUN_004278e0(local_2ac);
    }
    local_c = 0xffffffff;
    local_298 = local_2a0;
    local_2ac = piVar5 + 0x20;
    *local_2ac = local_290;
    local_294 = local_29c;
    FUN_00426e00(piVar8,&local_298);
    FUN_00449730();
    FUN_009533e0(local_2a8,0,0,0);
    piVar5 = local_2a8;
  }
  else {
    iVar6 = local_2ac[6];
    local_2a8[0x20] = iVar6;
    if ((*(int *)(iVar6 + 0x14) - *(int *)(iVar6 + 0x10) & 0xfffffffcU) == 0) {
      FUN_009533e0(local_2a8,1,0,0);
    }
    else {
      FUN_009533e0(local_2a8,1,*(undefined4 *)(**(int **)(iVar6 + 0x10) + 8),
                   *(undefined4 *)(**(int **)(iVar6 + 0x10) + 0xc));
    }
  }
  iVar6 = piVar5[0x20];
  if (iVar6 == 0) {
    FUN_008018d0(L"OpenPeepWall: no wall (%d, %d)\n",param_1,param_2);
  }
  else {
    _Var9 = __time64((__time64_t *)0x0);
    *(__time64_t *)(iVar6 + 0x20) = _Var9;
    FUN_00405eb0(piVar7,0,0xffffffff);
    FUN_00405eb0(piVar5 + 0xf,0,0xffffffff);
    if ((uint)in_ECX[0x1c] < 8) {
      piVar7 = in_ECX + 0x17;
    }
    else {
      piVar7 = (int *)in_ECX[0x17];
    }
    if ((uint)piVar5[0x15] < 8) {
      piVar8 = piVar5 + 0x10;
    }
    else {
      piVar8 = (int *)piVar5[0x10];
    }
    FUN_008018d0(L"OpenPeepWall: [%s, %s] (%d, %d)\n",piVar8,piVar7,param_1,param_2);
  }
  (**(code **)(*piVar5 + 0x18))(0,300);
LAB_00954de9:
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)&local_2ac);
  return;
}



============================================================
DISASSEMBLY
============================================================
00954400 : PUSH EBP
00954401 : MOV EBP,ESP
00954403 : AND ESP,0xfffffff8
00954406 : PUSH -0x1
00954408 : PUSH 0xb539f4
0095440d : MOV EAX,FS:[0x0]
00954413 : PUSH EAX
00954414 : SUB ESP,0x298
0095441a : MOV EAX,[0x00d66fa0]
0095441f : XOR EAX,ESP
00954421 : MOV dword ptr [ESP + 0x290],EAX
00954428 : PUSH EBX
00954429 : PUSH ESI
0095442a : PUSH EDI
0095442b : MOV EAX,[0x00d66fa0]
00954430 : XOR EAX,ESP
00954432 : PUSH EAX
00954433 : LEA EAX,[ESP + 0x2a8]
0095443a : MOV FS:[0x0],EAX
00954440 : MOV EAX,[0x00da93ec]
00954445 : MOV AL,byte ptr [EAX + 0x1d5]
0095444b : MOV EDI,ECX
0095444d : MOV dword ptr [ESP + 0x14],EDI
00954451 : TEST AL,AL
00954453 : JNZ 0x00954de9
00954459 : PUSH 0x0
0095445b : LEA EBX,[EDI + 0x58]
0095445e : PUSH 0xc7587c
00954463 : MOV ECX,EBX
00954465 : MOV dword ptr [EDI + 0x80],0x0
0095446f : CALL 0x00406360
00954474 : MOV ECX,dword ptr [0x0172491c]
0095447a : PUSH ECX
0095447b : MOV ECX,0xc75880
00954480 : LEA ESI,[ESP + 0x28]
00954484 : CALL 0x0081cbe0
00954489 : MOV dword ptr [ESP + 0x2b0],0x0
00954494 : PUSH -0x1
00954496 : PUSH 0x0
00954498 : ADD EDI,0x3c
0095449b : PUSH EAX
0095449c : MOV ECX,EDI
0095449e : CALL 0x00405eb0
009544a3 : MOV dword ptr [ESP + 0x2b0],0xffffffff
009544ae : CMP dword ptr [ESP + 0x3c],0x8
009544b3 : JC 0x009544be
009544b5 : MOV ECX,dword ptr [ESP + 0x28]
009544b9 : CALL 0x006f04e0
009544be : MOVZX ECX,byte ptr [EBP + 0x8]
009544c2 : MOV EAX,dword ptr [ESP + 0x14]
009544c6 : XOR EDX,EDX
009544c8 : MOV byte ptr [EAX + 0x38],DL
009544cb : MOV word ptr [ESP + 0x28],DX
009544d0 : MOV EAX,ECX
009544d2 : CDQ
009544d3 : XOR EDX,EDX
009544d5 : OR EDX,dword ptr [EBP + 0xc]
009544d8 : XOR ESI,ESI
009544da : OR EAX,ESI
009544dc : MOV dword ptr [ESP + 0x3c],0x7
009544e4 : MOV dword ptr [ESP + 0x38],0x0
009544ec : MOV dword ptr [ESP + 0x1c],EDX
009544f0 : MOV dword ptr [ESP + 0x20],EAX
009544f4 : CMP ECX,0x5
009544f7 : JA 0x00954bf1
009544fd : JMP dword ptr [ECX*0x4 + 0x954e10]
00954504 : MOV ESI,dword ptr [EBP + 0xc]
00954507 : MOV ECX,dword ptr [0x00da93ec]
0095450d : PUSH ESI
0095450e : CALL 0x00a1a840
00954513 : MOV dword ptr [ESP + 0x18],EAX
00954517 : TEST EAX,EAX
00954519 : JZ 0x009545c9
0095451f : MOV ECX,dword ptr [0x0172491c]
00954525 : PUSH ECX
00954526 : MOV ECX,0xc75890
0095452b : LEA ESI,[ESP + 0x12c]
00954532 : CALL 0x0081cbe0
00954537 : MOV dword ptr [ESP + 0x2b0],0x1
00954542 : PUSH EAX
00954543 : MOV ECX,EDI
00954545 : CALL 0x00405d70
0095454a : MOV dword ptr [ESP + 0x2b0],0xffffffff
00954555 : MOV ECX,ESI
00954557 : CALL 0x00406560
0095455c : MOV EDX,dword ptr [ESP + 0x18]
00954560 : ADD EDX,0xc
00954563 : PUSH EDX
00954564 : MOV ECX,EBX
00954566 : CALL 0x00405d70
0095456b : MOV EAX,dword ptr [ESP + 0x14]
0095456f : MOV byte ptr [EAX + 0x38],0x1
00954573 : MOV EAX,dword ptr [EAX + 0x94]
00954579 : MOV ESI,dword ptr [EAX]
0095457b : MOV dword ptr [ESP + 0x18],ESI
0095457f : CMP ESI,EAX
00954581 : JZ 0x0095469e
00954587 : MOV ECX,dword ptr [ESI + 0x18]
0095458a : ADD ECX,0x2c
0095458d : MOV EAX,EBX
0095458f : CALL 0x00404700
00954594 : TEST AL,AL
00954596 : JNZ 0x009545b8
00954598 : LEA EDX,[ESP + 0x18]
0095459c : CALL 0x00442590
009545a1 : MOV EAX,dword ptr [ESP + 0x14]
009545a5 : MOV EAX,dword ptr [EAX + 0x94]
009545ab : MOV ESI,dword ptr [ESP + 0x18]
009545af : CMP ESI,EAX
009545b1 : JNZ 0x00954587
009545b3 : JMP 0x0095469e
009545b8 : MOV EAX,dword ptr [ESI + 0x18]
009545bb : MOV ESI,dword ptr [ESP + 0x14]
009545bf : CALL 0x00953590
009545c4 : JMP 0x00954de9
009545c9 : MOV ECX,dword ptr [0x00da93ec]
009545cf : PUSH ESI
009545d0 : CALL 0x00a1a6d0
009545d5 : MOV ESI,EAX
009545d7 : MOV dword ptr [ESP + 0x18],ESI
009545db : TEST ESI,ESI
009545dd : JZ 0x0095469e
009545e3 : MOV EDX,dword ptr [ESI]
009545e5 : MOV EAX,dword ptr [EDX + 0x1e4]
009545eb : MOV ECX,ESI
009545ed : CALL EAX
009545ef : CMP AX,0x1
009545f3 : JNZ 0x00954638
009545f5 : MOV ECX,dword ptr [ESI + 0x16c4]
009545fb : MOV EDX,dword ptr [0x0172491c]
00954601 : MOV dword ptr [EBP + 0xc],ECX
00954604 : PUSH EDX
00954605 : MOV ECX,0xc7589c
0095460a : LEA ESI,[ESP + 0x84]
00954611 : CALL 0x0081cbe0
00954616 : MOV dword ptr [ESP + 0x2b0],0x2
00954621 : PUSH EAX
00954622 : MOV ECX,EDI
00954624 : CALL 0x00405d70
00954629 : MOV dword ptr [ESP + 0x2b0],0xffffffff
00954634 : MOV ECX,ESI
00954636 : JMP 0x00954676
00954638 : MOV ECX,dword ptr [0x0172491c]
0095463e : MOV EAX,dword ptr [ESI + 0x8]
00954641 : PUSH ECX
00954642 : MOV ECX,0xc758ac
00954647 : LEA ESI,[ESP + 0x244]
0095464e : MOV dword ptr [EBP + 0xc],EAX
00954651 : CALL 0x0081cbe0
00954656 : MOV dword ptr [ESP + 0x2b0],0x3
00954661 : PUSH EAX
00954662 : MOV ECX,EDI
00954664 : CALL 0x00405d70
00954669 : MOV dword ptr [ESP + 0x2b0],0xffffffff
00954674 : MOV ECX,ESI
00954676 : CALL 0x00406560
0095467b : MOV EDX,dword ptr [ESP + 0x18]
0095467f : ADD EDX,0xc
00954682 : PUSH EDX
00954683 : MOV ECX,EBX
00954685 : CALL 0x00405d70
0095468a : XOR EAX,EAX
0095468c : OR EAX,0x2
0095468f : MOV dword ptr [ESP + 0x20],EAX
00954693 : MOV EAX,dword ptr [EBP + 0xc]
00954696 : MOV byte ptr [EBP + 0x8],0x2
0095469a : MOV dword ptr [ESP + 0x1c],EAX
0095469e : MOV ECX,dword ptr [ESP + 0x1c]
009546a2 : MOV ESI,dword ptr [ESP + 0x14]
009546a6 : LEA EDX,[ESP + 0x18]
009546aa : MOV dword ptr [ESP + 0x18],ECX
009546ae : PUSH EDX
009546af : LEA ECX,[ESI + 0x84]
009546b5 : LEA EAX,[ESP + 0x14]
009546b9 : CALL 0x00427010
009546be : MOV EAX,dword ptr [ESI + 0x88]
009546c4 : MOV ESI,dword ptr [ESP + 0x10]
009546c8 : CMP ESI,EAX
009546ca : JZ 0x00954bf1
009546d0 : MOV EAX,dword ptr [ESI + 0x18]
009546d3 : MOV EDX,dword ptr [ESI + 0x1c]
009546d6 : MOV CL,0x20
009546d8 : CALL 0x00b0b070
009546dd : MOV ESI,dword ptr [ESI + 0x18]
009546e0 : MOV byte ptr [EBP + 0x8],AL
009546e3 : MOVZX EAX,AL
009546e6 : CDQ
009546e7 : XOR ECX,ECX
009546e9 : XOR EDX,EDX
009546eb : OR ECX,ESI
009546ed : OR EAX,EDX
009546ef : MOV dword ptr [EBP + 0xc],ESI
009546f2 : MOV dword ptr [ESP + 0x1c],ECX
009546f6 : MOV dword ptr [ESP + 0x20],EAX
009546fa : JMP 0x00954bf1
009546ff : MOV ECX,dword ptr [EBP + 0xc]
00954702 : MOV EAX,ECX
00954704 : SHR EAX,0x18
00954707 : PUSH ECX
00954708 : CMP AL,0x6
0095470a : JNZ 0x0095479c
00954710 : CALL 0x004049b0
00954715 : ADD ESP,0x4
00954718 : MOV dword ptr [ESP + 0x10],EAX
0095471c : TEST EAX,EAX
0095471e : JZ 0x00954bf1
00954724 : MOV EAX,[0x0172491c]
00954729 : PUSH EAX
0095472a : MOV ECX,0xc758c0
0095472f : LEA ESI,[ESP + 0xbc]
00954736 : CALL 0x0081cbe0
0095473b : MOV dword ptr [ESP + 0x2b0],0x4
00954746 : PUSH EAX
00954747 : MOV ECX,EDI
00954749 : CALL 0x00405d70
0095474e : OR EDI,0xffffffff
00954751 : MOV dword ptr [ESP + 0x2b0],EDI
00954758 : MOV ECX,ESI
0095475a : CALL 0x00406560
0095475f : MOV ECX,dword ptr [0x0172491c]
00954765 : MOV EDX,dword ptr [ESP + 0x10]
00954769 : PUSH 0x0
0095476b : ADD EDX,0x18
0095476e : PUSH ECX
0095476f : LEA ESI,[ESP + 0x1a0]
00954776 : CALL 0x00824a20
0095477b : MOV dword ptr [ESP + 0x2b0],0x5
00954786 : PUSH EAX
00954787 : MOV ECX,EBX
00954789 : CALL 0x00405d70
0095478e : MOV dword ptr [ESP + 0x2b0],EDI
00954795 : MOV ECX,ESI
00954797 : JMP 0x00954bec
0095479c : CMP AL,0x7
0095479e : JNZ 0x00954830
009547a4 : CALL 0x004049b0
009547a9 : ADD ESP,0x4
009547ac : MOV dword ptr [ESP + 0x10],EAX
009547b0 : TEST EAX,EAX
009547b2 : JZ 0x00954bf1
009547b8 : MOV EDX,dword ptr [0x0172491c]
009547be : PUSH EDX
009547bf : MOV ECX,0xc758d0
009547c4 : LEA ESI,[ESP + 0xf4]
009547cb : CALL 0x0081cbe0
009547d0 : MOV dword ptr [ESP + 0x2b0],0x6
009547db : PUSH EAX
009547dc : MOV ECX,EDI
009547de : CALL 0x00405d70
009547e3 : OR EDI,0xffffffff
009547e6 : MOV dword ptr [ESP + 0x2b0],EDI
009547ed : MOV ECX,ESI
009547ef : CALL 0x00406560
009547f4 : MOV EAX,[0x0172491c]
009547f9 : MOV EDX,dword ptr [ESP + 0x10]
009547fd : PUSH 0x0
009547ff : ADD EDX,0x18
00954802 : PUSH EAX
00954803 : LEA ESI,[ESP + 0x210]
0095480a : CALL 0x00824a20
0095480f : MOV dword ptr [ESP + 0x2b0],0x7
0095481a : PUSH EAX
0095481b : MOV ECX,EBX
0095481d : CALL 0x00405d70
00954822 : MOV dword ptr [ESP + 0x2b0],EDI
00954829 : MOV ECX,ESI
0095482b : JMP 0x00954bec
00954830 : CMP AL,0x5
00954832 : JNZ 0x009548c1
00954838 : CALL 0x004049b0
0095483d : ADD ESP,0x4
00954840 : MOV dword ptr [ESP + 0x10],EAX
00954844 : TEST EAX,EAX
00954846 : JZ 0x00954bf1
0095484c : MOV ECX,dword ptr [0x0172491c]
00954852 : PUSH ECX
00954853 : MOV ECX,0xc758e0
00954858 : LEA ESI,[ESP + 0x4c]
0095485c : CALL 0x0081cbe0
00954861 : MOV dword ptr [ESP + 0x2b0],0x8
0095486c : PUSH EAX
0095486d : MOV ECX,EDI
0095486f : CALL 0x00405d70
00954874 : OR EDI,0xffffffff
00954877 : MOV dword ptr [ESP + 0x2b0],EDI
0095487e : MOV ECX,ESI
00954880 : CALL 0x00406560
00954885 : MOV EAX,[0x0172491c]
0095488a : MOV EDX,dword ptr [ESP + 0x10]
0095488e : PUSH 0x0
00954890 : ADD EDX,0x18
00954893 : PUSH EAX
00954894 : LEA ESI,[ESP + 0x1d8]
0095489b : CALL 0x00824a20
009548a0 : MOV dword ptr [ESP + 0x2b0],0x9
009548ab : PUSH EAX
009548ac : MOV ECX,EBX
009548ae : CALL 0x00405d70
009548b3 : MOV dword ptr [ESP + 0x2b0],EDI
009548ba : MOV ECX,ESI
009548bc : JMP 0x00954bec
009548c1 : CMP AL,0x66
009548c3 : JNZ 0x009549a8
009548c9 : CALL 0x004049b0
009548ce : ADD ESP,0x4
009548d1 : MOV dword ptr [ESP + 0x10],EAX
009548d5 : TEST EAX,EAX
009548d7 : JZ 0x00954bf1
009548dd : MOV ECX,dword ptr [EAX + 0xf0]
009548e3 : TEST ECX,ECX
009548e5 : JZ 0x00954928
009548e7 : LEA EDX,[ECX + 0x18]
009548ea : MOV ECX,dword ptr [0x0172491c]
009548f0 : PUSH 0x0
009548f2 : PUSH ECX
009548f3 : LEA ESI,[ESP + 0x168]
009548fa : CALL 0x00824a20
009548ff : MOV dword ptr [ESP + 0x2b0],0xa
0095490a : PUSH EAX
0095490b : MOV ECX,EBX
0095490d : CALL 0x00405d70
00954912 : MOV dword ptr [ESP + 0x2b0],0xffffffff
0095491d : MOV ECX,ESI
0095491f : CALL 0x00406560
00954924 : MOV EAX,dword ptr [ESP + 0x10]
00954928 : MOV EDX,dword ptr [ESP + 0x14]
0095492c : CMP dword ptr [EDX + 0x6c],0x0
00954930 : JNZ 0x0095496b
00954932 : LEA EDX,[EAX + 0x18]
00954935 : MOV EAX,[0x0172491c]
0095493a : PUSH 0x0
0095493c : PUSH EAX
0095493d : LEA ESI,[ESP + 0x6c]
00954941 : CALL 0x00824a20
00954946 : MOV dword ptr [ESP + 0x2b0],0xb
00954951 : PUSH EAX
00954952 : MOV ECX,EBX
00954954 : CALL 0x00405d70
00954959 : MOV dword ptr [ESP + 0x2b0],0xffffffff
00954964 : MOV ECX,ESI
00954966 : CALL 0x00406560
0095496b : MOV ECX,dword ptr [0x0172491c]
00954971 : PUSH ECX
00954972 : MOV ECX,0xc758f0
00954977 : LEA ESI,[ESP + 0xa0]
0095497e : CALL 0x0081cbe0
00954983 : MOV dword ptr [ESP + 0x2b0],0xc
0095498e : PUSH EAX
0095498f : MOV ECX,EDI
00954991 : CALL 0x00405d70
00954996 : MOV dword ptr [ESP + 0x2b0],0xffffffff
009549a1 : MOV ECX,ESI
009549a3 : JMP 0x00954bec
009549a8 : MOV ESI,dword ptr [0x00da98e8]
009549ae : PUSH 0x2
009549b0 : PUSH 0xc75900
009549b5 : CALL 0x008018d0
009549ba : ADD ESP,0xc
009549bd : JMP 0x00954de9
009549c2 : MOV EDX,dword ptr [EBP + 0xc]
009549c5 : PUSH EDX
009549c6 : MOV ESI,0x17245e0
009549cb : CALL 0x006f19c0
009549d0 : MOV dword ptr [ESP + 0x10],EAX
009549d4 : TEST EAX,EAX
009549d6 : JZ 0x00954bf1
009549dc : MOV EAX,[0x0172491c]
009549e1 : PUSH EAX
009549e2 : MOV ECX,0xc75960
009549e7 : LEA ESI,[ESP + 0xd8]
009549ee : CALL 0x0081cbe0
009549f3 : MOV dword ptr [ESP + 0x2b0],0xd
009549fe : PUSH EAX
009549ff : MOV ECX,EDI
00954a01 : CALL 0x00405d70
00954a06 : OR ESI,0xffffffff
00954a09 : MOV dword ptr [ESP + 0x2b0],ESI
00954a10 : LEA ECX,[ESP + 0xd4]
00954a17 : CALL 0x00406560
00954a1c : MOV EDX,dword ptr [ESP + 0x10]
00954a20 : MOV EDX,dword ptr [EDX + 0x8]
00954a23 : PUSH 0x1
00954a25 : LEA ECX,[ESP + 0x110]
00954a2c : PUSH ECX
00954a2d : MOV ECX,0x1724628
00954a32 : CALL 0x006f0c10
00954a37 : MOV dword ptr [ESP + 0x2b0],0xe
00954a42 : CMP dword ptr [EAX + 0x18],0x8
00954a46 : JC 0x00954a66
00954a48 : MOV EAX,dword ptr [EAX + 0x4]
00954a4b : PUSH EBX
00954a4c : MOV EDX,EAX
00954a4e : CALL 0x00405c00
00954a53 : MOV dword ptr [ESP + 0x2b0],ESI
00954a5a : LEA ECX,[ESP + 0x10c]
00954a61 : JMP 0x00954bec
00954a66 : ADD EAX,0x4
00954a69 : PUSH EBX
00954a6a : MOV EDX,EAX
00954a6c : CALL 0x00405c00
00954a71 : MOV dword ptr [ESP + 0x2b0],ESI
00954a78 : LEA ECX,[ESP + 0x10c]
00954a7f : JMP 0x00954bec
00954a84 : MOV EDI,dword ptr [EBP + 0xc]
00954a87 : SHR EDI,0x10
00954a8a : PUSH 0x301
00954a8f : CALL 0x00703c00
00954a94 : MOV EDI,EAX
00954a96 : ADD ESP,0x4
00954a99 : TEST EDI,EDI
00954a9b : JZ 0x00954bf1
00954aa1 : MOV EAX,[0x0172491c]
00954aa6 : PUSH EAX
00954aa7 : MOV ECX,0xc75970
00954aac : LEA ESI,[ESP + 0x148]
00954ab3 : CALL 0x0081cbe0
00954ab8 : MOV dword ptr [ESP + 0x2b0],0xf
00954ac3 : MOV ECX,dword ptr [ESP + 0x14]
00954ac7 : PUSH EAX
00954ac8 : ADD ECX,0x3c
00954acb : CALL 0x00405d70
00954ad0 : MOV dword ptr [ESP + 0x2b0],0xffffffff
00954adb : MOV ECX,ESI
00954add : CALL 0x00406560
00954ae2 : MOV ECX,dword ptr [0x0172491c]
00954ae8 : PUSH 0x0
00954aea : LEA EDX,[EDI + 0x18]
00954aed : PUSH ECX
00954aee : LEA ESI,[ESP + 0x1bc]
00954af5 : CALL 0x00824a20
00954afa : MOV dword ptr [ESP + 0x2b0],0x10
00954b05 : CMP dword ptr [EAX + 0x18],0x8
00954b09 : JC 0x00954b10
00954b0b : MOV EAX,dword ptr [EAX + 0x4]
00954b0e : JMP 0x00954b13
00954b10 : ADD EAX,0x4
00954b13 : MOVZX EDX,word ptr [EBP + 0xc]
00954b17 : PUSH EDX
00954b18 : PUSH EAX
00954b19 : PUSH 0xc75980
00954b1e : LEA ESI,[ESP + 0x188]
00954b25 : CALL 0x00404750
00954b2a : ADD ESP,0xc
00954b2d : MOV byte ptr [ESP + 0x2b0],0x11
00954b35 : PUSH EAX
00954b36 : MOV ECX,EBX
00954b38 : CALL 0x00405d70
00954b3d : MOV byte ptr [ESP + 0x2b0],0x10
00954b45 : MOV ECX,ESI
00954b47 : CALL 0x00406560
00954b4c : MOV dword ptr [ESP + 0x2b0],0xffffffff
00954b57 : LEA ECX,[ESP + 0x1b4]
00954b5e : JMP 0x00954bec
00954b63 : MOV EAX,[0x0172491c]
00954b68 : PUSH EAX
00954b69 : MOV ECX,0xc7598c
00954b6e : LEA ESI,[ESP + 0x1f0]
00954b75 : CALL 0x0081cbe0
00954b7a : MOV dword ptr [ESP + 0x2b0],0x12
00954b85 : PUSH EAX
00954b86 : MOV ECX,EDI
00954b88 : CALL 0x00405d70
00954b8d : OR EDI,0xffffffff
00954b90 : MOV dword ptr [ESP + 0x2b0],EDI
00954b97 : MOV ECX,ESI
00954b99 : CALL 0x00406560
00954b9e : MOV ECX,dword ptr [EBP + 0xc]
00954ba1 : PUSH ECX
00954ba2 : PUSH 0xc7599c
00954ba7 : LEA EDX,[ESP + 0x264]
00954bae : CALL 0x0040f680
00954bb3 : MOV EDX,dword ptr [0x0172491c]
00954bb9 : ADD ESP,0x8
00954bbc : PUSH EDX
00954bbd : LEA ECX,[ESP + 0x260]
00954bc4 : LEA ESI,[ESP + 0x228]
00954bcb : CALL 0x0081cbe0
00954bd0 : MOV dword ptr [ESP + 0x2b0],0x13
00954bdb : PUSH EAX
00954bdc : MOV ECX,EBX
00954bde : CALL 0x00405d70
00954be3 : MOV dword ptr [ESP + 0x2b0],EDI
00954bea : MOV ECX,ESI
00954bec : CALL 0x00406560
00954bf1 : MOV EAX,dword ptr [ESP + 0x14]
00954bf5 : CMP dword ptr [EAX + 0x6c],0x0
00954bf9 : JNZ 0x00954c17
00954bfb : MOV ECX,dword ptr [EBP + 0xc]
00954bfe : MOVZX EDX,byte ptr [EBP + 0x8]
00954c02 : MOV ESI,dword ptr [0x00da98e8]
00954c08 : PUSH ECX
00954c09 : PUSH EDX
00954c0a : PUSH 0xc759a8
00954c0f : CALL 0x008018d0
00954c14 : ADD ESP,0xc
00954c17 : MOV ESI,dword ptr [ESP + 0x14]
00954c1b : XOR EAX,EAX
00954c1d : MOV dword ptr [ESI + 0x74],EAX
00954c20 : MOV dword ptr [ESI + 0x78],EAX
00954c23 : MOV dword ptr [ESI + 0x7c],EAX
00954c26 : LEA EAX,[ESP + 0x10]
00954c2a : ADD ESI,0x90
00954c30 : PUSH EAX
00954c31 : LEA EDI,[ESP + 0x20]
00954c35 : MOV EAX,ESI
00954c37 : CALL 0x00426f10
00954c3c : MOV EDI,dword ptr [ESP + 0x14]
00954c40 : MOV EAX,dword ptr [EDI + 0x94]
00954c46 : MOV ECX,dword ptr [ESP + 0x10]
00954c4a : CMP ECX,EAX
00954c4c : JZ 0x00954c94
00954c4e : MOV EAX,dword ptr [ECX + 0x18]
00954c51 : MOV dword ptr [EDI + 0x80],EAX
00954c57 : MOV ECX,dword ptr [EAX + 0x14]
00954c5a : SUB ECX,dword ptr [EAX + 0x10]
00954c5d : TEST ECX,0xfffffffc
00954c63 : JNZ 0x00954c78
00954c65 : XOR EAX,EAX
00954c67 : PUSH EAX
00954c68 : XOR ECX,ECX
00954c6a : PUSH ECX
00954c6b : PUSH 0x1
00954c6d : PUSH EDI
00954c6e : CALL 0x009533e0
00954c73 : JMP 0x00954d3b
00954c78 : MOV EDX,dword ptr [EAX + 0x10]
00954c7b : MOV EAX,dword ptr [EDX]
00954c7d : MOV ECX,dword ptr [EAX + 0x8]
00954c80 : MOV EAX,dword ptr [EAX + 0xc]
00954c83 : PUSH EAX
00954c84 : PUSH ECX
00954c85 : PUSH 0x1
00954c87 : PUSH EDI
00954c88 : XOR ECX,ECX
00954c8a : CALL 0x009533e0
00954c8f : JMP 0x00954d3b
00954c94 : MOV EAX,[0x01725270]
00954c99 : SHR EAX,0x3
00954c9c : MOV ECX,0x0
00954ca1 : AND EAX,0x1
00954ca4 : SETZ CL
00954ca7 : PUSH ECX
00954ca8 : PUSH 0x0
00954caa : PUSH 0xbf1a4a
00954caf : PUSH 0x68
00954cb1 : CALL 0x006f0760
00954cb6 : ADD ESP,0x10
00954cb9 : MOV dword ptr [ESP + 0x10],EAX
00954cbd : MOV dword ptr [ESP + 0x2b0],0x14
00954cc8 : TEST EAX,EAX
00954cca : JZ 0x00954cda
00954ccc : MOV EDX,dword ptr [EBP + 0xc]
00954ccf : MOV CL,byte ptr [EBP + 0x8]
00954cd2 : PUSH EAX
00954cd3 : CALL 0x004278e0
00954cd8 : JMP 0x00954cdc
00954cda : XOR EAX,EAX
00954cdc : MOV dword ptr [ESP + 0x2b0],0xffffffff
00954ce7 : MOV EDX,dword ptr [ESP + 0x1c]
00954ceb : MOV dword ptr [ESP + 0x24],EDX
00954cef : LEA ECX,[EDI + 0x80]
00954cf5 : LEA EDX,[ESP + 0x24]
00954cf9 : PUSH EDX
00954cfa : MOV dword ptr [ESP + 0x14],ECX
00954cfe : MOV dword ptr [ECX],EAX
00954d00 : MOV ECX,dword ptr [ESP + 0x24]
00954d04 : PUSH ESI
00954d05 : LEA ESI,[ESP + 0x24]
00954d09 : MOV dword ptr [ESP + 0x30],ECX
00954d0d : MOV dword ptr [ESP + 0x34],EAX
00954d11 : CALL 0x00426e00
00954d16 : LEA EDX,[EDI + 0x9c]
00954d1c : MOV EDI,dword ptr [ESP + 0x10]
00954d20 : CALL 0x00449730
00954d25 : MOV EAX,dword ptr [ESP + 0x14]
00954d29 : PUSH 0x0
00954d2b : PUSH 0x0
00954d2d : PUSH 0x0
00954d2f : PUSH EAX
00954d30 : XOR ECX,ECX
00954d32 : CALL 0x009533e0
00954d37 : MOV EDI,dword ptr [ESP + 0x14]
00954d3b : MOV ESI,dword ptr [EDI + 0x80]
00954d41 : TEST ESI,ESI
00954d43 : JZ 0x00954dbd
00954d45 : PUSH 0x0
00954d47 : CALL 0x006381ab
00954d4c : ADD ESP,0x4
00954d4f : PUSH -0x1
00954d51 : MOV dword ptr [ESI + 0x20],EAX
00954d54 : MOV dword ptr [ESI + 0x24],EDX
00954d57 : MOV ECX,dword ptr [EDI + 0x80]
00954d5d : PUSH 0x0
00954d5f : PUSH EBX
00954d60 : ADD ECX,0x2c
00954d63 : CALL 0x00405eb0
00954d68 : MOV ECX,dword ptr [EDI + 0x80]
00954d6e : PUSH -0x1
00954d70 : PUSH 0x0
00954d72 : LEA ESI,[EDI + 0x3c]
00954d75 : PUSH ESI
00954d76 : ADD ECX,0x48
00954d79 : CALL 0x00405eb0
00954d7e : MOV EAX,0x8
00954d83 : CMP dword ptr [EBX + 0x18],EAX
00954d86 : JC 0x00954d8d
00954d88 : MOV EBX,dword ptr [EBX + 0x4]
00954d8b : JMP 0x00954d90
00954d8d : ADD EBX,0x4
00954d90 : CMP dword ptr [ESI + 0x18],EAX
00954d93 : JC 0x00954d9a
00954d95 : MOV ESI,dword ptr [ESI + 0x4]
00954d98 : JMP 0x00954d9d
00954d9a : ADD ESI,0x4
00954d9d : MOV ECX,dword ptr [EBP + 0xc]
00954da0 : MOVZX EDX,byte ptr [EBP + 0x8]
00954da4 : PUSH ECX
00954da5 : PUSH EDX
00954da6 : PUSH EBX
00954da7 : PUSH ESI
00954da8 : MOV ESI,dword ptr [0x00da98e8]
00954dae : PUSH 0xc75a08
00954db3 : CALL 0x008018d0
00954db8 : ADD ESP,0x14
00954dbb : JMP 0x00954dd9
00954dbd : MOV EAX,dword ptr [EBP + 0xc]
00954dc0 : MOVZX ECX,byte ptr [EBP + 0x8]
00954dc4 : MOV ESI,dword ptr [0x00da98e8]
00954dca : PUSH EAX
00954dcb : PUSH ECX
00954dcc : PUSH 0xc75a50
00954dd1 : CALL 0x008018d0
00954dd6 : ADD ESP,0xc
00954dd9 : MOV EDX,dword ptr [EDI]
00954ddb : MOV EAX,dword ptr [EDX + 0x18]
00954dde : PUSH 0x12c
00954de3 : PUSH 0x0
00954de5 : MOV ECX,EDI
00954de7 : CALL EAX
00954de9 : MOV ECX,dword ptr [ESP + 0x2a8]
00954df0 : MOV dword ptr FS:[0x0],ECX
00954df7 : POP ECX
00954df8 : POP EDI
00954df9 : POP ESI
00954dfa : POP EBX
00954dfb : MOV ECX,dword ptr [ESP + 0x290]
00954e02 : XOR ECX,ESP
00954e04 : CALL 0x00633e6b
00954e09 : MOV ESP,EBP
00954e0b : POP EBP
00954e0c : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_004d1990
ENTRY    : 004d1990
BODY     : [[004d1990, 004d19d1]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_004d1990(int param_1,undefined4 *param_2,void *param_3,void *param_4)

{
  rsize_t _DstSize;
  int iVar1;
  
  *param_2 = param_3;
  if (param_3 != param_4) {
    iVar1 = *(int *)(param_1 + 8) - (int)param_4 >> 1;
    _DstSize = iVar1 * 2;
    if (0 < iVar1) {
      _memmove_s(param_3,_DstSize,param_4,_DstSize);
    }
    *(void **)(param_1 + 8) = (void *)(_DstSize + (int)param_3);
  }
  return param_2;
}



============================================================
DISASSEMBLY
============================================================
004d1990 : PUSH EBP
004d1991 : MOV EBP,ESP
004d1993 : MOV EDX,dword ptr [EBP + 0x10]
004d1996 : MOV EAX,dword ptr [EBP + 0xc]
004d1999 : PUSH EBX
004d199a : MOV EBX,dword ptr [EBP + 0x8]
004d199d : PUSH ESI
004d199e : MOV ESI,dword ptr [EBP + 0x14]
004d19a1 : MOV dword ptr [EAX],EDX
004d19a3 : CMP EDX,ESI
004d19a5 : JZ 0x004d19cc
004d19a7 : MOV EAX,dword ptr [EBX + 0x8]
004d19aa : SUB EAX,ESI
004d19ac : SAR EAX,0x1
004d19ae : LEA ECX,[EAX + EAX*0x1]
004d19b1 : PUSH EDI
004d19b2 : LEA EDI,[ECX + EDX*0x1]
004d19b5 : TEST EAX,EAX
004d19b7 : JLE 0x004d19c5
004d19b9 : PUSH ECX
004d19ba : PUSH ESI
004d19bb : PUSH ECX
004d19bc : PUSH EDX
004d19bd : CALL 0x00634101
004d19c2 : ADD ESP,0x10
004d19c5 : MOV EAX,dword ptr [EBP + 0xc]
004d19c8 : MOV dword ptr [EBX + 0x8],EDI
004d19cb : POP EDI
004d19cc : POP ESI
004d19cd : POP EBX
004d19ce : POP EBP
004d19cf : RET 0x10

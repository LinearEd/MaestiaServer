PROGRAM  : Maestia.exe
FUNCTION : FUN_00516f40
ENTRY    : 00516f40
BODY     : [[00516f40, 00516f9d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00516f40(void)

{
  int iVar1;
  undefined4 *puVar2;
  int in_ECX;
  
  iVar1 = *(int *)(in_ECX + 0x18);
  if (iVar1 != 0) {
    FUN_00516610();
    FUN_00515cf0(iVar1);
  }
  puVar2 = *(undefined4 **)(in_ECX + 0x14);
  *(undefined ***)(in_ECX + 4) = &PTR_LAB_00b87134;
  *(undefined ***)(in_ECX + 0x10) = &PTR_LAB_00b87120;
  if (puVar2 != (undefined4 *)0x0) {
    CloseHandle((HANDLE)*puVar2);
    puVar2[3] = &PTR_FUN_00cd40d4;
    FUN_00515cf0(puVar2);
  }
  *(undefined ***)(in_ECX + 0x10) = &PTR_FUN_00cd40d4;
  FUN_00518030();
  FUN_005a2e40();
  return;
}



============================================================
DISASSEMBLY
============================================================
00516f40 : PUSH EBX
00516f41 : PUSH ESI
00516f42 : MOV EBX,ECX
00516f44 : MOV ESI,dword ptr [EBX + 0x18]
00516f47 : PUSH EDI
00516f48 : TEST ESI,ESI
00516f4a : JZ 0x00516f59
00516f4c : MOV ECX,ESI
00516f4e : CALL 0x00516610
00516f53 : PUSH ESI
00516f54 : CALL 0x00515cf0
00516f59 : MOV EDI,dword ptr [EBX + 0x14]
00516f5c : LEA ESI,[EBX + 0x4]
00516f5f : MOV dword ptr [ESI],0xb87134
00516f65 : MOV dword ptr [ESI + 0xc],0xb87120
00516f6c : TEST EDI,EDI
00516f6e : JZ 0x00516f86
00516f70 : MOV EAX,dword ptr [EDI]
00516f72 : PUSH EAX
00516f73 : CALL dword ptr [0x00b85104]
00516f79 : PUSH EDI
00516f7a : MOV dword ptr [EDI + 0xc],0xcd40d4
00516f81 : CALL 0x00515cf0
00516f86 : MOV ECX,ESI
00516f88 : MOV dword ptr [ESI + 0xc],0xcd40d4
00516f8f : CALL 0x00518030
00516f94 : POP EDI
00516f95 : POP ESI
00516f96 : MOV ECX,EBX
00516f98 : POP EBX
00516f99 : JMP 0x005a2e40

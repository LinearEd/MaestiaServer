PROGRAM  : Maestia.exe
FUNCTION : FUN_0088d6e0
ENTRY    : 0088d6e0
BODY     : [[0088d6e0, 0088d92b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0088d6e0(int param_1,undefined4 param_2,int param_3)

{
  char cVar1;
  uint uVar2;
  undefined4 ****ppppuVar3;
  int iVar4;
  LPCWSTR ***ppppWVar5;
  WCHAR *pWVar6;
  undefined4 local_45c;
  int local_458;
  int local_454;
  char local_44d;
  undefined4 ***local_448 [4];
  int local_438;
  uint local_434;
  LPCWSTR **local_42c [4];
  int local_41c;
  uint local_418;
  WCHAR local_414 [512];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  iVar4 = DAT_00d7c54c;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b2a915;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_454 = param_3;
  local_14 = uVar2;
  if (*(int *)(param_1 + 0x400) == 0) goto LAB_0088d90e;
  local_45c = *(undefined4 *)(param_1 + 8);
  FUN_004437f0(&local_45c);
  if ((local_458 == *(int *)(iVar4 + 0x44)) || (*(int *)(local_458 + 0x10) == 0)) goto LAB_0088d90e;
  local_434 = 7;
  local_438 = 0;
  local_448[0] = (undefined4 ***)((uint)local_448[0] & 0xffff0000);
  local_8 = 0;
  FUN_0081ec00(DAT_0172491c,param_2,*(undefined2 *)(*(int *)(local_458 + 0x10) + 0x136));
  local_8 = CONCAT31(local_8._1_3_,1);
  ppppuVar3 = (undefined4 ****)local_448[0];
  if (local_434 < 8) {
    ppppuVar3 = local_448;
  }
  iVar4 = FUN_00405b70(ppppuVar3,uVar2);
  if ((iVar4 != 0) || (local_438 != 0)) {
    ppppWVar5 = (LPCWSTR ***)local_42c[0];
    if (local_418 < 8) {
      ppppWVar5 = local_42c;
    }
    iVar4 = FUN_00405b70(ppppWVar5,uVar2);
    if ((iVar4 != 0) || (local_41c != 0)) {
      if (local_44d != '\0') {
        cVar1 = FUN_004049e0();
        if (cVar1 != '\0') {
          pWVar6 = local_414;
          for (iVar4 = 0x100; iVar4 != 0; iVar4 = iVar4 + -1) {
            pWVar6[0] = L'\0';
            pWVar6[1] = L'\0';
            pWVar6 = pWVar6 + 2;
          }
          if (*(uint *)(local_454 + 0x18) < 8) {
            iVar4 = local_454 + 4;
          }
          else {
            iVar4 = *(int *)(local_454 + 4);
          }
          if (local_418 < 8) {
            local_42c[0] = (LPCWSTR **)local_42c;
          }
          wsprintfW(local_414,(LPCWSTR)local_42c[0],iVar4);
          FUN_00406460(local_414);
          local_8._0_1_ = 2;
          FUN_0088b840(1);
          local_8 = CONCAT31(local_8._1_3_,1);
          FUN_00406560();
          goto LAB_0088d8ed;
        }
      }
      FUN_0088b840(1);
    }
  }
LAB_0088d8ed:
  local_8 = local_8 & 0xffffff00;
  FUN_00406560();
  local_8 = 0xffffffff;
  FUN_00406560();
LAB_0088d90e:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0088d6e0 : PUSH EBP
0088d6e1 : MOV EBP,ESP
0088d6e3 : PUSH -0x1
0088d6e5 : PUSH 0xb2a915
0088d6ea : MOV EAX,FS:[0x0]
0088d6f0 : PUSH EAX
0088d6f1 : SUB ESP,0x468
0088d6f7 : MOV EAX,[0x00d66fa0]
0088d6fc : XOR EAX,EBP
0088d6fe : MOV dword ptr [EBP + -0x10],EAX
0088d701 : PUSH EBX
0088d702 : PUSH ESI
0088d703 : PUSH EDI
0088d704 : PUSH EAX
0088d705 : LEA EAX,[EBP + -0xc]
0088d708 : MOV FS:[0x0],EAX
0088d70e : MOV EBX,dword ptr [EBP + 0x8]
0088d711 : MOV EAX,dword ptr [EBP + 0x10]
0088d714 : XOR EDI,EDI
0088d716 : MOV dword ptr [EBP + 0xfffffbb0],EAX
0088d71c : CMP dword ptr [EBX + 0x400],EDI
0088d722 : JZ 0x0088d90e
0088d728 : MOV ECX,dword ptr [EBX + 0x8]
0088d72b : MOV ESI,dword ptr [0x00d7c54c]
0088d731 : LEA EDX,[EBP + 0xfffffba8]
0088d737 : MOV dword ptr [EBP + 0xfffffba8],ECX
0088d73d : PUSH EDX
0088d73e : LEA ECX,[ESI + 0x40]
0088d741 : LEA EAX,[EBP + 0xfffffbac]
0088d747 : CALL 0x004437f0
0088d74c : MOV ESI,dword ptr [ESI + 0x44]
0088d74f : MOV EAX,dword ptr [EBP + 0xfffffbac]
0088d755 : CMP EAX,ESI
0088d757 : JZ 0x0088d90e
0088d75d : MOV EAX,dword ptr [EAX + 0x10]
0088d760 : CMP EAX,EDI
0088d762 : JZ 0x0088d90e
0088d768 : MOVZX EAX,word ptr [EAX + 0x136]
0088d76f : XOR ECX,ECX
0088d771 : MOV dword ptr [EBP + 0xfffffbd0],0x7
0088d77b : MOV dword ptr [EBP + 0xfffffbcc],EDI
0088d781 : MOV word ptr [EBP + 0xfffffbbc],CX
0088d788 : MOV dword ptr [EBP + -0x4],EDI
0088d78b : MOV EDX,dword ptr [EBP + 0xc]
0088d78e : PUSH EAX
0088d78f : MOV EAX,[0x0172491c]
0088d794 : PUSH EDX
0088d795 : PUSH EAX
0088d796 : LEA ECX,[EBP + 0xfffffbb8]
0088d79c : LEA EDX,[EBP + 0xfffffbb7]
0088d7a2 : LEA ESI,[EBP + 0xfffffbd4]
0088d7a8 : CALL 0x0081ec00
0088d7ad : MOV byte ptr [EBP + -0x4],0x1
0088d7b1 : MOV EAX,dword ptr [EBP + 0xfffffbbc]
0088d7b7 : MOV ESI,0x8
0088d7bc : CMP dword ptr [EBP + 0xfffffbd0],ESI
0088d7c2 : JNC 0x0088d7ca
0088d7c4 : LEA EAX,[EBP + 0xfffffbbc]
0088d7ca : PUSH EAX
0088d7cb : XOR EDX,EDX
0088d7cd : MOV ECX,0xc47be4
0088d7d2 : CALL 0x00405b70
0088d7d7 : ADD ESP,0x4
0088d7da : CMP EAX,EDI
0088d7dc : JNZ 0x0088d7f1
0088d7de : XOR EAX,EAX
0088d7e0 : CMP dword ptr [EBP + 0xfffffbcc],EDI
0088d7e6 : SETNZ AL
0088d7e9 : CMP EAX,EDI
0088d7eb : JZ 0x0088d8ed
0088d7f1 : MOV EAX,dword ptr [EBP + 0xfffffbd8]
0088d7f7 : CMP dword ptr [EBP + 0xfffffbec],ESI
0088d7fd : JNC 0x0088d805
0088d7ff : LEA EAX,[EBP + 0xfffffbd8]
0088d805 : PUSH EAX
0088d806 : XOR EDX,EDX
0088d808 : MOV ECX,0xc47be8
0088d80d : CALL 0x00405b70
0088d812 : ADD ESP,0x4
0088d815 : CMP EAX,EDI
0088d817 : JNZ 0x0088d82c
0088d819 : XOR EAX,EAX
0088d81b : CMP dword ptr [EBP + 0xfffffbe8],EDI
0088d821 : SETNZ AL
0088d824 : CMP EAX,EDI
0088d826 : JZ 0x0088d8ed
0088d82c : CMP byte ptr [EBP + 0xfffffbb7],0x0
0088d833 : JZ 0x0088d8de
0088d839 : MOV ECX,dword ptr [EBP + 0xfffffbb0]
0088d83f : MOV ESI,0xc47bec
0088d844 : CALL 0x004049e0
0088d849 : TEST AL,AL
0088d84b : JZ 0x0088d8de
0088d851 : XOR EAX,EAX
0088d853 : MOVZX EDX,AX
0088d856 : MOV EAX,EDX
0088d858 : SHL EDX,0x10
0088d85b : OR EAX,EDX
0088d85d : MOV ECX,0x100
0088d862 : LEA EDI,[EBP + 0xfffffbf0]
0088d868 : STOSD.REP ES:EDI
0088d86a : MOV EAX,dword ptr [EBP + 0xfffffbb0]
0088d870 : MOV ECX,0x8
0088d875 : CMP dword ptr [EAX + 0x18],ECX
0088d878 : JC 0x0088d87f
0088d87a : MOV EAX,dword ptr [EAX + 0x4]
0088d87d : JMP 0x0088d882
0088d87f : ADD EAX,0x4
0088d882 : CMP dword ptr [EBP + 0xfffffbec],ECX
0088d888 : MOV ECX,dword ptr [EBP + 0xfffffbd8]
0088d88e : JNC 0x0088d896
0088d890 : LEA ECX,[EBP + 0xfffffbd8]
0088d896 : PUSH EAX
0088d897 : PUSH ECX
0088d898 : LEA EAX,[EBP + 0xfffffbf0]
0088d89e : PUSH EAX
0088d89f : CALL dword ptr [0x00b85434]
0088d8a5 : ADD ESP,0xc
0088d8a8 : LEA ECX,[EBP + 0xfffffbf0]
0088d8ae : PUSH ECX
0088d8af : LEA ECX,[EBP + 0xfffffb8c]
0088d8b5 : CALL 0x00406460
0088d8ba : MOV byte ptr [EBP + -0x4],0x2
0088d8be : PUSH 0x1
0088d8c0 : LEA EAX,[EBP + 0xfffffb8c]
0088d8c6 : MOV ECX,EBX
0088d8c8 : CALL 0x0088b840
0088d8cd : MOV byte ptr [EBP + -0x4],0x1
0088d8d1 : LEA ECX,[EBP + 0xfffffb8c]
0088d8d7 : CALL 0x00406560
0088d8dc : JMP 0x0088d8ed
0088d8de : PUSH 0x1
0088d8e0 : LEA EAX,[EBP + 0xfffffbd4]
0088d8e6 : MOV ECX,EBX
0088d8e8 : CALL 0x0088b840
0088d8ed : MOV byte ptr [EBP + -0x4],0x0
0088d8f1 : LEA ECX,[EBP + 0xfffffbd4]
0088d8f7 : CALL 0x00406560
0088d8fc : MOV dword ptr [EBP + -0x4],0xffffffff
0088d903 : LEA ECX,[EBP + 0xfffffbb8]
0088d909 : CALL 0x00406560
0088d90e : MOV ECX,dword ptr [EBP + -0xc]
0088d911 : MOV dword ptr FS:[0x0],ECX
0088d918 : POP ECX
0088d919 : POP EDI
0088d91a : POP ESI
0088d91b : POP EBX
0088d91c : MOV ECX,dword ptr [EBP + -0x10]
0088d91f : XOR ECX,EBP
0088d921 : CALL 0x00633e6b
0088d926 : MOV ESP,EBP
0088d928 : POP EBP
0088d929 : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_005272e0
ENTRY    : 005272e0
BODY     : [[005272e0, 00527670]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005272e0(int *param_1,int param_2,int param_3,char param_4)

{
  int *piVar1;
  ushort uVar2;
  char cVar3;
  undefined4 uVar4;
  int *piVar5;
  int iVar6;
  char *in_ECX;
  int *piStack_78;
  int iStack_74;
  byte bStack_70;
  int iStack_6c;
  int *local_68;
  byte abStack_64 [16];
  byte local_54 [16];
  undefined1 local_44 [64];
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)&piStack_78;
  iVar6 = *(int *)(*(int *)(param_2 + 0x78) + 8);
  piVar5 = (int *)(param_2 + 0x78);
  *param_1 = iVar6;
  piVar1 = (int *)(iVar6 + 8);
  *piVar1 = *piVar1 + 1;
  switch(*in_ECX) {
  case '\0':
    iVar6 = *(int *)(*piVar5 + 0xcc);
    break;
  case '\x01':
    iVar6 = *(int *)(*piVar5 + 0xd0);
    break;
  case '\x02':
    iVar6 = *(int *)(*piVar5 + 8 + ((in_ECX[4] == '\0') + 0x33) * 4);
    break;
  case '\x03':
    if (param_3 < 0) {
      param_3 = 10;
    }
    else {
      param_3 = -param_3;
    }
    uVar4 = FUN_005b0e40(*(undefined8 *)(in_ECX + 4),local_44,0x40,param_3);
    goto LAB_0052736d;
  case '\x04':
    uVar4 = FUN_005b0ce0(*(undefined4 *)(in_ECX + 4),local_44,0x40);
LAB_0052736d:
    iVar6 = FUN_00525530(uVar4);
    goto LAB_0052737b;
  case '\x05':
    iVar6 = *(int *)(in_ECX + 4);
    piVar5 = (int *)(iVar6 + 8);
    *piVar5 = *piVar5 + 1;
    piVar5 = (int *)(*param_1 + 8);
    *piVar5 = *piVar5 + -1;
    if (*piVar5 == 0) {
      FUN_00525340();
    }
    *param_1 = iVar6;
    goto LAB_00527657;
  case '\x06':
  case '\a':
    local_54[0] = 0;
    local_68 = (int *)FUN_005270f0(param_2);
    if (((param_4 == '\0') && (local_68 != (int *)0x0)) &&
       (cVar3 = (**(code **)(*local_68 + 0x2c))(piVar5,*piVar5 + 0x154,local_54), cVar3 != '\0')) {
      uVar2 = *(ushort *)(param_2 + 0xc4);
      *(ushort *)(param_2 + 0xc4) = uVar2 + 1;
      if (uVar2 < 0xff) {
        abStack_64[0] = 0;
        FUN_00527140(&piStack_78,param_2);
        if (piStack_78 != (int *)0x0) {
          FUN_0051fae0(abStack_64,local_68,param_2,0,0);
          (**(code **)(*piStack_78 + 0x28))(local_44,iStack_74,0);
          FUN_0051fbd0();
        }
        FUN_005272e0();
        iVar6 = iStack_6c;
        *(int *)(iStack_6c + 8) = *(int *)(iStack_6c + 8) + 1;
        piVar5 = (int *)(*param_1 + 8);
        *piVar5 = *piVar5 + -1;
        if (*piVar5 == 0) {
          FUN_00525340();
        }
        *param_1 = iVar6;
        *(int *)(iStack_6c + 8) = *(int *)(iStack_6c + 8) + -1;
        if (*(int *)(iStack_6c + 8) == 0) {
          FUN_00525340();
        }
        if (((bStack_70 & 2) == 0) && (piStack_78 != (int *)0x0)) {
          FUN_00503db0();
        }
        piStack_78 = (int *)0x0;
        if (((bStack_70 & 1) == 0) && (iStack_74 != 0)) {
          FUN_00503db0();
        }
        iStack_74 = 0;
        if (4 < abStack_64[0]) {
          FUN_00526400();
          *(short *)(param_2 + 0xc4) = *(short *)(param_2 + 0xc4) + -1;
          goto LAB_005275eb;
        }
      }
      else {
        iVar6 = *(int *)(*piVar5 + 0x14c);
        piVar5 = (int *)(iVar6 + 8);
        *piVar5 = *piVar5 + 1;
        piVar5 = (int *)(*param_1 + 8);
        *piVar5 = *piVar5 + -1;
        if (*piVar5 == 0) {
          FUN_00525340();
        }
        *param_1 = iVar6;
      }
      *(short *)(param_2 + 0xc4) = *(short *)(param_2 + 0xc4) + -1;
    }
    else if (((*in_ECX == '\x06') && (*(int *)(in_ECX + 4) != 0)) &&
            (iVar6 = (**(code **)(*(int *)(*(int *)(in_ECX + 4) + 0x10) + 4))(param_2), iVar6 != 0))
    {
      iVar6 = FUN_00525530(iVar6);
      *(int *)(iVar6 + 8) = *(int *)(iVar6 + 8) + 2;
      piVar5 = (int *)(*param_1 + 8);
      *piVar5 = *piVar5 + -1;
      if (*piVar5 == 0) {
        FUN_00525340();
      }
      *param_1 = iVar6;
      piVar5 = (int *)(iVar6 + 8);
      *piVar5 = *piVar5 + -1;
      if (*piVar5 == 0) {
        FUN_00525340();
      }
    }
    else {
      if ((*in_ECX == '\a') && (*(int *)(in_ECX + 4) != 0)) {
        piVar5 = (int *)FUN_00525fd0(param_2);
        iVar6 = *piVar5;
      }
      else {
        iVar6 = *(int *)(*piVar5 + 0x150);
      }
      *(int *)(iVar6 + 8) = *(int *)(iVar6 + 8) + 1;
      piVar5 = (int *)(*param_1 + 8);
      *piVar5 = *piVar5 + -1;
      if (*piVar5 == 0) {
        FUN_00525340();
      }
      *param_1 = iVar6;
    }
LAB_005275eb:
    if (4 < local_54[0]) {
      FUN_00526400();
    }
    goto LAB_00527657;
  case '\b':
  case '\v':
    iVar6 = *(int *)(*piVar5 + 0x148);
    break;
  case '\t':
    iVar6 = FUN_00525380("[property]",10,0);
    goto LAB_0052737b;
  default:
    iVar6 = *(int *)(*piVar5 + 0xbc);
    break;
  case '\f':
    iVar6 = FUN_00525380("[resolveHandler]",0x10,0);
LAB_0052737b:
    *(int *)(iVar6 + 8) = *(int *)(iVar6 + 8) + 2;
    piVar5 = (int *)(*param_1 + 8);
    *piVar5 = *piVar5 + -1;
    if (*piVar5 == 0) {
      FUN_00525340();
    }
    *param_1 = iVar6;
    piVar5 = (int *)(iVar6 + 8);
    *piVar5 = *piVar5 + -1;
    if (*piVar5 == 0) {
      FUN_00525340();
    }
    goto LAB_00527657;
  }
  *(int *)(iVar6 + 8) = *(int *)(iVar6 + 8) + 1;
  piVar5 = (int *)(*param_1 + 8);
  *piVar5 = *piVar5 + -1;
  if (*piVar5 == 0) {
    FUN_00525340();
  }
  *param_1 = iVar6;
LAB_00527657:
  __security_check_cookie(local_4 ^ (uint)&piStack_78);
  return;
}



============================================================
DISASSEMBLY
============================================================
005272e0 : SUB ESP,0x78
005272e3 : MOV EAX,[0x00d66fa0]
005272e8 : XOR EAX,ESP
005272ea : MOV dword ptr [ESP + 0x74],EAX
005272ee : PUSH EBX
005272ef : MOV EBX,dword ptr [ESP + 0x84]
005272f6 : MOV EAX,dword ptr [EBX + 0x78]
005272f9 : MOV EAX,dword ptr [EAX + 0x8]
005272fc : PUSH EBP
005272fd : PUSH ESI
005272fe : MOV ESI,dword ptr [ESP + 0x88]
00527305 : PUSH EDI
00527306 : LEA EDI,[EBX + 0x78]
00527309 : MOV EBP,ECX
0052730b : MOV dword ptr [ESI],EAX
0052730d : MOV ECX,0x1
00527312 : ADD dword ptr [EAX + 0x8],ECX
00527315 : MOVZX EAX,byte ptr [EBP]
00527319 : CMP EAX,0xc
0052731c : JA 0x0052763d
00527322 : JMP dword ptr [EAX*0x4 + 0x527674]
00527329 : MOV EBP,dword ptr [EBP + 0x4]
0052732c : ADD dword ptr [EBP + 0x8],ECX
0052732f : MOV ECX,dword ptr [ESI]
00527331 : ADD dword ptr [ECX + 0x8],-0x1
00527335 : JNZ 0x0052733c
00527337 : CALL 0x00525340
0052733c : MOV dword ptr [ESI],EBP
0052733e : JMP 0x00527657
00527343 : MOV EAX,dword ptr [ESP + 0x94]
0052734a : TEST EAX,EAX
0052734c : JGE 0x00527355
0052734e : MOV EAX,0xa
00527353 : JMP 0x00527357
00527355 : NEG EAX
00527357 : FLD double ptr [EBP + 0x4]
0052735a : PUSH EAX
0052735b : PUSH 0x40
0052735d : LEA EAX,[ESP + 0x4c]
00527361 : PUSH EAX
00527362 : SUB ESP,0x8
00527365 : FSTP double ptr [ESP]
00527368 : CALL 0x005b0e40
0052736d : MOV EDI,dword ptr [EDI]
0052736f : PUSH EAX
00527370 : LEA ECX,[EDI + 0x254]
00527376 : CALL 0x00525530
0052737b : MOV EDI,EAX
0052737d : ADD dword ptr [EDI + 0x8],0x2
00527381 : MOV ECX,dword ptr [ESI]
00527383 : OR EBP,0xffffffff
00527386 : ADD dword ptr [ECX + 0x8],EBP
00527389 : JNZ 0x00527390
0052738b : CALL 0x00525340
00527390 : MOV dword ptr [ESI],EDI
00527392 : ADD dword ptr [EDI + 0x8],EBP
00527395 : JNZ 0x00527657
0052739b : MOV ECX,EDI
0052739d : CALL 0x00525340
005273a2 : JMP 0x00527657
005273a7 : MOV EDX,dword ptr [EBP + 0x4]
005273aa : PUSH 0x40
005273ac : LEA ECX,[ESP + 0x48]
005273b0 : PUSH ECX
005273b1 : PUSH EDX
005273b2 : CALL 0x005b0ce0
005273b7 : JMP 0x0052736d
005273b9 : MOV EDI,dword ptr [EDI]
005273bb : MOV EDI,dword ptr [EDI + 0xcc]
005273c1 : JMP 0x00527645
005273c6 : MOV EDI,dword ptr [EDI]
005273c8 : MOV EDI,dword ptr [EDI + 0xd0]
005273ce : JMP 0x00527645
005273d3 : MOV EDI,dword ptr [EDI]
005273d5 : XOR EAX,EAX
005273d7 : CMP byte ptr [EBP + 0x4],AL
005273da : SETZ AL
005273dd : ADD EAX,0x33
005273e0 : LEA EAX,[EDI + EAX*0x4 + 0x8]
005273e4 : MOV EDI,dword ptr [EAX]
005273e6 : JMP 0x00527645
005273eb : PUSH EBX
005273ec : MOV ECX,EBP
005273ee : MOV byte ptr [ESP + 0x38],0x0
005273f3 : CALL 0x005270f0
005273f8 : CMP byte ptr [ESP + 0x98],0x0
00527400 : MOV dword ptr [ESP + 0x20],EAX
00527404 : JNZ 0x00527568
0052740a : TEST EAX,EAX
0052740c : JZ 0x00527568
00527412 : MOV EDX,dword ptr [EAX]
00527414 : MOV EDX,dword ptr [EDX + 0x2c]
00527417 : LEA ECX,[ESP + 0x34]
0052741b : PUSH ECX
0052741c : MOV ECX,dword ptr [EDI]
0052741e : ADD ECX,0x154
00527424 : PUSH ECX
00527425 : PUSH EDI
00527426 : MOV ECX,EAX
00527428 : CALL EDX
0052742a : TEST AL,AL
0052742c : JZ 0x00527568
00527432 : MOVZX EAX,word ptr [EBX + 0xc4]
00527439 : MOV ECX,0xff
0052743e : LEA EDX,[EAX + 0x1]
00527441 : MOV word ptr [EBX + 0xc4],DX
00527448 : CMP AX,CX
0052744b : JNC 0x0052753d
00527451 : PUSH EBX
00527452 : LEA EAX,[ESP + 0x14]
00527456 : PUSH EAX
00527457 : LEA ECX,[ESP + 0x3c]
0052745b : MOV byte ptr [ESP + 0x2c],0x0
00527460 : CALL 0x00527140
00527465 : CMP dword ptr [ESP + 0x10],0x0
0052746a : SETNZ AL
0052746d : TEST AL,AL
0052746f : JZ 0x005274a9
00527471 : MOV ECX,dword ptr [ESP + 0x20]
00527475 : PUSH 0x0
00527477 : PUSH 0x0
00527479 : PUSH EBX
0052747a : PUSH ECX
0052747b : LEA EDX,[ESP + 0x34]
0052747f : PUSH EDX
00527480 : LEA ECX,[ESP + 0x58]
00527484 : CALL 0x0051fae0
00527489 : MOV EDX,dword ptr [ESP + 0x14]
0052748d : MOV ECX,dword ptr [ESP + 0x10]
00527491 : MOV EAX,dword ptr [ECX]
00527493 : MOV EAX,dword ptr [EAX + 0x28]
00527496 : PUSH 0x0
00527498 : PUSH EDX
00527499 : LEA EDX,[ESP + 0x4c]
0052749d : PUSH EDX
0052749e : CALL EAX
005274a0 : LEA ECX,[ESP + 0x44]
005274a4 : CALL 0x0051fbd0
005274a9 : PUSH 0x0
005274ab : OR EBP,0xffffffff
005274ae : PUSH EBP
005274af : PUSH EBX
005274b0 : LEA ECX,[ESP + 0x28]
005274b4 : PUSH ECX
005274b5 : LEA ECX,[ESP + 0x34]
005274b9 : CALL 0x005272e0
005274be : MOV EAX,dword ptr [ESP + 0x1c]
005274c2 : INC dword ptr [EAX + 0x8]
005274c5 : MOV ECX,dword ptr [ESI]
005274c7 : ADD dword ptr [ECX + 0x8],EBP
005274ca : MOV EDI,EAX
005274cc : JNZ 0x005274d3
005274ce : CALL 0x00525340
005274d3 : MOV EAX,dword ptr [ESP + 0x1c]
005274d7 : MOV dword ptr [ESI],EDI
005274d9 : ADD dword ptr [EAX + 0x8],EBP
005274dc : MOV ECX,EAX
005274de : ADD EAX,0x8
005274e1 : XOR EDI,EDI
005274e3 : CMP dword ptr [EAX],EDI
005274e5 : JNZ 0x005274ec
005274e7 : CALL 0x00525340
005274ec : TEST byte ptr [ESP + 0x18],0x2
005274f1 : JNZ 0x00527500
005274f3 : MOV ECX,dword ptr [ESP + 0x10]
005274f7 : CMP ECX,EDI
005274f9 : JZ 0x00527500
005274fb : CALL 0x00503db0
00527500 : TEST byte ptr [ESP + 0x18],0x1
00527505 : MOV dword ptr [ESP + 0x10],EDI
00527509 : JNZ 0x00527518
0052750b : MOV ECX,dword ptr [ESP + 0x14]
0052750f : CMP ECX,EDI
00527511 : JZ 0x00527518
00527513 : CALL 0x00503db0
00527518 : CMP byte ptr [ESP + 0x24],0x5
0052751d : MOV dword ptr [ESP + 0x14],EDI
00527521 : JC 0x00527557
00527523 : LEA ECX,[ESP + 0x24]
00527527 : CALL 0x00526400
0052752c : MOV EDX,0xffff
00527531 : ADD word ptr [EBX + 0xc4],DX
00527538 : JMP 0x005275eb
0052753d : MOV EDI,dword ptr [EDI]
0052753f : MOV EDI,dword ptr [EDI + 0x14c]
00527545 : INC dword ptr [EDI + 0x8]
00527548 : MOV ECX,dword ptr [ESI]
0052754a : ADD dword ptr [ECX + 0x8],-0x1
0052754e : JNZ 0x00527555
00527550 : CALL 0x00525340
00527555 : MOV dword ptr [ESI],EDI
00527557 : MOV EDX,0xffff
0052755c : ADD word ptr [EBX + 0xc4],DX
00527563 : JMP 0x005275eb
00527568 : CMP byte ptr [EBP],0x6
0052756c : JNZ 0x005275b9
0052756e : CMP dword ptr [EBP + 0x4],0x0
00527572 : JZ 0x005275b9
00527574 : MOV EAX,dword ptr [EBP + 0x4]
00527577 : LEA ECX,[EAX + 0x10]
0052757a : MOV EAX,dword ptr [ECX]
0052757c : MOV EDX,dword ptr [EAX + 0x4]
0052757f : PUSH EBX
00527580 : CALL EDX
00527582 : TEST EAX,EAX
00527584 : JZ 0x005275b9
00527586 : MOV EDI,dword ptr [EDI]
00527588 : PUSH EAX
00527589 : LEA ECX,[EDI + 0x254]
0052758f : CALL 0x00525530
00527594 : MOV EDI,EAX
00527596 : ADD dword ptr [EDI + 0x8],0x2
0052759a : MOV ECX,dword ptr [ESI]
0052759c : OR EBP,0xffffffff
0052759f : ADD dword ptr [ECX + 0x8],EBP
005275a2 : JNZ 0x005275a9
005275a4 : CALL 0x00525340
005275a9 : MOV dword ptr [ESI],EDI
005275ab : ADD dword ptr [EDI + 0x8],EBP
005275ae : JNZ 0x005275eb
005275b0 : MOV ECX,EDI
005275b2 : CALL 0x00525340
005275b7 : JMP 0x005275eb
005275b9 : CMP byte ptr [EBP],0x7
005275bd : JNZ 0x005275d1
005275bf : CMP dword ptr [EBP + 0x4],0x0
005275c3 : JZ 0x005275d1
005275c5 : PUSH EBX
005275c6 : MOV ECX,EBP
005275c8 : CALL 0x00525fd0
005275cd : MOV EDI,dword ptr [EAX]
005275cf : JMP 0x005275d9
005275d1 : MOV EDI,dword ptr [EDI]
005275d3 : MOV EDI,dword ptr [EDI + 0x150]
005275d9 : INC dword ptr [EDI + 0x8]
005275dc : MOV ECX,dword ptr [ESI]
005275de : ADD dword ptr [ECX + 0x8],-0x1
005275e2 : JNZ 0x005275e9
005275e4 : CALL 0x00525340
005275e9 : MOV dword ptr [ESI],EDI
005275eb : CMP byte ptr [ESP + 0x34],0x5
005275f0 : JC 0x00527657
005275f2 : LEA ECX,[ESP + 0x34]
005275f6 : CALL 0x00526400
005275fb : JMP 0x00527657
005275fd : MOV EDI,dword ptr [EDI]
005275ff : MOV EDI,dword ptr [EDI + 0x148]
00527605 : JMP 0x00527645
00527607 : MOV EDI,dword ptr [EDI]
00527609 : PUSH 0x0
0052760b : PUSH 0xa
0052760d : PUSH 0xb8af38
00527612 : LEA ECX,[EDI + 0x254]
00527618 : CALL 0x00525380
0052761d : JMP 0x0052737b
00527622 : MOV EDI,dword ptr [EDI]
00527624 : PUSH 0x0
00527626 : PUSH 0x10
00527628 : PUSH 0xb8af24
0052762d : LEA ECX,[EDI + 0x254]
00527633 : CALL 0x00525380
00527638 : JMP 0x0052737b
0052763d : MOV EDI,dword ptr [EDI]
0052763f : MOV EDI,dword ptr [EDI + 0xbc]
00527645 : ADD dword ptr [EDI + 0x8],ECX
00527648 : MOV ECX,dword ptr [ESI]
0052764a : ADD dword ptr [ECX + 0x8],-0x1
0052764e : JNZ 0x00527655
00527650 : CALL 0x00525340
00527655 : MOV dword ptr [ESI],EDI
00527657 : MOV ECX,dword ptr [ESP + 0x84]
0052765e : POP EDI
0052765f : MOV EAX,ESI
00527661 : POP ESI
00527662 : POP EBP
00527663 : POP EBX
00527664 : XOR ECX,ESP
00527666 : CALL 0x00633e6b
0052766b : ADD ESP,0x78
0052766e : RET 0x10

PROGRAM  : Maestia.exe
FUNCTION : FUN_00563c60
ENTRY    : 00563c60
BODY     : [[00563c60, 00563cd2]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00563c60(void)

{
  undefined4 *puVar1;
  LONG LVar2;
  int *in_ECX;
  int iVar3;
  uint uVar4;
  int local_8;
  
  if (*in_ECX != 0) {
    iVar3 = 0;
    local_8 = *(int *)(*in_ECX + 4) + 1;
    do {
      puVar1 = (undefined4 *)(iVar3 + 8 + *in_ECX);
      if (*(int *)(iVar3 + 8 + *in_ECX) != -2) {
        uVar4 = puVar1[2] & 0xfffffffc;
        LVar2 = InterlockedExchangeAdd((LONG *)(uVar4 + 4),-1);
        if (LVar2 == 1) {
          FUN_00515cf0(uVar4);
        }
        *puVar1 = 0xfffffffe;
      }
      iVar3 = iVar3 + 0x10;
      local_8 = local_8 + -1;
    } while (local_8 != 0);
    FUN_00515cf0(*in_ECX);
    *in_ECX = 0;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00563c60 : SUB ESP,0x8
00563c63 : PUSH ESI
00563c64 : MOV ESI,ECX
00563c66 : MOV EAX,dword ptr [ESI]
00563c68 : MOV dword ptr [ESP + 0x8],ESI
00563c6c : TEST EAX,EAX
00563c6e : JZ 0x00563cce
00563c70 : MOV EAX,dword ptr [EAX + 0x4]
00563c73 : PUSH EBX
00563c74 : PUSH EBP
00563c75 : MOV EBP,dword ptr [0x00b851cc]
00563c7b : XOR EBX,EBX
00563c7d : INC EAX
00563c7e : PUSH EDI
00563c7f : MOV dword ptr [ESP + 0x10],EAX
00563c83 : MOV EAX,dword ptr [ESI]
00563c85 : CMP dword ptr [EBX + EAX*0x1 + 0x8],-0x2
00563c8a : LEA EDI,[EBX + EAX*0x1 + 0x8]
00563c8e : JZ 0x00563cb3
00563c90 : MOV ESI,dword ptr [EDI + 0x8]
00563c93 : AND ESI,0xfffffffc
00563c96 : PUSH -0x1
00563c98 : LEA ECX,[ESI + 0x4]
00563c9b : PUSH ECX
00563c9c : CALL EBP
00563c9e : SUB EAX,0x1
00563ca1 : JNZ 0x00563ca9
00563ca3 : PUSH ESI
00563ca4 : CALL 0x00515cf0
00563ca9 : MOV ESI,dword ptr [ESP + 0x14]
00563cad : MOV dword ptr [EDI],0xfffffffe
00563cb3 : ADD EBX,0x10
00563cb6 : SUB dword ptr [ESP + 0x10],0x1
00563cbb : JNZ 0x00563c83
00563cbd : MOV EDX,dword ptr [ESI]
00563cbf : PUSH EDX
00563cc0 : CALL 0x00515cf0
00563cc5 : POP EDI
00563cc6 : POP EBP
00563cc7 : MOV dword ptr [ESI],0x0
00563ccd : POP EBX
00563cce : POP ESI
00563ccf : ADD ESP,0x8
00563cd2 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00880fc0
ENTRY    : 00880fc0
BODY     : [[00880fc0, 00881196]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00880fc0(int param_1,int param_2)

{
  int iVar1;
  char cVar2;
  uint uVar3;
  int *piVar4;
  int iVar5;
  int in_ECX;
  LPCRITICAL_SECTION local_28;
  char *local_24;
  undefined4 local_20;
  int local_1c;
  undefined4 local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b5f63f;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_1c = 0;
  local_24 = ".\\Objects\\AvaCharStatus.cpp";
  local_20 = 0x242;
  local_18 = 1;
  local_28 = (LPCRITICAL_SECTION)(in_ECX + 0x38);
  FUN_006ef1a0(&local_28);
  piVar4 = *(int **)(in_ECX + 4);
  if (piVar4 != *(int **)(in_ECX + 8)) {
    do {
      iVar5 = *piVar4;
      if ((*(int *)(iVar5 + 4) == param_1) && (*(int *)(iVar5 + 8) == param_2)) {
        local_8 = 0xffffffff;
        if (local_1c != 0) {
          LeaveCriticalSection(local_28);
        }
        ExceptionList = local_10;
        return iVar5;
      }
      piVar4 = piVar4 + 1;
    } while (piVar4 != *(int **)(in_ECX + 8));
  }
  iVar5 = 0;
  local_8 = 0xffffffff;
  if (local_1c != 0) {
    LeaveCriticalSection(local_28);
    local_1c = 0;
  }
  local_14 = FUN_006f0760(100,".\\Objects\\AvaCharStatus.cpp",0x24c,0,uVar3);
  local_8 = 1;
  if (local_14 != 0) {
    iVar5 = FUN_00880b60(local_14);
  }
  local_8 = 0xffffffff;
  local_14 = iVar5;
  cVar2 = FUN_00880cd0(*(undefined4 *)(in_ECX + 0x2c));
  if (cVar2 == '\0') {
    if (iVar5 == 0) {
      ExceptionList = local_10;
      return 0;
    }
    FUN_00880880(iVar5);
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  *(int *)(iVar5 + 4) = param_1;
  local_1c = 0;
  local_24 = ".\\Objects\\AvaCharStatus.cpp";
  local_20 = 0x251;
  local_18 = 1;
  local_28 = (LPCRITICAL_SECTION)(in_ECX + 0x38);
  FUN_006ef1a0(&local_28);
  local_8 = 2;
  iVar1 = *(int *)(in_ECX + 4);
  if (iVar1 == 0) {
    uVar3 = 0;
  }
  else {
    uVar3 = *(int *)(in_ECX + 0xc) - iVar1 >> 2;
  }
  piVar4 = *(int **)(in_ECX + 8);
  if ((uint)((int)piVar4 - iVar1 >> 2) < uVar3) {
    *piVar4 = iVar5;
    *(int **)(in_ECX + 8) = piVar4 + 1;
  }
  else {
    FUN_0042fe80(in_ECX,piVar4,&local_14);
  }
  local_8 = 0xffffffff;
  if (local_1c != 0) {
    LeaveCriticalSection(local_28);
  }
  ExceptionList = local_10;
  return iVar5;
}



============================================================
DISASSEMBLY
============================================================
00880fc0 : PUSH EBP
00880fc1 : MOV EBP,ESP
00880fc3 : PUSH -0x1
00880fc5 : PUSH 0xb5f63f
00880fca : MOV EAX,FS:[0x0]
00880fd0 : PUSH EAX
00880fd1 : SUB ESP,0x1c
00880fd4 : PUSH EBX
00880fd5 : PUSH ESI
00880fd6 : PUSH EDI
00880fd7 : MOV EAX,[0x00d66fa0]
00880fdc : XOR EAX,EBP
00880fde : PUSH EAX
00880fdf : LEA EAX,[EBP + -0xc]
00880fe2 : MOV FS:[0x0],EAX
00880fe8 : MOV ESI,ECX
00880fea : LEA EAX,[EBP + -0x24]
00880fed : XOR EDI,EDI
00880fef : LEA EBX,[ESI + 0x38]
00880ff2 : PUSH EAX
00880ff3 : MOV dword ptr [EBP + -0x18],EDI
00880ff6 : MOV dword ptr [EBP + -0x24],EBX
00880ff9 : MOV dword ptr [EBP + -0x20],0xc44954
00881000 : MOV dword ptr [EBP + -0x1c],0x242
00881007 : MOV dword ptr [EBP + -0x14],0x1
0088100e : CALL 0x006ef1a0
00881013 : MOV dword ptr [EBP + -0x4],EDI
00881016 : MOV EAX,dword ptr [ESI + 0x4]
00881019 : CMP EAX,dword ptr [ESI + 0x8]
0088101c : JZ 0x0088103e
0088101e : MOV EDI,EDI
00881020 : MOV ECX,dword ptr [EAX]
00881022 : MOV EDX,dword ptr [EBP + 0x8]
00881025 : CMP dword ptr [ECX + 0x4],EDX
00881028 : JNZ 0x00881036
0088102a : MOV EDX,dword ptr [EBP + 0xc]
0088102d : CMP dword ptr [ECX + 0x8],EDX
00881030 : JZ 0x008810e0
00881036 : ADD EAX,0x4
00881039 : CMP EAX,dword ptr [ESI + 0x8]
0088103c : JNZ 0x00881020
0088103e : MOV dword ptr [EBP + -0x4],0xffffffff
00881045 : CMP dword ptr [EBP + -0x18],EDI
00881048 : JZ 0x00881057
0088104a : MOV ECX,dword ptr [EBP + -0x24]
0088104d : PUSH ECX
0088104e : CALL dword ptr [0x00b8511c]
00881054 : MOV dword ptr [EBP + -0x18],EDI
00881057 : PUSH EDI
00881058 : PUSH 0x24c
0088105d : PUSH 0xc44970
00881062 : PUSH 0x64
00881064 : CALL 0x006f0760
00881069 : ADD ESP,0x10
0088106c : MOV dword ptr [EBP + -0x10],EAX
0088106f : MOV dword ptr [EBP + -0x4],0x1
00881076 : CMP EAX,EDI
00881078 : JZ 0x00881082
0088107a : PUSH EAX
0088107b : CALL 0x00880b60
00881080 : MOV EDI,EAX
00881082 : MOV dword ptr [EBP + -0x4],0xffffffff
00881089 : MOV EDX,dword ptr [ESI + 0x2c]
0088108c : MOV ECX,dword ptr [EBP + 0xc]
0088108f : PUSH EDX
00881090 : MOV dword ptr [EBP + -0x10],EDI
00881093 : CALL 0x00880cd0
00881098 : TEST AL,AL
0088109a : JZ 0x00881170
008810a0 : MOV EAX,dword ptr [EBP + 0x8]
008810a3 : LEA ECX,[EBP + -0x24]
008810a6 : PUSH ECX
008810a7 : MOV dword ptr [EDI + 0x4],EAX
008810aa : MOV dword ptr [EBP + -0x18],0x0
008810b1 : MOV dword ptr [EBP + -0x24],EBX
008810b4 : MOV dword ptr [EBP + -0x20],0xc449a8
008810bb : MOV dword ptr [EBP + -0x1c],0x251
008810c2 : MOV dword ptr [EBP + -0x14],0x1
008810c9 : CALL 0x006ef1a0
008810ce : MOV dword ptr [EBP + -0x4],0x2
008810d5 : MOV EAX,dword ptr [ESI + 0x4]
008810d8 : TEST EAX,EAX
008810da : JNZ 0x00881111
008810dc : XOR ECX,ECX
008810de : JMP 0x00881119
008810e0 : MOV ESI,ECX
008810e2 : MOV dword ptr [EBP + -0x4],0xffffffff
008810e9 : CMP dword ptr [EBP + -0x18],EDI
008810ec : JZ 0x008810fb
008810ee : MOV EAX,dword ptr [EBP + -0x24]
008810f1 : PUSH EAX
008810f2 : CALL dword ptr [0x00b8511c]
008810f8 : MOV dword ptr [EBP + -0x18],EDI
008810fb : MOV EAX,ESI
008810fd : MOV ECX,dword ptr [EBP + -0xc]
00881100 : MOV dword ptr FS:[0x0],ECX
00881107 : POP ECX
00881108 : POP EDI
00881109 : POP ESI
0088110a : POP EBX
0088110b : MOV ESP,EBP
0088110d : POP EBP
0088110e : RET 0x8
00881111 : MOV ECX,dword ptr [ESI + 0xc]
00881114 : SUB ECX,EAX
00881116 : SAR ECX,0x2
00881119 : MOV EDX,dword ptr [ESI + 0x8]
0088111c : MOV EBX,EDX
0088111e : SUB EBX,EAX
00881120 : SAR EBX,0x2
00881123 : CMP EBX,ECX
00881125 : JNC 0x00881131
00881127 : MOV dword ptr [EDX],EDI
00881129 : ADD EDX,0x4
0088112c : MOV dword ptr [ESI + 0x8],EDX
0088112f : JMP 0x0088113c
00881131 : LEA EAX,[EBP + -0x10]
00881134 : PUSH EAX
00881135 : PUSH EDX
00881136 : PUSH ESI
00881137 : CALL 0x0042fe80
0088113c : MOV dword ptr [EBP + -0x4],0xffffffff
00881143 : CMP dword ptr [EBP + -0x18],0x0
00881147 : JZ 0x0088115a
00881149 : MOV ECX,dword ptr [EBP + -0x24]
0088114c : PUSH ECX
0088114d : CALL dword ptr [0x00b8511c]
00881153 : MOV dword ptr [EBP + -0x18],0x0
0088115a : MOV EAX,EDI
0088115c : MOV ECX,dword ptr [EBP + -0xc]
0088115f : MOV dword ptr FS:[0x0],ECX
00881166 : POP ECX
00881167 : POP EDI
00881168 : POP ESI
00881169 : POP EBX
0088116a : MOV ESP,EBP
0088116c : POP EBP
0088116d : RET 0x8
00881170 : TEST EDI,EDI
00881172 : JZ 0x00881181
00881174 : PUSH EDI
00881175 : CALL 0x00880880
0088117a : MOV ECX,EDI
0088117c : CALL 0x006f04e0
00881181 : XOR EAX,EAX
00881183 : MOV ECX,dword ptr [EBP + -0xc]
00881186 : MOV dword ptr FS:[0x0],ECX
0088118d : POP ECX
0088118e : POP EDI
0088118f : POP ESI
00881190 : POP EBX
00881191 : MOV ESP,EBP
00881193 : POP EBP
00881194 : RET 0x8

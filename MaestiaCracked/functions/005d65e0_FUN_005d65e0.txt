PROGRAM  : Maestia.exe
FUNCTION : FUN_005d65e0
ENTRY    : 005d65e0
BODY     : [[005d65e0, 005d6745]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_005d65e0(int param_1,undefined4 param_2,int *param_3,undefined4 param_4,undefined4 param_5,
                undefined1 param_6)

{
  int iVar1;
  GRefCountNTSImpl *this;
  undefined4 in_ECX;
  int iVar2;
  GRefCountNTSImpl *this_00;
  int local_40;
  GRefCountImpl *local_3c;
  int *local_38;
  undefined4 uStack_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  GRefCountNTSImpl *local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  undefined1 local_4;
  
  FUN_005237c0(&PTR_PTR_00d65e4c,in_ECX);
  iVar2 = 0;
  local_40 = 0;
  local_3c = (GRefCountImpl *)0x0;
  iVar1 = FUN_00524930(&local_40,&local_38);
  if (iVar1 != 3) {
    iVar2 = FUN_00523e20();
    goto LAB_005d6704;
  }
  this = (GRefCountNTSImpl *)FUN_005d5d80(param_2,*(undefined4 *)(param_1 + 0x28));
  if (this == (GRefCountNTSImpl *)0x0) {
LAB_005d66da:
    FUN_00524480("Failed to create gradient");
  }
  else {
    local_30 = 1;
    local_24 = 1;
    local_18 = param_4;
    local_8 = *(undefined4 *)(param_1 + 0x28);
    local_14 = param_5;
    this_00 = (GRefCountNTSImpl *)0x0;
    local_28 = 0;
    local_2c = 2;
    local_1c = 0;
    local_10 = 0;
    local_c = 0;
    local_4 = param_6;
    local_20 = this;
    if (param_3 != (int *)0x0) {
      this_00 = (GRefCountNTSImpl *)(**(code **)(*param_3 + 4))(&local_30);
    }
    iVar1 = FUN_00515840(0x1c,0);
    if (iVar1 == 0) {
      iVar2 = 0;
    }
    else {
      iVar2 = FUN_005a04b0(this_00,&local_38,2);
      if (iVar2 != 0) {
        FUN_005243e0(iVar2);
      }
    }
    if (this_00 != (GRefCountNTSImpl *)0x0) {
      GRefCountNTSImpl::Release(this_00);
    }
    if (iVar2 == 0) goto LAB_005d66da;
  }
  if (this != (GRefCountNTSImpl *)0x0) {
    GRefCountNTSImpl::Release(this);
  }
LAB_005d6704:
  if (local_40 == 1) {
    FUN_00524240();
  }
  else if (1 < local_40) {
    GRefCountImpl::Release(local_3c);
  }
  if (local_38 != (int *)0x0) {
    (**(code **)(*local_38 + 8))(uStack_34);
  }
  return iVar2;
}



============================================================
DISASSEMBLY
============================================================
005d65e0 : SUB ESP,0x40
005d65e3 : PUSH EBX
005d65e4 : PUSH EBP
005d65e5 : PUSH ESI
005d65e6 : PUSH EDI
005d65e7 : MOV EDI,ECX
005d65e9 : PUSH EDI
005d65ea : PUSH 0xd65e4c
005d65ef : LEA ECX,[ESP + 0x20]
005d65f3 : CALL 0x005237c0
005d65f8 : MOV ESI,dword ptr [ESP + 0x54]
005d65fc : LEA EAX,[ESP + 0x18]
005d6600 : PUSH EAX
005d6601 : LEA ECX,[ESP + 0x14]
005d6605 : XOR EBX,EBX
005d6607 : PUSH ECX
005d6608 : MOV ECX,ESI
005d660a : XOR EBP,EBP
005d660c : MOV dword ptr [ESP + 0x18],EBX
005d6610 : MOV dword ptr [ESP + 0x1c],EBX
005d6614 : CALL 0x00524930
005d6619 : CMP EAX,0x3
005d661c : JNZ 0x005d66f9
005d6622 : MOV EAX,dword ptr [ESI + 0x28]
005d6625 : MOV EDX,dword ptr [ESP + 0x58]
005d6629 : PUSH EAX
005d662a : PUSH EDX
005d662b : MOV ECX,EDI
005d662d : CALL 0x005d5d80
005d6632 : MOV EDI,EAX
005d6634 : CMP EDI,EBX
005d6636 : JZ 0x005d66da
005d663c : MOV ECX,dword ptr [ESP + 0x64]
005d6640 : MOV DL,byte ptr [ESP + 0x68]
005d6644 : MOV EAX,0x1
005d6649 : MOV dword ptr [ESP + 0x20],EAX
005d664d : MOV dword ptr [ESP + 0x2c],EAX
005d6651 : MOV EAX,dword ptr [ESP + 0x60]
005d6655 : MOV dword ptr [ESP + 0x38],EAX
005d6659 : MOV EAX,dword ptr [ESI + 0x28]
005d665c : MOV dword ptr [ESP + 0x3c],ECX
005d6660 : MOV ECX,dword ptr [ESP + 0x5c]
005d6664 : XOR ESI,ESI
005d6666 : MOV dword ptr [ESP + 0x30],EDI
005d666a : MOV dword ptr [ESP + 0x28],EBX
005d666e : MOV dword ptr [ESP + 0x24],0x2
005d6676 : MOV dword ptr [ESP + 0x34],EBX
005d667a : MOV dword ptr [ESP + 0x40],EBX
005d667e : MOV dword ptr [ESP + 0x44],EBX
005d6682 : MOV byte ptr [ESP + 0x4c],DL
005d6686 : MOV dword ptr [ESP + 0x48],EAX
005d668a : CMP ECX,EBX
005d668c : JZ 0x005d669c
005d668e : MOV EDX,dword ptr [ECX]
005d6690 : MOV EDX,dword ptr [EDX + 0x4]
005d6693 : LEA EAX,[ESP + 0x20]
005d6697 : PUSH EAX
005d6698 : CALL EDX
005d669a : MOV ESI,EAX
005d669c : MOV ECX,dword ptr [ESP + 0x48]
005d66a0 : PUSH EBX
005d66a1 : PUSH 0x1c
005d66a3 : CALL 0x00515840
005d66a8 : CMP EAX,EBX
005d66aa : JZ 0x005d66f5
005d66ac : PUSH 0x2
005d66ae : LEA ECX,[ESP + 0x1c]
005d66b2 : PUSH ECX
005d66b3 : PUSH ESI
005d66b4 : MOV ECX,EAX
005d66b6 : CALL 0x005a04b0
005d66bb : MOV EBP,EAX
005d66bd : CMP EBP,EBX
005d66bf : JZ 0x005d66cb
005d66c1 : MOV ECX,dword ptr [ESP + 0x14]
005d66c5 : PUSH EBP
005d66c6 : CALL 0x005243e0
005d66cb : CMP ESI,EBX
005d66cd : JZ 0x005d66d6
005d66cf : MOV ECX,ESI
005d66d1 : CALL 0x004ff7c0
005d66d6 : CMP EBP,EBX
005d66d8 : JNZ 0x005d66e8
005d66da : MOV ECX,dword ptr [ESP + 0x14]
005d66de : PUSH 0xb93764
005d66e3 : CALL 0x00524480
005d66e8 : CMP EDI,EBX
005d66ea : JZ 0x005d6704
005d66ec : MOV ECX,EDI
005d66ee : CALL 0x004ff7c0
005d66f3 : JMP 0x005d6704
005d66f5 : XOR EBP,EBP
005d66f7 : JMP 0x005d66cb
005d66f9 : LEA ECX,[ESP + 0x10]
005d66fd : CALL 0x00523e20
005d6702 : MOV EBP,EAX
005d6704 : MOV EAX,dword ptr [ESP + 0x10]
005d6708 : CMP EAX,0x1
005d670b : JNZ 0x005d6718
005d670d : MOV ECX,dword ptr [ESP + 0x14]
005d6711 : CALL 0x00524240
005d6716 : JMP 0x005d6726
005d6718 : CMP EAX,0x2
005d671b : JL 0x005d6726
005d671d : MOV ECX,dword ptr [ESP + 0x14]
005d6721 : CALL 0x004ff7e0
005d6726 : MOV ECX,dword ptr [ESP + 0x18]
005d672a : CMP ECX,EBX
005d672c : JZ 0x005d673a
005d672e : MOV EDX,dword ptr [ECX]
005d6730 : MOV EAX,dword ptr [ESP + 0x1c]
005d6734 : MOV EDX,dword ptr [EDX + 0x8]
005d6737 : PUSH EAX
005d6738 : CALL EDX
005d673a : POP EDI
005d673b : POP ESI
005d673c : MOV EAX,EBP
005d673e : POP EBP
005d673f : POP EBX
005d6740 : ADD ESP,0x40
005d6743 : RET 0x18

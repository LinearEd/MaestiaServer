PROGRAM  : Maestia.exe
FUNCTION : FUN_009e3c20
ENTRY    : 009e3c20
BODY     : [[009e3c20, 009e3e30] [009e3ebe, 009e3fb5] [009e4043, 009e4069]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009e3c20(int param_1)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  int *piVar4;
  uint local_110;
  undefined1 local_ac [8];
  undefined1 local_a4 [12];
  undefined2 local_98;
  undefined4 local_88;
  uint local_84;
  undefined2 local_70 [2];
  int local_6c;
  undefined2 local_68 [2];
  int local_64;
  int local_60;
  int local_5c;
  int local_58;
  int local_54;
  int local_50;
  int local_4c;
  int local_48;
  int local_44;
  int local_40;
  int local_3c;
  undefined1 local_38 [4];
  undefined2 uStack_34;
  undefined4 uStack_24;
  uint uStack_20;
  uint local_1c;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4ef2c;
  local_10 = ExceptionList;
  local_110 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&local_110;
  ExceptionList = &local_10;
  local_44 = param_1;
  local_58 = 0;
  local_1c = local_110;
  while( true ) {
    while( true ) {
      if (0xfffe < local_58) {
        ExceptionList = local_10;
        __security_check_cookie(local_1c ^ (uint)&stack0xfffffffc);
        return;
      }
      iVar1 = FUN_00703c00(0x1400);
      local_4c = iVar1;
      if ((iVar1 != 0) && (local_60 = iVar1 + 4, *(char *)(iVar1 + 5) == '\x14')) break;
      local_58 = local_58 + 1;
    }
    FUN_0040eef0(iVar1 + 0x18);
    local_8 = 0;
    FUN_00824120(DAT_0172491c);
    local_8 = CONCAT31(local_8._1_3_,2);
    if (7 < local_84) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_84 = 7;
    local_88 = 0;
    local_98 = 0;
    local_48 = 0;
    local_3c = 0;
    local_8._0_1_ = 3;
    local_54 = FUN_006f0300(0x24);
    local_8._0_1_ = 4;
    if (local_54 == 0) {
      iVar2 = 0;
    }
    else {
      iVar2 = FUN_00418f50(local_54,*(undefined2 *)(iVar1 + 6),local_38);
    }
    local_8._0_1_ = 3;
    local_48 = iVar2;
    local_54 = FUN_006f0300(0x24);
    local_8 = CONCAT31(local_8._1_3_,5);
    if (local_54 == 0) {
      local_3c = 0;
    }
    else {
      local_3c = FUN_00418f50(local_54,*(undefined2 *)(iVar1 + 6),local_38);
    }
    local_8 = 2;
    FUN_00413b60(local_60);
    if (local_5c == *(int *)(local_44 + 8)) {
      local_40 = 0;
      local_8 = CONCAT31(local_8._1_3_,8);
      local_54 = FUN_006f0300(0x10);
      if (local_54 == 0) {
        local_40 = 0;
      }
      else {
        *(undefined4 *)(local_54 + 4) = 0;
        *(undefined4 *)(local_54 + 8) = 0;
        *(undefined4 *)(local_54 + 0xc) = 0;
        local_40 = local_54;
      }
      local_8 = 2;
      iVar1 = *(int *)(local_40 + 4);
      if ((iVar1 == 0) ||
         ((uint)(*(int *)(local_40 + 0xc) - iVar1 >> 2) <=
          (uint)(*(int *)(local_40 + 8) - iVar1 >> 2))) {
        FUN_004d2c60(local_40,*(undefined4 *)(local_40 + 8),&local_48);
      }
      else {
        piVar3 = *(int **)(local_40 + 8);
        iVar1 = 1;
        piVar4 = piVar3;
        do {
          *piVar4 = iVar2;
          iVar1 = iVar1 + -1;
          piVar4 = piVar4 + 1;
        } while (iVar1 != 0);
        *(int **)(local_40 + 8) = piVar3 + 1;
      }
      local_68[0] = *(undefined2 *)(local_4c + 4);
      local_64 = local_40;
      FUN_0041ed30(local_ac,local_68);
    }
    else if (*(int *)(local_5c + 0x10) == 0) {
      if (iVar2 != 0) {
        FUN_00414770(iVar2);
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
    }
    else {
      FUN_00449610();
    }
    local_4c = 0;
    piVar3 = (int *)FUN_00413b60(&local_4c);
    local_5c = *piVar3;
    if (local_5c == *(int *)(local_44 + 8)) break;
    if (*(int *)(local_5c + 0x10) != 0) {
      FUN_00449610();
      FUN_009e406a();
      return;
    }
    if (local_3c != 0) {
      FUN_00414770(local_3c);
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_8 = 0xffffffff;
    if (7 < uStack_20) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    uStack_20 = 7;
    uStack_24 = 0;
    uStack_34 = 0;
    local_58 = local_58 + 1;
  }
  local_50 = 0;
  local_8 = CONCAT31(local_8._1_3_,0xc);
  local_54 = FUN_006f0300(0x10);
  if (local_54 == 0) {
    iVar1 = 0;
  }
  else {
    *(undefined4 *)(local_54 + 4) = 0;
    *(undefined4 *)(local_54 + 8) = 0;
    *(undefined4 *)(local_54 + 0xc) = 0;
    iVar1 = local_54;
  }
  local_8 = 2;
  iVar2 = *(int *)(iVar1 + 4);
  local_50 = iVar1;
  if ((iVar2 == 0) ||
     ((uint)(*(int *)(iVar1 + 0xc) - iVar2 >> 2) <= (uint)(*(int *)(iVar1 + 8) - iVar2 >> 2))) {
    FUN_004d2c60(iVar1,*(undefined4 *)(iVar1 + 8),&local_3c);
  }
  else {
    piVar3 = *(int **)(iVar1 + 8);
    iVar2 = 1;
    piVar4 = piVar3;
    do {
      *piVar4 = local_3c;
      iVar2 = iVar2 + -1;
      piVar4 = piVar4 + 1;
    } while (iVar2 != 0);
    *(int **)(iVar1 + 8) = piVar3 + 1;
  }
  local_70[0] = 0;
  local_6c = iVar1;
  FUN_0041ed30(local_a4,local_70);
  FUN_009e406a();
  return;
}



============================================================
DISASSEMBLY
============================================================
009e3c20 : PUSH EBP
009e3c21 : MOV EBP,ESP
009e3c23 : PUSH -0x1
009e3c25 : PUSH 0xb4ef2c
009e3c2a : MOV EAX,FS:[0x0]
009e3c30 : PUSH EAX
009e3c31 : SUB ESP,0xf0
009e3c37 : MOV EAX,[0x00d66fa0]
009e3c3c : XOR EAX,EBP
009e3c3e : MOV dword ptr [EBP + -0x18],EAX
009e3c41 : PUSH EBX
009e3c42 : PUSH ESI
009e3c43 : PUSH EDI
009e3c44 : PUSH EAX
009e3c45 : LEA EAX,[EBP + -0xc]
009e3c48 : MOV FS:[0x0],EAX
009e3c4e : MOV dword ptr [EBP + -0x10],ESP
009e3c51 : MOV EAX,dword ptr [EBP + 0x8]
009e3c54 : MOV dword ptr [EBP + -0x40],EAX
009e3c57 : XOR EDI,EDI
009e3c59 : MOV dword ptr [EBP + -0x54],EDI
009e3c5c : CMP EDI,0xffff
009e3c62 : JGE 0x009e414f
009e3c68 : PUSH 0x1400
009e3c6d : CALL 0x00703c00
009e3c72 : ADD ESP,0x4
009e3c75 : MOV EBX,EAX
009e3c77 : MOV dword ptr [EBP + -0x48],EBX
009e3c7a : TEST EBX,EBX
009e3c7c : JZ 0x009e4146
009e3c82 : LEA EAX,[EBX + 0x4]
009e3c85 : MOV dword ptr [EBP + -0x5c],EAX
009e3c88 : CMP byte ptr [EAX + 0x1],0x14
009e3c8c : JNZ 0x009e4146
009e3c92 : LEA ECX,[EBX + 0x18]
009e3c95 : PUSH ECX
009e3c96 : LEA ESI,[EBP + 0xffffff68]
009e3c9c : CALL 0x0040eef0
009e3ca1 : ADD ESP,0x4
009e3ca4 : XOR ESI,ESI
009e3ca6 : MOV dword ptr [EBP + -0x4],ESI
009e3ca9 : MOV EDX,dword ptr [0x0172491c]
009e3caf : PUSH EDX
009e3cb0 : MOV EDX,EAX
009e3cb2 : LEA EDI,[EBP + -0x34]
009e3cb5 : CALL 0x00824120
009e3cba : MOV byte ptr [EBP + -0x4],0x2
009e3cbe : CMP dword ptr [EBP + -0x80],0x8
009e3cc2 : JC 0x009e3ccf
009e3cc4 : MOV ECX,dword ptr [EBP + 0xffffff6c]
009e3cca : CALL 0x006f04e0
009e3ccf : MOV dword ptr [EBP + -0x80],0x7
009e3cd6 : MOV dword ptr [EBP + 0xffffff7c],ESI
009e3cdc : XOR EAX,EAX
009e3cde : MOV word ptr [EBP + 0xffffff6c],AX
009e3ce5 : MOV dword ptr [EBP + -0x44],ESI
009e3ce8 : MOV dword ptr [EBP + -0x38],ESI
009e3ceb : MOV byte ptr [EBP + -0x4],0x3
009e3cef : PUSH 0x24
009e3cf1 : CALL 0x006f0300
009e3cf6 : ADD ESP,0x4
009e3cf9 : MOV dword ptr [EBP + -0x50],EAX
009e3cfc : MOV byte ptr [EBP + -0x4],0x4
009e3d00 : CMP EAX,ESI
009e3d02 : JZ 0x009e3d17
009e3d04 : LEA ECX,[EBP + -0x34]
009e3d07 : PUSH ECX
009e3d08 : MOVZX EDX,word ptr [EBX + 0x6]
009e3d0c : PUSH EDX
009e3d0d : PUSH EAX
009e3d0e : CALL 0x00418f50
009e3d13 : MOV EDI,EAX
009e3d15 : JMP 0x009e3d19
009e3d17 : XOR EDI,EDI
009e3d19 : MOV byte ptr [EBP + -0x4],0x3
009e3d1d : MOV dword ptr [EBP + -0x44],EDI
009e3d20 : PUSH 0x24
009e3d22 : CALL 0x006f0300
009e3d27 : ADD ESP,0x4
009e3d2a : MOV dword ptr [EBP + -0x50],EAX
009e3d2d : MOV byte ptr [EBP + -0x4],0x5
009e3d31 : CMP EAX,ESI
009e3d33 : JZ 0x009e3d46
009e3d35 : LEA ECX,[EBP + -0x34]
009e3d38 : PUSH ECX
009e3d39 : MOVZX EDX,word ptr [EBX + 0x6]
009e3d3d : PUSH EDX
009e3d3e : PUSH EAX
009e3d3f : CALL 0x00418f50
009e3d44 : JMP 0x009e3d48
009e3d46 : XOR EAX,EAX
009e3d48 : MOV byte ptr [EBP + -0x4],0x3
009e3d4c : MOV dword ptr [EBP + -0x38],EAX
009e3d4f : MOV dword ptr [EBP + -0x4],0x2
009e3d56 : MOV ESI,dword ptr [EBP + -0x40]
009e3d59 : ADD ESI,0x4
009e3d5c : MOV EAX,dword ptr [EBP + -0x5c]
009e3d5f : PUSH EAX
009e3d60 : LEA EAX,[EBP + -0x58]
009e3d63 : MOV ECX,ESI
009e3d65 : CALL 0x00413b60
009e3d6a : MOV ECX,dword ptr [EBP + -0x40]
009e3d6d : MOV EAX,dword ptr [ECX + 0x8]
009e3d70 : MOV ECX,dword ptr [EBP + -0x58]
009e3d73 : CMP ECX,EAX
009e3d75 : JNZ 0x009e3ebe
009e3d7b : XOR EBX,EBX
009e3d7d : MOV dword ptr [EBP + -0x3c],EBX
009e3d80 : MOV byte ptr [EBP + -0x4],0x8
009e3d84 : PUSH 0x10
009e3d86 : CALL 0x006f0300
009e3d8b : ADD ESP,0x4
009e3d8e : MOV dword ptr [EBP + -0x50],EAX
009e3d91 : MOV byte ptr [EBP + -0x4],0x9
009e3d95 : CMP EAX,EBX
009e3d97 : JZ 0x009e3da4
009e3d99 : MOV dword ptr [EAX + 0x4],EBX
009e3d9c : MOV dword ptr [EAX + 0x8],EBX
009e3d9f : MOV dword ptr [EAX + 0xc],EBX
009e3da2 : JMP 0x009e3da6
009e3da4 : XOR EAX,EAX
009e3da6 : MOV byte ptr [EBP + -0x4],0x8
009e3daa : MOV dword ptr [EBP + -0x3c],EAX
009e3dad : MOV dword ptr [EBP + -0x4],0x2
009e3db4 : MOV ESI,dword ptr [EAX + 0x4]
009e3db7 : MOV ECX,dword ptr [EAX + 0x8]
009e3dba : SUB ECX,ESI
009e3dbc : SAR ECX,0x2
009e3dbf : CMP ESI,EBX
009e3dc1 : JZ 0x009e3df5
009e3dc3 : MOV EDX,dword ptr [EAX + 0xc]
009e3dc6 : SUB EDX,ESI
009e3dc8 : SAR EDX,0x2
009e3dcb : CMP ECX,EDX
009e3dcd : JNC 0x009e3df5
009e3dcf : MOV EAX,dword ptr [EAX + 0x8]
009e3dd2 : MOV ECX,0x1
009e3dd7 : MOV EDX,EAX
009e3dd9 : LEA ESP,[ESP]
009e3de0 : MOV dword ptr [EDX],EDI
009e3de2 : DEC ECX
009e3de3 : ADD EDX,0x4
009e3de6 : CMP ECX,EBX
009e3de8 : JA 0x009e3de0
009e3dea : ADD EAX,0x4
009e3ded : MOV EDX,dword ptr [EBP + -0x3c]
009e3df0 : MOV dword ptr [EDX + 0x8],EAX
009e3df3 : JMP 0x009e3e03
009e3df5 : MOV ECX,dword ptr [EAX + 0x8]
009e3df8 : LEA EDX,[EBP + -0x44]
009e3dfb : PUSH EDX
009e3dfc : PUSH ECX
009e3dfd : PUSH EAX
009e3dfe : CALL 0x004d2c60
009e3e03 : MOV EAX,dword ptr [EBP + -0x48]
009e3e06 : MOV CX,word ptr [EAX + 0x4]
009e3e0a : MOV word ptr [EBP + -0x64],CX
009e3e0e : MOV EDX,dword ptr [EBP + -0x3c]
009e3e11 : MOV dword ptr [EBP + -0x60],EDX
009e3e14 : MOV ESI,dword ptr [EBP + -0x40]
009e3e17 : ADD ESI,0x4
009e3e1a : LEA EAX,[EBP + -0x64]
009e3e1d : PUSH EAX
009e3e1e : LEA ECX,[EBP + 0xffffff58]
009e3e24 : PUSH ECX
009e3e25 : MOV EAX,ESI
009e3e27 : CALL 0x0041ed30
009e3e2c : JMP 0x009e3ee4
009e3ebe : MOV ECX,dword ptr [ECX + 0x10]
009e3ec1 : TEST ECX,ECX
009e3ec3 : JZ 0x009e3ed1
009e3ec5 : LEA EDI,[EBP + -0x44]
009e3ec8 : MOV EDX,ECX
009e3eca : CALL 0x00449610
009e3ecf : JMP 0x009e3ee2
009e3ed1 : TEST EDI,EDI
009e3ed3 : JZ 0x009e3ee2
009e3ed5 : PUSH EDI
009e3ed6 : CALL 0x00414770
009e3edb : MOV ECX,EDI
009e3edd : CALL 0x006f04e0
009e3ee2 : XOR EBX,EBX
009e3ee4 : MOV dword ptr [EBP + -0x48],EBX
009e3ee7 : LEA EAX,[EBP + -0x48]
009e3eea : PUSH EAX
009e3eeb : LEA EAX,[EBP + -0x70]
009e3eee : MOV ECX,ESI
009e3ef0 : CALL 0x00413b60
009e3ef5 : MOV EAX,dword ptr [EAX]
009e3ef7 : MOV dword ptr [EBP + -0x58],EAX
009e3efa : MOV ECX,dword ptr [EBP + -0x40]
009e3efd : CMP EAX,dword ptr [ECX + 0x8]
009e3f00 : JNZ 0x009e4043
009e3f06 : MOV dword ptr [EBP + -0x4c],EBX
009e3f09 : MOV BL,0xc
009e3f0b : MOV byte ptr [EBP + -0x4],BL
009e3f0e : PUSH 0x10
009e3f10 : CALL 0x006f0300
009e3f15 : ADD ESP,0x4
009e3f18 : MOV dword ptr [EBP + -0x50],EAX
009e3f1b : MOV byte ptr [EBP + -0x4],0xd
009e3f1f : XOR EDI,EDI
009e3f21 : CMP EAX,EDI
009e3f23 : JZ 0x009e3f30
009e3f25 : MOV dword ptr [EAX + 0x4],EDI
009e3f28 : MOV dword ptr [EAX + 0x8],EDI
009e3f2b : MOV dword ptr [EAX + 0xc],EDI
009e3f2e : JMP 0x009e3f32
009e3f30 : XOR EAX,EAX
009e3f32 : MOV byte ptr [EBP + -0x4],BL
009e3f35 : MOV EBX,EAX
009e3f37 : MOV dword ptr [EBP + -0x4c],EBX
009e3f3a : MOV dword ptr [EBP + -0x4],0x2
009e3f41 : MOV ESI,dword ptr [EAX + 0x4]
009e3f44 : MOV ECX,dword ptr [EAX + 0x8]
009e3f47 : SUB ECX,ESI
009e3f49 : SAR ECX,0x2
009e3f4c : CMP ESI,EDI
009e3f4e : JZ 0x009e3f82
009e3f50 : MOV EDX,dword ptr [EAX + 0xc]
009e3f53 : SUB EDX,ESI
009e3f55 : SAR EDX,0x2
009e3f58 : CMP ECX,EDX
009e3f5a : JNC 0x009e3f82
009e3f5c : MOV EAX,dword ptr [EAX + 0x8]
009e3f5f : MOV ECX,0x1
009e3f64 : MOV EDX,EAX
009e3f66 : MOV ESI,dword ptr [EBP + -0x38]
009e3f69 : LEA ESP,[ESP]
009e3f70 : MOV dword ptr [EDX],ESI
009e3f72 : DEC ECX
009e3f73 : ADD EDX,0x4
009e3f76 : CMP ECX,EDI
009e3f78 : JA 0x009e3f70
009e3f7a : ADD EAX,0x4
009e3f7d : MOV dword ptr [EBX + 0x8],EAX
009e3f80 : JMP 0x009e3f90
009e3f82 : MOV ECX,dword ptr [EAX + 0x8]
009e3f85 : LEA EDX,[EBP + -0x38]
009e3f88 : PUSH EDX
009e3f89 : PUSH ECX
009e3f8a : PUSH EAX
009e3f8b : CALL 0x004d2c60
009e3f90 : XOR EAX,EAX
009e3f92 : MOV word ptr [EBP + -0x6c],AX
009e3f96 : MOV dword ptr [EBP + -0x68],EBX
009e3f99 : LEA ECX,[EBP + -0x6c]
009e3f9c : PUSH ECX
009e3f9d : LEA EDX,[EBP + 0xffffff60]
009e3fa3 : PUSH EDX
009e3fa4 : MOV EAX,dword ptr [EBP + -0x40]
009e3fa7 : ADD EAX,0x4
009e3faa : CALL 0x0041ed30
009e3faf : XOR EBX,EBX
009e3fb1 : JMP 0x009e406a
009e4043 : MOV EAX,dword ptr [EAX + 0x10]
009e4046 : CMP EAX,EBX
009e4048 : JZ 0x009e4056
009e404a : LEA EDI,[EBP + -0x38]
009e404d : MOV EDX,EAX
009e404f : CALL 0x00449610
009e4054 : JMP 0x009e406a
009e4056 : MOV ESI,dword ptr [EBP + -0x38]
009e4059 : CMP ESI,EBX
009e405b : JZ 0x009e406a
009e405d : PUSH ESI
009e405e : CALL 0x00414770
009e4063 : MOV ECX,ESI
009e4065 : CALL 0x006f04e0

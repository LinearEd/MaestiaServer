PROGRAM  : Maestia.exe
FUNCTION : FUN_00593250
ENTRY    : 00593250
BODY     : [[00593250, 0059343a]]

============================================================
DECOMPILED C CODE
============================================================

char FUN_00593250(void)

{
  uint uVar1;
  char cVar2;
  uint uVar3;
  int iVar4;
  int *in_ECX;
  int *piVar5;
  char local_31;
  uint uStack_24;
  uint uStack_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined2 local_8;
  undefined1 local_6;
  undefined1 local_5;
  undefined1 local_4;
  undefined1 local_3;
  
  FUN_0051ddc0(in_ECX[0x28]);
  uVar1 = *(uint *)(in_ECX[0x28] + 0xa9c);
  if ((in_ECX[0x6e] != 0) && (uVar3 = 0, uVar1 != 0)) {
    piVar5 = *(int **)(in_ECX[0x28] + 0xa98);
    do {
      if ((int *)*piVar5 == in_ECX) {
        if (-1 < (int)uVar3) {
          FUN_00592440(uVar3);
        }
        break;
      }
      uVar3 = uVar3 + 1;
      piVar5 = piVar5 + 1;
    } while (uVar3 < uVar1);
  }
  *(uint *)(in_ECX[0x28] + 0xb00) = *(uint *)(in_ECX[0x28] + 0xb00) | 0x400;
  local_31 = FUN_005ed4c0();
  if (local_31 != '\0') {
    local_8 = 0;
    local_10 = 4;
    local_c = 0;
    local_6 = 0;
    local_5 = 0xff;
    local_4 = 0;
    local_3 = 0;
    cVar2 = FUN_0058b3a0(&local_10);
    if (cVar2 == '\0') {
      return local_31;
    }
    local_31 = '\0';
  }
  if (((*(byte *)((int)in_ECX + 0x66) & 0x20) != 0) && (((uint)in_ECX[0x23] >> 0xc & 1) == 0)) {
    (**(code **)(*in_ECX + 0x40))();
    iVar4 = FUN_00571c40(4);
    if (iVar4 != 0) {
      *(undefined4 *)(iVar4 + 4) = 2;
      uStack_24 = uStack_24 & 0xffff0000;
      in_ECX[1] = in_ECX[1] + 1;
      if (*(GRefCountNTSImpl **)(iVar4 + 8) != (GRefCountNTSImpl *)0x0) {
        GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar4 + 8));
      }
      *(int **)(iVar4 + 8) = in_ECX;
      if (*(GRefCountNTSImpl **)(iVar4 + 0xc) != (GRefCountNTSImpl *)0x0) {
        GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar4 + 0xc));
      }
      *(undefined4 *)(iVar4 + 0xc) = 0;
      *(undefined4 *)(iVar4 + 0x10) = 1;
      *(undefined4 *)(iVar4 + 0x14) = 0;
      *(undefined4 *)(iVar4 + 0x18) = 0xff000000;
      *(uint *)(iVar4 + 0x1c) = uStack_24;
    }
  }
  (**(code **)(*in_ECX + 0x40))();
  iVar4 = FUN_00571c40(4);
  if (iVar4 != 0) {
    *(undefined4 *)(iVar4 + 4) = 2;
    uStack_14 = uStack_14 & 0xffff0000;
    in_ECX[1] = in_ECX[1] + 1;
    if (*(GRefCountNTSImpl **)(iVar4 + 8) != (GRefCountNTSImpl *)0x0) {
      GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar4 + 8));
    }
    *(int **)(iVar4 + 8) = in_ECX;
    if (*(GRefCountNTSImpl **)(iVar4 + 0xc) != (GRefCountNTSImpl *)0x0) {
      GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(iVar4 + 0xc));
    }
    *(undefined4 *)(iVar4 + 0xc) = 0;
    *(undefined4 *)(iVar4 + 0x10) = 4;
    *(undefined4 *)(iVar4 + 0x14) = 0;
    *(undefined4 *)(iVar4 + 0x18) = 0xff000000;
    *(uint *)(iVar4 + 0x1c) = uStack_14;
  }
  return local_31;
}



============================================================
DISASSEMBLY
============================================================
00593250 : SUB ESP,0x34
00593253 : PUSH EBX
00593254 : PUSH ESI
00593255 : MOV ESI,ECX
00593257 : MOV EAX,dword ptr [ESI + 0xa0]
0059325d : PUSH EDI
0059325e : PUSH EAX
0059325f : CALL 0x0051ddc0
00593264 : MOV ECX,dword ptr [ESI + 0xa0]
0059326a : MOV EDI,dword ptr [ECX + 0xa9c]
00593270 : XOR EBX,EBX
00593272 : CMP dword ptr [ESI + 0x1b8],EBX
00593278 : JZ 0x005932a9
0059327a : XOR EAX,EAX
0059327c : CMP EDI,EBX
0059327e : JBE 0x005932a9
00593280 : MOV EDX,dword ptr [ECX + 0xa98]
00593286 : ADD ECX,0xa98
0059328c : LEA ESP,[ESP]
00593290 : CMP dword ptr [EDX],ESI
00593292 : JZ 0x0059329e
00593294 : INC EAX
00593295 : ADD EDX,0x4
00593298 : CMP EAX,EDI
0059329a : JC 0x00593290
0059329c : JMP 0x005932a9
0059329e : CMP EAX,-0x1
005932a1 : JLE 0x005932a9
005932a3 : PUSH EAX
005932a4 : CALL 0x00592440
005932a9 : MOV EAX,dword ptr [ESI + 0xa0]
005932af : OR dword ptr [EAX + 0xb00],0x400
005932b9 : ADD EAX,0xb00
005932be : LEA ECX,[ESI + 0xa8]
005932c4 : CALL 0x005ed4c0
005932c9 : MOV byte ptr [ESP + 0xf],AL
005932cd : CMP AL,BL
005932cf : JZ 0x0059330d
005932d1 : XOR ECX,ECX
005932d3 : LEA EDX,[ESP + 0x30]
005932d7 : MOV word ptr [ESP + 0x38],CX
005932dc : PUSH EDX
005932dd : MOV ECX,ESI
005932df : MOV dword ptr [ESP + 0x34],0x4
005932e7 : MOV dword ptr [ESP + 0x38],EBX
005932eb : MOV byte ptr [ESP + 0x3e],BL
005932ef : MOV byte ptr [ESP + 0x3f],0xff
005932f4 : MOV byte ptr [ESP + 0x40],BL
005932f8 : MOV byte ptr [ESP + 0x41],BL
005932fc : CALL 0x0058b3a0
00593301 : TEST AL,AL
00593303 : JZ 0x00593430
00593309 : MOV byte ptr [ESP + 0xf],BL
0059330d : TEST byte ptr [ESI + 0x66],0x20
00593311 : JZ 0x005933ac
00593317 : MOV EAX,dword ptr [ESI + 0x8c]
0059331d : SHR EAX,0xc
00593320 : TEST AL,0x1
00593322 : JNZ 0x005933ac
00593328 : MOV EDX,dword ptr [ESI]
0059332a : MOV EAX,dword ptr [EDX + 0x40]
0059332d : MOV ECX,ESI
0059332f : CALL EAX
00593331 : PUSH 0x4
00593333 : LEA ECX,[EAX + 0xa2c]
00593339 : CALL 0x00571c40
0059333e : MOV EDI,EAX
00593340 : CMP EDI,EBX
00593342 : JZ 0x005933ac
00593344 : XOR ECX,ECX
00593346 : MOV word ptr [ESP + 0x18],CX
0059334b : MOV dword ptr [EDI + 0x4],0x2
00593352 : MOV dword ptr [ESP + 0x10],0x1
0059335a : MOV dword ptr [ESP + 0x14],EBX
0059335e : MOV byte ptr [ESP + 0x1a],BL
00593362 : MOV byte ptr [ESP + 0x1b],0xff
00593367 : MOV byte ptr [ESP + 0x1c],BL
0059336b : MOV byte ptr [ESP + 0x1d],BL
0059336f : INC dword ptr [ESI + 0x4]
00593372 : MOV ECX,dword ptr [EDI + 0x8]
00593375 : CMP ECX,EBX
00593377 : JZ 0x0059337e
00593379 : CALL 0x004ff7c0
0059337e : MOV dword ptr [EDI + 0x8],ESI
00593381 : MOV ECX,dword ptr [EDI + 0xc]
00593384 : CMP ECX,EBX
00593386 : JZ 0x0059338d
00593388 : CALL 0x004ff7c0
0059338d : MOV EDX,dword ptr [ESP + 0x10]
00593391 : MOV EAX,dword ptr [ESP + 0x14]
00593395 : MOV ECX,dword ptr [ESP + 0x18]
00593399 : MOV dword ptr [EDI + 0xc],EBX
0059339c : MOV dword ptr [EDI + 0x10],EDX
0059339f : MOV EDX,dword ptr [ESP + 0x1c]
005933a3 : MOV dword ptr [EDI + 0x14],EAX
005933a6 : MOV dword ptr [EDI + 0x18],ECX
005933a9 : MOV dword ptr [EDI + 0x1c],EDX
005933ac : MOV EAX,dword ptr [ESI]
005933ae : MOV EDX,dword ptr [EAX + 0x40]
005933b1 : MOV ECX,ESI
005933b3 : CALL EDX
005933b5 : PUSH 0x4
005933b7 : LEA ECX,[EAX + 0xa2c]
005933bd : CALL 0x00571c40
005933c2 : MOV EDI,EAX
005933c4 : CMP EDI,EBX
005933c6 : JZ 0x00593430
005933c8 : XOR EAX,EAX
005933ca : MOV dword ptr [EDI + 0x4],0x2
005933d1 : MOV dword ptr [ESP + 0x20],0x4
005933d9 : MOV dword ptr [ESP + 0x24],EBX
005933dd : MOV word ptr [ESP + 0x28],AX
005933e2 : MOV byte ptr [ESP + 0x2a],BL
005933e6 : MOV byte ptr [ESP + 0x2b],0xff
005933eb : MOV byte ptr [ESP + 0x2c],BL
005933ef : MOV byte ptr [ESP + 0x2d],BL
005933f3 : INC dword ptr [ESI + 0x4]
005933f6 : MOV ECX,dword ptr [EDI + 0x8]
005933f9 : CMP ECX,EBX
005933fb : JZ 0x00593402
005933fd : CALL 0x004ff7c0
00593402 : MOV dword ptr [EDI + 0x8],ESI
00593405 : MOV ECX,dword ptr [EDI + 0xc]
00593408 : CMP ECX,EBX
0059340a : JZ 0x00593411
0059340c : CALL 0x004ff7c0
00593411 : MOV ECX,dword ptr [ESP + 0x20]
00593415 : MOV EDX,dword ptr [ESP + 0x24]
00593419 : MOV EAX,dword ptr [ESP + 0x28]
0059341d : MOV dword ptr [EDI + 0xc],EBX
00593420 : MOV dword ptr [EDI + 0x10],ECX
00593423 : MOV ECX,dword ptr [ESP + 0x2c]
00593427 : MOV dword ptr [EDI + 0x14],EDX
0059342a : MOV dword ptr [EDI + 0x18],EAX
0059342d : MOV dword ptr [EDI + 0x1c],ECX
00593430 : MOV AL,byte ptr [ESP + 0xf]
00593434 : POP EDI
00593435 : POP ESI
00593436 : POP EBX
00593437 : ADD ESP,0x34
0059343a : RET

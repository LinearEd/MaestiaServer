PROGRAM  : Maestia.exe
FUNCTION : FUN_00663340
ENTRY    : 00663340
BODY     : [[00663340, 006633bb]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00663340(short *param_1,uint param_2,int param_3)

{
  short sVar1;
  short *psVar2;
  int iVar3;
  int iVar4;
  
  iVar3 = 0;
  if ((param_2 == 0) || (0x7fffffff < param_2)) {
    iVar3 = -0x7ff8ffa9;
  }
  if (iVar3 < 0) {
    return iVar3;
  }
  iVar3 = 0;
  if (param_2 != 0) {
    iVar4 = 0x7ffffffe - param_2;
    param_3 = param_3 - (int)param_1;
    psVar2 = param_1;
    while ((param_1 = psVar2, iVar4 + param_2 != 0 &&
           (sVar1 = *(short *)(param_3 + (int)param_1), sVar1 != 0))) {
      *param_1 = sVar1;
      param_2 = param_2 - 1;
      psVar2 = param_1 + 1;
      if (param_2 == 0) {
        *param_1 = 0;
        return -0x7ff8ff86;
      }
    }
    if (param_2 != 0) goto LAB_006633b1;
  }
  param_1 = param_1 + -1;
  iVar3 = -0x7ff8ff86;
LAB_006633b1:
  *param_1 = 0;
  return iVar3;
}



============================================================
DISASSEMBLY
============================================================
00663340 : MOV EDX,dword ptr [ESP + 0x8]
00663344 : XOR EAX,EAX
00663346 : TEST EDX,EDX
00663348 : JZ 0x00663352
0066334a : CMP EDX,0x7fffffff
00663350 : JBE 0x00663357
00663352 : MOV EAX,0x80070057
00663357 : TEST EAX,EAX
00663359 : JL 0x006633b9
0066335b : MOV ECX,dword ptr [ESP + 0x4]
0066335f : PUSH EBX
00663360 : PUSH ESI
00663361 : XOR EAX,EAX
00663363 : PUSH EDI
00663364 : MOV ESI,EDX
00663366 : TEST EDX,EDX
00663368 : JZ 0x006633a9
0066336a : MOV EDI,dword ptr [ESP + 0x18]
0066336e : MOV EBX,0x7ffffffe
00663373 : SUB EBX,EDX
00663375 : SUB EDI,ECX
00663377 : LEA EDX,[EBX + ESI*0x1]
0066337a : TEST EDX,EDX
0066337c : JZ 0x006633a5
0066337e : MOVZX EDX,word ptr [EDI + ECX*0x1]
00663382 : TEST DX,DX
00663385 : JZ 0x006633a5
00663387 : MOV word ptr [ECX],DX
0066338a : ADD ECX,0x2
0066338d : SUB ESI,0x1
00663390 : JNZ 0x00663377
00663392 : POP EDI
00663393 : SUB ECX,0x2
00663396 : XOR EDX,EDX
00663398 : POP ESI
00663399 : MOV EAX,0x8007007a
0066339e : MOV word ptr [ECX],DX
006633a1 : POP EBX
006633a2 : RET 0xc
006633a5 : TEST ESI,ESI
006633a7 : JNZ 0x006633b1
006633a9 : SUB ECX,0x2
006633ac : MOV EAX,0x8007007a
006633b1 : POP EDI
006633b2 : XOR EDX,EDX
006633b4 : POP ESI
006633b5 : MOV word ptr [ECX],DX
006633b8 : POP EBX
006633b9 : RET 0xc

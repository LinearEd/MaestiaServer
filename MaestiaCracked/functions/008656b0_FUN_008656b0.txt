PROGRAM  : Maestia.exe
FUNCTION : FUN_008656b0
ENTRY    : 008656b0
BODY     : [[008656b0, 0086571a] [00865720, 00865996]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008656b0(void)

{
  ushort uVar1;
  int iVar2;
  ushort uVar3;
  short sVar4;
  int iVar5;
  undefined4 uVar6;
  short *psVar7;
  uint uVar8;
  uint uVar9;
  int unaff_EDI;
  ushort **ppuVar10;
  int local_38;
  int local_34;
  uint local_30;
  int local_2c;
  ushort *local_28;
  int local_24;
  uint local_20;
  uint local_1c;
  uint local_18;
  int local_14;
  uint local_10;
  int local_c;
  int local_8;
  
  iVar2 = DAT_017247ec;
  local_18 = 0;
  if (DAT_017247ec != 0) {
    local_1c = 0;
    FUN_00404400(&local_1c);
    if (local_1c != 0) {
      iVar5 = 0;
      psVar7 = (short *)(local_1c + 0x60);
      do {
        if (*psVar7 != 0) {
          local_18 = iVar5 + 2U & 0xffff;
        }
        iVar5 = iVar5 + 1;
        psVar7 = psVar7 + 1;
      } while (iVar5 < 0xb);
    }
    local_2c = -(uint)(*(int *)(iVar2 + 0x28) != 0);
joined_r0x00865713:
    if (local_2c != 0) {
      if (iVar2 == 0) {
        local_1c = 0;
      }
      else {
        local_1c = 0;
        FUN_00404160(&local_2c,&local_8,&local_1c);
      }
      iVar5 = 0;
      local_c = 0;
      local_8 = 0;
      local_14 = 0;
      local_10 = 0;
      iVar2 = DAT_017247ec;
      if (((local_1c != 0) && (*(ushort *)(local_1c + 6) != 0)) &&
         (*(char *)(local_1c + 0x76) != '\0')) {
        local_28 = (ushort *)(local_1c + 0x48);
        local_24 = 0;
        local_1c = (uint)*(ushort *)(local_1c + 6);
        do {
          uVar1 = *local_28;
          uVar9 = (uint)uVar1;
          local_20 = uVar9;
          if (uVar1 != 0) {
            if ((short)local_10 == 0) {
              local_10 = (uint)uVar1;
            }
            local_c = local_c + 1;
            uVar8 = 0;
            do {
              if (((byte)uVar8 < 0x21) && (*(int *)(unaff_EDI + 0x17f0 + (uVar8 & 0xff) * 4) != 0))
              {
                uVar3 = (ushort)*(undefined4 *)(unaff_EDI + 0x16e8 + (uVar8 & 0xff) * 4);
              }
              else {
                uVar3 = 0;
              }
              if (uVar3 == uVar1) {
                iVar5 = iVar5 + 1;
              }
              uVar8 = uVar8 + 1;
            } while ((int)uVar8 < 0xc);
            local_8 = iVar5;
            if ((short)local_c != (short)iVar5) {
              uVar8 = 0x14;
              do {
                uVar6 = FUN_00855260();
                sVar4 = FUN_006fe220(uVar6);
                iVar2 = DAT_00d7c54c;
                if ((short)local_1c == sVar4) {
                  if (((byte)uVar8 < 0x21) &&
                     (*(int *)(unaff_EDI + 0x17f0 + (uVar8 & 0xff) * 4) != 0)) {
                    local_30 = *(uint *)(unaff_EDI + 0x16e8 + (uVar8 & 0xff) * 4);
                  }
                  else {
                    local_30 = 0;
                  }
                  FUN_004437f0(&local_30);
                  uVar9 = local_20;
                  if (((local_34 != *(int *)(iVar2 + 0x44)) && (*(int *)(local_34 + 0x10) != 0)) &&
                     ((*(uint *)(*(int *)(local_34 + 0x10) + 0x4c) & 0x18000) != 0)) {
                    local_14 = local_14 + 1;
                  }
                }
                else {
                  if (((byte)uVar8 < 0x21) &&
                     (*(int *)(unaff_EDI + 0x17f0 + (uVar8 & 0xff) * 4) != 0)) {
                    sVar4 = (short)*(undefined4 *)(unaff_EDI + 0x16e8 + (uVar8 & 0xff) * 4);
                  }
                  else {
                    sVar4 = 0;
                  }
                  if (sVar4 == (short)uVar9) {
                    local_8 = local_8 + 1;
                  }
                }
                uVar8 = uVar8 + 1;
              } while ((int)uVar8 < 0x1e);
              iVar5 = local_8;
              if ((short)local_c != (short)local_8) break;
            }
          }
          local_24 = local_24 + 1;
          local_28 = local_28 + 1;
        } while (local_24 < 0xc);
        iVar5 = DAT_00d7c54c;
        local_30 = local_10 & 0xffff | 0x61e0000;
        FUN_004437f0(&local_30);
        iVar2 = DAT_017247ec;
        if (((local_38 == *(int *)(iVar5 + 0x44)) || (*(int *)(local_38 + 0x10) == 0)) ||
           ((*(uint *)(*(int *)(local_38 + 0x10) + 0x4c) & 0x18000) == 0)) {
          if ((((short)local_c == 0) || ((short)local_8 == 0)) || ((short)local_c != (short)local_8)
             ) goto joined_r0x00865713;
        }
        else {
          if (((((short)local_14 == 0) || ((short)local_18 == 0)) ||
              ((short)local_14 != (short)local_18)) || (DAT_017247ec == 0)) goto joined_r0x00865713;
          ppuVar10 = &local_28;
          local_28 = (ushort *)0x0;
          uVar6 = FUN_00855260(ppuVar10);
          FUN_006fe220(uVar6);
          FUN_00404400(ppuVar10);
          iVar2 = DAT_017247ec;
          if (local_28 == (ushort *)0x0) goto joined_r0x00865713;
        }
        FUN_00863440(unaff_EDI,0,local_1c);
        iVar2 = DAT_017247ec;
      }
      goto joined_r0x00865713;
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
008656b0 : PUSH EBP
008656b1 : MOV EBP,ESP
008656b3 : SUB ESP,0x38
008656b6 : PUSH EBX
008656b7 : MOV EBX,dword ptr [0x017247ec]
008656bd : XOR EAX,EAX
008656bf : PUSH ESI
008656c0 : MOV dword ptr [EBP + -0x14],EAX
008656c3 : CMP EBX,EAX
008656c5 : JZ 0x00865991
008656cb : MOV ESI,dword ptr [0x00da9be0]
008656d1 : MOV dword ptr [EBP + -0x18],EAX
008656d4 : LEA EAX,[EBP + -0x18]
008656d7 : PUSH EAX
008656d8 : MOV ECX,EBX
008656da : CALL 0x00404400
008656df : MOV ECX,dword ptr [EBP + -0x18]
008656e2 : XOR ESI,ESI
008656e4 : CMP ECX,ESI
008656e6 : JZ 0x00865707
008656e8 : XOR EAX,EAX
008656ea : ADD ECX,0x60
008656ed : LEA ECX,[ECX]
008656f0 : CMP word ptr [ECX],SI
008656f3 : JZ 0x008656fe
008656f5 : LEA EDX,[EAX + 0x2]
008656f8 : MOVZX EDX,DX
008656fb : MOV dword ptr [EBP + -0x14],EDX
008656fe : INC EAX
008656ff : ADD ECX,0x2
00865702 : CMP EAX,0xb
00865705 : JL 0x008656f0
00865707 : MOV EAX,dword ptr [EBX + 0x28]
0086570a : NEG EAX
0086570c : SBB EAX,EAX
0086570e : MOV dword ptr [EBP + -0x28],EAX
00865711 : CMP EAX,ESI
00865713 : JZ 0x00865991
00865719 : JMP 0x00865726
00865720 : MOV EBX,dword ptr [0x017247ec]
00865726 : CMP EBX,ESI
00865728 : JZ 0x00865745
0086572a : LEA EAX,[EBP + -0x18]
0086572d : PUSH EAX
0086572e : LEA ECX,[EBP + -0x4]
00865731 : PUSH ECX
00865732 : LEA EDX,[EBP + -0x28]
00865735 : PUSH EDX
00865736 : MOV EAX,EBX
00865738 : MOV dword ptr [EBP + -0x18],ESI
0086573b : CALL 0x00404160
00865740 : MOV EAX,dword ptr [EBP + -0x18]
00865743 : JMP 0x00865747
00865745 : XOR EAX,EAX
00865747 : XOR EDX,EDX
00865749 : MOV dword ptr [EBP + -0x8],ESI
0086574c : MOV dword ptr [EBP + -0x4],EDX
0086574f : MOV dword ptr [EBP + -0x10],ESI
00865752 : MOV dword ptr [EBP + -0xc],ESI
00865755 : CMP EAX,ESI
00865757 : JZ 0x00865986
0086575d : MOVZX ECX,word ptr [EAX + 0x6]
00865761 : MOV dword ptr [EBP + -0x18],ECX
00865764 : CMP CX,SI
00865767 : JZ 0x00865986
0086576d : LEA ECX,[EAX + 0x76]
00865770 : MOV dword ptr [EBP + -0x38],ECX
00865773 : CMP byte ptr [ECX],DL
00865775 : JZ 0x00865986
0086577b : ADD EAX,0x48
0086577e : MOV dword ptr [EBP + -0x20],ESI
00865781 : MOV dword ptr [EBP + -0x24],EAX
00865784 : MOVZX ESI,word ptr [EAX]
00865787 : MOV dword ptr [EBP + -0x1c],ESI
0086578a : TEST SI,SI
0086578d : JZ 0x00865868
00865793 : CMP word ptr [EBP + -0xc],0x0
00865798 : JNZ 0x008657a0
0086579a : MOVZX EAX,SI
0086579d : MOV dword ptr [EBP + -0xc],EAX
008657a0 : INC dword ptr [EBP + -0x8]
008657a3 : XOR ECX,ECX
008657a5 : CMP CL,0x21
008657a8 : JNC 0x008657c0
008657aa : MOVZX EAX,CL
008657ad : CMP dword ptr [EDI + EAX*0x4 + 0x17f0],0x0
008657b5 : JZ 0x008657c0
008657b7 : MOV EAX,dword ptr [EDI + EAX*0x4 + 0x16e8]
008657be : JMP 0x008657c2
008657c0 : XOR EAX,EAX
008657c2 : CMP AX,SI
008657c5 : JNZ 0x008657c8
008657c7 : INC EDX
008657c8 : INC ECX
008657c9 : CMP ECX,0xb
008657cc : JLE 0x008657a5
008657ce : MOV dword ptr [EBP + -0x4],EDX
008657d1 : CMP word ptr [EBP + -0x8],DX
008657d5 : JZ 0x00865868
008657db : MOV EBX,0x14
008657e0 : MOV AL,0x14
008657e2 : MOV ECX,EDI
008657e4 : CALL 0x00855260
008657e9 : PUSH EAX
008657ea : CALL 0x006fe220
008657ef : ADD ESP,0x4
008657f2 : CMP word ptr [EBP + -0x18],AX
008657f6 : JNZ 0x00865934
008657fc : CMP BL,0x21
008657ff : JNC 0x00865817
00865801 : MOVZX EAX,BL
00865804 : CMP dword ptr [EDI + EAX*0x4 + 0x17f0],0x0
0086580c : JZ 0x00865817
0086580e : MOV EAX,dword ptr [EDI + EAX*0x4 + 0x16e8]
00865815 : JMP 0x00865819
00865817 : XOR EAX,EAX
00865819 : MOV ESI,dword ptr [0x00d7c54c]
0086581f : LEA ECX,[EBP + -0x2c]
00865822 : MOV dword ptr [EBP + -0x2c],EAX
00865825 : PUSH ECX
00865826 : LEA ECX,[ESI + 0x40]
00865829 : LEA EAX,[EBP + -0x30]
0086582c : CALL 0x004437f0
00865831 : MOV EAX,dword ptr [EBP + -0x30]
00865834 : CMP EAX,dword ptr [ESI + 0x44]
00865837 : JZ 0x00865852
00865839 : MOV EAX,dword ptr [EAX + 0x10]
0086583c : TEST EAX,EAX
0086583e : JZ 0x00865852
00865840 : MOV ECX,dword ptr [EAX + 0x4c]
00865843 : AND ECX,0x18000
00865849 : XOR EAX,EAX
0086584b : OR EAX,ECX
0086584d : JZ 0x00865852
0086584f : INC dword ptr [EBP + -0x10]
00865852 : MOV ESI,dword ptr [EBP + -0x1c]
00865855 : INC EBX
00865856 : CMP EBX,0x1d
00865859 : JLE 0x008657e0
0086585b : MOV DX,word ptr [EBP + -0x4]
0086585f : CMP word ptr [EBP + -0x8],DX
00865863 : JNZ 0x00865881
00865865 : MOV EDX,dword ptr [EBP + -0x4]
00865868 : MOV ECX,dword ptr [EBP + -0x20]
0086586b : MOV EAX,dword ptr [EBP + -0x24]
0086586e : INC ECX
0086586f : ADD EAX,0x2
00865872 : CMP ECX,0xc
00865875 : MOV dword ptr [EBP + -0x20],ECX
00865878 : MOV dword ptr [EBP + -0x24],EAX
0086587b : JL 0x00865784
00865881 : MOVZX EAX,word ptr [EBP + -0xc]
00865885 : MOV EBX,dword ptr [0x00d7c54c]
0086588b : OR EAX,0x61e0000
00865890 : LEA ECX,[EBP + -0x2c]
00865893 : MOV dword ptr [EBP + -0x2c],EAX
00865896 : PUSH ECX
00865897 : LEA ECX,[EBX + 0x40]
0086589a : LEA EAX,[EBP + -0x34]
0086589d : CALL 0x004437f0
008658a2 : MOV EAX,dword ptr [EBP + -0x34]
008658a5 : CMP EAX,dword ptr [EBX + 0x44]
008658a8 : JZ 0x00865962
008658ae : MOV EAX,dword ptr [EAX + 0x10]
008658b1 : TEST EAX,EAX
008658b3 : JZ 0x00865962
008658b9 : MOV ECX,dword ptr [EAX + 0x4c]
008658bc : AND ECX,0x18000
008658c2 : XOR EAX,EAX
008658c4 : OR EAX,ECX
008658c6 : JZ 0x00865962
008658cc : MOV EAX,dword ptr [EBP + -0x10]
008658cf : TEST AX,AX
008658d2 : JBE 0x00865986
008658d8 : CMP word ptr [EBP + -0x14],0x0
008658dd : JBE 0x00865986
008658e3 : CMP AX,word ptr [EBP + -0x14]
008658e7 : JNZ 0x00865986
008658ed : CMP dword ptr [0x017247ec],0x0
008658f4 : JZ 0x00865986
008658fa : LEA EDX,[EBP + -0x24]
008658fd : PUSH EDX
008658fe : MOV AL,0x14
00865900 : MOV ECX,EDI
00865902 : MOV dword ptr [EBP + -0x24],0x0
00865909 : CALL 0x00855260
0086590e : PUSH EAX
0086590f : CALL 0x006fe220
00865914 : MOV ECX,dword ptr [0x017247ec]
0086591a : ADD ESP,0x4
0086591d : MOV ESI,EAX
0086591f : CALL 0x00404400
00865924 : MOV EAX,dword ptr [EBP + -0x24]
00865927 : TEST EAX,EAX
00865929 : JZ 0x00865986
0086592b : MOV ECX,dword ptr [EBP + -0x18]
0086592e : PUSH ECX
0086592f : LEA ECX,[EAX + 0x76]
00865932 : JMP 0x0086597e
00865934 : CMP BL,0x21
00865937 : JNC 0x0086594f
00865939 : MOVZX EAX,BL
0086593c : CMP dword ptr [EDI + EAX*0x4 + 0x17f0],0x0
00865944 : JZ 0x0086594f
00865946 : MOV EAX,dword ptr [EDI + EAX*0x4 + 0x16e8]
0086594d : JMP 0x00865951
0086594f : XOR EAX,EAX
00865951 : CMP AX,SI
00865954 : JNZ 0x00865855
0086595a : INC dword ptr [EBP + -0x4]
0086595d : JMP 0x00865855
00865962 : MOV EAX,dword ptr [EBP + -0x8]
00865965 : TEST AX,AX
00865968 : JBE 0x00865986
0086596a : MOV ECX,dword ptr [EBP + -0x4]
0086596d : TEST CX,CX
00865970 : JBE 0x00865986
00865972 : CMP AX,CX
00865975 : JNZ 0x00865986
00865977 : MOV EDX,dword ptr [EBP + -0x18]
0086597a : MOV ECX,dword ptr [EBP + -0x38]
0086597d : PUSH EDX
0086597e : PUSH 0x0
00865980 : PUSH EDI
00865981 : CALL 0x00863440
00865986 : XOR ESI,ESI
00865988 : CMP dword ptr [EBP + -0x28],ESI
0086598b : JNZ 0x00865720
00865991 : POP ESI
00865992 : POP EBX
00865993 : MOV ESP,EBP
00865995 : POP EBP
00865996 : RET

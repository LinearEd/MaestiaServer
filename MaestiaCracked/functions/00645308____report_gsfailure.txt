PROGRAM  : Maestia.exe
FUNCTION : ___report_gsfailure
ENTRY    : 00645308
BODY     : [[00645308, 0064540d]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* Library Function - Single Match
    ___report_gsfailure
   
   Libraries: Visual Studio 2005 Release, Visual Studio 2008 Release, Visual Studio 2010 Release */

void __cdecl ___report_gsfailure(void)

{
  undefined4 in_EAX;
  HANDLE hProcess;
  undefined4 in_ECX;
  undefined4 in_EDX;
  undefined4 unaff_EBX;
  undefined4 unaff_EBP;
  undefined4 unaff_ESI;
  undefined4 unaff_EDI;
  undefined2 in_ES;
  undefined2 in_CS;
  undefined2 in_SS;
  undefined2 in_DS;
  undefined2 in_FS;
  undefined2 in_GS;
  byte in_AF;
  byte in_TF;
  byte in_IF;
  byte in_NT;
  byte in_AC;
  byte in_VIF;
  byte in_VIP;
  byte in_ID;
  undefined4 unaff_retaddr;
  UINT uExitCode;
  undefined4 local_32c;
  undefined4 local_328;
  
  _DAT_00d7b928 =
       (uint)(in_NT & 1) * 0x4000 | (uint)SBORROW4((int)&stack0xfffffffc,0x328) * 0x800 |
       (uint)(in_IF & 1) * 0x200 | (uint)(in_TF & 1) * 0x100 | (uint)((int)&local_32c < 0) * 0x80 |
       (uint)(&stack0x00000000 == (undefined1 *)0x32c) * 0x40 | (uint)(in_AF & 1) * 0x10 |
       (uint)((POPCOUNT((uint)&local_32c & 0xff) & 1U) == 0) * 4 |
       (uint)(&stack0xfffffffc < (undefined1 *)0x328) | (uint)(in_ID & 1) * 0x200000 |
       (uint)(in_VIP & 1) * 0x100000 | (uint)(in_VIF & 1) * 0x80000 | (uint)(in_AC & 1) * 0x40000;
  _DAT_00d7b92c = &stack0x00000004;
  _DAT_00d7b868 = 0x10001;
  _DAT_00d7b810 = 0xc0000409;
  _DAT_00d7b814 = 1;
  local_32c = DAT_00d66fa0;
  local_328 = DAT_00d66fa4;
  _DAT_00d7b81c = unaff_retaddr;
  _DAT_00d7b8f4 = in_GS;
  _DAT_00d7b8f8 = in_FS;
  _DAT_00d7b8fc = in_ES;
  _DAT_00d7b900 = in_DS;
  _DAT_00d7b904 = unaff_EDI;
  _DAT_00d7b908 = unaff_ESI;
  _DAT_00d7b90c = unaff_EBX;
  _DAT_00d7b910 = in_EDX;
  _DAT_00d7b914 = in_ECX;
  _DAT_00d7b918 = in_EAX;
  _DAT_00d7b91c = unaff_EBP;
  DAT_00d7b920 = unaff_retaddr;
  _DAT_00d7b924 = in_CS;
  _DAT_00d7b930 = in_SS;
  DAT_00d7b860 = IsDebuggerPresent();
  FUN_006504cd(1);
  SetUnhandledExceptionFilter((LPTOP_LEVEL_EXCEPTION_FILTER)0x0);
  UnhandledExceptionFilter((_EXCEPTION_POINTERS *)&PTR_DAT_00b9b9ac);
  if (DAT_00d7b860 == 0) {
    FUN_006504cd(1);
  }
  uExitCode = 0xc0000409;
  hProcess = GetCurrentProcess();
  TerminateProcess(hProcess,uExitCode);
  return;
}



============================================================
DISASSEMBLY
============================================================
00645308 : MOV EDI,EDI
0064530a : PUSH EBP
0064530b : MOV EBP,ESP
0064530d : SUB ESP,0x328
00645313 : MOV [0x00d7b918],EAX
00645318 : MOV dword ptr [0x00d7b914],ECX
0064531e : MOV dword ptr [0x00d7b910],EDX
00645324 : MOV dword ptr [0x00d7b90c],EBX
0064532a : MOV dword ptr [0x00d7b908],ESI
00645330 : MOV dword ptr [0x00d7b904],EDI
00645336 : MOV word ptr [0x00d7b930],SS
0064533d : MOV word ptr [0x00d7b924],CS
00645344 : MOV word ptr [0x00d7b900],DS
0064534b : MOV word ptr [0x00d7b8fc],ES
00645352 : MOV word ptr [0x00d7b8f8],FS
00645359 : MOV word ptr [0x00d7b8f4],GS
00645360 : PUSHFD
00645361 : POP dword ptr [0x00d7b928]
00645367 : MOV EAX,dword ptr [EBP]
0064536a : MOV [0x00d7b91c],EAX
0064536f : MOV EAX,dword ptr [EBP + 0x4]
00645372 : MOV [0x00d7b920],EAX
00645377 : LEA EAX,[EBP + 0x8]
0064537a : MOV [0x00d7b92c],EAX
0064537f : MOV EAX,dword ptr [EBP + 0xfffffce0]
00645385 : MOV dword ptr [0x00d7b868],0x10001
0064538f : MOV EAX,[0x00d7b920]
00645394 : MOV [0x00d7b81c],EAX
00645399 : MOV dword ptr [0x00d7b810],0xc0000409
006453a3 : MOV dword ptr [0x00d7b814],0x1
006453ad : MOV EAX,[0x00d66fa0]
006453b2 : MOV dword ptr [EBP + 0xfffffcd8],EAX
006453b8 : MOV EAX,[0x00d66fa4]
006453bd : MOV dword ptr [EBP + 0xfffffcdc],EAX
006453c3 : CALL dword ptr [0x00b852dc]
006453c9 : MOV [0x00d7b860],EAX
006453ce : PUSH 0x1
006453d0 : CALL 0x006504cd
006453d5 : POP ECX
006453d6 : PUSH 0x0
006453d8 : CALL dword ptr [0x00b8514c]
006453de : PUSH 0xb9b9ac
006453e3 : CALL dword ptr [0x00b852bc]
006453e9 : CMP dword ptr [0x00d7b860],0x0
006453f0 : JNZ 0x006453fa
006453f2 : PUSH 0x1
006453f4 : CALL 0x006504cd
006453f9 : POP ECX
006453fa : PUSH 0xc0000409
006453ff : CALL dword ptr [0x00b85134]
00645405 : PUSH EAX
00645406 : CALL dword ptr [0x00b852c0]
0064540c : LEAVE
0064540d : RET

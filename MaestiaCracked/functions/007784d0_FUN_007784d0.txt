PROGRAM  : Maestia.exe
FUNCTION : FUN_007784d0
ENTRY    : 007784d0
BODY     : [[007784d0, 007786d0]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_007784d0(undefined4 *param_1)

{
  uint uVar1;
  BOOL BVar2;
  int iVar3;
  undefined4 uVar4;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b30faa;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *param_1 = &PTR_FUN_00cd7de8;
  FUN_004869c0(param_1 + 4);
  local_8 = 0;
  param_1[0x3a] = 0;
  param_1[0x43] = &PTR_FUN_00cdec94;
  BVar2 = InitializeCriticalSectionAndSpinCount((LPCRITICAL_SECTION)(param_1 + 0x44),4000);
  if (BVar2 == 0) {
    InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x44));
  }
  iVar3 = DAT_017251ac;
  local_8._0_1_ = 1;
  *(undefined1 *)(param_1 + 3) = 1;
  param_1[0x3b] = 0;
  param_1[0x3c] = 0;
  param_1[0x3d] = 0;
  param_1[0x3e] = 0;
  param_1[0x3f] = 0;
  *(undefined1 *)(param_1 + 0x40) = 0;
  param_1[0x41] = 0;
  *(undefined2 *)(param_1 + 0x42) = 0x100;
  *(undefined2 *)((int)param_1 + 0x10a) = 0x100;
  if (*(char *)(iVar3 + 0x154) == '\0') {
    iVar3 = FUN_006f0760(0x168,"",0,(DAT_01725270 >> 3 & 1) == 0,uVar1);
    local_8._0_1_ = 4;
    if (iVar3 == 0) {
      uVar4 = 0;
    }
    else {
      uVar4 = FUN_00a62900(iVar3,param_1);
    }
    local_8._0_1_ = 1;
    uVar1 = DAT_01725270 >> 3;
    param_1[0x3c] = uVar4;
    iVar3 = FUN_006f0760(0x20,"",0,(uVar1 & 1) == 0);
    local_8 = CONCAT31(local_8._1_3_,5);
    if (iVar3 != 0) {
      uVar4 = FUN_00a606f0(iVar3,param_1);
      goto LAB_0077869e;
    }
  }
  else {
    iVar3 = FUN_006f0760(0x168,"",0,(DAT_01725270 >> 3 & 1) == 0,uVar1);
    local_8._0_1_ = 2;
    if (iVar3 == 0) {
      uVar4 = 0;
    }
    else {
      uVar4 = FUN_00a62b30(iVar3,param_1);
    }
    local_8._0_1_ = 1;
    param_1[0x3c] = uVar4;
    iVar3 = FUN_006f0760(0x20,"",0,(DAT_01725270 >> 3 & 1) == 0);
    local_8 = CONCAT31(local_8._1_3_,3);
    if (iVar3 != 0) {
      uVar4 = FUN_00a60d40(iVar3,param_1);
      goto LAB_0077869e;
    }
  }
  uVar4 = 0;
LAB_0077869e:
  param_1[0x3d] = uVar4;
  *(undefined1 *)(param_1[0x3c] + 0xc) = *(undefined1 *)(param_1 + 3);
  ExceptionList = local_10;
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
007784d0 : PUSH EBP
007784d1 : MOV EBP,ESP
007784d3 : PUSH -0x1
007784d5 : PUSH 0xb30faa
007784da : MOV EAX,FS:[0x0]
007784e0 : PUSH EAX
007784e1 : SUB ESP,0x8
007784e4 : PUSH EBX
007784e5 : PUSH ESI
007784e6 : PUSH EDI
007784e7 : MOV EAX,[0x00d66fa0]
007784ec : XOR EAX,EBP
007784ee : PUSH EAX
007784ef : LEA EAX,[EBP + -0xc]
007784f2 : MOV FS:[0x0],EAX
007784f8 : MOV ESI,dword ptr [EBP + 0x8]
007784fb : LEA EAX,[ESI + 0x10]
007784fe : PUSH EAX
007784ff : MOV dword ptr [ESI],0xcd7de8
00778505 : CALL 0x004869c0
0077850a : XOR EBX,EBX
0077850c : MOV dword ptr [EBP + -0x4],EBX
0077850f : PUSH 0xfa0
00778514 : LEA EDI,[ESI + 0x110]
0077851a : MOV dword ptr [ESI + 0xe8],EBX
00778520 : PUSH EDI
00778521 : MOV dword ptr [ESI + 0x10c],0xcdec94
0077852b : CALL dword ptr [0x00b85110]
00778531 : TEST EAX,EAX
00778533 : JNZ 0x0077853c
00778535 : PUSH EDI
00778536 : CALL dword ptr [0x00b85114]
0077853c : MOV byte ptr [EBP + -0x4],0x1
00778540 : MOV EAX,[0x017251ac]
00778545 : MOV ECX,0x100
0077854a : MOV EDX,ECX
0077854c : MOV byte ptr [ESI + 0xc],0x1
00778550 : MOV dword ptr [ESI + 0xec],EBX
00778556 : MOV dword ptr [ESI + 0xf0],EBX
0077855c : MOV dword ptr [ESI + 0xf4],EBX
00778562 : MOV dword ptr [ESI + 0xf8],EBX
00778568 : MOV dword ptr [ESI + 0xfc],EBX
0077856e : MOV byte ptr [ESI + 0x100],BL
00778574 : MOV dword ptr [ESI + 0x104],EBX
0077857a : MOV word ptr [ESI + 0x108],CX
00778581 : MOV word ptr [ESI + 0x10a],DX
00778588 : CMP byte ptr [EAX + 0x154],BL
0077858e : JZ 0x0077861b
00778594 : MOV ECX,dword ptr [0x01725270]
0077859a : SHR ECX,0x3
0077859d : MOV EDX,0x0
007785a2 : AND ECX,0x1
007785a5 : SETZ DL
007785a8 : PUSH EDX
007785a9 : PUSH EBX
007785aa : PUSH 0xbf1a4a
007785af : PUSH 0x168
007785b4 : CALL 0x006f0760
007785b9 : ADD ESP,0x10
007785bc : MOV dword ptr [EBP + -0x10],EAX
007785bf : MOV byte ptr [EBP + -0x4],0x2
007785c3 : CMP EAX,EBX
007785c5 : JZ 0x007785d0
007785c7 : PUSH ESI
007785c8 : PUSH EAX
007785c9 : CALL 0x00a62b30
007785ce : JMP 0x007785d2
007785d0 : XOR EAX,EAX
007785d2 : MOV byte ptr [EBP + -0x4],0x1
007785d6 : MOV dword ptr [ESI + 0xf0],EAX
007785dc : MOV EAX,[0x01725270]
007785e1 : SHR EAX,0x3
007785e4 : MOV ECX,0x0
007785e9 : AND EAX,0x1
007785ec : SETZ CL
007785ef : PUSH ECX
007785f0 : PUSH EBX
007785f1 : PUSH 0xbf1a4a
007785f6 : PUSH 0x20
007785f8 : CALL 0x006f0760
007785fd : ADD ESP,0x10
00778600 : MOV dword ptr [EBP + -0x10],EAX
00778603 : MOV byte ptr [EBP + -0x4],0x3
00778607 : CMP EAX,EBX
00778609 : JZ 0x0077869c
0077860f : PUSH ESI
00778610 : PUSH EAX
00778611 : CALL 0x00a60d40
00778616 : JMP 0x0077869e
0077861b : MOV EDX,dword ptr [0x01725270]
00778621 : SHR EDX,0x3
00778624 : MOV EAX,0x0
00778629 : AND EDX,0x1
0077862c : SETZ AL
0077862f : PUSH EAX
00778630 : PUSH EBX
00778631 : PUSH 0xbf1a4a
00778636 : PUSH 0x168
0077863b : CALL 0x006f0760
00778640 : ADD ESP,0x10
00778643 : MOV dword ptr [EBP + -0x10],EAX
00778646 : MOV byte ptr [EBP + -0x4],0x4
0077864a : CMP EAX,EBX
0077864c : JZ 0x00778657
0077864e : PUSH ESI
0077864f : PUSH EAX
00778650 : CALL 0x00a62900
00778655 : JMP 0x00778659
00778657 : XOR EAX,EAX
00778659 : MOV byte ptr [EBP + -0x4],0x1
0077865d : MOV ECX,dword ptr [0x01725270]
00778663 : SHR ECX,0x3
00778666 : MOV EDX,0x0
0077866b : AND ECX,0x1
0077866e : SETZ DL
00778671 : MOV dword ptr [ESI + 0xf0],EAX
00778677 : PUSH EDX
00778678 : PUSH EBX
00778679 : PUSH 0xbf1a4a
0077867e : PUSH 0x20
00778680 : CALL 0x006f0760
00778685 : ADD ESP,0x10
00778688 : MOV dword ptr [EBP + -0x10],EAX
0077868b : MOV byte ptr [EBP + -0x4],0x5
0077868f : CMP EAX,EBX
00778691 : JZ 0x0077869c
00778693 : PUSH ESI
00778694 : PUSH EAX
00778695 : CALL 0x00a606f0
0077869a : JMP 0x0077869e
0077869c : XOR EAX,EAX
0077869e : MOV byte ptr [EBP + -0x4],0x1
007786a2 : MOV ECX,dword ptr [ESI + 0xf0]
007786a8 : MOV dword ptr [ESI + 0xf4],EAX
007786ae : MOV AL,byte ptr [ESI + 0xc]
007786b1 : MOV byte ptr [ECX + 0xc],AL
007786b4 : MOV dword ptr [EBP + -0x4],0xffffffff
007786bb : MOV EAX,ESI
007786bd : MOV ECX,dword ptr [EBP + -0xc]
007786c0 : MOV dword ptr FS:[0x0],ECX
007786c7 : POP ECX
007786c8 : POP EDI
007786c9 : POP ESI
007786ca : POP EBX
007786cb : MOV ESP,EBP
007786cd : POP EBP
007786ce : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_006b00d0
ENTRY    : 006b00d0
BODY     : [[006b00d0, 006b0312]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006b00d0(int param_1,undefined4 *param_2)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  int iVar5;
  int iVar6;
  undefined4 uVar7;
  void *_Dst;
  size_t sStack_18;
  void *pvStack_10;
  int iStack_c;
  undefined4 *local_8;
  undefined4 uStack_4;
  
  puVar4 = param_2;
  uVar2 = param_2[4];
  puVar3 = *(undefined4 **)(param_1 + 0x1e4);
  puVar1 = param_2 + 0x4f;
  local_8 = puVar3;
  (*(code *)param_2[7])(param_2);
  if (((char *)*puVar4 < (char *)puVar4[2]) && (*(char *)*puVar4 == '[')) {
    (*(code *)puVar4[8])(puVar4);
    (*(code *)puVar4[7])(puVar4);
    if (((char *)puVar4[2] <= (char *)*puVar4) || (*(char *)*puVar4 != ']')) {
      puVar4[3] = 3;
      return;
    }
  }
  else {
    iVar5 = (*(code *)puVar4[9])(puVar4);
    (*(code *)puVar4[8])(puVar4);
    if (puVar4[3] == 0) {
      (*(code *)puVar4[7])(puVar4);
      if ((puVar4[0x4e] == 0) &&
         (param_2 = (undefined4 *)(**(code **)*puVar3)(puVar1,iVar5,uVar2),
         param_2 != (undefined4 *)0x0)) {
LAB_006b0308:
        puVar4[3] = param_2;
        return;
      }
      iStack_c = 0;
      if (0 < iVar5) {
        do {
          iVar6 = _strncmp((char *)*puVar4,"dup",3);
          if (iVar6 != 0) break;
          (*(code *)puVar4[8])(puVar4);
          uVar7 = (*(code *)puVar4[9])(puVar4);
          uStack_4 = uVar7;
          iVar6 = FUN_006afba0(&pvStack_10);
          if (iVar6 == 0) {
            return;
          }
          (*(code *)puVar4[8])(puVar4);
          if (puVar4[3] != 0) {
            return;
          }
          (*(code *)puVar4[7])(puVar4);
          iVar6 = _strncmp((char *)*puVar4,"put",3);
          if (iVar6 == 0) {
            (*(code *)puVar4[8])(puVar4);
            (*(code *)puVar4[7])(puVar4);
          }
          if (puVar4[0x4e] == 0) {
            if (*(int *)(param_1 + 0xa8) < 0) {
              param_2 = (undefined4 *)(*(code *)puVar4[0x5a])(puVar1,uVar7,pvStack_10,sStack_18);
            }
            else {
              if ((int)sStack_18 < *(int *)(param_1 + 0xa8)) {
                param_2 = (undefined4 *)0x3;
                goto LAB_006b0308;
              }
              _Dst = (void *)FUN_00688c00(uVar2,sStack_18,&param_2);
              if (param_2 != (undefined4 *)0x0) goto LAB_006b0308;
              _memcpy(_Dst,pvStack_10,sStack_18);
              (*(code *)local_8[4])(_Dst,sStack_18,0x10ea);
              sStack_18 = sStack_18 - *(int *)(param_1 + 0xa8);
              param_2 = (undefined4 *)
                        (*(code *)puVar4[0x5a])
                                  (puVar1,uStack_4,*(int *)(param_1 + 0xa8) + (int)_Dst,sStack_18);
              FUN_00687f30(uVar2,_Dst);
            }
            if (param_2 != (undefined4 *)0x0) goto LAB_006b0308;
          }
          iStack_c = iStack_c + 1;
        } while (iStack_c < iVar5);
      }
      if (puVar4[0x4e] == 0) {
        puVar4[0x4e] = iVar5;
      }
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
006b00d0 : SUB ESP,0x1c
006b00d3 : MOV EAX,dword ptr [ESP + 0x20]
006b00d7 : PUSH EBX
006b00d8 : PUSH EBP
006b00d9 : PUSH ESI
006b00da : MOV ESI,dword ptr [ESP + 0x30]
006b00de : MOV EBX,dword ptr [ESI + 0x10]
006b00e1 : MOV ECX,dword ptr [ESI + 0x1c]
006b00e4 : PUSH EDI
006b00e5 : MOV EDI,dword ptr [EAX + 0x1e4]
006b00eb : PUSH ESI
006b00ec : LEA EBP,[ESI + 0x13c]
006b00f2 : MOV dword ptr [ESP + 0x1c],EBX
006b00f6 : MOV dword ptr [ESP + 0x28],EDI
006b00fa : CALL ECX
006b00fc : MOV EAX,dword ptr [ESI]
006b00fe : ADD ESP,0x4
006b0101 : CMP EAX,dword ptr [ESI + 0x8]
006b0104 : JNC 0x006b0139
006b0106 : CMP byte ptr [EAX],0x5b
006b0109 : JNZ 0x006b0139
006b010b : MOV EDX,dword ptr [ESI + 0x20]
006b010e : PUSH ESI
006b010f : CALL EDX
006b0111 : MOV EAX,dword ptr [ESI + 0x1c]
006b0114 : PUSH ESI
006b0115 : CALL EAX
006b0117 : MOV EAX,dword ptr [ESI]
006b0119 : ADD ESP,0x8
006b011c : CMP EAX,dword ptr [ESI + 0x8]
006b011f : JNC 0x006b012a
006b0121 : CMP byte ptr [EAX],0x5d
006b0124 : JZ 0x006b02fb
006b012a : POP EDI
006b012b : MOV dword ptr [ESI + 0xc],0x3
006b0132 : POP ESI
006b0133 : POP EBP
006b0134 : POP EBX
006b0135 : ADD ESP,0x1c
006b0138 : RET
006b0139 : MOV ECX,dword ptr [ESI + 0x24]
006b013c : PUSH ESI
006b013d : CALL ECX
006b013f : MOV EDX,dword ptr [ESI + 0x20]
006b0142 : PUSH ESI
006b0143 : MOV dword ptr [ESP + 0x18],EAX
006b0147 : CALL EDX
006b0149 : ADD ESP,0x8
006b014c : CMP dword ptr [ESI + 0xc],0x0
006b0150 : JNZ 0x006b02fb
006b0156 : MOV EAX,dword ptr [ESI + 0x1c]
006b0159 : PUSH ESI
006b015a : CALL EAX
006b015c : ADD ESP,0x4
006b015f : CMP dword ptr [ESI + 0x138],0x0
006b0166 : JNZ 0x006b0184
006b0168 : MOV EDX,dword ptr [ESP + 0x10]
006b016c : MOV ECX,dword ptr [EDI]
006b016e : MOV EAX,dword ptr [ECX]
006b0170 : PUSH EBX
006b0171 : PUSH EDX
006b0172 : PUSH EBP
006b0173 : CALL EAX
006b0175 : ADD ESP,0xc
006b0178 : MOV dword ptr [ESP + 0x34],EAX
006b017c : TEST EAX,EAX
006b017e : JNZ 0x006b0308
006b0184 : CMP dword ptr [ESP + 0x10],0x0
006b0189 : MOV dword ptr [ESP + 0x20],0x0
006b0191 : JLE 0x006b02e8
006b0197 : MOV ECX,dword ptr [ESI]
006b0199 : PUSH 0x3
006b019b : PUSH 0xbeb87c
006b01a0 : PUSH ECX
006b01a1 : CALL 0x0063abcb
006b01a6 : ADD ESP,0xc
006b01a9 : TEST EAX,EAX
006b01ab : JNZ 0x006b02e8
006b01b1 : MOV EDX,dword ptr [ESI + 0x20]
006b01b4 : PUSH ESI
006b01b5 : CALL EDX
006b01b7 : MOV EAX,dword ptr [ESI + 0x24]
006b01ba : PUSH ESI
006b01bb : CALL EAX
006b01bd : LEA ECX,[ESP + 0x24]
006b01c1 : MOV EDI,EAX
006b01c3 : PUSH ECX
006b01c4 : LEA EBX,[ESP + 0x20]
006b01c8 : MOV dword ptr [ESP + 0x34],EDI
006b01cc : CALL 0x006afba0
006b01d1 : ADD ESP,0xc
006b01d4 : TEST EAX,EAX
006b01d6 : JZ 0x006b02fb
006b01dc : MOV EDX,dword ptr [ESI + 0x20]
006b01df : PUSH ESI
006b01e0 : CALL EDX
006b01e2 : ADD ESP,0x4
006b01e5 : CMP dword ptr [ESI + 0xc],0x0
006b01e9 : JNZ 0x006b02fb
006b01ef : MOV EAX,dword ptr [ESI + 0x1c]
006b01f2 : PUSH ESI
006b01f3 : CALL EAX
006b01f5 : MOV ECX,dword ptr [ESI]
006b01f7 : PUSH 0x3
006b01f9 : PUSH 0xbeb878
006b01fe : PUSH ECX
006b01ff : CALL 0x0063abcb
006b0204 : ADD ESP,0x10
006b0207 : TEST EAX,EAX
006b0209 : JNZ 0x006b021a
006b020b : MOV EDX,dword ptr [ESI + 0x20]
006b020e : PUSH ESI
006b020f : CALL EDX
006b0211 : MOV EAX,dword ptr [ESI + 0x1c]
006b0214 : PUSH ESI
006b0215 : CALL EAX
006b0217 : ADD ESP,0x8
006b021a : CMP dword ptr [ESI + 0x138],0x0
006b0221 : JNZ 0x006b02d5
006b0227 : MOV ECX,dword ptr [ESP + 0x30]
006b022b : MOV EAX,dword ptr [ECX + 0xa8]
006b0231 : TEST EAX,EAX
006b0233 : JL 0x006b02b9
006b0239 : MOV EDI,dword ptr [ESP + 0x14]
006b023d : CMP EDI,EAX
006b023f : JL 0x006b0303
006b0245 : MOV EAX,dword ptr [ESP + 0x18]
006b0249 : LEA EDX,[ESP + 0x34]
006b024d : PUSH EDX
006b024e : PUSH EDI
006b024f : PUSH EAX
006b0250 : CALL 0x00688c00
006b0255 : MOV EBX,EAX
006b0257 : MOV EAX,dword ptr [ESP + 0x40]
006b025b : ADD ESP,0xc
006b025e : TEST EAX,EAX
006b0260 : JNZ 0x006b0308
006b0266 : MOV ECX,dword ptr [ESP + 0x1c]
006b026a : PUSH EDI
006b026b : PUSH ECX
006b026c : PUSH EBX
006b026d : CALL 0x0063ae40
006b0272 : MOV EDX,dword ptr [ESP + 0x30]
006b0276 : MOV EAX,dword ptr [EDX + 0x10]
006b0279 : PUSH 0x10ea
006b027e : PUSH EDI
006b027f : PUSH EBX
006b0280 : CALL EAX
006b0282 : MOV ECX,dword ptr [ESP + 0x48]
006b0286 : MOV EAX,dword ptr [ECX + 0xa8]
006b028c : MOV EDX,dword ptr [ESP + 0x40]
006b0290 : SUB EDI,EAX
006b0292 : PUSH EDI
006b0293 : ADD EAX,EBX
006b0295 : PUSH EAX
006b0296 : MOV EAX,dword ptr [EBP + 0x2c]
006b0299 : PUSH EDX
006b029a : PUSH EBP
006b029b : MOV dword ptr [ESP + 0x3c],EDI
006b029f : CALL EAX
006b02a1 : MOV ECX,dword ptr [ESP + 0x40]
006b02a5 : PUSH EBX
006b02a6 : PUSH ECX
006b02a7 : MOV dword ptr [ESP + 0x64],EAX
006b02ab : CALL 0x00687f30
006b02b0 : MOV EAX,dword ptr [ESP + 0x64]
006b02b4 : ADD ESP,0x30
006b02b7 : JMP 0x006b02d1
006b02b9 : MOV EDX,dword ptr [ESP + 0x14]
006b02bd : MOV EAX,dword ptr [ESP + 0x1c]
006b02c1 : MOV ECX,dword ptr [EBP + 0x2c]
006b02c4 : PUSH EDX
006b02c5 : PUSH EAX
006b02c6 : PUSH EDI
006b02c7 : PUSH EBP
006b02c8 : CALL ECX
006b02ca : ADD ESP,0x10
006b02cd : MOV dword ptr [ESP + 0x34],EAX
006b02d1 : TEST EAX,EAX
006b02d3 : JNZ 0x006b0308
006b02d5 : MOV EAX,dword ptr [ESP + 0x20]
006b02d9 : INC EAX
006b02da : CMP EAX,dword ptr [ESP + 0x10]
006b02de : MOV dword ptr [ESP + 0x20],EAX
006b02e2 : JL 0x006b0197
006b02e8 : CMP dword ptr [ESI + 0x138],0x0
006b02ef : JNZ 0x006b02fb
006b02f1 : MOV EDX,dword ptr [ESP + 0x10]
006b02f5 : MOV dword ptr [ESI + 0x138],EDX
006b02fb : POP EDI
006b02fc : POP ESI
006b02fd : POP EBP
006b02fe : POP EBX
006b02ff : ADD ESP,0x1c
006b0302 : RET
006b0303 : MOV EAX,0x3
006b0308 : POP EDI
006b0309 : MOV dword ptr [ESI + 0xc],EAX
006b030c : POP ESI
006b030d : POP EBP
006b030e : POP EBX
006b030f : ADD ESP,0x1c
006b0312 : RET

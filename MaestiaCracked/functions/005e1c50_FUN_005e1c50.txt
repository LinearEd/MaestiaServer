PROGRAM  : Maestia.exe
FUNCTION : FUN_005e1c50
ENTRY    : 005e1c50
BODY     : [[005e1c50, 005e1d5e]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005e1c50(undefined4 param_1,undefined4 *param_2,uint param_3)

{
  undefined2 *puVar1;
  uint *puVar2;
  int *piVar3;
  int iVar4;
  int *in_ECX;
  uint uVar5;
  uint uVar6;
  int iVar7;
  
  piVar3 = (int *)*in_ECX;
  if (piVar3 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar3 * 5) <= piVar3[1] * 4 + 4U) goto LAB_005e1c8a;
    iVar7 = piVar3[1] * 2 + 2;
  }
  FUN_005e10a0(param_1,iVar7);
LAB_005e1c8a:
  piVar3 = (int *)*in_ECX;
  param_3 = param_3 & piVar3[1];
  *piVar3 = *piVar3 + 1;
  iVar7 = *in_ECX;
  iVar4 = *(int *)(iVar7 + 8 + param_3 * 8);
  if (iVar4 == -2) {
    *(undefined4 *)(iVar7 + 8 + param_3 * 8) = 0xffffffff;
    puVar1 = (undefined2 *)(iVar7 + 0xc + param_3 * 8);
    *puVar1 = *(undefined2 *)param_2;
    puVar1[1] = *(undefined2 *)((int)param_2 + 2);
    return;
  }
  uVar5 = param_3;
  do {
    uVar5 = uVar5 + 1 & *(uint *)(iVar7 + 4);
  } while (*(int *)(iVar7 + 8 + uVar5 * 8) != -2);
  uVar6 = (uint)*(ushort *)(iVar7 + 0xc + param_3 * 8) & *(uint *)(iVar7 + 4);
  piVar3 = (int *)(iVar7 + 8 + uVar5 * 8);
  if (uVar6 != param_3) {
    puVar2 = (uint *)(iVar7 + 8 + uVar6 * 8);
    for (uVar6 = *(uint *)(iVar7 + 8 + uVar6 * 8); uVar6 != param_3;
        uVar6 = *(uint *)(iVar7 + 8 + uVar6 * 8)) {
      uVar6 = *puVar2;
      puVar2 = (uint *)(iVar7 + 8 + uVar6 * 8);
    }
    if (piVar3 != (int *)0x0) {
      *piVar3 = iVar4;
      *(undefined2 *)(piVar3 + 1) = *(undefined2 *)(iVar7 + 0xc + param_3 * 8);
      *(undefined2 *)((int)piVar3 + 6) = *(undefined2 *)(iVar7 + 0xe + param_3 * 8);
    }
    *puVar2 = uVar5;
    *(undefined4 *)(iVar7 + 0xc + param_3 * 8) = *param_2;
    *(undefined4 *)(iVar7 + 8 + param_3 * 8) = 0xffffffff;
    return;
  }
  if (piVar3 != (int *)0x0) {
    *piVar3 = iVar4;
    *(undefined2 *)(piVar3 + 1) = *(undefined2 *)(iVar7 + 0xc + param_3 * 8);
    *(undefined2 *)((int)piVar3 + 6) = *(undefined2 *)(iVar7 + 0xe + param_3 * 8);
  }
  *(undefined4 *)(iVar7 + 0xc + param_3 * 8) = *param_2;
  *(uint *)(iVar7 + 8 + param_3 * 8) = uVar5;
  return;
}



============================================================
DISASSEMBLY
============================================================
005e1c50 : PUSH EBP
005e1c51 : PUSH ESI
005e1c52 : MOV ESI,ECX
005e1c54 : MOV EAX,dword ptr [ESI]
005e1c56 : TEST EAX,EAX
005e1c58 : JNZ 0x005e1c63
005e1c5a : MOV EAX,dword ptr [ESP + 0xc]
005e1c5e : PUSH 0x8
005e1c60 : PUSH EAX
005e1c61 : JMP 0x005e1c85
005e1c63 : MOV ECX,dword ptr [EAX + 0x4]
005e1c66 : LEA EDX,[ECX*0x4 + 0x4]
005e1c6d : MOV ECX,dword ptr [EAX]
005e1c6f : LEA ECX,[ECX + ECX*0x4]
005e1c72 : CMP ECX,EDX
005e1c74 : JBE 0x005e1c8a
005e1c76 : MOV EDX,dword ptr [EAX + 0x4]
005e1c79 : MOV ECX,dword ptr [ESP + 0xc]
005e1c7d : LEA EAX,[EDX + EDX*0x1 + 0x2]
005e1c81 : PUSH EAX
005e1c82 : PUSH ECX
005e1c83 : MOV ECX,ESI
005e1c85 : CALL 0x005e10a0
005e1c8a : MOV EAX,dword ptr [ESI]
005e1c8c : MOV ECX,dword ptr [ESP + 0x14]
005e1c90 : AND ECX,dword ptr [EAX + 0x4]
005e1c93 : INC dword ptr [EAX]
005e1c95 : MOV EAX,dword ptr [ESI]
005e1c97 : MOV EBP,dword ptr [EAX + ECX*0x8 + 0x8]
005e1c9b : MOV ESI,0xfffffffe
005e1ca0 : CMP EBP,ESI
005e1ca2 : JNZ 0x005e1cc7
005e1ca4 : MOV dword ptr [EAX + ECX*0x8 + 0x8],0xffffffff
005e1cac : LEA EAX,[EAX + ECX*0x8 + 0xc]
005e1cb0 : MOV ECX,dword ptr [ESP + 0x10]
005e1cb4 : MOV DX,word ptr [ECX]
005e1cb7 : MOV word ptr [EAX],DX
005e1cba : MOV CX,word ptr [ECX + 0x2]
005e1cbe : POP ESI
005e1cbf : MOV word ptr [EAX + 0x2],CX
005e1cc3 : POP EBP
005e1cc4 : RET 0xc
005e1cc7 : PUSH EBX
005e1cc8 : MOV EBX,dword ptr [EAX + 0x4]
005e1ccb : MOV EDX,ECX
005e1ccd : LEA ECX,[ECX]
005e1cd0 : INC EDX
005e1cd1 : AND EDX,EBX
005e1cd3 : CMP dword ptr [EAX + EDX*0x8 + 0x8],ESI
005e1cd7 : JNZ 0x005e1cd0
005e1cd9 : MOVZX ESI,word ptr [EAX + ECX*0x8 + 0xc]
005e1cde : AND ESI,EBX
005e1ce0 : PUSH EDI
005e1ce1 : LEA EDI,[EAX + EDX*0x8 + 0x8]
005e1ce5 : CMP ESI,ECX
005e1ce7 : JNZ 0x005e1d16
005e1ce9 : TEST EDI,EDI
005e1ceb : JZ 0x005e1d01
005e1ced : MOV dword ptr [EDI],EBP
005e1cef : MOVZX ESI,word ptr [EAX + ECX*0x8 + 0xc]
005e1cf4 : MOV word ptr [EDI + 0x4],SI
005e1cf8 : MOVZX ESI,word ptr [EAX + ECX*0x8 + 0xe]
005e1cfd : MOV word ptr [EDI + 0x6],SI
005e1d01 : MOV ESI,dword ptr [ESP + 0x18]
005e1d05 : MOV ESI,dword ptr [ESI]
005e1d07 : POP EDI
005e1d08 : POP EBX
005e1d09 : MOV dword ptr [EAX + ECX*0x8 + 0xc],ESI
005e1d0d : POP ESI
005e1d0e : MOV dword ptr [EAX + ECX*0x8 + 0x8],EDX
005e1d12 : POP EBP
005e1d13 : RET 0xc
005e1d16 : CMP dword ptr [EAX + ESI*0x8 + 0x8],ECX
005e1d1a : LEA ESI,[EAX + ESI*0x8 + 0x8]
005e1d1e : JZ 0x005e1d2c
005e1d20 : MOV ESI,dword ptr [ESI]
005e1d22 : CMP dword ptr [EAX + ESI*0x8 + 0x8],ECX
005e1d26 : LEA ESI,[EAX + ESI*0x8 + 0x8]
005e1d2a : JNZ 0x005e1d20
005e1d2c : TEST EDI,EDI
005e1d2e : JZ 0x005e1d44
005e1d30 : MOV dword ptr [EDI],EBP
005e1d32 : MOVZX EBX,word ptr [EAX + ECX*0x8 + 0xc]
005e1d37 : MOV word ptr [EDI + 0x4],BX
005e1d3b : MOVZX EBX,word ptr [EAX + ECX*0x8 + 0xe]
005e1d40 : MOV word ptr [EDI + 0x6],BX
005e1d44 : MOV dword ptr [ESI],EDX
005e1d46 : MOV EDX,dword ptr [ESP + 0x18]
005e1d4a : MOV EDX,dword ptr [EDX]
005e1d4c : POP EDI
005e1d4d : POP EBX
005e1d4e : POP ESI
005e1d4f : MOV dword ptr [EAX + ECX*0x8 + 0xc],EDX
005e1d53 : MOV dword ptr [EAX + ECX*0x8 + 0x8],0xffffffff
005e1d5b : POP EBP
005e1d5c : RET 0xc

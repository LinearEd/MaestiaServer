PROGRAM  : Maestia.exe
FUNCTION : FUN_00998510
ENTRY    : 00998510
BODY     : [[00998510, 009986e1]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00998510(undefined4 param_1)

{
  int iVar1;
  int *piVar2;
  uint uVar3;
  undefined4 uVar4;
  uint8_t *packet;
  byte bVar5;
  uint local_a8;
  undefined1 local_a4 [4];
  undefined2 local_a0;
  undefined4 local_90;
  uint local_8c;
  undefined4 local_88;
  uint8_t *local_84;
  undefined4 local_80 [26];
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b40eeb;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar1 = *(int *)(*(int *)(*DAT_00da9894 + 0x150) + 4);
  local_18 = uVar3;
  if (iVar1 != 0) {
    FUN_00412470(local_80);
    local_8 = 0;
    local_88 = param_1;
    FUN_004437f0(&local_88);
    if (local_84 == *(uint8_t **)(iVar1 + 4)) {
      FUN_00406460(L"IDS_MSGCLTNET_ERR_NOTFRIENDLIST");
      local_8._0_1_ = 1;
      piVar2 = *(int **)(*DAT_00da9894 + 0x1a8);
      uVar4 = FUN_0081d120(local_a4);
      local_8._0_1_ = 2;
      (**(code **)(*piVar2 + 0x44))(uVar4,3,uVar3);
      local_8 = CONCAT31(local_8._1_3_,1);
      if (7 < local_a8) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_8 = (uint)local_8._1_3_ << 8;
      if (7 < local_8c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_8c = 7;
      local_90 = 0;
      local_a0 = 0;
    }
    else {
      FUN_00421460();
      iVar1 = *(int *)ThreadLocalStoragePointer;
      bVar5 = (byte)((ulonglong)(*(byte *)(iVar1 + 0x18) + 1) % 3);
      *(byte *)(iVar1 + 0x18) = bVar5;
      local_84 = (uint8_t *)((uint)bVar5 * 0x2000 + 0x122cb8 + iVar1);
      if (local_84 == (uint8_t *)0x0) {
        packet = (uint8_t *)0x0;
      }
      else {
        local_84[0] = '\0';
        local_84[1] = '\0';
        local_84[2] = '_';
        local_84[3] = '\x13';
        *(undefined4 *)(local_84 + 4) = local_80[0];
        packet = local_84;
      }
      local_8 = local_8 & 0xffffff00;
      if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
        FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),8,packet);
      }
    }
    local_8 = 0xffffffff;
    FUN_00411330(local_80);
  }
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00998510 : PUSH EBP
00998511 : MOV EBP,ESP
00998513 : PUSH -0x1
00998515 : PUSH 0xb40eeb
0099851a : MOV EAX,FS:[0x0]
00998520 : PUSH EAX
00998521 : SUB ESP,0xb4
00998527 : MOV EAX,[0x00d66fa0]
0099852c : XOR EAX,EBP
0099852e : MOV dword ptr [EBP + -0x14],EAX
00998531 : PUSH ESI
00998532 : PUSH EDI
00998533 : PUSH EAX
00998534 : LEA EAX,[EBP + -0xc]
00998537 : MOV FS:[0x0],EAX
0099853d : MOV EAX,[0x00da9894]
00998542 : MOV EAX,dword ptr [EAX]
00998544 : MOV EAX,dword ptr [EAX + 0x150]
0099854a : MOV ESI,dword ptr [EAX + 0x4]
0099854d : TEST ESI,ESI
0099854f : JZ 0x009986c5
00998555 : LEA ECX,[EBP + -0x7c]
00998558 : PUSH ECX
00998559 : CALL 0x00412470
0099855e : MOV dword ptr [EBP + -0x4],0x0
00998565 : MOV EDX,dword ptr [EBP + 0x8]
00998568 : LEA EAX,[EBP + 0xffffff7c]
0099856e : PUSH EAX
0099856f : LEA EAX,[EBP + -0x80]
00998572 : MOV ECX,ESI
00998574 : MOV dword ptr [EBP + 0xffffff7c],EDX
0099857a : CALL 0x004437f0
0099857f : MOV ESI,dword ptr [ESI + 0x4]
00998582 : MOV EAX,dword ptr [EBP + -0x80]
00998585 : CMP EAX,ESI
00998587 : JZ 0x009985e0
00998589 : MOV EDI,dword ptr [EAX + 0x10]
0099858c : LEA ESI,[EBP + -0x7c]
0099858f : CALL 0x00421460
00998594 : MOV EAX,FS:[0x2c]
0099859a : MOV ECX,dword ptr [EAX]
0099859c : MOVZX EAX,byte ptr [ECX + 0x18]
009985a0 : INC EAX
009985a1 : CDQ
009985a2 : MOV ESI,0x3
009985a7 : IDIV ESI
009985a9 : MOV byte ptr [ECX + 0x18],DL
009985ac : MOVZX EDX,DL
009985af : SHL EDX,0xd
009985b2 : LEA EAX,[EDX + ECX*0x1 + 0x122cb8]
009985b9 : MOV dword ptr [EBP + -0x80],EAX
009985bc : MOV byte ptr [EBP + -0x4],0x3
009985c0 : TEST EAX,EAX
009985c2 : JZ 0x00998692
009985c8 : MOV EDX,dword ptr [EBP + -0x7c]
009985cb : XOR ECX,ECX
009985cd : MOV word ptr [EAX],CX
009985d0 : MOV byte ptr [EAX + 0x2],0x5f
009985d4 : MOV byte ptr [EAX + 0x3],0x13
009985d8 : MOV dword ptr [EAX + 0x4],EDX
009985db : JMP 0x00998694
009985e0 : PUSH 0xc87748
009985e5 : LEA ECX,[EBP + 0xffffff60]
009985eb : CALL 0x00406460
009985f0 : MOV byte ptr [EBP + -0x4],0x1
009985f4 : MOV ECX,dword ptr [0x00da9894]
009985fa : MOV EAX,dword ptr [ECX]
009985fc : MOV ECX,dword ptr [0x0172491c]
00998602 : MOV ESI,dword ptr [EAX + 0x1a8]
00998608 : LEA EDX,[EBP + 0xffffff60]
0099860e : PUSH EDX
0099860f : LEA EDI,[EBP + 0xffffff44]
00998615 : CALL 0x0081d120
0099861a : MOV byte ptr [EBP + -0x4],0x2
0099861e : MOV EDX,dword ptr [ESI]
00998620 : PUSH 0x3
00998622 : PUSH EAX
00998623 : MOV EAX,dword ptr [EDX + 0x44]
00998626 : MOV ECX,ESI
00998628 : CALL EAX
0099862a : MOV byte ptr [EBP + -0x4],0x1
0099862e : MOV ESI,0x8
00998633 : CMP dword ptr [EBP + 0xffffff5c],ESI
00998639 : JC 0x00998646
0099863b : MOV ECX,dword ptr [EBP + 0xffffff48]
00998641 : CALL 0x006f04e0
00998646 : XOR ECX,ECX
00998648 : XOR EDI,EDI
0099864a : MOV dword ptr [EBP + 0xffffff5c],0x7
00998654 : MOV dword ptr [EBP + 0xffffff58],EDI
0099865a : MOV word ptr [EBP + 0xffffff48],CX
00998661 : MOV byte ptr [EBP + -0x4],CL
00998664 : CMP dword ptr [EBP + 0xffffff78],ESI
0099866a : JC 0x00998677
0099866c : MOV ECX,dword ptr [EBP + 0xffffff64]
00998672 : CALL 0x006f04e0
00998677 : XOR EDX,EDX
00998679 : MOV dword ptr [EBP + 0xffffff78],0x7
00998683 : MOV dword ptr [EBP + 0xffffff74],EDI
00998689 : MOV word ptr [EBP + 0xffffff64],DX
00998690 : JMP 0x009986b5
00998692 : XOR EAX,EAX
00998694 : MOV byte ptr [EBP + -0x4],0x0
00998698 : MOV EDX,dword ptr [0x017247d4]
0099869e : MOV ECX,dword ptr [EDX + 0x4]
009986a1 : TEST ECX,ECX
009986a3 : JZ 0x009986b5
009986a5 : CMP byte ptr [EDX + 0x8],0x0
009986a9 : JZ 0x009986b5
009986ab : PUSH 0x8
009986ad : PUSH ECX
009986ae : MOV EDI,EAX
009986b0 : CALL 0x00a0dd40
009986b5 : MOV dword ptr [EBP + -0x4],0xffffffff
009986bc : LEA EAX,[EBP + -0x7c]
009986bf : PUSH EAX
009986c0 : CALL 0x00411330
009986c5 : MOV ECX,dword ptr [EBP + -0xc]
009986c8 : MOV dword ptr FS:[0x0],ECX
009986cf : POP ECX
009986d0 : POP EDI
009986d1 : POP ESI
009986d2 : MOV ECX,dword ptr [EBP + -0x14]
009986d5 : XOR ECX,EBP
009986d7 : CALL 0x00633e6b
009986dc : MOV ESP,EBP
009986de : POP EBP
009986df : RET 0x4

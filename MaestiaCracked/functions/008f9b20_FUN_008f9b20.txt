PROGRAM  : Maestia.exe
FUNCTION : FUN_008f9b20
ENTRY    : 008f9b20
BODY     : [[008f9b20, 008f9c40]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */
/* WARNING: Removing unreachable block (ram,0x008f9bfd) */

void FUN_008f9b20(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  short sVar1;
  short *psVar2;
  undefined4 in_ECX;
  int unaff_ESI;
  short local_4014;
  undefined1 local_4012 [16382];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b2c390;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *(undefined4 *)(unaff_ESI + 0x20) = param_2;
  *(undefined4 *)(unaff_ESI + 0xc) = in_ECX;
  local_4014 = 0;
  FUN_008f8f70(&local_4014);
  psVar2 = &local_4014;
  do {
    sVar1 = *psVar2;
    psVar2 = psVar2 + 1;
  } while (sVar1 != 0);
  FUN_00406360(&local_4014,(int)psVar2 - (int)local_4012 >> 1);
  local_8 = 0;
  FUN_008f7df0(param_2,0,param_3);
  local_8 = 0xffffffff;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008f9b20 : PUSH EBP
008f9b21 : MOV EBP,ESP
008f9b23 : PUSH -0x1
008f9b25 : PUSH 0xb2c390
008f9b2a : MOV EAX,FS:[0x0]
008f9b30 : PUSH EAX
008f9b31 : MOV EAX,0x4020
008f9b36 : CALL 0x0063b780
008f9b3b : MOV EAX,[0x00d66fa0]
008f9b40 : XOR EAX,EBP
008f9b42 : MOV dword ptr [EBP + -0x10],EAX
008f9b45 : PUSH EBX
008f9b46 : PUSH EAX
008f9b47 : LEA EAX,[EBP + -0xc]
008f9b4a : MOV FS:[0x0],EAX
008f9b50 : MOV EBX,dword ptr [EBP + 0xc]
008f9b53 : MOV EAX,dword ptr [EBP + 0x8]
008f9b56 : XOR EDX,EDX
008f9b58 : MOV dword ptr [ESI + 0x20],EBX
008f9b5b : MOV dword ptr [ESI + 0xc],ECX
008f9b5e : CMP dword ptr [EAX + 0x18],0x8
008f9b62 : MOV word ptr [EBP + 0xffffbff0],DX
008f9b69 : JC 0x008f9b70
008f9b6b : MOV EAX,dword ptr [EAX + 0x4]
008f9b6e : JMP 0x008f9b73
008f9b70 : ADD EAX,0x4
008f9b73 : LEA ECX,[EBP + 0xffffbff0]
008f9b79 : PUSH ECX
008f9b7a : MOV EDX,EAX
008f9b7c : MOV ECX,ESI
008f9b7e : CALL 0x008f8f70
008f9b83 : XOR EDX,EDX
008f9b85 : LEA EAX,[EBP + 0xffffbff0]
008f9b8b : MOV word ptr [EBP + 0xffffbfd8],DX
008f9b92 : MOV dword ptr [EBP + 0xffffbfec],0x7
008f9b9c : MOV dword ptr [EBP + 0xffffbfe8],0x0
008f9ba6 : LEA EDX,[EAX + 0x2]
008f9ba9 : LEA ESP,[ESP]
008f9bb0 : MOV CX,word ptr [EAX]
008f9bb3 : ADD EAX,0x2
008f9bb6 : TEST CX,CX
008f9bb9 : JNZ 0x008f9bb0
008f9bbb : SUB EAX,EDX
008f9bbd : SAR EAX,0x1
008f9bbf : PUSH EAX
008f9bc0 : LEA EAX,[EBP + 0xffffbff0]
008f9bc6 : PUSH EAX
008f9bc7 : LEA ECX,[EBP + 0xffffbfd4]
008f9bcd : CALL 0x00406360
008f9bd2 : MOV dword ptr [EBP + -0x4],0x0
008f9bd9 : MOV ECX,dword ptr [EBP + 0x10]
008f9bdc : PUSH ECX
008f9bdd : PUSH 0x0
008f9bdf : PUSH EBX
008f9be0 : LEA EDX,[EBP + 0xffffbfd4]
008f9be6 : MOV EAX,ESI
008f9be8 : CALL 0x008f7df0
008f9bed : MOV dword ptr [EBP + -0x4],0xffffffff
008f9bf4 : CMP dword ptr [EBP + 0xffffbfec],0x8
008f9bfb : JC 0x008f9c08
008f9bfd : MOV ECX,dword ptr [EBP + 0xffffbfd8]
008f9c03 : CALL 0x006f04e0
008f9c08 : XOR EDX,EDX
008f9c0a : MOV dword ptr [EBP + 0xffffbfec],0x7
008f9c14 : MOV dword ptr [EBP + 0xffffbfe8],0x0
008f9c1e : MOV word ptr [EBP + 0xffffbfd8],DX
008f9c25 : MOV ECX,dword ptr [EBP + -0xc]
008f9c28 : MOV dword ptr FS:[0x0],ECX
008f9c2f : POP ECX
008f9c30 : POP EBX
008f9c31 : MOV ECX,dword ptr [EBP + -0x10]
008f9c34 : XOR ECX,EBP
008f9c36 : CALL 0x00633e6b
008f9c3b : MOV ESP,EBP
008f9c3d : POP EBP
008f9c3e : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_00607d60
ENTRY    : 00607d60
BODY     : [[00607d60, 00608013]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00607d60(uint param_1)

{
  uint *puVar1;
  bool bVar2;
  undefined4 uVar3;
  int in_ECX;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint local_20;
  uint local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  uint local_8;
  int local_4;
  
  puVar1 = (uint *)(in_ECX + 0x3c);
  bVar2 = false;
  local_20 = 0x7fffffff;
  local_1c = 0;
  *puVar1 = 0;
  uVar5 = param_1;
  local_4 = in_ECX;
  while( true ) {
    uVar4 = *puVar1 >> 6;
    local_8 = uVar5;
    if (*(uint *)(in_ECX + 0x40) <= uVar4) {
      if (*(uint *)(in_ECX + 0x44) <= uVar4) {
        if (*(int *)(in_ECX + 0x48) == 0) {
          local_18 = 0x88;
          uVar3 = FUN_00515d60(puVar1,0x40,&local_18);
        }
        else {
          uVar3 = FUN_00515c80(*(int *)(in_ECX + 0x48),*(uint *)(in_ECX + 0x44) * 4 + 0x40);
        }
        *(int *)(in_ECX + 0x44) = *(int *)(in_ECX + 0x44) + 0x10;
        *(undefined4 *)(in_ECX + 0x48) = uVar3;
      }
      local_14 = 0x88;
      uVar3 = FUN_00515d60(puVar1,0x100,&local_14);
      *(undefined4 *)(*(int *)(in_ECX + 0x48) + uVar4 * 4) = uVar3;
      *(int *)(in_ECX + 0x40) = *(int *)(in_ECX + 0x40) + 1;
    }
    *(uint *)(*(int *)(*(int *)(in_ECX + 0x48) + uVar4 * 4) + (*puVar1 & 0x3f) * 4) = uVar5;
    *puVar1 = *puVar1 + 1;
    uVar4 = *(uint *)(&DAT_00b95760 + (uVar5 & 3) * 4);
    uVar6 = uVar5 & 0xfffffffc | uVar4;
    uVar5 = *puVar1 >> 6;
    if (*(uint *)(in_ECX + 0x40) <= uVar5) {
      if (*(uint *)(in_ECX + 0x44) <= uVar5) {
        if (*(int *)(in_ECX + 0x48) == 0) {
          local_10 = 0x88;
          uVar3 = FUN_00515d60(puVar1,0x40,&local_10);
        }
        else {
          uVar3 = FUN_00515c80(*(int *)(in_ECX + 0x48),*(uint *)(in_ECX + 0x44) * 4 + 0x40);
        }
        *(int *)(in_ECX + 0x44) = *(int *)(in_ECX + 0x44) + 0x10;
        *(undefined4 *)(in_ECX + 0x48) = uVar3;
      }
      local_c = 0x88;
      uVar3 = FUN_00515d60(puVar1,0x100,&local_c);
      *(undefined4 *)(*(int *)(in_ECX + 0x48) + uVar5 * 4) = uVar3;
      *(int *)(in_ECX + 0x40) = *(int *)(in_ECX + 0x40) + 1;
    }
    *(uint *)(*(int *)(*(int *)(in_ECX + 0x48) + uVar5 * 4) + (*puVar1 & 0x3f) * 4) = uVar6;
    *puVar1 = *puVar1 + 1;
    if ((local_8 == local_20) || (uVar6 == local_20)) goto LAB_00608002;
    uVar5 = *(uint *)(*(int *)(*(int *)(in_ECX + 0x2c) + ((uint)((int)uVar6 >> 2) >> 8) * 4) + 0x1c
                     + (((int)uVar6 >> 2 & 0xffU) * 0xf + (uVar4 & 3)) * 4);
    if (uVar5 == param_1) break;
    if ((int)uVar5 < 0) goto LAB_00607efd;
    local_20 = *(uint *)(*(int *)(*(int *)(in_ECX + 0x48) + (local_1c >> 6) * 4) +
                        (local_1c & 0x3f) * 4);
    local_1c = local_1c + 1;
  }
  bVar2 = true;
LAB_00607efd:
  FUN_00606ed0(puVar1);
  if (!bVar2) {
    uVar5 = *(uint *)(*(int *)(*(int *)(in_ECX + 0x2c) + ((uint)((int)param_1 >> 2) >> 8) * 4) +
                      0x1c + (((int)param_1 >> 2 & 0xffU) * 0xf + (param_1 & 3)) * 4);
    while( true ) {
      if ((int)uVar5 < 0) {
        return 0;
      }
      uVar4 = *puVar1 >> 6;
      if (*(uint *)(in_ECX + 0x40) <= uVar4) {
        FUN_00606e60(uVar4);
      }
      *(uint *)(*(int *)(*(int *)(in_ECX + 0x48) + uVar4 * 4) + (*puVar1 & 0x3f) * 4) = uVar5;
      *puVar1 = *puVar1 + 1;
      uVar4 = (&DAT_00b9575c)[uVar5 & 3];
      uVar7 = uVar5 & 0xfffffffc | uVar4;
      uVar6 = *puVar1 >> 6;
      if (*(uint *)(in_ECX + 0x40) <= uVar6) {
        FUN_00606e60(uVar6);
      }
      *(uint *)(*(int *)(*(int *)(in_ECX + 0x48) + uVar6 * 4) + (*puVar1 & 0x3f) * 4) = uVar7;
      *puVar1 = *puVar1 + 1;
      if ((uVar5 == local_20) || (uVar7 == local_20)) break;
      local_20 = *(uint *)(*(int *)(*(int *)(local_4 + 0x48) + (local_1c >> 6) * 4) +
                          (local_1c & 0x3f) * 4);
      uVar5 = *(uint *)(*(int *)(*(int *)(local_4 + 0x2c) + ((uint)((int)uVar7 >> 2) >> 8) * 4) +
                        0x1c + (((int)uVar7 >> 2 & 0xffU) * 0xf + (uVar4 & 3)) * 4);
      local_1c = local_1c + 1;
    }
LAB_00608002:
    *puVar1 = 0;
  }
  return 1;
}



============================================================
DISASSEMBLY
============================================================
00607d60 : SUB ESP,0x24
00607d63 : PUSH EBX
00607d64 : PUSH EBP
00607d65 : MOV EBX,ECX
00607d67 : PUSH ESI
00607d68 : LEA ESI,[EBX + 0x3c]
00607d6b : PUSH EDI
00607d6c : MOV EDI,dword ptr [ESP + 0x38]
00607d70 : MOV dword ptr [ESP + 0x30],EBX
00607d74 : MOV byte ptr [ESP + 0x13],0x0
00607d79 : MOV dword ptr [ESP + 0x14],0x7fffffff
00607d81 : MOV dword ptr [ESP + 0x18],0x0
00607d89 : MOV dword ptr [ESI],0x0
00607d8f : NOP
00607d90 : MOV EBP,dword ptr [ESI]
00607d92 : SHR EBP,0x6
00607d95 : MOV dword ptr [ESP + 0x2c],EDI
00607d99 : CMP EBP,dword ptr [ESI + 0x4]
00607d9c : JC 0x00607df9
00607d9e : MOV ECX,dword ptr [ESI + 0x8]
00607da1 : CMP EBP,ECX
00607da3 : JC 0x00607dd8
00607da5 : MOV EAX,dword ptr [ESI + 0xc]
00607da8 : TEST EAX,EAX
00607daa : JZ 0x00607dbc
00607dac : LEA ECX,[ECX*0x4 + 0x40]
00607db3 : PUSH ECX
00607db4 : PUSH EAX
00607db5 : CALL 0x00515c80
00607dba : JMP 0x00607dd1
00607dbc : LEA EAX,[ESP + 0x1c]
00607dc0 : PUSH EAX
00607dc1 : PUSH 0x40
00607dc3 : PUSH ESI
00607dc4 : MOV dword ptr [ESP + 0x28],0x88
00607dcc : CALL 0x00515d60
00607dd1 : ADD dword ptr [ESI + 0x8],0x10
00607dd5 : MOV dword ptr [ESI + 0xc],EAX
00607dd8 : LEA ECX,[ESP + 0x20]
00607ddc : PUSH ECX
00607ddd : PUSH 0x100
00607de2 : PUSH ESI
00607de3 : MOV dword ptr [ESP + 0x2c],0x88
00607deb : CALL 0x00515d60
00607df0 : MOV EDX,dword ptr [ESI + 0xc]
00607df3 : MOV dword ptr [EDX + EBP*0x4],EAX
00607df6 : INC dword ptr [ESI + 0x4]
00607df9 : MOV EAX,dword ptr [ESI + 0xc]
00607dfc : MOV EDX,dword ptr [EAX + EBP*0x4]
00607dff : MOV ECX,dword ptr [ESI]
00607e01 : AND ECX,0x3f
00607e04 : MOV dword ptr [EDX + ECX*0x4],EDI
00607e07 : INC dword ptr [ESI]
00607e09 : MOV EBP,dword ptr [ESI]
00607e0b : MOV EAX,EDI
00607e0d : AND EAX,0x3
00607e10 : AND EDI,0xfffffffc
00607e13 : OR EDI,dword ptr [EAX*0x4 + 0xb95760]
00607e1a : SHR EBP,0x6
00607e1d : CMP EBP,dword ptr [ESI + 0x4]
00607e20 : JC 0x00607e7d
00607e22 : MOV ECX,dword ptr [ESI + 0x8]
00607e25 : CMP EBP,ECX
00607e27 : JC 0x00607e5c
00607e29 : MOV EAX,dword ptr [ESI + 0xc]
00607e2c : TEST EAX,EAX
00607e2e : JZ 0x00607e40
00607e30 : LEA ECX,[ECX*0x4 + 0x40]
00607e37 : PUSH ECX
00607e38 : PUSH EAX
00607e39 : CALL 0x00515c80
00607e3e : JMP 0x00607e55
00607e40 : LEA ECX,[ESP + 0x24]
00607e44 : PUSH ECX
00607e45 : PUSH 0x40
00607e47 : PUSH ESI
00607e48 : MOV dword ptr [ESP + 0x30],0x88
00607e50 : CALL 0x00515d60
00607e55 : ADD dword ptr [ESI + 0x8],0x10
00607e59 : MOV dword ptr [ESI + 0xc],EAX
00607e5c : LEA EDX,[ESP + 0x28]
00607e60 : PUSH EDX
00607e61 : PUSH 0x100
00607e66 : PUSH ESI
00607e67 : MOV dword ptr [ESP + 0x34],0x88
00607e6f : CALL 0x00515d60
00607e74 : MOV ECX,dword ptr [ESI + 0xc]
00607e77 : MOV dword ptr [ECX + EBP*0x4],EAX
00607e7a : INC dword ptr [ESI + 0x4]
00607e7d : MOV EAX,dword ptr [ESI]
00607e7f : MOV EDX,dword ptr [ESI + 0xc]
00607e82 : MOV ECX,dword ptr [EDX + EBP*0x4]
00607e85 : AND EAX,0x3f
00607e88 : MOV dword ptr [ECX + EAX*0x4],EDI
00607e8b : MOV EAX,dword ptr [ESP + 0x14]
00607e8f : INC dword ptr [ESI]
00607e91 : CMP dword ptr [ESP + 0x2c],EAX
00607e95 : JZ 0x00608002
00607e9b : CMP EDI,EAX
00607e9d : JZ 0x00608002
00607ea3 : MOV EAX,EDI
00607ea5 : SAR EAX,0x2
00607ea8 : MOV ECX,EAX
00607eaa : AND ECX,0xff
00607eb0 : MOV EDX,ECX
00607eb2 : SHL EDX,0x4
00607eb5 : SUB EDX,ECX
00607eb7 : MOV ECX,dword ptr [EBX + 0x2c]
00607eba : AND EDI,0x3
00607ebd : SHR EAX,0x8
00607ec0 : MOV EAX,dword ptr [ECX + EAX*0x4]
00607ec3 : ADD EDX,EDI
00607ec5 : MOV EDI,dword ptr [EAX + EDX*0x4 + 0x1c]
00607ec9 : CMP EDI,dword ptr [ESP + 0x38]
00607ecd : JZ 0x00607ef8
00607ecf : TEST EDI,EDI
00607ed1 : JL 0x00607efd
00607ed3 : MOV EAX,dword ptr [ESP + 0x18]
00607ed7 : MOV EDX,dword ptr [EBX + 0x48]
00607eda : MOV ECX,EAX
00607edc : SHR ECX,0x6
00607edf : MOV ECX,dword ptr [EDX + ECX*0x4]
00607ee2 : MOV EBP,EAX
00607ee4 : AND EBP,0x3f
00607ee7 : MOV EDX,dword ptr [ECX + EBP*0x4]
00607eea : INC EAX
00607eeb : MOV dword ptr [ESP + 0x14],EDX
00607eef : MOV dword ptr [ESP + 0x18],EAX
00607ef3 : JMP 0x00607d90
00607ef8 : MOV byte ptr [ESP + 0x13],0x1
00607efd : PUSH ESI
00607efe : CALL 0x00606ed0
00607f03 : ADD ESP,0x4
00607f06 : CMP byte ptr [ESP + 0x13],0x0
00607f0b : JNZ 0x00608008
00607f11 : MOV EDX,dword ptr [ESP + 0x38]
00607f15 : MOV EAX,EDX
00607f17 : SAR EAX,0x2
00607f1a : MOV ECX,EAX
00607f1c : AND ECX,0xff
00607f22 : MOV EDI,ECX
00607f24 : SHL EDI,0x4
00607f27 : SUB EDI,ECX
00607f29 : MOV ECX,dword ptr [EBX + 0x2c]
00607f2c : AND EDX,0x3
00607f2f : ADD EDI,EDX
00607f31 : SHR EAX,0x8
00607f34 : MOV EDX,dword ptr [ECX + EAX*0x4]
00607f37 : MOV EDI,dword ptr [EDX + EDI*0x4 + 0x1c]
00607f3b : TEST EDI,EDI
00607f3d : JL 0x00607ff6
00607f43 : MOV EBP,dword ptr [ESI]
00607f45 : SHR EBP,0x6
00607f48 : MOV EBX,EDI
00607f4a : CMP EBP,dword ptr [ESI + 0x4]
00607f4d : JC 0x00607f57
00607f4f : PUSH EBP
00607f50 : MOV ECX,ESI
00607f52 : CALL 0x00606e60
00607f57 : MOV EAX,dword ptr [ESI + 0xc]
00607f5a : MOV EDX,dword ptr [EAX + EBP*0x4]
00607f5d : MOV ECX,dword ptr [ESI]
00607f5f : AND ECX,0x3f
00607f62 : MOV dword ptr [EDX + ECX*0x4],EDI
00607f65 : INC dword ptr [ESI]
00607f67 : MOV EBP,dword ptr [ESI]
00607f69 : MOV EAX,EDI
00607f6b : AND EAX,0x3
00607f6e : AND EDI,0xfffffffc
00607f71 : OR EDI,dword ptr [EAX*0x4 + 0xb9575c]
00607f78 : SHR EBP,0x6
00607f7b : CMP EBP,dword ptr [ESI + 0x4]
00607f7e : JC 0x00607f88
00607f80 : PUSH EBP
00607f81 : MOV ECX,ESI
00607f83 : CALL 0x00606e60
00607f88 : MOV EDX,dword ptr [ESI]
00607f8a : MOV ECX,dword ptr [ESI + 0xc]
00607f8d : MOV EAX,dword ptr [ECX + EBP*0x4]
00607f90 : AND EDX,0x3f
00607f93 : MOV dword ptr [EAX + EDX*0x4],EDI
00607f96 : MOV EAX,dword ptr [ESP + 0x14]
00607f9a : INC dword ptr [ESI]
00607f9c : CMP EBX,EAX
00607f9e : JZ 0x00608002
00607fa0 : CMP EDI,EAX
00607fa2 : JZ 0x00608002
00607fa4 : MOV EAX,dword ptr [ESP + 0x18]
00607fa8 : MOV EDX,dword ptr [ESP + 0x30]
00607fac : MOV EBX,dword ptr [EDX + 0x48]
00607faf : MOV EDX,dword ptr [EDX + 0x2c]
00607fb2 : MOV ECX,EAX
00607fb4 : MOV EBP,EAX
00607fb6 : INC EAX
00607fb7 : SHR ECX,0x6
00607fba : MOV ECX,dword ptr [EBX + ECX*0x4]
00607fbd : MOV dword ptr [ESP + 0x18],EAX
00607fc1 : AND EBP,0x3f
00607fc4 : MOV ECX,dword ptr [ECX + EBP*0x4]
00607fc7 : MOV EAX,EDI
00607fc9 : SAR EAX,0x2
00607fcc : MOV dword ptr [ESP + 0x14],ECX
00607fd0 : MOV ECX,EAX
00607fd2 : AND ECX,0xff
00607fd8 : MOV EBX,ECX
00607fda : SHL EBX,0x4
00607fdd : AND EDI,0x3
00607fe0 : SUB EBX,ECX
00607fe2 : SHR EAX,0x8
00607fe5 : MOV EAX,dword ptr [EDX + EAX*0x4]
00607fe8 : ADD EBX,EDI
00607fea : MOV EDI,dword ptr [EAX + EBX*0x4 + 0x1c]
00607fee : TEST EDI,EDI
00607ff0 : JGE 0x00607f43
00607ff6 : POP EDI
00607ff7 : POP ESI
00607ff8 : POP EBP
00607ff9 : XOR AL,AL
00607ffb : POP EBX
00607ffc : ADD ESP,0x24
00607fff : RET 0x4
00608002 : MOV dword ptr [ESI],0x0
00608008 : POP EDI
00608009 : POP ESI
0060800a : POP EBP
0060800b : MOV AL,0x1
0060800d : POP EBX
0060800e : ADD ESP,0x24
00608011 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_006a0780
ENTRY    : 006a0780
BODY     : [[006a0780, 006a086c] [006a0870, 006a0a59]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006a0780(int param_1)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  uint uVar5;
  char *pcVar6;
  uint uVar7;
  undefined4 *puVar8;
  int local_18;
  undefined4 local_14;
  int local_10;
  int local_c;
  uint local_8;
  uint local_4;
  
  local_14 = *(undefined4 *)(param_1 + 100);
  local_c = 0;
  local_10 = 0;
  local_18 = FUN_006a0660(1,&local_8,&local_4);
  if (((local_18 == 0) && (uVar2 = FUN_00687c50(), local_18 == 0)) && ((uVar2 & 0xffffff00) == 0)) {
    local_8 = uVar2 >> 2 & 1;
    if (local_8 == 0) {
      uVar2 = FUN_00687c50();
    }
    else {
      uVar2 = FUN_00687bd0();
    }
    if (local_18 == 0) {
      if (uVar2 <= local_4 / 9) {
        *(uint *)(param_1 + 0x118) = uVar2;
        local_c = FUN_0068a220(local_14,0xc,0,uVar2,0,&local_18);
        if (local_18 != 0) goto LAB_006a0a28;
        uVar7 = 0;
        iVar3 = local_18;
        if (uVar2 != 0) {
          do {
            iVar3 = FUN_006889e0();
            local_18 = iVar3;
            if (iVar3 != 0) goto LAB_006a0a28;
            uVar7 = uVar7 + 1;
            local_18 = 0;
          } while (uVar7 < uVar2);
        }
        local_18 = iVar3;
        if ((uVar2 & 3) != 0) {
          FUN_00687800();
        }
        if (local_8 == 1) {
          uVar7 = FUN_00687bd0();
        }
        else {
          uVar7 = FUN_00687c50();
        }
        if (local_18 != 0) goto LAB_006a0a28;
        if (uVar7 <= local_4 + uVar2 * -9) {
          local_10 = FUN_0068a220(local_14,1,0,uVar7,0,&local_18);
          if (((local_18 == 0) && (local_18 = FUN_006888a0(), local_18 == 0)) &&
             (iVar3 = FUN_0068a220(local_14,0xc,0,uVar2,0,&local_18), local_18 == 0)) {
            uVar5 = 0;
            *(int *)(param_1 + 0x11c) = iVar3;
            if (uVar2 != 0) {
              puVar8 = (undefined4 *)(iVar3 + 8);
              local_4 = iVar3 - local_c;
              pcVar6 = (char *)(local_c + 4);
              do {
                uVar1 = *(uint *)(pcVar6 + -4);
                if (((int)uVar1 < 0) || (uVar7 < uVar1)) {
LAB_006a0a50:
                  local_18 = 9;
                  goto LAB_006a0a28;
                }
                uVar4 = FUN_00687fb0(local_14,uVar1 + local_10,&local_18);
                puVar8[-2] = uVar4;
                if (local_18 != 0) goto LAB_006a0a28;
                pcVar6[local_4] = *pcVar6;
                if (*pcVar6 == '\0') {
                  *puVar8 = *(undefined4 *)(pcVar6 + 4);
                }
                else {
                  uVar1 = *(uint *)(pcVar6 + 4);
                  if (((int)uVar1 < 0) || (uVar7 < uVar1)) goto LAB_006a0a50;
                  uVar4 = FUN_00687fb0(local_14,uVar1 + local_10,&local_18);
                  *puVar8 = uVar4;
                  if (local_18 != 0) goto LAB_006a0a28;
                }
                uVar5 = uVar5 + 1;
                pcVar6 = pcVar6 + 0xc;
                puVar8 = puVar8 + 3;
              } while (uVar5 < uVar2);
            }
            local_18 = 0;
          }
          goto LAB_006a0a28;
        }
      }
      local_18 = 8;
    }
  }
LAB_006a0a28:
  uVar4 = local_14;
  FUN_00687f30(local_14,local_c);
  FUN_00687f30(uVar4,local_10);
  return local_18;
}



============================================================
DISASSEMBLY
============================================================
006a0780 : SUB ESP,0x18
006a0783 : PUSH EBX
006a0784 : PUSH ESI
006a0785 : MOV ESI,dword ptr [ESP + 0x24]
006a0789 : MOV ECX,dword ptr [ESI + 0x64]
006a078c : MOV EBX,EAX
006a078e : XOR EAX,EAX
006a0790 : PUSH EDI
006a0791 : MOV EDI,dword ptr [ESI + 0xc0]
006a0797 : MOV dword ptr [ESP + 0x18],EAX
006a079b : MOV dword ptr [ESP + 0x14],EAX
006a079f : LEA EDX,[ESP + 0x20]
006a07a3 : PUSH EDX
006a07a4 : LEA EAX,[ESP + 0x20]
006a07a8 : PUSH EAX
006a07a9 : MOV EAX,dword ptr [ESI + 0xbc]
006a07af : PUSH 0x1
006a07b1 : MOV dword ptr [ESP + 0x1c],ECX
006a07b5 : CALL 0x006a0660
006a07ba : ADD ESP,0xc
006a07bd : MOV dword ptr [ESP + 0xc],EAX
006a07c1 : TEST EAX,EAX
006a07c3 : JNZ 0x006a0a28
006a07c9 : LEA ECX,[ESP + 0xc]
006a07cd : PUSH ECX
006a07ce : PUSH EBX
006a07cf : CALL 0x00687c50
006a07d4 : ADD ESP,0x8
006a07d7 : CMP dword ptr [ESP + 0xc],0x0
006a07dc : JNZ 0x006a0a28
006a07e2 : TEST EAX,0xffffff00
006a07e7 : JNZ 0x006a0a28
006a07ed : SHR EAX,0x2
006a07f0 : AND EAX,0x1
006a07f3 : PUSH EBP
006a07f4 : MOV dword ptr [ESP + 0x20],EAX
006a07f8 : JZ 0x006a0807
006a07fa : LEA EDX,[ESP + 0x10]
006a07fe : PUSH EDX
006a07ff : PUSH EBX
006a0800 : CALL 0x00687bd0
006a0805 : JMP 0x006a0812
006a0807 : LEA EAX,[ESP + 0x10]
006a080b : PUSH EAX
006a080c : PUSH EBX
006a080d : CALL 0x00687c50
006a0812 : ADD ESP,0x8
006a0815 : CMP dword ptr [ESP + 0x10],0x0
006a081a : MOV EBP,EAX
006a081c : JNZ 0x006a0a27
006a0822 : MOV EAX,0x38e38e39
006a0827 : MUL dword ptr [ESP + 0x24]
006a082b : SHR EDX,0x1
006a082d : CMP EBP,EDX
006a082f : JA 0x006a0904
006a0835 : MOV EDX,dword ptr [ESP + 0x14]
006a0839 : LEA ECX,[ESP + 0x10]
006a083d : PUSH ECX
006a083e : PUSH 0x0
006a0840 : PUSH EBP
006a0841 : PUSH 0x0
006a0843 : PUSH 0xc
006a0845 : PUSH EDX
006a0846 : MOV dword ptr [ESI + 0x118],EBP
006a084c : CALL 0x0068a220
006a0851 : ADD ESP,0x18
006a0854 : CMP dword ptr [ESP + 0x10],0x0
006a0859 : MOV dword ptr [ESP + 0x1c],EAX
006a085d : JNZ 0x006a0a27
006a0863 : XOR EDI,EDI
006a0865 : TEST EBP,EBP
006a0867 : JBE 0x006a08a5
006a0869 : MOV ESI,EAX
006a086b : JMP 0x006a0870
006a0870 : CMP dword ptr [ESP + 0x20],0x1
006a0875 : PUSH ESI
006a0876 : JNZ 0x006a087f
006a0878 : PUSH 0xbe8f28
006a087d : JMP 0x006a0884
006a087f : PUSH 0xbe8f14
006a0884 : PUSH EBX
006a0885 : CALL 0x006889e0
006a088a : ADD ESP,0xc
006a088d : MOV dword ptr [ESP + 0x10],EAX
006a0891 : TEST EAX,EAX
006a0893 : JNZ 0x006a0a27
006a0899 : INC EDI
006a089a : ADD ESI,0xc
006a089d : CMP EDI,EBP
006a089f : JC 0x006a0870
006a08a1 : MOV ESI,dword ptr [ESP + 0x2c]
006a08a5 : MOV EAX,EBP
006a08a7 : AND EAX,0x3
006a08aa : JZ 0x006a08bd
006a08ac : MOV ECX,0x4
006a08b1 : SUB ECX,EAX
006a08b3 : PUSH ECX
006a08b4 : PUSH EBX
006a08b5 : CALL 0x00687800
006a08ba : ADD ESP,0x8
006a08bd : CMP dword ptr [ESP + 0x20],0x1
006a08c2 : JNZ 0x006a08d7
006a08c4 : LEA EDX,[ESP + 0x10]
006a08c8 : PUSH EDX
006a08c9 : PUSH EBX
006a08ca : CALL 0x00687bd0
006a08cf : MOV EDI,EAX
006a08d1 : MOV dword ptr [ESP + 0x34],EDI
006a08d5 : JMP 0x006a08e8
006a08d7 : LEA EAX,[ESP + 0x10]
006a08db : PUSH EAX
006a08dc : PUSH EBX
006a08dd : CALL 0x00687c50
006a08e2 : MOV dword ptr [ESP + 0x34],EAX
006a08e6 : MOV EDI,EAX
006a08e8 : ADD ESP,0x8
006a08eb : CMP dword ptr [ESP + 0x10],0x0
006a08f0 : JNZ 0x006a0a27
006a08f6 : MOV EAX,dword ptr [ESP + 0x24]
006a08fa : LEA ECX,[EBP + EBP*0x8]
006a08fe : SUB EAX,ECX
006a0900 : CMP EDI,EAX
006a0902 : JBE 0x006a0911
006a0904 : MOV dword ptr [ESP + 0x10],0x8
006a090c : JMP 0x006a0a27
006a0911 : MOV EAX,dword ptr [ESP + 0x14]
006a0915 : LEA EDX,[ESP + 0x10]
006a0919 : PUSH EDX
006a091a : PUSH 0x0
006a091c : PUSH EDI
006a091d : PUSH 0x0
006a091f : PUSH 0x1
006a0921 : PUSH EAX
006a0922 : CALL 0x0068a220
006a0927 : ADD ESP,0x18
006a092a : CMP dword ptr [ESP + 0x10],0x0
006a092f : MOV dword ptr [ESP + 0x18],EAX
006a0933 : JNZ 0x006a0a27
006a0939 : PUSH EDI
006a093a : MOV ECX,EAX
006a093c : PUSH ECX
006a093d : PUSH EBX
006a093e : CALL 0x006888a0
006a0943 : ADD ESP,0xc
006a0946 : MOV dword ptr [ESP + 0x10],EAX
006a094a : TEST EAX,EAX
006a094c : JNZ 0x006a0a27
006a0952 : LEA EDX,[ESP + 0x10]
006a0956 : PUSH EDX
006a0957 : PUSH EAX
006a0958 : PUSH EBP
006a0959 : PUSH EAX
006a095a : MOV EAX,dword ptr [ESP + 0x24]
006a095e : PUSH 0xc
006a0960 : PUSH EAX
006a0961 : CALL 0x0068a220
006a0966 : ADD ESP,0x18
006a0969 : CMP dword ptr [ESP + 0x10],0x0
006a096e : JNZ 0x006a0a27
006a0974 : XOR EBX,EBX
006a0976 : MOV dword ptr [ESI + 0x11c],EAX
006a097c : TEST EBP,EBP
006a097e : JBE 0x006a0a1f
006a0984 : MOV ECX,dword ptr [ESP + 0x1c]
006a0988 : LEA EDI,[EAX + 0x8]
006a098b : SUB EAX,ECX
006a098d : LEA ESI,[ECX + 0x4]
006a0990 : MOV dword ptr [ESP + 0x24],EAX
006a0994 : MOV EAX,dword ptr [ESI + -0x4]
006a0997 : TEST EAX,EAX
006a0999 : JL 0x006a0a50
006a099f : CMP EAX,dword ptr [ESP + 0x2c]
006a09a3 : JA 0x006a0a50
006a09a9 : MOV EDX,dword ptr [ESP + 0x18]
006a09ad : LEA ECX,[ESP + 0x10]
006a09b1 : PUSH ECX
006a09b2 : ADD EAX,EDX
006a09b4 : PUSH EAX
006a09b5 : MOV EAX,dword ptr [ESP + 0x1c]
006a09b9 : PUSH EAX
006a09ba : CALL 0x00687fb0
006a09bf : ADD ESP,0xc
006a09c2 : MOV dword ptr [EDI + -0x8],EAX
006a09c5 : CMP dword ptr [ESP + 0x10],0x0
006a09ca : JNZ 0x006a0a27
006a09cc : MOV CL,byte ptr [ESI]
006a09ce : MOV EDX,dword ptr [ESP + 0x24]
006a09d2 : MOV byte ptr [EDX + ESI*0x1],CL
006a09d5 : CMP byte ptr [ESI],0x0
006a09d8 : JZ 0x006a0a0b
006a09da : MOV EAX,dword ptr [ESI + 0x4]
006a09dd : TEST EAX,EAX
006a09df : JL 0x006a0a50
006a09e1 : CMP EAX,dword ptr [ESP + 0x2c]
006a09e5 : JA 0x006a0a50
006a09e7 : MOV EDX,dword ptr [ESP + 0x18]
006a09eb : LEA ECX,[ESP + 0x10]
006a09ef : PUSH ECX
006a09f0 : ADD EAX,EDX
006a09f2 : PUSH EAX
006a09f3 : MOV EAX,dword ptr [ESP + 0x1c]
006a09f7 : PUSH EAX
006a09f8 : CALL 0x00687fb0
006a09fd : ADD ESP,0xc
006a0a00 : MOV dword ptr [EDI],EAX
006a0a02 : CMP dword ptr [ESP + 0x10],0x0
006a0a07 : JNZ 0x006a0a27
006a0a09 : JMP 0x006a0a10
006a0a0b : MOV ECX,dword ptr [ESI + 0x4]
006a0a0e : MOV dword ptr [EDI],ECX
006a0a10 : INC EBX
006a0a11 : ADD ESI,0xc
006a0a14 : ADD EDI,0xc
006a0a17 : CMP EBX,EBP
006a0a19 : JC 0x006a0994
006a0a1f : MOV dword ptr [ESP + 0x10],0x0
006a0a27 : POP EBP
006a0a28 : MOV EDX,dword ptr [ESP + 0x18]
006a0a2c : MOV ESI,dword ptr [ESP + 0x10]
006a0a30 : PUSH EDX
006a0a31 : PUSH ESI
006a0a32 : CALL 0x00687f30
006a0a37 : MOV EAX,dword ptr [ESP + 0x1c]
006a0a3b : PUSH EAX
006a0a3c : PUSH ESI
006a0a3d : CALL 0x00687f30
006a0a42 : MOV EAX,dword ptr [ESP + 0x1c]
006a0a46 : ADD ESP,0x10
006a0a49 : POP EDI
006a0a4a : POP ESI
006a0a4b : POP EBX
006a0a4c : ADD ESP,0x18
006a0a4f : RET
006a0a50 : MOV dword ptr [ESP + 0x10],0x9
006a0a58 : JMP 0x006a0a27

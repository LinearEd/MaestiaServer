PROGRAM  : Maestia.exe
FUNCTION : FUN_005d9050
ENTRY    : 005d9050
BODY     : [[005d9050, 005d933d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005d9050(int param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  uint *puVar1;
  int *piVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  int iVar6;
  char cVar7;
  uint uVar8;
  int in_ECX;
  uint uVar9;
  float10 fVar10;
  uint local_2c;
  
  puVar1 = (uint *)(in_ECX + 0x18);
  *puVar1 = 0;
  *(undefined1 *)(in_ECX + 0x28) = 0;
  local_2c = 0;
  if (*(int *)(param_1 + 0x18) != 0) {
    do {
      piVar2 = (int *)(*(int *)(*(int *)(param_1 + 0x24) + (local_2c >> 6) * 4) +
                      (local_2c & 0x3f) * 0x18);
      if (((param_2 < 0) || (piVar2[5] == param_2)) && (piVar2[1] != 0)) {
        if (*puVar1 != 0) {
          fVar10 = (float10)FUN_0063bdc0();
          if ((float)fVar10 < 0.0001 != ((float)fVar10 == 0.0001)) {
            uVar9 = 1;
            if (1 < (uint)piVar2[1]) {
              do {
                iVar6 = *(int *)(*(int *)(*piVar2 + 0x14) + (piVar2[2] + uVar9 >> 8) * 4);
                uVar8 = piVar2[2] + uVar9 & 0xff;
                uVar4 = *(undefined4 *)(iVar6 + uVar8 * 8);
                uVar5 = *(undefined4 *)(iVar6 + uVar8 * 8 + 4);
                if (((1 < *puVar1) &&
                    (uVar8 = *puVar1 - 1,
                    cVar7 = FUN_005d78b0(*(int *)(*(int *)(in_ECX + 0x24) + (uVar8 >> 6) * 4) +
                                         (uVar8 & 0x3f) * 0xc), cVar7 == '\0')) && (*puVar1 != 0)) {
                  *puVar1 = *puVar1 - 1;
                }
                uVar8 = *puVar1 >> 6;
                if (*(uint *)(in_ECX + 0x1c) <= uVar8) {
                  FUN_005d7920(uVar8);
                }
                puVar3 = (undefined4 *)
                         (*(int *)(*(int *)(in_ECX + 0x24) + uVar8 * 4) + (*puVar1 & 0x3f) * 0xc);
                *puVar3 = uVar4;
                puVar3[1] = uVar5;
                puVar3[2] = 0;
                *puVar1 = *puVar1 + 1;
                uVar9 = uVar9 + 1;
              } while (uVar9 < (uint)piVar2[1]);
            }
            goto LAB_005d92f8;
          }
          FUN_005d7990((char)param_4 == '\0');
          FUN_005d8b70(param_3,param_4);
          *puVar1 = 0;
          *(undefined1 *)(in_ECX + 0x28) = 0;
        }
        uVar9 = 0;
        if (piVar2[1] != 0) {
          do {
            iVar6 = *(int *)(*(int *)(*piVar2 + 0x14) + (piVar2[2] + uVar9 >> 8) * 4);
            uVar8 = piVar2[2] + uVar9 & 0xff;
            uVar4 = *(undefined4 *)(iVar6 + uVar8 * 8);
            uVar5 = *(undefined4 *)(iVar6 + uVar8 * 8 + 4);
            if (((1 < *puVar1) &&
                (uVar8 = *puVar1 - 1,
                cVar7 = FUN_005d78b0(*(int *)(*(int *)(in_ECX + 0x24) + (uVar8 >> 6) * 4) +
                                     (uVar8 & 0x3f) * 0xc), cVar7 == '\0')) && (*puVar1 != 0)) {
              *puVar1 = *puVar1 - 1;
            }
            uVar8 = *puVar1 >> 6;
            if (*(uint *)(in_ECX + 0x1c) <= uVar8) {
              FUN_005d7920(uVar8);
            }
            puVar3 = (undefined4 *)
                     (*(int *)(*(int *)(in_ECX + 0x24) + uVar8 * 4) + (*puVar1 & 0x3f) * 0xc);
            *puVar3 = uVar4;
            puVar3[1] = uVar5;
            puVar3[2] = 0;
            *puVar1 = *puVar1 + 1;
            uVar9 = uVar9 + 1;
          } while (uVar9 < (uint)piVar2[1]);
        }
      }
LAB_005d92f8:
      local_2c = local_2c + 1;
    } while (local_2c < *(uint *)(param_1 + 0x18));
  }
  if (1 < *puVar1) {
    FUN_005d7990((char)param_4 == '\0');
    FUN_005d8b70(param_3,param_4);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005d9050 : SUB ESP,0x30
005d9053 : PUSH EBX
005d9054 : PUSH EBP
005d9055 : MOV EBP,ECX
005d9057 : MOV ECX,dword ptr [ESP + 0x3c]
005d905b : PUSH ESI
005d905c : LEA ESI,[EBP + 0x18]
005d905f : XOR EAX,EAX
005d9061 : MOV dword ptr [ESI],0x0
005d9067 : MOV byte ptr [ESI + 0x10],0x0
005d906b : MOV dword ptr [ESP + 0xc],EBP
005d906f : MOV dword ptr [ESP + 0x10],EAX
005d9073 : CMP dword ptr [ECX + 0x18],EAX
005d9076 : JBE 0x005d930f
005d907c : PUSH EDI
005d907d : LEA ECX,[ECX]
005d9080 : MOV ECX,dword ptr [ECX + 0x24]
005d9083 : MOV EDX,EAX
005d9085 : AND EAX,0x3f
005d9088 : SHR EDX,0x6
005d908b : MOV ECX,dword ptr [ECX + EDX*0x4]
005d908e : LEA EAX,[EAX + EAX*0x2]
005d9091 : LEA EDI,[ECX + EAX*0x8]
005d9094 : MOV EAX,dword ptr [ESP + 0x48]
005d9098 : TEST EAX,EAX
005d909a : JL 0x005d90a5
005d909c : CMP dword ptr [EDI + 0x14],EAX
005d909f : JNZ 0x005d92f8
005d90a5 : CMP dword ptr [EDI + 0x4],0x0
005d90a9 : JZ 0x005d92f8
005d90af : MOV EAX,dword ptr [ESI]
005d90b1 : TEST EAX,EAX
005d90b3 : JZ 0x005d9232
005d90b9 : MOV ECX,dword ptr [EBP + 0x24]
005d90bc : MOV EBX,dword ptr [EDI]
005d90be : MOV EBX,dword ptr [EBX + 0x14]
005d90c1 : DEC EAX
005d90c2 : MOV EDX,EAX
005d90c4 : SHR EDX,0x6
005d90c7 : MOV ECX,dword ptr [ECX + EDX*0x4]
005d90ca : AND EAX,0x3f
005d90cd : LEA EAX,[EAX + EAX*0x2]
005d90d0 : LEA ECX,[ECX + EAX*0x4]
005d90d3 : MOV EAX,dword ptr [EDI + 0x8]
005d90d6 : MOV EDX,EAX
005d90d8 : SHR EDX,0x8
005d90db : MOV EDX,dword ptr [EBX + EDX*0x4]
005d90de : AND EAX,0xff
005d90e3 : MOV EBX,dword ptr [EDX + EAX*0x8]
005d90e6 : MOV EAX,dword ptr [EDX + EAX*0x8 + 0x4]
005d90ea : MOV dword ptr [ESP + 0x20],EBX
005d90ee : FLD float ptr [ESP + 0x20]
005d90f2 : FSUB float ptr [ECX]
005d90f4 : MOV dword ptr [ESP + 0x24],EAX
005d90f8 : FSTP float ptr [ESP + 0x1c]
005d90fc : FLD float ptr [ESP + 0x24]
005d9100 : FSUB float ptr [ECX + 0x4]
005d9103 : FSTP float ptr [ESP + 0x18]
005d9107 : FLD float ptr [ESP + 0x18]
005d910b : FLD float ptr [ESP + 0x1c]
005d910f : FMUL ST0
005d9111 : FLD ST1
005d9113 : FMULP ST2
005d9115 : FADDP
005d9117 : FSTP float ptr [ESP + 0x1c]
005d911b : FLD float ptr [ESP + 0x1c]
005d911f : CALL 0x0063bdc0
005d9124 : FSTP float ptr [ESP + 0x1c]
005d9128 : FLD float ptr [ESP + 0x1c]
005d912c : FCOMP double ptr [0x00b937f8]
005d9132 : FNSTSW AX
005d9134 : TEST AH,0x41
005d9137 : JP 0x005d9207
005d913d : MOV EBX,0x1
005d9142 : CMP dword ptr [EDI + 0x4],EBX
005d9145 : JBE 0x005d92f8
005d914b : FLDZ
005d914d : FSTP float ptr [ESP + 0x30]
005d9151 : MOV EAX,dword ptr [EDI + 0x8]
005d9154 : MOV EDX,dword ptr [EDI]
005d9156 : MOV EDX,dword ptr [EDX + 0x14]
005d9159 : ADD EAX,EBX
005d915b : MOV ECX,EAX
005d915d : SHR ECX,0x8
005d9160 : MOV ECX,dword ptr [EDX + ECX*0x4]
005d9163 : AND EAX,0xff
005d9168 : FLD float ptr [ECX + EAX*0x8]
005d916b : LEA EAX,[ECX + EAX*0x8]
005d916e : MOV ECX,dword ptr [ESI]
005d9170 : FSTP float ptr [ESP + 0x28]
005d9174 : FLD float ptr [EAX + 0x4]
005d9177 : FSTP float ptr [ESP + 0x2c]
005d917b : CMP ECX,0x1
005d917e : JBE 0x005d91bf
005d9180 : MOV EDX,dword ptr [ESI + 0xc]
005d9183 : LEA EAX,[ECX + -0x1]
005d9186 : MOV EBP,EAX
005d9188 : AND EAX,0x3f
005d918b : LEA EAX,[EAX + EAX*0x2]
005d918e : SHR EBP,0x6
005d9191 : MOV EBP,dword ptr [EDX + EBP*0x4]
005d9194 : LEA EBP,[EBP + EAX*0x4]
005d9198 : LEA EAX,[ECX + -0x2]
005d919b : MOV ECX,EAX
005d919d : SHR ECX,0x6
005d91a0 : MOV ECX,dword ptr [EDX + ECX*0x4]
005d91a3 : AND EAX,0x3f
005d91a6 : LEA EAX,[EAX + EAX*0x2]
005d91a9 : LEA ECX,[ECX + EAX*0x4]
005d91ac : PUSH EBP
005d91ad : CALL 0x005d78b0
005d91b2 : TEST AL,AL
005d91b4 : JNZ 0x005d91bf
005d91b6 : MOV EAX,dword ptr [ESI]
005d91b8 : TEST EAX,EAX
005d91ba : JZ 0x005d91bf
005d91bc : DEC EAX
005d91bd : MOV dword ptr [ESI],EAX
005d91bf : MOV EBP,dword ptr [ESI]
005d91c1 : SHR EBP,0x6
005d91c4 : CMP EBP,dword ptr [ESI + 0x4]
005d91c7 : JC 0x005d91d1
005d91c9 : PUSH EBP
005d91ca : MOV ECX,ESI
005d91cc : CALL 0x005d7920
005d91d1 : MOV EAX,dword ptr [ESI]
005d91d3 : MOV EDX,dword ptr [ESI + 0xc]
005d91d6 : MOV ECX,dword ptr [EDX + EBP*0x4]
005d91d9 : MOV EDX,dword ptr [ESP + 0x28]
005d91dd : AND EAX,0x3f
005d91e0 : LEA EAX,[EAX + EAX*0x2]
005d91e3 : LEA EAX,[ECX + EAX*0x4]
005d91e6 : MOV ECX,dword ptr [ESP + 0x2c]
005d91ea : MOV dword ptr [EAX],EDX
005d91ec : MOV EDX,dword ptr [ESP + 0x30]
005d91f0 : MOV dword ptr [EAX + 0x4],ECX
005d91f3 : MOV dword ptr [EAX + 0x8],EDX
005d91f6 : INC dword ptr [ESI]
005d91f8 : INC EBX
005d91f9 : CMP EBX,dword ptr [EDI + 0x4]
005d91fc : JC 0x005d9151
005d9202 : JMP 0x005d92f4
005d9207 : MOV EBX,dword ptr [ESP + 0x50]
005d920b : TEST BL,BL
005d920d : SETZ AL
005d9210 : MOVZX ECX,AL
005d9213 : PUSH ECX
005d9214 : MOV ECX,ESI
005d9216 : CALL 0x005d7990
005d921b : MOV EDX,dword ptr [ESP + 0x4c]
005d921f : PUSH EBX
005d9220 : PUSH EDX
005d9221 : MOV ECX,EBP
005d9223 : CALL 0x005d8b70
005d9228 : MOV dword ptr [ESI],0x0
005d922e : MOV byte ptr [ESI + 0x10],0x0
005d9232 : XOR EBX,EBX
005d9234 : CMP dword ptr [EDI + 0x4],EBX
005d9237 : JBE 0x005d92f8
005d923d : FLDZ
005d923f : FSTP float ptr [ESP + 0x3c]
005d9243 : MOV EAX,dword ptr [EDI + 0x8]
005d9246 : MOV EDX,dword ptr [EDI]
005d9248 : MOV EDX,dword ptr [EDX + 0x14]
005d924b : ADD EAX,EBX
005d924d : MOV ECX,EAX
005d924f : SHR ECX,0x8
005d9252 : MOV ECX,dword ptr [EDX + ECX*0x4]
005d9255 : AND EAX,0xff
005d925a : FLD float ptr [ECX + EAX*0x8]
005d925d : LEA EAX,[ECX + EAX*0x8]
005d9260 : MOV ECX,dword ptr [ESI]
005d9262 : FSTP float ptr [ESP + 0x34]
005d9266 : FLD float ptr [EAX + 0x4]
005d9269 : FSTP float ptr [ESP + 0x38]
005d926d : CMP ECX,0x1
005d9270 : JBE 0x005d92b1
005d9272 : MOV EDX,dword ptr [ESI + 0xc]
005d9275 : LEA EAX,[ECX + -0x1]
005d9278 : MOV EBP,EAX
005d927a : AND EAX,0x3f
005d927d : LEA EAX,[EAX + EAX*0x2]
005d9280 : SHR EBP,0x6
005d9283 : MOV EBP,dword ptr [EDX + EBP*0x4]
005d9286 : LEA EBP,[EBP + EAX*0x4]
005d928a : LEA EAX,[ECX + -0x2]
005d928d : MOV ECX,EAX
005d928f : SHR ECX,0x6
005d9292 : MOV ECX,dword ptr [EDX + ECX*0x4]
005d9295 : AND EAX,0x3f
005d9298 : LEA EAX,[EAX + EAX*0x2]
005d929b : LEA ECX,[ECX + EAX*0x4]
005d929e : PUSH EBP
005d929f : CALL 0x005d78b0
005d92a4 : TEST AL,AL
005d92a6 : JNZ 0x005d92b1
005d92a8 : MOV EAX,dword ptr [ESI]
005d92aa : TEST EAX,EAX
005d92ac : JZ 0x005d92b1
005d92ae : DEC EAX
005d92af : MOV dword ptr [ESI],EAX
005d92b1 : MOV EBP,dword ptr [ESI]
005d92b3 : SHR EBP,0x6
005d92b6 : CMP EBP,dword ptr [ESI + 0x4]
005d92b9 : JC 0x005d92c3
005d92bb : PUSH EBP
005d92bc : MOV ECX,ESI
005d92be : CALL 0x005d7920
005d92c3 : MOV EAX,dword ptr [ESI]
005d92c5 : MOV EDX,dword ptr [ESI + 0xc]
005d92c8 : MOV ECX,dword ptr [EDX + EBP*0x4]
005d92cb : MOV EDX,dword ptr [ESP + 0x34]
005d92cf : AND EAX,0x3f
005d92d2 : LEA EAX,[EAX + EAX*0x2]
005d92d5 : LEA EAX,[ECX + EAX*0x4]
005d92d8 : MOV ECX,dword ptr [ESP + 0x38]
005d92dc : MOV dword ptr [EAX],EDX
005d92de : MOV EDX,dword ptr [ESP + 0x3c]
005d92e2 : MOV dword ptr [EAX + 0x4],ECX
005d92e5 : MOV dword ptr [EAX + 0x8],EDX
005d92e8 : INC dword ptr [ESI]
005d92ea : INC EBX
005d92eb : CMP EBX,dword ptr [EDI + 0x4]
005d92ee : JC 0x005d9243
005d92f4 : MOV EBP,dword ptr [ESP + 0x10]
005d92f8 : MOV EAX,dword ptr [ESP + 0x14]
005d92fc : MOV ECX,dword ptr [ESP + 0x44]
005d9300 : INC EAX
005d9301 : MOV dword ptr [ESP + 0x14],EAX
005d9305 : CMP EAX,dword ptr [ECX + 0x18]
005d9308 : JC 0x005d9080
005d930e : POP EDI
005d930f : CMP dword ptr [ESI],0x1
005d9312 : JBE 0x005d9335
005d9314 : MOV EBX,dword ptr [ESP + 0x4c]
005d9318 : TEST BL,BL
005d931a : SETZ AL
005d931d : MOVZX ECX,AL
005d9320 : PUSH ECX
005d9321 : MOV ECX,ESI
005d9323 : CALL 0x005d7990
005d9328 : MOV EDX,dword ptr [ESP + 0x48]
005d932c : PUSH EBX
005d932d : PUSH EDX
005d932e : MOV ECX,EBP
005d9330 : CALL 0x005d8b70
005d9335 : POP ESI
005d9336 : POP EBP
005d9337 : POP EBX
005d9338 : ADD ESP,0x30
005d933b : RET 0x10

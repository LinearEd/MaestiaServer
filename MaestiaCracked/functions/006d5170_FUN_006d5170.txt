PROGRAM  : Maestia.exe
FUNCTION : FUN_006d5170
ENTRY    : 006d5170
BODY     : [[006d5170, 006d546f]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_006d5170(void)

{
  byte bVar1;
  byte bVar2;
  undefined4 *puVar3;
  undefined1 in_AL;
  uint uVar4;
  int iVar5;
  undefined1 in_CL;
  int iVar6;
  uint *puVar7;
  int *unaff_ESI;
  byte *pbVar8;
  byte *pbVar9;
  uint local_8;
  
  puVar3 = (undefined4 *)unaff_ESI[6];
  iVar6 = puVar3[1];
  pbVar8 = (byte *)*puVar3;
  *(undefined1 *)(unaff_ESI + 0x32) = in_AL;
  *(undefined1 *)((int)unaff_ESI + 0xc9) = in_CL;
  if (iVar6 == 0) {
    uVar4 = (*(code *)puVar3[3])();
    if ((char)uVar4 == '\0') goto LAB_006d51a0;
    pbVar8 = (byte *)*puVar3;
    iVar6 = puVar3[1];
  }
  bVar1 = *pbVar8;
  iVar6 = iVar6 + -1;
  pbVar8 = pbVar8 + 1;
  if (iVar6 == 0) {
    uVar4 = (*(code *)puVar3[3])();
    if ((char)uVar4 == '\0') goto LAB_006d51a0;
    pbVar8 = (byte *)*puVar3;
    iVar6 = puVar3[1];
  }
  bVar2 = *pbVar8;
  iVar6 = iVar6 + -1;
  pbVar8 = pbVar8 + 1;
  if (iVar6 == 0) {
    uVar4 = (*(code *)puVar3[3])();
    if ((char)uVar4 == '\0') goto LAB_006d51a0;
    pbVar8 = (byte *)*puVar3;
    iVar6 = puVar3[1];
  }
  iVar6 = iVar6 + -1;
  pbVar9 = pbVar8 + 1;
  unaff_ESI[0x30] = (uint)*pbVar8;
  if (iVar6 == 0) {
    uVar4 = (*(code *)puVar3[3])();
    if ((char)uVar4 == '\0') goto LAB_006d51a0;
    pbVar9 = (byte *)*puVar3;
    iVar6 = puVar3[1];
  }
  iVar6 = iVar6 + -1;
  pbVar8 = pbVar9 + 1;
  unaff_ESI[8] = (uint)*pbVar9 << 8;
  if (iVar6 == 0) {
    uVar4 = (*(code *)puVar3[3])();
    if ((char)uVar4 == '\0') goto LAB_006d51a0;
    pbVar8 = (byte *)*puVar3;
    iVar6 = puVar3[1];
  }
  unaff_ESI[8] = unaff_ESI[8] + (uint)*pbVar8;
  iVar6 = iVar6 + -1;
  pbVar8 = pbVar8 + 1;
  if (iVar6 == 0) {
    uVar4 = (*(code *)puVar3[3])();
    if ((char)uVar4 == '\0') goto LAB_006d51a0;
    pbVar8 = (byte *)*puVar3;
    iVar6 = puVar3[1];
  }
  iVar6 = iVar6 + -1;
  pbVar9 = pbVar8 + 1;
  unaff_ESI[7] = (uint)*pbVar8 << 8;
  if (iVar6 == 0) {
    uVar4 = (*(code *)puVar3[3])();
    if ((char)uVar4 == '\0') goto LAB_006d51a0;
    pbVar9 = (byte *)*puVar3;
    iVar6 = puVar3[1];
  }
  unaff_ESI[7] = unaff_ESI[7] + (uint)*pbVar9;
  iVar6 = iVar6 + -1;
  pbVar9 = pbVar9 + 1;
  if (iVar6 == 0) {
    uVar4 = (*(code *)puVar3[3])();
    if ((char)uVar4 == '\0') {
LAB_006d51a0:
      return uVar4 & 0xffffff00;
    }
    pbVar9 = (byte *)*puVar3;
    iVar6 = puVar3[1];
  }
  iVar5 = *unaff_ESI;
  unaff_ESI[9] = (uint)*pbVar9;
  *(int *)(iVar5 + 0x18) = unaff_ESI[0x5f];
  *(int *)(iVar5 + 0x1c) = unaff_ESI[7];
  *(int *)(iVar5 + 0x20) = unaff_ESI[8];
  *(int *)(iVar5 + 0x24) = unaff_ESI[9];
  *(undefined4 *)(*unaff_ESI + 0x14) = 100;
  iVar6 = iVar6 + -1;
  pbVar9 = pbVar9 + 1;
  (**(code **)(*unaff_ESI + 4))();
  if (*(char *)(unaff_ESI[0x65] + 0xd) != '\0') {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x3a;
    (**(code **)*unaff_ESI)();
  }
  if (((unaff_ESI[8] == 0) || (unaff_ESI[7] == 0)) || (unaff_ESI[9] < 1)) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x20;
    (**(code **)*unaff_ESI)();
  }
  if ((uint)bVar1 * 0x100 + (uint)bVar2 + -8 != unaff_ESI[9] * 3) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0xb;
    (**(code **)*unaff_ESI)();
  }
  if (unaff_ESI[0x31] == 0) {
    iVar5 = (**(code **)unaff_ESI[1])();
    unaff_ESI[0x31] = iVar5;
  }
  puVar7 = (uint *)unaff_ESI[0x31];
  local_8 = 0;
  if (0 < unaff_ESI[9]) {
    do {
      puVar7[1] = local_8;
      if (iVar6 == 0) {
        uVar4 = (*(code *)puVar3[3])();
        if ((char)uVar4 == '\0') goto LAB_006d51a0;
        pbVar9 = (byte *)*puVar3;
        iVar6 = puVar3[1];
      }
      iVar6 = iVar6 + -1;
      pbVar8 = pbVar9 + 1;
      *puVar7 = (uint)*pbVar9;
      if (iVar6 == 0) {
        uVar4 = (*(code *)puVar3[3])();
        if ((char)uVar4 == '\0') goto LAB_006d51a0;
        pbVar8 = (byte *)*puVar3;
        iVar6 = puVar3[1];
      }
      bVar1 = *pbVar8;
      iVar6 = iVar6 + -1;
      pbVar8 = pbVar8 + 1;
      puVar7[2] = (int)(uint)bVar1 >> 4;
      puVar7[3] = bVar1 & 0xf;
      if (iVar6 == 0) {
        uVar4 = (*(code *)puVar3[3])();
        if ((char)uVar4 == '\0') goto LAB_006d51a0;
        pbVar8 = (byte *)*puVar3;
        iVar6 = puVar3[1];
      }
      puVar7[4] = (uint)*pbVar8;
      iVar5 = *unaff_ESI;
      *(uint *)(iVar5 + 0x18) = *puVar7;
      *(uint *)(iVar5 + 0x1c) = puVar7[2];
      *(uint *)(iVar5 + 0x20) = puVar7[3];
      *(uint *)(iVar5 + 0x24) = puVar7[4];
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x65;
      iVar6 = iVar6 + -1;
      pbVar9 = pbVar8 + 1;
      (**(code **)(*unaff_ESI + 4))();
      local_8 = local_8 + 1;
      puVar7 = puVar7 + 0x15;
    } while ((int)local_8 < unaff_ESI[9]);
  }
  *(undefined1 *)(unaff_ESI[0x65] + 0xd) = 1;
  *puVar3 = pbVar9;
  puVar3[1] = iVar6;
  return CONCAT31((int3)((uint)puVar3 >> 8),1);
}



============================================================
DISASSEMBLY
============================================================
006d5170 : SUB ESP,0x8
006d5173 : PUSH EBX
006d5174 : PUSH EBP
006d5175 : MOV EBP,dword ptr [ESI + 0x18]
006d5178 : MOV EBX,dword ptr [EBP + 0x4]
006d517b : PUSH EDI
006d517c : MOV EDI,dword ptr [EBP]
006d517f : MOV dword ptr [ESP + 0x10],EBP
006d5183 : MOV byte ptr [ESI + 0xc8],AL
006d5189 : MOV byte ptr [ESI + 0xc9],CL
006d518f : TEST EBX,EBX
006d5191 : JNZ 0x006d51af
006d5193 : MOV EDX,dword ptr [EBP + 0xc]
006d5196 : PUSH ESI
006d5197 : CALL EDX
006d5199 : ADD ESP,0x4
006d519c : TEST AL,AL
006d519e : JNZ 0x006d51a9
006d51a0 : POP EDI
006d51a1 : POP EBP
006d51a2 : XOR AL,AL
006d51a4 : POP EBX
006d51a5 : ADD ESP,0x8
006d51a8 : RET
006d51a9 : MOV EDI,dword ptr [EBP]
006d51ac : MOV EBX,dword ptr [EBP + 0x4]
006d51af : MOVZX EAX,byte ptr [EDI]
006d51b2 : DEC EBX
006d51b3 : SHL EAX,0x8
006d51b6 : INC EDI
006d51b7 : MOV dword ptr [ESP + 0xc],EAX
006d51bb : TEST EBX,EBX
006d51bd : JNZ 0x006d51d2
006d51bf : MOV EAX,dword ptr [EBP + 0xc]
006d51c2 : PUSH ESI
006d51c3 : CALL EAX
006d51c5 : ADD ESP,0x4
006d51c8 : TEST AL,AL
006d51ca : JZ 0x006d51a0
006d51cc : MOV EDI,dword ptr [EBP]
006d51cf : MOV EBX,dword ptr [EBP + 0x4]
006d51d2 : MOVZX ECX,byte ptr [EDI]
006d51d5 : ADD dword ptr [ESP + 0xc],ECX
006d51d9 : DEC EBX
006d51da : INC EDI
006d51db : TEST EBX,EBX
006d51dd : JNZ 0x006d51f2
006d51df : MOV EDX,dword ptr [EBP + 0xc]
006d51e2 : PUSH ESI
006d51e3 : CALL EDX
006d51e5 : ADD ESP,0x4
006d51e8 : TEST AL,AL
006d51ea : JZ 0x006d51a0
006d51ec : MOV EDI,dword ptr [EBP]
006d51ef : MOV EBX,dword ptr [EBP + 0x4]
006d51f2 : MOVZX EAX,byte ptr [EDI]
006d51f5 : DEC EBX
006d51f6 : INC EDI
006d51f7 : MOV dword ptr [ESI + 0xc0],EAX
006d51fd : TEST EBX,EBX
006d51ff : JNZ 0x006d5214
006d5201 : MOV ECX,dword ptr [EBP + 0xc]
006d5204 : PUSH ESI
006d5205 : CALL ECX
006d5207 : ADD ESP,0x4
006d520a : TEST AL,AL
006d520c : JZ 0x006d51a0
006d520e : MOV EDI,dword ptr [EBP]
006d5211 : MOV EBX,dword ptr [EBP + 0x4]
006d5214 : MOVZX EDX,byte ptr [EDI]
006d5217 : DEC EBX
006d5218 : SHL EDX,0x8
006d521b : INC EDI
006d521c : MOV dword ptr [ESI + 0x20],EDX
006d521f : TEST EBX,EBX
006d5221 : JNZ 0x006d523a
006d5223 : MOV EAX,dword ptr [EBP + 0xc]
006d5226 : PUSH ESI
006d5227 : CALL EAX
006d5229 : ADD ESP,0x4
006d522c : TEST AL,AL
006d522e : JZ 0x006d51a0
006d5234 : MOV EDI,dword ptr [EBP]
006d5237 : MOV EBX,dword ptr [EBP + 0x4]
006d523a : MOVZX ECX,byte ptr [EDI]
006d523d : ADD dword ptr [ESI + 0x20],ECX
006d5240 : DEC EBX
006d5241 : INC EDI
006d5242 : TEST EBX,EBX
006d5244 : JNZ 0x006d525d
006d5246 : MOV EDX,dword ptr [EBP + 0xc]
006d5249 : PUSH ESI
006d524a : CALL EDX
006d524c : ADD ESP,0x4
006d524f : TEST AL,AL
006d5251 : JZ 0x006d51a0
006d5257 : MOV EDI,dword ptr [EBP]
006d525a : MOV EBX,dword ptr [EBP + 0x4]
006d525d : MOVZX EAX,byte ptr [EDI]
006d5260 : DEC EBX
006d5261 : SHL EAX,0x8
006d5264 : INC EDI
006d5265 : MOV dword ptr [ESI + 0x1c],EAX
006d5268 : TEST EBX,EBX
006d526a : JNZ 0x006d5283
006d526c : MOV ECX,dword ptr [EBP + 0xc]
006d526f : PUSH ESI
006d5270 : CALL ECX
006d5272 : ADD ESP,0x4
006d5275 : TEST AL,AL
006d5277 : JZ 0x006d51a0
006d527d : MOV EDI,dword ptr [EBP]
006d5280 : MOV EBX,dword ptr [EBP + 0x4]
006d5283 : MOVZX EDX,byte ptr [EDI]
006d5286 : ADD dword ptr [ESI + 0x1c],EDX
006d5289 : DEC EBX
006d528a : INC EDI
006d528b : TEST EBX,EBX
006d528d : JNZ 0x006d52a6
006d528f : MOV EAX,dword ptr [EBP + 0xc]
006d5292 : PUSH ESI
006d5293 : CALL EAX
006d5295 : ADD ESP,0x4
006d5298 : TEST AL,AL
006d529a : JZ 0x006d51a0
006d52a0 : MOV EDI,dword ptr [EBP]
006d52a3 : MOV EBX,dword ptr [EBP + 0x4]
006d52a6 : MOVZX ECX,byte ptr [EDI]
006d52a9 : MOV EAX,dword ptr [ESI]
006d52ab : MOV EDX,dword ptr [ESI + 0x17c]
006d52b1 : SUB dword ptr [ESP + 0xc],0x8
006d52b6 : MOV dword ptr [ESI + 0x24],ECX
006d52b9 : ADD EAX,0x18
006d52bc : MOV dword ptr [EAX],EDX
006d52be : MOV ECX,dword ptr [ESI + 0x1c]
006d52c1 : MOV dword ptr [EAX + 0x4],ECX
006d52c4 : MOV EDX,dword ptr [ESI + 0x20]
006d52c7 : MOV dword ptr [EAX + 0x8],EDX
006d52ca : MOV ECX,dword ptr [ESI + 0x24]
006d52cd : MOV dword ptr [EAX + 0xc],ECX
006d52d0 : MOV EDX,dword ptr [ESI]
006d52d2 : MOV dword ptr [EDX + 0x14],0x64
006d52d9 : MOV EAX,dword ptr [ESI]
006d52db : MOV ECX,dword ptr [EAX + 0x4]
006d52de : PUSH 0x1
006d52e0 : PUSH ESI
006d52e1 : DEC EBX
006d52e2 : INC EDI
006d52e3 : CALL ECX
006d52e5 : MOV EDX,dword ptr [ESI + 0x194]
006d52eb : ADD ESP,0x8
006d52ee : CMP byte ptr [EDX + 0xd],0x0
006d52f2 : JZ 0x006d5307
006d52f4 : MOV EAX,dword ptr [ESI]
006d52f6 : MOV dword ptr [EAX + 0x14],0x3a
006d52fd : MOV ECX,dword ptr [ESI]
006d52ff : MOV EDX,dword ptr [ECX]
006d5301 : PUSH ESI
006d5302 : CALL EDX
006d5304 : ADD ESP,0x4
006d5307 : CMP dword ptr [ESI + 0x20],0x0
006d530b : JBE 0x006d5319
006d530d : CMP dword ptr [ESI + 0x1c],0x0
006d5311 : JBE 0x006d5319
006d5313 : CMP dword ptr [ESI + 0x24],0x0
006d5317 : JG 0x006d532c
006d5319 : MOV EAX,dword ptr [ESI]
006d531b : MOV dword ptr [EAX + 0x14],0x20
006d5322 : MOV ECX,dword ptr [ESI]
006d5324 : MOV EDX,dword ptr [ECX]
006d5326 : PUSH ESI
006d5327 : CALL EDX
006d5329 : ADD ESP,0x4
006d532c : MOV EAX,dword ptr [ESI + 0x24]
006d532f : LEA EAX,[EAX + EAX*0x2]
006d5332 : CMP dword ptr [ESP + 0xc],EAX
006d5336 : JZ 0x006d534b
006d5338 : MOV ECX,dword ptr [ESI]
006d533a : MOV dword ptr [ECX + 0x14],0xb
006d5341 : MOV EDX,dword ptr [ESI]
006d5343 : MOV EAX,dword ptr [EDX]
006d5345 : PUSH ESI
006d5346 : CALL EAX
006d5348 : ADD ESP,0x4
006d534b : CMP dword ptr [ESI + 0xc4],0x0
006d5352 : JNZ 0x006d536e
006d5354 : MOV EDX,dword ptr [ESI + 0x24]
006d5357 : MOV ECX,dword ptr [ESI + 0x4]
006d535a : IMUL EDX,EDX,0x54
006d535d : MOV EAX,dword ptr [ECX]
006d535f : PUSH EDX
006d5360 : PUSH 0x1
006d5362 : PUSH ESI
006d5363 : CALL EAX
006d5365 : ADD ESP,0xc
006d5368 : MOV dword ptr [ESI + 0xc4],EAX
006d536e : CMP dword ptr [ESI + 0x24],0x0
006d5372 : MOV EBP,dword ptr [ESI + 0xc4]
006d5378 : MOV dword ptr [ESP + 0xc],0x0
006d5380 : JLE 0x006d5454
006d5386 : MOV ECX,dword ptr [ESP + 0xc]
006d538a : MOV dword ptr [EBP + 0x4],ECX
006d538d : TEST EBX,EBX
006d538f : JNZ 0x006d53ab
006d5391 : MOV EBX,dword ptr [ESP + 0x10]
006d5395 : MOV EDX,dword ptr [EBX + 0xc]
006d5398 : PUSH ESI
006d5399 : CALL EDX
006d539b : ADD ESP,0x4
006d539e : TEST AL,AL
006d53a0 : JZ 0x006d51a0
006d53a6 : MOV EDI,dword ptr [EBX]
006d53a8 : MOV EBX,dword ptr [EBX + 0x4]
006d53ab : MOVZX EAX,byte ptr [EDI]
006d53ae : DEC EBX
006d53af : INC EDI
006d53b0 : MOV dword ptr [EBP],EAX
006d53b3 : TEST EBX,EBX
006d53b5 : JNZ 0x006d53d1
006d53b7 : MOV EBX,dword ptr [ESP + 0x10]
006d53bb : MOV ECX,dword ptr [EBX + 0xc]
006d53be : PUSH ESI
006d53bf : CALL ECX
006d53c1 : ADD ESP,0x4
006d53c4 : TEST AL,AL
006d53c6 : JZ 0x006d51a0
006d53cc : MOV EDI,dword ptr [EBX]
006d53ce : MOV EBX,dword ptr [EBX + 0x4]
006d53d1 : MOVZX EAX,byte ptr [EDI]
006d53d4 : MOV EDX,EAX
006d53d6 : SAR EDX,0x4
006d53d9 : DEC EBX
006d53da : AND EDX,0xf
006d53dd : AND EAX,0xf
006d53e0 : INC EDI
006d53e1 : MOV dword ptr [EBP + 0x8],EDX
006d53e4 : MOV dword ptr [EBP + 0xc],EAX
006d53e7 : TEST EBX,EBX
006d53e9 : JNZ 0x006d5405
006d53eb : MOV EBX,dword ptr [ESP + 0x10]
006d53ef : MOV EAX,dword ptr [EBX + 0xc]
006d53f2 : PUSH ESI
006d53f3 : CALL EAX
006d53f5 : ADD ESP,0x4
006d53f8 : TEST AL,AL
006d53fa : JZ 0x006d51a0
006d5400 : MOV EDI,dword ptr [EBX]
006d5402 : MOV EBX,dword ptr [EBX + 0x4]
006d5405 : MOVZX ECX,byte ptr [EDI]
006d5408 : MOV EDX,dword ptr [EBP]
006d540b : MOV dword ptr [EBP + 0x10],ECX
006d540e : MOV EAX,dword ptr [ESI]
006d5410 : ADD EAX,0x18
006d5413 : MOV dword ptr [EAX],EDX
006d5415 : MOV ECX,dword ptr [EBP + 0x8]
006d5418 : MOV dword ptr [EAX + 0x4],ECX
006d541b : MOV EDX,dword ptr [EBP + 0xc]
006d541e : MOV dword ptr [EAX + 0x8],EDX
006d5421 : MOV ECX,dword ptr [EBP + 0x10]
006d5424 : MOV dword ptr [EAX + 0xc],ECX
006d5427 : MOV EDX,dword ptr [ESI]
006d5429 : MOV dword ptr [EDX + 0x14],0x65
006d5430 : MOV EAX,dword ptr [ESI]
006d5432 : MOV ECX,dword ptr [EAX + 0x4]
006d5435 : PUSH 0x1
006d5437 : PUSH ESI
006d5438 : DEC EBX
006d5439 : INC EDI
006d543a : CALL ECX
006d543c : MOV EAX,dword ptr [ESP + 0x14]
006d5440 : INC EAX
006d5441 : ADD ESP,0x8
006d5444 : ADD EBP,0x54
006d5447 : CMP EAX,dword ptr [ESI + 0x24]
006d544a : MOV dword ptr [ESP + 0xc],EAX
006d544e : JL 0x006d5386
006d5454 : MOV EDX,dword ptr [ESI + 0x194]
006d545a : MOV EAX,dword ptr [ESP + 0x10]
006d545e : MOV byte ptr [EDX + 0xd],0x1
006d5462 : MOV dword ptr [EAX],EDI
006d5464 : POP EDI
006d5465 : MOV dword ptr [EAX + 0x4],EBX
006d5468 : POP EBP
006d5469 : MOV AL,0x1
006d546b : POP EBX
006d546c : ADD ESP,0x8
006d546f : RET

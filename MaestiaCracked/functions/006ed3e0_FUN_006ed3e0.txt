PROGRAM  : Maestia.exe
FUNCTION : FUN_006ed3e0
ENTRY    : 006ed3e0
BODY     : [[006ed3e0, 006ed431]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006ed3e0(void)

{
  int iVar1;
  int iVar2;
  int iVar3;
  
  iVar1 = *(int *)ThreadLocalStoragePointer;
  if (*(char *)(iVar1 + 0x19) == '\0') {
    *(undefined1 *)(iVar1 + 0x19) = 1;
    iVar2 = _rand();
    *(int *)(iVar1 + 0x24) = iVar2;
    iVar2 = _rand();
    *(int *)(iVar1 + 0x20) = iVar2;
  }
  iVar2 = (*(uint *)(iVar1 + 0x20) >> 0x10) + (*(uint *)(iVar1 + 0x20) & 0xffff) * 0x9069;
  *(int *)(iVar1 + 0x20) = iVar2;
  iVar3 = (*(uint *)(iVar1 + 0x24) >> 0x10) + (*(uint *)(iVar1 + 0x24) & 0xffff) * 18000;
  *(int *)(iVar1 + 0x24) = iVar3;
  return iVar2 * 0x10000 + iVar3;
}



============================================================
DISASSEMBLY
============================================================
006ed3e0 : MOV EAX,FS:[0x2c]
006ed3e6 : PUSH ESI
006ed3e7 : MOV ESI,dword ptr [EAX]
006ed3e9 : CMP byte ptr [ESI + 0x19],0x0
006ed3ed : JNZ 0x006ed403
006ed3ef : MOV byte ptr [ESI + 0x19],0x1
006ed3f3 : CALL 0x00635d2f
006ed3f8 : MOV dword ptr [ESI + 0x24],EAX
006ed3fb : CALL 0x00635d2f
006ed400 : MOV dword ptr [ESI + 0x20],EAX
006ed403 : MOV EAX,dword ptr [ESI + 0x20]
006ed406 : MOVZX ECX,AX
006ed409 : IMUL ECX,ECX,0x9069
006ed40f : SHR EAX,0x10
006ed412 : ADD EAX,ECX
006ed414 : MOV ECX,dword ptr [ESI + 0x24]
006ed417 : MOVZX EDX,CX
006ed41a : IMUL EDX,EDX,0x4650
006ed420 : MOV dword ptr [ESI + 0x20],EAX
006ed423 : SHR ECX,0x10
006ed426 : ADD ECX,EDX
006ed428 : SHL EAX,0x10
006ed42b : MOV dword ptr [ESI + 0x24],ECX
006ed42e : ADD EAX,ECX
006ed430 : POP ESI
006ed431 : RET

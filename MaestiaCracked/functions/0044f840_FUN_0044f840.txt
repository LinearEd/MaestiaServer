PROGRAM  : Maestia.exe
FUNCTION : FUN_0044f840
ENTRY    : 0044f840
BODY     : [[0044f840, 0044faa1]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0044f840(undefined4 *param_1)

{
  short sVar1;
  short *psVar2;
  char cVar3;
  uint uVar4;
  int iVar5;
  short *psVar6;
  undefined4 uVar7;
  undefined4 ****ppppuVar8;
  undefined1 local_8c [28];
  undefined4 local_70 [2];
  undefined2 local_68;
  undefined4 local_58;
  uint local_54;
  undefined4 *local_50;
  undefined1 local_4c [4];
  undefined2 local_48;
  undefined4 local_38;
  uint local_34;
  undefined1 local_30 [4];
  undefined4 ***local_2c [4];
  uint local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7df4b;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  psVar2 = (short *)*param_1;
  local_50 = param_1;
  local_14 = uVar4;
  if (*psVar2 != 0x24) goto LAB_0044fa7f;
  FUN_00406460(psVar2 + 1);
  local_8 = 0;
  FUN_0081cce0(DAT_0172491c);
  local_8._0_1_ = 2;
  if (7 < local_54) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0(uVar4);
  }
  local_54 = 7;
  local_58 = 0;
  local_68 = 0;
  FUN_00406460(&DAT_00cca49c);
  local_8._0_1_ = 3;
  if (local_1c != 0) {
    FUN_00406460(psVar2);
    local_8._0_1_ = 4;
    iVar5 = FUN_0081f330(local_4c);
    local_8._0_1_ = 3;
    if (7 < local_54) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_54 = 7;
    local_58 = 0;
    local_68 = 0;
    psVar6 = psVar2;
    if (iVar5 != 0) {
      do {
        sVar1 = *psVar6;
        psVar6 = psVar6 + 1;
      } while (sVar1 != 0);
      iVar5 = FUN_00405bb0(psVar2);
      if ((iVar5 == 0) || (cVar3 = FUN_00403810(), cVar3 != '\0')) {
        if (3 < local_1c) {
          FUN_00405e10(0,3);
          uVar7 = FUN_00403450(local_8c,local_30);
          local_8._0_1_ = 5;
          FUN_00405eb0(uVar7,0,0xffffffff);
          local_8._0_1_ = 3;
          FUN_00406560();
        }
      }
      else if (local_1c < 4) {
        FUN_00405eb0(local_4c,0,0xffffffff);
      }
      else {
        local_70[0] = 0x28;
        iVar5 = FUN_00407cc0(local_70,1);
        if (iVar5 != -1) {
          FUN_00405e10(iVar5,local_1c - iVar5);
          FUN_00405c30(local_4c,0,0xffffffff);
        }
      }
    }
    if (*(int *)(DAT_0172491c + 0x90) != 0) {
      if (local_18 < 8) {
        ppppuVar8 = local_2c;
      }
      else {
        ppppuVar8 = (undefined4 ****)local_2c[0];
        if ((undefined4 ****)local_2c[0] == (undefined4 ****)0x0) goto LAB_0044fa3b;
      }
      FUN_00512b50(ppppuVar8,0xffffffff);
    }
  }
LAB_0044fa3b:
  local_8 = CONCAT31(local_8._1_3_,2);
  if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0(uVar4);
  }
  local_34 = 7;
  local_38 = 0;
  local_48 = 0;
  local_8 = 0xffffffff;
  if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0(uVar4);
  }
  local_18 = 7;
  local_1c = 0;
  local_2c[0] = (undefined4 ***)((uint)local_2c[0] & 0xffff0000);
LAB_0044fa7f:
  local_8 = 0xffffffff;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0044f840 : PUSH EBP
0044f841 : MOV EBP,ESP
0044f843 : PUSH -0x1
0044f845 : PUSH 0xb7df4b
0044f84a : MOV EAX,FS:[0x0]
0044f850 : PUSH EAX
0044f851 : SUB ESP,0x7c
0044f854 : MOV EAX,[0x00d66fa0]
0044f859 : XOR EAX,EBP
0044f85b : MOV dword ptr [EBP + -0x10],EAX
0044f85e : PUSH EBX
0044f85f : PUSH ESI
0044f860 : PUSH EDI
0044f861 : PUSH EAX
0044f862 : LEA EAX,[EBP + -0xc]
0044f865 : MOV FS:[0x0],EAX
0044f86b : MOV EAX,dword ptr [EBP + 0x8]
0044f86e : MOV EBX,dword ptr [EAX]
0044f870 : CMP word ptr [EBX],0x24
0044f874 : MOV dword ptr [EBP + -0x4c],EAX
0044f877 : JNZ 0x0044fa7f
0044f87d : LEA EAX,[EBX + 0x2]
0044f880 : PUSH EAX
0044f881 : LEA ECX,[EBP + -0x68]
0044f884 : CALL 0x00406460
0044f889 : MOV dword ptr [EBP + -0x4],0x0
0044f890 : MOV ECX,dword ptr [0x0172491c]
0044f896 : PUSH ECX
0044f897 : LEA ECX,[EBP + -0x68]
0044f89a : LEA ESI,[EBP + -0x2c]
0044f89d : CALL 0x0081cce0
0044f8a2 : MOV byte ptr [EBP + -0x4],0x2
0044f8a6 : MOV EDI,0x8
0044f8ab : CMP dword ptr [EBP + -0x50],EDI
0044f8ae : JC 0x0044f8b8
0044f8b0 : MOV ECX,dword ptr [EBP + -0x64]
0044f8b3 : CALL 0x006f04e0
0044f8b8 : XOR EDX,EDX
0044f8ba : PUSH 0xcca49c
0044f8bf : LEA ECX,[EBP + -0x48]
0044f8c2 : MOV dword ptr [EBP + -0x50],0x7
0044f8c9 : MOV dword ptr [EBP + -0x54],0x0
0044f8d0 : MOV word ptr [EBP + -0x64],DX
0044f8d4 : CALL 0x00406460
0044f8d9 : MOV byte ptr [EBP + -0x4],0x3
0044f8dd : CMP dword ptr [EBP + -0x18],0x0
0044f8e1 : JZ 0x0044fa3b
0044f8e7 : PUSH EBX
0044f8e8 : LEA ECX,[EBP + -0x68]
0044f8eb : CALL 0x00406460
0044f8f0 : MOV byte ptr [EBP + -0x4],0x4
0044f8f4 : MOV ECX,dword ptr [0x0172491c]
0044f8fa : LEA EAX,[EBP + -0x48]
0044f8fd : PUSH EAX
0044f8fe : LEA EDX,[EBP + -0x68]
0044f901 : CALL 0x0081f330
0044f906 : MOV ESI,EAX
0044f908 : MOV byte ptr [EBP + -0x4],0x3
0044f90c : CMP dword ptr [EBP + -0x50],EDI
0044f90f : JC 0x0044f919
0044f911 : MOV ECX,dword ptr [EBP + -0x64]
0044f914 : CALL 0x006f04e0
0044f919 : XOR ECX,ECX
0044f91b : MOV dword ptr [EBP + -0x50],0x7
0044f922 : MOV dword ptr [EBP + -0x54],0x0
0044f929 : MOV word ptr [EBP + -0x64],CX
0044f92d : TEST ESI,ESI
0044f92f : JZ 0x0044fa10
0044f935 : MOV EAX,EBX
0044f937 : LEA EDX,[EAX + 0x2]
0044f93a : LEA EBX,[EBX]
0044f940 : MOV CX,word ptr [EAX]
0044f943 : ADD EAX,0x2
0044f946 : TEST CX,CX
0044f949 : JNZ 0x0044f940
0044f94b : SUB EAX,EDX
0044f94d : SAR EAX,0x1
0044f94f : MOV EDI,EAX
0044f951 : MOV EAX,[0x00d71c28]
0044f956 : PUSH EBX
0044f957 : MOV ECX,0xd71c14
0044f95c : CALL 0x00405bb0
0044f961 : TEST EAX,EAX
0044f963 : JZ 0x0044f9c8
0044f965 : MOV ECX,0xd71c30
0044f96a : MOV ESI,EBX
0044f96c : CALL 0x00403810
0044f971 : TEST AL,AL
0044f973 : JNZ 0x0044f9c8
0044f975 : MOV ESI,dword ptr [EBP + -0x18]
0044f978 : CMP ESI,0x3
0044f97b : JBE 0x0044f9b6
0044f97d : PUSH 0x1
0044f97f : LEA EDX,[EBP + -0x6c]
0044f982 : PUSH EDX
0044f983 : OR ECX,0xffffffff
0044f986 : LEA EDI,[EBP + -0x2c]
0044f989 : MOV dword ptr [EBP + -0x6c],0x28
0044f990 : CALL 0x00407cc0
0044f995 : CMP EAX,-0x1
0044f998 : JZ 0x0044fa10
0044f99a : SUB ESI,EAX
0044f99c : PUSH ESI
0044f99d : PUSH EAX
0044f99e : MOV ECX,EDI
0044f9a0 : CALL 0x00405e10
0044f9a5 : PUSH -0x1
0044f9a7 : PUSH 0x0
0044f9a9 : LEA EAX,[EBP + -0x48]
0044f9ac : PUSH EAX
0044f9ad : MOV ECX,EDI
0044f9af : CALL 0x00405c30
0044f9b4 : JMP 0x0044fa10
0044f9b6 : PUSH -0x1
0044f9b8 : PUSH 0x0
0044f9ba : LEA ECX,[EBP + -0x48]
0044f9bd : PUSH ECX
0044f9be : LEA ECX,[EBP + -0x2c]
0044f9c1 : CALL 0x00405eb0
0044f9c6 : JMP 0x0044fa10
0044f9c8 : CMP dword ptr [EBP + -0x18],0x3
0044f9cc : JBE 0x0044fa10
0044f9ce : PUSH 0x3
0044f9d0 : PUSH 0x0
0044f9d2 : LEA ECX,[EBP + -0x2c]
0044f9d5 : CALL 0x00405e10
0044f9da : LEA EDX,[EBP + -0x2c]
0044f9dd : PUSH EDX
0044f9de : LEA EAX,[EBP + 0xffffff78]
0044f9e4 : PUSH EAX
0044f9e5 : LEA ECX,[EBP + -0x48]
0044f9e8 : CALL 0x00403450
0044f9ed : ADD ESP,0x8
0044f9f0 : MOV byte ptr [EBP + -0x4],0x5
0044f9f4 : PUSH -0x1
0044f9f6 : PUSH 0x0
0044f9f8 : PUSH EAX
0044f9f9 : LEA ECX,[EBP + -0x2c]
0044f9fc : CALL 0x00405eb0
0044fa01 : MOV byte ptr [EBP + -0x4],0x3
0044fa05 : LEA ECX,[EBP + 0xffffff78]
0044fa0b : CALL 0x00406560
0044fa10 : MOV ECX,dword ptr [0x0172491c]
0044fa16 : CMP dword ptr [ECX + 0x90],0x0
0044fa1d : MOV EDI,0x8
0044fa22 : JZ 0x0044fa3b
0044fa24 : CMP dword ptr [EBP + -0x14],EDI
0044fa27 : JC 0x0044fa9d
0044fa29 : MOV EAX,dword ptr [EBP + -0x28]
0044fa2c : TEST EAX,EAX
0044fa2e : JZ 0x0044fa3b
0044fa30 : MOV ECX,dword ptr [EBP + -0x4c]
0044fa33 : PUSH -0x1
0044fa35 : PUSH EAX
0044fa36 : CALL 0x00512b50
0044fa3b : MOV byte ptr [EBP + -0x4],0x2
0044fa3f : CMP dword ptr [EBP + -0x30],EDI
0044fa42 : JC 0x0044fa4c
0044fa44 : MOV ECX,dword ptr [EBP + -0x44]
0044fa47 : CALL 0x006f04e0
0044fa4c : MOV EBX,0x7
0044fa51 : XOR ESI,ESI
0044fa53 : XOR EDX,EDX
0044fa55 : MOV dword ptr [EBP + -0x30],EBX
0044fa58 : MOV dword ptr [EBP + -0x34],ESI
0044fa5b : MOV word ptr [EBP + -0x44],DX
0044fa5f : MOV dword ptr [EBP + -0x4],0xffffffff
0044fa66 : CMP dword ptr [EBP + -0x14],EDI
0044fa69 : JC 0x0044fa73
0044fa6b : MOV ECX,dword ptr [EBP + -0x28]
0044fa6e : CALL 0x006f04e0
0044fa73 : XOR EAX,EAX
0044fa75 : MOV dword ptr [EBP + -0x14],EBX
0044fa78 : MOV dword ptr [EBP + -0x18],ESI
0044fa7b : MOV word ptr [EBP + -0x28],AX
0044fa7f : MOV ECX,dword ptr [EBP + -0xc]
0044fa82 : MOV dword ptr FS:[0x0],ECX
0044fa89 : POP ECX
0044fa8a : POP EDI
0044fa8b : POP ESI
0044fa8c : POP EBX
0044fa8d : MOV ECX,dword ptr [EBP + -0x10]
0044fa90 : XOR ECX,EBP
0044fa92 : CALL 0x00633e6b
0044fa97 : MOV ESP,EBP
0044fa99 : POP EBP
0044fa9a : RET 0x4
0044fa9d : LEA EAX,[EBP + -0x28]
0044faa0 : JMP 0x0044fa30

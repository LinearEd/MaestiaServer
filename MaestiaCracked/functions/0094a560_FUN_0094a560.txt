PROGRAM  : Maestia.exe
FUNCTION : FUN_0094a560
ENTRY    : 0094a560
BODY     : [[0094a560, 0094a690]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0094a560(int param_1,undefined4 param_2,char param_3)

{
  int *piVar1;
  int iVar2;
  int *piVar3;
  int *unaff_ESI;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b35a4f;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if ((unaff_ESI[0x19] - unaff_ESI[0x18] & 0xfffffffcU) != 0) {
    piVar1 = (int *)unaff_ESI[0x19];
    piVar3 = (int *)FUN_004268b0(unaff_ESI[0x18],piVar1,param_1,local_14);
    if (((int *)*piVar3 != piVar1) && (iVar2 = *(int *)*piVar3, iVar2 != 0)) {
      if (param_3 == '\0') {
        FUN_00406360(&DAT_00c743e0,0);
        *(undefined4 *)(iVar2 + 0xc0) = 0;
      }
      else {
        FUN_00406460(&DAT_00c743dc);
        local_8 = 0;
        (**(code **)(*unaff_ESI + 0x58))(param_2,local_30);
        FUN_00405eb0(local_30,0,0xffffffff);
        *(undefined4 *)(iVar2 + 0xc0) = param_2;
        local_8 = 0xffffffff;
        if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_18 = 7;
        local_1c = 0;
        local_2c = 0;
      }
      if ((param_1 == unaff_ESI[0x1b]) &&
         (*(char *)(*(int *)(*DAT_00da9894 + 0x294) + 0x32) != '\0')) {
        FUN_0094e8e0(*(int *)(*DAT_00da9894 + 0x294));
      }
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0094a560 : PUSH EBP
0094a561 : MOV EBP,ESP
0094a563 : PUSH -0x1
0094a565 : PUSH 0xb35a4f
0094a56a : MOV EAX,FS:[0x0]
0094a570 : PUSH EAX
0094a571 : SUB ESP,0x24
0094a574 : MOV EAX,[0x00d66fa0]
0094a579 : XOR EAX,EBP
0094a57b : MOV dword ptr [EBP + -0x10],EAX
0094a57e : PUSH EBX
0094a57f : PUSH EDI
0094a580 : PUSH EAX
0094a581 : LEA EAX,[EBP + -0xc]
0094a584 : MOV FS:[0x0],EAX
0094a58a : MOV EBX,dword ptr [EBP + 0xc]
0094a58d : MOV EAX,dword ptr [ESI + 0x64]
0094a590 : SUB EAX,dword ptr [ESI + 0x60]
0094a593 : TEST EAX,0xfffffffc
0094a598 : JZ 0x0094a674
0094a59e : MOV ECX,dword ptr [EBP + 0x8]
0094a5a1 : MOV EDI,dword ptr [ESI + 0x64]
0094a5a4 : MOV EAX,dword ptr [ESI + 0x60]
0094a5a7 : PUSH ECX
0094a5a8 : PUSH EDI
0094a5a9 : PUSH EAX
0094a5aa : LEA EAX,[EBP + -0x30]
0094a5ad : CALL 0x004268b0
0094a5b2 : MOV EAX,dword ptr [EAX]
0094a5b4 : ADD ESP,0xc
0094a5b7 : CMP EAX,EDI
0094a5b9 : JZ 0x0094a674
0094a5bf : MOV EDI,dword ptr [EAX]
0094a5c1 : TEST EDI,EDI
0094a5c3 : JZ 0x0094a674
0094a5c9 : CMP byte ptr [EBP + 0x10],0x0
0094a5cd : JZ 0x0094a635
0094a5cf : PUSH 0xc743dc
0094a5d4 : LEA ECX,[EBP + -0x2c]
0094a5d7 : CALL 0x00406460
0094a5dc : MOV dword ptr [EBP + -0x4],0x0
0094a5e3 : MOV EDX,dword ptr [ESI]
0094a5e5 : MOV EDX,dword ptr [EDX + 0x58]
0094a5e8 : LEA EAX,[EBP + -0x2c]
0094a5eb : PUSH EAX
0094a5ec : PUSH EBX
0094a5ed : MOV ECX,ESI
0094a5ef : CALL EDX
0094a5f1 : PUSH -0x1
0094a5f3 : PUSH 0x0
0094a5f5 : LEA EAX,[EBP + -0x2c]
0094a5f8 : PUSH EAX
0094a5f9 : LEA ECX,[EDI + 0xc4]
0094a5ff : CALL 0x00405eb0
0094a604 : MOV dword ptr [EDI + 0xc0],EBX
0094a60a : MOV dword ptr [EBP + -0x4],0xffffffff
0094a611 : CMP dword ptr [EBP + -0x14],0x8
0094a615 : JC 0x0094a61f
0094a617 : MOV ECX,dword ptr [EBP + -0x28]
0094a61a : CALL 0x006f04e0
0094a61f : XOR ECX,ECX
0094a621 : MOV dword ptr [EBP + -0x14],0x7
0094a628 : MOV dword ptr [EBP + -0x18],0x0
0094a62f : MOV word ptr [EBP + -0x28],CX
0094a633 : JMP 0x0094a651
0094a635 : PUSH 0x0
0094a637 : PUSH 0xc743e0
0094a63c : LEA ECX,[EDI + 0xc4]
0094a642 : CALL 0x00406360
0094a647 : MOV dword ptr [EDI + 0xc0],0x0
0094a651 : MOV EDX,dword ptr [EBP + 0x8]
0094a654 : CMP EDX,dword ptr [ESI + 0x6c]
0094a657 : JNZ 0x0094a674
0094a659 : MOV EAX,[0x00da9894]
0094a65e : MOV ECX,dword ptr [EAX]
0094a660 : MOV EAX,dword ptr [ECX + 0x294]
0094a666 : CMP byte ptr [EAX + 0x32],0x0
0094a66a : JZ 0x0094a674
0094a66c : PUSH EAX
0094a66d : MOV ECX,EDI
0094a66f : CALL 0x0094e8e0
0094a674 : MOV ECX,dword ptr [EBP + -0xc]
0094a677 : MOV dword ptr FS:[0x0],ECX
0094a67e : POP ECX
0094a67f : POP EDI
0094a680 : POP EBX
0094a681 : MOV ECX,dword ptr [EBP + -0x10]
0094a684 : XOR ECX,EBP
0094a686 : CALL 0x00633e6b
0094a68b : MOV ESP,EBP
0094a68d : POP EBP
0094a68e : RET 0xc

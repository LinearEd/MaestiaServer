PROGRAM  : Maestia.exe
FUNCTION : FUN_008cd770
ENTRY    : 008cd770
BODY     : [[008cd770, 008cd8ea] [008cd8f0, 008cdaa9]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x008cd9a3) */

void FUN_008cd770(int param_1,ushort *param_2)

{
  byte bVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  uint local_74;
  uint local_58;
  uint local_3c;
  undefined1 local_38 [4];
  undefined2 local_34;
  undefined4 local_24;
  uint local_20;
  int local_1c;
  int local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b51981;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  iVar3 = FUN_00703c00(0xa802,DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
  if (iVar3 != 0) {
    *(undefined2 *)(param_1 + 0x84 + (uint)*(ushort *)((int)param_2 + 4) * 2) = 1;
    FUN_00406460(L"IDS_ITEMCRAFT_LEARN_CRAFT_NOTICE");
    local_8 = 0;
    piVar2 = *(int **)(*DAT_00da9894 + 0x1a8);
    iVar3 = FUN_00824a20(DAT_0172491c,0);
    local_8._0_1_ = 1;
    iVar4 = FUN_0081d120(local_38);
    local_8._0_1_ = 2;
    if (*(uint *)(iVar3 + 0x18) < 8) {
      iVar3 = iVar3 + 4;
    }
    else {
      iVar3 = *(int *)(iVar3 + 4);
    }
    if (*(uint *)(iVar4 + 0x18) < 8) {
      iVar4 = iVar4 + 4;
    }
    else {
      iVar4 = *(int *)(iVar4 + 4);
    }
    uVar5 = FUN_00404750(iVar4,iVar3);
    local_8._0_1_ = 3;
    (**(code **)(*piVar2 + 0x44))(uVar5,0xd);
    local_8 = CONCAT31(local_8._1_3_,2);
    if (7 < local_3c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_8 = CONCAT31(local_8._1_3_,1);
    if (7 < local_58) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_74) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_8 = 0xffffffff;
    if (7 < local_20) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    param_2 = (ushort *)((int)param_2 + 6);
    local_20 = 7;
    local_24 = 0;
    local_34 = 0;
    local_14 = 0;
    while (iVar3 = FUN_00703c00(0xa801), iVar3 != 0) {
      bVar1 = *(byte *)(iVar3 + 0x40);
      local_18 = ((uint)bVar1 * 100 + (uint)(*(byte *)(iVar3 + 0x41) >> 4)) * 100;
      if (3 < bVar1) {
        local_20 = 7;
        local_24 = 0;
        local_34 = 0;
        FUN_00406360(L"Buffer Over Run",0xf);
        local_8 = 4;
        if ((int *)*DAT_00da98e8 != (int *)0x0) {
          (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                    (L"AvaGuiCraft::ReceiveCraftLearn",0x2f2,local_38);
        }
        local_8 = 0xffffffff;
        if (local_20 < 8) {
          ExceptionList = local_10;
          return;
        }
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      FUN_004437f0(&local_18);
      iVar4 = local_1c;
      if (local_1c != *(int *)(param_1 + ((uint)bVar1 * 3 + 0x15) * 4)) {
        uVar5 = FUN_00824a20(DAT_0172491c,0);
        local_8 = 5;
        FUN_00405eb0(uVar5,0,0xffffffff);
        local_8 = 0xffffffff;
        *(uint *)(*(int *)(iVar4 + 0x10) + 4) = (uint)*param_2;
        *(uint *)(*(int *)(iVar4 + 0x10) + 0x28) = (uint)*(ushort *)(iVar3 + 0x46);
        *(uint *)(*(int *)(iVar4 + 0x10) + 0x24) = (uint)*(ushort *)(iVar3 + 0x44);
        *(uint *)(*(int *)(iVar4 + 0x10) + 0x2c) = (uint)*(ushort *)(iVar3 + 0x48);
        *(ushort *)(*(int *)(iVar4 + 0x10) + 0x34) = (ushort)*(byte *)(iVar3 + 0x42);
        *(undefined2 *)(*(int *)(iVar4 + 0x10) + 0x36) = *(undefined2 *)(iVar3 + 0x4c);
      }
      param_2 = param_2 + 1;
      local_14 = local_14 + 1;
      if (6 < local_14) {
        ExceptionList = local_10;
        return;
      }
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
008cd770 : PUSH EBP
008cd771 : MOV EBP,ESP
008cd773 : PUSH -0x1
008cd775 : PUSH 0xb51981
008cd77a : MOV EAX,FS:[0x0]
008cd780 : PUSH EAX
008cd781 : SUB ESP,0x7c
008cd784 : PUSH EBX
008cd785 : PUSH ESI
008cd786 : PUSH EDI
008cd787 : MOV EAX,[0x00d66fa0]
008cd78c : XOR EAX,EBP
008cd78e : PUSH EAX
008cd78f : LEA EAX,[EBP + -0xc]
008cd792 : MOV FS:[0x0],EAX
008cd798 : MOV EBX,dword ptr [EBP + 0xc]
008cd79b : MOV DI,word ptr [EBX + 0x4]
008cd79f : PUSH 0xa802
008cd7a4 : CALL 0x00703c00
008cd7a9 : MOV ESI,EAX
008cd7ab : ADD ESP,0x4
008cd7ae : TEST ESI,ESI
008cd7b0 : JZ 0x008cda96
008cd7b6 : MOVZX EAX,word ptr [EBX + 0x4]
008cd7ba : MOV EDX,dword ptr [EBP + 0x8]
008cd7bd : MOV ECX,0x1
008cd7c2 : MOV word ptr [EDX + EAX*0x2 + 0x84],CX
008cd7ca : PUSH 0xc53a20
008cd7cf : LEA ECX,[EBP + -0x34]
008cd7d2 : CALL 0x00406460
008cd7d7 : MOV dword ptr [EBP + -0x4],0x0
008cd7de : MOV EAX,[0x00da9894]
008cd7e3 : MOV ECX,dword ptr [0x0172491c]
008cd7e9 : MOV EAX,dword ptr [EAX]
008cd7eb : MOV EBX,dword ptr [EAX + 0x1a8]
008cd7f1 : PUSH 0x0
008cd7f3 : LEA EDX,[ESI + 0x18]
008cd7f6 : PUSH ECX
008cd7f7 : LEA ESI,[EBP + 0xffffff78]
008cd7fd : CALL 0x00824a20
008cd802 : MOV ESI,EAX
008cd804 : MOV byte ptr [EBP + -0x4],0x1
008cd808 : MOV ECX,dword ptr [0x0172491c]
008cd80e : LEA EDX,[EBP + -0x34]
008cd811 : PUSH EDX
008cd812 : LEA EDI,[EBP + -0x6c]
008cd815 : CALL 0x0081d120
008cd81a : MOV byte ptr [EBP + -0x4],0x2
008cd81e : MOV EDI,0x8
008cd823 : CMP dword ptr [ESI + 0x18],EDI
008cd826 : JC 0x008cd82d
008cd828 : MOV ESI,dword ptr [ESI + 0x4]
008cd82b : JMP 0x008cd830
008cd82d : ADD ESI,0x4
008cd830 : CMP dword ptr [EAX + 0x18],EDI
008cd833 : JC 0x008cd83a
008cd835 : MOV EAX,dword ptr [EAX + 0x4]
008cd838 : JMP 0x008cd83d
008cd83a : ADD EAX,0x4
008cd83d : PUSH ESI
008cd83e : PUSH EAX
008cd83f : LEA ESI,[EBP + -0x50]
008cd842 : CALL 0x00404750
008cd847 : ADD ESP,0x8
008cd84a : MOV byte ptr [EBP + -0x4],0x3
008cd84e : MOV EDX,dword ptr [EBX]
008cd850 : PUSH 0xd
008cd852 : PUSH EAX
008cd853 : MOV EAX,dword ptr [EDX + 0x44]
008cd856 : MOV ECX,EBX
008cd858 : CALL EAX
008cd85a : MOV byte ptr [EBP + -0x4],0x2
008cd85e : CMP dword ptr [EBP + -0x38],EDI
008cd861 : JC 0x008cd86b
008cd863 : MOV ECX,dword ptr [EBP + -0x4c]
008cd866 : CALL 0x006f04e0
008cd86b : MOV ESI,0x7
008cd870 : XOR EBX,EBX
008cd872 : XOR ECX,ECX
008cd874 : MOV dword ptr [EBP + -0x38],ESI
008cd877 : MOV dword ptr [EBP + -0x3c],EBX
008cd87a : MOV word ptr [EBP + -0x4c],CX
008cd87e : MOV byte ptr [EBP + -0x4],0x1
008cd882 : CMP dword ptr [EBP + -0x54],EDI
008cd885 : JC 0x008cd88f
008cd887 : MOV ECX,dword ptr [EBP + -0x68]
008cd88a : CALL 0x006f04e0
008cd88f : XOR EDX,EDX
008cd891 : MOV dword ptr [EBP + -0x54],ESI
008cd894 : MOV dword ptr [EBP + -0x58],EBX
008cd897 : MOV word ptr [EBP + -0x68],DX
008cd89b : MOV byte ptr [EBP + -0x4],DL
008cd89e : CMP dword ptr [EBP + -0x70],EDI
008cd8a1 : JC 0x008cd8ae
008cd8a3 : MOV ECX,dword ptr [EBP + 0xffffff7c]
008cd8a9 : CALL 0x006f04e0
008cd8ae : XOR EAX,EAX
008cd8b0 : MOV dword ptr [EBP + -0x70],ESI
008cd8b3 : MOV dword ptr [EBP + -0x74],EBX
008cd8b6 : MOV word ptr [EBP + 0xffffff7c],AX
008cd8bd : MOV dword ptr [EBP + -0x4],0xffffffff
008cd8c4 : CMP dword ptr [EBP + -0x1c],EDI
008cd8c7 : JC 0x008cd8d1
008cd8c9 : MOV ECX,dword ptr [EBP + -0x30]
008cd8cc : CALL 0x006f04e0
008cd8d1 : MOV EDX,dword ptr [EBP + 0xc]
008cd8d4 : XOR ECX,ECX
008cd8d6 : ADD EDX,0x6
008cd8d9 : MOV dword ptr [EBP + -0x1c],ESI
008cd8dc : MOV dword ptr [EBP + -0x20],EBX
008cd8df : MOV word ptr [EBP + -0x30],CX
008cd8e3 : MOV dword ptr [EBP + -0x10],EBX
008cd8e6 : MOV dword ptr [EBP + 0xc],EDX
008cd8e9 : JMP 0x008cd8f2
008cd8f0 : XOR EBX,EBX
008cd8f2 : MOV EAX,dword ptr [EBP + 0xc]
008cd8f5 : MOV DI,word ptr [EAX]
008cd8f8 : PUSH 0xa801
008cd8fd : CALL 0x00703c00
008cd902 : MOV EDI,EAX
008cd904 : ADD ESP,0x4
008cd907 : CMP EDI,EBX
008cd909 : JZ 0x008cda96
008cd90f : MOVZX CX,byte ptr [EDI + 0x40]
008cd914 : MOV DL,byte ptr [EDI + 0x41]
008cd917 : MOVZX EAX,CX
008cd91a : SHR DL,0x4
008cd91d : MOVZX CX,DL
008cd921 : MOVZX ESI,AX
008cd924 : MOV EDX,ESI
008cd926 : IMUL EDX,EDX,0x64
008cd929 : MOVZX ECX,CX
008cd92c : MOVZX ECX,CX
008cd92f : ADD EDX,ECX
008cd931 : IMUL EDX,EDX,0x64
008cd934 : MOV dword ptr [EBP + -0x14],EDX
008cd937 : CMP AX,0x4
008cd93b : JNC 0x008cda2d
008cd941 : MOV EBX,dword ptr [EBP + 0x8]
008cd944 : LEA EAX,[ESI + ESI*0x2]
008cd947 : LEA EDX,[EBP + -0x14]
008cd94a : LEA ECX,[EBX + EAX*0x4 + 0x50]
008cd94e : PUSH EDX
008cd94f : LEA EAX,[EBP + -0x18]
008cd952 : CALL 0x004437f0
008cd957 : LEA ECX,[ESI + ESI*0x2 + 0x15]
008cd95b : MOV EAX,dword ptr [EBX + ECX*0x4]
008cd95e : MOV EBX,dword ptr [EBP + -0x18]
008cd961 : CMP EBX,EAX
008cd963 : JZ 0x008cda05
008cd969 : MOV EAX,[0x0172491c]
008cd96e : PUSH 0x0
008cd970 : LEA EDX,[EDI + 0x18]
008cd973 : PUSH EAX
008cd974 : LEA ESI,[EBP + 0xffffff78]
008cd97a : CALL 0x00824a20
008cd97f : MOV dword ptr [EBP + -0x4],0x5
008cd986 : MOV ECX,dword ptr [EBX + 0x10]
008cd989 : PUSH -0x1
008cd98b : PUSH 0x0
008cd98d : ADD ECX,0x8
008cd990 : PUSH EAX
008cd991 : CALL 0x00405eb0
008cd996 : MOV dword ptr [EBP + -0x4],0xffffffff
008cd99d : CMP dword ptr [EBP + -0x70],0x8
008cd9a1 : JC 0x008cd9ae
008cd9a3 : MOV ECX,dword ptr [EBP + 0xffffff7c]
008cd9a9 : CALL 0x006f04e0
008cd9ae : MOV EDX,dword ptr [EBP + 0xc]
008cd9b1 : MOVZX EAX,word ptr [EDX]
008cd9b4 : XOR ECX,ECX
008cd9b6 : MOV word ptr [EBP + 0xffffff7c],CX
008cd9bd : MOV ECX,dword ptr [EBX + 0x10]
008cd9c0 : MOV dword ptr [ECX + 0x4],EAX
008cd9c3 : MOVZX EDX,word ptr [EDI + 0x46]
008cd9c7 : MOV EAX,dword ptr [EBX + 0x10]
008cd9ca : MOV dword ptr [EAX + 0x28],EDX
008cd9cd : MOVZX ECX,word ptr [EDI + 0x44]
008cd9d1 : MOV EDX,dword ptr [EBX + 0x10]
008cd9d4 : MOV dword ptr [EDX + 0x24],ECX
008cd9d7 : MOVZX EAX,word ptr [EDI + 0x48]
008cd9db : MOV ECX,dword ptr [EBX + 0x10]
008cd9de : MOV dword ptr [ECX + 0x2c],EAX
008cd9e1 : MOVZX EDX,byte ptr [EDI + 0x42]
008cd9e5 : MOV EAX,dword ptr [EBX + 0x10]
008cd9e8 : MOV word ptr [EAX + 0x34],DX
008cd9ec : MOVZX EDX,word ptr [EDI + 0x4c]
008cd9f0 : MOV ECX,dword ptr [EBX + 0x10]
008cd9f3 : MOV dword ptr [EBP + -0x70],0x7
008cd9fa : MOV dword ptr [EBP + -0x74],0x0
008cda01 : MOV word ptr [ECX + 0x36],DX
008cda05 : MOV EAX,dword ptr [EBP + -0x10]
008cda08 : ADD dword ptr [EBP + 0xc],0x2
008cda0c : INC EAX
008cda0d : CMP EAX,0x7
008cda10 : MOV dword ptr [EBP + -0x10],EAX
008cda13 : JL 0x008cd8f0
008cda19 : MOV ECX,dword ptr [EBP + -0xc]
008cda1c : MOV dword ptr FS:[0x0],ECX
008cda23 : POP ECX
008cda24 : POP EDI
008cda25 : POP ESI
008cda26 : POP EBX
008cda27 : MOV ESP,EBP
008cda29 : POP EBP
008cda2a : RET 0x8
008cda2d : PUSH 0xf
008cda2f : XOR EAX,EAX
008cda31 : MOV ESI,0x7
008cda36 : PUSH 0xc53a64
008cda3b : LEA ECX,[EBP + -0x34]
008cda3e : MOV dword ptr [EBP + -0x1c],ESI
008cda41 : MOV dword ptr [EBP + -0x20],EBX
008cda44 : MOV word ptr [EBP + -0x30],AX
008cda48 : CALL 0x00406360
008cda4d : MOV dword ptr [EBP + -0x4],0x4
008cda54 : MOV ECX,dword ptr [0x00da98e8]
008cda5a : MOV ECX,dword ptr [ECX]
008cda5c : CMP ECX,EBX
008cda5e : JZ 0x008cda75
008cda60 : MOV EDX,dword ptr [ECX]
008cda62 : MOV EDX,dword ptr [EDX + 0x14]
008cda65 : LEA EAX,[EBP + -0x34]
008cda68 : PUSH EAX
008cda69 : PUSH 0x2f2
008cda6e : PUSH 0xc53a84
008cda73 : CALL EDX
008cda75 : MOV dword ptr [EBP + -0x4],0xffffffff
008cda7c : CMP dword ptr [EBP + -0x1c],0x8
008cda80 : JC 0x008cda8a
008cda82 : MOV ECX,dword ptr [EBP + -0x30]
008cda85 : CALL 0x006f04e0
008cda8a : XOR EAX,EAX
008cda8c : MOV dword ptr [EBP + -0x1c],ESI
008cda8f : MOV dword ptr [EBP + -0x20],EBX
008cda92 : MOV word ptr [EBP + -0x30],AX
008cda96 : MOV ECX,dword ptr [EBP + -0xc]
008cda99 : MOV dword ptr FS:[0x0],ECX
008cdaa0 : POP ECX
008cdaa1 : POP EDI
008cdaa2 : POP ESI
008cdaa3 : POP EBX
008cdaa4 : MOV ESP,EBP
008cdaa6 : POP EBP
008cdaa7 : RET 0x8

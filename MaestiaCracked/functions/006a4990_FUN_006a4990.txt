PROGRAM  : Maestia.exe
FUNCTION : FUN_006a4990
ENTRY    : 006a4990
BODY     : [[006a4990, 006a4b76]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006a4990(int param_1,byte *param_2,undefined4 *param_3)

{
  byte bVar1;
  undefined4 uVar2;
  uint uVar3;
  uint *puVar4;
  uint uVar5;
  uint uVar6;
  int iVar7;
  byte *pbVar8;
  byte *pbVar9;
  byte *pbVar10;
  int local_14 [5];
  
  local_14[0] = 0;
  if ((byte *)(param_1 + 5U) <= param_2) {
    bVar1 = *(byte *)(param_1 + 3);
    uVar5 = (uint)*(byte *)(param_1 + 4);
    uVar6 = uVar5 + param_3[0x17];
    pbVar8 = (byte *)(param_1 + 5);
    if ((uint)param_3[0x18] < uVar6) {
      uVar6 = uVar6 + 3 & 0xfffffffc;
      uVar2 = FUN_0068a220(*param_3,0x24,param_3[0x17],uVar6,param_3[0x19],local_14);
      param_3[0x19] = uVar2;
      if (local_14[0] != 0) {
        return local_14[0];
      }
      param_3[0x18] = uVar6;
    }
    iVar7 = 8;
    if ((bVar1 & 1) != 0) {
      iVar7 = 9;
    }
    if ((bVar1 & 2) != 0) {
      iVar7 = iVar7 + 1;
    }
    if ((bVar1 & 4) != 0) {
      iVar7 = iVar7 + 1;
    }
    if ((bVar1 & 8) != 0) {
      iVar7 = iVar7 + 1;
    }
    if ((bVar1 & 0x10) != 0) {
      iVar7 = iVar7 + 1;
    }
    puVar4 = (uint *)(param_3[0x19] + param_3[0x17] * 0x24);
    uVar6 = uVar5;
    if (pbVar8 + iVar7 * uVar5 <= param_2) {
      for (; uVar6 != 0; uVar6 = uVar6 - 1) {
        if ((bVar1 & 1) == 0) {
          uVar3 = (uint)*pbVar8;
          pbVar9 = pbVar8 + 1;
        }
        else {
          pbVar9 = pbVar8 + 2;
          uVar3 = (uint)CONCAT11(*pbVar8,pbVar8[1]);
        }
        *puVar4 = uVar3;
        if ((bVar1 & 2) == 0) {
          uVar3 = (uint)*pbVar9;
          pbVar8 = pbVar9 + 1;
        }
        else {
          pbVar8 = pbVar9 + 2;
          uVar3 = (uint)CONCAT11(*pbVar9,pbVar9[1]);
        }
        puVar4[1] = uVar3;
        puVar4[2] = (uint)*pbVar8;
        if ((bVar1 & 4) == 0) {
          pbVar9 = pbVar8 + 3;
          uVar3 = (uint)pbVar8[1];
        }
        else {
          pbVar9 = pbVar8 + 4;
          uVar3 = (uint)CONCAT11(pbVar8[1],pbVar8[2]);
        }
        puVar4[5] = uVar3 << 8 | (uint)pbVar9[-1];
        if ((bVar1 & 8) == 0) {
          pbVar10 = pbVar9 + 2;
          uVar3 = (uint)*pbVar9;
        }
        else {
          pbVar10 = pbVar9 + 3;
          uVar3 = (uint)CONCAT11(*pbVar9,pbVar9[1]);
        }
        puVar4[6] = uVar3 << 8 | (uint)pbVar10[-1];
        if ((bVar1 & 0x10) == 0) {
          uVar3 = (uint)*pbVar10;
          pbVar8 = pbVar10 + 1;
        }
        else {
          pbVar8 = pbVar10 + 2;
          uVar3 = (uint)CONCAT11(*pbVar10,pbVar10[1]);
        }
        puVar4[7] = uVar3;
        puVar4 = puVar4 + 9;
      }
      param_3[0x17] = param_3[0x17] + uVar5;
      return local_14[0];
    }
  }
  return 8;
}



============================================================
DISASSEMBLY
============================================================
006a4990 : SUB ESP,0x14
006a4993 : PUSH EBX
006a4994 : PUSH EBP
006a4995 : PUSH ESI
006a4996 : MOV ESI,dword ptr [ESP + 0x24]
006a499a : PUSH EDI
006a499b : MOV EDI,dword ptr [ESP + 0x30]
006a499f : MOV EAX,dword ptr [EDI]
006a49a1 : XOR EBP,EBP
006a49a3 : LEA ECX,[ESI + 0x5]
006a49a6 : MOV dword ptr [ESP + 0x10],EBP
006a49aa : CMP ECX,dword ptr [ESP + 0x2c]
006a49ae : JA 0x006a4a65
006a49b4 : MOVZX EBX,byte ptr [ESI + 0x3]
006a49b8 : MOV ECX,dword ptr [EDI + 0x5c]
006a49bb : ADD ESI,0x3
006a49be : MOVZX EDX,byte ptr [ESI + 0x1]
006a49c2 : INC ESI
006a49c3 : MOV dword ptr [ESP + 0x28],EDX
006a49c7 : ADD EDX,ECX
006a49c9 : INC ESI
006a49ca : CMP EDX,dword ptr [EDI + 0x60]
006a49cd : JBE 0x006a4a07
006a49cf : MOV EBP,dword ptr [ESP + 0x30]
006a49d3 : LEA EDI,[EDX + 0x3]
006a49d6 : LEA EDX,[ESP + 0x10]
006a49da : PUSH EDX
006a49db : MOV EDX,dword ptr [EBP + 0x64]
006a49de : PUSH EDX
006a49df : AND EDI,0xfffffffc
006a49e2 : PUSH EDI
006a49e3 : PUSH ECX
006a49e4 : PUSH 0x24
006a49e6 : PUSH EAX
006a49e7 : CALL 0x0068a220
006a49ec : MOV dword ptr [EBP + 0x64],EAX
006a49ef : MOV EBP,dword ptr [ESP + 0x28]
006a49f3 : ADD ESP,0x18
006a49f6 : TEST EBP,EBP
006a49f8 : JNZ 0x006a4b6d
006a49fe : MOV EAX,dword ptr [ESP + 0x30]
006a4a02 : MOV dword ptr [EAX + 0x60],EDI
006a4a05 : MOV EDI,EAX
006a4a07 : MOV EAX,EBX
006a4a09 : AND EAX,0x1
006a4a0c : MOV EDX,0x8
006a4a11 : MOV dword ptr [ESP + 0x14],EAX
006a4a15 : JZ 0x006a4a1c
006a4a17 : MOV EDX,0x9
006a4a1c : MOV ECX,EBX
006a4a1e : AND ECX,0x2
006a4a21 : MOV dword ptr [ESP + 0x18],ECX
006a4a25 : JZ 0x006a4a28
006a4a27 : INC EDX
006a4a28 : MOV ECX,EBX
006a4a2a : AND ECX,0x4
006a4a2d : MOV dword ptr [ESP + 0x1c],ECX
006a4a31 : JZ 0x006a4a34
006a4a33 : INC EDX
006a4a34 : MOV ECX,EBX
006a4a36 : AND ECX,0x8
006a4a39 : MOV dword ptr [ESP + 0x20],ECX
006a4a3d : JZ 0x006a4a40
006a4a3f : INC EDX
006a4a40 : AND EBX,0x10
006a4a43 : MOV dword ptr [ESP + 0x30],EBX
006a4a47 : JZ 0x006a4a4a
006a4a49 : INC EDX
006a4a4a : MOV ECX,dword ptr [EDI + 0x5c]
006a4a4d : MOV EBX,dword ptr [EDI + 0x64]
006a4a50 : LEA ECX,[ECX + ECX*0x8]
006a4a53 : LEA ECX,[EBX + ECX*0x4]
006a4a56 : MOV EBX,dword ptr [ESP + 0x28]
006a4a5a : IMUL EDX,EBX
006a4a5d : ADD EDX,ESI
006a4a5f : CMP EDX,dword ptr [ESP + 0x2c]
006a4a63 : JBE 0x006a4a72
006a4a65 : POP EDI
006a4a66 : POP ESI
006a4a67 : POP EBP
006a4a68 : MOV EAX,0x8
006a4a6d : POP EBX
006a4a6e : ADD ESP,0x14
006a4a71 : RET
006a4a72 : TEST EBX,EBX
006a4a74 : JBE 0x006a4b6a
006a4a7a : MOV EBP,dword ptr [ESP + 0x30]
006a4a7e : MOV EDX,EBX
006a4a80 : JMP 0x006a4a86
006a4a82 : MOV EAX,dword ptr [ESP + 0x14]
006a4a86 : TEST EAX,EAX
006a4a88 : JZ 0x006a4aa0
006a4a8a : MOVZX AX,byte ptr [ESI]
006a4a8e : MOVZX EBX,byte ptr [ESI + 0x1]
006a4a92 : ADD ESI,0x2
006a4a95 : SHL AX,0x8
006a4a99 : MOVZX EAX,AX
006a4a9c : OR EAX,EBX
006a4a9e : JMP 0x006a4aa4
006a4aa0 : MOVZX EAX,byte ptr [ESI]
006a4aa3 : INC ESI
006a4aa4 : CMP dword ptr [ESP + 0x18],0x0
006a4aa9 : MOV dword ptr [ECX],EAX
006a4aab : JZ 0x006a4ac3
006a4aad : MOVZX AX,byte ptr [ESI]
006a4ab1 : MOVZX EBX,byte ptr [ESI + 0x1]
006a4ab5 : ADD ESI,0x2
006a4ab8 : SHL AX,0x8
006a4abc : MOVZX EAX,AX
006a4abf : OR EAX,EBX
006a4ac1 : JMP 0x006a4ac7
006a4ac3 : MOVZX EAX,byte ptr [ESI]
006a4ac6 : INC ESI
006a4ac7 : MOV dword ptr [ECX + 0x4],EAX
006a4aca : MOVZX EAX,byte ptr [ESI]
006a4acd : INC ESI
006a4ace : CMP dword ptr [ESP + 0x1c],0x0
006a4ad3 : MOV dword ptr [ECX + 0x8],EAX
006a4ad6 : JZ 0x006a4aec
006a4ad8 : MOVZX EAX,byte ptr [ESI]
006a4adb : MOVZX EBX,byte ptr [ESI + 0x1]
006a4adf : ADD ESI,0x3
006a4ae2 : SHL EAX,0x8
006a4ae5 : OR EAX,EBX
006a4ae7 : SHL EAX,0x8
006a4aea : JMP 0x006a4afa
006a4aec : MOVZX AX,byte ptr [ESI]
006a4af0 : ADD ESI,0x2
006a4af3 : SHL AX,0x8
006a4af7 : MOVZX EAX,AX
006a4afa : MOVZX EBX,byte ptr [ESI + -0x1]
006a4afe : OR EAX,EBX
006a4b00 : CMP dword ptr [ESP + 0x20],0x0
006a4b05 : MOV dword ptr [ECX + 0x14],EAX
006a4b08 : JZ 0x006a4b1e
006a4b0a : MOVZX EAX,byte ptr [ESI]
006a4b0d : MOVZX EBX,byte ptr [ESI + 0x1]
006a4b11 : ADD ESI,0x3
006a4b14 : SHL EAX,0x8
006a4b17 : OR EAX,EBX
006a4b19 : SHL EAX,0x8
006a4b1c : JMP 0x006a4b2c
006a4b1e : MOVZX AX,byte ptr [ESI]
006a4b22 : ADD ESI,0x2
006a4b25 : SHL AX,0x8
006a4b29 : MOVZX EAX,AX
006a4b2c : MOVZX EBX,byte ptr [ESI + -0x1]
006a4b30 : OR EAX,EBX
006a4b32 : MOV dword ptr [ECX + 0x18],EAX
006a4b35 : TEST EBP,EBP
006a4b37 : JZ 0x006a4b4f
006a4b39 : MOVZX AX,byte ptr [ESI]
006a4b3d : MOVZX EBX,byte ptr [ESI + 0x1]
006a4b41 : ADD ESI,0x2
006a4b44 : SHL AX,0x8
006a4b48 : MOVZX EAX,AX
006a4b4b : OR EAX,EBX
006a4b4d : JMP 0x006a4b53
006a4b4f : MOVZX EAX,byte ptr [ESI]
006a4b52 : INC ESI
006a4b53 : MOV dword ptr [ECX + 0x1c],EAX
006a4b56 : ADD ECX,0x24
006a4b59 : SUB EDX,0x1
006a4b5c : JNZ 0x006a4a82
006a4b62 : MOV EBP,dword ptr [ESP + 0x10]
006a4b66 : MOV EBX,dword ptr [ESP + 0x28]
006a4b6a : ADD dword ptr [EDI + 0x5c],EBX
006a4b6d : POP EDI
006a4b6e : POP ESI
006a4b6f : MOV EAX,EBP
006a4b71 : POP EBP
006a4b72 : POP EBX
006a4b73 : ADD ESP,0x14
006a4b76 : RET

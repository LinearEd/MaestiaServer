PROGRAM  : Maestia.exe
FUNCTION : FUN_00689d30
ENTRY    : 00689d30
BODY     : [[00689d30, 00689f00]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00689d30(undefined4 param_1,undefined4 param_2,int param_3,int *param_4,int *param_5)

{
  bool bVar1;
  int iVar2;
  uint uVar3;
  bool bVar4;
  int iVar5;
  int local_28;
  char local_24 [32];
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)&local_28;
  iVar2 = FUN_006877c0(param_2,param_3);
  if ((iVar2 == 0) && (iVar2 = FUN_006888a0(param_2,local_24,0x10), iVar2 == 0)) {
    iVar2 = CONCAT31(CONCAT21(CONCAT11(local_24[0],local_24[1]),local_24[2]),local_24[3]) + param_3;
    *param_5 = iVar2;
    iVar5 = CONCAT31(CONCAT21(CONCAT11(local_24[4],local_24[5]),local_24[6]),local_24[7]) + param_3;
    if ((CONCAT31(CONCAT21(CONCAT11(local_24[8],local_24[9]),local_24[10]),local_24[0xb]) + iVar2 ==
         iVar5) && ((iVar5 != param_3 && (iVar2 = FUN_006877c0(param_2,iVar5), iVar2 == 0)))) {
      local_24[0x1f] = local_24[0xf] + '\x01';
      iVar2 = FUN_006888a0(param_2,local_24 + 0x10,0x10);
      if (iVar2 == 0) {
        bVar4 = true;
        bVar1 = true;
        iVar2 = 0;
        do {
          if (local_24[iVar2 + 0x10] != '\0') {
            bVar4 = false;
          }
          if (local_24[iVar2 + 0x10] != local_24[iVar2]) {
            bVar1 = false;
          }
          if (local_24[iVar2 + 0x11] != '\0') {
            bVar4 = false;
          }
          if (local_24[iVar2 + 0x11] != local_24[iVar2 + 1]) {
            bVar1 = false;
          }
          if (local_24[iVar2 + 0x12] != '\0') {
            bVar4 = false;
          }
          if (local_24[iVar2 + 0x12] != local_24[iVar2 + 2]) {
            bVar1 = false;
          }
          if (local_24[iVar2 + 0x13] != '\0') {
            bVar4 = false;
          }
          if (local_24[iVar2 + 0x13] != local_24[iVar2 + 3]) {
            bVar1 = false;
          }
          iVar2 = iVar2 + 4;
        } while (iVar2 < 0x10);
        if ((bVar4) || (bVar1)) {
          local_28 = FUN_00687800(param_2,8);
          uVar3 = FUN_00687a80(param_2,&local_28);
          if ((local_28 == 0) && ((uVar3 & 0xffff) != 0xffffffff)) {
            iVar5 = (uVar3 & 0xffff) + iVar5;
            iVar2 = FUN_006877c0(param_2,iVar5);
            if (iVar2 == 0) {
              *param_4 = iVar5;
              __security_check_cookie(local_4 ^ (uint)&local_28);
              return;
            }
          }
        }
      }
    }
  }
  __security_check_cookie(local_4 ^ (uint)&local_28);
  return;
}



============================================================
DISASSEMBLY
============================================================
00689d30 : SUB ESP,0x28
00689d33 : MOV EAX,[0x00d66fa0]
00689d38 : XOR EAX,ESP
00689d3a : MOV dword ptr [ESP + 0x24],EAX
00689d3e : PUSH EBX
00689d3f : MOV EBX,dword ptr [ESP + 0x34]
00689d43 : PUSH EBP
00689d44 : MOV EBP,dword ptr [ESP + 0x40]
00689d48 : PUSH ESI
00689d49 : MOV ESI,dword ptr [ESP + 0x40]
00689d4d : PUSH EDI
00689d4e : MOV EDI,dword ptr [ESP + 0x4c]
00689d52 : PUSH ESI
00689d53 : PUSH EBX
00689d54 : CALL 0x006877c0
00689d59 : ADD ESP,0x8
00689d5c : TEST EAX,EAX
00689d5e : JNZ 0x00689eee
00689d64 : PUSH 0x10
00689d66 : LEA EAX,[ESP + 0x18]
00689d6a : PUSH EAX
00689d6b : PUSH EBX
00689d6c : CALL 0x006888a0
00689d71 : ADD ESP,0xc
00689d74 : TEST EAX,EAX
00689d76 : JNZ 0x00689eee
00689d7c : MOVZX ECX,byte ptr [ESP + 0x14]
00689d81 : MOVZX EDX,byte ptr [ESP + 0x15]
00689d86 : MOVZX EAX,byte ptr [ESP + 0x16]
00689d8b : SHL ECX,0x8
00689d8e : OR ECX,EDX
00689d90 : MOVZX EDX,byte ptr [ESP + 0x17]
00689d95 : SHL ECX,0x8
00689d98 : OR ECX,EAX
00689d9a : SHL ECX,0x8
00689d9d : OR ECX,EDX
00689d9f : MOVZX EDX,byte ptr [ESP + 0x1a]
00689da4 : LEA EAX,[ECX + ESI*0x1]
00689da7 : MOVZX ECX,byte ptr [ESP + 0x19]
00689dac : MOV dword ptr [EDI],EAX
00689dae : MOVZX EDI,byte ptr [ESP + 0x18]
00689db3 : SHL EDI,0x8
00689db6 : OR EDI,ECX
00689db8 : MOVZX ECX,byte ptr [ESP + 0x1b]
00689dbd : SHL EDI,0x8
00689dc0 : OR EDI,EDX
00689dc2 : MOVZX EDX,byte ptr [ESP + 0x1c]
00689dc7 : SHL EDI,0x8
00689dca : OR EDI,ECX
00689dcc : MOVZX ECX,byte ptr [ESP + 0x1d]
00689dd1 : SHL EDX,0x8
00689dd4 : OR EDX,ECX
00689dd6 : MOVZX ECX,byte ptr [ESP + 0x1e]
00689ddb : SHL EDX,0x8
00689dde : OR EDX,ECX
00689de0 : MOVZX ECX,byte ptr [ESP + 0x1f]
00689de5 : SHL EDX,0x8
00689de8 : OR EDX,ECX
00689dea : ADD EDI,ESI
00689dec : ADD EDX,EAX
00689dee : CMP EDX,EDI
00689df0 : JNZ 0x00689ee9
00689df6 : CMP EDI,ESI
00689df8 : JZ 0x00689ee9
00689dfe : PUSH EDI
00689dff : PUSH EBX
00689e00 : CALL 0x006877c0
00689e05 : ADD ESP,0x8
00689e08 : TEST EAX,EAX
00689e0a : JNZ 0x00689eee
00689e10 : MOV DL,byte ptr [ESP + 0x23]
00689e14 : PUSH 0x10
00689e16 : LEA EAX,[ESP + 0x28]
00689e1a : PUSH EAX
00689e1b : INC DL
00689e1d : PUSH EBX
00689e1e : MOV byte ptr [ESP + 0x3f],DL
00689e22 : CALL 0x006888a0
00689e27 : ADD ESP,0xc
00689e2a : TEST EAX,EAX
00689e2c : JNZ 0x00689eee
00689e32 : MOV EDX,0x1
00689e37 : MOV ESI,EDX
00689e39 : LEA ESP,[ESP]
00689e40 : MOV CL,byte ptr [ESP + EAX*0x1 + 0x24]
00689e44 : TEST CL,CL
00689e46 : JZ 0x00689e4a
00689e48 : XOR EDX,EDX
00689e4a : CMP CL,byte ptr [ESP + EAX*0x1 + 0x14]
00689e4e : JZ 0x00689e52
00689e50 : XOR ESI,ESI
00689e52 : MOV CL,byte ptr [ESP + EAX*0x1 + 0x25]
00689e56 : TEST CL,CL
00689e58 : JZ 0x00689e5c
00689e5a : XOR EDX,EDX
00689e5c : CMP CL,byte ptr [ESP + EAX*0x1 + 0x15]
00689e60 : JZ 0x00689e64
00689e62 : XOR ESI,ESI
00689e64 : MOV CL,byte ptr [ESP + EAX*0x1 + 0x26]
00689e68 : TEST CL,CL
00689e6a : JZ 0x00689e6e
00689e6c : XOR EDX,EDX
00689e6e : CMP CL,byte ptr [ESP + EAX*0x1 + 0x16]
00689e72 : JZ 0x00689e76
00689e74 : XOR ESI,ESI
00689e76 : MOV CL,byte ptr [ESP + EAX*0x1 + 0x27]
00689e7a : TEST CL,CL
00689e7c : JZ 0x00689e80
00689e7e : XOR EDX,EDX
00689e80 : CMP CL,byte ptr [ESP + EAX*0x1 + 0x17]
00689e84 : JZ 0x00689e88
00689e86 : XOR ESI,ESI
00689e88 : ADD EAX,0x4
00689e8b : CMP EAX,0x10
00689e8e : JL 0x00689e40
00689e90 : TEST EDX,EDX
00689e92 : JNZ 0x00689e98
00689e94 : TEST ESI,ESI
00689e96 : JZ 0x00689ee9
00689e98 : PUSH 0x8
00689e9a : PUSH EBX
00689e9b : CALL 0x00687800
00689ea0 : LEA ECX,[ESP + 0x18]
00689ea4 : PUSH ECX
00689ea5 : PUSH EBX
00689ea6 : MOV dword ptr [ESP + 0x20],EAX
00689eaa : CALL 0x00687a80
00689eaf : MOVZX ECX,AX
00689eb2 : MOV EAX,dword ptr [ESP + 0x20]
00689eb6 : ADD ESP,0x10
00689eb9 : TEST EAX,EAX
00689ebb : JNZ 0x00689eee
00689ebd : CMP ECX,-0x1
00689ec0 : JZ 0x00689ee9
00689ec2 : LEA ESI,[ECX + EDI*0x1]
00689ec5 : PUSH ESI
00689ec6 : PUSH EBX
00689ec7 : CALL 0x006877c0
00689ecc : ADD ESP,0x8
00689ecf : TEST EAX,EAX
00689ed1 : JNZ 0x00689eee
00689ed3 : POP EDI
00689ed4 : MOV dword ptr [EBP],ESI
00689ed7 : POP ESI
00689ed8 : POP EBP
00689ed9 : POP EBX
00689eda : MOV ECX,dword ptr [ESP + 0x24]
00689ede : XOR ECX,ESP
00689ee0 : CALL 0x00633e6b
00689ee5 : ADD ESP,0x28
00689ee8 : RET
00689ee9 : MOV EAX,0x2
00689eee : MOV ECX,dword ptr [ESP + 0x34]
00689ef2 : POP EDI
00689ef3 : POP ESI
00689ef4 : POP EBP
00689ef5 : POP EBX
00689ef6 : XOR ECX,ESP
00689ef8 : CALL 0x00633e6b
00689efd : ADD ESP,0x28
00689f00 : RET

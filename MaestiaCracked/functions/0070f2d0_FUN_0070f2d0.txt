PROGRAM  : Maestia.exe
FUNCTION : FUN_0070f2d0
ENTRY    : 0070f2d0
BODY     : [[0070f2d0, 0070f405] [0070f410, 0070f4cc]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0070f2d0(void)

{
  short sVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int in_EAX;
  int *in_ECX;
  uint uVar8;
  int iVar9;
  short *psVar10;
  uint uVar11;
  int iVar12;
  int iVar13;
  uint uVar14;
  ushort *puVar15;
  int local_18;
  int local_14;
  int *local_10;
  int local_c;
  
  iVar2 = in_ECX[1];
  iVar3 = *in_ECX;
  piVar4 = (int *)in_ECX[2];
  iVar9 = *piVar4;
  iVar5 = piVar4[1];
  iVar6 = piVar4[2];
  uVar11 = piVar4[4];
  *(undefined4 *)(in_EAX + 0xb34) = 0;
  *(undefined4 *)(in_EAX + 0xb38) = 0;
  *(undefined4 *)(in_EAX + 0xb3c) = 0;
  *(undefined4 *)(in_EAX + 0xb40) = 0;
  *(undefined4 *)(in_EAX + 0xb44) = 0;
  *(undefined4 *)(in_EAX + 0xb48) = 0;
  *(undefined4 *)(in_EAX + 0xb4c) = 0;
  *(undefined4 *)(in_EAX + 0xb50) = 0;
  *(undefined2 *)(iVar3 + 2 + *(int *)(in_EAX + 0xb54 + *(int *)(in_EAX + 0x144c) * 4) * 4) = 0;
  iVar12 = 0;
  local_14 = *(int *)(in_EAX + 0x144c) + 1;
  local_c = 0;
  if (local_14 < 0x23d) {
    local_10 = (int *)(in_EAX + 0xb54 + local_14 * 4);
    local_18 = 0x23d - local_14;
    local_14 = local_14 + local_18;
    do {
      iVar7 = *local_10;
      uVar8 = *(ushort *)(iVar3 + 2 + (uint)*(ushort *)(iVar3 + 2 + iVar7 * 4) * 4) + 1;
      if ((int)uVar11 < (int)uVar8) {
        iVar12 = iVar12 + 1;
        uVar8 = uVar11;
        local_c = iVar12;
      }
      *(short *)(iVar3 + 2 + iVar7 * 4) = (short)uVar8;
      if (iVar7 <= iVar2) {
        psVar10 = (short *)(in_EAX + 0xb34 + uVar8 * 2);
        *psVar10 = *psVar10 + 1;
        iVar13 = 0;
        if (iVar6 <= iVar7) {
          iVar13 = *(int *)(iVar5 + (iVar7 - iVar6) * 4);
        }
        uVar14 = (uint)*(ushort *)(iVar3 + iVar7 * 4);
        *(int *)(in_EAX + 0x16a0) = *(int *)(in_EAX + 0x16a0) + (uVar8 + iVar13) * uVar14;
        iVar12 = local_c;
        if (iVar9 != 0) {
          *(int *)(in_EAX + 0x16a4) =
               *(int *)(in_EAX + 0x16a4) +
               ((uint)*(ushort *)(iVar9 + 2 + iVar7 * 4) + iVar13) * uVar14;
        }
      }
      local_10 = local_10 + 1;
      local_18 = local_18 + -1;
    } while (local_18 != 0);
    if (iVar12 != 0) {
      puVar15 = (ushort *)(in_EAX + 0xb34 + uVar11 * 2);
      do {
        iVar9 = uVar11 - 1;
        psVar10 = (short *)(in_EAX + 0xb34 + iVar9 * 2);
        sVar1 = *(short *)(in_EAX + 0xb34 + iVar9 * 2);
        while (sVar1 == 0) {
          psVar10 = psVar10 + -1;
          iVar9 = iVar9 + -1;
          sVar1 = *psVar10;
        }
        psVar10 = (short *)(in_EAX + 0xb36 + iVar9 * 2);
        *psVar10 = *psVar10 + 2;
        psVar10 = (short *)(in_EAX + 0xb34 + iVar9 * 2);
        *psVar10 = *psVar10 + -1;
        *puVar15 = *puVar15 - 1;
        iVar12 = iVar12 + -2;
      } while (0 < iVar12);
      for (; uVar11 != 0; uVar11 = uVar11 - 1) {
        uVar8 = (uint)*puVar15;
        if (uVar8 != 0) {
          iVar9 = in_EAX + 0xb54 + local_14 * 4;
          local_10 = (int *)uVar8;
          do {
            iVar5 = *(int *)(iVar9 + -4);
            local_14 = local_14 + -1;
            iVar9 = iVar9 + -4;
            if (iVar5 <= iVar2) {
              uVar8 = (uint)*(ushort *)(iVar3 + 2 + iVar5 * 4);
              if (uVar8 != uVar11) {
                *(int *)(in_EAX + 0x16a0) =
                     *(int *)(in_EAX + 0x16a0) +
                     (uVar11 - uVar8) * (uint)*(ushort *)(iVar3 + iVar5 * 4);
                *(short *)(iVar3 + 2 + iVar5 * 4) = (short)uVar11;
              }
              uVar8 = (int)local_10 - 1;
              local_10 = (int *)uVar8;
            }
          } while (uVar8 != 0);
        }
        puVar15 = puVar15 + -1;
      }
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
0070f2d0 : PUSH EBP
0070f2d1 : MOV EBP,ESP
0070f2d3 : SUB ESP,0x28
0070f2d6 : MOV EDX,dword ptr [ECX + 0x4]
0070f2d9 : PUSH EBX
0070f2da : MOV EBX,dword ptr [ECX]
0070f2dc : MOV ECX,dword ptr [ECX + 0x8]
0070f2df : MOV dword ptr [EBP + -0x18],EDX
0070f2e2 : MOV EDX,dword ptr [ECX]
0070f2e4 : MOV dword ptr [EBP + -0x24],EDX
0070f2e7 : MOV EDX,dword ptr [ECX + 0x4]
0070f2ea : PUSH ESI
0070f2eb : MOV dword ptr [EBP + -0x20],EDX
0070f2ee : MOV EDX,dword ptr [ECX + 0x8]
0070f2f1 : PUSH EDI
0070f2f2 : MOV EDI,dword ptr [ECX + 0x10]
0070f2f5 : XOR ECX,ECX
0070f2f7 : MOV dword ptr [EBP + -0x1c],EDX
0070f2fa : MOVZX EDX,CX
0070f2fd : MOV ECX,EDX
0070f2ff : SHL EDX,0x10
0070f302 : OR ECX,EDX
0070f304 : MOV dword ptr [EAX + 0xb34],ECX
0070f30a : MOV dword ptr [EAX + 0xb38],ECX
0070f310 : MOV dword ptr [EAX + 0xb3c],ECX
0070f316 : MOV dword ptr [EAX + 0xb40],ECX
0070f31c : MOV dword ptr [EAX + 0xb44],ECX
0070f322 : MOV dword ptr [EAX + 0xb48],ECX
0070f328 : MOV dword ptr [EAX + 0xb4c],ECX
0070f32e : MOV dword ptr [EAX + 0xb50],ECX
0070f334 : MOV ECX,dword ptr [EAX + 0x144c]
0070f33a : MOV EDX,dword ptr [EAX + ECX*0x4 + 0xb54]
0070f341 : XOR ECX,ECX
0070f343 : MOV word ptr [EBX + EDX*0x4 + 0x2],CX
0070f348 : MOV ECX,dword ptr [EAX + 0x144c]
0070f34e : XOR ESI,ESI
0070f350 : INC ECX
0070f351 : CMP ECX,0x23d
0070f357 : MOV dword ptr [EBP + -0x28],EBX
0070f35a : MOV dword ptr [EBP + -0x4],EDI
0070f35d : MOV dword ptr [EBP + -0x8],ESI
0070f360 : JGE 0x0070f4c6
0070f366 : LEA EDX,[EAX + ECX*0x4 + 0xb54]
0070f36d : MOV dword ptr [EBP + -0xc],EDX
0070f370 : MOV EDX,0x23d
0070f375 : SUB EDX,ECX
0070f377 : ADD ECX,EDX
0070f379 : MOV dword ptr [EBP + -0x14],EDX
0070f37c : MOV dword ptr [EBP + -0x10],ECX
0070f37f : NOP
0070f380 : MOV ECX,dword ptr [EBP + -0xc]
0070f383 : MOV EDX,dword ptr [ECX]
0070f385 : MOVZX ECX,word ptr [EBX + EDX*0x4 + 0x2]
0070f38a : MOVZX ECX,word ptr [EBX + ECX*0x4 + 0x2]
0070f38f : INC ECX
0070f390 : CMP ECX,EDI
0070f392 : JLE 0x0070f39a
0070f394 : INC ESI
0070f395 : MOV ECX,EDI
0070f397 : MOV dword ptr [EBP + -0x8],ESI
0070f39a : CMP EDX,dword ptr [EBP + -0x18]
0070f39d : MOV word ptr [EBX + EDX*0x4 + 0x2],CX
0070f3a2 : JG 0x0070f3eb
0070f3a4 : MOV EDI,dword ptr [EBP + -0x1c]
0070f3a7 : INC word ptr [EAX + ECX*0x2 + 0xb34]
0070f3af : XOR ESI,ESI
0070f3b1 : CMP EDX,EDI
0070f3b3 : JL 0x0070f3bf
0070f3b5 : MOV ESI,EDX
0070f3b7 : SUB ESI,EDI
0070f3b9 : MOV EDI,dword ptr [EBP + -0x20]
0070f3bc : MOV ESI,dword ptr [EDI + ESI*0x4]
0070f3bf : MOVZX EDI,word ptr [EBX + EDX*0x4]
0070f3c3 : ADD ECX,ESI
0070f3c5 : IMUL ECX,EDI
0070f3c8 : ADD dword ptr [EAX + 0x16a0],ECX
0070f3ce : MOV ECX,dword ptr [EBP + -0x24]
0070f3d1 : TEST ECX,ECX
0070f3d3 : JZ 0x0070f3e5
0070f3d5 : MOVZX EDX,word ptr [ECX + EDX*0x4 + 0x2]
0070f3da : ADD EDX,ESI
0070f3dc : IMUL EDX,EDI
0070f3df : ADD dword ptr [EAX + 0x16a4],EDX
0070f3e5 : MOV EDI,dword ptr [EBP + -0x4]
0070f3e8 : MOV ESI,dword ptr [EBP + -0x8]
0070f3eb : ADD dword ptr [EBP + -0xc],0x4
0070f3ef : SUB dword ptr [EBP + -0x14],0x1
0070f3f3 : JNZ 0x0070f380
0070f3f5 : TEST ESI,ESI
0070f3f7 : JZ 0x0070f4c6
0070f3fd : LEA EDI,[EAX + EDI*0x2 + 0xb34]
0070f404 : JMP 0x0070f410
0070f410 : MOV ECX,dword ptr [EBP + -0x4]
0070f413 : DEC ECX
0070f414 : CMP word ptr [EAX + ECX*0x2 + 0xb34],0x0
0070f41d : LEA EDX,[EAX + ECX*0x2 + 0xb34]
0070f424 : JNZ 0x0070f430
0070f426 : SUB EDX,0x2
0070f429 : DEC ECX
0070f42a : CMP word ptr [EDX],0x0
0070f42e : JZ 0x0070f426
0070f430 : ADD word ptr [EAX + ECX*0x2 + 0xb36],0x2
0070f439 : MOV EDX,0xffff
0070f43e : ADD word ptr [EAX + ECX*0x2 + 0xb34],DX
0070f446 : MOV ECX,EDX
0070f448 : ADD word ptr [EDI],CX
0070f44b : SUB ESI,0x2
0070f44e : TEST ESI,ESI
0070f450 : JG 0x0070f410
0070f452 : MOV EDX,dword ptr [EBP + -0x4]
0070f455 : TEST EDX,EDX
0070f457 : JZ 0x0070f4c6
0070f459 : MOV dword ptr [EBP + -0x14],EDI
0070f45c : LEA ESP,[ESP]
0070f460 : MOVZX EDI,word ptr [EDI]
0070f463 : MOV dword ptr [EBP + -0xc],EDI
0070f466 : TEST EDI,EDI
0070f468 : JZ 0x0070f4b8
0070f46a : MOV ECX,dword ptr [EBP + -0x10]
0070f46d : LEA ESI,[EAX + ECX*0x4 + 0xb54]
0070f474 : MOV ECX,dword ptr [ESI + -0x4]
0070f477 : DEC dword ptr [EBP + -0x10]
0070f47a : SUB ESI,0x4
0070f47d : CMP ECX,dword ptr [EBP + -0x18]
0070f480 : MOV dword ptr [EBP + -0x20],ESI
0070f483 : JG 0x0070f4b4
0070f485 : MOVZX EDI,word ptr [EBX + ECX*0x4 + 0x2]
0070f48a : LEA ESI,[EBX + ECX*0x4 + 0x2]
0070f48e : CMP EDI,EDX
0070f490 : JZ 0x0070f4ab
0070f492 : MOV EBX,EDX
0070f494 : SUB EBX,EDI
0070f496 : MOV EDI,EBX
0070f498 : MOV EBX,dword ptr [EBP + -0x28]
0070f49b : MOVZX ECX,word ptr [EBX + ECX*0x4]
0070f49f : IMUL EDI,ECX
0070f4a2 : ADD dword ptr [EAX + 0x16a0],EDI
0070f4a8 : MOV word ptr [ESI],DX
0070f4ab : DEC dword ptr [EBP + -0xc]
0070f4ae : MOV EDI,dword ptr [EBP + -0xc]
0070f4b1 : MOV ESI,dword ptr [EBP + -0x20]
0070f4b4 : TEST EDI,EDI
0070f4b6 : JNZ 0x0070f474
0070f4b8 : MOV EDI,dword ptr [EBP + -0x14]
0070f4bb : DEC EDX
0070f4bc : SUB EDI,0x2
0070f4bf : MOV dword ptr [EBP + -0x14],EDI
0070f4c2 : TEST EDX,EDX
0070f4c4 : JNZ 0x0070f460
0070f4c6 : POP EDI
0070f4c7 : POP ESI
0070f4c8 : POP EBX
0070f4c9 : MOV ESP,EBP
0070f4cb : POP EBP
0070f4cc : RET

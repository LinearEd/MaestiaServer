PROGRAM  : Maestia.exe
FUNCTION : FUN_008c7b80
ENTRY    : 008c7b80
BODY     : [[008c7b80, 008c7dab]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008c7b80(int *param_1)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  int local_5c;
  int local_58;
  int local_54;
  int local_50;
  undefined1 local_4c [4];
  undefined2 local_48;
  undefined4 local_38;
  uint local_34;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1d31d;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_54 = 0;
  local_50 = 0;
  local_14 = uVar3;
  do {
    iVar2 = local_54;
    iVar4 = (**(code **)(*param_1 + 0x74))(local_50,0,uVar3);
    iVar1 = DAT_00d7c54c;
    if (iVar4 == 0) {
      local_48 = 0;
      local_34 = 7;
      local_38 = 0;
      FUN_00406360(L"IDS_HALIDOM_NOTENOUGH",0x15);
      local_8 = 0;
      FUN_0081d120(local_4c);
      local_8 = CONCAT31(local_8._1_3_,2);
LAB_008c7c9f:
      if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_48 = 0;
      local_34 = 7;
      local_38 = 0;
      (**(code **)(**(int **)(*DAT_00da9894 + 0x1a8) + 0x44))(local_30,3);
      local_8 = 0xffffffff;
      if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_2c = 0;
      local_18 = 7;
      local_1c = 0;
      break;
    }
    if (iVar2 == 0) {
      local_54 = *(int *)(iVar4 + 0x10);
    }
    else if (iVar2 != *(int *)(iVar4 + 0x10)) {
      local_48 = 0;
      local_34 = 7;
      local_38 = 0;
      FUN_00406360(L"IDS_HALIDOM_DIFFERENT",0x15);
      local_8 = 3;
      FUN_0081d120(local_4c);
      local_8 = CONCAT31(local_8._1_3_,5);
      goto LAB_008c7c9f;
    }
    local_58 = param_1[0x18];
    FUN_004437f0(&local_58);
    if ((((local_5c == *(int *)(iVar1 + 0x44)) || (*(int *)(local_5c + 0x10) == 0)) ||
        (0x15 < *(ushort *)(iVar4 + 0xac))) ||
       (*(int *)(*(int *)(local_5c + 0x10) + 0xa0 + (uint)*(ushort *)(iVar4 + 0xac) * 4) == 0)) {
      local_48 = 0;
      local_34 = 7;
      local_38 = 0;
      FUN_00406360(L"IDS_ITEM_UPGRADE_MAX_LEVEL",0x1a);
      local_8 = 6;
      FUN_0081d120(local_4c);
      local_8 = CONCAT31(local_8._1_3_,8);
      goto LAB_008c7c9f;
    }
    local_50 = local_50 + 1;
  } while (local_50 < 3);
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008c7b80 : PUSH EBP
008c7b81 : MOV EBP,ESP
008c7b83 : PUSH -0x1
008c7b85 : PUSH 0xb1d31d
008c7b8a : MOV EAX,FS:[0x0]
008c7b90 : PUSH EAX
008c7b91 : SUB ESP,0x4c
008c7b94 : MOV EAX,[0x00d66fa0]
008c7b99 : XOR EAX,EBP
008c7b9b : MOV dword ptr [EBP + -0x10],EAX
008c7b9e : PUSH EBX
008c7b9f : PUSH ESI
008c7ba0 : PUSH EDI
008c7ba1 : PUSH EAX
008c7ba2 : LEA EAX,[EBP + -0xc]
008c7ba5 : MOV FS:[0x0],EAX
008c7bab : MOV EBX,dword ptr [EBP + 0x8]
008c7bae : XOR EDI,EDI
008c7bb0 : MOV dword ptr [EBP + -0x50],EDI
008c7bb3 : MOV dword ptr [EBP + -0x4c],EDI
008c7bb6 : MOV ECX,dword ptr [EBP + -0x4c]
008c7bb9 : MOV EAX,dword ptr [EBX]
008c7bbb : MOV EDX,dword ptr [EAX + 0x74]
008c7bbe : PUSH 0x0
008c7bc0 : PUSH ECX
008c7bc1 : MOV ECX,EBX
008c7bc3 : CALL EDX
008c7bc5 : MOV ESI,EAX
008c7bc7 : TEST ESI,ESI
008c7bc9 : JZ 0x008c7c59
008c7bcf : TEST EDI,EDI
008c7bd1 : JNZ 0x008c7bdb
008c7bd3 : MOV EAX,dword ptr [ESI + 0x10]
008c7bd6 : MOV dword ptr [EBP + -0x50],EAX
008c7bd9 : JMP 0x008c7be4
008c7bdb : CMP EDI,dword ptr [ESI + 0x10]
008c7bde : JNZ 0x008c7cfc
008c7be4 : MOV ECX,dword ptr [EBX + 0x60]
008c7be7 : MOV EDI,dword ptr [0x00d7c54c]
008c7bed : LEA EDX,[EBP + -0x54]
008c7bf0 : MOV dword ptr [EBP + -0x54],ECX
008c7bf3 : PUSH EDX
008c7bf4 : LEA ECX,[EDI + 0x40]
008c7bf7 : LEA EAX,[EBP + -0x58]
008c7bfa : CALL 0x004437f0
008c7bff : MOV EDI,dword ptr [EDI + 0x44]
008c7c02 : MOV EAX,dword ptr [EBP + -0x58]
008c7c05 : CMP EAX,EDI
008c7c07 : JZ 0x008c7d42
008c7c0d : MOV EDX,dword ptr [EAX + 0x10]
008c7c10 : TEST EDX,EDX
008c7c12 : JZ 0x008c7d42
008c7c18 : MOVZX EAX,word ptr [ESI + 0xac]
008c7c1f : MOVZX ECX,AX
008c7c22 : MOV ESI,0x16
008c7c27 : CMP SI,CX
008c7c2a : JBE 0x008c7d42
008c7c30 : MOVZX EAX,AX
008c7c33 : CMP dword ptr [EDX + EAX*0x4 + 0xa0],0x0
008c7c3b : JZ 0x008c7d42
008c7c41 : MOV EAX,dword ptr [EBP + -0x4c]
008c7c44 : INC EAX
008c7c45 : CMP EAX,0x3
008c7c48 : MOV dword ptr [EBP + -0x4c],EAX
008c7c4b : JGE 0x008c7d8c
008c7c51 : MOV EDI,dword ptr [EBP + -0x50]
008c7c54 : JMP 0x008c7bb6
008c7c59 : XOR ECX,ECX
008c7c5b : PUSH 0x15
008c7c5d : MOV word ptr [EBP + -0x44],CX
008c7c61 : MOV ESI,0x7
008c7c66 : PUSH 0xc51a80
008c7c6b : LEA ECX,[EBP + -0x48]
008c7c6e : MOV dword ptr [EBP + -0x30],ESI
008c7c71 : MOV dword ptr [EBP + -0x34],0x0
008c7c78 : CALL 0x00406360
008c7c7d : MOV dword ptr [EBP + -0x4],0x0
008c7c84 : MOV ECX,dword ptr [0x0172491c]
008c7c8a : LEA EDX,[EBP + -0x48]
008c7c8d : PUSH EDX
008c7c8e : LEA EDI,[EBP + -0x2c]
008c7c91 : CALL 0x0081d120
008c7c96 : MOV byte ptr [EBP + -0x4],0x2
008c7c9a : MOV EBX,0x8
008c7c9f : CMP dword ptr [EBP + -0x30],EBX
008c7ca2 : JC 0x008c7cac
008c7ca4 : MOV ECX,dword ptr [EBP + -0x44]
008c7ca7 : CALL 0x006f04e0
008c7cac : MOV ECX,dword ptr [0x00da9894]
008c7cb2 : XOR EAX,EAX
008c7cb4 : XOR EDI,EDI
008c7cb6 : MOV word ptr [EBP + -0x44],AX
008c7cba : MOV dword ptr [EBP + -0x30],ESI
008c7cbd : MOV dword ptr [EBP + -0x34],EDI
008c7cc0 : MOV EAX,dword ptr [ECX]
008c7cc2 : MOV ECX,dword ptr [EAX + 0x1a8]
008c7cc8 : MOV EDX,dword ptr [ECX]
008c7cca : MOV EDX,dword ptr [EDX + 0x44]
008c7ccd : PUSH 0x3
008c7ccf : LEA EAX,[EBP + -0x2c]
008c7cd2 : PUSH EAX
008c7cd3 : CALL EDX
008c7cd5 : MOV dword ptr [EBP + -0x4],0xffffffff
008c7cdc : CMP dword ptr [EBP + -0x14],EBX
008c7cdf : JC 0x008c7ce9
008c7ce1 : MOV ECX,dword ptr [EBP + -0x28]
008c7ce4 : CALL 0x006f04e0
008c7ce9 : XOR EAX,EAX
008c7ceb : MOV word ptr [EBP + -0x28],AX
008c7cef : MOV dword ptr [EBP + -0x14],ESI
008c7cf2 : MOV dword ptr [EBP + -0x18],EDI
008c7cf5 : XOR AL,AL
008c7cf7 : JMP 0x008c7d8e
008c7cfc : XOR ECX,ECX
008c7cfe : PUSH 0x15
008c7d00 : MOV word ptr [EBP + -0x44],CX
008c7d04 : MOV ESI,0x7
008c7d09 : PUSH 0xc51aac
008c7d0e : LEA ECX,[EBP + -0x48]
008c7d11 : MOV dword ptr [EBP + -0x30],ESI
008c7d14 : MOV dword ptr [EBP + -0x34],0x0
008c7d1b : CALL 0x00406360
008c7d20 : MOV dword ptr [EBP + -0x4],0x3
008c7d27 : MOV ECX,dword ptr [0x0172491c]
008c7d2d : LEA EDX,[EBP + -0x48]
008c7d30 : PUSH EDX
008c7d31 : LEA EDI,[EBP + -0x2c]
008c7d34 : CALL 0x0081d120
008c7d39 : MOV byte ptr [EBP + -0x4],0x5
008c7d3d : JMP 0x008c7c9a
008c7d42 : XOR ECX,ECX
008c7d44 : PUSH 0x1a
008c7d46 : MOV word ptr [EBP + -0x44],CX
008c7d4a : MOV ESI,0x7
008c7d4f : PUSH 0xc51ad8
008c7d54 : LEA ECX,[EBP + -0x48]
008c7d57 : MOV dword ptr [EBP + -0x30],ESI
008c7d5a : MOV dword ptr [EBP + -0x34],0x0
008c7d61 : CALL 0x00406360
008c7d66 : MOV dword ptr [EBP + -0x4],0x6
008c7d6d : MOV ECX,dword ptr [0x0172491c]
008c7d73 : LEA EDX,[EBP + -0x48]
008c7d76 : PUSH EDX
008c7d77 : LEA EDI,[EBP + -0x2c]
008c7d7a : CALL 0x0081d120
008c7d7f : MOV EBX,0x8
008c7d84 : MOV byte ptr [EBP + -0x4],BL
008c7d87 : JMP 0x008c7c9f
008c7d8c : MOV AL,0x1
008c7d8e : MOV ECX,dword ptr [EBP + -0xc]
008c7d91 : MOV dword ptr FS:[0x0],ECX
008c7d98 : POP ECX
008c7d99 : POP EDI
008c7d9a : POP ESI
008c7d9b : POP EBX
008c7d9c : MOV ECX,dword ptr [EBP + -0x10]
008c7d9f : XOR ECX,EBP
008c7da1 : CALL 0x00633e6b
008c7da6 : MOV ESP,EBP
008c7da8 : POP EBP
008c7da9 : RET 0x4

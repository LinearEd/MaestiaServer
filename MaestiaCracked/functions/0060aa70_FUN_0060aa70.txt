PROGRAM  : Maestia.exe
FUNCTION : FUN_0060aa70
ENTRY    : 0060aa70
BODY     : [[0060aa70, 0060acf3]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_0060aa70(uint param_1,int param_2)

{
  uint *puVar1;
  char cVar2;
  undefined4 *in_ECX;
  byte bVar3;
  byte bVar4;
  int iVar5;
  uint uVar6;
  
  bVar3 = (byte)((int)param_1 >> 4);
  cVar2 = (char)param_1;
  if ((param_1 + 0x20 < 0x40) && (param_2 + 0x20U < 0x40)) {
    param_1 = CONCAT31(param_1._1_3_,cVar2 << 4) | 4;
    FUN_0060a360(&param_1);
    param_2 = CONCAT31(param_2._1_3_,bVar3 & 3 | (char)param_2 * '\x04');
    FUN_0060a360(&param_2);
    return 2;
  }
  if ((param_1 + 0x200 < 0x400) && (param_2 + 0x200U < 0x400)) {
    param_1 = CONCAT31(param_1._1_3_,cVar2 << 4) | 5;
    FUN_0060a360(&param_1);
    param_1 = CONCAT31(param_1._1_3_,bVar3 & 0x3f | (char)param_2 << 6);
    FUN_0060a360(&param_1);
    param_2 = CONCAT31(param_2._1_3_,(char)(param_2 >> 2));
    FUN_0060a360(&param_2);
    return 3;
  }
  bVar4 = (byte)((int)param_1 >> 0xc);
  if ((param_1 + 0x2000 < 0x4000) && (param_2 + 0x2000U < 0x4000)) {
    param_1 = CONCAT31(param_1._1_3_,cVar2 << 4) | 6;
    FUN_0060a360(&param_1);
    param_1._0_1_ = bVar3;
    FUN_0060a360(&param_1);
    param_1 = CONCAT31(param_1._1_3_,bVar4 & 3 | (char)param_2 * '\x04');
    FUN_0060a360(&param_1);
    param_2 = CONCAT31(param_2._1_3_,(char)(param_2 >> 6));
    FUN_0060a360(&param_2);
    return 4;
  }
  puVar1 = (uint *)*in_ECX;
  uVar6 = *puVar1 >> 0xc;
  param_1 = CONCAT31(param_1._1_3_,cVar2 << 4) | 7;
  if (puVar1[1] <= uVar6) {
    FUN_00609600(uVar6);
  }
  *(byte *)((*puVar1 & 0xfff) + *(int *)(puVar1[3] + uVar6 * 4)) = (byte)param_1;
  *puVar1 = *puVar1 + 1;
  puVar1 = (uint *)*in_ECX;
  uVar6 = *puVar1 >> 0xc;
  param_1 = CONCAT31(param_1._1_3_,bVar3);
  if (puVar1[1] <= uVar6) {
    FUN_00609600(uVar6);
  }
  *(byte *)((*puVar1 & 0xfff) + *(int *)(puVar1[3] + uVar6 * 4)) = (byte)param_1;
  *puVar1 = *puVar1 + 1;
  puVar1 = (uint *)*in_ECX;
  cVar2 = (char)param_2;
  uVar6 = *puVar1 >> 0xc;
  if (puVar1[1] <= uVar6) {
    FUN_00609600(uVar6);
  }
  *(byte *)((*puVar1 & 0xfff) + *(int *)(puVar1[3] + uVar6 * 4)) = bVar4 & 0x3f | cVar2 << 6;
  *puVar1 = *puVar1 + 1;
  puVar1 = (uint *)*in_ECX;
  uVar6 = *puVar1 >> 0xc;
  iVar5 = param_2 >> 2;
  if (puVar1[1] <= uVar6) {
    FUN_00609600(uVar6);
  }
  *(char *)((*puVar1 & 0xfff) + *(int *)(puVar1[3] + uVar6 * 4)) = (char)iVar5;
  *puVar1 = *puVar1 + 1;
  puVar1 = (uint *)*in_ECX;
  iVar5 = param_2 >> 10;
  uVar6 = *puVar1 >> 0xc;
  if (puVar1[1] <= uVar6) {
    FUN_00609600(uVar6);
  }
  *(char *)((*puVar1 & 0xfff) + *(int *)(puVar1[3] + uVar6 * 4)) = (char)iVar5;
  *puVar1 = *puVar1 + 1;
  return 5;
}



============================================================
DISASSEMBLY
============================================================
0060aa70 : PUSH ECX
0060aa71 : PUSH EBX
0060aa72 : MOV EBX,dword ptr [ESP + 0xc]
0060aa76 : LEA EAX,[EBX + 0x20]
0060aa79 : PUSH EDI
0060aa7a : CMP EAX,0x3f
0060aa7d : MOV EAX,dword ptr [ESP + 0x14]
0060aa81 : MOV EDI,ECX
0060aa83 : JA 0x0060aad0
0060aa85 : LEA ECX,[EAX + 0x20]
0060aa88 : CMP ECX,0x3f
0060aa8b : JA 0x0060aad0
0060aa8d : MOV ECX,dword ptr [EDI]
0060aa8f : MOV DL,BL
0060aa91 : SHL DL,0x4
0060aa94 : LEA EAX,[ESP + 0x10]
0060aa98 : OR DL,0x4
0060aa9b : PUSH EAX
0060aa9c : MOV byte ptr [ESP + 0x14],DL
0060aaa0 : CALL 0x0060a360
0060aaa5 : MOV AL,byte ptr [ESP + 0x14]
0060aaa9 : SAR EBX,0x4
0060aaac : ADD AL,AL
0060aaae : AND BL,0x3
0060aab1 : ADD AL,AL
0060aab3 : LEA ECX,[ESP + 0x14]
0060aab7 : OR BL,AL
0060aab9 : PUSH ECX
0060aaba : MOV ECX,dword ptr [EDI]
0060aabc : MOV byte ptr [ESP + 0x18],BL
0060aac0 : CALL 0x0060a360
0060aac5 : POP EDI
0060aac6 : MOV EAX,0x2
0060aacb : POP EBX
0060aacc : POP ECX
0060aacd : RET 0x8
0060aad0 : LEA EDX,[EBX + 0x200]
0060aad6 : CMP EDX,0x3ff
0060aadc : JA 0x0060ab45
0060aade : LEA ECX,[EAX + 0x200]
0060aae4 : CMP ECX,0x3ff
0060aaea : JA 0x0060ab45
0060aaec : MOV ECX,dword ptr [EDI]
0060aaee : MOV DL,BL
0060aaf0 : SHL DL,0x4
0060aaf3 : LEA EAX,[ESP + 0x10]
0060aaf7 : OR DL,0x5
0060aafa : PUSH EAX
0060aafb : MOV byte ptr [ESP + 0x14],DL
0060aaff : CALL 0x0060a360
0060ab04 : MOV CL,byte ptr [ESP + 0x14]
0060ab08 : SAR EBX,0x4
0060ab0b : SHL CL,0x6
0060ab0e : AND BL,0x3f
0060ab11 : OR BL,CL
0060ab13 : MOV ECX,dword ptr [EDI]
0060ab15 : LEA EDX,[ESP + 0x10]
0060ab19 : PUSH EDX
0060ab1a : MOV byte ptr [ESP + 0x14],BL
0060ab1e : CALL 0x0060a360
0060ab23 : MOV EAX,dword ptr [ESP + 0x14]
0060ab27 : MOV ECX,dword ptr [EDI]
0060ab29 : SAR EAX,0x2
0060ab2c : MOV byte ptr [ESP + 0x14],AL
0060ab30 : LEA EAX,[ESP + 0x14]
0060ab34 : PUSH EAX
0060ab35 : CALL 0x0060a360
0060ab3a : POP EDI
0060ab3b : MOV EAX,0x3
0060ab40 : POP EBX
0060ab41 : POP ECX
0060ab42 : RET 0x8
0060ab45 : LEA ECX,[EBX + 0x2000]
0060ab4b : CMP ECX,0x3fff
0060ab51 : JA 0x0060abcf
0060ab53 : LEA EDX,[EAX + 0x2000]
0060ab59 : CMP EDX,0x3fff
0060ab5f : JA 0x0060abcf
0060ab61 : MOV AL,BL
0060ab63 : SHL AL,0x4
0060ab66 : LEA ECX,[ESP + 0x10]
0060ab6a : OR AL,0x6
0060ab6c : PUSH ECX
0060ab6d : MOV ECX,dword ptr [EDI]
0060ab6f : MOV byte ptr [ESP + 0x14],AL
0060ab73 : CALL 0x0060a360
0060ab78 : MOV ECX,dword ptr [EDI]
0060ab7a : MOV EDX,EBX
0060ab7c : LEA EAX,[ESP + 0x10]
0060ab80 : SAR EDX,0x4
0060ab83 : PUSH EAX
0060ab84 : MOV byte ptr [ESP + 0x14],DL
0060ab88 : CALL 0x0060a360
0060ab8d : MOV CL,byte ptr [ESP + 0x14]
0060ab91 : ADD CL,CL
0060ab93 : SAR EBX,0xc
0060ab96 : ADD CL,CL
0060ab98 : AND BL,0x3
0060ab9b : OR BL,CL
0060ab9d : MOV ECX,dword ptr [EDI]
0060ab9f : LEA EDX,[ESP + 0x10]
0060aba3 : PUSH EDX
0060aba4 : MOV byte ptr [ESP + 0x14],BL
0060aba8 : CALL 0x0060a360
0060abad : MOV EAX,dword ptr [ESP + 0x14]
0060abb1 : MOV ECX,dword ptr [EDI]
0060abb3 : SAR EAX,0x6
0060abb6 : MOV byte ptr [ESP + 0x14],AL
0060abba : LEA EAX,[ESP + 0x14]
0060abbe : PUSH EAX
0060abbf : CALL 0x0060a360
0060abc4 : POP EDI
0060abc5 : MOV EAX,0x4
0060abca : POP EBX
0060abcb : POP ECX
0060abcc : RET 0x8
0060abcf : PUSH EBP
0060abd0 : PUSH ESI
0060abd1 : MOV ESI,dword ptr [EDI]
0060abd3 : MOV EBP,dword ptr [ESI]
0060abd5 : MOV CL,BL
0060abd7 : SHL CL,0x4
0060abda : OR CL,0x7
0060abdd : SHR EBP,0xc
0060abe0 : MOV byte ptr [ESP + 0x18],CL
0060abe4 : CMP EBP,dword ptr [ESI + 0x4]
0060abe7 : JC 0x0060abf5
0060abe9 : PUSH EBP
0060abea : MOV ECX,ESI
0060abec : CALL 0x00609600
0060abf1 : MOV EAX,dword ptr [ESP + 0x1c]
0060abf5 : MOV EDX,dword ptr [ESI]
0060abf7 : MOV ECX,dword ptr [ESI + 0xc]
0060abfa : MOV ECX,dword ptr [ECX + EBP*0x4]
0060abfd : MOV dword ptr [ESP + 0x10],EAX
0060ac01 : MOV AL,byte ptr [ESP + 0x18]
0060ac05 : AND EDX,0xfff
0060ac0b : MOV byte ptr [EDX + ECX*0x1],AL
0060ac0e : INC dword ptr [ESI]
0060ac10 : MOV ESI,dword ptr [EDI]
0060ac12 : MOV EBP,dword ptr [ESI]
0060ac14 : MOV EAX,dword ptr [ESP + 0x10]
0060ac18 : MOV ECX,EBX
0060ac1a : SAR ECX,0x4
0060ac1d : SHR EBP,0xc
0060ac20 : MOV byte ptr [ESP + 0x18],CL
0060ac24 : CMP EBP,dword ptr [ESI + 0x4]
0060ac27 : JC 0x0060ac35
0060ac29 : PUSH EBP
0060ac2a : MOV ECX,ESI
0060ac2c : CALL 0x00609600
0060ac31 : MOV EAX,dword ptr [ESP + 0x1c]
0060ac35 : MOV ECX,dword ptr [ESI]
0060ac37 : MOV EDX,dword ptr [ESI + 0xc]
0060ac3a : MOV EDX,dword ptr [EDX + EBP*0x4]
0060ac3d : AND ECX,0xfff
0060ac43 : MOV dword ptr [ESP + 0x10],EAX
0060ac47 : MOV AL,byte ptr [ESP + 0x18]
0060ac4b : MOV byte ptr [ECX + EDX*0x1],AL
0060ac4e : INC dword ptr [ESI]
0060ac50 : MOV EAX,dword ptr [ESP + 0x10]
0060ac54 : MOV ESI,dword ptr [EDI]
0060ac56 : MOV EBP,dword ptr [ESI]
0060ac58 : SAR EBX,0xc
0060ac5b : MOV CL,AL
0060ac5d : AND BL,0x3f
0060ac60 : SHL CL,0x6
0060ac63 : SHR EBP,0xc
0060ac66 : OR BL,CL
0060ac68 : CMP EBP,dword ptr [ESI + 0x4]
0060ac6b : JC 0x0060ac79
0060ac6d : PUSH EBP
0060ac6e : MOV ECX,ESI
0060ac70 : CALL 0x00609600
0060ac75 : MOV EAX,dword ptr [ESP + 0x1c]
0060ac79 : MOV ECX,dword ptr [ESI]
0060ac7b : MOV EDX,dword ptr [ESI + 0xc]
0060ac7e : MOV EDX,dword ptr [EDX + EBP*0x4]
0060ac81 : AND ECX,0xfff
0060ac87 : MOV byte ptr [ECX + EDX*0x1],BL
0060ac8a : INC dword ptr [ESI]
0060ac8c : MOV ESI,dword ptr [EDI]
0060ac8e : MOV EBP,dword ptr [ESI]
0060ac90 : MOV EBX,EAX
0060ac92 : SHR EBP,0xc
0060ac95 : SAR EBX,0x2
0060ac98 : CMP EBP,dword ptr [ESI + 0x4]
0060ac9b : JC 0x0060aca9
0060ac9d : PUSH EBP
0060ac9e : MOV ECX,ESI
0060aca0 : CALL 0x00609600
0060aca5 : MOV EAX,dword ptr [ESP + 0x1c]
0060aca9 : MOV EDX,dword ptr [ESI]
0060acab : MOV ECX,dword ptr [ESI + 0xc]
0060acae : MOV ECX,dword ptr [ECX + EBP*0x4]
0060acb1 : AND EDX,0xfff
0060acb7 : MOV byte ptr [EDX + ECX*0x1],BL
0060acba : INC dword ptr [ESI]
0060acbc : MOV EDI,dword ptr [EDI]
0060acbe : MOV ESI,dword ptr [EDI]
0060acc0 : SAR EAX,0xa
0060acc3 : SHR ESI,0xc
0060acc6 : MOV BL,AL
0060acc8 : CMP ESI,dword ptr [EDI + 0x4]
0060accb : JC 0x0060acd5
0060accd : PUSH ESI
0060acce : MOV ECX,EDI
0060acd0 : CALL 0x00609600
0060acd5 : MOV EDX,dword ptr [EDI + 0xc]
0060acd8 : MOV EAX,dword ptr [EDI]
0060acda : MOV ECX,dword ptr [EDX + ESI*0x4]
0060acdd : AND EAX,0xfff
0060ace2 : POP ESI
0060ace3 : MOV byte ptr [EAX + ECX*0x1],BL
0060ace6 : INC dword ptr [EDI]
0060ace8 : POP EBP
0060ace9 : POP EDI
0060acea : MOV EAX,0x5
0060acef : POP EBX
0060acf0 : POP ECX
0060acf1 : RET 0x8

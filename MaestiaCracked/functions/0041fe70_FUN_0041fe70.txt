PROGRAM  : Maestia.exe
FUNCTION : FUN_0041fe70
ENTRY    : 0041fe70
BODY     : [[0041fe70, 0041ff95] [0041ff99, 0041ffb9] [0041fffe, 00420080] [0042009e, 00420120]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0041fe70(int param_1)

{
  uint uVar1;
  uint *puVar2;
  int iVar3;
  int iVar4;
  undefined4 in_ECX;
  int extraout_ECX;
  uint uVar5;
  uint uStack_58;
  uint local_40;
  undefined1 local_3c [32];
  uint local_1c;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7c044;
  local_10 = ExceptionList;
  uStack_58 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&uStack_58;
  ExceptionList = &local_10;
  if (DAT_017210d4 == 0) {
    uVar5 = 0;
  }
  else {
    uVar5 = DAT_017210dc - DAT_017210d4 >> 5;
  }
  iVar3 = DAT_017210d8 - DAT_017210d4 >> 5;
  iVar4 = DAT_017210d8;
  local_1c = uStack_58;
  puVar2 = &uStack_58;
  if (iVar3 == 0x7ffffff) {
    iVar3 = FUN_00429be0();
    iVar4 = extraout_ECX;
    puVar2 = (uint *)local_14;
  }
  local_14 = (undefined1 *)puVar2;
  uVar1 = iVar3 + 1;
  if (uVar5 < uVar1) {
    if (0x7ffffff - (uVar5 >> 1) < uVar5) {
      uVar5 = 0;
    }
    else {
      uVar5 = uVar5 + (uVar5 >> 1);
    }
    if (uVar5 < uVar1) {
      uVar5 = uVar1;
    }
    iVar4 = FUN_0043f9d0();
    local_8 = 0;
    FUN_0041fba0(in_ECX);
    FUN_00420330(DAT_017210d4,param_1);
    FUN_00420330(param_1,DAT_017210d8);
    local_8 = 0xffffffff;
    if (DAT_017210d4 != 0) {
      FUN_0041fe50();
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    DAT_017210dc = uVar5 * 0x20 + iVar4;
    DAT_017210d8 = ((DAT_017210d8 - DAT_017210d4 >> 5) + 1) * 0x20 + iVar4;
    DAT_017210d4 = iVar4;
  }
  else {
    if (iVar4 - param_1 >> 5 == 0) {
      FUN_00452dc0(local_3c);
      local_8 = 2;
      FUN_00420330(param_1,DAT_017210d8);
      local_8 = CONCAT31(local_8._1_3_,3);
      FUN_0041fba0(local_3c);
      iVar4 = DAT_017210d8;
      local_8 = 2;
      DAT_017210d8 = DAT_017210d8 + 0x20;
      FUN_00420360(iVar4);
    }
    else {
      FUN_00452dc0(local_3c);
      local_8 = 5;
      DAT_017210d8 = FUN_00420330(DAT_017210d8 + -0x20,DAT_017210d8);
      local_40 = local_40 & 0xffffff00;
      FUN_004204c0(param_1,local_40,local_40,local_40);
      FUN_00420360(param_1 + 0x20);
    }
    local_8 = 0xffffffff;
    FUN_0044cb00(local_3c);
  }
  ExceptionList = local_10;
  __security_check_cookie(local_1c ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0041fe70 : PUSH EBP
0041fe71 : MOV EBP,ESP
0041fe73 : PUSH -0x1
0041fe75 : PUSH 0xb7c044
0041fe7a : MOV EAX,FS:[0x0]
0041fe80 : PUSH EAX
0041fe81 : SUB ESP,0x38
0041fe84 : MOV EAX,[0x00d66fa0]
0041fe89 : XOR EAX,EBP
0041fe8b : MOV dword ptr [EBP + -0x18],EAX
0041fe8e : PUSH EBX
0041fe8f : PUSH ESI
0041fe90 : PUSH EDI
0041fe91 : PUSH EAX
0041fe92 : LEA EAX,[EBP + -0xc]
0041fe95 : MOV FS:[0x0],EAX
0041fe9b : MOV dword ptr [EBP + -0x10],ESP
0041fe9e : MOV EDI,ECX
0041fea0 : MOV EDX,dword ptr [0x017210d4]
0041fea6 : XOR ESI,ESI
0041fea8 : CMP EDX,ESI
0041feaa : JNZ 0x0041feb0
0041feac : XOR EBX,EBX
0041feae : JMP 0x0041febb
0041feb0 : MOV EBX,dword ptr [0x017210dc]
0041feb6 : SUB EBX,EDX
0041feb8 : SAR EBX,0x5
0041febb : MOV ECX,dword ptr [0x017210d8]
0041fec1 : MOV EAX,ECX
0041fec3 : SUB EAX,EDX
0041fec5 : SAR EAX,0x5
0041fec8 : MOV EDX,0x7ffffff
0041fecd : SUB EDX,EAX
0041fecf : CMP EDX,0x1
0041fed2 : JNC 0x0041fed9
0041fed4 : CALL 0x00429be0
0041fed9 : LEA EDX,[EAX + 0x1]
0041fedc : CMP EBX,EDX
0041fede : JNC 0x0041fffe
0041fee4 : MOV EAX,EBX
0041fee6 : SHR EAX,0x1
0041fee8 : MOV ECX,0x7ffffff
0041feed : SUB ECX,EAX
0041feef : CMP ECX,EBX
0041fef1 : JNC 0x0041fef7
0041fef3 : XOR EBX,EBX
0041fef5 : JMP 0x0041fef9
0041fef7 : ADD EBX,EAX
0041fef9 : CMP EBX,EDX
0041fefb : CMOVC EBX,EDX
0041fefe : MOV ECX,EBX
0041ff00 : CALL 0x0043f9d0
0041ff05 : MOV dword ptr [EBP + -0x44],EAX
0041ff08 : MOV ECX,dword ptr [EBP + 0x8]
0041ff0b : SUB ECX,dword ptr [0x017210d4]
0041ff11 : SAR ECX,0x5
0041ff14 : MOV dword ptr [EBP + -0x3c],ECX
0041ff17 : MOV dword ptr [EBP + -0x40],ESI
0041ff1a : MOV dword ptr [EBP + -0x4],ESI
0041ff1d : PUSH EDI
0041ff1e : MOV EDI,ECX
0041ff20 : SHL EDI,0x5
0041ff23 : ADD EDI,EAX
0041ff25 : MOV ESI,0x1
0041ff2a : CALL 0x0041fba0
0041ff2f : MOV dword ptr [EBP + -0x40],ESI
0041ff32 : MOV EDX,dword ptr [EBP + 0x8]
0041ff35 : PUSH EDX
0041ff36 : MOV EAX,[0x017210d4]
0041ff3b : PUSH EAX
0041ff3c : MOV EDI,dword ptr [EBP + -0x44]
0041ff3f : MOV EDX,EDI
0041ff41 : CALL 0x00420330
0041ff46 : MOV dword ptr [EBP + -0x40],0x2
0041ff4d : MOV EDX,dword ptr [EBP + -0x3c]
0041ff50 : INC EDX
0041ff51 : SHL EDX,0x5
0041ff54 : ADD EDX,EDI
0041ff56 : MOV ECX,dword ptr [0x017210d8]
0041ff5c : PUSH ECX
0041ff5d : MOV EAX,dword ptr [EBP + 0x8]
0041ff60 : PUSH EAX
0041ff61 : CALL 0x00420330
0041ff66 : MOV dword ptr [EBP + -0x4],0xffffffff
0041ff6d : MOV ECX,dword ptr [0x017210d8]
0041ff73 : MOV ESI,ECX
0041ff75 : MOV EAX,[0x017210d4]
0041ff7a : SUB ESI,EAX
0041ff7c : SAR ESI,0x5
0041ff7f : INC ESI
0041ff80 : TEST EAX,EAX
0041ff82 : JZ 0x0041ff99
0041ff84 : MOV EDI,ECX
0041ff86 : CALL 0x0041fe50
0041ff8b : MOV ECX,dword ptr [0x017210d4]
0041ff91 : CALL 0x006f04e0
0041ff99 : SHL EBX,0x5
0041ff9c : ADD EBX,EDI
0041ff9e : MOV dword ptr [0x017210dc],EBX
0041ffa4 : SHL ESI,0x5
0041ffa7 : ADD ESI,EDI
0041ffa9 : MOV dword ptr [0x017210d8],ESI
0041ffaf : MOV dword ptr [0x017210d4],EDI
0041ffb5 : JMP 0x00420103
0041fffe : SUB ECX,dword ptr [EBP + 0x8]
00420001 : SAR ECX,0x5
00420004 : CMP ECX,0x1
00420007 : JNC 0x0042009e
0042000d : LEA ECX,[EBP + -0x38]
00420010 : PUSH ECX
00420011 : CALL 0x00452dc0
00420016 : MOV EBX,0x2
0042001b : MOV dword ptr [EBP + -0x4],EBX
0042001e : MOV EAX,dword ptr [EBP + 0x8]
00420021 : LEA EDX,[EAX + 0x20]
00420024 : MOV ECX,dword ptr [0x017210d8]
0042002a : PUSH ECX
0042002b : PUSH EAX
0042002c : CALL 0x00420330
00420031 : MOV byte ptr [EBP + -0x4],0x3
00420035 : LEA EDX,[EBP + -0x38]
00420038 : PUSH EDX
00420039 : MOV EDI,dword ptr [0x017210d8]
0042003f : MOV EAX,EDI
00420041 : SUB EAX,dword ptr [EBP + 0x8]
00420044 : SAR EAX,0x5
00420047 : MOV ESI,0x1
0042004c : SUB ESI,EAX
0042004e : CALL 0x0041fba0
00420053 : MOV dword ptr [EBP + -0x4],EBX
00420056 : MOV EAX,[0x017210d8]
0042005b : ADD EAX,0x20
0042005e : MOV [0x017210d8],EAX
00420063 : ADD EAX,-0x20
00420066 : PUSH EAX
00420067 : LEA EDI,[EBP + -0x38]
0042006a : MOV EAX,dword ptr [EBP + 0x8]
0042006d : CALL 0x00420360
00420072 : ADD ESP,0x4
00420075 : MOV dword ptr [EBP + -0x4],0xffffffff
0042007c : MOV ECX,EDI
0042007e : PUSH ECX
0042007f : JMP 0x004200fe
0042009e : LEA EDX,[EBP + -0x38]
004200a1 : PUSH EDX
004200a2 : CALL 0x00452dc0
004200a7 : MOV dword ptr [EBP + -0x4],0x5
004200ae : MOV EDX,dword ptr [0x017210d8]
004200b4 : MOV ESI,EDX
004200b6 : LEA EDI,[ESI + -0x20]
004200b9 : PUSH ESI
004200ba : PUSH EDI
004200bb : CALL 0x00420330
004200c0 : MOV [0x017210d8],EAX
004200c5 : MOV byte ptr [EBP + -0x3c],0x0
004200c9 : MOV EAX,dword ptr [EBP + -0x3c]
004200cc : PUSH EAX
004200cd : MOV ECX,dword ptr [EBP + -0x3c]
004200d0 : PUSH ECX
004200d1 : MOV EDX,dword ptr [EBP + -0x3c]
004200d4 : PUSH EDX
004200d5 : MOV EAX,dword ptr [EBP + 0x8]
004200d8 : PUSH EAX
004200d9 : MOV EAX,ESI
004200db : MOV ECX,EDI
004200dd : CALL 0x004204c0
004200e2 : MOV EAX,dword ptr [EBP + 0x8]
004200e5 : LEA ECX,[EAX + 0x20]
004200e8 : PUSH ECX
004200e9 : LEA EDI,[EBP + -0x38]
004200ec : CALL 0x00420360
004200f1 : ADD ESP,0x14
004200f4 : MOV dword ptr [EBP + -0x4],0xffffffff
004200fb : MOV EDX,EDI
004200fd : PUSH EDX
004200fe : CALL 0x0044cb00
00420103 : MOV ECX,dword ptr [EBP + -0xc]
00420106 : MOV dword ptr FS:[0x0],ECX
0042010d : POP ECX
0042010e : POP EDI
0042010f : POP ESI
00420110 : POP EBX
00420111 : MOV ECX,dword ptr [EBP + -0x18]
00420114 : XOR ECX,EBP
00420116 : CALL 0x00633e6b
0042011b : MOV ESP,EBP
0042011d : POP EBP
0042011e : RET 0x4

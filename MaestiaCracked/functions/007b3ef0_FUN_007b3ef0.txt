PROGRAM  : Maestia.exe
FUNCTION : FUN_007b3ef0
ENTRY    : 007b3ef0
BODY     : [[007b3ef0, 007b3f63]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007b3ef0(void)

{
  BOOL BVar1;
  _OSVERSIONINFOW local_11c;
  uint local_8;
  
  local_8 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  if (DAT_00da9aac == 0) {
    _memset(&local_11c,0,0x114);
    local_11c.dwOSVersionInfoSize = 0x114;
    BVar1 = GetVersionExW(&local_11c);
    DAT_00da9aac = local_11c.dwMajorVersion;
    if (BVar1 == 0) {
      DAT_00da9aac = 1;
    }
  }
  __security_check_cookie(local_8 ^ (uint)&stack0xfffffffc,5 < (int)DAT_00da9aac);
  return;
}



============================================================
DISASSEMBLY
============================================================
007b3ef0 : PUSH EBP
007b3ef1 : MOV EBP,ESP
007b3ef3 : SUB ESP,0x118
007b3ef9 : MOV EAX,[0x00d66fa0]
007b3efe : XOR EAX,EBP
007b3f00 : MOV dword ptr [EBP + -0x4],EAX
007b3f03 : MOV EAX,[0x00da9aac]
007b3f08 : TEST EAX,EAX
007b3f0a : JNZ 0x007b3f4c
007b3f0c : PUSH 0x114
007b3f11 : PUSH EAX
007b3f12 : LEA EAX,[EBP + 0xfffffee8]
007b3f18 : PUSH EAX
007b3f19 : CALL 0x0063b700
007b3f1e : ADD ESP,0xc
007b3f21 : LEA ECX,[EBP + 0xfffffee8]
007b3f27 : PUSH ECX
007b3f28 : MOV dword ptr [EBP + 0xfffffee8],0x114
007b3f32 : CALL dword ptr [0x00b8519c]
007b3f38 : TEST EAX,EAX
007b3f3a : MOV EAX,dword ptr [EBP + 0xfffffeec]
007b3f40 : JNZ 0x007b3f47
007b3f42 : MOV EAX,0x1
007b3f47 : MOV [0x00da9aac],EAX
007b3f4c : MOV ECX,dword ptr [EBP + -0x4]
007b3f4f : XOR EDX,EDX
007b3f51 : CMP EAX,0x6
007b3f54 : SETGE DL
007b3f57 : XOR ECX,EBP
007b3f59 : MOV EAX,EDX
007b3f5b : CALL 0x00633e6b
007b3f60 : MOV ESP,EBP
007b3f62 : POP EBP
007b3f63 : RET

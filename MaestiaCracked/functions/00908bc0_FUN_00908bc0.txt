PROGRAM  : Maestia.exe
FUNCTION : FUN_00908bc0
ENTRY    : 00908bc0
BODY     : [[00908bc0, 00908d97]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_00908bc0(int param_1)

{
  short sVar1;
  undefined4 uVar2;
  short *psVar3;
  undefined1 local_4068 [4];
  undefined2 local_4064;
  undefined4 local_4054;
  uint local_4050;
  undefined1 local_404c [4];
  undefined2 local_4048;
  undefined4 local_4038;
  uint local_4034;
  undefined2 local_402c;
  undefined4 local_401c;
  uint local_4018;
  short local_4014;
  undefined1 local_4012 [16382];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  puStack_c = &LAB_00b1ecd6;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_4018 = 7;
  local_401c = 0;
  local_402c = 0;
  local_8 = 0;
  if (*(char *)(param_1 + 0xc) == '\0') {
    FUN_00405eb0(param_1 + 0x3c,0,0xffffffff);
  }
  else {
    FUN_00403450(local_4068,param_1 + 0x3c,local_14);
    local_8._0_1_ = 1;
    uVar2 = FUN_00403450(local_404c,param_1 + 0x90);
    local_8._0_1_ = 2;
    FUN_00405eb0(uVar2,0,0xffffffff);
    local_8 = CONCAT31(local_8._1_3_,1);
    if (7 < local_4034) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_4034 = 7;
    local_4038 = 0;
    local_4048 = 0;
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_4050) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_4050 = 7;
    local_4054 = 0;
    local_4064 = 0;
  }
  FUN_008f8070(&local_4014,0xe);
  psVar3 = &local_4014;
  do {
    sVar1 = *psVar3;
    psVar3 = psVar3 + 1;
  } while (sVar1 != 0);
  FUN_00406360(&local_4014,(int)psVar3 - (int)local_4012 >> 1);
  local_8 = 0xffffffff;
  if (7 < local_4018) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_4018 = 7;
  local_401c = 0;
  local_402c = 0;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00908bc0 : PUSH EBP
00908bc1 : MOV EBP,ESP
00908bc3 : PUSH -0x1
00908bc5 : PUSH 0xb1ecd6
00908bca : MOV EAX,FS:[0x0]
00908bd0 : PUSH EAX
00908bd1 : MOV EAX,0x4058
00908bd6 : CALL 0x0063b780
00908bdb : MOV EAX,[0x00d66fa0]
00908be0 : XOR EAX,EBP
00908be2 : MOV dword ptr [EBP + -0x10],EAX
00908be5 : PUSH EBX
00908be6 : PUSH ESI
00908be7 : PUSH EDI
00908be8 : PUSH EAX
00908be9 : LEA EAX,[EBP + -0xc]
00908bec : MOV FS:[0x0],EAX
00908bf2 : MOV EBX,dword ptr [EBP + 0x8]
00908bf5 : XOR ESI,ESI
00908bf7 : XOR EAX,EAX
00908bf9 : MOV dword ptr [EBP + 0xffffbfec],0x7
00908c03 : MOV dword ptr [EBP + 0xffffbfe8],ESI
00908c09 : MOV word ptr [EBP + 0xffffbfd8],AX
00908c10 : MOV dword ptr [EBP + -0x4],ESI
00908c13 : MOV AL,byte ptr [EBX + 0xc]
00908c16 : TEST AL,AL
00908c18 : JZ 0x00908cc6
00908c1e : LEA ECX,[EBX + 0x3c]
00908c21 : PUSH ECX
00908c22 : LEA EDX,[EBP + 0xffffbf9c]
00908c28 : LEA ECX,[EBX + 0x74]
00908c2b : PUSH EDX
00908c2c : CALL 0x00403450
00908c31 : MOV byte ptr [EBP + -0x4],0x1
00908c35 : LEA ECX,[EBX + 0x90]
00908c3b : PUSH ECX
00908c3c : LEA EDX,[EBP + 0xffffbfb8]
00908c42 : PUSH EDX
00908c43 : MOV ECX,EAX
00908c45 : CALL 0x00403450
00908c4a : ADD ESP,0x10
00908c4d : MOV byte ptr [EBP + -0x4],0x2
00908c51 : PUSH -0x1
00908c53 : PUSH ESI
00908c54 : PUSH EAX
00908c55 : LEA ECX,[EBP + 0xffffbfd4]
00908c5b : CALL 0x00405eb0
00908c60 : MOV byte ptr [EBP + -0x4],0x1
00908c64 : MOV EDI,0x8
00908c69 : CMP dword ptr [EBP + 0xffffbfd0],EDI
00908c6f : JC 0x00908c7c
00908c71 : MOV ECX,dword ptr [EBP + 0xffffbfbc]
00908c77 : CALL 0x006f04e0
00908c7c : XOR EAX,EAX
00908c7e : MOV dword ptr [EBP + 0xffffbfd0],0x7
00908c88 : MOV dword ptr [EBP + 0xffffbfcc],ESI
00908c8e : MOV word ptr [EBP + 0xffffbfbc],AX
00908c95 : MOV byte ptr [EBP + -0x4],AL
00908c98 : CMP dword ptr [EBP + 0xffffbfb4],EDI
00908c9e : JC 0x00908cab
00908ca0 : MOV ECX,dword ptr [EBP + 0xffffbfa0]
00908ca6 : CALL 0x006f04e0
00908cab : XOR ECX,ECX
00908cad : MOV dword ptr [EBP + 0xffffbfb4],0x7
00908cb7 : MOV dword ptr [EBP + 0xffffbfb0],ESI
00908cbd : MOV word ptr [EBP + 0xffffbfa0],CX
00908cc4 : JMP 0x00908cdd
00908cc6 : PUSH -0x1
00908cc8 : PUSH ESI
00908cc9 : LEA EDX,[EBX + 0x3c]
00908ccc : PUSH EDX
00908ccd : LEA ECX,[EBP + 0xffffbfd4]
00908cd3 : CALL 0x00405eb0
00908cd8 : MOV EDI,0x8
00908cdd : MOV ESI,dword ptr [EBP + 0xffffbfd8]
00908ce3 : CMP dword ptr [EBP + 0xffffbfec],EDI
00908ce9 : JNC 0x00908cf1
00908ceb : LEA ESI,[EBP + 0xffffbfd8]
00908cf1 : MOVZX EDI,byte ptr [EBX + 0xc]
00908cf5 : NEG EDI
00908cf7 : SBB EDI,EDI
00908cf9 : LEA EAX,[EBP + 0xffffbff0]
00908cff : AND EDI,0xff777778
00908d05 : PUSH 0xe
00908d07 : ADD EDI,0xffffff
00908d0d : PUSH EAX
00908d0e : CALL 0x008f8070
00908d13 : LEA EAX,[EBP + 0xffffbff0]
00908d19 : ADD ESP,0x8
00908d1c : LEA EDX,[EAX + 0x2]
00908d1f : NOP
00908d20 : MOV CX,word ptr [EAX]
00908d23 : ADD EAX,0x2
00908d26 : TEST CX,CX
00908d29 : JNZ 0x00908d20
00908d2b : SUB EAX,EDX
00908d2d : SAR EAX,0x1
00908d2f : PUSH EAX
00908d30 : LEA ECX,[EBP + 0xffffbff0]
00908d36 : PUSH ECX
00908d37 : LEA ECX,[EBX + 0xc8]
00908d3d : CALL 0x00406360
00908d42 : MOV dword ptr [EBP + -0x4],0xffffffff
00908d49 : CMP dword ptr [EBP + 0xffffbfec],0x8
00908d50 : JC 0x00908d5d
00908d52 : MOV ECX,dword ptr [EBP + 0xffffbfd8]
00908d58 : CALL 0x006f04e0
00908d5d : XOR EDX,EDX
00908d5f : MOV dword ptr [EBP + 0xffffbfec],0x7
00908d69 : MOV dword ptr [EBP + 0xffffbfe8],0x0
00908d73 : MOV word ptr [EBP + 0xffffbfd8],DX
00908d7a : MOV ECX,dword ptr [EBP + -0xc]
00908d7d : MOV dword ptr FS:[0x0],ECX
00908d84 : POP ECX
00908d85 : POP EDI
00908d86 : POP ESI
00908d87 : POP EBX
00908d88 : MOV ECX,dword ptr [EBP + -0x10]
00908d8b : XOR ECX,EBP
00908d8d : CALL 0x00633e6b
00908d92 : MOV ESP,EBP
00908d94 : POP EBP
00908d95 : RET 0x4

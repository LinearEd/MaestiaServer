PROGRAM  : Maestia.exe
FUNCTION : FUN_00868450
ENTRY    : 00868450
BODY     : [[00868450, 008686b8]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00868450(int param_1)

{
  char cVar1;
  int *piVar2;
  int iVar3;
  undefined1 auStack_3c [4];
  undefined1 local_38;
  undefined1 local_37;
  undefined4 local_34;
  undefined4 local_30;
  undefined2 local_2c;
  undefined1 local_2a;
  undefined4 local_28;
  undefined1 local_24;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_00b62d90;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_3c;
  ExceptionList = &local_14;
  if (*(char *)(param_1 + 0x65d) == '\0') {
    local_34 = 0;
    local_30 = 0;
    local_2c = 0;
    local_24 = 0;
    local_38 = 0;
    local_2a = 1;
    local_28 = 1;
    local_37 = 0x28;
    FUN_0041dea0(&local_38);
  }
  else if (*(char *)(*(int *)(param_1 + 0x18a8) + 0x20) != '\0') {
    (**(code **)(*(int *)(*(int *)(*(int *)(param_1 + 0x138) + 4) + 0x138 + param_1) + 0x10))
              (param_1 + 0x1d38,1,1,1,DAT_00d66fa0 ^ (uint)&stack0xffffffb8);
    piVar2 = (int *)FUN_004049b0(*(undefined4 *)(*(int *)(param_1 + 0x18a8) + 0x28));
    if (piVar2 != (int *)0x0) {
      iVar3 = (**(code **)(*piVar2 + 0x38))();
      if (iVar3 != 0) {
        FUN_00404350(piVar2 + 0x31);
        local_1c = 0;
        cVar1 = FUN_004049e0();
        if (cVar1 != '\0') {
          FUN_008980b0(&stack0xffffffb8,1);
        }
        FUN_0088e570(0x12);
        local_1c = 0xffffffff;
        FUN_00406560();
      }
    }
    FUN_0085bfe0(param_1,1);
    FUN_0085c1c0();
    FUN_0083bb00(0);
    FUN_0083ba10();
    (**(code **)(*(int *)(*(int *)(*(int *)(param_1 + 0x138) + 4) + 0x138 + param_1) + 0x10))
              (param_1 + 0x6d8,1,0,1);
    *(undefined4 *)(param_1 + 0x19ec) = 0;
    *(undefined4 *)(param_1 + 0x1a68) = 0;
    FUN_00856310(&DAT_00d720f0);
    if (*(char *)(param_1 + 0x4d4) != '\0') {
      FUN_0084c320(1);
      iVar3 = *(int *)(param_1 + 0x17f0);
      *(undefined1 *)(iVar3 + 0x1a8) = 0;
      if (*(int **)(iVar3 + 0x168) != (int *)0x0) {
        (**(code **)(**(int **)(iVar3 + 0x168) + 0x10))(0);
      }
      if (*(int **)(iVar3 + 0x16c) != (int *)0x0) {
        (**(code **)(**(int **)(iVar3 + 0x16c) + 0x10))(0);
      }
      FUN_0084c320(1);
      iVar3 = *(int *)(param_1 + 0x1870);
      *(undefined1 *)(iVar3 + 0x1a8) = 0;
      if (*(int **)(iVar3 + 0x168) != (int *)0x0) {
        (**(code **)(**(int **)(iVar3 + 0x168) + 0x10))(0);
      }
      if (*(int **)(iVar3 + 0x16c) != (int *)0x0) {
        (**(code **)(**(int **)(iVar3 + 0x16c) + 0x10))(0);
      }
      FUN_0084c320(1);
      *(undefined1 *)(param_1 + 0x198c) = 1;
      *(undefined1 *)(param_1 + 0x4d4) = 0;
    }
  }
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_3c);
  return;
}



============================================================
DISASSEMBLY
============================================================
00868450 : PUSH EBP
00868451 : MOV EBP,ESP
00868453 : AND ESP,0xfffffff8
00868456 : PUSH -0x1
00868458 : PUSH 0xb62d90
0086845d : MOV EAX,FS:[0x0]
00868463 : PUSH EAX
00868464 : SUB ESP,0x28
00868467 : MOV EAX,[0x00d66fa0]
0086846c : XOR EAX,ESP
0086846e : MOV dword ptr [ESP + 0x20],EAX
00868472 : PUSH EBX
00868473 : PUSH ESI
00868474 : PUSH EDI
00868475 : MOV EAX,[0x00d66fa0]
0086847a : XOR EAX,ESP
0086847c : PUSH EAX
0086847d : LEA EAX,[ESP + 0x38]
00868481 : MOV FS:[0x0],EAX
00868487 : MOV EBX,dword ptr [EBP + 0x8]
0086848a : CMP byte ptr [EBX + 0x65d],0x0
00868491 : JNZ 0x008684d1
00868493 : XOR EAX,EAX
00868495 : LEA ECX,[ESP + 0x14]
00868499 : MOV dword ptr [ESP + 0x18],EAX
0086849d : MOV dword ptr [ESP + 0x1c],EAX
008684a1 : MOV word ptr [ESP + 0x20],AX
008684a6 : MOV byte ptr [ESP + 0x28],AL
008684aa : MOV byte ptr [ESP + 0x14],AL
008684ae : PUSH ECX
008684af : LEA EAX,[EBX + 0x19a4]
008684b5 : MOV byte ptr [ESP + 0x26],0x1
008684ba : MOV dword ptr [ESP + 0x28],0x1
008684c2 : MOV byte ptr [ESP + 0x19],0x28
008684c7 : CALL 0x0041dea0
008684cc : JMP 0x00868699
008684d1 : MOV EDX,dword ptr [EBX + 0x18a8]
008684d7 : CMP byte ptr [EDX + 0x20],0x0
008684db : JZ 0x00868699
008684e1 : MOV EAX,dword ptr [EBX + 0x138]
008684e7 : MOV ECX,dword ptr [EAX + 0x4]
008684ea : MOV EDX,dword ptr [ECX + EBX*0x1 + 0x138]
008684f1 : MOV EDX,dword ptr [EDX + 0x10]
008684f4 : PUSH 0x1
008684f6 : PUSH 0x1
008684f8 : LEA ECX,[ECX + EBX*0x1 + 0x138]
008684ff : PUSH 0x1
00868501 : LEA EAX,[EBX + 0x1d38]
00868507 : PUSH EAX
00868508 : CALL EDX
0086850a : MOV EAX,dword ptr [EBX + 0x18a8]
00868510 : MOV EAX,dword ptr [EAX + 0x28]
00868513 : PUSH EAX
00868514 : CALL 0x004049b0
00868519 : MOV ESI,EAX
0086851b : XOR EDI,EDI
0086851d : ADD ESP,0x4
00868520 : CMP ESI,EDI
00868522 : JZ 0x00868582
00868524 : MOV EDX,dword ptr [ESI]
00868526 : MOV EAX,dword ptr [EDX + 0x38]
00868529 : MOV ECX,ESI
0086852b : CALL EAX
0086852d : TEST EAX,EAX
0086852f : JZ 0x00868582
00868531 : ADD ESI,0xc4
00868537 : PUSH ESI
00868538 : LEA ESI,[ESP + 0x18]
0086853c : CALL 0x00404350
00868541 : ADD ESP,0x4
00868544 : MOV dword ptr [ESP + 0x40],EDI
00868548 : MOV ESI,0xc3f4c8
0086854d : LEA ECX,[ESP + 0x14]
00868551 : CALL 0x004049e0
00868556 : TEST AL,AL
00868558 : JZ 0x00868568
0086855a : PUSH 0x1
0086855c : LEA ECX,[ESP + 0x18]
00868560 : PUSH ECX
00868561 : MOV ESI,EBX
00868563 : CALL 0x008980b0
00868568 : PUSH 0x12
0086856a : MOV ECX,EBX
0086856c : CALL 0x0088e570
00868571 : MOV dword ptr [ESP + 0x40],0xffffffff
00868579 : LEA ECX,[ESP + 0x14]
0086857d : CALL 0x00406560
00868582 : PUSH 0x1
00868584 : PUSH EBX
00868585 : CALL 0x0085bfe0
0086858a : MOV ECX,EBX
0086858c : CALL 0x0085c1c0
00868591 : MOV ECX,dword ptr [EBX + 0x18a8]
00868597 : PUSH EDI
00868598 : XOR AL,AL
0086859a : CALL 0x0083bb00
0086859f : MOV ESI,dword ptr [EBX + 0x18a8]
008685a5 : CALL 0x0083ba10
008685aa : MOV EDX,dword ptr [EBX + 0x138]
008685b0 : MOV EAX,dword ptr [EDX + 0x4]
008685b3 : MOV EDX,dword ptr [EAX + EBX*0x1 + 0x138]
008685ba : MOV EDX,dword ptr [EDX + 0x10]
008685bd : PUSH 0x1
008685bf : LEA ECX,[EAX + EBX*0x1 + 0x138]
008685c6 : PUSH EDI
008685c7 : PUSH 0x1
008685c9 : LEA EAX,[EBX + 0x6d8]
008685cf : PUSH EAX
008685d0 : CALL EDX
008685d2 : XORPS XMM0,XMM0
008685d5 : PUSH 0xd720f0
008685da : MOV ESI,EBX
008685dc : MOV dword ptr [EBX + 0x19ec],EDI
008685e2 : MOVSS dword ptr [EBX + 0x1a68],XMM0
008685ea : CALL 0x00856310
008685ef : CMP byte ptr [EBX + 0x4d4],0x0
008685f6 : JZ 0x00868699
008685fc : MOV EDI,dword ptr [EBX + 0x17f0]
00868602 : PUSH 0x1
00868604 : CALL 0x0084c320
00868609 : MOV ESI,dword ptr [EBX + 0x17f0]
0086860f : MOV ECX,dword ptr [ESI + 0x168]
00868615 : MOV byte ptr [ESI + 0x1a8],0x0
0086861c : TEST ECX,ECX
0086861e : JZ 0x00868629
00868620 : MOV EAX,dword ptr [ECX]
00868622 : MOV EDX,dword ptr [EAX + 0x10]
00868625 : PUSH 0x0
00868627 : CALL EDX
00868629 : MOV ECX,dword ptr [ESI + 0x16c]
0086862f : TEST ECX,ECX
00868631 : JZ 0x0086863c
00868633 : MOV EAX,dword ptr [ECX]
00868635 : MOV EDX,dword ptr [EAX + 0x10]
00868638 : PUSH 0x0
0086863a : CALL EDX
0086863c : MOV EDI,dword ptr [EBX + 0x1870]
00868642 : PUSH 0x1
00868644 : CALL 0x0084c320
00868649 : MOV ESI,dword ptr [EBX + 0x1870]
0086864f : MOV ECX,dword ptr [ESI + 0x168]
00868655 : MOV byte ptr [ESI + 0x1a8],0x0
0086865c : TEST ECX,ECX
0086865e : JZ 0x00868669
00868660 : MOV EAX,dword ptr [ECX]
00868662 : MOV EDX,dword ptr [EAX + 0x10]
00868665 : PUSH 0x0
00868667 : CALL EDX
00868669 : MOV ESI,dword ptr [ESI + 0x16c]
0086866f : TEST ESI,ESI
00868671 : JZ 0x0086867e
00868673 : MOV EAX,dword ptr [ESI]
00868675 : MOV EDX,dword ptr [EAX + 0x10]
00868678 : PUSH 0x0
0086867a : MOV ECX,ESI
0086867c : CALL EDX
0086867e : MOV EDI,dword ptr [EBX + 0x17f4]
00868684 : PUSH 0x1
00868686 : CALL 0x0084c320
0086868b : MOV byte ptr [EBX + 0x198c],0x1
00868692 : MOV byte ptr [EBX + 0x4d4],0x0
00868699 : MOV ECX,dword ptr [ESP + 0x38]
0086869d : MOV dword ptr FS:[0x0],ECX
008686a4 : POP ECX
008686a5 : POP EDI
008686a6 : POP ESI
008686a7 : POP EBX
008686a8 : MOV ECX,dword ptr [ESP + 0x20]
008686ac : XOR ECX,ESP
008686ae : CALL 0x00633e6b
008686b3 : MOV ESP,EBP
008686b5 : POP EBP
008686b6 : RET 0x4

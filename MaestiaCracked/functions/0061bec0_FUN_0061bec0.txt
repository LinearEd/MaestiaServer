PROGRAM  : Maestia.exe
FUNCTION : FUN_0061bec0
ENTRY    : 0061bec0
BODY     : [[0061bec0, 0061c054]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_0061bec0(void *param_1,size_t param_2)

{
  undefined4 uVar1;
  int iVar2;
  undefined4 *puVar3;
  size_t sVar4;
  
  DAT_00d7b408 = 0;
  if (param_1 == (void *)0x0) {
    param_1 = (void *)0x0;
    FUN_0061bc70(DAT_00d662dc,DAT_00d662e0,DAT_00d662e4,DAT_00d662ec,DAT_00d662f0,&param_1);
    iVar2 = DAT_00d7b404 + (int)param_1;
    param_1 = (void *)(DAT_00d7b3f8 * 0x108 + 0x40 + DAT_00d7b3fc * 0xe0);
    DAT_00d7b404 = iVar2 + (int)param_1;
    FUN_0061bbe0(DAT_00d662e8,&param_1);
    sVar4 = DAT_00d7b404 + (int)param_1;
    DAT_00d7b404 = sVar4;
    DAT_00d7b400 = _malloc(sVar4);
  }
  else {
    DAT_00d7b408 = 1;
    DAT_00d7b404 = param_2;
    DAT_00d7b400 = param_1;
    sVar4 = param_2;
  }
  if (DAT_00d7b400 != (void *)0x0) {
    iVar2 = FUN_0061b8e0(DAT_00d7b400,sVar4);
    if (iVar2 == 0) {
      puVar3 = (undefined4 *)FUN_0061b940(0x30,0,0,DAT_00d7b3ec);
      if (puVar3 != (undefined4 *)0x0) {
        iVar2 = DAT_00d662dc + DAT_00d662e0 + DAT_00d662ec;
        iVar2 = FUN_00622520(iVar2,iVar2);
        if (iVar2 == 0) {
          iVar2 = FUN_0061c3d0(DAT_00d662dc,DAT_00d662e0,DAT_00d662e4);
          uVar1 = DAT_00d7b408;
          sVar4 = DAT_00d7b404;
          if (iVar2 == 0) {
            *puVar3 = DAT_00d7b3ec;
            puVar3[1] = sVar4;
            puVar3[2] = uVar1;
            puVar3[3] = DAT_00d7b3bc;
            puVar3[4] = DAT_00d7b3c0;
            uVar1 = DAT_00d7b3c8;
            puVar3[6] = 0;
            puVar3[5] = uVar1;
            puVar3[7] = DAT_00d7b3cc;
            puVar3[8] = DAT_00d7b450;
            uVar1 = DAT_00d7b454;
            puVar3[10] = 0;
            puVar3[9] = uVar1;
            puVar3[0xb] = DAT_00d7b3d0;
            DAT_00d7b40c = puVar3;
            return 0;
          }
        }
      }
    }
  }
  return 0xffffffff;
}



============================================================
DISASSEMBLY
============================================================
0061bec0 : MOV EAX,dword ptr [ESP + 0x4]
0061bec4 : PUSH ESI
0061bec5 : PUSH EDI
0061bec6 : XOR EDI,EDI
0061bec8 : MOV dword ptr [0x00d7b408],EDI
0061bece : CMP EAX,EDI
0061bed0 : JZ 0x0061beeb
0061bed2 : MOV ESI,dword ptr [ESP + 0x10]
0061bed6 : MOV dword ptr [0x00d7b408],0x1
0061bee0 : MOV dword ptr [0x00d7b404],ESI
0061bee6 : JMP 0x0061bf75
0061beeb : MOV ECX,dword ptr [0x00d662f0]
0061bef1 : MOV EDX,dword ptr [0x00d662ec]
0061bef7 : LEA EAX,[ESP + 0xc]
0061befb : PUSH EAX
0061befc : MOV EAX,[0x00d662e4]
0061bf01 : PUSH ECX
0061bf02 : MOV ECX,dword ptr [0x00d662e0]
0061bf08 : PUSH EDX
0061bf09 : MOV EDX,dword ptr [0x00d662dc]
0061bf0f : PUSH EAX
0061bf10 : PUSH ECX
0061bf11 : PUSH EDX
0061bf12 : MOV dword ptr [ESP + 0x24],EDI
0061bf16 : CALL 0x0061bc70
0061bf1b : MOV ECX,dword ptr [0x00d7b3f8]
0061bf21 : MOV EDX,dword ptr [0x00d7b3fc]
0061bf27 : IMUL ECX,ECX,0x108
0061bf2d : MOV EAX,[0x00d7b404]
0061bf32 : IMUL EDX,EDX,0xe0
0061bf38 : ADD EAX,dword ptr [ESP + 0x24]
0061bf3c : LEA ECX,[ECX + EDX*0x1 + 0x40]
0061bf40 : ADD EAX,ECX
0061bf42 : MOV [0x00d7b404],EAX
0061bf47 : LEA EAX,[ESP + 0x24]
0061bf4b : MOV dword ptr [ESP + 0x24],ECX
0061bf4f : MOV ECX,dword ptr [0x00d662e8]
0061bf55 : PUSH EAX
0061bf56 : PUSH ECX
0061bf57 : CALL 0x0061bbe0
0061bf5c : MOV ESI,dword ptr [0x00d7b404]
0061bf62 : ADD ESI,dword ptr [ESP + 0x2c]
0061bf66 : PUSH ESI
0061bf67 : MOV dword ptr [0x00d7b404],ESI
0061bf6d : CALL 0x00636043
0061bf72 : ADD ESP,0x24
0061bf75 : MOV [0x00d7b400],EAX
0061bf7a : CMP EAX,EDI
0061bf7c : JNZ 0x0061bf84
0061bf7e : POP EDI
0061bf7f : OR EAX,0xffffffff
0061bf82 : POP ESI
0061bf83 : RET
0061bf84 : PUSH ESI
0061bf85 : PUSH EAX
0061bf86 : CALL 0x0061b8e0
0061bf8b : ADD ESP,0x8
0061bf8e : TEST EAX,EAX
0061bf90 : JNZ 0x0061bf7e
0061bf92 : MOV EDX,dword ptr [0x00d7b3ec]
0061bf98 : PUSH EDX
0061bf99 : PUSH EDI
0061bf9a : PUSH EDI
0061bf9b : PUSH 0x30
0061bf9d : CALL 0x0061b940
0061bfa2 : MOV ESI,EAX
0061bfa4 : ADD ESP,0x10
0061bfa7 : CMP ESI,EDI
0061bfa9 : JZ 0x0061bf7e
0061bfab : MOV EAX,[0x00d662e0]
0061bfb0 : MOV ECX,dword ptr [0x00d662dc]
0061bfb6 : MOV EDX,dword ptr [0x00d662ec]
0061bfbc : ADD ECX,EAX
0061bfbe : LEA EAX,[ECX + EDX*0x1]
0061bfc1 : PUSH EAX
0061bfc2 : PUSH EAX
0061bfc3 : CALL 0x00622520
0061bfc8 : ADD ESP,0x8
0061bfcb : TEST EAX,EAX
0061bfcd : JNZ 0x0061bf7e
0061bfcf : MOV EAX,[0x00d662e4]
0061bfd4 : MOV ECX,dword ptr [0x00d662e0]
0061bfda : MOV EDX,dword ptr [0x00d662dc]
0061bfe0 : PUSH EAX
0061bfe1 : PUSH ECX
0061bfe2 : PUSH EDX
0061bfe3 : CALL 0x0061c3d0
0061bfe8 : ADD ESP,0xc
0061bfeb : TEST EAX,EAX
0061bfed : JNZ 0x0061bf7e
0061bfef : MOV EAX,[0x00d7b3ec]
0061bff4 : MOV ECX,dword ptr [0x00d7b404]
0061bffa : MOV EDX,dword ptr [0x00d7b408]
0061c000 : MOV dword ptr [ESI],EAX
0061c002 : MOV dword ptr [ESI + 0x4],ECX
0061c005 : MOV dword ptr [ESI + 0x8],EDX
0061c008 : MOV EAX,[0x00d7b3bc]
0061c00d : MOV dword ptr [ESI + 0xc],EAX
0061c010 : MOV ECX,dword ptr [0x00d7b3c0]
0061c016 : MOV dword ptr [ESI + 0x10],ECX
0061c019 : MOV EDX,dword ptr [0x00d7b3c8]
0061c01f : MOV dword ptr [ESI + 0x18],EDI
0061c022 : MOV dword ptr [ESI + 0x14],EDX
0061c025 : MOV EAX,[0x00d7b3cc]
0061c02a : MOV dword ptr [ESI + 0x1c],EAX
0061c02d : MOV ECX,dword ptr [0x00d7b450]
0061c033 : MOV dword ptr [ESI + 0x20],ECX
0061c036 : MOV EDX,dword ptr [0x00d7b454]
0061c03c : MOV dword ptr [ESI + 0x28],EDI
0061c03f : MOV dword ptr [ESI + 0x24],EDX
0061c042 : MOV EAX,[0x00d7b3d0]
0061c047 : MOV dword ptr [ESI + 0x2c],EAX
0061c04a : POP EDI
0061c04b : MOV dword ptr [0x00d7b40c],ESI
0061c051 : XOR EAX,EAX
0061c053 : POP ESI
0061c054 : RET

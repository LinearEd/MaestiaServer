PROGRAM  : Maestia.exe
FUNCTION : FUN_0067e2d0
ENTRY    : 0067e2d0
BODY     : [[0067e2d0, 0067e48b]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Type propagation algorithm not settling */

void FUN_0067e2d0(void)

{
  GRefCountImpl *this;
  UINT UVar1;
  int iVar2;
  uint *puVar3;
  LONG LVar4;
  HIMC pHVar5;
  int in_ECX;
  uint local_40 [5];
  undefined4 local_2c;
  uint local_28;
  undefined4 uStack_24;
  tagINPUT tStack_1c;
  
  local_2c = 0;
  local_28 = 0;
  local_40[1] = 0;
  local_40[2] = 0;
  if (*(wchar_t **)(in_ECX + 0x5c) == L"xture Failed (%d)") {
    this = (GRefCountImpl *)(**(code **)(*(int *)(*(int *)(in_ECX + 4) + 8) + 0xc))(0x1b);
    tStack_1c.type = 1;
    tStack_1c.field1_0x4.ki.wVk = 0x1b;
    UVar1 = MapVirtualKeyW(0x1b,0);
    tStack_1c.field1_0x4.ki.wScan = (WORD)UVar1;
    SendInput(1,&tStack_1c,0x1c);
    FUN_00597390();
    FUN_00684a80();
    iVar2 = FUN_0051b1a0();
    if (iVar2 != 0) {
      puVar3 = (uint *)FUN_0051c6e0(local_40,".RemoveList");
      FUN_00678eb0(*(undefined4 *)(in_ECX + 4),(*puVar3 & 0xfffffffc) + 8,&DAT_00cca874);
      LVar4 = InterlockedExchangeAdd((LONG *)((local_40[0] & 0xfffffffc) + 4),-1);
      if (LVar4 == 1) {
        FUN_00515cf0(local_40[0] & 0xfffffffc);
      }
    }
    if (this != (GRefCountImpl *)0x0) {
      GRefCountImpl::Release(this);
    }
  }
  else {
    pHVar5 = ImmGetContext(*(HWND *)(in_ECX + 0x14));
    ImmNotifyIME(pHVar5,0x15,1,0);
    ImmNotifyIME(pHVar5,0x11,0,0);
    ImmNotifyIME(pHVar5,0x15,4,0);
    ImmReleaseContext(*(HWND *)(in_ECX + 0x14),pHVar5);
    **(undefined2 **)(in_ECX + 0x20) = 0;
    *(undefined2 *)(in_ECX + 0x7c) = 0;
    iVar2 = FUN_0051b1a0();
    if (iVar2 != 0) {
      puVar3 = (uint *)FUN_0051c6e0(local_40,".RemoveInputWindow");
      FUN_00678eb0(*(undefined4 *)(in_ECX + 4),(*puVar3 & 0xfffffffc) + 8,0);
      LVar4 = InterlockedExchangeAdd((LONG *)((local_40[0] & 0xfffffffc) + 4),-1);
      if (LVar4 == 1) {
        FUN_00515cf0(local_40[0] & 0xfffffffc);
      }
    }
  }
  if ((local_40[2] >> 6 & 1) != 0) {
    FUN_00588b40(local_40 + 1,local_40[3]);
    local_40[1] = 0;
  }
  if ((local_28 >> 6 & 1) != 0) {
    FUN_00588b40(&local_2c,uStack_24);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
0067e2d0 : SUB ESP,0x40
0067e2d3 : PUSH EBP
0067e2d4 : XOR EBP,EBP
0067e2d6 : PUSH ESI
0067e2d7 : MOV ESI,ECX
0067e2d9 : CMP dword ptr [ESI + 0x5c],0xc10000
0067e2e0 : PUSH EDI
0067e2e1 : MOV dword ptr [ESP + 0x20],EBP
0067e2e5 : MOV dword ptr [ESP + 0x24],EBP
0067e2e9 : MOV dword ptr [ESP + 0x10],EBP
0067e2ed : MOV dword ptr [ESP + 0x14],EBP
0067e2f1 : JNZ 0x0067e3af
0067e2f7 : MOV ECX,dword ptr [ESI + 0x4]
0067e2fa : MOV EAX,dword ptr [ECX + 0x8]
0067e2fd : MOV EDX,dword ptr [EAX + 0xc]
0067e300 : ADD ECX,0x8
0067e303 : PUSH EBX
0067e304 : PUSH 0x1b
0067e306 : CALL EDX
0067e308 : MOV EBX,EAX
0067e30a : MOV EAX,0x1b
0067e30f : PUSH EBP
0067e310 : PUSH EAX
0067e311 : MOV dword ptr [ESP + 0x3c],0x1
0067e319 : MOV word ptr [ESP + 0x40],AX
0067e31e : CALL dword ptr [0x00b85458]
0067e324 : PUSH 0x1c
0067e326 : LEA ECX,[ESP + 0x38]
0067e32a : PUSH ECX
0067e32b : PUSH 0x1
0067e32d : MOV word ptr [ESP + 0x46],AX
0067e332 : CALL dword ptr [0x00b854b8]
0067e338 : MOV ECX,EBX
0067e33a : CALL 0x00597390
0067e33f : MOV ECX,dword ptr [ESI + 0x18]
0067e342 : CALL 0x00684a80
0067e347 : LEA EDI,[ESI + 0x8]
0067e34a : MOV ECX,EDI
0067e34c : CALL 0x0051b1a0
0067e351 : TEST EAX,EAX
0067e353 : JBE 0x0067e39e
0067e355 : PUSH 0xbd7f7c
0067e35a : LEA EDX,[ESP + 0x14]
0067e35e : PUSH EDX
0067e35f : MOV ECX,EDI
0067e361 : CALL 0x0051c6e0
0067e366 : MOV EAX,dword ptr [EAX]
0067e368 : MOV ECX,dword ptr [ESI + 0x4]
0067e36b : AND EAX,0xfffffffc
0067e36e : PUSH 0xcca874
0067e373 : ADD EAX,0x8
0067e376 : PUSH EAX
0067e377 : PUSH ECX
0067e378 : CALL 0x00678eb0
0067e37d : MOV ESI,dword ptr [ESP + 0x1c]
0067e381 : ADD ESP,0xc
0067e384 : AND ESI,0xfffffffc
0067e387 : PUSH -0x1
0067e389 : LEA EDX,[ESI + 0x4]
0067e38c : PUSH EDX
0067e38d : CALL dword ptr [0x00b851cc]
0067e393 : SUB EAX,0x1
0067e396 : JNZ 0x0067e39e
0067e398 : PUSH ESI
0067e399 : CALL 0x00515cf0
0067e39e : CMP EBX,EBP
0067e3a0 : JZ 0x0067e3a9
0067e3a2 : MOV ECX,EBX
0067e3a4 : CALL 0x004ff7e0
0067e3a9 : POP EBX
0067e3aa : JMP 0x0067e445
0067e3af : MOV EAX,dword ptr [ESI + 0x14]
0067e3b2 : PUSH EAX
0067e3b3 : CALL 0x00611450
0067e3b8 : PUSH EBP
0067e3b9 : PUSH 0x1
0067e3bb : MOV EDI,EAX
0067e3bd : PUSH 0x15
0067e3bf : PUSH EDI
0067e3c0 : CALL 0x00685b7e
0067e3c5 : PUSH EBP
0067e3c6 : PUSH EBP
0067e3c7 : PUSH 0x11
0067e3c9 : PUSH EDI
0067e3ca : CALL 0x00685b7e
0067e3cf : PUSH EBP
0067e3d0 : PUSH 0x4
0067e3d2 : PUSH 0x15
0067e3d4 : PUSH EDI
0067e3d5 : CALL 0x00685b7e
0067e3da : MOV ECX,dword ptr [ESI + 0x14]
0067e3dd : PUSH EDI
0067e3de : PUSH ECX
0067e3df : CALL 0x00611462
0067e3e4 : MOV EDX,dword ptr [ESI + 0x20]
0067e3e7 : XOR EAX,EAX
0067e3e9 : XOR ECX,ECX
0067e3eb : MOV word ptr [EDX],AX
0067e3ee : MOV word ptr [ESI + 0x7c],CX
0067e3f2 : LEA EDI,[ESI + 0x8]
0067e3f5 : MOV ECX,EDI
0067e3f7 : CALL 0x0051b1a0
0067e3fc : TEST EAX,EAX
0067e3fe : JBE 0x0067e445
0067e400 : PUSH 0xbd7f88
0067e405 : LEA EDX,[ESP + 0x10]
0067e409 : PUSH EDX
0067e40a : MOV ECX,EDI
0067e40c : CALL 0x0051c6e0
0067e411 : MOV EAX,dword ptr [EAX]
0067e413 : MOV ECX,dword ptr [ESI + 0x4]
0067e416 : AND EAX,0xfffffffc
0067e419 : PUSH EBP
0067e41a : ADD EAX,0x8
0067e41d : PUSH EAX
0067e41e : PUSH ECX
0067e41f : CALL 0x00678eb0
0067e424 : MOV ESI,dword ptr [ESP + 0x18]
0067e428 : ADD ESP,0xc
0067e42b : AND ESI,0xfffffffc
0067e42e : PUSH -0x1
0067e430 : LEA EDX,[ESI + 0x4]
0067e433 : PUSH EDX
0067e434 : CALL dword ptr [0x00b851cc]
0067e43a : SUB EAX,0x1
0067e43d : JNZ 0x0067e445
0067e43f : PUSH ESI
0067e440 : CALL 0x00515cf0
0067e445 : MOV EAX,dword ptr [ESP + 0x14]
0067e449 : SHR EAX,0x6
0067e44c : TEST AL,0x1
0067e44e : JZ 0x0067e467
0067e450 : MOV ECX,dword ptr [ESP + 0x18]
0067e454 : PUSH ECX
0067e455 : MOV ECX,dword ptr [ESP + 0x14]
0067e459 : LEA EDX,[ESP + 0x14]
0067e45d : PUSH EDX
0067e45e : CALL 0x00588b40
0067e463 : MOV dword ptr [ESP + 0x10],EBP
0067e467 : MOV EAX,dword ptr [ESP + 0x24]
0067e46b : SHR EAX,0x6
0067e46e : TEST AL,0x1
0067e470 : JZ 0x0067e485
0067e472 : MOV ECX,dword ptr [ESP + 0x28]
0067e476 : PUSH ECX
0067e477 : MOV ECX,dword ptr [ESP + 0x24]
0067e47b : LEA EDX,[ESP + 0x24]
0067e47f : PUSH EDX
0067e480 : CALL 0x00588b40
0067e485 : POP EDI
0067e486 : POP ESI
0067e487 : POP EBP
0067e488 : ADD ESP,0x40
0067e48b : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00688ff0
ENTRY    : 00688ff0
BODY     : [[00688ff0, 00689289]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00688ff0(int param_1,undefined4 param_2,uint param_3)

{
  int iVar1;
  undefined4 *puVar2;
  int *piVar3;
  int iVar4;
  int iVar5;
  undefined4 uVar6;
  int iVar7;
  uint uVar8;
  
  if (((param_1 != 0) && (*(int *)(param_1 + 0x58) != 0)) &&
     (iVar1 = *(int *)(param_1 + 0x54), iVar1 != 0)) {
    FUN_006882a0();
    puVar2 = *(undefined4 **)(param_1 + 0x60);
    piVar3 = *(int **)(puVar2[1] + 0xa8);
    if ((param_3 & 0x400) != 0) {
      param_3 = param_3 | 0x801;
    }
    if ((param_3 & 1) != 0) {
      param_3 = param_3 & 0xfffffffb | 10;
    }
    if (((((piVar3 == (int *)0x0) || ((param_3 & 2) != 0)) ||
         (((param_3 & 0x8000) != 0 ||
          ((uVar8 = *(uint *)*puVar2, (uVar8 & 0x100) == 0 || ((uVar8 & 0x200) != 0)))))) ||
        (iVar5 = *(int *)(param_1 + 0x80), *(int *)(iVar5 + 0x10) < 1)) ||
       ((*(int *)(iVar5 + 0xc) != 0 ||
        (((((param_3 & 0x20) == 0 && ((uVar8 & 0x400) != 0)) && ((param_3 & 0xf0000) != 0x10000)) &&
         (*(char *)(iVar5 + 0x34) == '\0')))))) {
      iVar5 = (**(code **)(puVar2[5] + 0x50))(iVar1,*(undefined4 *)(param_1 + 0x58),param_2,param_3)
      ;
      if (iVar5 != 0) {
        return iVar5;
      }
      iVar5 = 0;
      if (*(int *)(iVar1 + 0x48) == 0x6f75746c) {
        iVar5 = FUN_00687310(iVar1 + 0x6c);
        if (iVar5 != 0) {
          return iVar5;
        }
        iVar5 = 0;
        if ((param_3 & 2) == 0) {
          FUN_006864b0((byte)param_3 & 0x10);
        }
      }
    }
    else if ((((*(byte *)(param_1 + 8) & 2) == 0) || ((param_3 & 8) != 0)) ||
            ((iVar5 = (**(code **)(puVar2[5] + 0x50))
                                (iVar1,*(undefined4 *)(param_1 + 0x58),param_2,param_3 | 0x4000),
             iVar5 != 0 || (iVar5 = 0, *(int *)(iVar1 + 0x48) != 0x62697473)))) {
      iVar4 = *(int *)(param_1 + 0x80);
      uVar6 = *(undefined4 *)(iVar4 + 0x1c);
      *(undefined4 *)(iVar4 + 0x1c) = 0;
      iVar5 = (**(code **)(*(int *)(*piVar3 + 0x14) + 0xc))
                        (piVar3,iVar1,*(undefined4 *)(param_1 + 0x58),param_2,param_3);
      *(undefined4 *)(iVar4 + 0x1c) = uVar6;
    }
    if ((param_3 & 0x10) == 0) {
      *(undefined4 *)(iVar1 + 0x40) = *(undefined4 *)(iVar1 + 0x28);
      *(undefined4 *)(iVar1 + 0x44) = 0;
    }
    else {
      *(undefined4 *)(iVar1 + 0x40) = 0;
      *(undefined4 *)(iVar1 + 0x44) = *(undefined4 *)(iVar1 + 0x34);
    }
    if (((param_3 & 0x2000) == 0) && ((*(byte *)(param_1 + 8) & 1) != 0)) {
      iVar4 = *(int *)(param_1 + 0x58);
      uVar6 = FUN_00685d60(*(undefined4 *)(iVar1 + 0x38),*(undefined4 *)(iVar4 + 0x10),0x40);
      *(undefined4 *)(iVar1 + 0x38) = uVar6;
      uVar6 = FUN_00685d60(*(undefined4 *)(iVar1 + 0x3c),*(undefined4 *)(iVar4 + 0x14),0x40);
      *(undefined4 *)(iVar1 + 0x3c) = uVar6;
    }
    if (((param_3 & 0x800) == 0) && (iVar4 = *(int *)(param_1 + 0x80), *(int *)(iVar4 + 0x1c) != 0))
    {
      iVar7 = FUN_00686d20();
      if (iVar7 != 0) {
        iVar5 = (**(code **)(*(int *)(iVar7 + 0x14) + 0x2c))(iVar7,iVar1,iVar4 + 4,iVar4 + 0x14);
      }
      FUN_00687440(iVar1 + 0x40,iVar4 + 4);
    }
    if ((((iVar5 == 0) && (*(int *)(iVar1 + 0x48) != 0x62697473)) &&
        (*(int *)(iVar1 + 0x48) != 0x636f6d70)) && ((param_3 & 4) != 0)) {
      uVar8 = (int)param_3 >> 0x10 & 0xf;
      if ((uVar8 == 0) && ((param_3 & 0x1000) != 0)) {
        uVar8 = 2;
      }
      iVar5 = FUN_00688770(iVar1,uVar8);
    }
    return iVar5;
  }
  return 0x23;
}



============================================================
DISASSEMBLY
============================================================
00688ff0 : PUSH EBP
00688ff1 : MOV EBP,dword ptr [ESP + 0x8]
00688ff5 : PUSH ESI
00688ff6 : TEST EBP,EBP
00688ff8 : JZ 0x00689282
00688ffe : CMP dword ptr [EBP + 0x58],0x0
00689002 : JZ 0x00689282
00689008 : MOV ESI,dword ptr [EBP + 0x54]
0068900b : TEST ESI,ESI
0068900d : JZ 0x00689282
00689013 : CALL 0x006882a0
00689018 : MOV ECX,dword ptr [EBP + 0x60]
0068901b : MOV EAX,dword ptr [ECX + 0x4]
0068901e : MOV EDX,dword ptr [EAX + 0xa8]
00689024 : MOV EAX,dword ptr [ESP + 0x14]
00689028 : MOV dword ptr [ESP + 0xc],EDX
0068902c : TEST EAX,0x400
00689031 : JZ 0x0068903c
00689033 : OR EAX,0x801
00689038 : MOV dword ptr [ESP + 0x14],EAX
0068903c : TEST AL,0x1
0068903e : JZ 0x0068904a
00689040 : AND EAX,0xfffffffb
00689043 : OR EAX,0xa
00689046 : MOV dword ptr [ESP + 0x14],EAX
0068904a : PUSH EBX
0068904b : PUSH EDI
0068904c : TEST EDX,EDX
0068904e : JZ 0x00689137
00689054 : TEST AL,0x2
00689056 : JNZ 0x00689137
0068905c : TEST EAX,0x8000
00689061 : JNZ 0x00689137
00689067 : MOV EDI,dword ptr [ECX]
00689069 : MOV EBX,dword ptr [EDI]
0068906b : TEST EBX,0x100
00689071 : JZ 0x00689137
00689077 : TEST EBX,0x200
0068907d : JNZ 0x00689137
00689083 : MOV EDI,dword ptr [EBP + 0x80]
00689089 : CMP dword ptr [EDI + 0x10],0x0
0068908d : JLE 0x00689137
00689093 : CMP dword ptr [EDI + 0xc],0x0
00689097 : JNZ 0x00689137
0068909d : TEST AL,0x20
0068909f : JNZ 0x006890bf
006890a1 : TEST EBX,0x400
006890a7 : JZ 0x006890bf
006890a9 : MOV EBX,EAX
006890ab : AND EBX,0xf0000
006890b1 : CMP EBX,0x10000
006890b7 : JZ 0x006890bf
006890b9 : CMP byte ptr [EDI + 0x34],0x0
006890bd : JZ 0x00689137
006890bf : TEST byte ptr [EBP + 0x8],0x2
006890c3 : JZ 0x006890ff
006890c5 : TEST AL,0x8
006890c7 : JNZ 0x006890ff
006890c9 : MOV EDX,dword ptr [ESP + 0x18]
006890cd : MOV ECX,dword ptr [ECX + 0x14]
006890d0 : MOV ECX,dword ptr [ECX + 0x50]
006890d3 : OR EAX,0x4000
006890d8 : PUSH EAX
006890d9 : MOV EAX,dword ptr [EBP + 0x58]
006890dc : PUSH EDX
006890dd : PUSH EAX
006890de : PUSH ESI
006890df : CALL ECX
006890e1 : MOV EBX,EAX
006890e3 : ADD ESP,0x10
006890e6 : TEST EBX,EBX
006890e8 : JNZ 0x006890f7
006890ea : CMP dword ptr [ESI + 0x48],0x62697473
006890f1 : JZ 0x00689190
006890f7 : MOV EDX,dword ptr [ESP + 0x14]
006890fb : MOV EAX,dword ptr [ESP + 0x1c]
006890ff : MOV EDI,dword ptr [EBP + 0x80]
00689105 : MOV ECX,dword ptr [EDI + 0x1c]
00689108 : PUSH EAX
00689109 : MOV EAX,dword ptr [ESP + 0x1c]
0068910d : MOV dword ptr [EDI + 0x1c],0x0
00689114 : PUSH EAX
00689115 : MOV EAX,dword ptr [EBP + 0x58]
00689118 : MOV dword ptr [ESP + 0x1c],ECX
0068911c : MOV ECX,dword ptr [EDX]
0068911e : MOV ECX,dword ptr [ECX + 0x14]
00689121 : MOV ECX,dword ptr [ECX + 0xc]
00689124 : PUSH EAX
00689125 : PUSH ESI
00689126 : PUSH EDX
00689127 : CALL ECX
00689129 : MOV EDX,dword ptr [ESP + 0x28]
0068912d : ADD ESP,0x14
00689130 : MOV EBX,EAX
00689132 : MOV dword ptr [EDI + 0x1c],EDX
00689135 : JMP 0x00689190
00689137 : MOV EDX,dword ptr [ESP + 0x18]
0068913b : MOV ECX,dword ptr [ECX + 0x14]
0068913e : MOV ECX,dword ptr [ECX + 0x50]
00689141 : PUSH EAX
00689142 : MOV EAX,dword ptr [EBP + 0x58]
00689145 : PUSH EDX
00689146 : PUSH EAX
00689147 : PUSH ESI
00689148 : CALL ECX
0068914a : MOV EBX,EAX
0068914c : ADD ESP,0x10
0068914f : TEST EBX,EBX
00689151 : JNZ 0x0068927b
00689157 : CMP dword ptr [ESI + 0x48],0x6f75746c
0068915e : JNZ 0x00689190
00689160 : LEA EDX,[ESI + 0x6c]
00689163 : PUSH EDX
00689164 : CALL 0x00687310
00689169 : MOV EBX,EAX
0068916b : ADD ESP,0x4
0068916e : TEST EBX,EBX
00689170 : JNZ 0x0068927b
00689176 : MOV ECX,dword ptr [ESP + 0x1c]
0068917a : TEST CL,0x2
0068917d : JNZ 0x00689194
0068917f : AND CL,0x10
00689182 : MOVZX EAX,CL
00689185 : PUSH EAX
00689186 : MOV EAX,ESI
00689188 : CALL 0x006864b0
0068918d : ADD ESP,0x4
00689190 : MOV ECX,dword ptr [ESP + 0x1c]
00689194 : TEST CL,0x10
00689197 : JZ 0x006891a8
00689199 : MOV EDX,dword ptr [ESI + 0x34]
0068919c : MOV dword ptr [ESI + 0x40],0x0
006891a3 : MOV dword ptr [ESI + 0x44],EDX
006891a6 : JMP 0x006891b5
006891a8 : MOV EAX,dword ptr [ESI + 0x28]
006891ab : MOV dword ptr [ESI + 0x40],EAX
006891ae : MOV dword ptr [ESI + 0x44],0x0
006891b5 : TEST ECX,0x2000
006891bb : JNZ 0x006891f4
006891bd : TEST byte ptr [EBP + 0x8],0x1
006891c1 : JZ 0x006891f4
006891c3 : MOV EDI,dword ptr [EBP + 0x58]
006891c6 : MOV ECX,dword ptr [EDI + 0x10]
006891c9 : MOV EDX,dword ptr [ESI + 0x38]
006891cc : ADD EDI,0xc
006891cf : PUSH 0x40
006891d1 : PUSH ECX
006891d2 : PUSH EDX
006891d3 : CALL 0x00685d60
006891d8 : MOV ECX,dword ptr [ESI + 0x3c]
006891db : MOV dword ptr [ESI + 0x38],EAX
006891de : MOV EAX,dword ptr [EDI + 0x8]
006891e1 : PUSH 0x40
006891e3 : PUSH EAX
006891e4 : PUSH ECX
006891e5 : CALL 0x00685d60
006891ea : MOV ECX,dword ptr [ESP + 0x34]
006891ee : ADD ESP,0x18
006891f1 : MOV dword ptr [ESI + 0x3c],EAX
006891f4 : TEST ECX,0x800
006891fa : JNZ 0x0068923e
006891fc : MOV EBP,dword ptr [EBP + 0x80]
00689202 : CMP dword ptr [EBP + 0x1c],0x0
00689206 : JZ 0x0068923e
00689208 : MOV EDX,ESI
0068920a : CALL 0x00686d20
0068920f : TEST EAX,EAX
00689211 : JZ 0x0068922a
00689213 : MOV EDX,dword ptr [EAX + 0x14]
00689216 : MOV EDX,dword ptr [EDX + 0x2c]
00689219 : LEA ECX,[EBP + 0x14]
0068921c : PUSH ECX
0068921d : LEA ECX,[EBP + 0x4]
00689220 : PUSH ECX
00689221 : PUSH ESI
00689222 : PUSH EAX
00689223 : CALL EDX
00689225 : ADD ESP,0x10
00689228 : MOV EBX,EAX
0068922a : ADD EBP,0x4
0068922d : LEA EAX,[ESI + 0x40]
00689230 : PUSH EBP
00689231 : PUSH EAX
00689232 : CALL 0x00687440
00689237 : MOV ECX,dword ptr [ESP + 0x24]
0068923b : ADD ESP,0x8
0068923e : TEST EBX,EBX
00689240 : JNZ 0x0068927b
00689242 : MOV EAX,dword ptr [ESI + 0x48]
00689245 : CMP EAX,0x62697473
0068924a : JZ 0x0068927b
0068924c : CMP EAX,0x636f6d70
00689251 : JZ 0x0068927b
00689253 : TEST CL,0x4
00689256 : JZ 0x0068927b
00689258 : MOV EAX,ECX
0068925a : SAR EAX,0x10
0068925d : AND EAX,0xf
00689260 : JNZ 0x0068926f
00689262 : TEST ECX,0x1000
00689268 : JZ 0x0068926f
0068926a : MOV EAX,0x2
0068926f : PUSH EAX
00689270 : PUSH ESI
00689271 : CALL 0x00688770
00689276 : ADD ESP,0x8
00689279 : MOV EBX,EAX
0068927b : POP EDI
0068927c : MOV EAX,EBX
0068927e : POP EBX
0068927f : POP ESI
00689280 : POP EBP
00689281 : RET
00689282 : POP ESI
00689283 : MOV EAX,0x23
00689288 : POP EBP
00689289 : RET

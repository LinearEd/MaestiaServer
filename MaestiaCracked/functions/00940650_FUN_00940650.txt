PROGRAM  : Maestia.exe
FUNCTION : FUN_00940650
ENTRY    : 00940650
BODY     : [[00940650, 009407a4]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00940650(void)

{
  int iVar1;
  int *in_ECX;
  uint local_34;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1fa5c;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar1 = (**(code **)(*in_ECX + 0x74))();
  if (iVar1 != 0) {
    FUN_00406460();
    local_8 = 0;
    (**(code **)(*in_ECX + 0x58))();
    if (*(int *)(*DAT_00da9894 + 0x114) == 0) {
      local_8 = 0xffffffff;
      if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
    }
    else {
      FUN_00405eb0(local_30,0,0xffffffff);
      local_8 = local_8 & 0xffffff00;
      FUN_008f75f0();
      local_8._0_1_ = 2;
      FUN_009404d0();
      local_8 = (uint)local_8._1_3_ << 8;
      if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_8 = 0xffffffff;
      if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
    }
    local_8 = 0xffffffff;
    local_18 = 7;
    local_2c = 0;
    local_1c = 0;
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00940650 : PUSH EBP
00940651 : MOV EBP,ESP
00940653 : PUSH -0x1
00940655 : PUSH 0xb1fa5c
0094065a : MOV EAX,FS:[0x0]
00940660 : PUSH EAX
00940661 : SUB ESP,0x40
00940664 : MOV EAX,[0x00d66fa0]
00940669 : XOR EAX,EBP
0094066b : MOV dword ptr [EBP + -0x10],EAX
0094066e : PUSH EBX
0094066f : PUSH ESI
00940670 : PUSH EDI
00940671 : PUSH EAX
00940672 : LEA EAX,[EBP + -0xc]
00940675 : MOV FS:[0x0],EAX
0094067b : MOV EDX,dword ptr [EBP + 0x8]
0094067e : MOV ESI,ECX
00940680 : MOV ECX,dword ptr [EBP + 0xc]
00940683 : MOV EAX,dword ptr [ESI]
00940685 : MOV EAX,dword ptr [EAX + 0x74]
00940688 : PUSH ECX
00940689 : PUSH EDX
0094068a : MOV ECX,ESI
0094068c : CALL EAX
0094068e : MOV EDI,EAX
00940690 : XOR EBX,EBX
00940692 : CMP EDI,EBX
00940694 : JZ 0x00940787
0094069a : PUSH 0xc71bd8
0094069f : LEA ECX,[EBP + -0x2c]
009406a2 : CALL 0x00406460
009406a7 : MOV dword ptr [EBP + -0x4],EBX
009406aa : MOV EAX,dword ptr [EDI + 0x10]
009406ad : MOV EDX,dword ptr [ESI]
009406af : MOV EDX,dword ptr [EDX + 0x58]
009406b2 : LEA ECX,[EBP + -0x2c]
009406b5 : PUSH ECX
009406b6 : PUSH EAX
009406b7 : MOV ECX,ESI
009406b9 : CALL EDX
009406bb : MOV EAX,[0x00da9894]
009406c0 : MOV EAX,dword ptr [EAX]
009406c2 : CMP dword ptr [EAX + 0x114],EBX
009406c8 : JNZ 0x009406f1
009406ca : MOV dword ptr [EBP + -0x4],0xffffffff
009406d1 : CMP dword ptr [EBP + -0x14],0x8
009406d5 : JC 0x009406df
009406d7 : MOV ECX,dword ptr [EBP + -0x28]
009406da : CALL 0x006f04e0
009406df : XOR ECX,ECX
009406e1 : MOV dword ptr [EBP + -0x14],0x7
009406e8 : MOV word ptr [EBP + -0x28],CX
009406ec : JMP 0x00940784
009406f1 : SUB ESP,0x1c
009406f4 : MOV ECX,ESP
009406f6 : MOV dword ptr [EBP + -0x4c],ESP
009406f9 : PUSH -0x1
009406fb : PUSH EBX
009406fc : LEA EAX,[EBP + -0x2c]
009406ff : XOR EDX,EDX
00940701 : MOV dword ptr [ECX + 0x18],0x7
00940708 : MOV dword ptr [ECX + 0x14],EBX
0094070b : PUSH EAX
0094070c : MOV word ptr [ECX + 0x4],DX
00940710 : CALL 0x00405eb0
00940715 : MOV byte ptr [EBP + -0x4],0x1
00940719 : MOV byte ptr [EBP + -0x4],BL
0094071c : LEA ECX,[EBP + -0x48]
0094071f : CALL 0x008f75f0
00940724 : ADD ESP,0x1c
00940727 : MOV byte ptr [EBP + -0x4],0x2
0094072b : MOV ECX,dword ptr [EBP + 0x14]
0094072e : MOV EDX,dword ptr [EBP + 0xc]
00940731 : MOV EAX,dword ptr [EBP + 0x8]
00940734 : PUSH ECX
00940735 : PUSH EDX
00940736 : PUSH EAX
00940737 : LEA ECX,[EBP + -0x48]
0094073a : PUSH ECX
0094073b : PUSH ESI
0094073c : CALL 0x009404d0
00940741 : MOV byte ptr [EBP + -0x4],BL
00940744 : MOV ESI,0x8
00940749 : CMP dword ptr [EBP + -0x30],ESI
0094074c : JC 0x00940756
0094074e : MOV ECX,dword ptr [EBP + -0x44]
00940751 : CALL 0x006f04e0
00940756 : MOV EDI,0x7
0094075b : XOR EDX,EDX
0094075d : MOV dword ptr [EBP + -0x30],EDI
00940760 : MOV dword ptr [EBP + -0x34],EBX
00940763 : MOV word ptr [EBP + -0x44],DX
00940767 : MOV dword ptr [EBP + -0x4],0xffffffff
0094076e : CMP dword ptr [EBP + -0x14],ESI
00940771 : JC 0x0094077b
00940773 : MOV ECX,dword ptr [EBP + -0x28]
00940776 : CALL 0x006f04e0
0094077b : XOR EAX,EAX
0094077d : MOV dword ptr [EBP + -0x14],EDI
00940780 : MOV word ptr [EBP + -0x28],AX
00940784 : MOV dword ptr [EBP + -0x18],EBX
00940787 : MOV ECX,dword ptr [EBP + -0xc]
0094078a : MOV dword ptr FS:[0x0],ECX
00940791 : POP ECX
00940792 : POP EDI
00940793 : POP ESI
00940794 : POP EBX
00940795 : MOV ECX,dword ptr [EBP + -0x10]
00940798 : XOR ECX,EBP
0094079a : CALL 0x00633e6b
0094079f : MOV ESP,EBP
009407a1 : POP EBP
009407a2 : RET 0x10

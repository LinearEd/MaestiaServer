PROGRAM  : Maestia.exe
FUNCTION : FUN_0068b5f0
ENTRY    : 0068b5f0
BODY     : [[0068b5f0, 0068b92d]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_0068b5f0(undefined4 *param_1,int *param_2,int *param_3,int param_4)

{
  byte bVar1;
  undefined4 uVar2;
  size_t _Size;
  int iVar3;
  uint uVar4;
  byte *pbVar5;
  int iVar6;
  int iVar7;
  byte *pbVar8;
  void *_Dst;
  byte *pbVar9;
  void *_Src;
  uint uVar10;
  byte *pbVar11;
  int local_c;
  int local_8;
  int local_4;
  
  iVar7 = 0;
  local_c = 0;
  if (param_1 == (undefined4 *)0x0) {
    return 0x21;
  }
  uVar2 = *param_1;
  if ((byte)(*(char *)((int)param_2 + 0x12) - 1U) < 4) {
    iVar6 = *param_3 * param_3[2];
    if (iVar6 < 0) {
      iVar6 = -iVar6;
    }
    *(undefined1 *)((int)param_3 + 0x12) = 2;
    *param_3 = *param_2;
    param_3[1] = param_2[1];
    if (0 < param_4) {
      iVar7 = 0;
      if (param_2[1] % param_4 != 0) {
        iVar7 = param_4 - param_2[1] % param_4;
      }
    }
    iVar3 = *param_3 * (iVar7 + param_2[1]);
    param_3[2] = iVar7 + param_2[1];
    if (iVar3 - iVar6 != 0 && iVar6 <= iVar3) {
      iVar7 = FUN_00688c60(uVar2,1,iVar6,iVar3,param_3[3],&local_c);
      param_3[3] = iVar7;
      if (local_c != 0) {
        return local_c;
      }
    }
  }
  else {
    local_c = 6;
  }
  switch(*(undefined1 *)((int)param_2 + 0x12)) {
  case 1:
    pbVar5 = (byte *)param_2[3];
    pbVar8 = (byte *)param_3[3];
    *(undefined2 *)(param_3 + 4) = 2;
    local_4 = *param_2;
    if (0 < local_4) {
      do {
        pbVar9 = pbVar8;
        pbVar11 = pbVar5;
        for (iVar7 = param_2[1] >> 3; 0 < iVar7; iVar7 = iVar7 + -1) {
          bVar1 = *pbVar11;
          uVar4 = (uint)bVar1;
          *pbVar9 = (byte)((int)uVar4 >> 7);
          pbVar9[1] = (byte)((int)uVar4 >> 6) & 1;
          pbVar9[2] = (byte)((int)uVar4 >> 5) & 1;
          pbVar9[3] = (byte)((int)uVar4 >> 4) & 1;
          pbVar9[4] = (byte)((int)uVar4 >> 3) & 1;
          pbVar9[5] = (byte)((int)uVar4 >> 2) & 1;
          pbVar9[6] = (byte)((int)uVar4 >> 1) & 1;
          pbVar9[7] = bVar1 & 1;
          pbVar9 = pbVar9 + 8;
          pbVar11 = pbVar11 + 1;
        }
        uVar4 = param_2[1] & 7;
        if (uVar4 != 0) {
          uVar10 = (uint)*pbVar11;
          do {
            *pbVar9 = (byte)((int)uVar10 >> 7) & 1;
            uVar4 = uVar4 - 1;
            uVar10 = uVar10 * 2;
            pbVar9 = pbVar9 + 1;
          } while (0 < (int)uVar4);
        }
        pbVar5 = pbVar5 + param_2[2];
        pbVar8 = pbVar8 + param_3[2];
        local_4 = local_4 + -1;
      } while (0 < local_4);
      return local_c;
    }
    break;
  case 2:
    _Size = param_2[1];
    local_4 = param_2[2];
    _Src = (void *)param_2[3];
    local_8 = param_3[2];
    _Dst = (void *)param_3[3];
    *(undefined2 *)(param_3 + 4) = 0x100;
    iVar7 = *param_2;
    if (0 < iVar7) {
      do {
        _memcpy(_Dst,_Src,_Size);
        _Src = (void *)((int)_Src + local_4);
        _Dst = (void *)((int)_Dst + local_8);
        iVar7 = iVar7 + -1;
      } while (0 < iVar7);
      return local_c;
    }
    break;
  case 3:
    pbVar5 = (byte *)param_2[3];
    pbVar8 = (byte *)param_3[3];
    *(undefined2 *)(param_3 + 4) = 4;
    local_8 = *param_2;
    if (0 < local_8) {
      do {
        pbVar9 = pbVar8;
        pbVar11 = pbVar5;
        for (iVar7 = param_2[1] >> 2; 0 < iVar7; iVar7 = iVar7 + -1) {
          bVar1 = *pbVar11;
          uVar4 = (uint)bVar1;
          *pbVar9 = (byte)((int)uVar4 >> 6);
          pbVar9[1] = (byte)((int)uVar4 >> 4) & 3;
          pbVar9[2] = (byte)((int)uVar4 >> 2) & 3;
          pbVar9[3] = bVar1 & 3;
          pbVar11 = pbVar11 + 1;
          pbVar9 = pbVar9 + 4;
        }
        uVar4 = param_2[1] & 3;
        if (uVar4 != 0) {
          uVar10 = (uint)*pbVar11;
          do {
            *pbVar9 = (byte)((int)uVar10 >> 6) & 3;
            uVar4 = uVar4 - 1;
            uVar10 = uVar10 * 4;
            pbVar9 = pbVar9 + 1;
          } while (0 < (int)uVar4);
        }
        pbVar5 = pbVar5 + param_2[2];
        pbVar8 = pbVar8 + param_3[2];
        local_8 = local_8 + -1;
      } while (0 < local_8);
      return local_c;
    }
    break;
  case 4:
    pbVar5 = (byte *)param_2[3];
    pbVar8 = (byte *)param_3[3];
    *(undefined2 *)(param_3 + 4) = 0x10;
    for (iVar7 = *param_2; 0 < iVar7; iVar7 = iVar7 + -1) {
      pbVar9 = pbVar5;
      pbVar11 = pbVar8;
      for (iVar6 = param_2[1] >> 1; 0 < iVar6; iVar6 = iVar6 + -1) {
        bVar1 = *pbVar9;
        *pbVar11 = (byte)((int)(uint)bVar1 >> 4);
        pbVar11[1] = bVar1 & 0xf;
        pbVar9 = pbVar9 + 1;
        pbVar11 = pbVar11 + 2;
      }
      if ((*(byte *)(param_2 + 1) & 1) != 0) {
        *pbVar11 = *pbVar9 >> 4;
      }
      pbVar5 = pbVar5 + param_2[2];
      pbVar8 = pbVar8 + param_3[2];
    }
  }
  return local_c;
}



============================================================
DISASSEMBLY
============================================================
0068b5f0 : SUB ESP,0xc
0068b5f3 : MOV EAX,dword ptr [ESP + 0x10]
0068b5f7 : XOR EDX,EDX
0068b5f9 : MOV dword ptr [ESP],EDX
0068b5fc : CMP EAX,EDX
0068b5fe : JNZ 0x0068b607
0068b600 : LEA EAX,[EDX + 0x21]
0068b603 : ADD ESP,0xc
0068b606 : RET
0068b607 : PUSH EBX
0068b608 : MOV EBX,dword ptr [ESP + 0x1c]
0068b60c : PUSH EBP
0068b60d : MOV EBP,dword ptr [EAX]
0068b60f : PUSH ESI
0068b610 : MOV ESI,dword ptr [ESP + 0x20]
0068b614 : MOV AL,byte ptr [ESI + 0x12]
0068b617 : DEC AL
0068b619 : PUSH EDI
0068b61a : CMP AL,0x3
0068b61c : JA 0x0068b688
0068b61e : MOV ECX,dword ptr [EBX]
0068b620 : IMUL ECX,dword ptr [EBX + 0x8]
0068b624 : CMP ECX,EDX
0068b626 : JGE 0x0068b62a
0068b628 : NEG ECX
0068b62a : MOV EDI,dword ptr [ESP + 0x2c]
0068b62e : MOV byte ptr [EBX + 0x12],0x2
0068b632 : MOV EAX,dword ptr [ESI]
0068b634 : MOV dword ptr [EBX],EAX
0068b636 : MOV EAX,dword ptr [ESI + 0x4]
0068b639 : MOV dword ptr [EBX + 0x4],EAX
0068b63c : TEST EDI,EDI
0068b63e : JLE 0x0068b64e
0068b640 : MOV EAX,dword ptr [ESI + 0x4]
0068b643 : CDQ
0068b644 : IDIV EDI
0068b646 : TEST EDX,EDX
0068b648 : JZ 0x0068b64e
0068b64a : SUB EDI,EDX
0068b64c : MOV EDX,EDI
0068b64e : MOV EAX,dword ptr [ESI + 0x4]
0068b651 : ADD EDX,EAX
0068b653 : MOV EAX,dword ptr [EBX]
0068b655 : IMUL EAX,EDX
0068b658 : CMP EAX,ECX
0068b65a : MOV dword ptr [EBX + 0x8],EDX
0068b65d : JLE 0x0068b690
0068b65f : LEA EDX,[ESP + 0x10]
0068b663 : PUSH EDX
0068b664 : MOV EDX,dword ptr [EBX + 0xc]
0068b667 : PUSH EDX
0068b668 : PUSH EAX
0068b669 : PUSH ECX
0068b66a : PUSH 0x1
0068b66c : PUSH EBP
0068b66d : CALL 0x00688c60
0068b672 : MOV dword ptr [EBX + 0xc],EAX
0068b675 : MOV EAX,dword ptr [ESP + 0x28]
0068b679 : ADD ESP,0x18
0068b67c : TEST EAX,EAX
0068b67e : JZ 0x0068b690
0068b680 : POP EDI
0068b681 : POP ESI
0068b682 : POP EBP
0068b683 : POP EBX
0068b684 : ADD ESP,0xc
0068b687 : RET
0068b688 : MOV dword ptr [ESP + 0x10],0x6
0068b690 : MOVSX EAX,byte ptr [ESI + 0x12]
0068b694 : DEC EAX
0068b695 : CMP EAX,0x3
0068b698 : JA 0x0068b922
0068b69e : JMP dword ptr [EAX*0x4 + 0x68b930]
0068b6a5 : MOV EBP,dword ptr [ESI + 0xc]
0068b6a8 : MOV ECX,dword ptr [EBX + 0xc]
0068b6ab : MOV EAX,0x2
0068b6b0 : MOV word ptr [EBX + 0x10],AX
0068b6b4 : MOV EAX,dword ptr [ESI]
0068b6b6 : MOV dword ptr [ESP + 0x20],EBP
0068b6ba : MOV dword ptr [ESP + 0x14],ECX
0068b6be : MOV dword ptr [ESP + 0x18],EAX
0068b6c2 : TEST EAX,EAX
0068b6c4 : JLE 0x0068b922
0068b6ca : LEA EBX,[EBX]
0068b6d0 : MOV EDI,dword ptr [ESI + 0x4]
0068b6d3 : SAR EDI,0x3
0068b6d6 : TEST EDI,EDI
0068b6d8 : JLE 0x0068b73d
0068b6da : LEA EBX,[EBX]
0068b6e0 : MOVZX EAX,byte ptr [EBP]
0068b6e4 : MOV EDX,EAX
0068b6e6 : SAR EDX,0x7
0068b6e9 : AND DL,0x1
0068b6ec : MOV byte ptr [ECX],DL
0068b6ee : MOV EDX,EAX
0068b6f0 : SAR EDX,0x6
0068b6f3 : AND DL,0x1
0068b6f6 : MOV byte ptr [ECX + 0x1],DL
0068b6f9 : MOV EDX,EAX
0068b6fb : SAR EDX,0x5
0068b6fe : AND DL,0x1
0068b701 : MOV byte ptr [ECX + 0x2],DL
0068b704 : MOV EDX,EAX
0068b706 : SAR EDX,0x4
0068b709 : AND DL,0x1
0068b70c : MOV byte ptr [ECX + 0x3],DL
0068b70f : MOV EDX,EAX
0068b711 : SAR EDX,0x3
0068b714 : AND DL,0x1
0068b717 : MOV byte ptr [ECX + 0x4],DL
0068b71a : MOV EDX,EAX
0068b71c : SAR EDX,0x2
0068b71f : AND DL,0x1
0068b722 : MOV byte ptr [ECX + 0x5],DL
0068b725 : MOV EDX,EAX
0068b727 : SAR EDX,0x1
0068b729 : AND DL,0x1
0068b72c : AND AL,0x1
0068b72e : MOV byte ptr [ECX + 0x6],DL
0068b731 : MOV byte ptr [ECX + 0x7],AL
0068b734 : DEC EDI
0068b735 : ADD ECX,0x8
0068b738 : INC EBP
0068b739 : TEST EDI,EDI
0068b73b : JG 0x0068b6e0
0068b73d : MOV EAX,dword ptr [ESI + 0x4]
0068b740 : AND EAX,0x7
0068b743 : JLE 0x0068b762
0068b745 : MOVZX EDI,byte ptr [EBP]
0068b749 : LEA ESP,[ESP]
0068b750 : MOV EDX,EDI
0068b752 : SAR EDX,0x7
0068b755 : AND DL,0x1
0068b758 : MOV byte ptr [ECX],DL
0068b75a : DEC EAX
0068b75b : ADD EDI,EDI
0068b75d : INC ECX
0068b75e : TEST EAX,EAX
0068b760 : JG 0x0068b750
0068b762 : MOV EBP,dword ptr [ESP + 0x20]
0068b766 : MOV ECX,dword ptr [ESP + 0x14]
0068b76a : MOV EAX,dword ptr [ESP + 0x18]
0068b76e : ADD EBP,dword ptr [ESI + 0x8]
0068b771 : ADD ECX,dword ptr [EBX + 0x8]
0068b774 : DEC EAX
0068b775 : MOV dword ptr [ESP + 0x20],EBP
0068b779 : MOV dword ptr [ESP + 0x14],ECX
0068b77d : MOV dword ptr [ESP + 0x18],EAX
0068b781 : TEST EAX,EAX
0068b783 : JG 0x0068b6d0
0068b789 : MOV EAX,dword ptr [ESP + 0x10]
0068b78d : POP EDI
0068b78e : POP ESI
0068b78f : POP EBP
0068b790 : POP EBX
0068b791 : ADD ESP,0xc
0068b794 : RET
0068b795 : MOV EAX,dword ptr [ESI + 0x4]
0068b798 : MOV ECX,dword ptr [ESI + 0x8]
0068b79b : MOV EDI,dword ptr [ESI + 0xc]
0068b79e : MOV EDX,dword ptr [EBX + 0x8]
0068b7a1 : MOV EBP,dword ptr [EBX + 0xc]
0068b7a4 : MOV dword ptr [ESP + 0x20],EAX
0068b7a8 : MOV EAX,0x100
0068b7ad : MOV word ptr [EBX + 0x10],AX
0068b7b1 : MOV ESI,dword ptr [ESI]
0068b7b3 : MOV dword ptr [ESP + 0x18],ECX
0068b7b7 : MOV dword ptr [ESP + 0x14],EDX
0068b7bb : TEST ESI,ESI
0068b7bd : JLE 0x0068b922
0068b7c3 : MOV ECX,dword ptr [ESP + 0x20]
0068b7c7 : PUSH ECX
0068b7c8 : PUSH EDI
0068b7c9 : PUSH EBP
0068b7ca : CALL 0x0063ae40
0068b7cf : ADD EDI,dword ptr [ESP + 0x24]
0068b7d3 : ADD EBP,dword ptr [ESP + 0x20]
0068b7d7 : DEC ESI
0068b7d8 : ADD ESP,0xc
0068b7db : TEST ESI,ESI
0068b7dd : JG 0x0068b7c3
0068b7df : MOV EAX,dword ptr [ESP + 0x10]
0068b7e3 : POP EDI
0068b7e4 : POP ESI
0068b7e5 : POP EBP
0068b7e6 : POP EBX
0068b7e7 : ADD ESP,0xc
0068b7ea : RET
0068b7eb : MOV EBP,dword ptr [ESI + 0xc]
0068b7ee : MOV ECX,dword ptr [EBX + 0xc]
0068b7f1 : MOV EDX,0x4
0068b7f6 : MOV word ptr [EBX + 0x10],DX
0068b7fa : MOV EAX,dword ptr [ESI]
0068b7fc : MOV dword ptr [ESP + 0x20],EBP
0068b800 : MOV dword ptr [ESP + 0x18],ECX
0068b804 : MOV dword ptr [ESP + 0x14],EAX
0068b808 : TEST EAX,EAX
0068b80a : JLE 0x0068b922
0068b810 : MOV EDI,dword ptr [ESI + 0x4]
0068b813 : SAR EDI,0x2
0068b816 : TEST EDI,EDI
0068b818 : JLE 0x0068b852
0068b81a : LEA EBX,[EBX]
0068b820 : MOVZX EAX,byte ptr [EBP]
0068b824 : MOV EDX,EAX
0068b826 : SAR EDX,0x6
0068b829 : AND DL,0x3
0068b82c : MOV byte ptr [ECX],DL
0068b82e : MOV EDX,EAX
0068b830 : SAR EDX,0x4
0068b833 : AND DL,0x3
0068b836 : MOV byte ptr [ECX + 0x1],DL
0068b839 : MOV EDX,EAX
0068b83b : SAR EDX,0x2
0068b83e : AND DL,0x3
0068b841 : AND AL,0x3
0068b843 : MOV byte ptr [ECX + 0x2],DL
0068b846 : MOV byte ptr [ECX + 0x3],AL
0068b849 : DEC EDI
0068b84a : INC EBP
0068b84b : ADD ECX,0x4
0068b84e : TEST EDI,EDI
0068b850 : JG 0x0068b820
0068b852 : MOV EAX,dword ptr [ESI + 0x4]
0068b855 : AND EAX,0x3
0068b858 : JLE 0x0068b874
0068b85a : MOVZX EDI,byte ptr [EBP]
0068b85e : MOV EDI,EDI
0068b860 : MOV EDX,EDI
0068b862 : SAR EDX,0x6
0068b865 : AND DL,0x3
0068b868 : ADD EDI,EDI
0068b86a : MOV byte ptr [ECX],DL
0068b86c : DEC EAX
0068b86d : ADD EDI,EDI
0068b86f : INC ECX
0068b870 : TEST EAX,EAX
0068b872 : JG 0x0068b860
0068b874 : MOV EBP,dword ptr [ESP + 0x20]
0068b878 : MOV ECX,dword ptr [ESP + 0x18]
0068b87c : MOV EAX,dword ptr [ESP + 0x14]
0068b880 : ADD EBP,dword ptr [ESI + 0x8]
0068b883 : ADD ECX,dword ptr [EBX + 0x8]
0068b886 : DEC EAX
0068b887 : MOV dword ptr [ESP + 0x20],EBP
0068b88b : MOV dword ptr [ESP + 0x18],ECX
0068b88f : MOV dword ptr [ESP + 0x14],EAX
0068b893 : TEST EAX,EAX
0068b895 : JG 0x0068b810
0068b89b : MOV EAX,dword ptr [ESP + 0x10]
0068b89f : POP EDI
0068b8a0 : POP ESI
0068b8a1 : POP EBP
0068b8a2 : POP EBX
0068b8a3 : ADD ESP,0xc
0068b8a6 : RET
0068b8a7 : MOV EAX,dword ptr [ESI + 0xc]
0068b8aa : MOV EDX,dword ptr [EBX + 0xc]
0068b8ad : MOV ECX,0x10
0068b8b2 : MOV word ptr [EBX + 0x10],CX
0068b8b6 : MOV ECX,dword ptr [ESI]
0068b8b8 : MOV dword ptr [ESP + 0x20],EAX
0068b8bc : MOV dword ptr [ESP + 0x18],EDX
0068b8c0 : MOV dword ptr [ESP + 0x14],ECX
0068b8c4 : TEST ECX,ECX
0068b8c6 : JLE 0x0068b922
0068b8c8 : MOV ECX,dword ptr [ESI + 0x4]
0068b8cb : SAR ECX,0x1
0068b8cd : MOV EBP,EAX
0068b8cf : MOV EDI,EDX
0068b8d1 : TEST ECX,ECX
0068b8d3 : JLE 0x0068b8f9
0068b8d5 : MOVZX EAX,byte ptr [EBP]
0068b8d9 : MOV EDX,EAX
0068b8db : SAR EDX,0x4
0068b8de : AND DL,0xf
0068b8e1 : AND AL,0xf
0068b8e3 : MOV byte ptr [EDI],DL
0068b8e5 : MOV byte ptr [EDI + 0x1],AL
0068b8e8 : DEC ECX
0068b8e9 : INC EBP
0068b8ea : ADD EDI,0x2
0068b8ed : TEST ECX,ECX
0068b8ef : JG 0x0068b8d5
0068b8f1 : MOV EDX,dword ptr [ESP + 0x18]
0068b8f5 : MOV EAX,dword ptr [ESP + 0x20]
0068b8f9 : TEST byte ptr [ESI + 0x4],0x1
0068b8fd : JZ 0x0068b907
0068b8ff : MOV CL,byte ptr [EBP]
0068b902 : SHR CL,0x4
0068b905 : MOV byte ptr [EDI],CL
0068b907 : MOV ECX,dword ptr [ESP + 0x14]
0068b90b : ADD EAX,dword ptr [ESI + 0x8]
0068b90e : ADD EDX,dword ptr [EBX + 0x8]
0068b911 : DEC ECX
0068b912 : MOV dword ptr [ESP + 0x20],EAX
0068b916 : MOV dword ptr [ESP + 0x18],EDX
0068b91a : MOV dword ptr [ESP + 0x14],ECX
0068b91e : TEST ECX,ECX
0068b920 : JG 0x0068b8c8
0068b922 : MOV EAX,dword ptr [ESP + 0x10]
0068b926 : POP EDI
0068b927 : POP ESI
0068b928 : POP EBP
0068b929 : POP EBX
0068b92a : ADD ESP,0xc
0068b92d : RET

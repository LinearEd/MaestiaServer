PROGRAM  : Maestia.exe
FUNCTION : FUN_005560e0
ENTRY    : 005560e0
BODY     : [[005560e0, 0055647e]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x00556167) */

void FUN_005560e0(int param_1)

{
  byte *pbVar1;
  byte bVar2;
  int iVar3;
  ushort uVar4;
  uint uVar5;
  int *in_ECX;
  
  *in_ECX = param_1;
  in_ECX[1] = *(int *)(param_1 + 0x28);
  in_ECX[2] = -1;
  in_ECX[3] = 0;
  in_ECX[4] = 0;
  *(undefined1 *)(in_ECX + 8) = 0;
  if (in_ECX[1] == 0) {
    *(undefined1 *)(in_ECX + 8) = 1;
    in_ECX[0x1b] = 0x3f800000;
    *(undefined1 *)(in_ECX + 0x1c) = 0;
    in_ECX[0x10] = 0;
    in_ECX[0xf] = 0;
    in_ECX[0xe] = 0;
    in_ECX[0xd] = 0;
    in_ECX[0x12] = 0;
    in_ECX[0x11] = 0;
    in_ECX[0xc] = 0;
    in_ECX[0xb] = 0;
    in_ECX[0x13] = 0;
    in_ECX[0x14] = 0;
    in_ECX[7] = 0;
    in_ECX[6] = 0;
    in_ECX[5] = 0;
    in_ECX[10] = 0;
    in_ECX[9] = 0;
  }
  else {
    if (in_ECX[4] != 0) {
      in_ECX[3] = in_ECX[3] + 1;
    }
    in_ECX[4] = 0;
    bVar2 = *(byte *)(in_ECX[3] + in_ECX[1]);
    in_ECX[3] = in_ECX[3] + 1;
    *(byte *)(in_ECX + 0x1c) = bVar2;
    if ((*(byte *)(param_1 + 0x24) & 2) == 0) {
      iVar3 = 0x3f800000;
    }
    else {
      iVar3 = 0x3d4ccccd;
      *(byte *)(in_ECX + 0x1c) = bVar2 | 0x80;
    }
    in_ECX[0x1b] = iVar3;
    if (in_ECX[4] != 0) {
      in_ECX[3] = in_ECX[3] + 1;
    }
    in_ECX[3] = in_ECX[3] + (*(byte *)(in_ECX + 0x1c) >> 3 & 3) + 1;
    in_ECX[4] = 0;
    if ((*(byte *)(in_ECX + 0x1c) & 1) == 0) {
      in_ECX[0xf] = 0;
    }
    else {
      in_ECX[4] = 0;
      uVar4 = *(ushort *)(in_ECX[1] + in_ECX[3]);
      in_ECX[3] = in_ECX[3] + 2;
      in_ECX[0xf] = (uint)uVar4;
    }
    if ((*(byte *)(in_ECX + 0x1c) & 2) == 0) {
      in_ECX[0x10] = 0;
    }
    else {
      if (in_ECX[4] != 0) {
        in_ECX[3] = in_ECX[3] + 1;
      }
      in_ECX[4] = 0;
      uVar4 = *(ushort *)(in_ECX[1] + in_ECX[3]);
      in_ECX[3] = in_ECX[3] + 2;
      in_ECX[0x10] = (uint)uVar4;
    }
    in_ECX[0xe] = 0;
    in_ECX[0xd] = 0;
    switch(in_ECX[4]) {
    case 0:
      uVar5 = (uint)(*(byte *)(in_ECX[3] + in_ECX[1]) >> 4);
      in_ECX[4] = 4;
      break;
    case 1:
      uVar5 = *(byte *)(in_ECX[3] + in_ECX[1]) >> 3 & 0xf;
      in_ECX[4] = 5;
      break;
    case 2:
      uVar5 = *(byte *)(in_ECX[3] + in_ECX[1]) >> 2 & 0xf;
      in_ECX[4] = 6;
      break;
    case 3:
      uVar5 = *(byte *)(in_ECX[3] + in_ECX[1]) >> 1 & 0xf;
      in_ECX[4] = 7;
      break;
    case 4:
      uVar5 = *(byte *)(in_ECX[3] + in_ECX[1]) & 0xf;
      in_ECX[4] = 0;
      in_ECX[3] = in_ECX[3] + 1;
      break;
    case 5:
      pbVar1 = (byte *)(in_ECX[3] + in_ECX[1]);
      uVar5 = (uint)(pbVar1[1] >> 7) | (*pbVar1 & 7) * 2;
      in_ECX[4] = 1;
      in_ECX[3] = in_ECX[3] + 1;
      break;
    case 6:
      pbVar1 = (byte *)(in_ECX[3] + in_ECX[1]);
      uVar5 = (uint)(pbVar1[1] >> 6) | (*pbVar1 & 3) * 4;
      in_ECX[4] = 2;
      in_ECX[3] = in_ECX[3] + 1;
      break;
    case 7:
      pbVar1 = (byte *)(in_ECX[3] + in_ECX[1]);
      uVar5 = (uint)(pbVar1[1] >> 5) | (*pbVar1 & 1) * 8;
      in_ECX[4] = 3;
      in_ECX[3] = in_ECX[3] + 1;
      break;
    default:
      uVar5 = 0;
    }
    in_ECX[0x11] = uVar5;
    switch(in_ECX[4]) {
    case 0:
      uVar5 = (uint)(*(byte *)(in_ECX[3] + in_ECX[1]) >> 4);
      in_ECX[4] = 4;
      break;
    case 1:
      uVar5 = *(byte *)(in_ECX[3] + in_ECX[1]) >> 3 & 0xf;
      in_ECX[4] = 5;
      break;
    case 2:
      uVar5 = *(byte *)(in_ECX[3] + in_ECX[1]) >> 2 & 0xf;
      in_ECX[4] = 6;
      break;
    case 3:
      uVar5 = *(byte *)(in_ECX[3] + in_ECX[1]) >> 1 & 0xf;
      in_ECX[4] = 7;
      break;
    case 4:
      uVar5 = *(byte *)(in_ECX[3] + in_ECX[1]) & 0xf;
      in_ECX[4] = 0;
      in_ECX[3] = in_ECX[3] + 1;
      break;
    case 5:
      pbVar1 = (byte *)(in_ECX[3] + in_ECX[1]);
      uVar5 = (uint)(pbVar1[1] >> 7) | (*pbVar1 & 7) * 2;
      in_ECX[4] = 1;
      in_ECX[3] = in_ECX[3] + 1;
      break;
    case 6:
      pbVar1 = (byte *)(in_ECX[3] + in_ECX[1]);
      uVar5 = (uint)(pbVar1[1] >> 6) | (*pbVar1 & 3) * 4;
      in_ECX[4] = 2;
      in_ECX[3] = in_ECX[3] + 1;
      break;
    case 7:
      pbVar1 = (byte *)(in_ECX[3] + in_ECX[1]);
      uVar5 = (uint)(pbVar1[1] >> 5) | (*pbVar1 & 1) * 8;
      in_ECX[4] = 3;
      in_ECX[3] = in_ECX[3] + 1;
      break;
    default:
      uVar5 = 0;
    }
    in_ECX[0x12] = uVar5;
    in_ECX[0xc] = 0;
    in_ECX[0xb] = 0;
    in_ECX[0x13] = 0;
    in_ECX[0x14] = 0;
    in_ECX[7] = 0;
    in_ECX[6] = 0;
    in_ECX[5] = 0;
    in_ECX[10] = 0;
    in_ECX[9] = 0;
    if ((char)in_ECX[8] != '\x01') {
      while (FUN_00553740(), (char)in_ECX[8] == '\x03') {
        if ((char)in_ECX[8] == '\x01') {
          return;
        }
      }
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005560e0 : PUSH ESI
005560e1 : MOV ESI,ECX
005560e3 : PUSH EDI
005560e4 : MOV EDI,dword ptr [ESP + 0xc]
005560e8 : MOV dword ptr [ESI],EDI
005560ea : MOV EAX,dword ptr [EDI + 0x28]
005560ed : XOR ECX,ECX
005560ef : MOV dword ptr [ESI + 0x4],EAX
005560f2 : MOV dword ptr [ESI + 0x8],0xffffffff
005560f9 : MOV dword ptr [ESI + 0xc],ECX
005560fc : MOV dword ptr [ESI + 0x10],ECX
005560ff : MOV byte ptr [ESI + 0x20],CL
00556102 : CMP dword ptr [ESI + 0x4],ECX
00556105 : JZ 0x0055643f
0055610b : PUSH EBX
0055610c : LEA EBX,[ECX + 0x1]
0055610f : CMP dword ptr [ESI + 0x10],ECX
00556112 : JZ 0x00556117
00556114 : ADD dword ptr [ESI + 0xc],EBX
00556117 : MOV EAX,dword ptr [ESI + 0xc]
0055611a : MOV EDX,dword ptr [ESI + 0x4]
0055611d : MOV dword ptr [ESI + 0x10],ECX
00556120 : MOV DL,byte ptr [EAX + EDX*0x1]
00556123 : INC EAX
00556124 : MOV dword ptr [ESI + 0xc],EAX
00556127 : MOV byte ptr [ESI + 0x70],DL
0055612a : TEST byte ptr [EDI + 0x24],0x2
0055612e : JZ 0x0055613e
00556130 : FLD float ptr [0x00cdf0f4]
00556136 : OR DL,0x80
00556139 : MOV byte ptr [ESI + 0x70],DL
0055613c : JMP 0x00556140
0055613e : FLD1
00556140 : MOVZX EAX,byte ptr [ESI + 0x70]
00556144 : FSTP float ptr [ESI + 0x6c]
00556147 : SHR EAX,0x3
0055614a : AND EAX,0x3
0055614d : ADD EAX,EBX
0055614f : CMP dword ptr [ESI + 0x10],ECX
00556152 : JZ 0x00556157
00556154 : ADD dword ptr [ESI + 0xc],EBX
00556157 : ADD dword ptr [ESI + 0xc],EAX
0055615a : MOV dword ptr [ESI + 0x10],ECX
0055615d : TEST byte ptr [ESI + 0x70],0x1
00556161 : JZ 0x00556196
00556163 : CMP ECX,ECX
00556165 : JZ 0x0055616a
00556167 : ADD dword ptr [ESI + 0xc],EBX
0055616a : MOV EAX,dword ptr [ESI + 0xc]
0055616d : MOV EDX,dword ptr [ESI + 0x4]
00556170 : ADD EDX,EAX
00556172 : MOV dword ptr [ESI + 0x10],ECX
00556175 : MOVZX DI,byte ptr [EDX + 0x1]
0055617a : MOVZX DX,byte ptr [EDX]
0055617e : SHL DI,0x8
00556182 : OR DI,DX
00556185 : MOVZX EDX,DI
00556188 : ADD EAX,0x2
0055618b : MOV dword ptr [ESI + 0xc],EAX
0055618e : MOVZX EAX,DX
00556191 : MOV dword ptr [ESI + 0x3c],EAX
00556194 : JMP 0x00556199
00556196 : MOV dword ptr [ESI + 0x3c],ECX
00556199 : TEST byte ptr [ESI + 0x70],0x2
0055619d : JZ 0x005561d3
0055619f : CMP dword ptr [ESI + 0x10],ECX
005561a2 : JZ 0x005561a7
005561a4 : ADD dword ptr [ESI + 0xc],EBX
005561a7 : MOV EAX,dword ptr [ESI + 0xc]
005561aa : MOV EDX,dword ptr [ESI + 0x4]
005561ad : ADD EDX,EAX
005561af : MOV dword ptr [ESI + 0x10],ECX
005561b2 : MOVZX DI,byte ptr [EDX + 0x1]
005561b7 : MOVZX DX,byte ptr [EDX]
005561bb : SHL DI,0x8
005561bf : OR DI,DX
005561c2 : MOVZX EDX,DI
005561c5 : ADD EAX,0x2
005561c8 : MOV dword ptr [ESI + 0xc],EAX
005561cb : MOVZX EAX,DX
005561ce : MOV dword ptr [ESI + 0x40],EAX
005561d1 : JMP 0x005561d6
005561d3 : MOV dword ptr [ESI + 0x40],ECX
005561d6 : MOV dword ptr [ESI + 0x38],ECX
005561d9 : MOV dword ptr [ESI + 0x34],ECX
005561dc : MOV EAX,dword ptr [ESI + 0x10]
005561df : MOV EBX,0x6
005561e4 : CMP EAX,0x7
005561e7 : JA 0x005562ed
005561ed : JMP dword ptr [EAX*0x4 + 0x556480]
005561f4 : MOV EDX,dword ptr [ESI + 0xc]
005561f7 : MOV EAX,dword ptr [ESI + 0x4]
005561fa : MOVZX EAX,byte ptr [EDX + EAX*0x1]
005561fe : SHR EAX,0x4
00556201 : MOV dword ptr [ESI + 0x10],0x4
00556208 : JMP 0x005562ef
0055620d : MOV EDX,dword ptr [ESI + 0xc]
00556210 : MOV EAX,dword ptr [ESI + 0x4]
00556213 : MOVZX EAX,byte ptr [EDX + EAX*0x1]
00556217 : SHR EAX,0x3
0055621a : AND EAX,0xf
0055621d : MOV dword ptr [ESI + 0x10],0x5
00556224 : JMP 0x005562ef
00556229 : MOV EDX,dword ptr [ESI + 0xc]
0055622c : MOV EAX,dword ptr [ESI + 0x4]
0055622f : MOVZX EAX,byte ptr [EDX + EAX*0x1]
00556233 : SHR EAX,0x2
00556236 : AND EAX,0xf
00556239 : MOV dword ptr [ESI + 0x10],EBX
0055623c : JMP 0x005562ef
00556241 : MOV EDX,dword ptr [ESI + 0xc]
00556244 : MOV EAX,dword ptr [ESI + 0x4]
00556247 : MOVZX EAX,byte ptr [EDX + EAX*0x1]
0055624b : SHR EAX,0x1
0055624d : AND EAX,0xf
00556250 : MOV dword ptr [ESI + 0x10],0x7
00556257 : JMP 0x005562ef
0055625c : MOV EDX,dword ptr [ESI + 0xc]
0055625f : MOV EAX,dword ptr [ESI + 0x4]
00556262 : MOVZX EAX,byte ptr [EDX + EAX*0x1]
00556266 : AND EAX,0xf
00556269 : INC EDX
0055626a : MOV dword ptr [ESI + 0x10],ECX
0055626d : MOV dword ptr [ESI + 0xc],EDX
00556270 : JMP 0x005562ef
00556272 : MOV EDX,dword ptr [ESI + 0xc]
00556275 : MOV EAX,dword ptr [ESI + 0x4]
00556278 : LEA EDI,[EDX + EAX*0x1]
0055627b : MOVZX EAX,byte ptr [EDI + 0x1]
0055627f : MOVZX EDI,byte ptr [EDI]
00556282 : AND EDI,0x7
00556285 : SHR EAX,0x7
00556288 : ADD EDI,EDI
0055628a : OR EAX,EDI
0055628c : INC EDX
0055628d : MOV dword ptr [ESI + 0x10],0x1
00556294 : MOV dword ptr [ESI + 0xc],EDX
00556297 : JMP 0x005562ef
00556299 : MOV EDX,dword ptr [ESI + 0xc]
0055629c : MOV EAX,dword ptr [ESI + 0x4]
0055629f : LEA EDI,[EDX + EAX*0x1]
005562a2 : MOVZX EAX,byte ptr [EDI + 0x1]
005562a6 : MOVZX EDI,byte ptr [EDI]
005562a9 : AND EDI,0x3
005562ac : ADD EDI,EDI
005562ae : SHR EAX,0x6
005562b1 : ADD EDI,EDI
005562b3 : OR EAX,EDI
005562b5 : INC EDX
005562b6 : MOV dword ptr [ESI + 0x10],0x2
005562bd : MOV dword ptr [ESI + 0xc],EDX
005562c0 : JMP 0x005562ef
005562c2 : MOV EDX,dword ptr [ESI + 0xc]
005562c5 : MOV EAX,dword ptr [ESI + 0x4]
005562c8 : LEA EDI,[EDX + EAX*0x1]
005562cb : MOVZX EAX,byte ptr [EDI + 0x1]
005562cf : MOVZX EDI,byte ptr [EDI]
005562d2 : AND EDI,0x1
005562d5 : ADD EDI,EDI
005562d7 : ADD EDI,EDI
005562d9 : SHR EAX,0x5
005562dc : ADD EDI,EDI
005562de : OR EAX,EDI
005562e0 : INC EDX
005562e1 : MOV dword ptr [ESI + 0x10],0x3
005562e8 : MOV dword ptr [ESI + 0xc],EDX
005562eb : JMP 0x005562ef
005562ed : XOR EAX,EAX
005562ef : MOV dword ptr [ESI + 0x44],EAX
005562f2 : MOV EAX,dword ptr [ESI + 0x10]
005562f5 : CMP EAX,0x7
005562f8 : JA 0x005563fe
005562fe : JMP dword ptr [EAX*0x4 + 0x5564a0]
00556305 : MOV EDX,dword ptr [ESI + 0xc]
00556308 : MOV EAX,dword ptr [ESI + 0x4]
0055630b : MOVZX EAX,byte ptr [EDX + EAX*0x1]
0055630f : SHR EAX,0x4
00556312 : MOV dword ptr [ESI + 0x10],0x4
00556319 : JMP 0x00556400
0055631e : MOV EDX,dword ptr [ESI + 0xc]
00556321 : MOV EAX,dword ptr [ESI + 0x4]
00556324 : MOVZX EAX,byte ptr [EDX + EAX*0x1]
00556328 : SHR EAX,0x3
0055632b : AND EAX,0xf
0055632e : MOV dword ptr [ESI + 0x10],0x5
00556335 : JMP 0x00556400
0055633a : MOV EDX,dword ptr [ESI + 0xc]
0055633d : MOV EAX,dword ptr [ESI + 0x4]
00556340 : MOVZX EAX,byte ptr [EDX + EAX*0x1]
00556344 : SHR EAX,0x2
00556347 : AND EAX,0xf
0055634a : MOV dword ptr [ESI + 0x10],EBX
0055634d : JMP 0x00556400
00556352 : MOV EDX,dword ptr [ESI + 0xc]
00556355 : MOV EAX,dword ptr [ESI + 0x4]
00556358 : MOVZX EAX,byte ptr [EDX + EAX*0x1]
0055635c : SHR EAX,0x1
0055635e : AND EAX,0xf
00556361 : MOV dword ptr [ESI + 0x10],0x7
00556368 : JMP 0x00556400
0055636d : MOV EDX,dword ptr [ESI + 0xc]
00556370 : MOV EAX,dword ptr [ESI + 0x4]
00556373 : MOVZX EAX,byte ptr [EDX + EAX*0x1]
00556377 : AND EAX,0xf
0055637a : INC EDX
0055637b : MOV dword ptr [ESI + 0x10],ECX
0055637e : MOV dword ptr [ESI + 0xc],EDX
00556381 : JMP 0x00556400
00556383 : MOV EDX,dword ptr [ESI + 0xc]
00556386 : MOV EAX,dword ptr [ESI + 0x4]
00556389 : LEA EDI,[EDX + EAX*0x1]
0055638c : MOVZX EAX,byte ptr [EDI + 0x1]
00556390 : MOVZX EDI,byte ptr [EDI]
00556393 : AND EDI,0x7
00556396 : SHR EAX,0x7
00556399 : ADD EDI,EDI
0055639b : OR EAX,EDI
0055639d : INC EDX
0055639e : MOV dword ptr [ESI + 0x10],0x1
005563a5 : MOV dword ptr [ESI + 0xc],EDX
005563a8 : JMP 0x00556400
005563aa : MOV EDX,dword ptr [ESI + 0xc]
005563ad : MOV EAX,dword ptr [ESI + 0x4]
005563b0 : LEA EDI,[EDX + EAX*0x1]
005563b3 : MOVZX EAX,byte ptr [EDI + 0x1]
005563b7 : MOVZX EDI,byte ptr [EDI]
005563ba : AND EDI,0x3
005563bd : ADD EDI,EDI
005563bf : SHR EAX,0x6
005563c2 : ADD EDI,EDI
005563c4 : OR EAX,EDI
005563c6 : INC EDX
005563c7 : MOV dword ptr [ESI + 0x10],0x2
005563ce : MOV dword ptr [ESI + 0xc],EDX
005563d1 : JMP 0x00556400
005563d3 : MOV EDX,dword ptr [ESI + 0xc]
005563d6 : MOV EAX,dword ptr [ESI + 0x4]
005563d9 : LEA EDI,[EDX + EAX*0x1]
005563dc : MOVZX EAX,byte ptr [EDI + 0x1]
005563e0 : MOVZX EDI,byte ptr [EDI]
005563e3 : AND EDI,0x1
005563e6 : ADD EDI,EDI
005563e8 : ADD EDI,EDI
005563ea : SHR EAX,0x5
005563ed : ADD EDI,EDI
005563ef : OR EAX,EDI
005563f1 : INC EDX
005563f2 : MOV dword ptr [ESI + 0x10],0x3
005563f9 : MOV dword ptr [ESI + 0xc],EDX
005563fc : JMP 0x00556400
005563fe : XOR EAX,EAX
00556400 : CMP byte ptr [ESI + 0x20],0x1
00556404 : MOV dword ptr [ESI + 0x48],EAX
00556407 : MOV dword ptr [ESI + 0x30],ECX
0055640a : MOV dword ptr [ESI + 0x2c],ECX
0055640d : MOV dword ptr [ESI + 0x4c],ECX
00556410 : MOV dword ptr [ESI + 0x50],ECX
00556413 : MOV dword ptr [ESI + 0x1c],ECX
00556416 : MOV dword ptr [ESI + 0x18],ECX
00556419 : MOV dword ptr [ESI + 0x14],ECX
0055641c : MOV dword ptr [ESI + 0x28],ECX
0055641f : MOV dword ptr [ESI + 0x24],ECX
00556422 : POP EBX
00556423 : JZ 0x00556478
00556425 : MOV ECX,ESI
00556427 : CALL 0x00553740
0055642c : CMP byte ptr [ESI + 0x20],0x3
00556430 : JNZ 0x00556478
00556432 : CMP byte ptr [ESI + 0x20],0x1
00556436 : JNZ 0x00556425
00556438 : POP EDI
00556439 : MOV EAX,ESI
0055643b : POP ESI
0055643c : RET 0x4
0055643f : FLD1
00556441 : MOV byte ptr [ESI + 0x20],0x1
00556445 : FSTP float ptr [ESI + 0x6c]
00556448 : MOV byte ptr [ESI + 0x70],CL
0055644b : MOV dword ptr [ESI + 0x40],ECX
0055644e : MOV dword ptr [ESI + 0x3c],ECX
00556451 : MOV dword ptr [ESI + 0x38],ECX
00556454 : MOV dword ptr [ESI + 0x34],ECX
00556457 : MOV dword ptr [ESI + 0x48],ECX
0055645a : MOV dword ptr [ESI + 0x44],ECX
0055645d : MOV dword ptr [ESI + 0x30],ECX
00556460 : MOV dword ptr [ESI + 0x2c],ECX
00556463 : MOV dword ptr [ESI + 0x4c],ECX
00556466 : MOV dword ptr [ESI + 0x50],ECX
00556469 : MOV dword ptr [ESI + 0x1c],ECX
0055646c : MOV dword ptr [ESI + 0x18],ECX
0055646f : MOV dword ptr [ESI + 0x14],ECX
00556472 : MOV dword ptr [ESI + 0x28],ECX
00556475 : MOV dword ptr [ESI + 0x24],ECX
00556478 : POP EDI
00556479 : MOV EAX,ESI
0055647b : POP ESI
0055647c : RET 0x4

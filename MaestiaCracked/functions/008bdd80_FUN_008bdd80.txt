PROGRAM  : Maestia.exe
FUNCTION : FUN_008bdd80
ENTRY    : 008bdd80
BODY     : [[008bdd80, 008be311]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008bdd80(int param_1)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  int *unaff_ESI;
  undefined1 local_f8 [28];
  undefined1 local_dc [28];
  undefined1 local_c0 [28];
  undefined1 local_a4 [28];
  undefined1 local_88 [28];
  undefined1 local_6c [28];
  undefined1 local_50 [28];
  undefined1 local_34 [28];
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b44f32;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if (((char)unaff_ESI[2] != '\0') && (iVar4 = *(int *)(unaff_ESI[1] + 0x128), iVar4 != 0)) {
    iVar1 = (**(code **)(*unaff_ESI + 0x74))(param_1,0,DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
    if (*(int *)(iVar4 + 0x40) == -1) {
      if (iVar1 == 0) {
        ExceptionList = local_10;
        return;
      }
      FUN_0097fb30(iVar1,param_1,0);
      ExceptionList = local_10;
      return;
    }
    iVar1 = FUN_008eb580();
    if (iVar1 == 0) {
      ExceptionList = local_10;
      return;
    }
    local_18 = (uint)*(ushort *)(iVar4 + 0x44);
    local_14 = (uint)*(ushort *)(iVar4 + 0x46);
    piVar2 = (int *)FUN_008eb580();
    piVar2 = (int *)(**(code **)(*piVar2 + 0x74))(local_18,local_14);
    if (param_1 == -1) {
      if (piVar2 == (int *)0x0) {
        ExceptionList = local_10;
        return;
      }
      iVar1 = (**(code **)(*unaff_ESI + 0x74))(1,0);
      iVar3 = (**(code **)(*unaff_ESI + 0x74))(2,0);
      if (iVar1 == 0) {
        if (iVar3 == 0) {
          param_1 = ((short)piVar2[0x2b] == 0) + 1;
        }
        else {
          if (*(ushort *)(piVar2 + 0x2b) <= *(ushort *)(iVar3 + 0xac)) {
            FUN_00406460(L"IDS_ENCHANT_TRANS_NOT_MATCH_ITEM");
            local_8 = 3;
            iVar4 = FUN_0081d120(local_a4);
            local_8._0_1_ = 4;
            if (*(uint *)(iVar4 + 0x18) < 8) {
              iVar4 = iVar4 + 4;
            }
            else {
              iVar4 = *(int *)(iVar4 + 4);
            }
            FUN_00406460(iVar4);
            local_8._0_1_ = 5;
            (**(code **)(**(int **)(*DAT_00da9894 + 0x1a8) + 0x44))(local_c0,3);
            local_8._0_1_ = 4;
            FUN_00406560();
            local_8 = CONCAT31(local_8._1_3_,3);
            FUN_00406560();
            goto LAB_008bdf04;
          }
          param_1 = 1;
        }
      }
      else {
        if (iVar3 != 0) goto LAB_008be2ce;
        if (*(ushort *)(iVar1 + 0xac) <= *(ushort *)(piVar2 + 0x2b)) {
          FUN_00406460(L"IDS_ENCHANT_TRANS_NOT_MATCH_ITEM");
          local_8 = 0;
          iVar4 = FUN_0081d120(local_6c);
          local_8._0_1_ = 1;
          if (*(uint *)(iVar4 + 0x18) < 8) {
            iVar4 = iVar4 + 4;
          }
          else {
            iVar4 = *(int *)(iVar4 + 4);
          }
          FUN_00406460(iVar4);
          local_8._0_1_ = 2;
          (**(code **)(**(int **)(*DAT_00da9894 + 0x1a8) + 0x44))(local_f8,3);
          local_8._0_1_ = 1;
          FUN_00406560();
          local_8 = (uint)local_8._1_3_ << 8;
          FUN_00406560();
LAB_008bdf04:
          local_8 = 0xffffffff;
          FUN_00406560();
          FUN_008a1050(0xca);
          ExceptionList = local_10;
          return;
        }
        param_1 = 2;
      }
    }
    if ((((char)((uint)piVar2[4] >> 0x10) == 't') && (iVar1 = FUN_004049b0(piVar2[4]), iVar1 != 0))
       && (*(short *)(iVar1 + 0x180) != 0xd)) {
      (**(code **)(*piVar2 + 0xb4))();
      FUN_0097fa60();
      ExceptionList = local_10;
      return;
    }
    if (*(int *)(iVar4 + 0x4c) == 0) {
      uVar5 = 0;
    }
    else {
      uVar5 = *(undefined4 *)(*(int *)(iVar4 + 0x4c) + 0x10);
    }
    piVar2 = (int *)FUN_004049b0(uVar5);
    if (piVar2 != (int *)0x0) {
      if (param_1 == 1) {
        iVar1 = (**(code **)(*unaff_ESI + 0x74))(2,0);
        if (((iVar1 != 0) && (iVar1 = FUN_004049b0(*(undefined4 *)(iVar1 + 0x10)), iVar1 != 0)) &&
           (*(int *)(iVar1 + 0x9c) != piVar2[0x27])) {
          FUN_0097fa60();
          FUN_00406460(L"IDS_ITEM_ENCHANT_HALIDOM_DIFFERENT_CATEGORY");
          local_8 = 6;
          iVar4 = FUN_0081d120(local_dc);
          local_8._0_1_ = 7;
          if (*(uint *)(iVar4 + 0x18) < 8) {
            iVar4 = iVar4 + 4;
          }
          else {
            iVar4 = *(int *)(iVar4 + 4);
          }
          FUN_00406460(iVar4);
          local_8._0_1_ = 8;
          (**(code **)(**(int **)(*DAT_00da9894 + 0x1a8) + 0x44))(local_34,3);
          local_8._0_1_ = 7;
          FUN_00406560();
          local_8 = CONCAT31(local_8._1_3_,6);
          FUN_00406560();
          local_8 = 0xffffffff;
          FUN_00406560();
          ExceptionList = local_10;
          return;
        }
      }
      else if (((param_1 == 2) && (iVar1 = (**(code **)(*unaff_ESI + 0x74))(1,0), iVar1 != 0)) &&
              ((iVar1 = FUN_004049b0(*(undefined4 *)(iVar1 + 0x10)), iVar1 != 0 &&
               (*(int *)(iVar1 + 0x9c) != piVar2[0x27])))) {
        FUN_0097fa60();
        FUN_00406460(L"IDS_ITEM_ENCHANT_HALIDOM_DIFFERENT_CATEGORY");
        local_8 = 9;
        iVar4 = FUN_0081d120(local_88);
        local_8._0_1_ = 10;
        if (*(uint *)(iVar4 + 0x18) < 8) {
          iVar4 = iVar4 + 4;
        }
        else {
          iVar4 = *(int *)(iVar4 + 4);
        }
        FUN_00406460(iVar4);
        local_8._0_1_ = 0xb;
        (**(code **)(**(int **)(*DAT_00da9894 + 0x1a8) + 0x44))(local_50,3);
        local_8._0_1_ = 10;
        FUN_00406560();
        local_8 = CONCAT31(local_8._1_3_,9);
        FUN_00406560();
        local_8 = 0xffffffff;
        FUN_00406560();
        ExceptionList = local_10;
        return;
      }
      iVar1 = (**(code **)(*piVar2 + 0x3c))();
      if (iVar1 != 0) {
        FUN_008efa90(*(undefined4 *)(iVar4 + 0x40),local_18,local_14,0x98,param_1,0);
        FUN_0097fa60();
        ExceptionList = local_10;
        return;
      }
      FUN_008ef980(*(undefined4 *)(iVar4 + 0x40),local_18,local_14,0x98,param_1,0,1);
LAB_008be2ce:
      FUN_0097fa60();
      ExceptionList = local_10;
      return;
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
008bdd80 : PUSH EBP
008bdd81 : MOV EBP,ESP
008bdd83 : PUSH -0x1
008bdd85 : PUSH 0xb44f32
008bdd8a : MOV EAX,FS:[0x0]
008bdd90 : PUSH EAX
008bdd91 : SUB ESP,0x15c
008bdd97 : PUSH EBX
008bdd98 : PUSH EDI
008bdd99 : MOV EAX,[0x00d66fa0]
008bdd9e : XOR EAX,EBP
008bdda0 : PUSH EAX
008bdda1 : LEA EAX,[EBP + -0xc]
008bdda4 : MOV FS:[0x0],EAX
008bddaa : MOV AL,byte ptr [ESI + 0x8]
008bddad : TEST AL,AL
008bddaf : JZ 0x008be2ff
008bddb5 : MOV EAX,dword ptr [ESI + 0x4]
008bddb8 : MOV EBX,dword ptr [EAX + 0x128]
008bddbe : TEST EBX,EBX
008bddc0 : JZ 0x008be2ff
008bddc6 : MOV EDX,dword ptr [ESI]
008bddc8 : MOV EAX,dword ptr [EBP + 0x8]
008bddcb : MOV EDX,dword ptr [EDX + 0x74]
008bddce : PUSH 0x0
008bddd0 : PUSH EAX
008bddd1 : MOV ECX,ESI
008bddd3 : CALL EDX
008bddd5 : MOV EDI,dword ptr [EBX + 0x40]
008bddd8 : CMP EDI,-0x1
008bdddb : JZ 0x008be2e8
008bdde1 : MOV EAX,dword ptr [ESI + 0x4]
008bdde4 : CALL 0x008eb580
008bdde9 : TEST EAX,EAX
008bddeb : JZ 0x008be2ff
008bddf1 : MOVZX EAX,word ptr [EBX + 0x44]
008bddf5 : MOVZX ECX,word ptr [EBX + 0x46]
008bddf9 : MOV dword ptr [EBP + -0x14],EAX
008bddfc : MOV EAX,dword ptr [ESI + 0x4]
008bddff : MOV dword ptr [EBP + -0x10],ECX
008bde02 : CALL 0x008eb580
008bde07 : MOV ECX,dword ptr [EBP + -0x10]
008bde0a : MOV EDX,dword ptr [EAX]
008bde0c : MOV EDX,dword ptr [EDX + 0x74]
008bde0f : PUSH ECX
008bde10 : MOV ECX,dword ptr [EBP + -0x14]
008bde13 : PUSH ECX
008bde14 : MOV ECX,EAX
008bde16 : CALL EDX
008bde18 : CMP dword ptr [EBP + 0x8],-0x1
008bde1c : MOV EDI,EAX
008bde1e : JNZ 0x008be012
008bde24 : TEST EDI,EDI
008bde26 : JZ 0x008be2ff
008bde2c : MOV EAX,dword ptr [ESI]
008bde2e : MOV EDX,dword ptr [EAX + 0x74]
008bde31 : PUSH 0x0
008bde33 : PUSH 0x1
008bde35 : MOV ECX,ESI
008bde37 : CALL EDX
008bde39 : MOV dword ptr [EBP + 0x8],EAX
008bde3c : MOV EAX,dword ptr [ESI]
008bde3e : MOV EDX,dword ptr [EAX + 0x74]
008bde41 : PUSH 0x0
008bde43 : PUSH 0x2
008bde45 : MOV ECX,ESI
008bde47 : CALL EDX
008bde49 : MOV ECX,dword ptr [EBP + 0x8]
008bde4c : TEST ECX,ECX
008bde4e : JZ 0x008bdf38
008bde54 : TEST EAX,EAX
008bde56 : JNZ 0x008be2ce
008bde5c : MOVZX EAX,word ptr [ECX + 0xac]
008bde63 : MOVZX ECX,word ptr [EDI + 0xac]
008bde6a : CMP AX,CX
008bde6d : JA 0x008bdf2c
008bde73 : PUSH 0xc4dd38
008bde78 : LEA ECX,[EBP + -0x68]
008bde7b : CALL 0x00406460
008bde80 : MOV dword ptr [EBP + -0x4],0x0
008bde87 : MOV ECX,dword ptr [0x0172491c]
008bde8d : LEA EAX,[EBP + -0x68]
008bde90 : PUSH EAX
008bde91 : LEA EDI,[EBP + 0xfffffef0]
008bde97 : CALL 0x0081d120
008bde9c : MOV byte ptr [EBP + -0x4],0x1
008bdea0 : CMP dword ptr [EAX + 0x18],0x8
008bdea4 : JC 0x008bdeab
008bdea6 : MOV EAX,dword ptr [EAX + 0x4]
008bdea9 : JMP 0x008bdeae
008bdeab : ADD EAX,0x4
008bdeae : PUSH EAX
008bdeaf : LEA ECX,[EBP + 0xffffff0c]
008bdeb5 : CALL 0x00406460
008bdeba : MOV byte ptr [EBP + -0x4],0x2
008bdebe : MOV ECX,dword ptr [0x00da9894]
008bdec4 : MOV EAX,dword ptr [ECX]
008bdec6 : MOV ECX,dword ptr [EAX + 0x1a8]
008bdecc : MOV EDX,dword ptr [ECX]
008bdece : MOV EDX,dword ptr [EDX + 0x44]
008bded1 : PUSH 0x3
008bded3 : LEA EAX,[EBP + 0xffffff0c]
008bded9 : PUSH EAX
008bdeda : CALL EDX
008bdedc : MOV byte ptr [EBP + -0x4],0x1
008bdee0 : LEA ECX,[EBP + 0xffffff0c]
008bdee6 : CALL 0x00406560
008bdeeb : MOV byte ptr [EBP + -0x4],0x0
008bdeef : LEA ECX,[EBP + 0xfffffef0]
008bdef5 : CALL 0x00406560
008bdefa : MOV dword ptr [EBP + -0x4],0xffffffff
008bdf01 : LEA ECX,[EBP + -0x68]
008bdf04 : CALL 0x00406560
008bdf09 : MOV ECX,dword ptr [0x017248dc]
008bdf0f : PUSH 0xca
008bdf14 : CALL 0x008a1050
008bdf19 : MOV ECX,dword ptr [EBP + -0xc]
008bdf1c : MOV dword ptr FS:[0x0],ECX
008bdf23 : POP ECX
008bdf24 : POP EDI
008bdf25 : POP EBX
008bdf26 : MOV ESP,EBP
008bdf28 : POP EBP
008bdf29 : RET 0x4
008bdf2c : MOV dword ptr [EBP + 0x8],0x2
008bdf33 : JMP 0x008be012
008bdf38 : TEST EAX,EAX
008bdf3a : JZ 0x008bdfff
008bdf40 : MOVZX EAX,word ptr [EAX + 0xac]
008bdf47 : MOVZX ECX,word ptr [EDI + 0xac]
008bdf4e : CMP AX,CX
008bdf51 : JC 0x008bdff6
008bdf57 : PUSH 0xc4dd80
008bdf5c : LEA ECX,[EBP + 0xffffff60]
008bdf62 : CALL 0x00406460
008bdf67 : MOV dword ptr [EBP + -0x4],0x3
008bdf6e : MOV ECX,dword ptr [0x0172491c]
008bdf74 : LEA EAX,[EBP + 0xffffff60]
008bdf7a : PUSH EAX
008bdf7b : LEA EDI,[EBP + 0xfffffeb8]
008bdf81 : CALL 0x0081d120
008bdf86 : MOV BL,0x4
008bdf88 : MOV byte ptr [EBP + -0x4],BL
008bdf8b : CMP dword ptr [EAX + 0x18],0x8
008bdf8f : JC 0x008bdf96
008bdf91 : MOV EAX,dword ptr [EAX + 0x4]
008bdf94 : JMP 0x008bdf99
008bdf96 : ADD EAX,0x4
008bdf99 : PUSH EAX
008bdf9a : LEA ECX,[EBP + 0xffffff44]
008bdfa0 : CALL 0x00406460
008bdfa5 : MOV byte ptr [EBP + -0x4],0x5
008bdfa9 : MOV ECX,dword ptr [0x00da9894]
008bdfaf : MOV EAX,dword ptr [ECX]
008bdfb1 : MOV ECX,dword ptr [EAX + 0x1a8]
008bdfb7 : MOV EDX,dword ptr [ECX]
008bdfb9 : MOV EDX,dword ptr [EDX + 0x44]
008bdfbc : PUSH 0x3
008bdfbe : LEA EAX,[EBP + 0xffffff44]
008bdfc4 : PUSH EAX
008bdfc5 : CALL EDX
008bdfc7 : MOV byte ptr [EBP + -0x4],BL
008bdfca : LEA ECX,[EBP + 0xffffff44]
008bdfd0 : CALL 0x00406560
008bdfd5 : MOV byte ptr [EBP + -0x4],0x3
008bdfd9 : LEA ECX,[EBP + 0xfffffeb8]
008bdfdf : CALL 0x00406560
008bdfe4 : MOV dword ptr [EBP + -0x4],0xffffffff
008bdfeb : LEA ECX,[EBP + 0xffffff60]
008bdff1 : JMP 0x008bdf04
008bdff6 : MOV dword ptr [EBP + 0x8],0x1
008bdffd : JMP 0x008be012
008bdfff : MOVZX EAX,word ptr [EDI + 0xac]
008be006 : XOR ECX,ECX
008be008 : TEST AX,AX
008be00b : SETZ CL
008be00e : INC ECX
008be00f : MOV dword ptr [EBP + 0x8],ECX
008be012 : MOV EAX,dword ptr [EDI + 0x10]
008be015 : MOV EDX,EAX
008be017 : SHR EDX,0x10
008be01a : CMP DL,0x74
008be01d : JNZ 0x008be05c
008be01f : PUSH EAX
008be020 : CALL 0x004049b0
008be025 : ADD ESP,0x4
008be028 : TEST EAX,EAX
008be02a : JZ 0x008be05c
008be02c : CMP word ptr [EAX + 0x180],0xd
008be034 : JZ 0x008be05c
008be036 : MOV EAX,dword ptr [EDI]
008be038 : MOV EDX,dword ptr [EAX + 0xb4]
008be03e : MOV ECX,EDI
008be040 : CALL EDX
008be042 : MOV ECX,EBX
008be044 : CALL 0x0097fa60
008be049 : MOV ECX,dword ptr [EBP + -0xc]
008be04c : MOV dword ptr FS:[0x0],ECX
008be053 : POP ECX
008be054 : POP EDI
008be055 : POP EBX
008be056 : MOV ESP,EBP
008be058 : POP EBP
008be059 : RET 0x4
008be05c : MOV EAX,dword ptr [EBX + 0x4c]
008be05f : TEST EAX,EAX
008be061 : JZ 0x008be068
008be063 : MOV EAX,dword ptr [EAX + 0x10]
008be066 : JMP 0x008be06a
008be068 : XOR EAX,EAX
008be06a : PUSH EAX
008be06b : CALL 0x004049b0
008be070 : MOV EDI,EAX
008be072 : ADD ESP,0x4
008be075 : TEST EDI,EDI
008be077 : JZ 0x008be2ff
008be07d : MOV EAX,dword ptr [EBP + 0x8]
008be080 : CMP EAX,0x1
008be083 : JNZ 0x008be174
008be089 : MOV EAX,dword ptr [ESI]
008be08b : MOV EDX,dword ptr [EAX + 0x74]
008be08e : PUSH 0x0
008be090 : PUSH 0x2
008be092 : MOV ECX,ESI
008be094 : CALL EDX
008be096 : TEST EAX,EAX
008be098 : JZ 0x008be267
008be09e : MOV EAX,dword ptr [EAX + 0x10]
008be0a1 : PUSH EAX
008be0a2 : CALL 0x004049b0
008be0a7 : ADD ESP,0x4
008be0aa : TEST EAX,EAX
008be0ac : JZ 0x008be267
008be0b2 : MOV EAX,dword ptr [EAX + 0x9c]
008be0b8 : CMP EAX,dword ptr [EDI + 0x9c]
008be0be : JZ 0x008be267
008be0c4 : MOV ECX,EBX
008be0c6 : CALL 0x0097fa60
008be0cb : PUSH 0xc4ddc8
008be0d0 : LEA ECX,[EBP + 0xffffff28]
008be0d6 : CALL 0x00406460
008be0db : MOV dword ptr [EBP + -0x4],0x6
008be0e2 : LEA ECX,[EBP + 0xffffff28]
008be0e8 : PUSH ECX
008be0e9 : MOV ECX,dword ptr [0x0172491c]
008be0ef : LEA EDI,[EBP + 0xfffffed4]
008be0f5 : CALL 0x0081d120
008be0fa : MOV BL,0x7
008be0fc : MOV byte ptr [EBP + -0x4],BL
008be0ff : CMP dword ptr [EAX + 0x18],0x8
008be103 : JC 0x008be10a
008be105 : MOV EAX,dword ptr [EAX + 0x4]
008be108 : JMP 0x008be10d
008be10a : ADD EAX,0x4
008be10d : PUSH EAX
008be10e : LEA ECX,[EBP + -0x30]
008be111 : CALL 0x00406460
008be116 : MOV byte ptr [EBP + -0x4],0x8
008be11a : MOV EDX,dword ptr [0x00da9894]
008be120 : MOV EAX,dword ptr [EDX]
008be122 : MOV ECX,dword ptr [EAX + 0x1a8]
008be128 : MOV EAX,dword ptr [ECX]
008be12a : MOV EAX,dword ptr [EAX + 0x44]
008be12d : PUSH 0x3
008be12f : LEA EDX,[EBP + -0x30]
008be132 : PUSH EDX
008be133 : CALL EAX
008be135 : MOV byte ptr [EBP + -0x4],BL
008be138 : LEA ECX,[EBP + -0x30]
008be13b : CALL 0x00406560
008be140 : MOV byte ptr [EBP + -0x4],0x6
008be144 : LEA ECX,[EBP + 0xfffffed4]
008be14a : CALL 0x00406560
008be14f : MOV dword ptr [EBP + -0x4],0xffffffff
008be156 : LEA ECX,[EBP + 0xffffff28]
008be15c : CALL 0x00406560
008be161 : MOV ECX,dword ptr [EBP + -0xc]
008be164 : MOV dword ptr FS:[0x0],ECX
008be16b : POP ECX
008be16c : POP EDI
008be16d : POP EBX
008be16e : MOV ESP,EBP
008be170 : POP EBP
008be171 : RET 0x4
008be174 : CMP EAX,0x2
008be177 : JNZ 0x008be267
008be17d : MOV EDX,dword ptr [ESI]
008be17f : MOV EAX,dword ptr [EDX + 0x74]
008be182 : PUSH 0x0
008be184 : PUSH 0x1
008be186 : MOV ECX,ESI
008be188 : CALL EAX
008be18a : TEST EAX,EAX
008be18c : JZ 0x008be267
008be192 : MOV EAX,dword ptr [EAX + 0x10]
008be195 : PUSH EAX
008be196 : CALL 0x004049b0
008be19b : ADD ESP,0x4
008be19e : TEST EAX,EAX
008be1a0 : JZ 0x008be267
008be1a6 : MOV ECX,dword ptr [EAX + 0x9c]
008be1ac : CMP ECX,dword ptr [EDI + 0x9c]
008be1b2 : JZ 0x008be267
008be1b8 : MOV ECX,EBX
008be1ba : CALL 0x0097fa60
008be1bf : PUSH 0xc4de20
008be1c4 : LEA ECX,[EBP + 0xffffff7c]
008be1ca : CALL 0x00406460
008be1cf : MOV dword ptr [EBP + -0x4],0x9
008be1d6 : MOV ECX,dword ptr [0x0172491c]
008be1dc : LEA EDX,[EBP + 0xffffff7c]
008be1e2 : PUSH EDX
008be1e3 : LEA EDI,[EBP + 0xfffffe9c]
008be1e9 : CALL 0x0081d120
008be1ee : MOV BL,0xa
008be1f0 : MOV byte ptr [EBP + -0x4],BL
008be1f3 : CMP dword ptr [EAX + 0x18],0x8
008be1f7 : JC 0x008be1fe
008be1f9 : MOV EAX,dword ptr [EAX + 0x4]
008be1fc : JMP 0x008be201
008be1fe : ADD EAX,0x4
008be201 : PUSH EAX
008be202 : LEA ECX,[EBP + -0x4c]
008be205 : CALL 0x00406460
008be20a : MOV byte ptr [EBP + -0x4],0xb
008be20e : MOV EAX,[0x00da9894]
008be213 : MOV EAX,dword ptr [EAX]
008be215 : MOV ECX,dword ptr [EAX + 0x1a8]
008be21b : MOV EDX,dword ptr [ECX]
008be21d : MOV EDX,dword ptr [EDX + 0x44]
008be220 : PUSH 0x3
008be222 : LEA EAX,[EBP + -0x4c]
008be225 : PUSH EAX
008be226 : CALL EDX
008be228 : MOV byte ptr [EBP + -0x4],BL
008be22b : LEA ECX,[EBP + -0x4c]
008be22e : CALL 0x00406560
008be233 : MOV byte ptr [EBP + -0x4],0x9
008be237 : LEA ECX,[EBP + 0xfffffe9c]
008be23d : CALL 0x00406560
008be242 : MOV dword ptr [EBP + -0x4],0xffffffff
008be249 : LEA ECX,[EBP + 0xffffff7c]
008be24f : CALL 0x00406560
008be254 : MOV ECX,dword ptr [EBP + -0xc]
008be257 : MOV dword ptr FS:[0x0],ECX
008be25e : POP ECX
008be25f : POP EDI
008be260 : POP EBX
008be261 : MOV ESP,EBP
008be263 : POP EBP
008be264 : RET 0x4
008be267 : MOV EAX,dword ptr [EDI]
008be269 : MOV EDX,dword ptr [EAX + 0x3c]
008be26c : MOV ECX,EDI
008be26e : CALL EDX
008be270 : TEST EAX,EAX
008be272 : JZ 0x008be2ad
008be274 : MOV EAX,dword ptr [EBP + 0x8]
008be277 : MOV ECX,dword ptr [EBP + -0x10]
008be27a : MOV EDX,dword ptr [EBP + -0x14]
008be27d : PUSH 0x0
008be27f : PUSH EAX
008be280 : MOV EAX,dword ptr [EBX + 0x40]
008be283 : PUSH 0x98
008be288 : PUSH ECX
008be289 : PUSH EDX
008be28a : PUSH EAX
008be28b : CALL 0x008efa90
008be290 : ADD ESP,0x18
008be293 : MOV ECX,EBX
008be295 : CALL 0x0097fa60
008be29a : MOV ECX,dword ptr [EBP + -0xc]
008be29d : MOV dword ptr FS:[0x0],ECX
008be2a4 : POP ECX
008be2a5 : POP EDI
008be2a6 : POP EBX
008be2a7 : MOV ESP,EBP
008be2a9 : POP EBP
008be2aa : RET 0x4
008be2ad : MOV ECX,dword ptr [EBP + 0x8]
008be2b0 : MOV EDX,dword ptr [EBP + -0x10]
008be2b3 : MOV EAX,dword ptr [EBP + -0x14]
008be2b6 : PUSH 0x1
008be2b8 : PUSH 0x0
008be2ba : PUSH ECX
008be2bb : MOV ECX,dword ptr [EBX + 0x40]
008be2be : PUSH 0x98
008be2c3 : PUSH EDX
008be2c4 : PUSH EAX
008be2c5 : PUSH ECX
008be2c6 : CALL 0x008ef980
008be2cb : ADD ESP,0x1c
008be2ce : MOV ECX,EBX
008be2d0 : CALL 0x0097fa60
008be2d5 : MOV ECX,dword ptr [EBP + -0xc]
008be2d8 : MOV dword ptr FS:[0x0],ECX
008be2df : POP ECX
008be2e0 : POP EDI
008be2e1 : POP EBX
008be2e2 : MOV ESP,EBP
008be2e4 : POP EBP
008be2e5 : RET 0x4
008be2e8 : TEST EAX,EAX
008be2ea : JZ 0x008be2ff
008be2ec : MOV EDX,dword ptr [EBP + 0x8]
008be2ef : PUSH 0x0
008be2f1 : PUSH EDX
008be2f2 : PUSH EAX
008be2f3 : MOV EAX,0x98
008be2f8 : MOV ECX,EBX
008be2fa : CALL 0x0097fb30
008be2ff : MOV ECX,dword ptr [EBP + -0xc]
008be302 : MOV dword ptr FS:[0x0],ECX
008be309 : POP ECX
008be30a : POP EDI
008be30b : POP EBX
008be30c : MOV ESP,EBP
008be30e : POP EBP
008be30f : RET 0x4

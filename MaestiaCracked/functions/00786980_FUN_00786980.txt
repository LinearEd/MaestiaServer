PROGRAM  : Maestia.exe
FUNCTION : FUN_00786980
ENTRY    : 00786980
BODY     : [[00786980, 00786a0c] [00786a10, 00786a18] [00786a20, 00786b94]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00786980(int *param_1)

{
  char cVar1;
  undefined2 uVar2;
  int iVar3;
  undefined4 uVar4;
  undefined2 uVar5;
  undefined2 extraout_var;
  int in_ECX;
  ushort uVar6;
  ushort uVar7;
  float fVar8;
  undefined4 **local_84;
  undefined4 **local_80;
  undefined1 local_64 [32];
  LPCRITICAL_SECTION local_44;
  char *local_40;
  undefined4 local_3c;
  int local_38;
  undefined4 local_34;
  undefined1 local_30 [4];
  undefined1 *local_2c;
  float local_28;
  undefined4 **local_24;
  undefined4 **local_20;
  undefined4 **local_1c;
  float local_18;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b31356;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_44 = (LPCRITICAL_SECTION)(in_ECX + 0x150);
  uVar6 = 0;
  local_38 = 0;
  local_40 = ".\\Terrain\\AvaQuadNode.cpp";
  local_3c = 0x7d;
  local_34 = 1;
  local_80 = (undefined4 ***)0x7869d6;
  FUN_006ef1a0();
  local_8 = 0;
  if (*(ushort *)(in_ECX + 0x28) < *(ushort *)(*(int *)(in_ECX + 0x10) + 4)) {
    local_28 = *(float *)(in_ECX + 0x34) * DAT_00d72c24;
    local_18 = local_28 * DAT_00d72c24;
    uVar7 = 0;
    while( true ) {
      fVar8 = local_18;
      if (uVar6 == 0) {
        fVar8 = -local_18;
      }
      local_84 = (undefined4 **)(fVar8 + *(float *)(in_ECX + 0x2c));
      fVar8 = local_18;
      if (uVar7 == 0) {
        fVar8 = -local_18;
      }
      local_2c = (undefined1 *)&local_84;
      local_80 = (undefined4 **)(*(float *)(in_ECX + 0x30) + fVar8);
      local_24 = local_80;
      local_1c = local_84;
      cVar1 = FUN_007853b0();
      if (cVar1 != '\0') break;
      uVar7 = uVar7 + 1;
      if (1 < uVar7) {
        uVar6 = uVar6 + 1;
        if (1 < uVar6) goto LAB_00786a8e;
        uVar7 = 0;
      }
    }
    iVar3 = uVar7 + 6 + (uint)uVar6 * 2;
    if (*(int *)(in_ECX + iVar3 * 4) == 0) {
      local_80 = (undefined4 **)0x90;
      local_84 = (undefined4 **)0xc11268;
      local_2c = (undefined1 *)FUN_006f0760(0x170);
      local_8._0_1_ = 1;
      if (local_2c == (undefined1 *)0x0) {
        uVar4 = 0;
      }
      else {
        local_20 = local_1c;
        local_1c = local_24;
        local_80 = (undefined4 **)local_28;
        local_84 = &local_20;
        uVar4 = FUN_00786680(local_2c,*(undefined4 *)(in_ECX + 0x10),in_ECX);
      }
      local_8 = (uint)local_8._1_3_ << 8;
      *(undefined4 *)(in_ECX + iVar3 * 4) = uVar4;
    }
    local_80 = (undefined4 **)0x786b8d;
    uVar4 = FUN_00786980();
    uVar2 = (undefined2)uVar4;
  }
  else {
LAB_00786a8e:
    iVar3 = (**(code **)(*param_1 + 0x1c))();
    if (iVar3 == 10) {
      param_1[0xc3] = in_ECX;
    }
    local_80 = (undefined4 **)local_64;
    local_84 = (undefined4 **)0x786ab5;
    FUN_0043c130();
    local_8._0_1_ = 2;
    local_80 = (undefined4 **)local_30;
    local_84 = (undefined4 **)(in_ECX + 4);
    FUN_0042f990();
    local_8 = (uint)local_8._1_3_ << 8;
    local_80 = (undefined4 **)0x786ad4;
    uVar4 = FUN_0044cb00();
    uVar2 = *(undefined2 *)(in_ECX + 0x28);
  }
  uVar5 = (undefined2)((uint)uVar4 >> 0x10);
  local_8 = 0xffffffff;
  if (local_38 != 0) {
    local_80 = (undefined4 **)0x786aef;
    LeaveCriticalSection(local_44);
    uVar5 = extraout_var;
  }
  ExceptionList = local_10;
  return CONCAT22(uVar5,uVar2);
}



============================================================
DISASSEMBLY
============================================================
00786980 : PUSH EBP
00786981 : MOV EBP,ESP
00786983 : PUSH -0x1
00786985 : PUSH 0xb31356
0078698a : MOV EAX,FS:[0x0]
00786990 : PUSH EAX
00786991 : SUB ESP,0x58
00786994 : PUSH EBX
00786995 : PUSH ESI
00786996 : PUSH EDI
00786997 : MOV EAX,[0x00d66fa0]
0078699c : XOR EAX,EBP
0078699e : PUSH EAX
0078699f : LEA EAX,[EBP + -0xc]
007869a2 : MOV FS:[0x0],EAX
007869a8 : MOV ESI,ECX
007869aa : LEA ECX,[EBP + -0x40]
007869ad : LEA EAX,[ESI + 0x150]
007869b3 : XOR EBX,EBX
007869b5 : PUSH ECX
007869b6 : MOV dword ptr [EBP + -0x34],EBX
007869b9 : MOV dword ptr [EBP + -0x40],EAX
007869bc : MOV dword ptr [EBP + -0x3c],0xc1124c
007869c3 : MOV dword ptr [EBP + -0x38],0x7d
007869ca : MOV dword ptr [EBP + -0x30],0x1
007869d1 : CALL 0x006ef1a0
007869d6 : MOV dword ptr [EBP + -0x4],EBX
007869d9 : MOV EDX,dword ptr [ESI + 0x10]
007869dc : MOVZX EAX,word ptr [EDX + 0x4]
007869e0 : CMP word ptr [ESI + 0x28],AX
007869e4 : JNC 0x00786a8e
007869ea : MOVSS XMM0,dword ptr [0x00d72c24]
007869f2 : MOVSS XMM1,dword ptr [ESI + 0x34]
007869f7 : MULSS XMM1,XMM0
007869fb : MOVSS dword ptr [EBP + -0x24],XMM1
00786a00 : MULSS XMM1,XMM0
00786a04 : MOVSS dword ptr [EBP + -0x14],XMM1
00786a09 : XOR EDI,EDI
00786a0b : JMP 0x00786a25
00786a10 : MOVSS XMM1,dword ptr [EBP + -0x14]
00786a15 : XOR EDI,EDI
00786a17 : JMP 0x00786a25
00786a20 : MOVSS XMM1,dword ptr [EBP + -0x14]
00786a25 : MOVSS XMM2,dword ptr [0x00cdf0c0]
00786a2d : MOVAPS XMM0,XMM1
00786a30 : TEST BX,BX
00786a33 : JNZ 0x00786a38
00786a35 : XORPS XMM0,XMM2
00786a38 : ADDSS XMM0,dword ptr [ESI + 0x2c]
00786a3d : MOVSS dword ptr [EBP + -0x18],XMM0
00786a42 : TEST DI,DI
00786a45 : JNZ 0x00786a4a
00786a47 : XORPS XMM1,XMM2
00786a4a : MOVSS XMM2,dword ptr [ESI + 0x30]
00786a4f : FLD float ptr [EBP + -0x14]
00786a52 : MOV ECX,dword ptr [EBP + 0x8]
00786a55 : SUB ESP,0xc
00786a58 : MOV EAX,ESP
00786a5a : FSTP float ptr [ESP + 0x8]
00786a5e : ADDSS XMM2,XMM1
00786a62 : MOVSS dword ptr [EBP + -0x20],XMM2
00786a67 : MOV dword ptr [EBP + -0x28],ESP
00786a6a : MOVSS dword ptr [EAX],XMM0
00786a6e : MOVSS dword ptr [EAX + 0x4],XMM2
00786a73 : CALL 0x007853b0
00786a78 : TEST AL,AL
00786a7a : JNZ 0x00786b0d
00786a80 : INC EDI
00786a81 : CMP DI,0x2
00786a85 : JC 0x00786a20
00786a87 : INC EBX
00786a88 : CMP BX,0x2
00786a8c : JC 0x00786a10
00786a8e : MOV EDI,dword ptr [EBP + 0x8]
00786a91 : MOV EDX,dword ptr [EDI]
00786a93 : MOV EAX,dword ptr [EDX + 0x1c]
00786a96 : MOV ECX,EDI
00786a98 : CALL EAX
00786a9a : CMP EAX,0xa
00786a9d : JNZ 0x00786aa5
00786a9f : MOV dword ptr [EDI + 0x30c],ESI
00786aa5 : LEA EDX,[EBP + 0x8]
00786aa8 : PUSH EDX
00786aa9 : LEA EAX,[EBP + -0x60]
00786aac : LEA ECX,[EDI + 0xc]
00786aaf : PUSH EAX
00786ab0 : CALL 0x0043c130
00786ab5 : MOV byte ptr [EBP + -0x4],0x2
00786ab9 : PUSH EAX
00786aba : LEA ECX,[EBP + -0x2c]
00786abd : PUSH ECX
00786abe : LEA EDX,[ESI + 0x4]
00786ac1 : PUSH EDX
00786ac2 : CALL 0x0042f990
00786ac7 : MOV byte ptr [EBP + -0x4],0x0
00786acb : LEA EAX,[EBP + -0x60]
00786ace : PUSH EAX
00786acf : CALL 0x0044cb00
00786ad4 : MOVZX ESI,word ptr [ESI + 0x28]
00786ad8 : MOV dword ptr [EBP + -0x4],0xffffffff
00786adf : CMP dword ptr [EBP + -0x34],0x0
00786ae3 : JZ 0x00786af6
00786ae5 : MOV ECX,dword ptr [EBP + -0x40]
00786ae8 : PUSH ECX
00786ae9 : CALL dword ptr [0x00b8511c]
00786aef : MOV dword ptr [EBP + -0x34],0x0
00786af6 : MOV AX,SI
00786af9 : MOV ECX,dword ptr [EBP + -0xc]
00786afc : MOV dword ptr FS:[0x0],ECX
00786b03 : POP ECX
00786b04 : POP EDI
00786b05 : POP ESI
00786b06 : POP EBX
00786b07 : MOV ESP,EBP
00786b09 : POP EBP
00786b0a : RET 0x4
00786b0d : MOVZX ECX,DI
00786b10 : MOVZX EAX,BX
00786b13 : LEA EDX,[ECX + EAX*0x2 + 0x6]
00786b17 : CMP dword ptr [ESI + EDX*0x4],0x0
00786b1b : LEA EDI,[ESI + EDX*0x4]
00786b1e : JNZ 0x00786b82
00786b20 : PUSH 0x0
00786b22 : PUSH 0x90
00786b27 : PUSH 0xc11268
00786b2c : PUSH 0x170
00786b31 : CALL 0x006f0760
00786b36 : ADD ESP,0x10
00786b39 : MOV dword ptr [EBP + -0x28],EAX
00786b3c : MOV byte ptr [EBP + -0x4],0x1
00786b40 : TEST EAX,EAX
00786b42 : JZ 0x00786b7a
00786b44 : MOV CX,word ptr [ESI + 0x28]
00786b48 : FLD float ptr [EBP + -0x24]
00786b4b : MOVSS XMM0,dword ptr [EBP + -0x18]
00786b50 : INC CX
00786b52 : MOVZX EDX,CX
00786b55 : PUSH EDX
00786b56 : MOV EDX,dword ptr [ESI + 0x10]
00786b59 : MOVSS dword ptr [EBP + -0x1c],XMM0
00786b5e : MOVSS XMM0,dword ptr [EBP + -0x20]
00786b63 : MOVSS dword ptr [EBP + -0x18],XMM0
00786b68 : PUSH ECX
00786b69 : FSTP float ptr [ESP]
00786b6c : LEA ECX,[EBP + -0x1c]
00786b6f : PUSH ECX
00786b70 : PUSH ESI
00786b71 : PUSH EDX
00786b72 : PUSH EAX
00786b73 : CALL 0x00786680
00786b78 : JMP 0x00786b7c
00786b7a : XOR EAX,EAX
00786b7c : MOV byte ptr [EBP + -0x4],0x0
00786b80 : MOV dword ptr [EDI],EAX
00786b82 : MOV EAX,dword ptr [EBP + 0x8]
00786b85 : MOV ECX,dword ptr [EDI]
00786b87 : PUSH EAX
00786b88 : CALL 0x00786980
00786b8d : MOVZX ESI,AX
00786b90 : JMP 0x00786ad8

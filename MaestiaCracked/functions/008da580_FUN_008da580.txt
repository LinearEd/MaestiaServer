PROGRAM  : Maestia.exe
FUNCTION : FUN_008da580
ENTRY    : 008da580
BODY     : [[008da580, 008da79a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008da580(char param_1)

{
  int *piVar1;
  int iVar2;
  undefined4 uVar3;
  byte bVar4;
  int in_EDX;
  uint uVar5;
  bool bVar6;
  undefined1 local_54 [32];
  int local_34;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1e130;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if ((*(ushort *)(in_EDX + 0xd4) != 0) || (*(short *)(in_EDX + 0xd6) != 0)) {
    uVar5 = 0;
    if (*(int *)(DAT_0172491c + 0x17c) != 0) {
      uVar5 = *(uint *)(*(int *)(DAT_0172491c + 0x17c) + 0xa0);
    }
    if ((uVar5 < *(ushort *)(in_EDX + 0xd4)) ||
       ((*(ushort *)(in_EDX + 0xd6) != 0 && (*(ushort *)(in_EDX + 0xd6) < uVar5))))
    goto LAB_008da77e;
  }
  if (param_1 != '\0') goto LAB_008da77e;
  if (*(uint *)(in_EDX + 0xdc) != 0) {
    bVar4 = 0;
    if (*(int *)(DAT_0172491c + 0x17c) != 0) {
      bVar4 = (byte)*(undefined2 *)(*(int *)(DAT_0172491c + 0x17c) + 0x16d8);
    }
    if ((*(uint *)(in_EDX + 0xdc) >> (bVar4 & 0x1f) & 1) == 0) goto LAB_008da77e;
  }
  piVar1 = (int *)FUN_00703c00(0x600,local_14);
  if (((piVar1 == (int *)0x0) || (iVar2 = (**(code **)(*piVar1 + 0x3c))(), iVar2 == 0)) ||
     ((piVar1[0x12] & 0x3000000U) == 0)) goto LAB_008da77e;
  FUN_00406460(&DAT_00c5661c);
  local_8 = 0;
  local_34 = piVar1[0x13];
  if ((piVar1[0x12] & 0x1000000U) == 0) {
    if ((piVar1[0x12] & 0x2000000U) != 0) {
      FUN_00406460(L"IDS_ITEM_USABLE_GENDER_FEMALE");
      local_8._0_1_ = 3;
      uVar3 = FUN_0081d120(local_54);
      local_8._0_1_ = 4;
      FUN_00405eb0(uVar3,0,0xffffffff);
      local_8._0_1_ = 3;
      FUN_00406560();
      local_8 = (uint)local_8._1_3_ << 8;
      FUN_00406560();
      bVar6 = *(char *)(*(int *)(DAT_0172491c + 0x17c) + 0x7e) != '\0';
      goto LAB_008da75e;
    }
  }
  else {
    FUN_00406460(L"IDS_ITEM_USABLE_GENDER_MALE");
    local_8._0_1_ = 1;
    uVar3 = FUN_0081d120(local_54);
    local_8._0_1_ = 2;
    FUN_00405eb0(uVar3,0,0xffffffff);
    local_8._0_1_ = 1;
    FUN_00406560();
    local_8 = (uint)local_8._1_3_ << 8;
    FUN_00406560();
    bVar6 = *(char *)(*(int *)(DAT_0172491c + 0x17c) + 0x7e) == '\0';
LAB_008da75e:
    if (bVar6) {
      local_8 = 0xffffffff;
      FUN_00406560();
      goto LAB_008da77e;
    }
  }
  local_8 = 0xffffffff;
  FUN_00406560();
LAB_008da77e:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008da580 : PUSH EBP
008da581 : MOV EBP,ESP
008da583 : PUSH -0x1
008da585 : PUSH 0xb1e130
008da58a : MOV EAX,FS:[0x0]
008da590 : PUSH EAX
008da591 : SUB ESP,0x60
008da594 : MOV EAX,[0x00d66fa0]
008da599 : XOR EAX,EBP
008da59b : MOV dword ptr [EBP + -0x10],EAX
008da59e : PUSH ESI
008da59f : PUSH EDI
008da5a0 : PUSH EAX
008da5a1 : LEA EAX,[EBP + -0xc]
008da5a4 : MOV FS:[0x0],EAX
008da5aa : MOVZX ECX,word ptr [EDX + 0xd4]
008da5b1 : MOV EDI,dword ptr [0x0172491c]
008da5b7 : TEST CX,CX
008da5ba : JNZ 0x008da5c6
008da5bc : CMP word ptr [EDX + 0xd6],0x0
008da5c4 : JZ 0x008da5fa
008da5c6 : MOV EAX,dword ptr [EDI + 0x17c]
008da5cc : XOR ESI,ESI
008da5ce : TEST EAX,EAX
008da5d0 : JZ 0x008da5d8
008da5d2 : MOV ESI,dword ptr [EAX + 0xa0]
008da5d8 : MOVZX EAX,CX
008da5db : CMP EAX,ESI
008da5dd : JA 0x008da76d
008da5e3 : MOVZX EAX,word ptr [EDX + 0xd6]
008da5ea : TEST AX,AX
008da5ed : JZ 0x008da5fa
008da5ef : MOVZX ECX,AX
008da5f2 : CMP ECX,ESI
008da5f4 : JC 0x008da76d
008da5fa : CMP byte ptr [EBP + 0x8],0x0
008da5fe : JNZ 0x008da77c
008da604 : MOV EAX,dword ptr [EDX + 0xdc]
008da60a : TEST EAX,EAX
008da60c : JZ 0x008da62c
008da60e : MOV ESI,dword ptr [EDI + 0x17c]
008da614 : XOR ECX,ECX
008da616 : TEST ESI,ESI
008da618 : JZ 0x008da621
008da61a : MOVZX ECX,word ptr [ESI + 0x16d8]
008da621 : SHR EAX,CL
008da623 : AND EAX,0x1
008da626 : JZ 0x008da76d
008da62c : MOV DI,word ptr [EDX + 0x70]
008da630 : PUSH 0x600
008da635 : CALL 0x00703c00
008da63a : MOV ESI,EAX
008da63c : ADD ESP,0x4
008da63f : TEST ESI,ESI
008da641 : JZ 0x008da77c
008da647 : MOV EDX,dword ptr [ESI]
008da649 : MOV EAX,dword ptr [EDX + 0x3c]
008da64c : MOV ECX,ESI
008da64e : CALL EAX
008da650 : TEST EAX,EAX
008da652 : JZ 0x008da77c
008da658 : MOV EAX,dword ptr [ESI + 0x48]
008da65b : AND EAX,0x3000000
008da660 : XOR ECX,ECX
008da662 : OR EAX,ECX
008da664 : JZ 0x008da77c
008da66a : PUSH 0xc5661c
008da66f : LEA ECX,[EBP + -0x2c]
008da672 : CALL 0x00406460
008da677 : MOV dword ptr [EBP + -0x4],0x0
008da67e : MOV ECX,dword ptr [ESI + 0x48]
008da681 : MOV EDX,dword ptr [ESI + 0x4c]
008da684 : MOV EAX,ECX
008da686 : MOV dword ptr [EBP + -0x30],EDX
008da689 : XOR EDX,EDX
008da68b : AND EAX,0x1000000
008da690 : OR EAX,EDX
008da692 : LEA ESI,[EDX + -0x1]
008da695 : JZ 0x008da6f6
008da697 : PUSH 0xc56620
008da69c : LEA ECX,[EBP + -0x50]
008da69f : CALL 0x00406460
008da6a4 : MOV byte ptr [EBP + -0x4],0x1
008da6a8 : MOV ECX,dword ptr [0x0172491c]
008da6ae : LEA EAX,[EBP + -0x50]
008da6b1 : PUSH EAX
008da6b2 : LEA EDI,[EBP + -0x6c]
008da6b5 : CALL 0x0081d120
008da6ba : MOV byte ptr [EBP + -0x4],0x2
008da6be : PUSH ESI
008da6bf : PUSH 0x0
008da6c1 : PUSH EAX
008da6c2 : LEA ECX,[EBP + -0x2c]
008da6c5 : CALL 0x00405eb0
008da6ca : MOV byte ptr [EBP + -0x4],0x1
008da6ce : MOV ECX,EDI
008da6d0 : CALL 0x00406560
008da6d5 : MOV byte ptr [EBP + -0x4],0x0
008da6d9 : LEA ECX,[EBP + -0x50]
008da6dc : CALL 0x00406560
008da6e1 : MOV ECX,dword ptr [0x0172491c]
008da6e7 : MOV EAX,dword ptr [ECX + 0x17c]
008da6ed : CMP byte ptr [EAX + 0x7e],0x0
008da6f1 : SETZ AL
008da6f4 : JMP 0x008da75e
008da6f6 : AND ECX,0x2000000
008da6fc : XOR EAX,EAX
008da6fe : OR ECX,EAX
008da700 : JZ 0x008da762
008da702 : PUSH 0xc56658
008da707 : LEA ECX,[EBP + -0x50]
008da70a : CALL 0x00406460
008da70f : MOV byte ptr [EBP + -0x4],0x3
008da713 : MOV ECX,dword ptr [0x0172491c]
008da719 : LEA EDX,[EBP + -0x50]
008da71c : PUSH EDX
008da71d : LEA EDI,[EBP + -0x6c]
008da720 : CALL 0x0081d120
008da725 : MOV byte ptr [EBP + -0x4],0x4
008da729 : PUSH ESI
008da72a : PUSH 0x0
008da72c : PUSH EAX
008da72d : LEA ECX,[EBP + -0x2c]
008da730 : CALL 0x00405eb0
008da735 : MOV byte ptr [EBP + -0x4],0x3
008da739 : MOV ECX,EDI
008da73b : CALL 0x00406560
008da740 : MOV byte ptr [EBP + -0x4],0x0
008da744 : LEA ECX,[EBP + -0x50]
008da747 : CALL 0x00406560
008da74c : MOV EAX,[0x0172491c]
008da751 : MOV EAX,dword ptr [EAX + 0x17c]
008da757 : CMP byte ptr [EAX + 0x7e],0x0
008da75b : SETNZ AL
008da75e : TEST AL,AL
008da760 : JNZ 0x008da771
008da762 : MOV dword ptr [EBP + -0x4],ESI
008da765 : LEA ECX,[EBP + -0x2c]
008da768 : CALL 0x00406560
008da76d : XOR AL,AL
008da76f : JMP 0x008da77e
008da771 : MOV dword ptr [EBP + -0x4],ESI
008da774 : LEA ECX,[EBP + -0x2c]
008da777 : CALL 0x00406560
008da77c : MOV AL,0x1
008da77e : MOV ECX,dword ptr [EBP + -0xc]
008da781 : MOV dword ptr FS:[0x0],ECX
008da788 : POP ECX
008da789 : POP EDI
008da78a : POP ESI
008da78b : MOV ECX,dword ptr [EBP + -0x10]
008da78e : XOR ECX,EBP
008da790 : CALL 0x00633e6b
008da795 : MOV ESP,EBP
008da797 : POP EBP
008da798 : RET 0x4

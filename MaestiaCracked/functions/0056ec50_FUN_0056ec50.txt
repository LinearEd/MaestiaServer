PROGRAM  : Maestia.exe
FUNCTION : FUN_0056ec50
ENTRY    : 0056ec50
BODY     : [[0056ec50, 0056ed89]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0056ec50(int param_1,undefined4 param_2,char param_3,char param_4)

{
  char cVar1;
  int iVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  uint uVar5;
  LONG LVar6;
  undefined4 *in_ECX;
  undefined4 uVar7;
  
  *in_ECX = &PTR_FUN_00cd3f2c;
  *in_ECX = &PTR_FUN_00b86dd8;
  in_ECX[1] = 1;
  in_ECX[2] = 0x20001;
  in_ECX[3] = 0;
  *in_ECX = &PTR_FUN_00b8d16c;
  in_ECX[4] = 0;
  FUN_0051b6e0();
  FUN_0051c600(param_2);
  FUN_0051b6e0();
  in_ECX[9] = 0;
  in_ECX[10] = 0;
  iVar2 = FUN_00515840(0x54,0);
  if (iVar2 == 0) {
    uVar4 = 0;
  }
  else {
    uVar4 = *(undefined4 *)(*(int *)(param_1 + 0x6c) + 0x14);
    uVar7 = 0;
    uVar3 = (*(code *)**(undefined4 **)(param_1 + 8))(0);
    uVar4 = FUN_005a19f0(uVar4,uVar3,uVar7);
  }
  if ((GRefCountImpl *)in_ECX[4] != (GRefCountImpl *)0x0) {
    GRefCountImpl::Release((GRefCountImpl *)in_ECX[4]);
  }
  in_ECX[4] = uVar4;
  uVar5 = *(uint *)(*(int *)(*(int *)(param_1 + 0x6c) + 0x1c) + 0x14) & 0xfffffffc;
  in_ECX[5] = uVar5 | 0x10000;
  if (param_4 != '\0') {
    in_ECX[5] = uVar5 | 0x210000;
  }
  if (*(int *)(param_1 + 0x68) != 0) {
    uVar4 = (**(code **)(**(int **)(param_1 + 0x6c) + 0x30))();
    FUN_0051bb20(uVar4);
    cVar1 = FUN_005a23d0(in_ECX + 6);
    if (cVar1 != '\0') goto LAB_0056ed46;
  }
  FUN_0051bf30();
LAB_0056ed46:
  if (param_3 != '\0') {
    uVar4 = FUN_0056b0d0();
    FUN_0051bc20(uVar4);
    LVar6 = InterlockedExchangeAdd((LONG *)(((uint)in_ECX & 0xfffffffc) + 4),-1);
    if (LVar6 == 1) {
      FUN_00515cf0((uint)in_ECX & 0xfffffffc);
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
0056ec50 : PUSH ECX
0056ec51 : PUSH EBX
0056ec52 : PUSH EBP
0056ec53 : MOV EBP,ECX
0056ec55 : MOV dword ptr [EBP],0xcd3f2c
0056ec5c : PUSH ESI
0056ec5d : PUSH EDI
0056ec5e : MOV dword ptr [EBP],0xb86dd8
0056ec65 : MOV dword ptr [EBP + 0x4],0x1
0056ec6c : MOV dword ptr [EBP + 0x8],0x20001
0056ec73 : XOR EDI,EDI
0056ec75 : MOV dword ptr [EBP + 0xc],EDI
0056ec78 : LEA EBX,[EBP + 0x18]
0056ec7b : MOV dword ptr [EBP],0xb8d16c
0056ec82 : MOV ECX,EBX
0056ec84 : MOV dword ptr [EBP + 0x10],EDI
0056ec87 : CALL 0x0051b6e0
0056ec8c : MOV EAX,dword ptr [ESP + 0x1c]
0056ec90 : LEA ECX,[EBP + 0x1c]
0056ec93 : PUSH EAX
0056ec94 : CALL 0x0051c600
0056ec99 : LEA ECX,[EBP + 0x20]
0056ec9c : CALL 0x0051b6e0
0056eca1 : MOV dword ptr [EBP + 0x24],EDI
0056eca4 : PUSH EDI
0056eca5 : MOV dword ptr [EBP + 0x28],EDI
0056eca8 : MOV ECX,dword ptr [0x00d73250]
0056ecae : PUSH 0x54
0056ecb0 : CALL 0x00515840
0056ecb5 : MOV ESI,EAX
0056ecb7 : CMP ESI,EDI
0056ecb9 : MOV EDI,dword ptr [ESP + 0x18]
0056ecbd : JZ 0x0056ece6
0056ecbf : MOV ECX,dword ptr [EDI + 0x6c]
0056ecc2 : MOV EDX,dword ptr [ECX + 0x14]
0056ecc5 : MOV EAX,dword ptr [EDI + 0x8]
0056ecc8 : LEA ECX,[EDI + 0x8]
0056eccb : MOV dword ptr [ESP + 0x1c],EDX
0056eccf : MOV EDX,dword ptr [EAX]
0056ecd1 : PUSH 0x0
0056ecd3 : CALL EDX
0056ecd5 : PUSH EAX
0056ecd6 : MOV EAX,dword ptr [ESP + 0x24]
0056ecda : PUSH EAX
0056ecdb : MOV ECX,ESI
0056ecdd : CALL 0x005a19f0
0056ece2 : MOV ESI,EAX
0056ece4 : JMP 0x0056ece8
0056ece6 : XOR ESI,ESI
0056ece8 : MOV ECX,dword ptr [EBP + 0x10]
0056eceb : TEST ECX,ECX
0056eced : JZ 0x0056ecf4
0056ecef : CALL 0x004ff7e0
0056ecf4 : MOV dword ptr [EBP + 0x10],ESI
0056ecf7 : MOV ECX,dword ptr [EDI + 0x6c]
0056ecfa : MOV EDX,dword ptr [ECX + 0x1c]
0056ecfd : MOV EAX,dword ptr [EDX + 0x14]
0056ed00 : AND EAX,0xfffffffc
0056ed03 : OR EAX,0x10000
0056ed08 : CMP byte ptr [ESP + 0x24],0x0
0056ed0d : MOV dword ptr [EBP + 0x14],EAX
0056ed10 : JZ 0x0056ed1a
0056ed12 : OR EAX,0x200000
0056ed17 : MOV dword ptr [EBP + 0x14],EAX
0056ed1a : CMP dword ptr [EDI + 0x68],0x0
0056ed1e : JZ 0x0056ed3f
0056ed20 : MOV ECX,dword ptr [EDI + 0x6c]
0056ed23 : MOV EAX,dword ptr [ECX]
0056ed25 : MOV EDX,dword ptr [EAX + 0x30]
0056ed28 : CALL EDX
0056ed2a : PUSH EAX
0056ed2b : MOV ECX,EBX
0056ed2d : CALL 0x0051bb20
0056ed32 : PUSH EBX
0056ed33 : CALL 0x005a23d0
0056ed38 : ADD ESP,0x4
0056ed3b : TEST AL,AL
0056ed3d : JNZ 0x0056ed46
0056ed3f : MOV ECX,EBX
0056ed41 : CALL 0x0051bf30
0056ed46 : CMP byte ptr [ESP + 0x20],0x0
0056ed4b : JZ 0x0056ed80
0056ed4d : LEA EDI,[EBP + 0x1c]
0056ed50 : LEA ESI,[ESP + 0x10]
0056ed54 : CALL 0x0056b0d0
0056ed59 : PUSH EAX
0056ed5a : LEA ECX,[EBP + 0x20]
0056ed5d : CALL 0x0051bc20
0056ed62 : MOV ESI,dword ptr [ESP + 0x10]
0056ed66 : AND ESI,0xfffffffc
0056ed69 : PUSH -0x1
0056ed6b : LEA EAX,[ESI + 0x4]
0056ed6e : PUSH EAX
0056ed6f : CALL dword ptr [0x00b851cc]
0056ed75 : SUB EAX,0x1
0056ed78 : JNZ 0x0056ed80
0056ed7a : PUSH ESI
0056ed7b : CALL 0x00515cf0
0056ed80 : POP EDI
0056ed81 : POP ESI
0056ed82 : MOV EAX,EBP
0056ed84 : POP EBP
0056ed85 : POP EBX
0056ed86 : POP ECX
0056ed87 : RET 0x10

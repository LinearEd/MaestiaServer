PROGRAM  : Maestia.exe
FUNCTION : FUN_00408ba0
ENTRY    : 00408ba0
BODY     : [[00408ba0, 00408c00]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00408ba0(int param_1,wchar_t *param_2)

{
  wchar_t wVar1;
  wchar_t *pwVar2;
  wchar_t *pwVar3;
  
  pwVar2 = param_2;
  do {
    wVar1 = *pwVar2;
    pwVar2 = pwVar2 + 1;
  } while (wVar1 != L'\0');
  pwVar3 = (wchar_t *)(param_1 + 8);
  do {
    wVar1 = *pwVar3;
    pwVar3 = pwVar3 + 1;
  } while (wVar1 != L'\0');
  if (((int)pwVar3 - (param_1 + 10) >> 1) + ((int)pwVar2 - (int)(param_2 + 1) >> 1) <=
      *(int *)(param_1 + 4)) {
    _wcscat_s((wchar_t *)(param_1 + 8),0x100,param_2);
    return 1;
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00408ba0 : PUSH EBP
00408ba1 : MOV EBP,ESP
00408ba3 : MOV EAX,dword ptr [EBP + 0xc]
00408ba6 : PUSH EBX
00408ba7 : MOV EBX,dword ptr [EBP + 0x8]
00408baa : PUSH ESI
00408bab : PUSH EDI
00408bac : LEA EDX,[EAX + 0x2]
00408baf : NOP
00408bb0 : MOV CX,word ptr [EAX]
00408bb3 : ADD EAX,0x2
00408bb6 : TEST CX,CX
00408bb9 : JNZ 0x00408bb0
00408bbb : LEA ESI,[EBX + 0x8]
00408bbe : SUB EAX,EDX
00408bc0 : MOV ECX,ESI
00408bc2 : SAR EAX,0x1
00408bc4 : LEA EDI,[ECX + 0x2]
00408bc7 : MOV DX,word ptr [ECX]
00408bca : ADD ECX,0x2
00408bcd : TEST DX,DX
00408bd0 : JNZ 0x00408bc7
00408bd2 : SUB ECX,EDI
00408bd4 : SAR ECX,0x1
00408bd6 : ADD ECX,EAX
00408bd8 : CMP ECX,dword ptr [EBX + 0x4]
00408bdb : JG 0x00408bf8
00408bdd : MOV EAX,dword ptr [EBP + 0xc]
00408be0 : PUSH EAX
00408be1 : PUSH 0x100
00408be6 : PUSH ESI
00408be7 : CALL 0x006362c1
00408bec : ADD ESP,0xc
00408bef : POP EDI
00408bf0 : POP ESI
00408bf1 : MOV AL,0x1
00408bf3 : POP EBX
00408bf4 : POP EBP
00408bf5 : RET 0x8
00408bf8 : POP EDI
00408bf9 : POP ESI
00408bfa : XOR AL,AL
00408bfc : POP EBX
00408bfd : POP EBP
00408bfe : RET 0x8

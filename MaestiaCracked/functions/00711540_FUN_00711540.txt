PROGRAM  : Maestia.exe
FUNCTION : FUN_00711540
ENTRY    : 00711540
BODY     : [[00711540, 007115ec] [007115f0, 00711697]]

============================================================
DECOMPILED C CODE
============================================================

char * FUN_00711540(uint param_1)

{
  char *pcVar1;
  uint uVar2;
  char *pcVar3;
  char *pcVar4;
  char *pcVar5;
  char *pcVar6;
  char *pcVar7;
  int unaff_EDI;
  uint local_14;
  uint local_10;
  uint local_c;
  char local_6;
  char local_5;
  
  uVar2 = *(uint *)(unaff_EDI + 100);
  local_c = *(uint *)(unaff_EDI + 0x74);
  pcVar4 = (char *)(*(int *)(unaff_EDI + 0x30) + uVar2);
  pcVar3 = *(char **)(unaff_EDI + 0x70);
  if (*(int *)(unaff_EDI + 0x24) - 0x106U < uVar2) {
    local_14 = (uVar2 - *(int *)(unaff_EDI + 0x24)) + 0x106;
  }
  else {
    local_14 = 0;
  }
  local_5 = pcVar4[(int)(pcVar3 + -1)];
  local_6 = pcVar4[(int)pcVar3];
  pcVar1 = pcVar4 + 0x102;
  if (*(char **)(unaff_EDI + 0x84) <= pcVar3) {
    local_c = local_c >> 2;
  }
  local_10 = *(uint *)(unaff_EDI + 0x88);
  if (*(uint *)(unaff_EDI + 0x6c) < *(uint *)(unaff_EDI + 0x88)) {
    local_10 = *(uint *)(unaff_EDI + 0x6c);
  }
  do {
    pcVar7 = (char *)(*(int *)(unaff_EDI + 0x30) + param_1);
    if ((((pcVar7[(int)pcVar3] == local_6) && (pcVar7[(int)(pcVar3 + -1)] == local_5)) &&
        (*pcVar7 == *pcVar4)) && (pcVar7[1] == pcVar4[1])) {
      pcVar7 = pcVar7 + 2;
      pcVar5 = pcVar4 + 2;
      while (((((pcVar6 = pcVar5 + 1, pcVar5[1] == pcVar7[1] &&
                (pcVar6 = pcVar5 + 2, pcVar5[2] == pcVar7[2])) &&
               ((pcVar6 = pcVar5 + 3, pcVar5[3] == pcVar7[3] &&
                ((pcVar6 = pcVar5 + 4, pcVar5[4] == pcVar7[4] &&
                 (pcVar6 = pcVar5 + 5, pcVar5[5] == pcVar7[5])))))) &&
              (pcVar6 = pcVar5 + 6, pcVar5[6] == pcVar7[6])) &&
             (pcVar6 = pcVar5 + 7, pcVar5[7] == pcVar7[7]))) {
        pcVar6 = pcVar5 + 8;
        pcVar7 = pcVar7 + 8;
        if ((pcVar5[8] != *pcVar7) || (pcVar5 = pcVar6, pcVar1 <= pcVar6)) break;
      }
      pcVar7 = pcVar6 + (0x102 - (int)pcVar1);
      if ((int)pcVar3 < (int)pcVar7) {
        *(uint *)(unaff_EDI + 0x68) = param_1;
        if ((int)local_10 <= (int)pcVar7) {
LAB_00711689:
          if (*(char **)(unaff_EDI + 0x6c) < pcVar7) {
            pcVar7 = *(char **)(unaff_EDI + 0x6c);
          }
          return pcVar7;
        }
        local_5 = pcVar4[(int)(pcVar6 + (0x101 - (int)pcVar1))];
        local_6 = pcVar4[(int)pcVar7];
        pcVar3 = pcVar7;
      }
    }
    pcVar7 = pcVar3;
    param_1 = (uint)*(ushort *)
                     (*(int *)(unaff_EDI + 0x38) + (*(uint *)(unaff_EDI + 0x2c) & param_1) * 2);
    if ((param_1 <= local_14) || (local_c = local_c - 1, pcVar3 = pcVar7, local_c == 0))
    goto LAB_00711689;
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
00711540 : PUSH EBP
00711541 : MOV EBP,ESP
00711543 : SUB ESP,0x14
00711546 : MOV EDX,dword ptr [EDI + 0x64]
00711549 : MOV EAX,dword ptr [EDI + 0x74]
0071154c : MOV ECX,dword ptr [EDI + 0x30]
0071154f : PUSH EBX
00711550 : PUSH ESI
00711551 : MOV ESI,dword ptr [EDI + 0x88]
00711557 : MOV dword ptr [EBP + -0xc],ESI
0071155a : MOV ESI,dword ptr [EDI + 0x24]
0071155d : LEA EBX,[ESI + 0xfffffefa]
00711563 : ADD ECX,EDX
00711565 : MOV dword ptr [EBP + -0x8],EAX
00711568 : MOV EAX,dword ptr [EDI + 0x70]
0071156b : CMP EDX,EBX
0071156d : JBE 0x0071157c
0071156f : SUB EDX,ESI
00711571 : ADD EDX,0x106
00711577 : MOV dword ptr [EBP + -0x10],EDX
0071157a : JMP 0x00711583
0071157c : MOV dword ptr [EBP + -0x10],0x0
00711583 : MOVZX EDX,byte ptr [EAX + ECX*0x1 + -0x1]
00711588 : MOV byte ptr [EBP + -0x1],DL
0071158b : MOVZX EDX,byte ptr [EAX + ECX*0x1]
0071158f : LEA ESI,[ECX + 0x102]
00711595 : MOV byte ptr [EBP + -0x2],DL
00711598 : CMP EAX,dword ptr [EDI + 0x84]
0071159e : JC 0x007115a4
007115a0 : SHR dword ptr [EBP + -0x8],0x2
007115a4 : MOV EDX,dword ptr [EDI + 0x6c]
007115a7 : CMP dword ptr [EBP + -0xc],EDX
007115aa : JBE 0x007115af
007115ac : MOV dword ptr [EBP + -0xc],EDX
007115af : MOV EBX,dword ptr [EBP + 0x8]
007115b2 : MOV EDX,dword ptr [EDI + 0x30]
007115b5 : ADD EDX,EBX
007115b7 : MOV BL,byte ptr [EBP + -0x2]
007115ba : CMP byte ptr [EDX + EAX*0x1],BL
007115bd : JNZ 0x0071166a
007115c3 : MOV BL,byte ptr [EBP + -0x1]
007115c6 : CMP byte ptr [EDX + EAX*0x1 + -0x1],BL
007115ca : JNZ 0x0071166a
007115d0 : MOV BL,byte ptr [EDX]
007115d2 : CMP BL,byte ptr [ECX]
007115d4 : JNZ 0x0071166a
007115da : MOV BL,byte ptr [EDX + 0x1]
007115dd : INC EDX
007115de : CMP BL,byte ptr [ECX + 0x1]
007115e1 : JNZ 0x0071166a
007115e7 : ADD ECX,0x2
007115ea : INC EDX
007115eb : JMP 0x007115f0
007115f0 : MOV BL,byte ptr [ECX + 0x1]
007115f3 : INC ECX
007115f4 : INC EDX
007115f5 : CMP BL,byte ptr [EDX]
007115f7 : JNZ 0x0071163c
007115f9 : MOV BL,byte ptr [ECX + 0x1]
007115fc : INC ECX
007115fd : INC EDX
007115fe : CMP BL,byte ptr [EDX]
00711600 : JNZ 0x0071163c
00711602 : MOV BL,byte ptr [ECX + 0x1]
00711605 : INC ECX
00711606 : INC EDX
00711607 : CMP BL,byte ptr [EDX]
00711609 : JNZ 0x0071163c
0071160b : MOV BL,byte ptr [ECX + 0x1]
0071160e : INC ECX
0071160f : INC EDX
00711610 : CMP BL,byte ptr [EDX]
00711612 : JNZ 0x0071163c
00711614 : MOV BL,byte ptr [ECX + 0x1]
00711617 : INC ECX
00711618 : INC EDX
00711619 : CMP BL,byte ptr [EDX]
0071161b : JNZ 0x0071163c
0071161d : MOV BL,byte ptr [ECX + 0x1]
00711620 : INC ECX
00711621 : INC EDX
00711622 : CMP BL,byte ptr [EDX]
00711624 : JNZ 0x0071163c
00711626 : MOV BL,byte ptr [ECX + 0x1]
00711629 : INC ECX
0071162a : INC EDX
0071162b : CMP BL,byte ptr [EDX]
0071162d : JNZ 0x0071163c
0071162f : MOV BL,byte ptr [ECX + 0x1]
00711632 : INC ECX
00711633 : INC EDX
00711634 : CMP BL,byte ptr [EDX]
00711636 : JNZ 0x0071163c
00711638 : CMP ECX,ESI
0071163a : JC 0x007115f0
0071163c : MOV EDX,ECX
0071163e : SUB EDX,ESI
00711640 : ADD EDX,0x102
00711646 : CMP EDX,EAX
00711648 : LEA ECX,[ESI + 0xfffffefe]
0071164e : JLE 0x0071166a
00711650 : CMP EDX,dword ptr [EBP + -0xc]
00711653 : MOV EAX,dword ptr [EBP + 0x8]
00711656 : MOV dword ptr [EDI + 0x68],EAX
00711659 : MOV EAX,EDX
0071165b : JGE 0x00711689
0071165d : MOV BL,byte ptr [EDX + ECX*0x1 + -0x1]
00711661 : MOV DL,byte ptr [EDX + ECX*0x1]
00711664 : MOV byte ptr [EBP + -0x1],BL
00711667 : MOV byte ptr [EBP + -0x2],DL
0071166a : MOV EBX,dword ptr [EDI + 0x2c]
0071166d : AND EBX,dword ptr [EBP + 0x8]
00711670 : MOV EDX,dword ptr [EDI + 0x38]
00711673 : MOVZX EBX,word ptr [EDX + EBX*0x2]
00711677 : MOV dword ptr [EBP + 0x8],EBX
0071167a : CMP EBX,dword ptr [EBP + -0x10]
0071167d : JBE 0x00711689
0071167f : SUB dword ptr [EBP + -0x8],0x1
00711683 : JNZ 0x007115b2
00711689 : MOV ECX,dword ptr [EDI + 0x6c]
0071168c : POP ESI
0071168d : POP EBX
0071168e : CMP EAX,ECX
00711690 : JBE 0x00711694
00711692 : MOV EAX,ECX
00711694 : MOV ESP,EBP
00711696 : POP EBP
00711697 : RET

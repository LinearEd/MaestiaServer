PROGRAM  : Maestia.exe
FUNCTION : FUN_009a8840
ENTRY    : 009a8840
BODY     : [[009a8840, 009a8b72]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009a8840(undefined4 param_1,undefined4 param_2)

{
  wchar_t wVar1;
  uint uVar2;
  undefined4 uVar3;
  int iVar4;
  wchar_t *pwVar5;
  undefined4 in_ECX;
  wchar_t *pwVar6;
  wchar_t *pwVar7;
  bool bVar8;
  undefined1 local_60 [4];
  int local_5c;
  int local_58;
  undefined1 local_50 [4];
  undefined2 local_4c;
  undefined4 local_3c;
  uint local_38;
  undefined2 local_30;
  undefined4 local_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b4afd4;
  local_14 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xffffff90;
  ExceptionList = &local_14;
  local_38 = 7;
  local_3c = 0;
  local_4c = 0;
  FUN_00406360(&DAT_00c8a550,1);
  local_c = 0;
  uVar3 = FUN_00403dd0(param_2,uVar2);
  local_c._0_1_ = 1;
  FUN_0070cd60(local_60,uVar3,local_50,0);
  local_c = CONCAT31(local_c._1_3_,3);
  if (7 < local_1c) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_1c = 7;
  local_20 = 0;
  local_30 = 0;
  local_c = CONCAT31(local_c._1_3_,4);
  if (7 < local_38) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_38 = 7;
  local_3c = 0;
  uVar2 = *(uint *)(local_5c + 0x18);
  local_4c = 0;
  pwVar5 = (wchar_t *)(local_5c + 4);
  pwVar7 = pwVar5;
  if (7 < uVar2) {
    pwVar7 = *(wchar_t **)pwVar5;
  }
  pwVar6 = L"Close";
  do {
    wVar1 = *pwVar7;
    bVar8 = (ushort)wVar1 < (ushort)*pwVar6;
    if (wVar1 != *pwVar6) {
LAB_009a894d:
      iVar4 = (1 - (uint)bVar8) - (uint)(bVar8 != 0);
      goto LAB_009a8952;
    }
    if (wVar1 == L'\0') break;
    wVar1 = pwVar7[1];
    bVar8 = (ushort)wVar1 < (ushort)pwVar6[1];
    if (wVar1 != pwVar6[1]) goto LAB_009a894d;
    pwVar7 = pwVar7 + 2;
    pwVar6 = pwVar6 + 2;
  } while (wVar1 != L'\0');
  iVar4 = 0;
LAB_009a8952:
  if (iVar4 == 0) {
    uVar3 = 4;
  }
  else {
    pwVar7 = pwVar5;
    if (7 < uVar2) {
      pwVar7 = *(wchar_t **)pwVar5;
    }
    pwVar6 = L"Ok";
    do {
      wVar1 = *pwVar7;
      bVar8 = (ushort)wVar1 < (ushort)*pwVar6;
      if (wVar1 != *pwVar6) {
LAB_009a8996:
        iVar4 = (1 - (uint)bVar8) - (uint)(bVar8 != 0);
        goto LAB_009a899b;
      }
      if (wVar1 == L'\0') break;
      wVar1 = pwVar7[1];
      bVar8 = (ushort)wVar1 < (ushort)pwVar6[1];
      if (wVar1 != pwVar6[1]) goto LAB_009a8996;
      pwVar7 = pwVar7 + 2;
      pwVar6 = pwVar6 + 2;
    } while (wVar1 != L'\0');
    iVar4 = 0;
LAB_009a899b:
    if (iVar4 == 0) {
      if ((uint)((local_58 - local_5c) / 0x1c) < 2) {
LAB_009a89bd:
        local_c = 0xffffffff;
        FUN_004042c0();
        ExceptionList = local_14;
        return;
      }
      if (*(uint *)(local_5c + 0x34) < 8) {
        FUN_00634f4d(local_5c + 0x20);
        uVar3 = 2;
      }
      else {
        FUN_00634f4d(*(undefined4 *)(local_5c + 0x20));
        uVar3 = 2;
      }
    }
    else {
      pwVar7 = pwVar5;
      if (7 < uVar2) {
        pwVar7 = *(wchar_t **)pwVar5;
      }
      pwVar6 = L"Plus";
      do {
        wVar1 = *pwVar7;
        bVar8 = (ushort)wVar1 < (ushort)*pwVar6;
        if (wVar1 != *pwVar6) {
LAB_009a8a46:
          iVar4 = (1 - (uint)bVar8) - (uint)(bVar8 != 0);
          goto LAB_009a8a4b;
        }
        if (wVar1 == L'\0') break;
        wVar1 = pwVar7[1];
        bVar8 = (ushort)wVar1 < (ushort)pwVar6[1];
        if (wVar1 != pwVar6[1]) goto LAB_009a8a46;
        pwVar7 = pwVar7 + 2;
        pwVar6 = pwVar6 + 2;
      } while (wVar1 != L'\0');
      iVar4 = 0;
LAB_009a8a4b:
      if (iVar4 == 0) {
        if ((uint)((local_58 - local_5c) / 0x1c) < 2) goto LAB_009a89bd;
        if (*(uint *)(local_5c + 0x34) < 8) {
          FUN_00634f4d(local_5c + 0x20);
          uVar3 = 0;
        }
        else {
          FUN_00634f4d(*(undefined4 *)(local_5c + 0x20));
          uVar3 = 0;
        }
      }
      else {
        if (7 < uVar2) {
          pwVar5 = *(wchar_t **)pwVar5;
        }
        pwVar7 = L"Minus";
        do {
          wVar1 = *pwVar5;
          bVar8 = (ushort)wVar1 < (ushort)*pwVar7;
          if (wVar1 != *pwVar7) {
LAB_009a8ad6:
            iVar4 = (1 - (uint)bVar8) - (uint)(bVar8 != 0);
            goto LAB_009a8adb;
          }
          if (wVar1 == L'\0') break;
          wVar1 = pwVar5[1];
          bVar8 = (ushort)wVar1 < (ushort)pwVar7[1];
          if (wVar1 != pwVar7[1]) goto LAB_009a8ad6;
          pwVar5 = pwVar5 + 2;
          pwVar7 = pwVar7 + 2;
        } while (wVar1 != L'\0');
        iVar4 = 0;
LAB_009a8adb:
        if (iVar4 != 0) goto LAB_009a8b26;
        if ((uint)((local_58 - local_5c) / 0x1c) < 2) goto LAB_009a89bd;
        if (*(uint *)(local_5c + 0x34) < 8) {
          iVar4 = local_5c + 0x20;
        }
        else {
          iVar4 = *(int *)(local_5c + 0x20);
        }
        FUN_00634f4d(iVar4);
        uVar3 = 1;
      }
    }
  }
  FUN_009a8620(uVar3);
LAB_009a8b26:
  local_c = 0xffffffff;
  if (local_5c == 0) {
    ExceptionList = local_14;
    return;
  }
  FUN_00405450(in_ECX);
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
009a8840 : PUSH EBP
009a8841 : MOV EBP,ESP
009a8843 : AND ESP,0xfffffff8
009a8846 : PUSH -0x1
009a8848 : PUSH 0xb4afd4
009a884d : MOV EAX,FS:[0x0]
009a8853 : PUSH EAX
009a8854 : SUB ESP,0x50
009a8857 : PUSH EBX
009a8858 : PUSH ESI
009a8859 : PUSH EDI
009a885a : MOV EAX,[0x00d66fa0]
009a885f : XOR EAX,ESP
009a8861 : PUSH EAX
009a8862 : LEA EAX,[ESP + 0x60]
009a8866 : MOV FS:[0x0],EAX
009a886c : MOV dword ptr [ESP + 0x10],ECX
009a8870 : PUSH 0x1
009a8872 : XOR EAX,EAX
009a8874 : MOV EDI,0x7
009a8879 : XOR EBX,EBX
009a887b : PUSH 0xc8a550
009a8880 : LEA ECX,[ESP + 0x2c]
009a8884 : MOV dword ptr [ESP + 0x44],EDI
009a8888 : MOV dword ptr [ESP + 0x40],EBX
009a888c : MOV word ptr [ESP + 0x30],AX
009a8891 : CALL 0x00406360
009a8896 : MOV dword ptr [ESP + 0x68],EBX
009a889a : MOV ECX,dword ptr [EBP + 0xc]
009a889d : PUSH ECX
009a889e : LEA ESI,[ESP + 0x44]
009a88a2 : CALL 0x00403dd0
009a88a7 : ADD ESP,0x4
009a88aa : MOV byte ptr [ESP + 0x68],0x1
009a88af : PUSH EBX
009a88b0 : LEA EDX,[ESP + 0x28]
009a88b4 : PUSH EDX
009a88b5 : PUSH EAX
009a88b6 : LEA EAX,[ESP + 0x20]
009a88ba : PUSH EAX
009a88bb : CALL 0x0070cd60
009a88c0 : ADD ESP,0x10
009a88c3 : MOV byte ptr [ESP + 0x68],0x3
009a88c8 : MOV ESI,0x8
009a88cd : CMP dword ptr [ESP + 0x58],ESI
009a88d1 : JC 0x009a88dc
009a88d3 : MOV ECX,dword ptr [ESP + 0x44]
009a88d7 : CALL 0x006f04e0
009a88dc : XOR ECX,ECX
009a88de : MOV dword ptr [ESP + 0x58],EDI
009a88e2 : MOV dword ptr [ESP + 0x54],EBX
009a88e6 : MOV word ptr [ESP + 0x44],CX
009a88eb : MOV byte ptr [ESP + 0x68],0x4
009a88f0 : CMP dword ptr [ESP + 0x3c],ESI
009a88f4 : JC 0x009a88ff
009a88f6 : MOV ECX,dword ptr [ESP + 0x28]
009a88fa : CALL 0x006f04e0
009a88ff : MOV dword ptr [ESP + 0x3c],EDI
009a8903 : MOV EDI,dword ptr [ESP + 0x18]
009a8907 : MOV dword ptr [ESP + 0x38],EBX
009a890b : MOV EBX,dword ptr [EDI + 0x18]
009a890e : XOR EDX,EDX
009a8910 : CMP EBX,ESI
009a8912 : MOV word ptr [ESP + 0x28],DX
009a8917 : LEA ESI,[EDI + 0x4]
009a891a : JC 0x009a8920
009a891c : MOV EAX,dword ptr [ESI]
009a891e : JMP 0x009a8922
009a8920 : MOV EAX,ESI
009a8922 : MOV ECX,0xc8a554
009a8927 : MOV DX,word ptr [EAX]
009a892a : CMP DX,word ptr [ECX]
009a892d : JNZ 0x009a894d
009a892f : TEST DX,DX
009a8932 : JZ 0x009a8949
009a8934 : MOV DX,word ptr [EAX + 0x2]
009a8938 : CMP DX,word ptr [ECX + 0x2]
009a893c : JNZ 0x009a894d
009a893e : ADD EAX,0x4
009a8941 : ADD ECX,0x4
009a8944 : TEST DX,DX
009a8947 : JNZ 0x009a8927
009a8949 : XOR EAX,EAX
009a894b : JMP 0x009a8952
009a894d : SBB EAX,EAX
009a894f : SBB EAX,-0x1
009a8952 : TEST EAX,EAX
009a8954 : JNZ 0x009a895f
009a8956 : PUSH 0x4
009a8958 : XOR ECX,ECX
009a895a : JMP 0x009a8b1d
009a895f : CMP EBX,0x8
009a8962 : JC 0x009a8968
009a8964 : MOV EAX,dword ptr [ESI]
009a8966 : JMP 0x009a896a
009a8968 : MOV EAX,ESI
009a896a : MOV ECX,0xc8a560
009a896f : NOP
009a8970 : MOV DX,word ptr [EAX]
009a8973 : CMP DX,word ptr [ECX]
009a8976 : JNZ 0x009a8996
009a8978 : TEST DX,DX
009a897b : JZ 0x009a8992
009a897d : MOV DX,word ptr [EAX + 0x2]
009a8981 : CMP DX,word ptr [ECX + 0x2]
009a8985 : JNZ 0x009a8996
009a8987 : ADD EAX,0x4
009a898a : ADD ECX,0x4
009a898d : TEST DX,DX
009a8990 : JNZ 0x009a8970
009a8992 : XOR EAX,EAX
009a8994 : JMP 0x009a899b
009a8996 : SBB EAX,EAX
009a8998 : SBB EAX,-0x1
009a899b : TEST EAX,EAX
009a899d : JNZ 0x009a8a0f
009a899f : MOV ECX,dword ptr [ESP + 0x1c]
009a89a3 : SUB ECX,EDI
009a89a5 : MOV EAX,0x92492493
009a89aa : IMUL ECX
009a89ac : ADD EDX,ECX
009a89ae : SAR EDX,0x4
009a89b1 : MOV EAX,EDX
009a89b3 : SHR EAX,0x1f
009a89b6 : ADD EAX,EDX
009a89b8 : CMP EAX,0x2
009a89bb : JNC 0x009a89e3
009a89bd : MOV dword ptr [ESP + 0x68],0xffffffff
009a89c5 : LEA ESI,[ESP + 0x14]
009a89c9 : CALL 0x004042c0
009a89ce : MOV ECX,dword ptr [ESP + 0x60]
009a89d2 : MOV dword ptr FS:[0x0],ECX
009a89d9 : POP ECX
009a89da : POP EDI
009a89db : POP ESI
009a89dc : POP EBX
009a89dd : MOV ESP,EBP
009a89df : POP EBP
009a89e0 : RET 0x8
009a89e3 : CMP dword ptr [EDI + 0x34],0x8
009a89e7 : JC 0x009a89fc
009a89e9 : MOV EAX,dword ptr [EDI + 0x20]
009a89ec : PUSH EAX
009a89ed : CALL 0x00634f4d
009a89f2 : ADD ESP,0x4
009a89f5 : PUSH 0x2
009a89f7 : JMP 0x009a8b1a
009a89fc : LEA EAX,[EDI + 0x20]
009a89ff : PUSH EAX
009a8a00 : CALL 0x00634f4d
009a8a05 : ADD ESP,0x4
009a8a08 : PUSH 0x2
009a8a0a : JMP 0x009a8b1a
009a8a0f : CMP EBX,0x8
009a8a12 : JC 0x009a8a18
009a8a14 : MOV EAX,dword ptr [ESI]
009a8a16 : JMP 0x009a8a1a
009a8a18 : MOV EAX,ESI
009a8a1a : MOV ECX,0xc8a568
009a8a1f : NOP
009a8a20 : MOV DX,word ptr [EAX]
009a8a23 : CMP DX,word ptr [ECX]
009a8a26 : JNZ 0x009a8a46
009a8a28 : TEST DX,DX
009a8a2b : JZ 0x009a8a42
009a8a2d : MOV DX,word ptr [EAX + 0x2]
009a8a31 : CMP DX,word ptr [ECX + 0x2]
009a8a35 : JNZ 0x009a8a46
009a8a37 : ADD EAX,0x4
009a8a3a : ADD ECX,0x4
009a8a3d : TEST DX,DX
009a8a40 : JNZ 0x009a8a20
009a8a42 : XOR EAX,EAX
009a8a44 : JMP 0x009a8a4b
009a8a46 : SBB EAX,EAX
009a8a48 : SBB EAX,-0x1
009a8a4b : TEST EAX,EAX
009a8a4d : JNZ 0x009a8a9d
009a8a4f : MOV ECX,dword ptr [ESP + 0x1c]
009a8a53 : SUB ECX,EDI
009a8a55 : MOV EAX,0x92492493
009a8a5a : IMUL ECX
009a8a5c : ADD EDX,ECX
009a8a5e : SAR EDX,0x4
009a8a61 : MOV ECX,EDX
009a8a63 : SHR ECX,0x1f
009a8a66 : ADD ECX,EDX
009a8a68 : CMP ECX,0x2
009a8a6b : JC 0x009a89bd
009a8a71 : CMP dword ptr [EDI + 0x34],0x8
009a8a75 : JC 0x009a8a8a
009a8a77 : MOV EAX,dword ptr [EDI + 0x20]
009a8a7a : PUSH EAX
009a8a7b : CALL 0x00634f4d
009a8a80 : ADD ESP,0x4
009a8a83 : PUSH 0x0
009a8a85 : JMP 0x009a8b1a
009a8a8a : LEA EAX,[EDI + 0x20]
009a8a8d : PUSH EAX
009a8a8e : CALL 0x00634f4d
009a8a93 : ADD ESP,0x4
009a8a96 : PUSH 0x0
009a8a98 : JMP 0x009a8b1a
009a8a9d : CMP EBX,0x8
009a8aa0 : JC 0x009a8aa6
009a8aa2 : MOV EAX,dword ptr [ESI]
009a8aa4 : JMP 0x009a8aa8
009a8aa6 : MOV EAX,ESI
009a8aa8 : MOV ECX,0xc8a574
009a8aad : LEA ECX,[ECX]
009a8ab0 : MOV DX,word ptr [EAX]
009a8ab3 : CMP DX,word ptr [ECX]
009a8ab6 : JNZ 0x009a8ad6
009a8ab8 : TEST DX,DX
009a8abb : JZ 0x009a8ad2
009a8abd : MOV DX,word ptr [EAX + 0x2]
009a8ac1 : CMP DX,word ptr [ECX + 0x2]
009a8ac5 : JNZ 0x009a8ad6
009a8ac7 : ADD EAX,0x4
009a8aca : ADD ECX,0x4
009a8acd : TEST DX,DX
009a8ad0 : JNZ 0x009a8ab0
009a8ad2 : XOR EAX,EAX
009a8ad4 : JMP 0x009a8adb
009a8ad6 : SBB EAX,EAX
009a8ad8 : SBB EAX,-0x1
009a8adb : TEST EAX,EAX
009a8add : JNZ 0x009a8b26
009a8adf : MOV ECX,dword ptr [ESP + 0x1c]
009a8ae3 : SUB ECX,EDI
009a8ae5 : MOV EAX,0x92492493
009a8aea : IMUL ECX
009a8aec : ADD EDX,ECX
009a8aee : SAR EDX,0x4
009a8af1 : MOV EAX,EDX
009a8af3 : SHR EAX,0x1f
009a8af6 : ADD EAX,EDX
009a8af8 : CMP EAX,0x2
009a8afb : JC 0x009a89bd
009a8b01 : CMP dword ptr [EDI + 0x34],0x8
009a8b05 : JC 0x009a8b0c
009a8b07 : MOV EAX,dword ptr [EDI + 0x20]
009a8b0a : JMP 0x009a8b0f
009a8b0c : LEA EAX,[EDI + 0x20]
009a8b0f : PUSH EAX
009a8b10 : CALL 0x00634f4d
009a8b15 : ADD ESP,0x4
009a8b18 : PUSH 0x1
009a8b1a : MOVZX ECX,AX
009a8b1d : MOV EDX,dword ptr [ESP + 0x14]
009a8b21 : CALL 0x009a8620
009a8b26 : MOV dword ptr [ESP + 0x68],0xffffffff
009a8b2e : MOV EAX,dword ptr [ESP + 0x18]
009a8b32 : XOR ESI,ESI
009a8b34 : CMP EAX,ESI
009a8b36 : JZ 0x009a8b52
009a8b38 : MOV ECX,dword ptr [ESP + 0x10]
009a8b3c : MOV EDI,dword ptr [ESP + 0x1c]
009a8b40 : PUSH ECX
009a8b41 : CALL 0x00405450
009a8b46 : MOV ECX,dword ptr [ESP + 0x1c]
009a8b4a : ADD ESP,0x4
009a8b4d : CALL 0x006f04e0
009a8b52 : MOV dword ptr [ESP + 0x18],ESI
009a8b56 : MOV dword ptr [ESP + 0x1c],ESI
009a8b5a : MOV dword ptr [ESP + 0x20],ESI
009a8b5e : MOV ECX,dword ptr [ESP + 0x60]
009a8b62 : MOV dword ptr FS:[0x0],ECX
009a8b69 : POP ECX
009a8b6a : POP EDI
009a8b6b : POP ESI
009a8b6c : POP EBX
009a8b6d : MOV ESP,EBP
009a8b6f : POP EBP
009a8b70 : RET 0x8

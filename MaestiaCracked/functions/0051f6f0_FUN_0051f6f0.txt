PROGRAM  : Maestia.exe
FUNCTION : FUN_0051f6f0
ENTRY    : 0051f6f0
BODY     : [[0051f6f0, 0051f858]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0051f6f0(undefined4 param_1,uint param_2)

{
  int *piVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  int iVar4;
  int *in_ECX;
  int iVar5;
  int iVar6;
  float10 fVar7;
  longlong local_8;
  
  iVar5 = 0;
  if (param_2 == 0) {
    FUN_0051f5a0();
    return;
  }
  if (param_2 < 8) {
    iVar6 = 8;
  }
  else {
    fVar7 = (float10)FUN_0063b270();
    local_8 = (longlong)ROUND((float)fVar7 / 0.6931472 + 1.0);
    iVar6 = 1 << ((byte)local_8 & 0x1f);
  }
  local_8 = CONCAT44(local_8._4_4_,0x143);
  puVar3 = (undefined4 *)FUN_00515d60(param_1,iVar6 * 0xc + 8,&local_8);
  *puVar3 = 0;
  puVar3[1] = iVar6 + -1;
  if (iVar6 != 0) {
    iVar4 = 0;
    do {
      *(undefined4 *)(iVar4 + 8 + (int)puVar3) = 0xfffffffe;
      iVar4 = iVar4 + 0xc;
      iVar6 = iVar6 + -1;
    } while (iVar6 != 0);
  }
  if (*in_ECX != 0) {
    iVar6 = *(int *)(*in_ECX + 4) + 1;
    do {
      puVar2 = (undefined4 *)(iVar5 + 8 + *in_ECX);
      if (*(int *)(iVar5 + 8 + *in_ECX) != -2) {
        FUN_0051eee0(param_1,puVar2 + 1,*(undefined4 *)(puVar2[1] + 0xc));
        piVar1 = (int *)(puVar2[1] + 8);
        *piVar1 = *piVar1 + -1;
        if (*piVar1 == 0) {
          FUN_00525340();
        }
        *puVar2 = 0xfffffffe;
      }
      iVar5 = iVar5 + 0xc;
      iVar6 = iVar6 + -1;
    } while (iVar6 != 0);
    FUN_00515cf0(*in_ECX);
  }
  *in_ECX = (int)puVar3;
  FUN_0051f5a0();
  return;
}



============================================================
DISASSEMBLY
============================================================
0051f6f0 : SUB ESP,0xc
0051f6f3 : MOV EAX,dword ptr [ESP + 0x14]
0051f6f7 : PUSH EBX
0051f6f8 : PUSH EDI
0051f6f9 : XOR EBX,EBX
0051f6fb : MOV EDI,ECX
0051f6fd : MOV dword ptr [ESP + 0x8],EDI
0051f701 : CMP EAX,EBX
0051f703 : JNZ 0x0051f712
0051f705 : CALL 0x0051f5a0
0051f70a : POP EDI
0051f70b : POP EBX
0051f70c : ADD ESP,0xc
0051f70f : RET 0x8
0051f712 : PUSH ESI
0051f713 : CMP EAX,0x8
0051f716 : JNC 0x0051f71f
0051f718 : MOV ESI,0x8
0051f71d : JMP 0x0051f784
0051f71f : DEC EAX
0051f720 : MOV dword ptr [ESP + 0x20],EAX
0051f724 : FILD dword ptr [ESP + 0x20]
0051f728 : TEST EAX,EAX
0051f72a : JGE 0x0051f732
0051f72c : FADD float ptr [0x00cdf0e0]
0051f732 : CALL 0x0063b270
0051f737 : FSTP float ptr [ESP + 0x20]
0051f73b : FLD float ptr [ESP + 0x20]
0051f73f : MOV ESI,0x1
0051f744 : FDIV double ptr [0x00b85fe0]
0051f74a : FSTP float ptr [ESP + 0x20]
0051f74e : FLD float ptr [ESP + 0x20]
0051f752 : FADD double ptr [0x00cdf108]
0051f758 : FSTP float ptr [ESP + 0x20]
0051f75c : FLD float ptr [ESP + 0x20]
0051f760 : FNSTCW word ptr [ESP + 0x20]
0051f764 : MOVZX EAX,word ptr [ESP + 0x20]
0051f769 : OR EAX,0xc00
0051f76e : MOV dword ptr [ESP + 0x10],EAX
0051f772 : FLDCW word ptr [ESP + 0x10]
0051f776 : FISTP qword ptr [ESP + 0x10]
0051f77a : MOV CL,byte ptr [ESP + 0x10]
0051f77e : SHL ESI,CL
0051f780 : FLDCW word ptr [ESP + 0x20]
0051f784 : LEA EAX,[ESP + 0x10]
0051f788 : PUSH EAX
0051f789 : MOV EAX,dword ptr [ESP + 0x20]
0051f78d : LEA ECX,[ESI + ESI*0x2]
0051f790 : LEA EDX,[ECX*0x4 + 0x8]
0051f797 : PUSH EDX
0051f798 : PUSH EAX
0051f799 : MOV dword ptr [ESP + 0x2c],EBX
0051f79d : MOV dword ptr [ESP + 0x1c],0x143
0051f7a5 : CALL 0x00515d60
0051f7aa : MOV dword ptr [ESP + 0x20],EAX
0051f7ae : MOV dword ptr [EAX],EBX
0051f7b0 : MOV EDX,dword ptr [ESP + 0x20]
0051f7b4 : LEA ECX,[ESI + -0x1]
0051f7b7 : MOV dword ptr [EDX + 0x4],ECX
0051f7ba : CMP ESI,EBX
0051f7bc : JBE 0x0051f7d4
0051f7be : XOR EAX,EAX
0051f7c0 : MOV ECX,dword ptr [ESP + 0x20]
0051f7c4 : MOV dword ptr [EAX + ECX*0x1 + 0x8],0xfffffffe
0051f7cc : ADD EAX,0xc
0051f7cf : SUB ESI,0x1
0051f7d2 : JNZ 0x0051f7c0
0051f7d4 : MOV EAX,dword ptr [EDI]
0051f7d6 : CMP EAX,EBX
0051f7d8 : JZ 0x0051f839
0051f7da : MOV EAX,dword ptr [EAX + 0x4]
0051f7dd : PUSH EBP
0051f7de : LEA EBP,[EAX + 0x1]
0051f7e1 : JMP 0x0051f7e7
0051f7e3 : MOV EDI,dword ptr [ESP + 0x10]
0051f7e7 : MOV EDX,dword ptr [EDI]
0051f7e9 : CMP dword ptr [EBX + EDX*0x1 + 0x8],-0x2
0051f7ee : LEA EDI,[EBX + EDX*0x1 + 0x8]
0051f7f2 : JZ 0x0051f820
0051f7f4 : MOV EAX,dword ptr [EDI + 0x4]
0051f7f7 : MOV ECX,dword ptr [EAX + 0xc]
0051f7fa : MOV EDX,dword ptr [ESP + 0x20]
0051f7fe : LEA ESI,[EDI + 0x4]
0051f801 : PUSH ECX
0051f802 : PUSH ESI
0051f803 : PUSH EDX
0051f804 : LEA ECX,[ESP + 0x30]
0051f808 : CALL 0x0051eee0
0051f80d : MOV ECX,dword ptr [ESI]
0051f80f : ADD dword ptr [ECX + 0x8],-0x1
0051f813 : JNZ 0x0051f81a
0051f815 : CALL 0x00525340
0051f81a : MOV dword ptr [EDI],0xfffffffe
0051f820 : ADD EBX,0xc
0051f823 : SUB EBP,0x1
0051f826 : JNZ 0x0051f7e3
0051f828 : MOV EAX,dword ptr [ESP + 0x10]
0051f82c : MOV ECX,dword ptr [EAX]
0051f82e : PUSH ECX
0051f82f : CALL 0x00515cf0
0051f834 : MOV EDI,dword ptr [ESP + 0x10]
0051f838 : POP EBP
0051f839 : MOV EDX,dword ptr [ESP + 0x20]
0051f83d : LEA ECX,[ESP + 0x20]
0051f841 : MOV dword ptr [EDI],EDX
0051f843 : MOV dword ptr [ESP + 0x20],0x0
0051f84b : CALL 0x0051f5a0
0051f850 : POP ESI
0051f851 : POP EDI
0051f852 : POP EBX
0051f853 : ADD ESP,0xc
0051f856 : RET 0x8

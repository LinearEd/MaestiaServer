PROGRAM  : Maestia.exe
FUNCTION : FUN_008fab70
ENTRY    : 008fab70
BODY     : [[008fab70, 008fadc9]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008fab70(int param_1)

{
  undefined1 uVar1;
  int iVar2;
  int iVar3;
  int *in_ECX;
  undefined1 local_150 [4];
  undefined2 local_14c;
  undefined4 local_13c;
  undefined4 local_138;
  int local_120;
  char local_118 [256];
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b6886d;
  local_10 = ExceptionList;
  local_18 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if ((in_ECX != (int *)0x0) && (iVar2 = (**(code **)(*in_ECX + 0x20))(), iVar2 == 2)) {
    iVar2 = FUN_004049b0();
    iVar3 = FUN_008413b0();
    if ((iVar2 != 0) && (iVar3 != 0)) {
      FUN_00406460();
      if ((ushort)(*(byte *)(iVar3 + 0xb) + 1) <= (ushort)*(byte *)(iVar3 + 10)) {
        local_138 = 7;
        local_13c = 0;
        local_14c = 0;
        local_8._0_1_ = 1;
        local_8._1_3_ = 0;
        FUN_008faa90();
        FUN_0081cbe0();
        local_8._0_1_ = 2;
        uVar1 = (undefined1)local_8;
        local_8._0_1_ = 2;
        if (local_120 == 0) {
          FUN_00404350();
          local_8._0_1_ = 3;
          FUN_00405eb0();
          local_8._0_1_ = 2;
          FUN_00406560();
          uVar1 = (undefined1)local_8;
        }
        local_8._0_1_ = uVar1;
        _sprintf_s(local_118,0x100,"(%S)");
        *(char **)(param_1 + 0x14) = local_118;
        FUN_008f9b20();
        FUN_00405660(local_150);
        local_8._0_1_ = 2;
        FUN_008f75f0();
        local_8._0_1_ = 5;
        iVar2 = *DAT_00da9894;
        if ((iVar2 != 0) && (*(int *)(iVar2 + 0x114) != 0)) {
          (**(code **)(**(int **)(iVar2 + 0x114) + 4))();
        }
        local_8._0_1_ = 2;
        FUN_00406560();
        local_8._0_1_ = 1;
        FUN_00406560();
        local_8 = (uint)local_8._1_3_ << 8;
        FUN_00406560();
      }
      local_8 = 0xffffffff;
      FUN_00406560();
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008fab70 : PUSH EBP
008fab71 : MOV EBP,ESP
008fab73 : PUSH -0x1
008fab75 : PUSH 0xb6886d
008fab7a : MOV EAX,FS:[0x0]
008fab80 : PUSH EAX
008fab81 : SUB ESP,0x198
008fab87 : MOV EAX,[0x00d66fa0]
008fab8c : XOR EAX,EBP
008fab8e : MOV dword ptr [EBP + -0x14],EAX
008fab91 : PUSH EBX
008fab92 : PUSH ESI
008fab93 : PUSH EDI
008fab94 : PUSH EAX
008fab95 : LEA EAX,[EBP + -0xc]
008fab98 : MOV FS:[0x0],EAX
008fab9e : MOV EAX,dword ptr [EBP + 0x8]
008faba1 : MOV ESI,ECX
008faba3 : MOV dword ptr [EBP + 0xfffffe78],EAX
008faba9 : TEST ESI,ESI
008fabab : JZ 0x008fadac
008fabb1 : MOV EDX,dword ptr [ESI]
008fabb3 : MOV EAX,dword ptr [EDX + 0x20]
008fabb6 : CALL EAX
008fabb8 : CMP EAX,0x2
008fabbb : JNZ 0x008fadac
008fabc1 : MOV EDI,dword ptr [ESI + 0x10]
008fabc4 : PUSH EDI
008fabc5 : CALL 0x004049b0
008fabca : MOV ECX,dword ptr [0x01724910]
008fabd0 : ADD ESP,0x4
008fabd3 : PUSH -0x1
008fabd5 : PUSH EDI
008fabd6 : MOV EBX,EAX
008fabd8 : CALL 0x008413b0
008fabdd : MOV EDI,EAX
008fabdf : TEST EBX,EBX
008fabe1 : JZ 0x008fadac
008fabe7 : TEST EDI,EDI
008fabe9 : JZ 0x008fadac
008fabef : PUSH 0xc618bc
008fabf4 : LEA ECX,[EBP + 0xfffffe7c]
008fabfa : CALL 0x00406460
008fabff : XOR EBX,EBX
008fac01 : MOV dword ptr [EBP + -0x4],EBX
008fac04 : MOVZX CX,byte ptr [EDI + 0xb]
008fac09 : MOVZX DX,byte ptr [EDI + 0xa]
008fac0e : INC CX
008fac10 : MOVZX ECX,CX
008fac13 : CMP DX,CX
008fac16 : JC 0x008fad9a
008fac1c : XOR EAX,EAX
008fac1e : MOV dword ptr [EBP + 0xfffffecc],0x7
008fac28 : MOV dword ptr [EBP + 0xfffffec8],EBX
008fac2e : MOV word ptr [EBP + 0xfffffeb8],AX
008fac35 : MOV byte ptr [EBP + -0x4],0x1
008fac39 : MOV ESI,dword ptr [ESI + 0x10]
008fac3c : LEA EDI,[EBP + 0xfffffeb4]
008fac42 : LEA EDX,[EBP + 0xfffffe7c]
008fac48 : CALL 0x008faa90
008fac4d : MOV ECX,dword ptr [0x0172491c]
008fac53 : PUSH ECX
008fac54 : MOV ECX,0xc618c0
008fac59 : LEA ESI,[EBP + 0xfffffed0]
008fac5f : CALL 0x0081cbe0
008fac64 : MOV byte ptr [EBP + -0x4],0x2
008fac68 : CMP dword ptr [EBP + 0xfffffee4],EBX
008fac6e : JNZ 0x008faca1
008fac70 : PUSH 0xc618c8
008fac75 : LEA ESI,[EBP + 0xfffffe5c]
008fac7b : CALL 0x00404350
008fac80 : ADD ESP,0x4
008fac83 : MOV byte ptr [EBP + -0x4],0x3
008fac87 : PUSH -0x1
008fac89 : PUSH EBX
008fac8a : PUSH EAX
008fac8b : LEA ECX,[EBP + 0xfffffed0]
008fac91 : CALL 0x00405eb0
008fac96 : MOV byte ptr [EBP + -0x4],0x2
008fac9a : MOV ECX,ESI
008fac9c : CALL 0x00406560
008faca1 : CMP dword ptr [EBP + 0xfffffee8],0x8
008faca8 : MOV EAX,dword ptr [EBP + 0xfffffed4]
008facae : JNC 0x008facb6
008facb0 : LEA EAX,[EBP + 0xfffffed4]
008facb6 : PUSH EAX
008facb7 : PUSH 0xc618d0
008facbc : LEA EDX,[EBP + 0xfffffeec]
008facc2 : PUSH 0x100
008facc7 : PUSH EDX
008facc8 : CALL 0x00637e58
008faccd : MOV ECX,dword ptr [EBP + 0x10]
008facd0 : MOV ESI,dword ptr [EBP + 0xfffffe78]
008facd6 : MOV EDI,dword ptr [EBP + 0xc]
008facd9 : ADD ESP,0x10
008facdc : PUSH ECX
008facdd : PUSH 0x3
008facdf : LEA EDX,[EBP + 0xfffffe7c]
008face5 : LEA EAX,[EBP + 0xfffffeec]
008faceb : PUSH EDX
008facec : MOV ECX,EDI
008facee : MOV dword ptr [ESI + 0x14],EAX
008facf1 : CALL 0x008f9b20
008facf6 : SUB ESP,0x1c
008facf9 : LEA EAX,[EBP + 0xfffffeb4]
008facff : MOV ECX,ESP
008fad01 : MOV dword ptr [EBP + 0xfffffe78],ESP
008fad07 : PUSH EAX
008fad08 : CALL 0x00405660
008fad0d : MOV byte ptr [EBP + -0x4],0x4
008fad11 : MOV byte ptr [EBP + -0x4],0x2
008fad15 : LEA ECX,[EBP + 0xfffffe98]
008fad1b : CALL 0x008f75f0
008fad20 : ADD ESP,0x1c
008fad23 : MOV byte ptr [EBP + -0x4],0x5
008fad27 : MOV ECX,dword ptr [0x00da9894]
008fad2d : MOV EAX,dword ptr [ECX]
008fad2f : CMP EAX,EBX
008fad31 : JZ 0x008fad6d
008fad33 : CMP dword ptr [EAX + 0x114],EBX
008fad39 : JZ 0x008fad6d
008fad3b : CMP dword ptr [EBP + 0xfffffeb0],0x8
008fad42 : MOV EAX,dword ptr [EAX + 0x114]
008fad48 : MOV ECX,dword ptr [EBP + 0xfffffe9c]
008fad4e : JNC 0x008fad56
008fad50 : LEA ECX,[EBP + 0xfffffe9c]
008fad56 : MOV EDX,dword ptr [EAX]
008fad58 : PUSH EDI
008fad59 : PUSH ECX
008fad5a : PUSH 0xc618d8
008fad5f : PUSH 0xc618e0
008fad64 : PUSH EAX
008fad65 : MOV EAX,dword ptr [EDX + 0x4]
008fad68 : CALL EAX
008fad6a : ADD ESP,0x14
008fad6d : MOV byte ptr [EBP + -0x4],0x2
008fad71 : LEA ECX,[EBP + 0xfffffe98]
008fad77 : CALL 0x00406560
008fad7c : MOV byte ptr [EBP + -0x4],0x1
008fad80 : LEA ECX,[EBP + 0xfffffed0]
008fad86 : CALL 0x00406560
008fad8b : MOV byte ptr [EBP + -0x4],0x0
008fad8f : LEA ECX,[EBP + 0xfffffeb4]
008fad95 : CALL 0x00406560
008fad9a : MOV dword ptr [EBP + -0x4],0xffffffff
008fada1 : LEA ECX,[EBP + 0xfffffe7c]
008fada7 : CALL 0x00406560
008fadac : MOV ECX,dword ptr [EBP + -0xc]
008fadaf : MOV dword ptr FS:[0x0],ECX
008fadb6 : POP ECX
008fadb7 : POP EDI
008fadb8 : POP ESI
008fadb9 : POP EBX
008fadba : MOV ECX,dword ptr [EBP + -0x14]
008fadbd : XOR ECX,EBP
008fadbf : CALL 0x00633e6b
008fadc4 : MOV ESP,EBP
008fadc6 : POP EBP
008fadc7 : RET 0xc

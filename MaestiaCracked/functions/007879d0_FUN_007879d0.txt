PROGRAM  : Maestia.exe
FUNCTION : FUN_007879d0
ENTRY    : 007879d0
BODY     : [[007879d0, 00787b02]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_007879d0(int param_1,int param_2,uint param_3,int param_4)

{
  int iVar1;
  uint uVar2;
  int *in_ECX;
  undefined4 uVar3;
  undefined4 uVar4;
  
  uVar2 = in_ECX[9];
  if ((uVar2 != 0) && (*(int *)(uVar2 + 0xf0) != 0)) {
    (**(code **)(*in_ECX + 0x3c))();
    if (param_3 == 1) {
      in_ECX[7] = 0x15;
    }
    else if (param_3 == 2) {
      in_ECX[7] = 0x15;
    }
    else {
      uVar2 = param_3;
      if (param_3 != 9) goto LAB_00787afc;
      in_ECX[7] = *(int *)(in_ECX[9] + 0x108);
    }
    in_ECX[0xb] = param_2;
    in_ECX[10] = param_1;
    *(undefined1 *)(in_ECX + 8) = *(undefined1 *)(in_ECX[9] + 0x289);
    while( true ) {
      iVar1 = in_ECX[9];
      if ((*(char *)(iVar1 + 0x289) == '\0') || (*(char *)(iVar1 + 0x28a) != '\0')) {
        uVar4 = 0;
      }
      else {
        uVar4 = 1;
      }
      if (((*(char *)(iVar1 + 0x289) == '\0') && (*(char *)(iVar1 + 0x288) != '\0')) ||
         (*(char *)(iVar1 + 0x28a) != '\0')) {
        uVar3 = 0x200;
      }
      else {
        uVar3 = 0;
      }
      iVar1 = (**(code **)(**(int **)(iVar1 + 0xf0) + 0x5c))
                        (*(int **)(iVar1 + 0xf0),param_1,param_2,param_4 + 1,uVar3,in_ECX[7],uVar4,
                         in_ECX + 0x12,0);
      if (iVar1 == 0) break;
      uVar2 = in_ECX[7];
      if (uVar2 == 0x1c) {
        *(undefined4 *)(in_ECX[9] + 0x108) = 0x33;
        in_ECX[7] = 0x33;
      }
      else {
        if (uVar2 != 0x33) {
          return uVar2 & 0xffffff00;
        }
        *(undefined4 *)(in_ECX[9] + 0x108) = 0x1a;
        in_ECX[7] = 0x1a;
      }
    }
    return 1;
  }
LAB_00787afc:
  return uVar2 & 0xffffff00;
}



============================================================
DISASSEMBLY
============================================================
007879d0 : PUSH EBP
007879d1 : MOV EBP,ESP
007879d3 : PUSH ESI
007879d4 : MOV ESI,ECX
007879d6 : MOV EAX,dword ptr [ESI + 0x24]
007879d9 : TEST EAX,EAX
007879db : JZ 0x00787afc
007879e1 : CMP dword ptr [EAX + 0xf0],0x0
007879e8 : JZ 0x00787afc
007879ee : MOV EAX,dword ptr [ESI]
007879f0 : MOV EDX,dword ptr [EAX + 0x3c]
007879f3 : CALL EDX
007879f5 : MOV EAX,dword ptr [EBP + 0x10]
007879f8 : CMP EAX,0x1
007879fb : JNZ 0x00787a06
007879fd : MOV dword ptr [ESI + 0x1c],0x15
00787a04 : JMP 0x00787a29
00787a06 : CMP EAX,0x2
00787a09 : JNZ 0x00787a14
00787a0b : MOV dword ptr [ESI + 0x1c],0x15
00787a12 : JMP 0x00787a29
00787a14 : CMP EAX,0x9
00787a17 : JNZ 0x00787afc
00787a1d : MOV EAX,dword ptr [ESI + 0x24]
00787a20 : MOV ECX,dword ptr [EAX + 0x108]
00787a26 : MOV dword ptr [ESI + 0x1c],ECX
00787a29 : MOV EAX,dword ptr [EBP + 0xc]
00787a2c : MOV EDX,dword ptr [EBP + 0x8]
00787a2f : MOV ECX,dword ptr [ESI + 0x24]
00787a32 : MOV dword ptr [ESI + 0x2c],EAX
00787a35 : MOV EAX,dword ptr [EBP + 0x14]
00787a38 : PUSH EDI
00787a39 : MOV dword ptr [ESI + 0x28],EDX
00787a3c : MOV DL,byte ptr [ECX + 0x289]
00787a42 : INC EAX
00787a43 : MOV byte ptr [ESI + 0x20],DL
00787a46 : LEA EDI,[ESI + 0x48]
00787a49 : MOV dword ptr [EBP + 0x10],EAX
00787a4c : PUSH EBX
00787a4d : LEA ECX,[ECX]
00787a50 : MOV EAX,dword ptr [ESI + 0x24]
00787a53 : MOV CL,byte ptr [EAX + 0x289]
00787a59 : TEST CL,CL
00787a5b : JZ 0x00787a6d
00787a5d : CMP byte ptr [EAX + 0x28a],0x0
00787a64 : JNZ 0x00787a6d
00787a66 : MOV EDX,0x1
00787a6b : JMP 0x00787a6f
00787a6d : XOR EDX,EDX
00787a6f : TEST CL,CL
00787a71 : JNZ 0x00787a7b
00787a73 : CMP byte ptr [EAX + 0x288],CL
00787a79 : JNZ 0x00787a88
00787a7b : CMP byte ptr [EAX + 0x28a],0x0
00787a82 : JNZ 0x00787a88
00787a84 : XOR ECX,ECX
00787a86 : JMP 0x00787a8d
00787a88 : MOV ECX,0x200
00787a8d : MOV EAX,dword ptr [EAX + 0xf0]
00787a93 : MOV EBX,dword ptr [EAX]
00787a95 : PUSH 0x0
00787a97 : PUSH EDI
00787a98 : PUSH EDX
00787a99 : MOV EDX,dword ptr [ESI + 0x1c]
00787a9c : PUSH EDX
00787a9d : MOV EDX,dword ptr [EBP + 0xc]
00787aa0 : PUSH ECX
00787aa1 : MOV ECX,dword ptr [EBP + 0x10]
00787aa4 : PUSH ECX
00787aa5 : MOV ECX,dword ptr [EBP + 0x8]
00787aa8 : PUSH EDX
00787aa9 : MOV EDX,dword ptr [EBX + 0x5c]
00787aac : PUSH ECX
00787aad : PUSH EAX
00787aae : CALL EDX
00787ab0 : TEST EAX,EAX
00787ab2 : JZ 0x00787af3
00787ab4 : MOV EAX,dword ptr [ESI + 0x1c]
00787ab7 : CMP EAX,0x1c
00787aba : JNZ 0x00787acf
00787abc : MOV ECX,dword ptr [ESI + 0x24]
00787abf : MOV EAX,0x33
00787ac4 : MOV dword ptr [ECX + 0x108],EAX
00787aca : MOV dword ptr [ESI + 0x1c],EAX
00787acd : JMP 0x00787a50
00787acf : CMP EAX,0x33
00787ad2 : JNZ 0x00787aea
00787ad4 : MOV EDX,dword ptr [ESI + 0x24]
00787ad7 : MOV EAX,0x1a
00787adc : MOV dword ptr [EDX + 0x108],EAX
00787ae2 : MOV dword ptr [ESI + 0x1c],EAX
00787ae5 : JMP 0x00787a50
00787aea : POP EBX
00787aeb : POP EDI
00787aec : XOR AL,AL
00787aee : POP ESI
00787aef : POP EBP
00787af0 : RET 0x10
00787af3 : POP EBX
00787af4 : POP EDI
00787af5 : MOV AL,0x1
00787af7 : POP ESI
00787af8 : POP EBP
00787af9 : RET 0x10
00787afc : XOR AL,AL
00787afe : POP ESI
00787aff : POP EBP
00787b00 : RET 0x10

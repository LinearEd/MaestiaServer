PROGRAM  : Maestia.exe
FUNCTION : FUN_0087c380
ENTRY    : 0087c380
BODY     : [[0087c380, 0087c521]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0087c380(int param_1,char param_2)

{
  int *piVar1;
  int *piVar2;
  code *pcVar3;
  undefined4 *puVar4;
  int iVar5;
  
  iVar5 = DAT_00da93ec;
  if (DAT_00da93ec != 0) {
    piVar1 = *(int **)(DAT_00da93ec + 0xac);
    piVar2 = *(int **)(DAT_00da93ec + 0x74);
    if ((piVar1 != (int *)0x0) && (piVar2 != (int *)0x0)) {
      *(undefined1 *)(DAT_00da93ec + 0x219) = 0;
      *(undefined1 *)(iVar5 + 0x21a) = 0;
      *(undefined1 *)(param_1 + 0x68) = 0;
      *(undefined1 *)(param_1 + 0x6a) = 0;
      if (param_2 != '\0') {
        FUN_00a09fa0(300);
      }
      (**(code **)(*piVar2 + 0x3c))();
      if ((char)piVar1[0x7e9] != '\0') {
        pcVar3 = *(code **)(*piVar1 + 0x2a0);
        *(undefined1 *)(piVar1 + 0x7e9) = 0;
        (*pcVar3)(piVar1 + 0x7ea,1);
        FUN_0040e4f0();
      }
      *(undefined1 *)((int)piVar1 + 0x198d) = 0;
      FUN_00854ed0(piVar1,1);
      if (((float)piVar2[0x82] == (float)piVar2[0x7d]) && (*(char *)(DAT_00da93ec + 0x533) != '\0'))
      {
        (**(code **)(*piVar1 + 0x4ac))(1);
      }
      if ((*DAT_00da9894 != 0) &&
         (puVar4 = *(undefined4 **)(*DAT_00da9894 + 0x114), puVar4 != (undefined4 *)0x0)) {
        (**(code **)*puVar4)("NpcTalkBGClose");
      }
      if ((*DAT_00da9894 != 0) && (piVar1 = *(int **)(*DAT_00da9894 + 0x114), piVar1 != (int *)0x0))
      {
        (**(code **)(*piVar1 + 4))(piVar1,"IsVisible",&DAT_00c43a24,2);
      }
      if (((*(int *)(DAT_0172491c + 0x17c) != 0) &&
          (*(int *)(*(int *)(DAT_0172491c + 0x17c) + 0x1f54) != 0)) &&
         (*(int *)(*DAT_00da9894 + 0x14c) != 0)) {
        FUN_00a954c0();
      }
      FUN_008ed630(*DAT_00da9894);
      piVar1 = DAT_00da9894;
      *(undefined4 *)(DAT_0172490c + 0x58) = 0;
      FUN_00934cf0(*(undefined4 *)(*piVar1 + 0x174));
      *(undefined4 *)(param_1 + 0x54) = 4;
      *(undefined4 *)(param_1 + 0x58) = 7;
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
0087c380 : PUSH EBP
0087c381 : MOV EBP,ESP
0087c383 : PUSH ECX
0087c384 : MOV EAX,[0x00da93ec]
0087c389 : PUSH EBX
0087c38a : PUSH ESI
0087c38b : PUSH EDI
0087c38c : TEST EAX,EAX
0087c38e : JZ 0x0087c519
0087c394 : MOV EBX,dword ptr [EAX + 0xac]
0087c39a : MOV ESI,dword ptr [EAX + 0x74]
0087c39d : MOV dword ptr [EBP + -0x4],ESI
0087c3a0 : TEST EBX,EBX
0087c3a2 : JZ 0x0087c519
0087c3a8 : TEST ESI,ESI
0087c3aa : JZ 0x0087c519
0087c3b0 : CMP byte ptr [EBP + 0xc],0x0
0087c3b4 : MOV EDI,dword ptr [EBP + 0x8]
0087c3b7 : MOV byte ptr [EAX + 0x219],0x0
0087c3be : MOV byte ptr [EAX + 0x21a],0x0
0087c3c5 : MOV byte ptr [EDI + 0x68],0x0
0087c3c9 : MOV byte ptr [EDI + 0x6a],0x0
0087c3cd : JZ 0x0087c3ea
0087c3cf : MOV ESI,dword ptr [0x017247e4]
0087c3d5 : PUSH 0x12c
0087c3da : MOV EDI,0x1
0087c3df : CALL 0x00a09fa0
0087c3e4 : MOV EDI,dword ptr [EBP + 0x8]
0087c3e7 : MOV ESI,dword ptr [EBP + -0x4]
0087c3ea : MOV EAX,dword ptr [ESI]
0087c3ec : MOV EDX,dword ptr [EAX + 0x3c]
0087c3ef : MOV ECX,ESI
0087c3f1 : CALL EDX
0087c3f3 : CMP byte ptr [EBX + 0x1fa4],0x0
0087c3fa : JZ 0x0087c41f
0087c3fc : MOV EAX,dword ptr [EBX]
0087c3fe : MOV EDX,dword ptr [EAX + 0x2a0]
0087c404 : PUSH 0x1
0087c406 : LEA ECX,[EBX + 0x1fa8]
0087c40c : PUSH ECX
0087c40d : MOV ECX,EBX
0087c40f : MOV byte ptr [EBX + 0x1fa4],0x0
0087c416 : CALL EDX
0087c418 : MOV ECX,EBX
0087c41a : CALL 0x0040e4f0
0087c41f : PUSH 0x1
0087c421 : PUSH EBX
0087c422 : MOV byte ptr [EBX + 0x198d],0x0
0087c429 : CALL 0x00854ed0
0087c42e : MOVSS XMM0,dword ptr [ESI + 0x208]
0087c436 : UCOMISS XMM0,dword ptr [ESI + 0x1f4]
0087c43d : LAHF
0087c43e : TEST AH,0x44
0087c441 : JP 0x0087c45f
0087c443 : MOV EAX,[0x00da93ec]
0087c448 : CMP byte ptr [EAX + 0x533],0x0
0087c44f : JZ 0x0087c45f
0087c451 : MOV EDX,dword ptr [EBX]
0087c453 : MOV EAX,dword ptr [EDX + 0x4ac]
0087c459 : PUSH 0x1
0087c45b : MOV ECX,EBX
0087c45d : CALL EAX
0087c45f : MOV ECX,dword ptr [0x00da9894]
0087c465 : MOV EAX,dword ptr [ECX]
0087c467 : TEST EAX,EAX
0087c469 : JZ 0x0087c480
0087c46b : MOV ECX,dword ptr [EAX + 0x114]
0087c471 : TEST ECX,ECX
0087c473 : JZ 0x0087c480
0087c475 : MOV EDX,dword ptr [ECX]
0087c477 : MOV EAX,dword ptr [EDX]
0087c479 : PUSH 0xc43a14
0087c47e : CALL EAX
0087c480 : MOV ECX,dword ptr [0x00da9894]
0087c486 : MOV EAX,dword ptr [ECX]
0087c488 : TEST EAX,EAX
0087c48a : JZ 0x0087c4ad
0087c48c : MOV EAX,dword ptr [EAX + 0x114]
0087c492 : TEST EAX,EAX
0087c494 : JZ 0x0087c4ad
0087c496 : MOV EDX,dword ptr [EAX]
0087c498 : PUSH 0x2
0087c49a : PUSH 0xc43a24
0087c49f : PUSH 0xc43a28
0087c4a4 : PUSH EAX
0087c4a5 : MOV EAX,dword ptr [EDX + 0x4]
0087c4a8 : CALL EAX
0087c4aa : ADD ESP,0x10
0087c4ad : MOV ECX,dword ptr [0x0172491c]
0087c4b3 : MOV EAX,dword ptr [ECX + 0x17c]
0087c4b9 : TEST EAX,EAX
0087c4bb : JZ 0x0087c4dd
0087c4bd : CMP dword ptr [EAX + 0x1f54],0x0
0087c4c4 : JZ 0x0087c4dd
0087c4c6 : MOV EDX,dword ptr [0x00da9894]
0087c4cc : MOV EAX,dword ptr [EDX]
0087c4ce : MOV ECX,dword ptr [EAX + 0x14c]
0087c4d4 : TEST ECX,ECX
0087c4d6 : JZ 0x0087c4dd
0087c4d8 : CALL 0x00a954c0
0087c4dd : MOV ECX,dword ptr [0x00da9894]
0087c4e3 : MOV EDX,dword ptr [ECX]
0087c4e5 : PUSH EDX
0087c4e6 : CALL 0x008ed630
0087c4eb : MOV EAX,[0x0172490c]
0087c4f0 : MOV ECX,dword ptr [0x00da9894]
0087c4f6 : MOV dword ptr [EAX + 0x58],0x0
0087c4fd : MOV EDX,dword ptr [ECX]
0087c4ff : MOV EAX,dword ptr [EDX + 0x174]
0087c505 : PUSH EAX
0087c506 : CALL 0x00934cf0
0087c50b : MOV dword ptr [EDI + 0x54],0x4
0087c512 : MOV dword ptr [EDI + 0x58],0x7
0087c519 : POP EDI
0087c51a : POP ESI
0087c51b : POP EBX
0087c51c : MOV ESP,EBP
0087c51e : POP EBP
0087c51f : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_007afaa0
ENTRY    : 007afaa0
BODY     : [[007afaa0, 007afc3c]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_007afaa0(undefined4 param_1,undefined2 *param_2)

{
  ushort uVar1;
  char cVar2;
  uint uVar3;
  undefined4 uVar4;
  int iVar5;
  ushort uVar6;
  uint uVar7;
  int iVar8;
  undefined4 *unaff_EDI;
  undefined1 local_38 [4];
  undefined4 *local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined1 local_28 [4];
  undefined2 *local_24;
  undefined4 local_20;
  undefined4 local_1c;
  uint local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  puStack_c = &LAB_00b43507;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_34 = (undefined4 *)0x0;
  local_30 = 0;
  local_2c = 0;
  local_24 = (undefined2 *)0x0;
  local_20 = 0;
  local_1c = 0;
  local_8._0_1_ = 1;
  local_8._1_3_ = 0;
  local_14 = 0;
  FUN_004452d0(local_38,0,0x20,&local_14);
  local_14 = 0;
  FUN_0041c730(local_28,0,&local_14);
  local_14 = 0;
  cVar2 = FUN_007aebd0(*unaff_EDI,unaff_EDI[2],&local_14,local_38,local_28);
  if ((cVar2 == '\0') || (local_14 == 0)) {
    local_8 = (uint)local_8._1_3_ << 8;
    if (local_24 != (undefined2 *)0x0) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0(uVar3);
    }
    local_24 = (undefined2 *)0x0;
    local_20 = 0;
    local_1c = 0;
    local_8 = 0xffffffff;
    if (local_34 != (undefined4 *)0x0) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0(uVar3);
    }
    uVar4 = 0;
  }
  else {
    if (local_14 < 2) {
      unaff_EDI[1] = *local_34;
      *param_2 = *local_24;
    }
    else {
      iVar8 = 0;
      uVar6 = 0xffff;
      param_1 = -1;
      uVar7 = (int)((float)unaff_EDI[1] + 32767.0) & 0xffff;
      iVar5 = -1;
      if (0 < local_14) {
        do {
          iVar5 = (ushort)local_24[iVar8] - uVar7;
          uVar1 = (ushort)(iVar5 >> 0x1f);
          uVar1 = ((ushort)iVar5 ^ uVar1) - uVar1;
          if (uVar1 < uVar6) {
            uVar6 = uVar1;
            param_1 = iVar8;
          }
          iVar8 = iVar8 + 1;
          iVar5 = param_1;
          local_18 = uVar7;
        } while (iVar8 < local_14);
      }
      unaff_EDI[1] = local_34[iVar5];
      *param_2 = local_24[iVar5];
    }
    local_8 = (uint)local_8._1_3_ << 8;
    if (local_24 != (undefined2 *)0x0) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0(uVar3);
    }
    local_24 = (undefined2 *)0x0;
    local_20 = 0;
    local_1c = 0;
    local_8 = 0xffffffff;
    if (local_34 != (undefined4 *)0x0) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0(uVar3);
    }
    uVar4 = 1;
  }
  ExceptionList = local_10;
  return uVar4;
}



============================================================
DISASSEMBLY
============================================================
007afaa0 : PUSH EBP
007afaa1 : MOV EBP,ESP
007afaa3 : PUSH -0x1
007afaa5 : PUSH 0xb43507
007afaaa : MOV EAX,FS:[0x0]
007afab0 : PUSH EAX
007afab1 : SUB ESP,0x28
007afab4 : PUSH EBX
007afab5 : PUSH ESI
007afab6 : MOV EAX,[0x00d66fa0]
007afabb : XOR EAX,EBP
007afabd : PUSH EAX
007afabe : LEA EAX,[EBP + -0xc]
007afac1 : MOV FS:[0x0],EAX
007afac7 : XOR EBX,EBX
007afac9 : MOV dword ptr [EBP + -0x30],EBX
007afacc : MOV dword ptr [EBP + -0x2c],EBX
007afacf : MOV dword ptr [EBP + -0x28],EBX
007afad2 : MOV dword ptr [EBP + -0x4],EBX
007afad5 : MOV dword ptr [EBP + -0x20],EBX
007afad8 : MOV dword ptr [EBP + -0x1c],EBX
007afadb : MOV dword ptr [EBP + -0x18],EBX
007afade : MOV byte ptr [EBP + -0x4],0x1
007afae2 : XORPS XMM0,XMM0
007afae5 : LEA ECX,[EBP + -0x10]
007afae8 : PUSH ECX
007afae9 : PUSH 0x20
007afaeb : XOR EAX,EAX
007afaed : PUSH EAX
007afaee : LEA EDX,[EBP + -0x34]
007afaf1 : PUSH EDX
007afaf2 : MOVSS dword ptr [EBP + -0x10],XMM0
007afaf7 : CALL 0x004452d0
007afafc : LEA ECX,[EBP + -0x10]
007afaff : PUSH ECX
007afb00 : XOR EAX,EAX
007afb02 : PUSH EAX
007afb03 : LEA EDX,[EBP + -0x24]
007afb06 : PUSH EDX
007afb07 : LEA ECX,[EBX + 0x20]
007afb0a : MOV dword ptr [EBP + -0x10],EBX
007afb0d : CALL 0x0041c730
007afb12 : FLD float ptr [EDI + 0x8]
007afb15 : LEA EAX,[EBP + -0x24]
007afb18 : PUSH EAX
007afb19 : LEA ECX,[EBP + -0x34]
007afb1c : PUSH ECX
007afb1d : MOV ECX,dword ptr [EBP + 0x8]
007afb20 : LEA EDX,[EBP + -0x10]
007afb23 : PUSH EDX
007afb24 : SUB ESP,0x8
007afb27 : FSTP float ptr [ESP + 0x4]
007afb2b : MOV dword ptr [EBP + -0x10],EBX
007afb2e : FLD float ptr [EDI]
007afb30 : FSTP float ptr [ESP]
007afb33 : CALL 0x007aebd0
007afb38 : TEST AL,AL
007afb3a : JNZ 0x007afb6e
007afb3c : MOV byte ptr [EBP + -0x4],BL
007afb3f : MOV ECX,dword ptr [EBP + -0x20]
007afb42 : CMP ECX,EBX
007afb44 : JZ 0x007afb4b
007afb46 : CALL 0x006f04e0
007afb4b : MOV dword ptr [EBP + -0x20],EBX
007afb4e : MOV dword ptr [EBP + -0x1c],EBX
007afb51 : MOV dword ptr [EBP + -0x18],EBX
007afb54 : MOV dword ptr [EBP + -0x4],0xffffffff
007afb5b : MOV ECX,dword ptr [EBP + -0x30]
007afb5e : CMP ECX,EBX
007afb60 : JZ 0x007afb67
007afb62 : CALL 0x006f04e0
007afb67 : XOR AL,AL
007afb69 : JMP 0x007afc21
007afb6e : MOV EAX,dword ptr [EBP + -0x10]
007afb71 : CMP EAX,EBX
007afb73 : JZ 0x007afb3c
007afb75 : CMP EAX,0x1
007afb78 : JG 0x007afb90
007afb7a : MOV ESI,dword ptr [EBP + -0x30]
007afb7d : FLD float ptr [ESI]
007afb7f : MOV ECX,dword ptr [EBP + -0x20]
007afb82 : MOV EDX,dword ptr [EBP + 0xc]
007afb85 : FSTP float ptr [EDI + 0x4]
007afb88 : MOV AX,word ptr [ECX]
007afb8b : MOV word ptr [EDX],AX
007afb8e : JMP 0x007afbf8
007afb90 : MOVSS XMM0,dword ptr [EDI + 0x4]
007afb95 : ADDSS XMM0,dword ptr [0x00cdf18c]
007afb9d : OR EAX,0xffffffff
007afba0 : XOR ESI,ESI
007afba2 : CMP dword ptr [EBP + -0x10],EBX
007afba5 : CVTTSS2SI EDX,XMM0
007afba9 : MOV ECX,0xffff
007afbae : MOV dword ptr [EBP + 0x8],EAX
007afbb1 : MOVZX EDX,DX
007afbb4 : JLE 0x007afbe2
007afbb6 : MOVZX EAX,DX
007afbb9 : MOV dword ptr [EBP + -0x14],EAX
007afbbc : MOV EDX,dword ptr [EBP + -0x20]
007afbbf : MOVZX EAX,word ptr [EDX + ESI*0x2]
007afbc3 : SUB EAX,dword ptr [EBP + -0x14]
007afbc6 : CDQ
007afbc7 : XOR EAX,EDX
007afbc9 : SUB EAX,EDX
007afbcb : MOVZX EAX,AX
007afbce : CMP AX,CX
007afbd1 : JNC 0x007afbd9
007afbd3 : MOVZX ECX,AX
007afbd6 : MOV dword ptr [EBP + 0x8],ESI
007afbd9 : INC ESI
007afbda : CMP ESI,dword ptr [EBP + -0x10]
007afbdd : JL 0x007afbbc
007afbdf : MOV EAX,dword ptr [EBP + 0x8]
007afbe2 : MOV ESI,dword ptr [EBP + -0x30]
007afbe5 : FLD float ptr [ESI + EAX*0x4]
007afbe8 : MOV ECX,dword ptr [EBP + -0x20]
007afbeb : FSTP float ptr [EDI + 0x4]
007afbee : MOV DX,word ptr [ECX + EAX*0x2]
007afbf2 : MOV EAX,dword ptr [EBP + 0xc]
007afbf5 : MOV word ptr [EAX],DX
007afbf8 : MOV byte ptr [EBP + -0x4],BL
007afbfb : CMP ECX,EBX
007afbfd : JZ 0x007afc04
007afbff : CALL 0x006f04e0
007afc04 : MOV dword ptr [EBP + -0x20],EBX
007afc07 : MOV dword ptr [EBP + -0x1c],EBX
007afc0a : MOV dword ptr [EBP + -0x18],EBX
007afc0d : MOV dword ptr [EBP + -0x4],0xffffffff
007afc14 : CMP ESI,EBX
007afc16 : JZ 0x007afc1f
007afc18 : MOV ECX,ESI
007afc1a : CALL 0x006f04e0
007afc1f : MOV AL,0x1
007afc21 : MOV dword ptr [EBP + -0x30],EBX
007afc24 : MOV dword ptr [EBP + -0x2c],EBX
007afc27 : MOV dword ptr [EBP + -0x28],EBX
007afc2a : MOV ECX,dword ptr [EBP + -0xc]
007afc2d : MOV dword ptr FS:[0x0],ECX
007afc34 : POP ECX
007afc35 : POP ESI
007afc36 : POP EBX
007afc37 : MOV ESP,EBP
007afc39 : POP EBP
007afc3a : RET 0x8

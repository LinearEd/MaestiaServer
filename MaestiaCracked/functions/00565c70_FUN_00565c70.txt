PROGRAM  : Maestia.exe
FUNCTION : FUN_00565c70
ENTRY    : 00565c70
BODY     : [[00565c70, 00565da6]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00565c70(undefined4 param_1,undefined4 *param_2,uint param_3)

{
  uint *puVar1;
  int iVar2;
  int *piVar3;
  uint uVar4;
  uint *puVar5;
  int *in_ECX;
  int iVar6;
  uint uVar7;
  int iVar8;
  
  piVar3 = (int *)*in_ECX;
  if (piVar3 == (int *)0x0) {
    iVar8 = 8;
  }
  else {
    if ((uint)(*piVar3 * 5) <= piVar3[1] * 4 + 4U) goto LAB_00565cac;
    iVar8 = piVar3[1] * 2 + 2;
  }
  FUN_00564280(param_1,iVar8);
LAB_00565cac:
  piVar3 = (int *)*in_ECX;
  param_3 = param_3 & piVar3[1];
  *piVar3 = *piVar3 + 1;
  iVar8 = *in_ECX;
  puVar1 = (uint *)(param_3 * 0x10 + 8 + iVar8);
  if (*puVar1 == 0xfffffffe) {
    *puVar1 = 0xffffffff;
    FUN_0051c600(*param_2);
    *(undefined1 *)(puVar1 + 3) = *(undefined1 *)param_2[1];
    puVar1[1] = param_3;
    return;
  }
  uVar7 = param_3;
  do {
    uVar7 = uVar7 + 1 & *(uint *)(iVar8 + 4);
  } while (*(int *)(iVar8 + 8 + uVar7 * 0x10) != -2);
  iVar2 = uVar7 * 0x10 + 8 + iVar8;
  if (puVar1[1] == param_3) {
    if (iVar2 != 0) {
      FUN_00562ac0(puVar1);
    }
    FUN_0051bc20(*param_2);
    *(undefined1 *)(puVar1 + 3) = *(undefined1 *)param_2[1];
    puVar1[1] = param_3;
    *puVar1 = uVar7;
    return;
  }
  iVar6 = puVar1[1] * 0x10;
  uVar4 = *(uint *)(iVar6 + 8 + iVar8);
  while (puVar5 = (uint *)(iVar6 + 8 + iVar8), uVar4 != param_3) {
    iVar6 = *puVar5 * 0x10;
    uVar4 = *(uint *)(iVar6 + 8 + iVar8);
  }
  if (iVar2 != 0) {
    FUN_00562ac0(puVar1);
  }
  *puVar5 = uVar7;
  FUN_0051bc20(*param_2);
  *(undefined1 *)(puVar1 + 3) = *(undefined1 *)param_2[1];
  puVar1[1] = param_3;
  *puVar1 = 0xffffffff;
  return;
}



============================================================
DISASSEMBLY
============================================================
00565c70 : PUSH EBX
00565c71 : PUSH EBP
00565c72 : PUSH ESI
00565c73 : MOV ESI,ECX
00565c75 : MOV EAX,dword ptr [ESI]
00565c77 : PUSH EDI
00565c78 : TEST EAX,EAX
00565c7a : JNZ 0x00565c85
00565c7c : MOV EAX,dword ptr [ESP + 0x14]
00565c80 : PUSH 0x8
00565c82 : PUSH EAX
00565c83 : JMP 0x00565ca7
00565c85 : MOV ECX,dword ptr [EAX + 0x4]
00565c88 : LEA EDX,[ECX*0x4 + 0x4]
00565c8f : MOV ECX,dword ptr [EAX]
00565c91 : LEA ECX,[ECX + ECX*0x4]
00565c94 : CMP ECX,EDX
00565c96 : JBE 0x00565cac
00565c98 : MOV EDX,dword ptr [EAX + 0x4]
00565c9b : MOV ECX,dword ptr [ESP + 0x14]
00565c9f : LEA EAX,[EDX + EDX*0x1 + 0x2]
00565ca3 : PUSH EAX
00565ca4 : PUSH ECX
00565ca5 : MOV ECX,ESI
00565ca7 : CALL 0x00564280
00565cac : MOV EAX,dword ptr [ESI]
00565cae : MOV EDI,dword ptr [ESP + 0x1c]
00565cb2 : AND EDI,dword ptr [EAX + 0x4]
00565cb5 : INC dword ptr [EAX]
00565cb7 : MOV EAX,dword ptr [ESI]
00565cb9 : MOV EDX,EDI
00565cbb : SHL EDX,0x4
00565cbe : LEA ESI,[EDX + EAX*0x1 + 0x8]
00565cc2 : MOV EDX,0xfffffffe
00565cc7 : CMP dword ptr [ESI],EDX
00565cc9 : JNZ 0x00565cf5
00565ccb : MOV EBP,dword ptr [ESP + 0x18]
00565ccf : MOV dword ptr [ESI],0xffffffff
00565cd5 : MOV EAX,dword ptr [EBP]
00565cd8 : LEA EBX,[ESI + 0x8]
00565cdb : PUSH EAX
00565cdc : MOV ECX,EBX
00565cde : CALL 0x0051c600
00565ce3 : MOV ECX,dword ptr [EBP + 0x4]
00565ce6 : MOV DL,byte ptr [ECX]
00565ce8 : MOV byte ptr [EBX + 0x4],DL
00565ceb : MOV dword ptr [ESI + 0x4],EDI
00565cee : POP EDI
00565cef : POP ESI
00565cf0 : POP EBP
00565cf1 : POP EBX
00565cf2 : RET 0xc
00565cf5 : MOV ECX,dword ptr [EAX + 0x4]
00565cf8 : MOV EBX,EDI
00565cfa : LEA EBX,[EBX]
00565d00 : INC EBX
00565d01 : AND EBX,ECX
00565d03 : MOV EBP,EBX
00565d05 : SHL EBP,0x4
00565d08 : CMP dword ptr [EAX + EBP*0x1 + 0x8],EDX
00565d0c : JNZ 0x00565d00
00565d0e : MOV EDX,dword ptr [ESI + 0x4]
00565d11 : MOV ECX,EBX
00565d13 : SHL ECX,0x4
00565d16 : LEA ECX,[ECX + EAX*0x1 + 0x8]
00565d1a : CMP EDX,EDI
00565d1c : JNZ 0x00565d51
00565d1e : TEST ECX,ECX
00565d20 : JZ 0x00565d28
00565d22 : PUSH ESI
00565d23 : CALL 0x00562ac0
00565d28 : MOV EDX,dword ptr [ESP + 0x18]
00565d2c : MOV EAX,dword ptr [EDX]
00565d2e : LEA EBP,[ESI + 0x8]
00565d31 : PUSH EAX
00565d32 : MOV ECX,EBP
00565d34 : CALL 0x0051bc20
00565d39 : MOV ECX,dword ptr [ESP + 0x18]
00565d3d : MOV EDX,dword ptr [ECX + 0x4]
00565d40 : MOV AL,byte ptr [EDX]
00565d42 : MOV byte ptr [EBP + 0x4],AL
00565d45 : MOV dword ptr [ESI + 0x4],EDI
00565d48 : POP EDI
00565d49 : MOV dword ptr [ESI],EBX
00565d4b : POP ESI
00565d4c : POP EBP
00565d4d : POP EBX
00565d4e : RET 0xc
00565d51 : SHL EDX,0x4
00565d54 : CMP dword ptr [EDX + EAX*0x1 + 0x8],EDI
00565d58 : LEA EBP,[EDX + EAX*0x1 + 0x8]
00565d5c : JZ 0x00565d70
00565d5e : MOV EDI,EDI
00565d60 : MOV EDX,dword ptr [EBP]
00565d63 : SHL EDX,0x4
00565d66 : CMP dword ptr [EDX + EAX*0x1 + 0x8],EDI
00565d6a : LEA EBP,[EDX + EAX*0x1 + 0x8]
00565d6e : JNZ 0x00565d60
00565d70 : TEST ECX,ECX
00565d72 : JZ 0x00565d7a
00565d74 : PUSH ESI
00565d75 : CALL 0x00562ac0
00565d7a : MOV dword ptr [EBP],EBX
00565d7d : MOV EBP,dword ptr [ESP + 0x18]
00565d81 : MOV EAX,dword ptr [EBP]
00565d84 : LEA EBX,[ESI + 0x8]
00565d87 : PUSH EAX
00565d88 : MOV ECX,EBX
00565d8a : CALL 0x0051bc20
00565d8f : MOV ECX,dword ptr [EBP + 0x4]
00565d92 : MOV DL,byte ptr [ECX]
00565d94 : MOV byte ptr [EBX + 0x4],DL
00565d97 : MOV dword ptr [ESI + 0x4],EDI
00565d9a : POP EDI
00565d9b : MOV dword ptr [ESI],0xffffffff
00565da1 : POP ESI
00565da2 : POP EBP
00565da3 : POP EBX
00565da4 : RET 0xc

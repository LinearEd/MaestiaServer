PROGRAM  : Maestia.exe
FUNCTION : FUN_005a4fe0
ENTRY    : 005a4fe0
BODY     : [[005a4fe0, 005a5147]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005a4fe0(undefined4 param_1,undefined4 *param_2,uint param_3)

{
  uint *puVar1;
  int iVar2;
  int *piVar3;
  uint *puVar4;
  uint uVar5;
  int *in_ECX;
  int iVar6;
  uint uVar7;
  int iVar8;
  
  piVar3 = (int *)*in_ECX;
  if (piVar3 == (int *)0x0) {
    iVar8 = 8;
  }
  else {
    if ((uint)(*piVar3 * 5) <= piVar3[1] * 4 + 4U) goto LAB_005a501a;
    iVar8 = piVar3[1] * 2 + 2;
  }
  FUN_005a3c00(param_1,iVar8);
LAB_005a501a:
  piVar3 = (int *)*in_ECX;
  param_3 = param_3 & piVar3[1];
  *piVar3 = *piVar3 + 1;
  iVar8 = *in_ECX;
  puVar1 = (uint *)(param_3 * 0x20 + 8 + iVar8);
  if (*puVar1 == 0xfffffffe) {
    *puVar1 = 0xffffffff;
    puVar4 = (uint *)*param_2;
    puVar1[2] = *puVar4;
    puVar1[3] = puVar4[1];
    puVar4 = (uint *)param_2[1];
    puVar1[4] = *puVar4;
    puVar1[5] = puVar4[1];
    puVar1[6] = puVar4[2];
    puVar1[7] = puVar4[3];
    puVar1[1] = param_3;
    return;
  }
  uVar7 = param_3;
  do {
    uVar7 = uVar7 + 1 & *(uint *)(iVar8 + 4);
  } while (*(int *)(iVar8 + 8 + uVar7 * 0x20) != -2);
  iVar2 = uVar7 * 0x20 + 8 + iVar8;
  if (puVar1[1] == param_3) {
    if (iVar2 != 0) {
      FUN_005a30c0(puVar1);
    }
    puVar4 = (uint *)*param_2;
    puVar1[2] = *puVar4;
    puVar1[3] = puVar4[1];
    puVar4 = (uint *)param_2[1];
    puVar1[4] = *puVar4;
    puVar1[5] = puVar4[1];
    puVar1[6] = puVar4[2];
    puVar1[7] = puVar4[3];
    *puVar1 = uVar7;
    puVar1[1] = param_3;
    return;
  }
  iVar6 = puVar1[1] * 0x20;
  uVar5 = *(uint *)(iVar6 + 8 + iVar8);
  while (puVar4 = (uint *)(iVar6 + 8 + iVar8), uVar5 != param_3) {
    iVar6 = *puVar4 * 0x20;
    uVar5 = *(uint *)(iVar6 + 8 + iVar8);
  }
  if (iVar2 != 0) {
    FUN_005a30c0(puVar1);
  }
  *puVar4 = uVar7;
  puVar4 = (uint *)*param_2;
  puVar1[2] = *puVar4;
  puVar1[3] = puVar4[1];
  puVar4 = (uint *)param_2[1];
  puVar1[4] = *puVar4;
  puVar1[5] = puVar4[1];
  puVar1[6] = puVar4[2];
  puVar1[7] = puVar4[3];
  puVar1[1] = param_3;
  *puVar1 = 0xffffffff;
  return;
}



============================================================
DISASSEMBLY
============================================================
005a4fe0 : PUSH ESI
005a4fe1 : MOV ESI,ECX
005a4fe3 : MOV EAX,dword ptr [ESI]
005a4fe5 : PUSH EDI
005a4fe6 : TEST EAX,EAX
005a4fe8 : JNZ 0x005a4ff3
005a4fea : MOV EAX,dword ptr [ESP + 0xc]
005a4fee : PUSH 0x8
005a4ff0 : PUSH EAX
005a4ff1 : JMP 0x005a5015
005a4ff3 : MOV ECX,dword ptr [EAX + 0x4]
005a4ff6 : LEA EDX,[ECX*0x4 + 0x4]
005a4ffd : MOV ECX,dword ptr [EAX]
005a4fff : LEA ECX,[ECX + ECX*0x4]
005a5002 : CMP ECX,EDX
005a5004 : JBE 0x005a501a
005a5006 : MOV EDX,dword ptr [EAX + 0x4]
005a5009 : MOV ECX,dword ptr [ESP + 0xc]
005a500d : LEA EAX,[EDX + EDX*0x1 + 0x2]
005a5011 : PUSH EAX
005a5012 : PUSH ECX
005a5013 : MOV ECX,ESI
005a5015 : CALL 0x005a3c00
005a501a : MOV EAX,dword ptr [ESI]
005a501c : MOV EDI,dword ptr [ESP + 0x14]
005a5020 : AND EDI,dword ptr [EAX + 0x4]
005a5023 : INC dword ptr [EAX]
005a5025 : MOV EAX,dword ptr [ESI]
005a5027 : MOV EDX,EDI
005a5029 : SHL EDX,0x5
005a502c : LEA ESI,[EDX + EAX*0x1 + 0x8]
005a5030 : MOV EDX,0xfffffffe
005a5035 : CMP dword ptr [ESI],EDX
005a5037 : JNZ 0x005a5072
005a5039 : MOV ECX,dword ptr [ESP + 0x10]
005a503d : MOV dword ptr [ESI],0xffffffff
005a5043 : MOV EAX,dword ptr [ECX]
005a5045 : MOV EDX,dword ptr [EAX]
005a5047 : MOV dword ptr [ESI + 0x8],EDX
005a504a : MOV EAX,dword ptr [EAX + 0x4]
005a504d : MOV dword ptr [ESI + 0xc],EAX
005a5050 : MOV EAX,dword ptr [ECX + 0x4]
005a5053 : MOV ECX,dword ptr [EAX]
005a5055 : MOV dword ptr [ESI + 0x10],ECX
005a5058 : MOV EDX,dword ptr [EAX + 0x4]
005a505b : MOV dword ptr [ESI + 0x14],EDX
005a505e : MOV ECX,dword ptr [EAX + 0x8]
005a5061 : MOV dword ptr [ESI + 0x18],ECX
005a5064 : MOV EDX,dword ptr [EAX + 0xc]
005a5067 : MOV dword ptr [ESI + 0x1c],EDX
005a506a : MOV dword ptr [ESI + 0x4],EDI
005a506d : POP EDI
005a506e : POP ESI
005a506f : RET 0xc
005a5072 : MOV ECX,dword ptr [EAX + 0x4]
005a5075 : PUSH EBX
005a5076 : MOV EBX,EDI
005a5078 : PUSH EBP
005a5079 : LEA ESP,[ESP]
005a5080 : INC EBX
005a5081 : AND EBX,ECX
005a5083 : MOV EBP,EBX
005a5085 : SHL EBP,0x5
005a5088 : CMP dword ptr [EAX + EBP*0x1 + 0x8],EDX
005a508c : JNZ 0x005a5080
005a508e : MOV EDX,dword ptr [ESI + 0x4]
005a5091 : MOV ECX,EBX
005a5093 : SHL ECX,0x5
005a5096 : LEA ECX,[ECX + EAX*0x1 + 0x8]
005a509a : CMP EDX,EDI
005a509c : JNZ 0x005a50df
005a509e : TEST ECX,ECX
005a50a0 : JZ 0x005a50a8
005a50a2 : PUSH ESI
005a50a3 : CALL 0x005a30c0
005a50a8 : MOV ECX,dword ptr [ESP + 0x18]
005a50ac : MOV EAX,dword ptr [ECX]
005a50ae : MOV EDX,dword ptr [EAX]
005a50b0 : MOV dword ptr [ESI + 0x8],EDX
005a50b3 : MOV EAX,dword ptr [EAX + 0x4]
005a50b6 : MOV dword ptr [ESI + 0xc],EAX
005a50b9 : MOV EAX,dword ptr [ECX + 0x4]
005a50bc : MOV ECX,dword ptr [EAX]
005a50be : MOV dword ptr [ESI + 0x10],ECX
005a50c1 : MOV EDX,dword ptr [EAX + 0x4]
005a50c4 : MOV dword ptr [ESI + 0x14],EDX
005a50c7 : MOV ECX,dword ptr [EAX + 0x8]
005a50ca : MOV dword ptr [ESI + 0x18],ECX
005a50cd : MOV EDX,dword ptr [EAX + 0xc]
005a50d0 : MOV dword ptr [ESI + 0x1c],EDX
005a50d3 : POP EBP
005a50d4 : MOV dword ptr [ESI],EBX
005a50d6 : POP EBX
005a50d7 : MOV dword ptr [ESI + 0x4],EDI
005a50da : POP EDI
005a50db : POP ESI
005a50dc : RET 0xc
005a50df : SHL EDX,0x5
005a50e2 : CMP dword ptr [EDX + EAX*0x1 + 0x8],EDI
005a50e6 : LEA EBP,[EDX + EAX*0x1 + 0x8]
005a50ea : JZ 0x005a5100
005a50ec : LEA ESP,[ESP]
005a50f0 : MOV EDX,dword ptr [EBP]
005a50f3 : SHL EDX,0x5
005a50f6 : CMP dword ptr [EDX + EAX*0x1 + 0x8],EDI
005a50fa : LEA EBP,[EDX + EAX*0x1 + 0x8]
005a50fe : JNZ 0x005a50f0
005a5100 : TEST ECX,ECX
005a5102 : JZ 0x005a510a
005a5104 : PUSH ESI
005a5105 : CALL 0x005a30c0
005a510a : MOV ECX,dword ptr [ESP + 0x18]
005a510e : MOV dword ptr [EBP],EBX
005a5111 : MOV EAX,dword ptr [ECX]
005a5113 : MOV EDX,dword ptr [EAX]
005a5115 : MOV dword ptr [ESI + 0x8],EDX
005a5118 : MOV EAX,dword ptr [EAX + 0x4]
005a511b : MOV dword ptr [ESI + 0xc],EAX
005a511e : MOV EAX,dword ptr [ECX + 0x4]
005a5121 : MOV ECX,dword ptr [EAX]
005a5123 : MOV dword ptr [ESI + 0x10],ECX
005a5126 : MOV EDX,dword ptr [EAX + 0x4]
005a5129 : MOV dword ptr [ESI + 0x14],EDX
005a512c : MOV ECX,dword ptr [EAX + 0x8]
005a512f : MOV dword ptr [ESI + 0x18],ECX
005a5132 : MOV EDX,dword ptr [EAX + 0xc]
005a5135 : POP EBP
005a5136 : MOV dword ptr [ESI + 0x1c],EDX
005a5139 : POP EBX
005a513a : MOV dword ptr [ESI + 0x4],EDI
005a513d : POP EDI
005a513e : MOV dword ptr [ESI],0xffffffff
005a5144 : POP ESI
005a5145 : RET 0xc

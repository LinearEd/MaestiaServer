PROGRAM  : Maestia.exe
FUNCTION : FUN_006d5770
ENTRY    : 006d5770
BODY     : [[006d5770, 006d5a82]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006d5770(int *param_1)

{
  undefined4 *puVar1;
  uint *puVar2;
  char cVar3;
  uint uVar4;
  byte *pbVar5;
  int iVar6;
  int *piVar7;
  byte *pbVar8;
  int iVar9;
  int iVar10;
  undefined4 *puVar11;
  int iStack_12c;
  int local_128;
  int iStack_124;
  undefined4 *local_120;
  uint uStack_11c;
  undefined4 uStack_118;
  uint uStack_114;
  uint uStack_110;
  uint uStack_10c;
  byte bStack_108;
  byte abStack_104 [256];
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)&iStack_12c;
  puVar1 = (undefined4 *)param_1[6];
  iVar6 = puVar1[1];
  pbVar5 = (byte *)*puVar1;
  local_120 = puVar1;
  if (iVar6 == 0) {
    cVar3 = (*(code *)puVar1[3])(param_1);
    if (cVar3 == '\0') goto LAB_006d5a6a;
    iVar6 = puVar1[1];
    pbVar5 = (byte *)*puVar1;
  }
  iVar6 = iVar6 + -1;
  local_128 = (uint)*pbVar5 << 8;
  pbVar5 = pbVar5 + 1;
  if (iVar6 == 0) {
    cVar3 = (*(code *)puVar1[3])(param_1);
    if (cVar3 == '\0') goto LAB_006d5a6a;
    iVar6 = puVar1[1];
    pbVar5 = (byte *)*puVar1;
  }
  local_128 = local_128 + (uint)*pbVar5 + -2;
  pbVar5 = pbVar5 + 1;
  iVar6 = iVar6 + -1;
  while (0x10 < local_128) {
    if (iVar6 == 0) {
      cVar3 = (*(code *)puVar1[3])(param_1);
      if (cVar3 == '\0') goto LAB_006d5a6a;
      iVar6 = puVar1[1];
      pbVar5 = (byte *)*puVar1;
      iStack_12c = iVar6;
    }
    uStack_11c = (uint)*pbVar5;
    *(undefined4 *)(*param_1 + 0x14) = 0x50;
    *(uint *)(*param_1 + 0x18) = uStack_11c;
    iVar6 = iVar6 + -1;
    pbVar5 = pbVar5 + 1;
    (**(code **)(*param_1 + 4))(param_1,1);
    uStack_118 = uStack_118 & 0xffffff00;
    iStack_124 = 0;
    iVar9 = 1;
    do {
      puVar1 = local_120;
      if (iVar6 == 0) {
        cVar3 = (*(code *)local_120[3])(param_1);
        if (cVar3 == '\0') goto LAB_006d5a6a;
        iVar6 = puVar1[1];
        pbVar5 = (byte *)*puVar1;
      }
      iStack_124 = iStack_124 + (uint)*pbVar5;
      *(byte *)((int)&uStack_118 + iVar9) = *pbVar5;
      iVar6 = iVar6 + -1;
      iVar9 = iVar9 + 1;
      pbVar5 = pbVar5 + 1;
      iStack_12c = iVar6;
    } while (iVar9 < 0x11);
    iVar9 = *param_1;
    local_128 = local_128 + -0x11;
    *(uint *)(iVar9 + 0x18) = uStack_118 >> 8 & 0xff;
    *(uint *)(iVar9 + 0x1c) = uStack_118 >> 0x10 & 0xff;
    *(uint *)(iVar9 + 0x20) = uStack_118 >> 0x18;
    *(uint *)(iVar9 + 0x24) = uStack_114 & 0xff;
    *(uint *)(iVar9 + 0x28) = uStack_114 >> 8 & 0xff;
    *(uint *)(iVar9 + 0x2c) = uStack_114 >> 0x10 & 0xff;
    *(uint *)(iVar9 + 0x30) = uStack_114 >> 0x18;
    *(uint *)(iVar9 + 0x34) = uStack_110 & 0xff;
    *(undefined4 *)(*param_1 + 0x14) = 0x56;
    (**(code **)(*param_1 + 4))(param_1,2);
    iVar9 = *param_1;
    *(uint *)(iVar9 + 0x18) = uStack_110 >> 8 & 0xff;
    *(uint *)(iVar9 + 0x1c) = uStack_110 >> 0x10 & 0xff;
    *(uint *)(iVar9 + 0x20) = uStack_110 >> 0x18;
    *(uint *)(iVar9 + 0x24) = uStack_10c & 0xff;
    *(uint *)(iVar9 + 0x28) = uStack_10c >> 8 & 0xff;
    *(uint *)(iVar9 + 0x2c) = uStack_10c >> 0x10 & 0xff;
    *(uint *)(iVar9 + 0x30) = uStack_10c >> 0x18;
    *(uint *)(iVar9 + 0x34) = (uint)bStack_108;
    *(undefined4 *)(*param_1 + 0x14) = 0x56;
    (**(code **)(*param_1 + 4))(param_1,2);
    if ((0x100 < iStack_124) || (local_128 < iStack_124)) {
      *(undefined4 *)(*param_1 + 0x14) = 8;
      (**(code **)*param_1)(param_1);
    }
    iVar10 = 0;
    iVar9 = iStack_124;
    if (0 < iStack_124) {
      do {
        puVar1 = local_120;
        if (iVar6 == 0) {
          cVar3 = (*(code *)local_120[3])(param_1);
          if (cVar3 == '\0') goto LAB_006d5a6a;
          iVar6 = puVar1[1];
          pbVar5 = (byte *)*puVar1;
          iVar9 = iStack_124;
        }
        abStack_104[iVar10] = *pbVar5;
        iVar6 = iVar6 + -1;
        iVar10 = iVar10 + 1;
        pbVar5 = pbVar5 + 1;
        iStack_12c = iVar6;
      } while (iVar10 < iVar9);
    }
    local_128 = local_128 - iVar9;
    if ((uStack_11c & 0x10) == 0) {
      iVar6 = uStack_11c + 0x28;
      uVar4 = uStack_11c;
    }
    else {
      iVar6 = uStack_11c + 0x1c;
      uVar4 = uStack_11c - 0x10;
    }
    piVar7 = param_1 + iVar6;
    if (((int)uVar4 < 0) || (3 < (int)uVar4)) {
      *(undefined4 *)(*param_1 + 0x14) = 0x1e;
      *(uint *)(*param_1 + 0x18) = uVar4;
      (**(code **)*param_1)(param_1);
    }
    if (*piVar7 == 0) {
      iVar6 = FUN_006d9560(param_1);
      *piVar7 = iVar6;
    }
    puVar2 = (uint *)*piVar7;
    *puVar2 = uStack_118;
    puVar2[1] = uStack_114;
    puVar2[2] = uStack_110;
    puVar2[3] = uStack_10c;
    *(byte *)(puVar2 + 4) = bStack_108;
    pbVar8 = abStack_104;
    puVar11 = (undefined4 *)(*piVar7 + 0x11);
    for (iVar9 = 0x40; puVar1 = local_120, iVar6 = iStack_12c, iVar9 != 0; iVar9 = iVar9 + -1) {
      *puVar11 = *(undefined4 *)pbVar8;
      pbVar8 = pbVar8 + 4;
      puVar11 = puVar11 + 1;
    }
  }
  if (local_128 != 0) {
    *(undefined4 *)(*param_1 + 0x14) = 0xb;
    (**(code **)*param_1)(param_1);
  }
  *puVar1 = pbVar5;
  puVar1[1] = iVar6;
LAB_006d5a6a:
  __security_check_cookie(local_4 ^ (uint)&iStack_12c);
  return;
}



============================================================
DISASSEMBLY
============================================================
006d5770 : SUB ESP,0x12c
006d5776 : MOV EAX,[0x00d66fa0]
006d577b : XOR EAX,ESP
006d577d : MOV dword ptr [ESP + 0x128],EAX
006d5784 : PUSH EBX
006d5785 : PUSH EBP
006d5786 : MOV EBP,dword ptr [ESP + 0x138]
006d578d : PUSH ESI
006d578e : PUSH EDI
006d578f : MOV EDI,dword ptr [EBP + 0x18]
006d5792 : MOV ESI,dword ptr [EDI + 0x4]
006d5795 : MOV EBX,dword ptr [EDI]
006d5797 : MOV dword ptr [ESP + 0x1c],EDI
006d579b : TEST ESI,ESI
006d579d : JNZ 0x006d57ba
006d579f : MOV EAX,dword ptr [EDI + 0xc]
006d57a2 : PUSH EBP
006d57a3 : CALL EAX
006d57a5 : ADD ESP,0x4
006d57a8 : TEST AL,AL
006d57aa : JNZ 0x006d57b3
006d57ac : XOR AL,AL
006d57ae : JMP 0x006d5a6a
006d57b3 : MOV ECX,dword ptr [EDI + 0x4]
006d57b6 : MOV EBX,dword ptr [EDI]
006d57b8 : MOV ESI,ECX
006d57ba : MOVZX EAX,byte ptr [EBX]
006d57bd : DEC ESI
006d57be : SHL EAX,0x8
006d57c1 : INC EBX
006d57c2 : MOV dword ptr [ESP + 0x14],EAX
006d57c6 : TEST ESI,ESI
006d57c8 : JNZ 0x006d57e2
006d57ca : MOV EDX,dword ptr [EDI + 0xc]
006d57cd : PUSH EBP
006d57ce : CALL EDX
006d57d0 : ADD ESP,0x4
006d57d3 : TEST AL,AL
006d57d5 : JZ 0x006d57ac
006d57d7 : MOV EAX,dword ptr [EDI + 0x4]
006d57da : MOV EBX,dword ptr [EDI]
006d57dc : MOV ESI,EAX
006d57de : MOV EAX,dword ptr [ESP + 0x14]
006d57e2 : MOVZX ECX,byte ptr [EBX]
006d57e5 : ADD EAX,ECX
006d57e7 : SUB EAX,0x2
006d57ea : DEC ESI
006d57eb : INC EBX
006d57ec : CMP EAX,0x10
006d57ef : MOV dword ptr [ESP + 0x14],EAX
006d57f3 : JLE 0x006d5a4a
006d57f9 : LEA ESP,[ESP]
006d5800 : TEST ESI,ESI
006d5802 : JNZ 0x006d581c
006d5804 : MOV EDX,dword ptr [EDI + 0xc]
006d5807 : PUSH EBP
006d5808 : CALL EDX
006d580a : ADD ESP,0x4
006d580d : TEST AL,AL
006d580f : JZ 0x006d57ac
006d5811 : MOV EAX,dword ptr [EDI + 0x4]
006d5814 : MOV EBX,dword ptr [EDI]
006d5816 : MOV dword ptr [ESP + 0x10],EAX
006d581a : MOV ESI,EAX
006d581c : MOVZX EAX,byte ptr [EBX]
006d581f : MOV ECX,dword ptr [EBP]
006d5822 : MOV dword ptr [ECX + 0x14],0x50
006d5829 : MOV EDX,dword ptr [EBP]
006d582c : MOV dword ptr [EDX + 0x18],EAX
006d582f : MOV dword ptr [ESP + 0x20],EAX
006d5833 : MOV EAX,dword ptr [EBP]
006d5836 : MOV ECX,dword ptr [EAX + 0x4]
006d5839 : PUSH 0x1
006d583b : PUSH EBP
006d583c : DEC ESI
006d583d : INC EBX
006d583e : CALL ECX
006d5840 : ADD ESP,0x8
006d5843 : MOV byte ptr [ESP + 0x24],0x0
006d5848 : MOV dword ptr [ESP + 0x18],0x0
006d5850 : MOV EDI,0x1
006d5855 : TEST ESI,ESI
006d5857 : JNZ 0x006d5875
006d5859 : MOV ESI,dword ptr [ESP + 0x1c]
006d585d : MOV EDX,dword ptr [ESI + 0xc]
006d5860 : PUSH EBP
006d5861 : CALL EDX
006d5863 : ADD ESP,0x4
006d5866 : TEST AL,AL
006d5868 : JZ 0x006d57ac
006d586e : MOV EAX,dword ptr [ESI + 0x4]
006d5871 : MOV EBX,dword ptr [ESI]
006d5873 : MOV ESI,EAX
006d5875 : MOV CL,byte ptr [EBX]
006d5877 : MOVZX EDX,CL
006d587a : ADD dword ptr [ESP + 0x18],EDX
006d587e : MOV byte ptr [ESP + EDI*0x1 + 0x24],CL
006d5882 : DEC ESI
006d5883 : INC EDI
006d5884 : INC EBX
006d5885 : CMP EDI,0x10
006d5888 : MOV dword ptr [ESP + 0x10],ESI
006d588c : JLE 0x006d5855
006d588e : MOV EAX,dword ptr [EBP]
006d5891 : MOVZX ECX,byte ptr [ESP + 0x25]
006d5896 : MOVZX EDX,byte ptr [ESP + 0x26]
006d589b : ADD EAX,0x18
006d589e : SUB dword ptr [ESP + 0x14],0x11
006d58a3 : MOV dword ptr [EAX],ECX
006d58a5 : MOVZX ECX,byte ptr [ESP + 0x27]
006d58aa : MOV dword ptr [EAX + 0x4],EDX
006d58ad : MOVZX EDX,byte ptr [ESP + 0x28]
006d58b2 : MOV dword ptr [EAX + 0x8],ECX
006d58b5 : MOVZX ECX,byte ptr [ESP + 0x29]
006d58ba : MOV dword ptr [EAX + 0xc],EDX
006d58bd : MOVZX EDX,byte ptr [ESP + 0x2a]
006d58c2 : MOV dword ptr [EAX + 0x10],ECX
006d58c5 : MOVZX ECX,byte ptr [ESP + 0x2b]
006d58ca : MOV dword ptr [EAX + 0x14],EDX
006d58cd : MOVZX EDX,byte ptr [ESP + 0x2c]
006d58d2 : MOV dword ptr [EAX + 0x18],ECX
006d58d5 : MOV dword ptr [EAX + 0x1c],EDX
006d58d8 : MOV EAX,dword ptr [EBP]
006d58db : MOV EDI,0x56
006d58e0 : MOV dword ptr [EAX + 0x14],EDI
006d58e3 : MOV ECX,dword ptr [EBP]
006d58e6 : MOV EDX,dword ptr [ECX + 0x4]
006d58e9 : PUSH 0x2
006d58eb : PUSH EBP
006d58ec : CALL EDX
006d58ee : MOV EAX,dword ptr [EBP]
006d58f1 : MOVZX ECX,byte ptr [ESP + 0x35]
006d58f6 : MOVZX EDX,byte ptr [ESP + 0x36]
006d58fb : ADD EAX,0x18
006d58fe : MOV dword ptr [EAX],ECX
006d5900 : MOVZX ECX,byte ptr [ESP + 0x37]
006d5905 : MOV dword ptr [EAX + 0x4],EDX
006d5908 : MOVZX EDX,byte ptr [ESP + 0x38]
006d590d : MOV dword ptr [EAX + 0x8],ECX
006d5910 : MOVZX ECX,byte ptr [ESP + 0x39]
006d5915 : MOV dword ptr [EAX + 0xc],EDX
006d5918 : MOVZX EDX,byte ptr [ESP + 0x3a]
006d591d : MOV dword ptr [EAX + 0x10],ECX
006d5920 : MOVZX ECX,byte ptr [ESP + 0x3b]
006d5925 : MOV dword ptr [EAX + 0x14],EDX
006d5928 : MOVZX EDX,byte ptr [ESP + 0x3c]
006d592d : MOV dword ptr [EAX + 0x18],ECX
006d5930 : MOV dword ptr [EAX + 0x1c],EDX
006d5933 : MOV EAX,dword ptr [EBP]
006d5936 : MOV dword ptr [EAX + 0x14],EDI
006d5939 : MOV ECX,dword ptr [EBP]
006d593c : MOV EDX,dword ptr [ECX + 0x4]
006d593f : PUSH 0x2
006d5941 : PUSH EBP
006d5942 : CALL EDX
006d5944 : MOV EAX,dword ptr [ESP + 0x28]
006d5948 : ADD ESP,0x10
006d594b : CMP EAX,0x100
006d5950 : JG 0x006d5958
006d5952 : CMP EAX,dword ptr [ESP + 0x14]
006d5956 : JLE 0x006d596d
006d5958 : MOV EAX,dword ptr [EBP]
006d595b : MOV dword ptr [EAX + 0x14],0x8
006d5962 : MOV ECX,dword ptr [EBP]
006d5965 : MOV EDX,dword ptr [ECX]
006d5967 : PUSH EBP
006d5968 : CALL EDX
006d596a : ADD ESP,0x4
006d596d : MOV EAX,dword ptr [ESP + 0x18]
006d5971 : XOR EDI,EDI
006d5973 : TEST EAX,EAX
006d5975 : JLE 0x006d59ac
006d5977 : TEST ESI,ESI
006d5979 : JNZ 0x006d599b
006d597b : MOV ESI,dword ptr [ESP + 0x1c]
006d597f : MOV EAX,dword ptr [ESI + 0xc]
006d5982 : PUSH EBP
006d5983 : CALL EAX
006d5985 : ADD ESP,0x4
006d5988 : TEST AL,AL
006d598a : JZ 0x006d57ac
006d5990 : MOV ECX,dword ptr [ESI + 0x4]
006d5993 : MOV EBX,dword ptr [ESI]
006d5995 : MOV EAX,dword ptr [ESP + 0x18]
006d5999 : MOV ESI,ECX
006d599b : MOV DL,byte ptr [EBX]
006d599d : MOV byte ptr [ESP + EDI*0x1 + 0x38],DL
006d59a1 : DEC ESI
006d59a2 : INC EDI
006d59a3 : INC EBX
006d59a4 : CMP EDI,EAX
006d59a6 : MOV dword ptr [ESP + 0x10],ESI
006d59aa : JL 0x006d5977
006d59ac : SUB dword ptr [ESP + 0x14],EAX
006d59b0 : MOV EAX,dword ptr [ESP + 0x20]
006d59b4 : TEST AL,0x10
006d59b6 : JZ 0x006d59c4
006d59b8 : SUB EAX,0x10
006d59bb : LEA ESI,[EBP + EAX*0x4 + 0xb0]
006d59c2 : JMP 0x006d59cb
006d59c4 : LEA ESI,[EBP + EAX*0x4 + 0xa0]
006d59cb : TEST EAX,EAX
006d59cd : JL 0x006d59d4
006d59cf : CMP EAX,0x4
006d59d2 : JL 0x006d59ef
006d59d4 : MOV ECX,dword ptr [EBP]
006d59d7 : MOV dword ptr [ECX + 0x14],0x1e
006d59de : MOV EDX,dword ptr [EBP]
006d59e1 : MOV dword ptr [EDX + 0x18],EAX
006d59e4 : MOV EAX,dword ptr [EBP]
006d59e7 : MOV ECX,dword ptr [EAX]
006d59e9 : PUSH EBP
006d59ea : CALL ECX
006d59ec : ADD ESP,0x4
006d59ef : CMP dword ptr [ESI],0x0
006d59f2 : JNZ 0x006d59ff
006d59f4 : PUSH EBP
006d59f5 : CALL 0x006d9560
006d59fa : ADD ESP,0x4
006d59fd : MOV dword ptr [ESI],EAX
006d59ff : MOV EAX,dword ptr [ESI]
006d5a01 : MOV EDX,dword ptr [ESP + 0x24]
006d5a05 : MOV ECX,dword ptr [ESP + 0x28]
006d5a09 : MOV dword ptr [EAX],EDX
006d5a0b : MOV EDX,dword ptr [ESP + 0x2c]
006d5a0f : MOV dword ptr [EAX + 0x4],ECX
006d5a12 : MOV ECX,dword ptr [ESP + 0x30]
006d5a16 : MOV dword ptr [EAX + 0x8],EDX
006d5a19 : MOV DL,byte ptr [ESP + 0x34]
006d5a1d : MOV dword ptr [EAX + 0xc],ECX
006d5a20 : MOV byte ptr [EAX + 0x10],DL
006d5a23 : MOV EDI,dword ptr [ESI]
006d5a25 : ADD EDI,0x11
006d5a28 : CMP dword ptr [ESP + 0x14],0x10
006d5a2d : MOV ECX,0x40
006d5a32 : LEA ESI,[ESP + 0x38]
006d5a36 : MOVSD.REP ES:EDI,ESI
006d5a38 : MOV ESI,dword ptr [ESP + 0x10]
006d5a3c : MOV EDI,dword ptr [ESP + 0x1c]
006d5a40 : JG 0x006d5800
006d5a46 : MOV EAX,dword ptr [ESP + 0x14]
006d5a4a : TEST EAX,EAX
006d5a4c : JZ 0x006d5a63
006d5a4e : MOV EAX,dword ptr [EBP]
006d5a51 : MOV dword ptr [EAX + 0x14],0xb
006d5a58 : MOV ECX,dword ptr [EBP]
006d5a5b : MOV EDX,dword ptr [ECX]
006d5a5d : PUSH EBP
006d5a5e : CALL EDX
006d5a60 : ADD ESP,0x4
006d5a63 : MOV dword ptr [EDI],EBX
006d5a65 : MOV dword ptr [EDI + 0x4],ESI
006d5a68 : MOV AL,0x1
006d5a6a : MOV ECX,dword ptr [ESP + 0x138]
006d5a71 : POP EDI
006d5a72 : POP ESI
006d5a73 : POP EBP
006d5a74 : POP EBX
006d5a75 : XOR ECX,ESP
006d5a77 : CALL 0x00633e6b
006d5a7c : ADD ESP,0x12c
006d5a82 : RET

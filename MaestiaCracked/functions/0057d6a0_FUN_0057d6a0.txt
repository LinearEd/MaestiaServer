PROGRAM  : Maestia.exe
FUNCTION : FUN_0057d6a0
ENTRY    : 0057d6a0
BODY     : [[0057d6a0, 0057d6f9] [0057d700, 0057d9b7]]

============================================================
DECOMPILED C CODE
============================================================

bool FUN_0057d6a0(int param_1,int param_2,int *param_3,undefined4 param_4)

{
  bool bVar1;
  int *piVar2;
  undefined4 *in_ECX;
  int iVar3;
  char cVar4;
  int local_84;
  int local_80;
  int local_7c;
  int local_78;
  int local_74;
  undefined4 local_70;
  undefined4 local_6c;
  undefined4 local_68;
  undefined4 local_64;
  undefined4 local_60;
  undefined4 local_5c;
  undefined4 local_58;
  undefined1 local_54 [12];
  undefined1 local_48 [12];
  undefined1 auStack_3c [12];
  undefined1 local_30 [12];
  undefined1 auStack_24 [12];
  undefined1 local_18 [12];
  undefined1 local_c [12];
  
  cVar4 = '\0';
  local_74 = param_1 + param_2 * 2;
  local_78 = param_1;
  local_70 = 0xb;
  local_6c = 0;
  local_68 = 0;
  local_64 = 1;
  local_60 = 1;
  local_5c = 0;
  local_58 = 0;
  bVar1 = false;
LAB_0057d700:
  do {
    if (cVar4 == '\x04') {
LAB_0057d9a5:
      return cVar4 == '\x03';
    }
    piVar2 = (int *)FUN_0057bf90(local_18);
    iVar3 = *piVar2;
    local_80 = piVar2[1];
    local_7c = piVar2[2];
    if (iVar3 == 10) {
      cVar4 = '\x03';
    }
    local_84 = iVar3;
    if (cVar4 != '\0') {
      if (cVar4 == '\x01') {
        if (iVar3 == 0) {
          in_ECX[3] = 0;
          in_ECX[4] = local_80;
          in_ECX[5] = local_7c;
          piVar2 = (int *)FUN_0057bf90(local_54);
          iVar3 = *piVar2;
          local_80 = piVar2[1];
          local_7c = piVar2[2];
          if (iVar3 == 2) {
            piVar2 = (int *)FUN_0057bf90(local_30);
            local_80 = piVar2[1];
            iVar3 = *piVar2;
            local_7c = piVar2[2];
          }
          cVar4 = (iVar3 != 9) * '\x02' + '\x02';
        }
        else if (iVar3 != 2) {
          if (iVar3 == 7) {
            (**(code **)(*param_3 + 8))(param_4);
            cVar4 = '\0';
          }
          else {
            cVar4 = '\x04';
          }
        }
      }
      else {
        if (cVar4 != '\x02') goto LAB_0057d9a5;
        if (iVar3 == 7) {
          (**(code **)(*param_3 + 0xc))(in_ECX + 3,in_ECX + 6,param_4);
          (**(code **)(*param_3 + 8))(param_4);
          *(undefined1 *)((int)in_ECX + 0x25) = 0;
          cVar4 = '\0';
        }
        else if (iVar3 == 8) {
          (**(code **)(*param_3 + 0xc))(in_ECX + 3,in_ECX + 6,param_4);
          *(undefined1 *)((int)in_ECX + 0x25) = 0;
          cVar4 = '\x01';
        }
        else {
          if (*(char *)((int)in_ECX + 0x25) == '\0') {
            FUN_0057d150(0);
            *(undefined1 *)((int)in_ECX + 0x25) = 1;
            if (iVar3 == 2) {
              piVar2 = (int *)FUN_0057bf90(local_c);
              local_84 = *piVar2;
              local_80 = piVar2[1];
              local_7c = piVar2[2];
            }
            in_ECX[10] = local_64;
            in_ECX[0xb] = local_60;
          }
          FUN_0057d1b0(&local_84);
        }
      }
      goto LAB_0057d700;
    }
    if (iVar3 != 0) {
      if (iVar3 == 2) {
        if (*(char *)(in_ECX + 9) != '\0') {
          cVar4 = '\x04';
        }
      }
      else {
        cVar4 = '\x04';
      }
      goto LAB_0057d700;
    }
    if (*(char *)(in_ECX + 9) == '\0') {
      *in_ECX = 0;
      in_ECX[1] = local_80;
      in_ECX[2] = local_7c;
      piVar2 = (int *)FUN_0057bf90(local_48);
      iVar3 = *piVar2;
      local_80 = piVar2[1];
      if (iVar3 == 9) {
        in_ECX[2] = in_ECX[2] + piVar2[2];
        *(undefined1 *)(in_ECX + 9) = 1;
        goto LAB_0057d700;
      }
      bVar1 = true;
    }
    else {
      in_ECX[2] = in_ECX[2] + local_7c;
      iVar3 = 0;
    }
    (**(code **)(*param_3 + 4))();
    if (bVar1) {
      bVar1 = false;
    }
    else {
      piVar2 = (int *)FUN_0057bf90(auStack_3c);
      local_80 = piVar2[1];
      local_7c = piVar2[2];
      iVar3 = *piVar2;
    }
    if (iVar3 == 2) {
      piVar2 = (int *)FUN_0057bf90(auStack_24);
      local_80 = piVar2[1];
      local_7c = piVar2[2];
      iVar3 = *piVar2;
    }
    if (iVar3 == 5) {
      cVar4 = '\0';
      *(undefined1 *)(in_ECX + 9) = 0;
    }
    else if (iVar3 == 6) {
      cVar4 = '\x01';
      *(undefined1 *)(in_ECX + 9) = 0;
    }
    else {
      cVar4 = '\x04';
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
0057d6a0 : SUB ESP,0x88
0057d6a6 : MOV EAX,dword ptr [ESP + 0x8c]
0057d6ad : PUSH EBX
0057d6ae : MOV EBX,dword ptr [ESP + 0x98]
0057d6b5 : PUSH EBP
0057d6b6 : PUSH ESI
0057d6b7 : MOV ESI,ECX
0057d6b9 : MOV ECX,dword ptr [ESP + 0x9c]
0057d6c0 : XOR EBP,EBP
0057d6c2 : LEA EDX,[EAX + ECX*0x2]
0057d6c5 : MOV dword ptr [ESP + 0x1c],EAX
0057d6c9 : MOV EAX,0x1
0057d6ce : PUSH EDI
0057d6cf : MOV dword ptr [ESP + 0x24],EDX
0057d6d3 : MOV dword ptr [ESP + 0x28],0xb
0057d6db : MOV dword ptr [ESP + 0x2c],EBP
0057d6df : MOV dword ptr [ESP + 0x30],EBP
0057d6e3 : MOV dword ptr [ESP + 0x34],EAX
0057d6e7 : MOV dword ptr [ESP + 0x38],EAX
0057d6eb : MOV dword ptr [ESP + 0x3c],EBP
0057d6ef : MOV dword ptr [ESP + 0x40],EBP
0057d6f3 : MOV byte ptr [ESP + 0x13],0x0
0057d6f8 : JMP 0x0057d700
0057d700 : CMP EBP,0x4
0057d703 : JZ 0x0057d9a5
0057d709 : LEA EAX,[ESP + 0x80]
0057d710 : PUSH EAX
0057d711 : LEA ECX,[ESP + 0x24]
0057d715 : CALL 0x0057bf90
0057d71a : MOV EDI,dword ptr [EAX]
0057d71c : MOV EDX,dword ptr [EAX + 0x4]
0057d71f : MOV EAX,dword ptr [EAX + 0x8]
0057d722 : MOV dword ptr [ESP + 0x14],EDI
0057d726 : MOV dword ptr [ESP + 0x18],EDX
0057d72a : MOV dword ptr [ESP + 0x1c],EAX
0057d72e : CMP EDI,0xa
0057d731 : JNZ 0x0057d738
0057d733 : MOV EBP,0x3
0057d738 : MOV ECX,EBP
0057d73a : SUB ECX,0x0
0057d73d : JZ 0x0057d8aa
0057d743 : SUB ECX,0x1
0057d746 : JZ 0x0057d816
0057d74c : SUB ECX,0x1
0057d74f : JNZ 0x0057d9a5
0057d755 : MOV EAX,EDI
0057d757 : SUB EAX,0x7
0057d75a : JZ 0x0057d7e8
0057d760 : SUB EAX,0x1
0057d763 : JZ 0x0057d7c1
0057d765 : CMP byte ptr [ESI + 0x25],CL
0057d768 : JNZ 0x0057d7af
0057d76a : PUSH ECX
0057d76b : LEA ECX,[ESI + 0x18]
0057d76e : CALL 0x0057d150
0057d773 : MOV byte ptr [ESI + 0x25],0x1
0057d777 : CMP EDI,0x2
0057d77a : JNZ 0x0057d7a1
0057d77c : LEA ECX,[ESP + 0x8c]
0057d783 : PUSH ECX
0057d784 : LEA ECX,[ESP + 0x24]
0057d788 : CALL 0x0057bf90
0057d78d : MOV EDX,dword ptr [EAX]
0057d78f : MOV ECX,dword ptr [EAX + 0x4]
0057d792 : MOV dword ptr [ESP + 0x14],EDX
0057d796 : MOV EDX,dword ptr [EAX + 0x8]
0057d799 : MOV dword ptr [ESP + 0x18],ECX
0057d79d : MOV dword ptr [ESP + 0x1c],EDX
0057d7a1 : MOV EAX,dword ptr [ESP + 0x34]
0057d7a5 : MOV ECX,dword ptr [ESP + 0x38]
0057d7a9 : MOV dword ptr [ESI + 0x28],EAX
0057d7ac : MOV dword ptr [ESI + 0x2c],ECX
0057d7af : LEA EDX,[ESP + 0x14]
0057d7b3 : PUSH EDX
0057d7b4 : LEA ECX,[ESI + 0x18]
0057d7b7 : CALL 0x0057d1b0
0057d7bc : JMP 0x0057d700
0057d7c1 : MOV ECX,dword ptr [ESP + 0xa8]
0057d7c8 : MOV EAX,dword ptr [EBX]
0057d7ca : PUSH ECX
0057d7cb : LEA EDX,[ESI + 0x18]
0057d7ce : PUSH EDX
0057d7cf : MOV EDX,dword ptr [EAX + 0xc]
0057d7d2 : LEA ECX,[ESI + 0xc]
0057d7d5 : PUSH ECX
0057d7d6 : MOV ECX,EBX
0057d7d8 : CALL EDX
0057d7da : MOV byte ptr [ESI + 0x25],0x0
0057d7de : MOV EBP,0x1
0057d7e3 : JMP 0x0057d700
0057d7e8 : MOV EDI,dword ptr [ESP + 0xa8]
0057d7ef : MOV EAX,dword ptr [EBX]
0057d7f1 : MOV EAX,dword ptr [EAX + 0xc]
0057d7f4 : PUSH EDI
0057d7f5 : LEA ECX,[ESI + 0x18]
0057d7f8 : PUSH ECX
0057d7f9 : LEA EDX,[ESI + 0xc]
0057d7fc : PUSH EDX
0057d7fd : MOV ECX,EBX
0057d7ff : CALL EAX
0057d801 : MOV EDX,dword ptr [EBX]
0057d803 : MOV EAX,dword ptr [EDX + 0x8]
0057d806 : PUSH EDI
0057d807 : MOV ECX,EBX
0057d809 : CALL EAX
0057d80b : MOV byte ptr [ESI + 0x25],0x0
0057d80f : XOR EBP,EBP
0057d811 : JMP 0x0057d700
0057d816 : MOV ECX,EDI
0057d818 : SUB ECX,0x0
0057d81b : JZ 0x0057d84d
0057d81d : SUB ECX,0x2
0057d820 : JZ 0x0057d700
0057d826 : SUB ECX,0x5
0057d829 : JZ 0x0057d835
0057d82b : MOV EBP,0x4
0057d830 : JMP 0x0057d700
0057d835 : MOV EDX,dword ptr [EBX]
0057d837 : MOV EAX,dword ptr [ESP + 0xa8]
0057d83e : MOV EDX,dword ptr [EDX + 0x8]
0057d841 : PUSH EAX
0057d842 : MOV ECX,EBX
0057d844 : CALL EDX
0057d846 : XOR EBP,EBP
0057d848 : JMP 0x0057d700
0057d84d : MOV dword ptr [ESI + 0xc],EDI
0057d850 : MOV dword ptr [ESI + 0x10],EDX
0057d853 : MOV dword ptr [ESI + 0x14],EAX
0057d856 : LEA EAX,[ESP + 0x44]
0057d85a : PUSH EAX
0057d85b : LEA ECX,[ESP + 0x24]
0057d85f : CALL 0x0057bf90
0057d864 : MOV ECX,dword ptr [EAX]
0057d866 : MOV EDX,dword ptr [EAX + 0x4]
0057d869 : MOV EAX,dword ptr [EAX + 0x8]
0057d86c : MOV dword ptr [ESP + 0x18],EDX
0057d870 : MOV dword ptr [ESP + 0x1c],EAX
0057d874 : CMP ECX,0x2
0057d877 : JNZ 0x0057d897
0057d879 : LEA ECX,[ESP + 0x68]
0057d87d : PUSH ECX
0057d87e : LEA ECX,[ESP + 0x24]
0057d882 : CALL 0x0057bf90
0057d887 : MOV EDX,dword ptr [EAX + 0x4]
0057d88a : MOV ECX,dword ptr [EAX]
0057d88c : MOV EAX,dword ptr [EAX + 0x8]
0057d88f : MOV dword ptr [ESP + 0x18],EDX
0057d893 : MOV dword ptr [ESP + 0x1c],EAX
0057d897 : XOR EDX,EDX
0057d899 : CMP ECX,0x9
0057d89c : SETNZ DL
0057d89f : LEA EDX,[EDX + EDX*0x1 + 0x2]
0057d8a3 : MOV EBP,EDX
0057d8a5 : JMP 0x0057d700
0057d8aa : MOV ECX,EDI
0057d8ac : SUB ECX,0x0
0057d8af : JZ 0x0057d8d4
0057d8b1 : SUB ECX,0x2
0057d8b4 : JZ 0x0057d8c0
0057d8b6 : MOV EBP,0x4
0057d8bb : JMP 0x0057d700
0057d8c0 : CMP byte ptr [ESI + 0x24],0x0
0057d8c4 : JZ 0x0057d700
0057d8ca : MOV EBP,0x4
0057d8cf : JMP 0x0057d700
0057d8d4 : CMP byte ptr [ESI + 0x24],0x0
0057d8d8 : JNZ 0x0057d914
0057d8da : MOV dword ptr [ESI],EDI
0057d8dc : MOV dword ptr [ESI + 0x4],EDX
0057d8df : MOV dword ptr [ESI + 0x8],EAX
0057d8e2 : LEA EAX,[ESP + 0x50]
0057d8e6 : PUSH EAX
0057d8e7 : LEA ECX,[ESP + 0x24]
0057d8eb : CALL 0x0057bf90
0057d8f0 : MOV EDI,dword ptr [EAX]
0057d8f2 : MOV ECX,dword ptr [EAX + 0x4]
0057d8f5 : MOV EAX,dword ptr [EAX + 0x8]
0057d8f8 : MOV dword ptr [ESP + 0x18],ECX
0057d8fc : CMP EDI,0x9
0057d8ff : JNZ 0x0057d90d
0057d901 : ADD dword ptr [ESI + 0x8],EAX
0057d904 : MOV byte ptr [ESI + 0x24],0x1
0057d908 : JMP 0x0057d700
0057d90d : MOV byte ptr [ESP + 0x13],0x1
0057d912 : JMP 0x0057d917
0057d914 : ADD dword ptr [ESI + 0x8],EAX
0057d917 : MOV EAX,dword ptr [ESP + 0xa8]
0057d91e : MOV EDX,dword ptr [EBX]
0057d920 : MOV EDX,dword ptr [EDX + 0x4]
0057d923 : PUSH EAX
0057d924 : PUSH ESI
0057d925 : MOV ECX,EBX
0057d927 : CALL EDX
0057d929 : CMP byte ptr [ESP + 0x13],0x0
0057d92e : JNZ 0x0057d950
0057d930 : LEA EAX,[ESP + 0x5c]
0057d934 : PUSH EAX
0057d935 : LEA ECX,[ESP + 0x24]
0057d939 : CALL 0x0057bf90
0057d93e : MOV ECX,dword ptr [EAX + 0x4]
0057d941 : MOV EDX,dword ptr [EAX + 0x8]
0057d944 : MOV EDI,dword ptr [EAX]
0057d946 : MOV dword ptr [ESP + 0x18],ECX
0057d94a : MOV dword ptr [ESP + 0x1c],EDX
0057d94e : JMP 0x0057d955
0057d950 : MOV byte ptr [ESP + 0x13],0x0
0057d955 : CMP EDI,0x2
0057d958 : JNZ 0x0057d978
0057d95a : LEA EAX,[ESP + 0x74]
0057d95e : PUSH EAX
0057d95f : LEA ECX,[ESP + 0x24]
0057d963 : CALL 0x0057bf90
0057d968 : MOV ECX,dword ptr [EAX + 0x4]
0057d96b : MOV EDX,dword ptr [EAX + 0x8]
0057d96e : MOV EDI,dword ptr [EAX]
0057d970 : MOV dword ptr [ESP + 0x18],ECX
0057d974 : MOV dword ptr [ESP + 0x1c],EDX
0057d978 : SUB EDI,0x5
0057d97b : JZ 0x0057d99a
0057d97d : SUB EDI,0x1
0057d980 : JZ 0x0057d98c
0057d982 : MOV EBP,0x4
0057d987 : JMP 0x0057d700
0057d98c : MOV EBP,0x1
0057d991 : MOV byte ptr [ESI + 0x24],0x0
0057d995 : JMP 0x0057d700
0057d99a : XOR EBP,EBP
0057d99c : MOV byte ptr [ESI + 0x24],0x0
0057d9a0 : JMP 0x0057d700
0057d9a5 : POP EDI
0057d9a6 : POP ESI
0057d9a7 : CMP EBP,0x3
0057d9aa : POP EBP
0057d9ab : SETZ AL
0057d9ae : POP EBX
0057d9af : ADD ESP,0x88
0057d9b5 : RET 0x10

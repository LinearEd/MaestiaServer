PROGRAM  : Maestia.exe
FUNCTION : FUN_004339e0
ENTRY    : 004339e0
BODY     : [[004339e0, 00433a33]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_004339e0(void)

{
  wchar_t wVar1;
  wchar_t *_Dest;
  wchar_t *in_ECX;
  ushort *unaff_ESI;
  
  _Dest = (wchar_t *)(unaff_ESI + 2);
  *unaff_ESI = 0;
  *(undefined1 *)(unaff_ESI + 1) = 0x46;
  *(undefined1 *)((int)unaff_ESI + 3) = 0x48;
  _wcsncpy(_Dest,in_ECX,0xff);
  unaff_ESI[0x101] = 0;
  do {
    wVar1 = *_Dest;
    _Dest = _Dest + 1;
  } while (wVar1 != L'\0');
  *unaff_ESI = *unaff_ESI ^
               ((short)((int)_Dest - (int)(unaff_ESI + 3) >> 1) * 2 + 6U ^ *unaff_ESI) & 0x1fff;
  return;
}



============================================================
DISASSEMBLY
============================================================
004339e0 : PUSH EDI
004339e1 : PUSH 0xff
004339e6 : PUSH ECX
004339e7 : XOR EAX,EAX
004339e9 : LEA EDI,[ESI + 0x4]
004339ec : PUSH EDI
004339ed : MOV word ptr [ESI],AX
004339f0 : MOV byte ptr [ESI + 0x2],0x46
004339f4 : MOV byte ptr [ESI + 0x3],0x48
004339f8 : CALL 0x00634e39
004339fd : ADD ESP,0xc
00433a00 : XOR EDX,EDX
00433a02 : MOV EAX,EDI
00433a04 : MOV word ptr [EDI + 0x1fe],DX
00433a0b : LEA EDX,[EAX + 0x2]
00433a0e : POP EDI
00433a0f : NOP
00433a10 : MOV CX,word ptr [EAX]
00433a13 : ADD EAX,0x2
00433a16 : TEST CX,CX
00433a19 : JNZ 0x00433a10
00433a1b : SUB EAX,EDX
00433a1d : SAR EAX,0x1
00433a1f : LEA EAX,[EAX + EAX*0x1 + 0x6]
00433a23 : XOR AX,word ptr [ESI]
00433a26 : MOV ECX,0x1fff
00433a2b : AND AX,CX
00433a2e : XOR word ptr [ESI],AX
00433a31 : MOV EAX,ESI
00433a33 : RET

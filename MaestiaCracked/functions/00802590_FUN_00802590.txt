PROGRAM  : Maestia.exe
FUNCTION : FUN_00802590
ENTRY    : 00802590
BODY     : [[00802590, 0080269f]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00802590(int *param_1)

{
  LPCRITICAL_SECTION lpCriticalSection;
  int *piVar1;
  uint uVar2;
  undefined4 uVar3;
  int in_ECX;
  int local_40 [2];
  undefined1 local_38 [36];
  void *local_14;
  undefined1 *puStack_10;
  int local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b2976f;
  local_14 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xffffffb0;
  ExceptionList = &local_14;
  lpCriticalSection = (LPCRITICAL_SECTION)(in_ECX + 0xb8);
  EnterCriticalSection(lpCriticalSection);
  piVar1 = param_1;
  local_c = 0;
  FUN_0044f270(in_ECX + 0x10,local_40,param_1 + 1);
  if (local_40[0] != *(int *)(in_ECX + 0x18)) {
    (**(code **)(**(int **)(local_40[0] + 0x24) + 0x20))(uVar2);
    local_c = 0xffffffff;
    LeaveCriticalSection(lpCriticalSection);
    ExceptionList = local_14;
    return 0;
  }
  uVar3 = FUN_0043c130(local_38,&param_1);
  local_c._0_1_ = 1;
  FUN_0042bc30(in_ECX + 0x10,local_40,uVar3,*(undefined4 *)(in_ECX + 0x18));
  local_c = (uint)local_c._1_3_ << 8;
  FUN_0044cb00(local_38);
  piVar1[0xd] = in_ECX;
  InterlockedIncrement(piVar1 + 0xb);
  (**(code **)(*piVar1 + 0x20))();
  local_c = 0xffffffff;
  LeaveCriticalSection(lpCriticalSection);
  ExceptionList = local_14;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
00802590 : PUSH EBP
00802591 : MOV EBP,ESP
00802593 : AND ESP,0xfffffff8
00802596 : PUSH -0x1
00802598 : PUSH 0xb2976f
0080259d : MOV EAX,FS:[0x0]
008025a3 : PUSH EAX
008025a4 : SUB ESP,0x30
008025a7 : PUSH EBX
008025a8 : PUSH ESI
008025a9 : PUSH EDI
008025aa : MOV EAX,[0x00d66fa0]
008025af : XOR EAX,ESP
008025b1 : PUSH EAX
008025b2 : LEA EAX,[ESP + 0x40]
008025b6 : MOV FS:[0x0],EAX
008025bc : MOV EDI,ECX
008025be : LEA EAX,[EDI + 0xb8]
008025c4 : PUSH EAX
008025c5 : MOV dword ptr [ESP + 0x14],EAX
008025c9 : CALL dword ptr [0x00b85118]
008025cf : MOV dword ptr [ESP + 0x48],0x0
008025d7 : MOV ESI,dword ptr [EBP + 0x8]
008025da : LEA EAX,[ESI + 0x4]
008025dd : PUSH EAX
008025de : LEA EAX,[ESP + 0x18]
008025e2 : PUSH EAX
008025e3 : LEA EBX,[EDI + 0x10]
008025e6 : PUSH EBX
008025e7 : CALL 0x0044f270
008025ec : MOV EAX,dword ptr [EDI + 0x18]
008025ef : MOV ECX,dword ptr [ESP + 0x14]
008025f3 : CMP ECX,EAX
008025f5 : JZ 0x0080262b
008025f7 : MOV ECX,dword ptr [ECX + 0x24]
008025fa : MOV EDX,dword ptr [ECX]
008025fc : MOV EAX,dword ptr [EDX + 0x20]
008025ff : CALL EAX
00802601 : MOV dword ptr [ESP + 0x48],0xffffffff
00802609 : MOV ECX,dword ptr [ESP + 0x10]
0080260d : PUSH ECX
0080260e : CALL dword ptr [0x00b8511c]
00802614 : XOR AL,AL
00802616 : MOV ECX,dword ptr [ESP + 0x40]
0080261a : MOV dword ptr FS:[0x0],ECX
00802621 : POP ECX
00802622 : POP EDI
00802623 : POP ESI
00802624 : POP EBX
00802625 : MOV ESP,EBP
00802627 : POP EBP
00802628 : RET 0x4
0080262b : LEA EDX,[EBP + 0x8]
0080262e : PUSH EDX
0080262f : LEA EAX,[ESP + 0x20]
00802633 : PUSH EAX
00802634 : LEA ECX,[ESI + 0x4]
00802637 : CALL 0x0043c130
0080263c : MOV byte ptr [ESP + 0x48],0x1
00802641 : MOV ECX,dword ptr [EBX + 0x8]
00802644 : PUSH ECX
00802645 : PUSH EAX
00802646 : LEA ECX,[ESP + 0x1c]
0080264a : PUSH ECX
0080264b : PUSH EBX
0080264c : CALL 0x0042bc30
00802651 : MOV byte ptr [ESP + 0x48],0x0
00802656 : LEA EDX,[ESP + 0x1c]
0080265a : PUSH EDX
0080265b : CALL 0x0044cb00
00802660 : LEA EAX,[ESI + 0x2c]
00802663 : PUSH EAX
00802664 : MOV dword ptr [ESI + 0x34],EDI
00802667 : CALL dword ptr [0x00b850dc]
0080266d : MOV EDX,dword ptr [ESI]
0080266f : MOV EAX,dword ptr [EDX + 0x20]
00802672 : MOV ECX,ESI
00802674 : CALL EAX
00802676 : MOV dword ptr [ESP + 0x48],0xffffffff
0080267e : MOV ECX,dword ptr [ESP + 0x10]
00802682 : PUSH ECX
00802683 : CALL dword ptr [0x00b8511c]
00802689 : MOV AL,0x1
0080268b : MOV ECX,dword ptr [ESP + 0x40]
0080268f : MOV dword ptr FS:[0x0],ECX
00802696 : POP ECX
00802697 : POP EDI
00802698 : POP ESI
00802699 : POP EBX
0080269a : MOV ESP,EBP
0080269c : POP EBP
0080269d : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_0073a210
ENTRY    : 0073a210
BODY     : [[0073a210, 0073a69d]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_0073a210(int param_1,char param_2,int param_3)

{
  int iVar1;
  int *piVar2;
  char cVar3;
  ushort uVar4;
  uint uVar5;
  uint uVar6;
  int iVar7;
  int in_ECX;
  int iVar8;
  int local_34;
  uint local_30;
  LPCRITICAL_SECTION local_2c;
  char *local_28;
  undefined4 local_24;
  int local_20;
  undefined4 local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b4d138;
  local_14 = ExceptionList;
  uVar5 = DAT_00d66fa0 ^ (uint)&stack0xffffffb0;
  ExceptionList = &local_14;
  *(int *)(in_ECX + 0x1e8) = param_1;
  uVar6 = *(int *)(param_1 + 0xdc) - *(int *)(param_1 + 0xd8) >> 2;
  local_30 = uVar6 & 0xffff;
  FUN_004644b0(local_30 + 1);
  *(undefined2 *)(in_ECX + 0x224) = *(undefined2 *)(param_1 + 0xe6);
  uVar4 = 0;
  if ((short)uVar6 != 0) {
    do {
      local_34 = FUN_006f0760(0x158,"",0,(DAT_01725270 >> 3 & 1) == 0,uVar5);
      iVar8 = 0;
      local_c = 0;
      if (local_34 != 0) {
        iVar8 = FUN_0078ef20(local_34);
      }
      local_c = 0xffffffff;
      *(int *)(iVar8 + 4) = in_ECX;
      *(undefined1 *)(iVar8 + 0x128) = *(undefined1 *)(in_ECX + 0x2da);
      local_34 = iVar8;
      if ((((*(int *)(param_1 + 0xdc) - *(int *)(param_1 + 0xd8) & 0xfffffffcU) == 0) ||
          ((uint)(*(int *)(param_1 + 0xdc) - *(int *)(param_1 + 0xd8) >> 2) <= (uint)uVar4)) ||
         (iVar1 = *(int *)(*(int *)(param_1 + 0xd8) + (uint)uVar4 * 4), iVar1 == 0)) {
        if (param_3 != 0) {
          FUN_00406360(L"AvaMeshEntity::AttachMeshNodeData() : Index Buffer NULL Error",0x3d);
        }
        ExceptionList = local_14;
        return 0;
      }
      *(int *)(iVar8 + 8) = iVar1;
      *(uint *)(iVar8 + 0x144) = (uint)(*(short *)(*(int *)(iVar8 + 4) + 0x224) != 0);
      if (param_2 == '\0') {
        cVar3 = FUN_0078f730(iVar8);
        if (((cVar3 == '\0') && (*(char *)(param_1 + 0x22d) == '\0')) && (param_3 != 0)) {
          iVar7 = FUN_00405bb0(L"skip");
          FUN_00405eb0(iVar1 + 0x20,0,0xffffffff);
          if (iVar7 != 0) {
            ExceptionList = local_14;
            return 0;
          }
        }
        FUN_0078f630(iVar8);
        FUN_0078f530(iVar8);
        FUN_0078f430(iVar8);
        if (*(int *)(iVar8 + 0x2c) == 0) {
          FUN_0078f430(iVar8);
          if (*(int *)(iVar8 + 0x2c) != 0) {
            *(uint *)(in_ECX + 0x1cc) = *(uint *)(in_ECX + 0x1cc) | 2;
          }
        }
        else {
          *(uint *)(in_ECX + 0x1cc) = *(uint *)(in_ECX + 0x1cc) | 1;
        }
        FUN_0078f330(iVar8);
        FUN_0078f230(iVar8);
        FUN_0078f130(iVar8);
      }
      else {
        cVar3 = FUN_00802b90(DAT_017251c8,iVar1 + 0x20);
        if (((cVar3 == '\0') && (*(char *)(param_1 + 0x22d) == '\0')) && (param_3 != 0)) {
          iVar7 = FUN_00405bb0(L"skip");
          FUN_00405eb0(iVar1 + 0x20,0,0xffffffff);
          if (iVar7 != 0) {
            ExceptionList = local_14;
            return 0;
          }
        }
        FUN_00405eb0(iVar1 + 0x20,0,0xffffffff);
        FUN_00405eb0(iVar1 + 0x58,0,0xffffffff);
        FUN_00405eb0(iVar1 + 0x74,0,0xffffffff);
        cVar3 = FUN_00802b90(DAT_017251c8,iVar1 + 0x90);
        if (cVar3 == '\0') {
          cVar3 = FUN_00802b90(DAT_017251c8,iVar1 + 0xac);
          if (cVar3 != '\0') {
            FUN_00405eb0(iVar1 + 0xac,0,0xffffffff);
            *(uint *)(in_ECX + 0x1cc) = *(uint *)(in_ECX + 0x1cc) | 2;
          }
        }
        else {
          FUN_00405eb0(iVar1 + 0x90,0,0xffffffff);
          *(uint *)(in_ECX + 0x1cc) = *(uint *)(in_ECX + 0x1cc) | 1;
        }
        FUN_00405eb0(iVar1 + 200,0,0xffffffff);
        FUN_00405eb0(iVar1 + 0xe4,0,0xffffffff);
        FUN_00405eb0(iVar1 + 0x100,0,0xffffffff);
      }
      local_2c = (LPCRITICAL_SECTION)(in_ECX + 0x2ec);
      local_20 = 0;
      local_28 = ".\\Mesh\\AvaMeshEntity.cpp";
      local_24 = 0xdb;
      local_1c = 1;
      FUN_006ef1a0(&local_2c);
      local_c = 1;
      iVar1 = *(int *)(in_ECX + 0x1d8);
      if (iVar1 == 0) {
        uVar6 = 0;
      }
      else {
        uVar6 = *(int *)(in_ECX + 0x1e0) - iVar1 >> 2;
      }
      piVar2 = *(int **)(in_ECX + 0x1dc);
      if ((uint)((int)piVar2 - iVar1 >> 2) < uVar6) {
        *piVar2 = iVar8;
        *(int **)(in_ECX + 0x1dc) = piVar2 + 1;
      }
      else {
        FUN_0042fe80(in_ECX + 0x1d4,piVar2,&local_34);
      }
      local_c = 0xffffffff;
      if (local_20 != 0) {
        LeaveCriticalSection(local_2c);
        local_20 = 0;
      }
      uVar4 = uVar4 + 1;
    } while (uVar4 < (ushort)local_30);
  }
  *(short *)(in_ECX + 0x1e4) = (short)(*(int *)(in_ECX + 0x1dc) - *(int *)(in_ECX + 0x1d8) >> 2);
  FUN_00439630();
  FUN_004399a0();
  ExceptionList = local_14;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
0073a210 : PUSH EBP
0073a211 : MOV EBP,ESP
0073a213 : AND ESP,0xfffffff8
0073a216 : PUSH -0x1
0073a218 : PUSH 0xb4d138
0073a21d : MOV EAX,FS:[0x0]
0073a223 : PUSH EAX
0073a224 : SUB ESP,0x30
0073a227 : PUSH EBX
0073a228 : PUSH ESI
0073a229 : PUSH EDI
0073a22a : MOV EAX,[0x00d66fa0]
0073a22f : XOR EAX,ESP
0073a231 : PUSH EAX
0073a232 : LEA EAX,[ESP + 0x40]
0073a236 : MOV FS:[0x0],EAX
0073a23c : MOV EDI,ECX
0073a23e : MOV dword ptr [ESP + 0x18],EDI
0073a242 : MOV EBX,dword ptr [EBP + 0x8]
0073a245 : MOV dword ptr [EDI + 0x1e8],EBX
0073a24b : MOV EAX,dword ptr [EBX + 0xdc]
0073a251 : SUB EAX,dword ptr [EBX + 0xd8]
0073a257 : LEA ECX,[EDI + 0x1d4]
0073a25d : SAR EAX,0x2
0073a260 : MOVZX ESI,AX
0073a263 : MOVZX EDX,SI
0073a266 : INC EDX
0073a267 : PUSH EDX
0073a268 : MOV dword ptr [ESP + 0x28],ESI
0073a26c : CALL 0x004644b0
0073a271 : MOVZX EAX,word ptr [EBX + 0xe6]
0073a278 : MOV word ptr [EDI + 0x224],AX
0073a27f : XOR EAX,EAX
0073a281 : MOV dword ptr [ESP + 0x14],0x0
0073a289 : CMP AX,SI
0073a28c : JNC 0x0073a646
0073a292 : MOV ECX,dword ptr [0x01725270]
0073a298 : SHR ECX,0x3
0073a29b : MOV EDX,0x0
0073a2a0 : AND ECX,0x1
0073a2a3 : SETZ DL
0073a2a6 : PUSH EDX
0073a2a7 : PUSH 0x0
0073a2a9 : PUSH 0xbf1a4a
0073a2ae : PUSH 0x158
0073a2b3 : CALL 0x006f0760
0073a2b8 : ADD ESP,0x10
0073a2bb : MOV dword ptr [ESP + 0x20],EAX
0073a2bf : XOR ESI,ESI
0073a2c1 : MOV dword ptr [ESP + 0x48],ESI
0073a2c5 : CMP EAX,ESI
0073a2c7 : JZ 0x0073a2d1
0073a2c9 : PUSH EAX
0073a2ca : CALL 0x0078ef20
0073a2cf : MOV ESI,EAX
0073a2d1 : MOV dword ptr [ESP + 0x48],0xffffffff
0073a2d9 : MOV dword ptr [ESI + 0x4],EDI
0073a2dc : MOV AL,byte ptr [EDI + 0x2da]
0073a2e2 : MOV byte ptr [ESI + 0x128],AL
0073a2e8 : MOV EAX,dword ptr [EBX + 0xdc]
0073a2ee : SUB EAX,dword ptr [EBX + 0xd8]
0073a2f4 : MOV dword ptr [ESP + 0x20],ESI
0073a2f8 : TEST EAX,0xfffffffc
0073a2fd : JZ 0x0073a61c
0073a303 : MOV ECX,dword ptr [EBX + 0xdc]
0073a309 : SUB ECX,dword ptr [EBX + 0xd8]
0073a30f : MOVZX EAX,word ptr [ESP + 0x14]
0073a314 : SAR ECX,0x2
0073a317 : CMP EAX,ECX
0073a319 : JNC 0x0073a61c
0073a31f : MOV EDX,dword ptr [EBX + 0xd8]
0073a325 : MOV EBX,dword ptr [EDX + EAX*0x4]
0073a328 : TEST EBX,EBX
0073a32a : JZ 0x0073a61c
0073a330 : MOV EAX,dword ptr [ESI + 0x4]
0073a333 : XOR CX,CX
0073a336 : MOV dword ptr [ESI + 0x8],EBX
0073a339 : CMP CX,word ptr [EAX + 0x224]
0073a340 : SBB EDX,EDX
0073a342 : NEG EDX
0073a344 : MOV dword ptr [ESI + 0x144],EDX
0073a34a : CMP byte ptr [EBP + 0xc],CL
0073a34d : JZ 0x0073a49b
0073a353 : LEA EAX,[EBX + 0x20]
0073a356 : PUSH EAX
0073a357 : MOV EAX,[0x017251c8]
0073a35c : PUSH EAX
0073a35d : CALL 0x00802b90
0073a362 : TEST AL,AL
0073a364 : JNZ 0x0073a3b7
0073a366 : MOV ECX,dword ptr [EBP + 0x8]
0073a369 : CMP byte ptr [ECX + 0x22d],AL
0073a36f : JNZ 0x0073a3b7
0073a371 : MOV ECX,dword ptr [EBP + 0x10]
0073a374 : TEST ECX,ECX
0073a376 : JZ 0x0073a3b7
0073a378 : MOV EAX,dword ptr [ECX + 0x14]
0073a37b : PUSH 0xc0568c
0073a380 : MOV EDI,0x4
0073a385 : MOV byte ptr [ESP + 0x17],0x1
0073a38a : CALL 0x00405bb0
0073a38f : TEST EAX,EAX
0073a391 : JZ 0x0073a398
0073a393 : MOV byte ptr [ESP + 0x13],0x0
0073a398 : MOV ECX,dword ptr [EBP + 0x10]
0073a39b : PUSH -0x1
0073a39d : PUSH 0x0
0073a39f : LEA EAX,[EBX + 0x20]
0073a3a2 : PUSH EAX
0073a3a3 : CALL 0x00405eb0
0073a3a8 : CMP byte ptr [ESP + 0x13],0x0
0073a3ad : JZ 0x0073a62f
0073a3b3 : MOV EDI,dword ptr [ESP + 0x18]
0073a3b7 : PUSH -0x1
0073a3b9 : PUSH 0x0
0073a3bb : LEA EAX,[EBX + 0x20]
0073a3be : PUSH EAX
0073a3bf : LEA ECX,[ESI + 0x48]
0073a3c2 : CALL 0x00405eb0
0073a3c7 : PUSH -0x1
0073a3c9 : PUSH 0x0
0073a3cb : LEA EDX,[EBX + 0x58]
0073a3ce : PUSH EDX
0073a3cf : LEA ECX,[ESI + 0x64]
0073a3d2 : CALL 0x00405eb0
0073a3d7 : PUSH -0x1
0073a3d9 : PUSH 0x0
0073a3db : LEA EAX,[EBX + 0x74]
0073a3de : PUSH EAX
0073a3df : LEA ECX,[ESI + 0xf0]
0073a3e5 : CALL 0x00405eb0
0073a3ea : MOV ECX,dword ptr [0x017251c8]
0073a3f0 : LEA EAX,[EBX + 0x90]
0073a3f6 : PUSH EAX
0073a3f7 : PUSH ECX
0073a3f8 : CALL 0x00802b90
0073a3fd : TEST AL,AL
0073a3ff : JNZ 0x0073a437
0073a401 : MOV EDX,dword ptr [0x017251c8]
0073a407 : LEA EAX,[EBX + 0xac]
0073a40d : PUSH EAX
0073a40e : PUSH EDX
0073a40f : CALL 0x00802b90
0073a414 : TEST AL,AL
0073a416 : JZ 0x0073a454
0073a418 : PUSH -0x1
0073a41a : PUSH 0x0
0073a41c : LEA EAX,[EBX + 0xac]
0073a422 : PUSH EAX
0073a423 : LEA ECX,[ESI + 0x80]
0073a429 : CALL 0x00405eb0
0073a42e : OR dword ptr [EDI + 0x1cc],0x2
0073a435 : JMP 0x0073a454
0073a437 : PUSH -0x1
0073a439 : PUSH 0x0
0073a43b : LEA EAX,[EBX + 0x90]
0073a441 : PUSH EAX
0073a442 : LEA ECX,[ESI + 0x80]
0073a448 : CALL 0x00405eb0
0073a44d : OR dword ptr [EDI + 0x1cc],0x1
0073a454 : PUSH -0x1
0073a456 : PUSH 0x0
0073a458 : LEA EAX,[EBX + 0xc8]
0073a45e : PUSH EAX
0073a45f : LEA ECX,[ESI + 0xd4]
0073a465 : CALL 0x00405eb0
0073a46a : PUSH -0x1
0073a46c : PUSH 0x0
0073a46e : LEA ECX,[EBX + 0xe4]
0073a474 : PUSH ECX
0073a475 : LEA ECX,[ESI + 0xb8]
0073a47b : CALL 0x00405eb0
0073a480 : PUSH -0x1
0073a482 : PUSH 0x0
0073a484 : ADD EBX,0x100
0073a48a : PUSH EBX
0073a48b : LEA ECX,[ESI + 0x9c]
0073a491 : CALL 0x00405eb0
0073a496 : JMP 0x0073a563
0073a49b : LEA ECX,[EBX + 0x20]
0073a49e : PUSH ESI
0073a49f : CALL 0x0078f730
0073a4a4 : TEST AL,AL
0073a4a6 : JNZ 0x0073a4f9
0073a4a8 : MOV EDX,dword ptr [EBP + 0x8]
0073a4ab : CMP byte ptr [EDX + 0x22d],AL
0073a4b1 : JNZ 0x0073a4f9
0073a4b3 : MOV ECX,dword ptr [EBP + 0x10]
0073a4b6 : TEST ECX,ECX
0073a4b8 : JZ 0x0073a4f9
0073a4ba : MOV EAX,dword ptr [ECX + 0x14]
0073a4bd : PUSH 0xc05698
0073a4c2 : MOV EDI,0x4
0073a4c7 : MOV byte ptr [ESP + 0x17],0x1
0073a4cc : CALL 0x00405bb0
0073a4d1 : TEST EAX,EAX
0073a4d3 : JZ 0x0073a4da
0073a4d5 : MOV byte ptr [ESP + 0x13],0x0
0073a4da : MOV ECX,dword ptr [EBP + 0x10]
0073a4dd : PUSH -0x1
0073a4df : PUSH 0x0
0073a4e1 : LEA EAX,[EBX + 0x20]
0073a4e4 : PUSH EAX
0073a4e5 : CALL 0x00405eb0
0073a4ea : CMP byte ptr [ESP + 0x13],0x0
0073a4ef : JZ 0x0073a62f
0073a4f5 : MOV EDI,dword ptr [ESP + 0x18]
0073a4f9 : LEA ECX,[EBX + 0x58]
0073a4fc : PUSH ESI
0073a4fd : CALL 0x0078f630
0073a502 : LEA ECX,[EBX + 0x74]
0073a505 : PUSH ESI
0073a506 : CALL 0x0078f530
0073a50b : LEA ECX,[EBX + 0x90]
0073a511 : PUSH ESI
0073a512 : CALL 0x0078f430
0073a517 : CMP dword ptr [ESI + 0x2c],0x0
0073a51b : JNZ 0x0073a538
0073a51d : LEA ECX,[EBX + 0xac]
0073a523 : PUSH ESI
0073a524 : CALL 0x0078f430
0073a529 : CMP dword ptr [ESI + 0x2c],0x0
0073a52d : JZ 0x0073a53f
0073a52f : OR dword ptr [EDI + 0x1cc],0x2
0073a536 : JMP 0x0073a53f
0073a538 : OR dword ptr [EDI + 0x1cc],0x1
0073a53f : LEA ECX,[EBX + 0xc8]
0073a545 : PUSH ESI
0073a546 : CALL 0x0078f330
0073a54b : LEA ECX,[EBX + 0xe4]
0073a551 : PUSH ESI
0073a552 : CALL 0x0078f230
0073a557 : LEA ECX,[EBX + 0x100]
0073a55d : PUSH ESI
0073a55e : CALL 0x0078f130
0073a563 : LEA ECX,[ESP + 0x28]
0073a567 : LEA EAX,[EDI + 0x2ec]
0073a56d : MOV EBX,0x1
0073a572 : PUSH ECX
0073a573 : MOV dword ptr [ESP + 0x38],0x0
0073a57b : MOV dword ptr [ESP + 0x2c],EAX
0073a57f : MOV dword ptr [ESP + 0x30],0xc056a4
0073a587 : MOV dword ptr [ESP + 0x34],0xdb
0073a58f : MOV dword ptr [ESP + 0x3c],EBX
0073a593 : CALL 0x006ef1a0
0073a598 : MOV dword ptr [ESP + 0x48],EBX
0073a59c : MOV ECX,dword ptr [EDI + 0x1d8]
0073a5a2 : LEA EAX,[EDI + 0x1d4]
0073a5a8 : TEST ECX,ECX
0073a5aa : JNZ 0x0073a5b0
0073a5ac : XOR EDX,EDX
0073a5ae : JMP 0x0073a5b8
0073a5b0 : MOV EDX,dword ptr [EAX + 0xc]
0073a5b3 : SUB EDX,ECX
0073a5b5 : SAR EDX,0x2
0073a5b8 : MOV EBX,dword ptr [EAX + 0x8]
0073a5bb : MOV dword ptr [ESP + 0x1c],EBX
0073a5bf : SUB EBX,ECX
0073a5c1 : MOV ECX,dword ptr [ESP + 0x1c]
0073a5c5 : SAR EBX,0x2
0073a5c8 : CMP EBX,EDX
0073a5ca : JNC 0x0073a5d6
0073a5cc : MOV dword ptr [ECX],ESI
0073a5ce : ADD ECX,0x4
0073a5d1 : MOV dword ptr [EAX + 0x8],ECX
0073a5d4 : JMP 0x0073a5e2
0073a5d6 : LEA EDX,[ESP + 0x20]
0073a5da : PUSH EDX
0073a5db : PUSH ECX
0073a5dc : PUSH EAX
0073a5dd : CALL 0x0042fe80
0073a5e2 : MOV dword ptr [ESP + 0x48],0xffffffff
0073a5ea : CMP dword ptr [ESP + 0x34],0x0
0073a5ef : JZ 0x0073a604
0073a5f1 : MOV EDX,dword ptr [ESP + 0x28]
0073a5f5 : PUSH EDX
0073a5f6 : CALL dword ptr [0x00b8511c]
0073a5fc : MOV dword ptr [ESP + 0x34],0x0
0073a604 : MOV EAX,dword ptr [ESP + 0x14]
0073a608 : INC EAX
0073a609 : MOV dword ptr [ESP + 0x14],EAX
0073a60d : CMP AX,word ptr [ESP + 0x24]
0073a612 : JNC 0x0073a646
0073a614 : MOV EBX,dword ptr [EBP + 0x8]
0073a617 : JMP 0x0073a292
0073a61c : MOV ECX,dword ptr [EBP + 0x10]
0073a61f : TEST ECX,ECX
0073a621 : JZ 0x0073a62f
0073a623 : PUSH 0x3d
0073a625 : PUSH 0xc05610
0073a62a : CALL 0x00406360
0073a62f : XOR AL,AL
0073a631 : MOV ECX,dword ptr [ESP + 0x40]
0073a635 : MOV dword ptr FS:[0x0],ECX
0073a63c : POP ECX
0073a63d : POP EDI
0073a63e : POP ESI
0073a63f : POP EBX
0073a640 : MOV ESP,EBP
0073a642 : POP EBP
0073a643 : RET 0xc
0073a646 : MOV EAX,dword ptr [EDI + 0x1dc]
0073a64c : SUB EAX,dword ptr [EDI + 0x1d8]
0073a652 : MOV ECX,dword ptr [EDI + 0x1e8]
0073a658 : SAR EAX,0x2
0073a65b : MOV word ptr [EDI + 0x1e4],AX
0073a662 : ADD ECX,0xec
0073a668 : LEA EAX,[EDI + 0x74]
0073a66b : CALL 0x00439630
0073a670 : MOV ECX,dword ptr [EDI + 0x1e8]
0073a676 : ADD ECX,0x170
0073a67c : LEA EAX,[EDI + 0xf8]
0073a682 : CALL 0x004399a0
0073a687 : MOV AL,0x1
0073a689 : MOV ECX,dword ptr [ESP + 0x40]
0073a68d : MOV dword ptr FS:[0x0],ECX
0073a694 : POP ECX
0073a695 : POP EDI
0073a696 : POP ESI
0073a697 : POP EBX
0073a698 : MOV ESP,EBP
0073a69a : POP EBP
0073a69b : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_00816a10
ENTRY    : 00816a10
BODY     : [[00816a10, 00816cad]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_00816a10(undefined4 param_1)

{
  short sVar1;
  char cVar2;
  uint uVar3;
  short *psVar4;
  int *in_ECX;
  undefined4 *puVar5;
  uint uVar6;
  undefined1 local_205c [8];
  undefined1 local_2054 [4];
  undefined2 local_2050;
  undefined4 local_2040;
  uint local_203c;
  undefined4 local_2038;
  undefined4 local_2034;
  undefined4 local_2030;
  undefined4 *local_202c;
  undefined4 local_2028;
  undefined4 local_2024;
  undefined4 *local_2020;
  uint local_201c;
  short local_2018;
  undefined1 local_2016 [8190];
  uint local_18;
  undefined4 uStack_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3d06c;
  local_10 = ExceptionList;
  uStack_14 = 0x816a2b;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_2024 = param_1;
  local_2020 = (undefined4 *)0x0;
  local_18 = uVar3;
  while (((uint)in_ECX[9] < (uint)in_ECX[8] &&
         (cVar2 = (**(code **)(*in_ECX + 0x1c))(&local_2038,uVar3), cVar2 != '\0'))) {
    switch(local_2038) {
    case 0x5111:
      puVar5 = (undefined4 *)0x0;
      local_2020 = (undefined4 *)FUN_006f0760(0x28,"",0,(DAT_01725270 >> 3 & 1) == 0);
      local_8 = 0;
      if (local_2020 != (undefined4 *)0x0) {
        puVar5 = (undefined4 *)FUN_004532a0(local_2020);
      }
      local_8 = 0xffffffff;
      local_2020 = puVar5;
      (**(code **)(*in_ECX + 0xc))(puVar5,2,1);
      (**(code **)(*in_ECX + 0xc))(puVar5 + 1,2,1);
      (**(code **)(*in_ECX + 0xc))((int)puVar5 + 6,2,1);
      local_2030 = *puVar5;
      local_202c = puVar5;
      FUN_00451e00(local_205c,&local_2030);
      break;
    case 0x5112:
      uVar6 = 0;
      local_201c = 0;
      (**(code **)(*in_ECX + 0xc))(&local_201c,1,1);
      if (local_201c != 0) {
        do {
          (**(code **)(*in_ECX + 0xc))(&local_2028,4,1);
          FUN_00453250(local_2028);
          uVar6 = uVar6 + 1;
        } while (uVar6 < local_201c);
      }
      break;
    case 0x5113:
      uVar6 = 0;
      local_201c = 0;
      (**(code **)(*in_ECX + 0xc))(&local_201c,1,1);
      if (local_201c != 0) {
        do {
          FUN_0070d080(&local_2018);
          psVar4 = &local_2018;
          local_203c = 7;
          local_2040 = 0;
          local_2050 = 0;
          do {
            sVar1 = *psVar4;
            psVar4 = psVar4 + 1;
          } while (sVar1 != 0);
          FUN_00406360(&local_2018,(int)psVar4 - (int)local_2016 >> 1);
          local_8 = 1;
          FUN_00405ae0(local_2054);
          local_8 = 0xffffffff;
          if (7 < local_203c) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          uVar6 = uVar6 + 1;
          local_203c = 7;
          local_2040 = 0;
          local_2050 = 0;
        } while (uVar6 < local_201c);
      }
      break;
    case 0x5114:
      goto switchD_00816a8d_caseD_5114;
    default:
      (**(code **)(*in_ECX + 0x24))(local_2034);
    }
  }
switchD_00816a8d_caseD_5114:
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00816a10 : PUSH EBP
00816a11 : MOV EBP,ESP
00816a13 : PUSH -0x1
00816a15 : PUSH 0xb3d06c
00816a1a : MOV EAX,FS:[0x0]
00816a20 : PUSH EAX
00816a21 : MOV EAX,0x2050
00816a26 : CALL 0x0063b780
00816a2b : MOV EAX,[0x00d66fa0]
00816a30 : XOR EAX,EBP
00816a32 : MOV dword ptr [EBP + -0x14],EAX
00816a35 : PUSH EBX
00816a36 : PUSH ESI
00816a37 : PUSH EDI
00816a38 : PUSH EAX
00816a39 : LEA EAX,[EBP + -0xc]
00816a3c : MOV FS:[0x0],EAX
00816a42 : MOV EAX,dword ptr [EBP + 0x8]
00816a45 : XOR EBX,EBX
00816a47 : MOV dword ptr [EBP + 0xffffdfe0],EAX
00816a4d : MOV EDI,ECX
00816a4f : MOV dword ptr [EBP + 0xffffdfe4],EBX
00816a55 : MOV ECX,dword ptr [EDI + 0x24]
00816a58 : CMP ECX,dword ptr [EDI + 0x20]
00816a5b : JNC 0x00816c90
00816a61 : MOV EDX,dword ptr [EDI]
00816a63 : MOV EDX,dword ptr [EDX + 0x1c]
00816a66 : LEA EAX,[EBP + 0xffffdfcc]
00816a6c : PUSH EAX
00816a6d : MOV ECX,EDI
00816a6f : CALL EDX
00816a71 : TEST AL,AL
00816a73 : JZ 0x00816c90
00816a79 : MOV EAX,dword ptr [EBP + 0xffffdfcc]
00816a7f : ADD EAX,0xffffaeef
00816a84 : CMP EAX,0x3
00816a87 : JA 0x00816c7b
00816a8d : JMP dword ptr [EAX*0x4 + 0x816cb0]
00816a94 : MOV EAX,[0x01725270]
00816a99 : SHR EAX,0x3
00816a9c : MOV ECX,0x0
00816aa1 : AND EAX,0x1
00816aa4 : SETZ CL
00816aa7 : XOR ESI,ESI
00816aa9 : PUSH ECX
00816aaa : PUSH ESI
00816aab : PUSH 0xbf1a4a
00816ab0 : PUSH 0x28
00816ab2 : CALL 0x006f0760
00816ab7 : ADD ESP,0x10
00816aba : MOV dword ptr [EBP + 0xffffdfe4],EAX
00816ac0 : MOV dword ptr [EBP + -0x4],ESI
00816ac3 : CMP EAX,ESI
00816ac5 : JZ 0x00816acf
00816ac7 : PUSH EAX
00816ac8 : CALL 0x004532a0
00816acd : MOV ESI,EAX
00816acf : MOV dword ptr [EBP + -0x4],0xffffffff
00816ad6 : MOV EDX,dword ptr [EDI]
00816ad8 : MOV EAX,dword ptr [EDX + 0xc]
00816adb : PUSH 0x1
00816add : PUSH 0x2
00816adf : PUSH ESI
00816ae0 : MOV ECX,EDI
00816ae2 : MOV dword ptr [EBP + 0xffffdfe4],ESI
00816ae8 : CALL EAX
00816aea : MOV EDX,dword ptr [EDI]
00816aec : MOV EDX,dword ptr [EDX + 0xc]
00816aef : PUSH 0x1
00816af1 : PUSH 0x2
00816af3 : LEA EAX,[ESI + 0x4]
00816af6 : PUSH EAX
00816af7 : MOV ECX,EDI
00816af9 : CALL EDX
00816afb : MOV EAX,dword ptr [EDI]
00816afd : MOV EDX,dword ptr [EAX + 0xc]
00816b00 : PUSH 0x1
00816b02 : PUSH 0x2
00816b04 : LEA ECX,[ESI + 0x6]
00816b07 : PUSH ECX
00816b08 : MOV ECX,EDI
00816b0a : CALL EDX
00816b0c : MOV EAX,dword ptr [ESI]
00816b0e : MOV dword ptr [EBP + 0xffffdfd4],EAX
00816b14 : MOV EAX,dword ptr [EBP + 0xffffdfe0]
00816b1a : LEA ECX,[EBP + 0xffffdfd4]
00816b20 : PUSH ECX
00816b21 : LEA EDX,[EBP + 0xffffdfa8]
00816b27 : PUSH EDX
00816b28 : ADD EAX,0x98
00816b2d : MOV dword ptr [EBP + 0xffffdfd8],ESI
00816b33 : CALL 0x00451e00
00816b38 : MOV EBX,ESI
00816b3a : JMP 0x00816a55
00816b3f : MOV EAX,dword ptr [EDI]
00816b41 : MOV EDX,dword ptr [EAX + 0xc]
00816b44 : PUSH 0x1
00816b46 : PUSH 0x1
00816b48 : LEA ECX,[EBP + 0xffffdfe8]
00816b4e : PUSH ECX
00816b4f : XOR ESI,ESI
00816b51 : MOV ECX,EDI
00816b53 : MOV dword ptr [EBP + 0xffffdfe8],ESI
00816b59 : CALL EDX
00816b5b : CMP dword ptr [EBP + 0xffffdfe8],ESI
00816b61 : JBE 0x00816a55
00816b67 : MOV EAX,dword ptr [EDI]
00816b69 : MOV EDX,dword ptr [EAX + 0xc]
00816b6c : PUSH 0x1
00816b6e : PUSH 0x4
00816b70 : LEA ECX,[EBP + 0xffffdfdc]
00816b76 : PUSH ECX
00816b77 : MOV ECX,EDI
00816b79 : CALL EDX
00816b7b : MOV EAX,dword ptr [EBP + 0xffffdfdc]
00816b81 : PUSH EAX
00816b82 : MOV EAX,EBX
00816b84 : CALL 0x00453250
00816b89 : INC ESI
00816b8a : CMP ESI,dword ptr [EBP + 0xffffdfe8]
00816b90 : JC 0x00816b67
00816b92 : JMP 0x00816a55
00816b97 : MOV EDX,dword ptr [EDI]
00816b99 : MOV EDX,dword ptr [EDX + 0xc]
00816b9c : PUSH 0x1
00816b9e : PUSH 0x1
00816ba0 : LEA EAX,[EBP + 0xffffdfe8]
00816ba6 : XOR ESI,ESI
00816ba8 : PUSH EAX
00816ba9 : MOV ECX,EDI
00816bab : MOV dword ptr [EBP + 0xffffdfe8],ESI
00816bb1 : CALL EDX
00816bb3 : CMP dword ptr [EBP + 0xffffdfe8],ESI
00816bb9 : JBE 0x00816a55
00816bbf : ADD EBX,0x8
00816bc2 : LEA EAX,[EBP + 0xffffdfec]
00816bc8 : PUSH EAX
00816bc9 : CALL 0x0070d080
00816bce : XOR ECX,ECX
00816bd0 : LEA EAX,[EBP + 0xffffdfec]
00816bd6 : MOV dword ptr [EBP + 0xffffdfc8],0x7
00816be0 : MOV dword ptr [EBP + 0xffffdfc4],0x0
00816bea : MOV word ptr [EBP + 0xffffdfb4],CX
00816bf1 : LEA EDX,[EAX + 0x2]
00816bf4 : MOV CX,word ptr [EAX]
00816bf7 : ADD EAX,0x2
00816bfa : TEST CX,CX
00816bfd : JNZ 0x00816bf4
00816bff : SUB EAX,EDX
00816c01 : SAR EAX,0x1
00816c03 : PUSH EAX
00816c04 : LEA EDX,[EBP + 0xffffdfec]
00816c0a : PUSH EDX
00816c0b : LEA ECX,[EBP + 0xffffdfb0]
00816c11 : CALL 0x00406360
00816c16 : MOV dword ptr [EBP + -0x4],0x1
00816c1d : LEA EAX,[EBP + 0xffffdfb0]
00816c23 : PUSH EAX
00816c24 : MOV EAX,EBX
00816c26 : CALL 0x00405ae0
00816c2b : MOV dword ptr [EBP + -0x4],0xffffffff
00816c32 : CMP dword ptr [EBP + 0xffffdfc8],0x8
00816c39 : JC 0x00816c46
00816c3b : MOV ECX,dword ptr [EBP + 0xffffdfb4]
00816c41 : CALL 0x006f04e0
00816c46 : XOR ECX,ECX
00816c48 : INC ESI
00816c49 : MOV dword ptr [EBP + 0xffffdfc8],0x7
00816c53 : MOV dword ptr [EBP + 0xffffdfc4],0x0
00816c5d : MOV word ptr [EBP + 0xffffdfb4],CX
00816c64 : CMP ESI,dword ptr [EBP + 0xffffdfe8]
00816c6a : JC 0x00816bc2
00816c70 : MOV EBX,dword ptr [EBP + 0xffffdfe4]
00816c76 : JMP 0x00816a55
00816c7b : MOV EDX,dword ptr [EDI]
00816c7d : MOV EAX,dword ptr [EBP + 0xffffdfd0]
00816c83 : MOV EDX,dword ptr [EDX + 0x24]
00816c86 : PUSH EAX
00816c87 : MOV ECX,EDI
00816c89 : CALL EDX
00816c8b : JMP 0x00816a55
00816c90 : MOV ECX,dword ptr [EBP + -0xc]
00816c93 : MOV dword ptr FS:[0x0],ECX
00816c9a : POP ECX
00816c9b : POP EDI
00816c9c : POP ESI
00816c9d : POP EBX
00816c9e : MOV ECX,dword ptr [EBP + -0x14]
00816ca1 : XOR ECX,EBP
00816ca3 : CALL 0x00633e6b
00816ca8 : MOV ESP,EBP
00816caa : POP EBP
00816cab : RET 0x4

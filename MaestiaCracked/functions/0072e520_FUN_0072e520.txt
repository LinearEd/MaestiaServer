PROGRAM  : Maestia.exe
FUNCTION : FUN_0072e520
ENTRY    : 0072e520
BODY     : [[0072e520, 0072e5b2]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_0072e520(undefined4 param_1)

{
  uint uVar1;
  int iVar2;
  int in_ECX;
  undefined4 uVar3;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b11315;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  EnterCriticalSection((LPCRITICAL_SECTION)(in_ECX + 0x1c));
  local_8 = 0;
  if (*(int *)(in_ECX + 0x34) == 0) {
    iVar2 = FUN_00664b00(param_1);
    if (iVar2 == 0) {
      uVar3 = 0x8007000e;
    }
    else {
      SetEvent(*(HANDLE *)(in_ECX + 0x68));
      uVar3 = FUN_0072e4c0(uVar1);
    }
  }
  else {
    uVar3 = 0x80040227;
  }
  local_8 = 0xffffffff;
  LeaveCriticalSection((LPCRITICAL_SECTION)(in_ECX + 0x1c));
  ExceptionList = local_10;
  return uVar3;
}



============================================================
DISASSEMBLY
============================================================
0072e520 : PUSH EBP
0072e521 : MOV EBP,ESP
0072e523 : PUSH -0x1
0072e525 : PUSH 0xb11315
0072e52a : MOV EAX,FS:[0x0]
0072e530 : PUSH EAX
0072e531 : PUSH ECX
0072e532 : PUSH ESI
0072e533 : PUSH EDI
0072e534 : MOV EAX,[0x00d66fa0]
0072e539 : XOR EAX,EBP
0072e53b : PUSH EAX
0072e53c : LEA EAX,[EBP + -0xc]
0072e53f : MOV FS:[0x0],EAX
0072e545 : MOV ESI,ECX
0072e547 : LEA EDI,[ESI + 0x1c]
0072e54a : PUSH EDI
0072e54b : MOV dword ptr [EBP + -0x10],EDI
0072e54e : CALL dword ptr [0x00b85118]
0072e554 : MOV dword ptr [EBP + -0x4],0x0
0072e55b : CMP dword ptr [ESI + 0x34],0x0
0072e55f : JZ 0x0072e568
0072e561 : MOV ESI,0x80040227
0072e566 : JMP 0x0072e590
0072e568 : MOV EAX,dword ptr [EBP + 0x8]
0072e56b : PUSH EAX
0072e56c : LEA ECX,[ESI + 0x38]
0072e56f : CALL 0x00664b00
0072e574 : TEST EAX,EAX
0072e576 : JZ 0x0072e58b
0072e578 : MOV ECX,dword ptr [ESI + 0x68]
0072e57b : PUSH ECX
0072e57c : CALL dword ptr [0x00b851e8]
0072e582 : CALL 0x0072e4c0
0072e587 : MOV ESI,EAX
0072e589 : JMP 0x0072e590
0072e58b : MOV ESI,0x8007000e
0072e590 : MOV dword ptr [EBP + -0x4],0xffffffff
0072e597 : PUSH EDI
0072e598 : CALL dword ptr [0x00b8511c]
0072e59e : MOV EAX,ESI
0072e5a0 : MOV ECX,dword ptr [EBP + -0xc]
0072e5a3 : MOV dword ptr FS:[0x0],ECX
0072e5aa : POP ECX
0072e5ab : POP EDI
0072e5ac : POP ESI
0072e5ad : MOV ESP,EBP
0072e5af : POP EBP
0072e5b0 : RET 0x4

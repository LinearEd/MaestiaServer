PROGRAM  : Maestia.exe
FUNCTION : FUN_006b9b70
ENTRY    : 006b9b70
BODY     : [[006b9b70, 006b9d40]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006b9b70(int *param_1)

{
  int iVar1;
  short sVar2;
  int iVar3;
  int *piVar4;
  ushort uVar5;
  uint uVar6;
  uint extraout_EDX;
  
  piVar4 = param_1;
  iVar3 = param_1[3];
  iVar1 = *(short *)(iVar3 + 0x16) + 4;
  if ((iVar1 == 0) ||
     (*(short *)(iVar3 + 0x16) + 4 + (int)*(short *)(iVar3 + 0x3a) + (int)*(short *)(iVar3 + 0x16)
      <= *(int *)(iVar3 + 4))) {
    param_1 = (int *)0x0;
  }
  else {
    param_1 = (int *)FUN_0068a300(iVar3,iVar1,0);
    if (param_1 != (int *)0x0) {
      return (int)param_1;
    }
  }
  sVar2 = *(short *)(iVar3 + 0x16);
  iVar1 = *(int *)(iVar3 + 0x18);
  *(int *)(iVar1 + sVar2 * 8) = piVar4[0x11];
  *(int *)(iVar1 + 4 + sVar2 * 8) = piVar4[0x12];
  sVar2 = *(short *)(iVar3 + 0x16);
  iVar1 = *(int *)(iVar3 + 0x18);
  *(int *)(iVar1 + 8 + sVar2 * 8) = piVar4[0x13];
  *(int *)(iVar1 + 0xc + sVar2 * 8) = piVar4[0x14];
  sVar2 = *(short *)(iVar3 + 0x16);
  iVar1 = *(int *)(iVar3 + 0x18);
  *(int *)(iVar1 + 0x10 + sVar2 * 8) = piVar4[0x2e];
  *(int *)(iVar1 + 0x14 + sVar2 * 8) = piVar4[0x2f];
  sVar2 = *(short *)(iVar3 + 0x16);
  iVar1 = *(int *)(iVar3 + 0x18);
  *(int *)(iVar1 + 0x18 + sVar2 * 8) = piVar4[0x30];
  *(int *)(iVar1 + 0x1c + sVar2 * 8) = piVar4[0x31];
  *(undefined1 *)((int)*(short *)(iVar3 + 0x16) + *(int *)(iVar3 + 0x1c)) = 0;
  *(undefined1 *)(*(short *)(iVar3 + 0x16) + 1 + *(int *)(iVar3 + 0x1c)) = 0;
  *(undefined1 *)(*(short *)(iVar3 + 0x16) + 2 + *(int *)(iVar3 + 0x1c)) = 0;
  *(undefined1 *)(*(short *)(iVar3 + 0x16) + 3 + *(int *)(iVar3 + 0x1c)) = 0;
  iVar1 = piVar4[6];
  param_1 = (int *)FUN_006877c0(iVar1,piVar4[0x2a]);
  if ((param_1 == (int *)0x0) && (uVar5 = FUN_00687a80(iVar1,&param_1), param_1 == (int *)0x0)) {
    if (*(ushort *)(*piVar4 + 0x11e) < uVar5) {
      return 0x16;
    }
    if (uVar5 == 0) {
      return 0;
    }
    param_1 = (int *)FUN_006888a0(iVar1,*(undefined4 *)(piVar4[0x28] + 0x188),(uint)uVar5);
    if (param_1 == (int *)0x0) {
      *(undefined4 *)(piVar4[2] + 0x88) = *(undefined4 *)(piVar4[0x28] + 0x188);
      *(uint *)(piVar4[2] + 0x8c) = (uint)uVar5;
      FUN_006b3180();
      uVar6 = extraout_EDX;
      if (extraout_EDX < *(ushort *)(piVar4 + 0x21)) {
        do {
          *(byte *)(piVar4[0x25] + uVar6) = *(byte *)(piVar4[0x25] + uVar6) & 0xe7;
          uVar6 = uVar6 + 1;
        } while (uVar6 < *(ushort *)(piVar4 + 0x21));
      }
      *(short *)(piVar4 + 0x21) = (short)piVar4[0x21] + 4;
      param_1 = (int *)FUN_006b9780(piVar4,1);
    }
  }
  return (int)param_1;
}



============================================================
DISASSEMBLY
============================================================
006b9b70 : PUSH EBX
006b9b71 : PUSH EBP
006b9b72 : MOV EBP,dword ptr [ESP + 0xc]
006b9b76 : PUSH ESI
006b9b77 : MOV ESI,dword ptr [EBP + 0xc]
006b9b7a : MOVSX ECX,word ptr [ESI + 0x16]
006b9b7e : LEA EAX,[ECX + 0x4]
006b9b81 : XOR EBX,EBX
006b9b83 : PUSH EDI
006b9b84 : CMP EAX,EBX
006b9b86 : JZ 0x006b9c96
006b9b8c : MOVSX EDX,word ptr [ESI + 0x3a]
006b9b90 : MOVSX EDI,word ptr [ESI + 0x16]
006b9b94 : ADD EDX,ECX
006b9b96 : LEA ECX,[EDI + EDX*0x1 + 0x4]
006b9b9a : CMP ECX,dword ptr [ESI + 0x4]
006b9b9d : JLE 0x006b9c96
006b9ba3 : PUSH EBX
006b9ba4 : PUSH EAX
006b9ba5 : PUSH ESI
006b9ba6 : CALL 0x0068a300
006b9bab : ADD ESP,0xc
006b9bae : MOV dword ptr [ESP + 0x14],EAX
006b9bb2 : CMP EAX,EBX
006b9bb4 : JNZ 0x006b9d3c
006b9bba : MOVSX ECX,word ptr [ESI + 0x16]
006b9bbe : MOV EAX,dword ptr [ESI + 0x18]
006b9bc1 : MOV EDX,dword ptr [EBP + 0x44]
006b9bc4 : MOV dword ptr [EAX + ECX*0x8],EDX
006b9bc7 : MOV EDX,dword ptr [EBP + 0x48]
006b9bca : MOV dword ptr [EAX + ECX*0x8 + 0x4],EDX
006b9bce : MOVSX ECX,word ptr [ESI + 0x16]
006b9bd2 : MOV EAX,dword ptr [ESI + 0x18]
006b9bd5 : MOV EDX,dword ptr [EBP + 0x4c]
006b9bd8 : MOV dword ptr [EAX + ECX*0x8 + 0x8],EDX
006b9bdc : MOV EDX,dword ptr [EBP + 0x50]
006b9bdf : MOV dword ptr [EAX + ECX*0x8 + 0xc],EDX
006b9be3 : MOVSX ECX,word ptr [ESI + 0x16]
006b9be7 : MOV EAX,dword ptr [ESI + 0x18]
006b9bea : MOV EDX,dword ptr [EBP + 0xb8]
006b9bf0 : MOV dword ptr [EAX + ECX*0x8 + 0x10],EDX
006b9bf4 : MOV EDX,dword ptr [EBP + 0xbc]
006b9bfa : MOV dword ptr [EAX + ECX*0x8 + 0x14],EDX
006b9bfe : MOVSX ECX,word ptr [ESI + 0x16]
006b9c02 : MOV EAX,dword ptr [ESI + 0x18]
006b9c05 : MOV EDX,dword ptr [EBP + 0xc0]
006b9c0b : MOV dword ptr [EAX + ECX*0x8 + 0x18],EDX
006b9c0f : MOV EDX,dword ptr [EBP + 0xc4]
006b9c15 : MOV dword ptr [EAX + ECX*0x8 + 0x1c],EDX
006b9c19 : MOVSX EAX,word ptr [ESI + 0x16]
006b9c1d : MOV ECX,dword ptr [ESI + 0x1c]
006b9c20 : MOV byte ptr [EAX + ECX*0x1],BL
006b9c23 : MOVSX EDX,word ptr [ESI + 0x16]
006b9c27 : MOV EAX,dword ptr [ESI + 0x1c]
006b9c2a : MOV byte ptr [EDX + EAX*0x1 + 0x1],BL
006b9c2e : MOVSX ECX,word ptr [ESI + 0x16]
006b9c32 : MOV EDX,dword ptr [ESI + 0x1c]
006b9c35 : MOV byte ptr [ECX + EDX*0x1 + 0x2],BL
006b9c39 : MOVSX EAX,word ptr [ESI + 0x16]
006b9c3d : MOV ECX,dword ptr [ESI + 0x1c]
006b9c40 : MOV byte ptr [EAX + ECX*0x1 + 0x3],BL
006b9c44 : MOV EDX,dword ptr [EBP + 0xa8]
006b9c4a : MOV ESI,dword ptr [EBP + 0x18]
006b9c4d : PUSH EDX
006b9c4e : PUSH ESI
006b9c4f : CALL 0x006877c0
006b9c54 : ADD ESP,0x8
006b9c57 : MOV dword ptr [ESP + 0x14],EAX
006b9c5b : CMP EAX,EBX
006b9c5d : JNZ 0x006b9d3c
006b9c63 : LEA EAX,[ESP + 0x14]
006b9c67 : PUSH EAX
006b9c68 : PUSH ESI
006b9c69 : CALL 0x00687a80
006b9c6e : MOVZX ECX,AX
006b9c71 : MOV EAX,dword ptr [ESP + 0x1c]
006b9c75 : ADD ESP,0x8
006b9c78 : CMP EAX,EBX
006b9c7a : JNZ 0x006b9d3c
006b9c80 : MOV EDX,dword ptr [EBP]
006b9c83 : CMP CX,word ptr [EDX + 0x11e]
006b9c8a : JBE 0x006b9c9f
006b9c8c : POP EDI
006b9c8d : POP ESI
006b9c8e : POP EBP
006b9c8f : MOV EAX,0x16
006b9c94 : POP EBX
006b9c95 : RET
006b9c96 : MOV dword ptr [ESP + 0x14],EBX
006b9c9a : JMP 0x006b9bba
006b9c9f : CMP CX,BX
006b9ca2 : JNZ 0x006b9cab
006b9ca4 : POP EDI
006b9ca5 : POP ESI
006b9ca6 : POP EBP
006b9ca7 : XOR EAX,EAX
006b9ca9 : POP EBX
006b9caa : RET
006b9cab : MOV EAX,dword ptr [EBP + 0xa0]
006b9cb1 : MOVZX EDI,CX
006b9cb4 : MOV ECX,dword ptr [EAX + 0x188]
006b9cba : PUSH EDI
006b9cbb : PUSH ECX
006b9cbc : PUSH ESI
006b9cbd : CALL 0x006888a0
006b9cc2 : ADD ESP,0xc
006b9cc5 : MOV dword ptr [ESP + 0x14],EAX
006b9cc9 : CMP EAX,EBX
006b9ccb : JNZ 0x006b9d3c
006b9ccd : MOV EDX,dword ptr [EBP + 0xa0]
006b9cd3 : MOV ECX,dword ptr [EDX + 0x188]
006b9cd9 : MOV EAX,dword ptr [EBP + 0x8]
006b9cdc : MOV dword ptr [EAX + 0x88],ECX
006b9ce2 : MOV EDX,dword ptr [EBP + 0x8]
006b9ce5 : MOV dword ptr [EDX + 0x8c],EDI
006b9ceb : MOV ECX,dword ptr [EBP + 0xc]
006b9cee : MOV EDI,dword ptr [ESP + 0x1c]
006b9cf2 : MOV EDX,dword ptr [ESP + 0x18]
006b9cf6 : ADD ECX,0x14
006b9cf9 : LEA EAX,[EBP + 0x7c]
006b9cfc : CALL 0x006b3180
006b9d01 : MOVZX ECX,word ptr [EBP + 0x84]
006b9d08 : MOV EAX,EDX
006b9d0a : CMP EDX,ECX
006b9d0c : JNC 0x006b9d29
006b9d0e : MOV EDI,EDI
006b9d10 : MOV EDX,dword ptr [EBP + 0x94]
006b9d16 : AND byte ptr [EDX + EAX*0x1],0xe7
006b9d1a : LEA ECX,[EDX + EAX*0x1]
006b9d1d : MOVZX ECX,word ptr [EBP + 0x84]
006b9d24 : INC EAX
006b9d25 : CMP EAX,ECX
006b9d27 : JC 0x006b9d10
006b9d29 : ADD word ptr [EBP + 0x84],0x4
006b9d31 : PUSH 0x1
006b9d33 : PUSH EBP
006b9d34 : CALL 0x006b9780
006b9d39 : ADD ESP,0x8
006b9d3c : POP EDI
006b9d3d : POP ESI
006b9d3e : POP EBP
006b9d3f : POP EBX
006b9d40 : RET

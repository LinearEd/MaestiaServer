PROGRAM  : Maestia.exe
FUNCTION : FUN_00787ef0
ENTRY    : 00787ef0
BODY     : [[00787ef0, 00787f61]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00787ef0(int param_1)

{
  uint uVar1;
  int *piVar2;
  int in_EAX;
  uint uVar3;
  int iVar4;
  undefined4 uVar5;
  int unaff_ESI;
  int iVar6;
  
  if (*(char *)(unaff_ESI + 4) != '\0') {
    return 0;
  }
  uVar3 = in_EAX * param_1;
  uVar1 = *(uint *)(unaff_ESI + 0x30);
  if (uVar3 < uVar1 || uVar3 - uVar1 == 0) {
    piVar2 = *(int **)(unaff_ESI + 0x28);
    iVar6 = 0;
    if (piVar2 != (int *)0x0) {
      iVar4 = *(int *)(unaff_ESI + 0x34);
      param_1 = 0;
      *(undefined1 *)(unaff_ESI + 0x3d) = 0;
      if (uVar3 < uVar1 - iVar4) {
        *(uint *)(unaff_ESI + 0x34) = iVar4 + uVar3;
        uVar5 = 0x1000;
        iVar6 = iVar4;
      }
      else {
        *(uint *)(unaff_ESI + 0x34) = uVar3;
        uVar5 = 0x2000;
      }
      iVar4 = (**(code **)(*piVar2 + 0x2c))(piVar2,iVar6,uVar3,&param_1,uVar5);
      if (-1 < iVar4) {
        *(int *)(unaff_ESI + 0x48) = iVar6;
        return param_1;
      }
    }
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00787ef0 : PUSH EBP
00787ef1 : MOV EBP,ESP
00787ef3 : CMP byte ptr [ESI + 0x4],0x0
00787ef7 : JZ 0x00787eff
00787ef9 : XOR EAX,EAX
00787efb : POP EBP
00787efc : RET 0x4
00787eff : IMUL EAX,dword ptr [EBP + 0x8]
00787f03 : MOV ECX,dword ptr [ESI + 0x30]
00787f06 : PUSH EBX
00787f07 : PUSH EDI
00787f08 : CMP EAX,ECX
00787f0a : JA 0x00787f5a
00787f0c : MOV EBX,dword ptr [ESI + 0x28]
00787f0f : XOR EDI,EDI
00787f11 : CMP EBX,EDI
00787f13 : JZ 0x00787f5a
00787f15 : MOV EDX,dword ptr [ESI + 0x34]
00787f18 : SUB ECX,EDX
00787f1a : MOV dword ptr [EBP + 0x8],EDI
00787f1d : MOV byte ptr [ESI + 0x3d],0x0
00787f21 : CMP ECX,EAX
00787f23 : JBE 0x00787f33
00787f25 : MOV EDI,EDX
00787f27 : ADD EDX,EAX
00787f29 : MOV dword ptr [ESI + 0x34],EDX
00787f2c : MOV ECX,0x1000
00787f31 : JMP 0x00787f3b
00787f33 : MOV dword ptr [ESI + 0x34],EAX
00787f36 : MOV ECX,0x2000
00787f3b : MOV EDX,dword ptr [EBX]
00787f3d : MOV EDX,dword ptr [EDX + 0x2c]
00787f40 : PUSH ECX
00787f41 : LEA ECX,[EBP + 0x8]
00787f44 : PUSH ECX
00787f45 : PUSH EAX
00787f46 : PUSH EDI
00787f47 : PUSH EBX
00787f48 : CALL EDX
00787f4a : TEST EAX,EAX
00787f4c : JL 0x00787f5a
00787f4e : MOV EAX,dword ptr [EBP + 0x8]
00787f51 : MOV dword ptr [ESI + 0x48],EDI
00787f54 : POP EDI
00787f55 : POP EBX
00787f56 : POP EBP
00787f57 : RET 0x4
00787f5a : POP EDI
00787f5b : XOR EAX,EAX
00787f5d : POP EBX
00787f5e : POP EBP
00787f5f : RET 0x4

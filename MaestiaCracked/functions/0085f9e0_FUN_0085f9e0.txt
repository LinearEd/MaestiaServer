PROGRAM  : Maestia.exe
FUNCTION : FUN_0085f9e0
ENTRY    : 0085f9e0
BODY     : [[0085f9e0, 0085fdab]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_0085f9e0(int *param_1)

{
  float *pfVar1;
  int *piVar2;
  char cVar3;
  int iVar4;
  float fVar5;
  undefined4 *puVar6;
  int iStack_13c;
  float fStack_138;
  int iStack_134;
  undefined4 uStack_12c;
  undefined4 uStack_128;
  float local_124;
  float local_120;
  float local_11c;
  int iStack_118;
  int iStack_114;
  int iStack_110;
  undefined4 uStack_10c;
  float fStack_108;
  undefined1 auStack_104 [8];
  undefined4 uStack_fc;
  undefined4 uStack_f8;
  undefined4 uStack_f4;
  undefined4 uStack_f0;
  undefined4 uStack_ec;
  undefined4 uStack_e8;
  undefined **appuStack_e4 [48];
  void *pvStack_24;
  undefined4 uStack_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_00b48ece;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  iVar4 = param_1[0xfa];
  local_124 = (float)param_1[0x560] - *(float *)(iVar4 + 0x68);
  local_120 = (float)param_1[0x561] - *(float *)(iVar4 + 0x6c);
  local_11c = (float)param_1[0x562] - *(float *)(iVar4 + 0x70);
  piVar2 = param_1 + 0x560;
  D3DXVec3Normalize(&local_124,&local_124,DAT_00d66fa0 ^ (uint)&stack0xfffffeb8);
  if ((*(char *)((int)param_1 + 0x15ae) != '\0') && ((char)param_1[0x56b] == '\0')) {
    (**(code **)(*param_1 + 0x2ac))(uStack_12c,local_124);
  }
  pfVar1 = (float *)(param_1 + 0x561);
  FUN_00891380(param_1,*piVar2,param_1[0x562],pfVar1,&stack0xfffffec3,auStack_104,1);
  iVar4 = *(int *)(*(int *)(DAT_0172491c + 0x90) + 0xf0);
  if (iVar4 != 0) {
    if ((*(char *)(iVar4 + 0x2a4c) == -1) && ((*(uint *)(iVar4 + 0x2a6c) >> 7 & 1) != 0)) {
      iStack_13c = *piVar2;
      fStack_138 = (float)param_1[0x561];
      iStack_134 = param_1[0x562];
      FUN_0085e880(param_1,piVar2,&iStack_13c,&uStack_12c,0);
      fVar5 = *pfVar1;
      if (*pfVar1 <= fStack_138) {
        fVar5 = fStack_138;
      }
      *pfVar1 = fVar5;
    }
  }
  if (param_1[0x563] == 0) {
    FUN_008597c0();
    (**(code **)(*param_1 + 0x254))(1,param_1 + 1,0);
  }
  (**(code **)(*param_1 + 0x2a0))(piVar2,1);
  piVar2 = *(int **)(DAT_00da93ec + 0xac);
  if (param_1 == piVar2) {
    piVar2[0xee] = param_1[0x11d];
    piVar2[0xef] = param_1[0x11e];
  }
  if (param_1[0x62a] == 0) goto LAB_0085fd8e;
  if (*(char *)(param_1[0x62a] + 0x20) == '\0') {
LAB_0085fbc7:
    puVar6 = &DAT_00d720f0;
  }
  else {
    cVar3 = FUN_00876040();
    if ((cVar3 != '\0') || (*(char *)(param_1[0x62a] + 0xec) != '\0')) goto LAB_0085fbc7;
    if (*(int *)(param_1[0x62a] + 0x30) == 0) goto LAB_0085fd8e;
    iStack_118 = param_1[0x560];
    iStack_114 = param_1[0x561];
    iStack_110 = param_1[0x562];
    D3DXVec3Normalize(&iStack_118,&iStack_118);
    uStack_fc = 0;
    uStack_f8 = 0xbf800000;
    uStack_f4 = 0;
    iVar4 = FUN_007d5b60(appuStack_e4);
    iStack_13c = *(int *)(iVar4 + 0x28);
    uStack_1c = 0xffffffff;
    uStack_f0 = 0;
    uStack_ec = 0;
    uStack_e8 = 0;
    local_11c = 0.0;
    appuStack_e4[0] = &PTR_FUN_00cd083c;
    fStack_108 = 0.0;
    iVar4 = FUN_007e9d70(*(undefined4 *)(DAT_00da93ec + 0xc),&uStack_fc,&uStack_10c,&uStack_f0,
                         &local_11c);
    uStack_128 = 0;
    local_124 = 0.0;
    local_120 = 0.0;
    FUN_007e3cb0(*(undefined4 *)(param_1[0xfa] + 0x68),*(undefined4 *)(param_1[0xfa] + 0x70),
                 &fStack_138,&stack0xfffffebb,&uStack_128);
    if ((iVar4 != 0) && (fStack_138 < fStack_108)) goto LAB_0085fbc7;
    D3DXVec3Normalize(&uStack_128,&uStack_128);
    puVar6 = &uStack_10c;
    FUN_00855280(&uStack_128);
  }
  FUN_00856310(puVar6);
LAB_0085fd8e:
  ExceptionList = pvStack_24;
  return param_1[0x563];
}



============================================================
DISASSEMBLY
============================================================
0085f9e0 : PUSH EBP
0085f9e1 : MOV EBP,ESP
0085f9e3 : AND ESP,0xfffffff8
0085f9e6 : PUSH -0x1
0085f9e8 : PUSH 0xb48ece
0085f9ed : MOV EAX,FS:[0x0]
0085f9f3 : PUSH EAX
0085f9f4 : SUB ESP,0x128
0085f9fa : PUSH EBX
0085f9fb : PUSH ESI
0085f9fc : PUSH EDI
0085f9fd : MOV EAX,[0x00d66fa0]
0085fa02 : XOR EAX,ESP
0085fa04 : PUSH EAX
0085fa05 : LEA EAX,[ESP + 0x138]
0085fa0c : MOV FS:[0x0],EAX
0085fa12 : MOV EBX,dword ptr [EBP + 0x8]
0085fa15 : MOV EAX,dword ptr [EBX + 0x3e8]
0085fa1b : MOVSS XMM0,dword ptr [EBX + 0x1580]
0085fa23 : SUBSS XMM0,dword ptr [EAX + 0x68]
0085fa28 : MOVSS XMM1,dword ptr [EBX + 0x1584]
0085fa30 : SUBSS XMM1,dword ptr [EAX + 0x6c]
0085fa35 : MOVSS XMM2,dword ptr [EBX + 0x1588]
0085fa3d : SUBSS XMM2,dword ptr [EAX + 0x70]
0085fa42 : ADD EAX,0x68
0085fa45 : LEA EDI,[EBX + 0x1580]
0085fa4b : LEA EAX,[ESP + 0x28]
0085fa4f : PUSH EAX
0085fa50 : MOV ECX,EAX
0085fa52 : PUSH ECX
0085fa53 : MOVSS dword ptr [ESP + 0x30],XMM0
0085fa59 : MOVSS dword ptr [ESP + 0x34],XMM1
0085fa5f : MOVSS dword ptr [ESP + 0x38],XMM2
0085fa65 : CALL 0x004ff722
0085fa6a : MOV AL,byte ptr [EBX + 0x15ae]
0085fa70 : TEST AL,AL
0085fa72 : JZ 0x0085fa9b
0085fa74 : CMP byte ptr [EBX + 0x15ac],0x0
0085fa7b : JNZ 0x0085fa9b
0085fa7d : FLD float ptr [ESP + 0x30]
0085fa81 : MOV EDX,dword ptr [EBX]
0085fa83 : MOV EAX,dword ptr [EDX + 0x2ac]
0085fa89 : SUB ESP,0x8
0085fa8c : FSTP float ptr [ESP + 0x4]
0085fa90 : MOV ECX,EBX
0085fa92 : FLD float ptr [ESP + 0x30]
0085fa96 : FSTP float ptr [ESP]
0085fa99 : CALL EAX
0085fa9b : FLD float ptr [EBX + 0x1588]
0085faa1 : PUSH 0x1
0085faa3 : LEA ECX,[ESP + 0x54]
0085faa7 : PUSH ECX
0085faa8 : LEA EDX,[ESP + 0x1f]
0085faac : PUSH EDX
0085faad : LEA ESI,[EBX + 0x1584]
0085fab3 : PUSH ESI
0085fab4 : SUB ESP,0x8
0085fab7 : FSTP float ptr [ESP + 0x4]
0085fabb : MOV byte ptr [ESP + 0x2f],0xff
0085fac0 : FLD float ptr [EDI]
0085fac2 : FSTP float ptr [ESP]
0085fac5 : PUSH EBX
0085fac6 : CALL 0x00891380
0085facb : MOV EAX,[0x0172491c]
0085fad0 : MOV EAX,dword ptr [EAX + 0x90]
0085fad6 : MOV EAX,dword ptr [EAX + 0xf0]
0085fadc : TEST EAX,EAX
0085fade : JZ 0x0085fb51
0085fae0 : MOV DL,byte ptr [ESP + 0x17]
0085fae4 : MOVZX ECX,DL
0085fae7 : LEA ECX,[ECX + ECX*0x4]
0085faea : CMP byte ptr [EAX + ECX*0x8 + 0x274],DL
0085faf1 : LEA EAX,[EAX + ECX*0x8]
0085faf4 : JNZ 0x0085fb51
0085faf6 : MOV EDX,dword ptr [EAX + 0x294]
0085fafc : SHR EDX,0x7
0085faff : AND EDX,0x1
0085fb02 : JZ 0x0085fb51
0085fb04 : FLDZ
0085fb06 : MOVSS XMM0,dword ptr [EDI]
0085fb0a : MOVSS XMM1,dword ptr [EDI + 0x4]
0085fb0f : MOVSS XMM2,dword ptr [EDI + 0x8]
0085fb14 : PUSH ECX
0085fb15 : FSTP float ptr [ESP]
0085fb18 : LEA EAX,[ESP + 0x2c]
0085fb1c : PUSH EAX
0085fb1d : LEA ECX,[ESP + 0x20]
0085fb21 : PUSH ECX
0085fb22 : PUSH EDI
0085fb23 : PUSH EBX
0085fb24 : MOVSS dword ptr [ESP + 0x2c],XMM0
0085fb2a : MOVSS dword ptr [ESP + 0x30],XMM1
0085fb30 : MOVSS dword ptr [ESP + 0x34],XMM2
0085fb36 : CALL 0x0085e880
0085fb3b : MOVSS XMM0,dword ptr [ESI]
0085fb3f : MOVSS XMM1,dword ptr [ESP + 0x1c]
0085fb45 : COMISS XMM0,XMM1
0085fb48 : JA 0x0085fb4d
0085fb4a : MOVAPS XMM0,XMM1
0085fb4d : MOVSS dword ptr [ESI],XMM0
0085fb51 : CMP dword ptr [EBX + 0x158c],0x0
0085fb58 : JNZ 0x0085fb7d
0085fb5a : MOV CL,byte ptr [EBX + 0x1624]
0085fb60 : XOR EAX,EAX
0085fb62 : MOV ESI,EBX
0085fb64 : CALL 0x008597c0
0085fb69 : MOV EDX,dword ptr [EBX]
0085fb6b : MOV EDX,dword ptr [EDX + 0x254]
0085fb71 : PUSH 0x0
0085fb73 : LEA EAX,[EBX + 0x4]
0085fb76 : PUSH EAX
0085fb77 : PUSH 0x1
0085fb79 : MOV ECX,EBX
0085fb7b : CALL EDX
0085fb7d : MOV EAX,dword ptr [EBX]
0085fb7f : MOV EDX,dword ptr [EAX + 0x2a0]
0085fb85 : PUSH 0x1
0085fb87 : PUSH EDI
0085fb88 : MOV ECX,EBX
0085fb8a : CALL EDX
0085fb8c : MOV EAX,[0x00da93ec]
0085fb91 : MOV EAX,dword ptr [EAX + 0xac]
0085fb97 : CMP EBX,EAX
0085fb99 : JNZ 0x0085fbb3
0085fb9b : MOV ECX,dword ptr [EBX + 0x474]
0085fba1 : MOV dword ptr [EAX + 0x3b8],ECX
0085fba7 : MOV EDX,dword ptr [EBX + 0x478]
0085fbad : MOV dword ptr [EAX + 0x3bc],EDX
0085fbb3 : MOV EAX,dword ptr [EBX + 0x18a8]
0085fbb9 : TEST EAX,EAX
0085fbbb : JZ 0x0085fd8e
0085fbc1 : CMP byte ptr [EAX + 0x20],0x0
0085fbc5 : JNZ 0x0085fbd1
0085fbc7 : PUSH 0xd720f0
0085fbcc : JMP 0x0085fd87
0085fbd1 : MOV EAX,dword ptr [EBX + 0x138]
0085fbd7 : MOV ECX,dword ptr [EAX + 0x4]
0085fbda : LEA ESI,[EBX + 0x1c58]
0085fbe0 : LEA EDI,[ECX + EBX*0x1 + 0x138]
0085fbe7 : CALL 0x00876040
0085fbec : TEST AL,AL
0085fbee : JNZ 0x0085fbc7
0085fbf0 : MOV EAX,dword ptr [EBX + 0x18a8]
0085fbf6 : CMP byte ptr [EAX + 0xec],0x0
0085fbfd : JNZ 0x0085fbc7
0085fbff : CMP dword ptr [EAX + 0x30],0x0
0085fc03 : JZ 0x0085fd8e
0085fc09 : MOVSS XMM0,dword ptr [EBX + 0x1580]
0085fc11 : MOVSS XMM1,dword ptr [EBX + 0x1584]
0085fc19 : MOVSS XMM2,dword ptr [EBX + 0x1588]
0085fc21 : LEA EDX,[ESP + 0x44]
0085fc25 : PUSH EDX
0085fc26 : MOV EAX,EDX
0085fc28 : PUSH EAX
0085fc29 : MOVSS dword ptr [ESP + 0x4c],XMM0
0085fc2f : MOVSS dword ptr [ESP + 0x50],XMM1
0085fc35 : MOVSS dword ptr [ESP + 0x54],XMM2
0085fc3b : CALL 0x004ff722
0085fc40 : XORPS XMM0,XMM0
0085fc43 : MOVSS XMM1,dword ptr [0x00cdf0d0]
0085fc4b : LEA ECX,[ESP + 0x78]
0085fc4f : PUSH ECX
0085fc50 : MOV ECX,dword ptr [EBX + 0x3e8]
0085fc56 : MOVSS dword ptr [ESP + 0x64],XMM0
0085fc5c : MOVSS dword ptr [ESP + 0x68],XMM1
0085fc62 : MOVSS dword ptr [ESP + 0x6c],XMM0
0085fc68 : CALL 0x007d5b60
0085fc6d : MOV dword ptr [ESP + 0x140],0x0
0085fc78 : MOVSS XMM0,dword ptr [EAX + 0x20]
0085fc7d : MOVSS XMM1,dword ptr [EAX + 0x24]
0085fc82 : MOVSS XMM2,dword ptr [EAX + 0x28]
0085fc87 : MOVSS dword ptr [ESP + 0x18],XMM0
0085fc8d : MOVSS dword ptr [ESP + 0x1c],XMM1
0085fc93 : MOVSS dword ptr [ESP + 0x20],XMM2
0085fc99 : MOV dword ptr [ESP + 0x140],0xffffffff
0085fca4 : MOVSS XMM0,dword ptr [ESP + 0x1c]
0085fcaa : ADDSS XMM0,dword ptr [0x00d72c20]
0085fcb2 : MOV EDX,dword ptr [0x00da93ec]
0085fcb8 : MOVSS dword ptr [ESP + 0x1c],XMM0
0085fcbe : XORPS XMM0,XMM0
0085fcc1 : MOVSS dword ptr [ESP + 0x6c],XMM0
0085fcc7 : MOVSS dword ptr [ESP + 0x70],XMM0
0085fccd : MOVSS dword ptr [ESP + 0x74],XMM0
0085fcd3 : MOVSS dword ptr [ESP + 0x40],XMM0
0085fcd9 : LEA ECX,[ESP + 0x40]
0085fcdd : PUSH ECX
0085fcde : MOV dword ptr [ESP + 0x7c],0xcd083c
0085fce6 : MOV EAX,dword ptr [EDX + 0xc]
0085fce9 : LEA EDX,[ESP + 0x70]
0085fced : PUSH EDX
0085fcee : LEA ECX,[ESP + 0x58]
0085fcf2 : PUSH ECX
0085fcf3 : LEA EDX,[ESP + 0x6c]
0085fcf7 : PUSH EDX
0085fcf8 : PUSH EAX
0085fcf9 : LEA EDI,[ESP + 0x2c]
0085fcfd : MOVSS dword ptr [ESP + 0x68],XMM0
0085fd03 : CALL 0x007e9d70
0085fd08 : XORPS XMM0,XMM0
0085fd0b : LEA ECX,[ESP + 0x34]
0085fd0f : PUSH ECX
0085fd10 : LEA EDX,[ESP + 0x1b]
0085fd14 : PUSH EDX
0085fd15 : MOV EDX,dword ptr [0x00da93ec]
0085fd1b : LEA ECX,[ESP + 0x2c]
0085fd1f : MOV ESI,EAX
0085fd21 : MOV EAX,dword ptr [EBX + 0x3e8]
0085fd27 : MOVSS dword ptr [ESP + 0x3c],XMM0
0085fd2d : MOVSS dword ptr [ESP + 0x40],XMM0
0085fd33 : MOVSS dword ptr [ESP + 0x44],XMM0
0085fd39 : FLD float ptr [EAX + 0x70]
0085fd3c : MOV EDI,dword ptr [EDX + 0xc]
0085fd3f : PUSH ECX
0085fd40 : SUB ESP,0x8
0085fd43 : FSTP float ptr [ESP + 0x4]
0085fd47 : FLD float ptr [EAX + 0x68]
0085fd4a : FSTP float ptr [ESP]
0085fd4d : CALL 0x007e3cb0
0085fd52 : TEST ESI,ESI
0085fd54 : JZ 0x0085fd67
0085fd56 : MOVSS XMM0,dword ptr [ESP + 0x54]
0085fd5c : COMISS XMM0,dword ptr [ESP + 0x24]
0085fd61 : JA 0x0085fbc7
0085fd67 : LEA EAX,[ESP + 0x34]
0085fd6b : PUSH EAX
0085fd6c : MOV ECX,EAX
0085fd6e : PUSH ECX
0085fd6f : CALL 0x004ff722
0085fd74 : LEA EDX,[ESP + 0x34]
0085fd78 : PUSH EDX
0085fd79 : LEA EDI,[ESP + 0x54]
0085fd7d : MOV EAX,EBX
0085fd7f : CALL 0x00855280
0085fd84 : MOV EAX,EDI
0085fd86 : PUSH EAX
0085fd87 : MOV ESI,EBX
0085fd89 : CALL 0x00856310
0085fd8e : MOV EAX,dword ptr [EBX + 0x158c]
0085fd94 : MOV ECX,dword ptr [ESP + 0x138]
0085fd9b : MOV dword ptr FS:[0x0],ECX
0085fda2 : POP ECX
0085fda3 : POP EDI
0085fda4 : POP ESI
0085fda5 : POP EBX
0085fda6 : MOV ESP,EBP
0085fda8 : POP EBP
0085fda9 : RET 0x4

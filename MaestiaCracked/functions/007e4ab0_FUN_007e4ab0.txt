PROGRAM  : Maestia.exe
FUNCTION : FUN_007e4ab0
ENTRY    : 007e4ab0
BODY     : [[007e4ab0, 007e4c8f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007e4ab0(int param_1,undefined1 param_2)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  int in_ECX;
  int iVar4;
  int in_EDX;
  undefined1 local_34 [24];
  uint local_1c;
  undefined2 local_18;
  undefined1 local_16;
  undefined1 local_15;
  undefined2 local_13;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b320db;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(int *)(param_1 + 0x2a78) == 0) {
    if (DAT_00d6d738 != 0) {
      FUN_00406460(L"m_pWorldGrid NULL !!");
      local_8 = 0;
      if ((int *)*DAT_00da98e8 != (int *)0x0) {
        (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                  (L"AvaLib::AvaTerrainSceneMgr::SetWorldGrid",0x1802,local_34,uVar3);
      }
      local_8 = 0xffffffff;
      if (7 < local_1c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      DAT_00d6d738 = 0;
    }
  }
  else {
    iVar1 = *(int *)(param_1 + 0x9c);
    if (iVar1 == 0) {
      FUN_00406460(L"m_spZone load Fail");
      local_8 = 1;
      if ((int *)*DAT_00da98e8 != (int *)0x0) {
        (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                  (L"AvaLib::AvaTerrainSceneMgr::SetWorldGrid",0x180a,local_34);
      }
      local_8 = 0xffffffff;
      if (7 < local_1c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
    }
    else if ((uint)(in_ECX * in_EDX) < (uint)(*(int *)(iVar1 + 0x4c) * *(int *)(iVar1 + 0x4c))) {
      local_18 = 0;
      local_13 = 0;
      local_15 = 0;
      local_16 = param_2;
      iVar1 = *(int *)(param_1 + 0x2a78) + 4 + (*(int *)(iVar1 + 0x4c) * in_ECX + in_EDX) * 0x14;
      iVar4 = *(int *)(iVar1 + 8) - *(int *)(iVar1 + 4);
      iVar2 = iVar4 >> 0x1f;
      if (iVar4 / 7 + iVar2 == iVar2) {
        FUN_0045e990(iVar1,&local_18);
        ExceptionList = local_10;
        return;
      }
    }
    else {
      FUN_00406460(L"m_pMask buffer overrun !!");
      local_8 = 2;
      if ((int *)*DAT_00da98e8 != (int *)0x0) {
        (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                  (L"AvaLib::AvaTerrainSceneMgr::SetWorldGrid",0x1811,local_34);
      }
      local_8 = 0xffffffff;
      if (7 < local_1c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
007e4ab0 : PUSH EBP
007e4ab1 : MOV EBP,ESP
007e4ab3 : PUSH -0x1
007e4ab5 : PUSH 0xb320db
007e4aba : MOV EAX,FS:[0x0]
007e4ac0 : PUSH EAX
007e4ac1 : SUB ESP,0x24
007e4ac4 : PUSH EBX
007e4ac5 : PUSH ESI
007e4ac6 : PUSH EDI
007e4ac7 : MOV EAX,[0x00d66fa0]
007e4acc : XOR EAX,EBP
007e4ace : PUSH EAX
007e4acf : LEA EAX,[EBP + -0xc]
007e4ad2 : MOV FS:[0x0],EAX
007e4ad8 : MOV ESI,ECX
007e4ada : MOV EAX,dword ptr [EBP + 0x8]
007e4add : MOV ECX,dword ptr [EAX + 0x2a78]
007e4ae3 : XOR EBX,EBX
007e4ae5 : CMP ECX,EBX
007e4ae7 : JNZ 0x007e4b4e
007e4ae9 : CMP dword ptr [0x00d6d738],EBX
007e4aef : JZ 0x007e4c7c
007e4af5 : PUSH 0xc23924
007e4afa : LEA ECX,[EBP + -0x30]
007e4afd : CALL 0x00406460
007e4b02 : MOV dword ptr [EBP + -0x4],EBX
007e4b05 : MOV EAX,[0x00da98e8]
007e4b0a : MOV ECX,dword ptr [EAX]
007e4b0c : CMP ECX,EBX
007e4b0e : JZ 0x007e4b25
007e4b10 : MOV EDX,dword ptr [ECX]
007e4b12 : MOV EDX,dword ptr [EDX + 0x14]
007e4b15 : LEA EAX,[EBP + -0x30]
007e4b18 : PUSH EAX
007e4b19 : PUSH 0x1802
007e4b1e : PUSH 0xc23950
007e4b23 : CALL EDX
007e4b25 : MOV dword ptr [EBP + -0x4],0xffffffff
007e4b2c : CMP dword ptr [EBP + -0x18],0x8
007e4b30 : JC 0x007e4b3a
007e4b32 : MOV ECX,dword ptr [EBP + -0x2c]
007e4b35 : CALL 0x006f04e0
007e4b3a : XOR EAX,EAX
007e4b3c : MOV dword ptr [EBP + -0x1c],EBX
007e4b3f : MOV word ptr [EBP + -0x2c],AX
007e4b43 : MOV dword ptr [0x00d6d738],EBX
007e4b49 : JMP 0x007e4c75
007e4b4e : MOV EDI,dword ptr [EAX + 0x9c]
007e4b54 : CMP EDI,EBX
007e4b56 : JNZ 0x007e4bb0
007e4b58 : PUSH 0xc239a4
007e4b5d : LEA ECX,[EBP + -0x30]
007e4b60 : CALL 0x00406460
007e4b65 : MOV dword ptr [EBP + -0x4],0x1
007e4b6c : MOV ECX,dword ptr [0x00da98e8]
007e4b72 : MOV ECX,dword ptr [ECX]
007e4b74 : CMP ECX,EBX
007e4b76 : JZ 0x007e4b8d
007e4b78 : MOV EDX,dword ptr [ECX]
007e4b7a : MOV EDX,dword ptr [EDX + 0x14]
007e4b7d : LEA EAX,[EBP + -0x30]
007e4b80 : PUSH EAX
007e4b81 : PUSH 0x180a
007e4b86 : PUSH 0xc239d0
007e4b8b : CALL EDX
007e4b8d : MOV dword ptr [EBP + -0x4],0xffffffff
007e4b94 : CMP dword ptr [EBP + -0x18],0x8
007e4b98 : JC 0x007e4ba2
007e4b9a : MOV ECX,dword ptr [EBP + -0x2c]
007e4b9d : CALL 0x006f04e0
007e4ba2 : XOR EAX,EAX
007e4ba4 : MOV dword ptr [EBP + -0x1c],EBX
007e4ba7 : MOV word ptr [EBP + -0x2c],AX
007e4bab : JMP 0x007e4c75
007e4bb0 : MOV EAX,EDI
007e4bb2 : MOV EBX,dword ptr [EAX + 0x4c]
007e4bb5 : MOV EAX,EBX
007e4bb7 : IMUL EAX,EBX
007e4bba : MOV EBX,ESI
007e4bbc : IMUL EBX,EDX
007e4bbf : CMP EBX,EAX
007e4bc1 : JNC 0x007e4c1e
007e4bc3 : XOR EAX,EAX
007e4bc5 : MOV word ptr [EBP + -0x14],AX
007e4bc9 : MOV word ptr [EBP + -0xf],AX
007e4bcd : MOV byte ptr [EBP + -0x11],AL
007e4bd0 : MOV AL,byte ptr [EBP + 0xc]
007e4bd3 : MOV byte ptr [EBP + -0x12],AL
007e4bd6 : MOV EAX,dword ptr [EDI + 0x4c]
007e4bd9 : IMUL EAX,ESI
007e4bdc : ADD EAX,EDX
007e4bde : LEA EDX,[EAX + EAX*0x4]
007e4be1 : LEA ESI,[ECX + EDX*0x4 + 0x4]
007e4be5 : MOV ECX,dword ptr [ESI + 0x8]
007e4be8 : SUB ECX,dword ptr [ESI + 0x4]
007e4beb : MOV EAX,0x92492493
007e4bf0 : IMUL ECX
007e4bf2 : ADD EDX,ECX
007e4bf4 : SAR EDX,0x2
007e4bf7 : MOV EAX,EDX
007e4bf9 : SHR EAX,0x1f
007e4bfc : ADD EAX,EDX
007e4bfe : JNZ 0x007e4c7c
007e4c00 : LEA ECX,[EBP + -0x14]
007e4c03 : PUSH ECX
007e4c04 : PUSH ESI
007e4c05 : CALL 0x0045e990
007e4c0a : MOV ECX,dword ptr [EBP + -0xc]
007e4c0d : MOV dword ptr FS:[0x0],ECX
007e4c14 : POP ECX
007e4c15 : POP EDI
007e4c16 : POP ESI
007e4c17 : POP EBX
007e4c18 : MOV ESP,EBP
007e4c1a : POP EBP
007e4c1b : RET 0x8
007e4c1e : PUSH 0xc23a24
007e4c23 : LEA ECX,[EBP + -0x30]
007e4c26 : CALL 0x00406460
007e4c2b : MOV dword ptr [EBP + -0x4],0x2
007e4c32 : MOV EDX,dword ptr [0x00da98e8]
007e4c38 : MOV ECX,dword ptr [EDX]
007e4c3a : TEST ECX,ECX
007e4c3c : JZ 0x007e4c53
007e4c3e : MOV EAX,dword ptr [ECX]
007e4c40 : MOV EAX,dword ptr [EAX + 0x14]
007e4c43 : LEA EDX,[EBP + -0x30]
007e4c46 : PUSH EDX
007e4c47 : PUSH 0x1811
007e4c4c : PUSH 0xc23a58
007e4c51 : CALL EAX
007e4c53 : MOV dword ptr [EBP + -0x4],0xffffffff
007e4c5a : CMP dword ptr [EBP + -0x18],0x8
007e4c5e : JC 0x007e4c68
007e4c60 : MOV ECX,dword ptr [EBP + -0x2c]
007e4c63 : CALL 0x006f04e0
007e4c68 : XOR ECX,ECX
007e4c6a : MOV dword ptr [EBP + -0x1c],0x0
007e4c71 : MOV word ptr [EBP + -0x2c],CX
007e4c75 : MOV dword ptr [EBP + -0x18],0x7
007e4c7c : MOV ECX,dword ptr [EBP + -0xc]
007e4c7f : MOV dword ptr FS:[0x0],ECX
007e4c86 : POP ECX
007e4c87 : POP EDI
007e4c88 : POP ESI
007e4c89 : POP EBX
007e4c8a : MOV ESP,EBP
007e4c8c : POP EBP
007e4c8d : RET 0x8

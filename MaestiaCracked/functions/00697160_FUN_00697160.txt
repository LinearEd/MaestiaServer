PROGRAM  : Maestia.exe
FUNCTION : FUN_00697160
ENTRY    : 00697160
BODY     : [[00697160, 00697261]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00697160(int param_1,undefined4 param_2,undefined4 param_3,byte param_4,undefined4 param_5,
                undefined4 param_6,byte *param_7)

{
  int iVar1;
  undefined4 uVar2;
  int iVar3;
  undefined4 local_c;
  undefined4 local_8;
  int local_4;
  
  iVar1 = FUN_00696a40(param_1,param_3,param_2,&local_8,&local_4,&local_c);
  if ((iVar1 == 0) &&
     ((iVar1 = (**(code **)(param_1 + 0x1fc))(param_1,0x45424454,param_5,0), iVar1 == 0 ||
      (iVar1 = (**(code **)(param_1 + 0x1fc))(param_1,0x62646174,param_5,0), iVar1 == 0)))) {
    uVar2 = FUN_00687830(param_5);
    iVar1 = FUN_00696e70(local_4,local_8,uVar2,local_c,*(undefined4 *)(param_1 + 0x54),0,0,param_5,
                         param_7,0);
    if (iVar1 == 0) {
      if ((*(byte *)(local_4 + 0x2f) & 1) != 0) {
        iVar3 = (int)*(char *)(local_4 + 0x10) - (int)*(char *)(local_4 + 0x11);
        param_7[5] = -(param_7[1] >> 1);
        param_7[6] = (byte)((int)(iVar3 - (uint)*param_7) / 2);
        iVar3 = iVar3 * 0xc;
        param_7[7] = ((char)(iVar3 / 10) + (char)(iVar3 >> 0x1f)) -
                     (char)((longlong)iVar3 * 0x66666667 >> 0x3f);
      }
      if ((param_4 & 0x40) != 0) {
        FUN_00696b80(param_7);
      }
    }
  }
  return iVar1;
}



============================================================
DISASSEMBLY
============================================================
00697160 : SUB ESP,0xc
00697163 : PUSH EDI
00697164 : MOV EDI,dword ptr [ESP + 0x14]
00697168 : LEA EAX,[ESP + 0x4]
0069716c : PUSH EAX
0069716d : MOV EAX,dword ptr [ESP + 0x1c]
00697171 : LEA ECX,[ESP + 0x10]
00697175 : PUSH ECX
00697176 : MOV ECX,dword ptr [ESP + 0x24]
0069717a : LEA EDX,[ESP + 0x10]
0069717e : PUSH EDX
0069717f : PUSH EAX
00697180 : PUSH ECX
00697181 : PUSH EDI
00697182 : CALL 0x00696a40
00697187 : ADD ESP,0x18
0069718a : TEST EAX,EAX
0069718c : JNZ 0x0069725d
00697192 : MOV EDX,dword ptr [EDI + 0x1fc]
00697198 : PUSH EBX
00697199 : MOV EBX,dword ptr [ESP + 0x28]
0069719d : PUSH EAX
0069719e : PUSH EBX
0069719f : PUSH 0x45424454
006971a4 : PUSH EDI
006971a5 : CALL EDX
006971a7 : ADD ESP,0x10
006971aa : TEST EAX,EAX
006971ac : JZ 0x006971ca
006971ae : MOV EAX,dword ptr [EDI + 0x1fc]
006971b4 : PUSH 0x0
006971b6 : PUSH EBX
006971b7 : PUSH 0x62646174
006971bc : PUSH EDI
006971bd : CALL EAX
006971bf : ADD ESP,0x10
006971c2 : TEST EAX,EAX
006971c4 : JNZ 0x0069725c
006971ca : PUSH EBP
006971cb : PUSH ESI
006971cc : PUSH EBX
006971cd : CALL 0x00687830
006971d2 : MOV ESI,dword ptr [ESP + 0x3c]
006971d6 : MOV ECX,dword ptr [EDI + 0x54]
006971d9 : MOV EDX,dword ptr [ESP + 0x14]
006971dd : MOV EDI,dword ptr [ESP + 0x1c]
006971e1 : PUSH 0x0
006971e3 : PUSH ESI
006971e4 : PUSH EBX
006971e5 : PUSH 0x0
006971e7 : PUSH 0x0
006971e9 : PUSH ECX
006971ea : PUSH EDX
006971eb : PUSH EAX
006971ec : MOV EAX,dword ptr [ESP + 0x38]
006971f0 : PUSH EAX
006971f1 : PUSH EDI
006971f2 : CALL 0x00696e70
006971f7 : MOV EBP,EAX
006971f9 : ADD ESP,0x2c
006971fc : TEST EBP,EBP
006971fe : JNZ 0x00697258
00697200 : TEST byte ptr [EDI + 0x2f],0x1
00697204 : JZ 0x00697244
00697206 : MOVSX EDX,byte ptr [EDI + 0x11]
0069720a : MOVSX ECX,byte ptr [EDI + 0x10]
0069720e : MOV AL,byte ptr [ESI + 0x1]
00697211 : SHR AL,0x1
00697213 : NEG AL
00697215 : SUB ECX,EDX
00697217 : MOVZX EDX,byte ptr [ESI]
0069721a : MOV byte ptr [ESI + 0x5],AL
0069721d : MOV EAX,ECX
0069721f : SUB EAX,EDX
00697221 : CDQ
00697222 : SUB EAX,EDX
00697224 : SAR EAX,0x1
00697226 : MOV byte ptr [ESI + 0x6],AL
00697229 : LEA ECX,[ECX + ECX*0x2]
0069722c : ADD ECX,ECX
0069722e : ADD ECX,ECX
00697230 : MOV EAX,0x66666667
00697235 : IMUL ECX
00697237 : SAR EDX,0x2
0069723a : MOV EAX,EDX
0069723c : SHR EAX,0x1f
0069723f : ADD EAX,EDX
00697241 : MOV byte ptr [ESI + 0x7],AL
00697244 : TEST byte ptr [ESP + 0x2c],0x40
00697249 : JZ 0x00697258
0069724b : MOV EBX,dword ptr [ESP + 0x34]
0069724f : PUSH ESI
00697250 : CALL 0x00696b80
00697255 : ADD ESP,0x4
00697258 : POP ESI
00697259 : MOV EAX,EBP
0069725b : POP EBP
0069725c : POP EBX
0069725d : POP EDI
0069725e : ADD ESP,0xc
00697261 : RET

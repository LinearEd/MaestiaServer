PROGRAM  : Maestia.exe
FUNCTION : FUN_009ae1c0
ENTRY    : 009ae1c0
BODY     : [[009ae1c0, 009ae3d7]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009ae1c0(void)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  DWORD DVar4;
  int in_ECX;
  int iVar5;
  int iVar6;
  int *piVar7;
  LPCRITICAL_SECTION local_44;
  char *local_40;
  undefined4 local_3c;
  int local_38;
  undefined4 local_34;
  int *local_2c;
  int *local_28;
  undefined4 local_24;
  undefined4 local_20;
  int *local_1c;
  int local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  puStack_c = &LAB_00b21707;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_2c = (int *)0x0;
  local_28 = (int *)0x0;
  local_24 = 0;
  local_8 = 0;
  local_44 = (LPCRITICAL_SECTION)(in_ECX + 0xc0);
  local_38 = 0;
  local_40 = ".\\Gui\\AvaGuiChatWindowMgr.cpp";
  local_3c = 0x83;
  local_34 = 1;
  FUN_006ef1a0(&local_44);
  local_8 = CONCAT31(local_8._1_3_,1);
  if (*(int *)(in_ECX + 0x54) == 0) {
    local_8 = (uint)local_8._1_3_ << 8;
    if (local_38 != 0) {
      LeaveCriticalSection(local_44);
    }
    ExceptionList = local_10;
    return;
  }
  DVar4 = timeGetTime();
  if (100 < DVar4 - *(int *)(in_ECX + 0x90)) {
    DVar4 = timeGetTime();
    *(DWORD *)(in_ECX + 0x90) = DVar4;
    local_1c = *(int **)(in_ECX + 0x50);
    local_20 = *(undefined4 *)(in_ECX + 0x38);
    if (local_1c != (int *)(*(int *)(in_ECX + 0x54) + (int)local_1c)) {
      local_1c = (int *)FUN_004c1520(uVar3);
      local_1c = (int *)*local_1c;
      FUN_00449610();
      FUN_00410290();
    }
  }
  local_8 = local_8 & 0xffffff00;
  if (local_38 != 0) {
    LeaveCriticalSection(local_44);
    local_38 = 0;
  }
  if ((((int)local_28 - (int)local_2c & 0xfffffffcU) != 0) &&
     (local_1c = local_2c, piVar7 = local_28, local_2c != local_28)) {
    do {
      iVar1 = *DAT_00da9894;
      iVar2 = *local_1c;
      if ((iVar1 != 0) && (*(int *)(iVar1 + 0x114) != 0)) {
        if (*(uint *)(iVar2 + 0x74) < 8) {
          local_14 = iVar2 + 0x60;
        }
        else {
          local_14 = *(int *)(iVar2 + 0x60);
        }
        if (*(uint *)(iVar2 + 0x50) < 8) {
          local_18 = iVar2 + 0x3c;
        }
        else {
          local_18 = *(int *)(iVar2 + 0x3c);
        }
        if (*(uint *)(iVar2 + 0x34) < 8) {
          iVar6 = iVar2 + 0x20;
        }
        else {
          iVar6 = *(int *)(iVar2 + 0x20);
        }
        if (*(uint *)(iVar2 + 0x18) < 8) {
          iVar5 = iVar2 + 4;
        }
        else {
          iVar5 = *(int *)(iVar2 + 4);
        }
        (**(code **)(**(int **)(iVar1 + 0x114) + 4))
                  (*(int **)(iVar1 + 0x114),"ChatWindowInputText","%ls,%d,%ls,%ls,%d,%d,%ls,%b",
                   iVar5,*(undefined4 *)(iVar2 + 0x78),iVar6,local_18,*(undefined4 *)(iVar2 + 0x54),
                   *(undefined4 *)(iVar2 + 0x58),local_14,*(undefined1 *)(iVar2 + 0x7c));
        piVar7 = local_28;
      }
      if (iVar2 != 0) {
        FUN_0041f1e0(iVar2);
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_1c = local_1c + 1;
    } while (local_1c != piVar7);
  }
  local_8 = 0xffffffff;
  if (local_2c != (int *)0x0) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
009ae1c0 : PUSH EBP
009ae1c1 : MOV EBP,ESP
009ae1c3 : PUSH -0x1
009ae1c5 : PUSH 0xb21707
009ae1ca : MOV EAX,FS:[0x0]
009ae1d0 : PUSH EAX
009ae1d1 : SUB ESP,0x34
009ae1d4 : PUSH EBX
009ae1d5 : PUSH ESI
009ae1d6 : PUSH EDI
009ae1d7 : MOV EAX,[0x00d66fa0]
009ae1dc : XOR EAX,EBP
009ae1de : PUSH EAX
009ae1df : LEA EAX,[EBP + -0xc]
009ae1e2 : MOV FS:[0x0],EAX
009ae1e8 : MOV ESI,ECX
009ae1ea : XOR EDI,EDI
009ae1ec : MOV dword ptr [EBP + -0x28],EDI
009ae1ef : MOV dword ptr [EBP + -0x24],EDI
009ae1f2 : MOV dword ptr [EBP + -0x20],EDI
009ae1f5 : MOV dword ptr [EBP + -0x4],EDI
009ae1f8 : LEA ECX,[EBP + -0x40]
009ae1fb : LEA EAX,[ESI + 0xc0]
009ae201 : MOV EBX,0x1
009ae206 : PUSH ECX
009ae207 : MOV dword ptr [EBP + -0x34],EDI
009ae20a : MOV dword ptr [EBP + -0x40],EAX
009ae20d : MOV dword ptr [EBP + -0x3c],0xc8b6d0
009ae214 : MOV dword ptr [EBP + -0x38],0x83
009ae21b : MOV dword ptr [EBP + -0x30],EBX
009ae21e : CALL 0x006ef1a0
009ae223 : MOV byte ptr [EBP + -0x4],BL
009ae226 : CMP dword ptr [ESI + 0x54],EDI
009ae229 : JNZ 0x009ae263
009ae22b : MOV byte ptr [EBP + -0x4],0x0
009ae22f : CMP dword ptr [EBP + -0x34],EDI
009ae232 : JZ 0x009ae241
009ae234 : MOV EDX,dword ptr [EBP + -0x40]
009ae237 : PUSH EDX
009ae238 : CALL dword ptr [0x00b8511c]
009ae23e : MOV dword ptr [EBP + -0x34],EDI
009ae241 : MOV dword ptr [EBP + -0x4],0xffffffff
009ae248 : MOV dword ptr [EBP + -0x28],EDI
009ae24b : MOV dword ptr [EBP + -0x24],EDI
009ae24e : MOV dword ptr [EBP + -0x20],EDI
009ae251 : MOV ECX,dword ptr [EBP + -0xc]
009ae254 : MOV dword ptr FS:[0x0],ECX
009ae25b : POP ECX
009ae25c : POP EDI
009ae25d : POP ESI
009ae25e : POP EBX
009ae25f : MOV ESP,EBP
009ae261 : POP EBP
009ae262 : RET
009ae263 : MOV EDI,dword ptr [0x00b85598]
009ae269 : CALL EDI
009ae26b : SUB EAX,dword ptr [ESI + 0x90]
009ae271 : CMP EAX,0x64
009ae274 : JBE 0x009ae2b9
009ae276 : CALL EDI
009ae278 : MOV dword ptr [ESI + 0x90],EAX
009ae27e : MOV ECX,dword ptr [ESI + 0x50]
009ae281 : MOV EDX,dword ptr [ESI + 0x38]
009ae284 : MOV EAX,dword ptr [ESI + 0x54]
009ae287 : ADD ESI,0x38
009ae28a : ADD EAX,ECX
009ae28c : MOV dword ptr [EBP + -0x1c],EDX
009ae28f : MOV dword ptr [EBP + -0x18],ECX
009ae292 : CMP EDX,EDX
009ae294 : JNZ 0x009ae29a
009ae296 : CMP ECX,EAX
009ae298 : JZ 0x009ae2b9
009ae29a : LEA EDX,[EBP + -0x1c]
009ae29d : CALL 0x004c1520
009ae2a2 : MOV EAX,dword ptr [EAX]
009ae2a4 : LEA EDI,[EBP + -0x18]
009ae2a7 : LEA EDX,[EBP + -0x2c]
009ae2aa : MOV dword ptr [EBP + -0x18],EAX
009ae2ad : CALL 0x00449610
009ae2b2 : MOV EAX,ESI
009ae2b4 : CALL 0x00410290
009ae2b9 : MOV byte ptr [EBP + -0x4],0x0
009ae2bd : XOR ESI,ESI
009ae2bf : CMP dword ptr [EBP + -0x34],ESI
009ae2c2 : JZ 0x009ae2d1
009ae2c4 : MOV ECX,dword ptr [EBP + -0x40]
009ae2c7 : PUSH ECX
009ae2c8 : CALL dword ptr [0x00b8511c]
009ae2ce : MOV dword ptr [EBP + -0x34],ESI
009ae2d1 : MOV EBX,dword ptr [EBP + -0x24]
009ae2d4 : MOV ECX,dword ptr [EBP + -0x28]
009ae2d7 : MOV EDX,EBX
009ae2d9 : SUB EDX,ECX
009ae2db : TEST EDX,0xfffffffc
009ae2e1 : JZ 0x009ae3ad
009ae2e7 : MOV EDI,ECX
009ae2e9 : MOV dword ptr [EBP + -0x18],EDI
009ae2ec : CMP ECX,EBX
009ae2ee : JZ 0x009ae3ad
009ae2f4 : MOV EAX,[0x00da9894]
009ae2f9 : MOV EAX,dword ptr [EAX]
009ae2fb : MOV ESI,dword ptr [EDI]
009ae2fd : TEST EAX,EAX
009ae2ff : JZ 0x009ae389
009ae305 : CMP dword ptr [EAX + 0x114],0x0
009ae30c : JZ 0x009ae389
009ae30e : MOV EAX,dword ptr [EAX + 0x114]
009ae314 : MOV ECX,0x8
009ae319 : CMP dword ptr [ESI + 0x74],ECX
009ae31c : JC 0x009ae323
009ae31e : MOV EDX,dword ptr [ESI + 0x60]
009ae321 : JMP 0x009ae326
009ae323 : LEA EDX,[ESI + 0x60]
009ae326 : MOV dword ptr [EBP + -0x10],EDX
009ae329 : CMP dword ptr [ESI + 0x50],ECX
009ae32c : JC 0x009ae333
009ae32e : MOV EDX,dword ptr [ESI + 0x3c]
009ae331 : JMP 0x009ae336
009ae333 : LEA EDX,[ESI + 0x3c]
009ae336 : MOV dword ptr [EBP + -0x14],EDX
009ae339 : CMP dword ptr [ESI + 0x34],ECX
009ae33c : JC 0x009ae343
009ae33e : MOV EDX,dword ptr [ESI + 0x20]
009ae341 : JMP 0x009ae346
009ae343 : LEA EDX,[ESI + 0x20]
009ae346 : CMP dword ptr [ESI + 0x18],ECX
009ae349 : JC 0x009ae350
009ae34b : MOV ECX,dword ptr [ESI + 0x4]
009ae34e : JMP 0x009ae353
009ae350 : LEA ECX,[ESI + 0x4]
009ae353 : MOVZX EBX,byte ptr [ESI + 0x7c]
009ae357 : PUSH EBX
009ae358 : MOV EBX,dword ptr [EBP + -0x10]
009ae35b : MOV EDI,dword ptr [EAX]
009ae35d : PUSH EBX
009ae35e : MOV EBX,dword ptr [ESI + 0x58]
009ae361 : PUSH EBX
009ae362 : MOV EBX,dword ptr [ESI + 0x54]
009ae365 : PUSH EBX
009ae366 : MOV EBX,dword ptr [EBP + -0x14]
009ae369 : PUSH EBX
009ae36a : PUSH EDX
009ae36b : MOV EDX,dword ptr [ESI + 0x78]
009ae36e : PUSH EDX
009ae36f : PUSH ECX
009ae370 : PUSH 0xc8b6f0
009ae375 : PUSH 0xc8b70c
009ae37a : PUSH EAX
009ae37b : MOV EAX,dword ptr [EDI + 0x4]
009ae37e : CALL EAX
009ae380 : MOV EDI,dword ptr [EBP + -0x18]
009ae383 : MOV EBX,dword ptr [EBP + -0x24]
009ae386 : ADD ESP,0x2c
009ae389 : TEST ESI,ESI
009ae38b : JZ 0x009ae39a
009ae38d : PUSH ESI
009ae38e : CALL 0x0041f1e0
009ae393 : MOV ECX,ESI
009ae395 : CALL 0x006f04e0
009ae39a : ADD EDI,0x4
009ae39d : MOV dword ptr [EBP + -0x18],EDI
009ae3a0 : CMP EDI,EBX
009ae3a2 : JNZ 0x009ae2f4
009ae3a8 : MOV ECX,dword ptr [EBP + -0x28]
009ae3ab : XOR ESI,ESI
009ae3ad : MOV dword ptr [EBP + -0x4],0xffffffff
009ae3b4 : CMP ECX,ESI
009ae3b6 : JZ 0x009ae3bd
009ae3b8 : CALL 0x006f04e0
009ae3bd : MOV dword ptr [EBP + -0x28],ESI
009ae3c0 : MOV dword ptr [EBP + -0x24],ESI
009ae3c3 : MOV dword ptr [EBP + -0x20],ESI
009ae3c6 : MOV ECX,dword ptr [EBP + -0xc]
009ae3c9 : MOV dword ptr FS:[0x0],ECX
009ae3d0 : POP ECX
009ae3d1 : POP EDI
009ae3d2 : POP ESI
009ae3d3 : POP EBX
009ae3d4 : MOV ESP,EBP
009ae3d6 : POP EBP
009ae3d7 : RET

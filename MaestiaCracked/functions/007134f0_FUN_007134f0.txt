PROGRAM  : Maestia.exe
FUNCTION : FUN_007134f0
ENTRY    : 007134f0
BODY     : [[007134f0, 007137b6]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007134f0(void)

{
  byte *pbVar1;
  void *pvVar2;
  uint uVar3;
  int unaff_ESI;
  undefined1 local_4e4 [4];
  undefined2 local_4e0;
  undefined4 local_4d0;
  uint local_4cc;
  LPCRITICAL_SECTION local_4c8;
  char *local_4c4;
  undefined4 local_4c0;
  int local_4bc;
  undefined4 local_4b8;
  void *local_4b4;
  undefined **local_4b0;
  undefined1 local_4ac;
  undefined4 local_4a8;
  undefined4 local_4a4;
  FILE *local_4a0;
  undefined1 *local_49c;
  size_t local_498;
  undefined1 local_494 [1108];
  undefined4 local_40;
  void *local_3c;
  undefined4 local_38;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3b6ea;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  pvVar2 = _malloc(*(size_t *)(unaff_ESI + 0x60));
  local_4b4 = pvVar2;
  FUN_00a5d9f0(*(undefined4 *)(unaff_ESI + 4),local_30);
  local_4ac = 0;
  local_4a8 = 0;
  local_4a4 = 0;
  local_4b0 = &PTR_FUN_00cda538;
  local_4a0 = (FILE *)0x0;
  local_8._0_1_ = 1;
  local_8._1_3_ = 0;
  local_4c8 = (LPCRITICAL_SECTION)(*(int *)(unaff_ESI + 4) + 0xad8);
  local_4bc = 0;
  local_4c4 = ".\\MoVDFile.cpp";
  local_4c0 = 0x226;
  local_4b8 = 1;
  FUN_006ef1a0(&local_4c8);
  local_8._0_1_ = 2;
  local_4e0 = 0;
  local_4cc = 7;
  local_4d0 = 0;
  FUN_00406360(&PTR_LAB_00c00e20,2);
  local_8._0_1_ = 3;
  FUN_0070a9a0(local_30,local_4e4);
  local_8 = CONCAT31(local_8._1_3_,2);
  if (7 < local_4cc) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_4e0 = 0;
  local_4cc = 7;
  local_4d0 = 0;
  if (local_4a0 != (FILE *)0x0) {
    __fseek_nolock(local_4a0,*(long *)(unaff_ESI + 0x5c),0);
  }
  if (local_4a0 != (FILE *)0x0) {
    __fread_nolock(pvVar2,1,*(size_t *)(unaff_ESI + 0x60),local_4a0);
    if (local_4a0 != (FILE *)0x0) {
      _fflush(local_4a0);
      _fclose(local_4a0);
      local_4a0 = (FILE *)0x0;
    }
  }
  local_38 = *(undefined4 *)(unaff_ESI + 0x60);
  local_49c = (undefined1 *)0x0;
  local_498 = 0;
  local_40 = 0;
  local_3c = pvVar2;
  FUN_004ce240();
  local_8._0_1_ = 4;
  pvVar2 = (void *)FUN_0070a3a0();
  *(void **)(unaff_ESI + 0x58) = pvVar2;
  *(undefined1 *)(unaff_ESI + 0xd4) = 1;
  _memcpy(pvVar2,local_49c,local_498);
  *(size_t *)(unaff_ESI + 0x60) = local_498;
  _free(local_4b4);
  uVar3 = 0;
  if (*(int *)(unaff_ESI + 0x60) != 0) {
    do {
      pbVar1 = (byte *)(*(int *)(unaff_ESI + 0x58) + uVar3);
      *pbVar1 = *pbVar1 ^ *(byte *)(unaff_ESI + 0x46);
      uVar3 = uVar3 + 1;
    } while (uVar3 < *(uint *)(unaff_ESI + 0x60));
  }
  local_8._0_1_ = 2;
  if ((local_49c != local_494) && (local_49c != (undefined1 *)0x0)) {
    _free(local_49c);
  }
  local_8._0_1_ = 1;
  if (local_4bc != 0) {
    LeaveCriticalSection(local_4c8);
    local_4bc = 0;
  }
  local_8 = (uint)local_8._1_3_ << 8;
  local_4b0 = &PTR_FUN_00cda538;
  if (local_4a0 != (FILE *)0x0) {
    _fflush(local_4a0);
    _fclose(local_4a0);
    local_4a0 = (FILE *)0x0;
  }
  local_8 = 0xffffffff;
  if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_18 = 7;
  local_1c = 0;
  local_2c = 0;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
007134f0 : PUSH EBP
007134f1 : MOV EBP,ESP
007134f3 : PUSH -0x1
007134f5 : PUSH 0xb3b6ea
007134fa : MOV EAX,FS:[0x0]
00713500 : PUSH EAX
00713501 : SUB ESP,0x4d8
00713507 : MOV EAX,[0x00d66fa0]
0071350c : XOR EAX,EBP
0071350e : MOV dword ptr [EBP + -0x10],EAX
00713511 : PUSH EBX
00713512 : PUSH EDI
00713513 : PUSH EAX
00713514 : LEA EAX,[EBP + -0xc]
00713517 : MOV FS:[0x0],EAX
0071351d : MOV EAX,dword ptr [ESI + 0x60]
00713520 : PUSH EAX
00713521 : CALL 0x00636043
00713526 : MOV EDX,dword ptr [ESI + 0x4]
00713529 : ADD ESP,0x4
0071352c : LEA ECX,[EBP + -0x2c]
0071352f : PUSH ECX
00713530 : MOV EDI,EAX
00713532 : PUSH EDX
00713533 : MOV dword ptr [EBP + 0xfffffb50],EDI
00713539 : CALL 0x00a5d9f0
0071353e : XOR EBX,EBX
00713540 : MOV dword ptr [EBP + -0x4],EBX
00713543 : MOV dword ptr [EBP + 0xfffffb54],0xcd4c80
0071354d : MOV byte ptr [EBP + 0xfffffb58],BL
00713553 : MOV dword ptr [EBP + 0xfffffb5c],EBX
00713559 : MOV dword ptr [EBP + 0xfffffb60],EBX
0071355f : MOV dword ptr [EBP + 0xfffffb54],0xcda538
00713569 : MOV dword ptr [EBP + 0xfffffb64],EBX
0071356f : MOV byte ptr [EBP + -0x4],0x1
00713573 : MOV EAX,dword ptr [ESI + 0x4]
00713576 : ADD EAX,0xad8
0071357b : MOV dword ptr [EBP + 0xfffffb3c],EAX
00713581 : LEA EAX,[EBP + 0xfffffb3c]
00713587 : PUSH EAX
00713588 : MOV dword ptr [EBP + 0xfffffb48],EBX
0071358e : MOV dword ptr [EBP + 0xfffffb40],0xc00e10
00713598 : MOV dword ptr [EBP + 0xfffffb44],0x226
007135a2 : MOV dword ptr [EBP + 0xfffffb4c],0x1
007135ac : CALL 0x006ef1a0
007135b1 : MOV byte ptr [EBP + -0x4],0x2
007135b5 : XOR ECX,ECX
007135b7 : PUSH 0x2
007135b9 : MOV word ptr [EBP + 0xfffffb24],CX
007135c0 : PUSH 0xc00e20
007135c5 : LEA ECX,[EBP + 0xfffffb20]
007135cb : MOV dword ptr [EBP + 0xfffffb38],0x7
007135d5 : MOV dword ptr [EBP + 0xfffffb34],EBX
007135db : CALL 0x00406360
007135e0 : MOV byte ptr [EBP + -0x4],0x3
007135e4 : LEA EDX,[EBP + 0xfffffb20]
007135ea : PUSH EDX
007135eb : LEA EAX,[EBP + -0x2c]
007135ee : PUSH EAX
007135ef : LEA ECX,[EBP + 0xfffffb54]
007135f5 : CALL 0x0070a9a0
007135fa : MOV byte ptr [EBP + -0x4],0x2
007135fe : CMP dword ptr [EBP + 0xfffffb38],0x8
00713605 : JC 0x00713612
00713607 : MOV ECX,dword ptr [EBP + 0xfffffb24]
0071360d : CALL 0x006f04e0
00713612 : MOV EAX,dword ptr [EBP + 0xfffffb64]
00713618 : XOR ECX,ECX
0071361a : MOV word ptr [EBP + 0xfffffb24],CX
00713621 : MOV ECX,dword ptr [ESI + 0x5c]
00713624 : MOV dword ptr [EBP + 0xfffffb38],0x7
0071362e : MOV dword ptr [EBP + 0xfffffb34],EBX
00713634 : CMP EAX,EBX
00713636 : JZ 0x00713649
00713638 : PUSH EBX
00713639 : PUSH ECX
0071363a : PUSH EAX
0071363b : CALL 0x00637771
00713640 : MOV EAX,dword ptr [EBP + 0xfffffb64]
00713646 : ADD ESP,0xc
00713649 : MOV ECX,dword ptr [ESI + 0x60]
0071364c : CMP EAX,EBX
0071364e : JZ 0x00713682
00713650 : PUSH EAX
00713651 : PUSH ECX
00713652 : PUSH 0x1
00713654 : PUSH EDI
00713655 : CALL 0x00638ac8
0071365a : MOV EAX,dword ptr [EBP + 0xfffffb64]
00713660 : ADD ESP,0x10
00713663 : CMP EAX,EBX
00713665 : JZ 0x00713682
00713667 : PUSH EAX
00713668 : CALL 0x006395f7
0071366d : MOV EDX,dword ptr [EBP + 0xfffffb64]
00713673 : PUSH EDX
00713674 : CALL 0x006366db
00713679 : ADD ESP,0x8
0071367c : MOV dword ptr [EBP + 0xfffffb64],EBX
00713682 : MOV EAX,dword ptr [ESI + 0x60]
00713685 : MOV dword ptr [EBP + -0x38],EDI
00713688 : LEA EDI,[EBP + 0xfffffb68]
0071368e : MOV dword ptr [EBP + 0xfffffb68],EBX
00713694 : MOV dword ptr [EBP + 0xfffffb6c],EBX
0071369a : MOV dword ptr [EBP + -0x3c],EBX
0071369d : MOV dword ptr [EBP + -0x34],EAX
007136a0 : CALL 0x004ce240
007136a5 : MOV byte ptr [EBP + -0x4],0x4
007136a9 : MOV ECX,dword ptr [EBP + 0xfffffb6c]
007136af : CALL 0x0070a3a0
007136b4 : MOV ECX,dword ptr [EBP + 0xfffffb6c]
007136ba : MOV EDX,dword ptr [EBP + 0xfffffb68]
007136c0 : PUSH ECX
007136c1 : PUSH EDX
007136c2 : PUSH EAX
007136c3 : MOV dword ptr [ESI + 0x58],EAX
007136c6 : MOV byte ptr [ESI + 0xd4],0x1
007136cd : CALL 0x0063ae40
007136d2 : MOV ECX,dword ptr [EBP + 0xfffffb50]
007136d8 : MOV EAX,dword ptr [EBP + 0xfffffb6c]
007136de : PUSH ECX
007136df : MOV dword ptr [ESI + 0x60],EAX
007136e2 : CALL 0x0063610d
007136e7 : ADD ESP,0x10
007136ea : XOR EAX,EAX
007136ec : CMP dword ptr [ESI + 0x60],EBX
007136ef : JBE 0x00713703
007136f1 : MOV EDX,dword ptr [ESI + 0x58]
007136f4 : MOV CL,byte ptr [ESI + 0x46]
007136f7 : XOR byte ptr [EDX + EAX*0x1],CL
007136fa : LEA EDI,[EDX + EAX*0x1]
007136fd : INC EAX
007136fe : CMP EAX,dword ptr [ESI + 0x60]
00713701 : JC 0x007136f1
00713703 : MOV byte ptr [EBP + -0x4],0x2
00713707 : MOV EAX,dword ptr [EBP + 0xfffffb68]
0071370d : LEA EDX,[EBP + 0xfffffb70]
00713713 : CMP EAX,EDX
00713715 : JZ 0x00713724
00713717 : CMP EAX,EBX
00713719 : JZ 0x00713724
0071371b : PUSH EAX
0071371c : CALL 0x0063610d
00713721 : ADD ESP,0x4
00713724 : MOV byte ptr [EBP + -0x4],0x1
00713728 : CMP dword ptr [EBP + 0xfffffb48],EBX
0071372e : JZ 0x00713743
00713730 : MOV EAX,dword ptr [EBP + 0xfffffb3c]
00713736 : PUSH EAX
00713737 : CALL dword ptr [0x00b8511c]
0071373d : MOV dword ptr [EBP + 0xfffffb48],EBX
00713743 : MOV byte ptr [EBP + -0x4],BL
00713746 : MOV EAX,dword ptr [EBP + 0xfffffb64]
0071374c : MOV dword ptr [EBP + 0xfffffb54],0xcda538
00713756 : CMP EAX,EBX
00713758 : JZ 0x00713775
0071375a : PUSH EAX
0071375b : CALL 0x006395f7
00713760 : MOV ECX,dword ptr [EBP + 0xfffffb64]
00713766 : PUSH ECX
00713767 : CALL 0x006366db
0071376c : ADD ESP,0x8
0071376f : MOV dword ptr [EBP + 0xfffffb64],EBX
00713775 : MOV dword ptr [EBP + -0x4],0xffffffff
0071377c : CMP dword ptr [EBP + -0x14],0x8
00713780 : JC 0x0071378a
00713782 : MOV ECX,dword ptr [EBP + -0x28]
00713785 : CALL 0x006f04e0
0071378a : XOR EDX,EDX
0071378c : MOV dword ptr [EBP + -0x14],0x7
00713793 : MOV dword ptr [EBP + -0x18],EBX
00713796 : MOV word ptr [EBP + -0x28],DX
0071379a : MOV AL,0x1
0071379c : MOV ECX,dword ptr [EBP + -0xc]
0071379f : MOV dword ptr FS:[0x0],ECX
007137a6 : POP ECX
007137a7 : POP EDI
007137a8 : POP EBX
007137a9 : MOV ECX,dword ptr [EBP + -0x10]
007137ac : XOR ECX,EBP
007137ae : CALL 0x00633e6b
007137b3 : MOV ESP,EBP
007137b5 : POP EBP
007137b6 : RET

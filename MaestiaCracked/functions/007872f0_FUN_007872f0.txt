PROGRAM  : Maestia.exe
FUNCTION : FUN_007872f0
ENTRY    : 007872f0
BODY     : [[007872f0, 007873d5]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_007872f0(undefined4 *param_1)

{
  uint uVar1;
  BOOL BVar2;
  undefined4 uVar3;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_00b3c29c;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (param_1 + 1 == (undefined4 *)0x0) {
    DAT_0172523c = (undefined4 *)0x0;
  }
  else {
    DAT_0172523c = param_1;
  }
  local_8 = 0;
  *param_1 = &PTR_FUN_00cd78c4;
  FUN_0042b160(param_1 + 5);
  local_8 = CONCAT31(local_8._1_3_,1);
  param_1[8] = &PTR_FUN_00cdec94;
  BVar2 = InitializeCriticalSectionAndSpinCount((LPCRITICAL_SECTION)(param_1 + 9),4000);
  if (BVar2 == 0) {
    InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 9));
  }
  local_8 = CONCAT31(local_8._1_3_,2);
  param_1[2] = 0x80;
  param_1[1] = 0;
  param_1[4] = 0;
  uVar3 = FUN_006f0760(0x200,"",0,(DAT_01725270 >> 3 & 1) == 0,uVar1);
  param_1[3] = uVar3;
  ExceptionList = local_10;
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
007872f0 : PUSH EBP
007872f1 : MOV EBP,ESP
007872f3 : PUSH -0x1
007872f5 : PUSH 0xb3c29c
007872fa : MOV EAX,FS:[0x0]
00787300 : PUSH EAX
00787301 : PUSH EBX
00787302 : PUSH ESI
00787303 : PUSH EDI
00787304 : MOV EAX,[0x00d66fa0]
00787309 : XOR EAX,EBP
0078730b : PUSH EAX
0078730c : LEA EAX,[EBP + -0xc]
0078730f : MOV FS:[0x0],EAX
00787315 : MOV ESI,dword ptr [EBP + 0x8]
00787318 : LEA EDI,[ESI + 0x4]
0078731b : XOR EAX,EAX
0078731d : CMP EDI,EAX
0078731f : JZ 0x0078732c
00787321 : LEA ECX,[EDI + -0x4]
00787324 : MOV dword ptr [0x0172523c],ECX
0078732a : JMP 0x00787331
0078732c : MOV [0x0172523c],EAX
00787331 : MOV dword ptr [EBP + -0x4],EAX
00787334 : LEA EDX,[ESI + 0x14]
00787337 : PUSH EDX
00787338 : MOV dword ptr [ESI],0xcd78c4
0078733e : CALL 0x0042b160
00787343 : MOV byte ptr [EBP + -0x4],0x1
00787347 : PUSH 0xfa0
0078734c : LEA EBX,[ESI + 0x24]
0078734f : PUSH EBX
00787350 : MOV dword ptr [ESI + 0x20],0xcdec94
00787357 : CALL dword ptr [0x00b85110]
0078735d : TEST EAX,EAX
0078735f : JNZ 0x00787368
00787361 : PUSH EBX
00787362 : CALL dword ptr [0x00b85114]
00787368 : MOV byte ptr [EBP + -0x4],0x2
0078736c : XOR ECX,ECX
0078736e : MOV EAX,0x80
00787373 : MOV dword ptr [ESI + 0x8],EAX
00787376 : MOV EDX,0x4
0078737b : MUL EDX
0078737d : SETO CL
00787380 : MOV EDX,0x0
00787385 : MOV dword ptr [EDI],0x0
0078738b : MOV dword ptr [ESI + 0x10],0x0
00787392 : NEG ECX
00787394 : OR EAX,ECX
00787396 : MOV ECX,dword ptr [0x01725270]
0078739c : SHR ECX,0x3
0078739f : AND ECX,0x1
007873a2 : SETZ DL
007873a5 : PUSH EDX
007873a6 : PUSH 0x0
007873a8 : PUSH 0xbf1a4b
007873ad : PUSH EAX
007873ae : CALL 0x006f0760
007873b3 : ADD ESP,0x10
007873b6 : MOV dword ptr [ESI + 0xc],EAX
007873b9 : MOV dword ptr [EBP + -0x4],0xffffffff
007873c0 : MOV EAX,ESI
007873c2 : MOV ECX,dword ptr [EBP + -0xc]
007873c5 : MOV dword ptr FS:[0x0],ECX
007873cc : POP ECX
007873cd : POP EDI
007873ce : POP ESI
007873cf : POP EBX
007873d0 : MOV ESP,EBP
007873d2 : POP EBP
007873d3 : RET 0x4

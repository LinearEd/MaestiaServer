PROGRAM  : Maestia.exe
FUNCTION : FUN_00a4bf40
ENTRY    : 00a4bf40
BODY     : [[00a4bf40, 00a4bf94] [00a4bfa0, 00a4c191]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a4bf40(void)

{
  int iVar1;
  uint uVar2;
  DWORD DVar3;
  int in_ECX;
  undefined4 ***pppuVar4;
  uint local_94;
  undefined1 local_90 [4];
  undefined2 local_8c;
  undefined4 local_7c;
  uint local_78;
  undefined1 local_74 [4];
  undefined2 local_70;
  undefined4 local_60;
  uint local_5c;
  DWORD local_58;
  int local_54;
  int local_50;
  undefined1 local_4c [4];
  undefined4 **local_48 [4];
  undefined4 local_38;
  uint local_34;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b2ffd9;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_50 = in_ECX;
  local_14 = uVar2;
  DVar3 = GetTickCount();
  local_54 = **(int **)(in_ECX + 0x128);
  local_58 = DVar3;
  if ((int *)local_54 != *(int **)(in_ECX + 0x128)) {
    do {
      iVar1 = local_54;
      if ((*(char *)(*(int *)(local_54 + 0x10) + 0x1fd1) != '\0') &&
         (60000 < DVar3 - *(int *)(*(int *)(local_54 + 0x10) + 0x1fd8))) {
        *(int *)(*(int *)(local_54 + 0x10) + 0x1fd4) =
             *(int *)(*(int *)(local_54 + 0x10) + 0x1fd4) + -1;
        *(DWORD *)(*(int *)(local_54 + 0x10) + 0x1fd8) = DVar3;
        local_18 = 7;
        local_1c = 0;
        local_2c = 0;
        local_8 = 0;
        FUN_00a4b570(local_30);
        local_5c = 7;
        local_60 = 0;
        local_70 = 0;
        FUN_00406360(L"IDS_DELETE_STANDBY",0x12);
        local_8._0_1_ = 1;
        FUN_0081d120(local_74);
        local_8._0_1_ = 2;
        FUN_00403510(local_90);
        local_8._0_1_ = 3;
        FUN_00403450(local_4c,local_30);
        local_8 = CONCAT31(local_8._1_3_,5);
        if (7 < local_78) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_78 = 7;
        local_7c = 0;
        local_8c = 0;
        local_8 = CONCAT31(local_8._1_3_,6);
        if (7 < local_94) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_94 = 7;
        local_8._0_1_ = 7;
        if (7 < local_5c) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_5c = 7;
        local_60 = 0;
        local_70 = 0;
        if (*(int *)(local_50 + 0x40) != 0) {
          pppuVar4 = (undefined4 ***)local_48[0];
          if (local_34 < 8) {
            pppuVar4 = local_48;
          }
          (**(code **)(**(int **)(local_50 + 0x40) + 4))
                    (*(int **)(local_50 + 0x40),"SetDeleteChar","%d,%b,%ls",
                     *(undefined2 *)(iVar1 + 0xc),1,pppuVar4);
        }
        local_8 = (uint)local_8._1_3_ << 8;
        if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_34 = 7;
        local_38 = 0;
        local_48[0] = (undefined4 **)((uint)local_48[0] & 0xffff0000);
        local_8 = 0xffffffff;
        if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_18 = 7;
        local_1c = 0;
        local_2c = 0;
        DVar3 = local_58;
      }
      FUN_00416210(uVar2);
    } while (local_54 != *(int *)(local_50 + 0x128));
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a4bf40 : PUSH EBP
00a4bf41 : MOV EBP,ESP
00a4bf43 : PUSH -0x1
00a4bf45 : PUSH 0xb2ffd9
00a4bf4a : MOV EAX,FS:[0x0]
00a4bf50 : PUSH EAX
00a4bf51 : SUB ESP,0x9c
00a4bf57 : MOV EAX,[0x00d66fa0]
00a4bf5c : XOR EAX,EBP
00a4bf5e : MOV dword ptr [EBP + -0x10],EAX
00a4bf61 : PUSH EBX
00a4bf62 : PUSH ESI
00a4bf63 : PUSH EDI
00a4bf64 : PUSH EAX
00a4bf65 : LEA EAX,[EBP + -0xc]
00a4bf68 : MOV FS:[0x0],EAX
00a4bf6e : MOV ESI,ECX
00a4bf70 : MOV dword ptr [EBP + -0x4c],ESI
00a4bf73 : CALL dword ptr [0x00b850d8]
00a4bf79 : MOV EDI,EAX
00a4bf7b : MOV EAX,dword ptr [ESI + 0x128]
00a4bf81 : MOV ESI,dword ptr [EAX]
00a4bf83 : MOV dword ptr [EBP + -0x54],EDI
00a4bf86 : MOV dword ptr [EBP + -0x50],ESI
00a4bf89 : CMP ESI,EAX
00a4bf8b : JZ 0x00a4c176
00a4bf91 : XOR EBX,EBX
00a4bf93 : JMP 0x00a4bfa0
00a4bfa0 : MOV EAX,dword ptr [ESI + 0x10]
00a4bfa3 : CMP byte ptr [EAX + 0x1fd1],BL
00a4bfa9 : JZ 0x00a4c15c
00a4bfaf : MOV EAX,dword ptr [EAX + 0x1fd8]
00a4bfb5 : MOV ECX,EDI
00a4bfb7 : SUB ECX,EAX
00a4bfb9 : CMP ECX,0xea60
00a4bfbf : JBE 0x00a4c15c
00a4bfc5 : MOV EAX,dword ptr [ESI + 0x10]
00a4bfc8 : MOV ECX,dword ptr [EAX + 0x1fd4]
00a4bfce : DEC ECX
00a4bfcf : MOV dword ptr [EAX + 0x1fd4],ECX
00a4bfd5 : MOV EAX,dword ptr [ESI + 0x10]
00a4bfd8 : MOV dword ptr [EAX + 0x1fd8],EDI
00a4bfde : MOV EDI,0x7
00a4bfe3 : XOR EDX,EDX
00a4bfe5 : MOV dword ptr [EBP + -0x14],EDI
00a4bfe8 : MOV dword ptr [EBP + -0x18],EBX
00a4bfeb : MOV word ptr [EBP + -0x28],DX
00a4bfef : MOV dword ptr [EBP + -0x4],EBX
00a4bff2 : MOV EAX,dword ptr [ESI + 0x10]
00a4bff5 : MOV ECX,dword ptr [EAX + 0x1fd4]
00a4bffb : LEA EDX,[EBP + -0x2c]
00a4bffe : PUSH EDX
00a4bfff : CALL 0x00a4b570
00a4c004 : PUSH 0x12
00a4c006 : XOR EAX,EAX
00a4c008 : PUSH 0xcc7bb0
00a4c00d : LEA ECX,[EBP + -0x70]
00a4c010 : MOV dword ptr [EBP + -0x58],EDI
00a4c013 : MOV dword ptr [EBP + -0x5c],EBX
00a4c016 : MOV word ptr [EBP + -0x6c],AX
00a4c01a : CALL 0x00406360
00a4c01f : MOV byte ptr [EBP + -0x4],0x1
00a4c023 : LEA ECX,[EBP + -0x70]
00a4c026 : PUSH ECX
00a4c027 : MOV ECX,dword ptr [0x0172491c]
00a4c02d : LEA EDI,[EBP + 0xffffff58]
00a4c033 : CALL 0x0081d120
00a4c038 : MOV byte ptr [EBP + -0x4],0x2
00a4c03c : LEA EDX,[EBP + 0xffffff74]
00a4c042 : PUSH EDX
00a4c043 : MOV EDX,0xcc7bac
00a4c048 : MOV ECX,EAX
00a4c04a : CALL 0x00403510
00a4c04f : MOV byte ptr [EBP + -0x4],0x3
00a4c053 : LEA ECX,[EBP + -0x2c]
00a4c056 : PUSH ECX
00a4c057 : LEA EDX,[EBP + -0x48]
00a4c05a : PUSH EDX
00a4c05b : MOV ECX,EAX
00a4c05d : CALL 0x00403450
00a4c062 : ADD ESP,0xc
00a4c065 : MOV byte ptr [EBP + -0x4],0x5
00a4c069 : MOV EDI,0x8
00a4c06e : CMP dword ptr [EBP + -0x74],EDI
00a4c071 : JC 0x00a4c07e
00a4c073 : MOV ECX,dword ptr [EBP + 0xffffff78]
00a4c079 : CALL 0x006f04e0
00a4c07e : XOR EAX,EAX
00a4c080 : MOV dword ptr [EBP + -0x74],0x7
00a4c087 : MOV dword ptr [EBP + -0x78],EBX
00a4c08a : MOV word ptr [EBP + 0xffffff78],AX
00a4c091 : MOV byte ptr [EBP + -0x4],0x6
00a4c095 : CMP dword ptr [EBP + 0xffffff70],EDI
00a4c09b : JC 0x00a4c0a8
00a4c09d : MOV ECX,dword ptr [EBP + 0xffffff5c]
00a4c0a3 : CALL 0x006f04e0
00a4c0a8 : XOR ECX,ECX
00a4c0aa : MOV dword ptr [EBP + 0xffffff70],0x7
00a4c0b4 : MOV dword ptr [EBP + 0xffffff6c],EBX
00a4c0ba : MOV word ptr [EBP + 0xffffff5c],CX
00a4c0c1 : MOV byte ptr [EBP + -0x4],0x7
00a4c0c5 : CMP dword ptr [EBP + -0x58],EDI
00a4c0c8 : JC 0x00a4c0d2
00a4c0ca : MOV ECX,dword ptr [EBP + -0x6c]
00a4c0cd : CALL 0x006f04e0
00a4c0d2 : MOV EAX,dword ptr [EBP + -0x4c]
00a4c0d5 : XOR EDX,EDX
00a4c0d7 : MOV dword ptr [EBP + -0x58],0x7
00a4c0de : MOV dword ptr [EBP + -0x5c],EBX
00a4c0e1 : MOV word ptr [EBP + -0x6c],DX
00a4c0e5 : CMP dword ptr [EAX + 0x40],EBX
00a4c0e8 : JZ 0x00a4c115
00a4c0ea : MOV ECX,dword ptr [EBP + -0x44]
00a4c0ed : CMP dword ptr [EBP + -0x30],EDI
00a4c0f0 : JNC 0x00a4c0f5
00a4c0f2 : LEA ECX,[EBP + -0x44]
00a4c0f5 : MOV EAX,dword ptr [EAX + 0x40]
00a4c0f8 : MOV EDX,dword ptr [EAX]
00a4c0fa : MOV EDX,dword ptr [EDX + 0x4]
00a4c0fd : PUSH ECX
00a4c0fe : MOVZX ECX,word ptr [ESI + 0xc]
00a4c102 : PUSH 0x1
00a4c104 : PUSH ECX
00a4c105 : PUSH 0xcc7bd8
00a4c10a : PUSH 0xcc7be4
00a4c10f : PUSH EAX
00a4c110 : CALL EDX
00a4c112 : ADD ESP,0x18
00a4c115 : MOV byte ptr [EBP + -0x4],BL
00a4c118 : CMP dword ptr [EBP + -0x30],EDI
00a4c11b : JC 0x00a4c125
00a4c11d : MOV ECX,dword ptr [EBP + -0x44]
00a4c120 : CALL 0x006f04e0
00a4c125 : XOR EAX,EAX
00a4c127 : MOV dword ptr [EBP + -0x30],0x7
00a4c12e : MOV dword ptr [EBP + -0x34],EBX
00a4c131 : MOV word ptr [EBP + -0x44],AX
00a4c135 : MOV dword ptr [EBP + -0x4],0xffffffff
00a4c13c : CMP dword ptr [EBP + -0x14],EDI
00a4c13f : JC 0x00a4c149
00a4c141 : MOV ECX,dword ptr [EBP + -0x28]
00a4c144 : CALL 0x006f04e0
00a4c149 : MOV EDI,dword ptr [EBP + -0x54]
00a4c14c : XOR ECX,ECX
00a4c14e : MOV dword ptr [EBP + -0x14],0x7
00a4c155 : MOV dword ptr [EBP + -0x18],EBX
00a4c158 : MOV word ptr [EBP + -0x28],CX
00a4c15c : LEA EDX,[EBP + -0x50]
00a4c15f : CALL 0x00416210
00a4c164 : MOV ESI,dword ptr [EBP + -0x50]
00a4c167 : MOV EDX,dword ptr [EBP + -0x4c]
00a4c16a : CMP ESI,dword ptr [EDX + 0x128]
00a4c170 : JNZ 0x00a4bfa0
00a4c176 : MOV ECX,dword ptr [EBP + -0xc]
00a4c179 : MOV dword ptr FS:[0x0],ECX
00a4c180 : POP ECX
00a4c181 : POP EDI
00a4c182 : POP ESI
00a4c183 : POP EBX
00a4c184 : MOV ECX,dword ptr [EBP + -0x10]
00a4c187 : XOR ECX,EBP
00a4c189 : CALL 0x00633e6b
00a4c18e : MOV ESP,EBP
00a4c190 : POP EBP
00a4c191 : RET

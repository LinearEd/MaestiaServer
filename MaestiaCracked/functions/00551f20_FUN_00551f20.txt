PROGRAM  : Maestia.exe
FUNCTION : FUN_00551f20
ENTRY    : 00551f20
BODY     : [[00551f20, 0055205c]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00551f20(undefined4 param_1,uint *param_2,uint param_3)

{
  uint *puVar1;
  uint *puVar2;
  uint *puVar3;
  int *piVar4;
  int *in_ECX;
  uint uVar5;
  uint uVar6;
  int iVar7;
  
  piVar4 = (int *)*in_ECX;
  if (piVar4 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar4 * 5) <= piVar4[1] * 4 + 4U) goto LAB_00551f5b;
    iVar7 = piVar4[1] * 2 + 2;
  }
  FUN_005517a0(param_1,iVar7);
LAB_00551f5b:
  piVar4 = (int *)*in_ECX;
  param_3 = param_3 & piVar4[1];
  *piVar4 = *piVar4 + 1;
  iVar7 = *in_ECX;
  puVar1 = (uint *)(iVar7 + 8 + param_3 * 0x24);
  if (*puVar1 == 0xfffffffe) {
    *puVar1 = 0xffffffff;
    uVar6 = *param_2;
    puVar1[1] = uVar6;
    piVar4 = (int *)(uVar6 + 8);
    *piVar4 = *piVar4 + 1;
    FUN_00550900(param_2 + 1);
    return;
  }
  uVar6 = param_3;
  do {
    uVar6 = uVar6 + 1 & *(uint *)(iVar7 + 4);
  } while (*(int *)(iVar7 + 8 + uVar6 * 0x24) != -2);
  uVar5 = *(uint *)(puVar1[1] + 0xc) & *(uint *)(iVar7 + 4);
  puVar2 = (uint *)(iVar7 + 8 + uVar6 * 0x24);
  if (uVar5 != param_3) {
    puVar3 = (uint *)(iVar7 + 8 + uVar5 * 0x24);
    for (uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x24); uVar5 != param_3;
        uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x24)) {
      uVar5 = *puVar3;
      puVar3 = (uint *)(iVar7 + 8 + uVar5 * 0x24);
    }
    if (puVar2 != (uint *)0x0) {
      *puVar2 = *puVar1;
      uVar5 = puVar1[1];
      puVar2[1] = uVar5;
      piVar4 = (int *)(uVar5 + 8);
      *piVar4 = *piVar4 + 1;
      FUN_00550900(puVar1 + 2);
    }
    *puVar3 = uVar6;
    FUN_0054f230(param_2);
    *puVar1 = 0xffffffff;
    return;
  }
  if (puVar2 != (uint *)0x0) {
    *puVar2 = *puVar1;
    uVar5 = puVar1[1];
    puVar2[1] = uVar5;
    piVar4 = (int *)(uVar5 + 8);
    *piVar4 = *piVar4 + 1;
    FUN_00550900(puVar1 + 2);
  }
  FUN_0054f230(param_2);
  *puVar1 = uVar6;
  return;
}



============================================================
DISASSEMBLY
============================================================
00551f20 : PUSH EBX
00551f21 : PUSH ESI
00551f22 : MOV ESI,ECX
00551f24 : MOV EAX,dword ptr [ESI]
00551f26 : PUSH EDI
00551f27 : TEST EAX,EAX
00551f29 : JNZ 0x00551f34
00551f2b : MOV EAX,dword ptr [ESP + 0x10]
00551f2f : PUSH 0x8
00551f31 : PUSH EAX
00551f32 : JMP 0x00551f56
00551f34 : MOV ECX,dword ptr [EAX + 0x4]
00551f37 : LEA EDX,[ECX*0x4 + 0x4]
00551f3e : MOV ECX,dword ptr [EAX]
00551f40 : LEA ECX,[ECX + ECX*0x4]
00551f43 : CMP ECX,EDX
00551f45 : JBE 0x00551f5b
00551f47 : MOV EDX,dword ptr [EAX + 0x4]
00551f4a : MOV ECX,dword ptr [ESP + 0x10]
00551f4e : LEA EAX,[EDX + EDX*0x1 + 0x2]
00551f52 : PUSH EAX
00551f53 : PUSH ECX
00551f54 : MOV ECX,ESI
00551f56 : CALL 0x005517a0
00551f5b : MOV ECX,dword ptr [ESI]
00551f5d : MOV EAX,dword ptr [ESP + 0x18]
00551f61 : AND EAX,dword ptr [ECX + 0x4]
00551f64 : INC dword ptr [ECX]
00551f66 : MOV ECX,dword ptr [ESI]
00551f68 : LEA EDX,[EAX + EAX*0x8]
00551f6b : LEA EDI,[ECX + EDX*0x4 + 0x8]
00551f6f : MOV EDX,dword ptr [EDI]
00551f71 : MOV EBX,0xfffffffe
00551f76 : MOV dword ptr [ESP + 0x10],EDI
00551f7a : CMP EDX,EBX
00551f7c : JNZ 0x00551fa2
00551f7e : MOV ECX,dword ptr [ESP + 0x14]
00551f82 : MOV dword ptr [EDI],0xffffffff
00551f88 : MOV EAX,dword ptr [ECX]
00551f8a : ADD ECX,0x4
00551f8d : PUSH ECX
00551f8e : MOV dword ptr [EDI + 0x4],EAX
00551f91 : INC dword ptr [EAX + 0x8]
00551f94 : LEA ECX,[EDI + 0x8]
00551f97 : CALL 0x00550900
00551f9c : POP EDI
00551f9d : POP ESI
00551f9e : POP EBX
00551f9f : RET 0xc
00551fa2 : PUSH EBP
00551fa3 : MOV EBP,dword ptr [ECX + 0x4]
00551fa6 : MOV ESI,EAX
00551fa8 : INC ESI
00551fa9 : AND ESI,EBP
00551fab : LEA EDX,[ESI + ESI*0x8]
00551fae : CMP dword ptr [ECX + EDX*0x4 + 0x8],EBX
00551fb2 : JNZ 0x00551fa8
00551fb4 : MOV EBX,dword ptr [EDI + 0x4]
00551fb7 : MOV EBX,dword ptr [EBX + 0xc]
00551fba : ADD EDI,0x4
00551fbd : AND EBX,EBP
00551fbf : LEA EDX,[ESI + ESI*0x8]
00551fc2 : LEA EDX,[ECX + EDX*0x4 + 0x8]
00551fc6 : POP EBP
00551fc7 : CMP EBX,EAX
00551fc9 : JNZ 0x00552003
00551fcb : TEST EDX,EDX
00551fcd : JZ 0x00551feb
00551fcf : MOV EAX,dword ptr [ESP + 0x10]
00551fd3 : MOV EAX,dword ptr [EAX]
00551fd5 : MOV dword ptr [EDX],EAX
00551fd7 : MOV EAX,dword ptr [EDI]
00551fd9 : LEA ECX,[EDI + 0x4]
00551fdc : PUSH ECX
00551fdd : MOV dword ptr [EDX + 0x4],EAX
00551fe0 : INC dword ptr [EAX + 0x8]
00551fe3 : LEA ECX,[EDX + 0x8]
00551fe6 : CALL 0x00550900
00551feb : MOV EDX,dword ptr [ESP + 0x14]
00551fef : PUSH EDX
00551ff0 : MOV ECX,EDI
00551ff2 : CALL 0x0054f230
00551ff7 : MOV EAX,dword ptr [ESP + 0x10]
00551ffb : POP EDI
00551ffc : MOV dword ptr [EAX],ESI
00551ffe : POP ESI
00551fff : POP EBX
00552000 : RET 0xc
00552003 : LEA EBX,[EBX + EBX*0x8]
00552006 : CMP dword ptr [ECX + EBX*0x4 + 0x8],EAX
0055200a : LEA EBX,[ECX + EBX*0x4 + 0x8]
0055200e : JZ 0x0055201f
00552010 : MOV EBX,dword ptr [EBX]
00552012 : LEA EBX,[EBX + EBX*0x8]
00552015 : CMP dword ptr [ECX + EBX*0x4 + 0x8],EAX
00552019 : LEA EBX,[ECX + EBX*0x4 + 0x8]
0055201d : JNZ 0x00552010
0055201f : TEST EDX,EDX
00552021 : JZ 0x0055203f
00552023 : MOV ECX,dword ptr [ESP + 0x10]
00552027 : MOV EAX,dword ptr [ECX]
00552029 : MOV dword ptr [EDX],EAX
0055202b : MOV EAX,dword ptr [EDI]
0055202d : MOV dword ptr [EDX + 0x4],EAX
00552030 : INC dword ptr [EAX + 0x8]
00552033 : LEA EAX,[EDI + 0x4]
00552036 : PUSH EAX
00552037 : LEA ECX,[EDX + 0x8]
0055203a : CALL 0x00550900
0055203f : MOV ECX,dword ptr [ESP + 0x14]
00552043 : PUSH ECX
00552044 : MOV ECX,EDI
00552046 : MOV dword ptr [EBX],ESI
00552048 : CALL 0x0054f230
0055204d : MOV EDX,dword ptr [ESP + 0x10]
00552051 : POP EDI
00552052 : POP ESI
00552053 : MOV dword ptr [EDX],0xffffffff
00552059 : POP EBX
0055205a : RET 0xc

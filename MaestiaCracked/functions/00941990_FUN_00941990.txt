PROGRAM  : Maestia.exe
FUNCTION : FUN_00941990
ENTRY    : 00941990
BODY     : [[00941990, 00941be4]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00941990(int *param_1,ushort *param_2)

{
  undefined8 uVar1;
  int *piVar2;
  uint uVar3;
  int iVar4;
  ushort *puVar5;
  undefined8 *puVar6;
  uint uVar7;
  undefined4 uVar8;
  undefined1 local_48 [4];
  undefined2 local_44;
  int local_34;
  uint local_30;
  undefined8 *local_28;
  undefined8 *local_24;
  undefined4 local_20;
  undefined8 local_1c;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  piVar2 = param_1;
  puStack_c = &LAB_00b3aca8;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  puVar5 = param_2 + 5;
  uVar7 = (*param_2 & 0x1fff) - 10;
  local_28 = (undefined8 *)0x0;
  local_24 = (undefined8 *)0x0;
  local_20 = 0;
  local_8 = 0;
  FUN_004846b0(param_2[4]);
  param_1 = (int *)0x0;
  if (param_2[4] != 0) {
    do {
      uVar1 = local_1c;
      if ((puVar5 == (ushort *)0x0) || (uVar7 < 4)) {
LAB_00941a52:
        uVar7 = 0;
        puVar5 = (ushort *)0x0;
      }
      else {
        local_1c = CONCAT44(local_1c._4_4_,*(undefined4 *)puVar5);
        if ((puVar5 + 2 == (ushort *)0x0) || (uVar7 == 4)) goto LAB_00941a52;
        local_1c._5_3_ = SUB83(uVar1,5);
        local_1c._0_5_ = CONCAT14((char)puVar5[2],*(undefined4 *)puVar5);
        if (((undefined1 *)((int)puVar5 + 5) == (undefined1 *)0x0) || (uVar7 == 5))
        goto LAB_00941a52;
        local_1c._6_2_ = SUB82(uVar1,6);
        local_1c._0_6_ = CONCAT15(*(undefined1 *)((int)puVar5 + 5),(undefined5)local_1c);
        if ((puVar5 + 3 == (ushort *)0x0) || (uVar7 == 6)) goto LAB_00941a52;
        local_1c._7_1_ = SUB81(uVar1,7);
        local_1c._0_7_ = CONCAT16((char)puVar5[3],(undefined6)local_1c);
        if (((undefined1 *)((int)puVar5 + 7) == (undefined1 *)0x0) || (uVar7 == 7))
        goto LAB_00941a52;
        uVar7 = uVar7 - 8;
        local_1c = CONCAT17(*(undefined1 *)((int)puVar5 + 7),(undefined7)local_1c);
        puVar5 = puVar5 + 4;
      }
      local_14 = (**(code **)(*piVar2 + 0x74))(local_1c._4_1_,local_1c._5_1_,uVar3);
      if (local_14 == 0) {
        local_30 = 7;
        local_44 = 0;
        local_34 = local_14;
        FUN_00406360(L"AvaGuiPocket::RecvPackPocket Invaild Item",0x29);
        local_8._0_1_ = 1;
        if ((int *)*DAT_00da98e8 != (int *)0x0) {
          (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                    (L"AvaGuiPocket::RecvPackPocket",0x927,local_48);
        }
        local_8 = (uint)local_8._1_3_ << 8;
        if (7 < local_30) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_30 = 7;
        local_34 = 0;
        local_44 = 0;
      }
      else {
        FUN_00407840(&local_1c);
      }
      param_1 = (int *)((int)param_1 + 1);
    } while ((int)param_1 < (int)(uint)param_2[4]);
  }
  puVar6 = local_28;
  if (local_28 != local_24) {
    do {
      uVar8 = *(undefined4 *)(puVar6 + 1);
      local_1c._4_4_ = (uint)((ulonglong)*puVar6 >> 0x20);
      uVar3 = local_1c._4_4_ >> 0x10;
      uVar7 = local_1c._4_4_ >> 0x18;
      local_1c = *puVar6;
      (**(code **)(*piVar2 + 0x78))(uVar3 & 0xff,uVar7);
      FUN_00941640(piVar2,local_1c._6_1_,local_1c._7_1_,0,0);
      puVar6 = (undefined8 *)((int)puVar6 + 0xc);
    } while (puVar6 != local_24);
    puVar6 = local_28;
    if (local_28 != local_24) {
      do {
        uVar1 = *puVar6;
        local_14 = *(int *)(puVar6 + 1);
        local_1c._4_1_ = (byte)((ulonglong)uVar1 >> 0x20);
        uVar8 = CONCAT22((short)((uint)uVar8 >> 0x10),(ushort)local_1c._4_1_);
        local_1c = uVar1;
        iVar4 = (**(code **)(*piVar2 + 0x74))(uVar8,(uint)((ulonglong)uVar1 >> 0x28) & 0xff);
        if (iVar4 == local_14) {
          (**(code **)(*piVar2 + 0x78))(uVar8,local_1c._5_1_);
        }
        puVar6 = (undefined8 *)((int)puVar6 + 0xc);
      } while (puVar6 != local_24);
    }
  }
  local_8 = 0xffffffff;
  if (local_28 == (undefined8 *)0x0) {
    ExceptionList = local_10;
    return;
  }
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
00941990 : PUSH EBP
00941991 : MOV EBP,ESP
00941993 : PUSH -0x1
00941995 : PUSH 0xb3aca8
0094199a : MOV EAX,FS:[0x0]
009419a0 : PUSH EAX
009419a1 : SUB ESP,0x3c
009419a4 : PUSH EBX
009419a5 : PUSH ESI
009419a6 : PUSH EDI
009419a7 : MOV EAX,[0x00d66fa0]
009419ac : XOR EAX,EBP
009419ae : PUSH EAX
009419af : LEA EAX,[EBP + -0xc]
009419b2 : MOV FS:[0x0],EAX
009419b8 : MOV EBX,dword ptr [EBP + 0x8]
009419bb : MOV EAX,dword ptr [EBP + 0xc]
009419be : MOVZX EDI,word ptr [EAX]
009419c1 : XOR ECX,ECX
009419c3 : AND EDI,0x1fff
009419c9 : LEA ESI,[EAX + 0xa]
009419cc : SUB EDI,0xa
009419cf : MOV dword ptr [EBP + -0x24],ECX
009419d2 : MOV dword ptr [EBP + -0x20],ECX
009419d5 : MOV dword ptr [EBP + -0x1c],ECX
009419d8 : MOV dword ptr [EBP + -0x4],ECX
009419db : MOVZX EAX,word ptr [EAX + 0x8]
009419df : PUSH EAX
009419e0 : LEA ECX,[EBP + -0x28]
009419e3 : CALL 0x004846b0
009419e8 : MOV EDX,dword ptr [EBP + 0xc]
009419eb : XOR ECX,ECX
009419ed : MOV dword ptr [EBP + 0x8],0x0
009419f4 : CMP CX,word ptr [EDX + 0x8]
009419f8 : JNC 0x00941b02
009419fe : TEST ESI,ESI
00941a00 : JZ 0x00941a52
00941a02 : CMP EDI,0x4
00941a05 : JC 0x00941a52
00941a07 : MOV EAX,dword ptr [ESI]
00941a09 : SUB EDI,0x4
00941a0c : ADD ESI,0x4
00941a0f : MOV dword ptr [EBP + -0x18],EAX
00941a12 : JZ 0x00941a52
00941a14 : CMP EDI,0x1
00941a17 : JC 0x00941a52
00941a19 : MOV CL,byte ptr [ESI]
00941a1b : DEC EDI
00941a1c : ADD ESI,0x1
00941a1f : MOV byte ptr [EBP + -0x14],CL
00941a22 : JZ 0x00941a52
00941a24 : CMP EDI,0x1
00941a27 : JC 0x00941a52
00941a29 : MOV DL,byte ptr [ESI]
00941a2b : DEC EDI
00941a2c : ADD ESI,0x1
00941a2f : MOV byte ptr [EBP + -0x13],DL
00941a32 : JZ 0x00941a52
00941a34 : CMP EDI,0x1
00941a37 : JC 0x00941a52
00941a39 : MOV AL,byte ptr [ESI]
00941a3b : DEC EDI
00941a3c : ADD ESI,0x1
00941a3f : MOV byte ptr [EBP + -0x12],AL
00941a42 : JZ 0x00941a52
00941a44 : CMP EDI,0x1
00941a47 : JC 0x00941a52
00941a49 : MOV CL,byte ptr [ESI]
00941a4b : DEC EDI
00941a4c : MOV byte ptr [EBP + -0x11],CL
00941a4f : INC ESI
00941a50 : JMP 0x00941a56
00941a52 : XOR EDI,EDI
00941a54 : XOR ESI,ESI
00941a56 : MOVZX EAX,byte ptr [EBP + -0x13]
00941a5a : MOV EDX,dword ptr [EBX]
00941a5c : MOV EDX,dword ptr [EDX + 0x74]
00941a5f : MOVZX ECX,AX
00941a62 : MOVZX EAX,byte ptr [EBP + -0x14]
00941a66 : PUSH ECX
00941a67 : MOVZX ECX,AX
00941a6a : PUSH ECX
00941a6b : MOV ECX,EBX
00941a6d : CALL EDX
00941a6f : MOV dword ptr [EBP + -0x10],EAX
00941a72 : TEST EAX,EAX
00941a74 : JNZ 0x00941ae0
00941a76 : PUSH 0x29
00941a78 : PUSH 0xc72488
00941a7d : LEA ECX,[EBP + -0x44]
00941a80 : MOV dword ptr [EBP + -0x2c],0x7
00941a87 : MOV dword ptr [EBP + -0x30],EAX
00941a8a : MOV word ptr [EBP + -0x40],AX
00941a8e : CALL 0x00406360
00941a93 : MOV byte ptr [EBP + -0x4],0x1
00941a97 : MOV ECX,dword ptr [0x00da98e8]
00941a9d : MOV ECX,dword ptr [ECX]
00941a9f : TEST ECX,ECX
00941aa1 : JZ 0x00941ab8
00941aa3 : MOV EDX,dword ptr [ECX]
00941aa5 : MOV EDX,dword ptr [EDX + 0x14]
00941aa8 : LEA EAX,[EBP + -0x44]
00941aab : PUSH EAX
00941aac : PUSH 0x927
00941ab1 : PUSH 0xc724dc
00941ab6 : CALL EDX
00941ab8 : MOV byte ptr [EBP + -0x4],0x0
00941abc : CMP dword ptr [EBP + -0x2c],0x8
00941ac0 : JC 0x00941aca
00941ac2 : MOV ECX,dword ptr [EBP + -0x40]
00941ac5 : CALL 0x006f04e0
00941aca : XOR EAX,EAX
00941acc : MOV dword ptr [EBP + -0x2c],0x7
00941ad3 : MOV dword ptr [EBP + -0x30],0x0
00941ada : MOV word ptr [EBP + -0x40],AX
00941ade : JMP 0x00941aec
00941ae0 : LEA ECX,[EBP + -0x18]
00941ae3 : PUSH ECX
00941ae4 : LEA EAX,[EBP + -0x28]
00941ae7 : CALL 0x00407840
00941aec : MOV EDX,dword ptr [EBP + 0xc]
00941aef : MOV EAX,dword ptr [EBP + 0x8]
00941af2 : MOVZX ECX,word ptr [EDX + 0x8]
00941af6 : INC EAX
00941af7 : CMP EAX,ECX
00941af9 : MOV dword ptr [EBP + 0x8],EAX
00941afc : JL 0x009419fe
00941b02 : MOV ESI,dword ptr [EBP + -0x24]
00941b05 : CMP ESI,dword ptr [EBP + -0x20]
00941b08 : JZ 0x00941bb4
00941b0e : MOV EDI,EDI
00941b10 : MOVQ XMM0,qword ptr [ESI]
00941b14 : MOV EDX,dword ptr [EBX]
00941b16 : MOV EDX,dword ptr [EDX + 0x78]
00941b19 : MOV EDI,dword ptr [ESI + 0x8]
00941b1c : MOVQ qword ptr [EBP + -0x18],XMM0
00941b21 : MOV EAX,dword ptr [EBP + -0x14]
00941b24 : MOV ECX,EAX
00941b26 : SHR EAX,0x10
00941b29 : SHR ECX,0x18
00941b2c : MOVZX AX,AL
00941b30 : PUSH ECX
00941b31 : MOVZX ECX,AX
00941b34 : PUSH ECX
00941b35 : MOV ECX,EBX
00941b37 : CALL EDX
00941b39 : MOVZX AX,byte ptr [EBP + -0x11]
00941b3e : MOVZX DX,byte ptr [EBP + -0x12]
00941b43 : PUSH 0x0
00941b45 : MOVZX ECX,AX
00941b48 : PUSH 0x0
00941b4a : MOVZX EAX,DX
00941b4d : PUSH ECX
00941b4e : PUSH EAX
00941b4f : PUSH EBX
00941b50 : CALL 0x00941640
00941b55 : ADD ESI,0xc
00941b58 : CMP ESI,dword ptr [EBP + -0x20]
00941b5b : JNZ 0x00941b10
00941b5d : MOV ESI,dword ptr [EBP + -0x24]
00941b60 : CMP ESI,dword ptr [EBP + -0x20]
00941b63 : JZ 0x00941bb4
00941b65 : MOVQ XMM0,qword ptr [ESI]
00941b69 : MOV ECX,dword ptr [ESI + 0x8]
00941b6c : MOV EDX,dword ptr [EBX]
00941b6e : MOV EDX,dword ptr [EDX + 0x74]
00941b71 : MOVQ qword ptr [EBP + -0x18],XMM0
00941b76 : MOV EAX,dword ptr [EBP + -0x14]
00941b79 : MOVZX DI,byte ptr [EBP + -0x14]
00941b7e : SHR EAX,0x8
00941b81 : MOV dword ptr [EBP + -0x10],ECX
00941b84 : MOVZX CX,AL
00941b88 : MOVZX EAX,CX
00941b8b : PUSH EAX
00941b8c : PUSH EDI
00941b8d : MOV ECX,EBX
00941b8f : CALL EDX
00941b91 : CMP EAX,dword ptr [EBP + -0x10]
00941b94 : JNZ 0x00941ba9
00941b96 : MOVZX CX,byte ptr [EBP + -0x13]
00941b9b : MOV EAX,dword ptr [EBX]
00941b9d : MOV EAX,dword ptr [EAX + 0x78]
00941ba0 : MOVZX EDX,CX
00941ba3 : PUSH EDX
00941ba4 : PUSH EDI
00941ba5 : MOV ECX,EBX
00941ba7 : CALL EAX
00941ba9 : ADD ESI,0xc
00941bac : CMP ESI,dword ptr [EBP + -0x20]
00941baf : JNZ 0x00941b65
00941bb1 : MOV ESI,dword ptr [EBP + -0x24]
00941bb4 : MOV dword ptr [EBP + -0x4],0xffffffff
00941bbb : TEST ESI,ESI
00941bbd : JZ 0x00941bc6
00941bbf : MOV ECX,ESI
00941bc1 : CALL 0x006f04e0
00941bc6 : XOR EAX,EAX
00941bc8 : MOV dword ptr [EBP + -0x24],EAX
00941bcb : MOV dword ptr [EBP + -0x20],EAX
00941bce : MOV dword ptr [EBP + -0x1c],EAX
00941bd1 : MOV ECX,dword ptr [EBP + -0xc]
00941bd4 : MOV dword ptr FS:[0x0],ECX
00941bdb : POP ECX
00941bdc : POP EDI
00941bdd : POP ESI
00941bde : POP EBX
00941bdf : MOV ESP,EBP
00941be1 : POP EBP
00941be2 : RET 0x8

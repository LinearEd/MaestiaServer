PROGRAM  : Maestia.exe
FUNCTION : FUN_0089f8b0
ENTRY    : 0089f8b0
BODY     : [[0089f8b0, 0089fb18]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0089f8b0(int param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  FILE *_File;
  int *piVar4;
  LPCWSTR pWVar5;
  char *_Format;
  LPSTR lpMultiByteStr;
  undefined4 uVar6;
  LPSTR lpMultiByteStr_00;
  LPCWSTR local_10;
  LPCWSTR local_c;
  
  _File = _fopen("XmlSoundData.txt","wt");
  _fprintf(_File,"XMLFILE\tFRAME\tFILENAME\tMINDISTANCE\tMAXDISTANCE\tVOLUME\tSOUNDPLAYTYPE\n");
  piVar4 = (int *)**(int **)(param_1 + 0x70);
  if (piVar4 != *(int **)(param_1 + 0x70)) {
    iVar1 = *(int *)ThreadLocalStoragePointer;
    do {
      iVar2 = piVar4[10];
      iVar3 = *(int *)(iVar2 + 0x20);
      if (iVar3 == 0) {
        if (*(uint *)(iVar2 + 0x18) < 8) {
          pWVar5 = (LPCWSTR)(iVar2 + 4);
        }
        else {
          pWVar5 = *(LPCWSTR *)(iVar2 + 4);
        }
        lpMultiByteStr_00 = (LPSTR)(*(int *)(iVar1 + 0x28) * 0x400 + 0x9cb8 + iVar1);
        *(int *)(iVar1 + 0x28) = (*(int *)(iVar1 + 0x28) + 1) % 100;
        WideCharToMultiByte(0,0,pWVar5,-1,lpMultiByteStr_00,0x400,(LPCSTR)0x0,(LPBOOL)0x0);
        if ((uint)piVar4[9] < 8) {
          local_10 = (LPCWSTR)(piVar4 + 4);
        }
        else {
          local_10 = (LPCWSTR)piVar4[4];
        }
        lpMultiByteStr = (LPSTR)(*(int *)(iVar1 + 0x28) * 0x400 + 0x9cb8 + iVar1);
        *(int *)(iVar1 + 0x28) = (*(int *)(iVar1 + 0x28) + 1) % 100;
        WideCharToMultiByte(0,0,local_10,-1,lpMultiByteStr,0x400,(LPCSTR)0x0,(LPBOOL)0x0);
        uVar6 = *(undefined4 *)(piVar4[10] + 0x1c);
        _Format = "%s\t%d\t%s\t%f\t%f\t%f\t%d\n";
      }
      else {
        if (*(uint *)(iVar3 + 0x18) < 8) {
          pWVar5 = (LPCWSTR)(iVar3 + 4);
        }
        else {
          pWVar5 = *(LPCWSTR *)(iVar3 + 4);
        }
        lpMultiByteStr_00 = (LPSTR)(*(int *)(iVar1 + 0x28) * 0x400 + 0x9cb8 + iVar1);
        *(int *)(iVar1 + 0x28) = (*(int *)(iVar1 + 0x28) + 1) % 100;
        WideCharToMultiByte(0,0,pWVar5,-1,lpMultiByteStr_00,0x400,(LPCSTR)0x0,(LPBOOL)0x0);
        if ((uint)piVar4[9] < 8) {
          local_c = (LPCWSTR)(piVar4 + 4);
        }
        else {
          local_c = (LPCWSTR)piVar4[4];
        }
        lpMultiByteStr = (LPSTR)(*(int *)(iVar1 + 0x28) * 0x400 + 0x9cb8 + iVar1);
        *(int *)(iVar1 + 0x28) = (*(int *)(iVar1 + 0x28) + 1) % 100;
        WideCharToMultiByte(0,0,local_c,-1,lpMultiByteStr,0x400,(LPCSTR)0x0,(LPBOOL)0x0);
        uVar6 = *(undefined4 *)(piVar4[10] + 0x1c);
        _Format = "%s\t%d\t%s\t%f\t%f\t%f\t%d\n";
      }
      _fprintf(_File,_Format,lpMultiByteStr,uVar6,lpMultiByteStr_00,0x403e000000000000,
               0x4072c00000000000,0x3ff0000000000000,0);
      FUN_00430160();
    } while (piVar4 != (int *)*(int *)(param_1 + 0x70));
  }
  iVar1 = param_1;
  piVar4 = (int *)**(int **)(param_1 + 0x70);
  if (piVar4 != *(int **)(param_1 + 0x70)) {
    do {
      if (*(int *)((int)piVar4 + 0x28) != 0) {
        FUN_00438b40();
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      piVar4 = (int *)FUN_0043a9f0(iVar1 + 0x6c,&param_1,piVar4);
      piVar4 = (int *)*piVar4;
    } while (piVar4 != (int *)*(int *)(iVar1 + 0x70));
  }
  FUN_0044c480(*(undefined4 *)(*(int *)(iVar1 + 0x70) + 4));
  *(int *)(*(int *)(iVar1 + 0x70) + 4) = *(int *)(iVar1 + 0x70);
  *(undefined4 *)(iVar1 + 0x74) = 0;
  *(undefined4 *)*(undefined4 *)(iVar1 + 0x70) = *(undefined4 *)(iVar1 + 0x70);
  *(int *)(*(int *)(iVar1 + 0x70) + 8) = *(int *)(iVar1 + 0x70);
  _fclose(_File);
  return;
}



============================================================
DISASSEMBLY
============================================================
0089f8b0 : PUSH EBP
0089f8b1 : MOV EBP,ESP
0089f8b3 : SUB ESP,0x10
0089f8b6 : PUSH EBX
0089f8b7 : PUSH ESI
0089f8b8 : PUSH EDI
0089f8b9 : PUSH 0xc49694
0089f8be : PUSH 0xc49698
0089f8c3 : CALL 0x00638fa0
0089f8c8 : PUSH 0xc496b0
0089f8cd : PUSH EAX
0089f8ce : MOV dword ptr [EBP + -0x4],EAX
0089f8d1 : CALL 0x00636757
0089f8d6 : MOV EBX,dword ptr [EBP + 0x8]
0089f8d9 : MOV EAX,dword ptr [EBX + 0x70]
0089f8dc : MOV EDI,dword ptr [EAX]
0089f8de : ADD ESP,0x10
0089f8e1 : MOV dword ptr [EBP + -0x10],EDI
0089f8e4 : CMP EDI,EAX
0089f8e6 : JZ 0x0089faa8
0089f8ec : MOV EAX,FS:[0x2c]
0089f8f2 : MOV ESI,dword ptr [EAX]
0089f8f4 : MOV EAX,dword ptr [EDI + 0x28]
0089f8f7 : MOV ECX,dword ptr [EAX + 0x20]
0089f8fa : TEST ECX,ECX
0089f8fc : JZ 0x0089f9c5
0089f902 : CMP dword ptr [ECX + 0x18],0x8
0089f906 : JC 0x0089f90d
0089f908 : MOV ECX,dword ptr [ECX + 0x4]
0089f90b : JMP 0x0089f910
0089f90d : ADD ECX,0x4
0089f910 : MOV EAX,dword ptr [ESI + 0x28]
0089f913 : MOV EDX,EAX
0089f915 : SHL EDX,0xa
0089f918 : LEA EDX,[EDX + ESI*0x1 + 0x9cb8]
0089f91f : INC EAX
0089f920 : MOV dword ptr [EBP + -0xc],EDX
0089f923 : CDQ
0089f924 : MOV EBX,0x64
0089f929 : IDIV EBX
0089f92b : MOV EAX,dword ptr [EBP + -0xc]
0089f92e : PUSH 0x0
0089f930 : PUSH 0x0
0089f932 : PUSH 0x400
0089f937 : PUSH EAX
0089f938 : PUSH -0x1
0089f93a : PUSH ECX
0089f93b : PUSH 0x0
0089f93d : PUSH 0x0
0089f93f : MOV dword ptr [ESI + 0x28],EDX
0089f942 : CALL dword ptr [0x00b85130]
0089f948 : CMP dword ptr [EDI + 0x24],0x8
0089f94c : JC 0x0089f956
0089f94e : MOV ECX,dword ptr [EDI + 0x10]
0089f951 : MOV dword ptr [EBP + -0x8],ECX
0089f954 : JMP 0x0089f95c
0089f956 : LEA EDX,[EDI + 0x10]
0089f959 : MOV dword ptr [EBP + -0x8],EDX
0089f95c : MOV EAX,dword ptr [ESI + 0x28]
0089f95f : MOV ECX,EAX
0089f961 : SHL ECX,0xa
0089f964 : INC EAX
0089f965 : LEA EBX,[ECX + ESI*0x1 + 0x9cb8]
0089f96c : CDQ
0089f96d : MOV ECX,0x64
0089f972 : IDIV ECX
0089f974 : PUSH 0x0
0089f976 : PUSH 0x0
0089f978 : PUSH 0x400
0089f97d : PUSH EBX
0089f97e : PUSH -0x1
0089f980 : MOV dword ptr [ESI + 0x28],EDX
0089f983 : MOV EDX,dword ptr [EBP + -0x8]
0089f986 : PUSH EDX
0089f987 : PUSH 0x0
0089f989 : PUSH 0x0
0089f98b : CALL dword ptr [0x00b85130]
0089f991 : FLD1
0089f993 : MOV EAX,dword ptr [EBP + -0xc]
0089f996 : MOV ECX,dword ptr [EDI + 0x28]
0089f999 : MOV EDX,dword ptr [ECX + 0x1c]
0089f99c : PUSH 0x0
0089f99e : SUB ESP,0x18
0089f9a1 : FSTP double ptr [ESP + 0x10]
0089f9a5 : FLD double ptr [0x00cdf5e0]
0089f9ab : FSTP double ptr [ESP + 0x8]
0089f9af : FLD double ptr [0x00cdf5d8]
0089f9b5 : FSTP double ptr [ESP]
0089f9b8 : PUSH EAX
0089f9b9 : PUSH EDX
0089f9ba : PUSH EBX
0089f9bb : PUSH 0xc496f8
0089f9c0 : JMP 0x0089fa83
0089f9c5 : CMP dword ptr [EAX + 0x18],0x8
0089f9c9 : JC 0x0089f9d0
0089f9cb : MOV ECX,dword ptr [EAX + 0x4]
0089f9ce : JMP 0x0089f9d3
0089f9d0 : LEA ECX,[EAX + 0x4]
0089f9d3 : MOV EAX,dword ptr [ESI + 0x28]
0089f9d6 : MOV EDX,EAX
0089f9d8 : SHL EDX,0xa
0089f9db : LEA EDX,[EDX + ESI*0x1 + 0x9cb8]
0089f9e2 : INC EAX
0089f9e3 : MOV dword ptr [EBP + -0x8],EDX
0089f9e6 : CDQ
0089f9e7 : MOV EBX,0x64
0089f9ec : IDIV EBX
0089f9ee : MOV EAX,dword ptr [EBP + -0x8]
0089f9f1 : PUSH 0x0
0089f9f3 : PUSH 0x0
0089f9f5 : PUSH 0x400
0089f9fa : PUSH EAX
0089f9fb : PUSH -0x1
0089f9fd : PUSH ECX
0089f9fe : PUSH 0x0
0089fa00 : PUSH 0x0
0089fa02 : MOV dword ptr [ESI + 0x28],EDX
0089fa05 : CALL dword ptr [0x00b85130]
0089fa0b : CMP dword ptr [EDI + 0x24],0x8
0089fa0f : JC 0x0089fa19
0089fa11 : MOV ECX,dword ptr [EDI + 0x10]
0089fa14 : MOV dword ptr [EBP + -0xc],ECX
0089fa17 : JMP 0x0089fa1f
0089fa19 : LEA EDX,[EDI + 0x10]
0089fa1c : MOV dword ptr [EBP + -0xc],EDX
0089fa1f : MOV EAX,dword ptr [ESI + 0x28]
0089fa22 : MOV ECX,EAX
0089fa24 : SHL ECX,0xa
0089fa27 : INC EAX
0089fa28 : LEA EBX,[ECX + ESI*0x1 + 0x9cb8]
0089fa2f : CDQ
0089fa30 : MOV ECX,0x64
0089fa35 : IDIV ECX
0089fa37 : PUSH 0x0
0089fa39 : PUSH 0x0
0089fa3b : PUSH 0x400
0089fa40 : PUSH EBX
0089fa41 : PUSH -0x1
0089fa43 : MOV dword ptr [ESI + 0x28],EDX
0089fa46 : MOV EDX,dword ptr [EBP + -0xc]
0089fa49 : PUSH EDX
0089fa4a : PUSH 0x0
0089fa4c : PUSH 0x0
0089fa4e : CALL dword ptr [0x00b85130]
0089fa54 : FLD1
0089fa56 : MOV EAX,dword ptr [EBP + -0x8]
0089fa59 : MOV ECX,dword ptr [EDI + 0x28]
0089fa5c : MOV EDX,dword ptr [ECX + 0x1c]
0089fa5f : PUSH 0x0
0089fa61 : SUB ESP,0x18
0089fa64 : FSTP double ptr [ESP + 0x10]
0089fa68 : FLD double ptr [0x00cdf5e0]
0089fa6e : FSTP double ptr [ESP + 0x8]
0089fa72 : FLD double ptr [0x00cdf5d8]
0089fa78 : FSTP double ptr [ESP]
0089fa7b : PUSH EAX
0089fa7c : PUSH EDX
0089fa7d : PUSH EBX
0089fa7e : PUSH 0xc49710
0089fa83 : MOV EAX,dword ptr [EBP + -0x4]
0089fa86 : PUSH EAX
0089fa87 : CALL 0x00636757
0089fa8c : ADD ESP,0x30
0089fa8f : LEA EDX,[EBP + -0x10]
0089fa92 : CALL 0x00430160
0089fa97 : MOV EDI,dword ptr [EBP + -0x10]
0089fa9a : MOV ECX,dword ptr [EBP + 0x8]
0089fa9d : CMP EDI,dword ptr [ECX + 0x70]
0089faa0 : JNZ 0x0089f8f4
0089faa6 : MOV EBX,ECX
0089faa8 : MOV EAX,dword ptr [EBX + 0x70]
0089faab : MOV ESI,dword ptr [EAX]
0089faad : CMP ESI,EAX
0089faaf : JZ 0x0089fadb
0089fab1 : MOV EDI,dword ptr [ESI + 0x28]
0089fab4 : TEST EDI,EDI
0089fab6 : JZ 0x0089fac6
0089fab8 : MOV ECX,EDI
0089faba : CALL 0x00438b40
0089fabf : MOV ECX,EDI
0089fac1 : CALL 0x006f04e0
0089fac6 : PUSH ESI
0089fac7 : LEA EDX,[EBP + 0x8]
0089faca : PUSH EDX
0089facb : LEA EAX,[EBX + 0x6c]
0089face : PUSH EAX
0089facf : CALL 0x0043a9f0
0089fad4 : MOV ESI,dword ptr [EAX]
0089fad6 : CMP ESI,dword ptr [EBX + 0x70]
0089fad9 : JNZ 0x0089fab1
0089fadb : MOV EAX,dword ptr [EBX + 0x70]
0089fade : MOV ECX,dword ptr [EAX + 0x4]
0089fae1 : LEA ESI,[EBX + 0x6c]
0089fae4 : PUSH ECX
0089fae5 : MOV ECX,ESI
0089fae7 : CALL 0x0044c480
0089faec : MOV EAX,dword ptr [ESI + 0x4]
0089faef : MOV EDX,dword ptr [EBP + -0x4]
0089faf2 : MOV dword ptr [EAX + 0x4],EAX
0089faf5 : MOV EAX,dword ptr [ESI + 0x4]
0089faf8 : MOV dword ptr [ESI + 0x8],0x0
0089faff : MOV dword ptr [EAX],EAX
0089fb01 : MOV ESI,dword ptr [ESI + 0x4]
0089fb04 : PUSH EDX
0089fb05 : MOV dword ptr [ESI + 0x8],ESI
0089fb08 : CALL 0x006366db
0089fb0d : ADD ESP,0x4
0089fb10 : POP EDI
0089fb11 : POP ESI
0089fb12 : POP EBX
0089fb13 : MOV ESP,EBP
0089fb15 : POP EBP
0089fb16 : RET 0x4

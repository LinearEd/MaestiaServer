PROGRAM  : Maestia.exe
FUNCTION : FUN_005e7460
ENTRY    : 005e7460
BODY     : [[005e7460, 005e765c]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005e7460(uint param_1,GThread *param_2)

{
  undefined1 uVar1;
  undefined1 uVar2;
  int iVar3;
  uint uVar4;
  LONG LVar5;
  int iVar6;
  uint uVar7;
  uint local_14;
  int local_10;
  uint local_c;
  uint local_8;
  int local_4;
  
  uVar7 = param_1;
  local_10 = *(int *)(param_1 + 0x314);
  if (local_10 == 0) {
    local_10 = param_1 + 0x28;
  }
  uVar4 = FUN_005e63b0();
  iVar6 = *(int *)(uVar7 + 0x314);
  if (iVar6 == 0) {
    iVar6 = uVar7 + 0x28;
  }
  *(undefined1 *)(iVar6 + 0x15) = 0;
  if (*(int *)(iVar6 + 0x30) - *(int *)(iVar6 + 0x2c) < 2) {
    FUN_00539fb0(2);
  }
  local_8 = (uint)*(ushort *)(*(int *)(iVar6 + 0x3c) + *(int *)(iVar6 + 0x2c));
  *(int *)(iVar6 + 0x2c) = *(int *)(iVar6 + 0x2c) + 2;
  iVar6 = *(int *)(uVar7 + 0x314);
  if (iVar6 == 0) {
    iVar6 = uVar7 + 0x28;
  }
  *(undefined1 *)(iVar6 + 0x15) = 0;
  if (*(int *)(iVar6 + 0x30) - *(int *)(iVar6 + 0x2c) < 2) {
    FUN_00539fb0(2);
  }
  iVar3 = *(int *)(iVar6 + 0x2c);
  local_c = (uint)CONCAT11(*(undefined1 *)(*(int *)(iVar6 + 0x3c) + 1 + iVar3),
                           *(undefined1 *)(*(int *)(iVar6 + 0x3c) + iVar3));
  *(int *)(iVar6 + 0x2c) = iVar3 + 2;
  iVar6 = *(int *)(uVar7 + 0x314);
  if (iVar6 == 0) {
    iVar6 = uVar7 + 0x28;
  }
  *(undefined1 *)(iVar6 + 0x15) = 0;
  if (*(int *)(iVar6 + 0x30) - *(int *)(iVar6 + 0x2c) < 2) {
    FUN_00539fb0(2);
  }
  iVar3 = *(int *)(iVar6 + 0x2c);
  uVar1 = *(undefined1 *)(*(int *)(iVar6 + 0x3c) + 1 + iVar3);
  uVar2 = *(undefined1 *)(*(int *)(iVar6 + 0x3c) + iVar3);
  *(int *)(iVar6 + 0x2c) = iVar3 + 2;
  FUN_0051b6e0();
  FUN_0051b6e0();
  FUN_0053a9b0(&local_14);
  FUN_0053a9b0(&param_1);
  GThread::OnExit(param_2);
  FUN_005e70e0(uVar7,uVar4 & 0x9ffff,(param_1 & 0xfffffffc) + 8,(local_14 & 0xfffffffc) + 8,local_8,
               local_c,CONCAT11(uVar1,uVar2));
  if ((local_8 == 0) && (local_4 != 0)) {
    FUN_00524240();
  }
  uVar7 = param_1 & 0xfffffffc;
  LVar5 = InterlockedExchangeAdd((LONG *)(uVar7 + 4),-1);
  if (LVar5 == 1) {
    FUN_00515cf0(uVar7);
  }
  LVar5 = InterlockedExchangeAdd((LONG *)((local_14 & 0xfffffffc) + 4),-1);
  if (LVar5 == 1) {
    FUN_00515cf0(local_14 & 0xfffffffc);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005e7460 : SUB ESP,0x14
005e7463 : PUSH EBX
005e7464 : MOV EBX,dword ptr [ESP + 0x1c]
005e7468 : MOV EAX,dword ptr [EBX + 0x314]
005e746e : PUSH EBP
005e746f : PUSH ESI
005e7470 : PUSH EDI
005e7471 : TEST EAX,EAX
005e7473 : JNZ 0x005e7478
005e7475 : LEA EAX,[EBX + 0x28]
005e7478 : MOV ECX,EBX
005e747a : MOV dword ptr [ESP + 0x14],EAX
005e747e : CALL 0x005e63b0
005e7483 : MOV ESI,dword ptr [EBX + 0x314]
005e7489 : MOV EBP,EAX
005e748b : TEST ESI,ESI
005e748d : JNZ 0x005e7492
005e748f : LEA ESI,[EBX + 0x28]
005e7492 : MOV ECX,dword ptr [ESI + 0x30]
005e7495 : SUB ECX,dword ptr [ESI + 0x2c]
005e7498 : MOV byte ptr [ESI + 0x15],0x0
005e749c : CMP ECX,0x2
005e749f : JGE 0x005e74aa
005e74a1 : PUSH 0x2
005e74a3 : MOV ECX,ESI
005e74a5 : CALL 0x00539fb0
005e74aa : MOV EAX,dword ptr [ESI + 0x2c]
005e74ad : MOV EDX,dword ptr [ESI + 0x3c]
005e74b0 : LEA ECX,[EDX + EAX*0x1]
005e74b3 : MOVZX DX,byte ptr [ECX + 0x1]
005e74b8 : MOVZX CX,byte ptr [ECX]
005e74bc : SHL DX,0x8
005e74c0 : OR DX,CX
005e74c3 : ADD EAX,0x2
005e74c6 : MOVZX EDX,DX
005e74c9 : MOV dword ptr [ESI + 0x2c],EAX
005e74cc : MOV ESI,dword ptr [EBX + 0x314]
005e74d2 : MOV dword ptr [ESP + 0x1c],EDX
005e74d6 : TEST ESI,ESI
005e74d8 : JNZ 0x005e74dd
005e74da : LEA ESI,[EBX + 0x28]
005e74dd : MOV EAX,dword ptr [ESI + 0x30]
005e74e0 : SUB EAX,dword ptr [ESI + 0x2c]
005e74e3 : MOV byte ptr [ESI + 0x15],0x0
005e74e7 : CMP EAX,0x2
005e74ea : JGE 0x005e74f5
005e74ec : PUSH 0x2
005e74ee : MOV ECX,ESI
005e74f0 : CALL 0x00539fb0
005e74f5 : MOV EAX,dword ptr [ESI + 0x2c]
005e74f8 : MOV ECX,dword ptr [ESI + 0x3c]
005e74fb : MOVZX DX,byte ptr [ECX + EAX*0x1 + 0x1]
005e7501 : ADD ECX,EAX
005e7503 : MOVZX CX,byte ptr [ECX]
005e7507 : SHL DX,0x8
005e750b : OR DX,CX
005e750e : ADD EAX,0x2
005e7511 : MOVZX EDX,DX
005e7514 : MOV dword ptr [ESI + 0x2c],EAX
005e7517 : MOV ESI,dword ptr [EBX + 0x314]
005e751d : MOV dword ptr [ESP + 0x18],EDX
005e7521 : TEST ESI,ESI
005e7523 : JNZ 0x005e7528
005e7525 : LEA ESI,[EBX + 0x28]
005e7528 : MOV EAX,dword ptr [ESI + 0x30]
005e752b : SUB EAX,dword ptr [ESI + 0x2c]
005e752e : MOV byte ptr [ESI + 0x15],0x0
005e7532 : CMP EAX,0x2
005e7535 : JGE 0x005e7540
005e7537 : PUSH 0x2
005e7539 : MOV ECX,ESI
005e753b : CALL 0x00539fb0
005e7540 : MOV EAX,dword ptr [ESI + 0x2c]
005e7543 : MOV ECX,dword ptr [ESI + 0x3c]
005e7546 : MOVZX DX,byte ptr [ECX + EAX*0x1 + 0x1]
005e754c : ADD ECX,EAX
005e754e : MOVZX CX,byte ptr [ECX]
005e7552 : SHL DX,0x8
005e7556 : OR DX,CX
005e7559 : ADD EAX,0x2
005e755c : LEA ECX,[ESP + 0x10]
005e7560 : MOVZX EDI,DX
005e7563 : MOV dword ptr [ESI + 0x2c],EAX
005e7566 : CALL 0x0051b6e0
005e756b : LEA ECX,[ESP + 0x28]
005e756f : CALL 0x0051b6e0
005e7574 : MOV ESI,dword ptr [ESP + 0x14]
005e7578 : LEA EDX,[ESP + 0x10]
005e757c : PUSH EDX
005e757d : MOV ECX,ESI
005e757f : CALL 0x0053a9b0
005e7584 : LEA EAX,[ESP + 0x28]
005e7588 : PUSH EAX
005e7589 : MOV ECX,ESI
005e758b : CALL 0x0053a9b0
005e7590 : MOV EAX,dword ptr [ESP + 0x10]
005e7594 : MOV ECX,dword ptr [ESP + 0x28]
005e7598 : MOVZX EDX,DI
005e759b : PUSH EDX
005e759c : MOVZX EDX,word ptr [ESP + 0x1c]
005e75a1 : PUSH EDX
005e75a2 : AND EAX,0xfffffffc
005e75a5 : ADD EAX,0x8
005e75a8 : PUSH EAX
005e75a9 : MOVZX EAX,word ptr [ESP + 0x28]
005e75ae : AND ECX,0xfffffffc
005e75b1 : ADD ECX,0x8
005e75b4 : PUSH ECX
005e75b5 : MOV ECX,dword ptr [ESP + 0x3c]
005e75b9 : MOV EDX,dword ptr [ECX]
005e75bb : PUSH EAX
005e75bc : PUSH EBP
005e75bd : PUSH EDX
005e75be : PUSH 0xb941c8
005e75c3 : PUSH ESI
005e75c4 : CALL 0x0051d420
005e75c9 : MOV EAX,dword ptr [ESP + 0x34]
005e75cd : MOV EDX,dword ptr [ESP + 0x3c]
005e75d1 : MOV ECX,dword ptr [ESP + 0x4c]
005e75d5 : ADD ESP,0x24
005e75d8 : PUSH EDI
005e75d9 : PUSH EDX
005e75da : MOV EDX,dword ptr [ESP + 0x24]
005e75de : AND EAX,0xfffffffc
005e75e1 : PUSH EDX
005e75e2 : ADD EAX,0x8
005e75e5 : PUSH EAX
005e75e6 : AND ECX,0xfffffffc
005e75e9 : ADD ECX,0x8
005e75ec : PUSH ECX
005e75ed : PUSH ECX
005e75ee : MOV EAX,ESP
005e75f0 : PUSH EBX
005e75f1 : AND EBP,0x9ffff
005e75f7 : LEA EBX,[ESP + 0x38]
005e75fb : MOV dword ptr [EAX],EBP
005e75fd : CALL 0x005e70e0
005e7602 : ADD ESP,0x1c
005e7605 : CMP dword ptr [ESP + 0x1c],0x0
005e760a : JNZ 0x005e7619
005e760c : MOV ECX,dword ptr [ESP + 0x20]
005e7610 : TEST ECX,ECX
005e7612 : JZ 0x005e7619
005e7614 : CALL 0x00524240
005e7619 : MOV ESI,dword ptr [ESP + 0x28]
005e761d : MOV EDI,dword ptr [0x00b851cc]
005e7623 : AND ESI,0xfffffffc
005e7626 : PUSH -0x1
005e7628 : LEA EAX,[ESI + 0x4]
005e762b : PUSH EAX
005e762c : CALL EDI
005e762e : SUB EAX,0x1
005e7631 : JNZ 0x005e7639
005e7633 : PUSH ESI
005e7634 : CALL 0x00515cf0
005e7639 : MOV ESI,dword ptr [ESP + 0x10]
005e763d : AND ESI,0xfffffffc
005e7640 : PUSH -0x1
005e7642 : LEA ECX,[ESI + 0x4]
005e7645 : PUSH ECX
005e7646 : CALL EDI
005e7648 : SUB EAX,0x1
005e764b : JNZ 0x005e7653
005e764d : PUSH ESI
005e764e : CALL 0x00515cf0
005e7653 : POP EDI
005e7654 : POP ESI
005e7655 : POP EBP
005e7656 : POP EBX
005e7657 : ADD ESP,0x14
005e765a : RET 0x8

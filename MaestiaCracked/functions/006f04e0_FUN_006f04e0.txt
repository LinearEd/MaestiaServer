PROGRAM  : Maestia.exe
FUNCTION : FUN_006f04e0
ENTRY    : 006f04e0
BODY     : [[006f04e0, 006f0544] [006f0567, 006f059e]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006f04e0(void)

{
  int iVar1;
  void *in_ECX;
  void *local_14;
  code *pcStack_10;
  uint local_c;
  undefined4 local_8;
  
  local_8 = 0xfffffffe;
  pcStack_10 = __except_handler4;
  local_14 = ExceptionList;
  local_c = DAT_00d66fa0 ^ 0xcf1428;
  if (((byte)DAT_01725270 & 0x10) == 0) {
    local_8 = 0;
    ExceptionList = &local_14;
    FUN_006f04a0();
    ExceptionList = local_14;
    return;
  }
  if (in_ECX == (void *)0x0) {
    return;
  }
  ExceptionList = &local_14;
  if (((byte)DAT_01725270 & 1) != 0) {
    iVar1 = FUN_006f0460();
    if (iVar1 != 0) {
      ExceptionList = local_14;
      return;
    }
    iVar1 = FUN_006f0330();
    if (iVar1 != 0) {
      ExceptionList = local_14;
      return;
    }
  }
  _free(in_ECX);
  ExceptionList = local_14;
  return;
}



============================================================
DISASSEMBLY
============================================================
006f04e0 : PUSH EBP
006f04e1 : MOV EBP,ESP
006f04e3 : PUSH -0x2
006f04e5 : PUSH 0xcf1428
006f04ea : PUSH 0x64c290
006f04ef : MOV EAX,FS:[0x0]
006f04f5 : PUSH EAX
006f04f6 : SUB ESP,0x8
006f04f9 : PUSH EBX
006f04fa : PUSH ESI
006f04fb : PUSH EDI
006f04fc : MOV EAX,[0x00d66fa0]
006f0501 : XOR dword ptr [EBP + -0x8],EAX
006f0504 : XOR EAX,EBP
006f0506 : PUSH EAX
006f0507 : LEA EAX,[EBP + -0x10]
006f050a : MOV FS:[0x0],EAX
006f0510 : MOV dword ptr [EBP + -0x18],ESP
006f0513 : MOV EDI,ECX
006f0515 : MOV AL,[0x01725270]
006f051a : TEST AL,0x10
006f051c : JNZ 0x006f0567
006f051e : MOV dword ptr [EBP + -0x4],0x0
006f0525 : MOV EAX,EDI
006f0527 : CALL 0x006f04a0
006f052c : MOV dword ptr [EBP + -0x4],0xfffffffe
006f0533 : MOV ECX,dword ptr [EBP + -0x10]
006f0536 : MOV dword ptr FS:[0x0],ECX
006f053d : POP ECX
006f053e : POP EDI
006f053f : POP ESI
006f0540 : POP EBX
006f0541 : MOV ESP,EBP
006f0543 : POP EBP
006f0544 : RET
006f0567 : TEST EDI,EDI
006f0569 : JZ 0x006f058d
006f056b : TEST AL,0x1
006f056d : JZ 0x006f0584
006f056f : CALL 0x006f0460
006f0574 : TEST EAX,EAX
006f0576 : JNZ 0x006f058d
006f0578 : LEA ESI,[EDI + -0x8]
006f057b : CALL 0x006f0330
006f0580 : TEST EAX,EAX
006f0582 : JNZ 0x006f058d
006f0584 : PUSH EDI
006f0585 : CALL 0x0063610d
006f058a : ADD ESP,0x4
006f058d : MOV ECX,dword ptr [EBP + -0x10]
006f0590 : MOV dword ptr FS:[0x0],ECX
006f0597 : POP ECX
006f0598 : POP EDI
006f0599 : POP ESI
006f059a : POP EBX
006f059b : MOV ESP,EBP
006f059d : POP EBP
006f059e : RET

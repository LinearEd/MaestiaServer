PROGRAM  : Maestia.exe
FUNCTION : FUN_00a6f640
ENTRY    : 00a6f640
BODY     : [[00a6f640, 00a6f7ca]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a6f640(undefined4 *param_1,int *param_2)

{
  short sVar1;
  uint uVar2;
  undefined4 *puVar3;
  short *psVar4;
  char *pcVar5;
  undefined4 *puVar6;
  short *psVar7;
  uint *unaff_ESI;
  int iVar8;
  
  puVar3 = param_1;
  puVar6 = (undefined4 *)*param_2;
  if ((puVar6 == (undefined4 *)0x0) || (*unaff_ESI < 4)) {
    *unaff_ESI = 0;
    puVar6 = (undefined4 *)0x0;
  }
  else {
    param_1[1] = *puVar6;
    *unaff_ESI = *unaff_ESI - 4;
    puVar6 = puVar6 + 1;
  }
  *param_2 = (int)puVar6;
  if ((puVar6 == (undefined4 *)0x0) || (*unaff_ESI < 4)) {
    *unaff_ESI = 0;
    psVar7 = (short *)0x0;
  }
  else {
    param_1[7] = *puVar6;
    *unaff_ESI = *unaff_ESI - 4;
    psVar7 = (short *)(puVar6 + 1);
  }
  *param_2 = (int)psVar7;
  if ((((psVar7 == (short *)0x0) || (uVar2 = *unaff_ESI, uVar2 < 2)) || (*psVar7 < 0)) ||
     (iVar8 = (int)*psVar7, (int)uVar2 < iVar8 + 2)) {
    psVar7 = (short *)0x0;
    iVar8 = 0;
    *unaff_ESI = 0;
  }
  else {
    *unaff_ESI = (uVar2 - iVar8) - 2;
    iVar8 = iVar8 + 2 + (int)psVar7;
    psVar7 = psVar7 + 1;
  }
  *param_2 = iVar8;
  psVar4 = psVar7;
  do {
    sVar1 = *psVar4;
    psVar4 = psVar4 + 1;
  } while (sVar1 != 0);
  FUN_00406360(psVar7,(int)psVar4 - (int)(psVar7 + 1) >> 1);
  puVar6 = (undefined4 *)*param_2;
  if ((puVar6 == (undefined4 *)0x0) || (*unaff_ESI < 4)) {
    *unaff_ESI = 0;
    puVar6 = (undefined4 *)0x0;
  }
  else {
    param_1[2] = *puVar6;
    *unaff_ESI = *unaff_ESI - 4;
    puVar6 = puVar6 + 1;
  }
  *param_2 = (int)puVar6;
  if ((puVar6 == (undefined4 *)0x0) || (*unaff_ESI < 4)) {
    *unaff_ESI = 0;
    puVar6 = (undefined4 *)0x0;
  }
  else {
    param_1[3] = *puVar6;
    *unaff_ESI = *unaff_ESI - 4;
    puVar6 = puVar6 + 1;
  }
  *param_2 = (int)puVar6;
  if ((puVar6 == (undefined4 *)0x0) || (*unaff_ESI == 0)) {
    *unaff_ESI = 0;
    pcVar5 = (char *)0x0;
  }
  else {
    *(undefined1 *)(param_1 + 6) = *(undefined1 *)puVar6;
    *unaff_ESI = *unaff_ESI - 1;
    pcVar5 = (char *)((int)puVar6 + 1);
  }
  *param_2 = (int)pcVar5;
  if ((pcVar5 == (char *)0x0) || (*unaff_ESI == 0)) {
    param_1._3_1_ = (char)((uint)(psVar7 + 1) >> 0x18);
    *unaff_ESI = 0;
    pcVar5 = (char *)0x0;
  }
  else {
    param_1._3_1_ = *pcVar5;
    *unaff_ESI = *unaff_ESI - 1;
    pcVar5 = pcVar5 + 1;
  }
  *param_2 = (int)pcVar5;
  *(bool *)((int)puVar3 + 0x59) = param_1._3_1_ != '\0';
  *(bool *)(puVar3 + 0x16) = param_1._3_1_ == '\0';
  puVar6 = (undefined4 *)*param_2;
  if ((puVar6 == (undefined4 *)0x0) || (*unaff_ESI < 8)) {
    *unaff_ESI = 0;
    puVar6 = (undefined4 *)0x0;
  }
  else {
    puVar3[0x18] = *puVar6;
    puVar3[0x19] = puVar6[1];
    *unaff_ESI = *unaff_ESI - 8;
    puVar6 = puVar6 + 2;
  }
  *param_2 = (int)puVar6;
  if ((puVar6 != (undefined4 *)0x0) && (3 < *unaff_ESI)) {
    *puVar3 = *puVar6;
    *unaff_ESI = *unaff_ESI - 4;
    *param_2 = (int)(puVar6 + 1);
    return;
  }
  *unaff_ESI = 0;
  *param_2 = 0;
  return;
}



============================================================
DISASSEMBLY
============================================================
00a6f640 : PUSH EBP
00a6f641 : MOV EBP,ESP
00a6f643 : PUSH EBX
00a6f644 : MOV EBX,dword ptr [EBP + 0xc]
00a6f647 : MOV EAX,dword ptr [EBX]
00a6f649 : PUSH EDI
00a6f64a : TEST EAX,EAX
00a6f64c : JZ 0x00a6f663
00a6f64e : CMP dword ptr [ESI],0x4
00a6f651 : JC 0x00a6f663
00a6f653 : MOV ECX,dword ptr [EAX]
00a6f655 : MOV EDI,dword ptr [EBP + 0x8]
00a6f658 : MOV dword ptr [EDI + 0x4],ECX
00a6f65b : ADD dword ptr [ESI],-0x4
00a6f65e : ADD EAX,0x4
00a6f661 : JMP 0x00a6f66e
00a6f663 : MOV EDI,dword ptr [EBP + 0x8]
00a6f666 : MOV dword ptr [ESI],0x0
00a6f66c : XOR EAX,EAX
00a6f66e : MOV dword ptr [EBX],EAX
00a6f670 : TEST EAX,EAX
00a6f672 : JZ 0x00a6f686
00a6f674 : CMP dword ptr [ESI],0x4
00a6f677 : JC 0x00a6f686
00a6f679 : MOV EDX,dword ptr [EAX]
00a6f67b : MOV dword ptr [EDI + 0x1c],EDX
00a6f67e : ADD dword ptr [ESI],-0x4
00a6f681 : LEA ECX,[EAX + 0x4]
00a6f684 : JMP 0x00a6f68e
00a6f686 : MOV dword ptr [ESI],0x0
00a6f68c : XOR ECX,ECX
00a6f68e : MOV dword ptr [EBX],ECX
00a6f690 : TEST ECX,ECX
00a6f692 : JZ 0x00a6f6c3
00a6f694 : MOV EAX,dword ptr [ESI]
00a6f696 : CMP EAX,0x2
00a6f699 : JC 0x00a6f6c3
00a6f69b : MOVZX EDX,word ptr [ECX]
00a6f69e : TEST DX,DX
00a6f6a1 : JL 0x00a6f6c3
00a6f6a3 : MOVSX EDI,DX
00a6f6a6 : LEA EDX,[EDI + 0x2]
00a6f6a9 : CMP EAX,EDX
00a6f6ab : JL 0x00a6f6c0
00a6f6ad : SUB EAX,EDI
00a6f6af : SUB EAX,0x2
00a6f6b2 : MOV dword ptr [ESI],EAX
00a6f6b4 : LEA EAX,[EDI + ECX*0x1 + 0x2]
00a6f6b8 : MOV EDI,dword ptr [EBP + 0x8]
00a6f6bb : LEA EDX,[ECX + 0x2]
00a6f6be : JMP 0x00a6f6c9
00a6f6c0 : MOV EDI,dword ptr [EBP + 0x8]
00a6f6c3 : XOR EDX,EDX
00a6f6c5 : XOR EAX,EAX
00a6f6c7 : MOV dword ptr [ESI],EAX
00a6f6c9 : MOV dword ptr [EBX],EAX
00a6f6cb : MOV EAX,EDX
00a6f6cd : LEA ECX,[EAX + 0x2]
00a6f6d0 : MOV dword ptr [EBP + 0x8],ECX
00a6f6d3 : MOV CX,word ptr [EAX]
00a6f6d6 : ADD EAX,0x2
00a6f6d9 : TEST CX,CX
00a6f6dc : JNZ 0x00a6f6d3
00a6f6de : SUB EAX,dword ptr [EBP + 0x8]
00a6f6e1 : LEA ECX,[EDI + 0x20]
00a6f6e4 : SAR EAX,0x1
00a6f6e6 : PUSH EAX
00a6f6e7 : PUSH EDX
00a6f6e8 : CALL 0x00406360
00a6f6ed : MOV EAX,dword ptr [EBX]
00a6f6ef : TEST EAX,EAX
00a6f6f1 : JZ 0x00a6f705
00a6f6f3 : CMP dword ptr [ESI],0x4
00a6f6f6 : JC 0x00a6f705
00a6f6f8 : MOV EDX,dword ptr [EAX]
00a6f6fa : MOV dword ptr [EDI + 0x8],EDX
00a6f6fd : ADD dword ptr [ESI],-0x4
00a6f700 : ADD EAX,0x4
00a6f703 : JMP 0x00a6f70d
00a6f705 : MOV dword ptr [ESI],0x0
00a6f70b : XOR EAX,EAX
00a6f70d : MOV dword ptr [EBX],EAX
00a6f70f : TEST EAX,EAX
00a6f711 : JZ 0x00a6f725
00a6f713 : CMP dword ptr [ESI],0x4
00a6f716 : JC 0x00a6f725
00a6f718 : MOV ECX,dword ptr [EAX]
00a6f71a : MOV dword ptr [EDI + 0xc],ECX
00a6f71d : ADD dword ptr [ESI],-0x4
00a6f720 : ADD EAX,0x4
00a6f723 : JMP 0x00a6f72d
00a6f725 : MOV dword ptr [ESI],0x0
00a6f72b : XOR EAX,EAX
00a6f72d : MOV dword ptr [EBX],EAX
00a6f72f : TEST EAX,EAX
00a6f731 : JZ 0x00a6f742
00a6f733 : CMP dword ptr [ESI],0x1
00a6f736 : JC 0x00a6f742
00a6f738 : MOV DL,byte ptr [EAX]
00a6f73a : MOV byte ptr [EDI + 0x18],DL
00a6f73d : DEC dword ptr [ESI]
00a6f73f : INC EAX
00a6f740 : JMP 0x00a6f74a
00a6f742 : MOV dword ptr [ESI],0x0
00a6f748 : XOR EAX,EAX
00a6f74a : MOV dword ptr [EBX],EAX
00a6f74c : TEST EAX,EAX
00a6f74e : JZ 0x00a6f75f
00a6f750 : MOV EDX,dword ptr [ESI]
00a6f752 : CMP EDX,0x1
00a6f755 : JC 0x00a6f75f
00a6f757 : MOV CL,byte ptr [EAX]
00a6f759 : DEC EDX
00a6f75a : MOV dword ptr [ESI],EDX
00a6f75c : INC EAX
00a6f75d : JMP 0x00a6f76a
00a6f75f : MOV CL,byte ptr [EBP + 0xb]
00a6f762 : MOV dword ptr [ESI],0x0
00a6f768 : XOR EAX,EAX
00a6f76a : TEST CL,CL
00a6f76c : MOV dword ptr [EBX],EAX
00a6f76e : SETNZ AL
00a6f771 : TEST CL,CL
00a6f773 : SETZ CL
00a6f776 : MOV byte ptr [EDI + 0x59],AL
00a6f779 : MOV byte ptr [EDI + 0x58],CL
00a6f77c : MOV EAX,dword ptr [EBX]
00a6f77e : TEST EAX,EAX
00a6f780 : JZ 0x00a6f79a
00a6f782 : CMP dword ptr [ESI],0x8
00a6f785 : JC 0x00a6f79a
00a6f787 : MOV EDX,dword ptr [EAX]
00a6f789 : MOV dword ptr [EDI + 0x60],EDX
00a6f78c : MOV ECX,dword ptr [EAX + 0x4]
00a6f78f : MOV dword ptr [EDI + 0x64],ECX
00a6f792 : ADD dword ptr [ESI],-0x8
00a6f795 : ADD EAX,0x8
00a6f798 : JMP 0x00a6f7a2
00a6f79a : MOV dword ptr [ESI],0x0
00a6f7a0 : XOR EAX,EAX
00a6f7a2 : MOV dword ptr [EBX],EAX
00a6f7a4 : TEST EAX,EAX
00a6f7a6 : JZ 0x00a6f7bd
00a6f7a8 : CMP dword ptr [ESI],0x4
00a6f7ab : JC 0x00a6f7bd
00a6f7ad : MOV EDX,dword ptr [EAX]
00a6f7af : MOV dword ptr [EDI],EDX
00a6f7b1 : ADD dword ptr [ESI],-0x4
00a6f7b4 : ADD EAX,0x4
00a6f7b7 : POP EDI
00a6f7b8 : MOV dword ptr [EBX],EAX
00a6f7ba : POP EBX
00a6f7bb : POP EBP
00a6f7bc : RET
00a6f7bd : XOR EAX,EAX
00a6f7bf : MOV dword ptr [ESI],0x0
00a6f7c5 : POP EDI
00a6f7c6 : MOV dword ptr [EBX],EAX
00a6f7c8 : POP EBX
00a6f7c9 : POP EBP
00a6f7ca : RET

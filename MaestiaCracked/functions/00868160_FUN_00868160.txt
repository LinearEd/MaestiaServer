PROGRAM  : Maestia.exe
FUNCTION : FUN_00868160
ENTRY    : 00868160
BODY     : [[00868160, 00868291]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00868160(void)

{
  uint uVar1;
  int iVar2;
  int *in_ECX;
  undefined1 local_34;
  undefined1 local_33;
  undefined4 local_30;
  undefined4 local_2c;
  undefined2 local_28;
  undefined1 local_26;
  undefined4 local_24;
  undefined1 local_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_00b62d60;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)&local_34;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xffffffc0;
  ExceptionList = &local_14;
  if (*(char *)((uint)(*(char *)(in_ECX[0x104] + 300) == '\0') * 0x30 + 0xb1 + in_ECX[0x104]) ==
      '\x01') {
    *(undefined1 *)((int)in_ECX + 0xacd) = 1;
    if (in_ECX[0x5fc] == 0) {
      iVar2 = 0;
    }
    else {
      iVar2 = in_ECX[0x5ba];
    }
    in_ECX[0x694] = iVar2;
    if (*(char *)((int)in_ECX + 0x65d) == '\0') {
      local_30 = 0;
      local_2c = 0;
      local_28 = 0;
      local_26 = 1;
      local_20 = 0;
      local_34 = 0;
      local_33 = 0;
      local_24 = 1;
      FUN_0041dea0(&local_34);
    }
    else if (in_ECX[0x5fc] != 0) {
      in_ECX[0x5ba] = 0;
      FUN_0085de20(uVar1);
      FUN_0085dcf0();
      (**(code **)(*in_ECX + 0x49c))((short)in_ECX[0x10f],1);
      (**(code **)(*in_ECX + 0x484))(0);
      FUN_00862750(in_ECX,0);
      (**(code **)(*in_ECX + 0x4a0))(0,1);
    }
  }
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)&local_34);
  return;
}



============================================================
DISASSEMBLY
============================================================
00868160 : PUSH EBP
00868161 : MOV EBP,ESP
00868163 : AND ESP,0xfffffff8
00868166 : PUSH -0x1
00868168 : PUSH 0xb62d60
0086816d : MOV EAX,FS:[0x0]
00868173 : PUSH EAX
00868174 : SUB ESP,0x20
00868177 : MOV EAX,[0x00d66fa0]
0086817c : XOR EAX,ESP
0086817e : MOV dword ptr [ESP + 0x18],EAX
00868182 : PUSH EBX
00868183 : PUSH ESI
00868184 : PUSH EDI
00868185 : MOV EAX,[0x00d66fa0]
0086818a : XOR EAX,ESP
0086818c : PUSH EAX
0086818d : LEA EAX,[ESP + 0x30]
00868191 : MOV FS:[0x0],EAX
00868197 : MOV ESI,ECX
00868199 : MOV EAX,dword ptr [ESI + 0x410]
0086819f : XOR ECX,ECX
008681a1 : XOR EBX,EBX
008681a3 : CMP byte ptr [EAX + 0x12c],BL
008681a9 : SETZ CL
008681ac : LEA ECX,[ECX + ECX*0x2]
008681af : SHL ECX,0x4
008681b2 : MOV AL,byte ptr [ECX + EAX*0x1 + 0xb1]
008681b9 : CMP AL,0x1
008681bb : JNZ 0x00868274
008681c1 : MOV byte ptr [ESI + 0xacd],AL
008681c7 : CMP dword ptr [ESI + 0x17f0],EBX
008681cd : JZ 0x008681d7
008681cf : MOV EAX,dword ptr [ESI + 0x16e8]
008681d5 : JMP 0x008681d9
008681d7 : XOR EAX,EAX
008681d9 : MOV dword ptr [ESI + 0x1a50],EAX
008681df : CMP byte ptr [ESI + 0x65d],BL
008681e5 : JNZ 0x00868221
008681e7 : LEA EAX,[ESP + 0x10]
008681eb : XOR EDX,EDX
008681ed : PUSH EAX
008681ee : LEA EAX,[ESI + 0x19a4]
008681f4 : MOV dword ptr [ESP + 0x18],EBX
008681f8 : MOV dword ptr [ESP + 0x1c],EBX
008681fc : MOV word ptr [ESP + 0x20],DX
00868201 : MOV byte ptr [ESP + 0x22],0x1
00868206 : MOV byte ptr [ESP + 0x28],BL
0086820a : MOV byte ptr [ESP + 0x14],BL
0086820e : MOV byte ptr [ESP + 0x15],BL
00868212 : MOV dword ptr [ESP + 0x24],0x1
0086821a : CALL 0x0041dea0
0086821f : JMP 0x00868274
00868221 : CMP dword ptr [ESI + 0x17f0],EBX
00868227 : JZ 0x00868274
00868229 : MOV EDI,ESI
0086822b : MOV dword ptr [ESI + 0x16e8],EBX
00868231 : CALL 0x0085de20
00868236 : CALL 0x0085dcf0
0086823b : MOVZX EAX,word ptr [ESI + 0x43c]
00868242 : MOV EDX,dword ptr [ESI]
00868244 : MOV EDX,dword ptr [EDX + 0x49c]
0086824a : PUSH 0x1
0086824c : PUSH EAX
0086824d : MOV ECX,ESI
0086824f : CALL EDX
00868251 : MOV EAX,dword ptr [ESI]
00868253 : MOV EDX,dword ptr [EAX + 0x484]
00868259 : PUSH EBX
0086825a : MOV ECX,ESI
0086825c : CALL EDX
0086825e : PUSH EBX
0086825f : PUSH ESI
00868260 : CALL 0x00862750
00868265 : MOV EAX,dword ptr [ESI]
00868267 : MOV EDX,dword ptr [EAX + 0x4a0]
0086826d : PUSH 0x1
0086826f : PUSH EBX
00868270 : MOV ECX,ESI
00868272 : CALL EDX
00868274 : MOV ECX,dword ptr [ESP + 0x30]
00868278 : MOV dword ptr FS:[0x0],ECX
0086827f : POP ECX
00868280 : POP EDI
00868281 : POP ESI
00868282 : POP EBX
00868283 : MOV ECX,dword ptr [ESP + 0x18]
00868287 : XOR ECX,ESP
00868289 : CALL 0x00633e6b
0086828e : MOV ESP,EBP
00868290 : POP EBP
00868291 : RET

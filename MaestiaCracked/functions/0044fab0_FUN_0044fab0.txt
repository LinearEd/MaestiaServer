PROGRAM  : Maestia.exe
FUNCTION : FUN_0044fab0
ENTRY    : 0044fab0
BODY     : [[0044fab0, 0044fc16]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0044fab0(undefined4 param_1,short *param_2)

{
  short *psVar1;
  undefined1 uVar2;
  undefined1 local_68 [32];
  undefined4 **local_48 [4];
  int local_38;
  uint local_34;
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7def0;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if ((*param_2 == 0x24) && (DAT_0172491c != 0)) {
    psVar1 = param_2 + 1;
    FUN_00404750(psVar1,local_14);
    local_8 = 0;
    FUN_0081cce0(DAT_0172491c);
    local_8._0_1_ = 2;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c = 0;
    FUN_00406460(&DAT_00cca49c);
    local_8._0_1_ = 3;
    uVar2 = (undefined1)local_8;
    local_8._0_1_ = 3;
    if (local_38 == 0) {
      local_8._0_1_ = uVar2;
      FUN_00483f90(psVar1);
      FUN_00404750(psVar1);
      FUN_00406560();
      local_8 = CONCAT31(local_8._1_3_,2);
      FUN_00406560();
      local_8 = 0xffffffff;
      FUN_00406560();
    }
    else {
      FUN_00406460(param_2);
      local_8._0_1_ = 4;
      FUN_0081f330(local_68);
      local_8._0_1_ = 3;
      FUN_00406560();
      if (local_34 < 8) {
        local_48[0] = local_48;
      }
      FUN_004ffa30(local_48[0],0xffffffff);
      local_8 = CONCAT31(local_8._1_3_,2);
      FUN_00406560();
      local_8 = 0xffffffff;
      FUN_00406560();
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0044fab0 : PUSH EBP
0044fab1 : MOV EBP,ESP
0044fab3 : PUSH -0x1
0044fab5 : PUSH 0xb7def0
0044faba : MOV EAX,FS:[0x0]
0044fac0 : PUSH EAX
0044fac1 : SUB ESP,0x5c
0044fac4 : MOV EAX,[0x00d66fa0]
0044fac9 : XOR EAX,EBP
0044facb : MOV dword ptr [EBP + -0x10],EAX
0044face : PUSH EBX
0044facf : PUSH ESI
0044fad0 : PUSH EDI
0044fad1 : PUSH EAX
0044fad2 : LEA EAX,[EBP + -0xc]
0044fad5 : MOV FS:[0x0],EAX
0044fadb : MOV EBX,dword ptr [EBP + 0xc]
0044fade : CMP word ptr [EBX],0x24
0044fae2 : MOV EAX,dword ptr [EBP + 0x8]
0044fae5 : MOV dword ptr [EBP + -0x68],EAX
0044fae8 : JNZ 0x0044fbf7
0044faee : CMP dword ptr [0x0172491c],0x0
0044faf5 : JZ 0x0044fbf7
0044fafb : LEA EDI,[EBX + 0x2]
0044fafe : PUSH EDI
0044faff : LEA ESI,[EBP + -0x2c]
0044fb02 : CALL 0x00404750
0044fb07 : ADD ESP,0x4
0044fb0a : MOV dword ptr [EBP + -0x4],0x0
0044fb11 : MOV ECX,dword ptr [0x0172491c]
0044fb17 : PUSH ECX
0044fb18 : MOV ECX,EAX
0044fb1a : LEA ESI,[EBP + -0x48]
0044fb1d : CALL 0x0081cce0
0044fb22 : MOV byte ptr [EBP + -0x4],0x2
0044fb26 : MOV ESI,0x8
0044fb2b : CMP dword ptr [EBP + -0x14],ESI
0044fb2e : JC 0x0044fb38
0044fb30 : MOV ECX,dword ptr [EBP + -0x28]
0044fb33 : CALL 0x006f04e0
0044fb38 : XOR EDX,EDX
0044fb3a : PUSH 0xcca49c
0044fb3f : LEA ECX,[EBP + -0x64]
0044fb42 : MOV dword ptr [EBP + -0x14],0x7
0044fb49 : MOV dword ptr [EBP + -0x18],0x0
0044fb50 : MOV word ptr [EBP + -0x28],DX
0044fb54 : CALL 0x00406460
0044fb59 : MOV byte ptr [EBP + -0x4],0x3
0044fb5d : CMP dword ptr [EBP + -0x34],0x0
0044fb61 : JZ 0x0044fbc3
0044fb63 : PUSH EBX
0044fb64 : LEA ECX,[EBP + -0x2c]
0044fb67 : CALL 0x00406460
0044fb6c : MOV byte ptr [EBP + -0x4],0x4
0044fb70 : MOV ECX,dword ptr [0x0172491c]
0044fb76 : LEA EAX,[EBP + -0x64]
0044fb79 : PUSH EAX
0044fb7a : LEA EDX,[EBP + -0x2c]
0044fb7d : CALL 0x0081f330
0044fb82 : MOV byte ptr [EBP + -0x4],0x3
0044fb86 : LEA ECX,[EBP + -0x2c]
0044fb89 : CALL 0x00406560
0044fb8e : MOV EAX,dword ptr [EBP + -0x44]
0044fb91 : CMP dword ptr [EBP + -0x30],ESI
0044fb94 : JNC 0x0044fb99
0044fb96 : LEA EAX,[EBP + -0x44]
0044fb99 : MOV ECX,dword ptr [EBP + -0x68]
0044fb9c : PUSH -0x1
0044fb9e : PUSH EAX
0044fb9f : CALL 0x004ffa30
0044fba4 : MOV byte ptr [EBP + -0x4],0x2
0044fba8 : LEA ECX,[EBP + -0x64]
0044fbab : CALL 0x00406560
0044fbb0 : MOV dword ptr [EBP + -0x4],0xffffffff
0044fbb7 : LEA ECX,[EBP + -0x48]
0044fbba : CALL 0x00406560
0044fbbf : MOV AL,0x1
0044fbc1 : JMP 0x0044fbf9
0044fbc3 : PUSH EDI
0044fbc4 : CALL 0x00483f90
0044fbc9 : PUSH EDI
0044fbca : LEA ESI,[EBP + -0x2c]
0044fbcd : CALL 0x00404750
0044fbd2 : ADD ESP,0x8
0044fbd5 : MOV ECX,ESI
0044fbd7 : CALL 0x00406560
0044fbdc : MOV byte ptr [EBP + -0x4],0x2
0044fbe0 : LEA ECX,[EBP + -0x64]
0044fbe3 : CALL 0x00406560
0044fbe8 : MOV dword ptr [EBP + -0x4],0xffffffff
0044fbef : LEA ECX,[EBP + -0x48]
0044fbf2 : CALL 0x00406560
0044fbf7 : XOR AL,AL
0044fbf9 : MOV ECX,dword ptr [EBP + -0xc]
0044fbfc : MOV dword ptr FS:[0x0],ECX
0044fc03 : POP ECX
0044fc04 : POP EDI
0044fc05 : POP ESI
0044fc06 : POP EBX
0044fc07 : MOV ECX,dword ptr [EBP + -0x10]
0044fc0a : XOR ECX,EBP
0044fc0c : CALL 0x00633e6b
0044fc11 : MOV ESP,EBP
0044fc13 : POP EBP
0044fc14 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_00846e20
ENTRY    : 00846e20
BODY     : [[00846e20, 00846f12]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00846e20(int param_1,short param_2)

{
  int iVar1;
  short sVar2;
  uint uVar3;
  int iVar4;
  undefined4 uVar5;
  int in_ECX;
  undefined1 local_48 [56];
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  sVar2 = param_2;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1b8d3;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  _param_2 = param_1;
  FUN_004437f0(&param_2);
  if (((param_1 != *(int *)(in_ECX + 4)) && (iVar1 = *(int *)(param_1 + 0x10), iVar1 != 0)) &&
     (*(int *)(iVar1 + 4) != 0)) {
    *(short *)(iVar1 + 8) = sVar2;
    if (sVar2 == 2) {
      iVar4 = FUN_006f0c10(local_48,1);
      local_8 = 0;
      if (*(uint *)(iVar4 + 0x18) < 8) {
        iVar4 = iVar4 + 4;
      }
      else {
        iVar4 = *(int *)(iVar4 + 4);
      }
      uVar5 = FUN_00404750(&DAT_00c3bfe0,*(undefined1 *)(*(int *)(iVar1 + 4) + 0x98),iVar4,uVar3);
      local_8._0_1_ = 1;
      FUN_00405eb0(uVar5,0,0xffffffff);
      local_8 = (uint)local_8._1_3_ << 8;
      FUN_00406560();
      local_8 = 0xffffffff;
      FUN_00406560();
    }
    *(undefined1 *)(iVar1 + 0x1c) = 1;
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00846e20 : PUSH EBP
00846e21 : MOV EBP,ESP
00846e23 : PUSH -0x1
00846e25 : PUSH 0xb1b8d3
00846e2a : MOV EAX,FS:[0x0]
00846e30 : PUSH EAX
00846e31 : SUB ESP,0x38
00846e34 : PUSH EBX
00846e35 : PUSH ESI
00846e36 : PUSH EDI
00846e37 : MOV EAX,[0x00d66fa0]
00846e3c : XOR EAX,EBP
00846e3e : PUSH EAX
00846e3f : LEA EAX,[EBP + -0xc]
00846e42 : MOV FS:[0x0],EAX
00846e48 : MOV BX,word ptr [EBP + 0xc]
00846e4c : MOV ESI,ECX
00846e4e : MOV EAX,dword ptr [EBP + 0x8]
00846e51 : LEA ECX,[EBP + 0xc]
00846e54 : MOV dword ptr [EBP + 0xc],EAX
00846e57 : PUSH ECX
00846e58 : LEA EAX,[EBP + 0x8]
00846e5b : MOV ECX,ESI
00846e5d : CALL 0x004437f0
00846e62 : MOV ESI,dword ptr [ESI + 0x4]
00846e65 : MOV EAX,dword ptr [EBP + 0x8]
00846e68 : CMP EAX,ESI
00846e6a : JZ 0x00846eff
00846e70 : MOV EDI,dword ptr [EAX + 0x10]
00846e73 : TEST EDI,EDI
00846e75 : JZ 0x00846eff
00846e7b : MOV EAX,dword ptr [EDI + 0x4]
00846e7e : TEST EAX,EAX
00846e80 : JZ 0x00846eff
00846e82 : MOV word ptr [EDI + 0x8],BX
00846e86 : CMP BX,0x2
00846e8a : JNZ 0x00846efb
00846e8c : PUSH 0x1
00846e8e : LEA EDX,[EBP + -0x44]
00846e91 : PUSH EDX
00846e92 : MOV EDX,dword ptr [EAX + 0x8]
00846e95 : MOV ECX,0x1724628
00846e9a : CALL 0x006f0c10
00846e9f : MOV dword ptr [EBP + -0x4],0x0
00846ea6 : CMP dword ptr [EAX + 0x18],0x8
00846eaa : JC 0x00846eb1
00846eac : MOV EAX,dword ptr [EAX + 0x4]
00846eaf : JMP 0x00846eb4
00846eb1 : ADD EAX,0x4
00846eb4 : PUSH EAX
00846eb5 : MOV EAX,dword ptr [EDI + 0x4]
00846eb8 : MOVZX ECX,byte ptr [EAX + 0x98]
00846ebf : PUSH ECX
00846ec0 : PUSH 0xc3bfe0
00846ec5 : LEA ESI,[EBP + -0x28]
00846ec8 : CALL 0x00404750
00846ecd : ADD ESP,0xc
00846ed0 : MOV byte ptr [EBP + -0x4],0x1
00846ed4 : PUSH -0x1
00846ed6 : PUSH 0x0
00846ed8 : PUSH EAX
00846ed9 : LEA ECX,[EDI + 0x3c]
00846edc : CALL 0x00405eb0
00846ee1 : MOV byte ptr [EBP + -0x4],0x0
00846ee5 : MOV ECX,ESI
00846ee7 : CALL 0x00406560
00846eec : MOV dword ptr [EBP + -0x4],0xffffffff
00846ef3 : LEA ECX,[EBP + -0x44]
00846ef6 : CALL 0x00406560
00846efb : MOV byte ptr [EDI + 0x1c],0x1
00846eff : MOV ECX,dword ptr [EBP + -0xc]
00846f02 : MOV dword ptr FS:[0x0],ECX
00846f09 : POP ECX
00846f0a : POP EDI
00846f0b : POP ESI
00846f0c : POP EBX
00846f0d : MOV ESP,EBP
00846f0f : POP EBP
00846f10 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_00788160
ENTRY    : 00788160
BODY     : [[00788160, 0078821c] [00788220, 007883c3]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_00788160(int param_1,undefined4 param_2,float param_3,float param_4,char param_5)

{
  byte *pbVar1;
  int iVar2;
  uint in_EAX;
  ushort *puVar3;
  int *piVar4;
  int in_EDX;
  int iVar5;
  float fVar6;
  
  iVar5 = *(int *)(in_EAX + 0xc);
  if ((iVar5 != 0) && (*(int *)(in_EAX + 0x14) != 0)) {
    if (*(int *)(in_EAX + 0x10) == 3) {
      piVar4 = (int *)(in_EAX + 8);
      in_EAX = *(uint *)(in_EAX + 0x18);
      iVar2 = *piVar4 + param_1 * 8;
      if (in_EAX == 0x65) {
        puVar3 = (ushort *)(iVar5 + in_EDX * 2);
        in_EAX = 0;
        while ((float)*(byte *)(iVar2 + 7 + (uint)*puVar3 * 8) * 0.003921569 * param_3 + param_4 <=
               0.02) {
          in_EAX = in_EAX + 1;
          puVar3 = puVar3 + 1;
          if (2 < (int)in_EAX) {
            return CONCAT31((int3)(in_EAX >> 8),1);
          }
        }
      }
      else if (in_EAX == 0x66) {
        piVar4 = (int *)(iVar5 + in_EDX * 4);
        in_EAX = 0;
        while ((float)*(byte *)(iVar2 + 7 + *piVar4 * 8) * 0.003921569 * param_3 + param_4 <= 0.02)
        {
          in_EAX = in_EAX + 1;
          piVar4 = piVar4 + 1;
          if (2 < (int)in_EAX) {
            return CONCAT31((int3)(in_EAX >> 8),1);
          }
        }
      }
    }
    else if (*(int *)(in_EAX + 0x10) == 4) {
      piVar4 = (int *)(in_EAX + 8);
      in_EAX = *(uint *)(in_EAX + 0x18);
      iVar2 = *piVar4 + param_1 * 0xc;
      if (in_EAX == 0x65) {
        puVar3 = (ushort *)(iVar5 + in_EDX * 2);
        iVar5 = 0;
        while( true ) {
          in_EAX = iVar2 + (uint)*puVar3 * 0xc;
          pbVar1 = (byte *)(in_EAX + 0xb);
          fVar6 = (float)*(byte *)(iVar2 + 7 + (uint)*puVar3 * 0xc) * 0.003921569;
          if (param_5 != '\0') {
            in_EAX = (uint)*(byte *)(in_EAX + 8);
            fVar6 = (float)in_EAX * 0.003921569 * (1.0 - fVar6) + fVar6;
          }
          if (0.02 < (fVar6 * param_3 + param_4) * (float)*pbVar1 * 0.003921569) break;
          iVar5 = iVar5 + 1;
          puVar3 = puVar3 + 1;
          if (2 < iVar5) {
            return CONCAT31((int3)(in_EAX >> 8),1);
          }
        }
      }
      else if (in_EAX == 0x66) {
        piVar4 = (int *)(iVar5 + in_EDX * 4);
        iVar5 = 0;
        while( true ) {
          in_EAX = iVar2 + *piVar4 * 0xc;
          pbVar1 = (byte *)(in_EAX + 0xb);
          fVar6 = (float)*(byte *)(in_EAX + 7) * 0.003921569;
          if (param_5 != '\0') {
            in_EAX = (uint)*(byte *)(in_EAX + 8);
            fVar6 = (float)in_EAX * 0.003921569 * (1.0 - fVar6) + fVar6;
          }
          if (0.02 < (fVar6 * param_3 + param_4) * (float)*pbVar1 * 0.003921569) break;
          iVar5 = iVar5 + 1;
          piVar4 = piVar4 + 1;
          if (2 < iVar5) {
            return CONCAT31((int3)(in_EAX >> 8),1);
          }
        }
      }
    }
    return in_EAX & 0xffffff00;
  }
  return in_EAX & 0xffffff00;
}



============================================================
DISASSEMBLY
============================================================
00788160 : PUSH EBP
00788161 : MOV EBP,ESP
00788163 : MOV ECX,dword ptr [EAX + 0xc]
00788166 : PUSH EBX
00788167 : MOV BL,byte ptr [EBP + 0x18]
0078816a : PUSH ESI
0078816b : MOV ESI,dword ptr [EBP + 0x8]
0078816e : TEST ECX,ECX
00788170 : JZ 0x007883bc
00788176 : CMP dword ptr [EAX + 0x14],0x0
0078817a : JZ 0x007883bc
00788180 : PUSH EDI
00788181 : MOV EDI,dword ptr [EAX + 0x10]
00788184 : CMP EDI,0x3
00788187 : JNZ 0x00788252
0078818d : MOV EDI,dword ptr [EAX + 0x8]
00788190 : MOV EAX,dword ptr [EAX + 0x18]
00788193 : LEA ESI,[EDI + ESI*0x8]
00788196 : CMP EAX,0x65
00788199 : JNZ 0x007881f3
0078819b : MOVSS XMM0,dword ptr [EBP + 0x14]
007881a0 : MOVSS XMM1,dword ptr [EBP + 0x10]
007881a5 : MOVSS XMM2,dword ptr [0x00cdf178]
007881ad : MOVSS XMM3,dword ptr [0x00cdf17c]
007881b5 : LEA ECX,[ECX + EDX*0x2]
007881b8 : XOR EAX,EAX
007881ba : LEA EBX,[EBX]
007881c0 : MOVZX EDX,word ptr [ECX]
007881c3 : MOVZX EDX,byte ptr [ESI + EDX*0x8 + 0x7]
007881c8 : CVTSI2SS XMM4,EDX
007881cc : MULSS XMM4,XMM2
007881d0 : MULSS XMM4,XMM1
007881d4 : ADDSS XMM4,XMM0
007881d8 : COMISS XMM4,XMM3
007881db : JA 0x007883b3
007881e1 : INC EAX
007881e2 : ADD ECX,0x2
007881e5 : CMP EAX,0x3
007881e8 : JL 0x007881c0
007881ea : POP EDI
007881eb : POP ESI
007881ec : MOV AL,0x1
007881ee : POP EBX
007881ef : POP EBP
007881f0 : RET 0x14
007881f3 : CMP EAX,0x66
007881f6 : JNZ 0x007883b3
007881fc : MOVSS XMM0,dword ptr [EBP + 0x14]
00788201 : MOVSS XMM1,dword ptr [EBP + 0x10]
00788206 : MOVSS XMM2,dword ptr [0x00cdf178]
0078820e : MOVSS XMM3,dword ptr [0x00cdf17c]
00788216 : LEA ECX,[ECX + EDX*0x4]
00788219 : XOR EAX,EAX
0078821b : JMP 0x00788220
00788220 : MOV EDX,dword ptr [ECX]
00788222 : MOVZX EDX,byte ptr [ESI + EDX*0x8 + 0x7]
00788227 : CVTSI2SS XMM4,EDX
0078822b : MULSS XMM4,XMM2
0078822f : MULSS XMM4,XMM1
00788233 : ADDSS XMM4,XMM0
00788237 : COMISS XMM4,XMM3
0078823a : JA 0x007883b3
00788240 : INC EAX
00788241 : ADD ECX,0x4
00788244 : CMP EAX,0x3
00788247 : JL 0x00788220
00788249 : POP EDI
0078824a : POP ESI
0078824b : MOV AL,0x1
0078824d : POP EBX
0078824e : POP EBP
0078824f : RET 0x14
00788252 : CMP EDI,0x4
00788255 : JNZ 0x007883b3
0078825b : MOV EDI,dword ptr [EAX + 0x8]
0078825e : MOV EAX,dword ptr [EAX + 0x18]
00788261 : LEA ESI,[ESI + ESI*0x2]
00788264 : LEA EDI,[EDI + ESI*0x4]
00788267 : CMP EAX,0x65
0078826a : JNZ 0x0078830e
00788270 : FLD float ptr [0x00cdf178]
00788276 : MOVSS XMM2,dword ptr [EBP + 0x14]
0078827b : MOVSS XMM3,dword ptr [EBP + 0x10]
00788280 : FLD1
00788282 : MOVSS XMM4,dword ptr [0x00cdf178]
0078828a : MOVSS XMM5,dword ptr [0x00cdf17c]
00788292 : LEA ECX,[ECX + EDX*0x2]
00788295 : XOR ESI,ESI
00788297 : MOVZX EAX,word ptr [ECX]
0078829a : LEA EAX,[EAX + EAX*0x2]
0078829d : MOVZX EDX,byte ptr [EDI + EAX*0x4 + 0x7]
007882a2 : LEA EAX,[EDI + EAX*0x4]
007882a5 : CVTSI2SS XMM0,EDX
007882a9 : MOVZX EDX,byte ptr [EAX + 0xb]
007882ad : MULSS XMM0,XMM4
007882b1 : CVTSI2SS XMM1,EDX
007882b5 : MOVSS dword ptr [EBP + 0x18],XMM0
007882ba : MULSS XMM1,XMM4
007882be : TEST BL,BL
007882c0 : JZ 0x007882e3
007882c2 : MOVZX EAX,byte ptr [EAX + 0x8]
007882c6 : MOV dword ptr [EBP + 0x14],EAX
007882c9 : FILD dword ptr [EBP + 0x14]
007882cc : FMUL ST2
007882ce : FLD ST1
007882d0 : FLD float ptr [EBP + 0x18]
007882d3 : FSUB ST1,ST0
007882d5 : FXCH ST2
007882d7 : FMULP
007882d9 : FADDP
007882db : FSTP float ptr [EBP + 0x18]
007882de : MOVSS XMM0,dword ptr [EBP + 0x18]
007882e3 : MULSS XMM0,XMM3
007882e7 : ADDSS XMM0,XMM2
007882eb : MULSS XMM0,XMM1
007882ef : COMISS XMM0,XMM5
007882f2 : JA 0x007883af
007882f8 : INC ESI
007882f9 : ADD ECX,0x2
007882fc : CMP ESI,0x3
007882ff : JL 0x00788297
00788301 : POP EDI
00788302 : FSTP ST1
00788304 : POP ESI
00788305 : FSTP ST0
00788307 : MOV AL,0x1
00788309 : POP EBX
0078830a : POP EBP
0078830b : RET 0x14
0078830e : CMP EAX,0x66
00788311 : JNZ 0x007883b3
00788317 : FLD float ptr [0x00cdf178]
0078831d : MOVSS XMM2,dword ptr [EBP + 0x14]
00788322 : MOVSS XMM3,dword ptr [EBP + 0x10]
00788327 : FLD1
00788329 : MOVSS XMM4,dword ptr [0x00cdf178]
00788331 : MOVSS XMM5,dword ptr [0x00cdf17c]
00788339 : LEA ECX,[ECX + EDX*0x4]
0078833c : XOR ESI,ESI
0078833e : MOV EAX,dword ptr [ECX]
00788340 : LEA EDX,[EAX + EAX*0x2]
00788343 : LEA EAX,[EDI + EDX*0x4]
00788346 : MOVZX EDX,byte ptr [EAX + 0x7]
0078834a : CVTSI2SS XMM0,EDX
0078834e : MOVZX EDX,byte ptr [EAX + 0xb]
00788352 : MULSS XMM0,XMM4
00788356 : CVTSI2SS XMM1,EDX
0078835a : MOVSS dword ptr [EBP + 0x18],XMM0
0078835f : MULSS XMM1,XMM4
00788363 : TEST BL,BL
00788365 : JZ 0x00788388
00788367 : MOVZX EAX,byte ptr [EAX + 0x8]
0078836b : MOV dword ptr [EBP + 0x14],EAX
0078836e : FILD dword ptr [EBP + 0x14]
00788371 : FMUL ST2
00788373 : FLD ST1
00788375 : FLD float ptr [EBP + 0x18]
00788378 : FSUB ST1,ST0
0078837a : FXCH ST2
0078837c : FMULP
0078837e : FADDP
00788380 : FSTP float ptr [EBP + 0x18]
00788383 : MOVSS XMM0,dword ptr [EBP + 0x18]
00788388 : MULSS XMM0,XMM3
0078838c : ADDSS XMM0,XMM2
00788390 : MULSS XMM0,XMM1
00788394 : COMISS XMM0,XMM5
00788397 : JA 0x007883af
00788399 : INC ESI
0078839a : ADD ECX,0x4
0078839d : CMP ESI,0x3
007883a0 : JL 0x0078833e
007883a2 : POP EDI
007883a3 : FSTP ST1
007883a5 : POP ESI
007883a6 : FSTP ST0
007883a8 : MOV AL,0x1
007883aa : POP EBX
007883ab : POP EBP
007883ac : RET 0x14
007883af : FSTP ST1
007883b1 : FSTP ST0
007883b3 : POP EDI
007883b4 : POP ESI
007883b5 : XOR AL,AL
007883b7 : POP EBX
007883b8 : POP EBP
007883b9 : RET 0x14
007883bc : POP ESI
007883bd : XOR AL,AL
007883bf : POP EBX
007883c0 : POP EBP
007883c1 : RET 0x14

PROGRAM  : Maestia.exe
FUNCTION : FUN_005af3e0
ENTRY    : 005af3e0
BODY     : [[005af3e0, 005af50e]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005af3e0(undefined4 *param_1)

{
  byte bVar1;
  int iVar2;
  char *pcVar3;
  undefined4 *puVar4;
  int *piVar5;
  int in_ECX;
  char *pcVar6;
  char *local_14;
  uint local_10;
  int local_c;
  char **local_8;
  int *local_4;
  
  local_10 = 0;
  local_14 = (char *)*param_1;
  if (param_1[1] != 0) {
    do {
      if ((local_14[local_10] == '\0') || (local_14[local_10] == ':')) break;
      local_10 = local_10 + 1;
    } while (local_10 < (uint)param_1[1]);
  }
  if ((local_14 != (char *)0x0) && (local_10 != 0)) {
    if ((*local_14 == 's') && (local_14[1] == 'w')) {
      puVar4 = (undefined4 *)FUN_005ad8f0(&local_c,0x3a);
      bVar1 = *(byte *)(in_ECX + 0xc);
      *(undefined4 *)(in_ECX + 0x10) = *puVar4;
      iVar2 = puVar4[1];
      *(int *)(in_ECX + 0x14) = iVar2;
      if ((bVar1 & 1) == 0) {
        FUN_005adf30(iVar2 + 1);
        puVar4 = (undefined4 *)FUN_005ad8f0(&local_c,0x3a);
        *(undefined4 *)(in_ECX + 0x10) = *puVar4;
        *(undefined4 *)(in_ECX + 0x14) = puVar4[1];
      }
      *(byte *)(in_ECX + 0xc) = bVar1 | 2;
      return;
    }
    local_c = *(int *)(in_ECX + 4);
    if (*(int *)(local_c + 0x14) != 0) {
      local_8 = &local_14;
      local_4 = &local_c;
      piVar5 = (int *)(**(code **)(**(int **)(local_c + 0x14) + 4))(&local_c);
      if (piVar5 != (int *)0x0) {
        pcVar3 = (char *)param_1[1];
        pcVar6 = local_14 + 1;
        if (pcVar3 < local_14 + 1) {
          pcVar6 = pcVar3;
        }
        if (pcVar3 != pcVar6) {
          (**(code **)(*piVar5 + 8))(&stack0xffffffe0);
        }
        FUN_005ae8a0(in_ECX,piVar5,1);
      }
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005af3e0 : SUB ESP,0x1c
005af3e3 : PUSH EBX
005af3e4 : MOV EBX,dword ptr [ESP + 0x24]
005af3e8 : MOV EAX,dword ptr [EBX + 0x4]
005af3eb : PUSH ESI
005af3ec : MOV ESI,ECX
005af3ee : XOR ECX,ECX
005af3f0 : PUSH EDI
005af3f1 : MOV EDI,dword ptr [EBX]
005af3f3 : TEST EAX,EAX
005af3f5 : JBE 0x005af408
005af3f7 : MOV DL,byte ptr [EDI + ECX*0x1]
005af3fa : TEST DL,DL
005af3fc : JZ 0x005af408
005af3fe : CMP DL,0x3a
005af401 : JZ 0x005af408
005af403 : INC ECX
005af404 : CMP ECX,EAX
005af406 : JC 0x005af3f7
005af408 : MOV EDX,EDI
005af40a : MOV dword ptr [ESP + 0x14],EDX
005af40e : MOV dword ptr [ESP + 0x18],ECX
005af412 : TEST EDX,EDX
005af414 : JZ 0x005af506
005af41a : TEST ECX,ECX
005af41c : JZ 0x005af506
005af422 : CMP byte ptr [EDX],0x73
005af425 : JNZ 0x005af49a
005af427 : CMP byte ptr [EDX + 0x1],0x77
005af42b : JNZ 0x005af49a
005af42d : INC ECX
005af42e : CMP EAX,ECX
005af430 : JNC 0x005af434
005af432 : MOV ECX,EAX
005af434 : SUB EAX,ECX
005af436 : MOV dword ptr [ESP + 0x10],EAX
005af43a : ADD EDI,ECX
005af43c : PUSH 0x3a
005af43e : LEA EAX,[ESP + 0x20]
005af442 : PUSH EAX
005af443 : LEA ECX,[ESP + 0x14]
005af447 : MOV dword ptr [ESP + 0x14],EDI
005af44b : CALL 0x005ad8f0
005af450 : MOV ECX,dword ptr [EAX]
005af452 : MOV BL,byte ptr [ESI + 0xc]
005af455 : MOV dword ptr [ESI + 0x10],ECX
005af458 : MOV EDX,dword ptr [EAX + 0x4]
005af45b : MOV dword ptr [ESI + 0x14],EDX
005af45e : TEST BL,0x1
005af461 : JNZ 0x005af48b
005af463 : MOV EAX,EDX
005af465 : INC EAX
005af466 : PUSH EAX
005af467 : LEA ECX,[ESP + 0x10]
005af46b : CALL 0x005adf30
005af470 : PUSH 0x3a
005af472 : LEA ECX,[ESP + 0x20]
005af476 : PUSH ECX
005af477 : LEA ECX,[ESP + 0x14]
005af47b : CALL 0x005ad8f0
005af480 : MOV EDX,dword ptr [EAX]
005af482 : MOV dword ptr [ESI + 0x10],EDX
005af485 : MOV EAX,dword ptr [EAX + 0x4]
005af488 : MOV dword ptr [ESI + 0x14],EAX
005af48b : OR BL,0x2
005af48e : POP EDI
005af48f : MOV byte ptr [ESI + 0xc],BL
005af492 : POP ESI
005af493 : POP EBX
005af494 : ADD ESP,0x1c
005af497 : RET 0x4
005af49a : MOV EAX,dword ptr [ESI + 0x4]
005af49d : CMP dword ptr [EAX + 0x14],0x0
005af4a1 : JZ 0x005af506
005af4a3 : LEA ECX,[ESP + 0x14]
005af4a7 : MOV dword ptr [ESP + 0x20],ECX
005af4ab : LEA EDX,[ESP + 0x1c]
005af4af : MOV dword ptr [ESP + 0x24],EDX
005af4b3 : MOV dword ptr [ESP + 0x1c],EAX
005af4b7 : MOV EAX,dword ptr [EAX + 0x14]
005af4ba : MOV EDX,dword ptr [EAX]
005af4bc : MOV EDX,dword ptr [EDX + 0x4]
005af4bf : LEA ECX,[ESP + 0x1c]
005af4c3 : PUSH ECX
005af4c4 : MOV ECX,EAX
005af4c6 : CALL EDX
005af4c8 : MOV EDI,EAX
005af4ca : TEST EDI,EDI
005af4cc : JZ 0x005af506
005af4ce : MOV ECX,dword ptr [ESP + 0x18]
005af4d2 : MOV EAX,dword ptr [EBX + 0x4]
005af4d5 : INC ECX
005af4d6 : CMP EAX,ECX
005af4d8 : JNC 0x005af4dc
005af4da : MOV ECX,EAX
005af4dc : MOV EDX,dword ptr [EBX]
005af4de : ADD EDX,ECX
005af4e0 : SUB EAX,ECX
005af4e2 : MOV dword ptr [ESP + 0xc],EDX
005af4e6 : MOV dword ptr [ESP + 0x10],EAX
005af4ea : JZ 0x005af4fa
005af4ec : MOV EAX,dword ptr [EDI]
005af4ee : MOV EDX,dword ptr [EAX + 0x8]
005af4f1 : LEA ECX,[ESP + 0xc]
005af4f5 : PUSH ECX
005af4f6 : MOV ECX,EDI
005af4f8 : CALL EDX
005af4fa : MOV ECX,dword ptr [ESI + 0x4]
005af4fd : PUSH 0x1
005af4ff : PUSH EDI
005af500 : PUSH ESI
005af501 : CALL 0x005ae8a0
005af506 : POP EDI
005af507 : POP ESI
005af508 : POP EBX
005af509 : ADD ESP,0x1c
005af50c : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_005240f0
ENTRY    : 005240f0
BODY     : [[005240f0, 00524234]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005240f0(undefined4 param_1,uint param_2)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  int iVar4;
  undefined4 uVar5;
  int *in_ECX;
  int iVar6;
  int iVar7;
  float10 fVar8;
  longlong local_c;
  int *local_4;
  
  iVar6 = 0;
  if (param_2 == 0) {
    FUN_005de660();
    return;
  }
  local_4 = in_ECX;
  if (param_2 < 8) {
    iVar7 = 8;
  }
  else {
    fVar8 = (float10)FUN_0063b270();
    local_c = (longlong)ROUND((float)fVar8 / 0.6931472 + 1.0);
    iVar7 = 1 << ((byte)local_c & 0x1f);
  }
  local_c = CONCAT44(local_c._4_4_,2);
  puVar3 = (undefined4 *)FUN_00515840(iVar7 * 0x10 + 8,&local_c);
  *puVar3 = 0;
  puVar3[1] = iVar7 + -1;
  if (iVar7 != 0) {
    iVar4 = 0;
    do {
      *(undefined4 *)(iVar4 + 8 + (int)puVar3) = 0xfffffffe;
      iVar4 = iVar4 + 0x10;
      iVar7 = iVar7 + -1;
    } while (iVar7 != 0);
  }
  if (*in_ECX != 0) {
    iVar7 = *(int *)(*in_ECX + 4) + 1;
    do {
      puVar2 = (undefined4 *)(iVar6 + 8 + *in_ECX);
      if (*(int *)(iVar6 + 8 + *in_ECX) != -2) {
        puVar1 = puVar2 + 2;
        uVar5 = FUN_00523940(puVar1);
        FUN_00523b90(param_1,puVar1,uVar5);
        *puVar2 = 0xfffffffe;
        in_ECX = local_4;
      }
      iVar6 = iVar6 + 0x10;
      iVar7 = iVar7 + -1;
    } while (iVar7 != 0);
    FUN_00515cf0(*in_ECX);
  }
  *in_ECX = (int)puVar3;
  return;
}



============================================================
DISASSEMBLY
============================================================
005240f0 : SUB ESP,0xc
005240f3 : MOV EAX,dword ptr [ESP + 0x14]
005240f7 : PUSH EBX
005240f8 : PUSH EDI
005240f9 : XOR EBX,EBX
005240fb : MOV EDI,ECX
005240fd : MOV dword ptr [ESP + 0x10],EDI
00524101 : CMP EAX,EBX
00524103 : JNZ 0x00524112
00524105 : CALL 0x005de660
0052410a : POP EDI
0052410b : POP EBX
0052410c : ADD ESP,0xc
0052410f : RET 0x8
00524112 : PUSH ESI
00524113 : CMP EAX,0x8
00524116 : JNC 0x0052411f
00524118 : MOV ESI,0x8
0052411d : JMP 0x00524184
0052411f : DEC EAX
00524120 : MOV dword ptr [ESP + 0x20],EAX
00524124 : FILD dword ptr [ESP + 0x20]
00524128 : TEST EAX,EAX
0052412a : JGE 0x00524132
0052412c : FADD float ptr [0x00cdf0e0]
00524132 : CALL 0x0063b270
00524137 : FSTP float ptr [ESP + 0x20]
0052413b : FLD float ptr [ESP + 0x20]
0052413f : MOV ESI,0x1
00524144 : FDIV double ptr [0x00b85fe0]
0052414a : FSTP float ptr [ESP + 0x20]
0052414e : FLD float ptr [ESP + 0x20]
00524152 : FADD double ptr [0x00cdf108]
00524158 : FSTP float ptr [ESP + 0x20]
0052415c : FLD float ptr [ESP + 0x20]
00524160 : FNSTCW word ptr [ESP + 0x20]
00524164 : MOVZX EAX,word ptr [ESP + 0x20]
00524169 : OR EAX,0xc00
0052416e : MOV dword ptr [ESP + 0xc],EAX
00524172 : FLDCW word ptr [ESP + 0xc]
00524176 : FISTP qword ptr [ESP + 0xc]
0052417a : MOV CL,byte ptr [ESP + 0xc]
0052417e : SHL ESI,CL
00524180 : FLDCW word ptr [ESP + 0x20]
00524184 : MOV ECX,ESI
00524186 : SHL ECX,0x4
00524189 : LEA EAX,[ESP + 0xc]
0052418d : ADD ECX,0x8
00524190 : PUSH EAX
00524191 : PUSH ECX
00524192 : MOV ECX,dword ptr [0x00d73250]
00524198 : MOV dword ptr [ESP + 0x28],EBX
0052419c : MOV dword ptr [ESP + 0x14],0x2
005241a4 : CALL 0x00515840
005241a9 : MOV dword ptr [ESP + 0x20],EAX
005241ad : MOV dword ptr [EAX],EBX
005241af : MOV EAX,dword ptr [ESP + 0x20]
005241b3 : LEA EDX,[ESI + -0x1]
005241b6 : MOV dword ptr [EAX + 0x4],EDX
005241b9 : CMP ESI,EBX
005241bb : JBE 0x005241d4
005241bd : XOR EAX,EAX
005241bf : NOP
005241c0 : MOV ECX,dword ptr [ESP + 0x20]
005241c4 : MOV dword ptr [EAX + ECX*0x1 + 0x8],0xfffffffe
005241cc : ADD EAX,0x10
005241cf : SUB ESI,0x1
005241d2 : JNZ 0x005241c0
005241d4 : MOV EAX,dword ptr [EDI]
005241d6 : CMP EAX,EBX
005241d8 : JZ 0x00524226
005241da : MOV EAX,dword ptr [EAX + 0x4]
005241dd : PUSH EBP
005241de : LEA EBP,[EAX + 0x1]
005241e1 : MOV EDX,dword ptr [EDI]
005241e3 : CMP dword ptr [EBX + EDX*0x1 + 0x8],-0x2
005241e8 : LEA ESI,[EBX + EDX*0x1 + 0x8]
005241ec : JZ 0x00524215
005241ee : LEA EDI,[ESI + 0x8]
005241f1 : PUSH EDI
005241f2 : LEA ECX,[ESP + 0x28]
005241f6 : CALL 0x00523940
005241fb : PUSH EAX
005241fc : MOV EAX,dword ptr [ESP + 0x24]
00524200 : PUSH EDI
00524201 : PUSH EAX
00524202 : LEA ECX,[ESP + 0x30]
00524206 : CALL 0x00523b90
0052420b : MOV EDI,dword ptr [ESP + 0x18]
0052420f : MOV dword ptr [ESI],0xfffffffe
00524215 : ADD EBX,0x10
00524218 : SUB EBP,0x1
0052421b : JNZ 0x005241e1
0052421d : MOV ECX,dword ptr [EDI]
0052421f : PUSH ECX
00524220 : CALL 0x00515cf0
00524225 : POP EBP
00524226 : MOV EDX,dword ptr [ESP + 0x20]
0052422a : POP ESI
0052422b : MOV dword ptr [EDI],EDX
0052422d : POP EDI
0052422e : POP EBX
0052422f : ADD ESP,0xc
00524232 : RET 0x8

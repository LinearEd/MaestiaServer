PROGRAM  : Maestia.exe
FUNCTION : FUN_005903e0
ENTRY    : 005903e0
BODY     : [[005903e0, 00590713]]

============================================================
DECOMPILED C CODE
============================================================

int * FUN_005903e0(GPoint<float> *param_1,undefined4 param_2,int *param_3)

{
  int iVar1;
  char cVar2;
  int *piVar3;
  GMatrix2D *pGVar4;
  int *piVar5;
  int *in_ECX;
  undefined4 unaff_ESI;
  GPoint<float> aGStack_5c [8];
  int iStack_54;
  int iStack_50;
  undefined4 uStack_4c;
  int iStack_48;
  int iStack_44;
  int iStack_40;
  int iStack_3c;
  int iStack_38;
  int iStack_34;
  GMatrix2D aGStack_30 [24];
  undefined1 auStack_18 [24];
  
  if (((((uint)in_ECX[0x23] >> 0xb & 1) != 0) ||
      (((cVar2 = (**(code **)(*in_ECX + 8))(), cVar2 == '\0' && (in_ECX[0x6f] == 0)) ||
       (cVar2 = (**(code **)(*in_ECX + 0xa0))(), cVar2 != '\0')))) || (param_3 == in_ECX)) {
    return (int *)0x0;
  }
  iStack_48 = in_ECX[0x11];
  iStack_44 = in_ECX[0x12];
  iStack_40 = in_ECX[0x13];
  iStack_3c = in_ECX[0x14];
  iStack_38 = in_ECX[0x15];
  iStack_34 = in_ECX[0x16];
  GMatrix2D::TransformByInverse((GMatrix2D *)&iStack_48,aGStack_5c,param_1);
  iVar1 = in_ECX[0x2b];
  piVar3 = (int *)FUN_0058a0c0();
  if (((piVar3 != (int *)0x0) && (cVar2 = (**(code **)(*piVar3 + 0xa0))(), cVar2 != '\0')) &&
     ((*(byte *)((int)piVar3 + 0x66) & 0x10) == 0)) {
    GMatrix2D::SetIdentity(aGStack_30);
    pGVar4 = (GMatrix2D *)FUN_0050aa60(auStack_18);
    GMatrix2D::SetInverse(aGStack_30,pGVar4);
    pGVar4 = (GMatrix2D *)FUN_0050aa60(auStack_18);
    GMatrix2D::Prepend(aGStack_30,pGVar4);
    GMatrix2D::Transform(aGStack_30,(GPoint<float> *)&iStack_54,aGStack_5c);
    cVar2 = (**(code **)(*piVar3 + 0x30))(&iStack_54,1);
    if (cVar2 == '\0') {
      return (int *)0x0;
    }
  }
  iStack_54 = 0;
  iStack_50 = 0;
  uStack_4c = 0;
  FUN_005902d0(&iStack_54,aGStack_5c,1);
joined_r0x0059051c:
  do {
    do {
      iVar1 = iVar1 + -1;
      if (iVar1 < 0) {
        if (((((in_ECX[0x6c] == 0) || (-1 < in_ECX[0x68])) || (((uint)in_ECX[0x23] >> 4 & 1) == 0))
            || ((in_ECX[0x6a] == 0 && (in_ECX[0x1b] == 0)))) ||
           ((cVar2 = FUN_0058c2d0(), cVar2 == '\0' ||
            (cVar2 = FUN_005d7890(aGStack_5c,1), cVar2 == '\0')))) {
LAB_005906ff:
          FUN_00515cf0(iStack_54);
          return (int *)0x0;
        }
        goto LAB_0059064b;
      }
      piVar3 = *(int **)(in_ECX[0x2a] + iVar1 * 4);
    } while (((iStack_50 != 0) &&
             ((*(char *)(iStack_54 + iVar1) == '\0' || ((short)piVar3[0x19] != 0)))) ||
            ((*(byte *)((int)piVar3 + 0x66) & 2) != 0));
    piVar3 = (int *)(**(code **)(*piVar3 + 0x34))(aGStack_5c,param_2,param_3);
    if ((piVar3 != (int *)0x0) && ((char)param_2 != '\0')) {
      FUN_00515cf0(iStack_54);
      return piVar3;
    }
    cVar2 = FUN_0058cd00();
    if ((cVar2 == '\0') && ((in_ECX[0x6f] == 0 || (cVar2 = FUN_0058cd00(), cVar2 == '\0')))) {
      if ((piVar3 != (int *)0x0) && (piVar3 != in_ECX)) {
        if (((int *)piVar3[8] != (int *)0x0) &&
           (cVar2 = (**(code **)(*(int *)piVar3[8] + 8))(), cVar2 != '\0')) {
          FUN_00515cf0(iStack_54);
          return piVar3;
        }
        goto LAB_005906ff;
      }
      goto joined_r0x0059051c;
    }
    if (piVar3 != (int *)0x0) {
      if ((in_ECX[0x6f] != 0) && (cVar2 = FUN_0058cd00(), cVar2 != '\0')) {
        piVar3 = (int *)in_ECX[0x6f];
        FUN_00515cf0(iStack_54);
        return piVar3;
      }
      piVar5 = (int *)FUN_0058c0a0();
      piVar3 = piVar5;
      if (piVar5 != (int *)0x0) {
        do {
          piVar3 = (int *)piVar3[8];
          if (piVar3 == (int *)0x0) {
            FUN_00515cf0(iStack_54);
            return (int *)0x0;
          }
        } while (piVar3 != in_ECX);
        piVar3 = (int *)(**(code **)(*piVar5 + 0x34))(aGStack_5c,param_2,param_3);
        FUN_00515cf0(unaff_ESI);
        return piVar3;
      }
LAB_0059064b:
      FUN_00515cf0(iStack_54);
      return in_ECX;
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
005903e0 : SUB ESP,0x5c
005903e3 : PUSH ESI
005903e4 : MOV ESI,ECX
005903e6 : MOV EAX,dword ptr [ESI + 0x8c]
005903ec : SHR EAX,0xb
005903ef : TEST AL,0x1
005903f1 : JNZ 0x0059041d
005903f3 : MOV EDX,dword ptr [ESI]
005903f5 : MOV EAX,dword ptr [EDX + 0x8]
005903f8 : CALL EAX
005903fa : TEST AL,AL
005903fc : JNZ 0x00590407
005903fe : CMP dword ptr [ESI + 0x1bc],0x0
00590405 : JZ 0x0059041d
00590407 : MOV EDX,dword ptr [ESI]
00590409 : MOV EAX,dword ptr [EDX + 0xa0]
0059040f : MOV ECX,ESI
00590411 : CALL EAX
00590413 : TEST AL,AL
00590415 : JNZ 0x0059041d
00590417 : CMP dword ptr [ESP + 0x6c],ESI
0059041b : JNZ 0x00590426
0059041d : XOR EAX,EAX
0059041f : POP ESI
00590420 : ADD ESP,0x5c
00590423 : RET 0xc
00590426 : FLD float ptr [ESI + 0x44]
00590429 : MOV ECX,dword ptr [ESP + 0x64]
0059042d : FSTP float ptr [ESP + 0x18]
00590431 : PUSH EBP
00590432 : FLD float ptr [ESI + 0x48]
00590435 : PUSH EDI
00590436 : FSTP float ptr [ESP + 0x24]
0059043a : PUSH ECX
0059043b : FLD float ptr [ESI + 0x4c]
0059043e : LEA EDX,[ESP + 0x10]
00590442 : FSTP float ptr [ESP + 0x2c]
00590446 : PUSH EDX
00590447 : FLD float ptr [ESI + 0x50]
0059044a : LEA ECX,[ESP + 0x28]
0059044e : FSTP float ptr [ESP + 0x34]
00590452 : FLD float ptr [ESI + 0x54]
00590455 : FSTP float ptr [ESP + 0x38]
00590459 : FLD float ptr [ESI + 0x58]
0059045c : FSTP float ptr [ESP + 0x3c]
00590460 : CALL 0x00522fa0
00590465 : MOV EBP,dword ptr [ESI + 0xac]
0059046b : MOV ECX,ESI
0059046d : CALL 0x0058a0c0
00590472 : MOV EDI,EAX
00590474 : TEST EDI,EDI
00590476 : JZ 0x005904ee
00590478 : MOV EAX,dword ptr [EDI]
0059047a : MOV EDX,dword ptr [EAX + 0xa0]
00590480 : MOV ECX,EDI
00590482 : CALL EDX
00590484 : TEST AL,AL
00590486 : JZ 0x005904ee
00590488 : TEST byte ptr [EDI + 0x66],0x10
0059048c : JNZ 0x005904ee
0059048e : LEA ECX,[ESP + 0x38]
00590492 : CALL 0x00522b80
00590497 : LEA EAX,[ESP + 0x50]
0059049b : PUSH EAX
0059049c : MOV ECX,EDI
0059049e : CALL 0x0050aa60
005904a3 : PUSH EAX
005904a4 : LEA ECX,[ESP + 0x3c]
005904a8 : CALL 0x00522cb0
005904ad : LEA ECX,[ESP + 0x50]
005904b1 : PUSH ECX
005904b2 : MOV ECX,ESI
005904b4 : CALL 0x0050aa60
005904b9 : PUSH EAX
005904ba : LEA ECX,[ESP + 0x3c]
005904be : CALL 0x00522e20
005904c3 : LEA EDX,[ESP + 0xc]
005904c7 : PUSH EDX
005904c8 : LEA EAX,[ESP + 0x18]
005904cc : PUSH EAX
005904cd : LEA ECX,[ESP + 0x40]
005904d1 : CALL 0x00522c50
005904d6 : MOV EDX,dword ptr [EDI]
005904d8 : MOV EDX,dword ptr [EDX + 0x30]
005904db : PUSH 0x1
005904dd : LEA EAX,[ESP + 0x18]
005904e1 : PUSH EAX
005904e2 : MOV ECX,EDI
005904e4 : CALL EDX
005904e6 : TEST AL,AL
005904e8 : JZ 0x00590709
005904ee : PUSH 0x1
005904f0 : LEA EAX,[ESP + 0x10]
005904f4 : PUSH EAX
005904f5 : LEA ECX,[ESP + 0x1c]
005904f9 : PUSH ECX
005904fa : MOV ECX,ESI
005904fc : MOV dword ptr [ESP + 0x20],0x0
00590504 : MOV dword ptr [ESP + 0x24],0x0
0059050c : MOV dword ptr [ESP + 0x28],0x0
00590514 : CALL 0x005902d0
00590519 : ADD EBP,-0x1
0059051c : JS 0x005905e2
00590522 : CMP dword ptr [ESP + 0x18],0x0
00590527 : MOV EDX,dword ptr [ESI + 0xa8]
0059052d : MOV ECX,dword ptr [EDX + EBP*0x4]
00590530 : JZ 0x0059054b
00590532 : MOV EAX,dword ptr [ESP + 0x14]
00590536 : CMP byte ptr [EAX + EBP*0x1],0x0
0059053a : JZ 0x005905d9
00590540 : CMP word ptr [ECX + 0x64],0x0
00590545 : JA 0x005905d9
0059054b : TEST byte ptr [ECX + 0x66],0x2
0059054f : JNZ 0x005905d9
00590555 : MOV EAX,dword ptr [ESP + 0x74]
00590559 : MOV EDX,dword ptr [ECX]
0059055b : MOV EDX,dword ptr [EDX + 0x34]
0059055e : PUSH EAX
0059055f : MOV EAX,dword ptr [ESP + 0x74]
00590563 : PUSH EAX
00590564 : LEA EAX,[ESP + 0x14]
00590568 : PUSH EAX
00590569 : CALL EDX
0059056b : MOV EDI,EAX
0059056d : TEST EDI,EDI
0059056f : JZ 0x0059057c
00590571 : CMP byte ptr [ESP + 0x70],0x0
00590576 : JNZ 0x00590660
0059057c : MOV ECX,ESI
0059057e : CALL 0x0058cd00
00590583 : TEST AL,AL
00590585 : JNZ 0x005905d1
00590587 : MOV ECX,dword ptr [ESI + 0x1bc]
0059058d : TEST ECX,ECX
0059058f : JZ 0x0059059a
00590591 : CALL 0x0058cd00
00590596 : TEST AL,AL
00590598 : JNZ 0x005905d1
0059059a : TEST EDI,EDI
0059059c : JZ 0x005905d9
0059059e : CMP EDI,ESI
005905a0 : JZ 0x005905d9
005905a2 : MOV ECX,dword ptr [EDI + 0x20]
005905a5 : TEST ECX,ECX
005905a7 : JZ 0x005906ff
005905ad : MOV EDX,dword ptr [ECX]
005905af : MOV EAX,dword ptr [EDX + 0x8]
005905b2 : CALL EAX
005905b4 : TEST AL,AL
005905b6 : JZ 0x005906ff
005905bc : MOV ECX,dword ptr [ESP + 0x14]
005905c0 : PUSH ECX
005905c1 : CALL 0x00515cf0
005905c6 : MOV EAX,EDI
005905c8 : POP EDI
005905c9 : POP EBP
005905ca : POP ESI
005905cb : ADD ESP,0x5c
005905ce : RET 0xc
005905d1 : TEST EDI,EDI
005905d3 : JNZ 0x00590675
005905d9 : SUB EBP,0x1
005905dc : JNS 0x00590522
005905e2 : CMP dword ptr [ESI + 0x1b0],0x0
005905e9 : JZ 0x005906ff
005905ef : CMP dword ptr [ESI + 0x1a0],0x0
005905f6 : JGE 0x005906ff
005905fc : MOV EDX,dword ptr [ESI + 0x8c]
00590602 : SHR EDX,0x4
00590605 : TEST DL,0x1
00590608 : JZ 0x005906ff
0059060e : MOV ECX,dword ptr [ESI + 0x1a8]
00590614 : TEST ECX,ECX
00590616 : JNZ 0x00590623
00590618 : MOV ECX,dword ptr [ESI + 0x6c]
0059061b : TEST ECX,ECX
0059061d : JZ 0x005906ff
00590623 : CALL 0x0058c2d0
00590628 : TEST AL,AL
0059062a : JZ 0x005906ff
00590630 : MOV ECX,dword ptr [ESI + 0x1b0]
00590636 : PUSH ESI
00590637 : PUSH 0x1
00590639 : LEA EAX,[ESP + 0x14]
0059063d : PUSH EAX
0059063e : CALL 0x005d7890
00590643 : TEST AL,AL
00590645 : JZ 0x005906ff
0059064b : MOV ECX,dword ptr [ESP + 0x14]
0059064f : PUSH ECX
00590650 : CALL 0x00515cf0
00590655 : POP EDI
00590656 : POP EBP
00590657 : MOV EAX,ESI
00590659 : POP ESI
0059065a : ADD ESP,0x5c
0059065d : RET 0xc
00590660 : MOV EAX,dword ptr [ESP + 0x14]
00590664 : PUSH EAX
00590665 : CALL 0x00515cf0
0059066a : MOV EAX,EDI
0059066c : POP EDI
0059066d : POP EBP
0059066e : POP ESI
0059066f : ADD ESP,0x5c
00590672 : RET 0xc
00590675 : MOV ECX,dword ptr [ESI + 0x1bc]
0059067b : TEST ECX,ECX
0059067d : JZ 0x005906a3
0059067f : CALL 0x0058cd00
00590684 : TEST AL,AL
00590686 : JZ 0x005906a3
00590688 : MOV EAX,dword ptr [ESP + 0x14]
0059068c : MOV ESI,dword ptr [ESI + 0x1bc]
00590692 : PUSH EAX
00590693 : CALL 0x00515cf0
00590698 : POP EDI
00590699 : POP EBP
0059069a : MOV EAX,ESI
0059069c : POP ESI
0059069d : ADD ESP,0x5c
005906a0 : RET 0xc
005906a3 : MOV ECX,ESI
005906a5 : CALL 0x0058c0a0
005906aa : TEST EAX,EAX
005906ac : JZ 0x0059064b
005906ae : MOV EDX,EAX
005906b0 : MOV EDX,dword ptr [EDX + 0x20]
005906b3 : TEST EDX,EDX
005906b5 : JZ 0x005906ea
005906b7 : CMP EDX,ESI
005906b9 : JNZ 0x005906b0
005906bb : MOV ECX,dword ptr [ESP + 0x74]
005906bf : MOV EDX,dword ptr [EAX]
005906c1 : MOV EDX,dword ptr [EDX + 0x34]
005906c4 : PUSH ECX
005906c5 : MOV ECX,dword ptr [ESP + 0x74]
005906c9 : PUSH ECX
005906ca : LEA ECX,[ESP + 0x14]
005906ce : PUSH ECX
005906cf : MOV ECX,EAX
005906d1 : CALL EDX
005906d3 : MOV ESI,EAX
005906d5 : MOV EAX,dword ptr [ESP + 0x14]
005906d9 : PUSH EAX
005906da : CALL 0x00515cf0
005906df : POP EDI
005906e0 : POP EBP
005906e1 : MOV EAX,ESI
005906e3 : POP ESI
005906e4 : ADD ESP,0x5c
005906e7 : RET 0xc
005906ea : MOV ECX,dword ptr [ESP + 0x14]
005906ee : PUSH ECX
005906ef : CALL 0x00515cf0
005906f4 : POP EDI
005906f5 : POP EBP
005906f6 : XOR EAX,EAX
005906f8 : POP ESI
005906f9 : ADD ESP,0x5c
005906fc : RET 0xc
005906ff : MOV EDX,dword ptr [ESP + 0x14]
00590703 : PUSH EDX
00590704 : CALL 0x00515cf0
00590709 : POP EDI
0059070a : POP EBP
0059070b : XOR EAX,EAX
0059070d : POP ESI
0059070e : ADD ESP,0x5c
00590711 : RET 0xc

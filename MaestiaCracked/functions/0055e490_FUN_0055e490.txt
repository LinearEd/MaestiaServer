PROGRAM  : Maestia.exe
FUNCTION : FUN_0055e490
ENTRY    : 0055e490
BODY     : [[0055e490, 0055e4eb]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0055e490(char *param_1,undefined4 param_2,char param_3,undefined4 param_4)

{
  int iVar1;
  int iVar2;
  uint _MaxCount;
  char *pcVar3;
  undefined1 local_8c [4];
  undefined4 local_88;
  char acStack_84 [128];
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)local_8c;
  local_88 = param_4;
  if (param_3 == '\0') {
    FUN_0055e1e0(param_1,param_2,param_4);
    __security_check_cookie(local_4 ^ (uint)local_8c);
    return;
  }
  do {
    iVar1 = FUN_00638800(param_1,0x2c);
    pcVar3 = param_1;
    if (iVar1 == 0) {
LAB_0055e52d:
      iVar2 = FUN_0055e1e0(param_1,param_2,local_88);
      if (iVar2 != 0) break;
    }
    else {
      _MaxCount = iVar1 - (int)param_1;
      if (_MaxCount < 0x80) {
        _strncpy_s(acStack_84,0x7f,param_1,_MaxCount);
        acStack_84[_MaxCount] = '\0';
        pcVar3 = param_1 + _MaxCount + 1;
        param_1 = acStack_84;
        goto LAB_0055e52d;
      }
    }
    param_1 = pcVar3;
  } while (iVar1 != 0);
  __security_check_cookie(local_4 ^ (uint)local_8c);
  return;
}



============================================================
DISASSEMBLY
============================================================
0055e490 : SUB ESP,0x8c
0055e496 : MOV EAX,[0x00d66fa0]
0055e49b : XOR EAX,ESP
0055e49d : MOV dword ptr [ESP + 0x88],EAX
0055e4a4 : CMP byte ptr [ESP + 0x98],0x0
0055e4ac : MOV EAX,dword ptr [ESP + 0x9c]
0055e4b3 : PUSH EDI
0055e4b4 : MOV EDI,dword ptr [ESP + 0x94]
0055e4bb : MOV dword ptr [ESP + 0x4],ECX
0055e4bf : MOV dword ptr [ESP + 0x8],EAX
0055e4c3 : JNZ 0x0055e4ec
0055e4c5 : PUSH EAX
0055e4c6 : MOV EAX,dword ptr [ESP + 0x9c]
0055e4cd : PUSH EAX
0055e4ce : PUSH EDI
0055e4cf : CALL 0x0055e1e0
0055e4d4 : POP EDI
0055e4d5 : MOV ECX,dword ptr [ESP + 0x88]
0055e4dc : XOR ECX,ESP
0055e4de : CALL 0x00633e6b
0055e4e3 : ADD ESP,0x8c
0055e4e9 : RET 0x10

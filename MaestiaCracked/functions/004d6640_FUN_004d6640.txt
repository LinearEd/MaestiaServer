PROGRAM  : Maestia.exe
FUNCTION : FUN_004d6640
ENTRY    : 004d6640
BODY     : [[004d6640, 004d6706]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_004d6640(wchar_t *param_1)

{
  wchar_t wVar1;
  wchar_t *pwVar2;
  _SYSTEMTIME local_2214;
  wchar_t local_2204;
  undefined1 local_2202 [510];
  wchar_t local_2004 [4096];
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)&local_2214;
  GetLocalTime(&local_2214);
  FUN_0040e4a0(L"[%02d.%02d.%02d:%03d] ",local_2214.wHour,local_2214.wMinute,local_2214.wSecond,
               local_2214.wMilliseconds);
  _wcscpy_s(local_2004,0x1000,&local_2204);
  pwVar2 = &local_2204;
  do {
    wVar1 = *pwVar2;
    pwVar2 = pwVar2 + 1;
  } while (wVar1 != L'\0');
  _vswprintf_s(local_2004 + ((int)pwVar2 - (int)local_2202 >> 1),0x100,param_1,&stack0x00000008);
  OutputDebugStringW(local_2004);
  __security_check_cookie(local_4 ^ (uint)&local_2214);
  return;
}



============================================================
DISASSEMBLY
============================================================
004d6640 : MOV EAX,0x2214
004d6645 : CALL 0x0063b780
004d664a : MOV EAX,[0x00d66fa0]
004d664f : XOR EAX,ESP
004d6651 : MOV dword ptr [ESP + 0x2210],EAX
004d6658 : LEA EAX,[ESP]
004d665b : PUSH EAX
004d665c : CALL dword ptr [0x00b85154]
004d6662 : MOVZX ECX,word ptr [ESP + 0xe]
004d6667 : MOVZX EDX,word ptr [ESP + 0xc]
004d666c : MOVZX EAX,word ptr [ESP + 0xa]
004d6671 : PUSH ECX
004d6672 : MOVZX ECX,word ptr [ESP + 0xc]
004d6677 : PUSH EDX
004d6678 : PUSH EAX
004d6679 : PUSH ECX
004d667a : PUSH 0xcda884
004d667f : LEA EDX,[ESP + 0x24]
004d6683 : CALL 0x0040e4a0
004d6688 : LEA EDX,[ESP + 0x24]
004d668c : PUSH EDX
004d668d : LEA EAX,[ESP + 0x228]
004d6694 : PUSH 0x1000
004d6699 : PUSH EAX
004d669a : CALL 0x0063481b
004d669f : LEA EAX,[ESP + 0x30]
004d66a3 : ADD ESP,0x20
004d66a6 : LEA EDX,[EAX + 0x2]
004d66a9 : LEA ESP,[ESP]
004d66b0 : MOV CX,word ptr [EAX]
004d66b3 : ADD EAX,0x2
004d66b6 : TEST CX,CX
004d66b9 : JNZ 0x004d66b0
004d66bb : SUB EAX,EDX
004d66bd : MOV EDX,dword ptr [ESP + 0x2218]
004d66c4 : LEA ECX,[ESP + 0x221c]
004d66cb : PUSH ECX
004d66cc : PUSH EDX
004d66cd : SAR EAX,0x1
004d66cf : LEA EAX,[ESP + EAX*0x2 + 0x218]
004d66d6 : PUSH 0x100
004d66db : PUSH EAX
004d66dc : CALL 0x00634648
004d66e1 : ADD ESP,0x10
004d66e4 : LEA ECX,[ESP + 0x210]
004d66eb : PUSH ECX
004d66ec : CALL dword ptr [0x00b8512c]
004d66f2 : MOV ECX,dword ptr [ESP + 0x2210]
004d66f9 : XOR ECX,ESP
004d66fb : CALL 0x00633e6b
004d6700 : ADD ESP,0x2214
004d6706 : RET

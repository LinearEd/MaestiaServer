PROGRAM  : Maestia.exe
FUNCTION : FUN_00461a00
ENTRY    : 00461a00
BODY     : [[00461a00, 00461a3b] [00461a40, 00461b55]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x00461a5c) */

void FUN_00461a00(int param_1,undefined4 *param_2,undefined4 *param_3)

{
  uint uVar1;
  int iVar2;
  ushort *puVar3;
  undefined4 *puVar4;
  int iVar5;
  ushort *puVar6;
  uint uVar7;
  undefined4 *puVar8;
  bool bVar9;
  
  iVar2 = (int)param_3;
  puVar4 = *(undefined4 **)(param_1 + 4);
  bVar9 = true;
  if (*(char *)((int)puVar4[1] + 0x45) == '\0') {
    uVar1 = *(uint *)((int)param_3 + 0x14);
    puVar8 = (undefined4 *)puVar4[1];
    do {
      puVar4 = puVar8;
      if ((uint)puVar4[9] < 8) {
        puVar3 = (ushort *)(puVar4 + 4);
      }
      else {
        puVar3 = (ushort *)puVar4[4];
      }
      uVar7 = puVar4[8];
      if (uVar1 < (uint)puVar4[8]) {
        uVar7 = uVar1;
      }
      if (*(uint *)((int)param_3 + 0x18) < 8) {
        puVar6 = (ushort *)((int)param_3 + 4);
      }
      else {
        puVar6 = *(ushort **)((int)param_3 + 4);
      }
      for (; uVar7 != 0; uVar7 = uVar7 - 1) {
        if (*puVar6 != *puVar3) {
          uVar7 = (-(uint)(*puVar6 < *puVar3) & 0xfffffffe) + 1;
          if (uVar7 != 0) goto LAB_00461ab7;
          break;
        }
        puVar6 = puVar6 + 1;
        puVar3 = puVar3 + 1;
      }
      if (uVar1 < (uint)puVar4[8]) {
        uVar7 = 0xffffffff;
      }
      else {
        uVar7 = (uint)(uVar1 != puVar4[8]);
      }
LAB_00461ab7:
      bVar9 = (int)uVar7 < 0;
      if (bVar9) {
        puVar8 = (undefined4 *)*puVar4;
      }
      else {
        puVar8 = (undefined4 *)puVar4[2];
      }
    } while (*(char *)((int)puVar8 + 0x45) == '\0');
  }
  param_3 = puVar4;
  if (bVar9) {
    if (puVar4 == (undefined4 *)**(int **)(param_1 + 4)) {
      bVar9 = true;
      goto LAB_00461af1;
    }
    FUN_00462360();
  }
  puVar4 = param_3;
  if (*(uint *)(iVar2 + 0x18) < 8) {
    iVar5 = iVar2 + 4;
  }
  else {
    iVar5 = *(int *)(iVar2 + 4);
  }
  iVar5 = FUN_00405bb0(iVar5);
  if (-1 < iVar5) {
    *param_2 = puVar4;
    *(undefined1 *)(param_2 + 1) = 0;
    return;
  }
LAB_00461af1:
  puVar4 = (undefined4 *)FUN_00461be0(&param_3,bVar9,iVar2);
  *param_2 = *puVar4;
  *(undefined1 *)(param_2 + 1) = 1;
  return;
}



============================================================
DISASSEMBLY
============================================================
00461a00 : PUSH EBP
00461a01 : MOV EBP,ESP
00461a03 : SUB ESP,0x18
00461a06 : PUSH EBX
00461a07 : MOV EBX,dword ptr [EBP + 0x10]
00461a0a : PUSH ESI
00461a0b : PUSH EDI
00461a0c : MOV EDI,dword ptr [EBP + 0x8]
00461a0f : MOV EAX,dword ptr [EDI + 0x4]
00461a12 : MOV ESI,dword ptr [EAX + 0x4]
00461a15 : CMP byte ptr [ESI + 0x45],0x0
00461a19 : MOV ECX,EAX
00461a1b : MOV AL,0x1
00461a1d : MOV dword ptr [EBP + -0x4],ECX
00461a20 : MOV byte ptr [EBP + -0x8],AL
00461a23 : JNZ 0x00461ada
00461a29 : MOV EAX,dword ptr [EBX + 0x14]
00461a2c : MOV EDX,dword ptr [EBX + 0x18]
00461a2f : MOV ECX,EAX
00461a31 : MOV dword ptr [EBP + -0x10],EAX
00461a34 : MOV dword ptr [EBP + -0xc],ECX
00461a37 : MOV dword ptr [EBP + -0x14],EDX
00461a3a : JMP 0x00461a43
00461a40 : MOV ECX,dword ptr [EBP + -0xc]
00461a43 : CMP dword ptr [ESI + 0x24],0x8
00461a47 : MOV EDX,dword ptr [ESI + 0x20]
00461a4a : MOV dword ptr [EBP + -0x4],ESI
00461a4d : JC 0x00461a54
00461a4f : MOV EAX,dword ptr [ESI + 0x10]
00461a52 : JMP 0x00461a57
00461a54 : LEA EAX,[ESI + 0x10]
00461a57 : MOV EDI,dword ptr [EBP + -0x10]
00461a5a : CMP ECX,EDI
00461a5c : CMOVC EDI,ECX
00461a5f : CMP EDI,EDX
00461a61 : JNC 0x00461a65
00461a63 : MOV EDX,EDI
00461a65 : CMP dword ptr [EBP + -0x14],0x8
00461a69 : JC 0x00461a70
00461a6b : MOV ECX,dword ptr [EBX + 0x4]
00461a6e : JMP 0x00461a73
00461a70 : LEA ECX,[EBX + 0x4]
00461a73 : TEST EDX,EDX
00461a75 : JBE 0x00461a8d
00461a77 : MOV BX,word ptr [ECX]
00461a7a : CMP BX,word ptr [EAX]
00461a7d : JNZ 0x00461a99
00461a7f : ADD ECX,0x2
00461a82 : ADD EAX,0x2
00461a85 : SUB EDX,0x1
00461a88 : JNZ 0x00461a77
00461a8a : MOV EBX,dword ptr [EBP + 0x10]
00461a8d : MOV EAX,dword ptr [ESI + 0x20]
00461a90 : CMP EDI,EAX
00461a92 : JNC 0x00461aae
00461a94 : OR EAX,0xffffffff
00461a97 : JMP 0x00461ab7
00461a99 : MOV CX,BX
00461a9c : CMP CX,word ptr [EAX]
00461a9f : SBB EAX,EAX
00461aa1 : AND EAX,0xfffffffe
00461aa4 : ADD EAX,0x1
00461aa7 : JZ 0x00461a8a
00461aa9 : MOV EBX,dword ptr [EBP + 0x10]
00461aac : JMP 0x00461ab7
00461aae : XOR EDX,EDX
00461ab0 : CMP EDI,EAX
00461ab2 : SETNZ DL
00461ab5 : MOV EAX,EDX
00461ab7 : TEST EAX,EAX
00461ab9 : SETL AL
00461abc : MOV byte ptr [EBP + -0x8],AL
00461abf : TEST AL,AL
00461ac1 : JZ 0x00461ac7
00461ac3 : MOV ESI,dword ptr [ESI]
00461ac5 : JMP 0x00461aca
00461ac7 : MOV ESI,dword ptr [ESI + 0x8]
00461aca : CMP byte ptr [ESI + 0x45],0x0
00461ace : JZ 0x00461a40
00461ad4 : MOV EDI,dword ptr [EBP + 0x8]
00461ad7 : MOV ECX,dword ptr [EBP + -0x4]
00461ada : MOV ESI,ECX
00461adc : MOV dword ptr [EBP + 0x10],ESI
00461adf : TEST AL,AL
00461ae1 : JZ 0x00461b12
00461ae3 : MOV EAX,dword ptr [EDI + 0x4]
00461ae6 : LEA EDX,[EBP + 0x10]
00461ae9 : CMP ECX,dword ptr [EAX]
00461aeb : JNZ 0x00461b0a
00461aed : PUSH EBX
00461aee : PUSH 0x1
00461af0 : PUSH EDX
00461af1 : CALL 0x00461be0
00461af6 : MOV ECX,dword ptr [EAX]
00461af8 : MOV EAX,dword ptr [EBP + 0xc]
00461afb : MOV dword ptr [EAX],ECX
00461afd : MOV byte ptr [EAX + 0x4],0x1
00461b01 : POP EDI
00461b02 : POP ESI
00461b03 : POP EBX
00461b04 : MOV ESP,EBP
00461b06 : POP EBP
00461b07 : RET 0xc
00461b0a : CALL 0x00462360
00461b0f : MOV ESI,dword ptr [EBP + 0x10]
00461b12 : CMP dword ptr [EBX + 0x18],0x8
00461b16 : MOV EDI,dword ptr [EBX + 0x14]
00461b19 : LEA ECX,[ESI + 0xc]
00461b1c : JC 0x00461b23
00461b1e : MOV EAX,dword ptr [EBX + 0x4]
00461b21 : JMP 0x00461b26
00461b23 : LEA EAX,[EBX + 0x4]
00461b26 : PUSH EAX
00461b27 : MOV EAX,dword ptr [ECX + 0x14]
00461b2a : CALL 0x00405bb0
00461b2f : TEST EAX,EAX
00461b31 : JGE 0x00461b44
00461b33 : MOV EDX,dword ptr [EBP + -0x8]
00461b36 : MOV ECX,dword ptr [EBP + -0x4]
00461b39 : MOV EDI,dword ptr [EBP + 0x8]
00461b3c : PUSH EBX
00461b3d : PUSH EDX
00461b3e : LEA EAX,[EBP + 0x10]
00461b41 : PUSH EAX
00461b42 : JMP 0x00461af1
00461b44 : MOV EAX,dword ptr [EBP + 0xc]
00461b47 : POP EDI
00461b48 : MOV dword ptr [EAX],ESI
00461b4a : POP ESI
00461b4b : MOV byte ptr [EAX + 0x4],0x0
00461b4f : POP EBX
00461b50 : MOV ESP,EBP
00461b52 : POP EBP
00461b53 : RET 0xc

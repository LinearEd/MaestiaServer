PROGRAM  : Maestia.exe
FUNCTION : FUN_00698900
ENTRY    : 00698900
BODY     : [[00698900, 00698b1c] [00698b20, 00698c45]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00698900(uint param_1,uint param_2,int param_3)

{
  char cVar1;
  int in_EAX;
  byte bVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  byte *pbVar7;
  byte *pbVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  int *piVar13;
  int *piVar14;
  int *local_1c;
  int local_18;
  int local_10;
  int local_c;
  int local_8;
  int local_4;
  
  iVar10 = *(int *)(in_EAX + 0x88);
  local_1c = (int *)(iVar10 + (param_2 & 0xffff) * 8);
  uVar3 = param_1 & 0xffff;
  piVar14 = (int *)(iVar10 + uVar3 * 8);
  iVar6 = *(int *)(in_EAX + 8);
  bVar2 = (byte)*(undefined4 *)(in_EAX + 0x1c);
  iVar12 = (*(int *)(iVar10 + uVar3 * 8) << (bVar2 & 0x1f)) - iVar6;
  local_c = (*(int *)(iVar10 + 4 + uVar3 * 8) << (bVar2 & 0x1f)) - iVar6;
  iVar4 = (*local_1c << (bVar2 & 0x1f)) - iVar6;
  iVar6 = (local_1c[1] << (bVar2 & 0x1f)) - iVar6;
  iVar10 = iVar4;
  local_10 = iVar12;
  if (param_3 != 0) {
    iVar10 = iVar6;
    iVar6 = iVar4;
    local_10 = local_c;
    local_c = iVar12;
  }
  pbVar7 = (byte *)(*(int *)(in_EAX + 0x8c) + (param_1 & 0xffff));
  if ((*pbVar7 & 3) != 2) {
    if ((*pbVar7 & 3) == 0) {
      if ((*(byte *)(*(int *)(in_EAX + 0x8c) + (param_2 & 0xffff)) & 3) == 1) {
        local_1c = local_1c + -2;
        local_10 = iVar10;
        local_c = iVar6;
      }
      else {
        local_10 = (iVar10 + local_10) / 2;
        local_c = (iVar6 + local_c) / 2;
      }
      piVar14 = piVar14 + -2;
      pbVar7 = pbVar7 + -1;
    }
    *(int *)(in_EAX + 0x48) = local_10;
    *(int *)(in_EAX + 0x4c) = local_c;
    do {
      if (local_1c <= piVar14) {
        cVar1 = FUN_006985c0(local_10);
joined_r0x00698c11:
        if (cVar1 != '\0') {
          return 1;
        }
        return 0;
      }
      pbVar8 = pbVar7 + 1;
      piVar13 = piVar14 + 2;
      if ((pbVar7[1] & 3) == 0) {
        bVar2 = (byte)*(undefined4 *)(in_EAX + 0x1c);
        iVar10 = (*piVar13 << (bVar2 & 0x1f)) - *(int *)(in_EAX + 8);
        local_8 = (piVar14[3] << (bVar2 & 0x1f)) - *(int *)(in_EAX + 8);
        piVar14 = piVar13;
        local_4 = iVar10;
        if (param_3 == 0) goto LAB_00698b20;
        while( true ) {
          piVar14 = piVar13;
          iVar10 = local_8;
          local_8 = local_4;
LAB_00698b20:
          local_4 = local_8;
          local_8 = iVar10;
          if (local_1c <= piVar14) {
            cVar1 = FUN_00698680(local_8,local_4,local_10,local_c);
            goto joined_r0x00698c11;
          }
          pbVar7 = pbVar8 + 1;
          pbVar8 = pbVar8 + 1;
          piVar13 = piVar14 + 2;
          bVar2 = (byte)*(undefined4 *)(in_EAX + 0x1c);
          iVar4 = (piVar14[2] << (bVar2 & 0x1f)) - *(int *)(in_EAX + 8);
          iVar6 = (piVar14[3] << (bVar2 & 0x1f)) - *(int *)(in_EAX + 8);
          iVar10 = iVar4;
          if (param_3 != 0) {
            iVar10 = iVar6;
            iVar6 = iVar4;
          }
          if ((*pbVar7 & 3) == 1) break;
          if ((*pbVar7 & 3) != 0) goto LAB_00698c1d;
          cVar1 = FUN_00698680(local_8,local_4,(iVar10 + local_8) / 2,(local_4 + iVar6) / 2);
          local_8 = iVar10;
          local_4 = iVar6;
          if (cVar1 != '\0') {
            return 1;
          }
        }
        cVar1 = FUN_00698680(local_8,local_4,iVar10,iVar6);
        piVar14 = piVar13;
        pbVar7 = pbVar8;
      }
      else if ((pbVar7[1] & 3) == 1) {
        bVar2 = (byte)*(undefined4 *)(in_EAX + 0x1c);
        iVar10 = (*piVar13 << (bVar2 & 0x1f)) - *(int *)(in_EAX + 8);
        if (param_3 != 0) {
          iVar10 = (piVar14[3] << (bVar2 & 0x1f)) - *(int *)(in_EAX + 8);
        }
        cVar1 = FUN_006985c0(iVar10);
        piVar14 = piVar13;
        pbVar7 = pbVar8;
      }
      else {
        if ((local_1c < piVar14 + 4) || ((pbVar7[2] & 3) != 2)) break;
        iVar10 = *(int *)(in_EAX + 8);
        piVar13 = piVar14 + 6;
        bVar2 = (byte)*(undefined4 *)(in_EAX + 0x1c);
        iVar9 = (piVar14[4] << (bVar2 & 0x1f)) - iVar10;
        iVar5 = (piVar14[2] << (bVar2 & 0x1f)) - iVar10;
        param_2 = (piVar14[5] << (bVar2 & 0x1f)) - iVar10;
        iVar12 = (piVar14[3] << (bVar2 & 0x1f)) - iVar10;
        local_18 = (*piVar13 << (bVar2 & 0x1f)) - iVar10;
        iVar10 = (piVar14[7] << (bVar2 & 0x1f)) - iVar10;
        iVar6 = iVar9;
        iVar4 = iVar5;
        iVar11 = iVar10;
        if (param_3 != 0) {
          iVar6 = param_2;
          iVar4 = iVar12;
          iVar12 = iVar5;
          iVar11 = local_18;
          param_2 = iVar9;
          local_18 = iVar10;
        }
        if (local_1c < piVar13) {
          cVar1 = FUN_006987a0(iVar4,iVar12,iVar6,param_2,local_10,local_c);
          goto joined_r0x00698c11;
        }
        cVar1 = FUN_006987a0(iVar4,iVar12,iVar6,param_2,local_18,iVar11);
        piVar14 = piVar13;
        pbVar7 = pbVar7 + 3;
      }
      if (cVar1 != '\0') {
        return 1;
      }
    } while( true );
  }
LAB_00698c1d:
  *(undefined4 *)(in_EAX + 0x30) = 0x14;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
00698900 : SUB ESP,0x1c
00698903 : MOVZX ECX,word ptr [ESP + 0x24]
00698908 : PUSH EBX
00698909 : PUSH EBP
0069890a : PUSH ESI
0069890b : PUSH EDI
0069890c : MOV EDI,EAX
0069890e : MOV EAX,dword ptr [EDI + 0x88]
00698914 : LEA EBX,[EAX + ECX*0x8]
00698917 : MOVZX ECX,word ptr [ESP + 0x30]
0069891c : MOV ESI,dword ptr [EAX + ECX*0x8]
0069891f : MOV EBP,dword ptr [EAX + ECX*0x8 + 0x4]
00698923 : LEA EDX,[EAX + ECX*0x8]
00698926 : MOV ECX,dword ptr [EDI + 0x1c]
00698929 : MOV EAX,dword ptr [EDI + 0x8]
0069892c : MOV dword ptr [ESP + 0x18],EDX
00698930 : MOV EDX,dword ptr [EBX]
00698932 : MOV dword ptr [ESP + 0x10],EBX
00698936 : MOV EBX,dword ptr [EBX + 0x4]
00698939 : SHL ESI,CL
0069893b : SHL EBP,CL
0069893d : SHL EDX,CL
0069893f : SHL EBX,CL
00698941 : SUB ESI,EAX
00698943 : SUB EBP,EAX
00698945 : SUB EDX,EAX
00698947 : SUB EBX,EAX
00698949 : CMP dword ptr [ESP + 0x38],0x0
0069894e : MOV dword ptr [ESP + 0x1c],ESI
00698952 : MOV dword ptr [ESP + 0x20],EBP
00698956 : JZ 0x00698966
00698958 : MOV EAX,EDX
0069895a : MOV EDX,EBX
0069895c : MOV dword ptr [ESP + 0x1c],EBP
00698960 : MOV dword ptr [ESP + 0x20],ESI
00698964 : MOV EBX,EAX
00698966 : MOVZX EAX,word ptr [ESP + 0x30]
0069896b : MOV ECX,dword ptr [EDI + 0x8c]
00698971 : MOV ESI,dword ptr [ESP + 0x18]
00698975 : LEA EBP,[ECX + EAX*0x1]
00698978 : MOVSX EAX,byte ptr [EBP]
0069897c : AND EAX,0x3
0069897f : CMP EAX,0x2
00698982 : JZ 0x00698c1d
00698988 : TEST EAX,EAX
0069898a : JNZ 0x006989cd
0069898c : MOVZX EAX,word ptr [ESP + 0x34]
00698991 : MOV AL,byte ptr [ECX + EAX*0x1]
00698994 : AND AL,0x3
00698996 : CMP AL,0x1
00698998 : JNZ 0x006989a9
0069899a : SUB dword ptr [ESP + 0x10],0x8
0069899f : MOV dword ptr [ESP + 0x1c],EDX
006989a3 : MOV dword ptr [ESP + 0x20],EBX
006989a7 : JMP 0x006989c9
006989a9 : MOV ECX,dword ptr [ESP + 0x1c]
006989ad : LEA EAX,[EDX + ECX*0x1]
006989b0 : CDQ
006989b1 : SUB EAX,EDX
006989b3 : MOV EDX,dword ptr [ESP + 0x20]
006989b7 : SAR EAX,0x1
006989b9 : MOV dword ptr [ESP + 0x1c],EAX
006989bd : LEA EAX,[EBX + EDX*0x1]
006989c0 : CDQ
006989c1 : SUB EAX,EDX
006989c3 : SAR EAX,0x1
006989c5 : MOV dword ptr [ESP + 0x20],EAX
006989c9 : SUB ESI,0x8
006989cc : DEC EBP
006989cd : MOV EAX,dword ptr [ESP + 0x1c]
006989d1 : MOV ECX,dword ptr [ESP + 0x20]
006989d5 : MOV dword ptr [EDI + 0x48],EAX
006989d8 : MOV dword ptr [EDI + 0x4c],ECX
006989db : CMP ESI,dword ptr [ESP + 0x10]
006989df : JNC 0x00698bd4
006989e5 : MOVSX EAX,byte ptr [EBP + 0x1]
006989e9 : INC EBP
006989ea : AND EAX,0x3
006989ed : ADD ESI,0x8
006989f0 : SUB EAX,0x0
006989f3 : JZ 0x00698ae9
006989f9 : SUB EAX,0x1
006989fc : JZ 0x00698ab1
00698a02 : LEA EDX,[ESI + 0x8]
00698a05 : CMP EDX,dword ptr [ESP + 0x10]
00698a09 : JA 0x00698c1d
00698a0f : MOV AL,byte ptr [EBP + 0x1]
00698a12 : AND AL,0x3
00698a14 : CMP AL,0x2
00698a16 : JNZ 0x00698c1d
00698a1c : MOV ECX,dword ptr [EDI + 0x1c]
00698a1f : MOV EAX,dword ptr [EDI + 0x8]
00698a22 : ADD EBP,0x2
00698a25 : MOV dword ptr [ESP + 0x30],EBP
00698a29 : MOV EBP,dword ptr [ESI + 0x8]
00698a2c : ADD ESI,0x10
00698a2f : SHL EBP,CL
00698a31 : MOV EDX,dword ptr [ESI + -0x10]
00698a34 : MOV EBX,dword ptr [ESI + -0xc]
00698a37 : SHL EDX,CL
00698a39 : SUB EBP,EAX
00698a3b : MOV dword ptr [ESP + 0x18],EBP
00698a3f : MOV EBP,dword ptr [ESI + -0x4]
00698a42 : SHL EBP,CL
00698a44 : SHL EBX,CL
00698a46 : SUB EDX,EAX
00698a48 : SUB EBP,EAX
00698a4a : MOV dword ptr [ESP + 0x34],EBP
00698a4e : MOV EBP,dword ptr [ESI]
00698a50 : SHL EBP,CL
00698a52 : SUB EBX,EAX
00698a54 : SUB EBP,EAX
00698a56 : MOV dword ptr [ESP + 0x14],EBP
00698a5a : MOV EBP,dword ptr [ESI + 0x4]
00698a5d : SHL EBP,CL
00698a5f : SUB EBP,EAX
00698a61 : CMP dword ptr [ESP + 0x38],0x0
00698a66 : JZ 0x00698a86
00698a68 : MOV ECX,dword ptr [ESP + 0x34]
00698a6c : MOV EAX,EDX
00698a6e : MOV EDX,EBX
00698a70 : MOV EBX,EAX
00698a72 : MOV EAX,dword ptr [ESP + 0x18]
00698a76 : MOV dword ptr [ESP + 0x34],EAX
00698a7a : MOV EAX,dword ptr [ESP + 0x14]
00698a7e : MOV dword ptr [ESP + 0x14],EBP
00698a82 : MOV EBP,EAX
00698a84 : JMP 0x00698a8a
00698a86 : MOV ECX,dword ptr [ESP + 0x18]
00698a8a : CMP ESI,dword ptr [ESP + 0x10]
00698a8e : JA 0x00698bf3
00698a94 : MOV EAX,dword ptr [ESP + 0x14]
00698a98 : PUSH EBP
00698a99 : PUSH EAX
00698a9a : MOV EAX,dword ptr [ESP + 0x3c]
00698a9e : PUSH EAX
00698a9f : PUSH ECX
00698aa0 : PUSH EBX
00698aa1 : PUSH EDX
00698aa2 : MOV EAX,EDI
00698aa4 : CALL 0x006987a0
00698aa9 : ADD ESP,0x18
00698aac : JMP 0x00698bc2
00698ab1 : MOV ECX,dword ptr [EDI + 0x1c]
00698ab4 : MOV EAX,dword ptr [ESI]
00698ab6 : MOV EDX,dword ptr [ESI + 0x4]
00698ab9 : MOV EBX,dword ptr [EDI + 0x8]
00698abc : SHL EAX,CL
00698abe : SHL EDX,CL
00698ac0 : SUB EAX,EBX
00698ac2 : SUB EDX,EBX
00698ac4 : CMP dword ptr [ESP + 0x38],0x0
00698ac9 : JZ 0x00698ad1
00698acb : MOV ECX,EAX
00698acd : MOV EAX,EDX
00698acf : MOV EDX,ECX
00698ad1 : PUSH EAX
00698ad2 : MOV EBX,EDX
00698ad4 : CALL 0x006985c0
00698ad9 : ADD ESP,0x4
00698adc : TEST AL,AL
00698ade : JNZ 0x00698be9
00698ae4 : JMP 0x00698bca
00698ae9 : MOV ECX,dword ptr [EDI + 0x1c]
00698aec : MOV EAX,dword ptr [ESI]
00698aee : MOV EDX,dword ptr [ESI + 0x4]
00698af1 : MOV EBX,dword ptr [EDI + 0x8]
00698af4 : SHL EAX,CL
00698af6 : SHL EDX,CL
00698af8 : SUB EAX,EBX
00698afa : SUB EDX,EBX
00698afc : CMP dword ptr [ESP + 0x38],0x0
00698b01 : MOV dword ptr [ESP + 0x24],EAX
00698b05 : MOV dword ptr [ESP + 0x28],EDX
00698b09 : JZ 0x00698b20
00698b0b : MOV dword ptr [ESP + 0x24],EDX
00698b0f : MOV dword ptr [ESP + 0x28],EAX
00698b13 : MOV EDX,dword ptr [ESP + 0x28]
00698b17 : MOV EAX,dword ptr [ESP + 0x24]
00698b1b : JMP 0x00698b20
00698b20 : CMP ESI,dword ptr [ESP + 0x10]
00698b24 : JNC 0x00698c2e
00698b2a : MOVSX EAX,byte ptr [EBP + 0x1]
00698b2e : MOV ECX,dword ptr [EDI + 0x1c]
00698b31 : MOV EBX,dword ptr [ESI + 0x8]
00698b34 : MOV EDX,dword ptr [EDI + 0x8]
00698b37 : INC EBP
00698b38 : ADD ESI,0x8
00698b3b : MOV dword ptr [ESP + 0x30],EBP
00698b3f : MOV EBP,dword ptr [ESI + 0x4]
00698b42 : SHL EBX,CL
00698b44 : SHL EBP,CL
00698b46 : AND EAX,0x3
00698b49 : SUB EBX,EDX
00698b4b : SUB EBP,EDX
00698b4d : CMP dword ptr [ESP + 0x38],0x0
00698b52 : JZ 0x00698b5a
00698b54 : MOV ECX,EBX
00698b56 : MOV EBX,EBP
00698b58 : MOV EBP,ECX
00698b5a : CMP EAX,0x1
00698b5d : JZ 0x00698bac
00698b5f : TEST EAX,EAX
00698b61 : JNZ 0x00698c1d
00698b67 : MOV ECX,dword ptr [ESP + 0x24]
00698b6b : LEA EAX,[EBX + ECX*0x1]
00698b6e : CDQ
00698b6f : SUB EAX,EDX
00698b71 : MOV EDX,dword ptr [ESP + 0x28]
00698b75 : MOV ECX,EAX
00698b77 : LEA EAX,[EDX + EBP*0x1]
00698b7a : CDQ
00698b7b : SUB EAX,EDX
00698b7d : SAR EAX,0x1
00698b7f : PUSH EAX
00698b80 : MOV EAX,dword ptr [ESP + 0x2c]
00698b84 : SAR ECX,0x1
00698b86 : PUSH ECX
00698b87 : MOV ECX,dword ptr [ESP + 0x2c]
00698b8b : PUSH EAX
00698b8c : PUSH ECX
00698b8d : MOV EAX,EDI
00698b8f : CALL 0x00698680
00698b94 : ADD ESP,0x10
00698b97 : TEST AL,AL
00698b99 : JNZ 0x00698be9
00698b9b : MOV dword ptr [ESP + 0x28],EBP
00698b9f : MOV EBP,dword ptr [ESP + 0x30]
00698ba3 : MOV dword ptr [ESP + 0x24],EBX
00698ba7 : JMP 0x00698b13
00698bac : MOV EDX,dword ptr [ESP + 0x28]
00698bb0 : MOV EAX,dword ptr [ESP + 0x24]
00698bb4 : PUSH EBP
00698bb5 : PUSH EBX
00698bb6 : PUSH EDX
00698bb7 : PUSH EAX
00698bb8 : MOV EAX,EDI
00698bba : CALL 0x00698680
00698bbf : ADD ESP,0x10
00698bc2 : TEST AL,AL
00698bc4 : JNZ 0x00698be9
00698bc6 : MOV EBP,dword ptr [ESP + 0x30]
00698bca : CMP ESI,dword ptr [ESP + 0x10]
00698bce : JC 0x006989e5
00698bd4 : MOV EDX,dword ptr [ESP + 0x1c]
00698bd8 : MOV EBX,dword ptr [ESP + 0x20]
00698bdc : PUSH EDX
00698bdd : CALL 0x006985c0
00698be2 : ADD ESP,0x4
00698be5 : TEST AL,AL
00698be7 : JZ 0x00698c13
00698be9 : POP EDI
00698bea : POP ESI
00698beb : POP EBP
00698bec : MOV AL,0x1
00698bee : POP EBX
00698bef : ADD ESP,0x1c
00698bf2 : RET
00698bf3 : MOV EAX,dword ptr [ESP + 0x20]
00698bf7 : PUSH EAX
00698bf8 : MOV EAX,dword ptr [ESP + 0x20]
00698bfc : PUSH EAX
00698bfd : MOV EAX,dword ptr [ESP + 0x3c]
00698c01 : PUSH EAX
00698c02 : PUSH ECX
00698c03 : PUSH EBX
00698c04 : PUSH EDX
00698c05 : MOV EAX,EDI
00698c07 : CALL 0x006987a0
00698c0c : ADD ESP,0x18
00698c0f : TEST AL,AL
00698c11 : JNZ 0x00698be9
00698c13 : POP EDI
00698c14 : POP ESI
00698c15 : POP EBP
00698c16 : XOR AL,AL
00698c18 : POP EBX
00698c19 : ADD ESP,0x1c
00698c1c : RET
00698c1d : MOV dword ptr [EDI + 0x30],0x14
00698c24 : POP EDI
00698c25 : POP ESI
00698c26 : POP EBP
00698c27 : MOV AL,0x1
00698c29 : POP EBX
00698c2a : ADD ESP,0x1c
00698c2d : RET
00698c2e : MOV ECX,dword ptr [ESP + 0x20]
00698c32 : PUSH ECX
00698c33 : MOV ECX,dword ptr [ESP + 0x20]
00698c37 : PUSH ECX
00698c38 : PUSH EDX
00698c39 : PUSH EAX
00698c3a : MOV EAX,EDI
00698c3c : CALL 0x00698680
00698c41 : ADD ESP,0x10
00698c44 : JMP 0x00698c0f

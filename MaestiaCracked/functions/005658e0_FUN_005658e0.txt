PROGRAM  : Maestia.exe
FUNCTION : FUN_005658e0
ENTRY    : 005658e0
BODY     : [[005658e0, 00565a27]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005658e0(undefined4 param_1,undefined4 *param_2,uint param_3)

{
  uint *puVar1;
  uint *puVar2;
  uint *puVar3;
  int *piVar4;
  uint uVar5;
  uint uVar6;
  int *in_ECX;
  uint uVar7;
  int iVar8;
  int iVar9;
  
  piVar4 = (int *)*in_ECX;
  if (piVar4 == (int *)0x0) {
    iVar9 = 8;
  }
  else {
    if ((uint)(*piVar4 * 5) <= piVar4[1] * 4 + 4U) goto LAB_0056591a;
    iVar9 = piVar4[1] * 2 + 2;
  }
  FUN_00563f30(param_1,iVar9);
LAB_0056591a:
  piVar4 = (int *)*in_ECX;
  param_3 = param_3 & piVar4[1];
  *piVar4 = *piVar4 + 1;
  iVar9 = *in_ECX;
  puVar1 = (uint *)(param_3 * 0x10 + 8 + iVar9);
  uVar5 = *puVar1;
  if (uVar5 == 0xfffffffe) {
    *puVar1 = 0xffffffff;
    puVar1[2] = *(uint *)*param_2;
    FUN_0051c2c0(param_2[1]);
    puVar1[1] = param_3;
    return;
  }
  uVar7 = param_3;
  do {
    uVar7 = uVar7 + 1 & *(uint *)(iVar9 + 4);
  } while (*(int *)(iVar9 + 8 + uVar7 * 0x10) != -2);
  puVar2 = (uint *)(uVar7 * 0x10 + 8 + iVar9);
  if (puVar1[1] != param_3) {
    iVar8 = puVar1[1] * 0x10;
    puVar3 = (uint *)(iVar9 + 8 + iVar8);
    for (uVar6 = *(uint *)(iVar9 + 8 + iVar8); uVar6 != param_3;
        uVar6 = *(uint *)(iVar9 + 8 + uVar6 * 0x10)) {
      uVar6 = *puVar3;
      puVar3 = (uint *)(iVar9 + 8 + uVar6 * 0x10);
    }
    if (puVar2 != (uint *)0x0) {
      *puVar2 = uVar5;
      puVar2[1] = puVar1[1];
      puVar2[2] = puVar1[2];
      FUN_0051c2c0(puVar1 + 3);
    }
    *puVar3 = uVar7;
    puVar1[2] = *(uint *)*param_2;
    FUN_0051bc20(param_2[1]);
    puVar1[1] = param_3;
    *puVar1 = 0xffffffff;
    return;
  }
  if (puVar2 != (uint *)0x0) {
    *puVar2 = uVar5;
    puVar2[1] = puVar1[1];
    puVar2[2] = puVar1[2];
    FUN_0051c2c0(puVar1 + 3);
  }
  puVar1[2] = *(uint *)*param_2;
  FUN_0051bc20(param_2[1]);
  *puVar1 = uVar7;
  puVar1[1] = param_3;
  return;
}



============================================================
DISASSEMBLY
============================================================
005658e0 : PUSH ESI
005658e1 : MOV ESI,ECX
005658e3 : MOV EAX,dword ptr [ESI]
005658e5 : PUSH EDI
005658e6 : TEST EAX,EAX
005658e8 : JNZ 0x005658f3
005658ea : MOV EAX,dword ptr [ESP + 0xc]
005658ee : PUSH 0x8
005658f0 : PUSH EAX
005658f1 : JMP 0x00565915
005658f3 : MOV ECX,dword ptr [EAX + 0x4]
005658f6 : LEA EDX,[ECX*0x4 + 0x4]
005658fd : MOV ECX,dword ptr [EAX]
005658ff : LEA ECX,[ECX + ECX*0x4]
00565902 : CMP ECX,EDX
00565904 : JBE 0x0056591a
00565906 : MOV EDX,dword ptr [EAX + 0x4]
00565909 : MOV ECX,dword ptr [ESP + 0xc]
0056590d : LEA EAX,[EDX + EDX*0x1 + 0x2]
00565911 : PUSH EAX
00565912 : PUSH ECX
00565913 : MOV ECX,ESI
00565915 : CALL 0x00563f30
0056591a : MOV EAX,dword ptr [ESI]
0056591c : MOV EDI,dword ptr [ESP + 0x14]
00565920 : AND EDI,dword ptr [EAX + 0x4]
00565923 : INC dword ptr [EAX]
00565925 : MOV EAX,dword ptr [ESI]
00565927 : MOV EDX,EDI
00565929 : SHL EDX,0x4
0056592c : LEA ESI,[EDX + EAX*0x1 + 0x8]
00565930 : MOV EDX,dword ptr [ESI]
00565932 : CMP EDX,-0x2
00565935 : JNZ 0x0056595c
00565937 : MOV EAX,dword ptr [ESP + 0x10]
0056593b : MOV dword ptr [ESI],0xffffffff
00565941 : MOV ECX,dword ptr [EAX]
00565943 : MOV EDX,dword ptr [ECX]
00565945 : MOV dword ptr [ESI + 0x8],EDX
00565948 : MOV EAX,dword ptr [EAX + 0x4]
0056594b : PUSH EAX
0056594c : LEA ECX,[ESI + 0xc]
0056594f : CALL 0x0051c2c0
00565954 : MOV dword ptr [ESI + 0x4],EDI
00565957 : POP EDI
00565958 : POP ESI
00565959 : RET 0xc
0056595c : MOV ECX,dword ptr [EAX + 0x4]
0056595f : PUSH EBX
00565960 : MOV EBX,EDI
00565962 : PUSH EBP
00565963 : INC EBX
00565964 : AND EBX,ECX
00565966 : MOV EBP,EBX
00565968 : SHL EBP,0x4
0056596b : CMP dword ptr [EAX + EBP*0x1 + 0x8],-0x2
00565970 : JNZ 0x00565963
00565972 : MOV EBP,dword ptr [ESI + 0x4]
00565975 : MOV ECX,EBX
00565977 : SHL ECX,0x4
0056597a : LEA ECX,[ECX + EAX*0x1 + 0x8]
0056597e : CMP EBP,EDI
00565980 : JNZ 0x005659c3
00565982 : TEST ECX,ECX
00565984 : JZ 0x005659a0
00565986 : MOV dword ptr [ECX],EDX
00565988 : MOV EDX,dword ptr [ESI + 0x4]
0056598b : MOV dword ptr [ECX + 0x4],EDX
0056598e : MOV EAX,dword ptr [ESI + 0x8]
00565991 : LEA EDX,[ESI + 0xc]
00565994 : MOV dword ptr [ECX + 0x8],EAX
00565997 : PUSH EDX
00565998 : ADD ECX,0xc
0056599b : CALL 0x0051c2c0
005659a0 : MOV EAX,dword ptr [ESP + 0x18]
005659a4 : MOV ECX,dword ptr [EAX]
005659a6 : MOV EDX,dword ptr [ECX]
005659a8 : MOV dword ptr [ESI + 0x8],EDX
005659ab : MOV EAX,dword ptr [EAX + 0x4]
005659ae : PUSH EAX
005659af : LEA ECX,[ESI + 0xc]
005659b2 : CALL 0x0051bc20
005659b7 : POP EBP
005659b8 : MOV dword ptr [ESI],EBX
005659ba : POP EBX
005659bb : MOV dword ptr [ESI + 0x4],EDI
005659be : POP EDI
005659bf : POP ESI
005659c0 : RET 0xc
005659c3 : SHL EBP,0x4
005659c6 : CMP dword ptr [EAX + EBP*0x1 + 0x8],EDI
005659ca : LEA EBP,[EAX + EBP*0x1 + 0x8]
005659ce : JZ 0x005659e0
005659d0 : MOV EBP,dword ptr [EBP]
005659d3 : SHL EBP,0x4
005659d6 : CMP dword ptr [EAX + EBP*0x1 + 0x8],EDI
005659da : LEA EBP,[EAX + EBP*0x1 + 0x8]
005659de : JNZ 0x005659d0
005659e0 : TEST ECX,ECX
005659e2 : JZ 0x005659fe
005659e4 : MOV dword ptr [ECX],EDX
005659e6 : MOV EDX,dword ptr [ESI + 0x4]
005659e9 : MOV dword ptr [ECX + 0x4],EDX
005659ec : MOV EAX,dword ptr [ESI + 0x8]
005659ef : LEA EDX,[ESI + 0xc]
005659f2 : MOV dword ptr [ECX + 0x8],EAX
005659f5 : PUSH EDX
005659f6 : ADD ECX,0xc
005659f9 : CALL 0x0051c2c0
005659fe : MOV EAX,dword ptr [ESP + 0x18]
00565a02 : MOV dword ptr [EBP],EBX
00565a05 : MOV ECX,dword ptr [EAX]
00565a07 : MOV EDX,dword ptr [ECX]
00565a09 : MOV dword ptr [ESI + 0x8],EDX
00565a0c : MOV EAX,dword ptr [EAX + 0x4]
00565a0f : PUSH EAX
00565a10 : LEA ECX,[ESI + 0xc]
00565a13 : CALL 0x0051bc20
00565a18 : POP EBP
00565a19 : POP EBX
00565a1a : MOV dword ptr [ESI + 0x4],EDI
00565a1d : POP EDI
00565a1e : MOV dword ptr [ESI],0xffffffff
00565a24 : POP ESI
00565a25 : RET 0xc

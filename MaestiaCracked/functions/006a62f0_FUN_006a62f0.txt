PROGRAM  : Maestia.exe
FUNCTION : FUN_006a62f0
ENTRY    : 006a62f0
BODY     : [[006a62f0, 006a6586]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006a62f0(int param_1)

{
  int iVar1;
  int iVar2;
  undefined4 *puVar3;
  int in_EAX;
  uint uVar4;
  int iVar5;
  undefined4 uVar6;
  uint *puVar7;
  int unaff_ESI;
  int local_1c;
  undefined4 *local_18;
  int local_14;
  int local_10;
  int local_c;
  int local_8;
  undefined4 local_4;
  
  iVar1 = *(int *)(unaff_ESI + 4);
  iVar2 = *(int *)(iVar1 + 0x68);
  local_18 = (undefined4 *)(in_EAX * 0x10 + *(int *)(iVar1 + 0x1a0));
  puVar7 = *(uint **)(iVar1 + 0x184);
  uVar4 = 0;
  if (*(uint *)(iVar1 + 0x17c) != 0) {
    do {
      if ((*puVar7 == (uint)*(ushort *)(param_1 + 0xc)) &&
         (puVar7[1] == (uint)*(ushort *)(param_1 + 0xe))) {
        uVar4 = puVar7[2];
        local_1c = 4;
        if ((uVar4 & 1) != 0) {
          local_1c = 5;
        }
        if ((uVar4 & 2) != 0) {
          local_1c = local_1c + 1;
        }
        if ((uVar4 & 4) != 0) {
          local_1c = local_1c + 1;
        }
        iVar5 = FUN_006877c0(iVar2,*(int *)(iVar1 + 0x1b0) + puVar7[6]);
        if ((iVar5 == 0) && (iVar5 = FUN_00688900(iVar2,puVar7[7] * local_1c), iVar5 == 0)) {
          FUN_006a5ee0(*(undefined4 *)(iVar2 + 0x20),*(undefined4 *)(iVar2 + 0x24),*local_18,
                       &local_10,&local_14);
          FUN_006889b0(iVar2);
          puVar3 = local_18;
          if (local_14 == 0) {
            return 6;
          }
          uVar6 = local_18[1];
          if (*(int *)(iVar1 + 0x130) != *(int *)(iVar1 + 300)) {
            uVar6 = FUN_00685d60(uVar6,*(int *)(iVar1 + 300),*(int *)(iVar1 + 0x130));
          }
          *(undefined4 *)(unaff_ESI + 0x38) = uVar6;
          local_1c = FUN_00685d60((uint)*(ushort *)(param_1 + 0xc) << 8,puVar3[1],
                                  *(undefined4 *)(iVar1 + 0x130));
          iVar5 = FUN_006877c0(iVar2,*(int *)(iVar1 + 0xbc) + local_10);
          if ((iVar5 == 0) && (iVar5 = FUN_00688900(iVar2,local_14), iVar5 == 0)) {
            local_10 = *(int *)(iVar2 + 0x20);
            iVar5 = FUN_006a6000(&local_10,*(undefined4 *)(iVar2 + 0x24),local_1c,&local_14,
                                 &local_18,&local_c,&local_8,&local_1c,&local_4);
            if (iVar5 == 0) {
              *(int *)(unaff_ESI + 0x1c) = local_8 << 6;
              *(int *)(unaff_ESI + 0x20) = local_14 << 6;
              *(int *)(unaff_ESI + 0x50) = local_c;
              *(int *)(unaff_ESI + 0x18) = local_c * 0x40;
              *(int *)(unaff_ESI + 0x24) = (int)local_18 << 6;
              *(int *)(unaff_ESI + 0x2c) = local_c * -0x40 >> 1;
              *(int *)(unaff_ESI + 0x54) = local_c + 7 >> 3;
              *(undefined4 *)(unaff_ESI + 0x48) = 0x62697473;
              *(int *)(unaff_ESI + 0x4c) = local_8;
              *(undefined1 *)(unaff_ESI + 0x5e) = 1;
              *(uint *)(unaff_ESI + 0x28) = (local_1c >> 2) + 0x20U & 0xffffffc0;
              *(undefined4 *)(unaff_ESI + 0x30) = 0;
              *(undefined4 *)(unaff_ESI + 0x34) = *(undefined4 *)(param_1 + 0x20);
              *(int *)(unaff_ESI + 100) = local_14;
              *(int *)(unaff_ESI + 0x68) = (int)local_18 + local_8;
              iVar5 = FUN_00688ef0();
              if (iVar5 == 0) {
                iVar5 = FUN_006a6270(local_4);
              }
            }
            FUN_006889b0(iVar2);
          }
        }
        return iVar5;
      }
      uVar4 = uVar4 + 1;
      puVar7 = puVar7 + 9;
    } while (uVar4 < *(uint *)(iVar1 + 0x17c));
  }
  return 6;
}



============================================================
DISASSEMBLY
============================================================
006a62f0 : SUB ESP,0x20
006a62f3 : PUSH EBX
006a62f4 : MOV EBX,dword ptr [ESI + 0x4]
006a62f7 : MOV ECX,dword ptr [EBX + 0x68]
006a62fa : SHL EAX,0x4
006a62fd : ADD EAX,dword ptr [EBX + 0x1a0]
006a6303 : MOV dword ptr [ESP + 0x4],ECX
006a6307 : MOV ECX,dword ptr [EBX + 0x17c]
006a630d : PUSH EBP
006a630e : MOV EBP,dword ptr [EBX + 0x184]
006a6314 : MOV dword ptr [ESP + 0x10],EAX
006a6318 : XOR EAX,EAX
006a631a : PUSH EDI
006a631b : TEST ECX,ECX
006a631d : JBE 0x006a633d
006a631f : MOV EDX,dword ptr [ESP + 0x30]
006a6323 : MOVZX EDI,word ptr [EDX + 0xc]
006a6327 : CMP dword ptr [EBP],EDI
006a632a : JNZ 0x006a6335
006a632c : MOVZX EDI,word ptr [EDX + 0xe]
006a6330 : CMP dword ptr [EBP + 0x4],EDI
006a6333 : JZ 0x006a6349
006a6335 : INC EAX
006a6336 : ADD EBP,0x24
006a6339 : CMP EAX,ECX
006a633b : JC 0x006a6323
006a633d : POP EDI
006a633e : POP EBP
006a633f : MOV EAX,0x6
006a6344 : POP EBX
006a6345 : ADD ESP,0x20
006a6348 : RET
006a6349 : MOV EAX,dword ptr [EBP + 0x8]
006a634c : MOV dword ptr [ESP + 0x10],0x4
006a6354 : TEST AL,0x1
006a6356 : JZ 0x006a6360
006a6358 : MOV dword ptr [ESP + 0x10],0x5
006a6360 : TEST AL,0x2
006a6362 : JZ 0x006a6368
006a6364 : INC dword ptr [ESP + 0x10]
006a6368 : TEST AL,0x4
006a636a : JZ 0x006a6370
006a636c : INC dword ptr [ESP + 0x10]
006a6370 : MOV EDX,dword ptr [EBX + 0x1b0]
006a6376 : ADD EDX,dword ptr [EBP + 0x18]
006a6379 : MOV EAX,dword ptr [ESP + 0xc]
006a637d : PUSH EDX
006a637e : PUSH EAX
006a637f : CALL 0x006877c0
006a6384 : MOV EDI,EAX
006a6386 : ADD ESP,0x8
006a6389 : TEST EDI,EDI
006a638b : JNZ 0x006a657e
006a6391 : MOV ECX,dword ptr [EBP + 0x1c]
006a6394 : IMUL ECX,dword ptr [ESP + 0x10]
006a6399 : MOV EDX,dword ptr [ESP + 0xc]
006a639d : PUSH ECX
006a639e : PUSH EDX
006a639f : CALL 0x00688900
006a63a4 : MOV EDI,EAX
006a63a6 : ADD ESP,0x8
006a63a9 : TEST EDI,EDI
006a63ab : JNZ 0x006a657e
006a63b1 : MOV EDX,dword ptr [ESP + 0x14]
006a63b5 : MOV EDI,dword ptr [ESP + 0xc]
006a63b9 : LEA EAX,[ESP + 0x18]
006a63bd : PUSH EAX
006a63be : MOV EAX,dword ptr [EDX]
006a63c0 : MOV EDX,dword ptr [EDI + 0x20]
006a63c3 : LEA ECX,[ESP + 0x20]
006a63c7 : PUSH ECX
006a63c8 : MOV ECX,dword ptr [EDI + 0x24]
006a63cb : PUSH EAX
006a63cc : MOV EAX,dword ptr [EBP + 0x8]
006a63cf : PUSH ECX
006a63d0 : MOV ECX,dword ptr [EBP + 0x1c]
006a63d3 : PUSH EDX
006a63d4 : CALL 0x006a5ee0
006a63d9 : PUSH EDI
006a63da : CALL 0x006889b0
006a63df : ADD ESP,0x18
006a63e2 : CMP dword ptr [ESP + 0x18],0x0
006a63e7 : JNZ 0x006a63f7
006a63e9 : MOV EDI,0x6
006a63ee : MOV EAX,EDI
006a63f0 : POP EDI
006a63f1 : POP EBP
006a63f2 : POP EBX
006a63f3 : ADD ESP,0x20
006a63f6 : RET
006a63f7 : MOV ECX,dword ptr [EBX + 0x130]
006a63fd : MOV EDX,dword ptr [EBX + 0x12c]
006a6403 : MOV EBP,dword ptr [ESP + 0x14]
006a6407 : MOV EAX,dword ptr [EBP + 0x4]
006a640a : CMP ECX,EDX
006a640c : JZ 0x006a6419
006a640e : PUSH ECX
006a640f : PUSH EDX
006a6410 : PUSH EAX
006a6411 : CALL 0x00685d60
006a6416 : ADD ESP,0xc
006a6419 : MOV EDX,dword ptr [ESP + 0x30]
006a641d : MOV dword ptr [ESI + 0x38],EAX
006a6420 : MOV EAX,dword ptr [EBX + 0x130]
006a6426 : MOV ECX,dword ptr [EBP + 0x4]
006a6429 : PUSH EAX
006a642a : MOVZX EAX,word ptr [EDX + 0xc]
006a642e : PUSH ECX
006a642f : SHL EAX,0x8
006a6432 : PUSH EAX
006a6433 : CALL 0x00685d60
006a6438 : MOV ECX,dword ptr [EBX + 0xbc]
006a643e : ADD ECX,dword ptr [ESP + 0x28]
006a6442 : MOV dword ptr [ESP + 0x1c],EAX
006a6446 : PUSH ECX
006a6447 : PUSH EDI
006a6448 : CALL 0x006877c0
006a644d : MOV EDI,EAX
006a644f : ADD ESP,0x14
006a6452 : TEST EDI,EDI
006a6454 : JNZ 0x006a657e
006a645a : MOV EDX,dword ptr [ESP + 0x18]
006a645e : MOV EBP,dword ptr [ESP + 0xc]
006a6462 : PUSH EDX
006a6463 : PUSH EBP
006a6464 : CALL 0x00688900
006a6469 : MOV EDI,EAX
006a646b : ADD ESP,0x8
006a646e : TEST EDI,EDI
006a6470 : JNZ 0x006a657e
006a6476 : MOV EAX,dword ptr [EBP + 0x20]
006a6479 : LEA ECX,[ESP + 0x28]
006a647d : PUSH ECX
006a647e : MOV dword ptr [ESP + 0x20],EAX
006a6482 : LEA EDX,[ESP + 0x14]
006a6486 : PUSH EDX
006a6487 : LEA EAX,[ESP + 0x2c]
006a648b : PUSH EAX
006a648c : LEA ECX,[ESP + 0x2c]
006a6490 : PUSH ECX
006a6491 : MOV ECX,dword ptr [ESP + 0x20]
006a6495 : LEA EDX,[ESP + 0x24]
006a6499 : PUSH EDX
006a649a : MOV EDX,dword ptr [EBP + 0x24]
006a649d : LEA EAX,[ESP + 0x2c]
006a64a1 : PUSH EAX
006a64a2 : PUSH ECX
006a64a3 : PUSH EDX
006a64a4 : LEA EAX,[ESP + 0x3c]
006a64a8 : PUSH EAX
006a64a9 : CALL 0x006a6000
006a64ae : MOV EDI,EAX
006a64b0 : ADD ESP,0x24
006a64b3 : TEST EDI,EDI
006a64b5 : JNZ 0x006a6575
006a64bb : MOV EDX,dword ptr [ESP + 0x24]
006a64bf : MOV EAX,dword ptr [ESP + 0x20]
006a64c3 : MOV EDI,EDX
006a64c5 : SHL EDI,0x6
006a64c8 : MOV dword ptr [ESI + 0x1c],EDI
006a64cb : MOV EDI,dword ptr [ESP + 0x18]
006a64cf : SHL EDI,0x6
006a64d2 : MOV dword ptr [ESI + 0x20],EDI
006a64d5 : MOV EDI,dword ptr [ESP + 0x14]
006a64d9 : LEA ECX,[EAX + 0x7]
006a64dc : MOV dword ptr [ESI + 0x50],EAX
006a64df : SHL EAX,0x6
006a64e2 : SHL EDI,0x6
006a64e5 : MOV dword ptr [ESI + 0x18],EAX
006a64e8 : MOV dword ptr [ESI + 0x24],EDI
006a64eb : MOV EDI,dword ptr [ESP + 0x10]
006a64ef : NEG EAX
006a64f1 : SAR EAX,0x1
006a64f3 : SAR ECX,0x3
006a64f6 : SAR EDI,0x2
006a64f9 : MOV dword ptr [ESI + 0x2c],EAX
006a64fc : MOV EAX,dword ptr [ESP + 0x30]
006a6500 : MOV dword ptr [ESI + 0x54],ECX
006a6503 : IMUL ECX,EDX
006a6506 : ADD EDI,0x20
006a6509 : LEA EBP,[ESI + 0x4c]
006a650c : AND EDI,0xffffffc0
006a650f : MOV dword ptr [ESI + 0x48],0x62697473
006a6516 : MOV dword ptr [EBP],EDX
006a6519 : MOV byte ptr [ESI + 0x5e],0x1
006a651d : MOV dword ptr [ESI + 0x28],EDI
006a6520 : MOV dword ptr [ESI + 0x30],0x0
006a6527 : MOV EAX,dword ptr [EAX + 0x20]
006a652a : MOV dword ptr [ESI + 0x34],EAX
006a652d : MOV EAX,dword ptr [ESP + 0x18]
006a6531 : MOV dword ptr [ESI + 0x64],EAX
006a6534 : MOV EAX,dword ptr [ESP + 0x14]
006a6538 : PUSH ECX
006a6539 : ADD EAX,EDX
006a653b : PUSH ESI
006a653c : MOV dword ptr [ESI + 0x68],EAX
006a653f : CALL 0x00688ef0
006a6544 : MOV EDI,EAX
006a6546 : ADD ESP,0x8
006a6549 : TEST EDI,EDI
006a654b : JNZ 0x006a6571
006a654d : MOV AL,byte ptr [EBX + 0xd0]
006a6553 : MOV ECX,dword ptr [ESP + 0x28]
006a6557 : MOV EDX,dword ptr [ESP + 0xc]
006a655b : MOV EDI,dword ptr [EDX + 0x24]
006a655e : MOV EBX,dword ptr [ESP + 0x1c]
006a6562 : PUSH ECX
006a6563 : AND AL,0x2
006a6565 : MOV ECX,EBP
006a6567 : CALL 0x006a6270
006a656c : ADD ESP,0x4
006a656f : MOV EDI,EAX
006a6571 : MOV EBP,dword ptr [ESP + 0xc]
006a6575 : PUSH EBP
006a6576 : CALL 0x006889b0
006a657b : ADD ESP,0x4
006a657e : MOV EAX,EDI
006a6580 : POP EDI
006a6581 : POP EBP
006a6582 : POP EBX
006a6583 : ADD ESP,0x20
006a6586 : RET

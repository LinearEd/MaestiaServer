PROGRAM  : Maestia.exe
FUNCTION : FUN_00519660
ENTRY    : 00519660
BODY     : [[00519660, 0051984b]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00519660(int param_1,int param_2)

{
  uint3 uVar1;
  byte bVar2;
  byte bVar3;
  byte bVar4;
  byte bVar5;
  int iVar6;
  uint uVar7;
  undefined3 *puVar8;
  undefined3 *puVar9;
  int local_14;
  int local_10;
  uint local_c;
  int local_8;
  int local_4;
  
  iVar6 = *(int *)(param_1 + 8);
  if (((iVar6 < 10) || (0xc < iVar6)) && ((iVar6 == 1 || (iVar6 == 2)))) {
    bVar2 = FUN_005194a0();
    bVar3 = FUN_005194a0();
    bVar4 = FUN_005194a0();
    bVar5 = FUN_005194a0();
    local_c = 0;
    if (*(int *)(param_1 + 0x20) != 0) {
      do {
        uVar7 = local_c;
        iVar6 = FUN_00519580(local_c,&local_14,&local_8,&local_4);
        if (iVar6 == 0) {
          return 0;
        }
        if (local_8 != 0) {
          puVar9 = (undefined3 *)(iVar6 + 1);
          local_10 = local_8;
          do {
            if (*(int *)(param_1 + 8) == 2) {
              if (local_14 * 3 != 0) {
                iVar6 = (local_14 * 3 - 1U) / 3 + 1;
                puVar8 = puVar9;
                do {
                  uVar1 = CONCAT21(*(undefined2 *)puVar8,*(undefined1 *)((int)puVar8 + -1));
                  *(char *)((int)puVar8 + 1) = (char)(uVar1 >> (bVar4 & 0x1f));
                  iVar6 = iVar6 + -1;
                  *(char *)puVar8 = (char)(uVar1 >> (bVar3 & 0x1f));
                  *(char *)((int)puVar8 + -1) = (char)(uVar1 >> (bVar2 & 0x1f));
                  puVar8 = (undefined3 *)((int)puVar8 + 3);
                } while (iVar6 != 0);
              }
            }
            else if ((*(int *)(param_1 + 8) == 1) && (local_14 * 4 != 0)) {
              iVar6 = (local_14 * 4 - 1U >> 2) + 1;
              puVar8 = puVar9;
              do {
                uVar7 = CONCAT31(*puVar8,*(undefined1 *)((int)puVar8 + -1));
                *(char *)((int)puVar8 + 1) = (char)(uVar7 >> (bVar4 & 0x1f));
                *(char *)puVar8 = (char)(uVar7 >> (bVar3 & 0x1f));
                *(char *)((int)puVar8 + -1) = (char)(uVar7 >> (bVar2 & 0x1f));
                if (*(char *)(param_2 + 0x14) == '\0') {
                  *(undefined1 *)((int)puVar8 + 2) = 0xff;
                }
                else {
                  *(char *)((int)puVar8 + 2) = (char)(uVar7 >> (bVar5 & 0x1f));
                }
                puVar8 = puVar8 + 1;
                iVar6 = iVar6 + -1;
              } while (iVar6 != 0);
            }
            puVar9 = (undefined3 *)((int)puVar9 + local_4);
            local_10 = local_10 + -1;
          } while (local_10 != 0);
          local_10 = 0;
          uVar7 = local_c;
        }
        local_c = uVar7 + 1;
      } while (local_c < *(uint *)(param_1 + 0x20));
    }
  }
  return 1;
}



============================================================
DISASSEMBLY
============================================================
00519660 : SUB ESP,0x20
00519663 : PUSH EBX
00519664 : MOV EBX,dword ptr [ESP + 0x28]
00519668 : MOV EAX,dword ptr [EBX + 0x8]
0051966b : CMP EAX,0xa
0051966e : PUSH EBP
0051966f : PUSH ESI
00519670 : PUSH EDI
00519671 : JL 0x0051967c
00519673 : CMP EAX,0xc
00519676 : JLE 0x00519838
0051967c : CMP EAX,0x1
0051967f : JZ 0x0051968a
00519681 : CMP EAX,0x2
00519684 : JNZ 0x00519838
0051968a : MOV ESI,dword ptr [ESP + 0x38]
0051968e : MOV ECX,dword ptr [ESI + 0x4]
00519691 : CALL 0x005194a0
00519696 : MOV ECX,dword ptr [ESI + 0x8]
00519699 : MOV byte ptr [ESP + 0x12],AL
0051969d : CALL 0x005194a0
005196a2 : MOV ECX,dword ptr [ESI + 0xc]
005196a5 : MOV byte ptr [ESP + 0x11],AL
005196a9 : CALL 0x005194a0
005196ae : MOV ECX,dword ptr [ESI + 0x10]
005196b1 : MOV byte ptr [ESP + 0x10],AL
005196b5 : CALL 0x005194a0
005196ba : XOR ESI,ESI
005196bc : MOV byte ptr [ESP + 0x13],AL
005196c0 : MOV dword ptr [ESP + 0x24],ESI
005196c4 : CMP dword ptr [EBX + 0x20],ESI
005196c7 : JBE 0x00519838
005196cd : LEA ECX,[ECX]
005196d0 : LEA EAX,[ESP + 0x2c]
005196d4 : PUSH EAX
005196d5 : LEA ECX,[ESP + 0x2c]
005196d9 : PUSH ECX
005196da : LEA EDX,[ESP + 0x24]
005196de : PUSH EDX
005196df : PUSH ESI
005196e0 : LEA ECX,[EBX + 0x8]
005196e3 : CALL 0x00519580
005196e8 : TEST EAX,EAX
005196ea : JZ 0x00519842
005196f0 : MOV ECX,dword ptr [ESP + 0x28]
005196f4 : TEST ECX,ECX
005196f6 : JBE 0x0051982a
005196fc : LEA ESI,[EAX + 0x1]
005196ff : MOV dword ptr [ESP + 0x18],ESI
00519703 : MOV dword ptr [ESP + 0x20],ECX
00519707 : MOV EAX,dword ptr [EBX + 0x8]
0051970a : CMP EAX,0x2
0051970d : JNZ 0x0051977d
0051970f : MOV EAX,dword ptr [ESP + 0x1c]
00519713 : LEA EAX,[EAX + EAX*0x2]
00519716 : TEST EAX,EAX
00519718 : JBE 0x00519813
0051971e : MOVZX ECX,byte ptr [ESP + 0x12]
00519723 : MOVZX EBP,byte ptr [ESP + 0x10]
00519728 : MOVZX EBX,byte ptr [ESP + 0x11]
0051972d : LEA EDX,[EAX + -0x1]
00519730 : MOV EAX,0xaaaaaaab
00519735 : MUL EDX
00519737 : MOV EDI,EDX
00519739 : SHR EDI,0x1
0051973b : MOV dword ptr [ESP + 0x14],ECX
0051973f : INC EDI
00519740 : MOVZX EAX,byte ptr [ESI + 0x1]
00519744 : MOVZX ECX,byte ptr [ESI]
00519747 : MOVZX EDX,byte ptr [ESI + -0x1]
0051974b : SHL EAX,0x8
0051974e : OR EAX,ECX
00519750 : SHL EAX,0x8
00519753 : OR EAX,EDX
00519755 : MOV EDX,EAX
00519757 : MOV ECX,EBP
00519759 : SHR EDX,CL
0051975b : MOV ECX,EBX
0051975d : ADD ESI,0x3
00519760 : MOV byte ptr [ESI + -0x2],DL
00519763 : MOV EDX,EAX
00519765 : SHR EDX,CL
00519767 : MOV ECX,dword ptr [ESP + 0x14]
0051976b : SHR EAX,CL
0051976d : SUB EDI,0x1
00519770 : MOV byte ptr [ESI + -0x3],DL
00519773 : MOV byte ptr [ESI + -0x4],AL
00519776 : JNZ 0x00519740
00519778 : JMP 0x0051980b
0051977d : CMP EAX,0x1
00519780 : JNZ 0x00519813
00519786 : MOV EDI,dword ptr [ESP + 0x1c]
0051978a : ADD EDI,EDI
0051978c : ADD EDI,EDI
0051978e : JZ 0x00519813
00519794 : MOVZX EAX,byte ptr [ESP + 0x12]
00519799 : MOVZX EBP,byte ptr [ESP + 0x10]
0051979e : MOVZX EDX,byte ptr [ESP + 0x11]
005197a3 : DEC EDI
005197a4 : SHR EDI,0x2
005197a7 : MOV dword ptr [ESP + 0x14],EAX
005197ab : INC EDI
005197ac : LEA ESP,[ESP]
005197b0 : MOVZX EAX,byte ptr [ESI + 0x2]
005197b4 : MOVZX ECX,byte ptr [ESI + 0x1]
005197b8 : SHL EAX,0x8
005197bb : OR EAX,ECX
005197bd : MOVZX ECX,byte ptr [ESI]
005197c0 : SHL EAX,0x8
005197c3 : OR EAX,ECX
005197c5 : MOVZX ECX,byte ptr [ESI + -0x1]
005197c9 : SHL EAX,0x8
005197cc : OR EAX,ECX
005197ce : MOV ECX,EBP
005197d0 : MOV EBX,EAX
005197d2 : SHR EBX,CL
005197d4 : MOV ECX,EDX
005197d6 : MOV byte ptr [ESI + 0x1],BL
005197d9 : MOV EBX,EAX
005197db : SHR EBX,CL
005197dd : MOV ECX,dword ptr [ESP + 0x14]
005197e1 : MOV byte ptr [ESI],BL
005197e3 : MOV EBX,EAX
005197e5 : SHR EBX,CL
005197e7 : MOV ECX,dword ptr [ESP + 0x38]
005197eb : MOV byte ptr [ESI + -0x1],BL
005197ee : CMP byte ptr [ECX + 0x14],0x0
005197f2 : JZ 0x005197ff
005197f4 : MOV CL,byte ptr [ESP + 0x13]
005197f8 : SHR EAX,CL
005197fa : MOV byte ptr [ESI + 0x2],AL
005197fd : JMP 0x00519803
005197ff : MOV byte ptr [ESI + 0x2],0xff
00519803 : ADD ESI,0x4
00519806 : SUB EDI,0x1
00519809 : JNZ 0x005197b0
0051980b : MOV EBX,dword ptr [ESP + 0x34]
0051980f : MOV ESI,dword ptr [ESP + 0x18]
00519813 : ADD ESI,dword ptr [ESP + 0x2c]
00519817 : SUB dword ptr [ESP + 0x20],0x1
0051981c : MOV dword ptr [ESP + 0x18],ESI
00519820 : JNZ 0x00519707
00519826 : MOV ESI,dword ptr [ESP + 0x24]
0051982a : INC ESI
0051982b : MOV dword ptr [ESP + 0x24],ESI
0051982f : CMP ESI,dword ptr [EBX + 0x20]
00519832 : JC 0x005196d0
00519838 : POP EDI
00519839 : POP ESI
0051983a : POP EBP
0051983b : MOV AL,0x1
0051983d : POP EBX
0051983e : ADD ESP,0x20
00519841 : RET
00519842 : POP EDI
00519843 : POP ESI
00519844 : POP EBP
00519845 : XOR AL,AL
00519847 : POP EBX
00519848 : ADD ESP,0x20
0051984b : RET

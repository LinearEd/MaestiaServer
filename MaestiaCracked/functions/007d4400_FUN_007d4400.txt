PROGRAM  : Maestia.exe
FUNCTION : FUN_007d4400
ENTRY    : 007d4400
BODY     : [[007d4400, 007d4521]]

============================================================
DECOMPILED C CODE
============================================================

undefined4
FUN_007d4400(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
            undefined4 param_5)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int *piVar3;
  char cVar4;
  uint uVar5;
  int iVar6;
  int in_ECX;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b0f0ff;
  local_10 = ExceptionList;
  uVar5 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(int *)(in_ECX + 8) != 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  local_8 = 0;
  puVar1 = *(undefined4 **)(in_ECX + 0x188);
  puVar2 = (undefined4 *)*puVar1;
  while( true ) {
    if (puVar2 == puVar1) {
      local_8 = 0xffffffff;
      if (*(int *)(in_ECX + 8) != 0) {
        LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
      }
      puVar1 = *(undefined4 **)(in_ECX + 0x38);
      puVar2 = (undefined4 *)*puVar1;
      while( true ) {
        if (puVar2 == puVar1) {
          ExceptionList = local_10;
          return 0;
        }
        piVar3 = (int *)puVar2[9];
        iVar6 = (**(code **)(*piVar3 + 0x1c))();
        if ((iVar6 - 2U < 8) &&
           (cVar4 = (**(code **)(*piVar3 + 0x104))(param_1,param_2,param_3,param_4,param_5),
           cVar4 != '\0')) break;
        puVar2 = (undefined4 *)*puVar2;
      }
      ExceptionList = local_10;
      return 1;
    }
    cVar4 = (**(code **)(*(int *)puVar2[9] + 0x54))(param_1,param_2,param_3,param_4,param_5,uVar5);
    if (cVar4 != '\0') break;
    puVar2 = (undefined4 *)*puVar2;
  }
  local_8 = 0xffffffff;
  if (*(int *)(in_ECX + 8) == 0) {
    ExceptionList = local_10;
    return 1;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  ExceptionList = local_10;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
007d4400 : PUSH EBP
007d4401 : MOV EBP,ESP
007d4403 : PUSH -0x1
007d4405 : PUSH 0xb0f0ff
007d440a : MOV EAX,FS:[0x0]
007d4410 : PUSH EAX
007d4411 : PUSH ECX
007d4412 : PUSH EBX
007d4413 : PUSH ESI
007d4414 : PUSH EDI
007d4415 : MOV EAX,[0x00d66fa0]
007d441a : XOR EAX,EBP
007d441c : PUSH EAX
007d441d : LEA EAX,[EBP + -0xc]
007d4420 : MOV FS:[0x0],EAX
007d4426 : MOV EBX,ECX
007d4428 : MOV EAX,dword ptr [EBX + 0x8]
007d442b : MOV dword ptr [EBP + -0x10],EBX
007d442e : TEST EAX,EAX
007d4430 : JZ 0x007d443c
007d4432 : ADD EAX,0x4
007d4435 : PUSH EAX
007d4436 : CALL dword ptr [0x00b85118]
007d443c : MOV dword ptr [EBP + -0x4],0x0
007d4443 : MOV EDI,dword ptr [EBX + 0x188]
007d4449 : MOV ESI,dword ptr [EDI]
007d444b : CMP ESI,EDI
007d444d : JZ 0x007d447c
007d444f : NOP
007d4450 : MOV EDX,dword ptr [EBP + 0x18]
007d4453 : MOV ECX,dword ptr [ESI + 0x24]
007d4456 : MOV EAX,dword ptr [ECX]
007d4458 : MOV EAX,dword ptr [EAX + 0x54]
007d445b : PUSH EDX
007d445c : MOV EDX,dword ptr [EBP + 0x14]
007d445f : PUSH EDX
007d4460 : MOV EDX,dword ptr [EBP + 0x10]
007d4463 : PUSH EDX
007d4464 : MOV EDX,dword ptr [EBP + 0xc]
007d4467 : PUSH EDX
007d4468 : MOV EDX,dword ptr [EBP + 0x8]
007d446b : PUSH EDX
007d446c : CALL EAX
007d446e : TEST AL,AL
007d4470 : JNZ 0x007d44f4
007d4476 : MOV ESI,dword ptr [ESI]
007d4478 : CMP ESI,EDI
007d447a : JNZ 0x007d4450
007d447c : MOV dword ptr [EBP + -0x4],0xffffffff
007d4483 : MOV EAX,dword ptr [EBX + 0x8]
007d4486 : TEST EAX,EAX
007d4488 : JZ 0x007d4494
007d448a : ADD EAX,0x4
007d448d : PUSH EAX
007d448e : CALL dword ptr [0x00b8511c]
007d4494 : MOV EBX,dword ptr [EBX + 0x38]
007d4497 : MOV EDI,dword ptr [EBX]
007d4499 : CMP EDI,EBX
007d449b : JZ 0x007d44de
007d449d : LEA ECX,[ECX]
007d44a0 : MOV ESI,dword ptr [EDI + 0x24]
007d44a3 : MOV EDX,dword ptr [ESI]
007d44a5 : MOV EAX,dword ptr [EDX + 0x1c]
007d44a8 : MOV ECX,ESI
007d44aa : CALL EAX
007d44ac : ADD EAX,-0x2
007d44af : CMP EAX,0x7
007d44b2 : JA 0x007d44d8
007d44b4 : MOV EAX,dword ptr [EBP + 0x18]
007d44b7 : MOV ECX,dword ptr [EBP + 0x14]
007d44ba : MOV EDX,dword ptr [ESI]
007d44bc : MOV EDX,dword ptr [EDX + 0x104]
007d44c2 : PUSH EAX
007d44c3 : MOV EAX,dword ptr [EBP + 0x10]
007d44c6 : PUSH ECX
007d44c7 : MOV ECX,dword ptr [EBP + 0xc]
007d44ca : PUSH EAX
007d44cb : MOV EAX,dword ptr [EBP + 0x8]
007d44ce : PUSH ECX
007d44cf : PUSH EAX
007d44d0 : MOV ECX,ESI
007d44d2 : CALL EDX
007d44d4 : TEST AL,AL
007d44d6 : JNZ 0x007d450c
007d44d8 : MOV EDI,dword ptr [EDI]
007d44da : CMP EDI,EBX
007d44dc : JNZ 0x007d44a0
007d44de : XOR AL,AL
007d44e0 : MOV ECX,dword ptr [EBP + -0xc]
007d44e3 : MOV dword ptr FS:[0x0],ECX
007d44ea : POP ECX
007d44eb : POP EDI
007d44ec : POP ESI
007d44ed : POP EBX
007d44ee : MOV ESP,EBP
007d44f0 : POP EBP
007d44f1 : RET 0x14
007d44f4 : MOV dword ptr [EBP + -0x4],0xffffffff
007d44fb : MOV EBX,dword ptr [EBX + 0x8]
007d44fe : TEST EBX,EBX
007d4500 : JZ 0x007d450c
007d4502 : ADD EBX,0x4
007d4505 : PUSH EBX
007d4506 : CALL dword ptr [0x00b8511c]
007d450c : MOV AL,0x1
007d450e : MOV ECX,dword ptr [EBP + -0xc]
007d4511 : MOV dword ptr FS:[0x0],ECX
007d4518 : POP ECX
007d4519 : POP EDI
007d451a : POP ESI
007d451b : POP EBX
007d451c : MOV ESP,EBP
007d451e : POP EBP
007d451f : RET 0x14

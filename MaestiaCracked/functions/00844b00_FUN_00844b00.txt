PROGRAM  : Maestia.exe
FUNCTION : FUN_00844b00
ENTRY    : 00844b00
BODY     : [[00844b00, 00844e87]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00844b00(int param_1)

{
  int iVar1;
  int *piVar2;
  DWORD DVar3;
  undefined1 local_30 [20];
  int local_1c;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  piVar2 = DAT_00da9894;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b440a5;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(int *)(param_1 + 8) == 0) goto LAB_00844e6a;
  *(undefined4 *)(param_1 + 8) = 0;
  if (*(int *)(*piVar2 + 0x1a8) != 0) {
    FUN_009adfc0();
  }
  FUN_00843a80();
  *(undefined4 *)(param_1 + 0x1c) = 0;
  FUN_008787b0();
  if (*(int *)(param_1 + 0x34) != 0) {
    *(undefined1 *)(*(int *)(param_1 + 0x34) + 0x20d) = 1;
  }
  if (*(int *)(param_1 + 0x30) != 0) {
    piVar2 = (int *)FUN_00a1a840();
    if (piVar2 == (int *)0x0) {
      piVar2 = (int *)FUN_00a1a6d0();
      if (piVar2 != (int *)0x0) goto LAB_00844bbc;
      piVar2 = (int *)FUN_00a1a780();
      if (piVar2 != (int *)0x0) goto LAB_00844bbc;
    }
    else {
LAB_00844bbc:
      if (piVar2[0x100] != 0) {
        *(undefined1 *)(piVar2[0x100] + 0x20d) = 1;
      }
    }
    *(undefined4 *)(param_1 + 0x68) = 0;
    if (piVar2 != (int *)0x0) {
      (**(code **)(*piVar2 + 0x418))();
      FUN_00405660();
      local_8 = 0;
      if (local_1c != 0) {
        FUN_00405660(local_30);
        local_8 = local_8 & 0xffffff00;
        FUN_0089f810();
      }
      local_8 = 0xffffffff;
      FUN_00406560();
    }
    *(undefined4 *)(param_1 + 0x30) = 0;
  }
  if (*(char *)((int)*(int **)(*DAT_00da9894 + 0x208) + 0x32) != '\0') {
    (**(code **)(**(int **)(*DAT_00da9894 + 0x208) + 0x10))();
    (**(code **)(**(int **)(*DAT_00da9894 + 0x208) + 0x20))();
  }
  if (*(char *)((int)*(int **)(*DAT_00da9894 + 0x20c) + 0x32) != '\0') {
    (**(code **)(**(int **)(*DAT_00da9894 + 0x20c) + 0x10))();
    (**(code **)(**(int **)(*DAT_00da9894 + 0x20c) + 0x20))();
  }
  iVar1 = *DAT_00da9894;
  piVar2 = *(int **)(iVar1 + 0x114);
  if (piVar2 != (int *)0x0) {
    (**(code **)(*piVar2 + 4))();
  }
  if (*(char *)(*(int *)(iVar1 + 0x214) + 0x32) != '\0') {
    iVar1 = *DAT_00da9894;
    piVar2 = *(int **)(iVar1 + 0x114);
    if (piVar2 != (int *)0x0) {
      (**(code **)(*piVar2 + 4))();
    }
    (**(code **)(**(int **)(iVar1 + 0x214) + 0x10))();
    iVar1 = *DAT_00da9894;
    piVar2 = *(int **)(iVar1 + 0x114);
    if (piVar2 != (int *)0x0) {
      (**(code **)(*piVar2 + 4))();
    }
    (**(code **)(**(int **)(iVar1 + 0x214) + 0x20))();
  }
  iVar1 = *DAT_00da9894;
  piVar2 = *(int **)(iVar1 + 0x114);
  if (piVar2 != (int *)0x0) {
    (**(code **)(*piVar2 + 4))();
  }
  if (*(char *)(*(int *)(iVar1 + 0x218) + 0x32) != '\0') {
    iVar1 = *DAT_00da9894;
    piVar2 = *(int **)(iVar1 + 0x114);
    if (piVar2 != (int *)0x0) {
      (**(code **)(*piVar2 + 4))();
    }
    (**(code **)(**(int **)(iVar1 + 0x218) + 0x10))();
    iVar1 = *DAT_00da9894;
    piVar2 = *(int **)(iVar1 + 0x114);
    if (piVar2 != (int *)0x0) {
      (**(code **)(*piVar2 + 4))();
    }
    (**(code **)(**(int **)(iVar1 + 0x218) + 0x20))();
  }
  if (*(char *)((int)*(int **)(*DAT_00da9894 + 0x210) + 0x32) != '\0') {
    (**(code **)(**(int **)(*DAT_00da9894 + 0x210) + 0x10))();
    (**(code **)(**(int **)(*DAT_00da9894 + 0x210) + 0x20))();
  }
  FUN_008767b0();
  iVar1 = DAT_00da93ec;
  if (*(int *)(DAT_00da93ec + 0x6e8) == 0) {
    FUN_008765f0();
  }
  else {
    *(undefined1 *)(DAT_00da93ec + 0x6dc) = 1;
    *(undefined4 *)(iVar1 + 0x6e0) = 0xff;
    DVar3 = GetTickCount();
    *(DWORD *)(iVar1 + 0x6e4) = DVar3;
  }
  *(undefined4 *)(param_1 + 0x44) = 0;
  *(undefined4 *)(param_1 + 0x4c) = 0;
  FUN_008441c0();
  FUN_00854ed0();
LAB_00844e6a:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00844b00 : PUSH EBP
00844b01 : MOV EBP,ESP
00844b03 : PUSH -0x1
00844b05 : PUSH 0xb440a5
00844b0a : MOV EAX,FS:[0x0]
00844b10 : PUSH EAX
00844b11 : SUB ESP,0x28
00844b14 : MOV EAX,[0x00d66fa0]
00844b19 : XOR EAX,EBP
00844b1b : MOV dword ptr [EBP + -0x10],EAX
00844b1e : PUSH EBX
00844b1f : PUSH ESI
00844b20 : PUSH EDI
00844b21 : PUSH EAX
00844b22 : LEA EAX,[EBP + -0xc]
00844b25 : MOV FS:[0x0],EAX
00844b2b : MOV EBX,dword ptr [EBP + 0x8]
00844b2e : XOR ESI,ESI
00844b30 : CMP dword ptr [EBX + 0x8],ESI
00844b33 : JZ 0x00844e6a
00844b39 : MOV EAX,[0x00da9894]
00844b3e : MOV dword ptr [EBX + 0x8],ESI
00844b41 : MOV EAX,dword ptr [EAX]
00844b43 : CMP dword ptr [EAX + 0x1a8],ESI
00844b49 : JZ 0x00844b61
00844b4b : MOV EAX,dword ptr [EAX + 0x1a8]
00844b51 : PUSH 0x17
00844b53 : PUSH EAX
00844b54 : MOV ECX,0xc3b234
00844b59 : CALL 0x009adfc0
00844b5e : ADD ESP,0x8
00844b61 : MOV EAX,EBX
00844b63 : CALL 0x00843a80
00844b68 : MOV ECX,dword ptr [EBX + 0x24]
00844b6b : MOV dword ptr [EBX + 0x1c],ESI
00844b6e : MOV EDI,dword ptr [ECX + 0x41c]
00844b74 : CALL 0x008787b0
00844b79 : MOV EAX,dword ptr [EBX + 0x34]
00844b7c : CMP EAX,ESI
00844b7e : JZ 0x00844b87
00844b80 : MOV byte ptr [EAX + 0x20d],0x1
00844b87 : MOV ESI,dword ptr [EBX + 0x30]
00844b8a : TEST ESI,ESI
00844b8c : JZ 0x00844c2e
00844b92 : MOV ECX,dword ptr [0x00da93ec]
00844b98 : PUSH ESI
00844b99 : MOV EDI,ECX
00844b9b : CALL 0x00a1a840
00844ba0 : TEST EAX,EAX
00844ba2 : JNZ 0x00844bbc
00844ba4 : PUSH ESI
00844ba5 : MOV ECX,EDI
00844ba7 : CALL 0x00a1a6d0
00844bac : TEST EAX,EAX
00844bae : JNZ 0x00844bbc
00844bb0 : PUSH ESI
00844bb1 : MOV ECX,EDI
00844bb3 : CALL 0x00a1a780
00844bb8 : TEST EAX,EAX
00844bba : JZ 0x00844bcd
00844bbc : MOV ECX,dword ptr [EAX + 0x400]
00844bc2 : TEST ECX,ECX
00844bc4 : JZ 0x00844bcd
00844bc6 : MOV byte ptr [ECX + 0x20d],0x1
00844bcd : MOV dword ptr [EBX + 0x68],0x0
00844bd4 : TEST EAX,EAX
00844bd6 : JZ 0x00844c27
00844bd8 : MOV EDX,dword ptr [EAX]
00844bda : MOV ECX,EAX
00844bdc : MOV EAX,dword ptr [EDX + 0x418]
00844be2 : CALL EAX
00844be4 : PUSH EAX
00844be5 : LEA ECX,[EBP + -0x2c]
00844be8 : CALL 0x00405660
00844bed : MOV dword ptr [EBP + -0x4],0x0
00844bf4 : CMP dword ptr [EBP + -0x18],0x0
00844bf8 : JBE 0x00844c18
00844bfa : SUB ESP,0x1c
00844bfd : LEA EDX,[EBP + -0x2c]
00844c00 : MOV ECX,ESP
00844c02 : MOV dword ptr [EBP + -0x30],ESP
00844c05 : PUSH EDX
00844c06 : CALL 0x00405660
00844c0b : MOV byte ptr [EBP + -0x4],0x1
00844c0f : MOV byte ptr [EBP + -0x4],0x0
00844c13 : CALL 0x0089f810
00844c18 : MOV dword ptr [EBP + -0x4],0xffffffff
00844c1f : LEA ECX,[EBP + -0x2c]
00844c22 : CALL 0x00406560
00844c27 : MOV dword ptr [EBX + 0x30],0x0
00844c2e : MOV EAX,[0x00da9894]
00844c33 : MOV ECX,dword ptr [EAX]
00844c35 : MOV ECX,dword ptr [ECX + 0x208]
00844c3b : CMP byte ptr [ECX + 0x32],0x0
00844c3f : JZ 0x00844c5d
00844c41 : MOV EDX,dword ptr [ECX]
00844c43 : MOV EAX,dword ptr [EDX + 0x10]
00844c46 : CALL EAX
00844c48 : MOV ECX,dword ptr [0x00da9894]
00844c4e : MOV EDX,dword ptr [ECX]
00844c50 : MOV ECX,dword ptr [EDX + 0x208]
00844c56 : MOV EAX,dword ptr [ECX]
00844c58 : MOV EDX,dword ptr [EAX + 0x20]
00844c5b : CALL EDX
00844c5d : MOV EAX,[0x00da9894]
00844c62 : MOV ECX,dword ptr [EAX]
00844c64 : MOV ECX,dword ptr [ECX + 0x20c]
00844c6a : CMP byte ptr [ECX + 0x32],0x0
00844c6e : JZ 0x00844c8c
00844c70 : MOV EDX,dword ptr [ECX]
00844c72 : MOV EAX,dword ptr [EDX + 0x10]
00844c75 : CALL EAX
00844c77 : MOV ECX,dword ptr [0x00da9894]
00844c7d : MOV EDX,dword ptr [ECX]
00844c7f : MOV ECX,dword ptr [EDX + 0x20c]
00844c85 : MOV EAX,dword ptr [ECX]
00844c87 : MOV EDX,dword ptr [EAX + 0x20]
00844c8a : CALL EDX
00844c8c : MOV EAX,[0x00da9894]
00844c91 : MOV ESI,dword ptr [EAX]
00844c93 : MOV EAX,dword ptr [ESI + 0x114]
00844c99 : XOR EDI,EDI
00844c9b : CMP EAX,EDI
00844c9d : JZ 0x00844cb9
00844c9f : MOV ECX,dword ptr [EAX]
00844ca1 : MOV EDX,dword ptr [ECX + 0x4]
00844ca4 : PUSH 0xcce57c
00844ca9 : PUSH 0xcce590
00844cae : PUSH 0xcce594
00844cb3 : PUSH EAX
00844cb4 : CALL EDX
00844cb6 : ADD ESP,0x10
00844cb9 : MOV EAX,dword ptr [ESI + 0x214]
00844cbf : CMP byte ptr [EAX + 0x32],0x0
00844cc3 : JZ 0x00844d37
00844cc5 : MOV ECX,dword ptr [0x00da9894]
00844ccb : MOV ESI,dword ptr [ECX]
00844ccd : MOV EAX,dword ptr [ESI + 0x114]
00844cd3 : CMP EAX,EDI
00844cd5 : JZ 0x00844cf1
00844cd7 : MOV EDX,dword ptr [EAX]
00844cd9 : PUSH 0xcce57c
00844cde : PUSH 0xcce590
00844ce3 : PUSH 0xcce594
00844ce8 : PUSH EAX
00844ce9 : MOV EAX,dword ptr [EDX + 0x4]
00844cec : CALL EAX
00844cee : ADD ESP,0x10
00844cf1 : MOV ECX,dword ptr [ESI + 0x214]
00844cf7 : MOV EDX,dword ptr [ECX]
00844cf9 : MOV EAX,dword ptr [EDX + 0x10]
00844cfc : CALL EAX
00844cfe : MOV ECX,dword ptr [0x00da9894]
00844d04 : MOV ESI,dword ptr [ECX]
00844d06 : MOV EAX,dword ptr [ESI + 0x114]
00844d0c : CMP EAX,EDI
00844d0e : JZ 0x00844d2a
00844d10 : MOV EDX,dword ptr [EAX]
00844d12 : PUSH 0xcce57c
00844d17 : PUSH 0xcce590
00844d1c : PUSH 0xcce594
00844d21 : PUSH EAX
00844d22 : MOV EAX,dword ptr [EDX + 0x4]
00844d25 : CALL EAX
00844d27 : ADD ESP,0x10
00844d2a : MOV ECX,dword ptr [ESI + 0x214]
00844d30 : MOV EDX,dword ptr [ECX]
00844d32 : MOV EAX,dword ptr [EDX + 0x20]
00844d35 : CALL EAX
00844d37 : MOV ECX,dword ptr [0x00da9894]
00844d3d : MOV ESI,dword ptr [ECX]
00844d3f : MOV EAX,dword ptr [ESI + 0x114]
00844d45 : CMP EAX,EDI
00844d47 : JZ 0x00844d63
00844d49 : MOV EDX,dword ptr [EAX]
00844d4b : PUSH 0xcce57c
00844d50 : PUSH 0xcce590
00844d55 : PUSH 0xcce594
00844d5a : PUSH EAX
00844d5b : MOV EAX,dword ptr [EDX + 0x4]
00844d5e : CALL EAX
00844d60 : ADD ESP,0x10
00844d63 : MOV ECX,dword ptr [ESI + 0x218]
00844d69 : CMP byte ptr [ECX + 0x32],0x0
00844d6d : JZ 0x00844de0
00844d6f : MOV EDX,dword ptr [0x00da9894]
00844d75 : MOV ESI,dword ptr [EDX]
00844d77 : MOV EAX,dword ptr [ESI + 0x114]
00844d7d : CMP EAX,EDI
00844d7f : JZ 0x00844d9b
00844d81 : MOV ECX,dword ptr [EAX]
00844d83 : MOV EDX,dword ptr [ECX + 0x4]
00844d86 : PUSH 0xcce57c
00844d8b : PUSH 0xcce590
00844d90 : PUSH 0xcce594
00844d95 : PUSH EAX
00844d96 : CALL EDX
00844d98 : ADD ESP,0x10
00844d9b : MOV ECX,dword ptr [ESI + 0x218]
00844da1 : MOV EAX,dword ptr [ECX]
00844da3 : MOV EDX,dword ptr [EAX + 0x10]
00844da6 : CALL EDX
00844da8 : MOV EAX,[0x00da9894]
00844dad : MOV ESI,dword ptr [EAX]
00844daf : MOV EAX,dword ptr [ESI + 0x114]
00844db5 : CMP EAX,EDI
00844db7 : JZ 0x00844dd3
00844db9 : MOV ECX,dword ptr [EAX]
00844dbb : MOV EDX,dword ptr [ECX + 0x4]
00844dbe : PUSH 0xcce57c
00844dc3 : PUSH 0xcce590
00844dc8 : PUSH 0xcce594
00844dcd : PUSH EAX
00844dce : CALL EDX
00844dd0 : ADD ESP,0x10
00844dd3 : MOV ECX,dword ptr [ESI + 0x218]
00844dd9 : MOV EAX,dword ptr [ECX]
00844ddb : MOV EDX,dword ptr [EAX + 0x20]
00844dde : CALL EDX
00844de0 : MOV EAX,[0x00da9894]
00844de5 : MOV ECX,dword ptr [EAX]
00844de7 : MOV ECX,dword ptr [ECX + 0x210]
00844ded : CMP byte ptr [ECX + 0x32],0x0
00844df1 : JZ 0x00844e0f
00844df3 : MOV EDX,dword ptr [ECX]
00844df5 : MOV EAX,dword ptr [EDX + 0x10]
00844df8 : CALL EAX
00844dfa : MOV ECX,dword ptr [0x00da9894]
00844e00 : MOV EDX,dword ptr [ECX]
00844e02 : MOV ECX,dword ptr [EDX + 0x210]
00844e08 : MOV EAX,dword ptr [ECX]
00844e0a : MOV EDX,dword ptr [EAX + 0x20]
00844e0d : CALL EDX
00844e0f : MOV EAX,[0x00da93ec]
00844e14 : ADD EAX,0x6a8
00844e19 : CALL 0x008767b0
00844e1e : MOV ESI,dword ptr [0x00da93ec]
00844e24 : ADD ESI,0x6a8
00844e2a : CMP dword ptr [ESI + 0x40],EDI
00844e2d : JNZ 0x00844e36
00844e2f : CALL 0x008765f0
00844e34 : JMP 0x00844e4a
00844e36 : MOV byte ptr [ESI + 0x34],0x1
00844e3a : MOV dword ptr [ESI + 0x38],0xff
00844e41 : CALL dword ptr [0x00b850d8]
00844e47 : MOV dword ptr [ESI + 0x3c],EAX
00844e4a : MOV dword ptr [EBX + 0x44],EDI
00844e4d : MOV dword ptr [EBX + 0x4c],EDI
00844e50 : MOV EDI,EBX
00844e52 : CALL 0x008441c0
00844e57 : MOV EAX,[0x00da93ec]
00844e5c : MOV ECX,dword ptr [EAX + 0xac]
00844e62 : PUSH 0x1
00844e64 : PUSH ECX
00844e65 : CALL 0x00854ed0
00844e6a : MOV ECX,dword ptr [EBP + -0xc]
00844e6d : MOV dword ptr FS:[0x0],ECX
00844e74 : POP ECX
00844e75 : POP EDI
00844e76 : POP ESI
00844e77 : POP EBX
00844e78 : MOV ECX,dword ptr [EBP + -0x10]
00844e7b : XOR ECX,EBP
00844e7d : CALL 0x00633e6b
00844e82 : MOV ESP,EBP
00844e84 : POP EBP
00844e85 : RET 0x4

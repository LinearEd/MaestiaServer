PROGRAM  : Maestia.exe
FUNCTION : FUN_00693580
ENTRY    : 00693580
BODY     : [[00693580, 006936cd]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00693580(int param_1,uint *param_2)

{
  undefined1 *puVar1;
  undefined1 *puVar2;
  undefined1 *puVar3;
  undefined1 *puVar4;
  undefined1 *puVar5;
  undefined1 *puVar6;
  undefined1 *puVar7;
  undefined1 *puVar8;
  uint uVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  uint local_c;
  int local_8;
  int local_4;
  
  iVar12 = *(int *)(param_1 + 0x10);
  local_c = *param_2 + 1;
  local_8 = CONCAT31(CONCAT21(CONCAT11(*(undefined1 *)(iVar12 + 0x200c),
                                       *(undefined1 *)(iVar12 + 0x200d)),
                              *(undefined1 *)(iVar12 + 0x200e)),*(undefined1 *)(iVar12 + 0x200f));
  local_4 = 0;
  if (local_8 == 0) {
    *param_2 = 0;
    return 0;
  }
  puVar8 = (undefined1 *)(iVar12 + 0x200f);
  iVar11 = iVar12 + 0x200e;
  iVar10 = iVar12 + 0x200d;
  iVar12 = iVar12 + 0x200c;
  while( true ) {
    puVar1 = (undefined1 *)(iVar12 + 8);
    uVar9 = CONCAT31(CONCAT21(CONCAT11(*(undefined1 *)(iVar12 + 4),*(undefined1 *)(iVar10 + 4)),
                              *(undefined1 *)(iVar11 + 4)),puVar8[4]);
    puVar2 = (undefined1 *)(iVar10 + 8);
    puVar3 = (undefined1 *)(iVar11 + 8);
    puVar7 = puVar8 + 8;
    puVar8 = puVar8 + 0xc;
    puVar4 = (undefined1 *)(iVar12 + 0xc);
    iVar12 = iVar12 + 0xc;
    puVar5 = (undefined1 *)(iVar10 + 0xc);
    iVar10 = iVar10 + 0xc;
    puVar6 = (undefined1 *)(iVar11 + 0xc);
    iVar11 = iVar11 + 0xc;
    if (local_c < uVar9) {
      local_c = uVar9;
    }
    if ((local_c <= CONCAT31(CONCAT21(CONCAT11(*puVar1,*puVar2),*puVar3),*puVar7)) &&
       (local_4 = (CONCAT31(CONCAT21(CONCAT11(*puVar4,*puVar5),*puVar6),*puVar8) - uVar9) + local_c,
       local_4 != 0)) break;
    local_8 = local_8 + -1;
    if (local_8 == 0) {
      *param_2 = 0;
      return local_4;
    }
  }
  *param_2 = local_c;
  return local_4;
}



============================================================
DISASSEMBLY
============================================================
00693580 : SUB ESP,0xc
00693583 : MOV ECX,dword ptr [ESP + 0x10]
00693587 : PUSH EBX
00693588 : PUSH ESI
00693589 : MOV ESI,dword ptr [ESP + 0x1c]
0069358d : MOV EAX,dword ptr [ESI]
0069358f : PUSH EDI
00693590 : MOV EDI,dword ptr [ECX + 0x10]
00693593 : MOVZX ECX,byte ptr [EDI + 0x200c]
0069359a : MOVZX EBX,byte ptr [EDI + 0x200d]
006935a1 : SHL ECX,0x8
006935a4 : OR ECX,EBX
006935a6 : MOVZX EBX,byte ptr [EDI + 0x200e]
006935ad : SHL ECX,0x8
006935b0 : OR ECX,EBX
006935b2 : MOVZX EBX,byte ptr [EDI + 0x200f]
006935b9 : INC EAX
006935ba : MOV dword ptr [ESP + 0xc],EAX
006935be : XOR EAX,EAX
006935c0 : SHL ECX,0x8
006935c3 : XOR EDX,EDX
006935c5 : OR ECX,EBX
006935c7 : MOV dword ptr [ESP + 0x14],EAX
006935cb : MOV dword ptr [ESP + 0x10],ECX
006935cf : JBE 0x006936c5
006935d5 : PUSH EBP
006935d6 : LEA EAX,[EDI + 0x200f]
006935dc : LEA EBP,[EDI + 0x200e]
006935e2 : LEA EBX,[EDI + 0x200d]
006935e8 : ADD EDI,0x200c
006935ee : JMP 0x006935f4
006935f0 : MOV EAX,dword ptr [ESP + 0x20]
006935f4 : MOVZX ECX,byte ptr [EDI + 0x4]
006935f8 : MOVZX EDX,byte ptr [EBX + 0x4]
006935fc : ADD EDI,0x4
006935ff : MOVZX ESI,byte ptr [EDI + 0x4]
00693603 : ADD EBX,0x4
00693606 : SHL ECX,0x8
00693609 : OR ECX,EDX
0069360b : MOVZX EDX,byte ptr [EBP + 0x4]
0069360f : ADD EBP,0x4
00693612 : ADD EAX,0x4
00693615 : SHL ECX,0x8
00693618 : OR ECX,EDX
0069361a : MOVZX EDX,byte ptr [EAX]
0069361d : ADD EDI,0x4
00693620 : SHL ECX,0x8
00693623 : OR ECX,EDX
00693625 : MOVZX EDX,byte ptr [EBX + 0x4]
00693629 : ADD EBX,0x4
0069362c : SHL ESI,0x8
0069362f : OR ESI,EDX
00693631 : MOVZX EDX,byte ptr [EBP + 0x4]
00693635 : ADD EBP,0x4
00693638 : ADD EAX,0x4
0069363b : SHL ESI,0x8
0069363e : OR ESI,EDX
00693640 : MOVZX EDX,byte ptr [EAX]
00693643 : ADD EAX,0x4
00693646 : SHL ESI,0x8
00693649 : OR ESI,EDX
0069364b : MOVZX EDX,byte ptr [EDI + 0x4]
0069364f : ADD EDI,0x4
00693652 : MOV dword ptr [ESP + 0x20],EAX
00693656 : MOVZX EAX,byte ptr [EBX + 0x4]
0069365a : ADD EBX,0x4
0069365d : SHL EDX,0x8
00693660 : OR EDX,EAX
00693662 : MOVZX EAX,byte ptr [EBP + 0x4]
00693666 : ADD EBP,0x4
00693669 : SHL EDX,0x8
0069366c : OR EDX,EAX
0069366e : MOV EAX,dword ptr [ESP + 0x20]
00693672 : MOVZX EAX,byte ptr [EAX]
00693675 : SHL EDX,0x8
00693678 : OR EDX,EAX
0069367a : MOV EAX,dword ptr [ESP + 0x10]
0069367e : CMP EAX,ECX
00693680 : JNC 0x00693688
00693682 : MOV EAX,ECX
00693684 : MOV dword ptr [ESP + 0x10],EAX
00693688 : CMP EAX,ESI
0069368a : JA 0x00693696
0069368c : SUB EDX,ECX
0069368e : ADD EDX,EAX
00693690 : MOV dword ptr [ESP + 0x18],EDX
00693694 : JNZ 0x006936b5
00693696 : SUB dword ptr [ESP + 0x14],0x1
0069369b : JNZ 0x006935f0
006936a1 : MOV ECX,dword ptr [ESP + 0x24]
006936a5 : POP EBP
006936a6 : POP EDI
006936a7 : XOR EAX,EAX
006936a9 : POP ESI
006936aa : MOV dword ptr [ECX],EAX
006936ac : MOV EAX,dword ptr [ESP + 0xc]
006936b0 : POP EBX
006936b1 : ADD ESP,0xc
006936b4 : RET
006936b5 : MOV ECX,dword ptr [ESP + 0x24]
006936b9 : POP EBP
006936ba : POP EDI
006936bb : POP ESI
006936bc : MOV dword ptr [ECX],EAX
006936be : MOV EAX,EDX
006936c0 : POP EBX
006936c1 : ADD ESP,0xc
006936c4 : RET
006936c5 : POP EDI
006936c6 : MOV dword ptr [ESI],EDX
006936c8 : POP ESI
006936c9 : POP EBX
006936ca : ADD ESP,0xc
006936cd : RET

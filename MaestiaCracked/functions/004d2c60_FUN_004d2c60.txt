PROGRAM  : Maestia.exe
FUNCTION : FUN_004d2c60
ENTRY    : 004d2c60
BODY     : [[004d2c60, 004d2d83] [004d2d95, 004d2e4a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_004d2c60(uint param_1,void *param_2)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  uint uVar6;
  uint extraout_ECX;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  iVar3 = param_1;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b79e70;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  iVar4 = *(int *)(param_1 + 4);
  if (iVar4 == 0) {
    uVar6 = 0;
  }
  else {
    uVar6 = *(int *)(param_1 + 0xc) - iVar4 >> 2;
  }
  iVar2 = *(int *)(param_1 + 8);
  iVar4 = iVar2 - iVar4 >> 2;
  if (iVar4 == 0x3fffffff) {
    iVar4 = FUN_00452880();
    uVar6 = extraout_ECX;
  }
  uVar1 = iVar4 + 1;
  if (uVar1 <= uVar6) {
    if (iVar2 - (int)param_2 >> 2 == 0) {
      FUN_00461070();
      local_8 = 2;
      FUN_004154b0();
      local_8 = 0xffffffff;
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 4;
    }
    else {
      uVar5 = FUN_00461070();
      *(undefined4 *)(param_1 + 8) = uVar5;
      iVar4 = (iVar2 + -4) - (int)param_2 >> 2;
      if (0 < iVar4) {
        _memmove_s((void *)(iVar2 + iVar4 * -4),iVar4 * 4,param_2,iVar4 * 4);
      }
    }
    FUN_00422490(param_2);
    ExceptionList = local_10;
    return;
  }
  if (0x3fffffff - (uVar6 >> 1) < uVar6) {
    param_1 = 0;
  }
  else {
    param_1 = uVar6 + (uVar6 >> 1);
  }
  if (param_1 < uVar1) {
    param_1 = uVar1;
  }
  iVar4 = FUN_004c1790();
  local_8 = 0;
  FUN_004154b0();
  FUN_00461070();
  FUN_00461070();
  local_8 = 0xffffffff;
  if (*(int *)(iVar3 + 4) == 0) {
    *(uint *)(iVar3 + 0xc) = iVar4 + param_1 * 4;
    *(int *)(iVar3 + 8) = iVar4 + ((*(int *)(iVar3 + 8) - *(int *)(iVar3 + 4) >> 2) + 1) * 4;
    *(int *)(iVar3 + 4) = iVar4;
    ExceptionList = local_10;
    return;
  }
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
004d2c60 : PUSH EBP
004d2c61 : MOV EBP,ESP
004d2c63 : PUSH -0x1
004d2c65 : PUSH 0xb79e70
004d2c6a : MOV EAX,FS:[0x0]
004d2c70 : PUSH EAX
004d2c71 : SUB ESP,0x10
004d2c74 : PUSH EBX
004d2c75 : PUSH ESI
004d2c76 : PUSH EDI
004d2c77 : MOV EAX,[0x00d66fa0]
004d2c7c : XOR EAX,EBP
004d2c7e : PUSH EAX
004d2c7f : LEA EAX,[EBP + -0xc]
004d2c82 : MOV FS:[0x0],EAX
004d2c88 : MOV dword ptr [EBP + -0x10],ESP
004d2c8b : MOV EBX,dword ptr [EBP + 0x8]
004d2c8e : MOV EDX,dword ptr [EBX + 0x4]
004d2c91 : XOR EDI,EDI
004d2c93 : CMP EDX,EDI
004d2c95 : JNZ 0x004d2c9b
004d2c97 : XOR ECX,ECX
004d2c99 : JMP 0x004d2ca5
004d2c9b : MOV EAX,dword ptr [EBX + 0xc]
004d2c9e : SUB EAX,EDX
004d2ca0 : SAR EAX,0x2
004d2ca3 : MOV ECX,EAX
004d2ca5 : MOV ESI,dword ptr [EBX + 0x8]
004d2ca8 : MOV EAX,ESI
004d2caa : SUB EAX,EDX
004d2cac : SAR EAX,0x2
004d2caf : MOV EDX,0x3fffffff
004d2cb4 : SUB EDX,EAX
004d2cb6 : CMP EDX,0x1
004d2cb9 : JNC 0x004d2cc0
004d2cbb : CALL 0x00452880
004d2cc0 : LEA EDX,[EAX + 0x1]
004d2cc3 : CMP ECX,EDX
004d2cc5 : JNC 0x004d2d95
004d2ccb : MOV EAX,ECX
004d2ccd : SHR EAX,0x1
004d2ccf : MOV ESI,0x3fffffff
004d2cd4 : SUB ESI,EAX
004d2cd6 : CMP ESI,ECX
004d2cd8 : JNC 0x004d2ce1
004d2cda : MOV dword ptr [EBP + 0x8],EDI
004d2cdd : MOV ECX,EDI
004d2cdf : JMP 0x004d2ce6
004d2ce1 : ADD ECX,EAX
004d2ce3 : MOV dword ptr [EBP + 0x8],ECX
004d2ce6 : CMP ECX,EDX
004d2ce8 : JNC 0x004d2cef
004d2cea : MOV dword ptr [EBP + 0x8],EDX
004d2ced : MOV ECX,EDX
004d2cef : CALL 0x004c1790
004d2cf4 : MOV dword ptr [EBP + -0x14],EAX
004d2cf7 : MOV ECX,dword ptr [EBP + 0xc]
004d2cfa : SUB ECX,dword ptr [EBX + 0x4]
004d2cfd : SAR ECX,0x2
004d2d00 : MOV dword ptr [EBP + -0x1c],ECX
004d2d03 : MOV dword ptr [EBP + -0x4],EDI
004d2d06 : LEA EDI,[EAX + ECX*0x4]
004d2d09 : MOV EDX,dword ptr [EBP + 0x10]
004d2d0c : MOV ESI,0x1
004d2d11 : CALL 0x004154b0
004d2d16 : MOV dword ptr [EBP + -0x18],ESI
004d2d19 : MOV ESI,dword ptr [EBP + -0x14]
004d2d1c : MOV EDX,ESI
004d2d1e : MOV EAX,dword ptr [EBP + 0xc]
004d2d21 : MOV EDI,dword ptr [EBX + 0x4]
004d2d24 : CALL 0x00461070
004d2d29 : MOV dword ptr [EBP + -0x18],0x2
004d2d30 : MOV EAX,dword ptr [EBP + -0x1c]
004d2d33 : LEA EDX,[ESI + EAX*0x4 + 0x4]
004d2d37 : MOV EAX,dword ptr [EBX + 0x8]
004d2d3a : MOV EDI,dword ptr [EBP + 0xc]
004d2d3d : CALL 0x00461070
004d2d42 : MOV dword ptr [EBP + -0x4],0xffffffff
004d2d49 : MOV ECX,dword ptr [EBX + 0x4]
004d2d4c : MOV EDI,dword ptr [EBX + 0x8]
004d2d4f : SUB EDI,ECX
004d2d51 : SAR EDI,0x2
004d2d54 : INC EDI
004d2d55 : TEST ECX,ECX
004d2d57 : JZ 0x004d2d5e
004d2d59 : CALL 0x006f04e0
004d2d5e : MOV ECX,dword ptr [EBP + 0x8]
004d2d61 : LEA EDX,[ESI + ECX*0x4]
004d2d64 : MOV dword ptr [EBX + 0xc],EDX
004d2d67 : LEA EAX,[ESI + EDI*0x4]
004d2d6a : MOV dword ptr [EBX + 0x8],EAX
004d2d6d : MOV dword ptr [EBX + 0x4],ESI
004d2d70 : MOV ECX,dword ptr [EBP + -0xc]
004d2d73 : MOV dword ptr FS:[0x0],ECX
004d2d7a : POP ECX
004d2d7b : POP EDI
004d2d7c : POP ESI
004d2d7d : POP EBX
004d2d7e : MOV ESP,EBP
004d2d80 : POP EBP
004d2d81 : RET 0xc
004d2d95 : MOV ECX,ESI
004d2d97 : MOV EDI,dword ptr [EBP + 0xc]
004d2d9a : SUB ECX,EDI
004d2d9c : SAR ECX,0x2
004d2d9f : CMP ECX,0x1
004d2da2 : JNC 0x004d2ded
004d2da4 : MOV EDX,dword ptr [EBP + 0x10]
004d2da7 : MOV EAX,dword ptr [EDX]
004d2da9 : MOV dword ptr [EBP + 0x10],EAX
004d2dac : LEA EDX,[EDI + 0x4]
004d2daf : MOV EAX,ESI
004d2db1 : CALL 0x00461070
004d2db6 : MOV dword ptr [EBP + -0x4],0x2
004d2dbd : MOV EDI,dword ptr [EBX + 0x8]
004d2dc0 : MOV ECX,EDI
004d2dc2 : SUB ECX,dword ptr [EBP + 0xc]
004d2dc5 : SAR ECX,0x2
004d2dc8 : MOV ESI,0x1
004d2dcd : SUB ESI,ECX
004d2dcf : LEA EDX,[EBP + 0x10]
004d2dd2 : CALL 0x004154b0
004d2dd7 : MOV dword ptr [EBP + -0x4],0xffffffff
004d2dde : ADD dword ptr [EBX + 0x8],0x4
004d2de2 : MOV EBX,dword ptr [EBX + 0x8]
004d2de5 : LEA ECX,[EBX + -0x4]
004d2de8 : MOV EDX,dword ptr [EBP + 0xc]
004d2deb : JMP 0x004d2e2b
004d2ded : MOV EAX,dword ptr [EBP + 0x10]
004d2df0 : MOV ECX,dword ptr [EAX]
004d2df2 : MOV dword ptr [EBP + 0x10],ECX
004d2df5 : LEA EDI,[ESI + -0x4]
004d2df8 : MOV EDX,ESI
004d2dfa : MOV EAX,ESI
004d2dfc : CALL 0x00461070
004d2e01 : MOV dword ptr [EBX + 0x8],EAX
004d2e04 : MOV EDX,dword ptr [EBP + 0xc]
004d2e07 : SUB EDI,EDX
004d2e09 : SAR EDI,0x2
004d2e0c : TEST EDI,EDI
004d2e0e : JLE 0x004d2e28
004d2e10 : LEA EAX,[EDI*0x4 + 0x0]
004d2e17 : PUSH EAX
004d2e18 : PUSH EDX
004d2e19 : PUSH EAX
004d2e1a : SUB ESI,EAX
004d2e1c : PUSH ESI
004d2e1d : CALL 0x00634101
004d2e22 : ADD ESP,0x10
004d2e25 : MOV EDX,dword ptr [EBP + 0xc]
004d2e28 : LEA ECX,[EDX + 0x4]
004d2e2b : PUSH EDX
004d2e2c : LEA EDX,[EBP + 0x10]
004d2e2f : CALL 0x00422490
004d2e34 : ADD ESP,0x4
004d2e37 : MOV ECX,dword ptr [EBP + -0xc]
004d2e3a : MOV dword ptr FS:[0x0],ECX
004d2e41 : POP ECX
004d2e42 : POP EDI
004d2e43 : POP ESI
004d2e44 : POP EBX
004d2e45 : MOV ESP,EBP
004d2e47 : POP EBP
004d2e48 : RET 0xc

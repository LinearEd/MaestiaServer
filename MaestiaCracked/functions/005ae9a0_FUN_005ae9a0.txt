PROGRAM  : Maestia.exe
FUNCTION : FUN_005ae9a0
ENTRY    : 005ae9a0
BODY     : [[005ae9a0, 005aea30]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005ae9a0(int *param_1,undefined1 param_2)

{
  uint uVar1;
  uint uVar2;
  undefined4 *puVar3;
  int in_ECX;
  int iVar4;
  undefined4 local_10;
  uint local_c;
  undefined4 local_8;
  
  uVar1 = *(uint *)(in_ECX + 0x10);
  if (uVar1 < 0x10) {
    iVar4 = in_ECX + 0x34 + uVar1 * 0xc;
  }
  else {
    iVar4 = *(int *)(in_ECX + 0x28) + (uVar1 * 3 + -0x30) * 4;
  }
  local_10 = *(undefined4 *)(iVar4 + 4);
  uVar2 = *(uint *)(iVar4 + 8);
  local_c = CONCAT31(local_c._1_3_,param_2);
  if (uVar1 < 0x10) {
    puVar3 = (undefined4 *)(in_ECX + 0x34 + uVar1 * 0xc);
  }
  else {
    puVar3 = (undefined4 *)(*(int *)(in_ECX + 0x28) + (uVar1 * 3 + -0x30) * 4);
  }
  *puVar3 = 2;
  puVar3[1] = param_1;
  puVar3[2] = local_c;
  if ((char)uVar2 != '\0') {
    local_c = uVar2 & 0xff;
    local_8 = local_10;
    (**(code **)(*param_1 + 8))(&local_10);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005ae9a0 : SUB ESP,0x10
005ae9a3 : PUSH EBX
005ae9a4 : PUSH EBP
005ae9a5 : PUSH ESI
005ae9a6 : MOV ESI,ECX
005ae9a8 : MOV EAX,dword ptr [ESI + 0x10]
005ae9ab : PUSH EDI
005ae9ac : CMP EAX,0x10
005ae9af : JNC 0x005ae9ba
005ae9b1 : LEA ECX,[EAX + EAX*0x2]
005ae9b4 : LEA EDX,[ESI + ECX*0x4 + 0x34]
005ae9b8 : JMP 0x005ae9c4
005ae9ba : MOV ECX,dword ptr [ESI + 0x28]
005ae9bd : LEA EDX,[EAX + EAX*0x2 + -0x30]
005ae9c1 : LEA EDX,[ECX + EDX*0x4]
005ae9c4 : MOV ECX,dword ptr [EDX + 0x4]
005ae9c7 : MOV EBP,dword ptr [ESP + 0x24]
005ae9cb : MOV EDX,dword ptr [EDX + 0x8]
005ae9ce : MOV dword ptr [ESP + 0x18],ECX
005ae9d2 : MOV CL,byte ptr [ESP + 0x28]
005ae9d6 : MOV byte ptr [ESP + 0x14],CL
005ae9da : MOV EBX,dword ptr [ESP + 0x14]
005ae9de : MOV EDI,0x2
005ae9e3 : MOV ECX,EBP
005ae9e5 : CMP EAX,0x10
005ae9e8 : JNC 0x005ae9f3
005ae9ea : LEA EAX,[EAX + EAX*0x2]
005ae9ed : LEA EAX,[ESI + EAX*0x4 + 0x34]
005ae9f1 : JMP 0x005ae9fd
005ae9f3 : MOV ESI,dword ptr [ESI + 0x28]
005ae9f6 : LEA EAX,[EAX + EAX*0x2 + -0x30]
005ae9fa : LEA EAX,[ESI + EAX*0x4]
005ae9fd : MOV dword ptr [EAX],EDI
005ae9ff : MOV dword ptr [EAX + 0x4],ECX
005aea02 : MOV dword ptr [EAX + 0x8],EBX
005aea05 : TEST DL,DL
005aea07 : JBE 0x005aea27
005aea09 : MOV ECX,dword ptr [ESP + 0x18]
005aea0d : MOV EAX,dword ptr [EBP]
005aea10 : MOVZX EDX,DL
005aea13 : MOV dword ptr [ESP + 0x10],ECX
005aea17 : LEA ECX,[ESP + 0x10]
005aea1b : MOV dword ptr [ESP + 0x14],EDX
005aea1f : MOV EDX,dword ptr [EAX + 0x8]
005aea22 : PUSH ECX
005aea23 : MOV ECX,EBP
005aea25 : CALL EDX
005aea27 : POP EDI
005aea28 : POP ESI
005aea29 : POP EBP
005aea2a : POP EBX
005aea2b : ADD ESP,0x10
005aea2e : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_008a7750
ENTRY    : 008a7750
BODY     : [[008a7750, 008a79da]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008a7750(int param_1,ushort *param_2)

{
  ushort uVar1;
  short sVar2;
  uint uVar3;
  undefined1 *puVar4;
  short *psVar5;
  int *piVar6;
  short *local_8c;
  int local_88;
  int local_84 [15];
  undefined1 local_48;
  undefined1 local_47;
  int local_44;
  undefined1 local_40;
  undefined1 local_3f;
  undefined1 local_3e;
  undefined4 local_20;
  undefined4 local_1c;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b44afb;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  uVar1 = *param_2;
  local_14 = uVar3;
  FUN_004345d0(local_84);
  local_8 = 0;
  if (((int *)((int)param_2 + 0x1d) == (int *)0x0) || ((uVar1 & 0x1fff) - 0x1d < 4)) {
    local_88 = 0;
  }
  else {
    local_84[0] = *(int *)((int)param_2 + 0x1d);
    local_88 = (uVar1 & 0x1fff) - 0x21;
  }
  if (local_84[0] == 0) {
    FUN_00406360(&DAT_00c4a768,0);
    FUN_00406360(&DAT_00c4a76c,0);
    local_48 = 0;
    local_40 = 0;
    local_3f = 0;
    local_44 = 0;
    local_47 = 0;
    local_3e = 0;
  }
  else {
    FUN_0042a6b0(&local_8c,uVar3);
    if (local_8c != (short *)0x0) {
      psVar5 = local_8c;
      do {
        sVar2 = *psVar5;
        psVar5 = psVar5 + 1;
      } while (sVar2 != 0);
      FUN_00406360(local_8c,(int)psVar5 - (int)(local_8c + 1) >> 1);
    }
    puVar4 = (undefined1 *)FUN_0042a6b0(&local_8c,uVar3);
    if (local_8c != (short *)0x0) {
      psVar5 = local_8c;
      do {
        sVar2 = *psVar5;
        psVar5 = psVar5 + 1;
      } while (sVar2 != 0);
      FUN_00406360(local_8c,(int)psVar5 - (int)(local_8c + 1) >> 1);
    }
    if ((puVar4 != (undefined1 *)0x0) && (local_88 != 0)) {
      local_48 = *puVar4;
      if ((puVar4 + 1 != (undefined1 *)0x0) && (local_88 != 1)) {
        local_40 = puVar4[1];
        if ((puVar4 + 2 != (undefined1 *)0x0) && (local_88 != 2)) {
          local_3f = puVar4[2];
          if ((puVar4 + 3 != (undefined1 *)0x0) && (local_88 != 3)) {
            local_47 = puVar4[3];
            if ((puVar4 + 4 != (undefined1 *)0x0) && (local_88 != 4)) {
              local_3e = puVar4[4];
              if (((int *)(puVar4 + 5) != (int *)0x0) && (3 < local_88 - 5U)) {
                local_44 = *(int *)(puVar4 + 5);
              }
            }
          }
        }
      }
    }
    if (local_44 == -1) {
      local_44 = 0;
    }
    FUN_00406360(&DAT_00c4a764,0);
  }
  local_20 = *(undefined4 *)((int)param_2 + 5);
  local_1c = *(undefined4 *)((int)param_2 + 0xd);
  if ((param_2[2] & 2) == 0) {
    piVar6 = *(int **)(param_1 + 0xb4);
    if (piVar6 != *(int **)(param_1 + 0xb8)) {
      do {
        if (*piVar6 == local_84[0]) {
          FUN_00433be0();
          goto LAB_008a79a4;
        }
        piVar6 = piVar6 + 0x1c;
      } while (piVar6 != *(int **)(param_1 + 0xb8));
    }
    FUN_00433c70(param_1 + 0xb0,local_84);
    if (local_84[0] == *(int *)(param_1 + 200)) {
      FUN_008a7500(param_1);
    }
  }
  else {
    FUN_00433be0();
    *(byte *)(param_1 + 0x39) = (byte)param_2[2] & 1;
    FUN_008a6880();
    *(undefined1 *)(param_1 + 0x38) = 1;
  }
LAB_008a79a4:
  local_8 = 0xffffffff;
  FUN_00434520(local_84);
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008a7750 : PUSH EBP
008a7751 : MOV EBP,ESP
008a7753 : PUSH -0x1
008a7755 : PUSH 0xb44afb
008a775a : MOV EAX,FS:[0x0]
008a7760 : PUSH EAX
008a7761 : SUB ESP,0x84
008a7767 : MOV EAX,[0x00d66fa0]
008a776c : XOR EAX,EBP
008a776e : MOV dword ptr [EBP + -0x10],EAX
008a7771 : PUSH EBX
008a7772 : PUSH ESI
008a7773 : PUSH EDI
008a7774 : PUSH EAX
008a7775 : LEA EAX,[EBP + -0xc]
008a7778 : MOV FS:[0x0],EAX
008a777e : MOV EAX,dword ptr [EBP + 0x8]
008a7781 : MOV dword ptr [EBP + 0xffffff70],EAX
008a7787 : MOV EAX,dword ptr [EBP + 0xc]
008a778a : MOVZX ESI,word ptr [EAX]
008a778d : LEA ECX,[EBP + -0x80]
008a7790 : AND ESI,0x1fff
008a7796 : PUSH ECX
008a7797 : MOV dword ptr [EBP + 0xffffff74],EAX
008a779d : LEA EDI,[EAX + 0x1d]
008a77a0 : SUB ESI,0x1d
008a77a3 : CALL 0x004345d0
008a77a8 : XOR EBX,EBX
008a77aa : MOV dword ptr [EBP + -0x4],EBX
008a77ad : CMP EDI,EBX
008a77af : JZ 0x008a77c9
008a77b1 : CMP ESI,0x4
008a77b4 : JC 0x008a77c9
008a77b6 : MOV EDX,dword ptr [EDI]
008a77b8 : SUB ESI,0x4
008a77bb : MOV dword ptr [EBP + -0x80],EDX
008a77be : MOV dword ptr [EBP + 0xffffff7c],ESI
008a77c4 : ADD EDI,0x4
008a77c7 : JMP 0x008a77d1
008a77c9 : MOV dword ptr [EBP + 0xffffff7c],EBX
008a77cf : XOR EDI,EDI
008a77d1 : CMP dword ptr [EBP + -0x80],EBX
008a77d4 : JZ 0x008a78d9
008a77da : LEA EAX,[EBP + 0xffffff78]
008a77e0 : PUSH EAX
008a77e1 : LEA ECX,[EBP + 0xffffff7c]
008a77e7 : MOV EDX,EDI
008a77e9 : CALL 0x0042a6b0
008a77ee : MOV EDX,dword ptr [EBP + 0xffffff78]
008a77f4 : ADD ESP,0x4
008a77f7 : MOV EDI,EAX
008a77f9 : CMP EDX,EBX
008a77fb : JZ 0x008a781b
008a77fd : MOV EAX,EDX
008a77ff : LEA ESI,[EAX + 0x2]
008a7802 : MOV CX,word ptr [EAX]
008a7805 : ADD EAX,0x2
008a7808 : CMP CX,BX
008a780b : JNZ 0x008a7802
008a780d : SUB EAX,ESI
008a780f : SAR EAX,0x1
008a7811 : PUSH EAX
008a7812 : PUSH EDX
008a7813 : LEA ECX,[EBP + -0x7c]
008a7816 : CALL 0x00406360
008a781b : LEA ECX,[EBP + 0xffffff78]
008a7821 : PUSH ECX
008a7822 : LEA ECX,[EBP + 0xffffff7c]
008a7828 : MOV EDX,EDI
008a782a : CALL 0x0042a6b0
008a782f : MOV EDX,dword ptr [EBP + 0xffffff78]
008a7835 : ADD ESP,0x4
008a7838 : MOV ESI,EAX
008a783a : CMP EDX,EBX
008a783c : JZ 0x008a785c
008a783e : MOV EAX,EDX
008a7840 : LEA EDI,[EAX + 0x2]
008a7843 : MOV CX,word ptr [EAX]
008a7846 : ADD EAX,0x2
008a7849 : CMP CX,BX
008a784c : JNZ 0x008a7843
008a784e : SUB EAX,EDI
008a7850 : SAR EAX,0x1
008a7852 : PUSH EAX
008a7853 : PUSH EDX
008a7854 : LEA ECX,[EBP + -0x60]
008a7857 : CALL 0x00406360
008a785c : CMP ESI,EBX
008a785e : JZ 0x008a78c0
008a7860 : MOV EAX,dword ptr [EBP + 0xffffff7c]
008a7866 : CMP EAX,0x1
008a7869 : JC 0x008a78c0
008a786b : MOV DL,byte ptr [ESI]
008a786d : INC ESI
008a786e : DEC EAX
008a786f : MOV byte ptr [EBP + -0x44],DL
008a7872 : CMP ESI,EBX
008a7874 : JZ 0x008a78c0
008a7876 : CMP EAX,0x1
008a7879 : JC 0x008a78c0
008a787b : MOV CL,byte ptr [ESI]
008a787d : INC ESI
008a787e : DEC EAX
008a787f : MOV byte ptr [EBP + -0x3c],CL
008a7882 : CMP ESI,EBX
008a7884 : JZ 0x008a78c0
008a7886 : CMP EAX,0x1
008a7889 : JC 0x008a78c0
008a788b : MOV DL,byte ptr [ESI]
008a788d : INC ESI
008a788e : DEC EAX
008a788f : MOV byte ptr [EBP + -0x3b],DL
008a7892 : CMP ESI,EBX
008a7894 : JZ 0x008a78c0
008a7896 : CMP EAX,0x1
008a7899 : JC 0x008a78c0
008a789b : MOV CL,byte ptr [ESI]
008a789d : INC ESI
008a789e : DEC EAX
008a789f : MOV byte ptr [EBP + -0x43],CL
008a78a2 : CMP ESI,EBX
008a78a4 : JZ 0x008a78c0
008a78a6 : CMP EAX,0x1
008a78a9 : JC 0x008a78c0
008a78ab : MOV DL,byte ptr [ESI]
008a78ad : INC ESI
008a78ae : DEC EAX
008a78af : MOV byte ptr [EBP + -0x3a],DL
008a78b2 : CMP ESI,EBX
008a78b4 : JZ 0x008a78c0
008a78b6 : CMP EAX,0x4
008a78b9 : JC 0x008a78c0
008a78bb : MOV EAX,dword ptr [ESI]
008a78bd : MOV dword ptr [EBP + -0x40],EAX
008a78c0 : CMP dword ptr [EBP + -0x40],-0x1
008a78c4 : JNZ 0x008a78c9
008a78c6 : MOV dword ptr [EBP + -0x40],EBX
008a78c9 : PUSH EBX
008a78ca : PUSH 0xc4a764
008a78cf : LEA ECX,[EBP + -0x38]
008a78d2 : CALL 0x00406360
008a78d7 : JMP 0x008a7907
008a78d9 : PUSH EBX
008a78da : PUSH 0xc4a768
008a78df : LEA ECX,[EBP + -0x7c]
008a78e2 : CALL 0x00406360
008a78e7 : PUSH EBX
008a78e8 : PUSH 0xc4a76c
008a78ed : LEA ECX,[EBP + -0x60]
008a78f0 : CALL 0x00406360
008a78f5 : MOV byte ptr [EBP + -0x44],BL
008a78f8 : MOV byte ptr [EBP + -0x3c],BL
008a78fb : MOV byte ptr [EBP + -0x3b],BL
008a78fe : MOV dword ptr [EBP + -0x40],EBX
008a7901 : MOV byte ptr [EBP + -0x43],BL
008a7904 : MOV byte ptr [EBP + -0x3a],BL
008a7907 : MOV EAX,dword ptr [EBP + 0xffffff74]
008a790d : TEST byte ptr [EAX + 0x4],0x2
008a7911 : MOV ECX,dword ptr [EAX + 0x5]
008a7914 : MOV EDX,dword ptr [EAX + 0xd]
008a7917 : MOV dword ptr [EBP + -0x1c],ECX
008a791a : MOV dword ptr [EBP + -0x18],EDX
008a791d : JZ 0x008a794c
008a791f : MOV EBX,dword ptr [EBP + 0xffffff70]
008a7925 : LEA ESI,[EBX + 0x40]
008a7928 : LEA EDI,[EBP + -0x80]
008a792b : CALL 0x00433be0
008a7930 : MOV EAX,dword ptr [EBP + 0xffffff74]
008a7936 : MOV CL,byte ptr [EAX + 0x4]
008a7939 : AND CL,0x1
008a793c : MOV ESI,EBX
008a793e : MOV byte ptr [EBX + 0x39],CL
008a7941 : CALL 0x008a6880
008a7946 : MOV byte ptr [EBX + 0x38],0x1
008a794a : JMP 0x008a7999
008a794c : MOV EDI,dword ptr [EBP + 0xffffff70]
008a7952 : MOV ESI,dword ptr [EDI + 0xb4]
008a7958 : CMP ESI,dword ptr [EDI + 0xb8]
008a795e : JZ 0x008a7972
008a7960 : MOV EAX,dword ptr [EBP + -0x80]
008a7963 : CMP dword ptr [ESI],EAX
008a7965 : JZ 0x008a79c7
008a7967 : ADD ESI,0x70
008a796a : CMP ESI,dword ptr [EDI + 0xb8]
008a7970 : JNZ 0x008a7963
008a7972 : LEA EAX,[EBP + -0x80]
008a7975 : PUSH EAX
008a7976 : LEA ECX,[EDI + 0xb0]
008a797c : PUSH ECX
008a797d : CALL 0x00433c70
008a7982 : MOV EDX,dword ptr [EBP + -0x80]
008a7985 : CMP EDX,dword ptr [EDI + 0xc8]
008a798b : JNZ 0x008a7999
008a798d : LEA EDX,[EDI + 0xc4]
008a7993 : PUSH EDI
008a7994 : CALL 0x008a7500
008a7999 : MOV dword ptr [EBP + -0x4],0xffffffff
008a79a0 : LEA EAX,[EBP + -0x80]
008a79a3 : PUSH EAX
008a79a4 : CALL 0x00434520
008a79a9 : MOV ECX,dword ptr [EBP + -0xc]
008a79ac : MOV dword ptr FS:[0x0],ECX
008a79b3 : POP ECX
008a79b4 : POP EDI
008a79b5 : POP ESI
008a79b6 : POP EBX
008a79b7 : MOV ECX,dword ptr [EBP + -0x10]
008a79ba : XOR ECX,EBP
008a79bc : CALL 0x00633e6b
008a79c1 : MOV ESP,EBP
008a79c3 : POP EBP
008a79c4 : RET 0x8
008a79c7 : LEA EDI,[EBP + -0x80]
008a79ca : CALL 0x00433be0
008a79cf : MOV dword ptr [EBP + -0x4],0xffffffff
008a79d6 : MOV EDX,EDI
008a79d8 : PUSH EDX
008a79d9 : JMP 0x008a79a4

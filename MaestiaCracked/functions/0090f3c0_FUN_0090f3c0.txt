PROGRAM  : Maestia.exe
FUNCTION : FUN_0090f3c0
ENTRY    : 0090f3c0
BODY     : [[0090f3c0, 0090f683]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0090f3c0(void)

{
  undefined1 uVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  int unaff_EDI;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  iVar4 = DAT_017248cc;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b102a2;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *(undefined4 *)(unaff_EDI + 0x38) = *(undefined4 *)(DAT_017248cc + 4);
  *(undefined4 *)(unaff_EDI + 0x3c) = *(undefined4 *)(iVar4 + 8);
  *(undefined1 *)(unaff_EDI + 0x40) = *(undefined1 *)(iVar4 + 0xc);
  *(undefined1 *)(unaff_EDI + 0x41) = *(undefined1 *)(iVar4 + 0xd);
  *(undefined1 *)(unaff_EDI + 0x43) = *(undefined1 *)(iVar4 + 0xf);
  *(undefined1 *)(unaff_EDI + 0x42) = *(undefined1 *)(iVar4 + 0xe);
  *(undefined1 *)(unaff_EDI + 0x44) = *(undefined1 *)(iVar4 + 0x10);
  *(undefined1 *)(unaff_EDI + 0x45) = *(undefined1 *)(iVar4 + 0x11);
  *(undefined1 *)(unaff_EDI + 0x46) = *(undefined1 *)(iVar4 + 0x12);
  *(undefined1 *)(unaff_EDI + 0x47) = *(undefined1 *)(iVar4 + 0x13);
  uVar1 = *(undefined1 *)(iVar4 + 0x14);
  *(undefined1 *)(unaff_EDI + 0x58) = uVar1;
  *(undefined4 *)(unaff_EDI + 0x5c) = *(undefined4 *)(iVar4 + 0x20);
  *(undefined1 *)(unaff_EDI + 0x49) = *(undefined1 *)(iVar4 + 0x15);
  *(undefined1 *)(unaff_EDI + 0x4a) = *(undefined1 *)(iVar4 + 0x16);
  *(undefined1 *)(unaff_EDI + 0x48) = *(undefined1 *)(iVar4 + 0x17);
  *(undefined1 *)(unaff_EDI + 0x4b) = *(undefined1 *)(iVar4 + 0x18);
  *(undefined1 *)(unaff_EDI + 0x4c) = *(undefined1 *)(iVar4 + 0x19);
  *(undefined1 *)(unaff_EDI + 0x4d) = *(undefined1 *)(iVar4 + 0x1a);
  *(undefined1 *)(unaff_EDI + 0x4e) = *(undefined1 *)(iVar4 + 0x1b);
  *(undefined1 *)(unaff_EDI + 0x50) = *(undefined1 *)(iVar4 + 0x1c);
  *(undefined1 *)(unaff_EDI + 0x51) = *(undefined1 *)(iVar4 + 0x1d);
  *(undefined1 *)(unaff_EDI + 0x52) = *(undefined1 *)(iVar4 + 0x24);
  *(undefined1 *)(unaff_EDI + 0x53) = *(undefined1 *)(iVar4 + 0x25);
  *(undefined1 *)(unaff_EDI + 0x54) = *(undefined1 *)(iVar4 + 0x26);
  *(undefined1 *)(unaff_EDI + 0x56) = *(undefined1 *)(iVar4 + 0x27);
  *(undefined1 *)(unaff_EDI + 99) = *(undefined1 *)(iVar4 + 0x7b);
  *(undefined1 *)(unaff_EDI + 100) = *(undefined1 *)(iVar4 + 0x7c);
  *(undefined1 *)(unaff_EDI + 0x65) = *(undefined1 *)(iVar4 + 0x7d);
  *(undefined1 *)(unaff_EDI + 0x66) = *(undefined1 *)(iVar4 + 0x7e);
  *(undefined1 *)(unaff_EDI + 0x67) = *(undefined1 *)(iVar4 + 0x7f);
  *(undefined1 *)(unaff_EDI + 0x68) = *(undefined1 *)(iVar4 + 0x80);
  *(undefined1 *)(unaff_EDI + 0x69) = *(undefined1 *)(iVar4 + 0x81);
  *(undefined1 *)(unaff_EDI + 0x6a) = *(undefined1 *)(iVar4 + 0x82);
  *(undefined1 *)(unaff_EDI + 0x6b) = *(undefined1 *)(iVar4 + 0x83);
  *(undefined1 *)(unaff_EDI + 0x6c) = *(undefined1 *)(iVar4 + 0x84);
  *(undefined1 *)(unaff_EDI + 0x6d) = *(undefined1 *)(iVar4 + 0x85);
  *(undefined1 *)(unaff_EDI + 0x6e) = *(undefined1 *)(iVar4 + 0x86);
  *(undefined1 *)(unaff_EDI + 0x6f) = *(undefined1 *)(iVar4 + 0x87);
  *(undefined1 *)(unaff_EDI + 0x70) = *(undefined1 *)(iVar4 + 0x88);
  *(undefined1 *)(unaff_EDI + 0x71) = *(undefined1 *)(iVar4 + 0x89);
  *(undefined1 *)(unaff_EDI + 0x72) = *(undefined1 *)(iVar4 + 0x8a);
  *(undefined1 *)(unaff_EDI + 0x73) = *(undefined1 *)(iVar4 + 0x8b);
  *(undefined1 *)(unaff_EDI + 0x74) = *(undefined1 *)(iVar4 + 0x8c);
  *(undefined1 *)(unaff_EDI + 0x75) = *(undefined1 *)(iVar4 + 0x8d);
  *(undefined1 *)(unaff_EDI + 0x4f) = *(undefined1 *)(iVar4 + 0x60);
  *(ushort *)(unaff_EDI + 0x76) = (ushort)(*(short *)(iVar4 + 0x28) != 0);
  *(undefined1 *)(unaff_EDI + 0x55) = *(undefined1 *)(iVar4 + 0x2a);
  *(undefined1 *)(unaff_EDI + 0x57) = *(undefined1 *)(iVar4 + 0x2b);
  *(undefined4 *)(unaff_EDI + 0x5c) = *(undefined4 *)(iVar4 + 0x20);
  *(undefined1 *)(unaff_EDI + 0x60) = *(undefined1 *)(iVar4 + 0x2c);
  *(undefined1 *)(unaff_EDI + 0x61) = *(undefined1 *)(iVar4 + 0x2d);
  iVar2 = DAT_00da93ec;
  *(undefined1 *)(unaff_EDI + 0x62) = *(undefined1 *)(iVar4 + 0x2e);
  if (iVar2 != 0) {
    FUN_00a1a1e0(uVar1);
    uVar1 = *(undefined1 *)(unaff_EDI + 0x40);
    (**(code **)(**(int **)(DAT_00da93ec + 0xac) + 0x2d8))(uVar1,uVar3);
    FUN_00a1a2c0(uVar1,1);
    FUN_00a1a520(*(undefined1 *)(unaff_EDI + 0x41));
    FUN_00a1a460(*(undefined1 *)(unaff_EDI + 0x42));
    FUN_00a1a3a0(*(undefined1 *)(unaff_EDI + 0x43));
    iVar2 = DAT_00da93ec;
    uVar1 = *(undefined1 *)(unaff_EDI + 0x44);
    if (DAT_00da93ec == 0) {
      iVar4 = 0;
    }
    else {
      iVar4 = DAT_00da93ec + 0x18;
    }
    EnterCriticalSection((LPCRITICAL_SECTION)(iVar4 + 4));
    local_8 = 0;
    (**(code **)(**(int **)(iVar2 + 0xac) + 0x2dc))(uVar1);
    local_8 = 0xffffffff;
    LeaveCriticalSection((LPCRITICAL_SECTION)(iVar4 + 4));
    FUN_00a1a060(1,*(undefined1 *)(unaff_EDI + 0x45),0);
    FUN_00a1a060(2,*(undefined1 *)(unaff_EDI + 0x46),0);
    FUN_00a1a060(3,*(undefined1 *)(unaff_EDI + 0x47),0);
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
0090f3c0 : PUSH EBP
0090f3c1 : MOV EBP,ESP
0090f3c3 : PUSH -0x1
0090f3c5 : PUSH 0xb102a2
0090f3ca : MOV EAX,FS:[0x0]
0090f3d0 : PUSH EAX
0090f3d1 : SUB ESP,0x8
0090f3d4 : PUSH EBX
0090f3d5 : PUSH ESI
0090f3d6 : MOV EAX,[0x00d66fa0]
0090f3db : XOR EAX,EBP
0090f3dd : PUSH EAX
0090f3de : LEA EAX,[EBP + -0xc]
0090f3e1 : MOV FS:[0x0],EAX
0090f3e7 : MOV EAX,[0x017248cc]
0090f3ec : MOVSS XMM0,dword ptr [EAX + 0x4]
0090f3f1 : MOVSS dword ptr [EDI + 0x38],XMM0
0090f3f6 : MOVSS XMM0,dword ptr [EAX + 0x8]
0090f3fb : MOVSS dword ptr [EDI + 0x3c],XMM0
0090f400 : MOV CL,byte ptr [EAX + 0xc]
0090f403 : MOV byte ptr [EDI + 0x40],CL
0090f406 : MOV CL,byte ptr [EAX + 0xd]
0090f409 : MOV byte ptr [EDI + 0x41],CL
0090f40c : MOV CL,byte ptr [EAX + 0xf]
0090f40f : MOV byte ptr [EDI + 0x43],CL
0090f412 : MOV CL,byte ptr [EAX + 0xe]
0090f415 : MOV byte ptr [EDI + 0x42],CL
0090f418 : MOV CL,byte ptr [EAX + 0x10]
0090f41b : MOV byte ptr [EDI + 0x44],CL
0090f41e : MOV CL,byte ptr [EAX + 0x11]
0090f421 : MOV byte ptr [EDI + 0x45],CL
0090f424 : MOV CL,byte ptr [EAX + 0x12]
0090f427 : MOV byte ptr [EDI + 0x46],CL
0090f42a : MOV CL,byte ptr [EAX + 0x13]
0090f42d : MOV byte ptr [EDI + 0x47],CL
0090f430 : MOV CL,byte ptr [EAX + 0x14]
0090f433 : MOV byte ptr [EBP + -0x10],CL
0090f436 : MOV byte ptr [EDI + 0x58],CL
0090f439 : MOV ECX,dword ptr [EAX + 0x20]
0090f43c : MOV dword ptr [EDI + 0x5c],ECX
0090f43f : MOV CL,byte ptr [EAX + 0x15]
0090f442 : MOV byte ptr [EDI + 0x49],CL
0090f445 : MOV CL,byte ptr [EAX + 0x16]
0090f448 : MOV byte ptr [EDI + 0x4a],CL
0090f44b : MOV CL,byte ptr [EAX + 0x17]
0090f44e : MOV byte ptr [EDI + 0x48],CL
0090f451 : MOV CL,byte ptr [EAX + 0x18]
0090f454 : MOV byte ptr [EDI + 0x4b],CL
0090f457 : MOV CL,byte ptr [EAX + 0x19]
0090f45a : MOV byte ptr [EDI + 0x4c],CL
0090f45d : MOV CL,byte ptr [EAX + 0x1a]
0090f460 : MOV byte ptr [EDI + 0x4d],CL
0090f463 : MOV CL,byte ptr [EAX + 0x1b]
0090f466 : MOV byte ptr [EDI + 0x4e],CL
0090f469 : MOV CL,byte ptr [EAX + 0x1c]
0090f46c : MOV byte ptr [EDI + 0x50],CL
0090f46f : MOV CL,byte ptr [EAX + 0x1d]
0090f472 : MOV byte ptr [EDI + 0x51],CL
0090f475 : MOV CL,byte ptr [EAX + 0x24]
0090f478 : MOV byte ptr [EDI + 0x52],CL
0090f47b : MOV CL,byte ptr [EAX + 0x25]
0090f47e : MOV byte ptr [EDI + 0x53],CL
0090f481 : MOV CL,byte ptr [EAX + 0x26]
0090f484 : MOV byte ptr [EDI + 0x54],CL
0090f487 : MOV CL,byte ptr [EAX + 0x27]
0090f48a : MOV byte ptr [EDI + 0x56],CL
0090f48d : MOV CL,byte ptr [EAX + 0x7b]
0090f490 : MOV byte ptr [EDI + 0x63],CL
0090f493 : MOV CL,byte ptr [EAX + 0x7c]
0090f496 : MOV byte ptr [EDI + 0x64],CL
0090f499 : MOV CL,byte ptr [EAX + 0x7d]
0090f49c : MOV byte ptr [EDI + 0x65],CL
0090f49f : MOV CL,byte ptr [EAX + 0x7e]
0090f4a2 : MOV byte ptr [EDI + 0x66],CL
0090f4a5 : MOV CL,byte ptr [EAX + 0x7f]
0090f4a8 : MOV byte ptr [EDI + 0x67],CL
0090f4ab : MOV CL,byte ptr [EAX + 0x80]
0090f4b1 : MOV byte ptr [EDI + 0x68],CL
0090f4b4 : MOV CL,byte ptr [EAX + 0x81]
0090f4ba : MOV byte ptr [EDI + 0x69],CL
0090f4bd : MOV CL,byte ptr [EAX + 0x82]
0090f4c3 : MOV byte ptr [EDI + 0x6a],CL
0090f4c6 : MOV CL,byte ptr [EAX + 0x83]
0090f4cc : MOV byte ptr [EDI + 0x6b],CL
0090f4cf : MOV CL,byte ptr [EAX + 0x84]
0090f4d5 : MOV byte ptr [EDI + 0x6c],CL
0090f4d8 : MOV CL,byte ptr [EAX + 0x85]
0090f4de : MOV byte ptr [EDI + 0x6d],CL
0090f4e1 : MOV CL,byte ptr [EAX + 0x86]
0090f4e7 : MOV byte ptr [EDI + 0x6e],CL
0090f4ea : MOV CL,byte ptr [EAX + 0x87]
0090f4f0 : MOV byte ptr [EDI + 0x6f],CL
0090f4f3 : MOV CL,byte ptr [EAX + 0x88]
0090f4f9 : MOV byte ptr [EDI + 0x70],CL
0090f4fc : MOV CL,byte ptr [EAX + 0x89]
0090f502 : MOV byte ptr [EDI + 0x71],CL
0090f505 : MOV CL,byte ptr [EAX + 0x8a]
0090f50b : MOV byte ptr [EDI + 0x72],CL
0090f50e : MOV CL,byte ptr [EAX + 0x8b]
0090f514 : MOV byte ptr [EDI + 0x73],CL
0090f517 : MOV CL,byte ptr [EAX + 0x8c]
0090f51d : MOV byte ptr [EDI + 0x74],CL
0090f520 : MOV CL,byte ptr [EAX + 0x8d]
0090f526 : MOV byte ptr [EDI + 0x75],CL
0090f529 : MOV CL,byte ptr [EAX + 0x60]
0090f52c : MOV byte ptr [EDI + 0x4f],CL
0090f52f : CMP word ptr [EAX + 0x28],0x0
0090f534 : SETNZ CL
0090f537 : MOVZX DX,CL
0090f53b : MOVZX ECX,DX
0090f53e : MOV word ptr [EDI + 0x76],CX
0090f542 : MOV CL,byte ptr [EAX + 0x2a]
0090f545 : MOV byte ptr [EDI + 0x55],CL
0090f548 : MOV CL,byte ptr [EAX + 0x2b]
0090f54b : MOV byte ptr [EDI + 0x57],CL
0090f54e : MOV ECX,dword ptr [EAX + 0x20]
0090f551 : MOV dword ptr [EDI + 0x5c],ECX
0090f554 : MOV CL,byte ptr [EAX + 0x2c]
0090f557 : MOV byte ptr [EDI + 0x60],CL
0090f55a : MOV CL,byte ptr [EAX + 0x2d]
0090f55d : MOV byte ptr [EDI + 0x61],CL
0090f560 : MOV ECX,dword ptr [0x00da93ec]
0090f566 : MOV AL,byte ptr [EAX + 0x2e]
0090f569 : MOV byte ptr [EDI + 0x62],AL
0090f56c : TEST ECX,ECX
0090f56e : JZ 0x0090f673
0090f574 : MOV EDX,dword ptr [EBP + -0x10]
0090f577 : PUSH EDX
0090f578 : CALL 0x00a1a1e0
0090f57d : MOVZX EAX,byte ptr [EDI + 0x40]
0090f581 : MOV byte ptr [EBP + -0x10],AL
0090f584 : MOV EAX,[0x00da93ec]
0090f589 : MOV ECX,dword ptr [EAX + 0xac]
0090f58f : MOV EDX,dword ptr [ECX]
0090f591 : MOV EBX,dword ptr [EBP + -0x10]
0090f594 : MOV ESI,EAX
0090f596 : MOV EAX,dword ptr [EDX + 0x2d8]
0090f59c : PUSH EBX
0090f59d : CALL EAX
0090f59f : PUSH 0x1
0090f5a1 : PUSH EBX
0090f5a2 : CALL 0x00a1a2c0
0090f5a7 : MOVZX ECX,byte ptr [EDI + 0x41]
0090f5ab : MOV byte ptr [EBP + -0x10],CL
0090f5ae : MOV EDX,dword ptr [EBP + -0x10]
0090f5b1 : MOV ECX,dword ptr [0x00da93ec]
0090f5b7 : PUSH EDX
0090f5b8 : CALL 0x00a1a520
0090f5bd : MOVZX EAX,byte ptr [EDI + 0x42]
0090f5c1 : MOV byte ptr [EBP + -0x10],AL
0090f5c4 : MOV ECX,dword ptr [EBP + -0x10]
0090f5c7 : PUSH ECX
0090f5c8 : MOV ECX,dword ptr [0x00da93ec]
0090f5ce : CALL 0x00a1a460
0090f5d3 : MOV DL,byte ptr [EDI + 0x43]
0090f5d6 : MOV ECX,dword ptr [0x00da93ec]
0090f5dc : MOV byte ptr [EBP + -0x10],DL
0090f5df : MOV EAX,dword ptr [EBP + -0x10]
0090f5e2 : PUSH EAX
0090f5e3 : CALL 0x00a1a3a0
0090f5e8 : MOVZX ECX,byte ptr [EDI + 0x44]
0090f5ec : MOV EAX,[0x00da93ec]
0090f5f1 : MOV byte ptr [EBP + -0x10],CL
0090f5f4 : MOV EBX,EAX
0090f5f6 : TEST EAX,EAX
0090f5f8 : JZ 0x0090f5ff
0090f5fa : ADD EAX,0x18
0090f5fd : JMP 0x0090f601
0090f5ff : XOR EAX,EAX
0090f601 : LEA ESI,[EAX + 0x4]
0090f604 : PUSH ESI
0090f605 : MOV dword ptr [EBP + -0x14],EAX
0090f608 : CALL dword ptr [0x00b85118]
0090f60e : MOV dword ptr [EBP + -0x4],0x0
0090f615 : MOV ECX,dword ptr [EBX + 0xac]
0090f61b : MOV EDX,dword ptr [ECX]
0090f61d : MOV EAX,dword ptr [EBP + -0x10]
0090f620 : MOV EDX,dword ptr [EDX + 0x2dc]
0090f626 : PUSH EAX
0090f627 : CALL EDX
0090f629 : MOV dword ptr [EBP + -0x4],0xffffffff
0090f630 : PUSH ESI
0090f631 : CALL dword ptr [0x00b8511c]
0090f637 : MOVZX EAX,byte ptr [EDI + 0x45]
0090f63b : MOV ECX,dword ptr [0x00da93ec]
0090f641 : PUSH 0x0
0090f643 : PUSH EAX
0090f644 : PUSH 0x1
0090f646 : CALL 0x00a1a060
0090f64b : MOVZX ECX,byte ptr [EDI + 0x46]
0090f64f : PUSH 0x0
0090f651 : PUSH ECX
0090f652 : MOV ECX,dword ptr [0x00da93ec]
0090f658 : PUSH 0x2
0090f65a : CALL 0x00a1a060
0090f65f : MOVZX EDX,byte ptr [EDI + 0x47]
0090f663 : MOV ECX,dword ptr [0x00da93ec]
0090f669 : PUSH 0x0
0090f66b : PUSH EDX
0090f66c : PUSH 0x3
0090f66e : CALL 0x00a1a060
0090f673 : MOV ECX,dword ptr [EBP + -0xc]
0090f676 : MOV dword ptr FS:[0x0],ECX
0090f67d : POP ECX
0090f67e : POP ESI
0090f67f : POP EBX
0090f680 : MOV ESP,EBP
0090f682 : POP EBP
0090f683 : RET

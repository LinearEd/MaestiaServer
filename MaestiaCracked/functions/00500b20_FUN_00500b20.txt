PROGRAM  : Maestia.exe
FUNCTION : FUN_00500b20
ENTRY    : 00500b20
BODY     : [[00500b20, 00500be6]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00500b20(void)

{
  int *piVar1;
  int iVar2;
  uint *puVar3;
  LONG LVar4;
  int *in_ECX;
  byte *pbVar5;
  uint uStack_8;
  int *local_4;
  
  local_4 = in_ECX + 0x2d;
  if ((*(int *)(*local_4 + 0x10) != 0) && (iVar2 = (**(code **)(*in_ECX + 0x5c))(), iVar2 != 0)) {
    puVar3 = (uint *)FUN_00544a20(&uStack_8);
    iVar2 = FUN_00525450((*puVar3 & 0xfffffffc) + 8,*(uint *)(*puVar3 & 0xfffffffc) & 0x7fffffff);
    *(int *)(iVar2 + 8) = *(int *)(iVar2 + 8) + 1;
    pbVar5 = (byte *)(in_ECX + 0x2e);
    if (4 < *pbVar5) {
      FUN_00526400();
    }
    *pbVar5 = 5;
    in_ECX[0x2f] = iVar2;
    *(int *)(iVar2 + 8) = *(int *)(iVar2 + 8) + 1;
    piVar1 = (int *)(iVar2 + 8);
    *piVar1 = *piVar1 + -1;
    if (*piVar1 == 0) {
      FUN_00525340();
    }
    LVar4 = InterlockedExchangeAdd((LONG *)((uStack_8 & 0xfffffffc) + 4),-1);
    if (LVar4 == 1) {
      FUN_00515cf0(uStack_8 & 0xfffffffc);
    }
    FUN_005334f0(local_4,pbVar5,0,1);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00500b20 : SUB ESP,0x8
00500b23 : PUSH EDI
00500b24 : MOV EDI,ECX
00500b26 : LEA EAX,[EDI + 0xb4]
00500b2c : MOV dword ptr [ESP + 0x8],EAX
00500b30 : MOV EAX,dword ptr [EAX]
00500b32 : CMP dword ptr [EAX + 0x10],0x0
00500b36 : JZ 0x00500be2
00500b3c : MOV EDX,dword ptr [EDI]
00500b3e : MOV EAX,dword ptr [EDX + 0x5c]
00500b41 : PUSH EBX
00500b42 : CALL EAX
00500b44 : MOV EBX,EAX
00500b46 : TEST EBX,EBX
00500b48 : JZ 0x00500be1
00500b4e : MOV ECX,dword ptr [EDI + 0xa0]
00500b54 : PUSH ESI
00500b55 : LEA EDX,[ESP + 0xc]
00500b59 : PUSH EDX
00500b5a : CALL 0x00544a20
00500b5f : MOV EAX,dword ptr [EAX]
00500b61 : MOV EDX,dword ptr [EBX + 0x78]
00500b64 : MOV ECX,EAX
00500b66 : AND ECX,0xfffffffc
00500b69 : MOV ECX,dword ptr [ECX]
00500b6b : AND ECX,0x7fffffff
00500b71 : AND EAX,0xfffffffc
00500b74 : PUSH ECX
00500b75 : ADD EAX,0x8
00500b78 : PUSH EAX
00500b79 : LEA ECX,[EDX + 0x254]
00500b7f : CALL 0x00525450
00500b84 : MOV ESI,EAX
00500b86 : INC dword ptr [ESI + 0x8]
00500b89 : ADD EDI,0xb8
00500b8f : CMP byte ptr [EDI],0x5
00500b92 : JC 0x00500b9b
00500b94 : MOV ECX,EDI
00500b96 : CALL 0x00526400
00500b9b : MOV byte ptr [EDI],0x5
00500b9e : MOV dword ptr [EDI + 0x4],ESI
00500ba1 : INC dword ptr [ESI + 0x8]
00500ba4 : ADD dword ptr [ESI + 0x8],-0x1
00500ba8 : JNZ 0x00500bb1
00500baa : MOV ECX,ESI
00500bac : CALL 0x00525340
00500bb1 : MOV ESI,dword ptr [ESP + 0xc]
00500bb5 : AND ESI,0xfffffffc
00500bb8 : PUSH -0x1
00500bba : LEA EDX,[ESI + 0x4]
00500bbd : PUSH EDX
00500bbe : CALL dword ptr [0x00b851cc]
00500bc4 : SUB EAX,0x1
00500bc7 : JNZ 0x00500bcf
00500bc9 : PUSH ESI
00500bca : CALL 0x00515cf0
00500bcf : MOV EAX,dword ptr [ESP + 0x10]
00500bd3 : PUSH 0x1
00500bd5 : PUSH 0x0
00500bd7 : PUSH EDI
00500bd8 : PUSH EAX
00500bd9 : MOV ECX,EBX
00500bdb : CALL 0x005334f0
00500be0 : POP ESI
00500be1 : POP EBX
00500be2 : POP EDI
00500be3 : ADD ESP,0x8
00500be6 : RET

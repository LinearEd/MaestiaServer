PROGRAM  : Maestia.exe
FUNCTION : FUN_00415ad0
ENTRY    : 00415ad0
BODY     : [[00415ad0, 00415c5a] [00415c64, 00415c7e] [00415ccf, 00415d6a] [00415d8b, 00415e08]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00415ad0(int param_1,int param_2,uint param_3)

{
  uint *puVar1;
  int iVar2;
  uint uVar3;
  undefined4 uVar4;
  int extraout_ECX;
  int iVar5;
  uint uStack_a0;
  uint local_84;
  uint local_80;
  undefined1 local_7c [100];
  uint local_18;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7c3c4;
  local_10 = ExceptionList;
  uStack_a0 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&uStack_a0;
  ExceptionList = &local_10;
  iVar2 = *(int *)(param_1 + 4);
  if (iVar2 == 0) {
    local_84 = 0;
  }
  else {
    local_84 = (*(int *)(param_1 + 0xc) - iVar2) / 0x5c;
  }
  iVar5 = *(int *)(param_1 + 8);
  iVar2 = (iVar5 - iVar2) / 0x5c;
  local_18 = uStack_a0;
  puVar1 = &uStack_a0;
  if (iVar2 == 0x2c8590b) {
    iVar2 = FUN_00452880();
    iVar5 = extraout_ECX;
    puVar1 = (uint *)local_14;
  }
  local_14 = (undefined1 *)puVar1;
  uVar3 = iVar2 + 1;
  if (local_84 < uVar3) {
    if (0x2c8590b - (local_84 >> 1) < local_84) {
      local_84 = 0;
    }
    else {
      local_84 = local_84 + (local_84 >> 1);
    }
    if (local_84 < uVar3) {
      local_84 = uVar3;
    }
    iVar2 = FUN_00417070();
    local_8 = 0;
    FUN_00415330();
    FUN_00417040(*(undefined4 *)(param_1 + 4),param_2);
    FUN_00417040(param_2,*(undefined4 *)(param_1 + 8));
    local_8 = 0xffffffff;
    if (*(int *)(param_1 + 4) != 0) {
      FUN_00415ab0();
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    *(uint *)(param_1 + 0xc) = local_84 * 0x5c + iVar2;
    *(int *)(param_1 + 8) =
         ((*(int *)(param_1 + 8) - *(int *)(param_1 + 4)) / 0x5c + 1) * 0x5c + iVar2;
    *(int *)(param_1 + 4) = iVar2;
  }
  else {
    iVar2 = iVar5 - param_2 >> 0x1f;
    if ((iVar5 - param_2) / 0x5c + iVar2 == iVar2) {
      FUN_004165b0(local_7c);
      local_8 = 2;
      FUN_00417040(param_2,*(undefined4 *)(param_1 + 8));
      local_8 = CONCAT31(local_8._1_3_,3);
      FUN_00415330();
      local_8 = 2;
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 0x5c;
      FUN_004177d0(*(int *)(param_1 + 8) + -0x5c);
    }
    else {
      FUN_004165b0(local_7c);
      local_8 = 5;
      uVar4 = FUN_00417040(*(int *)(param_1 + 8) + -0x5c,*(int *)(param_1 + 8));
      *(undefined4 *)(param_1 + 8) = uVar4;
      local_80 = param_3 & 0xffffff00;
      FUN_00417d90(param_2,local_80,local_80,local_80);
      FUN_004177d0(param_2 + 0x5c);
    }
    local_8 = 0xffffffff;
    FUN_004147c0(local_7c);
  }
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00415ad0 : PUSH EBP
00415ad1 : MOV EBP,ESP
00415ad3 : PUSH -0x1
00415ad5 : PUSH 0xb7c3c4
00415ada : MOV EAX,FS:[0x0]
00415ae0 : PUSH EAX
00415ae1 : SUB ESP,0x80
00415ae7 : MOV EAX,[0x00d66fa0]
00415aec : XOR EAX,EBP
00415aee : MOV dword ptr [EBP + -0x14],EAX
00415af1 : PUSH EBX
00415af2 : PUSH ESI
00415af3 : PUSH EDI
00415af4 : PUSH EAX
00415af5 : LEA EAX,[EBP + -0xc]
00415af8 : MOV FS:[0x0],EAX
00415afe : MOV dword ptr [EBP + -0x10],ESP
00415b01 : MOV EBX,dword ptr [EBP + 0x8]
00415b04 : MOV dword ptr [EBP + 0xffffff7c],EBX
00415b0a : MOV EAX,dword ptr [EBP + 0x10]
00415b0d : MOV dword ptr [EBP + -0x7c],EAX
00415b10 : MOV ESI,dword ptr [EBX + 0x4]
00415b13 : TEST ESI,ESI
00415b15 : JNZ 0x00415b1c
00415b17 : MOV dword ptr [EBP + -0x80],ESI
00415b1a : JMP 0x00415b37
00415b1c : MOV ECX,dword ptr [EBX + 0xc]
00415b1f : SUB ECX,ESI
00415b21 : MOV EAX,0xb21642c9
00415b26 : IMUL ECX
00415b28 : ADD EDX,ECX
00415b2a : SAR EDX,0x6
00415b2d : MOV EAX,EDX
00415b2f : SHR EAX,0x1f
00415b32 : ADD EAX,EDX
00415b34 : MOV dword ptr [EBP + -0x80],EAX
00415b37 : MOV ECX,dword ptr [EBX + 0x8]
00415b3a : MOV EDI,ECX
00415b3c : SUB EDI,ESI
00415b3e : MOV EAX,0xb21642c9
00415b43 : IMUL EDI
00415b45 : ADD EDX,EDI
00415b47 : SAR EDX,0x6
00415b4a : MOV EAX,EDX
00415b4c : SHR EAX,0x1f
00415b4f : ADD EAX,EDX
00415b51 : MOV EDX,0x2c8590b
00415b56 : SUB EDX,EAX
00415b58 : CMP EDX,0x1
00415b5b : JNC 0x00415b62
00415b5d : CALL 0x00452880
00415b62 : INC EAX
00415b63 : MOV EDX,dword ptr [EBP + -0x80]
00415b66 : CMP EDX,EAX
00415b68 : JNC 0x00415ccf
00415b6e : MOV ECX,EDX
00415b70 : SHR ECX,0x1
00415b72 : MOV ESI,0x2c8590b
00415b77 : SUB ESI,ECX
00415b79 : CMP ESI,EDX
00415b7b : JNC 0x00415b89
00415b7d : MOV dword ptr [EBP + -0x80],0x0
00415b84 : MOV EDX,dword ptr [EBP + -0x80]
00415b87 : JMP 0x00415b8e
00415b89 : ADD EDX,ECX
00415b8b : MOV dword ptr [EBP + -0x80],EDX
00415b8e : CMP EDX,EAX
00415b90 : JNC 0x00415b97
00415b92 : MOV dword ptr [EBP + -0x80],EAX
00415b95 : MOV EDX,EAX
00415b97 : MOV ECX,EDX
00415b99 : CALL 0x00417070
00415b9e : MOV ESI,EAX
00415ba0 : MOV dword ptr [EBP + 0xffffff74],ESI
00415ba6 : MOV ECX,dword ptr [EBP + 0xc]
00415ba9 : SUB ECX,dword ptr [EBX + 0x4]
00415bac : MOV EAX,0xb21642c9
00415bb1 : IMUL ECX
00415bb3 : ADD EDX,ECX
00415bb5 : SAR EDX,0x6
00415bb8 : MOV EDI,EDX
00415bba : SHR EDI,0x1f
00415bbd : ADD EDI,EDX
00415bbf : MOV dword ptr [EBP + 0xffffff7c],EDI
00415bc5 : XOR EAX,EAX
00415bc7 : MOV dword ptr [EBP + 0xffffff78],EAX
00415bcd : MOV dword ptr [EBP + -0x4],EAX
00415bd0 : IMUL EDI,EDI,0x5c
00415bd3 : ADD EDI,ESI
00415bd5 : MOV EDX,dword ptr [EBP + -0x7c]
00415bd8 : LEA ESI,[EAX + 0x1]
00415bdb : CALL 0x00415330
00415be0 : MOV dword ptr [EBP + 0xffffff78],ESI
00415be6 : MOV EAX,dword ptr [EBP + 0xc]
00415be9 : PUSH EAX
00415bea : MOV ECX,dword ptr [EBX + 0x4]
00415bed : PUSH ECX
00415bee : MOV EDI,dword ptr [EBP + 0xffffff74]
00415bf4 : MOV EDX,EDI
00415bf6 : CALL 0x00417040
00415bfb : MOV dword ptr [EBP + 0xffffff78],0x2
00415c05 : MOV EDX,dword ptr [EBP + 0xffffff7c]
00415c0b : INC EDX
00415c0c : IMUL EDX,EDX,0x5c
00415c0f : ADD EDX,EDI
00415c11 : MOV EAX,dword ptr [EBX + 0x8]
00415c14 : PUSH EAX
00415c15 : MOV ECX,dword ptr [EBP + 0xc]
00415c18 : PUSH ECX
00415c19 : CALL 0x00417040
00415c1e : MOV dword ptr [EBP + -0x4],0xffffffff
00415c25 : MOV ECX,dword ptr [EBX + 0x8]
00415c28 : MOV ESI,dword ptr [EBX + 0x4]
00415c2b : SUB ECX,ESI
00415c2d : MOV EAX,0xb21642c9
00415c32 : IMUL ECX
00415c34 : ADD EDX,ECX
00415c36 : SAR EDX,0x6
00415c39 : MOV EAX,EDX
00415c3b : SHR EAX,0x1f
00415c3e : LEA EDX,[EDX + EAX*0x1 + 0x1]
00415c42 : MOV dword ptr [EBP + -0x7c],EDX
00415c45 : TEST ESI,ESI
00415c47 : JZ 0x00415c64
00415c49 : MOV EDI,dword ptr [EBX + 0x8]
00415c4c : MOV EAX,ESI
00415c4e : CALL 0x00415ab0
00415c53 : MOV ECX,dword ptr [EBX + 0x4]
00415c56 : CALL 0x006f04e0
00415c64 : MOV EAX,dword ptr [EBP + -0x80]
00415c67 : IMUL EAX,EAX,0x5c
00415c6a : ADD EAX,EDI
00415c6c : MOV dword ptr [EBX + 0xc],EAX
00415c6f : IMUL EDX,EDX,0x5c
00415c72 : ADD EDX,EDI
00415c74 : MOV dword ptr [EBX + 0x8],EDX
00415c77 : MOV dword ptr [EBX + 0x4],EDI
00415c7a : JMP 0x00415deb
00415ccf : SUB ECX,dword ptr [EBP + 0xc]
00415cd2 : MOV EAX,0xb21642c9
00415cd7 : IMUL ECX
00415cd9 : ADD EDX,ECX
00415cdb : SAR EDX,0x6
00415cde : MOV ECX,EDX
00415ce0 : SHR ECX,0x1f
00415ce3 : ADD ECX,EDX
00415ce5 : CMP ECX,0x1
00415ce8 : MOV ECX,dword ptr [EBP + -0x7c]
00415ceb : JNC 0x00415d8b
00415cf1 : LEA EDX,[EBP + -0x78]
00415cf4 : PUSH EDX
00415cf5 : CALL 0x004165b0
00415cfa : MOV dword ptr [EBP + -0x4],0x2
00415d01 : MOV EAX,dword ptr [EBP + 0xc]
00415d04 : LEA EDX,[EAX + 0x5c]
00415d07 : MOV ECX,dword ptr [EBX + 0x8]
00415d0a : PUSH ECX
00415d0b : PUSH EAX
00415d0c : CALL 0x00417040
00415d11 : MOV byte ptr [EBP + -0x4],0x3
00415d15 : MOV EDI,dword ptr [EBX + 0x8]
00415d18 : MOV ECX,EDI
00415d1a : SUB ECX,dword ptr [EBP + 0xc]
00415d1d : MOV EAX,0xb21642c9
00415d22 : IMUL ECX
00415d24 : ADD EDX,ECX
00415d26 : SAR EDX,0x6
00415d29 : MOV EAX,EDX
00415d2b : SHR EAX,0x1f
00415d2e : ADD EAX,EDX
00415d30 : MOV ESI,0x1
00415d35 : SUB ESI,EAX
00415d37 : LEA EDX,[EBP + -0x78]
00415d3a : CALL 0x00415330
00415d3f : MOV dword ptr [EBP + -0x4],0x2
00415d46 : ADD dword ptr [EBX + 0x8],0x5c
00415d4a : MOV EBX,dword ptr [EBX + 0x8]
00415d4d : LEA EAX,[EBX + -0x5c]
00415d50 : PUSH EAX
00415d51 : LEA EDI,[EBP + -0x78]
00415d54 : MOV EAX,dword ptr [EBP + 0xc]
00415d57 : CALL 0x004177d0
00415d5c : ADD ESP,0x4
00415d5f : MOV dword ptr [EBP + -0x4],0xffffffff
00415d66 : MOV ECX,EDI
00415d68 : PUSH ECX
00415d69 : JMP 0x00415de6
00415d8b : LEA EAX,[EBP + -0x78]
00415d8e : PUSH EAX
00415d8f : CALL 0x004165b0
00415d94 : MOV dword ptr [EBP + -0x4],0x5
00415d9b : MOV ESI,dword ptr [EBX + 0x8]
00415d9e : LEA EDI,[ESI + -0x5c]
00415da1 : PUSH ESI
00415da2 : PUSH EDI
00415da3 : MOV EDX,ESI
00415da5 : CALL 0x00417040
00415daa : MOV dword ptr [EBX + 0x8],EAX
00415dad : MOV byte ptr [EBP + -0x7c],0x0
00415db1 : MOV ECX,dword ptr [EBP + -0x7c]
00415db4 : PUSH ECX
00415db5 : MOV EDX,dword ptr [EBP + -0x7c]
00415db8 : PUSH EDX
00415db9 : MOV EAX,dword ptr [EBP + -0x7c]
00415dbc : PUSH EAX
00415dbd : MOV ECX,dword ptr [EBP + 0xc]
00415dc0 : PUSH ECX
00415dc1 : MOV EAX,ESI
00415dc3 : MOV ECX,EDI
00415dc5 : CALL 0x00417d90
00415dca : MOV EAX,dword ptr [EBP + 0xc]
00415dcd : LEA EDX,[EAX + 0x5c]
00415dd0 : PUSH EDX
00415dd1 : LEA EDI,[EBP + -0x78]
00415dd4 : CALL 0x004177d0
00415dd9 : ADD ESP,0x14
00415ddc : MOV dword ptr [EBP + -0x4],0xffffffff
00415de3 : MOV EAX,EDI
00415de5 : PUSH EAX
00415de6 : CALL 0x004147c0
00415deb : MOV ECX,dword ptr [EBP + -0xc]
00415dee : MOV dword ptr FS:[0x0],ECX
00415df5 : POP ECX
00415df6 : POP EDI
00415df7 : POP ESI
00415df8 : POP EBX
00415df9 : MOV ECX,dword ptr [EBP + -0x14]
00415dfc : XOR ECX,EBP
00415dfe : CALL 0x00633e6b
00415e03 : MOV ESP,EBP
00415e05 : POP EBP
00415e06 : RET 0xc

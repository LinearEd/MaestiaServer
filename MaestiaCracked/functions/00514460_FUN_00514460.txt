PROGRAM  : Maestia.exe
FUNCTION : FUN_00514460
ENTRY    : 00514460
BODY     : [[00514460, 00514c79]]

============================================================
DECOMPILED C CODE
============================================================

undefined4
FUN_00514460(uint param_1,undefined4 param_2,uint param_3,undefined4 param_4,undefined4 param_5)

{
  int *piVar1;
  bool bVar2;
  char cVar3;
  undefined4 uVar4;
  int iVar5;
  LONG LVar6;
  int iVar7;
  int iVar8;
  GRefCountImpl *pGVar9;
  GRefCountImpl **ppGVar10;
  undefined1 *puVar11;
  GRefCountImpl *pGVar12;
  uint uVar13;
  code *pcVar14;
  uint uVar15;
  undefined8 uVar16;
  uint local_38;
  GRefCountImpl *local_34;
  int iStack_30;
  GRefCountImpl *local_2c;
  GRefCountImpl *local_28;
  int local_24;
  uint uStack_20;
  int local_1c;
  int local_18;
  undefined4 local_14;
  int local_10;
  GRefCountImpl *local_c;
  int *local_8;
  undefined4 uStack_4;
  
  FUN_0051b6e0();
  uVar13 = param_1;
  FUN_005a03c0(&local_38,param_2);
  local_18 = *(int *)(uVar13 + 0xc);
  local_10 = 0;
  local_c = (GRefCountImpl *)0x0;
  local_24 = 0;
  bVar2 = false;
  local_1c = 0;
  local_34 = (GRefCountImpl *)0x0;
  local_28 = (GRefCountImpl *)0x0;
  local_2c = (GRefCountImpl *)0x0;
  local_14 = 0;
  if (*(int *)(*(int *)(uVar13 + 8) + 0x28) != 0) {
    param_3 = param_3 | 0x11;
  }
  if (((param_3 & 0x20) != 0) || (param_1 = param_1 & 0xffffff00, (param_3 & 0x10) == 0)) {
    param_1 = CONCAT31(param_1._1_3_,1);
  }
  uVar4 = FUN_005a02c0(param_3);
  piVar1 = *(int **)(*(int *)(uVar13 + 8) + 8);
  if (piVar1 == (int *)0x0) {
    uVar16 = 0;
  }
  else {
    uVar16 = (**(code **)(*piVar1 + 8))((local_38 & 0xfffffffc) + 8);
  }
  FUN_00562db0(&local_8,(local_38 & 0xfffffffc) + 8,uVar16,piVar1,uVar4,
               *(undefined4 *)(*(int *)(uVar13 + 8) + 0x20));
  iVar5 = FUN_00524930(&local_10,&local_8);
  if (iVar5 == 3) {
    FUN_0051b6e0();
    local_2c = (GRefCountImpl *)FUN_00512de0(&local_14,&local_1c,&uStack_20);
    if (local_2c == (GRefCountImpl *)0x0) {
      if (local_18 != 0) {
        FUN_00500460(local_18 + 0xc,&DAT_00cd4480,(uStack_20 & 0xfffffffc) + 8);
      }
      FUN_00524480((uStack_20 & 0xfffffffc) + 8);
      pcVar14 = InterlockedExchangeAdd_exref;
      LVar6 = InterlockedExchangeAdd((LONG *)((uStack_20 & 0xfffffffc) + 4),-1);
      if (LVar6 == 1) {
        FUN_00515cf0(uStack_20 & 0xfffffffc);
      }
      if (local_8 != (int *)0x0) {
        (**(code **)(*local_8 + 8))(uStack_4);
      }
      if (local_10 == 1) {
        FUN_00524240();
      }
      else if (1 < local_10) {
        GRefCountImpl::Release(local_c);
      }
      uVar13 = local_38 & 0xfffffffc;
      iVar5 = uVar13 + 4;
    }
    else {
      uVar15 = local_38 & 0xfffffffc;
      iVar7 = FUN_00515840(0x24,0);
      iVar5 = local_1c;
      if (iVar7 == 0) {
        iVar7 = 0;
      }
      else {
        iVar7 = FUN_00567e60(&local_8,local_1c,uVar15 + 8,0,(byte)(param_3 >> 0x1c) & 1,param_5);
      }
      iStack_30 = iVar7;
      if (iVar7 != 0) {
        FUN_005a02e0(iVar7);
        if (iVar5 != 1) {
          ppGVar10 = (GRefCountImpl **)0x0;
LAB_005147c2:
          local_24 = FUN_00513090(uVar13,iVar7,param_3,ppGVar10,1,param_4,param_5,0);
LAB_005147e4:
          FUN_005243e0(iVar7);
          bVar2 = true;
          LVar6 = InterlockedExchangeAdd((LONG *)((uStack_20 & 0xfffffffc) + 4),-1);
          if (LVar6 == 1) {
            FUN_00515cf0(uStack_20 & 0xfffffffc);
          }
          uVar15 = param_3;
          if ((char)param_1 != '\0') goto LAB_0051494a;
          if (local_24 == 0) goto LAB_00514827;
          goto LAB_00514a54;
        }
        iVar8 = FUN_00515840(0x318,0);
        if (iVar8 == 0) {
          pGVar9 = (GRefCountImpl *)0x0;
        }
        else {
          pGVar9 = (GRefCountImpl *)FUN_005a11c0(iVar7,uVar13,param_3);
        }
        local_28 = pGVar9;
        if (pGVar9 != (GRefCountImpl *)0x0) {
          cVar3 = FUN_005a0410(local_2c);
          if (cVar3 != '\0') {
            if ((char)param_1 != '\0') {
              ppGVar10 = &local_34;
              goto LAB_005147c2;
            }
            goto LAB_005147e4;
          }
          GRefCountImpl::Release(pGVar9);
        }
        FUN_00524240();
        iStack_30 = 0;
      }
      iVar5 = iStack_30;
      FUN_0051c4c0("Failed to load SWF file \"",(local_38 & 0xfffffffc) + 8,&DAT_00b86d78);
      FUN_00524480((param_3 & 0xfffffffc) + 8);
      pcVar14 = InterlockedExchangeAdd_exref;
      uVar13 = param_3 & 0xfffffffc;
      LVar6 = InterlockedExchangeAdd((LONG *)(uVar13 + 4),-1);
      if (LVar6 == 1) {
        FUN_00515cf0(uVar13);
      }
      LVar6 = InterlockedExchangeAdd((LONG *)((uStack_20 & 0xfffffffc) + 4),-1);
      if (LVar6 == 1) {
        FUN_00515cf0(uStack_20 & 0xfffffffc);
      }
      if (local_8 != (int *)0x0) {
        (**(code **)(*local_8 + 8))(uStack_4);
      }
      GRefCountImpl::Release(local_2c);
      if (iVar5 != 0) {
        FUN_00524240();
      }
      if (local_10 == 1) {
        FUN_00524240();
        uVar13 = local_38 & 0xfffffffc;
        iVar5 = uVar13 + 4;
      }
      else {
        if (1 < local_10) {
          GRefCountImpl::Release(local_c);
        }
        uVar13 = local_38 & 0xfffffffc;
        iVar5 = uVar13 + 4;
      }
    }
    iVar5 = (*pcVar14)(iVar5,0xffffffff);
LAB_0051461d:
    if (iVar5 == 1) {
      FUN_00515cf0(uVar13);
    }
    return 0;
  }
  iStack_30 = FUN_00523e20();
  iVar5 = local_18;
  if (iStack_30 == 0) {
    if (local_18 != 0) {
      if (local_10 < 2) {
        puVar11 = &DAT_00cca874;
      }
      else {
        puVar11 = (undefined1 *)FUN_00523770();
      }
      FUN_00500460(iVar5 + 0xc,"Error: %s",puVar11);
    }
    if (local_8 != (int *)0x0) {
      (**(code **)(*local_8 + 8))(uStack_4);
    }
    if (local_10 == 1) {
      FUN_00524240();
    }
    else if (1 < local_10) {
      GRefCountImpl::Release(local_c);
    }
    uVar13 = local_38 & 0xfffffffc;
    iVar5 = InterlockedExchangeAdd((LONG *)(uVar13 + 4),-1);
    goto LAB_0051461d;
  }
  iVar5 = *(int *)(iStack_30 + 0x1c);
  FUN_005a02e0(iStack_30);
LAB_00514827:
  uVar15 = param_3;
  param_1 = param_1 & 0xffffff00;
  local_24 = FUN_00513090(uVar13,iStack_30,param_3,~-(uint)(iVar5 != 1) & (uint)&local_34,0,param_4,
                          param_5,&param_1);
  if ((iVar5 == 2) && ((char)param_1 != '\0')) {
    bVar2 = true;
  }
LAB_0051494a:
  if (local_24 == 0) {
    if (local_8 != (int *)0x0) {
      (**(code **)(*local_8 + 8))(uStack_4);
    }
    if (local_2c != (GRefCountImpl *)0x0) {
      GRefCountImpl::Release(local_2c);
    }
    if (local_28 != (GRefCountImpl *)0x0) {
      GRefCountImpl::Release(local_28);
    }
    if (local_34 != (GRefCountImpl *)0x0) {
      GRefCountImpl::Release(local_34);
    }
    FUN_00524240();
    if (local_10 == 1) {
      FUN_00524240();
    }
    else if (1 < local_10) {
      GRefCountImpl::Release(local_c);
    }
    uVar13 = local_38 & 0xfffffffc;
    iVar5 = InterlockedExchangeAdd((LONG *)(uVar13 + 4),-1);
    goto LAB_0051461d;
  }
  pGVar9 = local_2c;
  if (!bVar2) goto LAB_005149da;
LAB_00514a54:
  pGVar12 = local_28;
  pGVar9 = local_34;
  if (iVar5 == 1) {
    if ((uVar15 & 0x30) == 0) {
      if (local_34 != (GRefCountImpl *)0x0) {
        FUN_00512c30(local_34);
      }
    }
    else {
      pGVar9 = (GRefCountImpl *)0x0;
    }
    *(undefined4 *)(pGVar12 + 0x2c0) = *(undefined4 *)(local_34 + 0x30);
    if (((uVar15 & 1) != 0) || (cVar3 = FUN_005a03f0(pGVar12), cVar3 == '\0')) {
      (**(code **)(*(int *)pGVar12 + 4))();
    }
    if (pGVar9 != (GRefCountImpl *)0x0) {
      GRefCountImpl::Release(local_34);
      local_34 = (GRefCountImpl *)0x0;
    }
    GRefCountImpl::Release(pGVar12);
    local_28 = (GRefCountImpl *)0x0;
    if (local_2c != (GRefCountImpl *)0x0) {
      GRefCountImpl::Release(local_2c);
    }
    pGVar9 = (GRefCountImpl *)0x0;
  }
  else {
    if (local_2c == (GRefCountImpl *)0x0) {
      FUN_0051b6e0();
      local_2c = (GRefCountImpl *)FUN_00512de0(&local_14,&local_1c,&param_1);
      if (local_2c == (GRefCountImpl *)0x0) {
        if (local_18 != 0) {
          FUN_00500460(local_18 + 0xc,&DAT_00cd4480,(param_1 & 0xfffffffc) + 8);
        }
        FUN_00524240();
        FUN_0045b730();
        FUN_004ffc10();
        goto LAB_00514b5e;
      }
      FUN_0045b730();
      uVar15 = param_3;
    }
    pGVar9 = local_2c;
    iVar5 = FUN_00515840(0x28,0);
    if (iVar5 == 0) {
      pGVar12 = (GRefCountImpl *)0x0;
    }
    else {
      pGVar12 = (GRefCountImpl *)FUN_00514210(iStack_30,local_24,pGVar9,local_14,uVar13);
    }
    if ((((uVar15 & 0x11) != 0) || (cVar3 = FUN_005a03f0(pGVar12), cVar3 == '\0')) &&
       ((**(code **)(*(int *)pGVar12 + 4))(), *(int *)(pGVar12 + 0x24) == 0)) {
      if (local_24 != 0) {
        FUN_00524240();
      }
      GRefCountImpl::Release(pGVar12);
      FUN_004ffc10();
      if (pGVar9 != (GRefCountImpl *)0x0) {
        GRefCountImpl::Release(pGVar9);
      }
LAB_00514b5e:
      if (local_28 != (GRefCountImpl *)0x0) {
        GRefCountImpl::Release(local_28);
      }
      if (local_34 != (GRefCountImpl *)0x0) {
        GRefCountImpl::Release(local_34);
      }
      FUN_00524240();
      FUN_00512710();
      FUN_0045b730();
      return 0;
    }
    if (pGVar12 != (GRefCountImpl *)0x0) {
      GRefCountImpl::Release(pGVar12);
    }
  }
LAB_005149da:
  pGVar12 = local_34;
  uVar4 = FUN_00512f50(local_24,local_34,uVar13,uVar15,param_4);
  if (local_8 != (int *)0x0) {
    (**(code **)(*local_8 + 8))(uStack_4);
  }
  if (pGVar9 != (GRefCountImpl *)0x0) {
    GRefCountImpl::Release(pGVar9);
  }
  if (local_28 != (GRefCountImpl *)0x0) {
    GRefCountImpl::Release(local_28);
  }
  if (pGVar12 != (GRefCountImpl *)0x0) {
    GRefCountImpl::Release(pGVar12);
  }
  FUN_00524240();
  if (local_10 == 1) {
    FUN_00524240();
  }
  else if (1 < local_10) {
    GRefCountImpl::Release(local_c);
  }
  LVar6 = InterlockedExchangeAdd((LONG *)((local_38 & 0xfffffffc) + 4),-1);
  if (LVar6 == 1) {
    FUN_00515cf0(local_38 & 0xfffffffc);
  }
  return uVar4;
}



============================================================
DISASSEMBLY
============================================================
00514460 : SUB ESP,0x3c
00514463 : PUSH EBX
00514464 : PUSH EBP
00514465 : PUSH ESI
00514466 : PUSH EDI
00514467 : LEA ECX,[ESP + 0x14]
0051446b : CALL 0x0051b6e0
00514470 : MOV EAX,dword ptr [ESP + 0x54]
00514474 : MOV ESI,dword ptr [ESP + 0x50]
00514478 : PUSH EAX
00514479 : LEA ECX,[ESP + 0x18]
0051447d : PUSH ECX
0051447e : MOV ECX,ESI
00514480 : CALL 0x005a03c0
00514485 : MOV EAX,dword ptr [ESI + 0x8]
00514488 : MOV EDX,dword ptr [ESI + 0xc]
0051448b : XOR EBP,EBP
0051448d : MOV dword ptr [ESP + 0x3c],EBP
00514491 : MOV dword ptr [ESP + 0x40],EBP
00514495 : CMP dword ptr [EAX + 0x28],EBP
00514498 : MOV EAX,dword ptr [ESP + 0x58]
0051449c : MOV dword ptr [ESP + 0x28],EBP
005144a0 : MOV dword ptr [ESP + 0x34],EDX
005144a4 : MOV byte ptr [ESP + 0x13],0x0
005144a9 : MOV dword ptr [ESP + 0x30],EBP
005144ad : MOV dword ptr [ESP + 0x18],EBP
005144b1 : MOV dword ptr [ESP + 0x24],EBP
005144b5 : MOV dword ptr [ESP + 0x20],EBP
005144b9 : MOV dword ptr [ESP + 0x38],EBP
005144bd : JZ 0x005144c6
005144bf : OR EAX,0x11
005144c2 : MOV dword ptr [ESP + 0x58],EAX
005144c6 : TEST AL,0x20
005144c8 : JNZ 0x005144d3
005144ca : MOV byte ptr [ESP + 0x50],0x0
005144cf : TEST AL,0x10
005144d1 : JNZ 0x005144d8
005144d3 : MOV byte ptr [ESP + 0x50],0x1
005144d8 : PUSH EAX
005144d9 : MOV ECX,ESI
005144db : CALL 0x005a02c0
005144e0 : MOV ECX,dword ptr [ESI + 0x8]
005144e3 : MOV EDI,dword ptr [ECX + 0x8]
005144e6 : MOV EBX,EAX
005144e8 : CMP EDI,EBP
005144ea : JZ 0x00514502
005144ec : MOV EAX,dword ptr [ESP + 0x14]
005144f0 : MOV EDX,dword ptr [EDI]
005144f2 : AND EAX,0xfffffffc
005144f5 : ADD EAX,0x8
005144f8 : PUSH EAX
005144f9 : MOV EAX,dword ptr [EDX + 0x8]
005144fc : MOV ECX,EDI
005144fe : CALL EAX
00514500 : JMP 0x00514506
00514502 : XOR EAX,EAX
00514504 : XOR EDX,EDX
00514506 : MOV ECX,dword ptr [ESI + 0x8]
00514509 : MOV ECX,dword ptr [ECX + 0x20]
0051450c : PUSH ECX
0051450d : PUSH EBX
0051450e : PUSH EDI
0051450f : PUSH EDX
00514510 : MOV EDX,dword ptr [ESP + 0x24]
00514514 : PUSH EAX
00514515 : AND EDX,0xfffffffc
00514518 : ADD EDX,0x8
0051451b : PUSH EDX
0051451c : LEA EAX,[ESP + 0x5c]
00514520 : PUSH EAX
00514521 : CALL 0x00562db0
00514526 : MOV ECX,dword ptr [ESI + 0x38]
00514529 : ADD ESP,0x1c
0051452c : LEA EDX,[ESP + 0x44]
00514530 : PUSH EDX
00514531 : LEA EAX,[ESP + 0x40]
00514535 : PUSH EAX
00514536 : CALL 0x00524930
0051453b : CMP EAX,0x3
0051453e : JNZ 0x005148a2
00514544 : LEA ECX,[ESP + 0x2c]
00514548 : CALL 0x0051b6e0
0051454d : MOV EAX,dword ptr [ESP + 0x14]
00514551 : MOV EBX,dword ptr [ESP + 0x58]
00514555 : LEA ECX,[ESP + 0x2c]
00514559 : PUSH ECX
0051455a : LEA EDX,[ESP + 0x34]
0051455e : PUSH EDX
0051455f : LEA ECX,[ESP + 0x40]
00514563 : AND EAX,0xfffffffc
00514566 : PUSH ECX
00514567 : ADD EAX,0x8
0051456a : MOV ECX,ESI
0051456c : CALL 0x00512de0
00514571 : ADD ESP,0xc
00514574 : MOV dword ptr [ESP + 0x20],EAX
00514578 : TEST EAX,EAX
0051457a : JNZ 0x00514632
00514580 : MOV EAX,dword ptr [ESP + 0x34]
00514584 : TEST EAX,EAX
00514586 : JZ 0x005145a4
00514588 : MOV EDX,dword ptr [ESP + 0x2c]
0051458c : AND EDX,0xfffffffc
0051458f : ADD EDX,0x8
00514592 : PUSH EDX
00514593 : ADD EAX,0xc
00514596 : PUSH 0xcd4480
0051459b : PUSH EAX
0051459c : CALL 0x00500460
005145a1 : ADD ESP,0xc
005145a4 : MOV EAX,dword ptr [ESP + 0x2c]
005145a8 : MOV ECX,dword ptr [ESP + 0x40]
005145ac : AND EAX,0xfffffffc
005145af : ADD EAX,0x8
005145b2 : PUSH EAX
005145b3 : CALL 0x00524480
005145b8 : MOV ESI,dword ptr [ESP + 0x2c]
005145bc : MOV EDI,dword ptr [0x00b851cc]
005145c2 : AND ESI,0xfffffffc
005145c5 : PUSH -0x1
005145c7 : LEA ECX,[ESI + 0x4]
005145ca : PUSH ECX
005145cb : CALL EDI
005145cd : SUB EAX,0x1
005145d0 : JNZ 0x005145d8
005145d2 : PUSH ESI
005145d3 : CALL 0x00515cf0
005145d8 : MOV ECX,dword ptr [ESP + 0x44]
005145dc : TEST ECX,ECX
005145de : JZ 0x005145ec
005145e0 : MOV EDX,dword ptr [ECX]
005145e2 : MOV EAX,dword ptr [ESP + 0x48]
005145e6 : MOV EDX,dword ptr [EDX + 0x8]
005145e9 : PUSH EAX
005145ea : CALL EDX
005145ec : MOV EAX,dword ptr [ESP + 0x3c]
005145f0 : CMP EAX,0x1
005145f3 : JNZ 0x00514600
005145f5 : MOV ECX,dword ptr [ESP + 0x40]
005145f9 : CALL 0x00524240
005145fe : JMP 0x0051460e
00514600 : CMP EAX,0x2
00514603 : JL 0x0051460e
00514605 : MOV ECX,dword ptr [ESP + 0x40]
00514609 : CALL 0x004ff7e0
0051460e : MOV ESI,dword ptr [ESP + 0x14]
00514612 : AND ESI,0xfffffffc
00514615 : PUSH -0x1
00514617 : LEA EAX,[ESI + 0x4]
0051461a : PUSH EAX
0051461b : CALL EDI
0051461d : SUB EAX,0x1
00514620 : JNZ 0x00514628
00514622 : PUSH ESI
00514623 : CALL 0x00515cf0
00514628 : POP EDI
00514629 : POP ESI
0051462a : POP EBP
0051462b : XOR EAX,EAX
0051462d : POP EBX
0051462e : ADD ESP,0x3c
00514631 : RET
00514632 : MOV EDI,dword ptr [ESP + 0x14]
00514636 : MOV ECX,dword ptr [0x00d73250]
0051463c : PUSH 0x0
0051463e : PUSH 0x24
00514640 : AND EDI,0xfffffffc
00514643 : CALL 0x00515840
00514648 : MOV EBP,dword ptr [ESP + 0x30]
0051464c : TEST EAX,EAX
0051464e : JZ 0x0051467a
00514650 : MOV EDX,dword ptr [ESP + 0x58]
00514654 : MOV ECX,dword ptr [ESP + 0x60]
00514658 : PUSH ECX
00514659 : SHR EDX,0x1c
0051465c : AND DL,0x1
0051465f : MOVZX ECX,DL
00514662 : PUSH ECX
00514663 : PUSH 0x0
00514665 : ADD EDI,0x8
00514668 : PUSH EDI
00514669 : PUSH EBP
0051466a : LEA EDX,[ESP + 0x58]
0051466e : PUSH EDX
0051466f : MOV ECX,EAX
00514671 : CALL 0x00567e60
00514676 : MOV EDI,EAX
00514678 : JMP 0x0051467c
0051467a : XOR EDI,EDI
0051467c : MOV EBX,EDI
0051467e : MOV dword ptr [ESP + 0x1c],EBX
00514682 : TEST EDI,EDI
00514684 : JZ 0x005146f7
00514686 : PUSH EDI
00514687 : MOV ECX,ESI
00514689 : CALL 0x005a02e0
0051468e : CMP EBP,0x1
00514691 : JNZ 0x005147c0
00514697 : MOV ECX,dword ptr [0x00d73250]
0051469d : PUSH 0x0
0051469f : PUSH 0x318
005146a4 : CALL 0x00515840
005146a9 : TEST EAX,EAX
005146ab : JZ 0x005146bf
005146ad : MOV ECX,dword ptr [ESP + 0x58]
005146b1 : PUSH ECX
005146b2 : PUSH ESI
005146b3 : PUSH EDI
005146b4 : MOV ECX,EAX
005146b6 : CALL 0x005a11c0
005146bb : MOV EBX,EAX
005146bd : JMP 0x005146c1
005146bf : XOR EBX,EBX
005146c1 : MOV dword ptr [ESP + 0x24],EBX
005146c5 : TEST EBX,EBX
005146c7 : JZ 0x005146e4
005146c9 : MOV EDX,dword ptr [ESP + 0x20]
005146cd : PUSH EDX
005146ce : MOV ECX,EBX
005146d0 : CALL 0x005a0410
005146d5 : TEST AL,AL
005146d7 : JNZ 0x005147b3
005146dd : MOV ECX,EBX
005146df : CALL 0x004ff7e0
005146e4 : MOV ECX,EDI
005146e6 : CALL 0x00524240
005146eb : MOV dword ptr [ESP + 0x1c],0x0
005146f3 : MOV EBX,dword ptr [ESP + 0x1c]
005146f7 : MOV EDX,dword ptr [ESP + 0x14]
005146fb : AND EDX,0xfffffffc
005146fe : PUSH 0xb86d78
00514703 : ADD EDX,0x8
00514706 : PUSH EDX
00514707 : PUSH 0xb87088
0051470c : LEA ECX,[ESP + 0x64]
00514710 : CALL 0x0051c4c0
00514715 : MOV EAX,dword ptr [ESP + 0x58]
00514719 : MOV ECX,dword ptr [ESP + 0x40]
0051471d : AND EAX,0xfffffffc
00514720 : ADD EAX,0x8
00514723 : PUSH EAX
00514724 : CALL 0x00524480
00514729 : MOV ESI,dword ptr [ESP + 0x58]
0051472d : MOV EDI,dword ptr [0x00b851cc]
00514733 : AND ESI,0xfffffffc
00514736 : PUSH -0x1
00514738 : LEA ECX,[ESI + 0x4]
0051473b : PUSH ECX
0051473c : CALL EDI
0051473e : SUB EAX,0x1
00514741 : JNZ 0x00514749
00514743 : PUSH ESI
00514744 : CALL 0x00515cf0
00514749 : MOV ESI,dword ptr [ESP + 0x2c]
0051474d : AND ESI,0xfffffffc
00514750 : PUSH -0x1
00514752 : LEA EDX,[ESI + 0x4]
00514755 : PUSH EDX
00514756 : CALL EDI
00514758 : SUB EAX,0x1
0051475b : JNZ 0x00514763
0051475d : PUSH ESI
0051475e : CALL 0x00515cf0
00514763 : MOV ECX,dword ptr [ESP + 0x44]
00514767 : TEST ECX,ECX
00514769 : JZ 0x00514777
0051476b : MOV EAX,dword ptr [ECX]
0051476d : MOV EDX,dword ptr [ESP + 0x48]
00514771 : MOV EAX,dword ptr [EAX + 0x8]
00514774 : PUSH EDX
00514775 : CALL EAX
00514777 : MOV ECX,dword ptr [ESP + 0x20]
0051477b : CALL 0x004ff7e0
00514780 : TEST EBX,EBX
00514782 : JZ 0x0051478b
00514784 : MOV ECX,EBX
00514786 : CALL 0x00524240
0051478b : MOV EAX,dword ptr [ESP + 0x3c]
0051478f : CMP EAX,0x1
00514792 : JNZ 0x00514882
00514798 : MOV ECX,dword ptr [ESP + 0x40]
0051479c : CALL 0x00524240
005147a1 : MOV ESI,dword ptr [ESP + 0x14]
005147a5 : AND ESI,0xfffffffc
005147a8 : PUSH -0x1
005147aa : LEA ECX,[ESI + 0x4]
005147ad : PUSH ECX
005147ae : JMP 0x0051461b
005147b3 : CMP byte ptr [ESP + 0x50],0x0
005147b8 : JZ 0x005147e4
005147ba : LEA EAX,[ESP + 0x18]
005147be : JMP 0x005147c2
005147c0 : XOR EAX,EAX
005147c2 : MOV ECX,dword ptr [ESP + 0x60]
005147c6 : MOV EDX,dword ptr [ESP + 0x5c]
005147ca : PUSH 0x0
005147cc : PUSH ECX
005147cd : PUSH EDX
005147ce : PUSH 0x1
005147d0 : PUSH EAX
005147d1 : MOV EAX,dword ptr [ESP + 0x6c]
005147d5 : PUSH EAX
005147d6 : PUSH EDI
005147d7 : PUSH ESI
005147d8 : CALL 0x00513090
005147dd : ADD ESP,0x20
005147e0 : MOV dword ptr [ESP + 0x28],EAX
005147e4 : MOV ECX,dword ptr [ESP + 0x40]
005147e8 : PUSH EDI
005147e9 : CALL 0x005243e0
005147ee : MOV EDI,dword ptr [ESP + 0x2c]
005147f2 : AND EDI,0xfffffffc
005147f5 : PUSH -0x1
005147f7 : LEA ECX,[EDI + 0x4]
005147fa : PUSH ECX
005147fb : MOV byte ptr [ESP + 0x1b],0x1
00514800 : CALL dword ptr [0x00b851cc]
00514806 : SUB EAX,0x1
00514809 : JNZ 0x00514811
0051480b : PUSH EDI
0051480c : CALL 0x00515cf0
00514811 : CMP byte ptr [ESP + 0x50],0x0
00514816 : JNZ 0x00514946
0051481c : CMP dword ptr [ESP + 0x28],0x0
00514821 : JNZ 0x00514a50
00514827 : MOV EBX,dword ptr [ESP + 0x58]
0051482b : MOV EAX,EBP
0051482d : DEC EAX
0051482e : NEG EAX
00514830 : SBB EAX,EAX
00514832 : NOT EAX
00514834 : LEA ECX,[ESP + 0x18]
00514838 : AND EAX,ECX
0051483a : MOV ECX,dword ptr [ESP + 0x60]
0051483e : LEA EDX,[ESP + 0x50]
00514842 : PUSH EDX
00514843 : MOV EDX,dword ptr [ESP + 0x60]
00514847 : PUSH ECX
00514848 : PUSH EDX
00514849 : PUSH 0x0
0051484b : PUSH EAX
0051484c : MOV EAX,dword ptr [ESP + 0x30]
00514850 : PUSH EBX
00514851 : PUSH EAX
00514852 : PUSH ESI
00514853 : MOV byte ptr [ESP + 0x70],0x0
00514858 : CALL 0x00513090
0051485d : ADD ESP,0x20
00514860 : MOV dword ptr [ESP + 0x28],EAX
00514864 : CMP EBP,0x2
00514867 : JNZ 0x0051494a
0051486d : CMP byte ptr [ESP + 0x50],0x0
00514872 : JZ 0x0051494a
00514878 : MOV byte ptr [ESP + 0x13],0x1
0051487d : JMP 0x0051494a
00514882 : CMP EAX,0x2
00514885 : JL 0x00514890
00514887 : MOV ECX,dword ptr [ESP + 0x40]
0051488b : CALL 0x004ff7e0
00514890 : MOV ESI,dword ptr [ESP + 0x14]
00514894 : AND ESI,0xfffffffc
00514897 : PUSH -0x1
00514899 : LEA ECX,[ESI + 0x4]
0051489c : PUSH ECX
0051489d : JMP 0x0051461b
005148a2 : LEA ECX,[ESP + 0x3c]
005148a6 : CALL 0x00523e20
005148ab : MOV dword ptr [ESP + 0x1c],EAX
005148af : CMP EAX,EBP
005148b1 : JNZ 0x00514932
005148b3 : MOV ESI,dword ptr [ESP + 0x34]
005148b7 : CMP ESI,EBP
005148b9 : JZ 0x005148e4
005148bb : CMP dword ptr [ESP + 0x3c],0x2
005148c0 : JL 0x005148cd
005148c2 : MOV ECX,dword ptr [ESP + 0x40]
005148c6 : CALL 0x00523770
005148cb : JMP 0x005148d2
005148cd : MOV EAX,0xcca874
005148d2 : PUSH EAX
005148d3 : PUSH 0xb86db0
005148d8 : ADD ESI,0xc
005148db : PUSH ESI
005148dc : CALL 0x00500460
005148e1 : ADD ESP,0xc
005148e4 : MOV ECX,dword ptr [ESP + 0x44]
005148e8 : CMP ECX,EBP
005148ea : JZ 0x005148f8
005148ec : MOV EDX,dword ptr [ECX]
005148ee : MOV EAX,dword ptr [ESP + 0x48]
005148f2 : MOV EDX,dword ptr [EDX + 0x8]
005148f5 : PUSH EAX
005148f6 : CALL EDX
005148f8 : MOV EAX,dword ptr [ESP + 0x3c]
005148fc : CMP EAX,0x1
005148ff : JNZ 0x0051490c
00514901 : MOV ECX,dword ptr [ESP + 0x40]
00514905 : CALL 0x00524240
0051490a : JMP 0x0051491a
0051490c : CMP EAX,0x2
0051490f : JL 0x0051491a
00514911 : MOV ECX,dword ptr [ESP + 0x40]
00514915 : CALL 0x004ff7e0
0051491a : MOV ESI,dword ptr [ESP + 0x14]
0051491e : AND ESI,0xfffffffc
00514921 : PUSH -0x1
00514923 : LEA EAX,[ESI + 0x4]
00514926 : PUSH EAX
00514927 : CALL dword ptr [0x00b851cc]
0051492d : JMP 0x0051461d
00514932 : MOV EAX,dword ptr [ESP + 0x1c]
00514936 : MOV EBP,dword ptr [EAX + 0x1c]
00514939 : PUSH EAX
0051493a : MOV ECX,ESI
0051493c : CALL 0x005a02e0
00514941 : JMP 0x00514827
00514946 : MOV EBX,dword ptr [ESP + 0x58]
0051494a : CMP dword ptr [ESP + 0x28],0x0
0051494f : JNZ 0x005149cf
00514951 : MOV ECX,dword ptr [ESP + 0x44]
00514955 : TEST ECX,ECX
00514957 : JZ 0x00514965
00514959 : MOV EDX,dword ptr [ECX]
0051495b : MOV EAX,dword ptr [ESP + 0x48]
0051495f : MOV EDX,dword ptr [EDX + 0x8]
00514962 : PUSH EAX
00514963 : CALL EDX
00514965 : MOV ECX,dword ptr [ESP + 0x20]
00514969 : TEST ECX,ECX
0051496b : JZ 0x00514972
0051496d : CALL 0x004ff7e0
00514972 : MOV ECX,dword ptr [ESP + 0x24]
00514976 : TEST ECX,ECX
00514978 : JZ 0x0051497f
0051497a : CALL 0x004ff7e0
0051497f : MOV ECX,dword ptr [ESP + 0x18]
00514983 : TEST ECX,ECX
00514985 : JZ 0x0051498c
00514987 : CALL 0x004ff7e0
0051498c : MOV ECX,dword ptr [ESP + 0x1c]
00514990 : CALL 0x00524240
00514995 : MOV EAX,dword ptr [ESP + 0x3c]
00514999 : CMP EAX,0x1
0051499c : JNZ 0x005149a9
0051499e : MOV ECX,dword ptr [ESP + 0x40]
005149a2 : CALL 0x00524240
005149a7 : JMP 0x005149b7
005149a9 : CMP EAX,0x2
005149ac : JL 0x005149b7
005149ae : MOV ECX,dword ptr [ESP + 0x40]
005149b2 : CALL 0x004ff7e0
005149b7 : MOV ESI,dword ptr [ESP + 0x14]
005149bb : AND ESI,0xfffffffc
005149be : PUSH -0x1
005149c0 : LEA EAX,[ESI + 0x4]
005149c3 : PUSH EAX
005149c4 : CALL dword ptr [0x00b851cc]
005149ca : JMP 0x0051461d
005149cf : CMP byte ptr [ESP + 0x13],0x0
005149d4 : JNZ 0x00514a54
005149d6 : MOV EBP,dword ptr [ESP + 0x20]
005149da : MOV ECX,dword ptr [ESP + 0x5c]
005149de : MOV EDX,dword ptr [ESP + 0x28]
005149e2 : PUSH ECX
005149e3 : PUSH EBX
005149e4 : PUSH ESI
005149e5 : MOV ESI,dword ptr [ESP + 0x24]
005149e9 : PUSH ESI
005149ea : PUSH EDX
005149eb : CALL 0x00512f50
005149f0 : MOV ECX,dword ptr [ESP + 0x58]
005149f4 : ADD ESP,0x14
005149f7 : MOV EDI,EAX
005149f9 : TEST ECX,ECX
005149fb : JZ 0x00514a09
005149fd : MOV EAX,dword ptr [ECX]
005149ff : MOV EDX,dword ptr [ESP + 0x48]
00514a03 : MOV EAX,dword ptr [EAX + 0x8]
00514a06 : PUSH EDX
00514a07 : CALL EAX
00514a09 : TEST EBP,EBP
00514a0b : JZ 0x00514a14
00514a0d : MOV ECX,EBP
00514a0f : CALL 0x004ff7e0
00514a14 : MOV ECX,dword ptr [ESP + 0x24]
00514a18 : TEST ECX,ECX
00514a1a : JZ 0x00514a21
00514a1c : CALL 0x004ff7e0
00514a21 : TEST ESI,ESI
00514a23 : JZ 0x00514a2c
00514a25 : MOV ECX,ESI
00514a27 : CALL 0x004ff7e0
00514a2c : MOV ECX,dword ptr [ESP + 0x1c]
00514a30 : CALL 0x00524240
00514a35 : MOV EAX,dword ptr [ESP + 0x3c]
00514a39 : CMP EAX,0x1
00514a3c : JNZ 0x00514c44
00514a42 : MOV ECX,dword ptr [ESP + 0x40]
00514a46 : CALL 0x00524240
00514a4b : JMP 0x00514c52
00514a50 : MOV EBX,dword ptr [ESP + 0x58]
00514a54 : CMP EBP,0x1
00514a57 : JNZ 0x00514adf
00514a5d : TEST BL,0x30
00514a60 : JZ 0x00514ac7
00514a62 : XOR EBP,EBP
00514a64 : MOV EDI,dword ptr [ESP + 0x24]
00514a68 : MOV EDX,dword ptr [ESP + 0x18]
00514a6c : MOV EAX,dword ptr [EDX + 0x30]
00514a6f : MOV dword ptr [EDI + 0x2c0],EAX
00514a75 : TEST BL,0x1
00514a78 : JNZ 0x00514a86
00514a7a : PUSH EDI
00514a7b : MOV ECX,ESI
00514a7d : CALL 0x005a03f0
00514a82 : TEST AL,AL
00514a84 : JNZ 0x00514a8f
00514a86 : MOV EDX,dword ptr [EDI]
00514a88 : MOV EAX,dword ptr [EDX + 0x4]
00514a8b : MOV ECX,EDI
00514a8d : CALL EAX
00514a8f : TEST EBP,EBP
00514a91 : JZ 0x00514aa4
00514a93 : MOV ECX,dword ptr [ESP + 0x18]
00514a97 : CALL 0x004ff7e0
00514a9c : MOV dword ptr [ESP + 0x18],0x0
00514aa4 : MOV ECX,EDI
00514aa6 : CALL 0x004ff7e0
00514aab : MOV ECX,dword ptr [ESP + 0x20]
00514aaf : MOV dword ptr [ESP + 0x24],0x0
00514ab7 : TEST ECX,ECX
00514ab9 : JZ 0x00514ac0
00514abb : CALL 0x004ff7e0
00514ac0 : XOR EBP,EBP
00514ac2 : JMP 0x005149da
00514ac7 : MOV EBP,dword ptr [ESP + 0x18]
00514acb : TEST EBP,EBP
00514acd : JZ 0x00514a64
00514acf : MOV EDI,dword ptr [ESP + 0x24]
00514ad3 : MOV ECX,EBP
00514ad5 : PUSH ECX
00514ad6 : MOV ECX,EDI
00514ad8 : CALL 0x00512c30
00514add : JMP 0x00514a68
00514adf : MOV EBP,dword ptr [ESP + 0x20]
00514ae3 : TEST EBP,EBP
00514ae5 : JNZ 0x00514bae
00514aeb : LEA ECX,[ESP + 0x50]
00514aef : CALL 0x0051b6e0
00514af4 : MOV EAX,dword ptr [ESP + 0x14]
00514af8 : LEA ECX,[ESP + 0x50]
00514afc : PUSH ECX
00514afd : LEA EDX,[ESP + 0x34]
00514b01 : PUSH EDX
00514b02 : LEA ECX,[ESP + 0x40]
00514b06 : AND EAX,0xfffffffc
00514b09 : PUSH ECX
00514b0a : ADD EAX,0x8
00514b0d : MOV ECX,ESI
00514b0f : CALL 0x00512de0
00514b14 : ADD ESP,0xc
00514b17 : MOV dword ptr [ESP + 0x20],EAX
00514b1b : TEST EAX,EAX
00514b1d : JNZ 0x00514b9d
00514b1f : MOV EAX,dword ptr [ESP + 0x34]
00514b23 : TEST EAX,EAX
00514b25 : JZ 0x00514b43
00514b27 : MOV EDX,dword ptr [ESP + 0x50]
00514b2b : AND EDX,0xfffffffc
00514b2e : ADD EDX,0x8
00514b31 : PUSH EDX
00514b32 : ADD EAX,0xc
00514b35 : PUSH 0xcd4480
00514b3a : PUSH EAX
00514b3b : CALL 0x00500460
00514b40 : ADD ESP,0xc
00514b43 : MOV ECX,dword ptr [ESP + 0x28]
00514b47 : CALL 0x00524240
00514b4c : LEA ECX,[ESP + 0x50]
00514b50 : CALL 0x0045b730
00514b55 : LEA ECX,[ESP + 0x44]
00514b59 : CALL 0x004ffc10
00514b5e : MOV ECX,dword ptr [ESP + 0x24]
00514b62 : TEST ECX,ECX
00514b64 : JZ 0x00514b6b
00514b66 : CALL 0x004ff7e0
00514b6b : MOV ECX,dword ptr [ESP + 0x18]
00514b6f : TEST ECX,ECX
00514b71 : JZ 0x00514b78
00514b73 : CALL 0x004ff7e0
00514b78 : MOV ECX,dword ptr [ESP + 0x1c]
00514b7c : CALL 0x00524240
00514b81 : LEA ECX,[ESP + 0x3c]
00514b85 : CALL 0x00512710
00514b8a : LEA ECX,[ESP + 0x14]
00514b8e : CALL 0x0045b730
00514b93 : POP EDI
00514b94 : POP ESI
00514b95 : POP EBP
00514b96 : XOR EAX,EAX
00514b98 : POP EBX
00514b99 : ADD ESP,0x3c
00514b9c : RET
00514b9d : LEA ECX,[ESP + 0x50]
00514ba1 : CALL 0x0045b730
00514ba6 : MOV EBX,dword ptr [ESP + 0x58]
00514baa : MOV EBP,dword ptr [ESP + 0x20]
00514bae : MOV ECX,dword ptr [0x00d73250]
00514bb4 : PUSH 0x0
00514bb6 : PUSH 0x28
00514bb8 : CALL 0x00515840
00514bbd : TEST EAX,EAX
00514bbf : JZ 0x00514bdd
00514bc1 : MOV ECX,dword ptr [ESP + 0x38]
00514bc5 : MOV EDX,dword ptr [ESP + 0x28]
00514bc9 : PUSH ESI
00514bca : PUSH ECX
00514bcb : MOV ECX,dword ptr [ESP + 0x24]
00514bcf : PUSH EBP
00514bd0 : PUSH EDX
00514bd1 : PUSH ECX
00514bd2 : MOV ECX,EAX
00514bd4 : CALL 0x00514210
00514bd9 : MOV EDI,EAX
00514bdb : JMP 0x00514bdf
00514bdd : XOR EDI,EDI
00514bdf : TEST BL,0x11
00514be2 : JNZ 0x00514bf0
00514be4 : PUSH EDI
00514be5 : MOV ECX,ESI
00514be7 : CALL 0x005a03f0
00514bec : TEST AL,AL
00514bee : JNZ 0x00514c30
00514bf0 : MOV EDX,dword ptr [EDI]
00514bf2 : MOV EAX,dword ptr [EDX + 0x4]
00514bf5 : MOV ECX,EDI
00514bf7 : CALL EAX
00514bf9 : CMP dword ptr [EDI + 0x24],0x0
00514bfd : JNZ 0x00514c30
00514bff : MOV ECX,dword ptr [ESP + 0x28]
00514c03 : TEST ECX,ECX
00514c05 : JZ 0x00514c0c
00514c07 : CALL 0x00524240
00514c0c : MOV ECX,EDI
00514c0e : CALL 0x004ff7e0
00514c13 : LEA ECX,[ESP + 0x44]
00514c17 : CALL 0x004ffc10
00514c1c : TEST EBP,EBP
00514c1e : JZ 0x00514b5e
00514c24 : MOV ECX,EBP
00514c26 : CALL 0x004ff7e0
00514c2b : JMP 0x00514b5e
00514c30 : TEST EDI,EDI
00514c32 : JZ 0x005149da
00514c38 : MOV ECX,EDI
00514c3a : CALL 0x004ff7e0
00514c3f : JMP 0x005149da
00514c44 : CMP EAX,0x2
00514c47 : JL 0x00514c52
00514c49 : MOV ECX,dword ptr [ESP + 0x40]
00514c4d : CALL 0x004ff7e0
00514c52 : MOV ESI,dword ptr [ESP + 0x14]
00514c56 : AND ESI,0xfffffffc
00514c59 : PUSH -0x1
00514c5b : LEA ECX,[ESI + 0x4]
00514c5e : PUSH ECX
00514c5f : CALL dword ptr [0x00b851cc]
00514c65 : SUB EAX,0x1
00514c68 : JNZ 0x00514c70
00514c6a : PUSH ESI
00514c6b : CALL 0x00515cf0
00514c70 : MOV EAX,EDI
00514c72 : POP EDI
00514c73 : POP ESI
00514c74 : POP EBP
00514c75 : POP EBX
00514c76 : ADD ESP,0x3c
00514c79 : RET

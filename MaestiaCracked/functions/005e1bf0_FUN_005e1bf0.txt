PROGRAM  : Maestia.exe
FUNCTION : FUN_005e1bf0
ENTRY    : 005e1bf0
BODY     : [[005e1bf0, 005e1c4a]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_005e1bf0(ushort *param_1,uint param_2)

{
  int iVar1;
  uint uVar2;
  int *in_ECX;
  uint *puVar3;
  
  iVar1 = *in_ECX;
  puVar3 = (uint *)(iVar1 + 8 + param_2 * 8);
  if ((*(int *)(iVar1 + 8 + param_2 * 8) != -2) &&
     (uVar2 = param_2, ((uint)(ushort)puVar3[1] & *(uint *)(iVar1 + 4)) == param_2)) {
    while ((((uint)(ushort)puVar3[1] & *(uint *)(iVar1 + 4)) != param_2 ||
           ((ushort)puVar3[1] != *param_1))) {
      uVar2 = *puVar3;
      if (uVar2 == 0xffffffff) {
        return 0xffffffff;
      }
      puVar3 = (uint *)(iVar1 + 8 + uVar2 * 8);
    }
    return uVar2;
  }
  return 0xffffffff;
}



============================================================
DISASSEMBLY
============================================================
005e1bf0 : PUSH EBX
005e1bf1 : PUSH ESI
005e1bf2 : MOV ESI,dword ptr [ESP + 0x10]
005e1bf6 : PUSH EDI
005e1bf7 : MOV EDI,dword ptr [ECX]
005e1bf9 : CMP dword ptr [EDI + ESI*0x8 + 0x8],-0x2
005e1bfe : LEA ECX,[EDI + ESI*0x8 + 0x8]
005e1c02 : MOV EAX,ESI
005e1c04 : JZ 0x005e1c42
005e1c06 : MOVZX EDX,word ptr [ECX + 0x4]
005e1c0a : MOV EBX,dword ptr [EDI + 0x4]
005e1c0d : AND EDX,EBX
005e1c0f : CMP EDX,ESI
005e1c11 : JNZ 0x005e1c42
005e1c13 : PUSH EBP
005e1c14 : MOVZX EDX,word ptr [ECX + 0x4]
005e1c18 : MOVZX EBP,DX
005e1c1b : AND EBP,EBX
005e1c1d : CMP EBP,ESI
005e1c1f : JNZ 0x005e1c2b
005e1c21 : MOV EBP,dword ptr [ESP + 0x14]
005e1c25 : CMP DX,word ptr [EBP]
005e1c29 : JZ 0x005e1c3b
005e1c2b : MOV EAX,dword ptr [ECX]
005e1c2d : CMP EAX,-0x1
005e1c30 : JZ 0x005e1c38
005e1c32 : LEA ECX,[EDI + EAX*0x8 + 0x8]
005e1c36 : JMP 0x005e1c14
005e1c38 : OR EAX,0xffffffff
005e1c3b : POP EBP
005e1c3c : POP EDI
005e1c3d : POP ESI
005e1c3e : POP EBX
005e1c3f : RET 0x8
005e1c42 : POP EDI
005e1c43 : POP ESI
005e1c44 : OR EAX,0xffffffff
005e1c47 : POP EBX
005e1c48 : RET 0x8

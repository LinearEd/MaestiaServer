PROGRAM  : Maestia.exe
FUNCTION : FUN_00430aa0
ENTRY    : 00430aa0
BODY     : [[00430aa0, 00430be8] [00430bec, 00430bfa]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00430aa0(void)

{
  void *pvVar1;
  rsize_t _DstSize;
  uint uVar2;
  undefined4 *_Dst;
  int iVar3;
  int iVar4;
  uint uVar5;
  int unaff_ESI;
  undefined4 *puVar6;
  undefined4 *puVar7;
  uint local_8;
  
  uVar2 = *(uint *)(unaff_ESI + 0x14);
  local_8 = 1;
  if (uVar2 == 0x5555555) {
    uVar2 = FUN_00442c50();
  }
  uVar5 = uVar2 >> 1;
  if (uVar5 < 8) {
    uVar5 = 8;
  }
  else if (uVar5 < 2) goto LAB_00430ae8;
  if (uVar2 <= 0x5555555 - uVar5) {
    local_8 = uVar5;
  }
LAB_00430ae8:
  uVar2 = *(uint *)(unaff_ESI + 0x18);
  _Dst = (undefined4 *)FUN_004c1790();
  iVar4 = uVar2 * 4;
  pvVar1 = (void *)(*(int *)(unaff_ESI + 0x10) + iVar4);
  iVar3 = (*(int *)(unaff_ESI + 0x14) * 4 - (int)pvVar1) + *(int *)(unaff_ESI + 0x10) >> 2;
  puVar7 = _Dst + uVar2 + iVar3;
  if (iVar3 != 0) {
    _memmove_s(_Dst + uVar2,iVar3 * 4,pvVar1,iVar3 * 4);
  }
  if (local_8 < uVar2) {
    iVar3 = (int)(local_8 * 4) >> 2;
    if (iVar3 != 0) {
      _DstSize = iVar3 * 4;
      _memmove_s(puVar7,_DstSize,*(void **)(unaff_ESI + 0x10),_DstSize);
    }
    pvVar1 = (void *)(*(int *)(unaff_ESI + 0x10) + local_8 * 4);
    iVar4 = (*(int *)(unaff_ESI + 0x10) - (int)pvVar1) + iVar4 >> 2;
    puVar7 = _Dst + iVar4;
    uVar2 = local_8;
    if (iVar4 != 0) {
      _memmove_s(_Dst,iVar4 * 4,pvVar1,iVar4 * 4);
    }
  }
  else {
    iVar4 = iVar4 >> 2;
    puVar6 = puVar7 + iVar4;
    if (iVar4 != 0) {
      _memmove_s(puVar7,iVar4 * 4,*(void **)(unaff_ESI + 0x10),iVar4 * 4);
    }
    iVar4 = local_8 - uVar2;
    puVar7 = _Dst;
    if (iVar4 != 0) {
      for (; iVar4 != 0; iVar4 = iVar4 + -1) {
        *puVar6 = 0;
        puVar6 = puVar6 + 1;
      }
    }
  }
  if (uVar2 != 0) {
    for (; uVar2 != 0; uVar2 = uVar2 - 1) {
      *puVar7 = 0;
      puVar7 = puVar7 + 1;
    }
  }
  if (*(int *)(unaff_ESI + 0x10) == 0) {
    *(int *)(unaff_ESI + 0x14) = *(int *)(unaff_ESI + 0x14) + local_8;
    *(undefined4 **)(unaff_ESI + 0x10) = _Dst;
    return;
  }
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
00430aa0 : PUSH EBP
00430aa1 : MOV EBP,ESP
00430aa3 : SUB ESP,0x10
00430aa6 : MOV EAX,dword ptr [ESI + 0x14]
00430aa9 : MOV ECX,0x5555555
00430aae : MOV EDX,0x1
00430ab3 : SUB ECX,EAX
00430ab5 : PUSH EBX
00430ab6 : PUSH EDI
00430ab7 : MOV dword ptr [EBP + -0x4],EDX
00430aba : CMP ECX,EDX
00430abc : JNC 0x00430ac3
00430abe : CALL 0x00442c50
00430ac3 : MOV ECX,EAX
00430ac5 : SHR ECX,0x1
00430ac7 : CMP ECX,0x8
00430aca : JNC 0x00430ad3
00430acc : MOV ECX,0x8
00430ad1 : JMP 0x00430ad8
00430ad3 : CMP ECX,0x1
00430ad6 : JBE 0x00430ae8
00430ad8 : MOV EDI,0x5555555
00430add : SUB EDI,ECX
00430adf : CMP EAX,EDI
00430ae1 : JA 0x00430ae8
00430ae3 : MOV EDX,ECX
00430ae5 : MOV dword ptr [EBP + -0x4],ECX
00430ae8 : MOV EDI,dword ptr [ESI + 0x18]
00430aeb : LEA ECX,[EAX + EDX*0x1]
00430aee : MOV dword ptr [EBP + -0xc],EDI
00430af1 : CALL 0x004c1790
00430af6 : MOV ECX,dword ptr [ESI + 0x10]
00430af9 : MOV dword ptr [EBP + -0x8],EAX
00430afc : ADD EDI,EDI
00430afe : ADD EDI,EDI
00430b00 : LEA EDX,[EDI + EAX*0x1]
00430b03 : MOV EAX,dword ptr [ESI + 0x14]
00430b06 : ADD EAX,EAX
00430b08 : LEA EBX,[ECX + EDI*0x1]
00430b0b : ADD EAX,EAX
00430b0d : SUB EAX,EBX
00430b0f : ADD EAX,ECX
00430b11 : SAR EAX,0x2
00430b14 : LEA ECX,[EAX*0x4 + 0x0]
00430b1b : MOV dword ptr [EBP + -0x10],EBX
00430b1e : LEA EBX,[ECX + EDX*0x1]
00430b21 : TEST EAX,EAX
00430b23 : JBE 0x00430b34
00430b25 : MOV EAX,dword ptr [EBP + -0x10]
00430b28 : PUSH ECX
00430b29 : PUSH EAX
00430b2a : PUSH ECX
00430b2b : PUSH EDX
00430b2c : CALL 0x00634101
00430b31 : ADD ESP,0x10
00430b34 : MOV EDX,dword ptr [EBP + -0x4]
00430b37 : MOV ECX,dword ptr [ESI + 0x10]
00430b3a : CMP dword ptr [EBP + -0xc],EDX
00430b3d : JA 0x00430b83
00430b3f : MOV EAX,ECX
00430b41 : SUB EAX,ECX
00430b43 : ADD EAX,EDI
00430b45 : SAR EAX,0x2
00430b48 : LEA EDI,[EAX*0x4 + 0x0]
00430b4f : LEA EDX,[EDI + EBX*0x1]
00430b52 : MOV dword ptr [EBP + -0x10],EDX
00430b55 : TEST EAX,EAX
00430b57 : JBE 0x00430b65
00430b59 : PUSH EDI
00430b5a : PUSH ECX
00430b5b : PUSH EDI
00430b5c : PUSH EBX
00430b5d : CALL 0x00634101
00430b62 : ADD ESP,0x10
00430b65 : MOV EDX,dword ptr [EBP + -0x4]
00430b68 : MOV EBX,dword ptr [EBP + -0xc]
00430b6b : MOV ECX,EDX
00430b6d : SUB ECX,EBX
00430b6f : JZ 0x00430b78
00430b71 : MOV EDI,dword ptr [EBP + -0x10]
00430b74 : XOR EAX,EAX
00430b76 : STOSD.REP ES:EDI
00430b78 : TEST EBX,EBX
00430b7a : JBE 0x00430bdd
00430b7c : MOV EDI,dword ptr [EBP + -0x8]
00430b7f : MOV ECX,EBX
00430b81 : JMP 0x00430bd9
00430b83 : LEA EAX,[EDX*0x4 + 0x0]
00430b8a : SAR EAX,0x2
00430b8d : TEST EAX,EAX
00430b8f : JBE 0x00430ba4
00430b91 : ADD EAX,EAX
00430b93 : ADD EAX,EAX
00430b95 : PUSH EAX
00430b96 : PUSH ECX
00430b97 : PUSH EAX
00430b98 : PUSH EBX
00430b99 : CALL 0x00634101
00430b9e : MOV EDX,dword ptr [EBP + -0x4]
00430ba1 : ADD ESP,0x10
00430ba4 : MOV EAX,dword ptr [ESI + 0x10]
00430ba7 : LEA EBX,[EAX + EDX*0x4]
00430baa : SUB EAX,EBX
00430bac : ADD EAX,EDI
00430bae : MOV EDI,dword ptr [EBP + -0x8]
00430bb1 : SAR EAX,0x2
00430bb4 : LEA ECX,[EAX*0x4 + 0x0]
00430bbb : ADD EDI,ECX
00430bbd : TEST EAX,EAX
00430bbf : JBE 0x00430bd3
00430bc1 : MOV EAX,dword ptr [EBP + -0x8]
00430bc4 : PUSH ECX
00430bc5 : PUSH EBX
00430bc6 : PUSH ECX
00430bc7 : PUSH EAX
00430bc8 : CALL 0x00634101
00430bcd : MOV EDX,dword ptr [EBP + -0x4]
00430bd0 : ADD ESP,0x10
00430bd3 : TEST EDX,EDX
00430bd5 : JBE 0x00430bdd
00430bd7 : MOV ECX,EDX
00430bd9 : XOR EAX,EAX
00430bdb : STOSD.REP ES:EDI
00430bdd : MOV ECX,dword ptr [ESI + 0x10]
00430be0 : TEST ECX,ECX
00430be2 : JZ 0x00430bec
00430be4 : CALL 0x006f04e0
00430bec : MOV ECX,dword ptr [EBP + -0x8]
00430bef : ADD dword ptr [ESI + 0x14],EDX
00430bf2 : POP EDI
00430bf3 : MOV dword ptr [ESI + 0x10],ECX
00430bf6 : POP EBX
00430bf7 : MOV ESP,EBP
00430bf9 : POP EBP
00430bfa : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_006a74e0
ENTRY    : 006a74e0
BODY     : [[006a74e0, 006a76eb]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006a74e0(int param_1,int param_2,uint param_3,uint param_4)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  int iVar8;
  int iVar9;
  undefined4 *puVar10;
  int local_10;
  int local_c;
  int local_8;
  int local_4;
  
  iVar3 = param_1;
  iVar9 = *(int *)(param_1 + 4);
  puVar1 = (undefined4 *)(param_1 + 0x6c);
  if (param_3 != 0) {
    param_3 = param_3 - 1;
  }
  if ((iVar9 != 0) && (param_3 < *(uint *)(iVar9 + 0x198))) {
    if (((param_4 & 9) == 0) && (iVar4 = FUN_006a62f0(param_2), iVar4 == 0)) {
      return 0;
    }
    if ((param_4 & 0x4000) == 0) {
      iVar8 = param_3 * 0x10 + *(int *)(iVar9 + 0x1a0);
      *(undefined4 *)(param_1 + 0x48) = 0x6f75746c;
      *(undefined2 *)(param_1 + 0x6e) = 0;
      *(undefined2 *)puVar1 = 0;
      iVar4 = FUN_006a71a0(*(undefined4 *)(iVar9 + 0x68),*(undefined4 *)(iVar9 + 0xbc),
                           *(undefined4 *)(iVar8 + 0xc),*(undefined4 *)(iVar8 + 8));
      if (iVar4 == 0) {
        param_1._0_1_ = ~(byte)param_4 & 1;
        iVar4 = *(int *)(iVar3 + 0xbc);
        *puVar1 = *(undefined4 *)(iVar4 + 0x14);
        *(undefined4 *)(iVar3 + 0x70) = *(undefined4 *)(iVar4 + 0x18);
        *(undefined4 *)(iVar3 + 0x74) = *(undefined4 *)(iVar4 + 0x1c);
        *(undefined4 *)(iVar3 + 0x78) = *(undefined4 *)(iVar4 + 0x20);
        uVar5 = *(uint *)(iVar4 + 0x24);
        *(uint *)(iVar3 + 0x7c) = uVar5;
        uVar5 = uVar5 & 0xfffffffe;
        *(uint *)(iVar3 + 0x7c) = uVar5 | 4;
        if ((param_2 != 0) && (*(ushort *)(param_2 + 0xe) < 0x18)) {
          *(uint *)(iVar3 + 0x7c) = uVar5 | 0x104;
        }
        *(undefined4 *)(iVar3 + 0x28) = 0;
        *(undefined4 *)(iVar3 + 0x34) = 0;
        uVar6 = *(undefined4 *)(iVar8 + 4);
        if (*(int *)(iVar9 + 0x130) != *(int *)(iVar9 + 300)) {
          uVar6 = FUN_00685d60(uVar6,*(int *)(iVar9 + 300),*(int *)(iVar9 + 0x130));
        }
        if ((*(byte *)(iVar9 + 0x144) & 1) == 0) {
          *(undefined4 *)(iVar3 + 0x28) = uVar6;
        }
        else {
          *(undefined4 *)(iVar3 + 0x34) = uVar6;
        }
        *(undefined4 *)(iVar3 + 0x38) = *(undefined4 *)(iVar3 + 0x28);
        *(undefined4 *)(iVar3 + 0x3c) = *(undefined4 *)(iVar3 + 0x34);
        *(undefined4 *)(iVar3 + 0x2c) = 0;
        *(undefined4 *)(iVar3 + 0x30) = 0;
        if ((byte)param_1 != 0) {
          uVar6 = *(undefined4 *)(param_2 + 0x10);
          uVar2 = *(undefined4 *)(param_2 + 0x14);
          puVar10 = *(undefined4 **)(iVar3 + 0x70);
          iVar9 = 0;
          if (0 < *(short *)(iVar3 + 0x6e)) {
            do {
              uVar7 = FUN_00685ea0(*puVar10,uVar6);
              *puVar10 = uVar7;
              uVar7 = FUN_00685ea0(puVar10[1],uVar2);
              puVar10[1] = uVar7;
              iVar9 = iVar9 + 1;
              puVar10 = puVar10 + 2;
            } while (iVar9 < *(short *)(iVar3 + 0x6e));
          }
          uVar6 = FUN_00685ea0(*(undefined4 *)(iVar3 + 0x28),uVar6);
          *(undefined4 *)(iVar3 + 0x28) = uVar6;
          uVar6 = FUN_00685ea0(*(undefined4 *)(iVar3 + 0x34),uVar2);
          *(undefined4 *)(iVar3 + 0x34) = uVar6;
        }
        FUN_00687370(puVar1,&local_10);
        *(int *)(iVar3 + 0x18) = local_8 - local_10;
        *(int *)(iVar3 + 0x1c) = local_4 - local_c;
        *(int *)(iVar3 + 0x20) = local_10;
        *(int *)(iVar3 + 0x24) = local_4 - (local_4 - local_c);
        return 0;
      }
    }
    else {
      iVar4 = 6;
    }
    return iVar4;
  }
  return 6;
}



============================================================
DISASSEMBLY
============================================================
006a74e0 : SUB ESP,0x14
006a74e3 : PUSH EBX
006a74e4 : MOV EBX,dword ptr [ESP + 0x24]
006a74e8 : PUSH EBP
006a74e9 : MOV EBP,dword ptr [ESP + 0x20]
006a74ed : MOV EAX,dword ptr [EBP + 0x4]
006a74f0 : PUSH EDI
006a74f1 : MOV dword ptr [ESP + 0xc],EAX
006a74f5 : LEA EDI,[EBP + 0x6c]
006a74f8 : TEST EBX,EBX
006a74fa : JBE 0x006a74fd
006a74fc : DEC EBX
006a74fd : TEST EAX,EAX
006a74ff : JZ 0x006a76e0
006a7505 : CMP EBX,dword ptr [EAX + 0x198]
006a750b : JNC 0x006a76e0
006a7511 : TEST byte ptr [ESP + 0x30],0x9
006a7516 : PUSH ESI
006a7517 : JNZ 0x006a7532
006a7519 : MOV EAX,dword ptr [ESP + 0x2c]
006a751d : PUSH EAX
006a751e : MOV EAX,EBX
006a7520 : MOV ESI,EBP
006a7522 : CALL 0x006a62f0
006a7527 : ADD ESP,0x4
006a752a : TEST EAX,EAX
006a752c : JZ 0x006a7541
006a752e : MOV EAX,dword ptr [ESP + 0x10]
006a7532 : TEST dword ptr [ESP + 0x34],0x4000
006a753a : JZ 0x006a7549
006a753c : MOV EAX,0x6
006a7541 : POP ESI
006a7542 : POP EDI
006a7543 : POP EBP
006a7544 : POP EBX
006a7545 : ADD ESP,0x14
006a7548 : RET
006a7549 : XOR EDX,EDX
006a754b : SHL EBX,0x4
006a754e : ADD EBX,dword ptr [EAX + 0x1a0]
006a7554 : MOV dword ptr [EBP + 0x48],0x6f75746c
006a755b : XOR ECX,ECX
006a755d : MOV word ptr [EDI + 0x2],CX
006a7561 : MOV word ptr [EDI],DX
006a7564 : MOV EDX,dword ptr [EBX + 0x8]
006a7567 : MOV ECX,dword ptr [EAX + 0xbc]
006a756d : MOV EAX,dword ptr [EAX + 0x68]
006a7570 : PUSH EDX
006a7571 : MOV EDX,dword ptr [EBX + 0xc]
006a7574 : PUSH EDX
006a7575 : PUSH ECX
006a7576 : PUSH EAX
006a7577 : LEA ESI,[EBP + 0xa0]
006a757d : CALL 0x006a71a0
006a7582 : XOR ECX,ECX
006a7584 : ADD ESP,0x10
006a7587 : MOV dword ptr [ESP + 0x30],EAX
006a758b : CMP EAX,ECX
006a758d : JNZ 0x006a7541
006a758f : MOV AL,byte ptr [ESP + 0x34]
006a7593 : MOV ESI,dword ptr [ESP + 0x2c]
006a7597 : NOT AL
006a7599 : AND AL,0x1
006a759b : MOV byte ptr [ESP + 0x28],AL
006a759f : MOV EAX,dword ptr [EBP + 0xbc]
006a75a5 : MOV EDX,dword ptr [EAX + 0x14]
006a75a8 : ADD EAX,0x14
006a75ab : MOV dword ptr [EDI],EDX
006a75ad : MOV EDX,dword ptr [EAX + 0x4]
006a75b0 : MOV dword ptr [EDI + 0x4],EDX
006a75b3 : MOV EDX,dword ptr [EAX + 0x8]
006a75b6 : MOV dword ptr [EDI + 0x8],EDX
006a75b9 : MOV EDX,dword ptr [EAX + 0xc]
006a75bc : MOV dword ptr [EDI + 0xc],EDX
006a75bf : MOV EAX,dword ptr [EAX + 0x10]
006a75c2 : MOV dword ptr [EDI + 0x10],EAX
006a75c5 : AND EAX,0xfffffffe
006a75c8 : OR EAX,0x4
006a75cb : MOV dword ptr [EDI + 0x10],EAX
006a75ce : CMP ESI,ECX
006a75d0 : JZ 0x006a75e1
006a75d2 : CMP word ptr [ESI + 0xe],0x18
006a75d7 : JNC 0x006a75e1
006a75d9 : OR EAX,0x100
006a75de : MOV dword ptr [EDI + 0x10],EAX
006a75e1 : MOV dword ptr [EBP + 0x28],ECX
006a75e4 : MOV dword ptr [EBP + 0x34],ECX
006a75e7 : MOV EAX,dword ptr [EBX + 0x4]
006a75ea : MOV EBX,dword ptr [ESP + 0x10]
006a75ee : MOV ECX,dword ptr [EBX + 0x130]
006a75f4 : MOV EDX,dword ptr [EBX + 0x12c]
006a75fa : CMP ECX,EDX
006a75fc : JZ 0x006a7609
006a75fe : PUSH ECX
006a75ff : PUSH EDX
006a7600 : PUSH EAX
006a7601 : CALL 0x00685d60
006a7606 : ADD ESP,0xc
006a7609 : TEST byte ptr [EBX + 0x144],0x1
006a7610 : JZ 0x006a7617
006a7612 : MOV dword ptr [EBP + 0x34],EAX
006a7615 : JMP 0x006a761a
006a7617 : MOV dword ptr [EBP + 0x28],EAX
006a761a : MOV ECX,dword ptr [EBP + 0x28]
006a761d : MOV dword ptr [EBP + 0x38],ECX
006a7620 : MOV EDX,dword ptr [EBP + 0x34]
006a7623 : XOR EAX,EAX
006a7625 : MOV dword ptr [EBP + 0x3c],EDX
006a7628 : MOV dword ptr [EBP + 0x2c],EAX
006a762b : MOV dword ptr [EBP + 0x30],EAX
006a762e : CMP byte ptr [ESP + 0x28],AL
006a7632 : JZ 0x006a76a4
006a7634 : MOV EAX,dword ptr [ESI + 0x10]
006a7637 : MOV ECX,dword ptr [ESI + 0x14]
006a763a : MOV ESI,dword ptr [EDI + 0x4]
006a763d : XOR EDX,EDX
006a763f : XOR EBX,EBX
006a7641 : CMP DX,word ptr [EDI + 0x2]
006a7645 : MOV dword ptr [ESP + 0x2c],EAX
006a7649 : MOV dword ptr [ESP + 0x28],ECX
006a764d : JGE 0x006a767f
006a764f : NOP
006a7650 : MOV EAX,dword ptr [ESP + 0x2c]
006a7654 : MOV ECX,dword ptr [ESI]
006a7656 : PUSH EAX
006a7657 : PUSH ECX
006a7658 : CALL 0x00685ea0
006a765d : MOV EDX,dword ptr [ESP + 0x30]
006a7661 : MOV dword ptr [ESI],EAX
006a7663 : MOV EAX,dword ptr [ESI + 0x4]
006a7666 : PUSH EDX
006a7667 : PUSH EAX
006a7668 : CALL 0x00685ea0
006a766d : MOV dword ptr [ESI + 0x4],EAX
006a7670 : MOVSX ECX,word ptr [EDI + 0x2]
006a7674 : INC EBX
006a7675 : ADD ESP,0x10
006a7678 : ADD ESI,0x8
006a767b : CMP EBX,ECX
006a767d : JL 0x006a7650
006a767f : MOV EDX,dword ptr [ESP + 0x2c]
006a7683 : MOV EAX,dword ptr [EBP + 0x28]
006a7686 : PUSH EDX
006a7687 : PUSH EAX
006a7688 : CALL 0x00685ea0
006a768d : MOV ECX,dword ptr [ESP + 0x30]
006a7691 : MOV EDX,dword ptr [EBP + 0x34]
006a7694 : PUSH ECX
006a7695 : PUSH EDX
006a7696 : MOV dword ptr [EBP + 0x28],EAX
006a7699 : CALL 0x00685ea0
006a769e : ADD ESP,0x10
006a76a1 : MOV dword ptr [EBP + 0x34],EAX
006a76a4 : LEA EAX,[ESP + 0x14]
006a76a8 : PUSH EAX
006a76a9 : PUSH EDI
006a76aa : CALL 0x00687370
006a76af : MOV EDX,dword ptr [ESP + 0x1c]
006a76b3 : MOV ECX,dword ptr [ESP + 0x24]
006a76b7 : SUB ECX,EDX
006a76b9 : MOV dword ptr [EBP + 0x18],ECX
006a76bc : MOV ECX,dword ptr [ESP + 0x28]
006a76c0 : ADD ESP,0x8
006a76c3 : MOV EAX,ECX
006a76c5 : SUB EAX,dword ptr [ESP + 0x18]
006a76c9 : POP ESI
006a76ca : SUB ECX,EAX
006a76cc : POP EDI
006a76cd : MOV dword ptr [EBP + 0x1c],EAX
006a76d0 : MOV EAX,dword ptr [ESP + 0x28]
006a76d4 : MOV dword ptr [EBP + 0x20],EDX
006a76d7 : MOV dword ptr [EBP + 0x24],ECX
006a76da : POP EBP
006a76db : POP EBX
006a76dc : ADD ESP,0x14
006a76df : RET
006a76e0 : POP EDI
006a76e1 : POP EBP
006a76e2 : MOV EAX,0x6
006a76e7 : POP EBX
006a76e8 : ADD ESP,0x14
006a76eb : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_005e24e0
ENTRY    : 005e24e0
BODY     : [[005e24e0, 005e269c]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005e24e0(void)

{
  ushort *puVar1;
  int iVar2;
  uint uVar3;
  int *unaff_ESI;
  uint uVar4;
  undefined1 auStack_22c [3];
  char local_229;
  uint local_228;
  int local_224;
  undefined4 local_21c;
  undefined1 *local_218;
  undefined4 local_214;
  undefined4 local_210;
  undefined1 *local_20c;
  undefined4 local_208;
  undefined1 local_204 [512];
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)auStack_22c;
  FUN_0051b6e0();
  uVar4 = 0;
  uVar3 = 0;
  local_224 = 0;
  local_229 = '\x01';
  local_228 = 0;
  if (unaff_ESI[1] != 0) {
    uVar4 = 0;
    do {
      if (uVar4 == 0) {
        uVar3 = (uint)*(ushort *)*unaff_ESI;
        local_229 = '\0';
        local_228 = uVar3;
      }
      else {
        puVar1 = (ushort *)(*unaff_ESI + uVar4 * 4);
        if (puVar1[-1] + 1 < (uint)*puVar1) {
          if ((ushort)uVar3 == puVar1[-1]) {
            local_20c = local_204;
            local_210 = 2;
            local_208 = 0x200;
            FUN_005e1f30(&local_210,"0x{0:x}",&local_228);
          }
          else {
            local_218 = local_204;
            local_21c = 2;
            local_214 = 0x200;
            FUN_005e1fb0(&local_21c,"0x{0:x}-0x{1:x}",&local_228,puVar1 + -1);
          }
          iVar2 = local_224;
          if (local_224 != 0) {
            FUN_0051b950(&DAT_00b8c748,0xffffffff);
          }
          FUN_0051b950(local_204,0xffffffff);
          local_224 = iVar2 + 1;
          if (4 < local_224) goto LAB_005e2670;
          uVar3 = (uint)*(ushort *)(*unaff_ESI + uVar4 * 4);
          local_229 = '\0';
          local_228 = uVar3;
        }
      }
      uVar4 = uVar4 + 1;
    } while (uVar4 < (uint)unaff_ESI[1]);
    if (local_229 == '\0') {
      local_218 = local_204;
      local_21c = 2;
      local_214 = 0x200;
      FUN_005e1fb0(&local_21c,"0x{0:x}-0x{1:x}",&local_228,*unaff_ESI + -2 + unaff_ESI[1] * 4);
      if (local_224 != 0) {
        FUN_0051b950(&DAT_00b8c748,0xffffffff);
      }
      FUN_0051b950(local_204,0xffffffff);
    }
  }
LAB_005e2670:
  if (uVar4 < (uint)unaff_ESI[1]) {
    FUN_0051b950(" (truncated)",0xffffffff);
  }
  __security_check_cookie(local_4 ^ (uint)auStack_22c);
  return;
}



============================================================
DISASSEMBLY
============================================================
005e24e0 : SUB ESP,0x22c
005e24e6 : MOV EAX,[0x00d66fa0]
005e24eb : XOR EAX,ESP
005e24ed : MOV dword ptr [ESP + 0x228],EAX
005e24f4 : PUSH EBX
005e24f5 : PUSH EBP
005e24f6 : MOV EBX,ECX
005e24f8 : PUSH EDI
005e24f9 : MOV dword ptr [ESP + 0x18],EBX
005e24fd : CALL 0x0051b6e0
005e2502 : MOV EAX,dword ptr [ESI + 0x4]
005e2505 : XOR EDI,EDI
005e2507 : XOR EBP,EBP
005e2509 : MOV dword ptr [ESP + 0x14],EDI
005e250d : MOV byte ptr [ESP + 0xf],0x1
005e2512 : MOV dword ptr [ESP + 0x10],EBP
005e2516 : CMP EAX,EDI
005e2518 : JBE 0x005e2670
005e251e : MOV EDI,EDI
005e2520 : TEST EDI,EDI
005e2522 : JNZ 0x005e2537
005e2524 : MOV EAX,dword ptr [ESI]
005e2526 : MOVZX EBP,word ptr [EAX]
005e2529 : MOV dword ptr [ESP + 0x10],EBP
005e252d : MOV byte ptr [ESP + 0xf],0x0
005e2532 : JMP 0x005e2603
005e2537 : MOV ECX,dword ptr [ESI]
005e2539 : LEA EAX,[ECX + EDI*0x4]
005e253c : MOVZX EDX,word ptr [EAX + -0x2]
005e2540 : LEA ECX,[EAX + -0x2]
005e2543 : MOVZX EAX,word ptr [EAX]
005e2546 : MOVZX EBX,DX
005e2549 : INC EBX
005e254a : CMP EAX,EBX
005e254c : JLE 0x005e25ff
005e2552 : CMP BP,DX
005e2555 : JNZ 0x005e2588
005e2557 : LEA EDX,[ESP + 0x10]
005e255b : PUSH EDX
005e255c : LEA EAX,[ESP + 0x2c]
005e2560 : LEA ECX,[ESP + 0x38]
005e2564 : PUSH 0xb93b5c
005e2569 : PUSH EAX
005e256a : MOV dword ptr [ESP + 0x34],0x2
005e2572 : MOV dword ptr [ESP + 0x38],ECX
005e2576 : MOV dword ptr [ESP + 0x3c],0x200
005e257e : CALL 0x005e1f30
005e2583 : ADD ESP,0xc
005e2586 : JMP 0x005e25b8
005e2588 : PUSH ECX
005e2589 : LEA EAX,[ESP + 0x14]
005e258d : PUSH EAX
005e258e : LEA ECX,[ESP + 0x24]
005e2592 : LEA EDX,[ESP + 0x3c]
005e2596 : PUSH 0xb93b4c
005e259b : PUSH ECX
005e259c : MOV dword ptr [ESP + 0x2c],0x2
005e25a4 : MOV dword ptr [ESP + 0x30],EDX
005e25a8 : MOV dword ptr [ESP + 0x34],0x200
005e25b0 : CALL 0x005e1fb0
005e25b5 : ADD ESP,0x10
005e25b8 : MOV EBP,dword ptr [ESP + 0x14]
005e25bc : MOV EBX,dword ptr [ESP + 0x18]
005e25c0 : TEST EBP,EBP
005e25c2 : JZ 0x005e25d2
005e25c4 : PUSH -0x1
005e25c6 : PUSH 0xb8c748
005e25cb : MOV ECX,EBX
005e25cd : CALL 0x0051b950
005e25d2 : PUSH -0x1
005e25d4 : LEA EDX,[ESP + 0x38]
005e25d8 : PUSH EDX
005e25d9 : MOV ECX,EBX
005e25db : CALL 0x0051b950
005e25e0 : INC EBP
005e25e1 : CMP EBP,0x4
005e25e4 : MOV dword ptr [ESP + 0x14],EBP
005e25e8 : JG 0x005e2670
005e25ee : MOV EAX,dword ptr [ESI]
005e25f0 : MOVZX EBP,word ptr [EAX + EDI*0x4]
005e25f4 : MOV dword ptr [ESP + 0x10],EBP
005e25f8 : MOV byte ptr [ESP + 0xf],0x0
005e25fd : JMP 0x005e2603
005e25ff : MOV EBX,dword ptr [ESP + 0x18]
005e2603 : INC EDI
005e2604 : CMP EDI,dword ptr [ESI + 0x4]
005e2607 : JC 0x005e2520
005e260d : CMP byte ptr [ESP + 0xf],0x0
005e2612 : JNZ 0x005e2670
005e2614 : MOV EDX,dword ptr [ESI]
005e2616 : MOV EAX,dword ptr [ESI + 0x4]
005e2619 : LEA ECX,[ESP + 0x34]
005e261d : LEA EAX,[EDX + EAX*0x4 + -0x2]
005e2621 : PUSH EAX
005e2622 : MOV dword ptr [ESP + 0x24],ECX
005e2626 : LEA ECX,[ESP + 0x14]
005e262a : PUSH ECX
005e262b : LEA EDX,[ESP + 0x24]
005e262f : PUSH 0xb93b4c
005e2634 : PUSH EDX
005e2635 : MOV dword ptr [ESP + 0x2c],0x2
005e263d : MOV dword ptr [ESP + 0x34],0x200
005e2645 : CALL 0x005e1fb0
005e264a : ADD ESP,0x10
005e264d : CMP dword ptr [ESP + 0x14],0x0
005e2652 : JZ 0x005e2662
005e2654 : PUSH -0x1
005e2656 : PUSH 0xb8c748
005e265b : MOV ECX,EBX
005e265d : CALL 0x0051b950
005e2662 : PUSH -0x1
005e2664 : LEA EAX,[ESP + 0x38]
005e2668 : PUSH EAX
005e2669 : MOV ECX,EBX
005e266b : CALL 0x0051b950
005e2670 : CMP EDI,dword ptr [ESI + 0x4]
005e2673 : JNC 0x005e2683
005e2675 : PUSH -0x1
005e2677 : PUSH 0xb93b3c
005e267c : MOV ECX,EBX
005e267e : CALL 0x0051b950
005e2683 : MOV ECX,dword ptr [ESP + 0x234]
005e268a : POP EDI
005e268b : POP EBP
005e268c : MOV EAX,EBX
005e268e : POP EBX
005e268f : XOR ECX,ESP
005e2691 : CALL 0x00633e6b
005e2696 : ADD ESP,0x22c
005e269c : RET

PROGRAM  : Maestia.exe
FUNCTION : do_get
ENTRY    : 006243bb
BODY     : [[006243bb, 00624471]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __EH_prolog3_GS replaced with injection: EH_prolog3 */
/* Library Function - Multiple Matches With Same Base Name
    protected: virtual class std::istreambuf_iterator<char,struct std::char_traits<char> >
   __thiscall std::num_get<char,class std::istreambuf_iterator<char,struct std::char_traits<char> >
   >::do_get(class std::istreambuf_iterator<char,struct std::char_traits<char> >,class
   std::istreambuf_iterator<char,struct std::char_traits<char> >,class std::ios_base &,int &,__int64
   &)const 
    protected: virtual class std::istreambuf_iterator<char,struct std::char_traits<char> >
   __thiscall std::num_get<char,class std::istreambuf_iterator<char,struct std::char_traits<char> >
   >::do_get(class std::istreambuf_iterator<char,struct std::char_traits<char> >,class
   std::istreambuf_iterator<char,struct std::char_traits<char> >,class std::ios_base &,int
   &,unsigned __int64 &)const 
   
   Library: Visual Studio 2008 Release */

void do_get(undefined4 *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
           undefined4 param_5,int param_6,uint *param_7,undefined8 *param_8)

{
  uint *puVar1;
  undefined8 *puVar2;
  bool bVar3;
  int iVar4;
  char *in_ECX;
  undefined8 uVar5;
  num_get<char,class_std::istreambuf_iterator<char,struct_std::char_traits<char>_>_> *this;
  istreambuf_iterator<char,struct_std::char_traits<char>_> *local_44;
  undefined4 *local_40;
  undefined1 local_3c [4];
  int local_38;
  istreambuf_iterator<char,struct_std::char_traits<char>_> local_34 [44];
  undefined4 local_8;
  undefined4 uStack_4;
  
  puVar2 = param_8;
  puVar1 = param_7;
  iVar4 = param_6;
  uStack_4 = 0x3c;
  local_8 = 0x6243c7;
  local_38 = 0;
  local_40 = param_1;
  FUN_004d0b70(local_3c);
  local_8 = 0;
  this = (num_get<char,class_std::istreambuf_iterator<char,struct_std::char_traits<char>_>_> *)
         &local_38;
  iVar4 = std::num_get<char,class_std::istreambuf_iterator<char,struct_std::char_traits<char>_>_>::
          _Getifld(this,in_ECX,local_34,
                   (istreambuf_iterator<char,struct_std::char_traits<char>_> *)&param_2,
                   (int)&param_4,*(locale **)(iVar4 + 0x10));
  uVar5 = FUN_00633484(local_34,&local_44,iVar4,this);
  local_8 = 0xffffffff;
  FUN_00451310();
  bVar3 = std::istreambuf_iterator<char,struct_std::char_traits<char>_>::equal
                    ((istreambuf_iterator<char,struct_std::char_traits<char>_> *)&param_2,
                     (istreambuf_iterator<char,struct_std::char_traits<char>_> *)&param_4);
  if (bVar3) {
    *puVar1 = *puVar1 | 1;
  }
  if ((local_44 == local_34) || (local_38 != 0)) {
    *puVar1 = *puVar1 | 2;
  }
  else {
    *puVar2 = uVar5;
  }
  *local_40 = param_2;
  local_40[1] = param_3;
  FUN_00640ed0();
  return;
}



============================================================
DISASSEMBLY
============================================================
006243bb : PUSH 0x3c
006243bd : MOV EAX,0xb0bfe5
006243c2 : CALL 0x00640e86
006243c7 : MOV EAX,dword ptr [EBP + 0x8]
006243ca : MOV ESI,dword ptr [EBP + 0x1c]
006243cd : MOV EBX,dword ptr [EBP + 0x20]
006243d0 : MOV EDI,dword ptr [EBP + 0x24]
006243d3 : AND dword ptr [EBP + -0x34],0x0
006243d7 : MOV dword ptr [EBP + -0x3c],EAX
006243da : LEA EAX,[EBP + -0x38]
006243dd : MOV dword ptr [EBP + -0x44],ECX
006243e0 : PUSH EAX
006243e1 : MOV ECX,ESI
006243e3 : CALL 0x004d0b70
006243e8 : MOV ESI,dword ptr [ESI + 0x10]
006243eb : AND dword ptr [EBP + -0x4],0x0
006243ef : LEA ECX,[EBP + -0x34]
006243f2 : PUSH ECX
006243f3 : PUSH EAX
006243f4 : PUSH ESI
006243f5 : LEA EAX,[EBP + 0x14]
006243f8 : PUSH EAX
006243f9 : LEA EAX,[EBP + 0xc]
006243fc : PUSH EAX
006243fd : LEA EAX,[EBP + -0x30]
00624400 : PUSH EAX
00624401 : PUSH dword ptr [EBP + -0x44]
00624404 : CALL 0x00623717
00624409 : ADD ESP,0x18
0062440c : PUSH EAX
0062440d : LEA EAX,[EBP + -0x40]
00624410 : PUSH EAX
00624411 : LEA EAX,[EBP + -0x30]
00624414 : PUSH EAX
00624415 : CALL 0x00633484
0062441a : OR dword ptr [EBP + -0x4],0xffffffff
0062441e : ADD ESP,0x10
00624421 : LEA ECX,[EBP + -0x38]
00624424 : MOV ESI,EAX
00624426 : MOV dword ptr [EBP + -0x44],EDX
00624429 : CALL 0x00451310
0062442e : LEA EAX,[EBP + 0x14]
00624431 : PUSH EAX
00624432 : LEA ECX,[EBP + 0xc]
00624435 : CALL 0x00623123
0062443a : TEST AL,AL
0062443c : JZ 0x00624441
0062443e : OR dword ptr [EBX],0x1
00624441 : LEA EAX,[EBP + -0x30]
00624444 : CMP dword ptr [EBP + -0x40],EAX
00624447 : JZ 0x00624459
00624449 : CMP dword ptr [EBP + -0x34],0x0
0062444d : JNZ 0x00624459
0062444f : MOV EAX,dword ptr [EBP + -0x44]
00624452 : MOV dword ptr [EDI],ESI
00624454 : MOV dword ptr [EDI + 0x4],EAX
00624457 : JMP 0x0062445c
00624459 : OR dword ptr [EBX],0x2
0062445c : MOV ECX,dword ptr [EBP + 0xc]
0062445f : MOV EAX,dword ptr [EBP + -0x3c]
00624462 : MOV dword ptr [EAX],ECX
00624464 : MOV ECX,dword ptr [EBP + 0x10]
00624467 : MOV dword ptr [EAX + 0x4],ECX
0062446a : CALL 0x00640ed0
0062446f : RET 0x20

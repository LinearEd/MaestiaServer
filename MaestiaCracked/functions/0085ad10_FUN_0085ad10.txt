PROGRAM  : Maestia.exe
FUNCTION : FUN_0085ad10
ENTRY    : 0085ad10
BODY     : [[0085ad10, 0085af35]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0085ad10(int param_1,byte param_2)

{
  wchar_t wVar1;
  int iVar2;
  wchar_t *pwVar3;
  int in_ECX;
  int in_EDX;
  undefined1 auStack_270 [12];
  undefined4 uStack_264;
  undefined1 local_244 [28];
  undefined4 local_228;
  int local_224;
  undefined1 *local_220;
  undefined **local_21c;
  undefined4 local_218;
  wchar_t local_214;
  undefined1 local_212 [510];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b34639;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_228 = 0;
  local_224 = param_1;
  local_21c = &PTR_FUN_00cd083c;
  local_218 = 0xff;
  uStack_264 = 0x85ad7f;
  _wcscpy_s(&local_214,0x100,L"");
  local_8 = 1;
  iVar2 = FUN_0085a140();
  if (in_ECX == iVar2) {
    if (DAT_017248f4 != 0) {
      local_220 = (undefined1 *)0x0;
      FUN_00404400();
      if (local_220 != (undefined1 *)0x0) {
        FUN_00406e40();
      }
    }
  }
  else {
    if (*(int *)(in_EDX + 0x176c + (uint)param_2 * 4) == 0) {
      if (in_ECX == 0) goto LAB_0085aec3;
      iVar2 = FUN_004049b0();
    }
    else {
      iVar2 = FUN_004049b0();
      param_1 = local_224;
      if ((iVar2 == 0) || (*(short *)(iVar2 + 4) != 0x61e)) goto LAB_0085aec3;
    }
    param_1 = local_224;
    if (iVar2 != 0) {
      FUN_00406e40();
      pwVar3 = &local_214;
      do {
        wVar1 = *pwVar3;
        pwVar3 = pwVar3 + 1;
      } while (wVar1 != L'\0');
      param_1 = local_224;
      if ((int)pwVar3 - (int)local_212 >> 1 != 0) {
        local_220 = auStack_270;
        FUN_00406460(&local_214);
        local_8._1_3_ = (undefined3)(local_8 >> 8);
        local_8._0_1_ = 1;
        FUN_0085a380(in_EDX,local_244);
        local_8._0_1_ = 3;
        FUN_0041fa10();
        local_8 = CONCAT31(local_8._1_3_,1);
        FUN_00406560();
        param_1 = local_224;
      }
    }
  }
LAB_0085aec3:
  pwVar3 = &local_214;
  *(undefined4 *)(param_1 + 0x18) = 7;
  *(undefined4 *)(param_1 + 0x14) = 0;
  *(undefined2 *)(param_1 + 4) = 0;
  do {
    wVar1 = *pwVar3;
    pwVar3 = pwVar3 + 1;
  } while (wVar1 != L'\0');
  FUN_00406360();
  local_228 = 1;
  local_8 = local_8 & 0xffffff00;
  local_21c = &PTR_FUN_00cd083c;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0085ad10 : PUSH EBP
0085ad11 : MOV EBP,ESP
0085ad13 : PUSH -0x1
0085ad15 : PUSH 0xb34639
0085ad1a : MOV EAX,FS:[0x0]
0085ad20 : PUSH EAX
0085ad21 : SUB ESP,0x234
0085ad27 : MOV EAX,[0x00d66fa0]
0085ad2c : XOR EAX,EBP
0085ad2e : MOV dword ptr [EBP + -0x10],EAX
0085ad31 : PUSH EBX
0085ad32 : PUSH ESI
0085ad33 : PUSH EDI
0085ad34 : PUSH EAX
0085ad35 : LEA EAX,[EBP + -0xc]
0085ad38 : MOV FS:[0x0],EAX
0085ad3e : MOV EDI,ECX
0085ad40 : MOV EBX,dword ptr [EBP + 0x8]
0085ad43 : PUSH 0xcca49c
0085ad48 : LEA EAX,[EBP + 0xfffffdf0]
0085ad4e : MOV dword ptr [EBP + 0xfffffddc],0x0
0085ad58 : PUSH 0x100
0085ad5d : PUSH EAX
0085ad5e : MOV ESI,EDX
0085ad60 : MOV dword ptr [EBP + 0xfffffde0],EBX
0085ad66 : MOV dword ptr [EBP + 0xfffffde8],0xcd083c
0085ad70 : MOV dword ptr [EBP + 0xfffffdec],0xff
0085ad7a : CALL 0x0063481b
0085ad7f : ADD ESP,0xc
0085ad82 : MOV dword ptr [EBP + -0x4],0x1
0085ad89 : MOV AL,byte ptr [EBP + 0xc]
0085ad8c : CALL 0x0085a140
0085ad91 : CMP EDI,EAX
0085ad93 : JNZ 0x0085addd
0085ad95 : MOV ECX,dword ptr [0x017248f4]
0085ad9b : TEST ECX,ECX
0085ad9d : JZ 0x0085aec3
0085ada3 : LEA EDX,[EBP + 0xfffffde4]
0085ada9 : PUSH EDX
0085adaa : MOV ESI,EDI
0085adac : MOV dword ptr [EBP + 0xfffffde4],0x0
0085adb6 : CALL 0x00404400
0085adbb : MOV EAX,dword ptr [EBP + 0xfffffde4]
0085adc1 : TEST EAX,EAX
0085adc3 : JZ 0x0085aec3
0085adc9 : ADD EAX,0x18
0085adcc : PUSH EAX
0085adcd : LEA EDI,[EBP + 0xfffffde8]
0085add3 : CALL 0x00406e40
0085add8 : JMP 0x0085aec3
0085addd : MOVZX EAX,byte ptr [EBP + 0xc]
0085ade1 : MOV EAX,dword ptr [ESI + EAX*0x4 + 0x176c]
0085ade8 : TEST EAX,EAX
0085adea : JZ 0x0085ae10
0085adec : PUSH EAX
0085aded : CALL 0x004049b0
0085adf2 : MOV EBX,EAX
0085adf4 : ADD ESP,0x4
0085adf7 : TEST EBX,EBX
0085adf9 : JZ 0x0085aebd
0085adff : MOV ECX,0x61e
0085ae04 : CMP word ptr [EBX + 0x4],CX
0085ae08 : JNZ 0x0085aebd
0085ae0e : JMP 0x0085ae23
0085ae10 : TEST EDI,EDI
0085ae12 : JZ 0x0085aec3
0085ae18 : PUSH EDI
0085ae19 : CALL 0x004049b0
0085ae1e : ADD ESP,0x4
0085ae21 : MOV EBX,EAX
0085ae23 : TEST EBX,EBX
0085ae25 : JZ 0x0085aebd
0085ae2b : MOVZX EDX,byte ptr [ESI + 0x7e]
0085ae2f : SHL EDX,0x6
0085ae32 : LEA EAX,[EDX + EBX*0x1 + 0x190]
0085ae39 : PUSH EAX
0085ae3a : LEA EDI,[EBP + 0xfffffde8]
0085ae40 : CALL 0x00406e40
0085ae45 : LEA EAX,[EBP + 0xfffffdf0]
0085ae4b : LEA EDX,[EAX + 0x2]
0085ae4e : MOV EDI,EDI
0085ae50 : MOV CX,word ptr [EAX]
0085ae53 : ADD EAX,0x2
0085ae56 : TEST CX,CX
0085ae59 : JNZ 0x0085ae50
0085ae5b : SUB EAX,EDX
0085ae5d : SAR EAX,0x1
0085ae5f : JZ 0x0085aebd
0085ae61 : SUB ESP,0x1c
0085ae64 : LEA EDX,[EBP + 0xfffffdf0]
0085ae6a : MOV ECX,ESP
0085ae6c : MOV dword ptr [EBP + 0xfffffde4],ESP
0085ae72 : PUSH EDX
0085ae73 : CALL 0x00406460
0085ae78 : MOV byte ptr [EBP + -0x4],0x2
0085ae7c : LEA EAX,[EBP + 0xfffffdc0]
0085ae82 : PUSH EAX
0085ae83 : PUSH ESI
0085ae84 : MOV byte ptr [EBP + -0x4],0x1
0085ae88 : MOV ECX,EBX
0085ae8a : CALL 0x0085a380
0085ae8f : MOV byte ptr [EBP + -0x4],0x3
0085ae93 : CMP dword ptr [EAX + 0x18],0x8
0085ae97 : JC 0x0085ae9e
0085ae99 : MOV EAX,dword ptr [EAX + 0x4]
0085ae9c : JMP 0x0085aea1
0085ae9e : ADD EAX,0x4
0085aea1 : MOV EDI,EAX
0085aea3 : LEA EAX,[EBP + 0xfffffde8]
0085aea9 : CALL 0x0041fa10
0085aeae : MOV byte ptr [EBP + -0x4],0x1
0085aeb2 : LEA ECX,[EBP + 0xfffffdc0]
0085aeb8 : CALL 0x00406560
0085aebd : MOV EBX,dword ptr [EBP + 0xfffffde0]
0085aec3 : XOR ECX,ECX
0085aec5 : LEA EAX,[EBP + 0xfffffdf0]
0085aecb : MOV dword ptr [EBX + 0x18],0x7
0085aed2 : MOV dword ptr [EBX + 0x14],0x0
0085aed9 : MOV word ptr [EBX + 0x4],CX
0085aedd : LEA EDX,[EAX + 0x2]
0085aee0 : MOV CX,word ptr [EAX]
0085aee3 : ADD EAX,0x2
0085aee6 : TEST CX,CX
0085aee9 : JNZ 0x0085aee0
0085aeeb : SUB EAX,EDX
0085aeed : SAR EAX,0x1
0085aeef : PUSH EAX
0085aef0 : LEA EDX,[EBP + 0xfffffdf0]
0085aef6 : PUSH EDX
0085aef7 : MOV ECX,EBX
0085aef9 : CALL 0x00406360
0085aefe : MOV dword ptr [EBP + 0xfffffddc],0x1
0085af08 : MOV byte ptr [EBP + -0x4],0x0
0085af0c : MOV dword ptr [EBP + 0xfffffde8],0xcd083c
0085af16 : MOV EAX,EBX
0085af18 : MOV ECX,dword ptr [EBP + -0xc]
0085af1b : MOV dword ptr FS:[0x0],ECX
0085af22 : POP ECX
0085af23 : POP EDI
0085af24 : POP ESI
0085af25 : POP EBX
0085af26 : MOV ECX,dword ptr [EBP + -0x10]
0085af29 : XOR ECX,EBP
0085af2b : CALL 0x00633e6b
0085af30 : MOV ESP,EBP
0085af32 : POP EBP
0085af33 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_00803d90
ENTRY    : 00803d90
BODY     : [[00803d90, 00803fc0]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00803d90(int param_1)

{
  char cVar1;
  uint uVar2;
  undefined4 *puVar3;
  int *piVar4;
  undefined4 uVar5;
  int *piVar6;
  int unaff_EDI;
  undefined4 *local_268;
  int local_264 [2];
  undefined1 local_25c [36];
  undefined2 local_238;
  undefined4 local_228;
  uint local_224;
  WCHAR local_220 [258];
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  int local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b3cd3e;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)&local_268;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffd90;
  ExceptionList = &local_14;
  FUN_0070c5e0();
  local_c = 0;
  local_264[0] = param_1 + 4;
  FUN_0043acd0(local_264[0],&local_268);
  if (local_268 == *(undefined4 **)(param_1 + 8)) {
    local_268 = (undefined4 *)FUN_006f0760(0xaf0,"",0,(DAT_01725270 >> 3 & 1) == 0,uVar2);
    local_c._0_1_ = 1;
    if (local_268 == (undefined4 *)0x0) {
      puVar3 = (undefined4 *)0x0;
    }
    else {
      puVar3 = (undefined4 *)FUN_00a5e100(local_268);
    }
    local_c._0_1_ = 0;
    local_268 = puVar3;
    cVar1 = FUN_00a5ed60(puVar3);
    if (cVar1 == '\0') {
      piVar6 = (int *)(unaff_EDI + 4);
      piVar4 = piVar6;
      if (7 < *(uint *)(unaff_EDI + 0x18)) {
        piVar4 = (int *)*piVar6;
      }
      wsprintfW(local_220,L"%s is missing or corrupted.",piVar4);
      MessageBoxW((HWND)0x0,local_220,L"File Not Found!",0x10);
      if (7 < *(uint *)(unaff_EDI + 0x18)) {
        piVar6 = (int *)*piVar6;
      }
      FUN_008018d0(L"[AvaVDiskMgr::AddVDisk] Failed to Open :%s",piVar6);
      if (puVar3 != (undefined4 *)0x0) {
        (**(code **)*puVar3)(1);
      }
      local_c = 0xffffffff;
      if (7 < local_224) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
    }
    else {
      uVar5 = FUN_0043c130(local_25c,&local_268);
      local_c._0_1_ = 2;
      FUN_0042f990(local_264[0],local_264,uVar5);
      local_c = (uint)local_c._1_3_ << 8;
      FUN_0044cb00(local_25c);
      local_c = 0xffffffff;
      if (7 < local_224) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
    }
  }
  else {
    FUN_008018d0(L"VDisk name already exist.");
    local_c = 0xffffffff;
    if (7 < local_224) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  local_c = 0xffffffff;
  local_238 = 0;
  local_224 = 7;
  local_228 = 0;
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)&local_268);
  return;
}



============================================================
DISASSEMBLY
============================================================
00803d90 : PUSH EBP
00803d91 : MOV EBP,ESP
00803d93 : AND ESP,0xfffffff8
00803d96 : PUSH -0x1
00803d98 : PUSH 0xb3cd3e
00803d9d : MOV EAX,FS:[0x0]
00803da3 : PUSH EAX
00803da4 : SUB ESP,0x254
00803daa : MOV EAX,[0x00d66fa0]
00803daf : XOR EAX,ESP
00803db1 : MOV dword ptr [ESP + 0x24c],EAX
00803db8 : PUSH EBX
00803db9 : PUSH ESI
00803dba : MOV EAX,[0x00d66fa0]
00803dbf : XOR EAX,ESP
00803dc1 : PUSH EAX
00803dc2 : LEA EAX,[ESP + 0x260]
00803dc9 : MOV FS:[0x0],EAX
00803dcf : MOV EBX,dword ptr [EBP + 0x8]
00803dd2 : PUSH EDI
00803dd3 : LEA ESI,[ESP + 0x3c]
00803dd7 : CALL 0x0070c5e0
00803ddc : ADD ESP,0x4
00803ddf : MOV dword ptr [ESP + 0x268],0x0
00803dea : LEA ECX,[ESP + 0xc]
00803dee : LEA EAX,[EBX + 0x4]
00803df1 : PUSH ECX
00803df2 : PUSH EAX
00803df3 : MOV dword ptr [ESP + 0x18],EAX
00803df7 : CALL 0x0043acd0
00803dfc : MOV EAX,dword ptr [EBX + 0x8]
00803dff : MOV EBX,dword ptr [ESP + 0xc]
00803e03 : CMP EBX,EAX
00803e05 : JZ 0x00803e44
00803e07 : MOV ESI,dword ptr [0x00da98e8]
00803e0d : PUSH 0xc28d14
00803e12 : CALL 0x008018d0
00803e17 : MOV EBX,dword ptr [EBX + 0x28]
00803e1a : ADD ESP,0x4
00803e1d : MOV dword ptr [ESP + 0x268],0xffffffff
00803e28 : CMP dword ptr [ESP + 0x50],0x8
00803e2d : JC 0x00803e38
00803e2f : MOV ECX,dword ptr [ESP + 0x3c]
00803e33 : CALL 0x006f04e0
00803e38 : XOR EDX,EDX
00803e3a : MOV word ptr [ESP + 0x3c],DX
00803e3f : JMP 0x00803f8a
00803e44 : MOV EAX,[0x01725270]
00803e49 : SHR EAX,0x3
00803e4c : MOV ECX,0x0
00803e51 : AND EAX,0x1
00803e54 : SETZ CL
00803e57 : PUSH ECX
00803e58 : PUSH 0x0
00803e5a : PUSH 0xbf1a4a
00803e5f : PUSH 0xaf0
00803e64 : CALL 0x006f0760
00803e69 : ADD ESP,0x10
00803e6c : MOV dword ptr [ESP + 0xc],EAX
00803e70 : MOV byte ptr [ESP + 0x268],0x1
00803e78 : TEST EAX,EAX
00803e7a : JZ 0x00803e86
00803e7c : PUSH EAX
00803e7d : CALL 0x00a5e100
00803e82 : MOV EBX,EAX
00803e84 : JMP 0x00803e88
00803e86 : XOR EBX,EBX
00803e88 : MOV byte ptr [ESP + 0x268],0x0
00803e90 : PUSH EBX
00803e91 : MOV ECX,EDI
00803e93 : MOV dword ptr [ESP + 0x10],EBX
00803e97 : CALL 0x00a5ed60
00803e9c : TEST AL,AL
00803e9e : JNZ 0x00803f2b
00803ea4 : CMP dword ptr [EDI + 0x18],0x8
00803ea8 : LEA ESI,[EDI + 0x4]
00803eab : JC 0x00803eb1
00803ead : MOV EAX,dword ptr [ESI]
00803eaf : JMP 0x00803eb3
00803eb1 : MOV EAX,ESI
00803eb3 : PUSH EAX
00803eb4 : LEA EDX,[ESP + 0x58]
00803eb8 : PUSH 0xc28e50
00803ebd : PUSH EDX
00803ebe : CALL dword ptr [0x00b85434]
00803ec4 : ADD ESP,0xc
00803ec7 : PUSH 0x10
00803ec9 : PUSH 0xc28e88
00803ece : LEA EAX,[ESP + 0x5c]
00803ed2 : PUSH EAX
00803ed3 : PUSH 0x0
00803ed5 : CALL dword ptr [0x00b85514]
00803edb : CMP dword ptr [EDI + 0x18],0x8
00803edf : JC 0x00803ee3
00803ee1 : MOV ESI,dword ptr [ESI]
00803ee3 : PUSH ESI
00803ee4 : MOV ESI,dword ptr [0x00da98e8]
00803eea : PUSH 0xc28ea8
00803eef : CALL 0x008018d0
00803ef4 : ADD ESP,0x8
00803ef7 : TEST EBX,EBX
00803ef9 : JZ 0x00803f05
00803efb : MOV EDX,dword ptr [EBX]
00803efd : MOV EAX,dword ptr [EDX]
00803eff : PUSH 0x1
00803f01 : MOV ECX,EBX
00803f03 : CALL EAX
00803f05 : MOV dword ptr [ESP + 0x268],0xffffffff
00803f10 : CMP dword ptr [ESP + 0x50],0x8
00803f15 : JC 0x00803f20
00803f17 : MOV ECX,dword ptr [ESP + 0x3c]
00803f1b : CALL 0x006f04e0
00803f20 : XOR ECX,ECX
00803f22 : MOV word ptr [ESP + 0x3c],CX
00803f27 : XOR EAX,EAX
00803f29 : JMP 0x00803f8c
00803f2b : LEA EDX,[ESP + 0xc]
00803f2f : PUSH EDX
00803f30 : LEA EAX,[ESP + 0x1c]
00803f34 : PUSH EAX
00803f35 : LEA ECX,[ESP + 0x40]
00803f39 : CALL 0x0043c130
00803f3e : MOV byte ptr [ESP + 0x268],0x2
00803f46 : MOV EDX,dword ptr [ESP + 0x10]
00803f4a : PUSH EAX
00803f4b : LEA ECX,[ESP + 0x14]
00803f4f : PUSH ECX
00803f50 : PUSH EDX
00803f51 : CALL 0x0042f990
00803f56 : MOV byte ptr [ESP + 0x268],0x0
00803f5e : LEA EAX,[ESP + 0x18]
00803f62 : PUSH EAX
00803f63 : CALL 0x0044cb00
00803f68 : MOV dword ptr [ESP + 0x268],0xffffffff
00803f73 : CMP dword ptr [ESP + 0x50],0x8
00803f78 : JC 0x00803f83
00803f7a : MOV ECX,dword ptr [ESP + 0x3c]
00803f7e : CALL 0x006f04e0
00803f83 : XOR ECX,ECX
00803f85 : MOV word ptr [ESP + 0x3c],CX
00803f8a : MOV EAX,EBX
00803f8c : MOV dword ptr [ESP + 0x50],0x7
00803f94 : MOV dword ptr [ESP + 0x4c],0x0
00803f9c : MOV ECX,dword ptr [ESP + 0x260]
00803fa3 : MOV dword ptr FS:[0x0],ECX
00803faa : POP ECX
00803fab : POP ESI
00803fac : POP EBX
00803fad : MOV ECX,dword ptr [ESP + 0x24c]
00803fb4 : XOR ECX,ESP
00803fb6 : CALL 0x00633e6b
00803fbb : MOV ESP,EBP
00803fbd : POP EBP
00803fbe : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_005037e0
ENTRY    : 005037e0
BODY     : [[005037e0, 0050389b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005037e0(int param_1,undefined4 *param_2)

{
  undefined1 uVar1;
  undefined1 uVar2;
  int iVar3;
  int iVar4;
  GThread *extraout_ECX;
  GThread *extraout_ECX_00;
  GThread *this;
  
  iVar4 = *(int *)(param_1 + 0x314);
  if (iVar4 == 0) {
    iVar4 = param_1 + 0x28;
  }
  *(undefined1 *)(iVar4 + 0x15) = 0;
  if (*(int *)(iVar4 + 0x30) - *(int *)(iVar4 + 0x2c) < 2) {
    FUN_00539fb0(2);
  }
  iVar3 = *(int *)(iVar4 + 0x2c);
  uVar1 = *(undefined1 *)(*(int *)(iVar4 + 0x3c) + 1 + iVar3);
  uVar2 = *(undefined1 *)(*(int *)(iVar4 + 0x3c) + iVar3);
  *(int *)(iVar4 + 0x2c) = iVar3 + 2;
  iVar4 = FUN_00515840(0x58,0);
  if (iVar4 == 0) {
    iVar4 = 0;
    this = extraout_ECX;
  }
  else {
    iVar4 = FUN_00503740();
    this = extraout_ECX_00;
  }
  GThread::OnExit(this);
  FUN_005024f0(param_1,*param_2);
  if (*(int *)(param_1 + 0x2e8) == 0) {
    FUN_00566b90(CONCAT11(uVar1,uVar2),iVar4);
  }
  if (iVar4 != 0) {
    FUN_00524240();
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005037e0 : PUSH EBX
005037e1 : PUSH ESI
005037e2 : PUSH EDI
005037e3 : MOV EDI,dword ptr [ESP + 0x10]
005037e7 : MOV ESI,dword ptr [EDI + 0x314]
005037ed : TEST ESI,ESI
005037ef : JNZ 0x005037f4
005037f1 : LEA ESI,[EDI + 0x28]
005037f4 : MOV EAX,dword ptr [ESI + 0x30]
005037f7 : SUB EAX,dword ptr [ESI + 0x2c]
005037fa : MOV byte ptr [ESI + 0x15],0x0
005037fe : CMP EAX,0x2
00503801 : JGE 0x0050380c
00503803 : PUSH 0x2
00503805 : MOV ECX,ESI
00503807 : CALL 0x00539fb0
0050380c : MOV EAX,dword ptr [ESI + 0x2c]
0050380f : MOV ECX,dword ptr [ESI + 0x3c]
00503812 : MOVZX DX,byte ptr [ECX + EAX*0x1 + 0x1]
00503818 : ADD ECX,EAX
0050381a : MOVZX CX,byte ptr [ECX]
0050381e : ADD EAX,0x2
00503821 : MOV dword ptr [ESI + 0x2c],EAX
00503824 : MOV EAX,dword ptr [EDI + 0x20]
00503827 : MOV EAX,dword ptr [EAX + 0x1c]
0050382a : SHL DX,0x8
0050382e : OR DX,CX
00503831 : PUSH 0x0
00503833 : PUSH 0x58
00503835 : MOV ECX,EAX
00503837 : MOVZX EBX,DX
0050383a : CALL 0x00515840
0050383f : TEST EAX,EAX
00503841 : JZ 0x0050384e
00503843 : MOV ECX,EAX
00503845 : CALL 0x00503740
0050384a : MOV ESI,EAX
0050384c : JMP 0x00503850
0050384e : XOR ESI,ESI
00503850 : MOVZX EBX,BX
00503853 : PUSH EBX
00503854 : LEA EDX,[EDI + 0x14]
00503857 : PUSH 0xb86518
0050385c : PUSH EDX
0050385d : CALL 0x0051d420
00503862 : MOV EAX,dword ptr [ESP + 0x20]
00503866 : MOV ECX,dword ptr [EAX]
00503868 : ADD ESP,0xc
0050386b : PUSH ECX
0050386c : PUSH EDI
0050386d : MOV ECX,ESI
0050386f : CALL 0x005024f0
00503874 : CMP dword ptr [EDI + 0x2e8],0x0
0050387b : JNZ 0x0050388b
0050387d : PUSH ESI
0050387e : PUSH ECX
0050387f : MOV EAX,ESP
00503881 : MOV dword ptr [EAX],EBX
00503883 : MOV ECX,dword ptr [EDI + 0x20]
00503886 : CALL 0x00566b90
0050388b : TEST ESI,ESI
0050388d : JZ 0x00503896
0050388f : MOV ECX,ESI
00503891 : CALL 0x00524240
00503896 : POP EDI
00503897 : POP ESI
00503898 : POP EBX
00503899 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_0093f780
ENTRY    : 0093f780
BODY     : [[0093f780, 0093fbe8]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0093f780(int param_1,undefined4 param_2)

{
  char cVar1;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  int *piVar5;
  int iVar6;
  int *in_ECX;
  undefined1 auStack_dc [4];
  uint uStack_d8;
  uint uStack_d4;
  int *piStack_d0;
  undefined4 uStack_cc;
  undefined1 auStack_c4 [28];
  undefined1 auStack_a8 [76];
  undefined1 auStack_5c [8];
  undefined1 auStack_54 [32];
  undefined4 **appuStack_34 [5];
  uint uStack_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  uint uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_00b6b588;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_dc;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xffffff18;
  ExceptionList = &local_14;
  if (((char)in_ECX[2] == '\0') || (iVar6 = *(int *)(in_ECX[1] + 0x128), iVar6 == 0))
  goto LAB_0093fbc3;
  if (param_1 == -1) {
    param_1 = FUN_0093e000(in_ECX);
  }
  iVar3 = (**(code **)(*in_ECX + 0x74))(param_1,param_2,uVar2);
  if ((iVar3 != 0) && (*(char *)(iVar3 + 0x3c) != '\0')) {
    FUN_00406460(L"IDS_GUI_CANT_MOVE_USING_ITEM");
    local_14 = (void *)0x0;
    piVar5 = *(int **)(in_ECX[1] + 0x1a8);
    uVar4 = FUN_0081d120(auStack_5c);
    local_14 = (void *)CONCAT31(local_14._1_3_,1);
    (**(code **)(*piVar5 + 0x44))(uVar4,3);
    uStack_c = uStack_c & 0xffffff00;
    FUN_00406560();
    uStack_c = 0xffffffff;
    FUN_00406560();
    goto LAB_0093fbc3;
  }
  cVar1 = (**(code **)(*in_ECX + 0x5c))(iVar3,iVar6);
  if (cVar1 != '\0') goto LAB_0093fbc3;
  uVar2 = *(uint *)(iVar6 + 0x40);
  if (uVar2 < 0x95) {
    if (uVar2 == 0x94) {
LAB_0093f8c3:
      FUN_008efa90(uVar2,*(undefined2 *)(iVar6 + 0x44),*(undefined2 *)(iVar6 + 0x46),0x43,
                   4 - param_1,param_2);
      goto LAB_0093fbc3;
    }
    if (0x3f < uVar2) {
      if (uVar2 < 0x43) goto LAB_0093f8c3;
      if (uVar2 == 0x43) {
        FUN_0097fa60();
        goto LAB_0093fbc3;
      }
    }
  }
  else if (uVar2 == 0xffffffff) {
    if (iVar3 == 0) {
      FUN_0093f4c0(in_ECX,param_1);
    }
    else if (*(char *)(*(int *)(in_ECX[1] + 0x178) + 0x32) == '\0') {
      FUN_0097fb30(iVar3,param_1,param_2);
    }
    else {
      FUN_00406460(L"IDS_GUI_CANT_PUT_DOWN_BAG");
      uStack_c = 2;
      piVar5 = *(int **)(in_ECX[1] + 0x1a8);
      uVar4 = FUN_0081d120(auStack_c4);
      uStack_c = CONCAT31(uStack_c._1_3_,3);
      (**(code **)(*piVar5 + 0x44))(uVar4,3);
      local_14 = (void *)CONCAT31(local_14._1_3_,2);
      FUN_00406560();
      local_14 = (void *)0xffffffff;
      FUN_00406560();
      FUN_0097fa60();
    }
    goto LAB_0093fbc3;
  }
  piVar5 = (int *)FUN_008eb580();
  if (piVar5 != (int *)0x0) {
    uStack_d8 = (uint)*(ushort *)(iVar6 + 0x46);
    uStack_d4 = (uint)*(ushort *)(iVar6 + 0x44);
    piStack_d0 = (int *)(**(code **)(*piVar5 + 0x74))(uStack_d4,uStack_d8);
    if (piStack_d0 != (int *)0x0) {
      iVar3 = FUN_008eb500();
      if (iVar3 != 0) {
        if (DAT_00d6f0f4 != -1) {
          iVar3 = FUN_008eb260(DAT_00d6f0f4);
          if ((iVar3 != 0) && (*(char *)((int)*(int **)(iVar3 + 0x78) + 0x32) != '\0')) {
            (**(code **)(**(int **)(iVar3 + 0x78) + 0x20))();
          }
        }
        piVar5 = piStack_d0;
        iVar3 = FUN_004049b0(piStack_d0[4]);
        if (iVar3 != 0) {
          cVar1 = (**(code **)(*piVar5 + 0xa0))();
          if (cVar1 == '\0') {
            uStack_cc = *(undefined4 *)(iVar3 + 0x4c);
            if (((*(uint *)(iVar3 + 0x48) & 0x400) != 0) &&
               ((*(uint *)(iVar3 + 0x48) & 0x20000000) == 0)) {
              FUN_00824a20(DAT_0172491c,0);
              uStack_c = 4;
              FUN_008ece00(0);
              FUN_00406460(L"IDS_PREMIUM_LINK_USE_POCKET");
              uStack_c._0_1_ = 5;
              iVar6 = FUN_0081d120(auStack_a8);
              uStack_c._0_1_ = 6;
              if (uStack_20 < 8) {
                appuStack_34[0] = appuStack_34;
              }
              if (*(uint *)(iVar6 + 0x18) < 8) {
                iVar6 = iVar6 + 4;
              }
              else {
                iVar6 = *(int *)(iVar6 + 4);
              }
              FUN_00404750(iVar6,appuStack_34[0]);
              uStack_c._0_1_ = 8;
              FUN_00406560();
              uStack_c = CONCAT31(uStack_c._1_3_,9);
              FUN_00406560();
              iVar6 = FUN_008ede80(auStack_54,2);
              if (iVar6 != 0) {
                FUN_009a67d0(uStack_d4,uStack_d8,0x43,4 - param_1,param_2);
                FUN_0097fa60();
              }
              uStack_c = CONCAT31(uStack_c._1_3_,4);
              FUN_00406560();
              uStack_c = 0xffffffff;
              FUN_00406560();
              goto LAB_0093fbc3;
            }
          }
        }
        FUN_008efa90(*(undefined4 *)(iVar6 + 0x40),uStack_d4,uStack_d8,0x43,4 - param_1,param_2);
      }
    }
  }
LAB_0093fbc3:
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_dc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0093f780 : PUSH EBP
0093f781 : MOV EBP,ESP
0093f783 : AND ESP,0xfffffff8
0093f786 : PUSH -0x1
0093f788 : PUSH 0xb6b588
0093f78d : MOV EAX,FS:[0x0]
0093f793 : PUSH EAX
0093f794 : SUB ESP,0xc8
0093f79a : MOV EAX,[0x00d66fa0]
0093f79f : XOR EAX,ESP
0093f7a1 : MOV dword ptr [ESP + 0xc0],EAX
0093f7a8 : PUSH EBX
0093f7a9 : PUSH ESI
0093f7aa : PUSH EDI
0093f7ab : MOV EAX,[0x00d66fa0]
0093f7b0 : XOR EAX,ESP
0093f7b2 : PUSH EAX
0093f7b3 : LEA EAX,[ESP + 0xd8]
0093f7ba : MOV FS:[0x0],EAX
0093f7c0 : MOV ESI,ECX
0093f7c2 : MOV AL,byte ptr [ESI + 0x8]
0093f7c5 : TEST AL,AL
0093f7c7 : JZ 0x0093fbc3
0093f7cd : MOV EAX,dword ptr [ESI + 0x4]
0093f7d0 : MOV EBX,dword ptr [EAX + 0x128]
0093f7d6 : TEST EBX,EBX
0093f7d8 : JZ 0x0093fbc3
0093f7de : CMP dword ptr [EBP + 0x8],-0x1
0093f7e2 : JNZ 0x0093f7ed
0093f7e4 : PUSH ESI
0093f7e5 : CALL 0x0093e000
0093f7ea : MOV dword ptr [EBP + 0x8],EAX
0093f7ed : MOV EAX,dword ptr [EBP + 0xc]
0093f7f0 : MOV ECX,dword ptr [EBP + 0x8]
0093f7f3 : MOV EDX,dword ptr [ESI]
0093f7f5 : MOV EDX,dword ptr [EDX + 0x74]
0093f7f8 : PUSH EAX
0093f7f9 : PUSH ECX
0093f7fa : MOV ECX,ESI
0093f7fc : CALL EDX
0093f7fe : MOV EDI,EAX
0093f800 : TEST EDI,EDI
0093f802 : JZ 0x0093f889
0093f808 : CMP byte ptr [EDI + 0x3c],0x0
0093f80c : JZ 0x0093f889
0093f80e : PUSH 0xc71698
0093f813 : LEA ECX,[ESP + 0x9c]
0093f81a : CALL 0x00406460
0093f81f : MOV dword ptr [ESP + 0xe0],0x0
0093f82a : MOV EAX,dword ptr [ESI + 0x4]
0093f82d : MOV ESI,dword ptr [EAX + 0x1a8]
0093f833 : LEA ECX,[ESP + 0x98]
0093f83a : PUSH ECX
0093f83b : MOV ECX,dword ptr [0x0172491c]
0093f841 : LEA EDI,[ESP + 0x2c]
0093f845 : CALL 0x0081d120
0093f84a : MOV byte ptr [ESP + 0xe0],0x1
0093f852 : MOV EDX,dword ptr [ESI]
0093f854 : PUSH 0x3
0093f856 : PUSH EAX
0093f857 : MOV EAX,dword ptr [EDX + 0x44]
0093f85a : MOV ECX,ESI
0093f85c : CALL EAX
0093f85e : MOV byte ptr [ESP + 0xe0],0x0
0093f866 : MOV ECX,EDI
0093f868 : CALL 0x00406560
0093f86d : MOV dword ptr [ESP + 0xe0],0xffffffff
0093f878 : LEA ECX,[ESP + 0x98]
0093f87f : CALL 0x00406560
0093f884 : JMP 0x0093fbc3
0093f889 : MOV EDX,dword ptr [ESI]
0093f88b : MOV EAX,dword ptr [EDX + 0x5c]
0093f88e : PUSH EBX
0093f88f : PUSH EDI
0093f890 : MOV ECX,ESI
0093f892 : CALL EAX
0093f894 : TEST AL,AL
0093f896 : JNZ 0x0093fbc3
0093f89c : MOV EAX,dword ptr [EBX + 0x40]
0093f89f : CMP EAX,0x94
0093f8a4 : JA 0x0093f8ea
0093f8a6 : JZ 0x0093f8c3
0093f8a8 : CMP EAX,0x40
0093f8ab : JC 0x0093f8f3
0093f8ad : CMP EAX,0x42
0093f8b0 : JBE 0x0093f8c3
0093f8b2 : CMP EAX,0x43
0093f8b5 : JNZ 0x0093f8f3
0093f8b7 : MOV ECX,EBX
0093f8b9 : CALL 0x0097fa60
0093f8be : JMP 0x0093fbc3
0093f8c3 : MOV ECX,dword ptr [EBP + 0xc]
0093f8c6 : PUSH ECX
0093f8c7 : MOVZX ECX,word ptr [EBX + 0x46]
0093f8cb : MOV EDX,0x4
0093f8d0 : SUB EDX,dword ptr [EBP + 0x8]
0093f8d3 : PUSH EDX
0093f8d4 : MOVZX EDX,word ptr [EBX + 0x44]
0093f8d8 : PUSH 0x43
0093f8da : PUSH ECX
0093f8db : PUSH EDX
0093f8dc : PUSH EAX
0093f8dd : CALL 0x008efa90
0093f8e2 : ADD ESP,0x18
0093f8e5 : JMP 0x0093fbc3
0093f8ea : CMP EAX,-0x1
0093f8ed : JZ 0x0093fb15
0093f8f3 : MOV EDI,EAX
0093f8f5 : MOV EAX,dword ptr [ESI + 0x4]
0093f8f8 : CALL 0x008eb580
0093f8fd : TEST EAX,EAX
0093f8ff : JZ 0x0093fbc3
0093f905 : MOVZX EDX,word ptr [EBX + 0x46]
0093f909 : MOVZX ECX,word ptr [EBX + 0x44]
0093f90d : MOV EDI,dword ptr [EAX]
0093f90f : PUSH EDX
0093f910 : MOV dword ptr [ESP + 0x1c],ECX
0093f914 : PUSH ECX
0093f915 : MOV ECX,EAX
0093f917 : MOV EAX,dword ptr [EDI + 0x74]
0093f91a : MOV dword ptr [ESP + 0x1c],EDX
0093f91e : CALL EAX
0093f920 : MOV dword ptr [ESP + 0x1c],EAX
0093f924 : TEST EAX,EAX
0093f926 : JZ 0x0093fbc3
0093f92c : MOV EAX,dword ptr [EAX + 0xc]
0093f92f : MOV ESI,dword ptr [ESI + 0x4]
0093f932 : MOV EDI,EAX
0093f934 : MOV EAX,ESI
0093f936 : CALL 0x008eb500
0093f93b : TEST EAX,EAX
0093f93d : JZ 0x0093fbc3
0093f943 : MOV EAX,[0x00d6f0f4]
0093f948 : CMP EAX,-0x1
0093f94b : JZ 0x0093f969
0093f94d : PUSH EAX
0093f94e : CALL 0x008eb260
0093f953 : TEST EAX,EAX
0093f955 : JZ 0x0093f969
0093f957 : MOV EAX,dword ptr [EAX + 0x78]
0093f95a : CMP byte ptr [EAX + 0x32],0x0
0093f95e : JZ 0x0093f969
0093f960 : MOV EDX,dword ptr [EAX]
0093f962 : MOV ECX,EAX
0093f964 : MOV EAX,dword ptr [EDX + 0x20]
0093f967 : CALL EAX
0093f969 : MOV EDI,dword ptr [ESP + 0x1c]
0093f96d : MOV EAX,dword ptr [EDI + 0x10]
0093f970 : PUSH EAX
0093f971 : CALL 0x004049b0
0093f976 : MOV ESI,EAX
0093f978 : ADD ESP,0x4
0093f97b : TEST ESI,ESI
0093f97d : JZ 0x0093faeb
0093f983 : MOV EDX,dword ptr [EDI]
0093f985 : MOV EAX,dword ptr [EDX + 0xa0]
0093f98b : MOV ECX,EDI
0093f98d : CALL EAX
0093f98f : TEST AL,AL
0093f991 : JNZ 0x0093faeb
0093f997 : MOV ECX,dword ptr [ESI + 0x48]
0093f99a : MOV EDX,dword ptr [ESI + 0x4c]
0093f99d : MOV EAX,ECX
0093f99f : MOV dword ptr [ESP + 0x20],EDX
0093f9a3 : AND EAX,0x400
0093f9a8 : XOR EDX,EDX
0093f9aa : OR EAX,EDX
0093f9ac : JZ 0x0093faeb
0093f9b2 : AND ECX,0x20000000
0093f9b8 : XOR EAX,EAX
0093f9ba : OR ECX,EAX
0093f9bc : JNZ 0x0093faeb
0093f9c2 : MOV EAX,[0x0172491c]
0093f9c7 : PUSH ECX
0093f9c8 : LEA EDX,[ESI + 0x18]
0093f9cb : PUSH EAX
0093f9cc : LEA ESI,[ESP + 0xbc]
0093f9d3 : CALL 0x00824a20
0093f9d8 : MOV dword ptr [ESP + 0xe0],0x4
0093f9e3 : PUSH 0x0
0093f9e5 : MOV EDI,ESI
0093f9e7 : CALL 0x008ece00
0093f9ec : PUSH 0xc71708
0093f9f1 : LEA ECX,[ESP + 0x48]
0093f9f5 : CALL 0x00406460
0093f9fa : MOV byte ptr [ESP + 0xe0],0x5
0093fa02 : LEA ECX,[ESP + 0x44]
0093fa06 : PUSH ECX
0093fa07 : MOV ECX,dword ptr [0x0172491c]
0093fa0d : LEA EDI,[ESP + 0x80]
0093fa14 : CALL 0x0081d120
0093fa19 : MOV byte ptr [ESP + 0xe0],0x6
0093fa21 : MOV ECX,dword ptr [ESP + 0xb8]
0093fa28 : MOV EDX,0x8
0093fa2d : CMP dword ptr [ESP + 0xcc],EDX
0093fa34 : JNC 0x0093fa3d
0093fa36 : LEA ECX,[ESP + 0xb8]
0093fa3d : CMP dword ptr [EAX + 0x18],EDX
0093fa40 : JC 0x0093fa47
0093fa42 : MOV EAX,dword ptr [EAX + 0x4]
0093fa45 : JMP 0x0093fa4a
0093fa47 : ADD EAX,0x4
0093fa4a : PUSH ECX
0093fa4b : PUSH EAX
0093fa4c : LEA ESI,[ESP + 0xa0]
0093fa53 : CALL 0x00404750
0093fa58 : ADD ESP,0x8
0093fa5b : MOV byte ptr [ESP + 0xe0],0x8
0093fa63 : LEA ECX,[ESP + 0x7c]
0093fa67 : CALL 0x00406560
0093fa6c : MOV byte ptr [ESP + 0xe0],0x9
0093fa74 : LEA ECX,[ESP + 0x44]
0093fa78 : CALL 0x00406560
0093fa7d : MOV EDX,dword ptr [0x00da9894]
0093fa83 : MOV ECX,dword ptr [EDX]
0093fa85 : PUSH 0x2
0093fa87 : MOV EAX,ESI
0093fa89 : PUSH EAX
0093fa8a : CALL 0x008ede80
0093fa8f : TEST EAX,EAX
0093fa91 : JZ 0x0093fabb
0093fa93 : MOV EDX,dword ptr [EBP + 0xc]
0093fa96 : MOV ECX,dword ptr [EBX + 0x40]
0093fa99 : PUSH EDX
0093fa9a : MOV EDX,0x4
0093fa9f : SUB EDX,dword ptr [EBP + 0x8]
0093faa2 : PUSH EDX
0093faa3 : MOV EDX,dword ptr [ESP + 0x1c]
0093faa7 : PUSH 0x43
0093faa9 : PUSH EDX
0093faaa : MOV EDX,dword ptr [ESP + 0x28]
0093faae : PUSH EDX
0093faaf : CALL 0x009a67d0
0093fab4 : MOV ECX,EBX
0093fab6 : CALL 0x0097fa60
0093fabb : MOV byte ptr [ESP + 0xe0],0x4
0093fac3 : LEA ECX,[ESP + 0x98]
0093faca : CALL 0x00406560
0093facf : MOV dword ptr [ESP + 0xe0],0xffffffff
0093fada : LEA ECX,[ESP + 0xb4]
0093fae1 : CALL 0x00406560
0093fae6 : JMP 0x0093fbc3
0093faeb : MOV EAX,dword ptr [EBP + 0xc]
0093faee : MOV EDX,dword ptr [ESP + 0x14]
0093faf2 : PUSH EAX
0093faf3 : MOV EAX,dword ptr [ESP + 0x1c]
0093faf7 : MOV ECX,0x4
0093fafc : SUB ECX,dword ptr [EBP + 0x8]
0093faff : PUSH ECX
0093fb00 : MOV ECX,dword ptr [EBX + 0x40]
0093fb03 : PUSH 0x43
0093fb05 : PUSH EDX
0093fb06 : PUSH EAX
0093fb07 : PUSH ECX
0093fb08 : CALL 0x008efa90
0093fb0d : ADD ESP,0x18
0093fb10 : JMP 0x0093fbc3
0093fb15 : TEST EDI,EDI
0093fb17 : JZ 0x0093fbb9
0093fb1d : MOV EDX,dword ptr [ESI + 0x4]
0093fb20 : MOV EAX,dword ptr [EDX + 0x178]
0093fb26 : CMP byte ptr [EAX + 0x32],0x0
0093fb2a : JZ 0x0093fba2
0093fb2c : PUSH 0xc716d4
0093fb31 : LEA ECX,[ESP + 0x2c]
0093fb35 : CALL 0x00406460
0093fb3a : MOV dword ptr [ESP + 0xe0],0x2
0093fb45 : MOV EAX,dword ptr [ESI + 0x4]
0093fb48 : MOV ESI,dword ptr [EAX + 0x1a8]
0093fb4e : LEA ECX,[ESP + 0x28]
0093fb52 : PUSH ECX
0093fb53 : MOV ECX,dword ptr [0x0172491c]
0093fb59 : LEA EDI,[ESP + 0x64]
0093fb5d : CALL 0x0081d120
0093fb62 : MOV byte ptr [ESP + 0xe0],0x3
0093fb6a : MOV EDX,dword ptr [ESI]
0093fb6c : PUSH 0x3
0093fb6e : PUSH EAX
0093fb6f : MOV EAX,dword ptr [EDX + 0x44]
0093fb72 : MOV ECX,ESI
0093fb74 : CALL EAX
0093fb76 : MOV byte ptr [ESP + 0xe0],0x2
0093fb7e : MOV ECX,EDI
0093fb80 : CALL 0x00406560
0093fb85 : MOV dword ptr [ESP + 0xe0],0xffffffff
0093fb90 : LEA ECX,[ESP + 0x28]
0093fb94 : CALL 0x00406560
0093fb99 : MOV ECX,EBX
0093fb9b : CALL 0x0097fa60
0093fba0 : JMP 0x0093fbc3
0093fba2 : MOV ECX,dword ptr [EBP + 0xc]
0093fba5 : MOV EDX,dword ptr [EBP + 0x8]
0093fba8 : PUSH ECX
0093fba9 : PUSH EDX
0093fbaa : PUSH EDI
0093fbab : MOV EAX,0x43
0093fbb0 : MOV ECX,EBX
0093fbb2 : CALL 0x0097fb30
0093fbb7 : JMP 0x0093fbc3
0093fbb9 : MOV EAX,dword ptr [EBP + 0x8]
0093fbbc : PUSH EAX
0093fbbd : PUSH ESI
0093fbbe : CALL 0x0093f4c0
0093fbc3 : MOV ECX,dword ptr [ESP + 0xd8]
0093fbca : MOV dword ptr FS:[0x0],ECX
0093fbd1 : POP ECX
0093fbd2 : POP EDI
0093fbd3 : POP ESI
0093fbd4 : POP EBX
0093fbd5 : MOV ECX,dword ptr [ESP + 0xc0]
0093fbdc : XOR ECX,ESP
0093fbde : CALL 0x00633e6b
0093fbe3 : MOV ESP,EBP
0093fbe5 : POP EBP
0093fbe6 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_009695b0
ENTRY    : 009695b0
BODY     : [[009695b0, 00969763]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009695b0(void)

{
  uint uVar1;
  undefined4 uVar2;
  int *piVar3;
  int iVar4;
  int iVar5;
  undefined4 uVar6;
  undefined1 local_34 [28];
  int local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b53f3e;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (((DAT_0172491c != 0) && (*DAT_00da9894 != 0)) && (*(int *)(*DAT_00da9894 + 0x1a8) != 0)) {
    FUN_00406460(L"IDS_NOT_DROP_BY_ITEM");
    local_8 = 0;
    piVar3 = *(int **)(*DAT_00da9894 + 0x1a8);
    uVar2 = FUN_0081d120(local_34);
    local_8._0_1_ = 1;
    (**(code **)(*piVar3 + 0x44))(uVar2,3);
    local_8 = (uint)local_8._1_3_ << 8;
    FUN_00406560();
    local_8 = 0xffffffff;
    FUN_00406560();
  }
  iVar5 = *DAT_00da9894;
  if ((((*(int *)(iVar5 + 0x184) != 0) &&
       (piVar3 = *(int **)(iVar5 + 0x184), *(char *)((int)piVar3 + 0x32) != '\0')) ||
      ((*(int *)(iVar5 + 0x1e8) != 0 &&
       (piVar3 = *(int **)(iVar5 + 0x1e8), *(char *)((int)piVar3 + 0x32) != '\0')))) ||
     ((*(int *)(iVar5 + 0x1e4) != 0 &&
      (piVar3 = *(int **)(iVar5 + 0x1e4), *(char *)((int)piVar3 + 0x32) != '\0')))) {
    piVar3 = (int *)(**(code **)(*piVar3 + 0x74))(0,0,uVar1);
    if (piVar3 != (int *)0x0) {
      iVar4 = (**(code **)(*piVar3 + 0x20))();
      iVar5 = DAT_00d7c54c;
      if ((iVar4 == 4) || (5 < *(ushort *)(piVar3 + 0x2b))) {
        local_14 = piVar3[4];
        FUN_004437f0(&local_14);
        if ((local_18 != *(int *)(iVar5 + 0x44)) && (*(int **)(local_18 + 0x10) != (int *)0x0)) {
          iVar5 = (**(code **)(**(int **)(local_18 + 0x10) + 0x3c))();
          if (iVar5 != 0) {
            uVar2 = FUN_00a08b70();
            uVar6 = FUN_00824a20(DAT_0172491c,0);
            local_8 = 2;
            FUN_00968ef0(uVar6,(short)piVar3[0x2b],uVar2,3);
            local_8 = 0xffffffff;
            FUN_00406560();
          }
        }
      }
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
009695b0 : PUSH EBP
009695b1 : MOV EBP,ESP
009695b3 : PUSH -0x1
009695b5 : PUSH 0xb53f3e
009695ba : MOV EAX,FS:[0x0]
009695c0 : PUSH EAX
009695c1 : SUB ESP,0x44
009695c4 : PUSH EBX
009695c5 : PUSH ESI
009695c6 : PUSH EDI
009695c7 : MOV EAX,[0x00d66fa0]
009695cc : XOR EAX,EBP
009695ce : PUSH EAX
009695cf : LEA EAX,[EBP + -0xc]
009695d2 : MOV FS:[0x0],EAX
009695d8 : CMP dword ptr [0x0172491c],0x0
009695df : JZ 0x00969653
009695e1 : MOV EAX,[0x00da9894]
009695e6 : MOV EAX,dword ptr [EAX]
009695e8 : TEST EAX,EAX
009695ea : JZ 0x00969653
009695ec : CMP dword ptr [EAX + 0x1a8],0x0
009695f3 : JZ 0x00969653
009695f5 : PUSH 0xc7b678
009695fa : LEA ECX,[EBP + -0x30]
009695fd : CALL 0x00406460
00969602 : MOV dword ptr [EBP + -0x4],0x0
00969609 : MOV ECX,dword ptr [0x00da9894]
0096960f : MOV EAX,dword ptr [ECX]
00969611 : MOV ECX,dword ptr [0x0172491c]
00969617 : MOV ESI,dword ptr [EAX + 0x1a8]
0096961d : LEA EDX,[EBP + -0x30]
00969620 : PUSH EDX
00969621 : LEA EDI,[EBP + -0x4c]
00969624 : CALL 0x0081d120
00969629 : MOV byte ptr [EBP + -0x4],0x1
0096962d : MOV EDX,dword ptr [ESI]
0096962f : PUSH 0x3
00969631 : PUSH EAX
00969632 : MOV EAX,dword ptr [EDX + 0x44]
00969635 : MOV ECX,ESI
00969637 : CALL EAX
00969639 : MOV byte ptr [EBP + -0x4],0x0
0096963d : MOV ECX,EDI
0096963f : CALL 0x00406560
00969644 : MOV dword ptr [EBP + -0x4],0xffffffff
0096964b : LEA ECX,[EBP + -0x30]
0096964e : CALL 0x00406560
00969653 : MOV ECX,dword ptr [0x00da9894]
00969659 : MOV EAX,dword ptr [ECX]
0096965b : CMP dword ptr [EAX + 0x184],0x0
00969662 : JZ 0x00969670
00969664 : MOV ECX,dword ptr [EAX + 0x184]
0096966a : CMP byte ptr [ECX + 0x32],0x0
0096966e : JNZ 0x009696a2
00969670 : CMP dword ptr [EAX + 0x1e8],0x0
00969677 : JZ 0x00969685
00969679 : MOV ECX,dword ptr [EAX + 0x1e8]
0096967f : CMP byte ptr [ECX + 0x32],0x0
00969683 : JNZ 0x009696a2
00969685 : CMP dword ptr [EAX + 0x1e4],0x0
0096968c : JZ 0x00969752
00969692 : MOV ECX,dword ptr [EAX + 0x1e4]
00969698 : CMP byte ptr [ECX + 0x32],0x0
0096969c : JZ 0x00969752
009696a2 : MOV EAX,ECX
009696a4 : MOV EDX,dword ptr [EAX]
009696a6 : MOV EAX,dword ptr [EDX + 0x74]
009696a9 : PUSH 0x0
009696ab : PUSH 0x0
009696ad : CALL EAX
009696af : MOV EDI,EAX
009696b1 : TEST EDI,EDI
009696b3 : JZ 0x00969752
009696b9 : MOV EDX,dword ptr [EDI]
009696bb : MOV EAX,dword ptr [EDX + 0x20]
009696be : MOV ECX,EDI
009696c0 : CALL EAX
009696c2 : CMP EAX,0x4
009696c5 : JZ 0x009696d4
009696c7 : MOVZX EAX,word ptr [EDI + 0xac]
009696ce : CMP AX,0x6
009696d2 : JC 0x00969752
009696d4 : MOV ECX,dword ptr [EDI + 0x10]
009696d7 : MOV ESI,dword ptr [0x00d7c54c]
009696dd : LEA EDX,[EBP + -0x10]
009696e0 : MOV dword ptr [EBP + -0x10],ECX
009696e3 : PUSH EDX
009696e4 : LEA ECX,[ESI + 0x40]
009696e7 : LEA EAX,[EBP + -0x14]
009696ea : CALL 0x004437f0
009696ef : MOV ESI,dword ptr [ESI + 0x44]
009696f2 : MOV EAX,dword ptr [EBP + -0x14]
009696f5 : CMP EAX,ESI
009696f7 : JZ 0x00969752
009696f9 : MOV ESI,dword ptr [EAX + 0x10]
009696fc : TEST ESI,ESI
009696fe : JZ 0x00969752
00969700 : MOV EAX,dword ptr [ESI]
00969702 : MOV EDX,dword ptr [EAX + 0x3c]
00969705 : MOV ECX,ESI
00969707 : CALL EDX
00969709 : TEST EAX,EAX
0096970b : JZ 0x00969752
0096970d : MOV ECX,EDI
0096970f : CALL 0x00a08b70
00969714 : MOV EBX,EAX
00969716 : MOV EAX,[0x0172491c]
0096971b : PUSH 0x0
0096971d : LEA EDX,[ESI + 0x18]
00969720 : PUSH EAX
00969721 : LEA ESI,[EBP + -0x4c]
00969724 : CALL 0x00824a20
00969729 : MOV dword ptr [EBP + -0x4],0x2
00969730 : MOVZX ECX,word ptr [EDI + 0xac]
00969737 : PUSH 0x3
00969739 : MOVZX ECX,CX
0096973c : PUSH EBX
0096973d : PUSH ECX
0096973e : PUSH EAX
0096973f : CALL 0x00968ef0
00969744 : MOV dword ptr [EBP + -0x4],0xffffffff
0096974b : MOV ECX,ESI
0096974d : CALL 0x00406560
00969752 : MOV ECX,dword ptr [EBP + -0xc]
00969755 : MOV dword ptr FS:[0x0],ECX
0096975c : POP ECX
0096975d : POP EDI
0096975e : POP ESI
0096975f : POP EBX
00969760 : MOV ESP,EBP
00969762 : POP EBP
00969763 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_007c4690
ENTRY    : 007c4690
BODY     : [[007c4690, 007c48a3]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007c4690(int param_1)

{
  undefined4 uVar1;
  int iVar2;
  int iVar3;
  LONG LVar4;
  int in_ECX;
  int unaff_EDI;
  int local_3c [2];
  int local_34;
  int local_30;
  LPCRITICAL_SECTION local_2c;
  char *local_28;
  undefined4 local_24;
  int local_20;
  undefined4 local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b4d636;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  if (*(int *)(unaff_EDI + 0xd0) != 0) {
    local_34 = FUN_006f0760(0x268,"",0,(DAT_01725270 >> 3 & 1) == 0,
                            DAT_00d66fa0 ^ (uint)&stack0xffffffb8);
    local_c = 0;
    if (local_34 == 0) {
      local_3c[0] = 0;
    }
    else {
      local_3c[0] = FUN_0075b730(local_34);
    }
    local_c = 0xffffffff;
    local_2c = (LPCRITICAL_SECTION)(unaff_EDI + 0xf8);
    local_20 = 0;
    local_28 = ".\\Frk\\FrkMgr.cpp";
    local_24 = 0xe5;
    local_1c = 1;
    FUN_006ef1a0(&local_2c);
    local_c = 1;
    uVar1 = *(undefined4 *)(unaff_EDI + 0xd0);
    if (*(uint *)(param_1 + 0x18) < 8) {
      param_1 = param_1 + 4;
    }
    else {
      param_1 = *(int *)(param_1 + 4);
    }
    FUN_0070cf00(param_1);
    iVar2 = local_3c[0];
    iVar3 = FUN_0075bec0(local_3c[0],uVar1);
    if (iVar3 == -1) {
      if (iVar2 != 0) {
        FUN_0075b440(iVar2);
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      *(undefined4 *)(in_ECX + 0x17c) = 0;
      FUN_007958c0();
      local_c = 0xffffffff;
      if (local_20 != 0) {
        LeaveCriticalSection(local_2c);
        ExceptionList = local_14;
        return;
      }
    }
    else {
      local_c = 0xffffffff;
      if (local_20 != 0) {
        LeaveCriticalSection(local_2c);
        local_20 = 0;
      }
      LVar4 = InterlockedIncrement((LONG *)(unaff_EDI + 0xd8));
      *(LONG *)(in_ECX + 0x188) = LVar4;
      FUN_007958c0();
      local_2c = (LPCRITICAL_SECTION)(unaff_EDI + 0x114);
      local_20 = 0;
      local_28 = ".\\Frk\\FrkMgr.cpp";
      local_24 = 0xf4;
      local_1c = 1;
      FUN_006ef1a0(&local_2c);
      local_c = 2;
      local_30 = local_3c[0];
      local_34 = LVar4;
      FUN_00451e00(local_3c,&local_34);
      local_c = 0xffffffff;
      if (local_20 != 0) {
        LeaveCriticalSection(local_2c);
      }
    }
  }
  ExceptionList = local_14;
  return;
}



============================================================
DISASSEMBLY
============================================================
007c4690 : PUSH EBP
007c4691 : MOV EBP,ESP
007c4693 : AND ESP,0xfffffff8
007c4696 : PUSH -0x1
007c4698 : PUSH 0xb4d636
007c469d : MOV EAX,FS:[0x0]
007c46a3 : PUSH EAX
007c46a4 : SUB ESP,0x2c
007c46a7 : PUSH EBX
007c46a8 : PUSH ESI
007c46a9 : MOV EAX,[0x00d66fa0]
007c46ae : XOR EAX,ESP
007c46b0 : PUSH EAX
007c46b1 : LEA EAX,[ESP + 0x38]
007c46b5 : MOV FS:[0x0],EAX
007c46bb : MOV ESI,ECX
007c46bd : CMP dword ptr [EDI + 0xd0],0x0
007c46c4 : JZ 0x007c4890
007c46ca : MOV EAX,[0x01725270]
007c46cf : SHR EAX,0x3
007c46d2 : MOV EBX,0x1
007c46d7 : MOV ECX,0x0
007c46dc : AND EAX,EBX
007c46de : SETZ CL
007c46e1 : PUSH ECX
007c46e2 : PUSH 0x0
007c46e4 : PUSH 0xbf1a4a
007c46e9 : PUSH 0x268
007c46ee : CALL 0x006f0760
007c46f3 : ADD ESP,0x10
007c46f6 : MOV dword ptr [ESP + 0x18],EAX
007c46fa : XOR ECX,ECX
007c46fc : MOV dword ptr [ESP + 0x40],ECX
007c4700 : CMP EAX,ECX
007c4702 : JZ 0x007c4714
007c4704 : PUSH EAX
007c4705 : MOV ECX,ESI
007c4707 : CALL 0x0075b730
007c470c : MOV dword ptr [ESP + 0x10],EAX
007c4710 : XOR ECX,ECX
007c4712 : JMP 0x007c4718
007c4714 : MOV dword ptr [ESP + 0x10],ECX
007c4718 : MOV dword ptr [ESP + 0x40],0xffffffff
007c4720 : LEA EAX,[ESP + 0x20]
007c4724 : LEA EDX,[EDI + 0xf8]
007c472a : PUSH EAX
007c472b : MOV dword ptr [ESP + 0x30],ECX
007c472f : MOV dword ptr [ESP + 0x24],EDX
007c4733 : MOV dword ptr [ESP + 0x28],0xc1c51c
007c473b : MOV dword ptr [ESP + 0x2c],0xe5
007c4743 : MOV dword ptr [ESP + 0x34],EBX
007c4747 : CALL 0x006ef1a0
007c474c : MOV dword ptr [ESP + 0x40],EBX
007c4750 : MOV EAX,dword ptr [EBP + 0x8]
007c4753 : CMP dword ptr [EAX + 0x18],0x8
007c4757 : MOV EBX,dword ptr [EDI + 0xd0]
007c475d : JC 0x007c4764
007c475f : MOV EAX,dword ptr [EAX + 0x4]
007c4762 : JMP 0x007c4767
007c4764 : ADD EAX,0x4
007c4767 : PUSH EAX
007c4768 : CALL 0x0070cf00
007c476d : ADD ESP,0x4
007c4770 : PUSH EBX
007c4771 : MOV EBX,dword ptr [ESP + 0x14]
007c4775 : PUSH EBX
007c4776 : MOV ECX,EAX
007c4778 : CALL 0x0075bec0
007c477d : CMP EAX,-0x1
007c4780 : JNZ 0x007c47dc
007c4782 : TEST EBX,EBX
007c4784 : JZ 0x007c4793
007c4786 : PUSH EBX
007c4787 : CALL 0x0075b440
007c478c : MOV ECX,EBX
007c478e : CALL 0x006f04e0
007c4793 : MOV dword ptr [ESI + 0x17c],0x0
007c479d : CALL 0x007958c0
007c47a2 : MOV dword ptr [ESP + 0x40],0xffffffff
007c47aa : CMP dword ptr [ESP + 0x2c],0x0
007c47af : JZ 0x007c4890
007c47b5 : MOV ECX,dword ptr [ESP + 0x20]
007c47b9 : PUSH ECX
007c47ba : CALL dword ptr [0x00b8511c]
007c47c0 : MOV dword ptr [ESP + 0x2c],0x0
007c47c8 : MOV ECX,dword ptr [ESP + 0x38]
007c47cc : MOV dword ptr FS:[0x0],ECX
007c47d3 : POP ECX
007c47d4 : POP ESI
007c47d5 : POP EBX
007c47d6 : MOV ESP,EBP
007c47d8 : POP EBP
007c47d9 : RET 0x4
007c47dc : MOV dword ptr [ESP + 0x40],0xffffffff
007c47e4 : CMP dword ptr [ESP + 0x2c],0x0
007c47e9 : JZ 0x007c47fe
007c47eb : MOV EDX,dword ptr [ESP + 0x20]
007c47ef : PUSH EDX
007c47f0 : CALL dword ptr [0x00b8511c]
007c47f6 : MOV dword ptr [ESP + 0x2c],0x0
007c47fe : LEA EAX,[EDI + 0xd8]
007c4804 : PUSH EAX
007c4805 : CALL dword ptr [0x00b850dc]
007c480b : MOV EBX,EAX
007c480d : MOV dword ptr [ESI + 0x188],EBX
007c4813 : CALL 0x007958c0
007c4818 : LEA EDX,[ESP + 0x20]
007c481c : LEA ECX,[EDI + 0x114]
007c4822 : XOR ESI,ESI
007c4824 : PUSH EDX
007c4825 : MOV dword ptr [ESP + 0x30],ESI
007c4829 : MOV dword ptr [ESP + 0x24],ECX
007c482d : MOV dword ptr [ESP + 0x28],0xc1c530
007c4835 : MOV dword ptr [ESP + 0x2c],0xf4
007c483d : MOV dword ptr [ESP + 0x34],0x1
007c4845 : CALL 0x006ef1a0
007c484a : MOV dword ptr [ESP + 0x40],0x2
007c4852 : MOV EAX,dword ptr [ESP + 0x10]
007c4856 : LEA ECX,[ESP + 0x18]
007c485a : PUSH ECX
007c485b : LEA EDX,[ESP + 0x14]
007c485f : MOV dword ptr [ESP + 0x20],EAX
007c4863 : PUSH EDX
007c4864 : LEA EAX,[EDI + 0xdc]
007c486a : MOV dword ptr [ESP + 0x20],EBX
007c486e : CALL 0x00451e00
007c4873 : MOV dword ptr [ESP + 0x40],0xffffffff
007c487b : CMP dword ptr [ESP + 0x2c],ESI
007c487f : JZ 0x007c4890
007c4881 : MOV EAX,dword ptr [ESP + 0x20]
007c4885 : PUSH EAX
007c4886 : CALL dword ptr [0x00b8511c]
007c488c : MOV dword ptr [ESP + 0x2c],ESI
007c4890 : MOV ECX,dword ptr [ESP + 0x38]
007c4894 : MOV dword ptr FS:[0x0],ECX
007c489b : POP ECX
007c489c : POP ESI
007c489d : POP EBX
007c489e : MOV ESP,EBP
007c48a0 : POP EBP
007c48a1 : RET 0x4

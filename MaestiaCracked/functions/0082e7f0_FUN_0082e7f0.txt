PROGRAM  : Maestia.exe
FUNCTION : FUN_0082e7f0
ENTRY    : 0082e7f0
BODY     : [[0082e7f0, 0082e9d3]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0082e7f0(undefined4 param_1,undefined2 param_2)

{
  undefined2 uVar1;
  uint uVar2;
  undefined4 uVar3;
  int iVar4;
  int *piVar5;
  int in_ECX;
  undefined1 local_7c [4];
  undefined4 local_78;
  undefined4 local_74;
  undefined4 local_70;
  undefined1 local_68 [4];
  undefined2 local_64;
  undefined4 local_54;
  uint local_50;
  undefined2 local_48;
  undefined4 local_38;
  uint local_34;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b325ef;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_14 = uVar2;
  if (*(HANDLE *)(in_ECX + 0x70) != (HANDLE)0x0) {
    SetEvent(*(HANDLE *)(in_ECX + 0x70));
  }
  if (*(int *)(in_ECX + 0x130) == 0) {
    FUN_00406460(L"RandomBoxResult");
    local_8 = 0;
    FUN_00406460(&DAT_00c36224);
    local_34 = 7;
    local_38 = 0;
    local_48 = 0;
    local_8._1_3_ = (uint3)((uint)local_8 >> 8);
    local_78 = 0;
    local_74 = 0;
    local_70 = 0;
    local_8._0_1_ = 3;
    FUN_0082d720(local_30,local_68,local_7c);
    local_78 = 0;
    local_74 = 0;
    local_70 = 0;
    local_8 = CONCAT31(local_8._1_3_,1);
    if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_34 = 7;
    local_38 = 0;
    local_48 = 0;
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_50) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_50 = 7;
    local_54 = 0;
    local_64 = 0;
    local_8 = 0xffffffff;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c = 0;
  }
  uVar3 = FUN_00404750(&DAT_00c363a0,param_1,uVar2);
  local_8 = 4;
  FUN_00405eb0(uVar3,0,0xffffffff);
  local_8 = 0xffffffff;
  if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_18 = 7;
  local_1c = 0;
  local_2c = 0;
  iVar4 = FUN_00703c00(0x600);
  piVar5 = (int *)FUN_009f2a00(param_1);
  if (iVar4 == 0) {
    FUN_0082d550("%x,FAIL\n",param_1);
  }
  else {
    if (piVar5 == (int *)0x0) {
      uVar1 = 1;
    }
    else {
      uVar1 = (**(code **)(*piVar5 + 0x40))();
    }
    FUN_0082d550("%x,%s,%d,%d\n",param_1,iVar4 + 0x18,param_2,uVar1);
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0082e7f0 : PUSH EBP
0082e7f1 : MOV EBP,ESP
0082e7f3 : PUSH -0x1
0082e7f5 : PUSH 0xb325ef
0082e7fa : MOV EAX,FS:[0x0]
0082e800 : PUSH EAX
0082e801 : SUB ESP,0x6c
0082e804 : MOV EAX,[0x00d66fa0]
0082e809 : XOR EAX,EBP
0082e80b : MOV dword ptr [EBP + -0x10],EAX
0082e80e : PUSH EBX
0082e80f : PUSH ESI
0082e810 : PUSH EDI
0082e811 : PUSH EAX
0082e812 : LEA EAX,[EBP + -0xc]
0082e815 : MOV FS:[0x0],EAX
0082e81b : MOV EDI,ECX
0082e81d : MOV EAX,dword ptr [EDI + 0x70]
0082e820 : XOR EBX,EBX
0082e822 : MOV dword ptr [EBP + -0x68],EDI
0082e825 : CMP EAX,EBX
0082e827 : JZ 0x0082e830
0082e829 : PUSH EAX
0082e82a : CALL dword ptr [0x00b851e8]
0082e830 : MOV EAX,dword ptr [EDI + 0x130]
0082e836 : CMP EAX,EBX
0082e838 : JNZ 0x0082e8fd
0082e83e : PUSH 0xc36380
0082e843 : LEA ECX,[EBP + -0x2c]
0082e846 : CALL 0x00406460
0082e84b : MOV dword ptr [EBP + -0x4],EBX
0082e84e : PUSH 0xc36224
0082e853 : LEA ECX,[EBP + -0x64]
0082e856 : CALL 0x00406460
0082e85b : MOV byte ptr [EBP + -0x4],0x1
0082e85f : MOV ESI,0x7
0082e864 : XOR EAX,EAX
0082e866 : MOV dword ptr [EBP + -0x30],ESI
0082e869 : MOV dword ptr [EBP + -0x34],EBX
0082e86c : MOV word ptr [EBP + -0x44],AX
0082e870 : MOV byte ptr [EBP + -0x4],0x2
0082e874 : MOV dword ptr [EBP + -0x74],EBX
0082e877 : MOV dword ptr [EBP + -0x70],EBX
0082e87a : MOV dword ptr [EBP + -0x6c],EBX
0082e87d : MOV byte ptr [EBP + -0x4],0x3
0082e881 : LEA ECX,[EBP + -0x78]
0082e884 : PUSH ECX
0082e885 : LEA EDX,[EBP + -0x64]
0082e888 : PUSH EDX
0082e889 : LEA EAX,[EBP + -0x2c]
0082e88c : PUSH EAX
0082e88d : MOV EAX,EDI
0082e88f : CALL 0x0082d720
0082e894 : MOV byte ptr [EBP + -0x4],0x2
0082e898 : MOV dword ptr [EBP + -0x74],EBX
0082e89b : MOV dword ptr [EBP + -0x70],EBX
0082e89e : MOV dword ptr [EBP + -0x6c],EBX
0082e8a1 : MOV byte ptr [EBP + -0x4],0x1
0082e8a5 : CMP dword ptr [EBP + -0x30],0x8
0082e8a9 : JC 0x0082e8b3
0082e8ab : MOV ECX,dword ptr [EBP + -0x44]
0082e8ae : CALL 0x006f04e0
0082e8b3 : XOR ECX,ECX
0082e8b5 : MOV dword ptr [EBP + -0x30],ESI
0082e8b8 : MOV dword ptr [EBP + -0x34],EBX
0082e8bb : MOV word ptr [EBP + -0x44],CX
0082e8bf : MOV byte ptr [EBP + -0x4],BL
0082e8c2 : CMP dword ptr [EBP + -0x4c],0x8
0082e8c6 : JC 0x0082e8d0
0082e8c8 : MOV ECX,dword ptr [EBP + -0x60]
0082e8cb : CALL 0x006f04e0
0082e8d0 : XOR EDX,EDX
0082e8d2 : MOV dword ptr [EBP + -0x4c],ESI
0082e8d5 : MOV dword ptr [EBP + -0x50],EBX
0082e8d8 : MOV word ptr [EBP + -0x60],DX
0082e8dc : MOV dword ptr [EBP + -0x4],0xffffffff
0082e8e3 : CMP dword ptr [EBP + -0x14],0x8
0082e8e7 : JC 0x0082e8f1
0082e8e9 : MOV ECX,dword ptr [EBP + -0x28]
0082e8ec : CALL 0x006f04e0
0082e8f1 : XOR EAX,EAX
0082e8f3 : MOV dword ptr [EBP + -0x14],ESI
0082e8f6 : MOV dword ptr [EBP + -0x18],EBX
0082e8f9 : MOV word ptr [EBP + -0x28],AX
0082e8fd : MOV ECX,dword ptr [EBP + 0x8]
0082e900 : PUSH ECX
0082e901 : PUSH 0xc363a0
0082e906 : LEA ESI,[EBP + -0x2c]
0082e909 : CALL 0x00404750
0082e90e : ADD ESP,0x8
0082e911 : MOV dword ptr [EBP + -0x4],0x4
0082e918 : PUSH -0x1
0082e91a : PUSH EBX
0082e91b : PUSH EAX
0082e91c : LEA ECX,[EDI + 0xa4]
0082e922 : CALL 0x00405eb0
0082e927 : MOV dword ptr [EBP + -0x4],0xffffffff
0082e92e : CMP dword ptr [EBP + -0x14],0x8
0082e932 : JC 0x0082e93c
0082e934 : MOV ECX,dword ptr [EBP + -0x28]
0082e937 : CALL 0x006f04e0
0082e93c : MOV EDI,dword ptr [EBP + 0xc]
0082e93f : XOR EDX,EDX
0082e941 : PUSH 0x600
0082e946 : MOV dword ptr [EBP + -0x14],0x7
0082e94d : MOV dword ptr [EBP + -0x18],EBX
0082e950 : MOV word ptr [EBP + -0x28],DX
0082e954 : CALL 0x00703c00
0082e959 : MOV EDI,dword ptr [EBP + 0x8]
0082e95c : MOV ECX,dword ptr [0x017247f0]
0082e962 : ADD ESP,0x4
0082e965 : PUSH EDI
0082e966 : MOV ESI,EAX
0082e968 : CALL 0x009f2a00
0082e96d : CMP ESI,EBX
0082e96f : JZ 0x0082e9a5
0082e971 : CMP EAX,EBX
0082e973 : JZ 0x0082e983
0082e975 : MOV EDX,dword ptr [EAX]
0082e977 : MOV ECX,EAX
0082e979 : MOV EAX,dword ptr [EDX + 0x40]
0082e97c : CALL EAX
0082e97e : MOVZX EAX,AX
0082e981 : JMP 0x0082e988
0082e983 : MOV EAX,0x1
0082e988 : MOVZX ECX,word ptr [EBP + 0xc]
0082e98c : PUSH EAX
0082e98d : PUSH ECX
0082e98e : ADD ESI,0x18
0082e991 : PUSH ESI
0082e992 : MOV ESI,dword ptr [EBP + -0x68]
0082e995 : PUSH EDI
0082e996 : PUSH 0xc363a8
0082e99b : CALL 0x0082d550
0082e9a0 : ADD ESP,0x14
0082e9a3 : JMP 0x0082e9b6
0082e9a5 : MOV ESI,dword ptr [EBP + -0x68]
0082e9a8 : PUSH EDI
0082e9a9 : PUSH 0xc363b8
0082e9ae : CALL 0x0082d550
0082e9b3 : ADD ESP,0x8
0082e9b6 : MOV ECX,dword ptr [EBP + -0xc]
0082e9b9 : MOV dword ptr FS:[0x0],ECX
0082e9c0 : POP ECX
0082e9c1 : POP EDI
0082e9c2 : POP ESI
0082e9c3 : POP EBX
0082e9c4 : MOV ECX,dword ptr [EBP + -0x10]
0082e9c7 : XOR ECX,EBP
0082e9c9 : CALL 0x00633e6b
0082e9ce : MOV ESP,EBP
0082e9d0 : POP EBP
0082e9d1 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : __getenv_helper_nolock
ENTRY    : 0065d18e
BODY     : [[0065d18e, 0065d214]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    __getenv_helper_nolock
   
   Library: Visual Studio 2008 Release */

char * __cdecl __getenv_helper_nolock(char *param_1)

{
  int iVar1;
  size_t _MaxCount;
  size_t sVar2;
  int *piVar3;
  
  if (((DAT_01729d68 != 0) &&
      ((DAT_00d7b7a0 != (int *)0x0 ||
       (((DAT_00d7b7a8 != 0 && (iVar1 = ___wtomb_environ(), iVar1 == 0)) &&
        (DAT_00d7b7a0 != (int *)0x0)))))) && (piVar3 = DAT_00d7b7a0, param_1 != (char *)0x0)) {
    _MaxCount = _strlen(param_1);
    for (; (char *)*piVar3 != (char *)0x0; piVar3 = piVar3 + 1) {
      sVar2 = _strlen((char *)*piVar3);
      if (((_MaxCount < sVar2) && (((uchar *)*piVar3)[_MaxCount] == '=')) &&
         (iVar1 = __mbsnbicoll((uchar *)*piVar3,(uchar *)param_1,_MaxCount), iVar1 == 0)) {
        return (char *)(*piVar3 + 1 + _MaxCount);
      }
    }
  }
  return (char *)0x0;
}



============================================================
DISASSEMBLY
============================================================
0065d18e : MOV EDI,EDI
0065d190 : PUSH EBP
0065d191 : MOV EBP,ESP
0065d193 : CMP dword ptr [0x01729d68],0x0
0065d19a : PUSH ESI
0065d19b : MOV ESI,dword ptr [0x00d7b7a0]
0065d1a1 : JNZ 0x0065d1a7
0065d1a3 : XOR EAX,EAX
0065d1a5 : JMP 0x0065d20a
0065d1a7 : PUSH EDI
0065d1a8 : TEST ESI,ESI
0065d1aa : JNZ 0x0065d1c7
0065d1ac : CMP dword ptr [0x00d7b7a8],ESI
0065d1b2 : JZ 0x0065d207
0065d1b4 : CALL 0x00660222
0065d1b9 : TEST EAX,EAX
0065d1bb : JNZ 0x0065d207
0065d1bd : MOV ESI,dword ptr [0x00d7b7a0]
0065d1c3 : TEST ESI,ESI
0065d1c5 : JZ 0x0065d207
0065d1c7 : CMP dword ptr [EBP + 0x8],0x0
0065d1cb : JZ 0x0065d207
0065d1cd : PUSH dword ptr [EBP + 0x8]
0065d1d0 : CALL 0x00640960
0065d1d5 : POP ECX
0065d1d6 : MOV EDI,EAX
0065d1d8 : JMP 0x0065d201
0065d1da : PUSH EAX
0065d1db : CALL 0x00640960
0065d1e0 : POP ECX
0065d1e1 : CMP EAX,EDI
0065d1e3 : JBE 0x0065d1fe
0065d1e5 : MOV EAX,dword ptr [ESI]
0065d1e7 : CMP byte ptr [EAX + EDI*0x1],0x3d
0065d1eb : JNZ 0x0065d1fe
0065d1ed : PUSH EDI
0065d1ee : PUSH dword ptr [EBP + 0x8]
0065d1f1 : PUSH EAX
0065d1f2 : CALL 0x00660208
0065d1f7 : ADD ESP,0xc
0065d1fa : TEST EAX,EAX
0065d1fc : JZ 0x0065d20d
0065d1fe : ADD ESI,0x4
0065d201 : MOV EAX,dword ptr [ESI]
0065d203 : TEST EAX,EAX
0065d205 : JNZ 0x0065d1da
0065d207 : XOR EAX,EAX
0065d209 : POP EDI
0065d20a : POP ESI
0065d20b : POP EBP
0065d20c : RET
0065d20d : MOV EAX,dword ptr [ESI]
0065d20f : LEA EAX,[EAX + EDI*0x1 + 0x1]
0065d213 : JMP 0x0065d209

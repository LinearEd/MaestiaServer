PROGRAM  : Maestia.exe
FUNCTION : FUN_0078a270
ENTRY    : 0078a270
BODY     : [[0078a270, 0078a3ac]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0078a270(undefined4 param_1,char *param_2)

{
  char cVar1;
  char *pcVar2;
  int iVar3;
  undefined4 *unaff_ESI;
  undefined4 *puVar4;
  undefined1 local_430 [4];
  undefined2 local_42c;
  undefined4 local_41c;
  uint local_418;
  undefined4 local_414 [256];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b194f6;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  FUN_0045b620(local_14);
  local_8 = 0;
  unaff_ESI[2] = param_1;
  *unaff_ESI = &PTR_FUN_00cd7540;
  pcVar2 = param_2;
  do {
    cVar1 = *pcVar2;
    pcVar2 = pcVar2 + 1;
  } while (cVar1 != '\0');
  if (0x104 < (uint)((int)pcVar2 - (int)(param_2 + 1))) {
    puVar4 = local_414;
    for (iVar3 = 0x100; iVar3 != 0; iVar3 = iVar3 + -1) {
      *puVar4 = 0;
      puVar4 = puVar4 + 1;
    }
    FUN_0040e4a0(L"Buffer Over Run !! AvaMVDGFile::AvaMVDGFile %s",param_2);
    FUN_00406460(local_414);
    local_8._0_1_ = 1;
    if ((int *)*DAT_00da98e8 != (int *)0x0) {
      (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                (L"AvaLib::AvaMVDGFile::AvaMVDGFile",0xe3,local_430);
    }
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_418) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_418 = 7;
    local_41c = 0;
    local_42c = 0;
  }
  _strcpy_s((char *)(unaff_ESI + 3),0x104,param_2);
  local_8 = 0xffffffff;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0078a270 : PUSH EBP
0078a271 : MOV EBP,ESP
0078a273 : PUSH -0x1
0078a275 : PUSH 0xb194f6
0078a27a : MOV EAX,FS:[0x0]
0078a280 : PUSH EAX
0078a281 : SUB ESP,0x424
0078a287 : MOV EAX,[0x00d66fa0]
0078a28c : XOR EAX,EBP
0078a28e : MOV dword ptr [EBP + -0x10],EAX
0078a291 : PUSH EBX
0078a292 : PUSH EDI
0078a293 : PUSH EAX
0078a294 : LEA EAX,[EBP + -0xc]
0078a297 : MOV FS:[0x0],EAX
0078a29d : MOV EBX,dword ptr [EBP + 0xc]
0078a2a0 : MOV ECX,ESI
0078a2a2 : MOV dword ptr [EBP + 0xfffffbd0],ESI
0078a2a8 : CALL 0x0045b620
0078a2ad : MOV dword ptr [EBP + -0x4],0x0
0078a2b4 : MOV EAX,dword ptr [EBP + 0x8]
0078a2b7 : MOV dword ptr [ESI + 0x8],EAX
0078a2ba : MOV EAX,EBX
0078a2bc : MOV dword ptr [ESI],0xcd7540
0078a2c2 : LEA EDX,[EAX + 0x1]
0078a2c5 : MOV CL,byte ptr [EAX]
0078a2c7 : INC EAX
0078a2c8 : TEST CL,CL
0078a2ca : JNZ 0x0078a2c5
0078a2cc : SUB EAX,EDX
0078a2ce : CMP EAX,0x104
0078a2d3 : JBE 0x0078a375
0078a2d9 : XOR EAX,EAX
0078a2db : MOVZX EDX,AX
0078a2de : MOV EAX,EDX
0078a2e0 : SHL EDX,0x10
0078a2e3 : OR EAX,EDX
0078a2e5 : PUSH EBX
0078a2e6 : MOV ECX,0x100
0078a2eb : LEA EDI,[EBP + 0xfffffbf0]
0078a2f1 : PUSH 0xc13118
0078a2f6 : LEA EDX,[EBP + 0xfffffbf0]
0078a2fc : STOSD.REP ES:EDI
0078a2fe : CALL 0x0040e4a0
0078a303 : ADD ESP,0x8
0078a306 : LEA EAX,[EBP + 0xfffffbf0]
0078a30c : PUSH EAX
0078a30d : LEA ECX,[EBP + 0xfffffbd4]
0078a313 : CALL 0x00406460
0078a318 : MOV byte ptr [EBP + -0x4],0x1
0078a31c : MOV ECX,dword ptr [0x00da98e8]
0078a322 : MOV ECX,dword ptr [ECX]
0078a324 : TEST ECX,ECX
0078a326 : JZ 0x0078a340
0078a328 : MOV EDX,dword ptr [ECX]
0078a32a : MOV EDX,dword ptr [EDX + 0x14]
0078a32d : LEA EAX,[EBP + 0xfffffbd4]
0078a333 : PUSH EAX
0078a334 : PUSH 0xe3
0078a339 : PUSH 0xc13178
0078a33e : CALL EDX
0078a340 : MOV byte ptr [EBP + -0x4],0x0
0078a344 : CMP dword ptr [EBP + 0xfffffbec],0x8
0078a34b : JC 0x0078a358
0078a34d : MOV ECX,dword ptr [EBP + 0xfffffbd8]
0078a353 : CALL 0x006f04e0
0078a358 : XOR EAX,EAX
0078a35a : MOV dword ptr [EBP + 0xfffffbec],0x7
0078a364 : MOV dword ptr [EBP + 0xfffffbe8],0x0
0078a36e : MOV word ptr [EBP + 0xfffffbd8],AX
0078a375 : PUSH EBX
0078a376 : LEA EAX,[ESI + 0xc]
0078a379 : PUSH 0x104
0078a37e : PUSH EAX
0078a37f : CALL 0x00638300
0078a384 : ADD ESP,0xc
0078a387 : MOV dword ptr [EBP + -0x4],0xffffffff
0078a38e : MOV EAX,ESI
0078a390 : MOV ECX,dword ptr [EBP + -0xc]
0078a393 : MOV dword ptr FS:[0x0],ECX
0078a39a : POP ECX
0078a39b : POP EDI
0078a39c : POP EBX
0078a39d : MOV ECX,dword ptr [EBP + -0x10]
0078a3a0 : XOR ECX,EBP
0078a3a2 : CALL 0x00633e6b
0078a3a7 : MOV ESP,EBP
0078a3a9 : POP EBP
0078a3aa : RET 0x8

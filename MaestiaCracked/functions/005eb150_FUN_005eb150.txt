PROGRAM  : Maestia.exe
FUNCTION : FUN_005eb150
ENTRY    : 005eb150
BODY     : [[005eb150, 005eb2fe] [005eb300, 005eb4c3]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_005eb150(int *param_1,uint param_2,uint param_3,int param_4)

{
  int *piVar1;
  int *piVar2;
  int *piVar3;
  float fVar4;
  float fVar5;
  float fVar6;
  int iVar7;
  int in_ECX;
  int iVar8;
  float10 fVar9;
  float10 fVar10;
  float10 fVar11;
  undefined4 uVar12;
  uint uVar13;
  uint local_78;
  uint local_74;
  int local_60;
  int local_50;
  undefined4 local_48;
  
  *(undefined4 *)(in_ECX + 0x44) = 0;
  *(undefined4 *)(in_ECX + 0x54) = 0;
  *(undefined4 *)(in_ECX + 100) = 0;
  *(undefined4 *)(in_ECX + 0x74) = 0;
  *(undefined4 *)(in_ECX + 0x84) = 0;
  local_78 = param_2;
  if (param_2 < param_3) {
    iVar7 = param_2 * 0x28;
    do {
      iVar8 = *param_1 + iVar7;
      if (*(int *)(iVar8 + 8) == -1) {
        fVar9 = (float10)FUN_00638370((double)*(float *)(iVar8 + 0x18));
        fVar4 = *(float *)(iVar8 + 0x10);
        fVar10 = (float10)FUN_00638370((double)*(float *)(iVar8 + 0x1c));
        uVar13 = local_78;
        fVar11 = (float10)FUN_0063bc90((double)*(float *)(iVar8 + 0x14),local_78);
        local_48 = (undefined4)(longlong)ROUND((float)fVar10 - (float)fVar11);
        uVar12 = local_48;
        fVar10 = (float10)FUN_0063bc90((double)fVar4,local_48);
        local_48 = (undefined4)(longlong)ROUND((float)fVar9 - (float)fVar10);
        FUN_005eb0e0(local_48,uVar12,uVar13);
      }
      local_78 = local_78 + 1;
      iVar7 = iVar7 + 0x28;
    } while (local_78 < param_3);
  }
  FUN_006107d0();
  local_78 = 0;
  if (*(int *)(in_ECX + 100) != 0) {
    do {
      piVar2 = (int *)(*(int *)(*(int *)(in_ECX + 0x70) + (local_78 >> 4) * 4) +
                      (local_78 & 0xf) * 8);
      local_74 = 0;
      if (piVar2[1] != 0) {
        do {
          piVar3 = (int *)(*(int *)(*(int *)(in_ECX + 0x60) + (*piVar2 + local_74 >> 8) * 4) +
                          (*piVar2 + local_74 & 0xff) * 0xc);
          iVar7 = *param_1 + piVar3[2] * 0x28;
          fVar9 = (float10)FUN_00638370((double)*(float *)(*param_1 + 0x18 + piVar3[2] * 0x28));
          fVar4 = *(float *)(iVar7 + 0x10);
          fVar10 = (float10)FUN_00638370((double)*(float *)(iVar7 + 0x1c));
          fVar5 = *(float *)(iVar7 + 0x14);
          fVar6 = (float)*piVar3;
          if (*piVar3 < 0) {
            fVar6 = fVar6 + 4.2949673e+09;
          }
          piVar1 = piVar3 + 1;
          *(float *)(iVar7 + 0x20) = fVar6 - *(float *)(iVar7 + 0x10);
          fVar6 = (float)*piVar1;
          if (*piVar1 < 0) {
            fVar6 = fVar6 + 4.2949673e+09;
          }
          *(float *)(iVar7 + 0x24) = fVar6 - *(float *)(iVar7 + 0x14);
          fVar6 = (float)*piVar3;
          if (*piVar3 < 0) {
            fVar6 = fVar6 + 4.2949673e+09;
          }
          *(float *)(iVar7 + 0x10) = fVar6;
          fVar6 = (float)*piVar1;
          if (*piVar1 < 0) {
            fVar6 = fVar6 + 4.2949673e+09;
          }
          *(float *)(iVar7 + 0x14) = fVar6;
          fVar11 = (float10)FUN_0063bc90((double)fVar4);
          local_60 = (int)(longlong)ROUND((float)fVar9 - (float)fVar11);
          fVar4 = (float)(local_60 + *piVar3);
          if (local_60 + *piVar3 < 0) {
            fVar4 = fVar4 + 4.2949673e+09;
          }
          *(float *)(iVar7 + 0x18) = fVar4;
          fVar9 = (float10)FUN_0063bc90((double)fVar5);
          local_50 = (int)(longlong)ROUND((float)fVar10 - (float)fVar9);
          fVar4 = (float)(local_50 + *piVar1);
          if (local_50 + *piVar1 < 0) {
            fVar4 = fVar4 + 4.2949673e+09;
          }
          *(float *)(iVar7 + 0x1c) = fVar4;
          local_74 = local_74 + 1;
          *(uint *)(iVar7 + 0xc) = local_78 + param_4;
        } while (local_74 < (uint)piVar2[1]);
      }
      local_78 = local_78 + 1;
    } while (local_78 < *(uint *)(in_ECX + 100));
  }
  return *(int *)(in_ECX + 100) + param_4;
}



============================================================
DISASSEMBLY
============================================================
005eb150 : PUSH EBP
005eb151 : MOV EBP,ESP
005eb153 : AND ESP,0xffffffc0
005eb156 : SUB ESP,0x74
005eb159 : MOV EAX,dword ptr [EBP + 0xc]
005eb15c : PUSH EBX
005eb15d : PUSH ESI
005eb15e : XOR ESI,ESI
005eb160 : PUSH EDI
005eb161 : MOV EDI,ECX
005eb163 : LEA EBX,[EDI + 0x30]
005eb166 : MOV dword ptr [ESP + 0x54],EDI
005eb16a : MOV dword ptr [EBX + 0x14],ESI
005eb16d : MOV dword ptr [EBX + 0x24],ESI
005eb170 : MOV dword ptr [EBX + 0x34],ESI
005eb173 : MOV dword ptr [EBX + 0x44],ESI
005eb176 : MOV dword ptr [EBX + 0x54],ESI
005eb179 : MOV dword ptr [ESP + 0x48],EAX
005eb17d : CMP EAX,dword ptr [EBP + 0x10]
005eb180 : JNC 0x005eb2ba
005eb186 : LEA EAX,[EAX + EAX*0x4]
005eb189 : ADD EAX,EAX
005eb18b : ADD EAX,EAX
005eb18d : ADD EAX,EAX
005eb18f : MOV dword ptr [ESP + 0x4c],EAX
005eb193 : MOV ECX,dword ptr [EBP + 0x8]
005eb196 : MOV ESI,dword ptr [ECX]
005eb198 : ADD ESI,EAX
005eb19a : CMP dword ptr [ESI + 0x8],-0x1
005eb19e : JNZ 0x005eb29f
005eb1a4 : FLD float ptr [ESI + 0x18]
005eb1a7 : SUB ESP,0x8
005eb1aa : FSTP float ptr [ESP + 0x58]
005eb1ae : FLD float ptr [ESP + 0x58]
005eb1b2 : FSTP double ptr [ESP]
005eb1b5 : CALL 0x00638370
005eb1ba : FSTP float ptr [ESP + 0x58]
005eb1be : FLD float ptr [ESP + 0x58]
005eb1c2 : FSTP float ptr [ESP + 0x60]
005eb1c6 : FLD float ptr [ESI + 0x10]
005eb1c9 : FSTP float ptr [ESP + 0x68]
005eb1cd : FLD float ptr [ESI + 0x1c]
005eb1d0 : FSTP float ptr [ESP + 0x58]
005eb1d4 : FLD float ptr [ESP + 0x58]
005eb1d8 : FSTP double ptr [ESP]
005eb1db : CALL 0x00638370
005eb1e0 : MOV EDX,dword ptr [ESP + 0x50]
005eb1e4 : FSTP float ptr [ESP + 0x58]
005eb1e8 : FLD float ptr [ESP + 0x58]
005eb1ec : ADD ESP,0x8
005eb1ef : FSTP float ptr [ESP + 0x50]
005eb1f3 : PUSH EDX
005eb1f4 : FLD float ptr [ESP + 0x54]
005eb1f8 : SUB ESP,0x8
005eb1fb : FLD float ptr [ESI + 0x14]
005eb1fe : FSTP double ptr [ESP]
005eb201 : FSTP double ptr [ESP + 0x84]
005eb208 : CALL 0x0063bc90
005eb20d : FSTP float ptr [ESP + 0x5c]
005eb211 : ADD ESP,0x8
005eb214 : FLD float ptr [ESP + 0x54]
005eb218 : FSUBR double ptr [ESP + 0x7c]
005eb21c : FNSTCW word ptr [ESP + 0x48]
005eb220 : MOVZX EAX,word ptr [ESP + 0x48]
005eb225 : OR EAX,0xc00
005eb22a : MOV dword ptr [ESP + 0x54],EAX
005eb22e : FLDCW word ptr [ESP + 0x54]
005eb232 : FISTP qword ptr [ESP + 0x7c]
005eb236 : MOV EAX,dword ptr [ESP + 0x7c]
005eb23a : PUSH EAX
005eb23b : SUB ESP,0x8
005eb23e : FLDCW word ptr [ESP + 0x54]
005eb242 : FLD float ptr [ESP + 0x68]
005eb246 : FLD float ptr [ESP + 0x70]
005eb24a : FSTP double ptr [ESP]
005eb24d : FSTP double ptr [ESP + 0x88]
005eb254 : CALL 0x0063bc90
005eb259 : FNSTCW word ptr [ESP + 0x54]
005eb25d : ADD ESP,0x8
005eb260 : MOVZX EAX,word ptr [ESP + 0x4c]
005eb265 : FSTP float ptr [ESP + 0x68]
005eb269 : FLD float ptr [ESP + 0x68]
005eb26d : OR EAX,0xc00
005eb272 : FSUBR double ptr [ESP + 0x80]
005eb279 : MOV dword ptr [ESP + 0x68],EAX
005eb27d : FLDCW word ptr [ESP + 0x68]
005eb281 : FISTP qword ptr [ESP + 0x80]
005eb288 : MOV ECX,dword ptr [ESP + 0x80]
005eb28f : PUSH ECX
005eb290 : MOV ECX,EBX
005eb292 : FLDCW word ptr [ESP + 0x50]
005eb296 : CALL 0x005eb0e0
005eb29b : MOV EAX,dword ptr [ESP + 0x4c]
005eb29f : MOV ECX,dword ptr [ESP + 0x48]
005eb2a3 : INC ECX
005eb2a4 : ADD EAX,0x28
005eb2a7 : MOV dword ptr [ESP + 0x48],ECX
005eb2ab : MOV dword ptr [ESP + 0x4c],EAX
005eb2af : CMP ECX,dword ptr [EBP + 0x10]
005eb2b2 : JC 0x005eb193
005eb2b8 : XOR ESI,ESI
005eb2ba : MOV ECX,EBX
005eb2bc : CALL 0x006107d0
005eb2c1 : XOR ECX,ECX
005eb2c3 : MOV dword ptr [ESP + 0x48],ECX
005eb2c7 : CMP dword ptr [EDI + 0x64],ESI
005eb2ca : JBE 0x005eb4b5
005eb2d0 : MOV EAX,dword ptr [EDI + 0x70]
005eb2d3 : MOV EDX,ECX
005eb2d5 : SHR EDX,0x4
005eb2d8 : MOV EDX,dword ptr [EAX + EDX*0x4]
005eb2db : MOV EBX,ECX
005eb2dd : AND EBX,0xf
005eb2e0 : LEA EAX,[EDX + EBX*0x8]
005eb2e3 : MOV dword ptr [ESP + 0x50],EAX
005eb2e7 : MOV dword ptr [ESP + 0x4c],ESI
005eb2eb : CMP dword ptr [EAX + 0x4],ESI
005eb2ee : JBE 0x005eb4a7
005eb2f4 : MOV EDX,dword ptr [EBP + 0x14]
005eb2f7 : ADD ECX,EDX
005eb2f9 : MOV dword ptr [ESP + 0x78],ECX
005eb2fd : JMP 0x005eb304
005eb300 : MOV EAX,dword ptr [ESP + 0x50]
005eb304 : MOV EAX,dword ptr [EAX]
005eb306 : ADD EAX,dword ptr [ESP + 0x4c]
005eb30a : MOV EDX,dword ptr [EDI + 0x60]
005eb30d : MOV ECX,EAX
005eb30f : AND EAX,0xff
005eb314 : SHR ECX,0x8
005eb317 : MOV ECX,dword ptr [EDX + ECX*0x4]
005eb31a : LEA EAX,[EAX + EAX*0x2]
005eb31d : LEA EDI,[ECX + EAX*0x4]
005eb320 : MOV EAX,dword ptr [EDI + 0x8]
005eb323 : LEA EDX,[EAX + EAX*0x4]
005eb326 : MOV EAX,dword ptr [EBP + 0x8]
005eb329 : MOV ECX,dword ptr [EAX]
005eb32b : FLD float ptr [ECX + EDX*0x8 + 0x18]
005eb32f : LEA ESI,[ECX + EDX*0x8]
005eb332 : FSTP float ptr [ESP + 0x60]
005eb336 : SUB ESP,0x8
005eb339 : FLD float ptr [ESP + 0x68]
005eb33d : FSTP double ptr [ESP]
005eb340 : CALL 0x00638370
005eb345 : FSTP float ptr [ESP + 0x68]
005eb349 : FLD float ptr [ESP + 0x68]
005eb34d : FSTP float ptr [ESP + 0x60]
005eb351 : FLD float ptr [ESI + 0x10]
005eb354 : FSTP float ptr [ESP + 0x4c]
005eb358 : FLD float ptr [ESI + 0x1c]
005eb35b : FSTP float ptr [ESP + 0x68]
005eb35f : FLD float ptr [ESP + 0x68]
005eb363 : FSTP double ptr [ESP]
005eb366 : CALL 0x00638370
005eb36b : MOV EDX,dword ptr [EDI]
005eb36d : FSTP float ptr [ESP + 0x68]
005eb371 : FLD float ptr [ESP + 0x68]
005eb375 : FSTP float ptr [ESP + 0x70]
005eb379 : FLD float ptr [ESI + 0x14]
005eb37c : FSTP float ptr [ESP + 0x78]
005eb380 : FILD dword ptr [EDI]
005eb382 : TEST EDX,EDX
005eb384 : JGE 0x005eb38c
005eb386 : FADD float ptr [0x00cdf0e0]
005eb38c : FSUB float ptr [ESI + 0x10]
005eb38f : LEA EBX,[EDI + 0x4]
005eb392 : FSTP float ptr [ESI + 0x20]
005eb395 : MOV EAX,dword ptr [EBX]
005eb397 : FILD dword ptr [EBX]
005eb399 : TEST EAX,EAX
005eb39b : JGE 0x005eb3a3
005eb39d : FADD float ptr [0x00cdf0e0]
005eb3a3 : FSUB float ptr [ESI + 0x14]
005eb3a6 : FSTP float ptr [ESI + 0x24]
005eb3a9 : MOV ECX,dword ptr [EDI]
005eb3ab : FILD dword ptr [EDI]
005eb3ad : TEST ECX,ECX
005eb3af : JGE 0x005eb3b7
005eb3b1 : FADD float ptr [0x00cdf0e0]
005eb3b7 : FSTP float ptr [ESI + 0x10]
005eb3ba : MOV EDX,dword ptr [EBX]
005eb3bc : FILD dword ptr [EBX]
005eb3be : TEST EDX,EDX
005eb3c0 : JGE 0x005eb3c8
005eb3c2 : FADD float ptr [0x00cdf0e0]
005eb3c8 : FSTP float ptr [ESI + 0x14]
005eb3cb : FLD float ptr [ESP + 0x60]
005eb3cf : FLD float ptr [ESP + 0x4c]
005eb3d3 : FSTP double ptr [ESP]
005eb3d6 : FSTP double ptr [ESP + 0x60]
005eb3da : CALL 0x0063bc90
005eb3df : FNSTCW word ptr [ESP + 0x4c]
005eb3e3 : MOVZX EAX,word ptr [ESP + 0x4c]
005eb3e8 : FSTP float ptr [ESP + 0x68]
005eb3ec : FLD float ptr [ESP + 0x68]
005eb3f0 : OR EAX,0xc00
005eb3f5 : FSUBR double ptr [ESP + 0x60]
005eb3f9 : MOV dword ptr [ESP + 0x68],EAX
005eb3fd : FLDCW word ptr [ESP + 0x68]
005eb401 : FISTP qword ptr [ESP + 0x68]
005eb405 : MOV EAX,dword ptr [ESP + 0x68]
005eb409 : ADD EAX,dword ptr [EDI]
005eb40b : FLDCW word ptr [ESP + 0x4c]
005eb40f : MOV dword ptr [ESP + 0x68],EAX
005eb413 : FILD dword ptr [ESP + 0x68]
005eb417 : TEST EAX,EAX
005eb419 : JGE 0x005eb421
005eb41b : FADD float ptr [0x00cdf0e0]
005eb421 : FSTP float ptr [ESI + 0x18]
005eb424 : FLD float ptr [ESP + 0x70]
005eb428 : FLD float ptr [ESP + 0x78]
005eb42c : FSTP double ptr [ESP]
005eb42f : FSTP double ptr [ESP + 0x70]
005eb433 : CALL 0x0063bc90
005eb438 : FNSTCW word ptr [ESP + 0x4c]
005eb43c : ADD ESP,0x8
005eb43f : MOVZX EAX,word ptr [ESP + 0x44]
005eb444 : FSTP float ptr [ESP + 0x70]
005eb448 : FLD float ptr [ESP + 0x70]
005eb44c : OR EAX,0xc00
005eb451 : FSUBR double ptr [ESP + 0x68]
005eb455 : MOV dword ptr [ESP + 0x70],EAX
005eb459 : FLDCW word ptr [ESP + 0x70]
005eb45d : FISTP qword ptr [ESP + 0x70]
005eb461 : MOV ECX,dword ptr [ESP + 0x70]
005eb465 : ADD ECX,dword ptr [EBX]
005eb467 : FLDCW word ptr [ESP + 0x44]
005eb46b : MOV dword ptr [ESP + 0x70],ECX
005eb46f : FILD dword ptr [ESP + 0x70]
005eb473 : TEST ECX,ECX
005eb475 : JGE 0x005eb47d
005eb477 : FADD float ptr [0x00cdf0e0]
005eb47d : MOV EAX,dword ptr [ESP + 0x4c]
005eb481 : FSTP float ptr [ESI + 0x1c]
005eb484 : MOV EDX,dword ptr [ESP + 0x78]
005eb488 : MOV ECX,dword ptr [ESP + 0x50]
005eb48c : MOV EDI,dword ptr [ESP + 0x54]
005eb490 : INC EAX
005eb491 : MOV dword ptr [ESI + 0xc],EDX
005eb494 : MOV dword ptr [ESP + 0x4c],EAX
005eb498 : CMP EAX,dword ptr [ECX + 0x4]
005eb49b : JC 0x005eb300
005eb4a1 : MOV ECX,dword ptr [ESP + 0x48]
005eb4a5 : XOR ESI,ESI
005eb4a7 : INC ECX
005eb4a8 : MOV dword ptr [ESP + 0x48],ECX
005eb4ac : CMP ECX,dword ptr [EDI + 0x64]
005eb4af : JC 0x005eb2d0
005eb4b5 : MOV EAX,dword ptr [EDI + 0x64]
005eb4b8 : ADD EAX,dword ptr [EBP + 0x14]
005eb4bb : POP EDI
005eb4bc : POP ESI
005eb4bd : POP EBX
005eb4be : MOV ESP,EBP
005eb4c0 : POP EBP
005eb4c1 : RET 0x10

PROGRAM  : Maestia.exe
FUNCTION : FUN_00663bd0
ENTRY    : 00663bd0
BODY     : [[00663bd0, 00663ce0]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00663bd0(int param_1,int param_2,undefined4 param_3)

{
  LPCRITICAL_SECTION lpCriticalSection;
  uint uVar1;
  int iVar2;
  void *local_c;
  undefined1 *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00b0c688;
  local_c = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xffffffe8;
  if (param_2 == 0) {
    return -0x7fffbffd;
  }
  lpCriticalSection = *(LPCRITICAL_SECTION *)(param_1 + 0x14);
  ExceptionList = &local_c;
  EnterCriticalSection(lpCriticalSection);
  local_4 = 0;
  if (*(int *)(param_1 + 0xc) != 0) {
    LeaveCriticalSection(lpCriticalSection);
    ExceptionList = local_c;
    return -0x7ffbfdfc;
  }
  if ((*(int *)(*(int *)(param_1 + 0x1c) + 0x14) != 0) && (*(char *)(param_1 + 0x19) == '\0')) {
    LeaveCriticalSection(lpCriticalSection);
    ExceptionList = local_c;
    return -0x7ffbfddc;
  }
  iVar2 = FUN_00661fc0(param_2,param_3);
  if (iVar2 < 0) {
    (**(code **)(*(int *)(param_1 + -0xc) + 0x2c))(uVar1);
    LeaveCriticalSection(lpCriticalSection);
    ExceptionList = local_c;
    return iVar2;
  }
  LeaveCriticalSection(lpCriticalSection);
  ExceptionList = local_c;
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00663bd0 : PUSH -0x1
00663bd2 : PUSH 0xb0c688
00663bd7 : MOV EAX,FS:[0x0]
00663bdd : PUSH EAX
00663bde : PUSH EBX
00663bdf : PUSH ESI
00663be0 : PUSH EDI
00663be1 : MOV EAX,[0x00d66fa0]
00663be6 : XOR EAX,ESP
00663be8 : PUSH EAX
00663be9 : LEA EAX,[ESP + 0x10]
00663bed : MOV FS:[0x0],EAX
00663bf3 : MOV EDI,dword ptr [ESP + 0x24]
00663bf7 : TEST EDI,EDI
00663bf9 : JNZ 0x00663c15
00663bfb : MOV EAX,0x80004003
00663c00 : MOV ECX,dword ptr [ESP + 0x10]
00663c04 : MOV dword ptr FS:[0x0],ECX
00663c0b : POP ECX
00663c0c : POP EDI
00663c0d : POP ESI
00663c0e : POP EBX
00663c0f : ADD ESP,0xc
00663c12 : RET 0xc
00663c15 : MOV ESI,dword ptr [ESP + 0x20]
00663c19 : MOV EBX,dword ptr [ESI + 0x14]
00663c1c : PUSH EBX
00663c1d : MOV dword ptr [ESP + 0x28],EBX
00663c21 : CALL dword ptr [0x00b85118]
00663c27 : CMP dword ptr [ESI + 0xc],0x0
00663c2b : MOV dword ptr [ESP + 0x18],0x0
00663c33 : JZ 0x00663c56
00663c35 : PUSH EBX
00663c36 : CALL dword ptr [0x00b8511c]
00663c3c : MOV EAX,0x80040204
00663c41 : MOV ECX,dword ptr [ESP + 0x10]
00663c45 : MOV dword ptr FS:[0x0],ECX
00663c4c : POP ECX
00663c4d : POP EDI
00663c4e : POP ESI
00663c4f : POP EBX
00663c50 : ADD ESP,0xc
00663c53 : RET 0xc
00663c56 : MOV EAX,dword ptr [ESI + 0x1c]
00663c59 : CMP dword ptr [EAX + 0x14],0x0
00663c5d : JZ 0x00663c86
00663c5f : CMP byte ptr [ESI + 0x19],0x0
00663c63 : JNZ 0x00663c86
00663c65 : PUSH EBX
00663c66 : CALL dword ptr [0x00b8511c]
00663c6c : MOV EAX,0x80040224
00663c71 : MOV ECX,dword ptr [ESP + 0x10]
00663c75 : MOV dword ptr FS:[0x0],ECX
00663c7c : POP ECX
00663c7d : POP EDI
00663c7e : POP ESI
00663c7f : POP EBX
00663c80 : ADD ESP,0xc
00663c83 : RET 0xc
00663c86 : MOV ECX,dword ptr [ESP + 0x28]
00663c8a : PUSH ECX
00663c8b : ADD ESI,-0xc
00663c8e : PUSH EDI
00663c8f : MOV ECX,ESI
00663c91 : CALL 0x00661fc0
00663c96 : MOV EDI,EAX
00663c98 : TEST EDI,EDI
00663c9a : JGE 0x00663cc3
00663c9c : MOV EDX,dword ptr [ESI]
00663c9e : MOV EAX,dword ptr [EDX + 0x2c]
00663ca1 : MOV ECX,ESI
00663ca3 : CALL EAX
00663ca5 : PUSH EBX
00663ca6 : CALL dword ptr [0x00b8511c]
00663cac : MOV EAX,EDI
00663cae : MOV ECX,dword ptr [ESP + 0x10]
00663cb2 : MOV dword ptr FS:[0x0],ECX
00663cb9 : POP ECX
00663cba : POP EDI
00663cbb : POP ESI
00663cbc : POP EBX
00663cbd : ADD ESP,0xc
00663cc0 : RET 0xc
00663cc3 : PUSH EBX
00663cc4 : CALL dword ptr [0x00b8511c]
00663cca : XOR EAX,EAX
00663ccc : MOV ECX,dword ptr [ESP + 0x10]
00663cd0 : MOV dword ptr FS:[0x0],ECX
00663cd7 : POP ECX
00663cd8 : POP EDI
00663cd9 : POP ESI
00663cda : POP EBX
00663cdb : ADD ESP,0xc
00663cde : RET 0xc

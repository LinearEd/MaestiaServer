PROGRAM  : Maestia.exe
FUNCTION : FUN_0069c170
ENTRY    : 0069c170
BODY     : [[0069c170, 0069c37b]]

============================================================
DECOMPILED C CODE
============================================================

uint * FUN_0069c170(void)

{
  undefined4 uVar1;
  uint *puVar2;
  int *in_EAX;
  uint *puVar3;
  int iVar4;
  uint *puVar5;
  int in_ECX;
  uint uVar6;
  uint uVar7;
  uint *puVar8;
  uint *puVar9;
  uint *puVar10;
  int iVar11;
  uint local_54;
  int local_48;
  int local_44;
  uint local_40 [16];
  
  uVar1 = *(undefined4 *)(in_ECX * 0xcc + 200 + in_EAX[6]);
  puVar10 = (uint *)in_EAX[2];
  puVar8 = puVar10 + *in_EAX * 0xc;
  uVar6 = 0;
  local_44 = in_EAX[4];
  puVar5 = puVar10;
  if (puVar10 < puVar8) {
    do {
      if ((puVar5[4] & 0x10) != 0) {
        uVar6 = uVar6 + 1;
      }
      puVar5 = puVar5 + 0xc;
    } while (puVar5 < puVar8);
    if (uVar6 != 0) {
      if (uVar6 < 0x11) {
        puVar3 = local_40;
      }
      else {
        puVar3 = (uint *)FUN_0068a220(in_EAX[4],4,0,uVar6,0,&local_48);
        if (local_48 != 0) {
          return puVar3;
        }
      }
      local_54 = 0;
      puVar5 = puVar10;
      puVar9 = puVar3;
      do {
        puVar2 = puVar9;
        if ((puVar5[4] & 0x10) != 0) {
          while ((puVar3 < puVar2 && ((int)puVar5[9] < *(int *)(puVar2[-1] + 0x24)))) {
            *puVar2 = puVar2[-1];
            puVar2 = puVar2 + -1;
          }
          local_54 = local_54 + 1;
          *puVar2 = (uint)puVar5;
          puVar9 = puVar9 + 1;
        }
        puVar5 = puVar5 + 0xc;
      } while (puVar5 < puVar8);
      uVar6 = (int)puVar8 + (-1 - (int)puVar10);
      puVar5 = (uint *)(uVar6 * -0x55555555);
      iVar11 = uVar6 / 0x30 + 1;
      puVar10 = puVar10 + 3;
      do {
        if ((puVar10[1] & 0x10) == 0) {
          puVar5 = (uint *)*puVar10;
          if (((uint)puVar5 & 2) != 0) {
            if ((((char)puVar10[2] == '\x04') || ((char)puVar10[2] != *(char *)((int)puVar10 + 9)))
               || (((puVar10[1] & 0x40) == 0 && (((uint)puVar5 & 4) == 0)))) goto LAB_0069c34e;
            *puVar10 = (uint)puVar5 & 0xfffffffd;
          }
          uVar6 = 0;
          if (local_54 == 0) {
LAB_0069c2b7:
            uVar6 = *puVar3;
            iVar4 = FUN_00685ea0(puVar10[6] - *(int *)(uVar6 + 0x24),uVar1);
LAB_0069c340:
            puVar5 = (uint *)(iVar4 + *(int *)(uVar6 + 0x2c));
LAB_0069c343:
            puVar10[8] = (uint)puVar5;
          }
          else {
            puVar5 = (uint *)puVar10[6];
            do {
              if ((int)puVar5 < *(int *)(puVar3[uVar6] + 0x24)) break;
              uVar6 = uVar6 + 1;
            } while (uVar6 < local_54);
            if (uVar6 == 0) goto LAB_0069c2b7;
            uVar6 = puVar3[uVar6 - 1];
            uVar7 = local_54;
            if (local_54 == 0) {
LAB_0069c2f5:
              uVar6 = puVar3[uVar7 - 1];
              iVar4 = FUN_00685ea0((int)puVar5 - *(int *)(uVar6 + 0x24),uVar1);
              goto LAB_0069c340;
            }
            puVar8 = puVar3 + (local_54 - 1);
            do {
              if (*(int *)(*puVar8 + 0x24) < (int)puVar5) break;
              uVar7 = uVar7 - 1;
              puVar8 = puVar8 + -1;
            } while (uVar7 != 0);
            if (uVar7 == local_54) goto LAB_0069c2f5;
            uVar7 = puVar3[uVar7];
            if (puVar5 != *(uint **)(uVar6 + 0x24)) {
              if (puVar5 != *(uint **)(uVar7 + 0x24)) {
                iVar4 = FUN_00685d60((int)puVar5 - *(int *)(uVar6 + 0x24),
                                     *(int *)(uVar7 + 0x2c) - *(int *)(uVar6 + 0x2c),
                                     (int)*(uint **)(uVar7 + 0x24) - *(int *)(uVar6 + 0x24));
                goto LAB_0069c340;
              }
              puVar5 = *(uint **)(uVar7 + 0x2c);
              goto LAB_0069c343;
            }
            puVar10[8] = *(uint *)(uVar6 + 0x2c);
          }
          puVar10[1] = puVar10[1] | 0x20;
        }
LAB_0069c34e:
        puVar10 = puVar10 + 0xc;
        iVar11 = iVar11 + -1;
      } while (iVar11 != 0);
      if (puVar3 != local_40) {
        puVar5 = (uint *)FUN_00687f30(local_44,puVar3);
      }
    }
  }
  return puVar5;
}



============================================================
DISASSEMBLY
============================================================
0069c170 : SUB ESP,0x54
0069c173 : MOV EDX,dword ptr [EAX + 0x18]
0069c176 : IMUL ECX,ECX,0xcc
0069c17c : MOV ECX,dword ptr [ECX + EDX*0x1 + 0xc8]
0069c183 : MOV EDX,dword ptr [EAX + 0x10]
0069c186 : PUSH EBP
0069c187 : MOV EBP,dword ptr [EAX + 0x8]
0069c18a : MOV EAX,dword ptr [EAX]
0069c18c : PUSH EDI
0069c18d : LEA EDI,[EAX + EAX*0x2]
0069c190 : SHL EDI,0x4
0069c193 : MOV dword ptr [ESP + 0x10],ECX
0069c197 : ADD EDI,EBP
0069c199 : XOR ECX,ECX
0069c19b : MOV dword ptr [ESP + 0x18],EDX
0069c19f : MOV EAX,EBP
0069c1a1 : CMP EBP,EDI
0069c1a3 : JNC 0x0069c376
0069c1a9 : LEA ESP,[ESP]
0069c1b0 : TEST byte ptr [EAX + 0x10],0x10
0069c1b4 : JZ 0x0069c1b7
0069c1b6 : INC ECX
0069c1b7 : ADD EAX,0x30
0069c1ba : CMP EAX,EDI
0069c1bc : JC 0x0069c1b0
0069c1be : TEST ECX,ECX
0069c1c0 : JZ 0x0069c376
0069c1c6 : PUSH EBX
0069c1c7 : CMP ECX,0x10
0069c1ca : JA 0x0069c1d6
0069c1cc : LEA EBX,[ESP + 0x20]
0069c1d0 : MOV dword ptr [ESP + 0x10],EBX
0069c1d4 : JMP 0x0069c1fc
0069c1d6 : LEA EAX,[ESP + 0x18]
0069c1da : PUSH EAX
0069c1db : PUSH 0x0
0069c1dd : PUSH ECX
0069c1de : PUSH 0x0
0069c1e0 : PUSH 0x4
0069c1e2 : PUSH EDX
0069c1e3 : CALL 0x0068a220
0069c1e8 : ADD ESP,0x18
0069c1eb : CMP dword ptr [ESP + 0x18],0x0
0069c1f0 : MOV EBX,EAX
0069c1f2 : MOV dword ptr [ESP + 0x10],EBX
0069c1f6 : JNZ 0x0069c375
0069c1fc : PUSH ESI
0069c1fd : MOV dword ptr [ESP + 0x10],0x0
0069c205 : MOV ECX,EBP
0069c207 : MOV ESI,EBX
0069c209 : LEA ESP,[ESP]
0069c210 : TEST byte ptr [ECX + 0x10],0x10
0069c214 : JZ 0x0069c241
0069c216 : MOV EAX,ESI
0069c218 : CMP ESI,EBX
0069c21a : JBE 0x0069c238
0069c21c : LEA ESP,[ESP]
0069c220 : MOV EDX,dword ptr [EAX + -0x4]
0069c223 : MOV EBX,dword ptr [EDX + 0x24]
0069c226 : CMP EBX,dword ptr [ECX + 0x24]
0069c229 : MOV EBX,dword ptr [ESP + 0x14]
0069c22d : JLE 0x0069c238
0069c22f : MOV dword ptr [EAX],EDX
0069c231 : ADD EAX,-0x4
0069c234 : CMP EAX,EBX
0069c236 : JA 0x0069c220
0069c238 : INC dword ptr [ESP + 0x10]
0069c23c : MOV dword ptr [EAX],ECX
0069c23e : ADD ESI,0x4
0069c241 : ADD ECX,0x30
0069c244 : CMP ECX,EDI
0069c246 : JC 0x0069c210
0069c248 : SUB EDI,EBP
0069c24a : DEC EDI
0069c24b : MOV EAX,0xaaaaaaab
0069c250 : MUL EDI
0069c252 : MOV EDI,EDX
0069c254 : SHR EDI,0x5
0069c257 : INC EDI
0069c258 : LEA ESI,[EBP + 0xc]
0069c25b : MOV dword ptr [ESP + 0x14],EDI
0069c25f : NOP
0069c260 : MOV EDX,dword ptr [ESI + 0x4]
0069c263 : TEST DL,0x10
0069c266 : JNZ 0x0069c34e
0069c26c : MOV EAX,dword ptr [ESI]
0069c26e : TEST AL,0x2
0069c270 : JZ 0x0069c299
0069c272 : MOV CL,byte ptr [ESI + 0x8]
0069c275 : CMP CL,0x4
0069c278 : JZ 0x0069c34e
0069c27e : CMP CL,byte ptr [ESI + 0x9]
0069c281 : JNZ 0x0069c34e
0069c287 : TEST DL,0x40
0069c28a : JNZ 0x0069c294
0069c28c : TEST AL,0x4
0069c28e : JZ 0x0069c34e
0069c294 : AND EAX,0xfffffffd
0069c297 : MOV dword ptr [ESI],EAX
0069c299 : MOV EDX,dword ptr [ESP + 0x10]
0069c29d : XOR ECX,ECX
0069c29f : TEST EDX,EDX
0069c2a1 : JBE 0x0069c2b7
0069c2a3 : MOV EAX,dword ptr [ESI + 0x18]
0069c2a6 : MOV EDI,dword ptr [EBX + ECX*0x4]
0069c2a9 : CMP dword ptr [EDI + 0x24],EAX
0069c2ac : JG 0x0069c2b3
0069c2ae : INC ECX
0069c2af : CMP ECX,EDX
0069c2b1 : JC 0x0069c2a6
0069c2b3 : TEST ECX,ECX
0069c2b5 : JNZ 0x0069c2cf
0069c2b7 : MOV EDI,dword ptr [EBX]
0069c2b9 : MOV EDX,dword ptr [ESI + 0x18]
0069c2bc : MOV ECX,dword ptr [ESP + 0x18]
0069c2c0 : SUB EDX,dword ptr [EDI + 0x24]
0069c2c3 : PUSH ECX
0069c2c4 : PUSH EDX
0069c2c5 : CALL 0x00685ea0
0069c2ca : ADD ESP,0x8
0069c2cd : JMP 0x0069c340
0069c2cf : MOV EDI,dword ptr [EBX + ECX*0x4 + -0x4]
0069c2d3 : MOV ECX,EDX
0069c2d5 : TEST EDX,EDX
0069c2d7 : JBE 0x0069c2f5
0069c2d9 : LEA EDX,[EBX + EDX*0x4 + -0x4]
0069c2dd : LEA ECX,[ECX]
0069c2e0 : MOV EBP,dword ptr [EDX]
0069c2e2 : CMP dword ptr [EBP + 0x24],EAX
0069c2e5 : JL 0x0069c2ef
0069c2e7 : DEC ECX
0069c2e8 : SUB EDX,0x4
0069c2eb : TEST ECX,ECX
0069c2ed : JA 0x0069c2e0
0069c2ef : CMP ECX,dword ptr [ESP + 0x10]
0069c2f3 : JNZ 0x0069c30c
0069c2f5 : MOV EDI,dword ptr [EBX + ECX*0x4 + -0x4]
0069c2f9 : MOV ECX,dword ptr [ESP + 0x18]
0069c2fd : SUB EAX,dword ptr [EDI + 0x24]
0069c300 : PUSH ECX
0069c301 : PUSH EAX
0069c302 : CALL 0x00685ea0
0069c307 : ADD ESP,0x8
0069c30a : JMP 0x0069c340
0069c30c : MOV ECX,dword ptr [EBX + ECX*0x4]
0069c30f : CMP EAX,dword ptr [EDI + 0x24]
0069c312 : JNZ 0x0069c31c
0069c314 : MOV EDX,dword ptr [EDI + 0x2c]
0069c317 : MOV dword ptr [ESI + 0x20],EDX
0069c31a : JMP 0x0069c346
0069c31c : MOV EDX,dword ptr [ECX + 0x24]
0069c31f : CMP EAX,EDX
0069c321 : JNZ 0x0069c328
0069c323 : MOV EAX,dword ptr [ECX + 0x2c]
0069c326 : JMP 0x0069c343
0069c328 : MOV EBP,dword ptr [EDI + 0x24]
0069c32b : MOV ECX,dword ptr [ECX + 0x2c]
0069c32e : SUB ECX,dword ptr [EDI + 0x2c]
0069c331 : SUB EDX,EBP
0069c333 : PUSH EDX
0069c334 : PUSH ECX
0069c335 : SUB EAX,EBP
0069c337 : PUSH EAX
0069c338 : CALL 0x00685d60
0069c33d : ADD ESP,0xc
0069c340 : ADD EAX,dword ptr [EDI + 0x2c]
0069c343 : MOV dword ptr [ESI + 0x20],EAX
0069c346 : OR dword ptr [ESI + 0x4],0x20
0069c34a : MOV EDI,dword ptr [ESP + 0x14]
0069c34e : ADD ESI,0x30
0069c351 : SUB EDI,0x1
0069c354 : MOV dword ptr [ESP + 0x14],EDI
0069c358 : JNZ 0x0069c260
0069c35e : LEA EDX,[ESP + 0x24]
0069c362 : POP ESI
0069c363 : CMP EBX,EDX
0069c365 : JZ 0x0069c375
0069c367 : MOV EAX,dword ptr [ESP + 0x1c]
0069c36b : PUSH EBX
0069c36c : PUSH EAX
0069c36d : CALL 0x00687f30
0069c372 : ADD ESP,0x8
0069c375 : POP EBX
0069c376 : POP EDI
0069c377 : POP EBP
0069c378 : ADD ESP,0x54
0069c37b : RET

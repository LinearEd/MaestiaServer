PROGRAM  : Maestia.exe
FUNCTION : FUN_006a03e0
ENTRY    : 006a03e0
BODY     : [[006a03e0, 006a05c1]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006a03e0(undefined4 param_1,int param_2)

{
  int *piVar1;
  undefined4 uVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  bool bVar8;
  int iVar9;
  int iVar10;
  uint *puVar11;
  uint uVar12;
  uint local_c;
  
  iVar9 = param_2;
  uVar2 = *(undefined4 *)(param_2 + 100);
  piVar1 = (int *)(param_2 + 0xb8);
  param_2 = FUN_006877c0(param_1,0);
  if ((param_2 != 0) || (param_2 = FUN_006889e0(param_1,&DAT_00be8e90,piVar1), param_2 != 0)) {
    return 1;
  }
  if (((*piVar1 == 0x70636601) && (uVar12 = *(uint *)(iVar9 + 0xbc), uVar12 < 0x8000000)) &&
     (uVar12 != 0)) {
    iVar10 = FUN_0068a220(uVar2,0x10,0,uVar12,0,&param_2);
    *(int *)(iVar9 + 0xc0) = iVar10;
    if (param_2 != 0) {
      return 0x40;
    }
    uVar12 = 0;
    if (*(int *)(iVar9 + 0xbc) != 0) {
      do {
        param_2 = FUN_006889e0(param_1,&DAT_00be8ea0,iVar10);
        if (param_2 != 0) {
          FUN_00687f30(uVar2,*(undefined4 *)(iVar9 + 0xc0));
          *(undefined4 *)(iVar9 + 0xc0) = 0;
          return param_2;
        }
        uVar12 = uVar12 + 1;
        iVar10 = iVar10 + 0x10;
        param_2 = 0;
      } while (uVar12 < *(uint *)(iVar9 + 0xbc));
    }
    iVar10 = *(int *)(iVar9 + 0xbc);
    iVar3 = *(int *)(iVar9 + 0xc0);
    local_c = 0;
    if (iVar10 != 1) {
      do {
        bVar8 = false;
        uVar12 = 0;
        if (iVar10 - local_c == 1) {
          return 0;
        }
        puVar11 = (uint *)(iVar3 + 0x1c);
        do {
          if (*puVar11 < puVar11[-4]) {
            uVar4 = puVar11[-5];
            uVar5 = puVar11[-4];
            uVar6 = puVar11[-7];
            uVar7 = puVar11[-6];
            puVar11[-7] = puVar11[-3];
            puVar11[-6] = puVar11[-2];
            puVar11[-5] = puVar11[-1];
            puVar11[-3] = uVar6;
            puVar11[-2] = uVar7;
            puVar11[-1] = uVar4;
            puVar11[-4] = *puVar11;
            *puVar11 = uVar5;
            bVar8 = true;
          }
          if ((*puVar11 < puVar11[-5]) || (*puVar11 - puVar11[-5] < puVar11[-4])) {
            return 9;
          }
          uVar12 = uVar12 + 1;
          puVar11 = puVar11 + 4;
        } while (uVar12 < (*(int *)(iVar9 + 0xbc) - local_c) - 1);
        if (!bVar8) {
          return 0;
        }
        iVar10 = *(int *)(iVar9 + 0xbc);
        local_c = local_c + 1;
      } while (local_c < iVar10 - 1U);
    }
    return 0;
  }
  return 3;
}



============================================================
DISASSEMBLY
============================================================
006a03e0 : SUB ESP,0xc
006a03e3 : PUSH EBX
006a03e4 : PUSH EBP
006a03e5 : MOV EBP,dword ptr [ESP + 0x1c]
006a03e9 : MOV EBX,dword ptr [EBP + 0x64]
006a03ec : PUSH ESI
006a03ed : MOV ESI,dword ptr [ESP + 0x1c]
006a03f1 : PUSH EDI
006a03f2 : PUSH 0x0
006a03f4 : LEA EDI,[EBP + 0xb8]
006a03fa : PUSH ESI
006a03fb : MOV dword ptr [ESP + 0x20],EDI
006a03ff : MOV dword ptr [ESP + 0x18],EBX
006a0403 : CALL 0x006877c0
006a0408 : ADD ESP,0x8
006a040b : MOV dword ptr [ESP + 0x24],EAX
006a040f : TEST EAX,EAX
006a0411 : JNZ 0x006a05b5
006a0417 : PUSH EDI
006a0418 : PUSH 0xbe8e90
006a041d : PUSH ESI
006a041e : CALL 0x006889e0
006a0423 : ADD ESP,0xc
006a0426 : MOV dword ptr [ESP + 0x24],EAX
006a042a : TEST EAX,EAX
006a042c : JNZ 0x006a05b5
006a0432 : CMP dword ptr [EDI],0x70636601
006a0438 : JNZ 0x006a05a8
006a043e : MOV EAX,dword ptr [EDI + 0x4]
006a0441 : CMP EAX,0x7ffffff
006a0446 : JA 0x006a05a8
006a044c : TEST EAX,EAX
006a044e : JZ 0x006a05a8
006a0454 : LEA ECX,[ESP + 0x24]
006a0458 : PUSH ECX
006a0459 : PUSH 0x0
006a045b : PUSH EAX
006a045c : PUSH 0x0
006a045e : PUSH 0x10
006a0460 : PUSH EBX
006a0461 : CALL 0x0068a220
006a0466 : ADD ESP,0x18
006a0469 : CMP dword ptr [ESP + 0x24],0x0
006a046e : MOV dword ptr [EBP + 0xc0],EAX
006a0474 : JZ 0x006a0483
006a0476 : POP EDI
006a0477 : POP ESI
006a0478 : POP EBP
006a0479 : MOV EAX,0x40
006a047e : POP EBX
006a047f : ADD ESP,0xc
006a0482 : RET
006a0483 : XOR EBX,EBX
006a0485 : MOV ESI,EAX
006a0487 : CMP dword ptr [EDI + 0x4],EBX
006a048a : JBE 0x006a04b8
006a048c : LEA ESP,[ESP]
006a0490 : MOV EDX,dword ptr [ESP + 0x20]
006a0494 : PUSH ESI
006a0495 : PUSH 0xbe8ea0
006a049a : PUSH EDX
006a049b : CALL 0x006889e0
006a04a0 : ADD ESP,0xc
006a04a3 : MOV dword ptr [ESP + 0x24],EAX
006a04a7 : TEST EAX,EAX
006a04a9 : JNZ 0x006a0571
006a04af : INC EBX
006a04b0 : ADD ESI,0x10
006a04b3 : CMP EBX,dword ptr [EDI + 0x4]
006a04b6 : JC 0x006a0490
006a04b8 : MOV EAX,dword ptr [EDI + 0x4]
006a04bb : MOV EDX,dword ptr [EBP + 0xc0]
006a04c1 : XOR ESI,ESI
006a04c3 : LEA ECX,[EAX + -0x1]
006a04c6 : MOV dword ptr [ESP + 0x14],EDX
006a04ca : MOV dword ptr [ESP + 0x10],ESI
006a04ce : TEST ECX,ECX
006a04d0 : JBE 0x006a0567
006a04d6 : SUB EAX,ESI
006a04d8 : XOR EBP,EBP
006a04da : XOR EBX,EBX
006a04dc : SUB EAX,0x1
006a04df : JZ 0x006a0567
006a04e5 : MOV EAX,dword ptr [ESP + 0x14]
006a04e9 : ADD EAX,0x1c
006a04ec : LEA ESP,[ESP]
006a04f0 : MOV EDX,dword ptr [EAX + -0x10]
006a04f3 : CMP EDX,dword ptr [EAX]
006a04f5 : JBE 0x006a0532
006a04f7 : MOV EBP,dword ptr [EAX + -0xc]
006a04fa : MOV ESI,dword ptr [EAX + -0x14]
006a04fd : MOV EDI,dword ptr [EAX + -0x10]
006a0500 : MOV ECX,dword ptr [EAX + -0x1c]
006a0503 : MOV EDX,dword ptr [EAX + -0x18]
006a0506 : MOV dword ptr [EAX + -0x1c],EBP
006a0509 : MOV EBP,dword ptr [EAX + -0x8]
006a050c : MOV dword ptr [EAX + -0x18],EBP
006a050f : MOV EBP,dword ptr [EAX + -0x4]
006a0512 : MOV dword ptr [EAX + -0x14],EBP
006a0515 : MOV EBP,dword ptr [EAX]
006a0517 : MOV dword ptr [EAX + -0xc],ECX
006a051a : MOV dword ptr [EAX + -0x8],EDX
006a051d : MOV dword ptr [EAX + -0x4],ESI
006a0520 : MOV ESI,dword ptr [ESP + 0x10]
006a0524 : MOV dword ptr [EAX + -0x10],EBP
006a0527 : MOV dword ptr [EAX],EDI
006a0529 : MOV EDI,dword ptr [ESP + 0x18]
006a052d : MOV EBP,0x1
006a0532 : MOV EDX,dword ptr [EAX + -0x14]
006a0535 : MOV ECX,dword ptr [EAX]
006a0537 : CMP EDX,ECX
006a0539 : JA 0x006a059b
006a053b : SUB ECX,EDX
006a053d : CMP dword ptr [EAX + -0x10],ECX
006a0540 : JA 0x006a059b
006a0542 : MOV ECX,dword ptr [EDI + 0x4]
006a0545 : SUB ECX,ESI
006a0547 : INC EBX
006a0548 : DEC ECX
006a0549 : ADD EAX,0x10
006a054c : CMP EBX,ECX
006a054e : JC 0x006a04f0
006a0550 : TEST EBP,EBP
006a0552 : JZ 0x006a0567
006a0554 : MOV EAX,dword ptr [EDI + 0x4]
006a0557 : INC ESI
006a0558 : LEA EDX,[EAX + -0x1]
006a055b : MOV dword ptr [ESP + 0x10],ESI
006a055f : CMP ESI,EDX
006a0561 : JC 0x006a04d6
006a0567 : POP EDI
006a0568 : POP ESI
006a0569 : POP EBP
006a056a : XOR EAX,EAX
006a056c : POP EBX
006a056d : ADD ESP,0xc
006a0570 : RET
006a0571 : MOV EAX,dword ptr [EBP + 0xc0]
006a0577 : MOV ECX,dword ptr [ESP + 0x10]
006a057b : PUSH EAX
006a057c : PUSH ECX
006a057d : CALL 0x00687f30
006a0582 : MOV EAX,dword ptr [ESP + 0x2c]
006a0586 : ADD ESP,0x8
006a0589 : POP EDI
006a058a : POP ESI
006a058b : MOV dword ptr [EBP + 0xc0],0x0
006a0595 : POP EBP
006a0596 : POP EBX
006a0597 : ADD ESP,0xc
006a059a : RET
006a059b : POP EDI
006a059c : POP ESI
006a059d : POP EBP
006a059e : MOV EAX,0x9
006a05a3 : POP EBX
006a05a4 : ADD ESP,0xc
006a05a7 : RET
006a05a8 : POP EDI
006a05a9 : POP ESI
006a05aa : POP EBP
006a05ab : MOV EAX,0x3
006a05b0 : POP EBX
006a05b1 : ADD ESP,0xc
006a05b4 : RET
006a05b5 : POP EDI
006a05b6 : POP ESI
006a05b7 : POP EBP
006a05b8 : MOV EAX,0x1
006a05bd : POP EBX
006a05be : ADD ESP,0xc
006a05c1 : RET

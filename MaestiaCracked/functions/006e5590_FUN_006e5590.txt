PROGRAM  : Maestia.exe
FUNCTION : FUN_006e5590
ENTRY    : 006e5590
BODY     : [[006e5590, 006e5706]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006e5590(int param_1,int param_2,undefined4 *param_3,int param_4)

{
  int iVar1;
  byte bVar2;
  int iVar3;
  undefined1 *puVar4;
  byte *pbVar5;
  byte *pbVar6;
  byte *pbVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  byte *pbVar12;
  int iVar13;
  uint uVar14;
  int local_c;
  
  iVar3 = *(int *)(param_2 + 0x1c);
  FUN_006e4f00(param_3 + -1,*(int *)(param_1 + 0xdc) + 2);
  iVar11 = (0x80 - *(int *)(param_1 + 0xb4)) * 0x200;
  iVar8 = *(int *)(param_1 + 0xb4) * 0x40;
  local_c = 0;
  if (0 < *(int *)(param_2 + 0xc)) {
    do {
      puVar4 = *(undefined1 **)(param_4 + local_c * 4);
      pbVar5 = (byte *)param_3[-1];
      pbVar6 = (byte *)param_3[1];
      pbVar7 = (byte *)*param_3;
      uVar14 = (uint)*pbVar7;
      iVar13 = (uint)*pbVar5 + *pbVar6 + uVar14;
      pbVar12 = pbVar7 + 1;
      iVar9 = (uint)pbVar6[1] + (uint)pbVar5[1] + (uint)pbVar7[1];
      *puVar4 = (char)(((iVar13 * 2 - uVar14) + iVar9) * iVar8 + 0x8000 + uVar14 * iVar11 >> 0x10);
      for (iVar1 = iVar3 * 8 + -2; puVar4 = puVar4 + 1, iVar1 != 0; iVar1 = iVar1 + -1) {
        bVar2 = *pbVar12;
        pbVar12 = pbVar12 + 1;
        iVar10 = (uint)pbVar6[2] + (uint)pbVar5[2] + (uint)*pbVar12;
        *puVar4 = (char)(((iVar13 - (uint)bVar2) + iVar10 + iVar9) * iVar8 + 0x8000 +
                         (uint)bVar2 * iVar11 >> 0x10);
        pbVar5 = pbVar5 + 1;
        pbVar6 = pbVar6 + 1;
        iVar13 = iVar9;
        iVar9 = iVar10;
      }
      *puVar4 = (char)(((iVar9 * 2 - (uint)*pbVar12) + iVar13) * iVar8 + 0x8000 +
                       (uint)*pbVar12 * iVar11 >> 0x10);
      local_c = local_c + 1;
      param_3 = param_3 + 1;
    } while (local_c < *(int *)(param_2 + 0xc));
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
006e5590 : SUB ESP,0x18
006e5593 : MOV ECX,dword ptr [ESP + 0x24]
006e5597 : PUSH EBX
006e5598 : PUSH EBP
006e5599 : MOV EBP,dword ptr [ESP + 0x28]
006e559d : PUSH ESI
006e559e : MOV ESI,dword ptr [EBP + 0x1c]
006e55a1 : PUSH EDI
006e55a2 : MOV EDI,dword ptr [ESP + 0x2c]
006e55a6 : MOV EAX,dword ptr [EDI + 0xdc]
006e55ac : MOV EBX,dword ptr [EDI + 0x1c]
006e55af : ADD ESI,ESI
006e55b1 : ADD EAX,0x2
006e55b4 : ADD ESI,ESI
006e55b6 : PUSH EAX
006e55b7 : ADD ECX,-0x4
006e55ba : ADD ESI,ESI
006e55bc : PUSH ECX
006e55bd : MOV EAX,ESI
006e55bf : CALL 0x006e4f00
006e55c4 : MOV EAX,dword ptr [EDI + 0xb4]
006e55ca : MOV ECX,0x80
006e55cf : SUB ECX,EAX
006e55d1 : SHL ECX,0x9
006e55d4 : MOV dword ptr [ESP + 0x1c],ECX
006e55d8 : XOR ECX,ECX
006e55da : SHL EAX,0x6
006e55dd : ADD ESP,0x8
006e55e0 : CMP dword ptr [EBP + 0xc],ECX
006e55e3 : MOV dword ptr [ESP + 0x10],EAX
006e55e7 : MOV dword ptr [ESP + 0x1c],ECX
006e55eb : JLE 0x006e56ff
006e55f1 : MOV EAX,dword ptr [ESP + 0x34]
006e55f5 : ADD ESI,-0x2
006e55f8 : ADD EAX,0x4
006e55fb : MOV dword ptr [ESP + 0x24],ESI
006e55ff : MOV dword ptr [ESP + 0x20],EAX
006e5603 : MOV EDX,dword ptr [ESP + 0x38]
006e5607 : MOV ECX,dword ptr [EDX + ECX*0x4]
006e560a : MOV EDI,dword ptr [EAX + -0x8]
006e560d : MOV EBP,dword ptr [EAX]
006e560f : MOVZX EDX,byte ptr [EDI]
006e5612 : MOVZX EBX,byte ptr [EDI + 0x1]
006e5616 : MOV dword ptr [ESP + 0x2c],ECX
006e561a : MOV ECX,dword ptr [EAX + -0x4]
006e561d : MOVZX ESI,byte ptr [ECX]
006e5620 : MOVZX EAX,byte ptr [EBP]
006e5624 : ADD EAX,ESI
006e5626 : ADD EDX,EAX
006e5628 : MOVZX EAX,byte ptr [EBP + 0x1]
006e562c : INC EBP
006e562d : INC EDI
006e562e : MOV dword ptr [ESP + 0x34],EDX
006e5632 : ADD EAX,EBX
006e5634 : MOVZX EBX,byte ptr [ECX + 0x1]
006e5638 : ADD EDX,EDX
006e563a : SUB EDX,ESI
006e563c : IMUL ESI,dword ptr [ESP + 0x14]
006e5641 : INC ECX
006e5642 : ADD EAX,EBX
006e5644 : MOV EBX,dword ptr [ESP + 0x24]
006e5648 : ADD EDX,EAX
006e564a : IMUL EDX,dword ptr [ESP + 0x10]
006e564f : LEA EDX,[EDX + ESI*0x1 + 0x8000]
006e5656 : MOV ESI,dword ptr [ESP + 0x2c]
006e565a : SAR EDX,0x10
006e565d : MOV byte ptr [ESI],DL
006e565f : MOV EDX,dword ptr [ESP + 0x34]
006e5663 : INC ESI
006e5664 : MOV dword ptr [ESP + 0x2c],ESI
006e5668 : MOV dword ptr [ESP + 0x34],EAX
006e566c : MOV dword ptr [ESP + 0x18],EBX
006e5670 : TEST EBX,EBX
006e5672 : JBE 0x006e56bf
006e5674 : MOVZX EBX,byte ptr [EDI + 0x1]
006e5678 : MOVZX ESI,byte ptr [ECX]
006e567b : MOVZX EAX,byte ptr [EBP + 0x1]
006e567f : INC EDI
006e5680 : INC EBP
006e5681 : SUB EDX,ESI
006e5683 : IMUL ESI,dword ptr [ESP + 0x14]
006e5688 : INC ECX
006e5689 : ADD EAX,EBX
006e568b : MOVZX EBX,byte ptr [ECX]
006e568e : ADD EAX,EBX
006e5690 : ADD EDX,EAX
006e5692 : ADD EDX,dword ptr [ESP + 0x34]
006e5696 : IMUL EDX,dword ptr [ESP + 0x10]
006e569b : LEA EDX,[EDX + ESI*0x1 + 0x8000]
006e56a2 : MOV ESI,dword ptr [ESP + 0x2c]
006e56a6 : SAR EDX,0x10
006e56a9 : MOV byte ptr [ESI],DL
006e56ab : MOV EDX,dword ptr [ESP + 0x34]
006e56af : INC ESI
006e56b0 : SUB dword ptr [ESP + 0x18],0x1
006e56b5 : MOV dword ptr [ESP + 0x2c],ESI
006e56b9 : MOV dword ptr [ESP + 0x34],EAX
006e56bd : JNZ 0x006e5674
006e56bf : MOVZX ECX,byte ptr [ECX]
006e56c2 : ADD EAX,EAX
006e56c4 : SUB EAX,ECX
006e56c6 : IMUL ECX,dword ptr [ESP + 0x14]
006e56cb : ADD EAX,EDX
006e56cd : IMUL EAX,dword ptr [ESP + 0x10]
006e56d2 : MOV EDX,dword ptr [ESP + 0x30]
006e56d6 : LEA ECX,[EAX + ECX*0x1 + 0x8000]
006e56dd : MOV EAX,dword ptr [ESP + 0x20]
006e56e1 : SAR ECX,0x10
006e56e4 : MOV byte ptr [ESI],CL
006e56e6 : MOV ECX,dword ptr [ESP + 0x1c]
006e56ea : INC ECX
006e56eb : ADD EAX,0x4
006e56ee : CMP ECX,dword ptr [EDX + 0xc]
006e56f1 : MOV dword ptr [ESP + 0x1c],ECX
006e56f5 : MOV dword ptr [ESP + 0x20],EAX
006e56f9 : JL 0x006e5603
006e56ff : POP EDI
006e5700 : POP ESI
006e5701 : POP EBP
006e5702 : POP EBX
006e5703 : ADD ESP,0x18
006e5706 : RET

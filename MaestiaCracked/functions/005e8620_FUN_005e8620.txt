PROGRAM  : Maestia.exe
FUNCTION : FUN_005e8620
ENTRY    : 005e8620
BODY     : [[005e8620, 005e8917] [005e8920, 005e89e9] [005e89f0, 005e8ac9] [005e8ad0, 005e8c39] [005e8c40, 005e8cc1]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005e8620(int param_1,int *param_2)

{
  undefined1 uVar1;
  undefined1 uVar2;
  char cVar3;
  undefined1 uVar4;
  undefined1 uVar5;
  int *piVar6;
  int iVar7;
  undefined4 uVar8;
  uint uVar9;
  int iVar10;
  int iVar11;
  undefined1 *puVar12;
  undefined1 *puVar13;
  uint uVar14;
  uint uVar15;
  undefined1 *puVar16;
  byte *pbVar17;
  ushort uVar18;
  uint uVar19;
  int iVar20;
  char *pcVar21;
  GRefCountNTSImpl *local_14;
  int local_10;
  int local_c;
  
  iVar7 = *(int *)(param_1 + 0x314);
  if (iVar7 == 0) {
    iVar7 = param_1 + 0x28;
  }
  *(undefined1 *)(iVar7 + 0x15) = 0;
  if (*(int *)(iVar7 + 0x30) - *(int *)(iVar7 + 0x2c) < 2) {
    FUN_00539fb0(2);
  }
  iVar11 = *(int *)(iVar7 + 0x2c);
  uVar1 = *(undefined1 *)(*(int *)(iVar7 + 0x3c) + 1 + iVar11);
  uVar2 = *(undefined1 *)(*(int *)(iVar7 + 0x3c) + iVar11);
  *(int *)(iVar7 + 0x2c) = iVar11 + 2;
  iVar7 = *(int *)(param_1 + 0x314);
  if (iVar7 == 0) {
    iVar7 = param_1 + 0x28;
  }
  *(undefined1 *)(iVar7 + 0x15) = 0;
  if (*(int *)(iVar7 + 0x30) - *(int *)(iVar7 + 0x2c) < 1) {
    FUN_0053a0a0();
  }
  cVar3 = *(char *)(*(int *)(iVar7 + 0x2c) + *(int *)(iVar7 + 0x3c));
  *(int *)(iVar7 + 0x2c) = *(int *)(iVar7 + 0x2c) + 1;
  iVar7 = *(int *)(param_1 + 0x314);
  if (iVar7 == 0) {
    iVar7 = param_1 + 0x28;
  }
  *(undefined1 *)(iVar7 + 0x15) = 0;
  if (*(int *)(iVar7 + 0x30) - *(int *)(iVar7 + 0x2c) < 2) {
    FUN_00539fb0(2);
  }
  iVar11 = *(int *)(iVar7 + 0x2c);
  uVar4 = *(undefined1 *)(*(int *)(iVar7 + 0x3c) + 1 + iVar11);
  uVar5 = *(undefined1 *)(*(int *)(iVar7 + 0x3c) + iVar11);
  *(int *)(iVar7 + 0x2c) = iVar11 + 2;
  iVar7 = *(int *)(param_1 + 0x314);
  uVar19 = (uint)CONCAT11(uVar4,uVar5);
  if (iVar7 == 0) {
    iVar7 = param_1 + 0x28;
  }
  *(undefined1 *)(iVar7 + 0x15) = 0;
  if (*(int *)(iVar7 + 0x30) - *(int *)(iVar7 + 0x2c) < 2) {
    FUN_00539fb0(2);
  }
  iVar11 = *(int *)(iVar7 + 0x2c);
  uVar14 = (uint)CONCAT11(*(undefined1 *)(*(int *)(iVar7 + 0x3c) + 1 + iVar11),
                          *(undefined1 *)(*(int *)(iVar7 + 0x3c) + iVar11));
  *(int *)(iVar7 + 0x2c) = iVar11 + 2;
  GThread::OnExit((GThread *)(param_1 + 0x14));
  piVar6 = *(int **)(*(int *)(param_1 + 0x10) + 0x28);
  local_14 = (GRefCountNTSImpl *)0x0;
  if (piVar6 == (int *)0x0) {
    FUN_00555e50(param_1 + 0x14,"Error: GFxZlibState is not set - can\'t load zipped image data\n");
  }
  else {
    iVar7 = FUN_005a02c0(*(undefined4 *)(param_1 + 0x2b8));
    uVar8 = DAT_00d73250;
    if (iVar7 == 0) {
      uVar8 = FUN_00561610();
    }
    if (*param_2 == 0x14) {
      local_14 = (GRefCountNTSImpl *)FUN_00519a90(2,uVar19,uVar14,uVar8);
      if (cVar3 == '\x03') {
        uVar9 = FUN_00553200();
        uVar15 = uVar19 + 3 & 0xfffffffc;
        iVar7 = ((uVar9 & 0xff) + 1) * 3;
        iVar20 = uVar14 * uVar15 + iVar7;
        iVar10 = FUN_00515840(iVar20,0);
        iVar11 = *(int *)(param_1 + 0x314);
        if (iVar11 == 0) {
          iVar11 = param_1 + 0x28;
        }
        (**(code **)(*piVar6 + 8))(iVar11,iVar10,iVar20);
        local_10 = 0;
        if (uVar14 != 0) {
          iVar7 = iVar7 + iVar10;
          do {
            iVar11 = 0;
            if (uVar19 != 0) {
              puVar12 = (undefined1 *)
                        (*(int *)(local_14 + 0x14) * local_10 + *(int *)(local_14 + 0x18) + 2);
              do {
                puVar16 = (undefined1 *)(iVar10 + (uint)*(byte *)(iVar11 + iVar7) * 3);
                puVar12[-2] = *puVar16;
                puVar12[-1] = puVar16[1];
                *puVar12 = puVar16[2];
                iVar11 = iVar11 + 1;
                puVar12 = puVar12 + 3;
              } while (iVar11 < (int)uVar19);
            }
            iVar7 = iVar7 + uVar15;
            local_10 = local_10 + 1;
          } while (local_10 < (int)uVar14);
        }
        FUN_00515cf0(iVar10);
      }
      else if (cVar3 == '\x04') {
        uVar9 = uVar19 * 2 + 3 & 0xfffffffc;
        iVar10 = uVar14 * uVar9;
        iVar11 = FUN_0045b5a0(iVar10);
        iVar7 = *(int *)(param_1 + 0x314);
        if (iVar7 == 0) {
          iVar7 = param_1 + 0x28;
        }
        (**(code **)(*piVar6 + 8))(iVar7,iVar11,iVar10);
        param_2 = (int *)0x0;
        iVar7 = iVar11;
        if (uVar14 != 0) {
          do {
            iVar10 = 0;
            if (uVar19 != 0) {
              pcVar21 = (char *)(*(int *)(local_14 + 0x14) * (int)param_2 +
                                 *(int *)(local_14 + 0x18) + 2);
              do {
                cVar3 = *(char *)(iVar7 + iVar10 * 2);
                uVar18 = CONCAT11(*(undefined1 *)(iVar7 + 1 + iVar10 * 2),cVar3);
                pcVar21[-2] = (byte)(uVar18 >> 7) & 0xf8;
                pcVar21[-1] = (byte)(uVar18 >> 2) & 0xf8;
                *pcVar21 = cVar3 << 3;
                iVar10 = iVar10 + 1;
                pcVar21 = pcVar21 + 3;
              } while (iVar10 < (int)uVar19);
            }
            param_2 = (int *)((int)param_2 + 1);
            iVar7 = iVar7 + uVar9;
          } while ((int)param_2 < (int)uVar14);
        }
        FUN_00515cf0(iVar11);
      }
      else if (cVar3 == '\x05') {
        iVar11 = uVar14 * uVar19 * 4;
        iVar10 = FUN_0045b5a0(iVar11);
        iVar7 = *(int *)(param_1 + 0x314);
        if (iVar7 == 0) {
          iVar7 = param_1 + 0x28;
        }
        (**(code **)(*piVar6 + 8))(iVar7,iVar10,iVar11);
        iVar7 = 0;
        if (uVar14 != 0) {
          puVar12 = (undefined1 *)(iVar10 + 2);
          do {
            if (uVar19 != 0) {
              puVar16 = (undefined1 *)
                        (*(int *)(local_14 + 0x14) * iVar7 + *(int *)(local_14 + 0x18) + 2);
              puVar13 = puVar12;
              uVar9 = uVar19;
              do {
                uVar4 = *puVar13;
                uVar5 = puVar13[1];
                puVar16[-2] = puVar13[-1];
                puVar16[-1] = uVar4;
                *puVar16 = uVar5;
                puVar13 = puVar13 + 4;
                puVar16 = puVar16 + 3;
                uVar9 = uVar9 - 1;
              } while (uVar9 != 0);
            }
            iVar7 = iVar7 + 1;
            puVar12 = puVar12 + uVar19 * 4;
          } while (iVar7 < (int)uVar14);
        }
        FUN_00515cf0(iVar10);
      }
    }
    else {
      local_14 = (GRefCountNTSImpl *)FUN_00519a90(1,uVar19,uVar14,uVar8);
      if (cVar3 == '\x03') {
        uVar9 = FUN_00553200();
        uVar15 = uVar19 + 3 & 0xfffffffc;
        iVar7 = ((uVar9 & 0xff) + 1) * 4;
        iVar20 = uVar14 * uVar15 + iVar7;
        iVar10 = FUN_00515840(iVar20,0);
        iVar11 = *(int *)(param_1 + 0x314);
        if (iVar11 == 0) {
          iVar11 = param_1 + 0x28;
        }
        (**(code **)(*piVar6 + 8))(iVar11,iVar10,iVar20);
        local_c = 0;
        if (uVar14 != 0) {
          iVar7 = iVar7 + iVar10;
          do {
            iVar11 = 0;
            if (uVar19 != 0) {
              puVar12 = (undefined1 *)
                        (*(int *)(local_14 + 0x14) * local_c + *(int *)(local_14 + 0x18) + 2);
              do {
                puVar16 = (undefined1 *)(iVar10 + (uint)*(byte *)(iVar11 + iVar7) * 4);
                puVar12[-2] = *puVar16;
                puVar12[-1] = puVar16[1];
                *puVar12 = puVar16[2];
                puVar12[1] = puVar16[3];
                iVar11 = iVar11 + 1;
                puVar12 = puVar12 + 4;
              } while (iVar11 < (int)uVar19);
            }
            iVar7 = iVar7 + uVar15;
            local_c = local_c + 1;
          } while (local_c < (int)uVar14);
        }
        FUN_00515cf0(iVar10);
      }
      else if (cVar3 == '\x04') {
        uVar9 = uVar19 * 2 + 3 & 0xfffffffc;
        iVar10 = uVar14 * uVar9;
        iVar11 = FUN_0045b5a0(iVar10);
        iVar7 = *(int *)(param_1 + 0x314);
        if (iVar7 == 0) {
          iVar7 = param_1 + 0x28;
        }
        (**(code **)(*piVar6 + 8))(iVar7,iVar11,iVar10);
        param_2 = (int *)0x0;
        iVar7 = iVar11;
        if (uVar14 != 0) {
          do {
            iVar10 = 0;
            if (uVar19 != 0) {
              pbVar17 = (byte *)(*(int *)(local_14 + 0x14) * (int)param_2 +
                                 *(int *)(local_14 + 0x18) + 2);
              do {
                cVar3 = *(char *)(iVar7 + iVar10 * 2);
                uVar18 = CONCAT11(*(undefined1 *)(iVar7 + 1 + iVar10 * 2),cVar3);
                pbVar17[-1] = (byte)(uVar18 >> 7) & 0xf8;
                pbVar17[-2] = 0xff;
                *pbVar17 = (byte)(uVar18 >> 2) & 0xf8;
                pbVar17[1] = cVar3 << 3;
                iVar10 = iVar10 + 1;
                pbVar17 = pbVar17 + 4;
              } while (iVar10 < (int)uVar19);
            }
            param_2 = (int *)((int)param_2 + 1);
            iVar7 = iVar7 + uVar9;
          } while ((int)param_2 < (int)uVar14);
        }
        FUN_00515cf0(iVar11);
      }
      else if (cVar3 == '\x05') {
        iVar7 = *(int *)(param_1 + 0x314);
        if (iVar7 == 0) {
          iVar7 = param_1 + 0x28;
        }
        (**(code **)(*piVar6 + 8))(iVar7,*(undefined4 *)(local_14 + 0x18),uVar19 * uVar14 * 4);
        iVar7 = 0;
        if (uVar14 != 0) {
          do {
            if (uVar19 != 0) {
              puVar12 = (undefined1 *)
                        (*(int *)(local_14 + 0x14) * iVar7 + *(int *)(local_14 + 0x18) + 2);
              uVar9 = uVar19;
              do {
                uVar4 = puVar12[-2];
                puVar12[-2] = puVar12[-1];
                puVar12[-1] = *puVar12;
                *puVar12 = puVar12[1];
                puVar12[1] = uVar4;
                puVar12 = puVar12 + 4;
                uVar9 = uVar9 - 1;
              } while (uVar9 != 0);
            }
            iVar7 = iVar7 + 1;
          } while (iVar7 < (int)uVar14);
        }
        FUN_005e8100(local_14);
      }
    }
  }
  FUN_005a1850(CONCAT11(uVar1,uVar2),local_14);
  if (local_14 != (GRefCountNTSImpl *)0x0) {
    GRefCountNTSImpl::Release(local_14);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005e8620 : SUB ESP,0x18
005e8623 : PUSH EBX
005e8624 : PUSH EBP
005e8625 : PUSH ESI
005e8626 : PUSH EDI
005e8627 : MOV EDI,dword ptr [ESP + 0x2c]
005e862b : MOV ESI,dword ptr [EDI + 0x314]
005e8631 : TEST ESI,ESI
005e8633 : JNZ 0x005e8638
005e8635 : LEA ESI,[EDI + 0x28]
005e8638 : MOV EAX,dword ptr [ESI + 0x30]
005e863b : SUB EAX,dword ptr [ESI + 0x2c]
005e863e : MOV byte ptr [ESI + 0x15],0x0
005e8642 : CMP EAX,0x2
005e8645 : JGE 0x005e8650
005e8647 : PUSH 0x2
005e8649 : MOV ECX,ESI
005e864b : CALL 0x00539fb0
005e8650 : MOV EAX,dword ptr [ESI + 0x2c]
005e8653 : MOV ECX,dword ptr [ESI + 0x3c]
005e8656 : MOVZX DX,byte ptr [ECX + EAX*0x1 + 0x1]
005e865c : ADD ECX,EAX
005e865e : MOVZX CX,byte ptr [ECX]
005e8662 : SHL DX,0x8
005e8666 : OR DX,CX
005e8669 : ADD EAX,0x2
005e866c : MOVZX EDX,DX
005e866f : MOV dword ptr [ESI + 0x2c],EAX
005e8672 : MOV ESI,dword ptr [EDI + 0x314]
005e8678 : MOV dword ptr [ESP + 0x1c],EDX
005e867c : TEST ESI,ESI
005e867e : JNZ 0x005e8683
005e8680 : LEA ESI,[EDI + 0x28]
005e8683 : MOV EAX,dword ptr [ESI + 0x30]
005e8686 : SUB EAX,dword ptr [ESI + 0x2c]
005e8689 : MOV byte ptr [ESI + 0x15],0x0
005e868d : CMP EAX,0x1
005e8690 : JGE 0x005e8699
005e8692 : MOV ECX,ESI
005e8694 : CALL 0x0053a0a0
005e8699 : MOV EAX,dword ptr [ESI + 0x2c]
005e869c : MOV ECX,dword ptr [ESI + 0x3c]
005e869f : MOV DL,byte ptr [EAX + ECX*0x1]
005e86a2 : INC EAX
005e86a3 : MOV dword ptr [ESI + 0x2c],EAX
005e86a6 : MOV ESI,dword ptr [EDI + 0x314]
005e86ac : MOV byte ptr [ESP + 0x13],DL
005e86b0 : TEST ESI,ESI
005e86b2 : JNZ 0x005e86b7
005e86b4 : LEA ESI,[EDI + 0x28]
005e86b7 : MOV EAX,dword ptr [ESI + 0x30]
005e86ba : SUB EAX,dword ptr [ESI + 0x2c]
005e86bd : MOV byte ptr [ESI + 0x15],0x0
005e86c1 : CMP EAX,0x2
005e86c4 : JGE 0x005e86cf
005e86c6 : PUSH 0x2
005e86c8 : MOV ECX,ESI
005e86ca : CALL 0x00539fb0
005e86cf : MOV EAX,dword ptr [ESI + 0x2c]
005e86d2 : MOV ECX,dword ptr [ESI + 0x3c]
005e86d5 : MOVZX DX,byte ptr [ECX + EAX*0x1 + 0x1]
005e86db : ADD ECX,EAX
005e86dd : MOVZX CX,byte ptr [ECX]
005e86e1 : ADD EAX,0x2
005e86e4 : SHL DX,0x8
005e86e8 : MOV dword ptr [ESI + 0x2c],EAX
005e86eb : MOV ESI,dword ptr [EDI + 0x314]
005e86f1 : OR DX,CX
005e86f4 : MOVZX EBP,DX
005e86f7 : TEST ESI,ESI
005e86f9 : JNZ 0x005e86fe
005e86fb : LEA ESI,[EDI + 0x28]
005e86fe : MOV EDX,dword ptr [ESI + 0x30]
005e8701 : SUB EDX,dword ptr [ESI + 0x2c]
005e8704 : MOV byte ptr [ESI + 0x15],0x0
005e8708 : CMP EDX,0x2
005e870b : JGE 0x005e8716
005e870d : PUSH 0x2
005e870f : MOV ECX,ESI
005e8711 : CALL 0x00539fb0
005e8716 : MOV EAX,dword ptr [ESI + 0x2c]
005e8719 : MOV ECX,dword ptr [ESI + 0x3c]
005e871c : MOVZX DX,byte ptr [ECX + EAX*0x1 + 0x1]
005e8722 : ADD ECX,EAX
005e8724 : MOVZX CX,byte ptr [ECX]
005e8728 : SHL DX,0x8
005e872c : OR DX,CX
005e872f : MOVZX ECX,DX
005e8732 : MOVZX EDX,byte ptr [ESP + 0x13]
005e8737 : ADD EAX,0x2
005e873a : MOV dword ptr [ESI + 0x2c],EAX
005e873d : MOVZX EAX,word ptr [ESP + 0x1c]
005e8742 : MOVZX EBX,CX
005e8745 : PUSH EBX
005e8746 : MOVZX ESI,BP
005e8749 : PUSH ESI
005e874a : PUSH EDX
005e874b : PUSH EAX
005e874c : MOV dword ptr [ESP + 0x34],EAX
005e8750 : MOV EAX,dword ptr [ESP + 0x40]
005e8754 : MOV EDX,dword ptr [EAX]
005e8756 : PUSH EDX
005e8757 : LEA ECX,[EDI + 0x14]
005e875a : PUSH 0xb94588
005e875f : PUSH ECX
005e8760 : MOV dword ptr [ESP + 0x3c],EBX
005e8764 : CALL 0x0051d420
005e8769 : MOV ECX,dword ptr [EDI + 0x10]
005e876c : MOV EBP,dword ptr [ECX + 0x28]
005e876f : ADD ESP,0x1c
005e8772 : MOV dword ptr [ESP + 0x14],0x0
005e877a : TEST EBP,EBP
005e877c : JNZ 0x005e8794
005e877e : LEA EAX,[EDI + 0x14]
005e8781 : PUSH 0xb94510
005e8786 : PUSH EAX
005e8787 : CALL 0x00555e50
005e878c : ADD ESP,0x8
005e878f : JMP 0x005e8c98
005e8794 : MOV EAX,dword ptr [EDI + 0x2b8]
005e879a : PUSH EAX
005e879b : CALL 0x005a02c0
005e87a0 : TEST EAX,EAX
005e87a2 : JZ 0x005e87ab
005e87a4 : MOV EAX,[0x00d73250]
005e87a9 : JMP 0x005e87b3
005e87ab : MOV ECX,dword ptr [EDI + 0x20]
005e87ae : CALL 0x00561610
005e87b3 : MOV ECX,dword ptr [ESP + 0x30]
005e87b7 : CMP dword ptr [ECX],0x14
005e87ba : PUSH EAX
005e87bb : PUSH EBX
005e87bc : PUSH ESI
005e87bd : JNZ 0x005e8a3e
005e87c3 : PUSH 0x2
005e87c5 : CALL 0x00519a90
005e87ca : MOV dword ptr [ESP + 0x14],EAX
005e87ce : MOV AL,byte ptr [ESP + 0x13]
005e87d2 : CMP AL,0x3
005e87d4 : JNZ 0x005e88ad
005e87da : MOV ECX,EDI
005e87dc : CALL 0x00553200
005e87e1 : LEA ECX,[ESI + 0x3]
005e87e4 : AND ECX,0xfffffffc
005e87e7 : MOV EDI,EBX
005e87e9 : IMUL EDI,ECX
005e87ec : MOVZX EAX,AL
005e87ef : INC EAX
005e87f0 : LEA EAX,[EAX + EAX*0x2]
005e87f3 : ADD EDI,EAX
005e87f5 : PUSH 0x0
005e87f7 : MOV dword ptr [ESP + 0x20],ECX
005e87fb : MOV ECX,dword ptr [0x00d73250]
005e8801 : PUSH EDI
005e8802 : MOV dword ptr [ESP + 0x28],EAX
005e8806 : CALL 0x00515840
005e880b : MOV EDX,dword ptr [ESP + 0x2c]
005e880f : MOV dword ptr [ESP + 0x30],EAX
005e8813 : MOV EAX,dword ptr [EDX + 0x314]
005e8819 : TEST EAX,EAX
005e881b : JNZ 0x005e8822
005e881d : MOV EAX,EDX
005e881f : ADD EAX,0x28
005e8822 : MOV ECX,dword ptr [ESP + 0x30]
005e8826 : MOV EDX,dword ptr [EBP]
005e8829 : MOV EDX,dword ptr [EDX + 0x8]
005e882c : PUSH EDI
005e882d : PUSH ECX
005e882e : PUSH EAX
005e882f : MOV ECX,EBP
005e8831 : CALL EDX
005e8833 : XOR ECX,ECX
005e8835 : MOV dword ptr [ESP + 0x18],ECX
005e8839 : TEST EBX,EBX
005e883b : JLE 0x005e889e
005e883d : MOV EDX,dword ptr [ESP + 0x30]
005e8841 : MOV EAX,dword ptr [ESP + 0x20]
005e8845 : LEA EBP,[EAX + EDX*0x1]
005e8848 : MOV EDX,dword ptr [ESP + 0x14]
005e884c : LEA ESP,[ESP]
005e8850 : MOV EAX,dword ptr [EDX + 0x14]
005e8853 : IMUL EAX,ECX
005e8856 : ADD EAX,dword ptr [EDX + 0x18]
005e8859 : XOR EDI,EDI
005e885b : TEST ESI,ESI
005e885d : JLE 0x005e8891
005e885f : ADD EAX,0x2
005e8862 : MOVZX ECX,byte ptr [EDI + EBP*0x1]
005e8866 : MOV EDX,dword ptr [ESP + 0x30]
005e886a : LEA EDX,[EDX + ECX*0x2]
005e886d : ADD ECX,EDX
005e886f : MOVZX EDX,byte ptr [ECX]
005e8872 : MOV byte ptr [EAX + -0x2],DL
005e8875 : MOVZX EDX,byte ptr [ECX + 0x1]
005e8879 : MOV byte ptr [EAX + -0x1],DL
005e887c : MOV CL,byte ptr [ECX + 0x2]
005e887f : MOV byte ptr [EAX],CL
005e8881 : INC EDI
005e8882 : ADD EAX,0x3
005e8885 : CMP EDI,ESI
005e8887 : JL 0x005e8862
005e8889 : MOV EDX,dword ptr [ESP + 0x14]
005e888d : MOV ECX,dword ptr [ESP + 0x18]
005e8891 : ADD EBP,dword ptr [ESP + 0x1c]
005e8895 : INC ECX
005e8896 : CMP ECX,EBX
005e8898 : MOV dword ptr [ESP + 0x18],ECX
005e889c : JL 0x005e8850
005e889e : MOV EDX,dword ptr [ESP + 0x30]
005e88a2 : PUSH EDX
005e88a3 : CALL 0x00515cf0
005e88a8 : JMP 0x005e8c94
005e88ad : CMP AL,0x4
005e88af : JNZ 0x005e897c
005e88b5 : LEA EAX,[ESI + ESI*0x1 + 0x3]
005e88b9 : AND EAX,0xfffffffc
005e88bc : MOV ECX,EBX
005e88be : IMUL ECX,EAX
005e88c1 : PUSH ECX
005e88c2 : MOV dword ptr [ESP + 0x24],EAX
005e88c6 : MOV dword ptr [ESP + 0x34],ECX
005e88ca : CALL 0x0045b5a0
005e88cf : MOV ECX,dword ptr [EDI + 0x314]
005e88d5 : MOV dword ptr [ESP + 0x18],EAX
005e88d9 : TEST ECX,ECX
005e88db : JNZ 0x005e88e0
005e88dd : LEA ECX,[EDI + 0x28]
005e88e0 : MOV EDI,dword ptr [ESP + 0x30]
005e88e4 : MOV EDX,dword ptr [EBP]
005e88e7 : PUSH EDI
005e88e8 : PUSH EAX
005e88e9 : MOV EAX,dword ptr [EDX + 0x8]
005e88ec : PUSH ECX
005e88ed : MOV ECX,EBP
005e88ef : CALL EAX
005e88f1 : XOR EAX,EAX
005e88f3 : MOV dword ptr [ESP + 0x30],EAX
005e88f7 : TEST EBX,EBX
005e88f9 : JLE 0x005e896d
005e88fb : MOV EBP,dword ptr [ESP + 0x18]
005e88ff : NOP
005e8900 : MOV ECX,dword ptr [ESP + 0x14]
005e8904 : MOV EDI,dword ptr [ECX + 0x14]
005e8907 : IMUL EDI,EAX
005e890a : ADD EDI,dword ptr [ECX + 0x18]
005e890d : XOR ECX,ECX
005e890f : TEST ESI,ESI
005e8911 : JLE 0x005e8960
005e8913 : ADD EDI,0x2
005e8916 : JMP 0x005e8920
005e8920 : MOVZX DX,byte ptr [EBP + ECX*0x2 + 0x1]
005e8926 : MOVZX AX,byte ptr [EBP + ECX*0x2]
005e892c : SHL DX,0x8
005e8930 : OR DX,AX
005e8933 : MOVZX EAX,DX
005e8936 : MOV EDX,EAX
005e8938 : SHR EDX,0x7
005e893b : AND DL,0xf8
005e893e : MOV byte ptr [EDI + -0x2],DL
005e8941 : MOV EDX,EAX
005e8943 : ADD AL,AL
005e8945 : SHR EDX,0x2
005e8948 : ADD AL,AL
005e894a : AND DL,0xf8
005e894d : ADD AL,AL
005e894f : MOV byte ptr [EDI + -0x1],DL
005e8952 : MOV byte ptr [EDI],AL
005e8954 : INC ECX
005e8955 : ADD EDI,0x3
005e8958 : CMP ECX,ESI
005e895a : JL 0x005e8920
005e895c : MOV EAX,dword ptr [ESP + 0x30]
005e8960 : ADD EBP,dword ptr [ESP + 0x20]
005e8964 : INC EAX
005e8965 : CMP EAX,EBX
005e8967 : MOV dword ptr [ESP + 0x30],EAX
005e896b : JL 0x005e8900
005e896d : MOV EAX,dword ptr [ESP + 0x18]
005e8971 : PUSH EAX
005e8972 : CALL 0x00515cf0
005e8977 : JMP 0x005e8c94
005e897c : CMP AL,0x5
005e897e : JNZ 0x005e8c98
005e8984 : LEA ECX,[ESI*0x4 + 0x0]
005e898b : MOV EAX,EBX
005e898d : IMUL EAX,ECX
005e8990 : PUSH EAX
005e8991 : MOV dword ptr [ESP + 0x34],EAX
005e8995 : CALL 0x0045b5a0
005e899a : MOV dword ptr [ESP + 0x1c],EAX
005e899e : MOV EAX,dword ptr [EDI + 0x314]
005e89a4 : TEST EAX,EAX
005e89a6 : JNZ 0x005e89ab
005e89a8 : LEA EAX,[EDI + 0x28]
005e89ab : MOV ECX,dword ptr [ESP + 0x30]
005e89af : MOV EDI,dword ptr [ESP + 0x1c]
005e89b3 : MOV EDX,dword ptr [EBP]
005e89b6 : MOV EDX,dword ptr [EDX + 0x8]
005e89b9 : PUSH ECX
005e89ba : PUSH EDI
005e89bb : PUSH EAX
005e89bc : MOV ECX,EBP
005e89be : CALL EDX
005e89c0 : XOR EBP,EBP
005e89c2 : TEST EBX,EBX
005e89c4 : JLE 0x005e8a2f
005e89c6 : ADD EDI,0x2
005e89c9 : MOV dword ptr [ESP + 0x18],EDI
005e89cd : LEA ECX,[ECX]
005e89d0 : MOV ECX,dword ptr [ESP + 0x14]
005e89d4 : MOV EAX,dword ptr [ECX + 0x14]
005e89d7 : IMUL EAX,EBP
005e89da : ADD EAX,dword ptr [ECX + 0x18]
005e89dd : TEST ESI,ESI
005e89df : JLE 0x005e8a19
005e89e1 : LEA ECX,[EAX + 0x2]
005e89e4 : MOV EAX,EDI
005e89e6 : MOV EDI,ESI
005e89e8 : JMP 0x005e89f0
005e89f0 : MOVZX EBX,byte ptr [EAX]
005e89f3 : MOV DL,byte ptr [EAX + -0x1]
005e89f6 : MOV byte ptr [ESP + 0x30],BL
005e89fa : MOV BL,byte ptr [EAX + 0x1]
005e89fd : MOV byte ptr [ECX + -0x2],DL
005e8a00 : MOVZX EDX,byte ptr [ESP + 0x30]
005e8a05 : MOV byte ptr [ECX + -0x1],DL
005e8a08 : MOV byte ptr [ECX],BL
005e8a0a : ADD EAX,0x4
005e8a0d : ADD ECX,0x3
005e8a10 : SUB EDI,0x1
005e8a13 : JNZ 0x005e89f0
005e8a15 : MOV EBX,dword ptr [ESP + 0x20]
005e8a19 : MOV EDI,dword ptr [ESP + 0x18]
005e8a1d : LEA EAX,[ESI*0x4 + 0x0]
005e8a24 : INC EBP
005e8a25 : ADD EDI,EAX
005e8a27 : CMP EBP,EBX
005e8a29 : MOV dword ptr [ESP + 0x18],EDI
005e8a2d : JL 0x005e89d0
005e8a2f : MOV EAX,dword ptr [ESP + 0x1c]
005e8a33 : PUSH EAX
005e8a34 : CALL 0x00515cf0
005e8a39 : JMP 0x005e8c94
005e8a3e : PUSH 0x1
005e8a40 : CALL 0x00519a90
005e8a45 : MOV dword ptr [ESP + 0x14],EAX
005e8a49 : MOV AL,byte ptr [ESP + 0x13]
005e8a4d : CMP AL,0x3
005e8a4f : JNZ 0x005e8b32
005e8a55 : MOV ECX,EDI
005e8a57 : CALL 0x00553200
005e8a5c : LEA ECX,[ESI + 0x3]
005e8a5f : AND ECX,0xfffffffc
005e8a62 : MOVZX EAX,AL
005e8a65 : MOV EDI,EBX
005e8a67 : IMUL EDI,ECX
005e8a6a : INC EAX
005e8a6b : ADD EAX,EAX
005e8a6d : ADD EAX,EAX
005e8a6f : ADD EDI,EAX
005e8a71 : PUSH 0x0
005e8a73 : MOV dword ptr [ESP + 0x1c],ECX
005e8a77 : MOV ECX,dword ptr [0x00d73250]
005e8a7d : PUSH EDI
005e8a7e : MOV dword ptr [ESP + 0x28],EAX
005e8a82 : CALL 0x00515840
005e8a87 : MOV ECX,dword ptr [ESP + 0x2c]
005e8a8b : MOV dword ptr [ESP + 0x30],EAX
005e8a8f : MOV EAX,dword ptr [ECX + 0x314]
005e8a95 : TEST EAX,EAX
005e8a97 : JNZ 0x005e8a9e
005e8a99 : MOV EAX,ECX
005e8a9b : ADD EAX,0x28
005e8a9e : MOV ECX,dword ptr [ESP + 0x30]
005e8aa2 : MOV EDX,dword ptr [EBP]
005e8aa5 : MOV EDX,dword ptr [EDX + 0x8]
005e8aa8 : PUSH EDI
005e8aa9 : PUSH ECX
005e8aaa : PUSH EAX
005e8aab : MOV ECX,EBP
005e8aad : CALL EDX
005e8aaf : XOR ECX,ECX
005e8ab1 : MOV dword ptr [ESP + 0x1c],ECX
005e8ab5 : TEST EBX,EBX
005e8ab7 : JLE 0x005e8b23
005e8ab9 : MOV EDX,dword ptr [ESP + 0x30]
005e8abd : MOV EAX,dword ptr [ESP + 0x20]
005e8ac1 : LEA EBP,[EAX + EDX*0x1]
005e8ac4 : MOV EDX,dword ptr [ESP + 0x14]
005e8ac8 : JMP 0x005e8ad0
005e8ad0 : MOV EAX,dword ptr [EDX + 0x14]
005e8ad3 : IMUL EAX,ECX
005e8ad6 : ADD EAX,dword ptr [EDX + 0x18]
005e8ad9 : XOR EDI,EDI
005e8adb : TEST ESI,ESI
005e8add : JLE 0x005e8b16
005e8adf : ADD EAX,0x2
005e8ae2 : MOVZX ECX,byte ptr [EDI + EBP*0x1]
005e8ae6 : MOV EDX,dword ptr [ESP + 0x30]
005e8aea : LEA ECX,[EDX + ECX*0x4]
005e8aed : MOVZX EDX,byte ptr [ECX]
005e8af0 : MOV byte ptr [EAX + -0x2],DL
005e8af3 : MOVZX EDX,byte ptr [ECX + 0x1]
005e8af7 : MOV byte ptr [EAX + -0x1],DL
005e8afa : MOVZX EDX,byte ptr [ECX + 0x2]
005e8afe : MOV byte ptr [EAX],DL
005e8b00 : MOV CL,byte ptr [ECX + 0x3]
005e8b03 : MOV byte ptr [EAX + 0x1],CL
005e8b06 : INC EDI
005e8b07 : ADD EAX,0x4
005e8b0a : CMP EDI,ESI
005e8b0c : JL 0x005e8ae2
005e8b0e : MOV EDX,dword ptr [ESP + 0x14]
005e8b12 : MOV ECX,dword ptr [ESP + 0x1c]
005e8b16 : ADD EBP,dword ptr [ESP + 0x18]
005e8b1a : INC ECX
005e8b1b : CMP ECX,EBX
005e8b1d : MOV dword ptr [ESP + 0x1c],ECX
005e8b21 : JL 0x005e8ad0
005e8b23 : MOV EDX,dword ptr [ESP + 0x30]
005e8b27 : PUSH EDX
005e8b28 : CALL 0x00515cf0
005e8b2d : JMP 0x005e8c94
005e8b32 : CMP AL,0x4
005e8b34 : JNZ 0x005e8c00
005e8b3a : LEA EAX,[ESI + ESI*0x1 + 0x3]
005e8b3e : AND EAX,0xfffffffc
005e8b41 : MOV ECX,EBX
005e8b43 : IMUL ECX,EAX
005e8b46 : PUSH ECX
005e8b47 : MOV dword ptr [ESP + 0x24],EAX
005e8b4b : MOV dword ptr [ESP + 0x34],ECX
005e8b4f : CALL 0x0045b5a0
005e8b54 : MOV ECX,dword ptr [EDI + 0x314]
005e8b5a : MOV dword ptr [ESP + 0x1c],EAX
005e8b5e : TEST ECX,ECX
005e8b60 : JNZ 0x005e8b65
005e8b62 : LEA ECX,[EDI + 0x28]
005e8b65 : MOV EDI,dword ptr [ESP + 0x30]
005e8b69 : MOV EDX,dword ptr [EBP]
005e8b6c : PUSH EDI
005e8b6d : PUSH EAX
005e8b6e : MOV EAX,dword ptr [EDX + 0x8]
005e8b71 : PUSH ECX
005e8b72 : MOV ECX,EBP
005e8b74 : CALL EAX
005e8b76 : XOR EAX,EAX
005e8b78 : MOV dword ptr [ESP + 0x30],EAX
005e8b7c : TEST EBX,EBX
005e8b7e : JLE 0x005e8bf1
005e8b80 : MOV EBP,dword ptr [ESP + 0x1c]
005e8b84 : MOV EDX,dword ptr [ESP + 0x14]
005e8b88 : MOV ECX,dword ptr [EDX + 0x14]
005e8b8b : IMUL ECX,EAX
005e8b8e : ADD ECX,dword ptr [EDX + 0x18]
005e8b91 : XOR EDI,EDI
005e8b93 : TEST ESI,ESI
005e8b95 : JLE 0x005e8be4
005e8b97 : ADD ECX,0x2
005e8b9a : LEA EBX,[EBX]
005e8ba0 : MOVZX DX,byte ptr [EBP + EDI*0x2 + 0x1]
005e8ba6 : MOVZX AX,byte ptr [EBP + EDI*0x2]
005e8bac : SHL DX,0x8
005e8bb0 : OR DX,AX
005e8bb3 : MOVZX EAX,DX
005e8bb6 : MOV EDX,EAX
005e8bb8 : SHR EDX,0x7
005e8bbb : AND DL,0xf8
005e8bbe : MOV byte ptr [ECX + -0x1],DL
005e8bc1 : MOV EDX,EAX
005e8bc3 : ADD AL,AL
005e8bc5 : SHR EDX,0x2
005e8bc8 : ADD AL,AL
005e8bca : AND DL,0xf8
005e8bcd : ADD AL,AL
005e8bcf : MOV byte ptr [ECX + -0x2],0xff
005e8bd3 : MOV byte ptr [ECX],DL
005e8bd5 : MOV byte ptr [ECX + 0x1],AL
005e8bd8 : INC EDI
005e8bd9 : ADD ECX,0x4
005e8bdc : CMP EDI,ESI
005e8bde : JL 0x005e8ba0
005e8be0 : MOV EAX,dword ptr [ESP + 0x30]
005e8be4 : ADD EBP,dword ptr [ESP + 0x20]
005e8be8 : INC EAX
005e8be9 : CMP EAX,EBX
005e8beb : MOV dword ptr [ESP + 0x30],EAX
005e8bef : JL 0x005e8b84
005e8bf1 : MOV EAX,dword ptr [ESP + 0x1c]
005e8bf5 : PUSH EAX
005e8bf6 : CALL 0x00515cf0
005e8bfb : JMP 0x005e8c94
005e8c00 : CMP AL,0x5
005e8c02 : JNZ 0x005e8c98
005e8c08 : MOV EAX,dword ptr [EDI + 0x314]
005e8c0e : TEST EAX,EAX
005e8c10 : JNZ 0x005e8c15
005e8c12 : LEA EAX,[EDI + 0x28]
005e8c15 : MOV EDX,dword ptr [EBP]
005e8c18 : MOV EDX,dword ptr [EDX + 0x8]
005e8c1b : MOV ECX,ESI
005e8c1d : IMUL ECX,EBX
005e8c20 : ADD ECX,ECX
005e8c22 : ADD ECX,ECX
005e8c24 : PUSH ECX
005e8c25 : MOV ECX,dword ptr [ESP + 0x18]
005e8c29 : MOV ECX,dword ptr [ECX + 0x18]
005e8c2c : PUSH ECX
005e8c2d : PUSH EAX
005e8c2e : MOV ECX,EBP
005e8c30 : CALL EDX
005e8c32 : XOR EBP,EBP
005e8c34 : TEST EBX,EBX
005e8c36 : JLE 0x005e8c87
005e8c38 : JMP 0x005e8c40
005e8c40 : MOV ECX,dword ptr [ESP + 0x14]
005e8c44 : MOV EAX,dword ptr [ECX + 0x14]
005e8c47 : IMUL EAX,EBP
005e8c4a : ADD EAX,dword ptr [ECX + 0x18]
005e8c4d : TEST ESI,ESI
005e8c4f : JLE 0x005e8c82
005e8c51 : ADD EAX,0x2
005e8c54 : MOV EDI,ESI
005e8c56 : MOVZX EBX,byte ptr [EAX]
005e8c59 : MOV DL,byte ptr [EAX + -0x1]
005e8c5c : MOV CL,byte ptr [EAX + -0x2]
005e8c5f : MOV byte ptr [ESP + 0x30],BL
005e8c63 : MOV BL,byte ptr [EAX + 0x1]
005e8c66 : MOV byte ptr [EAX + -0x2],DL
005e8c69 : MOVZX EDX,byte ptr [ESP + 0x30]
005e8c6e : MOV byte ptr [EAX + -0x1],DL
005e8c71 : MOV byte ptr [EAX],BL
005e8c73 : MOV byte ptr [EAX + 0x1],CL
005e8c76 : ADD EAX,0x4
005e8c79 : SUB EDI,0x1
005e8c7c : JNZ 0x005e8c56
005e8c7e : MOV EBX,dword ptr [ESP + 0x20]
005e8c82 : INC EBP
005e8c83 : CMP EBP,EBX
005e8c85 : JL 0x005e8c40
005e8c87 : MOV EAX,dword ptr [ESP + 0x14]
005e8c8b : PUSH EAX
005e8c8c : CALL 0x005e8100
005e8c91 : ADD ESP,0x4
005e8c94 : MOV EDI,dword ptr [ESP + 0x2c]
005e8c98 : MOV ESI,dword ptr [ESP + 0x14]
005e8c9c : PUSH ESI
005e8c9d : PUSH ECX
005e8c9e : MOV ECX,dword ptr [ESP + 0x2c]
005e8ca2 : MOV EAX,ESP
005e8ca4 : MOV dword ptr [EAX],ECX
005e8ca6 : MOV ECX,EDI
005e8ca8 : CALL 0x005a1850
005e8cad : TEST ESI,ESI
005e8caf : JZ 0x005e8cb8
005e8cb1 : MOV ECX,ESI
005e8cb3 : CALL 0x004ff7c0
005e8cb8 : POP EDI
005e8cb9 : POP ESI
005e8cba : POP EBP
005e8cbb : POP EBX
005e8cbc : ADD ESP,0x18
005e8cbf : RET 0x8

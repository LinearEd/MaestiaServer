PROGRAM  : Maestia.exe
FUNCTION : FUN_00712070
ENTRY    : 00712070
BODY     : [[00712070, 00712475]]

============================================================
DECOMPILED C CODE
============================================================

byte FUN_00712070(int *param_1,int param_2)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  byte bVar4;
  uint uVar5;
  int iVar6;
  uint uVar7;
  ushort uVar8;
  int iVar9;
  short sVar10;
  uint local_8;
  
  local_8 = 0;
  uVar5 = 0;
LAB_00712080:
  do {
    uVar7 = param_1[0x1b];
    if (uVar7 < 0x106) {
      FUN_00711f90();
      uVar7 = param_1[0x1b];
      if ((uVar7 < 0x106) && (param_2 == 0)) {
        return 0;
      }
      if (uVar7 == 0) {
        if (param_1[0x18] != 0) {
          bVar4 = *(byte *)(param_1[0x19] + -1 + param_1[0xc]);
          *(undefined2 *)(param_1[0x5a7] + param_1[0x5a6] * 2) = 0;
          *(byte *)(param_1[0x5a4] + param_1[0x5a6]) = bVar4;
          param_1[0x5a6] = param_1[0x5a6] + 1;
          *(short *)(param_1 + bVar4 + 0x23) = (short)param_1[bVar4 + 0x23] + 1;
          param_1[0x18] = 0;
        }
        iVar6 = param_1[0x15];
        if (iVar6 < 0) {
          iVar9 = 0;
        }
        else {
          iVar9 = param_1[0xc] + iVar6;
        }
        FUN_0070fce0(iVar9,param_1[0x19] - iVar6);
        param_1[0x15] = param_1[0x19];
        FUN_00711800();
        if (*(int *)(*param_1 + 0x10) == 0) {
          return (param_2 != 4) - 1U & 2;
        }
        return (param_2 == 4) * '\x02' + 1;
      }
    }
    if (2 < uVar7) {
      uVar5 = (param_1[0x10] << ((byte)param_1[0x14] & 0x1f) ^
              (uint)*(byte *)(param_1[0xc] + 2 + param_1[0x19])) & param_1[0x13];
      param_1[0x10] = uVar5;
      *(undefined2 *)(param_1[0xe] + (param_1[0xb] & param_1[0x19]) * 2) =
           *(undefined2 *)(param_1[0xf] + uVar5 * 2);
      uVar5 = (uint)*(ushort *)(param_1[0xe] + (param_1[0x19] & param_1[0xb]) * 2);
      *(short *)(param_1[0xf] + param_1[0x10] * 2) = (short)param_1[0x19];
      local_8 = uVar5;
    }
    uVar7 = param_1[0x16];
    param_1[0x1c] = uVar7;
    param_1[0x17] = param_1[0x1a];
    param_1[0x16] = 2;
    if (((uVar5 != 0) && (uVar7 < (uint)param_1[0x1e])) &&
       (param_1[0x19] - uVar5 <= param_1[9] - 0x106U)) {
      if (param_1[0x20] < 2) {
        iVar6 = FUN_00711540(uVar5);
LAB_00712157:
        param_1[0x16] = iVar6;
      }
      else if ((param_1[0x20] == 3) && (param_1[0x19] - uVar5 == 1)) {
        iVar6 = FUN_007114a0();
        goto LAB_00712157;
      }
      if (((uint)param_1[0x16] < 6) &&
         ((param_1[0x20] == 1 ||
          ((param_1[0x16] == 3 && (0x1000 < (uint)(param_1[0x19] - param_1[0x1a]))))))) {
        param_1[0x16] = 2;
      }
    }
    if (((uint)param_1[0x1c] < 3) || ((uint)param_1[0x1c] < (uint)param_1[0x16])) {
      if (param_1[0x18] == 0) {
        param_1[0x19] = param_1[0x19] + 1;
        param_1[0x1b] = param_1[0x1b] + -1;
        param_1[0x18] = 1;
        goto LAB_00712080;
      }
      bVar4 = *(byte *)(param_1[0x19] + -1 + param_1[0xc]);
      *(undefined2 *)(param_1[0x5a7] + param_1[0x5a6] * 2) = 0;
      *(byte *)(param_1[0x5a4] + param_1[0x5a6]) = bVar4;
      param_1[0x5a6] = param_1[0x5a6] + 1;
      *(short *)(param_1 + bVar4 + 0x23) = (short)param_1[bVar4 + 0x23] + 1;
      if (param_1[0x5a6] == param_1[0x5a5] + -1) {
        iVar6 = param_1[0x15];
        if (iVar6 < 0) {
          iVar9 = 0;
        }
        else {
          iVar9 = param_1[0xc] + iVar6;
        }
        FUN_0070fce0(iVar9,param_1[0x19] - iVar6);
        param_1[0x15] = param_1[0x19];
        FUN_00711800();
      }
      param_1[0x19] = param_1[0x19] + 1;
      param_1[0x1b] = param_1[0x1b] + -1;
      iVar6 = *(int *)(*param_1 + 0x10);
    }
    else {
      sVar10 = (short)param_1[0x19] - (short)param_1[0x17];
      iVar6 = param_1[0x19];
      iVar9 = param_1[0x1b];
      iVar3 = param_1[0x1c];
      *(short *)(param_1[0x5a7] + param_1[0x5a6] * 2) = sVar10 + -1;
      bVar4 = (char)iVar3 - 3;
      *(byte *)(param_1[0x5a4] + param_1[0x5a6]) = bVar4;
      param_1[0x5a6] = param_1[0x5a6] + 1;
      *(short *)(param_1 + (byte)(&DAT_00bfe240)[bVar4] + 0x124) =
           (short)param_1[(byte)(&DAT_00bfe240)[bVar4] + 0x124] + 1;
      uVar8 = sVar10 - 2;
      if (uVar8 < 0x100) {
        bVar4 = (&DAT_00bfe040)[uVar8];
      }
      else {
        bVar4 = (&DAT_00bfe140)[uVar8 >> 7];
      }
      *(short *)(param_1 + bVar4 + 0x260) = (short)param_1[bVar4 + 0x260] + 1;
      iVar3 = param_1[0x5a5];
      iVar2 = param_1[0x5a6];
      param_1[0x1b] = param_1[0x1b] + (1 - param_1[0x1c]);
      param_1[0x1c] = param_1[0x1c] + -2;
      do {
        param_1[0x19] = param_1[0x19] + 1;
        uVar5 = param_1[0x19];
        if (uVar5 <= (uint)(iVar6 + -3 + iVar9)) {
          uVar7 = (param_1[0x10] << ((byte)param_1[0x14] & 0x1f) ^
                  (uint)*(byte *)(param_1[0xc] + 2 + uVar5)) & param_1[0x13];
          param_1[0x10] = uVar7;
          *(undefined2 *)(param_1[0xe] + (param_1[0xb] & uVar5) * 2) =
               *(undefined2 *)(param_1[0xf] + uVar7 * 2);
          local_8 = (uint)*(ushort *)(param_1[0xe] + (param_1[0x19] & param_1[0xb]) * 2);
          *(short *)(param_1[0xf] + param_1[0x10] * 2) = (short)param_1[0x19];
        }
        piVar1 = param_1 + 0x1c;
        *piVar1 = *piVar1 + -1;
      } while (*piVar1 != 0);
      param_1[0x19] = param_1[0x19] + 1;
      param_1[0x18] = 0;
      param_1[0x16] = 2;
      uVar5 = local_8;
      if (iVar2 != iVar3 + -1) goto LAB_00712080;
      iVar6 = param_1[0x15];
      if (iVar6 < 0) {
        iVar9 = 0;
      }
      else {
        iVar9 = param_1[0xc] + iVar6;
      }
      FUN_0070fce0(iVar9,param_1[0x19] - iVar6);
      param_1[0x15] = param_1[0x19];
      FUN_00711800();
      iVar6 = *(int *)(*param_1 + 0x10);
    }
    if (iVar6 == 0) {
      return 0;
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
00712070 : PUSH EBP
00712071 : MOV EBP,ESP
00712073 : PUSH ECX
00712074 : PUSH EBX
00712075 : PUSH ESI
00712076 : MOV ESI,dword ptr [EBP + 0x8]
00712079 : XOR EBX,EBX
0071207b : PUSH EDI
0071207c : MOV dword ptr [EBP + -0x4],EBX
0071207f : NOP
00712080 : MOV EAX,dword ptr [ESI + 0x6c]
00712083 : CMP EAX,0x106
00712088 : JNC 0x007120ad
0071208a : MOV EDI,ESI
0071208c : CALL 0x00711f90
00712091 : MOV EAX,dword ptr [ESI + 0x6c]
00712094 : CMP EAX,0x106
00712099 : JNC 0x007120a5
0071209b : CMP dword ptr [EBP + 0xc],0x0
0071209f : JZ 0x00712309
007120a5 : TEST EAX,EAX
007120a7 : JZ 0x007123c2
007120ad : CMP EAX,0x3
007120b0 : JC 0x007120fe
007120b2 : MOV EAX,dword ptr [ESI + 0x40]
007120b5 : MOV ECX,dword ptr [ESI + 0x50]
007120b8 : MOV EDX,dword ptr [ESI + 0x64]
007120bb : MOV EDI,dword ptr [ESI + 0x2c]
007120be : SHL EAX,CL
007120c0 : MOV ECX,dword ptr [ESI + 0x30]
007120c3 : MOVZX ECX,byte ptr [ECX + EDX*0x1 + 0x2]
007120c8 : XOR EAX,ECX
007120ca : AND EAX,dword ptr [ESI + 0x4c]
007120cd : MOV ECX,dword ptr [ESI + 0x3c]
007120d0 : MOV dword ptr [ESI + 0x40],EAX
007120d3 : MOV AX,word ptr [ECX + EAX*0x2]
007120d7 : AND EDI,EDX
007120d9 : MOV EDX,dword ptr [ESI + 0x38]
007120dc : MOV word ptr [EDX + EDI*0x2],AX
007120e0 : MOV ECX,dword ptr [ESI + 0x64]
007120e3 : AND ECX,dword ptr [ESI + 0x2c]
007120e6 : MOV EDX,dword ptr [ESI + 0x38]
007120e9 : MOVZX EBX,word ptr [EDX + ECX*0x2]
007120ed : MOV EAX,dword ptr [ESI + 0x40]
007120f0 : MOV ECX,dword ptr [ESI + 0x3c]
007120f3 : MOV DX,word ptr [ESI + 0x64]
007120f7 : MOV dword ptr [EBP + -0x4],EBX
007120fa : MOV word ptr [ECX + EAX*0x2],DX
007120fe : MOV EAX,dword ptr [ESI + 0x58]
00712101 : MOV ECX,dword ptr [ESI + 0x68]
00712104 : MOV dword ptr [ESI + 0x70],EAX
00712107 : MOV dword ptr [ESI + 0x5c],ECX
0071210a : MOV dword ptr [ESI + 0x58],0x2
00712111 : TEST EBX,EBX
00712113 : JZ 0x00712185
00712115 : MOV EDX,EAX
00712117 : CMP EDX,dword ptr [ESI + 0x78]
0071211a : JNC 0x00712185
0071211c : MOV EAX,dword ptr [ESI + 0x64]
0071211f : MOV ECX,dword ptr [ESI + 0x24]
00712122 : SUB EAX,EBX
00712124 : SUB ECX,0x106
0071212a : CMP EAX,ECX
0071212c : JA 0x00712185
0071212e : MOV ECX,dword ptr [ESI + 0x80]
00712134 : CMP ECX,0x2
00712137 : JGE 0x00712146
00712139 : PUSH EBX
0071213a : MOV EDI,ESI
0071213c : CALL 0x00711540
00712141 : ADD ESP,0x4
00712144 : JMP 0x00712157
00712146 : CMP ECX,0x3
00712149 : JNZ 0x0071215a
0071214b : CMP EAX,0x1
0071214e : JNZ 0x0071215a
00712150 : MOV EDX,EBX
00712152 : CALL 0x007114a0
00712157 : MOV dword ptr [ESI + 0x58],EAX
0071215a : MOV EAX,dword ptr [ESI + 0x58]
0071215d : CMP EAX,0x5
00712160 : JA 0x00712185
00712162 : CMP dword ptr [ESI + 0x80],0x1
00712169 : JZ 0x0071217e
0071216b : CMP EAX,0x3
0071216e : JNZ 0x00712185
00712170 : MOV EDX,dword ptr [ESI + 0x64]
00712173 : SUB EDX,dword ptr [ESI + 0x68]
00712176 : CMP EDX,0x1000
0071217c : JBE 0x00712185
0071217e : MOV dword ptr [ESI + 0x58],0x2
00712185 : MOV EAX,dword ptr [ESI + 0x70]
00712188 : CMP EAX,0x3
0071218b : JC 0x00712312
00712191 : CMP dword ptr [ESI + 0x58],EAX
00712194 : JA 0x00712312
0071219a : MOV DX,word ptr [ESI + 0x64]
0071219e : SUB DX,word ptr [ESI + 0x5c]
007121a2 : MOV EAX,dword ptr [ESI + 0x64]
007121a5 : MOV ECX,dword ptr [ESI + 0x6c]
007121a8 : MOV EBX,dword ptr [ESI + 0x169c]
007121ae : LEA EDI,[EAX + ECX*0x1 + -0x3]
007121b2 : MOV AL,byte ptr [ESI + 0x70]
007121b5 : DEC DX
007121b7 : MOVZX ECX,DX
007121ba : MOV EDX,dword ptr [ESI + 0x1698]
007121c0 : MOV word ptr [EBX + EDX*0x2],CX
007121c4 : MOV EDX,dword ptr [ESI + 0x1690]
007121ca : MOV EBX,dword ptr [ESI + 0x1698]
007121d0 : SUB AL,0x3
007121d2 : MOV byte ptr [EDX + EBX*0x1],AL
007121d5 : MOVZX EAX,AL
007121d8 : MOV EDX,0x1
007121dd : ADD dword ptr [ESI + 0x1698],EDX
007121e3 : MOVZX EAX,byte ptr [EAX + 0xbfe240]
007121ea : ADD word ptr [ESI + EAX*0x4 + 0x490],DX
007121f2 : LEA EAX,[ESI + EAX*0x4 + 0x490]
007121f9 : ADD ECX,0xffff
007121ff : MOV EAX,0x100
00712204 : CMP CX,AX
00712207 : JNC 0x00712215
00712209 : MOVZX ECX,CX
0071220c : MOVZX EAX,byte ptr [ECX + 0xbfe040]
00712213 : JMP 0x00712222
00712215 : MOVZX EAX,CX
00712218 : SHR EAX,0x7
0071221b : MOVZX EAX,byte ptr [EAX + 0xbfe140]
00712222 : ADD word ptr [ESI + EAX*0x4 + 0x980],DX
0071222a : MOV ECX,dword ptr [ESI + 0x1694]
00712230 : MOV EBX,dword ptr [EBP + -0x4]
00712233 : SUB ECX,EDX
00712235 : XOR EAX,EAX
00712237 : CMP dword ptr [ESI + 0x1698],ECX
0071223d : MOV ECX,EDX
0071223f : SETZ AL
00712242 : MOV dword ptr [EBP + 0x8],EAX
00712245 : MOV EAX,dword ptr [ESI + 0x70]
00712248 : SUB ECX,EAX
0071224a : ADD dword ptr [ESI + 0x6c],ECX
0071224d : ADD EAX,-0x2
00712250 : MOV dword ptr [ESI + 0x70],EAX
00712253 : JMP 0x0071225a
00712255 : MOV EDX,0x1
0071225a : ADD dword ptr [ESI + 0x64],EDX
0071225d : MOV EDX,dword ptr [ESI + 0x64]
00712260 : CMP EDX,EDI
00712262 : JA 0x007122aa
00712264 : MOV EAX,dword ptr [ESI + 0x40]
00712267 : MOV ECX,dword ptr [ESI + 0x50]
0071226a : MOV EBX,dword ptr [ESI + 0x2c]
0071226d : SHL EAX,CL
0071226f : MOV ECX,dword ptr [ESI + 0x30]
00712272 : MOVZX ECX,byte ptr [ECX + EDX*0x1 + 0x2]
00712277 : XOR EAX,ECX
00712279 : AND EAX,dword ptr [ESI + 0x4c]
0071227c : MOV ECX,dword ptr [ESI + 0x3c]
0071227f : AND EBX,EDX
00712281 : MOV EDX,dword ptr [ESI + 0x38]
00712284 : MOV dword ptr [ESI + 0x40],EAX
00712287 : MOV AX,word ptr [ECX + EAX*0x2]
0071228b : MOV word ptr [EDX + EBX*0x2],AX
0071228f : MOV ECX,dword ptr [ESI + 0x64]
00712292 : AND ECX,dword ptr [ESI + 0x2c]
00712295 : MOV EDX,dword ptr [ESI + 0x38]
00712298 : MOVZX EBX,word ptr [EDX + ECX*0x2]
0071229c : MOV EAX,dword ptr [ESI + 0x40]
0071229f : MOV ECX,dword ptr [ESI + 0x3c]
007122a2 : MOV DX,word ptr [ESI + 0x64]
007122a6 : MOV word ptr [ECX + EAX*0x2],DX
007122aa : ADD dword ptr [ESI + 0x70],-0x1
007122ae : JNZ 0x00712255
007122b0 : INC dword ptr [ESI + 0x64]
007122b3 : CMP dword ptr [EBP + 0x8],0x0
007122b7 : MOV EAX,dword ptr [ESI + 0x64]
007122ba : MOV dword ptr [EBP + -0x4],EBX
007122bd : MOV dword ptr [ESI + 0x60],0x0
007122c4 : MOV dword ptr [ESI + 0x58],0x2
007122cb : JZ 0x00712080
007122d1 : MOV EDX,dword ptr [ESI + 0x54]
007122d4 : TEST EDX,EDX
007122d6 : JL 0x007122df
007122d8 : MOV ECX,dword ptr [ESI + 0x30]
007122db : ADD ECX,EDX
007122dd : JMP 0x007122e1
007122df : XOR ECX,ECX
007122e1 : SUB EAX,EDX
007122e3 : PUSH EAX
007122e4 : PUSH ECX
007122e5 : XOR EDI,EDI
007122e7 : MOV EAX,ESI
007122e9 : CALL 0x0070fce0
007122ee : MOV EAX,dword ptr [ESI + 0x64]
007122f1 : MOV dword ptr [ESI + 0x54],EAX
007122f4 : MOV EAX,dword ptr [ESI]
007122f6 : ADD ESP,0x8
007122f9 : CALL 0x00711800
007122fe : MOV ECX,dword ptr [ESI]
00712300 : CMP dword ptr [ECX + 0x10],EDI
00712303 : JNZ 0x00712080
00712309 : POP EDI
0071230a : POP ESI
0071230b : XOR EAX,EAX
0071230d : POP EBX
0071230e : MOV ESP,EBP
00712310 : POP EBP
00712311 : RET
00712312 : CMP dword ptr [ESI + 0x60],0x0
00712316 : JZ 0x007123af
0071231c : MOV EDX,dword ptr [ESI + 0x64]
0071231f : MOV EAX,dword ptr [ESI + 0x30]
00712322 : MOV AL,byte ptr [EDX + EAX*0x1 + -0x1]
00712326 : MOV ECX,dword ptr [ESI + 0x1698]
0071232c : MOV EDX,dword ptr [ESI + 0x169c]
00712332 : XOR EDI,EDI
00712334 : MOV word ptr [EDX + ECX*0x2],DI
00712338 : MOV ECX,dword ptr [ESI + 0x1690]
0071233e : MOV EDX,dword ptr [ESI + 0x1698]
00712344 : MOV byte ptr [ECX + EDX*0x1],AL
00712347 : INC dword ptr [ESI + 0x1698]
0071234d : MOVZX EAX,AL
00712350 : INC word ptr [ESI + EAX*0x4 + 0x8c]
00712358 : MOV ECX,dword ptr [ESI + 0x1694]
0071235e : LEA EAX,[ESI + EAX*0x4 + 0x8c]
00712365 : DEC ECX
00712366 : CMP dword ptr [ESI + 0x1698],ECX
0071236c : JNZ 0x0071239e
0071236e : MOV ECX,dword ptr [ESI + 0x54]
00712371 : TEST ECX,ECX
00712373 : JL 0x0071237c
00712375 : MOV EAX,dword ptr [ESI + 0x30]
00712378 : ADD EAX,ECX
0071237a : JMP 0x0071237e
0071237c : XOR EAX,EAX
0071237e : MOV EDX,dword ptr [ESI + 0x64]
00712381 : SUB EDX,ECX
00712383 : PUSH EDX
00712384 : PUSH EAX
00712385 : XOR EDI,EDI
00712387 : MOV EAX,ESI
00712389 : CALL 0x0070fce0
0071238e : MOV EAX,dword ptr [ESI + 0x64]
00712391 : MOV dword ptr [ESI + 0x54],EAX
00712394 : MOV EAX,dword ptr [ESI]
00712396 : ADD ESP,0x8
00712399 : CALL 0x00711800
0071239e : MOV ECX,dword ptr [ESI]
007123a0 : INC dword ptr [ESI + 0x64]
007123a3 : DEC dword ptr [ESI + 0x6c]
007123a6 : CMP dword ptr [ECX + 0x10],0x0
007123aa : JMP 0x00712303
007123af : MOV EAX,0x1
007123b4 : ADD dword ptr [ESI + 0x64],EAX
007123b7 : DEC dword ptr [ESI + 0x6c]
007123ba : MOV dword ptr [ESI + 0x60],EAX
007123bd : JMP 0x00712080
007123c2 : CMP dword ptr [ESI + 0x60],0x0
007123c6 : JZ 0x0071240e
007123c8 : MOV EDX,dword ptr [ESI + 0x64]
007123cb : MOV EAX,dword ptr [ESI + 0x30]
007123ce : MOV AL,byte ptr [EDX + EAX*0x1 + -0x1]
007123d2 : MOV ECX,dword ptr [ESI + 0x1698]
007123d8 : MOV EDX,dword ptr [ESI + 0x169c]
007123de : XOR EDI,EDI
007123e0 : MOV word ptr [EDX + ECX*0x2],DI
007123e4 : MOV EDX,dword ptr [ESI + 0x1698]
007123ea : MOV ECX,dword ptr [ESI + 0x1690]
007123f0 : MOV byte ptr [ECX + EDX*0x1],AL
007123f3 : INC dword ptr [ESI + 0x1698]
007123f9 : MOVZX EAX,AL
007123fc : INC word ptr [ESI + EAX*0x4 + 0x8c]
00712404 : LEA EAX,[ESI + EAX*0x4 + 0x8c]
0071240b : MOV dword ptr [ESI + 0x60],EDI
0071240e : MOV ECX,dword ptr [ESI + 0x54]
00712411 : TEST ECX,ECX
00712413 : JL 0x0071241c
00712415 : MOV EAX,dword ptr [ESI + 0x30]
00712418 : ADD EAX,ECX
0071241a : JMP 0x0071241e
0071241c : XOR EAX,EAX
0071241e : MOV EDI,dword ptr [ESI + 0x64]
00712421 : XOR EDX,EDX
00712423 : MOV EBX,0x4
00712428 : CMP dword ptr [EBP + 0xc],EBX
0071242b : SETZ DL
0071242e : SUB EDI,ECX
00712430 : PUSH EDI
00712431 : PUSH EAX
00712432 : MOV EAX,ESI
00712434 : MOV EDI,EDX
00712436 : CALL 0x0070fce0
0071243b : MOV EAX,dword ptr [ESI + 0x64]
0071243e : MOV dword ptr [ESI + 0x54],EAX
00712441 : MOV EAX,dword ptr [ESI]
00712443 : ADD ESP,0x8
00712446 : CALL 0x00711800
0071244b : MOV ECX,dword ptr [ESI]
0071244d : XOR EAX,EAX
0071244f : CMP dword ptr [ECX + 0x10],EAX
00712452 : JNZ 0x00712465
00712454 : CMP dword ptr [EBP + 0xc],EBX
00712457 : POP EDI
00712458 : SETNZ AL
0071245b : POP ESI
0071245c : POP EBX
0071245d : DEC EAX
0071245e : AND EAX,0x2
00712461 : MOV ESP,EBP
00712463 : POP EBP
00712464 : RET
00712465 : CMP dword ptr [EBP + 0xc],EBX
00712468 : POP EDI
00712469 : SETZ AL
0071246c : POP ESI
0071246d : POP EBX
0071246e : LEA EAX,[EAX + EAX*0x1 + 0x1]
00712472 : MOV ESP,EBP
00712474 : POP EBP
00712475 : RET

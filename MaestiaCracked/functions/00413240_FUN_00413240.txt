PROGRAM  : Maestia.exe
FUNCTION : FUN_00413240
ENTRY    : 00413240
BODY     : [[00413240, 004132de]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00413240(uint param_1,undefined4 param_2)

{
  int in_ECX;
  
  if (param_1 == 0xffffffff) {
    FUN_00622ecf();
  }
  else if (param_1 < 0x7fffffff) goto LAB_00413263;
  FUN_00622ecf();
LAB_00413263:
  if (*(uint *)(in_ECX + 0x18) < param_1) {
    FUN_00406170(param_1,*(undefined4 *)(in_ECX + 0x14));
  }
  else if (param_1 == 0) {
    *(undefined4 *)(in_ECX + 0x14) = 0;
    if (7 < *(uint *)(in_ECX + 0x18)) {
      **(undefined2 **)(in_ECX + 4) = 0;
      return;
    }
    *(undefined2 *)(in_ECX + 4) = 0;
    return;
  }
  if (param_1 != 0) {
    FUN_004132e0(0,param_1,param_2);
    *(uint *)(in_ECX + 0x14) = param_1;
    if (7 < *(uint *)(in_ECX + 0x18)) {
      *(undefined2 *)(*(int *)(in_ECX + 4) + param_1 * 2) = 0;
      return;
    }
    *(undefined2 *)(in_ECX + 4 + param_1 * 2) = 0;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00413240 : PUSH EBP
00413241 : MOV EBP,ESP
00413243 : PUSH ESI
00413244 : PUSH EDI
00413245 : MOV EDI,dword ptr [EBP + 0x8]
00413248 : MOV ESI,ECX
0041324a : CMP EDI,-0x1
0041324d : JNZ 0x00413256
0041324f : CALL 0x00622ecf
00413254 : JMP 0x0041325e
00413256 : CMP EDI,0x7ffffffe
0041325c : JBE 0x00413263
0041325e : CALL 0x00622ecf
00413263 : MOV EAX,dword ptr [ESI + 0x18]
00413266 : CMP EAX,EDI
00413268 : JNC 0x004132a2
0041326a : MOV EAX,dword ptr [ESI + 0x14]
0041326d : PUSH EAX
0041326e : PUSH EDI
0041326f : MOV ECX,ESI
00413271 : CALL 0x00406170
00413276 : TEST EDI,EDI
00413278 : JBE 0x004132d7
0041327a : MOV EDX,dword ptr [EBP + 0xc]
0041327d : PUSH EDX
0041327e : PUSH EDI
0041327f : PUSH 0x0
00413281 : MOV ECX,ESI
00413283 : CALL 0x004132e0
00413288 : CMP dword ptr [ESI + 0x18],0x8
0041328c : MOV dword ptr [ESI + 0x14],EDI
0041328f : JC 0x004132ce
00413291 : MOV EAX,dword ptr [ESI + 0x4]
00413294 : XOR ECX,ECX
00413296 : MOV word ptr [EAX + EDI*0x2],CX
0041329a : POP EDI
0041329b : MOV EAX,ESI
0041329d : POP ESI
0041329e : POP EBP
0041329f : RET 0x8
004132a2 : TEST EDI,EDI
004132a4 : JNZ 0x00413278
004132a6 : MOV dword ptr [ESI + 0x14],EDI
004132a9 : CMP EAX,0x8
004132ac : JC 0x004132be
004132ae : MOV EAX,dword ptr [ESI + 0x4]
004132b1 : XOR ECX,ECX
004132b3 : MOV word ptr [EAX],CX
004132b6 : POP EDI
004132b7 : MOV EAX,ESI
004132b9 : POP ESI
004132ba : POP EBP
004132bb : RET 0x8
004132be : LEA EAX,[ESI + 0x4]
004132c1 : XOR ECX,ECX
004132c3 : MOV word ptr [EAX],CX
004132c6 : POP EDI
004132c7 : MOV EAX,ESI
004132c9 : POP ESI
004132ca : POP EBP
004132cb : RET 0x8
004132ce : LEA EAX,[ESI + 0x4]
004132d1 : XOR ECX,ECX
004132d3 : MOV word ptr [EAX + EDI*0x2],CX
004132d7 : POP EDI
004132d8 : MOV EAX,ESI
004132da : POP ESI
004132db : POP EBP
004132dc : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_007b9e70
ENTRY    : 007b9e70
BODY     : [[007b9e70, 007b9f77]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007b9e70(void)

{
  int *piVar1;
  uint uVar2;
  int iVar3;
  int unaff_EDI;
  wchar_t *pwVar4;
  undefined1 local_34 [4];
  undefined2 local_30;
  undefined4 local_20;
  uint local_1c;
  undefined **local_18;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b283fe;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(int *)(DAT_017251ac + 0x18) == 0) {
    pwVar4 = L"[AvaExtSceneMgr::RestoreLakeTexture] Device NULL Error";
  }
  else {
    FUN_00406460(L"WaveBump2.dds");
    local_8 = 0;
    iVar3 = (**(code **)(*DAT_01725204 + 4))(&local_18,local_34);
    local_8._0_1_ = 1;
    piVar1 = *(int **)(unaff_EDI + 0x184);
    if (piVar1 != *(int **)(iVar3 + 4)) {
      if (piVar1 != (int *)0x0) {
        (**(code **)(*piVar1 + 0x30))();
      }
      if (*(int *)(iVar3 + 4) != 0) {
        InterlockedIncrement((LONG *)(*(int *)(iVar3 + 4) + 0x2c));
      }
      *(undefined4 *)(unaff_EDI + 0x184) = *(undefined4 *)(iVar3 + 4);
    }
    local_8 = (uint)local_8._1_3_ << 8;
    local_18 = &PTR_FUN_00cd4964;
    if (local_14 != (int *)0x0) {
      (**(code **)(*local_14 + 0x30))();
      local_14 = (int *)0x0;
    }
    local_8 = 0xffffffff;
    if (7 < local_1c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_1c = 7;
    local_20 = 0;
    local_30 = 0;
    if (*(int *)(unaff_EDI + 0x184) != 0) {
      ExceptionList = local_10;
      return;
    }
    pwVar4 = L"[AvaExtSceneMgr::RestoreLakeTexture] Bump Texture Load Error";
  }
  local_8 = 0xffffffff;
  FUN_008018d0(pwVar4,uVar2);
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
007b9e70 : PUSH EBP
007b9e71 : MOV EBP,ESP
007b9e73 : PUSH -0x1
007b9e75 : PUSH 0xb283fe
007b9e7a : MOV EAX,FS:[0x0]
007b9e80 : PUSH EAX
007b9e81 : SUB ESP,0x28
007b9e84 : PUSH EBX
007b9e85 : PUSH ESI
007b9e86 : MOV EAX,[0x00d66fa0]
007b9e8b : XOR EAX,EBP
007b9e8d : PUSH EAX
007b9e8e : LEA EAX,[EBP + -0xc]
007b9e91 : MOV FS:[0x0],EAX
007b9e97 : MOV EAX,[0x017251ac]
007b9e9c : MOV EAX,dword ptr [EAX + 0x18]
007b9e9f : XOR EBX,EBX
007b9ea1 : CMP EAX,EBX
007b9ea3 : JNZ 0x007b9eaf
007b9ea5 : PUSH 0xc18aa0
007b9eaa : JMP 0x007b9f59
007b9eaf : PUSH 0xc18b10
007b9eb4 : LEA ECX,[EBP + -0x30]
007b9eb7 : CALL 0x00406460
007b9ebc : MOV dword ptr [EBP + -0x4],EBX
007b9ebf : MOV ECX,dword ptr [0x01725204]
007b9ec5 : MOV EDX,dword ptr [ECX]
007b9ec7 : MOV EDX,dword ptr [EDX + 0x4]
007b9eca : LEA EAX,[EBP + -0x30]
007b9ecd : PUSH EAX
007b9ece : LEA EAX,[EBP + -0x14]
007b9ed1 : PUSH EAX
007b9ed2 : CALL EDX
007b9ed4 : MOV ESI,EAX
007b9ed6 : MOV byte ptr [EBP + -0x4],0x1
007b9eda : MOV EAX,dword ptr [ESI + 0x4]
007b9edd : MOV ECX,dword ptr [EDI + 0x184]
007b9ee3 : CMP ECX,EAX
007b9ee5 : JZ 0x007b9f0c
007b9ee7 : CMP ECX,EBX
007b9ee9 : JZ 0x007b9ef2
007b9eeb : MOV EAX,dword ptr [ECX]
007b9eed : MOV EDX,dword ptr [EAX + 0x30]
007b9ef0 : CALL EDX
007b9ef2 : MOV EAX,dword ptr [ESI + 0x4]
007b9ef5 : CMP EAX,EBX
007b9ef7 : JZ 0x007b9f03
007b9ef9 : ADD EAX,0x2c
007b9efc : PUSH EAX
007b9efd : CALL dword ptr [0x00b850dc]
007b9f03 : MOV EAX,dword ptr [ESI + 0x4]
007b9f06 : MOV dword ptr [EDI + 0x184],EAX
007b9f0c : MOV byte ptr [EBP + -0x4],BL
007b9f0f : MOV ECX,dword ptr [EBP + -0x10]
007b9f12 : MOV dword ptr [EBP + -0x14],0xcd4964
007b9f19 : CMP ECX,EBX
007b9f1b : JZ 0x007b9f27
007b9f1d : MOV EDX,dword ptr [ECX]
007b9f1f : MOV EAX,dword ptr [EDX + 0x30]
007b9f22 : CALL EAX
007b9f24 : MOV dword ptr [EBP + -0x10],EBX
007b9f27 : MOV dword ptr [EBP + -0x4],0xffffffff
007b9f2e : CMP dword ptr [EBP + -0x18],0x8
007b9f32 : JC 0x007b9f3c
007b9f34 : MOV ECX,dword ptr [EBP + -0x2c]
007b9f37 : CALL 0x006f04e0
007b9f3c : XOR ECX,ECX
007b9f3e : MOV dword ptr [EBP + -0x18],0x7
007b9f45 : MOV dword ptr [EBP + -0x1c],EBX
007b9f48 : MOV word ptr [EBP + -0x2c],CX
007b9f4c : CMP dword ptr [EDI + 0x184],EBX
007b9f52 : JNZ 0x007b9f67
007b9f54 : PUSH 0xc18b40
007b9f59 : MOV ESI,dword ptr [0x00da98e8]
007b9f5f : CALL 0x008018d0
007b9f64 : ADD ESP,0x4
007b9f67 : MOV ECX,dword ptr [EBP + -0xc]
007b9f6a : MOV dword ptr FS:[0x0],ECX
007b9f71 : POP ECX
007b9f72 : POP ESI
007b9f73 : POP EBX
007b9f74 : MOV ESP,EBP
007b9f76 : POP EBP
007b9f77 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_0044e630
ENTRY    : 0044e630
BODY     : [[0044e630, 0044e74e] [0044e752, 0044e76c] [0044e7b1, 0044e826] [0044e844, 0044e8b8]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0044e630(uint param_1,int param_2)

{
  uint uVar1;
  int iVar2;
  uint *puVar3;
  int iVar4;
  undefined4 uVar5;
  undefined4 in_ECX;
  uint extraout_ECX;
  uint uStack_7c;
  uint local_64;
  uint local_60;
  undefined1 local_5c [68];
  uint local_18;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7f8b4;
  local_10 = ExceptionList;
  uStack_7c = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&uStack_7c;
  ExceptionList = &local_10;
  iVar4 = *(int *)(param_1 + 4);
  if (iVar4 == 0) {
    local_64 = 0;
  }
  else {
    local_64 = *(int *)(param_1 + 0xc) - iVar4 >> 6;
  }
  iVar2 = *(int *)(param_1 + 8);
  iVar4 = iVar2 - iVar4 >> 6;
  local_18 = uStack_7c;
  puVar3 = &uStack_7c;
  if (iVar4 == 0x3ffffff) {
    iVar4 = FUN_00452880();
    local_64 = extraout_ECX;
    puVar3 = (uint *)local_14;
  }
  local_14 = (undefined1 *)puVar3;
  uVar1 = iVar4 + 1;
  if (local_64 < uVar1) {
    if (0x3ffffff - (local_64 >> 1) < local_64) {
      local_64 = 0;
    }
    else {
      local_64 = local_64 + (local_64 >> 1);
    }
    if (local_64 < uVar1) {
      local_64 = uVar1;
    }
    iVar4 = FUN_0044ec30();
    local_8 = 0;
    FUN_0044e600();
    FUN_0044e8c0(*(undefined4 *)(param_1 + 4),param_2);
    FUN_0044e8c0(param_2,*(undefined4 *)(param_1 + 8));
    local_8 = 0xffffffff;
    if (*(int *)(param_1 + 4) != 0) {
      FUN_0044ebb0();
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    *(uint *)(param_1 + 0xc) = local_64 * 0x40 + iVar4;
    *(int *)(param_1 + 8) =
         ((*(int *)(param_1 + 8) - *(int *)(param_1 + 4) >> 6) + 1) * 0x40 + iVar4;
    *(int *)(param_1 + 4) = iVar4;
  }
  else {
    FUN_0043d400(local_5c,in_ECX);
    if (iVar2 - param_2 >> 6 == 0) {
      local_8 = 2;
      FUN_0044e8c0(param_2,*(undefined4 *)(param_1 + 8));
      local_8 = CONCAT31(local_8._1_3_,3);
      FUN_0044e600();
      local_8 = 2;
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 0x40;
      FUN_0044e9a0(*(int *)(param_1 + 8) + -0x40);
    }
    else {
      local_8 = 5;
      uVar5 = FUN_0044e8c0(*(int *)(param_1 + 8) + -0x40,*(int *)(param_1 + 8));
      *(undefined4 *)(param_1 + 8) = uVar5;
      local_60 = param_1 & 0xffffff00;
      FUN_0044e9f0(param_2,local_60,local_60,local_60);
      FUN_0044e9a0(param_2 + 0x40);
    }
    local_8 = 0xffffffff;
    FUN_0044ca10(local_5c);
  }
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0044e630 : PUSH EBP
0044e631 : MOV EBP,ESP
0044e633 : PUSH -0x1
0044e635 : PUSH 0xb7f8b4
0044e63a : MOV EAX,FS:[0x0]
0044e640 : PUSH EAX
0044e641 : SUB ESP,0x5c
0044e644 : MOV EAX,[0x00d66fa0]
0044e649 : XOR EAX,EBP
0044e64b : MOV dword ptr [EBP + -0x14],EAX
0044e64e : PUSH EBX
0044e64f : PUSH ESI
0044e650 : PUSH EDI
0044e651 : PUSH EAX
0044e652 : LEA EAX,[EBP + -0xc]
0044e655 : MOV FS:[0x0],EAX
0044e65b : MOV dword ptr [EBP + -0x10],ESP
0044e65e : MOV EBX,dword ptr [EBP + 0x8]
0044e661 : MOV dword ptr [EBP + -0x5c],EBX
0044e664 : MOV ESI,ECX
0044e666 : MOV EDX,dword ptr [EBX + 0x4]
0044e669 : TEST EDX,EDX
0044e66b : JNZ 0x0044e671
0044e66d : XOR ECX,ECX
0044e66f : JMP 0x0044e67b
0044e671 : MOV EAX,dword ptr [EBX + 0xc]
0044e674 : SUB EAX,EDX
0044e676 : SAR EAX,0x6
0044e679 : MOV ECX,EAX
0044e67b : MOV EDI,dword ptr [EBX + 0x8]
0044e67e : MOV EAX,EDI
0044e680 : SUB EAX,EDX
0044e682 : SAR EAX,0x6
0044e685 : MOV EDX,0x3ffffff
0044e68a : SUB EDX,EAX
0044e68c : CMP EDX,0x1
0044e68f : JNC 0x0044e696
0044e691 : CALL 0x00452880
0044e696 : LEA EDX,[EAX + 0x1]
0044e699 : CMP ECX,EDX
0044e69b : JNC 0x0044e7b1
0044e6a1 : MOV EAX,ECX
0044e6a3 : SHR EAX,0x1
0044e6a5 : MOV EDI,0x3ffffff
0044e6aa : SUB EDI,EAX
0044e6ac : CMP EDI,ECX
0044e6ae : JNC 0x0044e6bc
0044e6b0 : MOV dword ptr [EBP + -0x60],0x0
0044e6b7 : MOV ECX,dword ptr [EBP + -0x60]
0044e6ba : JMP 0x0044e6c1
0044e6bc : ADD ECX,EAX
0044e6be : MOV dword ptr [EBP + -0x60],ECX
0044e6c1 : CMP ECX,EDX
0044e6c3 : JNC 0x0044e6ca
0044e6c5 : MOV dword ptr [EBP + -0x60],EDX
0044e6c8 : MOV ECX,EDX
0044e6ca : CALL 0x0044ec30
0044e6cf : MOV dword ptr [EBP + -0x68],EAX
0044e6d2 : MOV EDI,dword ptr [EBP + 0xc]
0044e6d5 : SUB EDI,dword ptr [EBX + 0x4]
0044e6d8 : SAR EDI,0x6
0044e6db : MOV dword ptr [EBP + -0x5c],EDI
0044e6de : XOR ECX,ECX
0044e6e0 : MOV dword ptr [EBP + -0x64],ECX
0044e6e3 : MOV dword ptr [EBP + -0x4],ECX
0044e6e6 : SHL EDI,0x6
0044e6e9 : ADD EDI,EAX
0044e6eb : MOV EDX,ESI
0044e6ed : LEA ESI,[ECX + 0x1]
0044e6f0 : CALL 0x0044e600
0044e6f5 : MOV dword ptr [EBP + -0x64],ESI
0044e6f8 : MOV EAX,dword ptr [EBP + 0xc]
0044e6fb : PUSH EAX
0044e6fc : MOV ECX,dword ptr [EBX + 0x4]
0044e6ff : PUSH ECX
0044e700 : MOV EDI,dword ptr [EBP + -0x68]
0044e703 : MOV EDX,EDI
0044e705 : CALL 0x0044e8c0
0044e70a : MOV dword ptr [EBP + -0x64],0x2
0044e711 : MOV EDX,dword ptr [EBP + -0x5c]
0044e714 : INC EDX
0044e715 : SHL EDX,0x6
0044e718 : ADD EDX,EDI
0044e71a : MOV EAX,dword ptr [EBX + 0x8]
0044e71d : PUSH EAX
0044e71e : MOV ECX,dword ptr [EBP + 0xc]
0044e721 : PUSH ECX
0044e722 : CALL 0x0044e8c0
0044e727 : MOV dword ptr [EBP + -0x4],0xffffffff
0044e72e : MOV ECX,dword ptr [EBX + 0x8]
0044e731 : MOV EAX,dword ptr [EBX + 0x4]
0044e734 : MOV ESI,ECX
0044e736 : SUB ESI,EAX
0044e738 : SAR ESI,0x6
0044e73b : INC ESI
0044e73c : TEST EAX,EAX
0044e73e : JZ 0x0044e752
0044e740 : MOV EDI,ECX
0044e742 : CALL 0x0044ebb0
0044e747 : MOV ECX,dword ptr [EBX + 0x4]
0044e74a : CALL 0x006f04e0
0044e752 : MOV EAX,dword ptr [EBP + -0x60]
0044e755 : SHL EAX,0x6
0044e758 : ADD EAX,EDI
0044e75a : MOV dword ptr [EBX + 0xc],EAX
0044e75d : SHL ESI,0x6
0044e760 : ADD ESI,EDI
0044e762 : MOV dword ptr [EBX + 0x8],ESI
0044e765 : MOV dword ptr [EBX + 0x4],EDI
0044e768 : JMP 0x0044e89b
0044e7b1 : SUB EDI,dword ptr [EBP + 0xc]
0044e7b4 : SAR EDI,0x6
0044e7b7 : PUSH ESI
0044e7b8 : LEA EDX,[EBP + -0x58]
0044e7bb : PUSH EDX
0044e7bc : CALL 0x0043d400
0044e7c1 : CMP EDI,0x1
0044e7c4 : JNC 0x0044e844
0044e7c6 : MOV dword ptr [EBP + -0x4],0x2
0044e7cd : MOV EAX,dword ptr [EBP + 0xc]
0044e7d0 : LEA EDX,[EAX + 0x40]
0044e7d3 : MOV ECX,dword ptr [EBX + 0x8]
0044e7d6 : PUSH ECX
0044e7d7 : PUSH EAX
0044e7d8 : CALL 0x0044e8c0
0044e7dd : MOV byte ptr [EBP + -0x4],0x3
0044e7e1 : MOV EDI,dword ptr [EBX + 0x8]
0044e7e4 : MOV EDX,EDI
0044e7e6 : SUB EDX,dword ptr [EBP + 0xc]
0044e7e9 : SAR EDX,0x6
0044e7ec : MOV ESI,0x1
0044e7f1 : SUB ESI,EDX
0044e7f3 : LEA EDX,[EBP + -0x58]
0044e7f6 : CALL 0x0044e600
0044e7fb : MOV dword ptr [EBP + -0x4],0x2
0044e802 : ADD dword ptr [EBX + 0x8],0x40
0044e806 : MOV EBX,dword ptr [EBX + 0x8]
0044e809 : LEA EAX,[EBX + -0x40]
0044e80c : PUSH EAX
0044e80d : LEA EDI,[EBP + -0x58]
0044e810 : MOV EAX,dword ptr [EBP + 0xc]
0044e813 : CALL 0x0044e9a0
0044e818 : ADD ESP,0x4
0044e81b : MOV dword ptr [EBP + -0x4],0xffffffff
0044e822 : MOV EAX,EDI
0044e824 : PUSH EAX
0044e825 : JMP 0x0044e896
0044e844 : MOV dword ptr [EBP + -0x4],0x5
0044e84b : MOV ESI,dword ptr [EBX + 0x8]
0044e84e : LEA EDI,[ESI + -0x40]
0044e851 : PUSH ESI
0044e852 : PUSH EDI
0044e853 : MOV EDX,ESI
0044e855 : CALL 0x0044e8c0
0044e85a : MOV dword ptr [EBX + 0x8],EAX
0044e85d : MOV byte ptr [EBP + -0x5c],0x0
0044e861 : MOV EAX,dword ptr [EBP + -0x5c]
0044e864 : PUSH EAX
0044e865 : MOV ECX,dword ptr [EBP + -0x5c]
0044e868 : PUSH ECX
0044e869 : MOV EDX,dword ptr [EBP + -0x5c]
0044e86c : PUSH EDX
0044e86d : MOV EAX,dword ptr [EBP + 0xc]
0044e870 : PUSH EAX
0044e871 : MOV EAX,ESI
0044e873 : MOV ECX,EDI
0044e875 : CALL 0x0044e9f0
0044e87a : MOV EAX,dword ptr [EBP + 0xc]
0044e87d : LEA ECX,[EAX + 0x40]
0044e880 : PUSH ECX
0044e881 : LEA EDI,[EBP + -0x58]
0044e884 : CALL 0x0044e9a0
0044e889 : ADD ESP,0x14
0044e88c : MOV dword ptr [EBP + -0x4],0xffffffff
0044e893 : MOV EDX,EDI
0044e895 : PUSH EDX
0044e896 : CALL 0x0044ca10
0044e89b : MOV ECX,dword ptr [EBP + -0xc]
0044e89e : MOV dword ptr FS:[0x0],ECX
0044e8a5 : POP ECX
0044e8a6 : POP EDI
0044e8a7 : POP ESI
0044e8a8 : POP EBX
0044e8a9 : MOV ECX,dword ptr [EBP + -0x14]
0044e8ac : XOR ECX,EBP
0044e8ae : CALL 0x00633e6b
0044e8b3 : MOV ESP,EBP
0044e8b5 : POP EBP
0044e8b6 : RET 0x8

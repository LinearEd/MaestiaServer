PROGRAM  : Maestia.exe
FUNCTION : FUN_008b1e50
ENTRY    : 008b1e50
BODY     : [[008b1e50, 008b1f87] [008b1f90, 008b234d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008b1e50(void)

{
  short sVar1;
  uint uVar2;
  uint uVar3;
  char cVar4;
  int iVar5;
  int iVar6;
  size_t sVar7;
  short *psVar8;
  int in_ECX;
  uint uVar9;
  undefined1 local_2a4 [4];
  undefined2 local_2a0;
  undefined4 local_290;
  uint local_28c;
  uint local_288;
  int local_284;
  int local_280;
  uint local_27c;
  int local_278;
  int local_274;
  uint local_270;
  int local_26c;
  int local_250;
  uint local_24c;
  uint local_248;
  undefined1 local_214 [256];
  short local_114;
  undefined1 local_112 [254];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3e41a;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_274 = in_ECX;
  FUN_0070d390(local_14);
  local_8 = 0;
  local_28c = 7;
  local_290 = 0;
  local_2a0 = 0;
  FUN_00406360(&PTR_LAB_00c4c274,2);
  local_8._0_1_ = 1;
  cVar4 = FUN_0070d850(in_ECX + 0x38,local_2a4,0,0);
  local_8 = (uint)local_8._1_3_ << 8;
  if (7 < local_28c) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_28c = 7;
  local_290 = 0;
  local_2a0 = 0;
  if (cVar4 == '\0') {
    FUN_0070d4c0();
LAB_008b1f21:
    local_8 = 0xffffffff;
    FUN_0070d710();
  }
  else {
    FUN_008b1ca0(in_ECX);
    for (local_27c = local_24c; 0 < (int)local_27c; local_27c = local_27c - local_284) {
      iVar6 = 0;
      local_280 = (**(code **)(local_26c + 0xc))(&local_288,4,1);
      iVar5 = (**(code **)(local_26c + 0xc))(&local_284,4,1);
      uVar9 = local_248;
      uVar3 = local_24c;
      local_280 = local_280 + iVar5;
      if (local_288 < 0xbadc374a) {
        if (local_288 == 0xbadc3749) {
          local_270 = 0;
          if (local_248 < local_24c) {
            if (local_248 + 2 < local_24c) {
              sVar7 = 2;
            }
            else {
              sVar7 = local_24c - local_248;
            }
            _memcpy(&local_270,(void *)(local_250 + local_248),sVar7);
            uVar2 = local_270;
            uVar9 = uVar9 + sVar7;
            local_248 = uVar9;
            if ((short)local_270 != 0) {
              _memset(&local_114,0,0x100);
              if (uVar9 < uVar3) {
                sVar7 = (uVar2 & 0xffff) * 2;
                if (uVar3 <= sVar7 + uVar9) {
                  sVar7 = uVar3 - uVar9;
                }
                _memcpy(&local_114,(void *)(local_250 + uVar9),sVar7);
                local_248 = uVar9 + sVar7;
              }
              psVar8 = &local_114;
              do {
                sVar1 = *psVar8;
                psVar8 = psVar8 + 1;
              } while (sVar1 != 0);
              FUN_00406360(&local_114,(int)psVar8 - (int)local_112 >> 1);
            }
          }
        }
        else {
          if (local_288 == 0x735a9934) {
            local_270 = 0;
            if (local_248 < local_24c) {
              if (local_248 + 4 < local_24c) {
                sVar7 = 4;
              }
              else {
                sVar7 = local_24c - local_248;
              }
              _memcpy(&local_270,(void *)(local_250 + local_248),sVar7);
              local_248 = uVar9 + sVar7;
              if (local_270 == 0x19770607) goto LAB_008b232d;
            }
            FUN_008018d0(L"[AvaUserData::LoadUserData]different file unique number");
            goto LAB_008b1f21;
          }
          if (local_288 == 0x832409be) {
            FUN_004304b0(in_ECX + 0x24,2,1);
          }
          else {
            if (local_288 != 0x983751ca) goto LAB_008b225c;
            local_278 = FUN_006f0760(0x20,".\\Options\\AvaUserData.cpp",0xce,0);
            local_8._0_1_ = 2;
            if (local_278 != 0) {
              iVar6 = FUN_00406b70(local_278);
            }
            local_8 = (uint)local_8._1_3_ << 8;
            local_278 = iVar6;
            FUN_00405c00(iVar6);
            *(undefined4 *)(iVar6 + 0x1c) = 0;
            local_270 = 0;
            _memset(local_214,0,0x100);
            FUN_004304b0(&local_270,2,1);
            FUN_004304b0(local_214,2,local_270 & 0xffff);
            FUN_00405c00(iVar6);
            FUN_004304b0((undefined4 *)(iVar6 + 0x1c),4,1);
            FUN_00449730();
          }
        }
      }
      else if (local_288 == 0xbedc8460) {
        if (local_248 < local_24c) {
          if (local_248 + 4 < local_24c) {
            sVar7 = 4;
          }
          else {
            sVar7 = local_24c - local_248;
          }
          _memcpy((void *)(local_274 + 4),(void *)(local_250 + local_248),sVar7);
          local_248 = uVar9 + sVar7;
        }
      }
      else {
        if (local_288 == 0xcba34a67) {
          local_270 = 0;
          if (local_248 < local_24c) {
            if (local_248 + 4 < local_24c) {
              sVar7 = 4;
            }
            else {
              sVar7 = local_24c - local_248;
            }
            _memcpy(&local_270,(void *)(local_250 + local_248),sVar7);
            local_248 = uVar9 + sVar7;
            if (local_270 == 0x19790901) goto LAB_008b232d;
          }
          FUN_008018d0(L"[AvaUserData::LoadUserData]different file version");
          goto LAB_008b1f21;
        }
LAB_008b225c:
        (**(code **)(local_26c + 0x24))(local_284 + -8);
      }
LAB_008b232d:
      in_ECX = local_274;
    }
    FUN_0070d4c0();
    local_8 = 0xffffffff;
    FUN_0070d710();
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008b1e50 : PUSH EBP
008b1e51 : MOV EBP,ESP
008b1e53 : PUSH -0x1
008b1e55 : PUSH 0xb3e41a
008b1e5a : MOV EAX,FS:[0x0]
008b1e60 : PUSH EAX
008b1e61 : SUB ESP,0x294
008b1e67 : MOV EAX,[0x00d66fa0]
008b1e6c : XOR EAX,EBP
008b1e6e : MOV dword ptr [EBP + -0x10],EAX
008b1e71 : PUSH EBX
008b1e72 : PUSH ESI
008b1e73 : PUSH EDI
008b1e74 : PUSH EAX
008b1e75 : LEA EAX,[EBP + -0xc]
008b1e78 : MOV FS:[0x0],EAX
008b1e7e : MOV EDI,ECX
008b1e80 : LEA ECX,[EBP + 0xfffffd98]
008b1e86 : MOV dword ptr [EBP + 0xfffffd90],EDI
008b1e8c : CALL 0x0070d390
008b1e91 : XOR EBX,EBX
008b1e93 : MOV dword ptr [EBP + -0x4],EBX
008b1e96 : PUSH 0x2
008b1e98 : XOR EAX,EAX
008b1e9a : MOV ESI,0x7
008b1e9f : PUSH 0xc4c274
008b1ea4 : LEA ECX,[EBP + 0xfffffd60]
008b1eaa : MOV dword ptr [EBP + 0xfffffd78],ESI
008b1eb0 : MOV dword ptr [EBP + 0xfffffd74],EBX
008b1eb6 : MOV word ptr [EBP + 0xfffffd64],AX
008b1ebd : CALL 0x00406360
008b1ec2 : MOV byte ptr [EBP + -0x4],0x1
008b1ec6 : PUSH EBX
008b1ec7 : PUSH EBX
008b1ec8 : LEA ECX,[EBP + 0xfffffd60]
008b1ece : PUSH ECX
008b1ecf : LEA EDX,[EDI + 0x38]
008b1ed2 : PUSH EDX
008b1ed3 : LEA EAX,[EBP + 0xfffffd98]
008b1ed9 : CALL 0x0070d850
008b1ede : TEST AL,AL
008b1ee0 : SETZ BL
008b1ee3 : MOV byte ptr [EBP + -0x4],0x0
008b1ee7 : CMP dword ptr [EBP + 0xfffffd78],0x8
008b1eee : JC 0x008b1efb
008b1ef0 : MOV ECX,dword ptr [EBP + 0xfffffd64]
008b1ef6 : CALL 0x006f04e0
008b1efb : MOV dword ptr [EBP + 0xfffffd78],ESI
008b1f01 : XOR ESI,ESI
008b1f03 : XOR EAX,EAX
008b1f05 : MOV dword ptr [EBP + 0xfffffd74],ESI
008b1f0b : MOV word ptr [EBP + 0xfffffd64],AX
008b1f12 : TEST BL,BL
008b1f14 : JZ 0x008b1f37
008b1f16 : LEA ECX,[EBP + 0xfffffd98]
008b1f1c : CALL 0x0070d4c0
008b1f21 : MOV dword ptr [EBP + -0x4],0xffffffff
008b1f28 : LEA ECX,[EBP + 0xfffffd98]
008b1f2e : CALL 0x0070d710
008b1f33 : XOR AL,AL
008b1f35 : JMP 0x008b1f6c
008b1f37 : PUSH EDI
008b1f38 : CALL 0x008b1ca0
008b1f3d : MOV EAX,dword ptr [EBP + 0xfffffdb8]
008b1f43 : CMP EAX,ESI
008b1f45 : MOV dword ptr [EBP + 0xfffffd88],EAX
008b1f4b : JG 0x008b1f96
008b1f4d : LEA ECX,[EBP + 0xfffffd98]
008b1f53 : CALL 0x0070d4c0
008b1f58 : MOV dword ptr [EBP + -0x4],0xffffffff
008b1f5f : LEA ECX,[EBP + 0xfffffd98]
008b1f65 : CALL 0x0070d710
008b1f6a : MOV AL,0x1
008b1f6c : MOV ECX,dword ptr [EBP + -0xc]
008b1f6f : MOV dword ptr FS:[0x0],ECX
008b1f76 : POP ECX
008b1f77 : POP EDI
008b1f78 : POP ESI
008b1f79 : POP EBX
008b1f7a : MOV ECX,dword ptr [EBP + -0x10]
008b1f7d : XOR ECX,EBP
008b1f7f : CALL 0x00633e6b
008b1f84 : MOV ESP,EBP
008b1f86 : POP EBP
008b1f87 : RET
008b1f90 : MOV EDI,dword ptr [EBP + 0xfffffd90]
008b1f96 : MOV EDX,dword ptr [EBP + 0xfffffd98]
008b1f9c : MOV EAX,dword ptr [EDX + 0xc]
008b1f9f : PUSH 0x1
008b1fa1 : PUSH 0x4
008b1fa3 : LEA ECX,[EBP + 0xfffffd7c]
008b1fa9 : PUSH ECX
008b1faa : LEA ECX,[EBP + 0xfffffd98]
008b1fb0 : CALL EAX
008b1fb2 : MOV EDX,dword ptr [EBP + 0xfffffd98]
008b1fb8 : PUSH 0x1
008b1fba : PUSH 0x4
008b1fbc : LEA ECX,[EBP + 0xfffffd80]
008b1fc2 : MOV dword ptr [EBP + 0xfffffd84],EAX
008b1fc8 : MOV EAX,dword ptr [EDX + 0xc]
008b1fcb : PUSH ECX
008b1fcc : LEA ECX,[EBP + 0xfffffd98]
008b1fd2 : CALL EAX
008b1fd4 : ADD dword ptr [EBP + 0xfffffd84],EAX
008b1fda : MOV EAX,dword ptr [EBP + 0xfffffd7c]
008b1fe0 : CMP EAX,0xbadc3749
008b1fe5 : JA 0x008b224a
008b1feb : JZ 0x008b216b
008b1ff1 : CMP EAX,0x735a9934
008b1ff6 : JZ 0x008b20fa
008b1ffc : CMP EAX,0x832409be
008b2001 : JZ 0x008b20e2
008b2007 : CMP EAX,0x983751ca
008b200c : JNZ 0x008b225c
008b2012 : PUSH ESI
008b2013 : PUSH 0xce
008b2018 : PUSH 0xc4c354
008b201d : PUSH 0x20
008b201f : CALL 0x006f0760
008b2024 : ADD ESP,0x10
008b2027 : MOV dword ptr [EBP + 0xfffffd8c],EAX
008b202d : MOV byte ptr [EBP + -0x4],0x2
008b2031 : CMP EAX,ESI
008b2033 : JZ 0x008b203d
008b2035 : PUSH EAX
008b2036 : CALL 0x00406b70
008b203b : MOV ESI,EAX
008b203d : MOV byte ptr [EBP + -0x4],0x0
008b2041 : PUSH ESI
008b2042 : MOV EDX,0xc4c38c
008b2047 : MOV dword ptr [EBP + 0xfffffd8c],ESI
008b204d : CALL 0x00405c00
008b2052 : PUSH 0x100
008b2057 : LEA ECX,[EBP + 0xfffffdf0]
008b205d : PUSH 0x0
008b205f : LEA EDI,[ESI + 0x1c]
008b2062 : PUSH ECX
008b2063 : MOV dword ptr [EDI],0x0
008b2069 : MOV dword ptr [EBP + 0xfffffd94],0x0
008b2073 : CALL 0x0063b700
008b2078 : ADD ESP,0xc
008b207b : PUSH 0x1
008b207d : PUSH 0x2
008b207f : LEA EDX,[EBP + 0xfffffd94]
008b2085 : PUSH EDX
008b2086 : LEA ECX,[EBP + 0xfffffd98]
008b208c : CALL 0x004304b0
008b2091 : MOVZX EAX,word ptr [EBP + 0xfffffd94]
008b2098 : PUSH EAX
008b2099 : PUSH 0x2
008b209b : LEA ECX,[EBP + 0xfffffdf0]
008b20a1 : PUSH ECX
008b20a2 : LEA ECX,[EBP + 0xfffffd98]
008b20a8 : CALL 0x004304b0
008b20ad : PUSH ESI
008b20ae : LEA EDX,[EBP + 0xfffffdf0]
008b20b4 : CALL 0x00405c00
008b20b9 : PUSH 0x1
008b20bb : PUSH 0x4
008b20bd : PUSH EDI
008b20be : LEA ECX,[EBP + 0xfffffd98]
008b20c4 : CALL 0x004304b0
008b20c9 : MOV EDX,dword ptr [EBP + 0xfffffd90]
008b20cf : ADD EDX,0x28
008b20d2 : LEA EDI,[EBP + 0xfffffd8c]
008b20d8 : CALL 0x00449730
008b20dd : JMP 0x008b232d
008b20e2 : PUSH 0x1
008b20e4 : PUSH 0x2
008b20e6 : ADD EDI,0x24
008b20e9 : PUSH EDI
008b20ea : LEA ECX,[EBP + 0xfffffd98]
008b20f0 : CALL 0x004304b0
008b20f5 : JMP 0x008b232d
008b20fa : MOV EAX,dword ptr [EBP + 0xfffffdb8]
008b2100 : MOV dword ptr [EBP + 0xfffffd94],ESI
008b2106 : MOV ESI,dword ptr [EBP + 0xfffffdbc]
008b210c : CMP ESI,EAX
008b210e : JNC 0x008b2153
008b2110 : LEA EDX,[ESI + 0x4]
008b2113 : CMP EDX,EAX
008b2115 : JC 0x008b211d
008b2117 : SUB EAX,ESI
008b2119 : MOV EDI,EAX
008b211b : JMP 0x008b2122
008b211d : MOV EDI,0x4
008b2122 : MOV EAX,dword ptr [EBP + 0xfffffdb4]
008b2128 : PUSH EDI
008b2129 : ADD EAX,ESI
008b212b : PUSH EAX
008b212c : LEA ECX,[EBP + 0xfffffd94]
008b2132 : PUSH ECX
008b2133 : CALL 0x0063ae40
008b2138 : ADD ESI,EDI
008b213a : ADD ESP,0xc
008b213d : MOV dword ptr [EBP + 0xfffffdbc],ESI
008b2143 : CMP dword ptr [EBP + 0xfffffd94],0x19770607
008b214d : JZ 0x008b232d
008b2153 : MOV ESI,dword ptr [0x00da98e8]
008b2159 : PUSH 0xc4c280
008b215e : CALL 0x008018d0
008b2163 : ADD ESP,0x4
008b2166 : JMP 0x008b1f21
008b216b : MOV EDI,dword ptr [EBP + 0xfffffdb8]
008b2171 : MOV dword ptr [EBP + 0xfffffd94],ESI
008b2177 : MOV ESI,dword ptr [EBP + 0xfffffdbc]
008b217d : CMP ESI,EDI
008b217f : JNC 0x008b232d
008b2185 : LEA EDX,[ESI + 0x2]
008b2188 : CMP EDX,EDI
008b218a : JC 0x008b2192
008b218c : MOV EBX,EDI
008b218e : SUB EBX,ESI
008b2190 : JMP 0x008b2197
008b2192 : MOV EBX,0x2
008b2197 : MOV EAX,dword ptr [EBP + 0xfffffdb4]
008b219d : PUSH EBX
008b219e : ADD EAX,ESI
008b21a0 : PUSH EAX
008b21a1 : LEA ECX,[EBP + 0xfffffd94]
008b21a7 : PUSH ECX
008b21a8 : CALL 0x0063ae40
008b21ad : ADD ESI,EBX
008b21af : MOV dword ptr [EBP + 0xfffffdbc],ESI
008b21b5 : MOV EBX,dword ptr [EBP + 0xfffffd94]
008b21bb : ADD ESP,0xc
008b21be : TEST BX,BX
008b21c1 : JBE 0x008b232d
008b21c7 : PUSH 0x100
008b21cc : LEA EDX,[EBP + 0xfffffef0]
008b21d2 : PUSH 0x0
008b21d4 : PUSH EDX
008b21d5 : CALL 0x0063b700
008b21da : ADD ESP,0xc
008b21dd : MOVZX EAX,BX
008b21e0 : CMP ESI,EDI
008b21e2 : JNC 0x008b2214
008b21e4 : ADD EAX,EAX
008b21e6 : LEA ECX,[EAX + ESI*0x1]
008b21e9 : CMP ECX,EDI
008b21eb : JC 0x008b21f1
008b21ed : SUB EDI,ESI
008b21ef : JMP 0x008b21f3
008b21f1 : MOV EDI,EAX
008b21f3 : MOV EDX,dword ptr [EBP + 0xfffffdb4]
008b21f9 : PUSH EDI
008b21fa : ADD EDX,ESI
008b21fc : PUSH EDX
008b21fd : LEA EAX,[EBP + 0xfffffef0]
008b2203 : PUSH EAX
008b2204 : CALL 0x0063ae40
008b2209 : ADD ESP,0xc
008b220c : ADD ESI,EDI
008b220e : MOV dword ptr [EBP + 0xfffffdbc],ESI
008b2214 : LEA EAX,[EBP + 0xfffffef0]
008b221a : LEA EDX,[EAX + 0x2]
008b221d : LEA ECX,[ECX]
008b2220 : MOV CX,word ptr [EAX]
008b2223 : ADD EAX,0x2
008b2226 : TEST CX,CX
008b2229 : JNZ 0x008b2220
008b222b : SUB EAX,EDX
008b222d : SAR EAX,0x1
008b222f : PUSH EAX
008b2230 : LEA ECX,[EBP + 0xfffffef0]
008b2236 : PUSH ECX
008b2237 : MOV ECX,dword ptr [EBP + 0xfffffd90]
008b223d : ADD ECX,0x8
008b2240 : CALL 0x00406360
008b2245 : JMP 0x008b232d
008b224a : CMP EAX,0xbedc8460
008b224f : JZ 0x008b22e9
008b2255 : CMP EAX,0xcba34a67
008b225a : JZ 0x008b227c
008b225c : MOV EAX,dword ptr [EBP + 0xfffffd80]
008b2262 : MOV EDX,dword ptr [EBP + 0xfffffd98]
008b2268 : ADD EAX,-0x8
008b226b : PUSH EAX
008b226c : MOV EAX,dword ptr [EDX + 0x24]
008b226f : LEA ECX,[EBP + 0xfffffd98]
008b2275 : CALL EAX
008b2277 : JMP 0x008b232d
008b227c : MOV EAX,dword ptr [EBP + 0xfffffdb8]
008b2282 : MOV dword ptr [EBP + 0xfffffd94],ESI
008b2288 : MOV ESI,dword ptr [EBP + 0xfffffdbc]
008b228e : CMP ESI,EAX
008b2290 : JNC 0x008b22d1
008b2292 : LEA ECX,[ESI + 0x4]
008b2295 : CMP ECX,EAX
008b2297 : JC 0x008b229f
008b2299 : SUB EAX,ESI
008b229b : MOV EDI,EAX
008b229d : JMP 0x008b22a4
008b229f : MOV EDI,0x4
008b22a4 : MOV EDX,dword ptr [EBP + 0xfffffdb4]
008b22aa : PUSH EDI
008b22ab : ADD EDX,ESI
008b22ad : PUSH EDX
008b22ae : LEA EAX,[EBP + 0xfffffd94]
008b22b4 : PUSH EAX
008b22b5 : CALL 0x0063ae40
008b22ba : ADD ESI,EDI
008b22bc : ADD ESP,0xc
008b22bf : MOV dword ptr [EBP + 0xfffffdbc],ESI
008b22c5 : CMP dword ptr [EBP + 0xfffffd94],0x19790901
008b22cf : JZ 0x008b232d
008b22d1 : MOV ESI,dword ptr [0x00da98e8]
008b22d7 : PUSH 0xc4c2f0
008b22dc : CALL 0x008018d0
008b22e1 : ADD ESP,0x4
008b22e4 : JMP 0x008b1f21
008b22e9 : MOV ESI,dword ptr [EBP + 0xfffffdbc]
008b22ef : MOV EDI,dword ptr [EBP + 0xfffffdb8]
008b22f5 : CMP ESI,EDI
008b22f7 : JNC 0x008b232d
008b22f9 : LEA ECX,[ESI + 0x4]
008b22fc : CMP ECX,EDI
008b22fe : JC 0x008b2304
008b2300 : SUB EDI,ESI
008b2302 : JMP 0x008b2309
008b2304 : MOV EDI,0x4
008b2309 : MOV EDX,dword ptr [EBP + 0xfffffdb4]
008b230f : MOV EAX,dword ptr [EBP + 0xfffffd90]
008b2315 : PUSH EDI
008b2316 : ADD EDX,ESI
008b2318 : PUSH EDX
008b2319 : ADD EAX,0x4
008b231c : PUSH EAX
008b231d : CALL 0x0063ae40
008b2322 : ADD ESP,0xc
008b2325 : ADD ESI,EDI
008b2327 : MOV dword ptr [EBP + 0xfffffdbc],ESI
008b232d : MOV EAX,dword ptr [EBP + 0xfffffd88]
008b2333 : SUB EAX,dword ptr [EBP + 0xfffffd80]
008b2339 : XOR ESI,ESI
008b233b : CMP EAX,ESI
008b233d : MOV dword ptr [EBP + 0xfffffd88],EAX
008b2343 : JG 0x008b1f90
008b2349 : JMP 0x008b1f4d

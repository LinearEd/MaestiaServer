PROGRAM  : Maestia.exe
FUNCTION : FUN_00581210
ENTRY    : 00581210
BODY     : [[00581210, 0058140d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00581210(int param_1)

{
  int *piVar1;
  byte *pbVar2;
  char cVar3;
  int iVar4;
  LONG LVar5;
  uint local_54;
  undefined4 *local_50;
  undefined4 *local_4c;
  undefined4 *local_48;
  undefined4 *local_44;
  undefined1 local_40 [64];
  
  cVar3 = FUN_00526030(0x11);
  if (cVar3 != '\0') {
    if ((*(int *)(param_1 + 8) != 0) && (*(int *)(param_1 + 8) != 0x10)) {
      FUN_0040efe0(local_40,0x10,4,&LAB_004ffd10);
      FUN_00580c90(*(int *)(param_1 + 0x18) + 0x78,local_40);
      FUN_005272e0(&local_50,*(undefined4 *)(param_1 + 0x18),6,0);
      FUN_005272e0(&local_4c,*(undefined4 *)(param_1 + 0x18),6,0);
      FUN_005272e0(&local_48,*(undefined4 *)(param_1 + 0x18),6,0);
      FUN_005272e0(&local_44,*(undefined4 *)(param_1 + 0x18),6,0);
      FUN_0051b6e0();
      FUN_0051b950(&DAT_00b8db4c,0xffffffff);
      FUN_0051b950(*local_50,0xffffffff);
      FUN_0051b950(&DAT_00b8db44,0xffffffff);
      FUN_0051b950(*local_4c,0xffffffff);
      FUN_0051b950(", width=",0xffffffff);
      FUN_0051b950(*local_48,0xffffffff);
      FUN_0051b950(", height=",0xffffffff);
      FUN_0051b950(*local_44,0xffffffff);
      FUN_0051b950(&DAT_00b8db28,0xffffffff);
      iVar4 = FUN_00525450((local_54 & 0xfffffffc) + 8,*(uint *)(local_54 & 0xfffffffc) & 0x7fffffff
                          );
      *(int *)(iVar4 + 8) = *(int *)(iVar4 + 8) + 1;
      pbVar2 = *(byte **)(param_1 + 4);
      if (4 < *pbVar2) {
        FUN_00526400();
      }
      *pbVar2 = 5;
      *(int *)(pbVar2 + 4) = iVar4;
      *(int *)(iVar4 + 8) = *(int *)(iVar4 + 8) + 1;
      piVar1 = (int *)(iVar4 + 8);
      *piVar1 = *piVar1 + -1;
      if (*piVar1 == 0) {
        FUN_00525340();
      }
      LVar5 = InterlockedExchangeAdd((LONG *)((local_54 & 0xfffffffc) + 4),-1);
      if (LVar5 == 1) {
        FUN_00515cf0(local_54 & 0xfffffffc);
      }
      FUN_004ff770(&local_50,4,4,FUN_004ffc80);
      FUN_004ff770(local_40,0x10,4,FUN_00526bc0);
    }
    return;
  }
  FUN_00526050("Rectangle",0,0);
  return;
}



============================================================
DISASSEMBLY
============================================================
00581210 : SUB ESP,0x54
00581213 : PUSH ESI
00581214 : MOV ESI,dword ptr [ESP + 0x5c]
00581218 : PUSH 0x11
0058121a : MOV ECX,ESI
0058121c : CALL 0x00526030
00581221 : TEST AL,AL
00581223 : JNZ 0x0058123a
00581225 : PUSH 0x0
00581227 : PUSH 0x0
00581229 : PUSH 0xb8db1c
0058122e : MOV ECX,ESI
00581230 : CALL 0x00526050
00581235 : POP ESI
00581236 : ADD ESP,0x54
00581239 : RET
0058123a : MOV EAX,dword ptr [ESI + 0x8]
0058123d : TEST EAX,EAX
0058123f : JZ 0x00581409
00581245 : PUSH EDI
00581246 : LEA EDI,[EAX + -0x10]
00581249 : TEST EDI,EDI
0058124b : JZ 0x00581408
00581251 : PUSH 0x4ffd10
00581256 : PUSH 0x4
00581258 : PUSH 0x10
0058125a : LEA EAX,[ESP + 0x28]
0058125e : PUSH EAX
0058125f : CALL 0x0040efe0
00581264 : MOV EDX,dword ptr [ESI + 0x18]
00581267 : LEA ECX,[ESP + 0x1c]
0058126b : PUSH ECX
0058126c : ADD EDX,0x78
0058126f : PUSH EDX
00581270 : MOV ECX,EDI
00581272 : CALL 0x00580c90
00581277 : MOV EAX,dword ptr [ESI + 0x18]
0058127a : PUSH 0x0
0058127c : PUSH 0x6
0058127e : PUSH EAX
0058127f : LEA ECX,[ESP + 0x18]
00581283 : PUSH ECX
00581284 : LEA ECX,[ESP + 0x2c]
00581288 : CALL 0x005272e0
0058128d : MOV EDX,dword ptr [ESI + 0x18]
00581290 : PUSH 0x0
00581292 : PUSH 0x6
00581294 : PUSH EDX
00581295 : LEA EAX,[ESP + 0x1c]
00581299 : PUSH EAX
0058129a : LEA ECX,[ESP + 0x3c]
0058129e : CALL 0x005272e0
005812a3 : MOV ECX,dword ptr [ESI + 0x18]
005812a6 : PUSH 0x0
005812a8 : PUSH 0x6
005812aa : PUSH ECX
005812ab : LEA EDX,[ESP + 0x20]
005812af : PUSH EDX
005812b0 : LEA ECX,[ESP + 0x4c]
005812b4 : CALL 0x005272e0
005812b9 : MOV EAX,dword ptr [ESI + 0x18]
005812bc : PUSH 0x0
005812be : PUSH 0x6
005812c0 : PUSH EAX
005812c1 : LEA ECX,[ESP + 0x24]
005812c5 : PUSH ECX
005812c6 : LEA ECX,[ESP + 0x5c]
005812ca : CALL 0x005272e0
005812cf : LEA ECX,[ESP + 0x8]
005812d3 : CALL 0x0051b6e0
005812d8 : PUSH -0x1
005812da : PUSH 0xb8db4c
005812df : LEA ECX,[ESP + 0x10]
005812e3 : CALL 0x0051b950
005812e8 : MOV EDX,dword ptr [ESP + 0xc]
005812ec : MOV EAX,dword ptr [EDX]
005812ee : PUSH -0x1
005812f0 : PUSH EAX
005812f1 : LEA ECX,[ESP + 0x10]
005812f5 : CALL 0x0051b950
005812fa : PUSH -0x1
005812fc : PUSH 0xb8db44
00581301 : LEA ECX,[ESP + 0x10]
00581305 : CALL 0x0051b950
0058130a : MOV ECX,dword ptr [ESP + 0x10]
0058130e : MOV EDX,dword ptr [ECX]
00581310 : PUSH -0x1
00581312 : PUSH EDX
00581313 : LEA ECX,[ESP + 0x10]
00581317 : CALL 0x0051b950
0058131c : PUSH -0x1
0058131e : PUSH 0xb8db38
00581323 : LEA ECX,[ESP + 0x10]
00581327 : CALL 0x0051b950
0058132c : MOV EAX,dword ptr [ESP + 0x14]
00581330 : MOV ECX,dword ptr [EAX]
00581332 : PUSH -0x1
00581334 : PUSH ECX
00581335 : LEA ECX,[ESP + 0x10]
00581339 : CALL 0x0051b950
0058133e : PUSH -0x1
00581340 : PUSH 0xb8db2c
00581345 : LEA ECX,[ESP + 0x10]
00581349 : CALL 0x0051b950
0058134e : MOV EDX,dword ptr [ESP + 0x18]
00581352 : MOV EAX,dword ptr [EDX]
00581354 : PUSH -0x1
00581356 : PUSH EAX
00581357 : LEA ECX,[ESP + 0x10]
0058135b : CALL 0x0051b950
00581360 : PUSH -0x1
00581362 : PUSH 0xb8db28
00581367 : LEA ECX,[ESP + 0x10]
0058136b : CALL 0x0051b950
00581370 : MOV ECX,dword ptr [ESI + 0x18]
00581373 : MOV EDX,dword ptr [ECX + 0x78]
00581376 : MOV EAX,dword ptr [ESP + 0x8]
0058137a : MOV ECX,EAX
0058137c : AND ECX,0xfffffffc
0058137f : MOV ECX,dword ptr [ECX]
00581381 : AND ECX,0x7fffffff
00581387 : AND EAX,0xfffffffc
0058138a : PUSH ECX
0058138b : ADD EAX,0x8
0058138e : PUSH EAX
0058138f : LEA ECX,[EDX + 0x254]
00581395 : CALL 0x00525450
0058139a : MOV EDI,EAX
0058139c : INC dword ptr [EDI + 0x8]
0058139f : MOV ESI,dword ptr [ESI + 0x4]
005813a2 : CMP byte ptr [ESI],0x5
005813a5 : JC 0x005813ae
005813a7 : MOV ECX,ESI
005813a9 : CALL 0x00526400
005813ae : MOV byte ptr [ESI],0x5
005813b1 : MOV dword ptr [ESI + 0x4],EDI
005813b4 : INC dword ptr [EDI + 0x8]
005813b7 : ADD dword ptr [EDI + 0x8],-0x1
005813bb : JNZ 0x005813c4
005813bd : MOV ECX,EDI
005813bf : CALL 0x00525340
005813c4 : MOV ESI,dword ptr [ESP + 0x8]
005813c8 : AND ESI,0xfffffffc
005813cb : PUSH -0x1
005813cd : LEA EDX,[ESI + 0x4]
005813d0 : PUSH EDX
005813d1 : CALL dword ptr [0x00b851cc]
005813d7 : SUB EAX,0x1
005813da : JNZ 0x005813e2
005813dc : PUSH ESI
005813dd : CALL 0x00515cf0
005813e2 : PUSH 0x4ffc80
005813e7 : PUSH 0x4
005813e9 : PUSH 0x4
005813eb : LEA EAX,[ESP + 0x18]
005813ef : PUSH EAX
005813f0 : CALL 0x004ff770
005813f5 : PUSH 0x526bc0
005813fa : PUSH 0x4
005813fc : PUSH 0x10
005813fe : LEA ECX,[ESP + 0x28]
00581402 : PUSH ECX
00581403 : CALL 0x004ff770
00581408 : POP EDI
00581409 : POP ESI
0058140a : ADD ESP,0x54
0058140d : RET

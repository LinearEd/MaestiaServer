PROGRAM  : Maestia.exe
FUNCTION : FUN_007137c0
ENTRY    : 007137c0
BODY     : [[007137c0, 00713a6d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007137c0(void)

{
  void *pvVar1;
  int unaff_ESI;
  undefined1 local_4e4 [4];
  undefined2 local_4e0;
  undefined4 local_4d0;
  uint local_4cc;
  LPCRITICAL_SECTION local_4c8;
  char *local_4c4;
  undefined4 local_4c0;
  int local_4bc;
  undefined4 local_4b8;
  void *local_4b4;
  undefined **local_4b0;
  undefined1 local_4ac;
  undefined4 local_4a8;
  undefined4 local_4a4;
  FILE *local_4a0;
  undefined1 *local_49c;
  size_t local_498;
  undefined1 local_494 [1108];
  undefined4 local_40;
  void *local_3c;
  undefined4 local_38;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3b746;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  pvVar1 = _malloc(*(size_t *)(unaff_ESI + 0x60));
  local_4b4 = pvVar1;
  FUN_00a5d9f0(*(undefined4 *)(unaff_ESI + 4),local_30);
  local_4ac = 0;
  local_4a8 = 0;
  local_4a4 = 0;
  local_4b0 = &PTR_FUN_00cda538;
  local_4a0 = (FILE *)0x0;
  local_8._0_1_ = 1;
  local_8._1_3_ = 0;
  local_4c8 = (LPCRITICAL_SECTION)(*(int *)(unaff_ESI + 4) + 0xad8);
  local_4bc = 0;
  local_4c4 = ".\\MoVDFile.cpp";
  local_4c0 = 0x20b;
  local_4b8 = 1;
  FUN_006ef1a0(&local_4c8);
  local_8._0_1_ = 2;
  local_4e0 = 0;
  local_4cc = 7;
  local_4d0 = 0;
  FUN_00406360(&PTR_LAB_00c00e08,2);
  local_8._0_1_ = 3;
  FUN_0070a9a0(local_30,local_4e4);
  local_8 = CONCAT31(local_8._1_3_,2);
  if (7 < local_4cc) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_4e0 = 0;
  local_4cc = 7;
  local_4d0 = 0;
  if (local_4a0 != (FILE *)0x0) {
    __fseek_nolock(local_4a0,*(long *)(unaff_ESI + 0x5c),0);
  }
  if (local_4a0 != (FILE *)0x0) {
    __fread_nolock(pvVar1,*(size_t *)(unaff_ESI + 0x60),1,local_4a0);
    if (local_4a0 != (FILE *)0x0) {
      _fflush(local_4a0);
      _fclose(local_4a0);
      local_4a0 = (FILE *)0x0;
    }
  }
  local_38 = *(undefined4 *)(unaff_ESI + 0x60);
  local_49c = (undefined1 *)0x0;
  local_498 = 0;
  local_40 = 0;
  local_3c = pvVar1;
  FUN_004ce240();
  local_8._0_1_ = 4;
  pvVar1 = (void *)FUN_0070a3a0();
  *(void **)(unaff_ESI + 0x58) = pvVar1;
  *(undefined1 *)(unaff_ESI + 0xd4) = 1;
  _memcpy(pvVar1,local_49c,local_498);
  *(size_t *)(unaff_ESI + 0x60) = local_498;
  _free(local_4b4);
  local_8._0_1_ = 2;
  if ((local_49c != local_494) && (local_49c != (undefined1 *)0x0)) {
    _free(local_49c);
  }
  local_8._0_1_ = 1;
  if (local_4bc != 0) {
    LeaveCriticalSection(local_4c8);
    local_4bc = 0;
  }
  local_8 = (uint)local_8._1_3_ << 8;
  local_4b0 = &PTR_FUN_00cda538;
  if (local_4a0 != (FILE *)0x0) {
    _fflush(local_4a0);
    _fclose(local_4a0);
    local_4a0 = (FILE *)0x0;
  }
  local_8 = 0xffffffff;
  if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_18 = 7;
  local_1c = 0;
  local_2c = 0;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
007137c0 : PUSH EBP
007137c1 : MOV EBP,ESP
007137c3 : PUSH -0x1
007137c5 : PUSH 0xb3b746
007137ca : MOV EAX,FS:[0x0]
007137d0 : PUSH EAX
007137d1 : SUB ESP,0x4d8
007137d7 : MOV EAX,[0x00d66fa0]
007137dc : XOR EAX,EBP
007137de : MOV dword ptr [EBP + -0x10],EAX
007137e1 : PUSH EBX
007137e2 : PUSH EDI
007137e3 : PUSH EAX
007137e4 : LEA EAX,[EBP + -0xc]
007137e7 : MOV FS:[0x0],EAX
007137ed : MOV EAX,dword ptr [ESI + 0x60]
007137f0 : PUSH EAX
007137f1 : CALL 0x00636043
007137f6 : MOV EDX,dword ptr [ESI + 0x4]
007137f9 : ADD ESP,0x4
007137fc : LEA ECX,[EBP + -0x2c]
007137ff : PUSH ECX
00713800 : MOV EDI,EAX
00713802 : PUSH EDX
00713803 : MOV dword ptr [EBP + 0xfffffb50],EDI
00713809 : CALL 0x00a5d9f0
0071380e : XOR EBX,EBX
00713810 : MOV dword ptr [EBP + -0x4],EBX
00713813 : MOV dword ptr [EBP + 0xfffffb54],0xcd4c80
0071381d : MOV byte ptr [EBP + 0xfffffb58],BL
00713823 : MOV dword ptr [EBP + 0xfffffb5c],EBX
00713829 : MOV dword ptr [EBP + 0xfffffb60],EBX
0071382f : MOV dword ptr [EBP + 0xfffffb54],0xcda538
00713839 : MOV dword ptr [EBP + 0xfffffb64],EBX
0071383f : MOV byte ptr [EBP + -0x4],0x1
00713843 : MOV EAX,dword ptr [ESI + 0x4]
00713846 : ADD EAX,0xad8
0071384b : MOV dword ptr [EBP + 0xfffffb3c],EAX
00713851 : LEA EAX,[EBP + 0xfffffb3c]
00713857 : PUSH EAX
00713858 : MOV dword ptr [EBP + 0xfffffb48],EBX
0071385e : MOV dword ptr [EBP + 0xfffffb40],0xc00df8
00713868 : MOV dword ptr [EBP + 0xfffffb44],0x20b
00713872 : MOV dword ptr [EBP + 0xfffffb4c],0x1
0071387c : CALL 0x006ef1a0
00713881 : MOV byte ptr [EBP + -0x4],0x2
00713885 : XOR ECX,ECX
00713887 : PUSH 0x2
00713889 : MOV word ptr [EBP + 0xfffffb24],CX
00713890 : PUSH 0xc00e08
00713895 : LEA ECX,[EBP + 0xfffffb20]
0071389b : MOV dword ptr [EBP + 0xfffffb38],0x7
007138a5 : MOV dword ptr [EBP + 0xfffffb34],EBX
007138ab : CALL 0x00406360
007138b0 : MOV byte ptr [EBP + -0x4],0x3
007138b4 : LEA EDX,[EBP + 0xfffffb20]
007138ba : PUSH EDX
007138bb : LEA EAX,[EBP + -0x2c]
007138be : PUSH EAX
007138bf : LEA ECX,[EBP + 0xfffffb54]
007138c5 : CALL 0x0070a9a0
007138ca : MOV byte ptr [EBP + -0x4],0x2
007138ce : CMP dword ptr [EBP + 0xfffffb38],0x8
007138d5 : JC 0x007138e2
007138d7 : MOV ECX,dword ptr [EBP + 0xfffffb24]
007138dd : CALL 0x006f04e0
007138e2 : MOV EAX,dword ptr [EBP + 0xfffffb64]
007138e8 : XOR ECX,ECX
007138ea : MOV word ptr [EBP + 0xfffffb24],CX
007138f1 : MOV ECX,dword ptr [ESI + 0x5c]
007138f4 : MOV dword ptr [EBP + 0xfffffb38],0x7
007138fe : MOV dword ptr [EBP + 0xfffffb34],EBX
00713904 : CMP EAX,EBX
00713906 : JZ 0x00713919
00713908 : PUSH EBX
00713909 : PUSH ECX
0071390a : PUSH EAX
0071390b : CALL 0x00637771
00713910 : MOV EAX,dword ptr [EBP + 0xfffffb64]
00713916 : ADD ESP,0xc
00713919 : MOV ECX,dword ptr [ESI + 0x60]
0071391c : CMP EAX,EBX
0071391e : JZ 0x00713952
00713920 : PUSH EAX
00713921 : PUSH 0x1
00713923 : PUSH ECX
00713924 : PUSH EDI
00713925 : CALL 0x00638ac8
0071392a : MOV EAX,dword ptr [EBP + 0xfffffb64]
00713930 : ADD ESP,0x10
00713933 : CMP EAX,EBX
00713935 : JZ 0x00713952
00713937 : PUSH EAX
00713938 : CALL 0x006395f7
0071393d : MOV EDX,dword ptr [EBP + 0xfffffb64]
00713943 : PUSH EDX
00713944 : CALL 0x006366db
00713949 : ADD ESP,0x8
0071394c : MOV dword ptr [EBP + 0xfffffb64],EBX
00713952 : MOV EAX,dword ptr [ESI + 0x60]
00713955 : MOV dword ptr [EBP + -0x38],EDI
00713958 : LEA EDI,[EBP + 0xfffffb68]
0071395e : MOV dword ptr [EBP + 0xfffffb68],EBX
00713964 : MOV dword ptr [EBP + 0xfffffb6c],EBX
0071396a : MOV dword ptr [EBP + -0x3c],EBX
0071396d : MOV dword ptr [EBP + -0x34],EAX
00713970 : CALL 0x004ce240
00713975 : MOV byte ptr [EBP + -0x4],0x4
00713979 : MOV ECX,dword ptr [EBP + 0xfffffb6c]
0071397f : CALL 0x0070a3a0
00713984 : MOV ECX,dword ptr [EBP + 0xfffffb6c]
0071398a : MOV EDX,dword ptr [EBP + 0xfffffb68]
00713990 : PUSH ECX
00713991 : PUSH EDX
00713992 : PUSH EAX
00713993 : MOV dword ptr [ESI + 0x58],EAX
00713996 : MOV byte ptr [ESI + 0xd4],0x1
0071399d : CALL 0x0063ae40
007139a2 : MOV ECX,dword ptr [EBP + 0xfffffb50]
007139a8 : MOV EAX,dword ptr [EBP + 0xfffffb6c]
007139ae : PUSH ECX
007139af : MOV dword ptr [ESI + 0x60],EAX
007139b2 : CALL 0x0063610d
007139b7 : ADD ESP,0x10
007139ba : MOV byte ptr [EBP + -0x4],0x2
007139be : MOV EAX,dword ptr [EBP + 0xfffffb68]
007139c4 : LEA EDX,[EBP + 0xfffffb70]
007139ca : CMP EAX,EDX
007139cc : JZ 0x007139db
007139ce : CMP EAX,EBX
007139d0 : JZ 0x007139db
007139d2 : PUSH EAX
007139d3 : CALL 0x0063610d
007139d8 : ADD ESP,0x4
007139db : MOV byte ptr [EBP + -0x4],0x1
007139df : CMP dword ptr [EBP + 0xfffffb48],EBX
007139e5 : JZ 0x007139fa
007139e7 : MOV EAX,dword ptr [EBP + 0xfffffb3c]
007139ed : PUSH EAX
007139ee : CALL dword ptr [0x00b8511c]
007139f4 : MOV dword ptr [EBP + 0xfffffb48],EBX
007139fa : MOV byte ptr [EBP + -0x4],BL
007139fd : MOV EAX,dword ptr [EBP + 0xfffffb64]
00713a03 : MOV dword ptr [EBP + 0xfffffb54],0xcda538
00713a0d : CMP EAX,EBX
00713a0f : JZ 0x00713a2c
00713a11 : PUSH EAX
00713a12 : CALL 0x006395f7
00713a17 : MOV ECX,dword ptr [EBP + 0xfffffb64]
00713a1d : PUSH ECX
00713a1e : CALL 0x006366db
00713a23 : ADD ESP,0x8
00713a26 : MOV dword ptr [EBP + 0xfffffb64],EBX
00713a2c : MOV dword ptr [EBP + -0x4],0xffffffff
00713a33 : CMP dword ptr [EBP + -0x14],0x8
00713a37 : JC 0x00713a41
00713a39 : MOV ECX,dword ptr [EBP + -0x28]
00713a3c : CALL 0x006f04e0
00713a41 : XOR EDX,EDX
00713a43 : MOV dword ptr [EBP + -0x14],0x7
00713a4a : MOV dword ptr [EBP + -0x18],EBX
00713a4d : MOV word ptr [EBP + -0x28],DX
00713a51 : MOV AL,0x1
00713a53 : MOV ECX,dword ptr [EBP + -0xc]
00713a56 : MOV dword ptr FS:[0x0],ECX
00713a5d : POP ECX
00713a5e : POP EDI
00713a5f : POP EBX
00713a60 : MOV ECX,dword ptr [EBP + -0x10]
00713a63 : XOR ECX,EBP
00713a65 : CALL 0x00633e6b
00713a6a : MOV ESP,EBP
00713a6c : POP EBP
00713a6d : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_0055f950
ENTRY    : 0055f950
BODY     : [[0055f950, 0055fa18]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0055f950(char *param_1,int param_2)

{
  char cVar1;
  int *piVar2;
  char *pcVar3;
  int iVar4;
  int in_ECX;
  
  if (param_2 == -1) {
    pcVar3 = param_1;
    do {
      cVar1 = *pcVar3;
      pcVar3 = pcVar3 + 1;
    } while (cVar1 != '\0');
    param_2 = (int)pcVar3 - (int)(param_1 + 1);
  }
  if ((*(ushort *)(in_ECX + 0x2a) >> 0xb & 1) != 0) {
    iVar4 = FUN_0051b1a0();
    if (iVar4 == param_2) {
      iVar4 = FUN_0051b2a0((*(uint *)(in_ECX + 8) & 0xfffffffc) + 8,param_1,param_2);
      if (iVar4 == 0) goto LAB_0055f9ca;
    }
    piVar2 = *(int **)(in_ECX + 0x1c);
    if ((piVar2 != (int *)0x0) && (*piVar2 = *piVar2 + -1, *piVar2 == 0)) {
      FUN_00500860();
      FUN_00515cf0(piVar2);
    }
    *(undefined4 *)(in_ECX + 0x1c) = 0;
    *(ushort *)(in_ECX + 0x2a) = *(ushort *)(in_ECX + 0x2a) & 0xf7ff;
  }
LAB_0055f9ca:
  FUN_0051bf30();
  FUN_0051b950(param_1,param_2);
  *(ushort *)(in_ECX + 0x2a) = *(ushort *)(in_ECX + 0x2a) | 4;
  iVar4 = FUN_00638800((*(uint *)(in_ECX + 8) & 0xfffffffc) + 8,0x2c);
  if (iVar4 == 0) {
    *(ushort *)(in_ECX + 0x2a) = *(ushort *)(in_ECX + 0x2a) | 0x1000;
    return;
  }
  *(ushort *)(in_ECX + 0x2a) = *(ushort *)(in_ECX + 0x2a) & 0xefff;
  return;
}



============================================================
DISASSEMBLY
============================================================
0055f950 : PUSH EBX
0055f951 : MOV EBX,dword ptr [ESP + 0xc]
0055f955 : PUSH EBP
0055f956 : MOV EBP,dword ptr [ESP + 0xc]
0055f95a : PUSH ESI
0055f95b : PUSH EDI
0055f95c : MOV ESI,ECX
0055f95e : CMP EBX,-0x1
0055f961 : JNZ 0x0055f973
0055f963 : MOV EAX,EBP
0055f965 : LEA EDX,[EAX + 0x1]
0055f968 : MOV CL,byte ptr [EAX]
0055f96a : INC EAX
0055f96b : TEST CL,CL
0055f96d : JNZ 0x0055f968
0055f96f : SUB EAX,EDX
0055f971 : MOV EBX,EAX
0055f973 : MOV AX,word ptr [ESI + 0x2a]
0055f977 : SHR AX,0xb
0055f97b : TEST AL,0x1
0055f97d : JZ 0x0055f9ca
0055f97f : LEA EDI,[ESI + 0x8]
0055f982 : MOV ECX,EDI
0055f984 : CALL 0x0051b1a0
0055f989 : CMP EAX,EBX
0055f98b : JNZ 0x0055f9a1
0055f98d : MOV EAX,dword ptr [EDI]
0055f98f : PUSH EBX
0055f990 : AND EAX,0xfffffffc
0055f993 : PUSH EBP
0055f994 : ADD EAX,0x8
0055f997 : PUSH EAX
0055f998 : CALL 0x0051b2a0
0055f99d : TEST EAX,EAX
0055f99f : JZ 0x0055f9ca
0055f9a1 : MOV EDI,dword ptr [ESI + 0x1c]
0055f9a4 : TEST EDI,EDI
0055f9a6 : JZ 0x0055f9ba
0055f9a8 : ADD dword ptr [EDI],-0x1
0055f9ab : JNZ 0x0055f9ba
0055f9ad : MOV ECX,EDI
0055f9af : CALL 0x00500860
0055f9b4 : PUSH EDI
0055f9b5 : CALL 0x00515cf0
0055f9ba : MOV ECX,0xf7ff
0055f9bf : MOV dword ptr [ESI + 0x1c],0x0
0055f9c6 : AND word ptr [ESI + 0x2a],CX
0055f9ca : LEA EDI,[ESI + 0x8]
0055f9cd : MOV ECX,EDI
0055f9cf : CALL 0x0051bf30
0055f9d4 : PUSH EBX
0055f9d5 : PUSH EBP
0055f9d6 : MOV ECX,EDI
0055f9d8 : CALL 0x0051b950
0055f9dd : MOV EDI,dword ptr [EDI]
0055f9df : OR word ptr [ESI + 0x2a],0x4
0055f9e4 : AND EDI,0xfffffffc
0055f9e7 : PUSH 0x2c
0055f9e9 : ADD EDI,0x8
0055f9ec : PUSH EDI
0055f9ed : CALL 0x00638800
0055f9f2 : ADD ESP,0x8
0055f9f5 : TEST EAX,EAX
0055f9f7 : JNZ 0x0055fa09
0055f9f9 : POP EDI
0055f9fa : MOV EDX,0x1000
0055f9ff : OR word ptr [ESI + 0x2a],DX
0055fa03 : POP ESI
0055fa04 : POP EBP
0055fa05 : POP EBX
0055fa06 : RET 0x8
0055fa09 : POP EDI
0055fa0a : MOV EAX,0xefff
0055fa0f : AND word ptr [ESI + 0x2a],AX
0055fa13 : POP ESI
0055fa14 : POP EBP
0055fa15 : POP EBX
0055fa16 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_008a0cf0
ENTRY    : 008a0cf0
BODY     : [[008a0cf0, 008a0eb9]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008a0cf0(int param_1,uint param_2,int param_3)

{
  int iVar1;
  uint uVar2;
  undefined4 *puVar3;
  int in_ECX;
  uint local_84;
  uint local_80 [2];
  undefined4 local_78 [8];
  undefined4 local_58;
  undefined4 local_54;
  undefined4 local_50;
  undefined4 local_34;
  undefined1 local_30;
  undefined4 local_2c;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b2af00;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)&local_84;
  ExceptionList = &local_14;
  if ((((DAT_00d6ab0f != '\0') && (*(char *)(DAT_017248cc + 0x76) != '\0')) && (param_2 != 0)) &&
     ((*(int *)(param_1 + 0x50) != 0 && (in_ECX != 0)))) {
    local_80[0] = param_2 & 0xffff;
    FUN_004356c0(local_80);
    uVar2 = local_84;
    if ((local_84 != *(uint *)(param_1 + 0x4c)) &&
       (local_84 = param_2 & 0xffff, FUN_004356f0(&local_84), local_84 = uVar2, uVar2 != local_80[0]
       )) {
      do {
        iVar1 = *(int *)(local_84 + 0x10);
        FUN_00438c30(local_78);
        local_c = 0;
        if (((param_3 != 0) || ((*(char *)(iVar1 + 0x34) == '\0' && (*(int *)(iVar1 + 0x28) == 0))))
           && (*(char *)(iVar1 + 0x34) == '\0')) {
          FUN_00405eb0(iVar1,0,0xffffffff);
          puVar3 = (undefined4 *)FUN_007cc270();
          local_58 = *puVar3;
          local_54 = puVar3[1];
          local_50 = puVar3[2];
          local_34 = *(undefined4 *)(iVar1 + 0x24);
          local_30 = *(undefined1 *)(iVar1 + 0x34);
          local_2c = 0;
          local_78[0] = 0;
          FUN_007be1c0(DAT_01725208,local_78);
        }
        local_c = 0xffffffff;
        FUN_004427d0(local_78);
        FUN_00416210();
      } while (local_84 != local_80[0]);
    }
  }
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)&local_84);
  return;
}



============================================================
DISASSEMBLY
============================================================
008a0cf0 : PUSH EBP
008a0cf1 : MOV EBP,ESP
008a0cf3 : AND ESP,0xfffffff8
008a0cf6 : PUSH -0x1
008a0cf8 : PUSH 0xb2af00
008a0cfd : MOV EAX,FS:[0x0]
008a0d03 : PUSH EAX
008a0d04 : SUB ESP,0x70
008a0d07 : MOV EAX,[0x00d66fa0]
008a0d0c : XOR EAX,ESP
008a0d0e : MOV dword ptr [ESP + 0x68],EAX
008a0d12 : PUSH EBX
008a0d13 : PUSH ESI
008a0d14 : PUSH EDI
008a0d15 : MOV EAX,[0x00d66fa0]
008a0d1a : XOR EAX,ESP
008a0d1c : PUSH EAX
008a0d1d : LEA EAX,[ESP + 0x80]
008a0d24 : MOV FS:[0x0],EAX
008a0d2a : MOV EAX,dword ptr [EBP + 0xc]
008a0d2d : MOV EBX,dword ptr [EBP + 0x8]
008a0d30 : CMP byte ptr [0x00d6ab0f],0x0
008a0d37 : MOV dword ptr [ESP + 0x18],ECX
008a0d3b : JZ 0x008a0e97
008a0d41 : MOV EDX,dword ptr [0x017248cc]
008a0d47 : CMP byte ptr [EDX + 0x76],0x0
008a0d4b : JZ 0x008a0e97
008a0d51 : TEST EAX,EAX
008a0d53 : JZ 0x008a0e97
008a0d59 : CMP dword ptr [EBX + 0x50],0x0
008a0d5d : JZ 0x008a0e97
008a0d63 : TEST ECX,ECX
008a0d65 : JZ 0x008a0e97
008a0d6b : MOVZX EDI,AX
008a0d6e : LEA EAX,[ESP + 0x14]
008a0d72 : LEA ESI,[EBX + 0x48]
008a0d75 : PUSH EAX
008a0d76 : LEA EAX,[ESP + 0x14]
008a0d7a : MOV ECX,ESI
008a0d7c : MOV dword ptr [ESP + 0x18],EDI
008a0d80 : CALL 0x004356c0
008a0d85 : MOV EAX,dword ptr [EBX + 0x4c]
008a0d88 : MOV EBX,dword ptr [ESP + 0x10]
008a0d8c : CMP EBX,EAX
008a0d8e : JZ 0x008a0e97
008a0d94 : LEA ECX,[ESP + 0x10]
008a0d98 : PUSH ECX
008a0d99 : LEA EAX,[ESP + 0x18]
008a0d9d : MOV ECX,ESI
008a0d9f : MOV dword ptr [ESP + 0x14],EDI
008a0da3 : CALL 0x004356f0
008a0da8 : MOV EAX,EBX
008a0daa : MOV dword ptr [ESP + 0x10],EAX
008a0dae : CMP EBX,dword ptr [ESP + 0x14]
008a0db2 : JZ 0x008a0e97
008a0db8 : MOV EDI,dword ptr [EAX + 0x10]
008a0dbb : LEA EDX,[ESP + 0x1c]
008a0dbf : PUSH EDX
008a0dc0 : CALL 0x00438c30
008a0dc5 : XOR EBX,EBX
008a0dc7 : MOV dword ptr [ESP + 0x88],EBX
008a0dce : CMP dword ptr [EBP + 0x10],EBX
008a0dd1 : JNZ 0x008a0df2
008a0dd3 : CMP byte ptr [EDI + 0x34],BL
008a0dd6 : JNZ 0x008a0ddd
008a0dd8 : CMP dword ptr [EDI + 0x28],EBX
008a0ddb : JZ 0x008a0df2
008a0ddd : MOV dword ptr [ESP + 0x88],0xffffffff
008a0de8 : LEA EAX,[ESP + 0x1c]
008a0dec : PUSH EAX
008a0ded : JMP 0x008a0e7b
008a0df2 : CMP byte ptr [EDI + 0x34],0x0
008a0df6 : JZ 0x008a0e0a
008a0df8 : MOV dword ptr [ESP + 0x88],0xffffffff
008a0e03 : LEA ECX,[ESP + 0x1c]
008a0e07 : PUSH ECX
008a0e08 : JMP 0x008a0e7b
008a0e0a : PUSH -0x1
008a0e0c : PUSH EBX
008a0e0d : PUSH EDI
008a0e0e : LEA ECX,[ESP + 0x2c]
008a0e12 : CALL 0x00405eb0
008a0e17 : MOV ESI,dword ptr [ESP + 0x18]
008a0e1b : CALL 0x007cc270
008a0e20 : MOVSS XMM0,dword ptr [EAX]
008a0e24 : MOV ECX,dword ptr [0x01725208]
008a0e2a : MOVSS dword ptr [ESP + 0x3c],XMM0
008a0e30 : MOVSS XMM0,dword ptr [EAX + 0x4]
008a0e35 : MOVSS dword ptr [ESP + 0x40],XMM0
008a0e3b : MOVSS XMM0,dword ptr [EAX + 0x8]
008a0e40 : MOVSS dword ptr [ESP + 0x44],XMM0
008a0e46 : MOVSS XMM0,dword ptr [EDI + 0x24]
008a0e4b : LEA EAX,[ESP + 0x1c]
008a0e4f : MOVSS dword ptr [ESP + 0x60],XMM0
008a0e55 : MOV DL,byte ptr [EDI + 0x34]
008a0e58 : PUSH EAX
008a0e59 : PUSH ECX
008a0e5a : MOV byte ptr [ESP + 0x6c],DL
008a0e5e : MOV dword ptr [ESP + 0x70],EBX
008a0e62 : MOV dword ptr [ESP + 0x24],EBX
008a0e66 : CALL 0x007be1c0
008a0e6b : MOV dword ptr [ESP + 0x88],0xffffffff
008a0e76 : LEA EDX,[ESP + 0x1c]
008a0e7a : PUSH EDX
008a0e7b : CALL 0x004427d0
008a0e80 : LEA EDX,[ESP + 0x10]
008a0e84 : CALL 0x00416210
008a0e89 : MOV EAX,dword ptr [ESP + 0x10]
008a0e8d : CMP EAX,dword ptr [ESP + 0x14]
008a0e91 : JNZ 0x008a0db8
008a0e97 : MOV ECX,dword ptr [ESP + 0x80]
008a0e9e : MOV dword ptr FS:[0x0],ECX
008a0ea5 : POP ECX
008a0ea6 : POP EDI
008a0ea7 : POP ESI
008a0ea8 : POP EBX
008a0ea9 : MOV ECX,dword ptr [ESP + 0x68]
008a0ead : XOR ECX,ESP
008a0eaf : CALL 0x00633e6b
008a0eb4 : MOV ESP,EBP
008a0eb6 : POP EBP
008a0eb7 : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_00721740
ENTRY    : 00721740
BODY     : [[00721740, 00721788] [00721790, 00721923]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00721740(int *param_1)

{
  short sVar1;
  char cVar2;
  uint uVar3;
  short *psVar4;
  int in_ECX;
  undefined1 auStack_24c [4];
  undefined4 uStack_248;
  uint local_244;
  undefined4 uStack_240;
  undefined1 auStack_23c [4];
  undefined2 uStack_238;
  undefined4 uStack_228;
  uint uStack_224;
  short sStack_220;
  undefined1 auStack_21e [514];
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_00b17d2a;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_24c;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffda8;
  ExceptionList = &local_14;
LAB_00721790:
  do {
    while( true ) {
      if (((uint)param_1[8] <= (uint)param_1[9]) ||
         (cVar2 = (**(code **)(*param_1 + 0x1c))(&local_244,uVar3), cVar2 == '\0'))
      goto LAB_007218fe;
      if (0x52 < local_244) break;
      if (local_244 == 0x52) {
        (**(code **)(*param_1 + 0xc))(in_ECX + 0x12,1,1);
      }
      else if (local_244 == 0x10) {
        FUN_0070d320(&sStack_220);
        psVar4 = &sStack_220;
        uStack_224 = 7;
        uStack_228 = 0;
        uStack_238 = 0;
        do {
          sVar1 = *psVar4;
          psVar4 = psVar4 + 1;
        } while (sVar1 != 0);
        FUN_00406360(&sStack_220,(int)psVar4 - (int)auStack_21e >> 1);
        uStack_c = 0;
        FUN_00405eb0(auStack_23c,0,0xffffffff);
        uStack_c = 0xffffffff;
        if (7 < uStack_224) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        uStack_224 = 7;
        uStack_228 = 0;
        uStack_238 = 0;
      }
      else if (local_244 == 0x13) {
        uStack_248 = 0xffffffff;
        (**(code **)(*param_1 + 0xc))(&uStack_248,4,1);
      }
      else if (local_244 == 0x51) {
        (**(code **)(*param_1 + 0xc))(in_ECX + 0x11,1,1);
      }
      else {
LAB_007218bf:
        (**(code **)(*param_1 + 0x24))(uStack_240);
      }
    }
    if (local_244 != 0x53) break;
    (**(code **)(*param_1 + 0xc))(in_ECX + 0x13,1,1);
  } while( true );
  if (local_244 != 0x61) {
    if (local_244 != 0x162) goto LAB_007218bf;
    goto LAB_007218fe;
  }
  cVar2 = FUN_004cc990(param_1);
  if (cVar2 == '\0') {
LAB_007218fe:
    ExceptionList = local_14;
    __security_check_cookie(local_1c ^ (uint)auStack_24c);
    return;
  }
  goto LAB_00721790;
}



============================================================
DISASSEMBLY
============================================================
00721740 : PUSH EBP
00721741 : MOV EBP,ESP
00721743 : AND ESP,0xfffffff8
00721746 : PUSH -0x1
00721748 : PUSH 0xb17d2a
0072174d : MOV EAX,FS:[0x0]
00721753 : PUSH EAX
00721754 : SUB ESP,0x238
0072175a : MOV EAX,[0x00d66fa0]
0072175f : XOR EAX,ESP
00721761 : MOV dword ptr [ESP + 0x230],EAX
00721768 : PUSH EBX
00721769 : PUSH ESI
0072176a : PUSH EDI
0072176b : MOV EAX,[0x00d66fa0]
00721770 : XOR EAX,ESP
00721772 : PUSH EAX
00721773 : LEA EAX,[ESP + 0x248]
0072177a : MOV FS:[0x0],EAX
00721780 : MOV ESI,dword ptr [EBP + 0x8]
00721783 : MOV EDI,ECX
00721785 : XOR EBX,EBX
00721787 : JMP 0x00721790
00721790 : MOV EAX,dword ptr [ESI + 0x24]
00721793 : CMP EAX,dword ptr [ESI + 0x20]
00721796 : JNC 0x007218fc
0072179c : MOV EDX,dword ptr [ESI]
0072179e : MOV EDX,dword ptr [EDX + 0x1c]
007217a1 : LEA EAX,[ESP + 0x18]
007217a5 : PUSH EAX
007217a6 : MOV ECX,ESI
007217a8 : CALL EDX
007217aa : TEST AL,AL
007217ac : JZ 0x007218e2
007217b2 : MOV EAX,dword ptr [ESP + 0x18]
007217b6 : CMP EAX,0x52
007217b9 : JA 0x007218ae
007217bf : JZ 0x00721898
007217c5 : CMP EAX,0x10
007217c8 : JZ 0x00721807
007217ca : CMP EAX,0x13
007217cd : JZ 0x007217eb
007217cf : CMP EAX,0x51
007217d2 : JNZ 0x007218bf
007217d8 : MOV EAX,dword ptr [ESI]
007217da : MOV EDX,dword ptr [EAX + 0xc]
007217dd : PUSH 0x1
007217df : PUSH 0x1
007217e1 : LEA ECX,[EDI + 0x11]
007217e4 : PUSH ECX
007217e5 : MOV ECX,ESI
007217e7 : CALL EDX
007217e9 : JMP 0x00721790
007217eb : MOV EAX,dword ptr [ESI]
007217ed : MOV EDX,dword ptr [EAX + 0xc]
007217f0 : PUSH 0x1
007217f2 : PUSH 0x4
007217f4 : LEA ECX,[ESP + 0x1c]
007217f8 : PUSH ECX
007217f9 : MOV ECX,ESI
007217fb : MOV dword ptr [ESP + 0x20],0xffffffff
00721803 : CALL EDX
00721805 : JMP 0x00721790
00721807 : LEA EAX,[ESP + 0x3c]
0072180b : PUSH EAX
0072180c : MOV ECX,ESI
0072180e : CALL 0x0070d320
00721813 : XOR ECX,ECX
00721815 : LEA EAX,[ESP + 0x3c]
00721819 : MOV dword ptr [ESP + 0x38],0x7
00721821 : MOV dword ptr [ESP + 0x34],EBX
00721825 : MOV word ptr [ESP + 0x24],CX
0072182a : LEA EDX,[EAX + 0x2]
0072182d : LEA ECX,[ECX]
00721830 : MOV CX,word ptr [EAX]
00721833 : ADD EAX,0x2
00721836 : CMP CX,BX
00721839 : JNZ 0x00721830
0072183b : SUB EAX,EDX
0072183d : SAR EAX,0x1
0072183f : PUSH EAX
00721840 : LEA EDX,[ESP + 0x40]
00721844 : PUSH EDX
00721845 : LEA ECX,[ESP + 0x28]
00721849 : CALL 0x00406360
0072184e : MOV dword ptr [ESP + 0x250],EBX
00721855 : PUSH -0x1
00721857 : PUSH EBX
00721858 : LEA EAX,[ESP + 0x28]
0072185c : PUSH EAX
0072185d : LEA ECX,[EDI + 0x14]
00721860 : CALL 0x00405eb0
00721865 : MOV dword ptr [ESP + 0x250],0xffffffff
00721870 : CMP dword ptr [ESP + 0x38],0x8
00721875 : JC 0x00721880
00721877 : MOV ECX,dword ptr [ESP + 0x24]
0072187b : CALL 0x006f04e0
00721880 : XOR ECX,ECX
00721882 : MOV dword ptr [ESP + 0x38],0x7
0072188a : MOV dword ptr [ESP + 0x34],EBX
0072188e : MOV word ptr [ESP + 0x24],CX
00721893 : JMP 0x00721790
00721898 : MOV EDX,dword ptr [ESI]
0072189a : MOV EDX,dword ptr [EDX + 0xc]
0072189d : PUSH 0x1
0072189f : PUSH 0x1
007218a1 : LEA EAX,[EDI + 0x12]
007218a4 : PUSH EAX
007218a5 : MOV ECX,ESI
007218a7 : CALL EDX
007218a9 : JMP 0x00721790
007218ae : CMP EAX,0x53
007218b1 : JZ 0x007218e6
007218b3 : CMP EAX,0x61
007218b6 : JZ 0x007218d2
007218b8 : CMP EAX,0x162
007218bd : JZ 0x007218fc
007218bf : MOV ECX,dword ptr [ESP + 0x1c]
007218c3 : MOV EAX,dword ptr [ESI]
007218c5 : MOV EDX,dword ptr [EAX + 0x24]
007218c8 : PUSH ECX
007218c9 : MOV ECX,ESI
007218cb : CALL EDX
007218cd : JMP 0x00721790
007218d2 : PUSH ESI
007218d3 : MOV ECX,EDI
007218d5 : CALL 0x004cc990
007218da : TEST AL,AL
007218dc : JNZ 0x00721790
007218e2 : XOR AL,AL
007218e4 : JMP 0x007218fe
007218e6 : MOV EAX,dword ptr [ESI]
007218e8 : MOV EDX,dword ptr [EAX + 0xc]
007218eb : PUSH 0x1
007218ed : PUSH 0x1
007218ef : LEA ECX,[EDI + 0x13]
007218f2 : PUSH ECX
007218f3 : MOV ECX,ESI
007218f5 : CALL EDX
007218f7 : JMP 0x00721790
007218fc : MOV AL,0x1
007218fe : MOV ECX,dword ptr [ESP + 0x248]
00721905 : MOV dword ptr FS:[0x0],ECX
0072190c : POP ECX
0072190d : POP EDI
0072190e : POP ESI
0072190f : POP EBX
00721910 : MOV ECX,dword ptr [ESP + 0x230]
00721917 : XOR ECX,ESP
00721919 : CALL 0x00633e6b
0072191e : MOV ESP,EBP
00721920 : POP EBP
00721921 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_00553570
ENTRY    : 00553570
BODY     : [[00553570, 005535e4]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00553570(uint param_1,uint param_2)

{
  int iVar1;
  undefined4 *puVar2;
  int *in_ECX;
  uint uVar3;
  
  uVar3 = (uint)*(ushort *)(in_ECX + 2);
  if ((in_ECX[1] == 0) || (uVar3 < param_1)) {
    uVar3 = (uint)*(ushort *)((int)in_ECX + 10);
    if (*(ushort *)((int)in_ECX + 10) < param_2) {
      uVar3 = param_2;
    }
    puVar2 = (undefined4 *)FUN_00515d60(in_ECX,uVar3 + 8,0);
    *puVar2 = 0;
    puVar2[1] = uVar3;
    if ((undefined4 *)in_ECX[1] != (undefined4 *)0x0) {
      *(undefined4 *)in_ECX[1] = puVar2;
      *(int *)(in_ECX[1] + 4) = *(int *)(in_ECX[1] + 4) - (uint)*(ushort *)(in_ECX + 2);
    }
    in_ECX[1] = (int)puVar2;
    param_1 = param_2;
    if (*in_ECX == 0) {
      *in_ECX = (int)puVar2;
    }
  }
  iVar1 = *(int *)(in_ECX[1] + 4);
  *(short *)(in_ECX + 2) = (short)uVar3 - (short)param_1;
  return (iVar1 - uVar3) + 8 + in_ECX[1];
}



============================================================
DISASSEMBLY
============================================================
00553570 : MOV EAX,dword ptr [ESP + 0x8]
00553574 : PUSH EBX
00553575 : PUSH ESI
00553576 : MOV ESI,ECX
00553578 : CMP dword ptr [ESI + 0x4],0x0
0055357c : PUSH EDI
0055357d : MOVZX EDI,word ptr [ESI + 0x8]
00553581 : MOV EBX,EAX
00553583 : JZ 0x00553591
00553585 : MOV ECX,dword ptr [ESP + 0x10]
00553589 : CMP EDI,ECX
0055358b : JC 0x00553591
0055358d : MOV EBX,ECX
0055358f : JMP 0x005535cd
00553591 : MOVZX EDI,word ptr [ESI + 0xa]
00553595 : CMP EAX,EDI
00553597 : JBE 0x0055359b
00553599 : MOV EDI,EAX
0055359b : PUSH 0x0
0055359d : LEA EAX,[EDI + 0x8]
005535a0 : PUSH EAX
005535a1 : PUSH ESI
005535a2 : CALL 0x00515d60
005535a7 : MOV dword ptr [EAX],0x0
005535ad : MOV dword ptr [EAX + 0x4],EDI
005535b0 : MOV ECX,dword ptr [ESI + 0x4]
005535b3 : TEST ECX,ECX
005535b5 : JZ 0x005535c3
005535b7 : MOV dword ptr [ECX],EAX
005535b9 : MOVZX EDX,word ptr [ESI + 0x8]
005535bd : MOV ECX,dword ptr [ESI + 0x4]
005535c0 : SUB dword ptr [ECX + 0x4],EDX
005535c3 : CMP dword ptr [ESI],0x0
005535c6 : MOV dword ptr [ESI + 0x4],EAX
005535c9 : JNZ 0x005535cd
005535cb : MOV dword ptr [ESI],EAX
005535cd : MOV EAX,dword ptr [ESI + 0x4]
005535d0 : MOV ECX,dword ptr [EAX + 0x4]
005535d3 : SUB ECX,EDI
005535d5 : SUB EDI,EBX
005535d7 : MOV word ptr [ESI + 0x8],DI
005535db : POP EDI
005535dc : POP ESI
005535dd : LEA EAX,[ECX + EAX*0x1 + 0x8]
005535e1 : POP EBX
005535e2 : RET 0x8

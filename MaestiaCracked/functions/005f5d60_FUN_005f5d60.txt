PROGRAM  : Maestia.exe
FUNCTION : FUN_005f5d60
ENTRY    : 005f5d60
BODY     : [[005f5d60, 005f5dbe]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_005f5d60(int *param_1)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int *in_ECX;
  int iVar5;
  
  param_1[2] = 0;
  param_1[1] = 0;
  *param_1 = 0;
  iVar4 = *in_ECX;
  if (iVar4 == 0) {
    *in_ECX = (int)param_1;
    *param_1 = (int)in_ECX;
    return 0;
  }
  iVar2 = param_1[4];
  iVar5 = iVar2;
  if (*(int *)(iVar4 + 0x10) != iVar2) {
    while( true ) {
      piVar1 = (int *)(iVar4 + 4 + (iVar5 >> 0x1f) * -4);
      iVar3 = *piVar1;
      iVar5 = iVar5 * 2;
      if (iVar3 == 0) break;
      iVar4 = iVar3;
      if (*(int *)(iVar3 + 0x10) == iVar2) {
        return iVar3;
      }
    }
    *piVar1 = (int)param_1;
    *param_1 = iVar4;
    iVar4 = 0;
  }
  return iVar4;
}



============================================================
DISASSEMBLY
============================================================
005f5d60 : PUSH EBX
005f5d61 : PUSH ESI
005f5d62 : PUSH EDI
005f5d63 : MOV EDI,dword ptr [ESP + 0x10]
005f5d67 : MOV dword ptr [EDI + 0x8],0x0
005f5d6e : MOV dword ptr [EDI + 0x4],0x0
005f5d75 : MOV dword ptr [EDI],0x0
005f5d7b : MOV EAX,dword ptr [ECX]
005f5d7d : TEST EAX,EAX
005f5d7f : JNZ 0x005f5d8b
005f5d81 : MOV dword ptr [ECX],EDI
005f5d83 : MOV dword ptr [EDI],ECX
005f5d85 : POP EDI
005f5d86 : POP ESI
005f5d87 : POP EBX
005f5d88 : RET 0x4
005f5d8b : MOV EBX,dword ptr [EDI + 0x10]
005f5d8e : MOV ESI,EBX
005f5d90 : CMP dword ptr [EAX + 0x10],EBX
005f5d93 : JZ 0x005f5db9
005f5d95 : MOV ECX,ESI
005f5d97 : SHR ECX,0x1f
005f5d9a : LEA EDX,[EAX + ECX*0x4 + 0x4]
005f5d9e : MOV ECX,dword ptr [EDX]
005f5da0 : ADD ESI,ESI
005f5da2 : TEST ECX,ECX
005f5da4 : JZ 0x005f5db3
005f5da6 : MOV EAX,ECX
005f5da8 : CMP dword ptr [EAX + 0x10],EBX
005f5dab : JNZ 0x005f5d95
005f5dad : POP EDI
005f5dae : POP ESI
005f5daf : POP EBX
005f5db0 : RET 0x4
005f5db3 : MOV dword ptr [EDX],EDI
005f5db5 : MOV dword ptr [EDI],EAX
005f5db7 : XOR EAX,EAX
005f5db9 : POP EDI
005f5dba : POP ESI
005f5dbb : POP EBX
005f5dbc : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_006c7c80
ENTRY    : 006c7c80
BODY     : [[006c7c80, 006c8034]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006c7c80(uint *param_1,int param_2)

{
  undefined1 *puVar1;
  uint local_30;
  undefined1 *local_2c;
  undefined1 *local_28;
  undefined1 *local_24;
  undefined1 *local_20;
  undefined1 *local_1c;
  undefined1 *local_18;
  undefined1 *local_14;
  undefined1 *local_10;
  uint local_8;
  
  local_30 = *param_1;
  if ((7 < *(byte *)((int)param_1 + 9)) && ((param_1[2] & 2) == 0)) {
    if ((char)param_1[2] == '\0') {
      if (*(char *)((int)param_1 + 9) == '\b') {
        local_10 = (undefined1 *)(param_2 + -1 + local_30);
        local_14 = local_10 + local_30 * 2;
        for (local_8 = 0; local_8 < local_30; local_8 = local_8 + 1) {
          *local_14 = *local_10;
          local_14[-1] = *local_10;
          local_14[-2] = *local_10;
          local_14 = local_14 + -3;
          local_10 = local_10 + -1;
        }
      }
      else {
        local_18 = (undefined1 *)(param_2 + -1 + local_30 * 2);
        local_1c = local_18 + local_30 * 4;
        for (local_8 = 0; local_8 < local_30; local_8 = local_8 + 1) {
          *local_1c = *local_18;
          local_1c[-1] = local_18[-1];
          local_1c[-2] = *local_18;
          local_1c[-3] = local_18[-1];
          local_1c[-4] = *local_18;
          local_1c[-5] = local_18[-1];
          local_1c = local_1c + -6;
          local_18 = local_18 + -2;
        }
      }
    }
    else if ((char)param_1[2] == '\x04') {
      if (*(char *)((int)param_1 + 9) == '\b') {
        local_20 = (undefined1 *)(param_2 + -1 + local_30 * 2);
        local_24 = local_20 + local_30 * 2;
        for (local_8 = 0; local_8 < local_30; local_8 = local_8 + 1) {
          *local_24 = *local_20;
          puVar1 = local_20 + -1;
          local_24[-1] = *puVar1;
          local_24[-2] = *puVar1;
          local_24[-3] = *puVar1;
          local_24 = local_24 + -4;
          local_20 = local_20 + -2;
        }
      }
      else {
        local_28 = (undefined1 *)(param_2 + -1 + local_30 * 4);
        local_2c = local_28 + local_30 * 4;
        for (local_8 = 0; local_8 < local_30; local_8 = local_8 + 1) {
          *local_2c = *local_28;
          local_2c[-1] = local_28[-1];
          puVar1 = local_28 + -2;
          local_2c[-2] = *puVar1;
          local_2c[-3] = local_28[-3];
          local_2c[-4] = *puVar1;
          local_2c[-5] = local_28[-3];
          local_2c[-6] = *puVar1;
          local_2c[-7] = local_28[-3];
          local_2c = local_2c + -8;
          local_28 = local_28 + -4;
        }
      }
    }
    *(char *)((int)param_1 + 10) = *(char *)((int)param_1 + 10) + '\x02';
    *(byte *)(param_1 + 2) = (byte)param_1[2] | 2;
    *(char *)((int)param_1 + 0xb) = *(char *)((int)param_1 + 10) * *(char *)((int)param_1 + 9);
    if (*(byte *)((int)param_1 + 0xb) < 8) {
      local_30 = *(byte *)((int)param_1 + 0xb) * local_30 + 7 >> 3;
    }
    else {
      local_30 = (*(byte *)((int)param_1 + 0xb) >> 3) * local_30;
    }
    param_1[1] = local_30;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
006c7c80 : PUSH EBP
006c7c81 : MOV EBP,ESP
006c7c83 : SUB ESP,0x2c
006c7c86 : MOV EAX,dword ptr [EBP + 0x8]
006c7c89 : MOV ECX,dword ptr [EAX]
006c7c8b : MOV dword ptr [EBP + -0x8],ECX
006c7c8e : MOV EDX,dword ptr [EBP + 0x8]
006c7c91 : MOVZX EAX,byte ptr [EDX + 0x9]
006c7c95 : CMP EAX,0x8
006c7c98 : JL 0x006c8031
006c7c9e : MOV ECX,dword ptr [EBP + 0x8]
006c7ca1 : MOVZX EDX,byte ptr [ECX + 0x8]
006c7ca5 : AND EDX,0x2
006c7ca8 : JNZ 0x006c8031
006c7cae : MOV EAX,dword ptr [EBP + 0x8]
006c7cb1 : MOVZX ECX,byte ptr [EAX + 0x8]
006c7cb5 : TEST ECX,ECX
006c7cb7 : JNZ 0x006c7e0c
006c7cbd : MOV EDX,dword ptr [EBP + 0x8]
006c7cc0 : MOVZX EAX,byte ptr [EDX + 0x9]
006c7cc4 : CMP EAX,0x8
006c7cc7 : JNZ 0x006c7d45
006c7cc9 : MOV ECX,dword ptr [EBP + -0x8]
006c7ccc : MOV EDX,dword ptr [EBP + 0xc]
006c7ccf : LEA EAX,[EDX + ECX*0x1 + -0x1]
006c7cd3 : MOV dword ptr [EBP + -0xc],EAX
006c7cd6 : MOV ECX,dword ptr [EBP + -0x8]
006c7cd9 : MOV EDX,dword ptr [EBP + -0xc]
006c7cdc : LEA EAX,[EDX + ECX*0x2]
006c7cdf : MOV dword ptr [EBP + -0x10],EAX
006c7ce2 : MOV dword ptr [EBP + -0x4],0x0
006c7ce9 : JMP 0x006c7cf4
006c7ceb : MOV ECX,dword ptr [EBP + -0x4]
006c7cee : ADD ECX,0x1
006c7cf1 : MOV dword ptr [EBP + -0x4],ECX
006c7cf4 : MOV EDX,dword ptr [EBP + -0x4]
006c7cf7 : CMP EDX,dword ptr [EBP + -0x8]
006c7cfa : JNC 0x006c7d40
006c7cfc : MOV EAX,dword ptr [EBP + -0x10]
006c7cff : MOV ECX,dword ptr [EBP + -0xc]
006c7d02 : MOV DL,byte ptr [ECX]
006c7d04 : MOV byte ptr [EAX],DL
006c7d06 : MOV EAX,dword ptr [EBP + -0x10]
006c7d09 : SUB EAX,0x1
006c7d0c : MOV dword ptr [EBP + -0x10],EAX
006c7d0f : MOV ECX,dword ptr [EBP + -0x10]
006c7d12 : MOV EDX,dword ptr [EBP + -0xc]
006c7d15 : MOV AL,byte ptr [EDX]
006c7d17 : MOV byte ptr [ECX],AL
006c7d19 : MOV ECX,dword ptr [EBP + -0x10]
006c7d1c : SUB ECX,0x1
006c7d1f : MOV dword ptr [EBP + -0x10],ECX
006c7d22 : MOV EDX,dword ptr [EBP + -0x10]
006c7d25 : MOV EAX,dword ptr [EBP + -0xc]
006c7d28 : MOV CL,byte ptr [EAX]
006c7d2a : MOV byte ptr [EDX],CL
006c7d2c : MOV EDX,dword ptr [EBP + -0x10]
006c7d2f : SUB EDX,0x1
006c7d32 : MOV dword ptr [EBP + -0x10],EDX
006c7d35 : MOV EAX,dword ptr [EBP + -0xc]
006c7d38 : SUB EAX,0x1
006c7d3b : MOV dword ptr [EBP + -0xc],EAX
006c7d3e : JMP 0x006c7ceb
006c7d40 : JMP 0x006c7e07
006c7d45 : MOV ECX,dword ptr [EBP + -0x8]
006c7d48 : MOV EDX,dword ptr [EBP + 0xc]
006c7d4b : LEA EAX,[EDX + ECX*0x2 + -0x1]
006c7d4f : MOV dword ptr [EBP + -0x14],EAX
006c7d52 : MOV ECX,dword ptr [EBP + -0x8]
006c7d55 : MOV EDX,dword ptr [EBP + -0x14]
006c7d58 : LEA EAX,[EDX + ECX*0x4]
006c7d5b : MOV dword ptr [EBP + -0x18],EAX
006c7d5e : MOV dword ptr [EBP + -0x4],0x0
006c7d65 : JMP 0x006c7d70
006c7d67 : MOV ECX,dword ptr [EBP + -0x4]
006c7d6a : ADD ECX,0x1
006c7d6d : MOV dword ptr [EBP + -0x4],ECX
006c7d70 : MOV EDX,dword ptr [EBP + -0x4]
006c7d73 : CMP EDX,dword ptr [EBP + -0x8]
006c7d76 : JNC 0x006c7e07
006c7d7c : MOV EAX,dword ptr [EBP + -0x18]
006c7d7f : MOV ECX,dword ptr [EBP + -0x14]
006c7d82 : MOV DL,byte ptr [ECX]
006c7d84 : MOV byte ptr [EAX],DL
006c7d86 : MOV EAX,dword ptr [EBP + -0x18]
006c7d89 : SUB EAX,0x1
006c7d8c : MOV dword ptr [EBP + -0x18],EAX
006c7d8f : MOV ECX,dword ptr [EBP + -0x18]
006c7d92 : MOV EDX,dword ptr [EBP + -0x14]
006c7d95 : MOV AL,byte ptr [EDX + -0x1]
006c7d98 : MOV byte ptr [ECX],AL
006c7d9a : MOV ECX,dword ptr [EBP + -0x18]
006c7d9d : SUB ECX,0x1
006c7da0 : MOV dword ptr [EBP + -0x18],ECX
006c7da3 : MOV EDX,dword ptr [EBP + -0x18]
006c7da6 : MOV EAX,dword ptr [EBP + -0x14]
006c7da9 : MOV CL,byte ptr [EAX]
006c7dab : MOV byte ptr [EDX],CL
006c7dad : MOV EDX,dword ptr [EBP + -0x18]
006c7db0 : SUB EDX,0x1
006c7db3 : MOV dword ptr [EBP + -0x18],EDX
006c7db6 : MOV EAX,dword ptr [EBP + -0x18]
006c7db9 : MOV ECX,dword ptr [EBP + -0x14]
006c7dbc : MOV DL,byte ptr [ECX + -0x1]
006c7dbf : MOV byte ptr [EAX],DL
006c7dc1 : MOV EAX,dword ptr [EBP + -0x18]
006c7dc4 : SUB EAX,0x1
006c7dc7 : MOV dword ptr [EBP + -0x18],EAX
006c7dca : MOV ECX,dword ptr [EBP + -0x18]
006c7dcd : MOV EDX,dword ptr [EBP + -0x14]
006c7dd0 : MOV AL,byte ptr [EDX]
006c7dd2 : MOV byte ptr [ECX],AL
006c7dd4 : MOV ECX,dword ptr [EBP + -0x18]
006c7dd7 : SUB ECX,0x1
006c7dda : MOV dword ptr [EBP + -0x18],ECX
006c7ddd : MOV EDX,dword ptr [EBP + -0x14]
006c7de0 : SUB EDX,0x1
006c7de3 : MOV dword ptr [EBP + -0x14],EDX
006c7de6 : MOV EAX,dword ptr [EBP + -0x18]
006c7de9 : MOV ECX,dword ptr [EBP + -0x14]
006c7dec : MOV DL,byte ptr [ECX]
006c7dee : MOV byte ptr [EAX],DL
006c7df0 : MOV EAX,dword ptr [EBP + -0x18]
006c7df3 : SUB EAX,0x1
006c7df6 : MOV dword ptr [EBP + -0x18],EAX
006c7df9 : MOV ECX,dword ptr [EBP + -0x14]
006c7dfc : SUB ECX,0x1
006c7dff : MOV dword ptr [EBP + -0x14],ECX
006c7e02 : JMP 0x006c7d67
006c7e07 : JMP 0x006c7fbe
006c7e0c : MOV EDX,dword ptr [EBP + 0x8]
006c7e0f : MOVZX EAX,byte ptr [EDX + 0x8]
006c7e13 : CMP EAX,0x4
006c7e16 : JNZ 0x006c7fbe
006c7e1c : MOV ECX,dword ptr [EBP + 0x8]
006c7e1f : MOVZX EDX,byte ptr [ECX + 0x9]
006c7e23 : CMP EDX,0x8
006c7e26 : JNZ 0x006c7ec4
006c7e2c : MOV EAX,dword ptr [EBP + -0x8]
006c7e2f : MOV ECX,dword ptr [EBP + 0xc]
006c7e32 : LEA EDX,[ECX + EAX*0x2 + -0x1]
006c7e36 : MOV dword ptr [EBP + -0x1c],EDX
006c7e39 : MOV EAX,dword ptr [EBP + -0x8]
006c7e3c : MOV ECX,dword ptr [EBP + -0x1c]
006c7e3f : LEA EDX,[ECX + EAX*0x2]
006c7e42 : MOV dword ptr [EBP + -0x20],EDX
006c7e45 : MOV dword ptr [EBP + -0x4],0x0
006c7e4c : JMP 0x006c7e57
006c7e4e : MOV EAX,dword ptr [EBP + -0x4]
006c7e51 : ADD EAX,0x1
006c7e54 : MOV dword ptr [EBP + -0x4],EAX
006c7e57 : MOV ECX,dword ptr [EBP + -0x4]
006c7e5a : CMP ECX,dword ptr [EBP + -0x8]
006c7e5d : JNC 0x006c7ebf
006c7e5f : MOV EDX,dword ptr [EBP + -0x20]
006c7e62 : MOV EAX,dword ptr [EBP + -0x1c]
006c7e65 : MOV CL,byte ptr [EAX]
006c7e67 : MOV byte ptr [EDX],CL
006c7e69 : MOV EDX,dword ptr [EBP + -0x20]
006c7e6c : SUB EDX,0x1
006c7e6f : MOV dword ptr [EBP + -0x20],EDX
006c7e72 : MOV EAX,dword ptr [EBP + -0x1c]
006c7e75 : SUB EAX,0x1
006c7e78 : MOV dword ptr [EBP + -0x1c],EAX
006c7e7b : MOV ECX,dword ptr [EBP + -0x20]
006c7e7e : MOV EDX,dword ptr [EBP + -0x1c]
006c7e81 : MOV AL,byte ptr [EDX]
006c7e83 : MOV byte ptr [ECX],AL
006c7e85 : MOV ECX,dword ptr [EBP + -0x20]
006c7e88 : SUB ECX,0x1
006c7e8b : MOV dword ptr [EBP + -0x20],ECX
006c7e8e : MOV EDX,dword ptr [EBP + -0x20]
006c7e91 : MOV EAX,dword ptr [EBP + -0x1c]
006c7e94 : MOV CL,byte ptr [EAX]
006c7e96 : MOV byte ptr [EDX],CL
006c7e98 : MOV EDX,dword ptr [EBP + -0x20]
006c7e9b : SUB EDX,0x1
006c7e9e : MOV dword ptr [EBP + -0x20],EDX
006c7ea1 : MOV EAX,dword ptr [EBP + -0x20]
006c7ea4 : MOV ECX,dword ptr [EBP + -0x1c]
006c7ea7 : MOV DL,byte ptr [ECX]
006c7ea9 : MOV byte ptr [EAX],DL
006c7eab : MOV EAX,dword ptr [EBP + -0x20]
006c7eae : SUB EAX,0x1
006c7eb1 : MOV dword ptr [EBP + -0x20],EAX
006c7eb4 : MOV ECX,dword ptr [EBP + -0x1c]
006c7eb7 : SUB ECX,0x1
006c7eba : MOV dword ptr [EBP + -0x1c],ECX
006c7ebd : JMP 0x006c7e4e
006c7ebf : JMP 0x006c7fbe
006c7ec4 : MOV EDX,dword ptr [EBP + -0x8]
006c7ec7 : MOV EAX,dword ptr [EBP + 0xc]
006c7eca : LEA ECX,[EAX + EDX*0x4 + -0x1]
006c7ece : MOV dword ptr [EBP + -0x24],ECX
006c7ed1 : MOV EDX,dword ptr [EBP + -0x8]
006c7ed4 : MOV EAX,dword ptr [EBP + -0x24]
006c7ed7 : LEA ECX,[EAX + EDX*0x4]
006c7eda : MOV dword ptr [EBP + -0x28],ECX
006c7edd : MOV dword ptr [EBP + -0x4],0x0
006c7ee4 : JMP 0x006c7eef
006c7ee6 : MOV EDX,dword ptr [EBP + -0x4]
006c7ee9 : ADD EDX,0x1
006c7eec : MOV dword ptr [EBP + -0x4],EDX
006c7eef : MOV EAX,dword ptr [EBP + -0x4]
006c7ef2 : CMP EAX,dword ptr [EBP + -0x8]
006c7ef5 : JNC 0x006c7fbe
006c7efb : MOV ECX,dword ptr [EBP + -0x28]
006c7efe : MOV EDX,dword ptr [EBP + -0x24]
006c7f01 : MOV AL,byte ptr [EDX]
006c7f03 : MOV byte ptr [ECX],AL
006c7f05 : MOV ECX,dword ptr [EBP + -0x28]
006c7f08 : SUB ECX,0x1
006c7f0b : MOV dword ptr [EBP + -0x28],ECX
006c7f0e : MOV EDX,dword ptr [EBP + -0x24]
006c7f11 : SUB EDX,0x1
006c7f14 : MOV dword ptr [EBP + -0x24],EDX
006c7f17 : MOV EAX,dword ptr [EBP + -0x28]
006c7f1a : MOV ECX,dword ptr [EBP + -0x24]
006c7f1d : MOV DL,byte ptr [ECX]
006c7f1f : MOV byte ptr [EAX],DL
006c7f21 : MOV EAX,dword ptr [EBP + -0x28]
006c7f24 : SUB EAX,0x1
006c7f27 : MOV dword ptr [EBP + -0x28],EAX
006c7f2a : MOV ECX,dword ptr [EBP + -0x24]
006c7f2d : SUB ECX,0x1
006c7f30 : MOV dword ptr [EBP + -0x24],ECX
006c7f33 : MOV EDX,dword ptr [EBP + -0x28]
006c7f36 : MOV EAX,dword ptr [EBP + -0x24]
006c7f39 : MOV CL,byte ptr [EAX]
006c7f3b : MOV byte ptr [EDX],CL
006c7f3d : MOV EDX,dword ptr [EBP + -0x28]
006c7f40 : SUB EDX,0x1
006c7f43 : MOV dword ptr [EBP + -0x28],EDX
006c7f46 : MOV EAX,dword ptr [EBP + -0x28]
006c7f49 : MOV ECX,dword ptr [EBP + -0x24]
006c7f4c : MOV DL,byte ptr [ECX + -0x1]
006c7f4f : MOV byte ptr [EAX],DL
006c7f51 : MOV EAX,dword ptr [EBP + -0x28]
006c7f54 : SUB EAX,0x1
006c7f57 : MOV dword ptr [EBP + -0x28],EAX
006c7f5a : MOV ECX,dword ptr [EBP + -0x28]
006c7f5d : MOV EDX,dword ptr [EBP + -0x24]
006c7f60 : MOV AL,byte ptr [EDX]
006c7f62 : MOV byte ptr [ECX],AL
006c7f64 : MOV ECX,dword ptr [EBP + -0x28]
006c7f67 : SUB ECX,0x1
006c7f6a : MOV dword ptr [EBP + -0x28],ECX
006c7f6d : MOV EDX,dword ptr [EBP + -0x28]
006c7f70 : MOV EAX,dword ptr [EBP + -0x24]
006c7f73 : MOV CL,byte ptr [EAX + -0x1]
006c7f76 : MOV byte ptr [EDX],CL
006c7f78 : MOV EDX,dword ptr [EBP + -0x28]
006c7f7b : SUB EDX,0x1
006c7f7e : MOV dword ptr [EBP + -0x28],EDX
006c7f81 : MOV EAX,dword ptr [EBP + -0x28]
006c7f84 : MOV ECX,dword ptr [EBP + -0x24]
006c7f87 : MOV DL,byte ptr [ECX]
006c7f89 : MOV byte ptr [EAX],DL
006c7f8b : MOV EAX,dword ptr [EBP + -0x28]
006c7f8e : SUB EAX,0x1
006c7f91 : MOV dword ptr [EBP + -0x28],EAX
006c7f94 : MOV ECX,dword ptr [EBP + -0x24]
006c7f97 : SUB ECX,0x1
006c7f9a : MOV dword ptr [EBP + -0x24],ECX
006c7f9d : MOV EDX,dword ptr [EBP + -0x28]
006c7fa0 : MOV EAX,dword ptr [EBP + -0x24]
006c7fa3 : MOV CL,byte ptr [EAX]
006c7fa5 : MOV byte ptr [EDX],CL
006c7fa7 : MOV EDX,dword ptr [EBP + -0x28]
006c7faa : SUB EDX,0x1
006c7fad : MOV dword ptr [EBP + -0x28],EDX
006c7fb0 : MOV EAX,dword ptr [EBP + -0x24]
006c7fb3 : SUB EAX,0x1
006c7fb6 : MOV dword ptr [EBP + -0x24],EAX
006c7fb9 : JMP 0x006c7ee6
006c7fbe : MOV ECX,dword ptr [EBP + 0x8]
006c7fc1 : MOVZX EDX,byte ptr [ECX + 0xa]
006c7fc5 : ADD EDX,0x2
006c7fc8 : MOV EAX,dword ptr [EBP + 0x8]
006c7fcb : MOV byte ptr [EAX + 0xa],DL
006c7fce : MOV ECX,dword ptr [EBP + 0x8]
006c7fd1 : MOVZX EDX,byte ptr [ECX + 0x8]
006c7fd5 : OR EDX,0x2
006c7fd8 : MOV EAX,dword ptr [EBP + 0x8]
006c7fdb : MOV byte ptr [EAX + 0x8],DL
006c7fde : MOV ECX,dword ptr [EBP + 0x8]
006c7fe1 : MOVZX EDX,byte ptr [ECX + 0xa]
006c7fe5 : MOV EAX,dword ptr [EBP + 0x8]
006c7fe8 : MOVZX ECX,byte ptr [EAX + 0x9]
006c7fec : IMUL EDX,ECX
006c7fef : MOV EAX,dword ptr [EBP + 0x8]
006c7ff2 : MOV byte ptr [EAX + 0xb],DL
006c7ff5 : MOV ECX,dword ptr [EBP + 0x8]
006c7ff8 : MOVZX EDX,byte ptr [ECX + 0xb]
006c7ffc : CMP EDX,0x8
006c7fff : JL 0x006c8014
006c8001 : MOV EAX,dword ptr [EBP + 0x8]
006c8004 : MOVZX ECX,byte ptr [EAX + 0xb]
006c8008 : SHR ECX,0x3
006c800b : IMUL ECX,dword ptr [EBP + -0x8]
006c800f : MOV dword ptr [EBP + -0x2c],ECX
006c8012 : JMP 0x006c8028
006c8014 : MOV EDX,dword ptr [EBP + 0x8]
006c8017 : MOVZX EAX,byte ptr [EDX + 0xb]
006c801b : IMUL EAX,dword ptr [EBP + -0x8]
006c801f : ADD EAX,0x7
006c8022 : SHR EAX,0x3
006c8025 : MOV dword ptr [EBP + -0x2c],EAX
006c8028 : MOV ECX,dword ptr [EBP + 0x8]
006c802b : MOV EDX,dword ptr [EBP + -0x2c]
006c802e : MOV dword ptr [ECX + 0x4],EDX
006c8031 : MOV ESP,EBP
006c8033 : POP EBP
006c8034 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00597be0
ENTRY    : 00597be0
BODY     : [[00597be0, 00597c63]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00597be0(void)

{
  undefined4 *puVar1;
  undefined4 *in_ECX;
  
  *in_ECX = &PTR_FUN_00cd3f2c;
  in_ECX[1] = 1;
  in_ECX[2] = 0x1b;
  *in_ECX = &PTR_FUN_00b8eca0;
  puVar1 = (undefined4 *)FUN_00515840(0x18,0);
  if (puVar1 != (undefined4 *)0x0) {
    *puVar1 = 0;
    puVar1[1] = 0;
    FUN_0051b6e0();
    FUN_0051b6e0();
    *(undefined1 *)(puVar1 + 5) = 0;
    FUN_0051bb20("IME.swf");
    in_ECX[3] = puVar1;
    in_ECX[4] = 3;
    return;
  }
  in_ECX[3] = 0;
  in_ECX[4] = 3;
  return;
}



============================================================
DISASSEMBLY
============================================================
00597be0 : PUSH ESI
00597be1 : PUSH EDI
00597be2 : MOV EDI,ECX
00597be4 : MOV dword ptr [EDI],0xcd3f2c
00597bea : PUSH 0x0
00597bec : MOV dword ptr [EDI + 0x4],0x1
00597bf3 : MOV dword ptr [EDI + 0x8],0x1b
00597bfa : MOV dword ptr [EDI],0xb8eca0
00597c00 : MOV ECX,dword ptr [0x00d73250]
00597c06 : PUSH 0x18
00597c08 : CALL 0x00515840
00597c0d : MOV ESI,EAX
00597c0f : TEST ESI,ESI
00597c11 : JZ 0x00597c53
00597c13 : PUSH EBP
00597c14 : LEA EBP,[ESI + 0xc]
00597c17 : MOV dword ptr [ESI],0x0
00597c1d : MOV ECX,EBP
00597c1f : MOV dword ptr [ESI + 0x4],0x0
00597c26 : CALL 0x0051b6e0
00597c2b : LEA ECX,[ESI + 0x10]
00597c2e : CALL 0x0051b6e0
00597c33 : PUSH 0xb8ec50
00597c38 : MOV ECX,EBP
00597c3a : MOV byte ptr [ESI + 0x14],0x0
00597c3e : CALL 0x0051bb20
00597c43 : POP EBP
00597c44 : MOV dword ptr [EDI + 0xc],ESI
00597c47 : MOV dword ptr [EDI + 0x10],0x3
00597c4e : MOV EAX,EDI
00597c50 : POP EDI
00597c51 : POP ESI
00597c52 : RET
00597c53 : XOR ESI,ESI
00597c55 : MOV dword ptr [EDI + 0xc],ESI
00597c58 : MOV dword ptr [EDI + 0x10],0x3
00597c5f : MOV EAX,EDI
00597c61 : POP EDI
00597c62 : POP ESI
00597c63 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_008541c0
ENTRY    : 008541c0
BODY     : [[008541c0, 008544d3]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008541c0(void)

{
  char cVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  int in_ECX;
  undefined1 auStack_44 [4];
  int local_40;
  undefined4 local_3c;
  undefined1 local_38;
  undefined1 local_37;
  undefined4 local_34;
  undefined4 local_30;
  undefined2 local_2c;
  undefined1 local_2a;
  undefined4 local_28;
  undefined1 local_24;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_00b62d07;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_44;
  ExceptionList = &local_14;
  if (*(char *)(in_ECX + 0x65d) == '\0') {
    local_34 = 0;
    local_30 = 0;
    local_2c = 0;
    local_24 = 0;
    local_38 = 0;
    local_2a = 1;
    local_28 = 1;
    local_37 = 0x28;
    FUN_0041dea0(&local_38);
  }
  else if (*(char *)(*(int *)(in_ECX + 0x18a8) + 0x20) != '\0') {
    (**(code **)(*(int *)(*(int *)(*(int *)(in_ECX + 0x138) + 4) + 0x138 + in_ECX) + 0x10))
              (in_ECX + 0x1d38,1,1,1,DAT_00d66fa0 ^ (uint)&stack0xffffffb0);
    piVar2 = (int *)FUN_004049b0(*(undefined4 *)(*(int *)(in_ECX + 0x18a8) + 0x28));
    if (piVar2 != (int *)0x0) {
      iVar3 = (**(code **)(*piVar2 + 0x38))();
      if (iVar3 != 0) {
        FUN_00404350(piVar2 + 0x31);
        local_1c = 0;
        cVar1 = FUN_004049e0();
        if (cVar1 != '\0') {
          FUN_008980b0(&stack0xffffffb8,1);
        }
        FUN_0088e570(0x12);
        local_1c = 0xffffffff;
        FUN_00406560();
      }
    }
    FUN_0085bfe0(in_ECX,1);
    FUN_0085c1c0();
    FUN_0083bb00(0);
    FUN_0083ba10();
    (**(code **)(*(int *)(*(int *)(*(int *)(in_ECX + 0x138) + 4) + 0x138 + in_ECX) + 0x10))
              (in_ECX + 0x6d8,1,0,1);
    *(undefined4 *)(in_ECX + 0x19ec) = 0;
    *(undefined4 *)(in_ECX + 0x1a68) = 0;
    FUN_00856310(&DAT_00d720f0);
    if (*(char *)(in_ECX + 0x4d4) != '\0') {
      FUN_0084c320(1);
      iVar3 = *(int *)(in_ECX + 0x17f0);
      *(undefined1 *)(iVar3 + 0x1a8) = 0;
      if (*(int **)(iVar3 + 0x168) != (int *)0x0) {
        (**(code **)(**(int **)(iVar3 + 0x168) + 0x10))(0);
      }
      if (*(int **)(iVar3 + 0x16c) != (int *)0x0) {
        (**(code **)(**(int **)(iVar3 + 0x16c) + 0x10))(0);
      }
      FUN_0084c320(1);
      iVar3 = *(int *)(in_ECX + 0x1870);
      *(undefined1 *)(iVar3 + 0x1a8) = 0;
      if (*(int **)(iVar3 + 0x168) != (int *)0x0) {
        (**(code **)(**(int **)(iVar3 + 0x168) + 0x10))(0);
      }
      if (*(int **)(iVar3 + 0x16c) != (int *)0x0) {
        (**(code **)(**(int **)(iVar3 + 0x16c) + 0x10))(0);
      }
      FUN_0084c320(1);
      *(undefined1 *)(in_ECX + 0x198c) = 1;
      *(undefined1 *)(in_ECX + 0x4d4) = 0;
    }
  }
  iVar3 = *(int *)(in_ECX + 0x17f0);
  if (iVar3 != 0) {
    *(undefined1 *)(iVar3 + 0x1a8) = 1;
    if (*(int **)(iVar3 + 0x168) != (int *)0x0) {
      (**(code **)(**(int **)(iVar3 + 0x168) + 0x10))(1);
    }
    if (*(int **)(iVar3 + 0x16c) != (int *)0x0) {
      (**(code **)(**(int **)(iVar3 + 0x16c) + 0x10))(1);
    }
  }
  iVar4 = DAT_00d7c54c;
  iVar3 = *(int *)(in_ECX + 0x1870);
  if (iVar3 != 0) {
    local_3c = *(undefined4 *)(iVar3 + 0x28);
    FUN_004437f0(&local_3c);
    if ((local_40 != *(int *)(iVar4 + 0x44)) && (*(int **)(local_40 + 0x10) != (int *)0x0)) {
      iVar4 = (**(code **)(**(int **)(local_40 + 0x10) + 0x68))();
      if (iVar4 != 0) {
        *(undefined1 *)(iVar3 + 0x1a8) = 1;
        if (*(int **)(iVar3 + 0x168) != (int *)0x0) {
          (**(code **)(**(int **)(iVar3 + 0x168) + 0x10))(1);
        }
        if (*(int **)(iVar3 + 0x16c) != (int *)0x0) {
          (**(code **)(**(int **)(iVar3 + 0x16c) + 0x10))(1);
        }
      }
    }
  }
  FUN_00885200();
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_44);
  return;
}



============================================================
DISASSEMBLY
============================================================
008541c0 : PUSH EBP
008541c1 : MOV EBP,ESP
008541c3 : AND ESP,0xfffffff8
008541c6 : PUSH -0x1
008541c8 : PUSH 0xb62d07
008541cd : MOV EAX,FS:[0x0]
008541d3 : PUSH EAX
008541d4 : SUB ESP,0x30
008541d7 : MOV EAX,[0x00d66fa0]
008541dc : XOR EAX,ESP
008541de : MOV dword ptr [ESP + 0x28],EAX
008541e2 : PUSH EBX
008541e3 : PUSH ESI
008541e4 : PUSH EDI
008541e5 : MOV EAX,[0x00d66fa0]
008541ea : XOR EAX,ESP
008541ec : PUSH EAX
008541ed : LEA EAX,[ESP + 0x40]
008541f1 : MOV FS:[0x0],EAX
008541f7 : MOV EBX,ECX
008541f9 : CMP byte ptr [EBX + 0x65d],0x0
00854200 : JNZ 0x00854240
00854202 : XOR EAX,EAX
00854204 : LEA ECX,[ESP + 0x1c]
00854208 : MOV dword ptr [ESP + 0x20],EAX
0085420c : MOV dword ptr [ESP + 0x24],EAX
00854210 : MOV word ptr [ESP + 0x28],AX
00854215 : MOV byte ptr [ESP + 0x30],AL
00854219 : MOV byte ptr [ESP + 0x1c],AL
0085421d : PUSH ECX
0085421e : LEA EAX,[EBX + 0x19a4]
00854224 : MOV byte ptr [ESP + 0x2e],0x1
00854229 : MOV dword ptr [ESP + 0x30],0x1
00854231 : MOV byte ptr [ESP + 0x21],0x28
00854236 : CALL 0x0041dea0
0085423b : JMP 0x00854408
00854240 : MOV EDX,dword ptr [EBX + 0x18a8]
00854246 : CMP byte ptr [EDX + 0x20],0x0
0085424a : JZ 0x00854408
00854250 : MOV EAX,dword ptr [EBX + 0x138]
00854256 : MOV ECX,dword ptr [EAX + 0x4]
00854259 : MOV EDX,dword ptr [ECX + EBX*0x1 + 0x138]
00854260 : MOV EDX,dword ptr [EDX + 0x10]
00854263 : PUSH 0x1
00854265 : PUSH 0x1
00854267 : LEA ECX,[ECX + EBX*0x1 + 0x138]
0085426e : PUSH 0x1
00854270 : LEA EAX,[EBX + 0x1d38]
00854276 : PUSH EAX
00854277 : CALL EDX
00854279 : MOV EAX,dword ptr [EBX + 0x18a8]
0085427f : MOV EAX,dword ptr [EAX + 0x28]
00854282 : PUSH EAX
00854283 : CALL 0x004049b0
00854288 : MOV ESI,EAX
0085428a : XOR EDI,EDI
0085428c : ADD ESP,0x4
0085428f : CMP ESI,EDI
00854291 : JZ 0x008542f1
00854293 : MOV EDX,dword ptr [ESI]
00854295 : MOV EAX,dword ptr [EDX + 0x38]
00854298 : MOV ECX,ESI
0085429a : CALL EAX
0085429c : TEST EAX,EAX
0085429e : JZ 0x008542f1
008542a0 : ADD ESI,0xc4
008542a6 : PUSH ESI
008542a7 : LEA ESI,[ESP + 0x20]
008542ab : CALL 0x00404350
008542b0 : ADD ESP,0x4
008542b3 : MOV dword ptr [ESP + 0x48],EDI
008542b7 : MOV ESI,0xc3f4c8
008542bc : LEA ECX,[ESP + 0x1c]
008542c0 : CALL 0x004049e0
008542c5 : TEST AL,AL
008542c7 : JZ 0x008542d7
008542c9 : PUSH 0x1
008542cb : LEA ECX,[ESP + 0x20]
008542cf : PUSH ECX
008542d0 : MOV ESI,EBX
008542d2 : CALL 0x008980b0
008542d7 : PUSH 0x12
008542d9 : MOV ECX,EBX
008542db : CALL 0x0088e570
008542e0 : MOV dword ptr [ESP + 0x48],0xffffffff
008542e8 : LEA ECX,[ESP + 0x1c]
008542ec : CALL 0x00406560
008542f1 : PUSH 0x1
008542f3 : PUSH EBX
008542f4 : CALL 0x0085bfe0
008542f9 : MOV ECX,EBX
008542fb : CALL 0x0085c1c0
00854300 : MOV ECX,dword ptr [EBX + 0x18a8]
00854306 : PUSH EDI
00854307 : XOR AL,AL
00854309 : CALL 0x0083bb00
0085430e : MOV ESI,dword ptr [EBX + 0x18a8]
00854314 : CALL 0x0083ba10
00854319 : MOV EDX,dword ptr [EBX + 0x138]
0085431f : MOV EAX,dword ptr [EDX + 0x4]
00854322 : MOV EDX,dword ptr [EAX + EBX*0x1 + 0x138]
00854329 : MOV EDX,dword ptr [EDX + 0x10]
0085432c : PUSH 0x1
0085432e : LEA ECX,[EAX + EBX*0x1 + 0x138]
00854335 : PUSH EDI
00854336 : PUSH 0x1
00854338 : LEA EAX,[EBX + 0x6d8]
0085433e : PUSH EAX
0085433f : CALL EDX
00854341 : XORPS XMM0,XMM0
00854344 : PUSH 0xd720f0
00854349 : MOV ESI,EBX
0085434b : MOV dword ptr [EBX + 0x19ec],EDI
00854351 : MOVSS dword ptr [EBX + 0x1a68],XMM0
00854359 : CALL 0x00856310
0085435e : CMP byte ptr [EBX + 0x4d4],0x0
00854365 : JZ 0x00854408
0085436b : MOV EDI,dword ptr [EBX + 0x17f0]
00854371 : PUSH 0x1
00854373 : CALL 0x0084c320
00854378 : MOV ESI,dword ptr [EBX + 0x17f0]
0085437e : MOV ECX,dword ptr [ESI + 0x168]
00854384 : MOV byte ptr [ESI + 0x1a8],0x0
0085438b : TEST ECX,ECX
0085438d : JZ 0x00854398
0085438f : MOV EAX,dword ptr [ECX]
00854391 : MOV EDX,dword ptr [EAX + 0x10]
00854394 : PUSH 0x0
00854396 : CALL EDX
00854398 : MOV ECX,dword ptr [ESI + 0x16c]
0085439e : TEST ECX,ECX
008543a0 : JZ 0x008543ab
008543a2 : MOV EAX,dword ptr [ECX]
008543a4 : MOV EDX,dword ptr [EAX + 0x10]
008543a7 : PUSH 0x0
008543a9 : CALL EDX
008543ab : MOV EDI,dword ptr [EBX + 0x1870]
008543b1 : PUSH 0x1
008543b3 : CALL 0x0084c320
008543b8 : MOV ESI,dword ptr [EBX + 0x1870]
008543be : MOV ECX,dword ptr [ESI + 0x168]
008543c4 : MOV byte ptr [ESI + 0x1a8],0x0
008543cb : TEST ECX,ECX
008543cd : JZ 0x008543d8
008543cf : MOV EAX,dword ptr [ECX]
008543d1 : MOV EDX,dword ptr [EAX + 0x10]
008543d4 : PUSH 0x0
008543d6 : CALL EDX
008543d8 : MOV ESI,dword ptr [ESI + 0x16c]
008543de : TEST ESI,ESI
008543e0 : JZ 0x008543ed
008543e2 : MOV EAX,dword ptr [ESI]
008543e4 : MOV EDX,dword ptr [EAX + 0x10]
008543e7 : PUSH 0x0
008543e9 : MOV ECX,ESI
008543eb : CALL EDX
008543ed : MOV EDI,dword ptr [EBX + 0x17f4]
008543f3 : PUSH 0x1
008543f5 : CALL 0x0084c320
008543fa : MOV byte ptr [EBX + 0x198c],0x1
00854401 : MOV byte ptr [EBX + 0x4d4],0x0
00854408 : MOV ESI,dword ptr [EBX + 0x17f0]
0085440e : TEST ESI,ESI
00854410 : JZ 0x0085443f
00854412 : MOV ECX,dword ptr [ESI + 0x168]
00854418 : MOV byte ptr [ESI + 0x1a8],0x1
0085441f : TEST ECX,ECX
00854421 : JZ 0x0085442c
00854423 : MOV EAX,dword ptr [ECX]
00854425 : MOV EDX,dword ptr [EAX + 0x10]
00854428 : PUSH 0x1
0085442a : CALL EDX
0085442c : MOV ECX,dword ptr [ESI + 0x16c]
00854432 : TEST ECX,ECX
00854434 : JZ 0x0085443f
00854436 : MOV EAX,dword ptr [ECX]
00854438 : MOV EDX,dword ptr [EAX + 0x10]
0085443b : PUSH 0x1
0085443d : CALL EDX
0085443f : MOV ESI,dword ptr [EBX + 0x1870]
00854445 : TEST ESI,ESI
00854447 : JZ 0x008544af
00854449 : MOV EAX,dword ptr [ESI + 0x28]
0085444c : MOV EDI,dword ptr [0x00d7c54c]
00854452 : LEA ECX,[ESP + 0x18]
00854456 : MOV dword ptr [ESP + 0x18],EAX
0085445a : PUSH ECX
0085445b : LEA ECX,[EDI + 0x40]
0085445e : LEA EAX,[ESP + 0x18]
00854462 : CALL 0x004437f0
00854467 : MOV EAX,dword ptr [ESP + 0x14]
0085446b : CMP EAX,dword ptr [EDI + 0x44]
0085446e : JZ 0x008544af
00854470 : MOV ECX,dword ptr [EAX + 0x10]
00854473 : TEST ECX,ECX
00854475 : JZ 0x008544af
00854477 : MOV EDX,dword ptr [ECX]
00854479 : MOV EAX,dword ptr [EDX + 0x68]
0085447c : CALL EAX
0085447e : TEST EAX,EAX
00854480 : JZ 0x008544af
00854482 : MOV ECX,dword ptr [ESI + 0x168]
00854488 : MOV byte ptr [ESI + 0x1a8],0x1
0085448f : TEST ECX,ECX
00854491 : JZ 0x0085449c
00854493 : MOV EDX,dword ptr [ECX]
00854495 : MOV EAX,dword ptr [EDX + 0x10]
00854498 : PUSH 0x1
0085449a : CALL EAX
0085449c : MOV ECX,dword ptr [ESI + 0x16c]
008544a2 : TEST ECX,ECX
008544a4 : JZ 0x008544af
008544a6 : MOV EDX,dword ptr [ECX]
008544a8 : MOV EAX,dword ptr [EDX + 0x10]
008544ab : PUSH 0x1
008544ad : CALL EAX
008544af : MOV ECX,EBX
008544b1 : CALL 0x00885200
008544b6 : MOV ECX,dword ptr [ESP + 0x40]
008544ba : MOV dword ptr FS:[0x0],ECX
008544c1 : POP ECX
008544c2 : POP EDI
008544c3 : POP ESI
008544c4 : POP EBX
008544c5 : MOV ECX,dword ptr [ESP + 0x28]
008544c9 : XOR ECX,ESP
008544cb : CALL 0x00633e6b
008544d0 : MOV ESP,EBP
008544d2 : POP EBP
008544d3 : RET

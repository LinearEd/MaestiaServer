PROGRAM  : Maestia.exe
FUNCTION : FUN_00408540
ENTRY    : 00408540
BODY     : [[00408540, 00408913]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00408540(int param_1,uint param_2,undefined4 *param_3,undefined4 *param_4)

{
  uint in_EAX;
  uint uVar1;
  undefined2 *puVar2;
  uint uVar3;
  int iVar4;
  uint in_ECX;
  int iVar5;
  uint uVar6;
  undefined4 *puVar7;
  undefined4 *puVar8;
  int iVar9;
  undefined4 *local_c;
  
  if ((*(uint *)(param_1 + 0x14) < in_ECX) || (*(uint *)((int)param_3 + 0x14) < param_4)) {
    FUN_00622f07();
  }
  uVar1 = *(int *)(param_1 + 0x14) - in_ECX;
  if (uVar1 < param_2) {
    param_2 = uVar1;
  }
  uVar1 = *(int *)((int)param_3 + 0x14) - (int)param_4;
  if (uVar1 < in_EAX) {
    in_EAX = uVar1;
  }
  if (-in_EAX - 1 <= *(int *)(param_1 + 0x14) - param_2) {
    FUN_00622ecf();
  }
  uVar1 = *(uint *)(param_1 + 0x14);
  iVar5 = (uVar1 - in_ECX) - param_2;
  uVar6 = (uVar1 - param_2) + in_EAX;
  if (uVar1 < uVar6) {
    if (0x7ffffffe < uVar6) {
      FUN_00622ecf();
    }
    if (*(uint *)(param_1 + 0x18) < uVar6) {
      FUN_00406170(uVar6,*(undefined4 *)(param_1 + 0x14));
    }
    else if (uVar6 == 0) {
      *(undefined4 *)(param_1 + 0x14) = 0;
      if (*(uint *)(param_1 + 0x18) < 8) {
        puVar2 = (undefined2 *)(param_1 + 4);
      }
      else {
        puVar2 = *(undefined2 **)(param_1 + 4);
      }
      *puVar2 = 0;
    }
  }
  if ((undefined4 *)param_1 == param_3) {
    if (param_2 < in_EAX) {
      if (in_ECX < param_4) {
        uVar3 = param_2 + in_ECX;
        uVar1 = *(uint *)(param_1 + 0x18);
        if (param_4 < uVar3) {
          puVar7 = (undefined4 *)(param_1 + 4);
          puVar8 = puVar7;
          local_c = puVar7;
          if (7 < uVar1) {
            puVar8 = (undefined4 *)*puVar7;
            local_c = (undefined4 *)*puVar7;
          }
          FUN_00405de0((int)local_c + in_ECX * 2,uVar1 - in_ECX,(int)puVar8 + (int)param_4 * 2,
                       param_2);
          puVar8 = puVar7;
          local_c = puVar7;
          if (7 < *(uint *)(param_1 + 0x18)) {
            puVar8 = (undefined4 *)*puVar7;
            local_c = (undefined4 *)*puVar7;
          }
          FUN_00405de0((int)local_c + (in_ECX + in_EAX) * 2,
                       (*(uint *)(param_1 + 0x18) - in_ECX) - in_EAX,(int)puVar8 + uVar3 * 2,iVar5);
          local_c = puVar7;
          if (7 < *(uint *)(param_1 + 0x18)) {
            local_c = (undefined4 *)*puVar7;
            puVar7 = (undefined4 *)*puVar7;
          }
          uVar1 = in_EAX - param_2;
          iVar4 = (*(uint *)(param_1 + 0x18) - in_ECX) - param_2;
          iVar5 = (int)local_c + ((int)param_4 + in_EAX) * 2;
          iVar9 = (int)puVar7 + uVar3 * 2;
        }
        else {
          puVar7 = (undefined4 *)(param_1 + 4);
          puVar8 = puVar7;
          local_c = puVar7;
          if (7 < uVar1) {
            puVar8 = (undefined4 *)*puVar7;
            local_c = (undefined4 *)*puVar7;
          }
          FUN_00405de0((int)local_c + (in_ECX + in_EAX) * 2,(uVar1 - in_ECX) - in_EAX,
                       (int)puVar8 + uVar3 * 2,iVar5);
          param_3 = puVar7;
          if (7 < *(uint *)(param_1 + 0x18)) {
            param_3 = (undefined4 *)*puVar7;
            puVar7 = (undefined4 *)*puVar7;
          }
          iVar5 = (int)param_3 + (((int)param_4 - param_2) + in_EAX) * 2;
          iVar4 = *(uint *)(param_1 + 0x18) - in_ECX;
          iVar9 = (int)puVar7 + in_ECX * 2;
          uVar1 = in_EAX;
        }
        FUN_00405de0(iVar9,iVar4,iVar5,uVar1);
      }
      else {
        puVar7 = (undefined4 *)(param_1 + 4);
        puVar8 = puVar7;
        param_3 = puVar7;
        if (7 < *(uint *)(param_1 + 0x18)) {
          puVar8 = (undefined4 *)*puVar7;
          param_3 = (undefined4 *)*puVar7;
        }
        _memmove_s((void *)((int)param_3 + (in_ECX + in_EAX) * 2),
                   ((*(uint *)(param_1 + 0x18) - in_ECX) - in_EAX) * 2,
                   (void *)((int)puVar8 + (param_2 + in_ECX) * 2),iVar5 * 2);
        puVar8 = puVar7;
        if (7 < *(uint *)(param_1 + 0x18)) {
          puVar8 = (undefined4 *)*puVar7;
          puVar7 = (undefined4 *)*puVar7;
        }
        _memmove_s((void *)((int)puVar7 + in_ECX * 2),(*(uint *)(param_1 + 0x18) - in_ECX) * 2,
                   (void *)((int)puVar8 + (int)param_4 * 2),in_EAX * 2);
      }
    }
    else {
      puVar8 = (undefined4 *)(param_1 + 4);
      puVar7 = puVar8;
      param_3 = puVar8;
      if (7 < *(uint *)(param_1 + 0x18)) {
        puVar7 = (undefined4 *)*puVar8;
        param_3 = (undefined4 *)*puVar8;
      }
      _memmove_s((void *)((int)param_3 + in_ECX * 2),(*(uint *)(param_1 + 0x18) - in_ECX) * 2,
                 (void *)((int)puVar7 + (int)param_4 * 2),in_EAX * 2);
      param_4 = puVar8;
      if (7 < *(uint *)(param_1 + 0x18)) {
        param_4 = (undefined4 *)*puVar8;
        puVar8 = (undefined4 *)*puVar8;
      }
      _memmove_s((void *)((int)param_4 + (in_ECX + in_EAX) * 2),
                 ((*(uint *)(param_1 + 0x18) - in_ECX) - in_EAX) * 2,
                 (void *)((int)puVar8 + (param_2 + in_ECX) * 2),iVar5 * 2);
    }
  }
  else {
    puVar7 = (undefined4 *)(param_1 + 4);
    puVar8 = puVar7;
    local_c = puVar7;
    if (7 < *(uint *)(param_1 + 0x18)) {
      puVar8 = (undefined4 *)*puVar7;
      local_c = (undefined4 *)*puVar7;
    }
    _memmove_s((void *)((int)local_c + (in_ECX + in_EAX) * 2),
               ((*(uint *)(param_1 + 0x18) - in_ECX) - in_EAX) * 2,
               (void *)((int)puVar8 + (param_2 + in_ECX) * 2),iVar5 * 2);
    if (*(uint *)((int)param_3 + 0x18) < 8) {
      iVar5 = (int)param_3 + 4;
    }
    else {
      iVar5 = *(int *)((int)param_3 + 4);
    }
    if (7 < *(uint *)(param_1 + 0x18)) {
      puVar7 = (undefined4 *)*puVar7;
    }
    _memcpy_s((void *)((int)puVar7 + in_ECX * 2),(*(uint *)(param_1 + 0x18) - in_ECX) * 2,
              (void *)(iVar5 + (int)param_4 * 2),in_EAX * 2);
  }
  puVar7 = (undefined4 *)(param_1 + 4);
  *(uint *)(param_1 + 0x14) = uVar6;
  if (7 < *(uint *)(param_1 + 0x18)) {
    puVar7 = (undefined4 *)*puVar7;
  }
  *(undefined2 *)((int)puVar7 + uVar6 * 2) = 0;
  return;
}



============================================================
DISASSEMBLY
============================================================
00408540 : PUSH EBP
00408541 : MOV EBP,ESP
00408543 : SUB ESP,0xc
00408546 : PUSH EBX
00408547 : MOV EBX,dword ptr [EBP + 0x8]
0040854a : PUSH ESI
0040854b : MOV ESI,ECX
0040854d : PUSH EDI
0040854e : MOV EDI,EAX
00408550 : CMP dword ptr [EBX + 0x14],ESI
00408553 : JC 0x00408560
00408555 : MOV EAX,dword ptr [EBP + 0x10]
00408558 : MOV ECX,dword ptr [EAX + 0x14]
0040855b : CMP ECX,dword ptr [EBP + 0x14]
0040855e : JNC 0x00408565
00408560 : CALL 0x00622f07
00408565 : MOV ECX,dword ptr [EBX + 0x14]
00408568 : MOV EDX,dword ptr [EBP + 0xc]
0040856b : MOV EAX,ECX
0040856d : SUB EAX,ESI
0040856f : CMP EAX,EDX
00408571 : JNC 0x00408578
00408573 : MOV EDX,EAX
00408575 : MOV dword ptr [EBP + 0xc],EDX
00408578 : MOV EAX,dword ptr [EBP + 0x10]
0040857b : MOV EAX,dword ptr [EAX + 0x14]
0040857e : SUB EAX,dword ptr [EBP + 0x14]
00408581 : CMP EAX,EDI
00408583 : CMOVC EDI,EAX
00408586 : SUB ECX,EDX
00408588 : OR EDX,0xffffffff
0040858b : SUB EDX,EDI
0040858d : CMP EDX,ECX
0040858f : JA 0x00408596
00408591 : CALL 0x00622ecf
00408596 : MOV EDX,EBX
00408598 : MOV EAX,dword ptr [EDX + 0x14]
0040859b : MOV EBX,EAX
0040859d : SUB EBX,dword ptr [EBP + 0xc]
004085a0 : MOV ECX,EAX
004085a2 : SUB ECX,ESI
004085a4 : SUB ECX,dword ptr [EBP + 0xc]
004085a7 : ADD EBX,EDI
004085a9 : MOV dword ptr [EBP + -0x4],ECX
004085ac : MOV dword ptr [EBP + -0xc],EBX
004085af : CMP EAX,EBX
004085b1 : JNC 0x004085f5
004085b3 : CMP EBX,0x7ffffffe
004085b9 : JBE 0x004085c3
004085bb : CALL 0x00622ecf
004085c0 : MOV EDX,dword ptr [EBP + 0x8]
004085c3 : MOV EAX,dword ptr [EDX + 0x18]
004085c6 : CMP EAX,EBX
004085c8 : JNC 0x004085dc
004085ca : MOV ECX,dword ptr [EBP + 0x8]
004085cd : MOV EAX,dword ptr [ECX + 0x14]
004085d0 : PUSH EAX
004085d1 : PUSH EBX
004085d2 : CALL 0x00406170
004085d7 : MOV EDX,dword ptr [EBP + 0x8]
004085da : JMP 0x004085f5
004085dc : TEST EBX,EBX
004085de : JNZ 0x004085f5
004085e0 : MOV dword ptr [EDX + 0x14],EBX
004085e3 : CMP EAX,0x8
004085e6 : JC 0x004085ed
004085e8 : MOV EAX,dword ptr [EDX + 0x4]
004085eb : JMP 0x004085f0
004085ed : LEA EAX,[EDX + 0x4]
004085f0 : XOR ECX,ECX
004085f2 : MOV word ptr [EAX],CX
004085f5 : MOV EBX,dword ptr [EBP + 0x8]
004085f8 : CMP EDX,dword ptr [EBP + 0x10]
004085fb : JZ 0x0040868a
00408601 : MOV EAX,dword ptr [EDX + 0x18]
00408604 : ADD EBX,0x4
00408607 : CMP EAX,0x8
0040860a : JC 0x00408610
0040860c : MOV ECX,dword ptr [EBX]
0040860e : JMP 0x00408612
00408610 : MOV ECX,EBX
00408612 : CMP EAX,0x8
00408615 : JC 0x0040861e
00408617 : MOV EDX,dword ptr [EBX]
00408619 : MOV dword ptr [EBP + -0x8],EDX
0040861c : JMP 0x00408621
0040861e : MOV dword ptr [EBP + -0x8],EBX
00408621 : MOV EDX,dword ptr [EBP + -0x4]
00408624 : ADD EDX,EDX
00408626 : PUSH EDX
00408627 : MOV EDX,dword ptr [EBP + 0xc]
0040862a : SUB EAX,ESI
0040862c : ADD EDX,ESI
0040862e : LEA ECX,[ECX + EDX*0x2]
00408631 : SUB EAX,EDI
00408633 : PUSH ECX
00408634 : ADD EAX,EAX
00408636 : PUSH EAX
00408637 : MOV EAX,dword ptr [EBP + -0x8]
0040863a : LEA EDX,[ESI + EDI*0x1]
0040863d : LEA ECX,[EAX + EDX*0x2]
00408640 : PUSH ECX
00408641 : CALL 0x00634101
00408646 : MOV EDX,dword ptr [EBP + 0x10]
00408649 : ADD ESP,0x10
0040864c : CMP dword ptr [EDX + 0x18],0x8
00408650 : JC 0x00408659
00408652 : MOV EAX,EDX
00408654 : MOV EDX,dword ptr [EAX + 0x4]
00408657 : JMP 0x0040865c
00408659 : ADD EDX,0x4
0040865c : MOV ECX,dword ptr [EBP + 0x8]
0040865f : MOV EAX,dword ptr [ECX + 0x18]
00408662 : CMP EAX,0x8
00408665 : JC 0x0040866b
00408667 : MOV ECX,dword ptr [EBX]
00408669 : JMP 0x0040866d
0040866b : MOV ECX,EBX
0040866d : ADD EDI,EDI
0040866f : PUSH EDI
00408670 : MOV EDI,dword ptr [EBP + 0x14]
00408673 : SUB EAX,ESI
00408675 : LEA EDX,[EDX + EDI*0x2]
00408678 : PUSH EDX
00408679 : ADD EAX,EAX
0040867b : PUSH EAX
0040867c : LEA EAX,[ECX + ESI*0x2]
0040867f : PUSH EAX
00408680 : CALL 0x00633ea4
00408685 : JMP 0x004088f1
0040868a : CMP EDI,dword ptr [EBP + 0xc]
0040868d : JA 0x0040871b
00408693 : MOV EAX,dword ptr [EDX + 0x18]
00408696 : ADD EBX,0x4
00408699 : CMP EAX,0x8
0040869c : JC 0x004086a2
0040869e : MOV ECX,dword ptr [EBX]
004086a0 : JMP 0x004086a4
004086a2 : MOV ECX,EBX
004086a4 : CMP EAX,0x8
004086a7 : JC 0x004086b0
004086a9 : MOV EDX,dword ptr [EBX]
004086ab : MOV dword ptr [EBP + 0x10],EDX
004086ae : JMP 0x004086b3
004086b0 : MOV dword ptr [EBP + 0x10],EBX
004086b3 : LEA EDX,[EDI + EDI*0x1]
004086b6 : PUSH EDX
004086b7 : MOV EDX,dword ptr [EBP + 0x14]
004086ba : LEA ECX,[ECX + EDX*0x2]
004086bd : MOV EDX,dword ptr [EBP + 0x10]
004086c0 : SUB EAX,ESI
004086c2 : PUSH ECX
004086c3 : ADD EAX,EAX
004086c5 : PUSH EAX
004086c6 : LEA EAX,[EDX + ESI*0x2]
004086c9 : PUSH EAX
004086ca : CALL 0x00634101
004086cf : MOV ECX,dword ptr [EBP + 0x8]
004086d2 : MOV EAX,dword ptr [ECX + 0x18]
004086d5 : ADD ESP,0x10
004086d8 : CMP EAX,0x8
004086db : JC 0x004086e1
004086dd : MOV ECX,dword ptr [EBX]
004086df : JMP 0x004086e3
004086e1 : MOV ECX,EBX
004086e3 : CMP EAX,0x8
004086e6 : JC 0x004086ef
004086e8 : MOV EDX,dword ptr [EBX]
004086ea : MOV dword ptr [EBP + 0x14],EDX
004086ed : JMP 0x004086f2
004086ef : MOV dword ptr [EBP + 0x14],EBX
004086f2 : MOV EDX,dword ptr [EBP + -0x4]
004086f5 : ADD EDX,EDX
004086f7 : PUSH EDX
004086f8 : MOV EDX,dword ptr [EBP + 0xc]
004086fb : SUB EAX,ESI
004086fd : ADD EDX,ESI
004086ff : LEA ECX,[ECX + EDX*0x2]
00408702 : MOV EDX,dword ptr [EBP + 0x14]
00408705 : SUB EAX,EDI
00408707 : PUSH ECX
00408708 : ADD EAX,EAX
0040870a : PUSH EAX
0040870b : ADD ESI,EDI
0040870d : LEA EAX,[EDX + ESI*0x2]
00408710 : PUSH EAX
00408711 : CALL 0x00634101
00408716 : JMP 0x004088f1
0040871b : MOV ECX,dword ptr [EBP + 0x14]
0040871e : CMP ECX,ESI
00408720 : JA 0x004087a7
00408726 : MOV EAX,dword ptr [EDX + 0x18]
00408729 : ADD EBX,0x4
0040872c : CMP EAX,0x8
0040872f : JC 0x00408735
00408731 : MOV ECX,dword ptr [EBX]
00408733 : JMP 0x00408737
00408735 : MOV ECX,EBX
00408737 : CMP EAX,0x8
0040873a : JC 0x00408743
0040873c : MOV EDX,dword ptr [EBX]
0040873e : MOV dword ptr [EBP + 0x10],EDX
00408741 : JMP 0x00408746
00408743 : MOV dword ptr [EBP + 0x10],EBX
00408746 : MOV EDX,dword ptr [EBP + -0x4]
00408749 : ADD EDX,EDX
0040874b : PUSH EDX
0040874c : MOV EDX,dword ptr [EBP + 0xc]
0040874f : SUB EAX,ESI
00408751 : ADD EDX,ESI
00408753 : LEA ECX,[ECX + EDX*0x2]
00408756 : SUB EAX,EDI
00408758 : PUSH ECX
00408759 : ADD EAX,EAX
0040875b : PUSH EAX
0040875c : MOV EAX,dword ptr [EBP + 0x10]
0040875f : LEA EDX,[ESI + EDI*0x1]
00408762 : LEA ECX,[EAX + EDX*0x2]
00408765 : PUSH ECX
00408766 : CALL 0x00634101
0040876b : MOV EDX,dword ptr [EBP + 0x8]
0040876e : MOV EAX,dword ptr [EDX + 0x18]
00408771 : ADD ESP,0x10
00408774 : CMP EAX,0x8
00408777 : JC 0x0040877d
00408779 : MOV EDX,dword ptr [EBX]
0040877b : JMP 0x0040877f
0040877d : MOV EDX,EBX
0040877f : CMP EAX,0x8
00408782 : JC 0x00408788
00408784 : MOV ECX,dword ptr [EBX]
00408786 : JMP 0x0040878a
00408788 : MOV ECX,EBX
0040878a : ADD EDI,EDI
0040878c : PUSH EDI
0040878d : MOV EDI,dword ptr [EBP + 0x14]
00408790 : SUB EAX,ESI
00408792 : LEA EDX,[EDX + EDI*0x2]
00408795 : PUSH EDX
00408796 : ADD EAX,EAX
00408798 : PUSH EAX
00408799 : LEA EAX,[ECX + ESI*0x2]
0040879c : PUSH EAX
0040879d : CALL 0x00634101
004087a2 : JMP 0x004088f1
004087a7 : MOV EAX,dword ptr [EBP + 0xc]
004087aa : ADD EAX,ESI
004087ac : MOV dword ptr [EBP + 0x10],EAX
004087af : CMP EAX,ECX
004087b1 : MOV EAX,dword ptr [EDX + 0x18]
004087b4 : JA 0x00408831
004087b6 : ADD EBX,0x4
004087b9 : CMP EAX,0x8
004087bc : JC 0x004087c2
004087be : MOV ECX,dword ptr [EBX]
004087c0 : JMP 0x004087c4
004087c2 : MOV ECX,EBX
004087c4 : CMP EAX,0x8
004087c7 : JC 0x004087d0
004087c9 : MOV EDX,dword ptr [EBX]
004087cb : MOV dword ptr [EBP + -0x8],EDX
004087ce : JMP 0x004087d3
004087d0 : MOV dword ptr [EBP + -0x8],EBX
004087d3 : MOV EDX,dword ptr [EBP + -0x4]
004087d6 : PUSH EDX
004087d7 : MOV EDX,dword ptr [EBP + 0x10]
004087da : LEA ECX,[ECX + EDX*0x2]
004087dd : SUB EAX,ESI
004087df : PUSH ECX
004087e0 : SUB EAX,EDI
004087e2 : PUSH EAX
004087e3 : MOV EAX,dword ptr [EBP + -0x8]
004087e6 : LEA EDX,[ESI + EDI*0x1]
004087e9 : LEA ECX,[EAX + EDX*0x2]
004087ec : PUSH ECX
004087ed : CALL 0x00405de0
004087f2 : MOV EDX,dword ptr [EBP + 0x8]
004087f5 : MOV EAX,dword ptr [EDX + 0x18]
004087f8 : ADD ESP,0x10
004087fb : CMP EAX,0x8
004087fe : JC 0x00408807
00408800 : MOV ECX,dword ptr [EBX]
00408802 : MOV dword ptr [EBP + 0x10],ECX
00408805 : JMP 0x0040880a
00408807 : MOV dword ptr [EBP + 0x10],EBX
0040880a : CMP EAX,0x8
0040880d : JC 0x00408813
0040880f : MOV EDX,dword ptr [EBX]
00408811 : JMP 0x00408815
00408813 : MOV EDX,EBX
00408815 : MOV ECX,dword ptr [EBP + 0x14]
00408818 : SUB ECX,dword ptr [EBP + 0xc]
0040881b : PUSH EDI
0040881c : ADD ECX,EDI
0040881e : MOV EDI,dword ptr [EBP + 0x10]
00408821 : LEA ECX,[EDI + ECX*0x2]
00408824 : PUSH ECX
00408825 : SUB EAX,ESI
00408827 : PUSH EAX
00408828 : LEA EDX,[EDX + ESI*0x2]
0040882b : PUSH EDX
0040882c : JMP 0x004088ec
00408831 : ADD EBX,0x4
00408834 : CMP EAX,0x8
00408837 : JC 0x0040883d
00408839 : MOV ECX,dword ptr [EBX]
0040883b : JMP 0x0040883f
0040883d : MOV ECX,EBX
0040883f : CMP EAX,0x8
00408842 : JC 0x0040884b
00408844 : MOV EDX,dword ptr [EBX]
00408846 : MOV dword ptr [EBP + -0x8],EDX
00408849 : JMP 0x0040884e
0040884b : MOV dword ptr [EBP + -0x8],EBX
0040884e : MOV EDX,dword ptr [EBP + 0xc]
00408851 : PUSH EDX
00408852 : MOV EDX,dword ptr [EBP + 0x14]
00408855 : LEA ECX,[ECX + EDX*0x2]
00408858 : MOV EDX,dword ptr [EBP + -0x8]
0040885b : PUSH ECX
0040885c : SUB EAX,ESI
0040885e : PUSH EAX
0040885f : LEA EAX,[EDX + ESI*0x2]
00408862 : PUSH EAX
00408863 : CALL 0x00405de0
00408868 : MOV ECX,dword ptr [EBP + 0x8]
0040886b : MOV EAX,dword ptr [ECX + 0x18]
0040886e : ADD ESP,0x10
00408871 : CMP EAX,0x8
00408874 : JC 0x0040887a
00408876 : MOV ECX,dword ptr [EBX]
00408878 : JMP 0x0040887c
0040887a : MOV ECX,EBX
0040887c : CMP EAX,0x8
0040887f : JC 0x00408888
00408881 : MOV EDX,dword ptr [EBX]
00408883 : MOV dword ptr [EBP + -0x8],EDX
00408886 : JMP 0x0040888b
00408888 : MOV dword ptr [EBP + -0x8],EBX
0040888b : MOV EDX,dword ptr [EBP + -0x4]
0040888e : PUSH EDX
0040888f : MOV EDX,dword ptr [EBP + 0x10]
00408892 : LEA ECX,[ECX + EDX*0x2]
00408895 : SUB EAX,ESI
00408897 : PUSH ECX
00408898 : SUB EAX,EDI
0040889a : PUSH EAX
0040889b : MOV EAX,dword ptr [EBP + -0x8]
0040889e : LEA EDX,[ESI + EDI*0x1]
004088a1 : LEA ECX,[EAX + EDX*0x2]
004088a4 : PUSH ECX
004088a5 : CALL 0x00405de0
004088aa : MOV EDX,dword ptr [EBP + 0x8]
004088ad : MOV EAX,dword ptr [EDX + 0x18]
004088b0 : ADD ESP,0x10
004088b3 : CMP EAX,0x8
004088b6 : JC 0x004088bf
004088b8 : MOV ECX,dword ptr [EBX]
004088ba : MOV dword ptr [EBP + -0x8],ECX
004088bd : JMP 0x004088c2
004088bf : MOV dword ptr [EBP + -0x8],EBX
004088c2 : CMP EAX,0x8
004088c5 : JC 0x004088cb
004088c7 : MOV ECX,dword ptr [EBX]
004088c9 : JMP 0x004088cd
004088cb : MOV ECX,EBX
004088cd : MOV EDX,EDI
004088cf : SUB EDX,dword ptr [EBP + 0xc]
004088d2 : SUB EAX,ESI
004088d4 : PUSH EDX
004088d5 : MOV EDX,dword ptr [EBP + 0x14]
004088d8 : ADD EDX,EDI
004088da : MOV EDI,dword ptr [EBP + -0x8]
004088dd : SUB EAX,dword ptr [EBP + 0xc]
004088e0 : LEA EDX,[EDI + EDX*0x2]
004088e3 : PUSH EDX
004088e4 : PUSH EAX
004088e5 : MOV EAX,dword ptr [EBP + 0x10]
004088e8 : LEA ECX,[ECX + EAX*0x2]
004088eb : PUSH ECX
004088ec : CALL 0x00405de0
004088f1 : MOV EAX,dword ptr [EBP + 0x8]
004088f4 : MOV ECX,dword ptr [EBP + -0xc]
004088f7 : ADD ESP,0x10
004088fa : CMP dword ptr [EAX + 0x18],0x8
004088fe : MOV dword ptr [EAX + 0x14],ECX
00408901 : JC 0x00408905
00408903 : MOV EBX,dword ptr [EBX]
00408905 : POP EDI
00408906 : XOR EDX,EDX
00408908 : POP ESI
00408909 : MOV word ptr [EBX + ECX*0x2],DX
0040890d : POP EBX
0040890e : MOV ESP,EBP
00408910 : POP EBP
00408911 : RET 0x10

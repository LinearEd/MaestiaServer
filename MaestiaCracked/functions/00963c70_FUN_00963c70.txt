PROGRAM  : Maestia.exe
FUNCTION : FUN_00963c70
ENTRY    : 00963c70
BODY     : [[00963c70, 0096409b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00963c70(int *param_1,int param_2)

{
  float fVar1;
  char cVar2;
  ushort uVar3;
  int *piVar4;
  code *pcVar5;
  byte bVar6;
  short *psVar7;
  int *piVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  undefined4 local_4c [7];
  undefined4 local_30;
  int local_2c;
  uint local_28;
  int local_24;
  int local_20;
  int local_1c;
  int local_18;
  undefined4 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4cbd7;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if ((char)param_1[2] == '\0') {
    (**(code **)(*param_1 + 0xc))(DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
  }
  FUN_00961f80();
  FUN_0045cd30(*(undefined4 *)(param_1[0x15] + 4));
  *(int *)(param_1[0x15] + 4) = param_1[0x15];
  param_1[0x16] = 0;
  *(int *)param_1[0x15] = param_1[0x15];
  *(int *)(param_1[0x15] + 8) = param_1[0x15];
  FUN_0045cd30(*(undefined4 *)(param_1[0x18] + 4));
  *(int *)(param_1[0x18] + 4) = param_1[0x18];
  param_1[0x19] = 0;
  iVar10 = DAT_00d7c54c;
  *(int *)param_1[0x18] = param_1[0x18];
  *(int *)(param_1[0x18] + 8) = param_1[0x18];
  param_2 = *(undefined4 *)(param_2 + 4);
  FUN_004437f0(&param_2);
  if (local_18 == *(int *)(iVar10 + 0x44)) {
    param_2 = 0;
  }
  else {
    param_2 = *(int *)(local_18 + 0x10);
  }
  iVar10 = param_2;
  local_18 = (**(code **)(*(int *)(param_2 + 0x48) + 4))();
  do {
    while( true ) {
      if (local_18 == 0) {
        FUN_00961e80();
        FUN_00425530(param_1[0x11],param_1[0x12],param_1[0x12] - param_1[0x11] >> 3,FUN_00961f00);
        *(undefined2 *)(param_1 + 0x1d) = 0;
        iVar10 = param_1[0x11];
        if (iVar10 != param_1[0x12]) {
          do {
            uVar3 = *(ushort *)(param_1 + 0x1d);
            *(ushort *)(param_1 + 0x1d) = uVar3 + 1;
            iVar9 = ((int *)param_1[0xe])[0xf];
            if (*(int *)(iVar9 + 0xc) == 0) {
              iVar9 = -1;
              iVar11 = -1;
            }
            else {
              iVar11 = *(int *)(iVar9 + 0xc);
              iVar9 = (int)((longlong)(ulonglong)(uint)uVar3 / (longlong)iVar11);
              iVar11 = (uint)uVar3 - iVar11 * iVar9;
            }
            (**(code **)(*(int *)param_1[0xe] + 0x70))(*(undefined4 *)(iVar10 + 4),iVar11,iVar9);
            iVar10 = iVar10 + 8;
          } while (iVar10 != param_1[0x12]);
        }
        ExceptionList = local_10;
        return;
      }
      local_2c = FUN_004f5680();
      if (local_2c == 0) {
        ExceptionList = local_10;
        return;
      }
      piVar4 = *(int **)(local_2c + 0x34);
      if (piVar4 == (int *)0x0) {
        ExceptionList = local_10;
        return;
      }
      cVar2 = *(char *)(iVar10 + 0x40);
      if ((((cVar2 == '\x03') || (cVar2 == '\x04')) || (cVar2 == '\x06')) &&
         (iVar9 = *(int *)(DAT_0172491c + 0x17c), iVar9 != 0)) break;
LAB_00963de7:
      piVar8 = (int *)FUN_00b04230(0xffffffff);
      iVar10 = DAT_00d7c54c;
      if (piVar8 == (int *)0x0) {
        ExceptionList = local_10;
        return;
      }
      local_1c = CONCAT22((short)piVar4[1],*(undefined2 *)((int)piVar4 + 6));
      FUN_004437f0(&local_1c);
      if (local_20 == *(int *)(iVar10 + 0x44)) {
        iVar9 = 0;
      }
      else {
        iVar9 = *(int *)(local_20 + 0x10);
      }
      local_28 = (piVar4[0x15] * (uint)*(ushort *)(iVar9 + 0x46)) / 10000;
      if (piVar8[0x2c] != piVar8[0x2e]) {
        piVar8[0x2c] = piVar8[0x2e];
        *(undefined1 *)(piVar8 + 0x2d) = 1;
      }
      local_1c = piVar8[4];
      FUN_004437f0(&local_1c);
      if (((local_24 != *(int *)(iVar10 + 0x44)) && (*(int *)(local_24 + 0x10) != 0)) &&
         (((*(uint *)(*(int *)(local_24 + 0x10) + 0x4c) & 0x100000) != 0 &&
          (((iVar10 = *DAT_00da9894, iVar10 != 0 && (*(int *)(iVar10 + 0x2cc) != 0)) &&
           (*(char *)(*(int *)(iVar10 + 0x2cc) + 0x32) == '\x01')))))) {
        FUN_0099c7f0(*(int *)(iVar10 + 0x2cc));
      }
      if ((((piVar4[0x13] & 0x100000U) != 0) &&
          (iVar10 = (**(code **)(*piVar4 + 0x3c))(), iVar10 != 0)) &&
         (iVar10 = piVar4[0xa0], iVar10 != 0)) {
        FUN_006ed4b0();
        local_14 = local_4c;
        local_4c[0] = 0x12345678;
        local_30 = 0x12345678;
        if (*(uint *)(*(int *)ThreadLocalStoragePointer + 0x1c) < 0x80) {
          FUN_006ed5d0(&local_14);
        }
        fVar1 = *(float *)(iVar10 + 0x364);
        local_8 = 0xffffffff;
        FUN_006ed550();
        if ((int)fVar1 != 0) {
          FUN_00a07be0(0);
        }
      }
      FUN_00a08610(piVar8);
      (**(code **)(*piVar8 + 0x2c))(0,0);
      iVar10 = local_2c;
      pcVar5 = *(code **)(*piVar8 + 0x34);
      piVar8[0xd] = local_28;
      (*pcVar5)(*(undefined4 *)(local_2c + 0x20));
      bVar6 = *(byte *)(iVar10 + 0x1c);
      if (0xc < bVar6) {
        bVar6 = 0xc;
      }
      (**(code **)(*piVar8 + 0x38))(bVar6);
      *(undefined2 *)(piVar8 + 0x51) = *(undefined2 *)(iVar10 + 6);
      piVar8[0x52] = *(int *)(iVar10 + 0x28);
      if (((char)param_1[0x23] == '\0') && (1 < *(uint *)(iVar10 + 0x20))) {
        *(undefined1 *)(param_1 + 0x23) = 1;
      }
      FUN_00962c20(piVar8);
      iVar10 = param_2;
    }
    for (psVar7 = (short *)piVar4[0x54]; iVar10 = param_2, psVar7 != (short *)piVar4[0x55];
        psVar7 = psVar7 + 4) {
      if (*psVar7 == (short)*(undefined4 *)(iVar9 + 0x16d8)) {
        if ((*(int *)(psVar7 + 2) != 0) &&
           (((uint)*(byte *)(piVar4 + 0x10) <= *(uint *)(iVar9 + 0xa0) ||
            (*(uint *)(iVar9 + 0xa0) <= (uint)*(byte *)((int)piVar4 + 0x41))))) goto LAB_00963de7;
        break;
      }
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
00963c70 : PUSH EBP
00963c71 : MOV EBP,ESP
00963c73 : PUSH -0x1
00963c75 : PUSH 0xb4cbd7
00963c7a : MOV EAX,FS:[0x0]
00963c80 : PUSH EAX
00963c81 : SUB ESP,0x3c
00963c84 : PUSH EBX
00963c85 : PUSH ESI
00963c86 : PUSH EDI
00963c87 : MOV EAX,[0x00d66fa0]
00963c8c : XOR EAX,EBP
00963c8e : PUSH EAX
00963c8f : LEA EAX,[EBP + -0xc]
00963c92 : MOV FS:[0x0],EAX
00963c98 : MOV EBX,dword ptr [EBP + 0x8]
00963c9b : MOV AL,byte ptr [EBX + 0x8]
00963c9e : TEST AL,AL
00963ca0 : JNZ 0x00963cab
00963ca2 : MOV EAX,dword ptr [EBX]
00963ca4 : MOV EDX,dword ptr [EAX + 0xc]
00963ca7 : MOV ECX,EBX
00963ca9 : CALL EDX
00963cab : MOV ESI,EBX
00963cad : CALL 0x00961f80
00963cb2 : MOV EAX,dword ptr [EBX + 0x54]
00963cb5 : MOV ECX,dword ptr [EAX + 0x4]
00963cb8 : LEA EDI,[EBX + 0x50]
00963cbb : PUSH ECX
00963cbc : MOV ECX,EDI
00963cbe : CALL 0x0045cd30
00963cc3 : MOV EAX,dword ptr [EDI + 0x4]
00963cc6 : MOV dword ptr [EAX + 0x4],EAX
00963cc9 : MOV EAX,dword ptr [EDI + 0x4]
00963ccc : XOR ESI,ESI
00963cce : MOV dword ptr [EDI + 0x8],ESI
00963cd1 : MOV dword ptr [EAX],EAX
00963cd3 : MOV EDI,dword ptr [EDI + 0x4]
00963cd6 : MOV dword ptr [EDI + 0x8],EDI
00963cd9 : MOV EDX,dword ptr [EBX + 0x60]
00963cdc : MOV EAX,dword ptr [EDX + 0x4]
00963cdf : LEA EDI,[EBX + 0x5c]
00963ce2 : PUSH EAX
00963ce3 : MOV ECX,EDI
00963ce5 : CALL 0x0045cd30
00963cea : MOV EAX,dword ptr [EDI + 0x4]
00963ced : MOV ECX,dword ptr [EBP + 0xc]
00963cf0 : MOV dword ptr [EAX + 0x4],EAX
00963cf3 : MOV EAX,dword ptr [EDI + 0x4]
00963cf6 : MOV dword ptr [EDI + 0x8],ESI
00963cf9 : MOV ESI,dword ptr [0x00d7c54c]
00963cff : MOV dword ptr [EAX],EAX
00963d01 : MOV EDI,dword ptr [EDI + 0x4]
00963d04 : LEA EAX,[EBP + 0xc]
00963d07 : MOV dword ptr [EDI + 0x8],EDI
00963d0a : MOV EDX,dword ptr [ECX + 0x4]
00963d0d : PUSH EAX
00963d0e : LEA ECX,[ESI + 0x40]
00963d11 : LEA EAX,[EBP + -0x14]
00963d14 : MOV dword ptr [EBP + 0xc],EDX
00963d17 : CALL 0x004437f0
00963d1c : MOV ESI,dword ptr [ESI + 0x44]
00963d1f : MOV EAX,dword ptr [EBP + -0x14]
00963d22 : CMP EAX,ESI
00963d24 : JZ 0x00963d2e
00963d26 : MOV EDI,dword ptr [EAX + 0x10]
00963d29 : MOV dword ptr [EBP + 0xc],EDI
00963d2c : JMP 0x00963d38
00963d2e : MOV dword ptr [EBP + 0xc],0x0
00963d35 : MOV EDI,dword ptr [EBP + 0xc]
00963d38 : MOV EDX,dword ptr [EDI + 0x48]
00963d3b : MOV EAX,dword ptr [EDX + 0x4]
00963d3e : LEA ECX,[EDI + 0x48]
00963d41 : CALL EAX
00963d43 : MOV dword ptr [EBP + -0x14],EAX
00963d46 : TEST EAX,EAX
00963d48 : JZ 0x00963fda
00963d4e : JMP 0x00963d53
00963d50 : MOV EDI,dword ptr [EBP + 0xc]
00963d53 : LEA EDX,[EBP + -0x14]
00963d56 : LEA EAX,[EDI + 0x48]
00963d59 : CALL 0x004f5680
00963d5e : MOV dword ptr [EBP + -0x28],EAX
00963d61 : TEST EAX,EAX
00963d63 : JZ 0x00964088
00963d69 : MOV ESI,dword ptr [EAX + 0x34]
00963d6c : TEST ESI,ESI
00963d6e : JZ 0x00964088
00963d74 : MOV AL,byte ptr [EDI + 0x40]
00963d77 : CMP AL,0x3
00963d79 : JZ 0x00963d83
00963d7b : CMP AL,0x4
00963d7d : JZ 0x00963d83
00963d7f : CMP AL,0x6
00963d81 : JNZ 0x00963de7
00963d83 : MOV ECX,dword ptr [0x0172491c]
00963d89 : MOV EDX,dword ptr [ECX + 0x17c]
00963d8f : TEST EDX,EDX
00963d91 : JZ 0x00963de7
00963d93 : MOV EAX,dword ptr [ESI + 0x150]
00963d99 : MOV ECX,dword ptr [ESI + 0x154]
00963d9f : MOV EDI,dword ptr [EDX + 0x16d8]
00963da5 : CMP EAX,ECX
00963da7 : JZ 0x00963fd0
00963dad : LEA ECX,[ECX]
00963db0 : CMP word ptr [EAX],DI
00963db3 : JZ 0x00963dc1
00963db5 : ADD EAX,0x8
00963db8 : CMP EAX,ECX
00963dba : JNZ 0x00963db0
00963dbc : JMP 0x00963fd0
00963dc1 : CMP dword ptr [EAX + 0x4],0x0
00963dc5 : JZ 0x00963fd0
00963dcb : MOVZX ECX,byte ptr [ESI + 0x40]
00963dcf : MOV EAX,dword ptr [EDX + 0xa0]
00963dd5 : CMP ECX,EAX
00963dd7 : JBE 0x00963de7
00963dd9 : MOV EDX,EAX
00963ddb : MOVZX EAX,byte ptr [ESI + 0x41]
00963ddf : CMP EAX,EDX
00963de1 : JC 0x00963fd0
00963de7 : MOVZX ECX,word ptr [ESI + 0x4]
00963deb : MOVZX EDX,word ptr [ESI + 0x6]
00963def : SHL ECX,0x10
00963df2 : OR ECX,EDX
00963df4 : PUSH -0x1
00963df6 : CALL 0x00b04230
00963dfb : MOV EDI,EAX
00963dfd : ADD ESP,0x4
00963e00 : TEST EDI,EDI
00963e02 : JZ 0x00964088
00963e08 : MOVZX EAX,word ptr [ESI + 0x4]
00963e0c : MOVZX ECX,word ptr [ESI + 0x6]
00963e10 : MOV EBX,dword ptr [0x00d7c54c]
00963e16 : SHL EAX,0x10
00963e19 : OR EAX,ECX
00963e1b : LEA EDX,[EBP + -0x18]
00963e1e : MOV dword ptr [EBP + -0x18],EAX
00963e21 : LEA ECX,[EBX + 0x40]
00963e24 : PUSH EDX
00963e25 : LEA EAX,[EBP + -0x1c]
00963e28 : CALL 0x004437f0
00963e2d : MOV EAX,dword ptr [EBX + 0x44]
00963e30 : MOV ECX,dword ptr [EBP + -0x1c]
00963e33 : CMP ECX,EAX
00963e35 : JZ 0x00963e3c
00963e37 : MOV EAX,dword ptr [ECX + 0x10]
00963e3a : JMP 0x00963e3e
00963e3c : XOR EAX,EAX
00963e3e : MOVZX EAX,word ptr [EAX + 0x46]
00963e42 : MOV ECX,dword ptr [ESI + 0x54]
00963e45 : IMUL ECX,EAX
00963e48 : MOV EAX,0xd1b71759
00963e4d : MUL ECX
00963e4f : MOV EAX,dword ptr [EDI + 0xb8]
00963e55 : SHR EDX,0xd
00963e58 : MOV dword ptr [EBP + -0x24],EDX
00963e5b : CMP dword ptr [EDI + 0xb0],EAX
00963e61 : JZ 0x00963e70
00963e63 : MOV dword ptr [EDI + 0xb0],EAX
00963e69 : MOV byte ptr [EDI + 0xb4],0x1
00963e70 : MOV EDX,dword ptr [EDI + 0x10]
00963e73 : LEA EAX,[EBP + -0x18]
00963e76 : PUSH EAX
00963e77 : LEA EAX,[EBP + -0x20]
00963e7a : LEA ECX,[EBX + 0x40]
00963e7d : MOV dword ptr [EBP + -0x18],EDX
00963e80 : CALL 0x004437f0
00963e85 : MOV EAX,dword ptr [EBX + 0x44]
00963e88 : MOV ECX,dword ptr [EBP + -0x20]
00963e8b : CMP ECX,EAX
00963e8d : JZ 0x00963ece
00963e8f : MOV EAX,dword ptr [ECX + 0x10]
00963e92 : TEST EAX,EAX
00963e94 : JZ 0x00963ece
00963e96 : MOV ECX,dword ptr [EAX + 0x4c]
00963e99 : AND ECX,0x100000
00963e9f : XOR EAX,EAX
00963ea1 : OR EAX,ECX
00963ea3 : JZ 0x00963ece
00963ea5 : MOV ECX,dword ptr [0x00da9894]
00963eab : MOV EAX,dword ptr [ECX]
00963ead : TEST EAX,EAX
00963eaf : JZ 0x00963ece
00963eb1 : CMP dword ptr [EAX + 0x2cc],0x0
00963eb8 : JZ 0x00963ece
00963eba : MOV ECX,dword ptr [EAX + 0x2cc]
00963ec0 : CMP byte ptr [ECX + 0x32],0x1
00963ec4 : JNZ 0x00963ece
00963ec6 : MOV EAX,ECX
00963ec8 : PUSH EAX
00963ec9 : CALL 0x0099c7f0
00963ece : MOV ECX,dword ptr [ESI + 0x4c]
00963ed1 : AND ECX,0x100000
00963ed7 : XOR EAX,EAX
00963ed9 : OR EAX,ECX
00963edb : JZ 0x00963f56
00963edd : MOV EDX,dword ptr [ESI]
00963edf : MOV EAX,dword ptr [EDX + 0x3c]
00963ee2 : MOV ECX,ESI
00963ee4 : CALL EAX
00963ee6 : TEST EAX,EAX
00963ee8 : JZ 0x00963f56
00963eea : MOV ESI,dword ptr [ESI + 0x280]
00963ef0 : TEST ESI,ESI
00963ef2 : JZ 0x00963f56
00963ef4 : CALL 0x006ed4b0
00963ef9 : MOV EDX,dword ptr FS:[0x2c]
00963f00 : LEA ECX,[EBP + -0x48]
00963f03 : MOV dword ptr [EBP + -0x10],ECX
00963f06 : MOV ECX,0x12345678
00963f0b : MOV dword ptr [EBP + -0x48],ECX
00963f0e : MOV dword ptr [EBP + -0x2c],ECX
00963f11 : MOV ECX,dword ptr [EDX]
00963f13 : CMP dword ptr [ECX + 0x1c],0x80
00963f1a : JNC 0x00963f25
00963f1c : LEA EDX,[EBP + -0x10]
00963f1f : PUSH EDX
00963f20 : CALL 0x006ed5d0
00963f25 : MOV dword ptr [EBP + -0x4],0x0
00963f2c : MOVSS XMM0,dword ptr [ESI + 0x364]
00963f34 : CVTTSS2SI ESI,XMM0
00963f38 : MOV dword ptr [EBP + -0x4],0xffffffff
00963f3f : LEA EAX,[EBP + -0x10]
00963f42 : CALL 0x006ed550
00963f47 : TEST ESI,ESI
00963f49 : JZ 0x00963f56
00963f4b : PUSH 0x0
00963f4d : MOV EAX,ESI
00963f4f : MOV ECX,EDI
00963f51 : CALL 0x00a07be0
00963f56 : PUSH EDI
00963f57 : CALL 0x00a08610
00963f5c : MOV EAX,dword ptr [EDI]
00963f5e : MOV EDX,dword ptr [EAX + 0x2c]
00963f61 : PUSH 0x0
00963f63 : PUSH 0x0
00963f65 : MOV ECX,EDI
00963f67 : CALL EDX
00963f69 : MOV EAX,dword ptr [EBP + -0x24]
00963f6c : MOV ESI,dword ptr [EBP + -0x28]
00963f6f : MOV EDX,dword ptr [EDI]
00963f71 : MOV EDX,dword ptr [EDX + 0x34]
00963f74 : MOV dword ptr [EDI + 0x34],EAX
00963f77 : MOV EAX,dword ptr [ESI + 0x20]
00963f7a : PUSH EAX
00963f7b : MOV ECX,EDI
00963f7d : CALL EDX
00963f7f : MOV AL,byte ptr [ESI + 0x1c]
00963f82 : CMP AL,0xc
00963f84 : JBE 0x00963f8d
00963f86 : MOV EAX,0xc
00963f8b : JMP 0x00963f90
00963f8d : MOVZX EAX,AL
00963f90 : MOV EDX,dword ptr [EDI]
00963f92 : PUSH EAX
00963f93 : MOV EAX,dword ptr [EDX + 0x38]
00963f96 : MOV ECX,EDI
00963f98 : CALL EAX
00963f9a : MOV CX,word ptr [ESI + 0x6]
00963f9e : MOV EAX,dword ptr [EBP + 0x8]
00963fa1 : MOV word ptr [EDI + 0x144],CX
00963fa8 : MOV EDX,dword ptr [ESI + 0x28]
00963fab : MOV dword ptr [EDI + 0x148],EDX
00963fb1 : CMP byte ptr [EAX + 0x8c],0x0
00963fb8 : JNZ 0x00963fc7
00963fba : CMP dword ptr [ESI + 0x20],0x1
00963fbe : JBE 0x00963fc7
00963fc0 : MOV byte ptr [EAX + 0x8c],0x1
00963fc7 : PUSH EDI
00963fc8 : CALL 0x00962c20
00963fcd : MOV EBX,dword ptr [EBP + 0x8]
00963fd0 : CMP dword ptr [EBP + -0x14],0x0
00963fd4 : JNZ 0x00963d50
00963fda : MOV ECX,dword ptr [EBX + 0x48]
00963fdd : SUB ECX,dword ptr [EBX + 0x44]
00963fe0 : MOV EAX,0x1
00963fe5 : TEST ECX,0xfffffff8
00963feb : JZ 0x00964005
00963fed : MOV EDX,dword ptr [EBX + 0x48]
00963ff0 : SUB EDX,dword ptr [EBX + 0x44]
00963ff3 : MOV EAX,0xcccccccd
00963ff8 : SAR EDX,0x3
00963ffb : DEC EDX
00963ffc : MUL EDX
00963ffe : SHR EDX,0x3
00964001 : INC EDX
00964002 : MOVZX EAX,DX
00964005 : MOV ECX,EBX
00964007 : CALL 0x00961e80
0096400c : MOV EAX,dword ptr [EBX + 0x48]
0096400f : MOV ECX,dword ptr [EBX + 0x44]
00964012 : MOV EDX,EAX
00964014 : SUB EDX,ECX
00964016 : PUSH 0x961f00
0096401b : SAR EDX,0x3
0096401e : PUSH EDX
0096401f : PUSH EAX
00964020 : PUSH ECX
00964021 : CALL 0x00425530
00964026 : MOV EDI,dword ptr [EBP + 0x8]
00964029 : XOR EAX,EAX
0096402b : MOV word ptr [EBX + 0x74],AX
0096402f : MOV EBX,dword ptr [EBX + 0x44]
00964032 : ADD ESP,0x10
00964035 : CMP EBX,dword ptr [EDI + 0x48]
00964038 : JZ 0x00964088
0096403a : LEA EBX,[EBX]
00964040 : MOVZX EAX,word ptr [EDI + 0x74]
00964044 : MOV ECX,dword ptr [EDI + 0x38]
00964047 : MOVZX ESI,AX
0096404a : INC EAX
0096404b : MOV word ptr [EDI + 0x74],AX
0096404f : MOV EAX,dword ptr [ECX + 0x3c]
00964052 : TEST ESI,ESI
00964054 : JL 0x0096406e
00964056 : CMP dword ptr [EAX + 0xc],0x0
0096405a : JZ 0x0096406e
0096405c : MOV EDI,dword ptr [EAX + 0xc]
0096405f : MOV EAX,ESI
00964061 : CDQ
00964062 : IDIV EDI
00964064 : IMUL EDI,EAX
00964067 : SUB ESI,EDI
00964069 : MOV EDI,dword ptr [EBP + 0x8]
0096406c : JMP 0x00964073
0096406e : OR EAX,0xffffffff
00964071 : OR ESI,EAX
00964073 : MOV EDX,dword ptr [ECX]
00964075 : MOV EDX,dword ptr [EDX + 0x70]
00964078 : PUSH EAX
00964079 : MOV EAX,dword ptr [EBX + 0x4]
0096407c : PUSH ESI
0096407d : PUSH EAX
0096407e : CALL EDX
00964080 : ADD EBX,0x8
00964083 : CMP EBX,dword ptr [EDI + 0x48]
00964086 : JNZ 0x00964040
00964088 : MOV ECX,dword ptr [EBP + -0xc]
0096408b : MOV dword ptr FS:[0x0],ECX
00964092 : POP ECX
00964093 : POP EDI
00964094 : POP ESI
00964095 : POP EBX
00964096 : MOV ESP,EBP
00964098 : POP EBP
00964099 : RET 0x8

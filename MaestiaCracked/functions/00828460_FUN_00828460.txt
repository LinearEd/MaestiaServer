PROGRAM  : Maestia.exe
FUNCTION : FUN_00828460
ENTRY    : 00828460
BODY     : [[00828460, 00828744]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00828460(void)

{
  char cVar1;
  ushort uVar2;
  int iVar3;
  int in_ECX;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  undefined4 local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b5ef10;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(int *)(in_ECX + 0x90) != 0) {
    iVar3 = *(int *)(*(int *)(in_ECX + 0x90) + 0xf0);
    if (iVar3 != 0) {
      uVar2 = GetAsyncKeyState(0x79);
      if ((uVar2 & 0x8000) != 0) {
        uVar2 = GetAsyncKeyState(0xa0);
        if ((uVar2 & 0x8000) != 0) {
          uVar2 = GetAsyncKeyState(0xa2);
          if ((uVar2 & 0x8000) != 0) {
            DAT_01724920 = '\x01';
          }
        }
      }
      if (*(char *)(iVar3 + 0x2c2c) == '\0') {
        if (DAT_01724920 != '\0') {
          cVar1 = FUN_008083a0();
          if (cVar1 != '\0') {
            *(undefined1 *)(iVar3 + 0x2c2c) = 1;
          }
        }
        if (*(char *)(iVar3 + 0x2c2c) == '\0') goto LAB_00828729;
      }
      uVar2 = GetAsyncKeyState(0x76);
      if ((uVar2 & 0x8000) != 0) {
        uVar2 = GetAsyncKeyState(0xa0);
        if (((uVar2 & 0x8000) != 0) && (*(char *)(DAT_017251ac + 0x324) == '\0')) {
          FUN_00824e50();
        }
        uVar2 = GetAsyncKeyState(0xa2);
        if (((uVar2 & 0x8000) != 0) && (*(char *)(DAT_017251ac + 0x324) != '\0')) {
          FUN_00824e50();
        }
      }
      uVar2 = GetAsyncKeyState(0x77);
      if ((uVar2 & 0x8000) != 0) {
        local_18 = 7;
        local_1c = 0;
        local_2c = 0;
        local_8 = 0;
        if ((*(int *)(in_ECX + 0xc4) == 4) && (*(int *)(in_ECX + 0xdc) != 0)) {
          iVar3 = FUN_004049b0();
          if (iVar3 != 0) {
            FUN_00404350();
            local_8._0_1_ = 1;
            FUN_00405eb0();
            local_8 = (uint)local_8._1_3_ << 8;
            FUN_00406560();
          }
        }
        else {
          FUN_00405c00();
        }
        uVar2 = GetAsyncKeyState(0xa0);
        if ((uVar2 & 0x8000) != 0) {
          cVar1 = FUN_00403810();
          if (cVar1 == '\0') {
            FUN_00406460();
            local_8._0_1_ = 4;
            FUN_00405660(local_30);
          }
          else {
            FUN_008b7050();
            local_8._0_1_ = 2;
            FUN_00405660(local_30);
          }
          local_8 = (uint)local_8._1_3_ << 8;
          FUN_007ebed0();
        }
        uVar2 = GetAsyncKeyState(0xa2);
        if ((uVar2 & 0x8000) != 0) {
          cVar1 = FUN_00403810();
          if (cVar1 == '\0') {
            FUN_00406460();
            local_8._0_1_ = 8;
            FUN_00405660();
          }
          else {
            FUN_008b7050();
            local_8._0_1_ = 6;
            FUN_00405660();
          }
          local_8 = (uint)local_8._1_3_ << 8;
          FUN_007e1490();
        }
        local_8 = 0xffffffff;
        FUN_00406560();
      }
    }
  }
LAB_00828729:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00828460 : PUSH EBP
00828461 : MOV EBP,ESP
00828463 : PUSH -0x1
00828465 : PUSH 0xb5ef10
0082846a : MOV EAX,FS:[0x0]
00828470 : PUSH EAX
00828471 : SUB ESP,0x48
00828474 : MOV EAX,[0x00d66fa0]
00828479 : XOR EAX,EBP
0082847b : MOV dword ptr [EBP + -0x10],EAX
0082847e : PUSH EBX
0082847f : PUSH ESI
00828480 : PUSH EDI
00828481 : PUSH EAX
00828482 : LEA EAX,[EBP + -0xc]
00828485 : MOV FS:[0x0],EAX
0082848b : MOV ESI,ECX
0082848d : MOV EAX,dword ptr [ESI + 0x90]
00828493 : TEST EAX,EAX
00828495 : JZ 0x00828729
0082849b : MOV EBX,dword ptr [EAX + 0xf0]
008284a1 : MOV dword ptr [EBP + -0x30],EBX
008284a4 : TEST EBX,EBX
008284a6 : JZ 0x00828729
008284ac : MOV EDI,dword ptr [0x00b8542c]
008284b2 : PUSH 0x79
008284b4 : CALL EDI
008284b6 : MOV ECX,0x8000
008284bb : TEST CX,AX
008284be : JZ 0x008284e9
008284c0 : PUSH 0xa0
008284c5 : CALL EDI
008284c7 : MOV EDX,0x8000
008284cc : TEST DX,AX
008284cf : JZ 0x008284e9
008284d1 : PUSH 0xa2
008284d6 : CALL EDI
008284d8 : MOV ECX,0x8000
008284dd : TEST CX,AX
008284e0 : JZ 0x008284e9
008284e2 : MOV byte ptr [0x01724920],0x1
008284e9 : CMP byte ptr [EBX + 0x2c2c],0x0
008284f0 : JNZ 0x00828518
008284f2 : CMP byte ptr [0x01724920],0x0
008284f9 : JZ 0x0082850b
008284fb : CALL 0x008083a0
00828500 : TEST AL,AL
00828502 : JZ 0x0082850b
00828504 : MOV byte ptr [EBX + 0x2c2c],0x1
0082850b : CMP byte ptr [EBX + 0x2c2c],0x0
00828512 : JZ 0x00828729
00828518 : PUSH 0x76
0082851a : CALL EDI
0082851c : MOV EDX,0x8000
00828521 : TEST DX,AX
00828524 : JZ 0x00828584
00828526 : PUSH 0xa0
0082852b : CALL EDI
0082852d : MOV ECX,0x8000
00828532 : TEST CX,AX
00828535 : JZ 0x00828555
00828537 : MOV EDX,dword ptr [0x017251ac]
0082853d : CMP byte ptr [EDX + 0x324],0x0
00828544 : JNZ 0x00828555
00828546 : MOV EAX,[0x0172491c]
0082854b : PUSH 0x1
0082854d : PUSH 0x1
0082854f : PUSH EAX
00828550 : CALL 0x00824e50
00828555 : PUSH 0xa2
0082855a : CALL EDI
0082855c : MOV ECX,0x8000
00828561 : TEST CX,AX
00828564 : JZ 0x00828584
00828566 : MOV EDX,dword ptr [0x017251ac]
0082856c : CMP byte ptr [EDX + 0x324],0x0
00828573 : JZ 0x00828584
00828575 : MOV EAX,[0x0172491c]
0082857a : PUSH 0x1
0082857c : PUSH 0x0
0082857e : PUSH EAX
0082857f : CALL 0x00824e50
00828584 : PUSH 0x77
00828586 : CALL EDI
00828588 : MOV ECX,0x8000
0082858d : TEST CX,AX
00828590 : JZ 0x00828729
00828596 : XOR EAX,EAX
00828598 : XOR EDX,EDX
0082859a : MOV dword ptr [EBP + -0x14],0x7
008285a1 : MOV dword ptr [EBP + -0x18],EAX
008285a4 : MOV word ptr [EBP + -0x28],DX
008285a8 : MOV dword ptr [EBP + -0x4],EAX
008285ab : MOV EBX,0x4
008285b0 : CMP dword ptr [ESI + 0xc4],EBX
008285b6 : JNZ 0x00828604
008285b8 : MOV EAX,dword ptr [ESI + 0xdc]
008285be : TEST EAX,EAX
008285c0 : JZ 0x00828604
008285c2 : MOV EAX,dword ptr [EAX + 0x450]
008285c8 : PUSH EAX
008285c9 : CALL 0x004049b0
008285ce : ADD ESP,0x4
008285d1 : TEST EAX,EAX
008285d3 : JZ 0x00828612
008285d5 : ADD EAX,0x18b
008285da : PUSH EAX
008285db : LEA ESI,[EBP + -0x54]
008285de : CALL 0x00404350
008285e3 : ADD ESP,0x4
008285e6 : MOV byte ptr [EBP + -0x4],0x1
008285ea : PUSH -0x1
008285ec : PUSH 0x0
008285ee : PUSH EAX
008285ef : LEA ECX,[EBP + -0x2c]
008285f2 : CALL 0x00405eb0
008285f7 : MOV byte ptr [EBP + -0x4],0x0
008285fb : MOV ECX,ESI
008285fd : CALL 0x00406560
00828602 : JMP 0x00828612
00828604 : LEA EAX,[EBP + -0x2c]
00828607 : PUSH EAX
00828608 : MOV EDX,0xc34464
0082860d : CALL 0x00405c00
00828612 : PUSH 0xa0
00828617 : CALL EDI
00828619 : MOV ECX,0x8000
0082861e : TEST CX,AX
00828621 : JZ 0x00828698
00828623 : MOV ESI,0xc34478
00828628 : LEA ECX,[EBP + -0x2c]
0082862b : CALL 0x00403810
00828630 : PUSH 0x0
00828632 : SUB ESP,0x1c
00828635 : TEST AL,AL
00828637 : JZ 0x00828665
00828639 : MOV EDX,dword ptr [0x017248c8]
0082863f : MOV ESI,ESP
00828641 : MOV dword ptr [EBP + -0x38],ESP
00828644 : PUSH EDX
00828645 : CALL 0x008b7050
0082864a : MOV byte ptr [EBP + -0x4],0x2
0082864e : SUB ESP,0x1c
00828651 : LEA EAX,[EBP + -0x2c]
00828654 : MOV ECX,ESP
00828656 : MOV dword ptr [EBP + -0x34],ESP
00828659 : PUSH EAX
0082865a : CALL 0x00405660
0082865f : MOV byte ptr [EBP + -0x4],0x3
00828663 : JMP 0x0082868c
00828665 : MOV ECX,ESP
00828667 : MOV dword ptr [EBP + -0x34],ESP
0082866a : PUSH 0xc3448c
0082866f : CALL 0x00406460
00828674 : MOV byte ptr [EBP + -0x4],BL
00828677 : SUB ESP,0x1c
0082867a : LEA EDX,[EBP + -0x2c]
0082867d : MOV ECX,ESP
0082867f : MOV dword ptr [EBP + -0x38],ESP
00828682 : PUSH EDX
00828683 : CALL 0x00405660
00828688 : MOV byte ptr [EBP + -0x4],0x5
0082868c : MOV byte ptr [EBP + -0x4],0x0
00828690 : MOV ECX,dword ptr [EBP + -0x30]
00828693 : CALL 0x007ebed0
00828698 : PUSH 0xa2
0082869d : CALL EDI
0082869f : MOV ECX,0x8000
008286a4 : TEST CX,AX
008286a7 : JZ 0x0082871a
008286a9 : MOV ESI,0xc34490
008286ae : LEA ECX,[EBP + -0x2c]
008286b1 : CALL 0x00403810
008286b6 : SUB ESP,0x1c
008286b9 : MOV dword ptr [EBP + -0x34],ESP
008286bc : TEST AL,AL
008286be : JZ 0x008286e9
008286c0 : MOV EDX,dword ptr [0x017248c8]
008286c6 : MOV ESI,ESP
008286c8 : PUSH EDX
008286c9 : CALL 0x008b7050
008286ce : MOV byte ptr [EBP + -0x4],0x6
008286d2 : SUB ESP,0x1c
008286d5 : LEA EAX,[EBP + -0x2c]
008286d8 : MOV ECX,ESP
008286da : MOV dword ptr [EBP + -0x38],ESP
008286dd : PUSH EAX
008286de : CALL 0x00405660
008286e3 : MOV byte ptr [EBP + -0x4],0x7
008286e7 : JMP 0x0082870e
008286e9 : MOV ECX,ESP
008286eb : PUSH 0xc344a4
008286f0 : CALL 0x00406460
008286f5 : MOV byte ptr [EBP + -0x4],0x8
008286f9 : SUB ESP,0x1c
008286fc : LEA EDX,[EBP + -0x2c]
008286ff : MOV ECX,ESP
00828701 : MOV dword ptr [EBP + -0x38],ESP
00828704 : PUSH EDX
00828705 : CALL 0x00405660
0082870a : MOV byte ptr [EBP + -0x4],0x9
0082870e : MOV byte ptr [EBP + -0x4],0x0
00828712 : MOV ECX,dword ptr [EBP + -0x30]
00828715 : CALL 0x007e1490
0082871a : MOV dword ptr [EBP + -0x4],0xffffffff
00828721 : LEA ECX,[EBP + -0x2c]
00828724 : CALL 0x00406560
00828729 : MOV ECX,dword ptr [EBP + -0xc]
0082872c : MOV dword ptr FS:[0x0],ECX
00828733 : POP ECX
00828734 : POP EDI
00828735 : POP ESI
00828736 : POP EBX
00828737 : MOV ECX,dword ptr [EBP + -0x10]
0082873a : XOR ECX,EBP
0082873c : CALL 0x00633e6b
00828741 : MOV ESP,EBP
00828743 : POP EBP
00828744 : RET

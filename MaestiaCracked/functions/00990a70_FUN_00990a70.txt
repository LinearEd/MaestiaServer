PROGRAM  : Maestia.exe
FUNCTION : FUN_00990a70
ENTRY    : 00990a70
BODY     : [[00990a70, 00990d2a]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_00990a70(int param_1)

{
  int iVar1;
  int *piVar2;
  uint local_4070;
  undefined1 local_406c [4];
  undefined2 local_4068;
  undefined4 local_4058;
  uint local_4054;
  undefined4 local_404c;
  undefined4 local_403c;
  uint local_4038;
  undefined2 local_4030;
  undefined4 local_4020;
  uint local_401c;
  uint local_18;
  undefined4 uStack_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  puStack_c = &LAB_00b673c3;
  local_10 = ExceptionList;
  uStack_14 = 0x990a8b;
  local_18 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (param_1 != 0) {
    local_401c = 7;
    local_4020 = 0;
    local_4030 = 0;
    local_8 = 0;
    FUN_00406460();
    local_8._0_1_ = 1;
    FUN_00406360();
    FUN_008018d0();
    FUN_00a9db60();
    FUN_00404750();
    local_8._0_1_ = 9;
    FUN_00405c30();
    local_8._0_1_ = 1;
    if (7 < local_4070) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    FUN_008f8070();
    FUN_00404350();
    local_8._0_1_ = 10;
    iVar1 = *DAT_00da9894;
    if ((iVar1 != 0) && (*(int *)(iVar1 + 0x114) != 0)) {
      piVar2 = *(int **)(iVar1 + 0x114);
      FUN_00406460();
      local_8._0_1_ = 0xb;
      FUN_00405660(local_406c);
      local_8._0_1_ = 10;
      FUN_008f7470();
      local_8._0_1_ = 0xd;
      (**(code **)(*piVar2 + 4))();
      local_8._0_1_ = 10;
      FUN_00406560();
    }
    local_8 = CONCAT31(local_8._1_3_,1);
    if (7 < local_4054) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_4054 = 7;
    local_4058 = 0;
    local_4068 = 0;
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_4038) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_4038 = 7;
    local_403c = 0;
    local_404c = (uint)local_404c._2_2_ << 0x10;
    local_8 = 0xffffffff;
    if (7 < local_401c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_401c = 7;
    local_4020 = 0;
    local_4030 = 0;
  }
  local_8 = 0xffffffff;
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00990a70 : PUSH EBP
00990a71 : MOV EBP,ESP
00990a73 : PUSH -0x1
00990a75 : PUSH 0xb673c3
00990a7a : MOV EAX,FS:[0x0]
00990a80 : PUSH EAX
00990a81 : MOV EAX,0x4080
00990a86 : CALL 0x0063b780
00990a8b : MOV EAX,[0x00d66fa0]
00990a90 : XOR EAX,EBP
00990a92 : MOV dword ptr [EBP + -0x14],EAX
00990a95 : PUSH EBX
00990a96 : PUSH ESI
00990a97 : PUSH EDI
00990a98 : PUSH EAX
00990a99 : LEA EAX,[EBP + -0xc]
00990a9c : MOV FS:[0x0],EAX
00990aa2 : MOV EBX,dword ptr [EBP + 0x8]
00990aa5 : XOR ESI,ESI
00990aa7 : CMP EBX,ESI
00990aa9 : JZ 0x00990d0d
00990aaf : XOR EAX,EAX
00990ab1 : MOV dword ptr [EBP + 0xffffbfe8],0x7
00990abb : MOV dword ptr [EBP + 0xffffbfe4],ESI
00990ac1 : MOV word ptr [EBP + 0xffffbfd4],AX
00990ac8 : MOV dword ptr [EBP + -0x4],ESI
00990acb : PUSH 0xc84ad4
00990ad0 : LEA ECX,[EBP + 0xffffbfb4]
00990ad6 : CALL 0x00406460
00990adb : MOV byte ptr [EBP + -0x4],0x1
00990adf : PUSH ESI
00990ae0 : PUSH 0xc9a8bc
00990ae5 : LEA ECX,[EBP + 0xffffbfd0]
00990aeb : CALL 0x00406360
00990af0 : MOV ESI,dword ptr [0x00da98e8]
00990af6 : PUSH 0xc9a8c0
00990afb : CALL 0x008018d0
00990b00 : MOVZX ECX,word ptr [EBX + 0x4]
00990b04 : MOVZX EDX,word ptr [EBX + 0x6]
00990b08 : SHL ECX,0x10
00990b0b : OR ECX,EDX
00990b0d : ADD ESP,0x4
00990b10 : PUSH ECX
00990b11 : LEA ECX,[EBP + 0xffffbfb4]
00990b17 : CALL 0x00a9db60
00990b1c : MOV EAX,dword ptr [EBP + 0xffffbfb8]
00990b22 : MOV EDI,0x8
00990b27 : ADD ESP,0x4
00990b2a : CMP dword ptr [EBP + 0xffffbfcc],EDI
00990b30 : JNC 0x00990b38
00990b32 : LEA EAX,[EBP + 0xffffbfb8]
00990b38 : PUSH EAX
00990b39 : PUSH 0xc84ad8
00990b3e : LEA ESI,[EBP + 0xffffbf7c]
00990b44 : CALL 0x00404750
00990b49 : ADD ESP,0x8
00990b4c : MOV byte ptr [EBP + -0x4],0x9
00990b50 : PUSH -0x1
00990b52 : PUSH 0x0
00990b54 : PUSH EAX
00990b55 : LEA ECX,[EBP + 0xffffbfd0]
00990b5b : CALL 0x00405c30
00990b60 : MOV byte ptr [EBP + -0x4],0x1
00990b64 : CMP dword ptr [EBP + 0xffffbf94],EDI
00990b6a : JC 0x00990b77
00990b6c : MOV ECX,dword ptr [EBP + 0xffffbf80]
00990b72 : CALL 0x006f04e0
00990b77 : MOV ESI,dword ptr [EBP + 0xffffbfd4]
00990b7d : XOR EAX,EAX
00990b7f : MOV dword ptr [EBP + 0xffffbf94],0x7
00990b89 : MOV dword ptr [EBP + 0xffffbf90],0x0
00990b93 : MOV word ptr [EBP + 0xffffbf80],AX
00990b9a : CMP dword ptr [EBP + 0xffffbfe8],EDI
00990ba0 : JNC 0x00990ba8
00990ba2 : LEA ESI,[EBP + 0xffffbfd4]
00990ba8 : LEA ECX,[EBP + 0xffffbfec]
00990bae : PUSH 0xc
00990bb0 : PUSH ECX
00990bb1 : MOV EDI,0xffffff
00990bb6 : CALL 0x008f8070
00990bbb : ADD EBX,0x184
00990bc1 : PUSH EBX
00990bc2 : LEA ESI,[EBP + 0xffffbf98]
00990bc8 : CALL 0x00404350
00990bcd : ADD ESP,0xc
00990bd0 : MOV BL,0xa
00990bd2 : MOV byte ptr [EBP + -0x4],BL
00990bd5 : MOV EDX,dword ptr [0x00da9894]
00990bdb : MOV EAX,dword ptr [EDX]
00990bdd : XOR EDI,EDI
00990bdf : CMP EAX,EDI
00990be1 : JZ 0x00990c7d
00990be7 : CMP dword ptr [EAX + 0x114],EDI
00990bed : JZ 0x00990c7d
00990bf3 : MOV ESI,dword ptr [EAX + 0x114]
00990bf9 : SUB ESP,0x1c
00990bfc : MOV ECX,ESP
00990bfe : MOV dword ptr [EBP + 0xffffbf78],ESP
00990c04 : PUSH 0xc84ae8
00990c09 : CALL 0x00406460
00990c0e : MOV byte ptr [EBP + -0x4],0xb
00990c12 : SUB ESP,0x1c
00990c15 : LEA EAX,[EBP + 0xffffbf98]
00990c1b : MOV ECX,ESP
00990c1d : MOV dword ptr [EBP + 0xffffbf74],ESP
00990c23 : PUSH EAX
00990c24 : CALL 0x00405660
00990c29 : MOV byte ptr [EBP + -0x4],0xc
00990c2d : MOV byte ptr [EBP + -0x4],BL
00990c30 : LEA EDI,[EBP + 0xffffbf7c]
00990c36 : CALL 0x008f7470
00990c3b : ADD ESP,0x38
00990c3e : MOV byte ptr [EBP + -0x4],0xd
00990c42 : CMP dword ptr [EAX + 0x18],0x8
00990c46 : JC 0x00990c4d
00990c48 : MOV EAX,dword ptr [EAX + 0x4]
00990c4b : JMP 0x00990c50
00990c4d : ADD EAX,0x4
00990c50 : MOV ECX,dword ptr [ESI]
00990c52 : PUSH EAX
00990c53 : MOV EAX,dword ptr [ECX + 0x4]
00990c56 : LEA EDX,[EBP + 0xffffbfec]
00990c5c : PUSH EDX
00990c5d : PUSH 0xc84aec
00990c62 : PUSH 0xc84af4
00990c67 : PUSH ESI
00990c68 : CALL EAX
00990c6a : ADD ESP,0x14
00990c6d : MOV byte ptr [EBP + -0x4],BL
00990c70 : LEA ECX,[EBP + 0xffffbf7c]
00990c76 : CALL 0x00406560
00990c7b : XOR EDI,EDI
00990c7d : MOV byte ptr [EBP + -0x4],0x1
00990c81 : MOV EBX,0x8
00990c86 : CMP dword ptr [EBP + 0xffffbfb0],EBX
00990c8c : JC 0x00990c99
00990c8e : MOV ECX,dword ptr [EBP + 0xffffbf9c]
00990c94 : CALL 0x006f04e0
00990c99 : XOR ECX,ECX
00990c9b : MOV ESI,0x7
00990ca0 : MOV dword ptr [EBP + 0xffffbfb0],ESI
00990ca6 : MOV dword ptr [EBP + 0xffffbfac],EDI
00990cac : MOV word ptr [EBP + 0xffffbf9c],CX
00990cb3 : MOV byte ptr [EBP + -0x4],CL
00990cb6 : CMP dword ptr [EBP + 0xffffbfcc],EBX
00990cbc : JC 0x00990cc9
00990cbe : MOV ECX,dword ptr [EBP + 0xffffbfb8]
00990cc4 : CALL 0x006f04e0
00990cc9 : XOR EDX,EDX
00990ccb : MOV dword ptr [EBP + 0xffffbfcc],ESI
00990cd1 : MOV dword ptr [EBP + 0xffffbfc8],EDI
00990cd7 : MOV word ptr [EBP + 0xffffbfb8],DX
00990cde : MOV dword ptr [EBP + -0x4],0xffffffff
00990ce5 : CMP dword ptr [EBP + 0xffffbfe8],EBX
00990ceb : JC 0x00990cf8
00990ced : MOV ECX,dword ptr [EBP + 0xffffbfd4]
00990cf3 : CALL 0x006f04e0
00990cf8 : XOR EAX,EAX
00990cfa : MOV dword ptr [EBP + 0xffffbfe8],ESI
00990d00 : MOV dword ptr [EBP + 0xffffbfe4],EDI
00990d06 : MOV word ptr [EBP + 0xffffbfd4],AX
00990d0d : MOV ECX,dword ptr [EBP + -0xc]
00990d10 : MOV dword ptr FS:[0x0],ECX
00990d17 : POP ECX
00990d18 : POP EDI
00990d19 : POP ESI
00990d1a : POP EBX
00990d1b : MOV ECX,dword ptr [EBP + -0x14]
00990d1e : XOR ECX,EBP
00990d20 : CALL 0x00633e6b
00990d25 : MOV ESP,EBP
00990d27 : POP EBP
00990d28 : RET 0x4

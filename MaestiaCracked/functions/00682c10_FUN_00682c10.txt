PROGRAM  : Maestia.exe
FUNCTION : FUN_00682c10
ENTRY    : 00682c10
BODY     : [[00682c10, 00682d3b]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Type propagation algorithm not settling */

void FUN_00682c10(void)

{
  HIMC pHVar1;
  UINT UVar2;
  int iVar3;
  uint *puVar4;
  LONG LVar5;
  int in_ECX;
  uint local_40 [5];
  undefined4 local_2c;
  uint local_28;
  undefined4 local_24;
  tagINPUT local_1c;
  
  local_2c = 0;
  local_28 = 0;
  local_40[1] = 0;
  local_40[2] = 0;
  pHVar1 = ImmGetContext(*(HWND *)(in_ECX + 0x14));
  ImmNotifyIME(pHVar1,0x15,1,0);
  ImmNotifyIME(pHVar1,0x15,4,0);
  ImmReleaseContext(*(HWND *)(in_ECX + 0x14),pHVar1);
  FUN_00685140();
  if ((*(int *)(in_ECX + 0x5c) == 6) || (*(int *)(in_ECX + 0x5c) == 5)) {
    local_1c.type = 1;
    local_1c.field1_0x4.ki.wVk = 0x1b;
    UVar2 = MapVirtualKeyW(0x1b,0);
    local_1c.field1_0x4.ki.wScan = (WORD)UVar2;
    SendInput(1,&local_1c,0x1c);
  }
  **(undefined2 **)(in_ECX + 0x20) = 0;
  iVar3 = FUN_0051b1a0();
  if (iVar3 != 0) {
    puVar4 = (uint *)FUN_0051c6e0(local_40,".RemoveInputWindow");
    FUN_00678eb0(*(undefined4 *)(in_ECX + 4),(*puVar4 & 0xfffffffc) + 8,0);
    LVar5 = InterlockedExchangeAdd((LONG *)((local_40[0] & 0xfffffffc) + 4),-1);
    if (LVar5 == 1) {
      FUN_00515cf0(local_40[0] & 0xfffffffc);
    }
  }
  if ((local_40[2] >> 6 & 1) != 0) {
    FUN_00588b40(local_40 + 1,local_40[3]);
    local_40[1] = 0;
  }
  if ((local_28 >> 6 & 1) != 0) {
    FUN_00588b40(&local_2c,local_24);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00682c10 : SUB ESP,0x40
00682c13 : PUSH EBX
00682c14 : PUSH ESI
00682c15 : MOV ESI,ECX
00682c17 : MOV EAX,dword ptr [ESI + 0x14]
00682c1a : XOR EBX,EBX
00682c1c : PUSH EDI
00682c1d : PUSH EAX
00682c1e : MOV dword ptr [ESP + 0x24],EBX
00682c22 : MOV dword ptr [ESP + 0x28],EBX
00682c26 : MOV dword ptr [ESP + 0x14],EBX
00682c2a : MOV dword ptr [ESP + 0x18],EBX
00682c2e : CALL 0x00611450
00682c33 : PUSH EBX
00682c34 : PUSH 0x1
00682c36 : MOV EDI,EAX
00682c38 : PUSH 0x15
00682c3a : PUSH EDI
00682c3b : CALL 0x00685b7e
00682c40 : PUSH EBX
00682c41 : PUSH 0x4
00682c43 : PUSH 0x15
00682c45 : PUSH EDI
00682c46 : CALL 0x00685b7e
00682c4b : MOV ECX,dword ptr [ESI + 0x14]
00682c4e : PUSH EDI
00682c4f : PUSH ECX
00682c50 : CALL 0x00611462
00682c55 : MOV ECX,dword ptr [ESI + 0x78]
00682c58 : CALL 0x00685140
00682c5d : MOV EAX,dword ptr [ESI + 0x5c]
00682c60 : CMP EAX,0x6
00682c63 : JZ 0x00682c6a
00682c65 : CMP EAX,0x5
00682c68 : JNZ 0x00682c98
00682c6a : MOV EDX,0x1b
00682c6f : PUSH EBX
00682c70 : PUSH EDX
00682c71 : MOV dword ptr [ESP + 0x38],0x1
00682c79 : MOV word ptr [ESP + 0x3c],DX
00682c7e : CALL dword ptr [0x00b85458]
00682c84 : MOV word ptr [ESP + 0x36],AX
00682c89 : PUSH 0x1c
00682c8b : LEA EAX,[ESP + 0x34]
00682c8f : PUSH EAX
00682c90 : PUSH 0x1
00682c92 : CALL dword ptr [0x00b854b8]
00682c98 : MOV ECX,dword ptr [ESI + 0x20]
00682c9b : XOR EDX,EDX
00682c9d : MOV word ptr [ECX],DX
00682ca0 : LEA EDI,[ESI + 0x8]
00682ca3 : MOV ECX,EDI
00682ca5 : CALL 0x0051b1a0
00682caa : TEST EAX,EAX
00682cac : JBE 0x00682cf3
00682cae : PUSH 0xbd7f88
00682cb3 : LEA EAX,[ESP + 0x10]
00682cb7 : PUSH EAX
00682cb8 : MOV ECX,EDI
00682cba : CALL 0x0051c6e0
00682cbf : MOV ECX,dword ptr [EAX]
00682cc1 : MOV EDX,dword ptr [ESI + 0x4]
00682cc4 : AND ECX,0xfffffffc
00682cc7 : PUSH EBX
00682cc8 : ADD ECX,0x8
00682ccb : PUSH ECX
00682ccc : PUSH EDX
00682ccd : CALL 0x00678eb0
00682cd2 : MOV ESI,dword ptr [ESP + 0x18]
00682cd6 : ADD ESP,0xc
00682cd9 : AND ESI,0xfffffffc
00682cdc : PUSH -0x1
00682cde : LEA EAX,[ESI + 0x4]
00682ce1 : PUSH EAX
00682ce2 : CALL dword ptr [0x00b851cc]
00682ce8 : SUB EAX,0x1
00682ceb : JNZ 0x00682cf3
00682ced : PUSH ESI
00682cee : CALL 0x00515cf0
00682cf3 : MOV ECX,dword ptr [ESP + 0x14]
00682cf7 : SHR ECX,0x6
00682cfa : TEST CL,0x1
00682cfd : JZ 0x00682d16
00682cff : MOV EDX,dword ptr [ESP + 0x18]
00682d03 : MOV ECX,dword ptr [ESP + 0x10]
00682d07 : PUSH EDX
00682d08 : LEA EAX,[ESP + 0x14]
00682d0c : PUSH EAX
00682d0d : CALL 0x00588b40
00682d12 : MOV dword ptr [ESP + 0x10],EBX
00682d16 : MOV ECX,dword ptr [ESP + 0x24]
00682d1a : POP EDI
00682d1b : SHR ECX,0x6
00682d1e : POP ESI
00682d1f : POP EBX
00682d20 : TEST CL,0x1
00682d23 : JZ 0x00682d38
00682d25 : MOV EDX,dword ptr [ESP + 0x1c]
00682d29 : MOV ECX,dword ptr [ESP + 0x14]
00682d2d : PUSH EDX
00682d2e : LEA EAX,[ESP + 0x18]
00682d32 : PUSH EAX
00682d33 : CALL 0x00588b40
00682d38 : ADD ESP,0x40
00682d3b : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_007d8fa0
ENTRY    : 007d8fa0
BODY     : [[007d8fa0, 007d92a3]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007d8fa0(int *param_1,int *param_2,undefined1 **param_3)

{
  char cVar1;
  int iVar2;
  undefined1 *puStack_c8;
  undefined1 *puStack_c4;
  undefined1 *puStack_c0;
  undefined1 *puStack_bc;
  int aiStack_b8 [2];
  undefined4 uStack_b0;
  undefined4 uStack_ac;
  int *piStack_a8;
  int *piStack_a4;
  undefined1 **ppuStack_a0;
  undefined1 local_84 [36];
  int local_60;
  int *local_5c;
  undefined1 local_58 [8];
  undefined1 local_50 [8];
  undefined **local_48;
  int *local_44;
  undefined1 *local_40;
  undefined1 *local_3c;
  int local_38;
  undefined1 local_34 [4];
  undefined2 local_30;
  undefined4 local_20;
  uint local_1c;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b31ff0;
  local_10 = ExceptionList;
  local_18 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  ppuStack_a0 = (undefined1 **)0x0;
  local_1c = 7;
  local_20 = 0;
  local_30 = 0;
  piStack_a8 = (int *)0x7d8fee;
  FUN_00405eb0();
  local_8 = 0;
  ppuStack_a0 = &local_40;
  local_40 = &DAT_0000002e;
  piStack_a4 = (int *)0x7d9006;
  iVar2 = FUN_00407cc0();
  if (iVar2 == -1) {
    if (7 < local_1c) {
      local_8 = iVar2;
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_1c = 7;
    local_20 = 0;
    local_30 = 0;
    local_8 = 0xffffffff;
  }
  else {
    piStack_a4 = (int *)0x7d903e;
    ppuStack_a0 = (undefined1 **)iVar2;
    FUN_00405e10();
    ppuStack_a0 = (undefined1 **)0xc1fea0;
    piStack_a4 = (int *)0x7d904d;
    FUN_00404870();
    piStack_a4 = (int *)0x7d9061;
    ppuStack_a0 = (undefined1 **)local_34;
    FUN_007c77d0();
    local_8._0_1_ = 1;
    ppuStack_a0 = &local_3c;
    piStack_a4 = (int *)0x7d906f;
    FUN_0043e530();
    local_8._0_1_ = 3;
    local_48 = &PTR_FUN_00cd4964;
    if (local_44 != (int *)0x0) {
      (**(code **)(*local_44 + 0x30))();
      local_44 = (int *)0x0;
    }
    if (local_38 == 0) {
      local_8 = (uint)local_8._1_3_ << 8;
      FUN_0043a010();
      local_8 = 0xffffffff;
      if (7 < local_1c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_1c = 7;
      local_20 = 0;
      local_30 = 0;
    }
    else {
      local_5c = param_1;
      if (param_1[2] != 0) {
        ppuStack_a0 = (undefined1 **)0x7d90dc;
        EnterCriticalSection((LPCRITICAL_SECTION)(param_1[2] + 4));
      }
      local_8._0_1_ = 4;
      ppuStack_a0 = &local_40;
      piStack_a8 = (int *)0x7d90f7;
      piStack_a4 = param_1 + 0x97;
      FUN_0044f270();
      if (local_40 == (undefined1 *)param_1[0x99]) {
        local_8._0_1_ = 3;
        if (param_1[2] != 0) {
          ppuStack_a0 = (undefined1 **)0x7d9135;
          LeaveCriticalSection((LPCRITICAL_SECTION)(param_1[2] + 4));
        }
        FUN_0045f540();
        local_8._0_1_ = 5;
        FUN_0045f540();
        local_8._0_1_ = 6;
        ppuStack_a0 = param_3;
        piStack_a4 = param_2;
        piStack_a8 = (int *)0x0;
        uStack_ac = 0;
        uStack_b0 = 2;
        local_5c = aiStack_b8;
        puStack_c0 = (undefined1 *)aiStack_b8;
        puStack_bc = local_50;
        puStack_c4 = (undefined1 *)0x7d916c;
        FUN_00439f80();
        local_8._0_1_ = 7;
        local_40 = (undefined1 *)&puStack_c0;
        puStack_c8 = (undefined1 *)&puStack_c0;
        puStack_c4 = local_58;
        FUN_00439f80();
        local_8._0_1_ = 8;
        local_44 = (int *)&puStack_c8;
        FUN_00439f80(&puStack_c8,&local_3c);
        local_8._0_1_ = 6;
        cVar1 = (**(code **)(*param_1 + 0xd4))();
        if (cVar1 == '\0') {
          local_8._0_1_ = 5;
          FUN_0043a010();
          local_8._0_1_ = 3;
          FUN_0043a010();
          local_8 = (uint)local_8._1_3_ << 8;
          FUN_0043a010();
          local_8 = 0xffffffff;
          FUN_00406560();
          goto LAB_007d9286;
        }
        local_44 = param_1;
        if (param_1[2] != 0) {
          ppuStack_a0 = (undefined1 **)0x7d91fe;
          EnterCriticalSection((LPCRITICAL_SECTION)(param_1[2] + 4));
        }
        local_8._0_1_ = 10;
        ppuStack_a0 = (undefined1 **)local_84;
        piStack_a4 = (int *)0x7d9215;
        ppuStack_a0 = (undefined1 **)FUN_00460220();
        local_8._0_1_ = 0xb;
        piStack_a4 = &local_60;
        uStack_ac = 0x7d9228;
        piStack_a8 = param_1 + 0x97;
        FUN_004604f0();
        local_8._0_1_ = 10;
        ppuStack_a0 = (undefined1 **)0x7d9235;
        FUN_0045fde0();
        local_8._0_1_ = 6;
        if (param_1[2] != 0) {
          ppuStack_a0 = (undefined1 **)0x7d924a;
          LeaveCriticalSection((LPCRITICAL_SECTION)(param_1[2] + 4));
        }
        *(undefined1 *)(param_1 + 0x90) = 1;
        local_8._0_1_ = 5;
        FUN_0043a010();
        local_8._0_1_ = 3;
        FUN_0043a010();
      }
      else {
        local_8._0_1_ = 3;
        if (param_1[2] != 0) {
          ppuStack_a0 = (undefined1 **)0x7d911b;
          LeaveCriticalSection((LPCRITICAL_SECTION)(param_1[2] + 4));
        }
      }
      local_8 = (uint)local_8._1_3_ << 8;
      FUN_0043a010();
      local_8 = 0xffffffff;
      FUN_00406560();
    }
  }
LAB_007d9286:
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
007d8fa0 : PUSH EBP
007d8fa1 : MOV EBP,ESP
007d8fa3 : PUSH -0x1
007d8fa5 : PUSH 0xb31ff0
007d8faa : MOV EAX,FS:[0x0]
007d8fb0 : PUSH EAX
007d8fb1 : SUB ESP,0x78
007d8fb4 : MOV EAX,[0x00d66fa0]
007d8fb9 : XOR EAX,EBP
007d8fbb : MOV dword ptr [EBP + -0x14],EAX
007d8fbe : PUSH EBX
007d8fbf : PUSH ESI
007d8fc0 : PUSH EDI
007d8fc1 : PUSH EAX
007d8fc2 : LEA EAX,[EBP + -0xc]
007d8fc5 : MOV FS:[0x0],EAX
007d8fcb : MOV EBX,dword ptr [EBP + 0x8]
007d8fce : PUSH -0x1
007d8fd0 : XOR ESI,ESI
007d8fd2 : MOV EDI,ECX
007d8fd4 : PUSH ESI
007d8fd5 : XOR EAX,EAX
007d8fd7 : PUSH EDI
007d8fd8 : LEA ECX,[EBP + -0x30]
007d8fdb : MOV dword ptr [EBP + -0x18],0x7
007d8fe2 : MOV dword ptr [EBP + -0x1c],ESI
007d8fe5 : MOV word ptr [EBP + -0x2c],AX
007d8fe9 : CALL 0x00405eb0
007d8fee : MOV dword ptr [EBP + -0x4],ESI
007d8ff1 : PUSH 0x1
007d8ff3 : LEA ECX,[EBP + -0x3c]
007d8ff6 : PUSH ECX
007d8ff7 : OR ECX,0xffffffff
007d8ffa : MOV dword ptr [EBP + -0x3c],0x2e
007d9001 : CALL 0x00407cc0
007d9006 : CMP EAX,-0x1
007d9009 : JNZ 0x007d9033
007d900b : MOV dword ptr [EBP + -0x4],EAX
007d900e : CMP dword ptr [EBP + -0x18],0x8
007d9012 : JC 0x007d901c
007d9014 : MOV ECX,dword ptr [EBP + -0x2c]
007d9017 : CALL 0x006f04e0
007d901c : XOR EDX,EDX
007d901e : MOV dword ptr [EBP + -0x18],0x7
007d9025 : MOV dword ptr [EBP + -0x1c],ESI
007d9028 : MOV word ptr [EBP + -0x2c],DX
007d902c : XOR AL,AL
007d902e : JMP 0x007d9286
007d9033 : PUSH 0x4
007d9035 : PUSH EAX
007d9036 : LEA ECX,[EBP + -0x30]
007d9039 : CALL 0x00405e10
007d903e : PUSH 0x6
007d9040 : PUSH 0xc1fea0
007d9045 : LEA ESI,[EBP + -0x30]
007d9048 : CALL 0x00404870
007d904d : MOV ECX,dword ptr [0x017251e0]
007d9053 : XOR EDI,EDI
007d9055 : PUSH EDI
007d9056 : MOV EAX,ESI
007d9058 : PUSH EAX
007d9059 : LEA EDX,[EBP + -0x44]
007d905c : CALL 0x007c77d0
007d9061 : MOV byte ptr [EBP + -0x4],0x1
007d9065 : PUSH EAX
007d9066 : LEA ECX,[EBP + -0x38]
007d9069 : PUSH ECX
007d906a : CALL 0x0043e530
007d906f : MOV byte ptr [EBP + -0x4],0x3
007d9073 : MOV ECX,dword ptr [EBP + -0x40]
007d9076 : MOV dword ptr [EBP + -0x44],0xcd4964
007d907d : CMP ECX,EDI
007d907f : JZ 0x007d908b
007d9081 : MOV EDX,dword ptr [ECX]
007d9083 : MOV EAX,dword ptr [EDX + 0x30]
007d9086 : CALL EAX
007d9088 : MOV dword ptr [EBP + -0x40],EDI
007d908b : CMP dword ptr [EBP + -0x34],EDI
007d908e : JNZ 0x007d90c8
007d9090 : MOV byte ptr [EBP + -0x4],0x0
007d9094 : LEA ECX,[EBP + -0x38]
007d9097 : CALL 0x0043a010
007d909c : MOV dword ptr [EBP + -0x4],0xffffffff
007d90a3 : CMP dword ptr [EBP + -0x18],0x8
007d90a7 : JC 0x007d90b1
007d90a9 : MOV ECX,dword ptr [EBP + -0x2c]
007d90ac : CALL 0x006f04e0
007d90b1 : XOR ECX,ECX
007d90b3 : MOV dword ptr [EBP + -0x18],0x7
007d90ba : MOV dword ptr [EBP + -0x1c],EDI
007d90bd : MOV word ptr [EBP + -0x2c],CX
007d90c1 : XOR AL,AL
007d90c3 : JMP 0x007d9286
007d90c8 : MOV EAX,dword ptr [EBX + 0x8]
007d90cb : MOV dword ptr [EBP + -0x58],EBX
007d90ce : CMP EAX,EDI
007d90d0 : JZ 0x007d90dc
007d90d2 : ADD EAX,0x4
007d90d5 : PUSH EAX
007d90d6 : CALL dword ptr [0x00b85118]
007d90dc : MOV byte ptr [EBP + -0x4],0x4
007d90e0 : MOV EDX,dword ptr [EBP + -0x34]
007d90e3 : ADD EDX,0x4
007d90e6 : PUSH EDX
007d90e7 : LEA EAX,[EBP + -0x3c]
007d90ea : PUSH EAX
007d90eb : LEA ESI,[EBX + 0x25c]
007d90f1 : PUSH ESI
007d90f2 : CALL 0x0044f270
007d90f7 : MOV EAX,dword ptr [EBX + 0x264]
007d90fd : CMP dword ptr [EBP + -0x3c],EAX
007d9100 : JZ 0x007d9120
007d9102 : MOV byte ptr [EBP + -0x4],0x3
007d9106 : MOV EAX,dword ptr [EBX + 0x8]
007d9109 : CMP EAX,EDI
007d910b : JZ 0x007d9269
007d9111 : ADD EAX,0x4
007d9114 : PUSH EAX
007d9115 : CALL dword ptr [0x00b8511c]
007d911b : JMP 0x007d9269
007d9120 : MOV byte ptr [EBP + -0x4],0x3
007d9124 : MOV EAX,dword ptr [EBX + 0x8]
007d9127 : CMP EAX,EDI
007d9129 : JZ 0x007d9135
007d912b : ADD EAX,0x4
007d912e : PUSH EAX
007d912f : CALL dword ptr [0x00b8511c]
007d9135 : LEA ECX,[EBP + -0x54]
007d9138 : CALL 0x0045f540
007d913d : MOV byte ptr [EBP + -0x4],0x5
007d9141 : LEA ECX,[EBP + -0x4c]
007d9144 : CALL 0x0045f540
007d9149 : MOV byte ptr [EBP + -0x4],0x6
007d914d : MOV ECX,dword ptr [EBP + 0x10]
007d9150 : MOV EDX,dword ptr [EBP + 0xc]
007d9153 : PUSH EDI
007d9154 : PUSH ECX
007d9155 : PUSH EDX
007d9156 : PUSH EDI
007d9157 : PUSH EDI
007d9158 : PUSH 0x2
007d915a : SUB ESP,0x8
007d915d : MOV EAX,ESP
007d915f : MOV dword ptr [EBP + -0x58],ESP
007d9162 : LEA ECX,[EBP + -0x4c]
007d9165 : PUSH ECX
007d9166 : PUSH EAX
007d9167 : CALL 0x00439f80
007d916c : MOV byte ptr [EBP + -0x4],0x7
007d9170 : SUB ESP,0x8
007d9173 : MOV EDX,ESP
007d9175 : MOV dword ptr [EBP + -0x3c],ESP
007d9178 : LEA EAX,[EBP + -0x54]
007d917b : PUSH EAX
007d917c : PUSH EDX
007d917d : CALL 0x00439f80
007d9182 : MOV byte ptr [EBP + -0x4],0x8
007d9186 : SUB ESP,0x8
007d9189 : MOV ECX,ESP
007d918b : MOV dword ptr [EBP + -0x40],ESP
007d918e : LEA EDX,[EBP + -0x38]
007d9191 : PUSH EDX
007d9192 : PUSH ECX
007d9193 : CALL 0x00439f80
007d9198 : MOV byte ptr [EBP + -0x4],0x9
007d919c : MOV EAX,dword ptr [EBX]
007d919e : MOV byte ptr [EBP + -0x4],0x6
007d91a2 : MOV EAX,dword ptr [EAX + 0xd4]
007d91a8 : MOV ECX,EBX
007d91aa : CALL EAX
007d91ac : TEST AL,AL
007d91ae : JNZ 0x007d91ea
007d91b0 : MOV byte ptr [EBP + -0x4],0x5
007d91b4 : LEA ECX,[EBP + -0x4c]
007d91b7 : CALL 0x0043a010
007d91bc : MOV byte ptr [EBP + -0x4],0x3
007d91c0 : LEA ECX,[EBP + -0x54]
007d91c3 : CALL 0x0043a010
007d91c8 : MOV byte ptr [EBP + -0x4],0x0
007d91cc : LEA ECX,[EBP + -0x38]
007d91cf : CALL 0x0043a010
007d91d4 : MOV dword ptr [EBP + -0x4],0xffffffff
007d91db : LEA ECX,[EBP + -0x30]
007d91de : CALL 0x00406560
007d91e3 : XOR AL,AL
007d91e5 : JMP 0x007d9286
007d91ea : MOV EAX,dword ptr [EBX + 0x8]
007d91ed : MOV dword ptr [EBP + -0x40],EBX
007d91f0 : CMP EAX,EDI
007d91f2 : JZ 0x007d91fe
007d91f4 : ADD EAX,0x4
007d91f7 : PUSH EAX
007d91f8 : CALL dword ptr [0x00b85118]
007d91fe : MOV byte ptr [EBP + -0x4],0xa
007d9202 : LEA ECX,[EBP + -0x38]
007d9205 : PUSH ECX
007d9206 : MOV ECX,dword ptr [EBP + -0x34]
007d9209 : LEA EDX,[EBP + -0x80]
007d920c : ADD ECX,0x4
007d920f : PUSH EDX
007d9210 : CALL 0x00460220
007d9215 : MOV byte ptr [EBP + -0x4],0xb
007d9219 : MOV ECX,dword ptr [ESI + 0x8]
007d921c : PUSH ECX
007d921d : PUSH EAX
007d921e : LEA EAX,[EBP + -0x5c]
007d9221 : PUSH EAX
007d9222 : PUSH ESI
007d9223 : CALL 0x004604f0
007d9228 : MOV byte ptr [EBP + -0x4],0xa
007d922c : LEA ECX,[EBP + -0x80]
007d922f : PUSH ECX
007d9230 : CALL 0x0045fde0
007d9235 : MOV byte ptr [EBP + -0x4],0x6
007d9239 : MOV EAX,dword ptr [EBX + 0x8]
007d923c : CMP EAX,EDI
007d923e : JZ 0x007d924a
007d9240 : ADD EAX,0x4
007d9243 : PUSH EAX
007d9244 : CALL dword ptr [0x00b8511c]
007d924a : MOV byte ptr [EBX + 0x240],0x1
007d9251 : MOV byte ptr [EBP + -0x4],0x5
007d9255 : LEA ECX,[EBP + -0x4c]
007d9258 : CALL 0x0043a010
007d925d : MOV byte ptr [EBP + -0x4],0x3
007d9261 : LEA ECX,[EBP + -0x54]
007d9264 : CALL 0x0043a010
007d9269 : MOV byte ptr [EBP + -0x4],0x0
007d926d : LEA ECX,[EBP + -0x38]
007d9270 : CALL 0x0043a010
007d9275 : MOV dword ptr [EBP + -0x4],0xffffffff
007d927c : LEA ECX,[EBP + -0x30]
007d927f : CALL 0x00406560
007d9284 : MOV AL,0x1
007d9286 : MOV ECX,dword ptr [EBP + -0xc]
007d9289 : MOV dword ptr FS:[0x0],ECX
007d9290 : POP ECX
007d9291 : POP EDI
007d9292 : POP ESI
007d9293 : POP EBX
007d9294 : MOV ECX,dword ptr [EBP + -0x14]
007d9297 : XOR ECX,EBP
007d9299 : CALL 0x00633e6b
007d929e : MOV ESP,EBP
007d92a0 : POP EBP
007d92a1 : RET 0xc

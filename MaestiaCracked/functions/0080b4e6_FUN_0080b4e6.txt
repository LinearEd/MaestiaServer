PROGRAM  : Maestia.exe
FUNCTION : FUN_0080b4e6
ENTRY    : 0080b4e6
BODY     : [[0080b4e6, 0080b593] [0080b59a, 0080b672] [0080b679, 0080b687] [0080b690, 0080b6fa]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_0080b4e6(void)

{
  char cVar1;
  DEVMODEW *pDVar2;
  LPCWSTR lpText;
  char cVar3;
  DEVMODEW *unaff_EBX;
  uint unaff_EBP;
  
  _DAT_00d8a9c4 = FUN_00a0cc70;
  cVar3 = (char)unaff_EBX;
  _DAT_00d8a9c0 = unaff_EBX;
  *(char *)(DAT_017251ac + 0x278) = cVar3;
  cVar1 = FUN_008083a0();
  if (cVar1 != cVar3) {
    *(undefined1 *)(DAT_017251ac + 0x2b8) = 1;
  }
  pDVar2 = (DEVMODEW *)LoadLibraryW(L"mae_acc.dll");
  if (pDVar2 == unaff_EBX) {
    FUN_008018d0(L"LoadSpeedHackDefence Fail()");
  }
  else {
    FUN_008018d0(L"LoadSpeedHackDefence Start()");
    DAT_00da98be = cVar3;
    FUN_00809d00();
    if (*(char *)(unaff_EBP - 0x3551) != cVar3) {
      FUN_008018d0(L"Avatars::Recovery set to force the mode!!");
      ChangeDisplaySettingsW(unaff_EBX,(DWORD)unaff_EBX);
    }
    FUN_006f48d0();
    Sleep(200);
    if (DAT_00da98c0 != unaff_EBX) {
      FUN_0080b900(DAT_00da98c0);
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    if (unaff_EBX < DAT_00d71cb8) {
      lpText = DAT_00d71ca8;
      if (DAT_00d71cbc < 8) {
        lpText = (LPCWSTR)&DAT_00d71ca8;
      }
      MessageBoxW(*(HWND *)(DAT_00da98a8->dmDeviceName + 4),lpText,L"HackShield Error!",
                  (UINT)unaff_EBX);
    }
    if (DAT_00da98a8 != unaff_EBX) {
      (*(code *)**(undefined4 **)(DAT_00da98a8->dmDeviceName + 2))(1);
      DAT_00da98a8 = unaff_EBX;
    }
    if (DAT_00da98b0 != unaff_EBX) {
      (*(code *)**(undefined4 **)DAT_00da98b0->dmDeviceName)(1);
      DAT_00da98b0 = unaff_EBX;
    }
    if (DAT_00da98ac != unaff_EBX) {
      FUN_00454450();
      DAT_00da98ac = unaff_EBX;
    }
    if (DAT_00da98a0 != unaff_EBX) {
      (*(code *)**(undefined4 **)DAT_00da98a0->dmDeviceName)(1);
      DAT_00da98a0 = unaff_EBX;
    }
    if (DAT_00da989c != unaff_EBX) {
      (*(code *)**(undefined4 **)DAT_00da989c->dmDeviceName)(1);
      DAT_00da989c = unaff_EBX;
    }
    if (DAT_00da98a4 != unaff_EBX) {
      (*(code *)**(undefined4 **)DAT_00da98a4->dmDeviceName)(1);
      DAT_00da98a4 = unaff_EBX;
    }
    if (DAT_00da98b4 != unaff_EBX) {
      FUN_008b1d10(DAT_00da98b4);
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    if (DAT_00da98c4 != unaff_EBX) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  *(undefined1 *)(unaff_EBP - 4) = 0x11;
  FUN_00406560();
  *(undefined1 *)(unaff_EBP - 4) = 2;
  FUN_00406560();
  *(char *)(unaff_EBP - 4) = cVar3;
  FUN_00406560();
  *(undefined4 *)(unaff_EBP - 4) = 0xffffffff;
  FUN_00a0add0();
  ExceptionList = *(void **)(unaff_EBP - 0xc);
  __security_check_cookie(*(uint *)(unaff_EBP - 0x14) ^ unaff_EBP);
  return;
}



============================================================
DISASSEMBLY
============================================================
0080b4e6 : MOV dword ptr [0x00d8a9c4],0xa0cc70
0080b4f0 : MOV dword ptr [0x00d8a9c0],EBX
0080b4f6 : MOV ECX,dword ptr [0x017251ac]
0080b4fc : MOV byte ptr [ECX + 0x278],BL
0080b502 : CALL 0x008083a0
0080b507 : CMP AL,BL
0080b509 : JZ 0x0080b518
0080b50b : MOV EDX,dword ptr [0x017251ac]
0080b511 : MOV byte ptr [EDX + 0x2b8],0x1
0080b518 : PUSH 0xc2bffc
0080b51d : CALL dword ptr [0x00b85150]
0080b523 : MOV ESI,dword ptr [0x00da98e8]
0080b529 : CMP EAX,EBX
0080b52b : JZ 0x0080b690
0080b531 : PUSH 0xc2c014
0080b536 : CALL 0x008018d0
0080b53b : ADD ESP,0x4
0080b53e : MOV byte ptr [0x00da98be],BL
0080b544 : CALL 0x00809d00
0080b549 : CMP byte ptr [EBP + 0xffffcaaf],BL
0080b54f : JZ 0x0080b56c
0080b551 : PUSH 0xc2c088
0080b556 : MOV ESI,dword ptr [0x00da98e8]
0080b55c : CALL 0x008018d0
0080b561 : ADD ESP,0x4
0080b564 : PUSH EBX
0080b565 : PUSH EBX
0080b566 : CALL dword ptr [0x00b85470]
0080b56c : CALL 0x006f48d0
0080b571 : PUSH 0xc8
0080b576 : CALL dword ptr [0x00b8510c]
0080b57c : MOV EAX,[0x00da98c0]
0080b581 : CMP EAX,EBX
0080b583 : JZ 0x0080b59a
0080b585 : MOV ESI,EAX
0080b587 : PUSH EAX
0080b588 : CALL 0x0080b900
0080b58d : MOV ECX,ESI
0080b58f : CALL 0x006f04e0
0080b59a : CMP dword ptr [0x00d71cb8],EBX
0080b5a0 : JBE 0x0080b5cc
0080b5a2 : CMP dword ptr [0x00d71cbc],0x8
0080b5a9 : MOV ECX,dword ptr [0x00d71ca8]
0080b5af : JNC 0x0080b5b6
0080b5b1 : MOV ECX,0xd71ca8
0080b5b6 : MOV EAX,[0x00da98a8]
0080b5bb : MOV EAX,dword ptr [EAX + 0x8]
0080b5be : PUSH EBX
0080b5bf : PUSH 0xc2c0dc
0080b5c4 : PUSH ECX
0080b5c5 : PUSH EAX
0080b5c6 : CALL dword ptr [0x00b85514]
0080b5cc : MOV EAX,[0x00da98a8]
0080b5d1 : CMP EAX,EBX
0080b5d3 : JZ 0x0080b5e6
0080b5d5 : LEA ECX,[EAX + 0x4]
0080b5d8 : MOV EDX,dword ptr [ECX]
0080b5da : PUSH 0x1
0080b5dc : MOV EAX,dword ptr [EDX]
0080b5de : CALL EAX
0080b5e0 : MOV dword ptr [0x00da98a8],EBX
0080b5e6 : MOV ECX,dword ptr [0x00da98b0]
0080b5ec : CMP ECX,EBX
0080b5ee : JZ 0x0080b5fe
0080b5f0 : MOV EDX,dword ptr [ECX]
0080b5f2 : PUSH 0x1
0080b5f4 : MOV EAX,dword ptr [EDX]
0080b5f6 : CALL EAX
0080b5f8 : MOV dword ptr [0x00da98b0],EBX
0080b5fe : MOV ESI,dword ptr [0x00da98ac]
0080b604 : CMP ESI,EBX
0080b606 : JZ 0x0080b613
0080b608 : CALL 0x00454450
0080b60d : MOV dword ptr [0x00da98ac],EBX
0080b613 : MOV ECX,dword ptr [0x00da98a0]
0080b619 : CMP ECX,EBX
0080b61b : JZ 0x0080b62b
0080b61d : MOV EDX,dword ptr [ECX]
0080b61f : PUSH 0x1
0080b621 : MOV EAX,dword ptr [EDX]
0080b623 : CALL EAX
0080b625 : MOV dword ptr [0x00da98a0],EBX
0080b62b : MOV ECX,dword ptr [0x00da989c]
0080b631 : CMP ECX,EBX
0080b633 : JZ 0x0080b643
0080b635 : MOV EDX,dword ptr [ECX]
0080b637 : PUSH 0x1
0080b639 : MOV EAX,dword ptr [EDX]
0080b63b : CALL EAX
0080b63d : MOV dword ptr [0x00da989c],EBX
0080b643 : MOV ECX,dword ptr [0x00da98a4]
0080b649 : CMP ECX,EBX
0080b64b : JZ 0x0080b65b
0080b64d : MOV EDX,dword ptr [ECX]
0080b64f : PUSH 0x1
0080b651 : MOV EAX,dword ptr [EDX]
0080b653 : CALL EAX
0080b655 : MOV dword ptr [0x00da98a4],EBX
0080b65b : MOV EAX,[0x00da98b4]
0080b660 : CMP EAX,EBX
0080b662 : JZ 0x0080b679
0080b664 : MOV ESI,EAX
0080b666 : PUSH EAX
0080b667 : CALL 0x008b1d10
0080b66c : MOV ECX,ESI
0080b66e : CALL 0x006f04e0
0080b679 : MOV ECX,dword ptr [0x00da98c4]
0080b67f : CMP ECX,EBX
0080b681 : JZ 0x0080b69d
0080b683 : CALL 0x006f04e0
0080b690 : PUSH 0xc2c050
0080b695 : CALL 0x008018d0
0080b69a : ADD ESP,0x4
0080b69d : MOV byte ptr [EBP + -0x4],0x11
0080b6a1 : LEA ECX,[EBP + 0xffffde98]
0080b6a7 : CALL 0x00406560
0080b6ac : MOV byte ptr [EBP + -0x4],0x2
0080b6b0 : LEA ECX,[EBP + 0xffffde7c]
0080b6b6 : CALL 0x00406560
0080b6bb : MOV byte ptr [EBP + -0x4],BL
0080b6be : LEA ECX,[EBP + 0xffffdeb4]
0080b6c4 : CALL 0x00406560
0080b6c9 : MOV dword ptr [EBP + -0x4],0xffffffff
0080b6d0 : LEA ECX,[EBP + 0xffffcab0]
0080b6d6 : CALL 0x00a0add0
0080b6db : XOR EAX,EAX
0080b6dd : MOV ECX,dword ptr [EBP + -0xc]
0080b6e0 : MOV dword ptr FS:[0x0],ECX
0080b6e7 : POP ECX
0080b6e8 : POP EDI
0080b6e9 : POP ESI
0080b6ea : POP EBX
0080b6eb : MOV ECX,dword ptr [EBP + -0x14]
0080b6ee : XOR ECX,EBP
0080b6f0 : CALL 0x00633e6b
0080b6f5 : MOV ESP,EBP
0080b6f7 : POP EBP
0080b6f8 : RET 0x10

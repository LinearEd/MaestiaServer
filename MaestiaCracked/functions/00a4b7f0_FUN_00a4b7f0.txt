PROGRAM  : Maestia.exe
FUNCTION : FUN_00a4b7f0
ENTRY    : 00a4b7f0
BODY     : [[00a4b7f0, 00a4ba0a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a4b7f0(int param_1,int param_2,undefined4 param_3)

{
  int iVar1;
  uint uVar2;
  DWORD DVar3;
  undefined4 ****ppppuVar4;
  uint local_8c;
  undefined1 local_88 [4];
  undefined2 local_84;
  undefined4 local_74;
  uint local_70;
  undefined1 local_6c [4];
  undefined2 local_68;
  undefined4 local_58;
  uint local_54;
  int local_50;
  undefined1 local_4c [4];
  undefined4 ***local_48 [4];
  undefined4 local_38;
  uint local_34;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b267fb;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_18 = 7;
  local_1c = 0;
  local_2c = 0;
  local_14 = uVar2;
  FUN_00406360(&DAT_00cc7a9c,0);
  local_8 = 0;
  FUN_00a4b570(local_30);
  local_54 = 7;
  local_58 = 0;
  local_68 = 0;
  FUN_00406360(L"IDS_DELETE_STANDBY",0x12);
  local_8._0_1_ = 1;
  FUN_0081d120(local_6c);
  local_8._0_1_ = 2;
  FUN_00403510(local_88,uVar2);
  local_8._0_1_ = 3;
  FUN_00403450(local_4c,local_30);
  local_8 = CONCAT31(local_8._1_3_,5);
  if (7 < local_70) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_70 = 7;
  local_74 = 0;
  local_84 = 0;
  local_8 = CONCAT31(local_8._1_3_,6);
  if (7 < local_8c) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_8._0_1_ = 7;
  if (7 < local_54) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_58 = 0;
  local_50 = **(int **)(param_1 + 0x128);
  local_54 = 7;
  local_68 = 0;
  if ((int *)local_50 != *(int **)(param_1 + 0x128)) {
    do {
      iVar1 = local_50;
      if (*(int *)(*(int *)(local_50 + 0x10) + 4) == param_2) {
        *(undefined1 *)(*(int *)(local_50 + 0x10) + 0x1fd1) = 1;
        *(undefined4 *)(*(int *)(local_50 + 0x10) + 0x1fd4) = param_3;
        DVar3 = GetTickCount();
        *(DWORD *)(*(int *)(iVar1 + 0x10) + 0x1fd8) = DVar3;
        if (*(int *)(param_1 + 0x40) != 0) {
          ppppuVar4 = (undefined4 ****)local_48[0];
          if (local_34 < 8) {
            ppppuVar4 = local_48;
          }
          (**(code **)(**(int **)(param_1 + 0x40) + 4))
                    (*(int **)(param_1 + 0x40),"SetDeleteChar","%d,%b,%ls",
                     *(undefined2 *)(iVar1 + 0xc),1,ppppuVar4);
        }
      }
      FUN_00416210();
    } while (local_50 != *(int *)(param_1 + 0x128));
  }
  local_8 = (uint)local_8._1_3_ << 8;
  if (local_34 < 8) {
    local_34 = 7;
    local_38 = 0;
    local_48[0] = (undefined4 ***)((uint)local_48[0] & 0xffff0000);
    local_8 = 0xffffffff;
    if (local_18 < 8) {
      local_18 = 7;
      local_1c = 0;
      local_2c = 0;
      ExceptionList = local_10;
      __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
      return;
    }
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
00a4b7f0 : PUSH EBP
00a4b7f1 : MOV EBP,ESP
00a4b7f3 : PUSH -0x1
00a4b7f5 : PUSH 0xb267fb
00a4b7fa : MOV EAX,FS:[0x0]
00a4b800 : PUSH EAX
00a4b801 : SUB ESP,0x94
00a4b807 : MOV EAX,[0x00d66fa0]
00a4b80c : XOR EAX,EBP
00a4b80e : MOV dword ptr [EBP + -0x10],EAX
00a4b811 : PUSH EBX
00a4b812 : PUSH ESI
00a4b813 : PUSH EDI
00a4b814 : PUSH EAX
00a4b815 : LEA EAX,[EBP + -0xc]
00a4b818 : MOV FS:[0x0],EAX
00a4b81e : MOV EBX,dword ptr [EBP + 0x8]
00a4b821 : XOR ESI,ESI
00a4b823 : PUSH ESI
00a4b824 : XOR EAX,EAX
00a4b826 : MOV EDI,0x7
00a4b82b : PUSH 0xcc7a9c
00a4b830 : LEA ECX,[EBP + -0x2c]
00a4b833 : MOV dword ptr [EBP + -0x14],EDI
00a4b836 : MOV dword ptr [EBP + -0x18],ESI
00a4b839 : MOV word ptr [EBP + -0x28],AX
00a4b83d : CALL 0x00406360
00a4b842 : MOV dword ptr [EBP + -0x4],ESI
00a4b845 : LEA ECX,[EBP + -0x2c]
00a4b848 : PUSH ECX
00a4b849 : MOV ECX,dword ptr [EBP + 0x10]
00a4b84c : CALL 0x00a4b570
00a4b851 : PUSH 0x12
00a4b853 : XOR EDX,EDX
00a4b855 : PUSH 0xcc7aa4
00a4b85a : LEA ECX,[EBP + -0x68]
00a4b85d : MOV dword ptr [EBP + -0x50],EDI
00a4b860 : MOV dword ptr [EBP + -0x54],ESI
00a4b863 : MOV word ptr [EBP + -0x64],DX
00a4b867 : CALL 0x00406360
00a4b86c : MOV byte ptr [EBP + -0x4],0x1
00a4b870 : MOV ECX,dword ptr [0x0172491c]
00a4b876 : LEA EAX,[EBP + -0x68]
00a4b879 : PUSH EAX
00a4b87a : LEA EDI,[EBP + 0xffffff60]
00a4b880 : CALL 0x0081d120
00a4b885 : MOV byte ptr [EBP + -0x4],0x2
00a4b889 : LEA ECX,[EBP + 0xffffff7c]
00a4b88f : PUSH ECX
00a4b890 : MOV EDX,0xcc7aa0
00a4b895 : MOV ECX,EAX
00a4b897 : CALL 0x00403510
00a4b89c : MOV byte ptr [EBP + -0x4],0x3
00a4b8a0 : LEA EDX,[EBP + -0x2c]
00a4b8a3 : PUSH EDX
00a4b8a4 : LEA ECX,[EBP + -0x48]
00a4b8a7 : PUSH ECX
00a4b8a8 : MOV ECX,EAX
00a4b8aa : CALL 0x00403450
00a4b8af : ADD ESP,0xc
00a4b8b2 : MOV byte ptr [EBP + -0x4],0x5
00a4b8b6 : CMP dword ptr [EBP + -0x6c],0x8
00a4b8ba : JC 0x00a4b8c4
00a4b8bc : MOV ECX,dword ptr [EBP + -0x80]
00a4b8bf : CALL 0x006f04e0
00a4b8c4 : MOV EDI,0x7
00a4b8c9 : XOR EDX,EDX
00a4b8cb : MOV dword ptr [EBP + -0x6c],EDI
00a4b8ce : MOV dword ptr [EBP + -0x70],ESI
00a4b8d1 : MOV word ptr [EBP + -0x80],DX
00a4b8d5 : MOV byte ptr [EBP + -0x4],0x6
00a4b8d9 : CMP dword ptr [EBP + 0xffffff78],0x8
00a4b8e0 : JC 0x00a4b8ed
00a4b8e2 : MOV ECX,dword ptr [EBP + 0xffffff64]
00a4b8e8 : CALL 0x006f04e0
00a4b8ed : XOR EAX,EAX
00a4b8ef : MOV dword ptr [EBP + 0xffffff78],EDI
00a4b8f5 : MOV dword ptr [EBP + 0xffffff74],ESI
00a4b8fb : MOV word ptr [EBP + 0xffffff64],AX
00a4b902 : MOV byte ptr [EBP + -0x4],0x7
00a4b906 : CMP dword ptr [EBP + -0x50],0x8
00a4b90a : JC 0x00a4b914
00a4b90c : MOV ECX,dword ptr [EBP + -0x64]
00a4b90f : CALL 0x006f04e0
00a4b914 : MOV EAX,dword ptr [EBX + 0x128]
00a4b91a : MOV dword ptr [EBP + -0x54],ESI
00a4b91d : MOV ESI,dword ptr [EAX]
00a4b91f : XOR ECX,ECX
00a4b921 : MOV dword ptr [EBP + -0x50],EDI
00a4b924 : MOV word ptr [EBP + -0x64],CX
00a4b928 : MOV dword ptr [EBP + -0x4c],ESI
00a4b92b : CMP ESI,EAX
00a4b92d : JZ 0x00a4b9a7
00a4b92f : MOV EDI,dword ptr [0x00b850d8]
00a4b935 : MOV EDX,dword ptr [ESI + 0x10]
00a4b938 : MOV EAX,dword ptr [EBP + 0xc]
00a4b93b : CMP dword ptr [EDX + 0x4],EAX
00a4b93e : JNZ 0x00a4b992
00a4b940 : MOV ECX,dword ptr [EBP + 0x10]
00a4b943 : MOV EAX,EDX
00a4b945 : MOV byte ptr [EAX + 0x1fd1],0x1
00a4b94c : MOV EAX,dword ptr [ESI + 0x10]
00a4b94f : MOV dword ptr [EAX + 0x1fd4],ECX
00a4b955 : CALL EDI
00a4b957 : MOV ECX,dword ptr [ESI + 0x10]
00a4b95a : MOV dword ptr [ECX + 0x1fd8],EAX
00a4b960 : CMP dword ptr [EBX + 0x40],0x0
00a4b964 : JZ 0x00a4b992
00a4b966 : CMP dword ptr [EBP + -0x30],0x8
00a4b96a : MOV ECX,dword ptr [EBP + -0x44]
00a4b96d : JNC 0x00a4b972
00a4b96f : LEA ECX,[EBP + -0x44]
00a4b972 : MOV EAX,dword ptr [EBX + 0x40]
00a4b975 : MOV EDX,dword ptr [EAX]
00a4b977 : MOV EDX,dword ptr [EDX + 0x4]
00a4b97a : PUSH ECX
00a4b97b : MOVZX ECX,word ptr [ESI + 0xc]
00a4b97f : PUSH 0x1
00a4b981 : PUSH ECX
00a4b982 : PUSH 0xcc7acc
00a4b987 : PUSH 0xcc7ad8
00a4b98c : PUSH EAX
00a4b98d : CALL EDX
00a4b98f : ADD ESP,0x18
00a4b992 : LEA EDX,[EBP + -0x4c]
00a4b995 : CALL 0x00416210
00a4b99a : MOV EAX,dword ptr [EBX + 0x128]
00a4b9a0 : MOV ESI,dword ptr [EBP + -0x4c]
00a4b9a3 : CMP ESI,EAX
00a4b9a5 : JNZ 0x00a4b935
00a4b9a7 : MOV byte ptr [EBP + -0x4],0x0
00a4b9ab : CMP dword ptr [EBP + -0x30],0x8
00a4b9af : JC 0x00a4b9b9
00a4b9b1 : MOV ECX,dword ptr [EBP + -0x44]
00a4b9b4 : CALL 0x006f04e0
00a4b9b9 : MOV ESI,0x7
00a4b9be : XOR EDI,EDI
00a4b9c0 : XOR EAX,EAX
00a4b9c2 : MOV dword ptr [EBP + -0x30],ESI
00a4b9c5 : MOV dword ptr [EBP + -0x34],EDI
00a4b9c8 : MOV word ptr [EBP + -0x44],AX
00a4b9cc : MOV dword ptr [EBP + -0x4],0xffffffff
00a4b9d3 : CMP dword ptr [EBP + -0x14],0x8
00a4b9d7 : JC 0x00a4b9e1
00a4b9d9 : MOV ECX,dword ptr [EBP + -0x28]
00a4b9dc : CALL 0x006f04e0
00a4b9e1 : XOR ECX,ECX
00a4b9e3 : MOV dword ptr [EBP + -0x14],ESI
00a4b9e6 : MOV dword ptr [EBP + -0x18],EDI
00a4b9e9 : MOV word ptr [EBP + -0x28],CX
00a4b9ed : MOV ECX,dword ptr [EBP + -0xc]
00a4b9f0 : MOV dword ptr FS:[0x0],ECX
00a4b9f7 : POP ECX
00a4b9f8 : POP EDI
00a4b9f9 : POP ESI
00a4b9fa : POP EBX
00a4b9fb : MOV ECX,dword ptr [EBP + -0x10]
00a4b9fe : XOR ECX,EBP
00a4ba00 : CALL 0x00633e6b
00a4ba05 : MOV ESP,EBP
00a4ba07 : POP EBP
00a4ba08 : RET 0xc

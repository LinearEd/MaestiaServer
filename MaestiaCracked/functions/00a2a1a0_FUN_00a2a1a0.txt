PROGRAM  : Maestia.exe
FUNCTION : FUN_00a2a1a0
ENTRY    : 00a2a1a0
BODY     : [[00a2a1a0, 00a2a4cd]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 FUN_00a2a1a0(float param_1,float param_2,undefined2 param_3)

{
  int iVar1;
  int iVar2;
  ulonglong uVar3;
  int iVar4;
  DWORD DVar5;
  uint8_t *packet;
  float fVar6;
  float fVar7;
  float fVar8;
  float fVar9;
  wchar_t *pwVar10;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3b093;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  iVar4 = FUN_00703c00(0x300,DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
  if (iVar4 == 0) {
    pwVar10 = L"AvaGameZone::MinimapWarpMove Not Found Zone";
  }
  else {
    iVar1 = *DAT_00da9894;
    iVar2 = *(int *)(iVar1 + 300);
    fVar8 = (float)*(ushort *)(iVar4 + 0x44) * 10.0;
    fVar6 = (float)*(ushort *)(iVar4 + 0x46) * 10.0;
    fVar7 = fVar8 * 0.0021645022 * param_1;
    fVar9 = fVar6 - fVar6 * param_2 * 0.0021645022;
    if ((iVar2 != 0) && (*(int *)(iVar2 + 0x18) != 0)) {
      iVar4 = 0;
      if (iVar2 != 0) {
        iVar4 = *(int *)(iVar2 + 0x18);
      }
      *(float *)(iVar4 + 0x40) = fVar8;
      iVar4 = 0;
      if (*(int *)(iVar1 + 300) != 0) {
        iVar4 = *(int *)(*(int *)(iVar1 + 300) + 0x18);
      }
      *(float *)(iVar4 + 0x44) = fVar6;
      iVar4 = 0;
      if (*(int *)(iVar1 + 300) != 0) {
        iVar4 = *(int *)(*(int *)(iVar1 + 300) + 0x18);
      }
      *(float *)(iVar4 + 200) = fVar7;
      *(undefined4 *)(iVar4 + 0xcc) = 0;
      *(float *)(iVar4 + 0xd0) = fVar9;
      FUN_00981ad0(0);
    }
    iVar4 = 0;
    if (*(int *)(*DAT_00da9894 + 300) != 0) {
      iVar4 = *(int *)(*(int *)(*DAT_00da9894 + 300) + 0x18);
    }
    iVar4 = *(int *)(iVar4 + 0xf4);
    if (iVar4 == -1) {
      pwVar10 = L"AvaGameZone::MinimapWarpMove not set the warp scroll.";
    }
    else {
      DVar5 = timeGetTime();
      if (999 < DVar5 - _DAT_017247a0) {
        iVar1 = *(int *)ThreadLocalStoragePointer;
        uVar3 = (ulonglong)(*(byte *)(iVar1 + 0x18) + 1) % 3;
        packet = (uint8_t *)((int)uVar3 * 0x2000 + 0x122cb8 + iVar1);
        *(char *)(iVar1 + 0x18) = (char)uVar3;
        if (packet == (uint8_t *)0x0) {
          packet = (uint8_t *)0x0;
        }
        else {
          packet[0] = '\0';
          packet[1] = '\0';
          packet[2] = '6';
          packet[3] = 0xa7;
        }
        local_8 = 0xffffffff;
        *(undefined2 *)(packet + 8) = param_3;
        *(short *)(packet + 0xc) = (short)(int)(fVar6 - fVar9);
        iVar1 = DAT_017247d4;
        *(int *)(packet + 4) = iVar4;
        *(short *)(packet + 10) = (short)(int)fVar7;
        iVar4 = *(int *)(iVar1 + 4);
        if ((iVar4 != 0) && (*(char *)(iVar1 + 8) != '\0')) {
          FUN_00a0dd40(iVar4,0xe,packet);
        }
        _DAT_017247a0 = timeGetTime();
        if ((*(int *)(*DAT_00da9894 + 300) != 0) &&
           (*(int *)(*(int *)(*DAT_00da9894 + 300) + 0x18) != 0)) {
          iVar4 = FUN_00703c00(0x300);
          if (iVar4 == 0) {
            pwVar10 = L"AvaGameZone::MinimapWarpMove BackZone Not found";
            goto LAB_00a2a1e1;
          }
          iVar1 = *DAT_00da9894;
          iVar2 = *(int *)(iVar1 + 300);
          fVar7 = (float)*(ushort *)(iVar4 + 0x44) * 10.0;
          fVar6 = (float)*(ushort *)(iVar4 + 0x46) * 10.0;
          if ((iVar2 != 0) && (*(int *)(iVar2 + 0x18) != 0)) {
            iVar4 = 0;
            if (iVar2 != 0) {
              iVar4 = *(int *)(iVar2 + 0x18);
            }
            *(float *)(iVar4 + 0x40) = fVar7;
            iVar4 = 0;
            if (*(int *)(iVar1 + 300) != 0) {
              iVar4 = *(int *)(*(int *)(iVar1 + 300) + 0x18);
            }
            *(float *)(iVar4 + 0x44) = fVar6;
            iVar4 = 0;
            if (*(int *)(iVar1 + 300) != 0) {
              iVar4 = *(int *)(*(int *)(iVar1 + 300) + 0x18);
            }
            *(float *)(iVar4 + 200) = fVar7 * 0.0021645022 * param_1;
            *(undefined4 *)(iVar4 + 0xcc) = 0;
            *(float *)(iVar4 + 0xd0) = fVar6 - fVar6 * param_2 * 0.0021645022;
            FUN_00981ad0(0);
          }
        }
        ExceptionList = local_10;
        return 1;
      }
      pwVar10 = L"AvaGameZone::MinimapWarpMove Click continuous Error";
    }
  }
LAB_00a2a1e1:
  FUN_008018d0(pwVar10);
  ExceptionList = local_10;
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00a2a1a0 : PUSH EBP
00a2a1a1 : MOV EBP,ESP
00a2a1a3 : PUSH -0x1
00a2a1a5 : PUSH 0xb3b093
00a2a1aa : MOV EAX,FS:[0x0]
00a2a1b0 : PUSH EAX
00a2a1b1 : SUB ESP,0x20
00a2a1b4 : PUSH EBX
00a2a1b5 : PUSH ESI
00a2a1b6 : PUSH EDI
00a2a1b7 : MOV EAX,[0x00d66fa0]
00a2a1bc : XOR EAX,EBP
00a2a1be : PUSH EAX
00a2a1bf : LEA EAX,[EBP + -0xc]
00a2a1c2 : MOV FS:[0x0],EAX
00a2a1c8 : MOV EDI,dword ptr [EBP + 0x10]
00a2a1cb : PUSH 0x300
00a2a1d0 : CALL 0x00703c00
00a2a1d5 : ADD ESP,0x4
00a2a1d8 : TEST EAX,EAX
00a2a1da : JNZ 0x00a2a205
00a2a1dc : PUSH 0xcc40f8
00a2a1e1 : MOV ESI,dword ptr [0x00da98e8]
00a2a1e7 : CALL 0x008018d0
00a2a1ec : ADD ESP,0x4
00a2a1ef : XOR AL,AL
00a2a1f1 : MOV ECX,dword ptr [EBP + -0xc]
00a2a1f4 : MOV dword ptr FS:[0x0],ECX
00a2a1fb : POP ECX
00a2a1fc : POP EDI
00a2a1fd : POP ESI
00a2a1fe : POP EBX
00a2a1ff : MOV ESP,EBP
00a2a201 : POP EBP
00a2a202 : RET 0xc
00a2a205 : MOVZX ECX,word ptr [EAX + 0x44]
00a2a209 : MOVZX EDX,word ptr [EAX + 0x46]
00a2a20d : MOVSS XMM1,dword ptr [0x00c18874]
00a2a215 : MOV EAX,[0x00da9894]
00a2a21a : MOVSS XMM3,dword ptr [0x00cdf76c]
00a2a222 : MOV EAX,dword ptr [EAX]
00a2a224 : CVTSI2SS XMM2,ECX
00a2a228 : MOV ECX,dword ptr [EAX + 0x12c]
00a2a22e : MULSS XMM2,XMM1
00a2a232 : CVTSI2SS XMM0,EDX
00a2a236 : MULSS XMM0,XMM1
00a2a23a : MOVAPS XMM4,XMM0
00a2a23d : MULSS XMM4,dword ptr [EBP + 0xc]
00a2a242 : MOVAPS XMM1,XMM2
00a2a245 : MULSS XMM1,XMM3
00a2a249 : MULSS XMM1,dword ptr [EBP + 0x8]
00a2a24e : MULSS XMM4,XMM3
00a2a252 : MOVAPS XMM3,XMM0
00a2a255 : SUBSS XMM3,XMM4
00a2a259 : MOVSS dword ptr [EBP + -0x10],XMM0
00a2a25e : MOVSS dword ptr [EBP + -0x1c],XMM1
00a2a263 : MOVSS dword ptr [EBP + -0x14],XMM3
00a2a268 : TEST ECX,ECX
00a2a26a : JZ 0x00a2a2d8
00a2a26c : CMP dword ptr [ECX + 0x18],0x0
00a2a270 : JZ 0x00a2a2d8
00a2a272 : TEST ECX,ECX
00a2a274 : JZ 0x00a2a279
00a2a276 : MOV ECX,dword ptr [ECX + 0x18]
00a2a279 : MOVSS dword ptr [ECX + 0x40],XMM2
00a2a27e : MOV ECX,dword ptr [EAX + 0x12c]
00a2a284 : TEST ECX,ECX
00a2a286 : JZ 0x00a2a28b
00a2a288 : MOV ECX,dword ptr [ECX + 0x18]
00a2a28b : MOVSS dword ptr [ECX + 0x44],XMM0
00a2a290 : MOV ECX,dword ptr [EAX + 0x12c]
00a2a296 : TEST ECX,ECX
00a2a298 : JZ 0x00a2a29d
00a2a29a : MOV ECX,dword ptr [ECX + 0x18]
00a2a29d : XORPS XMM0,XMM0
00a2a2a0 : MOVSS dword ptr [ECX + 0xc8],XMM1
00a2a2a8 : MOVSS dword ptr [ECX + 0xcc],XMM0
00a2a2b0 : MOVSS dword ptr [ECX + 0xd0],XMM3
00a2a2b8 : MOV EAX,dword ptr [EAX + 0x12c]
00a2a2be : TEST EAX,EAX
00a2a2c0 : JZ 0x00a2a2c5
00a2a2c2 : MOV EAX,dword ptr [EAX + 0x18]
00a2a2c5 : PUSH 0x0
00a2a2c7 : MOV ESI,EAX
00a2a2c9 : CALL 0x00981ad0
00a2a2ce : MOVSS XMM3,dword ptr [EBP + -0x14]
00a2a2d3 : MOVSS XMM0,dword ptr [EBP + -0x10]
00a2a2d8 : MOV ECX,dword ptr [0x00da9894]
00a2a2de : MOV EAX,dword ptr [ECX]
00a2a2e0 : MOV EAX,dword ptr [EAX + 0x12c]
00a2a2e6 : SUBSS XMM0,XMM3
00a2a2ea : MOVSS dword ptr [EBP + -0x24],XMM0
00a2a2ef : TEST EAX,EAX
00a2a2f1 : JZ 0x00a2a2f6
00a2a2f3 : MOV EAX,dword ptr [EAX + 0x18]
00a2a2f6 : MOV ESI,dword ptr [EAX + 0xf4]
00a2a2fc : CMP ESI,-0x1
00a2a2ff : JNZ 0x00a2a30b
00a2a301 : PUSH 0xcc4150
00a2a306 : JMP 0x00a2a1e1
00a2a30b : MOV EBX,dword ptr [0x00b85598]
00a2a311 : CALL EBX
00a2a313 : SUB EAX,dword ptr [0x017247a0]
00a2a319 : CMP EAX,0x3e8
00a2a31e : JNC 0x00a2a32a
00a2a320 : PUSH 0xcc41f8
00a2a325 : JMP 0x00a2a1e1
00a2a32a : MOV EDX,dword ptr FS:[0x2c]
00a2a331 : MOV ECX,dword ptr [EDX]
00a2a333 : MOVZX EAX,byte ptr [ECX + 0x18]
00a2a337 : INC EAX
00a2a338 : CDQ
00a2a339 : MOV EDI,0x3
00a2a33e : IDIV EDI
00a2a340 : MOVZX EAX,DL
00a2a343 : SHL EAX,0xd
00a2a346 : LEA EAX,[EAX + ECX*0x1 + 0x122cb8]
00a2a34d : MOV byte ptr [ECX + 0x18],DL
00a2a350 : MOV dword ptr [EBP + -0x10],EAX
00a2a353 : MOV dword ptr [EBP + -0x4],0x0
00a2a35a : TEST EAX,EAX
00a2a35c : JZ 0x00a2a36d
00a2a35e : XOR ECX,ECX
00a2a360 : MOV word ptr [EAX],CX
00a2a363 : MOV byte ptr [EAX + 0x2],0x36
00a2a367 : MOV byte ptr [EAX + 0x3],0xa7
00a2a36b : JMP 0x00a2a36f
00a2a36d : XOR EAX,EAX
00a2a36f : MOV dword ptr [EBP + -0x4],0xffffffff
00a2a376 : MOV DX,word ptr [EBP + 0x10]
00a2a37a : CVTTSS2SI ECX,dword ptr [EBP + -0x1c]
00a2a37f : MOV word ptr [EAX + 0x8],DX
00a2a383 : CVTTSS2SI EDX,dword ptr [EBP + -0x24]
00a2a388 : MOV word ptr [EAX + 0xc],DX
00a2a38c : MOV EDX,dword ptr [0x017247d4]
00a2a392 : MOV dword ptr [EAX + 0x4],ESI
00a2a395 : MOV word ptr [EAX + 0xa],CX
00a2a399 : MOV ECX,dword ptr [EDX + 0x4]
00a2a39c : TEST ECX,ECX
00a2a39e : JZ 0x00a2a3b0
00a2a3a0 : CMP byte ptr [EDX + 0x8],0x0
00a2a3a4 : JZ 0x00a2a3b0
00a2a3a6 : PUSH 0xe
00a2a3a8 : PUSH ECX
00a2a3a9 : MOV EDI,EAX
00a2a3ab : CALL 0x00a0dd40
00a2a3b0 : CALL EBX
00a2a3b2 : MOV [0x017247a0],EAX
00a2a3b7 : MOV EAX,[0x00da9894]
00a2a3bc : MOV ECX,dword ptr [EAX]
00a2a3be : MOV EAX,dword ptr [ECX + 0x12c]
00a2a3c4 : TEST EAX,EAX
00a2a3c6 : JZ 0x00a2a4b8
00a2a3cc : CMP dword ptr [EAX + 0x18],0x0
00a2a3d0 : JZ 0x00a2a4b8
00a2a3d6 : MOV ECX,EAX
00a2a3d8 : TEST ECX,ECX
00a2a3da : JZ 0x00a2a3df
00a2a3dc : MOV EAX,dword ptr [ECX + 0x18]
00a2a3df : MOVZX EDI,word ptr [EAX + 0x6c]
00a2a3e3 : PUSH 0x300
00a2a3e8 : CALL 0x00703c00
00a2a3ed : ADD ESP,0x4
00a2a3f0 : TEST EAX,EAX
00a2a3f2 : JNZ 0x00a2a3fe
00a2a3f4 : PUSH 0xcc4260
00a2a3f9 : JMP 0x00a2a1e1
00a2a3fe : MOVZX ECX,word ptr [EAX + 0x44]
00a2a402 : MOVZX EDX,word ptr [EAX + 0x46]
00a2a406 : MOVSS XMM1,dword ptr [0x00c18874]
00a2a40e : MOV EAX,[0x00da9894]
00a2a413 : MOVSS XMM3,dword ptr [0x00cdf76c]
00a2a41b : CVTSI2SS XMM2,ECX
00a2a41f : MOV ECX,dword ptr [EAX]
00a2a421 : MOV EAX,dword ptr [ECX + 0x12c]
00a2a427 : MULSS XMM2,XMM1
00a2a42b : CVTSI2SS XMM0,EDX
00a2a42f : MULSS XMM0,XMM1
00a2a433 : MOVAPS XMM4,XMM0
00a2a436 : MULSS XMM4,dword ptr [EBP + 0xc]
00a2a43b : MOVAPS XMM1,XMM2
00a2a43e : MULSS XMM1,XMM3
00a2a442 : MULSS XMM1,dword ptr [EBP + 0x8]
00a2a447 : MULSS XMM4,XMM3
00a2a44b : MOVAPS XMM3,XMM0
00a2a44e : SUBSS XMM3,XMM4
00a2a452 : TEST EAX,EAX
00a2a454 : JZ 0x00a2a4b8
00a2a456 : CMP dword ptr [EAX + 0x18],0x0
00a2a45a : JZ 0x00a2a4b8
00a2a45c : TEST EAX,EAX
00a2a45e : JZ 0x00a2a463
00a2a460 : MOV EAX,dword ptr [EAX + 0x18]
00a2a463 : MOVSS dword ptr [EAX + 0x40],XMM2
00a2a468 : MOV EAX,dword ptr [ECX + 0x12c]
00a2a46e : TEST EAX,EAX
00a2a470 : JZ 0x00a2a475
00a2a472 : MOV EAX,dword ptr [EAX + 0x18]
00a2a475 : MOVSS dword ptr [EAX + 0x44],XMM0
00a2a47a : MOV EAX,dword ptr [ECX + 0x12c]
00a2a480 : TEST EAX,EAX
00a2a482 : JZ 0x00a2a487
00a2a484 : MOV EAX,dword ptr [EAX + 0x18]
00a2a487 : XORPS XMM0,XMM0
00a2a48a : MOVSS dword ptr [EAX + 0xc8],XMM1
00a2a492 : MOVSS dword ptr [EAX + 0xcc],XMM0
00a2a49a : MOVSS dword ptr [EAX + 0xd0],XMM3
00a2a4a2 : MOV ECX,dword ptr [ECX + 0x12c]
00a2a4a8 : TEST ECX,ECX
00a2a4aa : JZ 0x00a2a4af
00a2a4ac : MOV ECX,dword ptr [ECX + 0x18]
00a2a4af : PUSH 0x0
00a2a4b1 : MOV ESI,ECX
00a2a4b3 : CALL 0x00981ad0
00a2a4b8 : MOV AL,0x1
00a2a4ba : MOV ECX,dword ptr [EBP + -0xc]
00a2a4bd : MOV dword ptr FS:[0x0],ECX
00a2a4c4 : POP ECX
00a2a4c5 : POP EDI
00a2a4c6 : POP ESI
00a2a4c7 : POP EBX
00a2a4c8 : MOV ESP,EBP
00a2a4ca : POP EBP
00a2a4cb : RET 0xc

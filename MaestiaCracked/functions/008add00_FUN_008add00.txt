PROGRAM  : Maestia.exe
FUNCTION : FUN_008add00
ENTRY    : 008add00
BODY     : [[008add00, 008adf0a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008add00(ushort *param_1)

{
  undefined4 *puVar1;
  short sVar2;
  int *piVar3;
  uint *puVar4;
  uint uVar5;
  int iVar6;
  short *psVar7;
  uint uVar8;
  int in_ECX;
  short *psVar9;
  uint uVar10;
  uint *puVar11;
  undefined4 local_64;
  uint local_60;
  uint local_5c;
  int local_54;
  uint local_48;
  uint local_44;
  undefined2 local_3c;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined1 local_20;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b44dc0;
  local_10 = ExceptionList;
  uVar5 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  uVar10 = (*param_1 & 0x1fff) - 0xd;
  puVar11 = (uint *)((int)param_1 + 0xd);
  local_54 = 0;
  local_18 = uVar5;
  if (0 < *(int *)((int)param_1 + 5)) {
    do {
      if ((puVar11 == (uint *)0x0) || (uVar10 < 8)) {
LAB_008addad:
        psVar9 = (short *)0x0;
LAB_008addaf:
        uVar10 = 0;
        puVar11 = (uint *)0x0;
      }
      else {
        local_60 = *puVar11;
        local_5c = puVar11[1];
        uVar10 = uVar10 - 8;
        if ((puVar11 + 2 == (uint *)0x0) ||
           (((uVar10 < 2 || (sVar2 = (short)puVar11[2], sVar2 < 0)) ||
            (iVar6 = (int)sVar2, (int)uVar10 < iVar6 + 2)))) goto LAB_008addad;
        psVar9 = (short *)((int)puVar11 + 10);
        puVar1 = (undefined4 *)((int)puVar11 + iVar6 + 10);
        uVar10 = uVar10 + (-2 - iVar6);
        if ((puVar1 == (undefined4 *)0x0) || (uVar10 < 4)) goto LAB_008addaf;
        local_64 = *puVar1;
        uVar10 = uVar10 - 4;
        puVar11 = puVar1 + 1;
      }
      local_28 = 7;
      local_2c = 0;
      local_3c = 0;
      local_8 = 1;
      local_48 = local_60;
      local_44 = local_5c;
      psVar7 = psVar9;
      do {
        sVar2 = *psVar7;
        psVar7 = psVar7 + 1;
      } while (sVar2 != 0);
      FUN_00406360(psVar9,(int)psVar7 - (int)(psVar9 + 1) >> 1);
      local_24 = local_64;
      local_20 = 0;
      if (*(int *)(in_ECX + 0x104) == 0) {
LAB_008ade6c:
        FUN_00430840(&local_48);
      }
      else {
        uVar8 = *(uint *)(in_ECX + 0x100);
        piVar3 = *(int **)(in_ECX + 0xe8);
        if (piVar3 == (int *)0x0) {
          iVar6 = 0;
        }
        else {
          iVar6 = *piVar3;
        }
        if (*(uint *)(iVar6 + 0x14) <= uVar8) {
          if (piVar3 == (int *)0x0) {
            iVar6 = 0;
          }
          else {
            iVar6 = *piVar3;
          }
          uVar8 = uVar8 - *(int *)(iVar6 + 0x14);
        }
        if (piVar3 == (int *)0x0) {
          iVar6 = 0;
        }
        else {
          iVar6 = *piVar3;
        }
        puVar4 = *(uint **)(*(int *)(iVar6 + 0x10) + uVar8 * 4);
        uVar8 = puVar4[1];
        if (((int)local_44 < (int)uVar8) || (((int)local_44 <= (int)uVar8 && (local_48 <= *puVar4)))
           ) goto LAB_008ade6c;
        FUN_004307c0();
      }
      local_8 = 0xffffffff;
      FUN_00401300(&local_48);
      local_54 = local_54 + 1;
    } while (local_54 < *(int *)((int)param_1 + 5));
  }
  iVar6 = *(int *)(in_ECX + 0x104) + *(int *)(in_ECX + 0x100);
  FUN_00430e60(iVar6 - *(int *)(in_ECX + 0x100),FUN_008ab320,*(undefined4 *)(in_ECX + 0xe8),
               *(int *)(in_ECX + 0x100),*(undefined4 *)(in_ECX + 0xe8),iVar6,uVar5);
  *(undefined4 *)(in_ECX + 0x108) = *(undefined4 *)((int)param_1 + 9);
  FUN_008ad130(*(undefined2 *)(in_ECX + 0xb2),0);
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008add00 : PUSH EBP
008add01 : MOV EBP,ESP
008add03 : PUSH -0x1
008add05 : PUSH 0xb44dc0
008add0a : MOV EAX,FS:[0x0]
008add10 : PUSH EAX
008add11 : SUB ESP,0x58
008add14 : MOV EAX,[0x00d66fa0]
008add19 : XOR EAX,EBP
008add1b : MOV dword ptr [EBP + -0x14],EAX
008add1e : PUSH EBX
008add1f : PUSH ESI
008add20 : PUSH EDI
008add21 : PUSH EAX
008add22 : LEA EAX,[EBP + -0xc]
008add25 : MOV FS:[0x0],EAX
008add2b : MOV EAX,dword ptr [EBP + 0x8]
008add2e : MOVZX EBX,word ptr [EAX]
008add31 : AND EBX,0x1fff
008add37 : MOV EDI,ECX
008add39 : SUB EBX,0xd
008add3c : CMP dword ptr [EAX + 0x5],0x0
008add40 : MOV dword ptr [EBP + -0x48],EDI
008add43 : MOV dword ptr [EBP + -0x4c],EAX
008add46 : LEA ESI,[EAX + 0xd]
008add49 : MOV dword ptr [EBP + -0x50],0x0
008add50 : JLE 0x008adea0
008add56 : TEST ESI,ESI
008add58 : JZ 0x008addad
008add5a : CMP EBX,0x8
008add5d : JC 0x008addad
008add5f : MOV EAX,dword ptr [ESI]
008add61 : MOV ECX,dword ptr [ESI + 0x4]
008add64 : SUB EBX,0x8
008add67 : ADD ESI,0x8
008add6a : MOV dword ptr [EBP + -0x5c],EAX
008add6d : MOV dword ptr [EBP + -0x58],ECX
008add70 : JZ 0x008addad
008add72 : CMP EBX,0x2
008add75 : JC 0x008addad
008add77 : MOVZX EAX,word ptr [ESI]
008add7a : TEST AX,AX
008add7d : JL 0x008addad
008add7f : CWDE
008add80 : LEA EDX,[EAX + 0x2]
008add83 : CMP EBX,EDX
008add85 : JL 0x008addad
008add87 : MOV ECX,0xfffffffe
008add8c : SUB ECX,EAX
008add8e : LEA EDX,[ESI + 0x2]
008add91 : LEA ESI,[ESI + EAX*0x1 + 0x2]
008add95 : ADD EBX,ECX
008add97 : TEST ESI,ESI
008add99 : JZ 0x008addaf
008add9b : CMP EBX,0x4
008add9e : JC 0x008addaf
008adda0 : MOV EAX,dword ptr [ESI]
008adda2 : SUB EBX,0x4
008adda5 : MOV dword ptr [EBP + -0x60],EAX
008adda8 : ADD ESI,0x4
008addab : JMP 0x008addb3
008addad : XOR EDX,EDX
008addaf : XOR EBX,EBX
008addb1 : XOR ESI,ESI
008addb3 : XOR ECX,ECX
008addb5 : MOV dword ptr [EBP + -0x24],0x7
008addbc : MOV dword ptr [EBP + -0x28],0x0
008addc3 : MOV word ptr [EBP + -0x38],CX
008addc7 : MOV dword ptr [EBP + -0x4],0x1
008addce : MOV EAX,dword ptr [EBP + -0x5c]
008addd1 : MOV ECX,dword ptr [EBP + -0x58]
008addd4 : MOV dword ptr [EBP + -0x44],EAX
008addd7 : MOV EAX,EDX
008addd9 : MOV dword ptr [EBP + -0x40],ECX
008adddc : LEA EDI,[EAX + 0x2]
008adddf : NOP
008adde0 : MOV CX,word ptr [EAX]
008adde3 : ADD EAX,0x2
008adde6 : TEST CX,CX
008adde9 : JNZ 0x008adde0
008addeb : SUB EAX,EDI
008added : SAR EAX,0x1
008addef : PUSH EAX
008addf0 : PUSH EDX
008addf1 : LEA ECX,[EBP + -0x3c]
008addf4 : CALL 0x00406360
008addf9 : MOV EAX,dword ptr [EBP + -0x48]
008addfc : CMP dword ptr [EAX + 0x104],0x0
008ade03 : MOV EDX,dword ptr [EBP + -0x60]
008ade06 : MOV dword ptr [EBP + -0x20],EDX
008ade09 : MOV byte ptr [EBP + -0x1c],0x0
008ade0d : JZ 0x008ade6c
008ade0f : LEA ECX,[EAX + 0xe8]
008ade15 : MOV EAX,dword ptr [ECX + 0x18]
008ade18 : MOV ECX,dword ptr [ECX]
008ade1a : TEST ECX,ECX
008ade1c : JZ 0x008ade22
008ade1e : MOV EDX,dword ptr [ECX]
008ade20 : JMP 0x008ade24
008ade22 : XOR EDX,EDX
008ade24 : CMP dword ptr [EDX + 0x14],EAX
008ade27 : JA 0x008ade36
008ade29 : TEST ECX,ECX
008ade2b : JZ 0x008ade31
008ade2d : MOV EDX,dword ptr [ECX]
008ade2f : JMP 0x008ade33
008ade31 : XOR EDX,EDX
008ade33 : SUB EAX,dword ptr [EDX + 0x14]
008ade36 : TEST ECX,ECX
008ade38 : JZ 0x008ade3e
008ade3a : MOV ECX,dword ptr [ECX]
008ade3c : JMP 0x008ade40
008ade3e : XOR ECX,ECX
008ade40 : MOV ECX,dword ptr [ECX + 0x10]
008ade43 : MOV EAX,dword ptr [ECX + EAX*0x4]
008ade46 : MOV EDX,dword ptr [EAX + 0x4]
008ade49 : CMP EDX,dword ptr [EBP + -0x40]
008ade4c : JG 0x008ade69
008ade4e : JL 0x008ade57
008ade50 : MOV EAX,dword ptr [EAX]
008ade52 : CMP EAX,dword ptr [EBP + -0x44]
008ade55 : JNC 0x008ade69
008ade57 : MOV EAX,dword ptr [EBP + -0x48]
008ade5a : LEA EDI,[EBP + -0x44]
008ade5d : ADD EAX,0xe8
008ade62 : CALL 0x004307c0
008ade67 : JMP 0x008ade7a
008ade69 : MOV EAX,dword ptr [EBP + -0x48]
008ade6c : LEA ECX,[EBP + -0x44]
008ade6f : PUSH ECX
008ade70 : ADD EAX,0xe8
008ade75 : CALL 0x00430840
008ade7a : MOV dword ptr [EBP + -0x4],0xffffffff
008ade81 : LEA EDX,[EBP + -0x44]
008ade84 : PUSH EDX
008ade85 : CALL 0x00401300
008ade8a : MOV EAX,dword ptr [EBP + -0x50]
008ade8d : MOV ECX,dword ptr [EBP + -0x4c]
008ade90 : INC EAX
008ade91 : CMP EAX,dword ptr [ECX + 0x5]
008ade94 : MOV dword ptr [EBP + -0x50],EAX
008ade97 : JL 0x008add56
008ade9d : MOV EDI,dword ptr [EBP + -0x48]
008adea0 : MOV EAX,dword ptr [EDI + 0x104]
008adea6 : ADD EAX,dword ptr [EDI + 0x100]
008adeac : MOV ESI,dword ptr [EDI + 0xe8]
008adeb2 : MOV EDX,dword ptr [EDI + 0x100]
008adeb8 : PUSH EAX
008adeb9 : PUSH ESI
008adeba : PUSH EDX
008adebb : MOV EBX,ESI
008adebd : MOV ECX,EAX
008adebf : PUSH EBX
008adec0 : SUB ECX,EDX
008adec2 : PUSH 0x8ab320
008adec7 : PUSH ECX
008adec8 : CALL 0x00430e60
008adecd : MOVZX ECX,word ptr [EDI + 0xb2]
008aded4 : MOV EDX,dword ptr [EBP + -0x4c]
008aded7 : MOV EAX,dword ptr [EDX + 0x9]
008adeda : ADD ESP,0x18
008adedd : PUSH 0x0
008adedf : PUSH ECX
008adee0 : MOV ECX,EDI
008adee2 : MOV dword ptr [EDI + 0x108],EAX
008adee8 : CALL 0x008ad130
008adeed : MOV ECX,dword ptr [EBP + -0xc]
008adef0 : MOV dword ptr FS:[0x0],ECX
008adef7 : POP ECX
008adef8 : POP EDI
008adef9 : POP ESI
008adefa : POP EBX
008adefb : MOV ECX,dword ptr [EBP + -0x14]
008adefe : XOR ECX,EBP
008adf00 : CALL 0x00633e6b
008adf05 : MOV ESP,EBP
008adf07 : POP EBP
008adf08 : RET 0x4

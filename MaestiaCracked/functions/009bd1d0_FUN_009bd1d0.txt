PROGRAM  : Maestia.exe
FUNCTION : FUN_009bd1d0
ENTRY    : 009bd1d0
BODY     : [[009bd1d0, 009bd37b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009bd1d0(int param_1,ushort *param_2)

{
  undefined1 *puVar1;
  short sVar2;
  int iVar3;
  short *psVar4;
  short *psVar5;
  undefined4 *puVar6;
  uint uVar7;
  int local_48;
  byte local_41;
  undefined4 local_40 [8];
  undefined1 local_20;
  undefined1 local_1f;
  undefined1 local_1e;
  undefined1 local_1d;
  uint local_1c;
  undefined4 local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b21b06;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  puVar6 = (undefined4 *)((int)param_2 + 5);
  uVar7 = (*param_2 & 0x1fff) - 5;
  FUN_0041dd10(local_40);
  local_8 = 0;
  FUN_0041e020(param_1 + 0x46c,&local_48,*(undefined4 *)(param_1 + 0x470),
               *(undefined4 *)(param_1 + 0x474));
  local_48 = 0;
  if ((char)param_2[2] != '\0') {
    do {
      if ((puVar6 == (undefined4 *)0x0) || (uVar7 < 4)) {
LAB_009bd2ef:
        psVar5 = (short *)0x0;
LAB_009bd2f1:
        uVar7 = 0;
        puVar6 = (undefined4 *)0x0;
      }
      else {
        local_40[0] = *puVar6;
        uVar7 = uVar7 - 4;
        if (((short *)(puVar6 + 1) == (short *)0x0) ||
           (((uVar7 < 2 || (sVar2 = *(short *)(puVar6 + 1), sVar2 < 0)) ||
            (iVar3 = (int)sVar2, (int)uVar7 < iVar3 + 2)))) goto LAB_009bd2ef;
        psVar5 = (short *)((int)puVar6 + 6);
        puVar1 = (undefined1 *)((int)puVar6 + iVar3 + 6);
        iVar3 = uVar7 + (-2 - iVar3);
        if ((puVar1 == (undefined1 *)0x0) || (iVar3 == 0)) goto LAB_009bd2f1;
        local_20 = *puVar1;
        if ((puVar1 + 1 == (undefined1 *)0x0) || (iVar3 == 1)) goto LAB_009bd2f1;
        local_1f = puVar1[1];
        if ((puVar1 + 2 == (byte *)0x0) || (iVar3 == 2)) goto LAB_009bd2f1;
        local_41 = puVar1[2];
        if (((undefined4 *)(puVar1 + 3) == (undefined4 *)0x0) || (iVar3 - 3U < 4))
        goto LAB_009bd2f1;
        local_18 = *(undefined4 *)(puVar1 + 3);
        if ((puVar1 + 7 == (undefined1 *)0x0) || (iVar3 == 7)) goto LAB_009bd2f1;
        local_1e = puVar1[7];
        uVar7 = iVar3 - 8;
        puVar6 = (undefined4 *)(puVar1 + 8);
      }
      local_1c = (uint)local_41;
      psVar4 = psVar5;
      do {
        sVar2 = *psVar4;
        psVar4 = psVar4 + 1;
      } while (sVar2 != 0);
      FUN_00406360(psVar5,(int)psVar4 - (int)(psVar5 + 1) >> 1);
      local_1d = 0;
      FUN_0041de10(local_40);
      local_48 = local_48 + 1;
    } while (local_48 < (int)(uint)(byte)param_2[2]);
  }
  FUN_009bd030(param_1);
  local_8 = 0xffffffff;
  FUN_004427d0(local_40);
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
009bd1d0 : PUSH EBP
009bd1d1 : MOV EBP,ESP
009bd1d3 : PUSH -0x1
009bd1d5 : PUSH 0xb21b06
009bd1da : MOV EAX,FS:[0x0]
009bd1e0 : PUSH EAX
009bd1e1 : SUB ESP,0x44
009bd1e4 : MOV EAX,[0x00d66fa0]
009bd1e9 : XOR EAX,EBP
009bd1eb : MOV dword ptr [EBP + -0x10],EAX
009bd1ee : PUSH EBX
009bd1ef : PUSH ESI
009bd1f0 : PUSH EDI
009bd1f1 : PUSH EAX
009bd1f2 : LEA EAX,[EBP + -0xc]
009bd1f5 : MOV FS:[0x0],EAX
009bd1fb : MOV EBX,dword ptr [EBP + 0xc]
009bd1fe : MOVZX EDI,word ptr [EBX]
009bd201 : MOV EAX,dword ptr [EBP + 0x8]
009bd204 : LEA ECX,[EBP + -0x3c]
009bd207 : AND EDI,0x1fff
009bd20d : PUSH ECX
009bd20e : MOV dword ptr [EBP + -0x48],EAX
009bd211 : MOV dword ptr [EBP + -0x4c],EBX
009bd214 : LEA ESI,[EBX + 0x5]
009bd217 : SUB EDI,0x5
009bd21a : CALL 0x0041dd10
009bd21f : MOV dword ptr [EBP + -0x4],0x0
009bd226 : MOV EDX,dword ptr [EBP + -0x48]
009bd229 : MOV EAX,dword ptr [EDX + 0x474]
009bd22f : MOV ECX,dword ptr [EDX + 0x470]
009bd235 : ADD EDX,0x46c
009bd23b : PUSH EAX
009bd23c : PUSH ECX
009bd23d : LEA EAX,[EBP + -0x44]
009bd240 : PUSH EAX
009bd241 : PUSH EDX
009bd242 : CALL 0x0041e020
009bd247 : CMP byte ptr [EBX + 0x4],0x0
009bd24b : MOV dword ptr [EBP + -0x44],0x0
009bd252 : JBE 0x009bd345
009bd258 : TEST ESI,ESI
009bd25a : JZ 0x009bd2ef
009bd260 : CMP EDI,0x4
009bd263 : JC 0x009bd2ef
009bd269 : MOV ECX,dword ptr [ESI]
009bd26b : SUB EDI,0x4
009bd26e : ADD ESI,0x4
009bd271 : MOV dword ptr [EBP + -0x3c],ECX
009bd274 : JZ 0x009bd2ef
009bd276 : CMP EDI,0x2
009bd279 : JC 0x009bd2ef
009bd27b : MOVZX EAX,word ptr [ESI]
009bd27e : TEST AX,AX
009bd281 : JL 0x009bd2ef
009bd283 : CWDE
009bd284 : LEA EDX,[EAX + 0x2]
009bd287 : CMP EDI,EDX
009bd289 : JL 0x009bd2ef
009bd28b : MOV ECX,0xfffffffe
009bd290 : SUB ECX,EAX
009bd292 : LEA EBX,[ESI + 0x2]
009bd295 : LEA ESI,[ESI + EAX*0x1 + 0x2]
009bd299 : ADD EDI,ECX
009bd29b : TEST ESI,ESI
009bd29d : JZ 0x009bd2f1
009bd29f : CMP EDI,0x1
009bd2a2 : JC 0x009bd2f1
009bd2a4 : MOV DL,byte ptr [ESI]
009bd2a6 : DEC EDI
009bd2a7 : ADD ESI,0x1
009bd2aa : MOV byte ptr [EBP + -0x1c],DL
009bd2ad : JZ 0x009bd2f1
009bd2af : CMP EDI,0x1
009bd2b2 : JC 0x009bd2f1
009bd2b4 : MOV AL,byte ptr [ESI]
009bd2b6 : DEC EDI
009bd2b7 : ADD ESI,0x1
009bd2ba : MOV byte ptr [EBP + -0x1b],AL
009bd2bd : JZ 0x009bd2f1
009bd2bf : CMP EDI,0x1
009bd2c2 : JC 0x009bd2f1
009bd2c4 : MOV CL,byte ptr [ESI]
009bd2c6 : DEC EDI
009bd2c7 : ADD ESI,0x1
009bd2ca : MOV byte ptr [EBP + -0x3d],CL
009bd2cd : JZ 0x009bd2f1
009bd2cf : CMP EDI,0x4
009bd2d2 : JC 0x009bd2f1
009bd2d4 : MOV EDX,dword ptr [ESI]
009bd2d6 : SUB EDI,0x4
009bd2d9 : ADD ESI,0x4
009bd2dc : MOV dword ptr [EBP + -0x14],EDX
009bd2df : JZ 0x009bd2f1
009bd2e1 : CMP EDI,0x1
009bd2e4 : JC 0x009bd2f1
009bd2e6 : MOV AL,byte ptr [ESI]
009bd2e8 : DEC EDI
009bd2e9 : MOV byte ptr [EBP + -0x1a],AL
009bd2ec : INC ESI
009bd2ed : JMP 0x009bd2f5
009bd2ef : XOR EBX,EBX
009bd2f1 : XOR EDI,EDI
009bd2f3 : XOR ESI,ESI
009bd2f5 : MOVZX ECX,byte ptr [EBP + -0x3d]
009bd2f9 : MOV EAX,EBX
009bd2fb : MOV dword ptr [EBP + -0x18],ECX
009bd2fe : LEA EDX,[EAX + 0x2]
009bd301 : MOV CX,word ptr [EAX]
009bd304 : ADD EAX,0x2
009bd307 : TEST CX,CX
009bd30a : JNZ 0x009bd301
009bd30c : SUB EAX,EDX
009bd30e : SAR EAX,0x1
009bd310 : PUSH EAX
009bd311 : PUSH EBX
009bd312 : LEA ECX,[EBP + -0x38]
009bd315 : CALL 0x00406360
009bd31a : MOV EAX,dword ptr [EBP + -0x48]
009bd31d : LEA EDX,[EBP + -0x3c]
009bd320 : PUSH EDX
009bd321 : ADD EAX,0x46c
009bd326 : MOV byte ptr [EBP + -0x19],0x0
009bd32a : CALL 0x0041de10
009bd32f : MOV ECX,dword ptr [EBP + -0x4c]
009bd332 : MOV EAX,dword ptr [EBP + -0x44]
009bd335 : MOVZX EDX,byte ptr [ECX + 0x4]
009bd339 : INC EAX
009bd33a : CMP EAX,EDX
009bd33c : MOV dword ptr [EBP + -0x44],EAX
009bd33f : JL 0x009bd258
009bd345 : MOV EAX,dword ptr [EBP + -0x48]
009bd348 : PUSH EAX
009bd349 : CALL 0x009bd030
009bd34e : MOV dword ptr [EBP + -0x4],0xffffffff
009bd355 : LEA ECX,[EBP + -0x3c]
009bd358 : PUSH ECX
009bd359 : CALL 0x004427d0
009bd35e : MOV ECX,dword ptr [EBP + -0xc]
009bd361 : MOV dword ptr FS:[0x0],ECX
009bd368 : POP ECX
009bd369 : POP EDI
009bd36a : POP ESI
009bd36b : POP EBX
009bd36c : MOV ECX,dword ptr [EBP + -0x10]
009bd36f : XOR ECX,EBP
009bd371 : CALL 0x00633e6b
009bd376 : MOV ESP,EBP
009bd378 : POP EBP
009bd379 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_0043e8e0
ENTRY    : 0043e8e0
BODY     : [[0043e8e0, 0043e982]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_0043e8e0(undefined4 *param_1,ushort *param_2)

{
  int in_EAX;
  undefined4 *puVar1;
  undefined4 *puVar2;
  bool bVar3;
  
  puVar2 = *(undefined4 **)(in_EAX + 4);
  bVar3 = true;
  if (*(char *)((int)puVar2[1] + 0xf) == '\0') {
    puVar1 = (undefined4 *)puVar2[1];
    do {
      puVar2 = puVar1;
      bVar3 = *param_2 < *(ushort *)(puVar2 + 3);
      if (bVar3) {
        puVar1 = (undefined4 *)*puVar2;
      }
      else {
        puVar1 = (undefined4 *)puVar2[2];
      }
    } while (*(char *)((int)puVar1 + 0xf) == '\0');
  }
  if (bVar3) {
    if (puVar2 == (undefined4 *)**(int **)(in_EAX + 4)) {
      bVar3 = true;
      goto LAB_0043e936;
    }
    FUN_0043e610();
  }
  if (*param_2 <= *(ushort *)(puVar2 + 3)) {
    *param_1 = puVar2;
    *(undefined1 *)(param_1 + 1) = 0;
    return param_1;
  }
LAB_0043e936:
  puVar2 = (undefined4 *)FUN_0043e730(&param_2,bVar3,param_2);
  *param_1 = *puVar2;
  *(undefined1 *)(param_1 + 1) = 1;
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
0043e8e0 : PUSH EBP
0043e8e1 : MOV EBP,ESP
0043e8e3 : PUSH ECX
0043e8e4 : PUSH EBX
0043e8e5 : MOV EBX,dword ptr [EBP + 0x8]
0043e8e8 : PUSH ESI
0043e8e9 : PUSH EDI
0043e8ea : MOV EDI,EAX
0043e8ec : MOV ESI,dword ptr [EDI + 0x4]
0043e8ef : MOV EAX,dword ptr [ESI + 0x4]
0043e8f2 : CMP byte ptr [EAX + 0xf],0x0
0043e8f6 : MOV CL,0x1
0043e8f8 : MOV byte ptr [EBP + -0x4],CL
0043e8fb : JNZ 0x0043e920
0043e8fd : MOV ECX,dword ptr [EBP + 0xc]
0043e900 : MOVZX EDX,word ptr [ECX]
0043e903 : CMP DX,word ptr [EAX + 0xc]
0043e907 : MOV ESI,EAX
0043e909 : SETC CL
0043e90c : MOV byte ptr [EBP + -0x4],CL
0043e90f : TEST CL,CL
0043e911 : JZ 0x0043e917
0043e913 : MOV EAX,dword ptr [EAX]
0043e915 : JMP 0x0043e91a
0043e917 : MOV EAX,dword ptr [EAX + 0x8]
0043e91a : CMP byte ptr [EAX + 0xf],0x0
0043e91e : JZ 0x0043e903
0043e920 : MOV EAX,ESI
0043e922 : MOV dword ptr [EBP + 0x8],EAX
0043e925 : TEST CL,CL
0043e927 : JZ 0x0043e95f
0043e929 : MOV EDX,dword ptr [EDI + 0x4]
0043e92c : CMP ESI,dword ptr [EDX]
0043e92e : JNZ 0x0043e954
0043e930 : MOV EAX,dword ptr [EBP + 0xc]
0043e933 : PUSH EAX
0043e934 : PUSH 0x1
0043e936 : LEA ECX,[EBP + 0xc]
0043e939 : PUSH ECX
0043e93a : MOV ECX,ESI
0043e93c : CALL 0x0043e730
0043e941 : MOV EDX,dword ptr [EAX]
0043e943 : MOV dword ptr [EBX],EDX
0043e945 : MOV byte ptr [EBX + 0x4],0x1
0043e949 : MOV EAX,EBX
0043e94b : POP EDI
0043e94c : POP ESI
0043e94d : POP EBX
0043e94e : MOV ESP,EBP
0043e950 : POP EBP
0043e951 : RET 0x8
0043e954 : LEA EDX,[EBP + 0x8]
0043e957 : CALL 0x0043e610
0043e95c : MOV EAX,dword ptr [EBP + 0x8]
0043e95f : MOV DX,word ptr [EAX + 0xc]
0043e963 : MOV ECX,dword ptr [EBP + 0xc]
0043e966 : CMP DX,word ptr [ECX]
0043e969 : JNC 0x0043e972
0043e96b : MOV EAX,dword ptr [EBP + -0x4]
0043e96e : PUSH ECX
0043e96f : PUSH EAX
0043e970 : JMP 0x0043e936
0043e972 : POP EDI
0043e973 : MOV dword ptr [EBX],EAX
0043e975 : POP ESI
0043e976 : MOV byte ptr [EBX + 0x4],0x0
0043e97a : MOV EAX,EBX
0043e97c : POP EBX
0043e97d : MOV ESP,EBP
0043e97f : POP EBP
0043e980 : RET 0x8

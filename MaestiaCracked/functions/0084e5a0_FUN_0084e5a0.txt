PROGRAM  : Maestia.exe
FUNCTION : FUN_0084e5a0
ENTRY    : 0084e5a0
BODY     : [[0084e5a0, 0084e72e]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0084e5a0(int *param_1)

{
  int iVar1;
  int *piVar2;
  int *piVar3;
  char cVar4;
  uint uVar5;
  int in_EDX;
  int local_1c0 [101];
  LPCRITICAL_SECTION local_2c;
  char *local_28;
  undefined4 local_24;
  int local_20;
  undefined4 local_1c;
  int *local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b37c27;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if (param_1 != (int *)0x0) {
    if (*(int *)(in_EDX + 0x58) == 0) {
      FUN_008018d0(L"[AvaPlayerPart::AttachMeshBasicNodeLOD] Add a mesh node does not exist can not create mesh item."
                   ,DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
    }
    else {
      cVar4 = FUN_00404010();
      if (cVar4 == '\0') {
        local_2c = (LPCRITICAL_SECTION)(in_EDX + 0x10);
        local_20 = 0;
        local_28 = ".\\Objects\\AvaPlayerParts.cpp";
        local_24 = 0x149;
        local_1c = 1;
        FUN_006ef1a0(&local_2c);
        local_8 = 0;
        *(undefined1 *)(*(int *)(in_EDX + 0x58) + 0x2a1) = 1;
        FUN_007d98f0(*(undefined4 *)(in_EDX + 0x58));
        param_1 = (int *)0x0;
        FUN_007d38e0(&param_1);
        if (param_1 != (int *)0x0) {
          local_18 = param_1;
          param_1 = local_1c0;
          do {
            piVar3 = param_1;
            iVar1 = *(int *)(in_EDX + 0xac);
            if (iVar1 == 0) {
              uVar5 = 0;
            }
            else {
              uVar5 = *(int *)(in_EDX + 0xb4) - iVar1 >> 2;
            }
            piVar2 = *(int **)(in_EDX + 0xb0);
            if ((uint)((int)piVar2 - iVar1 >> 2) < uVar5) {
              *piVar2 = *param_1;
              *(int **)(in_EDX + 0xb0) = piVar2 + 1;
            }
            else {
              FUN_0042fe80(in_EDX + 0xa8,piVar2,param_1);
            }
            iVar1 = *piVar3;
            if (iVar1 != 0) {
              *(undefined2 *)(iVar1 + 0x2dc) = *(undefined2 *)(in_EDX + 0x158);
            }
            param_1 = piVar3 + 1;
            local_18 = (int *)((int)local_18 + -1);
          } while (local_18 != (int *)0x0);
        }
        *(undefined1 *)(*(int *)(in_EDX + 0x58) + 0x2a1) = 0;
        local_8 = 0xffffffff;
        if (local_20 != 0) {
          LeaveCriticalSection(local_2c);
          local_20 = 0;
        }
        FUN_0084c220();
        ExceptionList = local_10;
        return;
      }
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
0084e5a0 : PUSH EBP
0084e5a1 : MOV EBP,ESP
0084e5a3 : PUSH -0x1
0084e5a5 : PUSH 0xb37c27
0084e5aa : MOV EAX,FS:[0x0]
0084e5b0 : PUSH EAX
0084e5b1 : SUB ESP,0x1b0
0084e5b7 : PUSH EBX
0084e5b8 : PUSH ESI
0084e5b9 : PUSH EDI
0084e5ba : MOV EAX,[0x00d66fa0]
0084e5bf : XOR EAX,EBP
0084e5c1 : PUSH EAX
0084e5c2 : LEA EAX,[EBP + -0xc]
0084e5c5 : MOV FS:[0x0],EAX
0084e5cb : MOV EDI,ECX
0084e5cd : MOV ESI,EDX
0084e5cf : CMP dword ptr [EBP + 0x8],0x0
0084e5d3 : JZ 0x0084e71b
0084e5d9 : CMP dword ptr [ESI + 0x58],0x0
0084e5dd : JZ 0x0084e708
0084e5e3 : LEA EAX,[EDI + 0x2c]
0084e5e6 : LEA ECX,[ESI + 0x60]
0084e5e9 : CALL 0x00404010
0084e5ee : TEST AL,AL
0084e5f0 : JNZ 0x0084e71b
0084e5f6 : LEA ECX,[EBP + -0x28]
0084e5f9 : LEA EAX,[ESI + 0x10]
0084e5fc : MOV EBX,0x1
0084e601 : PUSH ECX
0084e602 : MOV dword ptr [EBP + -0x1c],0x0
0084e609 : MOV dword ptr [EBP + -0x28],EAX
0084e60c : MOV dword ptr [EBP + -0x24],0xc3ca14
0084e613 : MOV dword ptr [EBP + -0x20],0x149
0084e61a : MOV dword ptr [EBP + -0x18],EBX
0084e61d : CALL 0x006ef1a0
0084e622 : MOV dword ptr [EBP + -0x4],0x0
0084e629 : MOV EAX,dword ptr [ESI + 0x58]
0084e62c : MOV byte ptr [EAX + 0x2a1],BL
0084e632 : MOV EDX,dword ptr [ESI + 0x58]
0084e635 : PUSH EDX
0084e636 : MOV ECX,EDI
0084e638 : CALL 0x007d98f0
0084e63d : MOV EDI,dword ptr [ESI + 0x58]
0084e640 : LEA EAX,[EBP + 0x8]
0084e643 : PUSH EAX
0084e644 : LEA EAX,[EBP + 0xfffffe44]
0084e64a : MOV dword ptr [EBP + 0x8],0x0
0084e651 : CALL 0x007d38e0
0084e656 : MOV EAX,dword ptr [EBP + 0x8]
0084e659 : TEST EAX,EAX
0084e65b : JBE 0x0084e6c7
0084e65d : LEA ECX,[EBP + 0xfffffe44]
0084e663 : LEA EDI,[ESI + 0xa8]
0084e669 : MOV dword ptr [EBP + 0x8],ECX
0084e66c : MOV dword ptr [EBP + -0x14],EAX
0084e66f : MOV EDX,dword ptr [EDI + 0x4]
0084e672 : TEST EDX,EDX
0084e674 : JNZ 0x0084e67a
0084e676 : XOR EAX,EAX
0084e678 : JMP 0x0084e682
0084e67a : MOV EAX,dword ptr [EDI + 0xc]
0084e67d : SUB EAX,EDX
0084e67f : SAR EAX,0x2
0084e682 : MOV ECX,dword ptr [EDI + 0x8]
0084e685 : MOV EBX,ECX
0084e687 : SUB EBX,EDX
0084e689 : SAR EBX,0x2
0084e68c : CMP EBX,EAX
0084e68e : MOV EBX,dword ptr [EBP + 0x8]
0084e691 : JNC 0x0084e69f
0084e693 : MOV EDX,dword ptr [EBX]
0084e695 : MOV dword ptr [ECX],EDX
0084e697 : ADD ECX,0x4
0084e69a : MOV dword ptr [EDI + 0x8],ECX
0084e69d : JMP 0x0084e6a7
0084e69f : PUSH EBX
0084e6a0 : PUSH ECX
0084e6a1 : PUSH EDI
0084e6a2 : CALL 0x0042fe80
0084e6a7 : MOV EAX,dword ptr [EBX]
0084e6a9 : TEST EAX,EAX
0084e6ab : JZ 0x0084e6bb
0084e6ad : MOVZX ECX,word ptr [ESI + 0x158]
0084e6b4 : MOV word ptr [EAX + 0x2dc],CX
0084e6bb : ADD EBX,0x4
0084e6be : SUB dword ptr [EBP + -0x14],0x1
0084e6c2 : MOV dword ptr [EBP + 0x8],EBX
0084e6c5 : JNZ 0x0084e66f
0084e6c7 : MOV EAX,dword ptr [ESI + 0x58]
0084e6ca : MOV byte ptr [EAX + 0x2a1],0x0
0084e6d1 : MOV dword ptr [EBP + -0x4],0xffffffff
0084e6d8 : CMP dword ptr [EBP + -0x1c],0x0
0084e6dc : JZ 0x0084e6ef
0084e6de : MOV EAX,dword ptr [EBP + -0x28]
0084e6e1 : PUSH EAX
0084e6e2 : CALL dword ptr [0x00b8511c]
0084e6e8 : MOV dword ptr [EBP + -0x1c],0x0
0084e6ef : CALL 0x0084c220
0084e6f4 : MOV ECX,dword ptr [EBP + -0xc]
0084e6f7 : MOV dword ptr FS:[0x0],ECX
0084e6fe : POP ECX
0084e6ff : POP EDI
0084e700 : POP ESI
0084e701 : POP EBX
0084e702 : MOV ESP,EBP
0084e704 : POP EBP
0084e705 : RET 0x4
0084e708 : MOV ESI,dword ptr [0x00da98e8]
0084e70e : PUSH 0xc3ca38
0084e713 : CALL 0x008018d0
0084e718 : ADD ESP,0x4
0084e71b : MOV ECX,dword ptr [EBP + -0xc]
0084e71e : MOV dword ptr FS:[0x0],ECX
0084e725 : POP ECX
0084e726 : POP EDI
0084e727 : POP ESI
0084e728 : POP EBX
0084e729 : MOV ESP,EBP
0084e72b : POP EBP
0084e72c : RET 0x4

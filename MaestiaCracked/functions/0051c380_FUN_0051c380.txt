PROGRAM  : Maestia.exe
FUNCTION : FUN_0051c380
ENTRY    : 0051c380
BODY     : [[0051c380, 0051c402]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0051c380(uint *param_1,uint param_2)

{
  uint *in_ECX;
  uint uVar1;
  uint uVar2;
  uint *puVar3;
  
  uVar1 = *param_1 & 3;
  puVar3 = (uint *)(*param_1 & 0xfffffffc);
  uVar2 = DAT_00d73250;
  if (uVar1 != 0) {
    if (uVar1 == 1) {
      uVar2 = FUN_00515dd0(param_1);
    }
    else {
      uVar2 = 0;
      if (uVar1 == 2) {
        uVar2 = param_1[1];
      }
    }
  }
  if (param_2 == 0) {
    param_2 = uVar2;
  }
  in_ECX[1] = param_2;
  if (uVar2 != param_2) {
    uVar2 = *puVar3 & 0x7fffffff;
    uVar2 = FUN_0051b700(param_2,uVar2,*puVar3 & 0x80000000,puVar3 + 2,uVar2);
    *in_ECX = uVar2 | 2;
    return;
  }
  InterlockedExchangeAdd((LONG *)(puVar3 + 1),1);
  *in_ECX = (uint)puVar3 | 2;
  return;
}



============================================================
DISASSEMBLY
============================================================
0051c380 : MOV EDX,dword ptr [ESP + 0x4]
0051c384 : PUSH ESI
0051c385 : PUSH EDI
0051c386 : MOV EDI,ECX
0051c388 : MOV ECX,dword ptr [EDX]
0051c38a : MOV ESI,ECX
0051c38c : XOR EAX,EAX
0051c38e : AND ECX,0x3
0051c391 : AND ESI,0xfffffffc
0051c394 : SUB ECX,EAX
0051c396 : JZ 0x0051c3af
0051c398 : SUB ECX,0x1
0051c39b : JZ 0x0051c3a7
0051c39d : SUB ECX,0x1
0051c3a0 : JNZ 0x0051c3b4
0051c3a2 : MOV EAX,dword ptr [EDX + 0x4]
0051c3a5 : JMP 0x0051c3b4
0051c3a7 : PUSH EDX
0051c3a8 : CALL 0x00515dd0
0051c3ad : JMP 0x0051c3b4
0051c3af : MOV EAX,[0x00d73250]
0051c3b4 : MOV EDX,dword ptr [ESP + 0x10]
0051c3b8 : TEST EDX,EDX
0051c3ba : JNZ 0x0051c3be
0051c3bc : MOV EDX,EAX
0051c3be : MOV dword ptr [EDI + 0x4],EDX
0051c3c1 : CMP EAX,EDX
0051c3c3 : JNZ 0x0051c3db
0051c3c5 : PUSH 0x1
0051c3c7 : LEA EAX,[ESI + 0x4]
0051c3ca : PUSH EAX
0051c3cb : CALL dword ptr [0x00b851cc]
0051c3d1 : OR ESI,0x2
0051c3d4 : MOV dword ptr [EDI],ESI
0051c3d6 : POP EDI
0051c3d7 : POP ESI
0051c3d8 : RET 0x8
0051c3db : MOV EAX,dword ptr [ESI]
0051c3dd : MOV ECX,EAX
0051c3df : AND ECX,0x7fffffff
0051c3e5 : PUSH ECX
0051c3e6 : ADD ESI,0x8
0051c3e9 : PUSH ESI
0051c3ea : AND EAX,0x80000000
0051c3ef : PUSH EAX
0051c3f0 : PUSH ECX
0051c3f1 : PUSH EDX
0051c3f2 : MOV ECX,EDI
0051c3f4 : CALL 0x0051b700
0051c3f9 : OR EAX,0x2
0051c3fc : MOV dword ptr [EDI],EAX
0051c3fe : POP EDI
0051c3ff : POP ESI
0051c400 : RET 0x8

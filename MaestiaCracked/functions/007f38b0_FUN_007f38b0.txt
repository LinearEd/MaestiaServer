PROGRAM  : Maestia.exe
FUNCTION : FUN_007f38b0
ENTRY    : 007f38b0
BODY     : [[007f38b0, 007f3c56]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007f38b0(void)

{
  bool bVar1;
  bool bVar2;
  DWORD DVar3;
  int in_ECX;
  int iVar4;
  float fVar5;
  float fVar6;
  double dVar7;
  float fVar8;
  float fVar9;
  float fVar10;
  float local_24;
  undefined4 local_14;
  float local_10;
  undefined4 local_c;
  
  if (*(char *)(in_ECX + 0x210) != '\0') {
    FUN_007f18d0();
    return;
  }
  if (*(char *)(in_ECX + 0x1e8) != '\0') {
    if (*(char *)(in_ECX + 0x1e9) != '\0') {
      FUN_007f1ec0();
      return;
    }
    D3DXMatrixLookAtLH(in_ECX + 0xb4,in_ECX + 0x24c,in_ECX + 600,in_ECX + 0x20);
    return;
  }
  if (*(char *)(in_ECX + 0x154) == '\0') {
    return;
  }
  local_14 = *(undefined4 *)(in_ECX + 0x170);
  local_10 = *(float *)(in_ECX + 0x174);
  local_c = *(undefined4 *)(in_ECX + 0x178);
  if (*(char *)(in_ECX + 0x158) != '\0') goto LAB_007f3bd9;
  if (*(int *)(in_ECX + 0x70) == 0) {
    DVar3 = GetTickCount();
    *(DWORD *)(in_ECX + 0x70) = DVar3;
  }
  local_24 = 1.5;
  DVar3 = GetTickCount();
  iVar4 = DVar3 - *(int *)(in_ECX + 0x70);
  *(DWORD *)(in_ECX + 0x70) = DVar3;
  if (iVar4 != 0) {
    fVar5 = (float)iVar4;
    if (iVar4 < 0) {
      fVar5 = fVar5 + 4.2949673e+09;
    }
    local_24 = fVar5 * 40.0 * 0.001 * 1.5;
  }
  fVar10 = 1.0;
  *(undefined4 *)(in_ECX + 0xec) = 0;
  *(undefined4 *)(in_ECX + 0xe8) = 0;
  *(undefined4 *)(in_ECX + 0xe4) = 0;
  *(undefined4 *)(in_ECX + 0xe0) = 0;
  *(undefined4 *)(in_ECX + 0xd8) = 0;
  *(undefined4 *)(in_ECX + 0xd4) = 0;
  *(undefined4 *)(in_ECX + 0xd0) = 0;
  *(undefined4 *)(in_ECX + 0xcc) = 0;
  *(undefined4 *)(in_ECX + 0xc4) = 0;
  *(undefined4 *)(in_ECX + 0xc0) = 0;
  *(undefined4 *)(in_ECX + 0xbc) = 0;
  *(undefined4 *)(in_ECX + 0xb8) = 0;
  *(undefined4 *)(in_ECX + 0xf0) = 0x3f800000;
  *(undefined4 *)(in_ECX + 0xdc) = 0x3f800000;
  *(undefined4 *)(in_ECX + 200) = 0x3f800000;
  *(undefined4 *)(in_ECX + 0xb4) = 0x3f800000;
  fVar5 = *(float *)(in_ECX + 0x20c);
  fVar8 = *(float *)(in_ECX + 0x1fc);
  if (fVar5 < fVar8) {
    *(float *)(in_ECX + 0x208) = fVar5;
  }
  FUN_007f1880(*(undefined4 *)(in_ECX + 0x1f8));
  fVar6 = *(float *)(in_ECX + 0x208);
  fVar5 = fVar5 * local_24;
  bVar1 = false;
  bVar2 = false;
  if (fVar6 <= fVar8) {
    if (fVar6 < fVar8) {
      fVar9 = fVar8 - fVar6;
      bVar1 = true;
      bVar2 = false;
      goto LAB_007f3a9d;
    }
  }
  else {
    fVar9 = fVar6 - fVar8;
    bVar1 = false;
    bVar2 = true;
LAB_007f3a9d:
    *(float *)(in_ECX + 0x204) = fVar9;
  }
  fVar9 = *(float *)(in_ECX + 0x204);
  if ((fVar9 <= fVar5) || (!bVar1)) {
    if ((fVar9 <= fVar5) || (!bVar2)) {
      *(float *)(in_ECX + 0x208) = fVar8;
    }
    else {
      *(float *)(in_ECX + 0x208) = fVar6 - fVar5;
      *(float *)(in_ECX + 0x204) = fVar9 - fVar5;
    }
  }
  else {
    fVar8 = fVar6 + fVar5;
    *(float *)(in_ECX + 0x208) = fVar8;
    *(float *)(in_ECX + 0x204) = fVar9 - fVar5;
  }
  local_10 = (fVar8 * 0.125 - fVar10) + local_10;
  fVar5 = *(float *)(in_ECX + 0x1ec);
  fVar8 = *(float *)(in_ECX + 0x208);
  dVar7 = (double)fVar5;
  FUN_0063ed62();
  fVar6 = (float)dVar7 * fVar8;
  fVar10 = *(float *)(in_ECX + 0x1f0);
  dVar7 = (double)fVar10;
  FUN_0063ed62();
  *(float *)(in_ECX + 0x164) = (float)dVar7 * fVar6 + *(float *)(in_ECX + 0x170);
  dVar7 = (double)fVar5;
  FUN_0063ef0d();
  *(float *)(in_ECX + 0x168) = (float)dVar7 * fVar8 + *(float *)(in_ECX + 0x174);
  dVar7 = (double)fVar10;
  FUN_0063ef0d();
  *(float *)(in_ECX + 0x16c) = (float)dVar7 * fVar6 + *(float *)(in_ECX + 0x178);
LAB_007f3bd9:
  *(float *)(in_ECX + 0x188) = *(float *)(in_ECX + 0x1a4) + *(float *)(in_ECX + 0x164);
  *(float *)(in_ECX + 0x18c) = *(float *)(in_ECX + 0x1a8) + *(float *)(in_ECX + 0x168);
  *(float *)(in_ECX + 400) = *(float *)(in_ECX + 0x1ac) + *(float *)(in_ECX + 0x16c);
  D3DXMatrixLookAtLH(in_ECX + 0xb4,(float *)(in_ECX + 0x188),&local_14,in_ECX + 0x20);
  *(undefined1 *)(in_ECX + 0x154) = 0;
  *(undefined1 *)(in_ECX + 0x156) = 1;
  if (*(char *)(in_ECX + 0x158) != '\0') {
    *(undefined1 *)(in_ECX + 0x158) = 0;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
007f38b0 : PUSH EBP
007f38b1 : MOV EBP,ESP
007f38b3 : AND ESP,0xfffffff8
007f38b6 : SUB ESP,0x20
007f38b9 : PUSH ESI
007f38ba : MOV ESI,ECX
007f38bc : CMP byte ptr [ESI + 0x210],0x0
007f38c3 : PUSH EDI
007f38c4 : JZ 0x007f38d3
007f38c6 : MOV EAX,ESI
007f38c8 : CALL 0x007f18d0
007f38cd : POP EDI
007f38ce : POP ESI
007f38cf : MOV ESP,EBP
007f38d1 : POP EBP
007f38d2 : RET
007f38d3 : CMP byte ptr [ESI + 0x1e8],0x0
007f38da : JZ 0x007f3914
007f38dc : CMP byte ptr [ESI + 0x1e9],0x0
007f38e3 : JZ 0x007f38f0
007f38e5 : CALL 0x007f1ec0
007f38ea : POP EDI
007f38eb : POP ESI
007f38ec : MOV ESP,EBP
007f38ee : POP EBP
007f38ef : RET
007f38f0 : LEA EAX,[ESI + 0x20]
007f38f3 : PUSH EAX
007f38f4 : LEA ECX,[ESI + 0x258]
007f38fa : PUSH ECX
007f38fb : LEA EDX,[ESI + 0x24c]
007f3901 : PUSH EDX
007f3902 : ADD ESI,0xb4
007f3908 : PUSH ESI
007f3909 : CALL 0x00664c78
007f390e : POP EDI
007f390f : POP ESI
007f3910 : MOV ESP,EBP
007f3912 : POP EBP
007f3913 : RET
007f3914 : CMP byte ptr [ESI + 0x154],0x0
007f391b : JZ 0x007f3c51
007f3921 : CMP byte ptr [ESI + 0x158],0x0
007f3928 : MOVSS XMM0,dword ptr [ESI + 0x170]
007f3930 : MOVSS dword ptr [ESP + 0x1c],XMM0
007f3936 : MOVSS XMM0,dword ptr [ESI + 0x174]
007f393e : MOVSS dword ptr [ESP + 0x20],XMM0
007f3944 : MOVSS XMM0,dword ptr [ESI + 0x178]
007f394c : MOVSS dword ptr [ESP + 0x24],XMM0
007f3952 : JNZ 0x007f3bd9
007f3958 : CMP dword ptr [ESI + 0x70],0x0
007f395c : MOV EDI,dword ptr [0x00b850d8]
007f3962 : JNZ 0x007f3969
007f3964 : CALL EDI
007f3966 : MOV dword ptr [ESI + 0x70],EAX
007f3969 : MOVSS XMM0,dword ptr [0x00cdf168]
007f3971 : MOVSS dword ptr [ESP + 0xc],XMM0
007f3977 : CALL EDI
007f3979 : MOV ECX,EAX
007f397b : SUB ECX,dword ptr [ESI + 0x70]
007f397e : MOV dword ptr [ESI + 0x70],EAX
007f3981 : JZ 0x007f39ab
007f3983 : MOV dword ptr [ESP + 0x18],ECX
007f3987 : FILD dword ptr [ESP + 0x18]
007f398b : TEST ECX,ECX
007f398d : JGE 0x007f3995
007f398f : FADD float ptr [0x00cdf0e0]
007f3995 : FMUL float ptr [0x00cdf238]
007f399b : FMUL float ptr [0x00cdf128]
007f39a1 : FMUL float ptr [0x00cdf168]
007f39a7 : FSTP float ptr [ESP + 0xc]
007f39ab : XORPS XMM0,XMM0
007f39ae : MOVSS XMM4,dword ptr [0x00c10fc4]
007f39b6 : MOVSS dword ptr [ESI + 0xec],XMM0
007f39be : MOVSS dword ptr [ESI + 0xe8],XMM0
007f39c6 : MOVSS dword ptr [ESI + 0xe4],XMM0
007f39ce : MOVSS dword ptr [ESI + 0xe0],XMM0
007f39d6 : MOVSS dword ptr [ESI + 0xd8],XMM0
007f39de : MOVSS dword ptr [ESI + 0xd4],XMM0
007f39e6 : MOVSS dword ptr [ESI + 0xd0],XMM0
007f39ee : MOVSS dword ptr [ESI + 0xcc],XMM0
007f39f6 : MOVSS dword ptr [ESI + 0xc4],XMM0
007f39fe : MOVSS dword ptr [ESI + 0xc0],XMM0
007f3a06 : MOVSS dword ptr [ESI + 0xbc],XMM0
007f3a0e : MOVSS dword ptr [ESI + 0xb8],XMM0
007f3a16 : MOVSS dword ptr [ESI + 0xf0],XMM4
007f3a1e : MOVSS dword ptr [ESI + 0xdc],XMM4
007f3a26 : MOVSS dword ptr [ESI + 0xc8],XMM4
007f3a2e : MOVSS dword ptr [ESI + 0xb4],XMM4
007f3a36 : MOVSS XMM0,dword ptr [ESI + 0x20c]
007f3a3e : MOVSS XMM3,dword ptr [ESI + 0x1fc]
007f3a46 : COMISS XMM3,XMM0
007f3a49 : JBE 0x007f3a53
007f3a4b : MOVSS dword ptr [ESI + 0x208],XMM0
007f3a53 : FLD float ptr [ESI + 0x1f8]
007f3a59 : MOVSS XMM1,dword ptr [ESI + 0x208]
007f3a61 : PUSH ECX
007f3a62 : FSTP float ptr [ESP]
007f3a65 : CALL 0x007f1880
007f3a6a : MOVSS XMM1,dword ptr [ESI + 0x208]
007f3a72 : MULSS XMM0,dword ptr [ESP + 0x10]
007f3a78 : ADD ESP,0x4
007f3a7b : XOR AL,AL
007f3a7d : XOR CL,CL
007f3a7f : COMISS XMM1,XMM3
007f3a82 : JBE 0x007f3a8f
007f3a84 : MOVAPS XMM2,XMM1
007f3a87 : SUBSS XMM2,XMM3
007f3a8b : MOV CL,0x1
007f3a8d : JMP 0x007f3a9d
007f3a8f : COMISS XMM3,XMM1
007f3a92 : JBE 0x007f3aa5
007f3a94 : MOVAPS XMM2,XMM3
007f3a97 : SUBSS XMM2,XMM1
007f3a9b : MOV AL,0x1
007f3a9d : MOVSS dword ptr [ESI + 0x204],XMM2
007f3aa5 : MOVSS XMM2,dword ptr [ESI + 0x204]
007f3aad : COMISS XMM2,XMM0
007f3ab0 : JBE 0x007f3ae8
007f3ab2 : TEST AL,AL
007f3ab4 : JZ 0x007f3ae8
007f3ab6 : ADDSS XMM1,XMM0
007f3aba : MOVSS dword ptr [ESI + 0x208],XMM1
007f3ac2 : MULSS XMM1,dword ptr [0x00cdf4d4]
007f3aca : SUBSS XMM1,XMM4
007f3ace : ADDSS XMM1,dword ptr [ESP + 0x20]
007f3ad4 : SUBSS XMM2,XMM0
007f3ad8 : MOVSS dword ptr [ESI + 0x204],XMM2
007f3ae0 : MOVSS dword ptr [ESP + 0x20],XMM1
007f3ae6 : JMP 0x007f3b2b
007f3ae8 : COMISS XMM2,XMM0
007f3aeb : JBE 0x007f3b0b
007f3aed : TEST CL,CL
007f3aef : JZ 0x007f3b0b
007f3af1 : SUBSS XMM1,XMM0
007f3af5 : SUBSS XMM2,XMM0
007f3af9 : MOVSS dword ptr [ESI + 0x208],XMM1
007f3b01 : MOVSS dword ptr [ESI + 0x204],XMM2
007f3b09 : JMP 0x007f3b13
007f3b0b : MOVSS dword ptr [ESI + 0x208],XMM3
007f3b13 : MULSS XMM3,dword ptr [0x00cdf4d4]
007f3b1b : SUBSS XMM3,XMM4
007f3b1f : ADDSS XMM3,dword ptr [ESP + 0x20]
007f3b25 : MOVSS dword ptr [ESP + 0x20],XMM3
007f3b2b : MOVSS XMM0,dword ptr [ESI + 0x1ec]
007f3b33 : MOVSS XMM1,dword ptr [ESI + 0x208]
007f3b3b : MOVSS dword ptr [ESP + 0x14],XMM0
007f3b41 : MOVSS dword ptr [ESP + 0xc],XMM1
007f3b47 : CVTPS2PD XMM0,XMM0
007f3b4a : CALL 0x0063ed62
007f3b4f : CVTSD2SS XMM0,XMM0
007f3b53 : MULSS XMM0,dword ptr [ESP + 0xc]
007f3b59 : MOVSS dword ptr [ESP + 0x10],XMM0
007f3b5f : MOVSS XMM0,dword ptr [ESI + 0x1f0]
007f3b67 : MOVSS dword ptr [ESP + 0x18],XMM0
007f3b6d : CVTPS2PD XMM0,XMM0
007f3b70 : CALL 0x0063ed62
007f3b75 : CVTSD2SS XMM0,XMM0
007f3b79 : MULSS XMM0,dword ptr [ESP + 0x10]
007f3b7f : ADDSS XMM0,dword ptr [ESI + 0x170]
007f3b87 : MOVSS dword ptr [ESI + 0x164],XMM0
007f3b8f : CVTSS2SD XMM0,dword ptr [ESP + 0x14]
007f3b95 : CALL 0x0063ef0d
007f3b9a : CVTSD2SS XMM0,XMM0
007f3b9e : MULSS XMM0,dword ptr [ESP + 0xc]
007f3ba4 : ADDSS XMM0,dword ptr [ESI + 0x174]
007f3bac : MOVSS dword ptr [ESI + 0x168],XMM0
007f3bb4 : CVTSS2SD XMM0,dword ptr [ESP + 0x18]
007f3bba : CALL 0x0063ef0d
007f3bbf : CVTSD2SS XMM0,XMM0
007f3bc3 : MULSS XMM0,dword ptr [ESP + 0x10]
007f3bc9 : ADDSS XMM0,dword ptr [ESI + 0x178]
007f3bd1 : MOVSS dword ptr [ESI + 0x16c],XMM0
007f3bd9 : MOVSS XMM0,dword ptr [ESI + 0x1a4]
007f3be1 : MOVSS XMM1,dword ptr [ESI + 0x1a8]
007f3be9 : MOVSS XMM2,dword ptr [ESI + 0x1ac]
007f3bf1 : ADDSS XMM0,dword ptr [ESI + 0x164]
007f3bf9 : ADDSS XMM1,dword ptr [ESI + 0x168]
007f3c01 : ADDSS XMM2,dword ptr [ESI + 0x16c]
007f3c09 : LEA ECX,[ESI + 0x20]
007f3c0c : PUSH ECX
007f3c0d : LEA EAX,[ESI + 0x188]
007f3c13 : LEA EDX,[ESP + 0x20]
007f3c17 : PUSH EDX
007f3c18 : PUSH EAX
007f3c19 : MOVSS dword ptr [EAX],XMM0
007f3c1d : MOVSS dword ptr [EAX + 0x4],XMM1
007f3c22 : MOVSS dword ptr [EAX + 0x8],XMM2
007f3c27 : LEA EAX,[ESI + 0xb4]
007f3c2d : PUSH EAX
007f3c2e : CALL 0x00664c78
007f3c33 : CMP byte ptr [ESI + 0x158],0x0
007f3c3a : MOV byte ptr [ESI + 0x154],0x0
007f3c41 : MOV byte ptr [ESI + 0x156],0x1
007f3c48 : JZ 0x007f3c51
007f3c4a : MOV byte ptr [ESI + 0x158],0x0
007f3c51 : POP EDI
007f3c52 : POP ESI
007f3c53 : MOV ESP,EBP
007f3c55 : POP EBP
007f3c56 : RET

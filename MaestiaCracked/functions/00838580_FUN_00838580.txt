PROGRAM  : Maestia.exe
FUNCTION : FUN_00838580
ENTRY    : 00838580
BODY     : [[00838580, 008387fc] [00838800, 008388c2]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x008387aa) */

void FUN_00838580(int param_1)

{
  undefined4 *puVar1;
  uint *puVar2;
  uint uVar3;
  uint *puVar4;
  int iVar5;
  uint uVar6;
  undefined4 uVar7;
  undefined4 *puVar8;
  int in_ECX;
  uint uVar9;
  int iVar10;
  uint uVar11;
  uint *puVar12;
  int iVar13;
  undefined1 local_74 [4];
  undefined2 local_70;
  undefined4 local_60;
  uint local_5c;
  undefined1 local_58 [4];
  undefined2 local_54;
  undefined4 local_44;
  uint local_40;
  int local_3c;
  int local_38;
  char local_31;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  puStack_c = &LAB_00b3d987;
  local_10 = ExceptionList;
  uVar6 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  uVar9 = 0;
  local_38 = param_1;
  local_31 = '\0';
  local_18 = 7;
  local_1c = 0;
  local_2c = 0;
  local_8 = 0;
  uVar11 = 0;
  local_14 = uVar6;
  if (*(int *)(in_ECX + 0x14) != 0) {
    puVar1 = (undefined4 *)(in_ECX + 4);
    do {
      uVar3 = *(uint *)(in_ECX + 0x18);
      if (local_31 == '\0') {
        puVar8 = puVar1;
        if (7 < uVar3) {
          puVar8 = (undefined4 *)*puVar1;
        }
        if (*(short *)((int)puVar8 + uVar11 * 2) == 0x22) {
LAB_00838727:
          local_31 = '\x01';
        }
        else {
          puVar8 = puVar1;
          if (7 < uVar3) {
            puVar8 = (undefined4 *)*puVar1;
          }
          if (*(short *)((int)puVar8 + uVar11 * 2) == 0x27) goto LAB_00838727;
          puVar8 = puVar1;
          if (7 < uVar3) {
            puVar8 = (undefined4 *)*puVar1;
          }
          if (*(short *)((int)puVar8 + uVar11 * 2) != 0x20) {
            puVar8 = puVar1;
            if (7 < uVar3) {
              puVar8 = (undefined4 *)*puVar1;
            }
            if (*(short *)((int)puVar8 + uVar11 * 2) != 0x2c) {
              puVar8 = puVar1;
              if (7 < uVar3) {
                puVar8 = (undefined4 *)*puVar1;
              }
              if (*(short *)((int)puVar8 + uVar11 * 2) != 9) goto LAB_0083872e;
            }
          }
          if (uVar9 != uVar11) {
            uVar7 = FUN_0040e420(in_ECX,local_58);
            local_8._0_1_ = 2;
            FUN_00405eb0(uVar7,0,0xffffffff);
            local_8 = (uint)local_8._1_3_ << 8;
            if (7 < local_40) {
                    /* WARNING: Subroutine does not return */
              FUN_006f04e0();
            }
            local_40 = 7;
            local_44 = 0;
            local_54 = 0;
            FUN_00405ae0(local_30);
          }
        }
LAB_0083872b:
        uVar9 = uVar11 + 1;
      }
      else {
        puVar8 = puVar1;
        if (7 < uVar3) {
          puVar8 = (undefined4 *)*puVar1;
        }
        if (*(short *)((int)puVar8 + uVar11 * 2) == 0x22) {
LAB_00838610:
          if (uVar9 != uVar11) {
            uVar7 = FUN_0040e420(in_ECX,local_74);
            local_8._0_1_ = 1;
            FUN_00405eb0(uVar7,0,0xffffffff);
            local_8 = (uint)local_8._1_3_ << 8;
            if (7 < local_5c) {
                    /* WARNING: Subroutine does not return */
              FUN_006f04e0();
            }
            local_5c = 7;
            local_60 = 0;
            local_70 = 0;
            FUN_00405ae0(local_30);
          }
          local_31 = '\0';
          goto LAB_0083872b;
        }
        puVar8 = puVar1;
        if (7 < uVar3) {
          puVar8 = (undefined4 *)*puVar1;
        }
        if (*(short *)((int)puVar8 + uVar11 * 2) == 0x27) goto LAB_00838610;
      }
LAB_0083872e:
      uVar11 = uVar11 + 1;
    } while (uVar11 < *(uint *)(in_ECX + 0x14));
    if (uVar9 != uVar11) {
      uVar7 = FUN_0040e420(in_ECX,local_58);
      local_8._0_1_ = 3;
      FUN_00405eb0(uVar7,0,0xffffffff);
      local_8 = (uint)local_8._1_3_ << 8;
      if (7 < local_40) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_40 = 7;
      local_44 = 0;
      local_54 = 0;
      FUN_00405ae0(local_30);
    }
  }
  iVar10 = *(int *)(local_38 + 4);
  local_3c = iVar10;
  if (iVar10 != *(int *)(local_38 + 8)) {
    do {
      if (*(int *)(iVar10 + 0x14) == 0) {
        iVar13 = *(int *)(local_38 + 8);
        iVar5 = iVar10;
        while (iVar5 = iVar5 + 0x1c, iVar5 != iVar13) {
          FUN_00405eb0(iVar5,0,0xffffffff);
          iVar10 = local_3c;
        }
        puVar4 = *(uint **)(local_38 + 8);
        if (puVar4 + -7 != puVar4) {
          puVar12 = puVar4 + -1;
          do {
            if (7 < *puVar12) {
                    /* WARNING: Subroutine does not return */
              FUN_006f04e0();
            }
            *puVar12 = 7;
            puVar12[-1] = 0;
            *(undefined2 *)(puVar12 + -5) = 0;
            puVar2 = puVar12 + 1;
            puVar12 = puVar12 + 7;
          } while (puVar2 != puVar4);
        }
        *(int *)(local_38 + 8) = *(int *)(local_38 + 8) + -0x1c;
      }
      else {
        iVar10 = iVar10 + 0x1c;
        local_3c = iVar10;
      }
    } while (iVar10 != *(int *)(local_38 + 8));
  }
  iVar13 = *(int *)(local_38 + 8) - *(int *)(local_38 + 4);
  iVar10 = iVar13 >> 0x1f;
  if (iVar13 / 0x1c + iVar10 != iVar10) {
    FUN_0070c170(uVar6);
  }
  local_8 = 0xffffffff;
  if (local_18 < 8) {
    local_18 = 7;
    local_1c = 0;
    local_2c = 0;
    ExceptionList = local_10;
    __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
    return;
  }
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
00838580 : PUSH EBP
00838581 : MOV EBP,ESP
00838583 : PUSH -0x1
00838585 : PUSH 0xb3d987
0083858a : MOV EAX,FS:[0x0]
00838590 : PUSH EAX
00838591 : SUB ESP,0x68
00838594 : MOV EAX,[0x00d66fa0]
00838599 : XOR EAX,EBP
0083859b : MOV dword ptr [EBP + -0x10],EAX
0083859e : PUSH EBX
0083859f : PUSH ESI
008385a0 : PUSH EDI
008385a1 : PUSH EAX
008385a2 : LEA EAX,[EBP + -0xc]
008385a5 : MOV FS:[0x0],EAX
008385ab : MOV EAX,dword ptr [EBP + 0x8]
008385ae : MOV EDI,ECX
008385b0 : XOR EDX,EDX
008385b2 : XOR ECX,ECX
008385b4 : MOV dword ptr [EBP + -0x34],EAX
008385b7 : MOV byte ptr [EBP + -0x2d],DL
008385ba : MOV dword ptr [EBP + -0x14],0x7
008385c1 : MOV dword ptr [EBP + -0x18],EDX
008385c4 : MOV word ptr [EBP + -0x28],CX
008385c8 : MOV dword ptr [EBP + -0x4],EDX
008385cb : MOV EAX,dword ptr [EDI + 0x14]
008385ce : XOR ESI,ESI
008385d0 : CMP EAX,EDX
008385d2 : JBE 0x0083878d
008385d8 : LEA EBX,[EDI + 0x4]
008385db : CMP byte ptr [EBP + -0x2d],0x0
008385df : MOV ECX,dword ptr [EDI + 0x18]
008385e2 : JZ 0x0083866e
008385e8 : CMP ECX,0x8
008385eb : JC 0x008385f1
008385ed : MOV EAX,dword ptr [EBX]
008385ef : JMP 0x008385f3
008385f1 : MOV EAX,EBX
008385f3 : CMP word ptr [EAX + ESI*0x2],0x22
008385f8 : JZ 0x00838610
008385fa : CMP ECX,0x8
008385fd : JC 0x00838603
008385ff : MOV EAX,dword ptr [EBX]
00838601 : JMP 0x00838605
00838603 : MOV EAX,EBX
00838605 : CMP word ptr [EAX + ESI*0x2],0x27
0083860a : JNZ 0x0083872e
00838610 : CMP EDX,ESI
00838612 : JZ 0x00838665
00838614 : LEA EAX,[EBP + -0x70]
00838617 : PUSH EAX
00838618 : MOV ECX,ESI
0083861a : SUB ECX,EDX
0083861c : PUSH EDI
0083861d : CALL 0x0040e420
00838622 : MOV byte ptr [EBP + -0x4],0x1
00838626 : PUSH -0x1
00838628 : PUSH 0x0
0083862a : PUSH EAX
0083862b : LEA ECX,[EBP + -0x2c]
0083862e : CALL 0x00405eb0
00838633 : MOV byte ptr [EBP + -0x4],0x0
00838637 : CMP dword ptr [EBP + -0x58],0x8
0083863b : JC 0x00838645
0083863d : MOV ECX,dword ptr [EBP + -0x6c]
00838640 : CALL 0x006f04e0
00838645 : MOV EAX,dword ptr [EBP + -0x34]
00838648 : LEA EDX,[EBP + -0x2c]
0083864b : XOR ECX,ECX
0083864d : PUSH EDX
0083864e : MOV dword ptr [EBP + -0x58],0x7
00838655 : MOV dword ptr [EBP + -0x5c],0x0
0083865c : MOV word ptr [EBP + -0x6c],CX
00838660 : CALL 0x00405ae0
00838665 : MOV byte ptr [EBP + -0x2d],0x0
00838669 : JMP 0x0083872b
0083866e : CMP ECX,0x8
00838671 : JC 0x00838677
00838673 : MOV EAX,dword ptr [EBX]
00838675 : JMP 0x00838679
00838677 : MOV EAX,EBX
00838679 : CMP word ptr [EAX + ESI*0x2],0x22
0083867e : JZ 0x00838727
00838684 : CMP ECX,0x8
00838687 : JC 0x0083868d
00838689 : MOV EAX,dword ptr [EBX]
0083868b : JMP 0x0083868f
0083868d : MOV EAX,EBX
0083868f : CMP word ptr [EAX + ESI*0x2],0x27
00838694 : JZ 0x00838727
0083869a : CMP ECX,0x8
0083869d : JC 0x008386a3
0083869f : MOV EAX,dword ptr [EBX]
008386a1 : JMP 0x008386a5
008386a3 : MOV EAX,EBX
008386a5 : CMP word ptr [EAX + ESI*0x2],0x20
008386aa : JZ 0x008386d0
008386ac : CMP ECX,0x8
008386af : JC 0x008386b5
008386b1 : MOV EAX,dword ptr [EBX]
008386b3 : JMP 0x008386b7
008386b5 : MOV EAX,EBX
008386b7 : CMP word ptr [EAX + ESI*0x2],0x2c
008386bc : JZ 0x008386d0
008386be : CMP ECX,0x8
008386c1 : JC 0x008386c7
008386c3 : MOV EAX,dword ptr [EBX]
008386c5 : JMP 0x008386c9
008386c7 : MOV EAX,EBX
008386c9 : CMP word ptr [EAX + ESI*0x2],0x9
008386ce : JNZ 0x0083872e
008386d0 : CMP EDX,ESI
008386d2 : JZ 0x0083872b
008386d4 : LEA EAX,[EBP + -0x54]
008386d7 : PUSH EAX
008386d8 : MOV ECX,ESI
008386da : SUB ECX,EDX
008386dc : PUSH EDI
008386dd : CALL 0x0040e420
008386e2 : MOV byte ptr [EBP + -0x4],0x2
008386e6 : PUSH -0x1
008386e8 : PUSH 0x0
008386ea : PUSH EAX
008386eb : LEA ECX,[EBP + -0x2c]
008386ee : CALL 0x00405eb0
008386f3 : MOV byte ptr [EBP + -0x4],0x0
008386f7 : CMP dword ptr [EBP + -0x3c],0x8
008386fb : JC 0x00838705
008386fd : MOV ECX,dword ptr [EBP + -0x50]
00838700 : CALL 0x006f04e0
00838705 : MOV EAX,dword ptr [EBP + -0x34]
00838708 : LEA EDX,[EBP + -0x2c]
0083870b : XOR ECX,ECX
0083870d : PUSH EDX
0083870e : MOV dword ptr [EBP + -0x3c],0x7
00838715 : MOV dword ptr [EBP + -0x40],0x0
0083871c : MOV word ptr [EBP + -0x50],CX
00838720 : CALL 0x00405ae0
00838725 : JMP 0x0083872b
00838727 : MOV byte ptr [EBP + -0x2d],0x1
0083872b : LEA EDX,[ESI + 0x1]
0083872e : INC ESI
0083872f : CMP ESI,dword ptr [EDI + 0x14]
00838732 : JC 0x008385db
00838738 : CMP EDX,ESI
0083873a : JZ 0x0083878d
0083873c : LEA EAX,[EBP + -0x54]
0083873f : PUSH EAX
00838740 : MOV ECX,ESI
00838742 : SUB ECX,EDX
00838744 : PUSH EDI
00838745 : CALL 0x0040e420
0083874a : MOV byte ptr [EBP + -0x4],0x3
0083874e : PUSH -0x1
00838750 : PUSH 0x0
00838752 : PUSH EAX
00838753 : LEA ECX,[EBP + -0x2c]
00838756 : CALL 0x00405eb0
0083875b : MOV byte ptr [EBP + -0x4],0x0
0083875f : CMP dword ptr [EBP + -0x3c],0x8
00838763 : JC 0x0083876d
00838765 : MOV ECX,dword ptr [EBP + -0x50]
00838768 : CALL 0x006f04e0
0083876d : MOV EAX,dword ptr [EBP + -0x34]
00838770 : LEA EDX,[EBP + -0x2c]
00838773 : XOR ECX,ECX
00838775 : PUSH EDX
00838776 : MOV dword ptr [EBP + -0x3c],0x7
0083877d : MOV dword ptr [EBP + -0x40],0x0
00838784 : MOV word ptr [EBP + -0x50],CX
00838788 : CALL 0x00405ae0
0083878d : MOV EAX,dword ptr [EBP + -0x34]
00838790 : MOV EDX,dword ptr [EAX + 0x4]
00838793 : MOV dword ptr [EBP + -0x38],EDX
00838796 : CMP EDX,dword ptr [EAX + 0x8]
00838799 : JZ 0x00838832
0083879f : NOP
008387a0 : MOV EAX,dword ptr [EDX + 0x14]
008387a3 : MOV EBX,dword ptr [EBP + -0x34]
008387a6 : MOV ECX,EAX
008387a8 : CMP ECX,EAX
008387aa : CMOVC EAX,ECX
008387ad : XOR ECX,ECX
008387af : TEST EAX,EAX
008387b1 : SETNZ CL
008387b4 : MOV EAX,ECX
008387b6 : TEST EAX,EAX
008387b8 : JNZ 0x00838823
008387ba : MOV EDI,dword ptr [EBX + 0x8]
008387bd : LEA ESI,[EDX + 0x1c]
008387c0 : CMP ESI,EDI
008387c2 : JZ 0x008387e2
008387c4 : MOV EBX,EDX
008387c6 : SUB EBX,ESI
008387c8 : PUSH -0x1
008387ca : PUSH 0x0
008387cc : PUSH ESI
008387cd : LEA ECX,[ESI + EBX*0x1]
008387d0 : CALL 0x00405eb0
008387d5 : ADD ESI,0x1c
008387d8 : CMP ESI,EDI
008387da : JNZ 0x008387c8
008387dc : MOV EDX,dword ptr [EBP + -0x38]
008387df : MOV EBX,dword ptr [EBP + -0x34]
008387e2 : MOV EDI,dword ptr [EBX + 0x8]
008387e5 : LEA ESI,[EDI + -0x1c]
008387e8 : CMP ESI,EDI
008387ea : JZ 0x0083881d
008387ec : ADD ESI,0x18
008387ef : NOP
008387f0 : CMP dword ptr [ESI],0x8
008387f3 : JC 0x00838800
008387f5 : MOV ECX,dword ptr [ESI + -0x14]
008387f8 : CALL 0x006f04e0
00838800 : XOR EAX,EAX
00838802 : MOV dword ptr [ESI],0x7
00838808 : MOV dword ptr [ESI + -0x4],0x0
0083880f : MOV word ptr [ESI + -0x14],AX
00838813 : ADD ESI,0x1c
00838816 : LEA ECX,[ESI + -0x18]
00838819 : CMP ECX,EDI
0083881b : JNZ 0x008387f0
0083881d : ADD dword ptr [EBX + 0x8],-0x1c
00838821 : JMP 0x00838829
00838823 : ADD EDX,0x1c
00838826 : MOV dword ptr [EBP + -0x38],EDX
00838829 : CMP EDX,dword ptr [EBX + 0x8]
0083882c : JNZ 0x008387a0
00838832 : MOV EDX,dword ptr [EBP + -0x34]
00838835 : MOV ECX,dword ptr [EDX + 0x4]
00838838 : MOV EDI,EDX
0083883a : MOV ESI,dword ptr [EDI + 0x8]
0083883d : SUB ESI,ECX
0083883f : MOV EAX,0x92492493
00838844 : IMUL ESI
00838846 : ADD EDX,ESI
00838848 : SAR EDX,0x4
0083884b : MOV EAX,EDX
0083884d : SHR EAX,0x1f
00838850 : ADD EAX,EDX
00838852 : JZ 0x00838859
00838854 : CALL 0x0070c170
00838859 : MOV ECX,dword ptr [EDI + 0x8]
0083885c : SUB ECX,dword ptr [EDI + 0x4]
0083885f : MOV EAX,0x92492493
00838864 : IMUL ECX
00838866 : ADD EDX,ECX
00838868 : SAR EDX,0x4
0083886b : MOV ECX,EDX
0083886d : SHR ECX,0x1f
00838870 : ADD ECX,EDX
00838872 : MOV ESI,ECX
00838874 : NEG ESI
00838876 : SBB ESI,ESI
00838878 : NEG ESI
0083887a : MOV dword ptr [EBP + -0x4],0xffffffff
00838881 : CMP dword ptr [EBP + -0x14],0x8
00838885 : JC 0x0083888f
00838887 : MOV ECX,dword ptr [EBP + -0x28]
0083888a : CALL 0x006f04e0
0083888f : XOR EDX,EDX
00838891 : MOV dword ptr [EBP + -0x14],0x7
00838898 : MOV dword ptr [EBP + -0x18],0x0
0083889f : MOV word ptr [EBP + -0x28],DX
008388a3 : MOV EAX,ESI
008388a5 : MOV ECX,dword ptr [EBP + -0xc]
008388a8 : MOV dword ptr FS:[0x0],ECX
008388af : POP ECX
008388b0 : POP EDI
008388b1 : POP ESI
008388b2 : POP EBX
008388b3 : MOV ECX,dword ptr [EBP + -0x10]
008388b6 : XOR ECX,EBP
008388b8 : CALL 0x00633e6b
008388bd : MOV ESP,EBP
008388bf : POP EBP
008388c0 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_0054dee0
ENTRY    : 0054dee0
BODY     : [[0054dee0, 0054e0e9] [0054e0f0, 0054e151]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0054dee0(float param_1,float param_2,float param_3)

{
  float fVar1;
  float fVar2;
  undefined2 uVar3;
  int *piVar4;
  bool bVar5;
  uint uVar6;
  float fVar7;
  byte bVar8;
  char cVar9;
  ushort uVar10;
  float *pfVar11;
  uint uVar12;
  int iVar13;
  uint uVar14;
  int iVar15;
  int in_ECX;
  undefined2 *puVar16;
  uint uVar17;
  float10 fVar18;
  undefined8 uVar19;
  int *local_8;
  int local_4;
  
  if (((uint)param_3 & 1) != 0) {
    pfVar11 = (float *)FUN_0054ad50();
    param_3 = param_1 - *pfVar11;
    fVar18 = (float10)FUN_0063bc90((double)param_3);
    fVar1 = (float)fVar18;
    param_3 = param_2 - pfVar11[1];
    fVar18 = (float10)FUN_0063bc90((double)param_3);
    fVar2 = (float)fVar18;
    param_3 = fVar2;
    uVar19 = FUN_005aa2b0();
    uVar12 = __aulldiv(uVar19,1000,0);
    fVar7 = param_3;
    bVar5 = false;
    param_3 = (float)((uint)param_3 & 0xffffff00);
    if (((fVar1 == *(float *)(in_ECX + 0x4c)) && (fVar2 == *(float *)(in_ECX + 0x50))) &&
       (uVar12 <= *(int *)(in_ECX + 0x54) + 300U)) {
      uVar10 = *(ushort *)(in_ECX + 0x68);
      if ((uVar10 >> 9 & 1) == 0) {
        bVar5 = true;
        *(ushort *)(in_ECX + 0x68) = uVar10 | 0x200;
      }
      else {
        param_3 = (float)CONCAT31(SUB43(fVar7,1),1);
        *(ushort *)(in_ECX + 0x68) = uVar10 | 0x200;
      }
    }
    else {
      *(ushort *)(in_ECX + 0x68) = *(ushort *)(in_ECX + 0x68) & 0xfdff;
    }
    *(float *)(in_ECX + 0x4c) = fVar1;
    *(uint *)(in_ECX + 0x54) = uVar12;
    *(float *)(in_ECX + 0x50) = fVar2;
    iVar13 = FUN_0054af90(fVar1,fVar2);
    if (iVar13 != -1) {
      FUN_0054d5a0(iVar13,*(byte *)(in_ECX + 0x68) >> 1 & 1);
      bVar8 = (byte)*(ushort *)(in_ECX + 0x68);
      if (((bVar8 >> 1 & 1) != 0) && ((bVar8 >> 5 & 1) == 0)) {
        uVar10 = *(ushort *)(in_ECX + 0x68) | 0x20;
        *(ushort *)(in_ECX + 0x68) = uVar10;
        if ((bVar5) || (param_3._0_1_ != '\0')) {
          FUN_0053c2d0(&local_8,iVar13,&param_3);
          cVar9 = FUN_0053b530();
          if (cVar9 == '\0') {
            piVar4 = *(int **)(*local_8 + local_4 * 4);
            uVar14 = FUN_0053b4b0();
            uVar12 = (uint)param_3;
            if (bVar5) {
              iVar13 = *piVar4;
              uVar6 = (uint)param_3;
              uVar17 = (uint)param_3;
              if (param_3 != 0.0) {
                puVar16 = (undefined2 *)(iVar13 + -2 + (int)param_3 * 2);
                do {
                  iVar15 = FUN_005126c0(*puVar16);
                  uVar6 = (uint)param_3;
                  if ((iVar15 != 0) ||
                     (iVar15 = FUN_0053b2a0(*puVar16), uVar6 = (uint)param_3, iVar15 == 0)) break;
                  uVar17 = uVar17 - 1;
                  puVar16 = puVar16 + -1;
                } while (uVar17 != 0);
              }
              do {
                if (uVar14 <= uVar6) goto LAB_0054e11f;
                uVar3 = *(undefined2 *)(iVar13 + uVar12 * 2);
                iVar15 = FUN_005126c0(uVar3);
                if ((iVar15 != 0) || (iVar15 = FUN_0053b2a0(uVar3), iVar15 == 0)) goto LAB_0054e11f;
                uVar12 = uVar12 + 1;
                uVar6 = uVar12;
              } while( true );
            }
            uVar17 = 0;
            uVar12 = uVar14;
LAB_0054e11f:
            iVar13 = piVar4[7];
            iVar15 = uVar12 + iVar13;
            FUN_0054d5a0(iVar15,*(byte *)(in_ECX + 0x68) >> 1 & 1);
            FUN_00546be0(iVar13 + uVar17,iVar15);
          }
        }
        else if (((byte)uVar10 >> 6 & 1) == 0) {
          FUN_00546be0(iVar13,iVar13);
          return;
        }
      }
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
0054dee0 : SUB ESP,0xc
0054dee3 : TEST byte ptr [ESP + 0x18],0x1
0054dee8 : PUSH ESI
0054dee9 : MOV ESI,ECX
0054deeb : JZ 0x0054e14b
0054def1 : MOV ECX,dword ptr [ESI + 0x8]
0054def4 : PUSH EBX
0054def5 : PUSH EDI
0054def6 : CALL 0x0054ad50
0054defb : FLD float ptr [ESP + 0x1c]
0054deff : MOV EDI,EAX
0054df01 : FSUB float ptr [EDI]
0054df03 : SUB ESP,0x8
0054df06 : FSTP float ptr [ESP + 0x2c]
0054df0a : FLD float ptr [ESP + 0x2c]
0054df0e : FSTP double ptr [ESP]
0054df11 : CALL 0x0063bc90
0054df16 : FSTP float ptr [ESP + 0x2c]
0054df1a : FLD float ptr [ESP + 0x2c]
0054df1e : FSTP float ptr [ESP + 0x24]
0054df22 : FLD float ptr [ESP + 0x28]
0054df26 : FSUB float ptr [EDI + 0x4]
0054df29 : FSTP float ptr [ESP + 0x2c]
0054df2d : FLD float ptr [ESP + 0x2c]
0054df31 : FSTP double ptr [ESP]
0054df34 : CALL 0x0063bc90
0054df39 : FSTP float ptr [ESP + 0x2c]
0054df3d : ADD ESP,0x8
0054df40 : FLD float ptr [ESP + 0x24]
0054df44 : FSTP float ptr [ESP + 0x20]
0054df48 : CALL 0x005aa2b0
0054df4d : PUSH 0x0
0054df4f : PUSH 0x3e8
0054df54 : PUSH EDX
0054df55 : PUSH EAX
0054df56 : CALL 0x0063c250
0054df5b : FLD float ptr [ESI + 0x4c]
0054df5e : FLD float ptr [ESP + 0x1c]
0054df62 : MOV EDI,EAX
0054df64 : FLD ST0
0054df66 : XOR BL,BL
0054df68 : FUCOMP ST2
0054df6a : MOV byte ptr [ESP + 0x24],BL
0054df6e : FNSTSW AX
0054df70 : FSTP ST1
0054df72 : FLD float ptr [ESP + 0x20]
0054df76 : TEST AH,0x44
0054df79 : JP 0x0054dfc0
0054df7b : FLD float ptr [ESI + 0x50]
0054df7e : FLD ST1
0054df80 : FUCOMPP
0054df82 : FNSTSW AX
0054df84 : TEST AH,0x44
0054df87 : JP 0x0054dfc0
0054df89 : MOV EAX,dword ptr [ESI + 0x54]
0054df8c : ADD EAX,0x12c
0054df91 : CMP EDI,EAX
0054df93 : JA 0x0054dfc0
0054df95 : MOVZX EAX,word ptr [ESI + 0x68]
0054df99 : MOV ECX,EAX
0054df9b : SHR ECX,0x9
0054df9e : TEST CL,0x1
0054dfa1 : JZ 0x0054dfb3
0054dfa3 : OR EAX,0x200
0054dfa8 : MOV byte ptr [ESP + 0x24],0x1
0054dfad : MOV word ptr [ESI + 0x68],AX
0054dfb1 : JMP 0x0054dfc9
0054dfb3 : OR EAX,0x200
0054dfb8 : MOV BL,0x1
0054dfba : MOV word ptr [ESI + 0x68],AX
0054dfbe : JMP 0x0054dfc9
0054dfc0 : MOV EDX,0xfdff
0054dfc5 : AND word ptr [ESI + 0x68],DX
0054dfc9 : MOV ECX,dword ptr [ESI + 0x8]
0054dfcc : FXCH
0054dfce : FST float ptr [ESI + 0x4c]
0054dfd1 : SUB ESP,0x8
0054dfd4 : FXCH
0054dfd6 : MOV dword ptr [ESI + 0x54],EDI
0054dfd9 : FST float ptr [ESI + 0x50]
0054dfdc : FSTP float ptr [ESP + 0x4]
0054dfe0 : FSTP float ptr [ESP]
0054dfe3 : CALL 0x0054af90
0054dfe8 : MOV EDI,EAX
0054dfea : CMP EDI,-0x1
0054dfed : JZ 0x0054e149
0054dff3 : MOV AL,byte ptr [ESI + 0x68]
0054dff6 : SHR AL,0x1
0054dff8 : AND AL,0x1
0054dffa : MOVZX ECX,AL
0054dffd : PUSH ECX
0054dffe : PUSH EDI
0054dfff : MOV ECX,ESI
0054e001 : CALL 0x0054d5a0
0054e006 : MOVZX EAX,word ptr [ESI + 0x68]
0054e00a : MOV DL,AL
0054e00c : SHR DL,0x1
0054e00e : TEST DL,0x1
0054e011 : JZ 0x0054e149
0054e017 : MOV CL,AL
0054e019 : SHR CL,0x5
0054e01c : TEST CL,0x1
0054e01f : JNZ 0x0054e149
0054e025 : OR EAX,0x20
0054e028 : MOV word ptr [ESI + 0x68],AX
0054e02c : TEST BL,BL
0054e02e : JNZ 0x0054e054
0054e030 : CMP byte ptr [ESP + 0x24],BL
0054e034 : JNZ 0x0054e054
0054e036 : SHR AL,0x6
0054e039 : TEST AL,0x1
0054e03b : JNZ 0x0054e149
0054e041 : MOV ECX,dword ptr [ESI + 0x8]
0054e044 : PUSH EDI
0054e045 : PUSH EDI
0054e046 : CALL 0x00546be0
0054e04b : POP EDI
0054e04c : POP EBX
0054e04d : POP ESI
0054e04e : ADD ESP,0xc
0054e051 : RET 0xc
0054e054 : MOV ECX,dword ptr [ESI + 0x8]
0054e057 : MOV ECX,dword ptr [ECX + 0xc]
0054e05a : LEA EDX,[ESP + 0x24]
0054e05e : PUSH EDX
0054e05f : PUSH EDI
0054e060 : LEA EAX,[ESP + 0x18]
0054e064 : PUSH EAX
0054e065 : CALL 0x0053c2d0
0054e06a : LEA ECX,[ESP + 0x10]
0054e06e : CALL 0x0053b530
0054e073 : TEST AL,AL
0054e075 : JNZ 0x0054e149
0054e07b : MOV EDX,dword ptr [ESP + 0x10]
0054e07f : MOV EAX,dword ptr [EDX]
0054e081 : MOV ECX,dword ptr [ESP + 0x14]
0054e085 : MOV ECX,dword ptr [EAX + ECX*0x4]
0054e088 : PUSH EBP
0054e089 : MOV dword ptr [ESP + 0x24],ECX
0054e08d : CALL 0x0053b4b0
0054e092 : MOV ECX,dword ptr [ESP + 0x28]
0054e096 : MOV dword ptr [ESP + 0x20],EAX
0054e09a : MOV EBP,ECX
0054e09c : MOV EDI,ECX
0054e09e : TEST BL,BL
0054e0a0 : JZ 0x0054e11b
0054e0a2 : MOV EDX,dword ptr [ESP + 0x24]
0054e0a6 : MOV EBX,dword ptr [EDX]
0054e0a8 : MOV dword ptr [ESP + 0x10],EBX
0054e0ac : TEST ECX,ECX
0054e0ae : JBE 0x0054e0e4
0054e0b0 : LEA EBX,[EBX + ECX*0x2 + -0x2]
0054e0b4 : MOVZX EAX,word ptr [EBX]
0054e0b7 : PUSH EAX
0054e0b8 : CALL 0x005126c0
0054e0bd : ADD ESP,0x4
0054e0c0 : TEST EAX,EAX
0054e0c2 : JNZ 0x0054e0dc
0054e0c4 : MOVZX EAX,word ptr [EBX]
0054e0c7 : PUSH EAX
0054e0c8 : CALL 0x0053b2a0
0054e0cd : ADD ESP,0x4
0054e0d0 : TEST EAX,EAX
0054e0d2 : JZ 0x0054e0dc
0054e0d4 : DEC EBP
0054e0d5 : SUB EBX,0x2
0054e0d8 : TEST EBP,EBP
0054e0da : JA 0x0054e0b4
0054e0dc : MOV ECX,dword ptr [ESP + 0x28]
0054e0e0 : MOV EAX,dword ptr [ESP + 0x20]
0054e0e4 : CMP ECX,EAX
0054e0e6 : JNC 0x0054e11f
0054e0e8 : JMP 0x0054e0f0
0054e0f0 : MOV EAX,dword ptr [ESP + 0x10]
0054e0f4 : MOVZX EBX,word ptr [EAX + EDI*0x2]
0054e0f8 : PUSH EBX
0054e0f9 : CALL 0x005126c0
0054e0fe : ADD ESP,0x4
0054e101 : TEST EAX,EAX
0054e103 : JNZ 0x0054e11f
0054e105 : PUSH EBX
0054e106 : CALL 0x0053b2a0
0054e10b : ADD ESP,0x4
0054e10e : TEST EAX,EAX
0054e110 : JZ 0x0054e11f
0054e112 : INC EDI
0054e113 : CMP EDI,dword ptr [ESP + 0x20]
0054e117 : JC 0x0054e0f0
0054e119 : JMP 0x0054e11f
0054e11b : XOR EBP,EBP
0054e11d : MOV EDI,EAX
0054e11f : MOV DL,byte ptr [ESI + 0x68]
0054e122 : MOV ECX,dword ptr [ESP + 0x24]
0054e126 : MOV EBX,dword ptr [ECX + 0x1c]
0054e129 : SHR DL,0x1
0054e12b : AND DL,0x1
0054e12e : MOVZX EAX,DL
0054e131 : PUSH EAX
0054e132 : ADD EDI,EBX
0054e134 : PUSH EDI
0054e135 : MOV ECX,ESI
0054e137 : CALL 0x0054d5a0
0054e13c : MOV ECX,dword ptr [ESI + 0x8]
0054e13f : PUSH EDI
0054e140 : ADD EBX,EBP
0054e142 : PUSH EBX
0054e143 : CALL 0x00546be0
0054e148 : POP EBP
0054e149 : POP EDI
0054e14a : POP EBX
0054e14b : POP ESI
0054e14c : ADD ESP,0xc
0054e14f : RET 0xc

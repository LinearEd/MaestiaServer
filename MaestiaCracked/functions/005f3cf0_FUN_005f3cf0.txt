PROGRAM  : Maestia.exe
FUNCTION : FUN_005f3cf0
ENTRY    : 005f3cf0
BODY     : [[005f3cf0, 005f3e4f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005f3cf0(undefined4 param_1,uint *param_2,uint param_3)

{
  uint *puVar1;
  uint *puVar2;
  int *piVar3;
  int iVar4;
  uint uVar5;
  int *in_ECX;
  uint uVar6;
  int iVar7;
  
  piVar3 = (int *)*in_ECX;
  if (piVar3 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar3 * 5) <= piVar3[1] * 4 + 4U) goto LAB_005f3d2a;
    iVar7 = piVar3[1] * 2 + 2;
  }
  FUN_005f3370(param_1,iVar7);
LAB_005f3d2a:
  piVar3 = (int *)*in_ECX;
  param_3 = param_3 & piVar3[1];
  *piVar3 = *piVar3 + 1;
  iVar7 = *in_ECX;
  iVar4 = *(int *)(iVar7 + 8 + param_3 * 0x18);
  puVar1 = (uint *)(iVar7 + 8 + param_3 * 0x18);
  if (iVar4 == -2) {
    *puVar1 = 0xffffffff;
    puVar1[2] = *param_2;
    puVar1[3] = param_2[1];
    puVar1[4] = param_2[2];
    puVar1[5] = param_2[3];
    puVar1[1] = param_3;
    return;
  }
  uVar6 = param_3;
  do {
    uVar6 = uVar6 + 1 & *(uint *)(iVar7 + 4);
  } while (*(int *)(iVar7 + 8 + uVar6 * 0x18) != -2);
  uVar5 = puVar1[1];
  piVar3 = (int *)(iVar7 + 8 + uVar6 * 0x18);
  if (uVar5 == param_3) {
    if (piVar3 != (int *)0x0) {
      *piVar3 = iVar4;
      piVar3[1] = puVar1[1];
      piVar3[2] = puVar1[2];
      piVar3[3] = puVar1[3];
      piVar3[4] = puVar1[4];
      piVar3[5] = puVar1[5];
    }
    puVar1[2] = *param_2;
    puVar1[3] = param_2[1];
    puVar1[4] = param_2[2];
    puVar1[5] = param_2[3];
    *puVar1 = uVar6;
    puVar1[1] = param_3;
    return;
  }
  puVar2 = (uint *)(iVar7 + 8 + uVar5 * 0x18);
  for (uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x18); uVar5 != param_3;
      uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x18)) {
    uVar5 = *puVar2;
    puVar2 = (uint *)(iVar7 + 8 + uVar5 * 0x18);
  }
  if (piVar3 != (int *)0x0) {
    *piVar3 = iVar4;
    piVar3[1] = puVar1[1];
    piVar3[2] = puVar1[2];
    piVar3[3] = puVar1[3];
    piVar3[4] = puVar1[4];
    piVar3[5] = puVar1[5];
  }
  *puVar2 = uVar6;
  puVar1[2] = *param_2;
  puVar1[3] = param_2[1];
  puVar1[4] = param_2[2];
  puVar1[5] = param_2[3];
  *puVar1 = 0xffffffff;
  puVar1[1] = param_3;
  return;
}



============================================================
DISASSEMBLY
============================================================
005f3cf0 : PUSH EBP
005f3cf1 : PUSH ESI
005f3cf2 : MOV ESI,ECX
005f3cf4 : MOV EAX,dword ptr [ESI]
005f3cf6 : TEST EAX,EAX
005f3cf8 : JNZ 0x005f3d03
005f3cfa : MOV EAX,dword ptr [ESP + 0xc]
005f3cfe : PUSH 0x8
005f3d00 : PUSH EAX
005f3d01 : JMP 0x005f3d25
005f3d03 : MOV ECX,dword ptr [EAX + 0x4]
005f3d06 : LEA EDX,[ECX*0x4 + 0x4]
005f3d0d : MOV ECX,dword ptr [EAX]
005f3d0f : LEA ECX,[ECX + ECX*0x4]
005f3d12 : CMP ECX,EDX
005f3d14 : JBE 0x005f3d2a
005f3d16 : MOV EDX,dword ptr [EAX + 0x4]
005f3d19 : MOV ECX,dword ptr [ESP + 0xc]
005f3d1d : LEA EAX,[EDX + EDX*0x1 + 0x2]
005f3d21 : PUSH EAX
005f3d22 : PUSH ECX
005f3d23 : MOV ECX,ESI
005f3d25 : CALL 0x005f3370
005f3d2a : MOV EAX,dword ptr [ESI]
005f3d2c : MOV ECX,dword ptr [ESP + 0x14]
005f3d30 : AND ECX,dword ptr [EAX + 0x4]
005f3d33 : INC dword ptr [EAX]
005f3d35 : MOV ESI,dword ptr [ESI]
005f3d37 : LEA EDX,[ECX + ECX*0x2]
005f3d3a : MOV EBP,dword ptr [ESI + EDX*0x8 + 0x8]
005f3d3e : LEA EAX,[ESI + EDX*0x8 + 0x8]
005f3d42 : CMP EBP,-0x2
005f3d45 : JNZ 0x005f3d70
005f3d47 : MOV EDX,dword ptr [ESP + 0x10]
005f3d4b : MOV dword ptr [EAX],0xffffffff
005f3d51 : MOV ESI,dword ptr [EDX]
005f3d53 : MOV dword ptr [EAX + 0x8],ESI
005f3d56 : MOV ESI,dword ptr [EDX + 0x4]
005f3d59 : MOV dword ptr [EAX + 0xc],ESI
005f3d5c : MOV ESI,dword ptr [EDX + 0x8]
005f3d5f : MOV dword ptr [EAX + 0x10],ESI
005f3d62 : MOV EDX,dword ptr [EDX + 0xc]
005f3d65 : POP ESI
005f3d66 : MOV dword ptr [EAX + 0x14],EDX
005f3d69 : MOV dword ptr [EAX + 0x4],ECX
005f3d6c : POP EBP
005f3d6d : RET 0xc
005f3d70 : PUSH EDI
005f3d71 : MOV EDI,dword ptr [ESI + 0x4]
005f3d74 : MOV EDX,ECX
005f3d76 : PUSH EBX
005f3d77 : INC EDX
005f3d78 : AND EDX,EDI
005f3d7a : LEA EBX,[EDX + EDX*0x2]
005f3d7d : CMP dword ptr [ESI + EBX*0x8 + 0x8],-0x2
005f3d82 : JNZ 0x005f3d77
005f3d84 : MOV EBX,dword ptr [EAX + 0x4]
005f3d87 : LEA EDI,[EDX + EDX*0x2]
005f3d8a : LEA EDI,[ESI + EDI*0x8 + 0x8]
005f3d8e : CMP EBX,ECX
005f3d90 : JNZ 0x005f3ddd
005f3d92 : TEST EDI,EDI
005f3d94 : JZ 0x005f3db6
005f3d96 : MOV dword ptr [EDI],EBP
005f3d98 : MOV ESI,dword ptr [EAX + 0x4]
005f3d9b : MOV dword ptr [EDI + 0x4],ESI
005f3d9e : MOV ESI,dword ptr [EAX + 0x8]
005f3da1 : MOV dword ptr [EDI + 0x8],ESI
005f3da4 : MOV ESI,dword ptr [EAX + 0xc]
005f3da7 : MOV dword ptr [EDI + 0xc],ESI
005f3daa : MOV ESI,dword ptr [EAX + 0x10]
005f3dad : MOV dword ptr [EDI + 0x10],ESI
005f3db0 : MOV ESI,dword ptr [EAX + 0x14]
005f3db3 : MOV dword ptr [EDI + 0x14],ESI
005f3db6 : MOV ESI,dword ptr [ESP + 0x18]
005f3dba : MOV EDI,dword ptr [ESI]
005f3dbc : MOV dword ptr [EAX + 0x8],EDI
005f3dbf : MOV EDI,dword ptr [ESI + 0x4]
005f3dc2 : MOV dword ptr [EAX + 0xc],EDI
005f3dc5 : MOV EDI,dword ptr [ESI + 0x8]
005f3dc8 : MOV dword ptr [EAX + 0x10],EDI
005f3dcb : MOV ESI,dword ptr [ESI + 0xc]
005f3dce : POP EBX
005f3dcf : POP EDI
005f3dd0 : MOV dword ptr [EAX + 0x14],ESI
005f3dd3 : POP ESI
005f3dd4 : MOV dword ptr [EAX],EDX
005f3dd6 : MOV dword ptr [EAX + 0x4],ECX
005f3dd9 : POP EBP
005f3dda : RET 0xc
005f3ddd : LEA EBX,[EBX + EBX*0x2]
005f3de0 : CMP dword ptr [ESI + EBX*0x8 + 0x8],ECX
005f3de4 : LEA EBX,[ESI + EBX*0x8 + 0x8]
005f3de8 : JZ 0x005f3dff
005f3dea : LEA EBX,[EBX]
005f3df0 : MOV EBX,dword ptr [EBX]
005f3df2 : LEA EBX,[EBX + EBX*0x2]
005f3df5 : CMP dword ptr [ESI + EBX*0x8 + 0x8],ECX
005f3df9 : LEA EBX,[ESI + EBX*0x8 + 0x8]
005f3dfd : JNZ 0x005f3df0
005f3dff : TEST EDI,EDI
005f3e01 : JZ 0x005f3e23
005f3e03 : MOV dword ptr [EDI],EBP
005f3e05 : MOV ESI,dword ptr [EAX + 0x4]
005f3e08 : MOV dword ptr [EDI + 0x4],ESI
005f3e0b : MOV ESI,dword ptr [EAX + 0x8]
005f3e0e : MOV dword ptr [EDI + 0x8],ESI
005f3e11 : MOV ESI,dword ptr [EAX + 0xc]
005f3e14 : MOV dword ptr [EDI + 0xc],ESI
005f3e17 : MOV ESI,dword ptr [EAX + 0x10]
005f3e1a : MOV dword ptr [EDI + 0x10],ESI
005f3e1d : MOV ESI,dword ptr [EAX + 0x14]
005f3e20 : MOV dword ptr [EDI + 0x14],ESI
005f3e23 : MOV dword ptr [EBX],EDX
005f3e25 : MOV EDX,dword ptr [ESP + 0x18]
005f3e29 : MOV ESI,dword ptr [EDX]
005f3e2b : MOV dword ptr [EAX + 0x8],ESI
005f3e2e : MOV ESI,dword ptr [EDX + 0x4]
005f3e31 : MOV dword ptr [EAX + 0xc],ESI
005f3e34 : MOV ESI,dword ptr [EDX + 0x8]
005f3e37 : POP EBX
005f3e38 : MOV dword ptr [EAX + 0x10],ESI
005f3e3b : MOV EDX,dword ptr [EDX + 0xc]
005f3e3e : POP EDI
005f3e3f : POP ESI
005f3e40 : MOV dword ptr [EAX + 0x14],EDX
005f3e43 : MOV dword ptr [EAX],0xffffffff
005f3e49 : MOV dword ptr [EAX + 0x4],ECX
005f3e4c : POP EBP
005f3e4d : RET 0xc

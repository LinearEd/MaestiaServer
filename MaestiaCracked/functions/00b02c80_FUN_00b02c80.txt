PROGRAM  : Maestia.exe
FUNCTION : FUN_00b02c80
ENTRY    : 00b02c80
BODY     : [[00b02c80, 00b02d9b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00b02c80(undefined4 param_1)

{
  uint uVar1;
  DWORD DVar2;
  undefined4 uVar3;
  uint8_t *packet;
  int iVar4;
  int in_ECX;
  byte bVar5;
  undefined8 uVar6;
  wchar_t *pwVar7;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b39159;
  local_14 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xffffffd0;
  ExceptionList = &local_14;
  FUN_008018d0(L"AvaCltSockEvt::OnConnected - connected success",uVar1);
  if (*(int *)(in_ECX + 4) == 0) {
    pwVar7 = L"[Clt Net] Ava Net Client Not Created";
  }
  else {
    DVar2 = timeGetTime();
    *(DWORD *)(in_ECX + 0x18) = DVar2;
    FUN_00412920(param_1);
    *(undefined4 *)(in_ECX + 0x14) = param_1;
    uVar3 = FUN_00412890();
    uVar6 = FUN_004127f0();
    iVar4 = *(int *)ThreadLocalStoragePointer;
    bVar5 = (byte)((ulonglong)(*(byte *)(iVar4 + 0x18) + 1) % 3);
    *(byte *)(iVar4 + 0x18) = bVar5;
    packet = (uint8_t *)((uint)bVar5 * 0x2000 + 0x122cb8 + iVar4);
    if (packet == (uint8_t *)0x0) {
      packet = (uint8_t *)0x0;
    }
    else {
      packet[0] = '\0';
      packet[1] = '\0';
      packet[2] = '\x01';
      packet[3] = '\n';
      *(undefined4 *)(packet + 4) = uVar3;
      *(undefined8 *)(packet + 8) = uVar6;
    }
    local_c = 0xffffffff;
    iVar4 = FUN_006f3840(0x10,packet);
    if (iVar4 == 0) {
      ExceptionList = local_14;
      return;
    }
    pwVar7 = L"[Clt Net] Send message success : Hello!";
  }
  FUN_008018d0(pwVar7,uVar1);
  ExceptionList = local_14;
  return;
}



============================================================
DISASSEMBLY
============================================================
00b02c80 : PUSH EBP
00b02c81 : MOV EBP,ESP
00b02c83 : AND ESP,0xfffffff8
00b02c86 : PUSH -0x1
00b02c88 : PUSH 0xb39159
00b02c8d : MOV EAX,FS:[0x0]
00b02c93 : PUSH EAX
00b02c94 : SUB ESP,0x10
00b02c97 : PUSH EBX
00b02c98 : PUSH ESI
00b02c99 : PUSH EDI
00b02c9a : MOV EAX,[0x00d66fa0]
00b02c9f : XOR EAX,ESP
00b02ca1 : PUSH EAX
00b02ca2 : LEA EAX,[ESP + 0x20]
00b02ca6 : MOV FS:[0x0],EAX
00b02cac : MOV EDI,ECX
00b02cae : MOV ESI,dword ptr [0x00da98e8]
00b02cb4 : PUSH 0xcaca80
00b02cb9 : CALL 0x008018d0
00b02cbe : ADD ESP,0x4
00b02cc1 : CMP dword ptr [EDI + 0x4],0x0
00b02cc5 : JNZ 0x00b02cd1
00b02cc7 : PUSH 0xcacae0
00b02ccc : JMP 0x00b02d79
00b02cd1 : CALL dword ptr [0x00b85598]
00b02cd7 : MOV EBX,dword ptr [EBP + 0x8]
00b02cda : MOV ESI,dword ptr [EDI + 0x4]
00b02cdd : PUSH EBX
00b02cde : MOV dword ptr [EDI + 0x18],EAX
00b02ce1 : CALL 0x00412920
00b02ce6 : MOV ECX,dword ptr [EDI + 0x4]
00b02ce9 : MOV dword ptr [EDI + 0x14],EBX
00b02cec : CALL 0x00412890
00b02cf1 : MOV ECX,dword ptr [EDI + 0x4]
00b02cf4 : MOV ESI,EAX
00b02cf6 : CALL 0x004127f0
00b02cfb : MOV dword ptr [ESP + 0x14],EAX
00b02cff : MOV EAX,FS:[0x2c]
00b02d05 : MOV ECX,dword ptr [EAX]
00b02d07 : MOVZX EAX,byte ptr [ECX + 0x18]
00b02d0b : MOV dword ptr [ESP + 0x18],EDX
00b02d0f : INC EAX
00b02d10 : CDQ
00b02d11 : MOV EDI,0x3
00b02d16 : IDIV EDI
00b02d18 : MOV byte ptr [ECX + 0x18],DL
00b02d1b : MOVZX EDX,DL
00b02d1e : SHL EDX,0xd
00b02d21 : LEA EAX,[EDX + ECX*0x1 + 0x122cb8]
00b02d28 : MOV dword ptr [ESP + 0x10],EAX
00b02d2c : MOV dword ptr [ESP + 0x28],0x0
00b02d34 : TEST EAX,EAX
00b02d36 : JZ 0x00b02d58
00b02d38 : MOV EDX,dword ptr [ESP + 0x14]
00b02d3c : XOR ECX,ECX
00b02d3e : MOV word ptr [EAX],CX
00b02d41 : MOV ECX,dword ptr [ESP + 0x18]
00b02d45 : MOV byte ptr [EAX + 0x2],0x1
00b02d49 : MOV byte ptr [EAX + 0x3],0xa
00b02d4d : MOV dword ptr [EAX + 0x4],ESI
00b02d50 : MOV dword ptr [EAX + 0x8],EDX
00b02d53 : MOV dword ptr [EAX + 0xc],ECX
00b02d56 : JMP 0x00b02d5a
00b02d58 : XOR EAX,EAX
00b02d5a : MOV dword ptr [ESP + 0x28],0xffffffff
00b02d62 : MOV ECX,0x10
00b02d67 : MOV EDX,EAX
00b02d69 : MOV ESI,EBX
00b02d6b : CALL 0x006f3840
00b02d70 : TEST EAX,EAX
00b02d72 : JZ 0x00b02d87
00b02d74 : PUSH 0xcacb30
00b02d79 : MOV ESI,dword ptr [0x00da98e8]
00b02d7f : CALL 0x008018d0
00b02d84 : ADD ESP,0x4
00b02d87 : MOV ECX,dword ptr [ESP + 0x20]
00b02d8b : MOV dword ptr FS:[0x0],ECX
00b02d92 : POP ECX
00b02d93 : POP EDI
00b02d94 : POP ESI
00b02d95 : POP EBX
00b02d96 : MOV ESP,EBP
00b02d98 : POP EBP
00b02d99 : RET 0x4

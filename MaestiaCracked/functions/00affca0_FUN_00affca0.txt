PROGRAM  : Maestia.exe
FUNCTION : FUN_00affca0
ENTRY    : 00affca0
BODY     : [[00affca0, 00affe82]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00affca0(void)

{
  uint uVar1;
  int in_ECX;
  int in_EDX;
  uint uVar2;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b702de;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  switch(*(undefined1 *)(in_EDX + 3)) {
  case 2:
    uVar2 = uVar1;
    if (DAT_00d7c550 != 0) {
      FUN_00a4fdf0();
    }
    FUN_008018d0(L"[Clt Net] Preparing server list",uVar2);
    FUN_008018d0(L"[Clt Net] Received DPKUL_SERVER_RS_LISTBEGIN\n");
    break;
  case 3:
    if (DAT_00d7c550 != 0) {
      FUN_00a4bb90(DAT_00d7c550,in_EDX);
    }
    FUN_008018d0(L"[Clt Net] Received DPKUL_SERVER_RS_CHILD (%s)\n",in_EDX + 8);
    break;
  case 4:
    uVar2 = uVar1;
    if (DAT_00d7c550 != 0) {
      FUN_00a4bac0();
    }
    FUN_008018d0(L"[Clt Net] Received DPKUL_SERVER_RS_ACTIVE\n",uVar2);
    break;
  case 5:
  case 7:
    FUN_008018d0(L"[Clt Net] Success to receive server list",uVar1);
    if (DAT_00d7c550 != 0) {
      FUN_00a58730(DAT_00d7c550);
    }
    FUN_008018d0(L"[Clt Net] Received DPKUL_SERVER_RS_LISTEND\n");
    break;
  case 6:
    FUN_00a4fd40();
    break;
  case 0xb:
    FUN_00412350(*(undefined4 *)(in_EDX + 4));
    *(undefined4 *)(in_ECX + 0x18) = *(undefined4 *)(in_EDX + 4);
    FUN_008018d0(L"[Clt Net] Received DPKUL_SERVER_RS_SELECT\n");
    break;
  case 0xc:
    if (DAT_00d7c550 != 0) {
      FUN_00a4f330(DAT_00d7c550);
    }
    break;
  case 0xe:
    if (DAT_00d7c550 != 0) {
      *(undefined1 *)(DAT_00d7c550 + 0x11c) = 0;
      FUN_00a4a1c0();
    }
    break;
  case 0xff:
    local_8 = 0;
    uVar2 = uVar1;
    if ((*(int *)(in_EDX + 4) != 0) && (DAT_00d7c550 != 0)) {
      FUN_00a57120(DAT_00d7c550);
    }
    FUN_008018d0(L"[Clt Net] Received DPKUL_SERVER_RS_ERROR\n",uVar2);
    local_8 = 0xffffffff;
    FUN_00406560();
  }
  ExceptionList = local_10;
  __security_check_cookie(uVar1 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00affca0 : PUSH EBP
00affca1 : MOV EBP,ESP
00affca3 : PUSH -0x1
00affca5 : PUSH 0xb702de
00affcaa : MOV EAX,FS:[0x0]
00affcb0 : PUSH EAX
00affcb1 : SUB ESP,0x20
00affcb4 : MOV EAX,[0x00d66fa0]
00affcb9 : XOR EAX,EBP
00affcbb : MOV dword ptr [EBP + -0x10],EAX
00affcbe : PUSH ESI
00affcbf : PUSH EDI
00affcc0 : PUSH EAX
00affcc1 : LEA EAX,[EBP + -0xc]
00affcc4 : MOV FS:[0x0],EAX
00affcca : MOV EDI,EDX
00affccc : MOVZX EAX,byte ptr [EDI + 0x3]
00affcd0 : ADD EAX,-0x2
00affcd3 : MOV ESI,ECX
00affcd5 : CMP EAX,0xfd
00affcda : JA 0x00affe63
00affce0 : MOVZX EAX,byte ptr [EAX + 0xaffeac]
00affce7 : JMP dword ptr [EAX*0x4 + 0xaffe84]
00affcee : MOV ECX,dword ptr [0x00d7c550]
00affcf4 : TEST ECX,ECX
00affcf6 : JZ 0x00affcfd
00affcf8 : CALL 0x00a4fdf0
00affcfd : MOV ESI,dword ptr [0x00da98e8]
00affd03 : PUSH 0xcadcb0
00affd08 : CALL 0x008018d0
00affd0d : MOV ESI,dword ptr [0x00da98e8]
00affd13 : ADD ESP,0x4
00affd16 : PUSH 0xcadcf0
00affd1b : CALL 0x008018d0
00affd20 : ADD ESP,0x4
00affd23 : JMP 0x00affe63
00affd28 : MOV EAX,[0x00d7c550]
00affd2d : TEST EAX,EAX
00affd2f : JZ 0x00affd38
00affd31 : PUSH EDI
00affd32 : PUSH EAX
00affd33 : CALL 0x00a4bb90
00affd38 : MOV ESI,dword ptr [0x00da98e8]
00affd3e : ADD EDI,0x8
00affd41 : PUSH EDI
00affd42 : PUSH 0xcadd88
00affd47 : CALL 0x008018d0
00affd4c : ADD ESP,0x8
00affd4f : JMP 0x00affe63
00affd54 : MOV ECX,dword ptr [0x00d7c550]
00affd5a : TEST ECX,ECX
00affd5c : JZ 0x00affd65
00affd5e : MOV EAX,EDI
00affd60 : CALL 0x00a4bac0
00affd65 : MOV ESI,dword ptr [0x00da98e8]
00affd6b : PUSH 0xcadde8
00affd70 : CALL 0x008018d0
00affd75 : ADD ESP,0x4
00affd78 : JMP 0x00affe63
00affd7d : MOV ESI,dword ptr [0x00da98e8]
00affd83 : PUSH 0xcade40
00affd88 : CALL 0x008018d0
00affd8d : MOV EAX,[0x00d7c550]
00affd92 : ADD ESP,0x4
00affd95 : TEST EAX,EAX
00affd97 : JZ 0x00affd9f
00affd99 : PUSH EAX
00affd9a : CALL 0x00a58730
00affd9f : MOV ESI,dword ptr [0x00da98e8]
00affda5 : PUSH 0xcade98
00affdaa : CALL 0x008018d0
00affdaf : ADD ESP,0x4
00affdb2 : JMP 0x00affe63
00affdb7 : MOV ECX,dword ptr [EDI + 0x4]
00affdba : PUSH ECX
00affdbb : CALL 0x00412350
00affdc0 : MOV EDX,dword ptr [EDI + 0x4]
00affdc3 : MOV dword ptr [ESI + 0x18],EDX
00affdc6 : MOV ESI,dword ptr [0x00da98e8]
00affdcc : PUSH 0xcadef0
00affdd1 : CALL 0x008018d0
00affdd6 : ADD ESP,0x4
00affdd9 : JMP 0x00affe63
00affdde : MOV ESI,dword ptr [0x00d7c550]
00affde4 : CALL 0x00a4fd40
00affde9 : JMP 0x00affe63
00affdeb : XOR EDX,EDX
00affded : XOR EAX,EAX
00affdef : MOV dword ptr [EBP + -0x14],0x7
00affdf6 : MOV dword ptr [EBP + -0x18],EDX
00affdf9 : MOV word ptr [EBP + -0x28],AX
00affdfd : MOV dword ptr [EBP + -0x4],EDX
00affe00 : MOV ECX,dword ptr [EDI + 0x4]
00affe03 : CMP ECX,EDX
00affe05 : JZ 0x00affe16
00affe07 : MOV EAX,[0x00d7c550]
00affe0c : CMP EAX,EDX
00affe0e : JZ 0x00affe16
00affe10 : PUSH EAX
00affe11 : CALL 0x00a57120
00affe16 : MOV ESI,dword ptr [0x00da98e8]
00affe1c : PUSH 0xcadf48
00affe21 : CALL 0x008018d0
00affe26 : ADD ESP,0x4
00affe29 : MOV dword ptr [EBP + -0x4],0xffffffff
00affe30 : LEA ECX,[EBP + -0x2c]
00affe33 : CALL 0x00406560
00affe38 : JMP 0x00affe63
00affe3a : MOV EAX,[0x00d7c550]
00affe3f : TEST EAX,EAX
00affe41 : JZ 0x00affe63
00affe43 : PUSH EAX
00affe44 : MOV ECX,EDI
00affe46 : CALL 0x00a4f330
00affe4b : JMP 0x00affe63
00affe4d : MOV EAX,[0x00d7c550]
00affe52 : XOR EDX,EDX
00affe54 : CMP EAX,EDX
00affe56 : JZ 0x00affe63
00affe58 : MOV byte ptr [EAX + 0x11c],DL
00affe5e : CALL 0x00a4a1c0
00affe63 : MOV EAX,0x1
00affe68 : MOV ECX,dword ptr [EBP + -0xc]
00affe6b : MOV dword ptr FS:[0x0],ECX
00affe72 : POP ECX
00affe73 : POP EDI
00affe74 : POP ESI
00affe75 : MOV ECX,dword ptr [EBP + -0x10]
00affe78 : XOR ECX,EBP
00affe7a : CALL 0x00633e6b
00affe7f : MOV ESP,EBP
00affe81 : POP EBP
00affe82 : RET

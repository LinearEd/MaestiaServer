PROGRAM  : Maestia.exe
FUNCTION : FUN_00803030
ENTRY    : 00803030
BODY     : [[00803030, 00803482]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00803030(undefined4 param_1)

{
  int *piVar1;
  int iVar2;
  undefined4 ****ppppuVar3;
  int iVar4;
  int in_EDX;
  int iVar5;
  int *piVar6;
  undefined1 auStack_a8 [4];
  undefined2 local_a4;
  undefined4 uStack_9c;
  undefined4 uStack_98;
  undefined *local_94;
  int *local_90;
  uint uStack_8c;
  undefined1 auStack_7c [3];
  undefined1 local_79;
  int *local_78;
  int local_74;
  int *local_70;
  int local_6c;
  undefined4 local_68;
  int local_64;
  undefined1 *local_60;
  undefined1 *local_5c;
  int local_58;
  undefined1 local_54 [4];
  undefined2 local_50;
  undefined4 local_40;
  uint local_3c;
  undefined1 local_38 [4];
  undefined4 ***local_34 [4];
  int local_24;
  uint local_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  int local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b4384c;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_7c;
  uStack_8c = DAT_00d66fa0 ^ (uint)&stack0xffffff78;
  ExceptionList = &local_14;
  local_90 = (int *)0x0;
  local_94 = &DAT_00c28b9c;
  local_68 = param_1;
  local_20 = 7;
  local_24 = 0;
  local_34[0] = (undefined4 ***)((uint)local_34[0] & 0xffff0000);
  uStack_98 = 0x80309c;
  local_64 = in_EDX;
  FUN_00406360();
  local_c = 0;
  piVar6 = *(int **)(in_EDX + 0x9c);
  if (piVar6 != *(int **)(in_EDX + 0xa0)) {
    local_58 = in_EDX + 0x48;
    do {
      local_94 = (undefined *)0x8030d0;
      local_90 = piVar6;
      local_78 = piVar6;
      piVar1 = (int *)FUN_004437f0();
      if (*piVar1 != *(int *)(in_EDX + 0x4c)) {
        local_6c = *piVar6;
        local_74 = *(int *)(*piVar1 + 0x10);
        if (((local_6c != 0) && (local_74 != 0)) &&
           (iVar5 = *(int *)(local_74 + 4), iVar5 != *(int *)(local_74 + 8))) {
          do {
            ppppuVar3 = (undefined4 ****)local_34[0];
            if (local_20 < 8) {
              ppppuVar3 = local_34;
            }
            iVar2 = (int)ppppuVar3 + local_24 * 2;
            ppppuVar3 = (undefined4 ****)local_34[0];
            if (local_20 < 8) {
              ppppuVar3 = local_34;
            }
            if (iVar2 == 0) {
              local_90 = (int *)0x0;
            }
            else {
              local_90 = (int *)(iVar2 - (int)ppppuVar3 >> 1);
            }
            local_94 = (undefined *)0x0;
            uStack_98 = 0x803156;
            FUN_00405e10();
            local_90 = (int *)local_68;
            local_94 = local_54;
            uStack_98 = 0x803167;
            uStack_98 = FUN_00403450();
            local_c._0_1_ = 1;
            local_90 = (int *)0xffffffff;
            local_94 = (undefined *)0x0;
            uStack_9c = 0x80317f;
            FUN_00405eb0();
            local_c._0_1_ = 0;
            if (7 < local_3c) {
                    /* WARNING: Subroutine does not return */
              local_90 = (int *)0x803197;
              FUN_006f04e0();
            }
            local_5c = auStack_a8;
            local_50 = 0;
            local_90 = (int *)0x7;
            local_3c = 7;
            local_94 = (undefined *)0x0;
            local_40 = 0;
            local_a4 = 0;
            FUN_00405eb0(local_38,0,0xffffffff);
            local_c = (uint)local_c._1_3_ << 8;
            iVar2 = FUN_00a5f840(local_6c);
            if (iVar2 != 0) {
              local_90 = (int *)0x8032ad;
              FUN_00449300();
              local_c = 0xffffffff;
              if (7 < local_20) {
                    /* WARNING: Subroutine does not return */
                local_90 = (int *)0x8032ca;
                FUN_006f04e0();
              }
              goto LAB_008033e7;
            }
            iVar5 = iVar5 + 0x1c;
            in_EDX = local_64;
            piVar6 = local_78;
          } while (iVar5 != *(int *)(local_74 + 8));
        }
      }
      piVar6 = piVar6 + 1;
    } while (piVar6 != *(int **)(in_EDX + 0xa0));
  }
  piVar6 = *(int **)(in_EDX + 0xac);
  local_78 = piVar6;
  if (piVar6 != *(int **)(in_EDX + 0xb0)) {
    do {
      local_94 = (undefined *)0x80323d;
      local_90 = piVar6;
      local_78 = piVar6;
      piVar1 = (int *)FUN_004437f0();
      if (*piVar1 != *(int *)(in_EDX + 0x4c)) {
        local_6c = *piVar6;
        local_74 = *(int *)(*piVar1 + 0x10);
        if (((local_6c != 0) && (local_74 != 0)) &&
           (iVar5 = *(int *)(local_74 + 4), iVar5 != *(int *)(local_74 + 8))) {
          do {
            ppppuVar3 = (undefined4 ****)local_34[0];
            if (local_20 < 8) {
              ppppuVar3 = local_34;
            }
            iVar2 = (int)ppppuVar3 + local_24 * 2;
            ppppuVar3 = (undefined4 ****)local_34[0];
            if (local_20 < 8) {
              ppppuVar3 = local_34;
            }
            if (iVar2 == 0) {
              local_90 = (int *)0x0;
            }
            else {
              local_90 = (int *)(iVar2 - (int)ppppuVar3 >> 1);
            }
            local_94 = (undefined *)0x0;
            uStack_98 = 0x8032f9;
            FUN_00405e10();
            local_90 = (int *)local_68;
            local_94 = local_54;
            uStack_98 = 0x80330a;
            uStack_98 = FUN_00403450();
            local_c._0_1_ = 3;
            local_90 = (int *)0xffffffff;
            local_94 = (undefined *)0x0;
            uStack_9c = 0x803322;
            FUN_00405eb0();
            local_c._0_1_ = 0;
            if (7 < local_3c) {
                    /* WARNING: Subroutine does not return */
              local_90 = (int *)0x80333a;
              FUN_006f04e0();
            }
            local_60 = auStack_a8;
            local_50 = 0;
            local_90 = (int *)0x7;
            local_3c = 7;
            local_94 = (undefined *)0x0;
            local_40 = 0;
            local_a4 = 0;
            FUN_00405eb0(local_38,0,0xffffffff);
            local_c = (uint)local_c._1_3_ << 8;
            iVar2 = FUN_00a5f840(local_6c);
            if (iVar2 != 0) {
              local_90 = (int *)0x803416;
              iVar4 = FUN_00714100();
              local_79 = *(char *)(iVar2 + 0xd4) != '\0';
              iVar5 = *(int *)(iVar2 + 0x60);
              local_90 = (int *)0x803432;
              (**(code **)(*local_70 + 8))();
              local_70[7] = iVar4;
              local_70[8] = iVar5;
              local_70[9] = 0;
              *(undefined1 *)(local_70 + 1) = 1;
              *(undefined1 *)(local_70 + 0x14) = local_79;
              local_70[3] = iVar2;
              local_70[2] = (int)FUN_00846510;
              local_c = 0xffffffff;
              if (7 < local_20) {
                    /* WARNING: Subroutine does not return */
                local_90 = (int *)0x803471;
                FUN_006f04e0();
              }
              goto LAB_008033e7;
            }
            iVar5 = iVar5 + 0x1c;
            in_EDX = local_64;
            piVar6 = local_78;
          } while (iVar5 != *(int *)(local_74 + 8));
        }
      }
      piVar6 = piVar6 + 1;
      local_78 = piVar6;
    } while (piVar6 != *(int **)(in_EDX + 0xb0));
  }
  local_c = 0xffffffff;
  if (7 < local_20) {
                    /* WARNING: Subroutine does not return */
    local_90 = (int *)0x8033d6;
    FUN_006f04e0();
  }
LAB_008033e7:
  local_34[0] = (undefined4 ***)((uint)local_34[0] & 0xffff0000);
  local_c = 0xffffffff;
  local_24 = 0;
  local_20 = 7;
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_7c);
  return;
}



============================================================
DISASSEMBLY
============================================================
00803030 : PUSH EBP
00803031 : MOV EBP,ESP
00803033 : AND ESP,0xfffffff8
00803036 : PUSH -0x1
00803038 : PUSH 0xb4384c
0080303d : MOV EAX,FS:[0x0]
00803043 : PUSH EAX
00803044 : SUB ESP,0x68
00803047 : MOV EAX,[0x00d66fa0]
0080304c : XOR EAX,ESP
0080304e : MOV dword ptr [ESP + 0x60],EAX
00803052 : PUSH EBX
00803053 : PUSH ESI
00803054 : PUSH EDI
00803055 : MOV EAX,[0x00d66fa0]
0080305a : XOR EAX,ESP
0080305c : PUSH EAX
0080305d : LEA EAX,[ESP + 0x78]
00803061 : MOV FS:[0x0],EAX
00803067 : MOV EAX,dword ptr [EBP + 0x8]
0080306a : XOR EDI,EDI
0080306c : MOV ESI,EDX
0080306e : PUSH EDI
0080306f : MOV dword ptr [ESP + 0x20],ECX
00803073 : XOR EDX,EDX
00803075 : PUSH 0xc28b9c
0080307a : LEA ECX,[ESP + 0x5c]
0080307e : MOV dword ptr [ESP + 0x30],ESI
00803082 : MOV dword ptr [ESP + 0x2c],EAX
00803086 : MOV dword ptr [ESP + 0x74],0x7
0080308e : MOV dword ptr [ESP + 0x70],EDI
00803092 : MOV word ptr [ESP + 0x60],DX
00803097 : CALL 0x00406360
0080309c : MOV dword ptr [ESP + 0x80],EDI
008030a3 : MOV EDI,dword ptr [ESI + 0x9c]
008030a9 : MOV EAX,dword ptr [ESI + 0xa0]
008030af : MOV dword ptr [ESP + 0x14],EDI
008030b3 : CMP EDI,EAX
008030b5 : JZ 0x0080321a
008030bb : LEA EAX,[ESI + 0x48]
008030be : MOV dword ptr [ESP + 0x34],EAX
008030c2 : MOV ECX,dword ptr [ESP + 0x34]
008030c6 : PUSH EDI
008030c7 : LEA EAX,[ESP + 0x30]
008030cb : CALL 0x004437f0
008030d0 : MOV EAX,dword ptr [EAX]
008030d2 : CMP EAX,dword ptr [ESI + 0x4c]
008030d5 : JZ 0x00803207
008030db : MOV ECX,dword ptr [EDI]
008030dd : MOV EAX,dword ptr [EAX + 0x10]
008030e0 : MOV dword ptr [ESP + 0x20],ECX
008030e4 : MOV dword ptr [ESP + 0x18],EAX
008030e8 : TEST ECX,ECX
008030ea : JZ 0x00803207
008030f0 : TEST EAX,EAX
008030f2 : JZ 0x00803207
008030f8 : MOV EBX,dword ptr [EAX + 0x4]
008030fb : CMP EBX,dword ptr [EAX + 0x8]
008030fe : JZ 0x00803207
00803104 : MOV EDX,dword ptr [ESP + 0x6c]
00803108 : MOV ESI,dword ptr [ESP + 0x58]
0080310c : MOV EAX,ESI
0080310e : CMP EDX,0x8
00803111 : JNC 0x00803117
00803113 : LEA EAX,[ESP + 0x58]
00803117 : MOV ECX,dword ptr [ESP + 0x68]
0080311b : LEA ECX,[EAX + ECX*0x2]
0080311e : MOV EDI,ESI
00803120 : CMP EDX,0x8
00803123 : JNC 0x00803135
00803125 : LEA EDI,[ESP + 0x58]
00803129 : MOV EDX,EDI
0080312b : XOR ESI,ESI
0080312d : CMP EDI,ESI
0080312f : JNZ 0x00803139
00803131 : XOR EAX,EAX
00803133 : JMP 0x0080313f
00803135 : MOV EDX,ESI
00803137 : JMP 0x0080312b
00803139 : MOV EAX,EDI
0080313b : SUB EAX,EDX
0080313d : SAR EAX,0x1
0080313f : CMP ECX,ESI
00803141 : JNZ 0x00803147
00803143 : XOR ECX,ECX
00803145 : JMP 0x0080314b
00803147 : SUB ECX,EDI
00803149 : SAR ECX,0x1
0080314b : PUSH ECX
0080314c : PUSH EAX
0080314d : LEA ECX,[ESP + 0x5c]
00803151 : CALL 0x00405e10
00803156 : MOV EDX,dword ptr [ESP + 0x24]
0080315a : PUSH EDX
0080315b : LEA EAX,[ESP + 0x3c]
0080315f : PUSH EAX
00803160 : MOV ECX,EBX
00803162 : CALL 0x00403450
00803167 : ADD ESP,0x8
0080316a : MOV byte ptr [ESP + 0x80],0x1
00803172 : PUSH -0x1
00803174 : PUSH ESI
00803175 : PUSH EAX
00803176 : LEA ECX,[ESP + 0x60]
0080317a : CALL 0x00405eb0
0080317f : MOV byte ptr [ESP + 0x80],0x0
00803187 : CMP dword ptr [ESP + 0x50],0x8
0080318c : JC 0x00803197
0080318e : MOV ECX,dword ptr [ESP + 0x3c]
00803192 : CALL 0x006f04e0
00803197 : SUB ESP,0x1c
0080319a : XOR ECX,ECX
0080319c : MOV dword ptr [ESP + 0x4c],ESP
008031a0 : MOV EAX,0x7
008031a5 : MOV word ptr [ESP + 0x58],CX
008031aa : MOV ECX,ESP
008031ac : PUSH -0x1
008031ae : MOV dword ptr [ECX + 0x18],EAX
008031b1 : MOV dword ptr [ESP + 0x70],EAX
008031b5 : PUSH ESI
008031b6 : LEA EAX,[ESP + 0x78]
008031ba : XOR EDX,EDX
008031bc : MOV dword ptr [ECX + 0x14],ESI
008031bf : PUSH EAX
008031c0 : MOV dword ptr [ESP + 0x74],ESI
008031c4 : MOV word ptr [ECX + 0x4],DX
008031c8 : CALL 0x00405eb0
008031cd : MOV byte ptr [ESP + 0x9c],0x2
008031d5 : MOV ECX,dword ptr [ESP + 0x3c]
008031d9 : PUSH ECX
008031da : MOV byte ptr [ESP + 0xa0],0x0
008031e2 : CALL 0x00a5f840
008031e7 : CMP EAX,ESI
008031e9 : JNZ 0x008032a2
008031ef : MOV EDX,dword ptr [ESP + 0x18]
008031f3 : ADD EBX,0x1c
008031f6 : CMP EBX,dword ptr [EDX + 0x8]
008031f9 : JNZ 0x00803104
008031ff : MOV ESI,dword ptr [ESP + 0x28]
00803203 : MOV EDI,dword ptr [ESP + 0x14]
00803207 : ADD EDI,0x4
0080320a : MOV dword ptr [ESP + 0x14],EDI
0080320e : CMP EDI,dword ptr [ESI + 0xa0]
00803214 : JNZ 0x008030c2
0080321a : MOV EDI,dword ptr [ESI + 0xac]
00803220 : MOV dword ptr [ESP + 0x14],EDI
00803224 : CMP EDI,dword ptr [ESI + 0xb0]
0080322a : JZ 0x008033bb
00803230 : PUSH EDI
00803231 : LEA EAX,[ESP + 0x34]
00803235 : LEA ECX,[ESI + 0x48]
00803238 : CALL 0x004437f0
0080323d : MOV EAX,dword ptr [EAX]
0080323f : CMP EAX,dword ptr [ESI + 0x4c]
00803242 : JZ 0x008033a8
00803248 : MOV ECX,dword ptr [EDI]
0080324a : MOV EAX,dword ptr [EAX + 0x10]
0080324d : MOV dword ptr [ESP + 0x20],ECX
00803251 : MOV dword ptr [ESP + 0x18],EAX
00803255 : TEST ECX,ECX
00803257 : JZ 0x008033a8
0080325d : TEST EAX,EAX
0080325f : JZ 0x008033a8
00803265 : MOV EBX,dword ptr [EAX + 0x4]
00803268 : CMP EBX,dword ptr [EAX + 0x8]
0080326b : JZ 0x008033a8
00803271 : MOV EDX,dword ptr [ESP + 0x6c]
00803275 : MOV ESI,dword ptr [ESP + 0x58]
00803279 : MOV EAX,ESI
0080327b : CMP EDX,0x8
0080327e : JNC 0x00803284
00803280 : LEA EAX,[ESP + 0x58]
00803284 : MOV ECX,dword ptr [ESP + 0x68]
00803288 : LEA ECX,[EAX + ECX*0x2]
0080328b : MOV EDI,ESI
0080328d : CMP EDX,0x8
00803290 : JNC 0x008032d8
00803292 : LEA EDI,[ESP + 0x58]
00803296 : MOV EDX,EDI
00803298 : XOR ESI,ESI
0080329a : CMP EDI,ESI
0080329c : JNZ 0x008032dc
0080329e : XOR EAX,EAX
008032a0 : JMP 0x008032e2
008032a2 : MOV ESI,dword ptr [ESP + 0x1c]
008032a6 : MOV EDI,EAX
008032a8 : CALL 0x00449300
008032ad : MOV BL,AL
008032af : MOV dword ptr [ESP + 0x80],0xffffffff
008032ba : CMP dword ptr [ESP + 0x6c],0x8
008032bf : JC 0x008032ca
008032c1 : MOV ECX,dword ptr [ESP + 0x58]
008032c5 : CALL 0x006f04e0
008032ca : XOR EAX,EAX
008032cc : MOV word ptr [ESP + 0x58],AX
008032d1 : MOV AL,BL
008032d3 : JMP 0x008033df
008032d8 : MOV EDX,ESI
008032da : JMP 0x00803298
008032dc : MOV EAX,EDI
008032de : SUB EAX,EDX
008032e0 : SAR EAX,0x1
008032e2 : CMP ECX,ESI
008032e4 : JNZ 0x008032ea
008032e6 : XOR ECX,ECX
008032e8 : JMP 0x008032ee
008032ea : SUB ECX,EDI
008032ec : SAR ECX,0x1
008032ee : PUSH ECX
008032ef : PUSH EAX
008032f0 : LEA ECX,[ESP + 0x5c]
008032f4 : CALL 0x00405e10
008032f9 : MOV EDX,dword ptr [ESP + 0x24]
008032fd : PUSH EDX
008032fe : LEA EAX,[ESP + 0x3c]
00803302 : PUSH EAX
00803303 : MOV ECX,EBX
00803305 : CALL 0x00403450
0080330a : ADD ESP,0x8
0080330d : MOV byte ptr [ESP + 0x80],0x3
00803315 : PUSH -0x1
00803317 : PUSH ESI
00803318 : PUSH EAX
00803319 : LEA ECX,[ESP + 0x60]
0080331d : CALL 0x00405eb0
00803322 : MOV byte ptr [ESP + 0x80],0x0
0080332a : CMP dword ptr [ESP + 0x50],0x8
0080332f : JC 0x0080333a
00803331 : MOV ECX,dword ptr [ESP + 0x3c]
00803335 : CALL 0x006f04e0
0080333a : SUB ESP,0x1c
0080333d : XOR ECX,ECX
0080333f : MOV dword ptr [ESP + 0x48],ESP
00803343 : MOV EAX,0x7
00803348 : MOV word ptr [ESP + 0x58],CX
0080334d : MOV ECX,ESP
0080334f : PUSH -0x1
00803351 : MOV dword ptr [ECX + 0x18],EAX
00803354 : MOV dword ptr [ESP + 0x70],EAX
00803358 : PUSH ESI
00803359 : LEA EAX,[ESP + 0x78]
0080335d : XOR EDX,EDX
0080335f : MOV dword ptr [ECX + 0x14],ESI
00803362 : PUSH EAX
00803363 : MOV dword ptr [ESP + 0x74],ESI
00803367 : MOV word ptr [ECX + 0x4],DX
0080336b : CALL 0x00405eb0
00803370 : MOV byte ptr [ESP + 0x9c],0x4
00803378 : MOV ECX,dword ptr [ESP + 0x3c]
0080337c : PUSH ECX
0080337d : MOV byte ptr [ESP + 0xa0],0x0
00803385 : CALL 0x00a5f840
0080338a : MOV EDI,EAX
0080338c : CMP EDI,ESI
0080338e : JNZ 0x0080340f
00803390 : MOV EDX,dword ptr [ESP + 0x18]
00803394 : ADD EBX,0x1c
00803397 : CMP EBX,dword ptr [EDX + 0x8]
0080339a : JNZ 0x00803271
008033a0 : MOV EDI,dword ptr [ESP + 0x14]
008033a4 : MOV ESI,dword ptr [ESP + 0x28]
008033a8 : ADD EDI,0x4
008033ab : MOV dword ptr [ESP + 0x14],EDI
008033af : CMP EDI,dword ptr [ESI + 0xb0]
008033b5 : JNZ 0x00803230
008033bb : MOV dword ptr [ESP + 0x80],0xffffffff
008033c6 : CMP dword ptr [ESP + 0x6c],0x8
008033cb : JC 0x008033d6
008033cd : MOV ECX,dword ptr [ESP + 0x58]
008033d1 : CALL 0x006f04e0
008033d6 : XOR EAX,EAX
008033d8 : MOV word ptr [ESP + 0x58],AX
008033dd : XOR AL,AL
008033df : MOV dword ptr [ESP + 0x68],0x0
008033e7 : MOV dword ptr [ESP + 0x6c],0x7
008033ef : MOV ECX,dword ptr [ESP + 0x78]
008033f3 : MOV dword ptr FS:[0x0],ECX
008033fa : POP ECX
008033fb : POP EDI
008033fc : POP ESI
008033fd : POP EBX
008033fe : MOV ECX,dword ptr [ESP + 0x60]
00803402 : XOR ECX,ESP
00803404 : CALL 0x00633e6b
00803409 : MOV ESP,EBP
0080340b : POP EBP
0080340c : RET 0x4
0080340f : MOV ECX,EDI
00803411 : CALL 0x00714100
00803416 : MOV ECX,dword ptr [ESP + 0x1c]
0080341a : CMP byte ptr [EDI + 0xd4],0x0
00803421 : MOV EBX,dword ptr [EDI + 0x60]
00803424 : MOV ESI,EAX
00803426 : MOV EAX,dword ptr [ECX]
00803428 : MOV EDX,dword ptr [EAX + 0x8]
0080342b : SETNZ byte ptr [ESP + 0x13]
00803430 : CALL EDX
00803432 : MOV EAX,dword ptr [ESP + 0x1c]
00803436 : MOV CL,byte ptr [ESP + 0x13]
0080343a : MOV dword ptr [EAX + 0x1c],ESI
0080343d : XOR ESI,ESI
0080343f : MOV dword ptr [EAX + 0x20],EBX
00803442 : MOV dword ptr [EAX + 0x24],ESI
00803445 : MOV byte ptr [EAX + 0x4],0x1
00803449 : MOV byte ptr [EAX + 0x50],CL
0080344c : MOV dword ptr [EAX + 0xc],EDI
0080344f : MOV dword ptr [EAX + 0x8],0x846510
00803456 : MOV dword ptr [ESP + 0x80],0xffffffff
00803461 : CMP dword ptr [ESP + 0x6c],0x8
00803466 : JC 0x00803471
00803468 : MOV ECX,dword ptr [ESP + 0x58]
0080346c : CALL 0x006f04e0
00803471 : XOR EDX,EDX
00803473 : MOV dword ptr [ESP + 0x68],ESI
00803477 : MOV word ptr [ESP + 0x58],DX
0080347c : MOV AL,0x1
0080347e : JMP 0x008033e7

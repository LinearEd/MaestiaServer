PROGRAM  : Maestia.exe
FUNCTION : FUN_008e6a60
ENTRY    : 008e6a60
BODY     : [[008e6a60, 008e6e2f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008e6a60(void)

{
  int *piVar1;
  int *in_ECX;
  uint uVar2;
  int iVar3;
  int iVar4;
  uint local_48;
  int local_3c;
  undefined1 local_30 [4];
  uint local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4a311;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (in_ECX[0x17] != 0) {
    iVar3 = *DAT_00da9894;
    if ((iVar3 != 0) && (*(int *)(iVar3 + 0x114) != 0)) {
      (**(code **)(**(int **)(iVar3 + 0x114) + 4))();
    }
    iVar3 = *DAT_00da9894;
    if ((iVar3 != 0) && (*(int *)(iVar3 + 0x114) != 0)) {
      (**(code **)(**(int **)(iVar3 + 0x114) + 4))();
    }
    iVar3 = *DAT_00da9894;
    if ((iVar3 != 0) && (*(int *)(iVar3 + 0x114) != 0)) {
      (**(code **)(**(int **)(iVar3 + 0x114) + 4))();
    }
    iVar3 = *DAT_00da9894;
    if ((iVar3 != 0) && (*(int *)(iVar3 + 0x114) != 0)) {
      piVar1 = *(int **)(iVar3 + 0x114);
      FUN_0070c2d0();
      local_8 = 0;
      (**(code **)(*piVar1 + 4))();
      local_8 = 0xffffffff;
      FUN_00406560();
    }
    iVar4 = *(int *)(in_ECX[0x17] + 0xcc) - *(int *)(in_ECX[0x17] + 200) >> 2;
    FUN_008e64c0();
    iVar3 = 0;
    if (0 < iVar4) {
      do {
        if (*(int *)(*(int *)(in_ECX[0x17] + 200) + iVar3 * 4) != 0) {
          (**(code **)(*in_ECX + 0x70))();
        }
        iVar3 = iVar3 + 1;
      } while (iVar3 < iVar4);
    }
    if (*(int *)(in_ECX[0x17] + 0xcc) - *(int *)(in_ECX[0x17] + 200) >> 2 != 0) {
      uVar2 = 0;
      local_3c = 0xb0;
      do {
        iVar3 = in_ECX[0x17];
        if (((*(int *)(iVar3 + local_3c) != 0) &&
            (uVar2 < (uint)(*(int *)(iVar3 + 0xcc) - *(int *)(iVar3 + 200) >> 2))) &&
           (*(int *)(*(int *)(iVar3 + 200) + uVar2 * 4) != 0)) {
          piVar1 = (int *)**(int **)(*(int *)(iVar3 + 200) + uVar2 * 4);
          uVar2 = uVar2 + 1;
          if (piVar1 != (int *)0x0) {
            local_18 = 7;
            local_1c = 0;
            local_2c = local_2c & 0xffff0000;
            local_8 = 1;
            (**(code **)(*in_ECX + 0x58))();
            FUN_00405eb0(local_30,0,0xffffffff);
            local_8._1_3_ = (undefined3)((uint)local_8 >> 8);
            local_8._0_1_ = 1;
            FUN_008f75f0();
            local_8._0_1_ = 3;
            FUN_00405eb0();
            local_8 = CONCAT31(local_8._1_3_,1);
            if (7 < local_48) {
                    /* WARNING: Subroutine does not return */
              FUN_006f04e0();
            }
            local_48 = 7;
            iVar3 = *DAT_00da9894;
            if ((iVar3 != 0) && (*(int *)(iVar3 + 0x114) != 0)) {
              iVar3 = **(int **)(iVar3 + 0x114);
              (**(code **)(*piVar1 + 0x40))();
              (**(code **)(iVar3 + 4))();
            }
            FUN_00a08b70();
            iVar3 = *DAT_00da9894;
            if ((iVar3 != 0) && (*(int *)(iVar3 + 0x114) != 0)) {
              (**(code **)(**(int **)(iVar3 + 0x114) + 4))();
            }
            local_8 = 0xffffffff;
            if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
              FUN_006f04e0();
            }
            local_2c = local_2c & 0xffff0000;
            local_18 = 7;
            local_1c = 0;
          }
        }
        local_3c = local_3c + 4;
      } while (local_3c < 0xc0);
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008e6a60 : PUSH EBP
008e6a61 : MOV EBP,ESP
008e6a63 : PUSH -0x1
008e6a65 : PUSH 0xb4a311
008e6a6a : MOV EAX,FS:[0x0]
008e6a70 : PUSH EAX
008e6a71 : SUB ESP,0x54
008e6a74 : MOV EAX,[0x00d66fa0]
008e6a79 : XOR EAX,EBP
008e6a7b : MOV dword ptr [EBP + -0x10],EAX
008e6a7e : PUSH EBX
008e6a7f : PUSH ESI
008e6a80 : PUSH EDI
008e6a81 : PUSH EAX
008e6a82 : LEA EAX,[EBP + -0xc]
008e6a85 : MOV FS:[0x0],EAX
008e6a8b : MOV EDI,ECX
008e6a8d : MOV ECX,dword ptr [EDI + 0x5c]
008e6a90 : MOV dword ptr [EBP + -0x3c],EDI
008e6a93 : TEST ECX,ECX
008e6a95 : JZ 0x008e6e14
008e6a9b : MOV EAX,[0x00da9894]
008e6aa0 : MOV EAX,dword ptr [EAX]
008e6aa2 : TEST EAX,EAX
008e6aa4 : JZ 0x008e6adf
008e6aa6 : CMP dword ptr [EAX + 0x114],0x0
008e6aad : JZ 0x008e6adf
008e6aaf : MOV EAX,dword ptr [EAX + 0x114]
008e6ab5 : MOV EBX,0x8
008e6aba : CMP dword ptr [ECX + 0x38],EBX
008e6abd : JC 0x008e6ac4
008e6abf : MOV ECX,dword ptr [ECX + 0x24]
008e6ac2 : JMP 0x008e6ac7
008e6ac4 : ADD ECX,0x24
008e6ac7 : MOV EDX,dword ptr [EAX]
008e6ac9 : PUSH ECX
008e6aca : PUSH 0xc5a29c
008e6acf : PUSH 0xc5a2a0
008e6ad4 : PUSH EAX
008e6ad5 : MOV EAX,dword ptr [EDX + 0x4]
008e6ad8 : CALL EAX
008e6ada : ADD ESP,0x10
008e6add : JMP 0x008e6ae4
008e6adf : MOV EBX,0x8
008e6ae4 : MOV ECX,dword ptr [0x00da9894]
008e6aea : MOV EAX,dword ptr [ECX]
008e6aec : TEST EAX,EAX
008e6aee : JZ 0x008e6b28
008e6af0 : CMP dword ptr [EAX + 0x114],0x0
008e6af7 : JZ 0x008e6b28
008e6af9 : MOV ECX,dword ptr [EAX + 0x114]
008e6aff : MOV EAX,dword ptr [EDI + 0x5c]
008e6b02 : ADD EAX,0x4
008e6b05 : CMP dword ptr [EAX + 0x18],EBX
008e6b08 : JC 0x008e6b0f
008e6b0a : MOV EAX,dword ptr [EAX + 0x4]
008e6b0d : JMP 0x008e6b12
008e6b0f : ADD EAX,0x4
008e6b12 : MOV EDX,dword ptr [ECX]
008e6b14 : PUSH EAX
008e6b15 : MOV EAX,dword ptr [EDX + 0x4]
008e6b18 : PUSH 0xc5a2b0
008e6b1d : PUSH 0xc5a2b4
008e6b22 : PUSH ECX
008e6b23 : CALL EAX
008e6b25 : ADD ESP,0x10
008e6b28 : MOV ECX,dword ptr [0x00da9894]
008e6b2e : MOV EAX,dword ptr [ECX]
008e6b30 : TEST EAX,EAX
008e6b32 : JZ 0x008e6b6e
008e6b34 : CMP dword ptr [EAX + 0x114],0x0
008e6b3b : JZ 0x008e6b6e
008e6b3d : MOV ECX,dword ptr [EAX + 0x114]
008e6b43 : MOV EAX,dword ptr [EDI + 0x5c]
008e6b46 : ADD EAX,0x84
008e6b4b : CMP dword ptr [EAX + 0x18],EBX
008e6b4e : JC 0x008e6b55
008e6b50 : MOV EAX,dword ptr [EAX + 0x4]
008e6b53 : JMP 0x008e6b58
008e6b55 : ADD EAX,0x4
008e6b58 : MOV EDX,dword ptr [ECX]
008e6b5a : PUSH EAX
008e6b5b : MOV EAX,dword ptr [EDX + 0x4]
008e6b5e : PUSH 0xc5a2c4
008e6b63 : PUSH 0xc5a2c8
008e6b68 : PUSH ECX
008e6b69 : CALL EAX
008e6b6b : ADD ESP,0x10
008e6b6e : MOV ECX,dword ptr [0x00da9894]
008e6b74 : MOV EAX,dword ptr [ECX]
008e6b76 : TEST EAX,EAX
008e6b78 : JZ 0x008e6bd9
008e6b7a : CMP dword ptr [EAX + 0x114],0x0
008e6b81 : JZ 0x008e6bd9
008e6b83 : MOV EDX,dword ptr [EDI + 0x5c]
008e6b86 : MOV ESI,dword ptr [EAX + 0x114]
008e6b8c : MOV EAX,dword ptr [EDX + 0xa8]
008e6b92 : PUSH 0x0
008e6b94 : PUSH EAX
008e6b95 : LEA ECX,[EBP + -0x5c]
008e6b98 : CALL 0x0070c2d0
008e6b9d : ADD ESP,0x8
008e6ba0 : MOV dword ptr [EBP + -0x4],0x0
008e6ba7 : CMP dword ptr [EAX + 0x18],EBX
008e6baa : JC 0x008e6bb1
008e6bac : MOV EAX,dword ptr [EAX + 0x4]
008e6baf : JMP 0x008e6bb4
008e6bb1 : ADD EAX,0x4
008e6bb4 : MOV ECX,dword ptr [ESI]
008e6bb6 : MOV EDX,dword ptr [ECX + 0x4]
008e6bb9 : PUSH EAX
008e6bba : PUSH 0xc5a2d8
008e6bbf : PUSH 0xc5a2dc
008e6bc4 : PUSH ESI
008e6bc5 : CALL EDX
008e6bc7 : ADD ESP,0x10
008e6bca : MOV dword ptr [EBP + -0x4],0xffffffff
008e6bd1 : LEA ECX,[EBP + -0x5c]
008e6bd4 : CALL 0x00406560
008e6bd9 : MOV EAX,dword ptr [EDI + 0x5c]
008e6bdc : MOV ESI,dword ptr [EAX + 0xcc]
008e6be2 : SUB ESI,dword ptr [EAX + 0xc8]
008e6be8 : ADD EAX,0xc4
008e6bed : SAR ESI,0x2
008e6bf0 : CALL 0x008e64c0
008e6bf5 : XOR EBX,EBX
008e6bf7 : TEST ESI,ESI
008e6bf9 : JLE 0x008e6c26
008e6bfb : MOV EAX,dword ptr [EDI + 0x5c]
008e6bfe : MOV ECX,dword ptr [EAX + 0xc8]
008e6c04 : MOV EAX,dword ptr [ECX + EBX*0x4]
008e6c07 : TEST EAX,EAX
008e6c09 : JZ 0x008e6c21
008e6c0b : MOVZX ECX,word ptr [EAX + 0x8]
008e6c0f : MOV EDX,dword ptr [EDI]
008e6c11 : MOV EDX,dword ptr [EDX + 0x70]
008e6c14 : PUSH ECX
008e6c15 : MOVZX ECX,word ptr [EAX + 0x4]
008e6c19 : MOV EAX,dword ptr [EAX]
008e6c1b : PUSH ECX
008e6c1c : PUSH EAX
008e6c1d : MOV ECX,EDI
008e6c1f : CALL EDX
008e6c21 : INC EBX
008e6c22 : CMP EBX,ESI
008e6c24 : JL 0x008e6bfb
008e6c26 : MOV EAX,dword ptr [EDI + 0x5c]
008e6c29 : MOV ECX,dword ptr [EAX + 0xcc]
008e6c2f : SUB ECX,dword ptr [EAX + 0xc8]
008e6c35 : ADD EAX,0xc4
008e6c3a : SAR ECX,0x2
008e6c3d : TEST ECX,ECX
008e6c3f : JBE 0x008e6e14
008e6c45 : XOR ECX,ECX
008e6c47 : MOV EDX,0xb0
008e6c4c : MOV dword ptr [EBP + -0x30],ECX
008e6c4f : MOV dword ptr [EBP + -0x38],EDX
008e6c52 : MOV EAX,dword ptr [EDI + 0x5c]
008e6c55 : CMP dword ptr [EAX + EDX*0x1],0x0
008e6c59 : JZ 0x008e6dff
008e6c5f : MOV ESI,dword ptr [EAX + 0xcc]
008e6c65 : SUB ESI,dword ptr [EAX + 0xc8]
008e6c6b : SAR ESI,0x2
008e6c6e : CMP ESI,ECX
008e6c70 : JBE 0x008e6dff
008e6c76 : MOV EAX,dword ptr [EAX + 0xc8]
008e6c7c : CMP dword ptr [EAX + ECX*0x4],0x0
008e6c80 : LEA EAX,[EAX + ECX*0x4]
008e6c83 : JZ 0x008e6dff
008e6c89 : MOV EAX,dword ptr [EAX]
008e6c8b : MOV ESI,dword ptr [EAX]
008e6c8d : INC ECX
008e6c8e : MOV dword ptr [EBP + -0x40],ECX
008e6c91 : TEST ESI,ESI
008e6c93 : JZ 0x008e6dff
008e6c99 : MOV EAX,dword ptr [ESI + 0x10]
008e6c9c : MOV EBX,0x7
008e6ca1 : XOR ECX,ECX
008e6ca3 : MOV dword ptr [EBP + -0x14],EBX
008e6ca6 : MOV dword ptr [EBP + -0x18],0x0
008e6cad : MOV word ptr [EBP + -0x28],CX
008e6cb1 : MOV dword ptr [EBP + -0x4],0x1
008e6cb8 : MOV EDX,dword ptr [EDI]
008e6cba : MOV EDX,dword ptr [EDX + 0x58]
008e6cbd : LEA ECX,[EBP + -0x2c]
008e6cc0 : PUSH ECX
008e6cc1 : PUSH EAX
008e6cc2 : MOV ECX,EDI
008e6cc4 : CALL EDX
008e6cc6 : SUB ESP,0x1c
008e6cc9 : MOV ECX,ESP
008e6ccb : MOV dword ptr [EBP + -0x34],ESP
008e6cce : MOV dword ptr [ECX + 0x18],EBX
008e6cd1 : PUSH -0x1
008e6cd3 : XOR EBX,EBX
008e6cd5 : PUSH EBX
008e6cd6 : LEA EDX,[EBP + -0x2c]
008e6cd9 : XOR EAX,EAX
008e6cdb : MOV dword ptr [ECX + 0x14],EBX
008e6cde : PUSH EDX
008e6cdf : MOV word ptr [ECX + 0x4],AX
008e6ce3 : CALL 0x00405eb0
008e6ce8 : MOV byte ptr [EBP + -0x4],0x2
008e6cec : MOV byte ptr [EBP + -0x4],0x1
008e6cf0 : LEA ECX,[EBP + -0x5c]
008e6cf3 : CALL 0x008f75f0
008e6cf8 : ADD ESP,0x1c
008e6cfb : MOV byte ptr [EBP + -0x4],0x3
008e6cff : PUSH -0x1
008e6d01 : PUSH EBX
008e6d02 : PUSH EAX
008e6d03 : LEA ECX,[EBP + -0x2c]
008e6d06 : CALL 0x00405eb0
008e6d0b : MOV byte ptr [EBP + -0x4],0x1
008e6d0f : CMP dword ptr [EBP + -0x44],0x8
008e6d13 : JC 0x008e6d1d
008e6d15 : MOV ECX,dword ptr [EBP + -0x58]
008e6d18 : CALL 0x006f04e0
008e6d1d : MOV ECX,dword ptr [0x00da9894]
008e6d23 : XOR EAX,EAX
008e6d25 : MOV dword ptr [EBP + -0x44],0x7
008e6d2c : MOV dword ptr [EBP + -0x48],EBX
008e6d2f : MOV word ptr [EBP + -0x58],AX
008e6d33 : MOV EAX,dword ptr [ECX]
008e6d35 : CMP EAX,EBX
008e6d37 : JZ 0x008e6d99
008e6d39 : CMP dword ptr [EAX + 0x114],EBX
008e6d3f : JZ 0x008e6d99
008e6d41 : MOV EBX,dword ptr [EAX + 0x114]
008e6d47 : MOV EAX,dword ptr [ESI + 0x120]
008e6d4d : SHR EAX,0x2
008e6d50 : AND EAX,0x1
008e6d53 : CMP dword ptr [EBP + -0x14],0x8
008e6d57 : JC 0x008e6d61
008e6d59 : MOV EDX,dword ptr [EBP + -0x28]
008e6d5c : MOV dword ptr [EBP + -0x34],EDX
008e6d5f : JMP 0x008e6d67
008e6d61 : LEA ECX,[EBP + -0x28]
008e6d64 : MOV dword ptr [EBP + -0x34],ECX
008e6d67 : MOV EDX,dword ptr [ESI]
008e6d69 : MOV EDI,dword ptr [EBX]
008e6d6b : PUSH EAX
008e6d6c : MOV EAX,dword ptr [EDX + 0x40]
008e6d6f : MOV ECX,ESI
008e6d71 : ADD EDI,0x4
008e6d74 : CALL EAX
008e6d76 : MOV EDX,dword ptr [EBP + -0x30]
008e6d79 : MOVZX ECX,AX
008e6d7c : MOV EAX,dword ptr [EBP + -0x34]
008e6d7f : PUSH ECX
008e6d80 : MOV ECX,dword ptr [EDI]
008e6d82 : PUSH EDX
008e6d83 : PUSH EAX
008e6d84 : PUSH 0xc5a2ec
008e6d89 : PUSH 0xc5a2fc
008e6d8e : PUSH EBX
008e6d8f : CALL ECX
008e6d91 : MOV EDI,dword ptr [EBP + -0x3c]
008e6d94 : ADD ESP,0x1c
008e6d97 : XOR EBX,EBX
008e6d99 : MOV ECX,ESI
008e6d9b : CALL 0x00a08b70
008e6da0 : MOV EDX,dword ptr [0x00da9894]
008e6da6 : MOV ECX,dword ptr [EDX]
008e6da8 : CMP ECX,EBX
008e6daa : JZ 0x008e6dd4
008e6dac : CMP dword ptr [ECX + 0x114],EBX
008e6db2 : JZ 0x008e6dd4
008e6db4 : MOV ECX,dword ptr [ECX + 0x114]
008e6dba : MOV EDX,dword ptr [ECX]
008e6dbc : PUSH EAX
008e6dbd : MOV EAX,dword ptr [EBP + -0x30]
008e6dc0 : PUSH EAX
008e6dc1 : PUSH 0xc5a310
008e6dc6 : PUSH 0xc5a318
008e6dcb : PUSH ECX
008e6dcc : MOV ECX,dword ptr [EDX + 0x4]
008e6dcf : CALL ECX
008e6dd1 : ADD ESP,0x14
008e6dd4 : MOV dword ptr [EBP + -0x4],0xffffffff
008e6ddb : CMP dword ptr [EBP + -0x14],0x8
008e6ddf : JC 0x008e6de9
008e6de1 : MOV ECX,dword ptr [EBP + -0x28]
008e6de4 : CALL 0x006f04e0
008e6de9 : MOV ECX,dword ptr [EBP + -0x40]
008e6dec : XOR EDX,EDX
008e6dee : MOV word ptr [EBP + -0x28],DX
008e6df2 : MOV EDX,dword ptr [EBP + -0x38]
008e6df5 : MOV dword ptr [EBP + -0x14],0x7
008e6dfc : MOV dword ptr [EBP + -0x18],EBX
008e6dff : INC dword ptr [EBP + -0x30]
008e6e02 : ADD EDX,0x4
008e6e05 : CMP EDX,0xc0
008e6e0b : MOV dword ptr [EBP + -0x38],EDX
008e6e0e : JL 0x008e6c52
008e6e14 : MOV ECX,dword ptr [EBP + -0xc]
008e6e17 : MOV dword ptr FS:[0x0],ECX
008e6e1e : POP ECX
008e6e1f : POP EDI
008e6e20 : POP ESI
008e6e21 : POP EBX
008e6e22 : MOV ECX,dword ptr [EBP + -0x10]
008e6e25 : XOR ECX,EBP
008e6e27 : CALL 0x00633e6b
008e6e2c : MOV ESP,EBP
008e6e2e : POP EBP
008e6e2f : RET

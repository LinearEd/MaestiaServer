PROGRAM  : Maestia.exe
FUNCTION : FUN_00ac0130
ENTRY    : 00ac0130
BODY     : [[00ac0130, 00ac0a0c]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00ac0130(int param_1,int param_2)

{
  short sVar1;
  int *piVar2;
  int *piVar3;
  char cVar4;
  undefined1 uVar5;
  uint uVar6;
  int iVar7;
  undefined4 uVar8;
  int iVar9;
  uint uVar10;
  int iVar11;
  int local_26c;
  uint uStack_268;
  uint local_264;
  undefined1 local_260 [28];
  undefined1 local_244;
  undefined1 uStack_243;
  undefined4 uStack_240;
  undefined4 uStack_23c;
  undefined2 uStack_238;
  undefined1 uStack_236;
  undefined4 uStack_234;
  undefined1 uStack_230;
  undefined **ppuStack_228;
  undefined1 auStack_220 [516];
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  int local_c;
  
  iVar11 = DAT_0172491c;
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b60446;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)&local_26c;
  uVar6 = DAT_00d66fa0 ^ (uint)&stack0xfffffd88;
  ExceptionList = &local_14;
  *(int *)(param_1 + 0x58) = param_2;
  iVar9 = DAT_00d7c54c;
  piVar2 = *(int **)(iVar11 + 0x178);
  if (piVar2 == (int *)0x0) goto LAB_00ac09e7;
  local_26c = param_2;
  FUN_004437f0(&local_26c);
  if (((local_264 == *(uint *)(iVar9 + 0x44)) ||
      (iVar9 = *(int *)(local_264 + 0x10), local_26c = iVar9, iVar9 == 0)) ||
     (cVar4 = FUN_00abfd00(uVar6), cVar4 == '\0')) goto LAB_00ac09e7;
  iVar7 = FUN_00406f20();
  if (((iVar7 != 0) && (*(uint *)(iVar7 + 0x1c0) < (uint)*(byte *)(iVar9 + 0x40))) &&
     ((*DAT_00da9894 != 0 && (*(int *)(*DAT_00da9894 + 0x1a8) != 0)))) {
    FUN_00406460(L"IDS_ERROR_OVER_LEVEL_ITEM_PREVIEW");
    local_c = 0;
    piVar3 = *(int **)(*DAT_00da9894 + 0x1a8);
    uVar8 = FUN_0081d120(&local_244);
    local_c._0_1_ = 1;
    (**(code **)(*piVar3 + 0x44))(uVar8,3);
    local_c = (uint)local_c._1_3_ << 8;
    FUN_00406560();
    local_c = 0xffffffff;
    FUN_00406560();
    iVar11 = DAT_0172491c;
  }
  uVar6 = FUN_006fec70();
  uVar6 = uVar6 & 0xff;
  if (*(int *)(*(int *)(iVar11 + 0x178) + 0x181c) == 0) {
    uVar8 = 0;
  }
  else {
    uVar8 = *(undefined4 *)(*(int *)(iVar11 + 0x178) + 0x1714);
  }
  local_264 = uVar6;
  iVar9 = FUN_004049b0(uVar8);
  if (iVar9 != 0) {
    uVar10 = *(uint *)(iVar9 + 0x28c);
    if (uVar6 == 2) {
      uVar10 = uVar10 >> 2;
    }
    else if (uVar6 == 4) {
      uVar10 = uVar10 >> 4;
    }
    else if (uVar6 == 9) {
      uVar10 = uVar10 >> 9;
    }
    else if (uVar6 == 5) {
      uVar10 = uVar10 >> 5;
    }
    else if (uVar6 == 7) {
      uVar10 = uVar10 >> 7;
    }
    else {
      if (uVar6 != 8) goto LAB_00ac0706;
      uVar10 = uVar10 >> 8;
    }
    if ((uVar10 & 1) != 0) {
      if (*(char *)((int)piVar2 + 0x65d) == '\0') {
        uStack_240 = 0;
        uStack_23c = 0;
        uStack_238 = 0;
        uStack_236 = 1;
        uStack_230 = 0;
        local_244 = 0;
        uStack_243 = 0xb;
        uStack_234 = 1;
        FUN_0041dea0(&local_244);
      }
      else {
        uStack_268 = 0;
        local_26c = FUN_00856e80(&uStack_268);
        if (piVar2[0x607] != 0) {
          piVar2[0x5c5] = 0;
          FUN_0085de20();
          FUN_0085dcf0();
          iVar9 = FUN_0085af40(&uStack_268,0);
          uVar6 = local_264;
          if (iVar9 != 0) {
            FUN_00406460(L"temp");
            local_c = 2;
            uVar5 = (**(code **)(*piVar2 + 0x21c))();
            FUN_0084e210(local_260,piVar2,1,0,1,uVar5);
            local_c = 0xffffffff;
            FUN_00406560();
            *(undefined4 *)(piVar2[0x607] + 0x28) = 0;
            FUN_0085b4d0(piVar2,0xb);
            uVar8 = FUN_0085a140();
            FUN_0085ad10(&local_244,0xb);
            local_c = 9;
            cVar4 = FUN_00403810();
            if (cVar4 != '\0') {
              FUN_00405c00(&local_244);
            }
            uVar5 = (**(code **)(*piVar2 + 0x21c))();
            FUN_0084e210(&local_244,piVar2,1,0,1,uVar5);
            *(undefined4 *)(piVar2[0x607] + 0x28) = uVar8;
            FUN_00861620();
            local_c = 0xffffffff;
            FUN_00406560();
            FUN_00406460(L"temp");
            local_c = 0xb;
            uVar5 = (**(code **)(*piVar2 + 0x21c))();
            FUN_0084e210(local_260,piVar2,1,0,1,uVar5);
            local_c = 0xffffffff;
            FUN_00406560();
            FUN_0085b4d0(piVar2,0xb);
            if (local_26c != 0) {
              if (((uStack_268 >> 0x1e & 1) != 0) && (iVar9 = FUN_00404440(), iVar9 != 0)) {
                FUN_0040e600();
                local_c = 0xc;
                FUN_00406e40(iVar9 + 0x40);
                FUN_00406460(auStack_220);
                local_c._0_1_ = 0xd;
                uVar5 = (**(code **)(*piVar2 + 0x21c))();
                FUN_0084e210(&local_244,piVar2,1,0,0,uVar5);
                local_c = CONCAT31(local_c._1_3_,0xc);
                FUN_00406560();
                local_c = 0xffffffff;
                ppuStack_228 = &PTR_FUN_00cd083c;
              }
              FUN_0085a780(piVar2,1,(char)piVar2[0x6af],1);
            }
            uStack_268 = 0;
            iVar9 = FUN_0085af40(&uStack_268,0);
            if (iVar9 != 0) {
              FUN_00862130(4);
            }
            if (((char)piVar2[0x6af] != '\0') && (iVar9 = FUN_0085af40(&uStack_268,0), iVar9 != 0))
            {
              FUN_00862130(2);
            }
            iVar9 = FUN_0085af40(&uStack_268,0);
            if (iVar9 != 0) {
              FUN_00862130(9);
            }
            iVar9 = FUN_0085af40(&uStack_268,0);
            if (iVar9 != 0) {
              FUN_00862130(5);
            }
            iVar9 = FUN_0085af40(&uStack_268,0);
            if (iVar9 != 0) {
              FUN_00862130(7);
            }
            iVar9 = FUN_0085af40(&uStack_268,0);
            if (iVar9 != 0) {
              FUN_00862130(8);
            }
            local_26c = 0x14;
            do {
              if (((local_26c != 0x14) || ((char)piVar2[0x6af] != '\0')) &&
                 (iVar9 = FUN_0085af40(&uStack_268,0), iVar9 != 0)) {
                FUN_00862130(local_26c);
              }
              local_26c = local_26c + 1;
            } while (local_26c < 0x1e);
            FUN_00862750(piVar2,1);
            uVar6 = local_264;
          }
        }
      }
    }
  }
LAB_00ac0706:
  if (uVar6 == 0) {
    if (param_2 != 0) {
      iVar9 = FUN_004049b0(param_2);
      if (*(short *)(iVar9 + 0x28a) == 5) {
        if (*(char *)((int)piVar2 + 0x65d) == '\0') {
LAB_00ac0826:
          uStack_243 = 1;
          goto LAB_00ac073a;
        }
        if (piVar2[0x5fd] == 0) {
          local_26c = 0;
        }
        else {
          local_26c = piVar2[0x5bb];
          piVar2[0x5bb] = 0;
          FUN_0085de20();
          FUN_0085dcf0();
          FUN_00406460(&DAT_00c3f468);
          local_c = 0x16;
LAB_00ac0883:
          FUN_0084ceb0(local_260,local_26c);
          local_c = 0xffffffff;
          FUN_00406560();
          *(undefined4 *)(piVar2[0x5fd] + 0x28) = 0;
          (**(code **)(*piVar2 + 0x48c))(0);
          FUN_00862750(piVar2,0);
          uVar6 = local_264;
        }
      }
      else {
        cVar4 = *(char *)(iVar9 + 0x288);
        if ((cVar4 == '\x02') || (cVar4 == '\b')) {
          if (*(char *)((int)piVar2 + 0x65d) == '\0') goto LAB_00ac0826;
          if (piVar2[0x5fd] != 0) {
            local_26c = piVar2[0x5bb];
            piVar2[0x5bb] = 0;
            FUN_0085de20();
            FUN_0085dcf0();
            FUN_00406460(&DAT_00c3f468);
            local_c = 0x22;
            goto LAB_00ac0883;
          }
          local_26c = 0;
        }
        else if ((cVar4 == '\x06') || (cVar4 == '\x04')) {
          if (*(char *)((int)piVar2 + 0x65d) == '\0') goto LAB_00ac0826;
          if (piVar2[0x5fd] != 0) {
            local_26c = piVar2[0x5bb];
            piVar2[0x5bb] = 0;
            FUN_0085de20();
            FUN_0085dcf0();
            FUN_00406460(&DAT_00c3f468);
            local_c = 0x2e;
            goto LAB_00ac0883;
          }
          local_26c = 0;
        }
      }
    }
  }
  else if (uVar6 == 1) {
    sVar1 = (short)piVar2[0x10f];
    if (sVar1 == 5) {
      if (*(char *)((int)piVar2 + 0x65d) == '\0') {
        uStack_243 = 0;
LAB_00ac073a:
        local_244 = 0;
        uStack_230 = 0;
        uStack_236 = 1;
        uStack_238 = 0;
        uStack_23c = 0;
        uStack_240 = 0;
        uStack_234 = 1;
        FUN_0041dea0(&local_244);
      }
      else if (piVar2[0x5fc] != 0) {
        piVar2[0x5ba] = 0;
        FUN_0085de20();
        FUN_0085dcf0();
        (**(code **)(*piVar2 + 0x49c))((short)piVar2[0x10f],1);
        (**(code **)(*piVar2 + 0x484))(0);
        FUN_00862750(piVar2,0);
        uVar6 = local_264;
      }
    }
    else if ((((sVar1 == 2) || (sVar1 == 8)) || (sVar1 == 6)) || (sVar1 == 4)) {
      FUN_008665a0(piVar2,0,0,0,1);
    }
  }
  else if ((uVar6 == 6) || (uVar6 == 3)) goto LAB_00ac09e7;
  FUN_008665a0(piVar2,uVar6,0,0,1);
  (**(code **)(*piVar2 + 0x490))(param_2,uVar6,1,0,0,0,1);
LAB_00ac09e7:
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)&local_26c);
  return;
}



============================================================
DISASSEMBLY
============================================================
00ac0130 : PUSH EBP
00ac0131 : MOV EBP,ESP
00ac0133 : AND ESP,0xfffffff8
00ac0136 : PUSH -0x1
00ac0138 : PUSH 0xb60446
00ac013d : MOV EAX,FS:[0x0]
00ac0143 : PUSH EAX
00ac0144 : SUB ESP,0x258
00ac014a : MOV EAX,[0x00d66fa0]
00ac014f : XOR EAX,ESP
00ac0151 : MOV dword ptr [ESP + 0x250],EAX
00ac0158 : PUSH EBX
00ac0159 : PUSH ESI
00ac015a : PUSH EDI
00ac015b : MOV EAX,[0x00d66fa0]
00ac0160 : XOR EAX,ESP
00ac0162 : PUSH EAX
00ac0163 : LEA EAX,[ESP + 0x268]
00ac016a : MOV FS:[0x0],EAX
00ac0170 : MOV EAX,dword ptr [EBP + 0x8]
00ac0173 : MOV ECX,dword ptr [EBP + 0xc]
00ac0176 : MOV EDI,dword ptr [0x0172491c]
00ac017c : MOV dword ptr [EAX + 0x58],ECX
00ac017f : MOV EBX,dword ptr [EDI + 0x178]
00ac0185 : TEST EBX,EBX
00ac0187 : JZ 0x00ac09e7
00ac018d : MOV ESI,dword ptr [0x00d7c54c]
00ac0193 : LEA EAX,[ESP + 0x10]
00ac0197 : MOV dword ptr [ESP + 0x10],ECX
00ac019b : PUSH EAX
00ac019c : LEA ECX,[ESI + 0x40]
00ac019f : LEA EAX,[ESP + 0x1c]
00ac01a3 : CALL 0x004437f0
00ac01a8 : MOV ESI,dword ptr [ESI + 0x44]
00ac01ab : MOV EAX,dword ptr [ESP + 0x18]
00ac01af : CMP EAX,ESI
00ac01b1 : JZ 0x00ac09e7
00ac01b7 : MOV ESI,dword ptr [EAX + 0x10]
00ac01ba : MOV dword ptr [ESP + 0x10],ESI
00ac01be : TEST ESI,ESI
00ac01c0 : JZ 0x00ac09e7
00ac01c6 : MOV ECX,dword ptr [EBP + 0xc]
00ac01c9 : CALL 0x00abfd00
00ac01ce : TEST AL,AL
00ac01d0 : JZ 0x00ac09e7
00ac01d6 : MOV EAX,dword ptr [EDI + 0x17c]
00ac01dc : MOV EAX,dword ptr [EAX + 0x16d8]
00ac01e2 : LEA ECX,[ESI + 0x128]
00ac01e8 : MOV EDX,EAX
00ac01ea : CALL 0x00406f20
00ac01ef : TEST EAX,EAX
00ac01f1 : JZ 0x00ac029b
00ac01f7 : MOVZX ECX,byte ptr [ESI + 0x40]
00ac01fb : CMP ECX,dword ptr [EAX + 0x1c0]
00ac0201 : JBE 0x00ac029b
00ac0207 : MOV EDX,dword ptr [0x00da9894]
00ac020d : MOV EAX,dword ptr [EDX]
00ac020f : TEST EAX,EAX
00ac0211 : JZ 0x00ac029b
00ac0217 : CMP dword ptr [EAX + 0x1a8],0x0
00ac021e : JZ 0x00ac029b
00ac0220 : PUSH 0xc710b8
00ac0225 : LEA ECX,[ESP + 0x3c]
00ac0229 : CALL 0x00406460
00ac022e : MOV dword ptr [ESP + 0x270],0x0
00ac0239 : MOV EAX,[0x00da9894]
00ac023e : MOV EAX,dword ptr [EAX]
00ac0240 : MOV ESI,dword ptr [EAX + 0x1a8]
00ac0246 : LEA ECX,[ESP + 0x38]
00ac024a : PUSH ECX
00ac024b : MOV ECX,dword ptr [0x0172491c]
00ac0251 : LEA EDI,[ESP + 0x20]
00ac0255 : CALL 0x0081d120
00ac025a : MOV byte ptr [ESP + 0x270],0x1
00ac0262 : MOV EDX,dword ptr [ESI]
00ac0264 : PUSH 0x3
00ac0266 : PUSH EAX
00ac0267 : MOV EAX,dword ptr [EDX + 0x44]
00ac026a : MOV ECX,ESI
00ac026c : CALL EAX
00ac026e : MOV byte ptr [ESP + 0x270],0x0
00ac0276 : MOV ECX,EDI
00ac0278 : CALL 0x00406560
00ac027d : MOV dword ptr [ESP + 0x270],0xffffffff
00ac0288 : LEA ECX,[ESP + 0x38]
00ac028c : CALL 0x00406560
00ac0291 : MOV EDI,dword ptr [0x0172491c]
00ac0297 : MOV ESI,dword ptr [ESP + 0x10]
00ac029b : MOV ECX,ESI
00ac029d : CALL 0x006fec70
00ac02a2 : MOV EDI,dword ptr [EDI + 0x178]
00ac02a8 : CMP dword ptr [EDI + 0x181c],0x0
00ac02af : MOVZX ESI,AL
00ac02b2 : MOV dword ptr [ESP + 0x18],ESI
00ac02b6 : JZ 0x00ac02c0
00ac02b8 : MOV EDI,dword ptr [EDI + 0x1714]
00ac02be : JMP 0x00ac02c2
00ac02c0 : XOR EDI,EDI
00ac02c2 : PUSH EDI
00ac02c3 : CALL 0x004049b0
00ac02c8 : ADD ESP,0x4
00ac02cb : TEST EAX,EAX
00ac02cd : JZ 0x00ac0706
00ac02d3 : MOV EAX,dword ptr [EAX + 0x28c]
00ac02d9 : CMP ESI,0x2
00ac02dc : JNZ 0x00ac02eb
00ac02de : SHR EAX,0x2
00ac02e1 : AND EAX,0x1
00ac02e4 : JNZ 0x00ac0348
00ac02e6 : JMP 0x00ac0706
00ac02eb : CMP ESI,0x4
00ac02ee : JNZ 0x00ac02fd
00ac02f0 : SHR EAX,0x4
00ac02f3 : AND EAX,0x1
00ac02f6 : JNZ 0x00ac0348
00ac02f8 : JMP 0x00ac0706
00ac02fd : CMP ESI,0x9
00ac0300 : JNZ 0x00ac030f
00ac0302 : SHR EAX,0x9
00ac0305 : AND EAX,0x1
00ac0308 : JNZ 0x00ac0348
00ac030a : JMP 0x00ac0706
00ac030f : CMP ESI,0x5
00ac0312 : JNZ 0x00ac0321
00ac0314 : SHR EAX,0x5
00ac0317 : AND EAX,0x1
00ac031a : JNZ 0x00ac0348
00ac031c : JMP 0x00ac0706
00ac0321 : CMP ESI,0x7
00ac0324 : JNZ 0x00ac0333
00ac0326 : SHR EAX,0x7
00ac0329 : AND EAX,0x1
00ac032c : JNZ 0x00ac0348
00ac032e : JMP 0x00ac0706
00ac0333 : CMP ESI,0x8
00ac0336 : JNZ 0x00ac0706
00ac033c : SHR EAX,0x8
00ac033f : AND EAX,0x1
00ac0342 : JZ 0x00ac0706
00ac0348 : CMP byte ptr [EBX + 0x65d],0x0
00ac034f : JNZ 0x00ac0391
00ac0351 : XOR EAX,EAX
00ac0353 : XOR ECX,ECX
00ac0355 : LEA EDX,[ESP + 0x38]
00ac0359 : MOV dword ptr [ESP + 0x3c],EAX
00ac035d : MOV dword ptr [ESP + 0x40],EAX
00ac0361 : PUSH EDX
00ac0362 : LEA EAX,[EBX + 0x19a4]
00ac0368 : MOV word ptr [ESP + 0x48],CX
00ac036d : MOV byte ptr [ESP + 0x4a],0x1
00ac0372 : MOV byte ptr [ESP + 0x50],CL
00ac0376 : MOV byte ptr [ESP + 0x3c],CL
00ac037a : MOV byte ptr [ESP + 0x3d],0xb
00ac037f : MOV dword ptr [ESP + 0x4c],0x1
00ac0387 : CALL 0x0041dea0
00ac038c : JMP 0x00ac0706
00ac0391 : LEA EAX,[ESP + 0x14]
00ac0395 : PUSH EAX
00ac0396 : MOV EAX,EBX
00ac0398 : MOV dword ptr [ESP + 0x18],0x0
00ac03a0 : CALL 0x00856e80
00ac03a5 : CMP dword ptr [EBX + 0x181c],0x0
00ac03ac : MOV dword ptr [ESP + 0x10],EAX
00ac03b0 : JZ 0x00ac0706
00ac03b6 : MOV EDI,EBX
00ac03b8 : MOV dword ptr [EBX + 0x1714],0x0
00ac03c2 : CALL 0x0085de20
00ac03c7 : MOV ESI,EBX
00ac03c9 : CALL 0x0085dcf0
00ac03ce : LEA ECX,[ESP + 0x14]
00ac03d2 : PUSH 0x0
00ac03d4 : PUSH ECX
00ac03d5 : MOV CL,0xb
00ac03d7 : CALL 0x0085af40
00ac03dc : TEST EAX,EAX
00ac03de : JZ 0x00ac0702
00ac03e4 : PUSH 0xc3f444
00ac03e9 : LEA ECX,[ESP + 0x20]
00ac03ed : CALL 0x00406460
00ac03f2 : MOV dword ptr [ESP + 0x270],0x2
00ac03fd : MOV EDX,dword ptr [EBX]
00ac03ff : MOV EAX,dword ptr [EDX + 0x21c]
00ac0405 : MOV ECX,EBX
00ac0407 : CALL EAX
00ac0409 : MOVZX ECX,AL
00ac040c : PUSH ECX
00ac040d : MOV ECX,dword ptr [EBX + 0x181c]
00ac0413 : PUSH 0x1
00ac0415 : PUSH 0x0
00ac0417 : PUSH 0x1
00ac0419 : PUSH EBX
00ac041a : LEA EDX,[ESP + 0x30]
00ac041e : PUSH EDX
00ac041f : CALL 0x0084e210
00ac0424 : MOV dword ptr [ESP + 0x270],0xffffffff
00ac042f : LEA ECX,[ESP + 0x1c]
00ac0433 : CALL 0x00406560
00ac0438 : MOV EAX,dword ptr [EBX + 0x181c]
00ac043e : PUSH 0xb
00ac0440 : PUSH EBX
00ac0441 : MOV dword ptr [EAX + 0x28],0x0
00ac0448 : CALL 0x0085b4d0
00ac044d : MOV AL,0xb
00ac044f : CALL 0x0085a140
00ac0454 : MOV EDI,EAX
00ac0456 : PUSH 0xb
00ac0458 : LEA EAX,[ESP + 0x3c]
00ac045c : PUSH EAX
00ac045d : MOV ECX,EDI
00ac045f : MOV EDX,EBX
00ac0461 : CALL 0x0085ad10
00ac0466 : MOV dword ptr [ESP + 0x270],0x9
00ac0471 : MOV ESI,0xc3f454
00ac0476 : LEA ECX,[ESP + 0x38]
00ac047a : CALL 0x00403810
00ac047f : TEST AL,AL
00ac0481 : JZ 0x00ac0492
00ac0483 : LEA ECX,[ESP + 0x38]
00ac0487 : PUSH ECX
00ac0488 : MOV EDX,0xc3f458
00ac048d : CALL 0x00405c00
00ac0492 : MOV EDX,dword ptr [EBX]
00ac0494 : MOV EAX,dword ptr [EDX + 0x21c]
00ac049a : MOV ECX,EBX
00ac049c : CALL EAX
00ac049e : MOVZX ECX,AL
00ac04a1 : PUSH ECX
00ac04a2 : MOV ECX,dword ptr [EBX + 0x181c]
00ac04a8 : PUSH 0x1
00ac04aa : PUSH 0x0
00ac04ac : PUSH 0x1
00ac04ae : PUSH EBX
00ac04af : LEA EDX,[ESP + 0x4c]
00ac04b3 : PUSH EDX
00ac04b4 : CALL 0x0084e210
00ac04b9 : MOV EAX,dword ptr [EBX + 0x181c]
00ac04bf : MOV dword ptr [EAX + 0x28],EDI
00ac04c2 : CALL 0x00861620
00ac04c7 : OR ESI,0xffffffff
00ac04ca : MOV dword ptr [ESP + 0x270],ESI
00ac04d1 : LEA ECX,[ESP + 0x38]
00ac04d5 : CALL 0x00406560
00ac04da : PUSH 0xc3f46c
00ac04df : LEA ECX,[ESP + 0x20]
00ac04e3 : CALL 0x00406460
00ac04e8 : MOV dword ptr [ESP + 0x270],0xb
00ac04f3 : MOV EAX,dword ptr [EBX]
00ac04f5 : MOV EDX,dword ptr [EAX + 0x21c]
00ac04fb : MOV ECX,EBX
00ac04fd : CALL EDX
00ac04ff : MOVZX EAX,AL
00ac0502 : PUSH EAX
00ac0503 : PUSH 0x1
00ac0505 : PUSH 0x0
00ac0507 : PUSH 0x1
00ac0509 : PUSH EBX
00ac050a : LEA ECX,[ESP + 0x30]
00ac050e : PUSH ECX
00ac050f : MOV ECX,dword ptr [EBX + 0x181c]
00ac0515 : CALL 0x0084e210
00ac051a : MOV dword ptr [ESP + 0x270],ESI
00ac0521 : LEA ECX,[ESP + 0x1c]
00ac0525 : CALL 0x00406560
00ac052a : PUSH 0xb
00ac052c : PUSH EBX
00ac052d : CALL 0x0085b4d0
00ac0532 : CMP dword ptr [ESP + 0x10],0x0
00ac0537 : JBE 0x00ac05f5
00ac053d : MOV EDX,dword ptr [ESP + 0x14]
00ac0541 : SHR EDX,0x1e
00ac0544 : AND EDX,0x1
00ac0547 : JZ 0x00ac05e3
00ac054d : MOV SI,word ptr [EBX + 0x1698]
00ac0554 : CALL 0x00404440
00ac0559 : MOV EDI,EAX
00ac055b : TEST EDI,EDI
00ac055d : JZ 0x00ac05e3
00ac0563 : LEA ESI,[ESP + 0x54]
00ac0567 : CALL 0x0040e600
00ac056c : MOV dword ptr [ESP + 0x270],0xc
00ac0577 : ADD EDI,0x40
00ac057a : PUSH EDI
00ac057b : MOV EDI,ESI
00ac057d : CALL 0x00406e40
00ac0582 : LEA EAX,[ESP + 0x5c]
00ac0586 : PUSH EAX
00ac0587 : LEA ECX,[ESP + 0x3c]
00ac058b : CALL 0x00406460
00ac0590 : MOV byte ptr [ESP + 0x270],0xd
00ac0598 : MOV EDX,dword ptr [EBX]
00ac059a : MOV EAX,dword ptr [EDX + 0x21c]
00ac05a0 : MOV ECX,EBX
00ac05a2 : CALL EAX
00ac05a4 : MOVZX ECX,AL
00ac05a7 : PUSH ECX
00ac05a8 : MOV ECX,dword ptr [EBX + 0x1868]
00ac05ae : PUSH 0x0
00ac05b0 : PUSH 0x0
00ac05b2 : PUSH 0x1
00ac05b4 : PUSH EBX
00ac05b5 : LEA EDX,[ESP + 0x4c]
00ac05b9 : PUSH EDX
00ac05ba : CALL 0x0084e210
00ac05bf : MOV byte ptr [ESP + 0x270],0xc
00ac05c7 : LEA ECX,[ESP + 0x38]
00ac05cb : CALL 0x00406560
00ac05d0 : MOV dword ptr [ESP + 0x270],0xffffffff
00ac05db : MOV dword ptr [ESP + 0x54],0xcd083c
00ac05e3 : MOVZX EAX,byte ptr [EBX + 0x1abc]
00ac05ea : PUSH 0x1
00ac05ec : PUSH EAX
00ac05ed : PUSH 0x1
00ac05ef : PUSH EBX
00ac05f0 : CALL 0x0085a780
00ac05f5 : LEA ECX,[ESP + 0x14]
00ac05f9 : PUSH 0x0
00ac05fb : PUSH ECX
00ac05fc : MOV CL,0x4
00ac05fe : MOV EDI,EBX
00ac0600 : MOV dword ptr [ESP + 0x1c],0x0
00ac0608 : CALL 0x0085af40
00ac060d : TEST EAX,EAX
00ac060f : JZ 0x00ac061a
00ac0611 : PUSH 0x4
00ac0613 : MOV ECX,EBX
00ac0615 : CALL 0x00862130
00ac061a : CMP byte ptr [EBX + 0x1abc],0x0
00ac0621 : JZ 0x00ac0640
00ac0623 : PUSH 0x0
00ac0625 : LEA EDX,[ESP + 0x18]
00ac0629 : PUSH EDX
00ac062a : MOV CL,0x2
00ac062c : MOV EDI,EBX
00ac062e : CALL 0x0085af40
00ac0633 : TEST EAX,EAX
00ac0635 : JZ 0x00ac0640
00ac0637 : PUSH 0x2
00ac0639 : MOV ECX,EBX
00ac063b : CALL 0x00862130
00ac0640 : PUSH 0x0
00ac0642 : LEA EAX,[ESP + 0x18]
00ac0646 : PUSH EAX
00ac0647 : MOV CL,0x9
00ac0649 : MOV EDI,EBX
00ac064b : CALL 0x0085af40
00ac0650 : TEST EAX,EAX
00ac0652 : JZ 0x00ac065d
00ac0654 : PUSH 0x9
00ac0656 : MOV ECX,EBX
00ac0658 : CALL 0x00862130
00ac065d : LEA ECX,[ESP + 0x14]
00ac0661 : PUSH 0x0
00ac0663 : PUSH ECX
00ac0664 : MOV CL,0x5
00ac0666 : MOV EDI,EBX
00ac0668 : CALL 0x0085af40
00ac066d : TEST EAX,EAX
00ac066f : JZ 0x00ac067a
00ac0671 : PUSH 0x5
00ac0673 : MOV ECX,EBX
00ac0675 : CALL 0x00862130
00ac067a : PUSH 0x0
00ac067c : LEA EDX,[ESP + 0x18]
00ac0680 : PUSH EDX
00ac0681 : MOV CL,0x7
00ac0683 : MOV EDI,EBX
00ac0685 : CALL 0x0085af40
00ac068a : TEST EAX,EAX
00ac068c : JZ 0x00ac0697
00ac068e : PUSH 0x7
00ac0690 : MOV ECX,EBX
00ac0692 : CALL 0x00862130
00ac0697 : PUSH 0x0
00ac0699 : LEA EAX,[ESP + 0x18]
00ac069d : PUSH EAX
00ac069e : MOV CL,0x8
00ac06a0 : MOV EDI,EBX
00ac06a2 : CALL 0x0085af40
00ac06a7 : TEST EAX,EAX
00ac06a9 : JZ 0x00ac06b4
00ac06ab : PUSH 0x8
00ac06ad : MOV ECX,EBX
00ac06af : CALL 0x00862130
00ac06b4 : MOV ECX,0x14
00ac06b9 : MOV dword ptr [ESP + 0x10],ECX
00ac06bd : LEA ECX,[ECX]
00ac06c0 : CMP ECX,0x14
00ac06c3 : JNZ 0x00ac06ce
00ac06c5 : CMP byte ptr [EBX + 0x1abc],0x0
00ac06cc : JZ 0x00ac06f0
00ac06ce : PUSH 0x0
00ac06d0 : LEA EDX,[ESP + 0x18]
00ac06d4 : PUSH EDX
00ac06d5 : MOV EDI,EBX
00ac06d7 : CALL 0x0085af40
00ac06dc : TEST EAX,EAX
00ac06de : JZ 0x00ac06ec
00ac06e0 : MOV EAX,dword ptr [ESP + 0x10]
00ac06e4 : PUSH EAX
00ac06e5 : MOV ECX,EBX
00ac06e7 : CALL 0x00862130
00ac06ec : MOV ECX,dword ptr [ESP + 0x10]
00ac06f0 : INC ECX
00ac06f1 : CMP ECX,0x1d
00ac06f4 : MOV dword ptr [ESP + 0x10],ECX
00ac06f8 : JLE 0x00ac06c0
00ac06fa : PUSH 0x1
00ac06fc : PUSH EBX
00ac06fd : CALL 0x00862750
00ac0702 : MOV ESI,dword ptr [ESP + 0x18]
00ac0706 : MOV EAX,ESI
00ac0708 : XOR EDI,EDI
00ac070a : SUB EAX,EDI
00ac070c : JZ 0x00ac07fa
00ac0712 : SUB EAX,0x1
00ac0715 : JNZ 0x00ac09ba
00ac071b : MOVZX EAX,word ptr [EBX + 0x43c]
00ac0722 : CMP AX,0x5
00ac0726 : JNZ 0x00ac07ce
00ac072c : CMP byte ptr [EBX + 0x65d],0x0
00ac0733 : JNZ 0x00ac0773
00ac0735 : MOV byte ptr [ESP + 0x39],0x0
00ac073a : XOR ECX,ECX
00ac073c : LEA EDX,[ESP + 0x38]
00ac0740 : PUSH EDX
00ac0741 : LEA EAX,[EBX + 0x19a4]
00ac0747 : MOV byte ptr [ESP + 0x3c],CL
00ac074b : MOV byte ptr [ESP + 0x50],CL
00ac074f : MOV byte ptr [ESP + 0x4a],0x1
00ac0754 : MOV word ptr [ESP + 0x48],CX
00ac0759 : MOV dword ptr [ESP + 0x44],EDI
00ac075d : MOV dword ptr [ESP + 0x40],EDI
00ac0761 : MOV dword ptr [ESP + 0x4c],0x1
00ac0769 : CALL 0x0041dea0
00ac076e : JMP 0x00ac09c4
00ac0773 : CMP dword ptr [EBX + 0x17f0],EDI
00ac0779 : JZ 0x00ac09c4
00ac077f : MOV EDI,EBX
00ac0781 : MOV dword ptr [EBX + 0x16e8],0x0
00ac078b : CALL 0x0085de20
00ac0790 : MOV ESI,EBX
00ac0792 : CALL 0x0085dcf0
00ac0797 : MOVZX ECX,word ptr [EBX + 0x43c]
00ac079e : MOV EAX,dword ptr [EBX]
00ac07a0 : MOV EDX,dword ptr [EAX + 0x49c]
00ac07a6 : PUSH 0x1
00ac07a8 : PUSH ECX
00ac07a9 : MOV ECX,EBX
00ac07ab : CALL EDX
00ac07ad : MOV EAX,dword ptr [EBX]
00ac07af : MOV EDX,dword ptr [EAX + 0x484]
00ac07b5 : PUSH 0x0
00ac07b7 : MOV ECX,EBX
00ac07b9 : CALL EDX
00ac07bb : PUSH 0x0
00ac07bd : PUSH EBX
00ac07be : CALL 0x00862750
00ac07c3 : MOV ESI,dword ptr [ESP + 0x18]
00ac07c7 : XOR EDI,EDI
00ac07c9 : JMP 0x00ac09c4
00ac07ce : CMP AX,0x2
00ac07d2 : JZ 0x00ac07ea
00ac07d4 : CMP AX,0x8
00ac07d8 : JZ 0x00ac07ea
00ac07da : CMP AX,0x6
00ac07de : JZ 0x00ac07ea
00ac07e0 : CMP AX,0x4
00ac07e4 : JNZ 0x00ac09c4
00ac07ea : PUSH 0x1
00ac07ec : PUSH EDI
00ac07ed : PUSH EDI
00ac07ee : PUSH EDI
00ac07ef : PUSH EBX
00ac07f0 : CALL 0x008665a0
00ac07f5 : JMP 0x00ac09c4
00ac07fa : CMP dword ptr [EBP + 0xc],EDI
00ac07fd : JZ 0x00ac09c4
00ac0803 : MOV EAX,dword ptr [EBP + 0xc]
00ac0806 : PUSH EAX
00ac0807 : CALL 0x004049b0
00ac080c : ADD ESP,0x4
00ac080f : CMP word ptr [EAX + 0x28a],0x5
00ac0817 : JNZ 0x00ac08da
00ac081d : CMP byte ptr [EBX + 0x65d],0x0
00ac0824 : JNZ 0x00ac0830
00ac0826 : MOV byte ptr [ESP + 0x39],0x1
00ac082b : JMP 0x00ac073a
00ac0830 : MOV EAX,dword ptr [EBX + 0x17f4]
00ac0836 : CMP EAX,EDI
00ac0838 : JZ 0x00ac0846
00ac083a : MOV ECX,dword ptr [EBX + 0x16ec]
00ac0840 : MOV dword ptr [ESP + 0x10],ECX
00ac0844 : JMP 0x00ac084a
00ac0846 : MOV dword ptr [ESP + 0x10],EDI
00ac084a : CMP EAX,EDI
00ac084c : JZ 0x00ac09c4
00ac0852 : MOV EDI,EBX
00ac0854 : MOV dword ptr [EBX + 0x16ec],0x0
00ac085e : CALL 0x0085de20
00ac0863 : MOV ESI,EBX
00ac0865 : CALL 0x0085dcf0
00ac086a : PUSH 0xc3f468
00ac086f : LEA ECX,[ESP + 0x20]
00ac0873 : CALL 0x00406460
00ac0878 : MOV dword ptr [ESP + 0x270],0x16
00ac0883 : MOV EDX,dword ptr [ESP + 0x10]
00ac0887 : MOV ECX,dword ptr [EBX + 0x17f4]
00ac088d : PUSH EDX
00ac088e : LEA EAX,[ESP + 0x20]
00ac0892 : PUSH EAX
00ac0893 : CALL 0x0084ceb0
00ac0898 : MOV dword ptr [ESP + 0x270],0xffffffff
00ac08a3 : LEA ECX,[ESP + 0x1c]
00ac08a7 : CALL 0x00406560
00ac08ac : MOV ECX,dword ptr [EBX + 0x17f4]
00ac08b2 : MOV dword ptr [ECX + 0x28],0x0
00ac08b9 : MOV EDX,dword ptr [EBX]
00ac08bb : MOV EAX,dword ptr [EDX + 0x48c]
00ac08c1 : PUSH 0x0
00ac08c3 : MOV ECX,EBX
00ac08c5 : CALL EAX
00ac08c7 : PUSH 0x0
00ac08c9 : PUSH EBX
00ac08ca : CALL 0x00862750
00ac08cf : MOV ESI,dword ptr [ESP + 0x18]
00ac08d3 : XOR EDI,EDI
00ac08d5 : JMP 0x00ac09c4
00ac08da : MOV AL,byte ptr [EAX + 0x288]
00ac08e0 : CMP AL,0x2
00ac08e2 : JZ 0x00ac0959
00ac08e4 : CMP AL,0x8
00ac08e6 : JZ 0x00ac0959
00ac08e8 : CMP AL,0x6
00ac08ea : JZ 0x00ac08f4
00ac08ec : CMP AL,0x4
00ac08ee : JNZ 0x00ac09c4
00ac08f4 : CMP byte ptr [EBX + 0x65d],0x0
00ac08fb : JZ 0x00ac0826
00ac0901 : MOV EAX,dword ptr [EBX + 0x17f4]
00ac0907 : CMP EAX,EDI
00ac0909 : JZ 0x00ac0917
00ac090b : MOV ECX,dword ptr [EBX + 0x16ec]
00ac0911 : MOV dword ptr [ESP + 0x10],ECX
00ac0915 : JMP 0x00ac091b
00ac0917 : MOV dword ptr [ESP + 0x10],EDI
00ac091b : CMP EAX,EDI
00ac091d : JZ 0x00ac09c4
00ac0923 : MOV EDI,EBX
00ac0925 : MOV dword ptr [EBX + 0x16ec],0x0
00ac092f : CALL 0x0085de20
00ac0934 : MOV ESI,EBX
00ac0936 : CALL 0x0085dcf0
00ac093b : PUSH 0xc3f468
00ac0940 : LEA ECX,[ESP + 0x20]
00ac0944 : CALL 0x00406460
00ac0949 : MOV dword ptr [ESP + 0x270],0x2e
00ac0954 : JMP 0x00ac0883
00ac0959 : CMP byte ptr [EBX + 0x65d],0x0
00ac0960 : JZ 0x00ac0826
00ac0966 : MOV EAX,dword ptr [EBX + 0x17f4]
00ac096c : CMP EAX,EDI
00ac096e : JZ 0x00ac097c
00ac0970 : MOV ECX,dword ptr [EBX + 0x16ec]
00ac0976 : MOV dword ptr [ESP + 0x10],ECX
00ac097a : JMP 0x00ac0980
00ac097c : MOV dword ptr [ESP + 0x10],EDI
00ac0980 : CMP EAX,EDI
00ac0982 : JZ 0x00ac09c4
00ac0984 : MOV EDI,EBX
00ac0986 : MOV dword ptr [EBX + 0x16ec],0x0
00ac0990 : CALL 0x0085de20
00ac0995 : MOV ESI,EBX
00ac0997 : CALL 0x0085dcf0
00ac099c : PUSH 0xc3f468
00ac09a1 : LEA ECX,[ESP + 0x20]
00ac09a5 : CALL 0x00406460
00ac09aa : MOV dword ptr [ESP + 0x270],0x22
00ac09b5 : JMP 0x00ac0883
00ac09ba : CMP ESI,0x6
00ac09bd : JZ 0x00ac09e7
00ac09bf : CMP ESI,0x3
00ac09c2 : JZ 0x00ac09e7
00ac09c4 : PUSH 0x1
00ac09c6 : PUSH EDI
00ac09c7 : PUSH EDI
00ac09c8 : PUSH ESI
00ac09c9 : PUSH EBX
00ac09ca : CALL 0x008665a0
00ac09cf : MOV EDX,dword ptr [EBX]
00ac09d1 : MOV EAX,dword ptr [EBP + 0xc]
00ac09d4 : MOV EDX,dword ptr [EDX + 0x490]
00ac09da : PUSH 0x1
00ac09dc : PUSH EDI
00ac09dd : PUSH EDI
00ac09de : PUSH EDI
00ac09df : PUSH 0x1
00ac09e1 : PUSH ESI
00ac09e2 : PUSH EAX
00ac09e3 : MOV ECX,EBX
00ac09e5 : CALL EDX
00ac09e7 : MOV ECX,dword ptr [ESP + 0x268]
00ac09ee : MOV dword ptr FS:[0x0],ECX
00ac09f5 : POP ECX
00ac09f6 : POP EDI
00ac09f7 : POP ESI
00ac09f8 : POP EBX
00ac09f9 : MOV ECX,dword ptr [ESP + 0x250]
00ac0a00 : XOR ECX,ESP
00ac0a02 : CALL 0x00633e6b
00ac0a07 : MOV ESP,EBP
00ac0a09 : POP EBP
00ac0a0a : RET 0x8

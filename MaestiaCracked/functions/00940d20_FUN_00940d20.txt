PROGRAM  : Maestia.exe
FUNCTION : FUN_00940d20
ENTRY    : 00940d20
BODY     : [[00940d20, 00940eac] [00940eb0, 0094118c] [00941190, 00941268]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00940d20(void)

{
  short sVar1;
  int iVar2;
  undefined1 uVar3;
  char cVar4;
  uint uVar5;
  undefined4 uVar6;
  short ****ppppsVar7;
  int iVar8;
  int in_ECX;
  undefined4 *puVar9;
  short ****ppppsVar10;
  int *piVar11;
  undefined4 local_94;
  int local_90;
  int local_8c;
  undefined1 local_88 [4];
  undefined2 local_84;
  undefined4 local_74;
  uint local_70;
  uint local_6c;
  undefined1 local_68 [4];
  undefined2 local_64;
  undefined4 local_54;
  uint local_50;
  short ***local_48 [4];
  undefined4 local_38;
  uint local_34;
  undefined4 local_2c;
  uint local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b2ced6;
  local_10 = ExceptionList;
  uVar5 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar8 = *DAT_00da9894;
  local_14 = uVar5;
  if ((*(int *)(iVar8 + 0x288) != 0) && (*(char *)(*(int *)(iVar8 + 0x288) + 0x32) != '\0')) {
    if ((DAT_0172491c != 0) && ((iVar8 != 0 && (*(int *)(iVar8 + 0x1a8) != 0)))) {
      FUN_00406460(L"IDS_THIS_UI_CANNOT_OPENED");
      local_8 = 0;
      piVar11 = *(int **)(*DAT_00da9894 + 0x1a8);
      uVar6 = FUN_0081d120(local_88);
      local_8._0_1_ = 1;
      (**(code **)(*piVar11 + 0x44))(uVar6,3,uVar5);
      local_8 = (uint)local_8._1_3_ << 8;
      FUN_00406560();
      local_8 = 0xffffffff;
      FUN_00406560();
    }
    goto LAB_0094124b;
  }
  local_8c = in_ECX;
  FUN_008f7770(1,300);
  local_48[0] = (short ***)((uint)local_48[0] & 0xffff0000);
  local_34 = 7;
  local_38 = 0;
  FUN_00406360(L"inventory",9);
  local_8._0_1_ = 2;
  local_8._1_3_ = 0;
  if (*(short *)(in_ECX + 0x70) != 0) {
    uVar6 = FUN_00404750(L"pocket%d",*(short *)(in_ECX + 0x70));
    local_8._0_1_ = 3;
    FUN_00405eb0(uVar6,0,0xffffffff);
    local_8._0_1_ = 2;
    if (7 < local_70) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  local_8._0_1_ = 2;
  ppppsVar10 = (short ****)local_48[0];
  if (local_34 < 8) {
    ppppsVar10 = local_48;
  }
  local_84 = 0;
  local_70 = 7;
  local_74 = 0;
  ppppsVar7 = ppppsVar10;
  do {
    sVar1 = *(short *)ppppsVar7;
    ppppsVar7 = (short ****)((int)ppppsVar7 + 2);
  } while (sVar1 != 0);
  FUN_00406360(ppppsVar10,(int)ppppsVar7 - (int)((int)ppppsVar10 + 2) >> 1);
  local_8._0_1_ = 4;
  FUN_0081cce0(DAT_0172491c);
  local_8._0_1_ = 6;
  if (7 < local_70) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_70 = 7;
  local_50 = 7;
  local_74 = 0;
  local_84 = 0;
  local_54 = 0;
  local_64 = 0;
  FUN_00406360(&DAT_00c71950,0);
  local_8._0_1_ = 7;
  uVar3 = (undefined1)local_8;
  local_8._0_1_ = 7;
  if (local_1c != 0) {
    FUN_00406460(L"$inventory");
    local_8._0_1_ = 8;
    iVar8 = FUN_0081f330(local_68);
    local_8._0_1_ = 7;
    if (7 < local_70) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_70 = 7;
    local_74 = 0;
    local_84 = 0;
    uVar3 = (undefined1)local_8;
    if ((iVar8 != 0) && (3 < local_1c)) {
      local_6c = 0x28;
      iVar8 = FUN_00407cc0(&local_6c,1);
      uVar3 = (undefined1)local_8;
      if (iVar8 != -1) {
        FUN_00405e10(iVar8,local_1c - iVar8);
        FUN_00405c30(local_68,0,0xffffffff);
        iVar8 = *DAT_00da9894;
        uVar3 = (undefined1)local_8;
        if ((iVar8 != 0) && (*(int *)(iVar8 + 0x114) != 0)) {
          puVar9 = local_2c;
          if (local_18 < 8) {
            puVar9 = &local_2c;
          }
          (**(code **)(**(int **)(iVar8 + 0x114) + 4))
                    (*(int **)(iVar8 + 0x114),"SetPocketTitle","%d%ls",
                     *(undefined2 *)(in_ECX + 0x70),puVar9);
          uVar3 = (undefined1)local_8;
        }
      }
    }
  }
  local_8._0_1_ = uVar3;
  iVar8 = *(int *)(*(int *)(in_ECX + 4) + 0x130);
  if (*(char *)(iVar8 + 0x44) == '\0') {
    *(undefined1 *)(iVar8 + 0x44) = 1;
  }
  iVar8 = *DAT_00da9894;
  if ((iVar8 != 0) && (*(int *)(iVar8 + 0x114) != 0)) {
    (**(code **)(**(int **)(iVar8 + 0x114) + 4))
              (*(int **)(iVar8 + 0x114),"PocketOpen","%d,%d",*(undefined2 *)(in_ECX + 0x70),
               *(undefined2 *)(in_ECX + 0x72));
  }
  cVar4 = FUN_008ebff0();
  if (cVar4 != '\0') {
    iVar8 = *DAT_00da9894;
    local_94 = DAT_00d6f0f4;
    local_6c = local_6c & 0xffffff00;
    FUN_004437f0(&local_94);
    if ((((local_90 == *(int *)(iVar8 + 0x48)) || (iVar8 = *(int *)(local_90 + 0x10), iVar8 == 0))
        || (*(char *)(iVar8 + 0x32) == '\0')) || (*(char *)(iVar8 + 0x8c) == '\0')) {
      uVar6 = *(undefined4 *)(*(int *)(DAT_0172491c + 0x17c) + 0x1ed0);
    }
    else {
      local_6c = CONCAT31(local_6c._1_3_,1);
      uVar6 = (**(code **)(**(int **)(DAT_0172491c + 0x17c) + 0x46c))();
    }
    FUN_00a96790(uVar6,local_6c);
  }
  FUN_009407b0(in_ECX);
  iVar8 = *DAT_00da9894;
  if ((iVar8 != 0) && (*(int *)(iVar8 + 0x128) != 0)) {
    iVar2 = *(int *)(*(int *)(iVar8 + 0x128) + 0x5c);
    if (iVar2 == 2) {
      uVar6 = 1;
    }
    else if (iVar2 == 3) {
      uVar6 = 2;
    }
    else {
      if (iVar2 != 5) goto LAB_009411bd;
      if (*(short *)(*(int *)(iVar8 + 0x128) + 0x84) == 1) {
        uVar6 = 3;
      }
      else if (*(short *)(*(int *)(iVar8 + 0x128) + 0x84) == 2) {
        uVar6 = 4;
      }
      else {
        if (*(short *)(*(int *)(iVar8 + 0x128) + 0x84) != 3) goto LAB_009411bd;
        uVar6 = 5;
      }
    }
    uVar5 = 0;
    in_ECX = local_8c;
    piVar11 = DAT_00da9894;
    if (*(int *)(*DAT_00da9894 + 0x40) != 0) {
      do {
        iVar8 = FUN_008eb810();
        if ((iVar8 != 0) && (*(char *)(iVar8 + 100) != '\0')) {
          FUN_0093ff10(uVar6);
          piVar11 = DAT_00da9894;
        }
        uVar5 = uVar5 + 1;
        in_ECX = local_8c;
      } while (uVar5 < *(uint *)(*piVar11 + 0x40));
    }
  }
LAB_009411bd:
  if (((*(short *)(in_ECX + 0x70) == 0) && (*(char *)(in_ECX + 0x75) == '\0')) &&
     (*(char *)(in_ECX + 0x74) == '\x01')) {
    FUN_008d9700(1);
    *(undefined1 *)(in_ECX + 0x75) = 1;
  }
  local_8 = CONCAT31(local_8._1_3_,6);
  if (7 < local_50) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_50 = 7;
  local_54 = 0;
  local_64 = 0;
  local_8 = CONCAT31(local_8._1_3_,2);
  if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_18 = 7;
  local_1c = 0;
  local_2c = (undefined4 *)((uint)local_2c._2_2_ << 0x10);
  local_8 = 0xffffffff;
  if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_34 = 7;
  local_38 = 0;
  local_48[0] = (short ***)((uint)local_48[0] & 0xffff0000);
LAB_0094124b:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00940d20 : PUSH EBP
00940d21 : MOV EBP,ESP
00940d23 : PUSH -0x1
00940d25 : PUSH 0xb2ced6
00940d2a : MOV EAX,FS:[0x0]
00940d30 : PUSH EAX
00940d31 : SUB ESP,0xa0
00940d37 : MOV EAX,[0x00d66fa0]
00940d3c : XOR EAX,EBP
00940d3e : MOV dword ptr [EBP + -0x10],EAX
00940d41 : PUSH EBX
00940d42 : PUSH ESI
00940d43 : PUSH EDI
00940d44 : PUSH EAX
00940d45 : LEA EAX,[EBP + -0xc]
00940d48 : MOV FS:[0x0],EAX
00940d4e : MOV EAX,[0x00da9894]
00940d53 : MOV EAX,dword ptr [EAX]
00940d55 : MOV EBX,ECX
00940d57 : MOV ECX,dword ptr [EAX + 0x288]
00940d5d : XOR EDI,EDI
00940d5f : MOV dword ptr [EBP + 0xffffff78],EBX
00940d65 : CMP ECX,EDI
00940d67 : JZ 0x00940e02
00940d6d : CMP byte ptr [ECX + 0x32],0x0
00940d71 : JZ 0x00940e02
00940d77 : CMP dword ptr [0x0172491c],EDI
00940d7d : JZ 0x0094124b
00940d83 : CMP EAX,EDI
00940d85 : JZ 0x0094124b
00940d8b : CMP dword ptr [EAX + 0x1a8],EDI
00940d91 : JZ 0x0094124b
00940d97 : PUSH 0xc718f4
00940d9c : LEA ECX,[EBP + 0xffffff7c]
00940da2 : CALL 0x00406460
00940da7 : MOV dword ptr [EBP + -0x4],EDI
00940daa : MOV ECX,dword ptr [0x00da9894]
00940db0 : MOV EAX,dword ptr [ECX]
00940db2 : MOV ECX,dword ptr [0x0172491c]
00940db8 : MOV ESI,dword ptr [EAX + 0x1a8]
00940dbe : LEA EDX,[EBP + 0xffffff7c]
00940dc4 : PUSH EDX
00940dc5 : LEA EDI,[EBP + 0xffffff54]
00940dcb : CALL 0x0081d120
00940dd0 : MOV byte ptr [EBP + -0x4],0x1
00940dd4 : MOV EDX,dword ptr [ESI]
00940dd6 : PUSH 0x3
00940dd8 : PUSH EAX
00940dd9 : MOV EAX,dword ptr [EDX + 0x44]
00940ddc : MOV ECX,ESI
00940dde : CALL EAX
00940de0 : MOV byte ptr [EBP + -0x4],0x0
00940de4 : MOV ECX,EDI
00940de6 : CALL 0x00406560
00940deb : MOV dword ptr [EBP + -0x4],0xffffffff
00940df2 : LEA ECX,[EBP + 0xffffff7c]
00940df8 : CALL 0x00406560
00940dfd : JMP 0x0094124b
00940e02 : PUSH 0x12c
00940e07 : PUSH 0x1
00940e09 : MOV ECX,EBX
00940e0b : CALL 0x008f7770
00940e10 : XOR ECX,ECX
00940e12 : PUSH 0x9
00940e14 : MOV word ptr [EBP + -0x44],CX
00940e18 : PUSH 0xc71928
00940e1d : LEA ECX,[EBP + -0x48]
00940e20 : MOV dword ptr [EBP + -0x30],0x7
00940e27 : MOV dword ptr [EBP + -0x34],EDI
00940e2a : CALL 0x00406360
00940e2f : MOV dword ptr [EBP + -0x4],0x2
00940e36 : MOVZX EAX,word ptr [EBX + 0x70]
00940e3a : XOR EDX,EDX
00940e3c : CMP DX,AX
00940e3f : JNC 0x00940e8a
00940e41 : MOVZX EAX,AX
00940e44 : PUSH EAX
00940e45 : PUSH 0xc7193c
00940e4a : LEA ESI,[EBP + 0xffffff7c]
00940e50 : CALL 0x00404750
00940e55 : ADD ESP,0x8
00940e58 : MOV byte ptr [EBP + -0x4],0x3
00940e5c : PUSH -0x1
00940e5e : PUSH EDI
00940e5f : PUSH EAX
00940e60 : LEA ECX,[EBP + -0x48]
00940e63 : CALL 0x00405eb0
00940e68 : MOV byte ptr [EBP + -0x4],0x2
00940e6c : CMP dword ptr [EBP + -0x6c],0x8
00940e70 : JC 0x00940e7a
00940e72 : MOV ECX,dword ptr [EBP + -0x80]
00940e75 : CALL 0x006f04e0
00940e7a : XOR ECX,ECX
00940e7c : MOV dword ptr [EBP + -0x6c],0x7
00940e83 : MOV dword ptr [EBP + -0x70],EDI
00940e86 : MOV word ptr [EBP + -0x80],CX
00940e8a : CMP dword ptr [EBP + -0x30],0x8
00940e8e : MOV EDX,dword ptr [EBP + -0x44]
00940e91 : JNC 0x00940e96
00940e93 : LEA EDX,[EBP + -0x44]
00940e96 : XOR EAX,EAX
00940e98 : MOV word ptr [EBP + -0x80],AX
00940e9c : MOV EAX,EDX
00940e9e : MOV dword ptr [EBP + -0x6c],0x7
00940ea5 : MOV dword ptr [EBP + -0x70],EDI
00940ea8 : LEA ESI,[EAX + 0x2]
00940eab : JMP 0x00940eb0
00940eb0 : MOV CX,word ptr [EAX]
00940eb3 : ADD EAX,0x2
00940eb6 : CMP CX,DI
00940eb9 : JNZ 0x00940eb0
00940ebb : SUB EAX,ESI
00940ebd : SAR EAX,0x1
00940ebf : PUSH EAX
00940ec0 : PUSH EDX
00940ec1 : LEA ECX,[EBP + 0xffffff7c]
00940ec7 : CALL 0x00406360
00940ecc : MOV byte ptr [EBP + -0x4],0x4
00940ed0 : MOV ECX,dword ptr [0x0172491c]
00940ed6 : PUSH ECX
00940ed7 : LEA ECX,[EBP + 0xffffff7c]
00940edd : LEA ESI,[EBP + -0x2c]
00940ee0 : CALL 0x0081cce0
00940ee5 : MOV byte ptr [EBP + -0x4],0x6
00940ee9 : CMP dword ptr [EBP + -0x6c],0x8
00940eed : JC 0x00940ef7
00940eef : MOV ECX,dword ptr [EBP + -0x80]
00940ef2 : CALL 0x006f04e0
00940ef7 : MOV EAX,0x7
00940efc : MOV dword ptr [EBP + -0x6c],EAX
00940eff : MOV dword ptr [EBP + -0x4c],EAX
00940f02 : PUSH EDI
00940f03 : XOR EDX,EDX
00940f05 : XOR EAX,EAX
00940f07 : PUSH 0xc71950
00940f0c : LEA ECX,[EBP + -0x64]
00940f0f : MOV dword ptr [EBP + -0x70],EDI
00940f12 : MOV word ptr [EBP + -0x80],DX
00940f16 : MOV dword ptr [EBP + -0x50],EDI
00940f19 : MOV word ptr [EBP + -0x60],AX
00940f1d : CALL 0x00406360
00940f22 : MOV byte ptr [EBP + -0x4],0x7
00940f26 : CMP dword ptr [EBP + -0x18],EDI
00940f29 : JZ 0x00941007
00940f2f : PUSH 0xc71954
00940f34 : LEA ECX,[EBP + 0xffffff7c]
00940f3a : CALL 0x00406460
00940f3f : MOV byte ptr [EBP + -0x4],0x8
00940f43 : LEA ECX,[EBP + -0x64]
00940f46 : PUSH ECX
00940f47 : MOV ECX,dword ptr [0x0172491c]
00940f4d : LEA EDX,[EBP + 0xffffff7c]
00940f53 : CALL 0x0081f330
00940f58 : MOV ESI,EAX
00940f5a : MOV byte ptr [EBP + -0x4],0x7
00940f5e : CMP dword ptr [EBP + -0x6c],0x8
00940f62 : JC 0x00940f6c
00940f64 : MOV ECX,dword ptr [EBP + -0x80]
00940f67 : CALL 0x006f04e0
00940f6c : XOR EDX,EDX
00940f6e : MOV dword ptr [EBP + -0x6c],0x7
00940f75 : MOV dword ptr [EBP + -0x70],EDI
00940f78 : MOV word ptr [EBP + -0x80],DX
00940f7c : CMP ESI,EDI
00940f7e : JZ 0x00941007
00940f84 : MOV ESI,dword ptr [EBP + -0x18]
00940f87 : CMP ESI,0x3
00940f8a : JBE 0x00941007
00940f8c : PUSH 0x1
00940f8e : LEA EAX,[EBP + -0x68]
00940f91 : PUSH EAX
00940f92 : OR ECX,0xffffffff
00940f95 : LEA EDI,[EBP + -0x2c]
00940f98 : MOV dword ptr [EBP + -0x68],0x28
00940f9f : CALL 0x00407cc0
00940fa4 : CMP EAX,-0x1
00940fa7 : JZ 0x00941005
00940fa9 : SUB ESI,EAX
00940fab : PUSH ESI
00940fac : PUSH EAX
00940fad : MOV ECX,EDI
00940faf : CALL 0x00405e10
00940fb4 : PUSH -0x1
00940fb6 : PUSH 0x0
00940fb8 : LEA ECX,[EBP + -0x64]
00940fbb : PUSH ECX
00940fbc : MOV ECX,EDI
00940fbe : CALL 0x00405c30
00940fc3 : MOV EDX,dword ptr [0x00da9894]
00940fc9 : MOV EAX,dword ptr [EDX]
00940fcb : TEST EAX,EAX
00940fcd : JZ 0x00941005
00940fcf : CMP dword ptr [EAX + 0x114],0x0
00940fd6 : JZ 0x00941005
00940fd8 : CMP dword ptr [EBP + -0x14],0x8
00940fdc : MOV EAX,dword ptr [EAX + 0x114]
00940fe2 : MOV ECX,dword ptr [EBP + -0x28]
00940fe5 : JNC 0x00940fea
00940fe7 : LEA ECX,[EBP + -0x28]
00940fea : MOV EDX,dword ptr [EAX]
00940fec : MOV EDX,dword ptr [EDX + 0x4]
00940fef : PUSH ECX
00940ff0 : MOVZX ECX,word ptr [EBX + 0x70]
00940ff4 : PUSH ECX
00940ff5 : PUSH 0xc7196c
00940ffa : PUSH 0xc71974
00940fff : PUSH EAX
00941000 : CALL EDX
00941002 : ADD ESP,0x14
00941005 : XOR EDI,EDI
00941007 : MOV EAX,dword ptr [EBX + 0x4]
0094100a : MOV EAX,dword ptr [EAX + 0x130]
00941010 : CMP byte ptr [EAX + 0x44],0x0
00941014 : JNZ 0x0094101a
00941016 : MOV byte ptr [EAX + 0x44],0x1
0094101a : MOV ECX,dword ptr [0x00da9894]
00941020 : MOV EAX,dword ptr [ECX]
00941022 : CMP EAX,EDI
00941024 : JZ 0x00941053
00941026 : CMP dword ptr [EAX + 0x114],EDI
0094102c : JZ 0x00941053
0094102e : MOVZX ECX,word ptr [EBX + 0x72]
00941032 : MOV EAX,dword ptr [EAX + 0x114]
00941038 : MOV EDX,dword ptr [EAX]
0094103a : MOV EDX,dword ptr [EDX + 0x4]
0094103d : PUSH ECX
0094103e : MOVZX ECX,word ptr [EBX + 0x70]
00941042 : PUSH ECX
00941043 : PUSH 0xc71984
00941048 : PUSH 0xc7198c
0094104d : PUSH EAX
0094104e : CALL EDX
00941050 : ADD ESP,0x14
00941053 : MOV EAX,dword ptr [EBX + 0x5c]
00941056 : CALL 0x008ebff0
0094105b : TEST AL,AL
0094105d : JZ 0x009410e9
00941063 : MOV EAX,[0x00da9894]
00941068 : MOV ESI,dword ptr [EAX]
0094106a : MOV ECX,dword ptr [0x00d6f0f4]
00941070 : LEA EDX,[EBP + 0xffffff70]
00941076 : MOV dword ptr [EBP + 0xffffff70],ECX
0094107c : PUSH EDX
0094107d : LEA ECX,[ESI + 0x44]
00941080 : LEA EAX,[EBP + 0xffffff74]
00941086 : MOV byte ptr [EBP + -0x68],0x0
0094108a : CALL 0x004437f0
0094108f : MOV ESI,dword ptr [ESI + 0x48]
00941092 : MOV EAX,dword ptr [EBP + 0xffffff74]
00941098 : CMP EAX,ESI
0094109a : JZ 0x009410cd
0094109c : MOV EAX,dword ptr [EAX + 0x10]
0094109f : CMP EAX,EDI
009410a1 : JZ 0x009410cd
009410a3 : CMP byte ptr [EAX + 0x32],0x0
009410a7 : JZ 0x009410cd
009410a9 : CMP byte ptr [EAX + 0x8c],0x0
009410b0 : JZ 0x009410cd
009410b2 : MOV EAX,[0x0172491c]
009410b7 : MOV ECX,dword ptr [EAX + 0x17c]
009410bd : MOV EDX,dword ptr [ECX]
009410bf : MOV EAX,dword ptr [EDX + 0x46c]
009410c5 : MOV byte ptr [EBP + -0x68],0x1
009410c9 : CALL EAX
009410cb : JMP 0x009410df
009410cd : MOV ECX,dword ptr [0x0172491c]
009410d3 : MOV EAX,dword ptr [ECX + 0x17c]
009410d9 : MOV EAX,dword ptr [EAX + 0x1ed0]
009410df : MOV EDX,dword ptr [EBP + -0x68]
009410e2 : PUSH EDX
009410e3 : PUSH EAX
009410e4 : CALL 0x00a96790
009410e9 : PUSH EBX
009410ea : CALL 0x009407b0
009410ef : MOV EDI,dword ptr [0x00da9894]
009410f5 : MOV EAX,dword ptr [EDI]
009410f7 : TEST EAX,EAX
009410f9 : JZ 0x009411bd
009410ff : CMP dword ptr [EAX + 0x128],0x0
00941106 : JZ 0x009411bd
0094110c : MOV ECX,dword ptr [EAX + 0x128]
00941112 : MOV ECX,dword ptr [ECX + 0x5c]
00941115 : SUB ECX,0x2
00941118 : JZ 0x0094117d
0094111a : SUB ECX,0x1
0094111d : JZ 0x00941176
0094111f : SUB ECX,0x2
00941122 : JNZ 0x009411bd
00941128 : MOV ECX,dword ptr [EAX + 0x128]
0094112e : MOVZX ECX,word ptr [ECX + 0x84]
00941135 : CMP CX,0x1
00941139 : JNZ 0x00941142
0094113b : MOV EBX,0x3
00941140 : JMP 0x00941182
00941142 : MOV ECX,dword ptr [EAX + 0x128]
00941148 : MOVZX ECX,word ptr [ECX + 0x84]
0094114f : CMP CX,0x2
00941153 : JNZ 0x0094115c
00941155 : MOV EBX,0x4
0094115a : JMP 0x00941182
0094115c : MOV EAX,dword ptr [EAX + 0x128]
00941162 : MOVZX EAX,word ptr [EAX + 0x84]
00941169 : CMP AX,0x3
0094116d : JNZ 0x009411bd
0094116f : MOV EBX,0x5
00941174 : JMP 0x00941182
00941176 : MOV EBX,0x2
0094117b : JMP 0x00941182
0094117d : MOV EBX,0x1
00941182 : MOV EAX,dword ptr [EDI]
00941184 : XOR ESI,ESI
00941186 : CMP dword ptr [EAX + 0x40],ESI
00941189 : JBE 0x009411b7
0094118b : JMP 0x00941190
00941190 : MOV ECX,ESI
00941192 : CALL 0x008eb810
00941197 : TEST EAX,EAX
00941199 : JZ 0x009411af
0094119b : CMP byte ptr [EAX + 0x64],0x0
0094119f : JZ 0x009411af
009411a1 : PUSH EBX
009411a2 : MOV EDI,EAX
009411a4 : CALL 0x0093ff10
009411a9 : MOV EDI,dword ptr [0x00da9894]
009411af : MOV EAX,dword ptr [EDI]
009411b1 : INC ESI
009411b2 : CMP ESI,dword ptr [EAX + 0x40]
009411b5 : JC 0x00941190
009411b7 : MOV EBX,dword ptr [EBP + 0xffffff78]
009411bd : CMP word ptr [EBX + 0x70],0x0
009411c2 : JNZ 0x009411e5
009411c4 : CMP byte ptr [EBX + 0x75],0x0
009411c8 : JNZ 0x009411e5
009411ca : CMP byte ptr [EBX + 0x74],0x1
009411ce : JNZ 0x009411e5
009411d0 : MOV EAX,dword ptr [EDI]
009411d2 : MOV EAX,dword ptr [EAX + 0x1d4]
009411d8 : PUSH 0x1
009411da : MOV ECX,EAX
009411dc : CALL 0x008d9700
009411e1 : MOV byte ptr [EBX + 0x75],0x1
009411e5 : MOV byte ptr [EBP + -0x4],0x6
009411e9 : MOV EBX,0x8
009411ee : CMP dword ptr [EBP + -0x4c],EBX
009411f1 : JC 0x009411fb
009411f3 : MOV ECX,dword ptr [EBP + -0x60]
009411f6 : CALL 0x006f04e0
009411fb : MOV ESI,0x7
00941200 : XOR EDI,EDI
00941202 : XOR EAX,EAX
00941204 : MOV dword ptr [EBP + -0x4c],ESI
00941207 : MOV dword ptr [EBP + -0x50],EDI
0094120a : MOV word ptr [EBP + -0x60],AX
0094120e : MOV byte ptr [EBP + -0x4],0x2
00941212 : CMP dword ptr [EBP + -0x14],EBX
00941215 : JC 0x0094121f
00941217 : MOV ECX,dword ptr [EBP + -0x28]
0094121a : CALL 0x006f04e0
0094121f : XOR ECX,ECX
00941221 : MOV dword ptr [EBP + -0x14],ESI
00941224 : MOV dword ptr [EBP + -0x18],EDI
00941227 : MOV word ptr [EBP + -0x28],CX
0094122b : MOV dword ptr [EBP + -0x4],0xffffffff
00941232 : CMP dword ptr [EBP + -0x30],EBX
00941235 : JC 0x0094123f
00941237 : MOV ECX,dword ptr [EBP + -0x44]
0094123a : CALL 0x006f04e0
0094123f : XOR EDX,EDX
00941241 : MOV dword ptr [EBP + -0x30],ESI
00941244 : MOV dword ptr [EBP + -0x34],EDI
00941247 : MOV word ptr [EBP + -0x44],DX
0094124b : MOV ECX,dword ptr [EBP + -0xc]
0094124e : MOV dword ptr FS:[0x0],ECX
00941255 : POP ECX
00941256 : POP EDI
00941257 : POP ESI
00941258 : POP EBX
00941259 : MOV ECX,dword ptr [EBP + -0x10]
0094125c : XOR ECX,EBP
0094125e : CALL 0x00633e6b
00941263 : MOV ESP,EBP
00941265 : POP EBP
00941266 : RET 0x8

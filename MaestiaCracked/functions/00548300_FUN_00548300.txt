PROGRAM  : Maestia.exe
FUNCTION : FUN_00548300
ENTRY    : 00548300
BODY     : [[00548300, 0054843d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00548300(undefined4 param_1,undefined4 *param_2,uint param_3)

{
  uint *puVar1;
  uint *puVar2;
  int *piVar3;
  uint *puVar4;
  int *in_ECX;
  uint *puVar5;
  uint uVar6;
  uint uVar7;
  int iVar8;
  
  piVar3 = (int *)*in_ECX;
  if (piVar3 == (int *)0x0) {
    iVar8 = 8;
  }
  else {
    if ((uint)(*piVar3 * 5) <= piVar3[1] * 4 + 4U) goto LAB_0054833a;
    iVar8 = piVar3[1] * 2 + 2;
  }
  FUN_00547ba0(param_1,iVar8);
LAB_0054833a:
  piVar3 = (int *)*in_ECX;
  param_3 = param_3 & piVar3[1];
  *piVar3 = *piVar3 + 1;
  iVar8 = *in_ECX;
  puVar1 = (uint *)(iVar8 + 8 + param_3 * 0xc);
  if (*(int *)(iVar8 + 8 + param_3 * 0xc) == -2) {
    *puVar1 = 0xffffffff;
    puVar1[1] = *(uint *)*param_2;
    puVar4 = (uint *)param_2[1];
    piVar3 = (int *)*puVar4;
    if (piVar3 != (int *)0x0) {
      *piVar3 = *piVar3 + 1;
    }
    puVar1[2] = *puVar4;
    return;
  }
  uVar6 = param_3;
  do {
    uVar6 = uVar6 + 1 & *(uint *)(iVar8 + 4);
  } while (*(int *)(iVar8 + 8 + uVar6 * 0xc) != -2);
  puVar5 = puVar1 + 1;
  puVar4 = (uint *)(iVar8 + 8 + uVar6 * 0xc);
  uVar7 = *puVar5 & *(uint *)(iVar8 + 4);
  if (uVar7 != param_3) {
    puVar2 = (uint *)(iVar8 + 8 + uVar7 * 0xc);
    for (uVar7 = *(uint *)(iVar8 + 8 + uVar7 * 0xc); uVar7 != param_3;
        uVar7 = *(uint *)(iVar8 + 8 + uVar7 * 0xc)) {
      uVar7 = *puVar2;
      puVar2 = (uint *)(iVar8 + 8 + uVar7 * 0xc);
    }
    if (puVar4 != (uint *)0x0) {
      *puVar4 = *puVar1;
      puVar4[1] = *puVar5;
      piVar3 = (int *)puVar1[2];
      if (piVar3 != (int *)0x0) {
        *piVar3 = *piVar3 + 1;
      }
      puVar4[2] = puVar1[2];
    }
    *puVar2 = uVar6;
    FUN_00545800(param_2);
    *puVar1 = 0xffffffff;
    return;
  }
  if (puVar4 != (uint *)0x0) {
    *puVar4 = *puVar1;
    puVar4[1] = *puVar5;
    piVar3 = (int *)puVar1[2];
    if (piVar3 != (int *)0x0) {
      *piVar3 = *piVar3 + 1;
    }
    puVar4[2] = puVar1[2];
  }
  FUN_00545800(param_2);
  *puVar1 = uVar6;
  return;
}



============================================================
DISASSEMBLY
============================================================
00548300 : PUSH ESI
00548301 : MOV ESI,ECX
00548303 : MOV EAX,dword ptr [ESI]
00548305 : PUSH EDI
00548306 : TEST EAX,EAX
00548308 : JNZ 0x00548313
0054830a : MOV EAX,dword ptr [ESP + 0xc]
0054830e : PUSH 0x8
00548310 : PUSH EAX
00548311 : JMP 0x00548335
00548313 : MOV ECX,dword ptr [EAX + 0x4]
00548316 : LEA EDX,[ECX*0x4 + 0x4]
0054831d : MOV ECX,dword ptr [EAX]
0054831f : LEA ECX,[ECX + ECX*0x4]
00548322 : CMP ECX,EDX
00548324 : JBE 0x0054833a
00548326 : MOV EDX,dword ptr [EAX + 0x4]
00548329 : MOV ECX,dword ptr [ESP + 0xc]
0054832d : LEA EAX,[EDX + EDX*0x1 + 0x2]
00548331 : PUSH EAX
00548332 : PUSH ECX
00548333 : MOV ECX,ESI
00548335 : CALL 0x00547ba0
0054833a : MOV ECX,dword ptr [ESI]
0054833c : MOV EAX,dword ptr [ESP + 0x14]
00548340 : AND EAX,dword ptr [ECX + 0x4]
00548343 : INC dword ptr [ECX]
00548345 : MOV EDX,dword ptr [ESI]
00548347 : LEA ECX,[EAX + EAX*0x2]
0054834a : MOV ESI,dword ptr [EDX + ECX*0x4 + 0x8]
0054834e : LEA ECX,[EDX + ECX*0x4 + 0x8]
00548352 : MOV EDI,0xfffffffe
00548357 : MOV dword ptr [ESP + 0xc],ECX
0054835b : CMP ESI,EDI
0054835d : JNZ 0x00548385
0054835f : MOV EAX,dword ptr [ESP + 0x10]
00548363 : MOV dword ptr [ECX],0xffffffff
00548369 : MOV EDX,dword ptr [EAX]
0054836b : MOV EDX,dword ptr [EDX]
0054836d : MOV dword ptr [ECX + 0x4],EDX
00548370 : MOV EDX,dword ptr [EAX + 0x4]
00548373 : MOV EAX,dword ptr [EDX]
00548375 : TEST EAX,EAX
00548377 : JZ 0x0054837b
00548379 : INC dword ptr [EAX]
0054837b : MOV EAX,dword ptr [EDX]
0054837d : POP EDI
0054837e : MOV dword ptr [ECX + 0x8],EAX
00548381 : POP ESI
00548382 : RET 0xc
00548385 : PUSH EBX
00548386 : PUSH EBP
00548387 : MOV EBP,dword ptr [EDX + 0x4]
0054838a : MOV ESI,EAX
0054838c : LEA ESP,[ESP]
00548390 : INC ESI
00548391 : AND ESI,EBP
00548393 : LEA EBX,[ESI + ESI*0x2]
00548396 : CMP dword ptr [EDX + EBX*0x4 + 0x8],EDI
0054839a : JNZ 0x00548390
0054839c : LEA EDI,[ESI + ESI*0x2]
0054839f : ADD ECX,0x4
005483a2 : LEA EBX,[EDX + EDI*0x4 + 0x8]
005483a6 : MOV EDI,dword ptr [ECX]
005483a8 : AND EDI,EBP
005483aa : CMP EDI,EAX
005483ac : JNZ 0x005483e5
005483ae : TEST EBX,EBX
005483b0 : JZ 0x005483ce
005483b2 : MOV EDX,dword ptr [ESP + 0x14]
005483b6 : MOV EAX,dword ptr [EDX]
005483b8 : MOV dword ptr [EBX],EAX
005483ba : MOV EAX,dword ptr [ECX]
005483bc : MOV dword ptr [EBX + 0x4],EAX
005483bf : MOV EAX,dword ptr [ECX + 0x4]
005483c2 : TEST EAX,EAX
005483c4 : JZ 0x005483c8
005483c6 : INC dword ptr [EAX]
005483c8 : MOV EDX,dword ptr [ECX + 0x4]
005483cb : MOV dword ptr [EBX + 0x8],EDX
005483ce : MOV EAX,dword ptr [ESP + 0x18]
005483d2 : PUSH EAX
005483d3 : CALL 0x00545800
005483d8 : MOV ECX,dword ptr [ESP + 0x14]
005483dc : POP EBP
005483dd : POP EBX
005483de : POP EDI
005483df : MOV dword ptr [ECX],ESI
005483e1 : POP ESI
005483e2 : RET 0xc
005483e5 : LEA EDI,[EDI + EDI*0x2]
005483e8 : CMP dword ptr [EDX + EDI*0x4 + 0x8],EAX
005483ec : LEA EDI,[EDX + EDI*0x4 + 0x8]
005483f0 : JZ 0x00548401
005483f2 : MOV EDI,dword ptr [EDI]
005483f4 : LEA EDI,[EDI + EDI*0x2]
005483f7 : CMP dword ptr [EDX + EDI*0x4 + 0x8],EAX
005483fb : LEA EDI,[EDX + EDI*0x4 + 0x8]
005483ff : JNZ 0x005483f2
00548401 : TEST EBX,EBX
00548403 : JZ 0x00548421
00548405 : MOV EDX,dword ptr [ESP + 0x14]
00548409 : MOV EAX,dword ptr [EDX]
0054840b : MOV dword ptr [EBX],EAX
0054840d : MOV EAX,dword ptr [ECX]
0054840f : MOV dword ptr [EBX + 0x4],EAX
00548412 : MOV EAX,dword ptr [ECX + 0x4]
00548415 : TEST EAX,EAX
00548417 : JZ 0x0054841b
00548419 : INC dword ptr [EAX]
0054841b : MOV EDX,dword ptr [ECX + 0x4]
0054841e : MOV dword ptr [EBX + 0x8],EDX
00548421 : MOV EAX,dword ptr [ESP + 0x18]
00548425 : PUSH EAX
00548426 : MOV dword ptr [EDI],ESI
00548428 : CALL 0x00545800
0054842d : MOV ECX,dword ptr [ESP + 0x14]
00548431 : POP EBP
00548432 : POP EBX
00548433 : POP EDI
00548434 : MOV dword ptr [ECX],0xffffffff
0054843a : POP ESI
0054843b : RET 0xc

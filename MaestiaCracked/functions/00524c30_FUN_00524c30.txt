PROGRAM  : Maestia.exe
FUNCTION : FUN_00524c30
ENTRY    : 00524c30
BODY     : [[00524c30, 00524d55]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00524c30(char *param_1,uint param_2,char param_3)

{
  char *pcVar1;
  char cVar2;
  undefined4 *puVar3;
  uint uVar4;
  wchar_t *_Str1;
  wchar_t *_Str2;
  int *in_ECX;
  uint uVar5;
  bool bVar6;
  char *local_3f4;
  int *local_3f0;
  wchar_t local_3ec [250];
  wchar_t local_1f8 [250];
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)&local_3f4;
  local_3f4 = param_1;
  if (param_2 == 0xffffffff) {
    pcVar1 = param_1 + 1;
    do {
      cVar2 = *param_1;
      param_1 = param_1 + 1;
    } while (cVar2 != '\0');
    param_2 = (int)param_1 - (int)pcVar1;
  }
  puVar3 = (undefined4 *)*in_ECX;
  uVar5 = puVar3[4];
  local_3f0 = in_ECX;
  if (((puVar3[3] & 0x8000000) == 0) &&
     (uVar4 = FUN_0051b0c0(*puVar3,uVar5), bVar6 = uVar4 == uVar5, uVar5 = uVar4, bVar6)) {
    *(uint *)(*in_ECX + 0xc) = *(uint *)(*in_ECX + 0xc) | 0x8000000;
  }
  if (uVar5 < 0xfa) {
    _Str1 = local_3ec;
  }
  else {
    _Str1 = (wchar_t *)FUN_00515840(uVar5 * 2 + 2,0);
  }
  if (param_2 < 0xfa) {
    _Str2 = local_1f8;
  }
  else {
    _Str2 = (wchar_t *)FUN_00515840(param_2 * 2 + 2,0);
  }
  FUN_0051b030(_Str1,*(undefined4 *)*local_3f0,uVar5);
  FUN_0051b030(_Str2,local_3f4,param_2);
  if (param_3 == '\0') {
    __wcsicoll(_Str1,_Str2);
  }
  else {
    _wcscoll(_Str1,_Str2);
  }
  if (_Str1 != local_3ec) {
    FUN_00515cf0(_Str1);
  }
  if (_Str2 != local_1f8) {
    FUN_00515cf0(_Str2);
  }
  __security_check_cookie(local_4 ^ (uint)&local_3f4);
  return;
}



============================================================
DISASSEMBLY
============================================================
00524c30 : SUB ESP,0x3f4
00524c36 : MOV EAX,[0x00d66fa0]
00524c3b : XOR EAX,ESP
00524c3d : MOV dword ptr [ESP + 0x3f0],EAX
00524c44 : MOV EAX,dword ptr [ESP + 0x3f8]
00524c4b : PUSH EBX
00524c4c : PUSH EBP
00524c4d : MOV EBP,dword ptr [ESP + 0x404]
00524c54 : PUSH ESI
00524c55 : PUSH EDI
00524c56 : MOV EDI,ECX
00524c58 : MOV dword ptr [ESP + 0x14],EDI
00524c5c : MOV dword ptr [ESP + 0x10],EAX
00524c60 : CMP EBP,-0x1
00524c63 : JNZ 0x00524c73
00524c65 : LEA EDX,[EAX + 0x1]
00524c68 : MOV CL,byte ptr [EAX]
00524c6a : INC EAX
00524c6b : TEST CL,CL
00524c6d : JNZ 0x00524c68
00524c6f : SUB EAX,EDX
00524c71 : MOV EBP,EAX
00524c73 : MOV EAX,dword ptr [EDI]
00524c75 : MOV ESI,dword ptr [EAX + 0x10]
00524c78 : MOV EBX,0x8000000
00524c7d : TEST dword ptr [EAX + 0xc],EBX
00524c80 : JZ 0x00524c86
00524c82 : MOV EBX,ESI
00524c84 : JMP 0x00524c9a
00524c86 : MOV EAX,dword ptr [EAX]
00524c88 : PUSH ESI
00524c89 : PUSH EAX
00524c8a : CALL 0x0051b0c0
00524c8f : CMP EAX,ESI
00524c91 : JNZ 0x00524c98
00524c93 : MOV ECX,dword ptr [EDI]
00524c95 : OR dword ptr [ECX + 0xc],EBX
00524c98 : MOV EBX,EAX
00524c9a : CMP EBX,0xfa
00524ca0 : JC 0x00524cb8
00524ca2 : MOV ECX,dword ptr [0x00d73250]
00524ca8 : PUSH 0x0
00524caa : LEA EAX,[EBX + EBX*0x1 + 0x2]
00524cae : PUSH EAX
00524caf : CALL 0x00515840
00524cb4 : MOV EDI,EAX
00524cb6 : JMP 0x00524cbc
00524cb8 : LEA EDI,[ESP + 0x18]
00524cbc : CMP EBP,0xfa
00524cc2 : JC 0x00524cda
00524cc4 : PUSH 0x0
00524cc6 : LEA ECX,[EBP + EBP*0x1 + 0x2]
00524cca : PUSH ECX
00524ccb : MOV ECX,dword ptr [0x00d73250]
00524cd1 : CALL 0x00515840
00524cd6 : MOV ESI,EAX
00524cd8 : JMP 0x00524ce1
00524cda : LEA ESI,[ESP + 0x20c]
00524ce1 : MOV EDX,dword ptr [ESP + 0x14]
00524ce5 : MOV EAX,dword ptr [EDX]
00524ce7 : MOV ECX,dword ptr [EAX]
00524ce9 : PUSH EBX
00524cea : PUSH ECX
00524ceb : PUSH EDI
00524cec : CALL 0x0051b030
00524cf1 : MOV EDX,dword ptr [ESP + 0x10]
00524cf5 : PUSH EBP
00524cf6 : PUSH EDX
00524cf7 : PUSH ESI
00524cf8 : CALL 0x0051b030
00524cfd : CMP byte ptr [ESP + 0x410],0x0
00524d05 : PUSH ESI
00524d06 : PUSH EDI
00524d07 : JZ 0x00524d10
00524d09 : CALL 0x0063c0ae
00524d0e : JMP 0x00524d15
00524d10 : CALL 0x0063bf75
00524d15 : MOV EBX,EAX
00524d17 : LEA EAX,[ESP + 0x20]
00524d1b : ADD ESP,0x8
00524d1e : CMP EDI,EAX
00524d20 : JZ 0x00524d28
00524d22 : PUSH EDI
00524d23 : CALL 0x00515cf0
00524d28 : LEA ECX,[ESP + 0x20c]
00524d2f : CMP ESI,ECX
00524d31 : JZ 0x00524d39
00524d33 : PUSH ESI
00524d34 : CALL 0x00515cf0
00524d39 : MOV ECX,dword ptr [ESP + 0x400]
00524d40 : POP EDI
00524d41 : POP ESI
00524d42 : POP EBP
00524d43 : MOV EAX,EBX
00524d45 : POP EBX
00524d46 : XOR ECX,ESP
00524d48 : CALL 0x00633e6b
00524d4d : ADD ESP,0x3f4
00524d53 : RET 0xc

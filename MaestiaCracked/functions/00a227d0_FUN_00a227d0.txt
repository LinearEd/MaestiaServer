PROGRAM  : Maestia.exe
FUNCTION : FUN_00a227d0
ENTRY    : 00a227d0
BODY     : [[00a227d0, 00a229db]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_00a227d0(int *param_1,uint param_2,uint param_3,int param_4,int *param_5)

{
  char cVar1;
  short sVar2;
  int iVar3;
  uint *puVar4;
  uint *puVar5;
  int *piVar6;
  int *piVar7;
  uint *puVar8;
  uint uVar9;
  int *piVar10;
  int *local_20;
  int *local_1c;
  int *local_18;
  uint local_14;
  uint local_10;
  byte local_9;
  
  iVar3 = *(int *)(DAT_0172491c + 0x17c);
  local_9 = 0;
  if (iVar3 != 0) {
    local_9 = *(byte *)(iVar3 + 0xa0);
  }
  local_14 = 0;
  if (iVar3 != 0) {
    sVar2 = *(short *)(iVar3 + 0x80);
    if (sVar2 == 0) {
      sVar2 = *(short *)(iVar3 + 0x7c);
    }
    local_14 = 1 << ((byte)sVar2 & 0x1f);
  }
  uVar9 = local_14;
  local_10 = 10000;
  local_18 = param_1;
  FUN_00407fc0(&local_20,&local_18);
  piVar6 = local_1c;
  if (local_20 == local_1c) {
    return 10000;
  }
  local_18 = local_20;
  do {
    if ((local_18[9] & uVar9) != 0) {
      if (param_2 == *(ushort *)(local_18 + 10)) {
        *param_5 = (int)(local_18 + 4);
        return param_3;
      }
      if (DAT_01721070 < param_3) {
        *param_5 = 0;
        return param_3;
      }
    }
    FUN_0040b870();
    piVar10 = local_20;
  } while (local_18 != piVar6);
  do {
    puVar4 = *(uint **)(param_4 + 4);
    puVar5 = *(uint **)(param_4 + 8);
    if (puVar4 == puVar5) {
LAB_00a228ac:
      if ((piVar10[9] & local_14) != 0) {
        if (puVar4 == (uint *)0x0) {
          uVar9 = 0;
        }
        else {
          uVar9 = *(int *)(param_4 + 0xc) - (int)puVar4 >> 2;
        }
        if ((uint)((int)puVar5 - (int)puVar4 >> 2) < uVar9) {
          *puVar5 = (uint)param_1;
          *(uint **)(param_4 + 8) = puVar5 + 1;
        }
        else {
          FUN_00408c10(param_4,puVar5,1,&param_1);
        }
        uVar9 = FUN_00a227d0((short)piVar10[10],param_2,param_3 + 1,param_4,&local_18);
        if (((uVar9 != 10000) &&
            (((local_10 == 10000 ||
              ((local_9 < *(byte *)(*param_5 + 0x38) && (*(byte *)(piVar10 + 0x12) <= local_9)))) ||
             (((int)uVar9 < (int)local_10 && (*(byte *)(piVar10 + 0x12) <= local_9)))))) &&
           (local_10 = uVar9, param_5 != (int *)0x0)) {
          *param_5 = (int)(piVar10 + 4);
        }
        if ((*(int *)(param_4 + 8) - *(int *)(param_4 + 4) & 0xfffffffcU) != 0) {
          *(int *)(param_4 + 8) = *(int *)(param_4 + 8) + -4;
        }
      }
    }
    else {
      puVar8 = puVar4;
      do {
        if (*puVar8 == (uint)*(ushort *)(piVar10 + 10)) break;
        puVar8 = puVar8 + 1;
      } while (puVar8 != puVar5);
      if (puVar8 == puVar5) goto LAB_00a228ac;
    }
    if (*(char *)((int)piVar10 + 0x51) == '\0') {
      piVar6 = (int *)piVar10[2];
      if (*(char *)((int)piVar6 + 0x51) == '\0') {
        cVar1 = *(char *)(*piVar6 + 0x51);
        piVar10 = piVar6;
        piVar6 = (int *)*piVar6;
        while (cVar1 == '\0') {
          cVar1 = *(char *)(*piVar6 + 0x51);
          piVar10 = piVar6;
          piVar6 = (int *)*piVar6;
        }
      }
      else {
        cVar1 = *(char *)(piVar10[1] + 0x51);
        piVar7 = (int *)piVar10[1];
        piVar6 = piVar10;
        while ((piVar10 = piVar7, cVar1 == '\0' && (piVar6 == (int *)piVar10[2]))) {
          cVar1 = *(char *)(piVar10[1] + 0x51);
          piVar7 = (int *)piVar10[1];
          piVar6 = piVar10;
        }
      }
    }
    if (piVar10 == local_1c) {
      return local_10;
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
00a227d0 : PUSH EBP
00a227d1 : MOV EBP,ESP
00a227d3 : SUB ESP,0x20
00a227d6 : MOV EAX,[0x0172491c]
00a227db : MOV EAX,dword ptr [EAX + 0x17c]
00a227e1 : PUSH EBX
00a227e2 : PUSH ESI
00a227e3 : PUSH EDI
00a227e4 : MOV byte ptr [EBP + -0x5],0x0
00a227e8 : TEST EAX,EAX
00a227ea : JZ 0x00a227f5
00a227ec : MOV CL,byte ptr [EAX + 0xa0]
00a227f2 : MOV byte ptr [EBP + -0x5],CL
00a227f5 : XOR EDI,EDI
00a227f7 : MOV dword ptr [EBP + -0x10],EDI
00a227fa : TEST EAX,EAX
00a227fc : JZ 0x00a2281d
00a227fe : MOVZX ECX,word ptr [EAX + 0x80]
00a22805 : TEST CX,CX
00a22808 : MOVZX ECX,CX
00a2280b : JNZ 0x00a22811
00a2280d : MOVZX ECX,word ptr [EAX + 0x7c]
00a22811 : MOV EAX,0x1
00a22816 : SHL EAX,CL
00a22818 : MOV dword ptr [EBP + -0x10],EAX
00a2281b : MOV EDI,EAX
00a2281d : MOV EDX,dword ptr [EBP + 0x8]
00a22820 : LEA EAX,[EBP + -0x14]
00a22823 : PUSH EAX
00a22824 : LEA ECX,[EBP + -0x1c]
00a22827 : PUSH ECX
00a22828 : MOV dword ptr [EBP + -0xc],0x2710
00a2282f : MOV dword ptr [EBP + -0x14],EDX
00a22832 : CALL 0x00407fc0
00a22837 : MOV EBX,dword ptr [EBP + -0x1c]
00a2283a : MOV ESI,dword ptr [EBP + -0x18]
00a2283d : CMP EBX,ESI
00a2283f : JNZ 0x00a2284d
00a22841 : MOV EAX,0x2710
00a22846 : POP EDI
00a22847 : POP ESI
00a22848 : POP EBX
00a22849 : MOV ESP,EBP
00a2284b : POP EBP
00a2284c : RET
00a2284d : MOV EAX,EBX
00a2284f : MOV dword ptr [EBP + -0x14],EAX
00a22852 : ADD EAX,0x10
00a22855 : TEST dword ptr [EAX + 0x14],EDI
00a22858 : JZ 0x00a2286e
00a2285a : MOVZX EDX,word ptr [EAX + 0x18]
00a2285e : CMP dword ptr [EBP + 0xc],EDX
00a22861 : JZ 0x00a228c0
00a22863 : MOV EAX,dword ptr [EBP + 0x10]
00a22866 : CMP EAX,dword ptr [0x01721070]
00a2286c : JA 0x00a228cf
00a2286e : LEA EDX,[EBP + -0x14]
00a22871 : CALL 0x0040b870
00a22876 : MOV EAX,dword ptr [EBP + -0x14]
00a22879 : CMP EAX,ESI
00a2287b : JNZ 0x00a22852
00a2287d : LEA ECX,[ECX]
00a22880 : MOV ESI,dword ptr [EBP + 0x14]
00a22883 : MOV EDX,dword ptr [ESI + 0x4]
00a22886 : MOV ECX,dword ptr [ESI + 0x8]
00a22889 : MOV EAX,EDX
00a2288b : LEA EDI,[EBX + 0x10]
00a2288e : CMP EAX,ECX
00a22890 : JZ 0x00a228ac
00a22892 : MOVZX ESI,word ptr [EDI + 0x18]
00a22896 : CMP dword ptr [EAX],ESI
00a22898 : JZ 0x00a228a1
00a2289a : ADD EAX,0x4
00a2289d : CMP EAX,ECX
00a2289f : JNZ 0x00a22896
00a228a1 : MOV ESI,dword ptr [EBP + 0x14]
00a228a4 : CMP EAX,ECX
00a228a6 : JNZ 0x00a22982
00a228ac : MOV EAX,dword ptr [EBP + -0x10]
00a228af : TEST dword ptr [EDI + 0x14],EAX
00a228b2 : JZ 0x00a22982
00a228b8 : TEST EDX,EDX
00a228ba : JNZ 0x00a228df
00a228bc : XOR EAX,EAX
00a228be : JMP 0x00a228e7
00a228c0 : MOV ECX,dword ptr [EBP + 0x18]
00a228c3 : MOV dword ptr [ECX],EAX
00a228c5 : MOV EAX,dword ptr [EBP + 0x10]
00a228c8 : POP EDI
00a228c9 : POP ESI
00a228ca : POP EBX
00a228cb : MOV ESP,EBP
00a228cd : POP EBP
00a228ce : RET
00a228cf : MOV EDX,dword ptr [EBP + 0x18]
00a228d2 : MOV dword ptr [EDX],0x0
00a228d8 : POP EDI
00a228d9 : POP ESI
00a228da : POP EBX
00a228db : MOV ESP,EBP
00a228dd : POP EBP
00a228de : RET
00a228df : MOV EAX,dword ptr [ESI + 0xc]
00a228e2 : SUB EAX,EDX
00a228e4 : SAR EAX,0x2
00a228e7 : MOV ESI,ECX
00a228e9 : SUB ESI,EDX
00a228eb : SAR ESI,0x2
00a228ee : CMP ESI,EAX
00a228f0 : MOV EAX,dword ptr [EBP + 0x14]
00a228f3 : JNC 0x00a22902
00a228f5 : MOV EDX,dword ptr [EBP + 0x8]
00a228f8 : MOV dword ptr [ECX],EDX
00a228fa : ADD ECX,0x4
00a228fd : MOV dword ptr [EAX + 0x8],ECX
00a22900 : JMP 0x00a2290f
00a22902 : LEA EDX,[EBP + 0x8]
00a22905 : PUSH EDX
00a22906 : PUSH 0x1
00a22908 : PUSH ECX
00a22909 : PUSH EAX
00a2290a : CALL 0x00408c10
00a2290f : MOV EDX,dword ptr [EBP + 0x14]
00a22912 : MOV EAX,dword ptr [EBP + 0x10]
00a22915 : LEA ECX,[EBP + -0x14]
00a22918 : PUSH ECX
00a22919 : MOV ECX,dword ptr [EBP + 0xc]
00a2291c : PUSH EDX
00a2291d : MOVZX EDX,word ptr [EDI + 0x18]
00a22921 : INC EAX
00a22922 : PUSH EAX
00a22923 : PUSH ECX
00a22924 : PUSH EDX
00a22925 : CALL 0x00a227d0
00a2292a : ADD ESP,0x14
00a2292d : CMP EAX,0x2710
00a22932 : JZ 0x00a22969
00a22934 : MOV DL,byte ptr [EBP + -0x5]
00a22937 : CMP DL,byte ptr [EDI + 0x38]
00a2293a : SETNC CL
00a2293d : CMP dword ptr [EBP + -0xc],0x2710
00a22944 : JZ 0x00a2295d
00a22946 : MOV ESI,dword ptr [EBP + 0x18]
00a22949 : MOV ESI,dword ptr [ESI]
00a2294b : CMP DL,byte ptr [ESI + 0x38]
00a2294e : JNC 0x00a22954
00a22950 : TEST CL,CL
00a22952 : JNZ 0x00a2295d
00a22954 : CMP EAX,dword ptr [EBP + -0xc]
00a22957 : JGE 0x00a22969
00a22959 : TEST CL,CL
00a2295b : JZ 0x00a22969
00a2295d : MOV dword ptr [EBP + -0xc],EAX
00a22960 : MOV EAX,dword ptr [EBP + 0x18]
00a22963 : TEST EAX,EAX
00a22965 : JZ 0x00a22969
00a22967 : MOV dword ptr [EAX],EDI
00a22969 : MOV ECX,dword ptr [EBP + 0x14]
00a2296c : MOV EAX,dword ptr [ECX + 0x8]
00a2296f : MOV EDX,EAX
00a22971 : SUB EDX,dword ptr [ECX + 0x4]
00a22974 : TEST EDX,0xfffffffc
00a2297a : JZ 0x00a22982
00a2297c : ADD EAX,-0x4
00a2297f : MOV dword ptr [ECX + 0x8],EAX
00a22982 : CMP byte ptr [EBX + 0x51],0x0
00a22986 : JNZ 0x00a229c9
00a22988 : MOV ECX,dword ptr [EBX + 0x8]
00a2298b : CMP byte ptr [ECX + 0x51],0x0
00a2298f : JNZ 0x00a229ae
00a22991 : MOV EAX,dword ptr [ECX]
00a22993 : CMP byte ptr [EAX + 0x51],0x0
00a22997 : JNZ 0x00a229aa
00a22999 : LEA ESP,[ESP]
00a229a0 : MOV ECX,EAX
00a229a2 : MOV EAX,dword ptr [ECX]
00a229a4 : CMP byte ptr [EAX + 0x51],0x0
00a229a8 : JZ 0x00a229a0
00a229aa : MOV EBX,ECX
00a229ac : JMP 0x00a229c9
00a229ae : MOV EAX,dword ptr [EBX + 0x4]
00a229b1 : CMP byte ptr [EAX + 0x51],0x0
00a229b5 : JNZ 0x00a229c7
00a229b7 : CMP EBX,dword ptr [EAX + 0x8]
00a229ba : JNZ 0x00a229c7
00a229bc : MOV EBX,EAX
00a229be : MOV EAX,dword ptr [EAX + 0x4]
00a229c1 : CMP byte ptr [EAX + 0x51],0x0
00a229c5 : JZ 0x00a229b7
00a229c7 : MOV EBX,EAX
00a229c9 : CMP EBX,dword ptr [EBP + -0x18]
00a229cc : JNZ 0x00a22880
00a229d2 : MOV EAX,dword ptr [EBP + -0xc]
00a229d5 : POP EDI
00a229d6 : POP ESI
00a229d7 : POP EBX
00a229d8 : MOV ESP,EBP
00a229da : POP EBP
00a229db : RET

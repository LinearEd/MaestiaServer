PROGRAM  : Maestia.exe
FUNCTION : FUN_00508ca0
ENTRY    : 00508ca0
BODY     : [[00508ca0, 00508d3e]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00508ca0(undefined4 param_1,undefined4 *param_2)

{
  int *piVar1;
  int *piVar2;
  GRefCountNTSImpl *this;
  uint uVar3;
  int iVar4;
  int *in_ECX;
  int iVar5;
  
  uVar3 = FUN_0051b370((*(uint *)*param_2 & 0xfffffffc) + 8,
                       *(uint *)(*(uint *)*param_2 & 0xfffffffc) & 0x7fffffff,0x1505);
  iVar5 = *in_ECX;
  if (iVar5 != 0) {
    iVar4 = FUN_00503660(param_2,*(uint *)(iVar5 + 4) & uVar3);
    if (-1 < iVar4) {
      iVar5 = (iVar4 + 1) * 0x10 + iVar5;
      FUN_0051bc20(*param_2);
      piVar2 = (int *)param_2[1];
      iVar4 = *piVar2;
      if (iVar4 != 0) {
        piVar1 = (int *)(iVar4 + 4);
        *piVar1 = *piVar1 + 1;
      }
      this = *(GRefCountNTSImpl **)(iVar5 + 4);
      if (this != (GRefCountNTSImpl *)0x0) {
        GRefCountNTSImpl::Release(this);
      }
      *(int *)(iVar5 + 4) = *piVar2;
      return;
    }
  }
  FUN_005084e0(param_1,param_2,uVar3);
  return;
}



============================================================
DISASSEMBLY
============================================================
00508ca0 : PUSH ECX
00508ca1 : PUSH EBX
00508ca2 : PUSH EBP
00508ca3 : PUSH ESI
00508ca4 : PUSH EDI
00508ca5 : MOV EDI,dword ptr [ESP + 0x1c]
00508ca9 : MOV EAX,dword ptr [EDI]
00508cab : MOV EAX,dword ptr [EAX]
00508cad : MOV ESI,ECX
00508caf : MOV ECX,EAX
00508cb1 : AND ECX,0xfffffffc
00508cb4 : MOV ECX,dword ptr [ECX]
00508cb6 : PUSH 0x1505
00508cbb : AND ECX,0x7fffffff
00508cc1 : AND EAX,0xfffffffc
00508cc4 : PUSH ECX
00508cc5 : ADD EAX,0x8
00508cc8 : PUSH EAX
00508cc9 : MOV byte ptr [ESP + 0x1e],0x0
00508cce : MOV byte ptr [ESP + 0x1f],0x0
00508cd3 : CALL 0x0051b370
00508cd8 : MOV EBP,dword ptr [ESI]
00508cda : MOV EBX,EAX
00508cdc : TEST EBP,EBP
00508cde : JZ 0x00508d29
00508ce0 : MOV EDX,dword ptr [EBP + 0x4]
00508ce3 : AND EDX,EBX
00508ce5 : PUSH EDX
00508ce6 : PUSH EDI
00508ce7 : MOV ECX,ESI
00508ce9 : CALL 0x00503660
00508cee : TEST EAX,EAX
00508cf0 : JL 0x00508d29
00508cf2 : LEA ESI,[EAX + 0x1]
00508cf5 : MOV EAX,dword ptr [EDI]
00508cf7 : SHL ESI,0x4
00508cfa : ADD ESI,EBP
00508cfc : PUSH EAX
00508cfd : MOV ECX,ESI
00508cff : CALL 0x0051bc20
00508d04 : MOV EDI,dword ptr [EDI + 0x4]
00508d07 : MOV EAX,dword ptr [EDI]
00508d09 : TEST EAX,EAX
00508d0b : JZ 0x00508d10
00508d0d : INC dword ptr [EAX + 0x4]
00508d10 : MOV ECX,dword ptr [ESI + 0x4]
00508d13 : TEST ECX,ECX
00508d15 : JZ 0x00508d1c
00508d17 : CALL 0x004ff7c0
00508d1c : MOV ECX,dword ptr [EDI]
00508d1e : POP EDI
00508d1f : MOV dword ptr [ESI + 0x4],ECX
00508d22 : POP ESI
00508d23 : POP EBP
00508d24 : POP EBX
00508d25 : POP ECX
00508d26 : RET 0x8
00508d29 : MOV EDX,dword ptr [ESP + 0x18]
00508d2d : PUSH EBX
00508d2e : PUSH EDI
00508d2f : PUSH EDX
00508d30 : MOV ECX,ESI
00508d32 : CALL 0x005084e0
00508d37 : POP EDI
00508d38 : POP ESI
00508d39 : POP EBP
00508d3a : POP EBX
00508d3b : POP ECX
00508d3c : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_004fd960
ENTRY    : 004fd960
BODY     : [[004fd960, 004fda2f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_004fd960(int param_1)

{
  int iVar1;
  char cVar2;
  void *_Src;
  int iVar3;
  int unaff_ESI;
  undefined1 local_148 [324];
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)local_148;
  iVar1 = (param_1 - *(int *)(unaff_ESI + 4)) / 0x140;
  cVar2 = FUN_004fc400(unaff_ESI);
  if ((cVar2 != '\0') && (1 < *(uint *)(unaff_ESI + 8))) {
    _memmove(local_148,(void *)(*(uint *)(unaff_ESI + 8) * 0x140 + -0x140 + *(int *)(unaff_ESI + 4))
             ,0x140);
    iVar3 = iVar1 * 0x140;
    _Src = (void *)(*(int *)(unaff_ESI + 4) + iVar3);
    _memmove((void *)((int)_Src + 0x140),_Src,((*(int *)(unaff_ESI + 8) - iVar1) + -1) * 0x140);
    _memmove((void *)(*(int *)(unaff_ESI + 4) + iVar3),local_148,0x140);
  }
  __security_check_cookie(local_4 ^ (uint)local_148);
  return;
}



============================================================
DISASSEMBLY
============================================================
004fd960 : SUB ESP,0x148
004fd966 : MOV EAX,[0x00d66fa0]
004fd96b : XOR EAX,ESP
004fd96d : MOV dword ptr [ESP + 0x144],EAX
004fd974 : MOV EAX,dword ptr [ESP + 0x14c]
004fd97b : SUB EAX,dword ptr [ESI + 0x4]
004fd97e : PUSH EBX
004fd97f : MOV EDX,EAX
004fd981 : MOV EAX,0x66666667
004fd986 : IMUL EDX
004fd988 : PUSH EDI
004fd989 : SAR EDX,0x7
004fd98c : MOV EDI,EDX
004fd98e : SHR EDI,0x1f
004fd991 : PUSH ESI
004fd992 : MOV EAX,ECX
004fd994 : ADD EDI,EDX
004fd996 : CALL 0x004fc400
004fd99b : TEST AL,AL
004fd99d : JZ 0x004fda15
004fd99f : MOV EAX,dword ptr [ESI + 0x8]
004fd9a2 : CMP EAX,0x1
004fd9a5 : JBE 0x004fda0a
004fd9a7 : MOV ECX,dword ptr [ESI + 0x4]
004fd9aa : LEA EAX,[EAX + EAX*0x4]
004fd9ad : SHL EAX,0x6
004fd9b0 : LEA EDX,[EAX + ECX*0x1 + 0xfffffec0]
004fd9b7 : PUSH 0x140
004fd9bc : PUSH EDX
004fd9bd : LEA EAX,[ESP + 0x10]
004fd9c1 : PUSH EAX
004fd9c2 : CALL 0x00636880
004fd9c7 : MOV EAX,dword ptr [ESI + 0x8]
004fd9ca : MOV ECX,dword ptr [ESI + 0x4]
004fd9cd : SUB EAX,EDI
004fd9cf : DEC EAX
004fd9d0 : LEA EDX,[EAX + EAX*0x4]
004fd9d3 : ADD ESP,0xc
004fd9d6 : LEA EBX,[EDI + EDI*0x4]
004fd9d9 : SHL EDX,0x6
004fd9dc : SHL EBX,0x6
004fd9df : ADD ECX,EBX
004fd9e1 : PUSH EDX
004fd9e2 : PUSH ECX
004fd9e3 : ADD ECX,0x140
004fd9e9 : PUSH ECX
004fd9ea : CALL 0x00636880
004fd9ef : MOV ECX,dword ptr [ESI + 0x4]
004fd9f2 : ADD ESP,0xc
004fd9f5 : PUSH 0x140
004fd9fa : LEA EAX,[ESP + 0xc]
004fd9fe : PUSH EAX
004fd9ff : ADD ECX,EBX
004fda01 : PUSH ECX
004fda02 : CALL 0x00636880
004fda07 : ADD ESP,0xc
004fda0a : LEA EAX,[EDI + EDI*0x4]
004fda0d : SHL EAX,0x6
004fda10 : ADD EAX,dword ptr [ESI + 0x4]
004fda13 : JMP 0x004fda17
004fda15 : XOR EAX,EAX
004fda17 : MOV ECX,dword ptr [ESP + 0x14c]
004fda1e : POP EDI
004fda1f : POP EBX
004fda20 : XOR ECX,ESP
004fda22 : CALL 0x00633e6b
004fda27 : ADD ESP,0x148
004fda2d : RET 0x4

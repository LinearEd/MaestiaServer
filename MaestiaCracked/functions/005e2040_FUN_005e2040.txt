PROGRAM  : Maestia.exe
FUNCTION : FUN_005e2040
ENTRY    : 005e2040
BODY     : [[005e2040, 005e216d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005e2040(undefined4 param_1,undefined4 *param_2,uint param_3)

{
  undefined2 *puVar1;
  uint *puVar2;
  int *piVar3;
  int iVar4;
  int *in_ECX;
  uint uVar5;
  uint uVar6;
  int iVar7;
  
  piVar3 = (int *)*in_ECX;
  if (piVar3 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar3 * 5) <= piVar3[1] * 4 + 4U) goto LAB_005e207a;
    iVar7 = piVar3[1] * 2 + 2;
  }
  FUN_005e10a0(param_1,iVar7);
LAB_005e207a:
  piVar3 = (int *)*in_ECX;
  param_3 = param_3 & piVar3[1];
  *piVar3 = *piVar3 + 1;
  iVar7 = *in_ECX;
  iVar4 = *(int *)(iVar7 + 8 + param_3 * 8);
  if (iVar4 == -2) {
    *(undefined4 *)(iVar7 + 8 + param_3 * 8) = 0xffffffff;
    puVar1 = (undefined2 *)(iVar7 + 0xc + param_3 * 8);
    *puVar1 = *(undefined2 *)*param_2;
    puVar1[1] = *(undefined2 *)param_2[1];
    return;
  }
  uVar5 = param_3;
  do {
    uVar5 = uVar5 + 1 & *(uint *)(iVar7 + 4);
  } while (*(int *)(iVar7 + 8 + uVar5 * 8) != -2);
  uVar6 = (uint)*(ushort *)(iVar7 + 0xc + param_3 * 8) & *(uint *)(iVar7 + 4);
  piVar3 = (int *)(iVar7 + 8 + uVar5 * 8);
  if (uVar6 != param_3) {
    puVar2 = (uint *)(iVar7 + 8 + uVar6 * 8);
    for (uVar6 = *(uint *)(iVar7 + 8 + uVar6 * 8); uVar6 != param_3;
        uVar6 = *(uint *)(iVar7 + 8 + uVar6 * 8)) {
      uVar6 = *puVar2;
      puVar2 = (uint *)(iVar7 + 8 + uVar6 * 8);
    }
    if (piVar3 != (int *)0x0) {
      *piVar3 = iVar4;
      *(undefined2 *)(piVar3 + 1) = *(undefined2 *)(iVar7 + 0xc + param_3 * 8);
      *(undefined2 *)((int)piVar3 + 6) = *(undefined2 *)(iVar7 + 0xe + param_3 * 8);
    }
    *puVar2 = uVar5;
    *(undefined2 *)(iVar7 + 0xc + param_3 * 8) = *(undefined2 *)*param_2;
    *(undefined2 *)(iVar7 + 0xe + param_3 * 8) = *(undefined2 *)param_2[1];
    *(undefined4 *)(iVar7 + 8 + param_3 * 8) = 0xffffffff;
    return;
  }
  if (piVar3 != (int *)0x0) {
    *piVar3 = iVar4;
    *(undefined2 *)(piVar3 + 1) = *(undefined2 *)(iVar7 + 0xc + param_3 * 8);
    *(undefined2 *)((int)piVar3 + 6) = *(undefined2 *)(iVar7 + 0xe + param_3 * 8);
  }
  *(undefined2 *)(iVar7 + 0xc + param_3 * 8) = *(undefined2 *)*param_2;
  *(undefined2 *)(iVar7 + 0xe + param_3 * 8) = *(undefined2 *)param_2[1];
  *(uint *)(iVar7 + 8 + param_3 * 8) = uVar5;
  return;
}



============================================================
DISASSEMBLY
============================================================
005e2040 : PUSH EBP
005e2041 : PUSH ESI
005e2042 : MOV ESI,ECX
005e2044 : MOV EAX,dword ptr [ESI]
005e2046 : TEST EAX,EAX
005e2048 : JNZ 0x005e2053
005e204a : MOV EAX,dword ptr [ESP + 0xc]
005e204e : PUSH 0x8
005e2050 : PUSH EAX
005e2051 : JMP 0x005e2075
005e2053 : MOV ECX,dword ptr [EAX + 0x4]
005e2056 : LEA EDX,[ECX*0x4 + 0x4]
005e205d : MOV ECX,dword ptr [EAX]
005e205f : LEA ECX,[ECX + ECX*0x4]
005e2062 : CMP ECX,EDX
005e2064 : JBE 0x005e207a
005e2066 : MOV EDX,dword ptr [EAX + 0x4]
005e2069 : MOV ECX,dword ptr [ESP + 0xc]
005e206d : LEA EAX,[EDX + EDX*0x1 + 0x2]
005e2071 : PUSH EAX
005e2072 : PUSH ECX
005e2073 : MOV ECX,ESI
005e2075 : CALL 0x005e10a0
005e207a : MOV EAX,dword ptr [ESI]
005e207c : MOV ECX,dword ptr [ESP + 0x14]
005e2080 : AND ECX,dword ptr [EAX + 0x4]
005e2083 : INC dword ptr [EAX]
005e2085 : MOV EAX,dword ptr [ESI]
005e2087 : MOV EBP,dword ptr [EAX + ECX*0x8 + 0x8]
005e208b : MOV ESI,0xfffffffe
005e2090 : CMP EBP,ESI
005e2092 : JNZ 0x005e20bb
005e2094 : MOV dword ptr [EAX + ECX*0x8 + 0x8],0xffffffff
005e209c : LEA EAX,[EAX + ECX*0x8 + 0xc]
005e20a0 : MOV ECX,dword ptr [ESP + 0x10]
005e20a4 : MOV EDX,dword ptr [ECX]
005e20a6 : MOVZX EDX,word ptr [EDX]
005e20a9 : MOV word ptr [EAX],DX
005e20ac : MOV ECX,dword ptr [ECX + 0x4]
005e20af : MOVZX EDX,word ptr [ECX]
005e20b2 : POP ESI
005e20b3 : MOV word ptr [EAX + 0x2],DX
005e20b7 : POP EBP
005e20b8 : RET 0xc
005e20bb : PUSH EBX
005e20bc : MOV EBX,dword ptr [EAX + 0x4]
005e20bf : MOV EDX,ECX
005e20c1 : INC EDX
005e20c2 : AND EDX,EBX
005e20c4 : CMP dword ptr [EAX + EDX*0x8 + 0x8],ESI
005e20c8 : JNZ 0x005e20c1
005e20ca : MOVZX ESI,word ptr [EAX + ECX*0x8 + 0xc]
005e20cf : AND ESI,EBX
005e20d1 : PUSH EDI
005e20d2 : LEA EDI,[EAX + EDX*0x8 + 0x8]
005e20d6 : CMP ESI,ECX
005e20d8 : JNZ 0x005e2116
005e20da : TEST EDI,EDI
005e20dc : JZ 0x005e20f2
005e20de : MOV dword ptr [EDI],EBP
005e20e0 : MOVZX ESI,word ptr [EAX + ECX*0x8 + 0xc]
005e20e5 : MOV word ptr [EDI + 0x4],SI
005e20e9 : MOVZX ESI,word ptr [EAX + ECX*0x8 + 0xe]
005e20ee : MOV word ptr [EDI + 0x6],SI
005e20f2 : MOV ESI,dword ptr [ESP + 0x18]
005e20f6 : MOV EDI,dword ptr [ESI]
005e20f8 : MOV DI,word ptr [EDI]
005e20fb : MOV word ptr [EAX + ECX*0x8 + 0xc],DI
005e2100 : MOV ESI,dword ptr [ESI + 0x4]
005e2103 : MOV SI,word ptr [ESI]
005e2106 : POP EDI
005e2107 : POP EBX
005e2108 : MOV word ptr [EAX + ECX*0x8 + 0xe],SI
005e210d : POP ESI
005e210e : MOV dword ptr [EAX + ECX*0x8 + 0x8],EDX
005e2112 : POP EBP
005e2113 : RET 0xc
005e2116 : CMP dword ptr [EAX + ESI*0x8 + 0x8],ECX
005e211a : LEA ESI,[EAX + ESI*0x8 + 0x8]
005e211e : JZ 0x005e212c
005e2120 : MOV ESI,dword ptr [ESI]
005e2122 : CMP dword ptr [EAX + ESI*0x8 + 0x8],ECX
005e2126 : LEA ESI,[EAX + ESI*0x8 + 0x8]
005e212a : JNZ 0x005e2120
005e212c : TEST EDI,EDI
005e212e : JZ 0x005e2144
005e2130 : MOV dword ptr [EDI],EBP
005e2132 : MOVZX EBX,word ptr [EAX + ECX*0x8 + 0xc]
005e2137 : MOV word ptr [EDI + 0x4],BX
005e213b : MOVZX EBX,word ptr [EAX + ECX*0x8 + 0xe]
005e2140 : MOV word ptr [EDI + 0x6],BX
005e2144 : MOV dword ptr [ESI],EDX
005e2146 : MOV EDX,dword ptr [ESP + 0x18]
005e214a : MOV ESI,dword ptr [EDX]
005e214c : MOV SI,word ptr [ESI]
005e214f : MOV word ptr [EAX + ECX*0x8 + 0xc],SI
005e2154 : MOV EDX,dword ptr [EDX + 0x4]
005e2157 : MOV DX,word ptr [EDX]
005e215a : POP EDI
005e215b : POP EBX
005e215c : POP ESI
005e215d : MOV word ptr [EAX + ECX*0x8 + 0xe],DX
005e2162 : MOV dword ptr [EAX + ECX*0x8 + 0x8],0xffffffff
005e216a : POP EBP
005e216b : RET 0xc

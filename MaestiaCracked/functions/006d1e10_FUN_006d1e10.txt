PROGRAM  : Maestia.exe
FUNCTION : FUN_006d1e10
ENTRY    : 006d1e10
BODY     : [[006d1e10, 006d1f30]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006d1e10(int param_1,int param_2,int param_3)

{
  int iVar1;
  undefined1 local_18 [2];
  undefined1 local_16;
  undefined1 local_15;
  undefined1 local_14;
  undefined1 local_13;
  undefined1 local_12;
  uint local_10;
  undefined2 local_c;
  undefined1 local_a;
  undefined1 local_9;
  undefined1 local_8;
  undefined1 local_7;
  undefined1 local_6;
  
  local_10 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  if ((*(uint *)(param_1 + 0x68) & 1) == 0) {
    FUN_006c23a0(param_1,"Out of place tIME chunk");
  }
  else if ((param_2 != 0) && ((*(uint *)(param_2 + 8) & 0x200) != 0)) {
    FUN_006c24c0(param_1,"Duplicate tIME chunk");
    FUN_006cf140(param_1,param_3);
    goto LAB_006d1f23;
  }
  if ((*(uint *)(param_1 + 0x68) & 4) != 0) {
    *(uint *)(param_1 + 0x68) = *(uint *)(param_1 + 0x68) | 8;
  }
  if (param_3 == 7) {
    FUN_006cf100(param_1,local_18,7);
    iVar1 = FUN_006cf140(param_1,0);
    if (iVar1 == 0) {
      local_6 = local_12;
      local_7 = local_13;
      local_8 = local_14;
      local_9 = local_15;
      local_a = local_16;
      local_c = FUN_006cf0d0(local_18);
      FUN_006ce810(param_1,param_2,&local_c);
    }
  }
  else {
    FUN_006c24c0(param_1,"Incorrect tIME chunk length");
    FUN_006cf140(param_1,param_3);
  }
LAB_006d1f23:
  __security_check_cookie(local_10 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
006d1e10 : PUSH EBP
006d1e11 : MOV EBP,ESP
006d1e13 : SUB ESP,0x14
006d1e16 : MOV EAX,[0x00d66fa0]
006d1e1b : XOR EAX,EBP
006d1e1d : MOV dword ptr [EBP + -0xc],EAX
006d1e20 : MOV EAX,dword ptr [EBP + 0x8]
006d1e23 : MOV ECX,dword ptr [EAX + 0x68]
006d1e26 : AND ECX,0x1
006d1e29 : JNZ 0x006d1e3e
006d1e2b : PUSH 0xbeeca4
006d1e30 : MOV EDX,dword ptr [EBP + 0x8]
006d1e33 : PUSH EDX
006d1e34 : CALL 0x006c23a0
006d1e39 : ADD ESP,0x8
006d1e3c : JMP 0x006d1e78
006d1e3e : CMP dword ptr [EBP + 0xc],0x0
006d1e42 : JZ 0x006d1e78
006d1e44 : MOV EAX,dword ptr [EBP + 0xc]
006d1e47 : MOV ECX,dword ptr [EAX + 0x8]
006d1e4a : AND ECX,0x200
006d1e50 : JZ 0x006d1e78
006d1e52 : PUSH 0xbeec8c
006d1e57 : MOV EDX,dword ptr [EBP + 0x8]
006d1e5a : PUSH EDX
006d1e5b : CALL 0x006c24c0
006d1e60 : ADD ESP,0x8
006d1e63 : MOV EAX,dword ptr [EBP + 0x10]
006d1e66 : PUSH EAX
006d1e67 : MOV ECX,dword ptr [EBP + 0x8]
006d1e6a : PUSH ECX
006d1e6b : CALL 0x006cf140
006d1e70 : ADD ESP,0x8
006d1e73 : JMP 0x006d1f23
006d1e78 : MOV EDX,dword ptr [EBP + 0x8]
006d1e7b : MOV EAX,dword ptr [EDX + 0x68]
006d1e7e : AND EAX,0x4
006d1e81 : JZ 0x006d1e92
006d1e83 : MOV ECX,dword ptr [EBP + 0x8]
006d1e86 : MOV EDX,dword ptr [ECX + 0x68]
006d1e89 : OR EDX,0x8
006d1e8c : MOV EAX,dword ptr [EBP + 0x8]
006d1e8f : MOV dword ptr [EAX + 0x68],EDX
006d1e92 : CMP dword ptr [EBP + 0x10],0x7
006d1e96 : JZ 0x006d1ebb
006d1e98 : PUSH 0xbeec70
006d1e9d : MOV ECX,dword ptr [EBP + 0x8]
006d1ea0 : PUSH ECX
006d1ea1 : CALL 0x006c24c0
006d1ea6 : ADD ESP,0x8
006d1ea9 : MOV EDX,dword ptr [EBP + 0x10]
006d1eac : PUSH EDX
006d1ead : MOV EAX,dword ptr [EBP + 0x8]
006d1eb0 : PUSH EAX
006d1eb1 : CALL 0x006cf140
006d1eb6 : ADD ESP,0x8
006d1eb9 : JMP 0x006d1f23
006d1ebb : PUSH 0x7
006d1ebd : LEA ECX,[EBP + -0x14]
006d1ec0 : PUSH ECX
006d1ec1 : MOV EDX,dword ptr [EBP + 0x8]
006d1ec4 : PUSH EDX
006d1ec5 : CALL 0x006cf100
006d1eca : ADD ESP,0xc
006d1ecd : PUSH 0x0
006d1ecf : MOV EAX,dword ptr [EBP + 0x8]
006d1ed2 : PUSH EAX
006d1ed3 : CALL 0x006cf140
006d1ed8 : ADD ESP,0x8
006d1edb : TEST EAX,EAX
006d1edd : JZ 0x006d1ee1
006d1edf : JMP 0x006d1f23
006d1ee1 : MOV CL,byte ptr [EBP + -0xe]
006d1ee4 : MOV byte ptr [EBP + -0x2],CL
006d1ee7 : MOV DL,byte ptr [EBP + -0xf]
006d1eea : MOV byte ptr [EBP + -0x3],DL
006d1eed : MOV AL,byte ptr [EBP + -0x10]
006d1ef0 : MOV byte ptr [EBP + -0x4],AL
006d1ef3 : MOV CL,byte ptr [EBP + -0x11]
006d1ef6 : MOV byte ptr [EBP + -0x5],CL
006d1ef9 : MOV DL,byte ptr [EBP + -0x12]
006d1efc : MOV byte ptr [EBP + -0x6],DL
006d1eff : LEA EAX,[EBP + -0x14]
006d1f02 : PUSH EAX
006d1f03 : CALL 0x006cf0d0
006d1f08 : ADD ESP,0x4
006d1f0b : MOV word ptr [EBP + -0x8],AX
006d1f0f : LEA ECX,[EBP + -0x8]
006d1f12 : PUSH ECX
006d1f13 : MOV EDX,dword ptr [EBP + 0xc]
006d1f16 : PUSH EDX
006d1f17 : MOV EAX,dword ptr [EBP + 0x8]
006d1f1a : PUSH EAX
006d1f1b : CALL 0x006ce810
006d1f20 : ADD ESP,0xc
006d1f23 : MOV ECX,dword ptr [EBP + -0xc]
006d1f26 : XOR ECX,EBP
006d1f28 : CALL 0x00633e6b
006d1f2d : MOV ESP,EBP
006d1f2f : POP EBP
006d1f30 : RET

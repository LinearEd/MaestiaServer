PROGRAM  : Maestia.exe
FUNCTION : FUN_00acb060
ENTRY    : 00acb060
BODY     : [[00acb060, 00acb324]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00acb060(int *param_1)

{
  char cVar1;
  int in_ECX;
  undefined1 auStack_94 [4];
  undefined1 auStack_90 [4];
  undefined4 uStack_8c;
  undefined4 uStack_88;
  int iStack_84;
  undefined4 uStack_80;
  int iStack_7c;
  undefined1 uStack_3b;
  int iStack_28;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_00b63472;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_94;
  ExceptionList = &local_14;
  if (param_1 != (int *)0x0) {
    if (*(int *)(in_ECX + 0xf0) == 0) {
      (**(code **)(*param_1 + 0x2fc))
                (*(undefined4 *)(in_ECX + 0x74),*(int *)(in_ECX + 0x90) + *(int *)(in_ECX + 0x118),0
                 ,*(undefined1 *)(in_ECX + 0xf5),*(char *)(in_ECX + 0xf4) != '\0',in_ECX + 0xf8,
                 *(undefined1 *)(in_ECX + 0x94),*(undefined1 *)(in_ECX + 0x95),
                 DAT_00d66fa0 ^ (uint)&stack0xffffff60);
      if ((*(char *)(in_ECX + 0x94) == '\0') || (*(char *)(in_ECX + 0x95) == '\0'))
      goto LAB_00acb302;
      if (*(char *)(in_ECX + 0xf3) == '\a') {
        FUN_0040e250(auStack_90);
        uStack_c = 1;
        uStack_80 = *(undefined4 *)(in_ECX + 0x74);
        uStack_8c = *(undefined4 *)(in_ECX + 0xf0);
        iStack_84 = param_1[1];
        uStack_3b = *(undefined1 *)(in_ECX + 0xf5);
        iStack_7c = *(int *)(in_ECX + 0x90);
        iStack_28 = (-(uint)(iStack_7c != 0) & 0xffffffee) + 0x14;
        auStack_90[0] = 0xff;
      }
      else {
        FUN_0040e250(auStack_90);
        uStack_c = 2;
        uStack_3b = *(undefined1 *)(in_ECX + 0xf5);
        uStack_80 = *(undefined4 *)(in_ECX + 0x74);
        uStack_8c = *(undefined4 *)(in_ECX + 0xf0);
        iStack_84 = param_1[1];
        uStack_88 = *(undefined4 *)(in_ECX + 0x118);
        cVar1 = *(char *)(in_ECX + 0xf4);
        iStack_7c = *(int *)(in_ECX + 0x90);
        auStack_90[0] = *(undefined1 *)(in_ECX + 0x114);
        if (cVar1 == '\x06') {
          iStack_28 = 0x17;
        }
        else if (cVar1 == '\x02') {
          iStack_28 = 0x15;
        }
        else if ((cVar1 == '\a') || (cVar1 == '\x05')) {
          iStack_28 = 0x16;
        }
        else if ((iStack_7c == 0) && (cVar1 == '\x01')) {
          iStack_28 = 0x14;
        }
        else {
          iStack_28 = 0;
        }
      }
    }
    else {
      (**(code **)(*param_1 + 0x304))
                (*(undefined4 *)(in_ECX + 0x74),*(int *)(in_ECX + 0xf0),
                 *(int *)(in_ECX + 0x90) + *(int *)(in_ECX + 0x118),in_ECX + 0xf8,in_ECX + 0xa4,0xc,
                 *(undefined1 *)(in_ECX + 0x94),0,*(undefined1 *)(in_ECX + 0x95),
                 *(undefined1 *)(in_ECX + 0xf5),*(undefined1 *)(in_ECX + 0x114),
                 *(int *)(in_ECX + 0x118));
      FUN_0040e250(auStack_90);
      uStack_c = 0;
      uStack_80 = *(undefined4 *)(in_ECX + 0x74);
      uStack_8c = *(undefined4 *)(in_ECX + 0xf0);
      iStack_7c = *(int *)(in_ECX + 0x90);
      iStack_84 = param_1[1];
      uStack_3b = *(undefined1 *)(in_ECX + 0xf5);
      auStack_90[0] = *(undefined1 *)(in_ECX + 0x114);
      uStack_88 = *(undefined4 *)(in_ECX + 0x118);
      iStack_28 = 2;
    }
    FUN_00883670(DAT_017248e4);
    uStack_c = 0xffffffff;
    FUN_00406bd0(auStack_90);
  }
LAB_00acb302:
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_94);
  return;
}



============================================================
DISASSEMBLY
============================================================
00acb060 : PUSH EBP
00acb061 : MOV EBP,ESP
00acb063 : AND ESP,0xfffffff8
00acb066 : PUSH -0x1
00acb068 : PUSH 0xb63472
00acb06d : MOV EAX,FS:[0x0]
00acb073 : PUSH EAX
00acb074 : SUB ESP,0x80
00acb07a : MOV EAX,[0x00d66fa0]
00acb07f : XOR EAX,ESP
00acb081 : MOV dword ptr [ESP + 0x78],EAX
00acb085 : PUSH EBX
00acb086 : PUSH ESI
00acb087 : PUSH EDI
00acb088 : MOV EAX,[0x00d66fa0]
00acb08d : XOR EAX,ESP
00acb08f : PUSH EAX
00acb090 : LEA EAX,[ESP + 0x90]
00acb097 : MOV FS:[0x0],EAX
00acb09d : MOV EDI,dword ptr [EBP + 0x8]
00acb0a0 : MOV ESI,ECX
00acb0a2 : TEST EDI,EDI
00acb0a4 : JZ 0x00acb302
00acb0aa : MOV ECX,dword ptr [ESI + 0xf0]
00acb0b0 : TEST ECX,ECX
00acb0b2 : JZ 0x00acb16d
00acb0b8 : MOV EAX,dword ptr [ESI + 0x118]
00acb0be : MOVZX EBX,byte ptr [ESI + 0x114]
00acb0c5 : PUSH EAX
00acb0c6 : PUSH EBX
00acb0c7 : MOVZX EBX,byte ptr [ESI + 0xf5]
00acb0ce : PUSH EBX
00acb0cf : MOVZX EBX,byte ptr [ESI + 0x95]
00acb0d6 : MOV EDX,dword ptr [EDI]
00acb0d8 : PUSH EBX
00acb0d9 : MOVZX EBX,byte ptr [ESI + 0x94]
00acb0e0 : MOV EDX,dword ptr [EDX + 0x304]
00acb0e6 : PUSH 0x0
00acb0e8 : PUSH EBX
00acb0e9 : PUSH 0xc
00acb0eb : LEA EBX,[ESI + 0xa4]
00acb0f1 : PUSH EBX
00acb0f2 : LEA EBX,[ESI + 0xf8]
00acb0f8 : PUSH EBX
00acb0f9 : MOV EBX,dword ptr [ESI + 0x90]
00acb0ff : ADD EBX,EAX
00acb101 : MOV EAX,dword ptr [ESI + 0x74]
00acb104 : PUSH EBX
00acb105 : PUSH ECX
00acb106 : PUSH EAX
00acb107 : MOV ECX,EDI
00acb109 : CALL EDX
00acb10b : LEA EAX,[ESP + 0x14]
00acb10f : PUSH EAX
00acb110 : CALL 0x0040e250
00acb115 : MOV dword ptr [ESP + 0x98],0x0
00acb120 : MOV ECX,dword ptr [ESI + 0x74]
00acb123 : MOV EDX,dword ptr [ESI + 0xf0]
00acb129 : MOV EAX,dword ptr [ESI + 0x90]
00acb12f : MOV EDI,dword ptr [EDI + 0x4]
00acb132 : MOV dword ptr [ESP + 0x24],ECX
00acb136 : MOV CL,byte ptr [ESI + 0xf5]
00acb13c : MOV dword ptr [ESP + 0x18],EDX
00acb140 : MOV DL,byte ptr [ESI + 0x114]
00acb146 : MOV dword ptr [ESP + 0x28],EAX
00acb14a : MOV EAX,dword ptr [ESI + 0x118]
00acb150 : MOV dword ptr [ESP + 0x20],EDI
00acb154 : MOV byte ptr [ESP + 0x69],CL
00acb158 : MOV byte ptr [ESP + 0x14],DL
00acb15c : MOV dword ptr [ESP + 0x1c],EAX
00acb160 : MOV dword ptr [ESP + 0x7c],0x2
00acb168 : JMP 0x00acb2dd
00acb16d : MOVZX ECX,byte ptr [ESI + 0x95]
00acb174 : MOVZX EDX,byte ptr [ESI + 0x94]
00acb17b : CMP byte ptr [ESI + 0xf4],0x0
00acb182 : MOV EAX,dword ptr [EDI]
00acb184 : MOV EAX,dword ptr [EAX + 0x2fc]
00acb18a : PUSH ECX
00acb18b : PUSH EDX
00acb18c : SETNZ DL
00acb18f : LEA ECX,[ESI + 0xf8]
00acb195 : PUSH ECX
00acb196 : MOVZX ECX,DL
00acb199 : MOVZX EDX,byte ptr [ESI + 0xf5]
00acb1a0 : PUSH ECX
00acb1a1 : MOV ECX,dword ptr [ESI + 0x90]
00acb1a7 : ADD ECX,dword ptr [ESI + 0x118]
00acb1ad : PUSH EDX
00acb1ae : MOV EDX,dword ptr [ESI + 0x74]
00acb1b1 : PUSH 0x0
00acb1b3 : PUSH ECX
00acb1b4 : PUSH EDX
00acb1b5 : MOV ECX,EDI
00acb1b7 : CALL EAX
00acb1b9 : CMP byte ptr [ESI + 0x94],0x0
00acb1c0 : FSTP ST0
00acb1c2 : JZ 0x00acb302
00acb1c8 : CMP byte ptr [ESI + 0x95],0x0
00acb1cf : JZ 0x00acb302
00acb1d5 : CMP byte ptr [ESI + 0xf3],0x7
00acb1dc : JNZ 0x00acb239
00acb1de : LEA ECX,[ESP + 0x14]
00acb1e2 : PUSH ECX
00acb1e3 : CALL 0x0040e250
00acb1e8 : MOV dword ptr [ESP + 0x98],0x1
00acb1f3 : MOV EDX,dword ptr [ESI + 0x74]
00acb1f6 : MOV EAX,dword ptr [ESI + 0xf0]
00acb1fc : MOV EDI,dword ptr [EDI + 0x4]
00acb1ff : MOV CL,byte ptr [ESI + 0xf5]
00acb205 : MOV dword ptr [ESP + 0x18],EAX
00acb209 : MOV EAX,dword ptr [ESI + 0x90]
00acb20f : MOV dword ptr [ESP + 0x24],EDX
00acb213 : XOR EDX,EDX
00acb215 : CMP EDX,EAX
00acb217 : MOV dword ptr [ESP + 0x28],EAX
00acb21b : SBB EAX,EAX
00acb21d : AND EAX,0xffffffee
00acb220 : ADD EAX,0x14
00acb223 : MOV dword ptr [ESP + 0x20],EDI
00acb227 : MOV byte ptr [ESP + 0x69],CL
00acb22b : MOV byte ptr [ESP + 0x14],0xff
00acb230 : MOV dword ptr [ESP + 0x7c],EAX
00acb234 : JMP 0x00acb2dd
00acb239 : LEA EAX,[ESP + 0x14]
00acb23d : PUSH EAX
00acb23e : CALL 0x0040e250
00acb243 : MOV dword ptr [ESP + 0x98],0x2
00acb24e : MOVZX EAX,byte ptr [ESI + 0xf5]
00acb255 : MOV ECX,dword ptr [ESI + 0x74]
00acb258 : MOV EDX,dword ptr [ESI + 0xf0]
00acb25e : MOV EDI,dword ptr [EDI + 0x4]
00acb261 : MOV byte ptr [ESP + 0x69],AL
00acb265 : MOV EAX,dword ptr [ESI + 0x118]
00acb26b : MOV dword ptr [ESP + 0x1c],EAX
00acb26f : MOV AL,byte ptr [ESI + 0xf4]
00acb275 : MOV dword ptr [ESP + 0x24],ECX
00acb279 : MOV ECX,dword ptr [ESI + 0x90]
00acb27f : MOV dword ptr [ESP + 0x18],EDX
00acb283 : MOV DL,byte ptr [ESI + 0x114]
00acb289 : MOV dword ptr [ESP + 0x20],EDI
00acb28d : MOV dword ptr [ESP + 0x28],ECX
00acb291 : MOV byte ptr [ESP + 0x14],DL
00acb295 : CMP AL,0x6
00acb297 : JNZ 0x00acb2a3
00acb299 : MOV dword ptr [ESP + 0x7c],0x17
00acb2a1 : JMP 0x00acb2dd
00acb2a3 : CMP AL,0x2
00acb2a5 : JNZ 0x00acb2b1
00acb2a7 : MOV dword ptr [ESP + 0x7c],0x15
00acb2af : JMP 0x00acb2dd
00acb2b1 : CMP AL,0x7
00acb2b3 : JZ 0x00acb2d5
00acb2b5 : CMP AL,0x5
00acb2b7 : JZ 0x00acb2d5
00acb2b9 : TEST ECX,ECX
00acb2bb : JA 0x00acb2cb
00acb2bd : CMP AL,0x1
00acb2bf : JNZ 0x00acb2cb
00acb2c1 : MOV dword ptr [ESP + 0x7c],0x14
00acb2c9 : JMP 0x00acb2dd
00acb2cb : MOV dword ptr [ESP + 0x7c],0x0
00acb2d3 : JMP 0x00acb2dd
00acb2d5 : MOV dword ptr [ESP + 0x7c],0x16
00acb2dd : MOV ECX,dword ptr [0x017248e4]
00acb2e3 : PUSH ECX
00acb2e4 : LEA ECX,[ESP + 0x18]
00acb2e8 : CALL 0x00883670
00acb2ed : MOV dword ptr [ESP + 0x98],0xffffffff
00acb2f8 : LEA EDX,[ESP + 0x14]
00acb2fc : PUSH EDX
00acb2fd : CALL 0x00406bd0
00acb302 : MOV ECX,dword ptr [ESP + 0x90]
00acb309 : MOV dword ptr FS:[0x0],ECX
00acb310 : POP ECX
00acb311 : POP EDI
00acb312 : POP ESI
00acb313 : POP EBX
00acb314 : MOV ECX,dword ptr [ESP + 0x78]
00acb318 : XOR ECX,ESP
00acb31a : CALL 0x00633e6b
00acb31f : MOV ESP,EBP
00acb321 : POP EBP
00acb322 : RET 0x4

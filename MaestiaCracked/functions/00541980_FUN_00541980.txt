PROGRAM  : Maestia.exe
FUNCTION : FUN_00541980
ENTRY    : 00541980
BODY     : [[00541980, 00541d0c] [00541d10, 00541dbf]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00541980(int param_1,undefined4 param_2,uint param_3)

{
  int *piVar1;
  uint uVar2;
  int iVar3;
  char cVar4;
  uint uVar5;
  int *piVar6;
  int iVar7;
  int *piVar8;
  int *in_ECX;
  int iVar9;
  short *psVar10;
  int iVar11;
  int unaff_EBX;
  uint uVar12;
  bool bVar13;
  int unaff_retaddr;
  int *piStack_1c;
  int iStack_18;
  int iStack_10;
  int iStack_8;
  int iStack_4;
  
  uVar5 = FUN_0053c470();
  if ((param_3 == 0xffffffff) || (uVar5 < param_3)) {
    param_3 = uVar5;
  }
  if ((param_3 == 0) || (*(int *)(param_1 + 0x10) == 0)) {
    return 0;
  }
  (**(code **)(*in_ECX + 4))(param_2,param_3,&DAT_00cca874);
  iStack_4 = 0;
  FUN_0053c350(&piStack_1c,param_2,&iStack_4);
  if (((piStack_1c == (int *)0x0) || (iStack_18 < 0)) ||
     (iVar7 = iStack_4, piStack_1c[1] <= iStack_18)) {
    FUN_00540b60(0);
    piStack_1c = in_ECX + 3;
    iStack_18 = 0;
    iVar7 = 0;
  }
  iVar3 = iStack_18;
  piVar8 = piStack_1c;
  if (((piStack_1c == (int *)0x0) || (iStack_18 < 0)) || (piStack_1c[1] <= iStack_18)) {
    iStack_4 = 0;
  }
  else {
    iStack_4 = *(int *)(*(int *)(*piStack_1c + iStack_18 * 4) + 0x1c);
  }
  if (*(int *)(param_1 + 0x10) == 1) {
    piVar1 = (int *)**(int **)(param_1 + 0xc);
    uVar5 = piVar1[1];
    iVar11 = *(int *)(*piStack_1c + iStack_18 * 4);
    if (uVar5 != 0) {
      if ((*piVar1 == 0) || (uVar5 <= uVar5 - 1)) {
        psVar10 = (short *)0x0;
      }
      else {
        psVar10 = (short *)(*piVar1 + (uVar5 - 1) * 2);
      }
      if (*psVar10 == 0) {
        uVar5 = uVar5 - 1;
      }
    }
    FUN_005408a0(*(undefined4 *)(unaff_EBX + 8),piVar1,0,iVar7,uVar5);
    if (iVar7 == 0) {
      FUN_0053c230(*(undefined4 *)(unaff_EBX + 8),piVar1[3]);
    }
    iVar7 = piVar8[1];
    iStack_4 = iStack_4 + *(int *)(iVar11 + 4);
    bVar13 = SBORROW4(iVar3,iVar7);
    iVar3 = iVar3 - iVar7;
  }
  else {
    piVar8 = *(int **)(*piStack_1c + iStack_18 * 4);
    iStack_10 = 0;
    piVar6 = (int *)FUN_00540dc0(&stack0xffffffdc,piVar8[3]);
    FUN_005408a0(*(undefined4 *)(unaff_EBX + 8),piVar8,iVar7,0,piVar8[1] - iVar7);
    piVar1 = (int *)**(int **)(iStack_8 + 0xc);
    uVar5 = piVar1[1];
    uVar12 = piVar8[1] - iVar7;
    if (uVar5 != 0) {
      if ((*piVar1 == 0) || (uVar5 <= uVar5 - 1)) {
        psVar10 = (short *)0x0;
      }
      else {
        psVar10 = (short *)(*piVar1 + (uVar5 - 1) * 2);
      }
      if (*psVar10 == 0) {
        uVar5 = uVar5 - 1;
      }
    }
    FUN_005408a0(*(undefined4 *)(unaff_EBX + 8),piVar1,0,iVar7,uVar5);
    uVar5 = piVar1[1];
    if (uVar5 != 0) {
      if ((*piVar1 == 0) || (uVar5 <= uVar5 - 1)) {
        psVar10 = (short *)0x0;
      }
      else {
        psVar10 = (short *)(*piVar1 + (uVar5 - 1) * 2);
      }
      if (*psVar10 == 0) {
        uVar5 = uVar5 - 1;
      }
    }
    uVar5 = unaff_retaddr - uVar5;
    if (iVar7 == 0) {
      FUN_0053c230(*(undefined4 *)(unaff_EBX + 8),piVar1[3]);
    }
    if (uVar12 != 0) {
      uVar2 = piVar8[1];
      if (uVar2 <= uVar12) {
        uVar12 = uVar2;
      }
      FUN_00540170(uVar2 - uVar12,uVar2);
    }
    uVar12 = piVar8[1];
    if (uVar12 != 0) {
      if ((*piVar8 == 0) || (uVar12 <= uVar12 - 1)) {
        psVar10 = (short *)0x0;
      }
      else {
        psVar10 = (short *)(*piVar8 + (uVar12 - 1) * 2);
      }
      if (*psVar10 == 0) {
        uVar12 = uVar12 - 1;
      }
    }
    iStack_4 = iStack_4 + uVar12;
    if (iStack_18 < piStack_1c[1]) {
      iStack_18 = iStack_18 + 1;
    }
    iVar7 = *(int *)(iStack_8 + 0x10);
    if (0 < iVar7) {
      iStack_10 = 1;
    }
    while( true ) {
      if (((iStack_10 < 0) || (iVar7 <= iStack_10)) || (uVar5 == 0)) goto LAB_00541cbb;
      piVar8 = *(int **)(*(int *)(iStack_8 + 0xc) + iStack_10 * 4);
      uVar12 = piVar8[1];
      if (uVar12 != 0) {
        if ((*piVar8 == 0) || (uVar12 <= uVar12 - 1)) {
          psVar10 = (short *)0x0;
        }
        else {
          psVar10 = (short *)(*piVar8 + (uVar12 - 1) * 2);
        }
        if (*psVar10 == 0) {
          uVar12 = uVar12 - 1;
        }
      }
      if ((uVar5 < uVar12) || ((uVar12 == uVar5 && (cVar4 = FUN_0053b470(), cVar4 == '\0')))) break;
      FUN_00540eb0(&piStack_1c,piVar8);
      iVar7 = *(int *)(iStack_8 + 0x10);
      uVar5 = uVar5 - uVar12;
      iStack_4 = iStack_4 + uVar12;
      if (iStack_10 < iVar7) {
        iStack_10 = iStack_10 + 1;
      }
      if (iStack_18 < piStack_1c[1]) {
        iStack_18 = iStack_18 + 1;
      }
    }
    FUN_005408a0(*(undefined4 *)(unaff_EBX + 8),piVar8,0,0,uVar12);
    FUN_0053c230(*(undefined4 *)(unaff_EBX + 8),piVar8[3]);
LAB_00541cbb:
    piVar6[7] = iStack_4;
    uVar5 = piVar6[1];
    if (uVar5 != 0) {
      if ((*piVar6 == 0) || (uVar5 <= uVar5 - 1)) {
        psVar10 = (short *)0x0;
      }
      else {
        psVar10 = (short *)(*piVar6 + (uVar5 - 1) * 2);
      }
      if (*psVar10 == 0) {
        uVar5 = uVar5 - 1;
      }
    }
    iStack_4 = iStack_4 + uVar5;
    iVar7 = piStack_1c[1];
    bVar13 = SBORROW4(iStack_18,iVar7);
    iVar3 = iStack_18 - iVar7;
  }
  iVar9 = iStack_4;
  iVar11 = iStack_18;
  if (bVar13 != iVar3 < 0) {
    iVar11 = iStack_18 + 1;
    iStack_18 = iVar11;
  }
  while (((-1 < iVar11 && (iVar11 < iVar7)) &&
         (iVar7 = *(int *)(*piStack_1c + iVar11 * 4), *(int *)(iVar7 + 0x1c) != iVar9))) {
    *(int *)(iVar7 + 0x1c) = iVar9;
    iVar9 = iVar9 + *(int *)(iVar7 + 4);
    iVar7 = piStack_1c[1];
    if (iVar11 < iVar7) {
      iVar11 = iVar11 + 1;
    }
  }
  iVar7 = *(int *)(unaff_EBX + 0x10) + -1;
  if ((((-1 < iVar7) && (iVar7 < *(int *)(unaff_EBX + 0x10))) &&
      (piVar8 = *(int **)(*(int *)(unaff_EBX + 0xc) + iVar7 * 4), piVar8 != (int *)0x0)) ||
     (piVar8 = (int *)FUN_00540b60(0), piVar8 != (int *)0x0)) {
    uVar5 = piVar8[1];
    if (uVar5 != 0) {
      if ((*piVar8 == 0) || (uVar5 <= uVar5 - 1)) {
        psVar10 = (short *)0x0;
      }
      else {
        psVar10 = (short *)(*piVar8 + (uVar5 - 1) * 2);
      }
      if ((*psVar10 == 0xd) || (*psVar10 == 10)) goto LAB_00541d98;
    }
    FUN_005406c0(*(undefined4 *)(unaff_EBX + 8),*(undefined4 *)(unaff_EBX + 0x1c));
  }
LAB_00541d98:
  if ((*(byte *)(iStack_8 + 0x20) & 1) != 0) {
    *(byte *)(unaff_EBX + 0x20) = *(byte *)(unaff_EBX + 0x20) | 1;
  }
  return unaff_retaddr;
}



============================================================
DISASSEMBLY
============================================================
00541980 : SUB ESP,0x20
00541983 : PUSH EBP
00541984 : PUSH ESI
00541985 : MOV ESI,dword ptr [ESP + 0x2c]
00541989 : MOV EBP,ECX
0054198b : MOV ECX,ESI
0054198d : MOV dword ptr [ESP + 0x8],EBP
00541991 : CALL 0x0053c470
00541996 : MOV ECX,dword ptr [ESP + 0x34]
0054199a : CMP ECX,-0x1
0054199d : JZ 0x005419a3
0054199f : CMP ECX,EAX
005419a1 : JBE 0x005419a9
005419a3 : MOV ECX,EAX
005419a5 : MOV dword ptr [ESP + 0x34],ECX
005419a9 : TEST ECX,ECX
005419ab : JZ 0x00541db6
005419b1 : CMP dword ptr [ESI + 0x10],0x0
005419b5 : JZ 0x00541db6
005419bb : MOV EAX,dword ptr [EBP]
005419be : MOV EDX,dword ptr [EAX + 0x4]
005419c1 : PUSH EBX
005419c2 : PUSH EDI
005419c3 : MOV EDI,dword ptr [ESP + 0x38]
005419c7 : PUSH 0xcca874
005419cc : PUSH ECX
005419cd : PUSH EDI
005419ce : MOV ECX,EBP
005419d0 : CALL EDX
005419d2 : LEA EAX,[ESP + 0x38]
005419d6 : PUSH EAX
005419d7 : PUSH EDI
005419d8 : LEA ECX,[ESP + 0x28]
005419dc : PUSH ECX
005419dd : MOV ECX,EBP
005419df : MOV dword ptr [ESP + 0x44],0x0
005419e7 : CALL 0x0053c350
005419ec : MOV EDI,dword ptr [ESP + 0x20]
005419f0 : TEST EDI,EDI
005419f2 : JZ 0x00541a01
005419f4 : MOV EBX,dword ptr [ESP + 0x24]
005419f8 : TEST EBX,EBX
005419fa : JL 0x00541a01
005419fc : CMP EBX,dword ptr [EDI + 0x4]
005419ff : JL 0x00541a1b
00541a01 : PUSH 0x0
00541a03 : MOV ECX,EBP
00541a05 : CALL 0x00540b60
00541a0a : LEA EDI,[EBP + 0xc]
00541a0d : XOR EBX,EBX
00541a0f : MOV dword ptr [ESP + 0x20],EDI
00541a13 : MOV dword ptr [ESP + 0x24],EBX
00541a17 : XOR EBP,EBP
00541a19 : JMP 0x00541a1f
00541a1b : MOV EBP,dword ptr [ESP + 0x38]
00541a1f : TEST EDI,EDI
00541a21 : JZ 0x00541a36
00541a23 : TEST EBX,EBX
00541a25 : JL 0x00541a36
00541a27 : CMP EBX,dword ptr [EDI + 0x4]
00541a2a : JGE 0x00541a36
00541a2c : MOV EDX,dword ptr [EDI]
00541a2e : MOV EAX,dword ptr [EDX + EBX*0x4]
00541a31 : MOV EAX,dword ptr [EAX + 0x1c]
00541a34 : JMP 0x00541a38
00541a36 : XOR EAX,EAX
00541a38 : CMP dword ptr [ESI + 0x10],0x1
00541a3c : MOV dword ptr [ESP + 0x38],EAX
00541a40 : JNZ 0x00541ab6
00541a42 : MOV EAX,dword ptr [ESI + 0xc]
00541a45 : MOV ESI,dword ptr [EAX]
00541a47 : MOV ECX,dword ptr [EDI]
00541a49 : MOV EAX,dword ptr [ESI + 0x4]
00541a4c : MOV EDX,dword ptr [ECX + EBX*0x4]
00541a4f : MOV dword ptr [ESP + 0x14],EDX
00541a53 : TEST EAX,EAX
00541a55 : JBE 0x00541a72
00541a57 : MOV ECX,dword ptr [ESI]
00541a59 : LEA EDX,[EAX + -0x1]
00541a5c : TEST ECX,ECX
00541a5e : JZ 0x00541a69
00541a60 : CMP EDX,EAX
00541a62 : JNC 0x00541a69
00541a64 : LEA ECX,[ECX + EDX*0x2]
00541a67 : JMP 0x00541a6b
00541a69 : XOR ECX,ECX
00541a6b : CMP word ptr [ECX],0x0
00541a6f : JNZ 0x00541a72
00541a71 : DEC EAX
00541a72 : MOV ECX,dword ptr [ESP + 0x10]
00541a76 : MOV EDX,dword ptr [ECX + 0x8]
00541a79 : MOV ECX,dword ptr [ESP + 0x14]
00541a7d : PUSH EAX
00541a7e : PUSH EBP
00541a7f : PUSH 0x0
00541a81 : PUSH ESI
00541a82 : PUSH EDX
00541a83 : CALL 0x005408a0
00541a88 : TEST EBP,EBP
00541a8a : JNZ 0x00541aa1
00541a8c : MOV EAX,dword ptr [ESI + 0xc]
00541a8f : MOV ECX,dword ptr [ESP + 0x10]
00541a93 : MOV EDX,dword ptr [ECX + 0x8]
00541a96 : MOV ECX,dword ptr [ESP + 0x14]
00541a9a : PUSH EAX
00541a9b : PUSH EDX
00541a9c : CALL 0x0053c230
00541aa1 : MOV EAX,dword ptr [ESP + 0x14]
00541aa5 : MOV ECX,dword ptr [EAX + 0x4]
00541aa8 : MOV EAX,dword ptr [EDI + 0x4]
00541aab : ADD dword ptr [ESP + 0x38],ECX
00541aaf : CMP EBX,EAX
00541ab1 : JMP 0x00541cf7
00541ab6 : CMP EBX,dword ptr [EDI + 0x4]
00541ab9 : MOV EDX,dword ptr [EDI]
00541abb : MOV ESI,dword ptr [EDX + EBX*0x4]
00541abe : MOV dword ptr [ESP + 0x2c],0x0
00541ac6 : MOV dword ptr [ESP + 0x18],EDI
00541aca : MOV dword ptr [ESP + 0x1c],EBX
00541ace : JGE 0x00541ad5
00541ad0 : INC EBX
00541ad1 : MOV dword ptr [ESP + 0x1c],EBX
00541ad5 : MOV EAX,dword ptr [ESI + 0xc]
00541ad8 : MOV EDI,dword ptr [ESP + 0x10]
00541adc : PUSH EAX
00541add : LEA EAX,[ESP + 0x1c]
00541ae1 : PUSH EAX
00541ae2 : MOV ECX,EDI
00541ae4 : CALL 0x00540dc0
00541ae9 : MOV ECX,dword ptr [ESI + 0x4]
00541aec : MOV EDX,dword ptr [EDI + 0x8]
00541aef : SUB ECX,EBP
00541af1 : PUSH ECX
00541af2 : PUSH 0x0
00541af4 : PUSH EBP
00541af5 : PUSH ESI
00541af6 : PUSH EDX
00541af7 : MOV ECX,EAX
00541af9 : MOV dword ptr [ESP + 0x2c],EAX
00541afd : CALL 0x005408a0
00541b02 : MOV EAX,dword ptr [ESP + 0x34]
00541b06 : MOV ECX,dword ptr [EAX + 0xc]
00541b09 : MOV EDI,dword ptr [ECX]
00541b0b : MOV EBX,dword ptr [ESI + 0x4]
00541b0e : MOV EAX,dword ptr [EDI + 0x4]
00541b11 : SUB EBX,EBP
00541b13 : TEST EAX,EAX
00541b15 : JBE 0x00541b32
00541b17 : MOV ECX,dword ptr [EDI]
00541b19 : LEA EDX,[EAX + -0x1]
00541b1c : TEST ECX,ECX
00541b1e : JZ 0x00541b29
00541b20 : CMP EDX,EAX
00541b22 : JNC 0x00541b29
00541b24 : LEA ECX,[ECX + EDX*0x2]
00541b27 : JMP 0x00541b2b
00541b29 : XOR ECX,ECX
00541b2b : CMP word ptr [ECX],0x0
00541b2f : JNZ 0x00541b32
00541b31 : DEC EAX
00541b32 : MOV EDX,dword ptr [ESP + 0x10]
00541b36 : PUSH EAX
00541b37 : MOV EAX,dword ptr [EDX + 0x8]
00541b3a : PUSH EBP
00541b3b : PUSH 0x0
00541b3d : PUSH EDI
00541b3e : PUSH EAX
00541b3f : MOV ECX,ESI
00541b41 : CALL 0x005408a0
00541b46 : MOV EAX,dword ptr [EDI + 0x4]
00541b49 : TEST EAX,EAX
00541b4b : JBE 0x00541b68
00541b4d : MOV ECX,dword ptr [EDI]
00541b4f : LEA EDX,[EAX + -0x1]
00541b52 : TEST ECX,ECX
00541b54 : JZ 0x00541b5f
00541b56 : CMP EDX,EAX
00541b58 : JNC 0x00541b5f
00541b5a : LEA ECX,[ECX + EDX*0x2]
00541b5d : JMP 0x00541b61
00541b5f : XOR ECX,ECX
00541b61 : CMP word ptr [ECX],0x0
00541b65 : JNZ 0x00541b68
00541b67 : DEC EAX
00541b68 : MOV ECX,dword ptr [ESP + 0x3c]
00541b6c : SUB ECX,EAX
00541b6e : MOV dword ptr [ESP + 0x14],ECX
00541b72 : TEST EBP,EBP
00541b74 : JNZ 0x00541b89
00541b76 : MOV ECX,dword ptr [EDI + 0xc]
00541b79 : MOV EDX,dword ptr [ESP + 0x10]
00541b7d : MOV EAX,dword ptr [EDX + 0x8]
00541b80 : PUSH ECX
00541b81 : PUSH EAX
00541b82 : MOV ECX,ESI
00541b84 : CALL 0x0053c230
00541b89 : TEST EBX,EBX
00541b8b : JBE 0x00541ba3
00541b8d : MOV EAX,dword ptr [ESI + 0x4]
00541b90 : MOV ECX,EBX
00541b92 : CMP EBX,EAX
00541b94 : JC 0x00541b98
00541b96 : MOV ECX,EAX
00541b98 : PUSH EAX
00541b99 : SUB EAX,ECX
00541b9b : PUSH EAX
00541b9c : MOV ECX,ESI
00541b9e : CALL 0x00540170
00541ba3 : MOV EAX,dword ptr [ESI + 0x4]
00541ba6 : TEST EAX,EAX
00541ba8 : JBE 0x00541bc5
00541baa : MOV ESI,dword ptr [ESI]
00541bac : LEA ECX,[EAX + -0x1]
00541baf : TEST ESI,ESI
00541bb1 : JZ 0x00541bbc
00541bb3 : CMP ECX,EAX
00541bb5 : JNC 0x00541bbc
00541bb7 : LEA ESI,[ESI + ECX*0x2]
00541bba : JMP 0x00541bbe
00541bbc : XOR ESI,ESI
00541bbe : CMP word ptr [ESI],0x0
00541bc2 : JNZ 0x00541bc5
00541bc4 : DEC EAX
00541bc5 : MOV ECX,dword ptr [ESP + 0x20]
00541bc9 : MOV EDX,dword ptr [ESP + 0x24]
00541bcd : ADD dword ptr [ESP + 0x38],EAX
00541bd1 : CMP EDX,dword ptr [ECX + 0x4]
00541bd4 : JGE 0x00541bda
00541bd6 : INC dword ptr [ESP + 0x24]
00541bda : MOV EAX,dword ptr [ESP + 0x34]
00541bde : MOV EAX,dword ptr [EAX + 0x10]
00541be1 : TEST EAX,EAX
00541be3 : JLE 0x00541bf0
00541be5 : MOV dword ptr [ESP + 0x2c],0x1
00541bed : LEA ECX,[ECX]
00541bf0 : MOV ECX,dword ptr [ESP + 0x2c]
00541bf4 : TEST ECX,ECX
00541bf6 : JL 0x00541cbb
00541bfc : CMP ECX,EAX
00541bfe : JGE 0x00541cbb
00541c04 : MOV EDX,dword ptr [ESP + 0x14]
00541c08 : TEST EDX,EDX
00541c0a : JBE 0x00541cbb
00541c10 : MOV EAX,dword ptr [ESP + 0x34]
00541c14 : MOV EAX,dword ptr [EAX + 0xc]
00541c17 : MOV EDI,dword ptr [EAX + ECX*0x4]
00541c1a : MOV ESI,dword ptr [EDI + 0x4]
00541c1d : TEST ESI,ESI
00541c1f : JBE 0x00541c3c
00541c21 : MOV EAX,dword ptr [EDI]
00541c23 : LEA ECX,[ESI + -0x1]
00541c26 : TEST EAX,EAX
00541c28 : JZ 0x00541c33
00541c2a : CMP ECX,ESI
00541c2c : JNC 0x00541c33
00541c2e : LEA EAX,[EAX + ECX*0x2]
00541c31 : JMP 0x00541c35
00541c33 : XOR EAX,EAX
00541c35 : CMP word ptr [EAX],0x0
00541c39 : JNZ 0x00541c3c
00541c3b : DEC ESI
00541c3c : CMP ESI,EDX
00541c3e : JA 0x00541c93
00541c40 : CMP ESI,dword ptr [ESP + 0x14]
00541c44 : JNZ 0x00541c51
00541c46 : MOV ECX,EDI
00541c48 : CALL 0x0053b470
00541c4d : TEST AL,AL
00541c4f : JZ 0x00541c93
00541c51 : PUSH EDI
00541c52 : LEA ECX,[ESP + 0x24]
00541c56 : PUSH ECX
00541c57 : MOV ECX,dword ptr [ESP + 0x18]
00541c5b : CALL 0x00540eb0
00541c60 : MOV EDX,dword ptr [ESP + 0x34]
00541c64 : MOV EAX,dword ptr [EDX + 0x10]
00541c67 : SUB dword ptr [ESP + 0x14],ESI
00541c6b : ADD dword ptr [ESP + 0x38],ESI
00541c6f : CMP dword ptr [ESP + 0x2c],EAX
00541c73 : JGE 0x00541c79
00541c75 : INC dword ptr [ESP + 0x2c]
00541c79 : MOV ECX,dword ptr [ESP + 0x24]
00541c7d : MOV EDX,dword ptr [ESP + 0x20]
00541c81 : CMP ECX,dword ptr [EDX + 0x4]
00541c84 : JGE 0x00541bf0
00541c8a : INC dword ptr [ESP + 0x24]
00541c8e : JMP 0x00541bf0
00541c93 : MOV EBX,dword ptr [ESP + 0x10]
00541c97 : MOV EAX,dword ptr [EBX + 0x8]
00541c9a : PUSH ESI
00541c9b : MOV ESI,dword ptr [ESP + 0x1c]
00541c9f : PUSH 0x0
00541ca1 : PUSH 0x0
00541ca3 : PUSH EDI
00541ca4 : PUSH EAX
00541ca5 : MOV ECX,ESI
00541ca7 : CALL 0x005408a0
00541cac : MOV ECX,dword ptr [EDI + 0xc]
00541caf : MOV EDX,dword ptr [EBX + 0x8]
00541cb2 : PUSH ECX
00541cb3 : PUSH EDX
00541cb4 : MOV ECX,ESI
00541cb6 : CALL 0x0053c230
00541cbb : MOV ECX,dword ptr [ESP + 0x18]
00541cbf : MOV EAX,dword ptr [ESP + 0x38]
00541cc3 : MOV dword ptr [ECX + 0x1c],EAX
00541cc6 : MOV EAX,dword ptr [ECX + 0x4]
00541cc9 : TEST EAX,EAX
00541ccb : JBE 0x00541ce8
00541ccd : MOV ECX,dword ptr [ECX]
00541ccf : LEA EDX,[EAX + -0x1]
00541cd2 : TEST ECX,ECX
00541cd4 : JZ 0x00541cdf
00541cd6 : CMP EDX,EAX
00541cd8 : JNC 0x00541cdf
00541cda : LEA ECX,[ECX + EDX*0x2]
00541cdd : JMP 0x00541ce1
00541cdf : XOR ECX,ECX
00541ce1 : CMP word ptr [ECX],0x0
00541ce5 : JNZ 0x00541ce8
00541ce7 : DEC EAX
00541ce8 : ADD dword ptr [ESP + 0x38],EAX
00541cec : MOV ECX,dword ptr [ESP + 0x20]
00541cf0 : MOV EAX,dword ptr [ECX + 0x4]
00541cf3 : CMP dword ptr [ESP + 0x24],EAX
00541cf7 : JGE 0x00541cfd
00541cf9 : INC dword ptr [ESP + 0x24]
00541cfd : MOV ESI,dword ptr [ESP + 0x20]
00541d01 : MOV EDX,dword ptr [ESP + 0x24]
00541d05 : MOV ECX,dword ptr [ESP + 0x38]
00541d09 : POP EDI
00541d0a : POP EBX
00541d0b : JMP 0x00541d10
00541d10 : TEST EDX,EDX
00541d12 : JL 0x00541d32
00541d14 : CMP EDX,EAX
00541d16 : JGE 0x00541d32
00541d18 : MOV EAX,dword ptr [ESI]
00541d1a : MOV EAX,dword ptr [EAX + EDX*0x4]
00541d1d : CMP dword ptr [EAX + 0x1c],ECX
00541d20 : JZ 0x00541d32
00541d22 : MOV dword ptr [EAX + 0x1c],ECX
00541d25 : ADD ECX,dword ptr [EAX + 0x4]
00541d28 : MOV EAX,dword ptr [ESI + 0x4]
00541d2b : CMP EDX,EAX
00541d2d : JGE 0x00541d10
00541d2f : INC EDX
00541d30 : JMP 0x00541d10
00541d32 : MOV EDX,dword ptr [ESP + 0x8]
00541d36 : MOV ECX,dword ptr [EDX + 0x10]
00541d39 : LEA EAX,[ECX + -0x1]
00541d3c : TEST EAX,EAX
00541d3e : JL 0x00541d4e
00541d40 : CMP EAX,ECX
00541d42 : JGE 0x00541d4e
00541d44 : MOV ECX,dword ptr [EDX + 0xc]
00541d47 : MOV EAX,dword ptr [ECX + EAX*0x4]
00541d4a : TEST EAX,EAX
00541d4c : JNZ 0x00541d5b
00541d4e : PUSH 0x0
00541d50 : MOV ECX,EDX
00541d52 : CALL 0x00540b60
00541d57 : TEST EAX,EAX
00541d59 : JZ 0x00541d98
00541d5b : MOV ECX,dword ptr [EAX + 0x4]
00541d5e : TEST ECX,ECX
00541d60 : JBE 0x00541d85
00541d62 : MOV EDX,dword ptr [EAX]
00541d64 : LEA ESI,[ECX + -0x1]
00541d67 : TEST EDX,EDX
00541d69 : JZ 0x00541d74
00541d6b : CMP ESI,ECX
00541d6d : JNC 0x00541d74
00541d6f : LEA ECX,[EDX + ESI*0x2]
00541d72 : JMP 0x00541d76
00541d74 : XOR ECX,ECX
00541d76 : MOVZX ECX,word ptr [ECX]
00541d79 : CMP CX,0xd
00541d7d : JZ 0x00541d98
00541d7f : CMP CX,0xa
00541d83 : JZ 0x00541d98
00541d85 : MOV ECX,dword ptr [ESP + 0x8]
00541d89 : MOV EDX,dword ptr [ECX + 0x1c]
00541d8c : MOV ECX,dword ptr [ECX + 0x8]
00541d8f : PUSH EDX
00541d90 : PUSH ECX
00541d91 : MOV ECX,EAX
00541d93 : CALL 0x005406c0
00541d98 : MOV EDX,dword ptr [ESP + 0x2c]
00541d9c : TEST byte ptr [EDX + 0x20],0x1
00541da0 : JZ 0x00541daa
00541da2 : MOV EAX,dword ptr [ESP + 0x8]
00541da6 : OR byte ptr [EAX + 0x20],0x1
00541daa : MOV EAX,dword ptr [ESP + 0x34]
00541dae : POP ESI
00541daf : POP EBP
00541db0 : ADD ESP,0x20
00541db3 : RET 0xc
00541db6 : POP ESI
00541db7 : XOR EAX,EAX
00541db9 : POP EBP
00541dba : ADD ESP,0x20
00541dbd : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_0051aa70
ENTRY    : 0051aa70
BODY     : [[0051aa70, 0051ad84]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_0051aa70(int *param_1)

{
  byte bVar1;
  byte bVar2;
  byte bVar3;
  byte bVar4;
  byte bVar5;
  byte bVar6;
  byte *pbVar7;
  byte *pbVar8;
  uint uVar9;
  
  pbVar7 = (byte *)*param_1;
  bVar1 = *pbVar7;
  if (bVar1 == 0) {
    return 0;
  }
  pbVar8 = pbVar7 + 1;
  *param_1 = (int)pbVar8;
  if (-1 < (char)bVar1) {
    return (int)(char)bVar1;
  }
  if ((bVar1 & 0xe0) != 0xc0) {
    if ((bVar1 & 0xf0) == 0xe0) {
      bVar2 = *pbVar8;
      if (bVar2 == 0) {
        return 0;
      }
      if ((bVar2 & 0xc0) == 0x80) {
        *param_1 = (int)(pbVar7 + 2);
        bVar3 = pbVar7[2];
        if (bVar3 == 0) {
          return 0;
        }
        if ((bVar3 & 0xc0) == 0x80) {
          *param_1 = (int)(pbVar7 + 3);
          uVar9 = ((int)(char)bVar1 & 0xfU) << 0xc | ((int)(char)bVar2 & 0x3fU) << 6 |
                  (int)(char)bVar3 & 0x3fU;
          if ((((0x7ff < uVar9) && (0x7ff < uVar9 - 0xd800)) && (uVar9 != 0xfffe)) &&
             (uVar9 != 0xffff)) {
            return uVar9;
          }
        }
      }
    }
    else if ((bVar1 & 0xf8) == 0xf0) {
      bVar2 = *pbVar8;
      if (bVar2 == 0) {
        return 0;
      }
      if ((bVar2 & 0xc0) == 0x80) {
        *param_1 = (int)(pbVar7 + 2);
        bVar3 = pbVar7[2];
        if (bVar3 == 0) {
          return 0;
        }
        if ((bVar3 & 0xc0) == 0x80) {
          *param_1 = (int)(pbVar7 + 3);
          bVar4 = pbVar7[3];
          if (bVar4 == 0) {
            return 0;
          }
          if ((bVar4 & 0xc0) == 0x80) {
            *param_1 = (int)(pbVar7 + 4);
            uVar9 = ((int)(char)bVar1 & 7U) << 0x12 | ((int)(char)bVar2 & 0x3fU) << 0xc |
                    ((int)(char)bVar3 & 0x3fU) << 6 | (int)(char)bVar4 & 0x3fU;
            if (0xffff < uVar9) {
              return uVar9;
            }
          }
        }
      }
    }
    else if ((bVar1 & 0xfc) == 0xf8) {
      bVar2 = *pbVar8;
      if (bVar2 == 0) {
        return 0;
      }
      if ((bVar2 & 0xc0) == 0x80) {
        *param_1 = (int)(pbVar7 + 2);
        bVar3 = pbVar7[2];
        if (bVar3 == 0) {
          return 0;
        }
        if ((bVar3 & 0xc0) == 0x80) {
          *param_1 = (int)(pbVar7 + 3);
          bVar4 = pbVar7[3];
          if (bVar4 == 0) {
            return 0;
          }
          if ((bVar4 & 0xc0) == 0x80) {
            *param_1 = (int)(pbVar7 + 4);
            bVar5 = pbVar7[4];
            if (bVar5 == 0) {
              return 0;
            }
            if ((bVar5 & 0xc0) == 0x80) {
              *param_1 = (int)(pbVar7 + 5);
              uVar9 = ((int)(char)bVar1 & 3U) << 0x18 | ((int)(char)bVar2 & 0x3fU) << 0x12 |
                      ((int)(char)bVar3 & 0x3fU) << 0xc | ((int)(char)bVar4 & 0x3fU) << 6 |
                      (int)(char)bVar5 & 0x3fU;
              if (0x1fffff < uVar9) {
                return uVar9;
              }
            }
          }
        }
      }
    }
    else if ((bVar1 & 0xfe) == 0xfc) {
      bVar2 = *pbVar8;
      if (bVar2 == 0) {
        return 0;
      }
      if ((bVar2 & 0xc0) == 0x80) {
        *param_1 = (int)(pbVar7 + 2);
        bVar3 = pbVar7[2];
        if (bVar3 == 0) {
          return 0;
        }
        if ((bVar3 & 0xc0) == 0x80) {
          *param_1 = (int)(pbVar7 + 3);
          bVar4 = pbVar7[3];
          if (bVar4 == 0) {
            return 0;
          }
          if ((bVar4 & 0xc0) == 0x80) {
            *param_1 = (int)(pbVar7 + 4);
            bVar5 = pbVar7[4];
            if (bVar5 == 0) {
              return 0;
            }
            if ((bVar5 & 0xc0) == 0x80) {
              *param_1 = (int)(pbVar7 + 5);
              bVar6 = pbVar7[5];
              if (bVar6 == 0) {
                return 0;
              }
              if ((bVar6 & 0xc0) == 0x80) {
                *param_1 = (int)(pbVar7 + 6);
                uVar9 = ((int)(char)bVar1 & 1U) << 0x1e | ((int)(char)bVar2 & 0x3fU) << 0x18 |
                        ((int)(char)bVar3 & 0x3fU) << 0x12 | ((int)(char)bVar4 & 0x3fU) << 0xc |
                        ((int)(char)bVar5 & 0x3fU) << 6 | (int)(char)bVar6 & 0x3fU;
                if (0x3ffffff < uVar9) {
                  return uVar9;
                }
              }
            }
          }
        }
      }
    }
    return 0xfffd;
  }
  bVar2 = *pbVar8;
  if (bVar2 == 0) {
    return 0;
  }
  if ((bVar2 & 0xc0) != 0x80) {
    return 0xfffd;
  }
  uVar9 = ((int)(char)bVar1 & 0x1fU) << 6 | (int)(char)bVar2 & 0x3fU;
  *param_1 = (int)(pbVar7 + 2);
  if (uVar9 < 0x80) {
    return 0xfffd;
  }
  return uVar9;
}



============================================================
DISASSEMBLY
============================================================
0051aa70 : MOV ECX,dword ptr [ESP + 0x4]
0051aa74 : MOV EDX,dword ptr [ECX]
0051aa76 : MOV AL,byte ptr [EDX]
0051aa78 : TEST AL,AL
0051aa7a : JNZ 0x0051aa81
0051aa7c : XOR EAX,EAX
0051aa7e : RET 0x4
0051aa81 : INC EDX
0051aa82 : MOV dword ptr [ECX],EDX
0051aa84 : TEST AL,AL
0051aa86 : JS 0x0051aa8e
0051aa88 : MOVSX EAX,AL
0051aa8b : RET 0x4
0051aa8e : PUSH EBX
0051aa8f : MOV BL,AL
0051aa91 : AND BL,0xe0
0051aa94 : PUSH ESI
0051aa95 : CMP BL,0xc0
0051aa98 : JNZ 0x0051aad9
0051aa9a : MOVSX ESI,AL
0051aa9d : MOV AL,byte ptr [EDX]
0051aa9f : AND ESI,0x1f
0051aaa2 : SHL ESI,0x6
0051aaa5 : TEST AL,AL
0051aaa7 : JZ 0x0051ad52
0051aaad : MOV BL,AL
0051aaaf : AND BL,0xc0
0051aab2 : CMP BL,0x80
0051aab5 : JNZ 0x0051ab57
0051aabb : MOVSX EAX,AL
0051aabe : AND EAX,0x3f
0051aac1 : INC EDX
0051aac2 : OR ESI,EAX
0051aac4 : MOV dword ptr [ECX],EDX
0051aac6 : CMP ESI,0x80
0051aacc : JC 0x0051ab57
0051aad2 : MOV EAX,ESI
0051aad4 : POP ESI
0051aad5 : POP EBX
0051aad6 : RET 0x4
0051aad9 : MOV BL,AL
0051aadb : AND BL,0xf0
0051aade : CMP BL,0xe0
0051aae1 : JNZ 0x0051ab61
0051aae3 : MOVSX ESI,AL
0051aae6 : MOV AL,byte ptr [EDX]
0051aae8 : AND ESI,0xf
0051aaeb : SHL ESI,0xc
0051aaee : TEST AL,AL
0051aaf0 : JZ 0x0051ad52
0051aaf6 : MOV BL,AL
0051aaf8 : AND BL,0xc0
0051aafb : CMP BL,0x80
0051aafe : JNZ 0x0051ab57
0051ab00 : MOVSX EAX,AL
0051ab03 : AND EAX,0x3f
0051ab06 : INC EDX
0051ab07 : SHL EAX,0x6
0051ab0a : OR ESI,EAX
0051ab0c : MOV dword ptr [ECX],EDX
0051ab0e : MOV AL,byte ptr [EDX]
0051ab10 : TEST AL,AL
0051ab12 : JZ 0x0051ad52
0051ab18 : MOV BL,AL
0051ab1a : AND BL,0xc0
0051ab1d : CMP BL,0x80
0051ab20 : JNZ 0x0051ab57
0051ab22 : INC EDX
0051ab23 : MOV dword ptr [ECX],EDX
0051ab25 : MOVSX ECX,AL
0051ab28 : AND ECX,0x3f
0051ab2b : OR ESI,ECX
0051ab2d : CMP ESI,0x800
0051ab33 : JC 0x0051ab57
0051ab35 : LEA EDX,[ESI + 0xffff2800]
0051ab3b : CMP EDX,0x7ff
0051ab41 : JBE 0x0051ab57
0051ab43 : CMP ESI,0xfffe
0051ab49 : JZ 0x0051ab57
0051ab4b : CMP ESI,0xffff
0051ab51 : JNZ 0x0051ad7e
0051ab57 : POP ESI
0051ab58 : MOV EAX,0xfffd
0051ab5d : POP EBX
0051ab5e : RET 0x4
0051ab61 : MOV BL,AL
0051ab63 : AND BL,0xf8
0051ab66 : CMP BL,0xf0
0051ab69 : JNZ 0x0051abea
0051ab6b : MOVSX ESI,AL
0051ab6e : MOV AL,byte ptr [EDX]
0051ab70 : AND ESI,0x7
0051ab73 : SHL ESI,0x12
0051ab76 : TEST AL,AL
0051ab78 : JZ 0x0051ad52
0051ab7e : MOV BL,AL
0051ab80 : AND BL,0xc0
0051ab83 : CMP BL,0x80
0051ab86 : JNZ 0x0051ab57
0051ab88 : MOVSX EAX,AL
0051ab8b : INC EDX
0051ab8c : AND EAX,0x3f
0051ab8f : SHL EAX,0xc
0051ab92 : MOV dword ptr [ECX],EDX
0051ab94 : MOV BL,byte ptr [EDX]
0051ab96 : OR ESI,EAX
0051ab98 : TEST BL,BL
0051ab9a : JZ 0x0051ad52
0051aba0 : MOV AL,BL
0051aba2 : AND AL,0xc0
0051aba4 : CMP AL,0x80
0051aba6 : JNZ 0x0051ab57
0051aba8 : LEA EAX,[EDX + 0x1]
0051abab : MOVSX EDX,BL
0051abae : AND EDX,0x3f
0051abb1 : SHL EDX,0x6
0051abb4 : OR ESI,EDX
0051abb6 : MOV dword ptr [ECX],EAX
0051abb8 : MOV DL,byte ptr [EAX]
0051abba : TEST DL,DL
0051abbc : JZ 0x0051ad52
0051abc2 : MOV BL,DL
0051abc4 : AND BL,0xc0
0051abc7 : CMP BL,0x80
0051abca : JNZ 0x0051ab57
0051abcc : INC EAX
0051abcd : MOV dword ptr [ECX],EAX
0051abcf : MOVSX EAX,DL
0051abd2 : AND EAX,0x3f
0051abd5 : OR ESI,EAX
0051abd7 : CMP ESI,0x10000
0051abdd : JC 0x0051ab57
0051abe3 : MOV EAX,ESI
0051abe5 : POP ESI
0051abe6 : POP EBX
0051abe7 : RET 0x4
0051abea : MOV BL,AL
0051abec : AND BL,0xfc
0051abef : CMP BL,0xf8
0051abf2 : JNZ 0x0051aca9
0051abf8 : MOVSX ESI,AL
0051abfb : MOV AL,byte ptr [EDX]
0051abfd : AND ESI,0x3
0051ac00 : SHL ESI,0x18
0051ac03 : TEST AL,AL
0051ac05 : JZ 0x0051ad52
0051ac0b : MOV BL,AL
0051ac0d : AND BL,0xc0
0051ac10 : CMP BL,0x80
0051ac13 : JNZ 0x0051ab57
0051ac19 : MOVSX EAX,AL
0051ac1c : INC EDX
0051ac1d : AND EAX,0x3f
0051ac20 : SHL EAX,0x12
0051ac23 : MOV dword ptr [ECX],EDX
0051ac25 : MOV BL,byte ptr [EDX]
0051ac27 : OR ESI,EAX
0051ac29 : TEST BL,BL
0051ac2b : JZ 0x0051ad52
0051ac31 : MOV AL,BL
0051ac33 : AND AL,0xc0
0051ac35 : CMP AL,0x80
0051ac37 : JNZ 0x0051ab57
0051ac3d : LEA EAX,[EDX + 0x1]
0051ac40 : MOVSX EDX,BL
0051ac43 : AND EDX,0x3f
0051ac46 : SHL EDX,0xc
0051ac49 : OR ESI,EDX
0051ac4b : MOV dword ptr [ECX],EAX
0051ac4d : MOV DL,byte ptr [EAX]
0051ac4f : TEST DL,DL
0051ac51 : JZ 0x0051ad52
0051ac57 : MOV BL,DL
0051ac59 : AND BL,0xc0
0051ac5c : CMP BL,0x80
0051ac5f : JNZ 0x0051ab57
0051ac65 : MOVSX EDX,DL
0051ac68 : AND EDX,0x3f
0051ac6b : INC EAX
0051ac6c : SHL EDX,0x6
0051ac6f : OR ESI,EDX
0051ac71 : MOV dword ptr [ECX],EAX
0051ac73 : MOV DL,byte ptr [EAX]
0051ac75 : TEST DL,DL
0051ac77 : JZ 0x0051ad52
0051ac7d : MOV BL,DL
0051ac7f : AND BL,0xc0
0051ac82 : CMP BL,0x80
0051ac85 : JNZ 0x0051ab57
0051ac8b : INC EAX
0051ac8c : MOV dword ptr [ECX],EAX
0051ac8e : MOVSX EAX,DL
0051ac91 : AND EAX,0x3f
0051ac94 : OR ESI,EAX
0051ac96 : CMP ESI,0x200000
0051ac9c : JC 0x0051ab57
0051aca2 : MOV EAX,ESI
0051aca4 : POP ESI
0051aca5 : POP EBX
0051aca6 : RET 0x4
0051aca9 : MOV BL,AL
0051acab : AND BL,0xfe
0051acae : CMP BL,0xfc
0051acb1 : JNZ 0x0051ab57
0051acb7 : MOVSX ESI,AL
0051acba : MOV AL,byte ptr [EDX]
0051acbc : AND ESI,0x1
0051acbf : SHL ESI,0x1e
0051acc2 : TEST AL,AL
0051acc4 : JZ 0x0051ad52
0051acca : MOV BL,AL
0051accc : AND BL,0xc0
0051accf : CMP BL,0x80
0051acd2 : JNZ 0x0051ab57
0051acd8 : MOVSX EAX,AL
0051acdb : INC EDX
0051acdc : AND EAX,0x3f
0051acdf : SHL EAX,0x18
0051ace2 : MOV dword ptr [ECX],EDX
0051ace4 : MOV BL,byte ptr [EDX]
0051ace6 : OR ESI,EAX
0051ace8 : TEST BL,BL
0051acea : JZ 0x0051ad52
0051acec : MOV AL,BL
0051acee : AND AL,0xc0
0051acf0 : CMP AL,0x80
0051acf2 : JNZ 0x0051ab57
0051acf8 : LEA EAX,[EDX + 0x1]
0051acfb : MOVSX EDX,BL
0051acfe : AND EDX,0x3f
0051ad01 : SHL EDX,0x12
0051ad04 : OR ESI,EDX
0051ad06 : MOV dword ptr [ECX],EAX
0051ad08 : MOV DL,byte ptr [EAX]
0051ad0a : TEST DL,DL
0051ad0c : JZ 0x0051ad52
0051ad0e : MOV BL,DL
0051ad10 : AND BL,0xc0
0051ad13 : CMP BL,0x80
0051ad16 : JNZ 0x0051ab57
0051ad1c : MOVSX EDX,DL
0051ad1f : AND EDX,0x3f
0051ad22 : INC EAX
0051ad23 : SHL EDX,0xc
0051ad26 : OR ESI,EDX
0051ad28 : MOV dword ptr [ECX],EAX
0051ad2a : MOV DL,byte ptr [EAX]
0051ad2c : TEST DL,DL
0051ad2e : JZ 0x0051ad52
0051ad30 : MOV BL,DL
0051ad32 : AND BL,0xc0
0051ad35 : CMP BL,0x80
0051ad38 : JNZ 0x0051ab57
0051ad3e : MOVSX EDX,DL
0051ad41 : AND EDX,0x3f
0051ad44 : INC EAX
0051ad45 : SHL EDX,0x6
0051ad48 : OR ESI,EDX
0051ad4a : MOV dword ptr [ECX],EAX
0051ad4c : MOV DL,byte ptr [EAX]
0051ad4e : TEST DL,DL
0051ad50 : JNZ 0x0051ad59
0051ad52 : POP ESI
0051ad53 : XOR EAX,EAX
0051ad55 : POP EBX
0051ad56 : RET 0x4
0051ad59 : MOV BL,DL
0051ad5b : AND BL,0xc0
0051ad5e : CMP BL,0x80
0051ad61 : JNZ 0x0051ab57
0051ad67 : INC EAX
0051ad68 : MOV dword ptr [ECX],EAX
0051ad6a : MOVSX EAX,DL
0051ad6d : AND EAX,0x3f
0051ad70 : OR ESI,EAX
0051ad72 : CMP ESI,0x4000000
0051ad78 : JC 0x0051ab57
0051ad7e : MOV EAX,ESI
0051ad80 : POP ESI
0051ad81 : POP EBX
0051ad82 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_0046a810
ENTRY    : 0046a810
BODY     : [[0046a810, 0046a8dd]]

============================================================
DECOMPILED C CODE
============================================================

byte FUN_0046a810(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  char *_Src;
  char cVar1;
  byte bVar2;
  byte bVar3;
  int iVar4;
  char *pcVar5;
  size_t _Size;
  int unaff_EDI;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b8226b;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  iVar4 = FUN_00455a80("%s/%s",param_3,param_4,DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
  local_8 = 0;
  _Src = (char *)(iVar4 + 8);
  if (_Src == (char *)0x0) {
    *(undefined4 *)(unaff_EDI + 0x18) = 0;
    *(undefined1 *)(unaff_EDI + 0x1c) = 0;
  }
  else {
    pcVar5 = _Src;
    do {
      cVar1 = *pcVar5;
      pcVar5 = pcVar5 + 1;
    } while (cVar1 != '\0');
    _Size = (int)pcVar5 - (iVar4 + 9);
    if (_Size != 0) {
      _memmove((void *)(unaff_EDI + 0x1c),_Src,_Size);
    }
    *(size_t *)(unaff_EDI + 0x18) = _Size;
    *(undefined1 *)(_Size + 0x1c + unaff_EDI) = 0;
  }
  local_8 = 0xffffffff;
  bVar2 = FUN_006eca80(param_1,unaff_EDI);
  bVar3 = FUN_006ec380(param_1,unaff_EDI);
  ExceptionList = local_10;
  return bVar3 & bVar2 & 1;
}



============================================================
DISASSEMBLY
============================================================
0046a810 : PUSH EBP
0046a811 : MOV EBP,ESP
0046a813 : PUSH -0x1
0046a815 : PUSH 0xb8226b
0046a81a : MOV EAX,FS:[0x0]
0046a820 : PUSH EAX
0046a821 : SUB ESP,0x108
0046a827 : PUSH EBX
0046a828 : PUSH ESI
0046a829 : MOV EAX,[0x00d66fa0]
0046a82e : XOR EAX,EBP
0046a830 : PUSH EAX
0046a831 : LEA EAX,[EBP + -0xc]
0046a834 : MOV FS:[0x0],EAX
0046a83a : MOV EBX,dword ptr [EBP + 0x10]
0046a83d : MOV EAX,dword ptr [EBP + 0x14]
0046a840 : PUSH EAX
0046a841 : PUSH EBX
0046a842 : PUSH 0xcd57f8
0046a847 : LEA ESI,[EBP + 0xfffffeec]
0046a84d : CALL 0x00455a80
0046a852 : ADD ESP,0xc
0046a855 : XOR EDX,EDX
0046a857 : MOV dword ptr [EBP + -0x4],EDX
0046a85a : LEA ECX,[EAX + 0x8]
0046a85d : CMP ECX,EDX
0046a85f : JNZ 0x0046a869
0046a861 : MOV dword ptr [EDI + 0x18],EDX
0046a864 : MOV byte ptr [EDI + 0x1c],DL
0046a867 : JMP 0x0046a893
0046a869 : MOV EAX,ECX
0046a86b : LEA ESI,[EAX + 0x1]
0046a86e : MOV EDI,EDI
0046a870 : MOV DL,byte ptr [EAX]
0046a872 : INC EAX
0046a873 : TEST DL,DL
0046a875 : JNZ 0x0046a870
0046a877 : SUB EAX,ESI
0046a879 : MOV ESI,EAX
0046a87b : JZ 0x0046a88b
0046a87d : PUSH ESI
0046a87e : PUSH ECX
0046a87f : LEA ECX,[EDI + 0x1c]
0046a882 : PUSH ECX
0046a883 : CALL 0x00636880
0046a888 : ADD ESP,0xc
0046a88b : MOV dword ptr [EDI + 0x18],ESI
0046a88e : MOV byte ptr [ESI + EDI*0x1 + 0x1c],0x0
0046a893 : MOV dword ptr [EBP + -0x4],0xffffffff
0046a89a : MOV EDX,dword ptr [EBP + 0x8]
0046a89d : MOV ESI,dword ptr [EBP + 0xc]
0046a8a0 : PUSH EDI
0046a8a1 : PUSH EDX
0046a8a2 : MOV EDX,EBX
0046a8a4 : MOV ECX,ESI
0046a8a6 : MOV dword ptr [EBP + 0xfffffeec],0xcd3f48
0046a8b0 : CALL 0x006eca80
0046a8b5 : MOV EDX,dword ptr [EBP + 0x14]
0046a8b8 : MOV BL,AL
0046a8ba : MOV EAX,dword ptr [EBP + 0x8]
0046a8bd : PUSH EDI
0046a8be : PUSH EAX
0046a8bf : MOV ECX,ESI
0046a8c1 : AND BL,0x1
0046a8c4 : CALL 0x006ec380
0046a8c9 : AND AL,BL
0046a8cb : MOV ECX,dword ptr [EBP + -0xc]
0046a8ce : MOV dword ptr FS:[0x0],ECX
0046a8d5 : POP ECX
0046a8d6 : POP ESI
0046a8d7 : POP EBX
0046a8d8 : MOV ESP,EBP
0046a8da : POP EBP
0046a8db : RET 0x10

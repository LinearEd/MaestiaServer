PROGRAM  : Maestia.exe
FUNCTION : FUN_00846410
ENTRY    : 00846410
BODY     : [[00846410, 008464d7]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00846410(void)

{
  char cVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  int iVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  int in_EAX;
  short *psVar7;
  short in_CX;
  int iVar8;
  
  puVar2 = *(undefined4 **)(*(int *)(in_EAX + 0x1c) + 4);
  puVar3 = (undefined4 *)*puVar2;
  do {
    if (puVar3 == puVar2) {
      return 0;
    }
    iVar4 = puVar3[4];
    if ((undefined1 *)(uint)*(ushort *)(iVar4 + 8) == &DAT_00000004) {
      iVar8 = 0;
      psVar7 = (short *)(*(int *)(iVar4 + 4) + 0xc0);
      do {
        if ((psVar7[6] == in_CX) || (*psVar7 == in_CX)) goto LAB_0084644c;
        iVar8 = iVar8 + 1;
        psVar7 = psVar7 + 1;
      } while (iVar8 < 1);
    }
    else if ((((undefined1 *)(uint)*(ushort *)(iVar4 + 8) == (undefined1 *)0x7) &&
             (*(int *)(*(int *)(iVar4 + 4) + 0xb4) == 1)) &&
            (*(short *)(*(int *)(iVar4 + 4) + 0xb8) == in_CX)) {
LAB_0084644c:
      FUN_00405eb0(iVar4 + 0x20,0,0xffffffff);
      return 1;
    }
    if (*(char *)((int)puVar3 + 0x15) == '\0') {
      puVar5 = (undefined4 *)puVar3[2];
      if (*(char *)((int)puVar5 + 0x15) == '\0') {
        cVar1 = *(char *)((int)*puVar5 + 0x15);
        puVar3 = puVar5;
        puVar5 = (undefined4 *)*puVar5;
        while (cVar1 == '\0') {
          cVar1 = *(char *)((int)*puVar5 + 0x15);
          puVar3 = puVar5;
          puVar5 = (undefined4 *)*puVar5;
        }
      }
      else {
        cVar1 = *(char *)((int)puVar3[1] + 0x15);
        puVar6 = (undefined4 *)puVar3[1];
        puVar5 = puVar3;
        while ((puVar3 = puVar6, cVar1 == '\0' && (puVar5 == (undefined4 *)puVar3[2]))) {
          cVar1 = *(char *)((int)puVar3[1] + 0x15);
          puVar6 = (undefined4 *)puVar3[1];
          puVar5 = puVar3;
        }
      }
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
00846410 : PUSH EBP
00846411 : MOV EBP,ESP
00846413 : MOV EAX,dword ptr [EAX + 0x1c]
00846416 : PUSH EBX
00846417 : MOV EBX,dword ptr [EAX + 0x4]
0084641a : MOV EDX,dword ptr [EBX]
0084641c : PUSH ESI
0084641d : PUSH EDI
0084641e : CMP EDX,EBX
00846420 : JZ 0x008464cf
00846426 : MOV EDI,dword ptr [EDX + 0x10]
00846429 : MOVZX EAX,word ptr [EDI + 0x8]
0084642d : CMP EAX,0x4
00846430 : JZ 0x00846465
00846432 : CMP EAX,0x7
00846435 : JNZ 0x00846484
00846437 : MOV EAX,dword ptr [EDI + 0x4]
0084643a : CMP dword ptr [EAX + 0xb4],0x1
00846441 : JNZ 0x00846484
00846443 : CMP word ptr [EAX + 0xb8],CX
0084644a : JNZ 0x00846484
0084644c : MOV ECX,dword ptr [EBP + 0x8]
0084644f : PUSH -0x1
00846451 : PUSH 0x0
00846453 : ADD EDI,0x20
00846456 : PUSH EDI
00846457 : CALL 0x00405eb0
0084645c : POP EDI
0084645d : POP ESI
0084645e : MOV AL,0x1
00846460 : POP EBX
00846461 : POP EBP
00846462 : RET 0x4
00846465 : MOV EAX,dword ptr [EDI + 0x4]
00846468 : XOR ESI,ESI
0084646a : ADD EAX,0xc0
0084646f : NOP
00846470 : CMP word ptr [EAX + 0xc],CX
00846474 : JZ 0x0084644c
00846476 : CMP word ptr [EAX],CX
00846479 : JZ 0x0084644c
0084647b : INC ESI
0084647c : ADD EAX,0x2
0084647f : CMP ESI,0x1
00846482 : JL 0x00846470
00846484 : CMP byte ptr [EDX + 0x15],0x0
00846488 : JNZ 0x008464c7
0084648a : MOV EAX,dword ptr [EDX + 0x8]
0084648d : CMP byte ptr [EAX + 0x15],0x0
00846491 : JNZ 0x008464ac
00846493 : MOV EDX,EAX
00846495 : MOV EAX,dword ptr [EDX]
00846497 : CMP byte ptr [EAX + 0x15],0x0
0084649b : JNZ 0x008464c7
0084649d : LEA ECX,[ECX]
008464a0 : MOV EDX,EAX
008464a2 : MOV EAX,dword ptr [EDX]
008464a4 : CMP byte ptr [EAX + 0x15],0x0
008464a8 : JZ 0x008464a0
008464aa : JMP 0x008464c7
008464ac : MOV EAX,dword ptr [EDX + 0x4]
008464af : CMP byte ptr [EAX + 0x15],0x0
008464b3 : JNZ 0x008464c5
008464b5 : CMP EDX,dword ptr [EAX + 0x8]
008464b8 : JNZ 0x008464c5
008464ba : MOV EDX,EAX
008464bc : MOV EAX,dword ptr [EAX + 0x4]
008464bf : CMP byte ptr [EAX + 0x15],0x0
008464c3 : JZ 0x008464b5
008464c5 : MOV EDX,EAX
008464c7 : CMP EDX,EBX
008464c9 : JNZ 0x00846426
008464cf : POP EDI
008464d0 : POP ESI
008464d1 : XOR AL,AL
008464d3 : POP EBX
008464d4 : POP EBP
008464d5 : RET 0x4

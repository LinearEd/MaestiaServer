PROGRAM  : Maestia.exe
FUNCTION : FUN_006dc560
ENTRY    : 006dc560
BODY     : [[006dc560, 006dc60a] [006dc610, 006dc658]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006dc560(void)

{
  ushort uVar1;
  int iVar2;
  int in_EAX;
  ushort *puVar3;
  int *in_ECX;
  int iVar4;
  int *piVar5;
  int iVar6;
  
  iVar2 = in_ECX[in_EAX + 0x12];
  if (iVar2 == 0) {
    *(undefined4 *)(*in_ECX + 0x14) = 0x34;
    *(int *)(*in_ECX + 0x18) = in_EAX;
    (**(code **)*in_ECX)();
  }
  iVar6 = 0;
  puVar3 = (ushort *)(iVar2 + 4);
  iVar4 = 0x10;
  do {
    if (0xff < puVar3[-2]) {
      iVar6 = 1;
    }
    if (0xff < puVar3[-1]) {
      iVar6 = 1;
    }
    if (0xff < *puVar3) {
      iVar6 = 1;
    }
    if (0xff < puVar3[1]) {
      iVar6 = 1;
    }
    puVar3 = puVar3 + 4;
    iVar4 = iVar4 + -1;
  } while (iVar4 != 0);
  if (*(char *)(iVar2 + 0x80) == '\0') {
    FUN_006dc510(0xdb);
    FUN_006dc530();
    FUN_006dc4d0(iVar6 * 0x10 + in_EAX);
    piVar5 = &DAT_00bf1570;
    do {
      uVar1 = *(ushort *)(iVar2 + *piVar5 * 2);
      if (iVar6 != 0) {
        FUN_006dc4d0(uVar1 >> 8);
      }
      FUN_006dc4d0(uVar1 & 0xff);
      piVar5 = piVar5 + 1;
    } while ((int)piVar5 < 0xbf1670);
    *(undefined1 *)(iVar2 + 0x80) = 1;
  }
  return iVar6;
}



============================================================
DISASSEMBLY
============================================================
006dc560 : PUSH ECX
006dc561 : PUSH EBX
006dc562 : PUSH EBP
006dc563 : PUSH ESI
006dc564 : MOV EBX,EAX
006dc566 : MOV ESI,ECX
006dc568 : PUSH EDI
006dc569 : MOV EDI,dword ptr [ESI + EBX*0x4 + 0x48]
006dc56d : MOV dword ptr [ESP + 0x10],EDI
006dc571 : TEST EDI,EDI
006dc573 : JNZ 0x006dc58d
006dc575 : MOV EAX,dword ptr [ESI]
006dc577 : MOV dword ptr [EAX + 0x14],0x34
006dc57e : MOV ECX,dword ptr [ESI]
006dc580 : MOV dword ptr [ECX + 0x18],EBX
006dc583 : MOV EDX,dword ptr [ESI]
006dc585 : MOV EAX,dword ptr [EDX]
006dc587 : PUSH ESI
006dc588 : CALL EAX
006dc58a : ADD ESP,0x4
006dc58d : XOR EBP,EBP
006dc58f : LEA EAX,[EDI + 0x4]
006dc592 : LEA ECX,[EBP + 0x10]
006dc595 : MOV EDX,0xff
006dc59a : CMP word ptr [EAX + -0x4],DX
006dc59e : JBE 0x006dc5a5
006dc5a0 : MOV EBP,0x1
006dc5a5 : CMP word ptr [EAX + -0x2],DX
006dc5a9 : JBE 0x006dc5b0
006dc5ab : MOV EBP,0x1
006dc5b0 : CMP word ptr [EAX],DX
006dc5b3 : JBE 0x006dc5ba
006dc5b5 : MOV EBP,0x1
006dc5ba : CMP word ptr [EAX + 0x2],DX
006dc5be : JBE 0x006dc5c5
006dc5c0 : MOV EBP,0x1
006dc5c5 : ADD EAX,0x8
006dc5c8 : SUB ECX,0x1
006dc5cb : JNZ 0x006dc595
006dc5cd : CMP byte ptr [EDI + 0x80],CL
006dc5d3 : JNZ 0x006dc651
006dc5d5 : PUSH 0xdb
006dc5da : MOV EAX,ESI
006dc5dc : CALL 0x006dc510
006dc5e1 : MOV EAX,EBP
006dc5e3 : NEG EAX
006dc5e5 : SBB EAX,EAX
006dc5e7 : AND EAX,0x40
006dc5ea : ADD EAX,0x43
006dc5ed : MOV ECX,ESI
006dc5ef : CALL 0x006dc530
006dc5f4 : MOV EAX,EBP
006dc5f6 : SHL EAX,0x4
006dc5f9 : ADD EAX,EBX
006dc5fb : PUSH EAX
006dc5fc : CALL 0x006dc4d0
006dc601 : ADD ESP,0x8
006dc604 : MOV EBX,0xbf1570
006dc609 : JMP 0x006dc614
006dc610 : MOV EDI,dword ptr [ESP + 0x10]
006dc614 : MOV ECX,dword ptr [EBX]
006dc616 : MOVZX EDI,word ptr [EDI + ECX*0x2]
006dc61a : TEST EBP,EBP
006dc61c : JZ 0x006dc62c
006dc61e : MOV EDX,EDI
006dc620 : SHR EDX,0x8
006dc623 : PUSH EDX
006dc624 : CALL 0x006dc4d0
006dc629 : ADD ESP,0x4
006dc62c : AND EDI,0xff
006dc632 : PUSH EDI
006dc633 : CALL 0x006dc4d0
006dc638 : ADD EBX,0x4
006dc63b : ADD ESP,0x4
006dc63e : CMP EBX,0xbf1670
006dc644 : JL 0x006dc610
006dc646 : MOV EAX,dword ptr [ESP + 0x10]
006dc64a : MOV byte ptr [EAX + 0x80],0x1
006dc651 : POP EDI
006dc652 : POP ESI
006dc653 : MOV EAX,EBP
006dc655 : POP EBP
006dc656 : POP EBX
006dc657 : POP ECX
006dc658 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_0051b4e0
ENTRY    : 0051b4e0
BODY     : [[0051b4e0, 0051b583]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0051b4e0(undefined4 param_1)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  int *in_ECX;
  size_t local_10;
  undefined1 local_c [8];
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)&local_10;
  iVar2 = in_ECX[1];
  local_10 = 0;
  FUN_0051ad90(local_c,&local_10,param_1);
  uVar1 = local_10 + iVar2;
  if ((uint)in_ECX[2] <= uVar1) {
    uVar3 = in_ECX[3] + uVar1 & ~(in_ECX[3] - 1U);
    in_ECX[2] = uVar3;
    if (*in_ECX == 0) {
      iVar4 = FUN_00515840(uVar3,0);
    }
    else {
      iVar4 = FUN_00515c80(*in_ECX,uVar3);
    }
    *in_ECX = iVar4;
  }
  *(undefined1 *)(in_ECX + 4) = 0;
  in_ECX[1] = uVar1;
  if (*in_ECX != 0) {
    *(undefined1 *)(*in_ECX + uVar1) = 0;
  }
  _memcpy((void *)(*in_ECX + iVar2),local_c,local_10);
  __security_check_cookie(local_4 ^ (uint)&local_10);
  return;
}



============================================================
DISASSEMBLY
============================================================
0051b4e0 : SUB ESP,0x10
0051b4e3 : MOV EAX,[0x00d66fa0]
0051b4e8 : XOR EAX,ESP
0051b4ea : MOV dword ptr [ESP + 0xc],EAX
0051b4ee : MOV EAX,dword ptr [ESP + 0x14]
0051b4f2 : PUSH EBP
0051b4f3 : PUSH ESI
0051b4f4 : PUSH EDI
0051b4f5 : MOV ESI,ECX
0051b4f7 : MOV EBP,dword ptr [ESI + 0x4]
0051b4fa : PUSH EAX
0051b4fb : LEA ECX,[ESP + 0x10]
0051b4ff : PUSH ECX
0051b500 : LEA EDX,[ESP + 0x18]
0051b504 : PUSH EDX
0051b505 : MOV dword ptr [ESP + 0x18],0x0
0051b50d : CALL 0x0051ad90
0051b512 : MOV EAX,dword ptr [ESP + 0xc]
0051b516 : LEA EDI,[EAX + EBP*0x1]
0051b519 : CMP EDI,dword ptr [ESI + 0x8]
0051b51c : JC 0x0051b548
0051b51e : MOV ECX,dword ptr [ESI + 0xc]
0051b521 : LEA EAX,[ECX + EDI*0x1]
0051b524 : DEC ECX
0051b525 : NOT ECX
0051b527 : AND EAX,ECX
0051b529 : MOV ECX,dword ptr [ESI]
0051b52b : MOV dword ptr [ESI + 0x8],EAX
0051b52e : TEST ECX,ECX
0051b530 : JNZ 0x0051b53f
0051b532 : MOV ECX,dword ptr [ESI + 0x14]
0051b535 : PUSH 0x0
0051b537 : PUSH EAX
0051b538 : CALL 0x00515840
0051b53d : JMP 0x0051b546
0051b53f : PUSH EAX
0051b540 : PUSH ECX
0051b541 : CALL 0x00515c80
0051b546 : MOV dword ptr [ESI],EAX
0051b548 : MOV EAX,dword ptr [ESI]
0051b54a : MOV byte ptr [ESI + 0x10],0x0
0051b54e : MOV dword ptr [ESI + 0x4],EDI
0051b551 : TEST EAX,EAX
0051b553 : JZ 0x0051b559
0051b555 : MOV byte ptr [EAX + EDI*0x1],0x0
0051b559 : MOV ECX,dword ptr [ESP + 0xc]
0051b55d : MOV EAX,dword ptr [ESI]
0051b55f : PUSH ECX
0051b560 : LEA EDX,[ESP + 0x14]
0051b564 : PUSH EDX
0051b565 : ADD EAX,EBP
0051b567 : PUSH EAX
0051b568 : CALL 0x0063ae40
0051b56d : MOV ECX,dword ptr [ESP + 0x24]
0051b571 : ADD ESP,0xc
0051b574 : POP EDI
0051b575 : POP ESI
0051b576 : POP EBP
0051b577 : XOR ECX,ESP
0051b579 : CALL 0x00633e6b
0051b57e : ADD ESP,0x10
0051b581 : RET 0x4

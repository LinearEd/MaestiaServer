PROGRAM  : Maestia.exe
FUNCTION : FUN_008ebcd0
ENTRY    : 008ebcd0
BODY     : [[008ebcd0, 008ebe30]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_008ebcd0(int param_1)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  short sVar5;
  int *piVar6;
  int iVar7;
  uint uVar8;
  int local_1c;
  uint local_18;
  uint local_14;
  int *local_10;
  uint local_c;
  uint local_8;
  
  local_c = *(uint *)(*(int *)(DAT_0172491c + 0x17c) + 0xa0);
  uVar1 = *(uint *)(param_1 + 0x40);
  local_8 = 0;
  local_14 = 0;
  if (uVar1 != 0) {
    do {
      uVar8 = local_14;
      piVar6 = (int *)FUN_008eb810();
      local_10 = piVar6;
      if ((piVar6 != (int *)0x0) && ((char)piVar6[0x19] != '\0')) {
        iVar2 = *(int *)(piVar6[0xf] + 8);
        iVar3 = *(int *)(piVar6[0xf] + 0xc);
        param_1 = 0;
        if (0 < iVar2) {
          do {
            if (0 < iVar3) {
              iVar7 = 0;
              do {
                piVar6 = (int *)(**(code **)(*piVar6 + 0x74))(iVar7,param_1);
                iVar4 = DAT_00d7c54c;
                if ((((((piVar6 != (int *)0x0) && (piVar6[2] == 0x12345668)) &&
                      ((uint)piVar6[4] >> 0x10 == 0x674)) &&
                     ((local_18 = piVar6[4], FUN_004437f0(&local_18),
                      local_1c != *(int *)(iVar4 + 0x44) &&
                      (iVar4 = *(int *)(local_1c + 0x10), iVar4 != 0)))) &&
                    ((*(byte *)(iVar4 + 0x40) == 0 || (*(byte *)(iVar4 + 0x40) <= local_c)))) &&
                   ((((*(byte *)(iVar4 + 0x41) == 0 || (local_c <= *(byte *)(iVar4 + 0x41))) &&
                     (*(short *)(iVar4 + 0x180) == 0x18)) && (*(short *)(iVar4 + 0x182) == 1)))) {
                  sVar5 = (**(code **)(*piVar6 + 0x40))();
                  local_8 = CONCAT22(local_8._2_2_,(short)local_8 + sVar5);
                }
                iVar7 = iVar7 + 1;
                piVar6 = local_10;
              } while (iVar7 < iVar3);
            }
            param_1 = param_1 + 1;
            uVar8 = local_14;
          } while (param_1 < iVar2);
        }
      }
      local_14 = uVar8 + 1;
    } while (local_14 < uVar1);
  }
  return local_8 & 0xffff;
}



============================================================
DISASSEMBLY
============================================================
008ebcd0 : PUSH EBP
008ebcd1 : MOV EBP,ESP
008ebcd3 : SUB ESP,0x24
008ebcd6 : MOV EAX,[0x0172491c]
008ebcdb : MOV ECX,dword ptr [EAX + 0x17c]
008ebce1 : MOV EAX,dword ptr [EBP + 0x8]
008ebce4 : MOV EDX,dword ptr [ECX + 0xa0]
008ebcea : PUSH ESI
008ebceb : XOR ESI,ESI
008ebced : PUSH EDI
008ebcee : MOV EDI,dword ptr [EAX + 0x40]
008ebcf1 : MOV dword ptr [EBP + -0x4],ESI
008ebcf4 : MOV dword ptr [EBP + -0x8],EDX
008ebcf7 : MOV dword ptr [EBP + -0x24],EDI
008ebcfa : MOV dword ptr [EBP + -0x10],ESI
008ebcfd : CMP EDI,ESI
008ebcff : JBE 0x008ebe25
008ebd05 : PUSH EBX
008ebd06 : MOV EDX,dword ptr [0x00da9894]
008ebd0c : MOV EAX,dword ptr [EDX]
008ebd0e : MOV ECX,ESI
008ebd10 : CALL 0x008eb810
008ebd15 : MOV ECX,EAX
008ebd17 : MOV dword ptr [EBP + -0xc],ECX
008ebd1a : TEST ECX,ECX
008ebd1c : JZ 0x008ebe18
008ebd22 : CMP byte ptr [ECX + 0x64],0x0
008ebd26 : JZ 0x008ebe18
008ebd2c : MOV EAX,dword ptr [ECX + 0x3c]
008ebd2f : MOV EDX,dword ptr [EAX + 0x8]
008ebd32 : MOV EAX,dword ptr [EAX + 0xc]
008ebd35 : MOV dword ptr [EBP + -0x20],EDX
008ebd38 : MOV dword ptr [EBP + -0x1c],EAX
008ebd3b : MOV dword ptr [EBP + 0x8],0x0
008ebd42 : TEST EDX,EDX
008ebd44 : JLE 0x008ebe18
008ebd4a : LEA EBX,[EBX]
008ebd50 : XOR EBX,EBX
008ebd52 : TEST EAX,EAX
008ebd54 : JLE 0x008ebe03
008ebd5a : LEA EBX,[EBX]
008ebd60 : MOV EDX,dword ptr [EBP + 0x8]
008ebd63 : MOV EAX,dword ptr [ECX]
008ebd65 : MOV EAX,dword ptr [EAX + 0x74]
008ebd68 : PUSH EDX
008ebd69 : PUSH EBX
008ebd6a : CALL EAX
008ebd6c : MOV ESI,EAX
008ebd6e : TEST ESI,ESI
008ebd70 : JZ 0x008ebdf1
008ebd72 : CMP dword ptr [ESI + 0x8],0x12345668
008ebd79 : JNZ 0x008ebdf1
008ebd7b : MOV EAX,dword ptr [ESI + 0x10]
008ebd7e : MOV ECX,EAX
008ebd80 : SHR ECX,0x10
008ebd83 : CMP ECX,0x674
008ebd89 : JNZ 0x008ebdf1
008ebd8b : MOV EDI,dword ptr [0x00d7c54c]
008ebd91 : LEA EDX,[EBP + -0x14]
008ebd94 : MOV dword ptr [EBP + -0x14],EAX
008ebd97 : PUSH EDX
008ebd98 : LEA ECX,[EDI + 0x40]
008ebd9b : LEA EAX,[EBP + -0x18]
008ebd9e : CALL 0x004437f0
008ebda3 : MOV EAX,dword ptr [EBP + -0x18]
008ebda6 : CMP EAX,dword ptr [EDI + 0x44]
008ebda9 : JZ 0x008ebdf1
008ebdab : MOV EAX,dword ptr [EAX + 0x10]
008ebdae : TEST EAX,EAX
008ebdb0 : JZ 0x008ebdf1
008ebdb2 : MOV CL,byte ptr [EAX + 0x40]
008ebdb5 : TEST CL,CL
008ebdb7 : JZ 0x008ebdc1
008ebdb9 : MOVZX ECX,CL
008ebdbc : CMP dword ptr [EBP + -0x8],ECX
008ebdbf : JC 0x008ebdf1
008ebdc1 : MOV CL,byte ptr [EAX + 0x41]
008ebdc4 : TEST CL,CL
008ebdc6 : JZ 0x008ebdd0
008ebdc8 : MOVZX EDX,CL
008ebdcb : CMP dword ptr [EBP + -0x8],EDX
008ebdce : JA 0x008ebdf1
008ebdd0 : CMP word ptr [EAX + 0x180],0x18
008ebdd8 : JNZ 0x008ebdf1
008ebdda : CMP word ptr [EAX + 0x182],0x1
008ebde2 : JNZ 0x008ebdf1
008ebde4 : MOV EAX,dword ptr [ESI]
008ebde6 : MOV EDX,dword ptr [EAX + 0x40]
008ebde9 : MOV ECX,ESI
008ebdeb : CALL EDX
008ebded : ADD word ptr [EBP + -0x4],AX
008ebdf1 : MOV EAX,dword ptr [EBP + -0x1c]
008ebdf4 : MOV ECX,dword ptr [EBP + -0xc]
008ebdf7 : INC EBX
008ebdf8 : CMP EBX,EAX
008ebdfa : JL 0x008ebd60
008ebe00 : MOV EDX,dword ptr [EBP + -0x20]
008ebe03 : MOV ESI,dword ptr [EBP + 0x8]
008ebe06 : INC ESI
008ebe07 : CMP ESI,EDX
008ebe09 : MOV dword ptr [EBP + 0x8],ESI
008ebe0c : JL 0x008ebd50
008ebe12 : MOV EDI,dword ptr [EBP + -0x24]
008ebe15 : MOV ESI,dword ptr [EBP + -0x10]
008ebe18 : INC ESI
008ebe19 : MOV dword ptr [EBP + -0x10],ESI
008ebe1c : CMP ESI,EDI
008ebe1e : JC 0x008ebd06
008ebe24 : POP EBX
008ebe25 : MOV AX,word ptr [EBP + -0x4]
008ebe29 : POP EDI
008ebe2a : POP ESI
008ebe2b : MOV ESP,EBP
008ebe2d : POP EBP
008ebe2e : RET 0x4

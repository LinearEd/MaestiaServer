PROGRAM  : Maestia.exe
FUNCTION : FUN_006a42d0
ENTRY    : 006a42d0
BODY     : [[006a42d0, 006a4447] [006a4450, 006a4544]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006a42d0(void)

{
  byte bVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  byte *pbVar4;
  int iVar5;
  char *pcVar6;
  byte *pbVar7;
  byte *pbVar8;
  int unaff_EBX;
  undefined4 *puVar9;
  int iVar10;
  bool bVar11;
  int local_144;
  int local_140;
  int local_13c;
  int local_138;
  byte *local_134;
  undefined4 local_d8;
  int local_c4;
  int local_bc;
  undefined4 local_a0;
  undefined4 local_9c;
  undefined4 local_84;
  undefined4 local_68;
  int local_5c;
  undefined4 local_50;
  undefined4 local_4c;
  
  uVar2 = *(undefined4 *)(unaff_EBX + 100);
  FUN_006a4160();
  uVar3 = FUN_00688c00(uVar2,0xc,&local_140);
  *(undefined4 *)(unaff_EBX + 0x1ec) = uVar3;
  if (((local_140 == 0) && (local_140 = FUN_006a3110(uVar2), local_140 == 0)) &&
     (local_140 = FUN_006a3f60(), local_140 == 0)) {
    if (*(char *)(unaff_EBX + 0x1ad) == '*') {
      *(undefined4 *)(unaff_EBX + 0x19c) = local_a0;
      if (local_5c == 0) {
        local_140 = 3;
      }
      *(undefined4 *)(unaff_EBX + 0x188) = local_68;
      *(undefined4 *)(unaff_EBX + 0x1a4) = local_50;
      local_5c = 0;
      *(undefined4 *)(unaff_EBX + 0x1a8) = local_4c;
      *(undefined4 *)(unaff_EBX + 0x18c) = local_9c;
      *(undefined4 *)(unaff_EBX + 0x1a0) = local_84;
      local_9c = 0;
      local_84 = 0;
      if (*(int *)(unaff_EBX + 0x16c) == 1) {
        local_13c = 32000;
        local_138 = -32000;
        local_144 = 0;
        if (0 < local_c4) {
LAB_006a4403:
          *(undefined2 *)(*(int *)(unaff_EBX + 0x17c) + local_144 * 2) = 0;
          *(char **)(*(int *)(unaff_EBX + 0x180) + local_144 * 4) = ".notdef";
          local_134 = *(byte **)(local_bc + local_144 * 4);
          if ((local_134 != (byte *)0x0) && (iVar10 = 0, 0 < *(int *)(unaff_EBX + 0x19c))) {
            puVar9 = *(undefined4 **)(unaff_EBX + 0x1a0);
            do {
              pbVar8 = (byte *)*puVar9;
              pbVar4 = local_134;
              pbVar7 = pbVar8;
              do {
                bVar1 = *pbVar4;
                bVar11 = bVar1 < *pbVar7;
                if (bVar1 != *pbVar7) {
LAB_006a4480:
                  iVar5 = (1 - (uint)bVar11) - (uint)(bVar11 != 0);
                  goto LAB_006a4485;
                }
                if (bVar1 == 0) break;
                bVar1 = pbVar4[1];
                bVar11 = bVar1 < pbVar7[1];
                if (bVar1 != pbVar7[1]) goto LAB_006a4480;
                pbVar4 = pbVar4 + 2;
                pbVar7 = pbVar7 + 2;
              } while (bVar1 != 0);
              iVar5 = 0;
LAB_006a4485:
              if (iVar5 == 0) {
                *(short *)(*(int *)(unaff_EBX + 0x17c) + local_144 * 2) = (short)iVar10;
                *(byte **)(*(int *)(unaff_EBX + 0x180) + local_144 * 4) = pbVar8;
                pcVar6 = ".notdef";
                goto LAB_006a44b5;
              }
              iVar10 = iVar10 + 1;
              puVar9 = puVar9 + 1;
            } while (iVar10 < *(int *)(unaff_EBX + 0x19c));
          }
          goto LAB_006a44fe;
        }
LAB_006a4510:
        *(int *)(unaff_EBX + 0x174) = local_13c;
        *(int *)(unaff_EBX + 0x178) = local_138;
        *(undefined4 *)(unaff_EBX + 0x170) = local_d8;
      }
    }
    else {
      local_140 = 2;
    }
  }
  FUN_006a4190();
  return local_140;
  while( true ) {
    bVar1 = ((byte *)pcVar6)[1];
    bVar11 = bVar1 < pbVar8[1];
    if (bVar1 != pbVar8[1]) goto LAB_006a44d5;
    pcVar6 = (char *)((byte *)pcVar6 + 2);
    pbVar8 = pbVar8 + 2;
    if (bVar1 == 0) break;
LAB_006a44b5:
    bVar1 = *pcVar6;
    bVar11 = bVar1 < *pbVar8;
    if (bVar1 != *pbVar8) {
LAB_006a44d5:
      iVar10 = (1 - (uint)bVar11) - (uint)(bVar11 != 0);
      goto LAB_006a44da;
    }
    if (bVar1 == 0) break;
  }
  iVar10 = 0;
LAB_006a44da:
  if (iVar10 != 0) {
    if (local_144 < local_13c) {
      local_13c = local_144;
    }
    if (local_138 < local_144) {
      local_138 = local_144;
    }
  }
LAB_006a44fe:
  local_144 = local_144 + 1;
  if (local_c4 <= local_144) goto LAB_006a4510;
  goto LAB_006a4403;
}



============================================================
DISASSEMBLY
============================================================
006a42d0 : SUB ESP,0x144
006a42d6 : PUSH EBP
006a42d7 : MOV EBP,dword ptr [EBX + 0x1e4]
006a42dd : PUSH ESI
006a42de : PUSH EDI
006a42df : MOV EDI,dword ptr [EBX + 0x64]
006a42e2 : LEA ESI,[ESP + 0x20]
006a42e6 : CALL 0x006a4160
006a42eb : LEA EAX,[ESP + 0x10]
006a42ef : PUSH EAX
006a42f0 : PUSH 0xc
006a42f2 : PUSH EDI
006a42f3 : CALL 0x00688c00
006a42f8 : ADD ESP,0xc
006a42fb : CMP dword ptr [ESP + 0x10],0x0
006a4300 : MOV dword ptr [EBX + 0x1ec],EAX
006a4306 : JNZ 0x006a452e
006a430c : PUSH EDI
006a430d : MOV EDI,dword ptr [EBX + 0x68]
006a4310 : MOV EAX,EBP
006a4312 : CALL 0x006a3110
006a4317 : XOR ESI,ESI
006a4319 : ADD ESP,0x4
006a431c : MOV dword ptr [ESP + 0x10],EAX
006a4320 : CMP EAX,ESI
006a4322 : JNZ 0x006a452e
006a4328 : MOV EAX,dword ptr [ESP + 0x70]
006a432c : MOV ECX,dword ptr [ESP + 0x6c]
006a4330 : PUSH EBX
006a4331 : LEA EDX,[ESP + 0x24]
006a4335 : CALL 0x006a3f60
006a433a : ADD ESP,0x4
006a433d : MOV dword ptr [ESP + 0x10],EAX
006a4341 : CMP EAX,ESI
006a4343 : JNZ 0x006a452e
006a4349 : CMP byte ptr [EBX + 0x1ad],0x2a
006a4350 : JZ 0x006a435f
006a4352 : MOV dword ptr [ESP + 0x10],0x2
006a435a : JMP 0x006a452e
006a435f : MOV ECX,dword ptr [ESP + 0xb0]
006a4366 : MOV dword ptr [EBX + 0x19c],ECX
006a436c : CMP dword ptr [ESP + 0xf4],ESI
006a4373 : JNZ 0x006a437d
006a4375 : MOV dword ptr [ESP + 0x10],0x3
006a437d : CMP dword ptr [EBX + 0x16c],0x1
006a4384 : MOV EDX,dword ptr [ESP + 0xe8]
006a438b : MOV EAX,dword ptr [ESP + 0x100]
006a4392 : MOV ECX,dword ptr [ESP + 0x104]
006a4399 : MOV dword ptr [EBX + 0x188],EDX
006a439f : MOV EDX,dword ptr [ESP + 0xb4]
006a43a6 : MOV dword ptr [EBX + 0x1a4],EAX
006a43ac : MOV EAX,dword ptr [ESP + 0xcc]
006a43b3 : MOV dword ptr [ESP + 0xf4],ESI
006a43ba : MOV dword ptr [EBX + 0x1a8],ECX
006a43c0 : MOV dword ptr [EBX + 0x18c],EDX
006a43c6 : MOV dword ptr [EBX + 0x1a0],EAX
006a43cc : MOV dword ptr [ESP + 0xb4],ESI
006a43d3 : MOV dword ptr [ESP + 0xcc],ESI
006a43da : JNZ 0x006a452e
006a43e0 : XOR ECX,ECX
006a43e2 : CMP dword ptr [ESP + 0x8c],ESI
006a43e9 : MOV dword ptr [ESP + 0x14],0x7d00
006a43f1 : MOV dword ptr [ESP + 0x18],0xffff8300
006a43f9 : MOV dword ptr [ESP + 0xc],ECX
006a43fd : JLE 0x006a4510
006a4403 : MOV EDX,dword ptr [EBX + 0x17c]
006a4409 : XOR EAX,EAX
006a440b : MOV word ptr [EDX + ECX*0x2],AX
006a440f : MOV EDX,dword ptr [EBX + 0x180]
006a4415 : MOV dword ptr [EDX + ECX*0x4],0xbe967c
006a441c : MOV EAX,dword ptr [ESP + 0x94]
006a4423 : MOV EAX,dword ptr [EAX + ECX*0x4]
006a4426 : MOV dword ptr [ESP + 0x1c],EAX
006a442a : TEST EAX,EAX
006a442c : JZ 0x006a44fe
006a4432 : XOR EDI,EDI
006a4434 : CMP dword ptr [EBX + 0x19c],EDI
006a443a : JLE 0x006a44fe
006a4440 : MOV EBP,dword ptr [EBX + 0x1a0]
006a4446 : JMP 0x006a4454
006a4450 : MOV EAX,dword ptr [ESP + 0x1c]
006a4454 : MOV ESI,dword ptr [EBP]
006a4457 : MOV ECX,ESI
006a4459 : LEA ESP,[ESP]
006a4460 : MOV DL,byte ptr [EAX]
006a4462 : CMP DL,byte ptr [ECX]
006a4464 : JNZ 0x006a4480
006a4466 : TEST DL,DL
006a4468 : JZ 0x006a447c
006a446a : MOV DL,byte ptr [EAX + 0x1]
006a446d : CMP DL,byte ptr [ECX + 0x1]
006a4470 : JNZ 0x006a4480
006a4472 : ADD EAX,0x2
006a4475 : ADD ECX,0x2
006a4478 : TEST DL,DL
006a447a : JNZ 0x006a4460
006a447c : XOR EAX,EAX
006a447e : JMP 0x006a4485
006a4480 : SBB EAX,EAX
006a4482 : SBB EAX,-0x1
006a4485 : TEST EAX,EAX
006a4487 : JZ 0x006a4497
006a4489 : INC EDI
006a448a : ADD EBP,0x4
006a448d : CMP EDI,dword ptr [EBX + 0x19c]
006a4493 : JL 0x006a4450
006a4495 : JMP 0x006a44fa
006a4497 : MOV ECX,dword ptr [EBX + 0x17c]
006a449d : MOV EAX,dword ptr [ESP + 0xc]
006a44a1 : MOV word ptr [ECX + EAX*0x2],DI
006a44a5 : MOV EDX,dword ptr [EBX + 0x180]
006a44ab : MOV dword ptr [EDX + EAX*0x4],ESI
006a44ae : MOV ECX,ESI
006a44b0 : MOV EAX,0xbe967c
006a44b5 : MOV DL,byte ptr [EAX]
006a44b7 : CMP DL,byte ptr [ECX]
006a44b9 : JNZ 0x006a44d5
006a44bb : TEST DL,DL
006a44bd : JZ 0x006a44d1
006a44bf : MOV DL,byte ptr [EAX + 0x1]
006a44c2 : CMP DL,byte ptr [ECX + 0x1]
006a44c5 : JNZ 0x006a44d5
006a44c7 : ADD EAX,0x2
006a44ca : ADD ECX,0x2
006a44cd : TEST DL,DL
006a44cf : JNZ 0x006a44b5
006a44d1 : XOR EAX,EAX
006a44d3 : JMP 0x006a44da
006a44d5 : SBB EAX,EAX
006a44d7 : SBB EAX,-0x1
006a44da : TEST EAX,EAX
006a44dc : JZ 0x006a44fa
006a44de : MOV EAX,dword ptr [ESP + 0xc]
006a44e2 : CMP EAX,dword ptr [ESP + 0x14]
006a44e6 : JGE 0x006a44ec
006a44e8 : MOV dword ptr [ESP + 0x14],EAX
006a44ec : CMP EAX,dword ptr [ESP + 0x18]
006a44f0 : JLE 0x006a44fa
006a44f2 : MOV EAX,dword ptr [ESP + 0xc]
006a44f6 : MOV dword ptr [ESP + 0x18],EAX
006a44fa : MOV ECX,dword ptr [ESP + 0xc]
006a44fe : INC ECX
006a44ff : CMP ECX,dword ptr [ESP + 0x8c]
006a4506 : MOV dword ptr [ESP + 0xc],ECX
006a450a : JL 0x006a4403
006a4510 : MOV ECX,dword ptr [ESP + 0x14]
006a4514 : MOV EDX,dword ptr [ESP + 0x18]
006a4518 : MOV EAX,dword ptr [ESP + 0x78]
006a451c : MOV dword ptr [EBX + 0x174],ECX
006a4522 : MOV dword ptr [EBX + 0x178],EDX
006a4528 : MOV dword ptr [EBX + 0x170],EAX
006a452e : LEA EAX,[ESP + 0x20]
006a4532 : CALL 0x006a4190
006a4537 : MOV EAX,dword ptr [ESP + 0x10]
006a453b : POP EDI
006a453c : POP ESI
006a453d : POP EBP
006a453e : ADD ESP,0x144
006a4544 : RET

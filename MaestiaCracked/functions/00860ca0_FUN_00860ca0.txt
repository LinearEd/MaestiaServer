PROGRAM  : Maestia.exe
FUNCTION : FUN_00860ca0
ENTRY    : 00860ca0
BODY     : [[00860ca0, 00860fba] [00860fc0, 0086121e]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00860ca0(int param_1)

{
  undefined *puVar1;
  char cVar2;
  undefined1 uVar3;
  int iVar4;
  int *piVar5;
  undefined4 uVar6;
  undefined **in_ECX;
  undefined **ppuVar7;
  uint uVar8;
  wchar_t *pwVar9;
  undefined *puStack_6c;
  undefined **local_68;
  undefined *puStack_64;
  undefined *local_60;
  int iStack_5c;
  int *piStack_58;
  undefined **local_54;
  undefined **local_50;
  int *piStack_4c;
  undefined1 auStack_48 [4];
  int iStack_44;
  int iStack_40;
  undefined4 uStack_3c;
  LPCRITICAL_SECTION p_Stack_38;
  undefined4 uStack_34;
  undefined4 uStack_30;
  int iStack_2c;
  undefined4 uStack_28;
  undefined4 uStack_24;
  uint uStack_20;
  void *pvStack_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_00b49031;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  local_60 = (undefined *)0x0;
  local_68 = (undefined **)0x0;
  if (*(char *)((int)in_ECX + -0x199a) != '\0') {
    FUN_008018d0(L"AvaPlayerCharacter::AdditionalBGLoading IsDisappear additionalbgloading fail!!");
    ExceptionList = local_14;
    return;
  }
  local_54 = in_ECX + -0x7d7;
  local_50 = in_ECX;
  (**(code **)(in_ECX[-0x7d7] + 0x20c))(1,DAT_00d66fa0 ^ (uint)&stack0xffffff88);
  if (*(int *)(param_1 + 0x34) != 9) {
    FUN_00406460(
                L"AvaPlayerCharacter::AdditionalBGLoading rpEntity != AvaBGEntity::BGENTITY_PLAYERCHARLOD"
                );
    puStack_10 = (undefined1 *)0x0;
    if ((int *)*DAT_00da98e8 != (int *)0x0) {
      (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                (L"AvaPlayerCharacter::AdditionalBGLoading",0x461,&p_Stack_38);
    }
    puStack_10 = (undefined1 *)0xffffffff;
    if (7 < uStack_20) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    uStack_20 = 7;
    uStack_24 = 0;
    uStack_34 = (char *)((uint)uStack_34._2_2_ << 0x10);
    goto LAB_008611fa;
  }
  if (in_ECX == (undefined **)0x1f5c) {
    iVar4 = 0;
  }
  else {
    iVar4 = *(int *)(in_ECX[-0x789] + 8) + -0x1e24 + (int)in_ECX;
  }
  if (*(int *)(param_1 + 0x8c) != iVar4) {
    FUN_008018d0(L"AvaPlayerCharacter::AdditionalBGLoading rpEntity->GetTargetRsc() != this !!");
    goto LAB_008611fa;
  }
  local_60 = *(undefined **)(param_1 + 0x114);
  if (*(int *)(param_1 + 0x110) == 0) {
    pwVar9 = L"AvaPlayerCharacter::AdditionalBGLoading bgEntity->GetPartNode() == NULL";
LAB_00860fc5:
    FUN_008018d0(pwVar9);
  }
  else {
    if (in_ECX[-0x6dd] == (undefined *)0x0) {
      pwVar9 = L"AvaPlayerCharacter::AdditionalBGLoading m_pCharNode == NULL";
      goto LAB_00860fc5;
    }
    if (*(char *)(param_1 + 0x11a) == '\0') {
      if (((((DAT_00da93ec != 0) && (uVar8 = FUN_00a175f0(), DAT_00d710b4 < uVar8)) &&
           (puVar1 = in_ECX[-0x6dd], puVar1 != (undefined *)0x0)) &&
          ((*(int *)(puVar1 + 0x2b8) != 0 && (*(int *)(puVar1 + 0x2b4) == 0)))) &&
         (iVar4 = FUN_007f08d0(0), iVar4 != 0)) {
        *(undefined1 *)(param_1 + 0x30) = 1;
        FUN_00792980();
        goto LAB_008611fa;
      }
      ppuVar7 = in_ECX + -0x1db;
      iVar4 = 0x21;
      do {
        if ((*ppuVar7 != (undefined *)0x0) && (*ppuVar7 == *(undefined **)(param_1 + 0x110))) {
          puStack_6c = *(undefined **)(param_1 + 0x110);
        }
        ppuVar7 = ppuVar7 + 1;
        iVar4 = iVar4 + -1;
      } while (iVar4 != 0);
      if (puStack_6c == (undefined *)0x0) {
        pwVar9 = L"AvaPlayerCharacter::AdditionalBGLoading pPart == NULL";
      }
      else {
        local_68 = (undefined **)(param_1 + 0xf0);
        cVar2 = FUN_00403810();
        if ((cVar2 != '\0') || (cVar2 = FUN_00403810(), cVar2 != '\0')) goto LAB_00860fd3;
        cVar2 = FUN_00404010();
        if ((cVar2 == '\0') || (cVar2 = FUN_00404010(), cVar2 == '\0')) {
          if (*(int *)(param_1 + 0xec) == 1) {
            puStack_64 = (undefined *)0x3;
          }
          else {
            if (*(int *)(param_1 + 0xec) != 0) {
              pwVar9 = L"AvaPlayerCharacter::AdditionalBGLoading bgEntity->GetLODType() unknown";
              goto LAB_00860fc5;
            }
            puStack_64 = (undefined *)0x1;
          }
          FUN_006ef2b0(0x4c5);
          puStack_10 = (undefined1 *)0x1;
          piVar5 = (int *)FUN_00443eb0(&local_60);
          if ((undefined *)*piVar5 == in_ECX[-0xfc]) {
            puStack_10 = (undefined1 *)0xffffffff;
            FUN_006ef180();
            goto LAB_008611fa;
          }
          puStack_10 = (undefined1 *)0xffffffff;
          FUN_006ef180();
          uVar6 = *(undefined4 *)(param_1 + 0x10c);
          uVar3 = (**(code **)(*piStack_58 + 0x21c))();
          puStack_64 = (undefined *)FUN_007da5e0(in_ECX[-0x6dd],puStack_64,uVar6,uVar3);
          goto LAB_00860fd3;
        }
        pwVar9 = L"AvaPlayerCharacter::AdditionalBGLoading mesh name doesn\'t match";
      }
      goto LAB_00860fc5;
    }
  }
LAB_00860fd3:
  p_Stack_38 = (LPCRITICAL_SECTION)(in_ECX + -0x785);
  iStack_2c = 0;
  uStack_34 = ".\\Objects\\AvaPlayerCharacter.cpp";
  uStack_30 = 0x4e8;
  uStack_28 = 1;
  FUN_006ef1a0(&p_Stack_38);
  puStack_10 = (undefined1 *)0x2;
  piVar5 = (int *)FUN_00443eb0(&local_60);
  local_60 = (undefined *)*piVar5;
  if (local_60 != in_ECX[-0xfc]) {
    local_50 = (undefined **)FUN_006f0760(0xc,".\\Objects\\AvaPlayerCharacter.cpp",0x4ed,0);
    puStack_10._1_3_ = (undefined3)((uint)puStack_10 >> 8);
    ppuVar7 = (undefined **)0x0;
    if (local_50 != (undefined **)0x0) {
      *local_50 = (undefined *)0x0;
      local_50[1] = (undefined *)0x0;
      *(undefined1 *)(local_50 + 2) = 0;
      ppuVar7 = local_50;
    }
    puStack_10._0_1_ = 2;
    local_68 = ppuVar7;
    FUN_00476900(in_ECX + -0xfd,&local_50,local_60);
    uVar8 = 0;
    if (ppuVar7 == (undefined **)0x0) {
      FUN_008018d0(L"AvaPlayerCharacter::AdditionalBGLoading AVANEW ADDPARTINFO Fail");
      if (puStack_64 != (undefined *)0x0) {
        FUN_00443b30();
      }
    }
    else {
      *ppuVar7 = puStack_64;
      ppuVar7[1] = puStack_6c;
      puVar1 = in_ECX[-0xfb];
      *(bool *)(ppuVar7 + 2) = puVar1 == (undefined *)0x0;
      if (puVar1 == (undefined *)0x0) {
        iStack_44 = 0;
        iStack_40 = 0;
        uStack_3c = 0;
        puStack_10 = (undefined1 *)CONCAT31(puStack_10._1_3_,4);
        if (in_ECX[-0x6dd] != (undefined *)0x0) {
          FUN_007db420(auStack_48);
        }
        iVar4 = iStack_40 - iStack_44 >> 0x1f;
        if ((iStack_40 - iStack_44) / 0x1c + iVar4 != iVar4) {
          iVar4 = 0;
          do {
            uVar6 = FUN_007cf910(DAT_017251c8,&local_50,iStack_44 + iVar4,1);
            puStack_10._0_1_ = 5;
            FUN_0043e5a0(&local_60,uVar6);
            puStack_10 = (undefined1 *)CONCAT31(puStack_10._1_3_,7);
            local_50 = &PTR_FUN_00cd4964;
            if (piStack_4c != (int *)0x0) {
              (**(code **)(*piStack_4c + 0x30))();
              piStack_4c = (int *)0x0;
            }
            if ((*(int *)(DAT_017251ac + 0x20) != 0) && (iStack_5c != 0)) {
              FUN_0078e480();
            }
            puStack_10 = (undefined1 *)CONCAT31(puStack_10._1_3_,4);
            FUN_0040ed80(&local_60);
            uVar8 = uVar8 + 1;
            iVar4 = iVar4 + 0x1c;
          } while (uVar8 < (uint)((iStack_40 - iStack_44) / 0x1c));
        }
        FUN_00404280();
        puStack_10._0_1_ = 2;
        FUN_004042c0();
      }
      FUN_00443d70(&local_68);
    }
  }
  puStack_10 = (undefined1 *)0xffffffff;
  if (iStack_2c != 0) {
    LeaveCriticalSection(p_Stack_38);
    iStack_2c = 0;
  }
LAB_008611fa:
  (**(code **)(*piStack_58 + 0x20c))(0);
  ExceptionList = pvStack_1c;
  return;
}



============================================================
DISASSEMBLY
============================================================
00860ca0 : PUSH EBP
00860ca1 : MOV EBP,ESP
00860ca3 : AND ESP,0xfffffff8
00860ca6 : PUSH -0x1
00860ca8 : PUSH 0xb49031
00860cad : MOV EAX,FS:[0x0]
00860cb3 : PUSH EAX
00860cb4 : SUB ESP,0x58
00860cb7 : PUSH EBX
00860cb8 : PUSH ESI
00860cb9 : PUSH EDI
00860cba : MOV EAX,[0x00d66fa0]
00860cbf : XOR EAX,ESP
00860cc1 : PUSH EAX
00860cc2 : LEA EAX,[ESP + 0x68]
00860cc6 : MOV FS:[0x0],EAX
00860ccc : MOV EDI,ECX
00860cce : MOV dword ptr [ESP + 0x2c],EDI
00860cd2 : XOR ESI,ESI
00860cd4 : CMP byte ptr [EDI + 0xffffe666],0x0
00860cdb : MOV dword ptr [ESP + 0x1c],ESI
00860cdf : MOV dword ptr [ESP + 0x14],ESI
00860ce3 : JZ 0x00860d0d
00860ce5 : MOV ESI,dword ptr [0x00da98e8]
00860ceb : PUSH 0xc3e070
00860cf0 : CALL 0x008018d0
00860cf5 : ADD ESP,0x4
00860cf8 : MOV ECX,dword ptr [ESP + 0x68]
00860cfc : MOV dword ptr FS:[0x0],ECX
00860d03 : POP ECX
00860d04 : POP EDI
00860d05 : POP ESI
00860d06 : POP EBX
00860d07 : MOV ESP,EBP
00860d09 : POP EBP
00860d0a : RET 0x4
00860d0d : MOV EAX,dword ptr [EDI + 0xffffe0a4]
00860d13 : MOV EDX,dword ptr [EAX + 0x20c]
00860d19 : LEA ECX,[EDI + 0xffffe0a4]
00860d1f : PUSH 0x1
00860d21 : MOV dword ptr [ESP + 0x2c],ECX
00860d25 : CALL EDX
00860d27 : MOV EBX,dword ptr [EBP + 0x8]
00860d2a : CMP dword ptr [EBX + 0x34],0x9
00860d2e : JZ 0x00860d93
00860d30 : PUSH 0xc3e110
00860d35 : LEA ECX,[ESP + 0x4c]
00860d39 : CALL 0x00406460
00860d3e : MOV dword ptr [ESP + 0x70],ESI
00860d42 : MOV EAX,[0x00da98e8]
00860d47 : MOV ECX,dword ptr [EAX]
00860d49 : CMP ECX,ESI
00860d4b : JZ 0x00860d63
00860d4d : MOV EDX,dword ptr [ECX]
00860d4f : MOV EDX,dword ptr [EDX + 0x14]
00860d52 : LEA EAX,[ESP + 0x48]
00860d56 : PUSH EAX
00860d57 : PUSH 0x461
00860d5c : PUSH 0xc3e1c0
00860d61 : CALL EDX
00860d63 : MOV dword ptr [ESP + 0x70],0xffffffff
00860d6b : CMP dword ptr [ESP + 0x60],0x8
00860d70 : JC 0x00860d7b
00860d72 : MOV ECX,dword ptr [ESP + 0x4c]
00860d76 : CALL 0x006f04e0
00860d7b : XOR EAX,EAX
00860d7d : MOV dword ptr [ESP + 0x60],0x7
00860d85 : MOV dword ptr [ESP + 0x5c],ESI
00860d89 : MOV word ptr [ESP + 0x4c],AX
00860d8e : JMP 0x008611fa
00860d93 : LEA ECX,[EDI + 0xffffe0a4]
00860d99 : TEST ECX,ECX
00860d9b : JNZ 0x00860da1
00860d9d : XOR EAX,EAX
00860d9f : JMP 0x00860db1
00860da1 : MOV EDX,dword ptr [EDI + 0xffffe1dc]
00860da7 : MOV EAX,dword ptr [EDX + 0x8]
00860daa : LEA EAX,[EAX + EDI*0x1 + 0xffffe1dc]
00860db1 : CMP dword ptr [EBX + 0x8c],EAX
00860db7 : JZ 0x00860dd1
00860db9 : MOV ESI,dword ptr [0x00da98e8]
00860dbf : PUSH 0xc3e210
00860dc4 : CALL 0x008018d0
00860dc9 : ADD ESP,0x4
00860dcc : JMP 0x008611fa
00860dd1 : MOV EAX,dword ptr [EBX + 0x110]
00860dd7 : MOV ECX,dword ptr [EBX + 0x114]
00860ddd : MOV dword ptr [ESP + 0x20],ECX
00860de1 : CMP EAX,ESI
00860de3 : JNZ 0x00860def
00860de5 : PUSH 0xc3e2a8
00860dea : JMP 0x00860fc5
00860def : CMP dword ptr [EDI + 0xffffe48c],ESI
00860df5 : JNZ 0x00860e01
00860df7 : PUSH 0xc3e338
00860dfc : JMP 0x00860fc5
00860e01 : CMP byte ptr [EBX + 0x11a],0x0
00860e08 : JNZ 0x00860fd3
00860e0e : MOV ECX,dword ptr [0x00da93ec]
00860e14 : CMP ECX,ESI
00860e16 : JZ 0x00860e61
00860e18 : CALL 0x00a175f0
00860e1d : CMP EAX,dword ptr [0x00d710b4]
00860e23 : JBE 0x00860e61
00860e25 : MOV EAX,dword ptr [EDI + 0xffffe48c]
00860e2b : CMP EAX,ESI
00860e2d : JZ 0x00860e61
00860e2f : CMP dword ptr [EAX + 0x2b8],ESI
00860e35 : JZ 0x00860e61
00860e37 : CMP dword ptr [EAX + 0x2b4],ESI
00860e3d : JNZ 0x00860e61
00860e3f : PUSH ESI
00860e40 : MOV ESI,dword ptr [0x017251b8]
00860e46 : CALL 0x007f08d0
00860e4b : TEST EAX,EAX
00860e4d : JZ 0x00860e61
00860e4f : MOV EDI,EBX
00860e51 : MOV ESI,EAX
00860e53 : MOV byte ptr [EBX + 0x30],0x1
00860e57 : CALL 0x00792980
00860e5c : JMP 0x008611fa
00860e61 : LEA EDX,[EDI + 0xfffff894]
00860e67 : MOV ESI,0x21
00860e6c : LEA ESP,[ESP]
00860e70 : MOV EAX,dword ptr [EDX]
00860e72 : TEST EAX,EAX
00860e74 : JZ 0x00860e84
00860e76 : MOV ECX,dword ptr [EBX + 0x110]
00860e7c : CMP EAX,ECX
00860e7e : JNZ 0x00860e84
00860e80 : MOV dword ptr [ESP + 0x14],ECX
00860e84 : ADD EDX,0x4
00860e87 : SUB ESI,0x1
00860e8a : JNZ 0x00860e70
00860e8c : CMP dword ptr [ESP + 0x14],ESI
00860e90 : JNZ 0x00860e9c
00860e92 : PUSH 0xc3e3b0
00860e97 : JMP 0x00860fc5
00860e9c : LEA ECX,[EBX + 0xf0]
00860ea2 : MOV ESI,0xc3deb4
00860ea7 : MOV dword ptr [ESP + 0x18],ECX
00860eab : CALL 0x00403810
00860eb0 : TEST AL,AL
00860eb2 : JNZ 0x00860fd3
00860eb8 : MOV ECX,dword ptr [ESP + 0x18]
00860ebc : MOV ESI,0xc3dfcc
00860ec1 : CALL 0x00403810
00860ec6 : TEST AL,AL
00860ec8 : JNZ 0x00860fd3
00860ece : MOV EAX,dword ptr [ESP + 0x14]
00860ed2 : MOV ESI,dword ptr [ESP + 0x18]
00860ed6 : ADD EAX,0x60
00860ed9 : MOV ECX,ESI
00860edb : CALL 0x00404010
00860ee0 : TEST AL,AL
00860ee2 : JZ 0x00860f00
00860ee4 : MOV EAX,dword ptr [ESP + 0x14]
00860ee8 : ADD EAX,0x7c
00860eeb : MOV ECX,ESI
00860eed : CALL 0x00404010
00860ef2 : TEST AL,AL
00860ef4 : JZ 0x00860f00
00860ef6 : PUSH 0xc3e440
00860efb : JMP 0x00860fc5
00860f00 : MOV EAX,dword ptr [EBX + 0xec]
00860f06 : CMP EAX,0x1
00860f09 : JNZ 0x00860f15
00860f0b : MOV dword ptr [ESP + 0x1c],0x3
00860f13 : JMP 0x00860f25
00860f15 : TEST EAX,EAX
00860f17 : JNZ 0x00860fc0
00860f1d : MOV dword ptr [ESP + 0x1c],0x1
00860f25 : PUSH 0x4c5
00860f2a : LEA EAX,[EDI + 0xffffe1e8]
00860f30 : MOV ECX,0xc3e41c
00860f35 : LEA ESI,[ESP + 0x4c]
00860f39 : CALL 0x006ef2b0
00860f3e : MOV dword ptr [ESP + 0x70],0x1
00860f46 : LEA EDX,[ESP + 0x20]
00860f4a : PUSH EDX
00860f4b : LEA ECX,[EDI + 0xfffffc0c]
00860f51 : LEA EAX,[ESP + 0x34]
00860f55 : CALL 0x00443eb0
00860f5a : MOV EAX,dword ptr [EAX]
00860f5c : CMP EAX,dword ptr [EDI + 0xfffffc10]
00860f62 : JNZ 0x00860f76
00860f64 : MOV dword ptr [ESP + 0x70],0xffffffff
00860f6c : CALL 0x006ef180
00860f71 : JMP 0x008611fa
00860f76 : MOV dword ptr [ESP + 0x70],0xffffffff
00860f7e : LEA ESI,[ESP + 0x48]
00860f82 : CALL 0x006ef180
00860f87 : MOV ECX,dword ptr [ESP + 0x28]
00860f8b : MOV EAX,dword ptr [ECX]
00860f8d : MOV EDX,dword ptr [EAX + 0x21c]
00860f93 : MOV EBX,dword ptr [EBX + 0x10c]
00860f99 : CALL EDX
00860f9b : MOV ECX,dword ptr [ESP + 0x1c]
00860f9f : MOV EDX,dword ptr [EDI + 0xffffe48c]
00860fa5 : MOVZX EAX,AL
00860fa8 : PUSH EAX
00860fa9 : PUSH EBX
00860faa : PUSH ECX
00860fab : MOV ECX,dword ptr [ESP + 0x24]
00860faf : PUSH EDX
00860fb0 : CALL 0x007da5e0
00860fb5 : MOV dword ptr [ESP + 0x1c],EAX
00860fb9 : JMP 0x00860fd3
00860fc0 : PUSH 0xc3e4c0
00860fc5 : MOV ESI,dword ptr [0x00da98e8]
00860fcb : CALL 0x008018d0
00860fd0 : ADD ESP,0x4
00860fd3 : LEA ECX,[ESP + 0x48]
00860fd7 : LEA EAX,[EDI + 0xffffe1ec]
00860fdd : XOR ESI,ESI
00860fdf : PUSH ECX
00860fe0 : MOV dword ptr [ESP + 0x58],ESI
00860fe4 : MOV dword ptr [ESP + 0x4c],EAX
00860fe8 : MOV dword ptr [ESP + 0x50],0xc3e550
00860ff0 : MOV dword ptr [ESP + 0x54],0x4e8
00860ff8 : MOV dword ptr [ESP + 0x5c],0x1
00861000 : CALL 0x006ef1a0
00861005 : MOV dword ptr [ESP + 0x70],0x2
0086100d : LEA EDX,[ESP + 0x20]
00861011 : LEA EBX,[EDI + 0xfffffc0c]
00861017 : PUSH EDX
00861018 : LEA EAX,[ESP + 0x34]
0086101c : MOV ECX,EBX
0086101e : CALL 0x00443eb0
00861023 : MOV EAX,dword ptr [EAX]
00861025 : MOV dword ptr [ESP + 0x20],EAX
00861029 : CMP EAX,dword ptr [EDI + 0xfffffc10]
0086102f : JZ 0x008611d8
00861035 : PUSH ESI
00861036 : PUSH 0x4ed
0086103b : PUSH 0xc3e574
00861040 : PUSH 0xc
00861042 : CALL 0x006f0760
00861047 : ADD ESP,0x10
0086104a : MOV dword ptr [ESP + 0x30],EAX
0086104e : MOV byte ptr [ESP + 0x70],0x3
00861053 : CMP EAX,ESI
00861055 : JZ 0x00861062
00861057 : MOV dword ptr [EAX],ESI
00861059 : MOV dword ptr [EAX + 0x4],ESI
0086105c : MOV byte ptr [EAX + 0x8],0x0
00861060 : MOV ESI,EAX
00861062 : MOV byte ptr [ESP + 0x70],0x2
00861067 : MOV EAX,dword ptr [ESP + 0x20]
0086106b : PUSH EAX
0086106c : LEA ECX,[ESP + 0x34]
00861070 : PUSH ECX
00861071 : PUSH EBX
00861072 : MOV dword ptr [ESP + 0x24],ESI
00861076 : CALL 0x00476900
0086107b : XOR EBX,EBX
0086107d : CMP ESI,EBX
0086107f : JNZ 0x008610aa
00861081 : MOV ESI,dword ptr [0x00da98e8]
00861087 : PUSH 0xc3e5c0
0086108c : CALL 0x008018d0
00861091 : MOV ESI,dword ptr [ESP + 0x20]
00861095 : ADD ESP,0x4
00861098 : CMP ESI,EBX
0086109a : JZ 0x008611d8
008610a0 : CALL 0x00443b30
008610a5 : JMP 0x008611d8
008610aa : MOV EDX,dword ptr [ESP + 0x1c]
008610ae : MOV EAX,dword ptr [ESP + 0x14]
008610b2 : MOV dword ptr [ESI],EDX
008610b4 : MOV dword ptr [ESI + 0x4],EAX
008610b7 : CMP dword ptr [EDI + 0xfffffc14],EBX
008610bd : SETZ AL
008610c0 : MOV byte ptr [ESI + 0x8],AL
008610c3 : TEST AL,AL
008610c5 : JZ 0x008611c8
008610cb : MOV dword ptr [ESP + 0x3c],EBX
008610cf : MOV dword ptr [ESP + 0x40],EBX
008610d3 : MOV dword ptr [ESP + 0x44],EBX
008610d7 : MOV byte ptr [ESP + 0x70],0x4
008610dc : MOV ECX,dword ptr [EDI + 0xffffe48c]
008610e2 : CMP ECX,EBX
008610e4 : JZ 0x008610f0
008610e6 : LEA EDX,[ESP + 0x38]
008610ea : PUSH EDX
008610eb : CALL 0x007db420
008610f0 : MOV ECX,dword ptr [ESP + 0x40]
008610f4 : MOV ESI,dword ptr [ESP + 0x3c]
008610f8 : SUB ECX,ESI
008610fa : MOV EAX,0x92492493
008610ff : IMUL ECX
00861101 : ADD EDX,ECX
00861103 : SAR EDX,0x4
00861106 : MOV EAX,EDX
00861108 : SHR EAX,0x1f
0086110b : ADD EAX,EDX
0086110d : JZ 0x008611b5
00861113 : XOR EDI,EDI
00861115 : MOV EDX,dword ptr [0x017251c8]
0086111b : PUSH 0x1
0086111d : LEA EAX,[ESI + EDI*0x1]
00861120 : PUSH EAX
00861121 : LEA ECX,[ESP + 0x38]
00861125 : PUSH ECX
00861126 : PUSH EDX
00861127 : CALL 0x007cf910
0086112c : MOV byte ptr [ESP + 0x70],0x5
00861131 : PUSH EAX
00861132 : LEA EAX,[ESP + 0x24]
00861136 : PUSH EAX
00861137 : CALL 0x0043e5a0
0086113c : MOV byte ptr [ESP + 0x70],0x7
00861141 : MOV ECX,dword ptr [ESP + 0x34]
00861145 : MOV dword ptr [ESP + 0x30],0xcd4964
0086114d : TEST ECX,ECX
0086114f : JZ 0x00861160
00861151 : MOV EDX,dword ptr [ECX]
00861153 : MOV EAX,dword ptr [EDX + 0x30]
00861156 : CALL EAX
00861158 : MOV dword ptr [ESP + 0x34],0x0
00861160 : MOV ECX,dword ptr [0x017251ac]
00861166 : CMP dword ptr [ECX + 0x20],0x0
0086116a : JZ 0x00861179
0086116c : MOV ECX,dword ptr [ESP + 0x24]
00861170 : TEST ECX,ECX
00861172 : JZ 0x00861179
00861174 : CALL 0x0078e480
00861179 : MOV byte ptr [ESP + 0x70],0x4
0086117e : LEA EDX,[ESP + 0x20]
00861182 : PUSH EDX
00861183 : CALL 0x0040ed80
00861188 : MOV ECX,dword ptr [ESP + 0x40]
0086118c : MOV ESI,dword ptr [ESP + 0x3c]
00861190 : SUB ECX,ESI
00861192 : MOV EAX,0x92492493
00861197 : IMUL ECX
00861199 : ADD EDX,ECX
0086119b : SAR EDX,0x4
0086119e : MOV EAX,EDX
008611a0 : SHR EAX,0x1f
008611a3 : INC EBX
008611a4 : ADD EAX,EDX
008611a6 : ADD EDI,0x1c
008611a9 : CMP EBX,EAX
008611ab : JC 0x00861115
008611b1 : MOV EDI,dword ptr [ESP + 0x2c]
008611b5 : LEA ESI,[ESP + 0x38]
008611b9 : CALL 0x00404280
008611be : MOV byte ptr [ESP + 0x70],0x2
008611c3 : CALL 0x004042c0
008611c8 : LEA ECX,[ESP + 0x18]
008611cc : PUSH ECX
008611cd : LEA EAX,[EDI + 0xfffffbec]
008611d3 : CALL 0x00443d70
008611d8 : MOV dword ptr [ESP + 0x70],0xffffffff
008611e0 : CMP dword ptr [ESP + 0x54],0x0
008611e5 : JZ 0x008611fa
008611e7 : MOV EDX,dword ptr [ESP + 0x48]
008611eb : PUSH EDX
008611ec : CALL dword ptr [0x00b8511c]
008611f2 : MOV dword ptr [ESP + 0x54],0x0
008611fa : MOV ECX,dword ptr [ESP + 0x28]
008611fe : MOV EAX,dword ptr [ECX]
00861200 : MOV EDX,dword ptr [EAX + 0x20c]
00861206 : PUSH 0x0
00861208 : CALL EDX
0086120a : MOV ECX,dword ptr [ESP + 0x68]
0086120e : MOV dword ptr FS:[0x0],ECX
00861215 : POP ECX
00861216 : POP EDI
00861217 : POP ESI
00861218 : POP EBX
00861219 : MOV ESP,EBP
0086121b : POP EBP
0086121c : RET 0x4

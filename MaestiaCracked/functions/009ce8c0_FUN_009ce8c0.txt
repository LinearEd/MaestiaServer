PROGRAM  : Maestia.exe
FUNCTION : FUN_009ce8c0
ENTRY    : 009ce8c0
BODY     : [[009ce8c0, 009cec82]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009ce8c0(uint param_1,undefined4 param_2)

{
  short sVar1;
  ushort uVar2;
  ulonglong uVar3;
  uint uVar4;
  void *pvVar5;
  undefined1 uVar6;
  short *psVar7;
  ushort *puVar8;
  int iVar9;
  uint8_t *packet;
  ushort *puVar10;
  short *psVar11;
  bool bVar12;
  undefined1 auStack_94 [4];
  uint local_90;
  int *local_8c;
  undefined4 local_88;
  undefined1 local_84 [4];
  int local_80;
  int local_7c;
  undefined4 local_78;
  int local_74;
  undefined1 local_70 [4];
  undefined2 local_6c;
  undefined4 local_5c;
  uint local_58;
  undefined1 local_54 [4];
  undefined2 local_50;
  undefined4 local_40;
  uint local_3c;
  undefined4 local_34;
  undefined4 local_24;
  uint local_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  uint local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b60ddf;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_94;
  ExceptionList = &local_14;
  local_90 = param_1;
  FUN_00403dd0(param_2,DAT_00d66fa0 ^ (uint)&stack0xffffff60);
  local_c = 0;
  local_58 = 7;
  local_5c = 0;
  local_6c = 0;
  FUN_00406360(&DAT_00c957b4,1);
  local_c._0_1_ = 1;
  psVar11 = local_34;
  if (local_20 < 8) {
    psVar11 = (short *)&local_34;
  }
  local_3c = 7;
  local_40 = 0;
  local_50 = 0;
  psVar7 = psVar11;
  do {
    sVar1 = *psVar7;
    psVar7 = psVar7 + 1;
  } while (sVar1 != 0);
  FUN_00406360(psVar11,(int)psVar7 - (int)(psVar11 + 1) >> 1);
  local_c._0_1_ = 2;
  FUN_0070cd60(local_84,local_54,local_70,0);
  local_c = CONCAT31(local_c._1_3_,4);
  if (7 < local_3c) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_3c = 7;
  local_40 = 0;
  local_50 = 0;
  local_c = CONCAT31(local_c._1_3_,5);
  if (7 < local_58) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_58 = 7;
  local_5c = 0;
  local_6c = 0;
  if (*(uint *)(param_1 + 0x18) < 8) {
    puVar8 = (ushort *)(param_1 + 4);
  }
  else {
    puVar8 = *(ushort **)(param_1 + 4);
  }
  puVar10 = &DAT_00c957b8;
  do {
    uVar2 = *puVar8;
    bVar12 = uVar2 < *puVar10;
    if (uVar2 != *puVar10) {
LAB_009cea39:
      iVar9 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
      goto LAB_009cea3e;
    }
    if (uVar2 == 0) break;
    uVar2 = puVar8[1];
    bVar12 = uVar2 < puVar10[1];
    if (uVar2 != puVar10[1]) goto LAB_009cea39;
    puVar8 = puVar8 + 2;
    puVar10 = puVar10 + 2;
  } while (uVar2 != 0);
  iVar9 = 0;
LAB_009cea3e:
  if (iVar9 == 0) {
    FUN_009cd930();
  }
  else {
    iVar9 = FUN_00405bb0(L"RegParty");
    if (iVar9 == 0) {
      iVar9 = local_7c - local_80 >> 0x1f;
      if ((local_7c - local_80) / 0x1c + iVar9 == iVar9) {
        local_90 = 0;
      }
      else {
        if (*(uint *)(local_80 + 0x18) < 8) {
          iVar9 = local_80 + 4;
        }
        else {
          iVar9 = *(int *)(local_80 + 4);
        }
        local_90 = FUN_00634f4d(iVar9);
        local_90 = local_90 & 0xffff;
      }
      uVar4 = (local_7c - local_80) / 0x1c;
      if (uVar4 < 2) {
        psVar11 = (short *)&DAT_00c957dc;
      }
      else if (*(uint *)(local_80 + 0x34) < 8) {
        psVar11 = (short *)(local_80 + 0x20);
      }
      else {
        psVar11 = *(short **)(local_80 + 0x20);
      }
      if (uVar4 < 3) {
        local_88 = CONCAT31(local_88._1_3_,6);
      }
      else if (*(uint *)(local_80 + 0x50) < 8) {
        uVar6 = FUN_00634f4d(local_80 + 0x3c);
        local_88 = CONCAT31(local_88._1_3_,uVar6);
      }
      else {
        uVar6 = FUN_00634f4d(*(undefined4 *)(local_80 + 0x3c));
        local_88 = CONCAT31(local_88._1_3_,uVar6);
      }
      pvVar5 = ThreadLocalStoragePointer;
      if (*psVar11 == 0) {
        FUN_009adfc0(*(undefined4 *)(*DAT_00da9894 + 0x1a8),3);
      }
      else {
        *(undefined2 *)(local_8c + 0xe) = 0;
        iVar9 = *(int *)pvVar5;
        uVar3 = (ulonglong)(*(byte *)(iVar9 + 0x18) + 1) % 3;
        local_74 = (int)uVar3 * 0x2000 + 0x122cb8 + iVar9;
        *(char *)(iVar9 + 0x18) = (char)uVar3;
        local_c._0_1_ = 6;
        if (local_74 == 0) {
          packet = (uint8_t *)0x0;
        }
        else {
          packet = (uint8_t *)FUN_0041d050(local_90,local_88);
        }
        local_c = CONCAT31(local_c._1_3_,5);
        if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
          FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),0x57,packet);
        }
        (**(code **)(*local_8c + 0x20))();
      }
    }
    else {
      iVar9 = FUN_00405bb0(L"Close");
      if (iVar9 == 0) {
        (**(code **)(*local_8c + 0x20))();
      }
    }
  }
  local_c = local_c & 0xffffff00;
  if (local_80 != 0) {
    FUN_00405450(local_74);
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_80 = 0;
  local_7c = 0;
  local_78 = 0;
  local_c = 0xffffffff;
  if (7 < local_20) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_20 = 7;
  local_24 = 0;
  local_34 = (short *)((uint)local_34._2_2_ << 0x10);
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_94);
  return;
}



============================================================
DISASSEMBLY
============================================================
009ce8c0 : PUSH EBP
009ce8c1 : MOV EBP,ESP
009ce8c3 : AND ESP,0xfffffff8
009ce8c6 : PUSH -0x1
009ce8c8 : PUSH 0xb60ddf
009ce8cd : MOV EAX,FS:[0x0]
009ce8d3 : PUSH EAX
009ce8d4 : SUB ESP,0x80
009ce8da : MOV EAX,[0x00d66fa0]
009ce8df : XOR EAX,ESP
009ce8e1 : MOV dword ptr [ESP + 0x78],EAX
009ce8e5 : PUSH EBX
009ce8e6 : PUSH ESI
009ce8e7 : PUSH EDI
009ce8e8 : MOV EAX,[0x00d66fa0]
009ce8ed : XOR EAX,ESP
009ce8ef : PUSH EAX
009ce8f0 : LEA EAX,[ESP + 0x90]
009ce8f7 : MOV FS:[0x0],EAX
009ce8fd : MOV EAX,dword ptr [EBP + 0xc]
009ce900 : MOV EDI,dword ptr [EBP + 0x8]
009ce903 : PUSH EAX
009ce904 : LEA ESI,[ESP + 0x70]
009ce908 : MOV dword ptr [ESP + 0x1c],ECX
009ce90c : MOV dword ptr [ESP + 0x18],EDI
009ce910 : CALL 0x00403dd0
009ce915 : ADD ESP,0x4
009ce918 : XOR EBX,EBX
009ce91a : MOV dword ptr [ESP + 0x98],EBX
009ce921 : PUSH 0x1
009ce923 : XOR EAX,EAX
009ce925 : MOV ESI,0x7
009ce92a : PUSH 0xc957b4
009ce92f : LEA ECX,[ESP + 0x3c]
009ce933 : MOV dword ptr [ESP + 0x54],ESI
009ce937 : MOV dword ptr [ESP + 0x50],EBX
009ce93b : MOV word ptr [ESP + 0x40],AX
009ce940 : CALL 0x00406360
009ce945 : MOV byte ptr [ESP + 0x98],0x1
009ce94d : CMP dword ptr [ESP + 0x84],0x8
009ce955 : MOV EDX,dword ptr [ESP + 0x70]
009ce959 : JNC 0x009ce95f
009ce95b : LEA EDX,[ESP + 0x70]
009ce95f : XOR ECX,ECX
009ce961 : MOV EAX,EDX
009ce963 : MOV dword ptr [ESP + 0x68],ESI
009ce967 : MOV dword ptr [ESP + 0x64],EBX
009ce96b : MOV word ptr [ESP + 0x54],CX
009ce970 : LEA ESI,[EAX + 0x2]
009ce973 : MOV CX,word ptr [EAX]
009ce976 : ADD EAX,0x2
009ce979 : CMP CX,BX
009ce97c : JNZ 0x009ce973
009ce97e : SUB EAX,ESI
009ce980 : SAR EAX,0x1
009ce982 : PUSH EAX
009ce983 : PUSH EDX
009ce984 : LEA ECX,[ESP + 0x58]
009ce988 : CALL 0x00406360
009ce98d : MOV byte ptr [ESP + 0x98],0x2
009ce995 : PUSH EBX
009ce996 : LEA EDX,[ESP + 0x38]
009ce99a : PUSH EDX
009ce99b : LEA EAX,[ESP + 0x58]
009ce99f : PUSH EAX
009ce9a0 : LEA ECX,[ESP + 0x2c]
009ce9a4 : PUSH ECX
009ce9a5 : CALL 0x0070cd60
009ce9aa : ADD ESP,0x10
009ce9ad : MOV byte ptr [ESP + 0x98],0x4
009ce9b5 : CMP dword ptr [ESP + 0x68],0x8
009ce9ba : JC 0x009ce9c5
009ce9bc : MOV ECX,dword ptr [ESP + 0x54]
009ce9c0 : CALL 0x006f04e0
009ce9c5 : MOV ESI,0x7
009ce9ca : XOR EDX,EDX
009ce9cc : MOV dword ptr [ESP + 0x68],ESI
009ce9d0 : MOV dword ptr [ESP + 0x64],EBX
009ce9d4 : MOV word ptr [ESP + 0x54],DX
009ce9d9 : MOV byte ptr [ESP + 0x98],0x5
009ce9e1 : CMP dword ptr [ESP + 0x4c],0x8
009ce9e6 : JC 0x009ce9f1
009ce9e8 : MOV ECX,dword ptr [ESP + 0x38]
009ce9ec : CALL 0x006f04e0
009ce9f1 : XOR EAX,EAX
009ce9f3 : CMP dword ptr [EDI + 0x18],0x8
009ce9f7 : MOV dword ptr [ESP + 0x4c],ESI
009ce9fb : MOV dword ptr [ESP + 0x48],EBX
009ce9ff : MOV word ptr [ESP + 0x38],AX
009cea04 : JC 0x009cea0b
009cea06 : MOV EAX,dword ptr [EDI + 0x4]
009cea09 : JMP 0x009cea0e
009cea0b : LEA EAX,[EDI + 0x4]
009cea0e : MOV ECX,0xc957b8
009cea13 : MOV DX,word ptr [EAX]
009cea16 : CMP DX,word ptr [ECX]
009cea19 : JNZ 0x009cea39
009cea1b : CMP DX,BX
009cea1e : JZ 0x009cea35
009cea20 : MOV DX,word ptr [EAX + 0x2]
009cea24 : CMP DX,word ptr [ECX + 0x2]
009cea28 : JNZ 0x009cea39
009cea2a : ADD EAX,0x4
009cea2d : ADD ECX,0x4
009cea30 : CMP DX,BX
009cea33 : JNZ 0x009cea13
009cea35 : XOR EAX,EAX
009cea37 : JMP 0x009cea3e
009cea39 : SBB EAX,EAX
009cea3b : SBB EAX,-0x1
009cea3e : CMP EAX,EBX
009cea40 : JNZ 0x009cea4c
009cea42 : CALL 0x009cd930
009cea47 : JMP 0x009cebf3
009cea4c : MOV ESI,dword ptr [ESP + 0x14]
009cea50 : MOV EAX,dword ptr [ESI + 0x14]
009cea53 : PUSH 0xc957c8
009cea58 : MOV EDI,0x8
009cea5d : MOV ECX,ESI
009cea5f : CALL 0x00405bb0
009cea64 : TEST EAX,EAX
009cea66 : JNZ 0x009cebd0
009cea6c : MOV ESI,dword ptr [ESP + 0x28]
009cea70 : MOV ECX,dword ptr [ESP + 0x24]
009cea74 : MOV EDI,ESI
009cea76 : SUB EDI,ECX
009cea78 : MOV EAX,0x92492493
009cea7d : IMUL EDI
009cea7f : ADD EDX,EDI
009cea81 : SAR EDX,0x4
009cea84 : MOV EAX,EDX
009cea86 : SHR EAX,0x1f
009cea89 : ADD EAX,EDX
009cea8b : JZ 0x009ceab5
009cea8d : CMP dword ptr [ECX + 0x18],0x8
009cea91 : JC 0x009cea98
009cea93 : MOV ECX,dword ptr [ECX + 0x4]
009cea96 : JMP 0x009cea9b
009cea98 : ADD ECX,0x4
009cea9b : PUSH ECX
009cea9c : CALL 0x00634f4d
009ceaa1 : MOV ESI,dword ptr [ESP + 0x2c]
009ceaa5 : MOVZX ECX,AX
009ceaa8 : MOV dword ptr [ESP + 0x18],ECX
009ceaac : MOV ECX,dword ptr [ESP + 0x28]
009ceab0 : ADD ESP,0x4
009ceab3 : JMP 0x009ceab9
009ceab5 : MOV dword ptr [ESP + 0x14],EBX
009ceab9 : SUB ESI,ECX
009ceabb : MOV EAX,0x92492493
009ceac0 : IMUL ESI
009ceac2 : ADD EDX,ESI
009ceac4 : SAR EDX,0x4
009ceac7 : MOV EAX,EDX
009ceac9 : SHR EAX,0x1f
009ceacc : ADD EAX,EDX
009ceace : CMP EAX,0x1
009cead1 : JBE 0x009ceae3
009cead3 : CMP dword ptr [ECX + 0x34],0x8
009cead7 : JC 0x009ceade
009cead9 : MOV EDI,dword ptr [ECX + 0x20]
009ceadc : JMP 0x009ceae8
009ceade : LEA EDI,[ECX + 0x20]
009ceae1 : JMP 0x009ceae8
009ceae3 : MOV EDI,0xc957dc
009ceae8 : MOV BL,0x6
009ceaea : CMP EAX,0x2
009ceaed : JBE 0x009ceb19
009ceaef : CMP dword ptr [ECX + 0x50],0x8
009ceaf3 : JC 0x009ceb07
009ceaf5 : MOV ECX,dword ptr [ECX + 0x3c]
009ceaf8 : PUSH ECX
009ceaf9 : CALL 0x00634f4d
009ceafe : ADD ESP,0x4
009ceb01 : MOV byte ptr [ESP + 0x1c],AL
009ceb05 : JMP 0x009ceb1d
009ceb07 : ADD ECX,0x3c
009ceb0a : PUSH ECX
009ceb0b : CALL 0x00634f4d
009ceb10 : ADD ESP,0x4
009ceb13 : MOV byte ptr [ESP + 0x1c],AL
009ceb17 : JMP 0x009ceb1d
009ceb19 : MOV byte ptr [ESP + 0x1c],BL
009ceb1d : CMP word ptr [EDI],0x0
009ceb21 : JNZ 0x009ceb48
009ceb23 : MOV EDX,dword ptr [0x00da9894]
009ceb29 : MOV EAX,dword ptr [EDX]
009ceb2b : MOV EAX,dword ptr [EAX + 0x1a8]
009ceb31 : PUSH 0x3
009ceb33 : PUSH EAX
009ceb34 : MOV ECX,0xc957e0
009ceb39 : CALL 0x009adfc0
009ceb3e : ADD ESP,0x8
009ceb41 : XOR EBX,EBX
009ceb43 : JMP 0x009cebf3
009ceb48 : MOV ECX,dword ptr [ESP + 0x18]
009ceb4c : MOV EDX,dword ptr FS:[0x2c]
009ceb53 : XOR EAX,EAX
009ceb55 : MOV word ptr [ECX + 0x38],AX
009ceb59 : MOV ECX,dword ptr [EDX]
009ceb5b : MOVZX EAX,byte ptr [ECX + 0x18]
009ceb5f : INC EAX
009ceb60 : CDQ
009ceb61 : MOV ESI,0x3
009ceb66 : IDIV ESI
009ceb68 : MOVZX EAX,DL
009ceb6b : SHL EAX,0xd
009ceb6e : LEA ESI,[EAX + ECX*0x1 + 0x122cb8]
009ceb75 : MOV byte ptr [ECX + 0x18],DL
009ceb78 : MOV dword ptr [ESP + 0x30],ESI
009ceb7c : MOV byte ptr [ESP + 0x98],BL
009ceb83 : TEST ESI,ESI
009ceb85 : JZ 0x009ceb9a
009ceb87 : MOV ECX,dword ptr [ESP + 0x1c]
009ceb8b : MOV EDX,dword ptr [ESP + 0x14]
009ceb8f : PUSH ECX
009ceb90 : PUSH EDX
009ceb91 : MOV ECX,EDI
009ceb93 : CALL 0x0041d050
009ceb98 : JMP 0x009ceb9c
009ceb9a : XOR EAX,EAX
009ceb9c : MOV byte ptr [ESP + 0x98],0x5
009ceba4 : MOV EDX,dword ptr [0x017247d4]
009cebaa : MOV ECX,dword ptr [EDX + 0x4]
009cebad : TEST ECX,ECX
009cebaf : JZ 0x009cebc1
009cebb1 : CMP byte ptr [EDX + 0x8],0x0
009cebb5 : JZ 0x009cebc1
009cebb7 : PUSH 0x57
009cebb9 : PUSH ECX
009cebba : MOV EDI,EAX
009cebbc : CALL 0x00a0dd40
009cebc1 : MOV ECX,dword ptr [ESP + 0x18]
009cebc5 : MOV EAX,dword ptr [ECX]
009cebc7 : MOV EDX,dword ptr [EAX + 0x20]
009cebca : CALL EDX
009cebcc : XOR EBX,EBX
009cebce : JMP 0x009cebf3
009cebd0 : MOV EAX,dword ptr [ESI + 0x14]
009cebd3 : PUSH 0xc95808
009cebd8 : MOV EDI,0x5
009cebdd : MOV ECX,ESI
009cebdf : CALL 0x00405bb0
009cebe4 : TEST EAX,EAX
009cebe6 : JNZ 0x009cebf3
009cebe8 : MOV ECX,dword ptr [ESP + 0x18]
009cebec : MOV EAX,dword ptr [ECX]
009cebee : MOV EDX,dword ptr [EAX + 0x20]
009cebf1 : CALL EDX
009cebf3 : MOV byte ptr [ESP + 0x98],0x0
009cebfb : MOV EAX,dword ptr [ESP + 0x24]
009cebff : CMP EAX,EBX
009cec01 : JZ 0x009cec1d
009cec03 : MOV ECX,dword ptr [ESP + 0x30]
009cec07 : MOV EDI,dword ptr [ESP + 0x28]
009cec0b : PUSH ECX
009cec0c : CALL 0x00405450
009cec11 : MOV ECX,dword ptr [ESP + 0x28]
009cec15 : ADD ESP,0x4
009cec18 : CALL 0x006f04e0
009cec1d : MOV dword ptr [ESP + 0x24],EBX
009cec21 : MOV dword ptr [ESP + 0x28],EBX
009cec25 : MOV dword ptr [ESP + 0x2c],EBX
009cec29 : MOV dword ptr [ESP + 0x98],0xffffffff
009cec34 : CMP dword ptr [ESP + 0x84],0x8
009cec3c : JC 0x009cec47
009cec3e : MOV ECX,dword ptr [ESP + 0x70]
009cec42 : CALL 0x006f04e0
009cec47 : XOR EDX,EDX
009cec49 : MOV dword ptr [ESP + 0x84],0x7
009cec54 : MOV dword ptr [ESP + 0x80],EBX
009cec5b : MOV word ptr [ESP + 0x70],DX
009cec60 : MOV ECX,dword ptr [ESP + 0x90]
009cec67 : MOV dword ptr FS:[0x0],ECX
009cec6e : POP ECX
009cec6f : POP EDI
009cec70 : POP ESI
009cec71 : POP EBX
009cec72 : MOV ECX,dword ptr [ESP + 0x78]
009cec76 : XOR ECX,ESP
009cec78 : CALL 0x00633e6b
009cec7d : MOV ESP,EBP
009cec7f : POP EBP
009cec80 : RET 0x8

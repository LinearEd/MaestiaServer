PROGRAM  : Maestia.exe
FUNCTION : FUN_007dfca0
ENTRY    : 007dfca0
BODY     : [[007dfca0, 007dfed8] [007dfee0, 007e0039]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_007dfca0(int param_1,undefined4 param_2)

{
  int *piVar1;
  undefined4 *puVar2;
  int iVar3;
  size_t _NumOfElements;
  int *piVar4;
  int local_1008 [1024];
  undefined4 *local_8;
  
  local_8 = (undefined4 *)0x7dfcad;
  piVar1 = *(int **)(DAT_017251ac + 0x18);
  (**(code **)(*piVar1 + 0x170))(piVar1,0);
  (**(code **)(**(int **)(DAT_017251ac + 0x18) + 0x1ac))(*(int **)(DAT_017251ac + 0x18),0);
  (**(code **)(**(int **)(DAT_017251ac + 0x18) + 0x164))(*(int **)(DAT_017251ac + 0x18),2);
  (**(code **)(*piVar1 + 0xe4))(piVar1,0x1c,1);
  (**(code **)(*piVar1 + 0x114))(piVar1,0,6,2);
  (**(code **)(*piVar1 + 0x114))(piVar1,0,5,2);
  (**(code **)(*piVar1 + 0x114))(piVar1,1,6,2);
  (**(code **)(*piVar1 + 0x114))(piVar1,1,5,2);
  (**(code **)(*piVar1 + 0x114))(piVar1,0,1,3);
  (**(code **)(*piVar1 + 0x114))(piVar1,0,2,3);
  (**(code **)(*piVar1 + 0x114))(piVar1,0,3,3);
  (**(code **)(*piVar1 + 0x114))(piVar1,1,1,3);
  (**(code **)(*piVar1 + 0x114))(piVar1,1,2,3);
  (**(code **)(*piVar1 + 0x114))(piVar1,1,3,3);
  (**(code **)(*piVar1 + 0x10c))(piVar1,0,1,4);
  (**(code **)(*piVar1 + 0x10c))(piVar1,0,2,2);
  (**(code **)(*piVar1 + 0x10c))(piVar1,0,3,1);
  (**(code **)(*piVar1 + 0x10c))(piVar1,0,4,4);
  (**(code **)(*piVar1 + 0x10c))(piVar1,0,5,2);
  (**(code **)(*piVar1 + 0x10c))(piVar1,0,6,1);
  (**(code **)(*piVar1 + 0x10c))(piVar1,1,1,4);
  (**(code **)(*piVar1 + 0x10c))(piVar1,1,2,2);
  (**(code **)(*piVar1 + 0x10c))(piVar1,1,3,1);
  (**(code **)(*piVar1 + 0x10c))(piVar1,1,4,4);
  (**(code **)(*piVar1 + 0x10c))(piVar1,1,5,2);
  (**(code **)(*piVar1 + 0x10c))(piVar1,1,6,1);
  (**(code **)(*piVar1 + 0x164))(piVar1,&DAT_01000552);
  puVar2 = *(undefined4 **)(param_1 + 0x6c);
  local_8 = (undefined4 *)*puVar2;
  _NumOfElements = 0;
  while (local_8 != puVar2) {
    if (local_8[3] == 0) {
      iVar3 = 0;
    }
    else {
      iVar3 = local_8[3] + -0x38;
    }
    local_1008[_NumOfElements] = iVar3;
    _NumOfElements = _NumOfElements + 1;
    FUN_0045d060();
  }
  _qsort(local_1008,_NumOfElements,4,FUN_007dfa50);
  iVar3 = 0;
  if (0 < (int)_NumOfElements) {
    do {
      (**(code **)(*(int *)(local_1008[iVar3] + 0x38) + 0x28))(param_2);
      iVar3 = iVar3 + 1;
    } while (iVar3 < (int)_NumOfElements);
  }
  if ((*(char *)(param_1 + 0x2ab4) != '\0') && (iVar3 = 0, 0 < (int)_NumOfElements)) {
    do {
      (**(code **)(*(int *)(local_1008[iVar3] + 0x38) + 0x44))();
      iVar3 = iVar3 + 1;
    } while (iVar3 < (int)_NumOfElements);
  }
  if ((*(int *)(param_1 + 0x2ad0) != 0) || (*(int *)(param_1 + 0x2adc) != 0)) {
    (**(code **)(*piVar1 + 0xe4))(piVar1,7,0);
    (**(code **)(*piVar1 + 0xe4))(piVar1,0x13,5);
    (**(code **)(*piVar1 + 0xe4))(piVar1,0x14,6);
    (**(code **)(*piVar1 + 0xe4))(piVar1,0x1b,1);
    (**(code **)(*piVar1 + 0x10c))(piVar1,0,4,4);
    (**(code **)(*piVar1 + 0x10c))(piVar1,0,5,2);
    (**(code **)(*piVar1 + 0x10c))(piVar1,0,6,3);
    (**(code **)(*piVar1 + 0x164))(piVar1,0x102);
    piVar4 = (int *)**(int **)(param_1 + 0x2acc);
    if (piVar4 != *(int **)(param_1 + 0x2acc)) {
      do {
        (**(code **)(*(int *)piVar4[2] + 8))();
        piVar4 = (int *)*piVar4;
      } while (piVar4 != (int *)*(int *)(param_1 + 0x2acc));
    }
    piVar4 = (int *)**(int **)(param_1 + 0x2ad8);
    if (piVar4 != *(int **)(param_1 + 0x2ad8)) {
      do {
        (**(code **)(*(int *)piVar4[2] + 8))();
        piVar4 = (int *)*piVar4;
      } while (piVar4 != (int *)*(int *)(param_1 + 0x2ad8));
    }
    (**(code **)(*piVar1 + 0xe4))(piVar1,0x1b,0);
    (**(code **)(*piVar1 + 0xe4))(piVar1,7,1);
  }
  (**(code **)(*piVar1 + 0xe4))(piVar1,0x1c,0);
  return;
}



============================================================
DISASSEMBLY
============================================================
007dfca0 : PUSH EBP
007dfca1 : MOV EBP,ESP
007dfca3 : MOV EAX,0x1004
007dfca8 : CALL 0x0063b780
007dfcad : MOV EAX,[0x017251ac]
007dfcb2 : PUSH EBX
007dfcb3 : PUSH ESI
007dfcb4 : MOV ESI,dword ptr [EAX + 0x18]
007dfcb7 : MOV ECX,dword ptr [ESI]
007dfcb9 : MOV EDX,dword ptr [ECX + 0x170]
007dfcbf : PUSH EDI
007dfcc0 : PUSH 0x0
007dfcc2 : PUSH ESI
007dfcc3 : CALL EDX
007dfcc5 : MOV EAX,[0x017251ac]
007dfcca : MOV EAX,dword ptr [EAX + 0x18]
007dfccd : MOV ECX,dword ptr [EAX]
007dfccf : MOV EDX,dword ptr [ECX + 0x1ac]
007dfcd5 : PUSH 0x0
007dfcd7 : PUSH EAX
007dfcd8 : CALL EDX
007dfcda : MOV EAX,[0x017251ac]
007dfcdf : MOV EAX,dword ptr [EAX + 0x18]
007dfce2 : MOV ECX,dword ptr [EAX]
007dfce4 : MOV EDX,dword ptr [ECX + 0x164]
007dfcea : PUSH 0x2
007dfcec : PUSH EAX
007dfced : CALL EDX
007dfcef : MOV EAX,dword ptr [ESI]
007dfcf1 : MOV ECX,dword ptr [EAX + 0xe4]
007dfcf7 : PUSH 0x1
007dfcf9 : PUSH 0x1c
007dfcfb : PUSH ESI
007dfcfc : CALL ECX
007dfcfe : MOV EDX,dword ptr [ESI]
007dfd00 : MOV EAX,dword ptr [EDX + 0x114]
007dfd06 : PUSH 0x2
007dfd08 : PUSH 0x6
007dfd0a : PUSH 0x0
007dfd0c : PUSH ESI
007dfd0d : CALL EAX
007dfd0f : MOV ECX,dword ptr [ESI]
007dfd11 : MOV EDX,dword ptr [ECX + 0x114]
007dfd17 : PUSH 0x2
007dfd19 : PUSH 0x5
007dfd1b : PUSH 0x0
007dfd1d : PUSH ESI
007dfd1e : CALL EDX
007dfd20 : MOV EAX,dword ptr [ESI]
007dfd22 : MOV ECX,dword ptr [EAX + 0x114]
007dfd28 : PUSH 0x2
007dfd2a : PUSH 0x6
007dfd2c : PUSH 0x1
007dfd2e : PUSH ESI
007dfd2f : CALL ECX
007dfd31 : MOV EDX,dword ptr [ESI]
007dfd33 : MOV EAX,dword ptr [EDX + 0x114]
007dfd39 : PUSH 0x2
007dfd3b : PUSH 0x5
007dfd3d : PUSH 0x1
007dfd3f : PUSH ESI
007dfd40 : CALL EAX
007dfd42 : MOV ECX,dword ptr [ESI]
007dfd44 : MOV EDX,dword ptr [ECX + 0x114]
007dfd4a : PUSH 0x3
007dfd4c : PUSH 0x1
007dfd4e : PUSH 0x0
007dfd50 : PUSH ESI
007dfd51 : CALL EDX
007dfd53 : MOV EAX,dword ptr [ESI]
007dfd55 : MOV ECX,dword ptr [EAX + 0x114]
007dfd5b : PUSH 0x3
007dfd5d : PUSH 0x2
007dfd5f : PUSH 0x0
007dfd61 : PUSH ESI
007dfd62 : CALL ECX
007dfd64 : MOV EDX,dword ptr [ESI]
007dfd66 : MOV EAX,dword ptr [EDX + 0x114]
007dfd6c : PUSH 0x3
007dfd6e : PUSH 0x3
007dfd70 : PUSH 0x0
007dfd72 : PUSH ESI
007dfd73 : CALL EAX
007dfd75 : MOV ECX,dword ptr [ESI]
007dfd77 : MOV EDX,dword ptr [ECX + 0x114]
007dfd7d : PUSH 0x3
007dfd7f : PUSH 0x1
007dfd81 : PUSH 0x1
007dfd83 : PUSH ESI
007dfd84 : CALL EDX
007dfd86 : MOV EAX,dword ptr [ESI]
007dfd88 : MOV ECX,dword ptr [EAX + 0x114]
007dfd8e : PUSH 0x3
007dfd90 : PUSH 0x2
007dfd92 : PUSH 0x1
007dfd94 : PUSH ESI
007dfd95 : CALL ECX
007dfd97 : MOV EDX,dword ptr [ESI]
007dfd99 : MOV EAX,dword ptr [EDX + 0x114]
007dfd9f : PUSH 0x3
007dfda1 : PUSH 0x3
007dfda3 : PUSH 0x1
007dfda5 : PUSH ESI
007dfda6 : CALL EAX
007dfda8 : MOV ECX,dword ptr [ESI]
007dfdaa : MOV EDX,dword ptr [ECX + 0x10c]
007dfdb0 : PUSH 0x4
007dfdb2 : PUSH 0x1
007dfdb4 : PUSH 0x0
007dfdb6 : PUSH ESI
007dfdb7 : CALL EDX
007dfdb9 : MOV EAX,dword ptr [ESI]
007dfdbb : MOV ECX,dword ptr [EAX + 0x10c]
007dfdc1 : PUSH 0x2
007dfdc3 : PUSH 0x2
007dfdc5 : PUSH 0x0
007dfdc7 : PUSH ESI
007dfdc8 : CALL ECX
007dfdca : MOV EDX,dword ptr [ESI]
007dfdcc : MOV EAX,dword ptr [EDX + 0x10c]
007dfdd2 : PUSH 0x1
007dfdd4 : PUSH 0x3
007dfdd6 : PUSH 0x0
007dfdd8 : PUSH ESI
007dfdd9 : CALL EAX
007dfddb : MOV ECX,dword ptr [ESI]
007dfddd : MOV EDX,dword ptr [ECX + 0x10c]
007dfde3 : PUSH 0x4
007dfde5 : PUSH 0x4
007dfde7 : PUSH 0x0
007dfde9 : PUSH ESI
007dfdea : CALL EDX
007dfdec : MOV EAX,dword ptr [ESI]
007dfdee : MOV ECX,dword ptr [EAX + 0x10c]
007dfdf4 : PUSH 0x2
007dfdf6 : PUSH 0x5
007dfdf8 : PUSH 0x0
007dfdfa : PUSH ESI
007dfdfb : CALL ECX
007dfdfd : MOV EDX,dword ptr [ESI]
007dfdff : MOV EAX,dword ptr [EDX + 0x10c]
007dfe05 : PUSH 0x1
007dfe07 : PUSH 0x6
007dfe09 : PUSH 0x0
007dfe0b : PUSH ESI
007dfe0c : CALL EAX
007dfe0e : MOV ECX,dword ptr [ESI]
007dfe10 : MOV EDX,dword ptr [ECX + 0x10c]
007dfe16 : PUSH 0x4
007dfe18 : PUSH 0x1
007dfe1a : PUSH 0x1
007dfe1c : PUSH ESI
007dfe1d : CALL EDX
007dfe1f : MOV EAX,dword ptr [ESI]
007dfe21 : MOV ECX,dword ptr [EAX + 0x10c]
007dfe27 : PUSH 0x2
007dfe29 : PUSH 0x2
007dfe2b : PUSH 0x1
007dfe2d : PUSH ESI
007dfe2e : CALL ECX
007dfe30 : MOV EDX,dword ptr [ESI]
007dfe32 : PUSH 0x1
007dfe34 : PUSH 0x3
007dfe36 : PUSH 0x1
007dfe38 : MOV EAX,dword ptr [EDX + 0x10c]
007dfe3e : PUSH ESI
007dfe3f : CALL EAX
007dfe41 : MOV ECX,dword ptr [ESI]
007dfe43 : MOV EDX,dword ptr [ECX + 0x10c]
007dfe49 : PUSH 0x4
007dfe4b : PUSH 0x4
007dfe4d : PUSH 0x1
007dfe4f : PUSH ESI
007dfe50 : CALL EDX
007dfe52 : MOV EAX,dword ptr [ESI]
007dfe54 : MOV ECX,dword ptr [EAX + 0x10c]
007dfe5a : PUSH 0x2
007dfe5c : PUSH 0x5
007dfe5e : PUSH 0x1
007dfe60 : PUSH ESI
007dfe61 : CALL ECX
007dfe63 : MOV EDX,dword ptr [ESI]
007dfe65 : MOV EAX,dword ptr [EDX + 0x10c]
007dfe6b : PUSH 0x1
007dfe6d : PUSH 0x6
007dfe6f : PUSH 0x1
007dfe71 : PUSH ESI
007dfe72 : CALL EAX
007dfe74 : MOV ECX,dword ptr [ESI]
007dfe76 : MOV EDX,dword ptr [ECX + 0x164]
007dfe7c : PUSH 0x1000552
007dfe81 : PUSH ESI
007dfe82 : CALL EDX
007dfe84 : MOV EAX,dword ptr [EBP + 0x8]
007dfe87 : MOV EBX,dword ptr [EAX + 0x6c]
007dfe8a : MOV EAX,dword ptr [EBX]
007dfe8c : XOR EDI,EDI
007dfe8e : MOV dword ptr [EBP + -0x4],EAX
007dfe91 : CMP EAX,EBX
007dfe93 : JZ 0x007dfeba
007dfe95 : MOV EAX,dword ptr [EAX + 0xc]
007dfe98 : TEST EAX,EAX
007dfe9a : JZ 0x007dfea1
007dfe9c : ADD EAX,-0x38
007dfe9f : JMP 0x007dfea3
007dfea1 : XOR EAX,EAX
007dfea3 : MOV dword ptr [EBP + EDI*0x4 + 0xffffeffc],EAX
007dfeaa : LEA EDX,[EBP + -0x4]
007dfead : INC EDI
007dfeae : CALL 0x0045d060
007dfeb3 : MOV EAX,dword ptr [EBP + -0x4]
007dfeb6 : CMP EAX,EBX
007dfeb8 : JNZ 0x007dfe95
007dfeba : PUSH 0x7dfa50
007dfebf : PUSH 0x4
007dfec1 : LEA ECX,[EBP + 0xffffeffc]
007dfec7 : PUSH EDI
007dfec8 : PUSH ECX
007dfec9 : CALL 0x00635ad0
007dfece : ADD ESP,0x10
007dfed1 : XOR EBX,EBX
007dfed3 : TEST EDI,EDI
007dfed5 : JLE 0x007dfefb
007dfed7 : JMP 0x007dfee0
007dfee0 : MOV EAX,dword ptr [EBP + EBX*0x4 + 0xffffeffc]
007dfee7 : MOV EDX,dword ptr [EAX + 0x38]
007dfeea : MOV EDX,dword ptr [EDX + 0x28]
007dfeed : LEA ECX,[EAX + 0x38]
007dfef0 : MOV EAX,dword ptr [EBP + 0xc]
007dfef3 : PUSH EAX
007dfef4 : CALL EDX
007dfef6 : INC EBX
007dfef7 : CMP EBX,EDI
007dfef9 : JL 0x007dfee0
007dfefb : MOV EAX,dword ptr [EBP + 0x8]
007dfefe : CMP byte ptr [EAX + 0x2ab4],0x0
007dff05 : JZ 0x007dff29
007dff07 : XOR EBX,EBX
007dff09 : TEST EDI,EDI
007dff0b : JLE 0x007dff29
007dff0d : LEA ECX,[ECX]
007dff10 : MOV EAX,dword ptr [EBP + EBX*0x4 + 0xffffeffc]
007dff17 : LEA ECX,[EAX + 0x38]
007dff1a : MOV EAX,dword ptr [ECX]
007dff1c : MOV EDX,dword ptr [EAX + 0x44]
007dff1f : CALL EDX
007dff21 : INC EBX
007dff22 : CMP EBX,EDI
007dff24 : JL 0x007dff10
007dff26 : MOV EAX,dword ptr [EBP + 0x8]
007dff29 : CMP dword ptr [EAX + 0x2ad0],0x0
007dff30 : JNZ 0x007dff3f
007dff32 : CMP dword ptr [EAX + 0x2adc],0x0
007dff39 : JZ 0x007e0022
007dff3f : MOV EAX,dword ptr [ESI]
007dff41 : MOV ECX,dword ptr [EAX + 0xe4]
007dff47 : PUSH 0x0
007dff49 : PUSH 0x7
007dff4b : PUSH ESI
007dff4c : CALL ECX
007dff4e : MOV EDX,dword ptr [ESI]
007dff50 : MOV EAX,dword ptr [EDX + 0xe4]
007dff56 : PUSH 0x5
007dff58 : PUSH 0x13
007dff5a : PUSH ESI
007dff5b : CALL EAX
007dff5d : MOV ECX,dword ptr [ESI]
007dff5f : MOV EDX,dword ptr [ECX + 0xe4]
007dff65 : PUSH 0x6
007dff67 : PUSH 0x14
007dff69 : PUSH ESI
007dff6a : CALL EDX
007dff6c : MOV EAX,dword ptr [ESI]
007dff6e : MOV ECX,dword ptr [EAX + 0xe4]
007dff74 : PUSH 0x1
007dff76 : PUSH 0x1b
007dff78 : PUSH ESI
007dff79 : CALL ECX
007dff7b : MOV EDX,dword ptr [ESI]
007dff7d : MOV EAX,dword ptr [EDX + 0x10c]
007dff83 : PUSH 0x4
007dff85 : PUSH 0x4
007dff87 : PUSH 0x0
007dff89 : PUSH ESI
007dff8a : CALL EAX
007dff8c : MOV ECX,dword ptr [ESI]
007dff8e : MOV EDX,dword ptr [ECX + 0x10c]
007dff94 : PUSH 0x2
007dff96 : PUSH 0x5
007dff98 : PUSH 0x0
007dff9a : PUSH ESI
007dff9b : CALL EDX
007dff9d : MOV EAX,dword ptr [ESI]
007dff9f : MOV ECX,dword ptr [EAX + 0x10c]
007dffa5 : PUSH 0x3
007dffa7 : PUSH 0x6
007dffa9 : PUSH 0x0
007dffab : PUSH ESI
007dffac : CALL ECX
007dffae : MOV EDX,dword ptr [ESI]
007dffb0 : MOV EAX,dword ptr [EDX + 0x164]
007dffb6 : PUSH 0x102
007dffbb : PUSH ESI
007dffbc : CALL EAX
007dffbe : MOV EBX,dword ptr [EBP + 0x8]
007dffc1 : MOV EAX,dword ptr [EBX + 0x2acc]
007dffc7 : MOV EDI,dword ptr [EAX]
007dffc9 : CMP EDI,EAX
007dffcb : JZ 0x007dffe4
007dffcd : LEA ECX,[ECX]
007dffd0 : MOV ECX,dword ptr [EDI + 0x8]
007dffd3 : MOV EDX,dword ptr [ECX]
007dffd5 : MOV EAX,dword ptr [EDX + 0x8]
007dffd8 : CALL EAX
007dffda : MOV EDI,dword ptr [EDI]
007dffdc : CMP EDI,dword ptr [EBX + 0x2acc]
007dffe2 : JNZ 0x007dffd0
007dffe4 : MOV EAX,dword ptr [EBX + 0x2ad8]
007dffea : MOV EDI,dword ptr [EAX]
007dffec : CMP EDI,EAX
007dffee : JZ 0x007e0004
007dfff0 : MOV ECX,dword ptr [EDI + 0x8]
007dfff3 : MOV EDX,dword ptr [ECX]
007dfff5 : MOV EAX,dword ptr [EDX + 0x8]
007dfff8 : CALL EAX
007dfffa : MOV EDI,dword ptr [EDI]
007dfffc : CMP EDI,dword ptr [EBX + 0x2ad8]
007e0002 : JNZ 0x007dfff0
007e0004 : MOV ECX,dword ptr [ESI]
007e0006 : MOV EDX,dword ptr [ECX + 0xe4]
007e000c : PUSH 0x0
007e000e : PUSH 0x1b
007e0010 : PUSH ESI
007e0011 : CALL EDX
007e0013 : MOV EAX,dword ptr [ESI]
007e0015 : MOV ECX,dword ptr [EAX + 0xe4]
007e001b : PUSH 0x1
007e001d : PUSH 0x7
007e001f : PUSH ESI
007e0020 : CALL ECX
007e0022 : MOV EDX,dword ptr [ESI]
007e0024 : MOV EAX,dword ptr [EDX + 0xe4]
007e002a : PUSH 0x0
007e002c : PUSH 0x1c
007e002e : PUSH ESI
007e002f : CALL EAX
007e0031 : POP EDI
007e0032 : POP ESI
007e0033 : POP EBX
007e0034 : MOV ESP,EBP
007e0036 : POP EBP
007e0037 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_006b0dc0
ENTRY    : 006b0dc0
BODY     : [[006b0dc0, 006b118e]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006b0dc0(int param_1)

{
  byte bVar1;
  int *piVar2;
  uint uVar3;
  undefined4 uVar4;
  byte *pbVar5;
  int iVar6;
  char *pcVar7;
  byte *pbVar8;
  byte *pbVar9;
  int iVar10;
  undefined4 *puVar11;
  bool bVar12;
  int local_18c;
  int local_188;
  int local_184;
  int local_180;
  byte *local_17c;
  undefined1 local_178 [96];
  undefined4 local_118;
  int local_104;
  int local_fc;
  undefined4 local_e0;
  undefined4 local_dc;
  undefined4 local_c4;
  undefined4 local_a8;
  int local_9c;
  undefined4 local_90;
  undefined4 local_8c;
  undefined4 local_40;
  undefined4 local_3c;
  int local_30;
  undefined4 local_24;
  undefined4 local_20;
  
  uVar4 = *(undefined4 *)(param_1 + 0x1e4);
  FUN_006b0cf0();
  *(undefined4 *)(param_1 + 0x214) = 0xffffffff;
  *(undefined4 *)(param_1 + 0x218) = 0xffffffff;
  *(undefined4 *)(param_1 + 0x21c) = 0;
  *(undefined4 *)(param_1 + 0x114) = 7;
  *(undefined4 *)(param_1 + 0x118) = 1;
  *(undefined4 *)(param_1 + 0xa8) = 4;
  *(undefined4 *)(param_1 + 0x158) = 0xf5c;
  *(undefined4 *)(param_1 + 0x110) = 0x27a000;
  local_188 = FUN_006ae6d0(*(undefined4 *)(param_1 + 100));
  if ((((local_188 != 0) || (local_188 = FUN_006b0940(param_1,local_178), local_188 != 0)) ||
      (local_188 = FUN_006ae870(uVar4), local_188 != 0)) ||
     (local_188 = FUN_006b0940(param_1,local_178), local_188 != 0)) goto LAB_006b1177;
  *(byte *)(param_1 + 0xac) = *(byte *)(param_1 + 0xac) & 0xfe;
  iVar10 = *(int *)(param_1 + 0x210);
  if (((iVar10 != 0) && (*(int *)(iVar10 + 0x1a0) != 0)) &&
     (*(int *)(iVar10 + 0x1a0) != *(int *)(iVar10 + 4))) {
    *(undefined4 *)(iVar10 + 0x1a0) = 0;
  }
  piVar2 = *(int **)(param_1 + 0x210);
  if ((piVar2 != (int *)0x0) && ((*piVar2 == 0 || (piVar2[1] == 0)))) {
    FUN_006af390(param_1);
  }
  iVar10 = *(int *)(param_1 + 0x210);
  if ((iVar10 != 0) && (uVar3 = 0, *(int *)(iVar10 + 4) != 0)) {
    pcVar7 = (char *)(iVar10 + 0x58);
    do {
      if (*pcVar7 == '\0') {
        FUN_006af390(param_1);
        break;
      }
      uVar3 = uVar3 + 1;
      pcVar7 = pcVar7 + 0xc;
    } while (uVar3 < *(uint *)(*(int *)(param_1 + 0x210) + 4));
  }
  if ((*(int *)(param_1 + 0x210) != 0) && (*(int *)(param_1 + 0x21c) != 0)) {
    uVar4 = FUN_0068a220(*(undefined4 *)(param_1 + 100),4,0,*(int *)(param_1 + 0x21c),0,&local_188);
    *(undefined4 *)(param_1 + 0x220) = uVar4;
    if (local_188 != 0) {
      *(undefined4 *)(param_1 + 0x21c) = 0;
      goto LAB_006b1177;
    }
  }
  *(undefined4 *)(param_1 + 0x19c) = local_e0;
  if (local_30 != 0) {
    *(undefined4 *)(param_1 + 400) = local_40;
    local_30 = 0;
    *(undefined4 *)(param_1 + 0x184) = local_3c;
    *(undefined4 *)(param_1 + 0x194) = local_24;
    *(undefined4 *)(param_1 + 0x198) = local_20;
  }
  if (local_9c == 0) {
    local_188 = 3;
  }
  *(undefined4 *)(param_1 + 0x188) = local_a8;
  *(undefined4 *)(param_1 + 0x1a4) = local_90;
  local_9c = 0;
  *(undefined4 *)(param_1 + 0x1a8) = local_8c;
  *(undefined4 *)(param_1 + 0x18c) = local_dc;
  *(undefined4 *)(param_1 + 0x1a0) = local_c4;
  local_dc = 0;
  local_c4 = 0;
  if (*(int *)(param_1 + 0x16c) != 1) goto LAB_006b1177;
  local_184 = 32000;
  local_180 = -32000;
  local_18c = 0;
  if (0 < local_104) {
LAB_006b1040:
    *(undefined2 *)(*(int *)(param_1 + 0x17c) + local_18c * 2) = 0;
    *(char **)(*(int *)(param_1 + 0x180) + local_18c * 4) = ".notdef";
    local_17c = *(byte **)(local_fc + local_18c * 4);
    if ((local_17c != (byte *)0x0) && (iVar10 = 0, 0 < *(int *)(param_1 + 0x19c))) {
      puVar11 = *(undefined4 **)(param_1 + 0x1a0);
      do {
        pbVar9 = (byte *)*puVar11;
        pbVar5 = local_17c;
        pbVar8 = pbVar9;
        do {
          bVar1 = *pbVar5;
          bVar12 = bVar1 < *pbVar8;
          if (bVar1 != *pbVar8) {
LAB_006b10b0:
            iVar6 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
            goto LAB_006b10b5;
          }
          if (bVar1 == 0) break;
          bVar1 = pbVar5[1];
          bVar12 = bVar1 < pbVar8[1];
          if (bVar1 != pbVar8[1]) goto LAB_006b10b0;
          pbVar5 = pbVar5 + 2;
          pbVar8 = pbVar8 + 2;
        } while (bVar1 != 0);
        iVar6 = 0;
LAB_006b10b5:
        if (iVar6 == 0) {
          *(short *)(*(int *)(param_1 + 0x17c) + local_18c * 2) = (short)iVar10;
          *(byte **)(*(int *)(param_1 + 0x180) + local_18c * 4) = pbVar9;
          pcVar7 = ".notdef";
          goto LAB_006b10e5;
        }
        iVar10 = iVar10 + 1;
        puVar11 = puVar11 + 1;
      } while (iVar10 < *(int *)(param_1 + 0x19c));
    }
    goto LAB_006b1130;
  }
LAB_006b114e:
  local_184 = 0;
  local_180 = local_104;
LAB_006b1156:
  *(int *)(param_1 + 0x174) = local_184;
  *(int *)(param_1 + 0x178) = local_180;
  *(undefined4 *)(param_1 + 0x170) = local_118;
LAB_006b1177:
  FUN_006b0d40();
  return local_188;
  while( true ) {
    bVar1 = ((byte *)pcVar7)[1];
    bVar12 = bVar1 < pbVar9[1];
    if (bVar1 != pbVar9[1]) goto LAB_006b1105;
    pcVar7 = (char *)((byte *)pcVar7 + 2);
    pbVar9 = pbVar9 + 2;
    if (bVar1 == 0) break;
LAB_006b10e5:
    bVar1 = *pcVar7;
    bVar12 = bVar1 < *pbVar9;
    if (bVar1 != *pbVar9) {
LAB_006b1105:
      iVar10 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
      goto LAB_006b110a;
    }
    if (bVar1 == 0) break;
  }
  iVar10 = 0;
LAB_006b110a:
  if (iVar10 != 0) {
    if (local_18c < local_184) {
      local_184 = local_18c;
    }
    if (local_180 < local_18c) {
      local_180 = local_18c;
    }
  }
LAB_006b1130:
  local_18c = local_18c + 1;
  if (local_104 <= local_18c) goto code_r0x006b1144;
  goto LAB_006b1040;
code_r0x006b1144:
  if (local_180 < local_184) goto LAB_006b114e;
  goto LAB_006b1156;
}



============================================================
DISASSEMBLY
============================================================
006b0dc0 : SUB ESP,0x18c
006b0dc6 : PUSH EBX
006b0dc7 : PUSH EBP
006b0dc8 : MOV EBP,dword ptr [ESP + 0x198]
006b0dcf : MOV EBX,dword ptr [EBP + 0x1e4]
006b0dd5 : PUSH ESI
006b0dd6 : PUSH EDI
006b0dd7 : LEA ESI,[ESP + 0x24]
006b0ddb : CALL 0x006b0cf0
006b0de0 : OR EAX,0xffffffff
006b0de3 : MOV dword ptr [EBP + 0x214],EAX
006b0de9 : MOV dword ptr [EBP + 0x218],EAX
006b0def : XOR ESI,ESI
006b0df1 : MOV dword ptr [EBP + 0x21c],ESI
006b0df7 : MOV dword ptr [EBP + 0x114],0x7
006b0e01 : MOV dword ptr [EBP + 0x118],0x1
006b0e0b : MOV dword ptr [EBP + 0xa8],0x4
006b0e15 : MOV dword ptr [EBP + 0x158],0xf5c
006b0e1f : MOV dword ptr [EBP + 0x110],0x27a000
006b0e29 : MOV EAX,dword ptr [EBP + 0x64]
006b0e2c : MOV ECX,dword ptr [EBP + 0x68]
006b0e2f : PUSH EAX
006b0e30 : MOV EAX,EBX
006b0e32 : LEA EDI,[ESP + 0x28]
006b0e36 : CALL 0x006ae6d0
006b0e3b : ADD ESP,0x4
006b0e3e : MOV dword ptr [ESP + 0x14],EAX
006b0e42 : CMP EAX,ESI
006b0e44 : JNZ 0x006b1177
006b0e4a : MOV EDX,dword ptr [ESP + 0x74]
006b0e4e : MOV EAX,dword ptr [ESP + 0x70]
006b0e52 : MOV ECX,EDI
006b0e54 : PUSH ECX
006b0e55 : PUSH EBP
006b0e56 : CALL 0x006b0940
006b0e5b : ADD ESP,0x8
006b0e5e : MOV dword ptr [ESP + 0x14],EAX
006b0e62 : CMP EAX,ESI
006b0e64 : JNZ 0x006b1177
006b0e6a : PUSH EBX
006b0e6b : CALL 0x006ae870
006b0e70 : ADD ESP,0x4
006b0e73 : MOV dword ptr [ESP + 0x14],EAX
006b0e77 : CMP EAX,ESI
006b0e79 : JNZ 0x006b1177
006b0e7f : MOV EAX,dword ptr [ESP + 0x78]
006b0e83 : MOV EDX,EDI
006b0e85 : PUSH EDX
006b0e86 : MOV EDX,dword ptr [ESP + 0x80]
006b0e8d : PUSH EBP
006b0e8e : CALL 0x006b0940
006b0e93 : ADD ESP,0x8
006b0e96 : MOV dword ptr [ESP + 0x14],EAX
006b0e9a : CMP EAX,ESI
006b0e9c : JNZ 0x006b1177
006b0ea2 : AND byte ptr [EBP + 0xac],0xfe
006b0ea9 : MOV EAX,dword ptr [EBP + 0x210]
006b0eaf : CMP EAX,ESI
006b0eb1 : JZ 0x006b0ec8
006b0eb3 : MOV ECX,dword ptr [EAX + 0x1a0]
006b0eb9 : CMP ECX,ESI
006b0ebb : JZ 0x006b0ec8
006b0ebd : CMP ECX,dword ptr [EAX + 0x4]
006b0ec0 : JZ 0x006b0ec8
006b0ec2 : MOV dword ptr [EAX + 0x1a0],ESI
006b0ec8 : MOV EAX,dword ptr [EBP + 0x210]
006b0ece : CMP EAX,ESI
006b0ed0 : JZ 0x006b0ee4
006b0ed2 : CMP dword ptr [EAX],ESI
006b0ed4 : JZ 0x006b0edb
006b0ed6 : CMP dword ptr [EAX + 0x4],ESI
006b0ed9 : JNZ 0x006b0ee4
006b0edb : PUSH EBP
006b0edc : CALL 0x006af390
006b0ee1 : ADD ESP,0x4
006b0ee4 : MOV ECX,dword ptr [EBP + 0x210]
006b0eea : CMP ECX,ESI
006b0eec : JZ 0x006b0f17
006b0eee : XOR EAX,EAX
006b0ef0 : CMP dword ptr [ECX + 0x4],ESI
006b0ef3 : JBE 0x006b0f17
006b0ef5 : ADD ECX,0x58
006b0ef8 : CMP byte ptr [ECX],0x0
006b0efb : JZ 0x006b0f0e
006b0efd : MOV EDX,dword ptr [EBP + 0x210]
006b0f03 : INC EAX
006b0f04 : ADD ECX,0xc
006b0f07 : CMP EAX,dword ptr [EDX + 0x4]
006b0f0a : JC 0x006b0ef8
006b0f0c : JMP 0x006b0f17
006b0f0e : PUSH EBP
006b0f0f : CALL 0x006af390
006b0f14 : ADD ESP,0x4
006b0f17 : CMP dword ptr [EBP + 0x210],ESI
006b0f1d : JZ 0x006b0f56
006b0f1f : MOV EAX,dword ptr [EBP + 0x21c]
006b0f25 : CMP EAX,ESI
006b0f27 : JBE 0x006b0f56
006b0f29 : MOV ECX,dword ptr [EBP + 0x64]
006b0f2c : LEA EDX,[ESP + 0x14]
006b0f30 : PUSH EDX
006b0f31 : PUSH ESI
006b0f32 : PUSH EAX
006b0f33 : PUSH ESI
006b0f34 : PUSH 0x4
006b0f36 : PUSH ECX
006b0f37 : CALL 0x0068a220
006b0f3c : ADD ESP,0x18
006b0f3f : MOV dword ptr [EBP + 0x220],EAX
006b0f45 : CMP dword ptr [ESP + 0x14],ESI
006b0f49 : JZ 0x006b0f56
006b0f4b : MOV dword ptr [EBP + 0x21c],ESI
006b0f51 : JMP 0x006b1177
006b0f56 : MOV EAX,dword ptr [ESP + 0xbc]
006b0f5d : MOV dword ptr [EBP + 0x19c],EAX
006b0f63 : CMP dword ptr [ESP + 0x16c],ESI
006b0f6a : JZ 0x006b0fa7
006b0f6c : MOV ECX,dword ptr [ESP + 0x15c]
006b0f73 : MOV EDX,dword ptr [ESP + 0x160]
006b0f7a : MOV EAX,dword ptr [ESP + 0x178]
006b0f81 : MOV dword ptr [EBP + 0x190],ECX
006b0f87 : MOV ECX,dword ptr [ESP + 0x17c]
006b0f8e : MOV dword ptr [ESP + 0x16c],ESI
006b0f95 : MOV dword ptr [EBP + 0x184],EDX
006b0f9b : MOV dword ptr [EBP + 0x194],EAX
006b0fa1 : MOV dword ptr [EBP + 0x198],ECX
006b0fa7 : CMP dword ptr [ESP + 0x100],ESI
006b0fae : JNZ 0x006b0fb8
006b0fb0 : MOV dword ptr [ESP + 0x14],0x3
006b0fb8 : CMP dword ptr [EBP + 0x16c],0x1
006b0fbf : MOV EDX,dword ptr [ESP + 0xf4]
006b0fc6 : MOV EAX,dword ptr [ESP + 0x10c]
006b0fcd : MOV ECX,dword ptr [ESP + 0x110]
006b0fd4 : MOV dword ptr [EBP + 0x188],EDX
006b0fda : MOV EDX,dword ptr [ESP + 0xc0]
006b0fe1 : MOV dword ptr [EBP + 0x1a4],EAX
006b0fe7 : MOV EAX,dword ptr [ESP + 0xd8]
006b0fee : MOV dword ptr [ESP + 0x100],ESI
006b0ff5 : MOV dword ptr [EBP + 0x1a8],ECX
006b0ffb : MOV dword ptr [EBP + 0x18c],EDX
006b1001 : MOV dword ptr [EBP + 0x1a0],EAX
006b1007 : MOV dword ptr [ESP + 0xc0],ESI
006b100e : MOV dword ptr [ESP + 0xd8],ESI
006b1015 : JNZ 0x006b1177
006b101b : MOV EAX,dword ptr [ESP + 0x98]
006b1022 : XOR ECX,ECX
006b1024 : CMP EAX,ESI
006b1026 : MOV dword ptr [ESP + 0x18],0x7d00
006b102e : MOV dword ptr [ESP + 0x1c],0xffff8300
006b1036 : MOV dword ptr [ESP + 0x10],ECX
006b103a : JLE 0x006b114e
006b1040 : MOV EDX,dword ptr [EBP + 0x17c]
006b1046 : XOR EAX,EAX
006b1048 : MOV word ptr [EDX + ECX*0x2],AX
006b104c : MOV EDX,dword ptr [EBP + 0x180]
006b1052 : MOV dword ptr [EDX + ECX*0x4],0xbe967c
006b1059 : MOV EAX,dword ptr [ESP + 0xa0]
006b1060 : MOV EAX,dword ptr [EAX + ECX*0x4]
006b1063 : MOV dword ptr [ESP + 0x20],EAX
006b1067 : CMP EAX,ESI
006b1069 : JZ 0x006b1130
006b106f : XOR EBX,EBX
006b1071 : CMP dword ptr [EBP + 0x19c],ESI
006b1077 : JLE 0x006b1130
006b107d : MOV ESI,dword ptr [EBP + 0x1a0]
006b1083 : JMP 0x006b1089
006b1085 : MOV EAX,dword ptr [ESP + 0x20]
006b1089 : MOV EDI,dword ptr [ESI]
006b108b : MOV ECX,EDI
006b108d : LEA ECX,[ECX]
006b1090 : MOV DL,byte ptr [EAX]
006b1092 : CMP DL,byte ptr [ECX]
006b1094 : JNZ 0x006b10b0
006b1096 : TEST DL,DL
006b1098 : JZ 0x006b10ac
006b109a : MOV DL,byte ptr [EAX + 0x1]
006b109d : CMP DL,byte ptr [ECX + 0x1]
006b10a0 : JNZ 0x006b10b0
006b10a2 : ADD EAX,0x2
006b10a5 : ADD ECX,0x2
006b10a8 : TEST DL,DL
006b10aa : JNZ 0x006b1090
006b10ac : XOR EAX,EAX
006b10ae : JMP 0x006b10b5
006b10b0 : SBB EAX,EAX
006b10b2 : SBB EAX,-0x1
006b10b5 : TEST EAX,EAX
006b10b7 : JZ 0x006b10c7
006b10b9 : INC EBX
006b10ba : ADD ESI,0x4
006b10bd : CMP EBX,dword ptr [EBP + 0x19c]
006b10c3 : JL 0x006b1085
006b10c5 : JMP 0x006b112a
006b10c7 : MOV ECX,dword ptr [EBP + 0x17c]
006b10cd : MOV EAX,dword ptr [ESP + 0x10]
006b10d1 : MOV word ptr [ECX + EAX*0x2],BX
006b10d5 : MOV EDX,dword ptr [EBP + 0x180]
006b10db : MOV dword ptr [EDX + EAX*0x4],EDI
006b10de : MOV ECX,EDI
006b10e0 : MOV EAX,0xbe967c
006b10e5 : MOV DL,byte ptr [EAX]
006b10e7 : CMP DL,byte ptr [ECX]
006b10e9 : JNZ 0x006b1105
006b10eb : TEST DL,DL
006b10ed : JZ 0x006b1101
006b10ef : MOV DL,byte ptr [EAX + 0x1]
006b10f2 : CMP DL,byte ptr [ECX + 0x1]
006b10f5 : JNZ 0x006b1105
006b10f7 : ADD EAX,0x2
006b10fa : ADD ECX,0x2
006b10fd : TEST DL,DL
006b10ff : JNZ 0x006b10e5
006b1101 : XOR EAX,EAX
006b1103 : JMP 0x006b110a
006b1105 : SBB EAX,EAX
006b1107 : SBB EAX,-0x1
006b110a : TEST EAX,EAX
006b110c : JZ 0x006b112a
006b110e : MOV EAX,dword ptr [ESP + 0x10]
006b1112 : CMP EAX,dword ptr [ESP + 0x18]
006b1116 : JGE 0x006b111c
006b1118 : MOV dword ptr [ESP + 0x18],EAX
006b111c : CMP EAX,dword ptr [ESP + 0x1c]
006b1120 : JLE 0x006b112a
006b1122 : MOV EAX,dword ptr [ESP + 0x10]
006b1126 : MOV dword ptr [ESP + 0x1c],EAX
006b112a : MOV ECX,dword ptr [ESP + 0x10]
006b112e : XOR ESI,ESI
006b1130 : MOV EAX,dword ptr [ESP + 0x98]
006b1137 : INC ECX
006b1138 : CMP ECX,EAX
006b113a : MOV dword ptr [ESP + 0x10],ECX
006b113e : JL 0x006b1040
006b1144 : MOV ECX,dword ptr [ESP + 0x1c]
006b1148 : CMP dword ptr [ESP + 0x18],ECX
006b114c : JLE 0x006b1156
006b114e : MOV dword ptr [ESP + 0x18],ESI
006b1152 : MOV dword ptr [ESP + 0x1c],EAX
006b1156 : MOV EDX,dword ptr [ESP + 0x18]
006b115a : MOV EAX,dword ptr [ESP + 0x1c]
006b115e : MOV ECX,dword ptr [ESP + 0x84]
006b1165 : MOV dword ptr [EBP + 0x174],EDX
006b116b : MOV dword ptr [EBP + 0x178],EAX
006b1171 : MOV dword ptr [EBP + 0x170],ECX
006b1177 : LEA EAX,[ESP + 0x24]
006b117b : CALL 0x006b0d40
006b1180 : MOV EAX,dword ptr [ESP + 0x14]
006b1184 : POP EDI
006b1185 : POP ESI
006b1186 : POP EBP
006b1187 : POP EBX
006b1188 : ADD ESP,0x18c
006b118e : RET

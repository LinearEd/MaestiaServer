PROGRAM  : Maestia.exe
FUNCTION : FUN_006b0320
ENTRY    : 006b0320
BODY     : [[006b0320, 006b093d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006b0320(int param_1,int *param_2)

{
  int iVar1;
  int *piVar2;
  char cVar3;
  byte bVar4;
  undefined4 *puVar5;
  size_t _Size;
  int iVar6;
  int iVar7;
  char *pcVar8;
  int iVar9;
  void *_Dst;
  byte *pbVar10;
  byte *pbVar11;
  char *pcVar12;
  bool bVar13;
  int iStack_38;
  char local_31;
  int *local_30;
  int iStack_2c;
  int local_28;
  size_t sStack_24;
  char *local_20;
  void *pvStack_1c;
  int local_18;
  int iStack_14;
  int local_10;
  undefined4 *local_c;
  undefined1 uStack_8;
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)&iStack_38;
  puVar5 = *(undefined4 **)(param_1 + 0x1e4);
  pcVar8 = (char *)param_2[2];
  iVar9 = param_2[4];
  local_18 = param_1;
  local_30 = param_2;
  local_28 = 0;
  local_31 = '\0';
  local_20 = pcVar8;
  local_10 = iVar9;
  local_c = puVar5;
  iStack_14 = (*(code *)param_2[9])(param_2);
  if ((iStack_14 == 0) || (param_2[3] != 0)) goto LAB_006b092b;
  if (param_2[0x26] == 0) {
    iVar1 = iStack_14 + 6;
    iStack_38 = (**(code **)*puVar5)(param_2 + 0x34,iVar1,iVar9);
    iVar7 = iStack_38;
    if (((iStack_38 == 0) &&
        (iStack_38 = (**(code **)*puVar5)(param_2 + 0x27,iVar1,iVar9), iVar7 = iStack_38,
        iStack_38 == 0)) &&
       (iStack_38 = (**(code **)*puVar5)(param_2 + 0x41,4,iVar9), iVar7 = iStack_38,
       pcVar8 = local_20, iStack_38 == 0)) goto LAB_006b03f4;
  }
  else {
LAB_006b03f4:
    iStack_2c = 0;
    (*(code *)param_2[7])(param_2);
    pcVar12 = (char *)*param_2;
    if (pcVar12 < pcVar8) {
      do {
        if (((pcVar12 + 3 < pcVar8) &&
            ((((((cVar3 = pcVar12[3], cVar3 == ' ' || (cVar3 == '\r')) ||
                ((cVar3 == '\n' || ((cVar3 == '\t' || (cVar3 == '\f')))))) || (cVar3 == '\0')) ||
              (((((cVar3 == '/' || (cVar3 == '(')) || (cVar3 == ')')) ||
                ((cVar3 == '<' || (cVar3 == '>')))) || (cVar3 == '[')))) ||
             (((cVar3 == ']' || (cVar3 == '{')) || ((cVar3 == '}' || (cVar3 == '%')))))))) &&
           (((((*pcVar12 == 'd' && (pcVar12[1] == 'e')) && (pcVar12[2] == 'f')) && (iStack_2c != 0))
            || (((*pcVar12 == 'e' && (pcVar12[1] == 'n')) && (pcVar12[2] == 'd')))))) break;
        (*(code *)param_2[8])(param_2);
        if (param_2[3] != 0) goto LAB_006b092b;
        if (*pcVar12 == '/') {
          pcVar12 = pcVar12 + 1;
          if (pcVar8 <= pcVar12) {
            iVar7 = 3;
            goto LAB_006b0928;
          }
          iVar9 = *param_2;
          iVar7 = FUN_006afba0(&pvStack_1c);
          iVar1 = iStack_2c;
          piVar2 = local_30;
          if (iVar7 == 0) goto LAB_006b092b;
          pcVar8 = local_20;
          param_2 = local_30;
          if (local_30[0x26] == 0) {
            iStack_38 = (*(code *)local_30[0x32])
                                  (local_30 + 0x27,iStack_2c,pcVar12,(iVar9 - (int)pcVar12) + 1);
            iVar6 = local_10;
            _Size = sStack_24;
            iVar7 = iStack_38;
            param_2 = local_30;
            if (iStack_38 != 0) goto LAB_006b0928;
            *(undefined1 *)((iVar9 - (int)pcVar12) + *(int *)(piVar2[0x2d] + iVar1 * 4)) = 0;
            if (*pcVar12 == '.') {
              pbVar10 = *(byte **)(piVar2[0x2d] + iVar1 * 4);
              pcVar8 = ".notdef";
              do {
                bVar4 = *pcVar8;
                bVar13 = bVar4 < *pbVar10;
                if (bVar4 != *pbVar10) {
LAB_006b0542:
                  iVar9 = (1 - (uint)bVar13) - (uint)(bVar13 != 0);
                  goto LAB_006b0547;
                }
                if (bVar4 == 0) break;
                bVar4 = ((byte *)pcVar8)[1];
                bVar13 = bVar4 < pbVar10[1];
                if (bVar4 != pbVar10[1]) goto LAB_006b0542;
                pcVar8 = (char *)((byte *)pcVar8 + 2);
                pbVar10 = pbVar10 + 2;
              } while (bVar4 != 0);
              iVar9 = 0;
LAB_006b0547:
              if (iVar9 == 0) {
                local_28 = iVar1;
                local_31 = '\x01';
              }
            }
            if ((*(int *)(local_18 + 0xa8) < 0) || (iStack_14 + 5 <= iVar1)) {
              iStack_38 = (*(code *)local_30[0x3f])(local_30 + 0x34,iVar1,pvStack_1c,sStack_24);
            }
            else {
              if ((int)sStack_24 <= *(int *)(local_18 + 0xa8)) {
                iVar7 = 3;
                goto LAB_006b0928;
              }
              _Dst = (void *)FUN_00688c00(local_10,sStack_24,&iStack_38);
              iVar7 = iStack_38;
              param_2 = local_30;
              if (iStack_38 != 0) goto LAB_006b0928;
              _memcpy(_Dst,pvStack_1c,_Size);
              (*(code *)local_c[4])(_Dst,_Size,0x10ea);
              sStack_24 = _Size - *(int *)(local_18 + 0xa8);
              iStack_38 = (*(code *)local_30[0x3f])
                                    (local_30 + 0x34,iVar1,*(int *)(local_18 + 0xa8) + (int)_Dst,
                                     sStack_24);
              FUN_00687f30(iVar6,_Dst);
            }
            iVar7 = iStack_38;
            param_2 = local_30;
            if (iStack_38 != 0) goto LAB_006b0928;
            iStack_2c = iVar1 + 1;
            pcVar8 = local_20;
          }
        }
        (*(code *)param_2[7])(param_2);
        pcVar12 = (char *)*param_2;
      } while (pcVar12 < pcVar8);
    }
    if (param_2[0x26] != 0) goto LAB_006b092b;
    param_2[0x26] = iStack_2c;
    pbVar10 = *(byte **)param_2[0x2d];
    pcVar8 = ".notdef";
    pbVar11 = pbVar10;
    do {
      bVar4 = *pcVar8;
      bVar13 = bVar4 < *pbVar11;
      if (bVar4 != *pbVar11) {
LAB_006b0690:
        iVar9 = (1 - (uint)bVar13) - (uint)(bVar13 != 0);
        goto LAB_006b0695;
      }
      if (bVar4 == 0) break;
      bVar4 = ((byte *)pcVar8)[1];
      bVar13 = bVar4 < pbVar11[1];
      if (bVar4 != pbVar11[1]) goto LAB_006b0690;
      pcVar8 = (char *)((byte *)pcVar8 + 2);
      pbVar11 = pbVar11 + 2;
    } while (bVar4 != 0);
    iVar9 = 0;
LAB_006b0695:
    if (iVar9 == 0) {
      if (local_31 != '\0') goto LAB_006b092b;
    }
    else if (local_31 != '\0') {
      piVar2 = param_2 + 0x41;
      iStack_38 = (*(code *)param_2[0x4c])(piVar2,0,pbVar10,*(undefined4 *)param_2[0x2e]);
      iVar7 = iStack_38;
      if (iStack_38 == 0) {
        iStack_38 = (*(code *)param_2[0x4c])
                              (piVar2,1,*(undefined4 *)param_2[0x3a],*(undefined4 *)param_2[0x3b]);
        iVar7 = iStack_38;
        if ((((iStack_38 == 0) &&
             (iStack_38 = (*(code *)param_2[0x4c])
                                    (piVar2,2,*(undefined4 *)(param_2[0x2d] + local_28 * 4),
                                     *(undefined4 *)(param_2[0x2e] + local_28 * 4)),
             iVar7 = iStack_38, iStack_38 == 0)) &&
            (iStack_38 = (*(code *)param_2[0x4c])
                                   (piVar2,3,*(undefined4 *)(param_2[0x3a] + local_28 * 4),
                                    *(undefined4 *)(param_2[0x3b] + local_28 * 4)),
            iVar7 = iStack_38, iStack_38 == 0)) &&
           (((iStack_38 = (*(code *)param_2[0x32])
                                    (param_2 + 0x27,local_28,*(undefined4 *)param_2[0x47],
                                     *(undefined4 *)param_2[0x48]), iVar7 = iStack_38,
             iStack_38 == 0 &&
             (iStack_38 = (*(code *)param_2[0x3f])
                                    (param_2 + 0x34,local_28,*(undefined4 *)(param_2[0x47] + 4),
                                     *(undefined4 *)(param_2[0x48] + 4)), iVar7 = iStack_38,
             iStack_38 == 0)) &&
            ((iStack_38 = (*(code *)param_2[0x32])
                                    (param_2 + 0x27,0,*(undefined4 *)(param_2[0x47] + 8),
                                     *(undefined4 *)(param_2[0x48] + 8)), iVar7 = iStack_38,
             iStack_38 == 0 &&
             (iVar7 = (*(code *)param_2[0x3f])
                                (param_2 + 0x34,0,*(undefined4 *)(param_2[0x47] + 0xc),
                                 *(undefined4 *)(param_2[0x48] + 0xc)), iVar7 == 0)))))) {
          __security_check_cookie(local_4 ^ (uint)&iStack_38);
          return;
        }
      }
      goto LAB_006b0928;
    }
    local_c = (undefined4 *)0xde1f78b;
    uStack_8 = 0xe;
    iStack_38 = (*(code *)param_2[0x4c])
                          (param_2 + 0x41,0,*(undefined4 *)param_2[0x2d],
                           *(undefined4 *)param_2[0x2e]);
    iVar7 = iStack_38;
    if (iStack_38 == 0) {
      iStack_38 = (*(code *)param_2[0x4c])
                            (param_2 + 0x41,1,*(undefined4 *)param_2[0x3a],
                             *(undefined4 *)param_2[0x3b]);
      iVar7 = iStack_38;
      if (((iStack_38 == 0) &&
          (iStack_38 = (*(code *)param_2[0x32])(param_2 + 0x27,0,".notdef",8), iVar7 = iStack_38,
          iStack_38 == 0)) &&
         ((iStack_38 = (*(code *)param_2[0x3f])(param_2 + 0x34,0,&local_c,5), iVar7 = iStack_38,
          iStack_38 == 0 &&
          ((iStack_38 = (*(code *)param_2[0x32])
                                  (param_2 + 0x27,iStack_2c,*(undefined4 *)param_2[0x47],
                                   *(undefined4 *)param_2[0x48]), iVar9 = iStack_2c,
           iVar7 = iStack_38, iStack_38 == 0 &&
           (iVar7 = (*(code *)param_2[0x3f])
                              (param_2 + 0x34,iStack_2c,*(undefined4 *)(param_2[0x47] + 4),
                               *(undefined4 *)(param_2[0x48] + 4)), iVar7 == 0)))))) {
        param_2[0x26] = iVar9 + 1;
        __security_check_cookie(local_4 ^ (uint)&iStack_38);
        return;
      }
    }
  }
LAB_006b0928:
  param_2[3] = iVar7;
LAB_006b092b:
  __security_check_cookie(local_4 ^ (uint)&iStack_38);
  return;
}



============================================================
DISASSEMBLY
============================================================
006b0320 : SUB ESP,0x38
006b0323 : MOV EAX,[0x00d66fa0]
006b0328 : XOR EAX,ESP
006b032a : MOV dword ptr [ESP + 0x34],EAX
006b032e : MOV EAX,dword ptr [ESP + 0x3c]
006b0332 : PUSH EBX
006b0333 : PUSH EBP
006b0334 : MOV EBP,dword ptr [EAX + 0x1e4]
006b033a : PUSH ESI
006b033b : MOV ESI,dword ptr [ESP + 0x4c]
006b033f : MOV EBX,dword ptr [ESI + 0x8]
006b0342 : PUSH EDI
006b0343 : MOV EDI,dword ptr [ESI + 0x10]
006b0346 : MOV dword ptr [ESP + 0x30],EAX
006b034a : MOV EAX,dword ptr [ESI + 0x24]
006b034d : PUSH ESI
006b034e : MOV dword ptr [ESP + 0x1c],ESI
006b0352 : MOV dword ptr [ESP + 0x3c],EDI
006b0356 : MOV dword ptr [ESP + 0x40],EBP
006b035a : MOV dword ptr [ESP + 0x2c],EBX
006b035e : MOV dword ptr [ESP + 0x24],0x0
006b0366 : MOV byte ptr [ESP + 0x1b],0x0
006b036b : CALL EAX
006b036d : ADD ESP,0x4
006b0370 : MOV dword ptr [ESP + 0x34],EAX
006b0374 : TEST EAX,EAX
006b0376 : JZ 0x006b092b
006b037c : CMP dword ptr [ESI + 0xc],0x0
006b0380 : JNZ 0x006b092b
006b0386 : CMP dword ptr [ESI + 0x98],0x0
006b038d : JNZ 0x006b03f4
006b038f : MOV ECX,dword ptr [EBP]
006b0392 : MOV EDX,dword ptr [ECX]
006b0394 : LEA EBX,[EAX + 0x6]
006b0397 : PUSH EDI
006b0398 : LEA EAX,[ESI + 0xd0]
006b039e : PUSH EBX
006b039f : PUSH EAX
006b03a0 : CALL EDX
006b03a2 : ADD ESP,0xc
006b03a5 : MOV dword ptr [ESP + 0x10],EAX
006b03a9 : TEST EAX,EAX
006b03ab : JNZ 0x006b0928
006b03b1 : MOV ECX,dword ptr [EBP]
006b03b4 : MOV EDX,dword ptr [ECX]
006b03b6 : PUSH EDI
006b03b7 : LEA EAX,[ESI + 0x9c]
006b03bd : PUSH EBX
006b03be : PUSH EAX
006b03bf : CALL EDX
006b03c1 : ADD ESP,0xc
006b03c4 : MOV dword ptr [ESP + 0x10],EAX
006b03c8 : TEST EAX,EAX
006b03ca : JNZ 0x006b0928
006b03d0 : MOV ECX,dword ptr [EBP]
006b03d3 : MOV EDX,dword ptr [ECX]
006b03d5 : PUSH EDI
006b03d6 : LEA EAX,[ESI + 0x104]
006b03dc : PUSH 0x4
006b03de : PUSH EAX
006b03df : CALL EDX
006b03e1 : ADD ESP,0xc
006b03e4 : MOV dword ptr [ESP + 0x10],EAX
006b03e8 : TEST EAX,EAX
006b03ea : JNZ 0x006b0928
006b03f0 : MOV EBX,dword ptr [ESP + 0x28]
006b03f4 : MOV EAX,dword ptr [ESI + 0x1c]
006b03f7 : PUSH ESI
006b03f8 : MOV dword ptr [ESP + 0x20],0x0
006b0400 : CALL EAX
006b0402 : MOV EBP,dword ptr [ESI]
006b0404 : ADD ESP,0x4
006b0407 : CMP EBP,EBX
006b0409 : JNC 0x006b0649
006b040f : NOP
006b0410 : LEA EAX,[EBP + 0x3]
006b0413 : CMP EAX,EBX
006b0415 : JNC 0x006b048b
006b0417 : MOV AL,byte ptr [EAX]
006b0419 : CMP AL,0x20
006b041b : JZ 0x006b0459
006b041d : CMP AL,0xd
006b041f : JZ 0x006b0459
006b0421 : CMP AL,0xa
006b0423 : JZ 0x006b0459
006b0425 : CMP AL,0x9
006b0427 : JZ 0x006b0459
006b0429 : CMP AL,0xc
006b042b : JZ 0x006b0459
006b042d : TEST AL,AL
006b042f : JZ 0x006b0459
006b0431 : CMP AL,0x2f
006b0433 : JZ 0x006b0459
006b0435 : CMP AL,0x28
006b0437 : JZ 0x006b0459
006b0439 : CMP AL,0x29
006b043b : JZ 0x006b0459
006b043d : CMP AL,0x3c
006b043f : JZ 0x006b0459
006b0441 : CMP AL,0x3e
006b0443 : JZ 0x006b0459
006b0445 : CMP AL,0x5b
006b0447 : JZ 0x006b0459
006b0449 : CMP AL,0x5d
006b044b : JZ 0x006b0459
006b044d : CMP AL,0x7b
006b044f : JZ 0x006b0459
006b0451 : CMP AL,0x7d
006b0453 : JZ 0x006b0459
006b0455 : CMP AL,0x25
006b0457 : JNZ 0x006b048b
006b0459 : MOV AL,byte ptr [EBP]
006b045c : CMP AL,0x64
006b045e : JNZ 0x006b0477
006b0460 : CMP byte ptr [EBP + 0x1],0x65
006b0464 : JNZ 0x006b0477
006b0466 : CMP byte ptr [EBP + 0x2],0x66
006b046a : JNZ 0x006b0477
006b046c : CMP dword ptr [ESP + 0x1c],0x0
006b0471 : JNZ 0x006b0649
006b0477 : CMP AL,0x65
006b0479 : JNZ 0x006b048b
006b047b : CMP byte ptr [EBP + 0x1],0x6e
006b047f : JNZ 0x006b048b
006b0481 : CMP byte ptr [EBP + 0x2],0x64
006b0485 : JZ 0x006b0649
006b048b : MOV ECX,dword ptr [ESI + 0x20]
006b048e : PUSH ESI
006b048f : CALL ECX
006b0491 : ADD ESP,0x4
006b0494 : CMP dword ptr [ESI + 0xc],0x0
006b0498 : JNZ 0x006b092b
006b049e : CMP byte ptr [EBP],0x2f
006b04a2 : JNZ 0x006b0636
006b04a8 : INC EBP
006b04a9 : CMP EBP,EBX
006b04ab : JNC 0x006b0918
006b04b1 : MOV EDI,dword ptr [ESI]
006b04b3 : LEA EDX,[ESP + 0x2c]
006b04b7 : PUSH EDX
006b04b8 : LEA EBX,[ESP + 0x28]
006b04bc : SUB EDI,EBP
006b04be : CALL 0x006afba0
006b04c3 : ADD ESP,0x4
006b04c6 : TEST EAX,EAX
006b04c8 : JZ 0x006b092b
006b04ce : MOV EBX,dword ptr [ESP + 0x18]
006b04d2 : CMP dword ptr [EBX + 0x98],0x0
006b04d9 : JNZ 0x006b0630
006b04df : MOV ESI,dword ptr [ESP + 0x1c]
006b04e3 : MOV ECX,dword ptr [EBX + 0xc8]
006b04e9 : LEA EAX,[EDI + 0x1]
006b04ec : PUSH EAX
006b04ed : PUSH EBP
006b04ee : ADD EBX,0x9c
006b04f4 : PUSH ESI
006b04f5 : PUSH EBX
006b04f6 : CALL ECX
006b04f8 : ADD ESP,0x10
006b04fb : MOV dword ptr [ESP + 0x10],EAX
006b04ff : TEST EAX,EAX
006b0501 : JNZ 0x006b0924
006b0507 : MOV EDX,dword ptr [EBX + 0x18]
006b050a : MOV EAX,dword ptr [EDX + ESI*0x4]
006b050d : MOV byte ptr [EDI + EAX*0x1],0x0
006b0511 : CMP byte ptr [EBP],0x2e
006b0515 : JNZ 0x006b0554
006b0517 : MOV ECX,dword ptr [EBX + 0x18]
006b051a : MOV ECX,dword ptr [ECX + ESI*0x4]
006b051d : MOV EAX,0xbe967c
006b0522 : MOV DL,byte ptr [EAX]
006b0524 : CMP DL,byte ptr [ECX]
006b0526 : JNZ 0x006b0542
006b0528 : TEST DL,DL
006b052a : JZ 0x006b053e
006b052c : MOV DL,byte ptr [EAX + 0x1]
006b052f : CMP DL,byte ptr [ECX + 0x1]
006b0532 : JNZ 0x006b0542
006b0534 : ADD EAX,0x2
006b0537 : ADD ECX,0x2
006b053a : TEST DL,DL
006b053c : JNZ 0x006b0522
006b053e : XOR EAX,EAX
006b0540 : JMP 0x006b0547
006b0542 : SBB EAX,EAX
006b0544 : SBB EAX,-0x1
006b0547 : TEST EAX,EAX
006b0549 : JNZ 0x006b0554
006b054b : MOV dword ptr [ESP + 0x20],ESI
006b054f : MOV byte ptr [ESP + 0x17],0x1
006b0554 : MOV EDX,dword ptr [ESP + 0x30]
006b0558 : MOV EAX,dword ptr [EDX + 0xa8]
006b055e : TEST EAX,EAX
006b0560 : JL 0x006b05f9
006b0566 : MOV ECX,dword ptr [ESP + 0x34]
006b056a : ADD ECX,0x5
006b056d : CMP ESI,ECX
006b056f : JGE 0x006b05f9
006b0575 : MOV EDI,dword ptr [ESP + 0x24]
006b0579 : CMP EDI,EAX
006b057b : JLE 0x006b091f
006b0581 : MOV EBP,dword ptr [ESP + 0x38]
006b0585 : LEA EDX,[ESP + 0x10]
006b0589 : PUSH EDX
006b058a : PUSH EDI
006b058b : PUSH EBP
006b058c : CALL 0x00688c00
006b0591 : MOV EBX,EAX
006b0593 : MOV EAX,dword ptr [ESP + 0x1c]
006b0597 : ADD ESP,0xc
006b059a : TEST EAX,EAX
006b059c : JNZ 0x006b0924
006b05a2 : MOV EAX,dword ptr [ESP + 0x2c]
006b05a6 : PUSH EDI
006b05a7 : PUSH EAX
006b05a8 : PUSH EBX
006b05a9 : CALL 0x0063ae40
006b05ae : MOV ECX,dword ptr [ESP + 0x48]
006b05b2 : MOV EDX,dword ptr [ECX + 0x10]
006b05b5 : PUSH 0x10ea
006b05ba : PUSH EDI
006b05bb : PUSH EBX
006b05bc : CALL EDX
006b05be : MOV EAX,dword ptr [ESP + 0x48]
006b05c2 : MOV EAX,dword ptr [EAX + 0xa8]
006b05c8 : SUB EDI,EAX
006b05ca : ADD EAX,EBX
006b05cc : PUSH EDI
006b05cd : PUSH EAX
006b05ce : MOV EAX,dword ptr [ESP + 0x38]
006b05d2 : MOV ECX,dword ptr [EAX + 0xfc]
006b05d8 : ADD EAX,0xd0
006b05dd : PUSH ESI
006b05de : PUSH EAX
006b05df : MOV dword ptr [ESP + 0x4c],EDI
006b05e3 : CALL ECX
006b05e5 : PUSH EBX
006b05e6 : PUSH EBP
006b05e7 : MOV dword ptr [ESP + 0x40],EAX
006b05eb : CALL 0x00687f30
006b05f0 : MOV EAX,dword ptr [ESP + 0x40]
006b05f4 : ADD ESP,0x30
006b05f7 : JMP 0x006b061d
006b05f9 : MOV EDX,dword ptr [ESP + 0x24]
006b05fd : MOV EAX,dword ptr [ESP + 0x2c]
006b0601 : PUSH EDX
006b0602 : PUSH EAX
006b0603 : MOV EAX,dword ptr [ESP + 0x20]
006b0607 : MOV ECX,dword ptr [EAX + 0xfc]
006b060d : ADD EAX,0xd0
006b0612 : PUSH ESI
006b0613 : PUSH EAX
006b0614 : CALL ECX
006b0616 : ADD ESP,0x10
006b0619 : MOV dword ptr [ESP + 0x10],EAX
006b061d : TEST EAX,EAX
006b061f : JNZ 0x006b0924
006b0625 : INC ESI
006b0626 : MOV dword ptr [ESP + 0x1c],ESI
006b062a : MOV ESI,dword ptr [ESP + 0x18]
006b062e : JMP 0x006b0632
006b0630 : MOV ESI,EBX
006b0632 : MOV EBX,dword ptr [ESP + 0x28]
006b0636 : MOV EDX,dword ptr [ESI + 0x1c]
006b0639 : PUSH ESI
006b063a : CALL EDX
006b063c : MOV EBP,dword ptr [ESI]
006b063e : ADD ESP,0x4
006b0641 : CMP EBP,EBX
006b0643 : JC 0x006b0410
006b0649 : CMP dword ptr [ESI + 0x98],0x0
006b0650 : JNZ 0x006b092b
006b0656 : MOV EAX,dword ptr [ESP + 0x1c]
006b065a : MOV dword ptr [ESI + 0x98],EAX
006b0660 : MOV EDI,dword ptr [ESI + 0xb4]
006b0666 : MOV EBX,dword ptr [EDI]
006b0668 : MOV ECX,EBX
006b066a : MOV EAX,0xbe967c
006b066f : NOP
006b0670 : MOV DL,byte ptr [EAX]
006b0672 : CMP DL,byte ptr [ECX]
006b0674 : JNZ 0x006b0690
006b0676 : TEST DL,DL
006b0678 : JZ 0x006b068c
006b067a : MOV DL,byte ptr [EAX + 0x1]
006b067d : CMP DL,byte ptr [ECX + 0x1]
006b0680 : JNZ 0x006b0690
006b0682 : ADD EAX,0x2
006b0685 : ADD ECX,0x2
006b0688 : TEST DL,DL
006b068a : JNZ 0x006b0670
006b068c : XOR EAX,EAX
006b068e : JMP 0x006b0695
006b0690 : SBB EAX,EAX
006b0692 : SBB EAX,-0x1
006b0695 : TEST EAX,EAX
006b0697 : JZ 0x006b0800
006b069d : CMP byte ptr [ESP + 0x17],0x0
006b06a2 : JZ 0x006b080b
006b06a8 : MOV ECX,dword ptr [ESI + 0xb8]
006b06ae : MOV EDX,dword ptr [ECX]
006b06b0 : MOV EAX,dword ptr [ESI + 0x130]
006b06b6 : LEA EBP,[ESI + 0x9c]
006b06bc : PUSH EDX
006b06bd : PUSH EBX
006b06be : LEA EDI,[ESI + 0x104]
006b06c4 : PUSH 0x0
006b06c6 : PUSH EDI
006b06c7 : CALL EAX
006b06c9 : ADD ESP,0x10
006b06cc : MOV dword ptr [ESP + 0x10],EAX
006b06d0 : TEST EAX,EAX
006b06d2 : JNZ 0x006b0928
006b06d8 : MOV ECX,dword ptr [ESI + 0xec]
006b06de : MOV EDX,dword ptr [ECX]
006b06e0 : MOV EAX,dword ptr [ESI + 0xe8]
006b06e6 : MOV ECX,dword ptr [EAX]
006b06e8 : LEA EBX,[ESI + 0xd0]
006b06ee : PUSH EDX
006b06ef : MOV EDX,dword ptr [EDI + 0x2c]
006b06f2 : PUSH ECX
006b06f3 : PUSH 0x1
006b06f5 : PUSH EDI
006b06f6 : CALL EDX
006b06f8 : ADD ESP,0x10
006b06fb : MOV dword ptr [ESP + 0x10],EAX
006b06ff : TEST EAX,EAX
006b0701 : JNZ 0x006b0928
006b0707 : MOV ECX,dword ptr [EBP + 0x1c]
006b070a : MOV EAX,dword ptr [ESP + 0x20]
006b070e : MOV EDX,dword ptr [ECX + EAX*0x4]
006b0711 : MOV ECX,dword ptr [EBP + 0x18]
006b0714 : PUSH EDX
006b0715 : MOV EDX,dword ptr [ECX + EAX*0x4]
006b0718 : MOV EAX,dword ptr [EDI + 0x2c]
006b071b : PUSH EDX
006b071c : PUSH 0x2
006b071e : PUSH EDI
006b071f : CALL EAX
006b0721 : ADD ESP,0x10
006b0724 : MOV dword ptr [ESP + 0x10],EAX
006b0728 : TEST EAX,EAX
006b072a : JNZ 0x006b0928
006b0730 : MOV ECX,dword ptr [EBX + 0x1c]
006b0733 : MOV EAX,dword ptr [ESP + 0x20]
006b0737 : MOV EDX,dword ptr [ECX + EAX*0x4]
006b073a : MOV ECX,dword ptr [EBX + 0x18]
006b073d : PUSH EDX
006b073e : MOV EDX,dword ptr [ECX + EAX*0x4]
006b0741 : MOV EAX,dword ptr [EDI + 0x2c]
006b0744 : PUSH EDX
006b0745 : PUSH 0x3
006b0747 : PUSH EDI
006b0748 : CALL EAX
006b074a : ADD ESP,0x10
006b074d : MOV dword ptr [ESP + 0x10],EAX
006b0751 : TEST EAX,EAX
006b0753 : JNZ 0x006b0928
006b0759 : MOV ECX,dword ptr [EDI + 0x1c]
006b075c : MOV EDX,dword ptr [ECX]
006b075e : MOV EAX,dword ptr [EDI + 0x18]
006b0761 : MOV ECX,dword ptr [EAX]
006b0763 : MOV EAX,dword ptr [EBP + 0x2c]
006b0766 : PUSH EDX
006b0767 : MOV EDX,dword ptr [ESP + 0x24]
006b076b : PUSH ECX
006b076c : PUSH EDX
006b076d : PUSH EBP
006b076e : CALL EAX
006b0770 : ADD ESP,0x10
006b0773 : MOV dword ptr [ESP + 0x10],EAX
006b0777 : TEST EAX,EAX
006b0779 : JNZ 0x006b0928
006b077f : MOV ECX,dword ptr [EDI + 0x1c]
006b0782 : MOV EDX,dword ptr [ECX + 0x4]
006b0785 : MOV EAX,dword ptr [EDI + 0x18]
006b0788 : MOV ECX,dword ptr [EAX + 0x4]
006b078b : MOV EAX,dword ptr [EBX + 0x2c]
006b078e : PUSH EDX
006b078f : MOV EDX,dword ptr [ESP + 0x24]
006b0793 : PUSH ECX
006b0794 : PUSH EDX
006b0795 : PUSH EBX
006b0796 : CALL EAX
006b0798 : ADD ESP,0x10
006b079b : MOV dword ptr [ESP + 0x10],EAX
006b079f : TEST EAX,EAX
006b07a1 : JNZ 0x006b0928
006b07a7 : MOV ECX,dword ptr [EDI + 0x1c]
006b07aa : MOV EDX,dword ptr [ECX + 0x8]
006b07ad : MOV EAX,dword ptr [EDI + 0x18]
006b07b0 : MOV ECX,dword ptr [EAX + 0x8]
006b07b3 : PUSH EDX
006b07b4 : MOV EDX,dword ptr [EBP + 0x2c]
006b07b7 : PUSH ECX
006b07b8 : PUSH 0x0
006b07ba : PUSH EBP
006b07bb : CALL EDX
006b07bd : ADD ESP,0x10
006b07c0 : MOV dword ptr [ESP + 0x10],EAX
006b07c4 : TEST EAX,EAX
006b07c6 : JNZ 0x006b0928
006b07cc : MOV EAX,dword ptr [EDI + 0x1c]
006b07cf : MOV ECX,dword ptr [EAX + 0xc]
006b07d2 : MOV EDX,dword ptr [EDI + 0x18]
006b07d5 : MOV EAX,dword ptr [EDX + 0xc]
006b07d8 : PUSH ECX
006b07d9 : MOV ECX,dword ptr [EBX + 0x2c]
006b07dc : PUSH EAX
006b07dd : PUSH 0x0
006b07df : PUSH EBX
006b07e0 : CALL ECX
006b07e2 : ADD ESP,0x10
006b07e5 : TEST EAX,EAX
006b07e7 : JNZ 0x006b0928
006b07ed : POP EDI
006b07ee : POP ESI
006b07ef : POP EBP
006b07f0 : POP EBX
006b07f1 : MOV ECX,dword ptr [ESP + 0x34]
006b07f5 : XOR ECX,ESP
006b07f7 : CALL 0x00633e6b
006b07fc : ADD ESP,0x38
006b07ff : RET
006b0800 : CMP byte ptr [ESP + 0x17],0x0
006b0805 : JNZ 0x006b092b
006b080b : MOV EDX,dword ptr [ESI + 0xb8]
006b0811 : LEA EBX,[ESI + 0x9c]
006b0817 : MOV byte ptr [ESP + 0x3c],0x8b
006b081c : MOV byte ptr [ESP + 0x3d],0xf7
006b0821 : MOV byte ptr [ESP + 0x3e],0xe1
006b0826 : MOV byte ptr [ESP + 0x3f],0xd
006b082b : MOV byte ptr [ESP + 0x40],0xe
006b0830 : MOV EAX,dword ptr [EDX]
006b0832 : MOV ECX,dword ptr [EDI]
006b0834 : MOV EDX,dword ptr [ESI + 0x130]
006b083a : PUSH EAX
006b083b : PUSH ECX
006b083c : LEA EDI,[ESI + 0x104]
006b0842 : PUSH 0x0
006b0844 : PUSH EDI
006b0845 : CALL EDX
006b0847 : ADD ESP,0x10
006b084a : MOV dword ptr [ESP + 0x10],EAX
006b084e : TEST EAX,EAX
006b0850 : JNZ 0x006b0928
006b0856 : MOV EAX,dword ptr [ESI + 0xec]
006b085c : MOV ECX,dword ptr [EAX]
006b085e : MOV EDX,dword ptr [ESI + 0xe8]
006b0864 : MOV EAX,dword ptr [EDX]
006b0866 : LEA EBP,[ESI + 0xd0]
006b086c : PUSH ECX
006b086d : MOV ECX,dword ptr [EDI + 0x2c]
006b0870 : PUSH EAX
006b0871 : PUSH 0x1
006b0873 : PUSH EDI
006b0874 : CALL ECX
006b0876 : ADD ESP,0x10
006b0879 : MOV dword ptr [ESP + 0x10],EAX
006b087d : TEST EAX,EAX
006b087f : JNZ 0x006b0928
006b0885 : MOV EDX,dword ptr [EBX + 0x2c]
006b0888 : PUSH 0x8
006b088a : PUSH 0xbe967c
006b088f : PUSH EAX
006b0890 : PUSH EBX
006b0891 : CALL EDX
006b0893 : ADD ESP,0x10
006b0896 : MOV dword ptr [ESP + 0x10],EAX
006b089a : TEST EAX,EAX
006b089c : JNZ 0x006b0928
006b08a2 : MOV ECX,dword ptr [EBP + 0x2c]
006b08a5 : PUSH 0x5
006b08a7 : LEA EAX,[ESP + 0x40]
006b08ab : PUSH EAX
006b08ac : PUSH 0x0
006b08ae : PUSH EBP
006b08af : CALL ECX
006b08b1 : ADD ESP,0x10
006b08b4 : MOV dword ptr [ESP + 0x10],EAX
006b08b8 : TEST EAX,EAX
006b08ba : JNZ 0x006b0928
006b08bc : MOV EDX,dword ptr [EDI + 0x1c]
006b08bf : MOV EAX,dword ptr [EDX]
006b08c1 : MOV ECX,dword ptr [EDI + 0x18]
006b08c4 : MOV EDX,dword ptr [ECX]
006b08c6 : MOV ECX,dword ptr [EBX + 0x2c]
006b08c9 : PUSH EAX
006b08ca : MOV EAX,dword ptr [ESP + 0x20]
006b08ce : PUSH EDX
006b08cf : PUSH EAX
006b08d0 : PUSH EBX
006b08d1 : CALL ECX
006b08d3 : ADD ESP,0x10
006b08d6 : MOV dword ptr [ESP + 0x10],EAX
006b08da : TEST EAX,EAX
006b08dc : JNZ 0x006b0928
006b08de : MOV EDX,dword ptr [EDI + 0x1c]
006b08e1 : MOV EAX,dword ptr [EDX + 0x4]
006b08e4 : MOV ECX,dword ptr [EDI + 0x18]
006b08e7 : MOV EDX,dword ptr [ECX + 0x4]
006b08ea : MOV EDI,dword ptr [ESP + 0x1c]
006b08ee : PUSH EAX
006b08ef : MOV EAX,dword ptr [EBP + 0x2c]
006b08f2 : PUSH EDX
006b08f3 : PUSH EDI
006b08f4 : PUSH EBP
006b08f5 : CALL EAX
006b08f7 : ADD ESP,0x10
006b08fa : TEST EAX,EAX
006b08fc : JNZ 0x006b0928
006b08fe : INC EDI
006b08ff : MOV dword ptr [ESI + 0x98],EDI
006b0905 : POP EDI
006b0906 : POP ESI
006b0907 : POP EBP
006b0908 : POP EBX
006b0909 : MOV ECX,dword ptr [ESP + 0x34]
006b090d : XOR ECX,ESP
006b090f : CALL 0x00633e6b
006b0914 : ADD ESP,0x38
006b0917 : RET
006b0918 : MOV EAX,0x3
006b091d : JMP 0x006b0928
006b091f : MOV EAX,0x3
006b0924 : MOV ESI,dword ptr [ESP + 0x18]
006b0928 : MOV dword ptr [ESI + 0xc],EAX
006b092b : MOV ECX,dword ptr [ESP + 0x44]
006b092f : POP EDI
006b0930 : POP ESI
006b0931 : POP EBP
006b0932 : POP EBX
006b0933 : XOR ECX,ESP
006b0935 : CALL 0x00633e6b
006b093a : ADD ESP,0x38
006b093d : RET

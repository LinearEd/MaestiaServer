PROGRAM  : Maestia.exe
FUNCTION : FUN_00a16a80
ENTRY    : 00a16a80
BODY     : [[00a16a80, 00a16bdc] [00a16be0, 00a16ec0]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a16a80(void)

{
  int iVar1;
  ushort uVar2;
  uint uVar3;
  int *piVar4;
  ushort *puVar5;
  wchar_t *pwVar6;
  int in_ECX;
  ushort *puVar7;
  int iVar8;
  wchar_t *pwVar9;
  ushort *puVar10;
  int iVar11;
  bool bVar12;
  char *pcVar13;
  undefined *puVar14;
  undefined4 uVar15;
  undefined1 local_cc [4];
  undefined2 local_c8;
  undefined4 local_b8;
  uint local_b4;
  undefined1 local_b0 [4];
  undefined2 local_ac;
  undefined4 local_9c;
  uint local_98;
  int local_94;
  int local_90;
  undefined2 local_88;
  undefined4 local_78;
  uint local_74;
  undefined4 local_6c;
  uint local_5c;
  uint local_58;
  undefined1 local_54 [64];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b2fd37;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (in_ECX == 0) {
    iVar11 = 0;
  }
  else {
    iVar11 = in_ECX + 4;
  }
  local_94 = in_ECX;
  local_14 = uVar3;
  piVar4 = (int *)FUN_007f91b0(*(undefined4 *)(DAT_0172491c + 0x90),iVar11,1);
  *(int **)(in_ECX + 8) = piVar4;
  if (piVar4 != (int *)0x0) {
    (**(code **)(*piVar4 + 0x14))(1,uVar3);
    (**(code **)(**(int **)(in_ECX + 8) + 0xc))(1);
    if (*(int **)(in_ECX + 8) != (int *)0x0) {
      (**(code **)(**(int **)(in_ECX + 8) + 0x2c))(0);
    }
    FUN_00406460(&DAT_00cbe254);
    local_8 = 0;
    FUN_00406460(L"LANGUAGE");
    local_8._0_1_ = 1;
    FUN_00406460(L"GAME");
    local_8._0_1_ = 2;
    FUN_008b78a0(DAT_017248c8,local_b0);
    local_8 = CONCAT31(local_8._1_3_,1);
    if (7 < local_b4) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_b4 = 7;
    local_b8 = 0;
    local_c8 = 0;
    local_8._0_1_ = 0;
    if (7 < local_98) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_ac = 0;
    local_98 = 7;
    local_9c = 0;
    local_90 = 0;
    iVar11 = 0;
    puVar5 = (ushort *)FUN_00404a10();
    do {
      puVar10 = (ushort *)(&PTR_DAT_00d71780)[iVar11];
      puVar7 = puVar5;
      do {
        uVar2 = *puVar7;
        bVar12 = uVar2 < *puVar10;
        if (uVar2 != *puVar10) {
LAB_00a16c16:
          iVar8 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
          goto LAB_00a16c1b;
        }
        if (uVar2 == 0) break;
        uVar2 = puVar7[1];
        bVar12 = uVar2 < puVar10[1];
        if (uVar2 != puVar10[1]) goto LAB_00a16c16;
        puVar7 = puVar7 + 2;
        puVar10 = puVar10 + 2;
      } while (uVar2 != 0);
      iVar8 = 0;
LAB_00a16c1b:
      iVar1 = iVar11;
    } while ((iVar8 != 0) && (iVar11 = iVar11 + 1, iVar1 = local_90, iVar11 < 10));
    local_90 = iVar1;
    if (*(char *)(DAT_017248c8 + 0x1d9) == '\0') {
      uVar15 = 2;
      puVar14 = &DAT_00cbe278;
      pcVar13 = "ChangeLanguageType";
    }
    else {
      uVar15 = 3;
      puVar14 = &DAT_00cbe290;
      pcVar13 = "ChangeLanguageType";
    }
    (**(code **)(**(int **)(local_94 + 8) + 4))(*(int **)(local_94 + 8),pcVar13,puVar14,uVar15);
    if (*(int *)(DAT_017248cc + 0x90) != 0) {
      local_90 = *(int *)(DAT_017248cc + 0x90);
    }
    (**(code **)(**(int **)(local_94 + 8) + 4))
              (*(int **)(local_94 + 8),"SetDefaultLang",&DAT_00cbe2a8,local_90);
    local_58 = 7;
    local_5c = 0;
    local_6c = (wchar_t *)((uint)local_6c._2_2_ << 0x10);
    FUN_00406360(&DAT_00cbe2bc,0);
    local_8._0_1_ = 3;
    local_c8 = 0;
    local_b4 = 7;
    local_b8 = 0;
    FUN_00406360(L"USERID",6);
    local_8._0_1_ = 4;
    local_98 = 7;
    local_9c = 0;
    local_ac = 0;
    FUN_00406360(L"AUTOLOGIN",9);
    local_8._0_1_ = 5;
    FUN_008b78a0(DAT_017248c8,local_cc);
    local_8 = CONCAT31(local_8._1_3_,4);
    if (7 < local_98) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_98 = 7;
    local_9c = 0;
    local_ac = 0;
    local_8 = CONCAT31(local_8._1_3_,3);
    if (7 < local_b4) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_b4 = 7;
    local_b8 = 0;
    local_c8 = 0;
    if ((DAT_00d6c963 != '\0') && (uVar2 = GetAsyncKeyState(0x10), (uVar2 & 0x8000) != 0)) {
      DAT_00d6c963 = '\0';
    }
    if ((DAT_00da98b8 != '\0') && (DAT_00d6c963 != '\0')) {
      uVar3 = local_5c;
      if (0xe < local_5c) {
        uVar3 = 0xf;
      }
      pwVar9 = local_6c;
      if (local_58 < 8) {
        pwVar9 = (wchar_t *)&local_6c;
      }
      pwVar6 = L"Error : ReadIni";
      for (; uVar3 != 0; uVar3 = uVar3 - 1) {
        if (*pwVar9 != *pwVar6) {
          if ((-(uint)((ushort)*pwVar9 < (ushort)*pwVar6) & 0xfffffffe) != 0xffffffff)
          goto LAB_00a16e2a;
          break;
        }
        pwVar9 = pwVar9 + 1;
        pwVar6 = pwVar6 + 1;
      }
      if ((local_5c < 0xf) || (local_5c != 0xf)) {
LAB_00a16e2a:
        FUN_0040f680(&DAT_00cbe304,local_90);
        (*(code *)**(undefined4 **)(local_94 + 4))(0,"SelectedLang",local_54);
      }
    }
    local_8 = local_8 & 0xffffff00;
    if (7 < local_58) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_58 = 7;
    local_5c = 0;
    local_6c = (wchar_t *)((uint)local_6c & 0xffff0000);
    local_8 = 0xffffffff;
    if (7 < local_74) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_74 = 7;
    local_78 = 0;
    local_88 = 0;
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a16a80 : PUSH EBP
00a16a81 : MOV EBP,ESP
00a16a83 : PUSH -0x1
00a16a85 : PUSH 0xb2fd37
00a16a8a : MOV EAX,FS:[0x0]
00a16a90 : PUSH EAX
00a16a91 : SUB ESP,0xbc
00a16a97 : MOV EAX,[0x00d66fa0]
00a16a9c : XOR EAX,EBP
00a16a9e : MOV dword ptr [EBP + -0x10],EAX
00a16aa1 : PUSH EBX
00a16aa2 : PUSH ESI
00a16aa3 : PUSH EDI
00a16aa4 : PUSH EAX
00a16aa5 : LEA EAX,[EBP + -0xc]
00a16aa8 : MOV FS:[0x0],EAX
00a16aae : MOV ESI,ECX
00a16ab0 : XOR EDI,EDI
00a16ab2 : MOV dword ptr [EBP + 0xffffff70],ESI
00a16ab8 : CMP ESI,EDI
00a16aba : JZ 0x00a16ac1
00a16abc : LEA ECX,[ESI + 0x4]
00a16abf : JMP 0x00a16ac3
00a16ac1 : XOR ECX,ECX
00a16ac3 : MOV EAX,[0x0172491c]
00a16ac8 : MOV EAX,dword ptr [EAX + 0x90]
00a16ace : PUSH 0x1
00a16ad0 : PUSH ECX
00a16ad1 : PUSH EAX
00a16ad2 : MOV ECX,0xcbe240
00a16ad7 : CALL 0x007f91b0
00a16adc : MOV dword ptr [ESI + 0x8],EAX
00a16adf : CMP EAX,EDI
00a16ae1 : JZ 0x00a16ea5
00a16ae7 : MOV EDX,dword ptr [EAX]
00a16ae9 : MOV ECX,EAX
00a16aeb : MOV EAX,dword ptr [EDX + 0x14]
00a16aee : PUSH 0x1
00a16af0 : CALL EAX
00a16af2 : MOV ECX,dword ptr [ESI + 0x8]
00a16af5 : MOV EDX,dword ptr [ECX]
00a16af7 : MOV EAX,dword ptr [EDX + 0xc]
00a16afa : PUSH 0x1
00a16afc : CALL EAX
00a16afe : MOV ECX,dword ptr [ESI + 0x8]
00a16b01 : CMP ECX,EDI
00a16b03 : JZ 0x00a16b0d
00a16b05 : MOV EDX,dword ptr [ECX]
00a16b07 : MOV EAX,dword ptr [EDX + 0x2c]
00a16b0a : PUSH EDI
00a16b0b : CALL EAX
00a16b0d : PUSH 0xcbe254
00a16b12 : LEA ECX,[EBP + 0xffffff78]
00a16b18 : CALL 0x00406460
00a16b1d : MOV dword ptr [EBP + -0x4],EDI
00a16b20 : PUSH 0xcbe258
00a16b25 : LEA ECX,[EBP + 0xffffff54]
00a16b2b : CALL 0x00406460
00a16b30 : MOV byte ptr [EBP + -0x4],0x1
00a16b34 : PUSH 0xcbe26c
00a16b39 : LEA ECX,[EBP + 0xffffff38]
00a16b3f : CALL 0x00406460
00a16b44 : MOV byte ptr [EBP + -0x4],0x2
00a16b48 : MOV EDX,dword ptr [0x017248c8]
00a16b4e : LEA ECX,[EBP + 0xffffff54]
00a16b54 : PUSH ECX
00a16b55 : PUSH EDX
00a16b56 : LEA ECX,[EBP + 0xffffff78]
00a16b5c : LEA EDX,[EBP + 0xffffff38]
00a16b62 : CALL 0x008b78a0
00a16b67 : MOV byte ptr [EBP + -0x4],0x1
00a16b6b : MOV EBX,0x8
00a16b70 : CMP dword ptr [EBP + 0xffffff50],EBX
00a16b76 : JC 0x00a16b83
00a16b78 : MOV ECX,dword ptr [EBP + 0xffffff3c]
00a16b7e : CALL 0x006f04e0
00a16b83 : XOR EAX,EAX
00a16b85 : MOV ESI,0x7
00a16b8a : MOV dword ptr [EBP + 0xffffff50],ESI
00a16b90 : MOV dword ptr [EBP + 0xffffff4c],EDI
00a16b96 : MOV word ptr [EBP + 0xffffff3c],AX
00a16b9d : MOV byte ptr [EBP + -0x4],AL
00a16ba0 : CMP dword ptr [EBP + 0xffffff6c],EBX
00a16ba6 : JC 0x00a16bb3
00a16ba8 : MOV ECX,dword ptr [EBP + 0xffffff58]
00a16bae : CALL 0x006f04e0
00a16bb3 : XOR ECX,ECX
00a16bb5 : MOV word ptr [EBP + 0xffffff58],CX
00a16bbc : LEA ECX,[EBP + 0xffffff78]
00a16bc2 : MOV dword ptr [EBP + 0xffffff6c],ESI
00a16bc8 : MOV dword ptr [EBP + 0xffffff68],EDI
00a16bce : MOV dword ptr [EBP + 0xffffff74],EDI
00a16bd4 : XOR EBX,EBX
00a16bd6 : CALL 0x00404a10
00a16bdb : JMP 0x00a16be0
00a16be0 : MOV EDX,dword ptr [EBX*0x4 + 0xd71780]
00a16be7 : MOV ECX,EAX
00a16be9 : LEA ESP,[ESP]
00a16bf0 : MOV SI,word ptr [ECX]
00a16bf3 : CMP SI,word ptr [EDX]
00a16bf6 : JNZ 0x00a16c16
00a16bf8 : CMP SI,DI
00a16bfb : JZ 0x00a16c12
00a16bfd : MOV SI,word ptr [ECX + 0x2]
00a16c01 : CMP SI,word ptr [EDX + 0x2]
00a16c05 : JNZ 0x00a16c16
00a16c07 : ADD ECX,0x4
00a16c0a : ADD EDX,0x4
00a16c0d : CMP SI,DI
00a16c10 : JNZ 0x00a16bf0
00a16c12 : XOR ECX,ECX
00a16c14 : JMP 0x00a16c1b
00a16c16 : SBB ECX,ECX
00a16c18 : SBB ECX,-0x1
00a16c1b : CMP ECX,EDI
00a16c1d : JZ 0x00a16c27
00a16c1f : INC EBX
00a16c20 : CMP EBX,0xa
00a16c23 : JL 0x00a16be0
00a16c25 : JMP 0x00a16c2d
00a16c27 : MOV dword ptr [EBP + 0xffffff74],EBX
00a16c2d : MOV EAX,dword ptr [EBP + 0xffffff70]
00a16c33 : MOV EDX,dword ptr [0x017248c8]
00a16c39 : MOV EAX,dword ptr [EAX + 0x8]
00a16c3c : MOV ECX,dword ptr [EAX]
00a16c3e : CMP byte ptr [EDX + 0x1d9],0x0
00a16c45 : MOV EDX,dword ptr [ECX + 0x4]
00a16c48 : MOV EBX,0x3
00a16c4d : JNZ 0x00a16c5d
00a16c4f : PUSH 0x2
00a16c51 : PUSH 0xcbe278
00a16c56 : PUSH 0xcbe27c
00a16c5b : JMP 0x00a16c68
00a16c5d : PUSH EBX
00a16c5e : PUSH 0xcbe290
00a16c63 : PUSH 0xcbe294
00a16c68 : PUSH EAX
00a16c69 : CALL EDX
00a16c6b : MOV EAX,[0x017248cc]
00a16c70 : MOV EAX,dword ptr [EAX + 0x90]
00a16c76 : ADD ESP,0x10
00a16c79 : CMP EAX,EDI
00a16c7b : JZ 0x00a16c83
00a16c7d : MOV dword ptr [EBP + 0xffffff74],EAX
00a16c83 : MOV ECX,dword ptr [EBP + 0xffffff70]
00a16c89 : MOV EAX,dword ptr [ECX + 0x8]
00a16c8c : MOV ECX,dword ptr [EBP + 0xffffff74]
00a16c92 : MOV EDX,dword ptr [EAX]
00a16c94 : MOV EDX,dword ptr [EDX + 0x4]
00a16c97 : PUSH ECX
00a16c98 : PUSH 0xcbe2a8
00a16c9d : PUSH 0xcbe2ac
00a16ca2 : PUSH EAX
00a16ca3 : CALL EDX
00a16ca5 : ADD ESP,0x10
00a16ca8 : PUSH EDI
00a16ca9 : XOR EAX,EAX
00a16cab : MOV ESI,0x7
00a16cb0 : PUSH 0xcbe2bc
00a16cb5 : LEA ECX,[EBP + -0x6c]
00a16cb8 : MOV dword ptr [EBP + -0x54],ESI
00a16cbb : MOV dword ptr [EBP + -0x58],EDI
00a16cbe : MOV word ptr [EBP + -0x68],AX
00a16cc2 : CALL 0x00406360
00a16cc7 : MOV byte ptr [EBP + -0x4],BL
00a16cca : XOR ECX,ECX
00a16ccc : PUSH 0x6
00a16cce : MOV word ptr [EBP + 0xffffff3c],CX
00a16cd5 : PUSH 0xcbe2c0
00a16cda : LEA ECX,[EBP + 0xffffff38]
00a16ce0 : MOV dword ptr [EBP + 0xffffff50],ESI
00a16ce6 : MOV dword ptr [EBP + 0xffffff4c],EDI
00a16cec : CALL 0x00406360
00a16cf1 : MOV byte ptr [EBP + -0x4],0x4
00a16cf5 : PUSH 0x9
00a16cf7 : XOR EDX,EDX
00a16cf9 : PUSH 0xcbe2d0
00a16cfe : LEA ECX,[EBP + 0xffffff54]
00a16d04 : MOV dword ptr [EBP + 0xffffff6c],ESI
00a16d0a : MOV dword ptr [EBP + 0xffffff68],EDI
00a16d10 : MOV word ptr [EBP + 0xffffff58],DX
00a16d17 : CALL 0x00406360
00a16d1c : MOV byte ptr [EBP + -0x4],0x5
00a16d20 : MOV ECX,dword ptr [0x017248c8]
00a16d26 : LEA EAX,[EBP + 0xffffff38]
00a16d2c : PUSH EAX
00a16d2d : PUSH ECX
00a16d2e : LEA ECX,[EBP + -0x6c]
00a16d31 : LEA EDX,[EBP + 0xffffff54]
00a16d37 : CALL 0x008b78a0
00a16d3c : MOV byte ptr [EBP + -0x4],0x4
00a16d40 : CMP dword ptr [EBP + 0xffffff6c],0x8
00a16d47 : JC 0x00a16d54
00a16d49 : MOV ECX,dword ptr [EBP + 0xffffff58]
00a16d4f : CALL 0x006f04e0
00a16d54 : XOR EDX,EDX
00a16d56 : MOV dword ptr [EBP + 0xffffff6c],ESI
00a16d5c : MOV dword ptr [EBP + 0xffffff68],EDI
00a16d62 : MOV word ptr [EBP + 0xffffff58],DX
00a16d69 : MOV byte ptr [EBP + -0x4],BL
00a16d6c : CMP dword ptr [EBP + 0xffffff50],0x8
00a16d73 : JC 0x00a16d80
00a16d75 : MOV ECX,dword ptr [EBP + 0xffffff3c]
00a16d7b : CALL 0x006f04e0
00a16d80 : XOR EAX,EAX
00a16d82 : MOV dword ptr [EBP + 0xffffff50],ESI
00a16d88 : MOV dword ptr [EBP + 0xffffff4c],EDI
00a16d8e : MOV word ptr [EBP + 0xffffff3c],AX
00a16d95 : CMP byte ptr [0x00d6c963],AL
00a16d9b : JZ 0x00a16db6
00a16d9d : PUSH 0x10
00a16d9f : CALL dword ptr [0x00b8542c]
00a16da5 : MOV ECX,0x8000
00a16daa : TEST CX,AX
00a16dad : JZ 0x00a16db6
00a16daf : MOV byte ptr [0x00d6c963],0x0
00a16db6 : CMP byte ptr [0x00da98b8],0x0
00a16dbd : JZ 0x00a16e60
00a16dc3 : CMP byte ptr [0x00d6c963],0x0
00a16dca : JZ 0x00a16e60
00a16dd0 : MOV ESI,dword ptr [EBP + -0x58]
00a16dd3 : MOV EDX,ESI
00a16dd5 : CMP ESI,0xf
00a16dd8 : JC 0x00a16ddf
00a16dda : MOV EDX,0xf
00a16ddf : CMP dword ptr [EBP + -0x54],0x8
00a16de3 : MOV ECX,dword ptr [EBP + -0x68]
00a16de6 : JNC 0x00a16deb
00a16de8 : LEA ECX,[EBP + -0x68]
00a16deb : MOV EAX,0xcbe2e4
00a16df0 : CMP EDX,EDI
00a16df2 : JBE 0x00a16e19
00a16df4 : MOV BX,word ptr [ECX]
00a16df7 : CMP BX,word ptr [EAX]
00a16dfa : JNZ 0x00a16e09
00a16dfc : ADD ECX,0x2
00a16dff : ADD EAX,0x2
00a16e02 : SUB EDX,0x1
00a16e05 : JNZ 0x00a16df4
00a16e07 : JMP 0x00a16e19
00a16e09 : MOV DX,BX
00a16e0c : CMP DX,word ptr [EAX]
00a16e0f : SBB EAX,EAX
00a16e11 : AND EAX,0xfffffffe
00a16e14 : INC EAX
00a16e15 : CMP EAX,EDI
00a16e17 : JNZ 0x00a16e2a
00a16e19 : CMP ESI,0xf
00a16e1c : JC 0x00a16e2a
00a16e1e : XOR EAX,EAX
00a16e20 : CMP ESI,0xf
00a16e23 : SETNZ AL
00a16e26 : CMP EAX,EDI
00a16e28 : JZ 0x00a16e5b
00a16e2a : MOV EAX,dword ptr [EBP + 0xffffff74]
00a16e30 : PUSH EAX
00a16e31 : PUSH 0xcbe304
00a16e36 : LEA EDX,[EBP + -0x50]
00a16e39 : CALL 0x0040f680
00a16e3e : MOV ECX,dword ptr [EBP + 0xffffff70]
00a16e44 : MOV EDX,dword ptr [ECX + 0x4]
00a16e47 : MOV EDX,dword ptr [EDX]
00a16e49 : ADD ESP,0x8
00a16e4c : LEA EAX,[EBP + -0x50]
00a16e4f : PUSH EAX
00a16e50 : ADD ECX,0x4
00a16e53 : PUSH 0xcbe308
00a16e58 : PUSH EDI
00a16e59 : CALL EDX
00a16e5b : MOV ESI,0x7
00a16e60 : MOV byte ptr [EBP + -0x4],0x0
00a16e64 : CMP dword ptr [EBP + -0x54],0x8
00a16e68 : JC 0x00a16e72
00a16e6a : MOV ECX,dword ptr [EBP + -0x68]
00a16e6d : CALL 0x006f04e0
00a16e72 : XOR EAX,EAX
00a16e74 : MOV dword ptr [EBP + -0x54],ESI
00a16e77 : MOV dword ptr [EBP + -0x58],EDI
00a16e7a : MOV word ptr [EBP + -0x68],AX
00a16e7e : MOV dword ptr [EBP + -0x4],0xffffffff
00a16e85 : CMP dword ptr [EBP + -0x70],0x8
00a16e89 : JC 0x00a16e96
00a16e8b : MOV ECX,dword ptr [EBP + 0xffffff7c]
00a16e91 : CALL 0x006f04e0
00a16e96 : XOR ECX,ECX
00a16e98 : MOV dword ptr [EBP + -0x70],ESI
00a16e9b : MOV dword ptr [EBP + -0x74],EDI
00a16e9e : MOV word ptr [EBP + 0xffffff7c],CX
00a16ea5 : MOV ECX,dword ptr [EBP + -0xc]
00a16ea8 : MOV dword ptr FS:[0x0],ECX
00a16eaf : POP ECX
00a16eb0 : POP EDI
00a16eb1 : POP ESI
00a16eb2 : POP EBX
00a16eb3 : MOV ECX,dword ptr [EBP + -0x10]
00a16eb6 : XOR ECX,EBP
00a16eb8 : CALL 0x00633e6b
00a16ebd : MOV ESP,EBP
00a16ebf : POP EBP
00a16ec0 : RET

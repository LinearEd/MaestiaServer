PROGRAM  : Maestia.exe
FUNCTION : FUN_007d5180
ENTRY    : 007d5180
BODY     : [[007d5180, 007d5289]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007d5180(void)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int *piVar3;
  uint uVar4;
  int iVar5;
  int in_ECX;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b0f2a5;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(int *)(in_ECX + 8) != 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  local_8 = 0;
  puVar1 = *(undefined4 **)(in_ECX + 0x188);
  for (puVar2 = (undefined4 *)*puVar1; puVar2 != puVar1; puVar2 = (undefined4 *)*puVar2) {
    piVar3 = (int *)puVar2[9];
    iVar5 = (**(code **)(*piVar3 + 4))(uVar4);
    if ((iVar5 == 2) || (iVar5 = (**(code **)(*piVar3 + 4))(), iVar5 == 1)) {
      *(undefined1 *)((int)piVar3 + 0x1b7) = 1;
    }
  }
  local_8 = 0xffffffff;
  if (*(int *)(in_ECX + 8) != 0) {
    LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  if (*(int *)(in_ECX + 8) != 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  local_8 = 1;
  puVar1 = *(undefined4 **)(in_ECX + 0x38);
  for (puVar2 = (undefined4 *)*puVar1; puVar2 != puVar1; puVar2 = (undefined4 *)*puVar2) {
    iVar5 = (**(code **)(*(int *)puVar2[9] + 0x1c))();
    if (iVar5 - 2U < 8) {
      FUN_007d5180();
    }
  }
  local_8 = 0xffffffff;
  if (*(int *)(in_ECX + 8) != 0) {
    LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
007d5180 : PUSH EBP
007d5181 : MOV EBP,ESP
007d5183 : PUSH -0x1
007d5185 : PUSH 0xb0f2a5
007d518a : MOV EAX,FS:[0x0]
007d5190 : PUSH EAX
007d5191 : SUB ESP,0x8
007d5194 : PUSH EBX
007d5195 : PUSH ESI
007d5196 : PUSH EDI
007d5197 : MOV EAX,[0x00d66fa0]
007d519c : XOR EAX,EBP
007d519e : PUSH EAX
007d519f : LEA EAX,[EBP + -0xc]
007d51a2 : MOV FS:[0x0],EAX
007d51a8 : MOV EBX,ECX
007d51aa : MOV EAX,dword ptr [EBX + 0x8]
007d51ad : MOV dword ptr [EBP + -0x14],EBX
007d51b0 : TEST EAX,EAX
007d51b2 : JZ 0x007d51be
007d51b4 : ADD EAX,0x4
007d51b7 : PUSH EAX
007d51b8 : CALL dword ptr [0x00b85118]
007d51be : MOV dword ptr [EBP + -0x4],0x0
007d51c5 : MOV EAX,dword ptr [EBX + 0x188]
007d51cb : MOV EDI,dword ptr [EAX]
007d51cd : MOV dword ptr [EBP + -0x10],EAX
007d51d0 : CMP EDI,EAX
007d51d2 : JZ 0x007d5201
007d51d4 : MOV ESI,dword ptr [EDI + 0x24]
007d51d7 : MOV EAX,dword ptr [ESI]
007d51d9 : MOV EDX,dword ptr [EAX + 0x4]
007d51dc : MOV ECX,ESI
007d51de : CALL EDX
007d51e0 : CMP EAX,0x2
007d51e3 : JZ 0x007d51f3
007d51e5 : MOV EAX,dword ptr [ESI]
007d51e7 : MOV EDX,dword ptr [EAX + 0x4]
007d51ea : MOV ECX,ESI
007d51ec : CALL EDX
007d51ee : CMP EAX,0x1
007d51f1 : JNZ 0x007d51fa
007d51f3 : MOV byte ptr [ESI + 0x1b7],0x1
007d51fa : MOV EDI,dword ptr [EDI]
007d51fc : CMP EDI,dword ptr [EBP + -0x10]
007d51ff : JNZ 0x007d51d4
007d5201 : MOV dword ptr [EBP + -0x4],0xffffffff
007d5208 : MOV EAX,dword ptr [EBX + 0x8]
007d520b : TEST EAX,EAX
007d520d : JZ 0x007d5219
007d520f : ADD EAX,0x4
007d5212 : PUSH EAX
007d5213 : CALL dword ptr [0x00b8511c]
007d5219 : MOV EAX,dword ptr [EBX + 0x8]
007d521c : MOV dword ptr [EBP + -0x14],EBX
007d521f : TEST EAX,EAX
007d5221 : JZ 0x007d522d
007d5223 : ADD EAX,0x4
007d5226 : PUSH EAX
007d5227 : CALL dword ptr [0x00b85118]
007d522d : MOV dword ptr [EBP + -0x4],0x1
007d5234 : MOV EDI,dword ptr [EBX + 0x38]
007d5237 : MOV ESI,dword ptr [EDI]
007d5239 : CMP ESI,EDI
007d523b : JZ 0x007d5260
007d523d : LEA ECX,[ECX]
007d5240 : MOV ECX,dword ptr [ESI + 0x24]
007d5243 : MOV EAX,dword ptr [ECX]
007d5245 : MOV EDX,dword ptr [EAX + 0x1c]
007d5248 : CALL EDX
007d524a : ADD EAX,-0x2
007d524d : CMP EAX,0x7
007d5250 : JA 0x007d525a
007d5252 : MOV ECX,dword ptr [ESI + 0x24]
007d5255 : CALL 0x007d5180
007d525a : MOV ESI,dword ptr [ESI]
007d525c : CMP ESI,EDI
007d525e : JNZ 0x007d5240
007d5260 : MOV dword ptr [EBP + -0x4],0xffffffff
007d5267 : MOV EBX,dword ptr [EBX + 0x8]
007d526a : TEST EBX,EBX
007d526c : JZ 0x007d5278
007d526e : ADD EBX,0x4
007d5271 : PUSH EBX
007d5272 : CALL dword ptr [0x00b8511c]
007d5278 : MOV ECX,dword ptr [EBP + -0xc]
007d527b : MOV dword ptr FS:[0x0],ECX
007d5282 : POP ECX
007d5283 : POP EDI
007d5284 : POP ESI
007d5285 : POP EBX
007d5286 : MOV ESP,EBP
007d5288 : POP EBP
007d5289 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_006a6000
ENTRY    : 006a6000
BODY     : [[006a6000, 006a6233]]

============================================================
DECOMPILED C CODE
============================================================

undefined4
FUN_006a6000(uint *param_1,byte *param_2,uint param_3,uint *param_4,uint *param_5,uint *param_6,
            uint *param_7,uint *param_8,uint *param_9)

{
  byte bVar1;
  byte bVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte *pbVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint local_4;
  
  pbVar3 = (byte *)*param_1;
  pbVar5 = pbVar3 + 1;
  if (param_2 < pbVar5) {
    return 8;
  }
  bVar1 = *pbVar3;
  uVar6 = 0;
  uVar8 = 0;
  uVar9 = 0;
  local_4 = 0;
  pbVar4 = pbVar5;
  switch(bVar1 & 3) {
  case 0:
    pbVar4 = pbVar3 + 2;
    if (param_2 < pbVar4) {
      return 8;
    }
    uVar6 = (int)(char)*pbVar5 >> 4;
    uVar8 = (int)(char)(*pbVar5 << 4) >> 4;
    break;
  case 1:
    if (param_2 < pbVar3 + 3) {
      return 8;
    }
    uVar6 = (uint)(char)*pbVar5;
    uVar8 = (uint)(char)pbVar3[2];
    pbVar4 = pbVar3 + 3;
    break;
  case 2:
    if (param_2 < pbVar3 + 5) {
      return 8;
    }
    uVar6 = (int)(short)((short)(char)*pbVar5 << 8) | (uint)pbVar3[2];
    pbVar4 = pbVar3 + 5;
    uVar8 = (uint)(short)((short)(char)pbVar3[3] << 8);
    goto LAB_006a60e3;
  case 3:
    if (param_2 < pbVar3 + 7) {
      return 8;
    }
    uVar6 = (uint)CONCAT21(CONCAT11(*pbVar5,pbVar3[2]),pbVar3[3]);
    pbVar4 = pbVar3 + 7;
    uVar8 = (int)CONCAT11(pbVar3[4],pbVar3[5]) << 8;
LAB_006a60e3:
    uVar8 = uVar8 | pbVar4[-1];
  }
  switch(bVar1 >> 2 & 3) {
  case 0:
    uVar9 = 0;
    local_4 = 0;
    break;
  case 1:
    if (param_2 < pbVar4 + 1) {
      return 8;
    }
    uVar9 = (int)(char)*pbVar4 >> 4 & 0xf;
    local_4 = (int)(char)*pbVar4 & 0xf;
    pbVar4 = pbVar4 + 1;
    break;
  case 2:
    if (param_2 < pbVar4 + 2) {
      return 8;
    }
    uVar9 = (uint)*pbVar4;
    local_4 = (uint)pbVar4[1];
    pbVar4 = pbVar4 + 2;
    break;
  case 3:
    if (param_2 < pbVar4 + 4) {
      return 8;
    }
    uVar9 = (uint)CONCAT11(*pbVar4,pbVar4[1]);
    local_4 = (uint)CONCAT11(pbVar4[2],pbVar4[3]);
    pbVar4 = pbVar4 + 4;
  }
  uVar7 = 0;
  switch(bVar1 >> 4 & 3) {
  case 0:
    uVar7 = param_3;
    break;
  case 1:
    if (param_2 < pbVar4 + 1) {
      return 8;
    }
    bVar2 = *pbVar4;
    pbVar4 = pbVar4 + 1;
    uVar7 = (int)(char)bVar2 << 8;
    break;
  case 2:
    pbVar5 = pbVar4 + 2;
    if (param_2 < pbVar5) {
      return 8;
    }
    uVar7 = (uint)(short)((short)(char)*pbVar4 << 8);
    goto LAB_006a61f3;
  case 3:
    pbVar5 = pbVar4 + 3;
    if (param_2 < pbVar5) {
      return 8;
    }
    uVar7 = (int)CONCAT11(*pbVar4,pbVar4[1]) << 8;
LAB_006a61f3:
    pbVar4 = pbVar5;
    uVar7 = uVar7 | pbVar5[-1];
  }
  *param_4 = uVar6;
  *param_5 = uVar8;
  *param_6 = uVar9;
  *param_7 = local_4;
  *param_8 = uVar7;
  *param_9 = (uint)(bVar1 >> 6);
  *param_1 = (uint)pbVar4;
  return 0;
}



============================================================
DISASSEMBLY
============================================================
006a6000 : MOV EAX,dword ptr [ESP + 0x4]
006a6004 : MOV EAX,dword ptr [EAX]
006a6006 : SUB ESP,0x8
006a6009 : PUSH EBX
006a600a : PUSH EBP
006a600b : LEA ECX,[EAX + 0x1]
006a600e : PUSH ESI
006a600f : XOR EBP,EBP
006a6011 : PUSH EDI
006a6012 : CMP ECX,dword ptr [ESP + 0x20]
006a6016 : JA 0x006a61d6
006a601c : MOV AL,byte ptr [EAX]
006a601e : MOVZX EBX,AL
006a6021 : AND EBX,0x3
006a6024 : XOR EDX,EDX
006a6026 : XOR ESI,ESI
006a6028 : XOR EDI,EDI
006a602a : MOV dword ptr [ESP + 0x14],EBP
006a602e : CMP EBX,0x3
006a6031 : JA 0x006a60e9
006a6037 : JMP dword ptr [EBX*0x4 + 0x6a6234]
006a603e : LEA EDX,[ECX + 0x1]
006a6041 : CMP EDX,dword ptr [ESP + 0x20]
006a6045 : JA 0x006a61d6
006a604b : MOV BL,byte ptr [ECX]
006a604d : MOV ECX,EDX
006a604f : MOVSX EDX,BL
006a6052 : SHL BL,0x4
006a6055 : MOVSX ESI,BL
006a6058 : SAR EDX,0x4
006a605b : SAR ESI,0x4
006a605e : JMP 0x006a60e9
006a6063 : LEA EDX,[ECX + 0x2]
006a6066 : CMP EDX,dword ptr [ESP + 0x20]
006a606a : JA 0x006a61d6
006a6070 : MOVSX EDX,byte ptr [ECX]
006a6073 : MOVSX ESI,byte ptr [ECX + 0x1]
006a6077 : INC ECX
006a6078 : INC ECX
006a6079 : JMP 0x006a60e9
006a607b : LEA EDX,[ECX + 0x4]
006a607e : CMP EDX,dword ptr [ESP + 0x20]
006a6082 : JA 0x006a61d6
006a6088 : MOVSX DX,byte ptr [ECX]
006a608c : MOVZX ESI,byte ptr [ECX + 0x1]
006a6090 : ADD ECX,0x2
006a6093 : SHL DX,0x8
006a6097 : MOVSX EDX,DX
006a609a : OR EDX,ESI
006a609c : MOVSX SI,byte ptr [ECX]
006a60a0 : ADD ECX,0x2
006a60a3 : SHL SI,0x8
006a60a7 : MOVSX ESI,SI
006a60aa : JMP 0x006a60e3
006a60ac : LEA EDX,[ECX + 0x6]
006a60af : CMP EDX,dword ptr [ESP + 0x20]
006a60b3 : JA 0x006a61d6
006a60b9 : MOVSX EDX,byte ptr [ECX]
006a60bc : MOVZX ESI,byte ptr [ECX + 0x1]
006a60c0 : ADD ECX,0x3
006a60c3 : MOVZX EBX,byte ptr [ECX + 0x1]
006a60c7 : SHL EDX,0x8
006a60ca : OR EDX,ESI
006a60cc : MOVZX ESI,byte ptr [ECX + -0x1]
006a60d0 : SHL EDX,0x8
006a60d3 : OR EDX,ESI
006a60d5 : MOVSX ESI,byte ptr [ECX]
006a60d8 : ADD ECX,0x3
006a60db : SHL ESI,0x8
006a60de : OR ESI,EBX
006a60e0 : SHL ESI,0x8
006a60e3 : MOVZX EBX,byte ptr [ECX + -0x1]
006a60e7 : OR ESI,EBX
006a60e9 : SHR AL,0x2
006a60ec : MOVZX EBX,AL
006a60ef : AND EBX,0x3
006a60f2 : MOV byte ptr [ESP + 0x13],AL
006a60f6 : CMP EBX,0x3
006a60f9 : JA 0x006a6186
006a60ff : JMP dword ptr [EBX*0x4 + 0x6a6244]
006a6106 : XOR EDI,EDI
006a6108 : MOV dword ptr [ESP + 0x14],EDI
006a610c : JMP 0x006a6186
006a610e : LEA EDI,[ECX + 0x1]
006a6111 : CMP EDI,dword ptr [ESP + 0x20]
006a6115 : JA 0x006a61d6
006a611b : MOV BL,byte ptr [ECX]
006a611d : MOVSX EBX,BL
006a6120 : MOV ECX,EDI
006a6122 : MOV EDI,EBX
006a6124 : SAR EDI,0x4
006a6127 : AND EDI,0xf
006a612a : AND EBX,0xf
006a612d : MOV dword ptr [ESP + 0x14],EBX
006a6131 : JMP 0x006a6186
006a6133 : LEA EDI,[ECX + 0x2]
006a6136 : CMP EDI,dword ptr [ESP + 0x20]
006a613a : JA 0x006a61d6
006a6140 : MOVZX EDI,byte ptr [ECX]
006a6143 : MOVZX EBX,byte ptr [ECX + 0x1]
006a6147 : INC ECX
006a6148 : MOV dword ptr [ESP + 0x14],EBX
006a614c : INC ECX
006a614d : JMP 0x006a6186
006a614f : LEA EAX,[ECX + 0x4]
006a6152 : CMP EAX,dword ptr [ESP + 0x20]
006a6156 : JA 0x006a61d6
006a6158 : MOVZX EAX,byte ptr [ECX]
006a615b : ADD ECX,0x2
006a615e : MOVZX EBX,byte ptr [ECX + 0x1]
006a6162 : SHL AX,0x8
006a6166 : MOVZX EDI,AX
006a6169 : MOVZX EAX,byte ptr [ECX + -0x1]
006a616d : OR EDI,EAX
006a616f : MOVZX EAX,byte ptr [ECX]
006a6172 : ADD ECX,0x2
006a6175 : SHL AX,0x8
006a6179 : MOVZX EAX,AX
006a617c : OR EAX,EBX
006a617e : MOV dword ptr [ESP + 0x14],EAX
006a6182 : MOV AL,byte ptr [ESP + 0x13]
006a6186 : SHR AL,0x2
006a6189 : MOVZX EBX,AL
006a618c : MOV EAX,EBX
006a618e : AND EAX,0x3
006a6191 : CMP EAX,0x3
006a6194 : JA 0x006a61f9
006a6196 : JMP dword ptr [EAX*0x4 + 0x6a6254]
006a619d : MOV EBP,dword ptr [ESP + 0x24]
006a61a1 : JMP 0x006a61f9
006a61a3 : LEA EAX,[ECX + 0x1]
006a61a6 : CMP EAX,dword ptr [ESP + 0x20]
006a61aa : JA 0x006a61d6
006a61ac : MOVSX EBP,byte ptr [ECX]
006a61af : SHL EBP,0x8
006a61b2 : MOV ECX,EAX
006a61b4 : JMP 0x006a61f9
006a61b6 : ADD ECX,0x2
006a61b9 : CMP ECX,dword ptr [ESP + 0x20]
006a61bd : JA 0x006a61d6
006a61bf : MOVSX AX,byte ptr [ECX + -0x2]
006a61c4 : SHL AX,0x8
006a61c8 : MOVSX EBP,AX
006a61cb : JMP 0x006a61f3
006a61cd : ADD ECX,0x3
006a61d0 : CMP ECX,dword ptr [ESP + 0x20]
006a61d4 : JBE 0x006a61e3
006a61d6 : POP EDI
006a61d7 : POP ESI
006a61d8 : POP EBP
006a61d9 : MOV EAX,0x8
006a61de : POP EBX
006a61df : ADD ESP,0x8
006a61e2 : RET
006a61e3 : MOVSX EBP,byte ptr [ECX + -0x3]
006a61e7 : MOVZX EAX,byte ptr [ECX + -0x2]
006a61eb : SHL EBP,0x8
006a61ee : OR EBP,EAX
006a61f0 : SHL EBP,0x8
006a61f3 : MOVZX EAX,byte ptr [ECX + -0x1]
006a61f7 : OR EBP,EAX
006a61f9 : MOV EAX,dword ptr [ESP + 0x28]
006a61fd : MOV dword ptr [EAX],EDX
006a61ff : MOV EDX,dword ptr [ESP + 0x2c]
006a6203 : MOV EAX,dword ptr [ESP + 0x30]
006a6207 : MOV dword ptr [EDX],ESI
006a6209 : MOV EDX,dword ptr [ESP + 0x34]
006a620d : MOV dword ptr [EAX],EDI
006a620f : MOV EAX,dword ptr [ESP + 0x14]
006a6213 : MOV dword ptr [EDX],EAX
006a6215 : MOV EDX,dword ptr [ESP + 0x38]
006a6219 : MOV EAX,dword ptr [ESP + 0x3c]
006a621d : POP EDI
006a621e : MOV dword ptr [EDX],EBP
006a6220 : MOV EDX,dword ptr [ESP + 0x18]
006a6224 : SHR EBX,0x2
006a6227 : POP ESI
006a6228 : MOV dword ptr [EAX],EBX
006a622a : POP EBP
006a622b : MOV dword ptr [EDX],ECX
006a622d : XOR EAX,EAX
006a622f : POP EBX
006a6230 : ADD ESP,0x8
006a6233 : RET

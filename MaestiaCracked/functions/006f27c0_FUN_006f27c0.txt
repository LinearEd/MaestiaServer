PROGRAM  : Maestia.exe
FUNCTION : FUN_006f27c0
ENTRY    : 006f27c0
BODY     : [[006f27c0, 006f285d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006f27c0(void)

{
  int unaff_ESI;
  undefined4 unaff_EDI;
  LPCRITICAL_SECTION local_24;
  char *local_20;
  undefined4 local_1c;
  int local_18;
  undefined4 local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b0cf21;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_24 = (LPCRITICAL_SECTION)(unaff_ESI + 0xe7c);
  local_18 = 0;
  local_20 = ".\\AvSocket.cpp";
  local_1c = 0x64a;
  local_14 = 1;
  FUN_006ef1a0(&local_24);
  if (*(undefined4 **)(unaff_ESI + 0xeb4) == (undefined4 *)0x0) {
    *(undefined4 *)(unaff_ESI + 0xeb0) = unaff_EDI;
  }
  else {
    **(undefined4 **)(unaff_ESI + 0xeb4) = unaff_EDI;
  }
  *(undefined4 *)(unaff_ESI + 0xeb4) = unaff_EDI;
  *(undefined4 *)(unaff_ESI + 0xebc) = 0;
  local_8 = 0xffffffff;
  if (local_18 != 0) {
    LeaveCriticalSection(local_24);
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
006f27c0 : PUSH EBP
006f27c1 : MOV EBP,ESP
006f27c3 : PUSH -0x1
006f27c5 : PUSH 0xb0cf21
006f27ca : MOV EAX,FS:[0x0]
006f27d0 : PUSH EAX
006f27d1 : SUB ESP,0x14
006f27d4 : PUSH EBX
006f27d5 : MOV EAX,[0x00d66fa0]
006f27da : XOR EAX,EBP
006f27dc : PUSH EAX
006f27dd : LEA EAX,[EBP + -0xc]
006f27e0 : MOV FS:[0x0],EAX
006f27e6 : LEA ECX,[EBP + -0x20]
006f27e9 : LEA EAX,[ESI + 0xe7c]
006f27ef : XOR EBX,EBX
006f27f1 : PUSH ECX
006f27f2 : MOV dword ptr [EBP + -0x14],EBX
006f27f5 : MOV dword ptr [EBP + -0x20],EAX
006f27f8 : MOV dword ptr [EBP + -0x1c],0xbf7424
006f27ff : MOV dword ptr [EBP + -0x18],0x64a
006f2806 : MOV dword ptr [EBP + -0x10],0x1
006f280d : CALL 0x006ef1a0
006f2812 : MOV dword ptr [EBP + -0x4],EBX
006f2815 : MOV EAX,dword ptr [ESI + 0xeb4]
006f281b : CMP EAX,EBX
006f281d : JZ 0x006f2823
006f281f : MOV dword ptr [EAX],EDI
006f2821 : JMP 0x006f2829
006f2823 : MOV dword ptr [ESI + 0xeb0],EDI
006f2829 : MOV dword ptr [ESI + 0xeb4],EDI
006f282f : MOV dword ptr [ESI + 0xebc],EBX
006f2835 : MOV dword ptr [EBP + -0x4],0xffffffff
006f283c : CMP dword ptr [EBP + -0x14],EBX
006f283f : JZ 0x006f284e
006f2841 : MOV EDX,dword ptr [EBP + -0x20]
006f2844 : PUSH EDX
006f2845 : CALL dword ptr [0x00b8511c]
006f284b : MOV dword ptr [EBP + -0x14],EBX
006f284e : MOV ECX,dword ptr [EBP + -0xc]
006f2851 : MOV dword ptr FS:[0x0],ECX
006f2858 : POP ECX
006f2859 : POP EBX
006f285a : MOV ESP,EBP
006f285c : POP EBP
006f285d : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_004323c0
ENTRY    : 004323c0
BODY     : [[004323c0, 004326a6]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_004323c0(code *param_1,int *param_2,uint param_3,int *param_4,uint param_5)

{
  undefined4 *puVar1;
  char cVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  uint uVar8;
  int *piVar9;
  undefined4 *puVar10;
  undefined1 local_70 [12];
  uint local_64;
  int *local_60;
  uint local_5c;
  code *local_58;
  uint local_54;
  int *local_50;
  uint local_4c;
  undefined4 local_48;
  undefined4 local_44;
  undefined4 local_40;
  undefined1 local_3c [28];
  undefined1 local_20;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b78f4a;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_58 = param_1;
  local_18 = uVar3;
  if ((param_2 != param_4) || (param_3 != param_5)) {
    local_60 = param_2;
    uVar5 = param_3;
    piVar9 = param_2;
    while ((uVar8 = uVar5 + 1, local_5c = uVar8, piVar9 != param_4 || (uVar8 != param_5))) {
      local_50 = piVar9;
      local_4c = uVar8;
      FUN_00430dd0(&local_48);
      local_8 = 0;
      if (param_2 == (int *)0x0) {
        iVar7 = 0;
      }
      else {
        iVar7 = *param_2;
      }
      uVar4 = param_3;
      if (*(uint *)(iVar7 + 0x14) <= param_3) {
        if (param_2 == (int *)0x0) {
          iVar7 = 0;
        }
        else {
          iVar7 = *param_2;
        }
        uVar4 = param_3 - *(int *)(iVar7 + 0x14);
      }
      if (param_2 == (int *)0x0) {
        iVar7 = 0;
      }
      else {
        iVar7 = *param_2;
      }
      cVar2 = (*local_58)(&local_48,*(undefined4 *)(*(int *)(iVar7 + 0x10) + uVar4 * 4),uVar3);
      uVar4 = local_5c;
      if (cVar2 == '\0') {
        while( true ) {
          uVar4 = uVar4 - 1;
          if (piVar9 == (int *)0x0) {
            iVar7 = 0;
          }
          else {
            iVar7 = *piVar9;
          }
          uVar5 = uVar4;
          if (*(uint *)(iVar7 + 0x14) <= uVar4) {
            if (piVar9 == (int *)0x0) {
              iVar7 = 0;
            }
            else {
              iVar7 = *piVar9;
            }
            uVar5 = uVar4 - *(int *)(iVar7 + 0x14);
          }
          if (piVar9 == (int *)0x0) {
            iVar7 = 0;
          }
          else {
            iVar7 = *piVar9;
          }
          local_64 = uVar4;
          cVar2 = (*local_58)(&local_48,*(undefined4 *)(*(int *)(iVar7 + 0x10) + uVar5 * 4));
          if (cVar2 == '\0') break;
          if (piVar9 == (int *)0x0) {
            iVar7 = 0;
          }
          else {
            iVar7 = *piVar9;
          }
          if (*(uint *)(iVar7 + 0x14) <= uVar4) {
            if (piVar9 == (int *)0x0) {
              iVar7 = 0;
            }
            else {
              iVar7 = *piVar9;
            }
            uVar4 = uVar4 - *(int *)(iVar7 + 0x14);
          }
          if (piVar9 == (int *)0x0) {
            iVar7 = 0;
            iVar6 = 0;
          }
          else {
            iVar7 = *piVar9;
            iVar6 = *piVar9;
          }
          uVar5 = local_4c;
          if (*(uint *)(iVar6 + 0x14) <= local_4c) {
            if (local_50 == (int *)0x0) {
              iVar6 = 0;
            }
            else {
              iVar6 = *local_50;
            }
            uVar5 = local_4c - *(int *)(iVar6 + 0x14);
          }
          if (local_50 == (int *)0x0) {
            iVar6 = 0;
          }
          else {
            iVar6 = *local_50;
          }
          puVar10 = *(undefined4 **)(*(int *)(iVar7 + 0x10) + uVar4 * 4);
          puVar1 = *(undefined4 **)(*(int *)(iVar6 + 0x10) + uVar5 * 4);
          *puVar1 = *puVar10;
          puVar1[1] = puVar10[1];
          puVar1[2] = puVar10[2];
          FUN_00405eb0(puVar10 + 3,0,0xffffffff);
          local_4c = local_64;
          *(undefined1 *)(puVar1 + 10) = *(undefined1 *)(puVar10 + 10);
          uVar4 = local_64;
          local_50 = piVar9;
        }
        if (piVar9 == (int *)0x0) {
          iVar7 = 0;
        }
        else {
          iVar7 = *piVar9;
        }
        uVar5 = local_4c;
        if (*(uint *)(iVar7 + 0x14) <= local_4c) {
          if (piVar9 == (int *)0x0) {
            iVar7 = 0;
          }
          else {
            iVar7 = *piVar9;
          }
          uVar5 = local_4c - *(int *)(iVar7 + 0x14);
        }
        if (piVar9 == (int *)0x0) {
          iVar7 = 0;
        }
        else {
          iVar7 = *piVar9;
        }
        puVar10 = *(undefined4 **)(*(int *)(iVar7 + 0x10) + uVar5 * 4);
        *puVar10 = local_48;
        puVar10[1] = local_44;
        puVar10[2] = local_40;
        FUN_00405eb0(local_3c,0,0xffffffff);
        uVar5 = local_5c;
        piVar9 = local_60;
      }
      else {
        local_54 = local_54 & 0xffffff00;
        FUN_00433660(local_70,param_2,param_3,piVar9,uVar8,piVar9,uVar5 + 2,local_54,local_54,
                     local_54);
        if (param_2 == (int *)0x0) {
          iVar7 = 0;
        }
        else {
          iVar7 = *param_2;
        }
        uVar5 = param_3;
        if (*(uint *)(iVar7 + 0x14) <= param_3) {
          if (param_2 == (int *)0x0) {
            iVar7 = 0;
          }
          else {
            iVar7 = *param_2;
          }
          uVar5 = param_3 - *(int *)(iVar7 + 0x14);
        }
        if (param_2 == (int *)0x0) {
          iVar7 = 0;
        }
        else {
          iVar7 = *param_2;
        }
        puVar10 = *(undefined4 **)(*(int *)(iVar7 + 0x10) + uVar5 * 4);
        *puVar10 = local_48;
        puVar10[1] = local_44;
        puVar10[2] = local_40;
        FUN_00405eb0(local_3c,0,0xffffffff);
        uVar5 = uVar8;
      }
      *(undefined1 *)(puVar10 + 10) = local_20;
      local_8 = 0xffffffff;
      FUN_004199f0(&local_48);
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
004323c0 : PUSH EBP
004323c1 : MOV EBP,ESP
004323c3 : PUSH -0x1
004323c5 : PUSH 0xb78f4a
004323ca : MOV EAX,FS:[0x0]
004323d0 : PUSH EAX
004323d1 : SUB ESP,0x60
004323d4 : MOV EAX,[0x00d66fa0]
004323d9 : XOR EAX,EBP
004323db : MOV dword ptr [EBP + -0x14],EAX
004323de : PUSH EBX
004323df : PUSH ESI
004323e0 : PUSH EDI
004323e1 : PUSH EAX
004323e2 : LEA EAX,[EBP + -0xc]
004323e5 : MOV FS:[0x0],EAX
004323eb : MOV EAX,dword ptr [EBP + 0x8]
004323ee : MOV ECX,dword ptr [EBP + 0x10]
004323f1 : MOV dword ptr [EBP + -0x54],EAX
004323f4 : MOV EAX,dword ptr [EBP + 0xc]
004323f7 : CMP EAX,dword ptr [EBP + 0x14]
004323fa : JNZ 0x00432405
004323fc : CMP ECX,dword ptr [EBP + 0x18]
004323ff : JZ 0x0043268b
00432405 : MOV ESI,EAX
00432407 : MOV dword ptr [EBP + -0x5c],ESI
0043240a : MOV EBX,ECX
0043240c : LEA ESP,[ESP]
00432410 : INC EBX
00432411 : MOV dword ptr [EBP + -0x58],EBX
00432414 : CMP ESI,dword ptr [EBP + 0x14]
00432417 : JNZ 0x00432422
00432419 : CMP EBX,dword ptr [EBP + 0x18]
0043241c : JZ 0x0043268b
00432422 : MOV dword ptr [EBP + -0x4c],ESI
00432425 : MOV dword ptr [EBP + -0x48],EBX
00432428 : MOV EAX,EBX
0043242a : TEST ESI,ESI
0043242c : JZ 0x00432432
0043242e : MOV ECX,dword ptr [ESI]
00432430 : JMP 0x00432434
00432432 : XOR ECX,ECX
00432434 : CMP dword ptr [ECX + 0x14],EBX
00432437 : JA 0x00432448
00432439 : TEST ESI,ESI
0043243b : JZ 0x00432441
0043243d : MOV ECX,dword ptr [ESI]
0043243f : JMP 0x00432443
00432441 : XOR ECX,ECX
00432443 : MOV EAX,EBX
00432445 : SUB EAX,dword ptr [ECX + 0x14]
00432448 : TEST ESI,ESI
0043244a : JZ 0x00432450
0043244c : MOV ECX,dword ptr [ESI]
0043244e : JMP 0x00432452
00432450 : XOR ECX,ECX
00432452 : MOV ECX,dword ptr [ECX + 0x10]
00432455 : MOV EAX,dword ptr [ECX + EAX*0x4]
00432458 : LEA EDX,[EBP + -0x44]
0043245b : PUSH EDX
0043245c : MOV EDI,EAX
0043245e : CALL 0x00430dd0
00432463 : MOV dword ptr [EBP + -0x4],0x0
0043246a : MOV ECX,dword ptr [EBP + 0xc]
0043246d : MOV EAX,dword ptr [EBP + 0x10]
00432470 : TEST ECX,ECX
00432472 : JZ 0x00432478
00432474 : MOV EDX,dword ptr [ECX]
00432476 : JMP 0x0043247a
00432478 : XOR EDX,EDX
0043247a : CMP dword ptr [EDX + 0x14],EAX
0043247d : JA 0x0043248c
0043247f : TEST ECX,ECX
00432481 : JZ 0x00432487
00432483 : MOV EDX,dword ptr [ECX]
00432485 : JMP 0x00432489
00432487 : XOR EDX,EDX
00432489 : SUB EAX,dword ptr [EDX + 0x14]
0043248c : TEST ECX,ECX
0043248e : JZ 0x00432494
00432490 : MOV ECX,dword ptr [ECX]
00432492 : JMP 0x00432496
00432494 : XOR ECX,ECX
00432496 : MOV ECX,dword ptr [ECX + 0x10]
00432499 : MOV EAX,dword ptr [ECX + EAX*0x4]
0043249c : PUSH EAX
0043249d : LEA EDX,[EBP + -0x44]
004324a0 : PUSH EDX
004324a1 : CALL dword ptr [EBP + -0x54]
004324a4 : ADD ESP,0x8
004324a7 : TEST AL,AL
004324a9 : JZ 0x00432532
004324af : MOV byte ptr [EBP + -0x50],0x0
004324b3 : MOV ECX,dword ptr [EBP + -0x50]
004324b6 : MOV EDX,dword ptr [EBP + -0x50]
004324b9 : PUSH ECX
004324ba : MOV ECX,dword ptr [EBP + -0x50]
004324bd : PUSH EDX
004324be : MOV EDX,dword ptr [EBP + 0x10]
004324c1 : PUSH ECX
004324c2 : LEA EAX,[EBX + 0x1]
004324c5 : PUSH EAX
004324c6 : MOV EAX,dword ptr [EBP + 0xc]
004324c9 : PUSH ESI
004324ca : PUSH EBX
004324cb : PUSH ESI
004324cc : PUSH EDX
004324cd : PUSH EAX
004324ce : LEA ECX,[EBP + -0x6c]
004324d1 : PUSH ECX
004324d2 : CALL 0x00433660
004324d7 : MOV ECX,dword ptr [EBP + 0xc]
004324da : MOV EAX,dword ptr [EBP + 0x10]
004324dd : ADD ESP,0x28
004324e0 : TEST ECX,ECX
004324e2 : JZ 0x004324e8
004324e4 : MOV EDX,dword ptr [ECX]
004324e6 : JMP 0x004324ea
004324e8 : XOR EDX,EDX
004324ea : CMP dword ptr [EDX + 0x14],EAX
004324ed : JA 0x004324fc
004324ef : TEST ECX,ECX
004324f1 : JZ 0x004324f7
004324f3 : MOV EDX,dword ptr [ECX]
004324f5 : JMP 0x004324f9
004324f7 : XOR EDX,EDX
004324f9 : SUB EAX,dword ptr [EDX + 0x14]
004324fc : TEST ECX,ECX
004324fe : JZ 0x00432504
00432500 : MOV ECX,dword ptr [ECX]
00432502 : JMP 0x00432506
00432504 : XOR ECX,ECX
00432506 : MOV EDX,dword ptr [ECX + 0x10]
00432509 : MOV EDI,dword ptr [EDX + EAX*0x4]
0043250c : MOV EAX,dword ptr [EBP + -0x44]
0043250f : MOV dword ptr [EDI],EAX
00432511 : MOV ECX,dword ptr [EBP + -0x40]
00432514 : PUSH -0x1
00432516 : MOV dword ptr [EDI + 0x4],ECX
00432519 : MOV EDX,dword ptr [EBP + -0x3c]
0043251c : PUSH 0x0
0043251e : LEA EAX,[EBP + -0x38]
00432521 : PUSH EAX
00432522 : LEA ECX,[EDI + 0xc]
00432525 : MOV dword ptr [EDI + 0x8],EDX
00432528 : CALL 0x00405eb0
0043252d : JMP 0x00432670
00432532 : MOV EDI,dword ptr [EBP + -0x58]
00432535 : MOV EBX,ESI
00432537 : DEC EDI
00432538 : MOV dword ptr [EBP + -0x60],EDI
0043253b : MOV EAX,EDI
0043253d : TEST EBX,EBX
0043253f : JZ 0x00432545
00432541 : MOV ECX,dword ptr [EBX]
00432543 : JMP 0x00432547
00432545 : XOR ECX,ECX
00432547 : CMP dword ptr [ECX + 0x14],EDI
0043254a : JA 0x0043255b
0043254c : TEST EBX,EBX
0043254e : JZ 0x00432554
00432550 : MOV ECX,dword ptr [EBX]
00432552 : JMP 0x00432556
00432554 : XOR ECX,ECX
00432556 : MOV EAX,EDI
00432558 : SUB EAX,dword ptr [ECX + 0x14]
0043255b : TEST EBX,EBX
0043255d : JZ 0x00432563
0043255f : MOV ECX,dword ptr [EBX]
00432561 : JMP 0x00432565
00432563 : XOR ECX,ECX
00432565 : MOV EDX,dword ptr [ECX + 0x10]
00432568 : MOV EAX,dword ptr [EDX + EAX*0x4]
0043256b : PUSH EAX
0043256c : LEA EAX,[EBP + -0x44]
0043256f : PUSH EAX
00432570 : CALL dword ptr [EBP + -0x54]
00432573 : ADD ESP,0x8
00432576 : TEST AL,AL
00432578 : JZ 0x0043261a
0043257e : TEST EBX,EBX
00432580 : JZ 0x00432586
00432582 : MOV EAX,dword ptr [EBX]
00432584 : JMP 0x00432588
00432586 : XOR EAX,EAX
00432588 : CMP dword ptr [EAX + 0x14],EDI
0043258b : JA 0x0043259a
0043258d : TEST EBX,EBX
0043258f : JZ 0x00432595
00432591 : MOV EAX,dword ptr [EBX]
00432593 : JMP 0x00432597
00432595 : XOR EAX,EAX
00432597 : SUB EDI,dword ptr [EAX + 0x14]
0043259a : TEST EBX,EBX
0043259c : JZ 0x004325a2
0043259e : MOV EDX,dword ptr [EBX]
004325a0 : JMP 0x004325a4
004325a2 : XOR EDX,EDX
004325a4 : MOV ECX,dword ptr [EBP + -0x48]
004325a7 : TEST ESI,ESI
004325a9 : JZ 0x004325af
004325ab : MOV EAX,dword ptr [ESI]
004325ad : JMP 0x004325b1
004325af : XOR EAX,EAX
004325b1 : MOV ESI,dword ptr [EBP + -0x48]
004325b4 : CMP dword ptr [EAX + 0x14],ESI
004325b7 : MOV ESI,dword ptr [EBP + -0x4c]
004325ba : JA 0x004325cc
004325bc : TEST ESI,ESI
004325be : JZ 0x004325c4
004325c0 : MOV EAX,dword ptr [ESI]
004325c2 : JMP 0x004325c6
004325c4 : XOR EAX,EAX
004325c6 : MOV ECX,dword ptr [EBP + -0x48]
004325c9 : SUB ECX,dword ptr [EAX + 0x14]
004325cc : TEST ESI,ESI
004325ce : JZ 0x004325d4
004325d0 : MOV EAX,dword ptr [ESI]
004325d2 : JMP 0x004325d6
004325d4 : XOR EAX,EAX
004325d6 : MOV EDX,dword ptr [EDX + 0x10]
004325d9 : MOV ESI,dword ptr [EDX + EDI*0x4]
004325dc : MOV EAX,dword ptr [EAX + 0x10]
004325df : MOV EDI,dword ptr [EAX + ECX*0x4]
004325e2 : MOV ECX,dword ptr [ESI]
004325e4 : MOV dword ptr [EDI],ECX
004325e6 : MOV EDX,dword ptr [ESI + 0x4]
004325e9 : PUSH -0x1
004325eb : PUSH 0x0
004325ed : LEA ECX,[ESI + 0xc]
004325f0 : MOV dword ptr [EDI + 0x4],EDX
004325f3 : MOV EAX,dword ptr [ESI + 0x8]
004325f6 : PUSH ECX
004325f7 : LEA ECX,[EDI + 0xc]
004325fa : MOV dword ptr [EDI + 0x8],EAX
004325fd : CALL 0x00405eb0
00432602 : MOV DL,byte ptr [ESI + 0x28]
00432605 : MOV EAX,dword ptr [EBP + -0x60]
00432608 : MOV ESI,EBX
0043260a : MOV byte ptr [EDI + 0x28],DL
0043260d : MOV dword ptr [EBP + -0x4c],ESI
00432610 : MOV dword ptr [EBP + -0x48],EAX
00432613 : MOV EDI,EAX
00432615 : JMP 0x00432537
0043261a : MOV ECX,dword ptr [EBP + -0x48]
0043261d : TEST ESI,ESI
0043261f : JZ 0x00432625
00432621 : MOV EAX,dword ptr [ESI]
00432623 : JMP 0x00432627
00432625 : XOR EAX,EAX
00432627 : CMP dword ptr [EAX + 0x14],ECX
0043262a : JA 0x00432639
0043262c : TEST ESI,ESI
0043262e : JZ 0x00432634
00432630 : MOV EAX,dword ptr [ESI]
00432632 : JMP 0x00432636
00432634 : XOR EAX,EAX
00432636 : SUB ECX,dword ptr [EAX + 0x14]
00432639 : TEST ESI,ESI
0043263b : JZ 0x00432641
0043263d : MOV EAX,dword ptr [ESI]
0043263f : JMP 0x00432643
00432641 : XOR EAX,EAX
00432643 : MOV EDX,dword ptr [EAX + 0x10]
00432646 : MOV EDI,dword ptr [EDX + ECX*0x4]
00432649 : MOV EAX,dword ptr [EBP + -0x44]
0043264c : MOV dword ptr [EDI],EAX
0043264e : MOV ECX,dword ptr [EBP + -0x40]
00432651 : PUSH -0x1
00432653 : MOV dword ptr [EDI + 0x4],ECX
00432656 : MOV EDX,dword ptr [EBP + -0x3c]
00432659 : PUSH 0x0
0043265b : LEA EAX,[EBP + -0x38]
0043265e : PUSH EAX
0043265f : LEA ECX,[EDI + 0xc]
00432662 : MOV dword ptr [EDI + 0x8],EDX
00432665 : CALL 0x00405eb0
0043266a : MOV ESI,dword ptr [EBP + -0x5c]
0043266d : MOV EBX,dword ptr [EBP + -0x58]
00432670 : MOV CL,byte ptr [EBP + -0x1c]
00432673 : MOV byte ptr [EDI + 0x28],CL
00432676 : MOV dword ptr [EBP + -0x4],0xffffffff
0043267d : LEA EDX,[EBP + -0x44]
00432680 : PUSH EDX
00432681 : CALL 0x004199f0
00432686 : JMP 0x00432410
0043268b : MOV ECX,dword ptr [EBP + -0xc]
0043268e : MOV dword ptr FS:[0x0],ECX
00432695 : POP ECX
00432696 : POP EDI
00432697 : POP ESI
00432698 : POP EBX
00432699 : MOV ECX,dword ptr [EBP + -0x14]
0043269c : XOR ECX,EBP
0043269e : CALL 0x00633e6b
004326a3 : MOV ESP,EBP
004326a5 : POP EBP
004326a6 : RET

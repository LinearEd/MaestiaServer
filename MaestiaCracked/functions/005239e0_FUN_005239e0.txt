PROGRAM  : Maestia.exe
FUNCTION : FUN_005239e0
ENTRY    : 005239e0
BODY     : [[005239e0, 00523abf]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005239e0(int *param_1)

{
  undefined4 *puVar1;
  int iVar2;
  uint uVar3;
  char cVar4;
  uint uVar5;
  int *in_ECX;
  uint uVar6;
  uint *puVar7;
  uint uVar8;
  
  if (*in_ECX != 0) {
    if ((int *)*param_1 == (int *)0x0) {
      uVar5 = 0;
    }
    else {
      uVar5 = (**(code **)(*(int *)*param_1 + 0x10))(param_1[1]);
    }
    iVar2 = *in_ECX;
    uVar5 = *(uint *)(iVar2 + 4) & uVar5;
    puVar7 = (uint *)(uVar5 * 0x10 + 8 + iVar2);
    if ((*(int *)(uVar5 * 0x10 + 8 + iVar2) != -2) && (puVar7[1] == uVar5)) {
      uVar6 = 0xffffffff;
      uVar8 = uVar5;
      while ((puVar7[1] != uVar5 || (cVar4 = FUN_005236e0(param_1), cVar4 == '\0'))) {
        uVar3 = *puVar7;
        if (uVar3 == 0xffffffff) {
          return;
        }
        puVar7 = (uint *)(uVar3 * 0x10 + 8 + *in_ECX);
        uVar6 = uVar8;
        uVar8 = uVar3;
      }
      if (uVar5 == uVar8) {
        if (*puVar7 != 0xffffffff) {
          puVar1 = (undefined4 *)(*puVar7 * 0x10 + 8 + *in_ECX);
          *puVar7 = 0xfffffffe;
          FUN_00523860(puVar1);
          *puVar1 = 0xfffffffe;
          *(int *)*in_ECX = *(int *)*in_ECX + -1;
          return;
        }
      }
      else {
        *(uint *)(uVar6 * 0x10 + 8 + *in_ECX) = *puVar7;
      }
      *puVar7 = 0xfffffffe;
      *(int *)*in_ECX = *(int *)*in_ECX + -1;
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005239e0 : PUSH ECX
005239e1 : PUSH EBP
005239e2 : MOV EBP,ECX
005239e4 : CMP dword ptr [EBP],0x0
005239e8 : JZ 0x00523abb
005239ee : MOV EAX,dword ptr [ESP + 0xc]
005239f2 : MOV ECX,dword ptr [EAX]
005239f4 : TEST ECX,ECX
005239f6 : JZ 0x00523a05
005239f8 : MOV EDX,dword ptr [ECX]
005239fa : MOV EAX,dword ptr [EAX + 0x4]
005239fd : MOV EDX,dword ptr [EDX + 0x10]
00523a00 : PUSH EAX
00523a01 : CALL EDX
00523a03 : JMP 0x00523a07
00523a05 : XOR EAX,EAX
00523a07 : MOV ECX,dword ptr [EBP]
00523a0a : PUSH ESI
00523a0b : PUSH EDI
00523a0c : MOV EDI,dword ptr [ECX + 0x4]
00523a0f : AND EDI,EAX
00523a11 : MOV EAX,EDI
00523a13 : SHL EAX,0x4
00523a16 : CMP dword ptr [EAX + ECX*0x1 + 0x8],-0x2
00523a1b : LEA ESI,[EAX + ECX*0x1 + 0x8]
00523a1f : JZ 0x00523ab9
00523a25 : CMP dword ptr [ESI + 0x4],EDI
00523a28 : JNZ 0x00523ab9
00523a2e : PUSH EBX
00523a2f : MOV dword ptr [ESP + 0x10],EDI
00523a33 : OR EBX,0xffffffff
00523a36 : MOV ECX,dword ptr [ESP + 0x10]
00523a3a : CMP dword ptr [ESI + 0x4],ECX
00523a3d : JNZ 0x00523a50
00523a3f : MOV EDX,dword ptr [ESP + 0x18]
00523a43 : PUSH EDX
00523a44 : LEA ECX,[ESI + 0x8]
00523a47 : CALL 0x005236e0
00523a4c : TEST AL,AL
00523a4e : JNZ 0x00523a67
00523a50 : MOV EBX,EDI
00523a52 : MOV EDI,dword ptr [ESI]
00523a54 : CMP EDI,-0x1
00523a57 : JZ 0x00523ab8
00523a59 : MOV ECX,dword ptr [EBP]
00523a5c : MOV EAX,EDI
00523a5e : SHL EAX,0x4
00523a61 : LEA ESI,[EAX + ECX*0x1 + 0x8]
00523a65 : JMP 0x00523a36
00523a67 : CMP dword ptr [ESP + 0x10],EDI
00523a6b : JNZ 0x00523aa1
00523a6d : MOV EAX,dword ptr [ESI]
00523a6f : CMP EAX,-0x1
00523a72 : JZ 0x00523aad
00523a74 : MOV EDX,dword ptr [EBP]
00523a77 : SHL EAX,0x4
00523a7a : LEA EDI,[EAX + EDX*0x1 + 0x8]
00523a7e : PUSH EDI
00523a7f : MOV ECX,ESI
00523a81 : MOV dword ptr [ESI],0xfffffffe
00523a87 : CALL 0x00523860
00523a8c : POP EBX
00523a8d : MOV ESI,EDI
00523a8f : MOV dword ptr [ESI],0xfffffffe
00523a95 : MOV EAX,dword ptr [EBP]
00523a98 : DEC dword ptr [EAX]
00523a9a : POP EDI
00523a9b : POP ESI
00523a9c : POP EBP
00523a9d : POP ECX
00523a9e : RET 0x4
00523aa1 : MOV EAX,dword ptr [EBP]
00523aa4 : MOV ECX,dword ptr [ESI]
00523aa6 : SHL EBX,0x4
00523aa9 : MOV dword ptr [EBX + EAX*0x1 + 0x8],ECX
00523aad : MOV dword ptr [ESI],0xfffffffe
00523ab3 : MOV EAX,dword ptr [EBP]
00523ab6 : DEC dword ptr [EAX]
00523ab8 : POP EBX
00523ab9 : POP EDI
00523aba : POP ESI
00523abb : POP EBP
00523abc : POP ECX
00523abd : RET 0x4

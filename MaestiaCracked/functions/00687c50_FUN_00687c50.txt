PROGRAM  : Maestia.exe
FUNCTION : FUN_00687c50
ENTRY    : 00687c50
BODY     : [[00687c50, 00687cc2]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00687c50(int *param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  int iVar2;
  undefined4 *puVar3;
  
  puVar3 = param_2;
  uVar1 = 0;
  *param_2 = 0;
  iVar2 = param_1[2];
  if ((uint)param_1[1] <= iVar2 + 3U) {
LAB_00687cb8:
    *puVar3 = 0x55;
    return 0;
  }
  if ((code *)param_1[5] == (code *)0x0) {
    puVar3 = (undefined4 *)(*param_1 + iVar2);
    if (puVar3 == (undefined4 *)0x0) goto LAB_00687cb1;
  }
  else {
    iVar2 = (*(code *)param_1[5])(param_1,iVar2,&param_2,4);
    if (iVar2 != 4) goto LAB_00687cb8;
    puVar3 = &param_2;
  }
  uVar1 = *puVar3;
LAB_00687cb1:
  param_1[2] = param_1[2] + 4;
  return uVar1;
}



============================================================
DISASSEMBLY
============================================================
00687c50 : PUSH ESI
00687c51 : MOV ESI,dword ptr [ESP + 0x8]
00687c55 : PUSH EDI
00687c56 : MOV EDI,dword ptr [ESP + 0x10]
00687c5a : XOR EAX,EAX
00687c5c : MOV dword ptr [EDI],EAX
00687c5e : MOV EDX,dword ptr [ESI + 0x8]
00687c61 : LEA ECX,[EDX + 0x3]
00687c64 : CMP ECX,dword ptr [ESI + 0x4]
00687c67 : JNC 0x00687cb8
00687c69 : MOV ECX,dword ptr [ESI + 0x14]
00687c6c : TEST ECX,ECX
00687c6e : JZ 0x00687c89
00687c70 : PUSH 0x4
00687c72 : LEA EAX,[ESP + 0x14]
00687c76 : PUSH EAX
00687c77 : PUSH EDX
00687c78 : PUSH ESI
00687c79 : CALL ECX
00687c7b : ADD ESP,0x10
00687c7e : CMP EAX,0x4
00687c81 : JNZ 0x00687cb8
00687c83 : LEA ECX,[ESP + 0x10]
00687c87 : JMP 0x00687c8f
00687c89 : MOV ECX,dword ptr [ESI]
00687c8b : ADD ECX,EDX
00687c8d : JZ 0x00687cb1
00687c8f : MOVSX EAX,byte ptr [ECX + 0x3]
00687c93 : MOVZX EDX,byte ptr [ECX + 0x2]
00687c97 : ADD ECX,0x4
00687c9a : SHL EAX,0x8
00687c9d : OR EAX,EDX
00687c9f : MOVZX EDX,byte ptr [ECX + -0x3]
00687ca3 : MOVZX ECX,byte ptr [ECX + -0x4]
00687ca7 : SHL EAX,0x8
00687caa : OR EAX,EDX
00687cac : SHL EAX,0x8
00687caf : OR EAX,ECX
00687cb1 : ADD dword ptr [ESI + 0x8],0x4
00687cb5 : POP EDI
00687cb6 : POP ESI
00687cb7 : RET
00687cb8 : MOV dword ptr [EDI],0x55
00687cbe : POP EDI
00687cbf : XOR EAX,EAX
00687cc1 : POP ESI
00687cc2 : RET

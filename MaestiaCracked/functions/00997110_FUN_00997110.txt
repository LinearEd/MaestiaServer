PROGRAM  : Maestia.exe
FUNCTION : FUN_00997110
ENTRY    : 00997110
BODY     : [[00997110, 00997205]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00997110(undefined4 param_1,undefined4 param_2)

{
  undefined4 uVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  undefined4 local_3c;
  undefined4 local_38;
  int local_34;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b63ef7;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_38 = param_1;
  local_14 = uVar3;
  iVar4 = FUN_00995260(param_2);
  iVar2 = DAT_00d7c54c;
  if (iVar4 != 0) {
    uVar1 = *(undefined4 *)(iVar4 + 0x10);
    local_3c = uVar1;
    FUN_004437f0(&local_3c);
    if ((local_34 == *(int *)(iVar2 + 0x44)) || (*(int *)(local_34 + 0x10) == 0)) {
      FUN_00404750(L"[AvaGuiGachaBox::OnGachaOpen] Can\'t find item from gbd.. [%u]",uVar1,uVar3);
      local_8 = 0;
      if ((int *)*DAT_00da98e8 != (int *)0x0) {
        (**(code **)(*(int *)*DAT_00da98e8 + 0x14))(L"AvaGuiGachaBox::OnGachaOpen",0x366,local_30);
      }
      local_8 = 0xffffffff;
      if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_18 = 7;
      local_1c = 0;
      local_2c = 0;
      goto LAB_009971e8;
    }
  }
  FUN_00996f80(iVar4);
LAB_009971e8:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00997110 : PUSH EBP
00997111 : MOV EBP,ESP
00997113 : PUSH -0x1
00997115 : PUSH 0xb63ef7
0099711a : MOV EAX,FS:[0x0]
00997120 : PUSH EAX
00997121 : SUB ESP,0x2c
00997124 : MOV EAX,[0x00d66fa0]
00997129 : XOR EAX,EBP
0099712b : MOV dword ptr [EBP + -0x10],EAX
0099712e : PUSH EBX
0099712f : PUSH ESI
00997130 : PUSH EDI
00997131 : PUSH EAX
00997132 : LEA EAX,[EBP + -0xc]
00997135 : MOV FS:[0x0],EAX
0099713b : MOV ECX,dword ptr [EBP + 0xc]
0099713e : MOV EAX,dword ptr [EBP + 0x8]
00997141 : PUSH ECX
00997142 : MOV dword ptr [EBP + -0x34],EAX
00997145 : CALL 0x00995260
0099714a : MOV ESI,EAX
0099714c : TEST ESI,ESI
0099714e : JZ 0x009971dc
00997154 : MOV EBX,dword ptr [0x00d7c54c]
0099715a : MOV EDI,dword ptr [ESI + 0x10]
0099715d : LEA EDX,[EBP + -0x38]
00997160 : PUSH EDX
00997161 : LEA ECX,[EBX + 0x40]
00997164 : LEA EAX,[EBP + -0x30]
00997167 : MOV dword ptr [EBP + -0x38],EDI
0099716a : CALL 0x004437f0
0099716f : MOV EBX,dword ptr [EBX + 0x44]
00997172 : MOV EAX,dword ptr [EBP + -0x30]
00997175 : CMP EAX,EBX
00997177 : JZ 0x0099717f
00997179 : CMP dword ptr [EAX + 0x10],0x0
0099717d : JNZ 0x009971dc
0099717f : PUSH EDI
00997180 : PUSH 0xc86b68
00997185 : LEA ESI,[EBP + -0x2c]
00997188 : CALL 0x00404750
0099718d : ADD ESP,0x8
00997190 : XOR ESI,ESI
00997192 : MOV dword ptr [EBP + -0x4],ESI
00997195 : MOV EAX,[0x00da98e8]
0099719a : MOV ECX,dword ptr [EAX]
0099719c : CMP ECX,ESI
0099719e : JZ 0x009971b5
009971a0 : MOV EDX,dword ptr [ECX]
009971a2 : MOV EDX,dword ptr [EDX + 0x14]
009971a5 : LEA EAX,[EBP + -0x2c]
009971a8 : PUSH EAX
009971a9 : PUSH 0x366
009971ae : PUSH 0xc86be4
009971b3 : CALL EDX
009971b5 : MOV dword ptr [EBP + -0x4],0xffffffff
009971bc : CMP dword ptr [EBP + -0x14],0x8
009971c0 : JC 0x009971ca
009971c2 : MOV ECX,dword ptr [EBP + -0x28]
009971c5 : CALL 0x006f04e0
009971ca : XOR EAX,EAX
009971cc : MOV dword ptr [EBP + -0x14],0x7
009971d3 : MOV dword ptr [EBP + -0x18],ESI
009971d6 : MOV word ptr [EBP + -0x28],AX
009971da : JMP 0x009971e8
009971dc : MOV EDX,dword ptr [EBP + 0xc]
009971df : MOV ECX,dword ptr [EBP + -0x34]
009971e2 : PUSH ESI
009971e3 : CALL 0x00996f80
009971e8 : MOV ECX,dword ptr [EBP + -0xc]
009971eb : MOV dword ptr FS:[0x0],ECX
009971f2 : POP ECX
009971f3 : POP EDI
009971f4 : POP ESI
009971f5 : POP EBX
009971f6 : MOV ECX,dword ptr [EBP + -0x10]
009971f9 : XOR ECX,EBP
009971fb : CALL 0x00633e6b
00997200 : MOV ESP,EBP
00997202 : POP EBP
00997203 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_00506900
ENTRY    : 00506900
BODY     : [[00506900, 00506a55]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00506900(int param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  undefined4 uVar4;
  undefined1 auStack_64 [16];
  undefined1 auStack_54 [84];
  
  iVar1 = param_1;
  if (*(int *)(param_1 + 8) != 0) {
    iVar2 = (**(code **)(**(int **)(param_1 + 8) + 8))();
    if (iVar2 == 4) {
      if (*(int *)(iVar1 + 8) == 0) {
        iVar2 = 0;
      }
      else {
        iVar2 = *(int *)(iVar1 + 8) + -0x68;
      }
      iVar3 = *(int *)(iVar2 + 0xe8);
      if (iVar3 != 0) {
        *(uint *)(iVar3 + 8) = *(int *)(iVar3 + 8) + 1U & 0x8fffffff;
      }
      iVar3 = *(int *)(iVar2 + 0xe8);
    }
    else {
      iVar2 = (**(code **)(**(int **)(iVar1 + 8) + 8))();
      if (iVar2 != 0xd) {
        return;
      }
      iVar2 = *(int *)(iVar1 + 8);
      if (iVar2 == 0) {
        iVar3 = 0;
      }
      else {
        iVar3 = iVar2 + -0x10;
        if (iVar3 == 0) {
          return;
        }
        *(uint *)(iVar2 + -8) = *(int *)(iVar2 + -8) + 1U & 0x8fffffff;
      }
    }
    if (iVar3 != 0) {
      if (0 < *(int *)(iVar1 + 0x1c)) {
        uVar4 = *(undefined4 *)(iVar1 + 0x18);
        FUN_00526260(0);
        FUN_005272e0(&param_1,uVar4,0xffffffff,0);
        iVar2 = FUN_005002b0();
        if (4 < iVar2) {
          *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + -1;
          if (*(int *)(param_1 + 8) == 0) {
            FUN_00525340();
          }
          FUN_00503db0();
          return;
        }
        iVar3 = FUN_00502030();
        FUN_00502480();
        if (iVar3 != 0) {
          FUN_00500220(iVar3);
        }
        uVar4 = FUN_005062d0(auStack_64,iVar1,1,auStack_54 + iVar2 * 0x10);
        FUN_004ffe40(iVar2,uVar4);
        FUN_005038f0(auStack_54);
        *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + -1;
        if (*(int *)(param_1 + 8) == 0) {
          FUN_00525340();
        }
      }
      FUN_00503db0();
      return;
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00506900 : SUB ESP,0x64
00506903 : PUSH EBX
00506904 : MOV EBX,dword ptr [ESP + 0x6c]
00506908 : CMP dword ptr [EBX + 0x8],0x0
0050690c : JZ 0x005069d8
00506912 : MOV ECX,dword ptr [EBX + 0x8]
00506915 : MOV EAX,dword ptr [ECX]
00506917 : MOV EDX,dword ptr [EAX + 0x8]
0050691a : PUSH EBP
0050691b : CALL EDX
0050691d : CMP EAX,0x4
00506920 : JNZ 0x0050694f
00506922 : MOV EAX,dword ptr [EBX + 0x8]
00506925 : TEST EAX,EAX
00506927 : JZ 0x0050692e
00506929 : LEA ECX,[EAX + -0x68]
0050692c : JMP 0x00506930
0050692e : XOR ECX,ECX
00506930 : MOV EAX,dword ptr [ECX + 0xe8]
00506936 : TEST EAX,EAX
00506938 : JZ 0x00506947
0050693a : MOV EDX,dword ptr [EAX + 0x8]
0050693d : INC EDX
0050693e : AND EDX,0x8fffffff
00506944 : MOV dword ptr [EAX + 0x8],EDX
00506947 : MOV EBP,dword ptr [ECX + 0xe8]
0050694d : JMP 0x00506978
0050694f : MOV ECX,dword ptr [EBX + 0x8]
00506952 : MOV EAX,dword ptr [ECX]
00506954 : MOV EDX,dword ptr [EAX + 0x8]
00506957 : CALL EDX
00506959 : CMP EAX,0xd
0050695c : JNZ 0x005069d7
0050695e : MOV EAX,dword ptr [EBX + 0x8]
00506961 : TEST EAX,EAX
00506963 : JZ 0x005069dd
00506965 : LEA EBP,[EAX + -0x10]
00506968 : TEST EBP,EBP
0050696a : JZ 0x005069d7
0050696c : MOV EAX,dword ptr [EBP + 0x8]
0050696f : INC EAX
00506970 : AND EAX,0x8fffffff
00506975 : MOV dword ptr [EBP + 0x8],EAX
00506978 : TEST EBP,EBP
0050697a : JZ 0x005069d7
0050697c : CMP dword ptr [EBX + 0x1c],0x1
00506980 : PUSH ESI
00506981 : PUSH EDI
00506982 : JL 0x00506a48
00506988 : MOV ESI,dword ptr [EBX + 0x18]
0050698b : PUSH 0x0
0050698d : MOV ECX,EBX
0050698f : CALL 0x00526260
00506994 : PUSH 0x0
00506996 : PUSH -0x1
00506998 : PUSH ESI
00506999 : LEA ECX,[ESP + 0x84]
005069a0 : PUSH ECX
005069a1 : MOV ECX,EAX
005069a3 : CALL 0x005272e0
005069a8 : LEA EDI,[ESP + 0x78]
005069ac : CALL 0x005002b0
005069b1 : MOV ESI,EAX
005069b3 : CMP ESI,0x5
005069b6 : JL 0x005069e1
005069b8 : MOV EAX,dword ptr [ESP + 0x78]
005069bc : DEC dword ptr [EAX + 0x8]
005069bf : MOV ECX,EAX
005069c1 : ADD EAX,0x8
005069c4 : CMP dword ptr [EAX],0x0
005069c7 : JNZ 0x005069ce
005069c9 : CALL 0x00525340
005069ce : MOV ECX,EBP
005069d0 : CALL 0x00503db0
005069d5 : POP EDI
005069d6 : POP ESI
005069d7 : POP EBP
005069d8 : POP EBX
005069d9 : ADD ESP,0x64
005069dc : RET
005069dd : XOR EBP,EBP
005069df : JMP 0x00506978
005069e1 : MOV ECX,EBP
005069e3 : CALL 0x00502030
005069e8 : LEA ECX,[ESP + 0x20]
005069ec : MOV EDI,EAX
005069ee : CALL 0x00502480
005069f3 : TEST EDI,EDI
005069f5 : JZ 0x00506a01
005069f7 : PUSH EDI
005069f8 : LEA ECX,[ESP + 0x24]
005069fc : CALL 0x00500220
00506a01 : MOV EDX,ESI
00506a03 : SHL EDX,0x4
00506a06 : LEA EAX,[ESP + EDX*0x1 + 0x20]
00506a0a : PUSH EAX
00506a0b : PUSH 0x1
00506a0d : LEA ECX,[ESP + 0x18]
00506a11 : PUSH EBX
00506a12 : PUSH ECX
00506a13 : CALL 0x005062d0
00506a18 : ADD ESP,0x10
00506a1b : PUSH EAX
00506a1c : PUSH ESI
00506a1d : LEA ECX,[ESP + 0x28]
00506a21 : CALL 0x004ffe40
00506a26 : LEA EDX,[ESP + 0x20]
00506a2a : PUSH EDX
00506a2b : MOV ECX,EBP
00506a2d : CALL 0x005038f0
00506a32 : MOV EAX,dword ptr [ESP + 0x78]
00506a36 : DEC dword ptr [EAX + 0x8]
00506a39 : MOV ECX,EAX
00506a3b : ADD EAX,0x8
00506a3e : CMP dword ptr [EAX],0x0
00506a41 : JNZ 0x00506a48
00506a43 : CALL 0x00525340
00506a48 : POP EDI
00506a49 : POP ESI
00506a4a : MOV ECX,EBP
00506a4c : POP EBP
00506a4d : POP EBX
00506a4e : ADD ESP,0x64
00506a51 : JMP 0x00503db0

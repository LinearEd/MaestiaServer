PROGRAM  : Maestia.exe
FUNCTION : FUN_005fd2b0
ENTRY    : 005fd2b0
BODY     : [[005fd2b0, 005fd50d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005fd2b0(int *param_1,int param_2,uint param_3)

{
  uint uVar1;
  int iVar2;
  undefined4 *puVar3;
  bool bVar4;
  undefined4 *puVar5;
  int in_ECX;
  int iVar6;
  uint uVar7;
  int *local_2c;
  int local_20;
  int local_1c;
  uint local_c;
  int local_8;
  
  if (*(int *)(param_2 + 0x18) == -1) {
    local_2c = param_1;
  }
  else {
    local_2c = (int *)(*(int *)(in_ECX + 0x128) + *(int *)(param_2 + 0x18) * 0xc);
  }
  local_1c = *(int *)(param_2 + 0x14);
  local_20 = *(int *)(param_2 + 0x10);
  uVar7 = *(uint *)(param_2 + 8);
  uVar1 = *(uint *)(param_2 + 0xc);
  local_c = *(uint *)(*(int *)(in_ECX + 0x128) + 8 + local_20 * 0xc);
  local_8 = *(int *)(param_2 + 4);
  iVar2 = *(int *)(param_1[1] + 0x10);
  bVar4 = true;
  puVar5 = (undefined4 *)FUN_005fcc20(0);
  puVar3 = (undefined4 *)param_1[1];
  *puVar5 = *puVar3;
  puVar5[1] = puVar3[1];
  puVar5[2] = puVar3[2];
  puVar5[3] = puVar3[3];
  puVar5[4] = puVar3[4];
  puVar5[5] = puVar3[5];
  puVar3 = (undefined4 *)param_1[1];
  puVar3[1] = 0xffffffff;
  puVar3[2] = 0xffffffff;
  puVar3[3] = 0xffffffff;
  *puVar3 = 0;
  puVar3[4] = iVar2;
  puVar3[5] = 0;
  do {
    if (local_1c == 0) {
      param_1[1] = (int)puVar5;
      puVar3 = puVar5;
      if (uVar7 != 0xffffffff) {
        FUN_005fcb20(puVar5,uVar7 | 0x40000000);
      }
joined_r0x005fd41d:
      if (local_c != 0xffffffff) {
        FUN_005fcb20(puVar3,local_c & 0xbfffffff);
      }
    }
    else if (uVar7 != local_c) {
      FUN_005fcc80(param_1,iVar2);
      iVar6 = param_1[1];
      if (param_3 != 0xffffffff) {
        FUN_005fcb20(iVar6,param_3 | 0x40000000);
        FUN_005fcb20(iVar6,param_3 & 0xbfffffff);
      }
      puVar3 = (undefined4 *)param_1[1];
      if (uVar7 != 0xffffffff) {
        FUN_005fcb20(puVar3,uVar7 | 0x40000000);
      }
      goto joined_r0x005fd41d;
    }
    if ((local_8 != iVar2) || (param_1[1] == 0)) {
      if (*(char *)(local_8 + *(int *)(in_ECX + 0x24)) == '\0') {
        param_1[1] = 0;
      }
      else {
        if (bVar4) {
          param_1 = local_2c;
        }
        FUN_005fcc80(param_1,local_8);
        iVar6 = param_1[1];
        if (uVar7 != 0xffffffff) {
          FUN_005fcb20(iVar6,uVar7 | 0x40000000);
        }
        if (local_c != 0xffffffff) {
          FUN_005fcb20(iVar6,local_c & 0xbfffffff);
        }
      }
    }
    bVar4 = false;
    if (local_1c == 0) {
      *(undefined4 *)(param_2 + 0x14) = 0;
      return;
    }
    local_1c = local_1c + -1;
    iVar6 = local_20 + 1;
    param_1 = (int *)(*(int *)(in_ECX + 0x128) + local_20 * 0xc);
    uVar7 = local_c;
    local_20 = iVar6;
    if (local_1c == 0) {
      local_8 = *(int *)(*param_1 + 0x28);
      local_c = uVar1;
    }
    else {
      local_8 = *(int *)(*param_1 + 0x28);
      local_c = *(uint *)(*(int *)(in_ECX + 0x128) + 8 + iVar6 * 0xc);
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
005fd2b0 : MOV EAX,dword ptr [ESP + 0x8]
005fd2b4 : SUB ESP,0x2c
005fd2b7 : PUSH EBX
005fd2b8 : PUSH EBP
005fd2b9 : PUSH ESI
005fd2ba : MOV ESI,ECX
005fd2bc : MOV ECX,dword ptr [EAX + 0x18]
005fd2bf : PUSH EDI
005fd2c0 : MOV EDI,dword ptr [ESP + 0x40]
005fd2c4 : CMP ECX,-0x1
005fd2c7 : JNZ 0x005fd2cf
005fd2c9 : MOV dword ptr [ESP + 0x10],EDI
005fd2cd : JMP 0x005fd2df
005fd2cf : MOV EDX,dword ptr [ESI + 0x128]
005fd2d5 : LEA ECX,[ECX + ECX*0x2]
005fd2d8 : LEA ECX,[EDX + ECX*0x4]
005fd2db : MOV dword ptr [ESP + 0x10],ECX
005fd2df : MOV EDX,dword ptr [EAX + 0x14]
005fd2e2 : MOV ECX,dword ptr [EAX + 0x10]
005fd2e5 : MOV EBX,dword ptr [EAX + 0x8]
005fd2e8 : MOV dword ptr [ESP + 0x20],EDX
005fd2ec : MOV EDX,dword ptr [EAX + 0xc]
005fd2ef : MOV dword ptr [ESP + 0x1c],ECX
005fd2f3 : MOV dword ptr [ESP + 0x24],EDX
005fd2f7 : MOV EDX,dword ptr [ESI + 0x128]
005fd2fd : LEA ECX,[ECX + ECX*0x2]
005fd300 : MOV ECX,dword ptr [EDX + ECX*0x4 + 0x8]
005fd304 : MOV EDX,dword ptr [EAX + 0x4]
005fd307 : MOV EAX,dword ptr [EDI + 0x4]
005fd30a : MOV dword ptr [ESP + 0x30],ECX
005fd30e : MOV ECX,dword ptr [EAX + 0x10]
005fd311 : MOV dword ptr [ESP + 0x40],ECX
005fd315 : PUSH 0x0
005fd317 : MOV ECX,ESI
005fd319 : MOV dword ptr [ESP + 0x38],EDX
005fd31d : MOV byte ptr [ESP + 0x3c],0x1
005fd322 : CALL 0x005fcc20
005fd327 : MOV EBP,EAX
005fd329 : MOV EAX,dword ptr [EDI + 0x4]
005fd32c : MOV EDX,dword ptr [EAX]
005fd32e : MOV dword ptr [EBP],EDX
005fd331 : MOV ECX,dword ptr [EAX + 0x4]
005fd334 : MOV dword ptr [EBP + 0x4],ECX
005fd337 : MOV EDX,dword ptr [EAX + 0x8]
005fd33a : MOV dword ptr [EBP + 0x8],EDX
005fd33d : MOV ECX,dword ptr [EAX + 0xc]
005fd340 : MOV dword ptr [EBP + 0xc],ECX
005fd343 : MOV EDX,dword ptr [EAX + 0x10]
005fd346 : MOV dword ptr [EBP + 0x10],EDX
005fd349 : MOV EAX,dword ptr [EAX + 0x14]
005fd34c : MOV dword ptr [EBP + 0x14],EAX
005fd34f : MOV EAX,dword ptr [EDI + 0x4]
005fd352 : OR ECX,0xffffffff
005fd355 : MOV dword ptr [EAX + 0x4],ECX
005fd358 : MOV dword ptr [EAX + 0x8],ECX
005fd35b : MOV dword ptr [EAX + 0xc],ECX
005fd35e : MOV ECX,dword ptr [ESP + 0x40]
005fd362 : MOV dword ptr [EAX],0x0
005fd368 : MOV dword ptr [EAX + 0x10],ECX
005fd36b : MOV dword ptr [EAX + 0x14],0x0
005fd372 : CMP dword ptr [ESP + 0x20],0x0
005fd377 : JZ 0x005fd3ff
005fd37d : CMP EBX,dword ptr [ESP + 0x30]
005fd381 : JZ 0x005fd431
005fd387 : MOV EDX,dword ptr [ESP + 0x40]
005fd38b : PUSH EDX
005fd38c : PUSH EDI
005fd38d : MOV ECX,ESI
005fd38f : CALL 0x005fcc80
005fd394 : MOV ECX,dword ptr [ESP + 0x48]
005fd398 : MOV EAX,dword ptr [EDI + 0x4]
005fd39b : MOV dword ptr [ESP + 0x14],EAX
005fd39f : CMP ECX,-0x1
005fd3a2 : JZ 0x005fd3c9
005fd3a4 : OR ECX,0x40000000
005fd3aa : PUSH ECX
005fd3ab : PUSH EAX
005fd3ac : MOV ECX,ESI
005fd3ae : CALL 0x005fcb20
005fd3b3 : MOV EAX,dword ptr [ESP + 0x48]
005fd3b7 : MOV ECX,dword ptr [ESP + 0x14]
005fd3bb : AND EAX,0xbfffffff
005fd3c0 : PUSH EAX
005fd3c1 : PUSH ECX
005fd3c2 : MOV ECX,ESI
005fd3c4 : CALL 0x005fcb20
005fd3c9 : MOV EAX,dword ptr [EDI + 0x4]
005fd3cc : MOV dword ptr [ESP + 0x14],EAX
005fd3d0 : CMP EBX,-0x1
005fd3d3 : JZ 0x005fd3ea
005fd3d5 : MOV EDX,EBX
005fd3d7 : OR EDX,0x40000000
005fd3dd : PUSH EDX
005fd3de : PUSH EAX
005fd3df : MOV ECX,ESI
005fd3e1 : CALL 0x005fcb20
005fd3e6 : MOV EAX,dword ptr [ESP + 0x14]
005fd3ea : CMP dword ptr [ESP + 0x30],-0x1
005fd3ef : JZ 0x005fd431
005fd3f1 : MOV ECX,dword ptr [ESP + 0x30]
005fd3f5 : AND ECX,0xbfffffff
005fd3fb : PUSH ECX
005fd3fc : PUSH EAX
005fd3fd : JMP 0x005fd42a
005fd3ff : MOV dword ptr [EDI + 0x4],EBP
005fd402 : CMP EBX,-0x1
005fd405 : JZ 0x005fd418
005fd407 : MOV EDX,EBX
005fd409 : OR EDX,0x40000000
005fd40f : PUSH EDX
005fd410 : PUSH EBP
005fd411 : MOV ECX,ESI
005fd413 : CALL 0x005fcb20
005fd418 : CMP dword ptr [ESP + 0x30],-0x1
005fd41d : JZ 0x005fd431
005fd41f : MOV EAX,dword ptr [ESP + 0x30]
005fd423 : AND EAX,0xbfffffff
005fd428 : PUSH EAX
005fd429 : PUSH EBP
005fd42a : MOV ECX,ESI
005fd42c : CALL 0x005fcb20
005fd431 : MOV EAX,dword ptr [ESP + 0x34]
005fd435 : CMP EAX,dword ptr [ESP + 0x40]
005fd439 : JNZ 0x005fd441
005fd43b : CMP dword ptr [EDI + 0x4],0x0
005fd43f : JNZ 0x005fd498
005fd441 : MOV ECX,dword ptr [ESI + 0x24]
005fd444 : CMP byte ptr [EAX + ECX*0x1],0x0
005fd448 : JNZ 0x005fd453
005fd44a : MOV dword ptr [EDI + 0x4],0x0
005fd451 : JMP 0x005fd498
005fd453 : CMP byte ptr [ESP + 0x38],0x0
005fd458 : JZ 0x005fd45e
005fd45a : MOV EDI,dword ptr [ESP + 0x10]
005fd45e : PUSH EAX
005fd45f : PUSH EDI
005fd460 : MOV ECX,ESI
005fd462 : CALL 0x005fcc80
005fd467 : MOV EDI,dword ptr [EDI + 0x4]
005fd46a : CMP EBX,-0x1
005fd46d : JZ 0x005fd47e
005fd46f : OR EBX,0x40000000
005fd475 : PUSH EBX
005fd476 : PUSH EDI
005fd477 : MOV ECX,ESI
005fd479 : CALL 0x005fcb20
005fd47e : CMP dword ptr [ESP + 0x30],-0x1
005fd483 : JZ 0x005fd498
005fd485 : MOV EDX,dword ptr [ESP + 0x30]
005fd489 : AND EDX,0xbfffffff
005fd48f : PUSH EDX
005fd490 : PUSH EDI
005fd491 : MOV ECX,ESI
005fd493 : CALL 0x005fcb20
005fd498 : CMP dword ptr [ESP + 0x20],0x0
005fd49d : MOV byte ptr [ESP + 0x38],0x0
005fd4a2 : JZ 0x005fd4f9
005fd4a4 : MOV ECX,dword ptr [ESP + 0x1c]
005fd4a8 : DEC dword ptr [ESP + 0x20]
005fd4ac : MOV EDX,dword ptr [ESI + 0x128]
005fd4b2 : MOV EBX,dword ptr [ESP + 0x30]
005fd4b6 : MOV EAX,ECX
005fd4b8 : INC ECX
005fd4b9 : CMP dword ptr [ESP + 0x20],0x0
005fd4be : LEA EAX,[EAX + EAX*0x2]
005fd4c1 : MOV dword ptr [ESP + 0x1c],ECX
005fd4c5 : LEA EDI,[EDX + EAX*0x4]
005fd4c8 : JZ 0x005fd4e3
005fd4ca : LEA ECX,[ECX + ECX*0x2]
005fd4cd : MOV EDX,dword ptr [EDX + ECX*0x4 + 0x8]
005fd4d1 : MOV ECX,dword ptr [EDI]
005fd4d3 : MOV dword ptr [ESP + 0x30],EDX
005fd4d7 : MOV EDX,dword ptr [ECX + 0x28]
005fd4da : MOV dword ptr [ESP + 0x34],EDX
005fd4de : JMP 0x005fd372
005fd4e3 : MOV ECX,dword ptr [EDI]
005fd4e5 : MOV EAX,dword ptr [ESP + 0x24]
005fd4e9 : MOV EDX,dword ptr [ECX + 0x28]
005fd4ec : MOV dword ptr [ESP + 0x30],EAX
005fd4f0 : MOV dword ptr [ESP + 0x34],EDX
005fd4f4 : JMP 0x005fd372
005fd4f9 : MOV EAX,dword ptr [ESP + 0x44]
005fd4fd : POP EDI
005fd4fe : POP ESI
005fd4ff : POP EBP
005fd500 : MOV dword ptr [EAX + 0x14],0x0
005fd507 : POP EBX
005fd508 : ADD ESP,0x2c
005fd50b : RET 0xc

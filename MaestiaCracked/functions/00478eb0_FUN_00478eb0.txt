PROGRAM  : Maestia.exe
FUNCTION : FUN_00478eb0
ENTRY    : 00478eb0
BODY     : [[00478eb0, 0047902a] [0047903c, 00479124]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00478eb0(int param_1,undefined4 *param_2,undefined4 *param_3)

{
  uint *puVar1;
  int iVar2;
  uint uVar3;
  undefined4 uVar4;
  undefined4 *puVar5;
  int extraout_ECX;
  int iVar6;
  int iVar7;
  undefined4 *puVar8;
  undefined4 *puVar9;
  undefined4 *puVar10;
  uint uStack_a0;
  uint local_7c;
  undefined4 local_78 [23];
  uint local_1c;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7a630;
  local_10 = ExceptionList;
  uStack_a0 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&uStack_a0;
  ExceptionList = &local_10;
  iVar2 = *(int *)(param_1 + 4);
  if (iVar2 == 0) {
    local_7c = 0;
  }
  else {
    local_7c = (*(int *)(param_1 + 0xc) - iVar2) / 0x54;
  }
  iVar6 = *(int *)(param_1 + 8);
  iVar2 = (iVar6 - iVar2) / 0x54;
  local_1c = uStack_a0;
  puVar1 = &uStack_a0;
  if (iVar2 == 0x30c30c3) {
    iVar2 = FUN_00429be0();
    iVar6 = extraout_ECX;
    puVar1 = (uint *)local_14;
  }
  local_14 = (undefined1 *)puVar1;
  uVar3 = iVar2 + 1;
  if (local_7c < uVar3) {
    if (0x30c30c3 - (local_7c >> 1) < local_7c) {
      local_7c = 0;
    }
    else {
      local_7c = local_7c + (local_7c >> 1);
    }
    if (local_7c < uVar3) {
      local_7c = uVar3;
    }
    iVar2 = FUN_004796c0();
    local_8 = 0;
    FUN_00478c20();
    FUN_00479660(*(undefined4 *)(param_1 + 4),param_2);
    FUN_00479660(param_2,*(undefined4 *)(param_1 + 8));
    local_8 = 0xffffffff;
    if (*(int *)(param_1 + 4) != 0) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    *(uint *)(param_1 + 0xc) = local_7c * 0x54 + iVar2;
    *(int *)(param_1 + 8) =
         ((*(int *)(param_1 + 8) - *(int *)(param_1 + 4)) / 0x54 + 1) * 0x54 + iVar2;
    *(int *)(param_1 + 4) = iVar2;
  }
  else {
    iVar2 = iVar6 - (int)param_2 >> 0x1f;
    puVar9 = local_78;
    for (iVar7 = 0x15; iVar7 != 0; iVar7 = iVar7 + -1) {
      *puVar9 = *param_3;
      param_3 = param_3 + 1;
      puVar9 = puVar9 + 1;
    }
    if ((iVar6 - (int)param_2) / 0x54 + iVar2 == iVar2) {
      FUN_00479660(param_2,*(undefined4 *)(param_1 + 8));
      local_8 = 2;
      FUN_00478c20();
      local_8 = 0xffffffff;
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 0x54;
    }
    else {
      puVar5 = *(undefined4 **)(param_1 + 8);
      puVar9 = puVar5 + -0x15;
      uVar4 = FUN_00479660(puVar9,puVar5);
      *(undefined4 *)(param_1 + 8) = uVar4;
      while (param_2 != puVar9) {
        puVar9 = puVar9 + -0x15;
        puVar5 = puVar5 + -0x15;
        puVar8 = puVar9;
        puVar10 = puVar5;
        for (iVar2 = 0x15; iVar2 != 0; iVar2 = iVar2 + -1) {
          *puVar10 = *puVar8;
          puVar8 = puVar8 + 1;
          puVar10 = puVar10 + 1;
        }
      }
    }
    FUN_00479690(local_78);
  }
  ExceptionList = local_10;
  __security_check_cookie(local_1c ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00478eb0 : PUSH EBP
00478eb1 : MOV EBP,ESP
00478eb3 : PUSH -0x1
00478eb5 : PUSH 0xb7a630
00478eba : MOV EAX,FS:[0x0]
00478ec0 : PUSH EAX
00478ec1 : SUB ESP,0x80
00478ec7 : MOV EAX,[0x00d66fa0]
00478ecc : XOR EAX,EBP
00478ece : MOV dword ptr [EBP + -0x18],EAX
00478ed1 : PUSH EBX
00478ed2 : PUSH ESI
00478ed3 : PUSH EDI
00478ed4 : PUSH EAX
00478ed5 : LEA EAX,[EBP + -0xc]
00478ed8 : MOV FS:[0x0],EAX
00478ede : MOV dword ptr [EBP + -0x10],ESP
00478ee1 : MOV EBX,dword ptr [EBP + 0x8]
00478ee4 : MOV EAX,dword ptr [EBP + 0x10]
00478ee7 : MOV dword ptr [EBP + -0x7c],EAX
00478eea : MOV EDI,dword ptr [EBX + 0x4]
00478eed : TEST EDI,EDI
00478eef : JNZ 0x00478ef5
00478ef1 : XOR ESI,ESI
00478ef3 : JMP 0x00478f0d
00478ef5 : MOV ECX,dword ptr [EBX + 0xc]
00478ef8 : SUB ECX,EDI
00478efa : MOV EAX,0x30c30c31
00478eff : IMUL ECX
00478f01 : SAR EDX,0x4
00478f04 : MOV EAX,EDX
00478f06 : SHR EAX,0x1f
00478f09 : ADD EAX,EDX
00478f0b : MOV ESI,EAX
00478f0d : MOV ECX,dword ptr [EBX + 0x8]
00478f10 : MOV EDX,ECX
00478f12 : SUB EDX,EDI
00478f14 : MOV EAX,0x30c30c31
00478f19 : IMUL EDX
00478f1b : SAR EDX,0x4
00478f1e : MOV EAX,EDX
00478f20 : SHR EAX,0x1f
00478f23 : ADD EAX,EDX
00478f25 : MOV EDX,0x30c30c3
00478f2a : SUB EDX,EAX
00478f2c : CMP EDX,0x1
00478f2f : JNC 0x00478f36
00478f31 : CALL 0x00429be0
00478f36 : INC EAX
00478f37 : CMP ESI,EAX
00478f39 : JNC 0x0047903c
00478f3f : MOV ECX,ESI
00478f41 : SHR ECX,0x1
00478f43 : MOV EDX,0x30c30c3
00478f48 : SUB EDX,ECX
00478f4a : CMP EDX,ESI
00478f4c : JNC 0x00478f5a
00478f4e : MOV dword ptr [EBP + -0x78],0x0
00478f55 : MOV ESI,dword ptr [EBP + -0x78]
00478f58 : JMP 0x00478f5f
00478f5a : ADD ESI,ECX
00478f5c : MOV dword ptr [EBP + -0x78],ESI
00478f5f : CMP ESI,EAX
00478f61 : JNC 0x00478f68
00478f63 : MOV dword ptr [EBP + -0x78],EAX
00478f66 : MOV ESI,EAX
00478f68 : MOV ECX,ESI
00478f6a : CALL 0x004796c0
00478f6f : MOV ESI,EAX
00478f71 : MOV dword ptr [EBP + -0x80],ESI
00478f74 : MOV ECX,dword ptr [EBP + 0xc]
00478f77 : SUB ECX,dword ptr [EBX + 0x4]
00478f7a : MOV EAX,0x30c30c31
00478f7f : IMUL ECX
00478f81 : SAR EDX,0x4
00478f84 : MOV EDI,EDX
00478f86 : SHR EDI,0x1f
00478f89 : ADD EDI,EDX
00478f8b : MOV dword ptr [EBP + 0xffffff7c],EDI
00478f91 : MOV dword ptr [EBP + -0x4],0x0
00478f98 : IMUL EDI,EDI,0x54
00478f9b : ADD EDI,ESI
00478f9d : MOV EDX,dword ptr [EBP + -0x7c]
00478fa0 : MOV ESI,0x1
00478fa5 : CALL 0x00478c20
00478faa : MOV dword ptr [EBP + 0xffffff78],ESI
00478fb0 : MOV EAX,dword ptr [EBP + 0xc]
00478fb3 : PUSH EAX
00478fb4 : MOV ECX,dword ptr [EBX + 0x4]
00478fb7 : PUSH ECX
00478fb8 : MOV ESI,dword ptr [EBP + -0x80]
00478fbb : MOV EDX,ESI
00478fbd : CALL 0x00479660
00478fc2 : MOV dword ptr [EBP + 0xffffff78],0x2
00478fcc : MOV EDX,dword ptr [EBP + 0xffffff7c]
00478fd2 : INC EDX
00478fd3 : IMUL EDX,EDX,0x54
00478fd6 : ADD EDX,ESI
00478fd8 : MOV EAX,dword ptr [EBX + 0x8]
00478fdb : PUSH EAX
00478fdc : MOV ECX,dword ptr [EBP + 0xc]
00478fdf : PUSH ECX
00478fe0 : CALL 0x00479660
00478fe5 : MOV dword ptr [EBP + -0x4],0xffffffff
00478fec : MOV ECX,dword ptr [EBX + 0x4]
00478fef : MOV EDX,dword ptr [EBX + 0x8]
00478ff2 : SUB EDX,ECX
00478ff4 : MOV EAX,0x30c30c31
00478ff9 : IMUL EDX
00478ffb : SAR EDX,0x4
00478ffe : MOV EAX,EDX
00479000 : SHR EAX,0x1f
00479003 : LEA EDI,[EDX + EAX*0x1 + 0x1]
00479007 : TEST ECX,ECX
00479009 : JZ 0x00479010
0047900b : CALL 0x006f04e0
00479010 : MOV EAX,dword ptr [EBP + -0x78]
00479013 : IMUL EAX,EAX,0x54
00479016 : ADD EAX,ESI
00479018 : MOV dword ptr [EBX + 0xc],EAX
0047901b : IMUL EDI,EDI,0x54
0047901e : ADD EDI,ESI
00479020 : MOV dword ptr [EBX + 0x8],EDI
00479023 : MOV dword ptr [EBX + 0x4],ESI
00479026 : JMP 0x00479107
0047903c : SUB ECX,dword ptr [EBP + 0xc]
0047903f : MOV EAX,0x30c30c31
00479044 : IMUL ECX
00479046 : SAR EDX,0x4
00479049 : MOV ECX,EDX
0047904b : SHR ECX,0x1f
0047904e : ADD ECX,EDX
00479050 : MOV ESI,dword ptr [EBP + -0x7c]
00479053 : LEA EDI,[EBP + -0x74]
00479056 : CMP ECX,0x1
00479059 : MOV ECX,0x15
0047905e : MOVSD.REP ES:EDI,ESI
00479060 : JNC 0x004790bb
00479062 : MOV EAX,dword ptr [EBP + 0xc]
00479065 : LEA EDX,[EAX + 0x54]
00479068 : MOV ECX,dword ptr [EBX + 0x8]
0047906b : PUSH ECX
0047906c : PUSH EAX
0047906d : CALL 0x00479660
00479072 : MOV dword ptr [EBP + -0x4],0x2
00479079 : MOV EDI,dword ptr [EBX + 0x8]
0047907c : MOV ECX,EDI
0047907e : SUB ECX,dword ptr [EBP + 0xc]
00479081 : MOV EAX,0x30c30c31
00479086 : IMUL ECX
00479088 : SAR EDX,0x4
0047908b : MOV EAX,EDX
0047908d : SHR EAX,0x1f
00479090 : ADD EAX,EDX
00479092 : MOV ESI,0x1
00479097 : SUB ESI,EAX
00479099 : LEA EDX,[EBP + -0x74]
0047909c : CALL 0x00478c20
004790a1 : MOV dword ptr [EBP + -0x4],0xffffffff
004790a8 : ADD dword ptr [EBX + 0x8],0x54
004790ac : MOV EBX,dword ptr [EBX + 0x8]
004790af : LEA ECX,[EBP + -0x74]
004790b2 : PUSH ECX
004790b3 : LEA EDX,[EBX + -0x54]
004790b6 : MOV EAX,dword ptr [EBP + 0xc]
004790b9 : JMP 0x004790ff
004790bb : MOV EDX,dword ptr [EBX + 0x8]
004790be : LEA ESI,[EDX + -0x54]
004790c1 : PUSH EDX
004790c2 : PUSH ESI
004790c3 : CALL 0x00479660
004790c8 : MOV dword ptr [EBX + 0x8],EAX
004790cb : MOV EDX,ESI
004790cd : MOV EAX,dword ptr [EBP + 0xc]
004790d0 : MOV EBX,EAX
004790d2 : CMP EAX,EDX
004790d4 : JZ 0x004790f8
004790d6 : LEA EAX,[EDX + 0x54]
004790d9 : LEA ESP,[ESP]
004790e0 : SUB EDX,0x54
004790e3 : SUB EAX,0x54
004790e6 : MOV ECX,0x15
004790eb : MOV ESI,EDX
004790ed : MOV EDI,EAX
004790ef : MOVSD.REP ES:EDI,ESI
004790f1 : CMP EDX,EBX
004790f3 : JNZ 0x004790e0
004790f5 : MOV EAX,dword ptr [EBP + 0xc]
004790f8 : LEA EDX,[EBP + -0x74]
004790fb : PUSH EDX
004790fc : LEA EDX,[EAX + 0x54]
004790ff : CALL 0x00479690
00479104 : ADD ESP,0x4
00479107 : MOV ECX,dword ptr [EBP + -0xc]
0047910a : MOV dword ptr FS:[0x0],ECX
00479111 : POP ECX
00479112 : POP EDI
00479113 : POP ESI
00479114 : POP EBX
00479115 : MOV ECX,dword ptr [EBP + -0x18]
00479118 : XOR ECX,EBP
0047911a : CALL 0x00633e6b
0047911f : MOV ESP,EBP
00479121 : POP EBP
00479122 : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_005a7880
ENTRY    : 005a7880
BODY     : [[005a7880, 005a79ef]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 *
FUN_005a7880(undefined4 param_1,undefined4 *param_2,undefined4 param_3,int *param_4,
            undefined4 param_5,undefined4 param_6,undefined4 param_7,int param_8)

{
  int *piVar1;
  int iVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  int in_ECX;
  
  EnterCriticalSection((LPCRITICAL_SECTION)(in_ECX + 0x9e4));
  FUN_005a5430(*(undefined4 *)(*param_4 + 0xc));
  if (param_2 != (undefined4 *)0x0) {
    if (param_2[3] == in_ECX) {
      if (param_2[2] == 0) {
        iVar2 = FUN_00515840(0x28,0);
        if (iVar2 == 0) {
          param_2[2] = 0;
        }
        else {
          uVar3 = FUN_005a4240();
          param_2[2] = uVar3;
        }
      }
      else if (param_8 != 0) {
        FUN_005a55c0();
      }
      goto LAB_005a79a7;
    }
    iVar2 = param_2[2];
    if (iVar2 != 0) {
      if (*(int **)(iVar2 + 0x1c) != (int *)0x0) {
        (**(code **)(**(int **)(iVar2 + 0x1c) + 0x44))((undefined4 *)(iVar2 + 0x1c),3);
      }
      *(undefined4 *)(iVar2 + 0x1c) = 0;
      *(undefined4 *)(iVar2 + 0x20) = 0;
      FUN_00515cf0(*(undefined4 *)(iVar2 + 0x10));
      FUN_00515cf0(*(undefined4 *)(iVar2 + 4));
      FUN_005a2e80();
      FUN_00515cf0(iVar2);
    }
  }
  param_2 = (undefined4 *)FUN_005a3780();
  param_2[3] = in_ECX;
  puVar4 = (undefined4 *)FUN_00515840(0x28,0);
  if (puVar4 == (undefined4 *)0x0) {
    puVar4 = (undefined4 *)0x0;
  }
  else {
    *puVar4 = 0;
    puVar4[1] = 0;
    puVar4[2] = 0;
    puVar4[3] = 0;
    puVar4[4] = 0;
    puVar4[5] = 0;
    puVar4[6] = 0;
    puVar4[7] = 0;
    puVar4[8] = 0;
    *(undefined1 *)(puVar4 + 9) = 0;
    *(undefined1 *)((int)puVar4 + 0x25) = 0;
  }
  param_2[2] = puVar4;
  piVar1 = (int *)(in_ECX + 0x38);
  *param_2 = *(undefined4 *)(in_ECX + 0x38);
  param_2[1] = piVar1;
  *(undefined4 **)(*piVar1 + 4) = param_2;
  *piVar1 = (int)param_2;
LAB_005a79a7:
  FUN_005a5dd0(param_2[2],param_3,param_4,param_5,param_6,param_7,param_8);
  FUN_005f3200(*(undefined4 *)(*param_4 + 0xc));
  LeaveCriticalSection((LPCRITICAL_SECTION)(in_ECX + 0x9e4));
  return param_2;
}



============================================================
DISASSEMBLY
============================================================
005a7880 : PUSH ECX
005a7881 : PUSH EBX
005a7882 : PUSH EBP
005a7883 : PUSH ESI
005a7884 : PUSH EDI
005a7885 : MOV EDI,ECX
005a7887 : LEA EAX,[EDI + 0x9e4]
005a788d : PUSH EAX
005a788e : MOV dword ptr [ESP + 0x14],EAX
005a7892 : CALL dword ptr [0x00b85118]
005a7898 : XOR EBX,EBX
005a789a : CMP dword ptr [ESP + 0x18],EBX
005a789e : JNZ 0x005a78a6
005a78a0 : MOV EAX,dword ptr [EDI]
005a78a2 : MOV dword ptr [ESP + 0x18],EAX
005a78a6 : MOV EBP,dword ptr [ESP + 0x24]
005a78aa : MOV ECX,dword ptr [EBP]
005a78ad : MOV EDX,dword ptr [ECX + 0xc]
005a78b0 : PUSH EDX
005a78b1 : MOV ECX,EDI
005a78b3 : CALL 0x005a5430
005a78b8 : MOV ESI,dword ptr [ESP + 0x1c]
005a78bc : CMP ESI,EBX
005a78be : JZ 0x005a7951
005a78c4 : CMP dword ptr [ESI + 0xc],EDI
005a78c7 : JNZ 0x005a790d
005a78c9 : MOV ECX,dword ptr [ESI + 0x8]
005a78cc : CMP ECX,EBX
005a78ce : JZ 0x005a78e4
005a78d0 : CMP dword ptr [ESP + 0x34],EBX
005a78d4 : JZ 0x005a79a7
005a78da : CALL 0x005a55c0
005a78df : JMP 0x005a79a7
005a78e4 : MOV ECX,dword ptr [ESP + 0x18]
005a78e8 : PUSH EBX
005a78e9 : PUSH 0x28
005a78eb : CALL 0x00515840
005a78f0 : CMP EAX,EBX
005a78f2 : JZ 0x005a7903
005a78f4 : MOV ECX,EAX
005a78f6 : CALL 0x005a4240
005a78fb : MOV dword ptr [ESI + 0x8],EAX
005a78fe : JMP 0x005a79a7
005a7903 : XOR EAX,EAX
005a7905 : MOV dword ptr [ESI + 0x8],EAX
005a7908 : JMP 0x005a79a7
005a790d : MOV ESI,dword ptr [ESI + 0x8]
005a7910 : CMP ESI,EBX
005a7912 : JZ 0x005a7951
005a7914 : MOV ECX,dword ptr [ESI + 0x1c]
005a7917 : LEA EBP,[ESI + 0x1c]
005a791a : CMP ECX,EBX
005a791c : JZ 0x005a7928
005a791e : MOV EAX,dword ptr [ECX]
005a7920 : MOV EDX,dword ptr [EAX + 0x44]
005a7923 : PUSH 0x3
005a7925 : PUSH EBP
005a7926 : CALL EDX
005a7928 : MOV dword ptr [EBP],EBX
005a792b : MOV dword ptr [EBP + 0x4],EBX
005a792e : MOV EAX,dword ptr [ESI + 0x10]
005a7931 : PUSH EAX
005a7932 : CALL 0x00515cf0
005a7937 : MOV ECX,dword ptr [ESI + 0x4]
005a793a : PUSH ECX
005a793b : CALL 0x00515cf0
005a7940 : MOV ECX,ESI
005a7942 : CALL 0x005a2e80
005a7947 : PUSH ESI
005a7948 : CALL 0x00515cf0
005a794d : MOV EBP,dword ptr [ESP + 0x24]
005a7951 : LEA ECX,[EDI + 0x24]
005a7954 : CALL 0x005a3780
005a7959 : MOV ECX,dword ptr [ESP + 0x18]
005a795d : PUSH EBX
005a795e : MOV ESI,EAX
005a7960 : PUSH 0x28
005a7962 : MOV dword ptr [ESI + 0xc],EDI
005a7965 : CALL 0x00515840
005a796a : CMP EAX,EBX
005a796c : JZ 0x005a7990
005a796e : MOV dword ptr [EAX],EBX
005a7970 : MOV dword ptr [EAX + 0x4],EBX
005a7973 : MOV dword ptr [EAX + 0x8],EBX
005a7976 : MOV dword ptr [EAX + 0xc],EBX
005a7979 : MOV dword ptr [EAX + 0x10],EBX
005a797c : MOV dword ptr [EAX + 0x14],EBX
005a797f : MOV dword ptr [EAX + 0x18],EBX
005a7982 : MOV dword ptr [EAX + 0x1c],EBX
005a7985 : MOV dword ptr [EAX + 0x20],EBX
005a7988 : MOV byte ptr [EAX + 0x24],BL
005a798b : MOV byte ptr [EAX + 0x25],BL
005a798e : JMP 0x005a7992
005a7990 : XOR EAX,EAX
005a7992 : MOV dword ptr [ESI + 0x8],EAX
005a7995 : MOV EDX,dword ptr [EDI + 0x38]
005a7998 : LEA EAX,[EDI + 0x38]
005a799b : MOV dword ptr [ESI],EDX
005a799d : MOV dword ptr [ESI + 0x4],EAX
005a79a0 : MOV ECX,dword ptr [EAX]
005a79a2 : MOV dword ptr [ECX + 0x4],ESI
005a79a5 : MOV dword ptr [EAX],ESI
005a79a7 : MOV EDX,dword ptr [ESP + 0x34]
005a79ab : MOV EAX,dword ptr [ESP + 0x30]
005a79af : MOV ECX,dword ptr [ESP + 0x2c]
005a79b3 : PUSH EDX
005a79b4 : MOV EDX,dword ptr [ESP + 0x2c]
005a79b8 : PUSH EAX
005a79b9 : MOV EAX,dword ptr [ESP + 0x28]
005a79bd : PUSH ECX
005a79be : MOV ECX,dword ptr [ESI + 0x8]
005a79c1 : PUSH EDX
005a79c2 : PUSH EBP
005a79c3 : PUSH EAX
005a79c4 : PUSH ECX
005a79c5 : MOV ECX,EDI
005a79c7 : CALL 0x005a5dd0
005a79cc : MOV EDX,dword ptr [EBP]
005a79cf : MOV EAX,dword ptr [EDX + 0xc]
005a79d2 : PUSH EAX
005a79d3 : LEA ECX,[EDI + 0x40]
005a79d6 : CALL 0x005f3200
005a79db : MOV ECX,dword ptr [ESP + 0x10]
005a79df : PUSH ECX
005a79e0 : CALL dword ptr [0x00b8511c]
005a79e6 : POP EDI
005a79e7 : MOV EAX,ESI
005a79e9 : POP ESI
005a79ea : POP EBP
005a79eb : POP EBX
005a79ec : POP ECX
005a79ed : RET 0x20

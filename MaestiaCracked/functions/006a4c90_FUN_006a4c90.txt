PROGRAM  : Maestia.exe
FUNCTION : FUN_006a4c90
ENTRY    : 006a4c90
BODY     : [[006a4c90, 006a4e3e]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006a4c90(undefined1 *param_1,byte *param_2,undefined4 *param_3)

{
  byte *pbVar1;
  int iVar2;
  undefined4 *puVar3;
  byte *pbVar4;
  byte bVar5;
  uint uVar6;
  undefined4 uVar7;
  int local_8;
  undefined4 local_4;
  
  uVar7 = *param_3;
  local_8 = 0;
  local_4 = uVar7;
  puVar3 = (undefined4 *)FUN_00688c00(uVar7,0x18,&local_8);
  if (local_8 != 0) {
    return local_8;
  }
  if (param_1 + 4 <= param_2) {
    *(undefined1 *)(puVar3 + 1) = *param_1;
    *(ushort *)((int)puVar3 + 6) = CONCAT11(param_1[1],param_1[2]);
    *(undefined1 *)((int)puVar3 + 5) = param_1[3];
    pbVar4 = param_1 + 4;
    puVar3[3] = pbVar4 + (param_3[1] - param_3[0x25]);
    bVar5 = *(byte *)((int)puVar3 + 5) & 1;
    puVar3[2] = 3;
    if (bVar5 != 0) {
      puVar3[2] = 5;
    }
    if ((*(byte *)((int)puVar3 + 5) & 2) != 0) {
      puVar3[2] = puVar3[2] + 1;
    }
    uVar6 = (uint)*(byte *)(puVar3 + 1);
    iVar2 = puVar3[2];
    uVar7 = local_4;
    if (pbVar4 + uVar6 * iVar2 <= param_2) {
      if (*(char *)(puVar3 + 1) == '\0') {
        FUN_00687f30(local_4,puVar3);
        return local_8;
      }
      if (bVar5 == 0) {
        puVar3[4] = (uint)*pbVar4 << 0x10 | (uint)(byte)param_1[5];
        puVar3[5] = (uint)pbVar4[(uVar6 - 1) * iVar2] << 0x10 |
                    (uint)(pbVar4 + (uVar6 - 1) * iVar2)[1];
      }
      else {
        pbVar1 = pbVar4 + (uVar6 - 1) * iVar2 + 2;
        puVar3[4] = CONCAT22(CONCAT11(*pbVar4,param_1[5]),CONCAT11(param_1[6],param_1[7]));
        puVar3[5] = CONCAT22(CONCAT11(pbVar1[-2],pbVar1[-1]),CONCAT11(*pbVar1,pbVar1[1]));
      }
      *puVar3 = 0;
      *(undefined4 **)param_3[0x23] = puVar3;
      param_3[0x23] = puVar3;
      param_3[0x21] = param_3[0x21] + (uint)*(byte *)(puVar3 + 1);
      return 0;
    }
  }
  FUN_00687f30(uVar7,puVar3);
  return 8;
}



============================================================
DISASSEMBLY
============================================================
006a4c90 : SUB ESP,0xc
006a4c93 : PUSH ESI
006a4c94 : MOV ESI,dword ptr [ESP + 0x1c]
006a4c98 : PUSH EDI
006a4c99 : MOV EDI,dword ptr [ESI]
006a4c9b : LEA EAX,[ESP + 0xc]
006a4c9f : PUSH EAX
006a4ca0 : PUSH 0x18
006a4ca2 : PUSH EDI
006a4ca3 : MOV dword ptr [ESP + 0x18],0x0
006a4cab : MOV dword ptr [ESP + 0x1c],EDI
006a4caf : CALL 0x00688c00
006a4cb4 : MOV ECX,dword ptr [ESP + 0x18]
006a4cb8 : ADD ESP,0xc
006a4cbb : TEST ECX,ECX
006a4cbd : JNZ 0x006a4e37
006a4cc3 : MOV ECX,dword ptr [ESP + 0x18]
006a4cc7 : LEA EDX,[ECX + 0x4]
006a4cca : PUSH EBX
006a4ccb : PUSH EBP
006a4ccc : CMP EDX,dword ptr [ESP + 0x24]
006a4cd0 : JA 0x006a4d3d
006a4cd2 : MOVZX EDX,byte ptr [ECX]
006a4cd5 : MOV byte ptr [EAX + 0x4],DL
006a4cd8 : MOVSX DX,byte ptr [ECX + 0x1]
006a4cdd : MOVZX DI,byte ptr [ECX + 0x2]
006a4ce2 : ADD ECX,0x3
006a4ce5 : SHL DX,0x8
006a4ce9 : OR DX,DI
006a4cec : MOV word ptr [EAX + 0x6],DX
006a4cf0 : MOVZX EDX,byte ptr [ECX]
006a4cf3 : MOV byte ptr [EAX + 0x5],DL
006a4cf6 : MOV EDX,dword ptr [ESI + 0x4]
006a4cf9 : SUB EDX,dword ptr [ESI + 0x94]
006a4cff : INC ECX
006a4d00 : ADD EDX,ECX
006a4d02 : MOV dword ptr [EAX + 0xc],EDX
006a4d05 : MOV DL,byte ptr [EAX + 0x5]
006a4d08 : MOV BL,DL
006a4d0a : AND BL,0x1
006a4d0d : MOV dword ptr [EAX + 0x8],0x3
006a4d14 : JZ 0x006a4d1d
006a4d16 : MOV dword ptr [EAX + 0x8],0x5
006a4d1d : TEST DL,0x2
006a4d20 : JZ 0x006a4d25
006a4d22 : INC dword ptr [EAX + 0x8]
006a4d25 : MOVZX EDI,byte ptr [EAX + 0x4]
006a4d29 : MOV EBP,dword ptr [EAX + 0x8]
006a4d2c : MOV EDX,EDI
006a4d2e : IMUL EDX,EBP
006a4d31 : ADD EDX,ECX
006a4d33 : CMP EDX,dword ptr [ESP + 0x24]
006a4d37 : JBE 0x006a4d54
006a4d39 : MOV EDI,dword ptr [ESP + 0x18]
006a4d3d : PUSH EAX
006a4d3e : PUSH EDI
006a4d3f : CALL 0x00687f30
006a4d44 : ADD ESP,0x8
006a4d47 : POP EBP
006a4d48 : POP EBX
006a4d49 : POP EDI
006a4d4a : MOV EAX,0x8
006a4d4f : POP ESI
006a4d50 : ADD ESP,0xc
006a4d53 : RET
006a4d54 : MOV DL,byte ptr [EAX + 0x4]
006a4d57 : TEST DL,DL
006a4d59 : JBE 0x006a4e1d
006a4d5f : TEST BL,BL
006a4d61 : JZ 0x006a4dcd
006a4d63 : MOVZX ESI,byte ptr [ECX]
006a4d66 : MOVZX EBX,byte ptr [ECX + 0x1]
006a4d6a : LEA EDX,[ECX + 0x2]
006a4d6d : SHL SI,0x8
006a4d71 : MOVZX ESI,SI
006a4d74 : OR ESI,EBX
006a4d76 : MOVZX BX,byte ptr [EDX]
006a4d7a : ADD EDX,0x2
006a4d7d : MOVZX EDX,byte ptr [EDX + -0x1]
006a4d81 : DEC EDI
006a4d82 : SHL BX,0x8
006a4d86 : IMUL EDI,EBP
006a4d89 : SHL ESI,0x10
006a4d8c : MOVZX EBX,BX
006a4d8f : OR EBX,EDX
006a4d91 : OR EBX,ESI
006a4d93 : LEA ECX,[EDI + ECX*0x1 + 0x2]
006a4d97 : MOV dword ptr [EAX + 0x10],EBX
006a4d9a : MOVZX DX,byte ptr [ECX + -0x2]
006a4d9f : MOVZX ESI,byte ptr [ECX + -0x1]
006a4da3 : SHL DX,0x8
006a4da7 : MOVZX EDX,DX
006a4daa : OR EDX,ESI
006a4dac : MOVZX ESI,byte ptr [ECX]
006a4daf : ADD ECX,0x2
006a4db2 : MOVZX ECX,byte ptr [ECX + -0x1]
006a4db6 : SHL SI,0x8
006a4dba : MOVZX ESI,SI
006a4dbd : OR ESI,ECX
006a4dbf : SHL EDX,0x10
006a4dc2 : OR ESI,EDX
006a4dc4 : MOV dword ptr [EAX + 0x14],ESI
006a4dc7 : MOV ESI,dword ptr [ESP + 0x28]
006a4dcb : JMP 0x006a4df3
006a4dcd : MOVZX EDX,byte ptr [ECX]
006a4dd0 : MOVZX EBX,byte ptr [ECX + 0x1]
006a4dd4 : SHL EDX,0x10
006a4dd7 : OR EDX,EBX
006a4dd9 : MOV dword ptr [EAX + 0x10],EDX
006a4ddc : LEA EDX,[EDI + -0x1]
006a4ddf : IMUL EDX,EBP
006a4de2 : ADD EDX,ECX
006a4de4 : MOVZX ECX,byte ptr [EDX]
006a4de7 : MOVZX EDX,byte ptr [EDX + 0x1]
006a4deb : SHL ECX,0x10
006a4dee : OR ECX,EDX
006a4df0 : MOV dword ptr [EAX + 0x14],ECX
006a4df3 : MOV dword ptr [EAX],0x0
006a4df9 : MOV ECX,dword ptr [ESI + 0x8c]
006a4dff : MOV dword ptr [ECX],EAX
006a4e01 : MOV dword ptr [ESI + 0x8c],EAX
006a4e07 : MOVZX EDX,byte ptr [EAX + 0x4]
006a4e0b : ADD dword ptr [ESI + 0x84],EDX
006a4e11 : MOV EAX,dword ptr [ESP + 0x14]
006a4e15 : POP EBP
006a4e16 : POP EBX
006a4e17 : POP EDI
006a4e18 : POP ESI
006a4e19 : ADD ESP,0xc
006a4e1c : RET
006a4e1d : PUSH EAX
006a4e1e : MOV EAX,dword ptr [ESP + 0x1c]
006a4e22 : PUSH EAX
006a4e23 : CALL 0x00687f30
006a4e28 : MOV EAX,dword ptr [ESP + 0x1c]
006a4e2c : ADD ESP,0x8
006a4e2f : POP EBP
006a4e30 : POP EBX
006a4e31 : POP EDI
006a4e32 : POP ESI
006a4e33 : ADD ESP,0xc
006a4e36 : RET
006a4e37 : POP EDI
006a4e38 : MOV EAX,ECX
006a4e3a : POP ESI
006a4e3b : ADD ESP,0xc
006a4e3e : RET

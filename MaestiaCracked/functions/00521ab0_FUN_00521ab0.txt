PROGRAM  : Maestia.exe
FUNCTION : FUN_00521ab0
ENTRY    : 00521ab0
BODY     : [[00521ab0, 00521bbf]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00521ab0(undefined4 param_1,int *param_2)

{
  int *piVar1;
  char cVar2;
  int iVar3;
  uint uVar4;
  int in_ECX;
  
  piVar1 = param_2;
  if ((*(uint *)(*param_2 + 0xc) >> 0x1d & 1) == 0) {
    iVar3 = FUN_00524bc0();
    if ((iVar3 == 0) || (iVar3 = FUN_00524bf0(0), iVar3 != 0x5f)) goto LAB_00521b6d;
    FUN_00525d70(&param_2);
    if (((uint)param_2[3] >> 0x1c & 1) == 0) {
      param_2[2] = param_2[2] + -1;
      if (param_2[2] == 0) {
        FUN_00525340();
      }
      goto LAB_00521b6d;
    }
    param_2[2] = param_2[2] + -1;
    if (param_2[2] == 0) {
      FUN_00525340();
    }
  }
  iVar3 = FUN_00521500(piVar1);
  if (((iVar3 != -1) && (iVar3 < 0x20)) &&
     (uVar4 = (**(code **)(*(int *)(in_ECX + -0x68) + 0xf8))(),
     (1 << ((byte)iVar3 & 0x1f) & uVar4) != 0)) {
    if (iVar3 != 0x1f) {
      return 0;
    }
    *(uint *)(in_ECX + 0x24) = *(uint *)(in_ECX + 0x24) & 0xfffff9ff;
    return 1;
  }
LAB_00521b6d:
  iVar3 = (**(code **)(*(int *)(in_ECX + -0x68) + 0xe4))();
  if (iVar3 != 0) {
    *(uint *)(iVar3 + 8) = *(int *)(iVar3 + 8) + 1U & 0x8fffffff;
    cVar2 = (**(code **)(*(int *)(iVar3 + 0x10) + 0x18))(param_1,piVar1);
    if (cVar2 != '\0') {
      FUN_00503db0();
      return 1;
    }
    FUN_00503db0();
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00521ab0 : PUSH EBX
00521ab1 : MOV EBX,dword ptr [ESP + 0xc]
00521ab5 : MOV EAX,dword ptr [EBX]
00521ab7 : PUSH EBP
00521ab8 : MOV EBP,ECX
00521aba : MOV ECX,dword ptr [EAX + 0xc]
00521abd : SHR ECX,0x1d
00521ac0 : PUSH ESI
00521ac1 : PUSH EDI
00521ac2 : TEST CL,0x1
00521ac5 : JNZ 0x00521b15
00521ac7 : MOV ECX,EBX
00521ac9 : CALL 0x00524bc0
00521ace : TEST EAX,EAX
00521ad0 : JBE 0x00521b6d
00521ad6 : PUSH 0x0
00521ad8 : MOV ECX,EBX
00521ada : CALL 0x00524bf0
00521adf : CMP EAX,0x5f
00521ae2 : JNZ 0x00521b6d
00521ae8 : LEA EDX,[ESP + 0x18]
00521aec : PUSH EDX
00521aed : MOV ECX,EBX
00521aef : CALL 0x00525d70
00521af4 : MOV EAX,dword ptr [ESP + 0x18]
00521af8 : MOV ECX,dword ptr [EAX + 0xc]
00521afb : SHR ECX,0x1c
00521afe : TEST CL,0x1
00521b01 : MOV ECX,EAX
00521b03 : JZ 0x00521b5d
00521b05 : DEC dword ptr [EAX + 0x8]
00521b08 : ADD EAX,0x8
00521b0b : CMP dword ptr [EAX],0x0
00521b0e : JNZ 0x00521b15
00521b10 : CALL 0x00525340
00521b15 : LEA ESI,[EBP + -0x68]
00521b18 : PUSH EBX
00521b19 : MOV ECX,ESI
00521b1b : CALL 0x00521500
00521b20 : MOV EDI,EAX
00521b22 : CMP EDI,-0x1
00521b25 : JZ 0x00521b6d
00521b27 : CMP EDI,0x1f
00521b2a : JG 0x00521b6d
00521b2c : MOV EDX,dword ptr [ESI]
00521b2e : MOV EAX,dword ptr [EDX + 0xf8]
00521b34 : MOV ECX,ESI
00521b36 : CALL EAX
00521b38 : MOV EDX,0x1
00521b3d : MOV ECX,EDI
00521b3f : SHL EDX,CL
00521b41 : TEST EDX,EAX
00521b43 : JZ 0x00521b6d
00521b45 : CMP EDI,0x1f
00521b48 : JNZ 0x00521bb7
00521b4a : AND dword ptr [ESI + 0x8c],0xfffff9ff
00521b54 : POP EDI
00521b55 : POP ESI
00521b56 : POP EBP
00521b57 : MOV AL,0x1
00521b59 : POP EBX
00521b5a : RET 0x8
00521b5d : DEC dword ptr [EAX + 0x8]
00521b60 : ADD EAX,0x8
00521b63 : CMP dword ptr [EAX],0x0
00521b66 : JNZ 0x00521b6d
00521b68 : CALL 0x00525340
00521b6d : MOV EAX,dword ptr [EBP + -0x68]
00521b70 : MOV EDX,dword ptr [EAX + 0xe4]
00521b76 : LEA ECX,[EBP + -0x68]
00521b79 : CALL EDX
00521b7b : MOV ESI,EAX
00521b7d : TEST ESI,ESI
00521b7f : JZ 0x00521bb7
00521b81 : MOV EAX,dword ptr [ESI + 0x8]
00521b84 : INC EAX
00521b85 : AND EAX,0x8fffffff
00521b8a : MOV dword ptr [ESI + 0x8],EAX
00521b8d : MOV EDX,dword ptr [ESI + 0x10]
00521b90 : MOV EAX,dword ptr [ESP + 0x14]
00521b94 : MOV EDX,dword ptr [EDX + 0x18]
00521b97 : LEA ECX,[ESI + 0x10]
00521b9a : PUSH EBX
00521b9b : PUSH EAX
00521b9c : CALL EDX
00521b9e : MOV ECX,ESI
00521ba0 : TEST AL,AL
00521ba2 : JZ 0x00521bb2
00521ba4 : CALL 0x00503db0
00521ba9 : POP EDI
00521baa : POP ESI
00521bab : POP EBP
00521bac : MOV AL,0x1
00521bae : POP EBX
00521baf : RET 0x8
00521bb2 : CALL 0x00503db0
00521bb7 : POP EDI
00521bb8 : POP ESI
00521bb9 : POP EBP
00521bba : XOR AL,AL
00521bbc : POP EBX
00521bbd : RET 0x8

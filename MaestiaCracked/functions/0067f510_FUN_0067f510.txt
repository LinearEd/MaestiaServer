PROGRAM  : Maestia.exe
FUNCTION : FUN_0067f510
ENTRY    : 0067f510
BODY     : [[0067f510, 0067fa10]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0067f510(int param_1,int param_2,uint param_3,short *param_4)

{
  ushort uVar1;
  ushort uVar2;
  short sVar3;
  ushort *_Dst;
  undefined *puVar4;
  size_t _Size;
  int iVar5;
  uint *puVar6;
  LONG LVar7;
  ushort *puVar8;
  short *psVar9;
  short *psVar10;
  GRefCountImpl *this;
  int iVar11;
  undefined4 uVar12;
  int in_ECX;
  uint uVar13;
  uint local_34;
  uint local_30;
  uint local_2c;
  undefined4 local_28;
  undefined4 uStack_24;
  undefined4 uStack_20;
  undefined4 uStack_1c;
  undefined4 uStack_18;
  undefined4 uStack_14;
  undefined4 uStack_10;
  undefined4 uStack_c;
  undefined4 uStack_8;
  
  local_30 = 0;
  local_2c = 0;
  iVar5 = FUN_0051b1a0();
  if (iVar5 != 0) {
    puVar6 = (uint *)FUN_0051c6e0(&local_34,".RemoveInputWindow");
    FUN_00678eb0(*(undefined4 *)(in_ECX + 4),(*puVar6 & 0xfffffffc) + 8,0);
    LVar7 = InterlockedExchangeAdd((LONG *)((local_34 & 0xfffffffc) + 4),-1);
    if (LVar7 == 1) {
      FUN_00515cf0(local_34 & 0xfffffffc);
    }
  }
  uVar1 = *(ushort *)(in_ECX + 0x7c);
  if (uVar1 == 0x1b) {
    **(undefined2 **)(in_ECX + 0x20) = 0;
    if ((local_2c >> 6 & 1) == 0) {
      return;
    }
    FUN_00588b40(&local_30,local_28);
    return;
  }
  _Dst = *(ushort **)(in_ECX + 0x20);
  puVar8 = _Dst;
  do {
    uVar2 = *puVar8;
    puVar8 = puVar8 + 1;
  } while (uVar2 != 0);
  puVar4 = *(undefined **)(in_ECX + 0x5c);
  iVar5 = (int)puVar8 - (int)(_Dst + 1) >> 1;
  if ((int)puVar4 < 0x10001) {
    if (puVar4 != (undefined *)0x10000) {
      switch(puVar4) {
      case (undefined *)0x1:
      case (undefined *)0x3:
      case (undefined *)0x5:
      case (undefined *)0x7:
        psVar10 = param_4;
        do {
          sVar3 = *psVar10;
          psVar10 = psVar10 + 1;
        } while (sVar3 != 0);
        FUN_0051c980(_Dst,((int)psVar10 - (int)(param_4 + 1) >> 1) + 1,param_4);
        break;
      case (undefined *)0x2:
        if (*(int *)(in_ECX + 0x74) < 5) {
          if (param_1 != 0x3000) {
            **(undefined2 **)(in_ECX + 0x68) = 0x20;
            *(undefined2 *)(*(int *)(in_ECX + 0x68) + 2) = 0x20;
            *(undefined2 *)(*(int *)(in_ECX + 0x68) + 4) = 0x20;
            *(undefined2 *)(*(int *)(in_ECX + 0x68) + 6) = 0x20;
            *(undefined2 *)(*(int *)(in_ECX + 0x68) + 8) = 0;
            FUN_0045ac80();
            return;
          }
          *(ushort *)(*(int *)(in_ECX + 0x68) + *(int *)(in_ECX + 0x74) * 2) = uVar1;
          psVar10 = *(short **)(in_ECX + 0x68);
          psVar9 = psVar10;
          do {
            sVar3 = *psVar9;
            psVar9 = psVar9 + 1;
          } while (sVar3 != 0);
          FUN_0051c980(*(undefined4 *)(in_ECX + 0x20),((int)psVar9 - (int)(psVar10 + 1) >> 1) + 1,
                       psVar10);
          break;
        }
        goto LAB_0067f604;
      case (undefined *)0x4:
        if (param_1 != 0x3000) {
          *_Dst = 0;
          goto LAB_0067f604;
        }
        if (((uVar1 != 0xd) && (uVar1 != 0x20)) && (uVar1 != 8)) {
          puVar8 = _Dst;
          do {
            uVar2 = *puVar8;
            puVar8 = puVar8 + 1;
          } while (uVar2 != 0);
          iVar5 = (int)puVar8 - (int)(_Dst + 1) >> 1;
          if (iVar5 < 5) {
            _Dst[iVar5] = uVar1;
            *(undefined2 *)(*(int *)(in_ECX + 0x20) + 2 + iVar5 * 2) = 0;
          }
        }
        if (*(short *)(in_ECX + 0x7c) == 8) {
          psVar10 = *(short **)(in_ECX + 0x20);
          psVar9 = psVar10;
          do {
            sVar3 = *psVar9;
            psVar9 = psVar9 + 1;
          } while (sVar3 != 0);
          iVar5 = (int)psVar9 - (int)(psVar10 + 1) >> 1;
          if (0 < iVar5) {
            psVar10[iVar5 + -1] = 0;
          }
        }
      }
      goto switchD_0067f5ee_caseD_6;
    }
  }
  else if ((int)puVar4 < 0x70001) {
    if (puVar4 == (undefined *)0x70000) {
LAB_0067f78e:
      if (param_1 == 0x3000) {
        if (uVar1 == 8) {
          if (0 < iVar5) {
            _Dst[iVar5 + -1] = 0;
          }
        }
        else if ((uVar1 != 0xd) && (uVar1 != 0x20)) {
          iVar11 = 0;
          if (0 < param_2) {
            do {
              if (*(char *)(iVar11 + param_3) == '\x01') break;
              iVar11 = iVar11 + 1;
            } while (iVar11 < param_2);
          }
          if (iVar11 == param_2) {
LAB_0067f604:
            FUN_0045ac80();
            return;
          }
          if (*(int *)(in_ECX + 0x550) == iVar11) {
            _Dst[iVar5] = uVar1;
            *(undefined2 *)(*(int *)(in_ECX + 0x20) + 2 + iVar5 * 2) = 0;
          }
          else {
            *(int *)(in_ECX + 0x550) = iVar11;
            *_Dst = uVar1;
            *(undefined2 *)(*(int *)(in_ECX + 0x20) + 2) = 0;
          }
        }
      }
      else {
        *_Dst = 0;
      }
      goto switchD_0067f5ee_caseD_6;
    }
    if ((int)puVar4 < 0x40001) {
      if (puVar4 == (undefined *)0x40000) goto LAB_0067f78e;
      if ((puVar4 != (undefined *)0x20000) && (puVar4 != (undefined *)0x30000))
      goto switchD_0067f5ee_caseD_6;
    }
    else {
      if (puVar4 == (undefined *)0x50000) goto LAB_0067f78e;
      if (puVar4 != (undefined *)0x60000) goto switchD_0067f5ee_caseD_6;
    }
  }
  else if ((int)puVar4 < 0xb10001) {
    if (puVar4 != &DAT_00b10000) {
      if (puVar4 == (undefined *)0x110000) {
        if (uVar1 == 8) {
          if (0 < iVar5) {
            _Dst[iVar5 + -1] = 0;
          }
        }
        else if ((0x60 < uVar1) && (uVar1 < 0x7b)) {
          _Dst[iVar5] = uVar1;
          *(undefined2 *)(*(int *)(in_ECX + 0x20) + 2 + iVar5 * 2) = 0;
        }
        goto switchD_0067f5ee_caseD_6;
      }
      if (puVar4 != (undefined *)0xa10000) goto switchD_0067f5ee_caseD_6;
    }
  }
  else if ((undefined *)0x1 < puVar4 + -0xd00001) goto switchD_0067f5ee_caseD_6;
  psVar10 = param_4;
  do {
    sVar3 = *psVar10;
    psVar10 = psVar10 + 1;
  } while (sVar3 != 0);
  _Size = ((int)psVar10 - (int)(param_4 + 1) >> 1) * 2;
  _memcpy(_Dst,param_4,_Size);
  *(undefined2 *)(_Size + *(int *)(in_ECX + 0x20)) = 0;
switchD_0067f5ee_caseD_6:
  iVar5 = FUN_0051aeb0(*(undefined4 *)(in_ECX + 0x20),0xffffffff);
  if (iVar5 == 0) {
    if ((local_2c >> 6 & 1) != 0) {
      FUN_00588b40(&local_30,local_28);
      return;
    }
  }
  else {
    iVar5 = FUN_00515840(iVar5 + 1,0);
    FUN_0051af70(iVar5,*(undefined4 *)(in_ECX + 0x20),0xffffffff);
    this = (GRefCountImpl *)(**(code **)(*(int *)(*(int *)(in_ECX + 4) + 8) + 0xc))(0x1b);
    uStack_14 = 0;
    uStack_10 = 0;
    uStack_c = 0;
    uStack_8 = 0;
    uStack_24 = 0;
    uStack_20 = 0;
    uStack_1c = 0;
    uStack_18 = 0;
    FUN_00597610(&uStack_14,&uStack_24,-*(int *)(in_ECX + 0x34));
    iVar11 = FUN_0051b1a0();
    if (iVar11 != 0) {
      puVar6 = (uint *)FUN_0051c6e0(&param_3,".DisplayInputWindow");
      uVar12 = FUN_0063b380();
      uVar12 = FUN_0063b380(uVar12);
      uVar12 = FUN_0063b380(uVar12);
      FUN_00678eb0(*(undefined4 *)(in_ECX + 4),(*puVar6 & 0xfffffffc) + 8,"%s %d %d %d",iVar5,uVar12
                  );
      uVar13 = param_3 & 0xfffffffc;
      LVar7 = InterlockedExchangeAdd((LONG *)(uVar13 + 4),-1);
      if (LVar7 == 1) {
        FUN_00515cf0(uVar13);
      }
    }
    if (iVar5 != 0) {
      FUN_00515cf0(iVar5);
    }
    if (this != (GRefCountImpl *)0x0) {
      GRefCountImpl::Release(this);
    }
    if ((local_30 >> 6 & 1) != 0) {
      FUN_00588b40(&local_34,local_2c);
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
0067f510 : SUB ESP,0x34
0067f513 : PUSH EBX
0067f514 : PUSH EBP
0067f515 : PUSH ESI
0067f516 : MOV ESI,ECX
0067f518 : PUSH EDI
0067f519 : XOR EBX,EBX
0067f51b : LEA EDI,[ESI + 0x8]
0067f51e : MOV ECX,EDI
0067f520 : MOV dword ptr [ESP + 0x14],EBX
0067f524 : MOV dword ptr [ESP + 0x18],EBX
0067f528 : CALL 0x0051b1a0
0067f52d : TEST EAX,EAX
0067f52f : JZ 0x0067f576
0067f531 : PUSH 0xbd7f88
0067f536 : LEA EAX,[ESP + 0x14]
0067f53a : PUSH EAX
0067f53b : MOV ECX,EDI
0067f53d : CALL 0x0051c6e0
0067f542 : MOV ECX,dword ptr [EAX]
0067f544 : MOV EDX,dword ptr [ESI + 0x4]
0067f547 : AND ECX,0xfffffffc
0067f54a : PUSH EBX
0067f54b : ADD ECX,0x8
0067f54e : PUSH ECX
0067f54f : PUSH EDX
0067f550 : CALL 0x00678eb0
0067f555 : MOV EDI,dword ptr [ESP + 0x1c]
0067f559 : ADD ESP,0xc
0067f55c : AND EDI,0xfffffffc
0067f55f : PUSH -0x1
0067f561 : LEA EAX,[EDI + 0x4]
0067f564 : PUSH EAX
0067f565 : CALL dword ptr [0x00b851cc]
0067f56b : SUB EAX,0x1
0067f56e : JNZ 0x0067f576
0067f570 : PUSH EDI
0067f571 : CALL 0x00515cf0
0067f576 : MOVZX EBP,word ptr [ESI + 0x7c]
0067f57a : CMP BP,0x1b
0067f57e : JNZ 0x0067f5b4
0067f580 : MOV ECX,dword ptr [ESI + 0x20]
0067f583 : XOR EDX,EDX
0067f585 : MOV word ptr [ECX],DX
0067f588 : MOV EAX,dword ptr [ESP + 0x18]
0067f58c : SHR EAX,0x6
0067f58f : TEST AL,0x1
0067f591 : JZ 0x0067fa07
0067f597 : MOV ECX,dword ptr [ESP + 0x1c]
0067f59b : PUSH ECX
0067f59c : MOV ECX,dword ptr [ESP + 0x18]
0067f5a0 : LEA EDX,[ESP + 0x18]
0067f5a4 : PUSH EDX
0067f5a5 : CALL 0x00588b40
0067f5aa : POP EDI
0067f5ab : POP ESI
0067f5ac : POP EBP
0067f5ad : POP EBX
0067f5ae : ADD ESP,0x34
0067f5b1 : RET 0x10
0067f5b4 : MOV EBX,dword ptr [ESI + 0x20]
0067f5b7 : MOV EAX,EBX
0067f5b9 : LEA EDX,[EAX + 0x2]
0067f5bc : LEA ESP,[ESP]
0067f5c0 : MOV CX,word ptr [EAX]
0067f5c3 : ADD EAX,0x2
0067f5c6 : TEST CX,CX
0067f5c9 : JNZ 0x0067f5c0
0067f5cb : MOV ECX,dword ptr [ESI + 0x5c]
0067f5ce : SUB EAX,EDX
0067f5d0 : SAR EAX,0x1
0067f5d2 : CMP ECX,0x10000
0067f5d8 : JG 0x0067f740
0067f5de : JZ 0x0067f87d
0067f5e4 : DEC ECX
0067f5e5 : CMP ECX,0x6
0067f5e8 : JA 0x0067f8ac
0067f5ee : JMP dword ptr [ECX*0x4 + 0x67fa14]
0067f5f5 : CMP dword ptr [ESP + 0x48],0x3000
0067f5fd : JZ 0x0067f617
0067f5ff : XOR EAX,EAX
0067f601 : MOV word ptr [EBX],AX
0067f604 : LEA ECX,[ESP + 0x14]
0067f608 : CALL 0x0045ac80
0067f60d : POP EDI
0067f60e : POP ESI
0067f60f : POP EBP
0067f610 : POP EBX
0067f611 : ADD ESP,0x34
0067f614 : RET 0x10
0067f617 : CMP BP,0xd
0067f61b : JZ 0x0067f652
0067f61d : CMP BP,0x20
0067f621 : JZ 0x0067f652
0067f623 : CMP BP,0x8
0067f627 : JZ 0x0067f652
0067f629 : MOV EAX,EBX
0067f62b : LEA EDX,[EAX + 0x2]
0067f62e : MOV EDI,EDI
0067f630 : MOV CX,word ptr [EAX]
0067f633 : ADD EAX,0x2
0067f636 : TEST CX,CX
0067f639 : JNZ 0x0067f630
0067f63b : SUB EAX,EDX
0067f63d : SAR EAX,0x1
0067f63f : CMP EAX,0x4
0067f642 : JG 0x0067f652
0067f644 : MOV word ptr [EBX + EAX*0x2],BP
0067f648 : MOV ECX,dword ptr [ESI + 0x20]
0067f64b : XOR EDX,EDX
0067f64d : MOV word ptr [ECX + EAX*0x2 + 0x2],DX
0067f652 : CMP word ptr [ESI + 0x7c],0x8
0067f657 : JNZ 0x0067f8ac
0067f65d : MOV EDX,dword ptr [ESI + 0x20]
0067f660 : MOV EAX,EDX
0067f662 : LEA EDI,[EAX + 0x2]
0067f665 : MOV CX,word ptr [EAX]
0067f668 : ADD EAX,0x2
0067f66b : TEST CX,CX
0067f66e : JNZ 0x0067f665
0067f670 : SUB EAX,EDI
0067f672 : SAR EAX,0x1
0067f674 : TEST EAX,EAX
0067f676 : JLE 0x0067f8ac
0067f67c : XOR ECX,ECX
0067f67e : MOV word ptr [EDX + EAX*0x2 + -0x2],CX
0067f683 : JMP 0x0067f8ac
0067f688 : MOV EAX,dword ptr [ESI + 0x74]
0067f68b : CMP EAX,0x4
0067f68e : JG 0x0067f604
0067f694 : CMP dword ptr [ESP + 0x48],0x3000
0067f69c : JNZ 0x0067f6d3
0067f69e : MOV EDX,dword ptr [ESI + 0x68]
0067f6a1 : MOV word ptr [EDX + EAX*0x2],BP
0067f6a5 : MOV EDX,dword ptr [ESI + 0x68]
0067f6a8 : MOV EAX,EDX
0067f6aa : LEA EDI,[EAX + 0x2]
0067f6ad : LEA ECX,[ECX]
0067f6b0 : MOV CX,word ptr [EAX]
0067f6b3 : ADD EAX,0x2
0067f6b6 : TEST CX,CX
0067f6b9 : JNZ 0x0067f6b0
0067f6bb : SUB EAX,EDI
0067f6bd : SAR EAX,0x1
0067f6bf : PUSH EDX
0067f6c0 : INC EAX
0067f6c1 : PUSH EAX
0067f6c2 : MOV EAX,dword ptr [ESI + 0x20]
0067f6c5 : PUSH EAX
0067f6c6 : CALL 0x0051c980
0067f6cb : ADD ESP,0xc
0067f6ce : JMP 0x0067f8ac
0067f6d3 : MOV ECX,dword ptr [ESI + 0x68]
0067f6d6 : MOV EDX,0x20
0067f6db : MOV word ptr [ECX],DX
0067f6de : MOV EAX,dword ptr [ESI + 0x68]
0067f6e1 : MOV ECX,EDX
0067f6e3 : MOV word ptr [EAX + 0x2],CX
0067f6e7 : MOV EDX,dword ptr [ESI + 0x68]
0067f6ea : MOV EAX,ECX
0067f6ec : MOV word ptr [EDX + 0x4],AX
0067f6f0 : MOV ECX,dword ptr [ESI + 0x68]
0067f6f3 : MOV EDX,EAX
0067f6f5 : MOV word ptr [ECX + 0x6],DX
0067f6f9 : MOV EAX,dword ptr [ESI + 0x68]
0067f6fc : XOR ECX,ECX
0067f6fe : MOV word ptr [EAX + 0x8],CX
0067f702 : LEA ECX,[ESP + 0x14]
0067f706 : CALL 0x0045ac80
0067f70b : POP EDI
0067f70c : POP ESI
0067f70d : POP EBP
0067f70e : POP EBX
0067f70f : ADD ESP,0x34
0067f712 : RET 0x10
0067f715 : MOV EDX,dword ptr [ESP + 0x54]
0067f719 : MOV EAX,EDX
0067f71b : LEA EDI,[EAX + 0x2]
0067f71e : MOV EDI,EDI
0067f720 : MOV CX,word ptr [EAX]
0067f723 : ADD EAX,0x2
0067f726 : TEST CX,CX
0067f729 : JNZ 0x0067f720
0067f72b : SUB EAX,EDI
0067f72d : SAR EAX,0x1
0067f72f : PUSH EDX
0067f730 : INC EAX
0067f731 : PUSH EAX
0067f732 : PUSH EBX
0067f733 : CALL 0x0051c980
0067f738 : ADD ESP,0xc
0067f73b : JMP 0x0067f8ac
0067f740 : CMP ECX,0x70000
0067f746 : JG 0x0067f827
0067f74c : JZ 0x0067f78e
0067f74e : CMP ECX,0x40000
0067f754 : JG 0x0067f775
0067f756 : JZ 0x0067f78e
0067f758 : CMP ECX,0x20000
0067f75e : JZ 0x0067f87d
0067f764 : CMP ECX,0x30000
0067f76a : JZ 0x0067f87d
0067f770 : JMP 0x0067f8ac
0067f775 : CMP ECX,0x50000
0067f77b : JZ 0x0067f78e
0067f77d : CMP ECX,0x60000
0067f783 : JZ 0x0067f87d
0067f789 : JMP 0x0067f8ac
0067f78e : CMP dword ptr [ESP + 0x48],0x3000
0067f796 : JNZ 0x0067f81d
0067f79c : CMP BP,0x8
0067f7a0 : JNZ 0x0067f7b6
0067f7a2 : TEST EAX,EAX
0067f7a4 : JLE 0x0067f8ac
0067f7aa : XOR EDX,EDX
0067f7ac : MOV word ptr [EBX + EAX*0x2 + -0x2],DX
0067f7b1 : JMP 0x0067f8ac
0067f7b6 : CMP BP,0xd
0067f7ba : JZ 0x0067f8ac
0067f7c0 : CMP BP,0x20
0067f7c4 : JZ 0x0067f8ac
0067f7ca : MOV EDX,dword ptr [ESP + 0x4c]
0067f7ce : XOR ECX,ECX
0067f7d0 : TEST EDX,EDX
0067f7d2 : JLE 0x0067f7e3
0067f7d4 : MOV EDI,dword ptr [ESP + 0x50]
0067f7d8 : CMP byte ptr [ECX + EDI*0x1],0x1
0067f7dc : JZ 0x0067f7e3
0067f7de : INC ECX
0067f7df : CMP ECX,EDX
0067f7e1 : JL 0x0067f7d8
0067f7e3 : CMP ECX,EDX
0067f7e5 : JZ 0x0067f604
0067f7eb : CMP dword ptr [ESI + 0x550],ECX
0067f7f1 : JNZ 0x0067f806
0067f7f3 : MOV word ptr [EBX + EAX*0x2],BP
0067f7f7 : MOV ECX,dword ptr [ESI + 0x20]
0067f7fa : XOR EDX,EDX
0067f7fc : MOV word ptr [ECX + EAX*0x2 + 0x2],DX
0067f801 : JMP 0x0067f8ac
0067f806 : MOV dword ptr [ESI + 0x550],ECX
0067f80c : MOV word ptr [EBX],BP
0067f80f : MOV EAX,dword ptr [ESI + 0x20]
0067f812 : XOR ECX,ECX
0067f814 : MOV word ptr [EAX + 0x2],CX
0067f818 : JMP 0x0067f8ac
0067f81d : XOR EDX,EDX
0067f81f : MOV word ptr [EBX],DX
0067f822 : JMP 0x0067f8ac
0067f827 : CMP ECX,0xb10000
0067f82d : JG 0x0067f872
0067f82f : JZ 0x0067f87d
0067f831 : CMP ECX,0x110000
0067f837 : JZ 0x0067f843
0067f839 : CMP ECX,0xa10000
0067f83f : JZ 0x0067f87d
0067f841 : JMP 0x0067f8ac
0067f843 : CMP BP,0x8
0067f847 : JNZ 0x0067f856
0067f849 : TEST EAX,EAX
0067f84b : JLE 0x0067f8ac
0067f84d : XOR ECX,ECX
0067f84f : MOV word ptr [EBX + EAX*0x2 + -0x2],CX
0067f854 : JMP 0x0067f8ac
0067f856 : CMP BP,0x61
0067f85a : JC 0x0067f8ac
0067f85c : CMP BP,0x7a
0067f860 : JA 0x0067f8ac
0067f862 : MOV word ptr [EBX + EAX*0x2],BP
0067f866 : MOV EDX,dword ptr [ESI + 0x20]
0067f869 : XOR ECX,ECX
0067f86b : MOV word ptr [EDX + EAX*0x2 + 0x2],CX
0067f870 : JMP 0x0067f8ac
0067f872 : ADD ECX,0xff2fffff
0067f878 : CMP ECX,0x1
0067f87b : JA 0x0067f8ac
0067f87d : MOV EDX,dword ptr [ESP + 0x54]
0067f881 : MOV EAX,EDX
0067f883 : LEA EDI,[EAX + 0x2]
0067f886 : MOV CX,word ptr [EAX]
0067f889 : ADD EAX,0x2
0067f88c : TEST CX,CX
0067f88f : JNZ 0x0067f886
0067f891 : SUB EAX,EDI
0067f893 : SAR EAX,0x1
0067f895 : LEA EDI,[EAX + EAX*0x1]
0067f898 : PUSH EDI
0067f899 : PUSH EDX
0067f89a : PUSH EBX
0067f89b : CALL 0x0063ae40
0067f8a0 : MOV EDX,dword ptr [ESI + 0x20]
0067f8a3 : ADD ESP,0xc
0067f8a6 : XOR EAX,EAX
0067f8a8 : MOV word ptr [EDI + EDX*0x1],AX
0067f8ac : MOV EAX,dword ptr [ESI + 0x20]
0067f8af : PUSH -0x1
0067f8b1 : PUSH EAX
0067f8b2 : CALL 0x0051aeb0
0067f8b7 : TEST EAX,EAX
0067f8b9 : JNZ 0x0067f8e8
0067f8bb : MOV ECX,dword ptr [ESP + 0x18]
0067f8bf : SHR ECX,0x6
0067f8c2 : TEST CL,0x1
0067f8c5 : JZ 0x0067fa07
0067f8cb : MOV EDX,dword ptr [ESP + 0x1c]
0067f8cf : MOV ECX,dword ptr [ESP + 0x14]
0067f8d3 : PUSH EDX
0067f8d4 : LEA EAX,[ESP + 0x18]
0067f8d8 : PUSH EAX
0067f8d9 : CALL 0x00588b40
0067f8de : POP EDI
0067f8df : POP ESI
0067f8e0 : POP EBP
0067f8e1 : POP EBX
0067f8e2 : ADD ESP,0x34
0067f8e5 : RET 0x10
0067f8e8 : MOV ECX,dword ptr [0x00d73250]
0067f8ee : PUSH 0x0
0067f8f0 : INC EAX
0067f8f1 : PUSH EAX
0067f8f2 : CALL 0x00515840
0067f8f7 : MOV ECX,dword ptr [ESI + 0x20]
0067f8fa : PUSH -0x1
0067f8fc : MOV EDI,EAX
0067f8fe : PUSH ECX
0067f8ff : PUSH EDI
0067f900 : CALL 0x0051af70
0067f905 : MOV ECX,dword ptr [ESI + 0x4]
0067f908 : MOV EDX,dword ptr [ECX + 0x8]
0067f90b : MOV EAX,dword ptr [EDX + 0xc]
0067f90e : ADD ECX,0x8
0067f911 : PUSH 0x1b
0067f913 : CALL EAX
0067f915 : FLDZ
0067f917 : MOV ECX,dword ptr [ESI + 0x34]
0067f91a : FST float ptr [ESP + 0x34]
0067f91e : NEG ECX
0067f920 : FST float ptr [ESP + 0x38]
0067f924 : PUSH ECX
0067f925 : FST float ptr [ESP + 0x40]
0067f929 : FST float ptr [ESP + 0x44]
0067f92d : MOV EBP,EAX
0067f92f : LEA EDX,[ESP + 0x28]
0067f933 : FST float ptr [ESP + 0x28]
0067f937 : FST float ptr [ESP + 0x2c]
0067f93b : PUSH EDX
0067f93c : LEA EAX,[ESP + 0x3c]
0067f940 : FST float ptr [ESP + 0x34]
0067f944 : PUSH EAX
0067f945 : FSTP float ptr [ESP + 0x3c]
0067f949 : MOV ECX,EBP
0067f94b : CALL 0x00597610
0067f950 : LEA ECX,[ESI + 0x8]
0067f953 : CALL 0x0051b1a0
0067f958 : TEST EAX,EAX
0067f95a : JBE 0x0067f9d3
0067f95c : FLD float ptr [ESP + 0x30]
0067f960 : PUSH 0xbd7fb8
0067f965 : FSUB float ptr [ESP + 0x2c]
0067f969 : LEA ECX,[ESP + 0x58]
0067f96d : PUSH ECX
0067f96e : LEA ECX,[ESI + 0x8]
0067f971 : FSTP float ptr [ESP + 0x50]
0067f975 : CALL 0x0051c6e0
0067f97a : FLD float ptr [ESP + 0x48]
0067f97e : MOV EBX,EAX
0067f980 : CALL 0x0063b380
0067f985 : FLD float ptr [ESP + 0x30]
0067f989 : PUSH EAX
0067f98a : CALL 0x0063b380
0067f98f : FLD float ptr [ESP + 0x28]
0067f993 : PUSH EAX
0067f994 : CALL 0x0063b380
0067f999 : MOV EDX,dword ptr [EBX]
0067f99b : PUSH EAX
0067f99c : MOV EAX,dword ptr [ESI + 0x4]
0067f99f : PUSH EDI
0067f9a0 : AND EDX,0xfffffffc
0067f9a3 : PUSH 0xbd7fac
0067f9a8 : ADD EDX,0x8
0067f9ab : PUSH EDX
0067f9ac : PUSH EAX
0067f9ad : CALL 0x00678eb0
0067f9b2 : MOV ESI,dword ptr [ESP + 0x70]
0067f9b6 : ADD ESP,0x1c
0067f9b9 : AND ESI,0xfffffffc
0067f9bc : PUSH -0x1
0067f9be : LEA ECX,[ESI + 0x4]
0067f9c1 : PUSH ECX
0067f9c2 : CALL dword ptr [0x00b851cc]
0067f9c8 : SUB EAX,0x1
0067f9cb : JNZ 0x0067f9d3
0067f9cd : PUSH ESI
0067f9ce : CALL 0x00515cf0
0067f9d3 : TEST EDI,EDI
0067f9d5 : JZ 0x0067f9dd
0067f9d7 : PUSH EDI
0067f9d8 : CALL 0x00515cf0
0067f9dd : TEST EBP,EBP
0067f9df : JZ 0x0067f9e8
0067f9e1 : MOV ECX,EBP
0067f9e3 : CALL 0x004ff7e0
0067f9e8 : MOV EDX,dword ptr [ESP + 0x18]
0067f9ec : SHR EDX,0x6
0067f9ef : TEST DL,0x1
0067f9f2 : JZ 0x0067fa07
0067f9f4 : MOV EAX,dword ptr [ESP + 0x1c]
0067f9f8 : PUSH EAX
0067f9f9 : LEA ECX,[ESP + 0x18]
0067f9fd : PUSH ECX
0067f9fe : MOV ECX,dword ptr [ESP + 0x1c]
0067fa02 : CALL 0x00588b40
0067fa07 : POP EDI
0067fa08 : POP ESI
0067fa09 : POP EBP
0067fa0a : POP EBX
0067fa0b : ADD ESP,0x34
0067fa0e : RET 0x10

PROGRAM  : Maestia.exe
FUNCTION : FUN_00531320
ENTRY    : 00531320
BODY     : [[00531320, 0053147d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00531320(undefined4 param_1,undefined4 *param_2,uint param_3)

{
  uint *puVar1;
  uint *puVar2;
  uint *puVar3;
  int *piVar4;
  int *in_ECX;
  uint uVar5;
  uint uVar6;
  uint *puVar7;
  int iVar8;
  
  piVar4 = (int *)*in_ECX;
  if (piVar4 == (int *)0x0) {
    iVar8 = 8;
  }
  else {
    if ((uint)(*piVar4 * 5) <= piVar4[1] * 4 + 4U) goto LAB_0053135b;
    iVar8 = piVar4[1] * 2 + 2;
  }
  FUN_00531130(param_1,iVar8);
LAB_0053135b:
  piVar4 = (int *)*in_ECX;
  param_3 = param_3 & piVar4[1];
  *piVar4 = *piVar4 + 1;
  iVar8 = *in_ECX;
  puVar1 = (uint *)(iVar8 + 8 + param_3 * 0x14);
  if (*puVar1 == 0xfffffffe) {
    *puVar1 = 0xffffffff;
    FUN_0052ebc0(param_2);
    return;
  }
  uVar6 = param_3;
  do {
    uVar6 = uVar6 + 1 & *(uint *)(iVar8 + 4);
  } while (*(int *)(iVar8 + 8 + uVar6 * 0x14) != -2);
  puVar2 = (uint *)(iVar8 + 8 + uVar6 * 0x14);
  puVar7 = puVar1 + 1;
  uVar5 = *(uint *)(puVar1[1] + 0xc) & *(uint *)(iVar8 + 4);
  if (uVar5 == param_3) {
    if (puVar2 != (uint *)0x0) {
      *puVar2 = *puVar1;
      FUN_0052e9a0(puVar7);
    }
    uVar5 = *(uint *)*param_2;
    piVar4 = (int *)(uVar5 + 8);
    *piVar4 = *piVar4 + 1;
    piVar4 = (int *)(*puVar7 + 8);
    *piVar4 = *piVar4 + -1;
    if (*piVar4 == 0) {
      FUN_00525340();
    }
    *puVar7 = uVar5;
    FUN_00568a50(param_2[1]);
    *puVar1 = uVar6;
    return;
  }
  puVar3 = (uint *)(iVar8 + 8 + uVar5 * 0x14);
  for (uVar5 = *(uint *)(iVar8 + 8 + uVar5 * 0x14); uVar5 != param_3;
      uVar5 = *(uint *)(iVar8 + 8 + uVar5 * 0x14)) {
    uVar5 = *puVar3;
    puVar3 = (uint *)(iVar8 + 8 + uVar5 * 0x14);
  }
  if (puVar2 != (uint *)0x0) {
    *puVar2 = *puVar1;
    FUN_0052e9a0(puVar7);
  }
  *puVar3 = uVar6;
  uVar6 = *(uint *)*param_2;
  piVar4 = (int *)(uVar6 + 8);
  *piVar4 = *piVar4 + 1;
  piVar4 = (int *)(*puVar7 + 8);
  *piVar4 = *piVar4 + -1;
  if (*piVar4 == 0) {
    FUN_00525340();
  }
  *puVar7 = uVar6;
  FUN_00568a50(param_2[1]);
  *puVar1 = 0xffffffff;
  return;
}



============================================================
DISASSEMBLY
============================================================
00531320 : PUSH EBP
00531321 : PUSH ESI
00531322 : MOV ESI,ECX
00531324 : MOV EAX,dword ptr [ESI]
00531326 : PUSH EDI
00531327 : TEST EAX,EAX
00531329 : JNZ 0x00531334
0053132b : MOV EAX,dword ptr [ESP + 0x10]
0053132f : PUSH 0x8
00531331 : PUSH EAX
00531332 : JMP 0x00531356
00531334 : MOV ECX,dword ptr [EAX + 0x4]
00531337 : LEA EDX,[ECX*0x4 + 0x4]
0053133e : MOV ECX,dword ptr [EAX]
00531340 : LEA ECX,[ECX + ECX*0x4]
00531343 : CMP ECX,EDX
00531345 : JBE 0x0053135b
00531347 : MOV EDX,dword ptr [EAX + 0x4]
0053134a : MOV ECX,dword ptr [ESP + 0x10]
0053134e : LEA EAX,[EDX + EDX*0x1 + 0x2]
00531352 : PUSH EAX
00531353 : PUSH ECX
00531354 : MOV ECX,ESI
00531356 : CALL 0x00531130
0053135b : MOV ECX,dword ptr [ESI]
0053135d : MOV EAX,dword ptr [ESP + 0x18]
00531361 : AND EAX,dword ptr [ECX + 0x4]
00531364 : INC dword ptr [ECX]
00531366 : MOV ECX,dword ptr [ESI]
00531368 : LEA EDX,[EAX + EAX*0x4]
0053136b : LEA EDI,[ECX + EDX*0x4 + 0x8]
0053136f : MOV EDX,dword ptr [EDI]
00531371 : MOV EBP,0xfffffffe
00531376 : MOV dword ptr [ESP + 0x10],EDI
0053137a : CMP EDX,EBP
0053137c : JNZ 0x00531397
0053137e : MOV EAX,dword ptr [ESP + 0x14]
00531382 : PUSH EAX
00531383 : LEA ECX,[EDI + 0x4]
00531386 : MOV dword ptr [EDI],0xffffffff
0053138c : CALL 0x0052ebc0
00531391 : POP EDI
00531392 : POP ESI
00531393 : POP EBP
00531394 : RET 0xc
00531397 : PUSH EBX
00531398 : MOV EBX,dword ptr [ECX + 0x4]
0053139b : MOV ESI,EAX
0053139d : LEA ECX,[ECX]
005313a0 : INC ESI
005313a1 : AND ESI,EBX
005313a3 : LEA EDX,[ESI + ESI*0x4]
005313a6 : CMP dword ptr [ECX + EDX*0x4 + 0x8],EBP
005313aa : JNZ 0x005313a0
005313ac : LEA EDX,[ESI + ESI*0x4]
005313af : LEA EBP,[ECX + EDX*0x4 + 0x8]
005313b3 : MOV EDX,dword ptr [EDI + 0x4]
005313b6 : MOV EDX,dword ptr [EDX + 0xc]
005313b9 : ADD EDI,0x4
005313bc : AND EDX,EBX
005313be : CMP EDX,EAX
005313c0 : JNZ 0x0053140c
005313c2 : TEST EBP,EBP
005313c4 : JZ 0x005313d8
005313c6 : MOV EAX,dword ptr [ESP + 0x14]
005313ca : MOV EAX,dword ptr [EAX]
005313cc : PUSH EDI
005313cd : LEA ECX,[EBP + 0x4]
005313d0 : MOV dword ptr [EBP],EAX
005313d3 : CALL 0x0052e9a0
005313d8 : MOV EBP,dword ptr [ESP + 0x18]
005313dc : MOV ECX,dword ptr [EBP]
005313df : MOV EBX,dword ptr [ECX]
005313e1 : INC dword ptr [EBX + 0x8]
005313e4 : MOV ECX,dword ptr [EDI]
005313e6 : ADD dword ptr [ECX + 0x8],-0x1
005313ea : JNZ 0x005313f1
005313ec : CALL 0x00525340
005313f1 : MOV dword ptr [EDI],EBX
005313f3 : MOV EDX,dword ptr [EBP + 0x4]
005313f6 : PUSH EDX
005313f7 : LEA ECX,[EDI + 0x4]
005313fa : CALL 0x00568a50
005313ff : MOV EAX,dword ptr [ESP + 0x14]
00531403 : POP EBX
00531404 : POP EDI
00531405 : MOV dword ptr [EAX],ESI
00531407 : POP ESI
00531408 : POP EBP
00531409 : RET 0xc
0053140c : LEA EDX,[EDX + EDX*0x4]
0053140f : CMP dword ptr [ECX + EDX*0x4 + 0x8],EAX
00531413 : LEA EBX,[ECX + EDX*0x4 + 0x8]
00531417 : JZ 0x0053142f
00531419 : LEA ESP,[ESP]
00531420 : MOV EBX,dword ptr [EBX]
00531422 : LEA EDX,[EBX + EBX*0x4]
00531425 : CMP dword ptr [ECX + EDX*0x4 + 0x8],EAX
00531429 : LEA EBX,[ECX + EDX*0x4 + 0x8]
0053142d : JNZ 0x00531420
0053142f : TEST EBP,EBP
00531431 : JZ 0x00531445
00531433 : MOV EAX,dword ptr [ESP + 0x14]
00531437 : MOV EAX,dword ptr [EAX]
00531439 : PUSH EDI
0053143a : LEA ECX,[EBP + 0x4]
0053143d : MOV dword ptr [EBP],EAX
00531440 : CALL 0x0052e9a0
00531445 : MOV dword ptr [EBX],ESI
00531447 : MOV EBX,dword ptr [ESP + 0x18]
0053144b : MOV ECX,dword ptr [EBX]
0053144d : MOV ESI,dword ptr [ECX]
0053144f : INC dword ptr [ESI + 0x8]
00531452 : MOV ECX,dword ptr [EDI]
00531454 : ADD dword ptr [ECX + 0x8],-0x1
00531458 : JNZ 0x0053145f
0053145a : CALL 0x00525340
0053145f : MOV dword ptr [EDI],ESI
00531461 : MOV EDX,dword ptr [EBX + 0x4]
00531464 : PUSH EDX
00531465 : LEA ECX,[EDI + 0x4]
00531468 : CALL 0x00568a50
0053146d : MOV EAX,dword ptr [ESP + 0x14]
00531471 : POP EBX
00531472 : POP EDI
00531473 : POP ESI
00531474 : MOV dword ptr [EAX],0xffffffff
0053147a : POP EBP
0053147b : RET 0xc

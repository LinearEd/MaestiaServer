PROGRAM  : Maestia.exe
FUNCTION : FUN_005e47d0
ENTRY    : 005e47d0
BODY     : [[005e47d0, 005e4971]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005e47d0(GThread *param_1,int param_2)

{
  byte bVar1;
  int iVar2;
  char cVar3;
  undefined4 uVar4;
  int iVar5;
  int in_ECX;
  GThread *this;
  GThread *this_00;
  
  iVar2 = (int)param_1;
  if (*(int *)(in_ECX + 0x18) != 0) {
    FUN_00515cf0(*(int *)(in_ECX + 0x18));
    *(undefined4 *)(in_ECX + 0x18) = 0;
  }
  uVar4 = FUN_0053aa80(*(undefined4 *)((int)param_1 + 0x1c));
  *(undefined4 *)(in_ECX + 0x18) = uVar4;
  *(undefined1 *)((int)param_1 + 0x15) = 0;
  if (*(int *)((int)param_1 + 0x30) - *(int *)((int)param_1 + 0x2c) < 1) {
    FUN_0053a0a0();
  }
  bVar1 = *(byte *)(*(int *)((int)param_1 + 0x2c) + *(int *)((int)param_1 + 0x3c));
  iVar5 = *(int *)((int)param_1 + 0x2c) + 1;
  *(int *)((int)param_1 + 0x2c) = iVar5;
  param_1 = (GThread *)0x0;
  if (param_2 == 0x3e) {
    *(undefined1 *)(iVar2 + 0x15) = 0;
    if (*(int *)(iVar2 + 0x30) - iVar5 < 1) {
      FUN_0053a0a0();
    }
    param_1 = (GThread *)(uint)*(byte *)(*(int *)(iVar2 + 0x2c) + *(int *)(iVar2 + 0x3c));
    *(int *)(iVar2 + 0x2c) = *(int *)(iVar2 + 0x2c) + 1;
  }
  if ((bVar1 & 0x10) == 0) {
    if ((bVar1 & 8) == 0) {
      *(uint *)(in_ECX + 0x14) = *(uint *)(in_ECX + 0x14) & 0xfffffcff;
    }
    else {
      *(uint *)(in_ECX + 0x14) = *(uint *)(in_ECX + 0x14) & 0xfffffdff | 0x100;
    }
  }
  else {
    *(uint *)(in_ECX + 0x14) = *(uint *)(in_ECX + 0x14) & 0xfffffeff | 0x200;
  }
  if ((bVar1 & 4) == 0) {
    *(uint *)(in_ECX + 0x14) = *(uint *)(in_ECX + 0x14) & 0xfffffffe;
  }
  else {
    *(uint *)(in_ECX + 0x14) = *(uint *)(in_ECX + 0x14) | 1;
  }
  if ((bVar1 & 2) == 0) {
    *(uint *)(in_ECX + 0x14) = *(uint *)(in_ECX + 0x14) & 0xfffffffd;
  }
  else {
    *(uint *)(in_ECX + 0x14) = *(uint *)(in_ECX + 0x14) | 2;
  }
  if ((bVar1 & 1) == 0) {
    *(uint *)(in_ECX + 0x14) = *(uint *)(in_ECX + 0x14) & 0xffffbfff;
  }
  else {
    *(uint *)(in_ECX + 0x14) = *(uint *)(in_ECX + 0x14) | 0x4000;
  }
  cVar3 = FUN_00539cd0();
  if (cVar3 != '\0') {
    GThread::OnExit(this);
    GThread::OnExit(this_00);
    GThread::OnExit((GThread *)(*(uint *)(in_ECX + 0x14) & 0x300));
    if (param_2 == 0x3e) {
      GThread::OnExit(param_1);
    }
  }
  FUN_005e4670(iVar2);
  return;
}



============================================================
DISASSEMBLY
============================================================
005e47d0 : PUSH EBX
005e47d1 : PUSH EBP
005e47d2 : PUSH ESI
005e47d3 : PUSH EDI
005e47d4 : MOV EDI,ECX
005e47d6 : MOV EAX,dword ptr [EDI + 0x18]
005e47d9 : TEST EAX,EAX
005e47db : JZ 0x005e47ea
005e47dd : PUSH EAX
005e47de : CALL 0x00515cf0
005e47e3 : MOV dword ptr [EDI + 0x18],0x0
005e47ea : MOV ESI,dword ptr [ESP + 0x14]
005e47ee : MOV EAX,dword ptr [ESI + 0x1c]
005e47f1 : PUSH EAX
005e47f2 : MOV ECX,ESI
005e47f4 : CALL 0x0053aa80
005e47f9 : MOV dword ptr [EDI + 0x18],EAX
005e47fc : MOV EAX,dword ptr [ESI + 0x30]
005e47ff : SUB EAX,dword ptr [ESI + 0x2c]
005e4802 : MOV byte ptr [ESI + 0x15],0x0
005e4806 : CMP EAX,0x1
005e4809 : JGE 0x005e4812
005e480b : MOV ECX,ESI
005e480d : CALL 0x0053a0a0
005e4812 : MOV EAX,dword ptr [ESI + 0x2c]
005e4815 : MOV ECX,dword ptr [ESI + 0x3c]
005e4818 : MOV BL,byte ptr [EAX + ECX*0x1]
005e481b : MOV EBP,dword ptr [ESP + 0x18]
005e481f : INC EAX
005e4820 : MOV dword ptr [ESI + 0x2c],EAX
005e4823 : MOV byte ptr [ESP + 0x14],0x0
005e4828 : CMP EBP,0x3e
005e482b : JNZ 0x005e4853
005e482d : MOV EDX,dword ptr [ESI + 0x30]
005e4830 : SUB EDX,EAX
005e4832 : CMP EDX,0x1
005e4835 : MOV byte ptr [ESI + 0x15],0x0
005e4839 : JGE 0x005e4842
005e483b : MOV ECX,ESI
005e483d : CALL 0x0053a0a0
005e4842 : MOV EAX,dword ptr [ESI + 0x2c]
005e4845 : MOV ECX,dword ptr [ESI + 0x3c]
005e4848 : MOV DL,byte ptr [EAX + ECX*0x1]
005e484b : INC EAX
005e484c : MOV byte ptr [ESP + 0x14],DL
005e4850 : MOV dword ptr [ESI + 0x2c],EAX
005e4853 : TEST BL,0x10
005e4856 : JZ 0x005e486a
005e4858 : MOV EAX,dword ptr [EDI + 0x14]
005e485b : AND EAX,0xfffffeff
005e4860 : OR EAX,0x200
005e4865 : MOV dword ptr [EDI + 0x14],EAX
005e4868 : JMP 0x005e488a
005e486a : TEST BL,0x8
005e486d : JZ 0x005e4883
005e486f : MOV ECX,dword ptr [EDI + 0x14]
005e4872 : AND ECX,0xfffffdff
005e4878 : OR ECX,0x100
005e487e : MOV dword ptr [EDI + 0x14],ECX
005e4881 : JMP 0x005e488a
005e4883 : AND dword ptr [EDI + 0x14],0xfffffcff
005e488a : TEST BL,0x4
005e488d : JZ 0x005e4895
005e488f : OR dword ptr [EDI + 0x14],0x1
005e4893 : JMP 0x005e4899
005e4895 : AND dword ptr [EDI + 0x14],0xfffffffe
005e4899 : TEST BL,0x2
005e489c : JZ 0x005e48a4
005e489e : OR dword ptr [EDI + 0x14],0x2
005e48a2 : JMP 0x005e48a8
005e48a4 : AND dword ptr [EDI + 0x14],0xfffffffd
005e48a8 : TEST BL,0x1
005e48ab : JZ 0x005e48b6
005e48ad : OR dword ptr [EDI + 0x14],0x4000
005e48b4 : JMP 0x005e48bd
005e48b6 : AND dword ptr [EDI + 0x14],0xffffbfff
005e48bd : MOV ECX,ESI
005e48bf : CALL 0x00539cd0
005e48c4 : TEST AL,AL
005e48c6 : JZ 0x005e4963
005e48cc : CMP EBP,0xd
005e48cf : JNZ 0x005e48d8
005e48d1 : PUSH 0xb93d48
005e48d6 : JMP 0x005e48dd
005e48d8 : PUSH 0xb93d2c
005e48dd : PUSH ESI
005e48de : CALL 0x0051d420
005e48e3 : MOV EAX,dword ptr [EDI + 0x18]
005e48e6 : ADD ESP,0x8
005e48e9 : TEST EAX,EAX
005e48eb : JNZ 0x005e48f2
005e48ed : MOV EAX,0xb93c70
005e48f2 : PUSH EAX
005e48f3 : PUSH 0xb93d1c
005e48f8 : PUSH ESI
005e48f9 : CALL 0x0051d420
005e48fe : MOV EAX,dword ptr [EDI + 0x14]
005e4901 : MOV ECX,EAX
005e4903 : AND ECX,0x300
005e4909 : ADD ESP,0xc
005e490c : MOV EDX,0xb93c50
005e4911 : CMP ECX,0x200
005e4917 : JNZ 0x005e4920
005e4919 : MOV EDX,0xb93c44
005e491e : JMP 0x005e492d
005e4920 : CMP ECX,0x100
005e4926 : JNZ 0x005e492d
005e4928 : MOV EDX,0xb93c3c
005e492d : SHR EAX,0x1
005e492f : AND EAX,0x1
005e4932 : PUSH EAX
005e4933 : MOVZX EAX,byte ptr [EDI + 0x14]
005e4937 : AND EAX,0x1
005e493a : PUSH EAX
005e493b : PUSH EDX
005e493c : PUSH 0xb93cf0
005e4941 : PUSH ESI
005e4942 : CALL 0x0051d420
005e4947 : ADD ESP,0x14
005e494a : CMP EBP,0x3e
005e494d : JNZ 0x005e4963
005e494f : MOVZX ECX,byte ptr [ESP + 0x14]
005e4954 : PUSH ECX
005e4955 : PUSH 0xb93bec
005e495a : PUSH ESI
005e495b : CALL 0x0051d420
005e4960 : ADD ESP,0xc
005e4963 : PUSH ESI
005e4964 : MOV ECX,EDI
005e4966 : CALL 0x005e4670
005e496b : POP EDI
005e496c : POP ESI
005e496d : POP EBP
005e496e : POP EBX
005e496f : RET 0x8

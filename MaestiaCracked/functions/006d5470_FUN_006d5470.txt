PROGRAM  : Maestia.exe
FUNCTION : FUN_006d5470
ENTRY    : 006d5470
BODY     : [[006d5470, 006d5767]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_006d5470(void)

{
  undefined1 uVar1;
  undefined1 uVar2;
  byte bVar3;
  undefined4 *puVar4;
  uint uVar5;
  uint uVar6;
  int iVar7;
  uint uVar8;
  undefined1 *puVar9;
  byte *pbVar10;
  byte *pbVar11;
  int *unaff_ESI;
  int iVar12;
  uint *puVar13;
  int *piStack_10;
  int iStack_8;
  
  puVar4 = (undefined4 *)unaff_ESI[6];
  puVar9 = (undefined1 *)*puVar4;
  iVar12 = puVar4[1];
  if (*(char *)(unaff_ESI[0x65] + 0xd) == '\0') {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0x3e;
    (**(code **)*unaff_ESI)();
  }
  if (iVar12 == 0) {
    uVar5 = (*(code *)puVar4[3])();
    if ((char)uVar5 == '\0') goto LAB_006d54b3;
    iVar12 = puVar4[1];
    puVar9 = (undefined1 *)*puVar4;
  }
  uVar1 = *puVar9;
  iVar12 = iVar12 + -1;
  puVar9 = puVar9 + 1;
  if (iVar12 == 0) {
    uVar5 = (*(code *)puVar4[3])();
    if ((char)uVar5 == '\0') goto LAB_006d54b3;
    iVar12 = puVar4[1];
    puVar9 = (undefined1 *)*puVar4;
  }
  uVar2 = *puVar9;
  iVar12 = iVar12 + -1;
  pbVar10 = puVar9 + 1;
  if (iVar12 == 0) {
    uVar5 = (*(code *)puVar4[3])();
    if ((char)uVar5 == '\0') goto LAB_006d54b3;
    iVar12 = puVar4[1];
    pbVar10 = (byte *)*puVar4;
  }
  uVar6 = (uint)*pbVar10;
  *(undefined4 *)(*unaff_ESI + 0x14) = 0x67;
  *(uint *)(*unaff_ESI + 0x18) = uVar6;
  iVar12 = iVar12 + -1;
  pbVar10 = pbVar10 + 1;
  (**(code **)(*unaff_ESI + 4))();
  if ((((uint)CONCAT11(uVar1,uVar2) != uVar6 * 2 + 6) || (uVar6 == 0)) || (4 < uVar6)) {
    *(undefined4 *)(*unaff_ESI + 0x14) = 0xb;
    (**(code **)*unaff_ESI)();
  }
  unaff_ESI[0x49] = uVar6;
  iStack_8 = 0;
  if (uVar6 != 0) {
    piStack_10 = unaff_ESI + 0x4a;
    do {
      if (iVar12 == 0) {
        uVar5 = (*(code *)puVar4[3])();
        if ((char)uVar5 == '\0') goto LAB_006d54b3;
        iVar12 = puVar4[1];
        pbVar10 = (byte *)*puVar4;
      }
      uVar8 = (uint)*pbVar10;
      iVar12 = iVar12 + -1;
      pbVar10 = pbVar10 + 1;
      if (iVar12 == 0) {
        uVar5 = (*(code *)puVar4[3])();
        if ((char)uVar5 == '\0') goto LAB_006d54b3;
        iVar12 = puVar4[1];
        pbVar10 = (byte *)*puVar4;
      }
      bVar3 = *pbVar10;
      iVar12 = iVar12 + -1;
      iVar7 = 0;
      pbVar10 = pbVar10 + 1;
      puVar13 = (uint *)unaff_ESI[0x31];
      if (0 < unaff_ESI[9]) {
        do {
          if (uVar8 == *puVar13) goto LAB_006d5612;
          iVar7 = iVar7 + 1;
          puVar13 = puVar13 + 0x15;
        } while (iVar7 < unaff_ESI[9]);
      }
      *(undefined4 *)(*unaff_ESI + 0x14) = 5;
      *(uint *)(*unaff_ESI + 0x18) = uVar8;
      (**(code **)*unaff_ESI)();
LAB_006d5612:
      *piStack_10 = (int)puVar13;
      puVar13[5] = (int)(uint)bVar3 >> 4;
      puVar13[6] = bVar3 & 0xf;
      iVar7 = *unaff_ESI;
      *(uint *)(iVar7 + 0x18) = uVar8;
      *(uint *)(iVar7 + 0x1c) = puVar13[5];
      *(uint *)(iVar7 + 0x20) = puVar13[6];
      *(undefined4 *)(*unaff_ESI + 0x14) = 0x68;
      (**(code **)(*unaff_ESI + 4))();
      piStack_10 = piStack_10 + 1;
      iStack_8 = iStack_8 + 1;
    } while (iStack_8 < (int)uVar6);
  }
  if (iVar12 == 0) {
    uVar5 = (*(code *)puVar4[3])();
    if ((char)uVar5 == '\0') goto LAB_006d54b3;
    iVar12 = puVar4[1];
    pbVar10 = (byte *)*puVar4;
  }
  iVar12 = iVar12 + -1;
  pbVar11 = pbVar10 + 1;
  unaff_ESI[0x5b] = (uint)*pbVar10;
  if (iVar12 == 0) {
    uVar5 = (*(code *)puVar4[3])();
    if ((char)uVar5 == '\0') goto LAB_006d54b3;
    iVar12 = puVar4[1];
    pbVar11 = (byte *)*puVar4;
  }
  iVar12 = iVar12 + -1;
  pbVar10 = pbVar11 + 1;
  unaff_ESI[0x5c] = (uint)*pbVar11;
  if (iVar12 == 0) {
    uVar5 = (*(code *)puVar4[3])();
    if ((char)uVar5 == '\0') {
LAB_006d54b3:
      return uVar5 & 0xffffff00;
    }
    iVar12 = puVar4[1];
    pbVar10 = (byte *)*puVar4;
  }
  bVar3 = *pbVar10;
  unaff_ESI[0x5e] = bVar3 & 0xf;
  iVar7 = *unaff_ESI;
  unaff_ESI[0x5d] = (int)(uint)bVar3 >> 4;
  *(int *)(iVar7 + 0x18) = unaff_ESI[0x5b];
  *(int *)(iVar7 + 0x1c) = unaff_ESI[0x5c];
  *(int *)(iVar7 + 0x20) = unaff_ESI[0x5d];
  *(int *)(iVar7 + 0x24) = unaff_ESI[0x5e];
  *(undefined4 *)(*unaff_ESI + 0x14) = 0x69;
  (**(code **)(*unaff_ESI + 4))();
  iVar7 = unaff_ESI[0x65];
  *(undefined4 *)(iVar7 + 0x10) = 0;
  unaff_ESI[0x1f] = unaff_ESI[0x1f] + 1;
  puVar4[1] = iVar12 + -1;
  *puVar4 = pbVar10 + 1;
  return CONCAT31((int3)((uint)iVar7 >> 8),1);
}



============================================================
DISASSEMBLY
============================================================
006d5470 : SUB ESP,0x18
006d5473 : MOV EAX,dword ptr [ESI + 0x194]
006d5479 : CMP byte ptr [EAX + 0xd],0x0
006d547d : PUSH EBX
006d547e : PUSH EBP
006d547f : MOV EBP,dword ptr [ESI + 0x18]
006d5482 : MOV EBX,dword ptr [EBP]
006d5485 : PUSH EDI
006d5486 : MOV EDI,dword ptr [EBP + 0x4]
006d5489 : MOV dword ptr [ESP + 0x20],EBP
006d548d : JNZ 0x006d54a2
006d548f : MOV ECX,dword ptr [ESI]
006d5491 : MOV dword ptr [ECX + 0x14],0x3e
006d5498 : MOV EDX,dword ptr [ESI]
006d549a : MOV EAX,dword ptr [EDX]
006d549c : PUSH ESI
006d549d : CALL EAX
006d549f : ADD ESP,0x4
006d54a2 : TEST EDI,EDI
006d54a4 : JNZ 0x006d54c4
006d54a6 : MOV ECX,dword ptr [EBP + 0xc]
006d54a9 : PUSH ESI
006d54aa : CALL ECX
006d54ac : ADD ESP,0x4
006d54af : TEST AL,AL
006d54b1 : JNZ 0x006d54bc
006d54b3 : POP EDI
006d54b4 : POP EBP
006d54b5 : XOR AL,AL
006d54b7 : POP EBX
006d54b8 : ADD ESP,0x18
006d54bb : RET
006d54bc : MOV EDX,dword ptr [EBP + 0x4]
006d54bf : MOV EBX,dword ptr [EBP]
006d54c2 : MOV EDI,EDX
006d54c4 : MOVZX EAX,byte ptr [EBX]
006d54c7 : DEC EDI
006d54c8 : SHL EAX,0x8
006d54cb : INC EBX
006d54cc : MOV dword ptr [ESP + 0x10],EAX
006d54d0 : TEST EDI,EDI
006d54d2 : JNZ 0x006d54ed
006d54d4 : MOV EAX,dword ptr [EBP + 0xc]
006d54d7 : PUSH ESI
006d54d8 : CALL EAX
006d54da : ADD ESP,0x4
006d54dd : TEST AL,AL
006d54df : JZ 0x006d54b3
006d54e1 : MOV ECX,dword ptr [EBP + 0x4]
006d54e4 : MOV EBX,dword ptr [EBP]
006d54e7 : MOV EAX,dword ptr [ESP + 0x10]
006d54eb : MOV EDI,ECX
006d54ed : MOVZX EDX,byte ptr [EBX]
006d54f0 : DEC EDI
006d54f1 : ADD EAX,EDX
006d54f3 : INC EBX
006d54f4 : MOV dword ptr [ESP + 0x10],EAX
006d54f8 : TEST EDI,EDI
006d54fa : JNZ 0x006d5511
006d54fc : MOV EAX,dword ptr [EBP + 0xc]
006d54ff : PUSH ESI
006d5500 : CALL EAX
006d5502 : ADD ESP,0x4
006d5505 : TEST AL,AL
006d5507 : JZ 0x006d54b3
006d5509 : MOV ECX,dword ptr [EBP + 0x4]
006d550c : MOV EBX,dword ptr [EBP]
006d550f : MOV EDI,ECX
006d5511 : MOVZX EAX,byte ptr [EBX]
006d5514 : MOV EDX,dword ptr [ESI]
006d5516 : MOV dword ptr [EDX + 0x14],0x67
006d551d : MOV ECX,dword ptr [ESI]
006d551f : MOV dword ptr [ECX + 0x18],EAX
006d5522 : MOV EDX,dword ptr [ESI]
006d5524 : MOV dword ptr [ESP + 0x18],EAX
006d5528 : MOV EAX,dword ptr [EDX + 0x4]
006d552b : PUSH 0x1
006d552d : PUSH ESI
006d552e : DEC EDI
006d552f : INC EBX
006d5530 : CALL EAX
006d5532 : MOV EAX,dword ptr [ESP + 0x20]
006d5536 : LEA ECX,[EAX + EAX*0x1 + 0x6]
006d553a : ADD ESP,0x8
006d553d : CMP dword ptr [ESP + 0x10],ECX
006d5541 : JNZ 0x006d554d
006d5543 : CMP EAX,0x1
006d5546 : JL 0x006d554d
006d5548 : CMP EAX,0x4
006d554b : JLE 0x006d5564
006d554d : MOV EDX,dword ptr [ESI]
006d554f : MOV dword ptr [EDX + 0x14],0xb
006d5556 : MOV EAX,dword ptr [ESI]
006d5558 : MOV ECX,dword ptr [EAX]
006d555a : PUSH ESI
006d555b : CALL ECX
006d555d : MOV EAX,dword ptr [ESP + 0x1c]
006d5561 : ADD ESP,0x4
006d5564 : MOV dword ptr [ESI + 0x124],EAX
006d556a : MOV dword ptr [ESP + 0x1c],0x0
006d5572 : TEST EAX,EAX
006d5574 : JLE 0x006d5676
006d557a : LEA EDX,[ESI + 0x128]
006d5580 : MOV dword ptr [ESP + 0x14],EDX
006d5584 : TEST EDI,EDI
006d5586 : JNZ 0x006d55a5
006d5588 : MOV EAX,dword ptr [EBP + 0xc]
006d558b : PUSH ESI
006d558c : CALL EAX
006d558e : ADD ESP,0x4
006d5591 : TEST AL,AL
006d5593 : JZ 0x006d54b3
006d5599 : MOV ECX,dword ptr [EBP + 0x4]
006d559c : MOV EBX,dword ptr [EBP]
006d559f : MOV dword ptr [ESP + 0xc],ECX
006d55a3 : MOV EDI,ECX
006d55a5 : MOVZX EDX,byte ptr [EBX]
006d55a8 : DEC EDI
006d55a9 : INC EBX
006d55aa : MOV dword ptr [ESP + 0x10],EDX
006d55ae : TEST EDI,EDI
006d55b0 : JNZ 0x006d55cf
006d55b2 : MOV EAX,dword ptr [EBP + 0xc]
006d55b5 : PUSH ESI
006d55b6 : CALL EAX
006d55b8 : ADD ESP,0x4
006d55bb : TEST AL,AL
006d55bd : JZ 0x006d54b3
006d55c3 : MOV ECX,dword ptr [EBP + 0x4]
006d55c6 : MOV EBX,dword ptr [EBP]
006d55c9 : MOV dword ptr [ESP + 0xc],ECX
006d55cd : MOV EDI,ECX
006d55cf : MOVZX EBP,byte ptr [EBX]
006d55d2 : DEC EDI
006d55d3 : XOR EAX,EAX
006d55d5 : INC EBX
006d55d6 : CMP dword ptr [ESI + 0x24],EAX
006d55d9 : MOV dword ptr [ESP + 0xc],EDI
006d55dd : MOV EDI,dword ptr [ESI + 0xc4]
006d55e3 : JLE 0x006d55f6
006d55e5 : MOV EDX,dword ptr [ESP + 0x10]
006d55e9 : CMP EDX,dword ptr [EDI]
006d55eb : JZ 0x006d5612
006d55ed : INC EAX
006d55ee : ADD EDI,0x54
006d55f1 : CMP EAX,dword ptr [ESI + 0x24]
006d55f4 : JL 0x006d55e5
006d55f6 : MOV EAX,dword ptr [ESI]
006d55f8 : MOV EDX,dword ptr [ESP + 0x10]
006d55fc : MOV dword ptr [EAX + 0x14],0x5
006d5603 : MOV ECX,dword ptr [ESI]
006d5605 : MOV dword ptr [ECX + 0x18],EDX
006d5608 : MOV EAX,dword ptr [ESI]
006d560a : MOV ECX,dword ptr [EAX]
006d560c : PUSH ESI
006d560d : CALL ECX
006d560f : ADD ESP,0x4
006d5612 : MOV EDX,dword ptr [ESP + 0x14]
006d5616 : MOV ECX,dword ptr [ESP + 0x10]
006d561a : MOV dword ptr [EDX],EDI
006d561c : MOV EAX,EBP
006d561e : SAR EAX,0x4
006d5621 : AND EAX,0xf
006d5624 : MOV dword ptr [EDI + 0x14],EAX
006d5627 : AND EBP,0xf
006d562a : MOV dword ptr [EDI + 0x18],EBP
006d562d : MOV EAX,dword ptr [ESI]
006d562f : ADD EAX,0x18
006d5632 : MOV dword ptr [EAX],ECX
006d5634 : MOV EDX,dword ptr [EDI + 0x14]
006d5637 : MOV dword ptr [EAX + 0x4],EDX
006d563a : MOV ECX,dword ptr [EDI + 0x18]
006d563d : MOV dword ptr [EAX + 0x8],ECX
006d5640 : MOV EDX,dword ptr [ESI]
006d5642 : MOV dword ptr [EDX + 0x14],0x68
006d5649 : MOV EAX,dword ptr [ESI]
006d564b : MOV ECX,dword ptr [EAX + 0x4]
006d564e : PUSH 0x1
006d5650 : PUSH ESI
006d5651 : CALL ECX
006d5653 : MOV EAX,dword ptr [ESP + 0x24]
006d5657 : ADD dword ptr [ESP + 0x1c],0x4
006d565c : MOV EDI,dword ptr [ESP + 0x14]
006d5660 : MOV EBP,dword ptr [ESP + 0x28]
006d5664 : INC EAX
006d5665 : ADD ESP,0x8
006d5668 : CMP EAX,dword ptr [ESP + 0x18]
006d566c : MOV dword ptr [ESP + 0x1c],EAX
006d5670 : JL 0x006d5584
006d5676 : TEST EDI,EDI
006d5678 : JNZ 0x006d5697
006d567a : MOV EDX,dword ptr [EBP + 0xc]
006d567d : PUSH ESI
006d567e : CALL EDX
006d5680 : ADD ESP,0x4
006d5683 : TEST AL,AL
006d5685 : JZ 0x006d54b3
006d568b : MOV EAX,dword ptr [EBP + 0x4]
006d568e : MOV EBX,dword ptr [EBP]
006d5691 : MOV dword ptr [ESP + 0xc],EAX
006d5695 : MOV EDI,EAX
006d5697 : MOVZX EAX,byte ptr [EBX]
006d569a : DEC EDI
006d569b : INC EBX
006d569c : MOV dword ptr [ESI + 0x16c],EAX
006d56a2 : TEST EDI,EDI
006d56a4 : JNZ 0x006d56c3
006d56a6 : MOV ECX,dword ptr [EBP + 0xc]
006d56a9 : PUSH ESI
006d56aa : CALL ECX
006d56ac : ADD ESP,0x4
006d56af : TEST AL,AL
006d56b1 : JZ 0x006d54b3
006d56b7 : MOV EDX,dword ptr [EBP + 0x4]
006d56ba : MOV EBX,dword ptr [EBP]
006d56bd : MOV dword ptr [ESP + 0xc],EDX
006d56c1 : MOV EDI,EDX
006d56c3 : MOVZX EAX,byte ptr [EBX]
006d56c6 : DEC EDI
006d56c7 : INC EBX
006d56c8 : MOV dword ptr [ESI + 0x170],EAX
006d56ce : TEST EDI,EDI
006d56d0 : JNZ 0x006d56ef
006d56d2 : MOV EAX,dword ptr [EBP + 0xc]
006d56d5 : PUSH ESI
006d56d6 : CALL EAX
006d56d8 : ADD ESP,0x4
006d56db : TEST AL,AL
006d56dd : JZ 0x006d54b3
006d56e3 : MOV ECX,dword ptr [EBP + 0x4]
006d56e6 : MOV EBX,dword ptr [EBP]
006d56e9 : MOV dword ptr [ESP + 0xc],ECX
006d56ed : MOV EDI,ECX
006d56ef : MOVZX EAX,byte ptr [EBX]
006d56f2 : MOV ECX,dword ptr [ESI + 0x16c]
006d56f8 : MOV EDX,EAX
006d56fa : AND EAX,0xf
006d56fd : MOV dword ptr [ESI + 0x178],EAX
006d5703 : MOV EAX,dword ptr [ESI]
006d5705 : SAR EDX,0x4
006d5708 : AND EDX,0xf
006d570b : MOV dword ptr [ESI + 0x174],EDX
006d5711 : ADD EAX,0x18
006d5714 : MOV dword ptr [EAX],ECX
006d5716 : MOV EDX,dword ptr [ESI + 0x170]
006d571c : MOV dword ptr [EAX + 0x4],EDX
006d571f : MOV ECX,dword ptr [ESI + 0x174]
006d5725 : MOV dword ptr [EAX + 0x8],ECX
006d5728 : MOV EDX,dword ptr [ESI + 0x178]
006d572e : MOV dword ptr [EAX + 0xc],EDX
006d5731 : MOV EAX,dword ptr [ESI]
006d5733 : MOV dword ptr [EAX + 0x14],0x69
006d573a : MOV ECX,dword ptr [ESI]
006d573c : MOV EDX,dword ptr [ECX + 0x4]
006d573f : PUSH 0x1
006d5741 : PUSH ESI
006d5742 : CALL EDX
006d5744 : MOV EAX,dword ptr [ESI + 0x194]
006d574a : MOV dword ptr [EAX + 0x10],0x0
006d5751 : INC dword ptr [ESI + 0x7c]
006d5754 : ADD ESP,0x8
006d5757 : INC EBX
006d5758 : DEC EDI
006d5759 : MOV dword ptr [EBP + 0x4],EDI
006d575c : POP EDI
006d575d : MOV dword ptr [EBP],EBX
006d5760 : POP EBP
006d5761 : MOV AL,0x1
006d5763 : POP EBX
006d5764 : ADD ESP,0x18
006d5767 : RET

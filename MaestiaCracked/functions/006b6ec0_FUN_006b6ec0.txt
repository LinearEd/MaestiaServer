PROGRAM  : Maestia.exe
FUNCTION : FUN_006b6ec0
ENTRY    : 006b6ec0
BODY     : [[006b6ec0, 006b6f09] [006b6f10, 006b6fda]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006b6ec0(void)

{
  uint uVar1;
  uint *in_EAX;
  int iVar2;
  int iVar3;
  int *unaff_ESI;
  uint uVar4;
  uint local_8;
  
  uVar1 = *in_EAX;
  if (*(char *)(*unaff_ESI + 0x2b4) == '\0') {
    local_8 = 1;
    if (uVar1 != 0) {
      do {
        if (unaff_ESI[7] < 2) {
          unaff_ESI[3] = 0x81;
          return;
        }
        iVar3 = unaff_ESI[7] + -2;
        unaff_ESI[7] = iVar3;
        if (*(ushort *)(unaff_ESI[6] + 4 + iVar3 * 4) < *(ushort *)(unaff_ESI + 0xb)) {
          uVar4 = *(uint *)(unaff_ESI[6] + iVar3 * 4) >> 4 & 0xf;
          if ((char)unaff_ESI[0x5c] == 'q') {
            uVar4 = uVar4 + 0x10;
          }
          else if ((char)unaff_ESI[0x5c] == 'r') {
            uVar4 = uVar4 + 0x20;
          }
          iVar3 = unaff_ESI[0x53];
          iVar2 = FUN_006b40d0();
          if (iVar2 == uVar4 + (int)(short)iVar3) {
            (*(code *)unaff_ESI[0x92])();
          }
        }
        else if (*(char *)((int)unaff_ESI + 0x231) != '\0') {
          unaff_ESI[3] = 0x86;
        }
        local_8 = local_8 + 1;
      } while (local_8 <= uVar1);
    }
    unaff_ESI[8] = unaff_ESI[7];
    return;
  }
  if (unaff_ESI[7] < (int)(uVar1 * 2)) {
    unaff_ESI[3] = 0x81;
    return;
  }
  iVar3 = unaff_ESI[7] + uVar1 * -2;
  unaff_ESI[7] = iVar3;
  unaff_ESI[8] = iVar3;
  return;
}



============================================================
DISASSEMBLY
============================================================
006b6ec0 : MOV ECX,dword ptr [ESI]
006b6ec2 : MOV EAX,dword ptr [EAX]
006b6ec4 : SUB ESP,0x8
006b6ec7 : CMP byte ptr [ECX + 0x2b4],0x0
006b6ece : JZ 0x006b6ef0
006b6ed0 : MOV ECX,dword ptr [ESI + 0x1c]
006b6ed3 : ADD EAX,EAX
006b6ed5 : CMP ECX,EAX
006b6ed7 : JGE 0x006b6ee4
006b6ed9 : MOV dword ptr [ESI + 0xc],0x81
006b6ee0 : ADD ESP,0x8
006b6ee3 : RET
006b6ee4 : SUB ECX,EAX
006b6ee6 : MOV dword ptr [ESI + 0x1c],ECX
006b6ee9 : MOV dword ptr [ESI + 0x20],ECX
006b6eec : ADD ESP,0x8
006b6eef : RET
006b6ef0 : PUSH EBX
006b6ef1 : PUSH EBP
006b6ef2 : PUSH EDI
006b6ef3 : MOV dword ptr [ESP + 0x10],EAX
006b6ef7 : MOV dword ptr [ESP + 0xc],0x1
006b6eff : CMP EAX,0x1
006b6f02 : JC 0x006b6fc0
006b6f08 : JMP 0x006b6f10
006b6f10 : MOV EAX,dword ptr [ESI + 0x1c]
006b6f13 : CMP EAX,0x2
006b6f16 : JL 0x006b6fcd
006b6f1c : MOV EDX,dword ptr [ESI + 0x18]
006b6f1f : ADD EAX,-0x2
006b6f22 : MOV dword ptr [ESI + 0x1c],EAX
006b6f25 : MOVZX EBP,word ptr [EDX + EAX*0x4 + 0x4]
006b6f2a : MOV EBX,dword ptr [EDX + EAX*0x4]
006b6f2d : LEA EAX,[EDX + EAX*0x4]
006b6f30 : CMP BP,word ptr [ESI + 0x2c]
006b6f34 : JNC 0x006b6f9d
006b6f36 : MOVZX EAX,byte ptr [ESI + 0x170]
006b6f3d : MOV EDI,EBX
006b6f3f : SHR EDI,0x4
006b6f42 : AND EDI,0xf
006b6f45 : SUB EAX,0x71
006b6f48 : JZ 0x006b6f54
006b6f4a : SUB EAX,0x1
006b6f4d : JNZ 0x006b6f57
006b6f4f : ADD EDI,0x20
006b6f52 : JMP 0x006b6f57
006b6f54 : ADD EDI,0x10
006b6f57 : MOVSX EAX,word ptr [ESI + 0x14c]
006b6f5e : ADD EDI,EAX
006b6f60 : MOV EAX,ESI
006b6f62 : CALL 0x006b40d0
006b6f67 : CMP EAX,EDI
006b6f69 : JNZ 0x006b6fad
006b6f6b : AND EBX,0xf
006b6f6e : SUB EBX,0x8
006b6f71 : MOV EAX,EBX
006b6f73 : JS 0x006b6f76
006b6f75 : INC EAX
006b6f76 : MOV CL,byte ptr [ESI + 0x14e]
006b6f7c : MOV EDI,0x1
006b6f81 : SHL EDI,CL
006b6f83 : SHL EAX,0x6
006b6f86 : CDQ
006b6f87 : IDIV EDI
006b6f89 : MOV EDX,dword ptr [ESI + 0x248]
006b6f8f : LEA ECX,[ESI + 0x24]
006b6f92 : PUSH EAX
006b6f93 : PUSH EBP
006b6f94 : PUSH ECX
006b6f95 : PUSH ESI
006b6f96 : CALL EDX
006b6f98 : ADD ESP,0x10
006b6f9b : JMP 0x006b6fad
006b6f9d : CMP byte ptr [ESI + 0x231],0x0
006b6fa4 : JZ 0x006b6fad
006b6fa6 : MOV dword ptr [ESI + 0xc],0x86
006b6fad : MOV EAX,dword ptr [ESP + 0xc]
006b6fb1 : INC EAX
006b6fb2 : MOV dword ptr [ESP + 0xc],EAX
006b6fb6 : CMP EAX,dword ptr [ESP + 0x10]
006b6fba : JBE 0x006b6f10
006b6fc0 : MOV EAX,dword ptr [ESI + 0x1c]
006b6fc3 : POP EDI
006b6fc4 : POP EBP
006b6fc5 : MOV dword ptr [ESI + 0x20],EAX
006b6fc8 : POP EBX
006b6fc9 : ADD ESP,0x8
006b6fcc : RET
006b6fcd : POP EDI
006b6fce : POP EBP
006b6fcf : MOV dword ptr [ESI + 0xc],0x81
006b6fd6 : POP EBX
006b6fd7 : ADD ESP,0x8
006b6fda : RET

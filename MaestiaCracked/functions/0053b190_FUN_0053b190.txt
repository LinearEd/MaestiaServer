PROGRAM  : Maestia.exe
FUNCTION : FUN_0053b190
ENTRY    : 0053b190
BODY     : [[0053b190, 0053b1ac] [0053b1b0, 0053b29d]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_0053b190(void)

{
  uint uVar1;
  char cVar2;
  int iVar3;
  uint uVar4;
  int in_ECX;
  uint uVar5;
  int local_c;
  uint local_8;
  uint local_4;
  
  *(undefined1 *)(in_ECX + 0x15) = 0;
  local_c = 0;
  local_8 = 0;
  local_4 = 0;
  while( true ) {
    uVar4 = local_8;
    *(undefined1 *)(in_ECX + 0x15) = 0;
    if (*(int *)(in_ECX + 0x30) - *(int *)(in_ECX + 0x2c) < 1) {
      FUN_00539fb0(1);
    }
    cVar2 = *(char *)(*(int *)(in_ECX + 0x2c) + *(int *)(in_ECX + 0x3c));
    *(int *)(in_ECX + 0x2c) = *(int *)(in_ECX + 0x2c) + 1;
    uVar1 = uVar4 + 1;
    if (cVar2 == '\0') break;
    if (uVar1 < uVar4) {
      uVar5 = uVar1;
      if (uVar1 < local_4 >> 1) {
LAB_0053b205:
        FUN_005da1e0(&local_c,uVar5);
      }
    }
    else if (local_4 <= uVar1) {
      uVar5 = (uVar1 >> 2) + uVar1;
      goto LAB_0053b205;
    }
    local_8 = uVar1;
    if ((char *)(uVar4 + local_c) != (char *)0x0) {
      *(char *)(uVar4 + local_c) = cVar2;
    }
  }
  if (uVar1 < uVar4) {
    uVar5 = uVar1;
    if (local_4 >> 1 <= uVar1) goto LAB_0053b256;
  }
  else {
    if (uVar1 < local_4) goto LAB_0053b256;
    uVar5 = (uVar1 >> 2) + uVar1;
  }
  FUN_005da1e0(&local_c,uVar5);
LAB_0053b256:
  iVar3 = local_c;
  if ((undefined1 *)(uVar4 + local_c) != (undefined1 *)0x0) {
    *(undefined1 *)(uVar4 + local_c) = 0;
  }
  if (uVar1 != 0) {
    FUN_0051bab0(local_c,uVar4);
    FUN_00515cf0(iVar3);
    return 1;
  }
  FUN_0051bf30();
  FUN_00515cf0(iVar3);
  return 0;
}



============================================================
DISASSEMBLY
============================================================
0053b190 : SUB ESP,0xc
0053b193 : PUSH EBX
0053b194 : PUSH EBP
0053b195 : PUSH ESI
0053b196 : XOR EBP,EBP
0053b198 : PUSH EDI
0053b199 : MOV EDI,ECX
0053b19b : MOV byte ptr [EDI + 0x15],0x0
0053b19f : MOV dword ptr [ESP + 0x10],EBP
0053b1a3 : MOV dword ptr [ESP + 0x14],EBP
0053b1a7 : MOV dword ptr [ESP + 0x18],EBP
0053b1ab : JMP 0x0053b1b0
0053b1b0 : MOV EAX,dword ptr [EDI + 0x30]
0053b1b3 : SUB EAX,dword ptr [EDI + 0x2c]
0053b1b6 : MOV byte ptr [EDI + 0x15],0x0
0053b1ba : CMP EAX,0x1
0053b1bd : JGE 0x0053b1c8
0053b1bf : PUSH 0x1
0053b1c1 : MOV ECX,EDI
0053b1c3 : CALL 0x00539fb0
0053b1c8 : MOV EAX,dword ptr [EDI + 0x2c]
0053b1cb : MOV ECX,dword ptr [EDI + 0x3c]
0053b1ce : MOV BL,byte ptr [EAX + ECX*0x1]
0053b1d1 : INC EAX
0053b1d2 : MOV dword ptr [EDI + 0x2c],EAX
0053b1d5 : LEA ESI,[EBP + 0x1]
0053b1d8 : TEST BL,BL
0053b1da : JZ 0x0053b224
0053b1dc : CMP ESI,EBP
0053b1de : JNC 0x0053b1f2
0053b1e0 : MOV EDX,dword ptr [ESP + 0x18]
0053b1e4 : SHR EDX,0x1
0053b1e6 : CMP ESI,EDX
0053b1e8 : JNC 0x0053b20e
0053b1ea : PUSH ESI
0053b1eb : LEA EAX,[ESP + 0x14]
0053b1ef : PUSH EAX
0053b1f0 : JMP 0x0053b205
0053b1f2 : CMP ESI,dword ptr [ESP + 0x18]
0053b1f6 : JC 0x0053b20e
0053b1f8 : MOV ECX,ESI
0053b1fa : SHR ECX,0x2
0053b1fd : ADD ECX,ESI
0053b1ff : PUSH ECX
0053b200 : LEA EDX,[ESP + 0x14]
0053b204 : PUSH EDX
0053b205 : LEA ECX,[ESP + 0x18]
0053b209 : CALL 0x005da1e0
0053b20e : MOV EAX,dword ptr [ESP + 0x10]
0053b212 : LEA EAX,[ESI + EAX*0x1 + -0x1]
0053b216 : MOV EBP,ESI
0053b218 : MOV dword ptr [ESP + 0x14],EBP
0053b21c : TEST EAX,EAX
0053b21e : JZ 0x0053b1b0
0053b220 : MOV byte ptr [EAX],BL
0053b222 : JMP 0x0053b1b0
0053b224 : CMP ESI,EBP
0053b226 : JNC 0x0053b23a
0053b228 : MOV EAX,dword ptr [ESP + 0x18]
0053b22c : SHR EAX,0x1
0053b22e : CMP ESI,EAX
0053b230 : JNC 0x0053b256
0053b232 : PUSH ESI
0053b233 : LEA ECX,[ESP + 0x14]
0053b237 : PUSH ECX
0053b238 : JMP 0x0053b24d
0053b23a : CMP ESI,dword ptr [ESP + 0x18]
0053b23e : JC 0x0053b256
0053b240 : MOV EDX,ESI
0053b242 : SHR EDX,0x2
0053b245 : ADD EDX,ESI
0053b247 : PUSH EDX
0053b248 : LEA EAX,[ESP + 0x14]
0053b24c : PUSH EAX
0053b24d : LEA ECX,[ESP + 0x18]
0053b251 : CALL 0x005da1e0
0053b256 : MOV EDI,dword ptr [ESP + 0x10]
0053b25a : LEA EAX,[ESI + EDI*0x1 + -0x1]
0053b25e : TEST EAX,EAX
0053b260 : JZ 0x0053b265
0053b262 : MOV byte ptr [EAX],0x0
0053b265 : MOV ECX,dword ptr [ESP + 0x20]
0053b269 : TEST ESI,ESI
0053b26b : JNZ 0x0053b284
0053b26d : CALL 0x0051bf30
0053b272 : PUSH EDI
0053b273 : CALL 0x00515cf0
0053b278 : POP EDI
0053b279 : POP ESI
0053b27a : POP EBP
0053b27b : XOR AL,AL
0053b27d : POP EBX
0053b27e : ADD ESP,0xc
0053b281 : RET 0x4
0053b284 : DEC ESI
0053b285 : PUSH ESI
0053b286 : PUSH EDI
0053b287 : CALL 0x0051bab0
0053b28c : PUSH EDI
0053b28d : CALL 0x00515cf0
0053b292 : POP EDI
0053b293 : POP ESI
0053b294 : POP EBP
0053b295 : MOV AL,0x1
0053b297 : POP EBX
0053b298 : ADD ESP,0xc
0053b29b : RET 0x4

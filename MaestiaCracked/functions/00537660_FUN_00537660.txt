PROGRAM  : Maestia.exe
FUNCTION : FUN_00537660
ENTRY    : 00537660
BODY     : [[00537660, 0053770c] [00537710, 00537b2d]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00537660(int param_1,int param_2,int *param_3)

{
  uint *puVar1;
  int *piVar2;
  byte *pbVar3;
  bool bVar4;
  int iVar5;
  undefined4 *puVar6;
  int in_ECX;
  int iVar7;
  uint uVar8;
  int iVar9;
  int *piVar10;
  uint uVar11;
  uint local_30;
  int local_2c;
  uint local_28;
  int iStack_24;
  int local_20;
  int local_18;
  uint local_14;
  undefined1 auStack_10 [16];
  
LAB_00537670:
  do {
    bVar4 = false;
    if (*(char *)(in_ECX + 0xb0) == '\n') {
      return param_2;
    }
    local_20 = *param_3;
    if (local_20 < 1) break;
    do {
      if (bVar4) goto LAB_00537670;
      iVar9 = *(int *)(in_ECX + 0xa8);
      pbVar3 = *(byte **)(*(int *)(in_ECX + 0xa4) + -0xc + iVar9 * 0xc);
      iVar7 = *(int *)(in_ECX + 0xa4) + -0xc + iVar9 * 0xc;
      local_18 = *(int *)(iVar7 + 4);
      local_14 = *(uint *)(iVar7 + 8);
      local_28 = *(uint *)(in_ECX + 0xa8);
      uVar8 = iVar9 - 1;
      if (uVar8 < local_28) {
        uVar11 = uVar8;
        if (uVar8 < *(uint *)(in_ECX + 0xac) >> 1) {
LAB_005376eb:
          FUN_005deae0((int *)(in_ECX + 0xa4),uVar11);
        }
      }
      else if (*(uint *)(in_ECX + 0xac) <= uVar8) {
        uVar11 = (uVar8 >> 2) + uVar8;
        goto LAB_005376eb;
      }
      *(uint *)(in_ECX + 0xa8) = uVar8;
      if (local_28 < uVar8) {
        iVar7 = *(int *)(in_ECX + 0xa4) + local_28 * 0xc;
        for (iVar9 = uVar8 - local_28; iVar9 != 0; iVar9 = iVar9 + -1) {
          if (iVar7 != 0) {
            *(undefined4 *)(iVar7 + 8) = 0;
          }
          iVar7 = iVar7 + 0xc;
        }
      }
      *param_3 = *param_3 + -1;
      puVar1 = (uint *)(in_ECX + 8);
      uVar8 = (*(int *)(in_ECX + 8) - *(int *)(in_ECX + 0xc) >> 4) +
              (*(int *)(in_ECX + 0x1c) + -1) * 0x20;
      if (local_14 < uVar8) {
        for (iVar7 = uVar8 - local_14; iVar7 != 0; iVar7 = iVar7 + -1) {
          FUN_00526bc0();
          *puVar1 = *puVar1 - 0x10;
          if (*puVar1 < *(uint *)(in_ECX + 0xc)) {
            FUN_00504f30();
          }
        }
      }
      if ((*pbVar3 & 1) != 0) {
        local_30 = 0;
        if ((*pbVar3 & 4) == 0) {
          local_30 = *(uint *)(in_ECX + 0xcc);
          iVar7 = FUN_0052a630(0);
          if (iVar7 != 0) {
            *(uint *)(iVar7 + 8) = *(int *)(iVar7 + 8) + 1U & 0x8fffffff;
          }
          iVar9 = FUN_00531000();
          if (iVar9 != 0) {
            *(uint *)(iVar9 + 8) = *(int *)(iVar9 + 8) + 1U & 0x8fffffff;
          }
          if (iVar7 != 0) {
            *(uint *)(iVar7 + 8) = *(int *)(iVar7 + 8) + 1U & 0x8fffffff;
          }
          if (*(int *)(iVar9 + 0x14) != 0) {
            FUN_00503db0();
          }
          *(int *)(iVar9 + 0x14) = iVar7;
          local_2c = *(int *)(*(int *)(in_ECX + 0x78) + 8);
          *(int *)(local_2c + 8) = *(int *)(local_2c + 8) + 1;
          if (((*pbVar3 & 1) != 0) && ((*pbVar3 & 4) == 0)) {
            iVar5 = FUN_00525530(pbVar3 + 7);
            *(int *)(iVar5 + 8) = *(int *)(iVar5 + 8) + 2;
            *(int *)(local_2c + 8) = *(int *)(local_2c + 8) + -1;
            if (*(int *)(local_2c + 8) == 0) {
              FUN_00525340();
            }
            piVar2 = (int *)(iVar5 + 8);
            *piVar2 = *piVar2 + -1;
            local_2c = iVar5;
            if (*piVar2 == 0) {
              FUN_00525340();
            }
          }
          if ((*(int *)(in_ECX + 0xcc) != 0) &&
             (*(int *)(*(int *)(in_ECX + 200) + -4 + *(int *)(in_ECX + 0xcc) * 4) != 0)) {
            iVar5 = FUN_00530560(&local_2c);
            if (iVar5 == 0) {
              FUN_00531f60(&local_2c,in_ECX + 0xb0);
            }
            else {
              FUN_005268b0(in_ECX + 0xb0);
            }
          }
          *(int *)(local_2c + 8) = *(int *)(local_2c + 8) + -1;
          if (*(int *)(local_2c + 8) == 0) {
            FUN_00525340();
          }
          if (iVar9 != 0) {
            FUN_00503db0();
          }
          if (iVar7 != 0) {
            FUN_00503db0();
          }
        }
        else if ((uint)pbVar3[7] < *(uint *)(in_ECX + 0x6c)) {
          FUN_005268b0(in_ECX + 0xb0);
        }
        else {
          FUN_0052ab30();
          FUN_005268b0(in_ECX + 0xb0);
        }
        FUN_00526400();
        iVar7 = local_18;
        *(undefined1 *)(in_ECX + 0xb0) = 10;
        *(byte *)(in_ECX + 0xc6) = *(byte *)(in_ECX + 0xc6) & 0xfe;
        FUN_00533d90();
        param_2 = (uint)*(ushort *)(pbVar3 + 1) +
                  (uint)*(ushort *)(pbVar3 + 3) + iVar7 + (uint)*(ushort *)(pbVar3 + 5);
        bVar4 = true;
        if ((*pbVar3 & 4) == 0) {
          local_28 = *(uint *)(in_ECX + 0xcc);
          piVar2 = (int *)(in_ECX + 200);
          uVar8 = local_28;
          if (local_30 < local_28) {
            piVar10 = (int *)(*piVar2 + -4 + ((local_28 - local_30) + local_30) * 4);
            iVar9 = local_28 - local_30;
            iVar7 = iStack_24;
            while (iStack_24 = iVar9, iStack_24 != 0) {
              if (*piVar10 != 0) {
                FUN_00503db0();
                uVar8 = local_28;
              }
              piVar10 = piVar10 + -1;
              iVar7 = iStack_24 + -1;
              iVar9 = iVar7;
            }
            iStack_24 = iVar7;
            if (local_30 < *(uint *)(in_ECX + 0xd0) >> 1) {
              FUN_005b5ef0(piVar2,local_30);
              uVar8 = local_28;
            }
          }
          else if (*(uint *)(in_ECX + 0xd0) <= local_30) {
            FUN_005b5ef0(piVar2,(local_30 >> 2) + local_30);
            uVar8 = local_28;
          }
          *(uint *)(in_ECX + 0xcc) = local_30;
          if (uVar8 < local_30) {
            puVar6 = (undefined4 *)(*piVar2 + uVar8 * 4);
            for (iVar7 = local_30 - uVar8; iVar7 != 0; iVar7 = iVar7 + -1) {
              if (puVar6 != (undefined4 *)0x0) {
                *puVar6 = 0;
              }
              puVar6 = puVar6 + 1;
            }
          }
        }
        else {
          auStack_10[0] = 0;
          if (((*pbVar3 & 1) == 0) || ((*pbVar3 & 4) == 0)) {
            uVar8 = 0xffffffff;
          }
          else {
            uVar8 = (uint)pbVar3[7];
          }
          if (*(uint *)(in_ECX + 0x6c) <= uVar8) {
            FUN_0052ab30();
          }
          FUN_005268b0(auStack_10);
          FUN_00526bc0();
        }
      }
      if ((*pbVar3 & 2) != 0) {
        *(byte *)(in_ECX + 0xc6) = *(byte *)(in_ECX + 0xc6) | 1;
        FUN_00533d90();
        *(byte *)(in_ECX + 0xc6) = *(byte *)(in_ECX + 0xc6) & 0xfe;
      }
      local_20 = local_20 + -1;
    } while (0 < local_20);
  } while (bVar4);
  return *(int *)(*(int *)(param_1 + 8) + 0xc);
}



============================================================
DISASSEMBLY
============================================================
00537660 : SUB ESP,0x34
00537663 : PUSH EBX
00537664 : PUSH EBP
00537665 : PUSH ESI
00537666 : PUSH EDI
00537667 : MOV EDI,ECX
00537669 : LEA ESP,[ESP]
00537670 : CMP byte ptr [EDI + 0xb0],0xa
00537677 : MOV byte ptr [ESP + 0x13],0x0
0053767c : JZ 0x00537b20
00537682 : MOV EAX,dword ptr [ESP + 0x50]
00537686 : MOV EAX,dword ptr [EAX]
00537688 : MOV dword ptr [ESP + 0x24],EAX
0053768c : TEST EAX,EAX
0053768e : JLE 0x00537aea
00537694 : CMP byte ptr [ESP + 0x13],0x0
00537699 : JNZ 0x00537670
0053769b : MOV EBX,dword ptr [EDI + 0xa8]
005376a1 : MOV EDX,dword ptr [EDI + 0xa4]
005376a7 : LEA EBP,[EDI + 0xa4]
005376ad : LEA ECX,[EBX + EBX*0x2]
005376b0 : MOV ESI,dword ptr [EDX + ECX*0x4 + -0xc]
005376b4 : LEA EAX,[EDX + ECX*0x4 + -0xc]
005376b8 : MOV ECX,dword ptr [EAX + 0x4]
005376bb : MOV EDX,dword ptr [EAX + 0x8]
005376be : MOV EAX,dword ptr [EBP + 0x4]
005376c1 : DEC EBX
005376c2 : MOV dword ptr [ESP + 0x2c],ECX
005376c6 : MOV dword ptr [ESP + 0x30],EDX
005376ca : MOV dword ptr [ESP + 0x1c],EAX
005376ce : CMP EBX,EAX
005376d0 : JNC 0x005376de
005376d2 : MOV ECX,dword ptr [EBP + 0x8]
005376d5 : SHR ECX,0x1
005376d7 : CMP EBX,ECX
005376d9 : JNC 0x005376f7
005376db : PUSH EBX
005376dc : JMP 0x005376eb
005376de : CMP EBX,dword ptr [EBP + 0x8]
005376e1 : JC 0x005376f7
005376e3 : MOV EAX,EBX
005376e5 : SHR EAX,0x2
005376e8 : ADD EAX,EBX
005376ea : PUSH EAX
005376eb : PUSH EBP
005376ec : MOV ECX,EBP
005376ee : CALL 0x005deae0
005376f3 : MOV EAX,dword ptr [ESP + 0x1c]
005376f7 : MOV dword ptr [EBP + 0x4],EBX
005376fa : CMP EBX,EAX
005376fc : JBE 0x00537723
005376fe : SUB EBX,EAX
00537700 : MOV EDX,dword ptr [EBP]
00537703 : LEA ECX,[EAX + EAX*0x2]
00537706 : LEA ECX,[EDX + ECX*0x4]
00537709 : JZ 0x00537723
0053770b : JMP 0x00537710
00537710 : TEST ECX,ECX
00537712 : JZ 0x0053771b
00537714 : MOV dword ptr [ECX + 0x8],0x0
0053771b : ADD ECX,0xc
0053771e : SUB EBX,0x1
00537721 : JNZ 0x00537710
00537723 : MOV EAX,dword ptr [ESP + 0x50]
00537727 : DEC dword ptr [EAX]
00537729 : MOV EAX,dword ptr [EDI + 0x8]
0053772c : SUB EAX,dword ptr [EDI + 0xc]
0053772f : MOV ECX,dword ptr [EDI + 0x1c]
00537732 : LEA EBP,[EDI + 0x8]
00537735 : DEC ECX
00537736 : SHL ECX,0x5
00537739 : SAR EAX,0x4
0053773c : ADD EAX,ECX
0053773e : MOV ECX,dword ptr [ESP + 0x30]
00537742 : CMP EAX,ECX
00537744 : JBE 0x00537770
00537746 : SUB EAX,ECX
00537748 : MOV EBX,EAX
0053774a : JZ 0x00537770
0053774c : LEA ESP,[ESP]
00537750 : MOV ECX,dword ptr [EBP]
00537753 : CALL 0x00526bc0
00537758 : ADD dword ptr [EBP],-0x10
0053775c : MOV EAX,dword ptr [EBP]
0053775f : CMP EAX,dword ptr [EBP + 0x4]
00537762 : JNC 0x0053776b
00537764 : MOV ECX,EBP
00537766 : CALL 0x00504f30
0053776b : SUB EBX,0x1
0053776e : JNZ 0x00537750
00537770 : MOV AL,byte ptr [ESI]
00537772 : TEST AL,0x1
00537774 : JZ 0x00537a73
0053777a : XOR EBP,EBP
0053777c : MOV dword ptr [ESP + 0x14],EBP
00537780 : TEST AL,0x4
00537782 : JZ 0x005377d1
00537784 : MOVZX ECX,byte ptr [ESI + 0x7]
00537788 : MOV EAX,dword ptr [EDI + 0x6c]
0053778b : CMP ECX,EAX
0053778d : JC 0x005377b5
0053778f : PUSH EAX
00537790 : PUSH ECX
00537791 : PUSH 0xb8b254
00537796 : PUSH EDI
00537797 : CALL 0x0052ab30
0053779c : ADD ESP,0x10
0053779f : LEA ECX,[EDI + 0xb0]
005377a5 : LEA EAX,[EDI + 0x28]
005377a8 : PUSH ECX
005377a9 : MOV ECX,EAX
005377ab : CALL 0x005268b0
005377b0 : JMP 0x00537908
005377b5 : SUB EAX,ECX
005377b7 : DEC EAX
005377b8 : SHL EAX,0x4
005377bb : ADD EAX,dword ptr [EDI + 0x68]
005377be : LEA ECX,[EDI + 0xb0]
005377c4 : PUSH ECX
005377c5 : MOV ECX,EAX
005377c7 : CALL 0x005268b0
005377cc : JMP 0x00537908
005377d1 : MOV EAX,dword ptr [EDI + 0xcc]
005377d7 : PUSH 0x0
005377d9 : MOV ECX,EDI
005377db : MOV dword ptr [ESP + 0x18],EAX
005377df : CALL 0x0052a630
005377e4 : MOV EBP,EAX
005377e6 : TEST EBP,EBP
005377e8 : JZ 0x005377f7
005377ea : MOV ECX,dword ptr [EBP + 0x8]
005377ed : INC ECX
005377ee : AND ECX,0x8fffffff
005377f4 : MOV dword ptr [EBP + 0x8],ECX
005377f7 : MOV ECX,EDI
005377f9 : CALL 0x00531000
005377fe : MOV EBX,EAX
00537800 : MOV dword ptr [ESP + 0x4c],EBX
00537804 : TEST EBX,EBX
00537806 : JZ 0x00537815
00537808 : MOV EDX,dword ptr [EBX + 0x8]
0053780b : INC EDX
0053780c : AND EDX,0x8fffffff
00537812 : MOV dword ptr [EBX + 0x8],EDX
00537815 : TEST EBP,EBP
00537817 : JZ 0x00537825
00537819 : MOV EAX,dword ptr [EBP + 0x8]
0053781c : INC EAX
0053781d : AND EAX,0x8fffffff
00537822 : MOV dword ptr [EBP + 0x8],EAX
00537825 : MOV ECX,dword ptr [EBX + 0x14]
00537828 : TEST ECX,ECX
0053782a : JZ 0x00537831
0053782c : CALL 0x00503db0
00537831 : MOV dword ptr [EBX + 0x14],EBP
00537834 : MOV EAX,dword ptr [EDI + 0x78]
00537837 : MOV EAX,dword ptr [EAX + 0x8]
0053783a : MOV dword ptr [ESP + 0x18],EAX
0053783e : INC dword ptr [EAX + 0x8]
00537841 : MOV AL,byte ptr [ESI]
00537843 : TEST AL,0x1
00537845 : JZ 0x0053788e
00537847 : TEST AL,0x4
00537849 : JNZ 0x0053788e
0053784b : MOV ECX,dword ptr [EDI + 0x78]
0053784e : LEA EAX,[ESI + 0x7]
00537851 : PUSH EAX
00537852 : ADD ECX,0x254
00537858 : CALL 0x00525530
0053785d : MOV EBX,EAX
0053785f : ADD dword ptr [EBX + 0x8],0x2
00537863 : MOV EAX,dword ptr [ESP + 0x18]
00537867 : DEC dword ptr [EAX + 0x8]
0053786a : MOV ECX,EAX
0053786c : ADD EAX,0x8
0053786f : CMP dword ptr [EAX],0x0
00537872 : JNZ 0x00537879
00537874 : CALL 0x00525340
00537879 : MOV dword ptr [ESP + 0x18],EBX
0053787d : ADD dword ptr [EBX + 0x8],-0x1
00537881 : JNZ 0x0053788a
00537883 : MOV ECX,EBX
00537885 : CALL 0x00525340
0053788a : MOV EBX,dword ptr [ESP + 0x4c]
0053788e : MOV EAX,dword ptr [EDI + 0xcc]
00537894 : TEST EAX,EAX
00537896 : JZ 0x005378d8
00537898 : MOV ECX,dword ptr [EDI + 0xc8]
0053789e : CMP dword ptr [ECX + EAX*0x4 + -0x4],0x0
005378a3 : JZ 0x005378d8
005378a5 : LEA EDX,[ESP + 0x18]
005378a9 : PUSH EDX
005378aa : MOV ECX,EDI
005378ac : CALL 0x00530560
005378b1 : TEST EAX,EAX
005378b3 : JNZ 0x005378ca
005378b5 : LEA EAX,[EDI + 0xb0]
005378bb : PUSH EAX
005378bc : LEA EAX,[ESP + 0x1c]
005378c0 : PUSH EAX
005378c1 : MOV ECX,EDI
005378c3 : CALL 0x00531f60
005378c8 : JMP 0x005378d8
005378ca : LEA ECX,[EDI + 0xb0]
005378d0 : PUSH ECX
005378d1 : MOV ECX,EAX
005378d3 : CALL 0x005268b0
005378d8 : MOV EAX,dword ptr [ESP + 0x18]
005378dc : DEC dword ptr [EAX + 0x8]
005378df : MOV ECX,EAX
005378e1 : ADD EAX,0x8
005378e4 : CMP dword ptr [EAX],0x0
005378e7 : JNZ 0x005378ee
005378e9 : CALL 0x00525340
005378ee : TEST EBX,EBX
005378f0 : JZ 0x005378f9
005378f2 : MOV ECX,EBX
005378f4 : CALL 0x00503db0
005378f9 : TEST EBP,EBP
005378fb : JZ 0x00537904
005378fd : MOV ECX,EBP
005378ff : CALL 0x00503db0
00537904 : MOV EBP,dword ptr [ESP + 0x14]
00537908 : LEA EBX,[EDI + 0xb0]
0053790e : MOV ECX,EBX
00537910 : CALL 0x00526400
00537915 : MOV ECX,dword ptr [ESP + 0x5c]
00537919 : MOV EDX,dword ptr [ESP + 0x58]
0053791d : MOV EAX,dword ptr [ESP + 0x54]
00537921 : PUSH ECX
00537922 : MOV byte ptr [EBX],0xa
00537925 : AND byte ptr [EDI + 0xc6],0xfe
0053792c : MOVZX ECX,byte ptr [ESI + 0x4]
00537930 : MOV EBX,dword ptr [ESP + 0x30]
00537934 : PUSH EDX
00537935 : MOVZX EDX,byte ptr [ESI + 0x3]
00537939 : PUSH EAX
0053793a : MOVZX EAX,byte ptr [ESI + 0x2]
0053793e : SHL ECX,0x8
00537941 : OR ECX,EDX
00537943 : PUSH ECX
00537944 : MOVZX ECX,byte ptr [ESI + 0x1]
00537948 : SHL EAX,0x8
0053794b : OR EAX,ECX
0053794d : MOV ECX,dword ptr [ESP + 0x58]
00537951 : ADD EAX,EBX
00537953 : PUSH EAX
00537954 : PUSH EDI
00537955 : CALL 0x00533d90
0053795a : MOVZX EDX,byte ptr [ESI + 0x6]
0053795e : MOVZX EAX,byte ptr [ESI + 0x5]
00537962 : MOVZX ECX,byte ptr [ESI + 0x4]
00537966 : SHL EDX,0x8
00537969 : OR EDX,EAX
0053796b : MOVZX EAX,byte ptr [ESI + 0x3]
0053796f : SHL ECX,0x8
00537972 : OR ECX,EAX
00537974 : MOVZX EAX,byte ptr [ESI + 0x2]
00537978 : ADD ECX,EBX
0053797a : MOVZX EBX,byte ptr [ESI + 0x1]
0053797e : SHL EAX,0x8
00537981 : OR EAX,EBX
00537983 : ADD ECX,EDX
00537985 : ADD EAX,ECX
00537987 : TEST byte ptr [ESI],0x4
0053798a : MOV dword ptr [ESP + 0x4c],EAX
0053798e : MOV byte ptr [ESP + 0x13],0x1
00537993 : JZ 0x005379ec
00537995 : MOV AL,byte ptr [ESI]
00537997 : MOV byte ptr [ESP + 0x34],0x0
0053799c : TEST AL,0x1
0053799e : JZ 0x005379aa
005379a0 : TEST AL,0x4
005379a2 : JZ 0x005379aa
005379a4 : MOVZX ECX,byte ptr [ESI + 0x7]
005379a8 : JMP 0x005379ad
005379aa : OR ECX,0xffffffff
005379ad : MOV EAX,dword ptr [EDI + 0x6c]
005379b0 : CMP ECX,EAX
005379b2 : JC 0x005379c9
005379b4 : PUSH EAX
005379b5 : PUSH ECX
005379b6 : PUSH 0xb8b254
005379bb : PUSH EDI
005379bc : CALL 0x0052ab30
005379c1 : ADD ESP,0x10
005379c4 : LEA EAX,[EDI + 0x28]
005379c7 : JMP 0x005379d2
005379c9 : SUB EAX,ECX
005379cb : DEC EAX
005379cc : SHL EAX,0x4
005379cf : ADD EAX,dword ptr [EDI + 0x68]
005379d2 : LEA ECX,[ESP + 0x34]
005379d6 : PUSH ECX
005379d7 : MOV ECX,EAX
005379d9 : CALL 0x005268b0
005379de : LEA ECX,[ESP + 0x34]
005379e2 : CALL 0x00526bc0
005379e7 : JMP 0x00537a73
005379ec : MOV EDX,dword ptr [EDI + 0xcc]
005379f2 : LEA EBX,[EDI + 0xc8]
005379f8 : MOV dword ptr [ESP + 0x1c],EDX
005379fc : CMP EBP,EDX
005379fe : JNC 0x00537afe
00537a04 : MOV EAX,EDX
00537a06 : SUB EAX,EBP
00537a08 : LEA ECX,[EAX + EBP*0x1]
00537a0b : MOV EBP,dword ptr [EBX]
00537a0d : LEA EBP,[EBP + ECX*0x4 + -0x4]
00537a11 : JZ 0x00537a31
00537a13 : MOV dword ptr [ESP + 0x20],EAX
00537a17 : MOV ECX,dword ptr [EBP]
00537a1a : TEST ECX,ECX
00537a1c : JZ 0x00537a27
00537a1e : CALL 0x00503db0
00537a23 : MOV EDX,dword ptr [ESP + 0x1c]
00537a27 : SUB EBP,0x4
00537a2a : SUB dword ptr [ESP + 0x20],0x1
00537a2f : JNZ 0x00537a17
00537a31 : MOV EAX,dword ptr [EBX + 0x8]
00537a34 : SHR EAX,0x1
00537a36 : CMP dword ptr [ESP + 0x14],EAX
00537a3a : JNC 0x00537a4d
00537a3c : MOV ECX,dword ptr [ESP + 0x14]
00537a40 : PUSH ECX
00537a41 : PUSH EBX
00537a42 : MOV ECX,EBX
00537a44 : CALL 0x005b5ef0
00537a49 : MOV EDX,dword ptr [ESP + 0x1c]
00537a4d : MOV EBP,dword ptr [ESP + 0x14]
00537a51 : MOV dword ptr [EBX + 0x4],EBP
00537a54 : CMP EBP,EDX
00537a56 : JBE 0x00537a73
00537a58 : SUB EBP,EDX
00537a5a : MOV EAX,dword ptr [EBX]
00537a5c : LEA EAX,[EAX + EDX*0x4]
00537a5f : JZ 0x00537a73
00537a61 : TEST EAX,EAX
00537a63 : JZ 0x00537a6b
00537a65 : MOV dword ptr [EAX],0x0
00537a6b : ADD EAX,0x4
00537a6e : SUB EBP,0x1
00537a71 : JNZ 0x00537a61
00537a73 : TEST byte ptr [ESI],0x2
00537a76 : JZ 0x00537ace
00537a78 : MOVZX ECX,byte ptr [ESI + 0x4]
00537a7c : MOVZX EDX,byte ptr [ESI + 0x3]
00537a80 : MOVZX EAX,byte ptr [ESI + 0x2]
00537a84 : SHL ECX,0x8
00537a87 : OR ECX,EDX
00537a89 : MOVZX EDX,byte ptr [ESI + 0x1]
00537a8d : ADD ECX,dword ptr [ESP + 0x2c]
00537a91 : OR byte ptr [EDI + 0xc6],0x1
00537a98 : SHL EAX,0x8
00537a9b : OR EAX,EDX
00537a9d : MOV EDX,dword ptr [ESP + 0x58]
00537aa1 : ADD EAX,ECX
00537aa3 : MOV ECX,dword ptr [ESP + 0x5c]
00537aa7 : PUSH ECX
00537aa8 : MOV ECX,dword ptr [ESP + 0x58]
00537aac : PUSH EDX
00537aad : MOVZX EDX,byte ptr [ESI + 0x6]
00537ab1 : PUSH ECX
00537ab2 : MOVZX ECX,byte ptr [ESI + 0x5]
00537ab6 : SHL EDX,0x8
00537ab9 : OR EDX,ECX
00537abb : MOV ECX,dword ptr [ESP + 0x54]
00537abf : PUSH EDX
00537ac0 : PUSH EAX
00537ac1 : PUSH EDI
00537ac2 : CALL 0x00533d90
00537ac7 : AND byte ptr [EDI + 0xc6],0xfe
00537ace : MOV EAX,dword ptr [ESP + 0x24]
00537ad2 : DEC EAX
00537ad3 : MOV dword ptr [ESP + 0x24],EAX
00537ad7 : TEST EAX,EAX
00537ad9 : JG 0x00537694
00537adf : CMP byte ptr [ESP + 0x13],0x0
00537ae4 : JNZ 0x00537670
00537aea : MOV EDX,dword ptr [ESP + 0x48]
00537aee : MOV EAX,dword ptr [EDX + 0x8]
00537af1 : MOV EAX,dword ptr [EAX + 0xc]
00537af4 : POP EDI
00537af5 : POP ESI
00537af6 : POP EBP
00537af7 : POP EBX
00537af8 : ADD ESP,0x34
00537afb : RET 0x18
00537afe : CMP EBP,dword ptr [EBX + 0x8]
00537b01 : JC 0x00537a51
00537b07 : MOV EDX,EBP
00537b09 : SHR EDX,0x2
00537b0c : ADD EDX,EBP
00537b0e : PUSH EDX
00537b0f : PUSH EBX
00537b10 : MOV ECX,EBX
00537b12 : CALL 0x005b5ef0
00537b17 : MOV EDX,dword ptr [ESP + 0x1c]
00537b1b : JMP 0x00537a51
00537b20 : MOV EAX,dword ptr [ESP + 0x4c]
00537b24 : POP EDI
00537b25 : POP ESI
00537b26 : POP EBP
00537b27 : POP EBX
00537b28 : ADD ESP,0x34
00537b2b : RET 0x18

PROGRAM  : Maestia.exe
FUNCTION : FUN_00855790
ENTRY    : 00855790
BODY     : [[00855790, 00855aed]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00855790(int param_1)

{
  int iVar1;
  int *piVar2;
  DWORD DVar3;
  float *pfVar4;
  int *in_ECX;
  int extraout_ECX;
  float fVar5;
  undefined1 auStack_98 [4];
  int local_94;
  int local_90;
  int local_8c;
  undefined4 local_88;
  int local_84;
  undefined4 local_80;
  float local_7c;
  float local_78;
  float local_74;
  float local_70;
  undefined4 local_6c;
  undefined4 local_68;
  undefined4 local_64;
  undefined4 local_60;
  undefined4 local_5c;
  int local_58;
  undefined4 local_54;
  int local_50;
  undefined4 local_4c;
  undefined4 local_48 [17];
  
  iVar1 = in_ECX[0x121];
  local_7c = 0.0;
  local_78 = 0.0;
  local_74 = 0.0;
  local_94 = 0;
  local_90 = 0;
  local_60 = 0;
  local_5c = 0;
  DVar3 = timeGetTime();
  in_ECX[0x121] = DVar3;
  local_70 = (float)(int)(DVar3 - iVar1);
  if ((int)(DVar3 - iVar1) < 0) {
    local_70 = local_70 + 4.2949673e+09;
  }
  local_70 = local_70 * (float)in_ECX[0x125];
  fVar5 = local_70;
  if (4.0 < local_70) {
    fVar5 = 4.0;
  }
  if (in_ECX == *(int **)(DAT_00da93ec + 0xac)) {
    if ((*(char *)(DAT_00da93ec + 0x21a) == '\0') || (*(int *)(DAT_017248cc + 0x20) == 0)) {
      FUN_007f1540(fVar5 * 0.017453292);
      piVar2 = *(int **)(extraout_ECX + 0x94);
      pfVar4 = (float *)(**(code **)(*piVar2 + 0x14))();
      local_7c = (float)piVar2[0x5c] - *pfVar4;
      local_78 = (float)piVar2[0x5d] - pfVar4[1];
      local_74 = (float)piVar2[0x5e] - pfVar4[2];
      D3DXVec3Normalize(&local_7c,&local_7c);
      in_ECX[0xee] = (int)local_7c;
      local_94 = in_ECX[0xee];
      in_ECX[0xef] = (int)local_74;
      local_90 = in_ECX[0xef];
    }
    else {
      local_58 = in_ECX[0xee];
      local_50 = in_ECX[0xef];
      local_48[0] = 0;
      local_8c = 0;
      local_88 = 0;
      local_84 = 0;
      local_80 = 0;
      local_54 = 0x3f800000;
      local_4c = 0x3f800000;
      local_6c = 0;
      local_68 = 0x3f800000;
      local_64 = 0;
      D3DXMatrixRotationAxis(local_48,&local_6c,fVar5 * 0.017453292);
      D3DXVec4Transform(auStack_98,&local_64,&local_54);
      local_94 = local_8c;
      local_90 = local_84;
      in_ECX[0xee] = local_8c;
      in_ECX[0xef] = local_84;
    }
  }
  else {
    FUN_00889560();
  }
  if (*(char *)((int)in_ECX + 0x1ea3) == '\0') {
    local_48[0] = 0;
    local_8c = 0;
    local_88 = 0;
    local_84 = 0;
    local_80 = 0;
    local_6c = 0;
    local_64 = 0;
    fVar5 = (float)param_1 * 0.017453292;
    local_58 = local_94;
    local_54 = 0x3f800000;
    local_50 = local_90;
    local_4c = 0x3f800000;
    local_68 = 0x3f800000;
    D3DXMatrixRotationAxis(local_48,&local_6c,fVar5);
    D3DXVec4Transform(auStack_98,&local_64,&local_54);
    local_78 = fVar5;
    FUN_007cc680();
    if ((((*(char *)((int)in_ECX + 0x1ea3) == '\0') && ((char)in_ECX[0x7a8] == '\0')) &&
        (*(char *)((int)in_ECX + 0x1ea1) == '\0')) && (*(char *)((int)in_ECX + 0x1ea2) == '\0')) {
      (**(code **)(*in_ECX + 0x188))(0xc,1,0,0,0,0x3f800000);
      (**(code **)(*in_ECX + 0x254))(1,in_ECX + 1,0);
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00855790 : PUSH EBP
00855791 : MOV EBP,ESP
00855793 : AND ESP,0xfffffff8
00855796 : SUB ESP,0x90
0085579c : XORPS XMM0,XMM0
0085579f : PUSH ESI
008557a0 : PUSH EDI
008557a1 : MOV EDI,ECX
008557a3 : MOV ESI,dword ptr [EDI + 0x484]
008557a9 : MOVSS dword ptr [ESP + 0x24],XMM0
008557af : MOVSS dword ptr [ESP + 0x28],XMM0
008557b5 : MOVSS dword ptr [ESP + 0x2c],XMM0
008557bb : MOVSS dword ptr [ESP + 0xc],XMM0
008557c1 : MOVSS dword ptr [ESP + 0x10],XMM0
008557c7 : MOVSS dword ptr [ESP + 0x40],XMM0
008557cd : MOVSS dword ptr [ESP + 0x44],XMM0
008557d3 : CALL dword ptr [0x00b85598]
008557d9 : MOV dword ptr [EDI + 0x484],EAX
008557df : SUB EAX,ESI
008557e1 : MOV dword ptr [ESP + 0x30],EAX
008557e5 : FILD dword ptr [ESP + 0x30]
008557e9 : TEST EAX,EAX
008557eb : JGE 0x008557f3
008557ed : FADD float ptr [0x00cdf0e0]
008557f3 : FMUL float ptr [EDI + 0x494]
008557f9 : FST float ptr [ESP + 0x30]
008557fd : FLD float ptr [0x00cdf21c]
00855803 : FXCH
00855805 : FCOMIP ST0,ST1
00855807 : FSTP ST0
00855809 : JBE 0x00855815
0085580b : MOVSS XMM1,dword ptr [0x00cdf21c]
00855813 : JMP 0x0085581b
00855815 : MOVSS XMM1,dword ptr [ESP + 0x30]
0085581b : MOV EAX,[0x00da93ec]
00855820 : MOVSS XMM2,dword ptr [0x00c10fc4]
00855828 : MOVSS XMM3,dword ptr [0x00cdf170]
00855830 : CMP EDI,dword ptr [EAX + 0xac]
00855836 : JNZ 0x008559b2
0085583c : CMP byte ptr [EAX + 0x21a],0x0
00855843 : JZ 0x00855911
00855849 : MOV EAX,[0x017248cc]
0085584e : CMP dword ptr [EAX + 0x20],0x0
00855852 : JZ 0x00855911
00855858 : XORPS XMM0,XMM0
0085585b : MOVSS XMM4,dword ptr [EDI + 0x3b8]
00855863 : PUSH ECX
00855864 : MULSS XMM1,XMM3
00855868 : MOVSS dword ptr [ESP],XMM1
0085586d : LEA ECX,[ESP + 0x38]
00855871 : PUSH ECX
00855872 : LEA EDX,[ESP + 0x60]
00855876 : MOVSS dword ptr [ESP + 0x50],XMM4
0085587c : MOVSS XMM4,dword ptr [EDI + 0x3bc]
00855884 : PUSH EDX
00855885 : MOVSS dword ptr [ESP + 0x64],XMM0
0085588b : MOVSS dword ptr [ESP + 0x20],XMM0
00855891 : MOVSS dword ptr [ESP + 0x24],XMM0
00855897 : MOVSS dword ptr [ESP + 0x28],XMM0
0085589d : MOVSS dword ptr [ESP + 0x2c],XMM0
008558a3 : MOVSS dword ptr [ESP + 0x58],XMM2
008558a9 : MOVSS dword ptr [ESP + 0x5c],XMM4
008558af : MOVSS dword ptr [ESP + 0x60],XMM2
008558b5 : MOVSS dword ptr [ESP + 0x40],XMM0
008558bb : MOVSS dword ptr [ESP + 0x44],XMM2
008558c1 : MOVSS dword ptr [ESP + 0x48],XMM0
008558c7 : CALL 0x004ff746
008558cc : LEA EAX,[ESP + 0x58]
008558d0 : PUSH EAX
008558d1 : LEA ECX,[ESP + 0x4c]
008558d5 : PUSH ECX
008558d6 : LEA EDX,[ESP + 0x1c]
008558da : PUSH EDX
008558db : CALL 0x004ff74c
008558e0 : MOVSS XMM0,dword ptr [ESP + 0x14]
008558e6 : MOVSS dword ptr [ESP + 0xc],XMM0
008558ec : MOVSS XMM0,dword ptr [ESP + 0x1c]
008558f2 : MOV EAX,dword ptr [ESP + 0xc]
008558f6 : MOVSS dword ptr [ESP + 0x10],XMM0
008558fc : MOV ECX,dword ptr [ESP + 0x10]
00855900 : MOV dword ptr [EDI + 0x3b8],EAX
00855906 : MOV dword ptr [EDI + 0x3bc],ECX
0085590c : JMP 0x008559bd
00855911 : MOV ECX,dword ptr [0x0172491c]
00855917 : MOV EAX,dword ptr [ECX + 0x94]
0085591d : PUSH ECX
0085591e : MULSS XMM1,XMM3
00855922 : MOVSS dword ptr [ESP],XMM1
00855927 : CALL 0x007f1540
0085592c : MOV ESI,dword ptr [ECX + 0x94]
00855932 : MOV EDX,dword ptr [ESI]
00855934 : MOV EAX,dword ptr [EDX + 0x14]
00855937 : MOV ECX,ESI
00855939 : CALL EAX
0085593b : MOVSS XMM0,dword ptr [ESI + 0x170]
00855943 : MOVSS XMM1,dword ptr [ESI + 0x174]
0085594b : MOVSS XMM2,dword ptr [ESI + 0x178]
00855953 : SUBSS XMM0,dword ptr [EAX]
00855957 : SUBSS XMM1,dword ptr [EAX + 0x4]
0085595c : SUBSS XMM2,dword ptr [EAX + 0x8]
00855961 : LEA ECX,[ESP + 0x24]
00855965 : PUSH ECX
00855966 : MOV EDX,ECX
00855968 : PUSH EDX
00855969 : MOVSS dword ptr [ESP + 0x2c],XMM0
0085596f : MOVSS dword ptr [ESP + 0x30],XMM1
00855975 : MOVSS dword ptr [ESP + 0x34],XMM2
0085597b : CALL 0x004ff722
00855980 : MOVSS XMM0,dword ptr [ESP + 0x24]
00855986 : MOVSS dword ptr [EDI + 0x3b8],XMM0
0085598e : MOVSS XMM0,dword ptr [ESP + 0x2c]
00855994 : MOV EAX,dword ptr [EDI + 0x3b8]
0085599a : MOVSS dword ptr [EDI + 0x3bc],XMM0
008559a2 : MOV ECX,dword ptr [EDI + 0x3bc]
008559a8 : MOV dword ptr [ESP + 0xc],EAX
008559ac : MOV dword ptr [ESP + 0x10],ECX
008559b0 : JMP 0x008559bd
008559b2 : LEA ESI,[ESP + 0xc]
008559b6 : MOV EAX,EDI
008559b8 : CALL 0x00889560
008559bd : CMP byte ptr [EDI + 0x1ea3],0x0
008559c4 : JNZ 0x00855ae6
008559ca : XORPS XMM0,XMM0
008559cd : MOVSS XMM1,dword ptr [ESP + 0xc]
008559d3 : MOVSS XMM2,dword ptr [ESP + 0x10]
008559d9 : MOVSS dword ptr [ESP + 0x58],XMM0
008559df : MOVSS dword ptr [ESP + 0x14],XMM0
008559e5 : MOVSS dword ptr [ESP + 0x18],XMM0
008559eb : MOVSS dword ptr [ESP + 0x1c],XMM0
008559f1 : MOVSS dword ptr [ESP + 0x20],XMM0
008559f7 : MOVSS dword ptr [ESP + 0x34],XMM0
008559fd : MOVSS dword ptr [ESP + 0x3c],XMM0
00855a03 : CVTSI2SS XMM0,dword ptr [EBP + 0x8]
00855a08 : MULSS XMM0,dword ptr [0x00cdf170]
00855a10 : PUSH ECX
00855a11 : MOVSS dword ptr [ESP],XMM0
00855a16 : LEA EDX,[ESP + 0x38]
00855a1a : PUSH EDX
00855a1b : LEA EAX,[ESP + 0x60]
00855a1f : MOVSS dword ptr [ESP + 0x50],XMM1
00855a25 : MOVSS XMM1,dword ptr [0x00c10fc4]
00855a2d : PUSH EAX
00855a2e : MOVSS dword ptr [ESP + 0x58],XMM1
00855a34 : MOVSS dword ptr [ESP + 0x5c],XMM2
00855a3a : MOVSS dword ptr [ESP + 0x60],XMM1
00855a40 : MOVSS dword ptr [ESP + 0x44],XMM1
00855a46 : CALL 0x004ff746
00855a4b : LEA ECX,[ESP + 0x58]
00855a4f : PUSH ECX
00855a50 : LEA EDX,[ESP + 0x4c]
00855a54 : PUSH EDX
00855a55 : LEA EAX,[ESP + 0x1c]
00855a59 : PUSH EAX
00855a5a : CALL 0x004ff74c
00855a5f : MOVSS XMM0,dword ptr [ESP + 0x14]
00855a65 : MOVSS XMM1,dword ptr [ESP + 0x1c]
00855a6b : MOV ESI,dword ptr [EDI + 0x3e8]
00855a71 : LEA EAX,[ESP + 0x40]
00855a75 : MOVSS dword ptr [ESP + 0x40],XMM0
00855a7b : MOVSS dword ptr [ESP + 0x44],XMM1
00855a81 : MOVSS dword ptr [ESP + 0xc],XMM0
00855a87 : MOVSS dword ptr [ESP + 0x10],XMM1
00855a8d : CALL 0x007cc680
00855a92 : CMP byte ptr [EDI + 0x1ea3],0x0
00855a99 : JNZ 0x00855ae6
00855a9b : CMP byte ptr [EDI + 0x1ea0],0x0
00855aa2 : JNZ 0x00855ae6
00855aa4 : CMP byte ptr [EDI + 0x1ea1],0x0
00855aab : JNZ 0x00855ae6
00855aad : CMP byte ptr [EDI + 0x1ea2],0x0
00855ab4 : JNZ 0x00855ae6
00855ab6 : FLD1
00855ab8 : MOV EDX,dword ptr [EDI]
00855aba : MOV EAX,dword ptr [EDX + 0x188]
00855ac0 : PUSH ECX
00855ac1 : FSTP float ptr [ESP]
00855ac4 : PUSH 0x0
00855ac6 : PUSH 0x0
00855ac8 : PUSH 0x0
00855aca : PUSH 0x1
00855acc : PUSH 0xc
00855ace : MOV ECX,EDI
00855ad0 : CALL EAX
00855ad2 : MOV EDX,dword ptr [EDI]
00855ad4 : MOV EDX,dword ptr [EDX + 0x254]
00855ada : PUSH 0x0
00855adc : LEA EAX,[EDI + 0x4]
00855adf : PUSH EAX
00855ae0 : PUSH 0x1
00855ae2 : MOV ECX,EDI
00855ae4 : CALL EDX
00855ae6 : POP EDI
00855ae7 : POP ESI
00855ae8 : MOV ESP,EBP
00855aea : POP EBP
00855aeb : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_00590d10
ENTRY    : 00590d10
BODY     : [[00590d10, 00590eaa]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00590d10(undefined4 param_1)

{
  char cVar1;
  uint uVar2;
  int iVar3;
  int *in_ECX;
  uint unaff_retaddr;
  uint uStack_8;
  byte bStack_4;
  
  (**(code **)(*in_ECX + 0x1c))(&DAT_00b8b8fc);
  uVar2 = FUN_0056abd0();
  uVar2 = uVar2 & 0xffff;
  cVar1 = FUN_0056ac00();
  uStack_8 = uVar2;
  iVar3 = FUN_0058c4d0((int *)(unaff_retaddr + 0x14),0,*(undefined4 *)(unaff_retaddr + 0x18),
                       &uStack_8,&LAB_00589b40);
  if ((((iVar3 == 0) ||
       (iVar3 = *(int *)(*(int *)(unaff_retaddr + 0x14) + -4 + iVar3 * 4),
       *(uint *)(iVar3 + 0xc) != uVar2)) || (iVar3 == 0)) || ((*(byte *)(iVar3 + 0x35) & 2) != 0)) {
    iVar3 = FUN_0058ff30(uVar2);
    *(char *)(iVar3 + 0x34) = cVar1;
    *(int **)(iVar3 + 0x30) = in_ECX;
    *(int **)(iVar3 + 0x2c) = in_ECX;
    *(int **)(iVar3 + 0x28) = in_ECX;
    *(int **)(iVar3 + 0x24) = in_ECX;
    *(int **)(iVar3 + 0x20) = in_ECX;
    *(int **)(iVar3 + 0x1c) = in_ECX;
    *(int **)(iVar3 + 0x18) = in_ECX;
    *(int **)(iVar3 + 0x14) = in_ECX;
    *(int **)(iVar3 + 0x10) = in_ECX;
    *(undefined4 *)(iVar3 + 8) = param_1;
    return;
  }
  if (cVar1 == '\x01') {
    (**(code **)(*in_ECX + 0x28))(&param_1);
    if ((unaff_retaddr & 4) != 0) {
      *(int **)(iVar3 + 0x14) = in_ECX;
    }
    if ((unaff_retaddr & 8) != 0) {
      *(int **)(iVar3 + 0x18) = in_ECX;
    }
    if ((unaff_retaddr & 0x20) != 0) {
      *(int **)(iVar3 + 0x1c) = in_ECX;
    }
    if ((char)unaff_retaddr < '\0') {
      *(int **)(iVar3 + 0x20) = in_ECX;
    }
    if ((unaff_retaddr & 1) != 0) {
      *(int **)(iVar3 + 0x24) = in_ECX;
    }
    if ((unaff_retaddr & 0x40) != 0) {
      *(int **)(iVar3 + 0x28) = in_ECX;
    }
    if ((unaff_retaddr & 0x10) != 0) {
      *(int **)(iVar3 + 0x2c) = in_ECX;
    }
    if ((unaff_retaddr & 2) != 0) {
      *(int **)(iVar3 + 0x30) = in_ECX;
    }
    return;
  }
  if (cVar1 != '\x02') {
    *(int **)(iVar3 + 0x30) = in_ECX;
    *(int **)(iVar3 + 0x2c) = in_ECX;
    *(int **)(iVar3 + 0x28) = in_ECX;
    *(int **)(iVar3 + 0x24) = in_ECX;
    *(int **)(iVar3 + 0x20) = in_ECX;
    *(int **)(iVar3 + 0x1c) = in_ECX;
    *(int **)(iVar3 + 0x18) = in_ECX;
    *(int **)(iVar3 + 0x14) = in_ECX;
    *(int **)(iVar3 + 0x10) = in_ECX;
    *(undefined4 *)(iVar3 + 8) = param_1;
    return;
  }
  if (*(char *)(iVar3 + 0x34) != '\0') {
    *(undefined1 *)(iVar3 + 0x34) = 2;
  }
  (**(code **)(*in_ECX + 0x28))(&stack0x00000000);
  if ((bStack_4 & 4) != 0) {
    *(int **)(iVar3 + 0x14) = in_ECX;
  }
  if ((bStack_4 & 8) != 0) {
    *(int **)(iVar3 + 0x18) = in_ECX;
  }
  if ((bStack_4 & 0x20) != 0) {
    *(int **)(iVar3 + 0x1c) = in_ECX;
  }
  if ((char)bStack_4 < '\0') {
    *(int **)(iVar3 + 0x20) = in_ECX;
  }
  if ((bStack_4 & 1) != 0) {
    *(int **)(iVar3 + 0x24) = in_ECX;
  }
  if ((bStack_4 & 0x40) != 0) {
    *(int **)(iVar3 + 0x28) = in_ECX;
  }
  if ((bStack_4 & 0x10) != 0) {
    *(int **)(iVar3 + 0x2c) = in_ECX;
  }
  if ((bStack_4 & 2) != 0) {
    *(int **)(iVar3 + 0x30) = in_ECX;
  }
  *(uint *)(iVar3 + 8) = unaff_retaddr;
  return;
}



============================================================
DISASSEMBLY
============================================================
00590d10 : SUB ESP,0x8
00590d13 : PUSH EBP
00590d14 : PUSH ESI
00590d15 : MOV ESI,ECX
00590d17 : MOV EAX,dword ptr [ESI]
00590d19 : MOV EDX,dword ptr [EAX + 0x1c]
00590d1c : PUSH EDI
00590d1d : PUSH 0xb8b8fc
00590d22 : CALL EDX
00590d24 : MOV ECX,ESI
00590d26 : CALL 0x0056abd0
00590d2b : MOV ECX,ESI
00590d2d : MOVZX EDI,AX
00590d30 : CALL 0x0056ac00
00590d35 : MOVZX EBP,DI
00590d38 : MOV EDI,dword ptr [ESP + 0x18]
00590d3c : PUSH 0x589b40
00590d41 : ADD EDI,0x14
00590d44 : LEA ECX,[ESP + 0x14]
00590d48 : PUSH ECX
00590d49 : MOV byte ptr [ESP + 0x17],AL
00590d4d : MOV EAX,dword ptr [EDI + 0x4]
00590d50 : PUSH EAX
00590d51 : PUSH 0x0
00590d53 : PUSH EDI
00590d54 : MOV dword ptr [ESP + 0x24],EBP
00590d58 : CALL 0x0058c4d0
00590d5d : ADD ESP,0x14
00590d60 : TEST EAX,EAX
00590d62 : JZ 0x00590d7a
00590d64 : MOV EDX,dword ptr [EDI]
00590d66 : MOV EDI,dword ptr [EDX + EAX*0x4 + -0x4]
00590d6a : DEC EAX
00590d6b : CMP dword ptr [EDI + 0xc],EBP
00590d6e : JNZ 0x00590d7a
00590d70 : TEST EDI,EDI
00590d72 : JZ 0x00590d7a
00590d74 : TEST byte ptr [EDI + 0x35],0x2
00590d78 : JZ 0x00590db6
00590d7a : MOV ECX,dword ptr [ESP + 0x18]
00590d7e : PUSH EBP
00590d7f : CALL 0x0058ff30
00590d84 : MOV CL,byte ptr [ESP + 0xf]
00590d88 : MOV EDX,dword ptr [ESP + 0x1c]
00590d8c : MOV byte ptr [EAX + 0x34],CL
00590d8f : POP EDI
00590d90 : MOV dword ptr [EAX + 0x30],ESI
00590d93 : MOV dword ptr [EAX + 0x2c],ESI
00590d96 : MOV dword ptr [EAX + 0x28],ESI
00590d99 : MOV dword ptr [EAX + 0x24],ESI
00590d9c : MOV dword ptr [EAX + 0x20],ESI
00590d9f : MOV dword ptr [EAX + 0x1c],ESI
00590da2 : MOV dword ptr [EAX + 0x18],ESI
00590da5 : MOV dword ptr [EAX + 0x14],ESI
00590da8 : MOV dword ptr [EAX + 0x10],ESI
00590dab : POP ESI
00590dac : MOV dword ptr [EAX + 0x8],EDX
00590daf : POP EBP
00590db0 : ADD ESP,0x8
00590db3 : RET 0x8
00590db6 : MOVZX EAX,byte ptr [ESP + 0xf]
00590dbb : SUB EAX,0x1
00590dbe : JZ 0x00590e58
00590dc4 : SUB EAX,0x1
00590dc7 : JZ 0x00590df4
00590dc9 : MOV EAX,dword ptr [ESP + 0x1c]
00590dcd : MOV dword ptr [EDI + 0x30],ESI
00590dd0 : MOV dword ptr [EDI + 0x2c],ESI
00590dd3 : MOV dword ptr [EDI + 0x28],ESI
00590dd6 : MOV dword ptr [EDI + 0x24],ESI
00590dd9 : MOV dword ptr [EDI + 0x20],ESI
00590ddc : MOV dword ptr [EDI + 0x1c],ESI
00590ddf : MOV dword ptr [EDI + 0x18],ESI
00590de2 : MOV dword ptr [EDI + 0x14],ESI
00590de5 : MOV dword ptr [EDI + 0x10],ESI
00590de8 : MOV dword ptr [EDI + 0x8],EAX
00590deb : POP EDI
00590dec : POP ESI
00590ded : POP EBP
00590dee : ADD ESP,0x8
00590df1 : RET 0x8
00590df4 : CMP byte ptr [EDI + 0x34],0x0
00590df8 : JZ 0x00590dfe
00590dfa : MOV byte ptr [EDI + 0x34],0x2
00590dfe : MOV EDX,dword ptr [ESI]
00590e00 : MOV EDX,dword ptr [EDX + 0x28]
00590e03 : LEA EAX,[ESP + 0x18]
00590e07 : PUSH EAX
00590e08 : MOV ECX,ESI
00590e0a : CALL EDX
00590e0c : MOV AL,byte ptr [ESP + 0x18]
00590e10 : TEST AL,0x4
00590e12 : JZ 0x00590e17
00590e14 : MOV dword ptr [EDI + 0x14],ESI
00590e17 : TEST AL,0x8
00590e19 : JZ 0x00590e1e
00590e1b : MOV dword ptr [EDI + 0x18],ESI
00590e1e : TEST AL,0x20
00590e20 : JZ 0x00590e25
00590e22 : MOV dword ptr [EDI + 0x1c],ESI
00590e25 : TEST AL,AL
00590e27 : JNS 0x00590e2c
00590e29 : MOV dword ptr [EDI + 0x20],ESI
00590e2c : TEST AL,0x1
00590e2e : JZ 0x00590e33
00590e30 : MOV dword ptr [EDI + 0x24],ESI
00590e33 : TEST AL,0x40
00590e35 : JZ 0x00590e3a
00590e37 : MOV dword ptr [EDI + 0x28],ESI
00590e3a : TEST AL,0x10
00590e3c : JZ 0x00590e41
00590e3e : MOV dword ptr [EDI + 0x2c],ESI
00590e41 : TEST AL,0x2
00590e43 : JZ 0x00590e48
00590e45 : MOV dword ptr [EDI + 0x30],ESI
00590e48 : MOV EAX,dword ptr [ESP + 0x1c]
00590e4c : MOV dword ptr [EDI + 0x8],EAX
00590e4f : POP EDI
00590e50 : POP ESI
00590e51 : POP EBP
00590e52 : ADD ESP,0x8
00590e55 : RET 0x8
00590e58 : MOV EDX,dword ptr [ESI]
00590e5a : MOV EDX,dword ptr [EDX + 0x28]
00590e5d : LEA EAX,[ESP + 0x1c]
00590e61 : PUSH EAX
00590e62 : MOV ECX,ESI
00590e64 : CALL EDX
00590e66 : MOV AL,byte ptr [ESP + 0x1c]
00590e6a : TEST AL,0x4
00590e6c : JZ 0x00590e71
00590e6e : MOV dword ptr [EDI + 0x14],ESI
00590e71 : TEST AL,0x8
00590e73 : JZ 0x00590e78
00590e75 : MOV dword ptr [EDI + 0x18],ESI
00590e78 : TEST AL,0x20
00590e7a : JZ 0x00590e7f
00590e7c : MOV dword ptr [EDI + 0x1c],ESI
00590e7f : TEST AL,AL
00590e81 : JNS 0x00590e86
00590e83 : MOV dword ptr [EDI + 0x20],ESI
00590e86 : TEST AL,0x1
00590e88 : JZ 0x00590e8d
00590e8a : MOV dword ptr [EDI + 0x24],ESI
00590e8d : TEST AL,0x40
00590e8f : JZ 0x00590e94
00590e91 : MOV dword ptr [EDI + 0x28],ESI
00590e94 : TEST AL,0x10
00590e96 : JZ 0x00590e9b
00590e98 : MOV dword ptr [EDI + 0x2c],ESI
00590e9b : TEST AL,0x2
00590e9d : JZ 0x00590ea2
00590e9f : MOV dword ptr [EDI + 0x30],ESI
00590ea2 : POP EDI
00590ea3 : POP ESI
00590ea4 : POP EBP
00590ea5 : ADD ESP,0x8
00590ea8 : RET 0x8

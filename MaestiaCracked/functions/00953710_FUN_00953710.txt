PROGRAM  : Maestia.exe
FUNCTION : FUN_00953710
ENTRY    : 00953710
BODY     : [[00953710, 0095389e]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00953710(ushort *param_1)

{
  ushort uVar1;
  int *piVar2;
  int *piVar3;
  char *pcVar4;
  uint uVar5;
  undefined4 uVar6;
  ushort *puVar7;
  ushort *puVar8;
  int iVar9;
  int *unaff_EDI;
  bool bVar10;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  uVar6 = DAT_0172491c;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b45bda;
  local_10 = ExceptionList;
  uVar5 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(char *)(DAT_00da93ec + 0x1d5) == '\0') {
    if (*param_1 == 0x40) {
      param_1 = param_1 + 1;
    }
    if (*param_1 != 0) {
      unaff_EDI[0x20] = 0;
      uVar6 = FUN_0081cbe0(uVar6);
      local_8 = 0;
      FUN_00405eb0(uVar6,0,0xffffffff);
      local_8 = 0xffffffff;
      if (7 < local_14) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      puVar7 = param_1;
      do {
        uVar1 = *puVar7;
        puVar7 = puVar7 + 1;
      } while (uVar1 != 0);
      FUN_00406360(param_1,(int)puVar7 - (int)(param_1 + 1) >> 1);
      piVar2 = (int *)unaff_EDI[0x25];
      *(undefined1 *)(unaff_EDI + 0xe) = 1;
      piVar3 = (int *)*piVar2;
      while (piVar3 != piVar2) {
        pcVar4 = (char *)piVar3[6];
        if (*pcVar4 == '\x01') {
          puVar7 = param_1;
          if (*(uint *)(pcVar4 + 0x44) < 8) {
            puVar8 = (ushort *)(pcVar4 + 0x30);
          }
          else {
            puVar8 = *(ushort **)(pcVar4 + 0x30);
          }
          do {
            uVar1 = *puVar8;
            bVar10 = uVar1 < *puVar7;
            if (uVar1 != *puVar7) {
LAB_0095382e:
              iVar9 = (1 - (uint)bVar10) - (uint)(bVar10 != 0);
              goto LAB_00953833;
            }
            if (uVar1 == 0) break;
            uVar1 = puVar8[1];
            bVar10 = uVar1 < puVar7[1];
            if (uVar1 != puVar7[1]) goto LAB_0095382e;
            puVar8 = puVar8 + 2;
            puVar7 = puVar7 + 2;
          } while (uVar1 != 0);
          iVar9 = 0;
LAB_00953833:
          if (iVar9 == 0) {
            FUN_00953590(uVar5);
            ExceptionList = local_10;
            return;
          }
        }
        FUN_00442590();
        piVar2 = (int *)unaff_EDI[0x25];
      }
      unaff_EDI[0x1d] = 0;
      unaff_EDI[0x1e] = 0;
      unaff_EDI[0x1f] = 0;
      FUN_009533e0(unaff_EDI,0,0,0);
      (**(code **)(*unaff_EDI + 0x18))(0,300);
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00953710 : PUSH EBP
00953711 : MOV EBP,ESP
00953713 : PUSH -0x1
00953715 : PUSH 0xb45bda
0095371a : MOV EAX,FS:[0x0]
00953720 : PUSH EAX
00953721 : SUB ESP,0x1c
00953724 : PUSH EBX
00953725 : PUSH ESI
00953726 : MOV EAX,[0x00d66fa0]
0095372b : XOR EAX,EBP
0095372d : PUSH EAX
0095372e : LEA EAX,[EBP + -0xc]
00953731 : MOV FS:[0x0],EAX
00953737 : MOV EBX,dword ptr [EBP + 0x8]
0095373a : MOV EAX,[0x00da93ec]
0095373f : MOV AL,byte ptr [EAX + 0x1d5]
00953745 : TEST AL,AL
00953747 : JNZ 0x0095386f
0095374d : CMP word ptr [EBX],0x40
00953751 : JNZ 0x00953756
00953753 : ADD EBX,0x2
00953756 : CMP word ptr [EBX],0x0
0095375a : JZ 0x0095386f
00953760 : MOV ECX,dword ptr [0x0172491c]
00953766 : PUSH ECX
00953767 : MOV ECX,0xc759fc
0095376c : LEA ESI,[EBP + -0x28]
0095376f : MOV dword ptr [EDI + 0x80],0x0
00953779 : CALL 0x0081cbe0
0095377e : XOR ESI,ESI
00953780 : MOV dword ptr [EBP + -0x4],ESI
00953783 : PUSH -0x1
00953785 : PUSH ESI
00953786 : PUSH EAX
00953787 : LEA ECX,[EDI + 0x3c]
0095378a : CALL 0x00405eb0
0095378f : MOV dword ptr [EBP + -0x4],0xffffffff
00953796 : CMP dword ptr [EBP + -0x10],0x8
0095379a : JC 0x009537a4
0095379c : MOV ECX,dword ptr [EBP + -0x24]
0095379f : CALL 0x006f04e0
009537a4 : XOR EDX,EDX
009537a6 : MOV EAX,EBX
009537a8 : MOV word ptr [EBP + -0x24],DX
009537ac : MOV dword ptr [EBP + -0x10],0x7
009537b3 : MOV dword ptr [EBP + -0x14],ESI
009537b6 : LEA EDX,[EAX + 0x2]
009537b9 : LEA ESP,[ESP]
009537c0 : MOV CX,word ptr [EAX]
009537c3 : ADD EAX,0x2
009537c6 : CMP CX,SI
009537c9 : JNZ 0x009537c0
009537cb : SUB EAX,EDX
009537cd : SAR EAX,0x1
009537cf : PUSH EAX
009537d0 : PUSH EBX
009537d1 : LEA ECX,[EDI + 0x58]
009537d4 : CALL 0x00406360
009537d9 : MOV EAX,dword ptr [EDI + 0x94]
009537df : MOV byte ptr [EDI + 0x38],0x1
009537e3 : MOV ESI,dword ptr [EAX]
009537e5 : MOV dword ptr [EBP + 0x8],ESI
009537e8 : CMP ESI,EAX
009537ea : JZ 0x0095384a
009537ec : LEA ESP,[ESP]
009537f0 : MOV EAX,dword ptr [ESI + 0x18]
009537f3 : CMP byte ptr [EAX],0x1
009537f6 : JNZ 0x00953837
009537f8 : CMP dword ptr [EAX + 0x44],0x8
009537fc : JC 0x00953803
009537fe : MOV EAX,dword ptr [EAX + 0x30]
00953801 : JMP 0x00953806
00953803 : ADD EAX,0x30
00953806 : MOV ECX,EBX
00953808 : MOV DX,word ptr [EAX]
0095380b : CMP DX,word ptr [ECX]
0095380e : JNZ 0x0095382e
00953810 : TEST DX,DX
00953813 : JZ 0x0095382a
00953815 : MOV DX,word ptr [EAX + 0x2]
00953819 : CMP DX,word ptr [ECX + 0x2]
0095381d : JNZ 0x0095382e
0095381f : ADD EAX,0x4
00953822 : ADD ECX,0x4
00953825 : TEST DX,DX
00953828 : JNZ 0x00953808
0095382a : XOR EAX,EAX
0095382c : JMP 0x00953833
0095382e : SBB EAX,EAX
00953830 : SBB EAX,-0x1
00953833 : TEST EAX,EAX
00953835 : JZ 0x00953882
00953837 : LEA EDX,[EBP + 0x8]
0095383a : CALL 0x00442590
0095383f : MOV ESI,dword ptr [EBP + 0x8]
00953842 : CMP ESI,dword ptr [EDI + 0x94]
00953848 : JNZ 0x009537f0
0095384a : XOR ESI,ESI
0095384c : PUSH ESI
0095384d : PUSH ESI
0095384e : PUSH ESI
0095384f : PUSH EDI
00953850 : MOV ECX,EBX
00953852 : MOV dword ptr [EDI + 0x74],ESI
00953855 : MOV dword ptr [EDI + 0x78],ESI
00953858 : MOV dword ptr [EDI + 0x7c],ESI
0095385b : CALL 0x009533e0
00953860 : MOV EAX,dword ptr [EDI]
00953862 : MOV EDX,dword ptr [EAX + 0x18]
00953865 : PUSH 0x12c
0095386a : PUSH ESI
0095386b : MOV ECX,EDI
0095386d : CALL EDX
0095386f : MOV ECX,dword ptr [EBP + -0xc]
00953872 : MOV dword ptr FS:[0x0],ECX
00953879 : POP ECX
0095387a : POP ESI
0095387b : POP EBX
0095387c : MOV ESP,EBP
0095387e : POP EBP
0095387f : RET 0x4
00953882 : MOV EAX,dword ptr [ESI + 0x18]
00953885 : MOV ESI,EDI
00953887 : CALL 0x00953590
0095388c : MOV ECX,dword ptr [EBP + -0xc]
0095388f : MOV dword ptr FS:[0x0],ECX
00953896 : POP ECX
00953897 : POP ESI
00953898 : POP EBX
00953899 : MOV ESP,EBP
0095389b : POP EBP
0095389c : RET 0x4

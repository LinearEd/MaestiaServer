PROGRAM  : Maestia.exe
FUNCTION : FUN_007b3c30
ENTRY    : 007b3c30
BODY     : [[007b3c30, 007b3dfd]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007b3c30(void)

{
  int iVar1;
  size_t _Size;
  int in_ECX;
  undefined4 *puVar2;
  int iVar3;
  undefined1 local_8c [4];
  undefined2 local_88;
  undefined4 local_78;
  uint local_74;
  int local_70;
  int local_6c;
  undefined1 local_68 [28];
  int local_4c;
  uint local_48;
  uint local_44;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b65dda;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_6c = in_ECX;
  FUN_0070d390(local_14);
  local_8 = 0;
  FUN_008036f0(DAT_017251dc,in_ECX + 0x284);
  local_70 = -1;
  if (local_44 < local_48) {
    if (local_44 + 4 < local_48) {
      _Size = 4;
    }
    else {
      _Size = local_48 - local_44;
    }
    _memcpy(&local_70,(void *)(local_4c + local_44),_Size);
    local_44 = local_44 + _Size;
    in_ECX = local_6c;
  }
  if (local_70 == 1) {
    FUN_00406460(L"Dont Use LoadPatch Version 1");
    local_8._0_1_ = 1;
    if ((int *)*DAT_00da98e8 != (int *)0x0) {
      (**(code **)(*(int *)*DAT_00da98e8 + 0x14))(L"AvaLib::AvaPatch::LoadPatch",0x44c,local_8c);
    }
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_74) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_74 = 7;
    local_78 = 0;
    local_88 = 0;
  }
  else {
    if (local_70 != 6) {
      local_8 = 0xffffffff;
      FUN_0070d710();
      goto LAB_007b3de2;
    }
    FUN_007b2a90(in_ECX,local_68);
  }
  FUN_0070d4c0();
  local_8 = 0xffffffff;
  FUN_0070d710();
  FUN_007ab550();
  iVar1 = local_6c;
  FUN_007ac460();
  if (DAT_00da9ab4 == 0) {
    local_6c = FUN_006f0760(0xa7d8c4,"",0,(DAT_01725270 >> 3 & 1) == 0);
    DAT_00da9ab4 = 0;
    if (local_6c != 0) {
      puVar2 = (undefined4 *)(local_6c + 4);
      iVar3 = 549999;
      do {
        puVar2[1] = 0;
        *puVar2 = 0;
        puVar2[4] = 0;
        puVar2[3] = 0;
        puVar2[2] = 0;
        puVar2 = puVar2 + 5;
        iVar3 = iVar3 + -1;
        DAT_00da9ab4 = local_6c;
      } while (-1 < iVar3);
    }
    local_8 = 0xffffffff;
  }
  *(undefined1 *)(iVar1 + 700) = 1;
LAB_007b3de2:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
007b3c30 : PUSH EBP
007b3c31 : MOV EBP,ESP
007b3c33 : PUSH -0x1
007b3c35 : PUSH 0xb65dda
007b3c3a : MOV EAX,FS:[0x0]
007b3c40 : PUSH EAX
007b3c41 : SUB ESP,0x7c
007b3c44 : MOV EAX,[0x00d66fa0]
007b3c49 : XOR EAX,EBP
007b3c4b : MOV dword ptr [EBP + -0x10],EAX
007b3c4e : PUSH EBX
007b3c4f : PUSH ESI
007b3c50 : PUSH EDI
007b3c51 : PUSH EAX
007b3c52 : LEA EAX,[EBP + -0xc]
007b3c55 : MOV FS:[0x0],EAX
007b3c5b : MOV EDI,ECX
007b3c5d : LEA ECX,[EBP + -0x64]
007b3c60 : MOV dword ptr [EBP + -0x68],EDI
007b3c63 : CALL 0x0070d390
007b3c68 : XOR EBX,EBX
007b3c6a : MOV dword ptr [EBP + -0x4],EBX
007b3c6d : MOV ECX,dword ptr [0x017251dc]
007b3c73 : LEA EAX,[EDI + 0x284]
007b3c79 : PUSH EAX
007b3c7a : PUSH ECX
007b3c7b : LEA ECX,[EBP + -0x64]
007b3c7e : CALL 0x008036f0
007b3c83 : MOV ESI,dword ptr [EBP + -0x40]
007b3c86 : MOV EAX,dword ptr [EBP + -0x44]
007b3c89 : MOV dword ptr [EBP + -0x6c],0xffffffff
007b3c90 : CMP ESI,EAX
007b3c92 : JNC 0x007b3cc1
007b3c94 : LEA EDX,[ESI + 0x4]
007b3c97 : CMP EDX,EAX
007b3c99 : JC 0x007b3ca1
007b3c9b : SUB EAX,ESI
007b3c9d : MOV EDI,EAX
007b3c9f : JMP 0x007b3ca6
007b3ca1 : MOV EDI,0x4
007b3ca6 : MOV EAX,dword ptr [EBP + -0x48]
007b3ca9 : PUSH EDI
007b3caa : ADD EAX,ESI
007b3cac : PUSH EAX
007b3cad : LEA ECX,[EBP + -0x6c]
007b3cb0 : PUSH ECX
007b3cb1 : CALL 0x0063ae40
007b3cb6 : ADD ESP,0xc
007b3cb9 : ADD ESI,EDI
007b3cbb : MOV dword ptr [EBP + -0x40],ESI
007b3cbe : MOV EDI,dword ptr [EBP + -0x68]
007b3cc1 : MOV EAX,dword ptr [EBP + -0x6c]
007b3cc4 : SUB EAX,0x1
007b3cc7 : JZ 0x007b3cee
007b3cc9 : SUB EAX,0x5
007b3ccc : JZ 0x007b3ce2
007b3cce : MOV dword ptr [EBP + -0x4],0xffffffff
007b3cd5 : LEA ECX,[EBP + -0x64]
007b3cd8 : CALL 0x0070d710
007b3cdd : JMP 0x007b3de2
007b3ce2 : LEA EDX,[EBP + -0x64]
007b3ce5 : PUSH EDX
007b3ce6 : PUSH EDI
007b3ce7 : CALL 0x007b2a90
007b3cec : JMP 0x007b3d4c
007b3cee : PUSH 0xc175b4
007b3cf3 : LEA ECX,[EBP + 0xffffff78]
007b3cf9 : CALL 0x00406460
007b3cfe : MOV byte ptr [EBP + -0x4],0x1
007b3d02 : MOV EAX,[0x00da98e8]
007b3d07 : MOV ECX,dword ptr [EAX]
007b3d09 : CMP ECX,EBX
007b3d0b : JZ 0x007b3d25
007b3d0d : MOV EDX,dword ptr [ECX]
007b3d0f : MOV EDX,dword ptr [EDX + 0x14]
007b3d12 : LEA EAX,[EBP + 0xffffff78]
007b3d18 : PUSH EAX
007b3d19 : PUSH 0x44c
007b3d1e : PUSH 0xc175f0
007b3d23 : CALL EDX
007b3d25 : MOV byte ptr [EBP + -0x4],BL
007b3d28 : CMP dword ptr [EBP + -0x70],0x8
007b3d2c : JC 0x007b3d39
007b3d2e : MOV ECX,dword ptr [EBP + 0xffffff7c]
007b3d34 : CALL 0x006f04e0
007b3d39 : XOR EAX,EAX
007b3d3b : MOV dword ptr [EBP + -0x70],0x7
007b3d42 : MOV dword ptr [EBP + -0x74],EBX
007b3d45 : MOV word ptr [EBP + 0xffffff7c],AX
007b3d4c : LEA ECX,[EBP + -0x64]
007b3d4f : CALL 0x0070d4c0
007b3d54 : MOV dword ptr [EBP + -0x4],0xffffffff
007b3d5b : LEA ECX,[EBP + -0x64]
007b3d5e : CALL 0x0070d710
007b3d63 : CALL 0x007ab550
007b3d68 : MOV EDI,dword ptr [EBP + -0x68]
007b3d6b : CALL 0x007ac460
007b3d70 : CMP dword ptr [0x00da9ab4],EBX
007b3d76 : JNZ 0x007b3ddb
007b3d78 : MOV ECX,dword ptr [0x01725270]
007b3d7e : SHR ECX,0x3
007b3d81 : MOV EDX,0x0
007b3d86 : AND ECX,0x1
007b3d89 : SETZ DL
007b3d8c : PUSH EDX
007b3d8d : PUSH EBX
007b3d8e : PUSH 0xbf1a4a
007b3d93 : PUSH 0xa7d8c4
007b3d98 : CALL 0x006f0760
007b3d9d : ADD ESP,0x10
007b3da0 : MOV dword ptr [EBP + -0x68],EAX
007b3da3 : MOV dword ptr [EBP + -0x4],0x2
007b3daa : CMP EAX,EBX
007b3dac : JZ 0x007b3dce
007b3dae : LEA ECX,[EAX + 0x4]
007b3db1 : MOV EDX,0x8646f
007b3db6 : MOV dword ptr [ECX + 0x4],EBX
007b3db9 : MOV dword ptr [ECX],EBX
007b3dbb : MOV dword ptr [ECX + 0x10],EBX
007b3dbe : MOV dword ptr [ECX + 0xc],EBX
007b3dc1 : MOV dword ptr [ECX + 0x8],EBX
007b3dc4 : ADD ECX,0x14
007b3dc7 : SUB EDX,0x1
007b3dca : JNS 0x007b3db6
007b3dcc : MOV EBX,EAX
007b3dce : MOV dword ptr [EBP + -0x4],0xffffffff
007b3dd5 : MOV dword ptr [0x00da9ab4],EBX
007b3ddb : MOV byte ptr [EDI + 0x2bc],0x1
007b3de2 : MOV ECX,dword ptr [EBP + -0xc]
007b3de5 : MOV dword ptr FS:[0x0],ECX
007b3dec : POP ECX
007b3ded : POP EDI
007b3dee : POP ESI
007b3def : POP EBX
007b3df0 : MOV ECX,dword ptr [EBP + -0x10]
007b3df3 : XOR ECX,EBP
007b3df5 : CALL 0x00633e6b
007b3dfa : MOV ESP,EBP
007b3dfc : POP EBP
007b3dfd : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_008b14d0
ENTRY    : 008b14d0
BODY     : [[008b14d0, 008b188c]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008b14d0(int *param_1,undefined4 param_2)

{
  wchar_t wVar1;
  uint uVar2;
  undefined4 uVar3;
  int iVar4;
  int *piVar5;
  int in_ECX;
  wchar_t *pwVar6;
  wchar_t *pwVar7;
  byte bVar8;
  wchar_t *pwVar9;
  bool bVar10;
  uint local_40;
  undefined1 local_3c [4];
  undefined2 local_38;
  undefined4 local_28;
  uint local_24;
  undefined1 local_20 [4];
  int local_1c;
  int local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b6cb1d;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_24 = 7;
  local_28 = 0;
  local_38 = 0;
  FUN_00406360(&DAT_00c4c1e0,1);
  local_8 = 0;
  uVar3 = FUN_00403dd0(param_2,uVar2);
  local_8._0_1_ = 1;
  FUN_0070cd60(local_20,uVar3,local_3c,0);
  local_8 = CONCAT31(local_8._1_3_,3);
  if (7 < local_40) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_8 = CONCAT31(local_8._1_3_,4);
  if (7 < local_24) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_24 = 7;
  uVar2 = *(uint *)(in_ECX + 0x18);
  pwVar9 = (wchar_t *)(in_ECX + 4);
  local_28 = 0;
  local_38 = 0;
  pwVar7 = pwVar9;
  if (7 < uVar2) {
    pwVar7 = *(wchar_t **)pwVar9;
  }
  pwVar6 = L"onInit";
  do {
    wVar1 = *pwVar7;
    bVar10 = (ushort)wVar1 < (ushort)*pwVar6;
    if (wVar1 != *pwVar6) {
LAB_008b15be:
      iVar4 = (1 - (uint)bVar10) - (uint)(bVar10 != 0);
      goto LAB_008b15c3;
    }
    if (wVar1 == L'\0') break;
    wVar1 = pwVar7[1];
    bVar10 = (ushort)wVar1 < (ushort)pwVar6[1];
    if (wVar1 != pwVar6[1]) goto LAB_008b15be;
    pwVar7 = pwVar7 + 2;
    pwVar6 = pwVar6 + 2;
  } while (wVar1 != L'\0');
  iVar4 = 0;
LAB_008b15c3:
  if (iVar4 == 0) {
    iVar4 = *DAT_00da9894;
    if ((iVar4 != 0) && (*(int *)(iVar4 + 0x114) != 0)) {
      (**(code **)(**(int **)(iVar4 + 0x114) + 4))
                (*(int **)(iVar4 + 0x114),"mc_eventcouponview.OnEventIndex",&DAT_00c4c1f4,
                 (char)param_1[0xe]);
    }
    iVar4 = *DAT_00da9894;
    if ((iVar4 != 0) && (*(int *)(iVar4 + 0x114) != 0)) {
      if ((uint)param_1[0x15] < 8) {
        piVar5 = param_1 + 0x10;
      }
      else {
        piVar5 = (int *)param_1[0x10];
      }
      (**(code **)(**(int **)(iVar4 + 0x114) + 4))
                (*(int **)(iVar4 + 0x114),"mc_eventcouponview.OnBanner",&DAT_00c4c218,piVar5);
    }
    FUN_008afe80();
    if (*(char *)((int)param_1 + 0x39) == '\0') {
      iVar4 = *(int *)ThreadLocalStoragePointer;
      bVar8 = (byte)((ulonglong)(*(byte *)(iVar4 + 0x18) + 1) % 3);
      *(byte *)(iVar4 + 0x18) = bVar8;
      param_1 = (int *)((uint)bVar8 * 0x2000 + 0x122cb8 + iVar4);
      if (param_1 == (int *)0x0) {
        piVar5 = (int *)0x0;
      }
      else {
        *(undefined2 *)param_1 = 0;
        *(undefined1 *)((int)param_1 + 2) = 0xca;
        *(undefined1 *)((int)param_1 + 3) = 4;
        piVar5 = param_1;
      }
      local_8 = CONCAT31((int3)((uint)local_8 >> 8),4);
      if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
        FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),4,(uint8_t *)piVar5);
      }
    }
  }
  else {
    pwVar7 = pwVar9;
    if (7 < uVar2) {
      pwVar7 = *(wchar_t **)pwVar9;
    }
    pwVar6 = L"OnClose";
    do {
      wVar1 = *pwVar7;
      bVar10 = (ushort)wVar1 < (ushort)*pwVar6;
      if (wVar1 != *pwVar6) {
LAB_008b16fb:
        iVar4 = (1 - (uint)bVar10) - (uint)(bVar10 != 0);
        goto LAB_008b1700;
      }
      if (wVar1 == L'\0') break;
      wVar1 = pwVar7[1];
      bVar10 = (ushort)wVar1 < (ushort)pwVar6[1];
      if (wVar1 != pwVar6[1]) goto LAB_008b16fb;
      pwVar7 = pwVar7 + 2;
      pwVar6 = pwVar6 + 2;
    } while (wVar1 != L'\0');
    iVar4 = 0;
LAB_008b1700:
    if (iVar4 == 0) {
      (**(code **)(*param_1 + 0x24))();
    }
    else {
      pwVar7 = pwVar9;
      if (7 < uVar2) {
        pwVar7 = *(wchar_t **)pwVar9;
      }
      pwVar6 = L"OnEnter";
      do {
        wVar1 = *pwVar7;
        bVar10 = (ushort)wVar1 < (ushort)*pwVar6;
        if (wVar1 != *pwVar6) {
LAB_008b1749:
          iVar4 = (1 - (uint)bVar10) - (uint)(bVar10 != 0);
          goto LAB_008b174e;
        }
        if (wVar1 == L'\0') break;
        wVar1 = pwVar7[1];
        bVar10 = (ushort)wVar1 < (ushort)pwVar6[1];
        if (wVar1 != pwVar6[1]) goto LAB_008b1749;
        pwVar7 = pwVar7 + 2;
        pwVar6 = pwVar6 + 2;
      } while (wVar1 != L'\0');
      iVar4 = 0;
LAB_008b174e:
      if (iVar4 == 0) {
        iVar4 = local_18 - local_1c >> 0x1f;
        if ((local_18 - local_1c) / 0x1c + iVar4 == iVar4) {
          FUN_008b0680(0);
        }
        else if (*(uint *)(local_1c + 0x18) < 8) {
          uVar3 = FUN_00634f4d(local_1c + 4);
          FUN_008b0680(uVar3);
        }
        else {
          uVar3 = FUN_00634f4d(*(undefined4 *)(local_1c + 4));
          FUN_008b0680(uVar3);
        }
      }
      else {
        if (7 < uVar2) {
          pwVar9 = *(wchar_t **)pwVar9;
        }
        pwVar7 = L"OnTooltip";
        do {
          wVar1 = *pwVar9;
          bVar10 = (ushort)wVar1 < (ushort)*pwVar7;
          if (wVar1 != *pwVar7) {
LAB_008b17f6:
            iVar4 = (1 - (uint)bVar10) - (uint)(bVar10 != 0);
            goto LAB_008b17fb;
          }
          if (wVar1 == L'\0') break;
          wVar1 = pwVar9[1];
          bVar10 = (ushort)wVar1 < (ushort)pwVar7[1];
          if (wVar1 != pwVar7[1]) goto LAB_008b17f6;
          pwVar9 = pwVar9 + 2;
          pwVar7 = pwVar7 + 2;
        } while (wVar1 != L'\0');
        iVar4 = 0;
LAB_008b17fb:
        if (iVar4 == 0) {
          iVar4 = local_18 - local_1c >> 0x1f;
          if ((local_18 - local_1c) / 0x1c + iVar4 == iVar4) {
            uVar3 = 0;
          }
          else if (*(uint *)(local_1c + 0x18) < 8) {
            uVar3 = FUN_00634f4d(local_1c + 4);
          }
          else {
            uVar3 = FUN_00634f4d(*(undefined4 *)(local_1c + 4));
          }
          FUN_008b1390(uVar3);
        }
      }
    }
  }
  local_8 = 0xffffffff;
  if (local_1c == 0) {
    ExceptionList = local_10;
    return;
  }
  FUN_00405450(param_1);
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
008b14d0 : PUSH EBP
008b14d1 : MOV EBP,ESP
008b14d3 : PUSH -0x1
008b14d5 : PUSH 0xb6cb1d
008b14da : MOV EAX,FS:[0x0]
008b14e0 : PUSH EAX
008b14e1 : SUB ESP,0x4c
008b14e4 : PUSH EBX
008b14e5 : PUSH ESI
008b14e6 : PUSH EDI
008b14e7 : MOV EAX,[0x00d66fa0]
008b14ec : XOR EAX,EBP
008b14ee : PUSH EAX
008b14ef : LEA EAX,[EBP + -0xc]
008b14f2 : MOV FS:[0x0],EAX
008b14f8 : MOV EDI,ECX
008b14fa : PUSH 0x1
008b14fc : XOR EAX,EAX
008b14fe : MOV EBX,0x7
008b1503 : XOR ESI,ESI
008b1505 : PUSH 0xc4c1e0
008b150a : LEA ECX,[EBP + -0x38]
008b150d : MOV dword ptr [EBP + -0x20],EBX
008b1510 : MOV dword ptr [EBP + -0x24],ESI
008b1513 : MOV word ptr [EBP + -0x34],AX
008b1517 : CALL 0x00406360
008b151c : MOV dword ptr [EBP + -0x4],ESI
008b151f : MOV ECX,dword ptr [EBP + 0xc]
008b1522 : PUSH ECX
008b1523 : LEA ESI,[EBP + -0x54]
008b1526 : CALL 0x00403dd0
008b152b : ADD ESP,0x4
008b152e : MOV byte ptr [EBP + -0x4],0x1
008b1532 : XOR ESI,ESI
008b1534 : PUSH ESI
008b1535 : LEA EDX,[EBP + -0x38]
008b1538 : PUSH EDX
008b1539 : PUSH EAX
008b153a : LEA EAX,[EBP + -0x1c]
008b153d : PUSH EAX
008b153e : CALL 0x0070cd60
008b1543 : ADD ESP,0x10
008b1546 : MOV byte ptr [EBP + -0x4],0x3
008b154a : CMP dword ptr [EBP + -0x3c],0x8
008b154e : JC 0x008b1558
008b1550 : MOV ECX,dword ptr [EBP + -0x50]
008b1553 : CALL 0x006f04e0
008b1558 : XOR ECX,ECX
008b155a : MOV dword ptr [EBP + -0x3c],EBX
008b155d : MOV dword ptr [EBP + -0x40],ESI
008b1560 : MOV word ptr [EBP + -0x50],CX
008b1564 : MOV byte ptr [EBP + -0x4],0x4
008b1568 : CMP dword ptr [EBP + -0x20],0x8
008b156c : JC 0x008b1576
008b156e : MOV ECX,dword ptr [EBP + -0x34]
008b1571 : CALL 0x006f04e0
008b1576 : MOV dword ptr [EBP + -0x20],EBX
008b1579 : MOV EBX,dword ptr [EDI + 0x18]
008b157c : XOR EDX,EDX
008b157e : ADD EDI,0x4
008b1581 : MOV dword ptr [EBP + -0x24],ESI
008b1584 : MOV word ptr [EBP + -0x34],DX
008b1588 : CMP EBX,0x8
008b158b : JC 0x008b1591
008b158d : MOV EAX,dword ptr [EDI]
008b158f : JMP 0x008b1593
008b1591 : MOV EAX,EDI
008b1593 : MOV ECX,0xc4c1e4
008b1598 : MOV DX,word ptr [EAX]
008b159b : CMP DX,word ptr [ECX]
008b159e : JNZ 0x008b15be
008b15a0 : CMP DX,SI
008b15a3 : JZ 0x008b15ba
008b15a5 : MOV DX,word ptr [EAX + 0x2]
008b15a9 : CMP DX,word ptr [ECX + 0x2]
008b15ad : JNZ 0x008b15be
008b15af : ADD EAX,0x4
008b15b2 : ADD ECX,0x4
008b15b5 : CMP DX,SI
008b15b8 : JNZ 0x008b1598
008b15ba : XOR EAX,EAX
008b15bc : JMP 0x008b15c3
008b15be : SBB EAX,EAX
008b15c0 : SBB EAX,-0x1
008b15c3 : CMP EAX,ESI
008b15c5 : JNZ 0x008b16c5
008b15cb : MOV EAX,[0x00da9894]
008b15d0 : MOV EAX,dword ptr [EAX]
008b15d2 : CMP EAX,ESI
008b15d4 : JZ 0x008b1603
008b15d6 : CMP dword ptr [EAX + 0x114],ESI
008b15dc : JZ 0x008b1603
008b15de : MOV EDI,dword ptr [EBP + 0x8]
008b15e1 : MOVZX EDX,byte ptr [EDI + 0x38]
008b15e5 : MOV EAX,dword ptr [EAX + 0x114]
008b15eb : MOV ECX,dword ptr [EAX]
008b15ed : PUSH EDX
008b15ee : PUSH 0xc4c1f4
008b15f3 : PUSH 0xc4c1f8
008b15f8 : PUSH EAX
008b15f9 : MOV EAX,dword ptr [ECX + 0x4]
008b15fc : CALL EAX
008b15fe : ADD ESP,0x10
008b1601 : JMP 0x008b1606
008b1603 : MOV EDI,dword ptr [EBP + 0x8]
008b1606 : MOV ECX,dword ptr [0x00da9894]
008b160c : MOV EAX,dword ptr [ECX]
008b160e : CMP EAX,ESI
008b1610 : JZ 0x008b1644
008b1612 : CMP dword ptr [EAX + 0x114],ESI
008b1618 : JZ 0x008b1644
008b161a : CMP dword ptr [EDI + 0x54],0x8
008b161e : MOV EAX,dword ptr [EAX + 0x114]
008b1624 : JC 0x008b162b
008b1626 : MOV ECX,dword ptr [EDI + 0x40]
008b1629 : JMP 0x008b162e
008b162b : LEA ECX,[EDI + 0x40]
008b162e : MOV EDX,dword ptr [EAX]
008b1630 : PUSH ECX
008b1631 : PUSH 0xc4c218
008b1636 : PUSH 0xc4c21c
008b163b : PUSH EAX
008b163c : MOV EAX,dword ptr [EDX + 0x4]
008b163f : CALL EAX
008b1641 : ADD ESP,0x10
008b1644 : MOV ECX,EDI
008b1646 : CALL 0x008afe80
008b164b : CMP byte ptr [EDI + 0x39],0x0
008b164f : JNZ 0x008b184b
008b1655 : MOV ECX,dword ptr FS:[0x2c]
008b165c : MOV ECX,dword ptr [ECX]
008b165e : MOVZX EAX,byte ptr [ECX + 0x18]
008b1662 : INC EAX
008b1663 : CDQ
008b1664 : MOV EDI,0x3
008b1669 : IDIV EDI
008b166b : MOV byte ptr [ECX + 0x18],DL
008b166e : MOVZX EDX,DL
008b1671 : SHL EDX,0xd
008b1674 : LEA EAX,[EDX + ECX*0x1 + 0x122cb8]
008b167b : MOV dword ptr [EBP + 0x8],EAX
008b167e : MOV byte ptr [EBP + -0x4],0x5
008b1682 : CMP EAX,ESI
008b1684 : JZ 0x008b1695
008b1686 : XOR ECX,ECX
008b1688 : MOV word ptr [EAX],CX
008b168b : MOV byte ptr [EAX + 0x2],0xca
008b168f : MOV byte ptr [EAX + 0x3],0x4
008b1693 : JMP 0x008b1697
008b1695 : XOR EAX,EAX
008b1697 : MOV byte ptr [EBP + -0x4],0x4
008b169b : MOV EDX,dword ptr [0x017247d4]
008b16a1 : MOV ECX,dword ptr [EDX + 0x4]
008b16a4 : CMP ECX,ESI
008b16a6 : JZ 0x008b184b
008b16ac : CMP byte ptr [EDX + 0x8],0x0
008b16b0 : JZ 0x008b184b
008b16b6 : PUSH 0x4
008b16b8 : PUSH ECX
008b16b9 : MOV EDI,EAX
008b16bb : CALL 0x00a0dd40
008b16c0 : JMP 0x008b184b
008b16c5 : CMP EBX,0x8
008b16c8 : JC 0x008b16ce
008b16ca : MOV EAX,dword ptr [EDI]
008b16cc : JMP 0x008b16d0
008b16ce : MOV EAX,EDI
008b16d0 : MOV ECX,0xc4c238
008b16d5 : MOV DX,word ptr [EAX]
008b16d8 : CMP DX,word ptr [ECX]
008b16db : JNZ 0x008b16fb
008b16dd : CMP DX,SI
008b16e0 : JZ 0x008b16f7
008b16e2 : MOV DX,word ptr [EAX + 0x2]
008b16e6 : CMP DX,word ptr [ECX + 0x2]
008b16ea : JNZ 0x008b16fb
008b16ec : ADD EAX,0x4
008b16ef : ADD ECX,0x4
008b16f2 : CMP DX,SI
008b16f5 : JNZ 0x008b16d5
008b16f7 : XOR EAX,EAX
008b16f9 : JMP 0x008b1700
008b16fb : SBB EAX,EAX
008b16fd : SBB EAX,-0x1
008b1700 : CMP EAX,ESI
008b1702 : JNZ 0x008b1713
008b1704 : MOV ECX,dword ptr [EBP + 0x8]
008b1707 : MOV EDX,dword ptr [ECX]
008b1709 : MOV EAX,dword ptr [EDX + 0x24]
008b170c : CALL EAX
008b170e : JMP 0x008b184b
008b1713 : CMP EBX,0x8
008b1716 : JC 0x008b171c
008b1718 : MOV EAX,dword ptr [EDI]
008b171a : JMP 0x008b171e
008b171c : MOV EAX,EDI
008b171e : MOV ECX,0xc4c248
008b1723 : MOV DX,word ptr [EAX]
008b1726 : CMP DX,word ptr [ECX]
008b1729 : JNZ 0x008b1749
008b172b : CMP DX,SI
008b172e : JZ 0x008b1745
008b1730 : MOV DX,word ptr [EAX + 0x2]
008b1734 : CMP DX,word ptr [ECX + 0x2]
008b1738 : JNZ 0x008b1749
008b173a : ADD EAX,0x4
008b173d : ADD ECX,0x4
008b1740 : CMP DX,SI
008b1743 : JNZ 0x008b1723
008b1745 : XOR EAX,EAX
008b1747 : JMP 0x008b174e
008b1749 : SBB EAX,EAX
008b174b : SBB EAX,-0x1
008b174e : CMP EAX,ESI
008b1750 : JNZ 0x008b17b9
008b1752 : MOV ECX,dword ptr [EBP + -0x14]
008b1755 : MOV ESI,dword ptr [EBP + -0x18]
008b1758 : SUB ECX,ESI
008b175a : MOV EAX,0x92492493
008b175f : IMUL ECX
008b1761 : ADD EDX,ECX
008b1763 : SAR EDX,0x4
008b1766 : MOV ECX,EDX
008b1768 : SHR ECX,0x1f
008b176b : ADD ECX,EDX
008b176d : JZ 0x008b17a9
008b176f : CMP dword ptr [ESI + 0x18],0x8
008b1773 : JC 0x008b178f
008b1775 : MOV ESI,dword ptr [ESI + 0x4]
008b1778 : PUSH ESI
008b1779 : CALL 0x00634f4d
008b177e : MOV ECX,dword ptr [EBP + 0x8]
008b1781 : ADD ESP,0x4
008b1784 : PUSH EAX
008b1785 : CALL 0x008b0680
008b178a : JMP 0x008b1849
008b178f : ADD ESI,0x4
008b1792 : PUSH ESI
008b1793 : CALL 0x00634f4d
008b1798 : MOV ECX,dword ptr [EBP + 0x8]
008b179b : ADD ESP,0x4
008b179e : PUSH EAX
008b179f : CALL 0x008b0680
008b17a4 : JMP 0x008b1849
008b17a9 : MOV ECX,dword ptr [EBP + 0x8]
008b17ac : XOR EAX,EAX
008b17ae : PUSH EAX
008b17af : CALL 0x008b0680
008b17b4 : JMP 0x008b1849
008b17b9 : CMP EBX,0x8
008b17bc : JC 0x008b17c2
008b17be : MOV EAX,dword ptr [EDI]
008b17c0 : JMP 0x008b17c4
008b17c2 : MOV EAX,EDI
008b17c4 : MOV ECX,0xc4c258
008b17c9 : LEA ESP,[ESP]
008b17d0 : MOV DX,word ptr [EAX]
008b17d3 : CMP DX,word ptr [ECX]
008b17d6 : JNZ 0x008b17f6
008b17d8 : CMP DX,SI
008b17db : JZ 0x008b17f2
008b17dd : MOV DX,word ptr [EAX + 0x2]
008b17e1 : CMP DX,word ptr [ECX + 0x2]
008b17e5 : JNZ 0x008b17f6
008b17e7 : ADD EAX,0x4
008b17ea : ADD ECX,0x4
008b17ed : CMP DX,SI
008b17f0 : JNZ 0x008b17d0
008b17f2 : XOR EAX,EAX
008b17f4 : JMP 0x008b17fb
008b17f6 : SBB EAX,EAX
008b17f8 : SBB EAX,-0x1
008b17fb : CMP EAX,ESI
008b17fd : JNZ 0x008b184b
008b17ff : MOV ECX,dword ptr [EBP + -0x14]
008b1802 : MOV ESI,dword ptr [EBP + -0x18]
008b1805 : SUB ECX,ESI
008b1807 : MOV EAX,0x92492493
008b180c : IMUL ECX
008b180e : ADD EDX,ECX
008b1810 : SAR EDX,0x4
008b1813 : MOV EAX,EDX
008b1815 : SHR EAX,0x1f
008b1818 : ADD EAX,EDX
008b181a : JZ 0x008b183e
008b181c : CMP dword ptr [ESI + 0x18],0x8
008b1820 : JC 0x008b1830
008b1822 : MOV ESI,dword ptr [ESI + 0x4]
008b1825 : PUSH ESI
008b1826 : CALL 0x00634f4d
008b182b : ADD ESP,0x4
008b182e : JMP 0x008b1840
008b1830 : ADD ESI,0x4
008b1833 : PUSH ESI
008b1834 : CALL 0x00634f4d
008b1839 : ADD ESP,0x4
008b183c : JMP 0x008b1840
008b183e : XOR EAX,EAX
008b1840 : MOV ECX,dword ptr [EBP + 0x8]
008b1843 : PUSH EAX
008b1844 : CALL 0x008b1390
008b1849 : XOR ESI,ESI
008b184b : MOV dword ptr [EBP + -0x4],0xffffffff
008b1852 : MOV EAX,dword ptr [EBP + -0x18]
008b1855 : CMP EAX,ESI
008b1857 : JZ 0x008b1870
008b1859 : MOV ECX,dword ptr [EBP + 0x8]
008b185c : MOV EDI,dword ptr [EBP + -0x14]
008b185f : PUSH ECX
008b1860 : CALL 0x00405450
008b1865 : MOV ECX,dword ptr [EBP + -0x18]
008b1868 : ADD ESP,0x4
008b186b : CALL 0x006f04e0
008b1870 : MOV dword ptr [EBP + -0x18],ESI
008b1873 : MOV dword ptr [EBP + -0x14],ESI
008b1876 : MOV dword ptr [EBP + -0x10],ESI
008b1879 : MOV ECX,dword ptr [EBP + -0xc]
008b187c : MOV dword ptr FS:[0x0],ECX
008b1883 : POP ECX
008b1884 : POP EDI
008b1885 : POP ESI
008b1886 : POP EBX
008b1887 : MOV ESP,EBP
008b1889 : POP EBP
008b188a : RET 0x8

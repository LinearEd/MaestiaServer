PROGRAM  : Maestia.exe
FUNCTION : Iput
ENTRY    : 0062bd95
BODY     : [[0062bd95, 0062bf80]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __EH_prolog3_GS replaced with injection: EH_prolog3 */
/* Library Function - Multiple Matches With Same Base Name
    private: class std::ostreambuf_iterator<unsigned short,struct std::char_traits<unsigned short> >
   __cdecl std::num_put<unsigned short,class std::ostreambuf_iterator<unsigned short,struct
   std::char_traits<unsigned short> > >::_Iput(class std::ostreambuf_iterator<unsigned short,struct
   std::char_traits<unsigned short> >,class std::ios_base &,unsigned short,char *,unsigned int)const
   
    private: class std::ostreambuf_iterator<wchar_t,struct std::char_traits<wchar_t> > __cdecl
   std::num_put<wchar_t,class std::ostreambuf_iterator<wchar_t,struct std::char_traits<wchar_t> >
   >::_Iput(class std::ostreambuf_iterator<wchar_t,struct std::char_traits<wchar_t> >,class
   std::ios_base &,wchar_t,char *,unsigned int)const 
   
   Library: Visual Studio 2008 Release */

void Iput(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,int param_5,
         undefined4 param_6,char *param_7,uint param_8)

{
  char cVar1;
  undefined4 uVar2;
  undefined2 uVar3;
  undefined4 uVar4;
  char ****ppppcVar5;
  rsize_t _DstSize;
  uint uVar6;
  undefined4 *puVar7;
  int iVar8;
  undefined1 local_54 [4];
  undefined4 local_50;
  int *local_4c;
  undefined1 local_48 [4];
  int local_44;
  undefined1 local_40 [4];
  int local_3c;
  undefined4 local_38;
  char ***local_34;
  undefined1 local_30 [4];
  char ***local_2c [5];
  uint local_18;
  undefined4 local_8;
  undefined4 uStack_4;
  
  uStack_4 = 0x44;
  local_8 = 0x62bda1;
  local_38 = param_1;
  local_50 = param_2;
  local_44 = param_5;
  uVar4 = FUN_004d0b70(local_54);
  local_8 = 0;
  local_4c = (int *)use_facet<>(uVar4);
  local_8 = 0xffffffff;
  FUN_00451310();
  grouping(local_30);
  cVar1 = *param_7;
  local_8 = 1;
  if ((cVar1 == '+') || (cVar1 == '-')) {
    local_3c = 1;
  }
  else if ((cVar1 == '0') && ((param_7[1] == 'x' || (param_7[1] == 'X')))) {
    local_3c = 2;
  }
  else {
    local_3c = 0;
  }
  ppppcVar5 = (char ****)local_2c[0];
  if (local_18 < 0x10) {
    ppppcVar5 = local_2c;
  }
  if (*(char *)ppppcVar5 != '\x7f') {
    ppppcVar5 = (char ****)local_2c[0];
    if (local_18 < 0x10) {
      ppppcVar5 = local_2c;
    }
    if ('\0' < *(char *)ppppcVar5) {
      uVar6 = param_8;
      if (local_18 < 0x10) {
        local_34 = (char ***)local_2c;
      }
      else {
        local_34 = local_2c[0];
      }
      while (((cVar1 = *(char *)local_34, cVar1 != '\x7f' && ('\0' < cVar1)) &&
             ((uint)(int)cVar1 < uVar6 - local_3c))) {
        uVar6 = uVar6 - (int)cVar1;
        _DstSize = (param_8 - uVar6) + 1;
        _memmove_s(param_7 + uVar6 + 1,_DstSize,param_7 + uVar6,_DstSize);
        param_8 = param_8 + 1;
        param_7[uVar6] = '\0';
        param_5 = local_44;
        if ('\0' < *(char *)((int)local_34 + 1)) {
          local_34 = (char ***)((int)local_34 + 1);
        }
      }
    }
  }
  uVar6 = *(uint *)(param_5 + 0x18);
  if (((int)uVar6 < 1) || (uVar6 <= param_8)) {
    iVar8 = 0;
  }
  else {
    iVar8 = uVar6 - param_8;
  }
  uVar6 = *(uint *)(param_5 + 0x10) & 0x1c0;
  if (uVar6 != 0x40) {
    if (uVar6 == 0x100) {
      puVar7 = (undefined4 *)Putc(local_38,local_48,param_3,param_4,param_7,local_3c);
      param_8 = param_8 - local_3c;
      param_7 = param_7 + local_3c;
      puVar7 = (undefined4 *)Rep(local_38,local_48,*puVar7,puVar7[1],param_6,iVar8);
    }
    else {
      puVar7 = (undefined4 *)Rep(local_38,local_48,param_3,param_4,param_6,iVar8);
    }
    param_3 = *puVar7;
    param_4 = puVar7[1];
    iVar8 = 0;
  }
  uVar3 = (**(code **)(*local_4c + 8))();
  puVar7 = (undefined4 *)Putgrouped(local_38,local_40,param_3,param_4,param_7,param_8,uVar3);
  uVar4 = *puVar7;
  uVar2 = puVar7[1];
  *(undefined4 *)(param_5 + 0x18) = 0;
  Rep(local_38,local_50,uVar4,uVar2,param_6,iVar8);
  FUN_00405260(1,0);
  FUN_00640ed0();
  return;
}



============================================================
DISASSEMBLY
============================================================
0062bd95 : PUSH 0x44
0062bd97 : MOV EAX,0xb0ba75
0062bd9c : CALL 0x00640e86
0062bda1 : MOV EAX,dword ptr [EBP + 0x8]
0062bda4 : MOV EBX,dword ptr [EBP + 0x18]
0062bda7 : MOV ESI,dword ptr [EBP + 0x20]
0062bdaa : MOV dword ptr [EBP + -0x34],EAX
0062bdad : MOV EAX,dword ptr [EBP + 0xc]
0062bdb0 : MOV dword ptr [EBP + -0x4c],EAX
0062bdb3 : LEA EAX,[EBP + -0x50]
0062bdb6 : PUSH EAX
0062bdb7 : MOV ECX,EBX
0062bdb9 : MOV dword ptr [EBP + -0x40],EBX
0062bdbc : CALL 0x004d0b70
0062bdc1 : AND dword ptr [EBP + -0x4],0x0
0062bdc5 : PUSH EAX
0062bdc6 : CALL 0x00628b70
0062bdcb : OR dword ptr [EBP + -0x4],0xffffffff
0062bdcf : POP ECX
0062bdd0 : LEA ECX,[EBP + -0x50]
0062bdd3 : MOV dword ptr [EBP + -0x48],EAX
0062bdd6 : CALL 0x00451310
0062bddb : MOV ECX,dword ptr [EBP + -0x48]
0062bdde : LEA EAX,[EBP + -0x2c]
0062bde1 : PUSH EAX
0062bde2 : CALL 0x006269c7
0062bde7 : MOV AL,byte ptr [ESI]
0062bde9 : XOR ECX,ECX
0062bdeb : INC ECX
0062bdec : MOV dword ptr [EBP + -0x4],ECX
0062bdef : CMP AL,0x2b
0062bdf1 : JZ 0x0062be15
0062bdf3 : CMP AL,0x2d
0062bdf5 : JZ 0x0062be15
0062bdf7 : CMP AL,0x30
0062bdf9 : JNZ 0x0062be0f
0062bdfb : MOV AL,byte ptr [ESI + 0x1]
0062bdfe : CMP AL,0x78
0062be00 : JZ 0x0062be06
0062be02 : CMP AL,0x58
0062be04 : JNZ 0x0062be0f
0062be06 : MOV dword ptr [EBP + -0x38],0x2
0062be0d : JMP 0x0062be18
0062be0f : AND dword ptr [EBP + -0x38],0x0
0062be13 : JMP 0x0062be18
0062be15 : MOV dword ptr [EBP + -0x38],ECX
0062be18 : CMP dword ptr [EBP + -0x14],0x10
0062be1c : MOV ECX,dword ptr [EBP + -0x28]
0062be1f : MOV EAX,ECX
0062be21 : JNC 0x0062be26
0062be23 : LEA EAX,[EBP + -0x28]
0062be26 : CMP byte ptr [EAX],0x7f
0062be29 : JZ 0x0062be9a
0062be2b : CMP dword ptr [EBP + -0x14],0x10
0062be2f : MOV EAX,ECX
0062be31 : JNC 0x0062be36
0062be33 : LEA EAX,[EBP + -0x28]
0062be36 : CMP byte ptr [EAX],0x0
0062be39 : JLE 0x0062be9a
0062be3b : CMP dword ptr [EBP + -0x14],0x10
0062be3f : JC 0x0062be46
0062be41 : MOV dword ptr [EBP + -0x30],ECX
0062be44 : JMP 0x0062be4c
0062be46 : LEA EAX,[EBP + -0x28]
0062be49 : MOV dword ptr [EBP + -0x30],EAX
0062be4c : MOV EDI,dword ptr [EBP + 0x24]
0062be4f : JMP 0x0062be91
0062be51 : TEST AL,AL
0062be53 : JLE 0x0062be9a
0062be55 : MOV ECX,EDI
0062be57 : SUB ECX,dword ptr [EBP + -0x38]
0062be5a : MOVSX EAX,AL
0062be5d : CMP EAX,ECX
0062be5f : JNC 0x0062be9a
0062be61 : SUB EDI,EAX
0062be63 : MOV EAX,dword ptr [EBP + 0x24]
0062be66 : SUB EAX,EDI
0062be68 : INC EAX
0062be69 : PUSH EAX
0062be6a : LEA EBX,[ESI + EDI*0x1]
0062be6d : PUSH EBX
0062be6e : PUSH EAX
0062be6f : LEA EAX,[ESI + EDI*0x1 + 0x1]
0062be73 : PUSH EAX
0062be74 : CALL 0x00634101
0062be79 : MOV EAX,dword ptr [EBP + -0x30]
0062be7c : ADD ESP,0x10
0062be7f : INC dword ptr [EBP + 0x24]
0062be82 : INC EAX
0062be83 : MOV byte ptr [EBX],0x0
0062be86 : CMP byte ptr [EAX],0x0
0062be89 : JLE 0x0062be8e
0062be8b : MOV dword ptr [EBP + -0x30],EAX
0062be8e : MOV EBX,dword ptr [EBP + -0x40]
0062be91 : MOV EAX,dword ptr [EBP + -0x30]
0062be94 : MOV AL,byte ptr [EAX]
0062be96 : CMP AL,0x7f
0062be98 : JNZ 0x0062be51
0062be9a : MOV EDI,dword ptr [EBX + 0x18]
0062be9d : TEST EDI,EDI
0062be9f : JLE 0x0062beab
0062bea1 : CMP EDI,dword ptr [EBP + 0x24]
0062bea4 : JBE 0x0062beab
0062bea6 : SUB EDI,dword ptr [EBP + 0x24]
0062bea9 : JMP 0x0062bead
0062beab : XOR EDI,EDI
0062bead : MOV EAX,dword ptr [EBX + 0x10]
0062beb0 : AND EAX,0x1c0
0062beb5 : CMP EAX,0x40
0062beb8 : JZ 0x0062bf27
0062beba : CMP EAX,0x100
0062bebf : LEA EAX,[EBP + -0x44]
0062bec2 : JZ 0x0062bedc
0062bec4 : PUSH EDI
0062bec5 : PUSH dword ptr [EBP + 0x1c]
0062bec8 : PUSH dword ptr [EBP + 0x14]
0062becb : PUSH dword ptr [EBP + 0x10]
0062bece : PUSH EAX
0062becf : PUSH dword ptr [EBP + -0x34]
0062bed2 : CALL 0x006264ac
0062bed7 : ADD ESP,0x18
0062beda : JMP 0x0062bf1a
0062bedc : PUSH dword ptr [EBP + -0x38]
0062bedf : PUSH ESI
0062bee0 : PUSH dword ptr [EBP + 0x14]
0062bee3 : PUSH dword ptr [EBP + 0x10]
0062bee6 : PUSH EAX
0062bee7 : PUSH dword ptr [EBP + -0x34]
0062beea : CALL 0x006261e0
0062beef : MOV ECX,dword ptr [EAX]
0062bef1 : PUSH EDI
0062bef2 : PUSH dword ptr [EBP + 0x1c]
0062bef5 : MOV dword ptr [EBP + 0x10],ECX
0062bef8 : MOV ECX,dword ptr [EAX + 0x4]
0062befb : MOV dword ptr [EBP + 0x14],ECX
0062befe : PUSH dword ptr [EAX + 0x4]
0062bf01 : MOV ECX,dword ptr [EBP + -0x38]
0062bf04 : PUSH dword ptr [EAX]
0062bf06 : SUB dword ptr [EBP + 0x24],ECX
0062bf09 : LEA EAX,[EBP + -0x44]
0062bf0c : PUSH EAX
0062bf0d : PUSH dword ptr [EBP + -0x34]
0062bf10 : ADD ESI,ECX
0062bf12 : CALL 0x006264ac
0062bf17 : ADD ESP,0x30
0062bf1a : MOV ECX,dword ptr [EAX]
0062bf1c : MOV dword ptr [EBP + 0x10],ECX
0062bf1f : MOV EAX,dword ptr [EAX + 0x4]
0062bf22 : XOR EDI,EDI
0062bf24 : MOV dword ptr [EBP + 0x14],EAX
0062bf27 : MOV ECX,dword ptr [EBP + -0x48]
0062bf2a : MOV EAX,dword ptr [ECX]
0062bf2c : CALL dword ptr [EAX + 0x8]
0062bf2f : MOVZX EAX,AX
0062bf32 : PUSH EAX
0062bf33 : PUSH dword ptr [EBP + 0x24]
0062bf36 : LEA EAX,[EBP + -0x3c]
0062bf39 : PUSH ESI
0062bf3a : PUSH dword ptr [EBP + 0x14]
0062bf3d : PUSH dword ptr [EBP + 0x10]
0062bf40 : PUSH EAX
0062bf41 : PUSH dword ptr [EBP + -0x34]
0062bf44 : CALL 0x00626589
0062bf49 : MOV ECX,dword ptr [EAX]
0062bf4b : PUSH EDI
0062bf4c : PUSH dword ptr [EBP + 0x1c]
0062bf4f : MOV dword ptr [EBP + 0x10],ECX
0062bf52 : MOV EAX,dword ptr [EAX + 0x4]
0062bf55 : AND dword ptr [EBX + 0x18],0x0
0062bf59 : PUSH EAX
0062bf5a : PUSH ECX
0062bf5b : PUSH dword ptr [EBP + -0x4c]
0062bf5e : MOV dword ptr [EBP + 0x14],EAX
0062bf61 : PUSH dword ptr [EBP + -0x34]
0062bf64 : CALL 0x006264ac
0062bf69 : ADD ESP,0x34
0062bf6c : PUSH 0x0
0062bf6e : PUSH 0x1
0062bf70 : LEA ECX,[EBP + -0x2c]
0062bf73 : CALL 0x00405260
0062bf78 : MOV EAX,dword ptr [EBP + -0x4c]
0062bf7b : CALL 0x00640ed0
0062bf80 : RET

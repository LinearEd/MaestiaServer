PROGRAM  : Maestia.exe
FUNCTION : FUN_005f61d0
ENTRY    : 005f61d0
BODY     : [[005f61d0, 005f6385]]

============================================================
DECOMPILED C CODE
============================================================

undefined1 FUN_005f61d0(int param_1)

{
  ushort uVar1;
  int *piVar2;
  int iVar3;
  undefined1 uVar4;
  int iVar5;
  int *piVar6;
  undefined4 *in_ECX;
  uint uVar7;
  int iVar8;
  
  piVar2 = *(int **)(param_1 + 0xc);
  uVar4 = 1;
  if (in_ECX[2] + (int)piVar2 != *(int *)(param_1 + 0x10)) {
    FUN_005f5e20(param_1);
    *(undefined4 *)(param_1 + 8) = in_ECX[0xb];
    *(undefined4 **)(param_1 + 4) = in_ECX + 9;
    *(int *)(in_ECX[0xb] + 4) = param_1;
    in_ECX[0xb] = param_1;
    piVar2[2] = piVar2[2] + -1;
    iVar5 = FUN_005f5c40(param_1);
    FUN_005aba80(param_1);
    in_ECX[0x12] = in_ECX[0x12] - iVar5;
    uVar4 = (**(code **)(*(int *)*in_ECX + 8))
                      ((*(int *)(param_1 + 0x10) - (uint)*(ushort *)(param_1 + 0x1e)) -
                       (~-(uint)(*(int *)(param_1 + 0xc) + in_ECX[2] != *(int *)(param_1 + 0x10)) &
                       in_ECX[2]),iVar5,1 << (*(byte *)(param_1 + 0x1c) & 0x1f));
  }
  if (piVar2[2] == 1) {
    iVar8 = in_ECX[2] + (int)piVar2;
    for (iVar5 = in_ECX[0x11]; (iVar5 != 0 && (*(int *)(iVar5 + 0x10) != in_ECX[2] + (int)piVar2));
        iVar5 = *(int *)(iVar5 + 4 + iVar3 * -4)) {
      iVar3 = iVar8 >> 0x1f;
      iVar8 = iVar8 * 2;
    }
    if (*(int *)(iVar5 + 0x18) == 0) {
      FUN_005f5e20(iVar5);
      *(undefined4 *)(iVar5 + 8) = in_ECX[0xb];
      *(undefined4 **)(iVar5 + 4) = in_ECX + 9;
      *(int *)(in_ECX[0xb] + 4) = iVar5;
      uVar7 = 0;
      in_ECX[0xb] = iVar5;
      if (in_ECX[3] != 0) {
        piVar6 = piVar2 + 10;
        do {
          *(int *)(piVar6[-1] + 8) = *piVar6;
          uVar7 = uVar7 + 1;
          *(int *)(*piVar6 + 4) = piVar6[-1];
          piVar6 = piVar6 + 8;
        } while (uVar7 < (uint)in_ECX[3]);
      }
      *(int *)(*piVar2 + 4) = piVar2[1];
      *(int *)piVar2[1] = *piVar2;
      uVar1 = *(ushort *)(iVar5 + 0x1e);
      if (uVar1 == 0) {
        iVar8 = 0;
      }
      else {
        iVar8 = in_ECX[0x14] - (uint)uVar1;
      }
      iVar8 = *(int *)(iVar5 + 0x14) + (uint)uVar1 + iVar8 +
              (~-(uint)(*(int *)(iVar5 + 0xc) + in_ECX[2] != *(int *)(iVar5 + 0x10)) & in_ECX[2]);
      FUN_005aba80(iVar5);
      in_ECX[0x12] = in_ECX[0x12] - iVar8;
      uVar4 = (**(code **)(*(int *)*in_ECX + 8))
                        ((*(int *)(iVar5 + 0x10) - (uint)*(ushort *)(iVar5 + 0x1e)) -
                         (~-(uint)(*(int *)(iVar5 + 0xc) + in_ECX[2] != *(int *)(iVar5 + 0x10)) &
                         in_ECX[2]),iVar8,1 << (*(byte *)(iVar5 + 0x1c) & 0x1f));
      return uVar4;
    }
  }
  return uVar4;
}



============================================================
DISASSEMBLY
============================================================
005f61d0 : PUSH ECX
005f61d1 : PUSH EBX
005f61d2 : PUSH EBP
005f61d3 : PUSH ESI
005f61d4 : PUSH EDI
005f61d5 : MOV EDI,dword ptr [ESP + 0x18]
005f61d9 : MOV EBX,dword ptr [EDI + 0xc]
005f61dc : MOV ESI,ECX
005f61de : MOV ECX,dword ptr [ESI + 0x8]
005f61e1 : ADD ECX,EBX
005f61e3 : MOV AL,0x1
005f61e5 : MOV byte ptr [ESP + 0x18],AL
005f61e9 : CMP ECX,dword ptr [EDI + 0x10]
005f61ec : JZ 0x005f6272
005f61f2 : PUSH EDI
005f61f3 : LEA ECX,[ESI + 0x44]
005f61f6 : CALL 0x005f5e20
005f61fb : MOV EDX,dword ptr [ESI + 0x2c]
005f61fe : LEA EAX,[ESI + 0x24]
005f6201 : MOV dword ptr [EDI + 0x8],EDX
005f6204 : MOV dword ptr [EDI + 0x4],EAX
005f6207 : MOV ECX,dword ptr [EAX + 0x8]
005f620a : MOV dword ptr [ECX + 0x4],EDI
005f620d : MOV dword ptr [EAX + 0x8],EDI
005f6210 : DEC dword ptr [EBX + 0x8]
005f6213 : PUSH EDI
005f6214 : MOV ECX,ESI
005f6216 : CALL 0x005f5c40
005f621b : PUSH EDI
005f621c : LEA ECX,[ESI + 0x4c]
005f621f : MOV EBP,EAX
005f6221 : CALL 0x005aba80
005f6226 : SUB dword ptr [ESI + 0x48],EBP
005f6229 : MOV EDX,dword ptr [ESI + 0x8]
005f622c : MOV EAX,dword ptr [EDI + 0xc]
005f622f : MOV ECX,dword ptr [EDI + 0x10]
005f6232 : ADD EAX,EDX
005f6234 : SUB EAX,ECX
005f6236 : NEG EAX
005f6238 : SBB EAX,EAX
005f623a : NOT EAX
005f623c : AND EAX,EDX
005f623e : MOVZX EDX,word ptr [EDI + 0x1e]
005f6242 : SUB ECX,EDX
005f6244 : SUB ECX,EAX
005f6246 : MOV EAX,dword ptr [ESI]
005f6248 : MOV EDX,dword ptr [EAX]
005f624a : MOV EDX,dword ptr [EDX + 0x8]
005f624d : MOV dword ptr [ESP + 0x10],ECX
005f6251 : MOV ECX,0x1
005f6256 : MOV dword ptr [ESP + 0x18],ECX
005f625a : MOV CL,byte ptr [EDI + 0x1c]
005f625d : MOV EDI,dword ptr [ESP + 0x18]
005f6261 : SHL EDI,CL
005f6263 : MOV ECX,dword ptr [ESP + 0x10]
005f6267 : PUSH EDI
005f6268 : PUSH EBP
005f6269 : PUSH ECX
005f626a : MOV ECX,EAX
005f626c : CALL EDX
005f626e : MOV byte ptr [ESP + 0x18],AL
005f6272 : CMP dword ptr [EBX + 0x8],0x1
005f6276 : JNZ 0x005f637e
005f627c : MOV EDX,dword ptr [ESI + 0x8]
005f627f : MOV EDI,dword ptr [ESI + 0x44]
005f6282 : LEA ECX,[ESI + 0x44]
005f6285 : ADD EDX,EBX
005f6287 : MOV EBP,EDX
005f6289 : TEST EDI,EDI
005f628b : JZ 0x005f62a4
005f628d : LEA ECX,[ECX]
005f6290 : CMP dword ptr [EDI + 0x10],EDX
005f6293 : JZ 0x005f62a4
005f6295 : MOV EAX,EBP
005f6297 : SHR EAX,0x1f
005f629a : MOV EDI,dword ptr [EDI + EAX*0x4 + 0x4]
005f629e : ADD EBP,EBP
005f62a0 : TEST EDI,EDI
005f62a2 : JNZ 0x005f6290
005f62a4 : CMP dword ptr [EDI + 0x18],0x0
005f62a8 : JNZ 0x005f637a
005f62ae : PUSH EDI
005f62af : CALL 0x005f5e20
005f62b4 : MOV ECX,dword ptr [ESI + 0x2c]
005f62b7 : LEA EAX,[ESI + 0x24]
005f62ba : MOV dword ptr [EDI + 0x8],ECX
005f62bd : MOV dword ptr [EDI + 0x4],EAX
005f62c0 : MOV EDX,dword ptr [EAX + 0x8]
005f62c3 : MOV dword ptr [EDX + 0x4],EDI
005f62c6 : XOR ECX,ECX
005f62c8 : MOV dword ptr [EAX + 0x8],EDI
005f62cb : CMP dword ptr [ESI + 0xc],ECX
005f62ce : JBE 0x005f62ec
005f62d0 : LEA EAX,[EBX + 0x28]
005f62d3 : MOV EDX,dword ptr [EAX + -0x4]
005f62d6 : MOV EBP,dword ptr [EAX]
005f62d8 : MOV dword ptr [EDX + 0x8],EBP
005f62db : MOV EDX,dword ptr [EAX]
005f62dd : MOV EBP,dword ptr [EAX + -0x4]
005f62e0 : INC ECX
005f62e1 : MOV dword ptr [EDX + 0x4],EBP
005f62e4 : ADD EAX,0x20
005f62e7 : CMP ECX,dword ptr [ESI + 0xc]
005f62ea : JC 0x005f62d3
005f62ec : MOV EAX,dword ptr [EBX]
005f62ee : MOV ECX,dword ptr [EBX + 0x4]
005f62f1 : MOV dword ptr [EAX + 0x4],ECX
005f62f4 : MOV EAX,dword ptr [EBX]
005f62f6 : MOV EDX,dword ptr [EBX + 0x4]
005f62f9 : MOV dword ptr [EDX],EAX
005f62fb : MOV ECX,dword ptr [ESI + 0x8]
005f62fe : MOV EAX,dword ptr [EDI + 0xc]
005f6301 : ADD EAX,ECX
005f6303 : SUB EAX,dword ptr [EDI + 0x10]
005f6306 : NEG EAX
005f6308 : SBB EAX,EAX
005f630a : NOT EAX
005f630c : AND EAX,ECX
005f630e : MOVZX ECX,word ptr [EDI + 0x1e]
005f6312 : TEST CX,CX
005f6315 : JZ 0x005f6321
005f6317 : MOV EDX,dword ptr [ESI + 0x50]
005f631a : MOVZX EBX,CX
005f631d : SUB EDX,EBX
005f631f : JMP 0x005f6323
005f6321 : XOR EDX,EDX
005f6323 : MOV EBX,dword ptr [EDI + 0x14]
005f6326 : MOVZX ECX,CX
005f6329 : ADD EBX,ECX
005f632b : ADD EBX,EDX
005f632d : PUSH EDI
005f632e : LEA ECX,[ESI + 0x4c]
005f6331 : ADD EBX,EAX
005f6333 : CALL 0x005aba80
005f6338 : SUB dword ptr [ESI + 0x48],EBX
005f633b : MOV EDX,dword ptr [ESI + 0x8]
005f633e : MOV EAX,dword ptr [EDI + 0xc]
005f6341 : MOV ECX,dword ptr [EDI + 0x10]
005f6344 : ADD EAX,EDX
005f6346 : SUB EAX,ECX
005f6348 : MOV ESI,dword ptr [ESI]
005f634a : NEG EAX
005f634c : SBB EAX,EAX
005f634e : NOT EAX
005f6350 : AND EAX,EDX
005f6352 : MOVZX EDX,word ptr [EDI + 0x1e]
005f6356 : SUB ECX,EDX
005f6358 : MOV EDX,dword ptr [ESI]
005f635a : SUB ECX,EAX
005f635c : MOV EAX,ECX
005f635e : MOV CL,byte ptr [EDI + 0x1c]
005f6361 : MOV EBP,0x1
005f6366 : SHL EBP,CL
005f6368 : MOV ECX,ESI
005f636a : PUSH EBP
005f636b : PUSH EBX
005f636c : PUSH EAX
005f636d : MOV EAX,dword ptr [EDX + 0x8]
005f6370 : CALL EAX
005f6372 : POP EDI
005f6373 : POP ESI
005f6374 : POP EBP
005f6375 : POP EBX
005f6376 : POP ECX
005f6377 : RET 0x4
005f637a : MOV AL,byte ptr [ESP + 0x18]
005f637e : POP EDI
005f637f : POP ESI
005f6380 : POP EBP
005f6381 : POP EBX
005f6382 : POP ECX
005f6383 : RET 0x4

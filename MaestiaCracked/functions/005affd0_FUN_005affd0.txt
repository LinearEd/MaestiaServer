PROGRAM  : Maestia.exe
FUNCTION : FUN_005affd0
ENTRY    : 005affd0
BODY     : [[005affd0, 005b0059]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005affd0(void)

{
  uint uVar1;
  undefined4 *puVar2;
  int *piVar3;
  undefined4 *in_ECX;
  int iVar4;
  uint uVar5;
  
  uVar1 = in_ECX[9];
  uVar5 = 0;
  *in_ECX = &PTR_FUN_00b8f69c;
  if (uVar1 != 0) {
    iVar4 = 0;
    do {
      if (uVar5 < 0x10) {
        piVar3 = (int *)(iVar4 + 0x34 + (int)in_ECX);
      }
      else {
        piVar3 = (int *)(in_ECX[10] + -0xc0 + iVar4);
      }
      if ((((*piVar3 == 2) && ((char)piVar3[2] != '\0')) &&
          (puVar2 = (undefined4 *)piVar3[1], puVar2 != (undefined4 *)0x0)) &&
         (((**(code **)*puVar2)(0), puVar2 < in_ECX + 0x3e || (in_ECX + 0xbe <= puVar2)))) {
        FUN_00515cf0(puVar2);
      }
      uVar5 = uVar5 + 1;
      iVar4 = iVar4 + 0xc;
    } while (uVar5 < uVar1);
  }
  FUN_00515cf0(in_ECX[10]);
  *in_ECX = &PTR_LAB_00b85ff8;
  return;
}



============================================================
DISASSEMBLY
============================================================
005affd0 : PUSH ECX
005affd1 : PUSH EBP
005affd2 : PUSH EDI
005affd3 : MOV EDI,ECX
005affd5 : MOV EAX,dword ptr [EDI + 0x24]
005affd8 : XOR EBP,EBP
005affda : MOV dword ptr [EDI],0xb8f69c
005affe0 : MOV dword ptr [ESP + 0x8],EAX
005affe4 : TEST EAX,EAX
005affe6 : JBE 0x005b0047
005affe8 : PUSH EBX
005affe9 : PUSH ESI
005affea : XOR EBX,EBX
005affec : LEA ESP,[ESP]
005afff0 : CMP EBP,0x10
005afff3 : JNC 0x005afffb
005afff5 : LEA EAX,[EBX + EDI*0x1 + 0x34]
005afff9 : JMP 0x005b0005
005afffb : MOV EAX,dword ptr [EDI + 0x28]
005afffe : LEA EAX,[EAX + EBX*0x1 + 0xffffff40]
005b0005 : CMP dword ptr [EAX],0x2
005b0008 : JNZ 0x005b003b
005b000a : CMP byte ptr [EAX + 0x8],0x0
005b000e : JZ 0x005b003b
005b0010 : MOV ESI,dword ptr [EAX + 0x4]
005b0013 : TEST ESI,ESI
005b0015 : JZ 0x005b003b
005b0017 : MOV EDX,dword ptr [ESI]
005b0019 : MOV EAX,dword ptr [EDX]
005b001b : PUSH 0x0
005b001d : MOV ECX,ESI
005b001f : CALL EAX
005b0021 : LEA ECX,[EDI + 0xf8]
005b0027 : CMP ESI,ECX
005b0029 : JC 0x005b0035
005b002b : LEA EDX,[EDI + 0x2f8]
005b0031 : CMP ESI,EDX
005b0033 : JC 0x005b003b
005b0035 : PUSH ESI
005b0036 : CALL 0x00515cf0
005b003b : INC EBP
005b003c : ADD EBX,0xc
005b003f : CMP EBP,dword ptr [ESP + 0x10]
005b0043 : JC 0x005afff0
005b0045 : POP ESI
005b0046 : POP EBX
005b0047 : MOV EAX,dword ptr [EDI + 0x28]
005b004a : PUSH EAX
005b004b : CALL 0x00515cf0
005b0050 : MOV dword ptr [EDI],0xb85ff8
005b0056 : POP EDI
005b0057 : POP EBP
005b0058 : POP ECX
005b0059 : RET

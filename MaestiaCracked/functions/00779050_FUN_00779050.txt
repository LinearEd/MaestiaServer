PROGRAM  : Maestia.exe
FUNCTION : FUN_00779050
ENTRY    : 00779050
BODY     : [[00779050, 0077932b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00779050(void)

{
  int iVar1;
  int in_ECX;
  undefined ***pppuStack_64;
  undefined **ppuStack_4c;
  int *piStack_48;
  undefined1 local_44 [4];
  int *piStack_40;
  int local_3c;
  undefined2 uStack_34;
  undefined4 uStack_24;
  uint uStack_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  int iStack_c;
  
  iStack_c = 0xffffffff;
  puStack_10 = &LAB_00b4bce4;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)&ppuStack_4c;
  ExceptionList = &local_14;
  local_3c = in_ECX;
  if (*(int **)(in_ECX + 0xf0) != (int *)0x0) {
    pppuStack_64 = (undefined ***)0x7790a2;
    (**(code **)(**(int **)(in_ECX + 0xf0) + 0xc))();
  }
  FUN_0045f680();
  iStack_c = 0;
  if (*(char *)(in_ECX + 0xc) == '\0') {
    pppuStack_64 = (undefined ***)0x7790d7;
    iVar1 = FUN_00405bb0();
    if (iVar1 != 0) {
      pppuStack_64 = (undefined ***)(in_ECX + 0xb0);
      iVar1 = FUN_007c8420(&ppuStack_4c);
      iStack_c._0_1_ = 1;
      if (piStack_40 != *(int **)(iVar1 + 4)) {
        if (piStack_40 != (int *)0x0) {
          (**(code **)(*piStack_40 + 0x30))();
        }
        if (*(int *)(iVar1 + 4) != 0) {
          pppuStack_64 = (undefined ***)0x779138;
          InterlockedIncrement((LONG *)(*(int *)(iVar1 + 4) + 0x2c));
        }
        piStack_40 = *(int **)(iVar1 + 4);
      }
      iStack_c._0_1_ = 0;
      ppuStack_4c = &PTR_FUN_00cd4964;
      if (piStack_48 != (int *)0x0) {
        (**(code **)(*piStack_48 + 0x30))();
        piStack_48 = (int *)0x0;
      }
      if (piStack_40 != (int *)0x0) {
        ppuStack_4c = (undefined **)&pppuStack_64;
        FUN_00476e90(&pppuStack_64,local_44);
        iStack_c._0_1_ = 0;
        FUN_004866c0();
      }
      pppuStack_64 = (undefined ***)0x0;
      uStack_20 = 7;
      uStack_24 = 0;
      uStack_34 = 0;
      FUN_00405eb0((undefined ***)(in_ECX + 0xb0));
      iStack_c = CONCAT31(iStack_c._1_3_,3);
      pppuStack_64 = &ppuStack_4c;
      ppuStack_4c = (undefined **)0x5f;
      pppuStack_64 = (undefined ***)FUN_00407cc0();
      if (pppuStack_64 != (undefined ***)0xffffffff) {
        FUN_00405e10();
        pppuStack_64 = (undefined ***)0x7791f6;
        FUN_00404980();
      }
      pppuStack_64 = &ppuStack_4c;
      iVar1 = (**(code **)(*DAT_017251d8 + 4))();
      iStack_c._0_1_ = 4;
      if (piStack_40 != *(int **)(iVar1 + 4)) {
        if (piStack_40 != (int *)0x0) {
          (**(code **)(*piStack_40 + 0x30))();
        }
        if (*(int *)(iVar1 + 4) != 0) {
          pppuStack_64 = (undefined ***)0x77923b;
          InterlockedIncrement((LONG *)(*(int *)(iVar1 + 4) + 0x2c));
        }
        piStack_40 = *(int **)(iVar1 + 4);
      }
      iStack_c._0_1_ = 3;
      ppuStack_4c = &PTR_FUN_00cd4964;
      if (piStack_48 != (int *)0x0) {
        (**(code **)(*piStack_48 + 0x30))();
        piStack_48 = (int *)0x0;
      }
      if (piStack_40 != (int *)0x0) {
        ppuStack_4c = (undefined **)&pppuStack_64;
        FUN_00476e90(&pppuStack_64,local_44);
        iStack_c._0_1_ = 3;
        FUN_00486740();
      }
      iStack_c = (uint)iStack_c._1_3_ << 8;
      if (7 < uStack_20) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      uStack_20 = 7;
      uStack_24 = 0;
      uStack_34 = 0;
      in_ECX = local_3c;
    }
  }
  pppuStack_64 = (undefined ***)0x7792c7;
  FUN_00778900();
  switch(*(undefined4 *)(in_ECX + 0xe8)) {
  case 0:
  case 2:
    *(undefined4 *)(in_ECX + 0xec) = *(undefined4 *)(in_ECX + 0xf0);
    break;
  case 1:
  case 3:
    FUN_00778e20();
    break;
  case 4:
    FUN_007780a0();
  }
  *(undefined1 *)(in_ECX + 0xd) = 1;
  iStack_c = 0xffffffff;
  FUN_0045f5a0();
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)&ppuStack_4c);
  return;
}



============================================================
DISASSEMBLY
============================================================
00779050 : PUSH EBP
00779051 : MOV EBP,ESP
00779053 : AND ESP,0xfffffff8
00779056 : PUSH -0x1
00779058 : PUSH 0xb4bce4
0077905d : MOV EAX,FS:[0x0]
00779063 : PUSH EAX
00779064 : SUB ESP,0x38
00779067 : MOV EAX,[0x00d66fa0]
0077906c : XOR EAX,ESP
0077906e : MOV dword ptr [ESP + 0x30],EAX
00779072 : PUSH EBX
00779073 : PUSH ESI
00779074 : PUSH EDI
00779075 : MOV EAX,[0x00d66fa0]
0077907a : XOR EAX,ESP
0077907c : PUSH EAX
0077907d : LEA EAX,[ESP + 0x48]
00779081 : MOV FS:[0x0],EAX
00779087 : MOV ESI,ECX
00779089 : MOV ECX,dword ptr [ESI + 0xf0]
0077908f : MOV dword ptr [ESP + 0x20],ESI
00779093 : TEST ECX,ECX
00779095 : JZ 0x007790a2
00779097 : MOV EAX,dword ptr [ECX]
00779099 : MOV EAX,dword ptr [EAX + 0xc]
0077909c : LEA EDX,[ESI + 0x10]
0077909f : PUSH EDX
007790a0 : CALL EAX
007790a2 : LEA ECX,[ESP + 0x18]
007790a6 : CALL 0x0045f680
007790ab : MOV dword ptr [ESP + 0x50],0x0
007790b3 : CMP byte ptr [ESI + 0xc],0x0
007790b7 : JNZ 0x007792c1
007790bd : MOV EAX,dword ptr [ESI + 0xc4]
007790c3 : LEA EBX,[ESI + 0xb0]
007790c9 : PUSH 0xc0ff8c
007790ce : XOR EDI,EDI
007790d0 : MOV ECX,EBX
007790d2 : CALL 0x00405bb0
007790d7 : TEST EAX,EAX
007790d9 : JZ 0x007792c1
007790df : MOV ECX,dword ptr [0x017251ac]
007790e5 : CMP dword ptr [ECX + 0x20],EDI
007790e8 : JZ 0x007790f6
007790ea : CMP dword ptr [ESI + 0x104],EDI
007790f0 : JNZ 0x007790f6
007790f2 : MOV AL,0x1
007790f4 : JMP 0x007790f8
007790f6 : XOR AL,AL
007790f8 : MOV ECX,dword ptr [0x017251d8]
007790fe : PUSH EAX
007790ff : PUSH EBX
00779100 : LEA EDX,[ESP + 0x18]
00779104 : PUSH EDX
00779105 : CALL 0x007c8420
0077910a : MOV ESI,EAX
0077910c : MOV byte ptr [ESP + 0x50],0x1
00779111 : MOV EAX,dword ptr [ESI + 0x4]
00779114 : MOV ECX,dword ptr [ESP + 0x1c]
00779118 : CMP ECX,EAX
0077911a : JZ 0x0077913f
0077911c : TEST ECX,ECX
0077911e : JZ 0x00779127
00779120 : MOV EAX,dword ptr [ECX]
00779122 : MOV EDX,dword ptr [EAX + 0x30]
00779125 : CALL EDX
00779127 : MOV EAX,dword ptr [ESI + 0x4]
0077912a : TEST EAX,EAX
0077912c : JZ 0x00779138
0077912e : ADD EAX,0x2c
00779131 : PUSH EAX
00779132 : CALL dword ptr [0x00b850dc]
00779138 : MOV ESI,dword ptr [ESI + 0x4]
0077913b : MOV dword ptr [ESP + 0x1c],ESI
0077913f : MOV byte ptr [ESP + 0x50],0x0
00779144 : MOV ECX,dword ptr [ESP + 0x14]
00779148 : XOR EDI,EDI
0077914a : MOV dword ptr [ESP + 0x10],0xcd4964
00779152 : CMP ECX,EDI
00779154 : JZ 0x00779161
00779156 : MOV EAX,dword ptr [ECX]
00779158 : MOV EDX,dword ptr [EAX + 0x30]
0077915b : CALL EDX
0077915d : MOV dword ptr [ESP + 0x14],EDI
00779161 : CMP dword ptr [ESP + 0x1c],EDI
00779165 : JZ 0x00779194
00779167 : SUB ESP,0x8
0077916a : MOV EAX,ESP
0077916c : MOV dword ptr [ESP + 0x18],ESP
00779170 : LEA ECX,[ESP + 0x20]
00779174 : PUSH ECX
00779175 : PUSH EAX
00779176 : CALL 0x00476e90
0077917b : MOV byte ptr [ESP + 0x58],0x2
00779180 : MOV byte ptr [ESP + 0x58],0x0
00779185 : MOV EDX,dword ptr [ESP + 0x28]
00779189 : MOV ESI,dword ptr [EDX + 0xf4]
0077918f : CALL 0x004866c0
00779194 : PUSH -0x1
00779196 : PUSH EDI
00779197 : XOR EAX,EAX
00779199 : PUSH EBX
0077919a : LEA ECX,[ESP + 0x30]
0077919e : MOV dword ptr [ESP + 0x48],0x7
007791a6 : MOV dword ptr [ESP + 0x44],EDI
007791aa : MOV word ptr [ESP + 0x34],AX
007791af : CALL 0x00405eb0
007791b4 : MOV BL,0x3
007791b6 : MOV byte ptr [ESP + 0x50],BL
007791ba : PUSH 0x1
007791bc : LEA ECX,[ESP + 0x14]
007791c0 : PUSH ECX
007791c1 : OR ECX,0xffffffff
007791c4 : LEA EDI,[ESP + 0x2c]
007791c8 : MOV dword ptr [ESP + 0x18],0x5f
007791d0 : CALL 0x00407cc0
007791d5 : CMP EAX,-0x1
007791d8 : JZ 0x007791f6
007791da : MOV EDX,dword ptr [ESP + 0x38]
007791de : SUB EDX,EAX
007791e0 : PUSH EDX
007791e1 : PUSH EAX
007791e2 : MOV ECX,EDI
007791e4 : CALL 0x00405e10
007791e9 : MOV EAX,EDI
007791eb : PUSH EAX
007791ec : MOV EDX,0xc10198
007791f1 : CALL 0x00404980
007791f6 : MOV ECX,dword ptr [0x017251d8]
007791fc : MOV EDX,dword ptr [ECX]
007791fe : MOV EDX,dword ptr [EDX + 0x4]
00779201 : LEA EAX,[ESP + 0x24]
00779205 : PUSH EAX
00779206 : LEA EAX,[ESP + 0x14]
0077920a : PUSH EAX
0077920b : CALL EDX
0077920d : MOV ESI,EAX
0077920f : MOV byte ptr [ESP + 0x50],0x4
00779214 : MOV EAX,dword ptr [ESI + 0x4]
00779217 : MOV ECX,dword ptr [ESP + 0x1c]
0077921b : CMP ECX,EAX
0077921d : JZ 0x00779242
0077921f : TEST ECX,ECX
00779221 : JZ 0x0077922a
00779223 : MOV EAX,dword ptr [ECX]
00779225 : MOV EDX,dword ptr [EAX + 0x30]
00779228 : CALL EDX
0077922a : MOV EAX,dword ptr [ESI + 0x4]
0077922d : TEST EAX,EAX
0077922f : JZ 0x0077923b
00779231 : ADD EAX,0x2c
00779234 : PUSH EAX
00779235 : CALL dword ptr [0x00b850dc]
0077923b : MOV ESI,dword ptr [ESI + 0x4]
0077923e : MOV dword ptr [ESP + 0x1c],ESI
00779242 : MOV byte ptr [ESP + 0x50],BL
00779246 : MOV ECX,dword ptr [ESP + 0x14]
0077924a : XOR EDI,EDI
0077924c : MOV dword ptr [ESP + 0x10],0xcd4964
00779254 : CMP ECX,EDI
00779256 : JZ 0x00779263
00779258 : MOV EAX,dword ptr [ECX]
0077925a : MOV EDX,dword ptr [EAX + 0x30]
0077925d : CALL EDX
0077925f : MOV dword ptr [ESP + 0x14],EDI
00779263 : CMP dword ptr [ESP + 0x1c],EDI
00779267 : JZ 0x00779295
00779269 : SUB ESP,0x8
0077926c : MOV EAX,ESP
0077926e : MOV dword ptr [ESP + 0x18],ESP
00779272 : LEA ECX,[ESP + 0x20]
00779276 : PUSH ECX
00779277 : PUSH EAX
00779278 : CALL 0x00476e90
0077927d : MOV byte ptr [ESP + 0x58],0x5
00779282 : MOV byte ptr [ESP + 0x58],BL
00779286 : MOV EDX,dword ptr [ESP + 0x28]
0077928a : MOV ESI,dword ptr [EDX + 0xf4]
00779290 : CALL 0x00486740
00779295 : MOV byte ptr [ESP + 0x50],0x0
0077929a : CMP dword ptr [ESP + 0x3c],0x8
0077929f : JC 0x007792aa
007792a1 : MOV ECX,dword ptr [ESP + 0x28]
007792a5 : CALL 0x006f04e0
007792aa : MOV ESI,dword ptr [ESP + 0x20]
007792ae : XOR EAX,EAX
007792b0 : MOV dword ptr [ESP + 0x3c],0x7
007792b8 : MOV dword ptr [ESP + 0x38],EDI
007792bc : MOV word ptr [ESP + 0x28],AX
007792c1 : PUSH ESI
007792c2 : CALL 0x00778900
007792c7 : MOV EAX,dword ptr [ESI + 0xe8]
007792cd : CMP EAX,0x4
007792d0 : JA 0x007792f7
007792d2 : JMP dword ptr [EAX*0x4 + 0x77932c]
007792d9 : MOV ECX,dword ptr [ESI + 0xf0]
007792df : MOV dword ptr [ESI + 0xec],ECX
007792e5 : JMP 0x007792f7
007792e7 : MOV ECX,ESI
007792e9 : CALL 0x00778e20
007792ee : JMP 0x007792f7
007792f0 : MOV EDI,ESI
007792f2 : CALL 0x007780a0
007792f7 : MOV byte ptr [ESI + 0xd],0x1
007792fb : MOV dword ptr [ESP + 0x50],0xffffffff
00779303 : LEA ECX,[ESP + 0x18]
00779307 : CALL 0x0045f5a0
0077930c : MOV AL,0x1
0077930e : MOV ECX,dword ptr [ESP + 0x48]
00779312 : MOV dword ptr FS:[0x0],ECX
00779319 : POP ECX
0077931a : POP EDI
0077931b : POP ESI
0077931c : POP EBX
0077931d : MOV ECX,dword ptr [ESP + 0x30]
00779321 : XOR ECX,ESP
00779323 : CALL 0x00633e6b
00779328 : MOV ESP,EBP
0077932a : POP EBP
0077932b : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00864060
ENTRY    : 00864060
BODY     : [[00864060, 008643b8]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00864060(wchar_t *param_1)

{
  wchar_t wVar1;
  wchar_t *pwVar2;
  undefined4 uVar3;
  wchar_t ****_Src;
  wchar_t *pwVar4;
  undefined1 local_8ac [28];
  undefined1 local_890 [28];
  undefined1 local_874 [28];
  undefined1 local_858 [32];
  wchar_t *local_838;
  wchar_t ***local_82c [4];
  undefined4 local_81c;
  uint local_818;
  wchar_t local_814 [512];
  wchar_t local_414 [512];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b5053b;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_838 = param_1;
  pwVar2 = param_1;
  do {
    wVar1 = *pwVar2;
    pwVar2 = pwVar2 + 1;
  } while (wVar1 != L'\0');
  if ((int)pwVar2 - (int)(param_1 + 1) >> 1 != 0) {
    local_414[0] = L'\0';
    wVar1 = *param_1;
    pwVar2 = param_1;
    while (wVar1 != L'\0') {
      if (*param_1 == L'`') {
        pwVar4 = param_1 + 1;
        if (*pwVar4 != L'J') {
          _wcsncat_s(local_414,0x200,param_1,1);
          _wcsncat_s(local_414,0x200,pwVar4,1);
          param_1 = pwVar4;
          goto LAB_00864363;
        }
        local_82c[0] = (wchar_t ***)((uint)local_82c[0] & 0xffff0000);
        local_818 = 7;
        local_81c = 0;
        FUN_00406360(&DAT_00c3eb94,0);
        local_8 = 0;
        switch(*(undefined2 *)(*(int *)(DAT_0172491c + 0x17c) + 0x16d8)) {
        case 1:
          FUN_00406460(L"IDS_JOB_WARRIOR");
          local_8._0_1_ = 1;
          uVar3 = FUN_0081d120(local_890);
          local_8._0_1_ = 2;
          FUN_00405eb0(uVar3,0,0xffffffff);
          local_8._0_1_ = 1;
          FUN_00406560();
          local_8 = (uint)local_8._1_3_ << 8;
          break;
        case 2:
          FUN_00406460(L"IDS_JOB_WIZARD");
          local_8._0_1_ = 5;
          uVar3 = FUN_0081d120(local_858);
          local_8._0_1_ = 6;
          FUN_00405eb0(uVar3,0,0xffffffff);
          local_8._0_1_ = 5;
          FUN_00406560();
          local_8 = (uint)local_8._1_3_ << 8;
          break;
        case 3:
          FUN_00406460(L"IDS_JOB_RANGER");
          local_8._0_1_ = 3;
          uVar3 = FUN_0081d120(local_8ac);
          local_8._0_1_ = 4;
          FUN_00405eb0(uVar3,0,0xffffffff);
          local_8._0_1_ = 3;
          FUN_00406560();
          local_8 = (uint)local_8._1_3_ << 8;
          break;
        case 4:
          FUN_00406460(L"IDS_JOB_PRIEST");
          local_8._0_1_ = 7;
          uVar3 = FUN_0081d120(local_874);
          local_8._0_1_ = 8;
          FUN_00405eb0(uVar3,0,0xffffffff);
          local_8._0_1_ = 7;
          FUN_00406560();
          local_8 = (uint)local_8._1_3_ << 8;
          break;
        default:
          goto switchD_00864131_default;
        }
        FUN_00406560();
switchD_00864131_default:
        _Src = (wchar_t ****)local_82c[0];
        if (local_818 < 8) {
          _Src = local_82c;
        }
        _wcscpy_s(local_814,0x200,(wchar_t *)_Src);
        _wcscat_s(local_414,0x200,local_814);
        param_1 = param_1 + 2;
        local_8 = 0xffffffff;
        if (7 < local_818) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_818 = 7;
        local_81c = 0;
        local_82c[0] = (wchar_t ***)((uint)local_82c[0] & 0xffff0000);
        pwVar2 = local_838;
      }
      else {
        _wcsncat_s(local_414,0x200,param_1,1);
LAB_00864363:
        param_1 = param_1 + 1;
      }
      wVar1 = *param_1;
    }
    pwVar4 = pwVar2;
    do {
      wVar1 = *(wchar_t *)(((int)local_414 - (int)pwVar2) + (int)pwVar4);
      *pwVar4 = wVar1;
      pwVar4 = pwVar4 + 1;
    } while (wVar1 != L'\0');
    FUN_008949b0(pwVar2);
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00864060 : PUSH EBP
00864061 : MOV EBP,ESP
00864063 : PUSH -0x1
00864065 : PUSH 0xb5053b
0086406a : MOV EAX,FS:[0x0]
00864070 : PUSH EAX
00864071 : SUB ESP,0x90c
00864077 : MOV EAX,[0x00d66fa0]
0086407c : XOR EAX,EBP
0086407e : MOV dword ptr [EBP + -0x10],EAX
00864081 : PUSH EBX
00864082 : PUSH ESI
00864083 : PUSH EDI
00864084 : PUSH EAX
00864085 : LEA EAX,[EBP + -0xc]
00864088 : MOV FS:[0x0],EAX
0086408e : MOV EDI,dword ptr [EBP + 0x8]
00864091 : MOV EAX,EDI
00864093 : MOV dword ptr [EBP + 0xfffff7d0],ECX
00864099 : MOV dword ptr [EBP + 0xfffff7cc],EDI
0086409f : LEA EDX,[EAX + 0x2]
008640a2 : XOR EBX,EBX
008640a4 : MOV CX,word ptr [EAX]
008640a7 : ADD EAX,0x2
008640aa : CMP CX,BX
008640ad : JNZ 0x008640a4
008640af : SUB EAX,EDX
008640b1 : SAR EAX,0x1
008640b3 : JZ 0x0086439b
008640b9 : XOR EAX,EAX
008640bb : MOV word ptr [EBP + 0xfffffbf0],AX
008640c2 : MOV ESI,EDI
008640c4 : CMP word ptr [EDI],BX
008640c7 : JZ 0x0086436f
008640cd : LEA ECX,[ECX]
008640d0 : CMP word ptr [ESI],0x60
008640d4 : JNZ 0x0086434c
008640da : ADD ESI,0x2
008640dd : CMP word ptr [ESI],0x4a
008640e1 : JNZ 0x00864319
008640e7 : XOR ECX,ECX
008640e9 : PUSH EBX
008640ea : MOV word ptr [EBP + 0xfffff7d8],CX
008640f1 : PUSH 0xc3eb94
008640f6 : LEA ECX,[EBP + 0xfffff7d4]
008640fc : MOV dword ptr [EBP + 0xfffff7ec],0x7
00864106 : MOV dword ptr [EBP + 0xfffff7e8],EBX
0086410c : CALL 0x00406360
00864111 : MOV dword ptr [EBP + -0x4],EBX
00864114 : MOV EDX,dword ptr [0x0172491c]
0086411a : MOV EAX,dword ptr [EDX + 0x17c]
00864120 : MOVZX EAX,word ptr [EAX + 0x16d8]
00864127 : DEC EAX
00864128 : CMP EAX,0x3
0086412b : JA 0x00864295
00864131 : JMP dword ptr [EAX*0x4 + 0x8643bc]
00864138 : PUSH 0xc3eb98
0086413d : LEA ECX,[EBP + 0xfffff774]
00864143 : CALL 0x00406460
00864148 : MOV byte ptr [EBP + -0x4],0x1
0086414c : MOV ECX,dword ptr [0x0172491c]
00864152 : LEA EAX,[EBP + 0xfffff774]
00864158 : PUSH EAX
00864159 : LEA EDI,[EBP + 0xfffff6e8]
0086415f : CALL 0x0081d120
00864164 : MOV byte ptr [EBP + -0x4],0x2
00864168 : PUSH -0x1
0086416a : PUSH EBX
0086416b : PUSH EAX
0086416c : LEA ECX,[EBP + 0xfffff7d4]
00864172 : CALL 0x00405eb0
00864177 : MOV byte ptr [EBP + -0x4],0x1
0086417b : MOV ECX,EDI
0086417d : CALL 0x00406560
00864182 : MOV byte ptr [EBP + -0x4],BL
00864185 : LEA ECX,[EBP + 0xfffff774]
0086418b : JMP 0x00864290
00864190 : PUSH 0xc3ebb8
00864195 : LEA ECX,[EBP + 0xfffff758]
0086419b : CALL 0x00406460
008641a0 : MOV byte ptr [EBP + -0x4],0x3
008641a4 : LEA ECX,[EBP + 0xfffff758]
008641aa : PUSH ECX
008641ab : MOV ECX,dword ptr [0x0172491c]
008641b1 : LEA EDI,[EBP + 0xfffff720]
008641b7 : CALL 0x0081d120
008641bc : MOV byte ptr [EBP + -0x4],0x4
008641c0 : PUSH -0x1
008641c2 : PUSH EBX
008641c3 : PUSH EAX
008641c4 : LEA ECX,[EBP + 0xfffff7d4]
008641ca : CALL 0x00405eb0
008641cf : MOV byte ptr [EBP + -0x4],0x3
008641d3 : MOV ECX,EDI
008641d5 : CALL 0x00406560
008641da : MOV byte ptr [EBP + -0x4],BL
008641dd : LEA ECX,[EBP + 0xfffff758]
008641e3 : JMP 0x00864290
008641e8 : PUSH 0xc3ebd8
008641ed : LEA ECX,[EBP + 0xfffff7ac]
008641f3 : CALL 0x00406460
008641f8 : MOV byte ptr [EBP + -0x4],0x5
008641fc : MOV ECX,dword ptr [0x0172491c]
00864202 : LEA EDX,[EBP + 0xfffff7ac]
00864208 : PUSH EDX
00864209 : LEA EDI,[EBP + 0xfffff73c]
0086420f : CALL 0x0081d120
00864214 : MOV byte ptr [EBP + -0x4],0x6
00864218 : PUSH -0x1
0086421a : PUSH EBX
0086421b : PUSH EAX
0086421c : LEA ECX,[EBP + 0xfffff7d4]
00864222 : CALL 0x00405eb0
00864227 : MOV byte ptr [EBP + -0x4],0x5
0086422b : MOV ECX,EDI
0086422d : CALL 0x00406560
00864232 : MOV byte ptr [EBP + -0x4],BL
00864235 : LEA ECX,[EBP + 0xfffff7ac]
0086423b : JMP 0x00864290
0086423d : PUSH 0xc3ebf8
00864242 : LEA ECX,[EBP + 0xfffff790]
00864248 : CALL 0x00406460
0086424d : MOV byte ptr [EBP + -0x4],0x7
00864251 : MOV ECX,dword ptr [0x0172491c]
00864257 : LEA EAX,[EBP + 0xfffff790]
0086425d : PUSH EAX
0086425e : LEA EDI,[EBP + 0xfffff704]
00864264 : CALL 0x0081d120
00864269 : MOV byte ptr [EBP + -0x4],0x8
0086426d : PUSH -0x1
0086426f : PUSH EBX
00864270 : PUSH EAX
00864271 : LEA ECX,[EBP + 0xfffff7d4]
00864277 : CALL 0x00405eb0
0086427c : MOV byte ptr [EBP + -0x4],0x7
00864280 : MOV ECX,EDI
00864282 : CALL 0x00406560
00864287 : MOV byte ptr [EBP + -0x4],BL
0086428a : LEA ECX,[EBP + 0xfffff790]
00864290 : CALL 0x00406560
00864295 : MOV EAX,dword ptr [EBP + 0xfffff7d8]
0086429b : MOV EDI,0x8
008642a0 : CMP dword ptr [EBP + 0xfffff7ec],EDI
008642a6 : JNC 0x008642ae
008642a8 : LEA EAX,[EBP + 0xfffff7d8]
008642ae : PUSH EAX
008642af : LEA ECX,[EBP + 0xfffff7f0]
008642b5 : PUSH 0x200
008642ba : PUSH ECX
008642bb : CALL 0x0063481b
008642c0 : LEA EDX,[EBP + 0xfffff7f0]
008642c6 : PUSH EDX
008642c7 : LEA EAX,[EBP + 0xfffffbf0]
008642cd : PUSH 0x200
008642d2 : PUSH EAX
008642d3 : CALL 0x006362c1
008642d8 : ADD ESP,0x18
008642db : ADD ESI,0x2
008642de : MOV dword ptr [EBP + -0x4],0xffffffff
008642e5 : CMP dword ptr [EBP + 0xfffff7ec],EDI
008642eb : JC 0x008642f8
008642ed : MOV ECX,dword ptr [EBP + 0xfffff7d8]
008642f3 : CALL 0x006f04e0
008642f8 : MOV EDI,dword ptr [EBP + 0xfffff7cc]
008642fe : XOR ECX,ECX
00864300 : MOV dword ptr [EBP + 0xfffff7ec],0x7
0086430a : MOV dword ptr [EBP + 0xfffff7e8],EBX
00864310 : MOV word ptr [EBP + 0xfffff7d8],CX
00864317 : JMP 0x00864366
00864319 : PUSH 0x1
0086431b : SUB ESI,0x2
0086431e : PUSH ESI
0086431f : LEA EDX,[EBP + 0xfffffbf0]
00864325 : PUSH 0x200
0086432a : PUSH EDX
0086432b : CALL 0x0063900a
00864330 : PUSH 0x1
00864332 : ADD ESI,0x2
00864335 : PUSH ESI
00864336 : LEA EAX,[EBP + 0xfffffbf0]
0086433c : PUSH 0x200
00864341 : PUSH EAX
00864342 : CALL 0x0063900a
00864347 : ADD ESP,0x20
0086434a : JMP 0x00864363
0086434c : PUSH 0x1
0086434e : PUSH ESI
0086434f : LEA ECX,[EBP + 0xfffffbf0]
00864355 : PUSH 0x200
0086435a : PUSH ECX
0086435b : CALL 0x0063900a
00864360 : ADD ESP,0x10
00864363 : ADD ESI,0x2
00864366 : CMP word ptr [ESI],BX
00864369 : JNZ 0x008640d0
0086436f : LEA EDX,[EBP + 0xfffffbf0]
00864375 : MOV EAX,EDI
00864377 : SUB EDX,EDI
00864379 : LEA ESP,[ESP]
00864380 : MOVZX ECX,word ptr [EDX + EAX*0x1]
00864384 : MOV word ptr [EAX],CX
00864387 : ADD EAX,0x2
0086438a : CMP CX,BX
0086438d : JNZ 0x00864380
0086438f : MOV ECX,dword ptr [EBP + 0xfffff7d0]
00864395 : PUSH EDI
00864396 : CALL 0x008949b0
0086439b : MOV ECX,dword ptr [EBP + -0xc]
0086439e : MOV dword ptr FS:[0x0],ECX
008643a5 : POP ECX
008643a6 : POP EDI
008643a7 : POP ESI
008643a8 : POP EBX
008643a9 : MOV ECX,dword ptr [EBP + -0x10]
008643ac : XOR ECX,EBP
008643ae : CALL 0x00633e6b
008643b3 : MOV ESP,EBP
008643b5 : POP EBP
008643b6 : RET 0x4

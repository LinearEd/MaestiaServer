PROGRAM  : Maestia.exe
FUNCTION : do_get
ENTRY    : 00623e70
BODY     : [[00623e70, 0062400d]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __EH_prolog3_GS replaced with injection: EH_prolog3 */
/* Library Function - Single Match
    protected: virtual class std::istreambuf_iterator<char,struct std::char_traits<char> >
   __thiscall std::num_get<char,class std::istreambuf_iterator<char,struct std::char_traits<char> >
   >::do_get(class std::istreambuf_iterator<char,struct std::char_traits<char> >,class
   std::istreambuf_iterator<char,struct std::char_traits<char> >,class std::ios_base &,int &,bool
   &)const 
   
   Library: Visual Studio 2008 Release */

void __thiscall
std::num_get<char,class_std::istreambuf_iterator<char,struct_std::char_traits<char>_>_>::do_get
          (undefined4 param_1,undefined4 *param_2,undefined4 param_3,undefined4 param_4,
          undefined4 param_5,undefined4 param_6,int param_7,uint *param_8,undefined4 param_9)

{
  undefined4 uVar1;
  bool bVar2;
  undefined4 uVar3;
  int iVar4;
  uint uVar5;
  num_get<char,class_std::istreambuf_iterator<char,struct_std::char_traits<char>_>_> *this;
  istreambuf_iterator<char,struct_std::char_traits<char>_> *local_68;
  undefined1 local_64 [4];
  int local_60;
  uint *local_5c;
  char *local_58;
  uint local_54;
  char **local_4c [5];
  uint local_38;
  istreambuf_iterator<char,struct_std::char_traits<char>_> local_34 [4];
  undefined1 local_30 [40];
  undefined4 local_8;
  undefined4 uStack_4;
  
  uVar1 = param_9;
  iVar4 = param_7;
  uStack_4 = 0x60;
  local_8 = 0x623e7c;
  local_54 = 0xffffffff;
  local_5c = param_8;
  if ((*(uint *)(param_7 + 0x10) & 0x4000) == 0) {
    local_60 = 0;
    FUN_004d0b70(local_64);
    this = (num_get<char,class_std::istreambuf_iterator<char,struct_std::char_traits<char>_>_> *)
           &local_60;
    local_8 = 4;
    iVar4 = _Getifld(this,local_58,local_34,
                     (istreambuf_iterator<char,struct_std::char_traits<char>_> *)&param_3,
                     (int)&param_5,*(locale **)(iVar4 + 0x10));
    uVar5 = FUN_00633181(local_34,&local_68,iVar4,this);
    local_8 = 0xffffffff;
    FUN_00451310();
    if (((local_68 != local_34) && (local_60 == 0)) && (uVar5 < 2)) {
      local_54 = uVar5;
    }
  }
  else {
    uVar3 = FUN_004d0b70(&local_58);
    local_8 = 0;
    local_54 = FUN_004d4090(uVar3);
    local_8 = 0xffffffff;
    FUN_00451310();
    FUN_004d1280(1,0);
    local_8 = 1;
    uVar3 = FUN_004d3840(local_30);
    local_8._0_1_ = 2;
    FUN_00427a20(uVar3,0,0xffffffff);
    local_8._0_1_ = 1;
    FUN_00405260(1,0);
    FUN_004d12b0(1,0);
    uVar3 = FUN_004d38a0(local_30);
    local_8._0_1_ = 3;
    FUN_00427a20(uVar3,0,0xffffffff);
    local_8 = CONCAT31(local_8._1_3_,1);
    FUN_00405260(1,0);
    if (local_38 < 0x10) {
      local_4c[0] = (char **)local_4c;
    }
    local_54 = _Getloctxt<char,class_std::istreambuf_iterator<char,struct_std::char_traits<char>_>_>
                         ((istreambuf_iterator<char,struct_std::char_traits<char>_> *)&param_3,
                          (istreambuf_iterator<char,struct_std::char_traits<char>_> *)&param_5,2,
                          (char *)local_4c[0]);
    local_8 = 0xffffffff;
    FUN_00405260(1,0);
  }
  bVar2 = istreambuf_iterator<char,struct_std::char_traits<char>_>::equal
                    ((istreambuf_iterator<char,struct_std::char_traits<char>_> *)&param_3,
                     (istreambuf_iterator<char,struct_std::char_traits<char>_> *)&param_5);
  if (bVar2) {
    *local_5c = *local_5c | 1;
  }
  if ((int)local_54 < 0) {
    *local_5c = *local_5c | 2;
  }
  else {
    *(bool *)uVar1 = local_54 != 0;
  }
  *param_2 = param_3;
  param_2[1] = param_4;
  FUN_00640ed0();
  return;
}



============================================================
DISASSEMBLY
============================================================
00623e70 : PUSH 0x60
00623e72 : MOV EAX,0xb0b6b5
00623e77 : CALL 0x00640e86
00623e7c : MOV EAX,dword ptr [EBP + 0x8]
00623e7f : MOV ESI,dword ptr [EBP + 0x1c]
00623e82 : OR dword ptr [EBP + -0x50],0xffffffff
00623e86 : MOV dword ptr [EBP + -0x68],EAX
00623e89 : MOV EAX,dword ptr [EBP + 0x20]
00623e8c : MOV dword ptr [EBP + -0x58],EAX
00623e8f : MOV EAX,dword ptr [EBP + 0x24]
00623e92 : XOR EBX,EBX
00623e94 : MOV dword ptr [EBP + -0x6c],EAX
00623e97 : MOV EAX,dword ptr [ESI + 0x10]
00623e9a : INC EBX
00623e9b : MOV dword ptr [EBP + -0x54],ECX
00623e9e : MOV ECX,ESI
00623ea0 : TEST EAX,0x4000
00623ea5 : JZ 0x00623f69
00623eab : LEA EAX,[EBP + -0x54]
00623eae : PUSH EAX
00623eaf : CALL 0x004d0b70
00623eb4 : XOR EDI,EDI
00623eb6 : PUSH EAX
00623eb7 : MOV dword ptr [EBP + -0x4],EDI
00623eba : CALL 0x004d4090
00623ebf : POP ECX
00623ec0 : OR ESI,0xffffffff
00623ec3 : LEA ECX,[EBP + -0x54]
00623ec6 : MOV dword ptr [EBP + -0x50],EAX
00623ec9 : MOV dword ptr [EBP + -0x4],ESI
00623ecc : CALL 0x00451310
00623ed1 : PUSH EDI
00623ed2 : PUSH EBX
00623ed3 : LEA ECX,[EBP + -0x4c]
00623ed6 : CALL 0x004d1280
00623edb : MOV ECX,dword ptr [EBP + -0x50]
00623ede : LEA EAX,[EBP + -0x2c]
00623ee1 : PUSH EAX
00623ee2 : MOV dword ptr [EBP + -0x4],EBX
00623ee5 : CALL 0x004d3840
00623eea : PUSH ESI
00623eeb : PUSH EDI
00623eec : PUSH EAX
00623eed : LEA ECX,[EBP + -0x4c]
00623ef0 : MOV byte ptr [EBP + -0x4],0x2
00623ef4 : CALL 0x00427a20
00623ef9 : PUSH EDI
00623efa : PUSH EBX
00623efb : LEA ECX,[EBP + -0x2c]
00623efe : MOV byte ptr [EBP + -0x4],BL
00623f01 : CALL 0x00405260
00623f06 : PUSH EDI
00623f07 : PUSH EBX
00623f08 : LEA ECX,[EBP + -0x4c]
00623f0b : CALL 0x004d12b0
00623f10 : MOV ECX,dword ptr [EBP + -0x50]
00623f13 : LEA EAX,[EBP + -0x2c]
00623f16 : PUSH EAX
00623f17 : CALL 0x004d38a0
00623f1c : PUSH ESI
00623f1d : PUSH EDI
00623f1e : PUSH EAX
00623f1f : LEA ECX,[EBP + -0x4c]
00623f22 : MOV byte ptr [EBP + -0x4],0x3
00623f26 : CALL 0x00427a20
00623f2b : PUSH EDI
00623f2c : PUSH EBX
00623f2d : LEA ECX,[EBP + -0x2c]
00623f30 : MOV byte ptr [EBP + -0x4],BL
00623f33 : CALL 0x00405260
00623f38 : CMP dword ptr [EBP + -0x34],0x10
00623f3c : MOV EAX,dword ptr [EBP + -0x48]
00623f3f : JNC 0x00623f44
00623f41 : LEA EAX,[EBP + -0x48]
00623f44 : PUSH EAX
00623f45 : PUSH 0x2
00623f47 : LEA EAX,[EBP + 0x14]
00623f4a : PUSH EAX
00623f4b : LEA EAX,[EBP + 0xc]
00623f4e : PUSH EAX
00623f4f : CALL 0x006231aa
00623f54 : ADD ESP,0x10
00623f57 : PUSH EDI
00623f58 : PUSH EBX
00623f59 : LEA ECX,[EBP + -0x4c]
00623f5c : MOV dword ptr [EBP + -0x50],EAX
00623f5f : MOV dword ptr [EBP + -0x4],ESI
00623f62 : CALL 0x00405260
00623f67 : JMP 0x00623fd1
00623f69 : LEA EAX,[EBP + -0x60]
00623f6c : XOR EDI,EDI
00623f6e : PUSH EAX
00623f6f : MOV dword ptr [EBP + -0x5c],EDI
00623f72 : CALL 0x004d0b70
00623f77 : MOV ESI,dword ptr [ESI + 0x10]
00623f7a : LEA ECX,[EBP + -0x5c]
00623f7d : PUSH ECX
00623f7e : PUSH EAX
00623f7f : PUSH ESI
00623f80 : LEA EAX,[EBP + 0x14]
00623f83 : PUSH EAX
00623f84 : LEA EAX,[EBP + 0xc]
00623f87 : PUSH EAX
00623f88 : LEA EAX,[EBP + -0x30]
00623f8b : PUSH EAX
00623f8c : PUSH dword ptr [EBP + -0x54]
00623f8f : MOV dword ptr [EBP + -0x4],0x4
00623f96 : CALL 0x00623717
00623f9b : ADD ESP,0x18
00623f9e : PUSH EAX
00623f9f : LEA EAX,[EBP + -0x64]
00623fa2 : PUSH EAX
00623fa3 : LEA EAX,[EBP + -0x30]
00623fa6 : PUSH EAX
00623fa7 : CALL 0x00633181
00623fac : OR dword ptr [EBP + -0x4],0xffffffff
00623fb0 : ADD ESP,0x10
00623fb3 : LEA ECX,[EBP + -0x60]
00623fb6 : MOV ESI,EAX
00623fb8 : CALL 0x00451310
00623fbd : LEA EAX,[EBP + -0x30]
00623fc0 : CMP dword ptr [EBP + -0x64],EAX
00623fc3 : JZ 0x00623fd1
00623fc5 : CMP dword ptr [EBP + -0x5c],EDI
00623fc8 : JNZ 0x00623fd1
00623fca : CMP ESI,EBX
00623fcc : JA 0x00623fd1
00623fce : MOV dword ptr [EBP + -0x50],ESI
00623fd1 : LEA EAX,[EBP + 0x14]
00623fd4 : PUSH EAX
00623fd5 : LEA ECX,[EBP + 0xc]
00623fd8 : CALL 0x00623123
00623fdd : TEST AL,AL
00623fdf : MOV EAX,dword ptr [EBP + -0x58]
00623fe2 : JZ 0x00623fe6
00623fe4 : OR dword ptr [EAX],EBX
00623fe6 : CMP dword ptr [EBP + -0x50],EDI
00623fe9 : JGE 0x00623ff0
00623feb : OR dword ptr [EAX],0x2
00623fee : JMP 0x00623ff8
00623ff0 : MOV ECX,dword ptr [EBP + -0x6c]
00623ff3 : SETNZ AL
00623ff6 : MOV byte ptr [ECX],AL
00623ff8 : MOV ECX,dword ptr [EBP + 0xc]
00623ffb : MOV EAX,dword ptr [EBP + -0x68]
00623ffe : MOV dword ptr [EAX],ECX
00624000 : MOV ECX,dword ptr [EBP + 0x10]
00624003 : MOV dword ptr [EAX + 0x4],ECX
00624006 : CALL 0x00640ed0
0062400b : RET 0x20

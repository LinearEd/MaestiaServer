PROGRAM  : Maestia.exe
FUNCTION : FUN_00a954c0
ENTRY    : 00a954c0
BODY     : [[00a954c0, 00a9571b] [00a95720, 00a9577f] [00a95787, 00a95840]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x00a95546) */

void FUN_00a954c0(void)

{
  int iVar1;
  int *piVar2;
  undefined4 uVar3;
  int in_ECX;
  undefined4 *puVar4;
  int iVar5;
  uint uVar6;
  int local_6c;
  uint uStack_68;
  int iStack_64;
  int iStack_60;
  int iStack_5c;
  undefined1 auStack_58 [8];
  undefined2 uStack_50;
  undefined4 uStack_40;
  uint uStack_3c;
  undefined4 uStack_34;
  undefined4 uStack_24;
  uint uStack_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  int iStack_c;
  
  iStack_c = 0xffffffff;
  puStack_10 = &LAB_00b67005;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)&local_6c;
  ExceptionList = &local_14;
  iVar5 = *DAT_00da9894;
  local_6c = in_ECX;
  if ((iVar5 != 0) && (*(int *)(iVar5 + 0x114) != 0)) {
    (**(code **)**(undefined4 **)(iVar5 + 0x114))
              ("mc_party.InitPartyPlay",DAT_00d66fa0 ^ (uint)&stack0xffffff88);
  }
  iVar5 = in_ECX;
  if (*(int *)(in_ECX + 0x48) != *(int *)(in_ECX + 0x4c)) {
    *(int *)(in_ECX + 0x4c) = *(int *)(in_ECX + 0x48);
    iVar5 = local_6c;
  }
  iStack_60 = *(int *)(*(int *)(DAT_0172491c + 0x17c) + 4);
  uStack_68 = **(int **)(iVar5 + 0x3c);
  if ((int *)uStack_68 != *(int **)(iVar5 + 0x3c)) {
    do {
      iStack_64 = *(int *)(uStack_68 + 0x10);
      if (*(int *)(iStack_64 + 0x80) == iStack_60) {
        FUN_0042fe80(in_ECX + 0x44,*(undefined4 *)(iVar5 + 0x48),&iStack_64);
      }
      else if (*(int *)(iStack_64 + 0x38) == *(int *)(iVar5 + 0x6c)) {
        iVar5 = *(int *)(in_ECX + 0x48);
        if (iVar5 == 0) {
          uVar6 = 0;
        }
        else {
          uVar6 = *(int *)(in_ECX + 0x50) - iVar5 >> 2;
        }
        piVar2 = *(int **)(in_ECX + 0x4c);
        if ((uint)((int)piVar2 - iVar5 >> 2) < uVar6) {
          *piVar2 = iStack_64;
          *(int **)(in_ECX + 0x4c) = piVar2 + 1;
          iVar5 = local_6c;
        }
        else {
          FUN_0042fe80(in_ECX + 0x44,piVar2,&iStack_64);
          iVar5 = local_6c;
        }
      }
      FUN_00416210();
    } while (uStack_68 != *(uint *)(iVar5 + 0x3c));
  }
  uStack_20 = 7;
  uStack_24 = 0;
  uStack_34 = (undefined4 *)((uint)uStack_34._2_2_ << 0x10);
  FUN_00406360(&DAT_00c77c10,0);
  iStack_c = 0;
  if ((uint)(*(int *)(in_ECX + 0x4c) - *(int *)(in_ECX + 0x48) >> 2) < 2) {
    iVar5 = *DAT_00da9894;
    if ((iVar5 != 0) && (*(int *)(iVar5 + 0x114) != 0)) {
      puVar4 = uStack_34;
      if (uStack_20 < 8) {
        puVar4 = &uStack_34;
      }
      (**(code **)(**(int **)(iVar5 + 0x114) + 4))
                (*(int **)(iVar5 + 0x114),"mc_party.RefreshPartyPlayer","%ls,%d",puVar4,1);
    }
  }
  else {
    uVar6 = 1;
    if (1 < (uint)(*(int *)(in_ECX + 0x4c) - *(int *)(in_ECX + 0x48) >> 2)) {
      do {
        iVar1 = *(int *)(*(int *)(iVar5 + 0x48) + uVar6 * 4);
        if (iVar1 != 0) {
          *(uint *)(iVar1 + 0x110) = uVar6;
          uVar3 = FUN_00404750(&DAT_00c77c14,*(undefined4 *)(iVar1 + 0x80));
          iStack_c._0_1_ = 1;
          FUN_00405c30(uVar3,0,0xffffffff);
          iStack_c = (uint)iStack_c._1_3_ << 8;
          if (7 < uStack_3c) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          uStack_3c = 7;
          uStack_40 = 0;
          uStack_50 = 0;
          iVar5 = local_6c;
        }
        uVar6 = uVar6 + 1;
      } while (uVar6 < (uint)(*(int *)(in_ECX + 0x4c) - *(int *)(in_ECX + 0x48) >> 2));
    }
    iVar1 = *DAT_00da9894;
    if ((iVar1 != 0) && (*(int *)(iVar1 + 0x114) != 0)) {
      puVar4 = uStack_34;
      if (uStack_20 < 8) {
        puVar4 = &uStack_34;
      }
      (**(code **)(**(int **)(iVar1 + 0x114) + 4))
                (*(int **)(iVar1 + 0x114),"mc_party.RefreshPartyPlayer","%ls,%d",puVar4,1);
    }
    uStack_68 = 1;
    if (1 < (uint)(*(int *)(in_ECX + 0x4c) - *(int *)(in_ECX + 0x48) >> 2)) {
      do {
        piVar2 = *(int **)(*(int *)(iVar5 + 0x48) + uStack_68 * 4);
        if (piVar2 != (int *)0x0) {
          FUN_0095b270();
          (**(code **)(*piVar2 + 0x4c))();
          iVar5 = local_6c;
          iStack_60 = piVar2[0x20];
          iStack_5c = local_6c + 0x54;
          FUN_004437f0(&iStack_60);
          iVar1 = iStack_64;
          if (iStack_64 != *(int *)(iVar5 + 0x58)) {
            FUN_0095edc0();
            if (*(int *)(iVar1 + 0x10) != 0) {
                    /* WARNING: Subroutine does not return */
              FUN_006f04e0();
            }
            FUN_0042b2c0(iStack_5c,auStack_58,iVar1);
          }
        }
        uStack_68 = uStack_68 + 1;
        iVar5 = local_6c;
      } while (uStack_68 < (uint)(*(int *)(in_ECX + 0x4c) - *(int *)(in_ECX + 0x48) >> 2));
    }
  }
  iStack_c = 0xffffffff;
  if (7 < uStack_20) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  uStack_20 = 7;
  uStack_24 = 0;
  uStack_34 = (undefined4 *)((uint)uStack_34 & 0xffff0000);
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)&local_6c);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a954c0 : PUSH EBP
00a954c1 : MOV EBP,ESP
00a954c3 : AND ESP,0xfffffff8
00a954c6 : PUSH -0x1
00a954c8 : PUSH 0xb67005
00a954cd : MOV EAX,FS:[0x0]
00a954d3 : PUSH EAX
00a954d4 : SUB ESP,0x58
00a954d7 : MOV EAX,[0x00d66fa0]
00a954dc : XOR EAX,ESP
00a954de : MOV dword ptr [ESP + 0x50],EAX
00a954e2 : PUSH EBX
00a954e3 : PUSH ESI
00a954e4 : PUSH EDI
00a954e5 : MOV EAX,[0x00d66fa0]
00a954ea : XOR EAX,ESP
00a954ec : PUSH EAX
00a954ed : LEA EAX,[ESP + 0x68]
00a954f1 : MOV FS:[0x0],EAX
00a954f7 : MOV EAX,[0x00da9894]
00a954fc : MOV EAX,dword ptr [EAX]
00a954fe : MOV ESI,ECX
00a95500 : MOV dword ptr [ESP + 0x10],ESI
00a95504 : TEST EAX,EAX
00a95506 : JZ 0x00a95524
00a95508 : CMP dword ptr [EAX + 0x114],0x0
00a9550f : JZ 0x00a95524
00a95511 : MOV EAX,dword ptr [EAX + 0x114]
00a95517 : MOV EDX,dword ptr [EAX]
00a95519 : MOV ECX,EAX
00a9551b : MOV EAX,dword ptr [EDX]
00a9551d : PUSH 0xc77bf8
00a95522 : CALL EAX
00a95524 : MOV ECX,dword ptr [ESI + 0x4c]
00a95527 : MOV EDI,dword ptr [ESI + 0x48]
00a9552a : LEA EBX,[ESI + 0x44]
00a9552d : CMP EDI,ECX
00a9552f : JZ 0x00a95559
00a95531 : MOV EAX,ECX
00a95533 : SUB EAX,ECX
00a95535 : SAR EAX,0x2
00a95538 : LEA EDX,[EAX*0x4 + 0x0]
00a9553f : LEA ESI,[EDX + EDI*0x1]
00a95542 : TEST EAX,EAX
00a95544 : JLE 0x00a95552
00a95546 : PUSH EDX
00a95547 : PUSH ECX
00a95548 : PUSH EDX
00a95549 : PUSH EDI
00a9554a : CALL 0x00634101
00a9554f : ADD ESP,0x10
00a95552 : MOV dword ptr [EBX + 0x8],ESI
00a95555 : MOV ESI,dword ptr [ESP + 0x10]
00a95559 : MOV ECX,dword ptr [0x0172491c]
00a9555f : MOV EAX,dword ptr [ECX + 0x17c]
00a95565 : MOV ECX,dword ptr [ESI + 0x3c]
00a95568 : MOV EDX,dword ptr [EAX + 0x4]
00a9556b : MOV EAX,dword ptr [ECX]
00a9556d : MOV dword ptr [ESP + 0x1c],EDX
00a95571 : MOV dword ptr [ESP + 0x14],EAX
00a95575 : CMP EAX,ECX
00a95577 : JZ 0x00a955f4
00a95579 : MOV EDI,dword ptr [EAX + 0x10]
00a9557c : MOV EAX,dword ptr [ESP + 0x1c]
00a95580 : MOV dword ptr [ESP + 0x18],EDI
00a95584 : CMP dword ptr [EDI + 0x80],EAX
00a9558a : JNZ 0x00a9559d
00a9558c : MOV EAX,dword ptr [ESI + 0x48]
00a9558f : LEA ECX,[ESP + 0x18]
00a95593 : PUSH ECX
00a95594 : PUSH EAX
00a95595 : PUSH EBX
00a95596 : CALL 0x0042fe80
00a9559b : JMP 0x00a955e0
00a9559d : MOV EAX,dword ptr [EDI + 0x38]
00a955a0 : CMP EAX,dword ptr [ESI + 0x6c]
00a955a3 : JNZ 0x00a955e0
00a955a5 : MOV EDX,dword ptr [EBX + 0x4]
00a955a8 : TEST EDX,EDX
00a955aa : JNZ 0x00a955b0
00a955ac : XOR EAX,EAX
00a955ae : JMP 0x00a955b8
00a955b0 : MOV EAX,dword ptr [EBX + 0xc]
00a955b3 : SUB EAX,EDX
00a955b5 : SAR EAX,0x2
00a955b8 : MOV ECX,dword ptr [EBX + 0x8]
00a955bb : MOV ESI,ECX
00a955bd : SUB ESI,EDX
00a955bf : SAR ESI,0x2
00a955c2 : CMP ESI,EAX
00a955c4 : JNC 0x00a955d0
00a955c6 : MOV dword ptr [ECX],EDI
00a955c8 : ADD ECX,0x4
00a955cb : MOV dword ptr [EBX + 0x8],ECX
00a955ce : JMP 0x00a955dc
00a955d0 : LEA EDX,[ESP + 0x18]
00a955d4 : PUSH EDX
00a955d5 : PUSH ECX
00a955d6 : PUSH EBX
00a955d7 : CALL 0x0042fe80
00a955dc : MOV ESI,dword ptr [ESP + 0x10]
00a955e0 : LEA EDX,[ESP + 0x14]
00a955e4 : CALL 0x00416210
00a955e9 : MOV ECX,dword ptr [ESI + 0x3c]
00a955ec : MOV EAX,dword ptr [ESP + 0x14]
00a955f0 : CMP EAX,ECX
00a955f2 : JNZ 0x00a95579
00a955f4 : XOR EAX,EAX
00a955f6 : PUSH EAX
00a955f7 : PUSH 0xc77c10
00a955fc : LEA ECX,[ESP + 0x4c]
00a95600 : MOV dword ptr [ESP + 0x64],0x7
00a95608 : MOV dword ptr [ESP + 0x60],0x0
00a95610 : MOV word ptr [ESP + 0x50],AX
00a95615 : CALL 0x00406360
00a9561a : MOV dword ptr [ESP + 0x70],0x0
00a95622 : MOV ECX,dword ptr [EBX + 0x8]
00a95625 : SUB ECX,dword ptr [EBX + 0x4]
00a95628 : SAR ECX,0x2
00a9562b : CMP ECX,0x2
00a9562e : JC 0x00a957b3
00a95634 : MOV EDX,dword ptr [EBX + 0x8]
00a95637 : SUB EDX,dword ptr [EBX + 0x4]
00a9563a : MOV EDI,0x1
00a9563f : SAR EDX,0x2
00a95642 : CMP EDX,EDI
00a95644 : JBE 0x00a956bf
00a95646 : MOV EAX,dword ptr [ESI + 0x48]
00a95649 : MOV EAX,dword ptr [EAX + EDI*0x4]
00a9564c : TEST EAX,EAX
00a9564e : JZ 0x00a956b1
00a95650 : MOV dword ptr [EAX + 0x110],EDI
00a95656 : MOV EAX,dword ptr [EAX + 0x80]
00a9565c : PUSH EAX
00a9565d : PUSH 0xc77c14
00a95662 : LEA ESI,[ESP + 0x30]
00a95666 : CALL 0x00404750
00a9566b : ADD ESP,0x8
00a9566e : MOV byte ptr [ESP + 0x70],0x1
00a95673 : PUSH -0x1
00a95675 : PUSH 0x0
00a95677 : PUSH EAX
00a95678 : LEA ECX,[ESP + 0x50]
00a9567c : CALL 0x00405c30
00a95681 : MOV byte ptr [ESP + 0x70],0x0
00a95686 : CMP dword ptr [ESP + 0x40],0x8
00a9568b : JC 0x00a95696
00a9568d : MOV ECX,dword ptr [ESP + 0x2c]
00a95691 : CALL 0x006f04e0
00a95696 : MOV ESI,dword ptr [ESP + 0x10]
00a9569a : XOR ECX,ECX
00a9569c : MOV dword ptr [ESP + 0x40],0x7
00a956a4 : MOV dword ptr [ESP + 0x3c],0x0
00a956ac : MOV word ptr [ESP + 0x2c],CX
00a956b1 : MOV EDX,dword ptr [EBX + 0x8]
00a956b4 : SUB EDX,dword ptr [EBX + 0x4]
00a956b7 : INC EDI
00a956b8 : SAR EDX,0x2
00a956bb : CMP EDI,EDX
00a956bd : JC 0x00a95646
00a956bf : MOV EAX,[0x00da9894]
00a956c4 : MOV EAX,dword ptr [EAX]
00a956c6 : TEST EAX,EAX
00a956c8 : JZ 0x00a95700
00a956ca : CMP dword ptr [EAX + 0x114],0x0
00a956d1 : JZ 0x00a95700
00a956d3 : CMP dword ptr [ESP + 0x5c],0x8
00a956d8 : MOV EAX,dword ptr [EAX + 0x114]
00a956de : MOV ECX,dword ptr [ESP + 0x48]
00a956e2 : JNC 0x00a956e8
00a956e4 : LEA ECX,[ESP + 0x48]
00a956e8 : MOV EDX,dword ptr [EAX]
00a956ea : PUSH 0x1
00a956ec : PUSH ECX
00a956ed : PUSH 0xc77c1c
00a956f2 : PUSH 0xc77c24
00a956f7 : PUSH EAX
00a956f8 : MOV EAX,dword ptr [EDX + 0x4]
00a956fb : CALL EAX
00a956fd : ADD ESP,0x14
00a95700 : MOV ECX,dword ptr [EBX + 0x8]
00a95703 : SUB ECX,dword ptr [EBX + 0x4]
00a95706 : MOV EAX,0x1
00a9570b : SAR ECX,0x2
00a9570e : MOV dword ptr [ESP + 0x14],EAX
00a95712 : CMP ECX,EAX
00a95714 : JBE 0x00a957f4
00a9571a : JMP 0x00a95724
00a95720 : MOV ESI,dword ptr [ESP + 0x10]
00a95724 : MOV EDX,dword ptr [ESI + 0x48]
00a95727 : MOV ESI,dword ptr [EDX + EAX*0x4]
00a9572a : TEST ESI,ESI
00a9572c : JZ 0x00a95797
00a9572e : CALL 0x0095b270
00a95733 : MOV EAX,dword ptr [ESI]
00a95735 : MOV EDX,dword ptr [EAX + 0x4c]
00a95738 : MOV ECX,ESI
00a9573a : CALL EDX
00a9573c : MOV EAX,dword ptr [ESI + 0x80]
00a95742 : MOV EDI,dword ptr [ESP + 0x10]
00a95746 : LEA EDX,[ESP + 0x1c]
00a9574a : MOV dword ptr [ESP + 0x1c],EAX
00a9574e : LEA ECX,[EDI + 0x54]
00a95751 : PUSH EDX
00a95752 : LEA EAX,[ESP + 0x1c]
00a95756 : MOV dword ptr [ESP + 0x24],ECX
00a9575a : CALL 0x004437f0
00a9575f : MOV EAX,dword ptr [EDI + 0x58]
00a95762 : MOV EDI,dword ptr [ESP + 0x18]
00a95766 : CMP EDI,EAX
00a95768 : JZ 0x00a95797
00a9576a : MOV EAX,dword ptr [EDI + 0x10]
00a9576d : MOV ECX,ESI
00a9576f : CALL 0x0095edc0
00a95774 : MOV ECX,dword ptr [EDI + 0x10]
00a95777 : TEST ECX,ECX
00a95779 : JZ 0x00a95787
00a9577b : CALL 0x006f04e0
00a95787 : MOV ECX,dword ptr [ESP + 0x20]
00a9578b : PUSH EDI
00a9578c : LEA EAX,[ESP + 0x28]
00a95790 : PUSH EAX
00a95791 : PUSH ECX
00a95792 : CALL 0x0042b2c0
00a95797 : MOV EDX,dword ptr [EBX + 0x8]
00a9579a : SUB EDX,dword ptr [EBX + 0x4]
00a9579d : MOV EAX,dword ptr [ESP + 0x14]
00a957a1 : INC EAX
00a957a2 : SAR EDX,0x2
00a957a5 : MOV dword ptr [ESP + 0x14],EAX
00a957a9 : CMP EAX,EDX
00a957ab : JC 0x00a95720
00a957b1 : JMP 0x00a957f4
00a957b3 : MOV EAX,[0x00da9894]
00a957b8 : MOV EAX,dword ptr [EAX]
00a957ba : TEST EAX,EAX
00a957bc : JZ 0x00a957f4
00a957be : CMP dword ptr [EAX + 0x114],0x0
00a957c5 : JZ 0x00a957f4
00a957c7 : CMP dword ptr [ESP + 0x5c],0x8
00a957cc : MOV EAX,dword ptr [EAX + 0x114]
00a957d2 : MOV ECX,dword ptr [ESP + 0x48]
00a957d6 : JNC 0x00a957dc
00a957d8 : LEA ECX,[ESP + 0x48]
00a957dc : MOV EDX,dword ptr [EAX]
00a957de : PUSH 0x1
00a957e0 : PUSH ECX
00a957e1 : PUSH 0xc77c40
00a957e6 : PUSH 0xc77c48
00a957eb : PUSH EAX
00a957ec : MOV EAX,dword ptr [EDX + 0x4]
00a957ef : CALL EAX
00a957f1 : ADD ESP,0x14
00a957f4 : MOV dword ptr [ESP + 0x70],0xffffffff
00a957fc : CMP dword ptr [ESP + 0x5c],0x8
00a95801 : JC 0x00a9580c
00a95803 : MOV ECX,dword ptr [ESP + 0x48]
00a95807 : CALL 0x006f04e0
00a9580c : XOR ECX,ECX
00a9580e : MOV dword ptr [ESP + 0x5c],0x7
00a95816 : MOV dword ptr [ESP + 0x58],0x0
00a9581e : MOV word ptr [ESP + 0x48],CX
00a95823 : MOV ECX,dword ptr [ESP + 0x68]
00a95827 : MOV dword ptr FS:[0x0],ECX
00a9582e : POP ECX
00a9582f : POP EDI
00a95830 : POP ESI
00a95831 : POP EBX
00a95832 : MOV ECX,dword ptr [ESP + 0x50]
00a95836 : XOR ECX,ESP
00a95838 : CALL 0x00633e6b
00a9583d : MOV ESP,EBP
00a9583f : POP EBP
00a95840 : RET

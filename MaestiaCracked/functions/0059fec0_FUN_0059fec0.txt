PROGRAM  : Maestia.exe
FUNCTION : FUN_0059fec0
ENTRY    : 0059fec0
BODY     : [[0059fec0, 005a0065]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_0059fec0(undefined4 *param_1,uint param_2)

{
  uint uVar1;
  undefined4 *puVar2;
  int iVar3;
  undefined4 uVar4;
  int unaff_EBX;
  uint uVar5;
  int local_28;
  uint local_24;
  undefined1 local_20;
  int local_1c;
  undefined4 local_18;
  undefined1 local_14;
  int iStack_c;
  
  uVar1 = param_2;
  uVar5 = 0;
  local_24 = param_2;
  local_20 = 8;
  puVar2 = (undefined4 *)FUN_00515840(0x34,0);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    FUN_00568960(&local_24,FUN_0059fd20);
    *puVar2 = &PTR_LAB_00b8f010;
    puVar2[4] = &PTR_LAB_00b90510;
  }
  *(undefined1 *)(param_1 + 2) = 0;
  *param_1 = puVar2;
  param_1[1] = 0;
  iVar3 = FUN_00515840(0x60,0);
  if (iVar3 != 0) {
    puVar2 = param_1;
    uVar4 = FUN_00530910(1);
    uVar5 = FUN_0059fe70(&local_24,uVar4,puVar2);
    if (uVar5 != 0) {
      *(uint *)(uVar5 + 8) = *(int *)(uVar5 + 8) + 1U & 0x8fffffff;
    }
  }
  local_28 = 0x21;
  param_2 = uVar5;
  FUN_0050ff10(&local_28,&param_2);
  if (param_2 != 0) {
    FUN_00503db0();
  }
  iVar3 = FUN_00530910(10);
  local_14 = 0;
  local_1c = *(int *)(iVar3 + 0x3c);
  if (local_1c != 0) {
    *(int *)(local_1c + 8) = *(int *)(local_1c + 8) + 1;
    *(uint *)(local_1c + 8) = *(uint *)(local_1c + 8) & 0x8fffffff;
  }
  local_18 = 0;
  if (*(int *)(iVar3 + 0x40) != 0) {
    FUN_005686c0(*(int *)(iVar3 + 0x40),*(byte *)(iVar3 + 0x44) & 1);
  }
  puVar2 = &param_2;
  param_2 = param_2 & 0xffffff00;
  iVar3 = *(int *)(local_1c + 0x10);
  uVar4 = FUN_00526210(param_1);
  (**(code **)(iVar3 + 0x28))(&local_24,uVar1 + 0x8c,uVar4,puVar2);
  FUN_00526bc0();
  if (((local_24 & 2) == 0) && (unaff_EBX != 0)) {
    FUN_00503db0();
  }
  if (((local_24 & 1) == 0) && (local_28 != 0)) {
    FUN_00503db0();
  }
  local_28 = 0;
  if (iStack_c != 0) {
    FUN_00503db0();
  }
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
0059fec0 : SUB ESP,0x28
0059fec3 : PUSH EBX
0059fec4 : PUSH EBP
0059fec5 : PUSH ESI
0059fec6 : PUSH EDI
0059fec7 : MOV EDI,dword ptr [ESP + 0x40]
0059fecb : MOV ECX,dword ptr [EDI + 0x288]
0059fed1 : XOR EBP,EBP
0059fed3 : PUSH EBP
0059fed4 : PUSH 0x34
0059fed6 : MOV dword ptr [ESP + 0x1c],EDI
0059feda : MOV byte ptr [ESP + 0x20],0x8
0059fedf : CALL 0x00515840
0059fee4 : MOV ESI,EAX
0059fee6 : CMP ESI,EBP
0059fee8 : JZ 0x0059ff0a
0059feea : PUSH 0x59fd20
0059feef : LEA EAX,[ESP + 0x18]
0059fef3 : PUSH EAX
0059fef4 : MOV ECX,ESI
0059fef6 : CALL 0x00568960
0059fefb : MOV dword ptr [ESI],0xb8f010
0059ff01 : MOV dword ptr [ESI + 0x10],0xb90510
0059ff08 : JMP 0x0059ff0c
0059ff0a : XOR ESI,ESI
0059ff0c : MOV EBX,dword ptr [ESP + 0x3c]
0059ff10 : PUSH EBP
0059ff11 : MOV byte ptr [EBX + 0x8],0x0
0059ff15 : MOV dword ptr [EBX],ESI
0059ff17 : MOV dword ptr [EBX + 0x4],EBP
0059ff1a : MOV ECX,dword ptr [EDI + 0x288]
0059ff20 : PUSH 0x60
0059ff22 : CALL 0x00515840
0059ff27 : MOV ESI,EAX
0059ff29 : CMP ESI,EBP
0059ff2b : JZ 0x005a005b
0059ff31 : PUSH EBX
0059ff32 : PUSH 0x1
0059ff34 : MOV ECX,EDI
0059ff36 : CALL 0x00530910
0059ff3b : PUSH EAX
0059ff3c : LEA ECX,[ESP + 0x1c]
0059ff40 : PUSH ECX
0059ff41 : MOV ECX,ESI
0059ff43 : CALL 0x0059fe70
0059ff48 : MOV dword ptr [ESP + 0x3c],EAX
0059ff4c : CMP EAX,EBP
0059ff4e : JZ 0x0059ff5d
0059ff50 : MOV EDX,dword ptr [EAX + 0x8]
0059ff53 : INC EDX
0059ff54 : AND EDX,0x8fffffff
0059ff5a : MOV dword ptr [EAX + 0x8],EDX
0059ff5d : MOV dword ptr [ESP + 0x40],EAX
0059ff61 : LEA EAX,[ESP + 0x40]
0059ff65 : PUSH EAX
0059ff66 : LEA ECX,[ESP + 0x14]
0059ff6a : PUSH ECX
0059ff6b : LEA ECX,[EDI + 0x278]
0059ff71 : MOV dword ptr [ESP + 0x18],0x21
0059ff79 : CALL 0x0050ff10
0059ff7e : MOV ECX,dword ptr [ESP + 0x40]
0059ff82 : CMP ECX,EBP
0059ff84 : JZ 0x0059ff8b
0059ff86 : CALL 0x00503db0
0059ff8b : PUSH 0xa
0059ff8d : MOV ECX,EDI
0059ff8f : CALL 0x00530910
0059ff94 : ADD EAX,0x38
0059ff97 : MOV byte ptr [ESP + 0x24],0x0
0059ff9c : MOV ECX,dword ptr [EAX + 0x4]
0059ff9f : MOV dword ptr [ESP + 0x1c],ECX
0059ffa3 : CMP ECX,EBP
0059ffa5 : JZ 0x0059ffb7
0059ffa7 : INC dword ptr [ECX + 0x8]
0059ffaa : ADD ECX,0x8
0059ffad : AND dword ptr [ECX],0x8fffffff
0059ffb3 : MOV ECX,dword ptr [ESP + 0x1c]
0059ffb7 : MOV dword ptr [ESP + 0x20],EBP
0059ffbb : MOV EDX,dword ptr [EAX + 0x8]
0059ffbe : CMP EDX,EBP
0059ffc0 : JZ 0x0059ffd9
0059ffc2 : MOV AL,byte ptr [EAX + 0xc]
0059ffc5 : AND AL,0x1
0059ffc7 : MOVZX ECX,AL
0059ffca : PUSH ECX
0059ffcb : PUSH EDX
0059ffcc : LEA ECX,[ESP + 0x24]
0059ffd0 : CALL 0x005686c0
0059ffd5 : MOV ECX,dword ptr [ESP + 0x1c]
0059ffd9 : LEA EBP,[ECX + 0x10]
0059ffdc : LEA EDX,[ESP + 0x40]
0059ffe0 : MOV byte ptr [ESP + 0x40],0x0
0059ffe5 : MOV ESI,dword ptr [EBP]
0059ffe8 : PUSH EDX
0059ffe9 : PUSH EBX
0059ffea : LEA ECX,[ESP + 0x30]
0059ffee : ADD ESI,0x28
0059fff1 : CALL 0x00526210
0059fff6 : MOV EDX,dword ptr [ESI]
0059fff8 : PUSH EAX
0059fff9 : ADD EDI,0x8c
0059ffff : PUSH EDI
005a0000 : LEA EAX,[ESP + 0x20]
005a0004 : PUSH EAX
005a0005 : MOV ECX,EBP
005a0007 : CALL EDX
005a0009 : LEA ECX,[ESP + 0x28]
005a000d : CALL 0x00526bc0
005a0012 : TEST byte ptr [ESP + 0x24],0x2
005a0017 : JNZ 0x005a0026
005a0019 : MOV ECX,dword ptr [ESP + 0x1c]
005a001d : TEST ECX,ECX
005a001f : JZ 0x005a0026
005a0021 : CALL 0x00503db0
005a0026 : XOR ESI,ESI
005a0028 : TEST byte ptr [ESP + 0x24],0x1
005a002d : MOV dword ptr [ESP + 0x1c],ESI
005a0031 : JNZ 0x005a0040
005a0033 : MOV ECX,dword ptr [ESP + 0x20]
005a0037 : CMP ECX,ESI
005a0039 : JZ 0x005a0040
005a003b : CALL 0x00503db0
005a0040 : MOV ECX,dword ptr [ESP + 0x3c]
005a0044 : MOV dword ptr [ESP + 0x20],ESI
005a0048 : CMP ECX,ESI
005a004a : JZ 0x005a0051
005a004c : CALL 0x00503db0
005a0051 : POP EDI
005a0052 : POP ESI
005a0053 : POP EBP
005a0054 : MOV EAX,EBX
005a0056 : POP EBX
005a0057 : ADD ESP,0x28
005a005a : RET
005a005b : MOV dword ptr [ESP + 0x3c],EBP
005a005f : MOV EAX,EBP
005a0061 : JMP 0x0059ff5d

PROGRAM  : Maestia.exe
FUNCTION : FUN_0093ea70
ENTRY    : 0093ea70
BODY     : [[0093ea70, 0093ec3d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0093ea70(int param_1,short param_2)

{
  int *piVar1;
  int *in_ECX;
  uint local_3c;
  undefined1 local_30 [4];
  undefined4 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b38ac7;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (param_1 == 0) {
    FUN_008018d0();
    goto LAB_0093ec20;
  }
  FUN_00406460();
  local_8 = 0;
  (**(code **)(*in_ECX + 0x58))();
  FUN_00405eb0(local_30,0,0xffffffff);
  local_8 = local_8 & 0xffffff00;
  FUN_008f75f0();
  local_8._0_1_ = 2;
  FUN_00405eb0();
  local_8 = (uint)local_8._1_3_ << 8;
  if (7 < local_3c) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  piVar1 = (int *)FUN_008eb500();
  if (piVar1 != (int *)0x0) {
    *(short *)(piVar1 + 0x1c) = 4 - param_2;
    switch(4 - param_2) {
    case 0:
      break;
    case 1:
      break;
    case 2:
      break;
    case 3:
      break;
    case 4:
      break;
    default:
      goto switchD_0093eb7c_default;
    }
    (**(code **)(*piVar1 + 0x90))();
switchD_0093eb7c_default:
    (**(code **)(**(int **)(*DAT_00da9894 + 0x114) + 4))();
  }
  FUN_009930d0();
  local_8 = 0xffffffff;
  if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_18 = 7;
  local_1c = 0;
  local_2c = (uint)local_2c._2_2_ << 0x10;
LAB_0093ec20:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0093ea70 : PUSH EBP
0093ea71 : MOV EBP,ESP
0093ea73 : PUSH -0x1
0093ea75 : PUSH 0xb38ac7
0093ea7a : MOV EAX,FS:[0x0]
0093ea80 : PUSH EAX
0093ea81 : SUB ESP,0x44
0093ea84 : MOV EAX,[0x00d66fa0]
0093ea89 : XOR EAX,EBP
0093ea8b : MOV dword ptr [EBP + -0x10],EAX
0093ea8e : PUSH EBX
0093ea8f : PUSH ESI
0093ea90 : PUSH EDI
0093ea91 : PUSH EAX
0093ea92 : LEA EAX,[EBP + -0xc]
0093ea95 : MOV FS:[0x0],EAX
0093ea9b : MOV EBX,dword ptr [EBP + 0x8]
0093ea9e : MOV EDI,ECX
0093eaa0 : MOV dword ptr [EBP + -0x30],EDI
0093eaa3 : TEST EBX,EBX
0093eaa5 : JNZ 0x0093eabf
0093eaa7 : MOV ESI,dword ptr [0x00da98e8]
0093eaad : PUSH 0xc713c0
0093eab2 : CALL 0x008018d0
0093eab7 : ADD ESP,0x4
0093eaba : JMP 0x0093ec20
0093eabf : MOV ESI,dword ptr [EBX + 0x10]
0093eac2 : PUSH 0xc713fc
0093eac7 : LEA ECX,[EBP + -0x2c]
0093eaca : CALL 0x00406460
0093eacf : MOV dword ptr [EBP + -0x4],0x0
0093ead6 : MOV EAX,dword ptr [EDI]
0093ead8 : MOV EDX,dword ptr [EAX + 0x58]
0093eadb : LEA ECX,[EBP + -0x2c]
0093eade : PUSH ECX
0093eadf : PUSH ESI
0093eae0 : MOV ECX,EDI
0093eae2 : CALL EDX
0093eae4 : SUB ESP,0x1c
0093eae7 : MOV ECX,ESP
0093eae9 : MOV dword ptr [EBP + -0x34],ESP
0093eaec : PUSH -0x1
0093eaee : XOR ESI,ESI
0093eaf0 : PUSH ESI
0093eaf1 : LEA EDX,[EBP + -0x2c]
0093eaf4 : MOV EDI,0x7
0093eaf9 : XOR EAX,EAX
0093eafb : MOV dword ptr [ECX + 0x18],EDI
0093eafe : MOV dword ptr [ECX + 0x14],ESI
0093eb01 : PUSH EDX
0093eb02 : MOV word ptr [ECX + 0x4],AX
0093eb06 : CALL 0x00405eb0
0093eb0b : MOV byte ptr [EBP + -0x4],0x1
0093eb0f : MOV byte ptr [EBP + -0x4],0x0
0093eb13 : LEA ECX,[EBP + -0x50]
0093eb16 : CALL 0x008f75f0
0093eb1b : ADD ESP,0x1c
0093eb1e : MOV byte ptr [EBP + -0x4],0x2
0093eb22 : PUSH -0x1
0093eb24 : PUSH ESI
0093eb25 : PUSH EAX
0093eb26 : LEA ECX,[EBP + -0x2c]
0093eb29 : CALL 0x00405eb0
0093eb2e : MOV byte ptr [EBP + -0x4],0x0
0093eb32 : CMP dword ptr [EBP + -0x38],0x8
0093eb36 : JC 0x0093eb40
0093eb38 : MOV ECX,dword ptr [EBP + -0x4c]
0093eb3b : CALL 0x006f04e0
0093eb40 : MOV ECX,dword ptr [0x00da9894]
0093eb46 : XOR EAX,EAX
0093eb48 : MOV dword ptr [EBP + -0x38],EDI
0093eb4b : MOV EDI,dword ptr [EBX + 0xc]
0093eb4e : MOV word ptr [EBP + -0x4c],AX
0093eb52 : MOV dword ptr [EBP + -0x3c],ESI
0093eb55 : MOV EAX,dword ptr [ECX]
0093eb57 : CALL 0x008eb500
0093eb5c : MOV EDI,dword ptr [EBP + 0xc]
0093eb5f : MOV ESI,EAX
0093eb61 : TEST ESI,ESI
0093eb63 : JZ 0x0093ebe9
0093eb69 : MOV EAX,0x4
0093eb6e : SUB EAX,EDI
0093eb70 : MOV word ptr [ESI + 0x70],AX
0093eb74 : MOVZX EAX,AX
0093eb77 : CMP EAX,0x4
0093eb7a : JA 0x0093ebb0
0093eb7c : JMP dword ptr [EAX*0x4 + 0x93ec40]
0093eb83 : PUSH 0x301
0093eb88 : JMP 0x0093eba4
0093eb8a : PUSH 0x302
0093eb8f : JMP 0x0093eba4
0093eb91 : PUSH 0x303
0093eb96 : JMP 0x0093eba4
0093eb98 : PUSH 0x304
0093eb9d : JMP 0x0093eba4
0093eb9f : PUSH 0x305
0093eba4 : MOV EDX,dword ptr [ESI]
0093eba6 : MOV EAX,dword ptr [EDX + 0x90]
0093ebac : MOV ECX,ESI
0093ebae : CALL EAX
0093ebb0 : CMP dword ptr [EBP + -0x14],0x8
0093ebb4 : MOV ECX,dword ptr [0x00da9894]
0093ebba : MOV EAX,dword ptr [ECX]
0093ebbc : MOV EAX,dword ptr [EAX + 0x114]
0093ebc2 : MOV ECX,dword ptr [EBP + -0x28]
0093ebc5 : JNC 0x0093ebca
0093ebc7 : LEA ECX,[EBP + -0x28]
0093ebca : MOVZX ESI,word ptr [ESI + 0x72]
0093ebce : MOV EDX,dword ptr [EAX]
0093ebd0 : PUSH ESI
0093ebd1 : MOVZX ESI,DI
0093ebd4 : PUSH ESI
0093ebd5 : PUSH ECX
0093ebd6 : PUSH 0xc71400
0093ebdb : PUSH 0xc7140c
0093ebe0 : PUSH EAX
0093ebe1 : MOV EAX,dword ptr [EDX + 0x4]
0093ebe4 : CALL EAX
0093ebe6 : ADD ESP,0x18
0093ebe9 : MOV ECX,dword ptr [EBP + 0x10]
0093ebec : PUSH ECX
0093ebed : MOV ECX,dword ptr [EBP + -0x30]
0093ebf0 : PUSH EDI
0093ebf1 : PUSH EBX
0093ebf2 : CALL 0x009930d0
0093ebf7 : MOV dword ptr [EBP + -0x4],0xffffffff
0093ebfe : CMP dword ptr [EBP + -0x14],0x8
0093ec02 : JC 0x0093ec0c
0093ec04 : MOV ECX,dword ptr [EBP + -0x28]
0093ec07 : CALL 0x006f04e0
0093ec0c : XOR EDX,EDX
0093ec0e : MOV dword ptr [EBP + -0x14],0x7
0093ec15 : MOV dword ptr [EBP + -0x18],0x0
0093ec1c : MOV word ptr [EBP + -0x28],DX
0093ec20 : MOV ECX,dword ptr [EBP + -0xc]
0093ec23 : MOV dword ptr FS:[0x0],ECX
0093ec2a : POP ECX
0093ec2b : POP EDI
0093ec2c : POP ESI
0093ec2d : POP EBX
0093ec2e : MOV ECX,dword ptr [EBP + -0x10]
0093ec31 : XOR ECX,EBP
0093ec33 : CALL 0x00633e6b
0093ec38 : MOV ESP,EBP
0093ec3a : POP EBP
0093ec3b : RET 0xc

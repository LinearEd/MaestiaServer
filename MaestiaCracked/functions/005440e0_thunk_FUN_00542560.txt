PROGRAM  : Maestia.exe
FUNCTION : thunk_FUN_00542560
ENTRY    : 005440e0
BODY     : [[005440e0, 005440e4]]

============================================================
DECOMPILED C CODE
============================================================

undefined4
thunk_FUN_00542560(ushort *param_1,int param_2,int *param_3,char param_4,char param_5,int param_6)

{
  short sVar1;
  ushort uVar2;
  char cVar3;
  ushort uVar4;
  int iVar5;
  undefined4 uVar6;
  undefined4 *puVar7;
  GRefCountNTSImpl *this;
  uint uVar8;
  int *piVar9;
  uint uVar10;
  int iVar11;
  short *psVar12;
  int in_ECX;
  undefined ***pppuVar13;
  int iVar14;
  undefined ***pppuVar15;
  uint uVar16;
  undefined4 uVar17;
  undefined4 uVar18;
  int iStack_3bc;
  undefined4 uStack_3b4;
  undefined4 uStack_3b0;
  int iStack_3ac;
  int iStack_3a8;
  undefined4 uStack_3a4;
  int *piStack_3a0;
  uint uStack_39c;
  int iStack_398;
  int *piStack_394;
  short *psStack_390;
  int iStack_38c;
  int iStack_388;
  undefined4 uStack_384;
  undefined4 uStack_380;
  int iStack_37c;
  undefined4 uStack_378;
  undefined1 uStack_372;
  undefined1 uStack_371;
  undefined4 uStack_370;
  undefined1 uStack_36a;
  undefined1 uStack_369;
  int *piStack_368;
  undefined4 uStack_364;
  ushort *puStack_360;
  ushort *puStack_35c;
  ushort *puStack_358;
  uint uStack_354;
  undefined1 uStack_350;
  undefined4 uStack_34c;
  undefined4 uStack_348;
  undefined4 uStack_344;
  undefined1 uStack_340;
  undefined4 uStack_33c;
  undefined4 uStack_338;
  undefined4 uStack_334;
  undefined4 uStack_330;
  undefined4 uStack_32c;
  undefined4 uStack_328;
  undefined4 uStack_324;
  undefined4 uStack_320;
  undefined4 uStack_31c;
  undefined4 uStack_318;
  undefined4 uStack_314;
  undefined4 uStack_310;
  undefined4 uStack_30c;
  undefined4 uStack_308;
  int iStack_304;
  undefined **ppuStack_300;
  undefined4 uStack_2fc;
  undefined1 auStack_2f8 [4];
  undefined4 uStack_2f4;
  undefined1 auStack_2f0 [8];
  int iStack_2e8;
  int *piStack_2e4;
  undefined4 uStack_2e0;
  undefined2 uStack_2dc;
  undefined2 uStack_2da;
  undefined1 uStack_2d8;
  uint uStack_2d6;
  short *psStack_2d0;
  int iStack_2cc;
  int iStack_2c8;
  undefined2 auStack_2c4 [2];
  undefined4 uStack_2c0;
  int iStack_2bc;
  uint uStack_2b8;
  int iStack_2b4;
  undefined4 uStack_2b0;
  undefined4 uStack_2ac;
  undefined2 auStack_2a8 [2];
  undefined4 uStack_2a4;
  undefined4 uStack_2a0;
  uint uStack_29c;
  undefined4 uStack_298;
  int iStack_294;
  int iStack_290;
  int iStack_28c;
  int iStack_288;
  undefined **ppuStack_284;
  undefined4 uStack_280;
  int iStack_26c;
  int *piStack_268;
  undefined4 uStack_264;
  undefined2 uStack_260;
  undefined2 uStack_25e;
  undefined1 uStack_25c;
  undefined2 uStack_25a;
  undefined **appuStack_258 [6];
  undefined1 auStack_240 [44];
  undefined1 auStack_214 [24];
  undefined1 auStack_1fc [24];
  undefined1 auStack_1e4 [24];
  undefined1 auStack_1cc [84];
  undefined **appuStack_178 [6];
  undefined1 auStack_160 [44];
  undefined1 auStack_134 [44];
  undefined1 auStack_108 [44];
  undefined1 auStack_dc [44];
  undefined1 auStack_b0 [44];
  undefined1 auStack_84 [44];
  undefined1 auStack_58 [88];
  
  piStack_3a0 = (int *)FUN_00515dd0(in_ECX);
  puStack_358 = param_1 + param_2;
  iStack_3ac = 0;
  iStack_3a8 = 0;
  uStack_3a4 = 0;
  uStack_364 = 0;
  puStack_35c = param_1;
  uStack_354 = 0;
  uStack_350 = 0;
  puStack_360 = param_1;
  if (param_1 < puStack_358) {
    uStack_354 = (uint)*param_1;
    puStack_35c = param_1 + 1;
  }
  uStack_340 = param_5 != '\0';
  uStack_34c = 0;
  uStack_348 = 0;
  uStack_344 = 0;
  iVar5 = *(int *)(in_ECX + 0x1c);
  uStack_2fc = 1;
  ppuStack_300 = &PTR_FUN_00b86530;
  iStack_37c = 0;
  iStack_398 = 0;
  uStack_36a = 0;
  piStack_394 = piStack_3a0;
  piStack_368 = piStack_3a0;
  FUN_0051c380(iVar5 + 8,*(undefined4 *)(iVar5 + 0xc));
  uStack_371 = 0;
  FUN_0051c380(iVar5 + 0x10,*(undefined4 *)(iVar5 + 0xc));
  if (*(int *)(iVar5 + 0x18) != 0) {
    piVar9 = (int *)(*(int *)(iVar5 + 0x18) + 4);
    *piVar9 = *piVar9 + 1;
  }
  iStack_2e8 = *(int *)(iVar5 + 0x18);
  piVar9 = *(int **)(iVar5 + 0x1c);
  if (piVar9 != (int *)0x0) {
    *piVar9 = *piVar9 + 1;
  }
  piStack_2e4 = *(int **)(iVar5 + 0x1c);
  uStack_2e0 = *(undefined4 *)(iVar5 + 0x20);
  uStack_2dc = *(undefined2 *)(iVar5 + 0x24);
  uStack_2da = *(undefined2 *)(iVar5 + 0x26);
  uStack_2d8 = *(undefined1 *)(iVar5 + 0x28);
  uStack_2d6 = CONCAT22(uStack_2d6._2_2_,*(undefined2 *)(iVar5 + 0x2a));
  FUN_0053c1c0(*(undefined4 *)(in_ECX + 0x18));
  if (((uStack_2d6 & 0x100) == 0) || (iVar5 = FUN_0051b1a0(), iVar5 == 0)) {
    FUN_0055e660(&DAT_00cca874,0xffffffff);
    FUN_0053f7c0(&ppuStack_300);
  }
  uStack_280 = 1;
  ppuStack_284 = &PTR_FUN_00b86530;
  uStack_372 = 0;
  FUN_0051c380(auStack_2f8,uStack_2f4);
  uStack_369 = 0;
  FUN_0051c380(auStack_2f0,uStack_2f4);
  if (iStack_2e8 != 0) {
    *(int *)(iStack_2e8 + 4) = *(int *)(iStack_2e8 + 4) + 1;
  }
  iStack_26c = iStack_2e8;
  if (piStack_2e4 != (int *)0x0) {
    *piStack_2e4 = *piStack_2e4 + 1;
  }
  piStack_268 = piStack_2e4;
  uStack_260 = uStack_2dc;
  uStack_264 = uStack_2e0;
  uStack_25e = uStack_2da;
  uStack_25c = uStack_2d8;
  uStack_25a = (undefined2)uStack_2d6;
  iVar5 = FUN_0053d5c0();
  if (iVar5 == 0x8000) {
LAB_00542806:
    FUN_0053f7c0(&ppuStack_300);
    if (*(int *)(in_ECX + 8) == 0) {
      uVar6 = FUN_00515dd0(in_ECX);
      puVar7 = (undefined4 *)FUN_00515840(0x50,0);
      if (puVar7 == (undefined4 *)0x0) {
        puVar7 = (undefined4 *)0x0;
      }
      else {
        *puVar7 = &PTR_FUN_00cd3f2c;
        puVar7[1] = 1;
        *puVar7 = &PTR_FUN_00b8670c;
        puVar7[2] = 0;
        puVar7[3] = 0;
        puVar7[6] = 1;
        puVar7[4] = 100;
        puVar7[5] = 100;
        puVar7[7] = uVar6;
        FUN_00504200(uVar6);
        *(undefined1 *)(puVar7 + 0x13) = 0;
      }
      if (*(GRefCountNTSImpl **)(in_ECX + 8) != (GRefCountNTSImpl *)0x0) {
        GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(in_ECX + 8));
      }
      *(undefined4 **)(in_ECX + 8) = puVar7;
    }
    pppuVar15 = appuStack_258;
  }
  else {
    do {
      if (iVar5 == 1) break;
      if (4 < iVar5) {
        if (iVar5 != 0x8005) goto LAB_00542eaa;
LAB_00543a3d:
        puVar7 = (undefined4 *)0x0;
        uStack_370 = 0;
        uStack_378 = 0;
        if (iVar5 == 4) {
          if (iStack_3a8 != 0) {
            puVar7 = (undefined4 *)(iStack_3a8 * 0x54 + -0x54 + iStack_3ac);
          }
          FUN_0053dbc0(&uStack_370,&uStack_378);
        }
        else {
          if (((iStack_37c != 0) && (*(char *)(iStack_37c + 9) != '\0')) || (iStack_3a8 == 0))
          goto LAB_00542eaa;
          iVar11 = iStack_3a8 * 0x54;
          uStack_370 = *(undefined4 *)(iVar11 + -0x54 + iStack_3ac);
          uStack_378 = *(undefined4 *)(iVar11 + -0x50 + iStack_3ac);
          puVar7 = (undefined4 *)(iVar11 + -0x54 + iStack_3ac);
        }
        uVar17 = uStack_370;
        uVar6 = uStack_378;
        if (puVar7 != (undefined4 *)0x0) {
          iVar11 = FUN_0053c030(uStack_370,uStack_378,*puVar7,puVar7[1]);
          if (iVar11 == 0) {
LAB_00543b67:
            uVar2 = *(ushort *)((int)puVar7 + 0x52);
            iVar11 = puVar7[2];
            iVar14 = puVar7[3];
            uVar4 = uVar2 >> 0xb & 3;
            iStack_37c = iVar11;
            FUN_0053f990(iStack_3a8 + -1);
            if (iVar11 == 0) {
              if ((param_6 != 0) && ((uVar2 & 0x100) != 0)) {
                if (uVar4 == 1) goto LAB_00543bbd;
                if (uVar4 == 2) {
                  iVar5 = FUN_0053c470();
                  if (param_4 != '\0') {
                    uVar18 = 1;
                    uVar17 = 1;
                    uVar6 = FUN_0053b3c0(1,1);
                    FUN_00541fd0(uVar6,uVar17,uVar18);
                  }
                  FUN_00542320(iVar14,iVar5 - iVar14);
                }
              }
            }
            else if ((*(int *)(iVar11 + 4) == 6) ||
                    ((*(int *)(iVar11 + 4) == 7 && (iStack_398 = iStack_398 + -1, iVar5 != 0x8005)))
                    ) {
LAB_00543bbd:
              if (param_4 != '\0') {
                uVar18 = 1;
                uVar17 = 1;
                uVar6 = FUN_0053b3c0(1,1);
                FUN_00541fd0(uVar6,uVar17,uVar18);
              }
            }
          }
          else {
            iVar11 = FUN_0053c670(uVar17,uVar6,&PTR_DAT_00b8bc88,0xd);
            if ((((iVar11 != 0) && (iStack_398 != 0)) &&
                ((*(int *)(iVar11 + 4) == 7 || (*(int *)(iVar11 + 4) == 6)))) && (iStack_3a8 != 0))
            {
              do {
                iVar14 = *(int *)(iStack_3a8 * 0x54 + iStack_3ac + -0x4c);
                if ((iVar14 != 0) && (*(int *)(iVar11 + 4) == *(int *)(iVar14 + 4))) {
                  if (iStack_3a8 != 0) {
                    puVar7 = (undefined4 *)(iStack_3a8 * 0x54 + -0x54 + iStack_3ac);
                    goto LAB_00543b67;
                  }
                  break;
                }
                FUN_0053f990(iStack_3a8 + -1);
              } while (iStack_3a8 != 0);
              goto switchD_00542f57_caseD_2;
            }
          }
        }
        goto LAB_00542eaa;
      }
      if (iVar5 == 4) goto LAB_00543a3d;
      if (iVar5 != 2) {
        if (((iVar5 == 3) &&
            (cVar3 = FUN_0053dc30(&psStack_2d0,&uStack_29c), uVar10 = uStack_29c,
            psVar12 = psStack_2d0, cVar3 != '\0')) && (uStack_29c != 0)) {
          if (((param_5 != '\0') && (uStack_29c < 2)) && (*psStack_2d0 == 0x20)) {
            FUN_0053c2b0();
            iVar5 = FUN_0053b4b0();
            if (iVar5 == 0) goto LAB_00542eaa;
          }
          if (iStack_3a8 == 0) {
            FUN_00541ff0(psVar12,uVar10,1);
          }
          else {
            iVar11 = iStack_3a8 * 0x54 + -0x54 + iStack_3ac;
            iVar5 = iVar11 + 0x10;
            FUN_00541ed0(psVar12,uVar10,iVar5,iVar11 + 0x3c);
            FUN_00504700(iVar5);
          }
        }
        goto LAB_00542eaa;
      }
      FUN_0053db30(&uStack_380,&uStack_384);
      uVar17 = uStack_380;
      uVar6 = uStack_384;
      iVar5 = FUN_0053c670(uStack_380,uStack_384,&PTR_DAT_00b8bc88,0xd);
      iVar11 = iStack_3a8 + -1;
      iStack_37c = iVar5;
      if ((iVar5 != 0) && (*(char *)(iVar5 + 9) != '\0')) {
        iVar5 = *(int *)(iVar5 + 4);
        if (iVar5 != 2) {
          if (iVar5 == 5) {
            if (param_3 != (int *)0x0) {
              uVar6 = FUN_0053ba30(piStack_394);
              FUN_0053f4a0(uVar6);
              FUN_00502110();
              puVar7 = (undefined4 *)(param_3[1] * 0x2c + -0x2c + *param_3);
              iVar5 = FUN_0053c2b0();
              if (iVar5 == 0) {
                iVar5 = FUN_00540b60(appuStack_258);
              }
              FUN_00504200(uStack_2f4);
              puVar7[9] = *(undefined4 *)(iVar5 + 0x20);
              cVar3 = FUN_0053d850(&uStack_310,&uStack_314);
              while (cVar3 != '\0') {
                iVar5 = FUN_0053c670(uStack_310,uStack_314,&PTR_s_ALIGN_00b8bb40,0x1b);
                if ((iVar5 != 0) && (cVar3 = FUN_0053d910(&uStack_3b0,&uStack_3b4), cVar3 != '\0'))
                {
                  switch(*(undefined4 *)(iVar5 + 4)) {
                  case 0xc:
                    iVar5 = FUN_0053c670(uStack_3b0,uStack_3b4,&PTR_s_ALIGN_00b8bb40,0x1b);
                    if (iVar5 != 0) {
                      iVar5 = *(int *)(iVar5 + 4);
                      if (iVar5 == 0xe) {
                        *(undefined1 *)(puVar7 + 10) = 0;
                      }
                      else if (iVar5 == 0x23) {
                        *(undefined1 *)(puVar7 + 10) = 2;
                      }
                      else if (iVar5 == 0x24) {
                        *(undefined1 *)(puVar7 + 10) = 1;
                      }
                    }
                    break;
                  case 0x13:
                    cVar3 = FUN_0053b640(&iStack_2c8,uStack_3b0,uStack_3b4);
                    if ((cVar3 != '\0') && (-1 < iStack_2c8)) {
                      puVar7[6] = iStack_2c8 * 0x14;
                    }
                    break;
                  case 0x15:
                    cVar3 = FUN_0053b640(&iStack_288,uStack_3b0,uStack_3b4);
                    if (cVar3 != '\0') {
                      puVar7[8] = iStack_288 * 0x14;
                    }
                    break;
                  case 0x16:
                    FUN_0051b8a0(uStack_3b0,uStack_3b4);
                    break;
                  case 0x1d:
                    FUN_0051b8a0(uStack_3b0,uStack_3b4);
                    break;
                  case 0x21:
                    cVar3 = FUN_0053b640(&iStack_294,uStack_3b0,uStack_3b4);
                    if (cVar3 != '\0') {
                      puVar7[7] = iStack_294 * 0x14;
                    }
                    break;
                  case 0x22:
                    cVar3 = FUN_0053b640(&iStack_28c,uStack_3b0,uStack_3b4);
                    if ((cVar3 != '\0') && (-1 < iStack_28c)) {
                      puVar7[5] = iStack_28c * 0x14;
                    }
                  }
                }
                cVar3 = FUN_0053d850(&uStack_310,&uStack_314);
              }
              iVar5 = FUN_0053b550(0x50,in_ECX);
              if (iVar5 == 0) {
                this = (GRefCountNTSImpl *)0x0;
              }
              else {
                this = (GRefCountNTSImpl *)FUN_0053c0e0();
              }
              FUN_0053b9c0(this);
              *(undefined4 *)(this + 0x18) = puVar7[5];
              *(undefined4 *)(this + 0x1c) = puVar7[6];
              *(undefined4 *)(this + 0x40) = puVar7[7];
              *(undefined4 *)(this + 0x44) = puVar7[8];
              FUN_0051bc20(puVar7 + 1);
              FUN_0051bc20(puVar7 + 3);
              this[0x4c] = *(GRefCountNTSImpl *)(puVar7 + 10);
              *(int *)(this + 4) = *(int *)(this + 4) + 1;
              if ((GRefCountNTSImpl *)*puVar7 != (GRefCountNTSImpl *)0x0) {
                GRefCountNTSImpl::Release((GRefCountNTSImpl *)*puVar7);
              }
              *puVar7 = this;
              if (iVar11 < 0) {
                pppuVar15 = &ppuStack_300;
                pppuVar13 = appuStack_258;
              }
              else {
                iVar5 = iVar11 * 0x54 + iStack_3ac;
                pppuVar15 = (undefined ***)(iVar5 + 0x10);
                pppuVar13 = (undefined ***)(iVar5 + 0x3c);
              }
              cVar3 = FUN_0050a3a0();
              if (cVar3 != '\0') {
                FUN_0055e700(pppuVar15 + 4);
              }
              FUN_00540fa0(&DAT_00b8bb3c,1,1,auStack_240,pppuVar13);
              if ((GRefCountNTSImpl *)pppuVar15[6] != (GRefCountNTSImpl *)0x0) {
                GRefCountNTSImpl::Release((GRefCountNTSImpl *)pppuVar15[6]);
              }
              pppuVar15[6] = (undefined **)0x0;
              *(ushort *)((int)pppuVar15 + 0x2a) = *(ushort *)((int)pppuVar15 + 0x2a) | 0x200;
              FUN_0053f7c0(pppuVar15);
              GRefCountNTSImpl::Release(this);
              FUN_00504260();
            }
          }
          else if (iVar5 == 9) {
            FUN_00540fa0(&DAT_00b8bc84,1,1,*(undefined4 *)(in_ECX + 0x1c),
                         *(undefined4 *)(in_ECX + 0x18));
          }
          goto LAB_00542eaa;
        }
        goto LAB_00543bbd;
      }
      uVar18 = FUN_0053c470();
      uVar6 = FUN_0053e1a0(piStack_394,uVar17,uVar6,iVar5,0);
      FUN_0053f650(piStack_3a0,iStack_3a8 + 1);
      iVar14 = iStack_3ac;
      iVar5 = iStack_3a8 * 0x54 + -0x54 + iStack_3ac;
      if (iVar5 != 0) {
        FUN_0053e210(uVar6);
      }
      appuStack_178[0] = &PTR_FUN_00b86064;
      FUN_0055e7c0();
      GRefCountImplCore::~GRefCountImplCore((GRefCountImplCore *)appuStack_178);
      FUN_00504260();
      *(undefined4 *)(iVar5 + 0xc) = uVar18;
      if (iVar11 < 0) {
        FUN_00504700(&ppuStack_300);
        pppuVar15 = appuStack_258;
      }
      else {
        iVar14 = iVar11 * 0x54 + iVar14;
        FUN_00504700(iVar14 + 0x10);
        pppuVar15 = (undefined ***)(iVar14 + 0x3c);
      }
      iVar11 = iVar5 + 0x3c;
      FUN_0055ee10(pppuVar15);
      if (iStack_37c == 0) {
        if ((param_6 != 0) && (iVar5 = FUN_0057df30(0,uStack_380,uStack_384), iVar5 != 0)) {
          uVar6 = FUN_0055f330(auStack_1fc,iVar5 + 0x2c);
          FUN_0055ee10(uVar6);
          FUN_005008c0();
          uVar6 = FUN_0055fca0(auStack_84,iVar5);
          FUN_00504700(uVar6);
LAB_00542ea1:
          FUN_00504260();
        }
        goto switchD_00542f57_caseD_2;
      }
      switch(*(undefined4 *)(iStack_37c + 4)) {
      case 0:
        cVar3 = FUN_0053d850(&uStack_334,&uStack_308);
        while (cVar3 != '\0') {
          iVar5 = FUN_0053c670(uStack_334,uStack_308,&PTR_s_ALIGN_00b8bb40,0x1b);
          if (((iVar5 != 0) && (cVar3 = FUN_0053d910(&uStack_2a0,&uStack_2c0), cVar3 != '\0')) &&
             (*(int *)(iVar5 + 4) == 0x14)) {
            FUN_0055e6b0(uStack_2a0,uStack_2c0);
            *(byte *)(in_ECX + 0x20) = *(byte *)(in_ECX + 0x20) | 1;
          }
          cVar3 = FUN_0053d850(&uStack_334,&uStack_308);
        }
        if (param_6 != 0) {
          iVar5 = FUN_0057dec0(0,&DAT_00b8653c,0xffffffff);
          if (iVar5 != 0) {
            uVar6 = FUN_0055fca0(auStack_160,iVar5);
            FUN_00504700(uVar6);
            FUN_00504260();
          }
          cVar3 = FUN_0050a3a0();
          if ((cVar3 != '\0') && (iVar5 = FUN_0057dec0(0,"a:link",0xffffffff), iVar5 != 0)) {
            uVar6 = FUN_0055fca0(auStack_108,iVar5);
            FUN_00504700(uVar6);
            goto LAB_00542ea1;
          }
        }
        break;
      case 1:
        FUN_0055fbc0(1);
        break;
      case 3:
        cVar3 = FUN_0053d850(&uStack_338,&uStack_31c);
        while (cVar3 != '\0') {
          iVar11 = FUN_0053c670(uStack_338,uStack_31c,&PTR_s_ALIGN_00b8bb40,0x1b);
          if ((iVar11 != 0) && (cVar3 = FUN_0053d910(&psStack_390,&iStack_388), cVar3 != '\0')) {
            switch(*(undefined4 *)(iVar11 + 4)) {
            case 0xd:
              if ((*psStack_390 == 0x23) &&
                 (cVar3 = FUN_0053bd50(&uStack_298,psStack_390 + 1,iStack_388 + -1), cVar3 != '\0'))
              {
                FUN_0053b2f0(uStack_298);
              }
              break;
            case 0x11:
              if ((*psStack_390 == 0x23) &&
                 (cVar3 = FUN_0053bd50(&uStack_2b8,psStack_390 + 1,iStack_388 + -1), cVar3 != '\0'))
              {
                *(uint *)(iVar5 + 0x30) =
                     *(uint *)(iVar5 + 0x30) ^ (*(uint *)(iVar5 + 0x30) ^ uStack_2b8) & 0xffffff;
                *(ushort *)(iVar5 + 0x3a) = *(ushort *)(iVar5 + 0x3a) | 1;
              }
              break;
            case 0x12:
              FUN_0055fa20(psStack_390,iStack_388);
              break;
            case 0x18:
              cVar3 = FUN_0053b640(&iStack_290,psStack_390,iStack_388);
              if ((cVar3 != '\0') && (-1 < iStack_290)) {
                if (iStack_290 == 0) {
                  *(byte *)(iVar5 + 0x38) = *(byte *)(iVar5 + 0x38) & 0xf7;
                  *(ushort *)(iVar5 + 0x3a) = *(ushort *)(iVar5 + 0x3a) & 0xff7f;
                }
                else {
                  FUN_0055e740(1);
                }
              }
              break;
            case 0x1b:
              cVar3 = FUN_0053b6d0(&uStack_2b0,psStack_390,iStack_388);
              if (cVar3 != '\0') {
                FUN_0053b940(uStack_2b0);
              }
              break;
            case 0x1e:
              cVar3 = FUN_0053b640(&iStack_304,psStack_390,iStack_388);
              if ((cVar3 != '\0') && (-1 < iStack_304)) {
                FUN_0053b960((float)iStack_304);
              }
            }
          }
          cVar3 = FUN_0053d850(&uStack_338,&uStack_31c);
        }
        break;
      case 4:
        FUN_0055fc30(1);
        break;
      case 6:
        *(ushort *)(iVar5 + 0x52) = *(ushort *)(iVar5 + 0x52) | 0x8080;
        iVar5 = FUN_0053c2b0();
        if (iVar5 == 0) {
          FUN_00540b60(iVar11);
        }
        else {
          iVar5 = FUN_0053b4b0();
          if (iVar5 != 0) {
            if (param_4 != '\0') {
              uVar18 = 1;
              uVar17 = 1;
              uVar6 = FUN_0053b3c0(1,1);
              FUN_00541fd0(uVar6,uVar17,uVar18);
            }
            FUN_0053c2b0();
          }
          iVar5 = iVar11;
          uVar6 = FUN_0053f720(iVar11);
          FUN_0053c230(uVar6,iVar5);
        }
        if ((param_6 == 0) || (iVar5 = FUN_0057df30(0,uStack_380,uStack_384), iVar5 == 0)) break;
        uVar6 = FUN_0055f330(auStack_214,iVar5 + 0x2c);
        FUN_0055ee10(uVar6);
        FUN_005008c0();
        uVar6 = FUN_0055fca0(auStack_58,iVar5);
        FUN_00504700(uVar6);
        FUN_00504260();
        uVar6 = FUN_0053f720(iVar11);
        FUN_0053c230(uVar6,iVar11);
        goto LAB_00542eaa;
      case 7:
        iVar5 = FUN_0053c2b0();
        if (iVar5 == 0) {
          FUN_00540b60(0);
        }
        else if (iStack_398 != 0) {
          if (param_4 != '\0') {
            uVar18 = 1;
            uVar17 = 1;
            uVar6 = FUN_0053b3c0(1,1);
            FUN_00541fd0(uVar6,uVar17,uVar18);
          }
          FUN_0053c2b0();
        }
        if ((param_6 != 0) && (iVar5 = FUN_0057df30(0,uStack_380,uStack_384), iVar5 != 0)) {
          uVar6 = FUN_0055f330(auStack_1cc,iVar5 + 0x2c);
          FUN_0055ee10(uVar6);
          FUN_005008c0();
          uVar6 = FUN_0055fca0(auStack_b0,iVar5);
          FUN_00504700(uVar6);
          FUN_00504260();
        }
        cVar3 = FUN_0053d850(&uStack_324,&uStack_33c);
        while (cVar3 != '\0') {
          iVar5 = FUN_0053c670(uStack_324,uStack_33c,&PTR_s_ALIGN_00b8bb40,0x1b);
          if ((iVar5 != 0) && (cVar3 = FUN_0053d910(&uStack_32c,&uStack_30c), cVar3 != '\0')) {
            if (*(int *)(iVar5 + 4) == 0xc) {
              iVar5 = FUN_0053c670(uStack_32c,uStack_30c,&PTR_s_ALIGN_00b8bb40,0x1b);
              if (iVar5 != 0) {
                switch(*(undefined4 *)(iVar5 + 4)) {
                case 0x23:
                  uVar6 = 0;
                  break;
                case 0x24:
                  uVar6 = 1;
                  break;
                case 0x25:
                  uVar6 = 3;
                  break;
                case 0x26:
                  uVar6 = 2;
                  break;
                default:
                  goto switchD_005433b0_default;
                }
                FUN_004ffe10(uVar6);
              }
            }
            else if (((*(int *)(iVar5 + 4) == 0x10) && (param_6 != 0)) &&
                    (iVar5 = FUN_0057df30(1,uStack_32c,uStack_30c), iVar5 != 0)) {
              uVar6 = FUN_0055f330(auStack_1e4,iVar5 + 0x2c);
              FUN_0055ee10(uVar6);
              FUN_005008c0();
              uVar6 = FUN_0055fca0(auStack_134,iVar5);
              FUN_00504700(uVar6);
              FUN_00504260();
            }
          }
switchD_005433b0_default:
          cVar3 = FUN_0053d850(&uStack_324,&uStack_33c);
        }
        iVar5 = FUN_0053b4b0();
        if (iVar5 == 0) {
          uVar6 = FUN_0053f720(iVar11);
          FUN_0053c230(uVar6,iVar11);
        }
        iStack_398 = iStack_398 + 1;
        goto LAB_00542eaa;
      case 8:
        cVar3 = FUN_0053d850(&uStack_318,&uStack_320);
        while (cVar3 != '\0') {
          iVar5 = FUN_0053c670(uStack_318,uStack_320,&PTR_s_ALIGN_00b8bb40,0x1b);
          if ((((iVar5 != 0) && (cVar3 = FUN_0053d910(&uStack_2a4,&uStack_2ac), cVar3 != '\0')) &&
              (*(int *)(iVar5 + 4) == 0x10)) &&
             ((param_6 != 0 && (iVar5 = FUN_0057df30(1,uStack_2a4,uStack_2ac), iVar5 != 0)))) {
            uVar6 = FUN_0055fca0(auStack_dc,iVar5);
            FUN_00504700(uVar6);
            FUN_00504260();
          }
          cVar3 = FUN_0053d850(&uStack_318,&uStack_320);
        }
        break;
      case 10:
        cVar3 = FUN_0053d850(&uStack_328,&uStack_330);
        while (cVar3 != '\0') {
          iVar11 = FUN_0053c670(uStack_328,uStack_330,&PTR_s_ALIGN_00b8bb40,0x1b);
          if ((iVar11 != 0) &&
             (cVar3 = FUN_0053d910(&iStack_38c,&uStack_39c), iVar14 = iStack_38c,
             uVar10 = uStack_39c, cVar3 != '\0')) {
            switch(*(undefined4 *)(iVar11 + 4)) {
            case 0xf:
              cVar3 = FUN_0053b640(&iStack_2cc,iStack_38c,uStack_39c);
              if ((cVar3 != '\0') && (-1 < iStack_2cc)) {
                *(ushort *)(iVar5 + 0x52) = *(ushort *)(iVar5 + 0x52) | 2;
                *(short *)(iVar5 + 0x48) = (short)iStack_2cc;
              }
              break;
            case 0x17:
              cVar3 = FUN_0053b640(auStack_2a8,iStack_38c,uStack_39c);
              if (cVar3 != '\0') {
                *(ushort *)(iVar5 + 0x52) = *(ushort *)(iVar5 + 0x52) | 4;
                *(undefined2 *)(iVar5 + 0x4a) = auStack_2a8[0];
              }
              break;
            case 0x19:
              cVar3 = FUN_0053b640(auStack_2c4,iStack_38c,uStack_39c);
              if (cVar3 != '\0') {
                *(ushort *)(iVar5 + 0x52) = *(ushort *)(iVar5 + 0x52) | 8;
                *(undefined2 *)(iVar5 + 0x4c) = auStack_2c4[0];
              }
              break;
            case 0x1a:
              cVar3 = FUN_0053b640(&iStack_2bc,iStack_38c,uStack_39c);
              if ((cVar3 != '\0') && (-1 < iStack_2bc)) {
                *(ushort *)(iVar5 + 0x52) = *(ushort *)(iVar5 + 0x52) | 0x10;
                *(short *)(iVar5 + 0x4e) = (short)iStack_2bc;
              }
              break;
            case 0x1c:
              cVar3 = FUN_0053b640(&iStack_2b4,iStack_38c,uStack_39c);
              if ((cVar3 != '\0') && (-1 < iStack_2b4)) {
                *(ushort *)(iVar5 + 0x52) = *(ushort *)(iVar5 + 0x52) | 0x20;
                *(short *)(iVar5 + 0x50) = (short)iStack_2b4;
              }
              break;
            case 0x20:
              uVar16 = 0;
              if (uStack_39c != 0) {
                do {
                  cVar3 = FUN_0053b570(*(undefined2 *)(iVar14 + uVar16 * 2));
                  if (cVar3 == '\0') break;
                  uVar16 = uVar16 + 1;
                } while (uVar16 < uVar10);
              }
              if (*(short *)(iVar14 + uVar16 * 2) == 0x5b) {
                uVar16 = uVar16 + 1;
              }
              iVar11 = 1;
              for (uVar8 = uVar16;
                  (uVar8 < uVar10 && (sVar1 = *(short *)(iVar14 + uVar8 * 2), sVar1 != 0x5d));
                  uVar8 = uVar8 + 1) {
                if (sVar1 == 0x2c) {
                  iVar11 = iVar11 + 1;
                }
              }
              FUN_0053b370(iVar11);
              iStack_3bc = 0;
              if (uVar16 < uVar10) {
LAB_00543890:
                if (*(short *)(iVar14 + uVar16 * 2) != 0x5d) {
                  iVar11 = 0;
                  for (; uVar16 < uVar10; uVar16 = uVar16 + 1) {
                    cVar3 = FUN_0053b5d0(*(undefined2 *)(iVar14 + uVar16 * 2));
                    if (cVar3 == '\0') goto joined_r0x005438c6;
                    iVar11 = (*(ushort *)(iVar14 + uVar16 * 2) - 0x30) + iVar11 * 10;
                  }
                  goto LAB_005438e6;
                }
                break;
              }
            }
          }
switchD_005436da_caseD_10:
          cVar3 = FUN_0053d850(&uStack_328,&uStack_330);
        }
        break;
      case 0xb:
        FUN_0055e720(1);
      }
switchD_00542f57_caseD_2:
LAB_00542eaa:
      iVar5 = FUN_0053d5c0();
    } while (iVar5 != 0x8000);
    if (iStack_3a8 == 0) goto LAB_00542806;
    piVar9 = (int *)(iStack_3a8 * 0x54 + -0x54 + iStack_3ac);
    piStack_394 = piVar9;
    FUN_0053f7c0(piVar9 + 4);
    if (*(int *)(in_ECX + 8) == 0) {
      uVar6 = FUN_00515dd0(in_ECX);
      puVar7 = (undefined4 *)FUN_00515840(0x50,0);
      if (puVar7 == (undefined4 *)0x0) {
        puVar7 = (undefined4 *)0x0;
      }
      else {
        *puVar7 = &PTR_FUN_00cd3f2c;
        puVar7[1] = 1;
        *puVar7 = &PTR_FUN_00b8670c;
        puVar7[2] = 0;
        puVar7[3] = 0;
        puVar7[4] = 100;
        puVar7[5] = 100;
        puVar7[6] = 1;
        puVar7[7] = uVar6;
        FUN_00504200(uVar6);
        *(undefined1 *)(puVar7 + 0x13) = 0;
      }
      if (*(GRefCountNTSImpl **)(in_ECX + 8) != (GRefCountNTSImpl *)0x0) {
        GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(in_ECX + 8));
      }
      *(undefined4 **)(in_ECX + 8) = puVar7;
      piVar9 = piStack_394;
    }
    pppuVar15 = (undefined ***)(piVar9 + 0xf);
  }
  uVar6 = FUN_00561090(pppuVar15);
  if (*(GRefCountNTSImpl **)(in_ECX + 0x18) != (GRefCountNTSImpl *)0x0) {
    GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(in_ECX + 0x18));
  }
  *(undefined4 *)(in_ECX + 0x18) = uVar6;
  iVar5 = *(int *)(in_ECX + 0x10) + -1;
  if ((((-1 < iVar5) && (iVar5 < *(int *)(in_ECX + 0x10))) &&
      (piVar9 = *(int **)(*(int *)(in_ECX + 0xc) + iVar5 * 4), piVar9 != (int *)0x0)) ||
     (piVar9 = (int *)FUN_00540b60(0), piVar9 != (int *)0x0)) {
    uVar10 = piVar9[1];
    if (uVar10 != 0) {
      if ((*piVar9 == 0) || (uVar10 <= uVar10 - 1)) {
        psVar12 = (short *)0x0;
      }
      else {
        psVar12 = (short *)(*piVar9 + (uVar10 - 1) * 2);
      }
      if ((*psVar12 == 0xd) || (*psVar12 == 10)) goto LAB_00543ceb;
    }
    FUN_005406c0(*(undefined4 *)(in_ECX + 8),*(undefined4 *)(in_ECX + 0x1c));
  }
LAB_00543ceb:
  iVar5 = *(int *)(in_ECX + 0x10) + -1;
  if (((-1 < iVar5) && (iVar5 < *(int *)(in_ECX + 0x10))) &&
     (piVar9 = *(int **)(*(int *)(in_ECX + 0xc) + iVar5 * 4), piVar9 != (int *)0x0)) {
    uVar10 = piVar9[1];
    if (uVar10 != 0) {
      if ((*piVar9 == 0) || (uVar10 <= uVar10 - 1)) {
        psVar12 = (short *)0x0;
      }
      else {
        psVar12 = (short *)(*piVar9 + (uVar10 - 1) * 2);
      }
      if (*psVar12 == 0) {
        uVar10 = uVar10 - 1;
      }
    }
    if (uVar10 == 0) {
      iVar5 = *(int *)(in_ECX + 0x10);
      while ((iVar5 = iVar5 + -1, -1 < iVar5 && (iVar5 < *(int *)(in_ECX + 0x10)))) {
        piStack_394 = *(int **)(*(int *)(in_ECX + 0xc) + iVar5 * 4);
        uVar10 = piStack_394[1];
        if (uVar10 != 0) {
          if ((*piStack_394 == 0) || (uVar10 <= uVar10 - 1)) {
            psVar12 = (short *)0x0;
          }
          else {
            psVar12 = (short *)(*piStack_394 + (uVar10 - 1) * 2);
          }
          if (*psVar12 == 0) {
            uVar10 = uVar10 - 1;
          }
        }
        if (1 < uVar10) break;
        if (*(int *)(in_ECX + 8) == 0) {
          uVar6 = FUN_00515dd0(in_ECX);
          puVar7 = (undefined4 *)FUN_00515840(0x50,0);
          if (puVar7 == (undefined4 *)0x0) {
            puVar7 = (undefined4 *)0x0;
          }
          else {
            *puVar7 = &PTR_FUN_00cd3f2c;
            puVar7[1] = 1;
            *puVar7 = &PTR_FUN_00b8670c;
            puVar7[2] = 0;
            puVar7[3] = 0;
            puVar7[4] = 100;
            puVar7[5] = 100;
            puVar7[6] = 1;
            puVar7[7] = uVar6;
            puVar7[8] = &PTR_FUN_00cd3f2c;
            puVar7[9] = 1;
            puVar7[8] = &PTR_FUN_00b86530;
            FUN_0051c350(uVar6);
            FUN_0051c350(uVar6);
            puVar7[0xe] = 0;
            puVar7[0xf] = 0;
            puVar7[0x10] = 0xff000000;
            *(undefined2 *)(puVar7 + 0x11) = 0;
            *(undefined2 *)((int)puVar7 + 0x46) = 0;
            *(undefined1 *)(puVar7 + 0x12) = 0;
            *(undefined2 *)((int)puVar7 + 0x4a) = 0;
            *(undefined1 *)(puVar7 + 0x13) = 0;
          }
          if (*(GRefCountNTSImpl **)(in_ECX + 8) != (GRefCountNTSImpl *)0x0) {
            GRefCountNTSImpl::Release(*(GRefCountNTSImpl **)(in_ECX + 8));
          }
          *(undefined4 **)(in_ECX + 8) = puVar7;
        }
        FUN_00540450(*(undefined4 *)(in_ECX + 8),&ppuStack_284,0,0xffffffff);
      }
    }
  }
  FUN_00504260();
  appuStack_258[0] = &PTR_FUN_00b86064;
  FUN_0055e7c0();
  GRefCountImplCore::~GRefCountImplCore((GRefCountImplCore *)appuStack_258);
  FUN_00504260();
  FUN_00515cf0(uStack_34c);
  iVar5 = iStack_3ac;
  FUN_0053f4d0(iStack_3ac,iStack_3a8);
  FUN_00515cf0(iVar5);
  return 1;
joined_r0x005438c6:
  while ((uVar16 < uVar10 &&
         (cVar3 = FUN_0053b570(*(undefined2 *)(iVar14 + uVar16 * 2)), cVar3 != '\0'))) {
    uVar16 = uVar16 + 1;
  }
LAB_005438e6:
  FUN_0055e7a0(iStack_3bc,iVar11);
  iStack_3bc = iStack_3bc + 1;
  if (*(short *)(iVar14 + uVar16 * 2) == 0x2c) {
    do {
      uVar16 = uVar16 + 1;
      if (uVar10 <= uVar16) goto switchD_005436da_caseD_10;
      cVar3 = FUN_0053b570(*(undefined2 *)(iVar14 + uVar16 * 2));
    } while (cVar3 != '\0');
  }
  if (uVar10 <= uVar16) goto switchD_005436da_caseD_10;
  goto LAB_00543890;
}



============================================================
DISASSEMBLY
============================================================
005440e0 : JMP 0x00542560

PROGRAM  : Maestia.exe
FUNCTION : FUN_006f0f10
ENTRY    : 006f0f10
BODY     : [[006f0f10, 006f129f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006f0f10(int param_1,undefined4 param_2,undefined4 *param_3)

{
  int iVar1;
  int iVar2;
  int iVar3;
  short sVar4;
  uint uVar5;
  uint uVar6;
  short ****ppppsVar7;
  int iVar8;
  undefined4 ****ppppuVar9;
  int iVar10;
  int in_ECX;
  int in_EDX;
  short ****ppppsVar11;
  int iVar12;
  undefined4 ****ppppuVar13;
  undefined4 *puVar14;
  undefined4 *puVar15;
  int in_stack_0000001c;
  uint in_stack_00000020;
  undefined1 local_98 [8];
  undefined1 local_90 [8];
  int local_88;
  uint local_84;
  int local_80;
  short **local_7c;
  uint local_78;
  int local_74;
  short ***local_6c;
  undefined1 local_68 [4];
  undefined2 local_64;
  uint local_54;
  uint local_50;
  undefined4 ***local_48 [4];
  int local_38;
  uint local_34;
  short ***local_2c [4];
  int local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_00b17322;
  local_10 = ExceptionList;
  uVar6 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_8._1_3_ = 0;
  local_7c = (short **)(param_1 * 0x10000 + 1);
  local_80 = in_EDX;
  local_74 = in_ECX;
  local_14 = uVar6;
  while( true ) {
    while( true ) {
      local_8._0_1_ = 0;
      iVar3 = local_80 + *(int *)(local_80 + 4) * 0xc;
      local_6c = (short ***)local_7c;
      FUN_00410490(&local_6c);
      if ((local_88 == *(int *)(iVar3 + 200)) || (*(int *)(local_88 + 0x24) == 0)) {
        local_8 = 0xffffffff;
        if (7 < in_stack_00000020) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0(uVar6);
        }
        in_stack_00000020 = 7;
        in_stack_0000001c = 0;
        param_3 = (undefined4 *)((uint)param_3 & 0xffff0000);
        ExceptionList = local_10;
        __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
        return;
      }
      FUN_006f0c10(local_68,0);
      local_8._0_1_ = 1;
      local_18 = 7;
      local_1c = 0;
      local_2c[0] = (short ***)((uint)local_2c[0] & 0xffff0000);
      FUN_00405eb0(local_68,0,0xffffffff);
      local_8._0_1_ = 2;
      if (local_18 < 8) {
        local_6c = (short ***)local_2c;
      }
      else {
        local_6c = local_2c[0];
      }
      ppppsVar11 = (short ****)local_2c[0];
      if (local_18 < 8) {
        ppppsVar11 = local_2c;
      }
      local_84 = local_84 & 0xffffff00;
      FUN_00412c80(local_90,0xfffffffc,ppppsVar11,0xfffffffc,(short *)((int)local_6c + local_1c * 2)
                   ,0xfffffffc,local_6c,local_78,local_84);
      if (2 < local_54) break;
      local_8 = CONCAT31(local_8._1_3_,1);
      if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_18 = 7;
      local_1c = 0;
      local_2c[0] = (short ***)((uint)local_2c[0] & 0xffff0000);
      local_8._0_1_ = 0;
      if (7 < local_50) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_50 = 7;
      local_54 = 0;
      local_64 = 0;
    }
    local_34 = 7;
    local_38 = 0;
    local_48[0] = (undefined4 ***)((uint)local_48[0] & 0xffff0000);
    FUN_00405eb0(local_74,0,0xffffffff);
    local_8 = CONCAT31(local_8._1_3_,3);
    if (local_34 < 8) {
      local_6c = (short ***)local_48;
    }
    else {
      local_6c = (short ***)local_48[0];
    }
    ppppuVar13 = (undefined4 ****)local_48[0];
    if (local_34 < 8) {
      ppppuVar13 = local_48;
    }
    local_78 = local_78 & 0xffffff00;
    FUN_00412c80(local_98,0xfffffffc,ppppuVar13,0xfffffffc,(int)local_6c + local_38 * 2,0xfffffffc,
                 local_6c,local_78,local_78);
    ppppsVar11 = (short ****)local_2c[0];
    if (local_18 < 8) {
      ppppsVar11 = local_2c;
    }
    ppppsVar7 = ppppsVar11;
    do {
      sVar4 = *(short *)ppppsVar7;
      ppppsVar7 = (short ****)((int)ppppsVar7 + 2);
    } while (sVar4 != 0);
    iVar8 = FUN_00407c10(ppppsVar11,(int)ppppsVar7 - (int)((int)ppppsVar11 + 2) >> 1);
    iVar3 = local_74;
    if (iVar8 == -1) {
      local_7c = (short **)((int)local_7c + 1);
    }
    else {
      uVar5 = *(uint *)(local_74 + 0x18);
      ppppuVar13 = (undefined4 ****)(local_74 + 4);
      ppppuVar9 = ppppuVar13;
      if (7 < uVar5) {
        ppppuVar9 = (undefined4 ****)*ppppuVar13;
      }
      iVar1 = (int)ppppuVar9 + local_54 * 2 + iVar8 * 2;
      ppppuVar9 = ppppuVar13;
      if (7 < uVar5) {
        ppppuVar9 = (undefined4 ****)*ppppuVar13;
      }
      iVar2 = (int)ppppuVar9 + iVar8 * 2;
      local_6c = (short ***)ppppuVar13;
      if (7 < uVar5) {
        local_6c = (short ***)*ppppuVar13;
      }
      if (iVar2 == 0) {
        iVar10 = 0;
      }
      else {
        iVar10 = iVar2 - (int)local_6c >> 1;
      }
      iVar12 = 0;
      if (iVar1 != 0) {
        iVar12 = iVar1 - iVar2 >> 1;
      }
      FUN_00405e10(iVar10,iVar12);
      if (7 < *(uint *)(iVar3 + 0x18)) {
        ppppuVar13 = (undefined4 ****)*ppppuVar13;
      }
      iVar3 = (int)ppppuVar13 + iVar8 * 2;
      puVar15 = param_3;
      if (in_stack_00000020 < 8) {
        puVar15 = &param_3;
      }
      puVar14 = param_3;
      if (in_stack_00000020 < 8) {
        puVar14 = &param_3;
      }
      local_6c = (short ***)ppppuVar13;
      FUN_00449140(local_78,0xfffffffc,iVar3,0xfffffffc,iVar3,0xfffffffc,puVar14,0xfffffffc,
                   (int)puVar15 + in_stack_0000001c * 2);
    }
    local_8 = CONCAT31(local_8._1_3_,2);
    if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_34 = 7;
    local_38 = 0;
    local_48[0] = (undefined4 ***)((uint)local_48[0] & 0xffff0000);
    local_8 = CONCAT31(local_8._1_3_,1);
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c[0] = (short ***)((uint)local_2c[0] & 0xffff0000);
    local_8._0_1_ = 0;
    if (7 < local_50) break;
    local_50 = 7;
    local_54 = 0;
    local_64 = 0;
  }
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
006f0f10 : PUSH EBP
006f0f11 : MOV EBP,ESP
006f0f13 : PUSH -0x1
006f0f15 : PUSH 0xb17322
006f0f1a : MOV EAX,FS:[0x0]
006f0f20 : PUSH EAX
006f0f21 : SUB ESP,0x88
006f0f27 : MOV EAX,[0x00d66fa0]
006f0f2c : XOR EAX,EBP
006f0f2e : MOV dword ptr [EBP + -0x10],EAX
006f0f31 : PUSH EBX
006f0f32 : PUSH ESI
006f0f33 : PUSH EDI
006f0f34 : PUSH EAX
006f0f35 : LEA EAX,[EBP + -0xc]
006f0f38 : MOV FS:[0x0],EAX
006f0f3e : MOV EAX,dword ptr [EBP + 0x8]
006f0f41 : MOV ESI,EDX
006f0f43 : MOV dword ptr [EBP + -0x7c],ESI
006f0f46 : MOV dword ptr [EBP + -0x70],ECX
006f0f49 : XOR EBX,EBX
006f0f4b : MOV dword ptr [EBP + -0x4],EBX
006f0f4e : SHL EAX,0x10
006f0f51 : INC EAX
006f0f52 : MOV dword ptr [EBP + -0x78],EAX
006f0f55 : MOV EAX,dword ptr [ESI + 0x4]
006f0f58 : MOV EDX,dword ptr [EBP + -0x78]
006f0f5b : LEA EAX,[EAX + EAX*0x2]
006f0f5e : LEA EDI,[ESI + EAX*0x4 + 0xc4]
006f0f65 : LEA ECX,[EBP + -0x68]
006f0f68 : PUSH ECX
006f0f69 : LEA EAX,[EBP + 0xffffff7c]
006f0f6f : MOV ECX,EDI
006f0f71 : MOV dword ptr [EBP + -0x68],EDX
006f0f74 : CALL 0x00410490
006f0f79 : MOV EDI,dword ptr [EDI + 0x4]
006f0f7c : MOV EAX,dword ptr [EBP + 0xffffff7c]
006f0f82 : CMP EAX,EDI
006f0f84 : JZ 0x006f125d
006f0f8a : MOV EAX,dword ptr [EAX + 0x24]
006f0f8d : XOR EDX,EDX
006f0f8f : CMP EDX,EAX
006f0f91 : SBB EAX,EAX
006f0f93 : NEG EAX
006f0f95 : JZ 0x006f125d
006f0f9b : MOV EDX,dword ptr [EBP + -0x78]
006f0f9e : PUSH EBX
006f0f9f : LEA ECX,[EBP + -0x64]
006f0fa2 : PUSH ECX
006f0fa3 : MOV ECX,ESI
006f0fa5 : CALL 0x006f0c10
006f0faa : MOV byte ptr [EBP + -0x4],0x1
006f0fae : PUSH -0x1
006f0fb0 : PUSH EBX
006f0fb1 : LEA EAX,[EBP + -0x64]
006f0fb4 : XOR EDX,EDX
006f0fb6 : PUSH EAX
006f0fb7 : LEA ECX,[EBP + -0x2c]
006f0fba : MOV dword ptr [EBP + -0x14],0x7
006f0fc1 : MOV dword ptr [EBP + -0x18],EBX
006f0fc4 : MOV word ptr [EBP + -0x28],DX
006f0fc8 : CALL 0x00405eb0
006f0fcd : MOV byte ptr [EBP + -0x4],0x2
006f0fd1 : MOV EAX,dword ptr [EBP + -0x14]
006f0fd4 : MOV ESI,dword ptr [EBP + -0x28]
006f0fd7 : CMP EAX,0x8
006f0fda : JC 0x006f0fe1
006f0fdc : MOV dword ptr [EBP + -0x68],ESI
006f0fdf : JMP 0x006f0fe7
006f0fe1 : LEA ECX,[EBP + -0x28]
006f0fe4 : MOV dword ptr [EBP + -0x68],ECX
006f0fe7 : MOV EDI,0xfffffffc
006f0fec : MOV ECX,ESI
006f0fee : CMP EAX,0x8
006f0ff1 : JNC 0x006f0ff6
006f0ff3 : LEA ECX,[EBP + -0x28]
006f0ff6 : MOV EDX,dword ptr [EBP + -0x18]
006f0ff9 : LEA ECX,[ECX + EDX*0x2]
006f0ffc : MOV EDX,EDI
006f0ffe : CMP EAX,0x8
006f1001 : JNC 0x006f1006
006f1003 : LEA ESI,[EBP + -0x28]
006f1006 : MOV byte ptr [EBP + -0x80],0x0
006f100a : MOV EBX,dword ptr [EBP + -0x80]
006f100d : PUSH EBX
006f100e : MOV EBX,dword ptr [EBP + -0x74]
006f1011 : PUSH EBX
006f1012 : MOV EBX,dword ptr [EBP + -0x68]
006f1015 : PUSH EBX
006f1016 : PUSH EDI
006f1017 : PUSH ECX
006f1018 : PUSH EDX
006f1019 : MOV EAX,EDX
006f101b : PUSH ESI
006f101c : PUSH EAX
006f101d : LEA EAX,[EBP + 0xffffff74]
006f1023 : PUSH EAX
006f1024 : MOV EDI,0x637a1c
006f1029 : CALL 0x00412c80
006f102e : ADD ESP,0x24
006f1031 : CMP dword ptr [EBP + -0x50],0x3
006f1035 : JNC 0x006f1084
006f1037 : MOV byte ptr [EBP + -0x4],0x1
006f103b : MOV EDI,0x8
006f1040 : CMP dword ptr [EBP + -0x14],EDI
006f1043 : JC 0x006f104d
006f1045 : MOV ECX,dword ptr [EBP + -0x28]
006f1048 : CALL 0x006f04e0
006f104d : XOR ECX,ECX
006f104f : MOV ESI,0x7
006f1054 : XOR EBX,EBX
006f1056 : MOV dword ptr [EBP + -0x14],ESI
006f1059 : MOV dword ptr [EBP + -0x18],EBX
006f105c : MOV word ptr [EBP + -0x28],CX
006f1060 : MOV byte ptr [EBP + -0x4],CL
006f1063 : CMP dword ptr [EBP + -0x4c],EDI
006f1066 : JC 0x006f1070
006f1068 : MOV ECX,dword ptr [EBP + -0x60]
006f106b : CALL 0x006f04e0
006f1070 : XOR EDX,EDX
006f1072 : MOV dword ptr [EBP + -0x4c],ESI
006f1075 : MOV ESI,dword ptr [EBP + -0x7c]
006f1078 : MOV dword ptr [EBP + -0x50],EBX
006f107b : MOV word ptr [EBP + -0x60],DX
006f107f : JMP 0x006f0f55
006f1084 : MOV ECX,dword ptr [EBP + -0x70]
006f1087 : XOR EAX,EAX
006f1089 : PUSH -0x1
006f108b : PUSH EAX
006f108c : PUSH ECX
006f108d : LEA ECX,[EBP + -0x48]
006f1090 : MOV dword ptr [EBP + -0x30],0x7
006f1097 : MOV dword ptr [EBP + -0x34],0x0
006f109e : MOV word ptr [EBP + -0x44],AX
006f10a2 : CALL 0x00405eb0
006f10a7 : MOV byte ptr [EBP + -0x4],0x3
006f10ab : MOV EAX,dword ptr [EBP + -0x30]
006f10ae : MOV ESI,dword ptr [EBP + -0x44]
006f10b1 : CMP EAX,0x8
006f10b4 : JC 0x006f10bb
006f10b6 : MOV dword ptr [EBP + -0x68],ESI
006f10b9 : JMP 0x006f10c1
006f10bb : LEA EDX,[EBP + -0x44]
006f10be : MOV dword ptr [EBP + -0x68],EDX
006f10c1 : MOV EDI,0xfffffffc
006f10c6 : MOV ECX,ESI
006f10c8 : CMP EAX,0x8
006f10cb : JNC 0x006f10d0
006f10cd : LEA ECX,[EBP + -0x44]
006f10d0 : MOV EDX,dword ptr [EBP + -0x34]
006f10d3 : LEA ECX,[ECX + EDX*0x2]
006f10d6 : MOV EDX,EDI
006f10d8 : CMP EAX,0x8
006f10db : JNC 0x006f10e0
006f10dd : LEA ESI,[EBP + -0x44]
006f10e0 : MOV byte ptr [EBP + -0x74],0x0
006f10e4 : MOV EBX,dword ptr [EBP + -0x74]
006f10e7 : PUSH EBX
006f10e8 : MOV EBX,dword ptr [EBP + -0x74]
006f10eb : PUSH EBX
006f10ec : MOV EBX,dword ptr [EBP + -0x68]
006f10ef : PUSH EBX
006f10f0 : PUSH EDI
006f10f1 : PUSH ECX
006f10f2 : PUSH EDX
006f10f3 : MOV EAX,EDX
006f10f5 : PUSH ESI
006f10f6 : PUSH EAX
006f10f7 : LEA EAX,[EBP + 0xffffff6c]
006f10fd : PUSH EAX
006f10fe : MOV EDI,0x637a1c
006f1103 : CALL 0x00412c80
006f1108 : MOV EDX,dword ptr [EBP + -0x28]
006f110b : MOV EDI,0x8
006f1110 : ADD ESP,0x24
006f1113 : CMP dword ptr [EBP + -0x14],EDI
006f1116 : JNC 0x006f111b
006f1118 : LEA EDX,[EBP + -0x28]
006f111b : MOV EAX,EDX
006f111d : LEA ESI,[EAX + 0x2]
006f1120 : XOR EBX,EBX
006f1122 : MOV CX,word ptr [EAX]
006f1125 : ADD EAX,0x2
006f1128 : CMP CX,BX
006f112b : JNZ 0x006f1122
006f112d : SUB EAX,ESI
006f112f : SAR EAX,0x1
006f1131 : PUSH EAX
006f1132 : PUSH EDX
006f1133 : XOR EAX,EAX
006f1135 : LEA EDX,[EBP + -0x48]
006f1138 : CALL 0x00407c10
006f113d : MOV ESI,EAX
006f113f : CMP ESI,-0x1
006f1142 : JZ 0x006f11f7
006f1148 : MOV EBX,dword ptr [EBP + -0x70]
006f114b : MOV ECX,dword ptr [EBX + 0x18]
006f114e : ADD EBX,0x4
006f1151 : CMP ECX,EDI
006f1153 : JC 0x006f1159
006f1155 : MOV EAX,dword ptr [EBX]
006f1157 : JMP 0x006f115b
006f1159 : MOV EAX,EBX
006f115b : MOV EDX,dword ptr [EBP + -0x50]
006f115e : LEA EAX,[EAX + ESI*0x2]
006f1161 : LEA EDX,[EAX + EDX*0x2]
006f1164 : CMP ECX,EDI
006f1166 : JC 0x006f116c
006f1168 : MOV EAX,dword ptr [EBX]
006f116a : JMP 0x006f116e
006f116c : MOV EAX,EBX
006f116e : LEA EDI,[EAX + ESI*0x2]
006f1171 : CMP ECX,0x8
006f1174 : JC 0x006f117d
006f1176 : MOV EAX,dword ptr [EBX]
006f1178 : MOV dword ptr [EBP + -0x68],EAX
006f117b : JMP 0x006f1180
006f117d : MOV dword ptr [EBP + -0x68],EBX
006f1180 : TEST EDI,EDI
006f1182 : JNZ 0x006f1188
006f1184 : XOR EAX,EAX
006f1186 : JMP 0x006f118f
006f1188 : MOV EAX,EDI
006f118a : SUB EAX,dword ptr [EBP + -0x68]
006f118d : SAR EAX,0x1
006f118f : TEST EDX,EDX
006f1191 : JZ 0x006f1197
006f1193 : SUB EDX,EDI
006f1195 : SAR EDX,0x1
006f1197 : MOV EDI,dword ptr [EBP + -0x70]
006f119a : PUSH EDX
006f119b : PUSH EAX
006f119c : MOV ECX,EDI
006f119e : CALL 0x00405e10
006f11a3 : CMP dword ptr [EDI + 0x18],0x8
006f11a7 : JC 0x006f11ad
006f11a9 : MOV EAX,dword ptr [EBX]
006f11ab : JMP 0x006f11af
006f11ad : MOV EAX,EBX
006f11af : MOV EDX,dword ptr [EBP + 0x24]
006f11b2 : MOV EBX,dword ptr [EBP + 0x10]
006f11b5 : MOV dword ptr [EBP + -0x68],EAX
006f11b8 : MOV ECX,0xfffffffc
006f11bd : LEA EAX,[EAX + ESI*0x2]
006f11c0 : MOV EDI,EBX
006f11c2 : CMP EDX,0x8
006f11c5 : JNC 0x006f11ca
006f11c7 : LEA EDI,[EBP + 0x10]
006f11ca : MOV ESI,dword ptr [EBP + 0x20]
006f11cd : LEA EDI,[EDI + ESI*0x2]
006f11d0 : MOV ESI,ECX
006f11d2 : CMP EDX,0x8
006f11d5 : JNC 0x006f11da
006f11d7 : LEA EBX,[EBP + 0x10]
006f11da : PUSH EDI
006f11db : PUSH ESI
006f11dc : MOV ESI,dword ptr [EBP + -0x70]
006f11df : PUSH EBX
006f11e0 : MOV EDX,ECX
006f11e2 : PUSH EDX
006f11e3 : PUSH EAX
006f11e4 : PUSH ECX
006f11e5 : PUSH EAX
006f11e6 : PUSH ECX
006f11e7 : MOV ECX,dword ptr [EBP + -0x74]
006f11ea : PUSH ECX
006f11eb : CALL 0x00449140
006f11f0 : XOR EBX,EBX
006f11f2 : LEA EDI,[EBX + 0x8]
006f11f5 : JMP 0x006f11fa
006f11f7 : INC dword ptr [EBP + -0x78]
006f11fa : MOV ESI,0x7
006f11ff : MOV byte ptr [EBP + -0x4],0x2
006f1203 : CMP dword ptr [EBP + -0x30],EDI
006f1206 : JC 0x006f1210
006f1208 : MOV ECX,dword ptr [EBP + -0x44]
006f120b : CALL 0x006f04e0
006f1210 : XOR EDX,EDX
006f1212 : MOV dword ptr [EBP + -0x30],ESI
006f1215 : MOV dword ptr [EBP + -0x34],EBX
006f1218 : MOV word ptr [EBP + -0x44],DX
006f121c : MOV byte ptr [EBP + -0x4],0x1
006f1220 : CMP dword ptr [EBP + -0x14],EDI
006f1223 : JC 0x006f122d
006f1225 : MOV ECX,dword ptr [EBP + -0x28]
006f1228 : CALL 0x006f04e0
006f122d : XOR EAX,EAX
006f122f : MOV dword ptr [EBP + -0x14],ESI
006f1232 : MOV dword ptr [EBP + -0x18],EBX
006f1235 : MOV word ptr [EBP + -0x28],AX
006f1239 : MOV byte ptr [EBP + -0x4],AL
006f123c : CMP dword ptr [EBP + -0x4c],EDI
006f123f : JC 0x006f1249
006f1241 : MOV ECX,dword ptr [EBP + -0x60]
006f1244 : CALL 0x006f04e0
006f1249 : XOR ECX,ECX
006f124b : MOV dword ptr [EBP + -0x4c],ESI
006f124e : MOV ESI,dword ptr [EBP + -0x7c]
006f1251 : MOV dword ptr [EBP + -0x50],EBX
006f1254 : MOV word ptr [EBP + -0x60],CX
006f1258 : JMP 0x006f0f55
006f125d : MOV dword ptr [EBP + -0x4],0xffffffff
006f1264 : CMP dword ptr [EBP + 0x24],0x8
006f1268 : JC 0x006f1272
006f126a : MOV ECX,dword ptr [EBP + 0x10]
006f126d : CALL 0x006f04e0
006f1272 : XOR EDX,EDX
006f1274 : MOV dword ptr [EBP + 0x24],0x7
006f127b : MOV dword ptr [EBP + 0x20],EBX
006f127e : MOV word ptr [EBP + 0x10],DX
006f1282 : MOV ECX,dword ptr [EBP + -0xc]
006f1285 : MOV dword ptr FS:[0x0],ECX
006f128c : POP ECX
006f128d : POP EDI
006f128e : POP ESI
006f128f : POP EBX
006f1290 : MOV ECX,dword ptr [EBP + -0x10]
006f1293 : XOR ECX,EBP
006f1295 : CALL 0x00633e6b
006f129a : MOV ESP,EBP
006f129c : POP EBP
006f129d : RET 0x20

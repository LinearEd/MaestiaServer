PROGRAM  : Maestia.exe
FUNCTION : FUN_00a4e370
ENTRY    : 00a4e370
BODY     : [[00a4e370, 00a4e517]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a4e370(uint8_t *param_1)

{
  undefined4 *puVar1;
  int iVar2;
  int iVar3;
  byte bVar4;
  undefined1 auStack_64 [12];
  undefined4 uStack_58;
  int iStack_54;
  undefined1 local_34 [28];
  uint8_t *local_18;
  undefined4 local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  iVar2 = (int)param_1;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3b336;
  local_10 = ExceptionList;
  if (*(char *)((int)param_1 + 0x11c) != '\0') {
    return;
  }
  local_14 = *(undefined4 *)((int)param_1 + 0x120);
  ExceptionList = &local_10;
  FUN_004016d0();
  if (param_1 == (uint8_t *)*(int *)((int)param_1 + 0x114)) {
    ExceptionList = local_10;
    return;
  }
  if (*(char *)((int)param_1 + 0x11) == '\0') {
    ExceptionList = local_10;
    return;
  }
  iStack_54 = (int)param_1 + 0x28;
  uStack_58 = 0xa4e3f6;
  FUN_00405eb0();
  iVar3 = *(int *)ThreadLocalStoragePointer;
  bVar4 = *(byte *)(iVar3 + 0x18);
  *(undefined4 *)((int)param_1 + 0x2c8) = *(undefined4 *)((int)param_1 + 0x14);
  bVar4 = (byte)((ulonglong)(bVar4 + 1) % 3);
  *(byte *)(iVar3 + 0x18) = bVar4;
  local_18 = (uint8_t *)((uint)bVar4 * 0x2000 + 0x122cb8 + iVar3);
  if (local_18 == (uint8_t *)0x0) {
    param_1 = (uint8_t *)0x0;
  }
  else {
    local_18[0] = '\0';
    local_18[1] = '\0';
    local_18[2] = '\f';
    local_18[3] = '\n';
    param_1 = local_18;
  }
  local_8 = 0xffffffff;
  *(undefined4 *)(param_1 + 4) = local_14;
  param_1[8] = '\0';
  param_1[9] = '\0';
  param_1[10] = '\0';
  param_1[0xb] = '\0';
  FUN_00406460();
  local_8 = 1;
  local_18 = auStack_64;
  FUN_0081d120(local_34);
  local_8 = CONCAT31((int3)((uint)local_8 >> 8),1);
  FUN_00a49ec0();
  local_8 = 0xffffffff;
  FUN_00406560();
  if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
    iStack_54 = 0xa4e4bc;
    iVar3 = FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),0xc,param_1);
    if (iVar3 != 0) goto LAB_00a4e4e5;
  }
  FUN_008018d0();
  puVar1 = *(undefined4 **)(iVar2 + 0x50);
  if (puVar1 != (undefined4 *)0x0) {
    (**(code **)*puVar1)();
  }
LAB_00a4e4e5:
  iVar3 = DAT_017248d0;
  *(undefined4 *)(DAT_0172491c + 0x164) = local_14;
  *(undefined4 *)(iVar3 + 4) = local_14;
  *(undefined1 *)(iVar2 + 0x11c) = 1;
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00a4e370 : PUSH EBP
00a4e371 : MOV EBP,ESP
00a4e373 : PUSH -0x1
00a4e375 : PUSH 0xb3b336
00a4e37a : MOV EAX,FS:[0x0]
00a4e380 : PUSH EAX
00a4e381 : SUB ESP,0x28
00a4e384 : PUSH EBX
00a4e385 : PUSH ESI
00a4e386 : PUSH EDI
00a4e387 : MOV EAX,[0x00d66fa0]
00a4e38c : XOR EAX,EBP
00a4e38e : PUSH EAX
00a4e38f : LEA EAX,[EBP + -0xc]
00a4e392 : MOV FS:[0x0],EAX
00a4e398 : MOV EBX,dword ptr [EBP + 0x8]
00a4e39b : MOV AL,byte ptr [EBX + 0x11c]
00a4e3a1 : TEST AL,AL
00a4e3a3 : JNZ 0x00a4e504
00a4e3a9 : MOV ECX,dword ptr [EBX + 0x120]
00a4e3af : LEA EAX,[EBX + 0x120]
00a4e3b5 : MOV dword ptr [EBP + -0x10],ECX
00a4e3b8 : PUSH EAX
00a4e3b9 : LEA ECX,[EBX + 0x110]
00a4e3bf : LEA EAX,[EBP + 0x8]
00a4e3c2 : CALL 0x004016d0
00a4e3c7 : MOV EAX,dword ptr [EBX + 0x114]
00a4e3cd : MOV ESI,dword ptr [EBP + 0x8]
00a4e3d0 : CMP ESI,EAX
00a4e3d2 : JZ 0x00a4e504
00a4e3d8 : CMP byte ptr [ESI + 0x11],0x0
00a4e3dc : JZ 0x00a4e504
00a4e3e2 : PUSH -0x1
00a4e3e4 : XOR EDI,EDI
00a4e3e6 : LEA EAX,[ESI + 0x28]
00a4e3e9 : PUSH EDI
00a4e3ea : PUSH EAX
00a4e3eb : LEA ECX,[EBX + 0x2ac]
00a4e3f1 : CALL 0x00405eb0
00a4e3f6 : MOV EAX,FS:[0x2c]
00a4e3fc : MOV ECX,dword ptr [EAX]
00a4e3fe : MOVZX EAX,byte ptr [ECX + 0x18]
00a4e402 : MOV EDX,dword ptr [ESI + 0x14]
00a4e405 : MOV dword ptr [EBX + 0x2c8],EDX
00a4e40b : INC EAX
00a4e40c : CDQ
00a4e40d : MOV ESI,0x3
00a4e412 : IDIV ESI
00a4e414 : MOV byte ptr [ECX + 0x18],DL
00a4e417 : MOVZX EDX,DL
00a4e41a : SHL EDX,0xd
00a4e41d : LEA EAX,[EDX + ECX*0x1 + 0x122cb8]
00a4e424 : MOV dword ptr [EBP + -0x14],EAX
00a4e427 : MOV dword ptr [EBP + -0x4],EDI
00a4e42a : CMP EAX,EDI
00a4e42c : JZ 0x00a4e440
00a4e42e : XOR ECX,ECX
00a4e430 : MOV word ptr [EAX],CX
00a4e433 : MOV byte ptr [EAX + 0x2],0xc
00a4e437 : MOV byte ptr [EAX + 0x3],0xa
00a4e43b : MOV dword ptr [EBP + 0x8],EAX
00a4e43e : JMP 0x00a4e445
00a4e440 : MOV dword ptr [EBP + 0x8],EDI
00a4e443 : MOV EAX,EDI
00a4e445 : MOV dword ptr [EBP + -0x4],0xffffffff
00a4e44c : MOV EDX,dword ptr [EBP + -0x10]
00a4e44f : PUSH 0xcc6780
00a4e454 : LEA ECX,[EBP + -0x30]
00a4e457 : MOV dword ptr [EAX + 0x4],EDX
00a4e45a : MOV dword ptr [EAX + 0x8],EDI
00a4e45d : CALL 0x00406460
00a4e462 : MOV dword ptr [EBP + -0x4],0x1
00a4e469 : MOV ECX,dword ptr [0x0172491c]
00a4e46f : SUB ESP,0x1c
00a4e472 : LEA EAX,[EBP + -0x30]
00a4e475 : MOV EDI,ESP
00a4e477 : MOV dword ptr [EBP + -0x14],ESP
00a4e47a : PUSH EAX
00a4e47b : CALL 0x0081d120
00a4e480 : MOV byte ptr [EBP + -0x4],0x2
00a4e484 : MOV byte ptr [EBP + -0x4],0x1
00a4e488 : MOV ESI,EBX
00a4e48a : CALL 0x00a49ec0
00a4e48f : MOV dword ptr [EBP + -0x4],0xffffffff
00a4e496 : LEA ECX,[EBP + -0x30]
00a4e499 : CALL 0x00406560
00a4e49e : MOV ECX,dword ptr [0x017247d4]
00a4e4a4 : MOV EAX,dword ptr [ECX + 0x4]
00a4e4a7 : TEST EAX,EAX
00a4e4a9 : JZ 0x00a4e4c0
00a4e4ab : CMP byte ptr [ECX + 0x8],0x0
00a4e4af : JZ 0x00a4e4c0
00a4e4b1 : MOV EDI,dword ptr [EBP + 0x8]
00a4e4b4 : PUSH 0xc
00a4e4b6 : PUSH EAX
00a4e4b7 : CALL 0x00a0dd40
00a4e4bc : TEST EAX,EAX
00a4e4be : JNZ 0x00a4e4e5
00a4e4c0 : MOV ESI,dword ptr [0x00da98e8]
00a4e4c6 : PUSH 0xcc67c0
00a4e4cb : CALL 0x008018d0
00a4e4d0 : MOV ECX,dword ptr [EBX + 0x50]
00a4e4d3 : ADD ESP,0x4
00a4e4d6 : TEST ECX,ECX
00a4e4d8 : JZ 0x00a4e4e5
00a4e4da : MOV EDX,dword ptr [ECX]
00a4e4dc : MOV EAX,dword ptr [EDX]
00a4e4de : PUSH 0xcc6ba0
00a4e4e3 : CALL EAX
00a4e4e5 : MOV EAX,dword ptr [EBP + -0x10]
00a4e4e8 : MOV ECX,dword ptr [0x0172491c]
00a4e4ee : MOV EDX,dword ptr [0x017248d0]
00a4e4f4 : MOV dword ptr [ECX + 0x164],EAX
00a4e4fa : MOV dword ptr [EDX + 0x4],EAX
00a4e4fd : MOV byte ptr [EBX + 0x11c],0x1
00a4e504 : MOV ECX,dword ptr [EBP + -0xc]
00a4e507 : MOV dword ptr FS:[0x0],ECX
00a4e50e : POP ECX
00a4e50f : POP EDI
00a4e510 : POP ESI
00a4e511 : POP EBX
00a4e512 : MOV ESP,EBP
00a4e514 : POP EBP
00a4e515 : RET 0x4

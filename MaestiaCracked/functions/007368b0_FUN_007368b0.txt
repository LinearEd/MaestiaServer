PROGRAM  : Maestia.exe
FUNCTION : FUN_007368b0
ENTRY    : 007368b0
BODY     : [[007368b0, 00736b0c]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007368b0(int param_1,int param_2,int param_3,int param_4,undefined4 param_5,int param_6)

{
  int iVar1;
  float fVar2;
  float fVar3;
  float fVar4;
  float fVar5;
  ushort uVar6;
  ushort uVar7;
  int iVar8;
  int in_ECX;
  uint uVar9;
  undefined4 *puVar10;
  uint uVar11;
  uint uVar12;
  uint local_20;
  
  iVar8 = FUN_0070a3a0();
  fVar5 = DAT_00d72c24;
  uVar7 = 0;
  if (*(short *)(in_ECX + 0x10) != 0) {
    do {
      uVar9 = (uint)uVar7;
      puVar10 = (undefined4 *)(iVar8 + uVar9 * 0x3c);
      iVar1 = uVar9 * 0xc;
      *puVar10 = *(undefined4 *)(iVar1 + param_1);
      puVar10[1] = *(undefined4 *)(iVar1 + 4 + param_1);
      puVar10[2] = *(undefined4 *)(iVar1 + 8 + param_1);
      puVar10[3] = *(undefined4 *)(iVar1 + param_2);
      puVar10[4] = *(undefined4 *)(iVar1 + 4 + param_2);
      puVar10[5] = *(undefined4 *)(iVar1 + 8 + param_2);
      puVar10[7] = *(undefined4 *)(param_3 + uVar9 * 8);
      puVar10[8] = *(undefined4 *)(param_3 + 4 + uVar9 * 8);
      fVar2 = *(float *)(iVar1 + param_4);
      fVar3 = *(float *)(iVar1 + 4 + param_4);
      fVar4 = *(float *)(iVar1 + 8 + param_4);
      if (fVar2 < 1.0) {
        if (0.0 < fVar2) {
          local_20 = (uint)(longlong)ROUND(fVar2 * 255.0 + fVar5);
          uVar11 = local_20;
        }
        else {
          uVar11 = 0;
        }
      }
      else {
        uVar11 = 0xff;
      }
      if (fVar3 < 1.0) {
        if (0.0 < fVar3) {
          local_20 = (uint)(longlong)ROUND(fVar3 * 255.0 + fVar5);
          uVar12 = local_20;
        }
        else {
          uVar12 = 0;
        }
      }
      else {
        uVar12 = 0xff;
      }
      if (fVar4 < 1.0) {
        if (0.0 < fVar4) {
          local_20 = (uint)(longlong)ROUND(fVar4 * 255.0 + fVar5);
        }
        else {
          local_20 = 0;
        }
      }
      else {
        local_20 = 0xff;
      }
      puVar10[6] = ((uVar11 | 0xffffff00) << 8 | uVar12) << 8 | local_20;
      uVar6 = 0;
      if (*(short *)(param_6 + uVar9 * 8) == 0) {
LAB_00736aa3:
        puVar10 = (undefined4 *)(iVar8 + 0x24 + (uVar9 * 0xf + (uint)uVar6) * 4);
        uVar9 = (uint)(ushort)(3 - uVar6);
        do {
          puVar10[3] = 0;
          *puVar10 = 0;
          puVar10 = puVar10 + 1;
          uVar9 = uVar9 - 1;
        } while (uVar9 != 0);
      }
      else {
        do {
          uVar11 = (uint)uVar6;
          iVar1 = uVar9 * 0xf + uVar11;
          *(float *)(iVar8 + 0x30 + iVar1 * 4) =
               (float)*(ushort *)(*(int *)(param_6 + 4 + uVar9 * 8) + 4 + uVar11 * 8);
          *(undefined4 *)(iVar8 + 0x24 + iVar1 * 4) =
               *(undefined4 *)(*(int *)(param_6 + 4 + uVar9 * 8) + uVar11 * 8);
          uVar6 = uVar6 + 1;
        } while (uVar6 < *(ushort *)(param_6 + uVar9 * 8));
        if (uVar6 < 3) goto LAB_00736aa3;
      }
      uVar7 = uVar7 + 1;
    } while (uVar7 < *(ushort *)(in_ECX + 0x10));
  }
  FUN_007377f0(iVar8);
  FUN_0070a260(iVar8);
  return;
}



============================================================
DISASSEMBLY
============================================================
007368b0 : PUSH EBP
007368b1 : MOV EBP,ESP
007368b3 : AND ESP,0xfffffff8
007368b6 : SUB ESP,0x2c
007368b9 : PUSH EBX
007368ba : PUSH ESI
007368bb : PUSH EDI
007368bc : MOV EDI,ECX
007368be : MOVZX EAX,word ptr [EDI + 0x10]
007368c2 : MOV ECX,EAX
007368c4 : SHL ECX,0x4
007368c7 : SUB ECX,EAX
007368c9 : ADD ECX,ECX
007368cb : ADD ECX,ECX
007368cd : MOV dword ptr [ESP + 0x1c],EDI
007368d1 : CALL 0x0070a3a0
007368d6 : MOV ESI,EAX
007368d8 : XOR EAX,EAX
007368da : MOV dword ptr [ESP + 0x14],ESI
007368de : MOV dword ptr [ESP + 0x18],0x0
007368e6 : CMP AX,word ptr [EDI + 0x10]
007368ea : JNC 0x00736af3
007368f0 : FLD float ptr [0x00cdf130]
007368f6 : MOV EBX,dword ptr [EBP + 0x1c]
007368f9 : MOVSS XMM4,dword ptr [0x00c10fc4]
00736901 : FLD float ptr [0x00d72c24]
00736907 : XORPS XMM2,XMM2
0073690a : MOVZX ECX,word ptr [ESP + 0x18]
0073690f : MOV EDX,ECX
00736911 : SHL EDX,0x4
00736914 : LEA EAX,[ECX + ECX*0x2]
00736917 : SUB EDX,ECX
00736919 : LEA EDX,[ESI + EDX*0x4]
0073691c : MOV ESI,dword ptr [EBP + 0x8]
0073691f : ADD EAX,EAX
00736921 : ADD EAX,EAX
00736923 : FLD float ptr [EAX + ESI*0x1]
00736926 : FSTP float ptr [EDX]
00736928 : FLD float ptr [EAX + ESI*0x1 + 0x4]
0073692c : FSTP float ptr [EDX + 0x4]
0073692f : FLD float ptr [EAX + ESI*0x1 + 0x8]
00736933 : MOV ESI,dword ptr [EBP + 0xc]
00736936 : FSTP float ptr [EDX + 0x8]
00736939 : FLD float ptr [EAX + ESI*0x1]
0073693c : FSTP float ptr [EDX + 0xc]
0073693f : FLD float ptr [EAX + ESI*0x1 + 0x4]
00736943 : FSTP float ptr [EDX + 0x10]
00736946 : FLD float ptr [EAX + ESI*0x1 + 0x8]
0073694a : MOV ESI,dword ptr [EBP + 0x10]
0073694d : FSTP float ptr [EDX + 0x14]
00736950 : FLD float ptr [ESI + ECX*0x8]
00736953 : FSTP float ptr [EDX + 0x1c]
00736956 : FLD float ptr [ESI + ECX*0x8 + 0x4]
0073695a : MOV ESI,dword ptr [EBP + 0x14]
0073695d : FSTP float ptr [EDX + 0x20]
00736960 : MOVSS XMM0,dword ptr [EAX + ESI*0x1]
00736965 : COMISS XMM0,XMM4
00736968 : MOVSS XMM1,dword ptr [EAX + ESI*0x1 + 0x4]
0073696e : MOVSS XMM3,dword ptr [EAX + ESI*0x1 + 0x8]
00736974 : MOVSS dword ptr [ESP + 0x28],XMM0
0073697a : MOVSS dword ptr [ESP + 0x2c],XMM1
00736980 : MOVSS dword ptr [ESP + 0x30],XMM3
00736986 : JC 0x0073698f
00736988 : MOV ESI,0xff
0073698d : JMP 0x007369c2
0073698f : COMISS XMM2,XMM0
00736992 : JC 0x00736998
00736994 : XOR ESI,ESI
00736996 : JMP 0x007369c2
00736998 : FLD float ptr [ESP + 0x28]
0073699c : FNSTCW word ptr [ESP + 0x12]
007369a0 : MOVZX EAX,word ptr [ESP + 0x12]
007369a5 : FMUL ST2
007369a7 : OR EAX,0xc00
007369ac : MOV dword ptr [ESP + 0x20],EAX
007369b0 : FADD ST0,ST1
007369b2 : FLDCW word ptr [ESP + 0x20]
007369b6 : FISTP qword ptr [ESP + 0x20]
007369ba : MOV ESI,dword ptr [ESP + 0x20]
007369be : FLDCW word ptr [ESP + 0x12]
007369c2 : COMISS XMM1,XMM4
007369c5 : JC 0x007369ce
007369c7 : MOV EDI,0xff
007369cc : JMP 0x00736a01
007369ce : COMISS XMM2,XMM1
007369d1 : JC 0x007369d7
007369d3 : XOR EDI,EDI
007369d5 : JMP 0x00736a01
007369d7 : FLD float ptr [ESP + 0x2c]
007369db : FNSTCW word ptr [ESP + 0x12]
007369df : MOVZX EAX,word ptr [ESP + 0x12]
007369e4 : FMUL ST2
007369e6 : OR EAX,0xc00
007369eb : MOV dword ptr [ESP + 0x20],EAX
007369ef : FADD ST0,ST1
007369f1 : FLDCW word ptr [ESP + 0x20]
007369f5 : FISTP qword ptr [ESP + 0x20]
007369f9 : MOV EDI,dword ptr [ESP + 0x20]
007369fd : FLDCW word ptr [ESP + 0x12]
00736a01 : COMISS XMM3,XMM4
00736a04 : JC 0x00736a0d
00736a06 : MOV EAX,0xff
00736a0b : JMP 0x00736a40
00736a0d : COMISS XMM2,XMM3
00736a10 : JC 0x00736a16
00736a12 : XOR EAX,EAX
00736a14 : JMP 0x00736a40
00736a16 : FLD float ptr [ESP + 0x30]
00736a1a : FNSTCW word ptr [ESP + 0x12]
00736a1e : MOVZX EAX,word ptr [ESP + 0x12]
00736a23 : FMUL ST2
00736a25 : OR EAX,0xc00
00736a2a : MOV dword ptr [ESP + 0x20],EAX
00736a2e : FADD ST0,ST1
00736a30 : FLDCW word ptr [ESP + 0x20]
00736a34 : FISTP qword ptr [ESP + 0x20]
00736a38 : MOV EAX,dword ptr [ESP + 0x20]
00736a3c : FLDCW word ptr [ESP + 0x12]
00736a40 : OR ESI,0xffffff00
00736a46 : SHL ESI,0x8
00736a49 : OR ESI,EDI
00736a4b : SHL ESI,0x8
00736a4e : OR ESI,EAX
00736a50 : MOV dword ptr [EDX + 0x18],ESI
00736a53 : XOR EDX,EDX
00736a55 : XOR EAX,EAX
00736a57 : CMP DX,word ptr [EBX + ECX*0x8]
00736a5b : JNC 0x00736aa3
00736a5d : MOV EDI,ECX
00736a5f : SHL EDI,0x4
00736a62 : SUB EDI,ECX
00736a64 : MOV EBX,dword ptr [EBX + ECX*0x8 + 0x4]
00736a68 : MOVZX EDX,AX
00736a6b : MOVZX EBX,word ptr [EBX + EDX*0x8 + 0x4]
00736a70 : CVTSI2SS XMM0,EBX
00736a74 : MOV EBX,dword ptr [ESP + 0x14]
00736a78 : LEA ESI,[EDI + EDX*0x1]
00736a7b : MOVSS dword ptr [EBX + ESI*0x4 + 0x30],XMM0
00736a81 : MOV EBX,dword ptr [EBP + 0x1c]
00736a84 : MOV EBX,dword ptr [EBX + ECX*0x8 + 0x4]
00736a88 : FLD float ptr [EBX + EDX*0x8]
00736a8b : MOV EDX,dword ptr [ESP + 0x14]
00736a8f : MOV EBX,dword ptr [EBP + 0x1c]
00736a92 : FSTP float ptr [EDX + ESI*0x4 + 0x24]
00736a96 : INC EAX
00736a97 : CMP AX,word ptr [EBX + ECX*0x8]
00736a9b : JC 0x00736a64
00736a9d : CMP AX,0x3
00736aa1 : JNC 0x00736ad2
00736aa3 : MOV EDX,ECX
00736aa5 : SHL EDX,0x4
00736aa8 : SUB EDX,ECX
00736aaa : MOVZX ECX,AX
00736aad : ADD EDX,ECX
00736aaf : MOV ECX,dword ptr [ESP + 0x14]
00736ab3 : LEA ECX,[ECX + EDX*0x4 + 0x24]
00736ab7 : MOV EDX,0x3
00736abc : SUB EDX,EAX
00736abe : MOVZX EAX,DX
00736ac1 : MOVSS dword ptr [ECX + 0xc],XMM2
00736ac6 : MOVSS dword ptr [ECX],XMM2
00736aca : ADD ECX,0x4
00736acd : SUB EAX,0x1
00736ad0 : JNZ 0x00736ac1
00736ad2 : MOV EAX,dword ptr [ESP + 0x18]
00736ad6 : MOV ECX,dword ptr [ESP + 0x1c]
00736ada : MOV ESI,dword ptr [ESP + 0x14]
00736ade : INC EAX
00736adf : MOV dword ptr [ESP + 0x18],EAX
00736ae3 : CMP AX,word ptr [ECX + 0x10]
00736ae7 : JC 0x0073690a
00736aed : FSTP ST1
00736aef : MOV EDI,ECX
00736af1 : FSTP ST0
00736af3 : PUSH ESI
00736af4 : MOV ECX,EDI
00736af6 : CALL 0x007377f0
00736afb : PUSH ESI
00736afc : CALL 0x0070a260
00736b01 : ADD ESP,0x4
00736b04 : POP EDI
00736b05 : POP ESI
00736b06 : POP EBX
00736b07 : MOV ESP,EBP
00736b09 : POP EBP
00736b0a : RET 0x18

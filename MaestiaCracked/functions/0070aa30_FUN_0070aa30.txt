PROGRAM  : Maestia.exe
FUNCTION : FUN_0070aa30
ENTRY    : 0070aa30
BODY     : [[0070aa30, 0070ab1f]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_0070aa30(int param_1)

{
  FILE *_File;
  wint_t wVar1;
  wint_t *pwVar2;
  int in_ECX;
  undefined4 extraout_EDX;
  int iVar3;
  wint_t local_2014;
  undefined1 local_2012 [8190];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1759c;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  pwVar2 = &local_2014;
  iVar3 = param_1;
  wVar1 = __fgetwc_nolock(*(FILE **)(in_ECX + 0x10));
  while ((wVar1 != 0xffff && (wVar1 != 0))) {
    _File = *(FILE **)(in_ECX + 0x10);
    *pwVar2 = wVar1;
    pwVar2 = pwVar2 + 1;
    wVar1 = __fgetwc_nolock(_File);
  }
  *pwVar2 = 0;
  *(undefined4 *)(param_1 + 0x14) = 0;
  *(undefined4 *)(param_1 + 0x18) = 7;
  *(undefined2 *)(param_1 + 4) = 0;
  pwVar2 = &local_2014;
  do {
    wVar1 = *pwVar2;
    pwVar2 = pwVar2 + 1;
  } while (wVar1 != 0);
  FUN_00406360(&local_2014,(int)pwVar2 - (int)local_2012 >> 1);
  local_8 = 0;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc,extraout_EDX,iVar3,1);
  return;
}



============================================================
DISASSEMBLY
============================================================
0070aa30 : PUSH EBP
0070aa31 : MOV EBP,ESP
0070aa33 : PUSH -0x1
0070aa35 : PUSH 0xb1759c
0070aa3a : MOV EAX,FS:[0x0]
0070aa40 : PUSH EAX
0070aa41 : MOV EAX,0x200c
0070aa46 : CALL 0x0063b780
0070aa4b : MOV EAX,[0x00d66fa0]
0070aa50 : XOR EAX,EBP
0070aa52 : MOV dword ptr [EBP + -0x10],EAX
0070aa55 : PUSH EBX
0070aa56 : PUSH ESI
0070aa57 : PUSH EDI
0070aa58 : PUSH EAX
0070aa59 : LEA EAX,[EBP + -0xc]
0070aa5c : MOV FS:[0x0],EAX
0070aa62 : MOV EBX,dword ptr [EBP + 0x8]
0070aa65 : MOV EDI,ECX
0070aa67 : MOV dword ptr [EBP + 0xffffdfec],0x0
0070aa71 : MOV EAX,dword ptr [EDI + 0x10]
0070aa74 : PUSH EAX
0070aa75 : MOV dword ptr [EBP + 0xffffdfe8],EBX
0070aa7b : LEA ESI,[EBP + 0xffffdff0]
0070aa81 : CALL 0x0063e2a3
0070aa86 : MOVZX EAX,AX
0070aa89 : ADD ESP,0x4
0070aa8c : CMP EAX,0xffff
0070aa91 : JZ 0x0070aab3
0070aa93 : TEST EAX,EAX
0070aa95 : JZ 0x0070aab3
0070aa97 : MOV ECX,dword ptr [EDI + 0x10]
0070aa9a : MOV word ptr [ESI],AX
0070aa9d : PUSH ECX
0070aa9e : ADD ESI,0x2
0070aaa1 : CALL 0x0063e2a3
0070aaa6 : MOVZX EAX,AX
0070aaa9 : ADD ESP,0x4
0070aaac : CMP EAX,0xffff
0070aab1 : JNZ 0x0070aa93
0070aab3 : XOR EDX,EDX
0070aab5 : XOR EAX,EAX
0070aab7 : MOV word ptr [ESI],DX
0070aaba : MOV dword ptr [EBX + 0x14],EDX
0070aabd : MOV dword ptr [EBX + 0x18],0x7
0070aac4 : MOV word ptr [EBX + 0x4],AX
0070aac8 : LEA EAX,[EBP + 0xffffdff0]
0070aace : LEA EDX,[EAX + 0x2]
0070aad1 : MOV CX,word ptr [EAX]
0070aad4 : ADD EAX,0x2
0070aad7 : TEST CX,CX
0070aada : JNZ 0x0070aad1
0070aadc : SUB EAX,EDX
0070aade : SAR EAX,0x1
0070aae0 : PUSH EAX
0070aae1 : LEA ECX,[EBP + 0xffffdff0]
0070aae7 : PUSH ECX
0070aae8 : MOV ECX,EBX
0070aaea : CALL 0x00406360
0070aaef : MOV dword ptr [EBP + -0x4],0x0
0070aaf6 : MOV dword ptr [EBP + 0xffffdfec],0x1
0070ab00 : MOV EAX,EBX
0070ab02 : MOV ECX,dword ptr [EBP + -0xc]
0070ab05 : MOV dword ptr FS:[0x0],ECX
0070ab0c : POP ECX
0070ab0d : POP EDI
0070ab0e : POP ESI
0070ab0f : POP EBX
0070ab10 : MOV ECX,dword ptr [EBP + -0x10]
0070ab13 : XOR ECX,EBP
0070ab15 : CALL 0x00633e6b
0070ab1a : MOV ESP,EBP
0070ab1c : POP EBP
0070ab1d : RET 0x4

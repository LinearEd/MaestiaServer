PROGRAM  : Maestia.exe
FUNCTION : FUN_00873320
ENTRY    : 00873320
BODY     : [[00873320, 00873595] [008735a0, 008737b7] [008737c0, 00873806]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00873320(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  short sVar1;
  uint uVar2;
  int *piVar3;
  int iVar4;
  int *piVar5;
  int *in_ECX;
  undefined4 uVar6;
  undefined1 auStack_cc [4];
  uint local_c8;
  int local_c4;
  uint local_c0;
  undefined4 local_bc;
  undefined4 local_b8;
  undefined4 local_b4;
  undefined4 local_b0;
  undefined1 local_ac [4];
  undefined2 uStack_a8;
  undefined4 uStack_98;
  uint uStack_94;
  undefined1 auStack_90 [4];
  int iStack_8c;
  int iStack_88;
  int iStack_84;
  int iStack_80;
  int iStack_7c;
  undefined1 uStack_3b;
  undefined4 uStack_2c;
  undefined4 uStack_28;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b632ca;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_cc;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xffffff28;
  ExceptionList = &local_14;
  if ((uint)in_ECX[0xc5] < 2) {
    if ((in_ECX[0x113] != 0) && (*(short *)(in_ECX[0x113] + 0xe4) != 0)) {
      iVar4 = in_ECX[0x9d];
      local_c8 = DAT_00da93ec;
      piVar3 = (int *)FUN_00a1a840(iVar4);
      if ((piVar3 != (int *)0x0) ||
         ((piVar3 = (int *)FUN_00a1a6d0(iVar4), piVar3 != (int *)0x0 ||
          (piVar3 = (int *)FUN_00a1a780(iVar4), piVar3 != (int *)0x0)))) {
        FUN_00406460(&DAT_00c42914);
        local_c = 0;
        local_c0 = CONCAT31(local_c0._1_3_,(char)in_ECX[0x33]);
        local_bc = CONCAT31(local_bc._1_3_,(char)in_ECX[0x36]);
        local_c4 = CONCAT31(local_c4._1_3_,*(undefined1 *)((int)in_ECX + 0xd9));
        local_c8 = CONCAT31(local_c8._1_3_,*(undefined1 *)((int)in_ECX + 0xda));
        (**(code **)(*piVar3 + 0x2fc))
                  (in_ECX[1],in_ECX[0xb1],local_bc,local_c8,local_c4,local_ac,local_c0,param_3,uVar2
                  );
        uStack_2c = 0xffffffff;
        FUN_00406560();
        sVar1 = (**(code **)(*in_ECX + 0x1e4))();
        if (sVar1 == 2) {
          sVar1 = *(short *)((int)in_ECX + 0x43a);
          if (sVar1 != 1) {
            if (sVar1 == 2) {
              uVar6 = 4;
            }
            else if (sVar1 == 0x1c) {
              uVar6 = 5;
            }
            else {
              if (sVar1 != 0x1d) goto LAB_008734ab;
              uVar6 = 0xb;
            }
            iVar4 = FUN_0088e570(uVar6);
            if (iVar4 != 0) goto LAB_008734ab;
          }
          FUN_0088e570(3);
        }
LAB_008734ab:
        if ((char)param_3 == '\0') goto LAB_008737e1;
        FUN_0040e250(auStack_90);
        local_c = 1;
        iStack_80 = in_ECX[1];
        iStack_7c = in_ECX[0x89];
        iStack_84 = piVar3[1];
        iStack_8c = in_ECX[0x3b];
        uStack_3b = *(undefined1 *)((int)in_ECX + 0xd9);
        auStack_90[0] = *(undefined1 *)((int)in_ECX + 0x1be);
        iStack_88 = in_ECX[0x75];
        if (*(char *)((int)in_ECX + 0xda) == '\x06') {
          uStack_28 = 0x17;
        }
        else if (iStack_8c == 0) {
          if ((in_ECX[0xb1] != 0) || (uStack_28 = 0x14, *(char *)((int)in_ECX + 0xda) != '\x01')) {
            uStack_28 = 0;
          }
        }
        else {
          uStack_28 = 2;
        }
        FUN_00883670(DAT_017248e4);
        local_c = 0xffffffff;
        FUN_00406bd0(auStack_90);
      }
    }
  }
  else {
    local_c8 = 0;
    if (in_ECX[0xc5] != 0) {
      piVar3 = in_ECX + 0xb1;
      do {
        if ((in_ECX[0x113] != 0) && (*(short *)(in_ECX[0x113] + 0xe4) != 0)) {
          local_c4 = piVar3[-0x14];
          local_c0 = DAT_00da93ec;
          piVar5 = (int *)FUN_00a1a840(local_c4);
          if ((piVar5 != (int *)0x0) ||
             ((piVar5 = (int *)FUN_00a1a6d0(local_c4), piVar5 != (int *)0x0 ||
              (piVar5 = (int *)FUN_00a1a780(local_c4), piVar5 != (int *)0x0)))) {
            FUN_00406460(&DAT_00c42918);
            local_c = 2;
            local_bc = CONCAT31(local_bc._1_3_,(char)in_ECX[0x33]);
            local_b0 = CONCAT31(local_b0._1_3_,*(undefined1 *)((int)in_ECX + 0xda));
            local_b4 = CONCAT31(local_b4._1_3_,(char)in_ECX[0x36]);
            local_b8 = CONCAT31(local_b8._1_3_,*(undefined1 *)((int)in_ECX + 0xd9));
            (**(code **)(*piVar5 + 0x2fc))
                      (in_ECX[1],*piVar3,local_b4,local_b0,local_b8,local_ac,local_bc,param_3);
            local_c = 0xffffffff;
            if (7 < uStack_94) {
                    /* WARNING: Subroutine does not return */
              FUN_006f04e0();
            }
            uStack_94 = 7;
            uStack_98 = 0;
            uStack_a8 = 0;
            if ((char)param_3 != '\0') {
              FUN_0040e250(auStack_90);
              local_c = 3;
              iStack_7c = piVar3[-0x28];
              iStack_80 = in_ECX[1];
              iStack_84 = piVar5[1];
              iStack_8c = in_ECX[0x3b];
              uStack_3b = *(undefined1 *)((int)in_ECX + 0xd9);
              auStack_90[0] = *(undefined1 *)((int)in_ECX + local_c8 + 0x1be);
              iStack_88 = piVar3[-0x3c];
              if (*(char *)((int)in_ECX + 0xda) == '\x06') {
                uStack_28 = 0x17;
              }
              else if (iStack_8c == 0) {
                if ((in_ECX[0xb1] != 0) ||
                   (uStack_28 = 0x14, *(char *)((int)in_ECX + 0xda) != '\x01')) {
                  uStack_28 = 0;
                }
              }
              else {
                uStack_28 = 2;
              }
              FUN_00883670(DAT_017248e4);
              local_c = 0xffffffff;
              FUN_00406bd0(auStack_90);
            }
          }
        }
        local_c8 = local_c8 + 1;
        piVar3 = piVar3 + 1;
      } while (local_c8 < (uint)in_ECX[0xc5]);
    }
  }
  if ((char)param_3 != '\0') {
    in_ECX[0xc5] = 0;
    iVar4 = 0;
    piVar3 = in_ECX + 0xb1;
    do {
      piVar3[-0x14] = 0;
      *piVar3 = 0;
      piVar3[-0x28] = 0;
      piVar3[-0x3c] = 0;
      *(undefined1 *)((int)in_ECX + iVar4 + 0x1be) = 0xff;
      iVar4 = iVar4 + 1;
      piVar3 = piVar3 + 1;
    } while (iVar4 < 0x14);
  }
LAB_008737e1:
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_cc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00873320 : PUSH EBP
00873321 : MOV EBP,ESP
00873323 : AND ESP,0xfffffff8
00873326 : PUSH -0x1
00873328 : PUSH 0xb632ca
0087332d : MOV EAX,FS:[0x0]
00873333 : PUSH EAX
00873334 : SUB ESP,0xb8
0087333a : MOV EAX,[0x00d66fa0]
0087333f : XOR EAX,ESP
00873341 : MOV dword ptr [ESP + 0xb0],EAX
00873348 : PUSH EBX
00873349 : PUSH ESI
0087334a : PUSH EDI
0087334b : MOV EAX,[0x00d66fa0]
00873350 : XOR EAX,ESP
00873352 : PUSH EAX
00873353 : LEA EAX,[ESP + 0xc8]
0087335a : MOV FS:[0x0],EAX
00873360 : MOV ESI,ECX
00873362 : MOV EAX,dword ptr [ESI + 0x314]
00873368 : CMP EAX,0x2
0087336b : JNC 0x0087357e
00873371 : MOV EAX,dword ptr [ESI + 0x44c]
00873377 : XOR EDX,EDX
00873379 : CMP EAX,EDX
0087337b : JZ 0x008737a0
00873381 : MOVZX EAX,word ptr [EAX + 0xe4]
00873388 : CMP AX,DX
0087338b : JZ 0x008737a0
00873391 : MOV EBX,dword ptr [ESI + 0x274]
00873397 : MOV ECX,dword ptr [0x00da93ec]
0087339d : PUSH EBX
0087339e : MOV dword ptr [ESP + 0x18],ECX
008733a2 : CALL 0x00a1a840
008733a7 : MOV EDI,EAX
008733a9 : TEST EDI,EDI
008733ab : JNZ 0x008733d1
008733ad : MOV ECX,dword ptr [ESP + 0x14]
008733b1 : PUSH EBX
008733b2 : CALL 0x00a1a6d0
008733b7 : MOV EDI,EAX
008733b9 : TEST EDI,EDI
008733bb : JNZ 0x008733d1
008733bd : MOV ECX,dword ptr [ESP + 0x14]
008733c1 : PUSH EBX
008733c2 : CALL 0x00a1a780
008733c7 : MOV EDI,EAX
008733c9 : TEST EDI,EDI
008733cb : JZ 0x0087379e
008733d1 : PUSH 0xc42914
008733d6 : LEA ECX,[ESP + 0x34]
008733da : CALL 0x00406460
008733df : XOR EBX,EBX
008733e1 : MOV dword ptr [ESP + 0xd0],EBX
008733e8 : MOVZX EAX,byte ptr [ESI + 0xcc]
008733ef : MOV CL,byte ptr [ESI + 0xd9]
008733f5 : MOV DL,byte ptr [ESI + 0xda]
008733fb : MOV byte ptr [ESP + 0x1c],AL
008733ff : MOVZX EAX,byte ptr [ESI + 0xd8]
00873406 : MOV byte ptr [ESP + 0x20],AL
0087340a : MOV EAX,dword ptr [EBP + 0x10]
0087340d : PUSH EAX
0087340e : MOV byte ptr [ESP + 0x1c],CL
00873412 : MOV ECX,dword ptr [ESP + 0x20]
00873416 : PUSH ECX
00873417 : MOV ECX,dword ptr [ESP + 0x20]
0087341b : MOV byte ptr [ESP + 0x1c],DL
0087341f : MOV EDX,dword ptr [EDI]
00873421 : MOV EDX,dword ptr [EDX + 0x2fc]
00873427 : LEA EAX,[ESP + 0x38]
0087342b : PUSH EAX
0087342c : MOV EAX,dword ptr [ESP + 0x20]
00873430 : PUSH ECX
00873431 : MOV ECX,dword ptr [ESP + 0x30]
00873435 : PUSH EAX
00873436 : MOV EAX,dword ptr [ESI + 0x2c4]
0087343c : PUSH ECX
0087343d : MOV ECX,dword ptr [ESI + 0x4]
00873440 : PUSH EAX
00873441 : PUSH ECX
00873442 : MOV ECX,EDI
00873444 : CALL EDX
00873446 : FSTP ST0
00873448 : MOV dword ptr [ESP + 0xd0],0xffffffff
00873453 : LEA ECX,[ESP + 0x30]
00873457 : CALL 0x00406560
0087345c : MOV EAX,dword ptr [ESI]
0087345e : MOV EDX,dword ptr [EAX + 0x1e4]
00873464 : MOV ECX,ESI
00873466 : CALL EDX
00873468 : CMP AX,0x2
0087346c : JNZ 0x008734ab
0087346e : MOVZX EAX,word ptr [ESI + 0x43a]
00873475 : CMP AX,0x1
00873479 : JZ 0x008734a2
0087347b : CMP AX,0x2
0087347f : JNZ 0x00873485
00873481 : PUSH 0x4
00873483 : JMP 0x00873497
00873485 : CMP AX,0x1c
00873489 : JNZ 0x0087348f
0087348b : PUSH 0x5
0087348d : JMP 0x00873497
0087348f : CMP AX,0x1d
00873493 : JNZ 0x008734ab
00873495 : PUSH 0xb
00873497 : MOV ECX,ESI
00873499 : CALL 0x0088e570
0087349e : TEST EAX,EAX
008734a0 : JNZ 0x008734ab
008734a2 : PUSH 0x3
008734a4 : MOV ECX,ESI
008734a6 : CALL 0x0088e570
008734ab : CMP byte ptr [EBP + 0x10],BL
008734ae : JZ 0x008737e1
008734b4 : LEA EAX,[ESP + 0x4c]
008734b8 : PUSH EAX
008734b9 : CALL 0x0040e250
008734be : MOV dword ptr [ESP + 0xd0],0x1
008734c9 : MOV ECX,dword ptr [ESI + 0x4]
008734cc : MOV EDX,dword ptr [ESI + 0x224]
008734d2 : MOV EDI,dword ptr [EDI + 0x4]
008734d5 : MOV EAX,dword ptr [ESI + 0xec]
008734db : MOV dword ptr [ESP + 0x5c],ECX
008734df : MOV CL,byte ptr [ESI + 0xd9]
008734e5 : MOV byte ptr [ESP + 0xa1],CL
008734ec : MOVZX ECX,byte ptr [ESI + 0x1be]
008734f3 : MOV byte ptr [ESP + 0x4c],CL
008734f7 : MOV CL,byte ptr [ESI + 0xda]
008734fd : MOV dword ptr [ESP + 0x60],EDX
00873501 : MOV EDX,dword ptr [ESI + 0x1d4]
00873507 : MOV dword ptr [ESP + 0x58],EDI
0087350b : MOV dword ptr [ESP + 0x50],EAX
0087350f : MOV dword ptr [ESP + 0x54],EDX
00873513 : CMP CL,0x6
00873516 : JNZ 0x00873525
00873518 : MOV dword ptr [ESP + 0xb4],0x17
00873523 : JMP 0x00873555
00873525 : CMP EAX,EBX
00873527 : JZ 0x00873536
00873529 : MOV dword ptr [ESP + 0xb4],0x2
00873534 : JMP 0x00873555
00873536 : CMP dword ptr [ESI + 0x2c4],EBX
0087353c : JA 0x0087354e
0087353e : MOV dword ptr [ESP + 0xb4],0x14
00873549 : CMP CL,0x1
0087354c : JZ 0x00873555
0087354e : MOV dword ptr [ESP + 0xb4],EBX
00873555 : MOV EAX,[0x017248e4]
0087355a : PUSH EAX
0087355b : LEA ECX,[ESP + 0x50]
0087355f : CALL 0x00883670
00873564 : MOV dword ptr [ESP + 0xd0],0xffffffff
0087356f : LEA ECX,[ESP + 0x4c]
00873573 : PUSH ECX
00873574 : CALL 0x00406bd0
00873579 : JMP 0x0087379e
0087357e : MOV dword ptr [ESP + 0x14],0x0
00873586 : TEST EAX,EAX
00873588 : JBE 0x0087379e
0087358e : LEA EBX,[ESI + 0x2c4]
00873594 : JMP 0x008735a0
008735a0 : MOV EAX,dword ptr [ESI + 0x44c]
008735a6 : TEST EAX,EAX
008735a8 : JZ 0x00873786
008735ae : MOVZX EAX,word ptr [EAX + 0xe4]
008735b5 : TEST AX,AX
008735b8 : JZ 0x00873786
008735be : MOV EAX,dword ptr [EBX + -0x50]
008735c1 : MOV ECX,dword ptr [0x00da93ec]
008735c7 : PUSH EAX
008735c8 : MOV dword ptr [ESP + 0x20],ECX
008735cc : MOV dword ptr [ESP + 0x1c],EAX
008735d0 : CALL 0x00a1a840
008735d5 : MOV EDI,EAX
008735d7 : TEST EDI,EDI
008735d9 : JNZ 0x00873607
008735db : MOV EDX,dword ptr [ESP + 0x18]
008735df : MOV ECX,dword ptr [ESP + 0x1c]
008735e3 : PUSH EDX
008735e4 : CALL 0x00a1a6d0
008735e9 : MOV EDI,EAX
008735eb : TEST EDI,EDI
008735ed : JNZ 0x00873607
008735ef : MOV EAX,dword ptr [ESP + 0x18]
008735f3 : MOV ECX,dword ptr [ESP + 0x1c]
008735f7 : PUSH EAX
008735f8 : CALL 0x00a1a780
008735fd : MOV EDI,EAX
008735ff : TEST EDI,EDI
00873601 : JZ 0x00873786
00873607 : PUSH 0xc42918
0087360c : LEA ECX,[ESP + 0x34]
00873610 : CALL 0x00406460
00873615 : MOV dword ptr [ESP + 0xd0],0x2
00873620 : MOVZX ECX,byte ptr [ESI + 0xcc]
00873627 : MOV AL,byte ptr [ESI + 0xda]
0087362d : MOV DL,byte ptr [ESI + 0xd9]
00873633 : MOV byte ptr [ESP + 0x20],CL
00873637 : MOVZX ECX,byte ptr [ESI + 0xd8]
0087363e : MOV byte ptr [ESP + 0x2c],AL
00873642 : MOV EAX,dword ptr [EBP + 0x10]
00873645 : PUSH EAX
00873646 : MOV byte ptr [ESP + 0x2c],CL
0087364a : MOV ECX,dword ptr [ESP + 0x24]
0087364e : PUSH ECX
0087364f : MOV byte ptr [ESP + 0x2c],DL
00873653 : MOV ECX,dword ptr [ESP + 0x2c]
00873657 : MOV EDX,dword ptr [EDI]
00873659 : MOV EDX,dword ptr [EDX + 0x2fc]
0087365f : LEA EAX,[ESP + 0x38]
00873663 : PUSH EAX
00873664 : MOV EAX,dword ptr [ESP + 0x38]
00873668 : PUSH ECX
00873669 : MOV ECX,dword ptr [ESP + 0x38]
0087366d : PUSH EAX
0087366e : MOV EAX,dword ptr [EBX]
00873670 : PUSH ECX
00873671 : MOV ECX,dword ptr [ESI + 0x4]
00873674 : PUSH EAX
00873675 : PUSH ECX
00873676 : MOV ECX,EDI
00873678 : CALL EDX
0087367a : FSTP ST0
0087367c : MOV dword ptr [ESP + 0xd0],0xffffffff
00873687 : CMP dword ptr [ESP + 0x48],0x8
0087368c : JC 0x00873697
0087368e : MOV ECX,dword ptr [ESP + 0x34]
00873692 : CALL 0x006f04e0
00873697 : XOR EAX,EAX
00873699 : MOV dword ptr [ESP + 0x48],0x7
008736a1 : MOV dword ptr [ESP + 0x44],0x0
008736a9 : MOV word ptr [ESP + 0x34],AX
008736ae : CMP byte ptr [EBP + 0x10],AL
008736b1 : JZ 0x00873786
008736b7 : LEA ECX,[ESP + 0x4c]
008736bb : PUSH ECX
008736bc : CALL 0x0040e250
008736c1 : MOV dword ptr [ESP + 0xd0],0x3
008736cc : MOV ECX,dword ptr [EBX + 0xffffff60]
008736d2 : MOV EDX,dword ptr [ESI + 0x4]
008736d5 : MOV EDI,dword ptr [EDI + 0x4]
008736d8 : MOV EAX,dword ptr [ESI + 0xec]
008736de : MOV dword ptr [ESP + 0x60],ECX
008736e2 : MOV CL,byte ptr [ESI + 0xd9]
008736e8 : MOV dword ptr [ESP + 0x5c],EDX
008736ec : MOV EDX,dword ptr [ESP + 0x14]
008736f0 : MOV byte ptr [ESP + 0xa1],CL
008736f7 : MOVZX ECX,byte ptr [ESI + EDX*0x1 + 0x1be]
008736ff : MOV EDX,dword ptr [EBX + 0xffffff10]
00873705 : MOV byte ptr [ESP + 0x4c],CL
00873709 : MOV CL,byte ptr [ESI + 0xda]
0087370f : MOV dword ptr [ESP + 0x58],EDI
00873713 : MOV dword ptr [ESP + 0x50],EAX
00873717 : MOV dword ptr [ESP + 0x54],EDX
0087371b : CMP CL,0x6
0087371e : JNZ 0x0087372d
00873720 : MOV dword ptr [ESP + 0xb4],0x17
0087372b : JMP 0x00873762
0087372d : TEST EAX,EAX
0087372f : JZ 0x0087373e
00873731 : MOV dword ptr [ESP + 0xb4],0x2
0087373c : JMP 0x00873762
0087373e : CMP dword ptr [ESI + 0x2c4],0x0
00873745 : JA 0x00873757
00873747 : MOV dword ptr [ESP + 0xb4],0x14
00873752 : CMP CL,0x1
00873755 : JZ 0x00873762
00873757 : MOV dword ptr [ESP + 0xb4],0x0
00873762 : MOV EAX,[0x017248e4]
00873767 : PUSH EAX
00873768 : LEA ECX,[ESP + 0x50]
0087376c : CALL 0x00883670
00873771 : MOV dword ptr [ESP + 0xd0],0xffffffff
0087377c : LEA ECX,[ESP + 0x4c]
00873780 : PUSH ECX
00873781 : CALL 0x00406bd0
00873786 : MOV EAX,dword ptr [ESP + 0x14]
0087378a : INC EAX
0087378b : ADD EBX,0x4
0087378e : MOV dword ptr [ESP + 0x14],EAX
00873792 : CMP EAX,dword ptr [ESI + 0x314]
00873798 : JC 0x008735a0
0087379e : XOR EDX,EDX
008737a0 : CMP byte ptr [EBP + 0x10],0x0
008737a4 : JZ 0x008737e1
008737a6 : MOV dword ptr [ESI + 0x314],EDX
008737ac : XOR ECX,ECX
008737ae : LEA EAX,[ESI + 0x2c4]
008737b4 : MOV BL,0xff
008737b6 : JMP 0x008737c0
008737c0 : MOV dword ptr [EAX + -0x50],EDX
008737c3 : MOV dword ptr [EAX],EDX
008737c5 : MOV dword ptr [EAX + 0xffffff60],EDX
008737cb : MOV dword ptr [EAX + 0xffffff10],EDX
008737d1 : MOV byte ptr [ESI + ECX*0x1 + 0x1be],BL
008737d8 : INC ECX
008737d9 : ADD EAX,0x4
008737dc : CMP ECX,0x14
008737df : JL 0x008737c0
008737e1 : MOV ECX,dword ptr [ESP + 0xc8]
008737e8 : MOV dword ptr FS:[0x0],ECX
008737ef : POP ECX
008737f0 : POP EDI
008737f1 : POP ESI
008737f2 : POP EBX
008737f3 : MOV ECX,dword ptr [ESP + 0xb0]
008737fa : XOR ECX,ESP
008737fc : CALL 0x00633e6b
00873801 : MOV ESP,EBP
00873803 : POP EBP
00873804 : RET 0xc

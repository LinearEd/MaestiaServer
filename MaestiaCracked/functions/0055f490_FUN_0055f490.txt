PROGRAM  : Maestia.exe
FUNCTION : FUN_0055f490
ENTRY    : 0055f490
BODY     : [[0055f490, 0055f6a0]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_0055f490(undefined4 *param_1,int param_2)

{
  ushort uVar1;
  short sVar2;
  undefined4 uVar3;
  char cVar4;
  int in_ECX;
  
  *param_1 = &PTR_FUN_00cd3f2c;
  param_1[1] = 1;
  *param_1 = &PTR_FUN_00b86064;
  param_1[2] = 0;
  *(undefined2 *)(param_1 + 3) = 0;
  *(undefined2 *)((int)param_1 + 0xe) = 0;
  *(undefined2 *)(param_1 + 4) = 0;
  *(undefined2 *)((int)param_1 + 0x12) = 0;
  *(undefined2 *)(param_1 + 5) = 0;
  *(undefined2 *)((int)param_1 + 0x16) = 0;
  if ((((*(byte *)(in_ECX + 0x16) & 1) != 0) && ((*(byte *)(param_2 + 0x16) & 1) != 0)) &&
     (((*(ushort *)(in_ECX + 0x16) ^ *(ushort *)(param_2 + 0x16)) & 0x600) == 0)) {
    *(ushort *)((int)param_1 + 0x16) = (*(ushort *)(param_2 + 0x16) >> 9 & 3) << 9 | 1;
  }
  if ((((char)*(undefined2 *)(in_ECX + 0x16) < '\0') &&
      (uVar1 = *(ushort *)(param_2 + 0x16), (char)uVar1 < '\0')) &&
     (SUB21((ushort)*(undefined2 *)(in_ECX + 0x16) >> 0xf,0) == ((uVar1 & 0x8000) != 0))) {
    FUN_0053b320((uVar1 & 0x8000) != 0);
  }
  if ((((*(byte *)(in_ECX + 0x16) >> 1 & 1) != 0) && ((*(byte *)(param_2 + 0x16) >> 1 & 1) != 0)) &&
     (sVar2 = *(short *)(param_2 + 0xc), *(short *)(in_ECX + 0xc) == sVar2)) {
    *(ushort *)((int)param_1 + 0x16) = *(ushort *)((int)param_1 + 0x16) | 2;
    *(short *)(param_1 + 3) = sVar2;
  }
  if ((((*(byte *)(in_ECX + 0x16) >> 2 & 1) != 0) && ((*(byte *)(param_2 + 0x16) >> 2 & 1) != 0)) &&
     (sVar2 = *(short *)(param_2 + 0xe), *(short *)(in_ECX + 0xe) == sVar2)) {
    *(ushort *)((int)param_1 + 0x16) = *(ushort *)((int)param_1 + 0x16) | 4;
    *(short *)((int)param_1 + 0xe) = sVar2;
  }
  if ((((*(byte *)(in_ECX + 0x16) >> 3 & 1) != 0) && ((*(byte *)(param_2 + 0x16) >> 3 & 1) != 0)) &&
     (sVar2 = *(short *)(param_2 + 0x10), *(short *)(in_ECX + 0x10) == sVar2)) {
    *(ushort *)((int)param_1 + 0x16) = *(ushort *)((int)param_1 + 0x16) | 8;
    *(short *)(param_1 + 4) = sVar2;
  }
  if ((((*(byte *)(in_ECX + 0x16) >> 4 & 1) != 0) && ((*(byte *)(param_2 + 0x16) >> 4 & 1) != 0)) &&
     (sVar2 = *(short *)(param_2 + 0x12), *(short *)(in_ECX + 0x12) == sVar2)) {
    *(ushort *)((int)param_1 + 0x16) = *(ushort *)((int)param_1 + 0x16) | 0x10;
    *(short *)((int)param_1 + 0x12) = sVar2;
  }
  if ((((*(byte *)(in_ECX + 0x16) >> 5 & 1) != 0) && ((*(byte *)(param_2 + 0x16) >> 5 & 1) != 0)) &&
     (sVar2 = *(short *)(param_2 + 0x14), *(short *)(in_ECX + 0x14) == sVar2)) {
    *(ushort *)((int)param_1 + 0x16) = *(ushort *)((int)param_1 + 0x16) | 0x20;
    *(short *)(param_1 + 5) = sVar2;
  }
  if (((*(byte *)(in_ECX + 0x16) >> 6 & 1) != 0) && ((*(byte *)(param_2 + 0x16) >> 6 & 1) != 0)) {
    uVar3 = *(undefined4 *)(param_2 + 8);
    cVar4 = FUN_0055e7e0(uVar3);
    if (cVar4 != '\0') {
      FUN_0055ef90(uVar3);
    }
  }
  if ((((*(ushort *)(in_ECX + 0x16) >> 8 & 1) != 0) &&
      (uVar1 = *(ushort *)(param_2 + 0x16), (uVar1 >> 8 & 1) != 0)) &&
     (((*(ushort *)(in_ECX + 0x16) ^ uVar1) & 0x1800) == 0)) {
    *(ushort *)((int)param_1 + 0x16) =
         ((uVar1 >> 0xb & 3) << 0xb ^ *(ushort *)((int)param_1 + 0x16)) & 0x1800 ^
         *(ushort *)((int)param_1 + 0x16) | 0x100;
  }
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
0055f490 : PUSH EBP
0055f491 : MOV EBP,dword ptr [ESP + 0xc]
0055f495 : PUSH ESI
0055f496 : MOV ESI,dword ptr [ESP + 0xc]
0055f49a : PUSH EDI
0055f49b : MOV EDI,ECX
0055f49d : XOR EAX,EAX
0055f49f : XOR ECX,ECX
0055f4a1 : XOR EDX,EDX
0055f4a3 : MOV dword ptr [ESI],0xcd3f2c
0055f4a9 : MOV dword ptr [ESI + 0x4],0x1
0055f4b0 : MOV dword ptr [ESI],0xb86064
0055f4b6 : MOV dword ptr [ESI + 0x8],0x0
0055f4bd : MOV word ptr [ESI + 0xc],AX
0055f4c1 : MOV word ptr [ESI + 0xe],CX
0055f4c5 : MOV word ptr [ESI + 0x10],DX
0055f4c9 : MOV word ptr [ESI + 0x12],AX
0055f4cd : MOV word ptr [ESI + 0x14],CX
0055f4d1 : MOV word ptr [ESI + 0x16],DX
0055f4d5 : TEST byte ptr [EDI + 0x16],0x1
0055f4d9 : JZ 0x0055f509
0055f4db : TEST byte ptr [EBP + 0x16],0x1
0055f4df : JZ 0x0055f509
0055f4e1 : MOVZX EAX,word ptr [EBP + 0x16]
0055f4e5 : MOV CX,word ptr [EDI + 0x16]
0055f4e9 : XOR CX,AX
0055f4ec : MOV EDX,0x600
0055f4f1 : TEST DX,CX
0055f4f4 : JNZ 0x0055f509
0055f4f6 : SHR EAX,0x9
0055f4f9 : AND EAX,0x3
0055f4fc : AND EAX,0x3
0055f4ff : SHL EAX,0x9
0055f502 : OR EAX,0x1
0055f505 : MOV word ptr [ESI + 0x16],AX
0055f509 : MOVZX EAX,word ptr [EDI + 0x16]
0055f50d : MOV CL,AL
0055f50f : SHR CL,0x7
0055f512 : TEST CL,0x1
0055f515 : JZ 0x0055f54d
0055f517 : MOVZX EDX,word ptr [EBP + 0x16]
0055f51b : MOV CL,DL
0055f51d : SHR CL,0x7
0055f520 : TEST CL,0x1
0055f523 : JZ 0x0055f54d
0055f525 : SHR EAX,0xf
0055f528 : AND EAX,0x1
0055f52b : AND EDX,0x8000
0055f531 : MOV ECX,0x0
0055f536 : SETNZ CL
0055f539 : CMP AL,CL
0055f53b : JNZ 0x0055f54d
0055f53d : XOR EAX,EAX
0055f53f : TEST DX,DX
0055f542 : SETNZ AL
0055f545 : MOV ECX,ESI
0055f547 : PUSH EAX
0055f548 : CALL 0x0053b320
0055f54d : MOV DL,byte ptr [EDI + 0x16]
0055f550 : SHR DL,0x1
0055f552 : TEST DL,0x1
0055f555 : JZ 0x0055f576
0055f557 : MOV AL,byte ptr [EBP + 0x16]
0055f55a : SHR AL,0x1
0055f55c : TEST AL,0x1
0055f55e : JZ 0x0055f576
0055f560 : MOVZX EAX,word ptr [EBP + 0xc]
0055f564 : CMP word ptr [EDI + 0xc],AX
0055f568 : JNZ 0x0055f576
0055f56a : OR word ptr [ESI + 0x16],0x2
0055f56f : MOVZX EAX,AX
0055f572 : MOV word ptr [ESI + 0xc],AX
0055f576 : MOV CL,byte ptr [EDI + 0x16]
0055f579 : SHR CL,0x2
0055f57c : TEST CL,0x1
0055f57f : JZ 0x0055f5a0
0055f581 : MOV DL,byte ptr [EBP + 0x16]
0055f584 : SHR DL,0x2
0055f587 : TEST DL,0x1
0055f58a : JZ 0x0055f5a0
0055f58c : MOVZX EAX,word ptr [EBP + 0xe]
0055f590 : CMP word ptr [EDI + 0xe],AX
0055f594 : JNZ 0x0055f5a0
0055f596 : OR word ptr [ESI + 0x16],0x4
0055f59b : CWDE
0055f59c : MOV word ptr [ESI + 0xe],AX
0055f5a0 : MOV AL,byte ptr [EDI + 0x16]
0055f5a3 : SHR AL,0x3
0055f5a6 : TEST AL,0x1
0055f5a8 : JZ 0x0055f5c9
0055f5aa : MOV CL,byte ptr [EBP + 0x16]
0055f5ad : SHR CL,0x3
0055f5b0 : TEST CL,0x1
0055f5b3 : JZ 0x0055f5c9
0055f5b5 : MOVZX EAX,word ptr [EBP + 0x10]
0055f5b9 : CMP word ptr [EDI + 0x10],AX
0055f5bd : JNZ 0x0055f5c9
0055f5bf : OR word ptr [ESI + 0x16],0x8
0055f5c4 : CWDE
0055f5c5 : MOV word ptr [ESI + 0x10],AX
0055f5c9 : MOV DL,byte ptr [EDI + 0x16]
0055f5cc : SHR DL,0x4
0055f5cf : TEST DL,0x1
0055f5d2 : JZ 0x0055f5f4
0055f5d4 : MOV AL,byte ptr [EBP + 0x16]
0055f5d7 : SHR AL,0x4
0055f5da : TEST AL,0x1
0055f5dc : JZ 0x0055f5f4
0055f5de : MOVZX EAX,word ptr [EBP + 0x12]
0055f5e2 : CMP word ptr [EDI + 0x12],AX
0055f5e6 : JNZ 0x0055f5f4
0055f5e8 : OR word ptr [ESI + 0x16],0x10
0055f5ed : MOVZX EAX,AX
0055f5f0 : MOV word ptr [ESI + 0x12],AX
0055f5f4 : MOV CL,byte ptr [EDI + 0x16]
0055f5f7 : SHR CL,0x5
0055f5fa : TEST CL,0x1
0055f5fd : JZ 0x0055f620
0055f5ff : MOV DL,byte ptr [EBP + 0x16]
0055f602 : SHR DL,0x5
0055f605 : TEST DL,0x1
0055f608 : JZ 0x0055f620
0055f60a : MOVZX EAX,word ptr [EBP + 0x14]
0055f60e : CMP word ptr [EDI + 0x14],AX
0055f612 : JNZ 0x0055f620
0055f614 : OR word ptr [ESI + 0x16],0x20
0055f619 : MOVZX EAX,AX
0055f61c : MOV word ptr [ESI + 0x14],AX
0055f620 : MOV AL,byte ptr [EDI + 0x16]
0055f623 : SHR AL,0x6
0055f626 : TEST AL,0x1
0055f628 : JZ 0x0055f64e
0055f62a : MOV CL,byte ptr [EBP + 0x16]
0055f62d : SHR CL,0x6
0055f630 : TEST CL,0x1
0055f633 : JZ 0x0055f64e
0055f635 : PUSH EBX
0055f636 : MOV EBX,dword ptr [EBP + 0x8]
0055f639 : PUSH EBX
0055f63a : MOV ECX,EDI
0055f63c : CALL 0x0055e7e0
0055f641 : TEST AL,AL
0055f643 : JZ 0x0055f64d
0055f645 : PUSH EBX
0055f646 : MOV ECX,ESI
0055f648 : CALL 0x0055ef90
0055f64d : POP EBX
0055f64e : MOVZX ECX,word ptr [EDI + 0x16]
0055f652 : MOV EDX,ECX
0055f654 : SHR EDX,0x8
0055f657 : TEST DL,0x1
0055f65a : JZ 0x0055f699
0055f65c : MOVZX EAX,word ptr [EBP + 0x16]
0055f660 : MOV EDX,EAX
0055f662 : SHR EDX,0x8
0055f665 : TEST DL,0x1
0055f668 : JZ 0x0055f699
0055f66a : XOR ECX,EAX
0055f66c : TEST ECX,0x1800
0055f672 : JNZ 0x0055f699
0055f674 : SHR EAX,0xb
0055f677 : AND EAX,0x3
0055f67a : SHL EAX,0xb
0055f67d : XOR AX,word ptr [ESI + 0x16]
0055f681 : MOV ECX,0x1800
0055f686 : AND AX,CX
0055f689 : XOR AX,word ptr [ESI + 0x16]
0055f68d : MOV EDX,0x100
0055f692 : OR AX,DX
0055f695 : MOV word ptr [ESI + 0x16],AX
0055f699 : POP EDI
0055f69a : MOV EAX,ESI
0055f69c : POP ESI
0055f69d : POP EBP
0055f69e : RET 0x8

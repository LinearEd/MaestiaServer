PROGRAM  : Maestia.exe
FUNCTION : FUN_006e2f00
ENTRY    : 006e2f00
BODY     : [[006e2f00, 006e2f76] [006e2f80, 006e309f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006e2f00(int param_1,int param_2,undefined4 *param_3,int param_4)

{
  int iVar1;
  byte bVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  uint uVar10;
  int iVar11;
  int *piVar12;
  short *psVar13;
  byte *pbVar14;
  int iVar15;
  int iVar16;
  char *pcVar17;
  int local_2c;
  int local_1c;
  int local_18;
  
  iVar3 = *(int *)(param_1 + 0x5c);
  iVar4 = *(int *)(param_1 + 0x120);
  iVar5 = *(int *)(param_1 + 100);
  iVar6 = *(int *)(param_1 + 0x1a8);
  if (0 < param_4) {
    param_2 = param_2 - (int)param_3;
    local_18 = param_4;
    do {
      FUN_006d9620(*param_3,iVar3);
      local_1c = 0;
      if (0 < iVar5) {
        piVar12 = (int *)(iVar6 + 0x44);
        do {
          pcVar17 = (char *)*param_3;
          psVar13 = (short *)*piVar12;
          pbVar14 = (byte *)(*(int *)(param_2 + (int)param_3) + local_1c);
          if (*(char *)(iVar6 + 0x54) == '\0') {
            iVar16 = 1;
            iVar15 = iVar5;
          }
          else {
            pcVar17 = pcVar17 + iVar3 + -1;
            pbVar14 = pbVar14 + (iVar3 + -1) * iVar5;
            iVar16 = -1;
            psVar13 = psVar13 + iVar3 + 1;
            iVar15 = -iVar5;
          }
          iVar7 = *(int *)(*(int *)(iVar6 + 0x18) + local_1c * 4);
          iVar8 = *(int *)(*(int *)(iVar6 + 0x10) + local_1c * 4);
          iVar9 = 0;
          param_4 = 0;
          param_4._0_2_ = 0;
          local_2c = 0;
          for (iVar1 = iVar3; iVar1 != 0; iVar1 = iVar1 + -1) {
            bVar2 = *pbVar14;
            pbVar14 = pbVar14 + iVar15;
            uVar10 = (uint)*(byte *)((uint)bVar2 + (psVar13[iVar16] + 8 + iVar9 >> 4) + iVar4);
            bVar2 = *(byte *)(uVar10 + iVar7);
            *pcVar17 = *pcVar17 + bVar2;
            iVar11 = uVar10 - *(byte *)((uint)bVar2 + iVar8);
            *psVar13 = (short)param_4 + (short)iVar11 * 3;
            param_4 = local_2c + iVar11 * 5;
            iVar9 = iVar11 * 7;
            pcVar17 = pcVar17 + iVar16;
            psVar13 = psVar13 + iVar16;
            local_2c = iVar11;
          }
          piVar12 = piVar12 + 1;
          local_1c = local_1c + 1;
          *psVar13 = (short)param_4;
        } while (local_1c < iVar5);
      }
      param_3 = param_3 + 1;
      local_18 = local_18 + -1;
      *(bool *)(iVar6 + 0x54) = *(char *)(iVar6 + 0x54) == '\0';
    } while (local_18 != 0);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
006e2f00 : SUB ESP,0x38
006e2f03 : MOV EAX,dword ptr [ESP + 0x3c]
006e2f07 : MOV ECX,dword ptr [EAX + 0x5c]
006e2f0a : MOV EDX,dword ptr [EAX + 0x120]
006e2f10 : PUSH EBP
006e2f11 : MOV EBP,dword ptr [EAX + 0x64]
006e2f14 : PUSH ESI
006e2f15 : MOV ESI,dword ptr [EAX + 0x1a8]
006e2f1b : MOV EAX,dword ptr [ESP + 0x50]
006e2f1f : MOV dword ptr [ESP + 0xc],ESI
006e2f23 : MOV dword ptr [ESP + 0x20],EBP
006e2f27 : MOV dword ptr [ESP + 0x44],ECX
006e2f2b : MOV dword ptr [ESP + 0x30],EDX
006e2f2f : TEST EAX,EAX
006e2f31 : JLE 0x006e309a
006e2f37 : MOV ECX,dword ptr [ESP + 0x48]
006e2f3b : PUSH EBX
006e2f3c : PUSH EDI
006e2f3d : MOV EDI,dword ptr [ESP + 0x54]
006e2f41 : SUB ECX,EDI
006e2f43 : MOV dword ptr [ESP + 0x18],EDI
006e2f47 : MOV dword ptr [ESP + 0x34],ECX
006e2f4b : MOV dword ptr [ESP + 0x30],EAX
006e2f4f : NOP
006e2f50 : MOV EAX,dword ptr [ESP + 0x4c]
006e2f54 : MOV ECX,dword ptr [EDI]
006e2f56 : PUSH EAX
006e2f57 : PUSH ECX
006e2f58 : CALL 0x006d9620
006e2f5d : XOR EDX,EDX
006e2f5f : ADD ESP,0x8
006e2f62 : MOV dword ptr [ESP + 0x2c],EDX
006e2f66 : TEST EBP,EBP
006e2f68 : JLE 0x006e307c
006e2f6e : LEA ECX,[ESI + 0x44]
006e2f71 : MOV dword ptr [ESP + 0x10],ECX
006e2f75 : JMP 0x006e2f84
006e2f80 : MOV ECX,dword ptr [ESP + 0x10]
006e2f84 : MOV EAX,dword ptr [ESP + 0x34]
006e2f88 : MOV EBX,dword ptr [EAX + EDI*0x1]
006e2f8b : MOV EDI,dword ptr [EDI]
006e2f8d : MOV ECX,dword ptr [ECX]
006e2f8f : ADD EBX,EDX
006e2f91 : CMP byte ptr [ESI + 0x54],0x0
006e2f95 : JZ 0x006e2fb4
006e2f97 : MOV EAX,dword ptr [ESP + 0x4c]
006e2f9b : DEC EAX
006e2f9c : MOV ESI,EAX
006e2f9e : IMUL ESI,EBP
006e2fa1 : ADD EDI,EAX
006e2fa3 : MOV EAX,dword ptr [ESP + 0x4c]
006e2fa7 : ADD EBX,ESI
006e2fa9 : OR ESI,0xffffffff
006e2fac : NEG EBP
006e2fae : LEA ECX,[ECX + EAX*0x2 + 0x2]
006e2fb2 : JMP 0x006e2fb9
006e2fb4 : MOV ESI,0x1
006e2fb9 : MOV EAX,dword ptr [ESP + 0x14]
006e2fbd : MOV dword ptr [ESP + 0x20],EBP
006e2fc1 : MOV EBP,dword ptr [EAX + 0x18]
006e2fc4 : MOV EAX,dword ptr [EAX + 0x10]
006e2fc7 : MOV EBP,dword ptr [EBP + EDX*0x4]
006e2fcb : MOV EAX,dword ptr [EAX + EDX*0x4]
006e2fce : MOV dword ptr [ESP + 0x3c],EBP
006e2fd2 : MOV EBP,dword ptr [ESP + 0x4c]
006e2fd6 : MOV dword ptr [ESP + 0x40],EAX
006e2fda : XOR EAX,EAX
006e2fdc : MOV dword ptr [ESP + 0x58],EAX
006e2fe0 : MOV dword ptr [ESP + 0x1c],EAX
006e2fe4 : MOV dword ptr [ESP + 0x24],EBP
006e2fe8 : TEST EBP,EBP
006e2fea : JBE 0x006e3056
006e2fec : LEA ESP,[ESP]
006e2ff0 : MOVSX EDX,word ptr [ECX + ESI*0x2]
006e2ff4 : MOV EBP,dword ptr [ESP + 0x40]
006e2ff8 : LEA EAX,[EDX + EAX*0x1 + 0x8]
006e2ffc : MOVZX EDX,byte ptr [EBX]
006e2fff : SAR EAX,0x4
006e3002 : ADD EAX,dword ptr [ESP + 0x38]
006e3006 : ADD EBX,dword ptr [ESP + 0x20]
006e300a : MOVZX EAX,byte ptr [EDX + EAX*0x1]
006e300e : MOV EDX,dword ptr [ESP + 0x3c]
006e3012 : MOVZX EDX,byte ptr [EAX + EDX*0x1]
006e3016 : ADD byte ptr [EDI],DL
006e3018 : MOVZX EDX,byte ptr [EDX + EBP*0x1]
006e301c : MOV EBP,dword ptr [ESP + 0x58]
006e3020 : SUB EAX,EDX
006e3022 : MOV dword ptr [ESP + 0x44],EAX
006e3026 : LEA EDX,[EAX + EAX*0x1]
006e3029 : ADD EAX,EDX
006e302b : ADD EBP,EAX
006e302d : MOV word ptr [ECX],BP
006e3030 : MOV EBP,dword ptr [ESP + 0x1c]
006e3034 : ADD EAX,EDX
006e3036 : ADD EBP,EAX
006e3038 : MOV dword ptr [ESP + 0x58],EBP
006e303c : MOV EBP,dword ptr [ESP + 0x44]
006e3040 : ADD EAX,EDX
006e3042 : ADD EDI,ESI
006e3044 : SUB dword ptr [ESP + 0x24],0x1
006e3049 : MOV dword ptr [ESP + 0x1c],EBP
006e304d : LEA ECX,[ECX + ESI*0x2]
006e3050 : JNZ 0x006e2ff0
006e3052 : MOV EDX,dword ptr [ESP + 0x2c]
006e3056 : MOV EBP,dword ptr [ESP + 0x28]
006e305a : MOV AX,word ptr [ESP + 0x58]
006e305f : ADD dword ptr [ESP + 0x10],0x4
006e3064 : MOV EDI,dword ptr [ESP + 0x18]
006e3068 : MOV ESI,dword ptr [ESP + 0x14]
006e306c : INC EDX
006e306d : CMP EDX,EBP
006e306f : MOV word ptr [ECX],AX
006e3072 : MOV dword ptr [ESP + 0x2c],EDX
006e3076 : JL 0x006e2f80
006e307c : CMP byte ptr [ESI + 0x54],0x0
006e3080 : SETZ CL
006e3083 : ADD EDI,0x4
006e3086 : SUB dword ptr [ESP + 0x30],0x1
006e308b : MOV byte ptr [ESI + 0x54],CL
006e308e : MOV dword ptr [ESP + 0x18],EDI
006e3092 : JNZ 0x006e2f50
006e3098 : POP EDI
006e3099 : POP EBX
006e309a : POP ESI
006e309b : POP EBP
006e309c : ADD ESP,0x38
006e309f : RET

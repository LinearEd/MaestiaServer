PROGRAM  : Maestia.exe
FUNCTION : FUN_00524e70
ENTRY    : 00524e70
BODY     : [[00524e70, 00524ec9]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_00524e70(void *param_1,uint param_2)

{
  undefined4 *puVar1;
  undefined4 *_Dst;
  int in_ECX;
  
  if (param_2 < 0xc) {
    if (*(int *)(in_ECX + 0x10) == 0) {
      FUN_00524e00();
    }
    puVar1 = *(undefined4 **)(in_ECX + 0x10);
    _Dst = (undefined4 *)0x0;
    if (puVar1 != (undefined4 *)0x0) {
      *(undefined4 *)(in_ECX + 0x10) = *puVar1;
      _Dst = puVar1;
    }
  }
  else {
    _Dst = (undefined4 *)FUN_00515840(param_2 + 1,0);
  }
  if (_Dst != (undefined4 *)0x0) {
    _memcpy(_Dst,param_1,param_2);
    *(undefined1 *)((int)_Dst + param_2) = 0;
  }
  return _Dst;
}



============================================================
DISASSEMBLY
============================================================
00524e70 : PUSH EBX
00524e71 : MOV EBX,dword ptr [ESP + 0xc]
00524e75 : PUSH ESI
00524e76 : PUSH EDI
00524e77 : MOV EDI,ECX
00524e79 : CMP EBX,0xc
00524e7c : JNC 0x00524e9b
00524e7e : CMP dword ptr [EDI + 0x10],0x0
00524e82 : JNZ 0x00524e89
00524e84 : CALL 0x00524e00
00524e89 : MOV EAX,dword ptr [EDI + 0x10]
00524e8c : XOR ESI,ESI
00524e8e : TEST EAX,EAX
00524e90 : JZ 0x00524eab
00524e92 : MOV ESI,EAX
00524e94 : MOV EAX,dword ptr [EAX]
00524e96 : MOV dword ptr [EDI + 0x10],EAX
00524e99 : JMP 0x00524eab
00524e9b : MOV ECX,dword ptr [EDI + 0x4]
00524e9e : PUSH 0x0
00524ea0 : LEA EDX,[EBX + 0x1]
00524ea3 : PUSH EDX
00524ea4 : CALL 0x00515840
00524ea9 : MOV ESI,EAX
00524eab : TEST ESI,ESI
00524ead : JZ 0x00524ec2
00524eaf : MOV EAX,dword ptr [ESP + 0x10]
00524eb3 : PUSH EBX
00524eb4 : PUSH EAX
00524eb5 : PUSH ESI
00524eb6 : CALL 0x0063ae40
00524ebb : ADD ESP,0xc
00524ebe : MOV byte ptr [ESI + EBX*0x1],0x0
00524ec2 : POP EDI
00524ec3 : MOV EAX,ESI
00524ec5 : POP ESI
00524ec6 : POP EBX
00524ec7 : RET 0x8

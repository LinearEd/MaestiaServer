PROGRAM  : Maestia.exe
FUNCTION : FUN_0098fd60
ENTRY    : 0098fd60
BODY     : [[0098fd60, 0098fe15] [0098fe20, 009900ec] [009900f0, 009904b1]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */
/* WARNING: Removing unreachable block (ram,0x0098fe9a) */
/* WARNING: Removing unreachable block (ram,0x0098fffc) */
/* WARNING: Removing unreachable block (ram,0x0099015d) */
/* WARNING: Removing unreachable block (ram,0x00990474) */
/* WARNING: Removing unreachable block (ram,0x00990414) */

void FUN_0098fd60(int param_1,int param_2)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  ushort *puVar8;
  undefined4 ****ppppuVar9;
  undefined4 uVar10;
  int *piVar11;
  ushort *puVar12;
  uint uVar13;
  uint local_4074;
  int local_406c;
  int *local_4068;
  int local_4064;
  int local_4050;
  uint local_4034;
  undefined4 ***local_402c [4];
  undefined4 local_401c;
  uint local_4018;
  undefined1 local_4014 [16384];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b672b8;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_4064 = 0;
  local_406c = 0;
  local_14 = uVar4;
  do {
    iVar1 = local_406c * 0x10 + param_1;
    local_4068 = *(int **)(iVar1 + 0x44);
    if (local_4068 != *(int **)(iVar1 + 0x48)) {
      do {
        iVar7 = *(int *)(*local_4068 + 0x280);
        if (iVar7 != 0) {
          piVar11 = (int *)(iVar7 + 0x4d4);
          local_4050 = 1;
          do {
            if ((local_4064 != 0) || (*piVar11 == 0)) break;
            iVar5 = FUN_00703c00(0x700,uVar4);
            if (iVar5 != 0) {
              iVar6 = FUN_00824a20(DAT_0172491c,0);
              uVar2 = *(uint *)(iVar6 + 0x14);
              if (*(uint *)(iVar6 + 0x18) < 8) {
                puVar8 = (ushort *)(iVar6 + 4);
              }
              else {
                puVar8 = *(ushort **)(iVar6 + 4);
              }
              uVar3 = *(uint *)(param_2 + 0x14);
              uVar13 = uVar3;
              if (uVar2 <= uVar3) {
                uVar13 = uVar2;
              }
              if (*(uint *)(param_2 + 0x18) < 8) {
                puVar12 = (ushort *)(param_2 + 4);
              }
              else {
                puVar12 = *(ushort **)(param_2 + 4);
              }
              for (; uVar13 != 0; uVar13 = uVar13 - 1) {
                if (*puVar12 != *puVar8) {
                  uVar13 = (-(uint)(*puVar12 < *puVar8) & 0xfffffffe) + 1;
                  if (uVar13 != 0) goto LAB_0098fefd;
                  break;
                }
                puVar12 = puVar12 + 1;
                puVar8 = puVar8 + 1;
              }
              if (uVar3 < uVar2) {
                uVar13 = 0xffffffff;
              }
              else {
                uVar13 = (uint)(uVar3 != uVar2);
              }
LAB_0098fefd:
              local_8 = 0xffffffff;
              if (7 < local_4034) {
                    /* WARNING: Subroutine does not return */
                FUN_006f04e0();
              }
              local_4034 = 7;
              if (uVar13 == 0) {
                local_4064 = iVar5;
              }
            }
            local_4050 = local_4050 + 1;
            piVar11 = piVar11 + 1;
          } while (local_4050 < 10);
          piVar11 = (int *)(iVar7 + 0x4fc);
          local_4050 = 1;
          do {
            if (*piVar11 == 0) break;
            iVar5 = FUN_00703c00(0x700);
            if (iVar5 != 0) {
              iVar6 = FUN_00824a20(DAT_0172491c,0);
              uVar2 = *(uint *)(iVar6 + 0x14);
              if (*(uint *)(iVar6 + 0x18) < 8) {
                puVar8 = (ushort *)(iVar6 + 4);
              }
              else {
                puVar8 = *(ushort **)(iVar6 + 4);
              }
              uVar3 = *(uint *)(param_2 + 0x14);
              uVar13 = uVar3;
              if (uVar2 <= uVar3) {
                uVar13 = uVar2;
              }
              if (*(uint *)(param_2 + 0x18) < 8) {
                puVar12 = (ushort *)(param_2 + 4);
              }
              else {
                puVar12 = *(ushort **)(param_2 + 4);
              }
              for (; uVar13 != 0; uVar13 = uVar13 - 1) {
                if (*puVar12 != *puVar8) {
                  uVar13 = (-(uint)(*puVar12 < *puVar8) & 0xfffffffe) + 1;
                  if (uVar13 != 0) goto LAB_0099005d;
                  break;
                }
                puVar12 = puVar12 + 1;
                puVar8 = puVar8 + 1;
              }
              if (uVar3 < uVar2) {
                uVar13 = 0xffffffff;
              }
              else {
                uVar13 = (uint)(uVar3 != uVar2);
              }
LAB_0099005d:
              local_8 = 0xffffffff;
              if (7 < local_4018) {
                    /* WARNING: Subroutine does not return */
                FUN_006f04e0();
              }
              local_4018 = 7;
              local_401c = 0;
              local_402c[0] = (undefined4 ***)((uint)local_402c[0] & 0xffff0000);
              if (uVar13 == 0) {
                local_4064 = iVar5;
              }
            }
            local_4050 = local_4050 + 1;
            piVar11 = piVar11 + 1;
          } while (local_4050 < 10);
          piVar11 = (int *)(iVar7 + 0x524);
          local_4050 = 1;
          do {
            if (*piVar11 == 0) break;
            iVar7 = FUN_00703c00(0x700);
            if (iVar7 != 0) {
              iVar5 = FUN_00824a20(DAT_0172491c,0);
              uVar2 = *(uint *)(iVar5 + 0x14);
              if (*(uint *)(iVar5 + 0x18) < 8) {
                puVar8 = (ushort *)(iVar5 + 4);
              }
              else {
                puVar8 = *(ushort **)(iVar5 + 4);
              }
              uVar3 = *(uint *)(param_2 + 0x14);
              uVar13 = uVar3;
              if (uVar2 <= uVar3) {
                uVar13 = uVar2;
              }
              if (*(uint *)(param_2 + 0x18) < 8) {
                puVar12 = (ushort *)(param_2 + 4);
              }
              else {
                puVar12 = *(ushort **)(param_2 + 4);
              }
              for (; uVar13 != 0; uVar13 = uVar13 - 1) {
                if (*puVar12 != *puVar8) {
                  uVar13 = (-(uint)(*puVar12 < *puVar8) & 0xfffffffe) + 1;
                  if (uVar13 != 0) goto LAB_009901be;
                  break;
                }
                puVar12 = puVar12 + 1;
                puVar8 = puVar8 + 1;
              }
              if (uVar3 < uVar2) {
                uVar13 = 0xffffffff;
              }
              else {
                uVar13 = (uint)(uVar3 != uVar2);
              }
LAB_009901be:
              local_8 = 0xffffffff;
              if (7 < local_4074) {
                    /* WARNING: Subroutine does not return */
                FUN_006f04e0();
              }
              local_4074 = 7;
              if (uVar13 == 0) {
                local_4064 = iVar7;
              }
            }
            local_4050 = local_4050 + 1;
            piVar11 = piVar11 + 1;
          } while (local_4050 < 10);
        }
        local_4068 = local_4068 + 1;
      } while (local_4068 != *(int **)(iVar1 + 0x48));
    }
    local_406c = local_406c + 1;
    if (2 < local_406c) {
      if (local_4064 != 0) {
        local_8 = 3;
        local_4018 = 7;
        local_401c = 0;
        local_402c[0] = (undefined4 ***)((uint)local_402c[0] & 0xffff0000);
        FUN_00406360(&DAT_00c84ebc,0);
        local_8._0_1_ = 4;
        FUN_00406360(&DAT_00c9a8bc,0);
        FUN_008018d0(
                    L"AvaSkill::GetSkillTooltip The skill level is higher than the maximum skill level!"
                    );
        FUN_00a9db60(CONCAT22(*(undefined2 *)(local_4064 + 4),*(undefined2 *)(local_4064 + 6)));
        ppppuVar9 = (undefined4 ****)local_402c[0];
        if (local_4018 < 8) {
          ppppuVar9 = local_402c;
        }
        uVar10 = FUN_00404750(L"@A\n\n%s",ppppuVar9);
        local_8._0_1_ = 0xc;
        FUN_00405c30(uVar10,0,0xffffffff);
        iVar1 = DAT_0172489c;
        local_8._0_1_ = 4;
        if (7 < local_4074) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        *(undefined4 *)(DAT_0172489c + 0x2c) = 0xffffffff;
        *(undefined4 *)(iVar1 + 4) = 0x2000;
        *(undefined4 *)(iVar1 + 8) = 0xc;
        *(undefined4 *)(iVar1 + 0x1c) = 0xffffff;
        *(undefined4 *)(iVar1 + 0x10) = 0;
        *(undefined4 *)(iVar1 + 0x14) = 0;
        *(undefined4 *)(iVar1 + 0x18) = 300;
        *(undefined1 *)(iVar1 + 1) = 0;
        *(undefined4 *)(iVar1 + 0x20) = 0;
        *(undefined4 *)(iVar1 + 0xc) = 0;
        *(undefined1 *)(iVar1 + 2) = 0;
        *(undefined1 *)(iVar1 + 0x30) = 1;
        *(undefined4 *)(iVar1 + 0x2c) = *(undefined4 *)(param_1 + 0x2c);
        FUN_008f8f70(local_4014);
        FUN_00404750(&DAT_00c84ed0,local_4014);
        local_8._0_1_ = 0xd;
        FUN_008f7df0(1,0,0);
        local_8 = CONCAT31(local_8._1_3_,3);
        if (7 < local_4018) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_4018 = 7;
        local_401c = 0;
        local_402c[0] = (undefined4 ***)((uint)local_402c[0] & 0xffff0000);
        local_8 = 0xffffffff;
      }
      ExceptionList = local_10;
      __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
      return;
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
0098fd60 : PUSH EBP
0098fd61 : MOV EBP,ESP
0098fd63 : PUSH -0x1
0098fd65 : PUSH 0xb672b8
0098fd6a : MOV EAX,FS:[0x0]
0098fd70 : PUSH EAX
0098fd71 : MOV EAX,0x4084
0098fd76 : CALL 0x0063b780
0098fd7b : MOV EAX,[0x00d66fa0]
0098fd80 : XOR EAX,EBP
0098fd82 : MOV dword ptr [EBP + -0x10],EAX
0098fd85 : PUSH EBX
0098fd86 : PUSH ESI
0098fd87 : PUSH EDI
0098fd88 : PUSH EAX
0098fd89 : LEA EAX,[EBP + -0xc]
0098fd8c : MOV FS:[0x0],EAX
0098fd92 : MOV EAX,dword ptr [EBP + 0x8]
0098fd95 : MOV dword ptr [EBP + 0xffffbf94],EAX
0098fd9b : XOR EAX,EAX
0098fd9d : MOV dword ptr [EBP + 0xffffbfa0],EAX
0098fda3 : MOV dword ptr [EBP + 0xffffbf98],EAX
0098fda9 : LEA ESP,[ESP]
0098fdb0 : MOV ECX,dword ptr [EBP + 0xffffbf98]
0098fdb6 : MOV EDX,dword ptr [EBP + 0xffffbf94]
0098fdbc : SHL ECX,0x4
0098fdbf : LEA EAX,[ECX + EDX*0x1]
0098fdc2 : MOV ECX,dword ptr [EAX + 0x44]
0098fdc5 : MOV dword ptr [EBP + 0xffffbf74],EAX
0098fdcb : MOV dword ptr [EBP + 0xffffbf9c],ECX
0098fdd1 : CMP ECX,dword ptr [EAX + 0x48]
0098fdd4 : JZ 0x0099024e
0098fdda : LEA EBX,[EBX]
0098fde0 : MOV EAX,dword ptr [EBP + 0xffffbf9c]
0098fde6 : MOV EAX,dword ptr [EAX]
0098fde8 : MOV EAX,dword ptr [EAX + 0x280]
0098fdee : MOV dword ptr [EBP + 0xffffbfa8],EAX
0098fdf4 : TEST EAX,EAX
0098fdf6 : JZ 0x00990230
0098fdfc : MOV ECX,EAX
0098fdfe : ADD ECX,0x4d4
0098fe04 : MOV dword ptr [EBP + 0xffffbfb4],0x1
0098fe0e : MOV dword ptr [EBP + 0xffffbfb0],ECX
0098fe14 : JMP 0x0098fe20
0098fe20 : CMP dword ptr [EBP + 0xffffbfa0],0x0
0098fe27 : MOV EBX,dword ptr [EBP + 0xc]
0098fe2a : JNZ 0x0098ff6f
0098fe30 : CMP dword ptr [ECX],0x0
0098fe33 : JZ 0x0098ff6f
0098fe39 : MOV DI,word ptr [ECX + 0x2]
0098fe3d : PUSH 0x700
0098fe42 : CALL 0x00703c00
0098fe47 : ADD ESP,0x4
0098fe4a : MOV dword ptr [EBP + 0xffffbfac],EAX
0098fe50 : TEST EAX,EAX
0098fe52 : JZ 0x0098ff4a
0098fe58 : MOV ECX,dword ptr [0x0172491c]
0098fe5e : PUSH 0x0
0098fe60 : MOV EDX,EAX
0098fe62 : ADD EDX,0x18
0098fe65 : PUSH ECX
0098fe66 : LEA ESI,[EBP + 0xffffbfb8]
0098fe6c : CALL 0x00824a20
0098fe71 : MOV dword ptr [EBP + -0x4],0x0
0098fe78 : MOV EDX,dword ptr [EAX + 0x14]
0098fe7b : MOV EDI,0x8
0098fe80 : MOV dword ptr [EBP + 0xffffbfa4],EDX
0098fe86 : CMP dword ptr [EAX + 0x18],EDI
0098fe89 : JC 0x0098fe90
0098fe8b : MOV EAX,dword ptr [EAX + 0x4]
0098fe8e : JMP 0x0098fe93
0098fe90 : ADD EAX,0x4
0098fe93 : MOV ESI,dword ptr [EBX + 0x14]
0098fe96 : MOV ECX,ESI
0098fe98 : CMP ECX,ESI
0098fe9a : CMOVC ESI,ECX
0098fe9d : MOV EDX,ESI
0098fe9f : CMP ESI,dword ptr [EBP + 0xffffbfa4]
0098fea5 : JC 0x0098fead
0098fea7 : MOV EDX,dword ptr [EBP + 0xffffbfa4]
0098fead : CMP dword ptr [EBX + 0x18],EDI
0098feb0 : JC 0x0098feb7
0098feb2 : MOV ECX,dword ptr [EBX + 0x4]
0098feb5 : JMP 0x0098feba
0098feb7 : LEA ECX,[EBX + 0x4]
0098feba : TEST EDX,EDX
0098febc : JBE 0x0098fee5
0098febe : MOV EDI,EDI
0098fec0 : MOV DI,word ptr [ECX]
0098fec3 : CMP DI,word ptr [EAX]
0098fec6 : JNZ 0x0098fed5
0098fec8 : ADD ECX,0x2
0098fecb : ADD EAX,0x2
0098fece : SUB EDX,0x1
0098fed1 : JNZ 0x0098fec0
0098fed3 : JMP 0x0098fee5
0098fed5 : MOV CX,word ptr [ECX]
0098fed8 : CMP CX,word ptr [EAX]
0098fedb : SBB EAX,EAX
0098fedd : AND EAX,0xfffffffe
0098fee0 : ADD EAX,0x1
0098fee3 : JNZ 0x0098fefd
0098fee5 : MOV EAX,dword ptr [EBP + 0xffffbfa4]
0098feeb : CMP ESI,EAX
0098feed : JNC 0x0098fef4
0098feef : OR EAX,0xffffffff
0098fef2 : JMP 0x0098fefd
0098fef4 : XOR EDX,EDX
0098fef6 : CMP ESI,EAX
0098fef8 : SETNZ DL
0098fefb : MOV EAX,EDX
0098fefd : TEST EAX,EAX
0098feff : SETZ BL
0098ff02 : MOV dword ptr [EBP + -0x4],0xffffffff
0098ff09 : CMP dword ptr [EBP + 0xffffbfd0],0x8
0098ff10 : JC 0x0098ff1d
0098ff12 : MOV ECX,dword ptr [EBP + 0xffffbfbc]
0098ff18 : CALL 0x006f04e0
0098ff1d : XOR EAX,EAX
0098ff1f : MOV dword ptr [EBP + 0xffffbfd0],0x7
0098ff29 : MOV dword ptr [EBP + 0xffffbfcc],0x0
0098ff33 : MOV word ptr [EBP + 0xffffbfbc],AX
0098ff3a : TEST BL,BL
0098ff3c : JZ 0x0098ff4a
0098ff3e : MOV ECX,dword ptr [EBP + 0xffffbfac]
0098ff44 : MOV dword ptr [EBP + 0xffffbfa0],ECX
0098ff4a : MOV EAX,dword ptr [EBP + 0xffffbfb4]
0098ff50 : MOV ECX,dword ptr [EBP + 0xffffbfb0]
0098ff56 : INC EAX
0098ff57 : ADD ECX,0x4
0098ff5a : CMP EAX,0xa
0098ff5d : MOV dword ptr [EBP + 0xffffbfb4],EAX
0098ff63 : MOV dword ptr [EBP + 0xffffbfb0],ECX
0098ff69 : JL 0x0098fe20
0098ff6f : MOV EAX,dword ptr [EBP + 0xffffbfa8]
0098ff75 : ADD EAX,0x4fc
0098ff7a : MOV dword ptr [EBP + 0xffffbfb4],0x1
0098ff84 : MOV dword ptr [EBP + 0xffffbfac],EAX
0098ff8a : LEA EBX,[EBX]
0098ff90 : CMP dword ptr [EAX],0x0
0098ff93 : MOV EBX,dword ptr [EBP + 0xc]
0098ff96 : JZ 0x009900cf
0098ff9c : MOV DI,word ptr [EAX + 0x2]
0098ffa0 : PUSH 0x700
0098ffa5 : CALL 0x00703c00
0098ffaa : ADD ESP,0x4
0098ffad : MOV dword ptr [EBP + 0xffffbfb0],EAX
0098ffb3 : TEST EAX,EAX
0098ffb5 : JZ 0x009900aa
0098ffbb : MOV EDX,EAX
0098ffbd : MOV EAX,[0x0172491c]
0098ffc2 : PUSH 0x0
0098ffc4 : ADD EDX,0x18
0098ffc7 : PUSH EAX
0098ffc8 : LEA ESI,[EBP + 0xffffbfd4]
0098ffce : CALL 0x00824a20
0098ffd3 : MOV dword ptr [EBP + -0x4],0x1
0098ffda : MOV ECX,dword ptr [EAX + 0x14]
0098ffdd : MOV EDI,0x8
0098ffe2 : MOV dword ptr [EBP + 0xffffbfa4],ECX
0098ffe8 : CMP dword ptr [EAX + 0x18],EDI
0098ffeb : JC 0x0098fff2
0098ffed : MOV EAX,dword ptr [EAX + 0x4]
0098fff0 : JMP 0x0098fff5
0098fff2 : ADD EAX,0x4
0098fff5 : MOV ESI,dword ptr [EBX + 0x14]
0098fff8 : MOV ECX,ESI
0098fffa : CMP ECX,ESI
0098fffc : CMOVC ESI,ECX
0098ffff : MOV EDX,ESI
00990001 : CMP ESI,dword ptr [EBP + 0xffffbfa4]
00990007 : JC 0x0099000f
00990009 : MOV EDX,dword ptr [EBP + 0xffffbfa4]
0099000f : CMP dword ptr [EBX + 0x18],EDI
00990012 : JC 0x00990019
00990014 : MOV ECX,dword ptr [EBX + 0x4]
00990017 : JMP 0x0099001c
00990019 : LEA ECX,[EBX + 0x4]
0099001c : TEST EDX,EDX
0099001e : JBE 0x00990045
00990020 : MOV DI,word ptr [ECX]
00990023 : CMP DI,word ptr [EAX]
00990026 : JNZ 0x00990035
00990028 : ADD ECX,0x2
0099002b : ADD EAX,0x2
0099002e : SUB EDX,0x1
00990031 : JNZ 0x00990020
00990033 : JMP 0x00990045
00990035 : MOV DX,word ptr [ECX]
00990038 : CMP DX,word ptr [EAX]
0099003b : SBB EAX,EAX
0099003d : AND EAX,0xfffffffe
00990040 : ADD EAX,0x1
00990043 : JNZ 0x0099005d
00990045 : MOV EAX,dword ptr [EBP + 0xffffbfa4]
0099004b : CMP ESI,EAX
0099004d : JNC 0x00990054
0099004f : OR EAX,0xffffffff
00990052 : JMP 0x0099005d
00990054 : XOR ECX,ECX
00990056 : CMP ESI,EAX
00990058 : SETNZ CL
0099005b : MOV EAX,ECX
0099005d : TEST EAX,EAX
0099005f : SETZ BL
00990062 : MOV dword ptr [EBP + -0x4],0xffffffff
00990069 : CMP dword ptr [EBP + 0xffffbfec],0x8
00990070 : JC 0x0099007d
00990072 : MOV ECX,dword ptr [EBP + 0xffffbfd8]
00990078 : CALL 0x006f04e0
0099007d : XOR EDX,EDX
0099007f : MOV dword ptr [EBP + 0xffffbfec],0x7
00990089 : MOV dword ptr [EBP + 0xffffbfe8],0x0
00990093 : MOV word ptr [EBP + 0xffffbfd8],DX
0099009a : TEST BL,BL
0099009c : JZ 0x009900aa
0099009e : MOV EAX,dword ptr [EBP + 0xffffbfb0]
009900a4 : MOV dword ptr [EBP + 0xffffbfa0],EAX
009900aa : MOV ECX,dword ptr [EBP + 0xffffbfb4]
009900b0 : MOV EAX,dword ptr [EBP + 0xffffbfac]
009900b6 : INC ECX
009900b7 : ADD EAX,0x4
009900ba : CMP ECX,0xa
009900bd : MOV dword ptr [EBP + 0xffffbfb4],ECX
009900c3 : MOV dword ptr [EBP + 0xffffbfac],EAX
009900c9 : JL 0x0098ff90
009900cf : MOV ECX,dword ptr [EBP + 0xffffbfa8]
009900d5 : ADD ECX,0x524
009900db : MOV dword ptr [EBP + 0xffffbfb4],0x1
009900e5 : MOV dword ptr [EBP + 0xffffbfac],ECX
009900eb : JMP 0x009900f0
009900f0 : CMP dword ptr [ECX],0x0
009900f3 : MOV EBX,dword ptr [EBP + 0xc]
009900f6 : JZ 0x00990230
009900fc : MOV DI,word ptr [ECX + 0x2]
00990100 : PUSH 0x700
00990105 : CALL 0x00703c00
0099010a : ADD ESP,0x4
0099010d : MOV dword ptr [EBP + 0xffffbfb0],EAX
00990113 : TEST EAX,EAX
00990115 : JZ 0x0099020b
0099011b : MOV ECX,dword ptr [0x0172491c]
00990121 : PUSH 0x0
00990123 : MOV EDX,EAX
00990125 : ADD EDX,0x18
00990128 : PUSH ECX
00990129 : LEA ESI,[EBP + 0xffffbf78]
0099012f : CALL 0x00824a20
00990134 : MOV dword ptr [EBP + -0x4],0x2
0099013b : MOV EDX,dword ptr [EAX + 0x14]
0099013e : MOV EDI,0x8
00990143 : MOV dword ptr [EBP + 0xffffbfa8],EDX
00990149 : CMP dword ptr [EAX + 0x18],EDI
0099014c : JC 0x00990153
0099014e : MOV EAX,dword ptr [EAX + 0x4]
00990151 : JMP 0x00990156
00990153 : ADD EAX,0x4
00990156 : MOV ESI,dword ptr [EBX + 0x14]
00990159 : MOV ECX,ESI
0099015b : CMP ECX,ESI
0099015d : CMOVC ESI,ECX
00990160 : MOV EDX,ESI
00990162 : CMP ESI,dword ptr [EBP + 0xffffbfa8]
00990168 : JC 0x00990170
0099016a : MOV EDX,dword ptr [EBP + 0xffffbfa8]
00990170 : CMP dword ptr [EBX + 0x18],EDI
00990173 : JC 0x0099017a
00990175 : MOV ECX,dword ptr [EBX + 0x4]
00990178 : JMP 0x0099017d
0099017a : LEA ECX,[EBX + 0x4]
0099017d : TEST EDX,EDX
0099017f : JBE 0x009901a6
00990181 : MOV DI,word ptr [ECX]
00990184 : CMP DI,word ptr [EAX]
00990187 : JNZ 0x00990196
00990189 : ADD ECX,0x2
0099018c : ADD EAX,0x2
0099018f : SUB EDX,0x1
00990192 : JNZ 0x00990181
00990194 : JMP 0x009901a6
00990196 : MOV CX,word ptr [ECX]
00990199 : CMP CX,word ptr [EAX]
0099019c : SBB EAX,EAX
0099019e : AND EAX,0xfffffffe
009901a1 : ADD EAX,0x1
009901a4 : JNZ 0x009901be
009901a6 : MOV EAX,dword ptr [EBP + 0xffffbfa8]
009901ac : CMP ESI,EAX
009901ae : JNC 0x009901b5
009901b0 : OR EAX,0xffffffff
009901b3 : JMP 0x009901be
009901b5 : XOR EDX,EDX
009901b7 : CMP ESI,EAX
009901b9 : SETNZ DL
009901bc : MOV EAX,EDX
009901be : TEST EAX,EAX
009901c0 : SETZ BL
009901c3 : MOV dword ptr [EBP + -0x4],0xffffffff
009901ca : CMP dword ptr [EBP + 0xffffbf90],0x8
009901d1 : JC 0x009901de
009901d3 : MOV ECX,dword ptr [EBP + 0xffffbf7c]
009901d9 : CALL 0x006f04e0
009901de : XOR EAX,EAX
009901e0 : MOV dword ptr [EBP + 0xffffbf90],0x7
009901ea : MOV dword ptr [EBP + 0xffffbf8c],0x0
009901f4 : MOV word ptr [EBP + 0xffffbf7c],AX
009901fb : TEST BL,BL
009901fd : JZ 0x0099020b
009901ff : MOV ECX,dword ptr [EBP + 0xffffbfb0]
00990205 : MOV dword ptr [EBP + 0xffffbfa0],ECX
0099020b : MOV EAX,dword ptr [EBP + 0xffffbfb4]
00990211 : MOV ECX,dword ptr [EBP + 0xffffbfac]
00990217 : INC EAX
00990218 : ADD ECX,0x4
0099021b : CMP EAX,0xa
0099021e : MOV dword ptr [EBP + 0xffffbfb4],EAX
00990224 : MOV dword ptr [EBP + 0xffffbfac],ECX
0099022a : JL 0x009900f0
00990230 : MOV EAX,dword ptr [EBP + 0xffffbf9c]
00990236 : MOV EDX,dword ptr [EBP + 0xffffbf74]
0099023c : ADD EAX,0x4
0099023f : MOV dword ptr [EBP + 0xffffbf9c],EAX
00990245 : CMP EAX,dword ptr [EDX + 0x48]
00990248 : JNZ 0x0098fde0
0099024e : MOV EAX,dword ptr [EBP + 0xffffbf98]
00990254 : INC EAX
00990255 : CMP EAX,0x3
00990258 : MOV dword ptr [EBP + 0xffffbf98],EAX
0099025e : JL 0x0098fdb0
00990264 : MOV EBX,dword ptr [EBP + 0xffffbfa0]
0099026a : XOR EDI,EDI
0099026c : CMP EBX,EDI
0099026e : JZ 0x00990494
00990274 : MOV EAX,0x7
00990279 : XOR ECX,ECX
0099027b : MOV dword ptr [EBP + 0xffffbfd0],EAX
00990281 : MOV dword ptr [EBP + 0xffffbfcc],EDI
00990287 : MOV word ptr [EBP + 0xffffbfbc],CX
0099028e : MOV dword ptr [EBP + -0x4],0x3
00990295 : PUSH EDI
00990296 : XOR EDX,EDX
00990298 : PUSH 0xc84ebc
0099029d : LEA ECX,[EBP + 0xffffbfd4]
009902a3 : MOV dword ptr [EBP + 0xffffbfec],EAX
009902a9 : MOV dword ptr [EBP + 0xffffbfe8],EDI
009902af : MOV word ptr [EBP + 0xffffbfd8],DX
009902b6 : CALL 0x00406360
009902bb : MOV byte ptr [EBP + -0x4],0x4
009902bf : PUSH EDI
009902c0 : PUSH 0xc9a8bc
009902c5 : LEA ECX,[EBP + 0xffffbfb8]
009902cb : CALL 0x00406360
009902d0 : MOV ESI,dword ptr [0x00da98e8]
009902d6 : PUSH 0xc9a8c0
009902db : CALL 0x008018d0
009902e0 : MOVZX EAX,word ptr [EBX + 0x4]
009902e4 : MOVZX ECX,word ptr [EBX + 0x6]
009902e8 : SHL EAX,0x10
009902eb : OR EAX,ECX
009902ed : ADD ESP,0x4
009902f0 : PUSH EAX
009902f1 : LEA ECX,[EBP + 0xffffbfd4]
009902f7 : CALL 0x00a9db60
009902fc : MOV EAX,dword ptr [EBP + 0xffffbfd8]
00990302 : MOV EBX,0x8
00990307 : ADD ESP,0x4
0099030a : CMP dword ptr [EBP + 0xffffbfec],EBX
00990310 : JNC 0x00990318
00990312 : LEA EAX,[EBP + 0xffffbfd8]
00990318 : PUSH EAX
00990319 : PUSH 0xc84ec0
0099031e : LEA ESI,[EBP + 0xffffbf78]
00990324 : CALL 0x00404750
00990329 : ADD ESP,0x8
0099032c : MOV byte ptr [EBP + -0x4],0xc
00990330 : PUSH -0x1
00990332 : PUSH EDI
00990333 : PUSH EAX
00990334 : LEA ECX,[EBP + 0xffffbfb8]
0099033a : CALL 0x00405c30
0099033f : MOV byte ptr [EBP + -0x4],0x4
00990343 : CMP dword ptr [EBP + 0xffffbf90],EBX
00990349 : JC 0x00990356
0099034b : MOV ECX,dword ptr [EBP + 0xffffbf7c]
00990351 : CALL 0x006f04e0
00990356 : MOV ECX,dword ptr [0x0172489c]
0099035c : MOV EAX,dword ptr [EBP + 0xffffbf94]
00990362 : MOV dword ptr [EBP + 0xffffbf90],0x7
0099036c : MOV dword ptr [EBP + 0xffffbf8c],EDI
00990372 : XOR EDX,EDX
00990374 : MOV word ptr [EBP + 0xffffbf7c],DX
0099037b : MOV dword ptr [ECX + 0x2c],0xffffffff
00990382 : MOV dword ptr [ECX + 0x4],0x2000
00990389 : MOV dword ptr [ECX + 0x8],0xc
00990390 : MOV dword ptr [ECX + 0x1c],0xffffff
00990397 : MOV dword ptr [ECX + 0x10],EDI
0099039a : MOV dword ptr [ECX + 0x14],EDI
0099039d : MOV dword ptr [ECX + 0x18],0x12c
009903a4 : MOV byte ptr [ECX + 0x1],DL
009903a7 : MOV dword ptr [ECX + 0x20],EDI
009903aa : MOV dword ptr [ECX + 0xc],EDI
009903ad : MOV byte ptr [ECX + 0x2],DL
009903b0 : MOV byte ptr [ECX + 0x30],0x1
009903b4 : MOV EDX,dword ptr [EAX + 0x2c]
009903b7 : MOV dword ptr [ECX + 0x2c],EDX
009903ba : MOV EDX,dword ptr [EBP + 0xffffbfbc]
009903c0 : CMP dword ptr [EBP + 0xffffbfd0],EBX
009903c6 : JNC 0x009903ce
009903c8 : LEA EDX,[EBP + 0xffffbfbc]
009903ce : LEA EAX,[EBP + 0xffffbff0]
009903d4 : PUSH EAX
009903d5 : CALL 0x008f8f70
009903da : LEA ECX,[EBP + 0xffffbff0]
009903e0 : PUSH ECX
009903e1 : PUSH 0xc84ed0
009903e6 : LEA ESI,[EBP + 0xffffbf78]
009903ec : CALL 0x00404750
009903f1 : ADD ESP,0x8
009903f4 : MOV byte ptr [EBP + -0x4],0xd
009903f8 : PUSH EDI
009903f9 : PUSH EDI
009903fa : MOV EDX,EAX
009903fc : MOV EAX,[0x0172489c]
00990401 : PUSH 0x1
00990403 : CALL 0x008f7df0
00990408 : MOV byte ptr [EBP + -0x4],0x4
0099040c : CMP dword ptr [EBP + 0xffffbf90],EBX
00990412 : JC 0x0099041f
00990414 : MOV ECX,dword ptr [EBP + 0xffffbf7c]
0099041a : CALL 0x006f04e0
0099041f : MOV ESI,0x7
00990424 : XOR EDX,EDX
00990426 : MOV dword ptr [EBP + 0xffffbf90],ESI
0099042c : MOV dword ptr [EBP + 0xffffbf8c],EDI
00990432 : MOV word ptr [EBP + 0xffffbf7c],DX
00990439 : MOV byte ptr [EBP + -0x4],0x3
0099043d : CMP dword ptr [EBP + 0xffffbfec],EBX
00990443 : JC 0x00990450
00990445 : MOV ECX,dword ptr [EBP + 0xffffbfd8]
0099044b : CALL 0x006f04e0
00990450 : XOR EAX,EAX
00990452 : MOV dword ptr [EBP + 0xffffbfec],ESI
00990458 : MOV dword ptr [EBP + 0xffffbfe8],EDI
0099045e : MOV word ptr [EBP + 0xffffbfd8],AX
00990465 : MOV dword ptr [EBP + -0x4],0xffffffff
0099046c : CMP dword ptr [EBP + 0xffffbfd0],EBX
00990472 : JC 0x0099047f
00990474 : MOV ECX,dword ptr [EBP + 0xffffbfbc]
0099047a : CALL 0x006f04e0
0099047f : XOR ECX,ECX
00990481 : MOV dword ptr [EBP + 0xffffbfd0],ESI
00990487 : MOV dword ptr [EBP + 0xffffbfcc],EDI
0099048d : MOV word ptr [EBP + 0xffffbfbc],CX
00990494 : MOV ECX,dword ptr [EBP + -0xc]
00990497 : MOV dword ptr FS:[0x0],ECX
0099049e : POP ECX
0099049f : POP EDI
009904a0 : POP ESI
009904a1 : POP EBX
009904a2 : MOV ECX,dword ptr [EBP + -0x10]
009904a5 : XOR ECX,EBP
009904a7 : CALL 0x00633e6b
009904ac : MOV ESP,EBP
009904ae : POP EBP
009904af : RET 0x8

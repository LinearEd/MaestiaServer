PROGRAM  : Maestia.exe
FUNCTION : FUN_0051b760
ENTRY    : 0051b760
BODY     : [[0051b760, 0051b7d1]]

============================================================
DECOMPILED C CODE
============================================================

uint * FUN_0051b760(undefined4 param_1,uint param_2,uint param_3,void *param_4,size_t param_5,
                   void *param_6,size_t param_7)

{
  uint *puVar1;
  
  if (param_2 == 0) {
    InterlockedExchangeAdd((LONG *)&DAT_00d65134,1);
    puVar1 = (uint *)&DAT_00d65130;
  }
  else {
    puVar1 = (uint *)FUN_00515840(param_2 + 0xc,0);
    *(undefined1 *)((int)puVar1 + param_2 + 8) = 0;
    puVar1[1] = 1;
    *puVar1 = param_2 | param_3;
  }
  _memcpy(puVar1 + 2,param_4,param_5);
  _memcpy((undefined *)((int)puVar1 + param_5 + 8),param_6,param_7);
  return puVar1;
}



============================================================
DISASSEMBLY
============================================================
0051b760 : PUSH ESI
0051b761 : MOV ESI,dword ptr [ESP + 0xc]
0051b765 : PUSH EDI
0051b766 : TEST ESI,ESI
0051b768 : JNZ 0x0051b77e
0051b76a : PUSH 0x1
0051b76c : PUSH 0xd65134
0051b771 : CALL dword ptr [0x00b851cc]
0051b777 : MOV ESI,0xd65130
0051b77c : JMP 0x0051b7a1
0051b77e : MOV ECX,dword ptr [ESP + 0xc]
0051b782 : PUSH 0x0
0051b784 : LEA EAX,[ESI + 0xc]
0051b787 : PUSH EAX
0051b788 : CALL 0x00515840
0051b78d : MOV byte ptr [EAX + ESI*0x1 + 0x8],0x0
0051b792 : OR ESI,dword ptr [ESP + 0x14]
0051b796 : MOV dword ptr [EAX + 0x4],0x1
0051b79d : MOV dword ptr [EAX],ESI
0051b79f : MOV ESI,EAX
0051b7a1 : MOV EDI,dword ptr [ESP + 0x1c]
0051b7a5 : MOV ECX,dword ptr [ESP + 0x18]
0051b7a9 : PUSH EDI
0051b7aa : PUSH ECX
0051b7ab : LEA EDX,[ESI + 0x8]
0051b7ae : PUSH EDX
0051b7af : CALL 0x0063ae40
0051b7b4 : MOV EAX,dword ptr [ESP + 0x30]
0051b7b8 : MOV ECX,dword ptr [ESP + 0x2c]
0051b7bc : PUSH EAX
0051b7bd : PUSH ECX
0051b7be : LEA EDX,[ESI + EDI*0x1 + 0x8]
0051b7c2 : PUSH EDX
0051b7c3 : CALL 0x0063ae40
0051b7c8 : ADD ESP,0x18
0051b7cb : POP EDI
0051b7cc : MOV EAX,ESI
0051b7ce : POP ESI
0051b7cf : RET 0x1c

PROGRAM  : Maestia.exe
FUNCTION : __vsnprintf_helper
ENTRY    : 006352fd
BODY     : [[006352fd, 006353c8]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    __vsnprintf_helper
   
   Library: Visual Studio 2008 Release */

int __vsnprintf_helper(code *param_1,char *param_2,uint param_3,int param_4,undefined4 param_5,
                      undefined4 param_6)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  FILE local_24;
  
  if (param_4 == 0) {
    piVar1 = __errno();
    *piVar1 = 0x16;
    __invalid_parameter(0,0,0,0,0);
    iVar2 = -1;
  }
  else if ((param_3 == 0) || (param_2 != (char *)0x0)) {
    local_24._cnt = 0x7fffffff;
    if (param_3 < 0x80000000) {
      local_24._cnt = param_3;
    }
    local_24._flag = 0x42;
    local_24._base = param_2;
    local_24._ptr = param_2;
    iVar2 = (*param_1)(&local_24,param_4,param_5,param_6);
    if (param_2 != (char *)0x0) {
      if (-1 < iVar2) {
        local_24._cnt = local_24._cnt - 1;
        if (-1 < local_24._cnt) {
          *local_24._ptr = '\0';
          return iVar2;
        }
        iVar3 = __flsbuf(0,&local_24);
        if (iVar3 != -1) {
          return iVar2;
        }
      }
      param_2[param_3 - 1] = '\0';
      iVar2 = (-1 < local_24._cnt) - 2;
    }
  }
  else {
    piVar1 = __errno();
    *piVar1 = 0x16;
    __invalid_parameter(0,0,0,0,0);
    iVar2 = -1;
  }
  return iVar2;
}



============================================================
DISASSEMBLY
============================================================
006352fd : MOV EDI,EDI
006352ff : PUSH EBP
00635300 : MOV EBP,ESP
00635302 : SUB ESP,0x20
00635305 : PUSH EBX
00635306 : XOR EBX,EBX
00635308 : CMP dword ptr [EBP + 0x14],EBX
0063530b : JNZ 0x0063532d
0063530d : CALL 0x0063ab82
00635312 : PUSH EBX
00635313 : PUSH EBX
00635314 : PUSH EBX
00635315 : PUSH EBX
00635316 : PUSH EBX
00635317 : MOV dword ptr [EAX],0x16
0063531d : CALL 0x006372b8
00635322 : ADD ESP,0x14
00635325 : OR EAX,0xffffffff
00635328 : JMP 0x006353c6
0063532d : PUSH ESI
0063532e : MOV ESI,dword ptr [EBP + 0xc]
00635331 : PUSH EDI
00635332 : MOV EDI,dword ptr [EBP + 0x10]
00635335 : CMP EDI,EBX
00635337 : JZ 0x0063535a
00635339 : CMP ESI,EBX
0063533b : JNZ 0x0063535a
0063533d : CALL 0x0063ab82
00635342 : PUSH EBX
00635343 : PUSH EBX
00635344 : PUSH EBX
00635345 : PUSH EBX
00635346 : PUSH EBX
00635347 : MOV dword ptr [EAX],0x16
0063534d : CALL 0x006372b8
00635352 : ADD ESP,0x14
00635355 : OR EAX,0xffffffff
00635358 : JMP 0x006353c4
0063535a : MOV EAX,0x7fffffff
0063535f : MOV dword ptr [EBP + -0x1c],EAX
00635362 : CMP EDI,EAX
00635364 : JA 0x00635369
00635366 : MOV dword ptr [EBP + -0x1c],EDI
00635369 : PUSH dword ptr [EBP + 0x1c]
0063536c : LEA EAX,[EBP + -0x20]
0063536f : PUSH dword ptr [EBP + 0x18]
00635372 : MOV dword ptr [EBP + -0x14],0x42
00635379 : PUSH dword ptr [EBP + 0x14]
0063537c : MOV dword ptr [EBP + -0x18],ESI
0063537f : PUSH EAX
00635380 : MOV dword ptr [EBP + -0x20],ESI
00635383 : CALL dword ptr [EBP + 0x8]
00635386 : ADD ESP,0x10
00635389 : MOV dword ptr [EBP + 0x14],EAX
0063538c : CMP ESI,EBX
0063538e : JZ 0x006353c4
00635390 : CMP EAX,EBX
00635392 : JL 0x006353b6
00635394 : DEC dword ptr [EBP + -0x1c]
00635397 : JS 0x006353a0
00635399 : MOV EAX,dword ptr [EBP + -0x20]
0063539c : MOV byte ptr [EAX],BL
0063539e : JMP 0x006353b1
006353a0 : LEA EAX,[EBP + -0x20]
006353a3 : PUSH EAX
006353a4 : PUSH EBX
006353a5 : CALL 0x00645eff
006353aa : POP ECX
006353ab : POP ECX
006353ac : CMP EAX,-0x1
006353af : JZ 0x006353b6
006353b1 : MOV EAX,dword ptr [EBP + 0x14]
006353b4 : JMP 0x006353c4
006353b6 : XOR EAX,EAX
006353b8 : CMP dword ptr [EBP + -0x1c],EBX
006353bb : MOV byte ptr [ESI + EDI*0x1 + -0x1],BL
006353bf : SETGE AL
006353c2 : DEC EAX
006353c3 : DEC EAX
006353c4 : POP EDI
006353c5 : POP ESI
006353c6 : POP EBX
006353c7 : LEAVE
006353c8 : RET

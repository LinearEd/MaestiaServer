PROGRAM  : Maestia.exe
FUNCTION : FUN_008b6af0
ENTRY    : 008b6af0
BODY     : [[008b6af0, 008b6b5c] [008b6b60, 008b6c31]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x008b6b3e) */

undefined4 FUN_008b6af0(int param_1,int param_2)

{
  uint uVar1;
  uint uVar2;
  ushort *puVar3;
  ushort *puVar4;
  uint uVar5;
  int iVar6;
  int local_c;
  
  iVar6 = *(int *)(param_1 + 0xb8);
  local_c = 0;
  if (iVar6 != *(int *)(param_1 + 0xbc)) {
    uVar1 = *(uint *)(param_2 + 0x14);
    do {
      if (*(uint *)(param_2 + 0x18) < 8) {
        puVar3 = (ushort *)(param_2 + 4);
      }
      else {
        puVar3 = *(ushort **)(param_2 + 4);
      }
      uVar2 = *(uint *)(iVar6 + 0x14);
      uVar5 = uVar2;
      if (uVar1 <= uVar2) {
        uVar5 = uVar1;
      }
      if (*(uint *)(iVar6 + 0x18) < 8) {
        puVar4 = (ushort *)(iVar6 + 4);
      }
      else {
        puVar4 = *(ushort **)(iVar6 + 4);
      }
      for (; uVar5 != 0; uVar5 = uVar5 - 1) {
        if (*puVar4 != *puVar3) {
          uVar5 = (-(uint)(*puVar4 < *puVar3) & 0xfffffffe) + 1;
          if (uVar5 != 0) goto LAB_008b6b85;
          break;
        }
        puVar4 = puVar4 + 1;
        puVar3 = puVar3 + 1;
      }
      if (uVar1 <= uVar2) {
        uVar5 = (uint)(uVar2 != uVar1);
LAB_008b6b85:
        if (uVar5 == 0) {
          *(int *)(param_1 + 200) = local_c;
          return 0;
        }
      }
      local_c = local_c + 1;
      iVar6 = iVar6 + 0x1c;
    } while (iVar6 != *(int *)(param_1 + 0xbc));
  }
  if (9 < (uint)((*(int *)(param_1 + 0xbc) - *(int *)(param_1 + 0xb8)) / 0x1c)) {
    return 0;
  }
  *(int *)(param_1 + 200) = (*(int *)(param_1 + 0xbc) - *(int *)(param_1 + 0xb8)) / 0x1c;
  FUN_00405ae0(param_2);
  return 1;
}



============================================================
DISASSEMBLY
============================================================
008b6af0 : PUSH EBP
008b6af1 : MOV EBP,ESP
008b6af3 : SUB ESP,0xc
008b6af6 : PUSH EBX
008b6af7 : PUSH ESI
008b6af8 : PUSH EDI
008b6af9 : MOV EDI,dword ptr [EBP + 0x8]
008b6afc : MOV ESI,dword ptr [EDI + 0xb8]
008b6b02 : MOV dword ptr [EBP + -0x8],0x0
008b6b09 : CMP ESI,dword ptr [EDI + 0xbc]
008b6b0f : JZ 0x008b6ba0
008b6b15 : MOV EAX,dword ptr [EBP + 0xc]
008b6b18 : MOV EBX,dword ptr [EAX + 0x14]
008b6b1b : MOV ECX,dword ptr [EAX + 0x18]
008b6b1e : MOV dword ptr [EBP + -0x4],EBX
008b6b21 : MOV dword ptr [EBP + -0xc],ECX
008b6b24 : JMP 0x008b6b29
008b6b26 : MOV EAX,dword ptr [EBP + 0xc]
008b6b29 : CMP dword ptr [EBP + -0xc],0x8
008b6b2d : JC 0x008b6b34
008b6b2f : MOV EAX,dword ptr [EAX + 0x4]
008b6b32 : JMP 0x008b6b37
008b6b34 : ADD EAX,0x4
008b6b37 : MOV EDI,dword ptr [ESI + 0x14]
008b6b3a : MOV ECX,EDI
008b6b3c : CMP ECX,EDI
008b6b3e : CMOVC EDI,ECX
008b6b41 : MOV EDX,EDI
008b6b43 : CMP EDI,EBX
008b6b45 : JC 0x008b6b49
008b6b47 : MOV EDX,EBX
008b6b49 : CMP dword ptr [ESI + 0x18],0x8
008b6b4d : JC 0x008b6b54
008b6b4f : MOV ECX,dword ptr [ESI + 0x4]
008b6b52 : JMP 0x008b6b57
008b6b54 : LEA ECX,[ESI + 0x4]
008b6b57 : TEST EDX,EDX
008b6b59 : JBE 0x008b6b7a
008b6b5b : JMP 0x008b6b60
008b6b60 : MOV BX,word ptr [ECX]
008b6b63 : CMP BX,word ptr [EAX]
008b6b66 : JNZ 0x008b6bff
008b6b6c : ADD ECX,0x2
008b6b6f : ADD EAX,0x2
008b6b72 : SUB EDX,0x1
008b6b75 : JNZ 0x008b6b60
008b6b77 : MOV EBX,dword ptr [EBP + -0x4]
008b6b7a : CMP EDI,EBX
008b6b7c : JC 0x008b6b8d
008b6b7e : XOR EAX,EAX
008b6b80 : CMP EDI,EBX
008b6b82 : SETNZ AL
008b6b85 : TEST EAX,EAX
008b6b87 : JZ 0x008b6c1b
008b6b8d : MOV EAX,dword ptr [EBP + 0x8]
008b6b90 : INC dword ptr [EBP + -0x8]
008b6b93 : ADD ESI,0x1c
008b6b96 : CMP ESI,dword ptr [EAX + 0xbc]
008b6b9c : JNZ 0x008b6b26
008b6b9e : MOV EDI,EAX
008b6ba0 : MOV ESI,dword ptr [EDI + 0xbc]
008b6ba6 : SUB ESI,dword ptr [EDI + 0xb8]
008b6bac : LEA ECX,[EDI + 0xb4]
008b6bb2 : MOV EAX,0x92492493
008b6bb7 : IMUL ESI
008b6bb9 : ADD EDX,ESI
008b6bbb : SAR EDX,0x4
008b6bbe : MOV EAX,EDX
008b6bc0 : SHR EAX,0x1f
008b6bc3 : ADD EAX,EDX
008b6bc5 : CMP EAX,0xa
008b6bc8 : JNC 0x008b6c27
008b6bca : MOV ESI,dword ptr [ECX + 0x8]
008b6bcd : SUB ESI,dword ptr [ECX + 0x4]
008b6bd0 : MOV EAX,0x92492493
008b6bd5 : IMUL ESI
008b6bd7 : ADD EDX,ESI
008b6bd9 : SAR EDX,0x4
008b6bdc : MOV EAX,EDX
008b6bde : SHR EAX,0x1f
008b6be1 : ADD EAX,EDX
008b6be3 : MOV EDX,dword ptr [EBP + 0xc]
008b6be6 : MOV dword ptr [EDI + 0xc8],EAX
008b6bec : PUSH EDX
008b6bed : MOV EAX,ECX
008b6bef : CALL 0x00405ae0
008b6bf4 : MOV AL,0x1
008b6bf6 : POP EDI
008b6bf7 : POP ESI
008b6bf8 : POP EBX
008b6bf9 : MOV ESP,EBP
008b6bfb : POP EBP
008b6bfc : RET 0x8
008b6bff : MOV DX,BX
008b6c02 : CMP DX,word ptr [EAX]
008b6c05 : SBB EAX,EAX
008b6c07 : AND EAX,0xfffffffe
008b6c0a : ADD EAX,0x1
008b6c0d : JZ 0x008b6b77
008b6c13 : MOV EBX,dword ptr [EBP + -0x4]
008b6c16 : JMP 0x008b6b85
008b6c1b : MOV ECX,dword ptr [EBP + -0x8]
008b6c1e : MOV EDX,dword ptr [EBP + 0x8]
008b6c21 : MOV dword ptr [EDX + 0xc8],ECX
008b6c27 : POP EDI
008b6c28 : POP ESI
008b6c29 : XOR AL,AL
008b6c2b : POP EBX
008b6c2c : MOV ESP,EBP
008b6c2e : POP EBP
008b6c2f : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_00470520
ENTRY    : 00470520
BODY     : [[00470520, 00470708] [00470710, 00470857]]

============================================================
DECOMPILED C CODE
============================================================

byte FUN_00470520(int param_1)

{
  undefined1 uVar1;
  char cVar2;
  byte bVar3;
  uint uVar4;
  int *piVar5;
  undefined2 *puVar6;
  int in_ECX;
  int extraout_ECX;
  int iVar7;
  undefined4 extraout_EDX;
  int iVar8;
  int iVar9;
  int *piVar10;
  undefined1 local_a8 [4];
  int local_a4;
  undefined4 local_8c;
  undefined4 local_88;
  undefined2 local_84;
  undefined4 local_80;
  undefined4 local_7c;
  undefined2 local_78;
  undefined4 local_74;
  undefined4 local_70;
  undefined2 local_6c;
  undefined4 local_68;
  undefined4 local_64;
  undefined2 local_60;
  undefined4 local_5c;
  undefined4 local_58;
  undefined2 local_54;
  undefined4 local_50;
  undefined4 local_4c;
  undefined2 local_48;
  undefined4 local_44;
  undefined4 local_40;
  undefined2 local_3c;
  int local_30;
  int local_2c;
  int local_28;
  int local_24;
  undefined4 local_20;
  int local_1c;
  int local_18;
  byte local_11;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b82bfd;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_1c = *(int *)(in_ECX + 0x10);
  local_24 = *(int *)(in_ECX + 0x14);
  iVar8 = param_1 + 0xf40;
  bVar3 = 1;
  local_11 = 1;
  if ((0 < local_1c) && (local_24 != 0)) {
    local_88 = 10;
    local_84 = 3;
    local_7c = 10;
    local_70 = 10;
    local_68 = 10;
    local_40 = 10;
    local_8c = 0;
    local_80 = 8;
    local_78 = 4;
    local_74 = 9;
    local_6c = 4;
    local_64 = 0;
    local_60 = 4;
    local_5c = 0xb;
    local_58 = 0;
    local_54 = 4;
    local_50 = 0xc;
    local_4c = 0;
    local_48 = 4;
    local_44 = 0x11;
    local_3c = 0;
    local_2c = iVar8;
    uVar1 = FUN_004714e0(DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
    local_20 = CONCAT31(local_20._1_3_,uVar1);
    cVar2 = FUN_00471510();
    if (cVar2 != '\0') {
      uVar4 = (uint)((char)local_20 == '\0');
      *(uint *)(param_1 + 0xf98) = (uint)(uVar4 != 0) * 2 + 2;
      *(uint *)(param_1 + 0xf54) = uVar4;
      if ((uVar4 == 0) || (uVar4 == 1)) {
        piVar10 = *(int **)(in_ECX + 0x14);
        iVar7 = 0;
        iVar9 = *(int *)(in_ECX + 0x10);
        if (0 < *(int *)(in_ECX + 0x10)) {
          do {
            local_18 = iVar9;
            iVar9 = *piVar10;
            if (0 < iVar9) {
              piVar5 = (int *)(piVar10[1] + 8);
              do {
                iVar7 = iVar7 + *piVar5;
                piVar5 = piVar5 + 5;
                iVar9 = iVar9 + -1;
              } while (iVar9 != 0);
            }
            piVar10 = piVar10 + 0x10;
            local_18 = local_18 + -1;
            iVar9 = local_18;
          } while (local_18 != 0);
        }
        cVar2 = FUN_00471570(iVar7);
        if (cVar2 != '\0') {
          param_1 = param_1 + 0xe00;
          local_30 = param_1;
          FUN_00471ba0(local_1c);
          local_28 = 0;
          if (0 < local_1c) {
            piVar10 = (int *)(local_24 + 0x14);
            do {
              cVar2 = FUN_00806e10();
              iVar9 = extraout_ECX;
              if (cVar2 != '\0') {
                bVar3 = FUN_00472020(extraout_ECX,extraout_EDX,iVar8,param_1,local_20);
                local_11 = local_11 & bVar3;
                FUN_00470330(local_a8,piVar10[-1]);
                iVar9 = 0;
                local_8 = 0;
                if (0 < piVar10[-1]) {
                  iVar7 = 0;
                  puVar6 = (undefined2 *)(local_a4 + 0x2c);
                  local_18 = 0;
                  param_1 = 0;
                  do {
                    iVar8 = *piVar10;
                    *(undefined8 *)(puVar6 + -0x16) = *(undefined8 *)(iVar8 + param_1);
                    *(undefined4 *)(puVar6 + -0x12) = *(undefined4 *)(iVar8 + param_1 + 8);
                    iVar8 = piVar10[1];
                    if (iVar8 == 0) {
                      iVar8 = *piVar10;
                    }
                    *(undefined8 *)(puVar6 + -0x10) = *(undefined8 *)(iVar8 + param_1);
                    *(undefined4 *)(puVar6 + -0xc) = *(undefined4 *)(iVar8 + param_1 + 8);
                    iVar8 = piVar10[2];
                    *puVar6 = *(undefined2 *)(iVar8 + iVar7);
                    *(undefined1 *)(puVar6 + 1) = *(undefined1 *)(iVar8 + iVar7 + 2);
                    if (piVar10[7] == 0) {
                      uVar1 = 0xff;
                    }
                    else {
                      uVar1 = *(undefined1 *)(piVar10[7] + iVar9);
                    }
                    *(undefined1 *)((int)puVar6 + 3) = uVar1;
                    *(undefined4 *)(puVar6 + -8) = *(undefined4 *)(piVar10[5] + iVar9 * 8);
                    *(undefined4 *)(puVar6 + -6) = *(undefined4 *)(piVar10[5] + 4 + iVar9 * 8);
                    *(undefined4 *)(puVar6 + -4) = *(undefined4 *)(piVar10[10] + iVar9 * 8);
                    *(undefined4 *)(puVar6 + -2) = *(undefined4 *)(piVar10[10] + 4 + iVar9 * 8);
                    iVar8 = piVar10[4];
                    puVar6[2] = *(undefined2 *)(iVar8 + iVar7);
                    *(undefined1 *)(puVar6 + 3) = *(undefined1 *)(iVar8 + iVar7 + 2);
                    *(undefined1 *)((int)puVar6 + 7) = 0;
                    if (piVar10[9] == 0) {
                      *(undefined4 *)(puVar6 + -10) = 0;
                      *(undefined1 *)((int)puVar6 + 0xb) = 0;
                      *(undefined1 *)(puVar6 + 5) = 0;
                      *(undefined1 *)((int)puVar6 + 9) = 0;
                      *(undefined1 *)(puVar6 + 4) = 0;
                    }
                    else {
                      *(int *)(puVar6 + -10) = piVar10[8];
                      *(undefined4 *)(puVar6 + 4) = *(undefined4 *)(local_18 + piVar10[9]);
                    }
                    param_1 = param_1 + 0xc;
                    local_18 = local_18 + 6;
                    iVar9 = iVar9 + 1;
                    puVar6 = puVar6 + 0x1c;
                    iVar7 = iVar7 + 3;
                    iVar8 = local_2c;
                  } while (iVar9 < piVar10[-1]);
                }
                bVar3 = FUN_00472820(local_a4,piVar10[-1]);
                local_11 = local_11 & bVar3;
                local_8 = 0xffffffff;
                FUN_0046fe80(local_a8);
                iVar9 = local_28;
                param_1 = local_30;
              }
              local_28 = iVar9 + 1;
              piVar10 = piVar10 + 0x10;
            } while (local_28 < local_1c);
          }
        }
      }
    }
    bVar3 = FUN_004728f0();
    local_11 = local_11 & bVar3;
    bVar3 = FUN_004744b0();
    bVar3 = local_11 & bVar3;
  }
  ExceptionList = local_10;
  return bVar3;
}



============================================================
DISASSEMBLY
============================================================
00470520 : PUSH EBP
00470521 : MOV EBP,ESP
00470523 : PUSH -0x1
00470525 : PUSH 0xb82bfd
0047052a : MOV EAX,FS:[0x0]
00470530 : PUSH EAX
00470531 : SUB ESP,0x98
00470537 : PUSH EBX
00470538 : PUSH ESI
00470539 : PUSH EDI
0047053a : MOV EAX,[0x00d66fa0]
0047053f : XOR EAX,EBP
00470541 : PUSH EAX
00470542 : LEA EAX,[EBP + -0xc]
00470545 : MOV FS:[0x0],EAX
0047054b : MOV ESI,ECX
0047054d : MOV EDI,dword ptr [ESI + 0x10]
00470550 : MOV EBX,dword ptr [EBP + 0x8]
00470553 : MOV ECX,dword ptr [ESI + 0x14]
00470556 : ADD EBX,0xf40
0047055c : MOV AL,0x1
0047055e : MOV byte ptr [EBP + -0xd],AL
00470561 : MOV dword ptr [EBP + -0x18],EDI
00470564 : MOV dword ptr [EBP + -0x20],ECX
00470567 : MOV dword ptr [EBP + -0x28],EBX
0047056a : TEST EDI,EDI
0047056c : JLE 0x00470844
00470572 : TEST ECX,ECX
00470574 : JZ 0x00470844
0047057a : MOV EAX,0xa
0047057f : MOV EDX,0x3
00470584 : MOV dword ptr [EBP + 0xffffff7c],EAX
0047058a : MOV word ptr [EBP + -0x80],DX
0047058e : MOV EDX,0x4
00470593 : MOV dword ptr [EBP + -0x78],EAX
00470596 : MOV dword ptr [EBP + -0x6c],EAX
00470599 : MOV dword ptr [EBP + -0x64],EAX
0047059c : MOV dword ptr [EBP + -0x3c],EAX
0047059f : XOR EAX,EAX
004705a1 : MOV dword ptr [EBP + 0xffffff78],0x0
004705ab : MOV dword ptr [EBP + -0x7c],0x8
004705b2 : MOV word ptr [EBP + -0x74],DX
004705b6 : MOV dword ptr [EBP + -0x70],0x9
004705bd : MOV word ptr [EBP + -0x68],DX
004705c1 : MOV dword ptr [EBP + -0x60],0x0
004705c8 : MOV word ptr [EBP + -0x5c],DX
004705cc : MOV dword ptr [EBP + -0x58],0xb
004705d3 : MOV dword ptr [EBP + -0x54],0x0
004705da : MOV word ptr [EBP + -0x50],DX
004705de : MOV dword ptr [EBP + -0x4c],0xc
004705e5 : MOV dword ptr [EBP + -0x48],0x0
004705ec : MOV word ptr [EBP + -0x44],DX
004705f0 : MOV dword ptr [EBP + -0x40],0x11
004705f7 : MOV word ptr [EBP + -0x38],AX
004705fb : CALL 0x004714e0
00470600 : MOV byte ptr [EBP + -0x1c],AL
00470603 : LEA ECX,[EBP + 0xffffff78]
00470609 : MOV EAX,EBX
0047060b : CALL 0x00471510
00470610 : TEST AL,AL
00470612 : JZ 0x0047082e
00470618 : XOR EAX,EAX
0047061a : CMP byte ptr [EBP + -0x1c],AL
0047061d : SETZ AL
00470620 : XOR ECX,ECX
00470622 : TEST EAX,EAX
00470624 : SETNZ CL
00470627 : LEA ECX,[ECX + ECX*0x1 + 0x2]
0047062b : MOV dword ptr [EBX + 0x58],ECX
0047062e : MOV dword ptr [EBX + 0x14],EAX
00470631 : TEST EAX,EAX
00470633 : JZ 0x0047063e
00470635 : CMP EAX,0x1
00470638 : JNZ 0x0047082e
0047063e : MOV EAX,dword ptr [ESI + 0x10]
00470641 : MOV ESI,dword ptr [ESI + 0x14]
00470644 : XOR ECX,ECX
00470646 : XOR EDX,EDX
00470648 : TEST EAX,EAX
0047064a : JLE 0x00470673
0047064c : MOV EDI,ESI
0047064e : MOV dword ptr [EBP + -0x14],EAX
00470651 : MOV ESI,dword ptr [EDI]
00470653 : ADD ECX,dword ptr [EDI + 0x10]
00470656 : TEST ESI,ESI
00470658 : JLE 0x0047066a
0047065a : MOV EAX,dword ptr [EDI + 0x4]
0047065d : ADD EAX,0x8
00470660 : ADD EDX,dword ptr [EAX]
00470662 : ADD EAX,0x14
00470665 : SUB ESI,0x1
00470668 : JNZ 0x00470660
0047066a : ADD EDI,0x40
0047066d : SUB dword ptr [EBP + -0x14],0x1
00470671 : JNZ 0x00470651
00470673 : PUSH EDX
00470674 : MOV ESI,EBX
00470676 : CALL 0x00471570
0047067b : TEST AL,AL
0047067d : JZ 0x0047082e
00470683 : MOV EDI,dword ptr [EBP + 0x8]
00470686 : MOV EDX,dword ptr [EBP + -0x18]
00470689 : MOV ECX,dword ptr [EBP + -0x20]
0047068c : ADD EDI,0xe00
00470692 : PUSH EDX
00470693 : MOV ESI,EDI
00470695 : MOV dword ptr [EBP + -0x2c],EDI
00470698 : CALL 0x00471ba0
0047069d : XOR ECX,ECX
0047069f : CMP dword ptr [EBP + -0x18],ECX
004706a2 : MOV dword ptr [EBP + -0x24],ECX
004706a5 : JLE 0x0047082e
004706ab : MOV ESI,dword ptr [EBP + -0x20]
004706ae : ADD ESI,0x14
004706b1 : LEA EDX,[ESI + -0x14]
004706b4 : MOV EAX,EDX
004706b6 : CALL 0x00806e10
004706bb : TEST AL,AL
004706bd : JZ 0x0047081e
004706c3 : MOV EAX,dword ptr [EBP + -0x1c]
004706c6 : PUSH EAX
004706c7 : PUSH EDI
004706c8 : PUSH EBX
004706c9 : PUSH EDX
004706ca : PUSH ECX
004706cb : CALL 0x00472020
004706d0 : MOV ECX,dword ptr [ESI + -0x4]
004706d3 : AND byte ptr [EBP + -0xd],AL
004706d6 : PUSH ECX
004706d7 : LEA EDX,[EBP + 0xffffff5c]
004706dd : PUSH EDX
004706de : CALL 0x00470330
004706e3 : XOR ECX,ECX
004706e5 : MOV dword ptr [EBP + -0x4],ECX
004706e8 : CMP dword ptr [ESI + -0x4],ECX
004706eb : JLE 0x004707f0
004706f1 : MOV EAX,dword ptr [EBP + 0xffffff60]
004706f7 : XORPS XMM0,XMM0
004706fa : XOR EBX,EBX
004706fc : ADD EAX,0x2c
004706ff : XOR EDI,EDI
00470701 : MOV dword ptr [EBP + -0x14],ECX
00470704 : MOV dword ptr [EBP + 0x8],EDI
00470707 : JMP 0x00470713
00470710 : MOV EDI,dword ptr [EBP + 0x8]
00470713 : MOV EDX,dword ptr [ESI]
00470715 : MOVQ XMM1,qword ptr [EDX + EDI*0x1]
0047071a : ADD EDX,EDI
0047071c : MOVQ qword ptr [EAX + -0x2c],XMM1
00470721 : MOV EDX,dword ptr [EDX + 0x8]
00470724 : MOV dword ptr [EAX + -0x24],EDX
00470727 : MOV EDX,dword ptr [ESI + 0x4]
0047072a : TEST EDX,EDX
0047072c : JNZ 0x00470730
0047072e : MOV EDX,dword ptr [ESI]
00470730 : MOVQ XMM1,qword ptr [EDX + EDI*0x1]
00470735 : ADD EDX,EDI
00470737 : MOVQ qword ptr [EAX + -0x20],XMM1
0047073c : MOV EDX,dword ptr [EDX + 0x8]
0047073f : MOV dword ptr [EAX + -0x18],EDX
00470742 : MOV EDI,dword ptr [ESI + 0x8]
00470745 : MOV DX,word ptr [EDI + EBX*0x1]
00470749 : ADD EDI,EBX
0047074b : MOV word ptr [EAX],DX
0047074e : MOV DL,byte ptr [EDI + 0x2]
00470751 : MOV byte ptr [EAX + 0x2],DL
00470754 : MOV EDI,dword ptr [ESI + 0x1c]
00470757 : TEST EDI,EDI
00470759 : JZ 0x00470761
0047075b : MOVZX EDX,byte ptr [EDI + ECX*0x1]
0047075f : JMP 0x00470766
00470761 : MOV EDX,0xff
00470766 : MOV byte ptr [EAX + 0x3],DL
00470769 : MOV EDX,dword ptr [ESI + 0x14]
0047076c : FLD float ptr [EDX + ECX*0x8]
0047076f : FSTP float ptr [EAX + -0x10]
00470772 : MOV EDX,dword ptr [ESI + 0x14]
00470775 : FLD float ptr [EDX + ECX*0x8 + 0x4]
00470779 : FSTP float ptr [EAX + -0xc]
0047077c : MOV EDX,dword ptr [ESI + 0x28]
0047077f : FLD float ptr [EDX + ECX*0x8]
00470782 : FSTP float ptr [EAX + -0x8]
00470785 : MOV EDX,dword ptr [ESI + 0x28]
00470788 : FLD float ptr [EDX + ECX*0x8 + 0x4]
0047078c : FSTP float ptr [EAX + -0x4]
0047078f : MOV EDI,dword ptr [ESI + 0x10]
00470792 : MOV DX,word ptr [EDI + EBX*0x1]
00470796 : ADD EDI,EBX
00470798 : MOV word ptr [EAX + 0x4],DX
0047079c : MOV DL,byte ptr [EDI + 0x2]
0047079f : MOV byte ptr [EAX + 0x6],DL
004707a2 : MOV byte ptr [EAX + 0x7],0x0
004707a6 : CMP dword ptr [ESI + 0x24],0x0
004707aa : JZ 0x004707c0
004707ac : FLD float ptr [ESI + 0x20]
004707af : MOV EDI,dword ptr [EBP + -0x14]
004707b2 : FSTP float ptr [EAX + -0x14]
004707b5 : MOV EDX,dword ptr [ESI + 0x24]
004707b8 : MOV EDX,dword ptr [EDI + EDX*0x1]
004707bb : MOV dword ptr [EAX + 0x8],EDX
004707be : JMP 0x004707d5
004707c0 : MOVSS dword ptr [EAX + -0x14],XMM0
004707c5 : MOV byte ptr [EAX + 0xb],0x0
004707c9 : MOV byte ptr [EAX + 0xa],0x0
004707cd : MOV byte ptr [EAX + 0x9],0x0
004707d1 : MOV byte ptr [EAX + 0x8],0x0
004707d5 : ADD dword ptr [EBP + 0x8],0xc
004707d9 : ADD dword ptr [EBP + -0x14],0x6
004707dd : INC ECX
004707de : ADD EAX,0x38
004707e1 : ADD EBX,0x3
004707e4 : CMP ECX,dword ptr [ESI + -0x4]
004707e7 : JL 0x00470710
004707ed : MOV EBX,dword ptr [EBP + -0x28]
004707f0 : MOV EAX,dword ptr [ESI + -0x4]
004707f3 : MOV ECX,dword ptr [EBP + 0xffffff60]
004707f9 : PUSH EAX
004707fa : PUSH ECX
004707fb : MOV EDI,EBX
004707fd : CALL 0x00472820
00470802 : AND byte ptr [EBP + -0xd],AL
00470805 : MOV dword ptr [EBP + -0x4],0xffffffff
0047080c : LEA EDX,[EBP + 0xffffff5c]
00470812 : PUSH EDX
00470813 : CALL 0x0046fe80
00470818 : MOV EDI,dword ptr [EBP + -0x2c]
0047081b : MOV ECX,dword ptr [EBP + -0x24]
0047081e : INC ECX
0047081f : ADD ESI,0x40
00470822 : CMP ECX,dword ptr [EBP + -0x18]
00470825 : MOV dword ptr [EBP + -0x24],ECX
00470828 : JL 0x004706b1
0047082e : MOV EDI,EBX
00470830 : CALL 0x004728f0
00470835 : AND byte ptr [EBP + -0xd],AL
00470838 : CALL 0x004744b0
0047083d : MOV CL,byte ptr [EBP + -0xd]
00470840 : AND CL,AL
00470842 : MOV AL,CL
00470844 : MOV ECX,dword ptr [EBP + -0xc]
00470847 : MOV dword ptr FS:[0x0],ECX
0047084e : POP ECX
0047084f : POP EDI
00470850 : POP ESI
00470851 : POP EBX
00470852 : MOV ESP,EBP
00470854 : POP EBP
00470855 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_004d14a0
ENTRY    : 004d14a0
BODY     : [[004d14a0, 004d15cc] [004d15de, 004d16b2]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_004d14a0(int param_1,undefined1 *param_2,uint param_3,undefined1 *param_4)

{
  undefined1 uVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  undefined1 *puVar5;
  undefined4 uVar6;
  rsize_t _DstSize;
  uint uVar7;
  uint extraout_ECX;
  uint uVar8;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  uVar3 = param_3;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b79ef0;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  iVar4 = *(int *)(param_1 + 4);
  if (iVar4 == 0) {
    uVar7 = 0;
  }
  else {
    uVar7 = *(int *)(param_1 + 0xc) - iVar4;
  }
  if (param_3 != 0) {
    iVar2 = *(int *)(param_1 + 8);
    if ((iVar4 - iVar2) - 1U < param_3) {
      iVar4 = FUN_00429be0();
      uVar7 = extraout_ECX;
    }
    uVar8 = (iVar2 - iVar4) + param_3;
    if (uVar7 < uVar8) {
      if (-(uVar7 >> 1) - 1 < uVar7) {
        param_3 = 0;
      }
      else {
        param_3 = uVar7 + (uVar7 >> 1);
      }
      if (param_3 < uVar8) {
        param_3 = uVar8;
      }
      iVar4 = FUN_00404e70(param_3,0);
      local_8 = 0;
      FUN_004d24f0();
      FUN_004d3f20(*(undefined4 *)(param_1 + 4));
      FUN_004d3f20(param_2);
      local_8 = 0xffffffff;
      if (*(int *)(param_1 + 4) == 0) {
        *(uint *)(param_1 + 0xc) = iVar4 + param_3;
        *(uint *)(param_1 + 8) = iVar4 + uVar3 + (*(int *)(param_1 + 8) - *(int *)(param_1 + 4));
        *(int *)(param_1 + 4) = iVar4;
        ExceptionList = local_10;
        return;
      }
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    if ((uint)(iVar2 - (int)param_2) < param_3) {
      uVar1 = *param_4;
      FUN_004d3f20(param_2);
      local_8 = 2;
      FUN_004d24f0();
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + param_3;
      puVar5 = (undefined1 *)(*(int *)(param_1 + 8) - param_3);
      if (param_2 != puVar5) {
        do {
          *param_2 = uVar1;
          param_2 = param_2 + 1;
        } while (param_2 != puVar5);
        ExceptionList = local_10;
        return;
      }
    }
    else {
      uVar1 = *param_4;
      uVar6 = FUN_004d3f20(iVar2 - param_3);
      *(undefined4 *)(param_1 + 8) = uVar6;
      _DstSize = (iVar2 - (int)param_2) - param_3;
      if (0 < (int)_DstSize) {
        _memmove_s((void *)(iVar2 - _DstSize),_DstSize,param_2,_DstSize);
      }
      puVar5 = param_2;
      if (param_2 != param_2 + param_3) {
        do {
          *puVar5 = uVar1;
          puVar5 = puVar5 + 1;
        } while (puVar5 != param_2 + param_3);
      }
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
004d14a0 : PUSH EBP
004d14a1 : MOV EBP,ESP
004d14a3 : PUSH -0x1
004d14a5 : PUSH 0xb79ef0
004d14aa : MOV EAX,FS:[0x0]
004d14b0 : PUSH EAX
004d14b1 : SUB ESP,0x10
004d14b4 : PUSH EBX
004d14b5 : PUSH ESI
004d14b6 : PUSH EDI
004d14b7 : MOV EAX,[0x00d66fa0]
004d14bc : XOR EAX,EBP
004d14be : PUSH EAX
004d14bf : LEA EAX,[EBP + -0xc]
004d14c2 : MOV FS:[0x0],EAX
004d14c8 : MOV dword ptr [EBP + -0x10],ESP
004d14cb : MOV EBX,dword ptr [EBP + 0x10]
004d14ce : MOV EDI,dword ptr [EBP + 0x8]
004d14d1 : MOV EAX,dword ptr [EDI + 0x4]
004d14d4 : TEST EAX,EAX
004d14d6 : JNZ 0x004d14dc
004d14d8 : XOR ECX,ECX
004d14da : JMP 0x004d14e1
004d14dc : MOV ECX,dword ptr [EDI + 0xc]
004d14df : SUB ECX,EAX
004d14e1 : TEST EBX,EBX
004d14e3 : JZ 0x004d169f
004d14e9 : MOV ESI,dword ptr [EDI + 0x8]
004d14ec : MOV EDX,EAX
004d14ee : SUB EDX,ESI
004d14f0 : DEC EDX
004d14f1 : CMP EDX,EBX
004d14f3 : JNC 0x004d14fa
004d14f5 : CALL 0x00429be0
004d14fa : MOV EDX,ESI
004d14fc : SUB EDX,EAX
004d14fe : ADD EDX,EBX
004d1500 : CMP ECX,EDX
004d1502 : JNC 0x004d15de
004d1508 : MOV EAX,ECX
004d150a : SHR EAX,0x1
004d150c : OR ESI,0xffffffff
004d150f : SUB ESI,EAX
004d1511 : CMP ESI,ECX
004d1513 : JNC 0x004d1521
004d1515 : MOV dword ptr [EBP + 0x10],0x0
004d151c : MOV ECX,dword ptr [EBP + 0x10]
004d151f : JMP 0x004d1526
004d1521 : ADD ECX,EAX
004d1523 : MOV dword ptr [EBP + 0x10],ECX
004d1526 : CMP ECX,EDX
004d1528 : JNC 0x004d152f
004d152a : MOV dword ptr [EBP + 0x10],EDX
004d152d : MOV ECX,EDX
004d152f : PUSH 0x0
004d1531 : PUSH ECX
004d1532 : CALL 0x00404e70
004d1537 : ADD ESP,0x8
004d153a : MOV dword ptr [EBP + -0x14],EAX
004d153d : MOV ECX,dword ptr [EBP + 0xc]
004d1540 : SUB ECX,dword ptr [EDI + 0x4]
004d1543 : MOV dword ptr [EBP + -0x4],0x0
004d154a : LEA EDX,[ECX + EAX*0x1]
004d154d : MOV dword ptr [EBP + -0x1c],EDX
004d1550 : MOV EDI,dword ptr [EBP + 0x14]
004d1553 : MOV ESI,EBX
004d1555 : CALL 0x004d24f0
004d155a : MOV dword ptr [EBP + -0x18],0x1
004d1561 : MOV ESI,dword ptr [EBP + 0x8]
004d1564 : MOV EAX,dword ptr [ESI + 0x4]
004d1567 : PUSH EAX
004d1568 : MOV EDI,dword ptr [EBP + -0x14]
004d156b : MOV ECX,EDI
004d156d : MOV EAX,dword ptr [EBP + 0xc]
004d1570 : CALL 0x004d3f20
004d1575 : MOV dword ptr [EBP + -0x18],0x2
004d157c : MOV ECX,dword ptr [EBP + -0x1c]
004d157f : ADD ECX,EBX
004d1581 : MOV EDX,dword ptr [EBP + 0xc]
004d1584 : PUSH EDX
004d1585 : MOV EAX,dword ptr [ESI + 0x8]
004d1588 : CALL 0x004d3f20
004d158d : MOV dword ptr [EBP + -0x4],0xffffffff
004d1594 : MOV ECX,dword ptr [ESI + 0x4]
004d1597 : MOV EAX,dword ptr [ESI + 0x8]
004d159a : SUB EAX,ECX
004d159c : ADD EBX,EAX
004d159e : TEST ECX,ECX
004d15a0 : JZ 0x004d15a7
004d15a2 : CALL 0x006f04e0
004d15a7 : MOV ECX,dword ptr [EBP + 0x10]
004d15aa : LEA EDX,[EDI + ECX*0x1]
004d15ad : MOV dword ptr [ESI + 0xc],EDX
004d15b0 : LEA EAX,[EDI + EBX*0x1]
004d15b3 : MOV dword ptr [ESI + 0x8],EAX
004d15b6 : MOV dword ptr [ESI + 0x4],EDI
004d15b9 : MOV ECX,dword ptr [EBP + -0xc]
004d15bc : MOV dword ptr FS:[0x0],ECX
004d15c3 : POP ECX
004d15c4 : POP EDI
004d15c5 : POP ESI
004d15c6 : POP EBX
004d15c7 : MOV ESP,EBP
004d15c9 : POP EBP
004d15ca : RET 0x10
004d15de : MOV ECX,ESI
004d15e0 : MOV EAX,dword ptr [EBP + 0xc]
004d15e3 : SUB ECX,EAX
004d15e5 : CMP ECX,EBX
004d15e7 : JNC 0x004d164e
004d15e9 : MOV EDX,dword ptr [EBP + 0x14]
004d15ec : MOV CL,byte ptr [EDX]
004d15ee : MOV byte ptr [EBP + 0x17],CL
004d15f1 : LEA ECX,[EAX + EBX*0x1]
004d15f4 : PUSH EAX
004d15f5 : MOV EAX,ESI
004d15f7 : CALL 0x004d3f20
004d15fc : MOV dword ptr [EBP + -0x4],0x2
004d1603 : MOV EDX,dword ptr [EDI + 0x8]
004d1606 : MOV ESI,dword ptr [EBP + 0xc]
004d1609 : SUB ESI,EDX
004d160b : ADD ESI,EBX
004d160d : LEA EDI,[EBP + 0x17]
004d1610 : CALL 0x004d24f0
004d1615 : MOV dword ptr [EBP + -0x4],0xffffffff
004d161c : MOV EAX,dword ptr [EBP + 0x8]
004d161f : ADD dword ptr [EAX + 0x8],EBX
004d1622 : MOV EAX,dword ptr [EAX + 0x8]
004d1625 : SUB EAX,EBX
004d1627 : MOV ECX,EAX
004d1629 : MOV EAX,dword ptr [EBP + 0xc]
004d162c : CMP EAX,ECX
004d162e : JZ 0x004d169f
004d1630 : MOV DL,byte ptr [EBP + 0x17]
004d1633 : MOV byte ptr [EAX],DL
004d1635 : INC EAX
004d1636 : CMP EAX,ECX
004d1638 : JNZ 0x004d1630
004d163a : MOV ECX,dword ptr [EBP + -0xc]
004d163d : MOV dword ptr FS:[0x0],ECX
004d1644 : POP ECX
004d1645 : POP EDI
004d1646 : POP ESI
004d1647 : POP EBX
004d1648 : MOV ESP,EBP
004d164a : POP EBP
004d164b : RET 0x10
004d164e : MOV EAX,dword ptr [EBP + 0x14]
004d1651 : MOV CL,byte ptr [EAX]
004d1653 : MOV byte ptr [EBP + 0xb],CL
004d1656 : MOV EDX,ESI
004d1658 : SUB EDX,EBX
004d165a : PUSH EDX
004d165b : MOV ECX,ESI
004d165d : MOV EAX,ESI
004d165f : CALL 0x004d3f20
004d1664 : MOV dword ptr [EDI + 0x8],EAX
004d1667 : MOV EAX,ESI
004d1669 : MOV ECX,dword ptr [EBP + 0xc]
004d166c : SUB EAX,ECX
004d166e : SUB EAX,EBX
004d1670 : TEST EAX,EAX
004d1672 : JLE 0x004d1685
004d1674 : PUSH EAX
004d1675 : PUSH ECX
004d1676 : PUSH EAX
004d1677 : SUB ESI,EAX
004d1679 : PUSH ESI
004d167a : CALL 0x00634101
004d167f : ADD ESP,0x10
004d1682 : MOV ECX,dword ptr [EBP + 0xc]
004d1685 : MOV EAX,ECX
004d1687 : LEA EDX,[ECX + EBX*0x1]
004d168a : CMP ECX,EDX
004d168c : JZ 0x004d169f
004d168e : MOV EDI,EDI
004d1690 : MOV CL,byte ptr [EBP + 0xb]
004d1693 : MOV byte ptr [EAX],CL
004d1695 : INC EAX
004d1696 : MOV EDX,dword ptr [EBP + 0xc]
004d1699 : ADD EDX,EBX
004d169b : CMP EAX,EDX
004d169d : JNZ 0x004d1690
004d169f : MOV ECX,dword ptr [EBP + -0xc]
004d16a2 : MOV dword ptr FS:[0x0],ECX
004d16a9 : POP ECX
004d16aa : POP EDI
004d16ab : POP ESI
004d16ac : POP EBX
004d16ad : MOV ESP,EBP
004d16af : POP EBP
004d16b0 : RET 0x10

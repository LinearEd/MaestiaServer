PROGRAM  : Maestia.exe
FUNCTION : FUN_00877850
ENTRY    : 00877850
BODY     : [[00877850, 00877c56]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00877850(void)

{
  undefined4 uVar1;
  float fVar2;
  int iVar3;
  int iVar4;
  DWORD DVar5;
  undefined4 *in_ECX;
  int iVar6;
  float fVar7;
  float fVar8;
  float fStack_34;
  float fStack_24;
  float local_1c;
  float local_18;
  float local_14;
  float local_10;
  float local_c;
  
  if (*(char *)((int)in_ECX + 0x8d) != '\0') {
    uVar1 = in_ECX[0x1e];
    iVar3 = FUN_00a1a840(uVar1);
    if (iVar3 == 0) {
      iVar3 = FUN_00a1a6d0(uVar1);
      if (iVar3 == 0) {
        iVar3 = FUN_00a1a780(uVar1);
      }
    }
    uVar1 = in_ECX[0x1d];
    iVar4 = FUN_00a1a840(uVar1);
    if (iVar4 == 0) {
      iVar4 = FUN_00a1a6d0(uVar1);
      if (iVar4 == 0) {
        iVar4 = FUN_00a1a780(uVar1);
      }
    }
    if ((*(char *)((int)in_ECX + 0x32) != '\0') && (iVar4 != 0)) {
      local_18 = *(float *)(*(int *)(iVar4 + 1000) + 0x70);
      local_1c = *(float *)(iVar4 + 0x418) * DAT_00d72c24 +
                 *(float *)(*(int *)(iVar4 + 1000) + 0x6c);
      FUN_00404130();
      *(undefined1 *)((int)in_ECX + 0x32) = 0;
    }
    if (iVar3 != 0) {
      iVar4 = *(int *)(iVar3 + 1000);
      in_ECX[0x1f] = *(undefined4 *)(iVar4 + 0x68);
      in_ECX[0x20] = *(undefined4 *)(iVar4 + 0x6c);
      in_ECX[0x21] = *(undefined4 *)(iVar4 + 0x70);
      in_ECX[0x20] = (float)in_ECX[0x20] + 10.0;
    }
    iVar4 = in_ECX[0x12];
    local_c = (float)in_ECX[0x21] - *(float *)(iVar4 + 0x70);
    local_14 = (float)in_ECX[0x1f] - *(float *)(iVar4 + 0x68);
    local_10 = (float)in_ECX[0x20] - *(float *)(iVar4 + 0x6c);
    FUN_0040f460(local_c * local_c + local_10 * local_10 + local_14 * local_14);
    D3DXVec3Normalize(&local_14,&local_14);
    iVar4 = in_ECX[0x22];
    DVar5 = timeGetTime();
    iVar6 = DAT_017251cc;
    in_ECX[0x22] = DVar5;
    fVar7 = (float)in_ECX[in_ECX[0xb] + 1];
    if (0.0 < *(float *)(iVar6 + 0x34)) {
      fVar7 = *(float *)(iVar6 + 0x34);
    }
    if (0.0 < (float)in_ECX[0x33]) {
      iVar6 = DVar5 - iVar4;
      fVar2 = (float)iVar6;
      if (iVar6 < 0) {
        fVar2 = fVar2 + 4.2949673e+09;
      }
      in_ECX[0x34] = fVar2 * (float)in_ECX[0x33] * 0.001 + (float)in_ECX[0x34];
    }
    iVar4 = DVar5 - iVar4;
    fVar2 = (float)iVar4;
    if (iVar4 < 0) {
      fVar2 = fVar2 + 4.2949673e+09;
    }
    fVar7 = (float)in_ECX[0x34] * fVar2 * ((float)in_ECX[0x11] * fVar7 + fVar7);
    if ((fStack_34 <= fVar7) || (fStack_34 <= 1.0)) {
      if (iVar3 != 0) {
        (**(code **)*in_ECX)(iVar3);
      }
      if (*(char *)((int)in_ECX + 0x31) == '\0') {
        if ((int *)in_ECX[0x14] != (int *)0x0) {
          (**(code **)(*(int *)in_ECX[0x14] + 0x24))();
        }
        if ((int *)in_ECX[0x15] != (int *)0x0) {
          (**(code **)(*(int *)in_ECX[0x15] + 0xd4))();
        }
        if (in_ECX[0x31] != 0) {
          FUN_007dd4b0();
          in_ECX[0x31] = 0;
        }
        *(undefined1 *)(in_ECX + 0x23) = 1;
        *(undefined1 *)((int)in_ECX + 0x8d) = 0;
        FUN_00406360(&DAT_00c435f8,0);
      }
      else {
        *(undefined1 *)((int)in_ECX + 0x32) = 1;
      }
    }
    else {
      fStack_24 = local_18 * fVar7;
      fVar8 = local_14 * fVar7;
      if (*(char *)(in_ECX + 0xc) != '\0') {
        in_ECX[0xf] = (float)in_ECX[0xf] - fVar2 * 0.001;
        fStack_24 = (float)in_ECX[0xe] * fVar2 * 0.001 + fStack_24;
      }
      FUN_007cc680();
      FUN_007cd000(local_1c * fVar7,fStack_24,fVar8);
      if (in_ECX[0x31] != 0) {
        if (*(char *)((int)in_ECX[0x12] + 0x5d) != '\0') {
          (**(code **)(*(int *)in_ECX[0x12] + 0x14))();
        }
        FUN_004419e0();
        *(undefined1 *)(DAT_017251c4 + 0x15d) = 1;
      }
      in_ECX[0x26] = local_1c * fVar7;
      in_ECX[0x27] = fStack_24;
      in_ECX[0x28] = fVar8;
    }
    if (*(char *)(in_ECX + 0x35) != '\0') {
      FUN_008771a0();
    }
    if (0.0 <= (float)in_ECX[0x38]) {
      FUN_008773f0();
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00877850 : PUSH EBP
00877851 : MOV EBP,ESP
00877853 : AND ESP,0xfffffff8
00877856 : SUB ESP,0x2c
00877859 : PUSH EBX
0087785a : MOV EBX,ECX
0087785c : CMP byte ptr [EBX + 0x8d],0x0
00877863 : PUSH ESI
00877864 : PUSH EDI
00877865 : JZ 0x00877c50
0087786b : MOV ESI,dword ptr [EBX + 0x78]
0087786e : MOV ECX,dword ptr [0x00da93ec]
00877874 : PUSH ESI
00877875 : MOV dword ptr [ESP + 0x14],ECX
00877879 : CALL 0x00a1a840
0087787e : MOV EDI,EAX
00877880 : TEST EDI,EDI
00877882 : JNZ 0x008778a0
00877884 : MOV ECX,dword ptr [ESP + 0x10]
00877888 : PUSH ESI
00877889 : CALL 0x00a1a6d0
0087788e : MOV EDI,EAX
00877890 : TEST EDI,EDI
00877892 : JNZ 0x008778a0
00877894 : MOV ECX,dword ptr [ESP + 0x10]
00877898 : PUSH ESI
00877899 : CALL 0x00a1a780
0087789e : MOV EDI,EAX
008778a0 : MOV ESI,dword ptr [EBX + 0x74]
008778a3 : MOV ECX,dword ptr [0x00da93ec]
008778a9 : PUSH ESI
008778aa : MOV dword ptr [ESP + 0x14],ECX
008778ae : CALL 0x00a1a840
008778b3 : TEST EAX,EAX
008778b5 : JNZ 0x008778cf
008778b7 : MOV ECX,dword ptr [ESP + 0x10]
008778bb : PUSH ESI
008778bc : CALL 0x00a1a6d0
008778c1 : TEST EAX,EAX
008778c3 : JNZ 0x008778cf
008778c5 : MOV ECX,dword ptr [ESP + 0x10]
008778c9 : PUSH ESI
008778ca : CALL 0x00a1a780
008778cf : CMP byte ptr [EBX + 0x32],0x0
008778d3 : JZ 0x00877927
008778d5 : TEST EAX,EAX
008778d7 : JZ 0x00877927
008778d9 : MOV ECX,dword ptr [EAX + 0x3e8]
008778df : MOVSS XMM1,dword ptr [ECX + 0x70]
008778e4 : MOVSS XMM0,dword ptr [ECX + 0x68]
008778e9 : ADD ECX,0x68
008778ec : MOVSS dword ptr [ESP + 0x28],XMM1
008778f2 : MOVSS XMM1,dword ptr [EAX + 0x418]
008778fa : MULSS XMM1,dword ptr [0x00d72c24]
00877902 : MOV EAX,dword ptr [EBX + 0x48]
00877905 : MOVSS dword ptr [ESP + 0x20],XMM0
0087790b : MOVSS XMM0,dword ptr [ECX + 0x4]
00877910 : ADDSS XMM1,XMM0
00877914 : LEA ECX,[ESP + 0x20]
00877918 : MOVSS dword ptr [ESP + 0x24],XMM1
0087791e : CALL 0x00404130
00877923 : MOV byte ptr [EBX + 0x32],0x0
00877927 : TEST EDI,EDI
00877929 : JZ 0x00877964
0087792b : MOV EAX,dword ptr [EDI + 0x3e8]
00877931 : FLD float ptr [EAX + 0x68]
00877934 : ADD EAX,0x68
00877937 : FSTP float ptr [EBX + 0x7c]
0087793a : FLD float ptr [EAX + 0x4]
0087793d : FSTP float ptr [EBX + 0x80]
00877943 : FLD float ptr [EAX + 0x8]
00877946 : FSTP float ptr [EBX + 0x84]
0087794c : MOVSS XMM0,dword ptr [EBX + 0x80]
00877954 : ADDSS XMM0,dword ptr [0x00c18874]
0087795c : MOVSS dword ptr [EBX + 0x80],XMM0
00877964 : MOV EAX,dword ptr [EBX + 0x48]
00877967 : MOVSS XMM2,dword ptr [EBX + 0x84]
0087796f : SUBSS XMM2,dword ptr [EAX + 0x70]
00877974 : MOVSS XMM0,dword ptr [EBX + 0x7c]
00877979 : SUBSS XMM0,dword ptr [EAX + 0x68]
0087797e : MOVSS XMM1,dword ptr [EBX + 0x80]
00877986 : SUBSS XMM1,dword ptr [EAX + 0x6c]
0087798b : ADD EAX,0x68
0087798e : MOVAPS XMM3,XMM2
00877991 : MULSS XMM3,XMM2
00877995 : MOVSS dword ptr [ESP + 0x34],XMM2
0087799b : MOVAPS XMM2,XMM1
0087799e : MULSS XMM2,XMM1
008779a2 : MOVSS dword ptr [ESP + 0x30],XMM1
008779a8 : MOVAPS XMM1,XMM0
008779ab : ADDSS XMM3,XMM2
008779af : MULSS XMM1,XMM0
008779b3 : PUSH ECX
008779b4 : ADDSS XMM3,XMM1
008779b8 : MOVSS dword ptr [ESP + 0x30],XMM0
008779be : MOVSS dword ptr [ESP],XMM3
008779c3 : CALL 0x0040f460
008779c8 : FSTP float ptr [ESP + 0x18]
008779cc : ADD ESP,0x4
008779cf : LEA EAX,[ESP + 0x2c]
008779d3 : PUSH EAX
008779d4 : MOV ECX,EAX
008779d6 : PUSH ECX
008779d7 : CALL 0x004ff722
008779dc : MOV ESI,dword ptr [EBX + 0x88]
008779e2 : CALL dword ptr [0x00b85598]
008779e8 : MOV ECX,dword ptr [0x017251cc]
008779ee : MOV EDX,dword ptr [EBX + 0x2c]
008779f1 : XORPS XMM2,XMM2
008779f4 : MOV dword ptr [EBX + 0x88],EAX
008779fa : MOVSS XMM1,dword ptr [ECX + 0x34]
008779ff : COMISS XMM1,XMM2
00877a02 : MOVSS XMM0,dword ptr [EBX + EDX*0x4 + 0x4]
00877a08 : JBE 0x00877a0d
00877a0a : MOVAPS XMM0,XMM1
00877a0d : MOVSS XMM1,dword ptr [EBX + 0x44]
00877a12 : MULSS XMM1,XMM0
00877a16 : ADDSS XMM1,XMM0
00877a1a : MOVSS XMM0,dword ptr [EBX + 0xcc]
00877a22 : COMISS XMM0,XMM2
00877a25 : MOVSS dword ptr [ESP + 0x10],XMM0
00877a2b : JBE 0x00877a59
00877a2d : MOV EDX,EAX
00877a2f : SUB EDX,ESI
00877a31 : MOV dword ptr [ESP + 0x18],EDX
00877a35 : FILD dword ptr [ESP + 0x18]
00877a39 : TEST EDX,EDX
00877a3b : JGE 0x00877a43
00877a3d : FADD float ptr [0x00cdf0e0]
00877a43 : FMUL float ptr [ESP + 0x10]
00877a47 : FMUL float ptr [0x00cdf128]
00877a4d : FADD float ptr [EBX + 0xd0]
00877a53 : FSTP float ptr [EBX + 0xd0]
00877a59 : SUB EAX,ESI
00877a5b : MOV dword ptr [ESP + 0x18],EAX
00877a5f : FILD dword ptr [ESP + 0x18]
00877a63 : TEST EAX,EAX
00877a65 : JGE 0x00877a6d
00877a67 : FADD float ptr [0x00cdf0e0]
00877a6d : MOVSS XMM0,dword ptr [EBX + 0xd0]
00877a75 : FSTP float ptr [ESP + 0x10]
00877a79 : MOVSS XMM5,dword ptr [ESP + 0x10]
00877a7f : MULSS XMM0,XMM5
00877a83 : MULSS XMM0,XMM1
00877a87 : MOVSS XMM1,dword ptr [ESP + 0x14]
00877a8d : COMISS XMM1,XMM0
00877a90 : JBE 0x00877bb1
00877a96 : COMISS XMM1,dword ptr [0x00c10fc4]
00877a9d : JBE 0x00877bb1
00877aa3 : CMP byte ptr [EBX + 0x30],0x0
00877aa7 : MOVSS XMM3,dword ptr [ESP + 0x2c]
00877aad : MOVSS XMM4,dword ptr [ESP + 0x34]
00877ab3 : MOVAPS XMM1,XMM3
00877ab6 : MULSS XMM1,XMM0
00877aba : MOVSS dword ptr [ESP + 0x20],XMM1
00877ac0 : MOVSS XMM1,dword ptr [ESP + 0x30]
00877ac6 : MOVAPS XMM2,XMM4
00877ac9 : MULSS XMM1,XMM0
00877acd : MULSS XMM2,XMM0
00877ad1 : MOVSS dword ptr [ESP + 0x24],XMM1
00877ad7 : MOVSS dword ptr [ESP + 0x28],XMM2
00877add : JZ 0x00877b08
00877adf : MULSS XMM5,dword ptr [0x00cdf128]
00877ae7 : MOVSS XMM0,dword ptr [EBX + 0x3c]
00877aec : SUBSS XMM0,XMM5
00877af0 : MOVSS dword ptr [EBX + 0x3c],XMM0
00877af5 : MOVSS XMM0,dword ptr [EBX + 0x38]
00877afa : MULSS XMM0,XMM5
00877afe : ADDSS XMM0,XMM1
00877b02 : MOVSS dword ptr [ESP + 0x24],XMM0
00877b08 : MOV ESI,dword ptr [EBX + 0x48]
00877b0b : LEA EAX,[ESP + 0x18]
00877b0f : MOVSS dword ptr [ESP + 0x18],XMM3
00877b15 : MOVSS dword ptr [ESP + 0x1c],XMM4
00877b1b : CALL 0x007cc680
00877b20 : MOVSS XMM0,dword ptr [ESP + 0x20]
00877b26 : SUB ESP,0xc
00877b29 : MOV EAX,ESP
00877b2b : MOVSS dword ptr [EAX],XMM0
00877b2f : MOVSS XMM0,dword ptr [ESP + 0x30]
00877b35 : MOVSS dword ptr [EAX + 0x4],XMM0
00877b3a : MOVSS XMM0,dword ptr [ESP + 0x34]
00877b40 : MOVSS dword ptr [EAX + 0x8],XMM0
00877b45 : MOV EAX,dword ptr [EBX + 0x48]
00877b48 : CALL 0x007cd000
00877b4d : CMP dword ptr [EBX + 0xc4],0x0
00877b54 : JZ 0x00877b85
00877b56 : MOV ESI,dword ptr [EBX + 0x48]
00877b59 : CMP byte ptr [ESI + 0x5d],0x0
00877b5d : JZ 0x00877b68
00877b5f : MOV EAX,dword ptr [ESI]
00877b61 : MOV EDX,dword ptr [EAX + 0x14]
00877b64 : MOV ECX,ESI
00877b66 : CALL EDX
00877b68 : MOV EAX,dword ptr [EBX + 0xc4]
00877b6e : LEA ECX,[ESI + 0xb8]
00877b74 : CALL 0x004419e0
00877b79 : MOV EAX,[0x017251c4]
00877b7e : MOV byte ptr [EAX + 0x15d],0x1
00877b85 : MOVSS XMM0,dword ptr [ESP + 0x20]
00877b8b : MOVSS dword ptr [EBX + 0x98],XMM0
00877b93 : MOVSS XMM0,dword ptr [ESP + 0x24]
00877b99 : MOVSS dword ptr [EBX + 0x9c],XMM0
00877ba1 : MOVSS XMM0,dword ptr [ESP + 0x28]
00877ba7 : MOVSS dword ptr [EBX + 0xa0],XMM0
00877baf : JMP 0x00877c28
00877bb1 : TEST EDI,EDI
00877bb3 : JZ 0x00877bbe
00877bb5 : MOV EDX,dword ptr [EBX]
00877bb7 : MOV EAX,dword ptr [EDX]
00877bb9 : PUSH EDI
00877bba : MOV ECX,EBX
00877bbc : CALL EAX
00877bbe : CMP byte ptr [EBX + 0x31],0x0
00877bc2 : JNZ 0x00877c24
00877bc4 : MOV ECX,dword ptr [EBX + 0x50]
00877bc7 : TEST ECX,ECX
00877bc9 : JZ 0x00877bd2
00877bcb : MOV EDX,dword ptr [ECX]
00877bcd : MOV EAX,dword ptr [EDX + 0x24]
00877bd0 : CALL EAX
00877bd2 : MOV ECX,dword ptr [EBX + 0x54]
00877bd5 : TEST ECX,ECX
00877bd7 : JZ 0x00877be3
00877bd9 : MOV EDX,dword ptr [ECX]
00877bdb : MOV EAX,dword ptr [EDX + 0xd4]
00877be1 : CALL EAX
00877be3 : MOV ECX,dword ptr [EBX + 0xc4]
00877be9 : TEST ECX,ECX
00877beb : JZ 0x00877c02
00877bed : MOV EDI,dword ptr [0x017251c4]
00877bf3 : CALL 0x007dd4b0
00877bf8 : MOV dword ptr [EBX + 0xc4],0x0
00877c02 : PUSH 0x0
00877c04 : PUSH 0xc435f8
00877c09 : LEA ECX,[EBX + 0xa4]
00877c0f : MOV byte ptr [EBX + 0x8c],0x1
00877c16 : MOV byte ptr [EBX + 0x8d],0x0
00877c1d : CALL 0x00406360
00877c22 : JMP 0x00877c28
00877c24 : MOV byte ptr [EBX + 0x32],0x1
00877c28 : CMP byte ptr [EBX + 0xd4],0x0
00877c2f : JZ 0x00877c38
00877c31 : MOV EAX,EBX
00877c33 : CALL 0x008771a0
00877c38 : MOVSS XMM0,dword ptr [EBX + 0xe0]
00877c40 : COMISS XMM0,dword ptr [0x00b9b0b4]
00877c47 : JC 0x00877c50
00877c49 : MOV EDI,EBX
00877c4b : CALL 0x008773f0
00877c50 : POP EDI
00877c51 : POP ESI
00877c52 : POP EBX
00877c53 : MOV ESP,EBP
00877c55 : POP EBP
00877c56 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00963ad0
ENTRY    : 00963ad0
BODY     : [[00963ad0, 00963c62]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00963ad0(void)

{
  uint uVar1;
  undefined4 uVar2;
  int iVar3;
  undefined4 *puVar4;
  int *piVar5;
  int in_ECX;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4adeb;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  uVar2 = FUN_00404750(L"Shop%d",*(undefined4 *)(in_ECX + 0x6c),
                       DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
  local_8 = 0;
  FUN_00405eb0(uVar2,0,0xffffffff);
  local_8 = 0xffffffff;
  if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  iVar3 = FUN_006f0760(0x60,".\\Gui\\AvaGuiNpcShop.cpp",0x282,0);
  local_8 = 1;
  if (iVar3 == 0) {
    uVar2 = 0;
  }
  else {
    uVar2 = FUN_00963a70(iVar3);
  }
  uVar1 = DAT_01725270;
  local_8 = 0xffffffff;
  *(undefined4 *)(in_ECX + 0x3c) = uVar2;
  puVar4 = (undefined4 *)FUN_006f0760(0x28,"",0,(uVar1 >> 3 & 1) == 0);
  local_8 = 2;
  if (puVar4 == (undefined4 *)0x0) {
    puVar4 = (undefined4 *)0x0;
  }
  else {
    *puVar4 = &PTR_FUN_00ccf0fc;
    puVar4[1] = 0;
    puVar4[2] = 4;
    puVar4[3] = 5;
    puVar4[5] = 0xffffffff;
    puVar4[6] = 0xffffffff;
    puVar4[4] = 0;
    *(undefined1 *)(puVar4 + 7) = 0;
    puVar4[9] = 0;
    puVar4[8] = 0;
    FUN_00908190();
  }
  local_8 = 0xffffffff;
  *(undefined4 **)(*(int *)(in_ECX + 0x3c) + 0x3c) = puVar4;
  *(int *)(*(int *)(in_ECX + 0x3c) + 0x5c) = in_ECX;
  (**(code **)(**(int **)(in_ECX + 0x3c) + 0xc))();
  iVar3 = FUN_006f0760(0x58,".\\Gui\\AvaGuiNpcShop.cpp",0x29a,0);
  local_8 = 3;
  if (iVar3 == 0) {
    piVar5 = (int *)0x0;
  }
  else {
    piVar5 = (int *)FUN_00963140(iVar3);
  }
  local_8 = 0xffffffff;
  *(int **)(in_ECX + 0x78) = piVar5;
  (**(code **)(*piVar5 + 0xc))();
  *(undefined4 *)(in_ECX + 0x38) = *(undefined4 *)(in_ECX + 0x3c);
  *(undefined1 *)(in_ECX + 8) = 1;
  *(undefined1 *)(in_ECX + 0x68) = 0;
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00963ad0 : PUSH EBP
00963ad1 : MOV EBP,ESP
00963ad3 : PUSH -0x1
00963ad5 : PUSH 0xb4adeb
00963ada : MOV EAX,FS:[0x0]
00963ae0 : PUSH EAX
00963ae1 : SUB ESP,0x20
00963ae4 : PUSH EBX
00963ae5 : PUSH ESI
00963ae6 : PUSH EDI
00963ae7 : MOV EAX,[0x00d66fa0]
00963aec : XOR EAX,EBP
00963aee : PUSH EAX
00963aef : LEA EAX,[EBP + -0xc]
00963af2 : MOV FS:[0x0],EAX
00963af8 : MOV EBX,ECX
00963afa : MOV EAX,dword ptr [EBX + 0x6c]
00963afd : PUSH EAX
00963afe : PUSH 0xc7a1cc
00963b03 : LEA ESI,[EBP + -0x2c]
00963b06 : CALL 0x00404750
00963b0b : ADD ESP,0x8
00963b0e : XOR ESI,ESI
00963b10 : MOV dword ptr [EBP + -0x4],ESI
00963b13 : OR EDI,0xffffffff
00963b16 : PUSH EDI
00963b17 : PUSH ESI
00963b18 : PUSH EAX
00963b19 : LEA ECX,[EBX + 0xc]
00963b1c : CALL 0x00405eb0
00963b21 : MOV dword ptr [EBP + -0x4],EDI
00963b24 : CMP dword ptr [EBP + -0x14],0x8
00963b28 : JC 0x00963b32
00963b2a : MOV ECX,dword ptr [EBP + -0x28]
00963b2d : CALL 0x006f04e0
00963b32 : PUSH ESI
00963b33 : PUSH 0x282
00963b38 : XOR ECX,ECX
00963b3a : PUSH 0xc7a1dc
00963b3f : PUSH 0x60
00963b41 : MOV dword ptr [EBP + -0x14],0x7
00963b48 : MOV dword ptr [EBP + -0x18],ESI
00963b4b : MOV word ptr [EBP + -0x28],CX
00963b4f : CALL 0x006f0760
00963b54 : ADD ESP,0x10
00963b57 : MOV dword ptr [EBP + -0x10],EAX
00963b5a : MOV dword ptr [EBP + -0x4],0x1
00963b61 : CMP EAX,ESI
00963b63 : JZ 0x00963b70
00963b65 : MOV ECX,dword ptr [EBX + 0x4]
00963b68 : PUSH EAX
00963b69 : CALL 0x00963a70
00963b6e : JMP 0x00963b72
00963b70 : XOR EAX,EAX
00963b72 : MOV dword ptr [EBP + -0x4],EDI
00963b75 : MOV EDX,dword ptr [0x01725270]
00963b7b : MOV dword ptr [EBX + 0x3c],EAX
00963b7e : SHR EDX,0x3
00963b81 : MOV EAX,0x0
00963b86 : AND EDX,0x1
00963b89 : SETZ AL
00963b8c : PUSH EAX
00963b8d : PUSH ESI
00963b8e : PUSH 0xbf1a4a
00963b93 : PUSH 0x28
00963b95 : CALL 0x006f0760
00963b9a : MOV EDI,EAX
00963b9c : ADD ESP,0x10
00963b9f : MOV dword ptr [EBP + -0x10],EDI
00963ba2 : MOV dword ptr [EBP + -0x4],0x2
00963ba9 : CMP EDI,ESI
00963bab : JZ 0x00963be1
00963bad : OR EAX,0xffffffff
00963bb0 : MOV dword ptr [EDI],0xccf0fc
00963bb6 : MOV dword ptr [EDI + 0x4],ESI
00963bb9 : MOV dword ptr [EDI + 0x8],0x4
00963bc0 : MOV dword ptr [EDI + 0xc],0x5
00963bc7 : MOV dword ptr [EDI + 0x14],EAX
00963bca : MOV dword ptr [EDI + 0x18],EAX
00963bcd : MOV dword ptr [EDI + 0x10],ESI
00963bd0 : MOV byte ptr [EDI + 0x1c],0x0
00963bd4 : MOV dword ptr [EDI + 0x24],ESI
00963bd7 : MOV dword ptr [EDI + 0x20],ESI
00963bda : CALL 0x00908190
00963bdf : JMP 0x00963be3
00963be1 : XOR EDI,EDI
00963be3 : MOV dword ptr [EBP + -0x4],0xffffffff
00963bea : MOV ECX,dword ptr [EBX + 0x3c]
00963bed : MOV dword ptr [ECX + 0x3c],EDI
00963bf0 : MOV EAX,dword ptr [EBX + 0x3c]
00963bf3 : MOV dword ptr [EAX + 0x5c],EBX
00963bf6 : MOV ECX,dword ptr [EBX + 0x3c]
00963bf9 : MOV EDX,dword ptr [ECX]
00963bfb : MOV EAX,dword ptr [EDX + 0xc]
00963bfe : CALL EAX
00963c00 : PUSH ESI
00963c01 : PUSH 0x29a
00963c06 : PUSH 0xc7a20c
00963c0b : PUSH 0x58
00963c0d : CALL 0x006f0760
00963c12 : ADD ESP,0x10
00963c15 : MOV dword ptr [EBP + -0x10],EAX
00963c18 : MOV dword ptr [EBP + -0x4],0x3
00963c1f : CMP EAX,ESI
00963c21 : JZ 0x00963c2e
00963c23 : MOV ECX,dword ptr [EBX + 0x4]
00963c26 : PUSH EAX
00963c27 : CALL 0x00963140
00963c2c : JMP 0x00963c30
00963c2e : XOR EAX,EAX
00963c30 : MOV dword ptr [EBP + -0x4],0xffffffff
00963c37 : MOV dword ptr [EBX + 0x78],EAX
00963c3a : MOV EDX,dword ptr [EAX]
00963c3c : MOV ECX,EAX
00963c3e : MOV EAX,dword ptr [EDX + 0xc]
00963c41 : CALL EAX
00963c43 : MOV ECX,dword ptr [EBX + 0x3c]
00963c46 : MOV dword ptr [EBX + 0x38],ECX
00963c49 : MOV byte ptr [EBX + 0x8],0x1
00963c4d : MOV byte ptr [EBX + 0x68],0x0
00963c51 : MOV ECX,dword ptr [EBP + -0xc]
00963c54 : MOV dword ptr FS:[0x0],ECX
00963c5b : POP ECX
00963c5c : POP EDI
00963c5d : POP ESI
00963c5e : POP EBX
00963c5f : MOV ESP,EBP
00963c61 : POP EBP
00963c62 : RET

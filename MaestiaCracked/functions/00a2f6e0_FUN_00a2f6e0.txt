PROGRAM  : Maestia.exe
FUNCTION : FUN_00a2f6e0
ENTRY    : 00a2f6e0
BODY     : [[00a2f6e0, 00a2f926]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a2f6e0(void)

{
  float fVar1;
  int iVar2;
  int iVar3;
  int *in_ECX;
  float fVar4;
  int iStack_2c;
  undefined4 local_28;
  undefined4 uStack_24;
  undefined4 local_20;
  float local_1c;
  float local_18;
  undefined4 local_14;
  float local_10;
  float local_c;
  
  local_28 = 0;
  local_20 = 0;
  local_1c = 0.0;
  local_18 = 0.0;
  local_14 = 0;
  local_10 = 0.0;
  local_c = 0.0;
  if (in_ECX[0x2b] == 0) {
    FUN_008018d0(L"[PostLoadTerrainRangeOK] m_pMyCharacter is null ");
    return;
  }
  iVar3 = in_ECX[0x2b];
  local_10 = *(float *)(iVar3 + 8000);
  local_14 = *(undefined4 *)(iVar3 + 0x1f3c);
  fVar4 = *(float *)(iVar3 + 0x1f44);
  local_c = fVar4;
  if (*(char *)(iVar3 + 0x1fc1) == '\0') {
    FUN_007e9290(in_ECX[3]);
    iVar3 = FUN_007df230(local_20,local_18);
    if (iVar3 != 0) {
      FUN_007afaa0(iVar3,&local_28);
    }
    *(undefined2 *)(in_ECX[0x2b] + 0x41c) = (undefined2)local_28;
  }
  else {
    iVar3 = *(int *)(in_ECX[3] + 0x9c);
    fVar1 = (float)*(int *)(iVar3 + 0x50);
    if (*(int *)(iVar3 + 0x50) < 0) {
      fVar1 = fVar1 + 4.2949673e+09;
    }
    local_18 = fVar1 * *(float *)(iVar3 + 100) - local_10;
    local_20 = local_14;
    local_1c = fVar4;
    iVar3 = FUN_007df230(local_14,local_18);
    if (iVar3 != 0) {
      FUN_007afaa0(iVar3,&local_28);
      fVar4 = local_c;
    }
    *(undefined2 *)(in_ECX[0x2b] + 0x41c) = (undefined2)local_28;
    local_1c = fVar4;
    if (10000.0 < fVar4) {
      FUN_007e9290(in_ECX[3]);
      FUN_007e9a50(&local_28);
      *(undefined2 *)(in_ECX[0x2b] + 0x41c) = (undefined2)local_28;
      if (in_ECX[0x2b] != 0) {
        *(undefined1 *)(*(int *)(DAT_0172491c + 0x17c) + 0x1fc1) = 0;
      }
    }
  }
  (**(code **)(*(int *)in_ECX[0x2b] + 0x2a0))(&local_20,1);
  iVar2 = DAT_017251b8;
  iVar3 = in_ECX[0x2b];
  *(undefined4 *)(iVar3 + 0x2018) = local_28;
  *(undefined4 *)(iVar3 + 0x201c) = uStack_24;
  *(undefined4 *)(iVar3 + 0x2020) = local_20;
  FUN_00484470(&stack0xffffffd0);
  if ((iStack_2c != *(int *)(iVar2 + 0x50)) && (*(int *)(iStack_2c + 0x10) != 0)) {
    *(undefined4 *)(*(int *)(iStack_2c + 0x10) + 0x48) = 1;
  }
  (**(code **)(*in_ECX + 4))();
  return;
}



============================================================
DISASSEMBLY
============================================================
00a2f6e0 : PUSH EBP
00a2f6e1 : MOV EBP,ESP
00a2f6e3 : AND ESP,0xfffffff8
00a2f6e6 : SUB ESP,0x24
00a2f6e9 : XORPS XMM0,XMM0
00a2f6ec : PUSH EBX
00a2f6ed : MOV EBX,ECX
00a2f6ef : CMP dword ptr [EBX + 0xac],0x0
00a2f6f6 : PUSH ESI
00a2f6f7 : PUSH EDI
00a2f6f8 : MOV dword ptr [ESP + 0x10],0x0
00a2f700 : MOVSS dword ptr [ESP + 0x18],XMM0
00a2f706 : MOVSS dword ptr [ESP + 0x1c],XMM0
00a2f70c : MOVSS dword ptr [ESP + 0x20],XMM0
00a2f712 : MOVSS dword ptr [ESP + 0x24],XMM0
00a2f718 : MOVSS dword ptr [ESP + 0x28],XMM0
00a2f71e : MOVSS dword ptr [ESP + 0x2c],XMM0
00a2f724 : JNZ 0x00a2f740
00a2f726 : MOV ESI,dword ptr [0x00da98e8]
00a2f72c : PUSH 0xcc01a8
00a2f731 : CALL 0x008018d0
00a2f736 : ADD ESP,0x4
00a2f739 : POP EDI
00a2f73a : POP ESI
00a2f73b : POP EBX
00a2f73c : MOV ESP,EBP
00a2f73e : POP EBP
00a2f73f : RET
00a2f740 : MOV EAX,dword ptr [EBX + 0xac]
00a2f746 : CMP byte ptr [EAX + 0x1fc1],0x0
00a2f74d : MOVSS XMM0,dword ptr [EAX + 0x1f40]
00a2f755 : MOVSS XMM1,dword ptr [EAX + 0x1f3c]
00a2f75d : MOVSS dword ptr [ESP + 0x28],XMM0
00a2f763 : MOVSS XMM0,dword ptr [EAX + 0x1f44]
00a2f76b : MOVSS dword ptr [ESP + 0x24],XMM1
00a2f771 : MOVSS dword ptr [ESP + 0x2c],XMM0
00a2f777 : JZ 0x00a2f84f
00a2f77d : MOV EDI,dword ptr [EBX + 0xc]
00a2f780 : MOV EAX,dword ptr [EDI + 0x9c]
00a2f786 : MOV ECX,dword ptr [EAX + 0x50]
00a2f789 : FILD dword ptr [EAX + 0x50]
00a2f78c : TEST ECX,ECX
00a2f78e : JGE 0x00a2f796
00a2f790 : FADD float ptr [0x00cdf0e0]
00a2f796 : FMUL float ptr [EAX + 0x64]
00a2f799 : SUB ESP,0x8
00a2f79c : MOVSS dword ptr [ESP + 0x20],XMM1
00a2f7a2 : MOVSS dword ptr [ESP + 0x24],XMM0
00a2f7a8 : FSUB float ptr [ESP + 0x30]
00a2f7ac : FST float ptr [ESP + 0x28]
00a2f7b0 : FSTP float ptr [ESP + 0x4]
00a2f7b4 : FLD float ptr [ESP + 0x2c]
00a2f7b8 : FSTP float ptr [ESP]
00a2f7bb : CALL 0x007df230
00a2f7c0 : TEST EAX,EAX
00a2f7c2 : JZ 0x00a2f7d9
00a2f7c4 : LEA EDX,[ESP + 0x10]
00a2f7c8 : PUSH EDX
00a2f7c9 : PUSH EAX
00a2f7ca : LEA EDI,[ESP + 0x20]
00a2f7ce : CALL 0x007afaa0
00a2f7d3 : MOVSS XMM0,dword ptr [ESP + 0x2c]
00a2f7d9 : COMISS XMM0,dword ptr [0x00cdf288]
00a2f7e0 : MOV EAX,dword ptr [EBX + 0xac]
00a2f7e6 : MOV CX,word ptr [ESP + 0x10]
00a2f7eb : MOV word ptr [EAX + 0x41c],CX
00a2f7f2 : MOVSS dword ptr [ESP + 0x1c],XMM0
00a2f7f8 : JBE 0x00a2f89f
00a2f7fe : MOV EDX,dword ptr [EBX + 0xc]
00a2f801 : PUSH EDX
00a2f802 : LEA EDX,[ESP + 0x1c]
00a2f806 : LEA ECX,[ESP + 0x28]
00a2f80a : CALL 0x007e9290
00a2f80f : LEA EAX,[ESP + 0x10]
00a2f813 : PUSH EAX
00a2f814 : MOV EAX,dword ptr [EBX + 0xc]
00a2f817 : LEA ESI,[ESP + 0x1c]
00a2f81b : CALL 0x007e9a50
00a2f820 : MOV ECX,dword ptr [EBX + 0xac]
00a2f826 : MOV DX,word ptr [ESP + 0x10]
00a2f82b : MOV word ptr [ECX + 0x41c],DX
00a2f832 : CMP dword ptr [EBX + 0xac],0x0
00a2f839 : JZ 0x00a2f89f
00a2f83b : MOV EAX,[0x0172491c]
00a2f840 : MOV ECX,dword ptr [EAX + 0x17c]
00a2f846 : MOV byte ptr [ECX + 0x1fc1],0x0
00a2f84d : JMP 0x00a2f89f
00a2f84f : MOV EDX,dword ptr [EBX + 0xc]
00a2f852 : PUSH EDX
00a2f853 : LEA EDX,[ESP + 0x1c]
00a2f857 : LEA ECX,[ESP + 0x28]
00a2f85b : CALL 0x007e9290
00a2f860 : FLD float ptr [ESP + 0x20]
00a2f864 : MOV EDI,dword ptr [EBX + 0xc]
00a2f867 : SUB ESP,0x8
00a2f86a : FSTP float ptr [ESP + 0x4]
00a2f86e : FLD float ptr [ESP + 0x20]
00a2f872 : FSTP float ptr [ESP]
00a2f875 : CALL 0x007df230
00a2f87a : TEST EAX,EAX
00a2f87c : JZ 0x00a2f88d
00a2f87e : LEA ECX,[ESP + 0x10]
00a2f882 : PUSH ECX
00a2f883 : PUSH EAX
00a2f884 : LEA EDI,[ESP + 0x20]
00a2f888 : CALL 0x007afaa0
00a2f88d : MOV EDX,dword ptr [EBX + 0xac]
00a2f893 : MOV AX,word ptr [ESP + 0x10]
00a2f898 : MOV word ptr [EDX + 0x41c],AX
00a2f89f : MOV ECX,dword ptr [EBX + 0xac]
00a2f8a5 : MOV EDX,dword ptr [ECX]
00a2f8a7 : MOV EDX,dword ptr [EDX + 0x2a0]
00a2f8ad : PUSH 0x1
00a2f8af : LEA EAX,[ESP + 0x1c]
00a2f8b3 : PUSH EAX
00a2f8b4 : CALL EDX
00a2f8b6 : MOV EAX,dword ptr [EBX + 0xac]
00a2f8bc : MOVSS XMM0,dword ptr [ESP + 0x18]
00a2f8c2 : MOV ESI,dword ptr [0x017251b8]
00a2f8c8 : ADD EAX,0x2018
00a2f8cd : MOVSS dword ptr [EAX],XMM0
00a2f8d1 : MOVSS XMM0,dword ptr [ESP + 0x1c]
00a2f8d7 : MOVSS dword ptr [EAX + 0x4],XMM0
00a2f8dc : MOVSS XMM0,dword ptr [ESP + 0x20]
00a2f8e2 : MOVSS dword ptr [EAX + 0x8],XMM0
00a2f8e7 : LEA EAX,[ESP + 0x10]
00a2f8eb : PUSH EAX
00a2f8ec : LEA ECX,[ESI + 0x4c]
00a2f8ef : LEA EAX,[ESP + 0x18]
00a2f8f3 : MOV dword ptr [ESP + 0x14],0x0
00a2f8fb : CALL 0x00484470
00a2f900 : MOV EAX,dword ptr [ESP + 0x14]
00a2f904 : CMP EAX,dword ptr [ESI + 0x50]
00a2f907 : JZ 0x00a2f917
00a2f909 : MOV EAX,dword ptr [EAX + 0x10]
00a2f90c : TEST EAX,EAX
00a2f90e : JZ 0x00a2f917
00a2f910 : MOV dword ptr [EAX + 0x48],0x1
00a2f917 : MOV EDX,dword ptr [EBX]
00a2f919 : MOV EAX,dword ptr [EDX + 0x4]
00a2f91c : MOV ECX,EBX
00a2f91e : CALL EAX
00a2f920 : POP EDI
00a2f921 : POP ESI
00a2f922 : POP EBX
00a2f923 : MOV ESP,EBP
00a2f925 : POP EBP
00a2f926 : RET

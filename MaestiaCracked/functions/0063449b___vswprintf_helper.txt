PROGRAM  : Maestia.exe
FUNCTION : __vswprintf_helper
ENTRY    : 0063449b
BODY     : [[0063449b, 00634592]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    __vswprintf_helper
   
   Library: Visual Studio 2008 Release */

int __vswprintf_helper(code *param_1,char *param_2,uint param_3,int param_4,undefined4 param_5,
                      undefined4 param_6)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  FILE local_24;
  
  if (param_4 == 0) {
    piVar1 = __errno();
    *piVar1 = 0x16;
    __invalid_parameter(0,0,0,0,0);
    return -1;
  }
  if ((param_3 != 0) && (param_2 == (char *)0x0)) {
    piVar1 = __errno();
    *piVar1 = 0x16;
    __invalid_parameter(0,0,0,0,0);
    return -1;
  }
  local_24._flag = 0x42;
  local_24._base = param_2;
  local_24._ptr = param_2;
  if (param_3 < 0x40000000) {
    local_24._cnt = param_3 * 2;
  }
  else {
    local_24._cnt = 0x7fffffff;
  }
  iVar2 = (*param_1)(&local_24,param_4,param_5,param_6);
  if (param_2 == (char *)0x0) {
    return iVar2;
  }
  if (-1 < iVar2) {
    local_24._cnt = local_24._cnt + -1;
    if (local_24._cnt < 0) {
      iVar3 = __flsbuf(0,&local_24);
      if (iVar3 == -1) goto LAB_0063457f;
    }
    else {
      *local_24._ptr = '\0';
      local_24._ptr = local_24._ptr + 1;
    }
    local_24._cnt = local_24._cnt + -1;
    if (-1 < local_24._cnt) {
      *local_24._ptr = '\0';
      return iVar2;
    }
    iVar3 = __flsbuf(0,&local_24);
    if (iVar3 != -1) {
      return iVar2;
    }
  }
LAB_0063457f:
  (param_2 + param_3 * 2 + -2)[0] = '\0';
  (param_2 + param_3 * 2 + -2)[1] = '\0';
  return (-1 < local_24._cnt) - 2;
}



============================================================
DISASSEMBLY
============================================================
0063449b : MOV EDI,EDI
0063449d : PUSH EBP
0063449e : MOV EBP,ESP
006344a0 : SUB ESP,0x20
006344a3 : PUSH EBX
006344a4 : XOR EBX,EBX
006344a6 : CMP dword ptr [EBP + 0x14],EBX
006344a9 : JNZ 0x006344cb
006344ab : CALL 0x0063ab82
006344b0 : PUSH EBX
006344b1 : PUSH EBX
006344b2 : PUSH EBX
006344b3 : PUSH EBX
006344b4 : PUSH EBX
006344b5 : MOV dword ptr [EAX],0x16
006344bb : CALL 0x006372b8
006344c0 : ADD ESP,0x14
006344c3 : OR EAX,0xffffffff
006344c6 : JMP 0x00634590
006344cb : PUSH ESI
006344cc : MOV ESI,dword ptr [EBP + 0xc]
006344cf : PUSH EDI
006344d0 : MOV EDI,dword ptr [EBP + 0x10]
006344d3 : CMP EDI,EBX
006344d5 : JZ 0x006344fb
006344d7 : CMP ESI,EBX
006344d9 : JNZ 0x006344fb
006344db : CALL 0x0063ab82
006344e0 : PUSH EBX
006344e1 : PUSH EBX
006344e2 : PUSH EBX
006344e3 : PUSH EBX
006344e4 : PUSH EBX
006344e5 : MOV dword ptr [EAX],0x16
006344eb : CALL 0x006372b8
006344f0 : ADD ESP,0x14
006344f3 : OR EAX,0xffffffff
006344f6 : JMP 0x0063458e
006344fb : MOV dword ptr [EBP + -0x14],0x42
00634502 : MOV dword ptr [EBP + -0x18],ESI
00634505 : MOV dword ptr [EBP + -0x20],ESI
00634508 : CMP EDI,0x3fffffff
0063450e : JBE 0x00634519
00634510 : MOV dword ptr [EBP + -0x1c],0x7fffffff
00634517 : JMP 0x0063451f
00634519 : LEA EAX,[EDI + EDI*0x1]
0063451c : MOV dword ptr [EBP + -0x1c],EAX
0063451f : PUSH dword ptr [EBP + 0x1c]
00634522 : LEA EAX,[EBP + -0x20]
00634525 : PUSH dword ptr [EBP + 0x18]
00634528 : PUSH dword ptr [EBP + 0x14]
0063452b : PUSH EAX
0063452c : CALL dword ptr [EBP + 0x8]
0063452f : ADD ESP,0x10
00634532 : MOV dword ptr [EBP + 0x14],EAX
00634535 : CMP ESI,EBX
00634537 : JZ 0x0063458e
00634539 : CMP EAX,EBX
0063453b : JL 0x0063457f
0063453d : DEC dword ptr [EBP + -0x1c]
00634540 : JS 0x0063454c
00634542 : MOV EAX,dword ptr [EBP + -0x20]
00634545 : MOV byte ptr [EAX],BL
00634547 : INC dword ptr [EBP + -0x20]
0063454a : JMP 0x0063455d
0063454c : LEA EAX,[EBP + -0x20]
0063454f : PUSH EAX
00634550 : PUSH EBX
00634551 : CALL 0x00645eff
00634556 : POP ECX
00634557 : POP ECX
00634558 : CMP EAX,-0x1
0063455b : JZ 0x0063457f
0063455d : DEC dword ptr [EBP + -0x1c]
00634560 : JS 0x00634569
00634562 : MOV EAX,dword ptr [EBP + -0x20]
00634565 : MOV byte ptr [EAX],BL
00634567 : JMP 0x0063457a
00634569 : LEA EAX,[EBP + -0x20]
0063456c : PUSH EAX
0063456d : PUSH EBX
0063456e : CALL 0x00645eff
00634573 : POP ECX
00634574 : POP ECX
00634575 : CMP EAX,-0x1
00634578 : JZ 0x0063457f
0063457a : MOV EAX,dword ptr [EBP + 0x14]
0063457d : JMP 0x0063458e
0063457f : XOR EAX,EAX
00634581 : CMP dword ptr [EBP + -0x1c],EBX
00634584 : MOV word ptr [ESI + EDI*0x2 + -0x2],AX
00634589 : SETGE AL
0063458c : DEC EAX
0063458d : DEC EAX
0063458e : POP EDI
0063458f : POP ESI
00634590 : POP EBX
00634591 : LEAVE
00634592 : RET

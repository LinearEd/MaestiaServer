PROGRAM  : Maestia.exe
FUNCTION : FUN_00748a20
ENTRY    : 00748a20
BODY     : [[00748a20, 00748c62]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00748a20(int param_1,int *param_2,int *param_3)

{
  ushort uVar1;
  int iVar2;
  int iVar3;
  byte bVar4;
  byte *pbVar5;
  uint uVar6;
  LPCRITICAL_SECTION local_34;
  char *local_30;
  undefined4 local_2c;
  int local_28;
  undefined4 local_24;
  uint local_20;
  uint local_1c;
  uint local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b10df9;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if ((*(char *)(DAT_017251ac + 4) != '\0') &&
     ((local_14 = (**(code **)(*param_2 + 4))(DAT_00d66fa0 ^ (uint)&stack0xfffffffc), local_14 == 2
      || (local_14 == 0x15)))) {
    uVar1 = *(ushort *)(param_2 + 0x79);
    uVar6 = (uint)uVar1;
    if (uVar1 != 0) {
      local_20 = uVar6;
      if (*(char *)(param_2[9] + 0x5d) != '\0') {
        (**(code **)(*(int *)param_2[9] + 0x14))();
      }
      (**(code **)(*param_3 + 0x14))();
      iVar3 = param_2[0x89];
      if ((int *)param_2[9] != (int *)0x0) {
        (**(code **)(*(int *)param_2[9] + 0x80))(0);
      }
      local_1c = 0;
      if (uVar1 != 0) {
        do {
          iVar2 = *(int *)(param_2[0x76] + (local_1c & 0xffff) * 4);
          if (iVar2 != 0) {
            pbVar5 = *(byte **)(iVar2 + 0x154);
            if (pbVar5 == (byte *)0x0) {
              pbVar5 = (byte *)FUN_0077e760();
              if (pbVar5 == (byte *)0x0) {
                ExceptionList = local_10;
                return;
              }
              *(byte **)(iVar2 + 0x154) = pbVar5;
              *(int *)(pbVar5 + 0x18) = iVar2;
              pbVar5[3] = 0;
              pbVar5[4] = 0;
              pbVar5[1] = 0;
              if (local_14 == 0x15) {
                bVar4 = FUN_00767f90();
              }
              else {
                bVar4 = (byte)*(undefined2 *)(*(int *)(*(int *)(iVar2 + 4) + 0x1e8) + 0xe4);
              }
              *pbVar5 = bVar4;
              pbVar5[5] = 0;
              pbVar5[8] = 0;
              pbVar5[9] = 0;
              pbVar5[10] = 0;
              pbVar5[0xb] = 0;
              pbVar5[2] = 0;
              pbVar5[6] = 1;
              pbVar5[0xf] = 1;
              if ((short)iVar3 == 0) {
                pbVar5[0xe] = 3;
              }
              else {
                pbVar5[0xe] = bVar4 + 3;
              }
            }
            *(uint *)(iVar2 + 0x148) = (uint)pbVar5[0xe];
            *(uint *)(iVar2 + 0x14c) = (uint)pbVar5[0xf];
            local_18 = (uint)(*pbVar5 != 0);
            local_28 = 0;
            local_34 = (LPCRITICAL_SECTION)(param_1 + 0x7c);
            local_30 = ".\\World\\AvaRenderQueue.cpp";
            local_2c = 0x545;
            local_24 = 1;
            FUN_006ef1a0(&local_34);
            local_8 = 0;
            iVar2 = param_1 + 0x94 + (uint)*pbVar5 * 0x3c;
            *(int *)(pbVar5 + 0x1c) = iVar2;
            EnterCriticalSection((LPCRITICAL_SECTION)(iVar2 + 0x1c));
            local_8 = 0xffffffff;
            if (local_28 != 0) {
              LeaveCriticalSection(local_34);
              local_28 = 0;
            }
            iVar2 = param_1 + 0x94 + (uint)*pbVar5 * 0x3c;
            (**(code **)(**(int **)(iVar2 + 0x34 + local_18 * 4) + 0x40))(pbVar5);
            *(undefined1 *)(iVar2 + 0xc) = 0;
            LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0xb0 + (uint)*pbVar5 * 0x3c));
            uVar6 = local_20;
          }
          local_1c = local_1c + 1;
        } while ((ushort)local_1c < (ushort)uVar6);
      }
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00748a20 : PUSH EBP
00748a21 : MOV EBP,ESP
00748a23 : PUSH -0x1
00748a25 : PUSH 0xb10df9
00748a2a : MOV EAX,FS:[0x0]
00748a30 : PUSH EAX
00748a31 : SUB ESP,0x24
00748a34 : PUSH EBX
00748a35 : PUSH ESI
00748a36 : PUSH EDI
00748a37 : MOV EAX,[0x00d66fa0]
00748a3c : XOR EAX,EBP
00748a3e : PUSH EAX
00748a3f : LEA EAX,[EBP + -0xc]
00748a42 : MOV FS:[0x0],EAX
00748a48 : MOV EBX,dword ptr [EBP + 0x10]
00748a4b : MOV EAX,[0x017251ac]
00748a50 : MOV AL,byte ptr [EAX + 0x4]
00748a53 : TEST AL,AL
00748a55 : JZ 0x00748c4f
00748a5b : MOV ESI,dword ptr [EBP + 0xc]
00748a5e : MOV EDX,dword ptr [ESI]
00748a60 : MOV EAX,dword ptr [EDX + 0x4]
00748a63 : MOV ECX,ESI
00748a65 : CALL EAX
00748a67 : MOV dword ptr [EBP + -0x10],EAX
00748a6a : CMP EAX,0x2
00748a6d : JZ 0x00748a78
00748a6f : CMP EAX,0x15
00748a72 : JNZ 0x00748c4f
00748a78 : MOVZX EDI,word ptr [ESI + 0x1e4]
00748a7f : MOV dword ptr [EBP + -0x1c],EDI
00748a82 : TEST DI,DI
00748a85 : JBE 0x00748c4f
00748a8b : MOV ECX,dword ptr [ESI + 0x24]
00748a8e : CMP byte ptr [ECX + 0x5d],0x0
00748a92 : JZ 0x00748a9b
00748a94 : MOV EDX,dword ptr [ECX]
00748a96 : MOV EAX,dword ptr [EDX + 0x14]
00748a99 : CALL EAX
00748a9b : MOV EDX,dword ptr [EBX]
00748a9d : MOV EAX,dword ptr [EDX + 0x14]
00748aa0 : MOV ECX,EBX
00748aa2 : CALL EAX
00748aa4 : CMP word ptr [ESI + 0x224],0x0
00748aac : MOV ECX,dword ptr [ESI + 0x24]
00748aaf : SETA byte ptr [EBP + 0x13]
00748ab3 : TEST ECX,ECX
00748ab5 : JZ 0x00748ac3
00748ab7 : MOV EDX,dword ptr [ECX]
00748ab9 : MOV EAX,dword ptr [EDX + 0x80]
00748abf : PUSH 0x0
00748ac1 : CALL EAX
00748ac3 : XOR EAX,EAX
00748ac5 : XOR ECX,ECX
00748ac7 : MOV dword ptr [EBP + -0x18],EAX
00748aca : CMP CX,DI
00748acd : JNC 0x00748c4f
00748ad3 : MOV ECX,dword ptr [ESI + 0x1d8]
00748ad9 : MOVZX EDX,AX
00748adc : MOV EBX,dword ptr [ECX + EDX*0x4]
00748adf : TEST EBX,EBX
00748ae1 : JZ 0x00748c42
00748ae7 : XOR EDI,EDI
00748ae9 : CMP dword ptr [EBP + -0x10],0x15
00748aed : CMOVZ EDI,ESI
00748af0 : MOV ESI,dword ptr [EBX + 0x154]
00748af6 : TEST ESI,ESI
00748af8 : JNZ 0x00748b73
00748afa : CALL 0x0077e760
00748aff : MOV ESI,EAX
00748b01 : TEST ESI,ESI
00748b03 : JZ 0x00748c4f
00748b09 : CMP dword ptr [EBP + -0x10],0x15
00748b0d : MOV dword ptr [EBX + 0x154],ESI
00748b13 : MOV dword ptr [ESI + 0x18],EBX
00748b16 : MOV byte ptr [ESI + 0x3],0x0
00748b1a : MOV byte ptr [ESI + 0x4],0x0
00748b1e : MOV byte ptr [ESI + 0x1],0x0
00748b22 : JNZ 0x00748b2d
00748b24 : MOV EAX,EBX
00748b26 : CALL 0x00767f90
00748b2b : JMP 0x00748b3d
00748b2d : MOV EAX,dword ptr [EBX + 0x4]
00748b30 : MOV EAX,dword ptr [EAX + 0x1e8]
00748b36 : MOVZX EAX,word ptr [EAX + 0xe4]
00748b3d : CMP byte ptr [EBP + 0x13],0x0
00748b41 : MOV byte ptr [ESI],AL
00748b43 : MOV byte ptr [ESI + 0x5],0x0
00748b47 : MOV byte ptr [ESI + 0x8],0x0
00748b4b : MOV byte ptr [ESI + 0x9],0x0
00748b4f : MOV byte ptr [ESI + 0xa],0x0
00748b53 : MOV byte ptr [ESI + 0xb],0x0
00748b57 : MOV byte ptr [ESI + 0x2],0x0
00748b5b : MOV byte ptr [ESI + 0x6],0x1
00748b5f : MOV byte ptr [ESI + 0xf],0x1
00748b63 : JZ 0x00748b6f
00748b65 : MOV DL,AL
00748b67 : ADD DL,0x3
00748b6a : MOV byte ptr [ESI + 0xe],DL
00748b6d : JMP 0x00748b73
00748b6f : MOV byte ptr [ESI + 0xe],0x3
00748b73 : MOVZX EAX,byte ptr [ESI + 0xe]
00748b77 : MOV dword ptr [EBX + 0x148],EAX
00748b7d : MOVZX EAX,byte ptr [ESI + 0xf]
00748b81 : MOV dword ptr [EBX + 0x14c],EAX
00748b87 : XOR EAX,EAX
00748b89 : MOV dword ptr [EBP + -0x14],EAX
00748b8c : CMP byte ptr [ESI],AL
00748b8e : JZ 0x00748b97
00748b90 : MOV dword ptr [EBP + -0x14],0x1
00748b97 : MOV EDI,dword ptr [EBP + 0x8]
00748b9a : MOV dword ptr [EBP + -0x24],EAX
00748b9d : LEA ECX,[EBP + -0x30]
00748ba0 : LEA EAX,[EDI + 0x7c]
00748ba3 : PUSH ECX
00748ba4 : MOV dword ptr [EBP + -0x30],EAX
00748ba7 : MOV dword ptr [EBP + -0x2c],0xc08a3c
00748bae : MOV dword ptr [EBP + -0x28],0x545
00748bb5 : MOV dword ptr [EBP + -0x20],0x1
00748bbc : CALL 0x006ef1a0
00748bc1 : XOR EBX,EBX
00748bc3 : MOV dword ptr [EBP + -0x4],EBX
00748bc6 : MOVZX EAX,byte ptr [ESI]
00748bc9 : MOV EDX,EAX
00748bcb : SHL EDX,0x4
00748bce : SUB EDX,EAX
00748bd0 : LEA EAX,[EDI + EDX*0x4 + 0x94]
00748bd7 : MOV dword ptr [ESI + 0x1c],EAX
00748bda : ADD EAX,0x1c
00748bdd : PUSH EAX
00748bde : CALL dword ptr [0x00b85118]
00748be4 : MOV dword ptr [EBP + -0x4],0xffffffff
00748beb : CMP dword ptr [EBP + -0x24],EBX
00748bee : JZ 0x00748bfd
00748bf0 : MOV EAX,dword ptr [EBP + -0x30]
00748bf3 : PUSH EAX
00748bf4 : CALL dword ptr [0x00b8511c]
00748bfa : MOV dword ptr [EBP + -0x24],EBX
00748bfd : MOVZX EAX,byte ptr [ESI]
00748c00 : MOV EDX,dword ptr [EBP + -0x14]
00748c03 : MOV ECX,EAX
00748c05 : SHL ECX,0x4
00748c08 : SUB ECX,EAX
00748c0a : LEA EBX,[EDI + ECX*0x4 + 0x94]
00748c11 : MOV ECX,dword ptr [EBX + EDX*0x4 + 0x34]
00748c15 : MOV EAX,dword ptr [ECX]
00748c17 : MOV EDX,dword ptr [EAX + 0x40]
00748c1a : PUSH ESI
00748c1b : CALL EDX
00748c1d : MOV byte ptr [EBX + 0xc],0x0
00748c21 : MOVZX EAX,byte ptr [ESI]
00748c24 : MOV ECX,EAX
00748c26 : SHL ECX,0x4
00748c29 : SUB ECX,EAX
00748c2b : LEA EDX,[EDI + ECX*0x4 + 0xb0]
00748c32 : PUSH EDX
00748c33 : CALL dword ptr [0x00b8511c]
00748c39 : MOV EAX,dword ptr [EBP + -0x18]
00748c3c : MOV EDI,dword ptr [EBP + -0x1c]
00748c3f : MOV ESI,dword ptr [EBP + 0xc]
00748c42 : INC EAX
00748c43 : MOV dword ptr [EBP + -0x18],EAX
00748c46 : CMP AX,DI
00748c49 : JC 0x00748ad3
00748c4f : MOV ECX,dword ptr [EBP + -0xc]
00748c52 : MOV dword ptr FS:[0x0],ECX
00748c59 : POP ECX
00748c5a : POP EDI
00748c5b : POP ESI
00748c5c : POP EBX
00748c5d : MOV ESP,EBP
00748c5f : POP EBP
00748c60 : RET 0xc

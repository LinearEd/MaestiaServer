PROGRAM  : Maestia.exe
FUNCTION : FUN_00427800
ENTRY    : 00427800
BODY     : [[00427800, 0042783c] [00427840, 00427866]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00427800(wchar_t *param_1)

{
  wchar_t wVar1;
  wchar_t *_Dest;
  undefined1 in_CL;
  undefined4 in_EDX;
  ushort *unaff_ESI;
  
  *unaff_ESI = 0;
  _Dest = (wchar_t *)((int)unaff_ESI + 9);
  *(undefined1 *)(unaff_ESI + 1) = 0x91;
  *(undefined1 *)((int)unaff_ESI + 3) = 1;
  *(undefined1 *)(unaff_ESI + 2) = in_CL;
  *(undefined4 *)((int)unaff_ESI + 5) = in_EDX;
  _wcsncpy(_Dest,param_1,0x8c);
  *(undefined2 *)((int)unaff_ESI + 0x121) = 0;
  do {
    wVar1 = *_Dest;
    _Dest = _Dest + 1;
  } while (wVar1 != L'\0');
  *unaff_ESI = *unaff_ESI ^
               ((short)((int)_Dest - ((int)unaff_ESI + 0xb) >> 1) * 2 + 0xbU ^ *unaff_ESI) & 0x1fff;
  return;
}



============================================================
DISASSEMBLY
============================================================
00427800 : PUSH EBP
00427801 : MOV EBP,ESP
00427803 : PUSH EDI
00427804 : XOR EAX,EAX
00427806 : MOV word ptr [ESI],AX
00427809 : MOV EAX,dword ptr [EBP + 0x8]
0042780c : PUSH 0x8c
00427811 : PUSH EAX
00427812 : LEA EDI,[ESI + 0x9]
00427815 : PUSH EDI
00427816 : MOV byte ptr [ESI + 0x2],0x91
0042781a : MOV byte ptr [ESI + 0x3],0x1
0042781e : MOV byte ptr [ESI + 0x4],CL
00427821 : MOV dword ptr [ESI + 0x5],EDX
00427824 : CALL 0x00634e39
00427829 : ADD ESP,0xc
0042782c : XOR ECX,ECX
0042782e : MOV EAX,EDI
00427830 : MOV word ptr [EDI + 0x118],CX
00427837 : LEA EDX,[EAX + 0x2]
0042783a : POP EDI
0042783b : JMP 0x00427840
00427840 : MOV CX,word ptr [EAX]
00427843 : ADD EAX,0x2
00427846 : TEST CX,CX
00427849 : JNZ 0x00427840
0042784b : SUB EAX,EDX
0042784d : SAR EAX,0x1
0042784f : LEA EDX,[EAX + EAX*0x1 + 0xb]
00427853 : XOR DX,word ptr [ESI]
00427856 : MOV EAX,0x1fff
0042785b : AND DX,AX
0042785e : XOR word ptr [ESI],DX
00427861 : MOV EAX,ESI
00427863 : POP EBP
00427864 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_00913040
ENTRY    : 00913040
BODY     : [[00913040, 00913313]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00913040(void)

{
  undefined1 uVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  int unaff_EDI;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  iVar2 = DAT_017248cc;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3f715;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *(undefined4 *)(DAT_017248cc + 4) = *(undefined4 *)(unaff_EDI + 0x38);
  *(undefined4 *)(iVar2 + 8) = *(undefined4 *)(unaff_EDI + 0x3c);
  *(undefined1 *)(iVar2 + 0xc) = *(undefined1 *)(unaff_EDI + 0x40);
  *(undefined1 *)(iVar2 + 0xe) = *(undefined1 *)(unaff_EDI + 0x42);
  *(undefined1 *)(iVar2 + 0xf) = *(undefined1 *)(unaff_EDI + 0x43);
  *(undefined1 *)(iVar2 + 0x10) = *(undefined1 *)(unaff_EDI + 0x44);
  *(undefined1 *)(iVar2 + 0xd) = *(undefined1 *)(unaff_EDI + 0x41);
  *(undefined1 *)(iVar2 + 0x11) = *(undefined1 *)(unaff_EDI + 0x45);
  *(undefined1 *)(iVar2 + 0x12) = *(undefined1 *)(unaff_EDI + 0x46);
  *(undefined1 *)(iVar2 + 0x13) = *(undefined1 *)(unaff_EDI + 0x47);
  *(undefined1 *)(iVar2 + 0x14) = *(undefined1 *)(unaff_EDI + 0x58);
  *(undefined1 *)(iVar2 + 0x15) = *(undefined1 *)(unaff_EDI + 0x49);
  *(undefined1 *)(iVar2 + 0x16) = *(undefined1 *)(unaff_EDI + 0x4a);
  *(undefined1 *)(iVar2 + 0x18) = *(undefined1 *)(unaff_EDI + 0x4b);
  *(undefined1 *)(iVar2 + 0x19) = *(undefined1 *)(unaff_EDI + 0x4c);
  *(undefined1 *)(iVar2 + 0x1a) = *(undefined1 *)(unaff_EDI + 0x4d);
  *(undefined1 *)(iVar2 + 0x1b) = *(undefined1 *)(unaff_EDI + 0x4e);
  *(undefined1 *)(iVar2 + 0x1c) = *(undefined1 *)(unaff_EDI + 0x50);
  *(undefined1 *)(iVar2 + 0x1d) = *(undefined1 *)(unaff_EDI + 0x51);
  *(undefined1 *)(iVar2 + 0x24) = *(undefined1 *)(unaff_EDI + 0x52);
  *(undefined1 *)(iVar2 + 0x25) = *(undefined1 *)(unaff_EDI + 0x53);
  *(undefined1 *)(iVar2 + 0x26) = *(undefined1 *)(unaff_EDI + 0x54);
  *(undefined1 *)(iVar2 + 0x27) = *(undefined1 *)(unaff_EDI + 0x56);
  *(undefined1 *)(iVar2 + 0x17) = *(undefined1 *)(unaff_EDI + 0x48);
  *(undefined1 *)(iVar2 + 0x7b) = *(undefined1 *)(unaff_EDI + 99);
  *(undefined1 *)(iVar2 + 0x7d) = *(undefined1 *)(unaff_EDI + 0x65);
  *(undefined1 *)(iVar2 + 0x7c) = *(undefined1 *)(unaff_EDI + 100);
  *(undefined1 *)(iVar2 + 0x7e) = *(undefined1 *)(unaff_EDI + 0x66);
  *(undefined1 *)(iVar2 + 0x7f) = *(undefined1 *)(unaff_EDI + 0x67);
  *(undefined1 *)(iVar2 + 0x83) = *(undefined1 *)(unaff_EDI + 0x6b);
  *(undefined1 *)(iVar2 + 0x84) = *(undefined1 *)(unaff_EDI + 0x6c);
  *(undefined1 *)(iVar2 + 0x85) = *(undefined1 *)(unaff_EDI + 0x6d);
  *(undefined1 *)(iVar2 + 0x86) = *(undefined1 *)(unaff_EDI + 0x6e);
  *(undefined1 *)(iVar2 + 0x87) = *(undefined1 *)(unaff_EDI + 0x6f);
  *(undefined1 *)(iVar2 + 0x89) = *(undefined1 *)(unaff_EDI + 0x71);
  *(undefined1 *)(iVar2 + 0x8b) = *(undefined1 *)(unaff_EDI + 0x73);
  *(undefined1 *)(iVar2 + 0x8c) = *(undefined1 *)(unaff_EDI + 0x74);
  *(undefined1 *)(iVar2 + 0x8d) = *(undefined1 *)(unaff_EDI + 0x75);
  *(undefined1 *)(iVar2 + 0x60) = *(undefined1 *)(unaff_EDI + 0x4f);
  *(undefined2 *)(iVar2 + 0x28) = *(undefined2 *)(unaff_EDI + 0x76);
  iVar4 = DAT_0172491c;
  *(undefined1 *)(iVar2 + 0x2a) = *(undefined1 *)(unaff_EDI + 0x55);
  *(undefined1 *)(iVar2 + 0x2b) = *(undefined1 *)(unaff_EDI + 0x57);
  *(undefined4 *)(iVar2 + 0x20) = *(undefined4 *)(unaff_EDI + 0x5c);
  *(undefined1 *)(iVar2 + 0x2d) = *(undefined1 *)(unaff_EDI + 0x61);
  *(undefined1 *)(iVar2 + 0x2e) = *(undefined1 *)(unaff_EDI + 0x62);
  if ((((*(int *)(iVar4 + 0xc4) == 4) && (iVar4 = *(int *)(iVar4 + 0x17c), iVar4 != 0)) &&
      (*(int *)(iVar4 + 0x1f54) != 0)) &&
     ((*(char *)(iVar2 + 0x2c) == '\0' && (*(char *)(unaff_EDI + 0x60) == '\x01')))) {
    *(undefined1 *)(iVar2 + 0x2c) = 1;
    FUN_00a90e90(uVar3);
  }
  else {
    *(undefined1 *)(iVar2 + 0x2c) = *(undefined1 *)(unaff_EDI + 0x60);
  }
  if (DAT_00da93ec != 0) {
    uVar1 = *(undefined1 *)(unaff_EDI + 0x40);
    (**(code **)(**(int **)(DAT_00da93ec + 0xac) + 0x2d8))(uVar1);
    FUN_00a1a2c0(uVar1,1);
    FUN_00a1a520(*(undefined1 *)(unaff_EDI + 0x41));
    FUN_00a1a460(*(undefined1 *)(unaff_EDI + 0x42));
    FUN_00a1a3a0(*(undefined1 *)(unaff_EDI + 0x43));
    FUN_00a1a1e0(*(undefined1 *)(unaff_EDI + 0x58));
    iVar2 = DAT_00da93ec;
    uVar1 = *(undefined1 *)(unaff_EDI + 0x44);
    if (DAT_00da93ec == 0) {
      iVar4 = 0;
    }
    else {
      iVar4 = DAT_00da93ec + 0x18;
    }
    EnterCriticalSection((LPCRITICAL_SECTION)(iVar4 + 4));
    local_8 = 0;
    (**(code **)(**(int **)(iVar2 + 0xac) + 0x2dc))(uVar1);
    local_8 = 0xffffffff;
    LeaveCriticalSection((LPCRITICAL_SECTION)(iVar4 + 4));
    FUN_00a1a060(1,*(undefined1 *)(unaff_EDI + 0x45),0);
    FUN_00a1a060(2,*(undefined1 *)(unaff_EDI + 0x46),0);
    FUN_00a1a060(3,*(undefined1 *)(unaff_EDI + 0x47),0);
    if (DAT_017248cc != 0) {
      FUN_00a28ee0();
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00913040 : PUSH EBP
00913041 : MOV EBP,ESP
00913043 : PUSH -0x1
00913045 : PUSH 0xb3f715
0091304a : MOV EAX,FS:[0x0]
00913050 : PUSH EAX
00913051 : SUB ESP,0x8
00913054 : PUSH EBX
00913055 : PUSH ESI
00913056 : MOV EAX,[0x00d66fa0]
0091305b : XOR EAX,EBP
0091305d : PUSH EAX
0091305e : LEA EAX,[EBP + -0xc]
00913061 : MOV FS:[0x0],EAX
00913067 : MOVSS XMM0,dword ptr [EDI + 0x38]
0091306c : MOV EAX,[0x017248cc]
00913071 : MOVSS dword ptr [EAX + 0x4],XMM0
00913076 : MOVSS XMM0,dword ptr [EDI + 0x3c]
0091307b : MOVSS dword ptr [EAX + 0x8],XMM0
00913080 : MOV CL,byte ptr [EDI + 0x40]
00913083 : MOV byte ptr [EAX + 0xc],CL
00913086 : MOV CL,byte ptr [EDI + 0x42]
00913089 : MOV byte ptr [EAX + 0xe],CL
0091308c : MOV CL,byte ptr [EDI + 0x43]
0091308f : MOV byte ptr [EAX + 0xf],CL
00913092 : MOV CL,byte ptr [EDI + 0x44]
00913095 : MOV byte ptr [EAX + 0x10],CL
00913098 : MOV CL,byte ptr [EDI + 0x41]
0091309b : MOV byte ptr [EAX + 0xd],CL
0091309e : MOV CL,byte ptr [EDI + 0x45]
009130a1 : MOV byte ptr [EAX + 0x11],CL
009130a4 : MOV CL,byte ptr [EDI + 0x46]
009130a7 : MOV byte ptr [EAX + 0x12],CL
009130aa : MOV CL,byte ptr [EDI + 0x47]
009130ad : MOV byte ptr [EAX + 0x13],CL
009130b0 : MOV CL,byte ptr [EDI + 0x58]
009130b3 : MOV byte ptr [EAX + 0x14],CL
009130b6 : MOV CL,byte ptr [EDI + 0x49]
009130b9 : MOV byte ptr [EAX + 0x15],CL
009130bc : MOV CL,byte ptr [EDI + 0x4a]
009130bf : MOV byte ptr [EAX + 0x16],CL
009130c2 : MOV CL,byte ptr [EDI + 0x4b]
009130c5 : MOV byte ptr [EAX + 0x18],CL
009130c8 : MOV CL,byte ptr [EDI + 0x4c]
009130cb : MOV byte ptr [EAX + 0x19],CL
009130ce : MOV CL,byte ptr [EDI + 0x4d]
009130d1 : MOV byte ptr [EAX + 0x1a],CL
009130d4 : MOV CL,byte ptr [EDI + 0x4e]
009130d7 : MOV byte ptr [EAX + 0x1b],CL
009130da : MOV CL,byte ptr [EDI + 0x50]
009130dd : MOV byte ptr [EAX + 0x1c],CL
009130e0 : MOV CL,byte ptr [EDI + 0x51]
009130e3 : MOV byte ptr [EAX + 0x1d],CL
009130e6 : MOV CL,byte ptr [EDI + 0x52]
009130e9 : MOV byte ptr [EAX + 0x24],CL
009130ec : MOV CL,byte ptr [EDI + 0x53]
009130ef : MOV byte ptr [EAX + 0x25],CL
009130f2 : MOV CL,byte ptr [EDI + 0x54]
009130f5 : MOV byte ptr [EAX + 0x26],CL
009130f8 : MOV CL,byte ptr [EDI + 0x56]
009130fb : MOV byte ptr [EAX + 0x27],CL
009130fe : MOV CL,byte ptr [EDI + 0x48]
00913101 : MOV byte ptr [EAX + 0x17],CL
00913104 : MOV CL,byte ptr [EDI + 0x63]
00913107 : MOV byte ptr [EAX + 0x7b],CL
0091310a : MOV CL,byte ptr [EDI + 0x65]
0091310d : MOV byte ptr [EAX + 0x7d],CL
00913110 : MOV CL,byte ptr [EDI + 0x64]
00913113 : MOV byte ptr [EAX + 0x7c],CL
00913116 : MOV CL,byte ptr [EDI + 0x66]
00913119 : MOV byte ptr [EAX + 0x7e],CL
0091311c : MOV CL,byte ptr [EDI + 0x67]
0091311f : MOV byte ptr [EAX + 0x7f],CL
00913122 : MOV CL,byte ptr [EDI + 0x6b]
00913125 : MOV byte ptr [EAX + 0x83],CL
0091312b : MOV CL,byte ptr [EDI + 0x6c]
0091312e : MOV byte ptr [EAX + 0x84],CL
00913134 : MOV CL,byte ptr [EDI + 0x6d]
00913137 : MOV byte ptr [EAX + 0x85],CL
0091313d : MOV CL,byte ptr [EDI + 0x6e]
00913140 : MOV byte ptr [EAX + 0x86],CL
00913146 : MOV CL,byte ptr [EDI + 0x6f]
00913149 : MOV byte ptr [EAX + 0x87],CL
0091314f : MOV CL,byte ptr [EDI + 0x71]
00913152 : MOV byte ptr [EAX + 0x89],CL
00913158 : MOV CL,byte ptr [EDI + 0x73]
0091315b : MOV byte ptr [EAX + 0x8b],CL
00913161 : MOV CL,byte ptr [EDI + 0x74]
00913164 : MOV byte ptr [EAX + 0x8c],CL
0091316a : MOV CL,byte ptr [EDI + 0x75]
0091316d : MOV byte ptr [EAX + 0x8d],CL
00913173 : MOV CL,byte ptr [EDI + 0x4f]
00913176 : MOV byte ptr [EAX + 0x60],CL
00913179 : MOVZX ECX,word ptr [EDI + 0x76]
0091317d : MOV word ptr [EAX + 0x28],CX
00913181 : MOV CL,byte ptr [EDI + 0x55]
00913184 : MOV EDX,dword ptr [0x0172491c]
0091318a : MOV byte ptr [EAX + 0x2a],CL
0091318d : MOV CL,byte ptr [EDI + 0x57]
00913190 : MOV byte ptr [EAX + 0x2b],CL
00913193 : MOV ECX,dword ptr [EDI + 0x5c]
00913196 : MOV dword ptr [EAX + 0x20],ECX
00913199 : MOV CL,byte ptr [EDI + 0x61]
0091319c : MOV byte ptr [EAX + 0x2d],CL
0091319f : MOV CL,byte ptr [EDI + 0x62]
009131a2 : MOV byte ptr [EAX + 0x2e],CL
009131a5 : MOV ECX,dword ptr [EDX + 0xc4]
009131ab : CMP ECX,0x4
009131ae : JNZ 0x009131db
009131b0 : MOV EDX,dword ptr [EDX + 0x17c]
009131b6 : TEST EDX,EDX
009131b8 : JZ 0x009131db
009131ba : CMP dword ptr [EDX + 0x1f54],0x0
009131c1 : JZ 0x009131db
009131c3 : CMP byte ptr [EAX + 0x2c],0x0
009131c7 : JNZ 0x009131db
009131c9 : MOV CL,byte ptr [EDI + 0x60]
009131cc : CMP CL,0x1
009131cf : JNZ 0x009131db
009131d1 : MOV byte ptr [EAX + 0x2c],CL
009131d4 : CALL 0x00a90e90
009131d9 : JMP 0x009131e1
009131db : MOV CL,byte ptr [EDI + 0x60]
009131de : MOV byte ptr [EAX + 0x2c],CL
009131e1 : MOV EAX,[0x00da93ec]
009131e6 : TEST EAX,EAX
009131e8 : JZ 0x00913303
009131ee : MOVZX ECX,byte ptr [EDI + 0x40]
009131f2 : MOV byte ptr [EBP + -0x10],CL
009131f5 : MOV ECX,dword ptr [EAX + 0xac]
009131fb : MOV EDX,dword ptr [ECX]
009131fd : MOV EBX,dword ptr [EBP + -0x10]
00913200 : MOV ESI,EAX
00913202 : MOV EAX,dword ptr [EDX + 0x2d8]
00913208 : PUSH EBX
00913209 : CALL EAX
0091320b : PUSH 0x1
0091320d : PUSH EBX
0091320e : CALL 0x00a1a2c0
00913213 : MOVZX ECX,byte ptr [EDI + 0x41]
00913217 : MOV byte ptr [EBP + -0x10],CL
0091321a : MOV EDX,dword ptr [EBP + -0x10]
0091321d : MOV ECX,dword ptr [0x00da93ec]
00913223 : PUSH EDX
00913224 : CALL 0x00a1a520
00913229 : MOVZX EAX,byte ptr [EDI + 0x42]
0091322d : MOV byte ptr [EBP + -0x10],AL
00913230 : MOV ECX,dword ptr [EBP + -0x10]
00913233 : PUSH ECX
00913234 : MOV ECX,dword ptr [0x00da93ec]
0091323a : CALL 0x00a1a460
0091323f : MOV DL,byte ptr [EDI + 0x43]
00913242 : MOV ECX,dword ptr [0x00da93ec]
00913248 : MOV byte ptr [EBP + -0x10],DL
0091324b : MOV EAX,dword ptr [EBP + -0x10]
0091324e : PUSH EAX
0091324f : CALL 0x00a1a3a0
00913254 : MOVZX ECX,byte ptr [EDI + 0x58]
00913258 : MOV byte ptr [EBP + -0x10],CL
0091325b : MOV EDX,dword ptr [EBP + -0x10]
0091325e : MOV ECX,dword ptr [0x00da93ec]
00913264 : PUSH EDX
00913265 : CALL 0x00a1a1e0
0091326a : MOVZX EAX,byte ptr [EDI + 0x44]
0091326e : MOV byte ptr [EBP + -0x10],AL
00913271 : MOV EAX,[0x00da93ec]
00913276 : MOV EBX,EAX
00913278 : TEST EAX,EAX
0091327a : JZ 0x00913281
0091327c : ADD EAX,0x18
0091327f : JMP 0x00913283
00913281 : XOR EAX,EAX
00913283 : LEA ESI,[EAX + 0x4]
00913286 : PUSH ESI
00913287 : MOV dword ptr [EBP + -0x14],EAX
0091328a : CALL dword ptr [0x00b85118]
00913290 : MOV dword ptr [EBP + -0x4],0x0
00913297 : MOV ECX,dword ptr [EBX + 0xac]
0091329d : MOV EDX,dword ptr [ECX]
0091329f : MOV EAX,dword ptr [EBP + -0x10]
009132a2 : MOV EDX,dword ptr [EDX + 0x2dc]
009132a8 : PUSH EAX
009132a9 : CALL EDX
009132ab : MOV dword ptr [EBP + -0x4],0xffffffff
009132b2 : PUSH ESI
009132b3 : CALL dword ptr [0x00b8511c]
009132b9 : MOVZX EAX,byte ptr [EDI + 0x45]
009132bd : MOV ECX,dword ptr [0x00da93ec]
009132c3 : PUSH 0x0
009132c5 : PUSH EAX
009132c6 : PUSH 0x1
009132c8 : CALL 0x00a1a060
009132cd : MOVZX ECX,byte ptr [EDI + 0x46]
009132d1 : PUSH 0x0
009132d3 : PUSH ECX
009132d4 : MOV ECX,dword ptr [0x00da93ec]
009132da : PUSH 0x2
009132dc : CALL 0x00a1a060
009132e1 : MOVZX EDX,byte ptr [EDI + 0x47]
009132e5 : MOV ECX,dword ptr [0x00da93ec]
009132eb : PUSH 0x0
009132ed : PUSH EDX
009132ee : PUSH 0x3
009132f0 : CALL 0x00a1a060
009132f5 : CMP dword ptr [0x017248cc],0x0
009132fc : JZ 0x00913303
009132fe : CALL 0x00a28ee0
00913303 : MOV ECX,dword ptr [EBP + -0xc]
00913306 : MOV dword ptr FS:[0x0],ECX
0091330d : POP ECX
0091330e : POP ESI
0091330f : POP EBX
00913310 : MOV ESP,EBP
00913312 : POP EBP
00913313 : RET

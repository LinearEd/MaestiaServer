PROGRAM  : Maestia.exe
FUNCTION : FUN_007db6c0
ENTRY    : 007db6c0
BODY     : [[007db6c0, 007db73b] [007db740, 007db86c]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007db6c0(int param_1)

{
  ushort uVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  int *in_ECX;
  uint uVar7;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4c03b;
  local_10 = ExceptionList;
  uVar5 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(char *)((int)in_ECX + 0x2be) == '\0') {
    if (in_ECX[2] != 0) {
      EnterCriticalSection((LPCRITICAL_SECTION)(in_ECX[2] + 4));
    }
    local_8 = 0;
    if (in_ECX[99] != 0) {
      puVar2 = (undefined4 *)in_ECX[0x62];
      for (puVar3 = (undefined4 *)*puVar2; puVar3 != puVar2; puVar3 = (undefined4 *)*puVar3) {
        iVar6 = (**(code **)(*(int *)puVar3[9] + 4))(uVar5);
        if ((((iVar6 == 2) && (iVar6 = puVar3[9], *(int *)(iVar6 + 0x1d0) == param_1)) &&
            ((*(int *)(iVar6 + 0x1e8) == 0 || (*(short *)(*(int *)(iVar6 + 0x1e8) + 0xe4) != 0))))
           && (uVar1 = *(ushort *)(iVar6 + 0x1e4), uVar1 != 0)) {
          uVar7 = 0;
          do {
            iVar4 = *(int *)(*(int *)(iVar6 + 0x1d8) + (uVar7 & 0xffff) * 4);
            if (iVar4 != 0) {
              FUN_0078f730(iVar4);
              if (*(int *)(iVar4 + 0x1c) == 0) {
                FUN_0078f630(iVar4);
              }
              if (*(int *)(iVar4 + 0x2c) == 0) {
                FUN_0078f430(iVar4);
              }
              if (*(int *)(iVar4 + 0x44) == 0) {
                FUN_0078f130(iVar4);
              }
            }
            uVar7 = uVar7 + 1;
          } while ((int)uVar7 < (int)(uint)uVar1);
        }
      }
    }
    iVar6 = (**(code **)(*in_ECX + 0x44))();
    if (iVar6 == 0) {
      iVar6 = in_ECX[2];
    }
    else {
      puVar2 = (undefined4 *)in_ECX[0xe];
      for (puVar3 = (undefined4 *)*puVar2; puVar3 != puVar2; puVar3 = (undefined4 *)*puVar3) {
        if (((int *)puVar3[9] != (int *)0x0) &&
           (iVar6 = (**(code **)(*(int *)puVar3[9] + 0x1c))(), iVar6 == 2)) {
          FUN_007db6c0(param_1);
        }
      }
      iVar6 = in_ECX[2];
    }
    local_8 = 0xffffffff;
    if (iVar6 != 0) {
      LeaveCriticalSection((LPCRITICAL_SECTION)(iVar6 + 4));
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
007db6c0 : PUSH EBP
007db6c1 : MOV EBP,ESP
007db6c3 : PUSH -0x1
007db6c5 : PUSH 0xb4c03b
007db6ca : MOV EAX,FS:[0x0]
007db6d0 : PUSH EAX
007db6d1 : SUB ESP,0x18
007db6d4 : PUSH EBX
007db6d5 : PUSH ESI
007db6d6 : PUSH EDI
007db6d7 : MOV EAX,[0x00d66fa0]
007db6dc : XOR EAX,EBP
007db6de : PUSH EAX
007db6df : LEA EAX,[EBP + -0xc]
007db6e2 : MOV FS:[0x0],EAX
007db6e8 : MOV EDI,ECX
007db6ea : MOV dword ptr [EBP + -0x14],EDI
007db6ed : MOV AL,byte ptr [EDI + 0x2be]
007db6f3 : TEST AL,AL
007db6f5 : JNZ 0x007db859
007db6fb : MOV EAX,dword ptr [EDI + 0x8]
007db6fe : MOV dword ptr [EBP + -0x20],EDI
007db701 : TEST EAX,EAX
007db703 : JZ 0x007db70f
007db705 : ADD EAX,0x4
007db708 : PUSH EAX
007db709 : CALL dword ptr [0x00b85118]
007db70f : MOV dword ptr [EBP + -0x4],0x0
007db716 : MOV EAX,dword ptr [EDI + 0x18c]
007db71c : TEST EAX,EAX
007db71e : JBE 0x007db7f6
007db724 : MOV EAX,dword ptr [EDI + 0x188]
007db72a : MOV ESI,dword ptr [EAX]
007db72c : MOV dword ptr [EBP + -0x1c],EAX
007db72f : MOV dword ptr [EBP + -0x10],ESI
007db732 : CMP ESI,EAX
007db734 : JZ 0x007db7f6
007db73a : JMP 0x007db743
007db740 : MOV ESI,dword ptr [EBP + -0x10]
007db743 : MOV ECX,dword ptr [ESI + 0x24]
007db746 : MOV EAX,dword ptr [ECX]
007db748 : MOV EDX,dword ptr [EAX + 0x4]
007db74b : CALL EDX
007db74d : CMP EAX,0x2
007db750 : JNZ 0x007db7e8
007db756 : MOV EBX,dword ptr [ESI + 0x24]
007db759 : MOV EAX,dword ptr [EBP + 0x8]
007db75c : CMP dword ptr [EBX + 0x1d0],EAX
007db762 : JNZ 0x007db7e8
007db768 : MOV EAX,dword ptr [EBX + 0x1e8]
007db76e : TEST EAX,EAX
007db770 : JZ 0x007db77e
007db772 : MOVZX EAX,word ptr [EAX + 0xe4]
007db779 : TEST AX,AX
007db77c : JZ 0x007db7e8
007db77e : MOVZX EAX,word ptr [EBX + 0x1e4]
007db785 : XOR EDI,EDI
007db787 : MOV dword ptr [EBP + -0x18],EAX
007db78a : TEST EAX,EAX
007db78c : JLE 0x007db7e5
007db78e : MOV EDI,EDI
007db790 : MOV EDX,dword ptr [EBX + 0x1d8]
007db796 : MOVZX ECX,DI
007db799 : MOV ESI,dword ptr [EDX + ECX*0x4]
007db79c : TEST ESI,ESI
007db79e : JZ 0x007db7dc
007db7a0 : LEA ECX,[ESI + 0x48]
007db7a3 : PUSH ESI
007db7a4 : CALL 0x0078f730
007db7a9 : CMP dword ptr [ESI + 0x1c],0x0
007db7ad : JNZ 0x007db7b8
007db7af : LEA ECX,[ESI + 0x64]
007db7b2 : PUSH ESI
007db7b3 : CALL 0x0078f630
007db7b8 : CMP dword ptr [ESI + 0x2c],0x0
007db7bc : JNZ 0x007db7ca
007db7be : LEA ECX,[ESI + 0x80]
007db7c4 : PUSH ESI
007db7c5 : CALL 0x0078f430
007db7ca : CMP dword ptr [ESI + 0x44],0x0
007db7ce : JNZ 0x007db7dc
007db7d0 : LEA ECX,[ESI + 0x9c]
007db7d6 : PUSH ESI
007db7d7 : CALL 0x0078f130
007db7dc : INC EDI
007db7dd : CMP EDI,dword ptr [EBP + -0x18]
007db7e0 : JL 0x007db790
007db7e2 : MOV ESI,dword ptr [EBP + -0x10]
007db7e5 : MOV EDI,dword ptr [EBP + -0x14]
007db7e8 : MOV EAX,dword ptr [ESI]
007db7ea : MOV dword ptr [EBP + -0x10],EAX
007db7ed : CMP EAX,dword ptr [EBP + -0x1c]
007db7f0 : JNZ 0x007db740
007db7f6 : MOV EAX,dword ptr [EDI]
007db7f8 : MOV EDX,dword ptr [EAX + 0x44]
007db7fb : MOV ECX,EDI
007db7fd : CALL EDX
007db7ff : TEST EAX,EAX
007db801 : JNZ 0x007db80f
007db803 : MOV dword ptr [EBP + -0x4],0xffffffff
007db80a : MOV EAX,dword ptr [EDI + 0x8]
007db80d : JMP 0x007db84b
007db80f : MOV EDI,dword ptr [EDI + 0x38]
007db812 : MOV EBX,dword ptr [EDI]
007db814 : CMP EBX,EDI
007db816 : JZ 0x007db83e
007db818 : MOV ESI,dword ptr [EBX + 0x24]
007db81b : TEST ESI,ESI
007db81d : JZ 0x007db838
007db81f : MOV EAX,dword ptr [ESI]
007db821 : MOV EDX,dword ptr [EAX + 0x1c]
007db824 : MOV ECX,ESI
007db826 : CALL EDX
007db828 : CMP EAX,0x2
007db82b : JNZ 0x007db838
007db82d : MOV EAX,dword ptr [EBP + 0x8]
007db830 : PUSH EAX
007db831 : MOV ECX,ESI
007db833 : CALL 0x007db6c0
007db838 : MOV EBX,dword ptr [EBX]
007db83a : CMP EBX,EDI
007db83c : JNZ 0x007db818
007db83e : MOV dword ptr [EBP + -0x4],0xffffffff
007db845 : MOV ECX,dword ptr [EBP + -0x14]
007db848 : MOV EAX,dword ptr [ECX + 0x8]
007db84b : TEST EAX,EAX
007db84d : JZ 0x007db859
007db84f : ADD EAX,0x4
007db852 : PUSH EAX
007db853 : CALL dword ptr [0x00b8511c]
007db859 : MOV ECX,dword ptr [EBP + -0xc]
007db85c : MOV dword ptr FS:[0x0],ECX
007db863 : POP ECX
007db864 : POP EDI
007db865 : POP ESI
007db866 : POP EBX
007db867 : MOV ESP,EBP
007db869 : POP EBP
007db86a : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_00807d70
ENTRY    : 00807d70
BODY     : [[00807d70, 00807e6b]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_00807d70(char *param_1)

{
  uint uVar1;
  void *pvStack_118;
  void *pvStack_114;
  char local_110 [255];
  undefined1 local_11;
  uint local_10;
  void *local_c;
  undefined1 *puStack_8;
  undefined4 uStack_4;
  
  uStack_4 = 0xffffffff;
  puStack_8 = &LAB_00b43958;
  local_c = ExceptionList;
  local_10 = DAT_00d66fa0 ^ (uint)&pvStack_118;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffee4;
  ExceptionList = &local_c;
  __vsnprintf(local_110,0xff,param_1,&stack0x00000008);
  local_11 = 0;
  if (DAT_00da98d4 == 0) {
    if (DAT_00da98c8 == (int *)0x0) {
      pvStack_118 = _malloc(0x2c);
    }
    else {
      pvStack_118 = (void *)(**(code **)(*DAT_00da98c8 + 4))(0x2c,uVar1);
    }
    if (pvStack_118 == (void *)0x0) {
      pvStack_118 = (void *)0x0;
    }
    else {
      _DAT_00da98cc = _DAT_00da98cc + 0x2c;
      _DAT_00da98d0 = _DAT_00da98d0 + 1;
    }
    uStack_4 = 0;
    pvStack_114 = pvStack_118;
    if (pvStack_118 == (void *)0x0) {
      DAT_00da98d4 = 0;
    }
    else {
      DAT_00da98d4 = FUN_00b03890(pvStack_118);
    }
    uStack_4 = 0xffffffff;
  }
  FUN_00b03910();
  ExceptionList = local_c;
  __security_check_cookie(local_10 ^ (uint)&pvStack_118);
  return;
}



============================================================
DISASSEMBLY
============================================================
00807d70 : PUSH -0x1
00807d72 : PUSH 0xb43958
00807d77 : MOV EAX,FS:[0x0]
00807d7d : PUSH EAX
00807d7e : SUB ESP,0x10c
00807d84 : MOV EAX,[0x00d66fa0]
00807d89 : XOR EAX,ESP
00807d8b : MOV dword ptr [ESP + 0x108],EAX
00807d92 : PUSH EDI
00807d93 : MOV EAX,[0x00d66fa0]
00807d98 : XOR EAX,ESP
00807d9a : PUSH EAX
00807d9b : LEA EAX,[ESP + 0x114]
00807da2 : MOV FS:[0x0],EAX
00807da8 : MOV ECX,dword ptr [ESP + 0x124]
00807daf : LEA EAX,[ESP + 0x128]
00807db6 : PUSH EAX
00807db7 : PUSH ECX
00807db8 : LEA EDX,[ESP + 0x18]
00807dbc : PUSH 0xff
00807dc1 : PUSH EDX
00807dc2 : CALL 0x00639450
00807dc7 : ADD ESP,0x10
00807dca : CMP dword ptr [0x00da98d4],0x0
00807dd1 : MOV byte ptr [ESP + 0x10f],0x0
00807dd9 : JNZ 0x00807e3e
00807ddb : MOV ECX,dword ptr [0x00da98c8]
00807de1 : PUSH 0x2c
00807de3 : TEST ECX,ECX
00807de5 : JZ 0x00807df0
00807de7 : MOV EAX,dword ptr [ECX]
00807de9 : MOV EDX,dword ptr [EAX + 0x4]
00807dec : CALL EDX
00807dee : JMP 0x00807df8
00807df0 : CALL 0x00636043
00807df5 : ADD ESP,0x4
00807df8 : TEST EAX,EAX
00807dfa : JZ 0x00807e0b
00807dfc : ADD dword ptr [0x00da98cc],0x2c
00807e03 : INC dword ptr [0x00da98d0]
00807e09 : JMP 0x00807e0d
00807e0b : XOR EAX,EAX
00807e0d : MOV dword ptr [ESP + 0x8],EAX
00807e11 : MOV dword ptr [ESP + 0xc],EAX
00807e15 : MOV dword ptr [ESP + 0x11c],0x0
00807e20 : TEST EAX,EAX
00807e22 : JZ 0x00807e2c
00807e24 : PUSH EAX
00807e25 : CALL 0x00b03890
00807e2a : JMP 0x00807e2e
00807e2c : XOR EAX,EAX
00807e2e : MOV dword ptr [ESP + 0x11c],0xffffffff
00807e39 : MOV [0x00da98d4],EAX
00807e3e : LEA EDI,[ESP + 0x10]
00807e42 : CALL 0x00b03910
00807e47 : MOV ECX,dword ptr [ESP + 0x114]
00807e4e : MOV dword ptr FS:[0x0],ECX
00807e55 : POP ECX
00807e56 : POP EDI
00807e57 : MOV ECX,dword ptr [ESP + 0x108]
00807e5e : XOR ECX,ESP
00807e60 : CALL 0x00633e6b
00807e65 : ADD ESP,0x118
00807e6b : RET

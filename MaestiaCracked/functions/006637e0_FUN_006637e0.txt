PROGRAM  : Maestia.exe
FUNCTION : FUN_006637e0
ENTRY    : 006637e0
BODY     : [[006637e0, 0066388a]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_006637e0(int param_1,int *param_2)

{
  int iVar1;
  undefined4 uVar2;
  void *local_c;
  undefined1 *puStack_8;
  undefined4 uStack_4;
  
  uStack_4 = 0xffffffff;
  puStack_8 = &LAB_00b0c77b;
  local_c = ExceptionList;
  uVar2 = 0;
  if (param_2 == (int *)0x0) {
    return 0x80004003;
  }
  ExceptionList = &local_c;
  iVar1 = (**(code **)(**(int **)(param_1 + 0xc) + 0x14))(DAT_00d66fa0 ^ (uint)&stack0xffffffe8);
  if (iVar1 == *(int *)(param_1 + 0x10)) {
    iVar1 = FUN_006f0300(0x30);
    uStack_4 = 0;
    if (iVar1 == 0) {
      iVar1 = 0;
    }
    else {
      iVar1 = FUN_006636f0(*(undefined4 *)(param_1 + 0xc),param_1);
    }
    *param_2 = iVar1;
    if (iVar1 == 0) {
      uVar2 = 0x8007000e;
    }
  }
  else {
    *param_2 = 0;
    uVar2 = 0x80040203;
  }
  ExceptionList = local_c;
  return uVar2;
}



============================================================
DISASSEMBLY
============================================================
006637e0 : PUSH -0x1
006637e2 : PUSH 0xb0c77b
006637e7 : MOV EAX,FS:[0x0]
006637ed : PUSH EAX
006637ee : PUSH EBX
006637ef : PUSH ESI
006637f0 : PUSH EDI
006637f1 : MOV EAX,[0x00d66fa0]
006637f6 : XOR EAX,ESP
006637f8 : PUSH EAX
006637f9 : LEA EAX,[ESP + 0x10]
006637fd : MOV FS:[0x0],EAX
00663803 : MOV EBX,dword ptr [ESP + 0x24]
00663807 : XOR EDI,EDI
00663809 : CMP EBX,EDI
0066380b : JNZ 0x00663827
0066380d : MOV EAX,0x80004003
00663812 : MOV ECX,dword ptr [ESP + 0x10]
00663816 : MOV dword ptr FS:[0x0],ECX
0066381d : POP ECX
0066381e : POP EDI
0066381f : POP ESI
00663820 : POP EBX
00663821 : ADD ESP,0xc
00663824 : RET 0x8
00663827 : MOV ESI,dword ptr [ESP + 0x20]
0066382b : MOV ECX,dword ptr [ESI + 0xc]
0066382e : MOV EAX,dword ptr [ECX]
00663830 : MOV EDX,dword ptr [EAX + 0x14]
00663833 : CALL EDX
00663835 : CMP EAX,dword ptr [ESI + 0x10]
00663838 : JZ 0x00663843
0066383a : MOV dword ptr [EBX],EDI
0066383c : MOV EDI,0x80040203
00663841 : JMP 0x00663874
00663843 : PUSH 0x30
00663845 : CALL 0x006f0300
0066384a : ADD ESP,0x4
0066384d : MOV dword ptr [ESP + 0x24],EAX
00663851 : MOV dword ptr [ESP + 0x18],EDI
00663855 : CMP EAX,EDI
00663857 : JZ 0x00663867
00663859 : MOV ECX,dword ptr [ESI + 0xc]
0066385c : PUSH ESI
0066385d : PUSH ECX
0066385e : MOV ECX,EAX
00663860 : CALL 0x006636f0
00663865 : JMP 0x00663869
00663867 : XOR EAX,EAX
00663869 : MOV dword ptr [EBX],EAX
0066386b : CMP EAX,EDI
0066386d : JNZ 0x00663874
0066386f : MOV EDI,0x8007000e
00663874 : MOV EAX,EDI
00663876 : MOV ECX,dword ptr [ESP + 0x10]
0066387a : MOV dword ptr FS:[0x0],ECX
00663881 : POP ECX
00663882 : POP EDI
00663883 : POP ESI
00663884 : POP EBX
00663885 : ADD ESP,0xc
00663888 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_0081b3a0
ENTRY    : 0081b3a0
BODY     : [[0081b3a0, 0081b564]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0081b3a0(int param_1)

{
  char cVar1;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  int in_ECX;
  int in_EDX;
  int unaff_ESI;
  uint local_5c;
  undefined1 local_58 [4];
  undefined2 local_54;
  undefined4 local_44;
  uint local_40;
  undefined1 local_30 [4];
  undefined2 local_2c;
  int local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4d87b;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_14 = uVar2;
  if ((param_1 == 0) || (*(int *)(in_EDX + 0x14) == 0)) {
    *(undefined4 *)(unaff_ESI + 0x18) = 7;
    *(undefined4 *)(unaff_ESI + 0x14) = 0;
    *(undefined2 *)(unaff_ESI + 4) = 0;
    FUN_00405eb0(in_EDX,0,0xffffffff);
    local_8 = 0;
  }
  else {
    local_18 = 7;
    local_1c = 0;
    local_2c = 0;
    local_8 = 1;
    cVar1 = FUN_0081a1e0(in_EDX,param_1,1,local_30,0);
    if (cVar1 != '\0') {
      cVar1 = FUN_008123d0(uVar2);
      if (cVar1 == '\0') {
        if (local_1c != 0) {
          FUN_0070cac0();
        }
        FUN_00405660(local_30);
        local_8 = local_8 & 0xffffff00;
        FUN_00406560();
        goto LAB_0081b546;
      }
    }
    if (*(char *)(in_ECX + 0x1c4) != '\0') {
      if (*(uint *)(in_EDX + 0x18) < 8) {
        iVar3 = in_EDX + 4;
      }
      else {
        iVar3 = *(int *)(in_EDX + 4);
      }
      FUN_00483f90(iVar3);
    }
    FUN_00406460(L"[NotTrans]");
    local_8._0_1_ = 2;
    uVar4 = FUN_00403450(local_58);
    local_8._0_1_ = 3;
    FUN_00405eb0(uVar4,0,0xffffffff);
    local_8 = CONCAT31(local_8._1_3_,2);
    if (7 < local_40) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_40 = 7;
    local_44 = 0;
    local_54 = 0;
    local_8._0_1_ = 1;
    if (7 < local_5c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    *(undefined4 *)(unaff_ESI + 0x18) = 7;
    *(undefined4 *)(unaff_ESI + 0x14) = 0;
    *(undefined2 *)(unaff_ESI + 4) = 0;
    FUN_00405eb0(local_30,0,0xffffffff);
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c = 0;
  }
LAB_0081b546:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0081b3a0 : PUSH EBP
0081b3a1 : MOV EBP,ESP
0081b3a3 : PUSH -0x1
0081b3a5 : PUSH 0xb4d87b
0081b3aa : MOV EAX,FS:[0x0]
0081b3b0 : PUSH EAX
0081b3b1 : SUB ESP,0x64
0081b3b4 : MOV EAX,[0x00d66fa0]
0081b3b9 : XOR EAX,EBP
0081b3bb : MOV dword ptr [EBP + -0x10],EAX
0081b3be : PUSH EBX
0081b3bf : PUSH EDI
0081b3c0 : PUSH EAX
0081b3c1 : LEA EAX,[EBP + -0xc]
0081b3c4 : MOV FS:[0x0],EAX
0081b3ca : MOV EAX,dword ptr [EBP + 0x8]
0081b3cd : XOR EBX,EBX
0081b3cf : MOV dword ptr [EBP + -0x34],ECX
0081b3d2 : MOV dword ptr [EBP + -0x38],ESI
0081b3d5 : MOV EDI,EDX
0081b3d7 : MOV dword ptr [EBP + -0x30],EBX
0081b3da : CMP EAX,EBX
0081b3dc : JZ 0x0081b521
0081b3e2 : CMP dword ptr [EDI + 0x14],EBX
0081b3e5 : JZ 0x0081b521
0081b3eb : XOR EDX,EDX
0081b3ed : MOV dword ptr [EBP + -0x14],0x7
0081b3f4 : MOV dword ptr [EBP + -0x18],EBX
0081b3f7 : MOV word ptr [EBP + -0x28],DX
0081b3fb : MOV dword ptr [EBP + -0x4],0x1
0081b402 : PUSH EBX
0081b403 : LEA EDX,[EBP + -0x2c]
0081b406 : PUSH EDX
0081b407 : PUSH 0x1
0081b409 : PUSH EAX
0081b40a : PUSH EDI
0081b40b : CALL 0x0081a1e0
0081b410 : TEST AL,AL
0081b412 : JZ 0x0081b44e
0081b414 : LEA EDX,[EBP + -0x2c]
0081b417 : CALL 0x008123d0
0081b41c : TEST AL,AL
0081b41e : JNZ 0x0081b44e
0081b420 : CMP dword ptr [EBP + -0x18],EBX
0081b423 : JZ 0x0081b42c
0081b425 : MOV ECX,EDX
0081b427 : CALL 0x0070cac0
0081b42c : LEA EAX,[EBP + -0x2c]
0081b42f : PUSH EAX
0081b430 : MOV ECX,ESI
0081b432 : CALL 0x00405660
0081b437 : MOV dword ptr [EBP + -0x30],0x1
0081b43e : MOV byte ptr [EBP + -0x4],BL
0081b441 : LEA ECX,[EBP + -0x2c]
0081b444 : CALL 0x00406560
0081b449 : JMP 0x0081b546
0081b44e : MOV ECX,dword ptr [EBP + -0x34]
0081b451 : CMP byte ptr [ECX + 0x1c4],BL
0081b457 : JZ 0x0081b470
0081b459 : CMP dword ptr [EDI + 0x18],0x8
0081b45d : JC 0x0081b464
0081b45f : MOV EAX,dword ptr [EDI + 0x4]
0081b462 : JMP 0x0081b467
0081b464 : LEA EAX,[EDI + 0x4]
0081b467 : PUSH EAX
0081b468 : CALL 0x00483f90
0081b46d : ADD ESP,0x4
0081b470 : PUSH 0xc2e264
0081b475 : LEA ECX,[EBP + -0x70]
0081b478 : CALL 0x00406460
0081b47d : MOV byte ptr [EBP + -0x4],0x2
0081b481 : LEA EDX,[EBP + -0x54]
0081b484 : PUSH EDI
0081b485 : PUSH EDX
0081b486 : MOV ECX,EAX
0081b488 : CALL 0x00403450
0081b48d : ADD ESP,0x8
0081b490 : MOV byte ptr [EBP + -0x4],0x3
0081b494 : PUSH -0x1
0081b496 : PUSH EBX
0081b497 : PUSH EAX
0081b498 : LEA ECX,[EBP + -0x2c]
0081b49b : CALL 0x00405eb0
0081b4a0 : MOV byte ptr [EBP + -0x4],0x2
0081b4a4 : CMP dword ptr [EBP + -0x3c],0x8
0081b4a8 : JC 0x0081b4b2
0081b4aa : MOV ECX,dword ptr [EBP + -0x50]
0081b4ad : CALL 0x006f04e0
0081b4b2 : MOV EDI,0x7
0081b4b7 : XOR EAX,EAX
0081b4b9 : MOV dword ptr [EBP + -0x3c],EDI
0081b4bc : MOV dword ptr [EBP + -0x40],EBX
0081b4bf : MOV word ptr [EBP + -0x50],AX
0081b4c3 : MOV byte ptr [EBP + -0x4],0x1
0081b4c7 : CMP dword ptr [EBP + -0x58],0x8
0081b4cb : JC 0x0081b4d5
0081b4cd : MOV ECX,dword ptr [EBP + -0x6c]
0081b4d0 : CALL 0x006f04e0
0081b4d5 : PUSH -0x1
0081b4d7 : XOR ECX,ECX
0081b4d9 : PUSH EBX
0081b4da : LEA EAX,[EBP + -0x2c]
0081b4dd : MOV word ptr [EBP + -0x6c],CX
0081b4e1 : XOR EDX,EDX
0081b4e3 : MOV dword ptr [ESI + 0x18],EDI
0081b4e6 : MOV dword ptr [ESI + 0x14],EBX
0081b4e9 : PUSH EAX
0081b4ea : MOV ECX,ESI
0081b4ec : MOV dword ptr [EBP + -0x58],EDI
0081b4ef : MOV dword ptr [EBP + -0x5c],EBX
0081b4f2 : MOV word ptr [ESI + 0x4],DX
0081b4f6 : CALL 0x00405eb0
0081b4fb : MOV dword ptr [EBP + -0x30],0x1
0081b502 : MOV byte ptr [EBP + -0x4],BL
0081b505 : CMP dword ptr [EBP + -0x14],0x8
0081b509 : JC 0x0081b513
0081b50b : MOV ECX,dword ptr [EBP + -0x28]
0081b50e : CALL 0x006f04e0
0081b513 : XOR ECX,ECX
0081b515 : MOV dword ptr [EBP + -0x14],EDI
0081b518 : MOV dword ptr [EBP + -0x18],EBX
0081b51b : MOV word ptr [EBP + -0x28],CX
0081b51f : JMP 0x0081b546
0081b521 : PUSH -0x1
0081b523 : PUSH EBX
0081b524 : XOR EDX,EDX
0081b526 : MOV dword ptr [ESI + 0x18],0x7
0081b52d : MOV dword ptr [ESI + 0x14],EBX
0081b530 : PUSH EDI
0081b531 : MOV ECX,ESI
0081b533 : MOV word ptr [ESI + 0x4],DX
0081b537 : CALL 0x00405eb0
0081b53c : MOV dword ptr [EBP + -0x4],EBX
0081b53f : MOV dword ptr [EBP + -0x30],0x1
0081b546 : MOV EAX,ESI
0081b548 : MOV ECX,dword ptr [EBP + -0xc]
0081b54b : MOV dword ptr FS:[0x0],ECX
0081b552 : POP ECX
0081b553 : POP EDI
0081b554 : POP EBX
0081b555 : MOV ECX,dword ptr [EBP + -0x10]
0081b558 : XOR ECX,EBP
0081b55a : CALL 0x00633e6b
0081b55f : MOV ESP,EBP
0081b561 : POP EBP
0081b562 : RET 0x4

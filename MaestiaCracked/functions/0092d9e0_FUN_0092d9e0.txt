PROGRAM  : Maestia.exe
FUNCTION : FUN_0092d9e0
ENTRY    : 0092d9e0
BODY     : [[0092d9e0, 0092dc58]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0092d9e0(int param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  bool bVar2;
  uint uVar3;
  int iVar4;
  int *in_ECX;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4c95e;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar4 = (**(code **)(*in_ECX + 0x98))();
  if (param_1 == 0) {
    FUN_008018d0();
  }
  else if ((iVar4 != 0) && (iVar1 = *(int *)(param_1 + 0x24), iVar1 != 0)) {
    FUN_00908f50();
    *(int *)(iVar4 + 8) = iVar1;
    FUN_00405eb0();
    if (*(char *)(iVar1 + 0x28) != '\0') {
      FUN_009eddb0();
      *(undefined1 *)(iVar1 + 0x28) = 0;
    }
    bVar2 = (ushort)*(undefined4 *)(iVar1 + 0x30) < 2;
    if (bVar2) {
      FUN_00406460();
    }
    else {
      FUN_00404750();
    }
    local_8 = (uint)bVar2;
    FUN_00405660();
    local_8 = 3;
    if (bVar2) {
      FUN_00406560();
    }
    local_8._0_1_ = 4;
    if (!bVar2) {
      FUN_00406560();
    }
    FUN_009ecaa0();
    (**(code **)(*in_ECX + 0x44))();
    (**(code **)(*in_ECX + 0x4c))(*(undefined4 *)(iVar1 + 0x1c),param_3);
    (**(code **)(*in_ECX + 0x48))(iVar1 + 0x38,param_3,0);
    (**(code **)(*in_ECX + 0x50))
              (param_3,0,*(undefined4 *)(param_1 + 0x10),*(undefined1 *)(iVar1 + 0xb1));
    FUN_00405660(param_2);
    local_8._0_1_ = 4;
    FUN_008f75f0();
    local_8._0_1_ = 6;
    iVar4 = *DAT_00da9894;
    if ((iVar4 != 0) && (*(int *)(iVar4 + 0x114) != 0)) {
      (**(code **)(**(int **)(iVar4 + 0x114) + 4))(*(int **)(iVar4 + 0x114));
    }
    FUN_009eb990();
    local_8 = CONCAT31(local_8._1_3_,4);
    FUN_00406560();
    local_8 = 0xffffffff;
    FUN_00406560();
  }
  ExceptionList = local_10;
  __security_check_cookie(uVar3 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0092d9e0 : PUSH EBP
0092d9e1 : MOV EBP,ESP
0092d9e3 : PUSH -0x1
0092d9e5 : PUSH 0xb4c95e
0092d9ea : MOV EAX,FS:[0x0]
0092d9f0 : PUSH EAX
0092d9f1 : SUB ESP,0x88
0092d9f7 : MOV EAX,[0x00d66fa0]
0092d9fc : XOR EAX,EBP
0092d9fe : MOV dword ptr [EBP + -0x10],EAX
0092da01 : PUSH EBX
0092da02 : PUSH ESI
0092da03 : PUSH EDI
0092da04 : PUSH EAX
0092da05 : LEA EAX,[EBP + -0xc]
0092da08 : MOV FS:[0x0],EAX
0092da0e : MOV EAX,dword ptr [EBP + 0xc]
0092da11 : MOV EDI,dword ptr [EBP + 0x8]
0092da14 : MOV EBX,ECX
0092da16 : MOV dword ptr [EBP + -0x4c],0x0
0092da1d : MOV EDX,dword ptr [EBX]
0092da1f : MOV EDX,dword ptr [EDX + 0x98]
0092da25 : MOV dword ptr [EBP + -0x50],EAX
0092da28 : MOV EAX,dword ptr [EBP + 0x10]
0092da2b : PUSH EAX
0092da2c : MOV dword ptr [EBP + -0x58],EDI
0092da2f : CALL EDX
0092da31 : MOV ESI,EAX
0092da33 : MOV dword ptr [EBP + -0x54],ESI
0092da36 : TEST EDI,EDI
0092da38 : JNZ 0x0092da52
0092da3a : MOV ESI,dword ptr [0x00da98e8]
0092da40 : PUSH 0xc6d4e0
0092da45 : CALL 0x008018d0
0092da4a : ADD ESP,0x4
0092da4d : JMP 0x0092dc3b
0092da52 : TEST ESI,ESI
0092da54 : JZ 0x0092dc3b
0092da5a : MOV EDI,dword ptr [EDI + 0x24]
0092da5d : TEST EDI,EDI
0092da5f : JZ 0x0092dc3b
0092da65 : MOV ECX,ESI
0092da67 : CALL 0x00908f50
0092da6c : MOV EAX,dword ptr [EBP + -0x50]
0092da6f : PUSH -0x1
0092da71 : PUSH 0x0
0092da73 : PUSH EAX
0092da74 : LEA ECX,[ESI + 0x20]
0092da77 : MOV dword ptr [ESI + 0x8],EDI
0092da7a : CALL 0x00405eb0
0092da7f : CMP byte ptr [EDI + 0x28],0x0
0092da83 : JZ 0x0092da8f
0092da85 : PUSH EDI
0092da86 : CALL 0x009eddb0
0092da8b : MOV byte ptr [EDI + 0x28],0x0
0092da8f : MOV EAX,dword ptr [EDI + 0x30]
0092da92 : MOV dword ptr [EBP + -0x5c],EAX
0092da95 : CMP AX,0x1
0092da99 : JBE 0x0092dac5
0092da9b : MOVZX ECX,AX
0092da9e : PUSH ECX
0092da9f : PUSH 0xc6d544
0092daa4 : LEA ESI,[EBP + 0xffffff6c]
0092daaa : CALL 0x00404750
0092daaf : ADD ESP,0x8
0092dab2 : MOV dword ptr [EBP + -0x4],0x0
0092dab9 : MOV ESI,dword ptr [EBP + -0x54]
0092dabc : MOV dword ptr [EBP + -0x4c],0x1
0092dac3 : JMP 0x0092dae0
0092dac5 : PUSH 0xc6d4dc
0092daca : LEA ECX,[EBP + -0x78]
0092dacd : CALL 0x00406460
0092dad2 : MOV dword ptr [EBP + -0x4],0x1
0092dad9 : MOV dword ptr [EBP + -0x4c],0x2
0092dae0 : PUSH EAX
0092dae1 : LEA ECX,[EBP + -0x48]
0092dae4 : CALL 0x00405660
0092dae9 : MOV dword ptr [EBP + -0x4],0x3
0092daf0 : TEST byte ptr [EBP + -0x4c],0x2
0092daf4 : JZ 0x0092db02
0092daf6 : AND dword ptr [EBP + -0x4c],0xfffffffd
0092dafa : LEA ECX,[EBP + -0x78]
0092dafd : CALL 0x00406560
0092db02 : MOV byte ptr [EBP + -0x4],0x4
0092db06 : TEST byte ptr [EBP + -0x4c],0x1
0092db0a : JZ 0x0092db1b
0092db0c : AND dword ptr [EBP + -0x4c],0xfffffffe
0092db10 : LEA ECX,[EBP + 0xffffff6c]
0092db16 : CALL 0x00406560
0092db1b : MOV EAX,dword ptr [EBP + 0x10]
0092db1e : PUSH ESI
0092db1f : CALL 0x009ecaa0
0092db24 : MOV EDX,dword ptr [EBP + -0x58]
0092db27 : MOV EAX,dword ptr [EDX + 0x10]
0092db2a : MOV EDX,dword ptr [EBX]
0092db2c : MOV ESI,dword ptr [EBP + 0x10]
0092db2f : MOV EDX,dword ptr [EDX + 0x44]
0092db32 : PUSH EAX
0092db33 : LEA EAX,[EBP + -0x48]
0092db36 : PUSH EAX
0092db37 : PUSH 0x0
0092db39 : PUSH ESI
0092db3a : MOV ECX,EBX
0092db3c : CALL EDX
0092db3e : MOV EAX,dword ptr [EDI + 0x20]
0092db41 : MOV ECX,dword ptr [EDI + 0x1c]
0092db44 : MOV EDX,dword ptr [EBX]
0092db46 : PUSH EAX
0092db47 : MOV EAX,dword ptr [EDX + 0x4c]
0092db4a : PUSH 0x1
0092db4c : PUSH 0x0
0092db4e : PUSH ESI
0092db4f : PUSH ECX
0092db50 : MOV ECX,EBX
0092db52 : CALL EAX
0092db54 : MOV EDX,dword ptr [EBX]
0092db56 : MOV EDX,dword ptr [EDX + 0x48]
0092db59 : PUSH 0x0
0092db5b : PUSH ESI
0092db5c : LEA EAX,[EDI + 0x38]
0092db5f : PUSH EAX
0092db60 : MOV ECX,EBX
0092db62 : CALL EDX
0092db64 : MOV AL,byte ptr [EDI + 0xb1]
0092db6a : MOV ECX,dword ptr [EBP + -0x58]
0092db6d : MOV EDX,dword ptr [EBX]
0092db6f : MOV EDX,dword ptr [EDX + 0x50]
0092db72 : MOV byte ptr [EBP + -0x54],AL
0092db75 : MOV EAX,dword ptr [ECX + 0x10]
0092db78 : MOV ECX,dword ptr [EBP + -0x54]
0092db7b : PUSH ECX
0092db7c : PUSH EAX
0092db7d : PUSH 0x0
0092db7f : PUSH ESI
0092db80 : MOV ECX,EBX
0092db82 : CALL EDX
0092db84 : MOV EAX,dword ptr [EBP + -0x50]
0092db87 : SUB ESP,0x1c
0092db8a : MOV ECX,ESP
0092db8c : MOV dword ptr [EBP + -0x54],ESP
0092db8f : PUSH EAX
0092db90 : CALL 0x00405660
0092db95 : MOV byte ptr [EBP + -0x4],0x5
0092db99 : MOV byte ptr [EBP + -0x4],0x4
0092db9d : LEA ECX,[EBP + -0x2c]
0092dba0 : CALL 0x008f75f0
0092dba5 : ADD ESP,0x1c
0092dba8 : MOV byte ptr [EBP + -0x4],0x6
0092dbac : MOV EAX,dword ptr [EDI + 0x18]
0092dbaf : TEST EAX,EAX
0092dbb1 : JL 0x0092dbc1
0092dbb3 : CMP EAX,0x1
0092dbb6 : JLE 0x0092dbbd
0092dbb8 : CMP EAX,0x3
0092dbbb : JNZ 0x0092dbc1
0092dbbd : MOV DL,0x1
0092dbbf : JMP 0x0092dbc3
0092dbc1 : XOR DL,DL
0092dbc3 : MOV ECX,dword ptr [0x00da9894]
0092dbc9 : MOV EAX,dword ptr [ECX]
0092dbcb : TEST EAX,EAX
0092dbcd : JZ 0x0092dc19
0092dbcf : CMP dword ptr [EAX + 0x114],0x0
0092dbd6 : JZ 0x0092dc19
0092dbd8 : CMP dword ptr [EBP + -0x14],0x8
0092dbdc : MOV EAX,dword ptr [EAX + 0x114]
0092dbe2 : MOV CL,byte ptr [EDI + 0xb1]
0092dbe8 : MOV EBX,dword ptr [EBP + -0x28]
0092dbeb : JNC 0x0092dbf0
0092dbed : LEA EBX,[EBP + -0x28]
0092dbf0 : MOVZX EDX,DL
0092dbf3 : PUSH EDX
0092dbf4 : MOVZX EDX,word ptr [EBP + -0x5c]
0092dbf8 : MOVZX ECX,CL
0092dbfb : PUSH ECX
0092dbfc : PUSH EDX
0092dbfd : MOVZX ECX,SI
0092dc00 : PUSH ECX
0092dc01 : MOV EDX,EBX
0092dc03 : MOV EBX,dword ptr [EAX]
0092dc05 : PUSH EDX
0092dc06 : PUSH 0xc6d54c
0092dc0b : PUSH 0xc6d55c
0092dc10 : PUSH EAX
0092dc11 : MOV EAX,dword ptr [EBX + 0x4]
0092dc14 : CALL EAX
0092dc16 : ADD ESP,0x20
0092dc19 : MOV ECX,EDI
0092dc1b : CALL 0x009eb990
0092dc20 : MOV byte ptr [EBP + -0x4],0x4
0092dc24 : LEA ECX,[EBP + -0x2c]
0092dc27 : CALL 0x00406560
0092dc2c : MOV dword ptr [EBP + -0x4],0xffffffff
0092dc33 : LEA ECX,[EBP + -0x48]
0092dc36 : CALL 0x00406560
0092dc3b : MOV ECX,dword ptr [EBP + -0xc]
0092dc3e : MOV dword ptr FS:[0x0],ECX
0092dc45 : POP ECX
0092dc46 : POP EDI
0092dc47 : POP ESI
0092dc48 : POP EBX
0092dc49 : MOV ECX,dword ptr [EBP + -0x10]
0092dc4c : XOR ECX,EBP
0092dc4e : CALL 0x00633e6b
0092dc53 : MOV ESP,EBP
0092dc55 : POP EBP
0092dc56 : RET 0xc

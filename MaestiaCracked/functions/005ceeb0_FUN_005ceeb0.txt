PROGRAM  : Maestia.exe
FUNCTION : FUN_005ceeb0
ENTRY    : 005ceeb0
BODY     : [[005ceeb0, 005cf021]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005ceeb0(int param_1)

{
  undefined1 *puVar1;
  int iVar2;
  char *pcVar3;
  GRefCountNTSImpl *this;
  int iVar4;
  int *piVar5;
  undefined4 uVar6;
  int iStack_c;
  int iStack_8;
  byte bStack_4;
  
  iVar2 = param_1;
  puVar1 = *(undefined1 **)(param_1 + 4);
  FUN_00526400();
  *puVar1 = 0;
  if (2 < *(int *)(iVar2 + 0x1c)) {
    FUN_005296a0();
    uVar6 = *(undefined4 *)(iVar2 + 0x18);
    FUN_00526260(0);
    FUN_005272e0(&param_1,uVar6,0xffffffff,0);
    uVar6 = *(undefined4 *)(iVar2 + 0x18);
    piVar5 = &iStack_c;
    FUN_00526260(2);
    FUN_00527140(piVar5,uVar6);
    piVar5 = (int *)0x0;
    iVar4 = 0;
    pcVar3 = (char *)FUN_00526260(1);
    if (*pcVar3 == '\a') {
      uVar6 = *(undefined4 *)(iVar2 + 0x18);
      FUN_00526260(1);
      this = (GRefCountNTSImpl *)FUN_00525fa0(uVar6);
      if (this != (GRefCountNTSImpl *)0x0) {
        *(int *)(this + 4) = *(int *)(this + 4) + 1;
        piVar5 = *(int **)(this + 0x80);
        if ((piVar5 != (int *)0x0) || (piVar5 = (int *)FUN_00520df0(), piVar5 != (int *)0x0)) {
          *piVar5 = *piVar5 + 1;
        }
        GRefCountNTSImpl::Release(this);
      }
    }
    else {
      uVar6 = *(undefined4 *)(iVar2 + 0x18);
      FUN_00526260(1);
      iVar4 = FUN_00526fa0(uVar6);
      if (iVar4 != 0) {
        *(uint *)(iVar4 + 8) = *(int *)(iVar4 + 8) + 1U & 0x8fffffff;
      }
    }
    FUN_0057aca0(&param_1,piVar5,iVar4,&iStack_c);
    puVar1 = *(undefined1 **)(iVar2 + 4);
    FUN_00526400();
    *puVar1 = 2;
    puVar1[4] = 1;
    if (iVar4 != 0) {
      FUN_00503db0();
    }
    if ((piVar5 != (int *)0x0) && (*piVar5 = *piVar5 + -1, *piVar5 < 1)) {
      FUN_0051d070();
      FUN_00515cf0(piVar5);
    }
    if (((bStack_4 & 2) == 0) && (iStack_c != 0)) {
      FUN_00503db0();
    }
    iStack_c = 0;
    if (((bStack_4 & 1) == 0) && (iStack_8 != 0)) {
      FUN_00503db0();
    }
    piVar5 = (int *)(param_1 + 8);
    iStack_8 = 0;
    *piVar5 = *piVar5 + -1;
    if (*piVar5 == 0) {
      FUN_00525340();
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005ceeb0 : SUB ESP,0x10
005ceeb3 : PUSH ESI
005ceeb4 : MOV ESI,dword ptr [ESP + 0x18]
005ceeb8 : PUSH EDI
005ceeb9 : MOV EDI,dword ptr [ESI + 0x4]
005ceebc : MOV ECX,EDI
005ceebe : CALL 0x00526400
005ceec3 : MOV byte ptr [EDI],0x0
005ceec6 : CMP dword ptr [ESI + 0x1c],0x3
005ceeca : JL 0x005cf01c
005ceed0 : MOV ECX,dword ptr [ESI + 0x18]
005ceed3 : PUSH EBX
005ceed4 : PUSH EBP
005ceed5 : CALL 0x005296a0
005ceeda : MOV EDI,dword ptr [ESI + 0x18]
005ceedd : PUSH 0x0
005ceedf : MOV ECX,ESI
005ceee1 : MOV dword ptr [ESP + 0x14],EAX
005ceee5 : CALL 0x00526260
005ceeea : PUSH 0x0
005ceeec : PUSH -0x1
005ceeee : PUSH EDI
005ceeef : LEA ECX,[ESP + 0x30]
005ceef3 : PUSH ECX
005ceef4 : MOV ECX,EAX
005ceef6 : CALL 0x005272e0
005ceefb : MOV EDX,dword ptr [ESI + 0x18]
005ceefe : PUSH EDX
005ceeff : LEA EAX,[ESP + 0x18]
005cef03 : PUSH EAX
005cef04 : PUSH 0x2
005cef06 : MOV ECX,ESI
005cef08 : CALL 0x00526260
005cef0d : MOV ECX,EAX
005cef0f : CALL 0x00527140
005cef14 : PUSH 0x1
005cef16 : MOV ECX,ESI
005cef18 : XOR EDI,EDI
005cef1a : XOR EBX,EBX
005cef1c : CALL 0x00526260
005cef21 : CMP byte ptr [EAX],0x7
005cef24 : JNZ 0x005cef65
005cef26 : MOV ECX,dword ptr [ESI + 0x18]
005cef29 : PUSH ECX
005cef2a : PUSH 0x1
005cef2c : MOV ECX,ESI
005cef2e : CALL 0x00526260
005cef33 : MOV ECX,EAX
005cef35 : CALL 0x00525fa0
005cef3a : MOV EBP,EAX
005cef3c : TEST EBP,EBP
005cef3e : JZ 0x005cef8c
005cef40 : INC dword ptr [EBP + 0x4]
005cef43 : MOV EAX,dword ptr [EBP + 0x80]
005cef49 : TEST EAX,EAX
005cef4b : JNZ 0x005cef58
005cef4d : MOV ECX,EBP
005cef4f : CALL 0x00520df0
005cef54 : TEST EAX,EAX
005cef56 : JZ 0x005cef5a
005cef58 : INC dword ptr [EAX]
005cef5a : MOV ECX,EBP
005cef5c : MOV EDI,EAX
005cef5e : CALL 0x004ff7c0
005cef63 : JMP 0x005cef8c
005cef65 : MOV EDX,dword ptr [ESI + 0x18]
005cef68 : PUSH EDX
005cef69 : PUSH 0x1
005cef6b : MOV ECX,ESI
005cef6d : CALL 0x00526260
005cef72 : MOV ECX,EAX
005cef74 : CALL 0x00526fa0
005cef79 : TEST EAX,EAX
005cef7b : JZ 0x005cef8a
005cef7d : MOV ECX,dword ptr [EAX + 0x8]
005cef80 : INC ECX
005cef81 : AND ECX,0x8fffffff
005cef87 : MOV dword ptr [EAX + 0x8],ECX
005cef8a : MOV EBX,EAX
005cef8c : MOV ECX,dword ptr [ESP + 0x10]
005cef90 : LEA EDX,[ESP + 0x14]
005cef94 : PUSH EDX
005cef95 : PUSH EBX
005cef96 : PUSH EDI
005cef97 : LEA EAX,[ESP + 0x30]
005cef9b : PUSH EAX
005cef9c : CALL 0x0057aca0
005cefa1 : MOV ESI,dword ptr [ESI + 0x4]
005cefa4 : MOV ECX,ESI
005cefa6 : CALL 0x00526400
005cefab : MOV byte ptr [ESI],0x2
005cefae : MOV byte ptr [ESI + 0x4],0x1
005cefb2 : XOR ESI,ESI
005cefb4 : CMP EBX,ESI
005cefb6 : JZ 0x005cefbf
005cefb8 : MOV ECX,EBX
005cefba : CALL 0x00503db0
005cefbf : POP EBP
005cefc0 : POP EBX
005cefc1 : CMP EDI,ESI
005cefc3 : JZ 0x005cefd8
005cefc5 : DEC dword ptr [EDI]
005cefc7 : CMP dword ptr [EDI],ESI
005cefc9 : JG 0x005cefd8
005cefcb : MOV ECX,EDI
005cefcd : CALL 0x0051d070
005cefd2 : PUSH EDI
005cefd3 : CALL 0x00515cf0
005cefd8 : TEST byte ptr [ESP + 0x14],0x2
005cefdd : JNZ 0x005cefec
005cefdf : MOV ECX,dword ptr [ESP + 0xc]
005cefe3 : CMP ECX,ESI
005cefe5 : JZ 0x005cefec
005cefe7 : CALL 0x00503db0
005cefec : TEST byte ptr [ESP + 0x14],0x1
005ceff1 : MOV dword ptr [ESP + 0xc],ESI
005ceff5 : JNZ 0x005cf004
005ceff7 : MOV ECX,dword ptr [ESP + 0x10]
005ceffb : CMP ECX,ESI
005ceffd : JZ 0x005cf004
005cefff : CALL 0x00503db0
005cf004 : MOV EAX,dword ptr [ESP + 0x1c]
005cf008 : MOV ECX,EAX
005cf00a : ADD EAX,0x8
005cf00d : MOV dword ptr [ESP + 0x10],ESI
005cf011 : DEC dword ptr [EAX]
005cf013 : CMP dword ptr [EAX],ESI
005cf015 : JNZ 0x005cf01c
005cf017 : CALL 0x00525340
005cf01c : POP EDI
005cf01d : POP ESI
005cf01e : ADD ESP,0x10
005cf021 : RET

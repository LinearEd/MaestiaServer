PROGRAM  : Maestia.exe
FUNCTION : FUN_007129e0
ENTRY    : 007129e0
BODY     : [[007129e0, 00712d07]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_007129e0(uint param_1)

{
  uint in_EAX;
  uint *puVar1;
  uint *puVar2;
  byte *in_ECX;
  uint uVar3;
  uint uVar4;
  
  uVar3 = ~(((in_EAX & 0xff00) + in_EAX * 0x10000) * 0x100 + (in_EAX >> 8 & 0xff00) +
           (in_EAX >> 0x18));
  for (; (param_1 != 0 && (((uint)in_ECX & 3) != 0)); in_ECX = in_ECX + 1) {
    uVar3 = uVar3 << 8 ^ *(uint *)(&DAT_00bffd90 + (uVar3 >> 0x18 ^ (uint)*in_ECX) * 4);
    param_1 = param_1 - 1;
  }
  puVar2 = (uint *)(in_ECX + -4);
  if (0x1f < param_1) {
    uVar4 = param_1 >> 5;
    puVar1 = puVar2;
    do {
      uVar3 = uVar3 ^ puVar1[1];
      uVar3 = *(uint *)(&DAT_00c00590 + (uVar3 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_00c00190 + (uVar3 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_00c00990 + (uVar3 >> 0x18) * 4) ^
              *(uint *)(&DAT_00bffd90 + (uVar3 & 0xff) * 4) ^ puVar1[2];
      uVar3 = *(uint *)(&DAT_00c00590 + (uVar3 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_00c00190 + (uVar3 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_00c00990 + (uVar3 >> 0x18) * 4) ^
              *(uint *)(&DAT_00bffd90 + (uVar3 & 0xff) * 4) ^ puVar1[3];
      uVar3 = *(uint *)(&DAT_00c00590 + (uVar3 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_00c00190 + (uVar3 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_00c00990 + (uVar3 >> 0x18) * 4) ^
              *(uint *)(&DAT_00bffd90 + (uVar3 & 0xff) * 4) ^ puVar1[4];
      uVar3 = *(uint *)(&DAT_00c00590 + (uVar3 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_00c00190 + (uVar3 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_00c00990 + (uVar3 >> 0x18) * 4) ^
              *(uint *)(&DAT_00bffd90 + (uVar3 & 0xff) * 4) ^ puVar1[5];
      uVar3 = *(uint *)(&DAT_00c00590 + (uVar3 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_00c00190 + (uVar3 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_00c00990 + (uVar3 >> 0x18) * 4) ^
              *(uint *)(&DAT_00bffd90 + (uVar3 & 0xff) * 4) ^ puVar1[6];
      puVar2 = puVar1 + 8;
      uVar3 = *(uint *)(&DAT_00c00590 + (uVar3 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_00c00190 + (uVar3 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_00c00990 + (uVar3 >> 0x18) * 4) ^
              *(uint *)(&DAT_00bffd90 + (uVar3 & 0xff) * 4) ^ puVar1[7];
      param_1 = param_1 - 0x20;
      uVar3 = *(uint *)(&DAT_00c00590 + (uVar3 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_00c00190 + (uVar3 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_00c00990 + (uVar3 >> 0x18) * 4) ^
              *(uint *)(&DAT_00bffd90 + (uVar3 & 0xff) * 4) ^ *puVar2;
      uVar3 = *(uint *)(&DAT_00c00590 + (uVar3 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_00c00190 + (uVar3 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_00c00990 + (uVar3 >> 0x18) * 4) ^
              *(uint *)(&DAT_00bffd90 + (uVar3 & 0xff) * 4);
      uVar4 = uVar4 - 1;
      puVar1 = puVar2;
    } while (uVar4 != 0);
  }
  if (3 < param_1) {
    uVar4 = param_1 >> 2;
    do {
      uVar3 = uVar3 ^ puVar2[1];
      puVar2 = puVar2 + 1;
      uVar3 = *(uint *)(&DAT_00c00590 + (uVar3 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_00c00190 + (uVar3 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_00c00990 + (uVar3 >> 0x18) * 4) ^
              *(uint *)(&DAT_00bffd90 + (uVar3 & 0xff) * 4);
      param_1 = param_1 - 4;
      uVar4 = uVar4 - 1;
    } while (uVar4 != 0);
  }
  puVar2 = puVar2 + 1;
  for (; param_1 != 0; param_1 = param_1 - 1) {
    uVar3 = uVar3 << 8 ^ *(uint *)(&DAT_00bffd90 + (uVar3 >> 0x18 ^ (uint)(byte)*puVar2) * 4);
    puVar2 = (uint *)((int)puVar2 + 1);
  }
  uVar3 = ~uVar3;
  return ((uVar3 & 0xff00) + uVar3 * 0x10000) * 0x100 + (uVar3 >> 8 & 0xff00) + (uVar3 >> 0x18);
}



============================================================
DISASSEMBLY
============================================================
007129e0 : PUSH EBP
007129e1 : MOV EBP,ESP
007129e3 : PUSH ESI
007129e4 : MOV ESI,dword ptr [EBP + 0x8]
007129e7 : PUSH EDI
007129e8 : MOV EDX,EAX
007129ea : AND EDX,0xff00
007129f0 : MOV EDI,EAX
007129f2 : SHL EDI,0x10
007129f5 : ADD EDX,EDI
007129f7 : MOV EDI,EAX
007129f9 : SHL EDX,0x8
007129fc : SHR EDI,0x8
007129ff : AND EDI,0xff00
00712a05 : ADD EDX,EDI
00712a07 : SHR EAX,0x18
00712a0a : ADD EDX,EAX
00712a0c : NOT EDX
00712a0e : TEST ESI,ESI
00712a10 : JZ 0x00712a31
00712a12 : TEST CL,0x3
00712a15 : JZ 0x00712a31
00712a17 : MOVZX EDI,byte ptr [ECX]
00712a1a : MOV EAX,EDX
00712a1c : SHR EAX,0x18
00712a1f : XOR EAX,EDI
00712a21 : SHL EDX,0x8
00712a24 : XOR EDX,dword ptr [EAX*0x4 + 0xbffd90]
00712a2b : INC ECX
00712a2c : SUB ESI,0x1
00712a2f : JNZ 0x00712a12
00712a31 : PUSH EBX
00712a32 : LEA EAX,[ECX + -0x4]
00712a35 : CMP ESI,0x20
00712a38 : JC 0x00712c65
00712a3e : MOV EDI,ESI
00712a40 : SHR EDI,0x5
00712a43 : XOR EDX,dword ptr [EAX + 0x4]
00712a46 : ADD EAX,0x4
00712a49 : MOV ECX,EDX
00712a4b : SHR ECX,0x10
00712a4e : MOV EBX,EDX
00712a50 : AND ECX,0xff
00712a56 : MOV ECX,dword ptr [ECX*0x4 + 0xc00590]
00712a5d : SHR EBX,0x8
00712a60 : AND EBX,0xff
00712a66 : XOR ECX,dword ptr [EBX*0x4 + 0xc00190]
00712a6d : MOV EBX,EDX
00712a6f : SHR EBX,0x18
00712a72 : XOR ECX,dword ptr [EBX*0x4 + 0xc00990]
00712a79 : AND EDX,0xff
00712a7f : XOR ECX,dword ptr [EDX*0x4 + 0xbffd90]
00712a86 : ADD EAX,0x4
00712a89 : XOR ECX,dword ptr [EAX]
00712a8b : ADD EAX,0x4
00712a8e : MOV EDX,ECX
00712a90 : SHR EDX,0x10
00712a93 : MOV EBX,ECX
00712a95 : SHR EBX,0x8
00712a98 : AND EDX,0xff
00712a9e : MOV EDX,dword ptr [EDX*0x4 + 0xc00590]
00712aa5 : AND EBX,0xff
00712aab : XOR EDX,dword ptr [EBX*0x4 + 0xc00190]
00712ab2 : MOV EBX,ECX
00712ab4 : SHR EBX,0x18
00712ab7 : XOR EDX,dword ptr [EBX*0x4 + 0xc00990]
00712abe : AND ECX,0xff
00712ac4 : XOR EDX,dword ptr [ECX*0x4 + 0xbffd90]
00712acb : ADD EAX,0x4
00712ace : XOR EDX,dword ptr [EAX + -0x4]
00712ad1 : ADD EAX,0x4
00712ad4 : MOV ECX,EDX
00712ad6 : SHR ECX,0x10
00712ad9 : MOV EBX,EDX
00712adb : AND ECX,0xff
00712ae1 : MOV ECX,dword ptr [ECX*0x4 + 0xc00590]
00712ae8 : SHR EBX,0x8
00712aeb : AND EBX,0xff
00712af1 : XOR ECX,dword ptr [EBX*0x4 + 0xc00190]
00712af8 : MOV EBX,EDX
00712afa : SHR EBX,0x18
00712afd : XOR ECX,dword ptr [EBX*0x4 + 0xc00990]
00712b04 : AND EDX,0xff
00712b0a : XOR ECX,dword ptr [EDX*0x4 + 0xbffd90]
00712b11 : ADD EAX,0x4
00712b14 : XOR ECX,dword ptr [EAX + -0x8]
00712b17 : ADD EAX,0x4
00712b1a : MOV EDX,ECX
00712b1c : SHR EDX,0x10
00712b1f : MOV EBX,ECX
00712b21 : AND EDX,0xff
00712b27 : MOV EDX,dword ptr [EDX*0x4 + 0xc00590]
00712b2e : SHR EBX,0x8
00712b31 : AND EBX,0xff
00712b37 : XOR EDX,dword ptr [EBX*0x4 + 0xc00190]
00712b3e : MOV EBX,ECX
00712b40 : SHR EBX,0x18
00712b43 : XOR EDX,dword ptr [EBX*0x4 + 0xc00990]
00712b4a : AND ECX,0xff
00712b50 : XOR EDX,dword ptr [ECX*0x4 + 0xbffd90]
00712b57 : XOR EDX,dword ptr [EAX + -0x8]
00712b5a : MOV ECX,EDX
00712b5c : SHR ECX,0x10
00712b5f : MOV EBX,EDX
00712b61 : AND ECX,0xff
00712b67 : MOV ECX,dword ptr [ECX*0x4 + 0xc00590]
00712b6e : SHR EBX,0x8
00712b71 : AND EBX,0xff
00712b77 : XOR ECX,dword ptr [EBX*0x4 + 0xc00190]
00712b7e : MOV EBX,EDX
00712b80 : SHR EBX,0x18
00712b83 : XOR ECX,dword ptr [EBX*0x4 + 0xc00990]
00712b8a : AND EDX,0xff
00712b90 : XOR ECX,dword ptr [EDX*0x4 + 0xbffd90]
00712b97 : XOR ECX,dword ptr [EAX + -0x4]
00712b9a : MOV EDX,ECX
00712b9c : SHR EDX,0x10
00712b9f : AND EDX,0xff
00712ba5 : MOV EDX,dword ptr [EDX*0x4 + 0xc00590]
00712bac : MOV EBX,ECX
00712bae : SHR EBX,0x8
00712bb1 : AND EBX,0xff
00712bb7 : XOR EDX,dword ptr [EBX*0x4 + 0xc00190]
00712bbe : MOV EBX,ECX
00712bc0 : SHR EBX,0x18
00712bc3 : XOR EDX,dword ptr [EBX*0x4 + 0xc00990]
00712bca : AND ECX,0xff
00712bd0 : XOR EDX,dword ptr [ECX*0x4 + 0xbffd90]
00712bd7 : ADD EAX,0x4
00712bda : XOR EDX,dword ptr [EAX + -0x4]
00712bdd : SUB ESI,0x20
00712be0 : MOV ECX,EDX
00712be2 : MOV EBX,EDX
00712be4 : SHR ECX,0x10
00712be7 : SHR EBX,0x8
00712bea : AND ECX,0xff
00712bf0 : MOV ECX,dword ptr [ECX*0x4 + 0xc00590]
00712bf7 : AND EBX,0xff
00712bfd : XOR ECX,dword ptr [EBX*0x4 + 0xc00190]
00712c04 : MOV EBX,EDX
00712c06 : SHR EBX,0x18
00712c09 : XOR ECX,dword ptr [EBX*0x4 + 0xc00990]
00712c10 : AND EDX,0xff
00712c16 : XOR ECX,dword ptr [EDX*0x4 + 0xbffd90]
00712c1d : XOR ECX,dword ptr [EAX]
00712c1f : MOV EDX,ECX
00712c21 : SHR EDX,0x10
00712c24 : AND EDX,0xff
00712c2a : MOV EDX,dword ptr [EDX*0x4 + 0xc00590]
00712c31 : MOV EBX,ECX
00712c33 : SHR EBX,0x8
00712c36 : AND EBX,0xff
00712c3c : XOR EDX,dword ptr [EBX*0x4 + 0xc00190]
00712c43 : MOV EBX,ECX
00712c45 : SHR EBX,0x18
00712c48 : XOR EDX,dword ptr [EBX*0x4 + 0xc00990]
00712c4f : AND ECX,0xff
00712c55 : XOR EDX,dword ptr [ECX*0x4 + 0xbffd90]
00712c5c : SUB EDI,0x1
00712c5f : JNZ 0x00712a43
00712c65 : CMP ESI,0x4
00712c68 : JC 0x00712cbd
00712c6a : MOV ECX,ESI
00712c6c : SHR ECX,0x2
00712c6f : NOP
00712c70 : XOR EDX,dword ptr [EAX + 0x4]
00712c73 : ADD EAX,0x4
00712c76 : MOV EDI,EDX
00712c78 : SHR EDI,0x10
00712c7b : AND EDI,0xff
00712c81 : MOV EDI,dword ptr [EDI*0x4 + 0xc00590]
00712c88 : MOV EBX,EDX
00712c8a : SHR EBX,0x8
00712c8d : AND EBX,0xff
00712c93 : XOR EDI,dword ptr [EBX*0x4 + 0xc00190]
00712c9a : MOV EBX,EDX
00712c9c : SHR EBX,0x18
00712c9f : XOR EDI,dword ptr [EBX*0x4 + 0xc00990]
00712ca6 : AND EDX,0xff
00712cac : XOR EDI,dword ptr [EDX*0x4 + 0xbffd90]
00712cb3 : SUB ESI,0x4
00712cb6 : SUB ECX,0x1
00712cb9 : MOV EDX,EDI
00712cbb : JNZ 0x00712c70
00712cbd : ADD EAX,0x4
00712cc0 : POP EBX
00712cc1 : TEST ESI,ESI
00712cc3 : JZ 0x00712cdf
00712cc5 : MOVZX EDI,byte ptr [EAX]
00712cc8 : MOV ECX,EDX
00712cca : SHR ECX,0x18
00712ccd : XOR ECX,EDI
00712ccf : SHL EDX,0x8
00712cd2 : XOR EDX,dword ptr [ECX*0x4 + 0xbffd90]
00712cd9 : INC EAX
00712cda : SUB ESI,0x1
00712cdd : JNZ 0x00712cc5
00712cdf : NOT EDX
00712ce1 : MOV EAX,EDX
00712ce3 : AND EAX,0xff00
00712ce8 : MOV ECX,EDX
00712cea : SHL ECX,0x10
00712ced : ADD EAX,ECX
00712cef : MOV ECX,EDX
00712cf1 : SHR ECX,0x8
00712cf4 : SHL EAX,0x8
00712cf7 : AND ECX,0xff00
00712cfd : ADD EAX,ECX
00712cff : SHR EDX,0x18
00712d02 : POP EDI
00712d03 : ADD EAX,EDX
00712d05 : POP ESI
00712d06 : POP EBP
00712d07 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_004cc690
ENTRY    : 004cc690
BODY     : [[004cc690, 004cc858]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_004cc690(float param_1,float *param_2)

{
  float fVar1;
  float fVar2;
  float fVar3;
  float fVar4;
  float fVar5;
  float fVar6;
  int iVar7;
  float *pfVar8;
  int in_EAX;
  float *pfVar9;
  int in_ECX;
  float *pfVar10;
  float fVar11;
  int local_c;
  
  if (in_EAX == 0) {
    in_EAX = in_ECX + 0x54;
  }
  if (*(int *)(in_ECX + 100) != in_EAX) {
    if ((uint)((*(int *)(in_EAX + 8) - *(int *)(in_EAX + 4)) / 0x14) < 2) {
      *(undefined4 *)(in_ECX + 100) = 0;
      return 1;
    }
    *(int *)(in_ECX + 100) = in_EAX;
    *(undefined4 *)(in_ECX + 0x6c) = *(undefined4 *)(*(int *)(in_EAX + 8) + -0x14);
    *(undefined4 *)(in_ECX + 0x70) = 0;
  }
  iVar7 = *(int *)(in_ECX + 100);
  param_1 = *(float *)(in_ECX + 0x68) + param_1;
  *(float *)(in_ECX + 0x68) = param_1;
  if ((uint)((*(int *)(iVar7 + 8) - *(int *)(iVar7 + 4)) / 0x14) <= *(int *)(in_ECX + 0x70) + 1U) {
    *(undefined4 *)(in_ECX + 100) = 0;
    return 1;
  }
  pfVar8 = *(float **)(iVar7 + 8);
  pfVar9 = (float *)(*(int *)(iVar7 + 4) + *(int *)(in_ECX + 0x70) * 0x14);
  pfVar10 = pfVar9 + 5;
  if (pfVar9[5] <= param_1 && param_1 != pfVar9[5]) {
    do {
      pfVar9 = pfVar10;
      *(int *)(in_ECX + 0x70) = *(int *)(in_ECX + 0x70) + 1;
      pfVar10 = pfVar9 + 5;
      if (pfVar10 == pfVar8) {
        if (*(char *)(in_ECX + 0x11) == '\0') {
          *(undefined4 *)(in_ECX + 0x70) = 0;
          *(undefined4 *)(in_ECX + 0x68) = 0;
          *param_2 = pfVar9[2];
          param_2[1] = pfVar9[3];
          param_2[2] = pfVar9[4];
          return 4;
        }
        local_c = (int)(longlong)ROUND(*(float *)(in_ECX + 0x68) / *(float *)(in_ECX + 0x6c));
        fVar1 = (float)local_c;
        if (local_c < 0) {
          fVar1 = fVar1 + 4.2949673e+09;
        }
        *(float *)(in_ECX + 0x68) = *(float *)(in_ECX + 0x68) - fVar1 * *(float *)(in_ECX + 0x6c);
        pfVar9 = *(float **)(iVar7 + 4);
        pfVar10 = pfVar9 + 5;
        *(undefined4 *)(in_ECX + 0x70) = 0;
      }
    } while (*pfVar10 <= *(float *)(in_ECX + 0x68) && *(float *)(in_ECX + 0x68) != *pfVar10);
  }
  fVar1 = pfVar10[4];
  fVar2 = pfVar9[4];
  fVar11 = (*(float *)(in_ECX + 0x68) - *pfVar9) / (*pfVar10 - *pfVar9);
  fVar3 = pfVar10[3];
  fVar4 = pfVar9[3];
  fVar5 = pfVar9[3];
  fVar6 = pfVar9[4];
  *param_2 = pfVar9[2] + (pfVar10[2] - pfVar9[2]) * fVar11;
  param_2[1] = fVar5 + fVar11 * (fVar3 - fVar4);
  param_2[2] = fVar6 + fVar11 * (fVar1 - fVar2);
  return 2;
}



============================================================
DISASSEMBLY
============================================================
004cc690 : PUSH EBP
004cc691 : MOV EBP,ESP
004cc693 : SUB ESP,0x8
004cc696 : PUSH EBX
004cc697 : MOV EBX,dword ptr [EBP + 0xc]
004cc69a : PUSH ESI
004cc69b : PUSH EDI
004cc69c : MOV ESI,EAX
004cc69e : XOR EDI,EDI
004cc6a0 : CMP ESI,EDI
004cc6a2 : JNZ 0x004cc6a7
004cc6a4 : LEA ESI,[ECX + 0x54]
004cc6a7 : CMP dword ptr [ECX + 0x64],ESI
004cc6aa : JZ 0x004cc6eb
004cc6ac : MOV EDX,dword ptr [ESI + 0x8]
004cc6af : SUB EDX,dword ptr [ESI + 0x4]
004cc6b2 : MOV EAX,0x66666667
004cc6b7 : IMUL EDX
004cc6b9 : SAR EDX,0x3
004cc6bc : MOV EAX,EDX
004cc6be : SHR EAX,0x1f
004cc6c1 : ADD EAX,EDX
004cc6c3 : CMP EAX,0x2
004cc6c6 : JNC 0x004cc6d9
004cc6c8 : MOV dword ptr [ECX + 0x64],EDI
004cc6cb : POP EDI
004cc6cc : POP ESI
004cc6cd : MOV EAX,0x1
004cc6d2 : POP EBX
004cc6d3 : MOV ESP,EBP
004cc6d5 : POP EBP
004cc6d6 : RET 0x8
004cc6d9 : MOV dword ptr [ECX + 0x64],ESI
004cc6dc : MOV ESI,dword ptr [ESI + 0x8]
004cc6df : FLD float ptr [ESI + -0x14]
004cc6e2 : SUB ESI,0x14
004cc6e5 : FSTP float ptr [ECX + 0x6c]
004cc6e8 : MOV dword ptr [ECX + 0x70],EDI
004cc6eb : MOVSS XMM0,dword ptr [ECX + 0x68]
004cc6f0 : MOV ESI,dword ptr [ECX + 0x64]
004cc6f3 : ADDSS XMM0,dword ptr [EBP + 0x8]
004cc6f8 : MOV EDI,dword ptr [ECX + 0x70]
004cc6fb : MOVSS dword ptr [ECX + 0x68],XMM0
004cc700 : MOV EDX,dword ptr [ESI + 0x8]
004cc703 : SUB EDX,dword ptr [ESI + 0x4]
004cc706 : MOV EAX,0x66666667
004cc70b : IMUL EDX
004cc70d : SAR EDX,0x3
004cc710 : MOV EAX,EDX
004cc712 : SHR EAX,0x1f
004cc715 : ADD EAX,EDX
004cc717 : LEA EDX,[EDI + 0x1]
004cc71a : CMP EAX,EDX
004cc71c : JA 0x004cc733
004cc71e : POP EDI
004cc71f : POP ESI
004cc720 : MOV dword ptr [ECX + 0x64],0x0
004cc727 : MOV EAX,0x1
004cc72c : POP EBX
004cc72d : MOV ESP,EBP
004cc72f : POP EBP
004cc730 : RET 0x8
004cc733 : MOV EDX,dword ptr [ESI + 0x4]
004cc736 : LEA EAX,[EDI + EDI*0x4]
004cc739 : MOV EDI,dword ptr [ESI + 0x8]
004cc73c : LEA EAX,[EDX + EAX*0x4]
004cc73f : COMISS XMM0,dword ptr [EAX + 0x14]
004cc743 : LEA EDX,[EAX + 0x14]
004cc746 : JBE 0x004cc7ae
004cc748 : INC dword ptr [ECX + 0x70]
004cc74b : MOV EAX,EDX
004cc74d : ADD EDX,0x14
004cc750 : CMP EDX,EDI
004cc752 : JNZ 0x004cc7a4
004cc754 : CMP byte ptr [ECX + 0x11],0x0
004cc758 : JZ 0x004cc82b
004cc75e : FLD float ptr [ECX + 0x6c]
004cc761 : FLD float ptr [ECX + 0x68]
004cc764 : FLD ST0
004cc766 : FDIV ST0,ST2
004cc768 : FNSTCW word ptr [EBP + 0xe]
004cc76b : MOVZX EAX,word ptr [EBP + 0xe]
004cc76f : OR EAX,0xc00
004cc774 : MOV dword ptr [EBP + 0x8],EAX
004cc777 : FLDCW word ptr [EBP + 0x8]
004cc77a : FISTP qword ptr [EBP + -0x8]
004cc77d : MOV EAX,dword ptr [EBP + -0x8]
004cc780 : FLDCW word ptr [EBP + 0xe]
004cc783 : FILD dword ptr [EBP + -0x8]
004cc786 : TEST EAX,EAX
004cc788 : JGE 0x004cc790
004cc78a : FADD float ptr [0x00cdf0e0]
004cc790 : FMULP ST2
004cc792 : FSUBRP
004cc794 : FSTP float ptr [ECX + 0x68]
004cc797 : MOV EAX,dword ptr [ESI + 0x4]
004cc79a : LEA EDX,[EAX + 0x14]
004cc79d : MOV dword ptr [ECX + 0x70],0x0
004cc7a4 : MOVSS XMM0,dword ptr [ECX + 0x68]
004cc7a9 : COMISS XMM0,dword ptr [EDX]
004cc7ac : JA 0x004cc748
004cc7ae : MOVSS XMM1,dword ptr [EAX]
004cc7b2 : MOVSS XMM0,dword ptr [ECX + 0x68]
004cc7b7 : MOVSS XMM2,dword ptr [EDX]
004cc7bb : MOVSS XMM3,dword ptr [EDX + 0x10]
004cc7c0 : SUBSS XMM3,dword ptr [EAX + 0x10]
004cc7c5 : SUBSS XMM2,XMM1
004cc7c9 : SUBSS XMM0,XMM1
004cc7cd : MOVSS XMM1,dword ptr [EDX + 0x8]
004cc7d2 : SUBSS XMM1,dword ptr [EAX + 0x8]
004cc7d7 : DIVSS XMM0,XMM2
004cc7db : MOVSS XMM2,dword ptr [EDX + 0xc]
004cc7e0 : SUBSS XMM2,dword ptr [EAX + 0xc]
004cc7e5 : MULSS XMM1,XMM0
004cc7e9 : MOVAPS XMM4,XMM0
004cc7ec : MULSS XMM4,XMM2
004cc7f0 : MOVSS XMM2,dword ptr [EAX + 0x8]
004cc7f5 : ADDSS XMM2,XMM1
004cc7f9 : MOVSS XMM1,dword ptr [EAX + 0xc]
004cc7fe : MULSS XMM0,XMM3
004cc802 : MOVSS XMM3,dword ptr [EAX + 0x10]
004cc807 : POP EDI
004cc808 : ADDSS XMM1,XMM4
004cc80c : ADDSS XMM3,XMM0
004cc810 : POP ESI
004cc811 : MOVSS dword ptr [EBX],XMM2
004cc815 : MOVSS dword ptr [EBX + 0x4],XMM1
004cc81a : MOVSS dword ptr [EBX + 0x8],XMM3
004cc81f : MOV EAX,0x2
004cc824 : POP EBX
004cc825 : MOV ESP,EBP
004cc827 : POP EBP
004cc828 : RET 0x8
004cc82b : XORPS XMM0,XMM0
004cc82e : MOV dword ptr [ECX + 0x70],0x0
004cc835 : MOVSS dword ptr [ECX + 0x68],XMM0
004cc83a : FLD float ptr [EAX + 0x8]
004cc83d : FSTP float ptr [EBX]
004cc83f : POP EDI
004cc840 : FLD float ptr [EAX + 0xc]
004cc843 : POP ESI
004cc844 : FSTP float ptr [EBX + 0x4]
004cc847 : FLD float ptr [EAX + 0x10]
004cc84a : MOV EAX,0x4
004cc84f : FSTP float ptr [EBX + 0x8]
004cc852 : POP EBX
004cc853 : MOV ESP,EBP
004cc855 : POP EBP
004cc856 : RET 0x8

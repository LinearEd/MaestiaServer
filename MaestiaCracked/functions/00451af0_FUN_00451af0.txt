PROGRAM  : Maestia.exe
FUNCTION : FUN_00451af0
ENTRY    : 00451af0
BODY     : [[00451af0, 00451b36]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00451af0(void)

{
  char cVar1;
  char *pcVar2;
  size_t _Size;
  char *in_EDX;
  undefined4 *unaff_ESI;
  
  *unaff_ESI = &PTR_FUN_00cd3f48;
  if (in_EDX == (char *)0x0) {
    unaff_ESI[1] = 0;
    *(undefined1 *)(unaff_ESI + 2) = 0;
    return;
  }
  pcVar2 = in_EDX;
  do {
    cVar1 = *pcVar2;
    pcVar2 = pcVar2 + 1;
  } while (cVar1 != '\0');
  _Size = (int)pcVar2 - (int)(in_EDX + 1);
  if (_Size != 0) {
    _memmove(unaff_ESI + 2,in_EDX,_Size);
  }
  unaff_ESI[1] = _Size;
  *(undefined1 *)(_Size + 8 + (int)unaff_ESI) = 0;
  return;
}



============================================================
DISASSEMBLY
============================================================
00451af0 : MOV dword ptr [ESI],0xcd3f48
00451af6 : TEST EDX,EDX
00451af8 : JNZ 0x00451b03
00451afa : MOV dword ptr [ESI + 0x4],EDX
00451afd : MOV byte ptr [ESI + 0x8],DL
00451b00 : MOV EAX,ESI
00451b02 : RET
00451b03 : MOV EAX,EDX
00451b05 : PUSH EDI
00451b06 : LEA EDI,[EAX + 0x1]
00451b09 : LEA ESP,[ESP]
00451b10 : MOV CL,byte ptr [EAX]
00451b12 : INC EAX
00451b13 : TEST CL,CL
00451b15 : JNZ 0x00451b10
00451b17 : SUB EAX,EDI
00451b19 : MOV EDI,EAX
00451b1b : JZ 0x00451b2b
00451b1d : PUSH EDI
00451b1e : PUSH EDX
00451b1f : LEA EAX,[ESI + 0x8]
00451b22 : PUSH EAX
00451b23 : CALL 0x00636880
00451b28 : ADD ESP,0xc
00451b2b : MOV dword ptr [ESI + 0x4],EDI
00451b2e : MOV byte ptr [EDI + ESI*0x1 + 0x8],0x0
00451b33 : POP EDI
00451b34 : MOV EAX,ESI
00451b36 : RET

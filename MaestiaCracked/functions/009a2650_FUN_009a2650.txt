PROGRAM  : Maestia.exe
FUNCTION : FUN_009a2650
ENTRY    : 009a2650
BODY     : [[009a2650, 009a27ee] [009a27f0, 009a2a2d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009a2650(int param_1,int param_2)

{
  int *piVar1;
  int *piVar2;
  short sVar3;
  uint uVar4;
  int iVar5;
  undefined4 uVar6;
  ushort in_CX;
  ushort uVar7;
  undefined1 local_40 [28];
  undefined1 local_24 [4];
  int *local_20;
  int local_1c;
  uint local_18;
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4e43f;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if ((ushort)(in_CX - 0xe) < 6) {
    if (DAT_00da93ec != 0) {
      FUN_00a1c440(1);
    }
    if (param_2 == 0) {
      *(undefined1 *)((uint)in_CX * 0x68 + -0x4dc + param_1) = 0;
      ExceptionList = local_10;
      return;
    }
    param_1 = param_1 + (uint)in_CX * 0x68;
    *(undefined1 *)(param_1 + -0x4dc) = 0;
    iVar5 = FUN_004049b0(*(undefined4 *)(param_2 + 0x10),uVar4);
    if (iVar5 == 0) {
      FUN_00406460(L"pData NULL");
      local_8 = 0;
      if ((int *)*DAT_00da98e8 != (int *)0x0) {
        (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                  (L"AvaGuiEquip::UpdateMyHalidomData",0x473,local_40);
      }
      local_8 = 0xffffffff;
      FUN_00406560();
      ExceptionList = local_10;
      return;
    }
    *(ushort *)(param_1 + -0x540) = in_CX;
    *(undefined4 *)(param_1 + -0x53c) = *(undefined4 *)(param_2 + 0x10);
    FUN_0040eef0(iVar5 + 0x18);
    local_8 = 1;
    uVar6 = FUN_00824120(DAT_0172491c);
    local_8._0_1_ = 2;
    FUN_00405eb0(uVar6,0,0xffffffff);
    local_8 = CONCAT31(local_8._1_3_,1);
    FUN_00406560();
    local_8 = 0xffffffff;
    FUN_00406560();
    FUN_0040e750(param_2,local_24);
    local_8 = 3;
    if (local_1c != 0) {
      piVar1 = (int *)*local_20;
      while (piVar1 != local_20) {
        iVar5 = piVar1[3];
        if (((iVar5 == 0x26) || (iVar5 == 0x27)) || (iVar5 == 0x28)) {
          uVar7 = *(ushort *)(piVar1 + 4);
          local_18 = (uint)*(ushort *)((int)piVar1 + 0x12);
          if ((uVar7 != 0xffff) && (uVar7 != 0)) {
            uVar7 = uVar7 - 1;
          }
          if (0x15 < uVar7) {
            uVar7 = uVar7 - 1;
          }
          local_14 = (int *)FUN_00703c00(0x700);
          if (local_14 != (int *)0x0) {
            iVar5 = piVar1[3];
            if (iVar5 == 0x26) {
              *(uint *)(param_1 + -0x538) = local_18 & 0xffff;
              FUN_0040eef0(local_14 + 6);
              local_8._0_1_ = 4;
              uVar6 = FUN_00824120(DAT_0172491c);
              local_8._0_1_ = 5;
              FUN_00405d70(uVar6);
              local_8._0_1_ = 4;
              FUN_00406560();
LAB_009a2908:
              local_8 = CONCAT31(local_8._1_3_,3);
              FUN_00406560();
            }
            else if ((iVar5 == 0x27) || (iVar5 == 0x28)) {
              *(uint *)(param_1 + -0x538) = local_18 & 0xffff;
              FUN_0040eef0(local_14 + 6);
              local_8._0_1_ = 6;
              uVar6 = FUN_00824120(DAT_0172491c);
              local_8._0_1_ = 7;
              FUN_00405d70(uVar6);
              local_8._0_1_ = 6;
              FUN_00406560();
              goto LAB_009a2908;
            }
            piVar2 = local_14;
            sVar3 = (**(code **)(*local_14 + 8))();
            if (sVar3 == 0x76e) {
              if (((uVar7 == 0) || (uVar7 < 0x16)) &&
                 (iVar5 = (**(code **)(piVar2[(uint)uVar7 * 0xd + 0x9e] + 4))(), iVar5 != 0)) {
                uVar4 = FUN_004f5680();
                if (uVar4 < 0x800) {
                  uVar6 = FUN_006ee420(".\\Gui\\AvaGuiEquip.cpp",0x4b2);
                  FUN_006ee470(L"[ERROR] pointer invalid (%x) %s %d\n",uVar4,uVar6);
                  break;
                }
                *(uint *)(param_1 + -0x534) = (uint)*(ushort *)(uVar4 + 6);
                FUN_0040eef0(uVar4 + 0x18);
                local_8._0_1_ = 8;
                uVar6 = FUN_00824120(DAT_0172491c);
                local_8._0_1_ = 9;
                FUN_00405d70(uVar6);
                local_8._0_1_ = 8;
                FUN_00406560();
                local_8 = CONCAT31(local_8._1_3_,3);
                FUN_00406560();
                *(undefined1 *)(param_1 + -0x4dc) = 1;
              }
            }
            else {
              FUN_008018d0(
                          L"[AvaGuiEquip::UpdateMyHalidomData] Passive Halidom must be [Conditional Active Skill]"
                          );
            }
          }
        }
        FUN_00416210();
      }
    }
    local_8 = 0xffffffff;
    FUN_0040f3f0(local_24);
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
009a2650 : PUSH EBP
009a2651 : MOV EBP,ESP
009a2653 : PUSH -0x1
009a2655 : PUSH 0xb4e43f
009a265a : MOV EAX,FS:[0x0]
009a2660 : PUSH EAX
009a2661 : SUB ESP,0xbc
009a2667 : PUSH EBX
009a2668 : PUSH ESI
009a2669 : PUSH EDI
009a266a : MOV EAX,[0x00d66fa0]
009a266f : XOR EAX,EBP
009a2671 : PUSH EAX
009a2672 : LEA EAX,[EBP + -0xc]
009a2675 : MOV FS:[0x0],EAX
009a267b : MOV ESI,ECX
009a267d : MOV EBX,dword ptr [EBP + 0x8]
009a2680 : LEA EAX,[ESI + -0xe]
009a2683 : CMP AX,0x5
009a2687 : JA 0x009a27db
009a268d : MOV EAX,[0x00da93ec]
009a2692 : TEST EAX,EAX
009a2694 : JZ 0x009a26a2
009a2696 : PUSH 0x1
009a2698 : MOV ECX,0x1
009a269d : CALL 0x00a1c440
009a26a2 : MOV EDI,dword ptr [EBP + 0xc]
009a26a5 : TEST EDI,EDI
009a26a7 : JNZ 0x009a26cb
009a26a9 : MOVZX ECX,SI
009a26ac : IMUL ECX,ECX,0x68
009a26af : MOV byte ptr [ECX + EBX*0x1 + 0xfffffb24],0x0
009a26b7 : MOV ECX,dword ptr [EBP + -0xc]
009a26ba : MOV dword ptr FS:[0x0],ECX
009a26c1 : POP ECX
009a26c2 : POP EDI
009a26c3 : POP ESI
009a26c4 : POP EBX
009a26c5 : MOV ESP,EBP
009a26c7 : POP EBP
009a26c8 : RET 0x8
009a26cb : MOVZX EDX,SI
009a26ce : IMUL EDX,EDX,0x68
009a26d1 : ADD EBX,EDX
009a26d3 : MOV byte ptr [EBX + 0xfffffb24],0x0
009a26da : MOV EAX,dword ptr [EDI + 0x10]
009a26dd : PUSH EAX
009a26de : CALL 0x004049b0
009a26e3 : ADD ESP,0x4
009a26e6 : TEST EAX,EAX
009a26e8 : JNZ 0x009a2741
009a26ea : PUSH 0xc89210
009a26ef : LEA ECX,[EBP + -0x3c]
009a26f2 : CALL 0x00406460
009a26f7 : MOV dword ptr [EBP + -0x4],0x0
009a26fe : MOV EAX,[0x00da98e8]
009a2703 : MOV ECX,dword ptr [EAX]
009a2705 : TEST ECX,ECX
009a2707 : JZ 0x009a271e
009a2709 : MOV EDX,dword ptr [ECX]
009a270b : MOV EDX,dword ptr [EDX + 0x14]
009a270e : LEA EAX,[EBP + -0x3c]
009a2711 : PUSH EAX
009a2712 : PUSH 0x473
009a2717 : PUSH 0xc89228
009a271c : CALL EDX
009a271e : MOV dword ptr [EBP + -0x4],0xffffffff
009a2725 : LEA ECX,[EBP + -0x3c]
009a2728 : CALL 0x00406560
009a272d : MOV ECX,dword ptr [EBP + -0xc]
009a2730 : MOV dword ptr FS:[0x0],ECX
009a2737 : POP ECX
009a2738 : POP EDI
009a2739 : POP ESI
009a273a : POP EBX
009a273b : MOV ESP,EBP
009a273d : POP EBP
009a273e : RET 0x8
009a2741 : MOV word ptr [EBX + 0xfffffac0],SI
009a2748 : MOV ECX,dword ptr [EDI + 0x10]
009a274b : ADD EAX,0x18
009a274e : PUSH EAX
009a274f : LEA ESI,[EBP + -0x58]
009a2752 : MOV dword ptr [EBX + 0xfffffac4],ECX
009a2758 : CALL 0x0040eef0
009a275d : ADD ESP,0x4
009a2760 : MOV dword ptr [EBP + -0x4],0x1
009a2767 : MOV ECX,dword ptr [0x0172491c]
009a276d : PUSH ECX
009a276e : MOV EDX,EAX
009a2770 : LEA EDI,[EBP + -0x3c]
009a2773 : CALL 0x00824120
009a2778 : MOV byte ptr [EBP + -0x4],0x2
009a277c : PUSH -0x1
009a277e : PUSH 0x0
009a2780 : PUSH EAX
009a2781 : LEA ECX,[EBX + 0xfffffad0]
009a2787 : CALL 0x00405eb0
009a278c : MOV byte ptr [EBP + -0x4],0x1
009a2790 : MOV ECX,EDI
009a2792 : CALL 0x00406560
009a2797 : MOV dword ptr [EBP + -0x4],0xffffffff
009a279e : MOV ECX,ESI
009a27a0 : CALL 0x00406560
009a27a5 : MOV EAX,dword ptr [EBP + 0xc]
009a27a8 : LEA EDX,[EBP + -0x20]
009a27ab : PUSH EDX
009a27ac : PUSH EAX
009a27ad : CALL 0x0040e750
009a27b2 : MOV dword ptr [EBP + -0x4],0x3
009a27b9 : CMP dword ptr [EBP + -0x18],0x0
009a27bd : JZ 0x009a27cb
009a27bf : MOV ECX,dword ptr [EBP + -0x1c]
009a27c2 : MOV EAX,dword ptr [ECX]
009a27c4 : MOV dword ptr [EBP + 0x8],EAX
009a27c7 : CMP EAX,ECX
009a27c9 : JNZ 0x009a27f3
009a27cb : MOV dword ptr [EBP + -0x4],0xffffffff
009a27d2 : LEA ECX,[EBP + -0x20]
009a27d5 : PUSH ECX
009a27d6 : CALL 0x0040f3f0
009a27db : MOV ECX,dword ptr [EBP + -0xc]
009a27de : MOV dword ptr FS:[0x0],ECX
009a27e5 : POP ECX
009a27e6 : POP EDI
009a27e7 : POP ESI
009a27e8 : POP EBX
009a27e9 : MOV ESP,EBP
009a27eb : POP EBP
009a27ec : RET 0x8
009a27f0 : MOV EAX,dword ptr [EBP + 0x8]
009a27f3 : MOV ECX,dword ptr [EAX + 0xc]
009a27f6 : CMP ECX,0x26
009a27f9 : JZ 0x009a2809
009a27fb : CMP ECX,0x27
009a27fe : JZ 0x009a2809
009a2800 : CMP ECX,0x28
009a2803 : JNZ 0x009a29e4
009a2809 : MOVZX ESI,word ptr [EAX + 0x10]
009a280d : MOVZX EDI,word ptr [EAX + 0x12]
009a2811 : MOV ECX,0xffff
009a2816 : MOV dword ptr [EBP + -0x14],EDI
009a2819 : MOV dword ptr [EBP + 0xc],ESI
009a281c : CMP SI,CX
009a281f : JZ 0x009a282b
009a2821 : TEST SI,SI
009a2824 : JBE 0x009a282b
009a2826 : ADD ESI,ECX
009a2828 : MOV dword ptr [EBP + 0xc],ESI
009a282b : CMP SI,0x16
009a282f : JC 0x009a2836
009a2831 : ADD ESI,ECX
009a2833 : MOV dword ptr [EBP + 0xc],ESI
009a2836 : PUSH 0x700
009a283b : CALL 0x00703c00
009a2840 : MOV EDI,EAX
009a2842 : ADD ESP,0x4
009a2845 : MOV dword ptr [EBP + -0x10],EDI
009a2848 : TEST EDI,EDI
009a284a : JZ 0x009a29e4
009a2850 : MOV EDX,dword ptr [EBP + 0x8]
009a2853 : MOV EAX,dword ptr [EDX + 0xc]
009a2856 : CMP EAX,0x26
009a2859 : JNZ 0x009a28ac
009a285b : MOVZX EAX,word ptr [EBP + -0x14]
009a285f : ADD EDI,0x18
009a2862 : PUSH EDI
009a2863 : LEA ESI,[EBP + -0x3c]
009a2866 : MOV dword ptr [EBX + 0xfffffac8],EAX
009a286c : CALL 0x0040eef0
009a2871 : ADD ESP,0x4
009a2874 : MOV byte ptr [EBP + -0x4],0x4
009a2878 : MOV ECX,dword ptr [0x0172491c]
009a287e : PUSH ECX
009a287f : MOV EDX,EAX
009a2881 : LEA EDI,[EBP + -0x58]
009a2884 : CALL 0x00824120
009a2889 : MOV byte ptr [EBP + -0x4],0x5
009a288d : PUSH EAX
009a288e : LEA ECX,[EBX + 0xfffffaec]
009a2894 : CALL 0x00405d70
009a2899 : MOV byte ptr [EBP + -0x4],0x4
009a289d : MOV ECX,EDI
009a289f : CALL 0x00406560
009a28a4 : MOV byte ptr [EBP + -0x4],0x3
009a28a8 : MOV ECX,ESI
009a28aa : JMP 0x009a2908
009a28ac : CMP EAX,0x27
009a28af : JZ 0x009a28b6
009a28b1 : CMP EAX,0x28
009a28b4 : JNZ 0x009a2913
009a28b6 : MOVZX EDX,word ptr [EBP + -0x14]
009a28ba : ADD EDI,0x18
009a28bd : PUSH EDI
009a28be : LEA ESI,[EBP + -0x74]
009a28c1 : MOV dword ptr [EBX + 0xfffffac8],EDX
009a28c7 : CALL 0x0040eef0
009a28cc : ADD ESP,0x4
009a28cf : MOV byte ptr [EBP + -0x4],0x6
009a28d3 : MOV ECX,dword ptr [0x0172491c]
009a28d9 : PUSH ECX
009a28da : MOV EDX,EAX
009a28dc : LEA EDI,[EBP + 0xffffff54]
009a28e2 : CALL 0x00824120
009a28e7 : MOV byte ptr [EBP + -0x4],0x7
009a28eb : PUSH EAX
009a28ec : LEA ECX,[EBX + 0xfffffaec]
009a28f2 : CALL 0x00405d70
009a28f7 : MOV byte ptr [EBP + -0x4],0x6
009a28fb : MOV ECX,EDI
009a28fd : CALL 0x00406560
009a2902 : MOV byte ptr [EBP + -0x4],0x3
009a2906 : MOV ECX,ESI
009a2908 : CALL 0x00406560
009a290d : MOV ESI,dword ptr [EBP + 0xc]
009a2910 : MOV EDI,dword ptr [EBP + -0x10]
009a2913 : MOV EDX,dword ptr [EDI]
009a2915 : MOV EAX,dword ptr [EDX + 0x8]
009a2918 : MOV ECX,EDI
009a291a : CALL EAX
009a291c : MOV ECX,0x76e
009a2921 : CMP AX,CX
009a2924 : JZ 0x009a293e
009a2926 : MOV ESI,dword ptr [0x00da98e8]
009a292c : PUSH 0xc89270
009a2931 : CALL 0x008018d0
009a2936 : ADD ESP,0x4
009a2939 : JMP 0x009a29e4
009a293e : TEST SI,SI
009a2941 : JZ 0x009a294d
009a2943 : CMP SI,0x16
009a2947 : JNC 0x009a29e4
009a294d : MOVZX EDX,SI
009a2950 : IMUL EDX,EDX,0x34
009a2953 : MOV EAX,dword ptr [EDX + EDI*0x1 + 0x278]
009a295a : LEA EDI,[EDX + EDI*0x1 + 0x278]
009a2961 : MOV EDX,dword ptr [EAX + 0x4]
009a2964 : MOV ECX,EDI
009a2966 : CALL EDX
009a2968 : MOV dword ptr [EBP + 0xc],EAX
009a296b : TEST EAX,EAX
009a296d : JZ 0x009a29e4
009a296f : LEA EDX,[EBP + 0xc]
009a2972 : MOV EAX,EDI
009a2974 : CALL 0x004f5680
009a2979 : MOV ESI,EAX
009a297b : CMP ESI,0x800
009a2981 : JC 0x009a29fd
009a2983 : MOVZX EAX,word ptr [ESI + 0x6]
009a2987 : ADD ESI,0x18
009a298a : PUSH ESI
009a298b : LEA ESI,[EBP + 0xffffff38]
009a2991 : MOV dword ptr [EBX + 0xfffffacc],EAX
009a2997 : CALL 0x0040eef0
009a299c : ADD ESP,0x4
009a299f : MOV byte ptr [EBP + -0x4],0x8
009a29a3 : MOV ECX,dword ptr [0x0172491c]
009a29a9 : PUSH ECX
009a29aa : MOV EDX,EAX
009a29ac : LEA EDI,[EBP + 0xffffff70]
009a29b2 : CALL 0x00824120
009a29b7 : MOV byte ptr [EBP + -0x4],0x9
009a29bb : PUSH EAX
009a29bc : LEA ECX,[EBX + 0xfffffb08]
009a29c2 : CALL 0x00405d70
009a29c7 : MOV byte ptr [EBP + -0x4],0x8
009a29cb : MOV ECX,EDI
009a29cd : CALL 0x00406560
009a29d2 : MOV byte ptr [EBP + -0x4],0x3
009a29d6 : MOV ECX,ESI
009a29d8 : CALL 0x00406560
009a29dd : MOV byte ptr [EBX + 0xfffffb24],0x1
009a29e4 : LEA EDX,[EBP + 0x8]
009a29e7 : CALL 0x00416210
009a29ec : MOV EDX,dword ptr [EBP + -0x1c]
009a29ef : CMP dword ptr [EBP + 0x8],EDX
009a29f2 : JNZ 0x009a27f0
009a29f8 : JMP 0x009a27cb
009a29fd : PUSH 0x4b2
009a2a02 : PUSH 0xc8931c
009a2a07 : CALL 0x006ee420
009a2a0c : ADD ESP,0x4
009a2a0f : PUSH EAX
009a2a10 : PUSH ESI
009a2a11 : PUSH 0xc89338
009a2a16 : CALL 0x006ee470
009a2a1b : ADD ESP,0x10
009a2a1e : MOV dword ptr [EBP + -0x4],0xffffffff
009a2a25 : LEA EAX,[EBP + -0x20]
009a2a28 : PUSH EAX
009a2a29 : JMP 0x009a27d6

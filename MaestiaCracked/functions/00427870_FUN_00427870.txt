PROGRAM  : Maestia.exe
FUNCTION : FUN_00427870
ENTRY    : 00427870
BODY     : [[00427870, 004278d8]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00427870(wchar_t *param_1,undefined4 param_2,undefined4 param_3)

{
  wchar_t wVar1;
  wchar_t *_Dest;
  undefined1 in_CL;
  ushort *unaff_ESI;
  
  *(undefined4 *)((int)unaff_ESI + 5) = param_2;
  *unaff_ESI = 0;
  *(undefined1 *)(unaff_ESI + 2) = in_CL;
  _Dest = (wchar_t *)(unaff_ESI + 7);
  *(undefined1 *)(unaff_ESI + 1) = 0x91;
  *(undefined1 *)((int)unaff_ESI + 3) = 5;
  *(undefined4 *)((int)unaff_ESI + 9) = param_3;
  *(undefined1 *)((int)unaff_ESI + 0xd) = 5;
  _wcsncpy(_Dest,param_1,0x27);
  unaff_ESI[0x2e] = 0;
  do {
    wVar1 = *_Dest;
    _Dest = _Dest + 1;
  } while (wVar1 != L'\0');
  *unaff_ESI = *unaff_ESI ^
               ((short)((int)_Dest - (int)(unaff_ESI + 8) >> 1) * 2 + 0x10U ^ *unaff_ESI) & 0x1fff;
  return;
}



============================================================
DISASSEMBLY
============================================================
00427870 : PUSH EBP
00427871 : MOV EBP,ESP
00427873 : MOV EDX,dword ptr [EBP + 0xc]
00427876 : PUSH EDI
00427877 : XOR EAX,EAX
00427879 : MOV dword ptr [ESI + 0x5],EDX
0042787c : MOV EDX,dword ptr [EBP + 0x8]
0042787f : PUSH 0x27
00427881 : MOV word ptr [ESI],AX
00427884 : MOV AL,0x5
00427886 : MOV byte ptr [ESI + 0x4],CL
00427889 : MOV ECX,dword ptr [EBP + 0x10]
0042788c : PUSH EDX
0042788d : LEA EDI,[ESI + 0xe]
00427890 : PUSH EDI
00427891 : MOV byte ptr [ESI + 0x2],0x91
00427895 : MOV byte ptr [ESI + 0x3],AL
00427898 : MOV dword ptr [ESI + 0x9],ECX
0042789b : MOV byte ptr [ESI + 0xd],AL
0042789e : CALL 0x00634e39
004278a3 : ADD ESP,0xc
004278a6 : XOR EAX,EAX
004278a8 : MOV word ptr [EDI + 0x4e],AX
004278ac : MOV EAX,EDI
004278ae : LEA EDX,[EAX + 0x2]
004278b1 : POP EDI
004278b2 : MOV CX,word ptr [EAX]
004278b5 : ADD EAX,0x2
004278b8 : TEST CX,CX
004278bb : JNZ 0x004278b2
004278bd : SUB EAX,EDX
004278bf : SAR EAX,0x1
004278c1 : LEA ECX,[EAX + EAX*0x1 + 0x10]
004278c5 : XOR CX,word ptr [ESI]
004278c8 : MOV EDX,0x1fff
004278cd : AND CX,DX
004278d0 : XOR word ptr [ESI],CX
004278d3 : MOV EAX,ESI
004278d5 : POP EBP
004278d6 : RET 0xc

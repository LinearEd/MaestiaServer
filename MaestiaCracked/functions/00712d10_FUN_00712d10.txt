PROGRAM  : Maestia.exe
FUNCTION : FUN_00712d10
ENTRY    : 00712d10
BODY     : [[00712d10, 00712fc7] [00712fd0, 00712fef]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_00712d10(uint param_1)

{
  uint in_EAX;
  uint uVar1;
  uint *in_ECX;
  uint *puVar2;
  uint uVar3;
  
  uVar1 = ~in_EAX;
  for (; (param_1 != 0 && (((uint)in_ECX & 3) != 0)); in_ECX = (uint *)((int)in_ECX + 1)) {
    uVar1 = uVar1 >> 8 ^ *(uint *)(&DAT_00bfed90 + (((byte)*in_ECX ^ uVar1) & 0xff) * 4);
    param_1 = param_1 - 1;
  }
  if (0x1f < param_1) {
    uVar3 = param_1 >> 5;
    puVar2 = in_ECX;
    do {
      uVar1 = uVar1 ^ *puVar2;
      uVar1 = *(uint *)(&DAT_00bff190 + (uVar1 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_00bff590 + (uVar1 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_00bfed90 + (uVar1 >> 0x18) * 4) ^
              *(uint *)(&DAT_00bff990 + (uVar1 & 0xff) * 4) ^ puVar2[1];
      uVar1 = *(uint *)(&DAT_00bff190 + (uVar1 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_00bff590 + (uVar1 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_00bfed90 + (uVar1 >> 0x18) * 4) ^
              *(uint *)(&DAT_00bff990 + (uVar1 & 0xff) * 4) ^ puVar2[2];
      uVar1 = *(uint *)(&DAT_00bff190 + (uVar1 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_00bff590 + (uVar1 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_00bfed90 + (uVar1 >> 0x18) * 4) ^
              *(uint *)(&DAT_00bff990 + (uVar1 & 0xff) * 4) ^ puVar2[3];
      uVar1 = *(uint *)(&DAT_00bff190 + (uVar1 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_00bff590 + (uVar1 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_00bfed90 + (uVar1 >> 0x18) * 4) ^
              *(uint *)(&DAT_00bff990 + (uVar1 & 0xff) * 4) ^ puVar2[4];
      uVar1 = *(uint *)(&DAT_00bff190 + (uVar1 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_00bff590 + (uVar1 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_00bfed90 + (uVar1 >> 0x18) * 4) ^
              *(uint *)(&DAT_00bff990 + (uVar1 & 0xff) * 4) ^ puVar2[5];
      uVar1 = *(uint *)(&DAT_00bff190 + (uVar1 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_00bff590 + (uVar1 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_00bfed90 + (uVar1 >> 0x18) * 4) ^
              *(uint *)(&DAT_00bff990 + (uVar1 & 0xff) * 4) ^ puVar2[6];
      in_ECX = puVar2 + 8;
      param_1 = param_1 - 0x20;
      uVar1 = *(uint *)(&DAT_00bff190 + (uVar1 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_00bff590 + (uVar1 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_00bfed90 + (uVar1 >> 0x18) * 4) ^
              *(uint *)(&DAT_00bff990 + (uVar1 & 0xff) * 4) ^ puVar2[7];
      uVar1 = *(uint *)(&DAT_00bff190 + (uVar1 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_00bff590 + (uVar1 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_00bfed90 + (uVar1 >> 0x18) * 4) ^
              *(uint *)(&DAT_00bff990 + (uVar1 & 0xff) * 4);
      uVar3 = uVar3 - 1;
      puVar2 = in_ECX;
    } while (uVar3 != 0);
  }
  if (3 < param_1) {
    uVar3 = param_1 >> 2;
    do {
      uVar1 = uVar1 ^ *in_ECX;
      in_ECX = in_ECX + 1;
      uVar1 = *(uint *)(&DAT_00bff190 + (uVar1 >> 0x10 & 0xff) * 4) ^
              *(uint *)(&DAT_00bff590 + (uVar1 >> 8 & 0xff) * 4) ^
              *(uint *)(&DAT_00bfed90 + (uVar1 >> 0x18) * 4) ^
              *(uint *)(&DAT_00bff990 + (uVar1 & 0xff) * 4);
      param_1 = param_1 - 4;
      uVar3 = uVar3 - 1;
    } while (uVar3 != 0);
  }
  for (; param_1 != 0; param_1 = param_1 - 1) {
    uVar1 = uVar1 >> 8 ^ *(uint *)(&DAT_00bfed90 + (((byte)*in_ECX ^ uVar1) & 0xff) * 4);
    in_ECX = (uint *)((int)in_ECX + 1);
  }
  return ~uVar1;
}



============================================================
DISASSEMBLY
============================================================
00712d10 : PUSH EBP
00712d11 : MOV EBP,ESP
00712d13 : PUSH ESI
00712d14 : MOV ESI,dword ptr [EBP + 0x8]
00712d17 : NOT EAX
00712d19 : TEST ESI,ESI
00712d1b : JZ 0x00712d40
00712d1d : LEA ECX,[ECX]
00712d20 : TEST CL,0x3
00712d23 : JZ 0x00712d40
00712d25 : MOVZX EDX,byte ptr [ECX]
00712d28 : XOR EDX,EAX
00712d2a : AND EDX,0xff
00712d30 : SHR EAX,0x8
00712d33 : XOR EAX,dword ptr [EDX*0x4 + 0xbfed90]
00712d3a : INC ECX
00712d3b : SUB ESI,0x1
00712d3e : JNZ 0x00712d20
00712d40 : PUSH EBX
00712d41 : PUSH EDI
00712d42 : CMP ESI,0x20
00712d45 : JC 0x00712f6b
00712d4b : MOV EDI,ESI
00712d4d : SHR EDI,0x5
00712d50 : XOR EAX,dword ptr [ECX]
00712d52 : ADD ECX,0x4
00712d55 : MOV EDX,EAX
00712d57 : SHR EDX,0x10
00712d5a : MOV EBX,EAX
00712d5c : SHR EBX,0x8
00712d5f : AND EDX,0xff
00712d65 : MOV EDX,dword ptr [EDX*0x4 + 0xbff190]
00712d6c : AND EBX,0xff
00712d72 : XOR EDX,dword ptr [EBX*0x4 + 0xbff590]
00712d79 : MOV EBX,EAX
00712d7b : SHR EBX,0x18
00712d7e : XOR EDX,dword ptr [EBX*0x4 + 0xbfed90]
00712d85 : AND EAX,0xff
00712d8a : XOR EDX,dword ptr [EAX*0x4 + 0xbff990]
00712d91 : ADD ECX,0x4
00712d94 : XOR EDX,dword ptr [ECX + -0x4]
00712d97 : ADD ECX,0x4
00712d9a : MOV EAX,EDX
00712d9c : SHR EAX,0x10
00712d9f : MOV EBX,EDX
00712da1 : SHR EBX,0x8
00712da4 : AND EAX,0xff
00712da9 : MOV EAX,dword ptr [EAX*0x4 + 0xbff190]
00712db0 : AND EBX,0xff
00712db6 : XOR EAX,dword ptr [EBX*0x4 + 0xbff590]
00712dbd : MOV EBX,EDX
00712dbf : SHR EBX,0x18
00712dc2 : XOR EAX,dword ptr [EBX*0x4 + 0xbfed90]
00712dc9 : AND EDX,0xff
00712dcf : XOR EAX,dword ptr [EDX*0x4 + 0xbff990]
00712dd6 : ADD ECX,0x4
00712dd9 : XOR EAX,dword ptr [ECX + -0x8]
00712ddc : ADD ECX,0x4
00712ddf : MOV EDX,EAX
00712de1 : SHR EDX,0x10
00712de4 : MOV EBX,EAX
00712de6 : AND EDX,0xff
00712dec : MOV EDX,dword ptr [EDX*0x4 + 0xbff190]
00712df3 : SHR EBX,0x8
00712df6 : AND EBX,0xff
00712dfc : XOR EDX,dword ptr [EBX*0x4 + 0xbff590]
00712e03 : MOV EBX,EAX
00712e05 : SHR EBX,0x18
00712e08 : XOR EDX,dword ptr [EBX*0x4 + 0xbfed90]
00712e0f : AND EAX,0xff
00712e14 : XOR EDX,dword ptr [EAX*0x4 + 0xbff990]
00712e1b : ADD ECX,0x4
00712e1e : XOR EDX,dword ptr [ECX + -0xc]
00712e21 : MOV EAX,EDX
00712e23 : SHR EAX,0x10
00712e26 : MOV EBX,EDX
00712e28 : SHR EBX,0x8
00712e2b : AND EAX,0xff
00712e30 : MOV EAX,dword ptr [EAX*0x4 + 0xbff190]
00712e37 : AND EBX,0xff
00712e3d : XOR EAX,dword ptr [EBX*0x4 + 0xbff590]
00712e44 : MOV EBX,EDX
00712e46 : SHR EBX,0x18
00712e49 : XOR EAX,dword ptr [EBX*0x4 + 0xbfed90]
00712e50 : AND EDX,0xff
00712e56 : XOR EAX,dword ptr [EDX*0x4 + 0xbff990]
00712e5d : XOR EAX,dword ptr [ECX + -0x8]
00712e60 : MOV EDX,EAX
00712e62 : SHR EDX,0x10
00712e65 : MOV EBX,EAX
00712e67 : AND EDX,0xff
00712e6d : MOV EDX,dword ptr [EDX*0x4 + 0xbff190]
00712e74 : SHR EBX,0x8
00712e77 : AND EBX,0xff
00712e7d : XOR EDX,dword ptr [EBX*0x4 + 0xbff590]
00712e84 : MOV EBX,EAX
00712e86 : SHR EBX,0x18
00712e89 : XOR EDX,dword ptr [EBX*0x4 + 0xbfed90]
00712e90 : AND EAX,0xff
00712e95 : XOR EDX,dword ptr [EAX*0x4 + 0xbff990]
00712e9c : XOR EDX,dword ptr [ECX + -0x4]
00712e9f : MOV EAX,EDX
00712ea1 : SHR EAX,0x10
00712ea4 : AND EAX,0xff
00712ea9 : MOV EBX,EDX
00712eab : MOV EAX,dword ptr [EAX*0x4 + 0xbff190]
00712eb2 : SHR EBX,0x8
00712eb5 : AND EBX,0xff
00712ebb : XOR EAX,dword ptr [EBX*0x4 + 0xbff590]
00712ec2 : MOV EBX,EDX
00712ec4 : SHR EBX,0x18
00712ec7 : XOR EAX,dword ptr [EBX*0x4 + 0xbfed90]
00712ece : AND EDX,0xff
00712ed4 : XOR EAX,dword ptr [EDX*0x4 + 0xbff990]
00712edb : ADD ECX,0x4
00712ede : XOR EAX,dword ptr [ECX + -0x4]
00712ee1 : ADD ECX,0x4
00712ee4 : MOV EDX,EAX
00712ee6 : MOV EBX,EAX
00712ee8 : SHR EDX,0x10
00712eeb : SHR EBX,0x8
00712eee : AND EDX,0xff
00712ef4 : MOV EDX,dword ptr [EDX*0x4 + 0xbff190]
00712efb : AND EBX,0xff
00712f01 : XOR EDX,dword ptr [EBX*0x4 + 0xbff590]
00712f08 : MOV EBX,EAX
00712f0a : SHR EBX,0x18
00712f0d : XOR EDX,dword ptr [EBX*0x4 + 0xbfed90]
00712f14 : AND EAX,0xff
00712f19 : XOR EDX,dword ptr [EAX*0x4 + 0xbff990]
00712f20 : SUB ESI,0x20
00712f23 : XOR EDX,dword ptr [ECX + -0x4]
00712f26 : MOV EAX,EDX
00712f28 : SHR EAX,0x10
00712f2b : AND EAX,0xff
00712f30 : MOV EAX,dword ptr [EAX*0x4 + 0xbff190]
00712f37 : MOV EBX,EDX
00712f39 : SHR EBX,0x8
00712f3c : AND EBX,0xff
00712f42 : XOR EAX,dword ptr [EBX*0x4 + 0xbff590]
00712f49 : MOV EBX,EDX
00712f4b : SHR EBX,0x18
00712f4e : XOR EAX,dword ptr [EBX*0x4 + 0xbfed90]
00712f55 : AND EDX,0xff
00712f5b : XOR EAX,dword ptr [EDX*0x4 + 0xbff990]
00712f62 : SUB EDI,0x1
00712f65 : JNZ 0x00712d50
00712f6b : CMP ESI,0x4
00712f6e : JC 0x00712fc0
00712f70 : MOV EDX,ESI
00712f72 : SHR EDX,0x2
00712f75 : XOR EAX,dword ptr [ECX]
00712f77 : ADD ECX,0x4
00712f7a : MOV EDI,EAX
00712f7c : SHR EDI,0x10
00712f7f : AND EDI,0xff
00712f85 : MOV EDI,dword ptr [EDI*0x4 + 0xbff190]
00712f8c : MOV EBX,EAX
00712f8e : SHR EBX,0x8
00712f91 : AND EBX,0xff
00712f97 : XOR EDI,dword ptr [EBX*0x4 + 0xbff590]
00712f9e : MOV EBX,EAX
00712fa0 : SHR EBX,0x18
00712fa3 : XOR EDI,dword ptr [EBX*0x4 + 0xbfed90]
00712faa : AND EAX,0xff
00712faf : XOR EDI,dword ptr [EAX*0x4 + 0xbff990]
00712fb6 : SUB ESI,0x4
00712fb9 : SUB EDX,0x1
00712fbc : MOV EAX,EDI
00712fbe : JNZ 0x00712f75
00712fc0 : POP EDI
00712fc1 : POP EBX
00712fc2 : TEST ESI,ESI
00712fc4 : JZ 0x00712feb
00712fc6 : JMP 0x00712fd0
00712fd0 : MOVZX EDX,byte ptr [ECX]
00712fd3 : XOR EDX,EAX
00712fd5 : AND EDX,0xff
00712fdb : SHR EAX,0x8
00712fde : XOR EAX,dword ptr [EDX*0x4 + 0xbfed90]
00712fe5 : INC ECX
00712fe6 : SUB ESI,0x1
00712fe9 : JNZ 0x00712fd0
00712feb : NOT EAX
00712fed : POP ESI
00712fee : POP EBP
00712fef : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_009ab000
ENTRY    : 009ab000
BODY     : [[009ab000, 009ab18c] [009ab190, 009ab2f7]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009ab000(int param_1,undefined4 param_2)

{
  wchar_t wVar1;
  uint uVar2;
  undefined4 uVar3;
  int iVar4;
  wchar_t *pwVar5;
  int *in_ECX;
  wchar_t *pwVar6;
  wchar_t *pwVar7;
  bool bVar8;
  undefined1 local_60 [4];
  int local_5c;
  undefined1 local_50 [4];
  undefined2 local_4c;
  undefined4 local_3c;
  uint local_38;
  undefined1 local_34 [4];
  undefined2 local_30;
  undefined4 local_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b4b017;
  local_14 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xffffff90;
  ExceptionList = &local_14;
  local_38 = 7;
  local_3c = 0;
  local_4c = 0;
  FUN_00406360(&DAT_00c8b138,1);
  local_c = 0;
  uVar3 = FUN_00403dd0(param_2,uVar2);
  local_c._0_1_ = 1;
  FUN_0070cd60(local_60,uVar3,local_50,0);
  local_c = CONCAT31(local_c._1_3_,3);
  if (7 < local_1c) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_1c = 7;
  local_20 = 0;
  local_30 = 0;
  local_c._0_1_ = 4;
  if (7 < local_38) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_38 = 7;
  local_3c = 0;
  local_4c = 0;
  if (*DAT_00da9894 == 0) {
    local_c = 0xffffffff;
    if (local_5c == 0) {
      ExceptionList = local_14;
      return;
    }
    FUN_00405450(in_ECX);
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  if (*(int *)(*DAT_00da9894 + 0x114) != 0) {
    uVar2 = *(uint *)(param_1 + 0x18);
    pwVar5 = (wchar_t *)(param_1 + 4);
    pwVar7 = pwVar5;
    if (7 < uVar2) {
      pwVar7 = *(wchar_t **)pwVar5;
    }
    pwVar6 = L"onInit";
    do {
      wVar1 = *pwVar7;
      bVar8 = (ushort)wVar1 < (ushort)*pwVar6;
      if (wVar1 != *pwVar6) {
LAB_009ab16e:
        iVar4 = (1 - (uint)bVar8) - (uint)(bVar8 != 0);
        goto LAB_009ab173;
      }
      if (wVar1 == L'\0') break;
      wVar1 = pwVar7[1];
      bVar8 = (ushort)wVar1 < (ushort)pwVar6[1];
      if (wVar1 != pwVar6[1]) goto LAB_009ab16e;
      pwVar7 = pwVar7 + 2;
      pwVar6 = pwVar6 + 2;
    } while (wVar1 != L'\0');
    iVar4 = 0;
LAB_009ab173:
    if (iVar4 != 0) {
      pwVar7 = pwVar5;
      if (7 < uVar2) {
        pwVar7 = *(wchar_t **)pwVar5;
      }
      pwVar6 = L"onOpen";
      do {
        wVar1 = *pwVar7;
        bVar8 = (ushort)wVar1 < (ushort)*pwVar6;
        if (wVar1 != *pwVar6) {
LAB_009ab1b6:
          iVar4 = (1 - (uint)bVar8) - (uint)(bVar8 != 0);
          goto LAB_009ab1bb;
        }
        if (wVar1 == L'\0') break;
        wVar1 = pwVar7[1];
        bVar8 = (ushort)wVar1 < (ushort)pwVar6[1];
        if (wVar1 != pwVar6[1]) goto LAB_009ab1b6;
        pwVar7 = pwVar7 + 2;
        pwVar6 = pwVar6 + 2;
      } while (wVar1 != L'\0');
      iVar4 = 0;
LAB_009ab1bb:
      if (iVar4 == 0) {
        (**(code **)(*in_ECX + 0x18))(0,300);
      }
      else {
        pwVar7 = pwVar5;
        if (7 < uVar2) {
          pwVar7 = *(wchar_t **)pwVar5;
        }
        pwVar6 = L"onClose";
        do {
          wVar1 = *pwVar7;
          bVar8 = (ushort)wVar1 < (ushort)*pwVar6;
          if (wVar1 != *pwVar6) {
LAB_009ab20b:
            iVar4 = (1 - (uint)bVar8) - (uint)(bVar8 != 0);
            goto LAB_009ab210;
          }
          if (wVar1 == L'\0') break;
          wVar1 = pwVar7[1];
          bVar8 = (ushort)wVar1 < (ushort)pwVar6[1];
          if (wVar1 != pwVar6[1]) goto LAB_009ab20b;
          pwVar7 = pwVar7 + 2;
          pwVar6 = pwVar6 + 2;
        } while (wVar1 != L'\0');
        iVar4 = 0;
LAB_009ab210:
        if (iVar4 == 0) {
          (**(code **)(*in_ECX + 0x20))();
        }
        else {
          if (7 < uVar2) {
            pwVar5 = *(wchar_t **)pwVar5;
          }
          pwVar7 = L"onForceInit";
          do {
            wVar1 = *pwVar5;
            bVar8 = (ushort)wVar1 < (ushort)*pwVar7;
            if (wVar1 != *pwVar7) {
LAB_009ab25a:
              iVar4 = (1 - (uint)bVar8) - (uint)(bVar8 != 0);
              goto LAB_009ab25f;
            }
            if (wVar1 == L'\0') break;
            wVar1 = pwVar5[1];
            bVar8 = (ushort)wVar1 < (ushort)pwVar7[1];
            if (wVar1 != pwVar7[1]) goto LAB_009ab25a;
            pwVar5 = pwVar5 + 2;
            pwVar7 = pwVar7 + 2;
          } while (wVar1 != L'\0');
          iVar4 = 0;
LAB_009ab25f:
          if (iVar4 == 0) {
            FUN_00406460(L"IDS_DAMAGEMETER_INIT");
            local_c._0_1_ = 5;
            uVar3 = FUN_0081d120(local_34);
            local_c._0_1_ = 6;
            iVar4 = FUN_008ede80(uVar3,2);
            local_c._0_1_ = 5;
            FUN_00406560();
            local_c = CONCAT31(local_c._1_3_,4);
            FUN_00406560();
            if (iVar4 != 0) {
              if (*(code **)(iVar4 + 0x60) != (code *)0x0) {
                (**(code **)(iVar4 + 0x60))(1,iVar4);
              }
              *(code **)(iVar4 + 0x60) = FUN_009aafd0;
            }
          }
        }
      }
    }
  }
  local_c = 0xffffffff;
  FUN_004042c0();
  ExceptionList = local_14;
  return;
}



============================================================
DISASSEMBLY
============================================================
009ab000 : PUSH EBP
009ab001 : MOV EBP,ESP
009ab003 : AND ESP,0xfffffff8
009ab006 : PUSH -0x1
009ab008 : PUSH 0xb4b017
009ab00d : MOV EAX,FS:[0x0]
009ab013 : PUSH EAX
009ab014 : SUB ESP,0x50
009ab017 : PUSH EBX
009ab018 : PUSH ESI
009ab019 : PUSH EDI
009ab01a : MOV EAX,[0x00d66fa0]
009ab01f : XOR EAX,ESP
009ab021 : PUSH EAX
009ab022 : LEA EAX,[ESP + 0x60]
009ab026 : MOV FS:[0x0],EAX
009ab02c : MOV dword ptr [ESP + 0x10],ECX
009ab030 : PUSH 0x1
009ab032 : XOR EAX,EAX
009ab034 : MOV EDI,0x7
009ab039 : XOR EBX,EBX
009ab03b : PUSH 0xc8b138
009ab040 : LEA ECX,[ESP + 0x2c]
009ab044 : MOV dword ptr [ESP + 0x44],EDI
009ab048 : MOV dword ptr [ESP + 0x40],EBX
009ab04c : MOV word ptr [ESP + 0x30],AX
009ab051 : CALL 0x00406360
009ab056 : MOV dword ptr [ESP + 0x68],EBX
009ab05a : MOV ECX,dword ptr [EBP + 0xc]
009ab05d : PUSH ECX
009ab05e : LEA ESI,[ESP + 0x44]
009ab062 : CALL 0x00403dd0
009ab067 : ADD ESP,0x4
009ab06a : MOV byte ptr [ESP + 0x68],0x1
009ab06f : PUSH EBX
009ab070 : LEA EDX,[ESP + 0x28]
009ab074 : PUSH EDX
009ab075 : PUSH EAX
009ab076 : LEA EAX,[ESP + 0x20]
009ab07a : PUSH EAX
009ab07b : CALL 0x0070cd60
009ab080 : ADD ESP,0x10
009ab083 : MOV byte ptr [ESP + 0x68],0x3
009ab088 : MOV ESI,0x8
009ab08d : CMP dword ptr [ESP + 0x58],ESI
009ab091 : JC 0x009ab09c
009ab093 : MOV ECX,dword ptr [ESP + 0x44]
009ab097 : CALL 0x006f04e0
009ab09c : XOR ECX,ECX
009ab09e : MOV dword ptr [ESP + 0x58],EDI
009ab0a2 : MOV dword ptr [ESP + 0x54],EBX
009ab0a6 : MOV word ptr [ESP + 0x44],CX
009ab0ab : MOV byte ptr [ESP + 0x68],0x4
009ab0b0 : CMP dword ptr [ESP + 0x3c],ESI
009ab0b4 : JC 0x009ab0bf
009ab0b6 : MOV ECX,dword ptr [ESP + 0x28]
009ab0ba : CALL 0x006f04e0
009ab0bf : MOV EAX,[0x00da9894]
009ab0c4 : XOR EDX,EDX
009ab0c6 : MOV dword ptr [ESP + 0x3c],EDI
009ab0ca : MOV dword ptr [ESP + 0x38],EBX
009ab0ce : MOV word ptr [ESP + 0x28],DX
009ab0d3 : MOV EAX,dword ptr [EAX]
009ab0d5 : CMP EAX,EBX
009ab0d7 : JNZ 0x009ab124
009ab0d9 : MOV dword ptr [ESP + 0x68],0xffffffff
009ab0e1 : MOV EAX,dword ptr [ESP + 0x18]
009ab0e5 : CMP EAX,EBX
009ab0e7 : JZ 0x009ab103
009ab0e9 : MOV ECX,dword ptr [ESP + 0x10]
009ab0ed : MOV EDI,dword ptr [ESP + 0x1c]
009ab0f1 : PUSH ECX
009ab0f2 : CALL 0x00405450
009ab0f7 : MOV ECX,dword ptr [ESP + 0x1c]
009ab0fb : ADD ESP,0x4
009ab0fe : CALL 0x006f04e0
009ab103 : MOV dword ptr [ESP + 0x18],EBX
009ab107 : MOV dword ptr [ESP + 0x1c],EBX
009ab10b : MOV dword ptr [ESP + 0x20],EBX
009ab10f : MOV ECX,dword ptr [ESP + 0x60]
009ab113 : MOV dword ptr FS:[0x0],ECX
009ab11a : POP ECX
009ab11b : POP EDI
009ab11c : POP ESI
009ab11d : POP EBX
009ab11e : MOV ESP,EBP
009ab120 : POP EBP
009ab121 : RET 0x8
009ab124 : CMP dword ptr [EAX + 0x114],EBX
009ab12a : JZ 0x009ab2d2
009ab130 : MOV EAX,dword ptr [EBP + 0x8]
009ab133 : MOV EDI,dword ptr [EAX + 0x18]
009ab136 : CMP EDI,ESI
009ab138 : LEA ESI,[EAX + 0x4]
009ab13b : JC 0x009ab141
009ab13d : MOV EAX,dword ptr [ESI]
009ab13f : JMP 0x009ab143
009ab141 : MOV EAX,ESI
009ab143 : MOV ECX,0xc8b13c
009ab148 : MOV DX,word ptr [EAX]
009ab14b : CMP DX,word ptr [ECX]
009ab14e : JNZ 0x009ab16e
009ab150 : CMP DX,BX
009ab153 : JZ 0x009ab16a
009ab155 : MOV DX,word ptr [EAX + 0x2]
009ab159 : CMP DX,word ptr [ECX + 0x2]
009ab15d : JNZ 0x009ab16e
009ab15f : ADD EAX,0x4
009ab162 : ADD ECX,0x4
009ab165 : CMP DX,BX
009ab168 : JNZ 0x009ab148
009ab16a : XOR EAX,EAX
009ab16c : JMP 0x009ab173
009ab16e : SBB EAX,EAX
009ab170 : SBB EAX,-0x1
009ab173 : CMP EAX,EBX
009ab175 : JZ 0x009ab2d2
009ab17b : CMP EDI,0x8
009ab17e : JC 0x009ab184
009ab180 : MOV EAX,dword ptr [ESI]
009ab182 : JMP 0x009ab186
009ab184 : MOV EAX,ESI
009ab186 : MOV ECX,0xc8b14c
009ab18b : JMP 0x009ab190
009ab190 : MOV DX,word ptr [EAX]
009ab193 : CMP DX,word ptr [ECX]
009ab196 : JNZ 0x009ab1b6
009ab198 : CMP DX,BX
009ab19b : JZ 0x009ab1b2
009ab19d : MOV DX,word ptr [EAX + 0x2]
009ab1a1 : CMP DX,word ptr [ECX + 0x2]
009ab1a5 : JNZ 0x009ab1b6
009ab1a7 : ADD EAX,0x4
009ab1aa : ADD ECX,0x4
009ab1ad : CMP DX,BX
009ab1b0 : JNZ 0x009ab190
009ab1b2 : XOR EAX,EAX
009ab1b4 : JMP 0x009ab1bb
009ab1b6 : SBB EAX,EAX
009ab1b8 : SBB EAX,-0x1
009ab1bb : CMP EAX,EBX
009ab1bd : JNZ 0x009ab1d5
009ab1bf : MOV ECX,dword ptr [ESP + 0x10]
009ab1c3 : MOV EDX,dword ptr [ECX]
009ab1c5 : MOV EAX,dword ptr [EDX + 0x18]
009ab1c8 : PUSH 0x12c
009ab1cd : PUSH EBX
009ab1ce : CALL EAX
009ab1d0 : JMP 0x009ab2d2
009ab1d5 : CMP EDI,0x8
009ab1d8 : JC 0x009ab1de
009ab1da : MOV EAX,dword ptr [ESI]
009ab1dc : JMP 0x009ab1e0
009ab1de : MOV EAX,ESI
009ab1e0 : MOV ECX,0xc8b15c
009ab1e5 : MOV DX,word ptr [EAX]
009ab1e8 : CMP DX,word ptr [ECX]
009ab1eb : JNZ 0x009ab20b
009ab1ed : CMP DX,BX
009ab1f0 : JZ 0x009ab207
009ab1f2 : MOV DX,word ptr [EAX + 0x2]
009ab1f6 : CMP DX,word ptr [ECX + 0x2]
009ab1fa : JNZ 0x009ab20b
009ab1fc : ADD EAX,0x4
009ab1ff : ADD ECX,0x4
009ab202 : CMP DX,BX
009ab205 : JNZ 0x009ab1e5
009ab207 : XOR EAX,EAX
009ab209 : JMP 0x009ab210
009ab20b : SBB EAX,EAX
009ab20d : SBB EAX,-0x1
009ab210 : CMP EAX,EBX
009ab212 : JNZ 0x009ab224
009ab214 : MOV ECX,dword ptr [ESP + 0x10]
009ab218 : MOV EDX,dword ptr [ECX]
009ab21a : MOV EAX,dword ptr [EDX + 0x20]
009ab21d : CALL EAX
009ab21f : JMP 0x009ab2d2
009ab224 : CMP EDI,0x8
009ab227 : JC 0x009ab22d
009ab229 : MOV EAX,dword ptr [ESI]
009ab22b : JMP 0x009ab22f
009ab22d : MOV EAX,ESI
009ab22f : MOV ECX,0xc8b16c
009ab234 : MOV DX,word ptr [EAX]
009ab237 : CMP DX,word ptr [ECX]
009ab23a : JNZ 0x009ab25a
009ab23c : CMP DX,BX
009ab23f : JZ 0x009ab256
009ab241 : MOV DX,word ptr [EAX + 0x2]
009ab245 : CMP DX,word ptr [ECX + 0x2]
009ab249 : JNZ 0x009ab25a
009ab24b : ADD EAX,0x4
009ab24e : ADD ECX,0x4
009ab251 : CMP DX,BX
009ab254 : JNZ 0x009ab234
009ab256 : XOR EAX,EAX
009ab258 : JMP 0x009ab25f
009ab25a : SBB EAX,EAX
009ab25c : SBB EAX,-0x1
009ab25f : CMP EAX,EBX
009ab261 : JNZ 0x009ab2d2
009ab263 : PUSH 0xc8b184
009ab268 : LEA ECX,[ESP + 0x44]
009ab26c : CALL 0x00406460
009ab271 : MOV BL,0x5
009ab273 : MOV byte ptr [ESP + 0x68],BL
009ab277 : LEA ECX,[ESP + 0x40]
009ab27b : PUSH ECX
009ab27c : MOV ECX,dword ptr [0x0172491c]
009ab282 : LEA EDI,[ESP + 0x28]
009ab286 : CALL 0x0081d120
009ab28b : MOV byte ptr [ESP + 0x68],0x6
009ab290 : MOV EDX,dword ptr [0x00da9894]
009ab296 : MOV ECX,dword ptr [EDX]
009ab298 : PUSH 0x2
009ab29a : PUSH EAX
009ab29b : CALL 0x008ede80
009ab2a0 : MOV ESI,EAX
009ab2a2 : MOV byte ptr [ESP + 0x68],BL
009ab2a6 : MOV ECX,EDI
009ab2a8 : CALL 0x00406560
009ab2ad : MOV byte ptr [ESP + 0x68],0x4
009ab2b2 : LEA ECX,[ESP + 0x40]
009ab2b6 : CALL 0x00406560
009ab2bb : TEST ESI,ESI
009ab2bd : JZ 0x009ab2d2
009ab2bf : MOV EAX,dword ptr [ESI + 0x60]
009ab2c2 : TEST EAX,EAX
009ab2c4 : JZ 0x009ab2cb
009ab2c6 : PUSH ESI
009ab2c7 : PUSH 0x1
009ab2c9 : CALL EAX
009ab2cb : MOV dword ptr [ESI + 0x60],0x9aafd0
009ab2d2 : MOV dword ptr [ESP + 0x68],0xffffffff
009ab2da : LEA ESI,[ESP + 0x14]
009ab2de : CALL 0x004042c0
009ab2e3 : MOV ECX,dword ptr [ESP + 0x60]
009ab2e7 : MOV dword ptr FS:[0x0],ECX
009ab2ee : POP ECX
009ab2ef : POP EDI
009ab2f0 : POP ESI
009ab2f1 : POP EBX
009ab2f2 : MOV ESP,EBP
009ab2f4 : POP EBP
009ab2f5 : RET 0x8

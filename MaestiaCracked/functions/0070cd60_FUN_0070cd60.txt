PROGRAM  : Maestia.exe
FUNCTION : FUN_0070cd60
ENTRY    : 0070cd60
BODY     : [[0070cd60, 0070cdac] [0070cdb0, 0070cefb]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_0070cd60(int param_1,undefined4 param_2,int param_3,short param_4)

{
  uint uVar1;
  int iVar2;
  undefined4 uVar3;
  int iVar4;
  undefined1 local_50 [4];
  undefined2 local_4c;
  undefined4 local_3c;
  uint local_38;
  undefined1 local_34 [4];
  undefined2 local_30;
  undefined4 local_20;
  uint local_1c;
  undefined4 local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  puStack_c = &LAB_00b3b69b;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *(undefined4 *)(param_1 + 4) = 0;
  *(undefined4 *)(param_1 + 8) = 0;
  *(undefined4 *)(param_1 + 0xc) = 0;
  local_8 = 0;
  local_18 = 1;
  local_14 = 0;
  iVar4 = 0;
  do {
    if (*(uint *)(param_3 + 0x18) < 8) {
      iVar2 = param_3 + 4;
    }
    else {
      iVar2 = *(int *)(param_3 + 4);
    }
    iVar2 = FUN_00403c70(iVar2,*(undefined4 *)(param_3 + 0x14));
    if (iVar2 == iVar4) {
      local_1c = 7;
      local_20 = 0;
      local_30 = 0;
      FUN_00406360(&DAT_00bfd5ac,0);
      local_8 = 1;
      FUN_00405ae0(local_34);
      local_8 = local_8 & 0xffffff00;
      if (7 < local_1c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0(uVar1);
      }
      local_1c = 7;
      local_20 = 0;
      local_30 = 0;
    }
    else {
      if ((iVar2 == -1) || ((param_4 != 0 && ((short)local_14 == param_4)))) {
        uVar3 = FUN_0040e420(param_2,local_50);
        local_8 = 2;
        FUN_00405ae0(uVar3);
        local_8 = local_8 & 0xffffff00;
        if (7 < local_38) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0(uVar1);
        }
        ExceptionList = local_10;
        return param_1;
      }
      uVar3 = FUN_0040e420(param_2,local_50);
      local_8 = 3;
      FUN_00405ae0(uVar3);
      local_8 = local_8 & 0xffffff00;
      if (7 < local_38) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0(uVar1);
      }
      local_38 = 7;
      local_3c = 0;
      local_4c = 0;
    }
    local_14 = local_14 + 1;
    iVar4 = iVar2 + 1;
    if (iVar2 == -1) {
      ExceptionList = local_10;
      return param_1;
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
0070cd60 : PUSH EBP
0070cd61 : MOV EBP,ESP
0070cd63 : PUSH -0x1
0070cd65 : PUSH 0xb3b69b
0070cd6a : MOV EAX,FS:[0x0]
0070cd70 : PUSH EAX
0070cd71 : SUB ESP,0x44
0070cd74 : PUSH EBX
0070cd75 : PUSH ESI
0070cd76 : PUSH EDI
0070cd77 : MOV EAX,[0x00d66fa0]
0070cd7c : XOR EAX,EBP
0070cd7e : PUSH EAX
0070cd7f : LEA EAX,[EBP + -0xc]
0070cd82 : MOV FS:[0x0],EAX
0070cd88 : XOR EBX,EBX
0070cd8a : MOV dword ptr [EBP + -0x4],EBX
0070cd8d : MOV dword ptr [EBP + -0x14],EBX
0070cd90 : MOV EAX,dword ptr [EBP + 0x8]
0070cd93 : MOV dword ptr [EAX + 0x4],EBX
0070cd96 : MOV dword ptr [EAX + 0x8],EBX
0070cd99 : MOV dword ptr [EAX + 0xc],EBX
0070cd9c : MOV dword ptr [EBP + -0x4],EBX
0070cd9f : MOV dword ptr [EBP + -0x14],0x1
0070cda6 : MOV dword ptr [EBP + -0x10],EBX
0070cda9 : XOR ESI,ESI
0070cdab : JMP 0x0070cdb0
0070cdb0 : MOV EAX,dword ptr [EBP + 0x10]
0070cdb3 : CMP dword ptr [EAX + 0x18],0x8
0070cdb7 : MOV ECX,dword ptr [EAX + 0x14]
0070cdba : JC 0x0070cdc1
0070cdbc : MOV EAX,dword ptr [EAX + 0x4]
0070cdbf : JMP 0x0070cdc4
0070cdc1 : ADD EAX,0x4
0070cdc4 : PUSH ECX
0070cdc5 : PUSH EAX
0070cdc6 : MOV EAX,dword ptr [EBP + 0xc]
0070cdc9 : MOV EDX,ESI
0070cdcb : CALL 0x00403c70
0070cdd0 : MOV EDI,EAX
0070cdd2 : CMP EDI,ESI
0070cdd4 : JNZ 0x0070ce27
0070cdd6 : PUSH EBX
0070cdd7 : XOR EAX,EAX
0070cdd9 : MOV ESI,0x7
0070cdde : PUSH 0xbfd5ac
0070cde3 : LEA ECX,[EBP + -0x30]
0070cde6 : MOV dword ptr [EBP + -0x18],ESI
0070cde9 : MOV dword ptr [EBP + -0x1c],EBX
0070cdec : MOV word ptr [EBP + -0x2c],AX
0070cdf0 : CALL 0x00406360
0070cdf5 : MOV dword ptr [EBP + -0x4],0x1
0070cdfc : MOV EAX,dword ptr [EBP + 0x8]
0070cdff : LEA ECX,[EBP + -0x30]
0070ce02 : PUSH ECX
0070ce03 : CALL 0x00405ae0
0070ce08 : MOV byte ptr [EBP + -0x4],BL
0070ce0b : CMP dword ptr [EBP + -0x18],0x8
0070ce0f : JC 0x0070ce19
0070ce11 : MOV ECX,dword ptr [EBP + -0x2c]
0070ce14 : CALL 0x006f04e0
0070ce19 : XOR EDX,EDX
0070ce1b : MOV dword ptr [EBP + -0x18],ESI
0070ce1e : MOV dword ptr [EBP + -0x1c],EBX
0070ce21 : MOV word ptr [EBP + -0x2c],DX
0070ce25 : JMP 0x0070ce7f
0070ce27 : CMP EDI,-0x1
0070ce2a : JZ 0x0070cea3
0070ce2c : MOV AX,word ptr [EBP + 0x14]
0070ce30 : CMP AX,BX
0070ce33 : JZ 0x0070ce3b
0070ce35 : CMP word ptr [EBP + -0x10],AX
0070ce39 : JZ 0x0070cea3
0070ce3b : MOV EDX,dword ptr [EBP + 0xc]
0070ce3e : LEA EAX,[EBP + -0x4c]
0070ce41 : PUSH EAX
0070ce42 : MOV ECX,EDI
0070ce44 : PUSH EDX
0070ce45 : SUB ECX,ESI
0070ce47 : MOV EDX,ESI
0070ce49 : CALL 0x0040e420
0070ce4e : MOV dword ptr [EBP + -0x4],0x3
0070ce55 : PUSH EAX
0070ce56 : MOV EAX,dword ptr [EBP + 0x8]
0070ce59 : CALL 0x00405ae0
0070ce5e : MOV byte ptr [EBP + -0x4],BL
0070ce61 : CMP dword ptr [EBP + -0x34],0x8
0070ce65 : JC 0x0070ce6f
0070ce67 : MOV ECX,dword ptr [EBP + -0x48]
0070ce6a : CALL 0x006f04e0
0070ce6f : XOR EAX,EAX
0070ce71 : MOV dword ptr [EBP + -0x34],0x7
0070ce78 : MOV dword ptr [EBP + -0x38],EBX
0070ce7b : MOV word ptr [EBP + -0x48],AX
0070ce7f : INC dword ptr [EBP + -0x10]
0070ce82 : LEA ESI,[EDI + 0x1]
0070ce85 : CMP EDI,-0x1
0070ce88 : JNZ 0x0070cdb0
0070ce8e : MOV EAX,dword ptr [EBP + 0x8]
0070ce91 : MOV ECX,dword ptr [EBP + -0xc]
0070ce94 : MOV dword ptr FS:[0x0],ECX
0070ce9b : POP ECX
0070ce9c : POP EDI
0070ce9d : POP ESI
0070ce9e : POP EBX
0070ce9f : MOV ESP,EBP
0070cea1 : POP EBP
0070cea2 : RET
0070cea3 : MOV EDX,dword ptr [EBP + 0xc]
0070cea6 : LEA ECX,[EBP + -0x4c]
0070cea9 : PUSH ECX
0070ceaa : PUSH EDX
0070ceab : OR ECX,0xffffffff
0070ceae : MOV EDX,ESI
0070ceb0 : CALL 0x0040e420
0070ceb5 : MOV dword ptr [EBP + -0x4],0x2
0070cebc : MOV ESI,dword ptr [EBP + 0x8]
0070cebf : PUSH EAX
0070cec0 : MOV EAX,ESI
0070cec2 : CALL 0x00405ae0
0070cec7 : MOV byte ptr [EBP + -0x4],BL
0070ceca : CMP dword ptr [EBP + -0x34],0x8
0070cece : JC 0x0070ced8
0070ced0 : MOV ECX,dword ptr [EBP + -0x48]
0070ced3 : CALL 0x006f04e0
0070ced8 : XOR EAX,EAX
0070ceda : MOV word ptr [EBP + -0x48],AX
0070cede : MOV dword ptr [EBP + -0x34],0x7
0070cee5 : MOV dword ptr [EBP + -0x38],EBX
0070cee8 : MOV EAX,ESI
0070ceea : MOV ECX,dword ptr [EBP + -0xc]
0070ceed : MOV dword ptr FS:[0x0],ECX
0070cef4 : POP ECX
0070cef5 : POP EDI
0070cef6 : POP ESI
0070cef7 : POP EBX
0070cef8 : MOV ESP,EBP
0070cefa : POP EBP
0070cefb : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_005bf8d0
ENTRY    : 005bf8d0
BODY     : [[005bf8d0, 005bf9e5]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005bf8d0(int param_1)

{
  byte *pbVar1;
  char cVar2;
  undefined1 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  LONG LVar6;
  uint local_c;
  undefined4 *local_8;
  undefined4 local_4;
  
  cVar2 = FUN_00526030(0x29);
  if (cVar2 == '\0') {
    FUN_00526050("TextSnapshot",0,0);
    return;
  }
  if (((*(int *)(param_1 + 8) != 0) && (*(int *)(param_1 + 8) != 0x10)) &&
     (2 < *(int *)(param_1 + 0x1c))) {
    uVar5 = *(undefined4 *)(param_1 + 0x18);
    FUN_00526260(0);
    uVar4 = FUN_00527a80(uVar5);
    uVar5 = *(undefined4 *)(param_1 + 0x18);
    FUN_00526260(1);
    FUN_005272e0(&local_8,uVar5,0xffffffff,0);
    uVar5 = *(undefined4 *)(param_1 + 0x18);
    FUN_00526260(2);
    uVar3 = FUN_00526120(uVar5);
    local_4 = CONCAT31(local_4._1_3_,uVar3);
    FUN_0051c570(*local_8,local_8[4]);
    uVar5 = FUN_005ed530(uVar4,(local_c & 0xfffffffc) + 8,local_4);
    pbVar1 = *(byte **)(param_1 + 4);
    if (4 < *pbVar1) {
      FUN_00526400();
    }
    *pbVar1 = 4;
    *(undefined4 *)(pbVar1 + 4) = uVar5;
    LVar6 = InterlockedExchangeAdd((LONG *)((local_c & 0xfffffffc) + 4),-1);
    if (LVar6 == 1) {
      FUN_00515cf0(local_c & 0xfffffffc);
    }
    local_8[2] = local_8[2] + -1;
    if (local_8[2] == 0) {
      FUN_00525340();
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005bf8d0 : SUB ESP,0xc
005bf8d3 : PUSH ESI
005bf8d4 : MOV ESI,dword ptr [ESP + 0x14]
005bf8d8 : PUSH 0x29
005bf8da : MOV ECX,ESI
005bf8dc : CALL 0x00526030
005bf8e1 : TEST AL,AL
005bf8e3 : JNZ 0x005bf8fa
005bf8e5 : PUSH 0x0
005bf8e7 : PUSH 0x0
005bf8e9 : PUSH 0xb8fd10
005bf8ee : MOV ECX,ESI
005bf8f0 : CALL 0x00526050
005bf8f5 : POP ESI
005bf8f6 : ADD ESP,0xc
005bf8f9 : RET
005bf8fa : PUSH EBP
005bf8fb : MOV EBP,dword ptr [ESI + 0x8]
005bf8fe : TEST EBP,EBP
005bf900 : JZ 0x005bf9e0
005bf906 : ADD EBP,-0x10
005bf909 : JZ 0x005bf9e0
005bf90f : CMP dword ptr [ESI + 0x1c],0x3
005bf913 : JL 0x005bf9e0
005bf919 : MOV EAX,dword ptr [ESI + 0x18]
005bf91c : PUSH EBX
005bf91d : PUSH EDI
005bf91e : PUSH EAX
005bf91f : PUSH 0x0
005bf921 : MOV ECX,ESI
005bf923 : CALL 0x00526260
005bf928 : MOV ECX,EAX
005bf92a : CALL 0x00527a80
005bf92f : MOV EBX,dword ptr [ESI + 0x18]
005bf932 : PUSH 0x1
005bf934 : MOV ECX,ESI
005bf936 : MOV EDI,EAX
005bf938 : CALL 0x00526260
005bf93d : PUSH 0x0
005bf93f : PUSH -0x1
005bf941 : PUSH EBX
005bf942 : LEA ECX,[ESP + 0x20]
005bf946 : PUSH ECX
005bf947 : MOV ECX,EAX
005bf949 : CALL 0x005272e0
005bf94e : MOV EDX,dword ptr [ESI + 0x18]
005bf951 : PUSH EDX
005bf952 : PUSH 0x2
005bf954 : MOV ECX,ESI
005bf956 : CALL 0x00526260
005bf95b : MOV ECX,EAX
005bf95d : CALL 0x00526120
005bf962 : MOV byte ptr [ESP + 0x18],AL
005bf966 : MOV EAX,dword ptr [ESP + 0x14]
005bf96a : MOV ECX,dword ptr [EAX + 0x10]
005bf96d : MOV EDX,dword ptr [EAX]
005bf96f : PUSH ECX
005bf970 : PUSH EDX
005bf971 : LEA ECX,[ESP + 0x18]
005bf975 : CALL 0x0051c570
005bf97a : MOV EAX,dword ptr [ESP + 0x10]
005bf97e : MOV ECX,dword ptr [ESP + 0x18]
005bf982 : AND EAX,0xfffffffc
005bf985 : PUSH ECX
005bf986 : ADD EAX,0x8
005bf989 : PUSH EAX
005bf98a : PUSH EDI
005bf98b : LEA ECX,[EBP + 0x30]
005bf98e : CALL 0x005ed530
005bf993 : MOV ESI,dword ptr [ESI + 0x4]
005bf996 : CMP byte ptr [ESI],0x5
005bf999 : MOV EDI,EAX
005bf99b : JC 0x005bf9a4
005bf99d : MOV ECX,ESI
005bf99f : CALL 0x00526400
005bf9a4 : MOV byte ptr [ESI],0x4
005bf9a7 : MOV dword ptr [ESI + 0x4],EDI
005bf9aa : MOV ESI,dword ptr [ESP + 0x10]
005bf9ae : AND ESI,0xfffffffc
005bf9b1 : PUSH -0x1
005bf9b3 : LEA EDX,[ESI + 0x4]
005bf9b6 : PUSH EDX
005bf9b7 : CALL dword ptr [0x00b851cc]
005bf9bd : SUB EAX,0x1
005bf9c0 : POP EDI
005bf9c1 : POP EBX
005bf9c2 : JNZ 0x005bf9ca
005bf9c4 : PUSH ESI
005bf9c5 : CALL 0x00515cf0
005bf9ca : MOV EAX,dword ptr [ESP + 0xc]
005bf9ce : DEC dword ptr [EAX + 0x8]
005bf9d1 : MOV ECX,EAX
005bf9d3 : ADD EAX,0x8
005bf9d6 : CMP dword ptr [EAX],0x0
005bf9d9 : JNZ 0x005bf9e0
005bf9db : CALL 0x00525340
005bf9e0 : POP EBP
005bf9e1 : POP ESI
005bf9e2 : ADD ESP,0xc
005bf9e5 : RET

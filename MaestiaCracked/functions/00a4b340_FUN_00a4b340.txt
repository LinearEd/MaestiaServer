PROGRAM  : Maestia.exe
FUNCTION : FUN_00a4b340
ENTRY    : 00a4b340
BODY     : [[00a4b340, 00a4b505]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Type propagation algorithm not settling */

void FUN_00a4b340(undefined4 param_1)

{
  wchar_t wVar1;
  wchar_t *pwVar2;
  undefined4 uVar3;
  int in_ECX;
  int iVar4;
  uint local_870;
  undefined1 local_86c [4];
  undefined2 local_868;
  undefined4 local_858;
  uint local_854;
  undefined4 local_850;
  undefined4 local_84c [6];
  int local_834;
  undefined1 local_82c;
  undefined8 local_82a;
  undefined8 local_822;
  wchar_t local_818;
  undefined1 local_816 [2046];
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b2672d;
  local_10 = ExceptionList;
  local_18 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_850 = param_1;
  FUN_00403d10(local_84c);
  local_8 = 0;
  pwVar2 = &local_818;
  for (iVar4 = 0x200; iVar4 != 0; iVar4 = iVar4 + -1) {
    pwVar2[0] = L'\0';
    pwVar2[1] = L'\0';
    pwVar2 = pwVar2 + 2;
  }
  _wcsncpy(&local_818,(wchar_t *)(in_ECX + 0x26),(uint)*(ushort *)(in_ECX + 0x24));
  local_84c[0] = *(undefined4 *)(in_ECX + 4);
  local_82c = *(undefined1 *)(in_ECX + 8);
  local_82a = *(undefined8 *)(in_ECX + 0x10);
  local_822 = *(undefined8 *)(in_ECX + 0x18);
  pwVar2 = &local_818;
  do {
    wVar1 = *pwVar2;
    pwVar2 = pwVar2 + 1;
  } while (wVar1 != L'\0');
  FUN_00406360(&local_818,(int)pwVar2 - (int)local_816 >> 1);
  if (local_834 == 0) {
    FUN_00406460(L"IDS_PENALTY_USER");
    local_8._0_1_ = 1;
    uVar3 = FUN_0081d120(local_86c);
    local_8._0_1_ = 2;
    FUN_00405eb0(uVar3,0,0xffffffff);
    local_8 = CONCAT31(local_8._1_3_,1);
    if (7 < local_870) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_854) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_854 = 7;
    local_858 = 0;
    local_868 = 0;
  }
  FUN_00401750(local_84c);
  local_8 = 0xffffffff;
  FUN_004427d0(local_84c);
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a4b340 : PUSH EBP
00a4b341 : MOV EBP,ESP
00a4b343 : PUSH -0x1
00a4b345 : PUSH 0xb2672d
00a4b34a : MOV EAX,FS:[0x0]
00a4b350 : PUSH EAX
00a4b351 : SUB ESP,0x878
00a4b357 : MOV EAX,[0x00d66fa0]
00a4b35c : XOR EAX,EBP
00a4b35e : MOV dword ptr [EBP + -0x14],EAX
00a4b361 : PUSH EBX
00a4b362 : PUSH ESI
00a4b363 : PUSH EDI
00a4b364 : PUSH EAX
00a4b365 : LEA EAX,[EBP + -0xc]
00a4b368 : MOV FS:[0x0],EAX
00a4b36e : MOV EAX,dword ptr [EBP + 0x8]
00a4b371 : MOV ESI,ECX
00a4b373 : LEA ECX,[EBP + 0xfffff7b8]
00a4b379 : PUSH ECX
00a4b37a : MOV dword ptr [EBP + 0xfffff7b4],EAX
00a4b380 : CALL 0x00403d10
00a4b385 : XOR EBX,EBX
00a4b387 : MOV dword ptr [EBP + -0x4],EBX
00a4b38a : XOR EAX,EAX
00a4b38c : MOVZX EDX,AX
00a4b38f : MOV EAX,EDX
00a4b391 : SHL EDX,0x10
00a4b394 : OR EAX,EDX
00a4b396 : MOV ECX,0x200
00a4b39b : LEA EDI,[EBP + 0xfffff7ec]
00a4b3a1 : STOSD.REP ES:EDI
00a4b3a3 : MOVZX EAX,word ptr [ESI + 0x24]
00a4b3a7 : PUSH EAX
00a4b3a8 : LEA EAX,[ESI + 0x26]
00a4b3ab : PUSH EAX
00a4b3ac : LEA ECX,[EBP + 0xfffff7ec]
00a4b3b2 : PUSH ECX
00a4b3b3 : CALL 0x00634e39
00a4b3b8 : MOV EAX,dword ptr [ESI + 0x4]
00a4b3bb : MOV DL,byte ptr [ESI + 0x8]
00a4b3be : MOVQ XMM0,qword ptr [ESI + 0x10]
00a4b3c3 : MOV dword ptr [EBP + 0xfffff7b8],EAX
00a4b3c9 : MOVQ qword ptr [EBP + 0xfffff7da],XMM0
00a4b3d1 : MOVQ XMM0,qword ptr [ESI + 0x18]
00a4b3d6 : LEA EAX,[EBP + 0xfffff7ec]
00a4b3dc : MOV byte ptr [EBP + 0xfffff7d8],DL
00a4b3e2 : ADD ESP,0xc
00a4b3e5 : MOVQ qword ptr [EBP + 0xfffff7e2],XMM0
00a4b3ed : LEA EDX,[EAX + 0x2]
00a4b3f0 : MOV CX,word ptr [EAX]
00a4b3f3 : ADD EAX,0x2
00a4b3f6 : CMP CX,BX
00a4b3f9 : JNZ 0x00a4b3f0
00a4b3fb : SUB EAX,EDX
00a4b3fd : SAR EAX,0x1
00a4b3ff : PUSH EAX
00a4b400 : LEA ECX,[EBP + 0xfffff7ec]
00a4b406 : PUSH ECX
00a4b407 : LEA ECX,[EBP + 0xfffff7bc]
00a4b40d : CALL 0x00406360
00a4b412 : CMP dword ptr [EBP + 0xfffff7d0],EBX
00a4b418 : JNZ 0x00a4b4be
00a4b41e : PUSH 0xcc9e88
00a4b423 : LEA ECX,[EBP + 0xfffff798]
00a4b429 : CALL 0x00406460
00a4b42e : MOV byte ptr [EBP + -0x4],0x1
00a4b432 : MOV ECX,dword ptr [0x0172491c]
00a4b438 : LEA EDX,[EBP + 0xfffff798]
00a4b43e : PUSH EDX
00a4b43f : LEA EDI,[EBP + 0xfffff77c]
00a4b445 : CALL 0x0081d120
00a4b44a : MOV byte ptr [EBP + -0x4],0x2
00a4b44e : PUSH -0x1
00a4b450 : PUSH EBX
00a4b451 : PUSH EAX
00a4b452 : LEA ECX,[EBP + 0xfffff7bc]
00a4b458 : CALL 0x00405eb0
00a4b45d : MOV byte ptr [EBP + -0x4],0x1
00a4b461 : MOV ESI,0x8
00a4b466 : CMP dword ptr [EBP + 0xfffff794],ESI
00a4b46c : JC 0x00a4b479
00a4b46e : MOV ECX,dword ptr [EBP + 0xfffff780]
00a4b474 : CALL 0x006f04e0
00a4b479 : MOV EDI,0x7
00a4b47e : XOR EAX,EAX
00a4b480 : MOV dword ptr [EBP + 0xfffff794],EDI
00a4b486 : MOV dword ptr [EBP + 0xfffff790],EBX
00a4b48c : MOV word ptr [EBP + 0xfffff780],AX
00a4b493 : MOV byte ptr [EBP + -0x4],BL
00a4b496 : CMP dword ptr [EBP + 0xfffff7b0],ESI
00a4b49c : JC 0x00a4b4a9
00a4b49e : MOV ECX,dword ptr [EBP + 0xfffff79c]
00a4b4a4 : CALL 0x006f04e0
00a4b4a9 : XOR ECX,ECX
00a4b4ab : MOV dword ptr [EBP + 0xfffff7b0],EDI
00a4b4b1 : MOV dword ptr [EBP + 0xfffff7ac],EBX
00a4b4b7 : MOV word ptr [EBP + 0xfffff79c],CX
00a4b4be : MOV EAX,dword ptr [EBP + 0xfffff7b4]
00a4b4c4 : LEA EDX,[EBP + 0xfffff7b8]
00a4b4ca : PUSH EDX
00a4b4cb : ADD EAX,0x130
00a4b4d0 : CALL 0x00401750
00a4b4d5 : MOV dword ptr [EBP + -0x4],0xffffffff
00a4b4dc : LEA EAX,[EBP + 0xfffff7b8]
00a4b4e2 : PUSH EAX
00a4b4e3 : CALL 0x004427d0
00a4b4e8 : MOV ECX,dword ptr [EBP + -0xc]
00a4b4eb : MOV dword ptr FS:[0x0],ECX
00a4b4f2 : POP ECX
00a4b4f3 : POP EDI
00a4b4f4 : POP ESI
00a4b4f5 : POP EBX
00a4b4f6 : MOV ECX,dword ptr [EBP + -0x14]
00a4b4f9 : XOR ECX,EBP
00a4b4fb : CALL 0x00633e6b
00a4b500 : MOV ESP,EBP
00a4b502 : POP EBP
00a4b503 : RET 0x4

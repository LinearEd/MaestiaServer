PROGRAM  : Maestia.exe
FUNCTION : FUN_00524fb0
ENTRY    : 00524fb0
BODY     : [[00524fb0, 00525069] [00525070, 005250a3]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00524fb0(undefined4 param_1,undefined4 *param_2,uint param_3)

{
  uint *puVar1;
  int *piVar2;
  int iVar3;
  int *in_ECX;
  uint uVar4;
  uint uVar5;
  int iVar6;
  
  piVar2 = (int *)*in_ECX;
  if (piVar2 == (int *)0x0) {
    iVar6 = 8;
  }
  else {
    if ((uint)(*piVar2 * 5) <= piVar2[1] * 4 + 4U) goto LAB_00524fea;
    iVar6 = piVar2[1] * 2 + 2;
  }
  FUN_005251f0(param_1,iVar6);
LAB_00524fea:
  piVar2 = (int *)*in_ECX;
  param_3 = param_3 & piVar2[1];
  *piVar2 = *piVar2 + 1;
  iVar6 = *in_ECX;
  iVar3 = *(int *)(iVar6 + 8 + param_3 * 8);
  if (iVar3 == -2) {
    *(undefined4 *)(iVar6 + 8 + param_3 * 8) = 0xffffffff;
    *(undefined4 *)(iVar6 + 0xc + param_3 * 8) = *param_2;
    return;
  }
  uVar4 = param_3;
  do {
    uVar4 = uVar4 + 1 & *(uint *)(iVar6 + 4);
  } while (*(int *)(iVar6 + 8 + uVar4 * 8) != -2);
  uVar5 = *(uint *)(*(int *)(iVar6 + 0xc + param_3 * 8) + 0xc) & *(uint *)(iVar6 + 4);
  piVar2 = (int *)(iVar6 + 8 + uVar4 * 8);
  if (uVar5 == param_3) {
    if (piVar2 != (int *)0x0) {
      *piVar2 = iVar3;
      piVar2[1] = *(int *)(iVar6 + 0xc + param_3 * 8);
    }
    *(undefined4 *)(iVar6 + 0xc + param_3 * 8) = *param_2;
    *(uint *)(iVar6 + 8 + param_3 * 8) = uVar4;
    return;
  }
  puVar1 = (uint *)(iVar6 + 8 + uVar5 * 8);
  for (uVar5 = *(uint *)(iVar6 + 8 + uVar5 * 8); uVar5 != param_3;
      uVar5 = *(uint *)(iVar6 + 8 + uVar5 * 8)) {
    uVar5 = *puVar1;
    puVar1 = (uint *)(iVar6 + 8 + uVar5 * 8);
  }
  if (piVar2 != (int *)0x0) {
    *piVar2 = iVar3;
    piVar2[1] = *(int *)(iVar6 + 0xc + param_3 * 8);
  }
  *puVar1 = uVar4;
  *(undefined4 *)(iVar6 + 0xc + param_3 * 8) = *param_2;
  *(undefined4 *)(iVar6 + 8 + param_3 * 8) = 0xffffffff;
  return;
}



============================================================
DISASSEMBLY
============================================================
00524fb0 : PUSH EBP
00524fb1 : PUSH ESI
00524fb2 : MOV ESI,ECX
00524fb4 : MOV EAX,dword ptr [ESI]
00524fb6 : TEST EAX,EAX
00524fb8 : JNZ 0x00524fc3
00524fba : MOV EAX,dword ptr [ESP + 0xc]
00524fbe : PUSH 0x8
00524fc0 : PUSH EAX
00524fc1 : JMP 0x00524fe5
00524fc3 : MOV ECX,dword ptr [EAX + 0x4]
00524fc6 : LEA EDX,[ECX*0x4 + 0x4]
00524fcd : MOV ECX,dword ptr [EAX]
00524fcf : LEA ECX,[ECX + ECX*0x4]
00524fd2 : CMP ECX,EDX
00524fd4 : JBE 0x00524fea
00524fd6 : MOV EDX,dword ptr [EAX + 0x4]
00524fd9 : MOV ECX,dword ptr [ESP + 0xc]
00524fdd : LEA EAX,[EDX + EDX*0x1 + 0x2]
00524fe1 : PUSH EAX
00524fe2 : PUSH ECX
00524fe3 : MOV ECX,ESI
00524fe5 : CALL 0x005251f0
00524fea : MOV EAX,dword ptr [ESI]
00524fec : MOV ECX,dword ptr [ESP + 0x14]
00524ff0 : AND ECX,dword ptr [EAX + 0x4]
00524ff3 : INC dword ptr [EAX]
00524ff5 : MOV EAX,dword ptr [ESI]
00524ff7 : MOV EBP,dword ptr [EAX + ECX*0x8 + 0x8]
00524ffb : MOV ESI,0xfffffffe
00525000 : CMP EBP,ESI
00525002 : JNZ 0x0052501b
00525004 : MOV EDX,dword ptr [ESP + 0x10]
00525008 : MOV dword ptr [EAX + ECX*0x8 + 0x8],0xffffffff
00525010 : MOV EDX,dword ptr [EDX]
00525012 : POP ESI
00525013 : MOV dword ptr [EAX + ECX*0x8 + 0xc],EDX
00525017 : POP EBP
00525018 : RET 0xc
0052501b : PUSH EDI
0052501c : MOV EDI,dword ptr [EAX + 0x4]
0052501f : MOV EDX,ECX
00525021 : INC EDX
00525022 : AND EDX,EDI
00525024 : CMP dword ptr [EAX + EDX*0x8 + 0x8],ESI
00525028 : JNZ 0x00525021
0052502a : MOV ESI,dword ptr [EAX + ECX*0x8 + 0xc]
0052502e : MOV ESI,dword ptr [ESI + 0xc]
00525031 : AND ESI,EDI
00525033 : PUSH EBX
00525034 : LEA EBX,[EAX + EDX*0x8 + 0x8]
00525038 : CMP ESI,ECX
0052503a : JNZ 0x0052505e
0052503c : TEST EBX,EBX
0052503e : JZ 0x00525049
00525040 : MOV dword ptr [EBX],EBP
00525042 : MOV ESI,dword ptr [EAX + ECX*0x8 + 0xc]
00525046 : MOV dword ptr [EBX + 0x4],ESI
00525049 : MOV ESI,dword ptr [ESP + 0x18]
0052504d : MOV ESI,dword ptr [ESI]
0052504f : POP EBX
00525050 : POP EDI
00525051 : MOV dword ptr [EAX + ECX*0x8 + 0xc],ESI
00525055 : POP ESI
00525056 : MOV dword ptr [EAX + ECX*0x8 + 0x8],EDX
0052505a : POP EBP
0052505b : RET 0xc
0052505e : CMP dword ptr [EAX + ESI*0x8 + 0x8],ECX
00525062 : LEA ESI,[EAX + ESI*0x8 + 0x8]
00525066 : JZ 0x0052507c
00525068 : JMP 0x00525070
00525070 : MOV ESI,dword ptr [ESI]
00525072 : CMP dword ptr [EAX + ESI*0x8 + 0x8],ECX
00525076 : LEA ESI,[EAX + ESI*0x8 + 0x8]
0052507a : JNZ 0x00525070
0052507c : TEST EBX,EBX
0052507e : JZ 0x00525089
00525080 : MOV dword ptr [EBX],EBP
00525082 : MOV EDI,dword ptr [EAX + ECX*0x8 + 0xc]
00525086 : MOV dword ptr [EBX + 0x4],EDI
00525089 : MOV dword ptr [ESI],EDX
0052508b : MOV EDX,dword ptr [ESP + 0x18]
0052508f : MOV EDX,dword ptr [EDX]
00525091 : POP EBX
00525092 : POP EDI
00525093 : POP ESI
00525094 : MOV dword ptr [EAX + ECX*0x8 + 0xc],EDX
00525098 : MOV dword ptr [EAX + ECX*0x8 + 0x8],0xffffffff
005250a0 : POP EBP
005250a1 : RET 0xc

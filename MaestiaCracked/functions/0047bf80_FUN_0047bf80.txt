PROGRAM  : Maestia.exe
FUNCTION : FUN_0047bf80
ENTRY    : 0047bf80
BODY     : [[0047bf80, 0047c0c0] [0047c0d2, 0047c1a1]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0047bf80(uint param_1,void *param_2,uint param_3)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  uint uVar6;
  uint uVar7;
  undefined8 uVar8;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  iVar3 = param_1;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7a530;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  iVar4 = *(int *)(param_1 + 4);
  if (iVar4 == 0) {
    uVar7 = 0;
  }
  else {
    uVar7 = *(int *)(param_1 + 0xc) - iVar4 >> 2;
  }
  if (param_3 != 0) {
    iVar2 = *(int *)(param_1 + 8);
    iVar4 = iVar2 - iVar4 >> 2;
    uVar6 = param_3;
    if (0x3fffffffU - iVar4 < param_3) {
      uVar8 = FUN_00452880();
      uVar6 = (uint)((ulonglong)uVar8 >> 0x20);
      iVar4 = (int)uVar8;
    }
    uVar1 = iVar4 + uVar6;
    if (uVar7 < uVar1) {
      if (0x3fffffff - (uVar7 >> 1) < uVar7) {
        param_1 = 0;
      }
      else {
        param_1 = uVar7 + (uVar7 >> 1);
      }
      if (param_1 < uVar1) {
        param_1 = uVar1;
      }
      iVar4 = FUN_004c1790();
      local_8 = 0;
      FUN_004154b0();
      FUN_00461070();
      FUN_00461070();
      local_8 = 0xffffffff;
      if (*(int *)(iVar3 + 4) == 0) {
        *(uint *)(iVar3 + 0xc) = iVar4 + param_1 * 4;
        *(uint *)(iVar3 + 8) =
             iVar4 + (param_3 + (*(int *)(iVar3 + 8) - *(int *)(iVar3 + 4) >> 2)) * 4;
        *(int *)(iVar3 + 4) = iVar4;
        ExceptionList = local_10;
        return;
      }
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    if ((uint)(iVar2 - (int)param_2 >> 2) < uVar6) {
      FUN_00461070();
      local_8 = 2;
      FUN_004154b0();
      local_8 = 0xffffffff;
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + uVar6 * 4;
    }
    else {
      uVar5 = FUN_00461070();
      *(undefined4 *)(param_1 + 8) = uVar5;
      iVar4 = (int)((iVar2 + uVar6 * -4) - (int)param_2) >> 2;
      if (0 < iVar4) {
        _memmove_s((void *)(iVar2 + iVar4 * -4),iVar4 * 4,param_2,iVar4 * 4);
      }
    }
    FUN_00422490(param_2);
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
0047bf80 : PUSH EBP
0047bf81 : MOV EBP,ESP
0047bf83 : PUSH -0x1
0047bf85 : PUSH 0xb7a530
0047bf8a : MOV EAX,FS:[0x0]
0047bf90 : PUSH EAX
0047bf91 : SUB ESP,0x14
0047bf94 : PUSH EBX
0047bf95 : PUSH ESI
0047bf96 : PUSH EDI
0047bf97 : MOV EAX,[0x00d66fa0]
0047bf9c : XOR EAX,EBP
0047bf9e : PUSH EAX
0047bf9f : LEA EAX,[EBP + -0xc]
0047bfa2 : MOV FS:[0x0],EAX
0047bfa8 : MOV dword ptr [EBP + -0x10],ESP
0047bfab : MOV EBX,dword ptr [EBP + 0x8]
0047bfae : MOV ECX,dword ptr [EBX + 0x4]
0047bfb1 : TEST ECX,ECX
0047bfb3 : JNZ 0x0047bfb9
0047bfb5 : XOR EDI,EDI
0047bfb7 : JMP 0x0047bfc3
0047bfb9 : MOV EAX,dword ptr [EBX + 0xc]
0047bfbc : SUB EAX,ECX
0047bfbe : SAR EAX,0x2
0047bfc1 : MOV EDI,EAX
0047bfc3 : MOV EDX,dword ptr [EBP + 0x10]
0047bfc6 : TEST EDX,EDX
0047bfc8 : JZ 0x0047c18e
0047bfce : MOV ESI,dword ptr [EBX + 0x8]
0047bfd1 : MOV EAX,ESI
0047bfd3 : SUB EAX,ECX
0047bfd5 : SAR EAX,0x2
0047bfd8 : MOV ECX,0x3fffffff
0047bfdd : SUB ECX,EAX
0047bfdf : CMP ECX,EDX
0047bfe1 : JNC 0x0047bfe8
0047bfe3 : CALL 0x00452880
0047bfe8 : LEA ECX,[EAX + EDX*0x1]
0047bfeb : CMP EDI,ECX
0047bfed : JNC 0x0047c0d2
0047bff3 : MOV EAX,EDI
0047bff5 : SHR EAX,0x1
0047bff7 : MOV EDX,0x3fffffff
0047bffc : SUB EDX,EAX
0047bffe : CMP EDX,EDI
0047c000 : JNC 0x0047c00e
0047c002 : MOV dword ptr [EBP + 0x8],0x0
0047c009 : MOV EDI,dword ptr [EBP + 0x8]
0047c00c : JMP 0x0047c013
0047c00e : ADD EDI,EAX
0047c010 : MOV dword ptr [EBP + 0x8],EDI
0047c013 : CMP EDI,ECX
0047c015 : JNC 0x0047c01c
0047c017 : MOV dword ptr [EBP + 0x8],ECX
0047c01a : MOV EDI,ECX
0047c01c : MOV ECX,EDI
0047c01e : CALL 0x004c1790
0047c023 : MOV dword ptr [EBP + -0x14],EAX
0047c026 : MOV ECX,dword ptr [EBP + 0xc]
0047c029 : SUB ECX,dword ptr [EBX + 0x4]
0047c02c : SAR ECX,0x2
0047c02f : MOV dword ptr [EBP + -0x1c],ECX
0047c032 : MOV dword ptr [EBP + -0x4],0x0
0047c039 : LEA EDI,[EAX + ECX*0x4]
0047c03c : MOV EDX,dword ptr [EBP + 0x14]
0047c03f : MOV ESI,dword ptr [EBP + 0x10]
0047c042 : CALL 0x004154b0
0047c047 : MOV dword ptr [EBP + -0x18],0x1
0047c04e : MOV ESI,dword ptr [EBP + -0x14]
0047c051 : MOV EDX,ESI
0047c053 : MOV EAX,dword ptr [EBP + 0xc]
0047c056 : MOV EDI,dword ptr [EBX + 0x4]
0047c059 : CALL 0x00461070
0047c05e : MOV dword ptr [EBP + -0x18],0x2
0047c065 : MOV EAX,dword ptr [EBP + -0x1c]
0047c068 : MOV ECX,dword ptr [EBP + 0x10]
0047c06b : ADD EAX,ECX
0047c06d : LEA EDX,[ESI + EAX*0x4]
0047c070 : MOV EAX,dword ptr [EBX + 0x8]
0047c073 : MOV EDI,dword ptr [EBP + 0xc]
0047c076 : CALL 0x00461070
0047c07b : MOV dword ptr [EBP + -0x4],0xffffffff
0047c082 : MOV ECX,dword ptr [EBX + 0x4]
0047c085 : MOV EDX,dword ptr [EBX + 0x8]
0047c088 : SUB EDX,ECX
0047c08a : SAR EDX,0x2
0047c08d : MOV EDI,dword ptr [EBP + 0x10]
0047c090 : ADD EDI,EDX
0047c092 : TEST ECX,ECX
0047c094 : JZ 0x0047c09b
0047c096 : CALL 0x006f04e0
0047c09b : MOV EAX,dword ptr [EBP + 0x8]
0047c09e : LEA ECX,[ESI + EAX*0x4]
0047c0a1 : MOV dword ptr [EBX + 0xc],ECX
0047c0a4 : LEA EDX,[ESI + EDI*0x4]
0047c0a7 : MOV dword ptr [EBX + 0x8],EDX
0047c0aa : MOV dword ptr [EBX + 0x4],ESI
0047c0ad : MOV ECX,dword ptr [EBP + -0xc]
0047c0b0 : MOV dword ptr FS:[0x0],ECX
0047c0b7 : POP ECX
0047c0b8 : POP EDI
0047c0b9 : POP ESI
0047c0ba : POP EBX
0047c0bb : MOV ESP,EBP
0047c0bd : POP EBP
0047c0be : RET 0x10
0047c0d2 : MOV EAX,ESI
0047c0d4 : MOV EDI,dword ptr [EBP + 0xc]
0047c0d7 : SUB EAX,EDI
0047c0d9 : SAR EAX,0x2
0047c0dc : CMP EAX,EDX
0047c0de : JNC 0x0047c136
0047c0e0 : MOV ECX,dword ptr [EBP + 0x14]
0047c0e3 : MOV EAX,dword ptr [ECX]
0047c0e5 : MOV dword ptr [EBP + 0x8],EAX
0047c0e8 : LEA EAX,[EDX*0x4 + 0x0]
0047c0ef : MOV dword ptr [EBP + 0x14],EAX
0047c0f2 : LEA EDX,[EAX + EDI*0x1]
0047c0f5 : MOV EAX,ESI
0047c0f7 : CALL 0x00461070
0047c0fc : MOV dword ptr [EBP + -0x4],0x2
0047c103 : MOV EDI,dword ptr [EBX + 0x8]
0047c106 : MOV ECX,EDI
0047c108 : SUB ECX,dword ptr [EBP + 0xc]
0047c10b : SAR ECX,0x2
0047c10e : MOV ESI,dword ptr [EBP + 0x10]
0047c111 : SUB ESI,ECX
0047c113 : LEA EDX,[EBP + 0x8]
0047c116 : CALL 0x004154b0
0047c11b : MOV dword ptr [EBP + -0x4],0xffffffff
0047c122 : MOV EAX,dword ptr [EBP + 0x14]
0047c125 : ADD dword ptr [EBX + 0x8],EAX
0047c128 : MOV ECX,dword ptr [EBX + 0x8]
0047c12b : SUB ECX,EAX
0047c12d : MOV EDX,dword ptr [EBP + 0xc]
0047c130 : PUSH EDX
0047c131 : LEA EDX,[EBP + 0x8]
0047c134 : JMP 0x0047c186
0047c136 : MOV EAX,dword ptr [EBP + 0x14]
0047c139 : MOV ECX,dword ptr [EAX]
0047c13b : MOV dword ptr [EBP + 0x10],ECX
0047c13e : LEA EAX,[EDX*0x4 + 0x0]
0047c145 : MOV dword ptr [EBP + 0x14],EAX
0047c148 : MOV EDI,ESI
0047c14a : SUB EDI,EAX
0047c14c : MOV EDX,ESI
0047c14e : MOV EAX,ESI
0047c150 : CALL 0x00461070
0047c155 : MOV dword ptr [EBX + 0x8],EAX
0047c158 : MOV EAX,dword ptr [EBP + 0xc]
0047c15b : SUB EDI,EAX
0047c15d : SAR EDI,0x2
0047c160 : TEST EDI,EDI
0047c162 : JLE 0x0047c17c
0047c164 : LEA ECX,[EDI*0x4 + 0x0]
0047c16b : PUSH ECX
0047c16c : PUSH EAX
0047c16d : PUSH ECX
0047c16e : SUB ESI,ECX
0047c170 : PUSH ESI
0047c171 : CALL 0x00634101
0047c176 : ADD ESP,0x10
0047c179 : MOV EAX,dword ptr [EBP + 0xc]
0047c17c : MOV EDX,dword ptr [EBP + 0x14]
0047c17f : LEA ECX,[EDX + EAX*0x1]
0047c182 : PUSH EAX
0047c183 : LEA EDX,[EBP + 0x10]
0047c186 : CALL 0x00422490
0047c18b : ADD ESP,0x4
0047c18e : MOV ECX,dword ptr [EBP + -0xc]
0047c191 : MOV dword ptr FS:[0x0],ECX
0047c198 : POP ECX
0047c199 : POP EDI
0047c19a : POP ESI
0047c19b : POP EBX
0047c19c : MOV ESP,EBP
0047c19e : POP EBP
0047c19f : RET 0x10

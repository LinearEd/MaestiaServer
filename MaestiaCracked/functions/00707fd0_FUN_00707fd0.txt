PROGRAM  : Maestia.exe
FUNCTION : FUN_00707fd0
ENTRY    : 00707fd0
BODY     : [[00707fd0, 0070812c] [00708130, 0070817c] [00708180, 007081a8]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x00708043) */
/* WARNING: Removing unreachable block (ram,0x0070809b) */

undefined4 FUN_00707fd0(int param_1)

{
  uint *puVar1;
  uint *puVar2;
  int iVar3;
  byte *pbVar4;
  byte bVar5;
  byte bVar6;
  int in_ECX;
  uint uVar7;
  ushort uVar8;
  uint uVar9;
  uint local_8;
  
  iVar3 = 0;
  *(undefined2 *)(in_ECX + 4) = 0;
  uVar7 = 0;
  do {
    pbVar4 = (byte *)(iVar3 + param_1);
    bVar5 = (byte)uVar7;
    uVar7 = uVar7 + 8;
    iVar3 = iVar3 + 1;
    *(ushort *)(in_ECX + 4) = *(ushort *)(in_ECX + 4) | (ushort)*pbVar4 << (bVar5 & 0x1f);
  } while (uVar7 < 0x10);
  puVar1 = (uint *)(in_ECX + 0x18);
  *puVar1 = 0;
  uVar7 = 0;
  pbVar4 = (byte *)(param_1 + 2);
  do {
    bVar5 = *pbVar4;
    bVar6 = (byte)uVar7;
    uVar7 = uVar7 + 8;
    pbVar4 = pbVar4 + 1;
    *puVar1 = *puVar1 | (uint)bVar5 << (bVar6 & 0x1f);
  } while (uVar7 < 0x10);
  if (*(int *)(in_ECX + 0xc) != *(int *)(in_ECX + 0x10)) {
    *(int *)(in_ECX + 0x10) = *(int *)(in_ECX + 0xc);
  }
  FUN_004d47e0(*(undefined4 *)(in_ECX + 0xc),param_1 + 4,*puVar1 + 4 + param_1,param_1);
  *(uint *)(in_ECX + 0x1c) = *puVar1 + 4;
  if (*(int *)(in_ECX + 0x24) != *(int *)(in_ECX + 0x28)) {
    *(int *)(in_ECX + 0x28) = *(int *)(in_ECX + 0x24);
  }
  uVar7 = 0;
  pbVar4 = (byte *)(*puVar1 + 4 + param_1);
  uVar8 = 0;
  do {
    bVar5 = *pbVar4;
    bVar6 = (byte)uVar7;
    uVar7 = uVar7 + 8;
    pbVar4 = pbVar4 + 1;
    uVar8 = uVar8 | (ushort)bVar5 << (bVar6 & 0x1f);
  } while (uVar7 < 0x10);
  while (uVar8 == 0x3c) {
    iVar3 = *(int *)(in_ECX + 0x24);
    if (iVar3 == 0) {
      local_8 = 0;
    }
    else {
      local_8 = *(int *)(in_ECX + 0x2c) - iVar3 >> 2;
    }
    puVar2 = *(uint **)(in_ECX + 0x28);
    if ((uint)((int)puVar2 - iVar3 >> 2) < local_8) {
      *puVar2 = *puVar1;
      *(uint **)(in_ECX + 0x28) = puVar2 + 1;
    }
    else {
      FUN_00408c10(in_ECX + 0x20,puVar2,1,puVar1);
    }
    uVar9 = 0;
    uVar7 = 0;
    pbVar4 = (byte *)(*(int *)(in_ECX + 0x1c) + 2 + param_1);
    do {
      bVar5 = *pbVar4;
      bVar6 = (byte)uVar7;
      uVar7 = uVar7 + 8;
      pbVar4 = pbVar4 + 1;
      uVar9 = uVar9 | (uint)bVar5 << (bVar6 & 0x1f);
    } while (uVar7 < 0x10);
    FUN_004d47e0(*(undefined4 *)(in_ECX + 0x10),*(int *)(in_ECX + 0x1c) + 4 + param_1,
                 *(int *)(in_ECX + 0x1c) + uVar9 + 4 + param_1,param_1);
    *puVar1 = *puVar1 + uVar9;
    *(int *)(in_ECX + 0x1c) = *(int *)(in_ECX + 0x1c) + uVar9 + 4;
    uVar7 = 0;
    pbVar4 = (byte *)(*(int *)(in_ECX + 0x1c) + param_1);
    uVar8 = 0;
    do {
      bVar5 = *pbVar4;
      bVar6 = (byte)uVar7;
      uVar7 = uVar7 + 8;
      pbVar4 = pbVar4 + 1;
      uVar8 = uVar8 | (ushort)bVar5 << (bVar6 & 0x1f);
    } while (uVar7 < 0x10);
  }
  return *(undefined4 *)(in_ECX + 0x1c);
}



============================================================
DISASSEMBLY
============================================================
00707fd0 : PUSH EBP
00707fd1 : MOV EBP,ESP
00707fd3 : SUB ESP,0x8
00707fd6 : PUSH EBX
00707fd7 : PUSH ESI
00707fd8 : MOV ESI,ECX
00707fda : XOR EAX,EAX
00707fdc : PUSH EDI
00707fdd : MOV word ptr [ESI + 0x4],AX
00707fe1 : XOR ECX,ECX
00707fe3 : MOV EDX,dword ptr [EBP + 0x8]
00707fe6 : MOVZX DX,byte ptr [EAX + EDX*0x1]
00707feb : SHL DX,CL
00707fee : ADD ECX,0x8
00707ff1 : INC EAX
00707ff2 : OR word ptr [ESI + 0x4],DX
00707ff6 : CMP ECX,0x10
00707ff9 : JC 0x00707fe3
00707ffb : MOV EDX,dword ptr [EBP + 0x8]
00707ffe : LEA EBX,[ESI + 0x18]
00708001 : MOV dword ptr [EBX],0x0
00708007 : XOR ECX,ECX
00708009 : LEA EAX,[EDX + 0x2]
0070800c : LEA ESP,[ESP]
00708010 : MOVZX EDI,byte ptr [EAX]
00708013 : SHL EDI,CL
00708015 : ADD ECX,0x8
00708018 : INC EAX
00708019 : OR dword ptr [EBX],EDI
0070801b : CMP ECX,0x10
0070801e : JC 0x00708010
00708020 : MOV EAX,dword ptr [EBX]
00708022 : LEA ECX,[EAX + EDX*0x1 + 0x4]
00708026 : MOV EDX,dword ptr [ESI + 0xc]
00708029 : LEA EDI,[ESI + 0x8]
0070802c : MOV dword ptr [EBP + -0x8],ECX
0070802f : MOV ECX,dword ptr [EDI + 0x8]
00708032 : CMP EDX,ECX
00708034 : JZ 0x00708058
00708036 : MOV EAX,ECX
00708038 : SUB EAX,ECX
0070803a : ADD EDX,EAX
0070803c : MOV dword ptr [EBP + -0x4],EDX
0070803f : TEST EAX,EAX
00708041 : JLE 0x00708052
00708043 : PUSH EAX
00708044 : PUSH ECX
00708045 : PUSH EAX
00708046 : MOV EAX,dword ptr [EDI + 0x4]
00708049 : PUSH EAX
0070804a : CALL 0x00634101
0070804f : ADD ESP,0x10
00708052 : MOV EAX,dword ptr [EBP + -0x4]
00708055 : MOV dword ptr [EDI + 0x8],EAX
00708058 : MOV EDX,dword ptr [EBP + 0x8]
0070805b : MOV EAX,dword ptr [EBP + -0x8]
0070805e : MOV ECX,dword ptr [EDI + 0x4]
00708061 : PUSH EDX
00708062 : PUSH EAX
00708063 : MOV EAX,dword ptr [EBP + 0x8]
00708066 : ADD EAX,0x4
00708069 : PUSH EAX
0070806a : PUSH ECX
0070806b : MOV ECX,EDI
0070806d : CALL 0x004d47e0
00708072 : MOV ECX,dword ptr [EBX]
00708074 : ADD ECX,0x4
00708077 : MOV dword ptr [ESI + 0x1c],ECX
0070807a : MOV EDX,dword ptr [ESI + 0x24]
0070807d : MOV ECX,dword ptr [ESI + 0x28]
00708080 : CMP EDX,ECX
00708082 : JZ 0x007080ad
00708084 : MOV EAX,ECX
00708086 : SUB EAX,ECX
00708088 : SAR EAX,0x2
0070808b : LEA EDI,[EAX*0x4 + 0x0]
00708092 : MOV dword ptr [EBP + -0x8],EDI
00708095 : ADD EDI,EDX
00708097 : TEST EAX,EAX
00708099 : JLE 0x007080aa
0070809b : MOV EAX,dword ptr [EBP + -0x8]
0070809e : PUSH EAX
0070809f : PUSH ECX
007080a0 : PUSH EAX
007080a1 : PUSH EDX
007080a2 : CALL 0x00634101
007080a7 : ADD ESP,0x10
007080aa : MOV dword ptr [ESI + 0x28],EDI
007080ad : MOV EAX,dword ptr [EBX]
007080af : MOV EDX,dword ptr [EBP + 0x8]
007080b2 : XOR ECX,ECX
007080b4 : ADD EAX,0x4
007080b7 : ADD EAX,EDX
007080b9 : MOV dword ptr [EBP + -0x4],ECX
007080bc : MOV DX,CX
007080bf : NOP
007080c0 : MOVZX DI,byte ptr [EAX]
007080c4 : SHL DI,CL
007080c7 : ADD ECX,0x8
007080ca : INC EAX
007080cb : OR DX,DI
007080ce : CMP ECX,0x10
007080d1 : JC 0x007080c0
007080d3 : CMP DX,0x3c
007080d7 : JNZ 0x0070819d
007080dd : MOV EDX,dword ptr [ESI + 0x24]
007080e0 : LEA EAX,[ESI + 0x20]
007080e3 : TEST EDX,EDX
007080e5 : JNZ 0x007080ec
007080e7 : MOV dword ptr [EBP + -0x4],EDX
007080ea : JMP 0x007080f7
007080ec : MOV ECX,dword ptr [EAX + 0xc]
007080ef : SUB ECX,EDX
007080f1 : SAR ECX,0x2
007080f4 : MOV dword ptr [EBP + -0x4],ECX
007080f7 : MOV ECX,dword ptr [EAX + 0x8]
007080fa : MOV EDI,ECX
007080fc : SUB EDI,EDX
007080fe : SAR EDI,0x2
00708101 : CMP EDI,dword ptr [EBP + -0x4]
00708104 : JNC 0x00708112
00708106 : MOV EDX,dword ptr [EBX]
00708108 : MOV dword ptr [ECX],EDX
0070810a : ADD ECX,0x4
0070810d : MOV dword ptr [EAX + 0x8],ECX
00708110 : JMP 0x0070811c
00708112 : PUSH EBX
00708113 : PUSH 0x1
00708115 : PUSH ECX
00708116 : PUSH EAX
00708117 : CALL 0x00408c10
0070811c : MOV EAX,dword ptr [ESI + 0x1c]
0070811f : MOV EDX,dword ptr [EBP + 0x8]
00708122 : ADD EAX,0x2
00708125 : XOR EDI,EDI
00708127 : XOR ECX,ECX
00708129 : ADD EAX,EDX
0070812b : JMP 0x00708130
00708130 : MOVZX EDX,byte ptr [EAX]
00708133 : SHL EDX,CL
00708135 : ADD ECX,0x8
00708138 : INC EAX
00708139 : OR EDI,EDX
0070813b : CMP ECX,0x10
0070813e : JC 0x00708130
00708140 : MOV EAX,dword ptr [ESI + 0x1c]
00708143 : MOV ECX,dword ptr [EBP + 0x8]
00708146 : PUSH ECX
00708147 : MOV ECX,dword ptr [EBP + 0x8]
0070814a : LEA EDX,[EAX + EDI*0x1]
0070814d : LEA EDX,[EDX + ECX*0x1 + 0x4]
00708151 : LEA EAX,[EAX + ECX*0x1 + 0x4]
00708155 : PUSH EDX
00708156 : PUSH EAX
00708157 : MOV EAX,dword ptr [ESI + 0x10]
0070815a : PUSH EAX
0070815b : LEA ECX,[ESI + 0x8]
0070815e : CALL 0x004d47e0
00708163 : ADD dword ptr [EBX],EDI
00708165 : MOV EDX,dword ptr [EBP + 0x8]
00708168 : ADD EDI,0x4
0070816b : ADD dword ptr [ESI + 0x1c],EDI
0070816e : MOV EAX,dword ptr [ESI + 0x1c]
00708171 : XOR ECX,ECX
00708173 : ADD EAX,EDX
00708175 : MOV dword ptr [EBP + -0x4],ECX
00708178 : MOV DX,CX
0070817b : JMP 0x00708180
00708180 : MOVZX DI,byte ptr [EAX]
00708184 : SHL DI,CL
00708187 : ADD ECX,0x8
0070818a : INC EAX
0070818b : OR DX,DI
0070818e : CMP ECX,0x10
00708191 : JC 0x00708180
00708193 : CMP DX,0x3c
00708197 : JZ 0x007080dd
0070819d : MOV EAX,dword ptr [ESI + 0x1c]
007081a0 : POP EDI
007081a1 : POP ESI
007081a2 : POP EBX
007081a3 : MOV ESP,EBP
007081a5 : POP EBP
007081a6 : RET 0x4

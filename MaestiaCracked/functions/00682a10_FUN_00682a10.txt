PROGRAM  : Maestia.exe
FUNCTION : FUN_00682a10
ENTRY    : 00682a10
BODY     : [[00682a10, 00682c07]]

============================================================
DECOMPILED C CODE
============================================================

LRESULT FUN_00682a10(UINT param_1,WPARAM param_2,LPARAM param_3)

{
  UnwindMapEntry *pUVar1;
  WPARAM wParam;
  int iVar2;
  uint *puVar3;
  LRESULT LVar4;
  int *in_ECX;
  code *pcVar5;
  uint unaff_EBX;
  undefined4 unaff_ESI;
  
  wParam = param_2;
  if (in_ECX[1] == 0) {
    return 0;
  }
  if (param_2 == 3) {
    pUVar1 = (UnwindMapEntry *)in_ECX[0x17];
    if ((((pUVar1 != (UnwindMapEntry *)0x210000) && (pUVar1 != (UnwindMapEntry *)0x3000)) &&
        (pUVar1 != (UnwindMapEntry *)0x60000)) &&
       (((pUVar1 != (UnwindMapEntry *)&DAT_00b10000 && (pUVar1 != (UnwindMapEntry *)0xa10000)) &&
        ((pUVar1 != (UnwindMapEntry *)0xd00800 &&
         ((pUVar1 != &UnwindMapEntry_00d00900 && (pUVar1 != (UnwindMapEntry *)0x110000))))))))
    goto LAB_00682aa8;
    pcVar5 = *(code **)(*in_ECX + 0x84);
  }
  else {
    if (param_2 == 4) goto LAB_00682b03;
    if (param_2 != 5) goto LAB_00682bcb;
LAB_00682aa8:
    pUVar1 = (UnwindMapEntry *)in_ECX[0x17];
    if (((((pUVar1 != (UnwindMapEntry *)0x210000) && (pUVar1 != (UnwindMapEntry *)0x3000)) &&
         (pUVar1 != (UnwindMapEntry *)0x60000)) &&
        ((pUVar1 != (UnwindMapEntry *)&DAT_00b10000 && (pUVar1 != (UnwindMapEntry *)0xa10000)))) &&
       ((pUVar1 != (UnwindMapEntry *)0xd00800 &&
        ((pUVar1 != &UnwindMapEntry_00d00900 && (pUVar1 != (UnwindMapEntry *)0x110000)))))) {
LAB_00682b03:
      pUVar1 = (UnwindMapEntry *)in_ECX[0x17];
      if (((pUVar1 == (UnwindMapEntry *)0x210000) ||
          (((pUVar1 == (UnwindMapEntry *)0x3000 || (pUVar1 == (UnwindMapEntry *)0x60000)) ||
           (pUVar1 == (UnwindMapEntry *)&DAT_00b10000)))) ||
         (((pUVar1 == (UnwindMapEntry *)0xa10000 || (pUVar1 == (UnwindMapEntry *)0xd00800)) ||
          ((pUVar1 == &UnwindMapEntry_00d00900 || (pUVar1 == (UnwindMapEntry *)0x110000)))))) {
        FUN_00684a80();
        iVar2 = FUN_0051b1a0();
        if (iVar2 != 0) {
          puVar3 = (uint *)FUN_0051c6e0(&param_2,".RemoveList");
          FUN_00678eb0(in_ECX[1],(*puVar3 & 0xfffffffc) + 8,&DAT_00cca874);
          FUN_0045b730();
        }
      }
      LVar4 = DefWindowProcW((HWND)in_ECX[5],param_1,wParam,param_3);
      FUN_0045ac80();
      return LVar4;
    }
    pcVar5 = *(code **)(*in_ECX + 0x88);
  }
  (*pcVar5)();
LAB_00682bcb:
  (**(code **)(*in_ECX + 0x30))(param_1,wParam);
  if ((unaff_EBX >> 6 & 1) != 0) {
    FUN_00588b40(&stack0xffffffe4,unaff_ESI);
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00682a10 : SUB ESP,0x10
00682a13 : PUSH ESI
00682a14 : MOV ESI,ECX
00682a16 : XOR ECX,ECX
00682a18 : CMP dword ptr [ESI + 0x4],ECX
00682a1b : JNZ 0x00682a26
00682a1d : XOR EAX,EAX
00682a1f : POP ESI
00682a20 : ADD ESP,0x10
00682a23 : RET 0x10
00682a26 : PUSH EBX
00682a27 : MOV EBX,dword ptr [ESP + 0x20]
00682a2b : MOV EAX,EBX
00682a2d : SUB EAX,0x3
00682a30 : MOV dword ptr [ESP + 0x8],ECX
00682a34 : MOV dword ptr [ESP + 0xc],ECX
00682a38 : JZ 0x00682a4d
00682a3a : SUB EAX,0x1
00682a3d : JZ 0x00682b03
00682a43 : SUB EAX,0x1
00682a46 : JZ 0x00682aa8
00682a48 : JMP 0x00682bcb
00682a4d : MOV EAX,dword ptr [ESI + 0x5c]
00682a50 : CMP EAX,0x210000
00682a55 : JZ 0x00682bbe
00682a5b : CMP EAX,0x3000
00682a60 : JZ 0x00682bbe
00682a66 : CMP EAX,0x60000
00682a6b : JZ 0x00682bbe
00682a71 : CMP EAX,0xb10000
00682a76 : JZ 0x00682bbe
00682a7c : CMP EAX,0xa10000
00682a81 : JZ 0x00682bbe
00682a87 : CMP EAX,0xd00800
00682a8c : JZ 0x00682bbe
00682a92 : CMP EAX,0xd00900
00682a97 : JZ 0x00682bbe
00682a9d : CMP EAX,0x110000
00682aa2 : JZ 0x00682bbe
00682aa8 : MOV EAX,dword ptr [ESI + 0x5c]
00682aab : CMP EAX,0x210000
00682ab0 : JZ 0x00682bb4
00682ab6 : CMP EAX,0x3000
00682abb : JZ 0x00682bb4
00682ac1 : CMP EAX,0x60000
00682ac6 : JZ 0x00682bb4
00682acc : CMP EAX,0xb10000
00682ad1 : JZ 0x00682bb4
00682ad7 : CMP EAX,0xa10000
00682adc : JZ 0x00682bb4
00682ae2 : CMP EAX,0xd00800
00682ae7 : JZ 0x00682bb4
00682aed : CMP EAX,0xd00900
00682af2 : JZ 0x00682bb4
00682af8 : CMP EAX,0x110000
00682afd : JZ 0x00682bb4
00682b03 : MOV EAX,dword ptr [ESI + 0x5c]
00682b06 : CMP EAX,0x210000
00682b0b : JZ 0x00682b3e
00682b0d : CMP EAX,0x3000
00682b12 : JZ 0x00682b3e
00682b14 : CMP EAX,0x60000
00682b19 : JZ 0x00682b3e
00682b1b : CMP EAX,0xb10000
00682b20 : JZ 0x00682b3e
00682b22 : CMP EAX,0xa10000
00682b27 : JZ 0x00682b3e
00682b29 : CMP EAX,0xd00800
00682b2e : JZ 0x00682b3e
00682b30 : CMP EAX,0xd00900
00682b35 : JZ 0x00682b3e
00682b37 : CMP EAX,0x110000
00682b3c : JNZ 0x00682b8a
00682b3e : MOV ECX,dword ptr [ESI + 0x18]
00682b41 : PUSH EDI
00682b42 : CALL 0x00684a80
00682b47 : LEA EDI,[ESI + 0x8]
00682b4a : MOV ECX,EDI
00682b4c : CALL 0x0051b1a0
00682b51 : TEST EAX,EAX
00682b53 : JBE 0x00682b89
00682b55 : PUSH 0xbd7f7c
00682b5a : LEA EAX,[ESP + 0x28]
00682b5e : PUSH EAX
00682b5f : MOV ECX,EDI
00682b61 : CALL 0x0051c6e0
00682b66 : MOV ECX,dword ptr [EAX]
00682b68 : MOV EDX,dword ptr [ESI + 0x4]
00682b6b : AND ECX,0xfffffffc
00682b6e : PUSH 0xcca874
00682b73 : ADD ECX,0x8
00682b76 : PUSH ECX
00682b77 : PUSH EDX
00682b78 : CALL 0x00678eb0
00682b7d : ADD ESP,0xc
00682b80 : LEA ECX,[ESP + 0x24]
00682b84 : CALL 0x0045b730
00682b89 : POP EDI
00682b8a : MOV EAX,dword ptr [ESP + 0x24]
00682b8e : MOV ECX,dword ptr [ESP + 0x1c]
00682b92 : MOV EDX,dword ptr [ESI + 0x14]
00682b95 : PUSH EAX
00682b96 : PUSH EBX
00682b97 : PUSH ECX
00682b98 : PUSH EDX
00682b99 : CALL dword ptr [0x00b8553c]
00682b9f : LEA ECX,[ESP + 0x8]
00682ba3 : MOV ESI,EAX
00682ba5 : CALL 0x0045ac80
00682baa : POP EBX
00682bab : MOV EAX,ESI
00682bad : POP ESI
00682bae : ADD ESP,0x10
00682bb1 : RET 0x10
00682bb4 : MOV EAX,dword ptr [ESI]
00682bb6 : MOV EDX,dword ptr [EAX + 0x88]
00682bbc : JMP 0x00682bc6
00682bbe : MOV EAX,dword ptr [ESI]
00682bc0 : MOV EDX,dword ptr [EAX + 0x84]
00682bc6 : PUSH ECX
00682bc7 : MOV ECX,ESI
00682bc9 : CALL EDX
00682bcb : MOV ECX,dword ptr [ESP + 0x24]
00682bcf : MOV EAX,dword ptr [ESI]
00682bd1 : MOV EDX,dword ptr [ESP + 0x1c]
00682bd5 : MOV EAX,dword ptr [EAX + 0x30]
00682bd8 : PUSH ECX
00682bd9 : PUSH EBX
00682bda : PUSH EDX
00682bdb : MOV ECX,ESI
00682bdd : CALL EAX
00682bdf : MOV ECX,dword ptr [ESP + 0xc]
00682be3 : SHR ECX,0x6
00682be6 : TEST CL,0x1
00682be9 : JZ 0x00682bfe
00682beb : MOV EDX,dword ptr [ESP + 0x10]
00682bef : MOV ECX,dword ptr [ESP + 0x8]
00682bf3 : PUSH EDX
00682bf4 : LEA EAX,[ESP + 0xc]
00682bf8 : PUSH EAX
00682bf9 : CALL 0x00588b40
00682bfe : POP EBX
00682bff : XOR EAX,EAX
00682c01 : POP ESI
00682c02 : ADD ESP,0x10
00682c05 : RET 0x10

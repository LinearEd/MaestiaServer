PROGRAM  : Maestia.exe
FUNCTION : FUN_00a5d2f0
ENTRY    : 00a5d2f0
BODY     : [[00a5d2f0, 00a5d3e3]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00a5d2f0(uint *param_1,uint param_2,int param_3)

{
  int iVar1;
  int iVar2;
  int in_ECX;
  int iVar3;
  uint uVar4;
  uint uVar5;
  
  iVar3 = param_2 - 1;
  iVar1 = iVar3 + (iVar3 >> 0x1f & 7U);
  iVar2 = iVar1 >> 3;
  if (((param_2 & 7) != 0) && (iVar3 == 0)) {
    return (uint)(uint3)(iVar1 >> 0xb) << 8;
  }
  iVar3 = iVar2;
  if (0 < iVar2) {
    iVar3 = param_3 - (int)param_1;
    param_3 = iVar2;
    do {
      uVar5 = *param_1;
      uVar4 = param_1[1];
      iVar1 = (uint)*(byte *)(in_ECX + 5) * 0x10;
      iVar2 = -0x3910c8e0;
      param_2 = 0x20;
      do {
        uVar4 = uVar4 - ((uVar5 >> 5) + *(int *)(&DAT_00d69154 + iVar1) ^
                         uVar5 * 0x10 + *(int *)(&DAT_00d69150 + iVar1) ^ iVar2 + uVar5);
        uVar5 = uVar5 - ((uVar4 >> 5) + *(int *)(&DAT_00d6914c + iVar1) ^
                         uVar4 * 0x10 + *(int *)(&DAT_00d69148 + iVar1) ^ iVar2 + uVar4);
        iVar2 = iVar2 + 0x61c88647;
        param_2 = param_2 + -1;
      } while (param_2 != 0);
      *(uint *)(iVar3 + (int)param_1) = uVar5;
      *(uint *)(iVar3 + 4 + (int)param_1) = uVar4;
      *(char *)(in_ECX + 5) = *(char *)(in_ECX + 5) + '\x01';
      param_1 = param_1 + 2;
      param_3 = param_3 + -1;
    } while (param_3 != 0);
  }
  return CONCAT31((int3)((uint)iVar3 >> 8),1);
}



============================================================
DISASSEMBLY
============================================================
00a5d2f0 : PUSH EBP
00a5d2f1 : MOV EBP,ESP
00a5d2f3 : SUB ESP,0x18
00a5d2f6 : PUSH EBX
00a5d2f7 : MOV EBX,dword ptr [EBP + 0xc]
00a5d2fa : PUSH ESI
00a5d2fb : LEA ESI,[EBX + -0x1]
00a5d2fe : MOV EAX,ESI
00a5d300 : CDQ
00a5d301 : AND EDX,0x7
00a5d304 : ADD EAX,EDX
00a5d306 : SAR EAX,0x3
00a5d309 : MOV dword ptr [EBP + -0x18],ECX
00a5d30c : TEST BL,0x7
00a5d30f : JZ 0x00a5d31f
00a5d311 : TEST ESI,ESI
00a5d313 : JNZ 0x00a5d31f
00a5d315 : POP ESI
00a5d316 : XOR AL,AL
00a5d318 : POP EBX
00a5d319 : MOV ESP,EBP
00a5d31b : POP EBP
00a5d31c : RET 0xc
00a5d31f : MOV EDX,0x1
00a5d324 : TEST EAX,EAX
00a5d326 : JLE 0x00a5d3da
00a5d32c : MOV EBX,dword ptr [EBP + 0x8]
00a5d32f : MOV EDX,dword ptr [EBP + 0x10]
00a5d332 : SUB EDX,EBX
00a5d334 : MOV dword ptr [EBP + 0x8],EBX
00a5d337 : MOV dword ptr [EBP + -0x14],EDX
00a5d33a : MOV dword ptr [EBP + 0x10],EAX
00a5d33d : PUSH EDI
00a5d33e : MOV EDI,EDI
00a5d340 : MOVZX EDX,byte ptr [ECX + 0x5]
00a5d344 : MOV EDI,dword ptr [EBX]
00a5d346 : MOV ESI,dword ptr [EBX + 0x4]
00a5d349 : SHL EDX,0x4
00a5d34c : ADD EDX,0xd69148
00a5d352 : MOV EAX,dword ptr [EDX]
00a5d354 : MOV ECX,dword ptr [EDX + 0x4]
00a5d357 : MOV dword ptr [EBP + -0x10],EAX
00a5d35a : MOV EAX,dword ptr [EDX + 0x8]
00a5d35d : MOV dword ptr [EBP + -0xc],ECX
00a5d360 : MOV ECX,dword ptr [EDX + 0xc]
00a5d363 : MOV EBX,0xc6ef3720
00a5d368 : MOV dword ptr [EBP + -0x8],EAX
00a5d36b : MOV dword ptr [EBP + -0x4],ECX
00a5d36e : MOV dword ptr [EBP + 0xc],0x20
00a5d375 : MOV EDX,EDI
00a5d377 : SHR EDX,0x5
00a5d37a : ADD EDX,dword ptr [EBP + -0x4]
00a5d37d : MOV EAX,EDI
00a5d37f : SHL EAX,0x4
00a5d382 : ADD EAX,dword ptr [EBP + -0x8]
00a5d385 : LEA ECX,[EBX + EDI*0x1]
00a5d388 : XOR EDX,EAX
00a5d38a : XOR EDX,ECX
00a5d38c : SUB ESI,EDX
00a5d38e : MOV EDX,ESI
00a5d390 : SHR EDX,0x5
00a5d393 : ADD EDX,dword ptr [EBP + -0xc]
00a5d396 : MOV EAX,ESI
00a5d398 : SHL EAX,0x4
00a5d39b : ADD EAX,dword ptr [EBP + -0x10]
00a5d39e : LEA ECX,[EBX + ESI*0x1]
00a5d3a1 : XOR EDX,EAX
00a5d3a3 : XOR EDX,ECX
00a5d3a5 : SUB EDI,EDX
00a5d3a7 : MOV EDX,0x1
00a5d3ac : ADD EBX,0x61c88647
00a5d3b2 : SUB dword ptr [EBP + 0xc],EDX
00a5d3b5 : JNZ 0x00a5d375
00a5d3b7 : MOV EBX,dword ptr [EBP + 0x8]
00a5d3ba : MOV EAX,dword ptr [EBP + -0x14]
00a5d3bd : MOV ECX,dword ptr [EBP + -0x18]
00a5d3c0 : MOV dword ptr [EAX + EBX*0x1],EDI
00a5d3c3 : MOV dword ptr [EAX + EBX*0x1 + 0x4],ESI
00a5d3c7 : ADD byte ptr [ECX + 0x5],DL
00a5d3ca : ADD EBX,0x8
00a5d3cd : SUB dword ptr [EBP + 0x10],EDX
00a5d3d0 : MOV dword ptr [EBP + 0x8],EBX
00a5d3d3 : JNZ 0x00a5d340
00a5d3d9 : POP EDI
00a5d3da : POP ESI
00a5d3db : MOV AL,DL
00a5d3dd : POP EBX
00a5d3de : MOV ESP,EBP
00a5d3e0 : POP EBP
00a5d3e1 : RET 0xc

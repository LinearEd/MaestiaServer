PROGRAM  : Maestia.exe
FUNCTION : FUN_008f8070
ENTRY    : 008f8070
BODY     : [[008f8070, 008f815a]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_008f8070(wchar_t *param_1)

{
  short *psVar1;
  short sVar2;
  wchar_t wVar3;
  int iVar4;
  wchar_t *pwVar5;
  short *unaff_ESI;
  wchar_t local_4008;
  undefined1 local_4006 [16382];
  uint local_8;
  
  local_8 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  psVar1 = unaff_ESI + 1;
  do {
    sVar2 = *unaff_ESI;
    unaff_ESI = unaff_ESI + 1;
  } while (sVar2 != 0);
  if ((int)unaff_ESI - (int)psVar1 >> 1 != 0) {
    local_4008 = L'\0';
    _memset(local_4006,0,0x3ffe);
    pwVar5 = &local_4008;
    do {
      wVar3 = *pwVar5;
      pwVar5 = pwVar5 + 1;
    } while (wVar3 != L'\0');
    iVar4 = (int)pwVar5 - (int)local_4006 >> 1;
    _swprintf_s((wchar_t *)(local_4006 + iVar4 * 2 + -2),0x1fff - iVar4,
                L"<font face=\'$NormalFont\' color=\'#%06X\' size =\'%d\'>");
    pwVar5 = &local_4008;
    do {
      wVar3 = *pwVar5;
      pwVar5 = pwVar5 + 1;
    } while (wVar3 != L'\0');
    iVar4 = (int)pwVar5 - (int)local_4006 >> 1;
    FUN_008f7830(local_4006 + iVar4 * 2 + -2,0x2000 - iVar4);
    _wcsncpy(param_1,&local_4008,0x2000);
  }
  __security_check_cookie(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008f8070 : PUSH EBP
008f8071 : MOV EBP,ESP
008f8073 : MOV EAX,0x4008
008f8078 : CALL 0x0063b780
008f807d : MOV EAX,[0x00d66fa0]
008f8082 : XOR EAX,EBP
008f8084 : MOV dword ptr [EBP + -0x4],EAX
008f8087 : MOV EAX,ESI
008f8089 : PUSH EBX
008f808a : MOV EBX,dword ptr [EBP + 0x8]
008f808d : LEA EDX,[EAX + 0x2]
008f8090 : MOV CX,word ptr [EAX]
008f8093 : ADD EAX,0x2
008f8096 : TEST CX,CX
008f8099 : JNZ 0x008f8090
008f809b : SUB EAX,EDX
008f809d : SAR EAX,0x1
008f809f : JZ 0x008f814c
008f80a5 : XOR EAX,EAX
008f80a7 : PUSH 0x3ffe
008f80ac : PUSH EAX
008f80ad : LEA ECX,[EBP + 0xffffbffe]
008f80b3 : PUSH ECX
008f80b4 : MOV word ptr [EBP + 0xffffbffc],AX
008f80bb : CALL 0x0063b700
008f80c0 : LEA EAX,[EBP + 0xffffbffc]
008f80c6 : ADD ESP,0xc
008f80c9 : LEA EDX,[EAX + 0x2]
008f80cc : LEA ESP,[ESP]
008f80d0 : MOV CX,word ptr [EAX]
008f80d3 : ADD EAX,0x2
008f80d6 : TEST CX,CX
008f80d9 : JNZ 0x008f80d0
008f80db : SUB EAX,EDX
008f80dd : MOV EDX,dword ptr [EBP + 0xc]
008f80e0 : PUSH EDX
008f80e1 : SAR EAX,0x1
008f80e3 : PUSH EDI
008f80e4 : MOV ECX,0x1fff
008f80e9 : PUSH 0xc62068
008f80ee : SUB ECX,EAX
008f80f0 : PUSH ECX
008f80f1 : LEA EDX,[EBP + EAX*0x2 + 0xffffbffc]
008f80f8 : PUSH EDX
008f80f9 : CALL 0x00635d51
008f80fe : LEA EAX,[EBP + 0xffffbffc]
008f8104 : ADD ESP,0x14
008f8107 : LEA EDX,[EAX + 0x2]
008f810a : LEA EBX,[EBX]
008f8110 : MOV CX,word ptr [EAX]
008f8113 : ADD EAX,0x2
008f8116 : TEST CX,CX
008f8119 : JNZ 0x008f8110
008f811b : SUB EAX,EDX
008f811d : SAR EAX,0x1
008f811f : MOV ECX,0x2000
008f8124 : SUB ECX,EAX
008f8126 : PUSH EDI
008f8127 : PUSH ECX
008f8128 : LEA EDX,[EBP + EAX*0x2 + 0xffffbffc]
008f812f : PUSH EDX
008f8130 : MOV ECX,ESI
008f8132 : CALL 0x008f7830
008f8137 : PUSH 0x2000
008f813c : LEA EAX,[EBP + 0xffffbffc]
008f8142 : PUSH EAX
008f8143 : PUSH EBX
008f8144 : CALL 0x00634e39
008f8149 : ADD ESP,0x18
008f814c : MOV ECX,dword ptr [EBP + -0x4]
008f814f : XOR ECX,EBP
008f8151 : POP EBX
008f8152 : CALL 0x00633e6b
008f8157 : MOV ESP,EBP
008f8159 : POP EBP
008f815a : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_0070ff10
ENTRY    : 0070ff10
BODY     : [[0070ff10, 0071000e]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_0070ff10(int param_1)

{
  int iVar1;
  int in_EAX;
  int iVar2;
  uint uVar3;
  uint uVar4;
  size_t _Size;
  
  iVar1 = *(int *)(param_1 + 0x1c);
  if (*(int *)(iVar1 + 0x2c) == 0) {
    iVar2 = (**(code **)(param_1 + 0x20))
                      (*(undefined4 *)(param_1 + 0x28),
                       1 << ((byte)*(undefined4 *)(iVar1 + 0x1c) & 0x1f),1);
    *(int *)(iVar1 + 0x2c) = iVar2;
    if (iVar2 == 0) {
      return 1;
    }
  }
  if (*(int *)(iVar1 + 0x20) == 0) {
    *(undefined4 *)(iVar1 + 0x28) = 0;
    *(undefined4 *)(iVar1 + 0x24) = 0;
    *(int *)(iVar1 + 0x20) = 1 << ((byte)*(undefined4 *)(iVar1 + 0x1c) & 0x1f);
  }
  uVar4 = in_EAX - *(int *)(param_1 + 0x10);
  uVar3 = *(uint *)(iVar1 + 0x20);
  if (uVar3 <= uVar4) {
    _memcpy(*(void **)(iVar1 + 0x2c),(void *)(*(int *)(param_1 + 0xc) - uVar3),uVar3);
    *(undefined4 *)(iVar1 + 0x24) = *(undefined4 *)(iVar1 + 0x20);
    *(undefined4 *)(iVar1 + 0x28) = 0;
    return 0;
  }
  uVar3 = uVar3 - *(int *)(iVar1 + 0x28);
  if (uVar4 < uVar3) {
    uVar3 = uVar4;
  }
  _memcpy((void *)(*(int *)(iVar1 + 0x2c) + *(int *)(iVar1 + 0x28)),
          (void *)(*(int *)(param_1 + 0xc) - uVar4),uVar3);
  _Size = uVar4 - uVar3;
  if (_Size != 0) {
    _memcpy(*(void **)(iVar1 + 0x2c),(void *)(*(int *)(param_1 + 0xc) - _Size),_Size);
    *(size_t *)(iVar1 + 0x28) = _Size;
    *(undefined4 *)(iVar1 + 0x24) = *(undefined4 *)(iVar1 + 0x20);
    return 0;
  }
  *(int *)(iVar1 + 0x28) = *(int *)(iVar1 + 0x28) + uVar3;
  if (*(uint *)(iVar1 + 0x28) == *(uint *)(iVar1 + 0x20)) {
    *(undefined4 *)(iVar1 + 0x28) = 0;
  }
  if (*(uint *)(iVar1 + 0x24) < *(uint *)(iVar1 + 0x20)) {
    *(uint *)(iVar1 + 0x24) = *(uint *)(iVar1 + 0x24) + uVar3;
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
0070ff10 : PUSH EBP
0070ff11 : MOV EBP,ESP
0070ff13 : PUSH EBX
0070ff14 : MOV EBX,dword ptr [EBP + 0x8]
0070ff17 : PUSH ESI
0070ff18 : MOV ESI,dword ptr [EBX + 0x1c]
0070ff1b : CMP dword ptr [ESI + 0x2c],0x0
0070ff1f : PUSH EDI
0070ff20 : MOV EDI,EAX
0070ff22 : JNZ 0x0070ff4e
0070ff24 : MOV ECX,dword ptr [ESI + 0x1c]
0070ff27 : MOV EDX,dword ptr [EBX + 0x20]
0070ff2a : MOV EAX,0x1
0070ff2f : SHL EAX,CL
0070ff31 : MOV ECX,dword ptr [EBX + 0x28]
0070ff34 : PUSH 0x1
0070ff36 : PUSH EAX
0070ff37 : PUSH ECX
0070ff38 : CALL EDX
0070ff3a : ADD ESP,0xc
0070ff3d : MOV dword ptr [ESI + 0x2c],EAX
0070ff40 : TEST EAX,EAX
0070ff42 : JNZ 0x0070ff4e
0070ff44 : POP EDI
0070ff45 : POP ESI
0070ff46 : MOV EAX,0x1
0070ff4b : POP EBX
0070ff4c : POP EBP
0070ff4d : RET
0070ff4e : XOR EAX,EAX
0070ff50 : CMP dword ptr [ESI + 0x20],EAX
0070ff53 : JNZ 0x0070ff68
0070ff55 : MOV ECX,dword ptr [ESI + 0x1c]
0070ff58 : MOV EDX,0x1
0070ff5d : SHL EDX,CL
0070ff5f : MOV dword ptr [ESI + 0x28],EAX
0070ff62 : MOV dword ptr [ESI + 0x24],EAX
0070ff65 : MOV dword ptr [ESI + 0x20],EDX
0070ff68 : SUB EDI,dword ptr [EBX + 0x10]
0070ff6b : MOV EAX,dword ptr [ESI + 0x20]
0070ff6e : CMP EDI,EAX
0070ff70 : JC 0x0070ff99
0070ff72 : MOV ECX,dword ptr [EBX + 0xc]
0070ff75 : MOV EDX,dword ptr [ESI + 0x2c]
0070ff78 : PUSH EAX
0070ff79 : SUB ECX,EAX
0070ff7b : PUSH ECX
0070ff7c : PUSH EDX
0070ff7d : CALL 0x0063ae40
0070ff82 : MOV EAX,dword ptr [ESI + 0x20]
0070ff85 : ADD ESP,0xc
0070ff88 : POP EDI
0070ff89 : MOV dword ptr [ESI + 0x24],EAX
0070ff8c : MOV dword ptr [ESI + 0x28],0x0
0070ff93 : POP ESI
0070ff94 : XOR EAX,EAX
0070ff96 : POP EBX
0070ff97 : POP EBP
0070ff98 : RET
0070ff99 : SUB EAX,dword ptr [ESI + 0x28]
0070ff9c : MOV dword ptr [EBP + 0x8],EAX
0070ff9f : CMP EAX,EDI
0070ffa1 : JBE 0x0070ffa8
0070ffa3 : MOV dword ptr [EBP + 0x8],EDI
0070ffa6 : MOV EAX,EDI
0070ffa8 : MOV ECX,dword ptr [EBX + 0xc]
0070ffab : MOV EDX,dword ptr [ESI + 0x2c]
0070ffae : ADD EDX,dword ptr [ESI + 0x28]
0070ffb1 : PUSH EAX
0070ffb2 : SUB ECX,EDI
0070ffb4 : PUSH ECX
0070ffb5 : PUSH EDX
0070ffb6 : CALL 0x0063ae40
0070ffbb : MOV ECX,dword ptr [EBP + 0x8]
0070ffbe : ADD ESP,0xc
0070ffc1 : SUB EDI,ECX
0070ffc3 : JZ 0x0070ffe8
0070ffc5 : MOV EAX,dword ptr [EBX + 0xc]
0070ffc8 : MOV ECX,dword ptr [ESI + 0x2c]
0070ffcb : PUSH EDI
0070ffcc : SUB EAX,EDI
0070ffce : PUSH EAX
0070ffcf : PUSH ECX
0070ffd0 : CALL 0x0063ae40
0070ffd5 : MOV EDX,dword ptr [ESI + 0x20]
0070ffd8 : ADD ESP,0xc
0070ffdb : MOV dword ptr [ESI + 0x28],EDI
0070ffde : POP EDI
0070ffdf : MOV dword ptr [ESI + 0x24],EDX
0070ffe2 : POP ESI
0070ffe3 : XOR EAX,EAX
0070ffe5 : POP EBX
0070ffe6 : POP EBP
0070ffe7 : RET
0070ffe8 : ADD dword ptr [ESI + 0x28],ECX
0070ffeb : MOV EDX,dword ptr [ESI + 0x28]
0070ffee : MOV EAX,dword ptr [ESI + 0x20]
0070fff1 : CMP EDX,EAX
0070fff3 : JNZ 0x0070fffc
0070fff5 : MOV dword ptr [ESI + 0x28],0x0
0070fffc : MOV EDX,dword ptr [ESI + 0x24]
0070ffff : CMP EDX,EAX
00710001 : JNC 0x00710008
00710003 : ADD EDX,ECX
00710005 : MOV dword ptr [ESI + 0x24],EDX
00710008 : POP EDI
00710009 : POP ESI
0071000a : XOR EAX,EAX
0071000c : POP EBX
0071000d : POP EBP
0071000e : RET

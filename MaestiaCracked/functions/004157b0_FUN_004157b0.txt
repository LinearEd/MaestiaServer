PROGRAM  : Maestia.exe
FUNCTION : FUN_004157b0
ENTRY    : 004157b0
BODY     : [[004157b0, 0041591a] [0041591e, 0041593a] [0041597c, 00415a14] [00415a32, 00415aaf]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_004157b0(int param_1,int param_2,uint param_3)

{
  uint *puVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  undefined4 uVar5;
  int iVar6;
  uint uStack_60;
  uint local_44;
  uint local_40;
  undefined1 local_3c [36];
  uint local_18;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7c404;
  local_10 = ExceptionList;
  uStack_60 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&uStack_60;
  ExceptionList = &local_10;
  iVar2 = *(int *)(param_1 + 4);
  if (iVar2 == 0) {
    local_44 = 0;
  }
  else {
    local_44 = (*(int *)(param_1 + 0xc) - iVar2) / 0x24;
  }
  iVar6 = *(int *)(param_1 + 8);
  iVar2 = (iVar6 - iVar2) / 0x24;
  local_18 = uStack_60;
  puVar1 = &uStack_60;
  if (iVar2 == 0x71c71c7) {
    iVar2 = FUN_00452880();
    puVar1 = (uint *)local_14;
  }
  local_14 = (undefined1 *)puVar1;
  uVar3 = iVar2 + 1;
  if (local_44 < uVar3) {
    if (0x71c71c7 - (local_44 >> 1) < local_44) {
      local_44 = 0;
    }
    else {
      local_44 = local_44 + (local_44 >> 1);
    }
    if (local_44 < uVar3) {
      local_44 = uVar3;
    }
    iVar4 = FUN_00416fd0();
    local_8 = 0;
    FUN_004151e0(param_3);
    FUN_004170d0(*(undefined4 *)(param_1 + 4),param_2);
    FUN_004170d0(param_2,*(undefined4 *)(param_1 + 8));
    local_8 = 0xffffffff;
    iVar6 = *(int *)(param_1 + 4);
    iVar2 = (*(int *)(param_1 + 8) - iVar6) / 0x24 + 1;
    if (iVar6 != 0) {
      FUN_00417830(iVar6,iVar2);
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    *(uint *)(param_1 + 0xc) = iVar4 + local_44 * 0x24;
    *(int *)(param_1 + 8) = iVar4 + iVar2 * 0x24;
    *(int *)(param_1 + 4) = iVar4;
  }
  else {
    iVar6 = iVar6 - param_2;
    iVar2 = iVar6 >> 0x1f;
    if (iVar6 / 0x24 + iVar2 == iVar2) {
      FUN_00416560(local_3c);
      local_8 = 2;
      FUN_004170d0(param_2,*(undefined4 *)(param_1 + 8));
      local_8 = CONCAT31(local_8._1_3_,3);
      FUN_004151e0(local_3c);
      local_8 = 2;
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 0x24;
      FUN_00417790(*(int *)(param_1 + 8) + -0x24);
    }
    else {
      FUN_00416560(local_3c);
      local_8 = 5;
      uVar5 = FUN_004170d0(*(int *)(param_1 + 8) + -0x24,*(int *)(param_1 + 8));
      *(undefined4 *)(param_1 + 8) = uVar5;
      local_40 = param_3 & 0xffffff00;
      FUN_00417e00(param_2,local_40,local_40,local_40);
      FUN_00417790(param_2 + 0x24);
    }
    local_8 = 0xffffffff;
    FUN_00414770(local_3c);
  }
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
004157b0 : PUSH EBP
004157b1 : MOV EBP,ESP
004157b3 : PUSH -0x1
004157b5 : PUSH 0xb7c404
004157ba : MOV EAX,FS:[0x0]
004157c0 : PUSH EAX
004157c1 : SUB ESP,0x40
004157c4 : MOV EAX,[0x00d66fa0]
004157c9 : XOR EAX,EBP
004157cb : MOV dword ptr [EBP + -0x14],EAX
004157ce : PUSH EBX
004157cf : PUSH ESI
004157d0 : PUSH EDI
004157d1 : PUSH EAX
004157d2 : LEA EAX,[EBP + -0xc]
004157d5 : MOV FS:[0x0],EAX
004157db : MOV dword ptr [EBP + -0x10],ESP
004157de : MOV EBX,dword ptr [EBP + 0x8]
004157e1 : MOV dword ptr [EBP + -0x44],EBX
004157e4 : MOV EAX,dword ptr [EBP + 0x10]
004157e7 : MOV dword ptr [EBP + -0x3c],EAX
004157ea : MOV ECX,dword ptr [EBX + 0x4]
004157ed : TEST ECX,ECX
004157ef : JNZ 0x004157f5
004157f1 : XOR EDI,EDI
004157f3 : JMP 0x0041580d
004157f5 : MOV EDX,dword ptr [EBX + 0xc]
004157f8 : SUB EDX,ECX
004157fa : MOV EAX,0x38e38e39
004157ff : IMUL EDX
00415801 : SAR EDX,0x3
00415804 : MOV EAX,EDX
00415806 : SHR EAX,0x1f
00415809 : ADD EAX,EDX
0041580b : MOV EDI,EAX
0041580d : MOV ESI,dword ptr [EBX + 0x8]
00415810 : MOV EDX,ESI
00415812 : SUB EDX,ECX
00415814 : MOV EAX,0x38e38e39
00415819 : IMUL EDX
0041581b : SAR EDX,0x3
0041581e : MOV EAX,EDX
00415820 : SHR EAX,0x1f
00415823 : ADD EAX,EDX
00415825 : MOV ECX,0x71c71c7
0041582a : SUB ECX,EAX
0041582c : CMP ECX,0x1
0041582f : JNC 0x00415836
00415831 : CALL 0x00452880
00415836 : INC EAX
00415837 : CMP EDI,EAX
00415839 : JNC 0x0041597c
0041583f : MOV ECX,EDI
00415841 : SHR ECX,0x1
00415843 : MOV EDX,0x71c71c7
00415848 : SUB EDX,ECX
0041584a : CMP EDX,EDI
0041584c : JNC 0x00415857
0041584e : XOR ESI,ESI
00415850 : MOV dword ptr [EBP + -0x40],ESI
00415853 : MOV EDI,ESI
00415855 : JMP 0x0041585e
00415857 : ADD EDI,ECX
00415859 : MOV dword ptr [EBP + -0x40],EDI
0041585c : XOR ESI,ESI
0041585e : CMP EDI,EAX
00415860 : JNC 0x00415867
00415862 : MOV dword ptr [EBP + -0x40],EAX
00415865 : MOV EDI,EAX
00415867 : MOV ECX,EDI
00415869 : CALL 0x00416fd0
0041586e : MOV EDI,EAX
00415870 : MOV dword ptr [EBP + -0x4c],EDI
00415873 : MOV ECX,dword ptr [EBP + 0xc]
00415876 : SUB ECX,dword ptr [EBX + 0x4]
00415879 : MOV EAX,0x38e38e39
0041587e : IMUL ECX
00415880 : SAR EDX,0x3
00415883 : MOV EAX,EDX
00415885 : SHR EAX,0x1f
00415888 : ADD EAX,EDX
0041588a : MOV dword ptr [EBP + -0x44],EAX
0041588d : MOV dword ptr [EBP + -0x48],ESI
00415890 : MOV dword ptr [EBP + -0x4],ESI
00415893 : MOV ECX,dword ptr [EBP + -0x3c]
00415896 : PUSH ECX
00415897 : LEA EDX,[EAX + EAX*0x8]
0041589a : LEA EDI,[EDI + EDX*0x4]
0041589d : MOV ESI,0x1
004158a2 : CALL 0x004151e0
004158a7 : MOV dword ptr [EBP + -0x48],ESI
004158aa : MOV EAX,dword ptr [EBP + 0xc]
004158ad : PUSH EAX
004158ae : MOV ECX,dword ptr [EBX + 0x4]
004158b1 : PUSH ECX
004158b2 : MOV ESI,dword ptr [EBP + -0x4c]
004158b5 : MOV EDX,ESI
004158b7 : CALL 0x004170d0
004158bc : MOV dword ptr [EBP + -0x48],0x2
004158c3 : MOV EAX,dword ptr [EBP + -0x44]
004158c6 : LEA EDX,[EAX + EAX*0x8 + 0x9]
004158ca : LEA EDX,[ESI + EDX*0x4]
004158cd : MOV EAX,dword ptr [EBX + 0x8]
004158d0 : PUSH EAX
004158d1 : MOV ECX,dword ptr [EBP + 0xc]
004158d4 : PUSH ECX
004158d5 : CALL 0x004170d0
004158da : MOV dword ptr [EBP + -0x4],0xffffffff
004158e1 : MOV ECX,dword ptr [EBX + 0x8]
004158e4 : MOV EDI,dword ptr [EBX + 0x4]
004158e7 : SUB ECX,EDI
004158e9 : MOV EAX,0x38e38e39
004158ee : IMUL ECX
004158f0 : SAR EDX,0x3
004158f3 : MOV EAX,EDX
004158f5 : SHR EAX,0x1f
004158f8 : LEA EDX,[EDX + EAX*0x1 + 0x1]
004158fc : MOV dword ptr [EBP + -0x3c],EDX
004158ff : TEST EDI,EDI
00415901 : JZ 0x0041591e
00415903 : MOV ECX,dword ptr [EBP + -0x3c]
00415906 : PUSH ECX
00415907 : PUSH EDI
00415908 : MOV EDI,dword ptr [EBX + 0x8]
0041590b : CALL 0x00417830
00415910 : ADD ESP,0x8
00415913 : MOV ECX,dword ptr [EBX + 0x4]
00415916 : CALL 0x006f04e0
0041591e : MOV EAX,dword ptr [EBP + -0x40]
00415921 : LEA EAX,[EAX + EAX*0x8]
00415924 : LEA ECX,[ESI + EAX*0x4]
00415927 : MOV dword ptr [EBX + 0xc],ECX
0041592a : LEA EDX,[EDX + EDX*0x8]
0041592d : LEA EAX,[ESI + EDX*0x4]
00415930 : MOV dword ptr [EBX + 0x8],EAX
00415933 : MOV dword ptr [EBX + 0x4],ESI
00415936 : JMP 0x00415a92
0041597c : SUB ESI,dword ptr [EBP + 0xc]
0041597f : MOV EAX,0x38e38e39
00415984 : IMUL ESI
00415986 : SAR EDX,0x3
00415989 : MOV ECX,EDX
0041598b : SHR ECX,0x1f
0041598e : ADD ECX,EDX
00415990 : MOV EDI,dword ptr [EBP + -0x3c]
00415993 : CMP ECX,0x1
00415996 : JNC 0x00415a32
0041599c : LEA EDX,[EBP + -0x38]
0041599f : PUSH EDX
004159a0 : CALL 0x00416560
004159a5 : MOV dword ptr [EBP + -0x4],0x2
004159ac : MOV EAX,dword ptr [EBP + 0xc]
004159af : LEA EDX,[EAX + 0x24]
004159b2 : MOV ECX,dword ptr [EBX + 0x8]
004159b5 : PUSH ECX
004159b6 : PUSH EAX
004159b7 : CALL 0x004170d0
004159bc : MOV byte ptr [EBP + -0x4],0x3
004159c0 : MOV EDI,dword ptr [EBX + 0x8]
004159c3 : LEA EDX,[EBP + -0x38]
004159c6 : PUSH EDX
004159c7 : MOV ECX,EDI
004159c9 : SUB ECX,dword ptr [EBP + 0xc]
004159cc : MOV EAX,0x38e38e39
004159d1 : IMUL ECX
004159d3 : SAR EDX,0x3
004159d6 : MOV EAX,EDX
004159d8 : SHR EAX,0x1f
004159db : ADD EAX,EDX
004159dd : MOV ESI,0x1
004159e2 : SUB ESI,EAX
004159e4 : CALL 0x004151e0
004159e9 : MOV dword ptr [EBP + -0x4],0x2
004159f0 : ADD dword ptr [EBX + 0x8],0x24
004159f4 : MOV EBX,dword ptr [EBX + 0x8]
004159f7 : LEA EAX,[EBX + -0x24]
004159fa : PUSH EAX
004159fb : LEA EDI,[EBP + -0x38]
004159fe : MOV EAX,dword ptr [EBP + 0xc]
00415a01 : CALL 0x00417790
00415a06 : ADD ESP,0x4
00415a09 : MOV dword ptr [EBP + -0x4],0xffffffff
00415a10 : MOV ECX,EDI
00415a12 : PUSH ECX
00415a13 : JMP 0x00415a8d
00415a32 : LEA EAX,[EBP + -0x38]
00415a35 : PUSH EAX
00415a36 : CALL 0x00416560
00415a3b : MOV dword ptr [EBP + -0x4],0x5
00415a42 : MOV ESI,dword ptr [EBX + 0x8]
00415a45 : LEA EDI,[ESI + -0x24]
00415a48 : PUSH ESI
00415a49 : PUSH EDI
00415a4a : MOV EDX,ESI
00415a4c : CALL 0x004170d0
00415a51 : MOV dword ptr [EBX + 0x8],EAX
00415a54 : MOV byte ptr [EBP + -0x3c],0x0
00415a58 : MOV ECX,dword ptr [EBP + -0x3c]
00415a5b : PUSH ECX
00415a5c : MOV EDX,dword ptr [EBP + -0x3c]
00415a5f : PUSH EDX
00415a60 : MOV EAX,dword ptr [EBP + -0x3c]
00415a63 : PUSH EAX
00415a64 : MOV ECX,dword ptr [EBP + 0xc]
00415a67 : PUSH ECX
00415a68 : MOV EAX,ESI
00415a6a : MOV ECX,EDI
00415a6c : CALL 0x00417e00
00415a71 : MOV EAX,dword ptr [EBP + 0xc]
00415a74 : LEA EDX,[EAX + 0x24]
00415a77 : PUSH EDX
00415a78 : LEA EDI,[EBP + -0x38]
00415a7b : CALL 0x00417790
00415a80 : ADD ESP,0x14
00415a83 : MOV dword ptr [EBP + -0x4],0xffffffff
00415a8a : MOV EAX,EDI
00415a8c : PUSH EAX
00415a8d : CALL 0x00414770
00415a92 : MOV ECX,dword ptr [EBP + -0xc]
00415a95 : MOV dword ptr FS:[0x0],ECX
00415a9c : POP ECX
00415a9d : POP EDI
00415a9e : POP ESI
00415a9f : POP EBX
00415aa0 : MOV ECX,dword ptr [EBP + -0x14]
00415aa3 : XOR ECX,EBP
00415aa5 : CALL 0x00633e6b
00415aaa : MOV ESP,EBP
00415aac : POP EBP
00415aad : RET 0xc

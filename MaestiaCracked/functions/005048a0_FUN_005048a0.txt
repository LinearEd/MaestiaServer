PROGRAM  : Maestia.exe
FUNCTION : FUN_005048a0
ENTRY    : 005048a0
BODY     : [[005048a0, 00504a37]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005048a0(void)

{
  GRefCountNTSImpl *this;
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  int in_ECX;
  int iVar4;
  int local_8c;
  int local_88;
  undefined **local_84;
  undefined4 local_80;
  undefined4 local_6c;
  undefined4 local_68;
  undefined4 local_64;
  undefined2 local_60;
  undefined2 local_5e;
  undefined1 local_5c;
  undefined2 local_5a;
  undefined1 local_58 [44];
  undefined1 local_2c [44];
  
  if ((*(int *)(in_ECX + 0xd0) != 0) &&
     (local_88 = *(int *)(*(int *)(in_ECX + 0xd0) + 8), local_88 != 0)) {
    local_8c = 0;
    do {
      if (**(int **)(in_ECX + 0xd0) != 0) {
        iVar1 = FUN_0057dec0(0,&DAT_00b8653c,0xffffffff);
        iVar2 = FUN_0057dec0(0,"a:link",0xffffffff);
        uVar3 = FUN_00515dd0(in_ECX);
        local_80 = 1;
        local_84 = &PTR_FUN_00b86530;
        FUN_0051c350(uVar3);
        FUN_0051c350(uVar3);
        local_6c = 0;
        local_68 = 0;
        local_64 = 0xff000000;
        local_60 = 0;
        local_5e = 0;
        local_5c = 0;
        local_5a = 0;
        if (iVar1 != 0) {
          uVar3 = FUN_0055fca0(local_58,iVar1);
          FUN_00504700(uVar3);
          FUN_00504260();
        }
        if (iVar2 != 0) {
          uVar3 = FUN_0055fca0(local_2c,iVar2);
          FUN_00504700(uVar3);
          FUN_00504260();
        }
        iVar1 = *(int *)(*(int *)(in_ECX + 0xd0) + 4);
        iVar2 = *(int *)(iVar1 + local_8c);
        iVar4 = *(int *)(iVar1 + 4 + local_8c) + iVar2;
        FUN_005449c0(&local_84,iVar2,iVar4);
        iVar1 = *(int *)(*(int *)(in_ECX + 0xd0) + 4) + local_8c;
        uVar3 = FUN_00544000(iVar2,iVar4);
        this = *(GRefCountNTSImpl **)(iVar1 + 8);
        if (this != (GRefCountNTSImpl *)0x0) {
          GRefCountNTSImpl::Release(this);
        }
        *(undefined4 *)(iVar1 + 8) = uVar3;
        FUN_00504260();
      }
      local_8c = local_8c + 0x14;
      local_88 = local_88 + -1;
    } while (local_88 != 0);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005048a0 : SUB ESP,0x8c
005048a6 : PUSH ESI
005048a7 : MOV ESI,ECX
005048a9 : MOV EAX,dword ptr [ESI + 0xd0]
005048af : TEST EAX,EAX
005048b1 : JZ 0x00504a30
005048b7 : MOV EAX,dword ptr [EAX + 0x8]
005048ba : TEST EAX,EAX
005048bc : JBE 0x00504a30
005048c2 : PUSH EBX
005048c3 : PUSH EBP
005048c4 : MOV dword ptr [ESP + 0xc],0x0
005048cc : MOV dword ptr [ESP + 0x10],EAX
005048d0 : PUSH EDI
005048d1 : MOV EAX,dword ptr [ESI + 0xd0]
005048d7 : CMP dword ptr [EAX],0x0
005048da : JZ 0x00504a1d
005048e0 : MOV EAX,dword ptr [EAX]
005048e2 : PUSH -0x1
005048e4 : PUSH 0xb8653c
005048e9 : PUSH 0x0
005048eb : LEA ECX,[EAX + 0x30]
005048ee : CALL 0x0057dec0
005048f3 : MOV EBP,EAX
005048f5 : MOV EAX,dword ptr [ESI + 0xd0]
005048fb : MOV EAX,dword ptr [EAX]
005048fd : PUSH -0x1
005048ff : PUSH 0xb86534
00504904 : PUSH 0x0
00504906 : LEA ECX,[EAX + 0x30]
00504909 : CALL 0x0057dec0
0050490e : PUSH ESI
0050490f : MOV EBX,EAX
00504911 : CALL 0x00515dd0
00504916 : MOV EDI,EAX
00504918 : MOV dword ptr [ESP + 0x18],0xcd3f2c
00504920 : PUSH EDI
00504921 : LEA ECX,[ESP + 0x24]
00504925 : MOV dword ptr [ESP + 0x20],0x1
0050492d : MOV dword ptr [ESP + 0x1c],0xb86530
00504935 : CALL 0x0051c350
0050493a : PUSH EDI
0050493b : LEA ECX,[ESP + 0x2c]
0050493f : CALL 0x0051c350
00504944 : XOR EDI,EDI
00504946 : XOR ECX,ECX
00504948 : XOR EDX,EDX
0050494a : XOR EAX,EAX
0050494c : MOV dword ptr [ESP + 0x30],EDI
00504950 : MOV dword ptr [ESP + 0x34],EDI
00504954 : MOV dword ptr [ESP + 0x38],0xff000000
0050495c : MOV word ptr [ESP + 0x3c],CX
00504961 : MOV word ptr [ESP + 0x3e],DX
00504966 : MOV byte ptr [ESP + 0x40],CL
0050496a : MOV word ptr [ESP + 0x42],AX
0050496f : CMP EBP,EDI
00504971 : JZ 0x00504995
00504973 : PUSH EBP
00504974 : LEA ECX,[ESP + 0x48]
00504978 : PUSH ECX
00504979 : LEA ECX,[ESP + 0x20]
0050497d : CALL 0x0055fca0
00504982 : PUSH EAX
00504983 : LEA ECX,[ESP + 0x1c]
00504987 : CALL 0x00504700
0050498c : LEA ECX,[ESP + 0x44]
00504990 : CALL 0x00504260
00504995 : CMP EBX,EDI
00504997 : JZ 0x005049bb
00504999 : PUSH EBX
0050499a : LEA EDX,[ESP + 0x74]
0050499e : PUSH EDX
0050499f : LEA ECX,[ESP + 0x20]
005049a3 : CALL 0x0055fca0
005049a8 : PUSH EAX
005049a9 : LEA ECX,[ESP + 0x1c]
005049ad : CALL 0x00504700
005049b2 : LEA ECX,[ESP + 0x70]
005049b6 : CALL 0x00504260
005049bb : MOV EAX,dword ptr [ESI + 0xd0]
005049c1 : MOV ECX,dword ptr [EAX + 0x4]
005049c4 : MOV EDX,dword ptr [ESP + 0x10]
005049c8 : MOV EBX,dword ptr [ECX + EDX*0x1]
005049cb : MOV EDI,dword ptr [ECX + EDX*0x1 + 0x4]
005049cf : LEA EAX,[ECX + EDX*0x1]
005049d2 : MOV ECX,dword ptr [ESI + 0xa0]
005049d8 : ADD EDI,EBX
005049da : PUSH EDI
005049db : PUSH EBX
005049dc : LEA EAX,[ESP + 0x20]
005049e0 : PUSH EAX
005049e1 : CALL 0x005449c0
005049e6 : MOV EDX,dword ptr [ESI + 0xd0]
005049ec : MOV ECX,dword ptr [ESI + 0xa0]
005049f2 : MOV EBP,dword ptr [EDX + 0x4]
005049f5 : MOV ECX,dword ptr [ECX + 0xc]
005049f8 : ADD EBP,dword ptr [ESP + 0x10]
005049fc : PUSH EDI
005049fd : PUSH EBX
005049fe : CALL 0x00544000
00504a03 : MOV ECX,dword ptr [EBP + 0x8]
00504a06 : MOV EDI,EAX
00504a08 : TEST ECX,ECX
00504a0a : JZ 0x00504a11
00504a0c : CALL 0x004ff7c0
00504a11 : LEA ECX,[ESP + 0x18]
00504a15 : MOV dword ptr [EBP + 0x8],EDI
00504a18 : CALL 0x00504260
00504a1d : ADD dword ptr [ESP + 0x10],0x14
00504a22 : SUB dword ptr [ESP + 0x14],0x1
00504a27 : JNZ 0x005048d1
00504a2d : POP EDI
00504a2e : POP EBP
00504a2f : POP EBX
00504a30 : POP ESI
00504a31 : ADD ESP,0x8c
00504a37 : RET

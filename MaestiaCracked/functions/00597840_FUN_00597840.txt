PROGRAM  : Maestia.exe
FUNCTION : FUN_00597840
ENTRY    : 00597840
BODY     : [[00597840, 00597b74]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

int * FUN_00597840(int *param_1,int *param_2,int *param_3)

{
  char cVar1;
  bool bVar2;
  bool bVar3;
  char cVar4;
  int iVar5;
  int iVar6;
  int *in_ECX;
  int unaff_EBX;
  int *local_18;
  int *local_14;
  uint uStack_10;
  undefined4 uStack_c;
  undefined4 uStack_8;
  
  bVar2 = false;
  local_18 = (int *)0x0;
  local_14 = in_ECX;
  cVar4 = (**(code **)(*in_ECX + 0x48))(param_1);
  if (cVar4 == '\0') {
    return param_2;
  }
  if ((param_2 != (int *)0x0) && (iVar5 = (**(code **)(*param_2 + 0x9c))(), iVar5 == 4)) {
    iVar5 = (**(code **)(*param_2 + 0x19c))();
    local_14 = (int *)0x0;
    uStack_10 = 0;
    if (iVar5 != 0) {
      cVar4 = (**(code **)(**(int **)in_ECX[3] + 0x44))
                        (&local_14,"_global.gfx_ime_candidate_list_state");
      if (cVar4 == '\0') {
        FUN_005975d0(0);
      }
      iVar5 = FUN_0056b260();
      if ((iVar5 != 0) && ((double)CONCAT44(uStack_8,uStack_c) == 2.0)) {
        FUN_0058fbf0();
      }
    }
    if ((uStack_10 >> 6 & 1) != 0) {
      FUN_00588b40(&local_14,uStack_c);
    }
  }
  if ((param_1 == (int *)0x0) || (iVar5 = (**(code **)(*param_1 + 0x9c))(), iVar5 != 4)) {
LAB_00597b45:
    if (((param_2 != (int *)0x0) && (iVar5 = (**(code **)(*param_2 + 0x9c))(), iVar5 == 4)) &&
       (cVar4 = (**(code **)(*param_2 + 0x170))(), cVar4 != '\0')) {
      cVar4 = '\x01';
      goto LAB_00597ae1;
    }
  }
  else {
    if (param_2 != (int *)0x0) {
      (**(code **)(*param_2 + 0x9c))();
      FUN_005974b0();
      goto LAB_00597b45;
    }
    if (param_3 != (int *)0x0) {
      FUN_0051b6e0();
      FUN_0051fc70();
      cVar4 = (**(code **)(*in_ECX + 0x54))();
      if (cVar4 != '\0') {
LAB_00597b1b:
        FUN_0045b730();
        return param_1;
      }
      local_14 = (int *)((uint)local_14 & 0xffffff00);
      do {
        (**(code **)(*param_3 + 0x5c))();
        iVar5 = FUN_00525380("isLanguageBar",0xd,0);
        *(int *)(iVar5 + 8) = *(int *)(iVar5 + 8) + 1;
        iVar6 = (**(code **)(*param_3 + 0x5c))();
        cVar4 = (**(code **)(param_3[0x1a] + 0x2c))(iVar6 + 0x78);
        if (cVar4 == '\0') {
          bVar2 = true;
          (**(code **)(*param_3 + 0x5c))();
          unaff_EBX = FUN_00525380("isStatusWindow",0xe,0);
          *(int *)(unaff_EBX + 8) = *(int *)(unaff_EBX + 8) + 1;
          iVar6 = (**(code **)(*param_3 + 0x5c))();
          cVar4 = (**(code **)(param_3[0x1a] + 0x2c))(iVar6 + 0x78);
          bVar3 = false;
          if (cVar4 != '\0') goto LAB_00597a35;
        }
        else {
LAB_00597a35:
          bVar3 = true;
        }
        if (bVar2) {
          *(int *)(unaff_EBX + 8) = *(int *)(unaff_EBX + 8) + -1;
          bVar2 = false;
          if (*(int *)(unaff_EBX + 8) == 0) {
            FUN_00525340();
          }
        }
        *(int *)(iVar5 + 8) = *(int *)(iVar5 + 8) + -1;
        if (*(int *)(iVar5 + 8) == 0) {
          FUN_00525340();
        }
        if (bVar3) goto LAB_00597b16;
        param_3 = (int *)param_3[8];
      } while (param_3 != (int *)0x0);
      cVar4 = (**(code **)(_DAT_00000000 + 0x58))();
      if ((cVar4 != '\0') || (cVar4 = (**(code **)(_DAT_00000000 + 0x5c))(), cVar4 != '\0')) {
LAB_00597b16:
        FUN_00526bc0();
        goto LAB_00597b1b;
      }
      FUN_00526bc0();
      FUN_0045b730();
      in_ECX = local_18;
    }
    FUN_005974b0();
  }
  cVar4 = '\0';
LAB_00597ae1:
  cVar1 = *(char *)(in_ECX[3] + 0x14);
  if (cVar1 == cVar4) {
    *(bool *)(in_ECX[3] + 0x14) = cVar1 == '\0';
    (**(code **)(*in_ECX + 0x7c))();
  }
  return param_2;
}



============================================================
DISASSEMBLY
============================================================
00597840 : SUB ESP,0x1c
00597843 : PUSH EBX
00597844 : PUSH EBP
00597845 : MOV EBP,ECX
00597847 : MOV ECX,dword ptr [ESP + 0x28]
0059784b : PUSH ESI
0059784c : XOR EBX,EBX
0059784e : MOV dword ptr [ESP + 0x10],EBX
00597852 : MOV EAX,dword ptr [EBP]
00597855 : MOV EDX,dword ptr [EAX + 0x48]
00597858 : PUSH EDI
00597859 : PUSH ECX
0059785a : MOV ECX,EBP
0059785c : MOV dword ptr [ESP + 0x1c],EBP
00597860 : CALL EDX
00597862 : MOV EDI,dword ptr [ESP + 0x38]
00597866 : TEST AL,AL
00597868 : JZ 0x00597b06
0059786e : TEST EDI,EDI
00597870 : JZ 0x0059791d
00597876 : MOV EAX,dword ptr [EDI]
00597878 : MOV EDX,dword ptr [EAX + 0x9c]
0059787e : MOV ECX,EDI
00597880 : CALL EDX
00597882 : CMP EAX,0x4
00597885 : JNZ 0x0059791d
0059788b : MOV EAX,dword ptr [EDI]
0059788d : MOV EDX,dword ptr [EAX + 0x19c]
00597893 : MOV ECX,EDI
00597895 : CALL EDX
00597897 : MOV ESI,EAX
00597899 : XOR EAX,EAX
0059789b : MOV dword ptr [ESP + 0x1c],EAX
0059789f : MOV dword ptr [ESP + 0x20],EAX
005978a3 : CMP ESI,EAX
005978a5 : JZ 0x005978fe
005978a7 : MOV EAX,dword ptr [EBP + 0xc]
005978aa : MOV ECX,dword ptr [EAX]
005978ac : MOV EDX,dword ptr [ECX]
005978ae : MOV EDX,dword ptr [EDX + 0x44]
005978b1 : PUSH 0xb8ec58
005978b6 : LEA EAX,[ESP + 0x20]
005978ba : PUSH EAX
005978bb : CALL EDX
005978bd : TEST AL,AL
005978bf : JNZ 0x005978d2
005978c1 : FLDZ
005978c3 : SUB ESP,0x8
005978c6 : LEA ECX,[ESP + 0x24]
005978ca : FSTP double ptr [ESP]
005978cd : CALL 0x005975d0
005978d2 : MOV EAX,dword ptr [EBP + 0xc]
005978d5 : MOV ECX,dword ptr [EAX]
005978d7 : PUSH 0x270f
005978dc : CALL 0x0056b260
005978e1 : MOV ECX,EAX
005978e3 : TEST ECX,ECX
005978e5 : JZ 0x005978fe
005978e7 : FLD double ptr [0x00cdf2d0]
005978ed : FCOMP double ptr [ESP + 0x24]
005978f1 : FNSTSW AX
005978f3 : TEST AH,0x44
005978f6 : JP 0x005978fe
005978f8 : PUSH ESI
005978f9 : CALL 0x0058fbf0
005978fe : MOV ECX,dword ptr [ESP + 0x20]
00597902 : SHR ECX,0x6
00597905 : TEST CL,0x1
00597908 : JZ 0x0059791d
0059790a : MOV EDX,dword ptr [ESP + 0x24]
0059790e : MOV ECX,dword ptr [ESP + 0x1c]
00597912 : PUSH EDX
00597913 : LEA EAX,[ESP + 0x20]
00597917 : PUSH EAX
00597918 : CALL 0x00588b40
0059791d : MOV ECX,dword ptr [ESP + 0x34]
00597921 : TEST ECX,ECX
00597923 : JZ 0x00597b45
00597929 : MOV EDX,dword ptr [ECX]
0059792b : MOV EAX,dword ptr [EDX + 0x9c]
00597931 : CALL EAX
00597933 : CMP EAX,0x4
00597936 : JNZ 0x00597b45
0059793c : TEST EDI,EDI
0059793e : JNZ 0x00597b32
00597944 : MOV ESI,dword ptr [ESP + 0x3c]
00597948 : TEST ESI,ESI
0059794a : JZ 0x00597ad8
00597950 : LEA ECX,[ESP + 0x3c]
00597954 : CALL 0x0051b6e0
00597959 : LEA ECX,[ESP + 0x3c]
0059795d : PUSH ECX
0059795e : MOV ECX,ESI
00597960 : CALL 0x0051fc70
00597965 : MOV EAX,dword ptr [ESP + 0x3c]
00597969 : MOV EDX,dword ptr [EBP]
0059796c : AND EAX,0xfffffffc
0059796f : ADD EAX,0x8
00597972 : PUSH EAX
00597973 : MOV EAX,dword ptr [EDX + 0x54]
00597976 : MOV ECX,EBP
00597978 : CALL EAX
0059797a : TEST AL,AL
0059797c : JNZ 0x00597b1b
00597982 : MOV byte ptr [ESP + 0x1c],BL
00597986 : MOV EDX,dword ptr [ESI]
00597988 : MOV EAX,dword ptr [EDX + 0x5c]
0059798b : MOV EBP,0x1
00597990 : MOV ECX,ESI
00597992 : OR EBX,EBP
00597994 : CALL EAX
00597996 : MOV EAX,dword ptr [EAX + 0x78]
00597999 : PUSH 0x0
0059799b : ADD EAX,0x8
0059799e : PUSH 0xd
005979a0 : PUSH 0xb8ec90
005979a5 : LEA ECX,[EAX + 0x24c]
005979ab : CALL 0x00525380
005979b0 : MOV dword ptr [ESP + 0x14],EAX
005979b4 : ADD dword ptr [EAX + 0x8],EBP
005979b7 : MOV EDX,dword ptr [ESI]
005979b9 : MOV EAX,dword ptr [EDX + 0x5c]
005979bc : MOV ECX,ESI
005979be : CALL EAX
005979c0 : MOV EDX,dword ptr [ESI + 0x68]
005979c3 : MOV EDX,dword ptr [EDX + 0x2c]
005979c6 : LEA ECX,[ESP + 0x1c]
005979ca : PUSH ECX
005979cb : LEA EDI,[ESI + 0x68]
005979ce : LEA ECX,[ESP + 0x18]
005979d2 : PUSH ECX
005979d3 : ADD EAX,0x78
005979d6 : PUSH EAX
005979d7 : MOV ECX,EDI
005979d9 : CALL EDX
005979db : TEST AL,AL
005979dd : JNZ 0x00597a35
005979df : MOV EAX,dword ptr [ESI]
005979e1 : MOV EDX,dword ptr [EAX + 0x5c]
005979e4 : MOV ECX,ESI
005979e6 : OR EBX,0x2
005979e9 : CALL EDX
005979eb : MOV EAX,dword ptr [EAX + 0x78]
005979ee : PUSH 0x0
005979f0 : ADD EAX,0x8
005979f3 : PUSH 0xe
005979f5 : PUSH 0xb8ec80
005979fa : LEA ECX,[EAX + 0x24c]
00597a00 : CALL 0x00525380
00597a05 : MOV dword ptr [ESP + 0x10],EAX
00597a09 : ADD dword ptr [EAX + 0x8],EBP
00597a0c : MOV EAX,dword ptr [ESI]
00597a0e : MOV EDX,dword ptr [EAX + 0x5c]
00597a11 : MOV ECX,ESI
00597a13 : CALL EDX
00597a15 : MOV EDX,dword ptr [EDI]
00597a17 : MOV EDX,dword ptr [EDX + 0x2c]
00597a1a : LEA ECX,[ESP + 0x1c]
00597a1e : PUSH ECX
00597a1f : LEA ECX,[ESP + 0x14]
00597a23 : PUSH ECX
00597a24 : ADD EAX,0x78
00597a27 : PUSH EAX
00597a28 : MOV ECX,EDI
00597a2a : CALL EDX
00597a2c : MOV byte ptr [ESP + 0x30],0x0
00597a31 : TEST AL,AL
00597a33 : JZ 0x00597a3a
00597a35 : MOV byte ptr [ESP + 0x30],0x1
00597a3a : TEST BL,0x2
00597a3d : JZ 0x00597a58
00597a3f : MOV EAX,dword ptr [ESP + 0x10]
00597a43 : DEC dword ptr [EAX + 0x8]
00597a46 : MOV ECX,EAX
00597a48 : ADD EAX,0x8
00597a4b : AND EBX,0xfffffffd
00597a4e : CMP dword ptr [EAX],0x0
00597a51 : JNZ 0x00597a58
00597a53 : CALL 0x00525340
00597a58 : TEST BL,0x1
00597a5b : JZ 0x00597a76
00597a5d : MOV EAX,dword ptr [ESP + 0x14]
00597a61 : DEC dword ptr [EAX + 0x8]
00597a64 : MOV ECX,EAX
00597a66 : ADD EAX,0x8
00597a69 : AND EBX,0xfffffffe
00597a6c : CMP dword ptr [EAX],0x0
00597a6f : JNZ 0x00597a76
00597a71 : CALL 0x00525340
00597a76 : CMP byte ptr [ESP + 0x30],0x0
00597a7b : JNZ 0x00597b12
00597a81 : MOV ESI,dword ptr [ESI + 0x20]
00597a84 : TEST ESI,ESI
00597a86 : JNZ 0x00597986
00597a8c : MOV EAX,dword ptr [ESP + 0x3c]
00597a90 : MOV ESI,dword ptr [ESP + 0x18]
00597a94 : MOV EDX,dword ptr [ESI]
00597a96 : AND EAX,0xfffffffc
00597a99 : ADD EAX,0x8
00597a9c : PUSH EAX
00597a9d : MOV EAX,dword ptr [EDX + 0x58]
00597aa0 : MOV ECX,ESI
00597aa2 : CALL EAX
00597aa4 : TEST AL,AL
00597aa6 : JNZ 0x00597b12
00597aa8 : MOV EAX,dword ptr [ESP + 0x3c]
00597aac : MOV EDX,dword ptr [ESI]
00597aae : AND EAX,0xfffffffc
00597ab1 : ADD EAX,0x8
00597ab4 : PUSH EAX
00597ab5 : MOV EAX,dword ptr [EDX + 0x5c]
00597ab8 : MOV ECX,ESI
00597aba : CALL EAX
00597abc : LEA ECX,[ESP + 0x1c]
00597ac0 : TEST AL,AL
00597ac2 : JNZ 0x00597b16
00597ac4 : CALL 0x00526bc0
00597ac9 : LEA ECX,[ESP + 0x3c]
00597acd : CALL 0x0045b730
00597ad2 : MOV EDI,dword ptr [ESP + 0x38]
00597ad6 : MOV EBP,ESI
00597ad8 : MOV ECX,EBP
00597ada : CALL 0x005974b0
00597adf : XOR DL,DL
00597ae1 : MOV EAX,dword ptr [EBP + 0xc]
00597ae4 : MOV CL,byte ptr [EAX + 0x14]
00597ae7 : MOV byte ptr [ESP + 0x34],DL
00597aeb : CMP CL,DL
00597aed : JNZ 0x00597b06
00597aef : TEST CL,CL
00597af1 : SETZ CL
00597af4 : MOV byte ptr [EAX + 0x14],CL
00597af7 : MOV EDX,dword ptr [EBP]
00597afa : MOV EAX,dword ptr [ESP + 0x34]
00597afe : MOV EDX,dword ptr [EDX + 0x7c]
00597b01 : PUSH EAX
00597b02 : MOV ECX,EBP
00597b04 : CALL EDX
00597b06 : MOV EAX,EDI
00597b08 : POP EDI
00597b09 : POP ESI
00597b0a : POP EBP
00597b0b : POP EBX
00597b0c : ADD ESP,0x1c
00597b0f : RET 0x10
00597b12 : LEA ECX,[ESP + 0x1c]
00597b16 : CALL 0x00526bc0
00597b1b : LEA ECX,[ESP + 0x3c]
00597b1f : CALL 0x0045b730
00597b24 : MOV EAX,dword ptr [ESP + 0x34]
00597b28 : POP EDI
00597b29 : POP ESI
00597b2a : POP EBP
00597b2b : POP EBX
00597b2c : ADD ESP,0x1c
00597b2f : RET 0x10
00597b32 : MOV EDX,dword ptr [EDI]
00597b34 : MOV EAX,dword ptr [EDX + 0x9c]
00597b3a : MOV ECX,EDI
00597b3c : CALL EAX
00597b3e : MOV ECX,EBP
00597b40 : CALL 0x005974b0
00597b45 : TEST EDI,EDI
00597b47 : JZ 0x00597adf
00597b49 : MOV EDX,dword ptr [EDI]
00597b4b : MOV EAX,dword ptr [EDX + 0x9c]
00597b51 : MOV ECX,EDI
00597b53 : CALL EAX
00597b55 : CMP EAX,0x4
00597b58 : JNZ 0x00597adf
00597b5a : MOV EDX,dword ptr [EDI]
00597b5c : MOV EAX,dword ptr [EDX + 0x170]
00597b62 : MOV ECX,EDI
00597b64 : CALL EAX
00597b66 : TEST AL,AL
00597b68 : JZ 0x00597adf
00597b6e : MOV DL,0x1
00597b70 : JMP 0x00597ae1

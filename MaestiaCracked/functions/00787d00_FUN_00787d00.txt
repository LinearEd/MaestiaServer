PROGRAM  : Maestia.exe
FUNCTION : FUN_00787d00
ENTRY    : 00787d00
BODY     : [[00787d00, 00787dac] [00787db0, 00787edd]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00787d00(void *param_1,int param_2,size_t param_3,int param_4)

{
  size_t _Size;
  void *in_EAX;
  undefined4 *puVar1;
  int in_EDX;
  ushort *puVar2;
  int iVar3;
  
  _Size = param_3;
  puVar2 = (ushort *)(*(int *)((int)param_1 + 0xc) + param_4 * 2);
  iVar3 = param_2 * param_3 + *(int *)((int)param_1 + 8);
  if (param_3 == 4) {
    if (0 < in_EDX) {
      puVar1 = (undefined4 *)((int)in_EAX + 8);
      do {
        puVar1[-2] = *(undefined4 *)(iVar3 + (uint)*puVar2 * 4);
        puVar1[-1] = *(undefined4 *)(iVar3 + (uint)puVar2[1] * 4);
        *puVar1 = *(undefined4 *)(iVar3 + (uint)puVar2[2] * 4);
        puVar2 = puVar2 + 3;
        puVar1 = puVar1 + 3;
        in_EDX = in_EDX + -1;
      } while (in_EDX != 0);
    }
  }
  else if (param_3 == 8) {
    if (0 < in_EDX) {
      puVar1 = (undefined4 *)((int)in_EAX + 8);
      do {
        puVar1[-2] = *(undefined4 *)(iVar3 + (uint)*puVar2 * 8);
        puVar1[-1] = *(undefined4 *)(iVar3 + 4 + (uint)*puVar2 * 8);
        *puVar1 = *(undefined4 *)(iVar3 + (uint)puVar2[1] * 8);
        puVar1[1] = *(undefined4 *)(iVar3 + 4 + (uint)puVar2[1] * 8);
        puVar1[2] = *(undefined4 *)(iVar3 + (uint)puVar2[2] * 8);
        puVar1[3] = *(undefined4 *)(iVar3 + 4 + (uint)puVar2[2] * 8);
        puVar2 = puVar2 + 3;
        puVar1 = puVar1 + 6;
        in_EDX = in_EDX + -1;
      } while (in_EDX != 0);
      return;
    }
  }
  else if (param_3 == 0xc) {
    if (0 < in_EDX) {
      puVar1 = (undefined4 *)((int)in_EAX + 8);
      do {
        puVar1[-2] = *(undefined4 *)(iVar3 + (uint)*puVar2 * 0xc);
        puVar1[-1] = *(undefined4 *)(iVar3 + 4 + (uint)*puVar2 * 0xc);
        *puVar1 = *(undefined4 *)(iVar3 + 8 + (uint)*puVar2 * 0xc);
        puVar1[1] = *(undefined4 *)(iVar3 + (uint)puVar2[1] * 0xc);
        puVar1[2] = *(undefined4 *)(iVar3 + 4 + (uint)puVar2[1] * 0xc);
        puVar1[3] = *(undefined4 *)(iVar3 + 8 + (uint)puVar2[1] * 0xc);
        puVar1[4] = *(undefined4 *)(iVar3 + (uint)puVar2[2] * 0xc);
        puVar1[5] = *(undefined4 *)(iVar3 + 4 + (uint)puVar2[2] * 0xc);
        puVar1[6] = *(undefined4 *)(iVar3 + 8 + (uint)puVar2[2] * 0xc);
        puVar2 = puVar2 + 3;
        puVar1 = puVar1 + 9;
        in_EDX = in_EDX + -1;
      } while (in_EDX != 0);
      return;
    }
  }
  else {
    param_1 = in_EAX;
    param_3 = in_EDX;
    if (0 < in_EDX) {
      do {
        _memcpy(param_1,(void *)(*puVar2 * _Size + iVar3),_Size);
        _memcpy(param_1,(void *)(puVar2[1] * _Size + iVar3),_Size);
        _memcpy(param_1,(void *)(puVar2[2] * _Size + iVar3),_Size);
        param_1 = (void *)((int)param_1 + _Size * 3);
        puVar2 = puVar2 + 3;
        param_3 = param_3 + -1;
      } while (param_3 != 0);
      return;
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00787d00 : PUSH EBP
00787d01 : MOV EBP,ESP
00787d03 : MOV ECX,dword ptr [EBP + 0x8]
00787d06 : MOV ECX,dword ptr [ECX + 0xc]
00787d09 : PUSH EBX
00787d0a : MOV EBX,dword ptr [EBP + 0x10]
00787d0d : PUSH ESI
00787d0e : MOV ESI,dword ptr [EBP + 0x14]
00787d11 : PUSH EDI
00787d12 : MOV EDI,dword ptr [EBP + 0xc]
00787d15 : IMUL EDI,EBX
00787d18 : LEA ESI,[ECX + ESI*0x2]
00787d1b : MOV ECX,dword ptr [EBP + 0x8]
00787d1e : ADD EDI,dword ptr [ECX + 0x8]
00787d21 : MOV dword ptr [EBP + 0x8],EAX
00787d24 : CMP EBX,0x4
00787d27 : JZ 0x00787ea2
00787d2d : CMP EBX,0x8
00787d30 : JZ 0x00787e3f
00787d36 : CMP EBX,0xc
00787d39 : JZ 0x00787da0
00787d3b : TEST EDX,EDX
00787d3d : JLE 0x00787ed7
00787d43 : MOV dword ptr [EBP + 0x10],EDX
00787d46 : MOVZX EDX,word ptr [ESI]
00787d49 : MOV EAX,dword ptr [EBP + 0x8]
00787d4c : IMUL EDX,EBX
00787d4f : PUSH EBX
00787d50 : ADD EDX,EDI
00787d52 : PUSH EDX
00787d53 : PUSH EAX
00787d54 : CALL 0x0063ae40
00787d59 : MOVZX ECX,word ptr [ESI + 0x2]
00787d5d : MOV EDX,dword ptr [EBP + 0x8]
00787d60 : IMUL ECX,EBX
00787d63 : ADD ESI,0x2
00787d66 : PUSH EBX
00787d67 : ADD ECX,EDI
00787d69 : PUSH ECX
00787d6a : PUSH EDX
00787d6b : CALL 0x0063ae40
00787d70 : MOVZX EAX,word ptr [ESI + 0x2]
00787d74 : MOV ECX,dword ptr [EBP + 0x8]
00787d77 : IMUL EAX,EBX
00787d7a : ADD ESI,0x2
00787d7d : PUSH EBX
00787d7e : ADD EAX,EDI
00787d80 : PUSH EAX
00787d81 : PUSH ECX
00787d82 : CALL 0x0063ae40
00787d87 : LEA EAX,[EBX + EBX*0x2]
00787d8a : ADD dword ptr [EBP + 0x8],EAX
00787d8d : ADD ESP,0x24
00787d90 : ADD ESI,0x2
00787d93 : SUB dword ptr [EBP + 0x10],0x1
00787d97 : JNZ 0x00787d46
00787d99 : POP EDI
00787d9a : POP ESI
00787d9b : POP EBX
00787d9c : POP EBP
00787d9d : RET 0x10
00787da0 : TEST EDX,EDX
00787da2 : JLE 0x00787ed7
00787da8 : ADD EAX,0x8
00787dab : JMP 0x00787db0
00787db0 : MOVZX ECX,word ptr [ESI]
00787db3 : LEA ECX,[ECX + ECX*0x2]
00787db6 : MOV ECX,dword ptr [EDI + ECX*0x4]
00787db9 : MOV dword ptr [EAX + -0x8],ECX
00787dbc : MOVZX ECX,word ptr [ESI]
00787dbf : LEA ECX,[ECX + ECX*0x2]
00787dc2 : MOV ECX,dword ptr [EDI + ECX*0x4 + 0x4]
00787dc6 : MOV dword ptr [EAX + -0x4],ECX
00787dc9 : MOVZX ECX,word ptr [ESI]
00787dcc : LEA ECX,[ECX + ECX*0x2]
00787dcf : MOV ECX,dword ptr [EDI + ECX*0x4 + 0x8]
00787dd3 : MOV dword ptr [EAX],ECX
00787dd5 : MOVZX ECX,word ptr [ESI + 0x2]
00787dd9 : LEA ECX,[ECX + ECX*0x2]
00787ddc : MOV ECX,dword ptr [EDI + ECX*0x4]
00787ddf : ADD ESI,0x2
00787de2 : MOV dword ptr [EAX + 0x4],ECX
00787de5 : MOVZX ECX,word ptr [ESI]
00787de8 : LEA ECX,[ECX + ECX*0x2]
00787deb : MOV ECX,dword ptr [EDI + ECX*0x4 + 0x4]
00787def : MOV dword ptr [EAX + 0x8],ECX
00787df2 : MOVZX ECX,word ptr [ESI]
00787df5 : LEA ECX,[ECX + ECX*0x2]
00787df8 : MOV ECX,dword ptr [EDI + ECX*0x4 + 0x8]
00787dfc : MOV dword ptr [EAX + 0xc],ECX
00787dff : MOVZX ECX,word ptr [ESI + 0x2]
00787e03 : ADD ESI,0x2
00787e06 : LEA ECX,[ECX + ECX*0x2]
00787e09 : MOV ECX,dword ptr [EDI + ECX*0x4]
00787e0c : MOV dword ptr [EAX + 0x10],ECX
00787e0f : MOVZX ECX,word ptr [ESI]
00787e12 : LEA ECX,[ECX + ECX*0x2]
00787e15 : MOV ECX,dword ptr [EDI + ECX*0x4 + 0x4]
00787e19 : MOV dword ptr [EAX + 0x14],ECX
00787e1c : MOVZX ECX,word ptr [ESI]
00787e1f : LEA ECX,[ECX + ECX*0x2]
00787e22 : MOV ECX,dword ptr [EDI + ECX*0x4 + 0x8]
00787e26 : MOV dword ptr [EAX + 0x18],ECX
00787e29 : ADD ESI,0x2
00787e2c : ADD EAX,0x24
00787e2f : SUB EDX,0x1
00787e32 : JNZ 0x00787db0
00787e38 : POP EDI
00787e39 : POP ESI
00787e3a : POP EBX
00787e3b : POP EBP
00787e3c : RET 0x10
00787e3f : TEST EDX,EDX
00787e41 : JLE 0x00787ed7
00787e47 : ADD EAX,0x8
00787e4a : LEA EBX,[EBX]
00787e50 : MOVZX ECX,word ptr [ESI]
00787e53 : MOV ECX,dword ptr [EDI + ECX*0x8]
00787e56 : MOV dword ptr [EAX + -0x8],ECX
00787e59 : MOVZX ECX,word ptr [ESI]
00787e5c : MOV ECX,dword ptr [EDI + ECX*0x8 + 0x4]
00787e60 : MOV dword ptr [EAX + -0x4],ECX
00787e63 : MOVZX ECX,word ptr [ESI + 0x2]
00787e67 : MOV ECX,dword ptr [EDI + ECX*0x8]
00787e6a : ADD ESI,0x2
00787e6d : MOV dword ptr [EAX],ECX
00787e6f : MOVZX ECX,word ptr [ESI]
00787e72 : MOV ECX,dword ptr [EDI + ECX*0x8 + 0x4]
00787e76 : MOV dword ptr [EAX + 0x4],ECX
00787e79 : MOVZX ECX,word ptr [ESI + 0x2]
00787e7d : MOV ECX,dword ptr [EDI + ECX*0x8]
00787e80 : ADD ESI,0x2
00787e83 : MOV dword ptr [EAX + 0x8],ECX
00787e86 : MOVZX ECX,word ptr [ESI]
00787e89 : MOV ECX,dword ptr [EDI + ECX*0x8 + 0x4]
00787e8d : MOV dword ptr [EAX + 0xc],ECX
00787e90 : ADD ESI,0x2
00787e93 : ADD EAX,0x18
00787e96 : SUB EDX,0x1
00787e99 : JNZ 0x00787e50
00787e9b : POP EDI
00787e9c : POP ESI
00787e9d : POP EBX
00787e9e : POP EBP
00787e9f : RET 0x10
00787ea2 : TEST EDX,EDX
00787ea4 : JLE 0x00787ed7
00787ea6 : ADD EAX,0x8
00787ea9 : LEA ESP,[ESP]
00787eb0 : MOVZX ECX,word ptr [ESI]
00787eb3 : MOV ECX,dword ptr [EDI + ECX*0x4]
00787eb6 : MOV dword ptr [EAX + -0x8],ECX
00787eb9 : MOVZX ECX,word ptr [ESI + 0x2]
00787ebd : MOV ECX,dword ptr [EDI + ECX*0x4]
00787ec0 : MOV dword ptr [EAX + -0x4],ECX
00787ec3 : MOVZX ECX,word ptr [ESI + 0x4]
00787ec7 : MOV ECX,dword ptr [EDI + ECX*0x4]
00787eca : MOV dword ptr [EAX],ECX
00787ecc : ADD ESI,0x6
00787ecf : ADD EAX,0xc
00787ed2 : SUB EDX,0x1
00787ed5 : JNZ 0x00787eb0
00787ed7 : POP EDI
00787ed8 : POP ESI
00787ed9 : POP EBX
00787eda : POP EBP
00787edb : RET 0x10

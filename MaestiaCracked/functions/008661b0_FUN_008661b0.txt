PROGRAM  : Maestia.exe
FUNCTION : FUN_008661b0
ENTRY    : 008661b0
BODY     : [[008661b0, 00866299] [008662a0, 0086659a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008661b0(int param_1,undefined2 *param_2,undefined4 param_3,char param_4,char param_5)

{
  char cVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  undefined4 uVar5;
  undefined1 auStack_15c [8];
  undefined4 uStack_154;
  int iStack_150;
  int iStack_14c;
  undefined1 *puStack_148;
  undefined ***pppuStack_144;
  uint uStack_140;
  undefined **local_130 [47];
  undefined1 *local_74;
  int *local_70;
  undefined1 local_50 [32];
  undefined2 local_30 [2];
  undefined2 *local_2c;
  undefined4 local_28;
  undefined2 local_24;
  undefined1 local_22;
  undefined4 local_20;
  uint local_1c;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b5f2ae;
  local_10 = ExceptionList;
  uStack_140 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_18 = uStack_140;
  if (*(int *)(param_1 + 0x18a8) != 0) {
    if ((*(char *)(param_1 + 0x65d) == '\0') && (param_5 == '\0')) {
      local_24 = 0;
      local_1c = local_1c & 0xffffff00;
      pppuStack_144 = (undefined ***)local_30;
      local_22 = 1;
      local_20 = 1;
      local_30[0] = 0x2801;
      local_2c = param_2;
      local_28 = param_3;
      puStack_148 = (undefined1 *)0x866237;
      FUN_0041dea0();
    }
    else if (*(char *)(*(int *)(param_1 + 0x18a8) + 0x20) == '\0') {
      pppuStack_144 = (undefined ***)param_2;
      puStack_148 = (undefined1 *)0x86624f;
      iVar2 = FUN_004049b0();
      if ((iVar2 != 0) && (iVar2 = *(int *)(iVar2 + 0x1ac), iVar2 != 0)) {
        local_1c = 7;
        local_20 = 0;
        local_30[0] = 0;
        local_8 = 0;
        local_70 = (int *)(iVar2 + 0x1c4);
        pppuStack_144 = (undefined ***)0x866291;
        local_74 = (undefined1 *)(**(code **)(*(int *)(iVar2 + 0x1c4) + 4))();
        while (local_74 != (undefined1 *)0x0) {
          pppuStack_144 = (undefined ***)0x8662aa;
          iVar3 = FUN_004f5680();
          if (iVar3 != 0) {
            pppuStack_144 = (undefined ***)(iVar3 + 0x18);
            puStack_148 = (undefined1 *)0x8662ba;
            iStack_14c = FUN_00404350();
            local_8._0_1_ = 1;
            pppuStack_144 = (undefined ***)0xffffffff;
            puStack_148 = (undefined1 *)0x0;
            iStack_150 = 0x8662ce;
            FUN_00405eb0();
            local_8 = (uint)local_8._1_3_ << 8;
            pppuStack_144 = (undefined ***)0x8662d9;
            FUN_00406560();
          }
        }
        pppuStack_144 = (undefined ***)0x8662ef;
        cVar1 = FUN_00403810();
        if (cVar1 == '\0') {
          pppuStack_144 = (undefined ***)(iVar2 + 0x59);
          puStack_148 = (undefined1 *)0x866303;
          FUN_00404350();
          local_8 = CONCAT31(local_8._1_3_,2);
          *(undefined2 **)(*(int *)(param_1 + 0x18a8) + 0x24) = param_2;
          *(undefined4 *)(*(int *)(param_1 + 0x18a8) + 0x28) = param_3;
          pppuStack_144 = (undefined ***)0x0;
          *(undefined2 *)(*(int *)(param_1 + 0x18a8) + 0x98) = 0;
          iStack_14c = *(int *)(param_1 + 0x18a8);
          puStack_148 = (undefined1 *)param_1;
          iStack_150 = 0x866344;
          FUN_0083c0e0();
          piVar4 = *(int **)(*(int *)(param_1 + 0x18a8) + 0x30);
          if (piVar4 != (int *)0x0) {
            pppuStack_144 = (undefined ***)0x8;
            puStack_148 = (undefined1 *)0x86635d;
            (**(code **)(*piVar4 + 0x9c))();
          }
          pppuStack_144 = (undefined ***)0x0;
          puStack_148 = (undefined1 *)0x86636c;
          FUN_0083bb00();
          if (param_4 == '\0') {
            pppuStack_144 = (undefined ***)0x1;
            puStack_148 = (undefined1 *)0x0;
            iStack_14c = 1;
            iStack_150 = param_1 + 0x6d8;
            uStack_154 = 0x866472;
            (**(code **)(*(int *)(*(int *)(*(int *)(param_1 + 0x138) + 4) + 0x138 + param_1) + 0x10)
            )();
          }
          else {
            pppuStack_144 = (undefined ***)0x866391;
            cVar1 = FUN_00876040();
            if (cVar1 == '\0') {
              pppuStack_144 = (undefined ***)0x8663a0;
              cVar1 = FUN_00876040();
              if (cVar1 == '\0') {
                pppuStack_144 = (undefined ***)0x1;
                puStack_148 = (undefined1 *)0x0;
                iStack_14c = 1;
                iStack_150 = param_1 + 0x1da8;
                uStack_154 = 0x8663cd;
                (**(code **)(*(int *)(param_1 + 0x138 + *(int *)(*(int *)(param_1 + 0x138) + 4)) +
                            0x10))();
              }
            }
            pppuStack_144 = (undefined ***)0x8663e2;
            FUN_00876080();
            pppuStack_144 = (undefined ***)param_3;
            puStack_148 = (undefined1 *)0x8663eb;
            piVar4 = (int *)FUN_004049b0();
            if (piVar4 != (int *)0x0) {
              pppuStack_144 = (undefined ***)0x8663fd;
              iVar2 = (**(code **)(*piVar4 + 0x38))();
              if (iVar2 != 0) {
                pppuStack_144 = (undefined ***)(piVar4 + 0x11);
                puStack_148 = (undefined1 *)0x86640d;
                FUN_00404350();
                local_8 = CONCAT31(local_8._1_3_,3);
                pppuStack_144 = (undefined ***)0x866421;
                cVar1 = FUN_004049e0();
                if (cVar1 != '\0') {
                  pppuStack_144 = (undefined ***)0x1;
                  puStack_148 = local_50;
                  iStack_14c = 0x866432;
                  FUN_008980b0();
                }
                pppuStack_144 = (undefined ***)0x11;
                puStack_148 = (undefined1 *)0x86643b;
                FUN_0088e570();
                local_8 = CONCAT31(local_8._1_3_,2);
                pppuStack_144 = (undefined ***)0x866447;
                FUN_00406560();
              }
            }
          }
          iVar2 = *(int *)(*(int *)(param_1 + 0x18a8) + 0x30);
          if ((iVar2 != 0) && (*(int *)(iVar2 + 0x288) != 0)) {
            local_74 = auStack_15c;
            FUN_00406460(L"BIP01 L TOE0");
            local_8 = CONCAT31((int3)(local_8 >> 8),2);
            uVar5 = FUN_00a664c0();
            *(undefined4 *)(param_1 + 0x19ec) = uVar5;
          }
          if ((*(int *)(*(int *)(param_1 + 0x18a8) + 0x30) != 0) &&
             (*(int *)(param_1 + 0x19ec) != 0)) {
            pppuStack_144 = local_130;
            puStack_148 = (undefined1 *)0x8664ec;
            iVar2 = FUN_007d5b60();
            local_8._0_1_ = 5;
            pppuStack_144 = (undefined ***)0x8664fd;
            iVar3 = FUN_007cc270();
            *(float *)(param_1 + 0x1a68) = *(float *)(iVar2 + 0x24) - *(float *)(iVar3 + 4);
            local_8 = CONCAT31(local_8._1_3_,2);
            local_130[0] = &PTR_FUN_00cd083c;
          }
          pppuStack_144 = (undefined ***)0x866529;
          local_70 = (int *)(**(code **)(*local_70 + 4))();
          if (local_70 != (int *)0x0) {
            pppuStack_144 = (undefined ***)0x86653a;
            FUN_004f5680();
            pppuStack_144 = (undefined ***)0x0;
            puStack_148 = (undefined1 *)0x1;
            iStack_14c = param_1;
            iStack_150 = 0x866547;
            FUN_00863440();
          }
          pppuStack_144 = (undefined ***)param_2;
          puStack_148 = (undefined1 *)0x866552;
          FUN_00865580();
          pppuStack_144 = (undefined ***)0x866559;
          FUN_00855610();
          pppuStack_144 = (undefined ***)0x1;
          puStack_148 = (undefined1 *)0x866562;
          FUN_00854560();
          local_8 = local_8 & 0xffffff00;
          pppuStack_144 = (undefined ***)0x86656e;
          FUN_00406560();
        }
        local_8 = 0xffffffff;
        pppuStack_144 = (undefined ***)0x86657d;
        FUN_00406560();
      }
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008661b0 : PUSH EBP
008661b1 : MOV EBP,ESP
008661b3 : PUSH -0x1
008661b5 : PUSH 0xb5f2ae
008661ba : MOV EAX,FS:[0x0]
008661c0 : PUSH EAX
008661c1 : SUB ESP,0x120
008661c7 : MOV EAX,[0x00d66fa0]
008661cc : XOR EAX,EBP
008661ce : MOV dword ptr [EBP + -0x14],EAX
008661d1 : PUSH EBX
008661d2 : PUSH ESI
008661d3 : PUSH EDI
008661d4 : PUSH EAX
008661d5 : LEA EAX,[EBP + -0xc]
008661d8 : MOV FS:[0x0],EAX
008661de : MOV EBX,dword ptr [EBP + 0x8]
008661e1 : MOV EAX,dword ptr [EBX + 0x18a8]
008661e7 : XOR ESI,ESI
008661e9 : CMP EAX,ESI
008661eb : JZ 0x0086657d
008661f1 : CMP byte ptr [EBX + 0x65d],0x0
008661f8 : JNZ 0x0086623c
008661fa : CMP byte ptr [EBP + 0x18],0x0
008661fe : JNZ 0x0086623c
00866200 : MOV ECX,dword ptr [EBP + 0xc]
00866203 : MOV EDX,dword ptr [EBP + 0x10]
00866206 : XOR EAX,EAX
00866208 : MOV word ptr [EBP + -0x20],AX
0086620c : MOV byte ptr [EBP + -0x18],AL
0086620f : LEA EAX,[EBP + -0x2c]
00866212 : PUSH EAX
00866213 : LEA EAX,[EBX + 0x19a4]
00866219 : MOV byte ptr [EBP + -0x1e],0x1
0086621d : MOV dword ptr [EBP + -0x1c],0x1
00866224 : MOV byte ptr [EBP + -0x2c],0x1
00866228 : MOV byte ptr [EBP + -0x2b],0x28
0086622c : MOV dword ptr [EBP + -0x28],ECX
0086622f : MOV dword ptr [EBP + -0x24],EDX
00866232 : CALL 0x0041dea0
00866237 : JMP 0x0086657d
0086623c : CMP byte ptr [EAX + 0x20],0x0
00866240 : JNZ 0x0086657d
00866246 : MOV ECX,dword ptr [EBP + 0xc]
00866249 : PUSH ECX
0086624a : CALL 0x004049b0
0086624f : ADD ESP,0x4
00866252 : CMP EAX,ESI
00866254 : JZ 0x0086657d
0086625a : MOV EDI,dword ptr [EAX + 0x1ac]
00866260 : CMP EDI,ESI
00866262 : JZ 0x0086657d
00866268 : XOR EDX,EDX
0086626a : MOV dword ptr [EBP + -0x18],0x7
00866271 : MOV dword ptr [EBP + -0x1c],ESI
00866274 : MOV word ptr [EBP + -0x2c],DX
00866278 : MOV dword ptr [EBP + -0x4],ESI
0086627b : MOV EAX,dword ptr [EDI + 0x1c4]
00866281 : MOV EDX,dword ptr [EAX + 0x4]
00866284 : LEA ESI,[EDI + 0x1c4]
0086628a : MOV ECX,ESI
0086628c : MOV dword ptr [EBP + -0x6c],ESI
0086628f : CALL EDX
00866291 : MOV dword ptr [EBP + -0x70],EAX
00866294 : TEST EAX,EAX
00866296 : JZ 0x008662e2
00866298 : JMP 0x008662a0
008662a0 : LEA EDX,[EBP + -0x70]
008662a3 : MOV EAX,ESI
008662a5 : CALL 0x004f5680
008662aa : TEST EAX,EAX
008662ac : JZ 0x008662dc
008662ae : ADD EAX,0x18
008662b1 : PUSH EAX
008662b2 : LEA ESI,[EBP + -0x4c]
008662b5 : CALL 0x00404350
008662ba : ADD ESP,0x4
008662bd : MOV byte ptr [EBP + -0x4],0x1
008662c1 : PUSH -0x1
008662c3 : PUSH 0x0
008662c5 : PUSH EAX
008662c6 : LEA ECX,[EBP + -0x30]
008662c9 : CALL 0x00405eb0
008662ce : MOV byte ptr [EBP + -0x4],0x0
008662d2 : MOV ECX,ESI
008662d4 : CALL 0x00406560
008662d9 : MOV ESI,dword ptr [EBP + -0x6c]
008662dc : CMP dword ptr [EBP + -0x70],0x0
008662e0 : JNZ 0x008662a0
008662e2 : MOV ESI,0xc3f4a4
008662e7 : LEA ECX,[EBP + -0x30]
008662ea : CALL 0x00403810
008662ef : TEST AL,AL
008662f1 : JNZ 0x0086656e
008662f7 : ADD EDI,0x59
008662fa : PUSH EDI
008662fb : LEA ESI,[EBP + -0x68]
008662fe : CALL 0x00404350
00866303 : ADD ESP,0x4
00866306 : MOV byte ptr [EBP + -0x4],0x2
0086630a : MOV EAX,dword ptr [EBX + 0x18a8]
00866310 : MOV ECX,dword ptr [EBP + 0xc]
00866313 : MOV EDX,dword ptr [EBP + 0x10]
00866316 : MOV dword ptr [EAX + 0x24],ECX
00866319 : MOV EAX,dword ptr [EBX + 0x18a8]
0086631f : MOV dword ptr [EAX + 0x28],EDX
00866322 : MOV EAX,dword ptr [EBX + 0x18a8]
00866328 : XOR ECX,ECX
0086632a : PUSH ECX
0086632b : MOV word ptr [EAX + 0x98],CX
00866332 : MOV EDX,dword ptr [EBX + 0x18a8]
00866338 : PUSH EBX
00866339 : PUSH EDX
0086633a : MOV EDX,ESI
0086633c : LEA ECX,[EBP + -0x30]
0086633f : CALL 0x0083c0e0
00866344 : MOV EAX,dword ptr [EBX + 0x18a8]
0086634a : MOV ECX,dword ptr [EAX + 0x30]
0086634d : TEST ECX,ECX
0086634f : JZ 0x0086635d
00866351 : MOV EDX,dword ptr [ECX]
00866353 : MOV EAX,dword ptr [EDX + 0x9c]
00866359 : PUSH 0x8
0086635b : CALL EAX
0086635d : MOV ECX,dword ptr [EBX + 0x18a8]
00866363 : PUSH 0x0
00866365 : MOV AL,0x1
00866367 : CALL 0x0083bb00
0086636c : CMP byte ptr [EBP + 0x14],0x0
00866370 : JZ 0x00866449
00866376 : MOV EAX,dword ptr [EBX + 0x138]
0086637c : MOV ECX,dword ptr [EAX + 0x4]
0086637f : LEA EDI,[EBX + ECX*0x1 + 0x138]
00866386 : LEA ESI,[EBX + 0x7b8]
0086638c : CALL 0x00876040
00866391 : TEST AL,AL
00866393 : JNZ 0x008663cd
00866395 : LEA ESI,[EBX + 0x828]
0086639b : CALL 0x00876040
008663a0 : TEST AL,AL
008663a2 : JNZ 0x008663cd
008663a4 : MOV EAX,dword ptr [EBX + 0x138]
008663aa : MOV EDX,dword ptr [EAX + 0x4]
008663ad : MOV EAX,dword ptr [EBX + EDX*0x1 + 0x138]
008663b4 : MOV EAX,dword ptr [EAX + 0x10]
008663b7 : PUSH 0x1
008663b9 : LEA ECX,[EBX + EDX*0x1 + 0x138]
008663c0 : PUSH 0x0
008663c2 : PUSH 0x1
008663c4 : LEA EDX,[EBX + 0x1da8]
008663ca : PUSH EDX
008663cb : CALL EAX
008663cd : MOV ECX,dword ptr [EBX + 0x138]
008663d3 : MOV EDX,dword ptr [ECX + 0x4]
008663d6 : LEA EAX,[EDX + EBX*0x1 + 0x138]
008663dd : CALL 0x00876080
008663e2 : MOV EAX,dword ptr [EBP + 0x10]
008663e5 : PUSH EAX
008663e6 : CALL 0x004049b0
008663eb : MOV ESI,EAX
008663ed : ADD ESP,0x4
008663f0 : TEST ESI,ESI
008663f2 : JZ 0x00866472
008663f4 : MOV EDX,dword ptr [ESI]
008663f6 : MOV EAX,dword ptr [EDX + 0x38]
008663f9 : MOV ECX,ESI
008663fb : CALL EAX
008663fd : TEST EAX,EAX
008663ff : JZ 0x00866472
00866401 : ADD ESI,0x44
00866404 : PUSH ESI
00866405 : LEA ESI,[EBP + -0x4c]
00866408 : CALL 0x00404350
0086640d : ADD ESP,0x4
00866410 : MOV byte ptr [EBP + -0x4],0x3
00866414 : MOV ESI,0xc3f4a8
00866419 : LEA ECX,[EBP + -0x4c]
0086641c : CALL 0x004049e0
00866421 : TEST AL,AL
00866423 : JZ 0x00866432
00866425 : PUSH 0x1
00866427 : LEA ECX,[EBP + -0x4c]
0086642a : PUSH ECX
0086642b : MOV ESI,EBX
0086642d : CALL 0x008980b0
00866432 : PUSH 0x11
00866434 : MOV ECX,EBX
00866436 : CALL 0x0088e570
0086643b : MOV byte ptr [EBP + -0x4],0x2
0086643f : LEA ECX,[EBP + -0x4c]
00866442 : CALL 0x00406560
00866447 : JMP 0x00866472
00866449 : MOV EDX,dword ptr [EBX + 0x138]
0086644f : MOV EAX,dword ptr [EDX + 0x4]
00866452 : MOV EDX,dword ptr [EAX + EBX*0x1 + 0x138]
00866459 : MOV EDX,dword ptr [EDX + 0x10]
0086645c : PUSH 0x1
0086645e : LEA ECX,[EAX + EBX*0x1 + 0x138]
00866465 : PUSH 0x0
00866467 : PUSH 0x1
00866469 : LEA EAX,[EBX + 0x6d8]
0086646f : PUSH EAX
00866470 : CALL EDX
00866472 : MOV EAX,dword ptr [EBX + 0x18a8]
00866478 : MOV EAX,dword ptr [EAX + 0x30]
0086647b : TEST EAX,EAX
0086647d : JZ 0x008664c6
0086647f : CMP dword ptr [EAX + 0x288],0x0
00866486 : JZ 0x008664c6
00866488 : SUB ESP,0x1c
0086648b : MOV ECX,ESP
0086648d : MOV dword ptr [EBP + -0x70],ESP
00866490 : PUSH 0xc3f4ac
00866495 : CALL 0x00406460
0086649a : MOV byte ptr [EBP + -0x4],0x4
0086649e : MOV EAX,dword ptr [EBX + 0x18a8]
008664a4 : MOV EAX,dword ptr [EAX + 0x30]
008664a7 : TEST EAX,EAX
008664a9 : JZ 0x008664b3
008664ab : MOV EAX,dword ptr [EAX + 0x288]
008664b1 : JMP 0x008664b5
008664b3 : XOR EAX,EAX
008664b5 : MOV byte ptr [EBP + -0x4],0x2
008664b9 : MOV EDI,EAX
008664bb : CALL 0x00a664c0
008664c0 : MOV dword ptr [EBX + 0x19ec],EAX
008664c6 : MOV EAX,dword ptr [EBX + 0x18a8]
008664cc : CMP dword ptr [EAX + 0x30],0x0
008664d0 : JZ 0x0086651d
008664d2 : CMP dword ptr [EBX + 0x19ec],0x0
008664d9 : JZ 0x0086651d
008664db : MOV EAX,dword ptr [EAX + 0x30]
008664de : LEA ECX,[EBP + 0xfffffed4]
008664e4 : PUSH ECX
008664e5 : MOV ECX,EAX
008664e7 : CALL 0x007d5b60
008664ec : MOV EDI,EAX
008664ee : MOV byte ptr [EBP + -0x4],0x5
008664f2 : MOV ESI,dword ptr [EBX + 0x19ec]
008664f8 : CALL 0x007cc270
008664fd : MOVSS XMM0,dword ptr [EDI + 0x24]
00866502 : SUBSS XMM0,dword ptr [EAX + 0x4]
00866507 : MOVSS dword ptr [EBX + 0x1a68],XMM0
0086650f : MOV byte ptr [EBP + -0x4],0x2
00866513 : MOV dword ptr [EBP + 0xfffffed4],0xcd083c
0086651d : MOV ESI,dword ptr [EBP + -0x6c]
00866520 : MOV EDX,dword ptr [ESI]
00866522 : MOV EAX,dword ptr [EDX + 0x4]
00866525 : MOV ECX,ESI
00866527 : CALL EAX
00866529 : MOV dword ptr [EBP + -0x6c],EAX
0086652c : TEST EAX,EAX
0086652e : JZ 0x00866547
00866530 : LEA EDX,[EBP + -0x6c]
00866533 : MOV EAX,ESI
00866535 : CALL 0x004f5680
0086653a : PUSH 0x0
0086653c : PUSH 0x1
0086653e : LEA ECX,[EAX + 0x58]
00866541 : PUSH EBX
00866542 : CALL 0x00863440
00866547 : MOV ECX,dword ptr [EBP + 0xc]
0086654a : PUSH ECX
0086654b : MOV ESI,EBX
0086654d : CALL 0x00865580
00866552 : MOV EAX,EBX
00866554 : CALL 0x00855610
00866559 : PUSH 0x1
0086655b : MOV EDI,EBX
0086655d : CALL 0x00854560
00866562 : MOV byte ptr [EBP + -0x4],0x0
00866566 : LEA ECX,[EBP + -0x68]
00866569 : CALL 0x00406560
0086656e : MOV dword ptr [EBP + -0x4],0xffffffff
00866575 : LEA ECX,[EBP + -0x30]
00866578 : CALL 0x00406560
0086657d : MOV ECX,dword ptr [EBP + -0xc]
00866580 : MOV dword ptr FS:[0x0],ECX
00866587 : POP ECX
00866588 : POP EDI
00866589 : POP ESI
0086658a : POP EBX
0086658b : MOV ECX,dword ptr [EBP + -0x14]
0086658e : XOR ECX,EBP
00866590 : CALL 0x00633e6b
00866595 : MOV ESP,EBP
00866597 : POP EBP
00866598 : RET 0x14

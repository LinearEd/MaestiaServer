PROGRAM  : Maestia.exe
FUNCTION : FUN_004d2830
ENTRY    : 004d2830
BODY     : [[004d2830, 004d2962] [004d2974, 004d2a2f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_004d2830(uint param_1,void *param_2)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  uint in_ECX;
  uint uVar6;
  uint extraout_ECX;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  iVar3 = param_1;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b79eb0;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  iVar4 = *(int *)(param_1 + 4);
  if (iVar4 == 0) {
    uVar6 = 0;
  }
  else {
    uVar6 = *(int *)(param_1 + 0xc) - iVar4 >> 1;
  }
  if (in_ECX != 0) {
    iVar2 = *(int *)(param_1 + 8);
    iVar4 = iVar2 - iVar4 >> 1;
    if (0x7fffffffU - iVar4 < in_ECX) {
      iVar4 = FUN_00429be0();
      uVar6 = extraout_ECX;
    }
    uVar1 = iVar4 + in_ECX;
    if (uVar6 < uVar1) {
      if (0x7fffffff - (uVar6 >> 1) < uVar6) {
        param_1 = 0;
      }
      else {
        param_1 = uVar6 + (uVar6 >> 1);
      }
      if (param_1 < uVar1) {
        param_1 = uVar1;
      }
      iVar4 = FUN_004d41c0();
      local_8 = 0;
      FUN_004d19e0();
      FUN_0041d020(*(undefined4 *)(iVar3 + 4));
      FUN_0041d020(param_2);
      local_8 = 0xffffffff;
      if (*(int *)(iVar3 + 4) == 0) {
        *(uint *)(iVar3 + 0xc) = iVar4 + param_1 * 2;
        *(uint *)(iVar3 + 8) =
             iVar4 + (in_ECX + (*(int *)(iVar3 + 8) - *(int *)(iVar3 + 4) >> 1)) * 2;
        *(int *)(iVar3 + 4) = iVar4;
        ExceptionList = local_10;
        return;
      }
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    if ((uint)(iVar2 - (int)param_2 >> 1) < in_ECX) {
      FUN_0041d020(param_2);
      local_8 = 2;
      FUN_004d19e0();
      local_8 = 0xffffffff;
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + in_ECX * 2;
    }
    else {
      iVar4 = iVar2 + in_ECX * -2;
      uVar5 = FUN_0041d020(iVar4);
      *(undefined4 *)(param_1 + 8) = uVar5;
      iVar4 = iVar4 - (int)param_2 >> 1;
      if (0 < iVar4) {
        _memmove_s((void *)(iVar2 + iVar4 * -2),iVar4 * 2,param_2,iVar4 * 2);
      }
    }
    FUN_004d4070(param_2);
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
004d2830 : PUSH EBP
004d2831 : MOV EBP,ESP
004d2833 : PUSH -0x1
004d2835 : PUSH 0xb79eb0
004d283a : MOV EAX,FS:[0x0]
004d2840 : PUSH EAX
004d2841 : SUB ESP,0x10
004d2844 : PUSH EBX
004d2845 : PUSH ESI
004d2846 : PUSH EDI
004d2847 : MOV EAX,[0x00d66fa0]
004d284c : XOR EAX,EBP
004d284e : PUSH EAX
004d284f : LEA EAX,[EBP + -0xc]
004d2852 : MOV FS:[0x0],EAX
004d2858 : MOV dword ptr [EBP + -0x10],ESP
004d285b : MOV ESI,ECX
004d285d : MOV EBX,dword ptr [EBP + 0x8]
004d2860 : MOV EDX,dword ptr [EBX + 0x4]
004d2863 : TEST EDX,EDX
004d2865 : JNZ 0x004d286b
004d2867 : XOR ECX,ECX
004d2869 : JMP 0x004d2874
004d286b : MOV EAX,dword ptr [EBX + 0xc]
004d286e : SUB EAX,EDX
004d2870 : SAR EAX,0x1
004d2872 : MOV ECX,EAX
004d2874 : TEST ESI,ESI
004d2876 : JZ 0x004d2a1c
004d287c : MOV EDI,dword ptr [EBX + 0x8]
004d287f : MOV EAX,EDI
004d2881 : SUB EAX,EDX
004d2883 : SAR EAX,0x1
004d2885 : MOV EDX,0x7fffffff
004d288a : SUB EDX,EAX
004d288c : CMP EDX,ESI
004d288e : JNC 0x004d2895
004d2890 : CALL 0x00429be0
004d2895 : LEA EDX,[EAX + ESI*0x1]
004d2898 : CMP ECX,EDX
004d289a : JNC 0x004d2974
004d28a0 : MOV EAX,ECX
004d28a2 : SHR EAX,0x1
004d28a4 : MOV EDI,0x7fffffff
004d28a9 : SUB EDI,EAX
004d28ab : CMP EDI,ECX
004d28ad : JNC 0x004d28bb
004d28af : MOV dword ptr [EBP + 0x8],0x0
004d28b6 : MOV ECX,dword ptr [EBP + 0x8]
004d28b9 : JMP 0x004d28c0
004d28bb : ADD ECX,EAX
004d28bd : MOV dword ptr [EBP + 0x8],ECX
004d28c0 : CMP ECX,EDX
004d28c2 : JNC 0x004d28c9
004d28c4 : MOV dword ptr [EBP + 0x8],EDX
004d28c7 : MOV ECX,EDX
004d28c9 : CALL 0x004d41c0
004d28ce : MOV dword ptr [EBP + -0x14],EAX
004d28d1 : MOV ECX,dword ptr [EBP + 0xc]
004d28d4 : SUB ECX,dword ptr [EBX + 0x4]
004d28d7 : SAR ECX,0x1
004d28d9 : MOV dword ptr [EBP + -0x1c],ECX
004d28dc : MOV dword ptr [EBP + -0x4],0x0
004d28e3 : LEA EDI,[EAX + ECX*0x2]
004d28e6 : MOV EDX,dword ptr [EBP + 0x10]
004d28e9 : CALL 0x004d19e0
004d28ee : MOV dword ptr [EBP + -0x18],0x1
004d28f5 : MOV EAX,dword ptr [EBX + 0x4]
004d28f8 : PUSH EAX
004d28f9 : MOV EDI,dword ptr [EBP + -0x14]
004d28fc : MOV ECX,EDI
004d28fe : MOV EAX,dword ptr [EBP + 0xc]
004d2901 : CALL 0x0041d020
004d2906 : MOV dword ptr [EBP + -0x18],0x2
004d290d : MOV ECX,dword ptr [EBP + -0x1c]
004d2910 : ADD ECX,ESI
004d2912 : LEA ECX,[EDI + ECX*0x2]
004d2915 : MOV EDX,dword ptr [EBP + 0xc]
004d2918 : PUSH EDX
004d2919 : MOV EAX,dword ptr [EBX + 0x8]
004d291c : CALL 0x0041d020
004d2921 : MOV dword ptr [EBP + -0x4],0xffffffff
004d2928 : MOV ECX,dword ptr [EBX + 0x4]
004d292b : MOV EAX,dword ptr [EBX + 0x8]
004d292e : SUB EAX,ECX
004d2930 : SAR EAX,0x1
004d2932 : ADD ESI,EAX
004d2934 : TEST ECX,ECX
004d2936 : JZ 0x004d293d
004d2938 : CALL 0x006f04e0
004d293d : MOV ECX,dword ptr [EBP + 0x8]
004d2940 : LEA EDX,[EDI + ECX*0x2]
004d2943 : MOV dword ptr [EBX + 0xc],EDX
004d2946 : LEA EAX,[EDI + ESI*0x2]
004d2949 : MOV dword ptr [EBX + 0x8],EAX
004d294c : MOV dword ptr [EBX + 0x4],EDI
004d294f : MOV ECX,dword ptr [EBP + -0xc]
004d2952 : MOV dword ptr FS:[0x0],ECX
004d2959 : POP ECX
004d295a : POP EDI
004d295b : POP ESI
004d295c : POP EBX
004d295d : MOV ESP,EBP
004d295f : POP EBP
004d2960 : RET 0xc
004d2974 : MOV ECX,EDI
004d2976 : MOV EAX,dword ptr [EBP + 0xc]
004d2979 : SUB ECX,EAX
004d297b : SAR ECX,0x1
004d297d : CMP ECX,ESI
004d297f : JNC 0x004d29cc
004d2981 : MOV EDX,dword ptr [EBP + 0x10]
004d2984 : MOVZX ECX,word ptr [EDX]
004d2987 : MOV dword ptr [EBP + 0x8],ECX
004d298a : LEA ECX,[ESI + ESI*0x1]
004d298d : MOV dword ptr [EBP + 0x10],ECX
004d2990 : ADD ECX,EAX
004d2992 : PUSH EAX
004d2993 : MOV EAX,EDI
004d2995 : CALL 0x0041d020
004d299a : MOV dword ptr [EBP + -0x4],0x2
004d29a1 : MOV EDI,dword ptr [EBX + 0x8]
004d29a4 : MOV EDX,EDI
004d29a6 : SUB EDX,dword ptr [EBP + 0xc]
004d29a9 : SAR EDX,0x1
004d29ab : SUB ESI,EDX
004d29ad : LEA EDX,[EBP + 0x8]
004d29b0 : CALL 0x004d19e0
004d29b5 : MOV dword ptr [EBP + -0x4],0xffffffff
004d29bc : MOV EAX,dword ptr [EBP + 0x10]
004d29bf : ADD dword ptr [EBX + 0x8],EAX
004d29c2 : MOV ECX,dword ptr [EBX + 0x8]
004d29c5 : SUB ECX,EAX
004d29c7 : MOV EAX,dword ptr [EBP + 0xc]
004d29ca : JMP 0x004d2a10
004d29cc : MOV ECX,dword ptr [EBP + 0x10]
004d29cf : MOVZX EDX,word ptr [ECX]
004d29d2 : MOV dword ptr [EBP + 0x8],EDX
004d29d5 : LEA EAX,[ESI + ESI*0x1]
004d29d8 : MOV dword ptr [EBP + 0x10],EAX
004d29db : MOV ESI,EDI
004d29dd : SUB ESI,EAX
004d29df : PUSH ESI
004d29e0 : MOV ECX,EDI
004d29e2 : MOV EAX,EDI
004d29e4 : CALL 0x0041d020
004d29e9 : MOV dword ptr [EBX + 0x8],EAX
004d29ec : MOV EAX,dword ptr [EBP + 0xc]
004d29ef : SUB ESI,EAX
004d29f1 : SAR ESI,0x1
004d29f3 : TEST ESI,ESI
004d29f5 : JLE 0x004d2a0b
004d29f7 : LEA ECX,[ESI + ESI*0x1]
004d29fa : PUSH ECX
004d29fb : PUSH EAX
004d29fc : PUSH ECX
004d29fd : SUB EDI,ECX
004d29ff : PUSH EDI
004d2a00 : CALL 0x00634101
004d2a05 : ADD ESP,0x10
004d2a08 : MOV EAX,dword ptr [EBP + 0xc]
004d2a0b : MOV ECX,dword ptr [EBP + 0x10]
004d2a0e : ADD ECX,EAX
004d2a10 : PUSH EAX
004d2a11 : LEA EDX,[EBP + 0x8]
004d2a14 : CALL 0x004d4070
004d2a19 : ADD ESP,0x4
004d2a1c : MOV ECX,dword ptr [EBP + -0xc]
004d2a1f : MOV dword ptr FS:[0x0],ECX
004d2a26 : POP ECX
004d2a27 : POP EDI
004d2a28 : POP ESI
004d2a29 : POP EBX
004d2a2a : MOV ESP,EBP
004d2a2c : POP EBP
004d2a2d : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_0078bc90
ENTRY    : 0078bc90
BODY     : [[0078bc90, 0078bd1a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0078bc90(void)

{
  uint uVar1;
  undefined4 *in_ECX;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_00b11cb9;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *in_ECX = &PTR_LAB_00cd7524;
  local_8 = 0;
  if ((HANDLE)in_ECX[1] != (HANDLE)0x0) {
    CloseHandle((HANDLE)in_ECX[1]);
  }
  if ((HANDLE)in_ECX[2] != (HANDLE)0x0) {
    CloseHandle((HANDLE)in_ECX[2]);
  }
  local_8 = 0xffffffff;
  if (7 < (uint)in_ECX[0xd]) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0(uVar1);
  }
  in_ECX[0xd] = 7;
  in_ECX[0xc] = 0;
  *(undefined2 *)(in_ECX + 8) = 0;
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
0078bc90 : PUSH EBP
0078bc91 : MOV EBP,ESP
0078bc93 : PUSH -0x1
0078bc95 : PUSH 0xb11cb9
0078bc9a : MOV EAX,FS:[0x0]
0078bca0 : PUSH EAX
0078bca1 : PUSH ECX
0078bca2 : PUSH ESI
0078bca3 : PUSH EDI
0078bca4 : MOV EAX,[0x00d66fa0]
0078bca9 : XOR EAX,EBP
0078bcab : PUSH EAX
0078bcac : LEA EAX,[EBP + -0xc]
0078bcaf : MOV FS:[0x0],EAX
0078bcb5 : MOV ESI,ECX
0078bcb7 : MOV dword ptr [EBP + -0x10],ESI
0078bcba : MOV dword ptr [ESI],0xcd7524
0078bcc0 : MOV dword ptr [EBP + -0x4],0x0
0078bcc7 : MOV EAX,dword ptr [ESI + 0x4]
0078bcca : MOV EDI,dword ptr [0x00b85104]
0078bcd0 : TEST EAX,EAX
0078bcd2 : JZ 0x0078bcd7
0078bcd4 : PUSH EAX
0078bcd5 : CALL EDI
0078bcd7 : MOV EAX,dword ptr [ESI + 0x8]
0078bcda : TEST EAX,EAX
0078bcdc : JZ 0x0078bce1
0078bcde : PUSH EAX
0078bcdf : CALL EDI
0078bce1 : MOV dword ptr [EBP + -0x4],0xffffffff
0078bce8 : CMP dword ptr [ESI + 0x34],0x8
0078bcec : JC 0x0078bcf6
0078bcee : MOV ECX,dword ptr [ESI + 0x20]
0078bcf1 : CALL 0x006f04e0
0078bcf6 : XOR EAX,EAX
0078bcf8 : MOV dword ptr [ESI + 0x34],0x7
0078bcff : MOV dword ptr [ESI + 0x30],0x0
0078bd06 : MOV word ptr [ESI + 0x20],AX
0078bd0a : MOV ECX,dword ptr [EBP + -0xc]
0078bd0d : MOV dword ptr FS:[0x0],ECX
0078bd14 : POP ECX
0078bd15 : POP EDI
0078bd16 : POP ESI
0078bd17 : MOV ESP,EBP
0078bd19 : POP EBP
0078bd1a : RET

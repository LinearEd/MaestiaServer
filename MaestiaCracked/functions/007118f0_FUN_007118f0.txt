PROGRAM  : Maestia.exe
FUNCTION : FUN_007118f0
ENTRY    : 007118f0
BODY     : [[007118f0, 00711cd5]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_007118f0(int *param_1,uint param_2)

{
  undefined4 *puVar1;
  undefined1 uVar2;
  int iVar3;
  
  if (((param_1 == (int *)0x0) || (puVar1 = (undefined4 *)param_1[7], puVar1 == (undefined4 *)0x0))
     || (4 < param_2)) {
    return 0xfffffffe;
  }
  if (((param_1[3] == 0) || ((*param_1 == 0 && (param_1[1] != 0)))) ||
     ((puVar1[1] == 0x29a && (param_2 != 4)))) {
    param_1[6] = (int)s_stream_error_00d6c98c;
    return 0xfffffffe;
  }
  if (param_1[4] == 0) {
    param_1[6] = (int)s_buffer_error_00d6c9bc;
    return 0xfffffffb;
  }
  iVar3 = puVar1[8];
  *puVar1 = param_1;
  puVar1[8] = param_2;
  if (puVar1[1] == 0x2a) {
    if (puVar1[6] == 2) {
      *(undefined1 *)(puVar1[2] + puVar1[5]) = 0x1f;
      puVar1[5] = puVar1[5] + 1;
      *(undefined1 *)(puVar1[5] + puVar1[2]) = 0x8b;
      puVar1[5] = puVar1[5] + 1;
      *(undefined1 *)(puVar1[5] + puVar1[2]) = 8;
      puVar1[5] = puVar1[5] + 1;
      *(undefined1 *)(puVar1[5] + puVar1[2]) = 0;
      puVar1[5] = puVar1[5] + 1;
      *(undefined1 *)(puVar1[5] + puVar1[2]) = 0;
      puVar1[5] = puVar1[5] + 1;
      *(undefined1 *)(puVar1[5] + puVar1[2]) = 0;
      puVar1[5] = puVar1[5] + 1;
      *(undefined1 *)(puVar1[5] + puVar1[2]) = 0;
      puVar1[5] = puVar1[5] + 1;
      *(undefined1 *)(puVar1[5] + puVar1[2]) = 0;
      puVar1[5] = puVar1[5] + 1;
      if (puVar1[0x1f] == 9) {
        uVar2 = 2;
      }
      else if (((int)puVar1[0x20] < 2) && (1 < (int)puVar1[0x1f])) {
        uVar2 = 0;
      }
      else {
        uVar2 = 4;
      }
      *(undefined1 *)(puVar1[5] + puVar1[2]) = uVar2;
      puVar1[5] = puVar1[5] + 1;
      *(undefined1 *)(puVar1[5] + puVar1[2]) = 0xff;
      puVar1[5] = puVar1[5] + 1;
      puVar1[1] = 0x71;
      param_1[0xc] = 0;
    }
    else {
      puVar1[1] = 0x71;
      FUN_00711850();
      if (puVar1[0x19] != 0) {
        FUN_00711850();
        FUN_00711850();
      }
      param_1[0xc] = 1;
    }
  }
  if (puVar1[5] == 0) {
    if (((param_1[1] == 0) && ((int)param_2 <= iVar3)) && (param_2 != 4)) {
      param_1[6] = (int)s_buffer_error_00d6c9bc;
      return 0xfffffffb;
    }
LAB_00711b06:
    if (puVar1[1] == 0x29a) {
      if (param_1[1] != 0) {
        param_1[6] = (int)s_buffer_error_00d6c9bc;
        return 0xfffffffb;
      }
LAB_00711b2d:
      if ((puVar1[0x1b] != 0) || ((param_2 != 0 && (puVar1[1] != 0x29a)))) goto LAB_00711b46;
    }
    else {
      if (param_1[1] == 0) goto LAB_00711b2d;
LAB_00711b46:
      iVar3 = (*(code *)(&PTR_FUN_00bfed18)[puVar1[0x1f] * 3])(puVar1,param_2);
      if ((iVar3 == 2) || (iVar3 == 3)) {
        puVar1[1] = 0x29a;
      }
      if ((iVar3 == 0) || (iVar3 == 2)) {
        if (param_1[4] != 0) {
          return 0;
        }
        puVar1[8] = 0xffffffff;
        return 0;
      }
      if (iVar3 == 1) {
        if (param_2 == 1) {
          FUN_0070e9f0();
        }
        else {
          FUN_0070f6c0(0,0);
          if (param_2 == 3) {
            *(undefined2 *)(puVar1[0xf] + -2 + puVar1[0x11] * 2) = 0;
            _memset((void *)puVar1[0xf],0,puVar1[0x11] * 2 - 2);
          }
        }
        FUN_00711800();
        if (param_1[4] == 0) goto LAB_00711ad4;
      }
    }
    if (param_2 == 4) {
      if ((int)puVar1[6] < 1) {
        return 1;
      }
      if (puVar1[6] == 2) {
        *(char *)(puVar1[2] + puVar1[5]) = (char)param_1[0xc];
        puVar1[5] = puVar1[5] + 1;
        *(undefined1 *)(puVar1[5] + puVar1[2]) = *(undefined1 *)((int)param_1 + 0x31);
        puVar1[5] = puVar1[5] + 1;
        *(undefined1 *)(puVar1[5] + puVar1[2]) = *(undefined1 *)((int)param_1 + 0x32);
        puVar1[5] = puVar1[5] + 1;
        *(undefined1 *)(puVar1[5] + puVar1[2]) = *(undefined1 *)((int)param_1 + 0x33);
        puVar1[5] = puVar1[5] + 1;
        *(char *)(puVar1[5] + puVar1[2]) = (char)param_1[2];
        puVar1[5] = puVar1[5] + 1;
        *(undefined1 *)(puVar1[5] + puVar1[2]) = *(undefined1 *)((int)param_1 + 9);
        puVar1[5] = puVar1[5] + 1;
        *(undefined1 *)(puVar1[5] + puVar1[2]) = *(undefined1 *)((int)param_1 + 10);
        puVar1[5] = puVar1[5] + 1;
        *(undefined1 *)(puVar1[5] + puVar1[2]) = *(undefined1 *)((int)param_1 + 0xb);
        puVar1[5] = puVar1[5] + 1;
      }
      else {
        FUN_00711850();
        FUN_00711850();
      }
      FUN_00711800();
      if (0 < (int)puVar1[6]) {
        puVar1[6] = -puVar1[6];
      }
      return (uint)(puVar1[5] == 0);
    }
  }
  else {
    FUN_00711800();
    if (param_1[4] != 0) goto LAB_00711b06;
LAB_00711ad4:
    puVar1[8] = 0xffffffff;
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
007118f0 : PUSH EBP
007118f1 : MOV EBP,ESP
007118f3 : PUSH ESI
007118f4 : PUSH EDI
007118f5 : MOV EDI,dword ptr [EBP + 0x8]
007118f8 : TEST EDI,EDI
007118fa : JZ 0x00711ccd
00711900 : MOV ESI,dword ptr [EDI + 0x1c]
00711903 : TEST ESI,ESI
00711905 : JZ 0x00711ccd
0071190b : MOV ECX,dword ptr [EBP + 0xc]
0071190e : CMP ECX,0x4
00711911 : JA 0x00711ccd
00711917 : CMP dword ptr [EDI + 0xc],0x0
0071191b : JZ 0x00711cc6
00711921 : CMP dword ptr [EDI],0x0
00711924 : JNZ 0x00711930
00711926 : CMP dword ptr [EDI + 0x4],0x0
0071192a : JNZ 0x00711cc6
00711930 : MOV EAX,dword ptr [ESI + 0x4]
00711933 : CMP EAX,0x29a
00711938 : JNZ 0x00711943
0071193a : CMP ECX,0x4
0071193d : JNZ 0x00711cc6
00711943 : CMP dword ptr [EDI + 0x10],0x0
00711947 : JNZ 0x00711959
00711949 : MOV dword ptr [EDI + 0x18],0xd6c9bc
00711950 : POP EDI
00711951 : MOV EAX,0xfffffffb
00711956 : POP ESI
00711957 : POP EBP
00711958 : RET
00711959 : MOV EDX,dword ptr [ESI + 0x20]
0071195c : PUSH EBX
0071195d : MOV dword ptr [ESI],EDI
0071195f : MOV dword ptr [EBP + 0x8],EDX
00711962 : MOV dword ptr [ESI + 0x20],ECX
00711965 : MOV EBX,0x1
0071196a : CMP EAX,0x2a
0071196d : JNZ 0x00711ac1
00711973 : MOV EDX,0x2
00711978 : CMP dword ptr [ESI + 0x18],EDX
0071197b : JNZ 0x00711a36
00711981 : MOV ECX,dword ptr [ESI + 0x14]
00711984 : MOV EAX,dword ptr [ESI + 0x8]
00711987 : MOV byte ptr [EAX + ECX*0x1],0x1f
0071198b : ADD dword ptr [ESI + 0x14],EBX
0071198e : MOV EAX,dword ptr [ESI + 0x14]
00711991 : MOV ECX,dword ptr [ESI + 0x8]
00711994 : MOV byte ptr [EAX + ECX*0x1],0x8b
00711998 : ADD dword ptr [ESI + 0x14],EBX
0071199b : MOV EAX,dword ptr [ESI + 0x14]
0071199e : MOV ECX,dword ptr [ESI + 0x8]
007119a1 : MOV byte ptr [EAX + ECX*0x1],0x8
007119a5 : ADD dword ptr [ESI + 0x14],EBX
007119a8 : MOV EAX,dword ptr [ESI + 0x14]
007119ab : MOV ECX,dword ptr [ESI + 0x8]
007119ae : MOV byte ptr [EAX + ECX*0x1],0x0
007119b2 : ADD dword ptr [ESI + 0x14],EBX
007119b5 : MOV EAX,dword ptr [ESI + 0x14]
007119b8 : MOV ECX,dword ptr [ESI + 0x8]
007119bb : MOV byte ptr [EAX + ECX*0x1],0x0
007119bf : ADD dword ptr [ESI + 0x14],EBX
007119c2 : MOV EAX,dword ptr [ESI + 0x14]
007119c5 : MOV ECX,dword ptr [ESI + 0x8]
007119c8 : MOV byte ptr [EAX + ECX*0x1],0x0
007119cc : ADD dword ptr [ESI + 0x14],EBX
007119cf : MOV EAX,dword ptr [ESI + 0x14]
007119d2 : MOV ECX,dword ptr [ESI + 0x8]
007119d5 : MOV byte ptr [EAX + ECX*0x1],0x0
007119d9 : ADD dword ptr [ESI + 0x14],EBX
007119dc : MOV EAX,dword ptr [ESI + 0x14]
007119df : MOV ECX,dword ptr [ESI + 0x8]
007119e2 : MOV byte ptr [EAX + ECX*0x1],0x0
007119e6 : ADD dword ptr [ESI + 0x14],EBX
007119e9 : MOV EAX,dword ptr [ESI + 0x7c]
007119ec : MOV ECX,dword ptr [ESI + 0x14]
007119ef : CMP EAX,0x9
007119f2 : JNZ 0x007119f8
007119f4 : MOV EAX,EDX
007119f6 : JMP 0x00711a0d
007119f8 : CMP dword ptr [ESI + 0x80],EDX
007119fe : JGE 0x00711a08
00711a00 : CMP EAX,EDX
00711a02 : JL 0x00711a08
00711a04 : XOR EAX,EAX
00711a06 : JMP 0x00711a0d
00711a08 : MOV EAX,0x4
00711a0d : MOV EDX,dword ptr [ESI + 0x8]
00711a10 : MOV byte ptr [ECX + EDX*0x1],AL
00711a13 : ADD dword ptr [ESI + 0x14],EBX
00711a16 : MOV EAX,dword ptr [ESI + 0x14]
00711a19 : MOV ECX,dword ptr [ESI + 0x8]
00711a1c : MOV byte ptr [EAX + ECX*0x1],0xff
00711a20 : ADD dword ptr [ESI + 0x14],EBX
00711a23 : MOV dword ptr [ESI + 0x4],0x71
00711a2a : MOV dword ptr [EDI + 0x30],0x0
00711a31 : JMP 0x00711abe
00711a36 : MOV ECX,dword ptr [ESI + 0x28]
00711a39 : SUB ECX,0x8
00711a3c : SHL ECX,0xc
00711a3f : ADD ECX,0x800
00711a45 : CMP dword ptr [ESI + 0x80],EDX
00711a4b : JGE 0x00711a6c
00711a4d : MOV EAX,dword ptr [ESI + 0x7c]
00711a50 : CMP EAX,EDX
00711a52 : JL 0x00711a6c
00711a54 : CMP EAX,0x6
00711a57 : JGE 0x00711a5d
00711a59 : MOV EAX,EBX
00711a5b : JMP 0x00711a6e
00711a5d : XOR EDX,EDX
00711a5f : CMP EAX,0x6
00711a62 : SETNZ DL
00711a65 : ADD EDX,0x2
00711a68 : MOV EAX,EDX
00711a6a : JMP 0x00711a6e
00711a6c : XOR EAX,EAX
00711a6e : SHL EAX,0x6
00711a71 : OR ECX,EAX
00711a73 : CMP dword ptr [ESI + 0x64],0x0
00711a77 : JZ 0x00711a7c
00711a79 : OR ECX,0x20
00711a7c : MOV EAX,0x8421085
00711a81 : MUL ECX
00711a83 : SUB ECX,EDX
00711a85 : SHR ECX,0x1
00711a87 : ADD ECX,EDX
00711a89 : SHR ECX,0x4
00711a8c : ADD ECX,EBX
00711a8e : MOV EAX,ECX
00711a90 : SHL ECX,0x5
00711a93 : SUB ECX,EAX
00711a95 : MOV EAX,ESI
00711a97 : MOV dword ptr [ESI + 0x4],0x71
00711a9e : CALL 0x00711850
00711aa3 : CMP dword ptr [ESI + 0x64],0x0
00711aa7 : JZ 0x00711abb
00711aa9 : MOVZX ECX,word ptr [EDI + 0x32]
00711aad : CALL 0x00711850
00711ab2 : MOVZX ECX,word ptr [EDI + 0x30]
00711ab6 : CALL 0x00711850
00711abb : MOV dword ptr [EDI + 0x30],EBX
00711abe : MOV ECX,dword ptr [EBP + 0xc]
00711ac1 : CMP dword ptr [ESI + 0x14],0x0
00711ac5 : JZ 0x00711ae2
00711ac7 : MOV EAX,EDI
00711ac9 : CALL 0x00711800
00711ace : CMP dword ptr [EDI + 0x10],0x0
00711ad2 : JNZ 0x00711b03
00711ad4 : MOV dword ptr [ESI + 0x20],0xffffffff
00711adb : POP EBX
00711adc : POP EDI
00711add : XOR EAX,EAX
00711adf : POP ESI
00711ae0 : POP EBP
00711ae1 : RET
00711ae2 : CMP dword ptr [EDI + 0x4],0x0
00711ae6 : JNZ 0x00711b06
00711ae8 : CMP ECX,dword ptr [EBP + 0x8]
00711aeb : JG 0x00711b06
00711aed : CMP ECX,0x4
00711af0 : JZ 0x00711b06
00711af2 : POP EBX
00711af3 : MOV dword ptr [EDI + 0x18],0xd6c9bc
00711afa : POP EDI
00711afb : MOV EAX,0xfffffffb
00711b00 : POP ESI
00711b01 : POP EBP
00711b02 : RET
00711b03 : MOV ECX,dword ptr [EBP + 0xc]
00711b06 : MOV EAX,dword ptr [ESI + 0x4]
00711b09 : CMP EAX,0x29a
00711b0e : JNZ 0x00711b27
00711b10 : CMP dword ptr [EDI + 0x4],0x0
00711b14 : JZ 0x00711b2d
00711b16 : POP EBX
00711b17 : MOV dword ptr [EDI + 0x18],0xd6c9bc
00711b1e : POP EDI
00711b1f : MOV EAX,0xfffffffb
00711b24 : POP ESI
00711b25 : POP EBP
00711b26 : RET
00711b27 : CMP dword ptr [EDI + 0x4],0x0
00711b2b : JNZ 0x00711b46
00711b2d : CMP dword ptr [ESI + 0x6c],0x0
00711b31 : JNZ 0x00711b46
00711b33 : TEST ECX,ECX
00711b35 : JZ 0x00711bd8
00711b3b : CMP EAX,0x29a
00711b40 : JZ 0x00711bd8
00711b46 : MOV EAX,dword ptr [ESI + 0x7c]
00711b49 : PUSH ECX
00711b4a : LEA EAX,[EAX + EAX*0x2]
00711b4d : MOV ECX,dword ptr [EAX*0x4 + 0xbfed18]
00711b54 : PUSH ESI
00711b55 : CALL ECX
00711b57 : ADD ESP,0x8
00711b5a : CMP EAX,0x2
00711b5d : JZ 0x00711b64
00711b5f : CMP EAX,0x3
00711b62 : JNZ 0x00711b6b
00711b64 : MOV dword ptr [ESI + 0x4],0x29a
00711b6b : TEST EAX,EAX
00711b6d : JZ 0x00711cae
00711b73 : CMP EAX,0x2
00711b76 : JZ 0x00711cae
00711b7c : CMP EAX,EBX
00711b7e : JNZ 0x00711bd5
00711b80 : MOV EAX,ESI
00711b82 : CMP dword ptr [EBP + 0xc],EBX
00711b85 : JNZ 0x00711b8e
00711b87 : CALL 0x0070e9f0
00711b8c : JMP 0x00711bc4
00711b8e : PUSH 0x0
00711b90 : PUSH 0x0
00711b92 : XOR ECX,ECX
00711b94 : CALL 0x0070f6c0
00711b99 : ADD ESP,0x8
00711b9c : CMP dword ptr [EBP + 0xc],0x3
00711ba0 : JNZ 0x00711bc4
00711ba2 : MOV EDX,dword ptr [ESI + 0x44]
00711ba5 : MOV EAX,dword ptr [ESI + 0x3c]
00711ba8 : XOR ECX,ECX
00711baa : MOV word ptr [EAX + EDX*0x2 + -0x2],CX
00711baf : MOV EDX,dword ptr [ESI + 0x44]
00711bb2 : LEA EAX,[EDX + EDX*0x1 + -0x2]
00711bb6 : PUSH EAX
00711bb7 : PUSH ECX
00711bb8 : MOV ECX,dword ptr [ESI + 0x3c]
00711bbb : PUSH ECX
00711bbc : CALL 0x0063b700
00711bc1 : ADD ESP,0xc
00711bc4 : MOV EAX,EDI
00711bc6 : CALL 0x00711800
00711bcb : CMP dword ptr [EDI + 0x10],0x0
00711bcf : JZ 0x00711ad4
00711bd5 : MOV ECX,dword ptr [EBP + 0xc]
00711bd8 : CMP ECX,0x4
00711bdb : JNZ 0x00711adb
00711be1 : MOV EAX,dword ptr [ESI + 0x18]
00711be4 : TEST EAX,EAX
00711be6 : JG 0x00711bef
00711be8 : MOV EAX,EBX
00711bea : POP EBX
00711beb : POP EDI
00711bec : POP ESI
00711bed : POP EBP
00711bee : RET
00711bef : CMP EAX,0x2
00711bf2 : JNZ 0x00711c7a
00711bf8 : MOVZX ECX,byte ptr [EDI + 0x30]
00711bfc : MOV EAX,dword ptr [ESI + 0x14]
00711bff : MOV EDX,dword ptr [ESI + 0x8]
00711c02 : MOV byte ptr [EDX + EAX*0x1],CL
00711c05 : ADD dword ptr [ESI + 0x14],EBX
00711c08 : MOVZX ECX,byte ptr [EDI + 0x31]
00711c0c : MOV EAX,dword ptr [ESI + 0x14]
00711c0f : MOV EDX,dword ptr [ESI + 0x8]
00711c12 : MOV byte ptr [EAX + EDX*0x1],CL
00711c15 : ADD dword ptr [ESI + 0x14],EBX
00711c18 : MOVZX ECX,byte ptr [EDI + 0x32]
00711c1c : MOV EAX,dword ptr [ESI + 0x14]
00711c1f : MOV EDX,dword ptr [ESI + 0x8]
00711c22 : MOV byte ptr [EAX + EDX*0x1],CL
00711c25 : ADD dword ptr [ESI + 0x14],EBX
00711c28 : MOVZX ECX,byte ptr [EDI + 0x33]
00711c2c : MOV EAX,dword ptr [ESI + 0x14]
00711c2f : MOV EDX,dword ptr [ESI + 0x8]
00711c32 : MOV byte ptr [EAX + EDX*0x1],CL
00711c35 : ADD dword ptr [ESI + 0x14],EBX
00711c38 : MOVZX ECX,byte ptr [EDI + 0x8]
00711c3c : MOV EAX,dword ptr [ESI + 0x14]
00711c3f : MOV EDX,dword ptr [ESI + 0x8]
00711c42 : MOV byte ptr [EAX + EDX*0x1],CL
00711c45 : ADD dword ptr [ESI + 0x14],EBX
00711c48 : MOVZX ECX,byte ptr [EDI + 0x9]
00711c4c : MOV EAX,dword ptr [ESI + 0x14]
00711c4f : MOV EDX,dword ptr [ESI + 0x8]
00711c52 : MOV byte ptr [EAX + EDX*0x1],CL
00711c55 : ADD dword ptr [ESI + 0x14],EBX
00711c58 : MOVZX ECX,byte ptr [EDI + 0xa]
00711c5c : MOV EAX,dword ptr [ESI + 0x14]
00711c5f : MOV EDX,dword ptr [ESI + 0x8]
00711c62 : MOV byte ptr [EAX + EDX*0x1],CL
00711c65 : ADD dword ptr [ESI + 0x14],EBX
00711c68 : MOVZX ECX,byte ptr [EDI + 0xb]
00711c6c : MOV EAX,dword ptr [ESI + 0x14]
00711c6f : MOV EDX,dword ptr [ESI + 0x8]
00711c72 : MOV byte ptr [EAX + EDX*0x1],CL
00711c75 : ADD dword ptr [ESI + 0x14],EBX
00711c78 : JMP 0x00711c8e
00711c7a : MOVZX ECX,word ptr [EDI + 0x32]
00711c7e : MOV EAX,ESI
00711c80 : CALL 0x00711850
00711c85 : MOVZX ECX,word ptr [EDI + 0x30]
00711c89 : CALL 0x00711850
00711c8e : MOV EAX,EDI
00711c90 : CALL 0x00711800
00711c95 : MOV EAX,dword ptr [ESI + 0x18]
00711c98 : TEST EAX,EAX
00711c9a : JLE 0x00711ca1
00711c9c : NEG EAX
00711c9e : MOV dword ptr [ESI + 0x18],EAX
00711ca1 : XOR EAX,EAX
00711ca3 : CMP dword ptr [ESI + 0x14],EAX
00711ca6 : POP EBX
00711ca7 : POP EDI
00711ca8 : SETZ AL
00711cab : POP ESI
00711cac : POP EBP
00711cad : RET
00711cae : CMP dword ptr [EDI + 0x10],0x0
00711cb2 : JNZ 0x00711adb
00711cb8 : POP EBX
00711cb9 : POP EDI
00711cba : MOV dword ptr [ESI + 0x20],0xffffffff
00711cc1 : XOR EAX,EAX
00711cc3 : POP ESI
00711cc4 : POP EBP
00711cc5 : RET
00711cc6 : MOV dword ptr [EDI + 0x18],0xd6c98c
00711ccd : POP EDI
00711cce : MOV EAX,0xfffffffe
00711cd3 : POP ESI
00711cd4 : POP EBP
00711cd5 : RET

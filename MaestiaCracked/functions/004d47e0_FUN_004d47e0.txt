PROGRAM  : Maestia.exe
FUNCTION : FUN_004d47e0
ENTRY    : 004d47e0
BODY     : [[004d47e0, 004d48ed] [004d48ff, 004d494e]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_004d47e0(undefined4 param_1,void *param_2,int param_3)

{
  int iVar1;
  int in_ECX;
  uint uVar2;
  rsize_t extraout_ECX;
  rsize_t _DstSize;
  uint uVar3;
  uint uVar4;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7ccb0;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  uVar2 = param_3 - (int)param_2;
  iVar1 = *(int *)(in_ECX + 4);
  if (iVar1 == 0) {
    uVar4 = 0;
  }
  else {
    uVar4 = *(int *)(in_ECX + 0xc) - iVar1;
  }
  if (uVar2 != 0) {
    _DstSize = uVar2;
    if ((iVar1 - *(int *)(in_ECX + 8)) - 1U < uVar2) {
      iVar1 = FUN_00429be0();
      _DstSize = extraout_ECX;
    }
    uVar3 = (*(int *)(in_ECX + 8) - iVar1) + uVar2;
    if (uVar4 < uVar3) {
      if (-(uVar4 >> 1) - 1 < uVar4) {
        uVar4 = 0;
      }
      else {
        uVar4 = uVar4 + (uVar4 >> 1);
      }
      if (uVar4 < uVar3) {
        uVar4 = uVar3;
      }
      iVar1 = FUN_00404e70(uVar4,0);
      local_8 = 0;
      FUN_004d3f20(*(undefined4 *)(in_ECX + 4));
      FUN_004d3f20(param_2);
      FUN_004d3f20(param_1);
      local_8 = 0xffffffff;
      if (*(int *)(in_ECX + 4) != 0) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      *(uint *)(in_ECX + 0xc) = iVar1 + uVar4;
      *(uint *)(in_ECX + 8) = iVar1 + uVar2 + (*(int *)(in_ECX + 8) - *(int *)(in_ECX + 4));
      *(int *)(in_ECX + 4) = iVar1;
      ExceptionList = local_10;
      return;
    }
    if (_DstSize != 0) {
      _memmove_s(*(void **)(in_ECX + 8),_DstSize,param_2,_DstSize);
    }
    FUN_004d4b00();
    FUN_004d4b00();
    FUN_004d4b00();
    *(int *)(in_ECX + 8) = *(int *)(in_ECX + 8) + uVar2;
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
004d47e0 : PUSH EBP
004d47e1 : MOV EBP,ESP
004d47e3 : PUSH -0x1
004d47e5 : PUSH 0xb7ccb0
004d47ea : MOV EAX,FS:[0x0]
004d47f0 : PUSH EAX
004d47f1 : SUB ESP,0xc
004d47f4 : PUSH EBX
004d47f5 : PUSH ESI
004d47f6 : PUSH EDI
004d47f7 : MOV EAX,[0x00d66fa0]
004d47fc : XOR EAX,EBP
004d47fe : PUSH EAX
004d47ff : LEA EAX,[EBP + -0xc]
004d4802 : MOV FS:[0x0],EAX
004d4808 : MOV dword ptr [EBP + -0x10],ESP
004d480b : MOV ESI,ECX
004d480d : MOV ECX,dword ptr [EBP + 0x10]
004d4810 : SUB ECX,dword ptr [EBP + 0xc]
004d4813 : MOV EDX,ECX
004d4815 : MOV dword ptr [EBP + -0x14],EDX
004d4818 : MOV EAX,dword ptr [ESI + 0x4]
004d481b : TEST EAX,EAX
004d481d : JNZ 0x004d4823
004d481f : XOR EDI,EDI
004d4821 : JMP 0x004d4828
004d4823 : MOV EDI,dword ptr [ESI + 0xc]
004d4826 : SUB EDI,EAX
004d4828 : TEST EDX,EDX
004d482a : JZ 0x004d493b
004d4830 : MOV EDX,dword ptr [ESI + 0x8]
004d4833 : MOV EBX,EAX
004d4835 : SUB EBX,EDX
004d4837 : DEC EBX
004d4838 : MOV EDX,EBX
004d483a : MOV EBX,ECX
004d483c : CMP EDX,EBX
004d483e : JNC 0x004d4845
004d4840 : CALL 0x00429be0
004d4845 : MOV EDX,dword ptr [ESI + 0x8]
004d4848 : SUB EDX,EAX
004d484a : ADD EDX,EBX
004d484c : CMP EDI,EDX
004d484e : JNC 0x004d48ff
004d4854 : MOV EAX,EDI
004d4856 : SHR EAX,0x1
004d4858 : OR ECX,0xffffffff
004d485b : SUB ECX,EAX
004d485d : CMP ECX,EDI
004d485f : JNC 0x004d4865
004d4861 : XOR EDI,EDI
004d4863 : JMP 0x004d4867
004d4865 : ADD EDI,EAX
004d4867 : CMP EDI,EDX
004d4869 : CMOVC EDI,EDX
004d486c : PUSH 0x0
004d486e : PUSH EDI
004d486f : CALL 0x00404e70
004d4874 : ADD ESP,0x8
004d4877 : MOV EBX,EAX
004d4879 : MOV dword ptr [EBP + -0x18],EBX
004d487c : MOV dword ptr [EBP + -0x4],0x0
004d4883 : MOV EDX,dword ptr [ESI + 0x4]
004d4886 : PUSH EDX
004d4887 : MOV ECX,EBX
004d4889 : MOV EAX,dword ptr [EBP + 0x8]
004d488c : CALL 0x004d3f20
004d4891 : MOV ECX,dword ptr [EBP + 0xc]
004d4894 : PUSH ECX
004d4895 : MOV ECX,EAX
004d4897 : MOV EAX,dword ptr [EBP + 0x10]
004d489a : CALL 0x004d3f20
004d489f : MOV EDX,dword ptr [EBP + 0x8]
004d48a2 : PUSH EDX
004d48a3 : MOV ECX,EAX
004d48a5 : MOV EAX,dword ptr [ESI + 0x8]
004d48a8 : CALL 0x004d3f20
004d48ad : MOV dword ptr [EBP + -0x4],0xffffffff
004d48b4 : MOV ECX,dword ptr [ESI + 0x4]
004d48b7 : MOV EAX,dword ptr [ESI + 0x8]
004d48ba : SUB EAX,ECX
004d48bc : ADD dword ptr [EBP + -0x14],EAX
004d48bf : TEST ECX,ECX
004d48c1 : JZ 0x004d48c8
004d48c3 : CALL 0x006f04e0
004d48c8 : LEA ECX,[EBX + EDI*0x1]
004d48cb : MOV dword ptr [ESI + 0xc],ECX
004d48ce : MOV EDX,dword ptr [EBP + -0x14]
004d48d1 : LEA EAX,[EBX + EDX*0x1]
004d48d4 : MOV dword ptr [ESI + 0x8],EAX
004d48d7 : MOV dword ptr [ESI + 0x4],EBX
004d48da : MOV ECX,dword ptr [EBP + -0xc]
004d48dd : MOV dword ptr FS:[0x0],ECX
004d48e4 : POP ECX
004d48e5 : POP EDI
004d48e6 : POP ESI
004d48e7 : POP EBX
004d48e8 : MOV ESP,EBP
004d48ea : POP EBP
004d48eb : RET 0x10
004d48ff : TEST ECX,ECX
004d4901 : JBE 0x004d4915
004d4903 : PUSH ECX
004d4904 : MOV EDX,dword ptr [EBP + 0xc]
004d4907 : PUSH EDX
004d4908 : PUSH ECX
004d4909 : MOV EAX,dword ptr [ESI + 0x8]
004d490c : PUSH EAX
004d490d : CALL 0x00634101
004d4912 : ADD ESP,0x10
004d4915 : MOV ECX,dword ptr [ESI + 0x8]
004d4918 : MOV EAX,dword ptr [EBP + 0x8]
004d491b : CALL 0x004d4b00
004d4920 : MOV EAX,dword ptr [ESI + 0x8]
004d4923 : LEA ECX,[EAX + EBX*0x1]
004d4926 : CALL 0x004d4b00
004d492b : MOV ECX,dword ptr [ESI + 0x8]
004d492e : ADD ECX,EBX
004d4930 : MOV EAX,dword ptr [EBP + 0x8]
004d4933 : CALL 0x004d4b00
004d4938 : ADD dword ptr [ESI + 0x8],EBX
004d493b : MOV ECX,dword ptr [EBP + -0xc]
004d493e : MOV dword ptr FS:[0x0],ECX
004d4945 : POP ECX
004d4946 : POP EDI
004d4947 : POP ESI
004d4948 : POP EBX
004d4949 : MOV ESP,EBP
004d494b : POP EBP
004d494c : RET 0x10

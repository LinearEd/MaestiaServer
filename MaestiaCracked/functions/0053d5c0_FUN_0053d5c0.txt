PROGRAM  : Maestia.exe
FUNCTION : FUN_0053d5c0
ENTRY    : 0053d5c0
BODY     : [[0053d5c0, 0053d821]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_0053d5c0(void)

{
  uint *puVar1;
  uint uVar2;
  int iVar3;
  ushort *puVar4;
  int in_ECX;
  int iVar5;
  
  uVar2 = *(uint *)(in_ECX + 4);
  if (uVar2 == 1) {
    return 1;
  }
  if ((uVar2 & 0x8000) == 0) {
    switch(uVar2) {
    case 2:
      FUN_0053c6e0();
    case 7:
    case 8:
      while ((*(int *)(in_ECX + 4) == 7 || (*(int *)(in_ECX + 4) == 8))) {
        FUN_0053c8e0();
      }
    case 9:
      if (*(int *)(in_ECX + 0x14) == 0x3e) {
        FUN_0053c5c0();
        *(undefined4 *)(in_ECX + 4) = 0x8002;
      }
      break;
    case 3:
      if (*(uint *)(in_ECX + 8) < *(uint *)(in_ECX + 0x10)) {
        do {
          if (*(int *)(in_ECX + 0x14) == 0x3c) break;
          puVar4 = *(ushort **)(in_ECX + 0xc);
          *(uint *)(in_ECX + 8) = (uint)puVar4;
          if ((*(char *)(in_ECX + 0x18) == '\0') || (*puVar4 != 0x26)) {
            if (puVar4 < *(ushort **)(in_ECX + 0x10)) {
              *(uint *)(in_ECX + 0x14) = (uint)*puVar4;
              *(ushort **)(in_ECX + 0xc) = puVar4 + 1;
            }
          }
          else {
            FUN_0053bdd0();
          }
        } while (*(uint *)(in_ECX + 8) < *(uint *)(in_ECX + 0x10));
      }
      *(undefined4 *)(in_ECX + 4) = 0x8003;
      break;
    case 4:
      if (*(uint *)(in_ECX + 8) < *(uint *)(in_ECX + 0x10)) {
        do {
          if (*(int *)(in_ECX + 0x14) == 0x3e) goto LAB_0053d6bd;
          puVar4 = *(ushort **)(in_ECX + 0xc);
          *(uint *)(in_ECX + 8) = (uint)puVar4;
          if ((*(char *)(in_ECX + 0x18) == '\0') || (*puVar4 != 0x26)) {
            if (puVar4 < *(ushort **)(in_ECX + 0x10)) {
              *(uint *)(in_ECX + 0x14) = (uint)*puVar4;
              *(ushort **)(in_ECX + 0xc) = puVar4 + 1;
            }
          }
          else {
            FUN_0053bdd0();
          }
        } while (*(uint *)(in_ECX + 8) < *(uint *)(in_ECX + 0x10));
      }
      if (*(int *)(in_ECX + 0x14) == 0x3e) {
LAB_0053d6bd:
        FUN_0053c5c0();
        *(undefined4 *)(in_ECX + 4) = 0x8004;
      }
      else {
        *(undefined4 *)(in_ECX + 4) = 1;
      }
    }
  }
  if (*(int *)(in_ECX + 4) == 1) {
    return 1;
  }
  puVar1 = (uint *)(in_ECX + 8);
  iVar5 = 0;
  if (*(uint *)(in_ECX + 8) < *(uint *)(in_ECX + 0x10)) {
    do {
      if (iVar5 != 0) goto LAB_0053d818;
      iVar3 = *(int *)(in_ECX + 0x14);
      if (iVar3 == 0) {
LAB_0053d7f5:
        iVar5 = 1;
      }
      else if (iVar3 == 0x2f) {
        if ((*(int *)(in_ECX + 4) == 9) || (*(int *)(in_ECX + 4) == 6)) {
          puVar4 = *(ushort **)(in_ECX + 0xc);
          *puVar1 = (uint)puVar4;
          if ((*(char *)(in_ECX + 0x18) == '\0') || (*puVar4 != 0x26)) {
            if (puVar4 < *(ushort **)(in_ECX + 0x10)) {
              *(uint *)(in_ECX + 0x14) = (uint)*puVar4;
              *(ushort **)(in_ECX + 0xc) = puVar4 + 1;
            }
          }
          else {
            FUN_0053bdd0();
          }
          if (*(int *)(in_ECX + 0x14) != 0x3e) goto LAB_0053d7f5;
          puVar4 = *(ushort **)(in_ECX + 0xc);
          *puVar1 = (uint)puVar4;
          if ((*(char *)(in_ECX + 0x18) == '\0') || (*puVar4 != 0x26)) {
            if (puVar4 < *(ushort **)(in_ECX + 0x10)) {
              *(uint *)(in_ECX + 0x14) = (uint)*puVar4;
              *(ushort **)(in_ECX + 0xc) = puVar4 + 1;
            }
            iVar5 = 0x8005;
          }
          else {
            FUN_0053bdd0();
            iVar5 = 0x8005;
          }
        }
        else {
          iVar5 = 3;
        }
      }
      else if (iVar3 == 0x3c) {
        puVar4 = *(ushort **)(in_ECX + 0xc);
        *puVar1 = (uint)puVar4;
        if ((*(char *)(in_ECX + 0x18) == '\0') || (*puVar4 != 0x26)) {
          if (puVar4 < *(ushort **)(in_ECX + 0x10)) {
            *(uint *)(in_ECX + 0x14) = (uint)*puVar4;
            *(ushort **)(in_ECX + 0xc) = puVar4 + 1;
          }
        }
        else {
          FUN_0053bdd0();
        }
        if (*(int *)(in_ECX + 0x14) == 0x21) {
          FUN_0053c830();
        }
        else if (*(int *)(in_ECX + 0x14) == 0x2f) {
          FUN_0053c5c0();
          iVar5 = 4;
        }
        else {
          iVar5 = 2;
        }
      }
      else {
        iVar5 = 3;
      }
    } while (*puVar1 < *(uint *)(in_ECX + 0x10));
    if (iVar5 != 0) {
LAB_0053d818:
      *(int *)(in_ECX + 4) = iVar5;
      return iVar5;
    }
  }
  *(undefined4 *)(in_ECX + 4) = 0x8000;
  return *(int *)(in_ECX + 4);
}



============================================================
DISASSEMBLY
============================================================
0053d5c0 : PUSH EBX
0053d5c1 : MOV EBX,ECX
0053d5c3 : MOV EAX,dword ptr [EBX + 0x4]
0053d5c6 : CMP EAX,0x1
0053d5c9 : JNZ 0x0053d5cd
0053d5cb : POP EBX
0053d5cc : RET
0053d5cd : PUSH EBP
0053d5ce : PUSH ESI
0053d5cf : MOV EBP,0x3e
0053d5d4 : TEST EAX,0x8000
0053d5d9 : JNZ 0x0053d6d4
0053d5df : ADD EAX,-0x2
0053d5e2 : CMP EAX,0x7
0053d5e5 : JA 0x0053d6d4
0053d5eb : JMP dword ptr [EAX*0x4 + 0x53d824]
0053d5f2 : CALL 0x0053c6e0
0053d5f7 : MOV EAX,dword ptr [EBX + 0x4]
0053d5fa : CMP EAX,0x7
0053d5fd : JZ 0x0053d604
0053d5ff : CMP EAX,0x8
0053d602 : JNZ 0x0053d60d
0053d604 : MOV ECX,EBX
0053d606 : CALL 0x0053c8e0
0053d60b : JMP 0x0053d5f7
0053d60d : CMP dword ptr [EBX + 0x14],EBP
0053d610 : JNZ 0x0053d6d4
0053d616 : LEA ECX,[EBX + 0x8]
0053d619 : CALL 0x0053c5c0
0053d61e : MOV dword ptr [EBX + 0x4],0x8002
0053d625 : JMP 0x0053d6d4
0053d62a : MOV EAX,dword ptr [EBX + 0x8]
0053d62d : CMP EAX,dword ptr [EBX + 0x10]
0053d630 : LEA ESI,[EBX + 0x8]
0053d633 : JNC 0x0053d66d
0053d635 : CMP dword ptr [EBX + 0x14],0x3c
0053d639 : JZ 0x0053d66d
0053d63b : CMP byte ptr [ESI + 0x10],0x0
0053d63f : MOV EAX,dword ptr [ESI + 0x4]
0053d642 : MOV dword ptr [ESI],EAX
0053d644 : JZ 0x0053d655
0053d646 : CMP word ptr [EAX],0x26
0053d64a : JNZ 0x0053d655
0053d64c : MOV ECX,ESI
0053d64e : CALL 0x0053bdd0
0053d653 : JMP 0x0053d666
0053d655 : CMP EAX,dword ptr [ESI + 0x8]
0053d658 : JNC 0x0053d666
0053d65a : MOVZX ECX,word ptr [EAX]
0053d65d : ADD EAX,0x2
0053d660 : MOV dword ptr [ESI + 0xc],ECX
0053d663 : MOV dword ptr [ESI + 0x4],EAX
0053d666 : MOV EDX,dword ptr [ESI]
0053d668 : CMP EDX,dword ptr [ESI + 0x8]
0053d66b : JC 0x0053d635
0053d66d : MOV dword ptr [EBX + 0x4],0x8003
0053d674 : JMP 0x0053d6d4
0053d676 : MOV EAX,dword ptr [EBX + 0x8]
0053d679 : CMP EAX,dword ptr [EBX + 0x10]
0053d67c : LEA ESI,[EBX + 0x8]
0053d67f : JNC 0x0053d6b8
0053d681 : CMP dword ptr [EBX + 0x14],EBP
0053d684 : JZ 0x0053d6bd
0053d686 : CMP byte ptr [ESI + 0x10],0x0
0053d68a : MOV EAX,dword ptr [ESI + 0x4]
0053d68d : MOV dword ptr [ESI],EAX
0053d68f : JZ 0x0053d6a0
0053d691 : CMP word ptr [EAX],0x26
0053d695 : JNZ 0x0053d6a0
0053d697 : MOV ECX,ESI
0053d699 : CALL 0x0053bdd0
0053d69e : JMP 0x0053d6b1
0053d6a0 : CMP EAX,dword ptr [ESI + 0x8]
0053d6a3 : JNC 0x0053d6b1
0053d6a5 : MOVZX ECX,word ptr [EAX]
0053d6a8 : ADD EAX,0x2
0053d6ab : MOV dword ptr [ESI + 0xc],ECX
0053d6ae : MOV dword ptr [ESI + 0x4],EAX
0053d6b1 : MOV EDX,dword ptr [ESI]
0053d6b3 : CMP EDX,dword ptr [ESI + 0x8]
0053d6b6 : JC 0x0053d681
0053d6b8 : CMP dword ptr [EBX + 0x14],EBP
0053d6bb : JNZ 0x0053d6cd
0053d6bd : MOV ECX,ESI
0053d6bf : CALL 0x0053c5c0
0053d6c4 : MOV dword ptr [EBX + 0x4],0x8004
0053d6cb : JMP 0x0053d6d4
0053d6cd : MOV dword ptr [EBX + 0x4],0x1
0053d6d4 : MOV EAX,0x1
0053d6d9 : CMP dword ptr [EBX + 0x4],EAX
0053d6dc : JZ 0x0053d81e
0053d6e2 : MOV EAX,dword ptr [EBX + 0x8]
0053d6e5 : LEA ESI,[EBX + 0x8]
0053d6e8 : PUSH EDI
0053d6e9 : XOR EDI,EDI
0053d6eb : CMP EAX,dword ptr [ESI + 0x8]
0053d6ee : JNC 0x0053d809
0053d6f4 : TEST EDI,EDI
0053d6f6 : JNZ 0x0053d818
0053d6fc : MOV EAX,dword ptr [EBX + 0x14]
0053d6ff : TEST EAX,EAX
0053d701 : JZ 0x0053d7f5
0053d707 : CMP EAX,0x2f
0053d70a : JZ 0x0053d77a
0053d70c : CMP EAX,0x3c
0053d70f : JZ 0x0053d71b
0053d711 : MOV EDI,0x3
0053d716 : JMP 0x0053d7fa
0053d71b : CMP byte ptr [ESI + 0x10],0x0
0053d71f : MOV EAX,dword ptr [ESI + 0x4]
0053d722 : MOV dword ptr [ESI],EAX
0053d724 : JZ 0x0053d735
0053d726 : CMP word ptr [EAX],0x26
0053d72a : JNZ 0x0053d735
0053d72c : MOV ECX,ESI
0053d72e : CALL 0x0053bdd0
0053d733 : JMP 0x0053d746
0053d735 : CMP EAX,dword ptr [ESI + 0x8]
0053d738 : JNC 0x0053d746
0053d73a : MOVZX ECX,word ptr [EAX]
0053d73d : ADD EAX,0x2
0053d740 : MOV dword ptr [ESI + 0xc],ECX
0053d743 : MOV dword ptr [ESI + 0x4],EAX
0053d746 : MOV EAX,dword ptr [EBX + 0x14]
0053d749 : CMP EAX,0x21
0053d74c : JNZ 0x0053d75a
0053d74e : MOV ECX,EBX
0053d750 : CALL 0x0053c830
0053d755 : JMP 0x0053d7fa
0053d75a : CMP EAX,0x2f
0053d75d : JNZ 0x0053d770
0053d75f : MOV ECX,ESI
0053d761 : CALL 0x0053c5c0
0053d766 : MOV EDI,0x4
0053d76b : JMP 0x0053d7fa
0053d770 : MOV EDI,0x2
0053d775 : JMP 0x0053d7fa
0053d77a : MOV EAX,dword ptr [EBX + 0x4]
0053d77d : CMP EAX,0x9
0053d780 : JZ 0x0053d78e
0053d782 : CMP EAX,0x6
0053d785 : JZ 0x0053d78e
0053d787 : MOV EDI,0x3
0053d78c : JMP 0x0053d7fa
0053d78e : CMP byte ptr [ESI + 0x10],0x0
0053d792 : MOV EAX,dword ptr [ESI + 0x4]
0053d795 : MOV dword ptr [ESI],EAX
0053d797 : JZ 0x0053d7a8
0053d799 : CMP word ptr [EAX],0x26
0053d79d : JNZ 0x0053d7a8
0053d79f : MOV ECX,ESI
0053d7a1 : CALL 0x0053bdd0
0053d7a6 : JMP 0x0053d7b9
0053d7a8 : CMP EAX,dword ptr [ESI + 0x8]
0053d7ab : JNC 0x0053d7b9
0053d7ad : MOVZX EDX,word ptr [EAX]
0053d7b0 : ADD EAX,0x2
0053d7b3 : MOV dword ptr [ESI + 0xc],EDX
0053d7b6 : MOV dword ptr [ESI + 0x4],EAX
0053d7b9 : CMP dword ptr [EBX + 0x14],EBP
0053d7bc : JNZ 0x0053d7f5
0053d7be : CMP byte ptr [ESI + 0x10],0x0
0053d7c2 : MOV EAX,dword ptr [ESI + 0x4]
0053d7c5 : MOV dword ptr [ESI],EAX
0053d7c7 : JZ 0x0053d7dd
0053d7c9 : CMP word ptr [EAX],0x26
0053d7cd : JNZ 0x0053d7dd
0053d7cf : MOV ECX,ESI
0053d7d1 : CALL 0x0053bdd0
0053d7d6 : MOV EDI,0x8005
0053d7db : JMP 0x0053d7fa
0053d7dd : CMP EAX,dword ptr [ESI + 0x8]
0053d7e0 : JNC 0x0053d7ee
0053d7e2 : MOVZX ECX,word ptr [EAX]
0053d7e5 : ADD EAX,0x2
0053d7e8 : MOV dword ptr [ESI + 0xc],ECX
0053d7eb : MOV dword ptr [ESI + 0x4],EAX
0053d7ee : MOV EDI,0x8005
0053d7f3 : JMP 0x0053d7fa
0053d7f5 : MOV EDI,0x1
0053d7fa : MOV EDX,dword ptr [ESI]
0053d7fc : CMP EDX,dword ptr [ESI + 0x8]
0053d7ff : JC 0x0053d6f4
0053d805 : TEST EDI,EDI
0053d807 : JNZ 0x0053d818
0053d809 : POP EDI
0053d80a : POP ESI
0053d80b : MOV dword ptr [EBX + 0x4],0x8000
0053d812 : MOV EAX,dword ptr [EBX + 0x4]
0053d815 : POP EBP
0053d816 : POP EBX
0053d817 : RET
0053d818 : MOV dword ptr [EBX + 0x4],EDI
0053d81b : MOV EAX,EDI
0053d81d : POP EDI
0053d81e : POP ESI
0053d81f : POP EBP
0053d820 : POP EBX
0053d821 : RET

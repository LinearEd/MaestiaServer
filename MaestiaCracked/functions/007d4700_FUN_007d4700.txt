PROGRAM  : Maestia.exe
FUNCTION : FUN_007d4700
ENTRY    : 007d4700
BODY     : [[007d4700, 007d475d] [007d4760, 007d489a]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_007d4700(undefined4 param_1)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int *piVar3;
  char cVar4;
  uint uVar5;
  int iVar6;
  int in_ECX;
  int iVar7;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b0f155;
  local_10 = ExceptionList;
  uVar5 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar7 = *(int *)(in_ECX + 0x238) - *(int *)(in_ECX + 0x234);
  iVar6 = iVar7 >> 0x1f;
  if ((iVar7 / 0x178 + iVar6 != iVar6) &&
     (local_14 = *(int *)(in_ECX + 0x234), local_14 != *(int *)(in_ECX + 0x238))) {
    do {
      cVar4 = FUN_0079ef10(uVar5);
      if (cVar4 == '\0') {
        ExceptionList = local_10;
        return 0;
      }
      local_14 = local_14 + 0x178;
    } while (local_14 != *(int *)(in_ECX + 0x238));
  }
  if (*(int *)(in_ECX + 8) != 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  local_8 = 0;
  puVar1 = *(undefined4 **)(in_ECX + 0x188);
  for (puVar2 = (undefined4 *)*puVar1; puVar2 != puVar1; puVar2 = (undefined4 *)*puVar2) {
    cVar4 = (**(code **)(*(int *)puVar2[9] + 0x5c))(param_1);
    if (cVar4 == '\0') goto LAB_007d486d;
  }
  local_8 = 0xffffffff;
  if (*(int *)(in_ECX + 8) != 0) {
    LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  if (*(int *)(in_ECX + 8) != 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  local_8 = 1;
  puVar1 = *(undefined4 **)(in_ECX + 0x38);
  puVar2 = (undefined4 *)*puVar1;
  while( true ) {
    if (puVar2 == puVar1) {
      local_8 = 0xffffffff;
      if (*(int *)(in_ECX + 8) != 0) {
        LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
      }
      ExceptionList = local_10;
      return 1;
    }
    piVar3 = (int *)puVar2[9];
    iVar6 = (**(code **)(*piVar3 + 0x1c))();
    if ((iVar6 - 2U < 8) && (cVar4 = (**(code **)(*piVar3 + 0x10c))(param_1), cVar4 == '\0')) break;
    puVar2 = (undefined4 *)*puVar2;
  }
LAB_007d486d:
  local_8 = 0xffffffff;
  if (*(int *)(in_ECX + 8) != 0) {
    LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  ExceptionList = local_10;
  return 0;
}



============================================================
DISASSEMBLY
============================================================
007d4700 : PUSH EBP
007d4701 : MOV EBP,ESP
007d4703 : PUSH -0x1
007d4705 : PUSH 0xb0f155
007d470a : MOV EAX,FS:[0x0]
007d4710 : PUSH EAX
007d4711 : SUB ESP,0x8
007d4714 : PUSH EBX
007d4715 : PUSH ESI
007d4716 : PUSH EDI
007d4717 : MOV EAX,[0x00d66fa0]
007d471c : XOR EAX,EBP
007d471e : PUSH EAX
007d471f : LEA EAX,[EBP + -0xc]
007d4722 : MOV FS:[0x0],EAX
007d4728 : MOV EBX,ECX
007d472a : MOV ECX,dword ptr [EBX + 0x238]
007d4730 : SUB ECX,dword ptr [EBX + 0x234]
007d4736 : MOV EAX,0xae4c415d
007d473b : IMUL ECX
007d473d : ADD EDX,ECX
007d473f : SAR EDX,0x8
007d4742 : MOV EAX,EDX
007d4744 : SHR EAX,0x1f
007d4747 : ADD EAX,EDX
007d4749 : JZ 0x007d478c
007d474b : MOV EAX,dword ptr [EBX + 0x234]
007d4751 : MOV dword ptr [EBP + -0x10],EAX
007d4754 : CMP EAX,dword ptr [EBX + 0x238]
007d475a : JZ 0x007d478c
007d475c : JMP 0x007d4763
007d4760 : MOV EAX,dword ptr [EBP + -0x10]
007d4763 : MOV EDI,dword ptr [EBP + 0x8]
007d4766 : LEA ESI,[EAX + 0xbc]
007d476c : CALL 0x0079ef10
007d4771 : TEST AL,AL
007d4773 : JZ 0x007d4885
007d4779 : MOV EAX,dword ptr [EBP + -0x10]
007d477c : ADD EAX,0x178
007d4781 : MOV dword ptr [EBP + -0x10],EAX
007d4784 : CMP EAX,dword ptr [EBX + 0x238]
007d478a : JNZ 0x007d4760
007d478c : MOV EAX,dword ptr [EBX + 0x8]
007d478f : MOV dword ptr [EBP + -0x10],EBX
007d4792 : TEST EAX,EAX
007d4794 : JZ 0x007d47a0
007d4796 : ADD EAX,0x4
007d4799 : PUSH EAX
007d479a : CALL dword ptr [0x00b85118]
007d47a0 : MOV dword ptr [EBP + -0x4],0x0
007d47a7 : MOV EDI,dword ptr [EBX + 0x188]
007d47ad : MOV ESI,dword ptr [EDI]
007d47af : CMP ESI,EDI
007d47b1 : JZ 0x007d47cf
007d47b3 : MOV ECX,dword ptr [ESI + 0x24]
007d47b6 : MOV EDX,dword ptr [ECX]
007d47b8 : MOV EAX,dword ptr [EBP + 0x8]
007d47bb : MOV EDX,dword ptr [EDX + 0x5c]
007d47be : PUSH EAX
007d47bf : CALL EDX
007d47c1 : TEST AL,AL
007d47c3 : JZ 0x007d486d
007d47c9 : MOV ESI,dword ptr [ESI]
007d47cb : CMP ESI,EDI
007d47cd : JNZ 0x007d47b3
007d47cf : MOV dword ptr [EBP + -0x4],0xffffffff
007d47d6 : MOV EAX,dword ptr [EBX + 0x8]
007d47d9 : TEST EAX,EAX
007d47db : JZ 0x007d47e7
007d47dd : ADD EAX,0x4
007d47e0 : PUSH EAX
007d47e1 : CALL dword ptr [0x00b8511c]
007d47e7 : MOV EAX,dword ptr [EBX + 0x8]
007d47ea : MOV dword ptr [EBP + -0x14],EBX
007d47ed : TEST EAX,EAX
007d47ef : JZ 0x007d47fb
007d47f1 : ADD EAX,0x4
007d47f4 : PUSH EAX
007d47f5 : CALL dword ptr [0x00b85118]
007d47fb : MOV dword ptr [EBP + -0x4],0x1
007d4802 : MOV EAX,dword ptr [EBX + 0x38]
007d4805 : MOV EDI,dword ptr [EAX]
007d4807 : MOV dword ptr [EBP + -0x10],EAX
007d480a : CMP EDI,EAX
007d480c : JZ 0x007d483f
007d480e : MOV EDI,EDI
007d4810 : MOV ESI,dword ptr [EDI + 0x24]
007d4813 : MOV EAX,dword ptr [ESI]
007d4815 : MOV EDX,dword ptr [EAX + 0x1c]
007d4818 : MOV ECX,ESI
007d481a : CALL EDX
007d481c : ADD EAX,-0x2
007d481f : CMP EAX,0x7
007d4822 : JA 0x007d4838
007d4824 : MOV ECX,dword ptr [EBP + 0x8]
007d4827 : MOV EAX,dword ptr [ESI]
007d4829 : MOV EDX,dword ptr [EAX + 0x10c]
007d482f : PUSH ECX
007d4830 : MOV ECX,ESI
007d4832 : CALL EDX
007d4834 : TEST AL,AL
007d4836 : JZ 0x007d486d
007d4838 : MOV EDI,dword ptr [EDI]
007d483a : CMP EDI,dword ptr [EBP + -0x10]
007d483d : JNZ 0x007d4810
007d483f : MOV dword ptr [EBP + -0x4],0xffffffff
007d4846 : MOV EBX,dword ptr [EBX + 0x8]
007d4849 : TEST EBX,EBX
007d484b : JZ 0x007d4857
007d484d : ADD EBX,0x4
007d4850 : PUSH EBX
007d4851 : CALL dword ptr [0x00b8511c]
007d4857 : MOV AL,0x1
007d4859 : MOV ECX,dword ptr [EBP + -0xc]
007d485c : MOV dword ptr FS:[0x0],ECX
007d4863 : POP ECX
007d4864 : POP EDI
007d4865 : POP ESI
007d4866 : POP EBX
007d4867 : MOV ESP,EBP
007d4869 : POP EBP
007d486a : RET 0x4
007d486d : MOV dword ptr [EBP + -0x4],0xffffffff
007d4874 : MOV EBX,dword ptr [EBX + 0x8]
007d4877 : TEST EBX,EBX
007d4879 : JZ 0x007d4885
007d487b : ADD EBX,0x4
007d487e : PUSH EBX
007d487f : CALL dword ptr [0x00b8511c]
007d4885 : XOR AL,AL
007d4887 : MOV ECX,dword ptr [EBP + -0xc]
007d488a : MOV dword ptr FS:[0x0],ECX
007d4891 : POP ECX
007d4892 : POP EDI
007d4893 : POP ESI
007d4894 : POP EBX
007d4895 : MOV ESP,EBP
007d4897 : POP EBP
007d4898 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_0078cff0
ENTRY    : 0078cff0
BODY     : [[0078cff0, 0078d205]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0078cff0(undefined4 param_1,undefined8 param_2,undefined8 param_3)

{
  uint uVar1;
  longlong lVar2;
  uint uVar3;
  int *piVar4;
  undefined4 *puVar5;
  int *piVar6;
  int iVar7;
  int iVar8;
  int unaff_ESI;
  undefined **local_1c;
  int *local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3c2d5;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  *(undefined4 *)(unaff_ESI + 0xd0) = 200;
  *(undefined4 *)(unaff_ESI + 4) = 0;
  local_18 = (int *)FUN_006f0760(0x960,"",0,(DAT_01725270 >> 3 & 1) == 0,uVar3);
  if (local_18 == (int *)0x0) {
    iVar8 = 0;
  }
  else {
    iVar7 = 199;
    puVar5 = (undefined4 *)((int)local_18 + 8);
    do {
      puVar5[-2] = 0;
      puVar5[-1] = 0;
      *puVar5 = 0;
      puVar5 = puVar5 + 3;
      iVar7 = iVar7 + -1;
      iVar8 = (int)local_18;
    } while (-1 < iVar7);
  }
  local_8 = 0xffffffff;
  uVar1 = *(uint *)(unaff_ESI + 0xd0);
  *(int *)(unaff_ESI + 0xd8) = iVar8;
  lVar2 = (ulonglong)uVar1 * 0x14;
  local_18 = (int *)FUN_006f0760((uint)lVar2 | -(uint)((int)((ulonglong)lVar2 >> 0x20) != 0),"",0,
                                 (DAT_01725270 >> 3 & 1) == 0,uVar3);
  if (local_18 == (int *)0x0) {
    piVar4 = (int *)0x0;
  }
  else {
    iVar8 = uVar1 - 1;
    piVar4 = local_18;
    if (-1 < iVar8) {
      piVar6 = local_18 + 1;
      do {
        piVar6[-1] = 0;
        *piVar6 = 0;
        piVar6[1] = 0;
        piVar6[2] = 0;
        piVar6[3] = 0;
        piVar6 = piVar6 + 5;
        iVar8 = iVar8 + -1;
      } while (-1 < iVar8);
    }
  }
  piVar6 = DAT_01725204;
  local_8 = 0xffffffff;
  *(undefined8 *)(unaff_ESI + 0xbc) = param_2;
  *(int **)(unaff_ESI + 0xe0) = piVar4;
  *(undefined8 *)(unaff_ESI + 0xc4) = param_3;
  *(undefined4 *)(unaff_ESI + 0xd4) = 0;
  *(undefined4 *)(unaff_ESI + 0xec) = 0x3c;
  iVar8 = (**(code **)(*piVar6 + 4))(&local_1c,param_1);
  local_8 = 2;
  piVar4 = *(int **)(unaff_ESI + 0xe8);
  if (piVar4 != *(int **)(iVar8 + 4)) {
    if (piVar4 != (int *)0x0) {
      (**(code **)(*piVar4 + 0x30))();
    }
    if (*(int *)(iVar8 + 4) != 0) {
      InterlockedIncrement((LONG *)(*(int *)(iVar8 + 4) + 0x2c));
    }
    *(undefined4 *)(unaff_ESI + 0xe8) = *(undefined4 *)(iVar8 + 4);
  }
  local_8 = 0xffffffff;
  local_1c = &PTR_FUN_00cd4964;
  if (local_18 != (int *)0x0) {
    (**(code **)(*local_18 + 0x30))();
    local_18 = (int *)0x0;
  }
  _memset(*(void **)(unaff_ESI + 0xd8),0,*(int *)(unaff_ESI + 0xd0) * 0xc);
  _memset(*(void **)(unaff_ESI + 0xe0),0,*(int *)(unaff_ESI + 0xd0) * 0x14);
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
0078cff0 : PUSH EBP
0078cff1 : MOV EBP,ESP
0078cff3 : PUSH -0x1
0078cff5 : PUSH 0xb3c2d5
0078cffa : MOV EAX,FS:[0x0]
0078d000 : PUSH EAX
0078d001 : SUB ESP,0xc
0078d004 : PUSH EBX
0078d005 : PUSH EDI
0078d006 : MOV EAX,[0x00d66fa0]
0078d00b : XOR EAX,EBP
0078d00d : PUSH EAX
0078d00e : LEA EAX,[EBP + -0xc]
0078d011 : MOV FS:[0x0],EAX
0078d017 : XOR ECX,ECX
0078d019 : XOR EBX,EBX
0078d01b : MOV EAX,0xc8
0078d020 : MOV dword ptr [ESI + 0xd0],EAX
0078d026 : MOV EDX,0xc
0078d02b : MUL EDX
0078d02d : SETO CL
0078d030 : MOV EDX,EBX
0078d032 : MOV dword ptr [ESI + 0x4],EBX
0078d035 : NEG ECX
0078d037 : OR EAX,ECX
0078d039 : MOV ECX,dword ptr [0x01725270]
0078d03f : SHR ECX,0x3
0078d042 : AND ECX,0x1
0078d045 : SETZ DL
0078d048 : PUSH EDX
0078d049 : PUSH EBX
0078d04a : PUSH 0xbf1a4b
0078d04f : PUSH EAX
0078d050 : CALL 0x006f0760
0078d055 : ADD ESP,0x10
0078d058 : MOV dword ptr [EBP + -0x14],EAX
0078d05b : MOV dword ptr [EBP + -0x4],EBX
0078d05e : XORPS XMM0,XMM0
0078d061 : CMP EAX,EBX
0078d063 : JZ 0x0078d088
0078d065 : MOV EDX,0xc7
0078d06a : LEA ECX,[EAX + 0x8]
0078d06d : LEA ECX,[ECX]
0078d070 : MOVSS dword ptr [ECX + -0x8],XMM0
0078d075 : MOVSS dword ptr [ECX + -0x4],XMM0
0078d07a : MOVSS dword ptr [ECX],XMM0
0078d07e : ADD ECX,0xc
0078d081 : SUB EDX,0x1
0078d084 : JNS 0x0078d070
0078d086 : JMP 0x0078d08a
0078d088 : XOR EAX,EAX
0078d08a : MOV dword ptr [EBP + -0x4],0xffffffff
0078d091 : MOV EDI,dword ptr [ESI + 0xd0]
0078d097 : XOR ECX,ECX
0078d099 : MOV dword ptr [ESI + 0xd8],EAX
0078d09f : MOV EAX,EDI
0078d0a1 : MOV EDX,0x14
0078d0a6 : MUL EDX
0078d0a8 : SETO CL
0078d0ab : MOV EDX,0x0
0078d0b0 : NEG ECX
0078d0b2 : OR EAX,ECX
0078d0b4 : MOV ECX,dword ptr [0x01725270]
0078d0ba : SHR ECX,0x3
0078d0bd : AND ECX,0x1
0078d0c0 : SETZ DL
0078d0c3 : PUSH EDX
0078d0c4 : PUSH EBX
0078d0c5 : PUSH 0xbf1a4b
0078d0ca : PUSH EAX
0078d0cb : CALL 0x006f0760
0078d0d0 : ADD ESP,0x10
0078d0d3 : MOV dword ptr [EBP + -0x14],EAX
0078d0d6 : MOV dword ptr [EBP + -0x4],0x1
0078d0dd : CMP EAX,EBX
0078d0df : JZ 0x0078d112
0078d0e1 : LEA EDX,[EDI + -0x1]
0078d0e4 : CMP EDX,EBX
0078d0e6 : JL 0x0078d114
0078d0e8 : XORPS XMM0,XMM0
0078d0eb : LEA ECX,[EAX + 0x4]
0078d0ee : MOV EDI,EDI
0078d0f0 : MOVSS dword ptr [ECX + -0x4],XMM0
0078d0f5 : MOVSS dword ptr [ECX],XMM0
0078d0f9 : MOVSS dword ptr [ECX + 0x4],XMM0
0078d0fe : MOVSS dword ptr [ECX + 0x8],XMM0
0078d103 : MOVSS dword ptr [ECX + 0xc],XMM0
0078d108 : ADD ECX,0x14
0078d10b : SUB EDX,0x1
0078d10e : JNS 0x0078d0f0
0078d110 : JMP 0x0078d114
0078d112 : XOR EAX,EAX
0078d114 : MOV dword ptr [EBP + -0x4],0xffffffff
0078d11b : MOVQ XMM0,qword ptr [EBP + 0xc]
0078d120 : MOV EDX,dword ptr [EBP + 0x8]
0078d123 : MOV ECX,dword ptr [0x01725204]
0078d129 : MOVQ qword ptr [ESI + 0xbc],XMM0
0078d131 : MOVQ XMM0,qword ptr [EBP + 0x14]
0078d136 : MOV dword ptr [ESI + 0xe0],EAX
0078d13c : PUSH EDX
0078d13d : MOVQ qword ptr [ESI + 0xc4],XMM0
0078d145 : MOV dword ptr [ESI + 0xd4],EBX
0078d14b : MOV dword ptr [ESI + 0xec],0x3c
0078d155 : MOV EAX,dword ptr [ECX]
0078d157 : MOV EAX,dword ptr [EAX + 0x4]
0078d15a : LEA EDX,[EBP + -0x18]
0078d15d : PUSH EDX
0078d15e : CALL EAX
0078d160 : MOV EDI,EAX
0078d162 : MOV dword ptr [EBP + -0x4],0x2
0078d169 : MOV EAX,dword ptr [EDI + 0x4]
0078d16c : MOV ECX,dword ptr [ESI + 0xe8]
0078d172 : CMP ECX,EAX
0078d174 : JZ 0x0078d19b
0078d176 : CMP ECX,EBX
0078d178 : JZ 0x0078d181
0078d17a : MOV EDX,dword ptr [ECX]
0078d17c : MOV EAX,dword ptr [EDX + 0x30]
0078d17f : CALL EAX
0078d181 : MOV EAX,dword ptr [EDI + 0x4]
0078d184 : CMP EAX,EBX
0078d186 : JZ 0x0078d192
0078d188 : ADD EAX,0x2c
0078d18b : PUSH EAX
0078d18c : CALL dword ptr [0x00b850dc]
0078d192 : MOV ECX,dword ptr [EDI + 0x4]
0078d195 : MOV dword ptr [ESI + 0xe8],ECX
0078d19b : MOV dword ptr [EBP + -0x4],0xffffffff
0078d1a2 : MOV ECX,dword ptr [EBP + -0x14]
0078d1a5 : MOV dword ptr [EBP + -0x18],0xcd4964
0078d1ac : CMP ECX,EBX
0078d1ae : JZ 0x0078d1ba
0078d1b0 : MOV EDX,dword ptr [ECX]
0078d1b2 : MOV EAX,dword ptr [EDX + 0x30]
0078d1b5 : CALL EAX
0078d1b7 : MOV dword ptr [EBP + -0x14],EBX
0078d1ba : MOV EAX,dword ptr [ESI + 0xd0]
0078d1c0 : MOV EDX,dword ptr [ESI + 0xd8]
0078d1c6 : LEA ECX,[EAX + EAX*0x2]
0078d1c9 : ADD ECX,ECX
0078d1cb : ADD ECX,ECX
0078d1cd : PUSH ECX
0078d1ce : PUSH EBX
0078d1cf : PUSH EDX
0078d1d0 : CALL 0x0063b700
0078d1d5 : MOV EAX,dword ptr [ESI + 0xd0]
0078d1db : MOV ECX,dword ptr [ESI + 0xe0]
0078d1e1 : LEA EAX,[EAX + EAX*0x4]
0078d1e4 : ADD EAX,EAX
0078d1e6 : ADD EAX,EAX
0078d1e8 : PUSH EAX
0078d1e9 : PUSH EBX
0078d1ea : PUSH ECX
0078d1eb : CALL 0x0063b700
0078d1f0 : ADD ESP,0x18
0078d1f3 : MOV ECX,dword ptr [EBP + -0xc]
0078d1f6 : MOV dword ptr FS:[0x0],ECX
0078d1fd : POP ECX
0078d1fe : POP EDI
0078d1ff : POP EBX
0078d200 : MOV ESP,EBP
0078d202 : POP EBP
0078d203 : RET 0x14

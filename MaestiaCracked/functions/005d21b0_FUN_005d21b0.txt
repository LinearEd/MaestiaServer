PROGRAM  : Maestia.exe
FUNCTION : FUN_005d21b0
ENTRY    : 005d21b0
BODY     : [[005d21b0, 005d2327]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_005d21b0(undefined4 *param_1,uint param_2)

{
  int *piVar1;
  undefined4 *puVar2;
  int iVar3;
  int iVar4;
  undefined4 *puVar5;
  undefined4 uVar6;
  uint uVar7;
  int local_18;
  undefined1 local_14;
  int local_10;
  int local_c;
  byte local_8;
  
  iVar3 = param_2;
  iVar4 = *(int *)(param_2 + 0x9c);
  piVar1 = (int *)(iVar4 + 8);
  *piVar1 = *piVar1 + 1;
  iVar4 = FUN_00530480(iVar4);
  if (iVar4 == 0) {
    FUN_005cf4c0(&local_10,iVar3);
    if (((local_8 & 2) == 0) && (local_10 != 0)) {
      FUN_00503db0();
    }
    local_10 = 0;
    if (((local_8 & 1) == 0) && (local_c != 0)) {
      FUN_00503db0();
    }
  }
  local_18 = iVar3;
  local_14 = 8;
  puVar5 = (undefined4 *)FUN_00515840(0x34,0);
  if (puVar5 == (undefined4 *)0x0) {
    puVar5 = (undefined4 *)0x0;
  }
  else {
    FUN_00568960(&local_18,FUN_005d1e30);
    *puVar5 = &PTR_LAB_00b93378;
    puVar5[4] = &PTR_LAB_00b90510;
  }
  puVar2 = param_1;
  *(undefined1 *)(param_1 + 2) = 0;
  *param_1 = puVar5;
  param_1[1] = 0;
  iVar4 = FUN_00515840(0x5c,0);
  if (iVar4 == 0) {
    uVar7 = 0;
  }
  else {
    puVar5 = puVar2;
    uVar6 = FUN_00530910(0x25);
    uVar7 = FUN_005d2150(&local_18,uVar6,puVar5);
    if (uVar7 != 0) {
      *(uint *)(uVar7 + 8) = *(int *)(uVar7 + 8) + 1U & 0x8fffffff;
    }
  }
  param_1 = (undefined4 *)0x28;
  param_2 = uVar7;
  FUN_0050ff10(&param_1,&param_2);
  if (param_2 != 0) {
    FUN_00503db0();
  }
  puVar5 = &param_2;
  param_2 = param_2 & 0xffffff00;
  iVar4 = *(int *)(*(int *)(iVar3 + 0x29c) + 0x10);
  uVar6 = FUN_00526210(puVar2);
  (**(code **)(iVar4 + 0x28))(&local_18,iVar3 + 0xa8,uVar6,puVar5);
  FUN_00526bc0();
  if (uVar7 != 0) {
    FUN_00503db0();
  }
  return puVar2;
}



============================================================
DISASSEMBLY
============================================================
005d21b0 : SUB ESP,0x18
005d21b3 : PUSH EBX
005d21b4 : PUSH EBP
005d21b5 : PUSH ESI
005d21b6 : MOV ESI,dword ptr [ESP + 0x2c]
005d21ba : MOV EAX,dword ptr [ESI + 0x9c]
005d21c0 : PUSH EDI
005d21c1 : PUSH ECX
005d21c2 : MOV ECX,ESP
005d21c4 : MOV dword ptr [ECX],EAX
005d21c6 : INC dword ptr [EAX + 0x8]
005d21c9 : MOV ECX,ESI
005d21cb : CALL 0x00530480
005d21d0 : XOR EBX,EBX
005d21d2 : CMP EAX,EBX
005d21d4 : JNZ 0x005d2210
005d21d6 : LEA EAX,[ESP + 0x18]
005d21da : PUSH ESI
005d21db : PUSH EAX
005d21dc : CALL 0x005cf4c0
005d21e1 : ADD ESP,0x8
005d21e4 : TEST byte ptr [ESP + 0x20],0x2
005d21e9 : JNZ 0x005d21f8
005d21eb : MOV ECX,dword ptr [ESP + 0x18]
005d21ef : CMP ECX,EBX
005d21f1 : JZ 0x005d21f8
005d21f3 : CALL 0x00503db0
005d21f8 : TEST byte ptr [ESP + 0x20],0x1
005d21fd : MOV dword ptr [ESP + 0x18],EBX
005d2201 : JNZ 0x005d2210
005d2203 : MOV ECX,dword ptr [ESP + 0x1c]
005d2207 : CMP ECX,EBX
005d2209 : JZ 0x005d2210
005d220b : CALL 0x00503db0
005d2210 : MOV ECX,dword ptr [ESI + 0x288]
005d2216 : PUSH EBX
005d2217 : PUSH 0x34
005d2219 : MOV dword ptr [ESP + 0x18],ESI
005d221d : MOV byte ptr [ESP + 0x1c],0x8
005d2222 : CALL 0x00515840
005d2227 : MOV EDI,EAX
005d2229 : CMP EDI,EBX
005d222b : JZ 0x005d224f
005d222d : PUSH 0x5d1e30
005d2232 : LEA ECX,[ESP + 0x14]
005d2236 : PUSH ECX
005d2237 : MOV ECX,EDI
005d2239 : CALL 0x00568960
005d223e : MOV dword ptr [EDI],0xb93378
005d2244 : MOV dword ptr [EDI + 0x10],0xb90510
005d224b : MOV EAX,EDI
005d224d : JMP 0x005d2251
005d224f : XOR EAX,EAX
005d2251 : MOV EDI,dword ptr [ESP + 0x2c]
005d2255 : PUSH EBX
005d2256 : MOV byte ptr [EDI + 0x8],BL
005d2259 : MOV dword ptr [EDI],EAX
005d225b : MOV dword ptr [EDI + 0x4],EBX
005d225e : MOV ECX,dword ptr [ESI + 0x288]
005d2264 : PUSH 0x5c
005d2266 : CALL 0x00515840
005d226b : MOV EBP,EAX
005d226d : CMP EBP,EBX
005d226f : JZ 0x005d2321
005d2275 : PUSH EDI
005d2276 : PUSH 0x25
005d2278 : MOV ECX,ESI
005d227a : CALL 0x00530910
005d227f : PUSH EAX
005d2280 : LEA EDX,[ESP + 0x18]
005d2284 : PUSH EDX
005d2285 : MOV ECX,EBP
005d2287 : CALL 0x005d2150
005d228c : MOV EBP,EAX
005d228e : CMP EBP,EBX
005d2290 : JZ 0x005d229e
005d2292 : MOV EAX,dword ptr [EBP + 0x8]
005d2295 : INC EAX
005d2296 : AND EAX,0x8fffffff
005d229b : MOV dword ptr [EBP + 0x8],EAX
005d229e : LEA ECX,[ESP + 0x30]
005d22a2 : PUSH ECX
005d22a3 : LEA EDX,[ESP + 0x30]
005d22a7 : PUSH EDX
005d22a8 : LEA ECX,[ESI + 0x278]
005d22ae : MOV dword ptr [ESP + 0x38],EBP
005d22b2 : MOV dword ptr [ESP + 0x34],0x28
005d22ba : CALL 0x0050ff10
005d22bf : MOV ECX,dword ptr [ESP + 0x30]
005d22c3 : CMP ECX,EBX
005d22c5 : JZ 0x005d22cc
005d22c7 : CALL 0x00503db0
005d22cc : MOV EAX,dword ptr [ESI + 0x29c]
005d22d2 : LEA ECX,[ESP + 0x30]
005d22d6 : PUSH ECX
005d22d7 : MOV byte ptr [ESP + 0x34],BL
005d22db : MOV EBX,dword ptr [EAX + 0x10]
005d22de : PUSH EDI
005d22df : LEA ECX,[ESP + 0x20]
005d22e3 : CALL 0x00526210
005d22e8 : MOV ECX,dword ptr [ESI + 0x29c]
005d22ee : PUSH EAX
005d22ef : LEA EDX,[ESI + 0xa8]
005d22f5 : PUSH EDX
005d22f6 : MOV EDX,dword ptr [EBX + 0x28]
005d22f9 : LEA EAX,[ESP + 0x1c]
005d22fd : PUSH EAX
005d22fe : ADD ECX,0x10
005d2301 : CALL EDX
005d2303 : LEA ECX,[ESP + 0x18]
005d2307 : CALL 0x00526bc0
005d230c : TEST EBP,EBP
005d230e : JZ 0x005d2317
005d2310 : MOV ECX,EBP
005d2312 : CALL 0x00503db0
005d2317 : MOV EAX,EDI
005d2319 : POP EDI
005d231a : POP ESI
005d231b : POP EBP
005d231c : POP EBX
005d231d : ADD ESP,0x18
005d2320 : RET
005d2321 : XOR EBP,EBP
005d2323 : JMP 0x005d229e

PROGRAM  : Maestia.exe
FUNCTION : FUN_00571c40
ENTRY    : 00571c40
BODY     : [[00571c40, 00571cf8]]

============================================================
DECOMPILED C CODE
============================================================

int * FUN_00571c40(int param_1)

{
  int *piVar1;
  int *piVar2;
  int *piVar3;
  int in_ECX;
  
  piVar3 = *(int **)(in_ECX + 0x4c);
  if (piVar3 == (int *)0x0) {
    piVar3 = (int *)FUN_00515840(0x40,0);
    if (piVar3 == (int *)0x0) {
      return (int *)0x0;
    }
    piVar3[2] = 0;
    piVar3[3] = 0;
    piVar3[4] = 0;
    piVar3[5] = 0;
    *(undefined1 *)((int)piVar3 + 0x1a) = 0;
    *(undefined1 *)((int)piVar3 + 0x1b) = 0xff;
    *(undefined1 *)(piVar3 + 7) = 0;
    *(undefined2 *)(piVar3 + 6) = 0;
    *(undefined1 *)((int)piVar3 + 0x1d) = 0;
    *(undefined1 *)(piVar3 + 10) = 0;
    piVar3[8] = 0;
    piVar3[9] = 0;
    piVar3[0xc] = 0;
    piVar3[0xd] = 0;
    piVar3[0xe] = 0;
    *piVar3 = 0;
    piVar3[1] = 0;
    if ((GRefCountNTSImpl *)piVar3[3] != (GRefCountNTSImpl *)0x0) {
      GRefCountNTSImpl::Release((GRefCountNTSImpl *)piVar3[3]);
    }
    piVar3[3] = 0;
    piVar3[0xf] = 0;
  }
  else {
    *(int *)(in_ECX + 0x4c) = *piVar3;
    *piVar3 = 0;
    *(int *)(in_ECX + 0x54) = *(int *)(in_ECX + 0x54) + -1;
  }
  piVar2 = *(int **)(in_ECX + 4 + param_1 * 0xc);
  piVar1 = (int *)(in_ECX + param_1 * 0xc);
  if (piVar2 == (int *)0x0) {
    *piVar3 = *piVar1;
    *piVar1 = (int)piVar3;
  }
  else {
    *piVar3 = *piVar2;
    *(int **)piVar1[1] = piVar3;
  }
  piVar1[1] = (int)piVar3;
  if (*piVar3 == 0) {
    piVar1[2] = (int)piVar3;
  }
  piVar3[0xf] = *(int *)(in_ECX + 0x50);
  *(int *)(in_ECX + 0x48) = *(int *)(in_ECX + 0x48) + 1;
  return piVar3;
}



============================================================
DISASSEMBLY
============================================================
00571c40 : PUSH EBX
00571c41 : PUSH ESI
00571c42 : PUSH EDI
00571c43 : MOV EDI,ECX
00571c45 : MOV EAX,dword ptr [EDI + 0x4c]
00571c48 : XOR EBX,EBX
00571c4a : CMP EAX,EBX
00571c4c : JZ 0x00571c72
00571c4e : MOV ECX,dword ptr [EAX]
00571c50 : MOV dword ptr [EDI + 0x4c],ECX
00571c53 : MOV dword ptr [EAX],EBX
00571c55 : DEC dword ptr [EDI + 0x54]
00571c58 : MOV ECX,dword ptr [ESP + 0x10]
00571c5c : LEA ECX,[ECX + ECX*0x2]
00571c5f : MOV EDX,dword ptr [EDI + ECX*0x4 + 0x4]
00571c63 : LEA ECX,[EDI + ECX*0x4]
00571c66 : CMP EDX,EBX
00571c68 : JNZ 0x00571cd7
00571c6a : MOV EDX,dword ptr [ECX]
00571c6c : MOV dword ptr [EAX],EDX
00571c6e : MOV dword ptr [ECX],EAX
00571c70 : JMP 0x00571ce0
00571c72 : MOV ECX,dword ptr [EDI + 0x5c]
00571c75 : PUSH EBX
00571c76 : PUSH 0x40
00571c78 : CALL 0x00515840
00571c7d : MOV ESI,EAX
00571c7f : CMP ESI,EBX
00571c81 : JZ 0x00571ccf
00571c83 : MOV dword ptr [ESI + 0x8],EBX
00571c86 : MOV dword ptr [ESI + 0xc],EBX
00571c89 : MOV dword ptr [ESI + 0x10],EBX
00571c8c : MOV dword ptr [ESI + 0x14],EBX
00571c8f : MOV byte ptr [ESI + 0x1a],BL
00571c92 : MOV byte ptr [ESI + 0x1b],0xff
00571c96 : MOV byte ptr [ESI + 0x1c],BL
00571c99 : XOR EDX,EDX
00571c9b : MOV word ptr [ESI + 0x18],DX
00571c9f : MOV byte ptr [ESI + 0x1d],BL
00571ca2 : MOV byte ptr [ESI + 0x28],BL
00571ca5 : MOV dword ptr [ESI + 0x20],EBX
00571ca8 : MOV dword ptr [ESI + 0x24],EBX
00571cab : MOV dword ptr [ESI + 0x30],EBX
00571cae : MOV dword ptr [ESI + 0x34],EBX
00571cb1 : MOV dword ptr [ESI + 0x38],EBX
00571cb4 : MOV dword ptr [ESI],EBX
00571cb6 : MOV dword ptr [ESI + 0x4],EBX
00571cb9 : MOV ECX,dword ptr [ESI + 0xc]
00571cbc : CMP ECX,EBX
00571cbe : JZ 0x00571cc5
00571cc0 : CALL 0x004ff7c0
00571cc5 : MOV dword ptr [ESI + 0xc],EBX
00571cc8 : MOV dword ptr [ESI + 0x3c],EBX
00571ccb : MOV EAX,ESI
00571ccd : JMP 0x00571c58
00571ccf : POP EDI
00571cd0 : POP ESI
00571cd1 : XOR EAX,EAX
00571cd3 : POP EBX
00571cd4 : RET 0x4
00571cd7 : MOV EDX,dword ptr [EDX]
00571cd9 : MOV dword ptr [EAX],EDX
00571cdb : MOV EDX,dword ptr [ECX + 0x4]
00571cde : MOV dword ptr [EDX],EAX
00571ce0 : MOV dword ptr [ECX + 0x4],EAX
00571ce3 : CMP dword ptr [EAX],EBX
00571ce5 : JNZ 0x00571cea
00571ce7 : MOV dword ptr [ECX + 0x8],EAX
00571cea : MOV ECX,dword ptr [EDI + 0x50]
00571ced : MOV dword ptr [EAX + 0x3c],ECX
00571cf0 : INC dword ptr [EDI + 0x48]
00571cf3 : POP EDI
00571cf4 : POP ESI
00571cf5 : POP EBX
00571cf6 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_00a23fb0
ENTRY    : 00a23fb0
BODY     : [[00a23fb0, 00a243c8]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a23fb0(int param_1)

{
  int *piVar1;
  char cVar2;
  SHORT SVar3;
  uint uVar4;
  int *piVar5;
  undefined4 uVar6;
  undefined4 *puVar7;
  uint uVar8;
  int iVar9;
  undefined1 local_70 [28];
  LPCRITICAL_SECTION local_54;
  char *local_50;
  undefined4 local_4c;
  int local_48;
  undefined4 local_44;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  int *local_24;
  uint local_20;
  uint local_1c;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b2febd;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(int *)(param_1 + 0x57c) != 0) {
    local_54 = (LPCRITICAL_SECTION)(*(int *)(*(int *)(param_1 + 0xc) + 0x2ac4) + 0x2eef0);
    local_48 = 0;
    local_50 = ".\\Flow\\AvaGameZone.cpp";
    local_4c = 0x46be;
    local_44 = 1;
    FUN_006ef1a0(&local_54);
    local_8 = 0;
    piVar5 = (int *)FUN_0077a6d0(*(undefined4 *)(*(int *)(param_1 + 0xc) + 0x2ac4));
    if (piVar5[7] == 0) {
      if (((DAT_0172491c != 0) && (*DAT_00da9894 != 0)) && (*(int *)(*DAT_00da9894 + 0x1a8) != 0)) {
        FUN_00406460(L"IDS_CHARACTER_NOT_MOVALBE");
        local_8._0_1_ = 1;
        piVar5 = *(int **)(*DAT_00da9894 + 0x1a8);
        uVar6 = FUN_0081d120(local_70);
        local_8._0_1_ = 2;
        (**(code **)(*piVar5 + 0x44))(uVar6,3);
        local_8._0_1_ = 1;
        FUN_00406560();
        local_8 = (uint)local_8._1_3_ << 8;
        FUN_00406560();
      }
      *(undefined4 *)(param_1 + 0x57c) = 0;
      local_8 = 0xffffffff;
      if (local_48 != 0) {
        LeaveCriticalSection(local_54);
        ExceptionList = local_10;
        return;
      }
    }
    else {
      SVar3 = GetKeyState(0x10);
      if ((-1 < SVar3) || (*(char *)(param_1 + 0x5cd) == '\0')) {
        FUN_00476f00(uVar4);
      }
      uVar4 = piVar5[6];
      piVar1 = (int *)*piVar5;
      uVar8 = piVar5[7];
      local_1c = uVar4 + uVar8;
      local_34 = 0;
      local_30 = 0;
      local_2c = 0;
      if (1 < uVar8) {
        uVar4 = uVar4 + 1;
      }
      local_24 = piVar1;
      local_20 = uVar4;
      puVar7 = (undefined4 *)FUN_004c9510();
      local_40 = *puVar7;
      local_3c = puVar7[1];
      local_38 = puVar7[2];
      local_28 = 0;
      local_24 = (int *)0x0;
      local_20 = 0;
      if (1 < uVar8) {
        for (; uVar4 != local_1c; uVar4 = uVar4 + 1) {
          if (piVar1 == (int *)0x0) {
            iVar9 = 0;
          }
          else {
            iVar9 = *piVar1;
          }
          uVar8 = uVar4;
          if (*(uint *)(iVar9 + 0x14) <= uVar4) {
            if (piVar1 == (int *)0x0) {
              iVar9 = 0;
            }
            else {
              iVar9 = *piVar1;
            }
            uVar8 = uVar4 - *(int *)(iVar9 + 0x14);
          }
          if (piVar1 == (int *)0x0) {
            iVar9 = 0;
          }
          else {
            iVar9 = *piVar1;
          }
          puVar7 = *(undefined4 **)(*(int *)(iVar9 + 0x10) + uVar8 * 4);
          local_34 = *puVar7;
          local_30 = puVar7[1];
          local_2c = puVar7[2];
          FUN_00442890(&local_34);
          if (piVar1 == (int *)0x0) {
            iVar9 = 0;
          }
          else {
            iVar9 = *piVar1;
          }
          uVar8 = uVar4;
          if (*(uint *)(iVar9 + 0x14) <= uVar4) {
            if (piVar1 == (int *)0x0) {
              iVar9 = 0;
            }
            else {
              iVar9 = *piVar1;
            }
            uVar8 = uVar4 - *(int *)(iVar9 + 0x14);
          }
          if (piVar1 == (int *)0x0) {
            iVar9 = 0;
          }
          else {
            iVar9 = *piVar1;
          }
          puVar7 = *(undefined4 **)(*(int *)(iVar9 + 0x10) + uVar8 * 4);
          local_28 = *puVar7;
          local_24 = (int *)puVar7[1];
          local_20 = puVar7[2];
        }
      }
      SVar3 = GetKeyState(0x10);
      if (((-1 < SVar3) || (cVar2 = FUN_008896a0(), cVar2 == '\0')) ||
         (*(char *)(param_1 + 0x5cd) == '\0')) {
        (**(code **)(**(int **)(param_1 + 0xac) + 0x334))(&local_40);
      }
      iVar9 = *(int *)(param_1 + 0x18c);
      *(undefined4 *)(iVar9 + 0x68) = local_28;
      *(int **)(iVar9 + 0x6c) = local_24;
      *(uint *)(iVar9 + 0x70) = local_20;
      *(undefined1 *)(iVar9 + 0x5d) = 1;
      *(undefined1 *)(iVar9 + 0x134) = 1;
      *(undefined1 *)(iVar9 + 0x5c) = 1;
      if (*(int **)(iVar9 + 0x2c) != (int *)0x0) {
        (**(code **)(**(int **)(iVar9 + 0x2c) + 0x60))(iVar9);
      }
      if (*(int **)(param_1 + 400) != (int *)0x0) {
        (**(code **)(**(int **)(param_1 + 400) + 0x24))();
        (**(code **)(**(int **)(param_1 + 400) + 0x20))();
      }
      if (*(int *)(*DAT_00da9894 + 300) == 0) {
        iVar9 = 0;
      }
      else {
        iVar9 = *(int *)(*(int *)(*DAT_00da9894 + 300) + 0x18);
      }
      *(undefined4 *)(iVar9 + 200) = local_28;
      *(int **)(iVar9 + 0xcc) = local_24;
      *(uint *)(iVar9 + 0xd0) = local_20;
      SVar3 = GetKeyState(0x10);
      if ((SVar3 < 0) && (*(char *)(param_1 + 0x5cd) == '\x01')) {
        if (*(int *)(*DAT_00da9894 + 300) == 0) {
          uVar6 = 1;
        }
        else {
          uVar6 = 1;
        }
      }
      else {
        uVar6 = 0;
      }
      FUN_00981ad0(uVar6);
      *(undefined1 *)(param_1 + 0x5cd) = 0;
      if (*(char *)(param_1 + 0x772) == '\0') {
        *(undefined2 *)(param_1 + 0x770) = 0;
      }
      *(undefined4 *)(param_1 + 0x57c) = 0;
      local_8 = 0xffffffff;
      if (local_48 != 0) {
        LeaveCriticalSection(local_54);
      }
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00a23fb0 : PUSH EBP
00a23fb1 : MOV EBP,ESP
00a23fb3 : PUSH -0x1
00a23fb5 : PUSH 0xb2febd
00a23fba : MOV EAX,FS:[0x0]
00a23fc0 : PUSH EAX
00a23fc1 : SUB ESP,0x80
00a23fc7 : PUSH EBX
00a23fc8 : PUSH ESI
00a23fc9 : PUSH EDI
00a23fca : MOV EAX,[0x00d66fa0]
00a23fcf : XOR EAX,EBP
00a23fd1 : PUSH EAX
00a23fd2 : LEA EAX,[EBP + -0xc]
00a23fd5 : MOV FS:[0x0],EAX
00a23fdb : MOV ESI,dword ptr [EBP + 0x8]
00a23fde : XOR EDI,EDI
00a23fe0 : CMP dword ptr [ESI + 0x57c],EDI
00a23fe6 : JZ 0x00a243b5
00a23fec : MOV EAX,dword ptr [ESI + 0xc]
00a23fef : MOV EAX,dword ptr [EAX + 0x2ac4]
00a23ff5 : ADD EAX,0x2eeec
00a23ffa : LEA ECX,[EBP + -0x50]
00a23ffd : ADD EAX,0x4
00a24000 : PUSH ECX
00a24001 : MOV dword ptr [EBP + -0x44],EDI
00a24004 : MOV dword ptr [EBP + -0x50],EAX
00a24007 : MOV dword ptr [EBP + -0x4c],0xcc440c
00a2400e : MOV dword ptr [EBP + -0x48],0x46be
00a24015 : MOV dword ptr [EBP + -0x40],0x1
00a2401c : CALL 0x006ef1a0
00a24021 : MOV dword ptr [EBP + -0x4],EDI
00a24024 : MOV EAX,dword ptr [ESI + 0xc]
00a24027 : MOV EDX,dword ptr [EAX + 0x2ac4]
00a2402d : PUSH EDX
00a2402e : CALL 0x0077a6d0
00a24033 : MOV EBX,EAX
00a24035 : CMP dword ptr [EBX + 0x1c],EDI
00a24038 : JNZ 0x00a240f0
00a2403e : CMP dword ptr [0x0172491c],EDI
00a24044 : JZ 0x00a240b9
00a24046 : MOV EAX,[0x00da9894]
00a2404b : MOV EAX,dword ptr [EAX]
00a2404d : CMP EAX,EDI
00a2404f : JZ 0x00a240b9
00a24051 : CMP dword ptr [EAX + 0x1a8],EDI
00a24057 : JZ 0x00a240b9
00a24059 : PUSH 0xcc4424
00a2405e : LEA ECX,[EBP + -0x6c]
00a24061 : CALL 0x00406460
00a24066 : MOV byte ptr [EBP + -0x4],0x1
00a2406a : MOV ECX,dword ptr [0x00da9894]
00a24070 : MOV EAX,dword ptr [ECX]
00a24072 : MOV ECX,dword ptr [0x0172491c]
00a24078 : MOV ESI,dword ptr [EAX + 0x1a8]
00a2407e : LEA EDX,[EBP + -0x6c]
00a24081 : PUSH EDX
00a24082 : LEA EDI,[EBP + 0xffffff78]
00a24088 : CALL 0x0081d120
00a2408d : MOV byte ptr [EBP + -0x4],0x2
00a24091 : MOV EDX,dword ptr [ESI]
00a24093 : PUSH 0x3
00a24095 : PUSH EAX
00a24096 : MOV EAX,dword ptr [EDX + 0x44]
00a24099 : MOV ECX,ESI
00a2409b : CALL EAX
00a2409d : MOV byte ptr [EBP + -0x4],0x1
00a240a1 : MOV ECX,EDI
00a240a3 : CALL 0x00406560
00a240a8 : MOV byte ptr [EBP + -0x4],0x0
00a240ac : LEA ECX,[EBP + -0x6c]
00a240af : CALL 0x00406560
00a240b4 : MOV ESI,dword ptr [EBP + 0x8]
00a240b7 : XOR EDI,EDI
00a240b9 : MOV dword ptr [ESI + 0x57c],EDI
00a240bf : MOV dword ptr [EBP + -0x4],0xffffffff
00a240c6 : CMP dword ptr [EBP + -0x44],EDI
00a240c9 : JZ 0x00a243b5
00a240cf : MOV ECX,dword ptr [EBP + -0x50]
00a240d2 : PUSH ECX
00a240d3 : CALL dword ptr [0x00b8511c]
00a240d9 : MOV dword ptr [EBP + -0x44],EDI
00a240dc : MOV ECX,dword ptr [EBP + -0xc]
00a240df : MOV dword ptr FS:[0x0],ECX
00a240e6 : POP ECX
00a240e7 : POP EDI
00a240e8 : POP ESI
00a240e9 : POP EBX
00a240ea : MOV ESP,EBP
00a240ec : POP EBP
00a240ed : RET 0x4
00a240f0 : PUSH 0x10
00a240f2 : CALL dword ptr [0x00b85438]
00a240f8 : TEST AX,AX
00a240fb : JGE 0x00a24106
00a240fd : CMP byte ptr [ESI + 0x5cd],0x0
00a24104 : JNZ 0x00a24117
00a24106 : MOV ESI,dword ptr [ESI + 0xac]
00a2410c : ADD ESI,0x59c
00a24112 : CALL 0x00476f00
00a24117 : MOV EDI,dword ptr [EBX + 0x18]
00a2411a : MOV ESI,dword ptr [EBX]
00a2411c : MOV EBX,dword ptr [EBX + 0x1c]
00a2411f : XORPS XMM0,XMM0
00a24122 : LEA EDX,[EDI + EBX*0x1]
00a24125 : MOV dword ptr [EBP + -0x20],ESI
00a24128 : MOV dword ptr [EBP + -0x1c],EDI
00a2412b : MOV dword ptr [EBP + -0x18],EDX
00a2412e : MOVSS dword ptr [EBP + -0x30],XMM0
00a24133 : MOVSS dword ptr [EBP + -0x2c],XMM0
00a24138 : MOVSS dword ptr [EBP + -0x28],XMM0
00a2413d : CMP EBX,0x1
00a24140 : JBE 0x00a24146
00a24142 : INC EDI
00a24143 : MOV dword ptr [EBP + -0x1c],EDI
00a24146 : LEA EAX,[EBP + -0x20]
00a24149 : CALL 0x004c9510
00a2414e : MOVSS XMM0,dword ptr [EAX]
00a24152 : MOVSS XMM1,dword ptr [EAX + 0x4]
00a24157 : MOVSS XMM2,dword ptr [EAX + 0x8]
00a2415c : MOVSS dword ptr [EBP + -0x3c],XMM0
00a24161 : XORPS XMM0,XMM0
00a24164 : MOVSS dword ptr [EBP + -0x38],XMM1
00a24169 : MOVSS dword ptr [EBP + -0x34],XMM2
00a2416e : MOVSS dword ptr [EBP + -0x24],XMM0
00a24173 : MOVSS dword ptr [EBP + -0x20],XMM0
00a24178 : MOVSS dword ptr [EBP + -0x1c],XMM0
00a2417d : CMP EBX,0x1
00a24180 : JBE 0x00a2424c
00a24186 : MOV EBX,ESI
00a24188 : CMP ESI,EBX
00a2418a : JNZ 0x00a24195
00a2418c : CMP EDI,dword ptr [EBP + -0x18]
00a2418f : JZ 0x00a2424c
00a24195 : MOV EAX,EDI
00a24197 : TEST ESI,ESI
00a24199 : JZ 0x00a2419f
00a2419b : MOV ECX,dword ptr [ESI]
00a2419d : JMP 0x00a241a1
00a2419f : XOR ECX,ECX
00a241a1 : CMP dword ptr [ECX + 0x14],EDI
00a241a4 : JA 0x00a241b5
00a241a6 : TEST ESI,ESI
00a241a8 : JZ 0x00a241ae
00a241aa : MOV ECX,dword ptr [ESI]
00a241ac : JMP 0x00a241b0
00a241ae : XOR ECX,ECX
00a241b0 : MOV EAX,EDI
00a241b2 : SUB EAX,dword ptr [ECX + 0x14]
00a241b5 : TEST ESI,ESI
00a241b7 : JZ 0x00a241bd
00a241b9 : MOV ECX,dword ptr [ESI]
00a241bb : JMP 0x00a241bf
00a241bd : XOR ECX,ECX
00a241bf : MOV ECX,dword ptr [ECX + 0x10]
00a241c2 : MOV EAX,dword ptr [ECX + EAX*0x4]
00a241c5 : MOVSS XMM0,dword ptr [EAX]
00a241c9 : MOVSS dword ptr [EBP + -0x30],XMM0
00a241ce : MOVSS XMM0,dword ptr [EAX + 0x4]
00a241d3 : MOVSS dword ptr [EBP + -0x2c],XMM0
00a241d8 : MOVSS XMM0,dword ptr [EAX + 0x8]
00a241dd : MOV EAX,dword ptr [EBP + 0x8]
00a241e0 : MOV EAX,dword ptr [EAX + 0xac]
00a241e6 : LEA EDX,[EBP + -0x30]
00a241e9 : PUSH EDX
00a241ea : ADD EAX,0x59c
00a241ef : MOVSS dword ptr [EBP + -0x28],XMM0
00a241f4 : CALL 0x00442890
00a241f9 : MOV EAX,EDI
00a241fb : TEST ESI,ESI
00a241fd : JZ 0x00a24203
00a241ff : MOV ECX,dword ptr [ESI]
00a24201 : JMP 0x00a24205
00a24203 : XOR ECX,ECX
00a24205 : CMP dword ptr [ECX + 0x14],EDI
00a24208 : JA 0x00a24219
00a2420a : TEST ESI,ESI
00a2420c : JZ 0x00a24212
00a2420e : MOV ECX,dword ptr [ESI]
00a24210 : JMP 0x00a24214
00a24212 : XOR ECX,ECX
00a24214 : MOV EAX,EDI
00a24216 : SUB EAX,dword ptr [ECX + 0x14]
00a24219 : TEST ESI,ESI
00a2421b : JZ 0x00a24221
00a2421d : MOV ECX,dword ptr [ESI]
00a2421f : JMP 0x00a24223
00a24221 : XOR ECX,ECX
00a24223 : MOV ECX,dword ptr [ECX + 0x10]
00a24226 : MOV EAX,dword ptr [ECX + EAX*0x4]
00a24229 : MOVSS XMM0,dword ptr [EAX]
00a2422d : MOVSS dword ptr [EBP + -0x24],XMM0
00a24232 : MOVSS XMM0,dword ptr [EAX + 0x4]
00a24237 : MOVSS dword ptr [EBP + -0x20],XMM0
00a2423c : MOVSS XMM0,dword ptr [EAX + 0x8]
00a24241 : MOVSS dword ptr [EBP + -0x1c],XMM0
00a24246 : INC EDI
00a24247 : JMP 0x00a24188
00a2424c : MOV ESI,dword ptr [0x00b85438]
00a24252 : PUSH 0x10
00a24254 : CALL ESI
00a24256 : MOV EDI,dword ptr [EBP + 0x8]
00a24259 : TEST AX,AX
00a2425c : JGE 0x00a24276
00a2425e : MOV EAX,dword ptr [EDI + 0xac]
00a24264 : CALL 0x008896a0
00a24269 : TEST AL,AL
00a2426b : JZ 0x00a24276
00a2426d : CMP byte ptr [EDI + 0x5cd],0x0
00a24274 : JNZ 0x00a2428a
00a24276 : MOV ECX,dword ptr [EDI + 0xac]
00a2427c : MOV EDX,dword ptr [ECX]
00a2427e : MOV EDX,dword ptr [EDX + 0x334]
00a24284 : LEA EAX,[EBP + -0x3c]
00a24287 : PUSH EAX
00a24288 : CALL EDX
00a2428a : MOV EAX,dword ptr [EDI + 0x18c]
00a24290 : MOVSS XMM0,dword ptr [EBP + -0x24]
00a24295 : MOVSS dword ptr [EAX + 0x68],XMM0
00a2429a : MOVSS XMM0,dword ptr [EBP + -0x20]
00a2429f : MOVSS dword ptr [EAX + 0x6c],XMM0
00a242a4 : MOVSS XMM0,dword ptr [EBP + -0x1c]
00a242a9 : MOVSS dword ptr [EAX + 0x70],XMM0
00a242ae : MOV ECX,dword ptr [EAX + 0x2c]
00a242b1 : XOR EBX,EBX
00a242b3 : MOV byte ptr [EAX + 0x5d],0x1
00a242b7 : MOV byte ptr [EAX + 0x134],0x1
00a242be : MOV byte ptr [EAX + 0x5c],0x1
00a242c2 : CMP ECX,EBX
00a242c4 : JZ 0x00a242ce
00a242c6 : MOV EDX,dword ptr [ECX]
00a242c8 : PUSH EAX
00a242c9 : MOV EAX,dword ptr [EDX + 0x60]
00a242cc : CALL EAX
00a242ce : MOV ECX,dword ptr [EDI + 0x190]
00a242d4 : CMP ECX,EBX
00a242d6 : JZ 0x00a242ec
00a242d8 : MOV EDX,dword ptr [ECX]
00a242da : MOV EAX,dword ptr [EDX + 0x24]
00a242dd : CALL EAX
00a242df : MOV ECX,dword ptr [EDI + 0x190]
00a242e5 : MOV EDX,dword ptr [ECX]
00a242e7 : MOV EAX,dword ptr [EDX + 0x20]
00a242ea : CALL EAX
00a242ec : MOV ECX,dword ptr [0x00da9894]
00a242f2 : MOV EAX,dword ptr [ECX]
00a242f4 : MOV EAX,dword ptr [EAX + 0x12c]
00a242fa : CMP EAX,EBX
00a242fc : JNZ 0x00a24302
00a242fe : XOR EAX,EAX
00a24300 : JMP 0x00a24305
00a24302 : MOV EAX,dword ptr [EAX + 0x18]
00a24305 : MOVSS XMM0,dword ptr [EBP + -0x24]
00a2430a : MOVSS dword ptr [EAX + 0xc8],XMM0
00a24312 : MOVSS XMM0,dword ptr [EBP + -0x20]
00a24317 : MOVSS dword ptr [EAX + 0xcc],XMM0
00a2431f : MOVSS XMM0,dword ptr [EBP + -0x1c]
00a24324 : PUSH 0x10
00a24326 : MOVSS dword ptr [EAX + 0xd0],XMM0
00a2432e : CALL ESI
00a24330 : TEST AX,AX
00a24333 : JGE 0x00a2435d
00a24335 : CMP byte ptr [EDI + 0x5cd],0x1
00a2433c : JNZ 0x00a2435d
00a2433e : MOV EDX,dword ptr [0x00da9894]
00a24344 : MOV EAX,dword ptr [EDX]
00a24346 : MOV EAX,dword ptr [EAX + 0x12c]
00a2434c : CMP EAX,EBX
00a2434e : JNZ 0x00a24356
00a24350 : XOR EAX,EAX
00a24352 : PUSH 0x1
00a24354 : JMP 0x00a24376
00a24356 : MOV EAX,dword ptr [EAX + 0x18]
00a24359 : PUSH 0x1
00a2435b : JMP 0x00a24376
00a2435d : MOV EAX,[0x00da9894]
00a24362 : MOV EAX,dword ptr [EAX]
00a24364 : MOV EAX,dword ptr [EAX + 0x12c]
00a2436a : CMP EAX,EBX
00a2436c : JNZ 0x00a24372
00a2436e : XOR EAX,EAX
00a24370 : JMP 0x00a24375
00a24372 : MOV EAX,dword ptr [EAX + 0x18]
00a24375 : PUSH EBX
00a24376 : MOV ESI,EAX
00a24378 : CALL 0x00981ad0
00a2437d : CMP byte ptr [EDI + 0x772],0x0
00a24384 : MOV byte ptr [EDI + 0x5cd],0x0
00a2438b : JNZ 0x00a24396
00a2438d : XOR ECX,ECX
00a2438f : MOV word ptr [EDI + 0x770],CX
00a24396 : MOV dword ptr [EDI + 0x57c],EBX
00a2439c : MOV dword ptr [EBP + -0x4],0xffffffff
00a243a3 : CMP dword ptr [EBP + -0x44],EBX
00a243a6 : JZ 0x00a243b5
00a243a8 : MOV EDX,dword ptr [EBP + -0x50]
00a243ab : PUSH EDX
00a243ac : CALL dword ptr [0x00b8511c]
00a243b2 : MOV dword ptr [EBP + -0x44],EBX
00a243b5 : MOV ECX,dword ptr [EBP + -0xc]
00a243b8 : MOV dword ptr FS:[0x0],ECX
00a243bf : POP ECX
00a243c0 : POP EDI
00a243c1 : POP ESI
00a243c2 : POP EBX
00a243c3 : MOV ESP,EBP
00a243c5 : POP EBP
00a243c6 : RET 0x4

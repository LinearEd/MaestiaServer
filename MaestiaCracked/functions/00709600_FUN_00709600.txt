PROGRAM  : Maestia.exe
FUNCTION : FUN_00709600
ENTRY    : 00709600
BODY     : [[00709600, 00709863]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00709600(undefined4 param_1)

{
  int *piVar1;
  int iVar2;
  uint uVar3;
  byte *pbVar4;
  byte *pbVar5;
  byte bVar6;
  byte bVar7;
  int in_ECX;
  uint uVar8;
  uint uVar9;
  int iVar10;
  uint uVar11;
  uint local_20;
  int local_1c;
  uint local_14;
  uint local_10;
  uint local_c [2];
  
  FUN_00707fd0(param_1);
  iVar2 = 0;
  iVar10 = 0;
  *(undefined4 *)(in_ECX + 0x30) = 0;
  uVar8 = 0;
  do {
    pbVar5 = (byte *)(iVar10 + *(int *)(in_ECX + 0xc));
    bVar6 = (byte)uVar8;
    uVar8 = uVar8 + 8;
    iVar10 = iVar10 + 1;
    *(uint *)(in_ECX + 0x30) = *(uint *)(in_ECX + 0x30) | (uint)*pbVar5 << (bVar6 & 0x1f);
  } while (uVar8 < 0x20);
  *(undefined4 *)(in_ECX + 0x34) = 0;
  uVar8 = 0;
  do {
    iVar10 = iVar2 + 4;
    bVar6 = (byte)uVar8;
    uVar8 = uVar8 + 8;
    iVar2 = iVar2 + 1;
    *(uint *)(in_ECX + 0x34) =
         *(uint *)(in_ECX + 0x34) |
         (uint)*(byte *)(iVar10 + *(int *)(in_ECX + 0xc)) << (bVar6 & 0x1f);
  } while (uVar8 < 0x20);
  FUN_004d1880(in_ECX + 0x38,local_c,*(undefined4 *)(in_ECX + 0x3c),*(undefined4 *)(in_ECX + 0x40));
  FUN_004d1220(*(undefined4 *)(in_ECX + 0x34));
  uVar8 = 8;
  if ((*(int *)(in_ECX + 0x28) - *(int *)(in_ECX + 0x24) & 0xfffffffcU) == 0) {
    local_14 = 0;
    if (*(int *)(in_ECX + 0x34) != 0) {
      do {
        iVar2 = FUN_00707800();
        uVar8 = uVar8 + iVar2;
        local_14 = local_14 + 1;
      } while (local_14 < *(uint *)(in_ECX + 0x34));
    }
  }
  else {
    uVar3 = *(int *)(in_ECX + 0x28) - *(int *)(in_ECX + 0x24) >> 2;
    local_10 = 0;
    local_20 = 0;
    if (*(int *)(in_ECX + 0x34) != 0) {
      local_1c = 0;
      do {
        uVar11 = 0;
        uVar9 = 0;
        pbVar4 = (byte *)(*(int *)(in_ECX + 0xc) + uVar8);
        pbVar5 = pbVar4;
        do {
          bVar6 = *pbVar5;
          bVar7 = (byte)uVar9;
          uVar9 = uVar9 + 8;
          pbVar5 = pbVar5 + 1;
          uVar11 = uVar11 | (uint)bVar6 << (bVar7 & 0x1f);
        } while (uVar9 < 0x10);
        local_c[0] = ((pbVar4[2] & 1) != 0) + 1;
        if ((local_20 < uVar3) &&
           (uVar9 = *(uint *)(*(int *)(in_ECX + 0x24) + local_20 * 4),
           uVar9 < local_c[0] * uVar11 + 3 + uVar8)) {
          uVar9 = (uVar9 - uVar8) - 3;
          iVar2 = 2;
          if (0 < (int)uVar9) {
            uVar9 = uVar9 / local_c[0];
            iVar2 = FUN_007075c0(*(int *)(in_ECX + 0x3c) + local_1c,
                                 *(int *)(in_ECX + 0xc) + 2 + uVar8,uVar9);
            iVar2 = iVar2 + 2;
            uVar11 = uVar11 - uVar9;
          }
          for (; (local_20 = local_20 + 1, local_20 < uVar3 &&
                 (*(uint *)(*(int *)(in_ECX + 0x24) + local_20 * 4) < uVar8 + 1 + uVar11));
              uVar11 = uVar11 + (-1 - uVar9)) {
            piVar1 = (int *)(*(int *)(in_ECX + 0x24) + local_20 * 4);
            uVar9 = ((*piVar1 - piVar1[-1]) - 1U) / local_c[0];
            iVar10 = FUN_007075c0(*(int *)(in_ECX + 0x3c) + local_1c,
                                  *(int *)(in_ECX + 0xc) + iVar2 + uVar8,uVar9);
            iVar2 = iVar2 + iVar10;
          }
          if (uVar11 != 0) {
            iVar10 = FUN_007075c0(*(int *)(in_ECX + 0x3c) + local_1c,
                                  *(int *)(in_ECX + 0xc) + iVar2 + uVar8,uVar11);
            iVar2 = iVar2 + iVar10;
          }
        }
        else {
          iVar2 = FUN_00707800();
        }
        uVar8 = uVar8 + iVar2;
        local_1c = local_1c + 0x28;
        local_10 = local_10 + 1;
      } while (local_10 < *(uint *)(in_ECX + 0x34));
    }
  }
  return uVar8 + 4 + (uVar8 / 0x2020) * 4;
}



============================================================
DISASSEMBLY
============================================================
00709600 : PUSH EBP
00709601 : MOV EBP,ESP
00709603 : AND ESP,0xfffffff8
00709606 : MOV EAX,dword ptr [EBP + 0x8]
00709609 : SUB ESP,0x1c
0070960c : PUSH EBX
0070960d : PUSH ESI
0070960e : PUSH EDI
0070960f : PUSH EAX
00709610 : MOV EDI,ECX
00709612 : CALL 0x00707fd0
00709617 : XOR EAX,EAX
00709619 : XOR EDX,EDX
0070961b : MOV dword ptr [EDI + 0x30],EAX
0070961e : XOR ECX,ECX
00709620 : MOV ESI,dword ptr [EDI + 0xc]
00709623 : MOVZX ESI,byte ptr [EDX + ESI*0x1]
00709627 : SHL ESI,CL
00709629 : ADD ECX,0x8
0070962c : INC EDX
0070962d : OR dword ptr [EDI + 0x30],ESI
00709630 : CMP ECX,0x20
00709633 : JC 0x00709620
00709635 : MOV dword ptr [EDI + 0x34],EAX
00709638 : XOR ECX,ECX
0070963a : LEA EBX,[EBX]
00709640 : MOV EDX,dword ptr [EDI + 0xc]
00709643 : MOVZX EDX,byte ptr [EAX + EDX*0x1 + 0x4]
00709648 : SHL EDX,CL
0070964a : ADD ECX,0x8
0070964d : INC EAX
0070964e : OR dword ptr [EDI + 0x34],EDX
00709651 : CMP ECX,0x20
00709654 : JC 0x00709640
00709656 : MOV EAX,dword ptr [EDI + 0x40]
00709659 : MOV ECX,dword ptr [EDI + 0x3c]
0070965c : LEA ESI,[EDI + 0x38]
0070965f : PUSH EAX
00709660 : PUSH ECX
00709661 : LEA EAX,[ESP + 0x2c]
00709665 : PUSH EAX
00709666 : PUSH ESI
00709667 : CALL 0x004d1880
0070966c : MOV ECX,dword ptr [EDI + 0x34]
0070966f : PUSH ECX
00709670 : CALL 0x004d1220
00709675 : MOV EDX,dword ptr [EDI + 0x28]
00709678 : SUB EDX,dword ptr [EDI + 0x24]
0070967b : MOV EBX,0x8
00709680 : TEST EDX,0xfffffffc
00709686 : JNZ 0x007096c6
00709688 : XOR EAX,EAX
0070968a : MOV dword ptr [ESP + 0x1c],EAX
0070968e : CMP dword ptr [EDI + 0x34],EAX
00709691 : JBE 0x0070984d
00709697 : MOV dword ptr [ESP + 0x18],EAX
0070969b : MOV ESI,dword ptr [EDI + 0x3c]
0070969e : MOV EAX,dword ptr [EDI + 0xc]
007096a1 : ADD ESI,dword ptr [ESP + 0x18]
007096a5 : ADD EAX,EBX
007096a7 : CALL 0x00707800
007096ac : ADD dword ptr [ESP + 0x18],0x28
007096b1 : ADD EBX,EAX
007096b3 : MOV EAX,dword ptr [ESP + 0x1c]
007096b7 : INC EAX
007096b8 : MOV dword ptr [ESP + 0x1c],EAX
007096bc : CMP EAX,dword ptr [EDI + 0x34]
007096bf : JC 0x0070969b
007096c1 : JMP 0x0070984d
007096c6 : MOV EAX,dword ptr [EDI + 0x28]
007096c9 : SUB EAX,dword ptr [EDI + 0x24]
007096cc : SAR EAX,0x2
007096cf : MOV dword ptr [ESP + 0x1c],EAX
007096d3 : XOR EAX,EAX
007096d5 : MOV dword ptr [ESP + 0x20],EAX
007096d9 : MOV dword ptr [ESP + 0x10],EAX
007096dd : CMP dword ptr [EDI + 0x34],EAX
007096e0 : JBE 0x0070984d
007096e6 : MOV dword ptr [ESP + 0x14],EAX
007096ea : MOV EAX,dword ptr [EDI + 0xc]
007096ed : XOR EDX,EDX
007096ef : XOR ECX,ECX
007096f1 : ADD EAX,EBX
007096f3 : MOV dword ptr [ESP + 0x18],EAX
007096f7 : MOVZX ESI,byte ptr [EAX]
007096fa : SHL ESI,CL
007096fc : ADD ECX,0x8
007096ff : INC EAX
00709700 : OR EDX,ESI
00709702 : CMP ECX,0x10
00709705 : JC 0x007096f7
00709707 : MOV EAX,dword ptr [ESP + 0x18]
0070970b : TEST byte ptr [EAX + 0x2],0x1
0070970f : MOV EAX,dword ptr [ESP + 0x10]
00709713 : MOV ECX,0x0
00709718 : SETNZ CL
0070971b : MOV dword ptr [ESP + 0xc],EDX
0070971f : INC ECX
00709720 : MOV dword ptr [ESP + 0x24],ECX
00709724 : CMP EAX,dword ptr [ESP + 0x1c]
00709728 : JNC 0x00709823
0070972e : MOV ESI,dword ptr [EDI + 0x24]
00709731 : MOV EAX,dword ptr [ESI + EAX*0x4]
00709734 : MOV ESI,ECX
00709736 : IMUL ESI,EDX
00709739 : LEA ESI,[ESI + EBX*0x1 + 0x3]
0070973d : CMP ESI,EAX
0070973f : JBE 0x00709823
00709745 : SUB EAX,EBX
00709747 : SUB EAX,0x3
0070974a : MOV dword ptr [ESP + 0x18],EAX
0070974e : MOV EAX,dword ptr [ESP + 0x10]
00709752 : INC EAX
00709753 : CMP dword ptr [ESP + 0x18],0x0
00709758 : MOV ESI,0x2
0070975d : MOV dword ptr [ESP + 0x10],EAX
00709761 : JLE 0x0070979a
00709763 : MOV EAX,dword ptr [ESP + 0x18]
00709767 : XOR EDX,EDX
00709769 : DIV ECX
0070976b : MOV ECX,dword ptr [EDI + 0x3c]
0070976e : ADD ECX,dword ptr [ESP + 0x14]
00709772 : PUSH EAX
00709773 : MOV dword ptr [ESP + 0x1c],EAX
00709777 : MOV EAX,dword ptr [EDI + 0xc]
0070977a : LEA EDX,[EAX + EBX*0x1 + 0x2]
0070977e : PUSH EDX
0070977f : PUSH ECX
00709780 : CALL 0x007075c0
00709785 : MOV ESI,EAX
00709787 : MOV EAX,dword ptr [ESP + 0x18]
0070978b : ADD ESI,0x2
0070978e : SUB dword ptr [ESP + 0xc],EAX
00709792 : MOV EDX,dword ptr [ESP + 0xc]
00709796 : MOV EAX,dword ptr [ESP + 0x10]
0070979a : CMP EAX,dword ptr [ESP + 0x1c]
0070979e : JNC 0x00709803
007097a0 : JMP 0x007097aa
007097a2 : MOV EDX,dword ptr [ESP + 0xc]
007097a6 : MOV EAX,dword ptr [ESP + 0x10]
007097aa : LEA ECX,[EBX + EDX*0x1 + 0x1]
007097ae : MOV EDX,dword ptr [EDI + 0x24]
007097b1 : CMP ECX,dword ptr [EDX + EAX*0x4]
007097b4 : JBE 0x007097ff
007097b6 : MOV ECX,EDX
007097b8 : LEA ECX,[ECX + EAX*0x4]
007097bb : MOV EAX,dword ptr [ECX]
007097bd : SUB EAX,dword ptr [ECX + -0x4]
007097c0 : XOR EDX,EDX
007097c2 : DEC EAX
007097c3 : DIV dword ptr [ESP + 0x24]
007097c7 : MOV ECX,dword ptr [EDI + 0xc]
007097ca : ADD ECX,ESI
007097cc : ADD ECX,EBX
007097ce : MOV EDX,EAX
007097d0 : MOV EAX,dword ptr [EDI + 0x3c]
007097d3 : ADD EAX,dword ptr [ESP + 0x14]
007097d7 : PUSH EDX
007097d8 : PUSH ECX
007097d9 : PUSH EAX
007097da : MOV dword ptr [ESP + 0x24],EDX
007097de : CALL 0x007075c0
007097e3 : ADD ESI,EAX
007097e5 : MOV EAX,dword ptr [ESP + 0x10]
007097e9 : OR EDX,0xffffffff
007097ec : SUB EDX,dword ptr [ESP + 0x18]
007097f0 : INC EAX
007097f1 : ADD dword ptr [ESP + 0xc],EDX
007097f5 : MOV dword ptr [ESP + 0x10],EAX
007097f9 : CMP EAX,dword ptr [ESP + 0x1c]
007097fd : JC 0x007097a2
007097ff : MOV EDX,dword ptr [ESP + 0xc]
00709803 : TEST EDX,EDX
00709805 : JBE 0x0070981f
00709807 : MOV ECX,dword ptr [EDI + 0xc]
0070980a : MOV EAX,dword ptr [EDI + 0x3c]
0070980d : ADD EAX,dword ptr [ESP + 0x14]
00709811 : ADD ECX,ESI
00709813 : PUSH EDX
00709814 : ADD ECX,EBX
00709816 : PUSH ECX
00709817 : PUSH EAX
00709818 : CALL 0x007075c0
0070981d : ADD ESI,EAX
0070981f : ADD EBX,ESI
00709821 : JMP 0x00709836
00709823 : MOV ESI,dword ptr [EDI + 0x3c]
00709826 : MOV EAX,dword ptr [EDI + 0xc]
00709829 : ADD ESI,dword ptr [ESP + 0x14]
0070982d : ADD EAX,EBX
0070982f : CALL 0x00707800
00709834 : ADD EBX,EAX
00709836 : MOV EAX,dword ptr [ESP + 0x20]
0070983a : ADD dword ptr [ESP + 0x14],0x28
0070983f : INC EAX
00709840 : MOV dword ptr [ESP + 0x20],EAX
00709844 : CMP EAX,dword ptr [EDI + 0x34]
00709847 : JC 0x007096ea
0070984d : MOV EAX,0xff00ff01
00709852 : MUL EBX
00709854 : POP EDI
00709855 : SHR EDX,0xd
00709858 : POP ESI
00709859 : LEA EAX,[EBX + EDX*0x4 + 0x4]
0070985d : POP EBX
0070985e : MOV ESP,EBP
00709860 : POP EBP
00709861 : RET 0x4

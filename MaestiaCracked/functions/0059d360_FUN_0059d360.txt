PROGRAM  : Maestia.exe
FUNCTION : FUN_0059d360
ENTRY    : 0059d360
BODY     : [[0059d360, 0059d970]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_0059d360(int param_1,int param_2,uint param_3)

{
  char cVar1;
  uint3 uVar2;
  bool bVar3;
  char cVar4;
  int iVar5;
  byte bVar6;
  byte bVar7;
  ushort uVar8;
  ushort *puVar9;
  int iVar10;
  uint local_14;
  byte local_c;
  byte local_b;
  byte local_a;
  byte local_9;
  undefined2 local_8;
  undefined2 local_6;
  undefined4 local_4;
  
  *(undefined1 *)(param_1 + 0x15) = 0;
  if (*(int *)(param_1 + 0x30) - *(int *)(param_1 + 0x2c) < 1) {
    FUN_0053a0a0();
  }
  cVar1 = *(char *)(*(int *)(param_1 + 0x2c) + *(int *)(param_1 + 0x3c));
  *(int *)(param_1 + 0x2c) = *(int *)(param_1 + 0x2c) + 1;
  local_14 = 0;
  bVar3 = false;
joined_r0x0059d39d:
  do {
    if (cVar1 == '\0') {
      return local_14;
    }
    cVar1 = cVar1 + -1;
    *(undefined1 *)(param_1 + 0x15) = 0;
    if (*(int *)(param_1 + 0x30) - *(int *)(param_1 + 0x2c) < 1) {
      FUN_0053a0a0();
    }
    local_c = *(byte *)(*(int *)(param_1 + 0x2c) + *(int *)(param_1 + 0x3c));
    iVar5 = *(int *)(param_1 + 0x2c) + 1;
    *(int *)(param_1 + 0x2c) = iVar5;
    local_a = 0;
    local_b = 0;
    local_9 = 0x10;
    local_8 = 0;
    local_6 = 0;
    local_4 = 0;
    switch(local_c) {
    case 0:
      FUN_0053b150(&local_4);
      *(undefined1 *)(param_1 + 0x15) = 0;
      if (*(int *)(param_1 + 0x30) - *(int *)(param_1 + 0x2c) < 4) {
        FUN_00539fb0(4);
      }
      iVar10 = *(int *)(param_1 + 0x2c);
      iVar5 = *(int *)(param_1 + 0x3c) + iVar10;
      uVar8 = CONCAT11(*(undefined1 *)(iVar5 + 3),
                       *(undefined1 *)(*(int *)(param_1 + 0x3c) + 2 + iVar10));
      uVar2 = CONCAT21(uVar8,*(undefined1 *)(iVar5 + 1));
      *(int *)(param_1 + 0x2c) = iVar10 + 4;
      if (0xf < uVar8) {
        uVar8 = 0xf;
      }
      local_b = (byte)(uVar2 >> 4) & 0xf | (char)uVar8 << 4;
      *(undefined1 *)(param_1 + 0x15) = 0;
      if (*(int *)(param_1 + 0x30) - (iVar10 + 4) < 4) {
        FUN_00539fb0(4);
      }
      iVar5 = *(int *)(param_1 + 0x2c);
      iVar10 = *(int *)(param_1 + 0x3c);
      uVar8 = CONCAT11(*(undefined1 *)(iVar10 + 3 + iVar5),*(undefined1 *)(iVar10 + 2 + iVar5));
      uVar2 = CONCAT21(uVar8,*(undefined1 *)(iVar10 + iVar5 + 1));
      *(int *)(param_1 + 0x2c) = iVar5 + 4;
      if (0xf < uVar8) {
        uVar8 = 0xf;
      }
      local_a = (byte)(uVar2 >> 4) & 0xf | (char)uVar8 << 4;
      *(undefined1 *)(param_1 + 0x15) = 0;
      if (*(int *)(param_1 + 0x30) - (iVar5 + 4) < 4) {
        FUN_00539fb0(4);
      }
      iVar5 = *(int *)(param_1 + 0x2c) + 4;
      *(int *)(param_1 + 0x2c) = iVar5;
      FUN_0063b56a();
      local_8 = FUN_0063b380();
      *(undefined1 *)(param_1 + 0x15) = 0;
      if (*(int *)(param_1 + 0x30) - iVar5 < 4) {
        FUN_00539fb0(4);
      }
      iVar5 = *(int *)(param_1 + 0x2c) + 4;
      *(int *)(param_1 + 0x2c) = iVar5;
      local_6 = FUN_0063b380();
      *(undefined1 *)(param_1 + 0x15) = 0;
      if (*(int *)(param_1 + 0x30) - iVar5 < 2) {
        FUN_00539fb0(2);
      }
      iVar5 = *(int *)(param_1 + 0x2c);
      puVar9 = (ushort *)(*(int *)(param_1 + 0x3c) + iVar5);
      break;
    case 1:
      *(undefined1 *)(param_1 + 0x15) = 0;
      if (*(int *)(param_1 + 0x30) - iVar5 < 4) {
        FUN_00539fb0(4);
      }
      iVar10 = *(int *)(param_1 + 0x2c);
      iVar5 = *(int *)(param_1 + 0x3c) + iVar10;
      uVar8 = CONCAT11(*(undefined1 *)(iVar5 + 3),
                       *(undefined1 *)(*(int *)(param_1 + 0x3c) + 2 + iVar10));
      uVar2 = CONCAT21(uVar8,*(undefined1 *)(iVar5 + 1));
      *(int *)(param_1 + 0x2c) = iVar10 + 4;
      if (0xf < uVar8) {
        uVar8 = 0xf;
      }
      local_b = (byte)(uVar2 >> 4) & 0xf | (char)uVar8 << 4;
      *(undefined1 *)(param_1 + 0x15) = 0;
      if (*(int *)(param_1 + 0x30) - (iVar10 + 4) < 4) {
        FUN_00539fb0(4);
      }
      iVar5 = *(int *)(param_1 + 0x2c);
      iVar10 = *(int *)(param_1 + 0x3c);
      uVar8 = CONCAT11(*(undefined1 *)(iVar10 + 3 + iVar5),*(undefined1 *)(iVar10 + 2 + iVar5));
      uVar2 = CONCAT21(uVar8,*(undefined1 *)(iVar10 + iVar5 + 1));
      *(int *)(param_1 + 0x2c) = iVar5 + 4;
      if (0xf < uVar8) {
        uVar8 = 0xf;
      }
      local_a = (byte)(uVar2 >> 4) & 0xf | (char)uVar8 << 4;
      *(undefined1 *)(param_1 + 0x15) = 0;
      if (*(int *)(param_1 + 0x30) - (iVar5 + 4) < 1) {
        FUN_0053a0a0();
      }
      bVar7 = *(byte *)(*(int *)(param_1 + 0x2c) + *(int *)(param_1 + 0x3c));
      *(int *)(param_1 + 0x2c) = *(int *)(param_1 + 0x2c) + 1;
      local_c = local_c | -(8 < (bVar7 & 0xf8)) & 0x80U;
      goto LAB_0059d65a;
    case 2:
      FUN_0053b150(&local_4);
      *(undefined1 *)(param_1 + 0x15) = 0;
      if (*(int *)(param_1 + 0x30) - *(int *)(param_1 + 0x2c) < 4) {
        FUN_00539fb0(4);
      }
      iVar10 = *(int *)(param_1 + 0x2c);
      iVar5 = *(int *)(param_1 + 0x3c) + iVar10;
      uVar8 = CONCAT11(*(undefined1 *)(iVar5 + 3),
                       *(undefined1 *)(*(int *)(param_1 + 0x3c) + 2 + iVar10));
      uVar2 = CONCAT21(uVar8,*(undefined1 *)(iVar5 + 1));
      *(int *)(param_1 + 0x2c) = iVar10 + 4;
      if (0xf < uVar8) {
        uVar8 = 0xf;
      }
      local_b = (byte)(uVar2 >> 4) & 0xf | (char)uVar8 << 4;
      *(undefined1 *)(param_1 + 0x15) = 0;
      if (*(int *)(param_1 + 0x30) - (iVar10 + 4) < 4) {
        FUN_00539fb0(4);
      }
      iVar5 = *(int *)(param_1 + 0x2c);
      iVar10 = *(int *)(param_1 + 0x3c);
      uVar8 = CONCAT11(*(undefined1 *)(iVar10 + 3 + iVar5),*(undefined1 *)(iVar10 + 2 + iVar5));
      uVar2 = CONCAT21(uVar8,*(undefined1 *)(iVar10 + iVar5 + 1));
      *(int *)(param_1 + 0x2c) = iVar5 + 4;
      if (0xf < uVar8) {
        uVar8 = 0xf;
      }
      local_a = (byte)(uVar2 >> 4) & 0xf | (char)uVar8 << 4;
      *(undefined1 *)(param_1 + 0x15) = 0;
      if (*(int *)(param_1 + 0x30) - (iVar5 + 4) < 2) {
        FUN_00539fb0(2);
      }
      iVar5 = *(int *)(param_1 + 0x2c);
      puVar9 = (ushort *)(*(int *)(param_1 + 0x3c) + iVar5);
      break;
    case 3:
      iVar10 = 0x1b;
      goto LAB_0059d927;
    case 4:
      *(undefined1 *)(param_1 + 0x15) = 0;
      if (*(int *)(param_1 + 0x30) - iVar5 < 1) {
        FUN_0053a0a0();
      }
      iVar5 = *(int *)(param_1 + 0x2c);
      bVar7 = *(byte *)(iVar5 + *(int *)(param_1 + 0x3c));
      goto LAB_0059d918;
    case 5:
      *(undefined1 *)(param_1 + 0x15) = 0;
      if (*(int *)(param_1 + 0x30) - iVar5 < 1) {
        FUN_0053a0a0();
      }
      bVar7 = *(byte *)(*(int *)(param_1 + 0x2c) + *(int *)(param_1 + 0x3c));
      iVar5 = *(int *)(param_1 + 0x2c) + 1;
      *(int *)(param_1 + 0x2c) = iVar5;
      *(undefined1 *)(param_1 + 0x15) = 0;
      if (*(int *)(param_1 + 0x30) - iVar5 < 1) {
        FUN_0053a0a0();
      }
      iVar5 = *(int *)(param_1 + 0x2c);
      iVar10 = (uint)*(byte *)(iVar5 + *(int *)(param_1 + 0x3c)) * (uint)bVar7 * 4 + 0xd;
      goto LAB_0059d920;
    case 6:
      iVar10 = 0x50;
LAB_0059d927:
      do {
        iVar10 = iVar10 + -1;
        *(undefined1 *)(param_1 + 0x15) = 0;
        if (*(int *)(param_1 + 0x30) - iVar5 < 1) {
          FUN_0053a0a0();
        }
        *(int *)(param_1 + 0x2c) = *(int *)(param_1 + 0x2c) + 1;
        iVar5 = *(int *)(param_1 + 0x2c);
joined_r0x0059d925:
      } while (iVar10 != 0);
switchD_0059d403_default:
      if (!bVar3) {
LAB_0059d94c:
        if (local_14 == param_3) {
          bVar3 = true;
        }
      }
      goto joined_r0x0059d39d;
    case 7:
      *(undefined1 *)(param_1 + 0x15) = 0;
      if (*(int *)(param_1 + 0x30) - iVar5 < 1) {
        FUN_0053a0a0();
      }
      iVar5 = *(int *)(param_1 + 0x2c);
      bVar7 = *(byte *)(iVar5 + *(int *)(param_1 + 0x3c));
LAB_0059d918:
      iVar10 = (uint)bVar7 * 5 + 0x13;
LAB_0059d920:
      iVar5 = iVar5 + 1;
      *(int *)(param_1 + 0x2c) = iVar5;
      goto joined_r0x0059d925;
    default:
      goto switchD_0059d403_default;
    }
    uVar8 = *puVar9;
    cVar4 = (char)(uVar8 >> 8);
    *(int *)(param_1 + 0x2c) = iVar5 + 2;
    if (0xf < uVar8 >> 8) {
      cVar4 = '\x0f';
    }
    local_9 = (byte)uVar8 >> 4 | cVar4 << 4;
    *(undefined1 *)(param_1 + 0x15) = 0;
    if (*(int *)(param_1 + 0x30) - (iVar5 + 2) < 1) {
      FUN_0053a0a0();
    }
    bVar7 = *(byte *)(*(int *)(param_1 + 0x2c) + *(int *)(param_1 + 0x3c));
    *(int *)(param_1 + 0x2c) = *(int *)(param_1 + 0x2c) + 1;
    bVar6 = 0;
    if ((bVar7 & 0x40) != 0) {
      bVar6 = 0x20;
    }
    if ((bVar7 & 0x20) == 0) {
      bVar6 = bVar6 | 0x40;
    }
    if (1 < (bVar7 & 0xf)) {
      bVar6 = bVar6 | 0x80;
    }
    local_c = local_c | bVar6;
LAB_0059d65a:
    if (!bVar3) {
      if ((param_2 != 0) && (local_14 < 4)) {
        local_14 = local_14 + 1;
        FUN_0059d2a0(&local_c);
      }
      goto LAB_0059d94c;
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
0059d360 : SUB ESP,0x18
0059d363 : PUSH EBX
0059d364 : PUSH ESI
0059d365 : MOV ESI,dword ptr [ESP + 0x24]
0059d369 : MOV EAX,dword ptr [ESI + 0x30]
0059d36c : SUB EAX,dword ptr [ESI + 0x2c]
0059d36f : XOR EBX,EBX
0059d371 : CMP EAX,0x1
0059d374 : MOV byte ptr [ESI + 0x15],BL
0059d377 : JGE 0x0059d380
0059d379 : MOV ECX,ESI
0059d37b : CALL 0x0053a0a0
0059d380 : MOV EAX,dword ptr [ESI + 0x2c]
0059d383 : MOV ECX,dword ptr [ESI + 0x3c]
0059d386 : MOV CL,byte ptr [EAX + ECX*0x1]
0059d389 : INC EAX
0059d38a : MOV dword ptr [ESI + 0x2c],EAX
0059d38d : XOR EAX,EAX
0059d38f : MOV byte ptr [ESP + 0xb],CL
0059d393 : MOV dword ptr [ESP + 0xc],EAX
0059d397 : MOV byte ptr [ESP + 0x24],BL
0059d39b : CMP CL,BL
0059d39d : JZ 0x0059d96b
0059d3a3 : PUSH EBP
0059d3a4 : MOV EBP,dword ptr [ESP + 0x2c]
0059d3a8 : PUSH EDI
0059d3a9 : LEA ESP,[ESP]
0059d3b0 : MOV EDX,dword ptr [ESI + 0x30]
0059d3b3 : SUB EDX,dword ptr [ESI + 0x2c]
0059d3b6 : DEC byte ptr [ESP + 0x13]
0059d3ba : CMP EDX,0x1
0059d3bd : MOV byte ptr [ESI + 0x15],BL
0059d3c0 : JGE 0x0059d3c9
0059d3c2 : MOV ECX,ESI
0059d3c4 : CALL 0x0053a0a0
0059d3c9 : MOV EAX,dword ptr [ESI + 0x2c]
0059d3cc : MOV ECX,dword ptr [ESI + 0x3c]
0059d3cf : MOV CL,byte ptr [EAX + ECX*0x1]
0059d3d2 : MOVZX ECX,CL
0059d3d5 : XOR EDX,EDX
0059d3d7 : INC EAX
0059d3d8 : MOV dword ptr [ESI + 0x2c],EAX
0059d3db : MOV byte ptr [ESP + 0x1e],BL
0059d3df : MOV byte ptr [ESP + 0x1d],BL
0059d3e3 : MOV byte ptr [ESP + 0x1f],0x10
0059d3e8 : MOV word ptr [ESP + 0x20],DX
0059d3ed : MOV word ptr [ESP + 0x22],DX
0059d3f2 : MOV dword ptr [ESP + 0x24],EBX
0059d3f6 : MOV byte ptr [ESP + 0x1c],CL
0059d3fa : CMP ECX,0x7
0059d3fd : JA 0x0059d946
0059d403 : JMP dword ptr [ECX*0x4 + 0x59d974]
0059d40a : LEA EAX,[ESP + 0x24]
0059d40e : PUSH EAX
0059d40f : MOV ECX,ESI
0059d411 : CALL 0x0053b150
0059d416 : MOV ECX,dword ptr [ESI + 0x30]
0059d419 : SUB ECX,dword ptr [ESI + 0x2c]
0059d41c : MOV byte ptr [ESI + 0x15],BL
0059d41f : CMP ECX,0x4
0059d422 : JGE 0x0059d42d
0059d424 : PUSH 0x4
0059d426 : MOV ECX,ESI
0059d428 : CALL 0x00539fb0
0059d42d : MOV EDX,dword ptr [ESI + 0x2c]
0059d430 : MOV EAX,dword ptr [ESI + 0x3c]
0059d433 : MOVZX EDI,byte ptr [EAX + EDX*0x1 + 0x2]
0059d438 : LEA ECX,[EAX + EDX*0x1]
0059d43b : MOVZX EAX,byte ptr [ECX + 0x3]
0059d43f : SHL EAX,0x8
0059d442 : OR EAX,EDI
0059d444 : MOVZX EDI,byte ptr [ECX + 0x1]
0059d448 : MOVZX ECX,byte ptr [ECX]
0059d44b : SHL EAX,0x8
0059d44e : OR EAX,EDI
0059d450 : SHL EAX,0x8
0059d453 : OR EAX,ECX
0059d455 : MOV ECX,EAX
0059d457 : ADD EDX,0x4
0059d45a : SHR ECX,0x10
0059d45d : MOV dword ptr [ESI + 0x2c],EDX
0059d460 : CMP ECX,0xf
0059d463 : JBE 0x0059d46a
0059d465 : MOV ECX,0xf
0059d46a : SHR EAX,0xc
0059d46d : AND AL,0xf
0059d46f : SHL CL,0x4
0059d472 : OR AL,CL
0059d474 : MOV byte ptr [ESP + 0x1d],AL
0059d478 : MOV EAX,dword ptr [ESI + 0x30]
0059d47b : SUB EAX,EDX
0059d47d : CMP EAX,0x4
0059d480 : MOV byte ptr [ESI + 0x15],BL
0059d483 : JGE 0x0059d48e
0059d485 : PUSH 0x4
0059d487 : MOV ECX,ESI
0059d489 : CALL 0x00539fb0
0059d48e : MOV EDX,dword ptr [ESI + 0x2c]
0059d491 : MOV ECX,dword ptr [ESI + 0x3c]
0059d494 : MOVZX EAX,byte ptr [ECX + EDX*0x1 + 0x3]
0059d499 : MOVZX EDI,byte ptr [ECX + EDX*0x1 + 0x2]
0059d49e : ADD ECX,EDX
0059d4a0 : SHL EAX,0x8
0059d4a3 : OR EAX,EDI
0059d4a5 : MOVZX EDI,byte ptr [ECX + 0x1]
0059d4a9 : MOVZX ECX,byte ptr [ECX]
0059d4ac : SHL EAX,0x8
0059d4af : OR EAX,EDI
0059d4b1 : SHL EAX,0x8
0059d4b4 : OR EAX,ECX
0059d4b6 : MOV ECX,EAX
0059d4b8 : ADD EDX,0x4
0059d4bb : SHR ECX,0x10
0059d4be : MOV dword ptr [ESI + 0x2c],EDX
0059d4c1 : CMP ECX,0xf
0059d4c4 : JBE 0x0059d4cb
0059d4c6 : MOV ECX,0xf
0059d4cb : SHR EAX,0xc
0059d4ce : AND AL,0xf
0059d4d0 : SHL CL,0x4
0059d4d3 : OR AL,CL
0059d4d5 : MOV byte ptr [ESP + 0x1e],AL
0059d4d9 : MOV EAX,dword ptr [ESI + 0x30]
0059d4dc : SUB EAX,EDX
0059d4de : CMP EAX,0x4
0059d4e1 : MOV byte ptr [ESI + 0x15],BL
0059d4e4 : JGE 0x0059d4ef
0059d4e6 : PUSH 0x4
0059d4e8 : MOV ECX,ESI
0059d4ea : CALL 0x00539fb0
0059d4ef : MOV ECX,dword ptr [ESI + 0x2c]
0059d4f2 : MOV EDX,dword ptr [ESI + 0x3c]
0059d4f5 : MOVZX EDI,byte ptr [EDX + ECX*0x1 + 0x2]
0059d4fa : LEA EAX,[EDX + ECX*0x1]
0059d4fd : MOVZX EDX,byte ptr [EAX + 0x3]
0059d501 : SHL EDX,0x8
0059d504 : OR EDX,EDI
0059d506 : MOVZX EDI,byte ptr [EAX + 0x1]
0059d50a : MOVZX EAX,byte ptr [EAX]
0059d50d : SHL EDX,0x8
0059d510 : OR EDX,EDI
0059d512 : SHL EDX,0x8
0059d515 : OR EDX,EAX
0059d517 : MOV dword ptr [ESP + 0x18],EDX
0059d51b : LEA EDI,[ECX + 0x4]
0059d51e : MOV dword ptr [ESI + 0x2c],EDI
0059d521 : FILD dword ptr [ESP + 0x18]
0059d525 : FMUL double ptr [0x00b8b888]
0059d52b : FSTP float ptr [ESP + 0x18]
0059d52f : FLD float ptr [ESP + 0x18]
0059d533 : FMUL double ptr [0x00b86b30]
0059d539 : FDIV double ptr [0x00b86b38]
0059d53f : FSTP float ptr [ESP + 0x18]
0059d543 : FLD float ptr [ESP + 0x18]
0059d547 : FLD double ptr [0x00b8edd0]
0059d54d : CALL 0x0063b56a
0059d552 : CALL 0x0063b380
0059d557 : MOV ECX,dword ptr [ESI + 0x30]
0059d55a : SUB ECX,EDI
0059d55c : CMP ECX,0x4
0059d55f : MOV word ptr [ESP + 0x20],AX
0059d564 : MOV byte ptr [ESI + 0x15],BL
0059d567 : JGE 0x0059d572
0059d569 : PUSH 0x4
0059d56b : MOV ECX,ESI
0059d56d : CALL 0x00539fb0
0059d572 : MOV ECX,dword ptr [ESI + 0x2c]
0059d575 : MOV EDX,dword ptr [ESI + 0x3c]
0059d578 : MOVZX EDI,byte ptr [EDX + ECX*0x1 + 0x2]
0059d57d : LEA EAX,[EDX + ECX*0x1]
0059d580 : MOVZX EDX,byte ptr [EAX + 0x3]
0059d584 : SHL EDX,0x8
0059d587 : OR EDX,EDI
0059d589 : MOVZX EDI,byte ptr [EAX + 0x1]
0059d58d : MOVZX EAX,byte ptr [EAX]
0059d590 : SHL EDX,0x8
0059d593 : OR EDX,EDI
0059d595 : SHL EDX,0x8
0059d598 : OR EDX,EAX
0059d59a : MOV dword ptr [ESP + 0x18],EDX
0059d59e : LEA EDI,[ECX + 0x4]
0059d5a1 : MOV dword ptr [ESI + 0x2c],EDI
0059d5a4 : FILD dword ptr [ESP + 0x18]
0059d5a8 : FMUL double ptr [0x00b8b888]
0059d5ae : FSTP float ptr [ESP + 0x18]
0059d5b2 : FLD float ptr [ESP + 0x18]
0059d5b6 : FMUL double ptr [0x00b86058]
0059d5bc : CALL 0x0063b380
0059d5c1 : MOV ECX,dword ptr [ESI + 0x30]
0059d5c4 : SUB ECX,EDI
0059d5c6 : CMP ECX,0x2
0059d5c9 : MOV word ptr [ESP + 0x22],AX
0059d5ce : MOV byte ptr [ESI + 0x15],BL
0059d5d1 : JGE 0x0059d5dc
0059d5d3 : PUSH 0x2
0059d5d5 : MOV ECX,ESI
0059d5d7 : CALL 0x00539fb0
0059d5dc : MOV EAX,dword ptr [ESI + 0x2c]
0059d5df : MOV EDX,dword ptr [ESI + 0x3c]
0059d5e2 : LEA ECX,[EDX + EAX*0x1]
0059d5e5 : MOVZX DX,byte ptr [ECX + 0x1]
0059d5ea : MOVZX CX,byte ptr [ECX]
0059d5ee : SHL DX,0x8
0059d5f2 : OR DX,CX
0059d5f5 : MOVZX ECX,DX
0059d5f8 : LEA EDX,[EAX + 0x2]
0059d5fb : MOVZX EAX,CX
0059d5fe : SHR EAX,0x8
0059d601 : MOV dword ptr [ESI + 0x2c],EDX
0059d604 : CMP EAX,0xf
0059d607 : JBE 0x0059d60e
0059d609 : MOV EAX,0xf
0059d60e : SHR CL,0x4
0059d611 : SHL AL,0x4
0059d614 : AND CL,0xf
0059d617 : OR CL,AL
0059d619 : MOV EAX,dword ptr [ESI + 0x30]
0059d61c : SUB EAX,EDX
0059d61e : CMP EAX,0x1
0059d621 : MOV byte ptr [ESI + 0x15],BL
0059d624 : MOV byte ptr [ESP + 0x1f],CL
0059d628 : JGE 0x0059d631
0059d62a : MOV ECX,ESI
0059d62c : CALL 0x0053a0a0
0059d631 : MOV ECX,dword ptr [ESI + 0x2c]
0059d634 : MOV EDX,dword ptr [ESI + 0x3c]
0059d637 : MOV AL,byte ptr [ECX + EDX*0x1]
0059d63a : INC ECX
0059d63b : MOV dword ptr [ESI + 0x2c],ECX
0059d63e : XOR CL,CL
0059d640 : TEST AL,0x40
0059d642 : JZ 0x0059d646
0059d644 : MOV CL,0x20
0059d646 : TEST AL,0x20
0059d648 : JNZ 0x0059d64d
0059d64a : OR CL,0x40
0059d64d : AND AL,0xf
0059d64f : CMP AL,0x1
0059d651 : JBE 0x0059d656
0059d653 : OR CL,0x80
0059d656 : OR byte ptr [ESP + 0x1c],CL
0059d65a : CMP byte ptr [ESP + 0x2c],BL
0059d65e : JNZ 0x0059d95b
0059d664 : CMP dword ptr [ESP + 0x30],EBX
0059d668 : JZ 0x0059d94c
0059d66e : CMP dword ptr [ESP + 0x14],0x4
0059d673 : JNC 0x0059d94c
0059d679 : INC dword ptr [ESP + 0x14]
0059d67d : LEA EAX,[ESP + 0x1c]
0059d681 : MOV ECX,EBP
0059d683 : PUSH EAX
0059d684 : ADD EBP,0xc
0059d687 : CALL 0x0059d2a0
0059d68c : JMP 0x0059d94c
0059d691 : MOV ECX,dword ptr [ESI + 0x30]
0059d694 : SUB ECX,EAX
0059d696 : CMP ECX,0x4
0059d699 : MOV byte ptr [ESI + 0x15],BL
0059d69c : JGE 0x0059d6a7
0059d69e : PUSH 0x4
0059d6a0 : MOV ECX,ESI
0059d6a2 : CALL 0x00539fb0
0059d6a7 : MOV EDX,dword ptr [ESI + 0x2c]
0059d6aa : MOV EAX,dword ptr [ESI + 0x3c]
0059d6ad : MOVZX EDI,byte ptr [EAX + EDX*0x1 + 0x2]
0059d6b2 : LEA ECX,[EAX + EDX*0x1]
0059d6b5 : MOVZX EAX,byte ptr [ECX + 0x3]
0059d6b9 : SHL EAX,0x8
0059d6bc : OR EAX,EDI
0059d6be : MOVZX EDI,byte ptr [ECX + 0x1]
0059d6c2 : MOVZX ECX,byte ptr [ECX]
0059d6c5 : SHL EAX,0x8
0059d6c8 : OR EAX,EDI
0059d6ca : SHL EAX,0x8
0059d6cd : OR EAX,ECX
0059d6cf : MOV ECX,EAX
0059d6d1 : ADD EDX,0x4
0059d6d4 : SHR ECX,0x10
0059d6d7 : MOV dword ptr [ESI + 0x2c],EDX
0059d6da : CMP ECX,0xf
0059d6dd : JBE 0x0059d6e4
0059d6df : MOV ECX,0xf
0059d6e4 : SHR EAX,0xc
0059d6e7 : AND AL,0xf
0059d6e9 : SHL CL,0x4
0059d6ec : OR AL,CL
0059d6ee : MOV byte ptr [ESP + 0x1d],AL
0059d6f2 : MOV EAX,dword ptr [ESI + 0x30]
0059d6f5 : SUB EAX,EDX
0059d6f7 : CMP EAX,0x4
0059d6fa : MOV byte ptr [ESI + 0x15],BL
0059d6fd : JGE 0x0059d708
0059d6ff : PUSH 0x4
0059d701 : MOV ECX,ESI
0059d703 : CALL 0x00539fb0
0059d708 : MOV EDX,dword ptr [ESI + 0x2c]
0059d70b : MOV ECX,dword ptr [ESI + 0x3c]
0059d70e : MOVZX EAX,byte ptr [ECX + EDX*0x1 + 0x3]
0059d713 : MOVZX EDI,byte ptr [ECX + EDX*0x1 + 0x2]
0059d718 : ADD ECX,EDX
0059d71a : SHL EAX,0x8
0059d71d : OR EAX,EDI
0059d71f : MOVZX EDI,byte ptr [ECX + 0x1]
0059d723 : MOVZX ECX,byte ptr [ECX]
0059d726 : SHL EAX,0x8
0059d729 : OR EAX,EDI
0059d72b : SHL EAX,0x8
0059d72e : OR EAX,ECX
0059d730 : MOV ECX,EAX
0059d732 : ADD EDX,0x4
0059d735 : SHR ECX,0x10
0059d738 : MOV dword ptr [ESI + 0x2c],EDX
0059d73b : CMP ECX,0xf
0059d73e : JBE 0x0059d745
0059d740 : MOV ECX,0xf
0059d745 : SHR EAX,0xc
0059d748 : AND AL,0xf
0059d74a : SHL CL,0x4
0059d74d : OR AL,CL
0059d74f : MOV byte ptr [ESP + 0x1e],AL
0059d753 : MOV EAX,dword ptr [ESI + 0x30]
0059d756 : SUB EAX,EDX
0059d758 : CMP EAX,0x1
0059d75b : MOV byte ptr [ESI + 0x15],BL
0059d75e : JGE 0x0059d767
0059d760 : MOV ECX,ESI
0059d762 : CALL 0x0053a0a0
0059d767 : MOV ECX,dword ptr [ESI + 0x2c]
0059d76a : MOV EDX,dword ptr [ESI + 0x3c]
0059d76d : MOV AL,byte ptr [ECX + EDX*0x1]
0059d770 : INC ECX
0059d771 : MOV dword ptr [ESI + 0x2c],ECX
0059d774 : AND AL,0xf8
0059d776 : MOV CL,0x8
0059d778 : CMP CL,AL
0059d77a : SBB DL,DL
0059d77c : AND DL,0x80
0059d77f : OR byte ptr [ESP + 0x1c],DL
0059d783 : JMP 0x0059d65a
0059d788 : LEA ECX,[ESP + 0x24]
0059d78c : PUSH ECX
0059d78d : MOV ECX,ESI
0059d78f : CALL 0x0053b150
0059d794 : MOV EDX,dword ptr [ESI + 0x30]
0059d797 : SUB EDX,dword ptr [ESI + 0x2c]
0059d79a : MOV byte ptr [ESI + 0x15],BL
0059d79d : CMP EDX,0x4
0059d7a0 : JGE 0x0059d7ab
0059d7a2 : PUSH 0x4
0059d7a4 : MOV ECX,ESI
0059d7a6 : CALL 0x00539fb0
0059d7ab : MOV EDX,dword ptr [ESI + 0x2c]
0059d7ae : MOV EAX,dword ptr [ESI + 0x3c]
0059d7b1 : MOVZX EDI,byte ptr [EAX + EDX*0x1 + 0x2]
0059d7b6 : LEA ECX,[EAX + EDX*0x1]
0059d7b9 : MOVZX EAX,byte ptr [ECX + 0x3]
0059d7bd : SHL EAX,0x8
0059d7c0 : OR EAX,EDI
0059d7c2 : MOVZX EDI,byte ptr [ECX + 0x1]
0059d7c6 : MOVZX ECX,byte ptr [ECX]
0059d7c9 : SHL EAX,0x8
0059d7cc : OR EAX,EDI
0059d7ce : SHL EAX,0x8
0059d7d1 : OR EAX,ECX
0059d7d3 : MOV ECX,EAX
0059d7d5 : ADD EDX,0x4
0059d7d8 : SHR ECX,0x10
0059d7db : MOV dword ptr [ESI + 0x2c],EDX
0059d7de : CMP ECX,0xf
0059d7e1 : JBE 0x0059d7e8
0059d7e3 : MOV ECX,0xf
0059d7e8 : SHR EAX,0xc
0059d7eb : AND AL,0xf
0059d7ed : SHL CL,0x4
0059d7f0 : OR AL,CL
0059d7f2 : MOV byte ptr [ESP + 0x1d],AL
0059d7f6 : MOV EAX,dword ptr [ESI + 0x30]
0059d7f9 : SUB EAX,EDX
0059d7fb : CMP EAX,0x4
0059d7fe : MOV byte ptr [ESI + 0x15],BL
0059d801 : JGE 0x0059d80c
0059d803 : PUSH 0x4
0059d805 : MOV ECX,ESI
0059d807 : CALL 0x00539fb0
0059d80c : MOV EDX,dword ptr [ESI + 0x2c]
0059d80f : MOV ECX,dword ptr [ESI + 0x3c]
0059d812 : MOVZX EAX,byte ptr [ECX + EDX*0x1 + 0x3]
0059d817 : MOVZX EDI,byte ptr [ECX + EDX*0x1 + 0x2]
0059d81c : ADD ECX,EDX
0059d81e : SHL EAX,0x8
0059d821 : OR EAX,EDI
0059d823 : MOVZX EDI,byte ptr [ECX + 0x1]
0059d827 : MOVZX ECX,byte ptr [ECX]
0059d82a : SHL EAX,0x8
0059d82d : OR EAX,EDI
0059d82f : SHL EAX,0x8
0059d832 : OR EAX,ECX
0059d834 : MOV ECX,EAX
0059d836 : ADD EDX,0x4
0059d839 : SHR ECX,0x10
0059d83c : MOV dword ptr [ESI + 0x2c],EDX
0059d83f : CMP ECX,0xf
0059d842 : JBE 0x0059d849
0059d844 : MOV ECX,0xf
0059d849 : SHR EAX,0xc
0059d84c : AND AL,0xf
0059d84e : SHL CL,0x4
0059d851 : OR AL,CL
0059d853 : MOV byte ptr [ESP + 0x1e],AL
0059d857 : MOV EAX,dword ptr [ESI + 0x30]
0059d85a : SUB EAX,EDX
0059d85c : CMP EAX,0x2
0059d85f : MOV byte ptr [ESI + 0x15],BL
0059d862 : JGE 0x0059d86d
0059d864 : PUSH 0x2
0059d866 : MOV ECX,ESI
0059d868 : CALL 0x00539fb0
0059d86d : MOV EAX,dword ptr [ESI + 0x2c]
0059d870 : MOV ECX,dword ptr [ESI + 0x3c]
0059d873 : ADD ECX,EAX
0059d875 : JMP 0x0059d5e5
0059d87a : MOV EDI,0x1b
0059d87f : JMP 0x0059d927
0059d884 : MOV ECX,dword ptr [ESI + 0x30]
0059d887 : SUB ECX,EAX
0059d889 : CMP ECX,0x1
0059d88c : MOV byte ptr [ESI + 0x15],BL
0059d88f : JGE 0x0059d898
0059d891 : MOV ECX,ESI
0059d893 : CALL 0x0053a0a0
0059d898 : MOV EAX,dword ptr [ESI + 0x2c]
0059d89b : MOV EDX,dword ptr [ESI + 0x3c]
0059d89e : MOV CL,byte ptr [EAX + EDX*0x1]
0059d8a1 : JMP 0x0059d918
0059d8a3 : MOV ECX,dword ptr [ESI + 0x30]
0059d8a6 : SUB ECX,EAX
0059d8a8 : CMP ECX,0x1
0059d8ab : MOV byte ptr [ESI + 0x15],BL
0059d8ae : JGE 0x0059d8b7
0059d8b0 : MOV ECX,ESI
0059d8b2 : CALL 0x0053a0a0
0059d8b7 : MOV EAX,dword ptr [ESI + 0x2c]
0059d8ba : MOV EDX,dword ptr [ESI + 0x3c]
0059d8bd : MOV CL,byte ptr [EAX + EDX*0x1]
0059d8c0 : INC EAX
0059d8c1 : MOVZX EDI,CL
0059d8c4 : MOV ECX,dword ptr [ESI + 0x30]
0059d8c7 : SUB ECX,EAX
0059d8c9 : CMP ECX,0x1
0059d8cc : MOV dword ptr [ESI + 0x2c],EAX
0059d8cf : MOV byte ptr [ESI + 0x15],BL
0059d8d2 : JGE 0x0059d8db
0059d8d4 : MOV ECX,ESI
0059d8d6 : CALL 0x0053a0a0
0059d8db : MOV EAX,dword ptr [ESI + 0x2c]
0059d8de : MOV EDX,dword ptr [ESI + 0x3c]
0059d8e1 : MOV CL,byte ptr [EAX + EDX*0x1]
0059d8e4 : MOVZX ECX,CL
0059d8e7 : INC EAX
0059d8e8 : IMUL ECX,EDI
0059d8eb : LEA EDI,[ECX*0x4 + 0xd]
0059d8f2 : JMP 0x0059d920
0059d8f4 : MOV EDI,0x50
0059d8f9 : JMP 0x0059d927
0059d8fb : MOV EDX,dword ptr [ESI + 0x30]
0059d8fe : SUB EDX,EAX
0059d900 : CMP EDX,0x1
0059d903 : MOV byte ptr [ESI + 0x15],BL
0059d906 : JGE 0x0059d90f
0059d908 : MOV ECX,ESI
0059d90a : CALL 0x0053a0a0
0059d90f : MOV EAX,dword ptr [ESI + 0x2c]
0059d912 : MOV ECX,dword ptr [ESI + 0x3c]
0059d915 : MOV CL,byte ptr [EAX + ECX*0x1]
0059d918 : MOVZX ECX,CL
0059d91b : INC EAX
0059d91c : LEA EDI,[ECX + ECX*0x4 + 0x13]
0059d920 : MOV dword ptr [ESI + 0x2c],EAX
0059d923 : CMP EDI,EBX
0059d925 : JZ 0x0059d946
0059d927 : MOV EDX,dword ptr [ESI + 0x30]
0059d92a : SUB EDX,EAX
0059d92c : DEC EDI
0059d92d : CMP EDX,0x1
0059d930 : MOV byte ptr [ESI + 0x15],BL
0059d933 : JGE 0x0059d93c
0059d935 : MOV ECX,ESI
0059d937 : CALL 0x0053a0a0
0059d93c : INC dword ptr [ESI + 0x2c]
0059d93f : MOV EAX,dword ptr [ESI + 0x2c]
0059d942 : CMP EDI,EBX
0059d944 : JNZ 0x0059d927
0059d946 : CMP byte ptr [ESP + 0x2c],BL
0059d94a : JNZ 0x0059d95b
0059d94c : MOV EAX,dword ptr [ESP + 0x34]
0059d950 : CMP dword ptr [ESP + 0x14],EAX
0059d954 : JNZ 0x0059d95b
0059d956 : MOV byte ptr [ESP + 0x2c],0x1
0059d95b : CMP byte ptr [ESP + 0x13],BL
0059d95f : JNZ 0x0059d3b0
0059d965 : MOV EAX,dword ptr [ESP + 0x14]
0059d969 : POP EDI
0059d96a : POP EBP
0059d96b : POP ESI
0059d96c : POP EBX
0059d96d : ADD ESP,0x18
0059d970 : RET

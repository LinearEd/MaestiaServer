PROGRAM  : Maestia.exe
FUNCTION : FUN_00550ab0
ENTRY    : 00550ab0
BODY     : [[00550ab0, 00550c2c] [00550c30, 00550d49]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00550ab0(int *param_1,int *param_2,undefined1 *param_3)

{
  int iVar1;
  bool bVar2;
  undefined1 *puVar3;
  int *piVar4;
  int iVar5;
  undefined4 uVar6;
  int in_ECX;
  int iVar7;
  
  piVar4 = param_2;
  iVar7 = in_ECX + -0x10;
  bVar2 = false;
  puVar3 = param_3;
  if (*(byte *)(param_1 + 1) < 7) {
    if (*(int *)(*param_2 + 4) == 0) {
      FUN_00525a80();
    }
    param_2 = piVar4;
    if (*(int *)(*piVar4 + 4) == 0) {
      FUN_00525a80();
    }
    puVar3 = param_3;
    if (iVar7 != 0) {
      do {
        if (*(int *)(*(int *)(*param_1 + 0x134) + 4) == *(int *)(*piVar4 + 4)) {
          if (*(int *)(iVar7 + 0x14) != 0) {
            FUN_005271c0(*(int *)(iVar7 + 0x14));
            return 1;
          }
LAB_00550cd0:
          FUN_00526400();
          *puVar3 = 0;
          return 1;
        }
        if (*(int *)(*(int *)(*param_1 + 0x144) + 4) == *(int *)(*piVar4 + 4)) {
          if (*(int *)(iVar7 + 0x1c) != 0) {
            FUN_00526cd0(iVar7 + 0x1c);
            return 1;
          }
          goto LAB_00550cd0;
        }
        if ((((*(int *)(iVar7 + 0x18) != 0) &&
             (iVar5 = FUN_0054f490(&param_2,*(uint *)(*(int *)(iVar7 + 0x18) + 4) &
                                            *(uint *)(*piVar4 + 0xc)), -1 < iVar5)) &&
            (iVar1 = *(int *)(iVar7 + 0x18), iVar1 != 0)) && (iVar5 <= *(int *)(iVar1 + 4))) {
          if ((*(char *)(iVar1 + 0x10 + iVar5 * 0x18) == '\n') && (iVar7 != in_ECX + -0x10)) {
            uVar6 = (**(code **)(*(int *)(iVar7 + 0x10) + 0x2c))(param_1,piVar4,puVar3);
            return uVar6;
          }
          FUN_005268b0(iVar1 + 0x10 + iVar5 * 0x18);
          return 1;
        }
        if ((!bVar2) && (*(int *)(iVar7 + 0x1c) != 0)) {
          FUN_00526d30(iVar7 + 0x1c);
          bVar2 = true;
        }
        iVar7 = *(int *)(iVar7 + 0x14);
        if (iVar7 == 0) {
          return 0;
        }
      } while( true );
    }
  }
  else {
    for (; iVar7 != 0; iVar7 = *(int *)(iVar7 + 0x14)) {
      iVar5 = *piVar4;
      param_3 = puVar3;
      if (iVar5 == *(int *)(*param_1 + 0x134)) {
        if (*(int *)(iVar7 + 0x14) != 0) {
          FUN_005271c0(*(int *)(iVar7 + 0x14));
          return 1;
        }
LAB_00550b71:
        FUN_00526400();
        *puVar3 = 0;
        return 1;
      }
      if (iVar5 == *(int *)(*param_1 + 0x144)) {
        if (*(int *)(iVar7 + 0x1c) != 0) {
          FUN_00526cd0(iVar7 + 0x1c);
          return 1;
        }
        goto LAB_00550b71;
      }
      iVar1 = *(int *)(iVar7 + 0x18);
      if (((iVar1 != 0) &&
          (iVar5 = FUN_0054f3b0(piVar4,*(uint *)(iVar5 + 0xc) & *(uint *)(iVar1 + 4)), -1 < iVar5))
         && (iVar5 <= *(int *)(iVar1 + 4))) {
        if ((*(char *)(iVar1 + 0x10 + iVar5 * 0x18) == '\n') && (iVar7 != in_ECX + -0x10)) {
          uVar6 = (**(code **)(*(int *)(iVar7 + 0x10) + 0x2c))(param_1,piVar4,param_3);
          return uVar6;
        }
        FUN_005268b0(iVar1 + 0x10 + iVar5 * 0x18);
        return 1;
      }
      if ((!bVar2) && (*(int *)(iVar7 + 0x1c) != 0)) {
        FUN_00526d30(iVar7 + 0x1c);
        bVar2 = true;
      }
      puVar3 = param_3;
    }
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00550ab0 : SUB ESP,0x8
00550ab3 : MOV EAX,dword ptr [ESP + 0xc]
00550ab7 : CMP byte ptr [EAX + 0x4],0x6
00550abb : PUSH EBX
00550abc : PUSH EBP
00550abd : PUSH ESI
00550abe : PUSH EDI
00550abf : MOV dword ptr [ESP + 0x14],ECX
00550ac3 : LEA EDI,[ECX + -0x10]
00550ac6 : MOV byte ptr [ESP + 0x13],0x0
00550acb : JBE 0x00550bfb
00550ad1 : TEST EDI,EDI
00550ad3 : JZ 0x00550b48
00550ad5 : MOV EBX,dword ptr [ESP + 0x20]
00550ad9 : LEA ESP,[ESP]
00550ae0 : MOV ECX,dword ptr [ESP + 0x1c]
00550ae4 : MOV ECX,dword ptr [ECX]
00550ae6 : MOV EAX,dword ptr [EBX]
00550ae8 : CMP EAX,dword ptr [ECX + 0x134]
00550aee : JZ 0x00550b54
00550af0 : CMP EAX,dword ptr [ECX + 0x144]
00550af6 : JZ 0x00550b8b
00550afc : MOV ESI,dword ptr [EDI + 0x18]
00550aff : LEA EBP,[EDI + 0x18]
00550b02 : TEST ESI,ESI
00550b04 : JZ 0x00550b22
00550b06 : MOV EDX,dword ptr [EAX + 0xc]
00550b09 : AND EDX,dword ptr [ESI + 0x4]
00550b0c : MOV ECX,EBP
00550b0e : PUSH EDX
00550b0f : PUSH EBX
00550b10 : CALL 0x0054f3b0
00550b15 : TEST EAX,EAX
00550b17 : JL 0x00550b22
00550b19 : CMP EAX,dword ptr [ESI + 0x4]
00550b1c : JLE 0x00550baa
00550b22 : CMP byte ptr [ESP + 0x13],0x0
00550b27 : JNZ 0x00550b41
00550b29 : CMP dword ptr [EDI + 0x1c],0x0
00550b2d : LEA EAX,[EDI + 0x1c]
00550b30 : JZ 0x00550b41
00550b32 : MOV ECX,dword ptr [ESP + 0x24]
00550b36 : PUSH EAX
00550b37 : CALL 0x00526d30
00550b3c : MOV byte ptr [ESP + 0x13],0x1
00550b41 : MOV EDI,dword ptr [EDI + 0x14]
00550b44 : TEST EDI,EDI
00550b46 : JNZ 0x00550ae0
00550b48 : POP EDI
00550b49 : POP ESI
00550b4a : POP EBP
00550b4b : XOR AL,AL
00550b4d : POP EBX
00550b4e : ADD ESP,0x8
00550b51 : RET 0xc
00550b54 : MOV EDI,dword ptr [EDI + 0x14]
00550b57 : TEST EDI,EDI
00550b59 : JZ 0x00550b71
00550b5b : MOV ECX,dword ptr [ESP + 0x24]
00550b5f : PUSH EDI
00550b60 : CALL 0x005271c0
00550b65 : POP EDI
00550b66 : POP ESI
00550b67 : POP EBP
00550b68 : MOV AL,0x1
00550b6a : POP EBX
00550b6b : ADD ESP,0x8
00550b6e : RET 0xc
00550b71 : MOV ESI,dword ptr [ESP + 0x24]
00550b75 : MOV ECX,ESI
00550b77 : CALL 0x00526400
00550b7c : POP EDI
00550b7d : MOV byte ptr [ESI],0x0
00550b80 : POP ESI
00550b81 : POP EBP
00550b82 : MOV AL,0x1
00550b84 : POP EBX
00550b85 : ADD ESP,0x8
00550b88 : RET 0xc
00550b8b : CMP dword ptr [EDI + 0x1c],0x0
00550b8f : LEA EAX,[EDI + 0x1c]
00550b92 : JZ 0x00550b71
00550b94 : MOV ECX,dword ptr [ESP + 0x24]
00550b98 : PUSH EAX
00550b99 : CALL 0x00526cd0
00550b9e : POP EDI
00550b9f : POP ESI
00550ba0 : POP EBP
00550ba1 : MOV AL,0x1
00550ba3 : POP EBX
00550ba4 : ADD ESP,0x8
00550ba7 : RET 0xc
00550baa : LEA EAX,[EAX + EAX*0x2]
00550bad : MOV ECX,ESI
00550baf : CMP byte ptr [ECX + EAX*0x8 + 0x10],0xa
00550bb4 : LEA EAX,[ECX + EAX*0x8 + 0x10]
00550bb8 : JNZ 0x00550be5
00550bba : MOV EDX,dword ptr [ESP + 0x14]
00550bbe : ADD EDX,-0x10
00550bc1 : CMP EDI,EDX
00550bc3 : JZ 0x00550be5
00550bc5 : MOV EDX,dword ptr [ESP + 0x24]
00550bc9 : MOV EAX,dword ptr [EDI + 0x10]
00550bcc : MOV EAX,dword ptr [EAX + 0x2c]
00550bcf : PUSH EDX
00550bd0 : MOV EDX,dword ptr [ESP + 0x20]
00550bd4 : LEA ECX,[EDI + 0x10]
00550bd7 : PUSH EBX
00550bd8 : PUSH EDX
00550bd9 : CALL EAX
00550bdb : POP EDI
00550bdc : POP ESI
00550bdd : POP EBP
00550bde : POP EBX
00550bdf : ADD ESP,0x8
00550be2 : RET 0xc
00550be5 : MOV ECX,dword ptr [ESP + 0x24]
00550be9 : PUSH EAX
00550bea : CALL 0x005268b0
00550bef : POP EDI
00550bf0 : POP ESI
00550bf1 : POP EBP
00550bf2 : MOV AL,0x1
00550bf4 : POP EBX
00550bf5 : ADD ESP,0x8
00550bf8 : RET 0xc
00550bfb : MOV EBP,dword ptr [ESP + 0x20]
00550bff : MOV ECX,dword ptr [EBP]
00550c02 : CMP dword ptr [ECX + 0x4],0x0
00550c06 : JNZ 0x00550c0d
00550c08 : CALL 0x00525a80
00550c0d : MOV ECX,dword ptr [EBP]
00550c10 : CMP dword ptr [ECX + 0x4],0x0
00550c14 : MOV dword ptr [ESP + 0x20],EBP
00550c18 : JNZ 0x00550c1f
00550c1a : CALL 0x00525a80
00550c1f : TEST EDI,EDI
00550c21 : JZ 0x00550b48
00550c27 : MOV EBX,dword ptr [ESP + 0x24]
00550c2b : JMP 0x00550c30
00550c30 : MOV ECX,dword ptr [ESP + 0x1c]
00550c34 : MOV EDX,dword ptr [EBP]
00550c37 : MOV EAX,dword ptr [ECX]
00550c39 : MOV ECX,dword ptr [EDX + 0x4]
00550c3c : MOV EDX,dword ptr [EAX + 0x134]
00550c42 : CMP dword ptr [EDX + 0x4],ECX
00550c45 : JZ 0x00550cb5
00550c47 : MOV EAX,dword ptr [EAX + 0x144]
00550c4d : CMP dword ptr [EAX + 0x4],ECX
00550c50 : JZ 0x00550ce4
00550c56 : MOV EAX,dword ptr [EDI + 0x18]
00550c59 : LEA ESI,[EDI + 0x18]
00550c5c : TEST EAX,EAX
00550c5e : JZ 0x00550c85
00550c60 : MOV ECX,dword ptr [EBP]
00550c63 : MOV EAX,dword ptr [EAX + 0x4]
00550c66 : AND EAX,dword ptr [ECX + 0xc]
00550c69 : LEA EDX,[ESP + 0x20]
00550c6d : PUSH EAX
00550c6e : PUSH EDX
00550c6f : MOV ECX,ESI
00550c71 : CALL 0x0054f490
00550c76 : TEST EAX,EAX
00550c78 : JL 0x00550c85
00550c7a : MOV ECX,dword ptr [ESI]
00550c7c : TEST ECX,ECX
00550c7e : JZ 0x00550c85
00550c80 : CMP EAX,dword ptr [ECX + 0x4]
00550c83 : JLE 0x00550d01
00550c85 : CMP byte ptr [ESP + 0x13],0x0
00550c8a : JNZ 0x00550ca2
00550c8c : CMP dword ptr [EDI + 0x1c],0x0
00550c90 : LEA EAX,[EDI + 0x1c]
00550c93 : JZ 0x00550ca2
00550c95 : PUSH EAX
00550c96 : MOV ECX,EBX
00550c98 : CALL 0x00526d30
00550c9d : MOV byte ptr [ESP + 0x13],0x1
00550ca2 : MOV EDI,dword ptr [EDI + 0x14]
00550ca5 : TEST EDI,EDI
00550ca7 : JNZ 0x00550c30
00550ca9 : POP EDI
00550caa : POP ESI
00550cab : POP EBP
00550cac : XOR AL,AL
00550cae : POP EBX
00550caf : ADD ESP,0x8
00550cb2 : RET 0xc
00550cb5 : MOV EDI,dword ptr [EDI + 0x14]
00550cb8 : MOV ECX,EBX
00550cba : TEST EDI,EDI
00550cbc : JZ 0x00550cd0
00550cbe : PUSH EDI
00550cbf : CALL 0x005271c0
00550cc4 : POP EDI
00550cc5 : POP ESI
00550cc6 : POP EBP
00550cc7 : MOV AL,0x1
00550cc9 : POP EBX
00550cca : ADD ESP,0x8
00550ccd : RET 0xc
00550cd0 : CALL 0x00526400
00550cd5 : POP EDI
00550cd6 : POP ESI
00550cd7 : POP EBP
00550cd8 : MOV byte ptr [EBX],0x0
00550cdb : MOV AL,0x1
00550cdd : POP EBX
00550cde : ADD ESP,0x8
00550ce1 : RET 0xc
00550ce4 : CMP dword ptr [EDI + 0x1c],0x0
00550ce8 : LEA EAX,[EDI + 0x1c]
00550ceb : MOV ECX,EBX
00550ced : JZ 0x00550cd0
00550cef : PUSH EAX
00550cf0 : CALL 0x00526cd0
00550cf5 : POP EDI
00550cf6 : POP ESI
00550cf7 : POP EBP
00550cf8 : MOV AL,0x1
00550cfa : POP EBX
00550cfb : ADD ESP,0x8
00550cfe : RET 0xc
00550d01 : LEA EAX,[EAX + EAX*0x2]
00550d04 : CMP byte ptr [ECX + EAX*0x8 + 0x10],0xa
00550d09 : LEA EAX,[ECX + EAX*0x8 + 0x10]
00550d0d : JNZ 0x00550d36
00550d0f : MOV EDX,dword ptr [ESP + 0x14]
00550d13 : ADD EDX,-0x10
00550d16 : CMP EDI,EDX
00550d18 : JZ 0x00550d36
00550d1a : MOV EAX,dword ptr [EDI + 0x10]
00550d1d : MOV EDX,dword ptr [ESP + 0x1c]
00550d21 : MOV EAX,dword ptr [EAX + 0x2c]
00550d24 : PUSH EBX
00550d25 : LEA ECX,[EDI + 0x10]
00550d28 : PUSH EBP
00550d29 : PUSH EDX
00550d2a : CALL EAX
00550d2c : POP EDI
00550d2d : POP ESI
00550d2e : POP EBP
00550d2f : POP EBX
00550d30 : ADD ESP,0x8
00550d33 : RET 0xc
00550d36 : PUSH EAX
00550d37 : MOV ECX,EBX
00550d39 : CALL 0x005268b0
00550d3e : POP EDI
00550d3f : POP ESI
00550d40 : POP EBP
00550d41 : MOV AL,0x1
00550d43 : POP EBX
00550d44 : ADD ESP,0x8
00550d47 : RET 0xc

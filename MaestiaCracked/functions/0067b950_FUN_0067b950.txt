PROGRAM  : Maestia.exe
FUNCTION : FUN_0067b950
ENTRY    : 0067b950
BODY     : [[0067b950, 0067ba73]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0067b950(void)

{
  UINT UVar1;
  HMODULE hModule;
  FARPROC pFVar2;
  FARPROC pFVar3;
  int iVar4;
  int iVar5;
  undefined1 auStack_418 [4];
  HKL local_414;
  FARPROC local_410;
  undefined4 local_40c;
  undefined1 auStack_408 [4];
  CHAR local_404 [1024];
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)auStack_418;
  local_414 = GetKeyboardLayout(0);
  UVar1 = ImmGetIMEFileNameA(local_414,local_404,0x3ff);
  if ((UVar1 != 0) && (hModule = LoadLibraryA("Version"), hModule != (HMODULE)0x0)) {
    pFVar2 = GetProcAddress(hModule,"GetFileVersionInfoSizeA");
    pFVar3 = GetProcAddress(hModule,"GetFileVersionInfoA");
    local_410 = GetProcAddress(hModule,"VerQueryValueA");
    if ((pFVar2 != (FARPROC)0x0) &&
       (((pFVar3 != (FARPROC)0x0 && (local_410 != (FARPROC)0x0)) &&
        (iVar4 = (*pFVar2)(local_404,&local_40c), iVar4 != 0)))) {
      iVar5 = FUN_0045b5a0(iVar4);
      if (((iVar5 == 0) || (iVar4 = (*pFVar3)(local_404,local_40c,iVar4,iVar5), iVar4 == 0)) ||
         (iVar4 = (*local_410)(iVar5,&DAT_00bd78c4,auStack_418,auStack_408), iVar4 == 0)) {
        FUN_00515cf0(iVar5);
      }
      else {
        FUN_00515cf0(iVar5);
      }
    }
  }
  __security_check_cookie(local_4 ^ (uint)auStack_418);
  return;
}



============================================================
DISASSEMBLY
============================================================
0067b950 : SUB ESP,0x418
0067b956 : MOV EAX,[0x00d66fa0]
0067b95b : XOR EAX,ESP
0067b95d : MOV dword ptr [ESP + 0x414],EAX
0067b964 : PUSH EBX
0067b965 : PUSH EBP
0067b966 : PUSH ESI
0067b967 : PUSH EDI
0067b968 : PUSH 0x0
0067b96a : CALL dword ptr [0x00b8551c]
0067b970 : PUSH 0x3ff
0067b975 : LEA ECX,[ESP + 0x28]
0067b979 : PUSH ECX
0067b97a : PUSH EAX
0067b97b : MOV dword ptr [ESP + 0x20],EAX
0067b97f : CALL 0x00685b66
0067b984 : TEST EAX,EAX
0067b986 : JBE 0x0067ba59
0067b98c : PUSH 0xbd7904
0067b991 : CALL dword ptr [0x00b85250]
0067b997 : MOV ESI,EAX
0067b999 : TEST ESI,ESI
0067b99b : JZ 0x0067ba59
0067b9a1 : MOV EDI,dword ptr [0x00b85160]
0067b9a7 : PUSH 0xbd78ec
0067b9ac : PUSH ESI
0067b9ad : CALL EDI
0067b9af : PUSH 0xbd78d8
0067b9b4 : PUSH ESI
0067b9b5 : MOV EBX,EAX
0067b9b7 : CALL EDI
0067b9b9 : PUSH 0xbd78c8
0067b9be : PUSH ESI
0067b9bf : MOV EBP,EAX
0067b9c1 : CALL EDI
0067b9c3 : MOV dword ptr [ESP + 0x18],EAX
0067b9c7 : TEST EBX,EBX
0067b9c9 : JZ 0x0067ba59
0067b9cf : TEST EBP,EBP
0067b9d1 : JZ 0x0067ba59
0067b9d7 : TEST EAX,EAX
0067b9d9 : JZ 0x0067ba59
0067b9db : LEA EDX,[ESP + 0x1c]
0067b9df : PUSH EDX
0067b9e0 : LEA EAX,[ESP + 0x28]
0067b9e4 : PUSH EAX
0067b9e5 : CALL EBX
0067b9e7 : MOV ESI,EAX
0067b9e9 : TEST ESI,ESI
0067b9eb : JZ 0x0067ba59
0067b9ed : PUSH ESI
0067b9ee : CALL 0x0045b5a0
0067b9f3 : MOV EDI,EAX
0067b9f5 : TEST EDI,EDI
0067b9f7 : JZ 0x0067ba53
0067b9f9 : MOV ECX,dword ptr [ESP + 0x1c]
0067b9fd : PUSH EDI
0067b9fe : PUSH ESI
0067b9ff : PUSH ECX
0067ba00 : LEA EDX,[ESP + 0x30]
0067ba04 : PUSH EDX
0067ba05 : CALL EBP
0067ba07 : TEST EAX,EAX
0067ba09 : JZ 0x0067ba53
0067ba0b : LEA EAX,[ESP + 0x20]
0067ba0f : PUSH EAX
0067ba10 : LEA ECX,[ESP + 0x14]
0067ba14 : PUSH ECX
0067ba15 : PUSH 0xbd78c4
0067ba1a : PUSH EDI
0067ba1b : CALL dword ptr [ESP + 0x28]
0067ba1f : TEST EAX,EAX
0067ba21 : JZ 0x0067ba53
0067ba23 : MOV EDX,dword ptr [ESP + 0x10]
0067ba27 : MOV ESI,dword ptr [EDX + 0x8]
0067ba2a : PUSH EDI
0067ba2b : CALL 0x00515cf0
0067ba30 : MOV ECX,dword ptr [ESP + 0x14]
0067ba34 : MOV EAX,ESI
0067ba36 : AND EAX,0xff
0067ba3b : SHL EAX,0x8
0067ba3e : AND ESI,0xffff0000
0067ba44 : OR EAX,ESI
0067ba46 : SHL EAX,0x8
0067ba49 : AND ECX,0xffff
0067ba4f : OR EAX,ECX
0067ba51 : JMP 0x0067ba5b
0067ba53 : PUSH EDI
0067ba54 : CALL 0x00515cf0
0067ba59 : XOR EAX,EAX
0067ba5b : MOV ECX,dword ptr [ESP + 0x424]
0067ba62 : POP EDI
0067ba63 : POP ESI
0067ba64 : POP EBP
0067ba65 : POP EBX
0067ba66 : XOR ECX,ESP
0067ba68 : CALL 0x00633e6b
0067ba6d : ADD ESP,0x418
0067ba73 : RET

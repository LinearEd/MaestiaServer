PROGRAM  : Maestia.exe
FUNCTION : FUN_007a67d0
ENTRY    : 007a67d0
BODY     : [[007a67d0, 007a6964]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007a67d0(int *param_1)

{
  uint *puVar1;
  uint uVar2;
  size_t _ElementSize;
  void *_DstBuf;
  undefined4 ****ppppuVar3;
  int iVar4;
  int iVar5;
  int in_ECX;
  int iVar6;
  wchar_t *_Filename;
  FILE *local_34 [2];
  undefined4 ***local_2c [4];
  uint local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3c4e0;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_14 = uVar2;
  FUN_0070c740();
  local_8 = 0;
  FUN_0070c1f0(uVar2);
  if (*(uint *)(in_ECX + 0x18) < 8) {
    _Filename = (wchar_t *)(in_ECX + 4);
  }
  else {
    _Filename = *(wchar_t **)(in_ECX + 4);
  }
  __wfopen_s(local_34,_Filename,(wchar_t *)&PTR_LAB_00c168fc);
  if (local_34[0] == (FILE *)0x0) {
    local_8 = 0xffffffff;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  else {
    _fseek(local_34[0],0,2);
    _ElementSize = _ftell(local_34[0]);
    _fseek(local_34[0],0,0);
    _DstBuf = (void *)FUN_006f0760(_ElementSize,"",0,(DAT_01725270 >> 3 & 1) == 0);
    *param_1 = (int)_DstBuf;
    _fread(_DstBuf,_ElementSize,1,local_34[0]);
    _fclose(local_34[0]);
    ppppuVar3 = (undefined4 ****)local_2c[0];
    if (local_18 < 8) {
      ppppuVar3 = local_2c;
    }
    iVar4 = FUN_00405b70(ppppuVar3);
    if (((iVar4 == 0) && (3 < local_1c)) && (local_1c == 4)) {
      iVar4 = *param_1;
      iVar5 = (int)(_ElementSize + ((int)_ElementSize >> 0x1f & 3U)) >> 2;
      iVar6 = 0;
      if (0 < iVar5) {
        do {
          puVar1 = (uint *)(iVar4 + iVar6 * 4);
          *puVar1 = *puVar1 ^ 0x93c684e7;
          iVar6 = iVar6 + 1;
        } while (iVar6 < iVar5);
      }
    }
    local_8 = 0xffffffff;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  local_8 = 0xffffffff;
  local_1c = 0;
  local_2c[0] = (undefined4 ***)((uint)local_2c[0] & 0xffff0000);
  local_18 = 7;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
007a67d0 : PUSH EBP
007a67d1 : MOV EBP,ESP
007a67d3 : PUSH -0x1
007a67d5 : PUSH 0xb3c4e0
007a67da : MOV EAX,FS:[0x0]
007a67e0 : PUSH EAX
007a67e1 : SUB ESP,0x28
007a67e4 : MOV EAX,[0x00d66fa0]
007a67e9 : XOR EAX,EBP
007a67eb : MOV dword ptr [EBP + -0x10],EAX
007a67ee : PUSH EBX
007a67ef : PUSH ESI
007a67f0 : PUSH EDI
007a67f1 : PUSH EAX
007a67f2 : LEA EAX,[EBP + -0xc]
007a67f5 : MOV FS:[0x0],EAX
007a67fb : MOV EBX,dword ptr [EBP + 0x8]
007a67fe : MOV EDI,ECX
007a6800 : PUSH EDI
007a6801 : LEA ESI,[EBP + -0x2c]
007a6804 : CALL 0x0070c740
007a6809 : ADD ESP,0x4
007a680c : XOR ESI,ESI
007a680e : MOV dword ptr [EBP + -0x4],ESI
007a6811 : LEA ECX,[EBP + -0x2c]
007a6814 : CALL 0x0070c1f0
007a6819 : CMP dword ptr [EDI + 0x18],0x8
007a681d : JC 0x007a6824
007a681f : MOV EDI,dword ptr [EDI + 0x4]
007a6822 : JMP 0x007a6827
007a6824 : ADD EDI,0x4
007a6827 : PUSH 0xc168fc
007a682c : LEA EAX,[EBP + -0x30]
007a682f : PUSH EDI
007a6830 : PUSH EAX
007a6831 : CALL 0x0063641b
007a6836 : MOV EAX,dword ptr [EBP + -0x30]
007a6839 : ADD ESP,0xc
007a683c : CMP EAX,ESI
007a683e : JZ 0x007a6922
007a6844 : PUSH 0x2
007a6846 : PUSH ESI
007a6847 : PUSH EAX
007a6848 : CALL 0x006377fb
007a684d : MOV ECX,dword ptr [EBP + -0x30]
007a6850 : PUSH ECX
007a6851 : CALL 0x0063751f
007a6856 : MOV EDX,dword ptr [EBP + -0x30]
007a6859 : PUSH ESI
007a685a : PUSH ESI
007a685b : PUSH EDX
007a685c : MOV EDI,EAX
007a685e : CALL 0x006377fb
007a6863 : MOV EAX,[0x01725270]
007a6868 : SHR EAX,0x3
007a686b : MOV ECX,ESI
007a686d : AND EAX,0x1
007a6870 : SETZ CL
007a6873 : PUSH ECX
007a6874 : PUSH ESI
007a6875 : PUSH 0xbf1a4b
007a687a : PUSH EDI
007a687b : CALL 0x006f0760
007a6880 : MOV EDX,dword ptr [EBP + -0x30]
007a6883 : PUSH EDX
007a6884 : PUSH 0x1
007a6886 : PUSH EDI
007a6887 : PUSH EAX
007a6888 : MOV dword ptr [EBX],EAX
007a688a : CALL 0x00638b7b
007a688f : MOV EAX,dword ptr [EBP + -0x30]
007a6892 : PUSH EAX
007a6893 : CALL 0x006366db
007a6898 : MOV ESI,dword ptr [EBP + -0x18]
007a689b : ADD ESP,0x40
007a689e : MOV EDX,ESI
007a68a0 : CMP ESI,0x4
007a68a3 : JC 0x007a68aa
007a68a5 : MOV EDX,0x4
007a68aa : CMP dword ptr [EBP + -0x14],0x8
007a68ae : MOV EAX,dword ptr [EBP + -0x28]
007a68b1 : JNC 0x007a68b6
007a68b3 : LEA EAX,[EBP + -0x28]
007a68b6 : PUSH EAX
007a68b7 : MOV ECX,0xc16904
007a68bc : CALL 0x00405b70
007a68c1 : ADD ESP,0x4
007a68c4 : TEST EAX,EAX
007a68c6 : JNZ 0x007a68fc
007a68c8 : CMP ESI,0x4
007a68cb : JC 0x007a68fc
007a68cd : CMP ESI,0x4
007a68d0 : SETNZ AL
007a68d3 : TEST EAX,EAX
007a68d5 : JNZ 0x007a68fc
007a68d7 : MOV ESI,dword ptr [EBX]
007a68d9 : MOV EAX,EDI
007a68db : CDQ
007a68dc : AND EDX,0x3
007a68df : ADD EAX,EDX
007a68e1 : SAR EAX,0x2
007a68e4 : XOR ECX,ECX
007a68e6 : TEST EAX,EAX
007a68e8 : JLE 0x007a68fc
007a68ea : LEA EBX,[EBX]
007a68f0 : XOR dword ptr [ESI + ECX*0x4],0x93c684e7
007a68f7 : INC ECX
007a68f8 : CMP ECX,EAX
007a68fa : JL 0x007a68f0
007a68fc : MOV dword ptr [EBP + -0x4],0xffffffff
007a6903 : CMP dword ptr [EBP + -0x14],0x8
007a6907 : JC 0x007a6911
007a6909 : MOV ECX,dword ptr [EBP + -0x28]
007a690c : CALL 0x006f04e0
007a6911 : XOR ECX,ECX
007a6913 : MOV dword ptr [EBP + -0x18],0x0
007a691a : MOV word ptr [EBP + -0x28],CX
007a691e : MOV EAX,EDI
007a6920 : JMP 0x007a6942
007a6922 : MOV dword ptr [EBP + -0x4],0xffffffff
007a6929 : CMP dword ptr [EBP + -0x14],0x8
007a692d : JC 0x007a6937
007a692f : MOV ECX,dword ptr [EBP + -0x28]
007a6932 : CALL 0x006f04e0
007a6937 : XOR EDX,EDX
007a6939 : MOV dword ptr [EBP + -0x18],ESI
007a693c : MOV word ptr [EBP + -0x28],DX
007a6940 : XOR EAX,EAX
007a6942 : MOV dword ptr [EBP + -0x14],0x7
007a6949 : MOV ECX,dword ptr [EBP + -0xc]
007a694c : MOV dword ptr FS:[0x0],ECX
007a6953 : POP ECX
007a6954 : POP EDI
007a6955 : POP ESI
007a6956 : POP EBX
007a6957 : MOV ECX,dword ptr [EBP + -0x10]
007a695a : XOR ECX,EBP
007a695c : CALL 0x00633e6b
007a6961 : MOV ESP,EBP
007a6963 : POP EBP
007a6964 : RET

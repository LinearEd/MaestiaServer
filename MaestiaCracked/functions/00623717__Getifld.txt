PROGRAM  : Maestia.exe
FUNCTION : _Getifld
ENTRY    : 00623717
BODY     : [[00623717, 006239dd]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __EH_prolog3_GS replaced with injection: EH_prolog3 */
/* Library Function - Single Match
    private: int __cdecl std::num_get<char,class std::istreambuf_iterator<char,struct
   std::char_traits<char> > >::_Getifld(char *,class std::istreambuf_iterator<char,struct
   std::char_traits<char> > &,class std::istreambuf_iterator<char,struct std::char_traits<char> >
   &,int,class std::locale const &)const 
   
   Library: Visual Studio 2008 Release */

int __thiscall
std::num_get<char,class_std::istreambuf_iterator<char,struct_std::char_traits<char>_>_>::_Getifld
          (num_get<char,class_std::istreambuf_iterator<char,struct_std::char_traits<char>_>_> *this,
          char *param_1,istreambuf_iterator<char,struct_std::char_traits<char>_> *param_2,
          istreambuf_iterator<char,struct_std::char_traits<char>_> *param_3,int param_4,
          locale *param_5)

{
  bool bVar1;
  char cVar2;
  byte bVar3;
  bool bVar4;
  istreambuf_iterator<char,struct_std::char_traits<char>_> iVar5;
  int *piVar6;
  uint uVar7;
  void *pvVar8;
  char *pcVar9;
  int iVar10;
  char ****ppppcVar11;
  size_t local_68;
  char local_5c;
  istreambuf_iterator<char,struct_std::char_traits<char>_> *local_54;
  char local_4e;
  undefined1 local_4c [4];
  char ***local_48 [4];
  int local_38;
  uint local_34;
  undefined4 local_8;
  undefined4 uStack_4;
  
  uStack_4 = 0x58;
  local_8 = 0x623723;
  piVar6 = (int *)FUN_004d4090();
  FUN_004d3c20(local_4c);
  local_8 = 0;
  if (local_38 == 0) {
    local_4e = '\0';
  }
  else {
    local_4e = (**(code **)(*piVar6 + 8))();
  }
  local_54 = param_2;
  bVar1 = istreambuf_iterator<char,struct_std::char_traits<char>_>::equal
                    (param_3,(istreambuf_iterator<char,struct_std::char_traits<char>_> *)param_4);
  if (!bVar1) {
    cVar2 = istreambuf_iterator<char,struct_std::char_traits<char>_>::operator*(param_3);
    if (cVar2 == '+') {
      *param_2 = (istreambuf_iterator<char,struct_std::char_traits<char>_>)0x2b;
    }
    else {
      cVar2 = istreambuf_iterator<char,struct_std::char_traits<char>_>::operator*(param_3);
      if (cVar2 != '-') goto LAB_0062379b;
      *param_2 = (istreambuf_iterator<char,struct_std::char_traits<char>_>)0x2d;
    }
    local_54 = param_2 + 1;
    istreambuf_iterator<char,struct_std::char_traits<char>_>::_Inc(param_3);
  }
LAB_0062379b:
  uVar7 = (uint)param_5 & 0xe00;
  if (uVar7 == 0x400) {
    bVar3 = 8;
  }
  else if (uVar7 == 0x800) {
    bVar3 = 0x10;
  }
  else {
    bVar3 = -(uVar7 != 0) & 10;
  }
  local_5c = '\0';
  bVar1 = false;
  bVar4 = operator!=<char,struct_std::char_traits<char>_>
                    (param_3,(istreambuf_iterator<char,struct_std::char_traits<char>_> *)param_4);
  if (bVar4) {
    cVar2 = istreambuf_iterator<char,struct_std::char_traits<char>_>::operator*(param_3);
    if (cVar2 != '0') goto LAB_00623849;
    local_5c = '\x01';
    istreambuf_iterator<char,struct_std::char_traits<char>_>::_Inc(param_3);
    bVar4 = operator!=<char,struct_std::char_traits<char>_>
                      (param_3,(istreambuf_iterator<char,struct_std::char_traits<char>_> *)param_4);
    if (!bVar4) {
LAB_00623840:
      if (bVar3 == 0) {
        bVar3 = 8;
        goto LAB_00623849;
      }
      goto LAB_0062384f;
    }
    cVar2 = istreambuf_iterator<char,struct_std::char_traits<char>_>::operator*(param_3);
    if (cVar2 != 'x') {
      cVar2 = istreambuf_iterator<char,struct_std::char_traits<char>_>::operator*(param_3);
      if (cVar2 != 'X') goto LAB_00623840;
    }
    if ((bVar3 != 0) && (bVar3 != 0x10)) goto LAB_00623840;
    bVar3 = 0x10;
    local_5c = '\0';
    istreambuf_iterator<char,struct_std::char_traits<char>_>::_Inc(param_3);
LAB_00623854:
    local_68 = ((bVar3 != 8) - 1 & 0xfffffff2) + 0x16;
  }
  else {
LAB_00623849:
    if (bVar3 != 0) {
LAB_0062384f:
      if (bVar3 != 10) goto LAB_00623854;
    }
    local_68 = 10;
  }
  FUN_004d1280(1,local_5c);
  local_8 = CONCAT31(local_8._1_3_,1);
  iVar10 = 0;
  bVar4 = operator!=<char,struct_std::char_traits<char>_>
                    (param_3,(istreambuf_iterator<char,struct_std::char_traits<char>_> *)param_4);
  if (bVar4) {
    do {
      iVar5 = (istreambuf_iterator<char,struct_std::char_traits<char>_>)
              istreambuf_iterator<char,struct_std::char_traits<char>_>::operator*(param_3);
      *local_54 = iVar5;
      pvVar8 = _memchr("0123456789abcdefABCDEF",(int)(char)iVar5,local_68);
      if (pvVar8 == (void *)0x0) {
        pcVar9 = (char *)FUN_004d3b30(iVar10);
        if ((*pcVar9 == '\0') || (local_4e == '\0')) break;
        cVar2 = istreambuf_iterator<char,struct_std::char_traits<char>_>::operator*(param_3);
        if (cVar2 != local_4e) break;
        FUN_004d12b0(1,0);
        iVar10 = iVar10 + 1;
      }
      else {
        if (((bVar1) ||
            (*local_54 != (istreambuf_iterator<char,struct_std::char_traits<char>_>)0x30)) &&
           (local_54 < param_2 + 0x1f)) {
          local_54 = local_54 + 1;
          bVar1 = true;
        }
        local_5c = '\x01';
        pcVar9 = (char *)FUN_004d3b30(iVar10);
        if (*pcVar9 != '\x7f') {
          pcVar9 = (char *)FUN_004d3b30(iVar10);
          *pcVar9 = *pcVar9 + '\x01';
        }
      }
      istreambuf_iterator<char,struct_std::char_traits<char>_>::_Inc(param_3);
      bVar4 = operator!=<char,struct_std::char_traits<char>_>
                        (param_3,(istreambuf_iterator<char,struct_std::char_traits<char>_> *)param_4
                        );
    } while (bVar4);
    if (iVar10 != 0) {
      pcVar9 = (char *)FUN_004d3b30(iVar10);
      if (*pcVar9 < '\x01') {
        local_5c = '\0';
      }
      else {
        iVar10 = iVar10 + 1;
      }
    }
  }
  if (local_34 < 0x10) {
    local_48[0] = (char ***)local_48;
  }
  ppppcVar11 = (char ****)local_48[0];
  if (local_5c == '\0') {
LAB_006239b1:
    local_54 = param_2;
  }
  else {
    while ((iVar10 != 0 && (*(char *)ppppcVar11 != '\x7f'))) {
      iVar10 = iVar10 + -1;
      if (iVar10 != 0) {
        pcVar9 = (char *)FUN_004d3b30(iVar10);
        if (*(char *)ppppcVar11 != *pcVar9) goto LAB_006239b1;
      }
      if (iVar10 == 0) {
        pcVar9 = (char *)FUN_004d3b30(0);
        if (*(char *)ppppcVar11 < *pcVar9) goto LAB_006239b1;
      }
      if ('\0' < *(char *)((int)ppppcVar11 + 1)) {
        ppppcVar11 = (char ****)((int)ppppcVar11 + 1);
      }
    }
    if (!bVar1) {
      *local_54 = (istreambuf_iterator<char,struct_std::char_traits<char>_>)0x30;
      local_54 = local_54 + 1;
    }
  }
  *local_54 = (istreambuf_iterator<char,struct_std::char_traits<char>_>)0x0;
  FUN_00405260(1,0);
  FUN_00405260(1,0);
  iVar10 = FUN_00640ed0();
  return iVar10;
}



============================================================
DISASSEMBLY
============================================================
00623717 : PUSH 0x58
00623719 : MOV EAX,0xb0b633
0062371e : CALL 0x00640e86
00623723 : MOV EAX,dword ptr [EBP + 0x14]
00623726 : MOV EBX,dword ptr [EBP + 0xc]
00623729 : MOV EDI,dword ptr [EBP + 0x10]
0062372c : MOV dword ptr [EBP + -0x5c],EAX
0062372f : MOV EAX,dword ptr [EBP + 0x1c]
00623732 : PUSH EAX
00623733 : MOV dword ptr [EBP + -0x60],EBX
00623736 : CALL 0x004d4090
0062373b : MOV ESI,EAX
0062373d : POP ECX
0062373e : LEA EAX,[EBP + -0x48]
00623741 : PUSH EAX
00623742 : MOV ECX,ESI
00623744 : CALL 0x004d3c20
00623749 : AND dword ptr [EBP + -0x4],0x0
0062374d : CMP dword ptr [EBP + -0x34],0x0
00623751 : JNZ 0x00623759
00623753 : MOV byte ptr [EBP + -0x4a],0x0
00623757 : JMP 0x00623763
00623759 : MOV EAX,dword ptr [ESI]
0062375b : MOV ECX,ESI
0062375d : CALL dword ptr [EAX + 0x8]
00623760 : MOV byte ptr [EBP + -0x4a],AL
00623763 : PUSH dword ptr [EBP + -0x5c]
00623766 : MOV ECX,EDI
00623768 : MOV dword ptr [EBP + -0x50],EBX
0062376b : CALL 0x00623123
00623770 : TEST AL,AL
00623772 : JNZ 0x0062379b
00623774 : MOV ECX,EDI
00623776 : CALL 0x0062317a
0062377b : MOV ECX,EDI
0062377d : CMP AL,0x2b
0062377f : JNZ 0x00623785
00623781 : MOV byte ptr [EBX],AL
00623783 : JMP 0x00623792
00623785 : CALL 0x0062317a
0062378a : CMP AL,0x2d
0062378c : JNZ 0x0062379b
0062378e : MOV byte ptr [EBX],AL
00623790 : MOV ECX,EDI
00623792 : INC EBX
00623793 : MOV dword ptr [EBP + -0x50],EBX
00623796 : CALL 0x006230d9
0062379b : MOV EAX,dword ptr [EBP + 0x18]
0062379e : PUSH 0x8
006237a0 : POP EBX
006237a1 : AND EAX,0xe00
006237a6 : PUSH 0xa
006237a8 : POP ESI
006237a9 : CMP EAX,0x400
006237ae : JNZ 0x006237b5
006237b0 : MOV dword ptr [EBP + -0x54],EBX
006237b3 : JMP 0x006237ce
006237b5 : CMP EAX,0x800
006237ba : JNZ 0x006237c5
006237bc : MOV dword ptr [EBP + -0x54],0x10
006237c3 : JMP 0x006237ce
006237c5 : NEG EAX
006237c7 : SBB EAX,EAX
006237c9 : AND EAX,ESI
006237cb : MOV dword ptr [EBP + -0x54],EAX
006237ce : PUSH dword ptr [EBP + -0x5c]
006237d1 : MOV byte ptr [EBP + -0x58],0x0
006237d5 : PUSH EDI
006237d6 : MOV byte ptr [EBP + -0x49],0x0
006237da : CALL 0x0062318f
006237df : POP ECX
006237e0 : POP ECX
006237e1 : TEST AL,AL
006237e3 : JZ 0x00623849
006237e5 : MOV ECX,EDI
006237e7 : CALL 0x0062317a
006237ec : CMP AL,0x30
006237ee : JNZ 0x00623849
006237f0 : MOV ECX,EDI
006237f2 : MOV byte ptr [EBP + -0x58],0x1
006237f6 : CALL 0x006230d9
006237fb : PUSH dword ptr [EBP + -0x5c]
006237fe : PUSH EDI
006237ff : CALL 0x0062318f
00623804 : POP ECX
00623805 : POP ECX
00623806 : TEST AL,AL
00623808 : JZ 0x00623840
0062380a : MOV ECX,EDI
0062380c : CALL 0x0062317a
00623811 : CMP AL,0x78
00623813 : JZ 0x00623820
00623815 : MOV ECX,EDI
00623817 : CALL 0x0062317a
0062381c : CMP AL,0x58
0062381e : JNZ 0x00623840
00623820 : CMP dword ptr [EBP + -0x54],0x0
00623824 : JZ 0x0062382c
00623826 : CMP dword ptr [EBP + -0x54],0x10
0062382a : JNZ 0x00623840
0062382c : MOV ECX,EDI
0062382e : MOV dword ptr [EBP + -0x54],0x10
00623835 : MOV byte ptr [EBP + -0x58],0x0
00623839 : CALL 0x006230d9
0062383e : JMP 0x00623854
00623840 : CMP dword ptr [EBP + -0x54],0x0
00623844 : JNZ 0x0062384f
00623846 : MOV dword ptr [EBP + -0x54],EBX
00623849 : CMP dword ptr [EBP + -0x54],0x0
0062384d : JZ 0x00623868
0062384f : CMP dword ptr [EBP + -0x54],ESI
00623852 : JZ 0x00623868
00623854 : XOR EAX,EAX
00623856 : CMP dword ptr [EBP + -0x54],EBX
00623859 : SETNZ AL
0062385c : DEC EAX
0062385d : AND EAX,0xfffffff2
00623860 : ADD EAX,0x16
00623863 : MOV dword ptr [EBP + -0x64],EAX
00623866 : JMP 0x0062386b
00623868 : MOV dword ptr [EBP + -0x64],ESI
0062386b : PUSH dword ptr [EBP + -0x58]
0062386e : LEA ECX,[EBP + -0x2c]
00623871 : PUSH 0x1
00623873 : CALL 0x004d1280
00623878 : PUSH dword ptr [EBP + -0x5c]
0062387b : MOV ESI,dword ptr [EBP + -0x60]
0062387e : PUSH EDI
0062387f : MOV byte ptr [EBP + -0x4],0x1
00623883 : XOR EBX,EBX
00623885 : ADD ESI,0x1f
00623888 : CALL 0x0062318f
0062388d : POP ECX
0062388e : POP ECX
0062388f : TEST AL,AL
00623891 : JZ 0x00623954
00623897 : MOV ECX,EDI
00623899 : CALL 0x0062317a
0062389e : MOV ECX,dword ptr [EBP + -0x50]
006238a1 : PUSH dword ptr [EBP + -0x64]
006238a4 : MOV byte ptr [ECX],AL
006238a6 : MOVSX EAX,AL
006238a9 : PUSH EAX
006238aa : PUSH 0xb95a40
006238af : CALL 0x00635250
006238b4 : ADD ESP,0xc
006238b7 : TEST EAX,EAX
006238b9 : JZ 0x006238f4
006238bb : CMP byte ptr [EBP + -0x49],0x0
006238bf : JNZ 0x006238c9
006238c1 : MOV EAX,dword ptr [EBP + -0x50]
006238c4 : CMP byte ptr [EAX],0x30
006238c7 : JZ 0x006238d5
006238c9 : CMP dword ptr [EBP + -0x50],ESI
006238cc : JNC 0x006238d5
006238ce : INC dword ptr [EBP + -0x50]
006238d1 : MOV byte ptr [EBP + -0x49],0x1
006238d5 : PUSH EBX
006238d6 : LEA ECX,[EBP + -0x2c]
006238d9 : MOV byte ptr [EBP + -0x58],0x1
006238dd : CALL 0x004d3b30
006238e2 : CMP byte ptr [EAX],0x7f
006238e5 : JZ 0x00623921
006238e7 : PUSH EBX
006238e8 : LEA ECX,[EBP + -0x2c]
006238eb : CALL 0x004d3b30
006238f0 : INC byte ptr [EAX]
006238f2 : JMP 0x00623921
006238f4 : PUSH EBX
006238f5 : LEA ECX,[EBP + -0x2c]
006238f8 : CALL 0x004d3b30
006238fd : CMP byte ptr [EAX],0x0
00623900 : JZ 0x0062393b
00623902 : CMP byte ptr [EBP + -0x4a],0x0
00623906 : JZ 0x0062393b
00623908 : MOV ECX,EDI
0062390a : CALL 0x0062317a
0062390f : CMP AL,byte ptr [EBP + -0x4a]
00623912 : JNZ 0x0062393b
00623914 : PUSH 0x0
00623916 : PUSH 0x1
00623918 : LEA ECX,[EBP + -0x2c]
0062391b : CALL 0x004d12b0
00623920 : INC EBX
00623921 : MOV ECX,EDI
00623923 : CALL 0x006230d9
00623928 : PUSH dword ptr [EBP + -0x5c]
0062392b : PUSH EDI
0062392c : CALL 0x0062318f
00623931 : POP ECX
00623932 : POP ECX
00623933 : TEST AL,AL
00623935 : JNZ 0x00623897
0062393b : TEST EBX,EBX
0062393d : JZ 0x00623954
0062393f : PUSH EBX
00623940 : LEA ECX,[EBP + -0x2c]
00623943 : CALL 0x004d3b30
00623948 : CMP byte ptr [EAX],0x0
0062394b : JLE 0x00623950
0062394d : INC EBX
0062394e : JMP 0x00623954
00623950 : MOV byte ptr [EBP + -0x58],0x0
00623954 : CMP dword ptr [EBP + -0x30],0x10
00623958 : MOV ESI,dword ptr [EBP + -0x44]
0062395b : JNC 0x00623960
0062395d : LEA ESI,[EBP + -0x44]
00623960 : CMP byte ptr [EBP + -0x58],0x0
00623964 : JZ 0x006239b1
00623966 : TEST EBX,EBX
00623968 : JBE 0x006239a0
0062396a : CMP byte ptr [ESI],0x7f
0062396d : JZ 0x006239a0
0062396f : DEC EBX
00623970 : JZ 0x00623981
00623972 : PUSH EBX
00623973 : LEA ECX,[EBP + -0x2c]
00623976 : CALL 0x004d3b30
0062397b : MOV CL,byte ptr [ESI]
0062397d : CMP CL,byte ptr [EAX]
0062397f : JNZ 0x006239b1
00623981 : TEST EBX,EBX
00623983 : JNZ 0x00623994
00623985 : PUSH EBX
00623986 : LEA ECX,[EBP + -0x2c]
00623989 : CALL 0x004d3b30
0062398e : MOV CL,byte ptr [ESI]
00623990 : CMP CL,byte ptr [EAX]
00623992 : JL 0x006239b1
00623994 : LEA EAX,[ESI + 0x1]
00623997 : CMP byte ptr [EAX],0x0
0062399a : JLE 0x00623966
0062399c : MOV ESI,EAX
0062399e : JMP 0x00623966
006239a0 : CMP byte ptr [EBP + -0x49],0x0
006239a4 : JNZ 0x006239b7
006239a6 : MOV EAX,dword ptr [EBP + -0x50]
006239a9 : INC dword ptr [EBP + -0x50]
006239ac : MOV byte ptr [EAX],0x30
006239af : JMP 0x006239b7
006239b1 : MOV EAX,dword ptr [EBP + -0x60]
006239b4 : MOV dword ptr [EBP + -0x50],EAX
006239b7 : MOV EAX,dword ptr [EBP + -0x50]
006239ba : PUSH 0x0
006239bc : PUSH 0x1
006239be : LEA ECX,[EBP + -0x2c]
006239c1 : MOV byte ptr [EAX],0x0
006239c4 : CALL 0x00405260
006239c9 : PUSH 0x0
006239cb : PUSH 0x1
006239cd : LEA ECX,[EBP + -0x48]
006239d0 : CALL 0x00405260
006239d5 : MOV EAX,dword ptr [EBP + -0x54]
006239d8 : CALL 0x00640ed0
006239dd : RET

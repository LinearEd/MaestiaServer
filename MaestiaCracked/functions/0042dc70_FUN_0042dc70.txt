PROGRAM  : Maestia.exe
FUNCTION : FUN_0042dc70
ENTRY    : 0042dc70
BODY     : [[0042dc70, 0042dce6]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0042dc70(wchar_t *param_1)

{
  wchar_t wVar1;
  wchar_t *_Dest;
  undefined4 in_ECX;
  wchar_t *in_EDX;
  ushort *unaff_ESI;
  
  *unaff_ESI = 0;
  *(undefined1 *)(unaff_ESI + 1) = 0x3b;
  *(undefined1 *)((int)unaff_ESI + 3) = 0x20;
  *(undefined4 *)(unaff_ESI + 2) = in_ECX;
  unaff_ESI[4] = 1;
  unaff_ESI[5] = 0;
  _wcsncpy((wchar_t *)(unaff_ESI + 6),in_EDX,0x27);
  unaff_ESI[0x2d] = 0;
  _Dest = (wchar_t *)(unaff_ESI + 0x2e);
  _wcsncpy(_Dest,param_1,99);
  unaff_ESI[0x91] = 0;
  do {
    wVar1 = *_Dest;
    _Dest = _Dest + 1;
  } while (wVar1 != L'\0');
  *unaff_ESI = *unaff_ESI ^
               ((short)((int)_Dest - (int)(unaff_ESI + 0x2f) >> 1) * 2 + 0x5eU ^ *unaff_ESI) &
               0x1fff;
  return;
}



============================================================
DISASSEMBLY
============================================================
0042dc70 : PUSH EBP
0042dc71 : MOV EBP,ESP
0042dc73 : PUSH EDI
0042dc74 : PUSH 0x27
0042dc76 : PUSH EDX
0042dc77 : XOR EAX,EAX
0042dc79 : LEA EDI,[ESI + 0xc]
0042dc7c : PUSH EDI
0042dc7d : MOV word ptr [ESI],AX
0042dc80 : MOV byte ptr [ESI + 0x2],0x3b
0042dc84 : MOV byte ptr [ESI + 0x3],0x20
0042dc88 : MOV dword ptr [ESI + 0x4],ECX
0042dc8b : MOV dword ptr [ESI + 0x8],0x1
0042dc92 : CALL 0x00634e39
0042dc97 : MOV ECX,dword ptr [EBP + 0x8]
0042dc9a : XOR EAX,EAX
0042dc9c : PUSH 0x63
0042dc9e : MOV word ptr [EDI + 0x4e],AX
0042dca2 : PUSH ECX
0042dca3 : LEA EDI,[ESI + 0x5c]
0042dca6 : PUSH EDI
0042dca7 : CALL 0x00634e39
0042dcac : ADD ESP,0x18
0042dcaf : XOR EDX,EDX
0042dcb1 : MOV EAX,EDI
0042dcb3 : MOV word ptr [EDI + 0xc6],DX
0042dcba : LEA EDX,[EAX + 0x2]
0042dcbd : POP EDI
0042dcbe : MOV EDI,EDI
0042dcc0 : MOV CX,word ptr [EAX]
0042dcc3 : ADD EAX,0x2
0042dcc6 : TEST CX,CX
0042dcc9 : JNZ 0x0042dcc0
0042dccb : SUB EAX,EDX
0042dccd : SAR EAX,0x1
0042dccf : LEA EAX,[EAX + EAX*0x1 + 0x5e]
0042dcd3 : XOR AX,word ptr [ESI]
0042dcd6 : MOV ECX,0x1fff
0042dcdb : AND AX,CX
0042dcde : XOR word ptr [ESI],AX
0042dce1 : MOV EAX,ESI
0042dce3 : POP EBP
0042dce4 : RET 0x4

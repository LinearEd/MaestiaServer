PROGRAM  : Maestia.exe
FUNCTION : FUN_0070a8e0
ENTRY    : 0070a8e0
BODY     : [[0070a8e0, 0070a922]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_0070a8e0(char *param_1,char *param_2)

{
  int in_ECX;
  
  if (*(FILE **)(in_ECX + 0x10) != (FILE *)0x0) {
    _fclose(*(FILE **)(in_ECX + 0x10));
  }
  _fopen_s((FILE **)(in_ECX + 0x10),param_1,param_2);
  if (*(FILE **)(in_ECX + 0x10) == (FILE *)0x0) {
    return 0;
  }
  *(undefined1 *)(in_ECX + 4) = 1;
  return 1;
}



============================================================
DISASSEMBLY
============================================================
0070a8e0 : PUSH EBP
0070a8e1 : MOV EBP,ESP
0070a8e3 : PUSH ESI
0070a8e4 : PUSH EDI
0070a8e5 : MOV EDI,ECX
0070a8e7 : MOV EAX,dword ptr [EDI + 0x10]
0070a8ea : LEA ESI,[EDI + 0x10]
0070a8ed : TEST EAX,EAX
0070a8ef : JZ 0x0070a8fa
0070a8f1 : PUSH EAX
0070a8f2 : CALL 0x006366db
0070a8f7 : ADD ESP,0x4
0070a8fa : MOV EAX,dword ptr [EBP + 0xc]
0070a8fd : MOV ECX,dword ptr [EBP + 0x8]
0070a900 : PUSH EAX
0070a901 : PUSH ECX
0070a902 : PUSH ESI
0070a903 : CALL 0x00638fb7
0070a908 : ADD ESP,0xc
0070a90b : CMP dword ptr [ESI],0x0
0070a90e : JNZ 0x0070a918
0070a910 : POP EDI
0070a911 : XOR AL,AL
0070a913 : POP ESI
0070a914 : POP EBP
0070a915 : RET 0x8
0070a918 : MOV AL,0x1
0070a91a : MOV byte ptr [EDI + 0x4],AL
0070a91d : POP EDI
0070a91e : POP ESI
0070a91f : POP EBP
0070a920 : RET 0x8

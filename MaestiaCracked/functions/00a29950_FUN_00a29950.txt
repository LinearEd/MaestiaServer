PROGRAM  : Maestia.exe
FUNCTION : FUN_00a29950
ENTRY    : 00a29950
BODY     : [[00a29950, 00a29d02]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a29950(void)

{
  int iVar1;
  int iVar2;
  int iVar3;
  uint8_t uVar4;
  int *piVar5;
  int iVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  bool bVar9;
  char cVar10;
  char cVar11;
  char cVar12;
  undefined2 uVar13;
  uint uVar14;
  DWORD DVar15;
  int in_ECX;
  byte bVar16;
  char cVar17;
  uint8_t *packet;
  bool bVar18;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_00b3b047;
  local_14 = ExceptionList;
  uVar14 = DAT_00d66fa0 ^ (uint)&stack0xffffffb0;
  ExceptionList = &local_14;
  if (*(int *)(in_ECX + 0x59c) != 0) {
    bVar9 = false;
    DVar15 = timeGetTime();
    piVar5 = *(int **)(in_ECX + 0x59c);
    iVar1 = piVar5[0x69];
    iVar2 = piVar5[0x6a];
    iVar3 = piVar5[0x6b];
    cVar10 = FUN_0040df60(uVar14);
    bVar18 = *(short *)(in_ECX + 0x402) != 0;
    cVar11 = FUN_0040e9b0();
    if ((cVar11 != '\0') && (*(char *)((int)piVar5 + 0x1877) != '\0')) {
      cVar11 = '\0';
    }
    cVar12 = FUN_0040df10();
    cVar17 = '\x02';
    if (((bVar18) || (cVar10 != '\0')) || (cVar11 != '\0')) {
      cVar17 = '\x03';
      cVar11 = (**(code **)(*piVar5 + 0x4bc))();
      if (((cVar11 == '\0') ||
          (cVar11 = (**(code **)(**(int **)(in_ECX + 0x59c) + 0x4c8))(), cVar11 != '\0')) ||
         (cVar11 = (**(code **)(**(int **)(in_ECX + 0x59c) + 0x4c4))(), cVar11 != '\0')) {
        cVar11 = (**(code **)(**(int **)(in_ECX + 0x59c) + 0x4c0))();
        if (((cVar11 == '\0') ||
            (cVar11 = (**(code **)(**(int **)(in_ECX + 0x59c) + 0x4c8))(), cVar11 != '\0')) ||
           (cVar11 = (**(code **)(**(int **)(in_ECX + 0x59c) + 0x4c4))(), cVar11 != '\0')) {
          cVar11 = (**(code **)(**(int **)(in_ECX + 0x59c) + 0x4c4))();
          if (cVar11 == '\0') {
            cVar11 = (**(code **)(**(int **)(in_ECX + 0x59c) + 0x4c8))();
            if (((cVar11 == '\0') &&
                (cVar11 = (**(code **)(**(int **)(in_ECX + 0x59c) + 0x4c4))(), cVar11 == '\0')) &&
               (cVar11 = (**(code **)(**(int **)(in_ECX + 0x59c) + 0x4cc))(), cVar11 != '\0')) {
              cVar17 = '\f';
            }
            else {
              cVar11 = (**(code **)(**(int **)(in_ECX + 0x59c) + 0x4c8))();
              if (((cVar11 == '\0') &&
                  (cVar11 = (**(code **)(**(int **)(in_ECX + 0x59c) + 0x4c4))(), cVar11 == '\0')) &&
                 (cVar11 = (**(code **)(**(int **)(in_ECX + 0x59c) + 0x4d0))(), cVar11 != '\0')) {
                cVar17 = '\r';
              }
            }
          }
          else {
            cVar11 = (**(code **)(**(int **)(in_ECX + 0x59c) + 0x4c0))();
            if (cVar11 == '\0') {
              cVar11 = (**(code **)(**(int **)(in_ECX + 0x59c) + 0x4bc))();
              cVar17 = (cVar11 != '\0') + '\x06';
            }
            else {
              cVar17 = '\b';
            }
          }
        }
        else {
          cVar17 = '\x05';
        }
      }
      else {
        cVar17 = '\x04';
      }
    }
    if (cVar12 != '\0') {
      if ((cVar10 != '\0') || (bVar18)) {
        cVar17 = '\n';
      }
      else {
        cVar17 = '\t';
      }
    }
    if ((cVar17 != *(char *)(in_ECX + 0x5f8)) &&
       ((((cVar17 == '\x02' || (cVar17 == '\n')) || (cVar17 == '\t')) ||
        (*(char *)(in_ECX + 0x5f8) == '\x02')))) {
      bVar9 = true;
    }
    if (0xf9 < DVar15 - *(int *)(in_ECX + 0x5f4)) {
      bVar9 = true;
    }
    if ((*(char *)(in_ECX + 0x5f9) == '\r') ||
       ((*(char *)(in_ECX + 0x5f9) == '\f' && (cVar17 == '\x02')))) {
      cVar17 = '\x0e';
    }
    *(char *)(in_ECX + 0x5f8) = cVar17;
    if (bVar9) {
      FUN_00889560();
      FUN_00b0b091();
      iVar6 = *(int *)ThreadLocalStoragePointer;
      bVar16 = *(byte *)(iVar6 + 0x18);
      *(DWORD *)(in_ECX + 0x5f4) = DVar15;
      bVar16 = (byte)((ulonglong)(bVar16 + 1) % 3);
      *(byte *)(iVar6 + 0x18) = bVar16;
      packet = (uint8_t *)((uint)bVar16 * 0x2000 + 0x122cb8 + iVar6);
      uStack_c = 0;
      if (packet == (uint8_t *)0x0) {
        packet = (uint8_t *)0x0;
      }
      else {
        uVar7 = *(undefined4 *)(*(int *)(in_ECX + 0x59c) + 4);
        uVar8 = *(undefined4 *)(in_ECX + 0x5f4);
        uVar4 = *(uint8_t *)(in_ECX + 0x5f8);
        *(int *)(packet + 0xc) = iVar1;
        *(int *)(packet + 0x10) = iVar2;
        packet[0] = '\0';
        packet[1] = ' ';
        *(undefined4 *)(packet + 4) = uVar7;
        *(undefined4 *)(packet + 8) = uVar8;
        packet[2] = '4';
        packet[3] = 0xe7;
        *(int *)(packet + 0x14) = iVar3;
        uVar13 = FUN_0040de60();
        *(undefined2 *)(packet + 0x18) = uVar13;
        packet[0x1a] = uVar4;
      }
      uStack_c = 0xffffffff;
      if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
        FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),0x1b,packet);
      }
    }
  }
  ExceptionList = local_14;
  return;
}



============================================================
DISASSEMBLY
============================================================
00a29950 : PUSH EBP
00a29951 : MOV EBP,ESP
00a29953 : AND ESP,0xfffffff8
00a29956 : PUSH -0x1
00a29958 : PUSH 0xb3b047
00a2995d : MOV EAX,FS:[0x0]
00a29963 : PUSH EAX
00a29964 : SUB ESP,0x30
00a29967 : PUSH EBX
00a29968 : PUSH ESI
00a29969 : PUSH EDI
00a2996a : MOV EAX,[0x00d66fa0]
00a2996f : XOR EAX,ESP
00a29971 : PUSH EAX
00a29972 : LEA EAX,[ESP + 0x40]
00a29976 : MOV FS:[0x0],EAX
00a2997c : MOV EDI,ECX
00a2997e : XOR EBX,EBX
00a29980 : CMP dword ptr [EDI + 0x59c],EBX
00a29986 : JZ 0x00a29cf0
00a2998c : MOV dword ptr [ESP + 0x14],EBX
00a29990 : CALL dword ptr [0x00b85598]
00a29996 : MOV ESI,dword ptr [EDI + 0x59c]
00a2999c : MOVSS XMM0,dword ptr [ESI + 0x1a4]
00a299a4 : MOVSS dword ptr [ESP + 0x30],XMM0
00a299aa : MOVSS XMM0,dword ptr [ESI + 0x1a8]
00a299b2 : MOV dword ptr [ESP + 0x28],EAX
00a299b6 : MOVSS dword ptr [ESP + 0x34],XMM0
00a299bc : MOVSS XMM0,dword ptr [ESI + 0x1ac]
00a299c4 : MOV EAX,ESI
00a299c6 : MOVSS dword ptr [ESP + 0x38],XMM0
00a299cc : CALL 0x0040df60
00a299d1 : MOVZX EAX,AL
00a299d4 : MOV dword ptr [ESP + 0x20],EAX
00a299d8 : MOV dword ptr [ESP + 0x18],EBX
00a299dc : CMP word ptr [EDI + 0x402],BX
00a299e3 : JZ 0x00a299ed
00a299e5 : MOV dword ptr [ESP + 0x18],0x1
00a299ed : MOV EAX,ESI
00a299ef : CALL 0x0040e9b0
00a299f4 : MOVZX EAX,AL
00a299f7 : MOV dword ptr [ESP + 0x1c],EAX
00a299fb : CMP EAX,EBX
00a299fd : JZ 0x00a29a0b
00a299ff : CMP byte ptr [ESI + 0x1877],BL
00a29a05 : JZ 0x00a29a0b
00a29a07 : MOV dword ptr [ESP + 0x1c],EBX
00a29a0b : MOV EAX,ESI
00a29a0d : CALL 0x0040df10
00a29a12 : CMP dword ptr [ESP + 0x18],0x0
00a29a17 : MOVZX ECX,AL
00a29a1a : MOV dword ptr [ESP + 0x2c],ECX
00a29a1e : MOV BL,0x2
00a29a20 : JNZ 0x00a29a34
00a29a22 : CMP dword ptr [ESP + 0x20],0x0
00a29a27 : JNZ 0x00a29a34
00a29a29 : CMP dword ptr [ESP + 0x1c],0x0
00a29a2e : JZ 0x00a29b77
00a29a34 : MOV EDX,dword ptr [ESI]
00a29a36 : MOV EAX,dword ptr [EDX + 0x4bc]
00a29a3c : MOV ECX,ESI
00a29a3e : MOV BL,0x3
00a29a40 : CALL EAX
00a29a42 : TEST AL,AL
00a29a44 : JZ 0x00a29a75
00a29a46 : MOV ECX,dword ptr [EDI + 0x59c]
00a29a4c : MOV EDX,dword ptr [ECX]
00a29a4e : MOV EAX,dword ptr [EDX + 0x4c8]
00a29a54 : CALL EAX
00a29a56 : TEST AL,AL
00a29a58 : JNZ 0x00a29a75
00a29a5a : MOV ECX,dword ptr [EDI + 0x59c]
00a29a60 : MOV EDX,dword ptr [ECX]
00a29a62 : MOV EAX,dword ptr [EDX + 0x4c4]
00a29a68 : CALL EAX
00a29a6a : TEST AL,AL
00a29a6c : JNZ 0x00a29a75
00a29a6e : MOV BL,0x4
00a29a70 : JMP 0x00a29b77
00a29a75 : MOV ECX,dword ptr [EDI + 0x59c]
00a29a7b : MOV EDX,dword ptr [ECX]
00a29a7d : MOV EAX,dword ptr [EDX + 0x4c0]
00a29a83 : CALL EAX
00a29a85 : TEST AL,AL
00a29a87 : JZ 0x00a29ab8
00a29a89 : MOV ECX,dword ptr [EDI + 0x59c]
00a29a8f : MOV EDX,dword ptr [ECX]
00a29a91 : MOV EAX,dword ptr [EDX + 0x4c8]
00a29a97 : CALL EAX
00a29a99 : TEST AL,AL
00a29a9b : JNZ 0x00a29ab8
00a29a9d : MOV ECX,dword ptr [EDI + 0x59c]
00a29aa3 : MOV EDX,dword ptr [ECX]
00a29aa5 : MOV EAX,dword ptr [EDX + 0x4c4]
00a29aab : CALL EAX
00a29aad : TEST AL,AL
00a29aaf : JNZ 0x00a29ab8
00a29ab1 : MOV BL,0x5
00a29ab3 : JMP 0x00a29b77
00a29ab8 : MOV ECX,dword ptr [EDI + 0x59c]
00a29abe : MOV EDX,dword ptr [ECX]
00a29ac0 : MOV EAX,dword ptr [EDX + 0x4c4]
00a29ac6 : CALL EAX
00a29ac8 : MOV ECX,dword ptr [EDI + 0x59c]
00a29ace : MOV EDX,dword ptr [ECX]
00a29ad0 : TEST AL,AL
00a29ad2 : JZ 0x00a29b01
00a29ad4 : MOV EAX,dword ptr [EDX + 0x4c0]
00a29ada : CALL EAX
00a29adc : TEST AL,AL
00a29ade : JZ 0x00a29ae7
00a29ae0 : MOV BL,0x8
00a29ae2 : JMP 0x00a29b77
00a29ae7 : MOV ECX,dword ptr [EDI + 0x59c]
00a29aed : MOV EDX,dword ptr [ECX]
00a29aef : MOV EAX,dword ptr [EDX + 0x4bc]
00a29af5 : CALL EAX
00a29af7 : TEST AL,AL
00a29af9 : SETNZ BL
00a29afc : ADD BL,0x6
00a29aff : JMP 0x00a29b77
00a29b01 : MOV EAX,dword ptr [EDX + 0x4c8]
00a29b07 : CALL EAX
00a29b09 : TEST AL,AL
00a29b0b : JNZ 0x00a29b39
00a29b0d : MOV ECX,dword ptr [EDI + 0x59c]
00a29b13 : MOV EDX,dword ptr [ECX]
00a29b15 : MOV EAX,dword ptr [EDX + 0x4c4]
00a29b1b : CALL EAX
00a29b1d : TEST AL,AL
00a29b1f : JNZ 0x00a29b39
00a29b21 : MOV ECX,dword ptr [EDI + 0x59c]
00a29b27 : MOV EDX,dword ptr [ECX]
00a29b29 : MOV EAX,dword ptr [EDX + 0x4cc]
00a29b2f : CALL EAX
00a29b31 : TEST AL,AL
00a29b33 : JZ 0x00a29b39
00a29b35 : MOV BL,0xc
00a29b37 : JMP 0x00a29b77
00a29b39 : MOV ECX,dword ptr [EDI + 0x59c]
00a29b3f : MOV EDX,dword ptr [ECX]
00a29b41 : MOV EAX,dword ptr [EDX + 0x4c8]
00a29b47 : CALL EAX
00a29b49 : TEST AL,AL
00a29b4b : JNZ 0x00a29b77
00a29b4d : MOV ECX,dword ptr [EDI + 0x59c]
00a29b53 : MOV EDX,dword ptr [ECX]
00a29b55 : MOV EAX,dword ptr [EDX + 0x4c4]
00a29b5b : CALL EAX
00a29b5d : TEST AL,AL
00a29b5f : JNZ 0x00a29b77
00a29b61 : MOV ECX,dword ptr [EDI + 0x59c]
00a29b67 : MOV EDX,dword ptr [ECX]
00a29b69 : MOV EAX,dword ptr [EDX + 0x4d0]
00a29b6f : CALL EAX
00a29b71 : TEST AL,AL
00a29b73 : JZ 0x00a29b77
00a29b75 : MOV BL,0xd
00a29b77 : CMP dword ptr [ESP + 0x2c],0x0
00a29b7c : JZ 0x00a29b92
00a29b7e : CMP dword ptr [ESP + 0x20],0x0
00a29b83 : JNZ 0x00a29b8c
00a29b85 : CMP dword ptr [ESP + 0x18],0x0
00a29b8a : JZ 0x00a29b90
00a29b8c : MOV BL,0xa
00a29b8e : JMP 0x00a29b92
00a29b90 : MOV BL,0x9
00a29b92 : MOV AL,byte ptr [EDI + 0x5f8]
00a29b98 : CMP BL,AL
00a29b9a : JZ 0x00a29bb7
00a29b9c : CMP BL,0x2
00a29b9f : JZ 0x00a29baf
00a29ba1 : CMP BL,0xa
00a29ba4 : JZ 0x00a29baf
00a29ba6 : CMP BL,0x9
00a29ba9 : JZ 0x00a29baf
00a29bab : CMP AL,0x2
00a29bad : JNZ 0x00a29bb7
00a29baf : MOV dword ptr [ESP + 0x14],0x1
00a29bb7 : MOV ECX,dword ptr [ESP + 0x28]
00a29bbb : SUB ECX,dword ptr [EDI + 0x5f4]
00a29bc1 : CMP ECX,0xfa
00a29bc7 : JC 0x00a29bd1
00a29bc9 : MOV dword ptr [ESP + 0x14],0x1
00a29bd1 : MOV AL,byte ptr [EDI + 0x5f9]
00a29bd7 : CMP AL,0xd
00a29bd9 : JZ 0x00a29be4
00a29bdb : CMP AL,0xc
00a29bdd : JNZ 0x00a29be6
00a29bdf : CMP BL,0x2
00a29be2 : JNZ 0x00a29be6
00a29be4 : MOV BL,0xe
00a29be6 : CMP dword ptr [ESP + 0x14],0x0
00a29beb : MOV byte ptr [EDI + 0x5f8],BL
00a29bf1 : JZ 0x00a29cf0
00a29bf7 : XORPS XMM0,XMM0
00a29bfa : MOV EAX,dword ptr [EDI + 0x59c]
00a29c00 : LEA ESI,[ESP + 0x20]
00a29c04 : MOVSS dword ptr [ESP + 0x20],XMM0
00a29c0a : MOVSS dword ptr [ESP + 0x24],XMM0
00a29c10 : CALL 0x00889560
00a29c15 : MOVSS XMM1,dword ptr [ESP + 0x24]
00a29c1b : MOVSS XMM0,dword ptr [ESP + 0x20]
00a29c21 : CVTPS2PD XMM0,XMM0
00a29c24 : CVTPS2PD XMM1,XMM1
00a29c27 : CALL 0x00b0b091
00a29c2c : MOV EAX,FS:[0x2c]
00a29c32 : MOV ECX,dword ptr [EAX]
00a29c34 : MOVZX EAX,byte ptr [ECX + 0x18]
00a29c38 : MOV EDX,dword ptr [ESP + 0x28]
00a29c3c : MOV dword ptr [EDI + 0x5f4],EDX
00a29c42 : INC EAX
00a29c43 : CDQ
00a29c44 : MOV ESI,0x3
00a29c49 : IDIV ESI
00a29c4b : CVTSD2SS XMM0,XMM0
00a29c4f : MOV byte ptr [ECX + 0x18],DL
00a29c52 : MOVZX EDX,DL
00a29c55 : SHL EDX,0xd
00a29c58 : LEA ESI,[EDX + ECX*0x1 + 0x122cb8]
00a29c5f : MOV dword ptr [ESP + 0x2c],ESI
00a29c63 : MOV dword ptr [ESP + 0x48],0x0
00a29c6b : TEST ESI,ESI
00a29c6d : JZ 0x00a29cc9
00a29c6f : MOV EAX,dword ptr [EDI + 0x59c]
00a29c75 : MOV EAX,dword ptr [EAX + 0x4]
00a29c78 : MOV ECX,dword ptr [EDI + 0x5f4]
00a29c7e : MOV BL,byte ptr [EDI + 0x5f8]
00a29c84 : MOVSS XMM1,dword ptr [ESP + 0x30]
00a29c8a : MOVSS dword ptr [ESI + 0xc],XMM1
00a29c8f : MOVSS XMM1,dword ptr [ESP + 0x34]
00a29c95 : MOV EDX,0x2000
00a29c9a : MOVSS dword ptr [ESI + 0x10],XMM1
00a29c9f : MOVSS XMM1,dword ptr [ESP + 0x38]
00a29ca5 : MOV word ptr [ESI],DX
00a29ca8 : MOV dword ptr [ESI + 0x4],EAX
00a29cab : MOV dword ptr [ESI + 0x8],ECX
00a29cae : MOV byte ptr [ESI + 0x2],0x34
00a29cb2 : MOV byte ptr [ESI + 0x3],0xe7
00a29cb6 : MOVSS dword ptr [ESI + 0x14],XMM1
00a29cbb : CALL 0x0040de60
00a29cc0 : MOV word ptr [ESI + 0x18],AX
00a29cc4 : MOV byte ptr [ESI + 0x1a],BL
00a29cc7 : JMP 0x00a29ccb
00a29cc9 : XOR ESI,ESI
00a29ccb : MOV dword ptr [ESP + 0x48],0xffffffff
00a29cd3 : MOV ECX,dword ptr [0x017247d4]
00a29cd9 : MOV EAX,dword ptr [ECX + 0x4]
00a29cdc : TEST EAX,EAX
00a29cde : JZ 0x00a29cf0
00a29ce0 : CMP byte ptr [ECX + 0x8],0x0
00a29ce4 : JZ 0x00a29cf0
00a29ce6 : PUSH 0x1b
00a29ce8 : PUSH EAX
00a29ce9 : MOV EDI,ESI
00a29ceb : CALL 0x00a0dd40
00a29cf0 : MOV ECX,dword ptr [ESP + 0x40]
00a29cf4 : MOV dword ptr FS:[0x0],ECX
00a29cfb : POP ECX
00a29cfc : POP EDI
00a29cfd : POP ESI
00a29cfe : POP EBX
00a29cff : MOV ESP,EBP
00a29d01 : POP EBP
00a29d02 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00a810f0
ENTRY    : 00a810f0
BODY     : [[00a810f0, 00a813e5] [00a813f0, 00a81610]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a810f0(void)

{
  undefined2 uVar1;
  int iVar2;
  int iVar3;
  ulonglong uVar4;
  byte bVar5;
  char cVar6;
  undefined4 uVar7;
  int in_ECX;
  int *piVar8;
  uint8_t *puVar9;
  int iVar10;
  undefined1 local_3c [28];
  int local_20;
  uint8_t *local_1c;
  uint8_t *local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3eb76;
  local_10 = ExceptionList;
  iVar2 = *(int *)(in_ECX + 0x6c);
  if (iVar2 == 0) {
    ExceptionList = &local_10;
    FUN_008018d0(L"AvaGuiPremiumShopItemBuy::CheckOnBuyEvent Premiumshop unvisible");
    ExceptionList = local_10;
    return;
  }
  if (*(int *)(iVar2 + 0x1bc) == 2) {
    if (*(uint *)(*(int *)(DAT_0172491c + 0x17c) + 0x1ed0) < *(uint *)(in_ECX + 0x68)) {
      if (*DAT_00da9894 == 0) {
        return;
      }
      if (*(int *)(*DAT_00da9894 + 0x1a8) == 0) {
        return;
      }
      ExceptionList = &local_10;
      FUN_00406460(L"IDS_NOT_ENOUGH_GOLD");
      local_8 = 0;
      piVar8 = *(int **)(*DAT_00da9894 + 0x1a8);
      uVar7 = FUN_0081d120(local_3c);
      local_8._0_1_ = 1;
      (**(code **)(*piVar8 + 0x44))(uVar7,3);
      local_8 = (uint)local_8._1_3_ << 8;
      goto LAB_00a811df;
    }
  }
  else if (*(int *)(iVar2 + 0x1bc) == 1) {
    if (*(uint *)(iVar2 + 0x1b8) < *(uint *)(in_ECX + 0x68)) {
      if (DAT_0172491c == 0) {
        return;
      }
      if (*DAT_00da9894 == 0) {
        return;
      }
      if (*(int *)(*DAT_00da9894 + 0x1a8) == 0) {
        return;
      }
      ExceptionList = &local_10;
      FUN_00406460(L"IDS_NOT_ENOUGH_MILEAGE");
      local_8 = 2;
      piVar8 = *(int **)(*DAT_00da9894 + 0x1a8);
      uVar7 = FUN_0081d120(local_3c);
      local_8._0_1_ = 3;
      (**(code **)(*piVar8 + 0x44))(uVar7,3);
      local_8 = CONCAT31(local_8._1_3_,2);
      goto LAB_00a811df;
    }
  }
  else if (*(uint *)(iVar2 + 0x1b4) < *(uint *)(in_ECX + 0x68)) {
    ExceptionList = &local_10;
    FUN_008dcc20(DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
    ExceptionList = local_10;
    return;
  }
  local_14 = in_ECX + 0x38;
  if (*(int *)(iVar2 + 0x1bc) == 1) {
    local_14 = in_ECX + 0x48;
  }
  if (*(int *)(iVar2 + 0x1bc) == 2) {
    local_14 = in_ECX + 0x58;
  }
  ExceptionList = &local_10;
  local_20 = in_ECX;
  bVar5 = FUN_00a7ffb0();
  if (bVar5 < 0x14) {
    iVar2 = *(int *)ThreadLocalStoragePointer;
    uVar4 = (ulonglong)(*(byte *)(iVar2 + 0x18) + 1) % 3;
    local_18 = (uint8_t *)((int)uVar4 * 0x2000 + 0x122cb8 + iVar2);
    *(char *)(iVar2 + 0x18) = (char)uVar4;
    if (local_18 == (uint8_t *)0x0) {
      puVar9 = (uint8_t *)0x0;
    }
    else {
      local_18[0] = '\0';
      local_18[1] = '\0';
      local_18[2] = ';';
      local_18[3] = '-';
      local_18[4] = bVar5;
      local_18[5] = '\x01';
      puVar9 = local_18;
    }
    local_8 = 0xffffffff;
    if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
      FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),6,puVar9);
    }
    piVar8 = *(int **)(local_14 + 4);
    iVar10 = DAT_017247d4;
    if (piVar8 != *(int **)(local_14 + 8)) {
      do {
        if ((((*(char *)(*piVar8 + 0xf0) != '\0') && (*piVar8 != 0)) &&
            (cVar6 = FUN_008da580(1), iVar10 = DAT_017247d4, cVar6 != '\0')) &&
           (local_18 = (uint8_t *)0x0, *(short *)(*piVar8 + 0xd2) != 0)) {
          do {
            iVar3 = *(int *)(*(int *)(local_20 + 0x6c) + 0x1bc);
            if (iVar3 == 0) {
              bVar5 = (byte)((ulonglong)(*(byte *)(iVar2 + 0x18) + 1) % 3);
              *(byte *)(iVar2 + 0x18) = bVar5;
              puVar9 = (uint8_t *)((uint)bVar5 * 0x2000 + 0x122cb8 + iVar2);
              local_1c = puVar9;
              if (puVar9 == (uint8_t *)0x0) {
LAB_00a81550:
                puVar9 = (uint8_t *)0x0;
              }
              else {
                uVar7 = *(undefined4 *)(*piVar8 + 0x78);
                uVar1 = *(undefined2 *)(*piVar8 + 0xe4);
                puVar9[0] = '\0';
                iVar10 = DAT_017247d4;
                puVar9[1] = '\0';
                puVar9[2] = ';';
                puVar9[3] = '.';
                *(undefined2 *)(puVar9 + 4) = uVar1;
                puVar9[6] = 0xff;
                puVar9[7] = 0xff;
                puVar9[8] = 0xff;
                puVar9[9] = 0xff;
                *(undefined4 *)(puVar9 + 10) = uVar7;
                puVar9[0xe] = '\x01';
                puVar9[0xf] = '\0';
                puVar9[0x10] = '\0';
                puVar9[0x11] = '\0';
                puVar9[0x12] = '\x01';
              }
LAB_00a81552:
              local_8 = 0xffffffff;
              if ((*(int *)(iVar10 + 4) != 0) && (*(char *)(iVar10 + 8) != '\0')) {
                FUN_00a0dd40(*(int *)(iVar10 + 4),0x13,puVar9);
                iVar10 = DAT_017247d4;
              }
            }
            else {
              if (iVar3 == 1) {
                bVar5 = (byte)((ulonglong)(*(byte *)(iVar2 + 0x18) + 1) % 3);
                *(byte *)(iVar2 + 0x18) = bVar5;
                puVar9 = (uint8_t *)((uint)bVar5 * 0x2000 + 0x122cb8 + iVar2);
                local_1c = puVar9;
                if (puVar9 == (uint8_t *)0x0) goto LAB_00a81550;
                uVar7 = *(undefined4 *)(*piVar8 + 0x80);
                uVar1 = *(undefined2 *)(*piVar8 + 0xe4);
                puVar9[0] = '\0';
                iVar10 = DAT_017247d4;
                puVar9[1] = '\0';
                puVar9[2] = ';';
                puVar9[3] = '.';
                *(undefined2 *)(puVar9 + 4) = uVar1;
                puVar9[6] = 0xff;
                puVar9[7] = 0xff;
                puVar9[8] = 0xff;
                puVar9[9] = 0xff;
                *(undefined4 *)(puVar9 + 10) = uVar7;
                puVar9[0xe] = '\x01';
                puVar9[0xf] = '\0';
                puVar9[0x10] = '\0';
                puVar9[0x11] = '\0';
                puVar9[0x12] = '\x02';
                goto LAB_00a81552;
              }
              if (iVar3 == 2) {
                local_1c = (uint8_t *)FUN_006f4590();
                local_8 = 9;
                if (local_1c == (uint8_t *)0x0) goto LAB_00a81550;
                puVar9 = (uint8_t *)FUN_0042daa0(0xffffffff,*(undefined4 *)(*piVar8 + 0x8c),3);
                goto LAB_00a81552;
              }
            }
            local_18 = local_18 + 1;
          } while ((int)local_18 < (int)(uint)*(ushort *)(*piVar8 + 0xd2));
        }
        piVar8 = piVar8 + 1;
      } while (piVar8 != *(int **)(local_14 + 8));
    }
    bVar5 = (byte)((ulonglong)(*(byte *)(iVar2 + 0x18) + 1) % 3);
    *(byte *)(iVar2 + 0x18) = bVar5;
    local_1c = (uint8_t *)((uint)bVar5 * 0x2000 + 0x122cb8 + iVar2);
    if (local_1c == (uint8_t *)0x0) {
      puVar9 = (uint8_t *)0x0;
    }
    else {
      local_1c[0] = '\0';
      local_1c[1] = '\0';
      local_1c[2] = ';';
      local_1c[3] = '/';
      puVar9 = local_1c;
    }
    local_8 = 0xffffffff;
    if ((*(int *)(iVar10 + 4) != 0) && (*(char *)(iVar10 + 8) != '\0')) {
      FUN_00a0dd40(*(int *)(iVar10 + 4),4,puVar9);
    }
  }
  else if (((DAT_0172491c != 0) && (*DAT_00da9894 != 0)) && (*(int *)(*DAT_00da9894 + 0x1a8) != 0))
  {
    FUN_00406460(L"IDS_PREMIUMSHOP_TOO_MANY_ITEM_BUY_REQUEST");
    local_8 = 4;
    piVar8 = *(int **)(*DAT_00da9894 + 0x1a8);
    uVar7 = FUN_0081d120(local_3c);
    local_8._0_1_ = 5;
    (**(code **)(*piVar8 + 0x44))(uVar7,3);
    local_8 = CONCAT31(local_8._1_3_,4);
LAB_00a811df:
    FUN_00406560();
    local_8 = 0xffffffff;
    FUN_00406560();
    ExceptionList = local_10;
    return;
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00a810f0 : PUSH EBP
00a810f1 : MOV EBP,ESP
00a810f3 : PUSH -0x1
00a810f5 : PUSH 0xb3eb76
00a810fa : MOV EAX,FS:[0x0]
00a81100 : PUSH EAX
00a81101 : SUB ESP,0x4c
00a81104 : PUSH EBX
00a81105 : PUSH ESI
00a81106 : PUSH EDI
00a81107 : MOV EAX,[0x00d66fa0]
00a8110c : XOR EAX,EBP
00a8110e : PUSH EAX
00a8110f : LEA EAX,[EBP + -0xc]
00a81112 : MOV FS:[0x0],EAX
00a81118 : MOV EDI,ECX
00a8111a : MOV ECX,dword ptr [EDI + 0x6c]
00a8111d : MOV dword ptr [EBP + -0x1c],EDI
00a81120 : TEST ECX,ECX
00a81122 : JNZ 0x00a81149
00a81124 : MOV ESI,dword ptr [0x00da98e8]
00a8112a : PUSH 0xc551c8
00a8112f : CALL 0x008018d0
00a81134 : ADD ESP,0x4
00a81137 : MOV ECX,dword ptr [EBP + -0xc]
00a8113a : MOV dword ptr FS:[0x0],ECX
00a81141 : POP ECX
00a81142 : POP EDI
00a81143 : POP ESI
00a81144 : POP EBX
00a81145 : MOV ESP,EBP
00a81147 : POP EBP
00a81148 : RET
00a81149 : MOV EAX,ECX
00a8114b : MOV EDX,dword ptr [EAX + 0x1b4]
00a81151 : MOV EAX,dword ptr [EAX + 0x1bc]
00a81157 : CMP EAX,0x2
00a8115a : JNZ 0x00a81208
00a81160 : MOV EAX,[0x0172491c]
00a81165 : MOV EAX,dword ptr [EAX + 0x17c]
00a8116b : MOV EAX,dword ptr [EAX + 0x1ed0]
00a81171 : CMP dword ptr [EDI + 0x68],EAX
00a81174 : JBE 0x00a812b7
00a8117a : MOV ECX,dword ptr [0x00da9894]
00a81180 : MOV EAX,dword ptr [ECX]
00a81182 : TEST EAX,EAX
00a81184 : JZ 0x00a815ff
00a8118a : CMP dword ptr [EAX + 0x1a8],0x0
00a81191 : JZ 0x00a815ff
00a81197 : PUSH 0xc55248
00a8119c : LEA ECX,[EBP + -0x38]
00a8119f : CALL 0x00406460
00a811a4 : MOV dword ptr [EBP + -0x4],0x0
00a811ab : MOV EDX,dword ptr [0x00da9894]
00a811b1 : MOV EAX,dword ptr [EDX]
00a811b3 : MOV ESI,dword ptr [EAX + 0x1a8]
00a811b9 : MOV ECX,dword ptr [0x0172491c]
00a811bf : LEA EAX,[EBP + -0x38]
00a811c2 : PUSH EAX
00a811c3 : LEA EDI,[EBP + -0x54]
00a811c6 : CALL 0x0081d120
00a811cb : MOV byte ptr [EBP + -0x4],0x1
00a811cf : MOV EDX,dword ptr [ESI]
00a811d1 : PUSH 0x3
00a811d3 : PUSH EAX
00a811d4 : MOV EAX,dword ptr [EDX + 0x44]
00a811d7 : MOV ECX,ESI
00a811d9 : CALL EAX
00a811db : MOV byte ptr [EBP + -0x4],0x0
00a811df : LEA ECX,[EBP + -0x54]
00a811e2 : CALL 0x00406560
00a811e7 : MOV dword ptr [EBP + -0x4],0xffffffff
00a811ee : LEA ECX,[EBP + -0x38]
00a811f1 : CALL 0x00406560
00a811f6 : MOV ECX,dword ptr [EBP + -0xc]
00a811f9 : MOV dword ptr FS:[0x0],ECX
00a81200 : POP ECX
00a81201 : POP EDI
00a81202 : POP ESI
00a81203 : POP EBX
00a81204 : MOV ESP,EBP
00a81206 : POP EBP
00a81207 : RET
00a81208 : CMP dword ptr [ECX + 0x1bc],0x1
00a8120f : JNZ 0x00a8129b
00a81215 : MOV EAX,dword ptr [ECX + 0x1b8]
00a8121b : CMP dword ptr [EDI + 0x68],EAX
00a8121e : JBE 0x00a812b7
00a81224 : CMP dword ptr [0x0172491c],0x0
00a8122b : JZ 0x00a815ff
00a81231 : MOV ECX,dword ptr [0x00da9894]
00a81237 : MOV EAX,dword ptr [ECX]
00a81239 : TEST EAX,EAX
00a8123b : JZ 0x00a815ff
00a81241 : CMP dword ptr [EAX + 0x1a8],0x0
00a81248 : JZ 0x00a815ff
00a8124e : PUSH 0xc55270
00a81253 : LEA ECX,[EBP + -0x38]
00a81256 : CALL 0x00406460
00a8125b : MOV dword ptr [EBP + -0x4],0x2
00a81262 : MOV EDX,dword ptr [0x00da9894]
00a81268 : MOV EAX,dword ptr [EDX]
00a8126a : MOV ESI,dword ptr [EAX + 0x1a8]
00a81270 : MOV ECX,dword ptr [0x0172491c]
00a81276 : LEA EAX,[EBP + -0x38]
00a81279 : PUSH EAX
00a8127a : LEA EDI,[EBP + -0x54]
00a8127d : CALL 0x0081d120
00a81282 : MOV byte ptr [EBP + -0x4],0x3
00a81286 : MOV EDX,dword ptr [ESI]
00a81288 : PUSH 0x3
00a8128a : PUSH EAX
00a8128b : MOV EAX,dword ptr [EDX + 0x44]
00a8128e : MOV ECX,ESI
00a81290 : CALL EAX
00a81292 : MOV byte ptr [EBP + -0x4],0x2
00a81296 : JMP 0x00a811df
00a8129b : CMP dword ptr [EDI + 0x68],EDX
00a8129e : JBE 0x00a812b7
00a812a0 : CALL 0x008dcc20
00a812a5 : MOV ECX,dword ptr [EBP + -0xc]
00a812a8 : MOV dword ptr FS:[0x0],ECX
00a812af : POP ECX
00a812b0 : POP EDI
00a812b1 : POP ESI
00a812b2 : POP EBX
00a812b3 : MOV ESP,EBP
00a812b5 : POP EBP
00a812b6 : RET
00a812b7 : MOV ECX,dword ptr [ECX + 0x1bc]
00a812bd : LEA EDX,[EDI + 0x38]
00a812c0 : MOV dword ptr [EBP + -0x10],EDX
00a812c3 : CMP ECX,0x1
00a812c6 : JNZ 0x00a812ce
00a812c8 : LEA EAX,[EDI + 0x48]
00a812cb : MOV dword ptr [EBP + -0x10],EAX
00a812ce : CMP ECX,0x2
00a812d1 : JNZ 0x00a812d9
00a812d3 : LEA ECX,[EDI + 0x58]
00a812d6 : MOV dword ptr [EBP + -0x10],ECX
00a812d9 : CALL 0x00a7ffb0
00a812de : MOV CL,AL
00a812e0 : CMP CL,0x14
00a812e3 : JC 0x00a8135b
00a812e5 : CMP dword ptr [0x0172491c],0x0
00a812ec : JZ 0x00a815ff
00a812f2 : MOV EDX,dword ptr [0x00da9894]
00a812f8 : MOV EAX,dword ptr [EDX]
00a812fa : TEST EAX,EAX
00a812fc : JZ 0x00a815ff
00a81302 : CMP dword ptr [EAX + 0x1a8],0x0
00a81309 : JZ 0x00a815ff
00a8130f : PUSH 0xc552a0
00a81314 : LEA ECX,[EBP + -0x38]
00a81317 : CALL 0x00406460
00a8131c : MOV dword ptr [EBP + -0x4],0x4
00a81323 : MOV EAX,[0x00da9894]
00a81328 : MOV EAX,dword ptr [EAX]
00a8132a : MOV ESI,dword ptr [EAX + 0x1a8]
00a81330 : LEA ECX,[EBP + -0x38]
00a81333 : PUSH ECX
00a81334 : MOV ECX,dword ptr [0x0172491c]
00a8133a : LEA EDI,[EBP + -0x54]
00a8133d : CALL 0x0081d120
00a81342 : MOV byte ptr [EBP + -0x4],0x5
00a81346 : MOV EDX,dword ptr [ESI]
00a81348 : PUSH 0x3
00a8134a : PUSH EAX
00a8134b : MOV EAX,dword ptr [EDX + 0x44]
00a8134e : MOV ECX,ESI
00a81350 : CALL EAX
00a81352 : MOV byte ptr [EBP + -0x4],0x4
00a81356 : JMP 0x00a811df
00a8135b : MOV EDX,dword ptr FS:[0x2c]
00a81362 : MOV ESI,dword ptr [EDX]
00a81364 : MOVZX EAX,byte ptr [ESI + 0x18]
00a81368 : INC EAX
00a81369 : CDQ
00a8136a : MOV EDI,0x3
00a8136f : IDIV EDI
00a81371 : MOVZX EAX,DL
00a81374 : SHL EAX,0xd
00a81377 : LEA EAX,[EAX + ESI*0x1 + 0x122cb8]
00a8137e : MOV byte ptr [ESI + 0x18],DL
00a81381 : MOV dword ptr [EBP + -0x14],EAX
00a81384 : MOV dword ptr [EBP + -0x4],0x6
00a8138b : TEST EAX,EAX
00a8138d : JZ 0x00a813a5
00a8138f : XOR EDX,EDX
00a81391 : MOV word ptr [EAX],DX
00a81394 : MOV byte ptr [EAX + 0x2],0x3b
00a81398 : MOV byte ptr [EAX + 0x3],0x2d
00a8139c : MOV byte ptr [EAX + 0x4],CL
00a8139f : MOV byte ptr [EAX + 0x5],0x1
00a813a3 : JMP 0x00a813a7
00a813a5 : XOR EAX,EAX
00a813a7 : MOV dword ptr [EBP + -0x4],0xffffffff
00a813ae : MOV EDI,dword ptr [0x017247d4]
00a813b4 : MOV ECX,dword ptr [EDI + 0x4]
00a813b7 : TEST ECX,ECX
00a813b9 : JZ 0x00a813d1
00a813bb : CMP byte ptr [EDI + 0x8],0x0
00a813bf : JZ 0x00a813d1
00a813c1 : PUSH 0x6
00a813c3 : PUSH ECX
00a813c4 : MOV EDI,EAX
00a813c6 : CALL 0x00a0dd40
00a813cb : MOV EDI,dword ptr [0x017247d4]
00a813d1 : MOV EAX,dword ptr [EBP + -0x10]
00a813d4 : MOV EBX,dword ptr [EAX + 0x4]
00a813d7 : MOV ECX,EAX
00a813d9 : MOV EAX,dword ptr [ECX + 0x8]
00a813dc : CMP EBX,EAX
00a813de : JZ 0x00a815a5
00a813e4 : JMP 0x00a813f0
00a813f0 : MOV EDX,dword ptr [EBX]
00a813f2 : CMP byte ptr [EDX + 0xf0],0x0
00a813f9 : JZ 0x00a81596
00a813ff : TEST EDX,EDX
00a81401 : JZ 0x00a81596
00a81407 : PUSH 0x1
00a81409 : CALL 0x008da580
00a8140e : TEST AL,AL
00a81410 : JZ 0x00a81590
00a81416 : MOV EDX,dword ptr [EBX]
00a81418 : XOR EAX,EAX
00a8141a : MOV dword ptr [EBP + -0x14],0x0
00a81421 : CMP AX,word ptr [EDX + 0xd2]
00a81428 : JNC 0x00a81590
00a8142e : MOV EDI,dword ptr [0x017247d4]
00a81434 : MOV ECX,dword ptr [EBP + -0x1c]
00a81437 : MOV EDX,dword ptr [ECX + 0x6c]
00a8143a : MOV EAX,dword ptr [EDX + 0x1bc]
00a81440 : TEST EAX,EAX
00a81442 : JNZ 0x00a814b0
00a81444 : MOVZX EAX,byte ptr [ESI + 0x18]
00a81448 : INC EAX
00a81449 : CDQ
00a8144a : MOV ECX,0x3
00a8144f : IDIV ECX
00a81451 : MOV byte ptr [ESI + 0x18],DL
00a81454 : MOVZX EDX,DL
00a81457 : SHL EDX,0xd
00a8145a : LEA EAX,[EDX + ESI*0x1 + 0x122cb8]
00a81461 : MOV dword ptr [EBP + -0x18],EAX
00a81464 : MOV dword ptr [EBP + -0x4],0x7
00a8146b : TEST EAX,EAX
00a8146d : JZ 0x00a81550
00a81473 : MOV ECX,dword ptr [EBX]
00a81475 : MOV EDX,dword ptr [ECX + 0x78]
00a81478 : MOVZX ECX,word ptr [ECX + 0xe4]
00a8147f : XOR EDI,EDI
00a81481 : MOV word ptr [EAX],DI
00a81484 : MOV EDI,dword ptr [0x017247d4]
00a8148a : MOV byte ptr [EAX + 0x2],0x3b
00a8148e : MOV byte ptr [EAX + 0x3],0x2e
00a81492 : MOV word ptr [EAX + 0x4],CX
00a81496 : MOV dword ptr [EAX + 0x6],0xffffffff
00a8149d : MOV dword ptr [EAX + 0xa],EDX
00a814a0 : MOV dword ptr [EAX + 0xe],0x1
00a814a7 : MOV byte ptr [EAX + 0x12],0x1
00a814ab : JMP 0x00a81552
00a814b0 : CMP EAX,0x1
00a814b3 : JNZ 0x00a8151d
00a814b5 : MOVZX EAX,byte ptr [ESI + 0x18]
00a814b9 : INC EAX
00a814ba : CDQ
00a814bb : MOV ECX,0x3
00a814c0 : IDIV ECX
00a814c2 : MOV byte ptr [ESI + 0x18],DL
00a814c5 : MOVZX EDX,DL
00a814c8 : SHL EDX,0xd
00a814cb : LEA EAX,[EDX + ESI*0x1 + 0x122cb8]
00a814d2 : MOV dword ptr [EBP + -0x18],EAX
00a814d5 : MOV dword ptr [EBP + -0x4],0x8
00a814dc : TEST EAX,EAX
00a814de : JZ 0x00a81550
00a814e0 : MOV ECX,dword ptr [EBX]
00a814e2 : MOV EDX,dword ptr [ECX + 0x80]
00a814e8 : MOVZX ECX,word ptr [ECX + 0xe4]
00a814ef : XOR EDI,EDI
00a814f1 : MOV word ptr [EAX],DI
00a814f4 : MOV EDI,dword ptr [0x017247d4]
00a814fa : MOV byte ptr [EAX + 0x2],0x3b
00a814fe : MOV byte ptr [EAX + 0x3],0x2e
00a81502 : MOV word ptr [EAX + 0x4],CX
00a81506 : MOV dword ptr [EAX + 0x6],0xffffffff
00a8150d : MOV dword ptr [EAX + 0xa],EDX
00a81510 : MOV dword ptr [EAX + 0xe],0x1
00a81517 : MOV byte ptr [EAX + 0x12],0x2
00a8151b : JMP 0x00a81552
00a8151d : CMP EAX,0x2
00a81520 : JNZ 0x00a81576
00a81522 : CALL 0x006f4590
00a81527 : MOV dword ptr [EBP + -0x18],EAX
00a8152a : MOV dword ptr [EBP + -0x4],0x9
00a81531 : TEST EAX,EAX
00a81533 : JZ 0x00a81550
00a81535 : MOV ECX,dword ptr [EBX]
00a81537 : MOV EDX,dword ptr [ECX + 0x8c]
00a8153d : PUSH 0x3
00a8153f : PUSH EDX
00a81540 : MOV DX,word ptr [ECX + 0xe4]
00a81547 : PUSH -0x1
00a81549 : CALL 0x0042daa0
00a8154e : JMP 0x00a81552
00a81550 : XOR EAX,EAX
00a81552 : MOV dword ptr [EBP + -0x4],0xffffffff
00a81559 : MOV ECX,dword ptr [EDI + 0x4]
00a8155c : TEST ECX,ECX
00a8155e : JZ 0x00a81576
00a81560 : CMP byte ptr [EDI + 0x8],0x0
00a81564 : JZ 0x00a81576
00a81566 : PUSH 0x13
00a81568 : PUSH ECX
00a81569 : MOV EDI,EAX
00a8156b : CALL 0x00a0dd40
00a81570 : MOV EDI,dword ptr [0x017247d4]
00a81576 : MOV ECX,dword ptr [EBX]
00a81578 : MOV EAX,dword ptr [EBP + -0x14]
00a8157b : MOVZX EDX,word ptr [ECX + 0xd2]
00a81582 : INC EAX
00a81583 : CMP EAX,EDX
00a81585 : MOV dword ptr [EBP + -0x14],EAX
00a81588 : JL 0x00a81434
00a8158e : JMP 0x00a81596
00a81590 : MOV EDI,dword ptr [0x017247d4]
00a81596 : MOV EAX,dword ptr [EBP + -0x10]
00a81599 : ADD EBX,0x4
00a8159c : CMP EBX,dword ptr [EAX + 0x8]
00a8159f : JNZ 0x00a813f0
00a815a5 : MOVZX EAX,byte ptr [ESI + 0x18]
00a815a9 : INC EAX
00a815aa : CDQ
00a815ab : MOV ECX,0x3
00a815b0 : IDIV ECX
00a815b2 : MOV byte ptr [ESI + 0x18],DL
00a815b5 : MOVZX EDX,DL
00a815b8 : SHL EDX,0xd
00a815bb : LEA ESI,[EDX + ESI*0x1 + 0x122cb8]
00a815c2 : MOV dword ptr [EBP + -0x18],ESI
00a815c5 : MOV dword ptr [EBP + -0x4],0xa
00a815cc : TEST ESI,ESI
00a815ce : JZ 0x00a815df
00a815d0 : XOR EAX,EAX
00a815d2 : MOV word ptr [ESI],AX
00a815d5 : MOV byte ptr [ESI + 0x2],0x3b
00a815d9 : MOV byte ptr [ESI + 0x3],0x2f
00a815dd : JMP 0x00a815e1
00a815df : XOR ESI,ESI
00a815e1 : MOV dword ptr [EBP + -0x4],0xffffffff
00a815e8 : MOV EAX,dword ptr [EDI + 0x4]
00a815eb : TEST EAX,EAX
00a815ed : JZ 0x00a815ff
00a815ef : CMP byte ptr [EDI + 0x8],0x0
00a815f3 : JZ 0x00a815ff
00a815f5 : PUSH 0x4
00a815f7 : PUSH EAX
00a815f8 : MOV EDI,ESI
00a815fa : CALL 0x00a0dd40
00a815ff : MOV ECX,dword ptr [EBP + -0xc]
00a81602 : MOV dword ptr FS:[0x0],ECX
00a81609 : POP ECX
00a8160a : POP EDI
00a8160b : POP ESI
00a8160c : POP EBX
00a8160d : MOV ESP,EBP
00a8160f : POP EBP
00a81610 : RET

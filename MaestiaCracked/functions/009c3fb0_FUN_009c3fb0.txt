PROGRAM  : Maestia.exe
FUNCTION : FUN_009c3fb0
ENTRY    : 009c3fb0
BODY     : [[009c3fb0, 009c40c9] [009c40d0, 009c4456]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009c3fb0(int param_1,int param_2)

{
  short sVar1;
  char cVar2;
  short *psVar3;
  wchar_t *_Source;
  uint8_t *packet;
  int iVar4;
  undefined4 *puVar5;
  short *psVar6;
  undefined1 auStack_3f8 [12];
  undefined4 uStack_3ec;
  undefined1 auStack_3cc [4];
  wchar_t *local_3c8;
  int local_3c4;
  undefined2 local_3bc;
  undefined4 local_3ac;
  uint local_3a8;
  undefined1 *local_3a4;
  undefined2 local_39c;
  undefined4 local_38c;
  uint local_388;
  undefined2 local_380;
  undefined4 local_370;
  uint local_36c;
  short local_368 [164];
  wchar_t local_220 [255];
  undefined2 local_22;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  int local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b41bbd;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_3cc;
  ExceptionList = &local_14;
  local_3c4 = param_1;
  if (*(int *)(param_2 + 0x14) == 0) {
    FUN_00406460();
    local_c = 0;
    FUN_0081d120();
    local_c._0_1_ = 1;
    FUN_008ede80();
    local_c = (uint)local_c._1_3_ << 8;
    if (7 < local_36c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_36c = 7;
    local_370 = 0;
    local_380 = 0;
    local_c = 0xffffffff;
    if (7 < local_388) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_388 = 7;
    local_38c = 0;
    local_39c = 0;
  }
  else if (*(int *)(param_2 + 0x14) - 2U < 0x12) {
    psVar3 = local_368;
    puVar5 = &DAT_00c919b0;
    psVar6 = local_368;
    for (iVar4 = 0x11; iVar4 != 0; iVar4 = iVar4 + -1) {
      *(undefined4 *)psVar6 = *puVar5;
      puVar5 = puVar5 + 1;
      psVar6 = psVar6 + 2;
    }
    do {
      sVar1 = *psVar3;
      psVar3 = psVar3 + 1;
    } while (sVar1 != 0);
    iVar4 = FUN_00403c70();
    if (iVar4 == -1) {
      local_3c8 = (wchar_t *)(param_2 + 4);
      _Source = local_3c8;
      if (7 < *(uint *)(param_2 + 0x18)) {
        _Source = *(wchar_t **)local_3c8;
      }
      uStack_3ec = 0x9c4182;
      _wcsncpy(local_220,_Source,0xff);
      local_22 = 0;
      FUN_00411e30();
      cVar2 = FUN_0081bbb0();
      if (cVar2 == '\0') {
        local_3a4 = auStack_3f8;
        FUN_00405660(param_2);
        local_c = 0xffffffff;
        cVar2 = FUN_0081c5e0();
        if (cVar2 == '\0') {
          if ((DAT_0172491c != 0) && (*DAT_00da9894 != 0)) {
            FUN_00406460();
            local_c = 0xd;
            FUN_0081d120();
            local_c._0_1_ = 0xe;
            FUN_008ede80();
            local_c = CONCAT31(local_c._1_3_,0xd);
            FUN_00406560();
            local_c = 0xffffffff;
            FUN_00406560();
          }
        }
        else {
          local_3a4 = (undefined1 *)FUN_006f4590();
          local_c = 0xc;
          if (local_3a4 == (undefined1 *)0x0) {
            packet = (uint8_t *)0x0;
          }
          else {
            packet = (uint8_t *)FUN_0041daa0();
          }
          local_c = 0xffffffff;
          if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
            FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),0x58,packet);
            *(undefined4 *)(local_3c4 + 0x99c) = 0xffffffff;
            goto LAB_009c4431;
          }
        }
        *(undefined4 *)(local_3c4 + 0x99c) = 0xffffffff;
      }
      else {
        FUN_00406460();
        local_c = 9;
        FUN_0081d120();
        local_c._0_1_ = 10;
        FUN_008ede80();
        local_c = CONCAT31(local_c._1_3_,9);
        FUN_00406560();
        local_c = 0xffffffff;
        FUN_00406560();
      }
    }
    else {
      FUN_00406460();
      local_c = 7;
      FUN_0081d120();
      local_c._0_1_ = 8;
      FUN_008ede80();
      local_c = CONCAT31(local_c._1_3_,7);
      FUN_00406560();
      local_c = 0xffffffff;
      FUN_00406560();
    }
  }
  else {
    FUN_00406460();
    local_c = 2;
    FUN_0081d120();
    local_c._0_1_ = 3;
    uStack_3ec = 0x9c43a0;
    FUN_00404750();
    local_c = CONCAT31(local_c._1_3_,5);
    if (7 < local_3a8) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_3a8 = 7;
    local_3ac = 0;
    local_3bc = 0;
    local_c = CONCAT31(local_c._1_3_,6);
    if (7 < local_388) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_39c = 0;
    local_388 = 7;
    local_38c = 0;
    FUN_008ede80();
    local_c = 0xffffffff;
    if (7 < local_36c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_36c = 7;
    local_370 = 0;
    local_380 = 0;
  }
LAB_009c4431:
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_3cc);
  return;
}



============================================================
DISASSEMBLY
============================================================
009c3fb0 : PUSH EBP
009c3fb1 : MOV EBP,ESP
009c3fb3 : AND ESP,0xfffffff8
009c3fb6 : PUSH -0x1
009c3fb8 : PUSH 0xb41bbd
009c3fbd : MOV EAX,FS:[0x0]
009c3fc3 : PUSH EAX
009c3fc4 : SUB ESP,0x3b8
009c3fca : MOV EAX,[0x00d66fa0]
009c3fcf : XOR EAX,ESP
009c3fd1 : MOV dword ptr [ESP + 0x3b0],EAX
009c3fd8 : PUSH EBX
009c3fd9 : PUSH ESI
009c3fda : PUSH EDI
009c3fdb : MOV EAX,[0x00d66fa0]
009c3fe0 : XOR EAX,ESP
009c3fe2 : PUSH EAX
009c3fe3 : LEA EAX,[ESP + 0x3c8]
009c3fea : MOV FS:[0x0],EAX
009c3ff0 : MOV EAX,dword ptr [EBP + 0x8]
009c3ff3 : MOV EBX,dword ptr [EBP + 0xc]
009c3ff6 : MOV dword ptr [ESP + 0x18],EAX
009c3ffa : MOV EAX,dword ptr [EBX + 0x14]
009c3ffd : XOR ESI,ESI
009c3fff : CMP EAX,ESI
009c4001 : JNZ 0x009c40a5
009c4007 : PUSH 0xc918cc
009c400c : LEA ECX,[ESP + 0x40]
009c4010 : CALL 0x00406460
009c4015 : MOV dword ptr [ESP + 0x3d0],ESI
009c401c : LEA ECX,[ESP + 0x3c]
009c4020 : PUSH ECX
009c4021 : MOV ECX,dword ptr [0x0172491c]
009c4027 : LEA EDI,[ESP + 0x5c]
009c402b : CALL 0x0081d120
009c4030 : MOV byte ptr [ESP + 0x3d0],0x1
009c4038 : MOV EDX,dword ptr [0x00da9894]
009c403e : MOV ECX,dword ptr [EDX]
009c4040 : PUSH ESI
009c4041 : PUSH EAX
009c4042 : CALL 0x008ede80
009c4047 : MOV byte ptr [ESP + 0x3d0],0x0
009c404f : MOV EDI,0x8
009c4054 : CMP dword ptr [ESP + 0x70],EDI
009c4058 : JC 0x009c4063
009c405a : MOV ECX,dword ptr [ESP + 0x5c]
009c405e : CALL 0x006f04e0
009c4063 : MOV EBX,0x7
009c4068 : XOR EAX,EAX
009c406a : MOV dword ptr [ESP + 0x70],EBX
009c406e : MOV dword ptr [ESP + 0x6c],ESI
009c4072 : MOV word ptr [ESP + 0x5c],AX
009c4077 : MOV dword ptr [ESP + 0x3d0],0xffffffff
009c4082 : CMP dword ptr [ESP + 0x54],EDI
009c4086 : JC 0x009c4091
009c4088 : MOV ECX,dword ptr [ESP + 0x40]
009c408c : CALL 0x006f04e0
009c4091 : XOR ECX,ECX
009c4093 : MOV dword ptr [ESP + 0x54],EBX
009c4097 : MOV dword ptr [ESP + 0x50],ESI
009c409b : MOV word ptr [ESP + 0x40],CX
009c40a0 : JMP 0x009c4431
009c40a5 : ADD EAX,-0x2
009c40a8 : CMP EAX,0x11
009c40ab : JA 0x009c434b
009c40b1 : MOV ECX,0x11
009c40b6 : MOV ESI,0xc919b0
009c40bb : LEA EDI,[ESP + 0x74]
009c40bf : LEA EAX,[ESP + 0x74]
009c40c3 : MOVSD.REP ES:EDI,ESI
009c40c5 : LEA EDX,[EAX + 0x2]
009c40c8 : JMP 0x009c40d0
009c40d0 : MOV CX,word ptr [EAX]
009c40d3 : ADD EAX,0x2
009c40d6 : TEST CX,CX
009c40d9 : JNZ 0x009c40d0
009c40db : SUB EAX,EDX
009c40dd : SAR EAX,0x1
009c40df : PUSH EAX
009c40e0 : LEA EDX,[ESP + 0x78]
009c40e4 : PUSH EDX
009c40e5 : XOR EDX,EDX
009c40e7 : MOV EAX,EBX
009c40e9 : CALL 0x00403c70
009c40ee : CMP EAX,-0x1
009c40f1 : JZ 0x009c4160
009c40f3 : PUSH 0xc919f4
009c40f8 : LEA ECX,[ESP + 0x20]
009c40fc : CALL 0x00406460
009c4101 : MOV EBX,0x7
009c4106 : MOV dword ptr [ESP + 0x3d0],EBX
009c410d : MOV ECX,dword ptr [0x0172491c]
009c4113 : LEA EAX,[ESP + 0x1c]
009c4117 : PUSH EAX
009c4118 : LEA EDI,[ESP + 0x5c]
009c411c : CALL 0x0081d120
009c4121 : MOV byte ptr [ESP + 0x3d0],0x8
009c4129 : MOV ECX,dword ptr [0x00da9894]
009c412f : MOV ECX,dword ptr [ECX]
009c4131 : PUSH 0x0
009c4133 : PUSH EAX
009c4134 : CALL 0x008ede80
009c4139 : MOV byte ptr [ESP + 0x3d0],BL
009c4140 : MOV ECX,EDI
009c4142 : CALL 0x00406560
009c4147 : MOV dword ptr [ESP + 0x3d0],0xffffffff
009c4152 : LEA ECX,[ESP + 0x1c]
009c4156 : CALL 0x00406560
009c415b : JMP 0x009c4431
009c4160 : CMP dword ptr [EBX + 0x18],0x8
009c4164 : LEA EAX,[EBX + 0x4]
009c4167 : MOV dword ptr [ESP + 0x14],EAX
009c416b : JC 0x009c416f
009c416d : MOV EAX,dword ptr [EAX]
009c416f : PUSH 0xff
009c4174 : PUSH EAX
009c4175 : LEA EDX,[ESP + 0x1c4]
009c417c : PUSH EDX
009c417d : CALL 0x00634e39
009c4182 : XOR EAX,EAX
009c4184 : ADD ESP,0xc
009c4187 : LEA EDI,[ESP + 0xbc]
009c418e : LEA EDX,[ESP + 0x1bc]
009c4195 : MOV word ptr [ESP + 0x3ba],AX
009c419d : CALL 0x00411e30
009c41a2 : MOV ESI,EDI
009c41a4 : CALL 0x0081bbb0
009c41a9 : TEST AL,AL
009c41ab : JZ 0x009c421a
009c41ad : PUSH 0xc91a2c
009c41b2 : LEA ECX,[ESP + 0x20]
009c41b6 : CALL 0x00406460
009c41bb : MOV EBX,0x9
009c41c0 : MOV dword ptr [ESP + 0x3d0],EBX
009c41c7 : LEA ECX,[ESP + 0x1c]
009c41cb : PUSH ECX
009c41cc : MOV ECX,dword ptr [0x0172491c]
009c41d2 : LEA EDI,[ESP + 0x5c]
009c41d6 : CALL 0x0081d120
009c41db : MOV byte ptr [ESP + 0x3d0],0xa
009c41e3 : MOV EDX,dword ptr [0x00da9894]
009c41e9 : MOV ECX,dword ptr [EDX]
009c41eb : PUSH 0x0
009c41ed : PUSH EAX
009c41ee : CALL 0x008ede80
009c41f3 : MOV byte ptr [ESP + 0x3d0],BL
009c41fa : MOV ECX,EDI
009c41fc : CALL 0x00406560
009c4201 : MOV dword ptr [ESP + 0x3d0],0xffffffff
009c420c : LEA ECX,[ESP + 0x1c]
009c4210 : CALL 0x00406560
009c4215 : JMP 0x009c4431
009c421a : SUB ESP,0x1c
009c421d : MOV ECX,ESP
009c421f : MOV dword ptr [ESP + 0x54],ESP
009c4223 : PUSH EBX
009c4224 : CALL 0x00405660
009c4229 : MOV dword ptr [ESP + 0x3ec],0xb
009c4234 : OR ESI,0xffffffff
009c4237 : MOV dword ptr [ESP + 0x3ec],ESI
009c423e : CALL 0x0081c5e0
009c4243 : TEST AL,AL
009c4245 : JZ 0x009c42c4
009c4247 : CALL 0x006f4590
009c424c : MOV dword ptr [ESP + 0x38],EAX
009c4250 : MOV dword ptr [ESP + 0x3d0],0xc
009c425b : TEST EAX,EAX
009c425d : JZ 0x009c4287
009c425f : CMP dword ptr [EBX + 0x18],0x8
009c4263 : JC 0x009c426d
009c4265 : MOV ECX,dword ptr [ESP + 0x14]
009c4269 : MOV EDX,dword ptr [ECX]
009c426b : JMP 0x009c4271
009c426d : MOV EDX,dword ptr [ESP + 0x14]
009c4271 : MOV ECX,dword ptr [ESP + 0x18]
009c4275 : MOV ECX,dword ptr [ECX + 0x99c]
009c427b : MOV ESI,EAX
009c427d : CALL 0x0041daa0
009c4282 : OR ESI,0xffffffff
009c4285 : JMP 0x009c4289
009c4287 : XOR EAX,EAX
009c4289 : MOV dword ptr [ESP + 0x3d0],ESI
009c4290 : MOV EDX,dword ptr [0x017247d4]
009c4296 : MOV ECX,dword ptr [EDX + 0x4]
009c4299 : TEST ECX,ECX
009c429b : JZ 0x009c433c
009c42a1 : CMP byte ptr [EDX + 0x8],0x0
009c42a5 : JZ 0x009c433c
009c42ab : PUSH 0x58
009c42ad : PUSH ECX
009c42ae : MOV EDI,EAX
009c42b0 : CALL 0x00a0dd40
009c42b5 : MOV EDX,dword ptr [ESP + 0x18]
009c42b9 : MOV dword ptr [EDX + 0x99c],ESI
009c42bf : JMP 0x009c4431
009c42c4 : CMP dword ptr [0x0172491c],0x0
009c42cb : JZ 0x009c433c
009c42cd : MOV EDX,dword ptr [0x00da9894]
009c42d3 : CMP dword ptr [EDX],0x0
009c42d6 : JZ 0x009c433c
009c42d8 : PUSH 0xc91a68
009c42dd : LEA ECX,[ESP + 0x20]
009c42e1 : CALL 0x00406460
009c42e6 : MOV EBX,0xd
009c42eb : MOV dword ptr [ESP + 0x3d0],EBX
009c42f2 : MOV ECX,dword ptr [0x0172491c]
009c42f8 : LEA EAX,[ESP + 0x1c]
009c42fc : PUSH EAX
009c42fd : LEA EDI,[ESP + 0x5c]
009c4301 : CALL 0x0081d120
009c4306 : MOV byte ptr [ESP + 0x3d0],0xe
009c430e : MOV ECX,dword ptr [0x00da9894]
009c4314 : MOV ECX,dword ptr [ECX]
009c4316 : PUSH 0x0
009c4318 : PUSH EAX
009c4319 : CALL 0x008ede80
009c431e : MOV byte ptr [ESP + 0x3d0],BL
009c4325 : MOV ECX,EDI
009c4327 : CALL 0x00406560
009c432c : MOV dword ptr [ESP + 0x3d0],ESI
009c4333 : LEA ECX,[ESP + 0x1c]
009c4337 : CALL 0x00406560
009c433c : MOV EDX,dword ptr [ESP + 0x18]
009c4340 : MOV dword ptr [EDX + 0x99c],ESI
009c4346 : JMP 0x009c4431
009c434b : PUSH 0xc91980
009c4350 : LEA ECX,[ESP + 0x40]
009c4354 : CALL 0x00406460
009c4359 : MOV dword ptr [ESP + 0x3d0],0x2
009c4364 : MOV ECX,dword ptr [0x0172491c]
009c436a : LEA EAX,[ESP + 0x3c]
009c436e : PUSH EAX
009c436f : LEA EDI,[ESP + 0x20]
009c4373 : CALL 0x0081d120
009c4378 : MOV byte ptr [ESP + 0x3d0],0x3
009c4380 : MOV EDI,0x8
009c4385 : CMP dword ptr [EAX + 0x18],EDI
009c4388 : JC 0x009c438f
009c438a : MOV EAX,dword ptr [EAX + 0x4]
009c438d : JMP 0x009c4392
009c438f : ADD EAX,0x4
009c4392 : PUSH 0x14
009c4394 : PUSH 0x2
009c4396 : PUSH EAX
009c4397 : LEA ESI,[ESP + 0x64]
009c439b : CALL 0x00404750
009c43a0 : ADD ESP,0xc
009c43a3 : MOV byte ptr [ESP + 0x3d0],0x5
009c43ab : CMP dword ptr [ESP + 0x34],EDI
009c43af : JC 0x009c43ba
009c43b1 : MOV ECX,dword ptr [ESP + 0x20]
009c43b5 : CALL 0x006f04e0
009c43ba : MOV EBX,0x7
009c43bf : XOR ESI,ESI
009c43c1 : XOR ECX,ECX
009c43c3 : MOV dword ptr [ESP + 0x34],EBX
009c43c7 : MOV dword ptr [ESP + 0x30],ESI
009c43cb : MOV word ptr [ESP + 0x20],CX
009c43d0 : MOV byte ptr [ESP + 0x3d0],0x6
009c43d8 : CMP dword ptr [ESP + 0x54],EDI
009c43dc : JC 0x009c43e7
009c43de : MOV ECX,dword ptr [ESP + 0x40]
009c43e2 : CALL 0x006f04e0
009c43e7 : MOV EAX,[0x00da9894]
009c43ec : XOR EDX,EDX
009c43ee : MOV word ptr [ESP + 0x40],DX
009c43f3 : PUSH ESI
009c43f4 : LEA EDX,[ESP + 0x5c]
009c43f8 : MOV dword ptr [ESP + 0x58],EBX
009c43fc : MOV dword ptr [ESP + 0x54],ESI
009c4400 : MOV ECX,dword ptr [EAX]
009c4402 : PUSH EDX
009c4403 : CALL 0x008ede80
009c4408 : MOV dword ptr [ESP + 0x3d0],0xffffffff
009c4413 : CMP dword ptr [ESP + 0x70],EDI
009c4417 : JC 0x009c4422
009c4419 : MOV ECX,dword ptr [ESP + 0x5c]
009c441d : CALL 0x006f04e0
009c4422 : XOR EAX,EAX
009c4424 : MOV dword ptr [ESP + 0x70],EBX
009c4428 : MOV dword ptr [ESP + 0x6c],ESI
009c442c : MOV word ptr [ESP + 0x5c],AX
009c4431 : MOV ECX,dword ptr [ESP + 0x3c8]
009c4438 : MOV dword ptr FS:[0x0],ECX
009c443f : POP ECX
009c4440 : POP EDI
009c4441 : POP ESI
009c4442 : POP EBX
009c4443 : MOV ECX,dword ptr [ESP + 0x3b0]
009c444a : XOR ECX,ESP
009c444c : CALL 0x00633e6b
009c4451 : MOV ESP,EBP
009c4453 : POP EBP
009c4454 : RET 0x8

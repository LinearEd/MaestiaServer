PROGRAM  : Maestia.exe
FUNCTION : FUN_007c9c00
ENTRY    : 007c9c00
BODY     : [[007c9c00, 007c9f70]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007c9c00(void)

{
  bool bVar1;
  bool bVar2;
  undefined4 *puVar3;
  int iVar4;
  wchar_t *pwVar5;
  undefined4 ***pppuVar6;
  int in_ECX;
  uint uVar7;
  uint local_ac;
  undefined4 local_a4 [16];
  undefined4 **local_64 [4];
  int local_54;
  uint local_50;
  undefined1 local_4c [4];
  undefined4 local_48;
  uint local_38;
  uint local_34;
  undefined1 local_30 [4];
  undefined4 local_2c;
  uint local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  puStack_c = &LAB_00b19f96;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_8 = 0;
  local_ac = 0;
  bVar2 = false;
  bVar1 = false;
  FUN_0070d410(local_4c);
  local_8._0_1_ = 1;
  local_2c = (wchar_t *)((uint)local_2c._2_2_ << 0x10);
  local_18 = 7;
  local_1c = 0;
  FUN_00406360(&DAT_00c1e8dc,0);
  local_8._0_1_ = 2;
  FUN_00463730(local_a4);
  local_8._0_1_ = 3;
  if (local_38 != 0) {
    do {
      puVar3 = local_48;
      if (local_34 < 8) {
        puVar3 = &local_48;
      }
      if (*(short *)((int)puVar3 + local_ac * 2) == 10) {
        pwVar5 = local_2c;
        if (local_18 < 8) {
          pwVar5 = (wchar_t *)&local_2c;
        }
        iVar4 = _wcsncmp(pwVar5,L"<BODY>",6);
        if (iVar4 == 0) {
          bVar2 = true;
        }
        pwVar5 = local_2c;
        if (local_18 < 8) {
          pwVar5 = (wchar_t *)&local_2c;
        }
        iVar4 = _wcsncmp(pwVar5,L"</BODY>",7);
        if (iVar4 == 0) {
          bVar2 = false;
        }
        else if (bVar2) {
          if (bVar1) {
            bVar1 = false;
            FUN_00405eb0(local_30,0,0xffffffff);
            FUN_00462de0(in_ECX + 0x48,local_a4);
          }
          pwVar5 = local_2c;
          if (local_18 < 8) {
            pwVar5 = (wchar_t *)&local_2c;
          }
          iVar4 = _wcsncmp(pwVar5,L"<SYNC Start=",0xc);
          if (iVar4 == 0) {
            local_50 = 7;
            local_64[0] = (undefined4 **)((uint)local_64[0] & 0xffff0000);
            local_54 = iVar4;
            FUN_00406360(&DAT_00c1ea14,0);
            local_8._0_1_ = 4;
            uVar7 = 0xc;
            if (0xc < local_1c) {
              do {
                pwVar5 = local_2c;
                if (local_18 < 8) {
                  pwVar5 = (wchar_t *)&local_2c;
                }
                if (pwVar5[uVar7] == L'>') break;
                pwVar5 = local_2c;
                if (local_18 < 8) {
                  pwVar5 = (wchar_t *)&local_2c;
                }
                FUN_0041f950(1,pwVar5[uVar7]);
                uVar7 = uVar7 + 1;
              } while (uVar7 < local_1c);
            }
            pppuVar6 = (undefined4 ***)local_64[0];
            if (local_50 < 8) {
              pppuVar6 = local_64;
            }
            local_a4[0] = FUN_00634f4d(pppuVar6);
            bVar1 = true;
            local_8._0_1_ = 3;
            if (7 < local_50) {
                    /* WARNING: Subroutine does not return */
              FUN_006f04e0();
            }
            local_50 = 7;
            local_54 = 0;
            local_64[0] = (undefined4 **)((uint)local_64[0] & 0xffff0000);
          }
        }
        FUN_00406360(&DAT_00c1ea18,0);
      }
      else {
        puVar3 = local_48;
        if (local_34 < 8) {
          puVar3 = &local_48;
        }
        FUN_0041f950(1,*(undefined2 *)((int)puVar3 + local_ac * 2));
      }
      local_ac = local_ac + 1;
    } while (local_ac < local_38);
  }
  if ((uint)((*(int *)(in_ECX + 0x50) - *(int *)(in_ECX + 0x4c)) / 0x3c) < 2) {
    local_8._0_1_ = 2;
    FUN_00462c40(local_a4);
    local_8 = CONCAT31(local_8._1_3_,1);
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c = (wchar_t *)((uint)local_2c & 0xffff0000);
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  else {
    puVar3 = *(undefined4 **)(in_ECX + 0x4c);
    *(undefined4 **)(in_ECX + 0x58) = puVar3;
    *(undefined4 *)(in_ECX + 0xb8) = *puVar3;
    FUN_00405eb0(puVar3 + 1,0,0xffffffff);
    *(int *)(in_ECX + 0x58) = *(int *)(in_ECX + 0x58) + 0x3c;
    *(undefined4 *)(in_ECX + 0x7c) = **(undefined4 **)(in_ECX + 0x58);
    FUN_00405eb0(*(undefined4 **)(in_ECX + 0x58) + 1,0,0xffffffff);
    local_8._0_1_ = 2;
    FUN_00462c40(local_a4);
    local_8 = CONCAT31(local_8._1_3_,1);
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c = (wchar_t *)((uint)local_2c & 0xffff0000);
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  local_48 = (undefined4 *)((uint)local_48._2_2_ << 0x10);
  local_18 = 7;
  local_1c = 0;
  local_34 = 7;
  local_38 = 0;
  local_8 = 0xffffffff;
  FUN_0070d710();
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
007c9c00 : PUSH EBP
007c9c01 : MOV EBP,ESP
007c9c03 : PUSH -0x1
007c9c05 : PUSH 0xb19f96
007c9c0a : MOV EAX,FS:[0x0]
007c9c10 : PUSH EAX
007c9c11 : SUB ESP,0xa0
007c9c17 : MOV EAX,[0x00d66fa0]
007c9c1c : XOR EAX,EBP
007c9c1e : MOV dword ptr [EBP + -0x10],EAX
007c9c21 : PUSH EBX
007c9c22 : PUSH ESI
007c9c23 : PUSH EDI
007c9c24 : PUSH EAX
007c9c25 : LEA EAX,[EBP + -0xc]
007c9c28 : MOV FS:[0x0],EAX
007c9c2e : MOV EDI,ECX
007c9c30 : XOR ESI,ESI
007c9c32 : MOV dword ptr [EBP + -0x4],ESI
007c9c35 : LEA EAX,[EBP + -0x48]
007c9c38 : PUSH EAX
007c9c39 : LEA ECX,[EBP + 0x8]
007c9c3c : MOV dword ptr [EBP + 0xffffff58],ESI
007c9c42 : MOV byte ptr [EBP + 0xffffff5f],0x0
007c9c49 : XOR BL,BL
007c9c4b : CALL 0x0070d410
007c9c50 : MOV byte ptr [EBP + -0x4],0x1
007c9c54 : XOR ECX,ECX
007c9c56 : PUSH ESI
007c9c57 : MOV word ptr [EBP + -0x28],CX
007c9c5b : PUSH 0xc1e8dc
007c9c60 : LEA ECX,[EBP + -0x2c]
007c9c63 : MOV dword ptr [EBP + -0x14],0x7
007c9c6a : MOV dword ptr [EBP + -0x18],ESI
007c9c6d : CALL 0x00406360
007c9c72 : MOV byte ptr [EBP + -0x4],0x2
007c9c76 : LEA EDX,[EBP + 0xffffff60]
007c9c7c : PUSH EDX
007c9c7d : CALL 0x00463730
007c9c82 : MOV byte ptr [EBP + -0x4],0x3
007c9c86 : CMP dword ptr [EBP + -0x34],ESI
007c9c89 : JBE 0x007c9e40
007c9c8f : NOP
007c9c90 : MOV EDX,dword ptr [EBP + -0x30]
007c9c93 : MOV EAX,dword ptr [EBP + -0x44]
007c9c96 : MOV ECX,EAX
007c9c98 : CMP EDX,0x8
007c9c9b : JNC 0x007c9ca0
007c9c9d : LEA ECX,[EBP + -0x44]
007c9ca0 : MOV ESI,dword ptr [EBP + 0xffffff58]
007c9ca6 : CMP word ptr [ECX + ESI*0x2],0xa
007c9cab : JZ 0x007c9cc9
007c9cad : CMP EDX,0x8
007c9cb0 : JNC 0x007c9cb5
007c9cb2 : LEA EAX,[EBP + -0x44]
007c9cb5 : MOVZX EAX,word ptr [EAX + ESI*0x2]
007c9cb9 : PUSH EAX
007c9cba : PUSH 0x1
007c9cbc : LEA ECX,[EBP + -0x2c]
007c9cbf : CALL 0x0041f950
007c9cc4 : JMP 0x007c9e2e
007c9cc9 : MOV EAX,dword ptr [EBP + -0x28]
007c9ccc : MOV ESI,0x8
007c9cd1 : CMP dword ptr [EBP + -0x14],ESI
007c9cd4 : JNC 0x007c9cd9
007c9cd6 : LEA EAX,[EBP + -0x28]
007c9cd9 : PUSH 0x6
007c9cdb : PUSH 0xc1e9c8
007c9ce0 : PUSH EAX
007c9ce1 : CALL 0x006380ac
007c9ce6 : ADD ESP,0xc
007c9ce9 : TEST EAX,EAX
007c9ceb : JNZ 0x007c9cf4
007c9ced : MOV byte ptr [EBP + 0xffffff5f],0x1
007c9cf4 : MOV EAX,dword ptr [EBP + -0x28]
007c9cf7 : CMP dword ptr [EBP + -0x14],ESI
007c9cfa : JNC 0x007c9cff
007c9cfc : LEA EAX,[EBP + -0x28]
007c9cff : PUSH 0x7
007c9d01 : PUSH 0xc1e9e8
007c9d06 : PUSH EAX
007c9d07 : CALL 0x006380ac
007c9d0c : ADD ESP,0xc
007c9d0f : TEST EAX,EAX
007c9d11 : JNZ 0x007c9d1e
007c9d13 : MOV byte ptr [EBP + 0xffffff5f],AL
007c9d19 : JMP 0x007c9e19
007c9d1e : CMP byte ptr [EBP + 0xffffff5f],0x1
007c9d25 : JNZ 0x007c9e19
007c9d2b : CMP BL,0x1
007c9d2e : JNZ 0x007c9d55
007c9d30 : PUSH -0x1
007c9d32 : PUSH 0x0
007c9d34 : LEA EAX,[EBP + -0x2c]
007c9d37 : PUSH EAX
007c9d38 : LEA ECX,[EBP + 0xffffff64]
007c9d3e : XOR BL,BL
007c9d40 : CALL 0x00405eb0
007c9d45 : LEA ECX,[EBP + 0xffffff60]
007c9d4b : PUSH ECX
007c9d4c : LEA EDX,[EDI + 0x48]
007c9d4f : PUSH EDX
007c9d50 : CALL 0x00462de0
007c9d55 : MOV EAX,dword ptr [EBP + -0x28]
007c9d58 : CMP dword ptr [EBP + -0x14],ESI
007c9d5b : JNC 0x007c9d60
007c9d5d : LEA EAX,[EBP + -0x28]
007c9d60 : PUSH 0xc
007c9d62 : PUSH 0xc1e9f8
007c9d67 : PUSH EAX
007c9d68 : CALL 0x006380ac
007c9d6d : ADD ESP,0xc
007c9d70 : TEST EAX,EAX
007c9d72 : JNZ 0x007c9e19
007c9d78 : PUSH EAX
007c9d79 : PUSH 0xc1ea14
007c9d7e : LEA ECX,[EBP + -0x64]
007c9d81 : MOV dword ptr [EBP + -0x4c],0x7
007c9d88 : MOV dword ptr [EBP + -0x50],EAX
007c9d8b : MOV word ptr [EBP + -0x60],AX
007c9d8f : CALL 0x00406360
007c9d94 : MOV byte ptr [EBP + -0x4],0x4
007c9d98 : MOV ESI,0xc
007c9d9d : CMP dword ptr [EBP + -0x18],ESI
007c9da0 : JBE 0x007c9dd6
007c9da2 : MOV EDX,dword ptr [EBP + -0x14]
007c9da5 : MOV EAX,dword ptr [EBP + -0x28]
007c9da8 : MOV ECX,EAX
007c9daa : CMP EDX,0x8
007c9dad : JNC 0x007c9db2
007c9daf : LEA ECX,[EBP + -0x28]
007c9db2 : CMP word ptr [ECX + ESI*0x2],0x3e
007c9db7 : JZ 0x007c9dd6
007c9db9 : CMP EDX,0x8
007c9dbc : JNC 0x007c9dc1
007c9dbe : LEA EAX,[EBP + -0x28]
007c9dc1 : MOVZX EAX,word ptr [EAX + ESI*0x2]
007c9dc5 : PUSH EAX
007c9dc6 : PUSH 0x1
007c9dc8 : LEA ECX,[EBP + -0x64]
007c9dcb : CALL 0x0041f950
007c9dd0 : INC ESI
007c9dd1 : CMP ESI,dword ptr [EBP + -0x18]
007c9dd4 : JC 0x007c9da2
007c9dd6 : CMP dword ptr [EBP + -0x4c],0x8
007c9dda : MOV EAX,dword ptr [EBP + -0x60]
007c9ddd : JNC 0x007c9de2
007c9ddf : LEA EAX,[EBP + -0x60]
007c9de2 : PUSH EAX
007c9de3 : CALL 0x00634f4d
007c9de8 : ADD ESP,0x4
007c9deb : MOV dword ptr [EBP + 0xffffff60],EAX
007c9df1 : MOV BL,0x1
007c9df3 : MOV byte ptr [EBP + -0x4],0x3
007c9df7 : CMP dword ptr [EBP + -0x4c],0x8
007c9dfb : JC 0x007c9e05
007c9dfd : MOV ECX,dword ptr [EBP + -0x60]
007c9e00 : CALL 0x006f04e0
007c9e05 : XOR ECX,ECX
007c9e07 : MOV dword ptr [EBP + -0x4c],0x7
007c9e0e : MOV dword ptr [EBP + -0x50],0x0
007c9e15 : MOV word ptr [EBP + -0x60],CX
007c9e19 : PUSH 0x0
007c9e1b : PUSH 0xc1ea18
007c9e20 : LEA ECX,[EBP + -0x2c]
007c9e23 : CALL 0x00406360
007c9e28 : MOV ESI,dword ptr [EBP + 0xffffff58]
007c9e2e : INC ESI
007c9e2f : MOV dword ptr [EBP + 0xffffff58],ESI
007c9e35 : CMP ESI,dword ptr [EBP + -0x34]
007c9e38 : JC 0x007c9c90
007c9e3e : XOR ESI,ESI
007c9e40 : MOV ECX,dword ptr [EDI + 0x50]
007c9e43 : SUB ECX,dword ptr [EDI + 0x4c]
007c9e46 : MOV EAX,0x88888889
007c9e4b : IMUL ECX
007c9e4d : ADD EDX,ECX
007c9e4f : SAR EDX,0x5
007c9e52 : MOV EAX,EDX
007c9e54 : SHR EAX,0x1f
007c9e57 : ADD EAX,EDX
007c9e59 : CMP EAX,0x2
007c9e5c : JNC 0x007c9eb3
007c9e5e : MOV byte ptr [EBP + -0x4],0x2
007c9e62 : LEA ECX,[EBP + 0xffffff60]
007c9e68 : PUSH ECX
007c9e69 : CALL 0x00462c40
007c9e6e : MOV byte ptr [EBP + -0x4],0x1
007c9e72 : MOV EBX,0x8
007c9e77 : CMP dword ptr [EBP + -0x14],EBX
007c9e7a : JC 0x007c9e84
007c9e7c : MOV ECX,dword ptr [EBP + -0x28]
007c9e7f : CALL 0x006f04e0
007c9e84 : XOR EDX,EDX
007c9e86 : MOV EDI,0x7
007c9e8b : MOV dword ptr [EBP + -0x14],EDI
007c9e8e : MOV dword ptr [EBP + -0x18],ESI
007c9e91 : MOV word ptr [EBP + -0x28],DX
007c9e95 : MOV byte ptr [EBP + -0x4],DL
007c9e98 : CMP dword ptr [EBP + -0x30],EBX
007c9e9b : JC 0x007c9ea5
007c9e9d : MOV ECX,dword ptr [EBP + -0x44]
007c9ea0 : CALL 0x006f04e0
007c9ea5 : XOR EAX,EAX
007c9ea7 : MOV dword ptr [EBP + -0x30],EDI
007c9eaa : MOV word ptr [EBP + -0x44],AX
007c9eae : JMP 0x007c9f41
007c9eb3 : MOV EAX,dword ptr [EDI + 0x4c]
007c9eb6 : MOV dword ptr [EDI + 0x58],EAX
007c9eb9 : MOV ECX,dword ptr [EAX]
007c9ebb : PUSH -0x1
007c9ebd : PUSH ESI
007c9ebe : ADD EAX,0x4
007c9ec1 : MOV dword ptr [EDI + 0xb8],ECX
007c9ec7 : PUSH EAX
007c9ec8 : LEA ECX,[EDI + 0xbc]
007c9ece : CALL 0x00405eb0
007c9ed3 : ADD dword ptr [EDI + 0x58],0x3c
007c9ed7 : MOV EAX,dword ptr [EDI + 0x58]
007c9eda : MOV EDX,dword ptr [EAX]
007c9edc : PUSH -0x1
007c9ede : PUSH ESI
007c9edf : ADD EAX,0x4
007c9ee2 : PUSH EAX
007c9ee3 : LEA ECX,[EDI + 0x80]
007c9ee9 : MOV dword ptr [EDI + 0x7c],EDX
007c9eec : CALL 0x00405eb0
007c9ef1 : MOV byte ptr [EBP + -0x4],0x2
007c9ef5 : LEA EAX,[EBP + 0xffffff60]
007c9efb : PUSH EAX
007c9efc : CALL 0x00462c40
007c9f01 : MOV byte ptr [EBP + -0x4],0x1
007c9f05 : MOV EDI,0x8
007c9f0a : CMP dword ptr [EBP + -0x14],EDI
007c9f0d : JC 0x007c9f17
007c9f0f : MOV ECX,dword ptr [EBP + -0x28]
007c9f12 : CALL 0x006f04e0
007c9f17 : XOR ECX,ECX
007c9f19 : MOV EBX,0x7
007c9f1e : MOV dword ptr [EBP + -0x14],EBX
007c9f21 : MOV dword ptr [EBP + -0x18],ESI
007c9f24 : MOV word ptr [EBP + -0x28],CX
007c9f28 : MOV byte ptr [EBP + -0x4],CL
007c9f2b : CMP dword ptr [EBP + -0x30],EDI
007c9f2e : JC 0x007c9f38
007c9f30 : MOV ECX,dword ptr [EBP + -0x44]
007c9f33 : CALL 0x006f04e0
007c9f38 : XOR EDX,EDX
007c9f3a : MOV dword ptr [EBP + -0x30],EBX
007c9f3d : MOV word ptr [EBP + -0x44],DX
007c9f41 : MOV dword ptr [EBP + -0x34],ESI
007c9f44 : MOV dword ptr [EBP + -0x4],0xffffffff
007c9f4b : LEA ECX,[EBP + 0x8]
007c9f4e : CALL 0x0070d710
007c9f53 : MOV ECX,dword ptr [EBP + -0xc]
007c9f56 : MOV dword ptr FS:[0x0],ECX
007c9f5d : POP ECX
007c9f5e : POP EDI
007c9f5f : POP ESI
007c9f60 : POP EBX
007c9f61 : MOV ECX,dword ptr [EBP + -0x10]
007c9f64 : XOR ECX,EBP
007c9f66 : CALL 0x00633e6b
007c9f6b : MOV ESP,EBP
007c9f6d : POP EBP
007c9f6e : RET 0x54

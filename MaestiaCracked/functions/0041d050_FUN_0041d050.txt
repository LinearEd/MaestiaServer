PROGRAM  : Maestia.exe
FUNCTION : FUN_0041d050
ENTRY    : 0041d050
BODY     : [[0041d050, 0041d0aa]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0041d050(undefined2 param_1,undefined1 param_2)

{
  wchar_t wVar1;
  wchar_t *_Dest;
  wchar_t *in_ECX;
  ushort *unaff_ESI;
  
  _Dest = (wchar_t *)((int)unaff_ESI + 7);
  *unaff_ESI = 0;
  *(undefined1 *)(unaff_ESI + 1) = 0x39;
  *(undefined1 *)((int)unaff_ESI + 3) = 0x6f;
  _wcsncpy(_Dest,in_ECX,0x28);
  *(undefined2 *)((int)unaff_ESI + 5) = param_1;
  *(undefined1 *)(unaff_ESI + 2) = param_2;
  do {
    wVar1 = *_Dest;
    _Dest = _Dest + 1;
  } while (wVar1 != L'\0');
  *unaff_ESI = *unaff_ESI ^
               ((short)((int)_Dest - ((int)unaff_ESI + 9) >> 1) * 2 + 9U ^ *unaff_ESI) & 0x1fff;
  return;
}



============================================================
DISASSEMBLY
============================================================
0041d050 : PUSH EBP
0041d051 : MOV EBP,ESP
0041d053 : PUSH EDI
0041d054 : PUSH 0x28
0041d056 : PUSH ECX
0041d057 : XOR EAX,EAX
0041d059 : LEA EDI,[ESI + 0x7]
0041d05c : PUSH EDI
0041d05d : MOV word ptr [ESI],AX
0041d060 : MOV byte ptr [ESI + 0x2],0x39
0041d064 : MOV byte ptr [ESI + 0x3],0x6f
0041d068 : CALL 0x00634e39
0041d06d : MOV AX,word ptr [EBP + 0x8]
0041d071 : MOV DL,byte ptr [EBP + 0xc]
0041d074 : MOV word ptr [ESI + 0x5],AX
0041d078 : MOV EAX,EDI
0041d07a : ADD ESP,0xc
0041d07d : MOV byte ptr [ESI + 0x4],DL
0041d080 : LEA EDX,[EAX + 0x2]
0041d083 : POP EDI
0041d084 : MOV CX,word ptr [EAX]
0041d087 : ADD EAX,0x2
0041d08a : TEST CX,CX
0041d08d : JNZ 0x0041d084
0041d08f : SUB EAX,EDX
0041d091 : SAR EAX,0x1
0041d093 : LEA ECX,[EAX + EAX*0x1 + 0x9]
0041d097 : XOR CX,word ptr [ESI]
0041d09a : MOV EDX,0x1fff
0041d09f : AND CX,DX
0041d0a2 : XOR word ptr [ESI],CX
0041d0a5 : MOV EAX,ESI
0041d0a7 : POP EBP
0041d0a8 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_00584c60
ENTRY    : 00584c60
BODY     : [[00584c60, 00584ce9] [00584cf0, 00584dae]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00584c60(int *param_1,int *param_2,undefined4 param_3)

{
  int iVar1;
  int in_ECX;
  uint uVar2;
  uint uVar3;
  uint local_6c;
  uint local_68;
  int *local_64;
  int local_60;
  undefined4 uStack_5c;
  undefined4 uStack_58;
  undefined **ppuStack_48;
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)&local_6c;
  local_64 = param_1;
  local_60 = in_ECX;
  FUN_0054fbe0(param_1,param_2,param_3);
  uVar2 = *(uint *)(in_ECX + 0x28);
  local_6c = 8;
  if (uVar2 < 8) {
    local_6c = uVar2;
  }
  uVar3 = 0;
  local_68 = uVar2;
  if (local_6c != 0) {
    do {
      if (*(int *)(*(int *)(in_ECX + 0x24) + uVar3 * 4) != 0) {
        (**(code **)(*param_2 + 4))
                  (*param_1 + 0x224 + uVar3 * 4,*(undefined4 *)(*(int *)(in_ECX + 0x24) + uVar3 * 4)
                   ,0);
        uVar2 = local_68;
      }
      uVar3 = uVar3 + 1;
    } while (uVar3 < local_6c);
  }
  if (uVar3 < uVar2) {
    do {
      if (*(int *)(*(int *)(in_ECX + 0x24) + uVar3 * 4) != 0) {
        FUN_005ae060(uVar3);
        FUN_005ae280();
        FUN_005addd0(&uStack_5c);
        iVar1 = *(int *)(in_ECX + 0x24);
        local_6c = FUN_00525450(uStack_5c,uStack_58);
        *(int *)(local_6c + 8) = *(int *)(local_6c + 8) + 1;
        (**(code **)(*param_2 + 4))(&local_6c,*(undefined4 *)(iVar1 + uVar3 * 4),0);
        *(int *)(local_6c + 8) = *(int *)(local_6c + 8) + -1;
        if (*(int *)(local_6c + 8) == 0) {
          FUN_00525340();
        }
        ppuStack_48 = &PTR_LAB_00b85ff8;
        FUN_005ad950();
        uVar2 = local_68;
        in_ECX = local_60;
      }
      uVar3 = uVar3 + 1;
    } while (uVar3 < uVar2);
  }
  __security_check_cookie(local_4 ^ (uint)&local_6c);
  return;
}



============================================================
DISASSEMBLY
============================================================
00584c60 : SUB ESP,0x6c
00584c63 : MOV EAX,[0x00d66fa0]
00584c68 : XOR EAX,ESP
00584c6a : MOV dword ptr [ESP + 0x68],EAX
00584c6e : MOV EAX,dword ptr [ESP + 0x78]
00584c72 : PUSH EBX
00584c73 : MOV EBX,dword ptr [ESP + 0x78]
00584c77 : PUSH EBP
00584c78 : MOV EBP,dword ptr [ESP + 0x78]
00584c7c : PUSH ESI
00584c7d : PUSH EDI
00584c7e : PUSH EAX
00584c7f : PUSH EBX
00584c80 : MOV ESI,ECX
00584c82 : PUSH EBP
00584c83 : MOV dword ptr [ESP + 0x28],ESI
00584c87 : MOV dword ptr [ESP + 0x24],EBP
00584c8b : CALL 0x0054fbe0
00584c90 : MOV ECX,dword ptr [ESI + 0x28]
00584c93 : MOV dword ptr [ESP + 0x14],ECX
00584c97 : MOV dword ptr [ESP + 0x10],0x8
00584c9f : CMP ECX,0x7
00584ca2 : JA 0x00584ca8
00584ca4 : MOV dword ptr [ESP + 0x10],ECX
00584ca8 : XOR EDI,EDI
00584caa : CMP dword ptr [ESP + 0x10],EDI
00584cae : JBE 0x00584ce0
00584cb0 : MOV EDX,dword ptr [ESI + 0x24]
00584cb3 : CMP dword ptr [EDX + EDI*0x4],0x0
00584cb7 : LEA EAX,[EDX + EDI*0x4]
00584cba : JZ 0x00584cd9
00584cbc : MOV EAX,dword ptr [EAX]
00584cbe : MOV ECX,dword ptr [EBP]
00584cc1 : MOV EDX,dword ptr [EBX]
00584cc3 : MOV EDX,dword ptr [EDX + 0x4]
00584cc6 : PUSH 0x0
00584cc8 : PUSH EAX
00584cc9 : LEA EAX,[ECX + EDI*0x4 + 0x224]
00584cd0 : PUSH EAX
00584cd1 : MOV ECX,EBX
00584cd3 : CALL EDX
00584cd5 : MOV ECX,dword ptr [ESP + 0x14]
00584cd9 : INC EDI
00584cda : CMP EDI,dword ptr [ESP + 0x10]
00584cde : JC 0x00584cb0
00584ce0 : CMP EDI,ECX
00584ce2 : JNC 0x00584d9a
00584ce8 : JMP 0x00584cf0
00584cf0 : MOV EAX,dword ptr [ESI + 0x24]
00584cf3 : CMP dword ptr [EAX + EDI*0x4],0x0
00584cf7 : LEA EBP,[EDI*0x4 + 0x0]
00584cfe : JZ 0x00584d91
00584d04 : PUSH EDI
00584d05 : LEA ECX,[ESP + 0x2c]
00584d09 : CALL 0x005ae060
00584d0e : LEA ECX,[ESP + 0x28]
00584d12 : CALL 0x005ae280
00584d17 : LEA ECX,[ESP + 0x20]
00584d1b : PUSH ECX
00584d1c : LEA ECX,[ESP + 0x2c]
00584d20 : CALL 0x005addd0
00584d25 : MOV EDX,dword ptr [ESP + 0x18]
00584d29 : MOV EAX,dword ptr [EDX]
00584d2b : MOV ECX,dword ptr [ESP + 0x24]
00584d2f : MOV EDX,dword ptr [ESP + 0x20]
00584d33 : MOV ESI,dword ptr [ESI + 0x24]
00584d36 : PUSH ECX
00584d37 : ADD EAX,0x8
00584d3a : PUSH EDX
00584d3b : LEA ECX,[EAX + 0x24c]
00584d41 : ADD ESI,EBP
00584d43 : CALL 0x00525450
00584d48 : MOV dword ptr [ESP + 0x10],EAX
00584d4c : INC dword ptr [EAX + 0x8]
00584d4f : MOV ECX,dword ptr [ESI]
00584d51 : MOV EAX,dword ptr [EBX]
00584d53 : MOV EAX,dword ptr [EAX + 0x4]
00584d56 : PUSH 0x0
00584d58 : PUSH ECX
00584d59 : LEA EDX,[ESP + 0x18]
00584d5d : PUSH EDX
00584d5e : MOV ECX,EBX
00584d60 : CALL EAX
00584d62 : MOV EAX,dword ptr [ESP + 0x10]
00584d66 : DEC dword ptr [EAX + 0x8]
00584d69 : MOV ECX,EAX
00584d6b : ADD EAX,0x8
00584d6e : CMP dword ptr [EAX],0x0
00584d71 : JNZ 0x00584d78
00584d73 : CALL 0x00525340
00584d78 : LEA ECX,[ESP + 0x28]
00584d7c : MOV dword ptr [ESP + 0x34],0xb85ff8
00584d84 : CALL 0x005ad950
00584d89 : MOV ESI,dword ptr [ESP + 0x1c]
00584d8d : MOV ECX,dword ptr [ESP + 0x14]
00584d91 : INC EDI
00584d92 : CMP EDI,ECX
00584d94 : JC 0x00584cf0
00584d9a : MOV ECX,dword ptr [ESP + 0x78]
00584d9e : POP EDI
00584d9f : POP ESI
00584da0 : POP EBP
00584da1 : POP EBX
00584da2 : XOR ECX,ESP
00584da4 : CALL 0x00633e6b
00584da9 : ADD ESP,0x6c
00584dac : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_005331f0
ENTRY    : 005331f0
BODY     : [[005331f0, 005334e8]]

============================================================
DECOMPILED C CODE
============================================================

char FUN_005331f0(int *param_1,char *param_2,undefined4 param_3,undefined4 param_4,
                 undefined4 param_5,undefined4 param_6)

{
  uint *puVar1;
  int *piVar2;
  undefined1 *puVar3;
  char cVar4;
  char cVar5;
  int iVar6;
  GRefCountNTSImpl *this;
  GRefCountNTSImpl *pGVar7;
  int in_ECX;
  GRefCountNTSImpl *pGVar8;
  GRefCountNTSImpl *local_84;
  int *local_80;
  int local_7c;
  byte bStack_78;
  undefined **local_74;
  char *local_70;
  GRefCountNTSImpl *local_6c;
  int local_68;
  int local_64;
  byte local_60;
  undefined4 local_58;
  int local_54;
  undefined1 local_50 [16];
  undefined1 local_40 [16];
  int local_30;
  undefined1 *local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  int *local_18;
  char *local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  undefined4 local_4;
  
  local_c = param_4;
  local_18 = param_1;
  local_14 = param_2;
  local_10 = param_3;
  local_8 = param_5;
  local_4 = param_6;
  cVar4 = FUN_0052e6a0(&local_18);
  if ((cVar4 == '\0') || (*param_2 != '\t')) {
    if (*param_2 != '\f') {
      return cVar4;
    }
    local_84 = (GRefCountNTSImpl *)0x0;
    local_40[0] = 0;
    cVar5 = FUN_005331f0(*(int *)(in_ECX + 0x78) + 0xf4,local_40,param_3,0,0,0);
    if (cVar5 == '\0') {
      this = *(GRefCountNTSImpl **)(in_ECX + 0x74);
      if (this != (GRefCountNTSImpl *)0x0) {
        *(int *)(this + 4) = *(int *)(this + 4) + 1;
      }
    }
    else {
      iVar6 = FUN_00526fa0(in_ECX);
      if (iVar6 == 0) {
        local_84 = (GRefCountNTSImpl *)0x0;
      }
      else {
        local_84 = (GRefCountNTSImpl *)(iVar6 + 0x10);
      }
      this = (GRefCountNTSImpl *)FUN_00525fa0(in_ECX);
      if (this != (GRefCountNTSImpl *)0x0) {
        *(int *)(this + 4) = *(int *)(this + 4) + 1;
      }
    }
    FUN_00526bf0(&local_80);
    *(int *)(in_ECX + 8) = *(int *)(in_ECX + 8) + 0x10;
    puVar1 = (uint *)(in_ECX + 8);
    if (*(uint *)(in_ECX + 0x10) <= *(uint *)(in_ECX + 8)) {
      FUN_00504050();
    }
    puVar3 = (undefined1 *)*puVar1;
    if (puVar3 != (undefined1 *)0x0) {
      *puVar3 = 5;
      iVar6 = *param_1;
      *(int *)(puVar3 + 4) = iVar6;
      piVar2 = (int *)(iVar6 + 8);
      *piVar2 = *piVar2 + 1;
    }
    FUN_00526400();
    *param_2 = '\0';
    local_6c = this + 0x68;
    if (this == (GRefCountNTSImpl *)0x0) {
      local_6c = local_84;
    }
    local_54 = ((int)(*puVar1 - *(int *)(in_ECX + 0xc)) >> 4) + -0x20 +
               *(int *)(in_ECX + 0x1c) * 0x20;
    local_70 = param_2;
    local_74 = &PTR_FUN_00b8ab5c;
    local_60 = 0;
    local_68 = 0;
    local_64 = 0;
    local_58 = 1;
    (**(code **)(*local_80 + 0x28))(&local_74,local_7c,0);
    local_74 = &PTR_FUN_00b8ab5c;
    if (((local_60 & 2) == 0) && (local_68 != 0)) {
      FUN_00503db0();
    }
    local_68 = 0;
    if (((local_60 & 1) == 0) && (local_64 != 0)) {
      FUN_00503db0();
    }
    FUN_00526bc0();
    *puVar1 = *puVar1 - 0x10;
    if (*puVar1 < *(uint *)(in_ECX + 0xc)) {
      FUN_00504f30();
    }
    if (((bStack_78 & 2) == 0) && (local_80 != (int *)0x0)) {
      FUN_00503db0();
    }
    local_80 = (int *)0x0;
    if (((bStack_78 & 1) == 0) && (local_7c != 0)) {
      FUN_00503db0();
    }
    local_7c = 0;
    FUN_00526bc0();
    goto joined_r0x005334d1;
  }
  local_30 = *(int *)(in_ECX + 0x78) + 0xf4;
  local_2c = local_50;
  pGVar8 = (GRefCountNTSImpl *)0x0;
  local_50[0] = 0;
  local_28 = param_3;
  local_24 = 0;
  local_20 = 0;
  local_1c = 0;
  cVar5 = FUN_00532760(&local_30);
  if (cVar5 == '\0') {
    this = *(GRefCountNTSImpl **)(in_ECX + 0x74);
    if (this != (GRefCountNTSImpl *)0x0) {
      *(int *)(this + 4) = *(int *)(this + 4) + 1;
      goto LAB_005332ec;
    }
LAB_005332f3:
    pGVar7 = pGVar8;
  }
  else {
    iVar6 = FUN_00526fa0(in_ECX);
    if (iVar6 == 0) {
      pGVar8 = (GRefCountNTSImpl *)0x0;
    }
    else {
      pGVar8 = (GRefCountNTSImpl *)(iVar6 + 0x10);
    }
    this = (GRefCountNTSImpl *)FUN_00525fa0(in_ECX);
    if (this != (GRefCountNTSImpl *)0x0) {
      *(int *)(this + 4) = *(int *)(this + 4) + 1;
    }
LAB_005332ec:
    pGVar7 = this + 0x68;
    if (this == (GRefCountNTSImpl *)0x0) goto LAB_005332f3;
  }
  FUN_00526d80(in_ECX,pGVar7,param_2);
  FUN_00526bc0();
joined_r0x005334d1:
  if (this != (GRefCountNTSImpl *)0x0) {
    GRefCountNTSImpl::Release(this);
  }
  return cVar4;
}



============================================================
DISASSEMBLY
============================================================
005331f0 : SUB ESP,0x8c
005331f6 : MOV EAX,dword ptr [ESP + 0x90]
005331fd : MOV EDX,dword ptr [ESP + 0xa0]
00533204 : PUSH EBX
00533205 : PUSH EBP
00533206 : MOV EBP,dword ptr [ESP + 0x9c]
0053320d : PUSH ESI
0053320e : MOV ESI,dword ptr [ESP + 0xa4]
00533215 : PUSH EDI
00533216 : MOV EDI,ECX
00533218 : MOV ECX,dword ptr [ESP + 0xac]
0053321f : MOV dword ptr [ESP + 0x90],ECX
00533226 : LEA ECX,[ESP + 0x84]
0053322d : MOV dword ptr [ESP + 0x84],EAX
00533234 : MOV EAX,dword ptr [ESP + 0xb4]
0053323b : PUSH ECX
0053323c : MOV ECX,EDI
0053323e : MOV dword ptr [ESP + 0x8c],EBP
00533245 : MOV dword ptr [ESP + 0x90],ESI
0053324c : MOV dword ptr [ESP + 0x98],EDX
00533253 : MOV dword ptr [ESP + 0x9c],EAX
0053325a : CALL 0x0052e6a0
0053325f : XOR EBX,EBX
00533261 : MOV byte ptr [ESP + 0x13],AL
00533265 : CMP AL,BL
00533267 : JZ 0x0053331c
0053326d : CMP byte ptr [EBP],0x9
00533271 : JNZ 0x0053331c
00533277 : MOV EDX,dword ptr [EDI + 0x78]
0053327a : LEA ECX,[ESP + 0x6c]
0053327e : ADD EDX,0xf4
00533284 : LEA EAX,[ESP + 0x4c]
00533288 : PUSH ECX
00533289 : MOV ECX,EDI
0053328b : XOR EBP,EBP
0053328d : MOV byte ptr [ESP + 0x50],BL
00533291 : MOV dword ptr [ESP + 0x70],EDX
00533295 : MOV dword ptr [ESP + 0x74],EAX
00533299 : MOV dword ptr [ESP + 0x78],ESI
0053329d : MOV dword ptr [ESP + 0x7c],EBX
005332a1 : MOV dword ptr [ESP + 0x80],EBX
005332a8 : MOV dword ptr [ESP + 0x84],EBX
005332af : CALL 0x00532760
005332b4 : TEST AL,AL
005332b6 : JZ 0x005332e2
005332b8 : PUSH EDI
005332b9 : LEA ECX,[ESP + 0x50]
005332bd : CALL 0x00526fa0
005332c2 : CMP EAX,EBX
005332c4 : JZ 0x005332cb
005332c6 : LEA EBP,[EAX + 0x10]
005332c9 : JMP 0x005332cd
005332cb : XOR EBP,EBP
005332cd : PUSH EDI
005332ce : LEA ECX,[ESP + 0x50]
005332d2 : CALL 0x00525fa0
005332d7 : CMP EAX,EBX
005332d9 : JZ 0x005332de
005332db : INC dword ptr [EAX + 0x4]
005332de : MOV ESI,EAX
005332e0 : JMP 0x005332ec
005332e2 : MOV ESI,dword ptr [EDI + 0x74]
005332e5 : CMP ESI,EBX
005332e7 : JZ 0x005332f3
005332e9 : INC dword ptr [ESI + 0x4]
005332ec : LEA EAX,[ESI + 0x68]
005332ef : CMP ESI,EBX
005332f1 : JNZ 0x005332f5
005332f3 : MOV EAX,EBP
005332f5 : MOV ECX,dword ptr [ESP + 0xa4]
005332fc : PUSH ECX
005332fd : PUSH EAX
005332fe : PUSH EDI
005332ff : CALL 0x00526d80
00533304 : LEA ECX,[ESP + 0x4c]
00533308 : CALL 0x00526bc0
0053330d : CMP ESI,EBX
0053330f : JZ 0x005334d8
00533315 : MOV ECX,ESI
00533317 : JMP 0x005334d3
0053331c : CMP byte ptr [EBP],0xc
00533320 : JNZ 0x005334dc
00533326 : MOV EAX,dword ptr [EDI + 0x78]
00533329 : PUSH EBX
0053332a : PUSH EBX
0053332b : PUSH EBX
0053332c : PUSH ESI
0053332d : LEA EDX,[ESP + 0x6c]
00533331 : PUSH EDX
00533332 : ADD EAX,0xf4
00533337 : PUSH EAX
00533338 : MOV ECX,EDI
0053333a : MOV dword ptr [ESP + 0x30],EBX
0053333e : MOV byte ptr [ESP + 0x74],BL
00533342 : CALL 0x005331f0
00533347 : TEST AL,AL
00533349 : JZ 0x0053337f
0053334b : PUSH EDI
0053334c : LEA ECX,[ESP + 0x60]
00533350 : CALL 0x00526fa0
00533355 : CMP EAX,EBX
00533357 : JZ 0x00533362
00533359 : ADD EAX,0x10
0053335c : MOV dword ptr [ESP + 0x18],EAX
00533360 : JMP 0x00533366
00533362 : MOV dword ptr [ESP + 0x18],EBX
00533366 : PUSH EDI
00533367 : LEA ECX,[ESP + 0x60]
0053336b : CALL 0x00525fa0
00533370 : CMP EAX,EBX
00533372 : JZ 0x00533377
00533374 : INC dword ptr [EAX + 0x4]
00533377 : MOV EBP,EAX
00533379 : MOV dword ptr [ESP + 0x14],EBP
0053337d : JMP 0x0053338f
0053337f : MOV EAX,dword ptr [EDI + 0x74]
00533382 : CMP EAX,EBX
00533384 : JZ 0x00533389
00533386 : INC dword ptr [EAX + 0x4]
00533389 : MOV dword ptr [ESP + 0x14],EAX
0053338d : MOV EBP,EAX
0053338f : MOV ECX,dword ptr [ESP + 0xa4]
00533396 : LEA EAX,[ESP + 0x1c]
0053339a : PUSH EAX
0053339b : CALL 0x00526bf0
005333a0 : ADD dword ptr [EDI + 0x8],0x10
005333a4 : MOV EAX,dword ptr [EDI + 0x8]
005333a7 : CMP EAX,dword ptr [EDI + 0x10]
005333aa : LEA ESI,[EDI + 0x8]
005333ad : JC 0x005333b6
005333af : MOV ECX,ESI
005333b1 : CALL 0x00504050
005333b6 : MOV ECX,dword ptr [ESI]
005333b8 : CMP ECX,EBX
005333ba : JZ 0x005333ce
005333bc : MOV EDX,dword ptr [ESP + 0xa0]
005333c3 : MOV byte ptr [ECX],0x5
005333c6 : MOV EAX,dword ptr [EDX]
005333c8 : MOV dword ptr [ECX + 0x4],EAX
005333cb : INC dword ptr [EAX + 0x8]
005333ce : MOV ECX,dword ptr [ESP + 0xa4]
005333d5 : CALL 0x00526400
005333da : MOV EAX,dword ptr [ESP + 0xa4]
005333e1 : MOV byte ptr [EAX],BL
005333e3 : LEA ECX,[EBP + 0x68]
005333e6 : CMP EBP,EBX
005333e8 : JNZ 0x005333ee
005333ea : MOV ECX,dword ptr [ESP + 0x18]
005333ee : MOV EDX,dword ptr [ESI]
005333f0 : SUB EDX,dword ptr [ESI + 0x4]
005333f3 : MOV EAX,dword ptr [ESI + 0x14]
005333f6 : SAR EDX,0x4
005333f9 : SHL EAX,0x5
005333fc : LEA EAX,[EDX + EAX*0x1 + -0x20]
00533400 : MOV EDX,dword ptr [ESP + 0xa4]
00533407 : MOV dword ptr [ESP + 0x2c],EDX
0053340b : MOV EDX,dword ptr [ESP + 0x20]
0053340f : MOV dword ptr [ESP + 0x30],ECX
00533413 : MOV ECX,dword ptr [ESP + 0x1c]
00533417 : PUSH EBX
00533418 : MOV EBP,0xb8ab5c
0053341d : MOV dword ptr [ESP + 0x4c],EAX
00533421 : PUSH EDX
00533422 : MOV dword ptr [ESP + 0x30],EBP
00533426 : MOV byte ptr [ESP + 0x44],BL
0053342a : MOV dword ptr [ESP + 0x3c],EBX
0053342e : MOV dword ptr [ESP + 0x40],EBX
00533432 : MOV dword ptr [ESP + 0x48],EDI
00533436 : MOV dword ptr [ESP + 0x4c],0x1
0053343e : MOV EAX,dword ptr [ECX]
00533440 : MOV EAX,dword ptr [EAX + 0x28]
00533443 : LEA EDX,[ESP + 0x30]
00533447 : PUSH EDX
00533448 : CALL EAX
0053344a : TEST byte ptr [ESP + 0x3c],0x2
0053344f : MOV dword ptr [ESP + 0x28],EBP
00533453 : JNZ 0x00533462
00533455 : MOV ECX,dword ptr [ESP + 0x34]
00533459 : CMP ECX,EBX
0053345b : JZ 0x00533462
0053345d : CALL 0x00503db0
00533462 : TEST byte ptr [ESP + 0x3c],0x1
00533467 : MOV dword ptr [ESP + 0x34],EBX
0053346b : JNZ 0x0053347a
0053346d : MOV ECX,dword ptr [ESP + 0x38]
00533471 : CMP ECX,EBX
00533473 : JZ 0x0053347a
00533475 : CALL 0x00503db0
0053347a : MOV ECX,dword ptr [ESI]
0053347c : CALL 0x00526bc0
00533481 : ADD dword ptr [ESI],-0x10
00533484 : MOV EAX,dword ptr [ESI]
00533486 : CMP EAX,dword ptr [ESI + 0x4]
00533489 : JNC 0x00533492
0053348b : MOV ECX,ESI
0053348d : CALL 0x00504f30
00533492 : TEST byte ptr [ESP + 0x24],0x2
00533497 : JNZ 0x005334a6
00533499 : MOV ECX,dword ptr [ESP + 0x1c]
0053349d : CMP ECX,EBX
0053349f : JZ 0x005334a6
005334a1 : CALL 0x00503db0
005334a6 : TEST byte ptr [ESP + 0x24],0x1
005334ab : MOV dword ptr [ESP + 0x1c],EBX
005334af : JNZ 0x005334be
005334b1 : MOV ECX,dword ptr [ESP + 0x20]
005334b5 : CMP ECX,EBX
005334b7 : JZ 0x005334be
005334b9 : CALL 0x00503db0
005334be : LEA ECX,[ESP + 0x5c]
005334c2 : MOV dword ptr [ESP + 0x20],EBX
005334c6 : CALL 0x00526bc0
005334cb : MOV ECX,dword ptr [ESP + 0x14]
005334cf : CMP ECX,EBX
005334d1 : JZ 0x005334d8
005334d3 : CALL 0x004ff7c0
005334d8 : MOV AL,byte ptr [ESP + 0x13]
005334dc : POP EDI
005334dd : POP ESI
005334de : POP EBP
005334df : POP EBX
005334e0 : ADD ESP,0x8c
005334e6 : RET 0x18

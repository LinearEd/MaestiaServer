PROGRAM  : Maestia.exe
FUNCTION : FUN_0057da10
ENTRY    : 0057da10
BODY     : [[0057da10, 0057db48]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0057da10(undefined4 param_1,uint *param_2,uint param_3)

{
  uint *puVar1;
  int iVar2;
  uint *puVar3;
  int *piVar4;
  int *in_ECX;
  uint uVar5;
  uint uVar6;
  int iVar7;
  
  piVar4 = (int *)*in_ECX;
  if (piVar4 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar4 * 5) <= piVar4[1] * 4 + 4U) goto LAB_0057da4a;
    iVar7 = piVar4[1] * 2 + 2;
  }
  FUN_0057d470(param_1,iVar7);
LAB_0057da4a:
  piVar4 = (int *)*in_ECX;
  param_3 = param_3 & piVar4[1];
  *piVar4 = *piVar4 + 1;
  iVar7 = *in_ECX;
  puVar1 = (uint *)(iVar7 + 8 + param_3 * 0x14);
  if (*puVar1 == 0xfffffffe) {
    *puVar1 = 0xffffffff;
    puVar1[1] = *param_2;
    FUN_0051c2c0(param_2 + 1);
    puVar1[3] = param_2[2];
    puVar1[4] = param_2[3];
    return;
  }
  uVar6 = param_3;
  do {
    uVar6 = uVar6 + 1 & *(uint *)(iVar7 + 4);
  } while (*(int *)(iVar7 + 8 + uVar6 * 0x14) != -2);
  uVar5 = puVar1[3] & *(uint *)(iVar7 + 4);
  iVar2 = iVar7 + 8 + uVar6 * 0x14;
  if (uVar5 == param_3) {
    if (iVar2 != 0) {
      FUN_0057ceb0(puVar1);
    }
    puVar1[1] = *param_2;
    FUN_0051bc20(param_2 + 1);
    puVar1[3] = param_2[2];
    puVar1[4] = param_2[3];
    *puVar1 = uVar6;
    return;
  }
  puVar3 = (uint *)(iVar7 + 8 + uVar5 * 0x14);
  for (uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x14); uVar5 != param_3;
      uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x14)) {
    uVar5 = *puVar3;
    puVar3 = (uint *)(iVar7 + 8 + uVar5 * 0x14);
  }
  if (iVar2 != 0) {
    FUN_0057ceb0(puVar1);
  }
  *puVar3 = uVar6;
  puVar1[1] = *param_2;
  FUN_0051bc20(param_2 + 1);
  puVar1[3] = param_2[2];
  puVar1[4] = param_2[3];
  *puVar1 = 0xffffffff;
  return;
}



============================================================
DISASSEMBLY
============================================================
0057da10 : PUSH ESI
0057da11 : MOV ESI,ECX
0057da13 : MOV EAX,dword ptr [ESI]
0057da15 : PUSH EDI
0057da16 : TEST EAX,EAX
0057da18 : JNZ 0x0057da23
0057da1a : MOV EAX,dword ptr [ESP + 0xc]
0057da1e : PUSH 0x8
0057da20 : PUSH EAX
0057da21 : JMP 0x0057da45
0057da23 : MOV ECX,dword ptr [EAX + 0x4]
0057da26 : LEA EDX,[ECX*0x4 + 0x4]
0057da2d : MOV ECX,dword ptr [EAX]
0057da2f : LEA ECX,[ECX + ECX*0x4]
0057da32 : CMP ECX,EDX
0057da34 : JBE 0x0057da4a
0057da36 : MOV EDX,dword ptr [EAX + 0x4]
0057da39 : MOV ECX,dword ptr [ESP + 0xc]
0057da3d : LEA EAX,[EDX + EDX*0x1 + 0x2]
0057da41 : PUSH EAX
0057da42 : PUSH ECX
0057da43 : MOV ECX,ESI
0057da45 : CALL 0x0057d470
0057da4a : MOV ECX,dword ptr [ESI]
0057da4c : MOV EAX,dword ptr [ESP + 0x14]
0057da50 : AND EAX,dword ptr [ECX + 0x4]
0057da53 : INC dword ptr [ECX]
0057da55 : MOV EDX,dword ptr [ESI]
0057da57 : LEA ECX,[EAX + EAX*0x4]
0057da5a : LEA ESI,[EDX + ECX*0x4 + 0x8]
0057da5e : MOV ECX,0xfffffffe
0057da63 : CMP dword ptr [ESI],ECX
0057da65 : JNZ 0x0057da93
0057da67 : MOV EDI,dword ptr [ESP + 0x10]
0057da6b : MOV dword ptr [ESI],0xffffffff
0057da71 : MOV EDX,dword ptr [EDI]
0057da73 : LEA EAX,[EDI + 0x4]
0057da76 : PUSH EAX
0057da77 : LEA ECX,[ESI + 0x8]
0057da7a : MOV dword ptr [ESI + 0x4],EDX
0057da7d : CALL 0x0051c2c0
0057da82 : MOV ECX,dword ptr [EDI + 0x8]
0057da85 : MOV dword ptr [ESI + 0xc],ECX
0057da88 : MOV EDX,dword ptr [EDI + 0xc]
0057da8b : POP EDI
0057da8c : MOV dword ptr [ESI + 0x10],EDX
0057da8f : POP ESI
0057da90 : RET 0xc
0057da93 : PUSH EBX
0057da94 : PUSH EBP
0057da95 : MOV EBP,dword ptr [EDX + 0x4]
0057da98 : MOV EDI,EAX
0057da9a : LEA EBX,[EBX]
0057daa0 : INC EDI
0057daa1 : AND EDI,EBP
0057daa3 : LEA EBX,[EDI + EDI*0x4]
0057daa6 : CMP dword ptr [EDX + EBX*0x4 + 0x8],ECX
0057daaa : JNZ 0x0057daa0
0057daac : MOV EBX,dword ptr [ESI + 0xc]
0057daaf : AND EBX,EBP
0057dab1 : LEA ECX,[EDI + EDI*0x4]
0057dab4 : LEA ECX,[EDX + ECX*0x4 + 0x8]
0057dab8 : CMP EBX,EAX
0057daba : JNZ 0x0057daf0
0057dabc : TEST ECX,ECX
0057dabe : JZ 0x0057dac6
0057dac0 : PUSH ESI
0057dac1 : CALL 0x0057ceb0
0057dac6 : MOV EBX,dword ptr [ESP + 0x18]
0057daca : MOV EDX,dword ptr [EBX]
0057dacc : LEA EAX,[EBX + 0x4]
0057dacf : PUSH EAX
0057dad0 : LEA ECX,[ESI + 0x8]
0057dad3 : MOV dword ptr [ESI + 0x4],EDX
0057dad6 : CALL 0x0051bc20
0057dadb : MOV ECX,dword ptr [EBX + 0x8]
0057dade : MOV dword ptr [ESI + 0xc],ECX
0057dae1 : MOV EDX,dword ptr [EBX + 0xc]
0057dae4 : POP EBP
0057dae5 : MOV dword ptr [ESI + 0x10],EDX
0057dae8 : POP EBX
0057dae9 : MOV dword ptr [ESI],EDI
0057daeb : POP EDI
0057daec : POP ESI
0057daed : RET 0xc
0057daf0 : LEA EBX,[EBX + EBX*0x4]
0057daf3 : CMP dword ptr [EDX + EBX*0x4 + 0x8],EAX
0057daf7 : LEA EBX,[EDX + EBX*0x4 + 0x8]
0057dafb : JZ 0x0057db0f
0057dafd : LEA ECX,[ECX]
0057db00 : MOV EBX,dword ptr [EBX]
0057db02 : LEA EBX,[EBX + EBX*0x4]
0057db05 : CMP dword ptr [EDX + EBX*0x4 + 0x8],EAX
0057db09 : LEA EBX,[EDX + EBX*0x4 + 0x8]
0057db0d : JNZ 0x0057db00
0057db0f : TEST ECX,ECX
0057db11 : JZ 0x0057db19
0057db13 : PUSH ESI
0057db14 : CALL 0x0057ceb0
0057db19 : MOV dword ptr [EBX],EDI
0057db1b : MOV EDI,dword ptr [ESP + 0x18]
0057db1f : MOV EAX,dword ptr [EDI]
0057db21 : LEA ECX,[EDI + 0x4]
0057db24 : PUSH ECX
0057db25 : LEA ECX,[ESI + 0x8]
0057db28 : MOV dword ptr [ESI + 0x4],EAX
0057db2b : CALL 0x0051bc20
0057db30 : MOV EDX,dword ptr [EDI + 0x8]
0057db33 : POP EBP
0057db34 : MOV dword ptr [ESI + 0xc],EDX
0057db37 : MOV EAX,dword ptr [EDI + 0xc]
0057db3a : POP EBX
0057db3b : MOV dword ptr [ESI + 0x10],EAX
0057db3e : POP EDI
0057db3f : MOV dword ptr [ESI],0xffffffff
0057db45 : POP ESI
0057db46 : RET 0xc

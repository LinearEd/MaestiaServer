PROGRAM  : Maestia.exe
FUNCTION : FUN_008ff880
ENTRY    : 008ff880
BODY     : [[008ff880, 008ff92c] [008ff930, 008ffc59] [008ffc5c, 008ffcb8]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008ff880(int param_1,undefined4 param_2)

{
  short sVar1;
  wchar_t wVar2;
  ulonglong uVar3;
  short *psVar4;
  int iVar5;
  uint8_t *puVar6;
  wchar_t *pwVar7;
  wchar_t *pwVar8;
  wchar_t *pwVar9;
  byte bVar10;
  short *psVar11;
  bool bVar12;
  undefined1 auStack_8c [4];
  uint8_t *local_88;
  int *local_84;
  undefined1 local_80 [4];
  int local_7c;
  undefined4 local_78;
  undefined4 local_74;
  undefined1 local_70 [4];
  undefined2 local_6c;
  undefined4 local_5c;
  uint local_58;
  undefined1 local_54 [4];
  undefined2 local_50;
  undefined4 local_40;
  uint local_3c;
  undefined4 local_34;
  undefined4 local_24;
  uint local_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  int local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b601b0;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_8c;
  ExceptionList = &local_14;
  FUN_00403dd0(param_2,DAT_00d66fa0 ^ (uint)&stack0xffffff68);
  local_c = 0;
  local_58 = 7;
  local_5c = 0;
  local_6c = 0;
  FUN_00406360(&DAT_00c62918,1);
  local_c._0_1_ = 1;
  psVar11 = local_34;
  if (local_20 < 8) {
    psVar11 = (short *)&local_34;
  }
  local_3c = 7;
  local_40 = 0;
  local_50 = 0;
  psVar4 = psVar11;
  do {
    sVar1 = *psVar4;
    psVar4 = psVar4 + 1;
  } while (sVar1 != 0);
  FUN_00406360(psVar11,(int)psVar4 - (int)(psVar11 + 1) >> 1);
  local_c._0_1_ = 2;
  FUN_0070cd60(local_80,local_54,local_70,0);
  local_c = CONCAT31(local_c._1_3_,4);
  if (7 < local_3c) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_3c = 7;
  local_40 = 0;
  local_50 = 0;
  local_c._0_1_ = 5;
  if (7 < local_58) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_6c = 0;
  local_88 = *(uint8_t **)(param_1 + 0x18);
  local_58 = 7;
  local_5c = 0;
  pwVar7 = (wchar_t *)(param_1 + 4);
  pwVar9 = pwVar7;
  if (&DAT_00000008 <= local_88) {
    pwVar9 = *(wchar_t **)pwVar7;
  }
  pwVar8 = L"onInit";
  do {
    wVar2 = *pwVar9;
    bVar12 = (ushort)wVar2 < (ushort)*pwVar8;
    if (wVar2 != *pwVar8) {
LAB_008ffa06:
      iVar5 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
      goto LAB_008ffa0b;
    }
    if (wVar2 == L'\0') break;
    wVar2 = pwVar9[1];
    bVar12 = (ushort)wVar2 < (ushort)pwVar8[1];
    if (wVar2 != pwVar8[1]) goto LAB_008ffa06;
    pwVar9 = pwVar9 + 2;
    pwVar8 = pwVar8 + 2;
  } while (wVar2 != L'\0');
  iVar5 = 0;
LAB_008ffa0b:
  if (iVar5 == 0) {
    iVar5 = *(int *)ThreadLocalStoragePointer;
    bVar10 = (byte)((ulonglong)(*(byte *)(iVar5 + 0x18) + 1) % 3);
    *(byte *)(iVar5 + 0x18) = bVar10;
    local_88 = (uint8_t *)((uint)bVar10 * 0x2000 + 0x122cb8 + iVar5);
    if (local_88 == (uint8_t *)0x0) {
      puVar6 = (uint8_t *)0x0;
    }
    else {
      iVar5 = local_84[0xf];
      local_88[0] = '\0';
      local_88[1] = '\0';
      local_88[2] = '?';
      local_88[3] = '\x0f';
      *(short *)(local_88 + 4) = (short)iVar5;
      local_88[6] = '\x03';
      local_88[7] = '\x02';
      puVar6 = local_88;
    }
    local_c._0_1_ = 5;
    if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
      FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),8,puVar6);
    }
    FUN_008fe340();
    goto LAB_008ffc30;
  }
  pwVar9 = pwVar7;
  if (&DAT_00000008 <= local_88) {
    pwVar9 = *(wchar_t **)pwVar7;
  }
  pwVar8 = L"Take";
  do {
    wVar2 = *pwVar9;
    bVar12 = (ushort)wVar2 < (ushort)*pwVar8;
    if (wVar2 != *pwVar8) {
LAB_008ffadc:
      iVar5 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
      goto LAB_008ffae1;
    }
    if (wVar2 == L'\0') break;
    wVar2 = pwVar9[1];
    bVar12 = (ushort)wVar2 < (ushort)pwVar8[1];
    if (wVar2 != pwVar8[1]) goto LAB_008ffadc;
    pwVar9 = pwVar9 + 2;
    pwVar8 = pwVar8 + 2;
  } while (wVar2 != L'\0');
  iVar5 = 0;
LAB_008ffae1:
  if (iVar5 == 0) {
    iVar5 = *(int *)ThreadLocalStoragePointer;
    bVar10 = (byte)((ulonglong)(*(byte *)(iVar5 + 0x18) + 1) % 3);
    *(byte *)(iVar5 + 0x18) = bVar10;
    puVar6 = (uint8_t *)((uint)bVar10 * 0x2000 + 0x122cb8 + iVar5);
    local_88 = puVar6;
    if (puVar6 == (uint8_t *)0x0) {
LAB_008ffbbb:
      puVar6 = (uint8_t *)0x0;
    }
    else {
      puVar6[0] = '\0';
      puVar6[1] = '\0';
      puVar6[2] = '?';
      puVar6[3] = '\x12';
      puVar6[4] = '\x01';
    }
  }
  else {
    pwVar9 = pwVar7;
    if (&DAT_00000008 <= local_88) {
      pwVar9 = *(wchar_t **)pwVar7;
    }
    pwVar8 = L"Cancel";
    do {
      wVar2 = *pwVar9;
      bVar12 = (ushort)wVar2 < (ushort)*pwVar8;
      if (wVar2 != *pwVar8) {
LAB_008ffb6a:
        iVar5 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
        goto LAB_008ffb6f;
      }
      if (wVar2 == L'\0') break;
      wVar2 = pwVar9[1];
      bVar12 = (ushort)wVar2 < (ushort)pwVar8[1];
      if (wVar2 != pwVar8[1]) goto LAB_008ffb6a;
      pwVar9 = pwVar9 + 2;
      pwVar8 = pwVar8 + 2;
    } while (wVar2 != L'\0');
    iVar5 = 0;
LAB_008ffb6f:
    if (iVar5 != 0) {
      if (&DAT_00000008 <= local_88) {
        pwVar7 = *(wchar_t **)pwVar7;
      }
      pwVar9 = L"Close";
      do {
        wVar2 = *pwVar7;
        bVar12 = (ushort)wVar2 < (ushort)*pwVar9;
        if (wVar2 != *pwVar9) {
LAB_008ffc1c:
          iVar5 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
          goto LAB_008ffc21;
        }
        if (wVar2 == L'\0') break;
        wVar2 = pwVar7[1];
        bVar12 = (ushort)wVar2 < (ushort)pwVar9[1];
        if (wVar2 != pwVar9[1]) goto LAB_008ffc1c;
        pwVar7 = pwVar7 + 2;
        pwVar9 = pwVar9 + 2;
      } while (wVar2 != L'\0');
      iVar5 = 0;
LAB_008ffc21:
      if (iVar5 == 0) {
        (**(code **)(*local_84 + 0x20))();
      }
      goto LAB_008ffc30;
    }
    iVar5 = *(int *)ThreadLocalStoragePointer;
    uVar3 = (ulonglong)(*(byte *)(iVar5 + 0x18) + 1) % 3;
    puVar6 = (uint8_t *)((int)uVar3 * 0x2000 + 0x122cb8 + iVar5);
    *(char *)(iVar5 + 0x18) = (char)uVar3;
    local_88 = puVar6;
    if (puVar6 == (uint8_t *)0x0) goto LAB_008ffbbb;
    puVar6[0] = '\0';
    puVar6[1] = '\0';
    puVar6[2] = '?';
    puVar6[3] = '\x12';
    puVar6[4] = '\0';
  }
  local_c._0_1_ = 5;
  if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
    FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),5,puVar6);
  }
LAB_008ffc30:
  local_c = (uint)local_c._1_3_ << 8;
  if (local_7c != 0) {
    FUN_00405450(local_88);
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_7c = 0;
  local_78 = 0;
  local_74 = 0;
  local_c = 0xffffffff;
  if (local_20 < 8) {
    local_20 = 7;
    local_24 = 0;
    local_34 = (short *)((uint)local_34._2_2_ << 0x10);
    ExceptionList = local_14;
    __security_check_cookie(local_1c ^ (uint)auStack_8c);
    return;
  }
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
008ff880 : PUSH EBP
008ff881 : MOV EBP,ESP
008ff883 : AND ESP,0xfffffff8
008ff886 : PUSH -0x1
008ff888 : PUSH 0xb601b0
008ff88d : MOV EAX,FS:[0x0]
008ff893 : PUSH EAX
008ff894 : SUB ESP,0x78
008ff897 : MOV EAX,[0x00d66fa0]
008ff89c : XOR EAX,ESP
008ff89e : MOV dword ptr [ESP + 0x70],EAX
008ff8a2 : PUSH EBX
008ff8a3 : PUSH ESI
008ff8a4 : PUSH EDI
008ff8a5 : MOV EAX,[0x00d66fa0]
008ff8aa : XOR EAX,ESP
008ff8ac : PUSH EAX
008ff8ad : LEA EAX,[ESP + 0x88]
008ff8b4 : MOV FS:[0x0],EAX
008ff8ba : MOV EAX,dword ptr [EBP + 0xc]
008ff8bd : PUSH EAX
008ff8be : LEA ESI,[ESP + 0x68]
008ff8c2 : MOV dword ptr [ESP + 0x1c],ECX
008ff8c6 : CALL 0x00403dd0
008ff8cb : ADD ESP,0x4
008ff8ce : XOR EDI,EDI
008ff8d0 : MOV dword ptr [ESP + 0x90],EDI
008ff8d7 : PUSH 0x1
008ff8d9 : XOR EAX,EAX
008ff8db : MOV ESI,0x7
008ff8e0 : PUSH 0xc62918
008ff8e5 : LEA ECX,[ESP + 0x34]
008ff8e9 : MOV dword ptr [ESP + 0x4c],ESI
008ff8ed : MOV dword ptr [ESP + 0x48],EDI
008ff8f1 : MOV word ptr [ESP + 0x38],AX
008ff8f6 : CALL 0x00406360
008ff8fb : MOV byte ptr [ESP + 0x90],0x1
008ff903 : CMP dword ptr [ESP + 0x7c],0x8
008ff908 : MOV EDX,dword ptr [ESP + 0x68]
008ff90c : JNC 0x008ff912
008ff90e : LEA EDX,[ESP + 0x68]
008ff912 : XOR ECX,ECX
008ff914 : MOV EAX,EDX
008ff916 : MOV dword ptr [ESP + 0x60],ESI
008ff91a : MOV dword ptr [ESP + 0x5c],EDI
008ff91e : MOV word ptr [ESP + 0x4c],CX
008ff923 : LEA ESI,[EAX + 0x2]
008ff926 : MOV EBX,0x2
008ff92b : JMP 0x008ff930
008ff930 : MOV CX,word ptr [EAX]
008ff933 : ADD EAX,EBX
008ff935 : CMP CX,DI
008ff938 : JNZ 0x008ff930
008ff93a : SUB EAX,ESI
008ff93c : SAR EAX,0x1
008ff93e : PUSH EAX
008ff93f : PUSH EDX
008ff940 : LEA ECX,[ESP + 0x50]
008ff944 : CALL 0x00406360
008ff949 : MOV byte ptr [ESP + 0x90],BL
008ff950 : PUSH EDI
008ff951 : LEA EDX,[ESP + 0x30]
008ff955 : PUSH EDX
008ff956 : LEA EAX,[ESP + 0x50]
008ff95a : PUSH EAX
008ff95b : LEA ECX,[ESP + 0x28]
008ff95f : PUSH ECX
008ff960 : CALL 0x0070cd60
008ff965 : ADD ESP,0x10
008ff968 : MOV byte ptr [ESP + 0x90],0x4
008ff970 : MOV ESI,0x8
008ff975 : CMP dword ptr [ESP + 0x60],ESI
008ff979 : JC 0x008ff984
008ff97b : MOV ECX,dword ptr [ESP + 0x4c]
008ff97f : CALL 0x006f04e0
008ff984 : XOR EDX,EDX
008ff986 : MOV dword ptr [ESP + 0x60],0x7
008ff98e : MOV dword ptr [ESP + 0x5c],EDI
008ff992 : MOV word ptr [ESP + 0x4c],DX
008ff997 : MOV byte ptr [ESP + 0x90],0x5
008ff99f : CMP dword ptr [ESP + 0x44],ESI
008ff9a3 : JC 0x008ff9ae
008ff9a5 : MOV ECX,dword ptr [ESP + 0x30]
008ff9a9 : CALL 0x006f04e0
008ff9ae : XOR EAX,EAX
008ff9b0 : MOV word ptr [ESP + 0x30],AX
008ff9b5 : MOV EAX,dword ptr [EBP + 0x8]
008ff9b8 : MOV ECX,dword ptr [EAX + 0x18]
008ff9bb : CMP ECX,ESI
008ff9bd : MOV dword ptr [ESP + 0x44],0x7
008ff9c5 : MOV dword ptr [ESP + 0x40],EDI
008ff9c9 : MOV dword ptr [ESP + 0x14],ECX
008ff9cd : LEA ESI,[EAX + 0x4]
008ff9d0 : JC 0x008ff9d6
008ff9d2 : MOV EAX,dword ptr [ESI]
008ff9d4 : JMP 0x008ff9d8
008ff9d6 : MOV EAX,ESI
008ff9d8 : MOV ECX,0xc6291c
008ff9dd : LEA ECX,[ECX]
008ff9e0 : MOV DX,word ptr [EAX]
008ff9e3 : CMP DX,word ptr [ECX]
008ff9e6 : JNZ 0x008ffa06
008ff9e8 : CMP DX,DI
008ff9eb : JZ 0x008ffa02
008ff9ed : MOV DX,word ptr [EAX + 0x2]
008ff9f1 : CMP DX,word ptr [ECX + 0x2]
008ff9f5 : JNZ 0x008ffa06
008ff9f7 : ADD EAX,0x4
008ff9fa : ADD ECX,0x4
008ff9fd : CMP DX,DI
008ffa00 : JNZ 0x008ff9e0
008ffa02 : XOR EAX,EAX
008ffa04 : JMP 0x008ffa0b
008ffa06 : SBB EAX,EAX
008ffa08 : SBB EAX,-0x1
008ffa0b : CMP EAX,EDI
008ffa0d : JNZ 0x008ffaa2
008ffa13 : MOV ECX,dword ptr FS:[0x2c]
008ffa1a : MOV ECX,dword ptr [ECX]
008ffa1c : MOVZX EAX,byte ptr [ECX + 0x18]
008ffa20 : INC EAX
008ffa21 : CDQ
008ffa22 : MOV ESI,0x3
008ffa27 : IDIV ESI
008ffa29 : MOV byte ptr [ECX + 0x18],DL
008ffa2c : MOVZX EDX,DL
008ffa2f : SHL EDX,0xd
008ffa32 : LEA EAX,[EDX + ECX*0x1 + 0x122cb8]
008ffa39 : MOV dword ptr [ESP + 0x14],EAX
008ffa3d : MOV byte ptr [ESP + 0x90],0x6
008ffa45 : CMP EAX,EDI
008ffa47 : JZ 0x008ffa6b
008ffa49 : MOV ECX,dword ptr [ESP + 0x18]
008ffa4d : MOVZX ECX,word ptr [ECX + 0x3c]
008ffa51 : XOR EDX,EDX
008ffa53 : MOV word ptr [EAX],DX
008ffa56 : MOV byte ptr [EAX + 0x2],0x3f
008ffa5a : MOV byte ptr [EAX + 0x3],0xf
008ffa5e : MOV word ptr [EAX + 0x4],CX
008ffa62 : MOV byte ptr [EAX + 0x6],0x3
008ffa66 : MOV byte ptr [EAX + 0x7],BL
008ffa69 : JMP 0x008ffa6d
008ffa6b : XOR EAX,EAX
008ffa6d : MOV byte ptr [ESP + 0x90],0x5
008ffa75 : MOV EDX,dword ptr [0x017247d4]
008ffa7b : MOV ECX,dword ptr [EDX + 0x4]
008ffa7e : CMP ECX,EDI
008ffa80 : JZ 0x008ffa94
008ffa82 : CMP byte ptr [EDX + 0x8],0x0
008ffa86 : JZ 0x008ffa94
008ffa88 : PUSH 0x8
008ffa8a : PUSH ECX
008ffa8b : MOV EDI,EAX
008ffa8d : CALL 0x00a0dd40
008ffa92 : XOR EDI,EDI
008ffa94 : MOV ECX,dword ptr [ESP + 0x18]
008ffa98 : CALL 0x008fe340
008ffa9d : JMP 0x008ffc30
008ffaa2 : MOV EBX,dword ptr [ESP + 0x14]
008ffaa6 : CMP EBX,0x8
008ffaa9 : JC 0x008ffaaf
008ffaab : MOV EAX,dword ptr [ESI]
008ffaad : JMP 0x008ffab1
008ffaaf : MOV EAX,ESI
008ffab1 : MOV ECX,0xc6292c
008ffab6 : MOV DX,word ptr [EAX]
008ffab9 : CMP DX,word ptr [ECX]
008ffabc : JNZ 0x008ffadc
008ffabe : CMP DX,DI
008ffac1 : JZ 0x008ffad8
008ffac3 : MOV DX,word ptr [EAX + 0x2]
008ffac7 : CMP DX,word ptr [ECX + 0x2]
008ffacb : JNZ 0x008ffadc
008ffacd : ADD EAX,0x4
008ffad0 : ADD ECX,0x4
008ffad3 : CMP DX,DI
008ffad6 : JNZ 0x008ffab6
008ffad8 : XOR EAX,EAX
008ffada : JMP 0x008ffae1
008ffadc : SBB EAX,EAX
008ffade : SBB EAX,-0x1
008ffae1 : CMP EAX,EDI
008ffae3 : JNZ 0x008ffb34
008ffae5 : MOV EAX,FS:[0x2c]
008ffaeb : MOV ECX,dword ptr [EAX]
008ffaed : MOVZX EAX,byte ptr [ECX + 0x18]
008ffaf1 : INC EAX
008ffaf2 : CDQ
008ffaf3 : MOV ESI,0x3
008ffaf8 : IDIV ESI
008ffafa : MOV byte ptr [ECX + 0x18],DL
008ffafd : MOVZX EDX,DL
008ffb00 : SHL EDX,0xd
008ffb03 : LEA EAX,[EDX + ECX*0x1 + 0x122cb8]
008ffb0a : MOV dword ptr [ESP + 0x14],EAX
008ffb0e : MOV byte ptr [ESP + 0x90],0x7
008ffb16 : CMP EAX,EDI
008ffb18 : JZ 0x008ffbbb
008ffb1e : XOR ECX,ECX
008ffb20 : MOV word ptr [EAX],CX
008ffb23 : MOV byte ptr [EAX + 0x2],0x3f
008ffb27 : MOV byte ptr [EAX + 0x3],0x12
008ffb2b : MOV byte ptr [EAX + 0x4],0x1
008ffb2f : JMP 0x008ffbbd
008ffb34 : CMP EBX,0x8
008ffb37 : JC 0x008ffb3d
008ffb39 : MOV EAX,dword ptr [ESI]
008ffb3b : JMP 0x008ffb3f
008ffb3d : MOV EAX,ESI
008ffb3f : MOV ECX,0xc62938
008ffb44 : MOV DX,word ptr [EAX]
008ffb47 : CMP DX,word ptr [ECX]
008ffb4a : JNZ 0x008ffb6a
008ffb4c : CMP DX,DI
008ffb4f : JZ 0x008ffb66
008ffb51 : MOV DX,word ptr [EAX + 0x2]
008ffb55 : CMP DX,word ptr [ECX + 0x2]
008ffb59 : JNZ 0x008ffb6a
008ffb5b : ADD EAX,0x4
008ffb5e : ADD ECX,0x4
008ffb61 : CMP DX,DI
008ffb64 : JNZ 0x008ffb44
008ffb66 : XOR EAX,EAX
008ffb68 : JMP 0x008ffb6f
008ffb6a : SBB EAX,EAX
008ffb6c : SBB EAX,-0x1
008ffb6f : CMP EAX,EDI
008ffb71 : JNZ 0x008ffbe6
008ffb73 : MOV EDX,dword ptr FS:[0x2c]
008ffb7a : MOV ECX,dword ptr [EDX]
008ffb7c : MOVZX EAX,byte ptr [ECX + 0x18]
008ffb80 : INC EAX
008ffb81 : CDQ
008ffb82 : MOV ESI,0x3
008ffb87 : IDIV ESI
008ffb89 : MOVZX EAX,DL
008ffb8c : SHL EAX,0xd
008ffb8f : LEA EAX,[EAX + ECX*0x1 + 0x122cb8]
008ffb96 : MOV byte ptr [ECX + 0x18],DL
008ffb99 : MOV dword ptr [ESP + 0x14],EAX
008ffb9d : MOV byte ptr [ESP + 0x90],0x8
008ffba5 : CMP EAX,EDI
008ffba7 : JZ 0x008ffbbb
008ffba9 : XOR ECX,ECX
008ffbab : MOV word ptr [EAX],CX
008ffbae : MOV byte ptr [EAX + 0x2],0x3f
008ffbb2 : MOV byte ptr [EAX + 0x3],0x12
008ffbb6 : MOV byte ptr [EAX + 0x4],CL
008ffbb9 : JMP 0x008ffbbd
008ffbbb : XOR EAX,EAX
008ffbbd : MOV byte ptr [ESP + 0x90],0x5
008ffbc5 : MOV EDX,dword ptr [0x017247d4]
008ffbcb : MOV ECX,dword ptr [EDX + 0x4]
008ffbce : CMP ECX,EDI
008ffbd0 : JZ 0x008ffc30
008ffbd2 : CMP byte ptr [EDX + 0x8],0x0
008ffbd6 : JZ 0x008ffc30
008ffbd8 : PUSH 0x5
008ffbda : PUSH ECX
008ffbdb : MOV EDI,EAX
008ffbdd : CALL 0x00a0dd40
008ffbe2 : XOR EDI,EDI
008ffbe4 : JMP 0x008ffc30
008ffbe6 : CMP EBX,0x8
008ffbe9 : JC 0x008ffbef
008ffbeb : MOV EAX,dword ptr [ESI]
008ffbed : JMP 0x008ffbf1
008ffbef : MOV EAX,ESI
008ffbf1 : MOV ECX,0xc62948
008ffbf6 : MOV DX,word ptr [EAX]
008ffbf9 : CMP DX,word ptr [ECX]
008ffbfc : JNZ 0x008ffc1c
008ffbfe : CMP DX,DI
008ffc01 : JZ 0x008ffc18
008ffc03 : MOV DX,word ptr [EAX + 0x2]
008ffc07 : CMP DX,word ptr [ECX + 0x2]
008ffc0b : JNZ 0x008ffc1c
008ffc0d : ADD EAX,0x4
008ffc10 : ADD ECX,0x4
008ffc13 : CMP DX,DI
008ffc16 : JNZ 0x008ffbf6
008ffc18 : XOR EAX,EAX
008ffc1a : JMP 0x008ffc21
008ffc1c : SBB EAX,EAX
008ffc1e : SBB EAX,-0x1
008ffc21 : CMP EAX,EDI
008ffc23 : JNZ 0x008ffc30
008ffc25 : MOV ECX,dword ptr [ESP + 0x18]
008ffc29 : MOV EDX,dword ptr [ECX]
008ffc2b : MOV EAX,dword ptr [EDX + 0x20]
008ffc2e : CALL EAX
008ffc30 : MOV byte ptr [ESP + 0x90],0x0
008ffc38 : MOV EAX,dword ptr [ESP + 0x20]
008ffc3c : CMP EAX,EDI
008ffc3e : JZ 0x008ffc5c
008ffc40 : MOV ECX,dword ptr [ESP + 0x14]
008ffc44 : MOV EDI,dword ptr [ESP + 0x24]
008ffc48 : PUSH ECX
008ffc49 : CALL 0x00405450
008ffc4e : MOV ECX,dword ptr [ESP + 0x24]
008ffc52 : ADD ESP,0x4
008ffc55 : CALL 0x006f04e0
008ffc5c : MOV dword ptr [ESP + 0x20],EDI
008ffc60 : MOV dword ptr [ESP + 0x24],EDI
008ffc64 : MOV dword ptr [ESP + 0x28],EDI
008ffc68 : MOV dword ptr [ESP + 0x90],0xffffffff
008ffc73 : CMP dword ptr [ESP + 0x7c],0x8
008ffc78 : JC 0x008ffc83
008ffc7a : MOV ECX,dword ptr [ESP + 0x68]
008ffc7e : CALL 0x006f04e0
008ffc83 : XOR EDX,EDX
008ffc85 : MOV dword ptr [ESP + 0x7c],0x7
008ffc8d : MOV dword ptr [ESP + 0x78],EDI
008ffc91 : MOV word ptr [ESP + 0x68],DX
008ffc96 : MOV ECX,dword ptr [ESP + 0x88]
008ffc9d : MOV dword ptr FS:[0x0],ECX
008ffca4 : POP ECX
008ffca5 : POP EDI
008ffca6 : POP ESI
008ffca7 : POP EBX
008ffca8 : MOV ECX,dword ptr [ESP + 0x70]
008ffcac : XOR ECX,ESP
008ffcae : CALL 0x00633e6b
008ffcb3 : MOV ESP,EBP
008ffcb5 : POP EBP
008ffcb6 : RET 0x8

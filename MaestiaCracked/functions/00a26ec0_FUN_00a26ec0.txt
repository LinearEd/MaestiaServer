PROGRAM  : Maestia.exe
FUNCTION : FUN_00a26ec0
ENTRY    : 00a26ec0
BODY     : [[00a26ec0, 00a2707f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a26ec0(int param_1)

{
  uint uVar1;
  short *psVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  short in_CX;
  undefined1 *puVar6;
  undefined1 local_88 [48];
  int local_58;
  int local_54;
  int local_50;
  uint local_4c;
  undefined1 local_48 [24];
  undefined1 local_30 [24];
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b391e9;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_18 = uVar1;
  FUN_004080a0(param_1 + 0x398,&local_50,*(undefined4 *)(param_1 + 0x39c),
               *(undefined4 *)(param_1 + 0x3a0));
  local_4c = 0;
  if (DAT_0172491c != 0) {
    for (psVar2 = *(short **)(DAT_0172491c + 0x3b4); psVar2 != *(short **)(DAT_0172491c + 0x3b8);
        psVar2 = psVar2 + 3) {
      if (*psVar2 == in_CX) {
        local_4c = (uint)(ushort)psVar2[1];
        goto LAB_00a26f3e;
      }
    }
    local_4c = 0;
LAB_00a26f3e:
    if (local_4c == 0) {
      local_4c = 4;
    }
  }
  iVar3 = FUN_00703c00(0x301,uVar1);
  if (iVar3 == 0) {
    FUN_008018d0(L"[ERROR][AvaGuiRvREvent::BuildTowers] fail to find zonedata %d\n");
  }
  else {
    local_50 = iVar3 + 0x29c;
    local_58 = (**(code **)(*(int *)(iVar3 + 0x29c) + 4))();
    while (local_58 != 0) {
      iVar3 = FUN_004f5680();
      local_54 = (**(code **)(*(int *)(iVar3 + 0x78) + 4))();
      while (local_54 != 0) {
        iVar4 = FUN_004f5680();
        if ((iVar4 != 0) && ((*(uint *)(iVar4 + 0xa0) & 0x4000000) != 0)) {
          puVar6 = *(undefined1 **)(iVar3 + 0x74);
          if (puVar6 == (undefined1 *)0x0) {
            puVar6 = local_30;
          }
          if (*(ushort *)(puVar6 + 6) == local_4c) {
            puVar6 = *(undefined1 **)(iVar3 + 0x74);
            if (puVar6 == (undefined1 *)0x0) {
              puVar6 = local_48;
            }
            uVar5 = FUN_0040dde0(local_88,*(undefined2 *)(iVar4 + 0x82),
                                 *(undefined2 *)(iVar4 + 0x84),*(undefined2 *)(puVar6 + 6));
            local_8 = 0;
            FUN_004070c0(uVar5);
            local_8 = 0xffffffff;
            FUN_00406c60(local_88);
          }
        }
      }
      local_54 = 0;
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a26ec0 : PUSH EBP
00a26ec1 : MOV EBP,ESP
00a26ec3 : PUSH -0x1
00a26ec5 : PUSH 0xb391e9
00a26eca : MOV EAX,FS:[0x0]
00a26ed0 : PUSH EAX
00a26ed1 : SUB ESP,0x78
00a26ed4 : MOV EAX,[0x00d66fa0]
00a26ed9 : XOR EAX,EBP
00a26edb : MOV dword ptr [EBP + -0x14],EAX
00a26ede : PUSH EBX
00a26edf : PUSH ESI
00a26ee0 : PUSH EDI
00a26ee1 : PUSH EAX
00a26ee2 : LEA EAX,[EBP + -0xc]
00a26ee5 : MOV FS:[0x0],EAX
00a26eeb : MOV EDI,ECX
00a26eed : MOV EAX,dword ptr [EBP + 0x8]
00a26ef0 : MOV ECX,dword ptr [EAX + 0x39c]
00a26ef6 : LEA EBX,[EAX + 0x398]
00a26efc : MOV EAX,dword ptr [EBX + 0x8]
00a26eff : PUSH EAX
00a26f00 : PUSH ECX
00a26f01 : LEA EAX,[EBP + -0x4c]
00a26f04 : PUSH EAX
00a26f05 : PUSH EBX
00a26f06 : CALL 0x004080a0
00a26f0b : MOV ECX,dword ptr [0x0172491c]
00a26f11 : MOV dword ptr [EBP + -0x48],0x0
00a26f18 : TEST ECX,ECX
00a26f1a : JZ 0x00a26f4f
00a26f1c : MOV EAX,dword ptr [ECX + 0x3b4]
00a26f22 : MOV ECX,dword ptr [ECX + 0x3b8]
00a26f28 : CMP EAX,ECX
00a26f2a : JZ 0x00a26f3c
00a26f2c : LEA ESP,[ESP]
00a26f30 : CMP word ptr [EAX],DI
00a26f33 : JZ 0x00a26f79
00a26f35 : ADD EAX,0x6
00a26f38 : CMP EAX,ECX
00a26f3a : JNZ 0x00a26f30
00a26f3c : XOR EAX,EAX
00a26f3e : MOVZX EAX,AX
00a26f41 : MOV dword ptr [EBP + -0x48],EAX
00a26f44 : TEST EAX,EAX
00a26f46 : JNZ 0x00a26f4f
00a26f48 : MOV dword ptr [EBP + -0x48],0x4
00a26f4f : PUSH 0x301
00a26f54 : CALL 0x00703c00
00a26f59 : ADD ESP,0x4
00a26f5c : TEST EAX,EAX
00a26f5e : JNZ 0x00a26f7f
00a26f60 : MOV ESI,dword ptr [0x00da98e8]
00a26f66 : PUSH EDI
00a26f67 : PUSH 0xcc48f0
00a26f6c : CALL 0x008018d0
00a26f71 : ADD ESP,0x8
00a26f74 : JMP 0x00a27062
00a26f79 : MOVZX EAX,word ptr [EAX + 0x2]
00a26f7d : JMP 0x00a26f3e
00a26f7f : MOV EDX,dword ptr [EAX + 0x29c]
00a26f85 : LEA ESI,[EAX + 0x29c]
00a26f8b : MOV EAX,dword ptr [EDX + 0x4]
00a26f8e : MOV ECX,ESI
00a26f90 : MOV dword ptr [EBP + -0x4c],ESI
00a26f93 : CALL EAX
00a26f95 : MOV dword ptr [EBP + -0x54],EAX
00a26f98 : TEST EAX,EAX
00a26f9a : JZ 0x00a27062
00a26fa0 : JMP 0x00a26fa5
00a26fa2 : MOV ESI,dword ptr [EBP + -0x4c]
00a26fa5 : LEA EDX,[EBP + -0x54]
00a26fa8 : MOV EAX,ESI
00a26faa : CALL 0x004f5680
00a26faf : MOV ESI,EAX
00a26fb1 : MOV EDX,dword ptr [ESI + 0x78]
00a26fb4 : MOV EAX,dword ptr [EDX + 0x4]
00a26fb7 : LEA EDI,[ESI + 0x78]
00a26fba : MOV ECX,EDI
00a26fbc : CALL EAX
00a26fbe : MOV dword ptr [EBP + -0x50],EAX
00a26fc1 : TEST EAX,EAX
00a26fc3 : JZ 0x00a27058
00a26fc9 : LEA ESP,[ESP]
00a26fd0 : LEA EDX,[EBP + -0x50]
00a26fd3 : MOV EAX,EDI
00a26fd5 : CALL 0x004f5680
00a26fda : TEST EAX,EAX
00a26fdc : JZ 0x00a2704e
00a26fde : TEST dword ptr [EAX + 0xa0],0x4000000
00a26fe8 : JZ 0x00a2704e
00a26fea : MOV ECX,dword ptr [ESI + 0x74]
00a26fed : TEST ECX,ECX
00a26fef : JNZ 0x00a26ff4
00a26ff1 : LEA ECX,[EBP + -0x2c]
00a26ff4 : MOVZX ECX,word ptr [ECX + 0x6]
00a26ff8 : CMP ECX,dword ptr [EBP + -0x48]
00a26ffb : JNZ 0x00a2704e
00a26ffd : MOV ECX,dword ptr [ESI + 0x74]
00a27000 : TEST ECX,ECX
00a27002 : JNZ 0x00a27007
00a27004 : LEA ECX,[EBP + -0x44]
00a27007 : MOVZX EDX,word ptr [ECX + 0x6]
00a2700b : MOVZX ECX,word ptr [EAX + 0x84]
00a27012 : PUSH EDX
00a27013 : MOVZX EDX,word ptr [EAX + 0x82]
00a2701a : PUSH ECX
00a2701b : PUSH EDX
00a2701c : MOV DX,word ptr [EAX + 0x6]
00a27020 : LEA ECX,[EBP + 0xffffff7c]
00a27026 : PUSH ECX
00a27027 : CALL 0x0040dde0
00a2702c : MOV dword ptr [EBP + -0x4],0x0
00a27033 : PUSH EAX
00a27034 : MOV EAX,EBX
00a27036 : CALL 0x004070c0
00a2703b : MOV dword ptr [EBP + -0x4],0xffffffff
00a27042 : LEA EDX,[EBP + 0xffffff7c]
00a27048 : PUSH EDX
00a27049 : CALL 0x00406c60
00a2704e : CMP dword ptr [EBP + -0x50],0x0
00a27052 : JNZ 0x00a26fd0
00a27058 : CMP dword ptr [EBP + -0x54],0x0
00a2705c : JNZ 0x00a26fa2
00a27062 : MOV ECX,dword ptr [EBP + -0xc]
00a27065 : MOV dword ptr FS:[0x0],ECX
00a2706c : POP ECX
00a2706d : POP EDI
00a2706e : POP ESI
00a2706f : POP EBX
00a27070 : MOV ECX,dword ptr [EBP + -0x14]
00a27073 : XOR ECX,EBP
00a27075 : CALL 0x00633e6b
00a2707a : MOV ESP,EBP
00a2707c : POP EBP
00a2707d : RET 0x4

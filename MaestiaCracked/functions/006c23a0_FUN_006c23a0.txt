PROGRAM  : Maestia.exe
FUNCTION : FUN_006c23a0
ENTRY    : 006c23a0
BODY     : [[006c23a0, 006c24b7]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006c23a0(int param_1,char *param_2)

{
  int local_20;
  int local_1c;
  char local_18 [16];
  uint local_8;
  
  local_8 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  if ((param_1 != 0) && ((*(uint *)(param_1 + 0x6c) & 0xc0000) != 0)) {
    if (*param_2 == '#') {
      for (local_1c = 1; (local_1c < 0xf && (param_2[local_1c] != ' ')); local_1c = local_1c + 1) {
      }
      if ((*(uint *)(param_1 + 0x6c) & 0x80000) == 0) {
        param_2 = param_2 + local_1c;
      }
      else {
        for (local_20 = 0; local_20 < local_1c + -1; local_20 = local_20 + 1) {
          local_18[local_20] = param_2[local_20 + 1];
        }
        local_18[local_20] = '\0';
        param_2 = local_18;
      }
    }
    else if ((*(uint *)(param_1 + 0x6c) & 0x80000) != 0) {
      local_18[0] = '0';
      local_18[1] = 0;
      param_2 = local_18;
    }
  }
  if ((param_1 != 0) && (*(int *)(param_1 + 0x40) != 0)) {
    (**(code **)(param_1 + 0x40))(param_1,param_2);
  }
  FUN_006c2750(param_1,param_2);
  __security_check_cookie(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
006c23a0 : PUSH EBP
006c23a1 : MOV EBP,ESP
006c23a3 : SUB ESP,0x1c
006c23a6 : MOV EAX,[0x00d66fa0]
006c23ab : XOR EAX,EBP
006c23ad : MOV dword ptr [EBP + -0x4],EAX
006c23b0 : CMP dword ptr [EBP + 0x8],0x0
006c23b4 : JZ 0x006c2478
006c23ba : MOV EAX,dword ptr [EBP + 0x8]
006c23bd : MOV ECX,dword ptr [EAX + 0x6c]
006c23c0 : AND ECX,0xc0000
006c23c6 : JZ 0x006c2478
006c23cc : MOV EDX,dword ptr [EBP + 0xc]
006c23cf : MOVSX EAX,byte ptr [EDX]
006c23d2 : CMP EAX,0x23
006c23d5 : JNZ 0x006c245d
006c23db : MOV dword ptr [EBP + -0x18],0x1
006c23e2 : JMP 0x006c23ed
006c23e4 : MOV ECX,dword ptr [EBP + -0x18]
006c23e7 : ADD ECX,0x1
006c23ea : MOV dword ptr [EBP + -0x18],ECX
006c23ed : CMP dword ptr [EBP + -0x18],0xf
006c23f1 : JGE 0x006c2405
006c23f3 : MOV EDX,dword ptr [EBP + 0xc]
006c23f6 : ADD EDX,dword ptr [EBP + -0x18]
006c23f9 : MOVSX EAX,byte ptr [EDX]
006c23fc : CMP EAX,0x20
006c23ff : JNZ 0x006c2403
006c2401 : JMP 0x006c2405
006c2403 : JMP 0x006c23e4
006c2405 : MOV ECX,dword ptr [EBP + 0x8]
006c2408 : MOV EDX,dword ptr [ECX + 0x6c]
006c240b : AND EDX,0x80000
006c2411 : JZ 0x006c2452
006c2413 : MOV dword ptr [EBP + -0x1c],0x0
006c241a : JMP 0x006c2425
006c241c : MOV EAX,dword ptr [EBP + -0x1c]
006c241f : ADD EAX,0x1
006c2422 : MOV dword ptr [EBP + -0x1c],EAX
006c2425 : MOV ECX,dword ptr [EBP + -0x18]
006c2428 : SUB ECX,0x1
006c242b : CMP dword ptr [EBP + -0x1c],ECX
006c242e : JGE 0x006c2442
006c2430 : MOV EDX,dword ptr [EBP + 0xc]
006c2433 : ADD EDX,dword ptr [EBP + -0x1c]
006c2436 : MOV EAX,dword ptr [EBP + -0x1c]
006c2439 : MOV CL,byte ptr [EDX + 0x1]
006c243c : MOV byte ptr [EBP + EAX*0x1 + -0x14],CL
006c2440 : JMP 0x006c241c
006c2442 : MOV EDX,dword ptr [EBP + -0x1c]
006c2445 : MOV byte ptr [EBP + EDX*0x1 + -0x14],0x0
006c244a : LEA EAX,[EBP + -0x14]
006c244d : MOV dword ptr [EBP + 0xc],EAX
006c2450 : JMP 0x006c245b
006c2452 : MOV ECX,dword ptr [EBP + 0xc]
006c2455 : ADD ECX,dword ptr [EBP + -0x18]
006c2458 : MOV dword ptr [EBP + 0xc],ECX
006c245b : JMP 0x006c2478
006c245d : MOV EDX,dword ptr [EBP + 0x8]
006c2460 : MOV EAX,dword ptr [EDX + 0x6c]
006c2463 : AND EAX,0x80000
006c2468 : JZ 0x006c2478
006c246a : MOV byte ptr [EBP + -0x14],0x30
006c246e : MOV byte ptr [EBP + -0x13],0x0
006c2472 : LEA ECX,[EBP + -0x14]
006c2475 : MOV dword ptr [EBP + 0xc],ECX
006c2478 : CMP dword ptr [EBP + 0x8],0x0
006c247c : JZ 0x006c249a
006c247e : MOV EDX,dword ptr [EBP + 0x8]
006c2481 : CMP dword ptr [EDX + 0x40],0x0
006c2485 : JZ 0x006c249a
006c2487 : MOV EAX,dword ptr [EBP + 0xc]
006c248a : PUSH EAX
006c248b : MOV ECX,dword ptr [EBP + 0x8]
006c248e : PUSH ECX
006c248f : MOV EDX,dword ptr [EBP + 0x8]
006c2492 : MOV EAX,dword ptr [EDX + 0x40]
006c2495 : CALL EAX
006c2497 : ADD ESP,0x8
006c249a : MOV ECX,dword ptr [EBP + 0xc]
006c249d : PUSH ECX
006c249e : MOV EDX,dword ptr [EBP + 0x8]
006c24a1 : PUSH EDX
006c24a2 : CALL 0x006c2750
006c24a7 : ADD ESP,0x8
006c24aa : MOV ECX,dword ptr [EBP + -0x4]
006c24ad : XOR ECX,EBP
006c24af : CALL 0x00633e6b
006c24b4 : MOV ESP,EBP
006c24b6 : POP EBP
006c24b7 : RET

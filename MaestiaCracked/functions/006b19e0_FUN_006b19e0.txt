PROGRAM  : Maestia.exe
FUNCTION : FUN_006b19e0
ENTRY    : 006b19e0
BODY     : [[006b19e0, 006b1bcd]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006b19e0(int param_1)

{
  ushort *puVar1;
  uint uVar2;
  undefined4 *puVar3;
  int *piVar4;
  undefined4 uVar5;
  int in_ECX;
  ushort *puVar6;
  int iVar7;
  int unaff_EBX;
  ushort *puVar8;
  int local_10;
  ushort *local_c;
  undefined4 local_8;
  int local_4;
  
  local_8 = *(undefined4 *)(in_ECX + 0x1c);
  puVar8 = *(ushort **)(in_ECX + 0x20);
  puVar1 = *(ushort **)(in_ECX + 0x24);
  local_10 = 0;
  if ((ushort *)((int)puVar8 + 0x65U) <= puVar1) {
    puVar6 = (ushort *)((int)puVar8 + *(ushort *)((int)puVar8 + 99) + 0x75);
    if (puVar1 < puVar6 + 9) {
      return 0;
    }
    if (*puVar6 < 0x12) {
      return 0;
    }
    puVar6 = (ushort *)(*(int *)(puVar6 + 7) + (int)puVar8);
    if (puVar6 == puVar8) {
      return 0;
    }
    puVar8 = puVar6 + 1;
    if (puVar8 <= puVar1) {
      uVar2 = (uint)*puVar6;
      *(uint *)(param_1 + 0x28) = uVar2;
      if (puVar8 + uVar2 * 2 <= puVar1) {
        if (uVar2 == 0) {
          return 0;
        }
        puVar3 = (undefined4 *)FUN_0068a220(local_8,0x10,0,uVar2,0,&local_10);
        *(undefined4 **)(param_1 + 0x24) = puVar3;
        if (local_10 == 0) {
          local_4 = *(int *)(unaff_EBX + 0x5c);
          local_c = puVar8 + *(int *)(param_1 + 0x28) * 2;
          iVar7 = 0;
          if (0 < *(int *)(unaff_EBX + 0x24)) {
            piVar4 = *(int **)(unaff_EBX + 0x28);
            do {
              if (*(short *)(*piVar4 + 8) == 7) {
                local_10 = FUN_00688530();
                if (local_10 != 0) goto LAB_006b1baa;
                break;
              }
              iVar7 = iVar7 + 1;
              piVar4 = piVar4 + 1;
            } while (iVar7 < *(int *)(unaff_EBX + 0x24));
          }
          if (puVar8 < local_c) {
            do {
              uVar5 = FUN_00686bf0();
              *puVar3 = uVar5;
              uVar5 = FUN_00686bf0();
              puVar3[1] = uVar5;
              puVar3[2] = (int)(short)((short)*(char *)((int)puVar8 + 3) << 8) |
                          (uint)(byte)puVar8[1];
              puVar3[3] = 0;
              puVar8 = puVar8 + 2;
              puVar3 = puVar3 + 4;
            } while (puVar8 < local_c);
          }
          if (local_4 != 0) {
            local_10 = FUN_00688530();
          }
          if ((local_10 == 0) &&
             (_qsort(*(void **)(param_1 + 0x24),*(size_t *)(param_1 + 0x28),0x10,
                     (_PtFuncCompare *)&LAB_0069e120), local_10 == 0)) {
            return 0;
          }
        }
        goto LAB_006b1baa;
      }
    }
  }
  local_10 = 2;
LAB_006b1baa:
  FUN_00687f30(local_8,*(undefined4 *)(param_1 + 0x24));
  *(undefined4 *)(param_1 + 0x24) = 0;
  *(undefined4 *)(param_1 + 0x28) = 0;
  return local_10;
}



============================================================
DISASSEMBLY
============================================================
006b19e0 : SUB ESP,0x10
006b19e3 : MOV EDX,dword ptr [ECX + 0x1c]
006b19e6 : PUSH EBP
006b19e7 : MOV EBP,dword ptr [ESP + 0x18]
006b19eb : PUSH ESI
006b19ec : MOV dword ptr [ESP + 0x10],EDX
006b19f0 : MOV EDX,dword ptr [ECX + 0x20]
006b19f3 : PUSH EDI
006b19f4 : MOV EDI,dword ptr [ECX + 0x24]
006b19f7 : XOR EAX,EAX
006b19f9 : LEA ECX,[EDX + 0x65]
006b19fc : MOV dword ptr [ESP + 0xc],EAX
006b1a00 : CMP ECX,EDI
006b1a02 : JBE 0x006b1a11
006b1a04 : MOV dword ptr [ESP + 0xc],0x2
006b1a0c : JMP 0x006b1baa
006b1a11 : MOVZX CX,byte ptr [EDX + 0x64]
006b1a16 : MOVZX ESI,byte ptr [EDX + 0x63]
006b1a1a : SHL CX,0x8
006b1a1e : MOVZX ECX,CX
006b1a21 : OR ECX,ESI
006b1a23 : LEA ESI,[EDX + ECX*0x1 + 0x75]
006b1a27 : LEA ECX,[ESI + 0x12]
006b1a2a : CMP ECX,EDI
006b1a2c : JA 0x006b1bc7
006b1a32 : MOVZX AX,byte ptr [ESI + 0x1]
006b1a37 : MOVZX CX,byte ptr [ESI]
006b1a3b : SHL AX,0x8
006b1a3f : OR AX,CX
006b1a42 : CMP AX,0x12
006b1a46 : JC 0x006b1bc3
006b1a4c : MOVZX ECX,byte ptr [ESI + 0x11]
006b1a50 : MOVZX EAX,byte ptr [ESI + 0x10]
006b1a54 : ADD ESI,0xe
006b1a57 : SHL ECX,0x8
006b1a5a : OR ECX,EAX
006b1a5c : MOVZX EAX,byte ptr [ESI + 0x1]
006b1a60 : SHL ECX,0x8
006b1a63 : OR ECX,EAX
006b1a65 : MOVZX EAX,byte ptr [ESI]
006b1a68 : SHL ECX,0x8
006b1a6b : OR ECX,EAX
006b1a6d : ADD ECX,EDX
006b1a6f : CMP ECX,EDX
006b1a71 : JZ 0x006b1bc3
006b1a77 : LEA ESI,[ECX + 0x2]
006b1a7a : CMP ESI,EDI
006b1a7c : JA 0x006b1a04
006b1a7e : MOVZX DX,byte ptr [ECX + 0x1]
006b1a83 : MOVZX ECX,byte ptr [ECX]
006b1a86 : SHL DX,0x8
006b1a8a : MOVZX EAX,DX
006b1a8d : OR EAX,ECX
006b1a8f : MOV ECX,EAX
006b1a91 : LEA EDX,[ESI + ECX*0x4]
006b1a94 : MOV dword ptr [EBP + 0x28],EAX
006b1a97 : CMP EDX,EDI
006b1a99 : JA 0x006b1a04
006b1a9f : TEST ECX,ECX
006b1aa1 : JZ 0x006b1bc3
006b1aa7 : LEA EAX,[ESP + 0xc]
006b1aab : PUSH EAX
006b1aac : PUSH 0x0
006b1aae : PUSH ECX
006b1aaf : MOV ECX,dword ptr [ESP + 0x20]
006b1ab3 : PUSH 0x0
006b1ab5 : PUSH 0x10
006b1ab7 : PUSH ECX
006b1ab8 : CALL 0x0068a220
006b1abd : ADD ESP,0x18
006b1ac0 : CMP dword ptr [ESP + 0xc],0x0
006b1ac5 : MOV EDI,EAX
006b1ac7 : MOV dword ptr [EBP + 0x24],EDI
006b1aca : JNZ 0x006b1baa
006b1ad0 : MOV ECX,dword ptr [EBX + 0x5c]
006b1ad3 : MOV EDX,dword ptr [EBP + 0x28]
006b1ad6 : LEA EAX,[ESI + EDX*0x4]
006b1ad9 : MOV dword ptr [ESP + 0x18],ECX
006b1add : MOV ECX,dword ptr [EBX + 0x24]
006b1ae0 : XOR EDX,EDX
006b1ae2 : MOV dword ptr [ESP + 0x10],EAX
006b1ae6 : TEST ECX,ECX
006b1ae8 : JLE 0x006b1b1d
006b1aea : MOV EAX,dword ptr [EBX + 0x28]
006b1aed : LEA ECX,[ECX]
006b1af0 : MOV EBP,dword ptr [EAX]
006b1af2 : CMP word ptr [EBP + 0x8],0x7
006b1af7 : JZ 0x006b1b03
006b1af9 : INC EDX
006b1afa : ADD EAX,0x4
006b1afd : CMP EDX,ECX
006b1aff : JL 0x006b1af0
006b1b01 : JMP 0x006b1b19
006b1b03 : PUSH EBP
006b1b04 : PUSH EBX
006b1b05 : CALL 0x00688530
006b1b0a : ADD ESP,0x8
006b1b0d : MOV dword ptr [ESP + 0xc],EAX
006b1b11 : TEST EAX,EAX
006b1b13 : JNZ 0x006b1ba6
006b1b19 : MOV EBP,dword ptr [ESP + 0x20]
006b1b1d : CMP ESI,dword ptr [ESP + 0x10]
006b1b21 : JNC 0x006b1b68
006b1b23 : MOVZX EDX,byte ptr [ESI]
006b1b26 : PUSH EDX
006b1b27 : PUSH EBX
006b1b28 : CALL 0x00686bf0
006b1b2d : MOV dword ptr [EDI],EAX
006b1b2f : MOVZX EAX,byte ptr [ESI + 0x1]
006b1b33 : PUSH EAX
006b1b34 : PUSH EBX
006b1b35 : CALL 0x00686bf0
006b1b3a : MOV dword ptr [EDI + 0x4],EAX
006b1b3d : MOVSX CX,byte ptr [ESI + 0x3]
006b1b42 : MOVZX EAX,byte ptr [ESI + 0x2]
006b1b46 : SHL CX,0x8
006b1b4a : MOVSX EDX,CX
006b1b4d : OR EDX,EAX
006b1b4f : MOV dword ptr [EDI + 0x8],EDX
006b1b52 : MOV dword ptr [EDI + 0xc],0x0
006b1b59 : ADD ESI,0x4
006b1b5c : ADD ESP,0x10
006b1b5f : ADD EDI,0x10
006b1b62 : CMP ESI,dword ptr [ESP + 0x10]
006b1b66 : JC 0x006b1b23
006b1b68 : MOV EAX,dword ptr [ESP + 0x18]
006b1b6c : TEST EAX,EAX
006b1b6e : JZ 0x006b1b7e
006b1b70 : PUSH EAX
006b1b71 : PUSH EBX
006b1b72 : CALL 0x00688530
006b1b77 : ADD ESP,0x8
006b1b7a : MOV dword ptr [ESP + 0xc],EAX
006b1b7e : CMP dword ptr [ESP + 0xc],0x0
006b1b83 : JNZ 0x006b1baa
006b1b85 : MOV ECX,dword ptr [EBP + 0x28]
006b1b88 : MOV EDX,dword ptr [EBP + 0x24]
006b1b8b : PUSH 0x69e120
006b1b90 : PUSH 0x10
006b1b92 : PUSH ECX
006b1b93 : PUSH EDX
006b1b94 : CALL 0x00635ad0
006b1b99 : MOV EAX,dword ptr [ESP + 0x1c]
006b1b9d : ADD ESP,0x10
006b1ba0 : TEST EAX,EAX
006b1ba2 : JZ 0x006b1bc7
006b1ba4 : JMP 0x006b1baa
006b1ba6 : MOV EBP,dword ptr [ESP + 0x20]
006b1baa : MOV EAX,dword ptr [EBP + 0x24]
006b1bad : MOV ECX,dword ptr [ESP + 0x14]
006b1bb1 : PUSH EAX
006b1bb2 : PUSH ECX
006b1bb3 : CALL 0x00687f30
006b1bb8 : ADD ESP,0x8
006b1bbb : XOR EAX,EAX
006b1bbd : MOV dword ptr [EBP + 0x24],EAX
006b1bc0 : MOV dword ptr [EBP + 0x28],EAX
006b1bc3 : MOV EAX,dword ptr [ESP + 0xc]
006b1bc7 : POP EDI
006b1bc8 : POP ESI
006b1bc9 : POP EBP
006b1bca : ADD ESP,0x10
006b1bcd : RET

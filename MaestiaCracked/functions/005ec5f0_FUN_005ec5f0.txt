PROGRAM  : Maestia.exe
FUNCTION : FUN_005ec5f0
ENTRY    : 005ec5f0
BODY     : [[005ec5f0, 005ec7bb]]

============================================================
DECOMPILED C CODE
============================================================

int * FUN_005ec5f0(int param_1,int *param_2)

{
  int *piVar1;
  uint uVar2;
  char cVar3;
  int iVar4;
  int *in_ECX;
  uint uVar5;
  int *local_4;
  
  if (*(int *)(*param_2 + 0x10) == 0) {
    return (int *)0x0;
  }
  local_4 = (int *)0x0;
  if (*(byte *)(param_1 + 4) < 7) {
    if (*(int *)(*param_2 + 4) == 0) {
      FUN_00525a80();
    }
    piVar1 = (int *)in_ECX[3];
    if (piVar1 != (int *)0x0) {
      iVar4 = piVar1[0x20];
      if ((iVar4 == 0) && (iVar4 = FUN_00520df0(), iVar4 == 0)) {
        iVar4 = (**(code **)(*piVar1 + 0x58))();
        iVar4 = *(int *)(iVar4 + 0x78);
      }
      cVar3 = FUN_0051cbf0(iVar4 + 8);
      if (cVar3 != '\0') goto LAB_005ec718;
    }
    uVar2 = in_ECX[1];
    uVar5 = 0;
    if (uVar2 != 0) {
      do {
        local_4 = *(int **)(*in_ECX + uVar5 * 4);
        if ((local_4 != (int *)0x0) && ((*(byte *)((int)local_4 + 0x66) & 0x80) != 0)) {
          iVar4 = local_4[0x20];
          if ((iVar4 == 0) && (iVar4 = FUN_00520df0(), iVar4 == 0)) {
            iVar4 = (**(code **)(*local_4 + 0x58))();
            iVar4 = *(int *)(iVar4 + 0x78);
          }
          if (*(int *)(*(int *)(iVar4 + 8) + 4) == 0) {
            FUN_00525a80();
          }
          if (*(int *)(*param_2 + 4) == *(int *)(*(int *)(iVar4 + 8) + 4)) break;
        }
        uVar5 = uVar5 + 1;
        if (uVar2 <= uVar5) {
          in_ECX[3] = 0;
          return (int *)0x0;
        }
      } while( true );
    }
  }
  else {
    piVar1 = (int *)in_ECX[3];
    if (piVar1 != (int *)0x0) {
      iVar4 = piVar1[0x20];
      if ((iVar4 == 0) && (iVar4 = FUN_00520df0(), iVar4 == 0)) {
        iVar4 = (**(code **)(*piVar1 + 0x58))();
        iVar4 = *(int *)(iVar4 + 0x78);
      }
      if (*(int *)(iVar4 + 8) == *param_2) {
LAB_005ec718:
        return (int *)in_ECX[3];
      }
    }
    uVar2 = in_ECX[1];
    uVar5 = 0;
    if (uVar2 != 0) {
      do {
        piVar1 = *(int **)(*in_ECX + uVar5 * 4);
        if ((piVar1 != (int *)0x0) && ((*(byte *)((int)piVar1 + 0x66) & 0x80) != 0)) {
          iVar4 = piVar1[0x20];
          if ((iVar4 == 0) && (iVar4 = FUN_00520df0(), iVar4 == 0)) {
            iVar4 = (**(code **)(*piVar1 + 0x58))();
            iVar4 = *(int *)(iVar4 + 0x78);
          }
          if (*(int *)(iVar4 + 8) == *param_2) {
            in_ECX[3] = (int)piVar1;
            return piVar1;
          }
        }
        uVar5 = uVar5 + 1;
        if (uVar2 <= uVar5) {
          in_ECX[3] = 0;
          return (int *)0x0;
        }
      } while( true );
    }
  }
  in_ECX[3] = (int)local_4;
  return local_4;
}



============================================================
DISASSEMBLY
============================================================
005ec5f0 : SUB ESP,0x8
005ec5f3 : PUSH EBX
005ec5f4 : PUSH EDI
005ec5f5 : MOV EDI,dword ptr [ESP + 0x18]
005ec5f9 : MOV EBX,ECX
005ec5fb : MOV ECX,dword ptr [EDI]
005ec5fd : CMP dword ptr [ECX + 0x10],0x0
005ec601 : MOV dword ptr [ESP + 0x8],EBX
005ec605 : JNZ 0x005ec611
005ec607 : POP EDI
005ec608 : XOR EAX,EAX
005ec60a : POP EBX
005ec60b : ADD ESP,0x8
005ec60e : RET 0x8
005ec611 : MOV EAX,dword ptr [ESP + 0x14]
005ec615 : CMP byte ptr [EAX + 0x4],0x6
005ec619 : PUSH EBP
005ec61a : PUSH ESI
005ec61b : MOV dword ptr [ESP + 0x14],0x0
005ec623 : JBE 0x005ec6d6
005ec629 : MOV ESI,dword ptr [EBX + 0xc]
005ec62c : TEST ESI,ESI
005ec62e : JZ 0x005ec65f
005ec630 : MOV EAX,dword ptr [ESI + 0x80]
005ec636 : TEST EAX,EAX
005ec638 : JNZ 0x005ec651
005ec63a : MOV ECX,ESI
005ec63c : CALL 0x00520df0
005ec641 : TEST EAX,EAX
005ec643 : JNZ 0x005ec651
005ec645 : MOV EDX,dword ptr [ESI]
005ec647 : MOV EAX,dword ptr [EDX + 0x58]
005ec64a : MOV ECX,ESI
005ec64c : CALL EAX
005ec64e : MOV EAX,dword ptr [EAX + 0x78]
005ec651 : MOV ECX,dword ptr [EAX + 0x8]
005ec654 : ADD EAX,0x8
005ec657 : CMP ECX,dword ptr [EDI]
005ec659 : JZ 0x005ec718
005ec65f : MOV EBP,dword ptr [EBX + 0x4]
005ec662 : XOR EDI,EDI
005ec664 : TEST EBP,EBP
005ec666 : JBE 0x005ec7ab
005ec66c : LEA ESP,[ESP]
005ec670 : MOV EDX,dword ptr [EBX]
005ec672 : MOV ESI,dword ptr [EDX + EDI*0x4]
005ec675 : TEST ESI,ESI
005ec677 : JZ 0x005ec6ad
005ec679 : TEST byte ptr [ESI + 0x66],0x80
005ec67d : JZ 0x005ec6ad
005ec67f : MOV EAX,dword ptr [ESI + 0x80]
005ec685 : TEST EAX,EAX
005ec687 : JNZ 0x005ec6a0
005ec689 : MOV ECX,ESI
005ec68b : CALL 0x00520df0
005ec690 : TEST EAX,EAX
005ec692 : JNZ 0x005ec6a0
005ec694 : MOV EAX,dword ptr [ESI]
005ec696 : MOV EDX,dword ptr [EAX + 0x58]
005ec699 : MOV ECX,ESI
005ec69b : CALL EDX
005ec69d : MOV EAX,dword ptr [EAX + 0x78]
005ec6a0 : MOV ECX,dword ptr [ESP + 0x20]
005ec6a4 : ADD EAX,0x8
005ec6a7 : MOV EAX,dword ptr [EAX]
005ec6a9 : CMP EAX,dword ptr [ECX]
005ec6ab : JZ 0x005ec6c3
005ec6ad : INC EDI
005ec6ae : CMP EDI,EBP
005ec6b0 : JC 0x005ec670
005ec6b2 : MOV EAX,dword ptr [ESP + 0x14]
005ec6b6 : POP ESI
005ec6b7 : POP EBP
005ec6b8 : POP EDI
005ec6b9 : MOV dword ptr [EBX + 0xc],EAX
005ec6bc : POP EBX
005ec6bd : ADD ESP,0x8
005ec6c0 : RET 0x8
005ec6c3 : MOV EAX,ESI
005ec6c5 : MOV dword ptr [ESP + 0x14],ESI
005ec6c9 : POP ESI
005ec6ca : POP EBP
005ec6cb : POP EDI
005ec6cc : MOV dword ptr [EBX + 0xc],EAX
005ec6cf : POP EBX
005ec6d0 : ADD ESP,0x8
005ec6d3 : RET 0x8
005ec6d6 : CMP dword ptr [ECX + 0x4],0x0
005ec6da : JNZ 0x005ec6e1
005ec6dc : CALL 0x00525a80
005ec6e1 : MOV ESI,dword ptr [EBX + 0xc]
005ec6e4 : TEST ESI,ESI
005ec6e6 : JZ 0x005ec725
005ec6e8 : MOV EAX,dword ptr [ESI + 0x80]
005ec6ee : TEST EAX,EAX
005ec6f0 : JNZ 0x005ec709
005ec6f2 : MOV ECX,ESI
005ec6f4 : CALL 0x00520df0
005ec6f9 : TEST EAX,EAX
005ec6fb : JNZ 0x005ec709
005ec6fd : MOV EDX,dword ptr [ESI]
005ec6ff : MOV EAX,dword ptr [EDX + 0x58]
005ec702 : MOV ECX,ESI
005ec704 : CALL EAX
005ec706 : MOV EAX,dword ptr [EAX + 0x78]
005ec709 : ADD EAX,0x8
005ec70c : PUSH EAX
005ec70d : MOV ECX,EDI
005ec70f : CALL 0x0051cbf0
005ec714 : TEST AL,AL
005ec716 : JZ 0x005ec725
005ec718 : MOV EAX,dword ptr [EBX + 0xc]
005ec71b : POP ESI
005ec71c : POP EBP
005ec71d : POP EDI
005ec71e : POP EBX
005ec71f : ADD ESP,0x8
005ec722 : RET 0x8
005ec725 : MOV EBX,dword ptr [EBX + 0x4]
005ec728 : XOR EBP,EBP
005ec72a : TEST EBX,EBX
005ec72c : JBE 0x005ec7a7
005ec72e : MOV EDI,EDI
005ec730 : MOV ECX,dword ptr [ESP + 0x10]
005ec734 : MOV EDX,dword ptr [ECX]
005ec736 : MOV EDI,dword ptr [EDX + EBP*0x4]
005ec739 : TEST EDI,EDI
005ec73b : JZ 0x005ec789
005ec73d : TEST byte ptr [EDI + 0x66],0x80
005ec741 : JZ 0x005ec789
005ec743 : MOV EAX,dword ptr [EDI + 0x80]
005ec749 : TEST EAX,EAX
005ec74b : JNZ 0x005ec758
005ec74d : MOV ECX,EDI
005ec74f : CALL 0x00520df0
005ec754 : TEST EAX,EAX
005ec756 : JZ 0x005ec75d
005ec758 : LEA ESI,[EAX + 0x8]
005ec75b : JMP 0x005ec76c
005ec75d : MOV EAX,dword ptr [EDI]
005ec75f : MOV EDX,dword ptr [EAX + 0x58]
005ec762 : MOV ECX,EDI
005ec764 : CALL EDX
005ec766 : MOV ESI,dword ptr [EAX + 0x78]
005ec769 : ADD ESI,0x8
005ec76c : MOV ECX,dword ptr [ESI]
005ec76e : CMP dword ptr [ECX + 0x4],0x0
005ec772 : JNZ 0x005ec779
005ec774 : CALL 0x00525a80
005ec779 : MOV ECX,dword ptr [ESP + 0x20]
005ec77d : MOV EDX,dword ptr [ECX]
005ec77f : MOV EAX,dword ptr [ESI]
005ec781 : MOV ECX,dword ptr [EDX + 0x4]
005ec784 : CMP ECX,dword ptr [EAX + 0x4]
005ec787 : JZ 0x005ec7a3
005ec789 : INC EBP
005ec78a : CMP EBP,EBX
005ec78c : JC 0x005ec730
005ec78e : MOV EBX,dword ptr [ESP + 0x10]
005ec792 : MOV EAX,dword ptr [ESP + 0x14]
005ec796 : POP ESI
005ec797 : POP EBP
005ec798 : POP EDI
005ec799 : MOV dword ptr [EBX + 0xc],EAX
005ec79c : POP EBX
005ec79d : ADD ESP,0x8
005ec7a0 : RET 0x8
005ec7a3 : MOV dword ptr [ESP + 0x14],EDI
005ec7a7 : MOV EBX,dword ptr [ESP + 0x10]
005ec7ab : MOV EAX,dword ptr [ESP + 0x14]
005ec7af : POP ESI
005ec7b0 : POP EBP
005ec7b1 : POP EDI
005ec7b2 : MOV dword ptr [EBX + 0xc],EAX
005ec7b5 : POP EBX
005ec7b6 : ADD ESP,0x8
005ec7b9 : RET 0x8

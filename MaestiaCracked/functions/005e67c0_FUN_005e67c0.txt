PROGRAM  : Maestia.exe
FUNCTION : FUN_005e67c0
ENTRY    : 005e67c0
BODY     : [[005e67c0, 005e68c7]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005e67c0(int param_1)

{
  undefined1 uVar1;
  undefined1 uVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  undefined4 uVar6;
  GThread *this;
  GRefCountNTSImpl *this_00;
  
  iVar5 = *(int *)(param_1 + 0x314);
  if (iVar5 == 0) {
    iVar5 = param_1 + 0x28;
  }
  *(undefined1 *)(iVar5 + 0x15) = 0;
  if (*(int *)(iVar5 + 0x30) - *(int *)(iVar5 + 0x2c) < 2) {
    FUN_00539fb0(2);
  }
  iVar3 = *(int *)(iVar5 + 0x2c);
  uVar1 = *(undefined1 *)(*(int *)(iVar5 + 0x3c) + 1 + iVar3);
  uVar2 = *(undefined1 *)(*(int *)(iVar5 + 0x3c) + iVar3);
  *(int *)(iVar5 + 0x2c) = iVar3 + 2;
  this = (GThread *)(uint)CONCAT11(uVar1,uVar2);
  GThread::OnExit(this);
  piVar4 = *(int **)(*(int *)(param_1 + 0x10) + 0x24);
  this_00 = (GRefCountNTSImpl *)0x0;
  if (piVar4 == (int *)0x0) {
    FUN_00555e50(param_1 + 0x14,
                 "Error: Jpeg system is not installed - can\'t load jpeg image data\n");
  }
  else {
    iVar5 = FUN_005a02c0(*(undefined4 *)(param_1 + 0x2b8));
    uVar6 = DAT_00d73250;
    if (iVar5 == 0) {
      uVar6 = FUN_00561610();
    }
    iVar5 = *(int *)(param_1 + 0x314);
    if (iVar5 == 0) {
      iVar5 = param_1 + 0x28;
    }
    FUN_0053a0b0();
    *(undefined1 *)(iVar5 + 0x38) = 1;
    this_00 = (GRefCountNTSImpl *)(**(code **)(*piVar4 + 0xc))(*(undefined4 *)(iVar5 + 0x10),uVar6);
  }
  FUN_005a1850(this,this_00);
  if (this_00 != (GRefCountNTSImpl *)0x0) {
    GRefCountNTSImpl::Release(this_00);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005e67c0 : PUSH EBX
005e67c1 : PUSH EBP
005e67c2 : PUSH ESI
005e67c3 : MOV ESI,dword ptr [ESP + 0x10]
005e67c7 : PUSH EDI
005e67c8 : MOV EDI,dword ptr [ESI + 0x314]
005e67ce : TEST EDI,EDI
005e67d0 : JNZ 0x005e67d5
005e67d2 : LEA EDI,[ESI + 0x28]
005e67d5 : MOV EAX,dword ptr [EDI + 0x30]
005e67d8 : SUB EAX,dword ptr [EDI + 0x2c]
005e67db : MOV byte ptr [EDI + 0x15],0x0
005e67df : CMP EAX,0x2
005e67e2 : JGE 0x005e67ed
005e67e4 : PUSH 0x2
005e67e6 : MOV ECX,EDI
005e67e8 : CALL 0x00539fb0
005e67ed : MOV EAX,dword ptr [EDI + 0x2c]
005e67f0 : MOV ECX,dword ptr [EDI + 0x3c]
005e67f3 : MOVZX DX,byte ptr [ECX + EAX*0x1 + 0x1]
005e67f9 : ADD ECX,EAX
005e67fb : MOVZX CX,byte ptr [ECX]
005e67ff : ADD EAX,0x2
005e6802 : SHL DX,0x8
005e6806 : MOV dword ptr [EDI + 0x2c],EAX
005e6809 : MOV EAX,dword ptr [ESI + 0x314]
005e680f : OR DX,CX
005e6812 : MOVZX ECX,DX
005e6815 : TEST EAX,EAX
005e6817 : JNZ 0x005e681c
005e6819 : LEA EAX,[ESI + 0x28]
005e681c : MOV EDX,dword ptr [EAX + 0x34]
005e681f : SUB EDX,dword ptr [EAX + 0x30]
005e6822 : MOVZX ECX,CX
005e6825 : ADD EDX,dword ptr [EAX + 0x2c]
005e6828 : LEA EBP,[ESI + 0x14]
005e682b : PUSH EDX
005e682c : PUSH ECX
005e682d : PUSH 0xb93f34
005e6832 : PUSH EBP
005e6833 : MOV dword ptr [ESP + 0x24],ECX
005e6837 : CALL 0x0051d420
005e683c : MOV ECX,dword ptr [ESI + 0x10]
005e683f : MOV EBX,dword ptr [ECX + 0x24]
005e6842 : ADD ESP,0x10
005e6845 : XOR EDI,EDI
005e6847 : TEST EBX,EBX
005e6849 : JNZ 0x005e685b
005e684b : PUSH 0xb93ef0
005e6850 : PUSH EBP
005e6851 : CALL 0x00555e50
005e6856 : ADD ESP,0x8
005e6859 : JMP 0x005e68a5
005e685b : MOV EAX,dword ptr [ESI + 0x2b8]
005e6861 : PUSH EAX
005e6862 : CALL 0x005a02c0
005e6867 : TEST EAX,EAX
005e6869 : JZ 0x005e6873
005e686b : MOV EBP,dword ptr [0x00d73250]
005e6871 : JMP 0x005e687d
005e6873 : MOV ECX,dword ptr [ESI + 0x20]
005e6876 : CALL 0x00561610
005e687b : MOV EBP,EAX
005e687d : MOV EDI,dword ptr [ESI + 0x314]
005e6883 : TEST EDI,EDI
005e6885 : JNZ 0x005e688a
005e6887 : LEA EDI,[ESI + 0x28]
005e688a : MOV ECX,EDI
005e688c : CALL 0x0053a0b0
005e6891 : MOV byte ptr [EDI + 0x38],0x1
005e6895 : MOV EDI,dword ptr [EDI + 0x10]
005e6898 : MOV EDX,dword ptr [EBX]
005e689a : MOV EAX,dword ptr [EDX + 0xc]
005e689d : PUSH EBP
005e689e : PUSH EDI
005e689f : MOV ECX,EBX
005e68a1 : CALL EAX
005e68a3 : MOV EDI,EAX
005e68a5 : PUSH EDI
005e68a6 : PUSH ECX
005e68a7 : MOV ECX,dword ptr [ESP + 0x1c]
005e68ab : MOV EAX,ESP
005e68ad : MOV dword ptr [EAX],ECX
005e68af : MOV ECX,ESI
005e68b1 : CALL 0x005a1850
005e68b6 : TEST EDI,EDI
005e68b8 : JZ 0x005e68c1
005e68ba : MOV ECX,EDI
005e68bc : CALL 0x004ff7c0
005e68c1 : POP EDI
005e68c2 : POP ESI
005e68c3 : POP EBP
005e68c4 : POP EBX
005e68c5 : RET 0x8

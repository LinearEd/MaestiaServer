PROGRAM  : Maestia.exe
FUNCTION : FUN_00531000
ENTRY    : 00531000
BODY     : [[00531000, 005310a6]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_00531000(void)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int iVar3;
  int in_ECX;
  
  puVar2 = (undefined4 *)FUN_00515840(0x48,0);
  if (puVar2 == (undefined4 *)0x0) {
    puVar2 = (undefined4 *)0x0;
  }
  else {
    if (*(int *)(in_ECX + 0x74) == 0) {
      iVar3 = 0;
    }
    else {
      iVar3 = (**(code **)(**(int **)(in_ECX + 0x74) + 0x40))();
      iVar3 = iVar3 + 0x18;
    }
    puVar2[1] = iVar3;
    puVar2[2] = 1;
    *puVar2 = &PTR_LAB_00b8b694;
    puVar2[4] = 0;
    puVar2[5] = 0;
    puVar2[6] = 0;
    puVar2[7] = 0;
    puVar2[8] = 0;
    puVar2[9] = 0;
    *(undefined1 *)(puVar2 + 10) = 0;
    *(undefined1 *)(puVar2 + 0xe) = 0;
  }
  FUN_00550f50((int *)(in_ECX + 200),*(int *)(in_ECX + 0xcc) + 1);
  puVar1 = (undefined4 *)(*(int *)(in_ECX + 200) + -4 + *(int *)(in_ECX + 0xcc) * 4);
  if (puVar1 != (undefined4 *)0x0) {
    if (puVar2 != (undefined4 *)0x0) {
      puVar2[2] = puVar2[2] + 1 & 0x8fffffff;
    }
    *puVar1 = puVar2;
  }
  if (puVar2 != (undefined4 *)0x0) {
    FUN_00503db0();
  }
  return puVar2;
}



============================================================
DISASSEMBLY
============================================================
00531000 : PUSH EBX
00531001 : PUSH ESI
00531002 : PUSH EDI
00531003 : MOV EDI,ECX
00531005 : MOV EAX,dword ptr [EDI + 0x78]
00531008 : MOV ECX,dword ptr [EAX + 0x288]
0053100e : XOR EBX,EBX
00531010 : PUSH EBX
00531011 : PUSH 0x48
00531013 : CALL 0x00515840
00531018 : MOV ESI,EAX
0053101a : CMP ESI,EBX
0053101c : JZ 0x0053105e
0053101e : CMP dword ptr [EDI + 0x74],EBX
00531021 : JZ 0x00531032
00531023 : MOV ECX,dword ptr [EDI + 0x74]
00531026 : MOV EDX,dword ptr [ECX]
00531028 : MOV EAX,dword ptr [EDX + 0x40]
0053102b : CALL EAX
0053102d : ADD EAX,0x18
00531030 : JMP 0x00531034
00531032 : XOR EAX,EAX
00531034 : MOV dword ptr [ESI + 0x4],EAX
00531037 : MOV dword ptr [ESI + 0x8],0x1
0053103e : MOV dword ptr [ESI],0xb8b694
00531044 : MOV dword ptr [ESI + 0x10],EBX
00531047 : MOV dword ptr [ESI + 0x14],EBX
0053104a : MOV dword ptr [ESI + 0x18],EBX
0053104d : MOV dword ptr [ESI + 0x1c],EBX
00531050 : MOV dword ptr [ESI + 0x20],EBX
00531053 : MOV dword ptr [ESI + 0x24],EBX
00531056 : MOV byte ptr [ESI + 0x28],BL
00531059 : MOV byte ptr [ESI + 0x38],BL
0053105c : JMP 0x00531060
0053105e : XOR ESI,ESI
00531060 : MOV ECX,dword ptr [EDI + 0xcc]
00531066 : ADD EDI,0xc8
0053106c : INC ECX
0053106d : PUSH ECX
0053106e : PUSH EDI
0053106f : MOV ECX,EDI
00531071 : CALL 0x00550f50
00531076 : MOV EDX,dword ptr [EDI + 0x4]
00531079 : MOV EAX,dword ptr [EDI]
0053107b : LEA EAX,[EAX + EDX*0x4 + -0x4]
0053107f : CMP EAX,EBX
00531081 : JZ 0x00531096
00531083 : CMP ESI,EBX
00531085 : JZ 0x00531094
00531087 : MOV ECX,dword ptr [ESI + 0x8]
0053108a : INC ECX
0053108b : AND ECX,0x8fffffff
00531091 : MOV dword ptr [ESI + 0x8],ECX
00531094 : MOV dword ptr [EAX],ESI
00531096 : CMP ESI,EBX
00531098 : JZ 0x005310a1
0053109a : MOV ECX,ESI
0053109c : CALL 0x00503db0
005310a1 : POP EDI
005310a2 : MOV EAX,ESI
005310a4 : POP ESI
005310a5 : POP EBX
005310a6 : RET

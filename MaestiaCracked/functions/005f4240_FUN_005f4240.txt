PROGRAM  : Maestia.exe
FUNCTION : FUN_005f4240
ENTRY    : 005f4240
BODY     : [[005f4240, 005f43aa]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005f4240(undefined4 param_1,int *param_2,uint param_3)

{
  uint *puVar1;
  int *piVar2;
  int iVar3;
  uint *puVar4;
  uint uVar5;
  int *in_ECX;
  uint uVar6;
  int iVar7;
  
  piVar2 = (int *)*in_ECX;
  if (piVar2 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar2 * 5) <= piVar2[1] * 4 + 4U) goto LAB_005f427b;
    iVar7 = piVar2[1] * 2 + 2;
  }
  FUN_005f3370(param_1,iVar7);
LAB_005f427b:
  piVar2 = (int *)*in_ECX;
  param_3 = param_3 & piVar2[1];
  *piVar2 = *piVar2 + 1;
  iVar7 = *in_ECX;
  iVar3 = *(int *)(iVar7 + 8 + param_3 * 0x18);
  puVar1 = (uint *)(iVar7 + 8 + param_3 * 0x18);
  if (iVar3 == -2) {
    *puVar1 = 0xffffffff;
    puVar4 = (uint *)*param_2;
    puVar1[2] = *puVar4;
    puVar1[3] = puVar4[1];
    puVar1[4] = puVar4[2];
    puVar1[5] = *(uint *)param_2[1];
    puVar1[1] = param_3;
    return;
  }
  uVar6 = param_3;
  do {
    uVar6 = uVar6 + 1 & *(uint *)(iVar7 + 4);
  } while (*(int *)(iVar7 + 8 + uVar6 * 0x18) != -2);
  uVar5 = puVar1[1];
  piVar2 = (int *)(iVar7 + 8 + uVar6 * 0x18);
  if (uVar5 != param_3) {
    puVar4 = (uint *)(iVar7 + 8 + uVar5 * 0x18);
    for (uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x18); uVar5 != param_3;
        uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x18)) {
      uVar5 = *puVar4;
      puVar4 = (uint *)(iVar7 + 8 + uVar5 * 0x18);
    }
    if (piVar2 != (int *)0x0) {
      *piVar2 = iVar3;
      piVar2[1] = puVar1[1];
      piVar2[2] = puVar1[2];
      piVar2[3] = puVar1[3];
      piVar2[4] = puVar1[4];
      piVar2[5] = puVar1[5];
    }
    *puVar4 = uVar6;
    puVar4 = (uint *)*param_2;
    puVar1[2] = *puVar4;
    puVar1[3] = puVar4[1];
    puVar1[4] = puVar4[2];
    puVar1[5] = *(uint *)param_2[1];
    *puVar1 = 0xffffffff;
    puVar1[1] = param_3;
    return;
  }
  if (piVar2 != (int *)0x0) {
    *piVar2 = iVar3;
    piVar2[1] = puVar1[1];
    piVar2[2] = puVar1[2];
    piVar2[3] = puVar1[3];
    piVar2[4] = puVar1[4];
    piVar2[5] = puVar1[5];
  }
  puVar4 = (uint *)*param_2;
  puVar1[2] = *puVar4;
  puVar1[3] = puVar4[1];
  puVar1[4] = puVar4[2];
  puVar1[5] = *(uint *)param_2[1];
  *puVar1 = uVar6;
  puVar1[1] = param_3;
  return;
}



============================================================
DISASSEMBLY
============================================================
005f4240 : PUSH EBP
005f4241 : PUSH ESI
005f4242 : MOV ESI,ECX
005f4244 : MOV EAX,dword ptr [ESI]
005f4246 : PUSH EDI
005f4247 : TEST EAX,EAX
005f4249 : JNZ 0x005f4254
005f424b : MOV EAX,dword ptr [ESP + 0x10]
005f424f : PUSH 0x8
005f4251 : PUSH EAX
005f4252 : JMP 0x005f4276
005f4254 : MOV ECX,dword ptr [EAX + 0x4]
005f4257 : LEA EDX,[ECX*0x4 + 0x4]
005f425e : MOV ECX,dword ptr [EAX]
005f4260 : LEA ECX,[ECX + ECX*0x4]
005f4263 : CMP ECX,EDX
005f4265 : JBE 0x005f427b
005f4267 : MOV EDX,dword ptr [EAX + 0x4]
005f426a : MOV ECX,dword ptr [ESP + 0x10]
005f426e : LEA EAX,[EDX + EDX*0x1 + 0x2]
005f4272 : PUSH EAX
005f4273 : PUSH ECX
005f4274 : MOV ECX,ESI
005f4276 : CALL 0x005f3370
005f427b : MOV EAX,dword ptr [ESI]
005f427d : MOV ECX,dword ptr [ESP + 0x18]
005f4281 : AND ECX,dword ptr [EAX + 0x4]
005f4284 : INC dword ptr [EAX]
005f4286 : MOV ESI,dword ptr [ESI]
005f4288 : LEA EDX,[ECX + ECX*0x2]
005f428b : MOV EBP,dword ptr [ESI + EDX*0x8 + 0x8]
005f428f : LEA EAX,[ESI + EDX*0x8 + 0x8]
005f4293 : CMP EBP,-0x2
005f4296 : JNZ 0x005f42c6
005f4298 : MOV ESI,dword ptr [ESP + 0x14]
005f429c : MOV dword ptr [EAX],0xffffffff
005f42a2 : MOV EDX,dword ptr [ESI]
005f42a4 : MOV EDI,dword ptr [EDX]
005f42a6 : MOV dword ptr [EAX + 0x8],EDI
005f42a9 : MOV EDI,dword ptr [EDX + 0x4]
005f42ac : MOV dword ptr [EAX + 0xc],EDI
005f42af : MOV EDX,dword ptr [EDX + 0x8]
005f42b2 : MOV dword ptr [EAX + 0x10],EDX
005f42b5 : MOV EDX,dword ptr [ESI + 0x4]
005f42b8 : MOV EDX,dword ptr [EDX]
005f42ba : POP EDI
005f42bb : POP ESI
005f42bc : MOV dword ptr [EAX + 0x14],EDX
005f42bf : MOV dword ptr [EAX + 0x4],ECX
005f42c2 : POP EBP
005f42c3 : RET 0xc
005f42c6 : MOV EDI,dword ptr [ESI + 0x4]
005f42c9 : MOV EDX,ECX
005f42cb : PUSH EBX
005f42cc : LEA ESP,[ESP]
005f42d0 : INC EDX
005f42d1 : AND EDX,EDI
005f42d3 : LEA EBX,[EDX + EDX*0x2]
005f42d6 : CMP dword ptr [ESI + EBX*0x8 + 0x8],-0x2
005f42db : JNZ 0x005f42d0
005f42dd : MOV EBX,dword ptr [EAX + 0x4]
005f42e0 : LEA EDI,[EDX + EDX*0x2]
005f42e3 : LEA EDI,[ESI + EDI*0x8 + 0x8]
005f42e7 : CMP EBX,ECX
005f42e9 : JNZ 0x005f433a
005f42eb : TEST EDI,EDI
005f42ed : JZ 0x005f430f
005f42ef : MOV dword ptr [EDI],EBP
005f42f1 : MOV ESI,dword ptr [EAX + 0x4]
005f42f4 : MOV dword ptr [EDI + 0x4],ESI
005f42f7 : MOV ESI,dword ptr [EAX + 0x8]
005f42fa : MOV dword ptr [EDI + 0x8],ESI
005f42fd : MOV ESI,dword ptr [EAX + 0xc]
005f4300 : MOV dword ptr [EDI + 0xc],ESI
005f4303 : MOV ESI,dword ptr [EAX + 0x10]
005f4306 : MOV dword ptr [EDI + 0x10],ESI
005f4309 : MOV ESI,dword ptr [EAX + 0x14]
005f430c : MOV dword ptr [EDI + 0x14],ESI
005f430f : MOV EDI,dword ptr [ESP + 0x18]
005f4313 : MOV ESI,dword ptr [EDI]
005f4315 : MOV EBX,dword ptr [ESI]
005f4317 : MOV dword ptr [EAX + 0x8],EBX
005f431a : MOV EBX,dword ptr [ESI + 0x4]
005f431d : MOV dword ptr [EAX + 0xc],EBX
005f4320 : MOV ESI,dword ptr [ESI + 0x8]
005f4323 : MOV dword ptr [EAX + 0x10],ESI
005f4326 : MOV ESI,dword ptr [EDI + 0x4]
005f4329 : MOV ESI,dword ptr [ESI]
005f432b : POP EBX
005f432c : MOV dword ptr [EAX + 0x14],ESI
005f432f : POP EDI
005f4330 : POP ESI
005f4331 : MOV dword ptr [EAX],EDX
005f4333 : MOV dword ptr [EAX + 0x4],ECX
005f4336 : POP EBP
005f4337 : RET 0xc
005f433a : LEA EBX,[EBX + EBX*0x2]
005f433d : CMP dword ptr [ESI + EBX*0x8 + 0x8],ECX
005f4341 : LEA EBX,[ESI + EBX*0x8 + 0x8]
005f4345 : JZ 0x005f4356
005f4347 : MOV EBX,dword ptr [EBX]
005f4349 : LEA EBX,[EBX + EBX*0x2]
005f434c : CMP dword ptr [ESI + EBX*0x8 + 0x8],ECX
005f4350 : LEA EBX,[ESI + EBX*0x8 + 0x8]
005f4354 : JNZ 0x005f4347
005f4356 : TEST EDI,EDI
005f4358 : JZ 0x005f437a
005f435a : MOV dword ptr [EDI],EBP
005f435c : MOV ESI,dword ptr [EAX + 0x4]
005f435f : MOV dword ptr [EDI + 0x4],ESI
005f4362 : MOV ESI,dword ptr [EAX + 0x8]
005f4365 : MOV dword ptr [EDI + 0x8],ESI
005f4368 : MOV ESI,dword ptr [EAX + 0xc]
005f436b : MOV dword ptr [EDI + 0xc],ESI
005f436e : MOV ESI,dword ptr [EAX + 0x10]
005f4371 : MOV dword ptr [EDI + 0x10],ESI
005f4374 : MOV ESI,dword ptr [EAX + 0x14]
005f4377 : MOV dword ptr [EDI + 0x14],ESI
005f437a : MOV ESI,dword ptr [ESP + 0x18]
005f437e : MOV dword ptr [EBX],EDX
005f4380 : MOV EDX,dword ptr [ESI]
005f4382 : MOV EDI,dword ptr [EDX]
005f4384 : MOV dword ptr [EAX + 0x8],EDI
005f4387 : MOV EDI,dword ptr [EDX + 0x4]
005f438a : MOV dword ptr [EAX + 0xc],EDI
005f438d : MOV EDX,dword ptr [EDX + 0x8]
005f4390 : MOV dword ptr [EAX + 0x10],EDX
005f4393 : MOV EDX,dword ptr [ESI + 0x4]
005f4396 : MOV EDX,dword ptr [EDX]
005f4398 : POP EBX
005f4399 : POP EDI
005f439a : MOV dword ptr [EAX + 0x14],EDX
005f439d : POP ESI
005f439e : MOV dword ptr [EAX],0xffffffff
005f43a4 : MOV dword ptr [EAX + 0x4],ECX
005f43a7 : POP EBP
005f43a8 : RET 0xc

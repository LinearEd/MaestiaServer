PROGRAM  : Maestia.exe
FUNCTION : FUN_00a55850
ENTRY    : 00a55850
BODY     : [[00a55850, 00a55a65]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a55850(void)

{
  int iVar1;
  int *piVar2;
  int unaff_EDI;
  bool bVar3;
  undefined4 local_34;
  undefined2 uStack_30;
  undefined2 uStack_2e;
  undefined4 local_2c;
  undefined4 uStack_28;
  undefined4 local_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b683b1;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  FUN_008018d0(L"AvaGameLobby::SetSelectCharStep()",DAT_00d66fa0 ^ (uint)&stack0xffffffc0);
  iVar1 = *(int *)(DAT_0172491c + 0x98);
  if (iVar1 != 0) {
    local_34 = 0;
    uStack_30 = 0;
    uStack_2e = 0;
    local_2c = 0;
    uStack_28 = 0x3f800000;
    *(undefined8 *)(iVar1 + 0x10) = 0;
    *(undefined8 *)(iVar1 + 0x18) = 0x3f80000000000000;
  }
  if ((DAT_017251ac != 0) && (*(char *)(DAT_017251ac + 0x16c) == '\0')) {
    ShowWindow(*(HWND *)(DAT_017251ac + 0x170),0);
    ShowWindow(*(HWND *)(DAT_017251ac + 0x170),5);
  }
  iVar1 = DAT_017251ac;
  bVar3 = *(short *)(DAT_017248cc + 0x6c) != 0;
  *(bool *)(unaff_EDI + 0xd2) = bVar3;
  *(bool *)(iVar1 + 0x3d0) = bVar3;
  uStack_30 = 0;
  *(undefined1 *)(DAT_0172491c + 0xb5) = 0;
  local_1c = 7;
  local_20 = 0;
  FUN_00406360(L"bgm_main_title.mp3",0x12);
  local_c = 0;
  if (DAT_00d6ab0f != '\0') {
    FUN_008a0a00(&local_34);
  }
  local_c = 0xffffffff;
  if (7 < local_1c) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_1c = 7;
  local_20 = 0;
  uStack_30 = 0;
  *(undefined1 *)(unaff_EDI + 0x11c) = 0;
  *(undefined1 *)(unaff_EDI + 0x1e1) = 0;
  *(undefined1 *)(unaff_EDI + 0x2d8) = 0;
  if (*(int *)(unaff_EDI + 0x34) == 0) {
    piVar2 = (int *)FUN_007f91b0(*(undefined4 *)(DAT_0172491c + 0x90),unaff_EDI,1);
    *(int **)(unaff_EDI + 0x34) = piVar2;
    if (piVar2 == (int *)0x0) {
      FUN_008018d0(L"[AvaGameLobby::InitSelectChar] Flash file not found.\n");
      ExceptionList = local_14;
      return;
    }
    (**(code **)(*piVar2 + 0x14))(0);
    (**(code **)(**(int **)(unaff_EDI + 0x34) + 0xc))(1);
  }
  (*(code *)**(undefined4 **)(unaff_EDI + 4))();
  FUN_00a52530(unaff_EDI);
  if (((*(int *)(DAT_0172491c + 0x90) != 0) &&
      (iVar1 = *(int *)(*(int *)(DAT_0172491c + 0x90) + 0x110), iVar1 != 0)) &&
     (*(int *)(iVar1 + 0xc) == 0)) {
    FUN_007c92e0(iVar1);
  }
  FUN_00a534c0(unaff_EDI);
  *(undefined1 *)(unaff_EDI + 0x1e1) = 0;
  FUN_00a54100();
  ExceptionList = local_14;
  return;
}



============================================================
DISASSEMBLY
============================================================
00a55850 : PUSH EBP
00a55851 : MOV EBP,ESP
00a55853 : AND ESP,0xfffffff8
00a55856 : PUSH -0x1
00a55858 : PUSH 0xb683b1
00a5585d : MOV EAX,FS:[0x0]
00a55863 : PUSH EAX
00a55864 : SUB ESP,0x24
00a55867 : PUSH EBX
00a55868 : PUSH ESI
00a55869 : MOV EAX,[0x00d66fa0]
00a5586e : XOR EAX,ESP
00a55870 : PUSH EAX
00a55871 : LEA EAX,[ESP + 0x30]
00a55875 : MOV FS:[0x0],EAX
00a5587b : MOV ESI,dword ptr [0x00da98e8]
00a55881 : PUSH 0xcca030
00a55886 : CALL 0x008018d0
00a5588b : MOV EAX,[0x0172491c]
00a55890 : MOV EAX,dword ptr [EAX + 0x98]
00a55896 : XOR EBX,EBX
00a55898 : ADD ESP,0x4
00a5589b : CMP EAX,EBX
00a5589d : JZ 0x00a558d8
00a5589f : XORPS XMM0,XMM0
00a558a2 : MOVSS dword ptr [ESP + 0x10],XMM0
00a558a8 : MOVSS dword ptr [ESP + 0x14],XMM0
00a558ae : MOVSS dword ptr [ESP + 0x18],XMM0
00a558b4 : MOVSS XMM0,dword ptr [0x00c10fc4]
00a558bc : MOVSS dword ptr [ESP + 0x1c],XMM0
00a558c2 : MOVQ XMM0,qword ptr [ESP + 0x10]
00a558c8 : MOVQ qword ptr [EAX + 0x10],XMM0
00a558cd : MOVQ XMM0,qword ptr [ESP + 0x18]
00a558d3 : MOVQ qword ptr [EAX + 0x18],XMM0
00a558d8 : MOV ECX,dword ptr [0x017251ac]
00a558de : CMP ECX,EBX
00a558e0 : JZ 0x00a55911
00a558e2 : CMP byte ptr [ECX + 0x16c],BL
00a558e8 : JNZ 0x00a55911
00a558ea : MOV ECX,dword ptr [ECX + 0x170]
00a558f0 : MOV ESI,dword ptr [0x00b8543c]
00a558f6 : PUSH EBX
00a558f7 : PUSH ECX
00a558f8 : CALL ESI
00a558fa : MOV ECX,dword ptr [0x017251ac]
00a55900 : MOV EAX,dword ptr [ECX + 0x170]
00a55906 : PUSH 0x5
00a55908 : PUSH EAX
00a55909 : CALL ESI
00a5590b : MOV ECX,dword ptr [0x017251ac]
00a55911 : MOV EDX,dword ptr [0x017248cc]
00a55917 : MOVZX EAX,word ptr [EDX + 0x6c]
00a5591b : CMP AX,BX
00a5591e : SETNZ AL
00a55921 : MOV byte ptr [EDI + 0xd2],AL
00a55927 : MOV byte ptr [ECX + 0x3d0],AL
00a5592d : MOV EAX,[0x0172491c]
00a55932 : XOR ECX,ECX
00a55934 : PUSH 0x12
00a55936 : MOV word ptr [ESP + 0x18],CX
00a5593b : MOV ESI,0x7
00a55940 : PUSH 0xcca074
00a55945 : LEA ECX,[ESP + 0x18]
00a55949 : MOV byte ptr [EAX + 0xb5],BL
00a5594f : MOV dword ptr [ESP + 0x30],ESI
00a55953 : MOV dword ptr [ESP + 0x2c],EBX
00a55957 : CALL 0x00406360
00a5595c : MOV dword ptr [ESP + 0x38],EBX
00a55960 : CMP byte ptr [0x00d6ab0f],BL
00a55966 : JZ 0x00a55972
00a55968 : LEA EDX,[ESP + 0x10]
00a5596c : PUSH EDX
00a5596d : CALL 0x008a0a00
00a55972 : MOV dword ptr [ESP + 0x38],0xffffffff
00a5597a : CMP dword ptr [ESP + 0x28],0x8
00a5597f : JC 0x00a5598a
00a55981 : MOV ECX,dword ptr [ESP + 0x14]
00a55985 : CALL 0x006f04e0
00a5598a : XOR EAX,EAX
00a5598c : MOV dword ptr [ESP + 0x28],ESI
00a55990 : MOV dword ptr [ESP + 0x24],EBX
00a55994 : MOV word ptr [ESP + 0x14],AX
00a55999 : MOV byte ptr [EDI + 0x11c],BL
00a5599f : MOV byte ptr [EDI + 0x1e1],BL
00a559a5 : MOV byte ptr [EDI + 0x2d8],BL
00a559ab : CMP dword ptr [EDI + 0x34],EBX
00a559ae : JNZ 0x00a55a0c
00a559b0 : MOV ECX,dword ptr [0x0172491c]
00a559b6 : MOV EAX,dword ptr [ECX + 0x90]
00a559bc : PUSH 0x1
00a559be : PUSH EDI
00a559bf : PUSH EAX
00a559c0 : MOV ECX,0xcca09c
00a559c5 : CALL 0x007f91b0
00a559ca : MOV dword ptr [EDI + 0x34],EAX
00a559cd : CMP EAX,EBX
00a559cf : JNZ 0x00a559f6
00a559d1 : MOV ESI,dword ptr [0x00da98e8]
00a559d7 : PUSH 0xcca0a8
00a559dc : CALL 0x008018d0
00a559e1 : ADD ESP,0x4
00a559e4 : MOV ECX,dword ptr [ESP + 0x30]
00a559e8 : MOV dword ptr FS:[0x0],ECX
00a559ef : POP ECX
00a559f0 : POP ESI
00a559f1 : POP EBX
00a559f2 : MOV ESP,EBP
00a559f4 : POP EBP
00a559f5 : RET
00a559f6 : MOV EDX,dword ptr [EAX]
00a559f8 : MOV ECX,EAX
00a559fa : MOV EAX,dword ptr [EDX + 0x14]
00a559fd : PUSH EBX
00a559fe : CALL EAX
00a55a00 : MOV ECX,dword ptr [EDI + 0x34]
00a55a03 : MOV EDX,dword ptr [ECX]
00a55a05 : MOV EAX,dword ptr [EDX + 0xc]
00a55a08 : PUSH 0x1
00a55a0a : CALL EAX
00a55a0c : MOV EDX,dword ptr [EDI + 0x4]
00a55a0f : MOV EAX,dword ptr [EDX]
00a55a11 : LEA ECX,[EDI + 0x4]
00a55a14 : CALL EAX
00a55a16 : PUSH EDI
00a55a17 : CALL 0x00a52530
00a55a1c : MOV ECX,dword ptr [0x0172491c]
00a55a22 : MOV EAX,dword ptr [ECX + 0x90]
00a55a28 : CMP EAX,EBX
00a55a2a : JZ 0x00a55a41
00a55a2c : MOV EAX,dword ptr [EAX + 0x110]
00a55a32 : CMP EAX,EBX
00a55a34 : JZ 0x00a55a41
00a55a36 : CMP dword ptr [EAX + 0xc],EBX
00a55a39 : JNZ 0x00a55a41
00a55a3b : PUSH EAX
00a55a3c : CALL 0x007c92e0
00a55a41 : PUSH EDI
00a55a42 : CALL 0x00a534c0
00a55a47 : MOV ECX,EDI
00a55a49 : MOV byte ptr [EDI + 0x1e1],BL
00a55a4f : CALL 0x00a54100
00a55a54 : MOV ECX,dword ptr [ESP + 0x30]
00a55a58 : MOV dword ptr FS:[0x0],ECX
00a55a5f : POP ECX
00a55a60 : POP ESI
00a55a61 : POP EBX
00a55a62 : MOV ESP,EBP
00a55a64 : POP EBP
00a55a65 : RET

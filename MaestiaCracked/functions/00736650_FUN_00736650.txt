PROGRAM  : Maestia.exe
FUNCTION : FUN_00736650
ENTRY    : 00736650
BODY     : [[00736650, 007368ac]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00736650(int param_1,int param_2,int param_3,int param_4,undefined4 param_5,int param_6)

{
  int iVar1;
  float fVar2;
  float fVar3;
  float fVar4;
  float fVar5;
  ushort uVar6;
  ushort uVar7;
  int iVar8;
  int in_ECX;
  uint uVar9;
  undefined4 *puVar10;
  uint uVar11;
  uint uVar12;
  uint local_20;
  
  iVar8 = FUN_0070a3a0();
  fVar5 = DAT_00d72c24;
  uVar7 = 0;
  if (*(short *)(in_ECX + 0x10) != 0) {
    do {
      uVar9 = (uint)uVar7;
      puVar10 = (undefined4 *)(iVar8 + uVar9 * 0x44);
      iVar1 = uVar9 * 0xc;
      *puVar10 = *(undefined4 *)(iVar1 + param_1);
      puVar10[1] = *(undefined4 *)(iVar1 + 4 + param_1);
      puVar10[2] = *(undefined4 *)(iVar1 + 8 + param_1);
      puVar10[3] = *(undefined4 *)(iVar1 + param_2);
      puVar10[4] = *(undefined4 *)(iVar1 + 4 + param_2);
      puVar10[5] = *(undefined4 *)(iVar1 + 8 + param_2);
      puVar10[7] = *(undefined4 *)(param_3 + uVar9 * 8);
      puVar10[8] = *(undefined4 *)(param_3 + 4 + uVar9 * 8);
      fVar2 = *(float *)(iVar1 + param_4);
      fVar3 = *(float *)(iVar1 + 4 + param_4);
      fVar4 = *(float *)(iVar1 + 8 + param_4);
      if (fVar2 < 1.0) {
        if (0.0 < fVar2) {
          local_20 = (uint)(longlong)ROUND(fVar2 * 255.0 + fVar5);
          uVar11 = local_20;
        }
        else {
          uVar11 = 0;
        }
      }
      else {
        uVar11 = 0xff;
      }
      if (fVar3 < 1.0) {
        if (0.0 < fVar3) {
          local_20 = (uint)(longlong)ROUND(fVar3 * 255.0 + fVar5);
          uVar12 = local_20;
        }
        else {
          uVar12 = 0;
        }
      }
      else {
        uVar12 = 0xff;
      }
      if (fVar4 < 1.0) {
        if (0.0 < fVar4) {
          local_20 = (uint)(longlong)ROUND(fVar4 * 255.0 + fVar5);
        }
        else {
          local_20 = 0;
        }
      }
      else {
        local_20 = 0xff;
      }
      puVar10[6] = ((uVar11 | 0xffffff00) << 8 | uVar12) << 8 | local_20;
      uVar6 = 0;
      if (*(short *)(param_6 + uVar9 * 8) == 0) {
LAB_00736843:
        puVar10 = (undefined4 *)(iVar8 + 0x24 + (uVar9 * 0x11 + (uint)uVar6) * 4);
        uVar9 = (uint)(ushort)(4 - uVar6);
        do {
          puVar10[4] = 0;
          *puVar10 = 0;
          puVar10 = puVar10 + 1;
          uVar9 = uVar9 - 1;
        } while (uVar9 != 0);
      }
      else {
        do {
          uVar11 = (uint)uVar6;
          iVar1 = uVar9 * 0x11 + uVar11;
          *(float *)(iVar8 + 0x34 + iVar1 * 4) =
               (float)*(ushort *)(*(int *)(param_6 + 4 + uVar9 * 8) + 4 + uVar11 * 8);
          *(undefined4 *)(iVar8 + 0x24 + iVar1 * 4) =
               *(undefined4 *)(*(int *)(param_6 + 4 + uVar9 * 8) + uVar11 * 8);
          uVar6 = uVar6 + 1;
        } while (uVar6 < *(ushort *)(param_6 + uVar9 * 8));
        if (uVar6 < 4) goto LAB_00736843;
      }
      uVar7 = uVar7 + 1;
    } while (uVar7 < *(ushort *)(in_ECX + 0x10));
  }
  FUN_007377f0(iVar8);
  FUN_0070a260(iVar8);
  return;
}



============================================================
DISASSEMBLY
============================================================
00736650 : PUSH EBP
00736651 : MOV EBP,ESP
00736653 : AND ESP,0xfffffff8
00736656 : SUB ESP,0x2c
00736659 : PUSH EBX
0073665a : PUSH ESI
0073665b : PUSH EDI
0073665c : MOV EDI,ECX
0073665e : MOVZX EAX,word ptr [EDI + 0x10]
00736662 : MOV ECX,EAX
00736664 : SHL ECX,0x4
00736667 : ADD ECX,EAX
00736669 : ADD ECX,ECX
0073666b : ADD ECX,ECX
0073666d : MOV dword ptr [ESP + 0x1c],EDI
00736671 : CALL 0x0070a3a0
00736676 : MOV ESI,EAX
00736678 : XOR EAX,EAX
0073667a : MOV dword ptr [ESP + 0x14],ESI
0073667e : MOV dword ptr [ESP + 0x18],0x0
00736686 : CMP AX,word ptr [EDI + 0x10]
0073668a : JNC 0x00736893
00736690 : FLD float ptr [0x00cdf130]
00736696 : MOV EBX,dword ptr [EBP + 0x1c]
00736699 : MOVSS XMM4,dword ptr [0x00c10fc4]
007366a1 : FLD float ptr [0x00d72c24]
007366a7 : XORPS XMM2,XMM2
007366aa : MOVZX ECX,word ptr [ESP + 0x18]
007366af : MOV EDX,ECX
007366b1 : SHL EDX,0x4
007366b4 : LEA EAX,[ECX + ECX*0x2]
007366b7 : ADD EDX,ECX
007366b9 : LEA EDX,[ESI + EDX*0x4]
007366bc : MOV ESI,dword ptr [EBP + 0x8]
007366bf : ADD EAX,EAX
007366c1 : ADD EAX,EAX
007366c3 : FLD float ptr [EAX + ESI*0x1]
007366c6 : FSTP float ptr [EDX]
007366c8 : FLD float ptr [EAX + ESI*0x1 + 0x4]
007366cc : FSTP float ptr [EDX + 0x4]
007366cf : FLD float ptr [EAX + ESI*0x1 + 0x8]
007366d3 : MOV ESI,dword ptr [EBP + 0xc]
007366d6 : FSTP float ptr [EDX + 0x8]
007366d9 : FLD float ptr [EAX + ESI*0x1]
007366dc : FSTP float ptr [EDX + 0xc]
007366df : FLD float ptr [EAX + ESI*0x1 + 0x4]
007366e3 : FSTP float ptr [EDX + 0x10]
007366e6 : FLD float ptr [EAX + ESI*0x1 + 0x8]
007366ea : MOV ESI,dword ptr [EBP + 0x10]
007366ed : FSTP float ptr [EDX + 0x14]
007366f0 : FLD float ptr [ESI + ECX*0x8]
007366f3 : FSTP float ptr [EDX + 0x1c]
007366f6 : FLD float ptr [ESI + ECX*0x8 + 0x4]
007366fa : MOV ESI,dword ptr [EBP + 0x14]
007366fd : FSTP float ptr [EDX + 0x20]
00736700 : MOVSS XMM0,dword ptr [EAX + ESI*0x1]
00736705 : COMISS XMM0,XMM4
00736708 : MOVSS XMM1,dword ptr [EAX + ESI*0x1 + 0x4]
0073670e : MOVSS XMM3,dword ptr [EAX + ESI*0x1 + 0x8]
00736714 : MOVSS dword ptr [ESP + 0x28],XMM0
0073671a : MOVSS dword ptr [ESP + 0x2c],XMM1
00736720 : MOVSS dword ptr [ESP + 0x30],XMM3
00736726 : JC 0x0073672f
00736728 : MOV ESI,0xff
0073672d : JMP 0x00736762
0073672f : COMISS XMM2,XMM0
00736732 : JC 0x00736738
00736734 : XOR ESI,ESI
00736736 : JMP 0x00736762
00736738 : FLD float ptr [ESP + 0x28]
0073673c : FNSTCW word ptr [ESP + 0x12]
00736740 : MOVZX EAX,word ptr [ESP + 0x12]
00736745 : FMUL ST2
00736747 : OR EAX,0xc00
0073674c : MOV dword ptr [ESP + 0x20],EAX
00736750 : FADD ST0,ST1
00736752 : FLDCW word ptr [ESP + 0x20]
00736756 : FISTP qword ptr [ESP + 0x20]
0073675a : MOV ESI,dword ptr [ESP + 0x20]
0073675e : FLDCW word ptr [ESP + 0x12]
00736762 : COMISS XMM1,XMM4
00736765 : JC 0x0073676e
00736767 : MOV EDI,0xff
0073676c : JMP 0x007367a1
0073676e : COMISS XMM2,XMM1
00736771 : JC 0x00736777
00736773 : XOR EDI,EDI
00736775 : JMP 0x007367a1
00736777 : FLD float ptr [ESP + 0x2c]
0073677b : FNSTCW word ptr [ESP + 0x12]
0073677f : MOVZX EAX,word ptr [ESP + 0x12]
00736784 : FMUL ST2
00736786 : OR EAX,0xc00
0073678b : MOV dword ptr [ESP + 0x20],EAX
0073678f : FADD ST0,ST1
00736791 : FLDCW word ptr [ESP + 0x20]
00736795 : FISTP qword ptr [ESP + 0x20]
00736799 : MOV EDI,dword ptr [ESP + 0x20]
0073679d : FLDCW word ptr [ESP + 0x12]
007367a1 : COMISS XMM3,XMM4
007367a4 : JC 0x007367ad
007367a6 : MOV EAX,0xff
007367ab : JMP 0x007367e0
007367ad : COMISS XMM2,XMM3
007367b0 : JC 0x007367b6
007367b2 : XOR EAX,EAX
007367b4 : JMP 0x007367e0
007367b6 : FLD float ptr [ESP + 0x30]
007367ba : FNSTCW word ptr [ESP + 0x12]
007367be : MOVZX EAX,word ptr [ESP + 0x12]
007367c3 : FMUL ST2
007367c5 : OR EAX,0xc00
007367ca : MOV dword ptr [ESP + 0x20],EAX
007367ce : FADD ST0,ST1
007367d0 : FLDCW word ptr [ESP + 0x20]
007367d4 : FISTP qword ptr [ESP + 0x20]
007367d8 : MOV EAX,dword ptr [ESP + 0x20]
007367dc : FLDCW word ptr [ESP + 0x12]
007367e0 : OR ESI,0xffffff00
007367e6 : SHL ESI,0x8
007367e9 : OR ESI,EDI
007367eb : SHL ESI,0x8
007367ee : OR ESI,EAX
007367f0 : MOV dword ptr [EDX + 0x18],ESI
007367f3 : XOR EDX,EDX
007367f5 : XOR EAX,EAX
007367f7 : CMP DX,word ptr [EBX + ECX*0x8]
007367fb : JNC 0x00736843
007367fd : MOV EDI,ECX
007367ff : SHL EDI,0x4
00736802 : ADD EDI,ECX
00736804 : MOV EBX,dword ptr [EBX + ECX*0x8 + 0x4]
00736808 : MOVZX EDX,AX
0073680b : MOVZX EBX,word ptr [EBX + EDX*0x8 + 0x4]
00736810 : CVTSI2SS XMM0,EBX
00736814 : MOV EBX,dword ptr [ESP + 0x14]
00736818 : LEA ESI,[EDI + EDX*0x1]
0073681b : MOVSS dword ptr [EBX + ESI*0x4 + 0x34],XMM0
00736821 : MOV EBX,dword ptr [EBP + 0x1c]
00736824 : MOV EBX,dword ptr [EBX + ECX*0x8 + 0x4]
00736828 : FLD float ptr [EBX + EDX*0x8]
0073682b : MOV EDX,dword ptr [ESP + 0x14]
0073682f : MOV EBX,dword ptr [EBP + 0x1c]
00736832 : FSTP float ptr [EDX + ESI*0x4 + 0x24]
00736836 : INC EAX
00736837 : CMP AX,word ptr [EBX + ECX*0x8]
0073683b : JC 0x00736804
0073683d : CMP AX,0x4
00736841 : JNC 0x00736872
00736843 : MOV EDX,ECX
00736845 : SHL EDX,0x4
00736848 : ADD EDX,ECX
0073684a : MOVZX ECX,AX
0073684d : ADD EDX,ECX
0073684f : MOV ECX,dword ptr [ESP + 0x14]
00736853 : LEA ECX,[ECX + EDX*0x4 + 0x24]
00736857 : MOV EDX,0x4
0073685c : SUB EDX,EAX
0073685e : MOVZX EAX,DX
00736861 : MOVSS dword ptr [ECX + 0x10],XMM2
00736866 : MOVSS dword ptr [ECX],XMM2
0073686a : ADD ECX,0x4
0073686d : SUB EAX,0x1
00736870 : JNZ 0x00736861
00736872 : MOV EAX,dword ptr [ESP + 0x18]
00736876 : MOV ECX,dword ptr [ESP + 0x1c]
0073687a : MOV ESI,dword ptr [ESP + 0x14]
0073687e : INC EAX
0073687f : MOV dword ptr [ESP + 0x18],EAX
00736883 : CMP AX,word ptr [ECX + 0x10]
00736887 : JC 0x007366aa
0073688d : FSTP ST1
0073688f : MOV EDI,ECX
00736891 : FSTP ST0
00736893 : PUSH ESI
00736894 : MOV ECX,EDI
00736896 : CALL 0x007377f0
0073689b : PUSH ESI
0073689c : CALL 0x0070a260
007368a1 : ADD ESP,0x4
007368a4 : POP EDI
007368a5 : POP ESI
007368a6 : POP EBX
007368a7 : MOV ESP,EBP
007368a9 : POP EBP
007368aa : RET 0x18

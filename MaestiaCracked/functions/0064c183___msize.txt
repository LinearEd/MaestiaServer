PROGRAM  : Maestia.exe
FUNCTION : __msize
ENTRY    : 0064c183
BODY     : [[0064c183, 0064c214]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4 */
/* WARNING: Function: __SEH_epilog4 replaced with injection: EH_epilog3 */
/* Library Function - Single Match
    __msize
   
   Library: Visual Studio 2008 Release */

size_t __cdecl __msize(void *_Memory)

{
  int *piVar1;
  size_t sVar2;
  int iVar3;
  size_t local_20;
  
  if (_Memory == (void *)0x0) {
    piVar1 = __errno();
    *piVar1 = 0x16;
    __invalid_parameter(0,0,0,0,0);
    sVar2 = 0xffffffff;
  }
  else {
    if (DAT_01728d40 == 3) {
      __lock(4);
      iVar3 = ___sbh_find_block(_Memory);
      if (iVar3 != 0) {
        local_20 = *(int *)((int)_Memory + -4) - 9;
      }
      FUN_0064c21d();
      if (iVar3 != 0) {
        return local_20;
      }
    }
    sVar2 = HeapSize(DAT_00d7c09c,0,_Memory);
  }
  return sVar2;
}



============================================================
DISASSEMBLY
============================================================
0064c183 : PUSH 0x10
0064c185 : PUSH 0xced118
0064c18a : CALL 0x0064c228
0064c18f : XOR EAX,EAX
0064c191 : MOV EBX,dword ptr [EBP + 0x8]
0064c194 : XOR EDI,EDI
0064c196 : CMP EBX,EDI
0064c198 : SETNZ AL
0064c19b : CMP EAX,EDI
0064c19d : JNZ 0x0064c1bc
0064c19f : CALL 0x0063ab82
0064c1a4 : MOV dword ptr [EAX],0x16
0064c1aa : PUSH EDI
0064c1ab : PUSH EDI
0064c1ac : PUSH EDI
0064c1ad : PUSH EDI
0064c1ae : PUSH EDI
0064c1af : CALL 0x006372b8
0064c1b4 : ADD ESP,0x14
0064c1b7 : OR EAX,0xffffffff
0064c1ba : JMP 0x0064c20f
0064c1bc : CMP dword ptr [0x01728d40],0x3
0064c1c3 : JNZ 0x0064c1fd
0064c1c5 : PUSH 0x4
0064c1c7 : CALL 0x0064c598
0064c1cc : POP ECX
0064c1cd : MOV dword ptr [EBP + -0x4],EDI
0064c1d0 : PUSH EBX
0064c1d1 : CALL 0x0064cc12
0064c1d6 : POP ECX
0064c1d7 : MOV dword ptr [EBP + -0x20],EAX
0064c1da : CMP EAX,EDI
0064c1dc : JZ 0x0064c1e9
0064c1de : MOV ESI,dword ptr [EBX + -0x4]
0064c1e1 : SUB ESI,0x9
0064c1e4 : MOV dword ptr [EBP + -0x1c],ESI
0064c1e7 : JMP 0x0064c1ec
0064c1e9 : MOV ESI,dword ptr [EBP + -0x1c]
0064c1ec : MOV dword ptr [EBP + -0x4],0xfffffffe
0064c1f3 : CALL 0x0064c21d
0064c1f8 : CMP dword ptr [EBP + -0x20],EDI
0064c1fb : JNZ 0x0064c20d
0064c1fd : PUSH EBX
0064c1fe : PUSH EDI
0064c1ff : PUSH dword ptr [0x00d7c09c]
0064c205 : CALL dword ptr [0x00b85324]
0064c20b : MOV ESI,EAX
0064c20d : MOV EAX,ESI
0064c20f : CALL 0x0064c26d
0064c214 : RET

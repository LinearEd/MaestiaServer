PROGRAM  : Maestia.exe
FUNCTION : FUN_00607b30
ENTRY    : 00607b30
BODY     : [[00607b30, 00607cb1]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00607b30(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  uint *puVar1;
  uint uVar2;
  int iVar3;
  int in_ECX;
  int iVar4;
  uint uVar5;
  uint *puVar6;
  undefined4 *puVar7;
  undefined4 *puVar8;
  int local_44;
  undefined4 local_40 [4];
  undefined4 local_30;
  undefined4 local_2c;
  uint local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined1 local_c;
  undefined1 local_b;
  undefined1 local_a;
  undefined4 local_8;
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)&local_44;
  puVar1 = (uint *)(in_ECX + 0x10);
  local_40[0] = param_1;
  local_40[3] = param_1;
  puVar6 = (uint *)(in_ECX + 0x20);
  local_28 = *puVar1;
  local_40[2] = param_3;
  local_2c = param_3;
  local_1c = 0xffffffff;
  local_20 = 0xffffffff;
  local_24 = 0xffffffff;
  local_10 = 0xffffffff;
  local_14 = 0xffffffff;
  local_18 = 0xffffffff;
  uVar5 = *(uint *)(in_ECX + 0x10) >> 10;
  iVar4 = *(int *)(in_ECX + 0x20) * 4;
  local_40[1] = param_2;
  local_30 = param_2;
  local_a = 0;
  local_b = 0;
  local_c = 0;
  local_8 = param_4;
  local_44 = in_ECX;
  if (*(uint *)(in_ECX + 0x14) <= uVar5) {
    FUN_00606d80(uVar5);
  }
  puVar7 = (undefined4 *)(*(int *)(*(int *)(in_ECX + 0x1c) + uVar5 * 4) + (*puVar1 & 0x3ff) * 0xc);
  *puVar7 = param_1;
  puVar7[1] = param_2;
  puVar7[2] = iVar4;
  *puVar1 = *puVar1 + 1;
  uVar5 = *puVar1 >> 10;
  if (*(uint *)(in_ECX + 0x14) <= uVar5) {
    FUN_00606d80(uVar5);
  }
  uVar2 = *puVar1;
  iVar3 = *(int *)(*(int *)(in_ECX + 0x1c) + uVar5 * 4);
  *(undefined4 *)(iVar3 + (uVar2 & 0x3ff) * 0xc) = param_2;
  iVar3 = iVar3 + (uVar2 & 0x3ff) * 0xc;
  *(undefined4 *)(iVar3 + 4) = param_3;
  *(int *)(iVar3 + 8) = iVar4 + 1;
  *puVar1 = *puVar1 + 1;
  uVar5 = *puVar1 >> 10;
  if (*(uint *)(in_ECX + 0x14) <= uVar5) {
    FUN_00606d80(uVar5);
  }
  puVar7 = (undefined4 *)(*(int *)(*(int *)(in_ECX + 0x1c) + uVar5 * 4) + (*puVar1 & 0x3ff) * 0xc);
  *puVar7 = param_3;
  puVar7[1] = param_1;
  puVar7[2] = iVar4 + 2;
  *puVar1 = *puVar1 + 1;
  uVar5 = *puVar6 >> 8;
  if (*(uint *)(in_ECX + 0x24) <= uVar5) {
    FUN_00606df0(uVar5);
  }
  puVar7 = local_40;
  puVar8 = (undefined4 *)(*(int *)(*(int *)(in_ECX + 0x2c) + uVar5 * 4) + (*puVar6 & 0xff) * 0x3c);
  for (iVar4 = 0xf; iVar4 != 0; iVar4 = iVar4 + -1) {
    *puVar8 = *puVar7;
    puVar7 = puVar7 + 1;
    puVar8 = puVar8 + 1;
  }
  *puVar6 = *puVar6 + 1;
  *(undefined4 *)(local_44 + 0x7c) = param_4;
  __security_check_cookie(local_4 ^ (uint)&local_44);
  return;
}



============================================================
DISASSEMBLY
============================================================
00607b30 : SUB ESP,0x44
00607b33 : MOV EAX,[0x00d66fa0]
00607b38 : XOR EAX,ESP
00607b3a : MOV dword ptr [ESP + 0x40],EAX
00607b3e : MOV EAX,dword ptr [ESP + 0x48]
00607b42 : MOV EDX,dword ptr [ESP + 0x50]
00607b46 : PUSH EBX
00607b47 : PUSH EBP
00607b48 : MOV EBP,ECX
00607b4a : MOV EBX,dword ptr [EBP + 0x10]
00607b4d : MOV ECX,dword ptr [ESP + 0x54]
00607b51 : PUSH ESI
00607b52 : LEA ESI,[EBP + 0x10]
00607b55 : MOV dword ptr [ESP + 0x10],EAX
00607b59 : MOV dword ptr [ESP + 0x1c],EAX
00607b5d : MOV EAX,dword ptr [ESI]
00607b5f : PUSH EDI
00607b60 : MOV EDI,dword ptr [EBP + 0x20]
00607b63 : MOV dword ptr [ESP + 0x10],EBP
00607b67 : ADD EBP,0x20
00607b6a : MOV dword ptr [ESP + 0x2c],EAX
00607b6e : OR EAX,0xffffffff
00607b71 : ADD EDI,EDI
00607b73 : MOV dword ptr [ESP + 0x1c],EDX
00607b77 : MOV dword ptr [ESP + 0x28],EDX
00607b7b : MOV EDX,dword ptr [ESP + 0x64]
00607b7f : MOV dword ptr [ESP + 0x38],EAX
00607b83 : MOV dword ptr [ESP + 0x34],EAX
00607b87 : MOV dword ptr [ESP + 0x30],EAX
00607b8b : MOV dword ptr [ESP + 0x44],EAX
00607b8f : MOV dword ptr [ESP + 0x40],EAX
00607b93 : MOV dword ptr [ESP + 0x3c],EAX
00607b97 : XOR AL,AL
00607b99 : SHR EBX,0xa
00607b9c : ADD EDI,EDI
00607b9e : MOV dword ptr [ESP + 0x18],ECX
00607ba2 : MOV dword ptr [ESP + 0x24],ECX
00607ba6 : MOV byte ptr [ESP + 0x4a],AL
00607baa : MOV byte ptr [ESP + 0x49],AL
00607bae : MOV byte ptr [ESP + 0x48],AL
00607bb2 : MOV dword ptr [ESP + 0x4c],EDX
00607bb6 : CMP EBX,dword ptr [ESI + 0x4]
00607bb9 : JC 0x00607bc7
00607bbb : PUSH EBX
00607bbc : MOV ECX,ESI
00607bbe : CALL 0x00606d80
00607bc3 : MOV ECX,dword ptr [ESP + 0x5c]
00607bc7 : MOV EAX,dword ptr [ESI]
00607bc9 : MOV EDX,dword ptr [ESI + 0xc]
00607bcc : MOV EDX,dword ptr [EDX + EBX*0x4]
00607bcf : AND EAX,0x3ff
00607bd4 : LEA EAX,[EAX + EAX*0x2]
00607bd7 : LEA EAX,[EDX + EAX*0x4]
00607bda : MOV EDX,dword ptr [ESP + 0x58]
00607bde : MOV dword ptr [EAX],EDX
00607be0 : MOV dword ptr [EAX + 0x4],ECX
00607be3 : MOV dword ptr [EAX + 0x8],EDI
00607be6 : INC dword ptr [ESI]
00607be8 : MOV EBX,dword ptr [ESI]
00607bea : SHR EBX,0xa
00607bed : INC EDI
00607bee : CMP EBX,dword ptr [ESI + 0x4]
00607bf1 : JC 0x00607bff
00607bf3 : PUSH EBX
00607bf4 : MOV ECX,ESI
00607bf6 : CALL 0x00606d80
00607bfb : MOV ECX,dword ptr [ESP + 0x5c]
00607bff : MOV EAX,dword ptr [ESI]
00607c01 : MOV EDX,dword ptr [ESI + 0xc]
00607c04 : MOV EDX,dword ptr [EDX + EBX*0x4]
00607c07 : AND EAX,0x3ff
00607c0c : LEA EAX,[EAX + EAX*0x2]
00607c0f : MOV dword ptr [EDX + EAX*0x4],ECX
00607c12 : MOV ECX,dword ptr [ESP + 0x60]
00607c16 : LEA EAX,[EDX + EAX*0x4]
00607c19 : MOV dword ptr [EAX + 0x4],ECX
00607c1c : MOV dword ptr [EAX + 0x8],EDI
00607c1f : INC dword ptr [ESI]
00607c21 : MOV EBX,dword ptr [ESI]
00607c23 : SHR EBX,0xa
00607c26 : INC EDI
00607c27 : CMP EBX,dword ptr [ESI + 0x4]
00607c2a : JC 0x00607c34
00607c2c : PUSH EBX
00607c2d : MOV ECX,ESI
00607c2f : CALL 0x00606d80
00607c34 : MOV EAX,dword ptr [ESI]
00607c36 : MOV EDX,dword ptr [ESI + 0xc]
00607c39 : MOV ECX,dword ptr [EDX + EBX*0x4]
00607c3c : MOV EDX,dword ptr [ESP + 0x60]
00607c40 : AND EAX,0x3ff
00607c45 : LEA EAX,[EAX + EAX*0x2]
00607c48 : LEA EAX,[ECX + EAX*0x4]
00607c4b : MOV ECX,dword ptr [ESP + 0x58]
00607c4f : MOV dword ptr [EAX],EDX
00607c51 : MOV dword ptr [EAX + 0x4],ECX
00607c54 : MOV dword ptr [EAX + 0x8],EDI
00607c57 : INC dword ptr [ESI]
00607c59 : MOV ESI,dword ptr [EBP]
00607c5c : SHR ESI,0x8
00607c5f : CMP ESI,dword ptr [EBP + 0x4]
00607c62 : JC 0x00607c6c
00607c64 : PUSH ESI
00607c65 : MOV ECX,EBP
00607c67 : CALL 0x00606df0
00607c6c : MOV EAX,dword ptr [EBP]
00607c6f : MOV EDX,dword ptr [EBP + 0xc]
00607c72 : MOV EDX,dword ptr [EDX + ESI*0x4]
00607c75 : AND EAX,0xff
00607c7a : MOV ECX,EAX
00607c7c : SHL ECX,0x4
00607c7f : SUB ECX,EAX
00607c81 : MOV EAX,dword ptr [ESP + 0x10]
00607c85 : LEA EDI,[EDX + ECX*0x4]
00607c88 : MOV ECX,0xf
00607c8d : LEA ESI,[ESP + 0x14]
00607c91 : MOVSD.REP ES:EDI,ESI
00607c93 : INC dword ptr [EBP]
00607c96 : MOV ECX,dword ptr [ESP + 0x64]
00607c9a : POP EDI
00607c9b : POP ESI
00607c9c : MOV dword ptr [EAX + 0x7c],ECX
00607c9f : MOV ECX,dword ptr [ESP + 0x48]
00607ca3 : POP EBP
00607ca4 : POP EBX
00607ca5 : XOR ECX,ESP
00607ca7 : CALL 0x00633e6b
00607cac : ADD ESP,0x44
00607caf : RET 0x10

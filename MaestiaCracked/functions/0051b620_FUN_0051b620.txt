PROGRAM  : Maestia.exe
FUNCTION : FUN_0051b620
ENTRY    : 0051b620
BODY     : [[0051b620, 0051b6d3]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0051b620(char *param_1,int param_2,size_t param_3)

{
  uint uVar1;
  char cVar2;
  int iVar3;
  char *pcVar4;
  uint uVar5;
  int iVar6;
  int *in_ECX;
  
  iVar3 = in_ECX[1];
  if ((int)param_3 < 0) {
    pcVar4 = param_1;
    do {
      cVar2 = *pcVar4;
      pcVar4 = pcVar4 + 1;
    } while (cVar2 != '\0');
    param_3 = (int)pcVar4 - (int)(param_1 + 1);
  }
  if ((char)in_ECX[4] == '\0') {
    param_2 = FUN_0051b130(param_2,*in_ECX,0xffffffff);
  }
  uVar1 = param_3 + iVar3;
  if ((uint)in_ECX[2] <= uVar1) {
    uVar5 = in_ECX[3] + uVar1 & ~(in_ECX[3] - 1U);
    in_ECX[2] = uVar5;
    if (*in_ECX == 0) {
      iVar6 = FUN_00515840(uVar5,0);
    }
    else {
      iVar6 = FUN_00515c80(*in_ECX,uVar5);
    }
    *in_ECX = iVar6;
  }
  _memmove((void *)(*in_ECX + param_2 + param_3),(void *)(*in_ECX + param_2),(iVar3 - param_2) + 1);
  _memcpy((void *)(*in_ECX + param_2),param_1,param_3);
  in_ECX[1] = uVar1;
  *(undefined1 *)(in_ECX + 4) = 0;
  *(undefined1 *)(uVar1 + *in_ECX) = 0;
  return;
}



============================================================
DISASSEMBLY
============================================================
0051b620 : MOV EAX,dword ptr [ESP + 0xc]
0051b624 : PUSH EBX
0051b625 : PUSH EBP
0051b626 : PUSH ESI
0051b627 : MOV ESI,ECX
0051b629 : MOV EBX,dword ptr [ESI + 0x4]
0051b62c : PUSH EDI
0051b62d : TEST EAX,EAX
0051b62f : JGE 0x0051b641
0051b631 : MOV EAX,dword ptr [ESP + 0x14]
0051b635 : LEA EDX,[EAX + 0x1]
0051b638 : MOV CL,byte ptr [EAX]
0051b63a : INC EAX
0051b63b : TEST CL,CL
0051b63d : JNZ 0x0051b638
0051b63f : SUB EAX,EDX
0051b641 : CMP byte ptr [ESI + 0x10],0x0
0051b645 : MOV dword ptr [ESP + 0x1c],EAX
0051b649 : JZ 0x0051b651
0051b64b : MOV EBP,dword ptr [ESP + 0x18]
0051b64f : JMP 0x0051b662
0051b651 : MOV EAX,dword ptr [ESI]
0051b653 : MOV ECX,dword ptr [ESP + 0x18]
0051b657 : PUSH -0x1
0051b659 : PUSH EAX
0051b65a : PUSH ECX
0051b65b : CALL 0x0051b130
0051b660 : MOV EBP,EAX
0051b662 : MOV EDX,dword ptr [ESP + 0x1c]
0051b666 : LEA EDI,[EDX + EBX*0x1]
0051b669 : CMP EDI,dword ptr [ESI + 0x8]
0051b66c : JC 0x0051b698
0051b66e : MOV ECX,dword ptr [ESI + 0xc]
0051b671 : LEA EAX,[ECX + EDI*0x1]
0051b674 : DEC ECX
0051b675 : NOT ECX
0051b677 : AND EAX,ECX
0051b679 : MOV ECX,dword ptr [ESI]
0051b67b : MOV dword ptr [ESI + 0x8],EAX
0051b67e : TEST ECX,ECX
0051b680 : JNZ 0x0051b68f
0051b682 : MOV ECX,dword ptr [ESI + 0x14]
0051b685 : PUSH 0x0
0051b687 : PUSH EAX
0051b688 : CALL 0x00515840
0051b68d : JMP 0x0051b696
0051b68f : PUSH EAX
0051b690 : PUSH ECX
0051b691 : CALL 0x00515c80
0051b696 : MOV dword ptr [ESI],EAX
0051b698 : MOV EAX,dword ptr [ESI]
0051b69a : SUB EBX,EBP
0051b69c : INC EBX
0051b69d : ADD EAX,EBP
0051b69f : PUSH EBX
0051b6a0 : MOV EBX,dword ptr [ESP + 0x20]
0051b6a4 : PUSH EAX
0051b6a5 : ADD EAX,EBX
0051b6a7 : PUSH EAX
0051b6a8 : CALL 0x00636880
0051b6ad : MOV ECX,dword ptr [ESP + 0x20]
0051b6b1 : MOV EDX,dword ptr [ESI]
0051b6b3 : PUSH EBX
0051b6b4 : PUSH ECX
0051b6b5 : ADD EDX,EBP
0051b6b7 : PUSH EDX
0051b6b8 : CALL 0x0063ae40
0051b6bd : MOV EAX,dword ptr [ESI]
0051b6bf : ADD ESP,0x18
0051b6c2 : MOV dword ptr [ESI + 0x4],EDI
0051b6c5 : MOV byte ptr [ESI + 0x10],0x0
0051b6c9 : MOV byte ptr [EDI + EAX*0x1],0x0
0051b6cd : POP EDI
0051b6ce : POP ESI
0051b6cf : POP EBP
0051b6d0 : POP EBX
0051b6d1 : RET 0xc

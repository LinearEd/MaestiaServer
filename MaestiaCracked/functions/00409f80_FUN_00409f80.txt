PROGRAM  : Maestia.exe
FUNCTION : FUN_00409f80
ENTRY    : 00409f80
BODY     : [[00409f80, 0040a0c4] [0040a0d6, 0040a18c]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00409f80(uint param_1,undefined4 *param_2)

{
  undefined4 *puVar1;
  int iVar2;
  undefined4 *puVar3;
  int iVar4;
  undefined4 uVar5;
  uint uVar6;
  uint extraout_ECX;
  int iVar7;
  uint uVar8;
  undefined8 uVar9;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  iVar2 = param_1;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7c860;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  iVar7 = *(int *)(param_1 + 4);
  if (iVar7 == 0) {
    uVar6 = 0;
  }
  else {
    uVar6 = *(int *)(param_1 + 0xc) - iVar7 >> 3;
  }
  iVar7 = *(int *)(param_1 + 8) - iVar7 >> 3;
  uVar9 = CONCAT44(iVar7,*(int *)(param_1 + 8));
  if (iVar7 == 0x1fffffff) {
    uVar9 = FUN_00452880();
    uVar6 = extraout_ECX;
  }
  puVar3 = (undefined4 *)uVar9;
  uVar8 = (int)((ulonglong)uVar9 >> 0x20) + 1;
  if (uVar8 <= uVar6) {
    if ((int)puVar3 - (int)param_2 >> 3 == 0) {
      FUN_004f64d0(param_2,puVar3);
      local_8 = 2;
      FUN_004e8b90();
      local_8 = 0xffffffff;
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 8;
    }
    else {
      uVar5 = FUN_004f64d0(puVar3 + -2,puVar3);
      *(undefined4 *)(param_1 + 8) = uVar5;
      puVar1 = puVar3 + -2;
      while (param_2 != puVar1) {
        puVar3[-2] = puVar1[-2];
        puVar3[-1] = puVar1[-1];
        puVar1 = puVar1 + -2;
        puVar3 = puVar3 + -2;
      }
    }
    FUN_004db6f0(param_2);
    ExceptionList = local_10;
    return;
  }
  if (0x1fffffff - (uVar6 >> 1) < uVar6) {
    param_1 = 0;
  }
  else {
    param_1 = uVar6 + (uVar6 >> 1);
  }
  if (param_1 < uVar8) {
    param_1 = uVar8;
  }
  iVar4 = FUN_0040c2e0();
  local_8 = 0;
  FUN_004e8b90();
  FUN_004f64d0(*(undefined4 *)(iVar2 + 4),param_2);
  FUN_004f64d0(param_2,*(undefined4 *)(iVar2 + 8));
  local_8 = 0xffffffff;
  iVar7 = *(int *)(iVar2 + 4);
  if (iVar7 != 0) {
    for (; iVar7 != *(int *)(iVar2 + 8); iVar7 = iVar7 + 8) {
    }
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  *(uint *)(iVar2 + 0xc) = iVar4 + param_1 * 8;
  *(int *)(iVar2 + 8) = iVar4 + ((*(int *)(iVar2 + 8) - iVar7 >> 3) + 1) * 8;
  *(int *)(iVar2 + 4) = iVar4;
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00409f80 : PUSH EBP
00409f81 : MOV EBP,ESP
00409f83 : PUSH -0x1
00409f85 : PUSH 0xb7c860
00409f8a : MOV EAX,FS:[0x0]
00409f90 : PUSH EAX
00409f91 : SUB ESP,0x14
00409f94 : PUSH EBX
00409f95 : PUSH ESI
00409f96 : PUSH EDI
00409f97 : MOV EAX,[0x00d66fa0]
00409f9c : XOR EAX,EBP
00409f9e : PUSH EAX
00409f9f : LEA EAX,[EBP + -0xc]
00409fa2 : MOV FS:[0x0],EAX
00409fa8 : MOV dword ptr [EBP + -0x10],ESP
00409fab : MOV ESI,ECX
00409fad : MOV EBX,dword ptr [EBP + 0x8]
00409fb0 : MOV EDI,dword ptr [EBX + 0x4]
00409fb3 : TEST EDI,EDI
00409fb5 : JNZ 0x00409fbb
00409fb7 : XOR ECX,ECX
00409fb9 : JMP 0x00409fc5
00409fbb : MOV EAX,dword ptr [EBX + 0xc]
00409fbe : SUB EAX,EDI
00409fc0 : SAR EAX,0x3
00409fc3 : MOV ECX,EAX
00409fc5 : MOV EAX,dword ptr [EBX + 0x8]
00409fc8 : MOV EDX,EAX
00409fca : SUB EDX,EDI
00409fcc : SAR EDX,0x3
00409fcf : MOV EDI,0x1fffffff
00409fd4 : SUB EDI,EDX
00409fd6 : CMP EDI,0x1
00409fd9 : JNC 0x00409fe0
00409fdb : CALL 0x00452880
00409fe0 : INC EDX
00409fe1 : CMP ECX,EDX
00409fe3 : JNC 0x0040a0d6
00409fe9 : MOV EAX,ECX
00409feb : SHR EAX,0x1
00409fed : MOV EDI,0x1fffffff
00409ff2 : SUB EDI,EAX
00409ff4 : CMP EDI,ECX
00409ff6 : JNC 0x0040a004
00409ff8 : MOV dword ptr [EBP + 0x8],0x0
00409fff : MOV ECX,dword ptr [EBP + 0x8]
0040a002 : JMP 0x0040a009
0040a004 : ADD ECX,EAX
0040a006 : MOV dword ptr [EBP + 0x8],ECX
0040a009 : CMP ECX,EDX
0040a00b : JNC 0x0040a012
0040a00d : MOV dword ptr [EBP + 0x8],EDX
0040a010 : MOV ECX,EDX
0040a012 : CALL 0x0040c2e0
0040a017 : MOV dword ptr [EBP + -0x14],EAX
0040a01a : MOV ECX,dword ptr [EBP + 0xc]
0040a01d : SUB ECX,dword ptr [EBX + 0x4]
0040a020 : SAR ECX,0x3
0040a023 : MOV dword ptr [EBP + -0x1c],ECX
0040a026 : MOV dword ptr [EBP + -0x4],0x0
0040a02d : LEA EDI,[EAX + ECX*0x8]
0040a030 : MOV EDX,ESI
0040a032 : MOV ESI,0x1
0040a037 : CALL 0x004e8b90
0040a03c : MOV dword ptr [EBP + -0x18],ESI
0040a03f : MOV EAX,dword ptr [EBP + 0xc]
0040a042 : PUSH EAX
0040a043 : MOV ECX,dword ptr [EBX + 0x4]
0040a046 : PUSH ECX
0040a047 : MOV EDI,dword ptr [EBP + -0x14]
0040a04a : MOV EDX,EDI
0040a04c : CALL 0x004f64d0
0040a051 : MOV dword ptr [EBP + -0x18],0x2
0040a058 : MOV EDX,dword ptr [EBP + -0x1c]
0040a05b : LEA EDX,[EDI + EDX*0x8 + 0x8]
0040a05f : MOV EAX,dword ptr [EBX + 0x8]
0040a062 : PUSH EAX
0040a063 : MOV ECX,dword ptr [EBP + 0xc]
0040a066 : PUSH ECX
0040a067 : CALL 0x004f64d0
0040a06c : MOV dword ptr [EBP + -0x4],0xffffffff
0040a073 : MOV ECX,dword ptr [EBX + 0x8]
0040a076 : MOV EAX,dword ptr [EBX + 0x4]
0040a079 : MOV ESI,ECX
0040a07b : SUB ESI,EAX
0040a07d : SAR ESI,0x3
0040a080 : INC ESI
0040a081 : TEST EAX,EAX
0040a083 : JZ 0x0040a09f
0040a085 : CMP EAX,ECX
0040a087 : JZ 0x0040a097
0040a089 : LEA ESP,[ESP]
0040a090 : ADD EAX,0x8
0040a093 : CMP EAX,ECX
0040a095 : JNZ 0x0040a090
0040a097 : MOV ECX,dword ptr [EBX + 0x4]
0040a09a : CALL 0x006f04e0
0040a09f : MOV EDX,dword ptr [EBP + 0x8]
0040a0a2 : LEA EAX,[EDI + EDX*0x8]
0040a0a5 : MOV dword ptr [EBX + 0xc],EAX
0040a0a8 : LEA ECX,[EDI + ESI*0x8]
0040a0ab : MOV dword ptr [EBX + 0x8],ECX
0040a0ae : MOV dword ptr [EBX + 0x4],EDI
0040a0b1 : MOV ECX,dword ptr [EBP + -0xc]
0040a0b4 : MOV dword ptr FS:[0x0],ECX
0040a0bb : POP ECX
0040a0bc : POP EDI
0040a0bd : POP ESI
0040a0be : POP EBX
0040a0bf : MOV ESP,EBP
0040a0c1 : POP EBP
0040a0c2 : RET 0x8
0040a0d6 : MOV EDX,EAX
0040a0d8 : MOV ECX,dword ptr [EBP + 0xc]
0040a0db : SUB EDX,ECX
0040a0dd : SAR EDX,0x3
0040a0e0 : PUSH EAX
0040a0e1 : CMP EDX,0x1
0040a0e4 : MOV EDX,dword ptr [ESI]
0040a0e6 : MOV dword ptr [EBP + -0x20],EDX
0040a0e9 : JNC 0x0040a131
0040a0eb : MOV EDX,dword ptr [ESI + 0x4]
0040a0ee : MOV dword ptr [EBP + -0x1c],EDX
0040a0f1 : LEA EDX,[ECX + 0x8]
0040a0f4 : PUSH ECX
0040a0f5 : CALL 0x004f64d0
0040a0fa : MOV dword ptr [EBP + -0x4],0x2
0040a101 : MOV EDI,dword ptr [EBX + 0x8]
0040a104 : MOV EAX,EDI
0040a106 : SUB EAX,dword ptr [EBP + 0xc]
0040a109 : SAR EAX,0x3
0040a10c : MOV ESI,0x1
0040a111 : SUB ESI,EAX
0040a113 : LEA EDX,[EBP + -0x20]
0040a116 : CALL 0x004e8b90
0040a11b : MOV dword ptr [EBP + -0x4],0xffffffff
0040a122 : ADD dword ptr [EBX + 0x8],0x8
0040a126 : MOV EBX,dword ptr [EBX + 0x8]
0040a129 : LEA EDX,[EBX + -0x8]
0040a12c : MOV ECX,dword ptr [EBP + 0xc]
0040a12f : JMP 0x0040a16d
0040a131 : MOV ECX,dword ptr [ESI + 0x4]
0040a134 : MOV dword ptr [EBP + -0x1c],ECX
0040a137 : LEA ESI,[EAX + -0x8]
0040a13a : PUSH ESI
0040a13b : MOV EDX,EAX
0040a13d : CALL 0x004f64d0
0040a142 : MOV dword ptr [EBX + 0x8],EAX
0040a145 : MOV EAX,ESI
0040a147 : MOV ECX,dword ptr [EBP + 0xc]
0040a14a : MOV EDX,ECX
0040a14c : CMP ECX,EAX
0040a14e : JZ 0x0040a16a
0040a150 : LEA ECX,[EAX + 0x8]
0040a153 : SUB EAX,0x8
0040a156 : SUB ECX,0x8
0040a159 : MOV ESI,dword ptr [EAX]
0040a15b : MOV dword ptr [ECX],ESI
0040a15d : MOV ESI,dword ptr [EAX + 0x4]
0040a160 : MOV dword ptr [ECX + 0x4],ESI
0040a163 : CMP EAX,EDX
0040a165 : JNZ 0x0040a153
0040a167 : MOV ECX,dword ptr [EBP + 0xc]
0040a16a : LEA EDX,[ECX + 0x8]
0040a16d : PUSH ECX
0040a16e : LEA ECX,[EBP + -0x20]
0040a171 : CALL 0x004db6f0
0040a176 : ADD ESP,0x4
0040a179 : MOV ECX,dword ptr [EBP + -0xc]
0040a17c : MOV dword ptr FS:[0x0],ECX
0040a183 : POP ECX
0040a184 : POP EDI
0040a185 : POP ESI
0040a186 : POP EBX
0040a187 : MOV ESP,EBP
0040a189 : POP EBP
0040a18a : RET 0x8

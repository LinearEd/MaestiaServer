PROGRAM  : Maestia.exe
FUNCTION : FUN_0055cbb0
ENTRY    : 0055cbb0
BODY     : [[0055cbb0, 0055ccac] [0055ccb0, 0055cd5d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0055cbb0(undefined4 param_1,uint param_2)

{
  undefined4 *puVar1;
  uint uVar2;
  uint uVar3;
  undefined4 *puVar4;
  int iVar5;
  uint *puVar6;
  uint uVar7;
  int *in_ECX;
  uint *puVar8;
  int iVar9;
  float10 fVar10;
  int local_10;
  longlong local_c;
  int *local_4;
  
  if (param_2 == 0) {
    FUN_005a2e40();
    return;
  }
  local_4 = in_ECX;
  if (param_2 < 8) {
    iVar9 = 8;
  }
  else {
    fVar10 = (float10)FUN_0063b270();
    local_c = (longlong)ROUND((float)fVar10 / 0.6931472 + 1.0);
    iVar9 = 1 << ((byte)local_c & 0x1f);
  }
  local_c._0_4_ = 2;
  puVar4 = (undefined4 *)FUN_00515d60(param_1,iVar9 * 0xc + 8,&local_c);
  *puVar4 = 0;
  puVar4[1] = iVar9 + -1;
  if (iVar9 != 0) {
    iVar5 = 0;
    do {
      *(undefined4 *)(iVar5 + 8 + (int)puVar4) = 0xfffffffe;
      iVar5 = iVar5 + 0xc;
      iVar9 = iVar9 + -1;
    } while (iVar9 != 0);
  }
  if (*in_ECX != 0) {
    local_10 = 0;
    local_c = CONCAT44(local_c._4_4_,*(int *)(*in_ECX + 4) + 1);
    do {
      puVar1 = (undefined4 *)(*in_ECX + 8 + local_10);
      if (*(int *)(*in_ECX + 8 + local_10) != -2) {
        iVar9 = puVar1[2];
        puVar6 = (uint *)(*(uint *)(iVar9 + 0xc) & 0xfffffffc);
        if ((*puVar6 & 0x7fffffff) == 0) {
          puVar6 = (uint *)(**(code **)(**(int **)(*(int *)(iVar9 + 0x14) + 0xc) + 0x3c))();
        }
        else {
          puVar6 = puVar6 + 2;
        }
        uVar2 = *(uint *)(*(int *)(*(int *)(iVar9 + 0x14) + 0xc) + 0x14);
        uVar3 = *(uint *)(iVar9 + 8);
        puVar8 = puVar6;
        do {
          uVar7 = *puVar8;
          puVar8 = (uint *)((int)puVar8 + 1);
        } while ((char)uVar7 != '\0');
        uVar7 = FUN_0051b370(puVar6,(int)puVar8 - (int)((int)puVar6 + 1),0x1505);
        FUN_0055ce70(param_1,puVar1 + 2,(uVar2 & 3 | (uVar3 | uVar2) & 3) ^ uVar7);
        *puVar1 = 0xfffffffe;
        in_ECX = local_4;
      }
      local_10 = local_10 + 0xc;
      iVar9 = (int)local_c + -1;
      local_c = CONCAT44(local_c._4_4_,iVar9);
    } while (iVar9 != 0);
    FUN_00515cf0(*in_ECX);
  }
  *in_ECX = (int)puVar4;
  return;
}



============================================================
DISASSEMBLY
============================================================
0055cbb0 : SUB ESP,0x10
0055cbb3 : MOV EAX,dword ptr [ESP + 0x18]
0055cbb7 : PUSH EBP
0055cbb8 : PUSH EDI
0055cbb9 : XOR EBP,EBP
0055cbbb : MOV EDI,ECX
0055cbbd : MOV dword ptr [ESP + 0x14],EDI
0055cbc1 : CMP EAX,EBP
0055cbc3 : JNZ 0x0055cbd2
0055cbc5 : CALL 0x005a2e40
0055cbca : POP EDI
0055cbcb : POP EBP
0055cbcc : ADD ESP,0x10
0055cbcf : RET 0x8
0055cbd2 : PUSH ESI
0055cbd3 : CMP EAX,0x8
0055cbd6 : JNC 0x0055cbdf
0055cbd8 : MOV ESI,0x8
0055cbdd : JMP 0x0055cc44
0055cbdf : DEC EAX
0055cbe0 : MOV dword ptr [ESP + 0x24],EAX
0055cbe4 : FILD dword ptr [ESP + 0x24]
0055cbe8 : TEST EAX,EAX
0055cbea : JGE 0x0055cbf2
0055cbec : FADD float ptr [0x00cdf0e0]
0055cbf2 : CALL 0x0063b270
0055cbf7 : FSTP float ptr [ESP + 0x24]
0055cbfb : FLD float ptr [ESP + 0x24]
0055cbff : MOV ESI,0x1
0055cc04 : FDIV double ptr [0x00b85fe0]
0055cc0a : FSTP float ptr [ESP + 0x24]
0055cc0e : FLD float ptr [ESP + 0x24]
0055cc12 : FADD double ptr [0x00cdf108]
0055cc18 : FSTP float ptr [ESP + 0x24]
0055cc1c : FLD float ptr [ESP + 0x24]
0055cc20 : FNSTCW word ptr [ESP + 0x24]
0055cc24 : MOVZX EAX,word ptr [ESP + 0x24]
0055cc29 : OR EAX,0xc00
0055cc2e : MOV dword ptr [ESP + 0x10],EAX
0055cc32 : FLDCW word ptr [ESP + 0x10]
0055cc36 : FISTP qword ptr [ESP + 0x10]
0055cc3a : MOV CL,byte ptr [ESP + 0x10]
0055cc3e : SHL ESI,CL
0055cc40 : FLDCW word ptr [ESP + 0x24]
0055cc44 : LEA EAX,[ESP + 0x10]
0055cc48 : PUSH EAX
0055cc49 : MOV EAX,dword ptr [ESP + 0x24]
0055cc4d : LEA ECX,[ESI + ESI*0x2]
0055cc50 : LEA EDX,[ECX*0x4 + 0x8]
0055cc57 : PUSH EDX
0055cc58 : PUSH EAX
0055cc59 : MOV dword ptr [ESP + 0x30],EBP
0055cc5d : MOV dword ptr [ESP + 0x1c],0x2
0055cc65 : CALL 0x00515d60
0055cc6a : MOV dword ptr [ESP + 0x24],EAX
0055cc6e : MOV dword ptr [EAX],EBP
0055cc70 : MOV EDX,dword ptr [ESP + 0x24]
0055cc74 : LEA ECX,[ESI + -0x1]
0055cc77 : MOV dword ptr [EDX + 0x4],ECX
0055cc7a : CMP ESI,EBP
0055cc7c : JBE 0x0055cc94
0055cc7e : XOR EAX,EAX
0055cc80 : MOV ECX,dword ptr [ESP + 0x24]
0055cc84 : MOV dword ptr [EAX + ECX*0x1 + 0x8],0xfffffffe
0055cc8c : ADD EAX,0xc
0055cc8f : SUB ESI,0x1
0055cc92 : JNZ 0x0055cc80
0055cc94 : MOV EAX,dword ptr [EDI]
0055cc96 : CMP EAX,EBP
0055cc98 : JZ 0x0055cd4f
0055cc9e : MOV EAX,dword ptr [EAX + 0x4]
0055cca1 : INC EAX
0055cca2 : MOV dword ptr [ESP + 0xc],EBP
0055cca6 : MOV dword ptr [ESP + 0x10],EAX
0055ccaa : PUSH EBX
0055ccab : JMP 0x0055ccb0
0055ccb0 : MOV EDX,dword ptr [EDI]
0055ccb2 : CMP dword ptr [EDX + EBP*0x1 + 0x8],-0x2
0055ccb7 : LEA EBP,[EDX + EBP*0x1 + 0x8]
0055ccbb : JZ 0x0055cd30
0055ccbd : MOV EDI,dword ptr [EBP + 0x8]
0055ccc0 : MOV EAX,dword ptr [EDI + 0xc]
0055ccc3 : AND EAX,0xfffffffc
0055ccc6 : TEST dword ptr [EAX],0x7fffffff
0055cccc : JNZ 0x0055ccdd
0055ccce : MOV EAX,dword ptr [EDI + 0x14]
0055ccd1 : MOV ECX,dword ptr [EAX + 0xc]
0055ccd4 : MOV EDX,dword ptr [ECX]
0055ccd6 : MOV EAX,dword ptr [EDX + 0x3c]
0055ccd9 : CALL EAX
0055ccdb : JMP 0x0055cce0
0055ccdd : ADD EAX,0x8
0055cce0 : MOV ECX,dword ptr [EDI + 0x14]
0055cce3 : MOV EDX,dword ptr [ECX + 0xc]
0055cce6 : MOV ESI,dword ptr [EDX + 0x14]
0055cce9 : MOV EDI,dword ptr [EDI + 0x8]
0055ccec : OR EDI,ESI
0055ccee : MOV ECX,EAX
0055ccf0 : AND EDI,0x3
0055ccf3 : LEA EDX,[ECX + 0x1]
0055ccf6 : MOV BL,byte ptr [ECX]
0055ccf8 : INC ECX
0055ccf9 : TEST BL,BL
0055ccfb : JNZ 0x0055ccf6
0055ccfd : PUSH 0x1505
0055cd02 : SUB ECX,EDX
0055cd04 : PUSH ECX
0055cd05 : PUSH EAX
0055cd06 : CALL 0x0051b370
0055cd0b : OR ESI,EDI
0055cd0d : AND ESI,0x3
0055cd10 : XOR ESI,EAX
0055cd12 : PUSH ESI
0055cd13 : LEA EAX,[EBP + 0x8]
0055cd16 : PUSH EAX
0055cd17 : MOV EAX,dword ptr [ESP + 0x2c]
0055cd1b : PUSH EAX
0055cd1c : LEA ECX,[ESP + 0x34]
0055cd20 : CALL 0x0055ce70
0055cd25 : MOV EDI,dword ptr [ESP + 0x1c]
0055cd29 : MOV dword ptr [EBP],0xfffffffe
0055cd30 : MOV EBP,dword ptr [ESP + 0x10]
0055cd34 : ADD EBP,0xc
0055cd37 : SUB dword ptr [ESP + 0x14],0x1
0055cd3c : MOV dword ptr [ESP + 0x10],EBP
0055cd40 : JNZ 0x0055ccb0
0055cd46 : MOV ECX,dword ptr [EDI]
0055cd48 : PUSH ECX
0055cd49 : CALL 0x00515cf0
0055cd4e : POP EBX
0055cd4f : MOV EDX,dword ptr [ESP + 0x24]
0055cd53 : POP ESI
0055cd54 : MOV dword ptr [EDI],EDX
0055cd56 : POP EDI
0055cd57 : POP EBP
0055cd58 : ADD ESP,0x10
0055cd5b : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_0067cc70
ENTRY    : 0067cc70
BODY     : [[0067cc70, 0067cfb3]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_0067cc70(char *param_1,char *param_2)

{
  bool bVar1;
  int iVar2;
  uint uVar3;
  LONG LVar4;
  int *in_ECX;
  int *piVar5;
  undefined4 *puVar6;
  uint uVar7;
  uint uVar8;
  uint local_10;
  uint local_c;
  uint local_8;
  int local_4;
  
  FUN_0051b6e0();
  uVar7 = 0;
  bVar1 = false;
  local_c = 0xffffffff;
  local_4 = 0x2000000;
  local_8 = 0;
  if (in_ECX[0x2a] != 0) {
    puVar6 = &DAT_00d68890;
    do {
      if (((param_1 != (char *)0x0) && (iVar2 = __stricmp(param_1,(char *)puVar6[-2]), iVar2 == 0))
         && (iVar2 = (**(code **)(*in_ECX + 0xc))(*puVar6), in_ECX[0x11] == iVar2)) {
        FUN_0051bb20((&PTR_s_Chinese__Traditional____Phonetic_00d68888)[uVar7 * 4]);
        iVar2 = (&DAT_00d7c380)[uVar7];
        (&DAT_00d7c380)[uVar7] = 1;
        local_8 = (uint)(iVar2 != 0);
        local_c = uVar7;
        goto LAB_0067cde9;
      }
      uVar7 = uVar7 + 1;
      puVar6 = puVar6 + 4;
    } while (uVar7 < (uint)in_ECX[0x2a]);
  }
  uVar7 = 0;
  if (in_ECX[0x2a] != 0) {
    puVar6 = &DAT_00d68890;
    do {
      if (((param_2 != (char *)0x0) && (iVar2 = __stricmp(param_2,(char *)puVar6[-2]), iVar2 == 0))
         && (iVar2 = (**(code **)(*in_ECX + 0xc))(*puVar6), in_ECX[0x11] == iVar2)) {
        FUN_0051bb20((&PTR_s_Phonetic_00d6888c)[uVar7 * 4]);
        local_4 = (&DAT_00d68890)[uVar7 * 4];
        iVar2 = (&DAT_00d7c380)[uVar7];
        (&DAT_00d7c380)[uVar7] = 2;
        local_8 = (uint)(iVar2 != 0);
        bVar1 = true;
        local_c = uVar7;
        break;
      }
      uVar7 = uVar7 + 1;
      puVar6 = puVar6 + 4;
    } while (uVar7 < (uint)in_ECX[0x2a]);
  }
  uVar3 = 0;
  if (in_ECX[0x2a] != 0) {
    piVar5 = &DAT_00d68890;
    do {
      if (((&DAT_00d7c380)[uVar3] == 1) && (*piVar5 == local_4)) goto LAB_0067cf88;
      uVar3 = uVar3 + 1;
      piVar5 = piVar5 + 4;
    } while (uVar3 < (uint)in_ECX[0x2a]);
  }
  if (!bVar1) goto LAB_0067cf88;
LAB_0067cde9:
  if (local_8 != 0) goto LAB_0067cf88;
  uVar7 = (**(code **)(*in_ECX + 0xc))((&DAT_00d68890)[uVar7 * 4]);
  if ((uVar7 & 0xf00) != 0) {
    piVar5 = in_ECX + 2;
    uVar3 = in_ECX[3] + 1;
    if (uVar3 < (uint)in_ECX[3]) {
      FUN_0067ad00(*piVar5 + uVar3 * 4,in_ECX[3] - uVar3);
      uVar8 = uVar3;
      if (uVar3 < (uint)in_ECX[4] >> 1) {
LAB_0067ce4a:
        FUN_0057c3a0(piVar5,uVar8);
      }
    }
    else if ((uint)in_ECX[4] <= uVar3) {
      uVar8 = (uVar3 >> 2) + uVar3;
      goto LAB_0067ce4a;
    }
    in_ECX[3] = uVar3;
    if (*piVar5 + -4 + uVar3 * 4 != 0) {
      FUN_0051c600(&local_10);
    }
  }
  if ((uVar7 & 0xf000) != 0) {
    piVar5 = in_ECX + 5;
    uVar3 = in_ECX[6] + 1;
    if (uVar3 < (uint)in_ECX[6]) {
      FUN_0067ad00(*piVar5 + uVar3 * 4,in_ECX[6] - uVar3);
      uVar8 = uVar3;
      if (uVar3 < (uint)in_ECX[7] >> 1) {
LAB_0067ceab:
        FUN_0057c3a0(piVar5,uVar8);
      }
    }
    else if ((uint)in_ECX[7] <= uVar3) {
      uVar8 = (uVar3 >> 2) + uVar3;
      goto LAB_0067ceab;
    }
    in_ECX[6] = uVar3;
    if (*piVar5 + -4 + uVar3 * 4 != 0) {
      FUN_0051c600(&local_10);
    }
  }
  if ((uVar7 & 0xf0000) != 0) {
    piVar5 = in_ECX + 8;
    uVar3 = in_ECX[9] + 1;
    if (uVar3 < (uint)in_ECX[9]) {
      FUN_0067ad00(*piVar5 + uVar3 * 4,in_ECX[9] - uVar3);
      uVar8 = uVar3;
      if (uVar3 < (uint)in_ECX[10] >> 1) {
LAB_0067cf0c:
        FUN_0057c3a0(piVar5,uVar8);
      }
    }
    else if ((uint)in_ECX[10] <= uVar3) {
      uVar8 = (uVar3 >> 2) + uVar3;
      goto LAB_0067cf0c;
    }
    in_ECX[9] = uVar3;
    if (*piVar5 + -4 + uVar3 * 4 != 0) {
      FUN_0051c600(&local_10);
    }
  }
  if ((uVar7 & 0xf) == 0) goto LAB_0067cf88;
  piVar5 = in_ECX + 0xb;
  uVar7 = in_ECX[0xc] + 1;
  if (uVar7 < (uint)in_ECX[0xc]) {
    FUN_0067ad00(*piVar5 + uVar7 * 4,in_ECX[0xc] - uVar7);
    uVar3 = uVar7;
    if (uVar7 < (uint)in_ECX[0xd] >> 1) {
LAB_0067cf69:
      FUN_0057c3a0(piVar5,uVar3);
    }
  }
  else if ((uint)in_ECX[0xd] <= uVar7) {
    uVar3 = (uVar7 >> 2) + uVar7;
    goto LAB_0067cf69;
  }
  in_ECX[0xc] = uVar7;
  if (*piVar5 + -4 + uVar7 * 4 != 0) {
    FUN_0051c600(&local_10);
  }
LAB_0067cf88:
  LVar4 = InterlockedExchangeAdd((LONG *)((local_10 & 0xfffffffc) + 4),-1);
  if (LVar4 == 1) {
    FUN_00515cf0(local_10 & 0xfffffffc);
  }
  return local_c;
}



============================================================
DISASSEMBLY
============================================================
0067cc70 : SUB ESP,0x14
0067cc73 : PUSH EBX
0067cc74 : PUSH EBP
0067cc75 : PUSH ESI
0067cc76 : PUSH EDI
0067cc77 : MOV EDI,ECX
0067cc79 : LEA ECX,[ESP + 0x14]
0067cc7d : CALL 0x0051b6e0
0067cc82 : XOR ESI,ESI
0067cc84 : MOV byte ptr [ESP + 0x13],0x0
0067cc89 : MOV dword ptr [ESP + 0x18],0xffffffff
0067cc91 : MOV dword ptr [ESP + 0x20],0x2000000
0067cc99 : MOV dword ptr [ESP + 0x1c],ESI
0067cc9d : CMP dword ptr [EDI + 0xa8],ESI
0067cca3 : JBE 0x0067cce3
0067cca5 : MOV EBX,dword ptr [ESP + 0x28]
0067cca9 : MOV EBP,0xd68890
0067ccae : MOV EDI,EDI
0067ccb0 : TEST EBX,EBX
0067ccb2 : JZ 0x0067ccd7
0067ccb4 : MOV EAX,dword ptr [EBP + -0x8]
0067ccb7 : PUSH EAX
0067ccb8 : PUSH EBX
0067ccb9 : CALL 0x0051c970
0067ccbe : ADD ESP,0x8
0067ccc1 : TEST EAX,EAX
0067ccc3 : JNZ 0x0067ccd7
0067ccc5 : MOV EDX,dword ptr [EDI]
0067ccc7 : MOV EAX,dword ptr [EBP]
0067ccca : MOV EDX,dword ptr [EDX + 0xc]
0067cccd : PUSH EAX
0067ccce : MOV ECX,EDI
0067ccd0 : CALL EDX
0067ccd2 : CMP dword ptr [EDI + 0x44],EAX
0067ccd5 : JZ 0x0067cd35
0067ccd7 : INC ESI
0067ccd8 : ADD EBP,0x10
0067ccdb : CMP ESI,dword ptr [EDI + 0xa8]
0067cce1 : JC 0x0067ccb0
0067cce3 : XOR ESI,ESI
0067cce5 : CMP dword ptr [EDI + 0xa8],ESI
0067cceb : JBE 0x0067cdae
0067ccf1 : MOV EBX,dword ptr [ESP + 0x2c]
0067ccf5 : MOV EBP,0xd68890
0067ccfa : LEA EBX,[EBX]
0067cd00 : TEST EBX,EBX
0067cd02 : JZ 0x0067cd27
0067cd04 : MOV EAX,dword ptr [EBP + -0x8]
0067cd07 : PUSH EAX
0067cd08 : PUSH EBX
0067cd09 : CALL 0x0051c970
0067cd0e : ADD ESP,0x8
0067cd11 : TEST EAX,EAX
0067cd13 : JNZ 0x0067cd27
0067cd15 : MOV EDX,dword ptr [EDI]
0067cd17 : MOV EAX,dword ptr [EBP]
0067cd1a : MOV EDX,dword ptr [EDX + 0xc]
0067cd1d : PUSH EAX
0067cd1e : MOV ECX,EDI
0067cd20 : CALL EDX
0067cd22 : CMP dword ptr [EDI + 0x44],EAX
0067cd25 : JZ 0x0067cd6b
0067cd27 : INC ESI
0067cd28 : ADD EBP,0x10
0067cd2b : CMP ESI,dword ptr [EDI + 0xa8]
0067cd31 : JC 0x0067cd00
0067cd33 : JMP 0x0067cdae
0067cd35 : MOV EAX,ESI
0067cd37 : SHL EAX,0x4
0067cd3a : MOV ECX,dword ptr [EAX + 0xd68888]
0067cd40 : PUSH ECX
0067cd41 : LEA ECX,[ESP + 0x18]
0067cd45 : CALL 0x0051bb20
0067cd4a : XOR EDX,EDX
0067cd4c : CMP dword ptr [ESI*0x4 + 0xd7c380],EDX
0067cd53 : MOV dword ptr [ESI*0x4 + 0xd7c380],0x1
0067cd5e : SETNZ DL
0067cd61 : MOV dword ptr [ESP + 0x18],ESI
0067cd65 : MOV dword ptr [ESP + 0x1c],EDX
0067cd69 : JMP 0x0067cde9
0067cd6b : MOV EBP,ESI
0067cd6d : SHL EBP,0x4
0067cd70 : MOV EAX,dword ptr [EBP + 0xd6888c]
0067cd76 : PUSH EAX
0067cd77 : LEA ECX,[ESP + 0x18]
0067cd7b : CALL 0x0051bb20
0067cd80 : MOV EDX,dword ptr [EBP + 0xd68890]
0067cd86 : XOR ECX,ECX
0067cd88 : CMP dword ptr [ESI*0x4 + 0xd7c380],ECX
0067cd8f : MOV dword ptr [ESI*0x4 + 0xd7c380],0x2
0067cd9a : SETNZ CL
0067cd9d : MOV byte ptr [ESP + 0x13],0x1
0067cda2 : MOV dword ptr [ESP + 0x18],ESI
0067cda6 : MOV dword ptr [ESP + 0x20],EDX
0067cdaa : MOV dword ptr [ESP + 0x1c],ECX
0067cdae : MOV EDX,dword ptr [EDI + 0xa8]
0067cdb4 : XOR EAX,EAX
0067cdb6 : TEST EDX,EDX
0067cdb8 : JBE 0x0067cdde
0067cdba : MOV ECX,0xd68890
0067cdbf : NOP
0067cdc0 : CMP dword ptr [EAX*0x4 + 0xd7c380],0x1
0067cdc8 : JNZ 0x0067cdd6
0067cdca : MOV EBX,dword ptr [ESP + 0x20]
0067cdce : CMP dword ptr [ECX],EBX
0067cdd0 : JZ 0x0067cf88
0067cdd6 : INC EAX
0067cdd7 : ADD ECX,0x10
0067cdda : CMP EAX,EDX
0067cddc : JC 0x0067cdc0
0067cdde : CMP byte ptr [ESP + 0x13],0x1
0067cde3 : JNZ 0x0067cf88
0067cde9 : CMP dword ptr [ESP + 0x1c],0x0
0067cdee : JNZ 0x0067cf88
0067cdf4 : MOV EAX,dword ptr [EDI]
0067cdf6 : MOV EDX,dword ptr [EAX + 0xc]
0067cdf9 : SHL ESI,0x4
0067cdfc : MOV ECX,dword ptr [ESI + 0xd68890]
0067ce02 : PUSH ECX
0067ce03 : MOV ECX,EDI
0067ce05 : CALL EDX
0067ce07 : MOV EBX,EAX
0067ce09 : TEST EBX,0xf00
0067ce0f : JZ 0x0067ce6a
0067ce11 : MOV ESI,dword ptr [EDI + 0xc]
0067ce14 : MOV EAX,dword ptr [EDI + 0xc]
0067ce17 : LEA EBP,[EDI + 0x8]
0067ce1a : INC ESI
0067ce1b : CMP ESI,EAX
0067ce1d : JNC 0x0067ce3d
0067ce1f : SUB EAX,ESI
0067ce21 : PUSH EAX
0067ce22 : MOV EAX,dword ptr [EBP]
0067ce25 : LEA ECX,[EAX + ESI*0x4]
0067ce28 : PUSH ECX
0067ce29 : CALL 0x0067ad00
0067ce2e : MOV EDX,dword ptr [EBP + 0x8]
0067ce31 : SHR EDX,0x1
0067ce33 : ADD ESP,0x8
0067ce36 : CMP ESI,EDX
0067ce38 : JNC 0x0067ce52
0067ce3a : PUSH ESI
0067ce3b : JMP 0x0067ce4a
0067ce3d : CMP ESI,dword ptr [EBP + 0x8]
0067ce40 : JC 0x0067ce52
0067ce42 : MOV EAX,ESI
0067ce44 : SHR EAX,0x2
0067ce47 : ADD EAX,ESI
0067ce49 : PUSH EAX
0067ce4a : PUSH EBP
0067ce4b : MOV ECX,EBP
0067ce4d : CALL 0x0057c3a0
0067ce52 : MOV ECX,dword ptr [EBP]
0067ce55 : LEA ECX,[ECX + ESI*0x4 + -0x4]
0067ce59 : MOV dword ptr [EBP + 0x4],ESI
0067ce5c : TEST ECX,ECX
0067ce5e : JZ 0x0067ce6a
0067ce60 : LEA EDX,[ESP + 0x14]
0067ce64 : PUSH EDX
0067ce65 : CALL 0x0051c600
0067ce6a : TEST EBX,0xf000
0067ce70 : JZ 0x0067cecb
0067ce72 : MOV ESI,dword ptr [EDI + 0x18]
0067ce75 : MOV EAX,dword ptr [EDI + 0x18]
0067ce78 : LEA EBP,[EDI + 0x14]
0067ce7b : INC ESI
0067ce7c : CMP ESI,EAX
0067ce7e : JNC 0x0067ce9e
0067ce80 : SUB EAX,ESI
0067ce82 : PUSH EAX
0067ce83 : MOV EAX,dword ptr [EBP]
0067ce86 : LEA ECX,[EAX + ESI*0x4]
0067ce89 : PUSH ECX
0067ce8a : CALL 0x0067ad00
0067ce8f : MOV EDX,dword ptr [EBP + 0x8]
0067ce92 : SHR EDX,0x1
0067ce94 : ADD ESP,0x8
0067ce97 : CMP ESI,EDX
0067ce99 : JNC 0x0067ceb3
0067ce9b : PUSH ESI
0067ce9c : JMP 0x0067ceab
0067ce9e : CMP ESI,dword ptr [EBP + 0x8]
0067cea1 : JC 0x0067ceb3
0067cea3 : MOV EAX,ESI
0067cea5 : SHR EAX,0x2
0067cea8 : ADD EAX,ESI
0067ceaa : PUSH EAX
0067ceab : PUSH EBP
0067ceac : MOV ECX,EBP
0067ceae : CALL 0x0057c3a0
0067ceb3 : MOV ECX,dword ptr [EBP]
0067ceb6 : LEA ECX,[ECX + ESI*0x4 + -0x4]
0067ceba : MOV dword ptr [EBP + 0x4],ESI
0067cebd : TEST ECX,ECX
0067cebf : JZ 0x0067cecb
0067cec1 : LEA EDX,[ESP + 0x14]
0067cec5 : PUSH EDX
0067cec6 : CALL 0x0051c600
0067cecb : TEST EBX,0xf0000
0067ced1 : JZ 0x0067cf2c
0067ced3 : MOV ESI,dword ptr [EDI + 0x24]
0067ced6 : MOV EAX,dword ptr [EDI + 0x24]
0067ced9 : LEA EBP,[EDI + 0x20]
0067cedc : INC ESI
0067cedd : CMP ESI,EAX
0067cedf : JNC 0x0067ceff
0067cee1 : SUB EAX,ESI
0067cee3 : PUSH EAX
0067cee4 : MOV EAX,dword ptr [EBP]
0067cee7 : LEA ECX,[EAX + ESI*0x4]
0067ceea : PUSH ECX
0067ceeb : CALL 0x0067ad00
0067cef0 : MOV EDX,dword ptr [EBP + 0x8]
0067cef3 : SHR EDX,0x1
0067cef5 : ADD ESP,0x8
0067cef8 : CMP ESI,EDX
0067cefa : JNC 0x0067cf14
0067cefc : PUSH ESI
0067cefd : JMP 0x0067cf0c
0067ceff : CMP ESI,dword ptr [EBP + 0x8]
0067cf02 : JC 0x0067cf14
0067cf04 : MOV EAX,ESI
0067cf06 : SHR EAX,0x2
0067cf09 : ADD EAX,ESI
0067cf0b : PUSH EAX
0067cf0c : PUSH EBP
0067cf0d : MOV ECX,EBP
0067cf0f : CALL 0x0057c3a0
0067cf14 : MOV ECX,dword ptr [EBP]
0067cf17 : LEA ECX,[ECX + ESI*0x4 + -0x4]
0067cf1b : MOV dword ptr [EBP + 0x4],ESI
0067cf1e : TEST ECX,ECX
0067cf20 : JZ 0x0067cf2c
0067cf22 : LEA EDX,[ESP + 0x14]
0067cf26 : PUSH EDX
0067cf27 : CALL 0x0051c600
0067cf2c : TEST BL,0xf
0067cf2f : JZ 0x0067cf88
0067cf31 : MOV ESI,dword ptr [EDI + 0x30]
0067cf34 : MOV EAX,dword ptr [EDI + 0x30]
0067cf37 : ADD EDI,0x2c
0067cf3a : INC ESI
0067cf3b : CMP ESI,EAX
0067cf3d : JNC 0x0067cf5c
0067cf3f : SUB EAX,ESI
0067cf41 : PUSH EAX
0067cf42 : MOV EAX,dword ptr [EDI]
0067cf44 : LEA ECX,[EAX + ESI*0x4]
0067cf47 : PUSH ECX
0067cf48 : CALL 0x0067ad00
0067cf4d : MOV EDX,dword ptr [EDI + 0x8]
0067cf50 : SHR EDX,0x1
0067cf52 : ADD ESP,0x8
0067cf55 : CMP ESI,EDX
0067cf57 : JNC 0x0067cf71
0067cf59 : PUSH ESI
0067cf5a : JMP 0x0067cf69
0067cf5c : CMP ESI,dword ptr [EDI + 0x8]
0067cf5f : JC 0x0067cf71
0067cf61 : MOV EAX,ESI
0067cf63 : SHR EAX,0x2
0067cf66 : ADD EAX,ESI
0067cf68 : PUSH EAX
0067cf69 : PUSH EDI
0067cf6a : MOV ECX,EDI
0067cf6c : CALL 0x0057c3a0
0067cf71 : MOV ECX,dword ptr [EDI]
0067cf73 : LEA ECX,[ECX + ESI*0x4 + -0x4]
0067cf77 : MOV dword ptr [EDI + 0x4],ESI
0067cf7a : TEST ECX,ECX
0067cf7c : JZ 0x0067cf88
0067cf7e : LEA EDX,[ESP + 0x14]
0067cf82 : PUSH EDX
0067cf83 : CALL 0x0051c600
0067cf88 : MOV ESI,dword ptr [ESP + 0x14]
0067cf8c : AND ESI,0xfffffffc
0067cf8f : PUSH -0x1
0067cf91 : LEA EAX,[ESI + 0x4]
0067cf94 : PUSH EAX
0067cf95 : CALL dword ptr [0x00b851cc]
0067cf9b : SUB EAX,0x1
0067cf9e : JNZ 0x0067cfa6
0067cfa0 : PUSH ESI
0067cfa1 : CALL 0x00515cf0
0067cfa6 : MOV EAX,dword ptr [ESP + 0x18]
0067cfaa : POP EDI
0067cfab : POP ESI
0067cfac : POP EBP
0067cfad : POP EBX
0067cfae : ADD ESP,0x14
0067cfb1 : RET 0x8

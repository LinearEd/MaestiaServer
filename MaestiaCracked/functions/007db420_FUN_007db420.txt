PROGRAM  : Maestia.exe
FUNCTION : FUN_007db420
ENTRY    : 007db420
BODY     : [[007db420, 007db48d] [007db490, 007db4b6] [007db4c0, 007db53c] [007db540, 007db592]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007db420(undefined4 param_1)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  int *in_ECX;
  uint uVar7;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3c944;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (in_ECX[2] != 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)(in_ECX[2] + 4));
  }
  local_8 = 0;
  if (in_ECX[99] != 0) {
    puVar1 = (undefined4 *)in_ECX[0x62];
    for (puVar2 = (undefined4 *)*puVar1; puVar2 != puVar1; puVar2 = (undefined4 *)*puVar2) {
      iVar5 = (**(code **)(*(int *)puVar2[9] + 4))(uVar4);
      if (iVar5 == 2) {
        iVar5 = puVar2[9];
        uVar6 = (uint)*(ushort *)(iVar5 + 0x1e4);
        uVar7 = 0;
        if (uVar6 != 0) {
          do {
            iVar3 = *(int *)(*(int *)(iVar5 + 0x1d8) + (uVar7 & 0xffff) * 4);
            if (iVar3 != 0) {
              FUN_00405ae0(iVar3 + 0x48);
              FUN_00405ae0(iVar3 + 100);
              FUN_00405ae0(iVar3 + 0x80);
              FUN_00405ae0(iVar3 + 0x9c);
            }
            uVar7 = uVar7 + 1;
          } while ((int)uVar7 < (int)uVar6);
        }
      }
    }
  }
  iVar5 = (**(code **)(*in_ECX + 0x44))();
  if (iVar5 != 0) {
    puVar1 = (undefined4 *)in_ECX[0xe];
    for (puVar2 = (undefined4 *)*puVar1; puVar2 != puVar1; puVar2 = (undefined4 *)*puVar2) {
      if (((int *)puVar2[9] != (int *)0x0) &&
         (iVar5 = (**(code **)(*(int *)puVar2[9] + 0x1c))(), iVar5 == 2)) {
        FUN_007db420(param_1);
      }
    }
  }
  local_8 = 0xffffffff;
  if (in_ECX[2] != 0) {
    LeaveCriticalSection((LPCRITICAL_SECTION)(in_ECX[2] + 4));
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
007db420 : PUSH EBP
007db421 : MOV EBP,ESP
007db423 : PUSH -0x1
007db425 : PUSH 0xb3c944
007db42a : MOV EAX,FS:[0x0]
007db430 : PUSH EAX
007db431 : SUB ESP,0x18
007db434 : PUSH EBX
007db435 : PUSH ESI
007db436 : PUSH EDI
007db437 : MOV EAX,[0x00d66fa0]
007db43c : XOR EAX,EBP
007db43e : PUSH EAX
007db43f : LEA EAX,[EBP + -0xc]
007db442 : MOV FS:[0x0],EAX
007db448 : MOV EBX,ECX
007db44a : MOV dword ptr [EBP + -0x14],EBX
007db44d : MOV EAX,dword ptr [EBX + 0x8]
007db450 : MOV dword ptr [EBP + -0x20],EBX
007db453 : TEST EAX,EAX
007db455 : JZ 0x007db461
007db457 : ADD EAX,0x4
007db45a : PUSH EAX
007db45b : CALL dword ptr [0x00b85118]
007db461 : MOV dword ptr [EBP + -0x4],0x0
007db468 : MOV EAX,dword ptr [EBX + 0x18c]
007db46e : TEST EAX,EAX
007db470 : JBE 0x007db522
007db476 : MOV EAX,dword ptr [EBX + 0x188]
007db47c : MOV ESI,dword ptr [EAX]
007db47e : MOV dword ptr [EBP + -0x1c],EAX
007db481 : MOV dword ptr [EBP + -0x10],ESI
007db484 : CMP ESI,EAX
007db486 : JZ 0x007db522
007db48c : JMP 0x007db493
007db490 : MOV ESI,dword ptr [EBP + -0x10]
007db493 : MOV ECX,dword ptr [ESI + 0x24]
007db496 : MOV EAX,dword ptr [ECX]
007db498 : MOV EDX,dword ptr [EAX + 0x4]
007db49b : CALL EDX
007db49d : CMP EAX,0x2
007db4a0 : JNZ 0x007db514
007db4a2 : MOV EBX,dword ptr [ESI + 0x24]
007db4a5 : MOVZX EAX,word ptr [EBX + 0x1e4]
007db4ac : XOR EDI,EDI
007db4ae : MOV dword ptr [EBP + -0x18],EAX
007db4b1 : TEST EAX,EAX
007db4b3 : JLE 0x007db511
007db4b5 : JMP 0x007db4c0
007db4c0 : MOV EDX,dword ptr [EBX + 0x1d8]
007db4c6 : MOVZX ECX,DI
007db4c9 : MOV ESI,dword ptr [EDX + ECX*0x4]
007db4cc : TEST ESI,ESI
007db4ce : JZ 0x007db509
007db4d0 : LEA EAX,[ESI + 0x48]
007db4d3 : PUSH EAX
007db4d4 : MOV EAX,dword ptr [EBP + 0x8]
007db4d7 : CALL 0x00405ae0
007db4dc : MOV EAX,dword ptr [EBP + 0x8]
007db4df : LEA ECX,[ESI + 0x64]
007db4e2 : PUSH ECX
007db4e3 : CALL 0x00405ae0
007db4e8 : MOV EAX,dword ptr [EBP + 0x8]
007db4eb : LEA EDX,[ESI + 0x80]
007db4f1 : PUSH EDX
007db4f2 : CALL 0x00405ae0
007db4f7 : MOV EAX,dword ptr [EBP + 0x8]
007db4fa : ADD ESI,0x9c
007db500 : PUSH ESI
007db501 : CALL 0x00405ae0
007db506 : MOV EAX,dword ptr [EBP + -0x18]
007db509 : INC EDI
007db50a : CMP EDI,EAX
007db50c : JL 0x007db4c0
007db50e : MOV ESI,dword ptr [EBP + -0x10]
007db511 : MOV EBX,dword ptr [EBP + -0x14]
007db514 : MOV ESI,dword ptr [ESI]
007db516 : MOV dword ptr [EBP + -0x10],ESI
007db519 : CMP ESI,dword ptr [EBP + -0x1c]
007db51c : JNZ 0x007db490
007db522 : MOV EAX,dword ptr [EBX]
007db524 : MOV EDX,dword ptr [EAX + 0x44]
007db527 : MOV ECX,EBX
007db529 : CALL EDX
007db52b : TEST EAX,EAX
007db52d : JZ 0x007db567
007db52f : MOV EAX,dword ptr [EBX + 0x38]
007db532 : MOV EDI,dword ptr [EAX]
007db534 : MOV dword ptr [EBP + -0x1c],EAX
007db537 : CMP EDI,EAX
007db539 : JZ 0x007db567
007db53b : JMP 0x007db540
007db540 : MOV ESI,dword ptr [EDI + 0x24]
007db543 : TEST ESI,ESI
007db545 : JZ 0x007db560
007db547 : MOV EAX,dword ptr [ESI]
007db549 : MOV EDX,dword ptr [EAX + 0x1c]
007db54c : MOV ECX,ESI
007db54e : CALL EDX
007db550 : CMP EAX,0x2
007db553 : JNZ 0x007db560
007db555 : MOV EAX,dword ptr [EBP + 0x8]
007db558 : PUSH EAX
007db559 : MOV ECX,ESI
007db55b : CALL 0x007db420
007db560 : MOV EDI,dword ptr [EDI]
007db562 : CMP EDI,dword ptr [EBP + -0x1c]
007db565 : JNZ 0x007db540
007db567 : MOV dword ptr [EBP + -0x4],0xffffffff
007db56e : MOV EBX,dword ptr [EBX + 0x8]
007db571 : TEST EBX,EBX
007db573 : JZ 0x007db57f
007db575 : ADD EBX,0x4
007db578 : PUSH EBX
007db579 : CALL dword ptr [0x00b8511c]
007db57f : MOV ECX,dword ptr [EBP + -0xc]
007db582 : MOV dword ptr FS:[0x0],ECX
007db589 : POP ECX
007db58a : POP EDI
007db58b : POP ESI
007db58c : POP EBX
007db58d : MOV ESP,EBP
007db58f : POP EBP
007db590 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_00468bb0
ENTRY    : 00468bb0
BODY     : [[00468bb0, 00468c65]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00468bb0(int param_1,char *param_2)

{
  char cVar1;
  char *pcVar2;
  size_t sVar3;
  undefined4 *unaff_ESI;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puStack_c = &LAB_00b72429;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_8 = 0;
  *unaff_ESI = &PTR_FUN_00cd3f48;
  sVar3 = *(size_t *)(param_1 + 4);
  unaff_ESI[1] = sVar3;
  if (*(int *)(param_1 + 4) != 0) {
    _memmove(unaff_ESI + 2,(void *)(param_1 + 8),sVar3);
  }
  *(undefined1 *)(unaff_ESI[1] + 8 + (int)unaff_ESI) = 0;
  local_8 = 0;
  if (param_2 != (char *)0x0) {
    pcVar2 = param_2;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    sVar3 = (int)pcVar2 - (int)(param_2 + 1);
    if (sVar3 != 0) {
      _memmove((void *)(unaff_ESI[1] + 8 + (int)unaff_ESI),param_2,sVar3);
      unaff_ESI[1] = unaff_ESI[1] + sVar3;
      *(undefined1 *)(unaff_ESI[1] + 8 + (int)unaff_ESI) = 0;
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00468bb0 : PUSH EBP
00468bb1 : MOV EBP,ESP
00468bb3 : PUSH -0x1
00468bb5 : PUSH 0xb72429
00468bba : MOV EAX,FS:[0x0]
00468bc0 : PUSH EAX
00468bc1 : SUB ESP,0x8
00468bc4 : PUSH EBX
00468bc5 : PUSH EDI
00468bc6 : MOV EAX,[0x00d66fa0]
00468bcb : XOR EAX,EBP
00468bcd : PUSH EAX
00468bce : LEA EAX,[EBP + -0xc]
00468bd1 : MOV FS:[0x0],EAX
00468bd7 : XOR EDI,EDI
00468bd9 : MOV dword ptr [EBP + -0x4],EDI
00468bdc : MOV EAX,dword ptr [EBP + 0x8]
00468bdf : MOV EBX,dword ptr [EBP + 0xc]
00468be2 : MOV dword ptr [EBP + -0x10],EDI
00468be5 : MOV dword ptr [ESI],0xcd3f48
00468beb : MOV ECX,dword ptr [EAX + 0x4]
00468bee : MOV dword ptr [ESI + 0x4],ECX
00468bf1 : MOV dword ptr [EBP + -0x14],ESI
00468bf4 : CMP dword ptr [EAX + 0x4],EDI
00468bf7 : JBE 0x00468c0c
00468bf9 : MOV EDX,ECX
00468bfb : PUSH EDX
00468bfc : ADD EAX,0x8
00468bff : PUSH EAX
00468c00 : LEA EAX,[ESI + 0x8]
00468c03 : PUSH EAX
00468c04 : CALL 0x00636880
00468c09 : ADD ESP,0xc
00468c0c : MOV ECX,dword ptr [ESI + 0x4]
00468c0f : MOV byte ptr [ECX + ESI*0x1 + 0x8],0x0
00468c14 : MOV dword ptr [EBP + -0x4],EDI
00468c17 : MOV dword ptr [EBP + -0x10],0x1
00468c1e : CMP EBX,EDI
00468c20 : JZ 0x00468c51
00468c22 : MOV EAX,EBX
00468c24 : LEA EDX,[EAX + 0x1]
00468c27 : MOV CL,byte ptr [EAX]
00468c29 : INC EAX
00468c2a : TEST CL,CL
00468c2c : JNZ 0x00468c27
00468c2e : SUB EAX,EDX
00468c30 : MOV EDI,EAX
00468c32 : JZ 0x00468c51
00468c34 : MOV EDX,dword ptr [ESI + 0x4]
00468c37 : PUSH EDI
00468c38 : LEA EAX,[EDX + ESI*0x1 + 0x8]
00468c3c : PUSH EBX
00468c3d : PUSH EAX
00468c3e : CALL 0x00636880
00468c43 : ADD ESP,0xc
00468c46 : ADD dword ptr [ESI + 0x4],EDI
00468c49 : MOV EAX,dword ptr [ESI + 0x4]
00468c4c : MOV byte ptr [EAX + ESI*0x1 + 0x8],0x0
00468c51 : MOV EAX,ESI
00468c53 : MOV ECX,dword ptr [EBP + -0xc]
00468c56 : MOV dword ptr FS:[0x0],ECX
00468c5d : POP ECX
00468c5e : POP EDI
00468c5f : POP EBX
00468c60 : MOV ESP,EBP
00468c62 : POP EBP
00468c63 : RET 0x8

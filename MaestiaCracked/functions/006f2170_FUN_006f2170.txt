PROGRAM  : Maestia.exe
FUNCTION : FUN_006f2170
ENTRY    : 006f2170
BODY     : [[006f2170, 006f2297]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_006f2170(void)

{
  uint uVar1;
  int iVar2;
  undefined4 uVar3;
  char *unaff_ESI;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1030c;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar2 = __stricmp("xor",unaff_ESI);
  if (iVar2 == 0) {
    iVar2 = FUN_006f0760(8,"",0,(DAT_01725270 >> 3 & 1) == 0);
    local_8 = 0;
    if (iVar2 != 0) {
      uVar3 = FUN_00a5d740(iVar2);
      ExceptionList = local_10;
      return uVar3;
    }
  }
  else {
    iVar2 = __stricmp((char *)&PTR_LAB_00bf61f8,unaff_ESI);
    if (iVar2 == 0) {
      iVar2 = FUN_006f0760(8,"",0,(DAT_01725270 >> 3 & 1) == 0);
      local_8 = 1;
      if (iVar2 != 0) {
        uVar3 = FUN_00a5d570(iVar2);
        ExceptionList = local_10;
        return uVar3;
      }
    }
    else {
      iVar2 = __stricmp((char *)&PTR_DAT_00bf61fc,unaff_ESI);
      if (iVar2 == 0) {
        iVar2 = FUN_006f0300(8,uVar1);
        local_8 = 2;
        if (iVar2 != 0) {
          uVar3 = FUN_006f08b0(iVar2);
          ExceptionList = local_10;
          return uVar3;
        }
      }
      else {
        iVar2 = FUN_006f0300(8,uVar1);
        local_8 = 3;
        if (iVar2 != 0) {
          uVar3 = FUN_004f7660(iVar2);
          ExceptionList = local_10;
          return uVar3;
        }
      }
    }
  }
  ExceptionList = local_10;
  return 0;
}



============================================================
DISASSEMBLY
============================================================
006f2170 : PUSH EBP
006f2171 : MOV EBP,ESP
006f2173 : PUSH -0x1
006f2175 : PUSH 0xb1030c
006f217a : MOV EAX,FS:[0x0]
006f2180 : PUSH EAX
006f2181 : PUSH ECX
006f2182 : MOV EAX,[0x00d66fa0]
006f2187 : XOR EAX,EBP
006f2189 : PUSH EAX
006f218a : LEA EAX,[EBP + -0xc]
006f218d : MOV FS:[0x0],EAX
006f2193 : PUSH ESI
006f2194 : PUSH 0xbf61f4
006f2199 : CALL 0x0063b8b9
006f219e : ADD ESP,0x8
006f21a1 : TEST EAX,EAX
006f21a3 : JNZ 0x006f21e7
006f21a5 : MOV EAX,[0x01725270]
006f21aa : SHR EAX,0x3
006f21ad : MOV ECX,0x0
006f21b2 : AND EAX,0x1
006f21b5 : SETZ CL
006f21b8 : PUSH ECX
006f21b9 : PUSH 0x0
006f21bb : PUSH 0xbf1a4a
006f21c0 : PUSH 0x8
006f21c2 : CALL 0x006f0760
006f21c7 : ADD ESP,0x10
006f21ca : MOV dword ptr [EBP + -0x10],EAX
006f21cd : MOV dword ptr [EBP + -0x4],0x0
006f21d4 : TEST EAX,EAX
006f21d6 : JZ 0x006f2280
006f21dc : PUSH EAX
006f21dd : CALL 0x00a5d740
006f21e2 : JMP 0x006f2282
006f21e7 : PUSH ESI
006f21e8 : PUSH 0xbf61f8
006f21ed : CALL 0x0063b8b9
006f21f2 : ADD ESP,0x8
006f21f5 : TEST EAX,EAX
006f21f7 : JNZ 0x006f2230
006f21f9 : MOV EDX,dword ptr [0x01725270]
006f21ff : SHR EDX,0x3
006f2202 : AND EDX,0x1
006f2205 : SETZ AL
006f2208 : PUSH EAX
006f2209 : PUSH 0x0
006f220b : PUSH 0xbf1a4a
006f2210 : PUSH 0x8
006f2212 : CALL 0x006f0760
006f2217 : ADD ESP,0x10
006f221a : MOV dword ptr [EBP + -0x10],EAX
006f221d : MOV dword ptr [EBP + -0x4],0x1
006f2224 : TEST EAX,EAX
006f2226 : JZ 0x006f2280
006f2228 : PUSH EAX
006f2229 : CALL 0x00a5d570
006f222e : JMP 0x006f2282
006f2230 : PUSH ESI
006f2231 : PUSH 0xbf61fc
006f2236 : CALL 0x0063b8b9
006f223b : ADD ESP,0x8
006f223e : PUSH 0x8
006f2240 : TEST EAX,EAX
006f2242 : JNZ 0x006f2262
006f2244 : CALL 0x006f0300
006f2249 : ADD ESP,0x4
006f224c : MOV dword ptr [EBP + -0x10],EAX
006f224f : MOV dword ptr [EBP + -0x4],0x2
006f2256 : TEST EAX,EAX
006f2258 : JZ 0x006f2280
006f225a : PUSH EAX
006f225b : CALL 0x006f08b0
006f2260 : JMP 0x006f2282
006f2262 : CALL 0x006f0300
006f2267 : ADD ESP,0x4
006f226a : MOV dword ptr [EBP + -0x10],EAX
006f226d : MOV dword ptr [EBP + -0x4],0x3
006f2274 : TEST EAX,EAX
006f2276 : JZ 0x006f2280
006f2278 : PUSH EAX
006f2279 : CALL 0x004f7660
006f227e : JMP 0x006f2282
006f2280 : XOR EAX,EAX
006f2282 : MOV dword ptr [EBP + -0x4],0xffffffff
006f2289 : MOV ECX,dword ptr [EBP + -0xc]
006f228c : MOV dword ptr FS:[0x0],ECX
006f2293 : POP ECX
006f2294 : MOV ESP,EBP
006f2296 : POP EBP
006f2297 : RET

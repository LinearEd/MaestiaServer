PROGRAM  : Maestia.exe
FUNCTION : FUN_006e4fe0
ENTRY    : 006e4fe0
BODY     : [[006e4fe0, 006e5146]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006e4fe0(int *param_1,int param_2,int *param_3,int param_4)

{
  int iVar1;
  int iVar2;
  undefined1 *puVar3;
  int iVar4;
  int iVar5;
  byte *pbVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int local_2c;
  int *local_28;
  int local_24;
  int local_20;
  int local_10;
  
  iVar4 = *(int *)((int)param_1 + 0xd8) / *(int *)(param_2 + 8);
  iVar2 = *(int *)(param_2 + 0x1c);
  iVar5 = *(int *)((int)param_1 + 0xdc) / *(int *)(param_2 + 0xc);
  FUN_006e4f00(param_3,*(undefined4 *)((int)param_1 + 0xdc));
  local_10 = 0;
  if (0 < *(int *)(param_2 + 0xc)) {
    local_28 = param_3;
    do {
      local_2c = 0;
      puVar3 = *(undefined1 **)(param_4 + local_10 * 4);
      for (iVar1 = iVar2 * 8; iVar1 != 0; iVar1 = iVar1 + -1) {
        iVar7 = 0;
        local_24 = 0;
        if (0 < iVar5) {
          param_1 = local_28;
          local_20 = iVar5;
          do {
            pbVar6 = (byte *)(*param_1 + local_2c);
            iVar9 = 0;
            iVar10 = 0;
            iVar7 = 0;
            if (1 < iVar4) {
              iVar8 = (iVar4 - 2U >> 1) + 1;
              iVar7 = iVar8 * 2;
              do {
                iVar9 = iVar9 + (uint)*pbVar6;
                iVar10 = iVar10 + (uint)pbVar6[1];
                pbVar6 = pbVar6 + 2;
                iVar8 = iVar8 + -1;
              } while (iVar8 != 0);
            }
            if (iVar7 < iVar4) {
              local_24 = local_24 + (uint)*pbVar6;
            }
            param_1 = param_1 + 1;
            iVar7 = local_24 + iVar10 + iVar9;
            local_20 = local_20 + -1;
            local_24 = iVar7;
          } while (local_20 != 0);
        }
        local_2c = local_2c + iVar4;
        *puVar3 = (char)((iVar7 + (iVar5 * iVar4) / 2) / (iVar5 * iVar4));
        puVar3 = puVar3 + 1;
      }
      local_28 = local_28 + iVar5;
      local_10 = local_10 + 1;
    } while (local_10 < *(int *)(param_2 + 0xc));
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
006e4fe0 : SUB ESP,0x2c
006e4fe3 : PUSH EBX
006e4fe4 : MOV EBX,dword ptr [ESP + 0x34]
006e4fe8 : MOV EAX,dword ptr [EBX + 0xd8]
006e4fee : CDQ
006e4fef : PUSH EBP
006e4ff0 : PUSH ESI
006e4ff1 : MOV ESI,dword ptr [ESP + 0x40]
006e4ff5 : IDIV dword ptr [ESI + 0x8]
006e4ff8 : MOV ECX,dword ptr [ESI + 0x1c]
006e4ffb : ADD ECX,ECX
006e4ffd : PUSH EDI
006e4ffe : ADD ECX,ECX
006e5000 : ADD ECX,ECX
006e5002 : MOV dword ptr [ESP + 0x30],ECX
006e5006 : MOV EBP,EAX
006e5008 : MOV EAX,dword ptr [EBX + 0xdc]
006e500e : CDQ
006e500f : IDIV dword ptr [ESI + 0xc]
006e5012 : MOV ESI,EAX
006e5014 : IMUL ESI,EBP
006e5017 : MOV dword ptr [ESP + 0x28],EAX
006e501b : MOV EAX,ESI
006e501d : CDQ
006e501e : SUB EAX,EDX
006e5020 : MOV EDI,EAX
006e5022 : MOV EAX,EBP
006e5024 : IMUL EAX,ECX
006e5027 : MOV ECX,dword ptr [EBX + 0xdc]
006e502d : MOV EBX,dword ptr [EBX + 0x1c]
006e5030 : PUSH ECX
006e5031 : MOV ECX,dword ptr [ESP + 0x4c]
006e5035 : SAR EDI,0x1
006e5037 : PUSH ECX
006e5038 : MOV dword ptr [ESP + 0x3c],ESI
006e503c : MOV dword ptr [ESP + 0x40],EDI
006e5040 : CALL 0x006e4f00
006e5045 : MOV EDX,dword ptr [ESP + 0x4c]
006e5049 : XOR ECX,ECX
006e504b : ADD ESP,0x8
006e504e : CMP dword ptr [EDX + 0xc],ECX
006e5051 : MOV dword ptr [ESP + 0x2c],ECX
006e5055 : JLE 0x006e513f
006e505b : MOV EAX,dword ptr [ESP + 0x48]
006e505f : MOV dword ptr [ESP + 0x14],EAX
006e5063 : MOV EDX,dword ptr [ESP + 0x4c]
006e5067 : MOV EAX,dword ptr [EDX + ECX*0x4]
006e506a : MOV dword ptr [ESP + 0x20],EAX
006e506e : MOV EAX,dword ptr [ESP + 0x30]
006e5072 : MOV dword ptr [ESP + 0x10],0x0
006e507a : TEST EAX,EAX
006e507c : JBE 0x006e5121
006e5082 : MOV dword ptr [ESP + 0x24],EAX
006e5086 : MOV EAX,dword ptr [ESP + 0x28]
006e508a : XOR ECX,ECX
006e508c : MOV dword ptr [ESP + 0x18],ECX
006e5090 : TEST EAX,EAX
006e5092 : JLE 0x006e50fc
006e5094 : MOV EDX,dword ptr [ESP + 0x14]
006e5098 : MOV dword ptr [ESP + 0x40],EDX
006e509c : MOV dword ptr [ESP + 0x1c],EAX
006e50a0 : MOV EAX,dword ptr [ESP + 0x40]
006e50a4 : MOV EAX,dword ptr [EAX]
006e50a6 : ADD EAX,dword ptr [ESP + 0x10]
006e50aa : XOR EDX,EDX
006e50ac : XOR ESI,ESI
006e50ae : XOR EDI,EDI
006e50b0 : CMP EBP,0x2
006e50b3 : JL 0x006e50d7
006e50b5 : LEA ECX,[EBP + -0x2]
006e50b8 : SHR ECX,0x1
006e50ba : INC ECX
006e50bb : LEA EDI,[ECX + ECX*0x1]
006e50be : MOV EDI,EDI
006e50c0 : MOVZX EBX,byte ptr [EAX]
006e50c3 : ADD EDX,EBX
006e50c5 : MOVZX EBX,byte ptr [EAX + 0x1]
006e50c9 : ADD ESI,EBX
006e50cb : ADD EAX,0x2
006e50ce : SUB ECX,0x1
006e50d1 : JNZ 0x006e50c0
006e50d3 : MOV ECX,dword ptr [ESP + 0x18]
006e50d7 : CMP EDI,EBP
006e50d9 : JGE 0x006e50e0
006e50db : MOVZX EAX,byte ptr [EAX]
006e50de : ADD ECX,EAX
006e50e0 : ADD dword ptr [ESP + 0x40],0x4
006e50e5 : ADD ESI,EDX
006e50e7 : ADD ECX,ESI
006e50e9 : SUB dword ptr [ESP + 0x1c],0x1
006e50ee : MOV dword ptr [ESP + 0x18],ECX
006e50f2 : JNZ 0x006e50a0
006e50f4 : MOV ESI,dword ptr [ESP + 0x34]
006e50f8 : MOV EDI,dword ptr [ESP + 0x38]
006e50fc : LEA EAX,[ECX + EDI*0x1]
006e50ff : CDQ
006e5100 : IDIV ESI
006e5102 : MOV ECX,dword ptr [ESP + 0x20]
006e5106 : ADD dword ptr [ESP + 0x10],EBP
006e510a : INC ECX
006e510b : SUB dword ptr [ESP + 0x24],0x1
006e5110 : MOV dword ptr [ESP + 0x20],ECX
006e5114 : MOV byte ptr [ECX + -0x1],AL
006e5117 : JNZ 0x006e5086
006e511d : MOV ECX,dword ptr [ESP + 0x2c]
006e5121 : MOV EAX,dword ptr [ESP + 0x28]
006e5125 : MOV EDX,dword ptr [ESP + 0x44]
006e5129 : ADD EAX,EAX
006e512b : ADD EAX,EAX
006e512d : ADD dword ptr [ESP + 0x14],EAX
006e5131 : INC ECX
006e5132 : CMP ECX,dword ptr [EDX + 0xc]
006e5135 : MOV dword ptr [ESP + 0x2c],ECX
006e5139 : JL 0x006e5063
006e513f : POP EDI
006e5140 : POP ESI
006e5141 : POP EBP
006e5142 : POP EBX
006e5143 : ADD ESP,0x2c
006e5146 : RET

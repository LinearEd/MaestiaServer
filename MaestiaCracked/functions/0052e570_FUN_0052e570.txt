PROGRAM  : Maestia.exe
FUNCTION : FUN_0052e570
ENTRY    : 0052e570
BODY     : [[0052e570, 0052e699]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0052e570(int param_1,char *param_2)

{
  char cVar1;
  char *pcVar2;
  int iVar3;
  int *piVar4;
  undefined1 *puStack_124;
  char *local_118;
  int local_114;
  undefined4 local_110;
  char *local_10c;
  undefined4 local_108;
  char local_104 [244];
  uint uStack_10;
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)&local_118;
  iVar3 = *(int *)(param_1 + 0xa0);
  if (iVar3 == 0) {
    puStack_124 = (undefined1 *)0x52e657;
    iVar3 = (**(code **)(**(int **)(param_1 + 0x74) + 0x94))();
    if (iVar3 == 0) goto LAB_0052e683;
    puStack_124 = (undefined1 *)0x52e668;
    piVar4 = (int *)(**(code **)(**(int **)(param_1 + 0x74) + 0x94))();
    iVar3 = *piVar4;
  }
  else {
    if (*(int *)(iVar3 + 4) == 0) goto LAB_0052e683;
    if (*(char *)(iVar3 + 10) == '\0') {
      puStack_124 = &stack0x0000000c;
      (**(code **)(**(int **)(iVar3 + 4) + 4))(0x21,param_2);
      __security_check_cookie(uStack_10 ^ (uint)&puStack_124);
      return;
    }
    pcVar2 = param_2;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    local_114 = (int)pcVar2 - (int)(param_2 + 1);
    if (param_2[local_114 + -1] == '\n') {
      local_114 = local_114 + -1;
    }
    local_118 = param_2;
    puStack_124 = (undefined1 *)(iVar3 + 0xc);
    local_10c = local_104;
    local_110 = 2;
    local_108 = 0x100;
    FUN_0052bbc0(&local_110,"{0} : {1}\n",&local_118);
    iVar3 = **(int **)(iVar3 + 4);
    param_2 = local_104;
  }
  puStack_124 = &stack0x0000000c;
  (**(code **)(iVar3 + 4))(0x21,param_2);
LAB_0052e683:
  __security_check_cookie(local_4 ^ (uint)&local_118);
  return;
}



============================================================
DISASSEMBLY
============================================================
0052e570 : SUB ESP,0x118
0052e576 : MOV EAX,[0x00d66fa0]
0052e57b : XOR EAX,ESP
0052e57d : MOV dword ptr [ESP + 0x114],EAX
0052e584 : PUSH ESI
0052e585 : PUSH EDI
0052e586 : MOV EDI,dword ptr [ESP + 0x124]
0052e58d : MOV ESI,dword ptr [EDI + 0xa0]
0052e593 : TEST ESI,ESI
0052e595 : JZ 0x0052e64a
0052e59b : CMP dword ptr [ESI + 0x4],0x0
0052e59f : JZ 0x0052e683
0052e5a5 : CMP byte ptr [ESI + 0xa],0x0
0052e5a9 : JZ 0x0052e617
0052e5ab : MOV EDX,dword ptr [ESP + 0x128]
0052e5b2 : MOV EAX,EDX
0052e5b4 : LEA EDI,[EAX + 0x1]
0052e5b7 : MOV CL,byte ptr [EAX]
0052e5b9 : INC EAX
0052e5ba : TEST CL,CL
0052e5bc : JNZ 0x0052e5b7
0052e5be : SUB EAX,EDI
0052e5c0 : CMP byte ptr [EAX + EDX*0x1 + -0x1],0xa
0052e5c5 : JNZ 0x0052e5c8
0052e5c7 : DEC EAX
0052e5c8 : MOV dword ptr [ESP + 0x8],EDX
0052e5cc : LEA EDX,[ESI + 0xc]
0052e5cf : PUSH EDX
0052e5d0 : MOV dword ptr [ESP + 0x10],EAX
0052e5d4 : LEA EAX,[ESP + 0xc]
0052e5d8 : LEA ECX,[ESP + 0x20]
0052e5dc : PUSH EAX
0052e5dd : MOV dword ptr [ESP + 0x1c],ECX
0052e5e1 : LEA ECX,[ESP + 0x18]
0052e5e5 : PUSH 0xb8b328
0052e5ea : PUSH ECX
0052e5eb : MOV dword ptr [ESP + 0x20],0x2
0052e5f3 : MOV dword ptr [ESP + 0x28],0x100
0052e5fb : CALL 0x0052bbc0
0052e600 : MOV ECX,dword ptr [ESI + 0x4]
0052e603 : MOV EDX,dword ptr [ECX]
0052e605 : ADD ESP,0x10
0052e608 : LEA EAX,[ESP + 0x12c]
0052e60f : PUSH EAX
0052e610 : LEA EAX,[ESP + 0x20]
0052e614 : PUSH EAX
0052e615 : JMP 0x0052e67c
0052e617 : MOV ECX,dword ptr [ESI + 0x4]
0052e61a : MOV EAX,dword ptr [ECX]
0052e61c : MOV EAX,dword ptr [EAX + 0x4]
0052e61f : LEA EDX,[ESP + 0x12c]
0052e626 : PUSH EDX
0052e627 : MOV EDX,dword ptr [ESP + 0x12c]
0052e62e : PUSH EDX
0052e62f : PUSH 0x21
0052e631 : CALL EAX
0052e633 : POP EDI
0052e634 : POP ESI
0052e635 : MOV ECX,dword ptr [ESP + 0x114]
0052e63c : XOR ECX,ESP
0052e63e : CALL 0x00633e6b
0052e643 : ADD ESP,0x118
0052e649 : RET
0052e64a : MOV ECX,dword ptr [EDI + 0x74]
0052e64d : MOV EDX,dword ptr [ECX]
0052e64f : MOV EAX,dword ptr [EDX + 0x94]
0052e655 : CALL EAX
0052e657 : TEST EAX,EAX
0052e659 : JZ 0x0052e683
0052e65b : MOV ECX,dword ptr [EDI + 0x74]
0052e65e : MOV EDX,dword ptr [ECX]
0052e660 : MOV EAX,dword ptr [EDX + 0x94]
0052e666 : CALL EAX
0052e668 : MOV EDX,dword ptr [EAX]
0052e66a : LEA ECX,[ESP + 0x12c]
0052e671 : PUSH ECX
0052e672 : MOV ECX,dword ptr [ESP + 0x12c]
0052e679 : PUSH ECX
0052e67a : MOV ECX,EAX
0052e67c : MOV EDX,dword ptr [EDX + 0x4]
0052e67f : PUSH 0x21
0052e681 : CALL EDX
0052e683 : MOV ECX,dword ptr [ESP + 0x11c]
0052e68a : POP EDI
0052e68b : POP ESI
0052e68c : XOR ECX,ESP
0052e68e : CALL 0x00633e6b
0052e693 : ADD ESP,0x118
0052e699 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00853ee0
ENTRY    : 00853ee0
BODY     : [[00853ee0, 008541b2]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00853ee0(void)

{
  char cVar1;
  int *piVar2;
  int iVar3;
  int in_ECX;
  undefined1 auStack_3c [4];
  undefined1 local_38;
  undefined1 local_37;
  undefined4 local_34;
  undefined4 local_30;
  undefined2 local_2c;
  undefined1 local_2a;
  undefined4 local_28;
  undefined1 local_24;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_00b62cd7;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_3c;
  ExceptionList = &local_14;
  if (*(char *)(in_ECX + 0x65d) == '\0') {
    local_34 = 0;
    local_30 = 0;
    local_2c = 0;
    local_24 = 0;
    local_38 = 0;
    local_2a = 1;
    local_28 = 1;
    local_37 = 0x28;
    FUN_0041dea0(&local_38);
  }
  else if (*(char *)(*(int *)(in_ECX + 0x18a8) + 0x20) != '\0') {
    (**(code **)(*(int *)(*(int *)(*(int *)(in_ECX + 0x138) + 4) + 0x138 + in_ECX) + 0x10))
              (in_ECX + 0x1d38,1,1,1,DAT_00d66fa0 ^ (uint)&stack0xffffffb8);
    piVar2 = (int *)FUN_004049b0(*(undefined4 *)(*(int *)(in_ECX + 0x18a8) + 0x28));
    if (piVar2 != (int *)0x0) {
      iVar3 = (**(code **)(*piVar2 + 0x38))();
      if (iVar3 != 0) {
        FUN_00404350(piVar2 + 0x31);
        local_1c = 0;
        cVar1 = FUN_004049e0();
        if (cVar1 != '\0') {
          FUN_008980b0(&stack0xffffffb8,1);
        }
        FUN_0088e570(0x12);
        local_1c = 0xffffffff;
        FUN_00406560();
      }
    }
    FUN_0085bfe0(in_ECX,1);
    FUN_0085c1c0();
    FUN_0083bb00(0);
    FUN_0083ba10();
    (**(code **)(*(int *)(*(int *)(*(int *)(in_ECX + 0x138) + 4) + 0x138 + in_ECX) + 0x10))
              (in_ECX + 0x6d8,1,0,1);
    *(undefined4 *)(in_ECX + 0x19ec) = 0;
    *(undefined4 *)(in_ECX + 0x1a68) = 0;
    FUN_00856310(&DAT_00d720f0);
    if (*(char *)(in_ECX + 0x4d4) != '\0') {
      FUN_0084c320(1);
      iVar3 = *(int *)(in_ECX + 0x17f0);
      *(undefined1 *)(iVar3 + 0x1a8) = 0;
      if (*(int **)(iVar3 + 0x168) != (int *)0x0) {
        (**(code **)(**(int **)(iVar3 + 0x168) + 0x10))(0);
      }
      if (*(int **)(iVar3 + 0x16c) != (int *)0x0) {
        (**(code **)(**(int **)(iVar3 + 0x16c) + 0x10))(0);
      }
      FUN_0084c320(1);
      iVar3 = *(int *)(in_ECX + 0x1870);
      *(undefined1 *)(iVar3 + 0x1a8) = 0;
      if (*(int **)(iVar3 + 0x168) != (int *)0x0) {
        (**(code **)(**(int **)(iVar3 + 0x168) + 0x10))(0);
      }
      if (*(int **)(iVar3 + 0x16c) != (int *)0x0) {
        (**(code **)(**(int **)(iVar3 + 0x16c) + 0x10))(0);
      }
      FUN_0084c320(1);
      *(undefined1 *)(in_ECX + 0x198c) = 1;
      *(undefined1 *)(in_ECX + 0x4d4) = 0;
    }
  }
  iVar3 = *(int *)(in_ECX + 0x17f0);
  *(undefined1 *)(iVar3 + 0x1a8) = 1;
  if (*(int **)(iVar3 + 0x168) != (int *)0x0) {
    (**(code **)(**(int **)(iVar3 + 0x168) + 0x10))(1);
  }
  if (*(int **)(iVar3 + 0x16c) != (int *)0x0) {
    (**(code **)(**(int **)(iVar3 + 0x16c) + 0x10))(1);
  }
  iVar3 = *(int *)(in_ECX + 0x1870);
  *(undefined1 *)(iVar3 + 0x1a8) = 1;
  if (*(int **)(iVar3 + 0x168) != (int *)0x0) {
    (**(code **)(**(int **)(iVar3 + 0x168) + 0x10))(1);
  }
  if (*(int **)(iVar3 + 0x16c) != (int *)0x0) {
    (**(code **)(**(int **)(iVar3 + 0x16c) + 0x10))(1);
  }
  FUN_00884ec0();
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_3c);
  return;
}



============================================================
DISASSEMBLY
============================================================
00853ee0 : PUSH EBP
00853ee1 : MOV EBP,ESP
00853ee3 : AND ESP,0xfffffff8
00853ee6 : PUSH -0x1
00853ee8 : PUSH 0xb62cd7
00853eed : MOV EAX,FS:[0x0]
00853ef3 : PUSH EAX
00853ef4 : SUB ESP,0x28
00853ef7 : MOV EAX,[0x00d66fa0]
00853efc : XOR EAX,ESP
00853efe : MOV dword ptr [ESP + 0x20],EAX
00853f02 : PUSH EBX
00853f03 : PUSH ESI
00853f04 : PUSH EDI
00853f05 : MOV EAX,[0x00d66fa0]
00853f0a : XOR EAX,ESP
00853f0c : PUSH EAX
00853f0d : LEA EAX,[ESP + 0x38]
00853f11 : MOV FS:[0x0],EAX
00853f17 : MOV EBX,ECX
00853f19 : CMP byte ptr [EBX + 0x65d],0x0
00853f20 : JNZ 0x00853f60
00853f22 : XOR EAX,EAX
00853f24 : LEA ECX,[ESP + 0x14]
00853f28 : MOV dword ptr [ESP + 0x18],EAX
00853f2c : MOV dword ptr [ESP + 0x1c],EAX
00853f30 : MOV word ptr [ESP + 0x20],AX
00853f35 : MOV byte ptr [ESP + 0x28],AL
00853f39 : MOV byte ptr [ESP + 0x14],AL
00853f3d : PUSH ECX
00853f3e : LEA EAX,[EBX + 0x19a4]
00853f44 : MOV byte ptr [ESP + 0x26],0x1
00853f49 : MOV dword ptr [ESP + 0x28],0x1
00853f51 : MOV byte ptr [ESP + 0x19],0x28
00853f56 : CALL 0x0041dea0
00853f5b : JMP 0x00854128
00853f60 : MOV EDX,dword ptr [EBX + 0x18a8]
00853f66 : CMP byte ptr [EDX + 0x20],0x0
00853f6a : JZ 0x00854128
00853f70 : MOV EAX,dword ptr [EBX + 0x138]
00853f76 : MOV ECX,dword ptr [EAX + 0x4]
00853f79 : MOV EDX,dword ptr [ECX + EBX*0x1 + 0x138]
00853f80 : MOV EDX,dword ptr [EDX + 0x10]
00853f83 : PUSH 0x1
00853f85 : PUSH 0x1
00853f87 : LEA ECX,[ECX + EBX*0x1 + 0x138]
00853f8e : PUSH 0x1
00853f90 : LEA EAX,[EBX + 0x1d38]
00853f96 : PUSH EAX
00853f97 : CALL EDX
00853f99 : MOV EAX,dword ptr [EBX + 0x18a8]
00853f9f : MOV EAX,dword ptr [EAX + 0x28]
00853fa2 : PUSH EAX
00853fa3 : CALL 0x004049b0
00853fa8 : MOV ESI,EAX
00853faa : XOR EDI,EDI
00853fac : ADD ESP,0x4
00853faf : CMP ESI,EDI
00853fb1 : JZ 0x00854011
00853fb3 : MOV EDX,dword ptr [ESI]
00853fb5 : MOV EAX,dword ptr [EDX + 0x38]
00853fb8 : MOV ECX,ESI
00853fba : CALL EAX
00853fbc : TEST EAX,EAX
00853fbe : JZ 0x00854011
00853fc0 : ADD ESI,0xc4
00853fc6 : PUSH ESI
00853fc7 : LEA ESI,[ESP + 0x18]
00853fcb : CALL 0x00404350
00853fd0 : ADD ESP,0x4
00853fd3 : MOV dword ptr [ESP + 0x40],EDI
00853fd7 : MOV ESI,0xc3f4c8
00853fdc : LEA ECX,[ESP + 0x14]
00853fe0 : CALL 0x004049e0
00853fe5 : TEST AL,AL
00853fe7 : JZ 0x00853ff7
00853fe9 : PUSH 0x1
00853feb : LEA ECX,[ESP + 0x18]
00853fef : PUSH ECX
00853ff0 : MOV ESI,EBX
00853ff2 : CALL 0x008980b0
00853ff7 : PUSH 0x12
00853ff9 : MOV ECX,EBX
00853ffb : CALL 0x0088e570
00854000 : MOV dword ptr [ESP + 0x40],0xffffffff
00854008 : LEA ECX,[ESP + 0x14]
0085400c : CALL 0x00406560
00854011 : PUSH 0x1
00854013 : PUSH EBX
00854014 : CALL 0x0085bfe0
00854019 : MOV ECX,EBX
0085401b : CALL 0x0085c1c0
00854020 : MOV ECX,dword ptr [EBX + 0x18a8]
00854026 : PUSH EDI
00854027 : XOR AL,AL
00854029 : CALL 0x0083bb00
0085402e : MOV ESI,dword ptr [EBX + 0x18a8]
00854034 : CALL 0x0083ba10
00854039 : MOV EDX,dword ptr [EBX + 0x138]
0085403f : MOV EAX,dword ptr [EDX + 0x4]
00854042 : MOV EDX,dword ptr [EAX + EBX*0x1 + 0x138]
00854049 : MOV EDX,dword ptr [EDX + 0x10]
0085404c : PUSH 0x1
0085404e : LEA ECX,[EAX + EBX*0x1 + 0x138]
00854055 : PUSH EDI
00854056 : PUSH 0x1
00854058 : LEA EAX,[EBX + 0x6d8]
0085405e : PUSH EAX
0085405f : CALL EDX
00854061 : XORPS XMM0,XMM0
00854064 : PUSH 0xd720f0
00854069 : MOV ESI,EBX
0085406b : MOV dword ptr [EBX + 0x19ec],EDI
00854071 : MOVSS dword ptr [EBX + 0x1a68],XMM0
00854079 : CALL 0x00856310
0085407e : CMP byte ptr [EBX + 0x4d4],0x0
00854085 : JZ 0x00854128
0085408b : MOV EDI,dword ptr [EBX + 0x17f0]
00854091 : PUSH 0x1
00854093 : CALL 0x0084c320
00854098 : MOV ESI,dword ptr [EBX + 0x17f0]
0085409e : MOV ECX,dword ptr [ESI + 0x168]
008540a4 : MOV byte ptr [ESI + 0x1a8],0x0
008540ab : TEST ECX,ECX
008540ad : JZ 0x008540b8
008540af : MOV EAX,dword ptr [ECX]
008540b1 : MOV EDX,dword ptr [EAX + 0x10]
008540b4 : PUSH 0x0
008540b6 : CALL EDX
008540b8 : MOV ECX,dword ptr [ESI + 0x16c]
008540be : TEST ECX,ECX
008540c0 : JZ 0x008540cb
008540c2 : MOV EAX,dword ptr [ECX]
008540c4 : MOV EDX,dword ptr [EAX + 0x10]
008540c7 : PUSH 0x0
008540c9 : CALL EDX
008540cb : MOV EDI,dword ptr [EBX + 0x1870]
008540d1 : PUSH 0x1
008540d3 : CALL 0x0084c320
008540d8 : MOV ESI,dword ptr [EBX + 0x1870]
008540de : MOV ECX,dword ptr [ESI + 0x168]
008540e4 : MOV byte ptr [ESI + 0x1a8],0x0
008540eb : TEST ECX,ECX
008540ed : JZ 0x008540f8
008540ef : MOV EAX,dword ptr [ECX]
008540f1 : MOV EDX,dword ptr [EAX + 0x10]
008540f4 : PUSH 0x0
008540f6 : CALL EDX
008540f8 : MOV ESI,dword ptr [ESI + 0x16c]
008540fe : TEST ESI,ESI
00854100 : JZ 0x0085410d
00854102 : MOV EAX,dword ptr [ESI]
00854104 : MOV EDX,dword ptr [EAX + 0x10]
00854107 : PUSH 0x0
00854109 : MOV ECX,ESI
0085410b : CALL EDX
0085410d : MOV EDI,dword ptr [EBX + 0x17f4]
00854113 : PUSH 0x1
00854115 : CALL 0x0084c320
0085411a : MOV byte ptr [EBX + 0x198c],0x1
00854121 : MOV byte ptr [EBX + 0x4d4],0x0
00854128 : MOV ESI,dword ptr [EBX + 0x17f0]
0085412e : MOV ECX,dword ptr [ESI + 0x168]
00854134 : MOV byte ptr [ESI + 0x1a8],0x1
0085413b : TEST ECX,ECX
0085413d : JZ 0x00854148
0085413f : MOV EAX,dword ptr [ECX]
00854141 : MOV EDX,dword ptr [EAX + 0x10]
00854144 : PUSH 0x1
00854146 : CALL EDX
00854148 : MOV ECX,dword ptr [ESI + 0x16c]
0085414e : TEST ECX,ECX
00854150 : JZ 0x0085415b
00854152 : MOV EAX,dword ptr [ECX]
00854154 : MOV EDX,dword ptr [EAX + 0x10]
00854157 : PUSH 0x1
00854159 : CALL EDX
0085415b : MOV ESI,dword ptr [EBX + 0x1870]
00854161 : MOV ECX,dword ptr [ESI + 0x168]
00854167 : MOV byte ptr [ESI + 0x1a8],0x1
0085416e : TEST ECX,ECX
00854170 : JZ 0x0085417b
00854172 : MOV EAX,dword ptr [ECX]
00854174 : MOV EDX,dword ptr [EAX + 0x10]
00854177 : PUSH 0x1
00854179 : CALL EDX
0085417b : MOV ECX,dword ptr [ESI + 0x16c]
00854181 : TEST ECX,ECX
00854183 : JZ 0x0085418e
00854185 : MOV EAX,dword ptr [ECX]
00854187 : MOV EDX,dword ptr [EAX + 0x10]
0085418a : PUSH 0x1
0085418c : CALL EDX
0085418e : MOV ECX,EBX
00854190 : CALL 0x00884ec0
00854195 : MOV ECX,dword ptr [ESP + 0x38]
00854199 : MOV dword ptr FS:[0x0],ECX
008541a0 : POP ECX
008541a1 : POP EDI
008541a2 : POP ESI
008541a3 : POP EBX
008541a4 : MOV ECX,dword ptr [ESP + 0x20]
008541a8 : XOR ECX,ESP
008541aa : CALL 0x00633e6b
008541af : MOV ESP,EBP
008541b1 : POP EBP
008541b2 : RET

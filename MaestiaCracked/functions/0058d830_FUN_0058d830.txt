PROGRAM  : Maestia.exe
FUNCTION : FUN_0058d830
ENTRY    : 0058d830
BODY     : [[0058d830, 0058dc03]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0058d830(int param_1)

{
  undefined1 *puVar1;
  char cVar2;
  undefined1 uVar3;
  char *pcVar4;
  int iVar5;
  GMatrix2D *pGVar6;
  int unaff_ESI;
  int *piVar7;
  byte bVar8;
  float10 fVar9;
  float10 fVar10;
  undefined4 uVar11;
  float fStack_78;
  float fStack_74;
  float fStack_70;
  float fStack_6c;
  float fStack_68;
  float fStack_64;
  GRect<float> aGStack_60 [8];
  float fStack_58;
  float fStack_54;
  float local_50;
  float fStack_4c;
  float fStack_48;
  float fStack_44;
  GMatrix2D aGStack_38 [8];
  GMatrix2D local_30 [8];
  undefined1 auStack_28 [8];
  GMatrix2D aGStack_20 [32];
  
  if (*(int **)(param_1 + 8) == (int *)0x0) {
    piVar7 = *(int **)(*(int *)(param_1 + 0x18) + 0x74);
  }
  else {
    iVar5 = (**(code **)(**(int **)(param_1 + 8) + 8))();
    if (iVar5 != 2) {
      return;
    }
    if (*(int *)(param_1 + 8) == 0) {
      return;
    }
    piVar7 = (int *)(*(int *)(param_1 + 8) + -0x68);
  }
  if (piVar7 != (int *)0x0) {
    puVar1 = *(undefined1 **)(param_1 + 4);
    FUN_00526400();
    *puVar1 = 2;
    puVar1[4] = 0;
    GMatrix2D::SetIdentity(local_30);
    (**(code **)(*piVar7 + 0x28))(&local_50,local_30);
    if ((fStack_58 != local_50) || (fStack_54 != fStack_4c)) {
      if (*(int *)(param_1 + 0x1c) < 2) {
        if (*(int *)(param_1 + 0x1c) == 1) {
          pcVar4 = (char *)FUN_00526260(0);
          piVar7 = (int *)0x0;
          if (*pcVar4 == '\a') {
            iVar5 = FUN_00525fa0(*(undefined4 *)(param_1 + 0x18));
            if (iVar5 == 0) {
              return;
            }
            piVar7 = (int *)FUN_0054ed10();
          }
          else {
            FUN_005272e0(&stack0xffffff7c,*(undefined4 *)(param_1 + 0x18),0xffffffff,0);
            aGStack_38[0] = (GMatrix2D)0x0;
            cVar2 = FUN_005331f0(&stack0xffffff7c,aGStack_38,0,0,0,0);
            if (cVar2 != '\0') {
              iVar5 = FUN_00525fa0(*(undefined4 *)(param_1 + 0x18));
              if (iVar5 == 0) {
                piVar7 = (int *)0x0;
              }
              else {
                piVar7 = (int *)FUN_0054ed10();
              }
            }
            FUN_00526bc0();
            *(int *)(unaff_ESI + 8) = *(int *)(unaff_ESI + 8) + -1;
            if (*(int *)(unaff_ESI + 8) == 0) {
              FUN_00525340();
            }
          }
          if (piVar7 != (int *)0x0) {
            GMatrix2D::SetIdentity(aGStack_20);
            (**(code **)(*piVar7 + 0x28))(&fStack_48,aGStack_20);
            if ((local_50 != fStack_48) || (fStack_4c != fStack_44)) {
              pGVar6 = (GMatrix2D *)FUN_0050aa60(auStack_28);
              fStack_70 = 0.0;
              fStack_6c = 0.0;
              fStack_68 = 0.0;
              fStack_64 = 0.0;
              GMatrix2D::EncloseTransform(pGVar6,(GRect<float> *)&fStack_70,aGStack_60);
              pGVar6 = (GMatrix2D *)FUN_0050aa60(auStack_28);
              fStack_78 = 0.0;
              fStack_74 = 0.0;
              GMatrix2D::EncloseTransform
                        (pGVar6,(GRect<float> *)&stack0xffffff80,(GRect<float> *)&local_50);
              if (((0.0 < fStack_64 == (fStack_64 == 0.0)) ||
                  ((fStack_6c < fStack_74 == (fStack_6c == fStack_74) ||
                   (fStack_70 < fStack_78 == (fStack_70 == fStack_78))))) ||
                 (uVar11 = 1, 0.0 < fStack_68 == (fStack_68 == 0.0))) {
                uVar11 = 0;
              }
              FUN_004ffd80(uVar11);
              return;
            }
          }
        }
      }
      else {
        uVar11 = *(undefined4 *)(param_1 + 0x18);
        bVar8 = false;
        FUN_00526260(1);
        fVar9 = (float10)FUN_00527730(uVar11);
        uVar11 = *(undefined4 *)(param_1 + 0x18);
        FUN_00526260(0);
        fVar10 = (float10)FUN_00527730(uVar11);
        fStack_68 = (float)fVar10 * 20.0;
        fStack_64 = (float)fVar9 * 20.0;
        if (2 < *(int *)(param_1 + 0x1c)) {
          uVar11 = *(undefined4 *)(param_1 + 0x18);
          FUN_00526260(2);
          cVar2 = FUN_00526120(uVar11);
          bVar8 = cVar2 != '\0';
        }
        if (3 < *(int *)(param_1 + 0x1c)) {
          uVar11 = *(undefined4 *)(param_1 + 0x18);
          FUN_00526260(3);
          cVar2 = FUN_00526120(uVar11);
          bVar8 = bVar8 | -(cVar2 != '\0') & 2U;
        }
        GMatrix2D::SetIdentity(aGStack_38);
        FUN_0051ce40(aGStack_38);
        GMatrix2D::TransformByInverse
                  (aGStack_38,(GPoint<float> *)&fStack_78,(GPoint<float> *)&fStack_68);
        if ((*(byte *)((int)piVar7 + 0x66) & 1) != 0) {
          uVar3 = (**(code **)(*piVar7 + 0x30))(&fStack_78,bVar8);
          puVar1 = *(undefined1 **)(param_1 + 4);
          FUN_00526400();
          puVar1[4] = uVar3;
          *puVar1 = 2;
          return;
        }
        if ((((local_50 < fStack_78) || (fStack_58 < fStack_78 == (fStack_58 == fStack_78))) ||
            (fStack_4c < fStack_74)) || (fStack_54 < fStack_74 == (fStack_54 == fStack_74))) {
          FUN_004ffd80(0);
          return;
        }
        if ((bVar8 & 1) != 0) {
          uVar3 = (**(code **)(*piVar7 + 0x30))(&fStack_78,bVar8);
          FUN_004ffd80(uVar3);
          return;
        }
        FUN_004ffd80(1);
      }
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
0058d830 : SUB ESP,0x7c
0058d833 : PUSH EBP
0058d834 : PUSH ESI
0058d835 : MOV ESI,dword ptr [ESP + 0x88]
0058d83c : MOV ECX,dword ptr [ESI + 0x8]
0058d83f : TEST ECX,ECX
0058d841 : JNZ 0x0058d84b
0058d843 : MOV EAX,dword ptr [ESI + 0x18]
0058d846 : MOV EBP,dword ptr [EAX + 0x74]
0058d849 : JMP 0x0058d869
0058d84b : MOV EDX,dword ptr [ECX]
0058d84d : MOV EAX,dword ptr [EDX + 0x8]
0058d850 : CALL EAX
0058d852 : CMP EAX,0x2
0058d855 : JNZ 0x0058da15
0058d85b : MOV EBP,dword ptr [ESI + 0x8]
0058d85e : TEST EBP,EBP
0058d860 : JZ 0x0058da15
0058d866 : ADD EBP,-0x68
0058d869 : TEST EBP,EBP
0058d86b : JZ 0x0058da15
0058d871 : PUSH EDI
0058d872 : MOV EDI,dword ptr [ESI + 0x4]
0058d875 : MOV ECX,EDI
0058d877 : CALL 0x00526400
0058d87c : LEA ECX,[ESP + 0x58]
0058d880 : MOV byte ptr [EDI],0x2
0058d883 : MOV byte ptr [EDI + 0x4],0x0
0058d887 : CALL 0x00522b80
0058d88c : MOV EDX,dword ptr [EBP]
0058d88f : MOV EDX,dword ptr [EDX + 0x28]
0058d892 : LEA EAX,[ESP + 0x58]
0058d896 : PUSH EAX
0058d897 : LEA ECX,[ESP + 0x3c]
0058d89b : PUSH ECX
0058d89c : MOV ECX,EBP
0058d89e : CALL EDX
0058d8a0 : FLD float ptr [ESP + 0x40]
0058d8a4 : FLD float ptr [ESP + 0x38]
0058d8a8 : FUCOMPP
0058d8aa : FNSTSW AX
0058d8ac : TEST AH,0x44
0058d8af : JP 0x0058d8c6
0058d8b1 : FLD float ptr [ESP + 0x44]
0058d8b5 : FLD float ptr [ESP + 0x3c]
0058d8b9 : FUCOMPP
0058d8bb : FNSTSW AX
0058d8bd : TEST AH,0x44
0058d8c0 : JNP 0x0058da14
0058d8c6 : MOV EAX,dword ptr [ESI + 0x1c]
0058d8c9 : CMP EAX,0x2
0058d8cc : JL 0x0058da57
0058d8d2 : MOV EAX,dword ptr [ESI + 0x18]
0058d8d5 : PUSH EBX
0058d8d6 : PUSH EAX
0058d8d7 : XOR BL,BL
0058d8d9 : PUSH 0x1
0058d8db : MOV ECX,ESI
0058d8dd : MOV byte ptr [ESP + 0x18],BL
0058d8e1 : CALL 0x00526260
0058d8e6 : MOV ECX,EAX
0058d8e8 : CALL 0x00527730
0058d8ed : FSTP float ptr [ESP + 0x18]
0058d8f1 : MOV ECX,dword ptr [ESI + 0x18]
0058d8f4 : PUSH ECX
0058d8f5 : PUSH 0x0
0058d8f7 : MOV ECX,ESI
0058d8f9 : CALL 0x00526260
0058d8fe : MOV ECX,EAX
0058d900 : CALL 0x00527730
0058d905 : FSTP float ptr [ESP + 0x14]
0058d909 : CMP dword ptr [ESI + 0x1c],0x3
0058d90d : FLD float ptr [ESP + 0x14]
0058d911 : FLD double ptr [0x00b86058]
0058d917 : FMUL ST1
0058d919 : FXCH
0058d91b : FSTP float ptr [ESP + 0x2c]
0058d91f : FMUL float ptr [ESP + 0x18]
0058d923 : FSTP float ptr [ESP + 0x30]
0058d927 : JL 0x0058d946
0058d929 : MOV EDX,dword ptr [ESI + 0x18]
0058d92c : PUSH EDX
0058d92d : PUSH 0x2
0058d92f : MOV ECX,ESI
0058d931 : CALL 0x00526260
0058d936 : MOV ECX,EAX
0058d938 : CALL 0x00526120
0058d93d : TEST AL,AL
0058d93f : SETNZ BL
0058d942 : MOV byte ptr [ESP + 0x10],BL
0058d946 : CMP dword ptr [ESI + 0x1c],0x4
0058d94a : JL 0x0058d96c
0058d94c : MOV EAX,dword ptr [ESI + 0x18]
0058d94f : PUSH EAX
0058d950 : PUSH 0x3
0058d952 : MOV ECX,ESI
0058d954 : CALL 0x00526260
0058d959 : MOV ECX,EAX
0058d95b : CALL 0x00526120
0058d960 : NEG AL
0058d962 : SBB AL,AL
0058d964 : AND AL,0x2
0058d966 : OR BL,AL
0058d968 : MOV byte ptr [ESP + 0x10],BL
0058d96c : LEA ECX,[ESP + 0x5c]
0058d970 : CALL 0x00522b80
0058d975 : LEA ECX,[ESP + 0x5c]
0058d979 : PUSH ECX
0058d97a : MOV ECX,EBP
0058d97c : CALL 0x0051ce40
0058d981 : LEA EDX,[ESP + 0x2c]
0058d985 : PUSH EDX
0058d986 : LEA EAX,[ESP + 0x20]
0058d98a : PUSH EAX
0058d98b : LEA ECX,[ESP + 0x64]
0058d98f : CALL 0x00522fa0
0058d994 : TEST byte ptr [EBP + 0x66],0x1
0058d998 : JZ 0x0058d9c8
0058d99a : MOV EAX,dword ptr [ESP + 0x10]
0058d99e : MOV EDX,dword ptr [EBP]
0058d9a1 : MOV EDX,dword ptr [EDX + 0x30]
0058d9a4 : PUSH EAX
0058d9a5 : LEA ECX,[ESP + 0x20]
0058d9a9 : PUSH ECX
0058d9aa : MOV ECX,EBP
0058d9ac : CALL EDX
0058d9ae : MOV ESI,dword ptr [ESI + 0x4]
0058d9b1 : MOV ECX,ESI
0058d9b3 : MOV BL,AL
0058d9b5 : CALL 0x00526400
0058d9ba : MOV byte ptr [ESI + 0x4],BL
0058d9bd : POP EBX
0058d9be : POP EDI
0058d9bf : MOV byte ptr [ESI],0x2
0058d9c2 : POP ESI
0058d9c3 : POP EBP
0058d9c4 : ADD ESP,0x7c
0058d9c7 : RET
0058d9c8 : FLD float ptr [ESP + 0x1c]
0058d9cc : FLD float ptr [ESP + 0x44]
0058d9d0 : FCOMP
0058d9d2 : FNSTSW AX
0058d9d4 : TEST AH,0x1
0058d9d7 : JNZ 0x0058da43
0058d9d9 : FLD float ptr [ESP + 0x3c]
0058d9dd : FCOMPP
0058d9df : FNSTSW AX
0058d9e1 : TEST AH,0x41
0058d9e4 : JP 0x0058da45
0058d9e6 : FLD float ptr [ESP + 0x20]
0058d9ea : FLD float ptr [ESP + 0x48]
0058d9ee : FCOMP
0058d9f0 : FNSTSW AX
0058d9f2 : TEST AH,0x1
0058d9f5 : JNZ 0x0058da43
0058d9f7 : FLD float ptr [ESP + 0x40]
0058d9fb : FCOMPP
0058d9fd : FNSTSW AX
0058d9ff : TEST AH,0x41
0058da02 : JP 0x0058da45
0058da04 : TEST BL,0x1
0058da07 : JNZ 0x0058da1b
0058da09 : MOV ECX,dword ptr [ESI + 0x4]
0058da0c : PUSH 0x1
0058da0e : CALL 0x004ffd80
0058da13 : POP EBX
0058da14 : POP EDI
0058da15 : POP ESI
0058da16 : POP EBP
0058da17 : ADD ESP,0x7c
0058da1a : RET
0058da1b : MOV ECX,dword ptr [ESP + 0x10]
0058da1f : MOV EAX,dword ptr [EBP]
0058da22 : MOV EAX,dword ptr [EAX + 0x30]
0058da25 : PUSH ECX
0058da26 : LEA EDX,[ESP + 0x20]
0058da2a : PUSH EDX
0058da2b : MOV ECX,EBP
0058da2d : CALL EAX
0058da2f : MOVZX ECX,AL
0058da32 : PUSH ECX
0058da33 : MOV ECX,dword ptr [ESI + 0x4]
0058da36 : CALL 0x004ffd80
0058da3b : POP EBX
0058da3c : POP EDI
0058da3d : POP ESI
0058da3e : POP EBP
0058da3f : ADD ESP,0x7c
0058da42 : RET
0058da43 : FSTP ST0
0058da45 : MOV ECX,dword ptr [ESI + 0x4]
0058da48 : PUSH 0x0
0058da4a : CALL 0x004ffd80
0058da4f : POP EBX
0058da50 : POP EDI
0058da51 : POP ESI
0058da52 : POP EBP
0058da53 : ADD ESP,0x7c
0058da56 : RET
0058da57 : CMP EAX,0x1
0058da5a : JNZ 0x0058da14
0058da5c : PUSH 0x0
0058da5e : MOV ECX,ESI
0058da60 : CALL 0x00526260
0058da65 : MOV ECX,EAX
0058da67 : XOR EDI,EDI
0058da69 : CMP byte ptr [ECX],0x7
0058da6c : JNZ 0x0058da87
0058da6e : MOV EDX,dword ptr [ESI + 0x18]
0058da71 : PUSH EDX
0058da72 : CALL 0x00525fa0
0058da77 : TEST EAX,EAX
0058da79 : JZ 0x0058da14
0058da7b : LEA ECX,[EAX + 0x68]
0058da7e : CALL 0x0054ed10
0058da83 : MOV EDI,EAX
0058da85 : JMP 0x0058dafa
0058da87 : MOV EAX,dword ptr [ESI + 0x18]
0058da8a : PUSH 0x0
0058da8c : PUSH -0x1
0058da8e : PUSH EAX
0058da8f : LEA EDX,[ESP + 0x18]
0058da93 : PUSH EDX
0058da94 : CALL 0x005272e0
0058da99 : PUSH 0x0
0058da9b : PUSH 0x0
0058da9d : PUSH 0x0
0058da9f : PUSH 0x0
0058daa1 : LEA EAX,[ESP + 0x68]
0058daa5 : PUSH EAX
0058daa6 : LEA ECX,[ESP + 0x20]
0058daaa : PUSH ECX
0058daab : MOV ECX,dword ptr [ESI + 0x18]
0058daae : MOV byte ptr [ESP + 0x70],0x0
0058dab3 : CALL 0x005331f0
0058dab8 : TEST AL,AL
0058daba : JZ 0x0058dadb
0058dabc : MOV EDX,dword ptr [ESI + 0x18]
0058dabf : PUSH EDX
0058dac0 : LEA ECX,[ESP + 0x5c]
0058dac4 : CALL 0x00525fa0
0058dac9 : TEST EAX,EAX
0058dacb : JZ 0x0058dad9
0058dacd : LEA ECX,[EAX + 0x68]
0058dad0 : CALL 0x0054ed10
0058dad5 : MOV EDI,EAX
0058dad7 : JMP 0x0058dadb
0058dad9 : XOR EDI,EDI
0058dadb : LEA ECX,[ESP + 0x58]
0058dadf : CALL 0x00526bc0
0058dae4 : MOV EAX,dword ptr [ESP + 0xc]
0058dae8 : DEC dword ptr [EAX + 0x8]
0058daeb : MOV ECX,EAX
0058daed : ADD EAX,0x8
0058daf0 : CMP dword ptr [EAX],0x0
0058daf3 : JNZ 0x0058dafa
0058daf5 : CALL 0x00525340
0058dafa : TEST EDI,EDI
0058dafc : JZ 0x0058da14
0058db02 : LEA ECX,[ESP + 0x70]
0058db06 : CALL 0x00522b80
0058db0b : MOV EAX,dword ptr [EDI]
0058db0d : MOV EAX,dword ptr [EAX + 0x28]
0058db10 : LEA ECX,[ESP + 0x70]
0058db14 : PUSH ECX
0058db15 : LEA EDX,[ESP + 0x4c]
0058db19 : PUSH EDX
0058db1a : MOV ECX,EDI
0058db1c : CALL EAX
0058db1e : FLD float ptr [ESP + 0x50]
0058db22 : FLD float ptr [ESP + 0x48]
0058db26 : FUCOMPP
0058db28 : FNSTSW AX
0058db2a : TEST AH,0x44
0058db2d : JP 0x0058db44
0058db2f : FLD float ptr [ESP + 0x54]
0058db33 : FLD float ptr [ESP + 0x4c]
0058db37 : FUCOMPP
0058db39 : FNSTSW AX
0058db3b : TEST AH,0x44
0058db3e : JNP 0x0058da14
0058db44 : LEA ECX,[ESP + 0x70]
0058db48 : PUSH ECX
0058db49 : MOV ECX,EBP
0058db4b : CALL 0x0050aa60
0058db50 : FLDZ
0058db52 : LEA EDX,[ESP + 0x38]
0058db56 : FST float ptr [ESP + 0x28]
0058db5a : PUSH EDX
0058db5b : FST float ptr [ESP + 0x30]
0058db5f : LEA ECX,[ESP + 0x2c]
0058db63 : FST float ptr [ESP + 0x34]
0058db67 : PUSH ECX
0058db68 : FSTP float ptr [ESP + 0x3c]
0058db6c : MOV ECX,EAX
0058db6e : CALL 0x005231d0
0058db73 : LEA EDX,[ESP + 0x70]
0058db77 : PUSH EDX
0058db78 : MOV ECX,EDI
0058db7a : CALL 0x0050aa60
0058db7f : FLDZ
0058db81 : LEA ECX,[ESP + 0x48]
0058db85 : FST float ptr [ESP + 0x18]
0058db89 : PUSH ECX
0058db8a : FST float ptr [ESP + 0x20]
0058db8e : LEA EDX,[ESP + 0x1c]
0058db92 : FST float ptr [ESP + 0x24]
0058db96 : PUSH EDX
0058db97 : FSTP float ptr [ESP + 0x2c]
0058db9b : MOV ECX,EAX
0058db9d : CALL 0x005231d0
0058dba2 : FLD float ptr [ESP + 0x34]
0058dba6 : FLD float ptr [ESP + 0x1c]
0058dbaa : FCOMPP
0058dbac : FNSTSW AX
0058dbae : TEST AH,0x41
0058dbb1 : JP 0x0058dbeb
0058dbb3 : FLD float ptr [ESP + 0x24]
0058dbb7 : FLD float ptr [ESP + 0x2c]
0058dbbb : FCOMPP
0058dbbd : FNSTSW AX
0058dbbf : TEST AH,0x41
0058dbc2 : JP 0x0058dbeb
0058dbc4 : FLD float ptr [ESP + 0x20]
0058dbc8 : FLD float ptr [ESP + 0x28]
0058dbcc : FCOMPP
0058dbce : FNSTSW AX
0058dbd0 : TEST AH,0x41
0058dbd3 : JP 0x0058dbeb
0058dbd5 : FLD float ptr [ESP + 0x30]
0058dbd9 : MOV byte ptr [ESP + 0xc],0x1
0058dbde : FLD float ptr [ESP + 0x18]
0058dbe2 : FCOMPP
0058dbe4 : FNSTSW AX
0058dbe6 : TEST AH,0x41
0058dbe9 : JNP 0x0058dbf0
0058dbeb : MOV byte ptr [ESP + 0xc],0x0
0058dbf0 : MOV EAX,dword ptr [ESP + 0xc]
0058dbf4 : MOV ECX,dword ptr [ESI + 0x4]
0058dbf7 : PUSH EAX
0058dbf8 : CALL 0x004ffd80
0058dbfd : POP EDI
0058dbfe : POP ESI
0058dbff : POP EBP
0058dc00 : ADD ESP,0x7c
0058dc03 : RET

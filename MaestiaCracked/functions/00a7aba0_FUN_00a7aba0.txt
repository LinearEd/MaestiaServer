PROGRAM  : Maestia.exe
FUNCTION : FUN_00a7aba0
ENTRY    : 00a7aba0
BODY     : [[00a7aba0, 00a7ae04]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a7aba0(undefined4 param_1)

{
  undefined2 uVar1;
  undefined2 uVar2;
  int iVar3;
  char cVar4;
  short sVar5;
  undefined4 uVar6;
  int *piVar7;
  int iVar8;
  int *in_ECX;
  undefined1 local_30 [28];
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b66957;
  local_10 = ExceptionList;
  if ((char)in_ECX[2] == '\0') {
    return;
  }
  ExceptionList = &local_10;
  cVar4 = FUN_008eb3f0(DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
  if (cVar4 != '\0') {
    ExceptionList = local_10;
    return;
  }
  iVar3 = *(int *)(in_ECX[1] + 0x128);
  if (iVar3 == 0) {
    ExceptionList = local_10;
    return;
  }
  if (*(char *)(iVar3 + 0x59) == '\0') {
    piVar7 = (int *)(**(code **)(*in_ECX + 0x74))(param_1,0);
    local_14 = piVar7;
    if ((piVar7 == (int *)0x0) || (*(char *)((int)piVar7 + 0x3c) == '\0')) {
      cVar4 = (**(code **)(*in_ECX + 0x5c))(piVar7,iVar3);
      if (cVar4 != '\0') {
        ExceptionList = local_10;
        return;
      }
      if ((*(int *)(iVar3 + 0x40) == in_ECX[0xb]) &&
         (cVar4 = FUN_00907c00(0), piVar7 = local_14, cVar4 != '\0')) {
        FUN_00a7aa50();
        ExceptionList = local_10;
        return;
      }
      if (*(int *)(iVar3 + 0x40) == -1) {
        if (piVar7 != (int *)0x0) {
          FUN_0097fb30(piVar7,param_1,0);
          ExceptionList = local_10;
          return;
        }
      }
      else {
        piVar7 = (int *)FUN_008eb580();
        if (piVar7 == (int *)0x0) {
          ExceptionList = local_10;
          return;
        }
        uVar1 = *(undefined2 *)(iVar3 + 0x46);
        uVar2 = *(undefined2 *)(iVar3 + 0x44);
        iVar8 = (**(code **)(*piVar7 + 0x74))(uVar2,uVar1);
        if (iVar8 != 0) {
          local_14 = (int *)FUN_004049b0(*(undefined4 *)(iVar8 + 0x10));
          if (local_14 == (int *)0x0) {
            ExceptionList = local_10;
            return;
          }
          sVar5 = (**(code **)(*local_14 + 8))();
          if (sVar5 != 0x68c) {
            ExceptionList = local_10;
            return;
          }
          if ((*(byte *)(local_14 + 0xa2) & 1) == 0) {
            ExceptionList = local_10;
            return;
          }
          FUN_008efa90(*(undefined4 *)(iVar3 + 0x40),uVar2,uVar1,0x95,param_1,0);
          ExceptionList = local_10;
          return;
        }
      }
      if (DAT_00da93ec != 0) {
        FUN_00a1dad0();
      }
      ExceptionList = local_10;
      return;
    }
    FUN_00406460(L"IDS_GUI_CANT_MOVE_USING_ITEM");
    local_8 = 2;
    piVar7 = *(int **)(in_ECX[1] + 0x1a8);
    uVar6 = FUN_0081d120(local_30);
    local_8._0_1_ = 3;
    (**(code **)(*piVar7 + 0x44))(uVar6,3);
    local_8 = CONCAT31(local_8._1_3_,2);
  }
  else {
    FUN_00406460(L"IDS_GUI_IS_REQUEST_DELETE");
    local_8 = 0;
    piVar7 = *(int **)(in_ECX[1] + 0x1a8);
    uVar6 = FUN_0081d120(local_30);
    local_8._0_1_ = 1;
    (**(code **)(*piVar7 + 0x44))(uVar6,3);
    local_8 = (uint)local_8._1_3_ << 8;
  }
  FUN_00406560();
  local_8 = 0xffffffff;
  FUN_00406560();
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00a7aba0 : PUSH EBP
00a7aba1 : MOV EBP,ESP
00a7aba3 : PUSH -0x1
00a7aba5 : PUSH 0xb66957
00a7abaa : MOV EAX,FS:[0x0]
00a7abb0 : PUSH EAX
00a7abb1 : SUB ESP,0x40
00a7abb4 : PUSH EBX
00a7abb5 : PUSH ESI
00a7abb6 : PUSH EDI
00a7abb7 : MOV EAX,[0x00d66fa0]
00a7abbc : XOR EAX,EBP
00a7abbe : PUSH EAX
00a7abbf : LEA EAX,[EBP + -0xc]
00a7abc2 : MOV FS:[0x0],EAX
00a7abc8 : MOV ESI,ECX
00a7abca : MOV AL,byte ptr [ESI + 0x8]
00a7abcd : TEST AL,AL
00a7abcf : JZ 0x00a7adf1
00a7abd5 : MOV EAX,[0x00da9894]
00a7abda : MOV EAX,dword ptr [EAX]
00a7abdc : CALL 0x008eb3f0
00a7abe1 : TEST AL,AL
00a7abe3 : JNZ 0x00a7adf1
00a7abe9 : MOV ECX,dword ptr [ESI + 0x4]
00a7abec : MOV EBX,dword ptr [ECX + 0x128]
00a7abf2 : TEST EBX,EBX
00a7abf4 : JZ 0x00a7adf1
00a7abfa : CMP byte ptr [EBX + 0x59],AL
00a7abfd : JZ 0x00a7ac44
00a7abff : PUSH 0xc50efc
00a7ac04 : LEA ECX,[EBP + -0x2c]
00a7ac07 : CALL 0x00406460
00a7ac0c : MOV dword ptr [EBP + -0x4],0x0
00a7ac13 : MOV EDX,dword ptr [ESI + 0x4]
00a7ac16 : MOV ECX,dword ptr [0x0172491c]
00a7ac1c : MOV ESI,dword ptr [EDX + 0x1a8]
00a7ac22 : LEA EAX,[EBP + -0x2c]
00a7ac25 : PUSH EAX
00a7ac26 : LEA EDI,[EBP + -0x48]
00a7ac29 : CALL 0x0081d120
00a7ac2e : MOV byte ptr [EBP + -0x4],0x1
00a7ac32 : MOV EDX,dword ptr [ESI]
00a7ac34 : PUSH 0x3
00a7ac36 : PUSH EAX
00a7ac37 : MOV EAX,dword ptr [EDX + 0x44]
00a7ac3a : MOV ECX,ESI
00a7ac3c : CALL EAX
00a7ac3e : MOV byte ptr [EBP + -0x4],0x0
00a7ac42 : JMP 0x00a7aca5
00a7ac44 : MOV EDX,dword ptr [ESI]
00a7ac46 : MOV EAX,dword ptr [EBP + 0x8]
00a7ac49 : MOV EDX,dword ptr [EDX + 0x74]
00a7ac4c : PUSH 0x0
00a7ac4e : PUSH EAX
00a7ac4f : MOV ECX,ESI
00a7ac51 : CALL EDX
00a7ac53 : MOV EDI,EAX
00a7ac55 : MOV dword ptr [EBP + -0x10],EDI
00a7ac58 : TEST EDI,EDI
00a7ac5a : JZ 0x00a7acd0
00a7ac5c : CMP byte ptr [EDI + 0x3c],0x0
00a7ac60 : JZ 0x00a7acd0
00a7ac62 : PUSH 0xc50f30
00a7ac67 : LEA ECX,[EBP + -0x2c]
00a7ac6a : CALL 0x00406460
00a7ac6f : MOV EBX,0x2
00a7ac74 : MOV dword ptr [EBP + -0x4],EBX
00a7ac77 : MOV EAX,dword ptr [ESI + 0x4]
00a7ac7a : MOV ESI,dword ptr [EAX + 0x1a8]
00a7ac80 : LEA ECX,[EBP + -0x2c]
00a7ac83 : PUSH ECX
00a7ac84 : MOV ECX,dword ptr [0x0172491c]
00a7ac8a : LEA EDI,[EBP + -0x48]
00a7ac8d : CALL 0x0081d120
00a7ac92 : MOV byte ptr [EBP + -0x4],0x3
00a7ac96 : MOV EDX,dword ptr [ESI]
00a7ac98 : PUSH 0x3
00a7ac9a : PUSH EAX
00a7ac9b : MOV EAX,dword ptr [EDX + 0x44]
00a7ac9e : MOV ECX,ESI
00a7aca0 : CALL EAX
00a7aca2 : MOV byte ptr [EBP + -0x4],BL
00a7aca5 : LEA ECX,[EBP + -0x48]
00a7aca8 : CALL 0x00406560
00a7acad : MOV dword ptr [EBP + -0x4],0xffffffff
00a7acb4 : LEA ECX,[EBP + -0x2c]
00a7acb7 : CALL 0x00406560
00a7acbc : MOV ECX,dword ptr [EBP + -0xc]
00a7acbf : MOV dword ptr FS:[0x0],ECX
00a7acc6 : POP ECX
00a7acc7 : POP EDI
00a7acc8 : POP ESI
00a7acc9 : POP EBX
00a7acca : MOV ESP,EBP
00a7accc : POP EBP
00a7accd : RET 0x4
00a7acd0 : MOV EDX,dword ptr [ESI]
00a7acd2 : MOV EAX,dword ptr [EDX + 0x5c]
00a7acd5 : PUSH EBX
00a7acd6 : PUSH EDI
00a7acd7 : MOV ECX,ESI
00a7acd9 : CALL EAX
00a7acdb : TEST AL,AL
00a7acdd : JNZ 0x00a7adf1
00a7ace3 : MOV ECX,dword ptr [EBX + 0x40]
00a7ace6 : CMP ECX,dword ptr [ESI + 0x2c]
00a7ace9 : JNZ 0x00a7ad1b
00a7aceb : MOV EDI,dword ptr [EBP + 0x8]
00a7acee : PUSH 0x0
00a7acf0 : MOV ECX,EBX
00a7acf2 : CALL 0x00907c00
00a7acf7 : TEST AL,AL
00a7acf9 : JZ 0x00a7ad18
00a7acfb : MOV EDX,EDI
00a7acfd : MOV ECX,ESI
00a7acff : CALL 0x00a7aa50
00a7ad04 : MOV ECX,dword ptr [EBP + -0xc]
00a7ad07 : MOV dword ptr FS:[0x0],ECX
00a7ad0e : POP ECX
00a7ad0f : POP EDI
00a7ad10 : POP ESI
00a7ad11 : POP EBX
00a7ad12 : MOV ESP,EBP
00a7ad14 : POP EBP
00a7ad15 : RET 0x4
00a7ad18 : MOV EDI,dword ptr [EBP + -0x10]
00a7ad1b : MOV EAX,dword ptr [EBX + 0x40]
00a7ad1e : CMP EAX,-0x1
00a7ad21 : JZ 0x00a7adb7
00a7ad27 : MOV EDI,EAX
00a7ad29 : MOV EAX,dword ptr [ESI + 0x4]
00a7ad2c : CALL 0x008eb580
00a7ad31 : TEST EAX,EAX
00a7ad33 : JZ 0x00a7adf1
00a7ad39 : MOVZX EDI,word ptr [EBX + 0x46]
00a7ad3d : MOVZX ESI,word ptr [EBX + 0x44]
00a7ad41 : MOV EDX,dword ptr [EAX]
00a7ad43 : PUSH EDI
00a7ad44 : MOV ECX,EAX
00a7ad46 : MOV EAX,dword ptr [EDX + 0x74]
00a7ad49 : PUSH ESI
00a7ad4a : CALL EAX
00a7ad4c : TEST EAX,EAX
00a7ad4e : JZ 0x00a7ade2
00a7ad54 : MOV ECX,dword ptr [EAX + 0x10]
00a7ad57 : PUSH ECX
00a7ad58 : CALL 0x004049b0
00a7ad5d : ADD ESP,0x4
00a7ad60 : MOV dword ptr [EBP + -0x10],EAX
00a7ad63 : TEST EAX,EAX
00a7ad65 : JZ 0x00a7adf1
00a7ad6b : MOV EDX,dword ptr [EAX]
00a7ad6d : MOV ECX,EAX
00a7ad6f : MOV EAX,dword ptr [EDX + 0x8]
00a7ad72 : CALL EAX
00a7ad74 : MOV ECX,0x68c
00a7ad79 : CMP AX,CX
00a7ad7c : JNZ 0x00a7adf1
00a7ad7e : MOV EDX,dword ptr [EBP + -0x10]
00a7ad81 : TEST byte ptr [EDX + 0x288],0x1
00a7ad88 : JZ 0x00a7adf1
00a7ad8a : MOV EAX,dword ptr [EBP + 0x8]
00a7ad8d : MOV ECX,dword ptr [EBX + 0x40]
00a7ad90 : PUSH 0x0
00a7ad92 : PUSH EAX
00a7ad93 : PUSH 0x95
00a7ad98 : PUSH EDI
00a7ad99 : PUSH ESI
00a7ad9a : PUSH ECX
00a7ad9b : CALL 0x008efa90
00a7ada0 : ADD ESP,0x18
00a7ada3 : MOV ECX,dword ptr [EBP + -0xc]
00a7ada6 : MOV dword ptr FS:[0x0],ECX
00a7adad : POP ECX
00a7adae : POP EDI
00a7adaf : POP ESI
00a7adb0 : POP EBX
00a7adb1 : MOV ESP,EBP
00a7adb3 : POP EBP
00a7adb4 : RET 0x4
00a7adb7 : TEST EDI,EDI
00a7adb9 : JZ 0x00a7ade2
00a7adbb : MOV EDX,dword ptr [EBP + 0x8]
00a7adbe : PUSH 0x0
00a7adc0 : PUSH EDX
00a7adc1 : PUSH EDI
00a7adc2 : MOV EAX,0x99
00a7adc7 : MOV ECX,EBX
00a7adc9 : CALL 0x0097fb30
00a7adce : MOV ECX,dword ptr [EBP + -0xc]
00a7add1 : MOV dword ptr FS:[0x0],ECX
00a7add8 : POP ECX
00a7add9 : POP EDI
00a7adda : POP ESI
00a7addb : POP EBX
00a7addc : MOV ESP,EBP
00a7adde : POP EBP
00a7addf : RET 0x4
00a7ade2 : MOV ESI,dword ptr [0x00da93ec]
00a7ade8 : TEST ESI,ESI
00a7adea : JZ 0x00a7adf1
00a7adec : CALL 0x00a1dad0
00a7adf1 : MOV ECX,dword ptr [EBP + -0xc]
00a7adf4 : MOV dword ptr FS:[0x0],ECX
00a7adfb : POP ECX
00a7adfc : POP EDI
00a7adfd : POP ESI
00a7adfe : POP EBX
00a7adff : MOV ESP,EBP
00a7ae01 : POP EBP
00a7ae02 : RET 0x4

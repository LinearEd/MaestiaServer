PROGRAM  : Maestia.exe
FUNCTION : FUN_00852ab0
ENTRY    : 00852ab0
BODY     : [[00852ab0, 00852d45]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00852ab0(void)

{
  code *pcVar1;
  uint uVar2;
  char cVar3;
  uint uVar4;
  undefined4 uVar5;
  int iVar6;
  int *in_ECX;
  undefined4 *puVar7;
  undefined **local_120 [47];
  undefined4 local_64;
  undefined4 local_60;
  undefined4 local_5c;
  undefined4 local_58;
  undefined4 local_54;
  undefined4 local_50;
  int local_4c;
  int local_48;
  int local_44;
  undefined4 local_40;
  float local_3c;
  undefined4 local_34;
  float local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined1 local_19;
  float local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b48e70;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar6 = in_ECX[0x104];
  if (*(int *)(iVar6 + 0x168) != *(int *)(iVar6 + 0x16c)) {
    local_14 = local_14 & 0xffffff00;
    uVar5 = FUN_0047b6d0();
    *(undefined4 *)(iVar6 + 0x16c) = uVar5;
  }
  uVar2 = local_14;
  local_14 = local_14 & 0xffffff00;
  if (*(char *)((int)in_ECX + 0x701) != '\0') {
    local_14 = CONCAT31(SUB43(uVar2,1),1);
    *(undefined1 *)((int)in_ECX + 0x701) = 0;
  }
  if ((char)in_ECX[0x132] == '\0') {
    (**(code **)(*in_ECX + 0x188))(0x14,1,0,local_14,0,0x3f800000,uVar4);
    pcVar1 = *(code **)(*in_ECX + 0x254);
    in_ECX[0x172] = 0;
    *(undefined1 *)(in_ECX + 0x173) = 0;
    (*pcVar1)(1,in_ECX + 1,0);
  }
  else {
    (**(code **)(*in_ECX + 0x188))(0x16,1,0,local_14,0,0x3f800000,uVar4);
  }
  if (in_ECX[0x62a] == 0) {
    ExceptionList = local_10;
    return;
  }
  if (((*(char *)(in_ECX[0x62a] + 0x20) != '\0') && (cVar3 = FUN_00876040(), cVar3 == '\0')) &&
     (*(char *)(in_ECX[0x62a] + 0xec) == '\0')) {
    if (*(int *)(in_ECX[0x62a] + 0x30) == 0) {
      ExceptionList = local_10;
      return;
    }
    local_4c = in_ECX[0x560];
    local_48 = in_ECX[0x561];
    local_44 = in_ECX[0x562];
    D3DXVec3Normalize(&local_4c,&local_4c);
    local_58 = 0;
    local_54 = 0xbf800000;
    local_50 = 0;
    iVar6 = FUN_007d5b60(local_120);
    local_34 = *(undefined4 *)(iVar6 + 0x20);
    local_2c = *(undefined4 *)(iVar6 + 0x28);
    local_8 = 0xffffffff;
    local_30 = *(float *)(iVar6 + 0x24) + DAT_00d72c20;
    local_64 = 0;
    local_60 = 0;
    local_5c = 0;
    local_14 = 0;
    local_120[0] = &PTR_FUN_00cd083c;
    local_3c = 0.0;
    iVar6 = FUN_007e9d70(*(undefined4 *)(DAT_00da93ec + 0xc),&local_58,&local_40,&local_64,&local_14
                        );
    local_28 = 0;
    local_24 = 0;
    local_20 = 0;
    FUN_007e3cb0(*(undefined4 *)(in_ECX[0xfa] + 0x68),*(undefined4 *)(in_ECX[0xfa] + 0x70),&local_18
                 ,&local_19,&local_28);
    if ((iVar6 == 0) || (local_3c <= local_18)) {
      D3DXVec3Normalize(&local_28,&local_28);
      puVar7 = &local_40;
      FUN_00855280(&local_28);
      goto LAB_00852d2d;
    }
  }
  puVar7 = &DAT_00d720f0;
LAB_00852d2d:
  FUN_00856310(puVar7);
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00852ab0 : PUSH EBP
00852ab1 : MOV EBP,ESP
00852ab3 : PUSH -0x1
00852ab5 : PUSH 0xb48e70
00852aba : MOV EAX,FS:[0x0]
00852ac0 : PUSH EAX
00852ac1 : SUB ESP,0x110
00852ac7 : PUSH EBX
00852ac8 : PUSH ESI
00852ac9 : PUSH EDI
00852aca : MOV EAX,[0x00d66fa0]
00852acf : XOR EAX,EBP
00852ad1 : PUSH EAX
00852ad2 : LEA EAX,[EBP + -0xc]
00852ad5 : MOV FS:[0x0],EAX
00852adb : MOV EBX,ECX
00852add : MOV ESI,dword ptr [EBX + 0x410]
00852ae3 : MOV ECX,dword ptr [ESI + 0x16c]
00852ae9 : MOV EAX,dword ptr [ESI + 0x168]
00852aef : CMP EAX,ECX
00852af1 : JZ 0x00852b13
00852af3 : MOV byte ptr [EBP + -0x10],0x0
00852af7 : MOV EDX,dword ptr [EBP + -0x10]
00852afa : PUSH EDX
00852afb : MOV EDX,dword ptr [EBP + -0x14]
00852afe : PUSH EDX
00852aff : MOV EDX,dword ptr [EBP + -0x14]
00852b02 : PUSH EDX
00852b03 : MOV EDI,ECX
00852b05 : CALL 0x0047b6d0
00852b0a : ADD ESP,0xc
00852b0d : MOV dword ptr [ESI + 0x16c],EAX
00852b13 : MOV AL,byte ptr [EBX + 0x701]
00852b19 : MOV byte ptr [EBP + -0x10],0x0
00852b1d : TEST AL,AL
00852b1f : JZ 0x00852b2c
00852b21 : MOV byte ptr [EBP + -0x10],0x1
00852b25 : MOV byte ptr [EBX + 0x701],0x0
00852b2c : CMP byte ptr [EBX + 0x4c8],0x0
00852b33 : FLD1
00852b35 : MOV EAX,dword ptr [EBX]
00852b37 : MOV EDX,dword ptr [EAX + 0x188]
00852b3d : PUSH ECX
00852b3e : MOV ECX,dword ptr [EBP + -0x10]
00852b41 : FSTP float ptr [ESP]
00852b44 : PUSH 0x0
00852b46 : PUSH ECX
00852b47 : PUSH 0x0
00852b49 : MOV ECX,EBX
00852b4b : PUSH 0x1
00852b4d : JZ 0x00852b55
00852b4f : PUSH 0x16
00852b51 : CALL EDX
00852b53 : JMP 0x00852b7e
00852b55 : PUSH 0x14
00852b57 : CALL EDX
00852b59 : MOV EAX,dword ptr [EBX]
00852b5b : MOV EDX,dword ptr [EAX + 0x254]
00852b61 : PUSH 0x0
00852b63 : LEA ECX,[EBX + 0x4]
00852b66 : PUSH ECX
00852b67 : PUSH 0x1
00852b69 : MOV ECX,EBX
00852b6b : MOV dword ptr [EBX + 0x5c8],0x0
00852b75 : MOV byte ptr [EBX + 0x5cc],0x0
00852b7c : CALL EDX
00852b7e : MOV EAX,dword ptr [EBX + 0x18a8]
00852b84 : TEST EAX,EAX
00852b86 : JZ 0x00852d34
00852b8c : CMP byte ptr [EAX + 0x20],0x0
00852b90 : JNZ 0x00852b9c
00852b92 : PUSH 0xd720f0
00852b97 : JMP 0x00852d2d
00852b9c : MOV EAX,dword ptr [EBX + 0x138]
00852ba2 : MOV ECX,dword ptr [EAX + 0x4]
00852ba5 : LEA ESI,[EBX + 0x1c58]
00852bab : LEA EDI,[ECX + EBX*0x1 + 0x138]
00852bb2 : CALL 0x00876040
00852bb7 : TEST AL,AL
00852bb9 : JNZ 0x00852b92
00852bbb : MOV EAX,dword ptr [EBX + 0x18a8]
00852bc1 : CMP byte ptr [EAX + 0xec],0x0
00852bc8 : JNZ 0x00852b92
00852bca : CMP dword ptr [EAX + 0x30],0x0
00852bce : JZ 0x00852d34
00852bd4 : MOVSS XMM0,dword ptr [EBX + 0x1580]
00852bdc : MOVSS XMM1,dword ptr [EBX + 0x1584]
00852be4 : MOVSS XMM2,dword ptr [EBX + 0x1588]
00852bec : LEA EDX,[EBP + -0x48]
00852bef : PUSH EDX
00852bf0 : MOV EAX,EDX
00852bf2 : PUSH EAX
00852bf3 : MOVSS dword ptr [EBP + -0x48],XMM0
00852bf8 : MOVSS dword ptr [EBP + -0x44],XMM1
00852bfd : MOVSS dword ptr [EBP + -0x40],XMM2
00852c02 : CALL 0x004ff722
00852c07 : XORPS XMM0,XMM0
00852c0a : MOVSS XMM1,dword ptr [0x00cdf0d0]
00852c12 : LEA ECX,[EBP + 0xfffffee4]
00852c18 : PUSH ECX
00852c19 : MOV ECX,dword ptr [EBX + 0x3e8]
00852c1f : MOVSS dword ptr [EBP + -0x54],XMM0
00852c24 : MOVSS dword ptr [EBP + -0x50],XMM1
00852c29 : MOVSS dword ptr [EBP + -0x4c],XMM0
00852c2e : CALL 0x007d5b60
00852c33 : MOV dword ptr [EBP + -0x4],0x0
00852c3a : MOVSS XMM0,dword ptr [EAX + 0x20]
00852c3f : MOVSS XMM1,dword ptr [EAX + 0x24]
00852c44 : MOVSS XMM2,dword ptr [EAX + 0x28]
00852c49 : MOVSS dword ptr [EBP + -0x30],XMM0
00852c4e : MOVSS dword ptr [EBP + -0x2c],XMM1
00852c53 : MOVSS dword ptr [EBP + -0x28],XMM2
00852c58 : MOV dword ptr [EBP + -0x4],0xffffffff
00852c5f : MOVSS XMM0,dword ptr [EBP + -0x2c]
00852c64 : ADDSS XMM0,dword ptr [0x00d72c20]
00852c6c : MOV EDX,dword ptr [0x00da93ec]
00852c72 : MOVSS dword ptr [EBP + -0x2c],XMM0
00852c77 : XORPS XMM0,XMM0
00852c7a : MOVSS dword ptr [EBP + -0x60],XMM0
00852c7f : MOVSS dword ptr [EBP + -0x5c],XMM0
00852c84 : MOVSS dword ptr [EBP + -0x58],XMM0
00852c89 : MOVSS dword ptr [EBP + -0x10],XMM0
00852c8e : LEA ECX,[EBP + -0x10]
00852c91 : PUSH ECX
00852c92 : MOV dword ptr [EBP + 0xfffffee4],0xcd083c
00852c9c : MOV EAX,dword ptr [EDX + 0xc]
00852c9f : LEA EDX,[EBP + -0x60]
00852ca2 : PUSH EDX
00852ca3 : LEA ECX,[EBP + -0x3c]
00852ca6 : PUSH ECX
00852ca7 : LEA EDX,[EBP + -0x54]
00852caa : PUSH EDX
00852cab : PUSH EAX
00852cac : LEA EDI,[EBP + -0x30]
00852caf : MOVSS dword ptr [EBP + -0x38],XMM0
00852cb4 : CALL 0x007e9d70
00852cb9 : XORPS XMM0,XMM0
00852cbc : LEA ECX,[EBP + -0x24]
00852cbf : PUSH ECX
00852cc0 : LEA EDX,[EBP + -0x15]
00852cc3 : PUSH EDX
00852cc4 : MOV EDX,dword ptr [0x00da93ec]
00852cca : LEA ECX,[EBP + -0x14]
00852ccd : MOV ESI,EAX
00852ccf : MOV EAX,dword ptr [EBX + 0x3e8]
00852cd5 : MOVSS dword ptr [EBP + -0x24],XMM0
00852cda : MOVSS dword ptr [EBP + -0x20],XMM0
00852cdf : MOVSS dword ptr [EBP + -0x1c],XMM0
00852ce4 : FLD float ptr [EAX + 0x70]
00852ce7 : MOV EDI,dword ptr [EDX + 0xc]
00852cea : PUSH ECX
00852ceb : SUB ESP,0x8
00852cee : FSTP float ptr [ESP + 0x4]
00852cf2 : FLD float ptr [EAX + 0x68]
00852cf5 : FSTP float ptr [ESP]
00852cf8 : CALL 0x007e3cb0
00852cfd : TEST ESI,ESI
00852cff : JZ 0x00852d10
00852d01 : MOVSS XMM0,dword ptr [EBP + -0x38]
00852d06 : COMISS XMM0,dword ptr [EBP + -0x14]
00852d0a : JA 0x00852b92
00852d10 : LEA EAX,[EBP + -0x24]
00852d13 : PUSH EAX
00852d14 : MOV ECX,EAX
00852d16 : PUSH ECX
00852d17 : CALL 0x004ff722
00852d1c : LEA EDX,[EBP + -0x24]
00852d1f : PUSH EDX
00852d20 : LEA EDI,[EBP + -0x3c]
00852d23 : MOV EAX,EBX
00852d25 : CALL 0x00855280
00852d2a : MOV EAX,EDI
00852d2c : PUSH EAX
00852d2d : MOV ESI,EBX
00852d2f : CALL 0x00856310
00852d34 : MOV ECX,dword ptr [EBP + -0xc]
00852d37 : MOV dword ptr FS:[0x0],ECX
00852d3e : POP ECX
00852d3f : POP EDI
00852d40 : POP ESI
00852d41 : POP EBX
00852d42 : MOV ESP,EBP
00852d44 : POP EBP
00852d45 : RET

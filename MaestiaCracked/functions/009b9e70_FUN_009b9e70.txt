PROGRAM  : Maestia.exe
FUNCTION : FUN_009b9e70
ENTRY    : 009b9e70
BODY     : [[009b9e70, 009b9fe9]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009b9e70(int *param_1,ushort *param_2)

{
  ushort uVar1;
  wchar_t wVar2;
  int iVar3;
  wchar_t *pwVar4;
  ushort *puVar5;
  ushort *puVar6;
  uint uVar7;
  undefined4 local_810;
  int local_80c;
  wchar_t local_808;
  undefined1 local_806 [2046];
  uint local_8;
  
  local_8 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  uVar7 = (*param_2 & 0x1fff) - 0x62;
  puVar6 = param_2 + 0x31;
  local_808 = L'\0';
  local_80c = 0;
  if (*(char *)((int)param_2 + 0xd) != '\0') {
    do {
      if ((puVar6 == (ushort *)0x0) || (uVar7 < 4)) {
LAB_009b9f00:
        puVar5 = (ushort *)0x0;
        uVar7 = 0;
        puVar6 = (ushort *)0x0;
      }
      else {
        local_810 = *(undefined4 *)puVar6;
        uVar7 = uVar7 - 4;
        if ((puVar6 + 2 == (ushort *)0x0) ||
           (((uVar7 < 2 || (uVar1 = puVar6[2], (short)uVar1 < 0)) ||
            (iVar3 = (int)(short)uVar1, (int)uVar7 < iVar3 + 2)))) goto LAB_009b9f00;
        puVar5 = puVar6 + 3;
        uVar7 = uVar7 + (-2 - iVar3);
        puVar6 = (ushort *)((int)puVar6 + iVar3 + 6);
      }
      pwVar4 = &local_808;
      do {
        wVar2 = *pwVar4;
        pwVar4 = pwVar4 + 1;
      } while (wVar2 != L'\0');
      wsprintfW((LPWSTR)(local_806 + ((int)pwVar4 - (int)local_806 >> 1) * 2 + -2),L"%d:%s",
                local_810,puVar5);
      if (local_80c != *(byte *)((int)param_2 + 0xd) - 1) {
        _wcscat_s(&local_808,0x400,L"|");
      }
      local_80c = local_80c + 1;
    } while (local_80c < (int)(uint)*(byte *)((int)param_2 + 0xd));
  }
  *param_1 = *param_1 + 1;
  (**(code **)(**(int **)(*DAT_00da9894 + 0x114) + 4))
            (*(int **)(*DAT_00da9894 + 0x114),"OpenChatRoomView","%d,%ls,%d,%d,%d,%d,%d,%ls",
             param_2[2],param_2 + 9,(char)param_2[6],*(undefined1 *)((int)param_2 + 0xd),
             *(undefined4 *)(param_2 + 3),(char)param_2[5],*(undefined1 *)((int)param_2 + 0xb),
             &local_808);
  __security_check_cookie(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
009b9e70 : PUSH EBP
009b9e71 : MOV EBP,ESP
009b9e73 : SUB ESP,0x814
009b9e79 : MOV EAX,[0x00d66fa0]
009b9e7e : XOR EAX,EBP
009b9e80 : MOV dword ptr [EBP + -0x4],EAX
009b9e83 : MOV EAX,dword ptr [EBP + 0x8]
009b9e86 : PUSH EBX
009b9e87 : MOV EBX,dword ptr [EBP + 0xc]
009b9e8a : PUSH ESI
009b9e8b : PUSH EDI
009b9e8c : MOVZX EDI,word ptr [EBX]
009b9e8f : AND EDI,0x1fff
009b9e95 : XOR ECX,ECX
009b9e97 : SUB EDI,0x62
009b9e9a : MOV dword ptr [EBP + 0xfffff7f0],EAX
009b9ea0 : LEA ESI,[EBX + 0x62]
009b9ea3 : MOV word ptr [EBP + 0xfffff7fc],CX
009b9eaa : MOV dword ptr [EBP + 0xfffff7f8],ECX
009b9eb0 : CMP byte ptr [EBX + 0xd],CL
009b9eb3 : JBE 0x009b9f8b
009b9eb9 : LEA ESP,[ESP]
009b9ec0 : TEST ESI,ESI
009b9ec2 : JZ 0x009b9f00
009b9ec4 : CMP EDI,0x4
009b9ec7 : JC 0x009b9f00
009b9ec9 : MOV EDX,dword ptr [ESI]
009b9ecb : SUB EDI,0x4
009b9ece : ADD ESI,0x4
009b9ed1 : MOV dword ptr [EBP + 0xfffff7f4],EDX
009b9ed7 : JZ 0x009b9f00
009b9ed9 : CMP EDI,0x2
009b9edc : JC 0x009b9f00
009b9ede : MOVZX EAX,word ptr [ESI]
009b9ee1 : TEST AX,AX
009b9ee4 : JL 0x009b9f00
009b9ee6 : CWDE
009b9ee7 : LEA ECX,[EAX + 0x2]
009b9eea : CMP EDI,ECX
009b9eec : JL 0x009b9f00
009b9eee : MOV EDX,0xfffffffe
009b9ef3 : SUB EDX,EAX
009b9ef5 : LEA ECX,[ESI + 0x2]
009b9ef8 : ADD EDI,EDX
009b9efa : LEA ESI,[ESI + EAX*0x1 + 0x2]
009b9efe : JMP 0x009b9f06
009b9f00 : XOR ECX,ECX
009b9f02 : XOR EDI,EDI
009b9f04 : XOR ESI,ESI
009b9f06 : LEA EAX,[EBP + 0xfffff7fc]
009b9f0c : LEA EDX,[EAX + 0x2]
009b9f0f : MOV dword ptr [EBP + 0xfffff7ec],EDX
009b9f15 : MOV DX,word ptr [EAX]
009b9f18 : ADD EAX,0x2
009b9f1b : TEST DX,DX
009b9f1e : JNZ 0x009b9f15
009b9f20 : SUB EAX,dword ptr [EBP + 0xfffff7ec]
009b9f26 : PUSH ECX
009b9f27 : MOV ECX,dword ptr [EBP + 0xfffff7f4]
009b9f2d : PUSH ECX
009b9f2e : SAR EAX,0x1
009b9f30 : LEA EDX,[EBP + EAX*0x2 + 0xfffff7fc]
009b9f37 : PUSH 0xc8e500
009b9f3c : PUSH EDX
009b9f3d : CALL dword ptr [0x00b85434]
009b9f43 : MOVZX EAX,byte ptr [EBX + 0xd]
009b9f47 : DEC EAX
009b9f48 : ADD ESP,0x10
009b9f4b : CMP dword ptr [EBP + 0xfffff7f8],EAX
009b9f51 : JZ 0x009b9f6c
009b9f53 : PUSH 0xc8e50c
009b9f58 : LEA ECX,[EBP + 0xfffff7fc]
009b9f5e : PUSH 0x400
009b9f63 : PUSH ECX
009b9f64 : CALL 0x006362c1
009b9f69 : ADD ESP,0xc
009b9f6c : MOV EAX,dword ptr [EBP + 0xfffff7f8]
009b9f72 : MOVZX EDX,byte ptr [EBX + 0xd]
009b9f76 : INC EAX
009b9f77 : CMP EAX,EDX
009b9f79 : MOV dword ptr [EBP + 0xfffff7f8],EAX
009b9f7f : JL 0x009b9ec0
009b9f85 : MOV EAX,dword ptr [EBP + 0xfffff7f0]
009b9f8b : INC dword ptr [EAX]
009b9f8d : MOV EAX,[0x00da9894]
009b9f92 : MOV ECX,dword ptr [EAX]
009b9f94 : MOV EAX,dword ptr [ECX + 0x114]
009b9f9a : LEA ECX,[EBP + 0xfffff7fc]
009b9fa0 : PUSH ECX
009b9fa1 : MOVZX ECX,byte ptr [EBX + 0xb]
009b9fa5 : PUSH ECX
009b9fa6 : MOVZX ECX,byte ptr [EBX + 0xa]
009b9faa : PUSH ECX
009b9fab : MOV ECX,dword ptr [EBX + 0x6]
009b9fae : MOV EDX,dword ptr [EAX]
009b9fb0 : PUSH ECX
009b9fb1 : MOVZX ECX,byte ptr [EBX + 0xd]
009b9fb5 : MOV EDX,dword ptr [EDX + 0x4]
009b9fb8 : PUSH ECX
009b9fb9 : MOVZX ECX,byte ptr [EBX + 0xc]
009b9fbd : PUSH ECX
009b9fbe : LEA ECX,[EBX + 0x12]
009b9fc1 : PUSH ECX
009b9fc2 : MOVZX ECX,word ptr [EBX + 0x4]
009b9fc6 : PUSH ECX
009b9fc7 : PUSH 0xc8e510
009b9fcc : PUSH 0xc8e52c
009b9fd1 : PUSH EAX
009b9fd2 : CALL EDX
009b9fd4 : MOV ECX,dword ptr [EBP + -0x4]
009b9fd7 : ADD ESP,0x2c
009b9fda : POP EDI
009b9fdb : POP ESI
009b9fdc : XOR ECX,EBP
009b9fde : POP EBX
009b9fdf : CALL 0x00633e6b
009b9fe4 : MOV ESP,EBP
009b9fe6 : POP EBP
009b9fe7 : RET 0x8

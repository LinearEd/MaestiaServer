PROGRAM  : Maestia.exe
FUNCTION : FUN_004360a0
ENTRY    : 004360a0
BODY     : [[004360a0, 0043619f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_004360a0(uint param_1,uint param_2,undefined4 param_3)

{
  uint uVar1;
  int in_ECX;
  int iVar2;
  uint uVar3;
  
  uVar1 = param_1;
  if (*(uint *)(in_ECX + 0x14) < param_1) {
    FUN_00622f07();
  }
  if (-*(int *)(in_ECX + 0x14) - 1U <= param_2) {
    FUN_00622ecf();
  }
  if (param_2 != 0) {
    uVar3 = *(int *)(in_ECX + 0x14) + param_2;
    if (uVar3 == 0xffffffff) {
      FUN_00622ecf();
    }
    if (*(uint *)(in_ECX + 0x18) < uVar3) {
      FUN_00404ef0(uVar3,*(undefined4 *)(in_ECX + 0x14));
    }
    else if (uVar3 == 0) {
      *(undefined4 *)(in_ECX + 0x14) = 0;
      if (*(uint *)(in_ECX + 0x18) < 0x10) {
        *(undefined1 *)(in_ECX + 4) = 0;
        return;
      }
      **(undefined1 **)(in_ECX + 4) = 0;
      return;
    }
    if (uVar3 != 0) {
      if (*(uint *)(in_ECX + 0x18) < 0x10) {
        param_1 = in_ECX + 4;
        iVar2 = in_ECX + 4;
      }
      else {
        param_1 = *(int *)(in_ECX + 4);
        iVar2 = *(int *)(in_ECX + 4);
      }
      _memmove_s((void *)(iVar2 + uVar1 + param_2),(*(uint *)(in_ECX + 0x18) - uVar1) - param_2,
                 (void *)(param_1 + uVar1),*(int *)(in_ECX + 0x14) - uVar1);
      FUN_00438ab0(uVar1,param_2,param_3);
      *(uint *)(in_ECX + 0x14) = uVar3;
      if (0xf < *(uint *)(in_ECX + 0x18)) {
        *(undefined1 *)(*(int *)(in_ECX + 4) + uVar3) = 0;
        return;
      }
      *(undefined1 *)(in_ECX + 4 + uVar3) = 0;
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
004360a0 : PUSH EBP
004360a1 : MOV EBP,ESP
004360a3 : PUSH EBX
004360a4 : PUSH ESI
004360a5 : PUSH EDI
004360a6 : MOV EDI,dword ptr [EBP + 0x8]
004360a9 : MOV ESI,ECX
004360ab : CMP dword ptr [ESI + 0x14],EDI
004360ae : JNC 0x004360b5
004360b0 : CALL 0x00622f07
004360b5 : MOV EBX,dword ptr [EBP + 0xc]
004360b8 : OR EAX,0xffffffff
004360bb : SUB EAX,dword ptr [ESI + 0x14]
004360be : CMP EAX,EBX
004360c0 : JA 0x004360c7
004360c2 : CALL 0x00622ecf
004360c7 : TEST EBX,EBX
004360c9 : JBE 0x00436197
004360cf : MOV EBX,dword ptr [ESI + 0x14]
004360d2 : ADD EBX,dword ptr [EBP + 0xc]
004360d5 : CMP EBX,-0x2
004360d8 : JBE 0x004360df
004360da : CALL 0x00622ecf
004360df : MOV EAX,dword ptr [ESI + 0x18]
004360e2 : CMP EAX,EBX
004360e4 : JNC 0x0043610a
004360e6 : MOV ECX,dword ptr [ESI + 0x14]
004360e9 : PUSH ECX
004360ea : PUSH EBX
004360eb : MOV ECX,ESI
004360ed : CALL 0x00404ef0
004360f2 : TEST EBX,EBX
004360f4 : JBE 0x00436197
004360fa : MOV EAX,dword ptr [ESI + 0x18]
004360fd : CMP EAX,0x10
00436100 : JC 0x00436133
00436102 : MOV EDX,dword ptr [ESI + 0x4]
00436105 : MOV dword ptr [EBP + 0x8],EDX
00436108 : JMP 0x00436139
0043610a : TEST EBX,EBX
0043610c : JNZ 0x004360f4
0043610e : MOV dword ptr [ESI + 0x14],EBX
00436111 : CMP EAX,0x10
00436114 : JC 0x00436124
00436116 : MOV EAX,dword ptr [ESI + 0x4]
00436119 : MOV byte ptr [EAX],BL
0043611b : POP EDI
0043611c : MOV EAX,ESI
0043611e : POP ESI
0043611f : POP EBX
00436120 : POP EBP
00436121 : RET 0xc
00436124 : LEA EAX,[ESI + 0x4]
00436127 : POP EDI
00436128 : MOV byte ptr [EAX],0x0
0043612b : MOV EAX,ESI
0043612d : POP ESI
0043612e : POP EBX
0043612f : POP EBP
00436130 : RET 0xc
00436133 : LEA ECX,[ESI + 0x4]
00436136 : MOV dword ptr [EBP + 0x8],ECX
00436139 : CMP EAX,0x10
0043613c : JC 0x00436143
0043613e : MOV ECX,dword ptr [ESI + 0x4]
00436141 : JMP 0x00436146
00436143 : LEA ECX,[ESI + 0x4]
00436146 : MOV EDX,dword ptr [ESI + 0x14]
00436149 : SUB EDX,EDI
0043614b : PUSH EDX
0043614c : MOV EDX,dword ptr [EBP + 0x8]
0043614f : ADD EDX,EDI
00436151 : PUSH EDX
00436152 : MOV EDX,dword ptr [EBP + 0xc]
00436155 : SUB EAX,EDI
00436157 : SUB EAX,EDX
00436159 : ADD ECX,EDI
0043615b : PUSH EAX
0043615c : ADD ECX,EDX
0043615e : PUSH ECX
0043615f : CALL 0x00634101
00436164 : MOV EAX,dword ptr [EBP + 0x10]
00436167 : MOV ECX,dword ptr [EBP + 0xc]
0043616a : ADD ESP,0x10
0043616d : PUSH EAX
0043616e : PUSH ECX
0043616f : PUSH EDI
00436170 : MOV ECX,ESI
00436172 : CALL 0x00438ab0
00436177 : CMP dword ptr [ESI + 0x18],0x10
0043617b : MOV dword ptr [ESI + 0x14],EBX
0043617e : JC 0x00436190
00436180 : MOV EAX,dword ptr [ESI + 0x4]
00436183 : MOV byte ptr [EAX + EBX*0x1],0x0
00436187 : POP EDI
00436188 : MOV EAX,ESI
0043618a : POP ESI
0043618b : POP EBX
0043618c : POP EBP
0043618d : RET 0xc
00436190 : LEA EAX,[ESI + 0x4]
00436193 : MOV byte ptr [EAX + EBX*0x1],0x0
00436197 : POP EDI
00436198 : MOV EAX,ESI
0043619a : POP ESI
0043619b : POP EBX
0043619c : POP EBP
0043619d : RET 0xc

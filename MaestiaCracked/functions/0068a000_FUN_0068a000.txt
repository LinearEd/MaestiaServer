PROGRAM  : Maestia.exe
FUNCTION : FUN_0068a000
ENTRY    : 0068a000
BODY     : [[0068a000, 0068a00c] [0068a010, 0068a09e]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 *
FUN_0068a000(undefined4 *param_1,undefined4 param_2,char *param_3,undefined4 *param_4,
            undefined4 *param_5)

{
  char cVar1;
  char *_Src;
  char *pcVar2;
  size_t _Size;
  void *_Dst;
  
  _Src = param_3;
  pcVar2 = param_3;
  do {
    cVar1 = *pcVar2;
    pcVar2 = pcVar2 + 1;
  } while (cVar1 != '\0');
  _Size = (int)pcVar2 - (int)(param_3 + 1);
  if (0x7fffffff < (int)(_Size + 0x12)) {
    return (undefined4 *)0xa;
  }
  _Dst = (void *)FUN_00688c00(*param_1,_Size + 0x12,&param_1);
  if (param_1 == (undefined4 *)0x0) {
    _memcpy(_Dst,_Src,_Size);
    builtin_strncpy((char *)((int)_Dst + _Size),"/..n",4);
    builtin_strncpy((char *)((int)_Dst + _Size + 4),"amed",4);
    builtin_strncpy((char *)((int)_Dst + _Size + 8),"fork",4);
    builtin_strncpy((char *)((int)_Dst + _Size + 0xc),"/rsr",4);
    *(undefined2 *)((int)_Dst + _Size + 0x10) = 99;
    *param_4 = _Dst;
    *param_5 = 0;
    param_1 = (undefined4 *)0x0;
  }
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
0068a000 : PUSH EBX
0068a001 : MOV EBX,dword ptr [ESP + 0x10]
0068a005 : MOV EAX,EBX
0068a007 : PUSH EDI
0068a008 : LEA EDX,[EAX + 0x1]
0068a00b : JMP 0x0068a010
0068a010 : MOV CL,byte ptr [EAX]
0068a012 : INC EAX
0068a013 : TEST CL,CL
0068a015 : JNZ 0x0068a010
0068a017 : SUB EAX,EDX
0068a019 : MOV EDI,EAX
0068a01b : MOV EAX,dword ptr [ESP + 0xc]
0068a01f : MOV ECX,dword ptr [EAX]
0068a021 : LEA EAX,[EDI + 0x12]
0068a024 : CMP EAX,0x7fffffff
0068a029 : JLE 0x0068a033
0068a02b : POP EDI
0068a02c : MOV EAX,0xa
0068a031 : POP EBX
0068a032 : RET
0068a033 : PUSH ESI
0068a034 : LEA EDX,[ESP + 0x10]
0068a038 : PUSH EDX
0068a039 : PUSH EAX
0068a03a : PUSH ECX
0068a03b : CALL 0x00688c00
0068a040 : MOV ESI,EAX
0068a042 : MOV EAX,dword ptr [ESP + 0x1c]
0068a046 : ADD ESP,0xc
0068a049 : TEST EAX,EAX
0068a04b : JNZ 0x0068a09b
0068a04d : PUSH EDI
0068a04e : PUSH EBX
0068a04f : PUSH ESI
0068a050 : CALL 0x0063ae40
0068a055 : MOV EAX,[0x00bd851c]
0068a05a : MOV dword ptr [ESI + EDI*0x1],EAX
0068a05d : MOV ECX,dword ptr [0x00bd8520]
0068a063 : MOV dword ptr [ESI + EDI*0x1 + 0x4],ECX
0068a067 : MOV EDX,dword ptr [0x00bd8524]
0068a06d : MOV dword ptr [ESI + EDI*0x1 + 0x8],EDX
0068a071 : MOV EAX,[0x00bd8528]
0068a076 : MOV EDX,dword ptr [ESP + 0x28]
0068a07a : MOV dword ptr [ESI + EDI*0x1 + 0xc],EAX
0068a07e : MOV CX,word ptr [0x00bd852c]
0068a085 : MOV EAX,dword ptr [ESP + 0x2c]
0068a089 : MOV word ptr [ESI + EDI*0x1 + 0x10],CX
0068a08e : MOV dword ptr [EDX],ESI
0068a090 : ADD ESP,0xc
0068a093 : MOV dword ptr [EAX],0x0
0068a099 : XOR EAX,EAX
0068a09b : POP ESI
0068a09c : POP EDI
0068a09d : POP EBX
0068a09e : RET

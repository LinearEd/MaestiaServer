PROGRAM  : Maestia.exe
FUNCTION : FUN_007b41a0
ENTRY    : 007b41a0
BODY     : [[007b41a0, 007b4335]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_007b41a0(int *param_1,undefined4 *param_2)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint *in_ECX;
  uint *puVar4;
  uint *unaff_ESI;
  
  uVar1 = *in_ECX;
  if ((uVar1 & 2) != 0) {
    param_1[2] = in_ECX[1];
  }
  if ((uVar1 & 4) != 0) {
    param_1[1] = in_ECX[2];
  }
  uVar3 = in_ECX[3];
  if ((uVar1 & 8) == 0) {
    if ((uVar1 & 0x80000) == 0) goto LAB_007b41ef;
    uVar3 = (uVar3 / (uint)param_1[2]) * 4;
  }
  param_1[3] = uVar3;
LAB_007b41ef:
  if ((uVar1 & 0x20000) != 0) {
    param_1[6] = in_ECX[5];
  }
  if ((uVar1 & 0x1000) == 0) {
    puVar4 = in_ECX + 0x19;
  }
  else {
    if (in_ECX[0x11] != 0x20) {
      return 0;
    }
    uVar3 = in_ECX[0x12];
    uVar2 = in_ECX[0x13];
    puVar4 = in_ECX + 0x14;
    if ((uVar3 & 4) == 0) {
      if ((uVar3 & 0x42) != 0) {
        uVar2 = *puVar4;
        if (unaff_ESI != (uint *)0x0) {
          *unaff_ESI = uVar2;
        }
        if (uVar2 == 8) {
          if ((uVar3 & 2) == 0) {
            return 0;
          }
          *param_1 = 9;
        }
        else if (uVar2 == 0x18) {
          *param_1 = 2;
        }
        else {
          if (uVar2 != 0x20) {
            return 0;
          }
          *param_1 = 1;
        }
        if ((uVar1 & 8) == 0) {
          param_1[3] = (uVar2 >> 3) * param_1[1];
        }
        if (unaff_ESI != (uint *)0x0) {
          unaff_ESI[1] = in_ECX[0x15];
        }
        if (unaff_ESI != (uint *)0x0) {
          unaff_ESI[2] = in_ECX[0x16];
        }
        if (unaff_ESI != (uint *)0x0) {
          unaff_ESI[3] = in_ECX[0x17];
        }
        uVar1 = in_ECX[0x18];
        puVar4 = in_ECX + 0x19;
        if ((unaff_ESI != (uint *)0x0) && ((uVar3 & 1) != 0)) {
          unaff_ESI[4] = uVar1;
          *(undefined1 *)(unaff_ESI + 5) = 1;
        }
        if ((uVar1 == 0) && (uVar2 == 0x20)) {
          return 0;
        }
      }
    }
    else if (uVar2 == 0x35545844) {
      *param_1 = 0xc;
      puVar4 = in_ECX + 0x19;
    }
    else if (uVar2 == 0x33545844) {
      *param_1 = 0xb;
      puVar4 = in_ECX + 0x19;
    }
    else {
      if (uVar2 == 0x31545844) {
        *param_1 = 10;
      }
      puVar4 = in_ECX + 0x19;
    }
    if (*param_1 == 0) {
      return 0;
    }
  }
  if (param_2 != (undefined4 *)0x0) {
    *param_2 = puVar4 + 5;
  }
  return 1;
}



============================================================
DISASSEMBLY
============================================================
007b41a0 : PUSH EBP
007b41a1 : MOV EBP,ESP
007b41a3 : PUSH ECX
007b41a4 : MOV EAX,dword ptr [ECX + 0x4]
007b41a7 : PUSH EBX
007b41a8 : MOV EBX,dword ptr [ECX]
007b41aa : ADD ECX,0x4
007b41ad : ADD ECX,0x4
007b41b0 : PUSH EDI
007b41b1 : MOV EDI,dword ptr [EBP + 0x8]
007b41b4 : TEST BL,0x2
007b41b7 : JZ 0x007b41bc
007b41b9 : MOV dword ptr [EDI + 0x8],EAX
007b41bc : MOV EAX,dword ptr [ECX]
007b41be : ADD ECX,0x4
007b41c1 : TEST BL,0x4
007b41c4 : JZ 0x007b41c9
007b41c6 : MOV dword ptr [EDI + 0x4],EAX
007b41c9 : MOV EAX,dword ptr [ECX]
007b41cb : MOV EDX,EBX
007b41cd : ADD ECX,0x4
007b41d0 : AND EDX,0x8
007b41d3 : MOV dword ptr [EBP + -0x4],EDX
007b41d6 : JNZ 0x007b41ec
007b41d8 : TEST EBX,0x80000
007b41de : JZ 0x007b41ef
007b41e0 : XOR EDX,EDX
007b41e2 : DIV dword ptr [EDI + 0x8]
007b41e5 : MOV EDX,dword ptr [EBP + -0x4]
007b41e8 : ADD EAX,EAX
007b41ea : ADD EAX,EAX
007b41ec : MOV dword ptr [EDI + 0xc],EAX
007b41ef : MOV EAX,dword ptr [ECX + 0x4]
007b41f2 : ADD ECX,0x4
007b41f5 : ADD ECX,0x4
007b41f8 : TEST EBX,0x20000
007b41fe : JZ 0x007b4203
007b4200 : MOV dword ptr [EDI + 0x18],EAX
007b4203 : ADD ECX,0x2c
007b4206 : TEST EBX,0x1000
007b420c : JZ 0x007b431f
007b4212 : MOV EAX,dword ptr [ECX]
007b4214 : ADD ECX,0x4
007b4217 : CMP EAX,0x20
007b421a : JNZ 0x007b4317
007b4220 : MOV EBX,dword ptr [ECX]
007b4222 : MOV EAX,dword ptr [ECX + 0x4]
007b4225 : ADD ECX,0x4
007b4228 : ADD ECX,0x4
007b422b : TEST BL,0x4
007b422e : JZ 0x007b426f
007b4230 : CMP EAX,0x35545844
007b4235 : JNZ 0x007b4245
007b4237 : MOV dword ptr [EDI],0xc
007b423d : ADD ECX,0x14
007b4240 : JMP 0x007b4312
007b4245 : CMP EAX,0x33545844
007b424a : JNZ 0x007b425a
007b424c : MOV dword ptr [EDI],0xb
007b4252 : ADD ECX,0x14
007b4255 : JMP 0x007b4312
007b425a : CMP EAX,0x31545844
007b425f : JNZ 0x007b4267
007b4261 : MOV dword ptr [EDI],0xa
007b4267 : ADD ECX,0x14
007b426a : JMP 0x007b4312
007b426f : TEST BL,0x42
007b4272 : JZ 0x007b4312
007b4278 : MOV EDI,dword ptr [ECX]
007b427a : ADD ECX,0x4
007b427d : TEST ESI,ESI
007b427f : JZ 0x007b4283
007b4281 : MOV dword ptr [ESI],EDI
007b4283 : CMP EDI,0x8
007b4286 : JZ 0x007b42ac
007b4288 : CMP EDI,0x18
007b428b : JZ 0x007b42a1
007b428d : CMP EDI,0x20
007b4290 : JNZ 0x007b4317
007b4296 : MOV EAX,dword ptr [EBP + 0x8]
007b4299 : MOV dword ptr [EAX],0x1
007b429f : JMP 0x007b42ba
007b42a1 : MOV EAX,dword ptr [EBP + 0x8]
007b42a4 : MOV dword ptr [EAX],0x2
007b42aa : JMP 0x007b42ba
007b42ac : TEST BL,0x2
007b42af : JZ 0x007b4317
007b42b1 : MOV EAX,dword ptr [EBP + 0x8]
007b42b4 : MOV dword ptr [EAX],0x9
007b42ba : TEST EDX,EDX
007b42bc : JNZ 0x007b42cd
007b42be : MOV EAX,dword ptr [EBP + 0x8]
007b42c1 : MOV EDX,EDI
007b42c3 : SHR EDX,0x3
007b42c6 : IMUL EDX,dword ptr [EAX + 0x4]
007b42ca : MOV dword ptr [EAX + 0xc],EDX
007b42cd : MOV EAX,dword ptr [ECX]
007b42cf : ADD ECX,0x4
007b42d2 : TEST ESI,ESI
007b42d4 : JZ 0x007b42d9
007b42d6 : MOV dword ptr [ESI + 0x4],EAX
007b42d9 : MOV EAX,dword ptr [ECX]
007b42db : ADD ECX,0x4
007b42de : TEST ESI,ESI
007b42e0 : JZ 0x007b42e5
007b42e2 : MOV dword ptr [ESI + 0x8],EAX
007b42e5 : MOV EAX,dword ptr [ECX]
007b42e7 : ADD ECX,0x4
007b42ea : TEST ESI,ESI
007b42ec : JZ 0x007b42f1
007b42ee : MOV dword ptr [ESI + 0xc],EAX
007b42f1 : MOV EAX,dword ptr [ECX]
007b42f3 : ADD ECX,0x4
007b42f6 : TEST ESI,ESI
007b42f8 : JZ 0x007b4306
007b42fa : TEST BL,0x1
007b42fd : JZ 0x007b4306
007b42ff : MOV dword ptr [ESI + 0x10],EAX
007b4302 : MOV byte ptr [ESI + 0x14],0x1
007b4306 : TEST EAX,EAX
007b4308 : JNZ 0x007b430f
007b430a : CMP EDI,0x20
007b430d : JZ 0x007b4317
007b430f : MOV EDI,dword ptr [EBP + 0x8]
007b4312 : CMP dword ptr [EDI],0x0
007b4315 : JNZ 0x007b4322
007b4317 : POP EDI
007b4318 : XOR AL,AL
007b431a : POP EBX
007b431b : MOV ESP,EBP
007b431d : POP EBP
007b431e : RET
007b431f : ADD ECX,0x20
007b4322 : MOV EAX,dword ptr [EBP + 0xc]
007b4325 : TEST EAX,EAX
007b4327 : JZ 0x007b432e
007b4329 : ADD ECX,0x14
007b432c : MOV dword ptr [EAX],ECX
007b432e : POP EDI
007b432f : MOV AL,0x1
007b4331 : POP EBX
007b4332 : MOV ESP,EBP
007b4334 : POP EBP
007b4335 : RET

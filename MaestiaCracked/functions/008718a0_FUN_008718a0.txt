PROGRAM  : Maestia.exe
FUNCTION : FUN_008718a0
ENTRY    : 008718a0
BODY     : [[008718a0, 00872040]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008718a0(int param_1)

{
  short *psVar1;
  char cVar2;
  short sVar3;
  uint uVar4;
  int iVar5;
  undefined4 uVar6;
  int iVar7;
  int *in_ECX;
  int iVar8;
  undefined8 uVar9;
  undefined1 auStack_ac [3];
  undefined1 uStack_a9;
  int local_a8;
  uint local_a4 [2];
  int local_9c;
  int iStack_98;
  undefined1 auStack_94 [4];
  int iStack_90;
  undefined1 local_70 [4];
  undefined2 local_6c;
  undefined4 local_5c;
  uint local_58;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b4925e;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_ac;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xffffff48;
  ExceptionList = &local_14;
  if (in_ECX[0x110] == 0) {
    FUN_00406460(L"AniTable NULL");
    local_c = 0;
    if ((int *)*DAT_00da98e8 != (int *)0x0) {
      (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                (L"AvaMyCharacter::SetLeftHandWeaponType",0x41c,local_70,uVar4);
    }
    local_c = 0xffffffff;
    if (7 < local_58) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_58 = 7;
    local_5c = 0;
    local_6c = 0;
    goto LAB_0087201b;
  }
  local_9c = in_ECX[0x61c];
  if (local_9c == 0) goto LAB_0087201b;
  FUN_00856ef0(param_1);
  local_a4[0] = 0;
  iVar5 = FUN_004049b0(param_1);
  iVar7 = local_9c;
  if ((param_1 == 0) || (iVar5 == 0)) {
    in_ECX[0x69d] = 0;
    FUN_0084faa0();
    *(undefined4 *)(iVar7 + 0x160) = 0;
    iVar7 = FUN_004049b0(in_ECX[2]);
    iVar7 = *(int *)(iVar7 + 300);
    if (iVar7 != 0) {
      FUN_00406460(&DAT_00c42514);
      local_c = 8;
      FUN_00406460(&DAT_00c42518);
      local_c = CONCAT31(local_c._1_3_,9);
      local_a8 = (**(code **)(*(int *)(iVar7 + 0x1f8) + 4))();
      while (local_a8 != 0) {
        iVar7 = FUN_004f5680();
        sVar3 = *(short *)(iVar7 + 0x18);
        if ((((sVar3 == 3) || (sVar3 == 4)) || (sVar3 == 5)) || (sVar3 == 0xb)) {
          FUN_0088cc50(sVar3,iVar7);
        }
      }
      local_c._1_3_ = (undefined3)((uint)local_c >> 8);
      local_c = CONCAT31(local_c._1_3_,8);
      FUN_00406560();
      local_c = 0xffffffff;
      FUN_00406560();
    }
    if ((short)in_ECX[0x10f] == 6) {
      if (*(int *)(in_ECX[0x5fc] + 0x160) == 0) {
        local_a4[0] = 0;
        *(undefined2 *)(in_ECX + 0x10f) = 0;
      }
      else {
        local_a4[0] = 4;
        *(undefined2 *)(in_ECX + 0x10f) = 4;
      }
    }
  }
  else {
    in_ECX[0x69d] = *(int *)(iVar5 + 0x29c);
    local_a4[0] = (uint)*(ushort *)(iVar5 + 0x28a);
    local_58 = 7;
    local_5c = 0;
    local_6c = 0;
    local_c = 1;
    local_a8 = 0;
    if ((in_ECX[0x617] == 0) ||
       (local_a8 = FUN_004049b0(*(undefined4 *)(in_ECX[0x617] + 0x28)), local_a8 == 0)) {
      uVar6 = FUN_00404350(iVar5 + 400);
      local_c._0_1_ = 4;
      FUN_00405eb0(uVar6,0,0xffffffff);
      local_c._0_1_ = 1;
      FUN_00406560();
      uVar6 = FUN_00404350(iVar5 + 0x1d0);
      local_c._0_1_ = 5;
    }
    else {
      uVar6 = FUN_00404350(local_a8 + 400);
      local_c._0_1_ = 2;
      FUN_00405eb0(uVar6,0,0xffffffff);
      local_c._0_1_ = 1;
      FUN_00406560();
      uVar6 = FUN_00404350(local_a8 + 0x1d0);
      local_c._0_1_ = 3;
    }
    FUN_00405eb0(uVar6,0,0xffffffff);
    local_c = CONCAT31(local_c._1_3_,1);
    FUN_00406560();
    cVar2 = *(char *)(iVar5 + 0x288);
    if (((cVar2 == '\x02') || (cVar2 == '\x05')) ||
       ((cVar2 == '\b' ||
        ((((cVar2 == '\t' || (cVar2 == '\v')) || (cVar2 == '\r')) || (cVar2 == '\x0e')))))) {
      FUN_0084fb70();
    }
    iVar7 = local_9c;
    FUN_0084fce0(local_a4[0] & 0xffff);
    *(undefined1 *)(iVar7 + 0x1a8) = 0;
    if (*(int **)(iVar7 + 0x168) != (int *)0x0) {
      (**(code **)(**(int **)(iVar7 + 0x168) + 0x10))(0);
    }
    if (*(int **)(iVar7 + 0x16c) != (int *)0x0) {
      (**(code **)(**(int **)(iVar7 + 0x16c) + 0x10))(0);
    }
    (**(code **)(*in_ECX + 0x49c))(local_a4[0],0);
    local_a4[0] = (**(code **)(*(int *)(iVar5 + 0x210) + 4))();
    FUN_00406460(&DAT_00c4250c);
    local_c._0_1_ = 6;
    FUN_00406460(&DAT_00c42510);
    local_c = CONCAT31(local_c._1_3_,7);
    iVar7 = local_9c;
    while (local_9c = iVar7, local_a4[0] != 0) {
      iVar7 = FUN_004f5680();
      FUN_0088ccd0(*(undefined2 *)(iVar7 + 0x18),iVar7);
      iVar7 = local_9c;
    }
    local_a4[0] = (uint)*(ushort *)(iVar5 + 0x28a);
    if (*(ushort *)(iVar5 + 0x28a) == 4) {
      local_a4[0] = 6;
      *(undefined2 *)(in_ECX + 0x10f) = 6;
    }
    *(uint *)(iVar7 + 0x160) = local_a4[0];
    if (local_a8 == 0) {
      (**(code **)(*in_ECX + 0x45c))(iVar5,param_1,local_a4[0]);
    }
    FUN_0084c320((char)in_ECX[0x663]);
    if ((char)in_ECX[0x663] != '\0') {
      *(undefined1 *)(iVar7 + 0x1a8) = 0;
      if (*(int **)(iVar7 + 0x168) != (int *)0x0) {
        (**(code **)(**(int **)(iVar7 + 0x168) + 0x10))(0);
      }
      if (*(int **)(iVar7 + 0x16c) != (int *)0x0) {
        (**(code **)(**(int **)(iVar7 + 0x16c) + 0x10))(0);
      }
    }
    local_c._0_1_ = 6;
    FUN_00406560();
    local_c = CONCAT31(local_c._1_3_,1);
    FUN_00406560();
    local_c = 0xffffffff;
    FUN_00406560();
  }
  FUN_00404a20(auStack_94);
  local_c._0_1_ = 10;
  local_c._1_3_ = 0;
  psVar1 = (short *)((int)in_ECX + 0x43a);
  local_a8 = FUN_0088cdd0(psVar1,&uStack_a9,0,0);
  if ((in_ECX[0x62a] == 0) || (*(char *)(in_ECX[0x62a] + 0x20) == '\0')) {
    if (local_a8 == 4) {
      FUN_00abdd00(&local_9c,local_a4[0],*psVar1 + 1000,0);
      local_c._0_1_ = 0xd;
      FUN_00463a60();
      local_c._0_1_ = 10;
      FUN_0040ed80(&local_9c);
      if (iStack_90 != 0) goto LAB_00871f6a;
      FUN_00abdd00(&local_9c,local_a4[0],*(undefined2 *)((int)in_ECX + 0x43a),0);
      local_c._0_1_ = 0xe;
      FUN_00463a60();
    }
    else {
      FUN_00abdd00(&local_9c,local_a4[0],*psVar1,0);
      local_c._0_1_ = 0xf;
      FUN_00463a60();
    }
LAB_00871f65:
    local_c._0_1_ = 10;
    FUN_0040ed80(&local_9c);
  }
  else {
    uVar9 = FUN_0083ac80();
    if ((short)uVar9 != 0) {
      *psVar1 = (short)uVar9;
      uStack_a9 = 0;
      FUN_00abe000(&local_9c,*(undefined4 *)((int)((ulonglong)uVar9 >> 0x20) + 0x24),
                   (uint)uVar9 & 0xffff,(short)in_ECX[0x1f],1);
      local_c._0_1_ = 0xb;
      if (iStack_98 == 0) {
        FUN_00abe000(local_a4,(short)in_ECX[0x10f],*psVar1,(short)in_ECX[0x1f],0);
        local_c._0_1_ = 0xc;
        FUN_00463a60();
        local_c._0_1_ = 0xb;
        FUN_0040ed80(local_a4);
      }
      goto LAB_00871f65;
    }
  }
LAB_00871f6a:
  iVar7 = 0;
  if (local_a8 == 4) {
    iVar7 = 1;
  }
  else if (local_a8 == 3) {
    iVar7 = 2;
  }
  iVar5 = in_ECX[0x104];
  local_9c = CONCAT31(local_9c._1_3_,*(undefined1 *)(iVar7 * 0x30 + 0xb0 + iVar5));
  iVar8 = (iVar7 * 3 + 9) * 0x10;
  local_a4[0] = *(uint *)(iVar8 + iVar5);
  FUN_0079d530(iVar5,auStack_94,*(undefined2 *)((int)in_ECX + 0x43a),local_a8,0,local_9c,0x3f800000,
               0x3f800000);
  *(uint *)(in_ECX[0x104] + iVar8) = local_a4[0];
  *(undefined1 *)(in_ECX[0x104] + 0xb6 + iVar7 * 0x30) = 1;
  (**(code **)(*(int *)in_ECX[0x104] + 0x10))();
  local_c = 0xffffffff;
  FUN_0040ed80(auStack_94);
LAB_0087201b:
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_ac);
  return;
}



============================================================
DISASSEMBLY
============================================================
008718a0 : PUSH EBP
008718a1 : MOV EBP,ESP
008718a3 : AND ESP,0xfffffff8
008718a6 : PUSH -0x1
008718a8 : PUSH 0xb4925e
008718ad : MOV EAX,FS:[0x0]
008718b3 : PUSH EAX
008718b4 : SUB ESP,0x98
008718ba : MOV EAX,[0x00d66fa0]
008718bf : XOR EAX,ESP
008718c1 : MOV dword ptr [ESP + 0x90],EAX
008718c8 : PUSH EBX
008718c9 : PUSH ESI
008718ca : PUSH EDI
008718cb : MOV EAX,[0x00d66fa0]
008718d0 : XOR EAX,ESP
008718d2 : PUSH EAX
008718d3 : LEA EAX,[ESP + 0xa8]
008718da : MOV FS:[0x0],EAX
008718e0 : MOV EBX,ECX
008718e2 : XOR ESI,ESI
008718e4 : CMP dword ptr [EBX + 0x440],ESI
008718ea : JNZ 0x00871955
008718ec : PUSH 0xc424a4
008718f1 : LEA ECX,[ESP + 0x50]
008718f5 : CALL 0x00406460
008718fa : MOV dword ptr [ESP + 0xb0],ESI
00871901 : MOV EAX,[0x00da98e8]
00871906 : MOV ECX,dword ptr [EAX]
00871908 : CMP ECX,ESI
0087190a : JZ 0x00871922
0087190c : MOV EDX,dword ptr [ECX]
0087190e : MOV EDX,dword ptr [EDX + 0x14]
00871911 : LEA EAX,[ESP + 0x4c]
00871915 : PUSH EAX
00871916 : PUSH 0x41c
0087191b : PUSH 0xc424c0
00871920 : CALL EDX
00871922 : MOV dword ptr [ESP + 0xb0],0xffffffff
0087192d : CMP dword ptr [ESP + 0x64],0x8
00871932 : JC 0x0087193d
00871934 : MOV ECX,dword ptr [ESP + 0x50]
00871938 : CALL 0x006f04e0
0087193d : XOR EAX,EAX
0087193f : MOV dword ptr [ESP + 0x64],0x7
00871947 : MOV dword ptr [ESP + 0x60],ESI
0087194b : MOV word ptr [ESP + 0x50],AX
00871950 : JMP 0x0087201b
00871955 : MOV EAX,dword ptr [EBX + 0x1870]
0087195b : MOV dword ptr [ESP + 0x20],EAX
0087195f : CMP EAX,ESI
00871961 : JZ 0x0087201b
00871967 : MOV EDI,dword ptr [EBP + 0x8]
0087196a : PUSH EDI
0087196b : MOV ESI,EBX
0087196d : CALL 0x00856ef0
00871972 : PUSH EDI
00871973 : MOV dword ptr [ESP + 0x1c],0x0
0087197b : CALL 0x004049b0
00871980 : XOR ESI,ESI
00871982 : ADD ESP,0x4
00871985 : MOV EDI,EAX
00871987 : CMP dword ptr [EBP + 0x8],ESI
0087198a : JZ 0x00871c84
00871990 : CMP EDI,ESI
00871992 : JZ 0x00871c84
00871998 : MOV EAX,dword ptr [EDI + 0x29c]
0087199e : MOV dword ptr [EBX + 0x1a74],EAX
008719a4 : MOVZX ECX,word ptr [EDI + 0x28a]
008719ab : XOR EDX,EDX
008719ad : MOV dword ptr [ESP + 0x18],ECX
008719b1 : MOV dword ptr [ESP + 0x64],0x7
008719b9 : MOV dword ptr [ESP + 0x60],ESI
008719bd : MOV word ptr [ESP + 0x50],DX
008719c2 : MOV dword ptr [ESP + 0xb0],0x1
008719cd : MOV EAX,dword ptr [EBX + 0x185c]
008719d3 : MOV dword ptr [ESP + 0x14],ESI
008719d7 : CMP EAX,ESI
008719d9 : JZ 0x00871a47
008719db : MOV EAX,dword ptr [EAX + 0x28]
008719de : PUSH EAX
008719df : CALL 0x004049b0
008719e4 : ADD ESP,0x4
008719e7 : MOV dword ptr [ESP + 0x14],EAX
008719eb : CMP EAX,ESI
008719ed : JZ 0x00871a47
008719ef : ADD EAX,0x190
008719f4 : PUSH EAX
008719f5 : LEA ESI,[ESP + 0x34]
008719f9 : CALL 0x00404350
008719fe : ADD ESP,0x4
00871a01 : MOV byte ptr [ESP + 0xb0],0x2
00871a09 : PUSH -0x1
00871a0b : PUSH 0x0
00871a0d : PUSH EAX
00871a0e : LEA ECX,[ESP + 0x58]
00871a12 : CALL 0x00405eb0
00871a17 : MOV byte ptr [ESP + 0xb0],0x1
00871a1f : MOV ECX,ESI
00871a21 : CALL 0x00406560
00871a26 : MOV ECX,dword ptr [ESP + 0x14]
00871a2a : ADD ECX,0x1d0
00871a30 : PUSH ECX
00871a31 : LEA ESI,[ESP + 0x34]
00871a35 : CALL 0x00404350
00871a3a : ADD ESP,0x4
00871a3d : MOV byte ptr [ESP + 0xb0],0x3
00871a45 : JMP 0x00871a9a
00871a47 : LEA EDX,[EDI + 0x190]
00871a4d : PUSH EDX
00871a4e : LEA ESI,[ESP + 0x34]
00871a52 : CALL 0x00404350
00871a57 : ADD ESP,0x4
00871a5a : MOV byte ptr [ESP + 0xb0],0x4
00871a62 : PUSH -0x1
00871a64 : PUSH 0x0
00871a66 : PUSH EAX
00871a67 : LEA ECX,[ESP + 0x58]
00871a6b : CALL 0x00405eb0
00871a70 : MOV byte ptr [ESP + 0xb0],0x1
00871a78 : MOV ECX,ESI
00871a7a : CALL 0x00406560
00871a7f : LEA EAX,[EDI + 0x1d0]
00871a85 : PUSH EAX
00871a86 : LEA ESI,[ESP + 0x34]
00871a8a : CALL 0x00404350
00871a8f : ADD ESP,0x4
00871a92 : MOV byte ptr [ESP + 0xb0],0x5
00871a9a : MOV ECX,dword ptr [ESP + 0x20]
00871a9e : PUSH -0x1
00871aa0 : PUSH 0x0
00871aa2 : PUSH EAX
00871aa3 : ADD ECX,0x170
00871aa9 : CALL 0x00405eb0
00871aae : MOV byte ptr [ESP + 0xb0],0x1
00871ab6 : LEA ECX,[ESP + 0x30]
00871aba : CALL 0x00406560
00871abf : MOV AL,byte ptr [EDI + 0x288]
00871ac5 : MOV ESI,dword ptr [EBX + 0x17f0]
00871acb : CMP AL,0x2
00871acd : JZ 0x00871ae7
00871acf : CMP AL,0x5
00871ad1 : JZ 0x00871ae7
00871ad3 : CMP AL,0x8
00871ad5 : JZ 0x00871ae7
00871ad7 : CMP AL,0x9
00871ad9 : JZ 0x00871ae7
00871adb : CMP AL,0xb
00871add : JZ 0x00871ae7
00871adf : CMP AL,0xd
00871ae1 : JZ 0x00871ae7
00871ae3 : CMP AL,0xe
00871ae5 : JNZ 0x00871aec
00871ae7 : CALL 0x0084fb70
00871aec : MOVZX ECX,word ptr [ESP + 0x18]
00871af1 : MOV ESI,dword ptr [ESP + 0x20]
00871af5 : PUSH ECX
00871af6 : LEA EAX,[ESP + 0x50]
00871afa : CALL 0x0084fce0
00871aff : MOV ECX,dword ptr [ESI + 0x168]
00871b05 : MOV byte ptr [ESI + 0x1a8],0x0
00871b0c : TEST ECX,ECX
00871b0e : JZ 0x00871b19
00871b10 : MOV EDX,dword ptr [ECX]
00871b12 : MOV EAX,dword ptr [EDX + 0x10]
00871b15 : PUSH 0x0
00871b17 : CALL EAX
00871b19 : MOV ECX,dword ptr [ESI + 0x16c]
00871b1f : TEST ECX,ECX
00871b21 : JZ 0x00871b2c
00871b23 : MOV EDX,dword ptr [ECX]
00871b25 : MOV EAX,dword ptr [EDX + 0x10]
00871b28 : PUSH 0x0
00871b2a : CALL EAX
00871b2c : MOV EDX,dword ptr [EBX]
00871b2e : MOV EAX,dword ptr [ESP + 0x18]
00871b32 : MOV EDX,dword ptr [EDX + 0x49c]
00871b38 : PUSH 0x0
00871b3a : PUSH EAX
00871b3b : MOV ECX,EBX
00871b3d : CALL EDX
00871b3f : MOV EAX,dword ptr [EDI + 0x210]
00871b45 : MOV EDX,dword ptr [EAX + 0x4]
00871b48 : LEA ESI,[EDI + 0x210]
00871b4e : MOV ECX,ESI
00871b50 : CALL EDX
00871b52 : PUSH 0xc4250c
00871b57 : LEA ECX,[ESP + 0x88]
00871b5e : MOV dword ptr [ESP + 0x1c],EAX
00871b62 : CALL 0x00406460
00871b67 : MOV byte ptr [ESP + 0xb0],0x6
00871b6f : PUSH 0xc42510
00871b74 : LEA ECX,[ESP + 0x6c]
00871b78 : CALL 0x00406460
00871b7d : MOV byte ptr [ESP + 0xb0],0x7
00871b85 : CMP dword ptr [ESP + 0x18],0x0
00871b8a : JZ 0x00871baf
00871b8c : LEA ESP,[ESP]
00871b90 : LEA EDX,[ESP + 0x18]
00871b94 : MOV EAX,ESI
00871b96 : CALL 0x004f5680
00871b9b : PUSH EAX
00871b9c : MOVZX EAX,word ptr [EAX + 0x18]
00871ba0 : PUSH EAX
00871ba1 : MOV EAX,EBX
00871ba3 : CALL 0x0088ccd0
00871ba8 : CMP dword ptr [ESP + 0x18],0x0
00871bad : JNZ 0x00871b90
00871baf : MOVZX ECX,word ptr [EDI + 0x28a]
00871bb6 : MOVZX EAX,CX
00871bb9 : MOV dword ptr [ESP + 0x18],EAX
00871bbd : CMP CX,0x4
00871bc1 : JNZ 0x00871bdb
00871bc3 : MOV ECX,0x6
00871bc8 : MOV dword ptr [ESP + 0x18],0x6
00871bd0 : MOV EAX,dword ptr [ESP + 0x18]
00871bd4 : MOV word ptr [EBX + 0x43c],CX
00871bdb : CMP dword ptr [ESP + 0x14],0x0
00871be0 : MOV ESI,dword ptr [ESP + 0x20]
00871be4 : MOVZX EDX,AX
00871be7 : MOV dword ptr [ESI + 0x160],EDX
00871bed : JNZ 0x00871c01
00871bef : MOV EDX,dword ptr [EBX]
00871bf1 : MOV EDX,dword ptr [EDX + 0x45c]
00871bf7 : PUSH EAX
00871bf8 : MOV EAX,dword ptr [EBP + 0x8]
00871bfb : PUSH EAX
00871bfc : PUSH EDI
00871bfd : MOV ECX,EBX
00871bff : CALL EDX
00871c01 : MOVZX EAX,byte ptr [EBX + 0x198c]
00871c08 : PUSH EAX
00871c09 : MOV EDI,ESI
00871c0b : CALL 0x0084c320
00871c10 : CMP byte ptr [EBX + 0x198c],0x0
00871c17 : JZ 0x00871c46
00871c19 : MOV ECX,dword ptr [ESI + 0x168]
00871c1f : MOV byte ptr [ESI + 0x1a8],0x0
00871c26 : TEST ECX,ECX
00871c28 : JZ 0x00871c33
00871c2a : MOV EDX,dword ptr [ECX]
00871c2c : MOV EAX,dword ptr [EDX + 0x10]
00871c2f : PUSH 0x0
00871c31 : CALL EAX
00871c33 : MOV ECX,dword ptr [ESI + 0x16c]
00871c39 : TEST ECX,ECX
00871c3b : JZ 0x00871c46
00871c3d : MOV EDX,dword ptr [ECX]
00871c3f : MOV EAX,dword ptr [EDX + 0x10]
00871c42 : PUSH 0x0
00871c44 : CALL EAX
00871c46 : MOV byte ptr [ESP + 0xb0],0x6
00871c4e : LEA ECX,[ESP + 0x68]
00871c52 : CALL 0x00406560
00871c57 : MOV byte ptr [ESP + 0xb0],0x1
00871c5f : LEA ECX,[ESP + 0x84]
00871c66 : CALL 0x00406560
00871c6b : MOV dword ptr [ESP + 0xb0],0xffffffff
00871c76 : LEA ECX,[ESP + 0x4c]
00871c7a : CALL 0x00406560
00871c7f : JMP 0x00871da2
00871c84 : MOV EDI,dword ptr [ESP + 0x20]
00871c88 : MOV dword ptr [EBX + 0x1a74],ESI
00871c8e : CALL 0x0084faa0
00871c93 : MOV dword ptr [EDI + 0x160],ESI
00871c99 : MOV EAX,dword ptr [EBX + 0x8]
00871c9c : PUSH EAX
00871c9d : CALL 0x004049b0
00871ca2 : MOV ESI,dword ptr [EAX + 0x12c]
00871ca8 : ADD ESP,0x4
00871cab : TEST ESI,ESI
00871cad : JZ 0x00871d62
00871cb3 : PUSH 0xc42514
00871cb8 : LEA ECX,[ESP + 0x6c]
00871cbc : CALL 0x00406460
00871cc1 : MOV dword ptr [ESP + 0xb0],0x8
00871ccc : PUSH 0xc42518
00871cd1 : LEA ECX,[ESP + 0x88]
00871cd8 : CALL 0x00406460
00871cdd : MOV byte ptr [ESP + 0xb0],0x9
00871ce5 : MOV EDX,dword ptr [ESI + 0x1f8]
00871ceb : MOV EAX,dword ptr [EDX + 0x4]
00871cee : ADD ESI,0x1f8
00871cf4 : MOV ECX,ESI
00871cf6 : CALL EAX
00871cf8 : MOV dword ptr [ESP + 0x14],EAX
00871cfc : TEST EAX,EAX
00871cfe : JZ 0x00871d3a
00871d00 : LEA EDX,[ESP + 0x14]
00871d04 : MOV EAX,ESI
00871d06 : CALL 0x004f5680
00871d0b : MOVZX ECX,word ptr [EAX + 0x18]
00871d0f : CMP CX,0x3
00871d13 : JZ 0x00871d27
00871d15 : CMP CX,0x4
00871d19 : JZ 0x00871d27
00871d1b : CMP CX,0x5
00871d1f : JZ 0x00871d27
00871d21 : CMP CX,0xb
00871d25 : JNZ 0x00871d33
00871d27 : MOVZX ECX,CX
00871d2a : PUSH EAX
00871d2b : PUSH ECX
00871d2c : MOV EAX,EBX
00871d2e : CALL 0x0088cc50
00871d33 : CMP dword ptr [ESP + 0x14],0x0
00871d38 : JNZ 0x00871d00
00871d3a : MOV byte ptr [ESP + 0xb0],0x8
00871d42 : LEA ECX,[ESP + 0x84]
00871d49 : CALL 0x00406560
00871d4e : MOV dword ptr [ESP + 0xb0],0xffffffff
00871d59 : LEA ECX,[ESP + 0x68]
00871d5d : CALL 0x00406560
00871d62 : CMP word ptr [EBX + 0x43c],0x6
00871d6a : JNZ 0x00871da2
00871d6c : MOV EAX,dword ptr [EBX + 0x17f0]
00871d72 : CMP dword ptr [EAX + 0x160],0x0
00871d79 : JNZ 0x00871d8e
00871d7b : XOR EDX,EDX
00871d7d : MOV dword ptr [ESP + 0x18],0x0
00871d85 : MOV word ptr [EBX + 0x43c],DX
00871d8c : JMP 0x00871da2
00871d8e : MOV EAX,0x4
00871d93 : MOV dword ptr [ESP + 0x18],0x4
00871d9b : MOV word ptr [EBX + 0x43c],AX
00871da2 : LEA ECX,[ESP + 0x28]
00871da6 : PUSH ECX
00871da7 : CALL 0x00404a20
00871dac : MOV dword ptr [ESP + 0xb0],0xa
00871db7 : PUSH 0x0
00871db9 : PUSH 0x0
00871dbb : LEA EDX,[ESP + 0x1b]
00871dbf : PUSH EDX
00871dc0 : LEA ESI,[EBX + 0x43a]
00871dc6 : PUSH ESI
00871dc7 : MOV EDI,EBX
00871dc9 : CALL 0x0088cdd0
00871dce : MOV EDX,dword ptr [EBX + 0x18a8]
00871dd4 : MOV dword ptr [ESP + 0x14],EAX
00871dd8 : TEST EDX,EDX
00871dda : JZ 0x00871e93
00871de0 : CMP byte ptr [EDX + 0x20],0x0
00871de4 : JZ 0x00871e93
00871dea : MOV CX,word ptr [ESI]
00871ded : CALL 0x0083ac80
00871df2 : MOVZX EAX,AX
00871df5 : TEST AX,AX
00871df8 : JBE 0x00871f6a
00871dfe : MOVZX ECX,word ptr [EBX + 0x7c]
00871e02 : PUSH 0x1
00871e04 : PUSH ECX
00871e05 : MOV word ptr [ESI],AX
00871e08 : MOV EDX,dword ptr [EDX + 0x24]
00871e0b : PUSH EAX
00871e0c : PUSH EDX
00871e0d : LEA EDX,[ESP + 0x30]
00871e11 : PUSH EDX
00871e12 : MOV EDX,dword ptr [EBX + 0x440]
00871e18 : LEA ECX,[ESP + 0x27]
00871e1c : MOV byte ptr [ESP + 0x27],0x0
00871e21 : CALL 0x00abe000
00871e26 : MOV byte ptr [ESP + 0xb0],0xb
00871e2e : CMP dword ptr [ESP + 0x24],0x0
00871e33 : JNZ 0x00871e81
00871e35 : MOVZX EAX,word ptr [EBX + 0x7c]
00871e39 : MOVZX ECX,word ptr [ESI]
00871e3c : MOVZX EDX,word ptr [EBX + 0x43c]
00871e43 : PUSH 0x0
00871e45 : PUSH EAX
00871e46 : PUSH ECX
00871e47 : PUSH EDX
00871e48 : MOV EDX,dword ptr [EBX + 0x440]
00871e4e : LEA EAX,[ESP + 0x28]
00871e52 : PUSH EAX
00871e53 : LEA ECX,[ESP + 0x27]
00871e57 : CALL 0x00abe000
00871e5c : MOV byte ptr [ESP + 0xb0],0xc
00871e64 : MOV ESI,EAX
00871e66 : LEA EDI,[ESP + 0x20]
00871e6a : CALL 0x00463a60
00871e6f : MOV byte ptr [ESP + 0xb0],0xb
00871e77 : LEA ECX,[ESP + 0x18]
00871e7b : PUSH ECX
00871e7c : CALL 0x0040ed80
00871e81 : MOV byte ptr [ESP + 0xb0],0xa
00871e89 : LEA EDX,[ESP + 0x20]
00871e8d : PUSH EDX
00871e8e : JMP 0x00871f65
00871e93 : PUSH 0x0
00871e95 : CMP EAX,0x4
00871e98 : JNZ 0x00871f2c
00871e9e : MOV EDX,dword ptr [ESP + 0x1c]
00871ea2 : MOV EAX,0x3e8
00871ea7 : ADD AX,word ptr [ESI]
00871eaa : MOVZX ECX,AX
00871ead : PUSH ECX
00871eae : MOV ECX,dword ptr [EBX + 0x440]
00871eb4 : PUSH EDX
00871eb5 : LEA EAX,[ESP + 0x2c]
00871eb9 : PUSH EAX
00871eba : CALL 0x00abdd00
00871ebf : MOV byte ptr [ESP + 0xb0],0xd
00871ec7 : MOV ESI,EAX
00871ec9 : LEA EDI,[ESP + 0x28]
00871ecd : CALL 0x00463a60
00871ed2 : MOV byte ptr [ESP + 0xb0],0xa
00871eda : LEA ECX,[ESP + 0x20]
00871ede : PUSH ECX
00871edf : CALL 0x0040ed80
00871ee4 : CMP dword ptr [ESP + 0x2c],0x0
00871ee9 : JNZ 0x00871f6a
00871eef : MOVZX EDX,word ptr [EBX + 0x43a]
00871ef6 : MOV EAX,dword ptr [ESP + 0x18]
00871efa : PUSH 0x0
00871efc : PUSH EDX
00871efd : PUSH EAX
00871efe : LEA ECX,[ESP + 0x2c]
00871f02 : PUSH ECX
00871f03 : MOV ECX,dword ptr [EBX + 0x440]
00871f09 : CALL 0x00abdd00
00871f0e : MOV byte ptr [ESP + 0xb0],0xe
00871f16 : MOV ESI,EAX
00871f18 : CALL 0x00463a60
00871f1d : MOV byte ptr [ESP + 0xb0],0xa
00871f25 : LEA EDX,[ESP + 0x20]
00871f29 : PUSH EDX
00871f2a : JMP 0x00871f65
00871f2c : MOVZX EAX,word ptr [ESI]
00871f2f : MOV ECX,dword ptr [ESP + 0x1c]
00871f33 : PUSH EAX
00871f34 : PUSH ECX
00871f35 : MOV ECX,dword ptr [EBX + 0x440]
00871f3b : LEA EDX,[ESP + 0x2c]
00871f3f : PUSH EDX
00871f40 : CALL 0x00abdd00
00871f45 : MOV byte ptr [ESP + 0xb0],0xf
00871f4d : MOV ESI,EAX
00871f4f : LEA EDI,[ESP + 0x28]
00871f53 : CALL 0x00463a60
00871f58 : MOV byte ptr [ESP + 0xb0],0xa
00871f60 : LEA EAX,[ESP + 0x20]
00871f64 : PUSH EAX
00871f65 : CALL 0x0040ed80
00871f6a : MOV ECX,dword ptr [ESP + 0x14]
00871f6e : XOR EAX,EAX
00871f70 : CMP ECX,0x4
00871f73 : JNZ 0x00871f7a
00871f75 : LEA EAX,[ECX + -0x3]
00871f78 : JMP 0x00871f84
00871f7a : CMP ECX,0x3
00871f7d : JNZ 0x00871f84
00871f7f : MOV EAX,0x2
00871f84 : MOV ECX,dword ptr [EBX + 0x410]
00871f8a : FLD1
00871f8c : LEA EDI,[EAX + EAX*0x2]
00871f8f : SUB ESP,0x8
00871f92 : FST float ptr [ESP + 0x4]
00871f96 : SHL EDI,0x4
00871f99 : MOV DL,byte ptr [EDI + ECX*0x1 + 0xb0]
00871fa0 : FSTP float ptr [ESP]
00871fa3 : LEA ESI,[EAX + EAX*0x2 + 0x9]
00871fa7 : MOV byte ptr [ESP + 0x28],DL
00871fab : MOV EAX,dword ptr [ESP + 0x28]
00871faf : MOV EDX,dword ptr [ESP + 0x1c]
00871fb3 : PUSH EAX
00871fb4 : MOVZX EAX,word ptr [EBX + 0x43a]
00871fbb : PUSH 0x0
00871fbd : PUSH EDX
00871fbe : PUSH EAX
00871fbf : LEA EDX,[ESP + 0x40]
00871fc3 : PUSH EDX
00871fc4 : SHL ESI,0x4
00871fc7 : MOVSS XMM0,dword ptr [ESI + ECX*0x1]
00871fcc : PUSH ECX
00871fcd : MOVSS dword ptr [ESP + 0x38],XMM0
00871fd3 : CALL 0x0079d530
00871fd8 : MOV EAX,dword ptr [EBX + 0x410]
00871fde : MOVSS XMM0,dword ptr [ESP + 0x18]
00871fe4 : MOVSS dword ptr [EAX + ESI*0x1],XMM0
00871fe9 : MOV EAX,dword ptr [EBX + 0x410]
00871fef : MOV byte ptr [EAX + EDI*0x1 + 0xb6],0x1
00871ff7 : MOV EBX,dword ptr [EBX + 0x410]
00871ffd : MOV EAX,dword ptr [EBX]
00871fff : MOV EDX,dword ptr [EAX + 0x10]
00872002 : MOV ECX,EBX
00872004 : CALL EDX
00872006 : MOV dword ptr [ESP + 0xb0],0xffffffff
00872011 : LEA EAX,[ESP + 0x28]
00872015 : PUSH EAX
00872016 : CALL 0x0040ed80
0087201b : MOV ECX,dword ptr [ESP + 0xa8]
00872022 : MOV dword ptr FS:[0x0],ECX
00872029 : POP ECX
0087202a : POP EDI
0087202b : POP ESI
0087202c : POP EBX
0087202d : MOV ECX,dword ptr [ESP + 0x90]
00872034 : XOR ECX,ESP
00872036 : CALL 0x00633e6b
0087203b : MOV ESP,EBP
0087203d : POP EBP
0087203e : RET 0x4

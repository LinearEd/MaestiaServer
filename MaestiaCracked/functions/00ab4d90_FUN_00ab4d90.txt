PROGRAM  : Maestia.exe
FUNCTION : FUN_00ab4d90
ENTRY    : 00ab4d90
BODY     : [[00ab4d90, 00ab51d0] [00ab51d3, 00ab5239]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00ab4d90(int param_1,undefined4 param_2,char *param_3)

{
  char cVar1;
  uint uVar2;
  int iVar3;
  int *piVar4;
  short *psVar5;
  undefined4 uVar6;
  int in_ECX;
  int iVar7;
  undefined1 auStack_ec [4];
  int local_e8;
  int local_e0;
  int local_dc;
  undefined4 local_d8;
  char *local_d4;
  undefined4 uStack_d0;
  int local_cc;
  int iStack_c8;
  undefined2 uStack_c0;
  undefined4 uStack_b0;
  uint uStack_ac;
  undefined1 auStack_a8 [4];
  undefined2 uStack_a4;
  undefined4 uStack_94;
  uint uStack_90;
  undefined1 local_8c [4];
  undefined2 local_88;
  undefined4 local_78;
  uint local_74;
  undefined1 auStack_70 [4];
  undefined2 uStack_6c;
  undefined4 uStack_5c;
  uint uStack_58;
  undefined2 uStack_50;
  undefined4 uStack_40;
  uint uStack_3c;
  undefined2 uStack_34;
  undefined4 uStack_24;
  uint uStack_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b5d2db;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_ec;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xffffff08;
  ExceptionList = &local_14;
  local_88 = 0;
  local_e8 = param_1;
  local_d4 = param_3;
  local_74 = 7;
  local_78 = 0;
  FUN_00406360(&DAT_00ca366c,0);
  *param_3 = '\0';
  local_e0 = 0;
  local_dc = 0;
  local_d8 = 0;
  local_c._0_1_ = 1;
  local_c._1_3_ = 0;
  FUN_00413630(uVar2);
  cVar1 = (char)((uint)param_2 >> 0x10);
  if ((cVar1 == '2') || (cVar1 == -0x74)) {
    *param_3 = '\x01';
    iVar7 = local_dc;
    iVar3 = local_e0;
  }
  else {
    local_cc = in_ECX + 0x128;
    iStack_c8 = (**(code **)(*(int *)(in_ECX + 0x128) + 4))();
    iVar7 = local_dc;
    while (iStack_c8 != 0) {
      iVar3 = FUN_004f5680();
      if (iVar3 != 0) {
        FUN_00824a20(DAT_0172491c,0);
        local_c._0_1_ = 2;
        piVar4 = (int *)FUN_00413740(&uStack_d0,local_e0,iVar7,auStack_70);
        if (iVar7 == *piVar4) {
          for (psVar5 = *(short **)(local_cc + 0x28); psVar5 != *(short **)(local_cc + 0x2c);
              psVar5 = psVar5 + 4) {
            if (*psVar5 == *(short *)(iVar3 + 6)) {
              iVar7 = *(int *)(psVar5 + 2);
              goto LAB_00ab4ee3;
            }
          }
          iVar7 = 0;
LAB_00ab4ee3:
          for (psVar5 = *(short **)(local_cc + 0x28); psVar5 != *(short **)(local_cc + 0x2c);
              psVar5 = psVar5 + 4) {
            if (*psVar5 == (short)*(undefined4 *)(*(int *)(DAT_0172491c + 0x17c) + 0x16d8)) {
              if (*(int *)(psVar5 + 2) != 0) {
                if (iVar7 != 0) {
                  FUN_00824a20(DAT_0172491c,0);
                  local_c._0_1_ = 3;
                  FUN_00824a20(DAT_0172491c,0);
                  local_c._0_1_ = 4;
                  cVar1 = FUN_00404700();
                  if (cVar1 != '\0') {
                    *local_d4 = '\x01';
                  }
                  uVar6 = FUN_00404750(&DAT_00ca3670);
                  local_c._0_1_ = 5;
                  uVar6 = FUN_00403450(auStack_a8,uVar6);
                  local_c._0_1_ = 6;
                  FUN_00405c30(uVar6,0,0xffffffff);
                  local_c = CONCAT31(local_c._1_3_,5);
                  if (7 < uStack_90) {
                    /* WARNING: Subroutine does not return */
                    FUN_006f04e0();
                  }
                  uStack_90 = 7;
                  uStack_94 = 0;
                  uStack_a4 = 0;
                  local_c = CONCAT31(local_c._1_3_,4);
                  if (7 < uStack_ac) {
                    /* WARNING: Subroutine does not return */
                    FUN_006f04e0();
                  }
                  uStack_ac = 7;
                  uStack_b0 = 0;
                  uStack_c0 = 0;
                  local_c = CONCAT31(local_c._1_3_,3);
                  if (7 < uStack_20) {
                    /* WARNING: Subroutine does not return */
                    FUN_006f04e0();
                  }
                  uStack_20 = 7;
                  uStack_24 = 0;
                  uStack_34 = 0;
                  local_c._0_1_ = 2;
                  if (7 < uStack_3c) {
                    /* WARNING: Subroutine does not return */
                    FUN_006f04e0();
                  }
                  uStack_3c = 7;
                  uStack_40 = 0;
                  uStack_50 = 0;
                }
                goto LAB_00ab4f1b;
              }
              break;
            }
          }
          *local_d4 = '\0';
LAB_00ab4f1b:
          FUN_00405ae0(auStack_70);
          iVar7 = local_dc;
        }
        local_c._0_1_ = 1;
        if (7 < uStack_58) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        uStack_58 = 7;
        uStack_5c = 0;
        uStack_6c = 0;
      }
    }
    if (*local_d4 == '\0') {
      uVar6 = FUN_00404750(&DAT_00ca3674);
      local_c._0_1_ = 7;
      FUN_00405c30(uVar6,0,0xffffffff);
      local_c._0_1_ = 1;
      FUN_00406560();
    }
    iVar3 = local_e0;
    if (3 < (uint)((iVar7 - local_e0) / 0x1c)) {
      FUN_00405c00(local_8c);
    }
    FUN_00405eb0(local_8c,0,0xffffffff);
  }
  if (iVar3 != iVar7) {
    local_e8 = FUN_00404250(iVar7);
    FUN_00405450(uStack_d0);
    local_dc = local_e8;
  }
  local_c._0_1_ = 0;
  if (iVar3 != 0) {
    FUN_00405450(uStack_d0);
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_e0 = 0;
  local_dc = 0;
  local_d8 = 0;
  local_c = 0xffffffff;
  if (7 < local_74) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_74 = 7;
  local_78 = 0;
  local_88 = 0;
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_ec);
  return;
}



============================================================
DISASSEMBLY
============================================================
00ab4d90 : PUSH EBP
00ab4d91 : MOV EBP,ESP
00ab4d93 : AND ESP,0xfffffff8
00ab4d96 : PUSH -0x1
00ab4d98 : PUSH 0xb5d2db
00ab4d9d : MOV EAX,FS:[0x0]
00ab4da3 : PUSH EAX
00ab4da4 : SUB ESP,0xd8
00ab4daa : MOV EAX,[0x00d66fa0]
00ab4daf : XOR EAX,ESP
00ab4db1 : MOV dword ptr [ESP + 0xd0],EAX
00ab4db8 : PUSH EBX
00ab4db9 : PUSH ESI
00ab4dba : PUSH EDI
00ab4dbb : MOV EAX,[0x00d66fa0]
00ab4dc0 : XOR EAX,ESP
00ab4dc2 : PUSH EAX
00ab4dc3 : LEA EAX,[ESP + 0xe8]
00ab4dca : MOV FS:[0x0],EAX
00ab4dd0 : MOV EAX,dword ptr [EBP + 0x8]
00ab4dd3 : MOV EBX,dword ptr [EBP + 0x10]
00ab4dd6 : MOV EDI,ECX
00ab4dd8 : XOR ESI,ESI
00ab4dda : XOR ECX,ECX
00ab4ddc : PUSH ESI
00ab4ddd : MOV word ptr [ESP + 0x78],CX
00ab4de2 : PUSH 0xca366c
00ab4de7 : LEA ECX,[ESP + 0x78]
00ab4deb : MOV dword ptr [ESP + 0x1c],EAX
00ab4def : MOV dword ptr [ESP + 0x30],EBX
00ab4df3 : MOV dword ptr [ESP + 0x90],0x7
00ab4dfe : MOV dword ptr [ESP + 0x8c],ESI
00ab4e05 : CALL 0x00406360
00ab4e0a : MOV dword ptr [ESP + 0xf0],ESI
00ab4e11 : MOV byte ptr [EBX],0x0
00ab4e14 : MOV dword ptr [ESP + 0x1c],ESI
00ab4e18 : MOV dword ptr [ESP + 0x20],ESI
00ab4e1c : MOV dword ptr [ESP + 0x24],ESI
00ab4e20 : MOV byte ptr [ESP + 0xf0],0x1
00ab4e28 : LEA ECX,[ESP + 0x18]
00ab4e2c : CALL 0x00413630
00ab4e31 : MOV EAX,dword ptr [EBP + 0xc]
00ab4e34 : SHR EAX,0x10
00ab4e37 : CMP AL,0x32
00ab4e39 : JZ 0x00ab5174
00ab4e3f : CMP AL,0x8c
00ab4e41 : JZ 0x00ab5174
00ab4e47 : MOV EDX,dword ptr [EDI + 0x128]
00ab4e4d : MOV EAX,dword ptr [EDX + 0x4]
00ab4e50 : LEA ESI,[EDI + 0x128]
00ab4e56 : MOV ECX,ESI
00ab4e58 : MOV dword ptr [ESP + 0x30],ESI
00ab4e5c : CALL EAX
00ab4e5e : MOV EBX,dword ptr [ESP + 0x20]
00ab4e62 : MOV dword ptr [ESP + 0x34],EAX
00ab4e66 : TEST EAX,EAX
00ab4e68 : JZ 0x00ab50f2
00ab4e6e : MOV EDI,EDI
00ab4e70 : LEA EDX,[ESP + 0x34]
00ab4e74 : MOV EAX,ESI
00ab4e76 : CALL 0x004f5680
00ab4e7b : MOV EDI,EAX
00ab4e7d : TEST EDI,EDI
00ab4e7f : JZ 0x00ab50e7
00ab4e85 : MOV ECX,dword ptr [0x0172491c]
00ab4e8b : PUSH 0x0
00ab4e8d : LEA EDX,[EDI + 0x18]
00ab4e90 : PUSH ECX
00ab4e91 : LEA ESI,[ESP + 0x94]
00ab4e98 : CALL 0x00824a20
00ab4e9d : MOV byte ptr [ESP + 0xf0],0x2
00ab4ea5 : MOV EAX,dword ptr [ESP + 0x1c]
00ab4ea9 : MOV EDX,ESI
00ab4eab : PUSH EDX
00ab4eac : PUSH EBX
00ab4ead : PUSH EAX
00ab4eae : LEA ECX,[ESP + 0x38]
00ab4eb2 : PUSH ECX
00ab4eb3 : CALL 0x00413740
00ab4eb8 : ADD ESP,0x10
00ab4ebb : CMP EBX,dword ptr [EAX]
00ab4ebd : JNZ 0x00ab50a2
00ab4ec3 : MOV ECX,dword ptr [ESP + 0x30]
00ab4ec7 : MOV EAX,dword ptr [ECX + 0x28]
00ab4eca : MOV EDX,dword ptr [ECX + 0x2c]
00ab4ecd : MOVZX ESI,word ptr [EDI + 0x6]
00ab4ed1 : CMP EAX,EDX
00ab4ed3 : JZ 0x00ab4ee1
00ab4ed5 : CMP word ptr [EAX],SI
00ab4ed8 : JZ 0x00ab4f35
00ab4eda : ADD EAX,0x8
00ab4edd : CMP EAX,EDX
00ab4edf : JNZ 0x00ab4ed5
00ab4ee1 : XOR EDI,EDI
00ab4ee3 : MOV ESI,dword ptr [0x0172491c]
00ab4ee9 : MOV EAX,dword ptr [ESI + 0x17c]
00ab4eef : MOV EDX,dword ptr [EAX + 0x16d8]
00ab4ef5 : MOV EAX,dword ptr [ECX + 0x28]
00ab4ef8 : MOV ECX,dword ptr [ECX + 0x2c]
00ab4efb : CMP EAX,ECX
00ab4efd : JZ 0x00ab4f0c
00ab4eff : NOP
00ab4f00 : CMP word ptr [EAX],DX
00ab4f03 : JZ 0x00ab4f3a
00ab4f05 : ADD EAX,0x8
00ab4f08 : CMP EAX,ECX
00ab4f0a : JNZ 0x00ab4f00
00ab4f0c : MOV ECX,dword ptr [ESP + 0x28]
00ab4f10 : MOV byte ptr [ECX],0x0
00ab4f13 : MOV ESI,0x7
00ab4f18 : LEA EDI,[ESI + 0x1]
00ab4f1b : LEA EDX,[ESP + 0x8c]
00ab4f22 : PUSH EDX
00ab4f23 : LEA EAX,[ESP + 0x1c]
00ab4f27 : CALL 0x00405ae0
00ab4f2c : MOV EBX,dword ptr [ESP + 0x20]
00ab4f30 : JMP 0x00ab50aa
00ab4f35 : MOV EDI,dword ptr [EAX + 0x4]
00ab4f38 : JMP 0x00ab4ee3
00ab4f3a : MOV EBX,dword ptr [EAX + 0x4]
00ab4f3d : TEST EBX,EBX
00ab4f3f : JZ 0x00ab4f0c
00ab4f41 : TEST EDI,EDI
00ab4f43 : JZ 0x00ab4f13
00ab4f45 : PUSH 0x0
00ab4f47 : PUSH ESI
00ab4f48 : LEA EDX,[EDI + 0x18]
00ab4f4b : LEA ESI,[ESP + 0xb0]
00ab4f52 : CALL 0x00824a20
00ab4f57 : MOV byte ptr [ESP + 0xf0],0x3
00ab4f5f : MOV EAX,[0x0172491c]
00ab4f64 : PUSH 0x0
00ab4f66 : LEA EDX,[EBX + 0x18]
00ab4f69 : PUSH EAX
00ab4f6a : LEA ESI,[ESP + 0xcc]
00ab4f71 : CALL 0x00824a20
00ab4f76 : MOV byte ptr [ESP + 0xf0],0x4
00ab4f7e : MOV EAX,ESI
00ab4f80 : LEA ECX,[ESP + 0xa8]
00ab4f87 : CALL 0x00404700
00ab4f8c : TEST AL,AL
00ab4f8e : JZ 0x00ab4f97
00ab4f90 : MOV ECX,dword ptr [ESP + 0x28]
00ab4f94 : MOV byte ptr [ECX],0x1
00ab4f97 : PUSH 0xca3670
00ab4f9c : LEA ESI,[ESP + 0x3c]
00ab4fa0 : CALL 0x00404750
00ab4fa5 : ADD ESP,0x4
00ab4fa8 : MOV byte ptr [ESP + 0xf0],0x5
00ab4fb0 : PUSH EAX
00ab4fb1 : LEA EDX,[ESP + 0x58]
00ab4fb5 : PUSH EDX
00ab4fb6 : LEA ECX,[ESP + 0x94]
00ab4fbd : CALL 0x00403450
00ab4fc2 : ADD ESP,0x8
00ab4fc5 : MOV byte ptr [ESP + 0xf0],0x6
00ab4fcd : PUSH -0x1
00ab4fcf : PUSH 0x0
00ab4fd1 : PUSH EAX
00ab4fd2 : LEA ECX,[ESP + 0x7c]
00ab4fd6 : CALL 0x00405c30
00ab4fdb : MOV byte ptr [ESP + 0xf0],0x5
00ab4fe3 : MOV EDI,0x8
00ab4fe8 : CMP dword ptr [ESP + 0x6c],EDI
00ab4fec : JC 0x00ab4ff7
00ab4fee : MOV ECX,dword ptr [ESP + 0x58]
00ab4ff2 : CALL 0x006f04e0
00ab4ff7 : MOV ESI,0x7
00ab4ffc : XOR EBX,EBX
00ab4ffe : XOR EAX,EAX
00ab5000 : MOV dword ptr [ESP + 0x6c],ESI
00ab5004 : MOV dword ptr [ESP + 0x68],EBX
00ab5008 : MOV word ptr [ESP + 0x58],AX
00ab500d : MOV byte ptr [ESP + 0xf0],0x4
00ab5015 : CMP dword ptr [ESP + 0x50],EDI
00ab5019 : JC 0x00ab5024
00ab501b : MOV ECX,dword ptr [ESP + 0x3c]
00ab501f : CALL 0x006f04e0
00ab5024 : XOR ECX,ECX
00ab5026 : MOV dword ptr [ESP + 0x50],ESI
00ab502a : MOV dword ptr [ESP + 0x4c],EBX
00ab502e : MOV word ptr [ESP + 0x3c],CX
00ab5033 : MOV byte ptr [ESP + 0xf0],0x3
00ab503b : CMP dword ptr [ESP + 0xdc],EDI
00ab5042 : JC 0x00ab5050
00ab5044 : MOV ECX,dword ptr [ESP + 0xc8]
00ab504b : CALL 0x006f04e0
00ab5050 : XOR EDX,EDX
00ab5052 : MOV dword ptr [ESP + 0xdc],ESI
00ab5059 : MOV dword ptr [ESP + 0xd8],EBX
00ab5060 : MOV word ptr [ESP + 0xc8],DX
00ab5068 : MOV byte ptr [ESP + 0xf0],0x2
00ab5070 : CMP dword ptr [ESP + 0xc0],EDI
00ab5077 : JC 0x00ab5085
00ab5079 : MOV ECX,dword ptr [ESP + 0xac]
00ab5080 : CALL 0x006f04e0
00ab5085 : XOR EAX,EAX
00ab5087 : MOV dword ptr [ESP + 0xc0],ESI
00ab508e : MOV dword ptr [ESP + 0xbc],EBX
00ab5095 : MOV word ptr [ESP + 0xac],AX
00ab509d : JMP 0x00ab4f1b
00ab50a2 : MOV EDI,0x8
00ab50a7 : LEA ESI,[EDI + -0x1]
00ab50aa : MOV byte ptr [ESP + 0xf0],0x1
00ab50b2 : CMP dword ptr [ESP + 0xa4],EDI
00ab50b9 : JC 0x00ab50c7
00ab50bb : MOV ECX,dword ptr [ESP + 0x90]
00ab50c2 : CALL 0x006f04e0
00ab50c7 : XOR EAX,EAX
00ab50c9 : MOV dword ptr [ESP + 0xa4],ESI
00ab50d0 : MOV ESI,dword ptr [ESP + 0x30]
00ab50d4 : MOV dword ptr [ESP + 0xa0],0x0
00ab50df : MOV word ptr [ESP + 0x90],AX
00ab50e7 : CMP dword ptr [ESP + 0x34],0x0
00ab50ec : JNZ 0x00ab4e70
00ab50f2 : MOV ECX,dword ptr [ESP + 0x28]
00ab50f6 : CMP byte ptr [ECX],0x0
00ab50f9 : JNZ 0x00ab5131
00ab50fb : PUSH 0xca3674
00ab5100 : LEA ESI,[ESP + 0x3c]
00ab5104 : CALL 0x00404750
00ab5109 : ADD ESP,0x4
00ab510c : MOV byte ptr [ESP + 0xf0],0x7
00ab5114 : MOV ECX,dword ptr [ESP + 0x14]
00ab5118 : PUSH -0x1
00ab511a : PUSH 0x0
00ab511c : PUSH EAX
00ab511d : CALL 0x00405c30
00ab5122 : MOV byte ptr [ESP + 0xf0],0x1
00ab512a : MOV ECX,ESI
00ab512c : CALL 0x00406560
00ab5131 : MOV ESI,dword ptr [ESP + 0x1c]
00ab5135 : MOV ECX,EBX
00ab5137 : SUB ECX,ESI
00ab5139 : MOV EAX,0x92492493
00ab513e : IMUL ECX
00ab5140 : ADD EDX,ECX
00ab5142 : SAR EDX,0x4
00ab5145 : MOV EAX,EDX
00ab5147 : SHR EAX,0x1f
00ab514a : ADD EAX,EDX
00ab514c : CMP EAX,0x4
00ab514f : JC 0x00ab5160
00ab5151 : LEA ECX,[ESP + 0x70]
00ab5155 : PUSH ECX
00ab5156 : MOV EDX,0xca367c
00ab515b : CALL 0x00405c00
00ab5160 : MOV ECX,dword ptr [ESP + 0x14]
00ab5164 : PUSH -0x1
00ab5166 : PUSH 0x0
00ab5168 : LEA EDX,[ESP + 0x78]
00ab516c : PUSH EDX
00ab516d : CALL 0x00405eb0
00ab5172 : JMP 0x00ab517f
00ab5174 : MOV ESI,dword ptr [ESP + 0x1c]
00ab5178 : MOV byte ptr [EBX],0x1
00ab517b : MOV EBX,dword ptr [ESP + 0x20]
00ab517f : CMP ESI,EBX
00ab5181 : JZ 0x00ab51ab
00ab5183 : PUSH EBX
00ab5184 : MOV ECX,ESI
00ab5186 : MOV EAX,EBX
00ab5188 : CALL 0x00404250
00ab518d : MOV ECX,dword ptr [ESP + 0x30]
00ab5191 : ADD ESP,0x4
00ab5194 : PUSH ECX
00ab5195 : MOV EDI,EBX
00ab5197 : MOV dword ptr [ESP + 0x18],EAX
00ab519b : CALL 0x00405450
00ab51a0 : MOV EBX,dword ptr [ESP + 0x18]
00ab51a4 : ADD ESP,0x4
00ab51a7 : MOV dword ptr [ESP + 0x20],EBX
00ab51ab : MOV byte ptr [ESP + 0xf0],0x0
00ab51b3 : XOR EDI,EDI
00ab51b5 : CMP ESI,EDI
00ab51b7 : JZ 0x00ab51d3
00ab51b9 : MOV EDX,dword ptr [ESP + 0x2c]
00ab51bd : PUSH EDX
00ab51be : MOV EDI,EBX
00ab51c0 : MOV EAX,ESI
00ab51c2 : CALL 0x00405450
00ab51c7 : ADD ESP,0x4
00ab51ca : MOV ECX,ESI
00ab51cc : CALL 0x006f04e0
00ab51d3 : MOV dword ptr [ESP + 0x1c],EDI
00ab51d7 : MOV dword ptr [ESP + 0x20],EDI
00ab51db : MOV dword ptr [ESP + 0x24],EDI
00ab51df : MOV dword ptr [ESP + 0xf0],0xffffffff
00ab51ea : CMP dword ptr [ESP + 0x88],0x8
00ab51f2 : JC 0x00ab51fd
00ab51f4 : MOV ECX,dword ptr [ESP + 0x74]
00ab51f8 : CALL 0x006f04e0
00ab51fd : XOR EAX,EAX
00ab51ff : MOV dword ptr [ESP + 0x88],0x7
00ab520a : MOV dword ptr [ESP + 0x84],EDI
00ab5211 : MOV word ptr [ESP + 0x74],AX
00ab5216 : MOV ECX,dword ptr [ESP + 0xe8]
00ab521d : MOV dword ptr FS:[0x0],ECX
00ab5224 : POP ECX
00ab5225 : POP EDI
00ab5226 : POP ESI
00ab5227 : POP EBX
00ab5228 : MOV ECX,dword ptr [ESP + 0xd0]
00ab522f : XOR ECX,ESP
00ab5231 : CALL 0x00633e6b
00ab5236 : MOV ESP,EBP
00ab5238 : POP EBP
00ab5239 : RET

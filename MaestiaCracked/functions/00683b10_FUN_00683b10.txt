PROGRAM  : Maestia.exe
FUNCTION : FUN_00683b10
ENTRY    : 00683b10
BODY     : [[00683b10, 00683f50]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00683b10(uint param_1)

{
  int *piVar1;
  char cVar2;
  int *piVar3;
  GRefCountImpl *this;
  GRefCountImpl *this_00;
  HIMC pHVar4;
  uint uVar5;
  LPVOID lpBuf;
  LONG LVar6;
  char *lpBuf_00;
  void *_Dst;
  int iVar7;
  int *in_ECX;
  char cVar8;
  int iVar9;
  uint uVar10;
  ushort unaff_retaddr;
  undefined4 uVar11;
  uint uVar12;
  uint uStack_34;
  int *piStack_2c;
  uint uStack_28;
  uint uStack_24;
  int iStack_20;
  int iStack_1c;
  int iStack_18;
  undefined4 uStack_14;
  uint uStack_10;
  undefined4 uStack_c;
  
  this = (GRefCountImpl *)(**(code **)(*(int *)(in_ECX[1] + 8) + 0xc))(0x1b);
  uVar5 = param_1;
  uStack_14 = 0;
  uStack_10 = 0;
  if (param_1 == 0) {
    (**(code **)(*in_ECX + 0x54))(in_ECX + 0xc);
  }
  if ((uVar5 & 0x800) != 0) {
    this_00 = (GRefCountImpl *)(**(code **)(*(int *)(in_ECX[1] + 8) + 0xc))(0x1b);
    pHVar4 = ImmGetContext((HWND)in_ECX[5]);
    uVar5 = ImmGetCompositionStringW(pHVar4,0x800,(LPVOID)0x0,0);
    lpBuf = (LPVOID)FUN_00515840(uVar5 * 2 + 2,0);
    LVar6 = ImmGetCompositionStringW(pHVar4,0x800,lpBuf,uVar5);
    if ((LVar6 != -1) && (LVar6 != -2)) {
      *(undefined2 *)((int)lpBuf + (uVar5 & 0xfffffffe)) = 0;
      FUN_00597420(0);
    }
    in_ECX[0xc] = 0;
    in_ECX[0xe] = 0;
    *(undefined2 *)in_ECX[8] = 0;
    ImmReleaseContext((HWND)in_ECX[5],pHVar4);
    FUN_00597df0(lpBuf,0xffffffff);
    FUN_0051bb60(lpBuf);
    if (lpBuf != (LPVOID)0x0) {
      FUN_00515cf0(lpBuf);
    }
    uVar5 = param_1;
    if (this_00 != (GRefCountImpl *)0x0) {
      GRefCountImpl::Release(this_00);
      uVar5 = param_1;
    }
  }
  if (((uVar5 & 0x2000) != 0) && ((uVar5 & 0x4000) != 0)) {
    param_1 = (uint)unaff_retaddr;
    in_ECX[0xe] = 1;
    in_ECX[0xc] = 1;
    FUN_00597420(1);
    FUN_005973d0();
    FUN_005973b0(&param_1,1);
  }
  if ((((uVar5 & 8) != 0) && ((char)uVar5 < '\0')) && (in_ECX[0x17] != 0xd00001)) {
    (**(code **)(*in_ECX + 0x54))(in_ECX + 0xc);
  }
  if ((uVar5 & 0x10) == 0) goto LAB_00683f15;
  pHVar4 = ImmGetContext((HWND)in_ECX[5]);
  uVar5 = ImmGetCompositionStringW(pHVar4,0x10,(LPVOID)0x0,0);
  lpBuf_00 = (char *)FUN_00515840(uVar5 + 1,0);
  ImmGetCompositionStringW(pHVar4,0x10,lpBuf_00,uVar5);
  param_1 = uVar5;
  if ((uint)in_ECX[0xc] <= uVar5) {
    param_1 = in_ECX[0xc];
  }
  uVar5 = ImmGetCompositionStringW(pHVar4,1,(LPVOID)0x0,0);
  _Dst = (void *)FUN_00515840(uVar5 * 2 + 2,0);
  _memset(_Dst,0,uVar5 * 2);
  ImmGetCompositionStringW(pHVar4,1,_Dst,uVar5);
  *(undefined2 *)((int)_Dst + (uVar5 & 0xfffffffe)) = 0;
  FUN_00515cf0(_Dst);
  LVar6 = ImmGetCompositionStringW(pHVar4,0x80,(LPVOID)0x0,0);
  ImmReleaseContext((HWND)in_ECX[5],pHVar4);
  FUN_00597400(LVar6);
  piStack_2c = (int *)0x0;
  uStack_28 = 0;
  uStack_24 = 0;
  cVar8 = *lpBuf_00;
  in_ECX[0xd] = param_1 - LVar6;
  cVar2 = *lpBuf_00;
  iStack_18 = (int)cVar2;
  iStack_20 = 0;
  if ((cVar2 == '\x01') || (cVar2 == '\x03')) {
    in_ECX[0xd] = param_1;
  }
  (**(code **)(*in_ECX + 0x50))(_Dst);
  uVar5 = param_1;
  if (0 < (int)param_1) {
    uStack_34 = param_1;
    iVar7 = 0;
    do {
      iVar9 = iVar7;
      if (lpBuf_00[iVar9] != cVar8) {
        uVar10 = uStack_28 + 1;
        if (uVar10 < uStack_28) {
          uVar5 = uVar10;
          if (uVar10 < uStack_24 >> 1) {
LAB_00683ddd:
            FUN_005ae730(&piStack_2c,uVar5);
          }
        }
        else if (uStack_24 <= uVar10) {
          uVar5 = (uVar10 >> 2) + uVar10;
          goto LAB_00683ddd;
        }
        piVar1 = piStack_2c + uVar10 * 3 + -3;
        if (piVar1 != (int *)0x0) {
          *piVar1 = iStack_20;
          piVar1[1] = iStack_1c;
          piVar1[2] = iStack_18;
        }
        if ((lpBuf_00[iVar9] == '\x01') || (lpBuf_00[iVar9] == '\x03')) {
          in_ECX[0xd] = uStack_34;
        }
        cVar8 = lpBuf_00[iVar9];
        iStack_18 = (int)cVar8;
        uVar5 = param_1;
        uStack_28 = uVar10;
        iStack_20 = iVar9;
      }
      uStack_34 = uStack_34 - 1;
      iVar7 = iVar9 + 1;
      iStack_1c = iVar9;
    } while (iVar9 + 1 < (int)uVar5);
  }
  uVar10 = uStack_28 + 1;
  if (uVar10 < uStack_28) {
    uVar12 = uVar10;
    if (uVar10 < uStack_24 >> 1) {
LAB_00683e77:
      FUN_005ae730(&piStack_2c,uVar12);
    }
  }
  else if (uStack_24 <= uVar10) {
    uVar12 = (uVar10 >> 2) + uVar10;
    goto LAB_00683e77;
  }
  piVar3 = piStack_2c;
  piVar1 = piStack_2c + uVar10 * 3 + -3;
  if (piVar1 != (int *)0x0) {
    *piVar1 = iStack_20;
    piVar1[1] = uVar5 - 1;
    piVar1[2] = iStack_18;
  }
  FUN_00597400(LVar6);
  piVar1 = piVar3;
  if ((in_ECX[0x17] & 0xf000U) == 0) {
    for (; uVar10 != 0; uVar10 = uVar10 - 1) {
      iVar7 = (piVar1[1] - *piVar1) + 1;
      if (iVar7 != 0) {
        switch(piVar1[2]) {
        case 0:
          uVar11 = 0;
          break;
        case 1:
        case 3:
          uVar11 = 1;
          break;
        case 2:
          uVar11 = 2;
          break;
        case 4:
          uVar11 = 4;
          break;
        default:
          goto switchD_00683ed5_default;
        }
        FUN_00597440(*piVar1,iVar7,uVar11,0);
      }
switchD_00683ed5_default:
      piVar1 = piVar1 + 3;
    }
  }
  FUN_00515cf0(lpBuf_00);
  FUN_00515cf0(piVar3);
LAB_00683f15:
  if ((uStack_10 >> 6 & 1) != 0) {
    FUN_00588b40(&uStack_14,uStack_c);
    uStack_14 = 0;
  }
  if (this != (GRefCountImpl *)0x0) {
    GRefCountImpl::Release(this);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00683b10 : SUB ESP,0x34
00683b13 : PUSH EBX
00683b14 : PUSH EBP
00683b15 : MOV EBP,ECX
00683b17 : MOV ECX,dword ptr [EBP + 0x4]
00683b1a : MOV EAX,dword ptr [ECX + 0x8]
00683b1d : MOV EDX,dword ptr [EAX + 0xc]
00683b20 : PUSH ESI
00683b21 : ADD ECX,0x8
00683b24 : PUSH EDI
00683b25 : PUSH 0x1b
00683b27 : CALL EDX
00683b29 : MOV EBX,dword ptr [ESP + 0x4c]
00683b2d : XOR EDI,EDI
00683b2f : MOV ESI,EAX
00683b31 : MOV dword ptr [ESP + 0x10],ESI
00683b35 : MOV dword ptr [ESP + 0x34],EDI
00683b39 : MOV dword ptr [ESP + 0x38],EDI
00683b3d : CMP EBX,EDI
00683b3f : JNZ 0x00683b4f
00683b41 : MOV EAX,dword ptr [EBP]
00683b44 : MOV EDX,dword ptr [EAX + 0x54]
00683b47 : LEA ECX,[EBP + 0x30]
00683b4a : PUSH ECX
00683b4b : MOV ECX,EBP
00683b4d : CALL EDX
00683b4f : TEST EBX,0x800
00683b55 : JZ 0x00683c17
00683b5b : MOV ECX,dword ptr [EBP + 0x4]
00683b5e : MOV EAX,dword ptr [ECX + 0x8]
00683b61 : MOV EDX,dword ptr [EAX + 0xc]
00683b64 : ADD ECX,0x8
00683b67 : PUSH 0x1b
00683b69 : CALL EDX
00683b6b : MOV dword ptr [ESP + 0x14],EAX
00683b6f : MOV EAX,dword ptr [EBP + 0x14]
00683b72 : PUSH EAX
00683b73 : CALL 0x00611450
00683b78 : PUSH EDI
00683b79 : PUSH EDI
00683b7a : MOV EBX,EAX
00683b7c : PUSH 0x800
00683b81 : PUSH EBX
00683b82 : CALL 0x00685b84
00683b87 : MOV ESI,EAX
00683b89 : PUSH EDI
00683b8a : LEA ECX,[ESI + ESI*0x1 + 0x2]
00683b8e : PUSH ECX
00683b8f : MOV ECX,dword ptr [0x00d73250]
00683b95 : CALL 0x00515840
00683b9a : PUSH ESI
00683b9b : MOV EDI,EAX
00683b9d : PUSH EDI
00683b9e : PUSH 0x800
00683ba3 : PUSH EBX
00683ba4 : CALL 0x00685b84
00683ba9 : CMP EAX,-0x1
00683bac : JZ 0x00683bc9
00683bae : CMP EAX,-0x2
00683bb1 : JZ 0x00683bc9
00683bb3 : SHR ESI,0x1
00683bb5 : XOR EDX,EDX
00683bb7 : MOV word ptr [EDI + ESI*0x2],DX
00683bbb : MOV ESI,dword ptr [ESP + 0x14]
00683bbf : PUSH EDX
00683bc0 : MOV ECX,ESI
00683bc2 : CALL 0x00597420
00683bc7 : JMP 0x00683bcd
00683bc9 : MOV ESI,dword ptr [ESP + 0x14]
00683bcd : XOR EAX,EAX
00683bcf : MOV dword ptr [EBP + 0x30],EAX
00683bd2 : MOV dword ptr [EBP + 0x38],EAX
00683bd5 : MOV EAX,dword ptr [EBP + 0x20]
00683bd8 : XOR ECX,ECX
00683bda : MOV word ptr [EAX],CX
00683bdd : MOV EDX,dword ptr [EBP + 0x14]
00683be0 : PUSH EBX
00683be1 : PUSH EDX
00683be2 : CALL 0x00611462
00683be7 : PUSH -0x1
00683be9 : PUSH EDI
00683bea : MOV ECX,ESI
00683bec : CALL 0x00597df0
00683bf1 : PUSH EDI
00683bf2 : LEA ECX,[ESI + 0x34]
00683bf5 : CALL 0x0051bb60
00683bfa : TEST EDI,EDI
00683bfc : JZ 0x00683c04
00683bfe : PUSH EDI
00683bff : CALL 0x00515cf0
00683c04 : TEST ESI,ESI
00683c06 : JZ 0x00683c0f
00683c08 : MOV ECX,ESI
00683c0a : CALL 0x004ff7e0
00683c0f : MOV ESI,dword ptr [ESP + 0x10]
00683c13 : MOV EBX,dword ptr [ESP + 0x4c]
00683c17 : TEST EBX,0x2000
00683c1d : JZ 0x00683c5f
00683c1f : TEST EBX,0x4000
00683c25 : JZ 0x00683c5f
00683c27 : MOV AX,word ptr [ESP + 0x48]
00683c2c : XOR ECX,ECX
00683c2e : MOV EDI,0x1
00683c33 : MOV word ptr [ESP + 0x4e],CX
00683c38 : PUSH EDI
00683c39 : MOV ECX,ESI
00683c3b : MOV word ptr [ESP + 0x50],AX
00683c40 : MOV dword ptr [EBP + 0x38],EDI
00683c43 : MOV dword ptr [EBP + 0x30],EDI
00683c46 : CALL 0x00597420
00683c4b : MOV ECX,ESI
00683c4d : CALL 0x005973d0
00683c52 : PUSH EDI
00683c53 : LEA EDX,[ESP + 0x50]
00683c57 : PUSH EDX
00683c58 : MOV ECX,ESI
00683c5a : CALL 0x005973b0
00683c5f : TEST BL,0x8
00683c62 : JZ 0x00683c7f
00683c64 : TEST BL,BL
00683c66 : JNS 0x00683c7f
00683c68 : CMP dword ptr [EBP + 0x5c],0xd00001
00683c6f : JZ 0x00683c7f
00683c71 : MOV EAX,dword ptr [EBP]
00683c74 : MOV EDX,dword ptr [EAX + 0x54]
00683c77 : LEA ECX,[EBP + 0x30]
00683c7a : PUSH ECX
00683c7b : MOV ECX,EBP
00683c7d : CALL EDX
00683c7f : TEST BL,0x10
00683c82 : JZ 0x00683f15
00683c88 : MOV EAX,dword ptr [EBP + 0x14]
00683c8b : PUSH EAX
00683c8c : CALL 0x00611450
00683c91 : PUSH 0x0
00683c93 : PUSH 0x0
00683c95 : MOV EBX,EAX
00683c97 : PUSH 0x10
00683c99 : PUSH EBX
00683c9a : CALL 0x00685b84
00683c9f : MOV ESI,EAX
00683ca1 : PUSH 0x0
00683ca3 : LEA ECX,[ESI + 0x1]
00683ca6 : PUSH ECX
00683ca7 : MOV ECX,dword ptr [0x00d73250]
00683cad : CALL 0x00515840
00683cb2 : PUSH ESI
00683cb3 : PUSH EAX
00683cb4 : PUSH 0x10
00683cb6 : PUSH EBX
00683cb7 : MOV dword ptr [ESP + 0x58],EAX
00683cbb : CALL 0x00685b84
00683cc0 : MOV EAX,dword ptr [EBP + 0x30]
00683cc3 : MOV dword ptr [ESP + 0x4c],ESI
00683cc7 : CMP ESI,EAX
00683cc9 : JC 0x00683ccf
00683ccb : MOV dword ptr [ESP + 0x4c],EAX
00683ccf : PUSH 0x0
00683cd1 : PUSH 0x0
00683cd3 : PUSH 0x1
00683cd5 : PUSH EBX
00683cd6 : CALL 0x00685b84
00683cdb : MOV ECX,dword ptr [0x00d73250]
00683ce1 : MOV ESI,EAX
00683ce3 : PUSH 0x0
00683ce5 : LEA EDX,[ESI + ESI*0x1 + 0x2]
00683ce9 : PUSH EDX
00683cea : CALL 0x00515840
00683cef : MOV EDI,EAX
00683cf1 : LEA EAX,[ESI + ESI*0x1]
00683cf4 : PUSH EAX
00683cf5 : PUSH 0x0
00683cf7 : PUSH EDI
00683cf8 : CALL 0x0063b700
00683cfd : ADD ESP,0xc
00683d00 : PUSH ESI
00683d01 : PUSH EDI
00683d02 : PUSH 0x1
00683d04 : PUSH EBX
00683d05 : CALL 0x00685b84
00683d0a : XOR EAX,EAX
00683d0c : SHR ESI,0x1
00683d0e : PUSH EDI
00683d0f : MOV word ptr [EDI + ESI*0x2],AX
00683d13 : CALL 0x00515cf0
00683d18 : PUSH 0x0
00683d1a : PUSH 0x0
00683d1c : PUSH 0x80
00683d21 : PUSH EBX
00683d22 : CALL 0x00685b84
00683d27 : MOV ECX,dword ptr [EBP + 0x14]
00683d2a : PUSH EBX
00683d2b : MOV ESI,EAX
00683d2d : PUSH ECX
00683d2e : MOV dword ptr [ESP + 0x20],ESI
00683d32 : CALL 0x00611462
00683d37 : MOV ECX,dword ptr [ESP + 0x10]
00683d3b : PUSH ESI
00683d3c : CALL 0x00597400
00683d41 : MOV ECX,dword ptr [ESP + 0x4c]
00683d45 : XOR EAX,EAX
00683d47 : MOV dword ptr [ESP + 0x1c],EAX
00683d4b : MOV dword ptr [ESP + 0x20],EAX
00683d4f : MOV dword ptr [ESP + 0x24],EAX
00683d53 : MOV EAX,dword ptr [ESP + 0x48]
00683d57 : MOV BL,byte ptr [EAX]
00683d59 : MOV EDX,ECX
00683d5b : SUB EDX,ESI
00683d5d : MOV dword ptr [EBP + 0x34],EDX
00683d60 : MOV AL,byte ptr [EAX]
00683d62 : MOVSX EDX,AL
00683d65 : MOV dword ptr [ESP + 0x28],0x0
00683d6d : MOV dword ptr [ESP + 0x30],EDX
00683d71 : CMP AL,0x1
00683d73 : JZ 0x00683d79
00683d75 : CMP AL,0x3
00683d77 : JNZ 0x00683d7c
00683d79 : MOV dword ptr [EBP + 0x34],ECX
00683d7c : MOV EAX,dword ptr [EBP]
00683d7f : MOV EDX,dword ptr [EAX + 0x50]
00683d82 : PUSH EDI
00683d83 : MOV ECX,EBP
00683d85 : CALL EDX
00683d87 : MOV EDI,dword ptr [ESP + 0x4c]
00683d8b : XOR ESI,ESI
00683d8d : TEST EDI,EDI
00683d8f : JLE 0x00683e46
00683d95 : MOV dword ptr [ESP + 0x14],EDI
00683d99 : LEA ESP,[ESP]
00683da0 : MOV EAX,dword ptr [ESP + 0x48]
00683da4 : CMP byte ptr [ESI + EAX*0x1],BL
00683da7 : JZ 0x00683e35
00683dad : MOV EAX,dword ptr [ESP + 0x20]
00683db1 : LEA EDI,[EAX + 0x1]
00683db4 : CMP EDI,EAX
00683db6 : JNC 0x00683dca
00683db8 : MOV ECX,dword ptr [ESP + 0x24]
00683dbc : SHR ECX,0x1
00683dbe : CMP EDI,ECX
00683dc0 : JNC 0x00683de6
00683dc2 : PUSH EDI
00683dc3 : LEA EDX,[ESP + 0x20]
00683dc7 : PUSH EDX
00683dc8 : JMP 0x00683ddd
00683dca : CMP EDI,dword ptr [ESP + 0x24]
00683dce : JC 0x00683de6
00683dd0 : MOV EAX,EDI
00683dd2 : SHR EAX,0x2
00683dd5 : ADD EAX,EDI
00683dd7 : PUSH EAX
00683dd8 : LEA ECX,[ESP + 0x20]
00683ddc : PUSH ECX
00683ddd : LEA ECX,[ESP + 0x24]
00683de1 : CALL 0x005ae730
00683de6 : MOV EAX,dword ptr [ESP + 0x1c]
00683dea : LEA EDX,[EDI + EDI*0x2]
00683ded : LEA EAX,[EAX + EDX*0x4 + -0xc]
00683df1 : MOV dword ptr [ESP + 0x20],EDI
00683df5 : TEST EAX,EAX
00683df7 : JZ 0x00683e0d
00683df9 : MOV ECX,dword ptr [ESP + 0x28]
00683dfd : MOV EDX,dword ptr [ESP + 0x2c]
00683e01 : MOV dword ptr [EAX],ECX
00683e03 : MOV ECX,dword ptr [ESP + 0x30]
00683e07 : MOV dword ptr [EAX + 0x4],EDX
00683e0a : MOV dword ptr [EAX + 0x8],ECX
00683e0d : MOV ECX,dword ptr [ESP + 0x48]
00683e11 : MOV AL,byte ptr [ESI + ECX*0x1]
00683e14 : CMP AL,0x1
00683e16 : JZ 0x00683e1c
00683e18 : CMP AL,0x3
00683e1a : JNZ 0x00683e23
00683e1c : MOV EDX,dword ptr [ESP + 0x14]
00683e20 : MOV dword ptr [EBP + 0x34],EDX
00683e23 : MOV BL,byte ptr [ESI + ECX*0x1]
00683e26 : MOV EDI,dword ptr [ESP + 0x4c]
00683e2a : MOVSX EAX,BL
00683e2d : MOV dword ptr [ESP + 0x28],ESI
00683e31 : MOV dword ptr [ESP + 0x30],EAX
00683e35 : DEC dword ptr [ESP + 0x14]
00683e39 : MOV dword ptr [ESP + 0x2c],ESI
00683e3d : INC ESI
00683e3e : CMP ESI,EDI
00683e40 : JL 0x00683da0
00683e46 : MOV EAX,dword ptr [ESP + 0x20]
00683e4a : LEA ESI,[EAX + 0x1]
00683e4d : DEC EDI
00683e4e : CMP ESI,EAX
00683e50 : JNC 0x00683e64
00683e52 : MOV EAX,dword ptr [ESP + 0x24]
00683e56 : SHR EAX,0x1
00683e58 : CMP ESI,EAX
00683e5a : JNC 0x00683e80
00683e5c : PUSH ESI
00683e5d : LEA ECX,[ESP + 0x20]
00683e61 : PUSH ECX
00683e62 : JMP 0x00683e77
00683e64 : CMP ESI,dword ptr [ESP + 0x24]
00683e68 : JC 0x00683e80
00683e6a : MOV EDX,ESI
00683e6c : SHR EDX,0x2
00683e6f : ADD EDX,ESI
00683e71 : PUSH EDX
00683e72 : LEA EAX,[ESP + 0x20]
00683e76 : PUSH EAX
00683e77 : LEA ECX,[ESP + 0x24]
00683e7b : CALL 0x005ae730
00683e80 : MOV EBX,dword ptr [ESP + 0x1c]
00683e84 : LEA ECX,[ESI + ESI*0x2]
00683e87 : LEA EAX,[EBX + ECX*0x4 + -0xc]
00683e8b : TEST EAX,EAX
00683e8d : JZ 0x00683e9f
00683e8f : MOV EDX,dword ptr [ESP + 0x28]
00683e93 : MOV ECX,dword ptr [ESP + 0x30]
00683e97 : MOV dword ptr [EAX],EDX
00683e99 : MOV dword ptr [EAX + 0x4],EDI
00683e9c : MOV dword ptr [EAX + 0x8],ECX
00683e9f : MOV EDX,dword ptr [ESP + 0x18]
00683ea3 : MOV EDI,dword ptr [ESP + 0x10]
00683ea7 : PUSH EDX
00683ea8 : MOV ECX,EDI
00683eaa : CALL 0x00597400
00683eaf : TEST dword ptr [EBP + 0x5c],0xf000
00683eb6 : JNZ 0x00683f03
00683eb8 : TEST ESI,ESI
00683eba : JBE 0x00683f03
00683ebc : MOV EBP,EBX
00683ebe : MOV EDI,EDI
00683ec0 : MOV ECX,dword ptr [EBP]
00683ec3 : MOV EAX,dword ptr [EBP + 0x4]
00683ec6 : SUB EAX,ECX
00683ec8 : ADD EAX,0x1
00683ecb : JZ 0x00683efb
00683ecd : MOV EDX,dword ptr [EBP + 0x8]
00683ed0 : CMP EDX,0x4
00683ed3 : JA 0x00683efb
00683ed5 : JMP dword ptr [EDX*0x4 + 0x683f54]
00683edc : PUSH 0x0
00683ede : PUSH 0x0
00683ee0 : JMP 0x00683ef2
00683ee2 : PUSH 0x0
00683ee4 : PUSH 0x1
00683ee6 : JMP 0x00683ef2
00683ee8 : PUSH 0x0
00683eea : PUSH 0x2
00683eec : JMP 0x00683ef2
00683eee : PUSH 0x0
00683ef0 : PUSH 0x4
00683ef2 : PUSH EAX
00683ef3 : PUSH ECX
00683ef4 : MOV ECX,EDI
00683ef6 : CALL 0x00597440
00683efb : ADD EBP,0xc
00683efe : SUB ESI,0x1
00683f01 : JNZ 0x00683ec0
00683f03 : MOV EAX,dword ptr [ESP + 0x48]
00683f07 : PUSH EAX
00683f08 : CALL 0x00515cf0
00683f0d : PUSH EBX
00683f0e : CALL 0x00515cf0
00683f13 : MOV ESI,EDI
00683f15 : MOV ECX,dword ptr [ESP + 0x38]
00683f19 : SHR ECX,0x6
00683f1c : TEST CL,0x1
00683f1f : JZ 0x00683f3c
00683f21 : MOV EDX,dword ptr [ESP + 0x3c]
00683f25 : MOV ECX,dword ptr [ESP + 0x34]
00683f29 : PUSH EDX
00683f2a : LEA EAX,[ESP + 0x38]
00683f2e : PUSH EAX
00683f2f : CALL 0x00588b40
00683f34 : MOV dword ptr [ESP + 0x34],0x0
00683f3c : TEST ESI,ESI
00683f3e : JZ 0x00683f47
00683f40 : MOV ECX,ESI
00683f42 : CALL 0x004ff7e0
00683f47 : POP EDI
00683f48 : POP ESI
00683f49 : POP EBP
00683f4a : POP EBX
00683f4b : ADD ESP,0x34
00683f4e : RET 0xc

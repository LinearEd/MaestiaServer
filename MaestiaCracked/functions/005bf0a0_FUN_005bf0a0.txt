PROGRAM  : Maestia.exe
FUNCTION : FUN_005bf0a0
ENTRY    : 005bf0a0
BODY     : [[005bf0a0, 005bf3fa]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_005bf0a0(int param_1,uint param_2,int param_3,undefined4 param_4,int *param_5,uint param_6,
                undefined4 param_7,char param_8)

{
  uint *puVar1;
  int *piVar2;
  float fVar3;
  char cVar4;
  undefined1 *puVar5;
  double dVar6;
  ulonglong uVar7;
  double dVar8;
  int iVar9;
  bool bVar10;
  bool bVar11;
  float10 fVar12;
  int local_18;
  undefined8 local_c;
  byte local_4;
  
  cVar4 = *(char *)(*(int *)(param_1 + 0x78) + 0x2a4);
  bVar10 = cVar4 != '\x01';
  if (((cVar4 == '\x01') && (param_6 != 0)) && ((param_3 == 100 || (param_3 == 0x65)))) {
    FUN_00527140(&local_c,param_1);
    if ((int *)local_c == (int *)0x0) {
LAB_005bf11e:
      dVar6 = local_c;
      local_c = (double)((ulonglong)local_c & 0xffffffff00000000);
      uVar7 = (ulonglong)local_c;
      if (((local_4 & 1) == 0) && (local_c._4_4_ = SUB84(dVar6,4), local_c._4_4_ != 0)) {
        local_c = (double)uVar7;
        FUN_00503db0();
      }
      return -1;
    }
    iVar9 = (**(code **)(*(int *)local_c + 0x40))();
    if (iVar9 < 1) {
      if (1 < param_6) {
        if (((local_4 & 2) == 0) && ((int *)local_c != (int *)0x0)) {
          FUN_00503db0();
        }
        goto LAB_005bf11e;
      }
      bVar10 = true;
    }
    if (((local_4 & 2) == 0) && ((int *)local_c != (int *)0x0)) {
      FUN_00503db0();
    }
    dVar6 = local_c;
    local_c = (double)((ulonglong)local_c & 0xffffffff00000000);
    dVar8 = local_c;
    local_c = dVar8;
    if (((local_4 & 1) == 0) &&
       (local_c._4_4_ = SUB84(dVar6,4), bVar11 = local_c._4_4_ != 0, bVar11)) {
      FUN_00503db0();
    }
  }
  local_18 = 0;
  if ((*(char *)(*(int *)(param_1 + 0x78) + 0x2a4) == '\x01') && (!bVar10)) {
    if ((param_3 == 100) && (param_8 != '\0')) {
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 0x10;
      if (*(uint *)(param_1 + 0x10) <= *(uint *)(param_1 + 8)) {
        FUN_00504050();
      }
      puVar5 = *(undefined1 **)(param_1 + 8);
      if (puVar5 != (undefined1 *)0x0) {
        *puVar5 = 2;
        puVar5[4] = param_8;
      }
      local_18 = 1;
    }
    iVar9 = FUN_005296a0();
    if (param_2 < 4) {
      iVar9 = iVar9 + 0x944 + param_2 * 0x24;
    }
    else {
      iVar9 = 0;
    }
    fVar3 = *(float *)(iVar9 + 0x14);
    fVar12 = (float10)FUN_0063bc90((double)(*(float *)(iVar9 + 0x18) + 0.5));
    *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 0x10;
    puVar1 = (uint *)(param_1 + 8);
    local_c = (double)(fVar12 / (float10)20.0);
    if (*(uint *)(param_1 + 0x10) <= *(uint *)(param_1 + 8)) {
      FUN_00504050();
    }
    puVar5 = (undefined1 *)*puVar1;
    if (puVar5 != (undefined1 *)0x0) {
      *puVar5 = 3;
      *(double *)(puVar5 + 4) = local_c;
    }
    fVar12 = (float10)FUN_0063bc90((double)(fVar3 + 0.5));
    *puVar1 = *puVar1 + 0x10;
    local_c = (double)(fVar12 / (float10)20.0);
    if (*(uint *)(param_1 + 0x10) <= *puVar1) {
      FUN_00504050();
    }
    puVar5 = (undefined1 *)*puVar1;
    if (puVar5 != (undefined1 *)0x0) {
      *puVar5 = 3;
      *(double *)(puVar5 + 4) = local_c;
    }
    *puVar1 = *puVar1 + 0x10;
    if (*(uint *)(param_1 + 0x10) <= *puVar1) {
      FUN_00504050();
    }
    puVar5 = (undefined1 *)*puVar1;
    if (puVar5 != (undefined1 *)0x0) {
      *puVar5 = 4;
      *(uint *)(puVar5 + 4) = param_2;
    }
    local_18 = local_18 + 3;
  }
  if (param_3 != 0x66) {
    if ((param_5 == (int *)0x0) || ((param_3 != 0x67 && (bVar10)))) {
      if (local_18 == 0) goto LAB_005bf319;
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 0x10;
      if (*(uint *)(param_1 + 0x10) <= *(uint *)(param_1 + 8)) {
        FUN_00504050();
      }
      if (*(undefined1 **)(param_1 + 8) != (undefined1 *)0x0) {
        **(undefined1 **)(param_1 + 8) = 1;
      }
    }
    else {
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 0x10;
      if (*(uint *)(param_1 + 0x10) <= *(uint *)(param_1 + 8)) {
        FUN_00504050();
      }
      puVar5 = *(undefined1 **)(param_1 + 8);
      if (puVar5 != (undefined1 *)0x0) {
        *puVar5 = 5;
        iVar9 = *param_5;
        *(int *)(puVar5 + 4) = iVar9;
        piVar2 = (int *)(iVar9 + 8);
        *piVar2 = *piVar2 + 1;
      }
    }
    local_18 = local_18 + 1;
  }
LAB_005bf319:
  if (99 < param_3) {
    if (param_3 < 0x66) {
      if ((param_6 == 0) || (bVar10)) {
        if (local_18 == 0) {
          return 0;
        }
        *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 0x10;
        if (*(uint *)(param_1 + 0x10) <= *(uint *)(param_1 + 8)) {
          FUN_00504050();
        }
        if (*(undefined1 **)(param_1 + 8) != (undefined1 *)0x0) {
          **(undefined1 **)(param_1 + 8) = 1;
        }
      }
      else {
        local_c = (double)(int)param_6;
        if ((int)param_6 < 0) {
          local_c = local_c + 4294967296.0;
        }
        *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 0x10;
        if (*(uint *)(param_1 + 0x10) <= *(uint *)(param_1 + 8)) {
          FUN_00504050();
        }
        puVar5 = *(undefined1 **)(param_1 + 8);
        if (puVar5 != (undefined1 *)0x0) {
          *(double *)(puVar5 + 4) = local_c;
          *puVar5 = 3;
          return local_18 + 1;
        }
      }
    }
    else {
      if (param_3 != 0x67) {
        return local_18;
      }
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 0x10;
      if (*(uint *)(param_1 + 0x10) <= *(uint *)(param_1 + 8)) {
        FUN_00504050();
      }
      puVar5 = *(undefined1 **)(param_1 + 8);
      if (puVar5 != (undefined1 *)0x0) {
        *(undefined4 *)(puVar5 + 4) = param_7;
        *puVar5 = 4;
        return local_18 + 1;
      }
    }
    local_18 = local_18 + 1;
  }
  return local_18;
}



============================================================
DISASSEMBLY
============================================================
005bf0a0 : SUB ESP,0x18
005bf0a3 : PUSH EBX
005bf0a4 : PUSH EBP
005bf0a5 : MOV EBP,dword ptr [ESP + 0x24]
005bf0a9 : MOV EAX,dword ptr [EBP + 0x78]
005bf0ac : MOV AL,byte ptr [EAX + 0x2a4]
005bf0b2 : CMP AL,0x1
005bf0b4 : PUSH ESI
005bf0b5 : MOV ESI,dword ptr [ESP + 0x30]
005bf0b9 : SETNZ byte ptr [ESP + 0x28]
005bf0be : PUSH EDI
005bf0bf : CMP AL,0x1
005bf0c1 : JNZ 0x005bf172
005bf0c7 : MOV EDI,dword ptr [ESP + 0x40]
005bf0cb : XOR EBX,EBX
005bf0cd : CMP EDI,EBX
005bf0cf : JBE 0x005bf172
005bf0d5 : CMP ESI,0x64
005bf0d8 : JZ 0x005bf0e3
005bf0da : CMP ESI,0x65
005bf0dd : JNZ 0x005bf172
005bf0e3 : PUSH EBP
005bf0e4 : LEA ECX,[ESP + 0x20]
005bf0e8 : PUSH ECX
005bf0e9 : MOV ECX,dword ptr [ESP + 0x40]
005bf0ed : CALL 0x00527140
005bf0f2 : MOV ECX,dword ptr [ESP + 0x1c]
005bf0f6 : CMP ECX,EBX
005bf0f8 : JZ 0x005bf11e
005bf0fa : MOV EDX,dword ptr [ECX]
005bf0fc : MOV EAX,dword ptr [EDX + 0x40]
005bf0ff : CALL EAX
005bf101 : TEST EAX,EAX
005bf103 : JG 0x005bf146
005bf105 : CMP EDI,0x1
005bf108 : JBE 0x005bf141
005bf10a : TEST byte ptr [ESP + 0x24],0x2
005bf10f : JNZ 0x005bf11e
005bf111 : MOV ECX,dword ptr [ESP + 0x1c]
005bf115 : CMP ECX,EBX
005bf117 : JZ 0x005bf11e
005bf119 : CALL 0x00503db0
005bf11e : TEST byte ptr [ESP + 0x24],0x1
005bf123 : MOV dword ptr [ESP + 0x1c],EBX
005bf127 : JNZ 0x005bf136
005bf129 : MOV ECX,dword ptr [ESP + 0x20]
005bf12d : CMP ECX,EBX
005bf12f : JZ 0x005bf136
005bf131 : CALL 0x00503db0
005bf136 : POP EDI
005bf137 : POP ESI
005bf138 : POP EBP
005bf139 : OR EAX,0xffffffff
005bf13c : POP EBX
005bf13d : ADD ESP,0x18
005bf140 : RET
005bf141 : MOV byte ptr [ESP + 0x2c],0x1
005bf146 : TEST byte ptr [ESP + 0x24],0x2
005bf14b : JNZ 0x005bf15a
005bf14d : MOV ECX,dword ptr [ESP + 0x1c]
005bf151 : CMP ECX,EBX
005bf153 : JZ 0x005bf15a
005bf155 : CALL 0x00503db0
005bf15a : TEST byte ptr [ESP + 0x24],0x1
005bf15f : MOV dword ptr [ESP + 0x1c],EBX
005bf163 : JNZ 0x005bf172
005bf165 : MOV ECX,dword ptr [ESP + 0x20]
005bf169 : CMP ECX,EBX
005bf16b : JZ 0x005bf172
005bf16d : CALL 0x00503db0
005bf172 : MOV ECX,dword ptr [EBP + 0x78]
005bf175 : CMP byte ptr [ECX + 0x2a4],0x1
005bf17c : MOV dword ptr [ESP + 0x10],0x0
005bf184 : JNZ 0x005bf2a9
005bf18a : CMP byte ptr [ESP + 0x2c],0x0
005bf18f : JNZ 0x005bf2a9
005bf195 : CMP ESI,0x64
005bf198 : JNZ 0x005bf1cc
005bf19a : MOV BL,byte ptr [ESP + 0x48]
005bf19e : TEST BL,BL
005bf1a0 : JZ 0x005bf1cc
005bf1a2 : ADD dword ptr [EBP + 0x8],0x10
005bf1a6 : MOV EAX,dword ptr [EBP + 0x8]
005bf1a9 : CMP EAX,dword ptr [EBP + 0x10]
005bf1ac : LEA ESI,[EBP + 0x8]
005bf1af : JC 0x005bf1b8
005bf1b1 : MOV ECX,ESI
005bf1b3 : CALL 0x00504050
005bf1b8 : MOV ESI,dword ptr [ESI]
005bf1ba : TEST ESI,ESI
005bf1bc : JZ 0x005bf1c4
005bf1be : MOV byte ptr [ESI],0x2
005bf1c1 : MOV byte ptr [ESI + 0x4],BL
005bf1c4 : MOV dword ptr [ESP + 0x10],0x1
005bf1cc : MOV ECX,EBP
005bf1ce : CALL 0x005296a0
005bf1d3 : MOV EDI,dword ptr [ESP + 0x30]
005bf1d7 : CMP EDI,0x4
005bf1da : JC 0x005bf1e0
005bf1dc : XOR EAX,EAX
005bf1de : JMP 0x005bf1ea
005bf1e0 : LEA EDX,[EDI + EDI*0x8]
005bf1e3 : LEA EAX,[EAX + EDX*0x4 + 0x944]
005bf1ea : FLD float ptr [EAX + 0x14]
005bf1ed : SUB ESP,0x8
005bf1f0 : FSTP float ptr [ESP + 0x1c]
005bf1f4 : FLD float ptr [EAX + 0x18]
005bf1f7 : FSTP float ptr [ESP + 0x20]
005bf1fb : FLD float ptr [ESP + 0x20]
005bf1ff : FADD double ptr [0x00cdf120]
005bf205 : FSTP double ptr [ESP]
005bf208 : CALL 0x0063bc90
005bf20d : FDIV double ptr [0x00b86058]
005bf213 : ADD dword ptr [EBP + 0x8],0x10
005bf217 : MOV EAX,dword ptr [EBP + 0x8]
005bf21a : LEA ESI,[EBP + 0x8]
005bf21d : ADD ESP,0x8
005bf220 : FSTP double ptr [ESP + 0x1c]
005bf224 : CMP EAX,dword ptr [ESI + 0x8]
005bf227 : JC 0x005bf230
005bf229 : MOV ECX,ESI
005bf22b : CALL 0x00504050
005bf230 : MOV EAX,dword ptr [ESI]
005bf232 : TEST EAX,EAX
005bf234 : JZ 0x005bf240
005bf236 : FLD double ptr [ESP + 0x1c]
005bf23a : MOV byte ptr [EAX],0x3
005bf23d : FSTP double ptr [EAX + 0x4]
005bf240 : FLD float ptr [ESP + 0x14]
005bf244 : SUB ESP,0x8
005bf247 : FADD double ptr [0x00cdf120]
005bf24d : FSTP double ptr [ESP]
005bf250 : CALL 0x0063bc90
005bf255 : FDIV double ptr [0x00b86058]
005bf25b : ADD dword ptr [ESI],0x10
005bf25e : MOV EAX,dword ptr [ESI]
005bf260 : ADD ESP,0x8
005bf263 : FSTP double ptr [ESP + 0x1c]
005bf267 : CMP EAX,dword ptr [ESI + 0x8]
005bf26a : JC 0x005bf273
005bf26c : MOV ECX,ESI
005bf26e : CALL 0x00504050
005bf273 : MOV EAX,dword ptr [ESI]
005bf275 : TEST EAX,EAX
005bf277 : JZ 0x005bf283
005bf279 : FLD double ptr [ESP + 0x1c]
005bf27d : MOV byte ptr [EAX],0x3
005bf280 : FSTP double ptr [EAX + 0x4]
005bf283 : ADD dword ptr [ESI],0x10
005bf286 : MOV EAX,dword ptr [ESI]
005bf288 : CMP EAX,dword ptr [ESI + 0x8]
005bf28b : JC 0x005bf294
005bf28d : MOV ECX,ESI
005bf28f : CALL 0x00504050
005bf294 : MOV ESI,dword ptr [ESI]
005bf296 : TEST ESI,ESI
005bf298 : JZ 0x005bf2a0
005bf29a : MOV byte ptr [ESI],0x4
005bf29d : MOV dword ptr [ESI + 0x4],EDI
005bf2a0 : ADD dword ptr [ESP + 0x10],0x3
005bf2a5 : MOV ESI,dword ptr [ESP + 0x34]
005bf2a9 : CMP ESI,0x66
005bf2ac : JZ 0x005bf319
005bf2ae : MOV EDI,dword ptr [ESP + 0x3c]
005bf2b2 : TEST EDI,EDI
005bf2b4 : JZ 0x005bf2eb
005bf2b6 : CMP ESI,0x67
005bf2b9 : JZ 0x005bf2c2
005bf2bb : CMP byte ptr [ESP + 0x2c],0x0
005bf2c0 : JNZ 0x005bf2eb
005bf2c2 : ADD dword ptr [EBP + 0x8],0x10
005bf2c6 : MOV EAX,dword ptr [EBP + 0x8]
005bf2c9 : CMP EAX,dword ptr [EBP + 0x10]
005bf2cc : LEA ESI,[EBP + 0x8]
005bf2cf : JC 0x005bf2d8
005bf2d1 : MOV ECX,ESI
005bf2d3 : CALL 0x00504050
005bf2d8 : MOV ESI,dword ptr [ESI]
005bf2da : TEST ESI,ESI
005bf2dc : JZ 0x005bf311
005bf2de : MOV byte ptr [ESI],0x5
005bf2e1 : MOV EAX,dword ptr [EDI]
005bf2e3 : MOV dword ptr [ESI + 0x4],EAX
005bf2e6 : INC dword ptr [EAX + 0x8]
005bf2e9 : JMP 0x005bf311
005bf2eb : CMP dword ptr [ESP + 0x10],0x0
005bf2f0 : JLE 0x005bf319
005bf2f2 : ADD dword ptr [EBP + 0x8],0x10
005bf2f6 : MOV EAX,dword ptr [EBP + 0x8]
005bf2f9 : CMP EAX,dword ptr [EBP + 0x10]
005bf2fc : LEA ESI,[EBP + 0x8]
005bf2ff : JC 0x005bf308
005bf301 : MOV ECX,ESI
005bf303 : CALL 0x00504050
005bf308 : MOV ESI,dword ptr [ESI]
005bf30a : TEST ESI,ESI
005bf30c : JZ 0x005bf311
005bf30e : MOV byte ptr [ESI],0x1
005bf311 : MOV ESI,dword ptr [ESP + 0x34]
005bf315 : INC dword ptr [ESP + 0x10]
005bf319 : CMP ESI,0x64
005bf31c : JL 0x005bf3ef
005bf322 : CMP ESI,0x65
005bf325 : JLE 0x005bf36a
005bf327 : CMP ESI,0x67
005bf32a : JNZ 0x005bf3ef
005bf330 : ADD dword ptr [EBP + 0x8],0x10
005bf334 : MOV EAX,dword ptr [EBP + 0x8]
005bf337 : CMP EAX,dword ptr [EBP + 0x10]
005bf33a : LEA ESI,[EBP + 0x8]
005bf33d : JC 0x005bf346
005bf33f : MOV ECX,ESI
005bf341 : CALL 0x00504050
005bf346 : MOV ESI,dword ptr [ESI]
005bf348 : TEST ESI,ESI
005bf34a : JZ 0x005bf3eb
005bf350 : MOV EAX,dword ptr [ESP + 0x44]
005bf354 : INC dword ptr [ESP + 0x10]
005bf358 : POP EDI
005bf359 : MOV dword ptr [ESI + 0x4],EAX
005bf35c : MOV EAX,dword ptr [ESP + 0xc]
005bf360 : MOV byte ptr [ESI],0x4
005bf363 : POP ESI
005bf364 : POP EBP
005bf365 : POP EBX
005bf366 : ADD ESP,0x18
005bf369 : RET
005bf36a : MOV EAX,dword ptr [ESP + 0x40]
005bf36e : TEST EAX,EAX
005bf370 : JZ 0x005bf3c5
005bf372 : CMP byte ptr [ESP + 0x2c],0x0
005bf377 : JNZ 0x005bf3c5
005bf379 : MOV dword ptr [ESP + 0x2c],EAX
005bf37d : FILD dword ptr [ESP + 0x2c]
005bf381 : TEST EAX,EAX
005bf383 : JGE 0x005bf38b
005bf385 : FADD double ptr [0x00cdf6f8]
005bf38b : ADD dword ptr [EBP + 0x8],0x10
005bf38f : FSTP double ptr [ESP + 0x1c]
005bf393 : MOV EAX,dword ptr [EBP + 0x8]
005bf396 : CMP EAX,dword ptr [EBP + 0x10]
005bf399 : LEA ESI,[EBP + 0x8]
005bf39c : JC 0x005bf3a5
005bf39e : MOV ECX,ESI
005bf3a0 : CALL 0x00504050
005bf3a5 : MOV ESI,dword ptr [ESI]
005bf3a7 : TEST ESI,ESI
005bf3a9 : JZ 0x005bf3eb
005bf3ab : FLD double ptr [ESP + 0x1c]
005bf3af : INC dword ptr [ESP + 0x10]
005bf3b3 : MOV EAX,dword ptr [ESP + 0x10]
005bf3b7 : FSTP double ptr [ESI + 0x4]
005bf3ba : POP EDI
005bf3bb : MOV byte ptr [ESI],0x3
005bf3be : POP ESI
005bf3bf : POP EBP
005bf3c0 : POP EBX
005bf3c1 : ADD ESP,0x18
005bf3c4 : RET
005bf3c5 : CMP dword ptr [ESP + 0x10],0x0
005bf3ca : JLE 0x005bf3ef
005bf3cc : ADD dword ptr [EBP + 0x8],0x10
005bf3d0 : MOV EAX,dword ptr [EBP + 0x8]
005bf3d3 : CMP EAX,dword ptr [EBP + 0x10]
005bf3d6 : LEA ESI,[EBP + 0x8]
005bf3d9 : JC 0x005bf3e2
005bf3db : MOV ECX,ESI
005bf3dd : CALL 0x00504050
005bf3e2 : MOV ESI,dword ptr [ESI]
005bf3e4 : TEST ESI,ESI
005bf3e6 : JZ 0x005bf3eb
005bf3e8 : MOV byte ptr [ESI],0x1
005bf3eb : INC dword ptr [ESP + 0x10]
005bf3ef : MOV EAX,dword ptr [ESP + 0x10]
005bf3f3 : POP EDI
005bf3f4 : POP ESI
005bf3f5 : POP EBP
005bf3f6 : POP EBX
005bf3f7 : ADD ESP,0x18
005bf3fa : RET

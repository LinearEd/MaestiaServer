PROGRAM  : Maestia.exe
FUNCTION : FUN_005a9c10
ENTRY    : 005a9c10
BODY     : [[005a9c10, 005a9d46]]

============================================================
DECOMPILED C CODE
============================================================

void * FUN_005a9c10(int param_1,void *param_2,uint param_3)

{
  ushort uVar1;
  byte bVar2;
  void *pvVar3;
  int in_ECX;
  uint uVar4;
  uint _Size;
  uint local_4;
  
  local_4 = 0;
  if (param_3 < 0x10) {
    param_3 = 0x10;
  }
  _Size = *(uint *)(in_ECX + 0x10) + param_3 & ~*(uint *)(in_ECX + 0x10);
  uVar1 = *(ushort *)(param_1 + 0xc);
  if (uVar1 < 8) {
    bVar2 = (byte)*(undefined4 *)(in_ECX + 0xc);
    uVar4 = uVar1 + 1 << (bVar2 & 0x1f);
    if (_Size <= uVar4) {
      return param_2;
    }
    local_4 = uVar4;
    pvVar3 = (void *)FUN_005a9440(_Size,1 << ((char)*(undefined4 *)(&DAT_00b8f2fc + (uint)uVar1 * 4)
                                              + bVar2 & 0x1f));
    if (pvVar3 != (void *)0x0) {
      if (uVar4 < _Size) {
        _Size = uVar4;
      }
      _memcpy(pvVar3,param_2,_Size);
      FUN_005a9580(param_1,param_2);
    }
    return pvVar3;
  }
  if (uVar1 == 10) {
    pvVar3 = (void *)FUN_005f7100(param_1,param_2,_Size,&local_4);
    if (pvVar3 == (void *)0x0) {
      bVar2 = FUN_005f73f0(param_1,param_2,local_4);
      uVar4 = local_4;
      pvVar3 = (void *)FUN_005a9440(_Size,1 << (bVar2 & 0x1f));
      if (pvVar3 != (void *)0x0) {
        if (uVar4 < _Size) {
          _Size = uVar4;
        }
        _memcpy(pvVar3,param_2,_Size);
        FUN_005a9580(param_1,param_2);
      }
      return pvVar3;
    }
  }
  else {
    pvVar3 = (void *)FUN_005a99a0(param_1,param_2,_Size);
  }
  return pvVar3;
}



============================================================
DISASSEMBLY
============================================================
005a9c10 : PUSH ECX
005a9c11 : PUSH EBX
005a9c12 : PUSH EBP
005a9c13 : PUSH ESI
005a9c14 : PUSH EDI
005a9c15 : MOV EDI,ECX
005a9c17 : MOV ECX,dword ptr [ESP + 0x20]
005a9c1b : MOV dword ptr [ESP + 0x10],0x0
005a9c23 : CMP ECX,0x10
005a9c26 : JNC 0x005a9c2d
005a9c28 : MOV ECX,0x10
005a9c2d : MOV EAX,dword ptr [EDI + 0x10]
005a9c30 : LEA ESI,[EAX + ECX*0x1]
005a9c33 : MOV ECX,dword ptr [ESP + 0x18]
005a9c37 : NOT EAX
005a9c39 : AND ESI,EAX
005a9c3b : MOVZX EAX,word ptr [ECX + 0xc]
005a9c3f : CMP AX,0x7
005a9c43 : JA 0x005a9cb3
005a9c45 : MOV ECX,dword ptr [EDI + 0xc]
005a9c48 : MOVZX EAX,AX
005a9c4b : LEA EDX,[EAX + 0x1]
005a9c4e : SHL EDX,CL
005a9c50 : MOV dword ptr [ESP + 0x10],EDX
005a9c54 : CMP ESI,EDX
005a9c56 : JA 0x005a9c64
005a9c58 : MOV EAX,dword ptr [ESP + 0x1c]
005a9c5c : POP EDI
005a9c5d : POP ESI
005a9c5e : POP EBP
005a9c5f : POP EBX
005a9c60 : POP ECX
005a9c61 : RET 0xc
005a9c64 : MOV EAX,dword ptr [EAX*0x4 + 0xb8f2fc]
005a9c6b : ADD EAX,ECX
005a9c6d : MOV EBP,EDX
005a9c6f : MOV ECX,EAX
005a9c71 : MOV EDX,0x1
005a9c76 : SHL EDX,CL
005a9c78 : MOV ECX,EDI
005a9c7a : PUSH EDX
005a9c7b : PUSH ESI
005a9c7c : CALL 0x005a9440
005a9c81 : MOV EBX,EAX
005a9c83 : TEST EBX,EBX
005a9c85 : JZ 0x005a9ca9
005a9c87 : CMP EBP,ESI
005a9c89 : JNC 0x005a9c8d
005a9c8b : MOV ESI,EBP
005a9c8d : PUSH ESI
005a9c8e : MOV ESI,dword ptr [ESP + 0x20]
005a9c92 : PUSH ESI
005a9c93 : PUSH EBX
005a9c94 : CALL 0x0063ae40
005a9c99 : MOV EAX,dword ptr [ESP + 0x24]
005a9c9d : ADD ESP,0xc
005a9ca0 : PUSH ESI
005a9ca1 : PUSH EAX
005a9ca2 : MOV ECX,EDI
005a9ca4 : CALL 0x005a9580
005a9ca9 : POP EDI
005a9caa : POP ESI
005a9cab : POP EBP
005a9cac : MOV EAX,EBX
005a9cae : POP EBX
005a9caf : POP ECX
005a9cb0 : RET 0xc
005a9cb3 : CMP AX,0xa
005a9cb7 : JNZ 0x005a9d31
005a9cb9 : MOV EBP,dword ptr [ESP + 0x1c]
005a9cbd : LEA EDX,[ESP + 0x10]
005a9cc1 : PUSH EDX
005a9cc2 : PUSH ESI
005a9cc3 : PUSH EBP
005a9cc4 : LEA EBX,[EDI + 0x14]
005a9cc7 : PUSH ECX
005a9cc8 : MOV ECX,EBX
005a9cca : CALL 0x005f7100
005a9ccf : TEST EAX,EAX
005a9cd1 : JNZ 0x005a9d3f
005a9cd3 : MOV EAX,dword ptr [ESP + 0x10]
005a9cd7 : MOV ECX,dword ptr [ESP + 0x18]
005a9cdb : PUSH EAX
005a9cdc : PUSH EBP
005a9cdd : PUSH ECX
005a9cde : MOV ECX,EBX
005a9ce0 : CALL 0x005f73f0
005a9ce5 : MOV EDX,dword ptr [ESP + 0x10]
005a9ce9 : MOV dword ptr [ESP + 0x1c],EDX
005a9ced : MOV ECX,EAX
005a9cef : MOV EDX,0x1
005a9cf4 : SHL EDX,CL
005a9cf6 : MOV ECX,EDI
005a9cf8 : PUSH EDX
005a9cf9 : PUSH ESI
005a9cfa : CALL 0x005a9440
005a9cff : MOV EBX,EAX
005a9d01 : TEST EBX,EBX
005a9d03 : JZ 0x005a9d27
005a9d05 : MOV EAX,dword ptr [ESP + 0x1c]
005a9d09 : CMP EAX,ESI
005a9d0b : JNC 0x005a9d0f
005a9d0d : MOV ESI,EAX
005a9d0f : PUSH ESI
005a9d10 : PUSH EBP
005a9d11 : PUSH EBX
005a9d12 : CALL 0x0063ae40
005a9d17 : MOV EAX,dword ptr [ESP + 0x24]
005a9d1b : ADD ESP,0xc
005a9d1e : PUSH EBP
005a9d1f : PUSH EAX
005a9d20 : MOV ECX,EDI
005a9d22 : CALL 0x005a9580
005a9d27 : POP EDI
005a9d28 : POP ESI
005a9d29 : POP EBP
005a9d2a : MOV EAX,EBX
005a9d2c : POP EBX
005a9d2d : POP ECX
005a9d2e : RET 0xc
005a9d31 : MOV EDX,dword ptr [ESP + 0x1c]
005a9d35 : PUSH ESI
005a9d36 : PUSH EDX
005a9d37 : PUSH ECX
005a9d38 : MOV ECX,EDI
005a9d3a : CALL 0x005a99a0
005a9d3f : POP EDI
005a9d40 : POP ESI
005a9d41 : POP EBP
005a9d42 : POP EBX
005a9d43 : POP ECX
005a9d44 : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : FUN_006ee3d0
ENTRY    : 006ee3d0
BODY     : [[006ee3d0, 006ee41d]]

============================================================
DECOMPILED C CODE
============================================================

LPSTR FUN_006ee3d0(LPCWSTR param_1)

{
  LPSTR lpMultiByteStr;
  int iVar1;
  
  iVar1 = *(int *)ThreadLocalStoragePointer;
  *(int *)(iVar1 + 0x30) = *(int *)(iVar1 + 0x30) + 1;
  iVar1 = (*(int *)(iVar1 + 0x30) % 100) * 0x400 + iVar1;
  lpMultiByteStr = (LPSTR)(iVar1 + 0x128cb8);
  WideCharToMultiByte(0,0,param_1,-1,lpMultiByteStr,0x400,(LPCSTR)0x0,(LPBOOL)0x0);
  *(undefined1 *)(iVar1 + 0x1290b7) = 0;
  return lpMultiByteStr;
}



============================================================
DISASSEMBLY
============================================================
006ee3d0 : PUSH EBP
006ee3d1 : MOV EBP,ESP
006ee3d3 : MOV EAX,FS:[0x2c]
006ee3d9 : MOV ECX,dword ptr [EAX]
006ee3db : INC dword ptr [ECX + 0x30]
006ee3de : MOV EAX,dword ptr [ECX + 0x30]
006ee3e1 : PUSH ESI
006ee3e2 : CDQ
006ee3e3 : MOV ESI,0x64
006ee3e8 : IDIV ESI
006ee3ea : PUSH EDI
006ee3eb : PUSH 0x0
006ee3ed : PUSH 0x0
006ee3ef : PUSH 0x400
006ee3f4 : SHL EDX,0xa
006ee3f7 : LEA ESI,[EDX + ECX*0x1]
006ee3fa : MOV ECX,dword ptr [EBP + 0x8]
006ee3fd : LEA EDI,[ESI + 0x128cb8]
006ee403 : PUSH EDI
006ee404 : PUSH -0x1
006ee406 : PUSH ECX
006ee407 : PUSH 0x0
006ee409 : PUSH 0x0
006ee40b : CALL dword ptr [0x00b85130]
006ee411 : MOV EAX,EDI
006ee413 : POP EDI
006ee414 : MOV byte ptr [ESI + 0x1290b7],0x0
006ee41b : POP ESI
006ee41c : POP EBP
006ee41d : RET

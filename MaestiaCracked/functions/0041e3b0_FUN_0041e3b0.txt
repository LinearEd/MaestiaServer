PROGRAM  : Maestia.exe
FUNCTION : FUN_0041e3b0
ENTRY    : 0041e3b0
BODY     : [[0041e3b0, 0041e517] [0041e51e, 0041e538] [0041e57d, 0041e615] [0041e633, 0041e6b0]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0041e3b0(int param_1,int param_2,uint param_3)

{
  uint *puVar1;
  int iVar2;
  uint uVar3;
  undefined4 uVar4;
  int iVar5;
  uint uStack_68;
  uint local_4c;
  uint local_48;
  undefined1 local_44 [44];
  uint local_18;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7c0a4;
  local_10 = ExceptionList;
  uStack_68 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&uStack_68;
  ExceptionList = &local_10;
  iVar2 = *(int *)(param_1 + 4);
  if (iVar2 == 0) {
    local_4c = 0;
  }
  else {
    local_4c = (*(int *)(param_1 + 0xc) - iVar2) / 0x2c;
  }
  iVar5 = *(int *)(param_1 + 8);
  iVar2 = (iVar5 - iVar2) / 0x2c;
  local_18 = uStack_68;
  puVar1 = &uStack_68;
  if (iVar2 == 0x5d1745d) {
    iVar2 = FUN_00429be0();
    puVar1 = (uint *)local_14;
  }
  local_14 = (undefined1 *)puVar1;
  uVar3 = iVar2 + 1;
  if (local_4c < uVar3) {
    if (0x5d1745d - (local_4c >> 1) < local_4c) {
      local_4c = 0;
    }
    else {
      local_4c = local_4c + (local_4c >> 1);
    }
    if (local_4c < uVar3) {
      local_4c = uVar3;
    }
    iVar2 = FUN_0041e790();
    local_8 = 0;
    FUN_0041e0e0(param_3);
    FUN_0041e760(*(undefined4 *)(param_1 + 4),param_2);
    FUN_0041e760(param_2,*(undefined4 *)(param_1 + 8));
    local_8 = 0xffffffff;
    if (*(int *)(param_1 + 4) != 0) {
      FUN_0041e390();
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    *(uint *)(param_1 + 0xc) = local_4c * 0x2c + iVar2;
    *(int *)(param_1 + 8) =
         ((*(int *)(param_1 + 8) - *(int *)(param_1 + 4)) / 0x2c + 1) * 0x2c + iVar2;
    *(int *)(param_1 + 4) = iVar2;
  }
  else {
    iVar5 = iVar5 - param_2;
    iVar2 = iVar5 >> 0x1f;
    if (iVar5 / 0x2c + iVar2 == iVar2) {
      FUN_0041e6c0(local_44);
      local_8 = 2;
      FUN_0041e760(param_2,*(undefined4 *)(param_1 + 8));
      local_8 = CONCAT31(local_8._1_3_,3);
      FUN_0041e0e0(local_44);
      local_8 = 2;
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 0x2c;
      FUN_0041e980(*(int *)(param_1 + 8) + -0x2c);
    }
    else {
      FUN_0041e6c0(local_44);
      local_8 = 5;
      uVar4 = FUN_0041e760(*(int *)(param_1 + 8) + -0x2c,*(int *)(param_1 + 8));
      *(undefined4 *)(param_1 + 8) = uVar4;
      local_48 = param_3 & 0xffffff00;
      FUN_0041e9e0(param_2,local_48,local_48,local_48);
      FUN_0041e980(param_2 + 0x2c);
    }
    local_8 = 0xffffffff;
    FUN_004427d0(local_44);
  }
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0041e3b0 : PUSH EBP
0041e3b1 : MOV EBP,ESP
0041e3b3 : PUSH -0x1
0041e3b5 : PUSH 0xb7c0a4
0041e3ba : MOV EAX,FS:[0x0]
0041e3c0 : PUSH EAX
0041e3c1 : SUB ESP,0x48
0041e3c4 : MOV EAX,[0x00d66fa0]
0041e3c9 : XOR EAX,EBP
0041e3cb : MOV dword ptr [EBP + -0x14],EAX
0041e3ce : PUSH EBX
0041e3cf : PUSH ESI
0041e3d0 : PUSH EDI
0041e3d1 : PUSH EAX
0041e3d2 : LEA EAX,[EBP + -0xc]
0041e3d5 : MOV FS:[0x0],EAX
0041e3db : MOV dword ptr [EBP + -0x10],ESP
0041e3de : MOV EBX,dword ptr [EBP + 0x8]
0041e3e1 : MOV dword ptr [EBP + -0x4c],EBX
0041e3e4 : MOV EAX,dword ptr [EBP + 0x10]
0041e3e7 : MOV dword ptr [EBP + -0x44],EAX
0041e3ea : MOV ECX,dword ptr [EBX + 0x4]
0041e3ed : TEST ECX,ECX
0041e3ef : JNZ 0x0041e3f5
0041e3f1 : XOR EDI,EDI
0041e3f3 : JMP 0x0041e40d
0041e3f5 : MOV EDX,dword ptr [EBX + 0xc]
0041e3f8 : SUB EDX,ECX
0041e3fa : MOV EAX,0x2e8ba2e9
0041e3ff : IMUL EDX
0041e401 : SAR EDX,0x3
0041e404 : MOV EAX,EDX
0041e406 : SHR EAX,0x1f
0041e409 : ADD EAX,EDX
0041e40b : MOV EDI,EAX
0041e40d : MOV ESI,dword ptr [EBX + 0x8]
0041e410 : MOV EDX,ESI
0041e412 : SUB EDX,ECX
0041e414 : MOV EAX,0x2e8ba2e9
0041e419 : IMUL EDX
0041e41b : SAR EDX,0x3
0041e41e : MOV EAX,EDX
0041e420 : SHR EAX,0x1f
0041e423 : ADD EAX,EDX
0041e425 : MOV ECX,0x5d1745d
0041e42a : SUB ECX,EAX
0041e42c : CMP ECX,0x1
0041e42f : JNC 0x0041e436
0041e431 : CALL 0x00429be0
0041e436 : INC EAX
0041e437 : CMP EDI,EAX
0041e439 : JNC 0x0041e57d
0041e43f : MOV ECX,EDI
0041e441 : SHR ECX,0x1
0041e443 : MOV EDX,0x5d1745d
0041e448 : SUB EDX,ECX
0041e44a : CMP EDX,EDI
0041e44c : JNC 0x0041e45a
0041e44e : MOV dword ptr [EBP + -0x48],0x0
0041e455 : MOV EDI,dword ptr [EBP + -0x48]
0041e458 : JMP 0x0041e45f
0041e45a : ADD EDI,ECX
0041e45c : MOV dword ptr [EBP + -0x48],EDI
0041e45f : CMP EDI,EAX
0041e461 : JNC 0x0041e468
0041e463 : MOV dword ptr [EBP + -0x48],EAX
0041e466 : MOV EDI,EAX
0041e468 : MOV ECX,EDI
0041e46a : CALL 0x0041e790
0041e46f : MOV ESI,EAX
0041e471 : MOV dword ptr [EBP + -0x54],ESI
0041e474 : MOV ECX,dword ptr [EBP + 0xc]
0041e477 : SUB ECX,dword ptr [EBX + 0x4]
0041e47a : MOV EAX,0x2e8ba2e9
0041e47f : IMUL ECX
0041e481 : SAR EDX,0x3
0041e484 : MOV EAX,EDX
0041e486 : SHR EAX,0x1f
0041e489 : ADD EAX,EDX
0041e48b : MOV dword ptr [EBP + -0x4c],EAX
0041e48e : XOR ECX,ECX
0041e490 : MOV dword ptr [EBP + -0x50],ECX
0041e493 : MOV dword ptr [EBP + -0x4],ECX
0041e496 : MOV ECX,dword ptr [EBP + -0x44]
0041e499 : PUSH ECX
0041e49a : MOV EDI,EAX
0041e49c : IMUL EDI,EDI,0x2c
0041e49f : ADD EDI,ESI
0041e4a1 : MOV ESI,0x1
0041e4a6 : CALL 0x0041e0e0
0041e4ab : MOV dword ptr [EBP + -0x50],ESI
0041e4ae : MOV EDX,dword ptr [EBP + 0xc]
0041e4b1 : PUSH EDX
0041e4b2 : MOV EAX,dword ptr [EBX + 0x4]
0041e4b5 : PUSH EAX
0041e4b6 : MOV EDI,dword ptr [EBP + -0x54]
0041e4b9 : MOV EDX,EDI
0041e4bb : CALL 0x0041e760
0041e4c0 : MOV dword ptr [EBP + -0x50],0x2
0041e4c7 : MOV EDX,dword ptr [EBP + -0x4c]
0041e4ca : INC EDX
0041e4cb : IMUL EDX,EDX,0x2c
0041e4ce : ADD EDX,EDI
0041e4d0 : MOV ECX,dword ptr [EBX + 0x8]
0041e4d3 : PUSH ECX
0041e4d4 : MOV EAX,dword ptr [EBP + 0xc]
0041e4d7 : PUSH EAX
0041e4d8 : CALL 0x0041e760
0041e4dd : MOV dword ptr [EBP + -0x4],0xffffffff
0041e4e4 : MOV ECX,dword ptr [EBX + 0x8]
0041e4e7 : MOV ESI,dword ptr [EBX + 0x4]
0041e4ea : SUB ECX,ESI
0041e4ec : MOV EAX,0x2e8ba2e9
0041e4f1 : IMUL ECX
0041e4f3 : SAR EDX,0x3
0041e4f6 : MOV ECX,EDX
0041e4f8 : SHR ECX,0x1f
0041e4fb : LEA EDX,[EDX + ECX*0x1 + 0x1]
0041e4ff : MOV dword ptr [EBP + -0x44],EDX
0041e502 : TEST ESI,ESI
0041e504 : JZ 0x0041e51e
0041e506 : MOV EDI,dword ptr [EBX + 0x8]
0041e509 : MOV EAX,ESI
0041e50b : CALL 0x0041e390
0041e510 : MOV ECX,dword ptr [EBX + 0x4]
0041e513 : CALL 0x006f04e0
0041e51e : MOV EAX,dword ptr [EBP + -0x48]
0041e521 : IMUL EAX,EAX,0x2c
0041e524 : ADD EAX,EDI
0041e526 : MOV dword ptr [EBX + 0xc],EAX
0041e529 : IMUL EDX,EDX,0x2c
0041e52c : ADD EDX,EDI
0041e52e : MOV dword ptr [EBX + 0x8],EDX
0041e531 : MOV dword ptr [EBX + 0x4],EDI
0041e534 : JMP 0x0041e693
0041e57d : SUB ESI,dword ptr [EBP + 0xc]
0041e580 : MOV EAX,0x2e8ba2e9
0041e585 : IMUL ESI
0041e587 : SAR EDX,0x3
0041e58a : MOV EAX,EDX
0041e58c : SHR EAX,0x1f
0041e58f : ADD EAX,EDX
0041e591 : MOV EDI,dword ptr [EBP + -0x44]
0041e594 : CMP EAX,0x1
0041e597 : JNC 0x0041e633
0041e59d : LEA ECX,[EBP + -0x40]
0041e5a0 : PUSH ECX
0041e5a1 : CALL 0x0041e6c0
0041e5a6 : MOV dword ptr [EBP + -0x4],0x2
0041e5ad : MOV EAX,dword ptr [EBP + 0xc]
0041e5b0 : LEA EDX,[EAX + 0x2c]
0041e5b3 : MOV ECX,dword ptr [EBX + 0x8]
0041e5b6 : PUSH ECX
0041e5b7 : PUSH EAX
0041e5b8 : CALL 0x0041e760
0041e5bd : MOV byte ptr [EBP + -0x4],0x3
0041e5c1 : MOV EDI,dword ptr [EBX + 0x8]
0041e5c4 : LEA EDX,[EBP + -0x40]
0041e5c7 : PUSH EDX
0041e5c8 : MOV ECX,EDI
0041e5ca : SUB ECX,dword ptr [EBP + 0xc]
0041e5cd : MOV EAX,0x2e8ba2e9
0041e5d2 : IMUL ECX
0041e5d4 : SAR EDX,0x3
0041e5d7 : MOV EAX,EDX
0041e5d9 : SHR EAX,0x1f
0041e5dc : ADD EAX,EDX
0041e5de : MOV ESI,0x1
0041e5e3 : SUB ESI,EAX
0041e5e5 : CALL 0x0041e0e0
0041e5ea : MOV dword ptr [EBP + -0x4],0x2
0041e5f1 : ADD dword ptr [EBX + 0x8],0x2c
0041e5f5 : MOV EBX,dword ptr [EBX + 0x8]
0041e5f8 : LEA EAX,[EBX + -0x2c]
0041e5fb : PUSH EAX
0041e5fc : LEA EDI,[EBP + -0x40]
0041e5ff : MOV EAX,dword ptr [EBP + 0xc]
0041e602 : CALL 0x0041e980
0041e607 : ADD ESP,0x4
0041e60a : MOV dword ptr [EBP + -0x4],0xffffffff
0041e611 : MOV ECX,EDI
0041e613 : PUSH ECX
0041e614 : JMP 0x0041e68e
0041e633 : LEA EAX,[EBP + -0x40]
0041e636 : PUSH EAX
0041e637 : CALL 0x0041e6c0
0041e63c : MOV dword ptr [EBP + -0x4],0x5
0041e643 : MOV ESI,dword ptr [EBX + 0x8]
0041e646 : LEA EDI,[ESI + -0x2c]
0041e649 : PUSH ESI
0041e64a : PUSH EDI
0041e64b : MOV EDX,ESI
0041e64d : CALL 0x0041e760
0041e652 : MOV dword ptr [EBX + 0x8],EAX
0041e655 : MOV byte ptr [EBP + -0x44],0x0
0041e659 : MOV ECX,dword ptr [EBP + -0x44]
0041e65c : PUSH ECX
0041e65d : MOV EDX,dword ptr [EBP + -0x44]
0041e660 : PUSH EDX
0041e661 : MOV EAX,dword ptr [EBP + -0x44]
0041e664 : PUSH EAX
0041e665 : MOV ECX,dword ptr [EBP + 0xc]
0041e668 : PUSH ECX
0041e669 : MOV EAX,ESI
0041e66b : MOV ECX,EDI
0041e66d : CALL 0x0041e9e0
0041e672 : MOV EAX,dword ptr [EBP + 0xc]
0041e675 : LEA EDX,[EAX + 0x2c]
0041e678 : PUSH EDX
0041e679 : LEA EDI,[EBP + -0x40]
0041e67c : CALL 0x0041e980
0041e681 : ADD ESP,0x14
0041e684 : MOV dword ptr [EBP + -0x4],0xffffffff
0041e68b : MOV EAX,EDI
0041e68d : PUSH EAX
0041e68e : CALL 0x004427d0
0041e693 : MOV ECX,dword ptr [EBP + -0xc]
0041e696 : MOV dword ptr FS:[0x0],ECX
0041e69d : POP ECX
0041e69e : POP EDI
0041e69f : POP ESI
0041e6a0 : POP EBX
0041e6a1 : MOV ECX,dword ptr [EBP + -0x14]
0041e6a4 : XOR ECX,EBP
0041e6a6 : CALL 0x00633e6b
0041e6ab : MOV ESP,EBP
0041e6ad : POP EBP
0041e6ae : RET 0xc

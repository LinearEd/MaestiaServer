PROGRAM  : Maestia.exe
FUNCTION : FUN_0043ee10
ENTRY    : 0043ee10
BODY     : [[0043ee10, 0043efb3]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x0043ef2c) */

void FUN_0043ee10(void)

{
  ushort *puVar1;
  int iVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  uint uVar5;
  uint uVar6;
  ushort *puVar7;
  int unaff_ESI;
  undefined4 *puVar8;
  undefined4 *puVar9;
  undefined8 uVar10;
  
  if (*(uint *)(unaff_ESI + 0x24) <
      (*(int *)(unaff_ESI + 0x18) - *(int *)(unaff_ESI + 0x14) >> 2) - 1U) {
    if (*(uint *)(unaff_ESI + 0x20) < *(uint *)(unaff_ESI + 0x24)) {
      *(uint *)(unaff_ESI + 0x20) = *(uint *)(unaff_ESI + 0x20) * 2 + 1;
    }
  }
  else {
    *(int *)(unaff_ESI + 0x20) =
         (*(int *)(unaff_ESI + 0x18) - *(int *)(unaff_ESI + 0x14) >> 2) * 2 + -3;
    FUN_0044f4a0(*(undefined4 *)(unaff_ESI + 8));
  }
  uVar5 = (*(int *)(unaff_ESI + 0x24) - (*(uint *)(unaff_ESI + 0x20) >> 1)) - 1;
  puVar8 = *(undefined4 **)(uVar5 * 4 + *(int *)(unaff_ESI + 0x14));
  if (puVar8 != *(undefined4 **)(uVar5 * 4 + *(int *)(unaff_ESI + 0x14) + 4)) {
    do {
      if ((uint)puVar8[8] < 8) {
        puVar7 = (ushort *)(puVar8 + 3);
      }
      else {
        puVar7 = (ushort *)puVar8[3];
      }
      puVar1 = puVar7 + puVar8[7];
      uVar6 = 0x811c9dc5;
      for (; puVar7 != puVar1; puVar7 = puVar7 + 1) {
        uVar6 = uVar6 * 0x1000193 ^ (uint)*puVar7;
      }
      uVar10 = FUN_0063871f(uVar6 & 0x7fffffff,0x1f31d);
      uVar6 = (int)((ulonglong)uVar10 >> 0x20) * 0x41a7 + (int)uVar10 * -0xb14;
      if ((int)uVar6 < 0) {
        uVar6 = uVar6 + 0x7fffffff;
      }
      if ((*(uint *)(unaff_ESI + 0x20) & uVar6) == uVar5) {
        puVar9 = (undefined4 *)*puVar8;
      }
      else {
        puVar9 = (undefined4 *)*puVar8;
        if (puVar9 != *(undefined4 **)(unaff_ESI + 8)) {
          iVar2 = uVar5 * 4;
          puVar3 = *(undefined4 **)(iVar2 + *(int *)(unaff_ESI + 0x14));
          uVar6 = uVar5;
          while ((puVar8 == puVar3 &&
                 (*(undefined4 **)(iVar2 + *(int *)(unaff_ESI + 0x14)) = puVar9, uVar6 != 0))) {
            uVar6 = uVar6 - 1;
            iVar2 = uVar6 * 4;
            puVar3 = *(undefined4 **)(iVar2 + *(int *)(unaff_ESI + 0x14));
          }
          iVar2 = *(int *)(unaff_ESI + 8);
          *(undefined4 **)puVar8[1] = puVar9;
          *(int *)puVar9[1] = iVar2;
          **(undefined4 **)(iVar2 + 4) = puVar8;
          uVar4 = *(undefined4 *)(iVar2 + 4);
          *(undefined4 *)(iVar2 + 4) = puVar9[1];
          puVar9[1] = puVar8[1];
          puVar8[1] = uVar4;
          puVar8 = *(undefined4 **)(*(int *)(unaff_ESI + 8) + 4);
          *(int *)(*(int *)(unaff_ESI + 0x14) + 4 + *(int *)(unaff_ESI + 0x24) * 4) =
               *(int *)(unaff_ESI + 8);
        }
        for (uVar6 = *(uint *)(unaff_ESI + 0x24);
            (uVar5 < uVar6 &&
            (*(int *)(*(int *)(unaff_ESI + 0x14) + uVar6 * 4) == *(int *)(unaff_ESI + 8)));
            uVar6 = uVar6 - 1) {
          *(undefined4 **)(*(int *)(unaff_ESI + 0x14) + uVar6 * 4) = puVar8;
        }
        if (puVar9 == *(undefined4 **)(unaff_ESI + 8)) break;
      }
      puVar8 = puVar9;
    } while (puVar9 != *(undefined4 **)(uVar5 * 4 + 4 + *(int *)(unaff_ESI + 0x14)));
  }
  *(int *)(unaff_ESI + 0x24) = *(int *)(unaff_ESI + 0x24) + 1;
  return;
}



============================================================
DISASSEMBLY
============================================================
0043ee10 : PUSH EBP
0043ee11 : MOV EBP,ESP
0043ee13 : AND ESP,0xfffffff8
0043ee16 : MOV EDX,dword ptr [ESI + 0x18]
0043ee19 : SUB EDX,dword ptr [ESI + 0x14]
0043ee1c : MOV ECX,dword ptr [ESI + 0x24]
0043ee1f : LEA EAX,[ESI + 0x10]
0043ee22 : SUB ESP,0x8
0043ee25 : SAR EDX,0x2
0043ee28 : DEC EDX
0043ee29 : PUSH EBX
0043ee2a : PUSH EDI
0043ee2b : CMP EDX,ECX
0043ee2d : JA 0x0043ee4d
0043ee2f : MOV ECX,dword ptr [EAX + 0x8]
0043ee32 : SUB ECX,dword ptr [EAX + 0x4]
0043ee35 : MOV EDX,dword ptr [ESI + 0x8]
0043ee38 : SAR ECX,0x2
0043ee3b : LEA ECX,[ECX + ECX*0x1 + -0x3]
0043ee3f : MOV dword ptr [ESI + 0x20],ECX
0043ee42 : PUSH EDX
0043ee43 : ADD ECX,0x2
0043ee46 : CALL 0x0044f4a0
0043ee4b : JMP 0x0043ee5b
0043ee4d : MOV EAX,dword ptr [ESI + 0x20]
0043ee50 : CMP EAX,ECX
0043ee52 : JNC 0x0043ee5b
0043ee54 : LEA EAX,[EAX + EAX*0x1 + 0x1]
0043ee58 : MOV dword ptr [ESI + 0x20],EAX
0043ee5b : MOV ECX,dword ptr [ESI + 0x20]
0043ee5e : MOV EAX,dword ptr [ESI + 0x24]
0043ee61 : MOV EDX,dword ptr [ESI + 0x14]
0043ee64 : SHR ECX,0x1
0043ee66 : SUB EAX,ECX
0043ee68 : DEC EAX
0043ee69 : MOV dword ptr [ESP + 0x8],EAX
0043ee6d : ADD EAX,EAX
0043ee6f : ADD EAX,EAX
0043ee71 : MOV EDI,dword ptr [EAX + EDX*0x1]
0043ee74 : ADD EAX,EDX
0043ee76 : CMP EDI,dword ptr [EAX + 0x4]
0043ee79 : JZ 0x0043efab
0043ee7f : NOP
0043ee80 : CMP dword ptr [EDI + 0x20],0x8
0043ee84 : JC 0x0043ee8b
0043ee86 : MOV ECX,dword ptr [EDI + 0xc]
0043ee89 : JMP 0x0043ee8e
0043ee8b : LEA ECX,[EDI + 0xc]
0043ee8e : MOV EDX,dword ptr [EDI + 0x1c]
0043ee91 : LEA EDX,[ECX + EDX*0x2]
0043ee94 : MOV EAX,0x811c9dc5
0043ee99 : CMP ECX,EDX
0043ee9b : JZ 0x0043eeb2
0043ee9d : LEA ECX,[ECX]
0043eea0 : MOVZX EBX,word ptr [ECX]
0043eea3 : IMUL EAX,EAX,0x1000193
0043eea9 : ADD ECX,0x2
0043eeac : XOR EAX,EBX
0043eeae : CMP ECX,EDX
0043eeb0 : JNZ 0x0043eea0
0043eeb2 : AND EAX,0x7fffffff
0043eeb7 : PUSH 0x1f31d
0043eebc : PUSH EAX
0043eebd : CALL 0x0063871f
0043eec2 : IMUL EDX,EDX,0x41a7
0043eec8 : IMUL EAX,EAX,0xb14
0043eece : ADD ESP,0x8
0043eed1 : SUB EDX,EAX
0043eed3 : JNS 0x0043eedb
0043eed5 : ADD EDX,0x7fffffff
0043eedb : MOV EAX,dword ptr [ESI + 0x20]
0043eede : MOV ECX,dword ptr [ESP + 0x8]
0043eee2 : AND EAX,EDX
0043eee4 : CMP EAX,ECX
0043eee6 : JNZ 0x0043eeef
0043eee8 : MOV EDI,dword ptr [EDI]
0043eeea : JMP 0x0043ef97
0043eeef : MOV EDX,dword ptr [EDI]
0043eef1 : MOV dword ptr [ESP + 0xc],EDX
0043eef5 : CMP EDX,dword ptr [ESI + 0x8]
0043eef8 : JZ 0x0043ef6e
0043eefa : MOV EBX,dword ptr [ESI + 0x14]
0043eefd : MOV EAX,ECX
0043eeff : ADD ECX,ECX
0043ef01 : ADD ECX,ECX
0043ef03 : CMP EDI,dword ptr [ECX + EBX*0x1]
0043ef06 : JNZ 0x0043ef22
0043ef08 : MOV EBX,dword ptr [ESI + 0x14]
0043ef0b : MOV dword ptr [ECX + EBX*0x1],EDX
0043ef0e : TEST EAX,EAX
0043ef10 : JZ 0x0043ef22
0043ef12 : MOV EBX,dword ptr [ESI + 0x14]
0043ef15 : DEC EAX
0043ef16 : LEA ECX,[EAX*0x4 + 0x0]
0043ef1d : CMP EDI,dword ptr [ECX + EBX*0x1]
0043ef20 : JZ 0x0043ef08
0043ef22 : MOV EBX,dword ptr [ESI + 0x8]
0043ef25 : LEA EAX,[ESI + 0x4]
0043ef28 : CMP EAX,EAX
0043ef2a : JZ 0x0043ef39
0043ef2c : XOR ECX,ECX
0043ef2e : MOV EDX,EAX
0043ef30 : CALL 0x0043f020
0043ef35 : MOV EDX,dword ptr [ESP + 0xc]
0043ef39 : MOV ECX,dword ptr [EDI + 0x4]
0043ef3c : MOV dword ptr [ECX],EDX
0043ef3e : MOV EAX,dword ptr [EDX + 0x4]
0043ef41 : MOV dword ptr [EAX],EBX
0043ef43 : MOV ECX,dword ptr [EBX + 0x4]
0043ef46 : MOV dword ptr [ECX],EDI
0043ef48 : MOV EAX,dword ptr [EBX + 0x4]
0043ef4b : MOV ECX,dword ptr [EDX + 0x4]
0043ef4e : MOV dword ptr [EBX + 0x4],ECX
0043ef51 : MOV ECX,dword ptr [EDI + 0x4]
0043ef54 : MOV dword ptr [EDX + 0x4],ECX
0043ef57 : MOV dword ptr [EDI + 0x4],EAX
0043ef5a : MOV EAX,dword ptr [ESI + 0x8]
0043ef5d : MOV ECX,dword ptr [ESI + 0x24]
0043ef60 : MOV EBX,dword ptr [ESI + 0x14]
0043ef63 : MOV EDI,dword ptr [EAX + 0x4]
0043ef66 : MOV dword ptr [EBX + ECX*0x4 + 0x4],EAX
0043ef6a : MOV ECX,dword ptr [ESP + 0x8]
0043ef6e : MOV EAX,dword ptr [ESI + 0x24]
0043ef71 : CMP ECX,EAX
0043ef73 : JNC 0x0043ef90
0043ef75 : MOV ECX,dword ptr [ESI + 0x14]
0043ef78 : MOV EBX,dword ptr [ECX + EAX*0x4]
0043ef7b : LEA ECX,[ECX + EAX*0x4]
0043ef7e : CMP EBX,dword ptr [ESI + 0x8]
0043ef81 : JNZ 0x0043ef8c
0043ef83 : DEC EAX
0043ef84 : MOV dword ptr [ECX],EDI
0043ef86 : CMP dword ptr [ESP + 0x8],EAX
0043ef8a : JC 0x0043ef75
0043ef8c : MOV ECX,dword ptr [ESP + 0x8]
0043ef90 : CMP EDX,dword ptr [ESI + 0x8]
0043ef93 : JZ 0x0043efab
0043ef95 : MOV EDI,EDX
0043ef97 : MOV EDX,dword ptr [ESI + 0x14]
0043ef9a : LEA EAX,[ECX*0x4 + 0x0]
0043efa1 : CMP EDI,dword ptr [EAX + EDX*0x1 + 0x4]
0043efa5 : JNZ 0x0043ee80
0043efab : INC dword ptr [ESI + 0x24]
0043efae : POP EDI
0043efaf : POP EBX
0043efb0 : MOV ESP,EBP
0043efb2 : POP EBP
0043efb3 : RET

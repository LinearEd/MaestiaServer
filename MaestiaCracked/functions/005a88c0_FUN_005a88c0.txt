PROGRAM  : Maestia.exe
FUNCTION : FUN_005a88c0
ENTRY    : 005a88c0
BODY     : [[005a88c0, 005a8a56]]

============================================================
DECOMPILED C CODE
============================================================

int * FUN_005a88c0(undefined2 param_1,int param_2,undefined1 *param_3,int param_4,
                  undefined1 *param_5)

{
  undefined1 uVar1;
  byte bVar2;
  char cVar3;
  int *piVar4;
  int iVar5;
  int *in_ECX;
  uint uVar6;
  
  uVar6 = in_ECX[0x88];
  if (((uVar6 != 0) && (uVar6 < (uint)(in_ECX[0x83] + param_2))) &&
     ((int *)in_ECX[0x89] != (int *)0x0)) {
    uVar1 = (**(code **)(*(int *)in_ECX[0x89] + 4))(*in_ECX,(in_ECX[0x83] - uVar6) + param_2);
    *param_3 = uVar1;
    return (int *)0x0;
  }
  *param_5 = 0;
  uVar6 = param_4 + 0x2fU & 0xfffffff0;
  piVar4 = (int *)FUN_005a8710(uVar6);
  if (piVar4 == (int *)0x0) {
    return (int *)0x0;
  }
  piVar4[2] = uVar6;
  *(undefined2 *)(piVar4 + 3) = param_1;
  if (((uint)param_3 & 0xffff0000) == 0) {
    if (((uint)param_3 & 0xff00) == 0) {
      bVar2 = *(byte *)((int)&PTR_DAT_00b94fc8 + ((uint)param_3 & 0xff));
    }
    else {
      bVar2 = *(char *)((int)&PTR_DAT_00b94fc8 + ((uint)param_3 >> 8 & 0xff)) + 8;
    }
  }
  else if (((uint)param_3 & 0xff000000) == 0) {
    bVar2 = *(char *)((int)&PTR_DAT_00b94fc8 + ((uint)param_3 >> 0x10 & 0xff)) + 0x10;
  }
  else {
    bVar2 = *(char *)((int)&PTR_DAT_00b94fc8 + ((uint)param_3 >> 0x18)) + 0x18;
  }
  *(ushort *)((int)piVar4 + 0xe) = (ushort)bVar2;
  piVar4[4] = 0;
  piVar4[5] = *in_ECX;
  piVar4[6] = param_2;
  piVar4[7] = 0;
  if (param_2 == 0) {
LAB_005a8a25:
    iVar5 = in_ECX[0x6c];
    *piVar4 = (int)(in_ECX + 0x6b);
    piVar4[1] = iVar5;
    *(int **)in_ECX[0x6c] = piVar4;
    in_ECX[0x6c] = (int)piVar4;
    in_ECX[0x83] = in_ECX[0x83] + piVar4[6];
    *param_5 = 1;
    return piVar4;
  }
  if (param_3 < (undefined1 *)0x1000) {
    param_3 = (undefined1 *)0x1000;
  }
  iVar5 = (**(code **)(*(int *)in_ECX[1] + 4))(param_2,param_3);
  piVar4[7] = iVar5;
  if (iVar5 != 0) {
    cVar3 = FUN_005a9f90(iVar5,piVar4[6]);
    if (cVar3 != '\0') {
      FUN_005aa0b0(piVar4[7],piVar4[6],piVar4);
      goto LAB_005a8a25;
    }
    (**(code **)(*(int *)in_ECX[1] + 8))(piVar4[7],param_2,param_3);
  }
  FUN_005a87d0(piVar4,uVar6);
  return (int *)0x0;
}



============================================================
DISASSEMBLY
============================================================
005a88c0 : PUSH EBX
005a88c1 : PUSH ESI
005a88c2 : PUSH EDI
005a88c3 : MOV EDI,ECX
005a88c5 : MOV EDX,dword ptr [EDI + 0x220]
005a88cb : TEST EDX,EDX
005a88cd : JZ 0x005a8907
005a88cf : MOV EAX,dword ptr [EDI + 0x20c]
005a88d5 : MOV ESI,dword ptr [ESP + 0x14]
005a88d9 : LEA ECX,[EAX + ESI*0x1]
005a88dc : CMP ECX,EDX
005a88de : JBE 0x005a8907
005a88e0 : MOV ECX,dword ptr [EDI + 0x224]
005a88e6 : TEST ECX,ECX
005a88e8 : JZ 0x005a8907
005a88ea : MOV EBX,dword ptr [ECX]
005a88ec : SUB EAX,EDX
005a88ee : MOV EDX,dword ptr [EDI]
005a88f0 : ADD EAX,ESI
005a88f2 : PUSH EAX
005a88f3 : MOV EAX,dword ptr [EBX + 0x4]
005a88f6 : PUSH EDX
005a88f7 : CALL EAX
005a88f9 : MOV ECX,dword ptr [ESP + 0x20]
005a88fd : MOV byte ptr [ECX],AL
005a88ff : POP EDI
005a8900 : POP ESI
005a8901 : XOR EAX,EAX
005a8903 : POP EBX
005a8904 : RET 0x14
005a8907 : MOV EBX,dword ptr [ESP + 0x1c]
005a890b : MOV EDX,dword ptr [ESP + 0x20]
005a890f : ADD EBX,0x2f
005a8912 : MOV byte ptr [EDX],0x0
005a8915 : MOV ECX,dword ptr [EDI + 0x8]
005a8918 : AND EBX,0xfffffff0
005a891b : PUSH EBX
005a891c : CALL 0x005a8710
005a8921 : MOV ESI,EAX
005a8923 : TEST ESI,ESI
005a8925 : JZ 0x005a88ff
005a8927 : MOV AX,word ptr [ESP + 0x10]
005a892c : PUSH EBP
005a892d : MOV EBP,dword ptr [ESP + 0x1c]
005a8931 : MOV dword ptr [ESI + 0x8],EBX
005a8934 : MOV word ptr [ESI + 0xc],AX
005a8938 : TEST EBP,0xffff0000
005a893e : JZ 0x005a896c
005a8940 : TEST EBP,0xff000000
005a8946 : JZ 0x005a8957
005a8948 : MOV ECX,EBP
005a894a : SHR ECX,0x18
005a894d : MOV AL,byte ptr [ECX + 0xb94fc8]
005a8953 : ADD AL,0x18
005a8955 : JMP 0x005a8996
005a8957 : MOV EDX,EBP
005a8959 : SHR EDX,0x10
005a895c : AND EDX,0xff
005a8962 : MOV AL,byte ptr [EDX + 0xb94fc8]
005a8968 : ADD AL,0x10
005a896a : JMP 0x005a8996
005a896c : TEST EBP,0xff00
005a8972 : JZ 0x005a8988
005a8974 : MOV EAX,EBP
005a8976 : SHR EAX,0x8
005a8979 : AND EAX,0xff
005a897e : MOV AL,byte ptr [EAX + 0xb94fc8]
005a8984 : ADD AL,0x8
005a8986 : JMP 0x005a8996
005a8988 : MOV ECX,EBP
005a898a : AND ECX,0xff
005a8990 : MOV AL,byte ptr [ECX + 0xb94fc8]
005a8996 : MOVZX DX,AL
005a899a : XOR ECX,ECX
005a899c : MOV word ptr [ESI + 0xe],DX
005a89a0 : MOV dword ptr [ESI + 0x10],ECX
005a89a3 : MOV EAX,dword ptr [EDI]
005a89a5 : MOV dword ptr [ESI + 0x14],EAX
005a89a8 : MOV EAX,dword ptr [ESP + 0x18]
005a89ac : MOV dword ptr [ESI + 0x18],EAX
005a89af : MOV dword ptr [ESI + 0x1c],ECX
005a89b2 : CMP EAX,ECX
005a89b4 : JZ 0x005a8a25
005a89b6 : CMP EBP,0x1000
005a89bc : JNC 0x005a89c3
005a89be : MOV EBP,0x1000
005a89c3 : MOV ECX,dword ptr [EDI + 0x4]
005a89c6 : MOV EDX,dword ptr [ECX]
005a89c8 : PUSH EBP
005a89c9 : PUSH EAX
005a89ca : MOV EAX,dword ptr [EDX + 0x4]
005a89cd : CALL EAX
005a89cf : MOV dword ptr [ESI + 0x1c],EAX
005a89d2 : TEST EAX,EAX
005a89d4 : JZ 0x005a89fe
005a89d6 : MOV ECX,dword ptr [ESI + 0x18]
005a89d9 : PUSH ECX
005a89da : MOV ECX,dword ptr [0x00d7b334]
005a89e0 : PUSH EAX
005a89e1 : CALL 0x005a9f90
005a89e6 : TEST AL,AL
005a89e8 : JNZ 0x005a8a11
005a89ea : MOV EAX,dword ptr [ESP + 0x18]
005a89ee : MOV ECX,dword ptr [EDI + 0x4]
005a89f1 : MOV EDX,dword ptr [ECX]
005a89f3 : MOV EDX,dword ptr [EDX + 0x8]
005a89f6 : PUSH EBP
005a89f7 : PUSH EAX
005a89f8 : MOV EAX,dword ptr [ESI + 0x1c]
005a89fb : PUSH EAX
005a89fc : CALL EDX
005a89fe : MOV ECX,dword ptr [EDI + 0x8]
005a8a01 : PUSH EBX
005a8a02 : PUSH ESI
005a8a03 : CALL 0x005a87d0
005a8a08 : POP EBP
005a8a09 : POP EDI
005a8a0a : POP ESI
005a8a0b : XOR EAX,EAX
005a8a0d : POP EBX
005a8a0e : RET 0x14
005a8a11 : MOV EAX,dword ptr [ESI + 0x18]
005a8a14 : MOV ECX,dword ptr [ESI + 0x1c]
005a8a17 : PUSH ESI
005a8a18 : PUSH EAX
005a8a19 : PUSH ECX
005a8a1a : MOV ECX,dword ptr [0x00d7b334]
005a8a20 : CALL 0x005aa0b0
005a8a25 : MOV EDX,dword ptr [EDI + 0x1b0]
005a8a2b : LEA EAX,[EDI + 0x1ac]
005a8a31 : MOV dword ptr [ESI],EAX
005a8a33 : MOV dword ptr [ESI + 0x4],EDX
005a8a36 : MOV ECX,dword ptr [EAX + 0x4]
005a8a39 : MOV dword ptr [ECX],ESI
005a8a3b : MOV dword ptr [EAX + 0x4],ESI
005a8a3e : MOV EDX,dword ptr [ESI + 0x18]
005a8a41 : MOV EAX,dword ptr [ESP + 0x24]
005a8a45 : ADD dword ptr [EDI + 0x20c],EDX
005a8a4b : POP EBP
005a8a4c : POP EDI
005a8a4d : MOV byte ptr [EAX],0x1
005a8a50 : MOV EAX,ESI
005a8a52 : POP ESI
005a8a53 : POP EBX
005a8a54 : RET 0x14

PROGRAM  : Maestia.exe
FUNCTION : FUN_009409a0
ENTRY    : 009409a0
BODY     : [[009409a0, 00940cef]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009409a0(int param_1,int *param_2,int param_3,uint param_4,uint param_5)

{
  int iVar1;
  char cVar2;
  undefined1 uVar3;
  undefined2 uVar4;
  int *piVar5;
  int iVar6;
  int iVar7;
  undefined4 uVar8;
  short *psVar9;
  bool bVar10;
  undefined4 local_18;
  uint local_14;
  int local_10;
  undefined1 local_c [7];
  undefined1 local_5;
  
  if ((param_2 == (int *)0x0) || (param_2[2] != 0x12345668)) {
    FUN_008018d0(L"AvaGuiPocket::InsertItemToFlash pItem Invalid Pointer !!!");
    return;
  }
  iVar1 = (param_4 & 0xffff) + (param_5 & 0xffff) * 5;
  local_5 = 0;
  if (param_2[9] != 0) {
    local_5 = *(undefined1 *)(param_2[9] + 0xb1);
  }
  bVar10 = false;
  if ((char)((uint)param_2[4] >> 0x18) == '\x06') {
    piVar5 = (int *)FUN_004049b0(param_2[4]);
    if (piVar5 == (int *)0x0) {
      FUN_008018d0(L"AvaGuiPocket::InsertItemToFlash Invalid Proto !!!");
    }
    else {
      iVar6 = (**(code **)(*piVar5 + 0x44))();
      bVar10 = iVar6 != 0;
    }
  }
  local_18 = 0;
  if (DAT_017247d0 != 0) {
    local_14 = -(uint)(*(int *)(DAT_017247d0 + 0x28) != 0);
joined_r0x00940a44:
    if (local_14 != 0) {
      local_10 = 0;
      FUN_00404160(&local_14,local_c,&local_10);
      if (local_10 == 0) goto LAB_00940a9c;
      if ((*(short *)(local_10 + 0x18) == 0) || (*(short *)(local_10 + 0x18) == 1)) {
        iVar6 = 0;
        psVar9 = (short *)(local_10 + 0x1a);
        do {
          if (*psVar9 == 0) break;
          if ((short)param_2[4] == *psVar9) {
            local_18 = 1;
            break;
          }
          iVar6 = iVar6 + 1;
          psVar9 = psVar9 + 2;
        } while (iVar6 < 10);
      }
      goto joined_r0x00940a44;
    }
  }
LAB_00940a9c:
  piVar5 = DAT_00da9894;
  if ((*DAT_00da9894 != 0) && (*(int *)(*DAT_00da9894 + 0x114) != 0)) {
    cVar2 = FUN_008ebff0();
    if (cVar2 == '\0') {
      local_14 = (uint)*(ushort *)(param_1 + 0x70);
    }
    else {
      local_14 = 0;
    }
    piVar5 = *(int **)(*piVar5 + 0x114);
    if (*(uint *)(param_3 + 0x18) < 8) {
      param_3 = param_3 + 4;
    }
    else {
      param_3 = *(int *)(param_3 + 4);
    }
    iVar6 = *piVar5;
    uVar3 = (**(code **)(*param_2 + 0x30))(*(undefined1 *)((int)param_2 + 0xed),bVar10,local_18);
    uVar4 = (**(code **)(*param_2 + 0x40))(local_14,local_5,uVar3);
    (**(code **)(iVar6 + 4))
              (piVar5,"PocketInsertItem","%ls,%d,%d,%d,%b,%b,%b,%b,%d",param_3,iVar1,uVar4);
  }
  iVar6 = *(int *)(param_1 + 0x3c);
  iVar7 = *(int *)(iVar6 + 0xc) * (param_5 & 0xffff) + (param_4 & 0xffff);
  if (((iVar7 < *(int *)(iVar6 + 8) * *(int *)(iVar6 + 0xc)) && (-1 < iVar7)) &&
     (*(int *)(*(int *)(iVar6 + 0x10) + iVar7 * 4) != 0)) {
    FUN_00908670(*(undefined1 *)((int)param_2 + 0xee));
  }
  piVar5 = DAT_00da9894;
  if ((((*(byte *)(param_2 + 0x48) & 4) != 0) && (*DAT_00da9894 != 0)) &&
     (*(int *)(*DAT_00da9894 + 0x114) != 0)) {
    cVar2 = FUN_008ebff0();
    if (cVar2 == '\0') {
      uVar4 = *(undefined2 *)(param_1 + 0x70);
    }
    else {
      uVar4 = 0;
    }
    (**(code **)(**(int **)(*piVar5 + 0x114) + 4))
              (*(int **)(*piVar5 + 0x114),"PocketCoverItem","%d, %d, %b",uVar4,iVar1,1);
  }
  if ((DAT_00da93ec != 0) && (*(char *)(DAT_00da93ec + 0x419) != '\0')) {
    FUN_00a1db80();
    FUN_00a1cb20();
  }
  if ((*DAT_00da9894 != 0) && (iVar1 = *(int *)(*DAT_00da9894 + 0x128), iVar1 != 0)) {
    switch(*(undefined4 *)(iVar1 + 0x5c)) {
    case 2:
      uVar8 = 1;
      break;
    case 3:
      uVar8 = 2;
      break;
    default:
      goto switchD_00940c2c_caseD_4;
    case 5:
      if (*(short *)(iVar1 + 0x84) != 1) goto switchD_00940c2c_caseD_4;
      uVar8 = 3;
      break;
    case 6:
      if (*(int *)(iVar1 + 0x90) == 1) {
        uVar8 = 6;
      }
      else {
        if (*(int *)(iVar1 + 0x90) != 2) goto switchD_00940c2c_caseD_4;
        uVar8 = 7;
      }
      break;
    case 0xd:
      uVar8 = 0xe;
    }
    (**(code **)(*param_2 + 0x54))(uVar8);
  }
switchD_00940c2c_caseD_4:
  iVar1 = DAT_00d7c54c;
  param_5 = param_2[4];
  FUN_004437f0(&param_5);
  if (((param_4 != *(uint *)(iVar1 + 0x44)) && (*(int *)(param_4 + 0x10) != 0)) &&
     ((cVar2 = *(char *)(*(int *)(param_4 + 0x10) + 0x7e8), cVar2 == '\x05' || (cVar2 == '\x06'))))
  {
    FUN_00995530();
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
009409a0 : PUSH EBP
009409a1 : MOV EBP,ESP
009409a3 : SUB ESP,0x18
009409a6 : PUSH EBX
009409a7 : MOV EBX,dword ptr [EBP + 0xc]
009409aa : PUSH ESI
009409ab : XOR ESI,ESI
009409ad : CMP EBX,ESI
009409af : JZ 0x00940cd5
009409b5 : CMP dword ptr [EBX + 0x8],0x12345668
009409bc : JNZ 0x00940cd5
009409c2 : MOVZX EAX,word ptr [EBP + 0x18]
009409c6 : MOVZX ECX,word ptr [EBP + 0x14]
009409ca : LEA ECX,[ECX + EAX*0x4]
009409cd : ADD ECX,EAX
009409cf : MOV EAX,dword ptr [EBX + 0x24]
009409d2 : MOV dword ptr [EBP + -0x18],ECX
009409d5 : MOV byte ptr [EBP + -0x1],0x0
009409d9 : CMP EAX,ESI
009409db : JZ 0x009409e6
009409dd : MOV AL,byte ptr [EAX + 0xb1]
009409e3 : MOV byte ptr [EBP + -0x1],AL
009409e6 : MOV EAX,dword ptr [EBX + 0x10]
009409e9 : MOV ECX,EAX
009409eb : SHR ECX,0x18
009409ee : MOV byte ptr [EBP + 0xf],0x0
009409f2 : CMP CL,0x6
009409f5 : JNZ 0x00940a2a
009409f7 : PUSH EAX
009409f8 : CALL 0x004049b0
009409fd : ADD ESP,0x4
00940a00 : CMP EAX,ESI
00940a02 : JZ 0x00940a15
00940a04 : MOV EDX,dword ptr [EAX]
00940a06 : MOV ECX,EAX
00940a08 : MOV EAX,dword ptr [EDX + 0x44]
00940a0b : CALL EAX
00940a0d : TEST EAX,EAX
00940a0f : SETNZ byte ptr [EBP + 0xf]
00940a13 : JMP 0x00940a2a
00940a15 : MOV ESI,dword ptr [0x00da98e8]
00940a1b : PUSH 0xc71e20
00940a20 : CALL 0x008018d0
00940a25 : ADD ESP,0x4
00940a28 : XOR ESI,ESI
00940a2a : PUSH EDI
00940a2b : MOV EDI,dword ptr [0x017247d0]
00940a31 : MOV dword ptr [EBP + -0x14],ESI
00940a34 : CMP EDI,ESI
00940a36 : JZ 0x00940a9c
00940a38 : MOV EAX,dword ptr [EDI + 0x28]
00940a3b : NEG EAX
00940a3d : SBB EAX,EAX
00940a3f : MOV dword ptr [EBP + -0x10],EAX
00940a42 : CMP EAX,ESI
00940a44 : JZ 0x00940a9c
00940a46 : LEA ECX,[EBP + -0xc]
00940a49 : PUSH ECX
00940a4a : LEA EDX,[EBP + -0x8]
00940a4d : PUSH EDX
00940a4e : LEA EAX,[EBP + -0x10]
00940a51 : PUSH EAX
00940a52 : MOV EAX,EDI
00940a54 : MOV dword ptr [EBP + -0xc],ESI
00940a57 : CALL 0x00404160
00940a5c : MOV ECX,dword ptr [EBP + -0xc]
00940a5f : CMP ECX,ESI
00940a61 : JZ 0x00940a9c
00940a63 : MOVZX EAX,word ptr [ECX + 0x18]
00940a67 : CMP AX,SI
00940a6a : JZ 0x00940a72
00940a6c : CMP AX,0x1
00940a70 : JNZ 0x00940a97
00940a72 : XOR EAX,EAX
00940a74 : ADD ECX,0x1a
00940a77 : MOVZX EDX,word ptr [ECX]
00940a7a : CMP DX,SI
00940a7d : JZ 0x00940a97
00940a7f : CMP word ptr [EBX + 0x10],DX
00940a83 : JZ 0x00940a90
00940a85 : INC EAX
00940a86 : ADD ECX,0x4
00940a89 : CMP EAX,0xa
00940a8c : JL 0x00940a77
00940a8e : JMP 0x00940a97
00940a90 : MOV dword ptr [EBP + -0x14],0x1
00940a97 : CMP dword ptr [EBP + -0x10],ESI
00940a9a : JNZ 0x00940a46
00940a9c : MOV EDI,dword ptr [0x00da9894]
00940aa2 : MOV EAX,dword ptr [EDI]
00940aa4 : CMP EAX,ESI
00940aa6 : JZ 0x00940b49
00940aac : CMP dword ptr [EAX + 0x114],ESI
00940ab2 : JZ 0x00940b49
00940ab8 : MOV ESI,dword ptr [EBP + 0x8]
00940abb : MOV EAX,dword ptr [ESI + 0x5c]
00940abe : CALL 0x008ebff0
00940ac3 : TEST AL,AL
00940ac5 : JZ 0x00940ad0
00940ac7 : MOV dword ptr [EBP + -0x10],0x0
00940ace : JMP 0x00940ad7
00940ad0 : MOVZX ECX,word ptr [ESI + 0x70]
00940ad4 : MOV dword ptr [EBP + -0x10],ECX
00940ad7 : MOV ECX,dword ptr [EBP + 0x10]
00940ada : CMP dword ptr [ECX + 0x18],0x8
00940ade : MOV EDX,dword ptr [EDI]
00940ae0 : MOV EDI,dword ptr [EDX + 0x114]
00940ae6 : MOV AL,byte ptr [EBX + 0xed]
00940aec : JC 0x00940af3
00940aee : MOV ECX,dword ptr [ECX + 0x4]
00940af1 : JMP 0x00940af6
00940af3 : ADD ECX,0x4
00940af6 : MOVZX EDX,word ptr [EBP + -0x14]
00940afa : MOV ESI,dword ptr [EDI]
00940afc : MOV dword ptr [EBP + 0x10],ECX
00940aff : MOVZX ECX,byte ptr [EBP + 0xf]
00940b03 : PUSH EDX
00940b04 : MOVZX EDX,AL
00940b07 : MOV EAX,dword ptr [EBX]
00940b09 : PUSH ECX
00940b0a : PUSH EDX
00940b0b : MOV EDX,dword ptr [EAX + 0x30]
00940b0e : MOV ECX,EBX
00940b10 : ADD ESI,0x4
00940b13 : CALL EDX
00940b15 : MOVZX ECX,byte ptr [EBP + -0x1]
00940b19 : MOV EDX,dword ptr [EBP + -0x10]
00940b1c : MOVZX EAX,AL
00940b1f : PUSH EAX
00940b20 : MOV EAX,dword ptr [EBX]
00940b22 : PUSH ECX
00940b23 : PUSH EDX
00940b24 : MOV EDX,dword ptr [EAX + 0x40]
00940b27 : MOV ECX,EBX
00940b29 : CALL EDX
00940b2b : MOV ECX,dword ptr [EBP + -0x18]
00940b2e : MOV EDX,dword ptr [EBP + 0x10]
00940b31 : MOVZX EAX,AX
00940b34 : PUSH EAX
00940b35 : MOV EAX,dword ptr [ESI]
00940b37 : PUSH ECX
00940b38 : PUSH EDX
00940b39 : PUSH 0xc71e04
00940b3e : PUSH 0xc71e84
00940b43 : PUSH EDI
00940b44 : CALL EAX
00940b46 : ADD ESP,0x30
00940b49 : MOV EDI,dword ptr [EBP + 0x8]
00940b4c : MOV ECX,dword ptr [EDI + 0x3c]
00940b4f : MOV EDX,dword ptr [ECX + 0xc]
00940b52 : MOVZX ESI,word ptr [EBP + 0x18]
00940b56 : MOV EAX,EDX
00940b58 : IMUL EAX,ESI
00940b5b : MOVZX ESI,word ptr [EBP + 0x14]
00940b5f : ADD EAX,ESI
00940b61 : MOV ESI,dword ptr [ECX + 0x8]
00940b64 : IMUL ESI,EDX
00940b67 : CMP EAX,ESI
00940b69 : JGE 0x00940b88
00940b6b : TEST EAX,EAX
00940b6d : JL 0x00940b88
00940b6f : MOV ECX,dword ptr [ECX + 0x10]
00940b72 : MOV EAX,dword ptr [ECX + EAX*0x4]
00940b75 : TEST EAX,EAX
00940b77 : JZ 0x00940b88
00940b79 : MOVZX EDX,byte ptr [EBX + 0xee]
00940b80 : PUSH EDX
00940b81 : MOV ESI,EAX
00940b83 : CALL 0x00908670
00940b88 : TEST byte ptr [EBX + 0x120],0x4
00940b8f : JZ 0x00940bde
00940b91 : MOV ESI,dword ptr [0x00da9894]
00940b97 : MOV EAX,dword ptr [ESI]
00940b99 : TEST EAX,EAX
00940b9b : JZ 0x00940bde
00940b9d : CMP dword ptr [EAX + 0x114],0x0
00940ba4 : JZ 0x00940bde
00940ba6 : MOV EAX,dword ptr [EDI + 0x5c]
00940ba9 : CALL 0x008ebff0
00940bae : TEST AL,AL
00940bb0 : JZ 0x00940bb6
00940bb2 : XOR ECX,ECX
00940bb4 : JMP 0x00940bba
00940bb6 : MOVZX ECX,word ptr [EDI + 0x70]
00940bba : MOV EAX,dword ptr [ESI]
00940bbc : MOV ESI,dword ptr [EBP + -0x18]
00940bbf : MOV EAX,dword ptr [EAX + 0x114]
00940bc5 : MOV EDX,dword ptr [EAX]
00940bc7 : PUSH 0x1
00940bc9 : PUSH ESI
00940bca : PUSH ECX
00940bcb : PUSH 0xc71e98
00940bd0 : PUSH 0xc71ea4
00940bd5 : PUSH EAX
00940bd6 : MOV EAX,dword ptr [EDX + 0x4]
00940bd9 : CALL EAX
00940bdb : ADD ESP,0x18
00940bde : MOV EAX,[0x00da93ec]
00940be3 : TEST EAX,EAX
00940be5 : JZ 0x00940c04
00940be7 : CMP byte ptr [EAX + 0x419],0x0
00940bee : JZ 0x00940c04
00940bf0 : MOV ECX,EBX
00940bf2 : CALL 0x00a1db80
00940bf7 : MOV EDI,dword ptr [0x00da93ec]
00940bfd : MOV EAX,EBX
00940bff : CALL 0x00a1cb20
00940c04 : MOV ECX,dword ptr [0x00da9894]
00940c0a : MOV EAX,dword ptr [ECX]
00940c0c : TEST EAX,EAX
00940c0e : JZ 0x00940c7f
00940c10 : MOV EAX,dword ptr [EAX + 0x128]
00940c16 : TEST EAX,EAX
00940c18 : JZ 0x00940c7f
00940c1a : MOV ECX,dword ptr [EAX + 0x5c]
00940c1d : ADD ECX,-0x2
00940c20 : CMP ECX,0xb
00940c23 : JA 0x00940c7f
00940c25 : MOVZX EDX,byte ptr [ECX + 0x940d08]
00940c2c : JMP dword ptr [EDX*0x4 + 0x940cf0]
00940c33 : MOV EAX,0x2
00940c38 : JMP 0x00940c75
00940c3a : MOV EAX,0x1
00940c3f : JMP 0x00940c75
00940c41 : CMP word ptr [EAX + 0x84],0x1
00940c49 : JNZ 0x00940c7f
00940c4b : MOV EAX,0x3
00940c50 : JMP 0x00940c75
00940c52 : MOV EAX,dword ptr [EAX + 0x90]
00940c58 : CMP EAX,0x1
00940c5b : JNZ 0x00940c64
00940c5d : MOV EAX,0x6
00940c62 : JMP 0x00940c75
00940c64 : CMP EAX,0x2
00940c67 : JNZ 0x00940c7f
00940c69 : MOV EAX,0x7
00940c6e : JMP 0x00940c75
00940c70 : MOV EAX,0xe
00940c75 : MOV EDX,dword ptr [EBX]
00940c77 : PUSH EAX
00940c78 : MOV EAX,dword ptr [EDX + 0x54]
00940c7b : MOV ECX,EBX
00940c7d : CALL EAX
00940c7f : MOV ESI,dword ptr [0x00d7c54c]
00940c85 : MOV EBX,dword ptr [EBX + 0x10]
00940c88 : LEA ECX,[EBP + 0x18]
00940c8b : PUSH ECX
00940c8c : LEA ECX,[ESI + 0x40]
00940c8f : LEA EAX,[EBP + 0x14]
00940c92 : MOV dword ptr [EBP + 0x18],EBX
00940c95 : CALL 0x004437f0
00940c9a : MOV EAX,dword ptr [EBP + 0x14]
00940c9d : CMP EAX,dword ptr [ESI + 0x44]
00940ca0 : JZ 0x00940ccc
00940ca2 : MOV EAX,dword ptr [EAX + 0x10]
00940ca5 : TEST EAX,EAX
00940ca7 : JZ 0x00940ccc
00940ca9 : MOV AL,byte ptr [EAX + 0x7e8]
00940caf : CMP AL,0x5
00940cb1 : JZ 0x00940cb7
00940cb3 : CMP AL,0x6
00940cb5 : JNZ 0x00940ccc
00940cb7 : MOV EDX,dword ptr [0x00da9894]
00940cbd : MOV EAX,dword ptr [EDX]
00940cbf : MOV EDI,dword ptr [EAX + 0x2c4]
00940cc5 : MOV ESI,EBX
00940cc7 : CALL 0x00995530
00940ccc : POP EDI
00940ccd : POP ESI
00940cce : POP EBX
00940ccf : MOV ESP,EBP
00940cd1 : POP EBP
00940cd2 : RET 0x14
00940cd5 : MOV ESI,dword ptr [0x00da98e8]
00940cdb : PUSH 0xc71d90
00940ce0 : CALL 0x008018d0
00940ce5 : ADD ESP,0x4
00940ce8 : POP ESI
00940ce9 : POP EBX
00940cea : MOV ESP,EBP
00940cec : POP EBP
00940ced : RET 0x14

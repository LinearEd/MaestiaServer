PROGRAM  : Maestia.exe
FUNCTION : FUN_00404de0
ENTRY    : 00404de0
BODY     : [[00404de0, 00404e6c]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00404de0(uint param_1,uint param_2)

{
  uint uVar1;
  int iVar2;
  int in_ECX;
  int iVar3;
  
  if (*(uint *)(in_ECX + 0x14) < param_1) {
    FUN_00622f07();
  }
  uVar1 = *(int *)(in_ECX + 0x14) - param_1;
  if (uVar1 < param_2) {
    param_2 = uVar1;
  }
  if (param_2 != 0) {
    if (*(uint *)(in_ECX + 0x18) < 0x10) {
      iVar2 = in_ECX + 4;
      iVar3 = in_ECX + 4;
    }
    else {
      iVar2 = *(int *)(in_ECX + 4);
      iVar3 = *(int *)(in_ECX + 4);
    }
    _memmove_s((void *)(iVar3 + param_1),*(uint *)(in_ECX + 0x18) - param_1,
               (void *)(iVar2 + param_1 + param_2),uVar1 - param_2);
    iVar2 = *(int *)(in_ECX + 0x14) - param_2;
    *(int *)(in_ECX + 0x14) = iVar2;
    if (0xf < *(uint *)(in_ECX + 0x18)) {
      *(undefined1 *)(*(int *)(in_ECX + 4) + iVar2) = 0;
      return;
    }
    *(undefined1 *)(in_ECX + 4 + iVar2) = 0;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00404de0 : PUSH EBP
00404de1 : MOV EBP,ESP
00404de3 : PUSH EBX
00404de4 : MOV EBX,dword ptr [EBP + 0x8]
00404de7 : PUSH ESI
00404de8 : MOV ESI,ECX
00404dea : PUSH EDI
00404deb : CMP dword ptr [ESI + 0x14],EBX
00404dee : JNC 0x00404df5
00404df0 : CALL 0x00622f07
00404df5 : MOV EAX,dword ptr [ESI + 0x14]
00404df8 : MOV EDI,dword ptr [EBP + 0xc]
00404dfb : SUB EAX,EBX
00404dfd : CMP EAX,EDI
00404dff : CMOVC EDI,EAX
00404e02 : TEST EDI,EDI
00404e04 : JBE 0x00404e64
00404e06 : MOV ECX,dword ptr [ESI + 0x18]
00404e09 : CMP ECX,0x10
00404e0c : JC 0x00404e13
00404e0e : MOV EDX,dword ptr [ESI + 0x4]
00404e11 : JMP 0x00404e16
00404e13 : LEA EDX,[ESI + 0x4]
00404e16 : MOV dword ptr [EBP + 0x8],EDX
00404e19 : CMP ECX,0x10
00404e1c : JC 0x00404e23
00404e1e : MOV EDX,dword ptr [ESI + 0x4]
00404e21 : JMP 0x00404e26
00404e23 : LEA EDX,[ESI + 0x4]
00404e26 : SUB EAX,EDI
00404e28 : PUSH EAX
00404e29 : MOV EAX,dword ptr [EBP + 0x8]
00404e2c : ADD EAX,EBX
00404e2e : ADD EAX,EDI
00404e30 : PUSH EAX
00404e31 : SUB ECX,EBX
00404e33 : PUSH ECX
00404e34 : ADD EDX,EBX
00404e36 : PUSH EDX
00404e37 : CALL 0x00634101
00404e3c : MOV EAX,dword ptr [ESI + 0x14]
00404e3f : SUB EAX,EDI
00404e41 : ADD ESP,0x10
00404e44 : CMP dword ptr [ESI + 0x18],0x10
00404e48 : MOV dword ptr [ESI + 0x14],EAX
00404e4b : JC 0x00404e5d
00404e4d : MOV ECX,dword ptr [ESI + 0x4]
00404e50 : POP EDI
00404e51 : MOV byte ptr [ECX + EAX*0x1],0x0
00404e55 : MOV EAX,ESI
00404e57 : POP ESI
00404e58 : POP EBX
00404e59 : POP EBP
00404e5a : RET 0x8
00404e5d : LEA ECX,[ESI + 0x4]
00404e60 : MOV byte ptr [ECX + EAX*0x1],0x0
00404e64 : POP EDI
00404e65 : MOV EAX,ESI
00404e67 : POP ESI
00404e68 : POP EBX
00404e69 : POP EBP
00404e6a : RET 0x8

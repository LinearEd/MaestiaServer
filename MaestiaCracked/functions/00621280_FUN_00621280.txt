PROGRAM  : Maestia.exe
FUNCTION : FUN_00621280
ENTRY    : 00621280
BODY     : [[00621280, 006216f0]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00621280(int param_1)

{
  float fVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  float fVar6;
  float fVar7;
  float fVar8;
  float fVar9;
  float fVar10;
  float local_18;
  float local_14;
  float local_10;
  float local_c;
  int local_8;
  
  iVar2 = *(int *)(param_1 + 0x164);
  local_14 = *(float *)(iVar2 + 0x50);
  if (local_14 == 0.0) {
    local_18 = 0.0;
  }
  else {
    local_18 = 1.0 / local_14;
  }
  local_14 = *(float *)(iVar2 + 0x54) - local_14;
  if (local_14 == 0.0) {
    local_14 = 0.0;
  }
  else {
    local_14 = 1.0 / local_14;
  }
  fVar7 = 1.0 - *(float *)(iVar2 + 0x54);
  if (fVar7 == 0.0) {
    fVar7 = 0.0;
  }
  else {
    fVar7 = 1.0 / fVar7;
  }
  fVar1 = *(float *)(iVar2 + 0x78);
  if (fVar1 == 0.0) {
    local_10 = 0.0;
  }
  else {
    local_10 = 1.0 / fVar1;
  }
  if (1.0 - fVar1 == 0.0) {
    local_c = 0.0;
  }
  else {
    local_c = 1.0 / (1.0 - fVar1);
  }
  if (*(int *)(param_1 + 0x104) != 0) {
    *(undefined4 *)(*(int *)(param_1 + 0x104) + 300) =
         *(undefined4 *)(*(int *)(param_1 + 0x104) + 0x124);
  }
  iVar3 = *(int *)(*(int *)(param_1 + 0x104) + 300);
  while (iVar3 != 0) {
    *(undefined4 *)(*(int *)(param_1 + 0x104) + 300) =
         **(undefined4 **)(*(int *)(param_1 + 0x104) + 300);
    fVar1 = *(float *)(*(int *)(iVar3 + 0x7c) + 0x26c);
    fVar6 = *(float *)(iVar3 + 0x50) / *(float *)(iVar3 + 0x1c);
    if (*(float *)(iVar2 + 0x50) < fVar6) {
      if (*(float *)(iVar2 + 0x54) < fVar6) {
        fVar8 = (fVar6 - *(float *)(iVar2 + 0x54)) * fVar7;
        *(float *)(iVar3 + 0x40) =
             (*(float *)(iVar2 + 0x40) - *(float *)(iVar2 + 0x30)) * fVar8 +
             *(float *)(iVar2 + 0x30);
        *(float *)(iVar3 + 0x44) =
             (*(float *)(iVar2 + 0x44) - *(float *)(iVar2 + 0x34)) * fVar8 +
             *(float *)(iVar2 + 0x34);
        *(float *)(iVar3 + 0x48) =
             (*(float *)(iVar2 + 0x48) - *(float *)(iVar2 + 0x38)) * fVar8 +
             *(float *)(iVar2 + 0x38);
        fVar9 = *(float *)(iVar2 + 0x3c);
        fVar10 = *(float *)(iVar2 + 0x4c);
      }
      else {
        fVar8 = (fVar6 - *(float *)(iVar2 + 0x50)) * local_14;
        *(float *)(iVar3 + 0x40) =
             (*(float *)(iVar2 + 0x30) - *(float *)(iVar2 + 0x20)) * fVar8 +
             *(float *)(iVar2 + 0x20);
        *(float *)(iVar3 + 0x44) =
             (*(float *)(iVar2 + 0x34) - *(float *)(iVar2 + 0x24)) * fVar8 +
             *(float *)(iVar2 + 0x24);
        *(float *)(iVar3 + 0x48) =
             (*(float *)(iVar2 + 0x38) - *(float *)(iVar2 + 0x28)) * fVar8 +
             *(float *)(iVar2 + 0x28);
        fVar9 = *(float *)(iVar2 + 0x2c);
        fVar10 = *(float *)(iVar2 + 0x3c);
      }
    }
    else {
      fVar8 = fVar6 * local_18;
      *(float *)(iVar3 + 0x40) =
           (*(float *)(iVar2 + 0x20) - *(float *)(iVar2 + 0x10)) * fVar8 + *(float *)(iVar2 + 0x10);
      *(float *)(iVar3 + 0x44) =
           (*(float *)(iVar2 + 0x24) - *(float *)(iVar2 + 0x14)) * fVar8 + *(float *)(iVar2 + 0x14);
      *(float *)(iVar3 + 0x48) =
           (*(float *)(iVar2 + 0x28) - *(float *)(iVar2 + 0x18)) * fVar8 + *(float *)(iVar2 + 0x18);
      fVar9 = *(float *)(iVar2 + 0x1c);
      fVar10 = *(float *)(iVar2 + 0x2c);
    }
    *(float *)(iVar3 + 0x4c) = (fVar10 - fVar9) * fVar8 + fVar9;
    if (*(float *)(iVar2 + 0x78) <= fVar6) {
      *(float *)(iVar3 + 0x54) =
           (fVar6 - *(float *)(iVar2 + 0x78)) * local_c *
           (*(float *)(iVar3 + 0x10) - *(float *)(iVar3 + 0xc)) + *(float *)(iVar3 + 0xc);
    }
    else {
      *(float *)(iVar3 + 0x54) =
           (*(float *)(iVar3 + 0xc) - *(float *)(iVar3 + 8)) * fVar6 * local_10 +
           *(float *)(iVar3 + 8);
    }
    *(float *)(iVar3 + 0x58) = *(float *)(iVar3 + 0x14) * fVar1 + *(float *)(iVar3 + 0x58);
    if (*(int *)(iVar2 + 0x124) != 0) {
      if ((*(uint *)(iVar2 + 0x68) & 2) != 0) {
        if ((*(float *)(iVar3 + 0x50) == 0.0) && ((*(uint *)(iVar2 + 0x68) & 4) != 0)) {
          iVar4 = _rand();
          *(int *)(iVar3 + 0x18) =
               (int)((float)(iVar4 % 100) * 0.01 * (float)*(int *)(iVar2 + 0x124));
        }
        local_8 = (int)(longlong)ROUND(*(float *)(iVar2 + 0x108) * *(float *)(iVar3 + 0x50));
        uVar5 = local_8 + *(int *)(iVar3 + 0x18);
        if (((*(uint *)(iVar2 + 0x68) & 0x40000) == 0) || (uVar5 < *(uint *)(iVar2 + 0x124))) {
          *(uint *)(iVar3 + 0x5c) = uVar5 % *(uint *)(iVar2 + 0x124);
        }
        else {
          *(uint *)(iVar3 + 0x5c) = *(uint *)(iVar2 + 0x124) - 1;
        }
      }
      if (((*(int *)(iVar2 + 0x124) != 0) && ((*(byte *)(iVar2 + 0x68) & 1) != 0)) &&
         (*(int *)(iVar3 + 0x5c) = *(int *)(iVar3 + 0x18),
         *(int *)(iVar2 + 0x124) <= *(int *)(iVar3 + 0x18))) {
        *(undefined4 *)(iVar3 + 0x5c) = 0;
      }
    }
    if ((*(uint *)(*(int *)(iVar3 + 0x7c) + 0x100) & 0x200) != 0) {
      if ((*(uint *)(iVar2 + 0x68) & 0x100) == 0) {
        FUN_0061c7d0(iVar3,fVar1);
      }
      else {
        FUN_0061eef0(iVar3,*(int *)(iVar3 + 0x7c));
      }
    }
    if ((*(uint *)(iVar2 + 0x68) & 0x20000000) == 0) {
      *(float *)(iVar3 + 0x50) = fVar1 + *(float *)(iVar3 + 0x50);
    }
    if (((*(uint *)(iVar2 + 0x68) & 0x10000000) != 0) &&
       (*(float *)(iVar3 + 0x1c) <= *(float *)(iVar3 + 0x50))) {
      *(float *)(iVar3 + 0x50) = *(float *)(iVar3 + 0x1c) - 1e-05;
    }
    if (((*(uint *)(iVar2 + 0x68) & 0x100000) != 0) &&
       (*(float *)(iVar3 + 0x1c) <= *(float *)(iVar3 + 0x50))) {
      *(undefined4 *)(iVar3 + 0x50) = 0;
    }
    iVar3 = *(int *)(*(int *)(param_1 + 0x104) + 300);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00621280 : XORPS XMM5,XMM5
00621283 : MOVSS XMM0,dword ptr [0x00b86060]
0062128b : SUB ESP,0x20
0062128e : PUSH EBP
0062128f : MOV EBP,dword ptr [ESP + 0x28]
00621293 : PUSH ESI
00621294 : PUSH EDI
00621295 : MOV EDI,dword ptr [EBP + 0x164]
0062129b : MOVSS XMM2,dword ptr [EDI + 0x50]
006212a0 : UCOMISS XMM2,XMM5
006212a3 : LAHF
006212a4 : TEST AH,0x44
006212a7 : JP 0x006212b1
006212a9 : MOVSS dword ptr [ESP + 0x14],XMM5
006212af : JMP 0x006212be
006212b1 : MOVAPS XMM1,XMM0
006212b4 : DIVSS XMM1,XMM2
006212b8 : MOVSS dword ptr [ESP + 0x14],XMM1
006212be : MOVSS XMM3,dword ptr [EDI + 0x54]
006212c3 : MOVAPS XMM1,XMM3
006212c6 : SUBSS XMM1,XMM2
006212ca : UCOMISS XMM1,XMM5
006212cd : LAHF
006212ce : TEST AH,0x44
006212d1 : JP 0x006212db
006212d3 : MOVSS dword ptr [ESP + 0x18],XMM5
006212d9 : JMP 0x006212e8
006212db : MOVAPS XMM2,XMM0
006212de : DIVSS XMM2,XMM1
006212e2 : MOVSS dword ptr [ESP + 0x18],XMM2
006212e8 : MOVAPS XMM1,XMM0
006212eb : SUBSS XMM1,XMM3
006212ef : UCOMISS XMM1,XMM5
006212f2 : LAHF
006212f3 : TEST AH,0x44
006212f6 : JP 0x006212fd
006212f8 : MOVAPS XMM7,XMM5
006212fb : JMP 0x00621304
006212fd : MOVAPS XMM7,XMM0
00621300 : DIVSS XMM7,XMM1
00621304 : MOVSS XMM2,dword ptr [EDI + 0x78]
00621309 : UCOMISS XMM2,XMM5
0062130c : LAHF
0062130d : MOVSS dword ptr [ESP + 0x10],XMM7
00621313 : TEST AH,0x44
00621316 : JP 0x00621320
00621318 : MOVSS dword ptr [ESP + 0x1c],XMM5
0062131e : JMP 0x0062132d
00621320 : MOVAPS XMM1,XMM0
00621323 : DIVSS XMM1,XMM2
00621327 : MOVSS dword ptr [ESP + 0x1c],XMM1
0062132d : MOVAPS XMM1,XMM0
00621330 : SUBSS XMM1,XMM2
00621334 : UCOMISS XMM1,XMM5
00621337 : LAHF
00621338 : TEST AH,0x44
0062133b : JP 0x00621345
0062133d : MOVSS dword ptr [ESP + 0x20],XMM5
00621343 : JMP 0x0062134f
00621345 : DIVSS XMM0,XMM1
00621349 : MOVSS dword ptr [ESP + 0x20],XMM0
0062134f : CMP dword ptr [EBP + 0x104],0x0
00621356 : JZ 0x0062136a
00621358 : MOV EAX,dword ptr [EBP + 0x104]
0062135e : MOV ECX,dword ptr [EAX + 0x124]
00621364 : MOV dword ptr [EAX + 0x12c],ECX
0062136a : MOV EDX,dword ptr [EBP + 0x104]
00621370 : MOV ESI,dword ptr [EDX + 0x12c]
00621376 : TEST ESI,ESI
00621378 : JZ 0x006216ea
0062137e : JMP 0x00621386
00621380 : MOVSS XMM7,dword ptr [ESP + 0x10]
00621386 : MOV EAX,dword ptr [EBP + 0x104]
0062138c : MOV ECX,dword ptr [EAX + 0x12c]
00621392 : MOV EDX,dword ptr [ECX]
00621394 : MOV dword ptr [EAX + 0x12c],EDX
0062139a : MOVSS XMM4,dword ptr [ESI + 0x50]
0062139f : MOV EAX,dword ptr [ESI + 0x7c]
006213a2 : MOVSS XMM2,dword ptr [EDI + 0x50]
006213a7 : MOVSS XMM6,dword ptr [EAX + 0x26c]
006213af : MOVAPS XMM0,XMM4
006213b2 : DIVSS XMM0,dword ptr [ESI + 0x1c]
006213b7 : COMISS XMM2,XMM0
006213ba : MOVSS dword ptr [ESP + 0xc],XMM6
006213c0 : MOVAPS XMM1,XMM0
006213c3 : JC 0x0062142b
006213c5 : MOVSS XMM2,dword ptr [EDI + 0x10]
006213ca : MOVSS XMM3,dword ptr [EDI + 0x20]
006213cf : MULSS XMM1,dword ptr [ESP + 0x14]
006213d5 : SUBSS XMM3,XMM2
006213d9 : MULSS XMM3,XMM1
006213dd : ADDSS XMM3,XMM2
006213e1 : MOVSS dword ptr [ESI + 0x40],XMM3
006213e6 : MOVSS XMM2,dword ptr [EDI + 0x14]
006213eb : MOVSS XMM3,dword ptr [EDI + 0x24]
006213f0 : SUBSS XMM3,XMM2
006213f4 : MULSS XMM3,XMM1
006213f8 : ADDSS XMM3,XMM2
006213fc : MOVSS dword ptr [ESI + 0x44],XMM3
00621401 : MOVSS XMM2,dword ptr [EDI + 0x18]
00621406 : MOVSS XMM3,dword ptr [EDI + 0x28]
0062140b : SUBSS XMM3,XMM2
0062140f : MULSS XMM3,XMM1
00621413 : ADDSS XMM3,XMM2
00621417 : MOVSS dword ptr [ESI + 0x48],XMM3
0062141c : MOVSS XMM2,dword ptr [EDI + 0x1c]
00621421 : MOVSS XMM3,dword ptr [EDI + 0x2c]
00621426 : JMP 0x006214ff
0062142b : MOVSS XMM3,dword ptr [EDI + 0x54]
00621430 : COMISS XMM3,XMM0
00621433 : JC 0x0062149c
00621435 : MOVSS XMM3,dword ptr [EDI + 0x30]
0062143a : SUBSS XMM1,XMM2
0062143e : MOVSS XMM2,dword ptr [EDI + 0x20]
00621443 : MULSS XMM1,dword ptr [ESP + 0x18]
00621449 : SUBSS XMM3,XMM2
0062144d : MULSS XMM3,XMM1
00621451 : ADDSS XMM3,XMM2
00621455 : MOVSS dword ptr [ESI + 0x40],XMM3
0062145a : MOVSS XMM2,dword ptr [EDI + 0x24]
0062145f : MOVSS XMM3,dword ptr [EDI + 0x34]
00621464 : SUBSS XMM3,XMM2
00621468 : MULSS XMM3,XMM1
0062146c : ADDSS XMM3,XMM2
00621470 : MOVSS dword ptr [ESI + 0x44],XMM3
00621475 : MOVSS XMM2,dword ptr [EDI + 0x28]
0062147a : MOVSS XMM3,dword ptr [EDI + 0x38]
0062147f : SUBSS XMM3,XMM2
00621483 : MULSS XMM3,XMM1
00621487 : ADDSS XMM3,XMM2
0062148b : MOVSS dword ptr [ESI + 0x48],XMM3
00621490 : MOVSS XMM2,dword ptr [EDI + 0x2c]
00621495 : MOVSS XMM3,dword ptr [EDI + 0x3c]
0062149a : JMP 0x006214ff
0062149c : MOVSS XMM2,dword ptr [EDI + 0x30]
006214a1 : SUBSS XMM1,XMM3
006214a5 : MOVSS XMM3,dword ptr [EDI + 0x40]
006214aa : SUBSS XMM3,XMM2
006214ae : MULSS XMM1,XMM7
006214b2 : MULSS XMM3,XMM1
006214b6 : ADDSS XMM3,XMM2
006214ba : MOVSS dword ptr [ESI + 0x40],XMM3
006214bf : MOVSS XMM2,dword ptr [EDI + 0x34]
006214c4 : MOVSS XMM3,dword ptr [EDI + 0x44]
006214c9 : SUBSS XMM3,XMM2
006214cd : MULSS XMM3,XMM1
006214d1 : ADDSS XMM3,XMM2
006214d5 : MOVSS dword ptr [ESI + 0x44],XMM3
006214da : MOVSS XMM2,dword ptr [EDI + 0x38]
006214df : MOVSS XMM3,dword ptr [EDI + 0x48]
006214e4 : SUBSS XMM3,XMM2
006214e8 : MULSS XMM3,XMM1
006214ec : ADDSS XMM3,XMM2
006214f0 : MOVSS dword ptr [ESI + 0x48],XMM3
006214f5 : MOVSS XMM2,dword ptr [EDI + 0x3c]
006214fa : MOVSS XMM3,dword ptr [EDI + 0x4c]
006214ff : SUBSS XMM3,XMM2
00621503 : MULSS XMM3,XMM1
00621507 : ADDSS XMM3,XMM2
0062150b : MOVSS dword ptr [ESI + 0x4c],XMM3
00621510 : MOVSS XMM2,dword ptr [EDI + 0x78]
00621515 : COMISS XMM2,XMM0
00621518 : JBE 0x0062153d
0062151a : MOVSS XMM1,dword ptr [ESI + 0x8]
0062151f : MOVSS XMM2,dword ptr [ESI + 0xc]
00621524 : MULSS XMM0,dword ptr [ESP + 0x1c]
0062152a : SUBSS XMM2,XMM1
0062152e : MULSS XMM2,XMM0
00621532 : ADDSS XMM2,XMM1
00621536 : MOVSS dword ptr [ESI + 0x54],XMM2
0062153b : JMP 0x00621562
0062153d : MOVSS XMM1,dword ptr [ESI + 0xc]
00621542 : SUBSS XMM0,XMM2
00621546 : MULSS XMM0,dword ptr [ESP + 0x20]
0062154c : MOVSS XMM2,dword ptr [ESI + 0x10]
00621551 : SUBSS XMM2,XMM1
00621555 : MULSS XMM0,XMM2
00621559 : ADDSS XMM0,XMM1
0062155d : MOVSS dword ptr [ESI + 0x54],XMM0
00621562 : MOVSS XMM0,dword ptr [ESI + 0x14]
00621567 : MULSS XMM0,XMM6
0062156b : ADDSS XMM0,dword ptr [ESI + 0x58]
00621570 : MOVSS dword ptr [ESI + 0x58],XMM0
00621575 : CMP dword ptr [EDI + 0x124],0x0
0062157c : JZ 0x00621647
00621582 : MOV ECX,dword ptr [EDI + 0x68]
00621585 : TEST CL,0x2
00621588 : JZ 0x00621623
0062158e : UCOMISS XMM4,XMM5
00621591 : LAHF
00621592 : TEST AH,0x44
00621595 : JP 0x006215d1
00621597 : TEST CL,0x4
0062159a : JZ 0x006215d1
0062159c : CALL 0x00635d2f
006215a1 : CDQ
006215a2 : MOV ECX,0x64
006215a7 : IDIV ECX
006215a9 : CVTSI2SS XMM1,dword ptr [EDI + 0x124]
006215b1 : XORPS XMM5,XMM5
006215b4 : MOVSS XMM6,dword ptr [ESP + 0xc]
006215ba : CVTSI2SS XMM0,EDX
006215be : MULSS XMM0,dword ptr [0x00cdf23c]
006215c6 : MULSS XMM0,XMM1
006215ca : CVTTSS2SI EDX,XMM0
006215ce : MOV dword ptr [ESI + 0x18],EDX
006215d1 : FLD float ptr [EDI + 0x108]
006215d7 : FMUL float ptr [ESI + 0x50]
006215da : FNSTCW word ptr [ESP + 0x30]
006215de : MOVZX EAX,word ptr [ESP + 0x30]
006215e3 : OR EAX,0xc00
006215e8 : MOV dword ptr [ESP + 0x24],EAX
006215ec : FLDCW word ptr [ESP + 0x24]
006215f0 : FISTP qword ptr [ESP + 0x24]
006215f4 : MOV EAX,dword ptr [ESP + 0x24]
006215f8 : ADD EAX,dword ptr [ESI + 0x18]
006215fb : TEST dword ptr [EDI + 0x68],0x40000
00621602 : FLDCW word ptr [ESP + 0x30]
00621606 : JZ 0x00621618
00621608 : MOV ECX,dword ptr [EDI + 0x124]
0062160e : CMP EAX,ECX
00621610 : JC 0x00621618
00621612 : DEC ECX
00621613 : MOV dword ptr [ESI + 0x5c],ECX
00621616 : JMP 0x00621623
00621618 : XOR EDX,EDX
0062161a : DIV dword ptr [EDI + 0x124]
00621620 : MOV dword ptr [ESI + 0x5c],EDX
00621623 : CMP dword ptr [EDI + 0x124],0x0
0062162a : JZ 0x00621647
0062162c : TEST byte ptr [EDI + 0x68],0x1
00621630 : JZ 0x00621647
00621632 : MOV EAX,dword ptr [ESI + 0x18]
00621635 : MOV dword ptr [ESI + 0x5c],EAX
00621638 : CMP EAX,dword ptr [EDI + 0x124]
0062163e : JL 0x00621647
00621640 : MOV dword ptr [ESI + 0x5c],0x0
00621647 : MOV EAX,dword ptr [ESI + 0x7c]
0062164a : TEST dword ptr [EAX + 0x100],0x200
00621654 : JZ 0x00621685
00621656 : TEST dword ptr [EDI + 0x68],0x100
0062165d : FLD float ptr [ESP + 0xc]
00621661 : PUSH ECX
00621662 : FSTP float ptr [ESP]
00621665 : JZ 0x00621673
00621667 : PUSH EAX
00621668 : PUSH ESI
00621669 : CALL 0x0061eef0
0062166e : ADD ESP,0xc
00621671 : JMP 0x0062167c
00621673 : PUSH ESI
00621674 : CALL 0x0061c7d0
00621679 : ADD ESP,0x8
0062167c : MOVSS XMM6,dword ptr [ESP + 0xc]
00621682 : XORPS XMM5,XMM5
00621685 : TEST dword ptr [EDI + 0x68],0x20000000
0062168c : JNZ 0x00621698
0062168e : ADDSS XMM6,dword ptr [ESI + 0x50]
00621693 : MOVSS dword ptr [ESI + 0x50],XMM6
00621698 : TEST dword ptr [EDI + 0x68],0x10000000
0062169f : JZ 0x006216bd
006216a1 : MOVSS XMM0,dword ptr [ESI + 0x1c]
006216a6 : MOVSS XMM1,dword ptr [ESI + 0x50]
006216ab : COMISS XMM1,XMM0
006216ae : JC 0x006216bd
006216b0 : SUBSS XMM0,dword ptr [0x00cdf32c]
006216b8 : MOVSS dword ptr [ESI + 0x50],XMM0
006216bd : TEST dword ptr [EDI + 0x68],0x100000
006216c4 : JZ 0x006216d6
006216c6 : MOVSS XMM0,dword ptr [ESI + 0x50]
006216cb : COMISS XMM0,dword ptr [ESI + 0x1c]
006216cf : JC 0x006216d6
006216d1 : MOVSS dword ptr [ESI + 0x50],XMM5
006216d6 : MOV EAX,dword ptr [EBP + 0x104]
006216dc : MOV ESI,dword ptr [EAX + 0x12c]
006216e2 : TEST ESI,ESI
006216e4 : JNZ 0x00621380
006216ea : POP EDI
006216eb : POP ESI
006216ec : POP EBP
006216ed : ADD ESP,0x20
006216f0 : RET

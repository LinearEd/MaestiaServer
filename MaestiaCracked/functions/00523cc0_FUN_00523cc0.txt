PROGRAM  : Maestia.exe
FUNCTION : FUN_00523cc0
ENTRY    : 00523cc0
BODY     : [[00523cc0, 00523dc7]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00523cc0(undefined4 param_1,undefined4 *param_2,uint param_3)

{
  undefined4 *puVar1;
  uint *puVar2;
  int *piVar3;
  uint uVar4;
  int *in_ECX;
  uint uVar5;
  uint uVar6;
  int iVar7;
  
  piVar3 = (int *)*in_ECX;
  if (piVar3 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar3 * 5) <= piVar3[1] * 4 + 4U) goto LAB_00523cfa;
    iVar7 = piVar3[1] * 2 + 2;
  }
  FUN_00523fa0(param_1,iVar7);
LAB_00523cfa:
  piVar3 = (int *)*in_ECX;
  param_3 = param_3 & piVar3[1];
  *piVar3 = *piVar3 + 1;
  iVar7 = *in_ECX;
  if (*(int *)(iVar7 + 8 + param_3 * 8) == -2) {
    *(undefined4 *)(iVar7 + 8 + param_3 * 8) = 0xffffffff;
    *(undefined4 *)(iVar7 + 0xc + param_3 * 8) = *param_2;
    return;
  }
  uVar6 = *(uint *)(iVar7 + 4);
  uVar5 = param_3;
  do {
    uVar5 = uVar5 + 1 & uVar6;
  } while (*(int *)(iVar7 + 8 + uVar5 * 8) != -2);
  uVar4 = *(uint *)(iVar7 + 0xc + param_3 * 8);
  puVar1 = (undefined4 *)(iVar7 + 8 + uVar5 * 8);
  if (((uVar4 >> 6 ^ uVar4) & uVar6) == param_3) {
    if (puVar1 != (undefined4 *)0x0) {
      *puVar1 = *(undefined4 *)(iVar7 + 8 + param_3 * 8);
      puVar1[1] = *(undefined4 *)(iVar7 + 0xc + param_3 * 8);
    }
    *(undefined4 *)(iVar7 + 0xc + param_3 * 8) = *param_2;
    *(uint *)(iVar7 + 8 + param_3 * 8) = uVar5;
    return;
  }
  uVar6 = (uVar4 >> 6 ^ uVar4) & uVar6;
  puVar2 = (uint *)(iVar7 + 8 + uVar6 * 8);
  for (uVar6 = *(uint *)(iVar7 + 8 + uVar6 * 8); uVar6 != param_3;
      uVar6 = *(uint *)(iVar7 + 8 + uVar6 * 8)) {
    uVar6 = *puVar2;
    puVar2 = (uint *)(iVar7 + 8 + uVar6 * 8);
  }
  if (puVar1 != (undefined4 *)0x0) {
    *puVar1 = *(undefined4 *)(iVar7 + 8 + param_3 * 8);
    puVar1[1] = *(undefined4 *)(iVar7 + 0xc + param_3 * 8);
  }
  *puVar2 = uVar5;
  *(undefined4 *)(iVar7 + 0xc + param_3 * 8) = *param_2;
  *(undefined4 *)(iVar7 + 8 + param_3 * 8) = 0xffffffff;
  return;
}



============================================================
DISASSEMBLY
============================================================
00523cc0 : PUSH ESI
00523cc1 : MOV ESI,ECX
00523cc3 : MOV EAX,dword ptr [ESI]
00523cc5 : PUSH EDI
00523cc6 : TEST EAX,EAX
00523cc8 : JNZ 0x00523cd3
00523cca : MOV EAX,dword ptr [ESP + 0xc]
00523cce : PUSH 0x8
00523cd0 : PUSH EAX
00523cd1 : JMP 0x00523cf5
00523cd3 : MOV ECX,dword ptr [EAX + 0x4]
00523cd6 : LEA EDX,[ECX*0x4 + 0x4]
00523cdd : MOV ECX,dword ptr [EAX]
00523cdf : LEA ECX,[ECX + ECX*0x4]
00523ce2 : CMP ECX,EDX
00523ce4 : JBE 0x00523cfa
00523ce6 : MOV EDX,dword ptr [EAX + 0x4]
00523ce9 : MOV ECX,dword ptr [ESP + 0xc]
00523ced : LEA EAX,[EDX + EDX*0x1 + 0x2]
00523cf1 : PUSH EAX
00523cf2 : PUSH ECX
00523cf3 : MOV ECX,ESI
00523cf5 : CALL 0x00523fa0
00523cfa : MOV EAX,dword ptr [ESI]
00523cfc : MOV ECX,dword ptr [ESP + 0x14]
00523d00 : AND ECX,dword ptr [EAX + 0x4]
00523d03 : INC dword ptr [EAX]
00523d05 : MOV EAX,dword ptr [ESI]
00523d07 : MOV EDX,dword ptr [EAX + ECX*0x8 + 0x8]
00523d0b : MOV EDI,0xfffffffe
00523d10 : CMP EDX,EDI
00523d12 : JNZ 0x00523d2b
00523d14 : MOV EDX,dword ptr [ESP + 0x10]
00523d18 : MOV dword ptr [EAX + ECX*0x8 + 0x8],0xffffffff
00523d20 : MOV EDX,dword ptr [EDX]
00523d22 : POP EDI
00523d23 : MOV dword ptr [EAX + ECX*0x8 + 0xc],EDX
00523d27 : POP ESI
00523d28 : RET 0xc
00523d2b : MOV ESI,dword ptr [EAX + 0x4]
00523d2e : MOV EDX,ECX
00523d30 : INC EDX
00523d31 : AND EDX,ESI
00523d33 : CMP dword ptr [EAX + EDX*0x8 + 0x8],EDI
00523d37 : JNZ 0x00523d30
00523d39 : MOV EDI,dword ptr [EAX + ECX*0x8 + 0xc]
00523d3d : PUSH EBX
00523d3e : PUSH EBP
00523d3f : MOV EBP,EDI
00523d41 : SHR EBP,0x6
00523d44 : XOR EBP,EDI
00523d46 : AND EBP,ESI
00523d48 : LEA EBX,[EAX + EDX*0x8 + 0x8]
00523d4c : CMP EBP,ECX
00523d4e : JNZ 0x00523d76
00523d50 : TEST EBX,EBX
00523d52 : JZ 0x00523d61
00523d54 : MOV ESI,dword ptr [EAX + ECX*0x8 + 0x8]
00523d58 : MOV dword ptr [EBX],ESI
00523d5a : MOV ESI,dword ptr [EAX + ECX*0x8 + 0xc]
00523d5e : MOV dword ptr [EBX + 0x4],ESI
00523d61 : MOV ESI,dword ptr [ESP + 0x18]
00523d65 : MOV ESI,dword ptr [ESI]
00523d67 : POP EBP
00523d68 : POP EBX
00523d69 : POP EDI
00523d6a : MOV dword ptr [EAX + ECX*0x8 + 0xc],ESI
00523d6e : MOV dword ptr [EAX + ECX*0x8 + 0x8],EDX
00523d72 : POP ESI
00523d73 : RET 0xc
00523d76 : MOV EBP,EDI
00523d78 : SHR EBP,0x6
00523d7b : XOR EBP,EDI
00523d7d : AND EBP,ESI
00523d7f : CMP dword ptr [EAX + EBP*0x8 + 0x8],ECX
00523d83 : LEA ESI,[EAX + EBP*0x8 + 0x8]
00523d87 : JZ 0x00523d9c
00523d89 : LEA ESP,[ESP]
00523d90 : MOV ESI,dword ptr [ESI]
00523d92 : CMP dword ptr [EAX + ESI*0x8 + 0x8],ECX
00523d96 : LEA ESI,[EAX + ESI*0x8 + 0x8]
00523d9a : JNZ 0x00523d90
00523d9c : TEST EBX,EBX
00523d9e : JZ 0x00523dad
00523da0 : MOV EDI,dword ptr [EAX + ECX*0x8 + 0x8]
00523da4 : MOV dword ptr [EBX],EDI
00523da6 : MOV EDI,dword ptr [EAX + ECX*0x8 + 0xc]
00523daa : MOV dword ptr [EBX + 0x4],EDI
00523dad : MOV dword ptr [ESI],EDX
00523daf : MOV EDX,dword ptr [ESP + 0x18]
00523db3 : MOV EDX,dword ptr [EDX]
00523db5 : POP EBP
00523db6 : POP EBX
00523db7 : POP EDI
00523db8 : MOV dword ptr [EAX + ECX*0x8 + 0xc],EDX
00523dbc : MOV dword ptr [EAX + ECX*0x8 + 0x8],0xffffffff
00523dc4 : POP ESI
00523dc5 : RET 0xc

PROGRAM  : Maestia.exe
FUNCTION : __wsplitpath_helper
ENTRY    : 00636be5
BODY     : [[00636be5, 00636dff]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    __wsplitpath_helper
   
   Library: Visual Studio 2008 Release */

undefined4
__wsplitpath_helper(wchar_t *param_1,wchar_t *param_2,uint param_3,wchar_t *param_4,uint param_5,
                   wchar_t *param_6,uint param_7,wchar_t *param_8,uint param_9)

{
  wchar_t wVar1;
  bool bVar2;
  int iVar3;
  uint uVar4;
  int *piVar5;
  wchar_t *pwVar6;
  wchar_t *pwVar7;
  wchar_t *pwVar8;
  
  pwVar8 = (wchar_t *)0x0;
  bVar2 = false;
  if (param_1 != (wchar_t *)0x0) {
    if (param_2 == (wchar_t *)0x0) {
      if (param_3 == 0) {
LAB_00636c11:
        if (param_4 == (wchar_t *)0x0) {
          if (param_5 == 0) {
LAB_00636c22:
            if (param_6 == (wchar_t *)0x0) {
              if (param_7 == 0) {
LAB_00636c33:
                if (param_8 == (wchar_t *)0x0) {
                  if (param_9 == 0) {
LAB_00636c3d:
                    iVar3 = 1;
                    pwVar6 = param_1;
                    do {
                      if (*pwVar6 == L'\0') break;
                      iVar3 = iVar3 + -1;
                      pwVar6 = pwVar6 + 1;
                    } while (iVar3 != 0);
                    if (*pwVar6 == L':') {
                      if (param_2 != (wchar_t *)0x0) {
                        if (param_3 < 3) goto LAB_00636d6b;
                        _wcsncpy_s(param_2,0xffffffff,param_1,2);
                      }
                      param_1 = pwVar6 + 1;
                    }
                    else if (param_2 != (wchar_t *)0x0) {
                      *param_2 = L'\0';
                    }
                    wVar1 = *param_1;
                    pwVar6 = (wchar_t *)0x0;
                    pwVar7 = param_1;
                    if (wVar1 == L'\0') {
LAB_00636cf5:
                      pwVar8 = param_1;
                      if (param_4 != (wchar_t *)0x0) {
                        *param_4 = L'\0';
                      }
                    }
                    else {
                      do {
                        if ((wVar1 == L'/') || (wVar1 == L'\\')) {
                          pwVar8 = pwVar7 + 1;
                        }
                        else if (wVar1 == L'.') {
                          pwVar6 = pwVar7;
                        }
                        pwVar7 = pwVar7 + 1;
                        wVar1 = *pwVar7;
                      } while (wVar1 != L'\0');
                      if (pwVar8 == (wchar_t *)0x0) goto LAB_00636cf5;
                      if (param_4 != (wchar_t *)0x0) {
                        uVar4 = (int)pwVar8 - (int)param_1 >> 1;
                        if (param_5 <= uVar4) goto LAB_00636d6b;
                        _wcsncpy_s(param_4,0xffffffff,param_1,uVar4);
                      }
                    }
                    param_1 = pwVar8;
                    if ((pwVar6 == (wchar_t *)0x0) || (pwVar6 < param_1)) {
                      if (param_6 != (wchar_t *)0x0) {
                        uVar4 = (int)pwVar7 - (int)param_1 >> 1;
                        if (param_7 <= uVar4) goto LAB_00636d6b;
                        _wcsncpy_s(param_6,0xffffffff,param_1,uVar4);
                      }
                      if (param_8 != (wchar_t *)0x0) {
                        *param_8 = L'\0';
                      }
                      return 0;
                    }
                    if (param_6 != (wchar_t *)0x0) {
                      uVar4 = (int)pwVar6 - (int)param_1 >> 1;
                      if (param_7 <= uVar4) goto LAB_00636d6b;
                      _wcsncpy_s(param_6,0xffffffff,param_1,uVar4);
                    }
                    if (param_8 == (wchar_t *)0x0) {
                      return 0;
                    }
                    uVar4 = (int)pwVar7 - (int)pwVar6 >> 1;
                    if (uVar4 < param_9) {
                      _wcsncpy_s(param_8,0xffffffff,pwVar6,uVar4);
                      return 0;
                    }
                    goto LAB_00636d6b;
                  }
                }
                else if (param_9 != 0) goto LAB_00636c3d;
              }
            }
            else if (param_7 != 0) goto LAB_00636c33;
          }
        }
        else if (param_5 != 0) goto LAB_00636c22;
      }
    }
    else if (param_3 != 0) goto LAB_00636c11;
  }
  bVar2 = true;
LAB_00636d6b:
  if ((param_2 != (wchar_t *)0x0) && (param_3 != 0)) {
    *param_2 = L'\0';
  }
  if ((param_4 != (wchar_t *)0x0) && (param_5 != 0)) {
    *param_4 = L'\0';
  }
  if ((param_6 != (wchar_t *)0x0) && (param_7 != 0)) {
    *param_6 = L'\0';
  }
  if ((param_8 != (wchar_t *)0x0) && (param_9 != 0)) {
    *param_8 = L'\0';
  }
  if (param_1 == (wchar_t *)0x0) {
    piVar5 = __errno();
  }
  else {
    piVar5 = __errno();
    if (!bVar2) {
      *piVar5 = 0x22;
      return 0x22;
    }
  }
  *piVar5 = 0x16;
  __invalid_parameter(0,0,0,0,0);
  return 0x16;
}



============================================================
DISASSEMBLY
============================================================
00636be5 : MOV EDI,EDI
00636be7 : PUSH EBP
00636be8 : MOV EBP,ESP
00636bea : PUSH ECX
00636beb : MOV ECX,dword ptr [EBP + 0x8]
00636bee : PUSH EBX
00636bef : PUSH ESI
00636bf0 : PUSH EDI
00636bf1 : XOR EDI,EDI
00636bf3 : MOV dword ptr [EBP + -0x4],EDI
00636bf6 : CMP ECX,EDI
00636bf8 : JZ 0x00636c7f
00636bfe : MOV EDX,dword ptr [EBP + 0xc]
00636c01 : CMP EDX,EDI
00636c03 : JNZ 0x00636c0c
00636c05 : CMP dword ptr [EBP + 0x10],EDI
00636c08 : JNZ 0x00636c7f
00636c0a : JMP 0x00636c11
00636c0c : CMP dword ptr [EBP + 0x10],EDI
00636c0f : JZ 0x00636c7f
00636c11 : CMP dword ptr [EBP + 0x14],EDI
00636c14 : JNZ 0x00636c1d
00636c16 : CMP dword ptr [EBP + 0x18],EDI
00636c19 : JNZ 0x00636c7f
00636c1b : JMP 0x00636c22
00636c1d : CMP dword ptr [EBP + 0x18],EDI
00636c20 : JZ 0x00636c7f
00636c22 : CMP dword ptr [EBP + 0x1c],EDI
00636c25 : JNZ 0x00636c2e
00636c27 : CMP dword ptr [EBP + 0x20],EDI
00636c2a : JNZ 0x00636c7f
00636c2c : JMP 0x00636c33
00636c2e : CMP dword ptr [EBP + 0x20],EDI
00636c31 : JZ 0x00636c7f
00636c33 : CMP dword ptr [EBP + 0x24],EDI
00636c36 : JNZ 0x00636c7a
00636c38 : CMP dword ptr [EBP + 0x28],EDI
00636c3b : JNZ 0x00636c7f
00636c3d : XOR EAX,EAX
00636c3f : INC EAX
00636c40 : MOV ESI,ECX
00636c42 : CMP word ptr [ESI],DI
00636c45 : JZ 0x00636c4e
00636c47 : DEC EAX
00636c48 : INC ESI
00636c49 : INC ESI
00636c4a : CMP EAX,EDI
00636c4c : JA 0x00636c42
00636c4e : CMP word ptr [ESI],0x3a
00636c52 : JNZ 0x00636c8b
00636c54 : CMP EDX,EDI
00636c56 : JZ 0x00636c70
00636c58 : CMP dword ptr [EBP + 0x10],0x3
00636c5c : JC 0x00636d6b
00636c62 : PUSH 0x2
00636c64 : PUSH ECX
00636c65 : PUSH -0x1
00636c67 : PUSH EDX
00636c68 : CALL 0x0063ba5b
00636c6d : ADD ESP,0x10
00636c70 : ADD ESI,0x2
00636c73 : MOV dword ptr [EBP + 0x8],ESI
00636c76 : MOV ECX,ESI
00636c78 : JMP 0x00636c94
00636c7a : CMP dword ptr [EBP + 0x28],EDI
00636c7d : JNZ 0x00636c3d
00636c7f : MOV dword ptr [EBP + -0x4],0x1
00636c86 : JMP 0x00636d68
00636c8b : CMP EDX,EDI
00636c8d : JZ 0x00636c94
00636c8f : XOR EAX,EAX
00636c91 : MOV word ptr [EDX],AX
00636c94 : MOVZX EAX,word ptr [ECX]
00636c97 : XOR EBX,EBX
00636c99 : MOV ESI,ECX
00636c9b : TEST AX,AX
00636c9e : JZ 0x00636cf5
00636ca0 : MOVZX EAX,AX
00636ca3 : CMP AX,0x2f
00636ca7 : JZ 0x00636cb9
00636ca9 : CMP AX,0x5c
00636cad : JZ 0x00636cb9
00636caf : CMP AX,0x2e
00636cb3 : JNZ 0x00636cbc
00636cb5 : MOV EBX,ESI
00636cb7 : JMP 0x00636cbc
00636cb9 : LEA EDI,[ESI + 0x2]
00636cbc : INC ESI
00636cbd : INC ESI
00636cbe : MOVZX EAX,word ptr [ESI]
00636cc1 : TEST AX,AX
00636cc4 : JNZ 0x00636ca3
00636cc6 : TEST EDI,EDI
00636cc8 : JZ 0x00636cf5
00636cca : CMP dword ptr [EBP + 0x14],0x0
00636cce : JZ 0x00636cee
00636cd0 : MOV EAX,EDI
00636cd2 : SUB EAX,ECX
00636cd4 : SAR EAX,0x1
00636cd6 : CMP dword ptr [EBP + 0x18],EAX
00636cd9 : JBE 0x00636d66
00636cdf : PUSH EAX
00636ce0 : PUSH ECX
00636ce1 : PUSH -0x1
00636ce3 : PUSH dword ptr [EBP + 0x14]
00636ce6 : CALL 0x0063ba5b
00636ceb : ADD ESP,0x10
00636cee : MOV dword ptr [EBP + 0x8],EDI
00636cf1 : MOV ECX,EDI
00636cf3 : JMP 0x00636d01
00636cf5 : MOV EAX,dword ptr [EBP + 0x14]
00636cf8 : TEST EAX,EAX
00636cfa : JZ 0x00636d01
00636cfc : XOR EDX,EDX
00636cfe : MOV word ptr [EAX],DX
00636d01 : TEST EBX,EBX
00636d03 : JZ 0x00636d53
00636d05 : CMP EBX,ECX
00636d07 : JC 0x00636d53
00636d09 : CMP dword ptr [EBP + 0x1c],0x0
00636d0d : JZ 0x00636d2c
00636d0f : MOV EAX,EBX
00636d11 : SUB EAX,ECX
00636d13 : SAR EAX,0x1
00636d15 : CMP dword ptr [EBP + 0x20],EAX
00636d18 : JBE 0x00636d66
00636d1a : PUSH EAX
00636d1b : PUSH ECX
00636d1c : PUSH -0x1
00636d1e : PUSH dword ptr [EBP + 0x1c]
00636d21 : CALL 0x0063ba5b
00636d26 : MOV ECX,dword ptr [EBP + 0x8]
00636d29 : ADD ESP,0x10
00636d2c : CMP dword ptr [EBP + 0x24],0x0
00636d30 : JZ 0x00636df9
00636d36 : SUB ESI,EBX
00636d38 : SAR ESI,0x1
00636d3a : CMP dword ptr [EBP + 0x28],ESI
00636d3d : JBE 0x00636d66
00636d3f : PUSH ESI
00636d40 : PUSH EBX
00636d41 : PUSH -0x1
00636d43 : PUSH dword ptr [EBP + 0x24]
00636d46 : CALL 0x0063ba5b
00636d4b : ADD ESP,0x10
00636d4e : JMP 0x00636df9
00636d53 : CMP dword ptr [EBP + 0x1c],0x0
00636d57 : JZ 0x00636ded
00636d5d : SUB ESI,ECX
00636d5f : SAR ESI,0x1
00636d61 : CMP dword ptr [EBP + 0x20],ESI
00636d64 : JA 0x00636dde
00636d66 : XOR EDI,EDI
00636d68 : MOV EDX,dword ptr [EBP + 0xc]
00636d6b : CMP EDX,EDI
00636d6d : JZ 0x00636d79
00636d6f : CMP dword ptr [EBP + 0x10],EDI
00636d72 : JBE 0x00636d79
00636d74 : XOR EAX,EAX
00636d76 : MOV word ptr [EDX],AX
00636d79 : MOV EAX,dword ptr [EBP + 0x14]
00636d7c : CMP EAX,EDI
00636d7e : JZ 0x00636d8a
00636d80 : CMP dword ptr [EBP + 0x18],EDI
00636d83 : JBE 0x00636d8a
00636d85 : XOR EDX,EDX
00636d87 : MOV word ptr [EAX],DX
00636d8a : MOV EAX,dword ptr [EBP + 0x1c]
00636d8d : CMP EAX,EDI
00636d8f : JZ 0x00636d9b
00636d91 : CMP dword ptr [EBP + 0x20],EDI
00636d94 : JBE 0x00636d9b
00636d96 : XOR EDX,EDX
00636d98 : MOV word ptr [EAX],DX
00636d9b : MOV EAX,dword ptr [EBP + 0x24]
00636d9e : CMP EAX,EDI
00636da0 : JZ 0x00636dac
00636da2 : CMP dword ptr [EBP + 0x28],EDI
00636da5 : JBE 0x00636dac
00636da7 : XOR EDX,EDX
00636da9 : MOV word ptr [EAX],DX
00636dac : CMP ECX,EDI
00636dae : JNZ 0x00636dcb
00636db0 : CALL 0x0063ab82
00636db5 : PUSH 0x16
00636db7 : POP ESI
00636db8 : PUSH EDI
00636db9 : PUSH EDI
00636dba : PUSH EDI
00636dbb : PUSH EDI
00636dbc : PUSH EDI
00636dbd : MOV dword ptr [EAX],ESI
00636dbf : CALL 0x006372b8
00636dc4 : ADD ESP,0x14
00636dc7 : MOV EAX,ESI
00636dc9 : JMP 0x00636dfb
00636dcb : CALL 0x0063ab82
00636dd0 : CMP dword ptr [EBP + -0x4],EDI
00636dd3 : JNZ 0x00636db5
00636dd5 : PUSH 0x22
00636dd7 : POP ECX
00636dd8 : MOV dword ptr [EAX],ECX
00636dda : MOV EAX,ECX
00636ddc : JMP 0x00636dfb
00636dde : PUSH ESI
00636ddf : PUSH ECX
00636de0 : PUSH -0x1
00636de2 : PUSH dword ptr [EBP + 0x1c]
00636de5 : CALL 0x0063ba5b
00636dea : ADD ESP,0x10
00636ded : MOV EAX,dword ptr [EBP + 0x24]
00636df0 : TEST EAX,EAX
00636df2 : JZ 0x00636df9
00636df4 : XOR ECX,ECX
00636df6 : MOV word ptr [EAX],CX
00636df9 : XOR EAX,EAX
00636dfb : POP EDI
00636dfc : POP ESI
00636dfd : POP EBX
00636dfe : LEAVE
00636dff : RET

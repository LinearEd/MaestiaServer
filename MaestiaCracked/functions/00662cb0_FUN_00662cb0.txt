PROGRAM  : Maestia.exe
FUNCTION : FUN_00662cb0
ENTRY    : 00662cb0
BODY     : [[00662cb0, 00662d37]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00662cb0(int param_1,int *param_2)

{
  int *piVar1;
  uint uVar2;
  LPCRITICAL_SECTION lpCriticalSection;
  void *local_c;
  undefined1 *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_00b0c718;
  local_c = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xffffffe8;
  ExceptionList = &local_c;
  if (param_1 == 0xc) {
    lpCriticalSection = (LPCRITICAL_SECTION)0x0;
  }
  else {
    lpCriticalSection = (LPCRITICAL_SECTION)(param_1 + 4);
  }
  EnterCriticalSection(lpCriticalSection);
  local_4 = 0;
  if (param_2 != (int *)0x0) {
    (**(code **)(*param_2 + 4))(param_2,uVar2);
  }
  piVar1 = *(int **)(param_1 + 0x4c);
  if (piVar1 != (int *)0x0) {
    (**(code **)(*piVar1 + 8))(piVar1);
  }
  *(int **)(param_1 + 0x4c) = param_2;
  LeaveCriticalSection(lpCriticalSection);
  ExceptionList = local_c;
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00662cb0 : PUSH -0x1
00662cb2 : PUSH 0xb0c718
00662cb7 : MOV EAX,FS:[0x0]
00662cbd : PUSH EAX
00662cbe : PUSH EBX
00662cbf : PUSH ESI
00662cc0 : PUSH EDI
00662cc1 : MOV EAX,[0x00d66fa0]
00662cc6 : XOR EAX,ESP
00662cc8 : PUSH EAX
00662cc9 : LEA EAX,[ESP + 0x10]
00662ccd : MOV FS:[0x0],EAX
00662cd3 : MOV EDI,dword ptr [ESP + 0x20]
00662cd7 : LEA EAX,[EDI + -0xc]
00662cda : TEST EAX,EAX
00662cdc : JZ 0x00662ce3
00662cde : LEA ESI,[EDI + 0x4]
00662ce1 : JMP 0x00662ce5
00662ce3 : XOR ESI,ESI
00662ce5 : PUSH ESI
00662ce6 : MOV dword ptr [ESP + 0x24],ESI
00662cea : CALL dword ptr [0x00b85118]
00662cf0 : MOV EBX,dword ptr [ESP + 0x24]
00662cf4 : MOV dword ptr [ESP + 0x18],0x0
00662cfc : TEST EBX,EBX
00662cfe : JZ 0x00662d08
00662d00 : MOV ECX,dword ptr [EBX]
00662d02 : MOV EDX,dword ptr [ECX + 0x4]
00662d05 : PUSH EBX
00662d06 : CALL EDX
00662d08 : MOV EAX,dword ptr [EDI + 0x4c]
00662d0b : TEST EAX,EAX
00662d0d : JZ 0x00662d17
00662d0f : MOV ECX,dword ptr [EAX]
00662d11 : MOV EDX,dword ptr [ECX + 0x8]
00662d14 : PUSH EAX
00662d15 : CALL EDX
00662d17 : PUSH ESI
00662d18 : MOV dword ptr [EDI + 0x4c],EBX
00662d1b : CALL dword ptr [0x00b8511c]
00662d21 : XOR EAX,EAX
00662d23 : MOV ECX,dword ptr [ESP + 0x10]
00662d27 : MOV dword ptr FS:[0x0],ECX
00662d2e : POP ECX
00662d2f : POP EDI
00662d30 : POP ESI
00662d31 : POP EBX
00662d32 : ADD ESP,0xc
00662d35 : RET 0x8

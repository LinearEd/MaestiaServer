PROGRAM  : Maestia.exe
FUNCTION : FUN_00a7a7f0
ENTRY    : 00a7a7f0
BODY     : [[00a7a7f0, 00a7aa47]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a7a7f0(int param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  int *in_ECX;
  bool bVar4;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4c752;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar3 = (**(code **)(*in_ECX + 0x98))();
  if (param_1 == 0) {
    FUN_008018d0();
  }
  else if ((iVar3 != 0) && (iVar1 = *(int *)(param_1 + 0x24), iVar1 != 0)) {
    FUN_00908f50();
    *(int *)(iVar3 + 8) = param_1;
    FUN_00405eb0();
    FUN_009eb590();
    if (*(char *)(iVar1 + 0x28) != '\0') {
      FUN_009eddb0();
      *(undefined1 *)(iVar1 + 0x28) = 0;
    }
    bVar4 = (short)*(undefined4 *)(iVar1 + 0x30) == 0;
    if (bVar4) {
      FUN_00406460();
    }
    else {
      FUN_00404750();
    }
    local_8 = (uint)bVar4;
    FUN_00405660();
    local_8 = 3;
    if (bVar4) {
      FUN_00406560();
    }
    local_8._0_1_ = 4;
    if (!bVar4) {
      FUN_00406560();
    }
    (**(code **)(*in_ECX + 0x44))();
    (**(code **)(*in_ECX + 0x4c))(*(undefined4 *)(iVar1 + 0x1c),param_3);
    (**(code **)(*in_ECX + 0x48))(iVar1 + 0x38,param_3,0);
    (**(code **)(*in_ECX + 0x50))
              (param_3,0,*(undefined4 *)(param_1 + 0x10),*(undefined1 *)(iVar1 + 0xb1));
    FUN_00405660(param_2);
    local_8._0_1_ = 4;
    FUN_008f75f0();
    local_8._0_1_ = 6;
    iVar3 = *DAT_00da9894;
    if ((iVar3 != 0) && (*(int *)(iVar3 + 0x114) != 0)) {
      (**(code **)(**(int **)(iVar3 + 0x114) + 4))();
    }
    local_8 = CONCAT31(local_8._1_3_,4);
    FUN_00406560();
    local_8 = 0xffffffff;
    FUN_00406560();
  }
  ExceptionList = local_10;
  __security_check_cookie(uVar2 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a7a7f0 : PUSH EBP
00a7a7f1 : MOV EBP,ESP
00a7a7f3 : PUSH -0x1
00a7a7f5 : PUSH 0xb4c752
00a7a7fa : MOV EAX,FS:[0x0]
00a7a800 : PUSH EAX
00a7a801 : SUB ESP,0x88
00a7a807 : MOV EAX,[0x00d66fa0]
00a7a80c : XOR EAX,EBP
00a7a80e : MOV dword ptr [EBP + -0x10],EAX
00a7a811 : PUSH EBX
00a7a812 : PUSH ESI
00a7a813 : PUSH EDI
00a7a814 : PUSH EAX
00a7a815 : LEA EAX,[EBP + -0xc]
00a7a818 : MOV FS:[0x0],EAX
00a7a81e : MOV EAX,dword ptr [EBP + 0xc]
00a7a821 : MOV ESI,dword ptr [EBP + 0x10]
00a7a824 : MOV EBX,dword ptr [EBP + 0x8]
00a7a827 : MOV EDI,ECX
00a7a829 : MOV dword ptr [EBP + -0x4c],0x0
00a7a830 : MOV EDX,dword ptr [EDI]
00a7a832 : MOV dword ptr [EBP + -0x58],EAX
00a7a835 : MOV EAX,dword ptr [EDX + 0x98]
00a7a83b : PUSH ESI
00a7a83c : MOV dword ptr [EBP + -0x54],EBX
00a7a83f : CALL EAX
00a7a841 : MOV dword ptr [EBP + -0x50],EAX
00a7a844 : TEST EBX,EBX
00a7a846 : JNZ 0x00a7a860
00a7a848 : MOV ESI,dword ptr [0x00da98e8]
00a7a84e : PUSH 0xc50fa0
00a7a853 : CALL 0x008018d0
00a7a858 : ADD ESP,0x4
00a7a85b : JMP 0x00a7aa2a
00a7a860 : TEST EAX,EAX
00a7a862 : JZ 0x00a7aa2a
00a7a868 : MOV EBX,dword ptr [EBX + 0x24]
00a7a86b : TEST EBX,EBX
00a7a86d : JZ 0x00a7aa2a
00a7a873 : MOV ECX,EAX
00a7a875 : CALL 0x00908f50
00a7a87a : MOV EAX,dword ptr [EBP + -0x50]
00a7a87d : MOV ECX,dword ptr [EBP + -0x54]
00a7a880 : MOV EDX,dword ptr [EBP + -0x58]
00a7a883 : PUSH -0x1
00a7a885 : PUSH 0x0
00a7a887 : MOV dword ptr [EAX + 0x8],ECX
00a7a88a : PUSH EDX
00a7a88b : LEA ECX,[EAX + 0x20]
00a7a88e : CALL 0x00405eb0
00a7a893 : MOV EAX,dword ptr [EBP + -0x50]
00a7a896 : PUSH EAX
00a7a897 : PUSH ESI
00a7a898 : MOV ECX,EBX
00a7a89a : CALL 0x009eb590
00a7a89f : CMP byte ptr [EBX + 0x28],0x0
00a7a8a3 : JZ 0x00a7a8af
00a7a8a5 : PUSH EBX
00a7a8a6 : CALL 0x009eddb0
00a7a8ab : MOV byte ptr [EBX + 0x28],0x0
00a7a8af : MOV EAX,dword ptr [EBX + 0x30]
00a7a8b2 : MOV dword ptr [EBP + -0x5c],EAX
00a7a8b5 : TEST AX,AX
00a7a8b8 : JBE 0x00a7a8e4
00a7a8ba : MOVZX ECX,AX
00a7a8bd : PUSH ECX
00a7a8be : PUSH 0xc51004
00a7a8c3 : LEA ESI,[EBP + 0xffffff6c]
00a7a8c9 : CALL 0x00404750
00a7a8ce : ADD ESP,0x8
00a7a8d1 : MOV dword ptr [EBP + -0x4],0x0
00a7a8d8 : MOV ESI,dword ptr [EBP + 0x10]
00a7a8db : MOV dword ptr [EBP + -0x4c],0x1
00a7a8e2 : JMP 0x00a7a8ff
00a7a8e4 : PUSH 0xc5100c
00a7a8e9 : LEA ECX,[EBP + -0x78]
00a7a8ec : CALL 0x00406460
00a7a8f1 : MOV dword ptr [EBP + -0x4],0x1
00a7a8f8 : MOV dword ptr [EBP + -0x4c],0x2
00a7a8ff : PUSH EAX
00a7a900 : LEA ECX,[EBP + -0x48]
00a7a903 : CALL 0x00405660
00a7a908 : MOV dword ptr [EBP + -0x4],0x3
00a7a90f : TEST byte ptr [EBP + -0x4c],0x2
00a7a913 : JZ 0x00a7a921
00a7a915 : AND dword ptr [EBP + -0x4c],0xfffffffd
00a7a919 : LEA ECX,[EBP + -0x78]
00a7a91c : CALL 0x00406560
00a7a921 : MOV byte ptr [EBP + -0x4],0x4
00a7a925 : TEST byte ptr [EBP + -0x4c],0x1
00a7a929 : JZ 0x00a7a93a
00a7a92b : AND dword ptr [EBP + -0x4c],0xfffffffe
00a7a92f : LEA ECX,[EBP + 0xffffff6c]
00a7a935 : CALL 0x00406560
00a7a93a : MOV EDX,dword ptr [EBP + -0x54]
00a7a93d : MOV EAX,dword ptr [EDX + 0x10]
00a7a940 : MOV EDX,dword ptr [EDI]
00a7a942 : MOV EDX,dword ptr [EDX + 0x44]
00a7a945 : PUSH EAX
00a7a946 : LEA EAX,[EBP + -0x48]
00a7a949 : PUSH EAX
00a7a94a : PUSH 0x0
00a7a94c : PUSH ESI
00a7a94d : MOV ECX,EDI
00a7a94f : CALL EDX
00a7a951 : MOV EAX,dword ptr [EBX + 0x20]
00a7a954 : MOV ECX,dword ptr [EBX + 0x1c]
00a7a957 : MOV EDX,dword ptr [EDI]
00a7a959 : PUSH EAX
00a7a95a : MOV EAX,dword ptr [EDX + 0x4c]
00a7a95d : PUSH 0x1
00a7a95f : PUSH 0x0
00a7a961 : PUSH ESI
00a7a962 : PUSH ECX
00a7a963 : MOV ECX,EDI
00a7a965 : CALL EAX
00a7a967 : MOV EDX,dword ptr [EDI]
00a7a969 : MOV EDX,dword ptr [EDX + 0x48]
00a7a96c : PUSH 0x0
00a7a96e : PUSH ESI
00a7a96f : LEA EAX,[EBX + 0x38]
00a7a972 : PUSH EAX
00a7a973 : MOV ECX,EDI
00a7a975 : CALL EDX
00a7a977 : MOV AL,byte ptr [EBX + 0xb1]
00a7a97d : MOV ECX,dword ptr [EBP + -0x54]
00a7a980 : MOV EDX,dword ptr [EDI]
00a7a982 : MOV EDX,dword ptr [EDX + 0x50]
00a7a985 : MOV byte ptr [EBP + -0x50],AL
00a7a988 : MOV EAX,dword ptr [ECX + 0x10]
00a7a98b : MOV ECX,dword ptr [EBP + -0x50]
00a7a98e : PUSH ECX
00a7a98f : PUSH EAX
00a7a990 : PUSH 0x0
00a7a992 : PUSH ESI
00a7a993 : MOV ECX,EDI
00a7a995 : CALL EDX
00a7a997 : MOV EAX,dword ptr [EBP + -0x58]
00a7a99a : SUB ESP,0x1c
00a7a99d : MOV ECX,ESP
00a7a99f : MOV dword ptr [EBP + -0x50],ESP
00a7a9a2 : PUSH EAX
00a7a9a3 : CALL 0x00405660
00a7a9a8 : MOV byte ptr [EBP + -0x4],0x5
00a7a9ac : MOV byte ptr [EBP + -0x4],0x4
00a7a9b0 : LEA ECX,[EBP + -0x2c]
00a7a9b3 : CALL 0x008f75f0
00a7a9b8 : ADD ESP,0x1c
00a7a9bb : MOV byte ptr [EBP + -0x4],0x6
00a7a9bf : MOV ECX,dword ptr [0x00da9894]
00a7a9c5 : MOV EAX,dword ptr [ECX]
00a7a9c7 : TEST EAX,EAX
00a7a9c9 : JZ 0x00a7aa0f
00a7a9cb : CMP dword ptr [EAX + 0x114],0x0
00a7a9d2 : JZ 0x00a7aa0f
00a7a9d4 : CMP dword ptr [EBP + -0x14],0x8
00a7a9d8 : MOV EAX,dword ptr [EAX + 0x114]
00a7a9de : MOV BL,byte ptr [EBX + 0xb1]
00a7a9e4 : MOV ECX,dword ptr [EBP + -0x28]
00a7a9e7 : JNC 0x00a7a9ec
00a7a9e9 : LEA ECX,[EBP + -0x28]
00a7a9ec : MOV EDX,dword ptr [EAX]
00a7a9ee : MOVZX EDI,BL
00a7a9f1 : PUSH EDI
00a7a9f2 : MOVZX EDI,word ptr [EBP + -0x5c]
00a7a9f6 : PUSH EDI
00a7a9f7 : MOVZX ESI,SI
00a7a9fa : PUSH ESI
00a7a9fb : PUSH ECX
00a7a9fc : PUSH 0xc51010
00a7aa01 : PUSH 0xc51020
00a7aa06 : PUSH EAX
00a7aa07 : MOV EAX,dword ptr [EDX + 0x4]
00a7aa0a : CALL EAX
00a7aa0c : ADD ESP,0x1c
00a7aa0f : MOV byte ptr [EBP + -0x4],0x4
00a7aa13 : LEA ECX,[EBP + -0x2c]
00a7aa16 : CALL 0x00406560
00a7aa1b : MOV dword ptr [EBP + -0x4],0xffffffff
00a7aa22 : LEA ECX,[EBP + -0x48]
00a7aa25 : CALL 0x00406560
00a7aa2a : MOV ECX,dword ptr [EBP + -0xc]
00a7aa2d : MOV dword ptr FS:[0x0],ECX
00a7aa34 : POP ECX
00a7aa35 : POP EDI
00a7aa36 : POP ESI
00a7aa37 : POP EBX
00a7aa38 : MOV ECX,dword ptr [EBP + -0x10]
00a7aa3b : XOR ECX,EBP
00a7aa3d : CALL 0x00633e6b
00a7aa42 : MOV ESP,EBP
00a7aa44 : POP EBP
00a7aa45 : RET 0xc

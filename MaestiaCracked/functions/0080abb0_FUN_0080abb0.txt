PROGRAM  : Maestia.exe
FUNCTION : FUN_0080abb0
ENTRY    : 0080abb0
BODY     : [[0080abb0, 0080b144] [0080b14b, 0080b475]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_0080abb0(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  wchar_t wVar1;
  undefined1 uVar2;
  char cVar3;
  undefined8 *puVar4;
  int iVar5;
  wchar_t *pwVar6;
  char *_Source;
  undefined4 *puVar7;
  undefined4 uVar8;
  HDC hdc;
  LPCWSTR lpFileName;
  HANDLE hFindFile;
  uint uVar9;
  uint uVar10;
  size_t _Count;
  uint uStack_35b0;
  undefined1 local_3594 [4];
  undefined2 local_3590;
  undefined4 local_3580;
  uint local_357c;
  undefined1 local_3578 [4];
  undefined2 local_3574;
  undefined8 local_356c;
  undefined8 local_3564;
  int local_355c;
  undefined1 local_3555;
  _WIN32_FIND_DATAW local_24b4;
  DEVMODEW local_2264;
  undefined1 local_2188 [28];
  undefined1 local_216c [32];
  undefined2 local_214c;
  undefined4 local_213c;
  uint local_2138;
  undefined1 local_2134 [4];
  undefined4 local_2130;
  undefined4 local_2120;
  uint local_211c;
  wchar_t local_2118;
  undefined1 local_2116 [8190];
  CHAR local_118 [256];
  uint local_18;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b6fc75;
  local_10 = ExceptionList;
  uStack_35b0 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&uStack_35b0;
  ExceptionList = &local_10;
  local_18 = uStack_35b0;
  timeBeginPeriod(1);
  FUN_00808540();
  FUN_00a0cc90();
  local_8 = 0;
  local_355c = FUN_006f0760(8,".\\Avatars.cpp",0x166,0);
  local_8._0_1_ = 1;
  if (local_355c == 0) {
    DAT_00da98a4 = 0;
  }
  else {
    DAT_00da98a4 = FUN_0080b760(local_355c);
  }
  local_8._0_1_ = 0;
  DAT_00da9876 = 0;
  DAT_00da9877 = 0;
  DAT_00da98b8 = 0;
  DAT_00da98ba = 0;
  puVar4 = (undefined8 *)FUN_008083f0();
  local_356c = *puVar4;
  local_3564 = puVar4[1];
  uVar9 = (uint)local_3564 >> 0x10;
  uVar10 = (uint)local_356c >> 0x10;
  _swprintf_s(&local_2118,0x1000,L"%2d%02d%02d_%02d%02d",(uint)(ushort)local_356c,uVar10,
              (uint)((ulonglong)local_356c >> 0x30),(uint)(ushort)local_3564,uVar9);
  pwVar6 = &local_2118;
  do {
    wVar1 = *pwVar6;
    pwVar6 = pwVar6 + 1;
  } while (wVar1 != L'\0');
  FUN_00406360(&local_2118,(int)pwVar6 - (int)local_2116 >> 1);
  _DAT_00d7cd74 = GetCurrentThreadId();
  GetCurrentDirectoryA(0x100,local_118);
  (*(code *)PTR_FUN_00d6d23c)(&DAT_00c2bdd4,"Fri Jul  4 14:53:14 2014");
  (*(code *)PTR_FUN_00d6d23c)(&DAT_00c2bdf4,local_118);
  FUN_00404350(local_118);
  local_8._0_1_ = 2;
  DAT_00da9898 = __wfopen(L"ClientPatcherLog.txt",L"wt");
  iVar5 = FUN_00809960();
  if (iVar5 == 0) {
    DAT_00d6ab0f = 0;
  }
  DAT_00d6911f = 0;
  DAT_00da9ac9 = 1;
  DAT_00da9b31 = 1;
  DAT_00da98e4 = 1;
  local_355c = FUN_006f0760(0x1dc,".\\Avatars.cpp",0x1e0,0);
  local_8._0_1_ = 3;
  if (local_355c == 0) {
    DAT_00da989c = (undefined4 *)0x0;
  }
  else {
    DAT_00da989c = (undefined4 *)FUN_008ba710(local_355c);
  }
  local_8._0_1_ = 2;
  FUN_008bb1a0();
  iVar5 = FUN_008b6db0(DAT_00da989c,local_3594);
  local_8._0_1_ = 4;
  if (*(uint *)(iVar5 + 0x18) < 8) {
    pwVar6 = (wchar_t *)(iVar5 + 4);
  }
  else {
    pwVar6 = *(wchar_t **)(iVar5 + 4);
  }
  _wcsncpy((wchar_t *)&DAT_00d6db88,pwVar6,0x100);
  local_8._0_1_ = 2;
  if (7 < local_357c) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_357c = 7;
  local_3580 = 0;
  local_3590 = 0;
  iVar5 = FUN_008b6db0(DAT_00da989c,local_3578);
  local_8._0_1_ = 5;
  if (*(uint *)(iVar5 + 0x18) < 8) {
    iVar5 = iVar5 + 4;
  }
  else {
    iVar5 = *(int *)(iVar5 + 4);
  }
  _Count = 0x100;
  _Source = (char *)FUN_0070cf00(iVar5);
  _strncpy(&DAT_00d6da88,_Source,_Count);
  local_8._0_1_ = 2;
  if (local_3564._4_4_ < 8) {
    local_3564 = 0x700000000;
    local_3574 = 0;
    FUN_0078a180();
    FUN_0041d740(DAT_00da989c,local_3594);
    local_8._0_1_ = 6;
    iVar5 = FUN_00405bb0(L"LIVE");
    local_3555 = iVar5 == 0;
    local_8._0_1_ = 2;
    uVar2 = (undefined1)local_8;
    local_8._0_1_ = 2;
    if (7 < local_357c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_357c = 7;
    local_3580 = 0;
    local_3590 = 0;
    if ((bool)local_3555) {
      puVar7 = DAT_00d71c8c;
      if (DAT_00d71ca0 < 8) {
        puVar7 = &DAT_00d71c8c;
      }
      uVar8 = FUN_00404750(L"%s_%s_%s",L"MAESTIA_AERIA",L"3.8.0.1",puVar7);
      local_8._0_1_ = 7;
      FUN_00405eb0(uVar8,0,0xffffffff);
      local_8._0_1_ = 2;
      if (7 < local_357c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_357c = 7;
      local_3580 = 0;
      local_3590 = 0;
    }
    else {
      local_8._0_1_ = uVar2;
      iVar5 = FUN_0041d740(DAT_00da989c,local_2134);
      local_8._0_1_ = 8;
      puVar7 = DAT_00d71c8c;
      if (DAT_00d71ca0 < 8) {
        puVar7 = &DAT_00d71c8c;
      }
      if (*(uint *)(iVar5 + 0x18) < 8) {
        iVar5 = iVar5 + 4;
      }
      else {
        iVar5 = *(int *)(iVar5 + 4);
      }
      uVar8 = FUN_00404750(L"%s_%s_%s_%s",L"MAESTIA_AERIA",iVar5,L"3.8.0.1",puVar7);
      local_8._0_1_ = 9;
      FUN_00405eb0(uVar8,0,0xffffffff);
      local_8 = CONCAT31(local_8._1_3_,8);
      if (7 < local_3564._4_4_) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_3564 = 0x700000000;
      local_3574 = 0;
      local_8._0_1_ = 2;
      if (7 < local_211c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_211c = 7;
      local_2120 = 0;
      local_2130 = (LPCWSTR)((uint)local_2130._2_2_ << 0x10);
    }
    local_8._0_1_ = 2;
    if (*(char *)((int)DAT_00da989c + 0x145) == '\x01') {
      puVar7 = DAT_00d71c8c;
      if (DAT_00d71ca0 < 8) {
        puVar7 = &DAT_00d71c8c;
      }
      uVar8 = FUN_00404750(L"%s(STEAM)",puVar7);
      local_8._0_1_ = 10;
      FUN_00405eb0(uVar8,0,0xffffffff);
      local_8._0_1_ = 2;
      if (7 < local_211c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_211c = 7;
      local_2120 = 0;
      local_2130 = (LPCWSTR)((uint)local_2130 & 0xffff0000);
    }
    local_8._0_1_ = 2;
    local_355c = FUN_006f0760(0x54,".\\Avatars.cpp",0x1fa,0);
    local_8._0_1_ = 0xb;
    if (local_355c == 0) {
      DAT_00da98b4 = 0;
    }
    else {
      DAT_00da98b4 = FUN_008b1dd0(local_355c);
    }
    local_8 = CONCAT31(local_8._1_3_,2);
    iVar5 = FUN_008089d0();
    if (iVar5 == 0) {
      if (DAT_00da989c != (undefined4 *)0x0) {
        (**(code **)*DAT_00da989c)(1);
        DAT_00da989c = (undefined4 *)0x0;
      }
      if (DAT_00da98b4 != 0) {
        FUN_008b1d10(DAT_00da98b4);
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      if (DAT_00da9898 != (FILE *)0x0) {
        _fclose(DAT_00da9898);
        DAT_00da9898 = (FILE *)0x0;
      }
      local_8 = local_8 & 0xffffff00;
      if (7 < local_2138) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_2138 = 7;
      local_213c = 0;
      local_214c = 0;
    }
    else {
      if (DAT_00da9898 != (FILE *)0x0) {
        _fclose(DAT_00da9898);
        DAT_00da9898 = (FILE *)0x0;
      }
      DAT_00da98c4 = FUN_006f0760(1,".\\Avatars.cpp",0x24a,0);
      local_8._1_3_ = (uint3)(local_8 >> 8);
      local_8._0_1_ = 2;
      local_355c = DAT_00da98c4;
      FUN_00401440();
      iVar5 = FUN_00808730();
      if (iVar5 == 0) {
        local_8 = (uint)local_8._1_3_ << 8;
        if (7 < local_2138) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_2138 = 7;
        local_213c = 0;
        local_214c = 0;
      }
      else {
        local_355c = FUN_006f0760(0x20,".\\Avatars.cpp",0x24e,0);
        local_8._0_1_ = 0xd;
        if (local_355c == 0) {
          DAT_00da98c0 = 0;
        }
        else {
          DAT_00da98c0 = FUN_0080b970(local_355c);
        }
        local_8 = CONCAT31(local_8._1_3_,2);
        local_3555 = 0;
        hdc = GetDC((HWND)0x0);
        iVar5 = GetDeviceCaps(hdc,0xc);
        if (iVar5 != 0x20) {
          _memset(&local_2264,0,0xdc);
          local_2264.dmSize = 0xdc;
          local_2264.dmBitsPerPel = 0x20;
          local_2264.dmFields = 0x40000;
          ChangeDisplaySettingsW(&local_2264,4);
          local_3555 = 1;
        }
        local_355c = FUN_006f0760(0xd0,".\\Avatars.cpp",0x27a,0);
        local_8._0_1_ = 0xe;
        if (local_355c == 0) {
          DAT_00da98a0 = 0;
        }
        else {
          DAT_00da98a0 = FUN_008b4710(local_355c);
        }
        local_8._0_1_ = 2;
        cVar3 = FUN_008b4980();
        if (((cVar3 == '\0') && (DAT_017248c8 != 0)) && (*(int *)(DAT_017248c8 + 0x148) == 2)) {
          *(undefined4 *)(DAT_00da98a0 + 0x90) = 5;
        }
        FUN_008b7050(DAT_00da989c);
        local_8._0_1_ = 0xf;
        FUN_00403510(local_2188);
        local_8._0_1_ = 0x11;
        FUN_00406560();
        FUN_008b7050(DAT_00da989c);
        local_8._0_1_ = 0x12;
        FUN_00403510(local_216c);
        local_8._0_1_ = 0x14;
        FUN_00406560();
        if (DAT_00da989c != (undefined4 *)0x0) {
          FUN_008b7050(DAT_00da989c);
          local_8._0_1_ = 0x15;
          FUN_00403510(local_2134);
          local_8 = CONCAT31(local_8._1_3_,0x17);
          FUN_00406560();
          lpFileName = local_2130;
          if (local_211c < 8) {
            lpFileName = (LPCWSTR)&local_2130;
          }
          hFindFile = FindFirstFileW(lpFileName,&local_24b4);
          if (hFindFile != (HANDLE)0xffffffff) {
            FindClose(hFindFile);
          }
          DAT_00da98be = hFindFile == (HANDLE)0xffffffff;
          local_8._0_1_ = 0x14;
          FUN_00406560();
        }
        FUN_0080ab30();
        iVar5 = FUN_00809f60(param_1,param_4);
        if ((iVar5 != 0) && (FUN_00808620(1), DAT_00da98a8 != 0)) {
          if (DAT_00da98a0 != 0) {
            *(undefined1 *)(DAT_00da98a8 + 0x32) = *(undefined1 *)(DAT_00da98a0 + 0x5f);
          }
          local_8 = CONCAT31(local_8._1_3_,0x18);
          (**(code **)(*(int *)(DAT_00da98a8 + 4) + 4))();
          FUN_00829bc0();
          local_8 = 0x14;
          FUN_0080b4e6();
          return;
        }
        local_8._0_1_ = 0x11;
        FUN_00406560();
        local_8._0_1_ = 2;
        FUN_00406560();
        local_8 = (uint)local_8._1_3_ << 8;
        FUN_00406560();
      }
    }
    local_8 = 0xffffffff;
    FUN_00a0add0();
    ExceptionList = local_10;
    __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
    return;
  }
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
0080abb0 : PUSH EBP
0080abb1 : MOV EBP,ESP
0080abb3 : PUSH -0x1
0080abb5 : PUSH 0xb6fc75
0080abba : MOV EAX,FS:[0x0]
0080abc0 : PUSH EAX
0080abc1 : PUSH ECX
0080abc2 : MOV EAX,0x358c
0080abc7 : CALL 0x0063b780
0080abcc : MOV EAX,[0x00d66fa0]
0080abd1 : XOR EAX,EBP
0080abd3 : MOV dword ptr [EBP + -0x14],EAX
0080abd6 : PUSH EBX
0080abd7 : PUSH ESI
0080abd8 : PUSH EDI
0080abd9 : PUSH EAX
0080abda : LEA EAX,[EBP + -0xc]
0080abdd : MOV FS:[0x0],EAX
0080abe3 : MOV dword ptr [EBP + -0x10],ESP
0080abe6 : MOV EAX,dword ptr [EBP + 0x8]
0080abe9 : MOV dword ptr [EBP + 0xffffca6c],EAX
0080abef : MOV ECX,dword ptr [EBP + 0x10]
0080abf2 : MOV dword ptr [EBP + 0xffffca68],ECX
0080abf8 : PUSH 0x1
0080abfa : CALL dword ptr [0x00b8559c]
0080ac00 : CALL 0x00808540
0080ac05 : LEA EDI,[EBP + 0xffffcab0]
0080ac0b : CALL 0x00a0cc90
0080ac10 : XOR EBX,EBX
0080ac12 : MOV dword ptr [EBP + -0x4],EBX
0080ac15 : PUSH EBX
0080ac16 : PUSH 0x166
0080ac1b : PUSH 0xc2bd6c
0080ac20 : PUSH 0x8
0080ac22 : CALL 0x006f0760
0080ac27 : ADD ESP,0x10
0080ac2a : MOV dword ptr [EBP + 0xffffcaa8],EAX
0080ac30 : MOV byte ptr [EBP + -0x4],0x1
0080ac34 : CMP EAX,EBX
0080ac36 : JZ 0x0080ac40
0080ac38 : PUSH EAX
0080ac39 : CALL 0x0080b760
0080ac3e : JMP 0x0080ac42
0080ac40 : XOR EAX,EAX
0080ac42 : MOV byte ptr [EBP + -0x4],BL
0080ac45 : MOV [0x00da98a4],EAX
0080ac4a : MOV byte ptr [0x00da9876],BL
0080ac50 : MOV byte ptr [0x00da9877],BL
0080ac56 : MOV byte ptr [0x00da98b8],BL
0080ac5c : MOV byte ptr [0x00da98ba],BL
0080ac62 : LEA EDI,[EBP + 0xffffca7c]
0080ac68 : CALL 0x008083f0
0080ac6d : MOVQ XMM0,qword ptr [EAX]
0080ac71 : MOVQ qword ptr [EBP + 0xffffca98],XMM0
0080ac79 : MOVQ XMM0,qword ptr [EAX + 0x8]
0080ac7e : MOVQ qword ptr [EBP + 0xffffcaa0],XMM0
0080ac86 : MOV EDX,dword ptr [EBP + 0xffffcaa0]
0080ac8c : SHR EDX,0x10
0080ac8f : PUSH EDX
0080ac90 : MOVZX EAX,word ptr [EBP + 0xffffcaa0]
0080ac97 : PUSH EAX
0080ac98 : MOV ECX,dword ptr [EBP + 0xffffca9c]
0080ac9e : SHR ECX,0x10
0080aca1 : PUSH ECX
0080aca2 : MOV EDX,dword ptr [EBP + 0xffffca98]
0080aca8 : SHR EDX,0x10
0080acab : PUSH EDX
0080acac : MOVZX EAX,word ptr [EBP + 0xffffca98]
0080acb3 : PUSH EAX
0080acb4 : PUSH 0xc2bd8c
0080acb9 : PUSH 0x1000
0080acbe : LEA ECX,[EBP + 0xffffdeec]
0080acc4 : PUSH ECX
0080acc5 : CALL 0x00635d51
0080acca : ADD ESP,0x20
0080accd : LEA EAX,[EBP + 0xffffdeec]
0080acd3 : LEA EDX,[EAX + 0x2]
0080acd6 : MOV CX,word ptr [EAX]
0080acd9 : ADD EAX,0x2
0080acdc : CMP CX,BX
0080acdf : JNZ 0x0080acd6
0080ace1 : SUB EAX,EDX
0080ace3 : SAR EAX,0x1
0080ace5 : PUSH EAX
0080ace6 : LEA EDX,[EBP + 0xffffdeec]
0080acec : PUSH EDX
0080aced : MOV ECX,0xd71c88
0080acf2 : CALL 0x00406360
0080acf7 : CALL dword ptr [0x00b85168]
0080acfd : MOV [0x00d7cd74],EAX
0080ad02 : LEA EAX,[EBP + 0xfffffeec]
0080ad08 : PUSH EAX
0080ad09 : PUSH 0x100
0080ad0e : CALL dword ptr [0x00b85214]
0080ad14 : PUSH 0xc2bdb8
0080ad19 : PUSH 0xc2bdd4
0080ad1e : CALL dword ptr [0x00d6d23c]
0080ad24 : LEA ECX,[EBP + 0xfffffeec]
0080ad2a : PUSH ECX
0080ad2b : PUSH 0xc2bdf4
0080ad30 : CALL dword ptr [0x00d6d23c]
0080ad36 : LEA EDX,[EBP + 0xfffffeec]
0080ad3c : PUSH EDX
0080ad3d : LEA ESI,[EBP + 0xffffdeb4]
0080ad43 : CALL 0x00404350
0080ad48 : MOV byte ptr [EBP + -0x4],0x2
0080ad4c : PUSH 0xc2be08
0080ad51 : PUSH 0xc2be10
0080ad56 : CALL 0x00636404
0080ad5b : ADD ESP,0x1c
0080ad5e : MOV [0x00da9898],EAX
0080ad63 : CALL 0x00809960
0080ad68 : CMP EAX,EBX
0080ad6a : JNZ 0x0080ad72
0080ad6c : MOV byte ptr [0x00d6ab0f],BL
0080ad72 : MOV byte ptr [0x00d6911f],BL
0080ad78 : MOV byte ptr [0x00da9ac9],0x1
0080ad7f : MOV byte ptr [0x00da9b31],0x1
0080ad86 : MOV byte ptr [0x00da98e4],0x1
0080ad8d : PUSH EBX
0080ad8e : PUSH 0x1e0
0080ad93 : PUSH 0xc2be3c
0080ad98 : PUSH 0x1dc
0080ad9d : CALL 0x006f0760
0080ada2 : ADD ESP,0x10
0080ada5 : MOV dword ptr [EBP + 0xffffcaa8],EAX
0080adab : MOV byte ptr [EBP + -0x4],0x3
0080adaf : CMP EAX,EBX
0080adb1 : JZ 0x0080adbb
0080adb3 : PUSH EAX
0080adb4 : CALL 0x008ba710
0080adb9 : JMP 0x0080adbd
0080adbb : XOR EAX,EAX
0080adbd : MOV byte ptr [EBP + -0x4],0x2
0080adc1 : MOV [0x00da989c],EAX
0080adc6 : CALL 0x008bb1a0
0080adcb : LEA EAX,[EBP + 0xffffca70]
0080add1 : PUSH EAX
0080add2 : MOV ECX,dword ptr [0x00da989c]
0080add8 : PUSH ECX
0080add9 : CALL 0x008b6db0
0080adde : MOV byte ptr [EBP + -0x4],0x4
0080ade2 : MOV ESI,0x8
0080ade7 : CMP dword ptr [EAX + 0x18],ESI
0080adea : JC 0x0080adf1
0080adec : MOV EAX,dword ptr [EAX + 0x4]
0080adef : JMP 0x0080adf4
0080adf1 : ADD EAX,0x4
0080adf4 : PUSH 0x100
0080adf9 : PUSH EAX
0080adfa : PUSH 0xd6db88
0080adff : CALL 0x00634e39
0080ae04 : ADD ESP,0xc
0080ae07 : MOV byte ptr [EBP + -0x4],0x2
0080ae0b : CMP dword ptr [EBP + 0xffffca88],ESI
0080ae11 : JC 0x0080ae1e
0080ae13 : MOV ECX,dword ptr [EBP + 0xffffca74]
0080ae19 : CALL 0x006f04e0
0080ae1e : MOV dword ptr [EBP + 0xffffca88],0x7
0080ae28 : MOV dword ptr [EBP + 0xffffca84],EBX
0080ae2e : XOR EDX,EDX
0080ae30 : MOV word ptr [EBP + 0xffffca74],DX
0080ae37 : LEA EAX,[EBP + 0xffffca8c]
0080ae3d : PUSH EAX
0080ae3e : MOV ECX,dword ptr [0x00da989c]
0080ae44 : PUSH ECX
0080ae45 : CALL 0x008b6db0
0080ae4a : MOV byte ptr [EBP + -0x4],0x5
0080ae4e : CMP dword ptr [EAX + 0x18],ESI
0080ae51 : JC 0x0080ae58
0080ae53 : MOV EAX,dword ptr [EAX + 0x4]
0080ae56 : JMP 0x0080ae5b
0080ae58 : ADD EAX,0x4
0080ae5b : PUSH 0x100
0080ae60 : PUSH EAX
0080ae61 : CALL 0x0070cf00
0080ae66 : ADD ESP,0x4
0080ae69 : PUSH EAX
0080ae6a : PUSH 0xd6da88
0080ae6f : CALL 0x00636e50
0080ae74 : ADD ESP,0xc
0080ae77 : MOV byte ptr [EBP + -0x4],0x2
0080ae7b : CMP dword ptr [EBP + 0xffffcaa4],ESI
0080ae81 : JC 0x0080ae8e
0080ae83 : MOV ECX,dword ptr [EBP + 0xffffca90]
0080ae89 : CALL 0x006f04e0
0080ae8e : MOV ESI,0x7
0080ae93 : MOV dword ptr [EBP + 0xffffcaa4],ESI
0080ae99 : MOV dword ptr [EBP + 0xffffcaa0],EBX
0080ae9f : XOR EDX,EDX
0080aea1 : MOV word ptr [EBP + 0xffffca90],DX
0080aea8 : CALL 0x0078a180
0080aead : LEA EAX,[EBP + 0xffffca70]
0080aeb3 : PUSH EAX
0080aeb4 : MOV ECX,dword ptr [0x00da989c]
0080aeba : PUSH ECX
0080aebb : CALL 0x0041d740
0080aec0 : MOV ECX,EAX
0080aec2 : MOV byte ptr [EBP + -0x4],0x6
0080aec6 : PUSH 0xc2be5c
0080aecb : LEA EDI,[ESI + -0x3]
0080aece : MOV EAX,dword ptr [ECX + 0x14]
0080aed1 : CALL 0x00405bb0
0080aed6 : TEST EAX,EAX
0080aed8 : SETZ byte ptr [EBP + 0xffffcaaf]
0080aedf : MOV byte ptr [EBP + -0x4],0x2
0080aee3 : MOV EDI,0x8
0080aee8 : CMP dword ptr [EBP + 0xffffca88],EDI
0080aeee : JC 0x0080aefb
0080aef0 : MOV ECX,dword ptr [EBP + 0xffffca74]
0080aef6 : CALL 0x006f04e0
0080aefb : MOV dword ptr [EBP + 0xffffca88],ESI
0080af01 : MOV dword ptr [EBP + 0xffffca84],EBX
0080af07 : XOR EDX,EDX
0080af09 : MOV word ptr [EBP + 0xffffca74],DX
0080af10 : CMP byte ptr [EBP + 0xffffcaaf],BL
0080af16 : JZ 0x0080af91
0080af18 : CMP dword ptr [0x00d71ca0],EDI
0080af1e : MOV EAX,[0x00d71c8c]
0080af23 : JNC 0x0080af2a
0080af25 : MOV EAX,0xd71c8c
0080af2a : PUSH EAX
0080af2b : PUSH 0xc2be68
0080af30 : PUSH 0xc2be78
0080af35 : PUSH 0xc2be94
0080af3a : LEA ESI,[EBP + 0xffffca70]
0080af40 : CALL 0x00404750
0080af45 : ADD ESP,0x10
0080af48 : MOV byte ptr [EBP + -0x4],0x7
0080af4c : PUSH -0x1
0080af4e : PUSH EBX
0080af4f : PUSH EAX
0080af50 : MOV ECX,0xd71c88
0080af55 : CALL 0x00405eb0
0080af5a : MOV byte ptr [EBP + -0x4],0x2
0080af5e : CMP dword ptr [EBP + 0xffffca88],0x8
0080af65 : JC 0x0080af72
0080af67 : MOV ECX,dword ptr [EBP + 0xffffca74]
0080af6d : CALL 0x006f04e0
0080af72 : MOV EDI,0x7
0080af77 : MOV dword ptr [EBP + 0xffffca88],EDI
0080af7d : MOV dword ptr [EBP + 0xffffca84],EBX
0080af83 : XOR EAX,EAX
0080af85 : MOV word ptr [EBP + 0xffffca74],AX
0080af8c : JMP 0x0080b05b
0080af91 : LEA ECX,[EBP + 0xffffded0]
0080af97 : PUSH ECX
0080af98 : MOV EDX,dword ptr [0x00da989c]
0080af9e : PUSH EDX
0080af9f : CALL 0x0041d740
0080afa4 : MOV byte ptr [EBP + -0x4],0x8
0080afa8 : CMP dword ptr [0x00d71ca0],EDI
0080afae : MOV ECX,dword ptr [0x00d71c8c]
0080afb4 : JNC 0x0080afbb
0080afb6 : MOV ECX,0xd71c8c
0080afbb : CMP dword ptr [EAX + 0x18],EDI
0080afbe : JC 0x0080afc5
0080afc0 : MOV EAX,dword ptr [EAX + 0x4]
0080afc3 : JMP 0x0080afc8
0080afc5 : ADD EAX,0x4
0080afc8 : PUSH ECX
0080afc9 : PUSH 0xc2bea8
0080afce : PUSH EAX
0080afcf : PUSH 0xc2beb8
0080afd4 : PUSH 0xc2bed4
0080afd9 : LEA ESI,[EBP + 0xffffca8c]
0080afdf : CALL 0x00404750
0080afe4 : ADD ESP,0x14
0080afe7 : MOV byte ptr [EBP + -0x4],0x9
0080afeb : PUSH -0x1
0080afed : PUSH EBX
0080afee : PUSH EAX
0080afef : MOV ECX,0xd71c88
0080aff4 : CALL 0x00405eb0
0080aff9 : MOV byte ptr [EBP + -0x4],0x8
0080affd : MOV ESI,0x8
0080b002 : CMP dword ptr [EBP + 0xffffcaa4],ESI
0080b008 : JC 0x0080b015
0080b00a : MOV ECX,dword ptr [EBP + 0xffffca90]
0080b010 : CALL 0x006f04e0
0080b015 : MOV EDI,0x7
0080b01a : MOV dword ptr [EBP + 0xffffcaa4],EDI
0080b020 : MOV dword ptr [EBP + 0xffffcaa0],EBX
0080b026 : XOR EAX,EAX
0080b028 : MOV word ptr [EBP + 0xffffca90],AX
0080b02f : MOV byte ptr [EBP + -0x4],0x2
0080b033 : CMP dword ptr [EBP + 0xffffdee8],ESI
0080b039 : JC 0x0080b046
0080b03b : MOV ECX,dword ptr [EBP + 0xffffded4]
0080b041 : CALL 0x006f04e0
0080b046 : MOV dword ptr [EBP + 0xffffdee8],EDI
0080b04c : MOV dword ptr [EBP + 0xffffdee4],EBX
0080b052 : XOR ECX,ECX
0080b054 : MOV word ptr [EBP + 0xffffded4],CX
0080b05b : MOV EDX,dword ptr [0x00da989c]
0080b061 : CMP byte ptr [EDX + 0x145],0x1
0080b068 : JNZ 0x0080b0d0
0080b06a : CMP dword ptr [0x00d71ca0],0x8
0080b071 : MOV EAX,[0x00d71c8c]
0080b076 : JNC 0x0080b07d
0080b078 : MOV EAX,0xd71c8c
0080b07d : PUSH EAX
0080b07e : PUSH 0xc2beec
0080b083 : LEA ESI,[EBP + 0xffffded0]
0080b089 : CALL 0x00404750
0080b08e : ADD ESP,0x8
0080b091 : MOV byte ptr [EBP + -0x4],0xa
0080b095 : PUSH -0x1
0080b097 : PUSH EBX
0080b098 : PUSH EAX
0080b099 : MOV ECX,0xd71c88
0080b09e : CALL 0x00405eb0
0080b0a3 : MOV byte ptr [EBP + -0x4],0x2
0080b0a7 : CMP dword ptr [EBP + 0xffffdee8],0x8
0080b0ae : JC 0x0080b0bb
0080b0b0 : MOV ECX,dword ptr [EBP + 0xffffded4]
0080b0b6 : CALL 0x006f04e0
0080b0bb : MOV dword ptr [EBP + 0xffffdee8],EDI
0080b0c1 : MOV dword ptr [EBP + 0xffffdee4],EBX
0080b0c7 : XOR EAX,EAX
0080b0c9 : MOV word ptr [EBP + 0xffffded4],AX
0080b0d0 : PUSH EBX
0080b0d1 : PUSH 0x1fa
0080b0d6 : PUSH 0xc2bf00
0080b0db : PUSH 0x54
0080b0dd : CALL 0x006f0760
0080b0e2 : ADD ESP,0x10
0080b0e5 : MOV dword ptr [EBP + 0xffffcaa8],EAX
0080b0eb : MOV byte ptr [EBP + -0x4],0xb
0080b0ef : CMP EAX,EBX
0080b0f1 : JZ 0x0080b0fb
0080b0f3 : PUSH EAX
0080b0f4 : CALL 0x008b1dd0
0080b0f9 : JMP 0x0080b0fd
0080b0fb : XOR EAX,EAX
0080b0fd : MOV byte ptr [EBP + -0x4],0x2
0080b101 : MOV [0x00da98b4],EAX
0080b106 : MOV ECX,dword ptr [EBP + 0xffffca68]
0080b10c : CALL 0x008089d0
0080b111 : CMP EAX,EBX
0080b113 : JNZ 0x0080b194
0080b115 : MOV ECX,dword ptr [0x00da989c]
0080b11b : CMP ECX,EBX
0080b11d : JZ 0x0080b12d
0080b11f : MOV EDX,dword ptr [ECX]
0080b121 : PUSH 0x1
0080b123 : MOV EAX,dword ptr [EDX]
0080b125 : CALL EAX
0080b127 : MOV dword ptr [0x00da989c],EBX
0080b12d : MOV EAX,[0x00da98b4]
0080b132 : CMP EAX,EBX
0080b134 : JZ 0x0080b14b
0080b136 : MOV ESI,EAX
0080b138 : PUSH EAX
0080b139 : CALL 0x008b1d10
0080b13e : MOV ECX,ESI
0080b140 : CALL 0x006f04e0
0080b14b : MOV EAX,[0x00da9898]
0080b150 : CMP EAX,EBX
0080b152 : JZ 0x0080b163
0080b154 : PUSH EAX
0080b155 : CALL 0x006366db
0080b15a : ADD ESP,0x4
0080b15d : MOV dword ptr [0x00da9898],EBX
0080b163 : MOV byte ptr [EBP + -0x4],BL
0080b166 : CMP dword ptr [EBP + 0xffffdecc],0x8
0080b16d : JC 0x0080b17a
0080b16f : MOV ECX,dword ptr [EBP + 0xffffdeb8]
0080b175 : CALL 0x006f04e0
0080b17a : MOV dword ptr [EBP + 0xffffdecc],EDI
0080b180 : MOV dword ptr [EBP + 0xffffdec8],EBX
0080b186 : XOR ECX,ECX
0080b188 : MOV word ptr [EBP + 0xffffdeb8],CX
0080b18f : JMP 0x0080b6c9
0080b194 : MOV EAX,[0x00da9898]
0080b199 : CMP EAX,EBX
0080b19b : JZ 0x0080b1ac
0080b19d : PUSH EAX
0080b19e : CALL 0x006366db
0080b1a3 : ADD ESP,0x4
0080b1a6 : MOV dword ptr [0x00da9898],EBX
0080b1ac : PUSH EBX
0080b1ad : PUSH 0x24a
0080b1b2 : PUSH 0xc2bf20
0080b1b7 : PUSH 0x1
0080b1b9 : CALL 0x006f0760
0080b1be : ADD ESP,0x10
0080b1c1 : MOV dword ptr [EBP + 0xffffcaa8],EAX
0080b1c7 : MOV byte ptr [EBP + -0x4],0xc
0080b1cb : MOV byte ptr [EBP + -0x4],0x2
0080b1cf : MOV [0x00da98c4],EAX
0080b1d4 : MOV EAX,0xd71d14
0080b1d9 : CALL 0x00401440
0080b1de : CALL 0x00808730
0080b1e3 : TEST EAX,EAX
0080b1e5 : JNZ 0x0080b218
0080b1e7 : MOV byte ptr [EBP + -0x4],BL
0080b1ea : CMP dword ptr [EBP + 0xffffdecc],0x8
0080b1f1 : JC 0x0080b1fe
0080b1f3 : MOV ECX,dword ptr [EBP + 0xffffdeb8]
0080b1f9 : CALL 0x006f04e0
0080b1fe : MOV dword ptr [EBP + 0xffffdecc],EDI
0080b204 : MOV dword ptr [EBP + 0xffffdec8],EBX
0080b20a : XOR EDX,EDX
0080b20c : MOV word ptr [EBP + 0xffffdeb8],DX
0080b213 : JMP 0x0080b6c9
0080b218 : PUSH EBX
0080b219 : PUSH 0x24e
0080b21e : PUSH 0xc2bf54
0080b223 : PUSH 0x20
0080b225 : CALL 0x006f0760
0080b22a : ADD ESP,0x10
0080b22d : MOV dword ptr [EBP + 0xffffcaa8],EAX
0080b233 : MOV byte ptr [EBP + -0x4],0xd
0080b237 : CMP EAX,EBX
0080b239 : JZ 0x0080b243
0080b23b : PUSH EAX
0080b23c : CALL 0x0080b970
0080b241 : JMP 0x0080b245
0080b243 : XOR EAX,EAX
0080b245 : MOV byte ptr [EBP + -0x4],0x2
0080b249 : MOV [0x00da98c0],EAX
0080b24e : MOV byte ptr [EBP + 0xffffcaaf],BL
0080b254 : PUSH EBX
0080b255 : CALL dword ptr [0x00b85500]
0080b25b : PUSH 0xc
0080b25d : PUSH EAX
0080b25e : CALL dword ptr [0x00b8507c]
0080b264 : CMP EAX,0x20
0080b267 : JZ 0x0080b2b4
0080b269 : PUSH 0xdc
0080b26e : PUSH EBX
0080b26f : LEA EAX,[EBP + 0xffffdda0]
0080b275 : PUSH EAX
0080b276 : CALL 0x0063b700
0080b27b : ADD ESP,0xc
0080b27e : MOV ECX,0xdc
0080b283 : MOV word ptr [EBP + 0xffffdde4],CX
0080b28a : MOV dword ptr [EBP + 0xffffde48],0x20
0080b294 : MOV dword ptr [EBP + 0xffffdde8],0x40000
0080b29e : PUSH 0x4
0080b2a0 : LEA EDX,[EBP + 0xffffdda0]
0080b2a6 : PUSH EDX
0080b2a7 : CALL dword ptr [0x00b85470]
0080b2ad : MOV byte ptr [EBP + 0xffffcaaf],0x1
0080b2b4 : PUSH EBX
0080b2b5 : PUSH 0x27a
0080b2ba : PUSH 0xc2bf74
0080b2bf : PUSH 0xd0
0080b2c4 : CALL 0x006f0760
0080b2c9 : ADD ESP,0x10
0080b2cc : MOV dword ptr [EBP + 0xffffcaa8],EAX
0080b2d2 : MOV byte ptr [EBP + -0x4],0xe
0080b2d6 : CMP EAX,EBX
0080b2d8 : JZ 0x0080b2e2
0080b2da : PUSH EAX
0080b2db : CALL 0x008b4710
0080b2e0 : JMP 0x0080b2e4
0080b2e2 : XOR EAX,EAX
0080b2e4 : MOV byte ptr [EBP + -0x4],0x2
0080b2e8 : MOV [0x00da98a0],EAX
0080b2ed : CALL 0x008b4980
0080b2f2 : CMP AL,BL
0080b2f4 : JNZ 0x0080b317
0080b2f6 : MOV EAX,[0x017248c8]
0080b2fb : CMP EAX,EBX
0080b2fd : JZ 0x0080b317
0080b2ff : CMP dword ptr [EAX + 0x148],0x2
0080b306 : JNZ 0x0080b317
0080b308 : MOV EAX,[0x00da98a0]
0080b30d : MOV dword ptr [EAX + 0x90],0x5
0080b317 : MOV ECX,dword ptr [0x00da989c]
0080b31d : PUSH ECX
0080b31e : LEA ESI,[EBP + 0xffffded0]
0080b324 : CALL 0x008b7050
0080b329 : MOV byte ptr [EBP + -0x4],0xf
0080b32d : LEA EDX,[EBP + 0xffffde7c]
0080b333 : PUSH EDX
0080b334 : MOV EDX,0xc2bf94
0080b339 : MOV ECX,EAX
0080b33b : CALL 0x00403510
0080b340 : ADD ESP,0x4
0080b343 : MOV byte ptr [EBP + -0x4],0x11
0080b347 : MOV ECX,ESI
0080b349 : CALL 0x00406560
0080b34e : MOV EAX,[0x00da989c]
0080b353 : PUSH EAX
0080b354 : LEA ESI,[EBP + 0xffffca70]
0080b35a : CALL 0x008b7050
0080b35f : MOV byte ptr [EBP + -0x4],0x12
0080b363 : LEA ECX,[EBP + 0xffffde98]
0080b369 : PUSH ECX
0080b36a : MOV EDX,0xc2bfac
0080b36f : MOV ECX,EAX
0080b371 : CALL 0x00403510
0080b376 : ADD ESP,0x4
0080b379 : MOV byte ptr [EBP + -0x4],0x14
0080b37d : MOV ECX,ESI
0080b37f : CALL 0x00406560
0080b384 : MOV EAX,[0x00da989c]
0080b389 : CMP EAX,EBX
0080b38b : JZ 0x0080b40b
0080b38d : PUSH EAX
0080b38e : LEA ESI,[EBP + 0xffffca8c]
0080b394 : CALL 0x008b7050
0080b399 : MOV byte ptr [EBP + -0x4],0x15
0080b39d : LEA EDX,[EBP + 0xffffded0]
0080b3a3 : PUSH EDX
0080b3a4 : MOV EDX,0xc2bfc4
0080b3a9 : MOV ECX,EAX
0080b3ab : CALL 0x00403510
0080b3b0 : ADD ESP,0x4
0080b3b3 : MOV byte ptr [EBP + -0x4],0x17
0080b3b7 : MOV ECX,ESI
0080b3b9 : CALL 0x00406560
0080b3be : CMP dword ptr [EBP + 0xffffdee8],0x8
0080b3c5 : MOV EAX,dword ptr [EBP + 0xffffded4]
0080b3cb : JNC 0x0080b3d3
0080b3cd : LEA EAX,[EBP + 0xffffded4]
0080b3d3 : LEA ECX,[EBP + 0xffffdb50]
0080b3d9 : PUSH ECX
0080b3da : PUSH EAX
0080b3db : CALL dword ptr [0x00b85238]
0080b3e1 : CMP EAX,-0x1
0080b3e4 : JNZ 0x0080b3ef
0080b3e6 : MOV byte ptr [0x00da98be],0x1
0080b3ed : JMP 0x0080b3fc
0080b3ef : PUSH EAX
0080b3f0 : CALL dword ptr [0x00b8521c]
0080b3f6 : MOV byte ptr [0x00da98be],BL
0080b3fc : MOV byte ptr [EBP + -0x4],0x14
0080b400 : LEA ECX,[EBP + 0xffffded0]
0080b406 : CALL 0x00406560
0080b40b : MOV ESI,dword ptr [EBP + 0xffffca6c]
0080b411 : MOV EAX,ESI
0080b413 : CALL 0x0080ab30
0080b418 : MOV EDX,dword ptr [EBP + 0x14]
0080b41b : PUSH EDX
0080b41c : PUSH ESI
0080b41d : CALL 0x00809f60
0080b422 : ADD ESP,0x8
0080b425 : TEST EAX,EAX
0080b427 : JZ 0x0080b69d
0080b42d : PUSH 0x1
0080b42f : CALL 0x00808620
0080b434 : ADD ESP,0x4
0080b437 : MOV ECX,dword ptr [0x00da98a8]
0080b43d : CMP ECX,EBX
0080b43f : JZ 0x0080b69d
0080b445 : MOV EAX,[0x00da98a0]
0080b44a : CMP EAX,EBX
0080b44c : JZ 0x0080b454
0080b44e : MOV AL,byte ptr [EAX + 0x5f]
0080b451 : MOV byte ptr [ECX + 0x32],AL
0080b454 : MOV byte ptr [EBP + -0x4],0x18
0080b458 : MOV ECX,dword ptr [0x00da98a8]
0080b45e : ADD ECX,0x4
0080b461 : MOV EAX,dword ptr [ECX]
0080b463 : MOV EDX,dword ptr [EAX + 0x4]
0080b466 : CALL EDX
0080b468 : CALL 0x00829bc0
0080b46d : MOV dword ptr [EBP + -0x4],0x14
0080b474 : JMP 0x0080b4e6

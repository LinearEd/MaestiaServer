PROGRAM  : Maestia.exe
FUNCTION : FUN_00813280
ENTRY    : 00813280
BODY     : [[00813280, 008134b9] [008134c0, 00813680]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_00813280(undefined4 param_1)

{
  short sVar1;
  char cVar2;
  uint uVar3;
  short *psVar4;
  int *in_ECX;
  int iVar5;
  undefined1 local_2058 [8];
  undefined4 local_2050;
  undefined4 local_204c;
  undefined4 local_2048;
  int local_2044;
  undefined4 local_2040;
  undefined4 local_203c;
  int local_2038;
  undefined1 local_2034 [4];
  undefined2 local_2030;
  undefined4 local_2020;
  uint local_201c;
  short local_2018;
  undefined1 local_2016 [8190];
  uint local_18;
  undefined4 uStack_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  puStack_c = &LAB_00b1a88f;
  local_10 = ExceptionList;
  uStack_14 = 0x81329b;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_2040 = param_1;
  local_201c = 7;
  local_2020 = 0;
  local_2030 = 0;
  local_8 = 0;
  iVar5 = 0;
  local_18 = uVar3;
  while (((uint)in_ECX[9] < (uint)in_ECX[8] &&
         (cVar2 = (**(code **)(*in_ECX + 0x1c))(&local_2050,uVar3), cVar2 != '\0'))) {
    switch(local_2050) {
    case 0x5031:
      (**(code **)(*in_ECX + 0xc))(&local_203c,4,1);
      break;
    case 0x5032:
      local_2038 = FUN_006f0760(0xa8,"",0,(DAT_01725270 >> 3 & 1) == 0);
      local_8._0_1_ = 1;
      if (local_2038 == 0) {
        iVar5 = 0;
      }
      else {
        iVar5 = FUN_00453550(local_2038);
      }
      local_8 = (uint)local_8._1_3_ << 8;
      FUN_0070d080(&local_2018);
      psVar4 = &local_2018;
      do {
        sVar1 = *psVar4;
        psVar4 = psVar4 + 1;
      } while (sVar1 != 0);
      FUN_00406360(&local_2018,(int)psVar4 - (int)local_2016 >> 1);
      if (iVar5 != 0) {
        FUN_00405eb0(local_2034,0,0xffffffff);
      }
      FUN_00406360(&DAT_00c2e800,0);
      break;
    case 0x5033:
      FUN_0070d080(&local_2018);
      psVar4 = &local_2018;
      do {
        sVar1 = *psVar4;
        psVar4 = psVar4 + 1;
      } while (sVar1 != 0);
      FUN_00406360(&local_2018,(int)psVar4 - (int)local_2016 >> 1);
      if (iVar5 != 0) {
        FUN_00405eb0(local_2034,0,0xffffffff);
      }
      FUN_00406360(&DAT_00c2e804,0);
      break;
    case 0x5034:
      FUN_0070d080(&local_2018);
      psVar4 = &local_2018;
      do {
        sVar1 = *psVar4;
        psVar4 = psVar4 + 1;
      } while (sVar1 != 0);
      FUN_00406360(&local_2018,(int)psVar4 - (int)local_2016 >> 1);
      if (iVar5 != 0) {
        FUN_00405eb0(local_2034,0,0xffffffff);
      }
      FUN_00406360(&DAT_00c2e808,0);
      break;
    case 0x5035:
      FUN_0070d080(&local_2018);
      psVar4 = &local_2018;
      do {
        sVar1 = *psVar4;
        psVar4 = psVar4 + 1;
      } while (sVar1 != 0);
      FUN_00406360(&local_2018,(int)psVar4 - (int)local_2016 >> 1);
      if (iVar5 != 0) {
        FUN_00405eb0(local_2034,0,0xffffffff);
      }
      FUN_00406360(&DAT_00c2e80c,0);
      break;
    case 0x5036:
      FUN_0070d080(&local_2018);
      psVar4 = &local_2018;
      do {
        sVar1 = *psVar4;
        psVar4 = psVar4 + 1;
      } while (sVar1 != 0);
      FUN_00406360(&local_2018,(int)psVar4 - (int)local_2016 >> 1);
      if (iVar5 != 0) {
        FUN_00405eb0(local_2034,0,0xffffffff);
      }
      FUN_00406360(&DAT_00c2e810,0);
      break;
    case 0x5037:
      FUN_0070d080(&local_2018);
      psVar4 = &local_2018;
      do {
        sVar1 = *psVar4;
        psVar4 = psVar4 + 1;
      } while (sVar1 != 0);
      FUN_00406360(&local_2018,(int)psVar4 - (int)local_2016 >> 1);
      if (iVar5 != 0) {
        FUN_00405eb0(local_2034,0,0xffffffff);
      }
      local_2048 = local_203c;
      local_2044 = iVar5;
      FUN_00451e00(local_2058,&local_2048);
      break;
    case 0x5038:
      local_8 = 0xffffffff;
      if (7 < local_201c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      goto LAB_00813653;
    default:
      (**(code **)(*in_ECX + 0x24))(local_204c);
    }
  }
  local_8 = 0xffffffff;
  if (7 < local_201c) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
LAB_00813653:
  local_8 = 0xffffffff;
  local_2030 = 0;
  local_2020 = 0;
  local_201c = 7;
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00813280 : PUSH EBP
00813281 : MOV EBP,ESP
00813283 : PUSH -0x1
00813285 : PUSH 0xb1a88f
0081328a : MOV EAX,FS:[0x0]
00813290 : PUSH EAX
00813291 : MOV EAX,0x2048
00813296 : CALL 0x0063b780
0081329b : MOV EAX,[0x00d66fa0]
008132a0 : XOR EAX,EBP
008132a2 : MOV dword ptr [EBP + -0x14],EAX
008132a5 : PUSH EBX
008132a6 : PUSH ESI
008132a7 : PUSH EDI
008132a8 : PUSH EAX
008132a9 : LEA EAX,[EBP + -0xc]
008132ac : MOV FS:[0x0],EAX
008132b2 : MOV EAX,dword ptr [EBP + 0x8]
008132b5 : MOV EDI,ECX
008132b7 : XOR EBX,EBX
008132b9 : XOR ECX,ECX
008132bb : MOV dword ptr [EBP + 0xffffdfc4],EAX
008132c1 : MOV dword ptr [EBP + 0xffffdfe8],0x7
008132cb : MOV dword ptr [EBP + 0xffffdfe4],EBX
008132d1 : MOV word ptr [EBP + 0xffffdfd4],CX
008132d8 : MOV dword ptr [EBP + -0x4],EBX
008132db : XOR ESI,ESI
008132dd : LEA ECX,[ECX]
008132e0 : MOV EDX,dword ptr [EDI + 0x24]
008132e3 : CMP EDX,dword ptr [EDI + 0x20]
008132e6 : JNC 0x0081362f
008132ec : MOV EAX,dword ptr [EDI]
008132ee : MOV EDX,dword ptr [EAX + 0x1c]
008132f1 : LEA ECX,[EBP + 0xffffdfb4]
008132f7 : PUSH ECX
008132f8 : MOV ECX,EDI
008132fa : CALL EDX
008132fc : TEST AL,AL
008132fe : JZ 0x0081362f
00813304 : MOV EAX,dword ptr [EBP + 0xffffdfb4]
0081330a : ADD EAX,0xffffafcf
0081330f : CMP EAX,0x7
00813312 : JA 0x008135f4
00813318 : JMP dword ptr [EAX*0x4 + 0x813684]
0081331f : MOV EAX,dword ptr [EDI]
00813321 : MOV EDX,dword ptr [EAX + 0xc]
00813324 : PUSH 0x1
00813326 : PUSH 0x4
00813328 : LEA ECX,[EBP + 0xffffdfc8]
0081332e : PUSH ECX
0081332f : MOV ECX,EDI
00813331 : CALL EDX
00813333 : JMP 0x008132e0
00813335 : MOV EAX,[0x01725270]
0081333a : SHR EAX,0x3
0081333d : MOV ECX,0x0
00813342 : AND EAX,0x1
00813345 : SETZ CL
00813348 : PUSH ECX
00813349 : PUSH EBX
0081334a : PUSH 0xbf1a4a
0081334f : PUSH 0xa8
00813354 : CALL 0x006f0760
00813359 : ADD ESP,0x10
0081335c : MOV dword ptr [EBP + 0xffffdfcc],EAX
00813362 : MOV byte ptr [EBP + -0x4],0x1
00813366 : CMP EAX,EBX
00813368 : JZ 0x00813374
0081336a : PUSH EAX
0081336b : CALL 0x00453550
00813370 : MOV ESI,EAX
00813372 : JMP 0x00813376
00813374 : XOR ESI,ESI
00813376 : MOV byte ptr [EBP + -0x4],BL
00813379 : LEA EDX,[EBP + 0xffffdfec]
0081337f : PUSH EDX
00813380 : CALL 0x0070d080
00813385 : LEA EAX,[EBP + 0xffffdfec]
0081338b : LEA EDX,[EAX + 0x2]
0081338e : MOV EDI,EDI
00813390 : MOV CX,word ptr [EAX]
00813393 : ADD EAX,0x2
00813396 : CMP CX,BX
00813399 : JNZ 0x00813390
0081339b : SUB EAX,EDX
0081339d : SAR EAX,0x1
0081339f : PUSH EAX
008133a0 : LEA EAX,[EBP + 0xffffdfec]
008133a6 : PUSH EAX
008133a7 : LEA ECX,[EBP + 0xffffdfd0]
008133ad : CALL 0x00406360
008133b2 : CMP ESI,EBX
008133b4 : JZ 0x008133c7
008133b6 : PUSH -0x1
008133b8 : PUSH EBX
008133b9 : LEA ECX,[EBP + 0xffffdfd0]
008133bf : PUSH ECX
008133c0 : MOV ECX,ESI
008133c2 : CALL 0x00405eb0
008133c7 : PUSH EBX
008133c8 : PUSH 0xc2e800
008133cd : LEA ECX,[EBP + 0xffffdfd0]
008133d3 : CALL 0x00406360
008133d8 : JMP 0x008132e0
008133dd : LEA EDX,[EBP + 0xffffdfec]
008133e3 : PUSH EDX
008133e4 : CALL 0x0070d080
008133e9 : LEA EAX,[EBP + 0xffffdfec]
008133ef : LEA EDX,[EAX + 0x2]
008133f2 : MOV CX,word ptr [EAX]
008133f5 : ADD EAX,0x2
008133f8 : CMP CX,BX
008133fb : JNZ 0x008133f2
008133fd : SUB EAX,EDX
008133ff : SAR EAX,0x1
00813401 : PUSH EAX
00813402 : LEA EAX,[EBP + 0xffffdfec]
00813408 : PUSH EAX
00813409 : LEA ECX,[EBP + 0xffffdfd0]
0081340f : CALL 0x00406360
00813414 : CMP ESI,EBX
00813416 : JZ 0x0081342a
00813418 : PUSH -0x1
0081341a : PUSH EBX
0081341b : LEA ECX,[EBP + 0xffffdfd0]
00813421 : PUSH ECX
00813422 : LEA ECX,[ESI + 0x1c]
00813425 : CALL 0x00405eb0
0081342a : PUSH EBX
0081342b : PUSH 0xc2e804
00813430 : LEA ECX,[EBP + 0xffffdfd0]
00813436 : CALL 0x00406360
0081343b : JMP 0x008132e0
00813440 : LEA EDX,[EBP + 0xffffdfec]
00813446 : PUSH EDX
00813447 : CALL 0x0070d080
0081344c : LEA EAX,[EBP + 0xffffdfec]
00813452 : LEA EDX,[EAX + 0x2]
00813455 : MOV CX,word ptr [EAX]
00813458 : ADD EAX,0x2
0081345b : CMP CX,BX
0081345e : JNZ 0x00813455
00813460 : SUB EAX,EDX
00813462 : SAR EAX,0x1
00813464 : PUSH EAX
00813465 : LEA EAX,[EBP + 0xffffdfec]
0081346b : PUSH EAX
0081346c : LEA ECX,[EBP + 0xffffdfd0]
00813472 : CALL 0x00406360
00813477 : CMP ESI,EBX
00813479 : JZ 0x0081348d
0081347b : PUSH -0x1
0081347d : PUSH EBX
0081347e : LEA ECX,[EBP + 0xffffdfd0]
00813484 : PUSH ECX
00813485 : LEA ECX,[ESI + 0x38]
00813488 : CALL 0x00405eb0
0081348d : PUSH EBX
0081348e : PUSH 0xc2e808
00813493 : LEA ECX,[EBP + 0xffffdfd0]
00813499 : CALL 0x00406360
0081349e : JMP 0x008132e0
008134a3 : LEA EDX,[EBP + 0xffffdfec]
008134a9 : PUSH EDX
008134aa : CALL 0x0070d080
008134af : LEA EAX,[EBP + 0xffffdfec]
008134b5 : LEA EDX,[EAX + 0x2]
008134b8 : JMP 0x008134c0
008134c0 : MOV CX,word ptr [EAX]
008134c3 : ADD EAX,0x2
008134c6 : CMP CX,BX
008134c9 : JNZ 0x008134c0
008134cb : SUB EAX,EDX
008134cd : SAR EAX,0x1
008134cf : PUSH EAX
008134d0 : LEA EAX,[EBP + 0xffffdfec]
008134d6 : PUSH EAX
008134d7 : LEA ECX,[EBP + 0xffffdfd0]
008134dd : CALL 0x00406360
008134e2 : CMP ESI,EBX
008134e4 : JZ 0x008134f8
008134e6 : PUSH -0x1
008134e8 : PUSH EBX
008134e9 : LEA ECX,[EBP + 0xffffdfd0]
008134ef : PUSH ECX
008134f0 : LEA ECX,[ESI + 0x54]
008134f3 : CALL 0x00405eb0
008134f8 : PUSH EBX
008134f9 : PUSH 0xc2e80c
008134fe : LEA ECX,[EBP + 0xffffdfd0]
00813504 : CALL 0x00406360
00813509 : JMP 0x008132e0
0081350e : LEA EDX,[EBP + 0xffffdfec]
00813514 : PUSH EDX
00813515 : CALL 0x0070d080
0081351a : LEA EAX,[EBP + 0xffffdfec]
00813520 : LEA EDX,[EAX + 0x2]
00813523 : MOV CX,word ptr [EAX]
00813526 : ADD EAX,0x2
00813529 : CMP CX,BX
0081352c : JNZ 0x00813523
0081352e : SUB EAX,EDX
00813530 : SAR EAX,0x1
00813532 : PUSH EAX
00813533 : LEA EAX,[EBP + 0xffffdfec]
00813539 : PUSH EAX
0081353a : LEA ECX,[EBP + 0xffffdfd0]
00813540 : CALL 0x00406360
00813545 : CMP ESI,EBX
00813547 : JZ 0x0081355b
00813549 : PUSH -0x1
0081354b : PUSH EBX
0081354c : LEA ECX,[EBP + 0xffffdfd0]
00813552 : PUSH ECX
00813553 : LEA ECX,[ESI + 0x70]
00813556 : CALL 0x00405eb0
0081355b : PUSH EBX
0081355c : PUSH 0xc2e810
00813561 : LEA ECX,[EBP + 0xffffdfd0]
00813567 : CALL 0x00406360
0081356c : JMP 0x008132e0
00813571 : LEA EDX,[EBP + 0xffffdfec]
00813577 : PUSH EDX
00813578 : CALL 0x0070d080
0081357d : LEA EAX,[EBP + 0xffffdfec]
00813583 : LEA EDX,[EAX + 0x2]
00813586 : MOV CX,word ptr [EAX]
00813589 : ADD EAX,0x2
0081358c : CMP CX,BX
0081358f : JNZ 0x00813586
00813591 : SUB EAX,EDX
00813593 : SAR EAX,0x1
00813595 : PUSH EAX
00813596 : LEA EAX,[EBP + 0xffffdfec]
0081359c : PUSH EAX
0081359d : LEA ECX,[EBP + 0xffffdfd0]
008135a3 : CALL 0x00406360
008135a8 : CMP ESI,EBX
008135aa : JZ 0x008135c1
008135ac : PUSH -0x1
008135ae : PUSH EBX
008135af : LEA ECX,[EBP + 0xffffdfd0]
008135b5 : PUSH ECX
008135b6 : LEA ECX,[ESI + 0x8c]
008135bc : CALL 0x00405eb0
008135c1 : MOV EDX,dword ptr [EBP + 0xffffdfc8]
008135c7 : LEA EAX,[EBP + 0xffffdfbc]
008135cd : PUSH EAX
008135ce : MOV EAX,dword ptr [EBP + 0xffffdfc4]
008135d4 : LEA ECX,[EBP + 0xffffdfac]
008135da : PUSH ECX
008135db : ADD EAX,0x54
008135de : MOV dword ptr [EBP + 0xffffdfbc],EDX
008135e4 : MOV dword ptr [EBP + 0xffffdfc0],ESI
008135ea : CALL 0x00451e00
008135ef : JMP 0x008132e0
008135f4 : MOV EDX,dword ptr [EDI]
008135f6 : MOV EAX,dword ptr [EBP + 0xffffdfb8]
008135fc : MOV EDX,dword ptr [EDX + 0x24]
008135ff : PUSH EAX
00813600 : MOV ECX,EDI
00813602 : CALL EDX
00813604 : JMP 0x008132e0
00813609 : MOV dword ptr [EBP + -0x4],0xffffffff
00813610 : CMP dword ptr [EBP + 0xffffdfe8],0x8
00813617 : JC 0x00813624
00813619 : MOV ECX,dword ptr [EBP + 0xffffdfd4]
0081361f : CALL 0x006f04e0
00813624 : XOR EAX,EAX
00813626 : MOV word ptr [EBP + 0xffffdfd4],AX
0081362d : JMP 0x00813653
0081362f : MOV dword ptr [EBP + -0x4],0xffffffff
00813636 : CMP dword ptr [EBP + 0xffffdfe8],0x8
0081363d : JC 0x0081364a
0081363f : MOV ECX,dword ptr [EBP + 0xffffdfd4]
00813645 : CALL 0x006f04e0
0081364a : XOR ECX,ECX
0081364c : MOV word ptr [EBP + 0xffffdfd4],CX
00813653 : MOV dword ptr [EBP + 0xffffdfe4],EBX
00813659 : MOV dword ptr [EBP + 0xffffdfe8],0x7
00813663 : MOV ECX,dword ptr [EBP + -0xc]
00813666 : MOV dword ptr FS:[0x0],ECX
0081366d : POP ECX
0081366e : POP EDI
0081366f : POP ESI
00813670 : POP EBX
00813671 : MOV ECX,dword ptr [EBP + -0x14]
00813674 : XOR ECX,EBP
00813676 : CALL 0x00633e6b
0081367b : MOV ESP,EBP
0081367d : POP EBP
0081367e : RET 0x4

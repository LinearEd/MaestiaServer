PROGRAM  : Maestia.exe
FUNCTION : FUN_00a8aaf0
ENTRY    : 00a8aaf0
BODY     : [[00a8aaf0, 00a8ac6a]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a8aaf0(void)

{
  int iVar1;
  int iVar2;
  int *in_ECX;
  uint local_44;
  int local_3c;
  int local_34;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  puStack_c = &LAB_00b4c88c;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_34 = 0;
  do {
    local_3c = 0;
    do {
      iVar1 = in_ECX[0xf];
      iVar2 = *(int *)(iVar1 + 0xc) * local_3c + local_34;
      if ((((iVar2 < *(int *)(iVar1 + 8) * *(int *)(iVar1 + 0xc)) && (-1 < iVar2)) &&
          (iVar1 = *(int *)(*(int *)(iVar1 + 0x10) + iVar2 * 4), iVar1 != 0)) &&
         (*(int *)(iVar1 + 8) != 0)) {
        local_18 = 7;
        local_1c = 0;
        local_2c = 0;
        local_8 = 0;
        (**(code **)(*in_ECX + 0x58))();
        FUN_00405eb0(local_30,0,0xffffffff);
        local_8 = local_8 & 0xffffff00;
        FUN_008f75f0();
        local_8._0_1_ = 2;
        FUN_00405eb0();
        local_8 = (uint)local_8._1_3_ << 8;
        if (7 < local_44) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_44 = 7;
        FUN_009048f0();
        local_8 = 0xffffffff;
        if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_18 = 7;
        local_1c = 0;
        local_2c = 0;
      }
      local_8 = 0xffffffff;
      local_3c = local_3c + 1;
    } while (local_3c < 4);
    local_34 = local_34 + 1;
    if (4 < local_34) {
      ExceptionList = local_10;
      __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
      return;
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
00a8aaf0 : PUSH EBP
00a8aaf1 : MOV EBP,ESP
00a8aaf3 : PUSH -0x1
00a8aaf5 : PUSH 0xb4c88c
00a8aafa : MOV EAX,FS:[0x0]
00a8ab00 : PUSH EAX
00a8ab01 : SUB ESP,0x4c
00a8ab04 : MOV EAX,[0x00d66fa0]
00a8ab09 : XOR EAX,EBP
00a8ab0b : MOV dword ptr [EBP + -0x10],EAX
00a8ab0e : PUSH EBX
00a8ab0f : PUSH ESI
00a8ab10 : PUSH EDI
00a8ab11 : PUSH EAX
00a8ab12 : LEA EAX,[EBP + -0xc]
00a8ab15 : MOV FS:[0x0],EAX
00a8ab1b : XOR EBX,EBX
00a8ab1d : XOR EAX,EAX
00a8ab1f : MOV EDI,ECX
00a8ab21 : MOV dword ptr [EBP + -0x30],EAX
00a8ab24 : XOR ESI,ESI
00a8ab26 : MOV dword ptr [EBP + -0x38],ESI
00a8ab29 : MOV dword ptr [EBP + -0x34],EAX
00a8ab2c : LEA ESP,[ESP]
00a8ab30 : MOV ECX,dword ptr [EDI + 0x3c]
00a8ab33 : MOV EDX,dword ptr [ECX + 0xc]
00a8ab36 : MOV EAX,EDX
00a8ab38 : IMUL EAX,ESI
00a8ab3b : MOV ESI,dword ptr [ECX + 0x8]
00a8ab3e : ADD EAX,dword ptr [EBP + -0x30]
00a8ab41 : IMUL ESI,EDX
00a8ab44 : CMP EAX,ESI
00a8ab46 : JGE 0x00a8ac2b
00a8ab4c : CMP EAX,EBX
00a8ab4e : JL 0x00a8ac2b
00a8ab54 : MOV ECX,dword ptr [ECX + 0x10]
00a8ab57 : MOV EAX,dword ptr [ECX + EAX*0x4]
00a8ab5a : CMP EAX,EBX
00a8ab5c : JZ 0x00a8ac2b
00a8ab62 : MOV ESI,dword ptr [EAX + 0x8]
00a8ab65 : CMP ESI,EBX
00a8ab67 : JZ 0x00a8ac2b
00a8ab6d : MOV EAX,dword ptr [ESI + 0x10]
00a8ab70 : XOR EDX,EDX
00a8ab72 : MOV dword ptr [EBP + -0x14],0x7
00a8ab79 : MOV dword ptr [EBP + -0x18],EBX
00a8ab7c : MOV word ptr [EBP + -0x28],DX
00a8ab80 : MOV dword ptr [EBP + -0x4],EBX
00a8ab83 : MOV EDX,dword ptr [EDI]
00a8ab85 : MOV EDX,dword ptr [EDX + 0x58]
00a8ab88 : LEA ECX,[EBP + -0x2c]
00a8ab8b : PUSH ECX
00a8ab8c : PUSH EAX
00a8ab8d : MOV ECX,EDI
00a8ab8f : CALL EDX
00a8ab91 : SUB ESP,0x1c
00a8ab94 : MOV ECX,ESP
00a8ab96 : MOV dword ptr [EBP + -0x3c],ESP
00a8ab99 : PUSH -0x1
00a8ab9b : PUSH EBX
00a8ab9c : LEA EDX,[EBP + -0x2c]
00a8ab9f : XOR EAX,EAX
00a8aba1 : MOV dword ptr [ECX + 0x18],0x7
00a8aba8 : MOV dword ptr [ECX + 0x14],EBX
00a8abab : PUSH EDX
00a8abac : MOV word ptr [ECX + 0x4],AX
00a8abb0 : CALL 0x00405eb0
00a8abb5 : MOV byte ptr [EBP + -0x4],0x1
00a8abb9 : MOV byte ptr [EBP + -0x4],BL
00a8abbc : LEA ECX,[EBP + -0x58]
00a8abbf : CALL 0x008f75f0
00a8abc4 : ADD ESP,0x1c
00a8abc7 : MOV byte ptr [EBP + -0x4],0x2
00a8abcb : PUSH -0x1
00a8abcd : PUSH EBX
00a8abce : PUSH EAX
00a8abcf : LEA ECX,[EBP + -0x2c]
00a8abd2 : CALL 0x00405eb0
00a8abd7 : MOV byte ptr [EBP + -0x4],BL
00a8abda : CMP dword ptr [EBP + -0x40],0x8
00a8abde : JC 0x00a8abe8
00a8abe0 : MOV ECX,dword ptr [EBP + -0x54]
00a8abe3 : CALL 0x006f04e0
00a8abe8 : MOV ECX,dword ptr [EBP + -0x34]
00a8abeb : PUSH ECX
00a8abec : LEA EDX,[EBP + -0x2c]
00a8abef : PUSH EDX
00a8abf0 : XOR EAX,EAX
00a8abf2 : PUSH EDI
00a8abf3 : MOV dword ptr [EBP + -0x40],0x7
00a8abfa : MOV dword ptr [EBP + -0x44],EBX
00a8abfd : MOV word ptr [EBP + -0x54],AX
00a8ac01 : CALL 0x009048f0
00a8ac06 : MOV dword ptr [EBP + -0x4],0xffffffff
00a8ac0d : CMP dword ptr [EBP + -0x14],0x8
00a8ac11 : JC 0x00a8ac1b
00a8ac13 : MOV ECX,dword ptr [EBP + -0x28]
00a8ac16 : CALL 0x006f04e0
00a8ac1b : XOR EAX,EAX
00a8ac1d : MOV dword ptr [EBP + -0x14],0x7
00a8ac24 : MOV dword ptr [EBP + -0x18],EBX
00a8ac27 : MOV word ptr [EBP + -0x28],AX
00a8ac2b : MOV ESI,dword ptr [EBP + -0x38]
00a8ac2e : ADD dword ptr [EBP + -0x34],0x5
00a8ac32 : INC ESI
00a8ac33 : CMP ESI,0x4
00a8ac36 : MOV dword ptr [EBP + -0x38],ESI
00a8ac39 : JL 0x00a8ab30
00a8ac3f : MOV EAX,dword ptr [EBP + -0x30]
00a8ac42 : INC EAX
00a8ac43 : CMP EAX,0x5
00a8ac46 : MOV dword ptr [EBP + -0x30],EAX
00a8ac49 : JL 0x00a8ab24
00a8ac4f : MOV ECX,dword ptr [EBP + -0xc]
00a8ac52 : MOV dword ptr FS:[0x0],ECX
00a8ac59 : POP ECX
00a8ac5a : POP EDI
00a8ac5b : POP ESI
00a8ac5c : POP EBX
00a8ac5d : MOV ECX,dword ptr [EBP + -0x10]
00a8ac60 : XOR ECX,EBP
00a8ac62 : CALL 0x00633e6b
00a8ac67 : MOV ESP,EBP
00a8ac69 : POP EBP
00a8ac6a : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_005e38d0
ENTRY    : 005e38d0
BODY     : [[005e38d0, 005e3ae6]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_005e38d0(undefined4 param_1)

{
  undefined4 *puVar1;
  uint *puVar2;
  undefined1 uVar3;
  bool bVar4;
  int *in_EAX;
  int iVar5;
  uint uVar6;
  undefined2 uVar7;
  ushort uVar8;
  uint uVar9;
  uint uVar10;
  uint local_10;
  int local_c;
  uint local_8;
  uint local_4;
  
  uVar9 = 0;
  local_c = 0;
  local_8 = 0;
  local_4 = 0;
  uVar7 = 0;
  local_10 = 0;
  bVar4 = false;
  iVar5 = (**(code **)(*in_EAX + 0x38))();
  if (iVar5 == 0) goto LAB_005e3aa8;
  do {
    uVar6 = in_EAX[0xf] + uVar9 * 8;
    uVar3 = *(undefined1 *)
             (*(int *)(*(int *)(in_EAX[0xd] + 0xc) + (uVar6 + 1 >> 0xc) * 4) + (uVar6 + 1 & 0xfff));
    iVar5 = *(int *)(*(int *)(in_EAX[0xd] + 0xc) + (uVar6 >> 0xc) * 4);
    if (bVar4) {
      uVar8 = (ushort)local_10;
      if (local_10 == CONCAT11(uVar3,*(undefined1 *)(iVar5 + (uVar6 & 0xfff))) - 1)
      goto LAB_005e395d;
      uVar6 = local_8 + 1;
      if (uVar6 < local_8) {
        uVar10 = uVar6;
        if (uVar6 < local_4 >> 1) {
LAB_005e3a4a:
          FUN_0057c3a0(&local_c,uVar10);
        }
      }
      else if (local_4 <= uVar6) {
        uVar10 = (uVar6 >> 2) + uVar6;
        goto LAB_005e3a4a;
      }
      puVar1 = (undefined4 *)(local_c + -4 + uVar6 * 4);
      if (puVar1 != (undefined4 *)0x0) {
        *puVar1 = CONCAT22(uVar8,uVar7);
      }
      bVar4 = false;
      local_8 = uVar6;
    }
    else {
      uVar7 = CONCAT11(uVar3,*(undefined1 *)(iVar5 + (uVar6 & 0xfff)));
      bVar4 = true;
LAB_005e395d:
      uVar6 = in_EAX[0xf] + uVar9 * 8;
      uVar8 = CONCAT11(*(undefined1 *)
                        (*(int *)(*(int *)(in_EAX[0xd] + 0xc) + (uVar6 + 1 >> 0xc) * 4) +
                        (uVar6 + 1 & 0xfff)),
                       *(undefined1 *)
                        (*(int *)(*(int *)(in_EAX[0xd] + 0xc) + (uVar6 >> 0xc) * 4) +
                        (uVar6 & 0xfff)));
      local_10 = (uint)uVar8;
      uVar9 = uVar9 + 1;
    }
    uVar6 = (**(code **)(*in_EAX + 0x38))();
  } while (uVar9 < uVar6);
  if (!bVar4) goto LAB_005e3aa8;
  uVar9 = local_8 + 1;
  local_10 = CONCAT22(uVar8,uVar7);
  if (uVar9 < local_8) {
    uVar6 = uVar9;
    if (uVar9 < local_4 >> 1) {
LAB_005e3a86:
      FUN_0057c3a0(&local_c,uVar6);
    }
  }
  else if (local_4 <= uVar9) {
    uVar6 = (uVar9 >> 2) + uVar9;
    goto LAB_005e3a86;
  }
  puVar2 = (uint *)(local_c + -4 + uVar9 * 4);
  local_8 = uVar9;
  if (puVar2 != (uint *)0x0) {
    *puVar2 = local_10;
  }
LAB_005e3aa8:
  local_10 = local_10 & 0xffffff00;
  FUN_005df030(&local_c,0,local_8,local_10);
  FUN_005e24e0();
  FUN_00515cf0(local_c);
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
005e38d0 : SUB ESP,0x1c
005e38d3 : PUSH EBP
005e38d4 : PUSH ESI
005e38d5 : MOV ESI,EAX
005e38d7 : MOV EAX,dword ptr [ESI]
005e38d9 : MOV EDX,dword ptr [EAX + 0x38]
005e38dc : XOR EBP,EBP
005e38de : PUSH EDI
005e38df : MOV ECX,ESI
005e38e1 : MOV dword ptr [ESP + 0x1c],EBP
005e38e5 : MOV dword ptr [ESP + 0x20],EBP
005e38e9 : MOV dword ptr [ESP + 0x24],EBP
005e38ed : MOV dword ptr [ESP + 0x10],EBP
005e38f1 : MOV dword ptr [ESP + 0x18],EBP
005e38f5 : MOV byte ptr [ESP + 0xf],0x0
005e38fa : CALL EDX
005e38fc : TEST EAX,EAX
005e38fe : JBE 0x005e3aa8
005e3904 : PUSH EBX
005e3905 : MOV EAX,dword ptr [ESI + 0x3c]
005e3908 : MOV EDI,dword ptr [ESI + 0x34]
005e390b : MOV EDI,dword ptr [EDI + 0xc]
005e390e : LEA EDX,[EBP*0x8 + 0x0]
005e3915 : ADD EAX,EDX
005e3917 : LEA ECX,[EAX + 0x1]
005e391a : MOV EBX,ECX
005e391c : SHR EBX,0xc
005e391f : MOV EBX,dword ptr [EDI + EBX*0x4]
005e3922 : AND ECX,0xfff
005e3928 : MOVZX CX,byte ptr [EBX + ECX*0x1]
005e392d : MOV EBX,EAX
005e392f : SHR EBX,0xc
005e3932 : MOV EDI,dword ptr [EDI + EBX*0x4]
005e3935 : SHL CX,0x8
005e3939 : AND EAX,0xfff
005e393e : CMP byte ptr [ESP + 0x13],0x0
005e3943 : JNZ 0x005e39f2
005e3949 : MOVZX AX,byte ptr [EDI + EAX*0x1]
005e394e : OR CX,AX
005e3951 : MOVZX ECX,CX
005e3954 : MOV dword ptr [ESP + 0x14],ECX
005e3958 : MOV byte ptr [ESP + 0x13],0x1
005e395d : MOV EAX,dword ptr [ESI + 0x3c]
005e3960 : ADD EAX,EDX
005e3962 : MOV EDX,dword ptr [ESI + 0x34]
005e3965 : MOV EDX,dword ptr [EDX + 0xc]
005e3968 : LEA ECX,[EAX + 0x1]
005e396b : MOV EDI,ECX
005e396d : SHR EDI,0xc
005e3970 : MOV EDI,dword ptr [EDX + EDI*0x4]
005e3973 : AND ECX,0xfff
005e3979 : MOVZX CX,byte ptr [EDI + ECX*0x1]
005e397e : MOV EDI,EAX
005e3980 : SHR EDI,0xc
005e3983 : MOV EDX,dword ptr [EDX + EDI*0x4]
005e3986 : AND EAX,0xfff
005e398b : MOVZX AX,byte ptr [EDX + EAX*0x1]
005e3990 : SHL CX,0x8
005e3994 : OR CX,AX
005e3997 : MOVZX EBX,CX
005e399a : MOV dword ptr [ESP + 0x1c],EBX
005e399e : INC EBP
005e399f : MOV EDX,dword ptr [ESI]
005e39a1 : MOV EAX,dword ptr [EDX + 0x38]
005e39a4 : MOV ECX,ESI
005e39a6 : CALL EAX
005e39a8 : CMP EBP,EAX
005e39aa : JC 0x005e3905
005e39b0 : CMP byte ptr [ESP + 0x13],0x0
005e39b5 : JZ 0x005e3aa5
005e39bb : MOV EAX,dword ptr [ESP + 0x24]
005e39bf : MOV CX,word ptr [ESP + 0x14]
005e39c4 : LEA ESI,[EAX + 0x1]
005e39c7 : MOV word ptr [ESP + 0x1c],CX
005e39cc : MOV word ptr [ESP + 0x1e],BX
005e39d1 : CMP ESI,EAX
005e39d3 : JNC 0x005e3a73
005e39d9 : MOV EAX,dword ptr [ESP + 0x28]
005e39dd : SHR EAX,0x1
005e39df : CMP ESI,EAX
005e39e1 : JNC 0x005e3a8f
005e39e7 : PUSH ESI
005e39e8 : LEA EDX,[ESP + 0x24]
005e39ec : PUSH EDX
005e39ed : JMP 0x005e3a86
005e39f2 : MOVZX EAX,byte ptr [EDI + EAX*0x1]
005e39f6 : MOV EBX,dword ptr [ESP + 0x1c]
005e39fa : MOVZX ECX,CX
005e39fd : OR ECX,EAX
005e39ff : MOVZX EAX,BX
005e3a02 : DEC ECX
005e3a03 : CMP EAX,ECX
005e3a05 : JZ 0x005e395d
005e3a0b : MOV EAX,dword ptr [ESP + 0x24]
005e3a0f : MOV CX,word ptr [ESP + 0x14]
005e3a14 : LEA EDI,[EAX + 0x1]
005e3a17 : MOV word ptr [ESP + 0x18],CX
005e3a1c : MOV word ptr [ESP + 0x1a],BX
005e3a21 : CMP EDI,EAX
005e3a23 : JNC 0x005e3a37
005e3a25 : MOV EDX,dword ptr [ESP + 0x28]
005e3a29 : SHR EDX,0x1
005e3a2b : CMP EDI,EDX
005e3a2d : JNC 0x005e3a53
005e3a2f : PUSH EDI
005e3a30 : LEA EAX,[ESP + 0x24]
005e3a34 : PUSH EAX
005e3a35 : JMP 0x005e3a4a
005e3a37 : CMP EDI,dword ptr [ESP + 0x28]
005e3a3b : JC 0x005e3a53
005e3a3d : MOV ECX,EDI
005e3a3f : SHR ECX,0x2
005e3a42 : ADD ECX,EDI
005e3a44 : PUSH ECX
005e3a45 : LEA EDX,[ESP + 0x24]
005e3a49 : PUSH EDX
005e3a4a : LEA ECX,[ESP + 0x28]
005e3a4e : CALL 0x0057c3a0
005e3a53 : MOV EAX,dword ptr [ESP + 0x20]
005e3a57 : MOV dword ptr [ESP + 0x24],EDI
005e3a5b : LEA EDI,[EAX + EDI*0x4 + -0x4]
005e3a5f : TEST EDI,EDI
005e3a61 : JZ 0x005e3a69
005e3a63 : MOV ECX,dword ptr [ESP + 0x18]
005e3a67 : MOV dword ptr [EDI],ECX
005e3a69 : MOV byte ptr [ESP + 0x13],0x0
005e3a6e : JMP 0x005e399f
005e3a73 : CMP ESI,dword ptr [ESP + 0x28]
005e3a77 : JC 0x005e3a8f
005e3a79 : MOV EAX,ESI
005e3a7b : SHR EAX,0x2
005e3a7e : ADD EAX,ESI
005e3a80 : PUSH EAX
005e3a81 : LEA ECX,[ESP + 0x24]
005e3a85 : PUSH ECX
005e3a86 : LEA ECX,[ESP + 0x28]
005e3a8a : CALL 0x0057c3a0
005e3a8f : MOV EDX,dword ptr [ESP + 0x20]
005e3a93 : LEA EAX,[EDX + ESI*0x4 + -0x4]
005e3a97 : MOV dword ptr [ESP + 0x24],ESI
005e3a9b : TEST EAX,EAX
005e3a9d : JZ 0x005e3aa5
005e3a9f : MOV ECX,dword ptr [ESP + 0x1c]
005e3aa3 : MOV dword ptr [EAX],ECX
005e3aa5 : XOR EBP,EBP
005e3aa7 : POP EBX
005e3aa8 : MOV EAX,dword ptr [ESP + 0x20]
005e3aac : MOV byte ptr [ESP + 0x18],0x0
005e3ab1 : MOV EDX,dword ptr [ESP + 0x18]
005e3ab5 : PUSH EDX
005e3ab6 : PUSH EAX
005e3ab7 : LEA ECX,[ESP + 0x24]
005e3abb : PUSH EBP
005e3abc : PUSH ECX
005e3abd : CALL 0x005df030
005e3ac2 : MOV EDI,dword ptr [ESP + 0x3c]
005e3ac6 : ADD ESP,0x10
005e3ac9 : LEA ESI,[ESP + 0x1c]
005e3acd : MOV ECX,EDI
005e3acf : CALL 0x005e24e0
005e3ad4 : MOV EDX,dword ptr [ESP + 0x1c]
005e3ad8 : PUSH EDX
005e3ad9 : CALL 0x00515cf0
005e3ade : MOV EAX,EDI
005e3ae0 : POP EDI
005e3ae1 : POP ESI
005e3ae2 : POP EBP
005e3ae3 : ADD ESP,0x1c
005e3ae6 : RET

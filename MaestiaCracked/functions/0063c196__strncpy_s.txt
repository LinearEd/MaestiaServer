PROGRAM  : Maestia.exe
FUNCTION : _strncpy_s
ENTRY    : 0063c196
BODY     : [[0063c196, 0063c24a]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    _strncpy_s
   
   Library: Visual Studio 2008 Release */

errno_t __cdecl _strncpy_s(char *_Dst,rsize_t _SizeInBytes,char *_Src,rsize_t _MaxCount)

{
  char cVar1;
  int *piVar2;
  char *pcVar3;
  rsize_t rVar4;
  errno_t eVar5;
  
  if (_MaxCount == 0) {
    if (_Dst == (char *)0x0) {
      if (_SizeInBytes == 0) {
        return 0;
      }
    }
    else {
LAB_0063c1bc:
      if (_SizeInBytes != 0) {
        if (_MaxCount == 0) {
          *_Dst = '\0';
          return 0;
        }
        if (_Src != (char *)0x0) {
          pcVar3 = _Dst;
          rVar4 = _SizeInBytes;
          if (_MaxCount == 0xffffffff) {
            do {
              cVar1 = *_Src;
              *pcVar3 = cVar1;
              pcVar3 = pcVar3 + 1;
              _Src = _Src + 1;
              if (cVar1 == '\0') break;
              rVar4 = rVar4 - 1;
            } while (rVar4 != 0);
          }
          else {
            do {
              cVar1 = *_Src;
              *pcVar3 = cVar1;
              pcVar3 = pcVar3 + 1;
              _Src = _Src + 1;
              if ((cVar1 == '\0') || (rVar4 = rVar4 - 1, rVar4 == 0)) break;
              _MaxCount = _MaxCount - 1;
            } while (_MaxCount != 0);
            if (_MaxCount == 0) {
              *pcVar3 = '\0';
            }
          }
          if (rVar4 != 0) {
            return 0;
          }
          if (_MaxCount == 0xffffffff) {
            _Dst[_SizeInBytes - 1] = '\0';
            return 0x50;
          }
          *_Dst = '\0';
          piVar2 = __errno();
          eVar5 = 0x22;
          *piVar2 = 0x22;
          goto LAB_0063c1cd;
        }
        *_Dst = '\0';
      }
    }
  }
  else if (_Dst != (char *)0x0) goto LAB_0063c1bc;
  piVar2 = __errno();
  eVar5 = 0x16;
  *piVar2 = 0x16;
LAB_0063c1cd:
  __invalid_parameter(0,0,0,0,0);
  return eVar5;
}



============================================================
DISASSEMBLY
============================================================
0063c196 : MOV EDI,EDI
0063c198 : PUSH EBP
0063c199 : MOV EBP,ESP
0063c19b : PUSH EBX
0063c19c : PUSH ESI
0063c19d : MOV ESI,dword ptr [EBP + 0x8]
0063c1a0 : XOR EBX,EBX
0063c1a2 : PUSH EDI
0063c1a3 : CMP dword ptr [EBP + 0x14],EBX
0063c1a6 : JNZ 0x0063c1b8
0063c1a8 : CMP ESI,EBX
0063c1aa : JNZ 0x0063c1bc
0063c1ac : CMP dword ptr [EBP + 0xc],EBX
0063c1af : JNZ 0x0063c1c3
0063c1b1 : XOR EAX,EAX
0063c1b3 : POP EDI
0063c1b4 : POP ESI
0063c1b5 : POP EBX
0063c1b6 : POP EBP
0063c1b7 : RET
0063c1b8 : CMP ESI,EBX
0063c1ba : JZ 0x0063c1c3
0063c1bc : MOV EDI,dword ptr [EBP + 0xc]
0063c1bf : CMP EDI,EBX
0063c1c1 : JA 0x0063c1de
0063c1c3 : CALL 0x0063ab82
0063c1c8 : PUSH 0x16
0063c1ca : POP ESI
0063c1cb : MOV dword ptr [EAX],ESI
0063c1cd : PUSH EBX
0063c1ce : PUSH EBX
0063c1cf : PUSH EBX
0063c1d0 : PUSH EBX
0063c1d1 : PUSH EBX
0063c1d2 : CALL 0x006372b8
0063c1d7 : ADD ESP,0x14
0063c1da : MOV EAX,ESI
0063c1dc : JMP 0x0063c1b3
0063c1de : CMP dword ptr [EBP + 0x14],EBX
0063c1e1 : JNZ 0x0063c1e7
0063c1e3 : MOV byte ptr [ESI],BL
0063c1e5 : JMP 0x0063c1b1
0063c1e7 : MOV EDX,dword ptr [EBP + 0x10]
0063c1ea : CMP EDX,EBX
0063c1ec : JNZ 0x0063c1f2
0063c1ee : MOV byte ptr [ESI],BL
0063c1f0 : JMP 0x0063c1c3
0063c1f2 : CMP dword ptr [EBP + 0x14],-0x1
0063c1f6 : MOV EAX,ESI
0063c1f8 : JNZ 0x0063c209
0063c1fa : MOV CL,byte ptr [EDX]
0063c1fc : MOV byte ptr [EAX],CL
0063c1fe : INC EAX
0063c1ff : INC EDX
0063c200 : CMP CL,BL
0063c202 : JZ 0x0063c222
0063c204 : DEC EDI
0063c205 : JNZ 0x0063c1fa
0063c207 : JMP 0x0063c222
0063c209 : MOV CL,byte ptr [EDX]
0063c20b : MOV byte ptr [EAX],CL
0063c20d : INC EAX
0063c20e : INC EDX
0063c20f : CMP CL,BL
0063c211 : JZ 0x0063c21b
0063c213 : DEC EDI
0063c214 : JZ 0x0063c21b
0063c216 : DEC dword ptr [EBP + 0x14]
0063c219 : JNZ 0x0063c209
0063c21b : CMP dword ptr [EBP + 0x14],EBX
0063c21e : JNZ 0x0063c222
0063c220 : MOV byte ptr [EAX],BL
0063c222 : CMP EDI,EBX
0063c224 : JNZ 0x0063c1b1
0063c226 : CMP dword ptr [EBP + 0x14],-0x1
0063c22a : JNZ 0x0063c23b
0063c22c : MOV EAX,dword ptr [EBP + 0xc]
0063c22f : PUSH 0x50
0063c231 : MOV byte ptr [ESI + EAX*0x1 + -0x1],BL
0063c235 : POP EAX
0063c236 : JMP 0x0063c1b3
0063c23b : MOV byte ptr [ESI],BL
0063c23d : CALL 0x0063ab82
0063c242 : PUSH 0x22
0063c244 : POP ECX
0063c245 : MOV dword ptr [EAX],ECX
0063c247 : MOV ESI,ECX
0063c249 : JMP 0x0063c1cd

PROGRAM  : Maestia.exe
FUNCTION : FUN_005eb5b0
ENTRY    : 005eb5b0
BODY     : [[005eb5b0, 005eb70f]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005eb5b0(undefined4 param_1,uint *param_2,uint param_3)

{
  uint *puVar1;
  uint *puVar2;
  int *piVar3;
  int iVar4;
  uint uVar5;
  int *in_ECX;
  uint uVar6;
  int iVar7;
  
  piVar3 = (int *)*in_ECX;
  if (piVar3 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar3 * 5) <= piVar3[1] * 4 + 4U) goto LAB_005eb5ea;
    iVar7 = piVar3[1] * 2 + 2;
  }
  FUN_005eaf80(param_1,iVar7);
LAB_005eb5ea:
  piVar3 = (int *)*in_ECX;
  param_3 = param_3 & piVar3[1];
  *piVar3 = *piVar3 + 1;
  iVar7 = *in_ECX;
  iVar4 = *(int *)(iVar7 + 8 + param_3 * 0x18);
  puVar1 = (uint *)(iVar7 + 8 + param_3 * 0x18);
  if (iVar4 == -2) {
    *puVar1 = 0xffffffff;
    puVar1[2] = *param_2;
    puVar1[3] = param_2[1];
    puVar1[4] = param_2[2];
    puVar1[5] = param_2[3];
    puVar1[1] = param_3;
    return;
  }
  uVar6 = param_3;
  do {
    uVar6 = uVar6 + 1 & *(uint *)(iVar7 + 4);
  } while (*(int *)(iVar7 + 8 + uVar6 * 0x18) != -2);
  uVar5 = puVar1[1];
  piVar3 = (int *)(iVar7 + 8 + uVar6 * 0x18);
  if (uVar5 == param_3) {
    if (piVar3 != (int *)0x0) {
      *piVar3 = iVar4;
      piVar3[1] = puVar1[1];
      piVar3[2] = puVar1[2];
      piVar3[3] = puVar1[3];
      piVar3[4] = puVar1[4];
      piVar3[5] = puVar1[5];
    }
    puVar1[2] = *param_2;
    puVar1[3] = param_2[1];
    puVar1[4] = param_2[2];
    puVar1[5] = param_2[3];
    *puVar1 = uVar6;
    puVar1[1] = param_3;
    return;
  }
  puVar2 = (uint *)(iVar7 + 8 + uVar5 * 0x18);
  for (uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x18); uVar5 != param_3;
      uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x18)) {
    uVar5 = *puVar2;
    puVar2 = (uint *)(iVar7 + 8 + uVar5 * 0x18);
  }
  if (piVar3 != (int *)0x0) {
    *piVar3 = iVar4;
    piVar3[1] = puVar1[1];
    piVar3[2] = puVar1[2];
    piVar3[3] = puVar1[3];
    piVar3[4] = puVar1[4];
    piVar3[5] = puVar1[5];
  }
  *puVar2 = uVar6;
  puVar1[2] = *param_2;
  puVar1[3] = param_2[1];
  puVar1[4] = param_2[2];
  puVar1[5] = param_2[3];
  *puVar1 = 0xffffffff;
  puVar1[1] = param_3;
  return;
}



============================================================
DISASSEMBLY
============================================================
005eb5b0 : PUSH EBP
005eb5b1 : PUSH ESI
005eb5b2 : MOV ESI,ECX
005eb5b4 : MOV EAX,dword ptr [ESI]
005eb5b6 : TEST EAX,EAX
005eb5b8 : JNZ 0x005eb5c3
005eb5ba : MOV EAX,dword ptr [ESP + 0xc]
005eb5be : PUSH 0x8
005eb5c0 : PUSH EAX
005eb5c1 : JMP 0x005eb5e5
005eb5c3 : MOV ECX,dword ptr [EAX + 0x4]
005eb5c6 : LEA EDX,[ECX*0x4 + 0x4]
005eb5cd : MOV ECX,dword ptr [EAX]
005eb5cf : LEA ECX,[ECX + ECX*0x4]
005eb5d2 : CMP ECX,EDX
005eb5d4 : JBE 0x005eb5ea
005eb5d6 : MOV EDX,dword ptr [EAX + 0x4]
005eb5d9 : MOV ECX,dword ptr [ESP + 0xc]
005eb5dd : LEA EAX,[EDX + EDX*0x1 + 0x2]
005eb5e1 : PUSH EAX
005eb5e2 : PUSH ECX
005eb5e3 : MOV ECX,ESI
005eb5e5 : CALL 0x005eaf80
005eb5ea : MOV EAX,dword ptr [ESI]
005eb5ec : MOV ECX,dword ptr [ESP + 0x14]
005eb5f0 : AND ECX,dword ptr [EAX + 0x4]
005eb5f3 : INC dword ptr [EAX]
005eb5f5 : MOV ESI,dword ptr [ESI]
005eb5f7 : LEA EDX,[ECX + ECX*0x2]
005eb5fa : MOV EBP,dword ptr [ESI + EDX*0x8 + 0x8]
005eb5fe : LEA EAX,[ESI + EDX*0x8 + 0x8]
005eb602 : CMP EBP,-0x2
005eb605 : JNZ 0x005eb630
005eb607 : MOV EDX,dword ptr [ESP + 0x10]
005eb60b : MOV dword ptr [EAX],0xffffffff
005eb611 : MOV ESI,dword ptr [EDX]
005eb613 : MOV dword ptr [EAX + 0x8],ESI
005eb616 : MOV ESI,dword ptr [EDX + 0x4]
005eb619 : MOV dword ptr [EAX + 0xc],ESI
005eb61c : MOV ESI,dword ptr [EDX + 0x8]
005eb61f : MOV dword ptr [EAX + 0x10],ESI
005eb622 : MOV EDX,dword ptr [EDX + 0xc]
005eb625 : POP ESI
005eb626 : MOV dword ptr [EAX + 0x14],EDX
005eb629 : MOV dword ptr [EAX + 0x4],ECX
005eb62c : POP EBP
005eb62d : RET 0xc
005eb630 : PUSH EDI
005eb631 : MOV EDI,dword ptr [ESI + 0x4]
005eb634 : MOV EDX,ECX
005eb636 : PUSH EBX
005eb637 : INC EDX
005eb638 : AND EDX,EDI
005eb63a : LEA EBX,[EDX + EDX*0x2]
005eb63d : CMP dword ptr [ESI + EBX*0x8 + 0x8],-0x2
005eb642 : JNZ 0x005eb637
005eb644 : MOV EBX,dword ptr [EAX + 0x4]
005eb647 : LEA EDI,[EDX + EDX*0x2]
005eb64a : LEA EDI,[ESI + EDI*0x8 + 0x8]
005eb64e : CMP EBX,ECX
005eb650 : JNZ 0x005eb69d
005eb652 : TEST EDI,EDI
005eb654 : JZ 0x005eb676
005eb656 : MOV dword ptr [EDI],EBP
005eb658 : MOV ESI,dword ptr [EAX + 0x4]
005eb65b : MOV dword ptr [EDI + 0x4],ESI
005eb65e : MOV ESI,dword ptr [EAX + 0x8]
005eb661 : MOV dword ptr [EDI + 0x8],ESI
005eb664 : MOV ESI,dword ptr [EAX + 0xc]
005eb667 : MOV dword ptr [EDI + 0xc],ESI
005eb66a : MOV ESI,dword ptr [EAX + 0x10]
005eb66d : MOV dword ptr [EDI + 0x10],ESI
005eb670 : MOV ESI,dword ptr [EAX + 0x14]
005eb673 : MOV dword ptr [EDI + 0x14],ESI
005eb676 : MOV ESI,dword ptr [ESP + 0x18]
005eb67a : MOV EDI,dword ptr [ESI]
005eb67c : MOV dword ptr [EAX + 0x8],EDI
005eb67f : MOV EDI,dword ptr [ESI + 0x4]
005eb682 : MOV dword ptr [EAX + 0xc],EDI
005eb685 : MOV EDI,dword ptr [ESI + 0x8]
005eb688 : MOV dword ptr [EAX + 0x10],EDI
005eb68b : MOV ESI,dword ptr [ESI + 0xc]
005eb68e : POP EBX
005eb68f : POP EDI
005eb690 : MOV dword ptr [EAX + 0x14],ESI
005eb693 : POP ESI
005eb694 : MOV dword ptr [EAX],EDX
005eb696 : MOV dword ptr [EAX + 0x4],ECX
005eb699 : POP EBP
005eb69a : RET 0xc
005eb69d : LEA EBX,[EBX + EBX*0x2]
005eb6a0 : CMP dword ptr [ESI + EBX*0x8 + 0x8],ECX
005eb6a4 : LEA EBX,[ESI + EBX*0x8 + 0x8]
005eb6a8 : JZ 0x005eb6bf
005eb6aa : LEA EBX,[EBX]
005eb6b0 : MOV EBX,dword ptr [EBX]
005eb6b2 : LEA EBX,[EBX + EBX*0x2]
005eb6b5 : CMP dword ptr [ESI + EBX*0x8 + 0x8],ECX
005eb6b9 : LEA EBX,[ESI + EBX*0x8 + 0x8]
005eb6bd : JNZ 0x005eb6b0
005eb6bf : TEST EDI,EDI
005eb6c1 : JZ 0x005eb6e3
005eb6c3 : MOV dword ptr [EDI],EBP
005eb6c5 : MOV ESI,dword ptr [EAX + 0x4]
005eb6c8 : MOV dword ptr [EDI + 0x4],ESI
005eb6cb : MOV ESI,dword ptr [EAX + 0x8]
005eb6ce : MOV dword ptr [EDI + 0x8],ESI
005eb6d1 : MOV ESI,dword ptr [EAX + 0xc]
005eb6d4 : MOV dword ptr [EDI + 0xc],ESI
005eb6d7 : MOV ESI,dword ptr [EAX + 0x10]
005eb6da : MOV dword ptr [EDI + 0x10],ESI
005eb6dd : MOV ESI,dword ptr [EAX + 0x14]
005eb6e0 : MOV dword ptr [EDI + 0x14],ESI
005eb6e3 : MOV dword ptr [EBX],EDX
005eb6e5 : MOV EDX,dword ptr [ESP + 0x18]
005eb6e9 : MOV ESI,dword ptr [EDX]
005eb6eb : MOV dword ptr [EAX + 0x8],ESI
005eb6ee : MOV ESI,dword ptr [EDX + 0x4]
005eb6f1 : MOV dword ptr [EAX + 0xc],ESI
005eb6f4 : MOV ESI,dword ptr [EDX + 0x8]
005eb6f7 : POP EBX
005eb6f8 : MOV dword ptr [EAX + 0x10],ESI
005eb6fb : MOV EDX,dword ptr [EDX + 0xc]
005eb6fe : POP EDI
005eb6ff : POP ESI
005eb700 : MOV dword ptr [EAX + 0x14],EDX
005eb703 : MOV dword ptr [EAX],0xffffffff
005eb709 : MOV dword ptr [EAX + 0x4],ECX
005eb70c : POP EBP
005eb70d : RET 0xc

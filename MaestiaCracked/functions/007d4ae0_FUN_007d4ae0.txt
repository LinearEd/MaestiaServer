PROGRAM  : Maestia.exe
FUNCTION : FUN_007d4ae0
ENTRY    : 007d4ae0
BODY     : [[007d4ae0, 007d4b9c] [007d4ba0, 007d4c0c]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007d4ae0(undefined4 param_1)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int *piVar3;
  uint uVar4;
  int iVar5;
  int in_ECX;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b0f1ce;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(int *)(in_ECX + 8) != 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  local_8 = 0;
  puVar1 = *(undefined4 **)(in_ECX + 0x38);
  for (puVar2 = (undefined4 *)*puVar1; puVar2 != puVar1; puVar2 = (undefined4 *)*puVar2) {
    piVar3 = (int *)puVar2[9];
    iVar5 = (**(code **)(*piVar3 + 0x1c))(uVar4);
    if (iVar5 - 2U < 8) {
      (**(code **)(*piVar3 + 0x118))(param_1);
    }
  }
  local_8 = 0xffffffff;
  if (*(int *)(in_ECX + 8) != 0) {
    LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  if (*(int *)(in_ECX + 8) != 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  local_8 = 1;
  puVar1 = *(undefined4 **)(in_ECX + 0x188);
  for (puVar2 = (undefined4 *)*puVar1; puVar2 != puVar1; puVar2 = (undefined4 *)*puVar2) {
    (**(code **)(*(int *)puVar2[9] + 0x6c))(param_1);
  }
  local_8 = 0xffffffff;
  if (*(int *)(in_ECX + 8) != 0) {
    LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  if (*(int **)(in_ECX + 0x2b4) != (int *)0x0) {
    (**(code **)(**(int **)(in_ECX + 0x2b4) + 0x6c))(param_1);
  }
  if (*(int **)(in_ECX + 0x2b8) != (int *)0x0) {
    (**(code **)(**(int **)(in_ECX + 0x2b8) + 0x6c))(param_1);
  }
  *(char *)(in_ECX + 600) = (char)param_1;
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
007d4ae0 : PUSH EBP
007d4ae1 : MOV EBP,ESP
007d4ae3 : PUSH -0x1
007d4ae5 : PUSH 0xb0f1ce
007d4aea : MOV EAX,FS:[0x0]
007d4af0 : PUSH EAX
007d4af1 : SUB ESP,0x8
007d4af4 : PUSH EBX
007d4af5 : PUSH ESI
007d4af6 : PUSH EDI
007d4af7 : MOV EAX,[0x00d66fa0]
007d4afc : XOR EAX,EBP
007d4afe : PUSH EAX
007d4aff : LEA EAX,[EBP + -0xc]
007d4b02 : MOV FS:[0x0],EAX
007d4b08 : MOV EDI,ECX
007d4b0a : MOV EAX,dword ptr [EDI + 0x8]
007d4b0d : MOV dword ptr [EBP + -0x14],EDI
007d4b10 : TEST EAX,EAX
007d4b12 : JZ 0x007d4b1e
007d4b14 : ADD EAX,0x4
007d4b17 : PUSH EAX
007d4b18 : CALL dword ptr [0x00b85118]
007d4b1e : MOV dword ptr [EBP + -0x4],0x0
007d4b25 : MOV EAX,dword ptr [EDI + 0x38]
007d4b28 : MOV EBX,dword ptr [EAX]
007d4b2a : MOV dword ptr [EBP + -0x10],EAX
007d4b2d : CMP EBX,EAX
007d4b2f : JZ 0x007d4b5c
007d4b31 : MOV ESI,dword ptr [EBX + 0x24]
007d4b34 : MOV EAX,dword ptr [ESI]
007d4b36 : MOV EDX,dword ptr [EAX + 0x1c]
007d4b39 : MOV ECX,ESI
007d4b3b : CALL EDX
007d4b3d : ADD EAX,-0x2
007d4b40 : CMP EAX,0x7
007d4b43 : JA 0x007d4b55
007d4b45 : MOV ECX,dword ptr [EBP + 0x8]
007d4b48 : MOV EAX,dword ptr [ESI]
007d4b4a : MOV EDX,dword ptr [EAX + 0x118]
007d4b50 : PUSH ECX
007d4b51 : MOV ECX,ESI
007d4b53 : CALL EDX
007d4b55 : MOV EBX,dword ptr [EBX]
007d4b57 : CMP EBX,dword ptr [EBP + -0x10]
007d4b5a : JNZ 0x007d4b31
007d4b5c : MOV dword ptr [EBP + -0x4],0xffffffff
007d4b63 : MOV EAX,dword ptr [EDI + 0x8]
007d4b66 : TEST EAX,EAX
007d4b68 : JZ 0x007d4b74
007d4b6a : ADD EAX,0x4
007d4b6d : PUSH EAX
007d4b6e : CALL dword ptr [0x00b8511c]
007d4b74 : MOV EAX,dword ptr [EDI + 0x8]
007d4b77 : MOV dword ptr [EBP + -0x14],EDI
007d4b7a : TEST EAX,EAX
007d4b7c : JZ 0x007d4b88
007d4b7e : ADD EAX,0x4
007d4b81 : PUSH EAX
007d4b82 : CALL dword ptr [0x00b85118]
007d4b88 : MOV dword ptr [EBP + -0x4],0x1
007d4b8f : MOV EBX,dword ptr [EDI + 0x188]
007d4b95 : MOV ESI,dword ptr [EBX]
007d4b97 : CMP ESI,EBX
007d4b99 : JZ 0x007d4bb4
007d4b9b : JMP 0x007d4ba0
007d4ba0 : MOV ECX,dword ptr [ESI + 0x24]
007d4ba3 : MOV EAX,dword ptr [ECX]
007d4ba5 : MOV EDX,dword ptr [EBP + 0x8]
007d4ba8 : MOV EAX,dword ptr [EAX + 0x6c]
007d4bab : PUSH EDX
007d4bac : CALL EAX
007d4bae : MOV ESI,dword ptr [ESI]
007d4bb0 : CMP ESI,EBX
007d4bb2 : JNZ 0x007d4ba0
007d4bb4 : MOV dword ptr [EBP + -0x4],0xffffffff
007d4bbb : MOV EAX,dword ptr [EDI + 0x8]
007d4bbe : TEST EAX,EAX
007d4bc0 : JZ 0x007d4bcc
007d4bc2 : ADD EAX,0x4
007d4bc5 : PUSH EAX
007d4bc6 : CALL dword ptr [0x00b8511c]
007d4bcc : MOV ECX,dword ptr [EDI + 0x2b4]
007d4bd2 : MOV EBX,dword ptr [EBP + 0x8]
007d4bd5 : TEST ECX,ECX
007d4bd7 : JZ 0x007d4be1
007d4bd9 : MOV EDX,dword ptr [ECX]
007d4bdb : MOV EAX,dword ptr [EDX + 0x6c]
007d4bde : PUSH EBX
007d4bdf : CALL EAX
007d4be1 : MOV ECX,dword ptr [EDI + 0x2b8]
007d4be7 : TEST ECX,ECX
007d4be9 : JZ 0x007d4bf3
007d4beb : MOV EDX,dword ptr [ECX]
007d4bed : MOV EAX,dword ptr [EDX + 0x6c]
007d4bf0 : PUSH EBX
007d4bf1 : CALL EAX
007d4bf3 : MOV byte ptr [EDI + 0x258],BL
007d4bf9 : MOV ECX,dword ptr [EBP + -0xc]
007d4bfc : MOV dword ptr FS:[0x0],ECX
007d4c03 : POP ECX
007d4c04 : POP EDI
007d4c05 : POP ESI
007d4c06 : POP EBX
007d4c07 : MOV ESP,EBP
007d4c09 : POP EBP
007d4c0a : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_00a5e8d0
ENTRY    : 00a5e8d0
BODY     : [[00a5e8d0, 00a5eb78]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a5e8d0(int *param_1,int param_2)

{
  bool bVar1;
  char cVar2;
  int iVar3;
  undefined4 uVar4;
  int in_ECX;
  int local_450;
  int local_44c;
  int local_448;
  int local_444;
  int local_438;
  uint local_434;
  undefined1 local_430 [28];
  WCHAR local_414 [512];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b304ea;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  bVar1 = false;
  (**(code **)(*param_1 + 0x1c))();
  if (local_434 < 8) {
    wsprintfW(local_414,L"Invalid Mvd File(Invalid header size)\n%s");
    MessageBoxW((HWND)0x0,local_414,L"Mvd File Error",0x10);
                    /* WARNING: Subroutine does not return */
    ExitProcess(0);
  }
  local_434 = local_434 - 8;
  if (local_438 == -0x63d76eff) goto LAB_00a5e98c;
LAB_00a5e986:
  FUN_00a5d7a0();
LAB_00a5e98c:
  (**(code **)(*param_1 + 0x1c))();
  if (local_450 == -0x63d76eef) {
    (**(code **)(*param_1 + 0x2c))();
    local_8 = 0;
    local_434 = local_434 - local_44c;
    if ((param_2 == 0) && (cVar2 = FUN_00403810(), cVar2 != '\0')) {
      if (*(int *)(in_ECX + 4) == 0) {
        iVar3 = FUN_006f0300();
        local_8._0_1_ = 1;
        if (iVar3 == 0) {
          uVar4 = 0;
        }
        else {
          FUN_00406460();
          local_8 = CONCAT31(local_8._1_3_,2);
          bVar1 = true;
          uVar4 = FUN_00714660();
        }
        *(undefined4 *)(in_ECX + 4) = uVar4;
        local_8 = 0;
        if (bVar1) {
          bVar1 = false;
          FUN_00406560();
        }
      }
      param_2 = *(int *)(in_ECX + 4);
    }
    else {
      FUN_00405660(local_430);
      local_8 = local_8 & 0xffffff00;
      param_2 = FUN_00a5e280();
    }
    if (local_434 != 0) {
      do {
        (**(code **)(*param_1 + 0x20))();
        if (local_444 == 0) {
          wsprintfW(local_414,L"Invalid Mvd File\n%s");
          MessageBoxW((HWND)0x0,local_414,L"Mvd File Error",0x10);
                    /* WARNING: Subroutine does not return */
          ExitProcess(0);
        }
        if (local_448 == -0x63d76eff) {
          FUN_00a5e8d0();
        }
        else {
          if (local_448 != -0x63d76dff) goto LAB_00a5e986;
          *(int *)(in_ECX + 0x44) = *(int *)(in_ECX + 0x44) + 1;
          FUN_00a5e6e0();
        }
        local_434 = local_434 - local_444;
        if (local_434 == 0) break;
      } while( true );
    }
    local_8 = 0xffffffff;
    FUN_00406560();
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a5e8d0 : PUSH EBP
00a5e8d1 : MOV EBP,ESP
00a5e8d3 : PUSH -0x1
00a5e8d5 : PUSH 0xb304ea
00a5e8da : MOV EAX,FS:[0x0]
00a5e8e0 : PUSH EAX
00a5e8e1 : SUB ESP,0x45c
00a5e8e7 : MOV EAX,[0x00d66fa0]
00a5e8ec : XOR EAX,EBP
00a5e8ee : MOV dword ptr [EBP + -0x10],EAX
00a5e8f1 : PUSH EBX
00a5e8f2 : PUSH ESI
00a5e8f3 : PUSH EDI
00a5e8f4 : PUSH EAX
00a5e8f5 : LEA EAX,[EBP + -0xc]
00a5e8f8 : MOV FS:[0x0],EAX
00a5e8fe : MOV EBX,dword ptr [EBP + 0x8]
00a5e901 : MOV ESI,dword ptr [EBP + 0xc]
00a5e904 : MOV EDI,ECX
00a5e906 : MOV dword ptr [EBP + 0xfffffbc8],0x0
00a5e910 : MOV EAX,dword ptr [EBX]
00a5e912 : MOV EDX,dword ptr [EAX + 0x1c]
00a5e915 : LEA ECX,[EBP + 0xfffffbcc]
00a5e91b : PUSH ECX
00a5e91c : MOV ECX,EBX
00a5e91e : MOV dword ptr [EBP + 0xfffffbc4],ESI
00a5e924 : CALL EDX
00a5e926 : MOV EAX,0x8
00a5e92b : CMP dword ptr [EBP + 0xfffffbd0],EAX
00a5e931 : JNC 0x00a5e974
00a5e933 : CMP dword ptr [EDI + 0x20],EAX
00a5e936 : JC 0x00a5e93d
00a5e938 : MOV EDI,dword ptr [EDI + 0xc]
00a5e93b : JMP 0x00a5e940
00a5e93d : ADD EDI,0xc
00a5e940 : PUSH EDI
00a5e941 : LEA EAX,[EBP + 0xfffffbf0]
00a5e947 : PUSH 0xc00f08
00a5e94c : PUSH EAX
00a5e94d : CALL dword ptr [0x00b85434]
00a5e953 : ADD ESP,0xc
00a5e956 : PUSH 0x10
00a5e958 : PUSH 0xc00f5c
00a5e95d : LEA ECX,[EBP + 0xfffffbf0]
00a5e963 : PUSH ECX
00a5e964 : PUSH 0x0
00a5e966 : CALL dword ptr [0x00b85514]
00a5e96c : PUSH 0x0
00a5e96e : CALL dword ptr [0x00b851f4]
00a5e974 : SUB dword ptr [EBP + 0xfffffbd0],EAX
00a5e97a : CMP dword ptr [EBP + 0xfffffbcc],0x9c289101
00a5e984 : JZ 0x00a5e98c
00a5e986 : PUSH EDI
00a5e987 : CALL 0x00a5d7a0
00a5e98c : MOV EDX,dword ptr [EBX]
00a5e98e : MOV EDX,dword ptr [EDX + 0x1c]
00a5e991 : LEA EAX,[EBP + 0xfffffbb4]
00a5e997 : PUSH EAX
00a5e998 : MOV ECX,EBX
00a5e99a : CALL EDX
00a5e99c : CMP dword ptr [EBP + 0xfffffbb4],0x9c289111
00a5e9a6 : JZ 0x00a5e9af
00a5e9a8 : XOR AL,AL
00a5e9aa : JMP 0x00a5eb19
00a5e9af : MOV EAX,dword ptr [EBX]
00a5e9b1 : MOV EDX,dword ptr [EAX + 0x2c]
00a5e9b4 : LEA ECX,[EBP + 0xfffffbd4]
00a5e9ba : PUSH ECX
00a5e9bb : MOV ECX,EBX
00a5e9bd : CALL EDX
00a5e9bf : MOV dword ptr [EBP + -0x4],0x0
00a5e9c6 : MOV EAX,dword ptr [EBP + 0xfffffbb8]
00a5e9cc : SUB dword ptr [EBP + 0xfffffbd0],EAX
00a5e9d2 : TEST ESI,ESI
00a5e9d4 : JNZ 0x00a5ea7e
00a5e9da : LEA ECX,[EBP + 0xfffffbd4]
00a5e9e0 : MOV ESI,0xc00f7c
00a5e9e5 : CALL 0x00403810
00a5e9ea : TEST AL,AL
00a5e9ec : JZ 0x00a5ea78
00a5e9f2 : CMP dword ptr [EDI + 0x4],0x0
00a5e9f6 : JNZ 0x00a5ea73
00a5e9f8 : PUSH 0x80
00a5e9fd : CALL 0x006f0300
00a5ea02 : MOV ESI,EAX
00a5ea04 : ADD ESP,0x4
00a5ea07 : MOV dword ptr [EBP + 0xfffffbc4],ESI
00a5ea0d : MOV byte ptr [EBP + -0x4],0x1
00a5ea11 : TEST ESI,ESI
00a5ea13 : JZ 0x00a5ea45
00a5ea15 : PUSH 0xc00f94
00a5ea1a : LEA ECX,[EBP + 0xfffffb98]
00a5ea20 : CALL 0x00406460
00a5ea25 : MOV byte ptr [EBP + -0x4],0x2
00a5ea29 : LEA ECX,[EBP + 0xfffffb98]
00a5ea2f : PUSH ECX
00a5ea30 : PUSH 0x0
00a5ea32 : PUSH EDI
00a5ea33 : PUSH ESI
00a5ea34 : MOV dword ptr [EBP + 0xfffffbc8],0x1
00a5ea3e : CALL 0x00714660
00a5ea43 : JMP 0x00a5ea47
00a5ea45 : XOR EAX,EAX
00a5ea47 : MOV dword ptr [EBP + -0x4],0x3
00a5ea4e : MOV dword ptr [EDI + 0x4],EAX
00a5ea51 : MOV dword ptr [EBP + -0x4],0x0
00a5ea58 : TEST byte ptr [EBP + 0xfffffbc8],0x1
00a5ea5f : JZ 0x00a5ea73
00a5ea61 : AND dword ptr [EBP + 0xfffffbc8],0xfffffffe
00a5ea68 : LEA ECX,[EBP + 0xfffffb98]
00a5ea6e : CALL 0x00406560
00a5ea73 : MOV ESI,dword ptr [EDI + 0x4]
00a5ea76 : JMP 0x00a5eaa6
00a5ea78 : MOV ESI,dword ptr [EBP + 0xfffffbc4]
00a5ea7e : SUB ESP,0x1c
00a5ea81 : LEA EDX,[EBP + 0xfffffbd4]
00a5ea87 : MOV ECX,ESP
00a5ea89 : MOV dword ptr [EBP + 0xfffffbc4],ESP
00a5ea8f : PUSH EDX
00a5ea90 : CALL 0x00405660
00a5ea95 : MOV byte ptr [EBP + -0x4],0x4
00a5ea99 : MOV byte ptr [EBP + -0x4],0x0
00a5ea9d : MOV ECX,ESI
00a5ea9f : CALL 0x00a5e280
00a5eaa4 : MOV ESI,EAX
00a5eaa6 : CMP dword ptr [EBP + 0xfffffbd0],0x0
00a5eaad : JZ 0x00a5eb05
00a5eaaf : NOP
00a5eab0 : MOV EAX,dword ptr [EBX]
00a5eab2 : MOV EDX,dword ptr [EAX + 0x20]
00a5eab5 : LEA ECX,[EBP + 0xfffffbbc]
00a5eabb : PUSH ECX
00a5eabc : MOV ECX,EBX
00a5eabe : CALL EDX
00a5eac0 : CMP dword ptr [EBP + 0xfffffbc0],0x0
00a5eac7 : JZ 0x00a5eb37
00a5eac9 : MOV EAX,dword ptr [EBP + 0xfffffbbc]
00a5eacf : CMP EAX,0x9c289101
00a5ead4 : JZ 0x00a5eaee
00a5ead6 : CMP EAX,0x9c289201
00a5eadb : JNZ 0x00a5e986
00a5eae1 : INC dword ptr [EDI + 0x44]
00a5eae4 : PUSH ESI
00a5eae5 : MOV ECX,EBX
00a5eae7 : CALL 0x00a5e6e0
00a5eaec : JMP 0x00a5eaf7
00a5eaee : PUSH ESI
00a5eaef : PUSH EBX
00a5eaf0 : MOV ECX,EDI
00a5eaf2 : CALL 0x00a5e8d0
00a5eaf7 : MOV EAX,dword ptr [EBP + 0xfffffbc0]
00a5eafd : SUB dword ptr [EBP + 0xfffffbd0],EAX
00a5eb03 : JNZ 0x00a5eab0
00a5eb05 : MOV dword ptr [EBP + -0x4],0xffffffff
00a5eb0c : LEA ECX,[EBP + 0xfffffbd4]
00a5eb12 : CALL 0x00406560
00a5eb17 : MOV AL,0x1
00a5eb19 : MOV ECX,dword ptr [EBP + -0xc]
00a5eb1c : MOV dword ptr FS:[0x0],ECX
00a5eb23 : POP ECX
00a5eb24 : POP EDI
00a5eb25 : POP ESI
00a5eb26 : POP EBX
00a5eb27 : MOV ECX,dword ptr [EBP + -0x10]
00a5eb2a : XOR ECX,EBP
00a5eb2c : CALL 0x00633e6b
00a5eb31 : MOV ESP,EBP
00a5eb33 : POP EBP
00a5eb34 : RET 0x8
00a5eb37 : CMP dword ptr [EDI + 0x20],0x8
00a5eb3b : JC 0x00a5eb42
00a5eb3d : MOV EDI,dword ptr [EDI + 0xc]
00a5eb40 : JMP 0x00a5eb45
00a5eb42 : ADD EDI,0xc
00a5eb45 : PUSH EDI
00a5eb46 : LEA ECX,[EBP + 0xfffffbf0]
00a5eb4c : PUSH 0xc00fac
00a5eb51 : PUSH ECX
00a5eb52 : CALL dword ptr [0x00b85434]
00a5eb58 : ADD ESP,0xc
00a5eb5b : PUSH 0x10
00a5eb5d : PUSH 0xc00fd4
00a5eb62 : LEA EDX,[EBP + 0xfffffbf0]
00a5eb68 : PUSH EDX
00a5eb69 : PUSH 0x0
00a5eb6b : CALL dword ptr [0x00b85514]
00a5eb71 : PUSH 0x0
00a5eb73 : CALL dword ptr [0x00b851f4]

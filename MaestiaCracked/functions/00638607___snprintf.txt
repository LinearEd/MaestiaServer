PROGRAM  : Maestia.exe
FUNCTION : __snprintf
ENTRY    : 00638607
BODY     : [[00638607, 006386b5]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    __snprintf
   
   Library: Visual Studio 2008 Release */

int __cdecl __snprintf(char *_Dest,size_t _Count,char *_Format,...)

{
  int *piVar1;
  int iVar2;
  FILE local_24;
  
  if (_Format == (char *)0x0) {
    piVar1 = __errno();
    *piVar1 = 0x16;
    __invalid_parameter(0,0,0,0,0);
    iVar2 = -1;
  }
  else if ((_Count == 0) || (_Dest != (char *)0x0)) {
    local_24._cnt = 0x7fffffff;
    if (_Count < 0x80000000) {
      local_24._cnt = _Count;
    }
    local_24._flag = 0x42;
    local_24._base = _Dest;
    local_24._ptr = _Dest;
    iVar2 = __output_l(&local_24,_Format,(_locale_t)0x0,&stack0x00000010);
    if (_Dest != (char *)0x0) {
      local_24._cnt = local_24._cnt - 1;
      if (local_24._cnt < 0) {
        __flsbuf(0,&local_24);
      }
      else {
        *local_24._ptr = '\0';
      }
    }
  }
  else {
    piVar1 = __errno();
    *piVar1 = 0x16;
    __invalid_parameter(0,0,0,0,0);
    iVar2 = -1;
  }
  return iVar2;
}



============================================================
DISASSEMBLY
============================================================
00638607 : MOV EDI,EDI
00638609 : PUSH EBP
0063860a : MOV EBP,ESP
0063860c : SUB ESP,0x20
0063860f : PUSH EBX
00638610 : XOR EBX,EBX
00638612 : CMP dword ptr [EBP + 0x10],EBX
00638615 : JNZ 0x00638634
00638617 : CALL 0x0063ab82
0063861c : PUSH EBX
0063861d : PUSH EBX
0063861e : PUSH EBX
0063861f : PUSH EBX
00638620 : PUSH EBX
00638621 : MOV dword ptr [EAX],0x16
00638627 : CALL 0x006372b8
0063862c : ADD ESP,0x14
0063862f : OR EAX,0xffffffff
00638632 : JMP 0x006386b3
00638634 : MOV ECX,dword ptr [EBP + 0xc]
00638637 : PUSH ESI
00638638 : MOV ESI,dword ptr [EBP + 0x8]
0063863b : CMP ECX,EBX
0063863d : JZ 0x00638660
0063863f : CMP ESI,EBX
00638641 : JNZ 0x00638660
00638643 : CALL 0x0063ab82
00638648 : PUSH EBX
00638649 : PUSH EBX
0063864a : PUSH EBX
0063864b : PUSH EBX
0063864c : PUSH EBX
0063864d : MOV dword ptr [EAX],0x16
00638653 : CALL 0x006372b8
00638658 : ADD ESP,0x14
0063865b : OR EAX,0xffffffff
0063865e : JMP 0x006386b2
00638660 : MOV EAX,0x7fffffff
00638665 : MOV dword ptr [EBP + -0x1c],EAX
00638668 : CMP ECX,EAX
0063866a : JA 0x0063866f
0063866c : MOV dword ptr [EBP + -0x1c],ECX
0063866f : PUSH EDI
00638670 : LEA EAX,[EBP + 0x14]
00638673 : PUSH EAX
00638674 : PUSH EBX
00638675 : PUSH dword ptr [EBP + 0x10]
00638678 : LEA EAX,[EBP + -0x20]
0063867b : PUSH EAX
0063867c : MOV dword ptr [EBP + -0x14],0x42
00638683 : MOV dword ptr [EBP + -0x18],ESI
00638686 : MOV dword ptr [EBP + -0x20],ESI
00638689 : CALL 0x0064a9ad
0063868e : ADD ESP,0x10
00638691 : MOV EDI,EAX
00638693 : CMP ESI,EBX
00638695 : JZ 0x006386b1
00638697 : DEC dword ptr [EBP + -0x1c]
0063869a : JS 0x006386a3
0063869c : MOV EAX,dword ptr [EBP + -0x20]
0063869f : MOV byte ptr [EAX],BL
006386a1 : JMP 0x006386af
006386a3 : LEA EAX,[EBP + -0x20]
006386a6 : PUSH EAX
006386a7 : PUSH EBX
006386a8 : CALL 0x00645eff
006386ad : POP ECX
006386ae : POP ECX
006386af : MOV EAX,EDI
006386b1 : POP EDI
006386b2 : POP ESI
006386b3 : POP EBX
006386b4 : LEAVE
006386b5 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_007d3ed0
ENTRY    : 007d3ed0
BODY     : [[007d3ed0, 007d3fc6]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007d3ed0(undefined4 param_1)

{
  int *piVar1;
  uint uVar2;
  int *piVar3;
  int iVar4;
  int in_ECX;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b0f02d;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(int *)(in_ECX + 8) != 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  piVar3 = (int *)**(int **)(in_ECX + 0x188);
  if (piVar3 != *(int **)(in_ECX + 0x188)) {
    do {
      *(undefined4 *)(piVar3[9] + 4) = param_1;
      piVar3 = (int *)*piVar3;
    } while (piVar3 != (int *)*(int *)(in_ECX + 0x188));
  }
  local_8 = 0xffffffff;
  if (*(int *)(in_ECX + 8) != 0) {
    LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  if (*(int *)(in_ECX + 8) != 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  local_8 = 1;
  piVar3 = (int *)**(int **)(in_ECX + 0x38);
  if (piVar3 != *(int **)(in_ECX + 0x38)) {
    do {
      piVar1 = (int *)piVar3[9];
      iVar4 = (**(code **)(*piVar1 + 0x1c))(uVar2);
      if (iVar4 - 2U < 8) {
        (**(code **)(*piVar1 + 0xe4))(param_1);
      }
      piVar3 = (int *)*piVar3;
    } while (piVar3 != (int *)*(int *)(in_ECX + 0x38));
  }
  local_8 = 0xffffffff;
  if (*(int *)(in_ECX + 8) != 0) {
    LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
007d3ed0 : PUSH EBP
007d3ed1 : MOV EBP,ESP
007d3ed3 : PUSH -0x1
007d3ed5 : PUSH 0xb0f02d
007d3eda : MOV EAX,FS:[0x0]
007d3ee0 : PUSH EAX
007d3ee1 : PUSH ECX
007d3ee2 : PUSH EBX
007d3ee3 : PUSH ESI
007d3ee4 : PUSH EDI
007d3ee5 : MOV EAX,[0x00d66fa0]
007d3eea : XOR EAX,EBP
007d3eec : PUSH EAX
007d3eed : LEA EAX,[EBP + -0xc]
007d3ef0 : MOV FS:[0x0],EAX
007d3ef6 : MOV ESI,ECX
007d3ef8 : MOV EAX,dword ptr [ESI + 0x8]
007d3efb : MOV EDI,dword ptr [0x00b85118]
007d3f01 : MOV dword ptr [EBP + -0x10],ESI
007d3f04 : TEST EAX,EAX
007d3f06 : JZ 0x007d3f0e
007d3f08 : ADD EAX,0x4
007d3f0b : PUSH EAX
007d3f0c : CALL EDI
007d3f0e : MOV dword ptr [EBP + -0x4],0x0
007d3f15 : MOV ECX,dword ptr [ESI + 0x188]
007d3f1b : MOV EAX,dword ptr [ECX]
007d3f1d : CMP EAX,ECX
007d3f1f : JZ 0x007d3f34
007d3f21 : MOV ECX,dword ptr [EAX + 0x24]
007d3f24 : MOV EDX,dword ptr [EBP + 0x8]
007d3f27 : MOV dword ptr [ECX + 0x4],EDX
007d3f2a : MOV EAX,dword ptr [EAX]
007d3f2c : CMP EAX,dword ptr [ESI + 0x188]
007d3f32 : JNZ 0x007d3f21
007d3f34 : MOV dword ptr [EBP + -0x4],0xffffffff
007d3f3b : MOV EAX,dword ptr [ESI + 0x8]
007d3f3e : TEST EAX,EAX
007d3f40 : JZ 0x007d3f4c
007d3f42 : ADD EAX,0x4
007d3f45 : PUSH EAX
007d3f46 : CALL dword ptr [0x00b8511c]
007d3f4c : MOV EAX,dword ptr [ESI + 0x8]
007d3f4f : MOV dword ptr [EBP + -0x10],ESI
007d3f52 : TEST EAX,EAX
007d3f54 : JZ 0x007d3f5c
007d3f56 : ADD EAX,0x4
007d3f59 : PUSH EAX
007d3f5a : CALL EDI
007d3f5c : MOV dword ptr [EBP + -0x4],0x1
007d3f63 : MOV EAX,dword ptr [ESI + 0x38]
007d3f66 : MOV EBX,dword ptr [EAX]
007d3f68 : CMP EBX,EAX
007d3f6a : JZ 0x007d3f9b
007d3f6c : LEA ESP,[ESP]
007d3f70 : MOV EDI,dword ptr [EBX + 0x24]
007d3f73 : MOV EAX,dword ptr [EDI]
007d3f75 : MOV EDX,dword ptr [EAX + 0x1c]
007d3f78 : MOV ECX,EDI
007d3f7a : CALL EDX
007d3f7c : ADD EAX,-0x2
007d3f7f : CMP EAX,0x7
007d3f82 : JA 0x007d3f94
007d3f84 : MOV ECX,dword ptr [EBP + 0x8]
007d3f87 : MOV EAX,dword ptr [EDI]
007d3f89 : MOV EDX,dword ptr [EAX + 0xe4]
007d3f8f : PUSH ECX
007d3f90 : MOV ECX,EDI
007d3f92 : CALL EDX
007d3f94 : MOV EBX,dword ptr [EBX]
007d3f96 : CMP EBX,dword ptr [ESI + 0x38]
007d3f99 : JNZ 0x007d3f70
007d3f9b : MOV dword ptr [EBP + -0x4],0xffffffff
007d3fa2 : MOV ESI,dword ptr [ESI + 0x8]
007d3fa5 : TEST ESI,ESI
007d3fa7 : JZ 0x007d3fb3
007d3fa9 : ADD ESI,0x4
007d3fac : PUSH ESI
007d3fad : CALL dword ptr [0x00b8511c]
007d3fb3 : MOV ECX,dword ptr [EBP + -0xc]
007d3fb6 : MOV dword ptr FS:[0x0],ECX
007d3fbd : POP ECX
007d3fbe : POP EDI
007d3fbf : POP ESI
007d3fc0 : POP EBX
007d3fc1 : MOV ESP,EBP
007d3fc3 : POP EBP
007d3fc4 : RET 0x4

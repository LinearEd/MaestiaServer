PROGRAM  : Maestia.exe
FUNCTION : FUN_0081c5e0
ENTRY    : 0081c5e0
BODY     : [[0081c5e0, 0081c779]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0081c5e0(undefined4 param_1,wchar_t *param_2)

{
  char cVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  void **ppvVar4;
  undefined4 *puVar5;
  uint uVar6;
  wchar_t *_Str;
  wchar_t *pwVar7;
  undefined4 *puVar8;
  wchar_t *pwVar9;
  undefined4 in_stack_00000018;
  uint in_stack_0000001c;
  undefined4 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  puStack_c = &LAB_00b122af;
  uVar6 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_8._1_3_ = 0;
  puVar2 = *(undefined4 **)(DAT_0172491c + 0x324);
  puVar8 = (undefined4 *)*puVar2;
  local_14 = uVar6;
  ppvVar4 = &local_10;
  local_10 = ExceptionList;
  do {
    ExceptionList = ppvVar4;
    if (puVar8 == puVar2) {
      local_8 = 0xffffffff;
      if (7 < in_stack_0000001c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0(uVar6);
      }
LAB_0081c712:
      param_2 = (wchar_t *)((uint)param_2 & 0xffff0000);
      local_8 = 0xffffffff;
      in_stack_0000001c = 7;
      in_stack_00000018 = 0;
      ExceptionList = local_10;
      __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
      return;
    }
    local_8._0_1_ = 0;
    local_2c = (wchar_t *)((uint)local_2c & 0xffff0000);
    local_18 = 7;
    local_1c = 0;
    FUN_00405eb0(puVar8 + 10,0,0xffffffff);
    local_8._0_1_ = 1;
    pwVar9 = local_2c;
    if (local_18 < 8) {
      pwVar9 = (wchar_t *)&local_2c;
    }
    pwVar7 = param_2;
    if (in_stack_0000001c < 8) {
      pwVar7 = (wchar_t *)&param_2;
    }
    _Str = local_2c;
    if (local_18 < 8) {
      _Str = (wchar_t *)&local_2c;
    }
    pwVar7 = _wcsstr(_Str,pwVar7);
    if (pwVar9 == pwVar7) {
      local_8 = (uint)local_8._1_3_ << 8;
      if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0(uVar6);
      }
      local_18 = 7;
      local_1c = 0;
      local_2c = (wchar_t *)((uint)local_2c._2_2_ << 0x10);
      local_8 = 0xffffffff;
      if (7 < in_stack_0000001c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0(uVar6);
      }
      goto LAB_0081c712;
    }
    if (*(char *)((int)puVar8 + 0x45) == '\0') {
      puVar3 = (undefined4 *)puVar8[2];
      if (*(char *)((int)puVar3 + 0x45) == '\0') {
        cVar1 = *(char *)((int)*puVar3 + 0x45);
        puVar8 = puVar3;
        puVar3 = (undefined4 *)*puVar3;
        while (cVar1 == '\0') {
          cVar1 = *(char *)((int)*puVar3 + 0x45);
          puVar8 = puVar3;
          puVar3 = (undefined4 *)*puVar3;
        }
      }
      else {
        cVar1 = *(char *)((int)puVar8[1] + 0x45);
        puVar5 = (undefined4 *)puVar8[1];
        puVar3 = puVar8;
        while ((puVar8 = puVar5, cVar1 == '\0' && (puVar3 == (undefined4 *)puVar8[2]))) {
          cVar1 = *(char *)((int)puVar8[1] + 0x45);
          puVar5 = (undefined4 *)puVar8[1];
          puVar3 = puVar8;
        }
      }
    }
    local_8._0_1_ = 0;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0(uVar6);
    }
    local_18 = 7;
    local_1c = 0;
    local_2c = (wchar_t *)((uint)local_2c._2_2_ << 0x10);
    ppvVar4 = ExceptionList;
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
0081c5e0 : PUSH EBP
0081c5e1 : MOV EBP,ESP
0081c5e3 : PUSH -0x1
0081c5e5 : PUSH 0xb122af
0081c5ea : MOV EAX,FS:[0x0]
0081c5f0 : PUSH EAX
0081c5f1 : SUB ESP,0x24
0081c5f4 : MOV EAX,[0x00d66fa0]
0081c5f9 : XOR EAX,EBP
0081c5fb : MOV dword ptr [EBP + -0x10],EAX
0081c5fe : PUSH EBX
0081c5ff : PUSH ESI
0081c600 : PUSH EDI
0081c601 : PUSH EAX
0081c602 : LEA EAX,[EBP + -0xc]
0081c605 : MOV FS:[0x0],EAX
0081c60b : XOR EBX,EBX
0081c60d : MOV dword ptr [EBP + -0x4],EBX
0081c610 : MOV EAX,[0x0172491c]
0081c615 : MOV EAX,dword ptr [EAX + 0x324]
0081c61b : MOV ESI,dword ptr [EAX]
0081c61d : MOV dword ptr [EBP + -0x30],EAX
0081c620 : CMP ESI,EAX
0081c622 : JZ 0x0081c6ee
0081c628 : PUSH -0x1
0081c62a : XOR ECX,ECX
0081c62c : LEA EAX,[ESI + 0x28]
0081c62f : PUSH EBX
0081c630 : MOV word ptr [EBP + -0x28],CX
0081c634 : PUSH EAX
0081c635 : LEA ECX,[EBP + -0x2c]
0081c638 : MOV dword ptr [EBP + -0x14],0x7
0081c63f : MOV dword ptr [EBP + -0x18],EBX
0081c642 : CALL 0x00405eb0
0081c647 : MOV byte ptr [EBP + -0x4],0x1
0081c64b : MOV EAX,dword ptr [EBP + -0x14]
0081c64e : MOV EDX,dword ptr [EBP + -0x28]
0081c651 : MOV EDI,EDX
0081c653 : CMP EAX,0x8
0081c656 : JNC 0x0081c65b
0081c658 : LEA EDI,[EBP + -0x28]
0081c65b : CMP dword ptr [EBP + 0x20],0x8
0081c65f : MOV ECX,dword ptr [EBP + 0xc]
0081c662 : JNC 0x0081c667
0081c664 : LEA ECX,[EBP + 0xc]
0081c667 : CMP EAX,0x8
0081c66a : MOV EAX,EDX
0081c66c : JNC 0x0081c671
0081c66e : LEA EAX,[EBP + -0x28]
0081c671 : PUSH ECX
0081c672 : PUSH EAX
0081c673 : CALL 0x006347ba
0081c678 : ADD ESP,0x8
0081c67b : CMP EDI,EAX
0081c67d : JZ 0x0081c733
0081c683 : CMP byte ptr [ESI + 0x45],BL
0081c686 : JNZ 0x0081c6c4
0081c688 : MOV EAX,dword ptr [ESI + 0x8]
0081c68b : CMP byte ptr [EAX + 0x45],BL
0081c68e : JNZ 0x0081c6ab
0081c690 : MOV ESI,EAX
0081c692 : MOV EAX,dword ptr [ESI]
0081c694 : CMP byte ptr [EAX + 0x45],BL
0081c697 : JNZ 0x0081c6c4
0081c699 : LEA ESP,[ESP]
0081c6a0 : MOV ESI,EAX
0081c6a2 : MOV EAX,dword ptr [ESI]
0081c6a4 : CMP byte ptr [EAX + 0x45],BL
0081c6a7 : JZ 0x0081c6a0
0081c6a9 : JMP 0x0081c6c4
0081c6ab : MOV EAX,dword ptr [ESI + 0x4]
0081c6ae : CMP byte ptr [EAX + 0x45],BL
0081c6b1 : JNZ 0x0081c6c2
0081c6b3 : CMP ESI,dword ptr [EAX + 0x8]
0081c6b6 : JNZ 0x0081c6c2
0081c6b8 : MOV ESI,EAX
0081c6ba : MOV EAX,dword ptr [EAX + 0x4]
0081c6bd : CMP byte ptr [EAX + 0x45],BL
0081c6c0 : JZ 0x0081c6b3
0081c6c2 : MOV ESI,EAX
0081c6c4 : MOV byte ptr [EBP + -0x4],BL
0081c6c7 : CMP dword ptr [EBP + -0x14],0x8
0081c6cb : JC 0x0081c6d5
0081c6cd : MOV ECX,dword ptr [EBP + -0x28]
0081c6d0 : CALL 0x006f04e0
0081c6d5 : XOR EDX,EDX
0081c6d7 : MOV dword ptr [EBP + -0x14],0x7
0081c6de : MOV dword ptr [EBP + -0x18],EBX
0081c6e1 : MOV word ptr [EBP + -0x28],DX
0081c6e5 : CMP ESI,dword ptr [EBP + -0x30]
0081c6e8 : JNZ 0x0081c628
0081c6ee : MOV dword ptr [EBP + -0x4],0xffffffff
0081c6f5 : CMP dword ptr [EBP + 0x20],0x8
0081c6f9 : JC 0x0081c703
0081c6fb : MOV ECX,dword ptr [EBP + 0xc]
0081c6fe : CALL 0x006f04e0
0081c703 : XOR EDX,EDX
0081c705 : MOV dword ptr [EBP + 0x20],0x7
0081c70c : MOV word ptr [EBP + 0xc],DX
0081c710 : MOV AL,0x1
0081c712 : MOV dword ptr [EBP + 0x1c],EBX
0081c715 : MOV ECX,dword ptr [EBP + -0xc]
0081c718 : MOV dword ptr FS:[0x0],ECX
0081c71f : POP ECX
0081c720 : POP EDI
0081c721 : POP ESI
0081c722 : POP EBX
0081c723 : MOV ECX,dword ptr [EBP + -0x10]
0081c726 : XOR ECX,EBP
0081c728 : CALL 0x00633e6b
0081c72d : MOV ESP,EBP
0081c72f : POP EBP
0081c730 : RET 0x1c
0081c733 : MOV byte ptr [EBP + -0x4],BL
0081c736 : MOV ESI,0x8
0081c73b : CMP dword ptr [EBP + -0x14],ESI
0081c73e : JC 0x0081c748
0081c740 : MOV ECX,dword ptr [EBP + -0x28]
0081c743 : CALL 0x006f04e0
0081c748 : MOV EDI,0x7
0081c74d : XOR EAX,EAX
0081c74f : MOV dword ptr [EBP + -0x14],EDI
0081c752 : MOV dword ptr [EBP + -0x18],EBX
0081c755 : MOV word ptr [EBP + -0x28],AX
0081c759 : MOV dword ptr [EBP + -0x4],0xffffffff
0081c760 : CMP dword ptr [EBP + 0x20],ESI
0081c763 : JC 0x0081c76d
0081c765 : MOV ECX,dword ptr [EBP + 0xc]
0081c768 : CALL 0x006f04e0
0081c76d : XOR ECX,ECX
0081c76f : MOV dword ptr [EBP + 0x20],EDI
0081c772 : MOV word ptr [EBP + 0xc],CX
0081c776 : XOR AL,AL
0081c778 : JMP 0x0081c712

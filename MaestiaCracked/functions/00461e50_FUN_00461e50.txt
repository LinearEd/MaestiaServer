PROGRAM  : Maestia.exe
FUNCTION : FUN_00461e50
ENTRY    : 00461e50
BODY     : [[00461e50, 00461f03]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x00461e92) */

undefined4 * FUN_00461e50(void)

{
  uint uVar1;
  uint uVar2;
  int in_EAX;
  int in_ECX;
  ushort *puVar3;
  ushort *puVar4;
  uint uVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  undefined4 *local_c;
  
  local_c = *(undefined4 **)(in_EAX + 4);
  if (*(char *)((int)local_c[1] + 0x45) == '\0') {
    uVar1 = *(uint *)(in_ECX + 0x14);
    puVar6 = (undefined4 *)local_c[1];
    do {
      puVar3 = (ushort *)(in_ECX + 4);
      if (7 < *(uint *)(in_ECX + 0x18)) {
        puVar3 = *(ushort **)(in_ECX + 4);
      }
      uVar2 = puVar6[8];
      uVar5 = uVar2;
      if (uVar1 <= uVar2) {
        uVar5 = uVar1;
      }
      if ((uint)puVar6[9] < 8) {
        puVar4 = (ushort *)(puVar6 + 4);
      }
      else {
        puVar4 = (ushort *)puVar6[4];
      }
      for (; uVar5 != 0; uVar5 = uVar5 - 1) {
        if (*puVar4 != *puVar3) {
          uVar5 = (-(uint)(*puVar4 < *puVar3) & 0xfffffffe) + 1;
          if (uVar5 != 0) goto LAB_00461ed1;
          break;
        }
        puVar4 = puVar4 + 1;
        puVar3 = puVar3 + 1;
      }
      if (uVar2 < uVar1) {
LAB_00461ed5:
        puVar7 = (undefined4 *)puVar6[2];
      }
      else {
        uVar5 = (uint)(uVar2 != uVar1);
LAB_00461ed1:
        if ((int)uVar5 < 0) goto LAB_00461ed5;
        puVar7 = (undefined4 *)*puVar6;
        local_c = puVar6;
      }
      puVar6 = puVar7;
    } while (*(char *)((int)puVar7 + 0x45) == '\0');
  }
  return local_c;
}



============================================================
DISASSEMBLY
============================================================
00461e50 : PUSH EBP
00461e51 : MOV EBP,ESP
00461e53 : SUB ESP,0x10
00461e56 : MOV EAX,dword ptr [EAX + 0x4]
00461e59 : PUSH EDI
00461e5a : MOV EDI,dword ptr [EAX + 0x4]
00461e5d : CMP byte ptr [EDI + 0x45],0x0
00461e61 : MOV dword ptr [EBP + -0x8],EAX
00461e64 : JNZ 0x00461eff
00461e6a : MOV EAX,dword ptr [ECX + 0x14]
00461e6d : MOV EDX,dword ptr [ECX + 0x18]
00461e70 : PUSH EBX
00461e71 : ADD ECX,0x4
00461e74 : PUSH ESI
00461e75 : MOV dword ptr [EBP + -0x4],EAX
00461e78 : MOV dword ptr [EBP + -0x10],EDX
00461e7b : MOV dword ptr [EBP + -0xc],ECX
00461e7e : JMP 0x00461e83
00461e80 : MOV ECX,dword ptr [EBP + -0xc]
00461e83 : CMP dword ptr [EBP + -0x10],0x8
00461e87 : JC 0x00461e8b
00461e89 : MOV ECX,dword ptr [ECX]
00461e8b : MOV EBX,dword ptr [EDI + 0x20]
00461e8e : MOV EDX,EBX
00461e90 : CMP EDX,EBX
00461e92 : CMOVC EBX,EDX
00461e95 : MOV ESI,EBX
00461e97 : CMP EBX,EAX
00461e99 : JC 0x00461e9d
00461e9b : MOV ESI,EAX
00461e9d : CMP dword ptr [EDI + 0x24],0x8
00461ea1 : JC 0x00461ea8
00461ea3 : MOV EDX,dword ptr [EDI + 0x10]
00461ea6 : JMP 0x00461eab
00461ea8 : LEA EDX,[EDI + 0x10]
00461eab : TEST ESI,ESI
00461ead : JBE 0x00461ec6
00461eaf : NOP
00461eb0 : MOV AX,word ptr [EDX]
00461eb3 : CMP AX,word ptr [ECX]
00461eb6 : JNZ 0x00461eda
00461eb8 : ADD EDX,0x2
00461ebb : ADD ECX,0x2
00461ebe : SUB ESI,0x1
00461ec1 : JNZ 0x00461eb0
00461ec3 : MOV EAX,dword ptr [EBP + -0x4]
00461ec6 : CMP EBX,EAX
00461ec8 : JC 0x00461ed5
00461eca : XOR ECX,ECX
00461ecc : CMP EBX,EAX
00461ece : SETNZ CL
00461ed1 : TEST ECX,ECX
00461ed3 : JGE 0x00461eef
00461ed5 : MOV EDI,dword ptr [EDI + 0x8]
00461ed8 : JMP 0x00461ef4
00461eda : MOV DX,AX
00461edd : CMP DX,word ptr [ECX]
00461ee0 : SBB ECX,ECX
00461ee2 : AND ECX,0xfffffffe
00461ee5 : ADD ECX,0x1
00461ee8 : JZ 0x00461ec3
00461eea : MOV EAX,dword ptr [EBP + -0x4]
00461eed : JMP 0x00461ed1
00461eef : MOV dword ptr [EBP + -0x8],EDI
00461ef2 : MOV EDI,dword ptr [EDI]
00461ef4 : CMP byte ptr [EDI + 0x45],0x0
00461ef8 : JZ 0x00461e80
00461efa : MOV EAX,dword ptr [EBP + -0x8]
00461efd : POP ESI
00461efe : POP EBX
00461eff : POP EDI
00461f00 : MOV ESP,EBP
00461f02 : POP EBP
00461f03 : RET

PROGRAM  : Maestia.exe
FUNCTION : doexit
ENTRY    : 00635847
BODY     : [[00635847, 0063595d] [0063596d, 00635972]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __SEH_prolog4 replaced with injection: SEH_prolog4 */
/* WARNING: Function: __SEH_epilog4 replaced with injection: EH_epilog3 */
/* WARNING: Removing unreachable block (ram,0x00635964) */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* Library Function - Single Match
    _doexit
   
   Library: Visual Studio 2008 Release */

void __cdecl doexit(int param_1,int param_2,int param_3)

{
  int *piVar1;
  int *piVar2;
  int iVar3;
  code *pcVar4;
  int *piVar5;
  int *piVar6;
  int *local_2c;
  int *local_24;
  int *local_20;
  
  __lock(8);
  if (DAT_00d7b7c0 != 1) {
    _DAT_00d7b7bc = 1;
    DAT_00d7b7b8 = (undefined1)param_3;
    if (param_2 == 0) {
      piVar1 = (int *)__decode_pointer(DAT_01729d70);
      if (piVar1 != (int *)0x0) {
        piVar2 = (int *)__decode_pointer(DAT_01729d6c);
        local_2c = piVar1;
        local_24 = piVar2;
        local_20 = piVar1;
        while (piVar2 = piVar2 + -1, piVar1 <= piVar2) {
          iVar3 = __encoded_null();
          if (*piVar2 != iVar3) {
            if (piVar2 < piVar1) break;
            pcVar4 = (code *)__decode_pointer(*piVar2);
            iVar3 = __encoded_null();
            *piVar2 = iVar3;
            (*pcVar4)();
            piVar5 = (int *)__decode_pointer(DAT_01729d70);
            piVar6 = (int *)__decode_pointer(DAT_01729d6c);
            if ((local_20 != piVar5) || (piVar1 = local_2c, local_24 != piVar6)) {
              piVar2 = piVar6;
              piVar1 = piVar5;
              local_2c = piVar5;
              local_24 = piVar6;
              local_20 = piVar5;
            }
          }
        }
      }
      __initterm(&DAT_00b85d08);
    }
    __initterm(&DAT_00b85d10);
  }
  FUN_0063595e();
  if (param_3 == 0) {
    DAT_00d7b7c0 = 1;
    FUN_0064c4be(8);
    ___crtExitProcess(param_1);
    return;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00635847 : PUSH 0x18
00635849 : PUSH 0xceca58
0063584e : CALL 0x0064c228
00635853 : PUSH 0x8
00635855 : CALL 0x0064c598
0063585a : POP ECX
0063585b : AND dword ptr [EBP + -0x4],0x0
0063585f : XOR EBX,EBX
00635861 : INC EBX
00635862 : CMP dword ptr [0x00d7b7c0],EBX
00635868 : JZ 0x00635933
0063586e : MOV dword ptr [0x00d7b7bc],EBX
00635874 : MOV AL,byte ptr [EBP + 0x10]
00635877 : MOV [0x00d7b7b8],AL
0063587c : CMP dword ptr [EBP + 0xc],0x0
00635880 : JNZ 0x00635923
00635886 : PUSH dword ptr [0x01729d70]
0063588c : CALL 0x0064566d
00635891 : POP ECX
00635892 : MOV EDI,EAX
00635894 : MOV dword ptr [EBP + -0x28],EDI
00635897 : TEST EDI,EDI
00635899 : JZ 0x00635913
0063589b : PUSH dword ptr [0x01729d6c]
006358a1 : CALL 0x0064566d
006358a6 : POP ECX
006358a7 : MOV ESI,EAX
006358a9 : MOV dword ptr [EBP + -0x24],ESI
006358ac : MOV dword ptr [EBP + -0x1c],EDI
006358af : MOV dword ptr [EBP + -0x20],ESI
006358b2 : SUB ESI,0x4
006358b5 : MOV dword ptr [EBP + -0x24],ESI
006358b8 : CMP ESI,EDI
006358ba : JC 0x00635913
006358bc : CALL 0x00645664
006358c1 : CMP dword ptr [ESI],EAX
006358c3 : JZ 0x006358b2
006358c5 : CMP ESI,EDI
006358c7 : JC 0x00635913
006358c9 : PUSH dword ptr [ESI]
006358cb : CALL 0x0064566d
006358d0 : MOV EDI,EAX
006358d2 : CALL 0x00645664
006358d7 : MOV dword ptr [ESI],EAX
006358d9 : CALL EDI
006358db : PUSH dword ptr [0x01729d70]
006358e1 : CALL 0x0064566d
006358e6 : MOV EDI,EAX
006358e8 : PUSH dword ptr [0x01729d6c]
006358ee : CALL 0x0064566d
006358f3 : ADD ESP,0xc
006358f6 : CMP dword ptr [EBP + -0x1c],EDI
006358f9 : JNZ 0x00635900
006358fb : CMP dword ptr [EBP + -0x20],EAX
006358fe : JZ 0x0063590e
00635900 : MOV dword ptr [EBP + -0x1c],EDI
00635903 : MOV dword ptr [EBP + -0x28],EDI
00635906 : MOV dword ptr [EBP + -0x20],EAX
00635909 : MOV ESI,EAX
0063590b : MOV dword ptr [EBP + -0x24],ESI
0063590e : MOV EDI,dword ptr [EBP + -0x28]
00635911 : JMP 0x006358b2
00635913 : PUSH 0xb85d08
00635918 : MOV EAX,0xb85cfc
0063591d : CALL 0x00635781
00635922 : POP ECX
00635923 : PUSH 0xb85d10
00635928 : MOV EAX,0xb85d0c
0063592d : CALL 0x00635781
00635932 : POP ECX
00635933 : MOV dword ptr [EBP + -0x4],0xfffffffe
0063593a : CALL 0x0063595e
0063593f : CMP dword ptr [EBP + 0x10],0x0
00635943 : JNZ 0x0063596d
00635945 : MOV dword ptr [0x00d7b7c0],EBX
0063594b : PUSH 0x8
0063594d : CALL 0x0064c4be
00635952 : POP ECX
00635953 : PUSH dword ptr [EBP + 0x8]
00635956 : CALL 0x00635757
0063595b : XOR EBX,EBX
0063595d : INC EBX
0063596d : CALL 0x0064c26d
00635972 : RET

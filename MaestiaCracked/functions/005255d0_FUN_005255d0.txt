PROGRAM  : Maestia.exe
FUNCTION : FUN_005255d0
ENTRY    : 005255d0
BODY     : [[005255d0, 00525736]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_005255d0(void *param_1,size_t param_2,void *param_3,undefined4 *param_4)

{
  uint uVar1;
  int *piVar2;
  undefined4 *puVar3;
  int *_Dst;
  int iVar4;
  int *in_ECX;
  int *local_c;
  uint local_8;
  uint local_4;
  
  uVar1 = param_2 + (int)param_4;
  if (uVar1 < 0xc) {
    if (in_ECX[4] == 0) {
      FUN_00524e00();
    }
    piVar2 = (int *)in_ECX[4];
    _Dst = (int *)0x0;
    if (piVar2 != (int *)0x0) {
      in_ECX[4] = *piVar2;
      _Dst = piVar2;
    }
  }
  else {
    _Dst = (int *)FUN_00515840(uVar1 + 1,0);
  }
  if (_Dst != (int *)0x0) {
    if (param_2 != 0) {
      _memcpy(_Dst,param_1,param_2);
    }
    if (param_4 != (undefined4 *)0x0) {
      _memcpy((void *)((int)_Dst + param_2),param_3,(size_t)param_4);
    }
    *(undefined1 *)((int)_Dst + uVar1) = 0;
    local_c = _Dst;
    local_8 = FUN_0051b370(_Dst,uVar1,0x1505);
    local_8 = local_8 & 0xffffff;
    local_4 = uVar1;
    if ((*in_ECX != 0) &&
       (iVar4 = FUN_005250b0(&local_c,*(uint *)(*in_ECX + 4) & local_8), -1 < iVar4)) {
      puVar3 = *(undefined4 **)(*in_ECX + 0xc + iVar4 * 8);
      if (uVar1 < 0xc) {
        *_Dst = in_ECX[4];
        in_ECX[4] = (int)_Dst;
        return puVar3;
      }
      FUN_00515cf0(_Dst);
      return puVar3;
    }
    if (in_ECX[2] == 0) {
      FUN_00524d60();
    }
    puVar3 = (undefined4 *)in_ECX[2];
    param_4 = puVar3;
    if (puVar3 != (undefined4 *)0x0) {
      in_ECX[2] = puVar3[1];
      puVar3[2] = 0;
      puVar3[4] = uVar1;
      *puVar3 = _Dst;
      puVar3[3] = local_8;
      puVar3[1] = 0;
      FUN_00524fb0(in_ECX,&param_4,puVar3[3]);
      return puVar3;
    }
    if (uVar1 < 0xc) {
      *_Dst = in_ECX[4];
      in_ECX[4] = (int)_Dst;
      return (undefined4 *)in_ECX[6];
    }
    FUN_00515cf0(_Dst);
  }
  return (undefined4 *)in_ECX[6];
}



============================================================
DISASSEMBLY
============================================================
005255d0 : MOV EAX,dword ptr [ESP + 0x10]
005255d4 : SUB ESP,0xc
005255d7 : PUSH EBX
005255d8 : PUSH EBP
005255d9 : PUSH ESI
005255da : PUSH EDI
005255db : MOV EDI,dword ptr [ESP + 0x24]
005255df : LEA EBP,[EDI + EAX*0x1]
005255e2 : MOV ESI,ECX
005255e4 : CMP EBP,0xc
005255e7 : JNC 0x00525604
005255e9 : CMP dword ptr [ESI + 0x10],0x0
005255ed : JNZ 0x005255f4
005255ef : CALL 0x00524e00
005255f4 : MOV EAX,dword ptr [ESI + 0x10]
005255f7 : XOR EBX,EBX
005255f9 : TEST EAX,EAX
005255fb : JZ 0x00525614
005255fd : MOV ECX,dword ptr [EAX]
005255ff : MOV dword ptr [ESI + 0x10],ECX
00525602 : JMP 0x00525612
00525604 : MOV ECX,dword ptr [ESI + 0x4]
00525607 : PUSH 0x0
00525609 : LEA EDX,[EBP + 0x1]
0052560c : PUSH EDX
0052560d : CALL 0x00515840
00525612 : MOV EBX,EAX
00525614 : TEST EBX,EBX
00525616 : JZ 0x0052572a
0052561c : TEST EDI,EDI
0052561e : JBE 0x0052562f
00525620 : MOV EAX,dword ptr [ESP + 0x20]
00525624 : PUSH EDI
00525625 : PUSH EAX
00525626 : PUSH EBX
00525627 : CALL 0x0063ae40
0052562c : ADD ESP,0xc
0052562f : MOV EAX,dword ptr [ESP + 0x2c]
00525633 : TEST EAX,EAX
00525635 : JBE 0x00525649
00525637 : MOV ECX,dword ptr [ESP + 0x28]
0052563b : PUSH EAX
0052563c : PUSH ECX
0052563d : LEA EDX,[EBX + EDI*0x1]
00525640 : PUSH EDX
00525641 : CALL 0x0063ae40
00525646 : ADD ESP,0xc
00525649 : PUSH 0x1505
0052564e : PUSH EBP
0052564f : PUSH EBX
00525650 : MOV byte ptr [EBX + EBP*0x1],0x0
00525654 : MOV dword ptr [ESP + 0x1c],EBX
00525658 : CALL 0x0051b370
0052565d : MOV ECX,dword ptr [ESI]
0052565f : AND EAX,0xffffff
00525664 : MOV dword ptr [ESP + 0x14],EAX
00525668 : MOV dword ptr [ESP + 0x18],EBP
0052566c : TEST ECX,ECX
0052566e : JZ 0x005256b7
00525670 : MOV ECX,dword ptr [ECX + 0x4]
00525673 : AND ECX,EAX
00525675 : PUSH ECX
00525676 : LEA EAX,[ESP + 0x14]
0052567a : PUSH EAX
0052567b : MOV ECX,ESI
0052567d : CALL 0x005250b0
00525682 : TEST EAX,EAX
00525684 : JL 0x005256b7
00525686 : MOV ECX,dword ptr [ESI]
00525688 : MOV EDI,dword ptr [ECX + EAX*0x8 + 0xc]
0052568c : CMP EBP,0xc
0052568f : JNC 0x005256a5
00525691 : MOV EDX,dword ptr [ESI + 0x10]
00525694 : MOV dword ptr [EBX],EDX
00525696 : MOV EAX,EDI
00525698 : POP EDI
00525699 : MOV dword ptr [ESI + 0x10],EBX
0052569c : POP ESI
0052569d : POP EBP
0052569e : POP EBX
0052569f : ADD ESP,0xc
005256a2 : RET 0x10
005256a5 : PUSH EBX
005256a6 : CALL 0x00515cf0
005256ab : MOV EAX,EDI
005256ad : POP EDI
005256ae : POP ESI
005256af : POP EBP
005256b0 : POP EBX
005256b1 : ADD ESP,0xc
005256b4 : RET 0x10
005256b7 : CMP dword ptr [ESI + 0x8],0x0
005256bb : JNZ 0x005256c4
005256bd : MOV ECX,ESI
005256bf : CALL 0x00524d60
005256c4 : MOV EDI,dword ptr [ESI + 0x8]
005256c7 : XOR EAX,EAX
005256c9 : CMP EDI,EAX
005256cb : JZ 0x005256d3
005256cd : MOV ECX,dword ptr [EDI + 0x4]
005256d0 : MOV dword ptr [ESI + 0x8],ECX
005256d3 : MOV dword ptr [ESP + 0x2c],EDI
005256d7 : CMP EDI,EAX
005256d9 : JZ 0x0052570a
005256db : MOV EDX,dword ptr [ESP + 0x14]
005256df : MOV dword ptr [EDI + 0x8],EAX
005256e2 : MOV dword ptr [EDI + 0x10],EBP
005256e5 : MOV dword ptr [EDI],EBX
005256e7 : MOV dword ptr [EDI + 0xc],EDX
005256ea : MOV dword ptr [EDI + 0x4],EAX
005256ed : MOV EAX,dword ptr [EDI + 0xc]
005256f0 : PUSH EAX
005256f1 : LEA ECX,[ESP + 0x30]
005256f5 : PUSH ECX
005256f6 : PUSH ESI
005256f7 : MOV ECX,ESI
005256f9 : CALL 0x00524fb0
005256fe : MOV EAX,EDI
00525700 : POP EDI
00525701 : POP ESI
00525702 : POP EBP
00525703 : POP EBX
00525704 : ADD ESP,0xc
00525707 : RET 0x10
0052570a : CMP EBP,0xc
0052570d : JNC 0x00525724
0052570f : MOV EDX,dword ptr [ESI + 0x10]
00525712 : MOV dword ptr [EBX],EDX
00525714 : MOV EAX,dword ptr [ESI + 0x18]
00525717 : POP EDI
00525718 : MOV dword ptr [ESI + 0x10],EBX
0052571b : POP ESI
0052571c : POP EBP
0052571d : POP EBX
0052571e : ADD ESP,0xc
00525721 : RET 0x10
00525724 : PUSH EBX
00525725 : CALL 0x00515cf0
0052572a : MOV EAX,dword ptr [ESI + 0x18]
0052572d : POP EDI
0052572e : POP ESI
0052572f : POP EBP
00525730 : POP EBX
00525731 : ADD ESP,0xc
00525734 : RET 0x10

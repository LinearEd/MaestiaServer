PROGRAM  : Maestia.exe
FUNCTION : FUN_006b6fe0
ENTRY    : 006b6fe0
BODY     : [[006b6fe0, 006b7029] [006b7030, 006b70fc]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_006b6fe0(void)

{
  uint uVar1;
  uint *in_EAX;
  uint uVar2;
  int iVar3;
  int iVar4;
  int *unaff_ESI;
  uint local_8;
  
  uVar1 = *in_EAX;
  if (*(char *)(*unaff_ESI + 0x2b4) == '\0') {
    local_8 = 1;
    uVar2 = 0;
    if (uVar1 != 0) {
      do {
        uVar2 = unaff_ESI[7];
        if ((int)uVar2 < 2) {
          unaff_ESI[3] = 0x81;
          return uVar2;
        }
        iVar4 = unaff_ESI[6];
        iVar3 = uVar2 - 2;
        unaff_ESI[7] = iVar3;
        if (*(uint *)(iVar4 + 4 + iVar3 * 4) < (uint)unaff_ESI[0x5f]) {
          uVar2 = *(uint *)(iVar4 + iVar3 * 4) >> 4 & 0xf;
          if ((char)unaff_ESI[0x5c] == 't') {
            uVar2 = uVar2 + 0x10;
          }
          else if ((char)unaff_ESI[0x5c] == 'u') {
            uVar2 = uVar2 + 0x20;
          }
          iVar4 = unaff_ESI[0x53];
          iVar3 = FUN_006b40d0();
          if (iVar3 == uVar2 + (int)(short)iVar4) {
            (*(code *)unaff_ESI[0x96])();
          }
        }
        else if (*(char *)((int)unaff_ESI + 0x231) != '\0') {
          unaff_ESI[3] = 0x86;
          return iVar4 + iVar3 * 4;
        }
        uVar2 = local_8 + 1;
        local_8 = uVar2;
      } while (uVar2 <= uVar1);
    }
    unaff_ESI[8] = unaff_ESI[7];
    return uVar2;
  }
  uVar2 = uVar1 * 2;
  if (unaff_ESI[7] < (int)(uVar1 * 2)) {
    unaff_ESI[3] = 0x81;
    return uVar2;
  }
  iVar4 = unaff_ESI[7] + uVar1 * -2;
  unaff_ESI[7] = iVar4;
  unaff_ESI[8] = iVar4;
  return uVar2;
}



============================================================
DISASSEMBLY
============================================================
006b6fe0 : MOV ECX,dword ptr [ESI]
006b6fe2 : MOV EAX,dword ptr [EAX]
006b6fe4 : SUB ESP,0x8
006b6fe7 : CMP byte ptr [ECX + 0x2b4],0x0
006b6fee : JZ 0x006b7010
006b6ff0 : MOV ECX,dword ptr [ESI + 0x1c]
006b6ff3 : ADD EAX,EAX
006b6ff5 : CMP ECX,EAX
006b6ff7 : JGE 0x006b7004
006b6ff9 : MOV dword ptr [ESI + 0xc],0x81
006b7000 : ADD ESP,0x8
006b7003 : RET
006b7004 : SUB ECX,EAX
006b7006 : MOV dword ptr [ESI + 0x1c],ECX
006b7009 : MOV dword ptr [ESI + 0x20],ECX
006b700c : ADD ESP,0x8
006b700f : RET
006b7010 : PUSH EBX
006b7011 : PUSH EBP
006b7012 : PUSH EDI
006b7013 : MOV dword ptr [ESP + 0x10],EAX
006b7017 : MOV dword ptr [ESP + 0xc],0x1
006b701f : CMP EAX,0x1
006b7022 : JC 0x006b70e2
006b7028 : JMP 0x006b7030
006b7030 : MOV EAX,dword ptr [ESI + 0x1c]
006b7033 : CMP EAX,0x2
006b7036 : JL 0x006b70ef
006b703c : MOV EDX,dword ptr [ESI + 0x18]
006b703f : ADD EAX,-0x2
006b7042 : MOV dword ptr [ESI + 0x1c],EAX
006b7045 : MOV EBP,dword ptr [EDX + EAX*0x4 + 0x4]
006b7049 : MOV EBX,dword ptr [EDX + EAX*0x4]
006b704c : LEA EAX,[EDX + EAX*0x4]
006b704f : CMP EBP,dword ptr [ESI + 0x17c]
006b7055 : JC 0x006b706e
006b7057 : CMP byte ptr [ESI + 0x231],0x0
006b705e : JZ 0x006b70cf
006b7060 : POP EDI
006b7061 : POP EBP
006b7062 : MOV dword ptr [ESI + 0xc],0x86
006b7069 : POP EBX
006b706a : ADD ESP,0x8
006b706d : RET
006b706e : MOVZX EAX,byte ptr [ESI + 0x170]
006b7075 : MOV EDI,EBX
006b7077 : SHR EDI,0x4
006b707a : AND EDI,0xf
006b707d : SUB EAX,0x74
006b7080 : JZ 0x006b708c
006b7082 : SUB EAX,0x1
006b7085 : JNZ 0x006b708f
006b7087 : ADD EDI,0x20
006b708a : JMP 0x006b708f
006b708c : ADD EDI,0x10
006b708f : MOVSX EAX,word ptr [ESI + 0x14c]
006b7096 : ADD EDI,EAX
006b7098 : MOV EAX,ESI
006b709a : CALL 0x006b40d0
006b709f : CMP EAX,EDI
006b70a1 : JNZ 0x006b70cf
006b70a3 : AND EBX,0xf
006b70a6 : SUB EBX,0x8
006b70a9 : MOV EAX,EBX
006b70ab : JS 0x006b70ae
006b70ad : INC EAX
006b70ae : MOV CL,byte ptr [ESI + 0x14e]
006b70b4 : MOV EDI,0x1
006b70b9 : SHL EDI,CL
006b70bb : SHL EAX,0x6
006b70be : CDQ
006b70bf : IDIV EDI
006b70c1 : MOV ECX,dword ptr [ESI + 0x258]
006b70c7 : PUSH EAX
006b70c8 : PUSH EBP
006b70c9 : PUSH ESI
006b70ca : CALL ECX
006b70cc : ADD ESP,0xc
006b70cf : MOV EAX,dword ptr [ESP + 0xc]
006b70d3 : INC EAX
006b70d4 : MOV dword ptr [ESP + 0xc],EAX
006b70d8 : CMP EAX,dword ptr [ESP + 0x10]
006b70dc : JBE 0x006b7030
006b70e2 : MOV EDX,dword ptr [ESI + 0x1c]
006b70e5 : POP EDI
006b70e6 : POP EBP
006b70e7 : MOV dword ptr [ESI + 0x20],EDX
006b70ea : POP EBX
006b70eb : ADD ESP,0x8
006b70ee : RET
006b70ef : POP EDI
006b70f0 : POP EBP
006b70f1 : MOV dword ptr [ESI + 0xc],0x81
006b70f8 : POP EBX
006b70f9 : ADD ESP,0x8
006b70fc : RET

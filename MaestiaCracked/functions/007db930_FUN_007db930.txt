PROGRAM  : Maestia.exe
FUNCTION : FUN_007db930
ENTRY    : 007db930
BODY     : [[007db930, 007db9d9] [007db9e0, 007dba06] [007dba10, 007dbac2]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007db930(undefined4 param_1)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  int *in_ECX;
  int *piVar6;
  uint uVar7;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4d6cf;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(char *)((int)in_ECX + 0x2be) == '\0') {
    if (in_ECX[2] != 0) {
      EnterCriticalSection((LPCRITICAL_SECTION)(in_ECX[2] + 4));
    }
    local_8 = 0;
    piVar6 = in_ECX + 0xad;
    local_14 = 2;
    do {
      if ((*piVar6 != 0) && (iVar5 = (**(code **)(*(int *)*piVar6 + 4))(uVar4), iVar5 == 0x15)) {
        FUN_0076d230();
      }
      piVar6 = piVar6 + 1;
      local_14 = local_14 + -1;
    } while (local_14 != 0);
    if (in_ECX[99] != 0) {
      puVar1 = (undefined4 *)in_ECX[0x62];
      for (puVar2 = (undefined4 *)*puVar1; puVar2 != puVar1; puVar2 = (undefined4 *)*puVar2) {
        iVar5 = (**(code **)(*(int *)puVar2[9] + 4))();
        if (iVar5 == 2) {
          iVar5 = puVar2[9];
          uVar4 = (uint)*(ushort *)(iVar5 + 0x1e4);
          uVar7 = 0;
          if (uVar4 != 0) {
            do {
              iVar3 = *(int *)(*(int *)(iVar5 + 0x1d8) + (uVar7 & 0xffff) * 4);
              if (iVar3 != 0) {
                FUN_0078ebb0();
                FUN_0078f8c0(iVar3);
                FUN_0078eb40();
                FUN_0078ead0();
                FUN_0078ea60();
              }
              uVar7 = uVar7 + 1;
            } while ((int)uVar7 < (int)uVar4);
          }
        }
      }
    }
    iVar5 = (**(code **)(*in_ECX + 0x44))();
    if (iVar5 != 0) {
      puVar1 = (undefined4 *)in_ECX[0xe];
      for (puVar2 = (undefined4 *)*puVar1; puVar2 != puVar1; puVar2 = (undefined4 *)*puVar2) {
        if (((int *)puVar2[9] != (int *)0x0) &&
           (iVar5 = (**(code **)(*(int *)puVar2[9] + 0x1c))(), iVar5 == 2)) {
          FUN_007db930(param_1);
        }
      }
    }
    local_8 = 0xffffffff;
    if (in_ECX[2] != 0) {
      LeaveCriticalSection((LPCRITICAL_SECTION)(in_ECX[2] + 4));
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
007db930 : PUSH EBP
007db931 : MOV EBP,ESP
007db933 : PUSH -0x1
007db935 : PUSH 0xb4d6cf
007db93a : MOV EAX,FS:[0x0]
007db940 : PUSH EAX
007db941 : SUB ESP,0x18
007db944 : PUSH EBX
007db945 : PUSH ESI
007db946 : PUSH EDI
007db947 : MOV EAX,[0x00d66fa0]
007db94c : XOR EAX,EBP
007db94e : PUSH EAX
007db94f : LEA EAX,[EBP + -0xc]
007db952 : MOV FS:[0x0],EAX
007db958 : MOV EBX,ECX
007db95a : MOV dword ptr [EBP + -0x14],EBX
007db95d : MOV AL,byte ptr [EBX + 0x2be]
007db963 : TEST AL,AL
007db965 : JNZ 0x007dbaaf
007db96b : MOV EAX,dword ptr [EBX + 0x8]
007db96e : MOV dword ptr [EBP + -0x20],EBX
007db971 : TEST EAX,EAX
007db973 : JZ 0x007db97f
007db975 : ADD EAX,0x4
007db978 : PUSH EAX
007db979 : CALL dword ptr [0x00b85118]
007db97f : MOV dword ptr [EBP + -0x4],0x0
007db986 : LEA ESI,[EBX + 0x2b4]
007db98c : MOV dword ptr [EBP + -0x10],0x2
007db993 : CMP dword ptr [ESI],0x0
007db996 : JZ 0x007db9b0
007db998 : MOV ECX,dword ptr [ESI]
007db99a : MOV EAX,dword ptr [ECX]
007db99c : MOV EDX,dword ptr [EAX + 0x4]
007db99f : CALL EDX
007db9a1 : CMP EAX,0x15
007db9a4 : JNZ 0x007db9b0
007db9a6 : MOV EDI,dword ptr [ESI]
007db9a8 : MOV EDX,dword ptr [EBP + 0x8]
007db9ab : CALL 0x0076d230
007db9b0 : ADD ESI,0x4
007db9b3 : SUB dword ptr [EBP + -0x10],0x1
007db9b7 : JNZ 0x007db993
007db9b9 : CMP dword ptr [EBX + 0x18c],0x0
007db9c0 : JBE 0x007dba55
007db9c6 : MOV EAX,dword ptr [EBX + 0x188]
007db9cc : MOV ESI,dword ptr [EAX]
007db9ce : MOV dword ptr [EBP + -0x1c],EAX
007db9d1 : MOV dword ptr [EBP + -0x10],ESI
007db9d4 : CMP ESI,EAX
007db9d6 : JZ 0x007dba55
007db9d8 : JMP 0x007db9e3
007db9e0 : MOV ESI,dword ptr [EBP + -0x10]
007db9e3 : MOV ECX,dword ptr [ESI + 0x24]
007db9e6 : MOV EAX,dword ptr [ECX]
007db9e8 : MOV EDX,dword ptr [EAX + 0x4]
007db9eb : CALL EDX
007db9ed : CMP EAX,0x2
007db9f0 : JNZ 0x007dba4b
007db9f2 : MOV EBX,dword ptr [ESI + 0x24]
007db9f5 : MOVZX EAX,word ptr [EBX + 0x1e4]
007db9fc : XOR EDI,EDI
007db9fe : MOV dword ptr [EBP + -0x18],EAX
007dba01 : TEST EAX,EAX
007dba03 : JLE 0x007dba48
007dba05 : JMP 0x007dba10
007dba10 : MOV EDX,dword ptr [EBX + 0x1d8]
007dba16 : MOVZX ECX,DI
007dba19 : MOV ESI,dword ptr [EDX + ECX*0x4]
007dba1c : TEST ESI,ESI
007dba1e : JZ 0x007dba40
007dba20 : CALL 0x0078ebb0
007dba25 : MOV ECX,dword ptr [EBP + 0x8]
007dba28 : PUSH ESI
007dba29 : CALL 0x0078f8c0
007dba2e : CALL 0x0078eb40
007dba33 : CALL 0x0078ead0
007dba38 : CALL 0x0078ea60
007dba3d : MOV EAX,dword ptr [EBP + -0x18]
007dba40 : INC EDI
007dba41 : CMP EDI,EAX
007dba43 : JL 0x007dba10
007dba45 : MOV ESI,dword ptr [EBP + -0x10]
007dba48 : MOV EBX,dword ptr [EBP + -0x14]
007dba4b : MOV ESI,dword ptr [ESI]
007dba4d : MOV dword ptr [EBP + -0x10],ESI
007dba50 : CMP ESI,dword ptr [EBP + -0x1c]
007dba53 : JNZ 0x007db9e0
007dba55 : MOV EAX,dword ptr [EBX]
007dba57 : MOV EDX,dword ptr [EAX + 0x44]
007dba5a : MOV ECX,EBX
007dba5c : CALL EDX
007dba5e : TEST EAX,EAX
007dba60 : JZ 0x007dba97
007dba62 : MOV EAX,dword ptr [EBX + 0x38]
007dba65 : MOV EDI,dword ptr [EAX]
007dba67 : MOV dword ptr [EBP + -0x1c],EAX
007dba6a : CMP EDI,EAX
007dba6c : JZ 0x007dba97
007dba6e : MOV EDI,EDI
007dba70 : MOV ESI,dword ptr [EDI + 0x24]
007dba73 : TEST ESI,ESI
007dba75 : JZ 0x007dba90
007dba77 : MOV EAX,dword ptr [ESI]
007dba79 : MOV EDX,dword ptr [EAX + 0x1c]
007dba7c : MOV ECX,ESI
007dba7e : CALL EDX
007dba80 : CMP EAX,0x2
007dba83 : JNZ 0x007dba90
007dba85 : MOV EAX,dword ptr [EBP + 0x8]
007dba88 : PUSH EAX
007dba89 : MOV ECX,ESI
007dba8b : CALL 0x007db930
007dba90 : MOV EDI,dword ptr [EDI]
007dba92 : CMP EDI,dword ptr [EBP + -0x1c]
007dba95 : JNZ 0x007dba70
007dba97 : MOV dword ptr [EBP + -0x4],0xffffffff
007dba9e : MOV EBX,dword ptr [EBX + 0x8]
007dbaa1 : TEST EBX,EBX
007dbaa3 : JZ 0x007dbaaf
007dbaa5 : ADD EBX,0x4
007dbaa8 : PUSH EBX
007dbaa9 : CALL dword ptr [0x00b8511c]
007dbaaf : MOV ECX,dword ptr [EBP + -0xc]
007dbab2 : MOV dword ptr FS:[0x0],ECX
007dbab9 : POP ECX
007dbaba : POP EDI
007dbabb : POP ESI
007dbabc : POP EBX
007dbabd : MOV ESP,EBP
007dbabf : POP EBP
007dbac0 : RET 0x4

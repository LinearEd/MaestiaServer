PROGRAM  : Maestia.exe
FUNCTION : FUN_00960f80
ENTRY    : 00960f80
BODY     : [[00960f80, 00961348]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00960f80(int param_1,undefined4 param_2)

{
  short sVar1;
  wchar_t wVar2;
  uint uVar3;
  undefined1 uVar4;
  short ****ppppsVar5;
  int iVar6;
  undefined4 uVar7;
  wchar_t *pwVar8;
  wchar_t *pwVar9;
  wchar_t *pwVar10;
  short ****ppppsVar11;
  bool bVar12;
  undefined1 local_84 [4];
  int local_80;
  int local_7c;
  undefined4 local_78;
  int *local_74;
  undefined1 local_70 [4];
  undefined2 local_6c;
  undefined4 local_5c;
  uint local_58;
  undefined1 local_54 [4];
  undefined2 local_50;
  undefined4 local_40;
  uint local_3c;
  short ***local_34 [4];
  undefined4 local_24;
  uint local_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  int local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b40509;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)local_84;
  ExceptionList = &local_14;
  FUN_00403dd0(param_2,DAT_00d66fa0 ^ (uint)&stack0xffffff70);
  local_c = 0;
  local_58 = 7;
  local_5c = 0;
  local_6c = 0;
  FUN_00406360(&DAT_00c79a8c,1);
  local_c._0_1_ = 1;
  ppppsVar11 = (short ****)local_34[0];
  if (local_20 < 8) {
    ppppsVar11 = local_34;
  }
  local_3c = 7;
  local_40 = 0;
  local_50 = 0;
  ppppsVar5 = ppppsVar11;
  do {
    sVar1 = *(short *)ppppsVar5;
    ppppsVar5 = (short ****)((int)ppppsVar5 + 2);
  } while (sVar1 != 0);
  FUN_00406360(ppppsVar11,(int)ppppsVar5 - (int)((int)ppppsVar11 + 2) >> 1);
  local_c._0_1_ = 2;
  FUN_0070cd60(local_84,local_54,local_70,0);
  local_c = CONCAT31(local_c._1_3_,4);
  if (7 < local_3c) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_3c = 7;
  local_40 = 0;
  local_50 = 0;
  local_c._0_1_ = 5;
  uVar4 = (undefined1)local_c;
  local_c._0_1_ = 5;
  if (7 < local_58) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_6c = 0;
  local_58 = 7;
  uVar3 = *(uint *)(param_1 + 0x18);
  local_5c = 0;
  pwVar8 = (wchar_t *)(param_1 + 4);
  pwVar10 = pwVar8;
  if (7 < uVar3) {
    pwVar10 = *(wchar_t **)pwVar8;
  }
  pwVar9 = L"OnInit";
  do {
    wVar2 = *pwVar10;
    bVar12 = (ushort)wVar2 < (ushort)*pwVar9;
    if (wVar2 != *pwVar9) {
LAB_009610f6:
      iVar6 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
      goto LAB_009610fb;
    }
    if (wVar2 == L'\0') break;
    wVar2 = pwVar10[1];
    bVar12 = (ushort)wVar2 < (ushort)pwVar9[1];
    if (wVar2 != pwVar9[1]) goto LAB_009610f6;
    pwVar10 = pwVar10 + 2;
    pwVar9 = pwVar9 + 2;
  } while (wVar2 != L'\0');
  iVar6 = 0;
LAB_009610fb:
  if (iVar6 != 0) {
    pwVar10 = pwVar8;
    if (7 < uVar3) {
      pwVar10 = *(wchar_t **)pwVar8;
    }
    pwVar9 = L"Select";
    do {
      wVar2 = *pwVar10;
      bVar12 = (ushort)wVar2 < (ushort)*pwVar9;
      if (wVar2 != *pwVar9) {
LAB_00961139:
        iVar6 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
        goto LAB_0096113e;
      }
      if (wVar2 == L'\0') break;
      wVar2 = pwVar10[1];
      bVar12 = (ushort)wVar2 < (ushort)pwVar9[1];
      if (wVar2 != pwVar9[1]) goto LAB_00961139;
      pwVar10 = pwVar10 + 2;
      pwVar9 = pwVar9 + 2;
    } while (wVar2 != L'\0');
    iVar6 = 0;
LAB_0096113e:
    if (iVar6 == 0) {
      iVar6 = local_7c - local_80 >> 0x1f;
      if ((local_7c - local_80) / 0x1c + iVar6 == iVar6) {
LAB_009611c6:
        local_c = (uint)local_c._1_3_ << 8;
        FUN_004042c0();
        local_c = 0xffffffff;
        FUN_00406560();
        goto LAB_00961326;
      }
      if (*(uint *)(local_80 + 0x18) < 8) {
        iVar6 = local_80 + 4;
      }
      else {
        iVar6 = *(int *)(local_80 + 4);
      }
      iVar6 = FUN_00634f4d(iVar6);
      if (iVar6 == -1) {
        iVar6 = *DAT_00da9894;
        if ((iVar6 != 0) && (*(int *)(iVar6 + 0x114) != 0)) {
          (**(code **)**(undefined4 **)(iVar6 + 0x114))("NpcTalkSelectClearTxtButton");
        }
        if (*(int *)(DAT_0172490c + 8) != 2) {
          if (*(int *)(DAT_0172490c + 8) != 0) {
            FUN_008444f0();
          }
          goto LAB_009611c6;
        }
      }
      if (*(uint *)(local_80 + 0x18) < 8) {
        iVar6 = local_80 + 4;
      }
      else {
        iVar6 = *(int *)(local_80 + 4);
      }
      uVar7 = FUN_00634f4d(iVar6);
      (**(code **)(*local_74 + 0x4c))(uVar7);
    }
    else {
      pwVar10 = pwVar8;
      if (7 < uVar3) {
        pwVar10 = *(wchar_t **)pwVar8;
      }
      pwVar9 = L"Skip";
      do {
        wVar2 = *pwVar10;
        bVar12 = (ushort)wVar2 < (ushort)*pwVar9;
        if (wVar2 != *pwVar9) {
LAB_00961256:
          iVar6 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
          goto LAB_0096125b;
        }
        if (wVar2 == L'\0') break;
        wVar2 = pwVar10[1];
        bVar12 = (ushort)wVar2 < (ushort)pwVar9[1];
        if (wVar2 != pwVar9[1]) goto LAB_00961256;
        pwVar10 = pwVar10 + 2;
        pwVar9 = pwVar9 + 2;
      } while (wVar2 != L'\0');
      iVar6 = 0;
LAB_0096125b:
      if (iVar6 != 0) {
        if (7 < uVar3) {
          pwVar8 = *(wchar_t **)pwVar8;
        }
        pwVar10 = L"BeautyShopOpen";
        do {
          wVar2 = *pwVar8;
          bVar12 = (ushort)wVar2 < (ushort)*pwVar10;
          if (wVar2 != *pwVar10) {
LAB_00961296:
            iVar6 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
            goto LAB_0096129b;
          }
          if (wVar2 == L'\0') break;
          wVar2 = pwVar8[1];
          bVar12 = (ushort)wVar2 < (ushort)pwVar10[1];
          if (wVar2 != pwVar10[1]) goto LAB_00961296;
          pwVar8 = pwVar8 + 2;
          pwVar10 = pwVar10 + 2;
        } while (wVar2 != L'\0');
        iVar6 = 0;
LAB_0096129b:
        if ((iVar6 == 0) && (*(int *)(*DAT_00da9894 + 0x288) != 0)) {
          local_c._0_1_ = uVar4;
          (**(code **)(**(int **)(*DAT_00da9894 + 0x288) + 0x18))(1,300);
        }
      }
    }
  }
  local_c = (uint)local_c._1_3_ << 8;
  if (local_80 != 0) {
    FUN_00405450(local_74);
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_80 = 0;
  local_7c = 0;
  local_78 = 0;
  local_c = 0xffffffff;
  if (7 < local_20) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_20 = 7;
  local_24 = 0;
  local_34[0] = (short ***)((uint)local_34[0] & 0xffff0000);
LAB_00961326:
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)local_84);
  return;
}



============================================================
DISASSEMBLY
============================================================
00960f80 : PUSH EBP
00960f81 : MOV EBP,ESP
00960f83 : AND ESP,0xfffffff8
00960f86 : PUSH -0x1
00960f88 : PUSH 0xb40509
00960f8d : MOV EAX,FS:[0x0]
00960f93 : PUSH EAX
00960f94 : SUB ESP,0x70
00960f97 : MOV EAX,[0x00d66fa0]
00960f9c : XOR EAX,ESP
00960f9e : MOV dword ptr [ESP + 0x68],EAX
00960fa2 : PUSH EBX
00960fa3 : PUSH ESI
00960fa4 : PUSH EDI
00960fa5 : MOV EAX,[0x00d66fa0]
00960faa : XOR EAX,ESP
00960fac : PUSH EAX
00960fad : LEA EAX,[ESP + 0x80]
00960fb4 : MOV FS:[0x0],EAX
00960fba : MOV EAX,dword ptr [EBP + 0xc]
00960fbd : PUSH EAX
00960fbe : LEA ESI,[ESP + 0x60]
00960fc2 : MOV dword ptr [ESP + 0x24],ECX
00960fc6 : CALL 0x00403dd0
00960fcb : ADD ESP,0x4
00960fce : XOR EBX,EBX
00960fd0 : MOV dword ptr [ESP + 0x88],EBX
00960fd7 : PUSH 0x1
00960fd9 : XOR EAX,EAX
00960fdb : MOV EDI,0x7
00960fe0 : PUSH 0xc79a8c
00960fe5 : LEA ECX,[ESP + 0x2c]
00960fe9 : MOV dword ptr [ESP + 0x44],EDI
00960fed : MOV dword ptr [ESP + 0x40],EBX
00960ff1 : MOV word ptr [ESP + 0x30],AX
00960ff6 : CALL 0x00406360
00960ffb : MOV byte ptr [ESP + 0x88],0x1
00961003 : CMP dword ptr [ESP + 0x74],0x8
00961008 : MOV EDX,dword ptr [ESP + 0x60]
0096100c : JNC 0x00961012
0096100e : LEA EDX,[ESP + 0x60]
00961012 : XOR ECX,ECX
00961014 : MOV EAX,EDX
00961016 : MOV dword ptr [ESP + 0x58],EDI
0096101a : MOV dword ptr [ESP + 0x54],EBX
0096101e : MOV word ptr [ESP + 0x44],CX
00961023 : LEA ESI,[EAX + 0x2]
00961026 : MOV CX,word ptr [EAX]
00961029 : ADD EAX,0x2
0096102c : CMP CX,BX
0096102f : JNZ 0x00961026
00961031 : SUB EAX,ESI
00961033 : SAR EAX,0x1
00961035 : PUSH EAX
00961036 : PUSH EDX
00961037 : LEA ECX,[ESP + 0x48]
0096103b : CALL 0x00406360
00961040 : MOV byte ptr [ESP + 0x88],0x2
00961048 : PUSH EBX
00961049 : LEA EDX,[ESP + 0x28]
0096104d : PUSH EDX
0096104e : LEA EAX,[ESP + 0x48]
00961052 : PUSH EAX
00961053 : LEA ECX,[ESP + 0x1c]
00961057 : PUSH ECX
00961058 : CALL 0x0070cd60
0096105d : ADD ESP,0x10
00961060 : MOV byte ptr [ESP + 0x88],0x4
00961068 : MOV ESI,0x8
0096106d : CMP dword ptr [ESP + 0x58],ESI
00961071 : JC 0x0096107c
00961073 : MOV ECX,dword ptr [ESP + 0x44]
00961077 : CALL 0x006f04e0
0096107c : XOR EDX,EDX
0096107e : MOV dword ptr [ESP + 0x58],EDI
00961082 : MOV dword ptr [ESP + 0x54],EBX
00961086 : MOV word ptr [ESP + 0x44],DX
0096108b : MOV byte ptr [ESP + 0x88],0x5
00961093 : CMP dword ptr [ESP + 0x3c],ESI
00961097 : JC 0x009610a2
00961099 : MOV ECX,dword ptr [ESP + 0x28]
0096109d : CALL 0x006f04e0
009610a2 : XOR EAX,EAX
009610a4 : MOV word ptr [ESP + 0x28],AX
009610a9 : MOV EAX,dword ptr [EBP + 0x8]
009610ac : MOV dword ptr [ESP + 0x3c],EDI
009610b0 : MOV EDI,dword ptr [EAX + 0x18]
009610b3 : MOV dword ptr [ESP + 0x38],EBX
009610b7 : LEA ESI,[EAX + 0x4]
009610ba : CMP EDI,0x8
009610bd : JC 0x009610c3
009610bf : MOV EAX,dword ptr [ESI]
009610c1 : JMP 0x009610c5
009610c3 : MOV EAX,ESI
009610c5 : MOV ECX,0xc79a90
009610ca : LEA EBX,[EBX]
009610d0 : MOV DX,word ptr [EAX]
009610d3 : CMP DX,word ptr [ECX]
009610d6 : JNZ 0x009610f6
009610d8 : CMP DX,BX
009610db : JZ 0x009610f2
009610dd : MOV DX,word ptr [EAX + 0x2]
009610e1 : CMP DX,word ptr [ECX + 0x2]
009610e5 : JNZ 0x009610f6
009610e7 : ADD EAX,0x4
009610ea : ADD ECX,0x4
009610ed : CMP DX,BX
009610f0 : JNZ 0x009610d0
009610f2 : XOR EAX,EAX
009610f4 : JMP 0x009610fb
009610f6 : SBB EAX,EAX
009610f8 : SBB EAX,-0x1
009610fb : CMP EAX,EBX
009610fd : JZ 0x009612c3
00961103 : CMP EDI,0x8
00961106 : JC 0x0096110c
00961108 : MOV EAX,dword ptr [ESI]
0096110a : JMP 0x0096110e
0096110c : MOV EAX,ESI
0096110e : MOV ECX,0xc79aa0
00961113 : MOV DX,word ptr [EAX]
00961116 : CMP DX,word ptr [ECX]
00961119 : JNZ 0x00961139
0096111b : CMP DX,BX
0096111e : JZ 0x00961135
00961120 : MOV DX,word ptr [EAX + 0x2]
00961124 : CMP DX,word ptr [ECX + 0x2]
00961128 : JNZ 0x00961139
0096112a : ADD EAX,0x4
0096112d : ADD ECX,0x4
00961130 : CMP DX,BX
00961133 : JNZ 0x00961113
00961135 : XOR EAX,EAX
00961137 : JMP 0x0096113e
00961139 : SBB EAX,EAX
0096113b : SBB EAX,-0x1
0096113e : CMP EAX,EBX
00961140 : JNZ 0x0096121a
00961146 : MOV ECX,dword ptr [ESP + 0x18]
0096114a : MOV ESI,dword ptr [ESP + 0x14]
0096114e : SUB ECX,ESI
00961150 : MOV EAX,0x92492493
00961155 : IMUL ECX
00961157 : ADD EDX,ECX
00961159 : SAR EDX,0x4
0096115c : MOV ECX,EDX
0096115e : SHR ECX,0x1f
00961161 : ADD ECX,EDX
00961163 : CMP ECX,0x1
00961166 : JC 0x009611c6
00961168 : MOV EDI,0x8
0096116d : CMP dword ptr [ESI + 0x18],EDI
00961170 : JC 0x00961177
00961172 : MOV ESI,dword ptr [ESI + 0x4]
00961175 : JMP 0x0096117a
00961177 : ADD ESI,0x4
0096117a : PUSH ESI
0096117b : CALL 0x00634f4d
00961180 : ADD ESP,0x4
00961183 : CMP EAX,-0x1
00961186 : JNZ 0x009611ef
00961188 : MOV EDX,dword ptr [0x00da9894]
0096118e : MOV EAX,dword ptr [EDX]
00961190 : CMP EAX,EBX
00961192 : JZ 0x009611af
00961194 : CMP dword ptr [EAX + 0x114],EBX
0096119a : JZ 0x009611af
0096119c : MOV EAX,dword ptr [EAX + 0x114]
009611a2 : MOV EDX,dword ptr [EAX]
009611a4 : MOV ECX,EAX
009611a6 : MOV EAX,dword ptr [EDX]
009611a8 : PUSH 0xc79ab0
009611ad : CALL EAX
009611af : MOV ECX,dword ptr [0x0172490c]
009611b5 : MOV EAX,dword ptr [ECX + 0x8]
009611b8 : CMP EAX,0x2
009611bb : JZ 0x009611ef
009611bd : CMP EAX,EBX
009611bf : JZ 0x009611c6
009611c1 : CALL 0x008444f0
009611c6 : MOV byte ptr [ESP + 0x88],BL
009611cd : LEA ESI,[ESP + 0x10]
009611d1 : CALL 0x004042c0
009611d6 : MOV dword ptr [ESP + 0x88],0xffffffff
009611e1 : LEA ECX,[ESP + 0x5c]
009611e5 : CALL 0x00406560
009611ea : JMP 0x00961326
009611ef : MOV EAX,dword ptr [ESP + 0x14]
009611f3 : CMP dword ptr [EAX + 0x18],EDI
009611f6 : JC 0x009611fd
009611f8 : MOV EAX,dword ptr [EAX + 0x4]
009611fb : JMP 0x00961200
009611fd : ADD EAX,0x4
00961200 : PUSH EAX
00961201 : CALL 0x00634f4d
00961206 : MOV ECX,dword ptr [ESP + 0x24]
0096120a : MOV EDX,dword ptr [ECX]
0096120c : ADD ESP,0x4
0096120f : PUSH EAX
00961210 : MOV EAX,dword ptr [EDX + 0x4c]
00961213 : CALL EAX
00961215 : JMP 0x009612c3
0096121a : CMP EDI,0x8
0096121d : JC 0x00961223
0096121f : MOV EAX,dword ptr [ESI]
00961221 : JMP 0x00961225
00961223 : MOV EAX,ESI
00961225 : MOV ECX,0xc79acc
0096122a : LEA EBX,[EBX]
00961230 : MOV DX,word ptr [EAX]
00961233 : CMP DX,word ptr [ECX]
00961236 : JNZ 0x00961256
00961238 : CMP DX,BX
0096123b : JZ 0x00961252
0096123d : MOV DX,word ptr [EAX + 0x2]
00961241 : CMP DX,word ptr [ECX + 0x2]
00961245 : JNZ 0x00961256
00961247 : ADD EAX,0x4
0096124a : ADD ECX,0x4
0096124d : CMP DX,BX
00961250 : JNZ 0x00961230
00961252 : XOR EAX,EAX
00961254 : JMP 0x0096125b
00961256 : SBB EAX,EAX
00961258 : SBB EAX,-0x1
0096125b : CMP EAX,EBX
0096125d : JZ 0x009612c3
0096125f : CMP EDI,0x8
00961262 : JC 0x00961268
00961264 : MOV EAX,dword ptr [ESI]
00961266 : JMP 0x0096126a
00961268 : MOV EAX,ESI
0096126a : MOV ECX,0xc79ad8
0096126f : NOP
00961270 : MOV DX,word ptr [EAX]
00961273 : CMP DX,word ptr [ECX]
00961276 : JNZ 0x00961296
00961278 : CMP DX,BX
0096127b : JZ 0x00961292
0096127d : MOV DX,word ptr [EAX + 0x2]
00961281 : CMP DX,word ptr [ECX + 0x2]
00961285 : JNZ 0x00961296
00961287 : ADD EAX,0x4
0096128a : ADD ECX,0x4
0096128d : CMP DX,BX
00961290 : JNZ 0x00961270
00961292 : XOR EAX,EAX
00961294 : JMP 0x0096129b
00961296 : SBB EAX,EAX
00961298 : SBB EAX,-0x1
0096129b : CMP EAX,EBX
0096129d : JNZ 0x009612c3
0096129f : MOV ECX,dword ptr [0x00da9894]
009612a5 : MOV EAX,dword ptr [ECX]
009612a7 : CMP dword ptr [EAX + 0x288],EBX
009612ad : JZ 0x009612c3
009612af : MOV ECX,dword ptr [EAX + 0x288]
009612b5 : MOV EDX,dword ptr [ECX]
009612b7 : MOV EAX,dword ptr [EDX + 0x18]
009612ba : PUSH 0x12c
009612bf : PUSH 0x1
009612c1 : CALL EAX
009612c3 : MOV byte ptr [ESP + 0x88],BL
009612ca : MOV EAX,dword ptr [ESP + 0x14]
009612ce : CMP EAX,EBX
009612d0 : JZ 0x009612ec
009612d2 : MOV ECX,dword ptr [ESP + 0x20]
009612d6 : MOV EDI,dword ptr [ESP + 0x18]
009612da : PUSH ECX
009612db : CALL 0x00405450
009612e0 : MOV ECX,dword ptr [ESP + 0x18]
009612e4 : ADD ESP,0x4
009612e7 : CALL 0x006f04e0
009612ec : MOV dword ptr [ESP + 0x14],EBX
009612f0 : MOV dword ptr [ESP + 0x18],EBX
009612f4 : MOV dword ptr [ESP + 0x1c],EBX
009612f8 : MOV dword ptr [ESP + 0x88],0xffffffff
00961303 : CMP dword ptr [ESP + 0x74],0x8
00961308 : JC 0x00961313
0096130a : MOV ECX,dword ptr [ESP + 0x60]
0096130e : CALL 0x006f04e0
00961313 : XOR EDX,EDX
00961315 : MOV dword ptr [ESP + 0x74],0x7
0096131d : MOV dword ptr [ESP + 0x70],EBX
00961321 : MOV word ptr [ESP + 0x60],DX
00961326 : MOV ECX,dword ptr [ESP + 0x80]
0096132d : MOV dword ptr FS:[0x0],ECX
00961334 : POP ECX
00961335 : POP EDI
00961336 : POP ESI
00961337 : POP EBX
00961338 : MOV ECX,dword ptr [ESP + 0x68]
0096133c : XOR ECX,ESP
0096133e : CALL 0x00633e6b
00961343 : MOV ESP,EBP
00961345 : POP EBP
00961346 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_0078bed0
ENTRY    : 0078bed0
BODY     : [[0078bed0, 0078c040]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0078bed0(void)

{
  HANDLE pvVar1;
  uintptr_t uVar2;
  int *piVar3;
  int *in_ECX;
  int iVar4;
  int in_EDX;
  undefined4 *puVar5;
  undefined1 local_430 [4];
  undefined2 local_42c;
  undefined4 local_41c;
  uint local_418;
  undefined4 local_414 [256];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b27dd7;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  (**(code **)(*in_ECX + 4))();
  pvVar1 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCWSTR)0x0);
  in_ECX[2] = (int)pvVar1;
  in_ECX[0xe] = 0;
  in_ECX[0xf] = 0;
  uVar2 = __beginthreadex((void *)0x0,0,FUN_0078bdd0,in_ECX,4,(uint *)(in_ECX + 3));
  in_ECX[1] = uVar2;
  if (uVar2 == 0) {
    in_ECX[6] = 1;
    in_ECX[4] = 1;
    puVar5 = local_414;
    for (iVar4 = 0x100; iVar4 != 0; iVar4 = iVar4 + -1) {
      *puVar5 = 0;
      puVar5 = puVar5 + 1;
    }
    if (*(uint *)(in_EDX + 0x18) < 8) {
      iVar4 = in_EDX + 4;
    }
    else {
      iVar4 = *(int *)(in_EDX + 4);
    }
    FUN_0040e4a0(L"[AvaThreadControl::CreateThread][Create Thread[%s] failed\n",iVar4);
    FUN_00406460(local_414);
    local_8 = 0;
    if ((int *)*DAT_00da98e8 != (int *)0x0) {
      (**(code **)(*(int *)*DAT_00da98e8 + 0x14))
                (L"AvaLib::AvaThreadControl::CreateThread",0x6f,local_430);
    }
    local_8 = 0xffffffff;
    if (7 < local_418) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_418 = 7;
    local_41c = 0;
    local_42c = 0;
  }
  else {
    FUN_0078bd90();
    if ((uint)in_ECX[0xd] < 8) {
      piVar3 = in_ECX + 8;
    }
    else {
      piVar3 = (int *)in_ECX[8];
    }
    FUN_008018d0(L"[AvaThreadControl::CreateThread] (%s) %x created",piVar3,in_ECX[1]);
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0078bed0 : PUSH EBP
0078bed1 : MOV EBP,ESP
0078bed3 : PUSH -0x1
0078bed5 : PUSH 0xb27dd7
0078beda : MOV EAX,FS:[0x0]
0078bee0 : PUSH EAX
0078bee1 : SUB ESP,0x420
0078bee7 : MOV EAX,[0x00d66fa0]
0078beec : XOR EAX,EBP
0078beee : MOV dword ptr [EBP + -0x10],EAX
0078bef1 : PUSH ESI
0078bef2 : PUSH EDI
0078bef3 : PUSH EAX
0078bef4 : LEA EAX,[EBP + -0xc]
0078bef7 : MOV FS:[0x0],EAX
0078befd : MOV EDI,ECX
0078beff : MOV EAX,dword ptr [EDI]
0078bf01 : MOV ESI,EDX
0078bf03 : MOV EDX,dword ptr [EAX + 0x4]
0078bf06 : PUSH ESI
0078bf07 : CALL EDX
0078bf09 : PUSH 0x0
0078bf0b : PUSH 0x0
0078bf0d : PUSH 0x1
0078bf0f : PUSH 0x0
0078bf11 : CALL dword ptr [0x00b851e0]
0078bf17 : LEA ECX,[EDI + 0xc]
0078bf1a : PUSH ECX
0078bf1b : PUSH 0x4
0078bf1d : PUSH EDI
0078bf1e : MOV dword ptr [EDI + 0x8],EAX
0078bf21 : XOR EAX,EAX
0078bf23 : PUSH 0x78bdd0
0078bf28 : PUSH EAX
0078bf29 : PUSH EAX
0078bf2a : MOV dword ptr [EDI + 0x38],EAX
0078bf2d : MOV dword ptr [EDI + 0x3c],EAX
0078bf30 : CALL 0x00635f44
0078bf35 : ADD ESP,0x18
0078bf38 : MOV dword ptr [EDI + 0x4],EAX
0078bf3b : TEST EAX,EAX
0078bf3d : JNZ 0x0078bffb
0078bf43 : MOVZX EDX,AX
0078bf46 : MOV dword ptr [EDI + 0x18],0x1
0078bf4d : MOV dword ptr [EDI + 0x10],0x1
0078bf54 : MOV EAX,EDX
0078bf56 : SHL EDX,0x10
0078bf59 : OR EAX,EDX
0078bf5b : MOV ECX,0x100
0078bf60 : LEA EDI,[EBP + 0xfffffbf0]
0078bf66 : STOSD.REP ES:EDI
0078bf68 : MOV EDI,0x8
0078bf6d : CMP dword ptr [ESI + 0x18],EDI
0078bf70 : JC 0x0078bf77
0078bf72 : MOV ESI,dword ptr [ESI + 0x4]
0078bf75 : JMP 0x0078bf7a
0078bf77 : ADD ESI,0x4
0078bf7a : PUSH ESI
0078bf7b : PUSH 0xc13520
0078bf80 : LEA EDX,[EBP + 0xfffffbf0]
0078bf86 : CALL 0x0040e4a0
0078bf8b : ADD ESP,0x8
0078bf8e : LEA EAX,[EBP + 0xfffffbf0]
0078bf94 : PUSH EAX
0078bf95 : LEA ECX,[EBP + 0xfffffbd4]
0078bf9b : CALL 0x00406460
0078bfa0 : XOR ESI,ESI
0078bfa2 : MOV dword ptr [EBP + -0x4],ESI
0078bfa5 : MOV ECX,dword ptr [0x00da98e8]
0078bfab : MOV ECX,dword ptr [ECX]
0078bfad : CMP ECX,ESI
0078bfaf : JZ 0x0078bfc6
0078bfb1 : MOV EDX,dword ptr [ECX]
0078bfb3 : MOV EDX,dword ptr [EDX + 0x14]
0078bfb6 : LEA EAX,[EBP + 0xfffffbd4]
0078bfbc : PUSH EAX
0078bfbd : PUSH 0x6f
0078bfbf : PUSH 0xc13598
0078bfc4 : CALL EDX
0078bfc6 : MOV dword ptr [EBP + -0x4],0xffffffff
0078bfcd : CMP dword ptr [EBP + 0xfffffbec],EDI
0078bfd3 : JC 0x0078bfe0
0078bfd5 : MOV ECX,dword ptr [EBP + 0xfffffbd8]
0078bfdb : CALL 0x006f04e0
0078bfe0 : XOR EAX,EAX
0078bfe2 : MOV dword ptr [EBP + 0xfffffbec],0x7
0078bfec : MOV dword ptr [EBP + 0xfffffbe8],ESI
0078bff2 : MOV word ptr [EBP + 0xfffffbd8],AX
0078bff9 : JMP 0x0078c026
0078bffb : CALL 0x0078bd90
0078c000 : CMP dword ptr [EDI + 0x34],0x8
0078c004 : JC 0x0078c00b
0078c006 : MOV EAX,dword ptr [EDI + 0x20]
0078c009 : JMP 0x0078c00e
0078c00b : LEA EAX,[EDI + 0x20]
0078c00e : MOV ECX,dword ptr [EDI + 0x4]
0078c011 : MOV ESI,dword ptr [0x00da98e8]
0078c017 : PUSH ECX
0078c018 : PUSH EAX
0078c019 : PUSH 0xc135e8
0078c01e : CALL 0x008018d0
0078c023 : ADD ESP,0xc
0078c026 : MOV ECX,dword ptr [EBP + -0xc]
0078c029 : MOV dword ptr FS:[0x0],ECX
0078c030 : POP ECX
0078c031 : POP EDI
0078c032 : POP ESI
0078c033 : MOV ECX,dword ptr [EBP + -0x10]
0078c036 : XOR ECX,EBP
0078c038 : CALL 0x00633e6b
0078c03d : MOV ESP,EBP
0078c03f : POP EBP
0078c040 : RET

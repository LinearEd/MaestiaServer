PROGRAM  : Maestia.exe
FUNCTION : FUN_00828d70
ENTRY    : 00828d70
BODY     : [[00828d70, 00828f91]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00828d70(void)

{
  DWORD DVar1;
  DWORD DVar2;
  int in_ECX;
  LPCRITICAL_SECTION local_24;
  char *local_20;
  undefined4 local_1c;
  int local_18;
  undefined4 local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b6aa43;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  (*(code *)PTR_FUN_00d6d240)(0,1,&DAT_00c33c74,DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
  if (DAT_00da98f4 != (HANDLE)0x0) {
    WaitForSingleObject(DAT_00da98f4,0xffffffff);
    ResetEvent(DAT_00da98f4);
  }
  if (*(char *)(in_ECX + 0x33f) == '\0') {
    if (((DAT_00da9877 != '\0') && (*DAT_00da9894 != 0)) && (*(int *)(*DAT_00da9894 + 0x228) != 0))
    {
      FUN_009e5d20();
    }
    (*(code *)PTR_FUN_00d6d240)(0,1,&DAT_00c33c78);
    local_24 = (LPCRITICAL_SECTION)(in_ECX + 0x4c8);
    local_18 = 0;
    local_20 = ".\\AvaGame.cpp";
    local_1c = 0x10ca;
    local_14 = 1;
    FUN_006ef1a0(&local_24);
    local_8 = 0;
    if (*(int *)(in_ECX + 0x150) != 0) {
      DVar1 = GetTickCount();
      (**(code **)(**(int **)(in_ECX + 0x150) + 8))();
      DVar2 = GetTickCount();
      (*(code *)PTR_FUN_00d6d240)(0x28,0xe,"OnGetData Frame %4d",DVar2 - DVar1);
    }
    if (*(char *)(in_ECX + 0x158) != '\0') {
      FUN_008018d0(L"[AvaGame::RunLogic] DELETE Main CltNet And CltSocketEvent");
      *(undefined1 *)(in_ECX + 0x158) = 0;
      if (*(int *)(in_ECX + 0x150) != 0) {
        FUN_0081d600();
      }
      if (*(int *)(in_ECX + 0x14c) != 0) {
        FUN_0081bec0();
      }
    }
    local_8 = 0xffffffff;
    if (local_18 != 0) {
      LeaveCriticalSection(local_24);
      local_18 = 0;
    }
    (*(code *)PTR_FUN_00d6d240)(0,1,&DAT_00c33d14);
    FUN_00820070(in_ECX + -4);
    (*(code *)PTR_FUN_00d6d240)(0,1,&DAT_00c33d18);
    FUN_00822fa0();
    if (*(char *)(in_ECX + 0x33f) == '\0') {
      (*(code *)PTR_FUN_00d6d240)(0,1,&DAT_00c33d1c);
      if (*(int **)(in_ECX + 0xc4) != (int *)0x0) {
        (**(code **)(**(int **)(in_ECX + 0xc4) + 0x18))();
      }
      FUN_00828460();
      (*(code *)PTR_FUN_00d6d240)(0,1,&DAT_00c33d20);
      if ((DAT_00da98f8 != (HANDLE)0x0) && (DAT_00d6ab0e != '\0')) {
        SetEvent(DAT_00da98f8);
        *(undefined1 *)(DAT_017251ac + 5) = 1;
      }
      (*(code *)PTR_FUN_00d6d240)(0,1,&DAT_00c33d24);
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00828d70 : PUSH EBP
00828d71 : MOV EBP,ESP
00828d73 : PUSH -0x1
00828d75 : PUSH 0xb6aa43
00828d7a : MOV EAX,FS:[0x0]
00828d80 : PUSH EAX
00828d81 : SUB ESP,0x14
00828d84 : PUSH EBX
00828d85 : PUSH ESI
00828d86 : PUSH EDI
00828d87 : MOV EAX,[0x00d66fa0]
00828d8c : XOR EAX,EBP
00828d8e : PUSH EAX
00828d8f : LEA EAX,[EBP + -0xc]
00828d92 : MOV FS:[0x0],EAX
00828d98 : MOV EBX,ECX
00828d9a : PUSH 0xc33c74
00828d9f : PUSH 0x1
00828da1 : XOR EDI,EDI
00828da3 : PUSH EDI
00828da4 : CALL dword ptr [0x00d6d240]
00828daa : MOV EAX,[0x00da98f4]
00828daf : ADD ESP,0xc
00828db2 : CMP EAX,EDI
00828db4 : JZ 0x00828dcb
00828db6 : PUSH -0x1
00828db8 : PUSH EAX
00828db9 : CALL dword ptr [0x00b85100]
00828dbf : MOV EAX,[0x00da98f4]
00828dc4 : PUSH EAX
00828dc5 : CALL dword ptr [0x00b851dc]
00828dcb : CMP byte ptr [EBX + 0x33f],0x0
00828dd2 : JNZ 0x00828f80
00828dd8 : CMP byte ptr [0x00da9877],0x0
00828ddf : JZ 0x00828e00
00828de1 : MOV ECX,dword ptr [0x00da9894]
00828de7 : MOV EAX,dword ptr [ECX]
00828de9 : CMP EAX,EDI
00828deb : JZ 0x00828e00
00828ded : CMP dword ptr [EAX + 0x228],EDI
00828df3 : JZ 0x00828e00
00828df5 : MOV ECX,dword ptr [EAX + 0x228]
00828dfb : CALL 0x009e5d20
00828e00 : PUSH 0xc33c78
00828e05 : PUSH 0x1
00828e07 : PUSH EDI
00828e08 : CALL dword ptr [0x00d6d240]
00828e0e : ADD ESP,0xc
00828e11 : LEA EAX,[EBP + -0x20]
00828e14 : LEA EDX,[EBX + 0x4c8]
00828e1a : PUSH EAX
00828e1b : MOV dword ptr [EBP + -0x14],EDI
00828e1e : MOV dword ptr [EBP + -0x20],EDX
00828e21 : MOV dword ptr [EBP + -0x1c],0xc33c7c
00828e28 : MOV dword ptr [EBP + -0x18],0x10ca
00828e2f : MOV dword ptr [EBP + -0x10],0x1
00828e36 : CALL 0x006ef1a0
00828e3b : MOV dword ptr [EBP + -0x4],EDI
00828e3e : CMP dword ptr [EBX + 0x150],EDI
00828e44 : JZ 0x00828e76
00828e46 : MOV ESI,dword ptr [0x00b850d8]
00828e4c : CALL ESI
00828e4e : MOV ECX,dword ptr [EBX + 0x150]
00828e54 : MOV EDX,dword ptr [ECX]
00828e56 : MOV EDI,EAX
00828e58 : MOV EAX,dword ptr [EDX + 0x8]
00828e5b : CALL EAX
00828e5d : CALL ESI
00828e5f : SUB EAX,EDI
00828e61 : PUSH EAX
00828e62 : PUSH 0xc33c8c
00828e67 : PUSH 0xe
00828e69 : PUSH 0x28
00828e6b : CALL dword ptr [0x00d6d240]
00828e71 : ADD ESP,0x10
00828e74 : XOR EDI,EDI
00828e76 : CMP byte ptr [EBX + 0x158],0x0
00828e7d : JZ 0x00828eb9
00828e7f : MOV ESI,dword ptr [0x00da98e8]
00828e85 : PUSH 0xc33ca0
00828e8a : CALL 0x008018d0
00828e8f : ADD ESP,0x4
00828e92 : MOV byte ptr [EBX + 0x158],0x0
00828e99 : CMP dword ptr [EBX + 0x150],EDI
00828e9f : JZ 0x00828ea9
00828ea1 : LEA ECX,[EBX + -0x4]
00828ea4 : CALL 0x0081d600
00828ea9 : CMP dword ptr [EBX + 0x14c],EDI
00828eaf : JZ 0x00828eb9
00828eb1 : LEA ESI,[EBX + -0x4]
00828eb4 : CALL 0x0081bec0
00828eb9 : MOV dword ptr [EBP + -0x4],0xffffffff
00828ec0 : CMP dword ptr [EBP + -0x14],EDI
00828ec3 : JZ 0x00828ed2
00828ec5 : MOV ECX,dword ptr [EBP + -0x20]
00828ec8 : PUSH ECX
00828ec9 : CALL dword ptr [0x00b8511c]
00828ecf : MOV dword ptr [EBP + -0x14],EDI
00828ed2 : PUSH 0xc33d14
00828ed7 : PUSH 0x1
00828ed9 : PUSH EDI
00828eda : CALL dword ptr [0x00d6d240]
00828ee0 : ADD ESP,0xc
00828ee3 : LEA ESI,[EBX + -0x4]
00828ee6 : PUSH ESI
00828ee7 : CALL 0x00820070
00828eec : PUSH 0xc33d18
00828ef1 : PUSH 0x1
00828ef3 : PUSH EDI
00828ef4 : CALL dword ptr [0x00d6d240]
00828efa : ADD ESP,0xc
00828efd : MOV EDI,ESI
00828eff : CALL 0x00822fa0
00828f04 : CMP byte ptr [EBX + 0x33f],0x0
00828f0b : JNZ 0x00828f80
00828f0d : PUSH 0xc33d1c
00828f12 : PUSH 0x1
00828f14 : PUSH 0x0
00828f16 : CALL dword ptr [0x00d6d240]
00828f1c : MOV EBX,dword ptr [EBX + 0xc4]
00828f22 : ADD ESP,0xc
00828f25 : TEST EBX,EBX
00828f27 : JZ 0x00828f32
00828f29 : MOV EDX,dword ptr [EBX]
00828f2b : MOV EAX,dword ptr [EDX + 0x18]
00828f2e : MOV ECX,EBX
00828f30 : CALL EAX
00828f32 : MOV ECX,ESI
00828f34 : CALL 0x00828460
00828f39 : PUSH 0xc33d20
00828f3e : PUSH 0x1
00828f40 : PUSH 0x0
00828f42 : CALL dword ptr [0x00d6d240]
00828f48 : MOV EAX,[0x00da98f8]
00828f4d : ADD ESP,0xc
00828f50 : TEST EAX,EAX
00828f52 : JZ 0x00828f6e
00828f54 : CMP byte ptr [0x00d6ab0e],0x0
00828f5b : JZ 0x00828f6e
00828f5d : PUSH EAX
00828f5e : CALL dword ptr [0x00b851e8]
00828f64 : MOV ECX,dword ptr [0x017251ac]
00828f6a : MOV byte ptr [ECX + 0x5],0x1
00828f6e : PUSH 0xc33d24
00828f73 : PUSH 0x1
00828f75 : PUSH 0x0
00828f77 : CALL dword ptr [0x00d6d240]
00828f7d : ADD ESP,0xc
00828f80 : MOV ECX,dword ptr [EBP + -0xc]
00828f83 : MOV dword ptr FS:[0x0],ECX
00828f8a : POP ECX
00828f8b : POP EDI
00828f8c : POP ESI
00828f8d : POP EBX
00828f8e : MOV ESP,EBP
00828f90 : POP EBP
00828f91 : RET

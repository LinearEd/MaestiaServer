PROGRAM  : Maestia.exe
FUNCTION : FUN_007be9c0
ENTRY    : 007be9c0
BODY     : [[007be9c0, 007beba2] [007bebb1, 007bebf2]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007be9c0(undefined4 param_1)

{
  int *piVar1;
  char cVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  int unaff_ESI;
  LPCRITICAL_SECTION local_24;
  char *local_20;
  undefined4 local_1c;
  int local_18;
  undefined4 local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b284d0;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_24 = (LPCRITICAL_SECTION)(unaff_ESI + 4);
  local_18 = 0;
  local_20 = ".\\mss\\AvaMssMgr.cpp";
  local_1c = 0x112;
  local_14 = 1;
  FUN_006ef1a0(&local_24);
  local_8 = 0;
  if (*(int *)(unaff_ESI + 0x20) == 0) {
    local_8 = 0xffffffff;
    if (local_18 != 0) {
      LeaveCriticalSection(local_24);
      ExceptionList = local_10;
      return;
    }
  }
  else {
    FUN_007bde30(param_1);
    iVar5 = *(int *)(unaff_ESI + 0x54) - *(int *)(unaff_ESI + 0x50) >> 2;
    if (iVar5 != 0) {
      FUN_004647b0(&param_1,*(undefined4 *)(unaff_ESI + 0x50),*(undefined4 *)(unaff_ESI + 0x54),
                   param_1,uVar3);
      FUN_00464ab0(*(undefined4 *)(unaff_ESI + 0x50),*(undefined4 *)(unaff_ESI + 0x54));
      while (((iVar5 != 0 &&
              (piVar1 = *(int **)(*(int *)(unaff_ESI + 0x54) + -4), piVar1 != (int *)0x0)) &&
             ((*piVar1 == 0 || (iVar4 = _AIL_sample_status_4(*piVar1), iVar4 != 4))))) {
        cVar2 = FUN_007bd2e0(piVar1,2);
        if (cVar2 == '\0') {
          if ((*piVar1 != 0) && (iVar5 = _AIL_sample_status_4(*piVar1), iVar5 == 4)) {
            _AIL_end_sample_4(*piVar1);
          }
          FUN_007542c0(piVar1);
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        if ((*(int *)(unaff_ESI + 0x54) - *(int *)(unaff_ESI + 0x50) & 0xfffffffcU) != 0) {
          *(int *)(unaff_ESI + 0x54) = *(int *)(unaff_ESI + 0x54) + -4;
        }
        iVar5 = iVar5 + -1;
      }
    }
    iVar5 = *(int *)(unaff_ESI + 0x44) - *(int *)(unaff_ESI + 0x40) >> 2;
    if (iVar5 != 0) {
      FUN_00464ab0(*(undefined4 *)(unaff_ESI + 0x40),*(undefined4 *)(unaff_ESI + 0x44));
      while (((iVar5 != 0 &&
              (piVar1 = *(int **)(*(int *)(unaff_ESI + 0x44) + -4), piVar1 != (int *)0x0)) &&
             ((*piVar1 == 0 || (iVar4 = _AIL_sample_status_4(*piVar1), iVar4 != 4))))) {
        cVar2 = FUN_007bd440(piVar1,2);
        if (cVar2 == '\0') {
          if ((*piVar1 != 0) && (iVar5 = _AIL_sample_status_4(*piVar1), iVar5 == 4)) {
            _AIL_end_sample_4(*piVar1);
          }
          FUN_007542c0(piVar1);
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        if ((*(int *)(unaff_ESI + 0x44) - *(int *)(unaff_ESI + 0x40) & 0xfffffffcU) != 0) {
          *(int *)(unaff_ESI + 0x44) = *(int *)(unaff_ESI + 0x44) + -4;
        }
        iVar5 = iVar5 + -1;
      }
    }
    local_8 = 0xffffffff;
    if (local_18 != 0) {
      LeaveCriticalSection(local_24);
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
007be9c0 : PUSH EBP
007be9c1 : MOV EBP,ESP
007be9c3 : PUSH -0x1
007be9c5 : PUSH 0xb284d0
007be9ca : MOV EAX,FS:[0x0]
007be9d0 : PUSH EAX
007be9d1 : SUB ESP,0x14
007be9d4 : PUSH EBX
007be9d5 : PUSH EDI
007be9d6 : MOV EAX,[0x00d66fa0]
007be9db : XOR EAX,EBP
007be9dd : PUSH EAX
007be9de : LEA EAX,[EBP + -0xc]
007be9e1 : MOV FS:[0x0],EAX
007be9e7 : LEA ECX,[EBP + -0x20]
007be9ea : LEA EAX,[ESI + 0x4]
007be9ed : XOR EDI,EDI
007be9ef : PUSH ECX
007be9f0 : MOV dword ptr [EBP + -0x14],EDI
007be9f3 : MOV dword ptr [EBP + -0x20],EAX
007be9f6 : MOV dword ptr [EBP + -0x1c],0xc18d24
007be9fd : MOV dword ptr [EBP + -0x18],0x112
007bea04 : MOV dword ptr [EBP + -0x10],0x1
007bea0b : CALL 0x006ef1a0
007bea10 : MOV dword ptr [EBP + -0x4],EDI
007bea13 : CMP dword ptr [ESI + 0x20],EDI
007bea16 : JNZ 0x007bea48
007bea18 : MOV dword ptr [EBP + -0x4],0xffffffff
007bea1f : CMP dword ptr [EBP + -0x14],EDI
007bea22 : JZ 0x007bebe0
007bea28 : MOV EDX,dword ptr [EBP + -0x20]
007bea2b : PUSH EDX
007bea2c : CALL dword ptr [0x00b8511c]
007bea32 : MOV dword ptr [EBP + -0x14],EDI
007bea35 : MOV ECX,dword ptr [EBP + -0xc]
007bea38 : MOV dword ptr FS:[0x0],ECX
007bea3f : POP ECX
007bea40 : POP EDI
007bea41 : POP EBX
007bea42 : MOV ESP,EBP
007bea44 : POP EBP
007bea45 : RET 0x4
007bea48 : MOV EAX,dword ptr [EBP + 0x8]
007bea4b : PUSH EAX
007bea4c : MOV EDI,ESI
007bea4e : CALL 0x007bde30
007bea53 : MOV EBX,dword ptr [ESI + 0x54]
007bea56 : SUB EBX,dword ptr [ESI + 0x50]
007bea59 : SAR EBX,0x2
007bea5c : TEST EBX,EBX
007bea5e : JZ 0x007beb07
007bea64 : MOV EDX,dword ptr [EBP + 0x8]
007bea67 : MOV EAX,dword ptr [ESI + 0x54]
007bea6a : MOV ECX,dword ptr [ESI + 0x50]
007bea6d : PUSH EDX
007bea6e : PUSH EAX
007bea6f : PUSH ECX
007bea70 : LEA EAX,[EBP + 0x8]
007bea73 : PUSH EAX
007bea74 : CALL 0x004647b0
007bea79 : MOV EAX,dword ptr [ESI + 0x54]
007bea7c : MOV ECX,dword ptr [ESI + 0x50]
007bea7f : PUSH EAX
007bea80 : PUSH ECX
007bea81 : LEA EDI,[EBP + 0x8]
007bea84 : CALL 0x00464ab0
007bea89 : ADD ESP,0x18
007bea8c : TEST EBX,EBX
007bea8e : JBE 0x007beb07
007bea90 : MOV EAX,dword ptr [ESI + 0x54]
007bea93 : MOV EDI,dword ptr [EAX + -0x4]
007bea96 : TEST EDI,EDI
007bea98 : JZ 0x007beb07
007bea9a : MOV EAX,dword ptr [EDI]
007bea9c : TEST EAX,EAX
007bea9e : JZ 0x007beab1
007beaa0 : PUSH EAX
007beaa1 : CALL dword ptr [0x00b85708]
007beaa7 : CMP EAX,0x4
007beaaa : SETZ AL
007beaad : TEST AL,AL
007beaaf : JNZ 0x007beb07
007beab1 : PUSH 0x2
007beab3 : PUSH EDI
007beab4 : MOV ECX,ESI
007beab6 : CALL 0x007bd2e0
007beabb : TEST AL,AL
007beabd : JNZ 0x007beaec
007beabf : MOV EAX,dword ptr [EDI]
007beac1 : TEST EAX,EAX
007beac3 : JZ 0x007beadf
007beac5 : PUSH EAX
007beac6 : CALL dword ptr [0x00b85708]
007beacc : CMP EAX,0x4
007beacf : SETZ AL
007bead2 : TEST AL,AL
007bead4 : JZ 0x007beadf
007bead6 : MOV EDX,dword ptr [EDI]
007bead8 : PUSH EDX
007bead9 : CALL dword ptr [0x00b856f4]
007beadf : PUSH EDI
007beae0 : CALL 0x007542c0
007beae5 : MOV ECX,EDI
007beae7 : CALL 0x006f04e0
007beaec : MOV EAX,dword ptr [ESI + 0x54]
007beaef : MOV ECX,EAX
007beaf1 : SUB ECX,dword ptr [ESI + 0x50]
007beaf4 : TEST ECX,0xfffffffc
007beafa : JZ 0x007beb02
007beafc : ADD EAX,-0x4
007beaff : MOV dword ptr [ESI + 0x54],EAX
007beb02 : SUB EBX,0x1
007beb05 : JNZ 0x007bea90
007beb07 : MOV EBX,dword ptr [ESI + 0x44]
007beb0a : SUB EBX,dword ptr [ESI + 0x40]
007beb0d : SAR EBX,0x2
007beb10 : TEST EBX,EBX
007beb12 : JZ 0x007bebc2
007beb18 : MOV EAX,dword ptr [ESI + 0x44]
007beb1b : MOV ECX,dword ptr [ESI + 0x40]
007beb1e : PUSH EAX
007beb1f : PUSH ECX
007beb20 : LEA EDI,[EBP + 0x8]
007beb23 : CALL 0x00464ab0
007beb28 : ADD ESP,0x8
007beb2b : TEST EBX,EBX
007beb2d : JBE 0x007bebc2
007beb33 : MOV EAX,dword ptr [ESI + 0x44]
007beb36 : MOV EDI,dword ptr [EAX + -0x4]
007beb39 : TEST EDI,EDI
007beb3b : JZ 0x007bebc2
007beb41 : MOV EAX,dword ptr [EDI]
007beb43 : TEST EAX,EAX
007beb45 : JZ 0x007beb58
007beb47 : PUSH EAX
007beb48 : CALL dword ptr [0x00b85708]
007beb4e : CMP EAX,0x4
007beb51 : SETZ AL
007beb54 : TEST AL,AL
007beb56 : JNZ 0x007bebc2
007beb58 : PUSH 0x2
007beb5a : PUSH EDI
007beb5b : MOV ECX,ESI
007beb5d : CALL 0x007bd440
007beb62 : TEST AL,AL
007beb64 : JZ 0x007beb76
007beb66 : MOV EAX,dword ptr [ESI + 0x44]
007beb69 : MOV EDX,EAX
007beb6b : SUB EDX,dword ptr [ESI + 0x40]
007beb6e : TEST EDX,0xfffffffc
007beb74 : JMP 0x007bebb1
007beb76 : MOV EAX,dword ptr [EDI]
007beb78 : TEST EAX,EAX
007beb7a : JZ 0x007beb96
007beb7c : PUSH EAX
007beb7d : CALL dword ptr [0x00b85708]
007beb83 : CMP EAX,0x4
007beb86 : SETZ AL
007beb89 : TEST AL,AL
007beb8b : JZ 0x007beb96
007beb8d : MOV EAX,dword ptr [EDI]
007beb8f : PUSH EAX
007beb90 : CALL dword ptr [0x00b856f4]
007beb96 : PUSH EDI
007beb97 : CALL 0x007542c0
007beb9c : MOV ECX,EDI
007beb9e : CALL 0x006f04e0
007bebb1 : JZ 0x007bebb9
007bebb3 : ADD EAX,-0x4
007bebb6 : MOV dword ptr [ESI + 0x44],EAX
007bebb9 : SUB EBX,0x1
007bebbc : JNZ 0x007beb33
007bebc2 : MOV dword ptr [EBP + -0x4],0xffffffff
007bebc9 : CMP dword ptr [EBP + -0x14],0x0
007bebcd : JZ 0x007bebe0
007bebcf : MOV EDX,dword ptr [EBP + -0x20]
007bebd2 : PUSH EDX
007bebd3 : CALL dword ptr [0x00b8511c]
007bebd9 : MOV dword ptr [EBP + -0x14],0x0
007bebe0 : MOV ECX,dword ptr [EBP + -0xc]
007bebe3 : MOV dword ptr FS:[0x0],ECX
007bebea : POP ECX
007bebeb : POP EDI
007bebec : POP EBX
007bebed : MOV ESP,EBP
007bebef : POP EBP
007bebf0 : RET 0x4

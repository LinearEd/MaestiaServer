PROGRAM  : Maestia.exe
FUNCTION : FUN_004645b0
ENTRY    : 004645b0
BODY     : [[004645b0, 0046461c] [00464620, 004646a6]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x00464600) */

void FUN_004645b0(int param_1,undefined4 *param_2,int param_3)

{
  uint uVar1;
  ushort *puVar2;
  undefined4 *puVar3;
  ushort *puVar4;
  uint uVar5;
  bool bVar6;
  
  puVar3 = *(undefined4 **)(*(int *)(param_1 + 4) + 4);
  bVar6 = true;
  if (*(char *)((int)puVar3 + 0x2d) == '\0') {
    uVar1 = *(uint *)(param_3 + 0x14);
    do {
      if ((uint)puVar3[9] < 8) {
        puVar2 = (ushort *)(puVar3 + 4);
      }
      else {
        puVar2 = (ushort *)puVar3[4];
      }
      uVar5 = puVar3[8];
      if (uVar1 < (uint)puVar3[8]) {
        uVar5 = uVar1;
      }
      if (*(uint *)(param_3 + 0x18) < 8) {
        puVar4 = (ushort *)(param_3 + 4);
      }
      else {
        puVar4 = *(ushort **)(param_3 + 4);
      }
      for (; uVar5 != 0; uVar5 = uVar5 - 1) {
        if (*puVar4 != *puVar2) {
          uVar5 = (-(uint)(*puVar4 < *puVar2) & 0xfffffffe) + 1;
          if (uVar5 != 0) goto LAB_00464660;
          break;
        }
        puVar4 = puVar4 + 1;
        puVar2 = puVar2 + 1;
      }
      if (uVar1 < (uint)puVar3[8]) {
        uVar5 = 0xffffffff;
      }
      else {
        uVar5 = (uint)(uVar1 != puVar3[8]);
      }
LAB_00464660:
      bVar6 = (int)uVar5 < 0;
      if (bVar6) {
        puVar3 = (undefined4 *)*puVar3;
      }
      else {
        puVar3 = (undefined4 *)puVar3[2];
      }
    } while (*(char *)((int)puVar3 + 0x2d) == '\0');
  }
  puVar3 = (undefined4 *)FUN_0042faf0(&param_3,bVar6,param_3);
  *param_2 = *puVar3;
  *(undefined1 *)(param_2 + 1) = 1;
  return;
}



============================================================
DISASSEMBLY
============================================================
004645b0 : PUSH EBP
004645b1 : MOV EBP,ESP
004645b3 : SUB ESP,0x18
004645b6 : MOV EAX,dword ptr [EBP + 0x8]
004645b9 : MOV EAX,dword ptr [EAX + 0x4]
004645bc : MOV ECX,dword ptr [EAX + 0x4]
004645bf : CMP byte ptr [ECX + 0x2d],0x0
004645c3 : PUSH EBX
004645c4 : MOV EBX,dword ptr [EBP + 0x10]
004645c7 : PUSH ESI
004645c8 : PUSH EDI
004645c9 : MOV byte ptr [EBP + -0x4],0x1
004645cd : JNZ 0x00464680
004645d3 : MOV EDX,dword ptr [EBX + 0x14]
004645d6 : MOV EAX,dword ptr [EBX + 0x18]
004645d9 : MOV dword ptr [EBP + -0xc],EDX
004645dc : MOV dword ptr [EBP + -0x8],EDX
004645df : MOV dword ptr [EBP + -0x10],EAX
004645e2 : JMP 0x004645e7
004645e4 : MOV EDX,dword ptr [EBP + -0x8]
004645e7 : CMP dword ptr [ECX + 0x24],0x8
004645eb : MOV ESI,dword ptr [ECX + 0x20]
004645ee : MOV dword ptr [EBP + -0x14],ECX
004645f1 : JC 0x004645f8
004645f3 : MOV EAX,dword ptr [ECX + 0x10]
004645f6 : JMP 0x004645fb
004645f8 : LEA EAX,[ECX + 0x10]
004645fb : MOV EDI,dword ptr [EBP + -0xc]
004645fe : CMP EDX,EDI
00464600 : CMOVC EDI,EDX
00464603 : CMP EDI,ESI
00464605 : JNC 0x00464609
00464607 : MOV ESI,EDI
00464609 : CMP dword ptr [EBP + -0x10],0x8
0046460d : JC 0x00464614
0046460f : MOV EDX,dword ptr [EBX + 0x4]
00464612 : JMP 0x00464617
00464614 : LEA EDX,[EBX + 0x4]
00464617 : TEST ESI,ESI
00464619 : JBE 0x00464636
0046461b : JMP 0x00464620
00464620 : MOV BX,word ptr [EDX]
00464623 : CMP BX,word ptr [EAX]
00464626 : JNZ 0x00464642
00464628 : ADD EDX,0x2
0046462b : ADD EAX,0x2
0046462e : SUB ESI,0x1
00464631 : JNZ 0x00464620
00464633 : MOV EBX,dword ptr [EBP + 0x10]
00464636 : MOV EAX,dword ptr [ECX + 0x20]
00464639 : CMP EDI,EAX
0046463b : JNC 0x00464657
0046463d : OR EAX,0xffffffff
00464640 : JMP 0x00464660
00464642 : MOV DX,BX
00464645 : CMP DX,word ptr [EAX]
00464648 : SBB EAX,EAX
0046464a : AND EAX,0xfffffffe
0046464d : ADD EAX,0x1
00464650 : JZ 0x00464633
00464652 : MOV EBX,dword ptr [EBP + 0x10]
00464655 : JMP 0x00464660
00464657 : XOR EDX,EDX
00464659 : CMP EDI,EAX
0046465b : SETNZ DL
0046465e : MOV EAX,EDX
00464660 : TEST EAX,EAX
00464662 : SETL AL
00464665 : MOV byte ptr [EBP + -0x4],AL
00464668 : TEST AL,AL
0046466a : JZ 0x00464670
0046466c : MOV ECX,dword ptr [ECX]
0046466e : JMP 0x00464673
00464670 : MOV ECX,dword ptr [ECX + 0x8]
00464673 : CMP byte ptr [ECX + 0x2d],0x0
00464677 : JZ 0x004645e4
0046467d : MOV EAX,dword ptr [EBP + -0x14]
00464680 : MOV ECX,dword ptr [EBP + -0x4]
00464683 : MOV EDI,dword ptr [EBP + 0x8]
00464686 : PUSH EBX
00464687 : PUSH ECX
00464688 : LEA EDX,[EBP + 0x10]
0046468b : PUSH EDX
0046468c : MOV ECX,EAX
0046468e : CALL 0x0042faf0
00464693 : MOV ECX,dword ptr [EAX]
00464695 : MOV EAX,dword ptr [EBP + 0xc]
00464698 : POP EDI
00464699 : POP ESI
0046469a : MOV dword ptr [EAX],ECX
0046469c : MOV byte ptr [EAX + 0x4],0x1
004646a0 : POP EBX
004646a1 : MOV ESP,EBP
004646a3 : POP EBP
004646a4 : RET 0xc

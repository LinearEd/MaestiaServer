PROGRAM  : Maestia.exe
FUNCTION : FUN_00404350
ENTRY    : 00404350
BODY     : [[00404350, 004043fa]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_00404350(LPCSTR param_1)

{
  int iVar1;
  WCHAR local_4014 [8191];
  undefined2 local_16;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7c642;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar1 = MultiByteToWideChar(0,0,param_1,-1,local_4014,0x2000);
  if (iVar1 == 0) {
    FUN_00406460(&DAT_00cca49c);
  }
  else {
    local_16 = 0;
    FUN_00406460(local_4014);
  }
  local_8 = 0;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00404350 : PUSH EBP
00404351 : MOV EBP,ESP
00404353 : PUSH -0x1
00404355 : PUSH 0xb7c642
0040435a : MOV EAX,FS:[0x0]
00404360 : PUSH EAX
00404361 : MOV EAX,0x400c
00404366 : CALL 0x0063b780
0040436b : MOV EAX,[0x00d66fa0]
00404370 : XOR EAX,EBP
00404372 : MOV dword ptr [EBP + -0x10],EAX
00404375 : PUSH EAX
00404376 : LEA EAX,[EBP + -0xc]
00404379 : MOV FS:[0x0],EAX
0040437f : MOV EAX,dword ptr [EBP + 0x8]
00404382 : PUSH 0x2000
00404387 : LEA ECX,[EBP + 0xffffbff0]
0040438d : PUSH ECX
0040438e : PUSH -0x1
00404390 : PUSH EAX
00404391 : PUSH 0x0
00404393 : PUSH 0x0
00404395 : MOV dword ptr [EBP + 0xffffbfe8],ESI
0040439b : MOV dword ptr [EBP + 0xffffbfec],0x0
004043a5 : CALL dword ptr [0x00b850e0]
004043ab : MOV ECX,ESI
004043ad : TEST EAX,EAX
004043af : JZ 0x004043c5
004043b1 : LEA EAX,[EBP + 0xffffbff0]
004043b7 : XOR EDX,EDX
004043b9 : PUSH EAX
004043ba : MOV word ptr [EBP + -0x12],DX
004043be : CALL 0x00406460
004043c3 : JMP 0x004043cf
004043c5 : PUSH 0xcca49c
004043ca : CALL 0x00406460
004043cf : MOV dword ptr [EBP + -0x4],0x0
004043d6 : MOV dword ptr [EBP + 0xffffbfec],0x1
004043e0 : MOV EAX,ESI
004043e2 : MOV ECX,dword ptr [EBP + -0xc]
004043e5 : MOV dword ptr FS:[0x0],ECX
004043ec : POP ECX
004043ed : MOV ECX,dword ptr [EBP + -0x10]
004043f0 : XOR ECX,EBP
004043f2 : CALL 0x00633e6b
004043f7 : MOV ESP,EBP
004043f9 : POP EBP
004043fa : RET

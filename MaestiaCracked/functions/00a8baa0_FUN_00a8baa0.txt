PROGRAM  : Maestia.exe
FUNCTION : FUN_00a8baa0
ENTRY    : 00a8baa0
BODY     : [[00a8baa0, 00a8bdd0]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x00a8bc6d) */
/* WARNING: Removing unreachable block (ram,0x00a8bc4b) */

void FUN_00a8baa0(int *param_1,int param_2)

{
  char cVar1;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  int *piVar5;
  undefined4 ***pppuVar6;
  uint local_6c;
  uint local_50;
  undefined1 local_4c [4];
  undefined2 local_48;
  undefined4 local_38;
  uint local_34;
  undefined4 **local_2c [4];
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1f183;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_14 = uVar2;
  if (param_1[0x21] != 3 - param_2) {
    param_1[0x21] = 3 - param_2;
    FUN_00406460(&DAT_00c69fa0);
    local_8 = 0;
    if (param_1[0x21] < 1) {
      *(undefined1 *)(param_1 + 0x22) = 0;
      *(undefined1 *)(param_1 + 0x19) = 0;
      FUN_00406360(&DAT_00c6a02c,0);
      iVar3 = *DAT_00da9894;
      if ((iVar3 != 0) && (*(int *)(iVar3 + 0x114) != 0)) {
        (**(code **)(**(int **)(iVar3 + 0x114) + 4))
                  (*(int **)(iVar3 + 0x114),"RegenWaitingTime",&DAT_00c6a030,0,uVar2);
      }
      if (*(int *)(*DAT_00da9894 + 0x118) != 0) {
        (**(code **)**(undefined4 **)(*DAT_00da9894 + 0x118))("NoticeDlgClose");
      }
      if ((*(int *)(DAT_0172491c + 0x17c) != 0) && (cVar1 = FUN_008896f0(), cVar1 == '\0')) {
        (**(code **)(*param_1 + 0x20))();
      }
    }
    else {
      *(undefined1 *)(param_1 + 0x22) = 1;
      FUN_00406460(L"IDS_KILLED_BY_USER");
      local_8._0_1_ = 1;
      iVar3 = FUN_0081d120(local_4c);
      local_8._0_1_ = 2;
      if ((uint)param_1[0x20] < 8) {
        piVar5 = param_1 + 0x1b;
      }
      else {
        piVar5 = (int *)param_1[0x1b];
      }
      if (*(uint *)(iVar3 + 0x18) < 8) {
        iVar3 = iVar3 + 4;
      }
      else {
        iVar3 = *(int *)(iVar3 + 4);
      }
      uVar4 = FUN_00404750(iVar3,piVar5);
      local_8._0_1_ = 3;
      FUN_00405eb0(uVar4,0,0xffffffff);
      local_8 = CONCAT31(local_8._1_3_,2);
      if (7 < local_50) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_8 = CONCAT31(local_8._1_3_,1);
      if (7 < local_6c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_8._0_1_ = 0;
      if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_38 = 0;
      local_34 = 7;
      local_48 = 0;
      FUN_00404870(&DAT_00c69fcc,1);
      FUN_00406460(L"IDS_CHAR_REGEN_WAITING_TIME");
      local_8._0_1_ = 4;
      iVar3 = FUN_0081d120(local_4c);
      local_8._0_1_ = 5;
      if (*(uint *)(iVar3 + 0x18) < 8) {
        iVar3 = iVar3 + 4;
      }
      else {
        iVar3 = *(int *)(iVar3 + 4);
      }
      uVar4 = FUN_00404750(iVar3,param_1[0x21]);
      local_8._0_1_ = 6;
      FUN_00405c30(uVar4,0,0xffffffff);
      local_8 = (uint)local_8._1_3_ << 8;
      if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_34 = 7;
      local_38 = 0;
      local_48 = 0;
      if (*(int *)(*DAT_00da9894 + 0x118) != 0) {
        piVar5 = *(int **)(*DAT_00da9894 + 0x118);
        pppuVar6 = (undefined4 ***)local_2c[0];
        if (local_18 < 8) {
          pppuVar6 = local_2c;
        }
        (**(code **)(*piVar5 + 4))(piVar5,"SetNoticeText",&DAT_00c6a008,pppuVar6);
        (**(code **)**(undefined4 **)(*DAT_00da9894 + 0x118))("NoticeDlgOpen");
      }
    }
    local_8 = 0xffffffff;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c[0] = (undefined4 **)((uint)local_2c[0] & 0xffff0000);
  }
  local_8 = 0xffffffff;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a8baa0 : PUSH EBP
00a8baa1 : MOV EBP,ESP
00a8baa3 : PUSH -0x1
00a8baa5 : PUSH 0xb1f183
00a8baaa : MOV EAX,FS:[0x0]
00a8bab0 : PUSH EAX
00a8bab1 : SUB ESP,0x74
00a8bab4 : MOV EAX,[0x00d66fa0]
00a8bab9 : XOR EAX,EBP
00a8babb : MOV dword ptr [EBP + -0x10],EAX
00a8babe : PUSH EBX
00a8babf : PUSH ESI
00a8bac0 : PUSH EDI
00a8bac1 : PUSH EAX
00a8bac2 : LEA EAX,[EBP + -0xc]
00a8bac5 : MOV FS:[0x0],EAX
00a8bacb : MOV EBX,dword ptr [EBP + 0x8]
00a8bace : MOV EAX,0x3
00a8bad3 : SUB EAX,dword ptr [EBP + 0xc]
00a8bad6 : CMP dword ptr [EBX + 0x84],EAX
00a8badc : JZ 0x00a8bdb3
00a8bae2 : PUSH 0xc69fa0
00a8bae7 : LEA ECX,[EBP + -0x2c]
00a8baea : MOV dword ptr [EBX + 0x84],EAX
00a8baf0 : CALL 0x00406460
00a8baf5 : MOV dword ptr [EBP + -0x4],0x0
00a8bafc : CMP dword ptr [EBX + 0x84],0x0
00a8bb03 : JLE 0x00a8bcf5
00a8bb09 : PUSH 0xc69fa4
00a8bb0e : LEA ECX,[EBP + -0x48]
00a8bb11 : MOV byte ptr [EBX + 0x88],0x1
00a8bb18 : CALL 0x00406460
00a8bb1d : MOV byte ptr [EBP + -0x4],0x1
00a8bb21 : MOV ECX,dword ptr [0x0172491c]
00a8bb27 : LEA EAX,[EBP + -0x48]
00a8bb2a : PUSH EAX
00a8bb2b : LEA EDI,[EBP + -0x80]
00a8bb2e : CALL 0x0081d120
00a8bb33 : MOV byte ptr [EBP + -0x4],0x2
00a8bb37 : MOV EDI,0x8
00a8bb3c : CMP dword ptr [EBX + 0x80],EDI
00a8bb42 : JC 0x00a8bb49
00a8bb44 : MOV ECX,dword ptr [EBX + 0x6c]
00a8bb47 : JMP 0x00a8bb4c
00a8bb49 : LEA ECX,[EBX + 0x6c]
00a8bb4c : CMP dword ptr [EAX + 0x18],EDI
00a8bb4f : JC 0x00a8bb56
00a8bb51 : MOV EAX,dword ptr [EAX + 0x4]
00a8bb54 : JMP 0x00a8bb59
00a8bb56 : ADD EAX,0x4
00a8bb59 : PUSH ECX
00a8bb5a : PUSH EAX
00a8bb5b : LEA ESI,[EBP + -0x64]
00a8bb5e : CALL 0x00404750
00a8bb63 : ADD ESP,0x8
00a8bb66 : MOV byte ptr [EBP + -0x4],0x3
00a8bb6a : PUSH -0x1
00a8bb6c : XOR ESI,ESI
00a8bb6e : PUSH ESI
00a8bb6f : PUSH EAX
00a8bb70 : LEA ECX,[EBP + -0x2c]
00a8bb73 : CALL 0x00405eb0
00a8bb78 : MOV byte ptr [EBP + -0x4],0x2
00a8bb7c : CMP dword ptr [EBP + -0x4c],EDI
00a8bb7f : JC 0x00a8bb89
00a8bb81 : MOV ECX,dword ptr [EBP + -0x60]
00a8bb84 : CALL 0x006f04e0
00a8bb89 : MOV EDI,0x7
00a8bb8e : XOR ECX,ECX
00a8bb90 : MOV dword ptr [EBP + -0x4c],EDI
00a8bb93 : MOV dword ptr [EBP + -0x50],ESI
00a8bb96 : MOV word ptr [EBP + -0x60],CX
00a8bb9a : MOV byte ptr [EBP + -0x4],0x1
00a8bb9e : CMP dword ptr [EBP + -0x68],0x8
00a8bba2 : JC 0x00a8bbac
00a8bba4 : MOV ECX,dword ptr [EBP + -0x7c]
00a8bba7 : CALL 0x006f04e0
00a8bbac : XOR EDX,EDX
00a8bbae : MOV dword ptr [EBP + -0x68],EDI
00a8bbb1 : MOV dword ptr [EBP + -0x6c],ESI
00a8bbb4 : MOV word ptr [EBP + -0x7c],DX
00a8bbb8 : MOV byte ptr [EBP + -0x4],DL
00a8bbbb : CMP dword ptr [EBP + -0x30],0x8
00a8bbbf : JC 0x00a8bbc9
00a8bbc1 : MOV ECX,dword ptr [EBP + -0x44]
00a8bbc4 : CALL 0x006f04e0
00a8bbc9 : PUSH 0x1
00a8bbcb : XOR EAX,EAX
00a8bbcd : MOV dword ptr [EBP + -0x34],ESI
00a8bbd0 : PUSH 0xc69fcc
00a8bbd5 : LEA ESI,[EBP + -0x2c]
00a8bbd8 : MOV dword ptr [EBP + -0x30],EDI
00a8bbdb : MOV word ptr [EBP + -0x44],AX
00a8bbdf : CALL 0x00404870
00a8bbe4 : PUSH 0xc69fd0
00a8bbe9 : LEA ECX,[EBP + -0x48]
00a8bbec : CALL 0x00406460
00a8bbf1 : MOV byte ptr [EBP + -0x4],0x4
00a8bbf5 : LEA ECX,[EBP + -0x48]
00a8bbf8 : PUSH ECX
00a8bbf9 : MOV ECX,dword ptr [0x0172491c]
00a8bbff : LEA EDI,[EBP + -0x64]
00a8bc02 : CALL 0x0081d120
00a8bc07 : MOV byte ptr [EBP + -0x4],0x5
00a8bc0b : MOV EDI,0x8
00a8bc10 : CMP dword ptr [EAX + 0x18],EDI
00a8bc13 : JC 0x00a8bc1a
00a8bc15 : MOV EAX,dword ptr [EAX + 0x4]
00a8bc18 : JMP 0x00a8bc1d
00a8bc1a : ADD EAX,0x4
00a8bc1d : MOV EDX,dword ptr [EBX + 0x84]
00a8bc23 : PUSH EDX
00a8bc24 : PUSH EAX
00a8bc25 : LEA ESI,[EBP + -0x80]
00a8bc28 : CALL 0x00404750
00a8bc2d : ADD ESP,0x8
00a8bc30 : MOV byte ptr [EBP + -0x4],0x6
00a8bc34 : PUSH -0x1
00a8bc36 : XOR ESI,ESI
00a8bc38 : PUSH ESI
00a8bc39 : PUSH EAX
00a8bc3a : LEA ECX,[EBP + -0x2c]
00a8bc3d : CALL 0x00405c30
00a8bc42 : MOV byte ptr [EBP + -0x4],0x5
00a8bc46 : CMP dword ptr [EBP + -0x68],EDI
00a8bc49 : JC 0x00a8bc53
00a8bc4b : MOV ECX,dword ptr [EBP + -0x7c]
00a8bc4e : CALL 0x006f04e0
00a8bc53 : MOV EBX,0x7
00a8bc58 : XOR EAX,EAX
00a8bc5a : MOV dword ptr [EBP + -0x68],EBX
00a8bc5d : MOV dword ptr [EBP + -0x6c],ESI
00a8bc60 : MOV word ptr [EBP + -0x7c],AX
00a8bc64 : MOV byte ptr [EBP + -0x4],0x4
00a8bc68 : CMP dword ptr [EBP + -0x4c],EDI
00a8bc6b : JC 0x00a8bc75
00a8bc6d : MOV ECX,dword ptr [EBP + -0x60]
00a8bc70 : CALL 0x006f04e0
00a8bc75 : XOR ECX,ECX
00a8bc77 : MOV dword ptr [EBP + -0x4c],EBX
00a8bc7a : MOV dword ptr [EBP + -0x50],ESI
00a8bc7d : MOV word ptr [EBP + -0x60],CX
00a8bc81 : MOV byte ptr [EBP + -0x4],CL
00a8bc84 : CMP dword ptr [EBP + -0x30],EDI
00a8bc87 : JC 0x00a8bc91
00a8bc89 : MOV ECX,dword ptr [EBP + -0x44]
00a8bc8c : CALL 0x006f04e0
00a8bc91 : MOV EAX,[0x00da9894]
00a8bc96 : XOR EDX,EDX
00a8bc98 : MOV dword ptr [EBP + -0x30],EBX
00a8bc9b : MOV dword ptr [EBP + -0x34],ESI
00a8bc9e : MOV word ptr [EBP + -0x44],DX
00a8bca2 : MOV EAX,dword ptr [EAX]
00a8bca4 : CMP dword ptr [EAX + 0x118],ESI
00a8bcaa : JZ 0x00a8bd8f
00a8bcb0 : MOV EAX,dword ptr [EAX + 0x118]
00a8bcb6 : MOV ECX,dword ptr [EBP + -0x28]
00a8bcb9 : CMP dword ptr [EBP + -0x14],EDI
00a8bcbc : JNC 0x00a8bcc1
00a8bcbe : LEA ECX,[EBP + -0x28]
00a8bcc1 : MOV EDX,dword ptr [EAX]
00a8bcc3 : PUSH ECX
00a8bcc4 : PUSH 0xc6a008
00a8bcc9 : PUSH 0xc6a00c
00a8bcce : PUSH EAX
00a8bccf : MOV EAX,dword ptr [EDX + 0x4]
00a8bcd2 : CALL EAX
00a8bcd4 : MOV ECX,dword ptr [0x00da9894]
00a8bcda : MOV EAX,dword ptr [ECX]
00a8bcdc : MOV ECX,dword ptr [EAX + 0x118]
00a8bce2 : MOV EDX,dword ptr [ECX]
00a8bce4 : MOV EAX,dword ptr [EDX]
00a8bce6 : ADD ESP,0x10
00a8bce9 : PUSH 0xc6a01c
00a8bcee : CALL EAX
00a8bcf0 : JMP 0x00a8bd8f
00a8bcf5 : PUSH 0x0
00a8bcf7 : PUSH 0xc6a02c
00a8bcfc : LEA ECX,[EBX + 0x68]
00a8bcff : MOV byte ptr [EBX + 0x88],0x0
00a8bd06 : MOV byte ptr [EBX + 0x64],0x0
00a8bd0a : CALL 0x00406360
00a8bd0f : MOV ECX,dword ptr [0x00da9894]
00a8bd15 : MOV EAX,dword ptr [ECX]
00a8bd17 : TEST EAX,EAX
00a8bd19 : JZ 0x00a8bd41
00a8bd1b : CMP dword ptr [EAX + 0x114],0x0
00a8bd22 : JZ 0x00a8bd41
00a8bd24 : MOV EAX,dword ptr [EAX + 0x114]
00a8bd2a : MOV EDX,dword ptr [EAX]
00a8bd2c : PUSH 0x0
00a8bd2e : PUSH 0xc6a030
00a8bd33 : PUSH 0xc6a034
00a8bd38 : PUSH EAX
00a8bd39 : MOV EAX,dword ptr [EDX + 0x4]
00a8bd3c : CALL EAX
00a8bd3e : ADD ESP,0x10
00a8bd41 : MOV ECX,dword ptr [0x00da9894]
00a8bd47 : MOV EAX,dword ptr [ECX]
00a8bd49 : CMP dword ptr [EAX + 0x118],0x0
00a8bd50 : JZ 0x00a8bd65
00a8bd52 : MOV EAX,dword ptr [EAX + 0x118]
00a8bd58 : MOV EDX,dword ptr [EAX]
00a8bd5a : MOV ECX,EAX
00a8bd5c : MOV EAX,dword ptr [EDX]
00a8bd5e : PUSH 0xc6a048
00a8bd63 : CALL EAX
00a8bd65 : MOV ECX,dword ptr [0x0172491c]
00a8bd6b : MOV EAX,dword ptr [ECX + 0x17c]
00a8bd71 : TEST EAX,EAX
00a8bd73 : JZ 0x00a8bd87
00a8bd75 : CALL 0x008896f0
00a8bd7a : TEST AL,AL
00a8bd7c : JNZ 0x00a8bd87
00a8bd7e : MOV EDX,dword ptr [EBX]
00a8bd80 : MOV EAX,dword ptr [EDX + 0x20]
00a8bd83 : MOV ECX,EBX
00a8bd85 : CALL EAX
00a8bd87 : MOV EDI,0x8
00a8bd8c : LEA EBX,[EDI + -0x1]
00a8bd8f : MOV dword ptr [EBP + -0x4],0xffffffff
00a8bd96 : CMP dword ptr [EBP + -0x14],EDI
00a8bd99 : JC 0x00a8bda3
00a8bd9b : MOV ECX,dword ptr [EBP + -0x28]
00a8bd9e : CALL 0x006f04e0
00a8bda3 : XOR ECX,ECX
00a8bda5 : MOV dword ptr [EBP + -0x14],EBX
00a8bda8 : MOV dword ptr [EBP + -0x18],0x0
00a8bdaf : MOV word ptr [EBP + -0x28],CX
00a8bdb3 : MOV ECX,dword ptr [EBP + -0xc]
00a8bdb6 : MOV dword ptr FS:[0x0],ECX
00a8bdbd : POP ECX
00a8bdbe : POP EDI
00a8bdbf : POP ESI
00a8bdc0 : POP EBX
00a8bdc1 : MOV ECX,dword ptr [EBP + -0x10]
00a8bdc4 : XOR ECX,EBP
00a8bdc6 : CALL 0x00633e6b
00a8bdcb : MOV ESP,EBP
00a8bdcd : POP EBP
00a8bdce : RET 0x8

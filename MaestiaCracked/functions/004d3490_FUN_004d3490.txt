PROGRAM  : Maestia.exe
FUNCTION : FUN_004d3490
ENTRY    : 004d3490
BODY     : [[004d3490, 004d3751]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_004d3490(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
                 int param_5,undefined4 param_6,char *param_7,uint param_8)

{
  rsize_t _DstSize;
  char *_Src;
  char cVar1;
  undefined4 uVar2;
  undefined1 uVar3;
  uint uVar4;
  undefined4 uVar5;
  undefined4 *puVar6;
  char ****ppppcVar7;
  int iVar8;
  undefined1 auStack_5c [4];
  char *local_58;
  int iStack_54;
  char ***apppcStack_50 [2];
  int local_48;
  int *local_44;
  undefined4 local_40;
  int local_3c;
  undefined1 local_38 [4];
  char ***apppcStack_34 [4];
  undefined4 uStack_24;
  uint uStack_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b811e0;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_5c;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xffffff98;
  ExceptionList = &local_14;
  local_40 = param_2;
  local_48 = param_5;
  local_58 = param_7;
  uVar5 = FUN_004d0b70(&local_3c);
  local_c = 0;
  local_44 = (int *)FUN_004d4090(uVar5,uVar4);
  local_c = 0xffffffff;
  if ((local_3c != 0) && (puVar6 = (undefined4 *)FUN_00451810(), puVar6 != (undefined4 *)0x0)) {
    (**(code **)*puVar6)(1);
  }
  FUN_004d3c20(local_38);
  local_c = 1;
  cVar1 = *param_7;
  if ((cVar1 == '+') || (cVar1 == '-')) {
    iStack_54 = 1;
  }
  else if ((cVar1 == '0') && ((param_7[1] == 'x' || (param_7[1] == 'X')))) {
    iStack_54 = 2;
  }
  else {
    iStack_54 = 0;
  }
  ppppcVar7 = (char ****)apppcStack_34[0];
  if (uStack_20 < 0x10) {
    ppppcVar7 = apppcStack_34;
  }
  if (*(char *)ppppcVar7 != '\x7f') {
    ppppcVar7 = (char ****)apppcStack_34[0];
    if (uStack_20 < 0x10) {
      ppppcVar7 = apppcStack_34;
    }
    if ('\0' < *(char *)ppppcVar7) {
      apppcStack_50[0] = apppcStack_34[0];
      if (uStack_20 < 0x10) {
        apppcStack_50[0] = (char ***)apppcStack_34;
      }
      cVar1 = *(char *)apppcStack_50[0];
      param_5 = local_48;
      uVar4 = param_8;
      while (((local_48 = param_5, cVar1 != '\x7f' && ('\0' < cVar1)) &&
             ((uint)(int)cVar1 < uVar4 - iStack_54))) {
        uVar4 = uVar4 - (int)cVar1;
        _DstSize = (param_8 - uVar4) + 1;
        _Src = local_58 + uVar4;
        _memmove_s(local_58 + uVar4 + 1,_DstSize,_Src,_DstSize);
        *_Src = '\0';
        param_8 = param_8 + 1;
        if ('\0' < *(char *)((int)apppcStack_50[0] + 1)) {
          apppcStack_50[0] = (char ***)((int)apppcStack_50[0] + 1);
        }
        param_5 = local_48;
        cVar1 = *(char *)apppcStack_50[0];
      }
    }
  }
  uVar4 = *(uint *)(param_5 + 0x18);
  if (((int)uVar4 < 1) || (uVar4 <= param_8)) {
    iVar8 = 0;
  }
  else {
    iVar8 = uVar4 - param_8;
  }
  uVar4 = *(uint *)(param_5 + 0x10) & 0x1c0;
  if (uVar4 != 0x40) {
    if (uVar4 == 0x100) {
      puVar6 = (undefined4 *)FUN_004d3760(param_1,apppcStack_50,param_3,param_4,local_58,iStack_54);
      local_58 = local_58 + iStack_54;
      param_8 = param_8 - iStack_54;
      puVar6 = (undefined4 *)FUN_004d37d0(param_1,apppcStack_50,*puVar6,puVar6[1],param_6,iVar8);
      param_3 = *puVar6;
      param_4 = puVar6[1];
    }
    else {
      puVar6 = (undefined4 *)FUN_004d37d0(param_1,apppcStack_50,param_3,param_4,param_6,iVar8);
      param_3 = *puVar6;
      param_4 = puVar6[1];
    }
    iVar8 = 0;
  }
  uVar3 = (**(code **)(*local_44 + 8))();
  local_44 = (int *)CONCAT31(local_44._1_3_,uVar3);
  puVar6 = (undefined4 *)
           FUN_004d3b50(param_1,apppcStack_50,param_3,param_4,local_58,param_8,local_44);
  uVar5 = *puVar6;
  uVar2 = puVar6[1];
  *(undefined4 *)(local_48 + 0x18) = 0;
  FUN_004d37d0(param_1,local_40,uVar5,uVar2,param_6,iVar8);
  local_c = 0xffffffff;
  if (0xf < uStack_20) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  uStack_20 = 0xf;
  uStack_24 = 0;
  apppcStack_34[0] = (char ***)((uint)apppcStack_34[0] & 0xffffff00);
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_5c);
  return;
}



============================================================
DISASSEMBLY
============================================================
004d3490 : PUSH EBP
004d3491 : MOV EBP,ESP
004d3493 : AND ESP,0xfffffff8
004d3496 : PUSH -0x1
004d3498 : PUSH 0xb811e0
004d349d : MOV EAX,FS:[0x0]
004d34a3 : PUSH EAX
004d34a4 : SUB ESP,0x48
004d34a7 : MOV EAX,[0x00d66fa0]
004d34ac : XOR EAX,ESP
004d34ae : MOV dword ptr [ESP + 0x40],EAX
004d34b2 : PUSH EBX
004d34b3 : PUSH ESI
004d34b4 : PUSH EDI
004d34b5 : MOV EAX,[0x00d66fa0]
004d34ba : XOR EAX,ESP
004d34bc : PUSH EAX
004d34bd : LEA EAX,[ESP + 0x58]
004d34c1 : MOV FS:[0x0],EAX
004d34c7 : MOV ESI,dword ptr [EBP + 0x18]
004d34ca : MOV EAX,dword ptr [EBP + 0xc]
004d34cd : MOV EDI,dword ptr [EBP + 0x20]
004d34d0 : LEA ECX,[ESP + 0x30]
004d34d4 : PUSH ECX
004d34d5 : MOV ECX,ESI
004d34d7 : MOV dword ptr [ESP + 0x30],EAX
004d34db : MOV dword ptr [ESP + 0x28],ESI
004d34df : MOV dword ptr [ESP + 0x18],EDI
004d34e3 : CALL 0x004d0b70
004d34e8 : MOV dword ptr [ESP + 0x60],0x0
004d34f0 : PUSH EAX
004d34f1 : CALL 0x004d4090
004d34f6 : MOV EBX,EAX
004d34f8 : ADD ESP,0x4
004d34fb : MOV dword ptr [ESP + 0x28],EBX
004d34ff : MOV dword ptr [ESP + 0x60],0xffffffff
004d3507 : MOV ECX,dword ptr [ESP + 0x30]
004d350b : TEST ECX,ECX
004d350d : JZ 0x004d3522
004d350f : CALL 0x00451810
004d3514 : TEST EAX,EAX
004d3516 : JZ 0x004d3522
004d3518 : MOV EDX,dword ptr [EAX]
004d351a : MOV ECX,EAX
004d351c : MOV EAX,dword ptr [EDX]
004d351e : PUSH 0x1
004d3520 : CALL EAX
004d3522 : LEA ECX,[ESP + 0x34]
004d3526 : PUSH ECX
004d3527 : MOV ECX,EBX
004d3529 : CALL 0x004d3c20
004d352e : MOV ECX,0x1
004d3533 : MOV dword ptr [ESP + 0x60],ECX
004d3537 : MOV AL,byte ptr [EDI]
004d3539 : CMP AL,0x2b
004d353b : JZ 0x004d3564
004d353d : CMP AL,0x2d
004d353f : JZ 0x004d3564
004d3541 : CMP AL,0x30
004d3543 : JNZ 0x004d355a
004d3545 : MOV AL,byte ptr [EDI + 0x1]
004d3548 : CMP AL,0x78
004d354a : JZ 0x004d3550
004d354c : CMP AL,0x58
004d354e : JNZ 0x004d355a
004d3550 : MOV dword ptr [ESP + 0x18],0x2
004d3558 : JMP 0x004d3568
004d355a : MOV dword ptr [ESP + 0x18],0x0
004d3562 : JMP 0x004d3568
004d3564 : MOV dword ptr [ESP + 0x18],ECX
004d3568 : MOV ECX,dword ptr [ESP + 0x4c]
004d356c : MOV EDX,dword ptr [ESP + 0x38]
004d3570 : MOV EAX,EDX
004d3572 : CMP ECX,0x10
004d3575 : JNC 0x004d357b
004d3577 : LEA EAX,[ESP + 0x38]
004d357b : CMP byte ptr [EAX],0x7f
004d357e : JZ 0x004d360d
004d3584 : MOV EAX,EDX
004d3586 : CMP ECX,0x10
004d3589 : JNC 0x004d358f
004d358b : LEA EAX,[ESP + 0x38]
004d358f : CMP byte ptr [EAX],0x0
004d3592 : JLE 0x004d360d
004d3594 : CMP ECX,0x10
004d3597 : JNC 0x004d359d
004d3599 : LEA EDX,[ESP + 0x38]
004d359d : MOV EBX,dword ptr [EBP + 0x24]
004d35a0 : MOV EAX,EDX
004d35a2 : MOV AL,byte ptr [EAX]
004d35a4 : MOV dword ptr [ESP + 0x1c],EDX
004d35a8 : MOV ESI,EBX
004d35aa : CMP AL,0x7f
004d35ac : JZ 0x004d35fa
004d35ae : TEST AL,AL
004d35b0 : JLE 0x004d35fa
004d35b2 : MOV ECX,ESI
004d35b4 : SUB ECX,dword ptr [ESP + 0x18]
004d35b8 : MOVSX EAX,AL
004d35bb : CMP EAX,ECX
004d35bd : JNC 0x004d35fa
004d35bf : MOV ECX,dword ptr [ESP + 0x14]
004d35c3 : SUB ESI,EAX
004d35c5 : MOV EDX,EBX
004d35c7 : SUB EDX,ESI
004d35c9 : LEA EAX,[EDX + 0x1]
004d35cc : PUSH EAX
004d35cd : LEA EDI,[ECX + ESI*0x1]
004d35d0 : PUSH EDI
004d35d1 : PUSH EAX
004d35d2 : MOV EDX,ECX
004d35d4 : LEA EAX,[EDX + ESI*0x1 + 0x1]
004d35d8 : PUSH EAX
004d35d9 : CALL 0x00634101
004d35de : MOV EAX,dword ptr [ESP + 0x2c]
004d35e2 : ADD ESP,0x10
004d35e5 : MOV byte ptr [EDI],0x0
004d35e8 : INC EBX
004d35e9 : CMP byte ptr [EAX + 0x1],0x0
004d35ed : JLE 0x004d35f4
004d35ef : INC EAX
004d35f0 : MOV dword ptr [ESP + 0x1c],EAX
004d35f4 : MOV AL,byte ptr [EAX]
004d35f6 : CMP AL,0x7f
004d35f8 : JNZ 0x004d35ae
004d35fa : MOV ESI,dword ptr [ESP + 0x24]
004d35fe : MOV EDI,dword ptr [ESI + 0x18]
004d3601 : TEST EDI,EDI
004d3603 : JLE 0x004d3612
004d3605 : CMP EDI,EBX
004d3607 : JBE 0x004d3612
004d3609 : SUB EDI,EBX
004d360b : JMP 0x004d3614
004d360d : MOV EBX,dword ptr [EBP + 0x24]
004d3610 : JMP 0x004d35fe
004d3612 : XOR EDI,EDI
004d3614 : MOV EAX,dword ptr [ESI + 0x10]
004d3617 : MOV ESI,dword ptr [EBP + 0x8]
004d361a : AND EAX,0x1c0
004d361f : CMP EAX,0x40
004d3622 : JZ 0x004d36b0
004d3628 : CMP EAX,0x100
004d362d : JZ 0x004d3657
004d362f : MOV ECX,dword ptr [EBP + 0x1c]
004d3632 : MOV EDX,dword ptr [EBP + 0x14]
004d3635 : MOV EAX,dword ptr [EBP + 0x10]
004d3638 : PUSH EDI
004d3639 : PUSH ECX
004d363a : PUSH EDX
004d363b : PUSH EAX
004d363c : LEA ECX,[ESP + 0x2c]
004d3640 : PUSH ECX
004d3641 : PUSH ESI
004d3642 : CALL 0x004d37d0
004d3647 : MOV EDX,dword ptr [EAX]
004d3649 : MOV dword ptr [EBP + 0x10],EDX
004d364c : MOV EAX,dword ptr [EAX + 0x4]
004d364f : ADD ESP,0x18
004d3652 : MOV dword ptr [EBP + 0x14],EAX
004d3655 : JMP 0x004d36ae
004d3657 : MOV ECX,dword ptr [ESP + 0x18]
004d365b : MOV EDX,dword ptr [ESP + 0x14]
004d365f : MOV EAX,dword ptr [EBP + 0x14]
004d3662 : PUSH ECX
004d3663 : MOV ECX,dword ptr [EBP + 0x10]
004d3666 : PUSH EDX
004d3667 : PUSH EAX
004d3668 : PUSH ECX
004d3669 : LEA EDX,[ESP + 0x2c]
004d366d : PUSH EDX
004d366e : PUSH ESI
004d366f : CALL 0x004d3760
004d3674 : MOV ECX,dword ptr [EAX]
004d3676 : MOV dword ptr [EBP + 0x10],ECX
004d3679 : MOV EDX,dword ptr [EAX + 0x4]
004d367c : MOV ECX,dword ptr [ESP + 0x30]
004d3680 : ADD dword ptr [ESP + 0x2c],ECX
004d3684 : MOV dword ptr [EBP + 0x14],EDX
004d3687 : MOV EDX,dword ptr [EBP + 0x1c]
004d368a : PUSH EDI
004d368b : PUSH EDX
004d368c : MOV EDX,dword ptr [EAX]
004d368e : SUB EBX,ECX
004d3690 : MOV ECX,dword ptr [EAX + 0x4]
004d3693 : PUSH ECX
004d3694 : PUSH EDX
004d3695 : LEA EAX,[ESP + 0x44]
004d3699 : PUSH EAX
004d369a : PUSH ESI
004d369b : CALL 0x004d37d0
004d36a0 : MOV ECX,dword ptr [EAX]
004d36a2 : MOV dword ptr [EBP + 0x10],ECX
004d36a5 : MOV EDX,dword ptr [EAX + 0x4]
004d36a8 : ADD ESP,0x30
004d36ab : MOV dword ptr [EBP + 0x14],EDX
004d36ae : XOR EDI,EDI
004d36b0 : MOV ECX,dword ptr [ESP + 0x28]
004d36b4 : MOV EAX,dword ptr [ECX]
004d36b6 : MOV EDX,dword ptr [EAX + 0x8]
004d36b9 : CALL EDX
004d36bb : MOV ECX,dword ptr [ESP + 0x14]
004d36bf : MOV EDX,dword ptr [EBP + 0x14]
004d36c2 : MOV byte ptr [ESP + 0x28],AL
004d36c6 : MOV EAX,dword ptr [ESP + 0x28]
004d36ca : PUSH EAX
004d36cb : MOV EAX,dword ptr [EBP + 0x10]
004d36ce : PUSH EBX
004d36cf : PUSH ECX
004d36d0 : PUSH EDX
004d36d1 : PUSH EAX
004d36d2 : LEA ECX,[ESP + 0x30]
004d36d6 : PUSH ECX
004d36d7 : PUSH ESI
004d36d8 : CALL 0x004d3b50
004d36dd : MOV ECX,dword ptr [EAX]
004d36df : MOV EDX,dword ptr [ESP + 0x40]
004d36e3 : ADD ESP,0x1c
004d36e6 : PUSH EDI
004d36e7 : MOV EDI,dword ptr [ESP + 0x30]
004d36eb : MOV dword ptr [EBP + 0x10],ECX
004d36ee : MOV EAX,dword ptr [EAX + 0x4]
004d36f1 : XOR EBX,EBX
004d36f3 : MOV dword ptr [EDX + 0x18],EBX
004d36f6 : MOV EDX,dword ptr [EBP + 0x1c]
004d36f9 : PUSH EDX
004d36fa : PUSH EAX
004d36fb : PUSH ECX
004d36fc : PUSH EDI
004d36fd : PUSH ESI
004d36fe : MOV dword ptr [EBP + 0x14],EAX
004d3701 : CALL 0x004d37d0
004d3706 : ADD ESP,0x18
004d3709 : MOV dword ptr [ESP + 0x60],0xffffffff
004d3711 : CMP dword ptr [ESP + 0x4c],0x10
004d3716 : JC 0x004d3721
004d3718 : MOV ECX,dword ptr [ESP + 0x38]
004d371c : CALL 0x006f04e0
004d3721 : MOV dword ptr [ESP + 0x4c],0xf
004d3729 : MOV dword ptr [ESP + 0x48],EBX
004d372d : MOV byte ptr [ESP + 0x38],0x0
004d3732 : MOV EAX,EDI
004d3734 : MOV ECX,dword ptr [ESP + 0x58]
004d3738 : MOV dword ptr FS:[0x0],ECX
004d373f : POP ECX
004d3740 : POP EDI
004d3741 : POP ESI
004d3742 : POP EBX
004d3743 : MOV ECX,dword ptr [ESP + 0x40]
004d3747 : XOR ECX,ESP
004d3749 : CALL 0x00633e6b
004d374e : MOV ESP,EBP
004d3750 : POP EBP
004d3751 : RET

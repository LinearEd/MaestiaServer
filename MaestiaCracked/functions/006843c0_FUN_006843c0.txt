PROGRAM  : Maestia.exe
FUNCTION : FUN_006843c0
ENTRY    : 006843c0
BODY     : [[006843c0, 006844a9] [006844b0, 00684503]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006843c0(undefined4 param_1,uint *param_2,uint param_3)

{
  uint *puVar1;
  uint *puVar2;
  int *piVar3;
  int iVar4;
  uint uVar5;
  int *in_ECX;
  uint uVar6;
  int iVar7;
  
  piVar3 = (int *)*in_ECX;
  if (piVar3 == (int *)0x0) {
    iVar7 = 8;
  }
  else {
    if ((uint)(*piVar3 * 5) <= piVar3[1] * 4 + 4U) goto LAB_006843fa;
    iVar7 = piVar3[1] * 2 + 2;
  }
  FUN_00684240(param_1,iVar7);
LAB_006843fa:
  piVar3 = (int *)*in_ECX;
  param_3 = param_3 & piVar3[1];
  *piVar3 = *piVar3 + 1;
  iVar7 = *in_ECX;
  iVar4 = *(int *)(iVar7 + 8 + param_3 * 0x14);
  puVar1 = (uint *)(iVar7 + 8 + param_3 * 0x14);
  if (iVar4 == -2) {
    *puVar1 = 0xffffffff;
    puVar1[2] = *param_2;
    puVar1[3] = param_2[1];
    puVar1[4] = param_2[2];
    puVar1[1] = param_3;
    return;
  }
  uVar6 = param_3;
  do {
    uVar6 = uVar6 + 1 & *(uint *)(iVar7 + 4);
  } while (*(int *)(iVar7 + 8 + uVar6 * 0x14) != -2);
  piVar3 = (int *)(iVar7 + 8 + uVar6 * 0x14);
  uVar5 = puVar1[1];
  if (uVar5 == param_3) {
    if (piVar3 != (int *)0x0) {
      *piVar3 = iVar4;
      piVar3[1] = puVar1[1];
      piVar3[2] = puVar1[2];
      piVar3[3] = puVar1[3];
      piVar3[4] = puVar1[4];
    }
    puVar1[2] = *param_2;
    puVar1[3] = param_2[1];
    puVar1[4] = param_2[2];
    *puVar1 = uVar6;
    puVar1[1] = param_3;
    return;
  }
  puVar2 = (uint *)(iVar7 + 8 + uVar5 * 0x14);
  for (uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x14); uVar5 != param_3;
      uVar5 = *(uint *)(iVar7 + 8 + uVar5 * 0x14)) {
    uVar5 = *puVar2;
    puVar2 = (uint *)(iVar7 + 8 + uVar5 * 0x14);
  }
  if (piVar3 != (int *)0x0) {
    *piVar3 = iVar4;
    piVar3[1] = puVar1[1];
    piVar3[2] = puVar1[2];
    piVar3[3] = puVar1[3];
    piVar3[4] = puVar1[4];
  }
  *puVar2 = uVar6;
  puVar1[2] = *param_2;
  puVar1[3] = param_2[1];
  puVar1[4] = param_2[2];
  *puVar1 = 0xffffffff;
  puVar1[1] = param_3;
  return;
}



============================================================
DISASSEMBLY
============================================================
006843c0 : PUSH EBP
006843c1 : PUSH ESI
006843c2 : MOV ESI,ECX
006843c4 : MOV EAX,dword ptr [ESI]
006843c6 : TEST EAX,EAX
006843c8 : JNZ 0x006843d3
006843ca : MOV EAX,dword ptr [ESP + 0xc]
006843ce : PUSH 0x8
006843d0 : PUSH EAX
006843d1 : JMP 0x006843f5
006843d3 : MOV ECX,dword ptr [EAX + 0x4]
006843d6 : LEA EDX,[ECX*0x4 + 0x4]
006843dd : MOV ECX,dword ptr [EAX]
006843df : LEA ECX,[ECX + ECX*0x4]
006843e2 : CMP ECX,EDX
006843e4 : JBE 0x006843fa
006843e6 : MOV EDX,dword ptr [EAX + 0x4]
006843e9 : MOV ECX,dword ptr [ESP + 0xc]
006843ed : LEA EAX,[EDX + EDX*0x1 + 0x2]
006843f1 : PUSH EAX
006843f2 : PUSH ECX
006843f3 : MOV ECX,ESI
006843f5 : CALL 0x00684240
006843fa : MOV EAX,dword ptr [ESI]
006843fc : MOV ECX,dword ptr [ESP + 0x14]
00684400 : AND ECX,dword ptr [EAX + 0x4]
00684403 : INC dword ptr [EAX]
00684405 : MOV ESI,dword ptr [ESI]
00684407 : LEA EDX,[ECX + ECX*0x4]
0068440a : MOV EBP,dword ptr [ESI + EDX*0x4 + 0x8]
0068440e : LEA EAX,[ESI + EDX*0x4 + 0x8]
00684412 : CMP EBP,-0x2
00684415 : JNZ 0x0068443a
00684417 : MOV EDX,dword ptr [ESP + 0x10]
0068441b : MOV dword ptr [EAX],0xffffffff
00684421 : MOV ESI,dword ptr [EDX]
00684423 : MOV dword ptr [EAX + 0x8],ESI
00684426 : MOV ESI,dword ptr [EDX + 0x4]
00684429 : MOV dword ptr [EAX + 0xc],ESI
0068442c : MOV EDX,dword ptr [EDX + 0x8]
0068442f : POP ESI
00684430 : MOV dword ptr [EAX + 0x10],EDX
00684433 : MOV dword ptr [EAX + 0x4],ECX
00684436 : POP EBP
00684437 : RET 0xc
0068443a : PUSH EDI
0068443b : MOV EDI,dword ptr [ESI + 0x4]
0068443e : MOV EDX,ECX
00684440 : PUSH EBX
00684441 : INC EDX
00684442 : AND EDX,EDI
00684444 : LEA EBX,[EDX + EDX*0x4]
00684447 : CMP dword ptr [ESI + EBX*0x4 + 0x8],-0x2
0068444c : JNZ 0x00684441
0068444e : LEA EDI,[EDX + EDX*0x4]
00684451 : LEA EBX,[ESI + EDI*0x4 + 0x8]
00684455 : MOV EDI,dword ptr [EAX + 0x4]
00684458 : CMP EDI,ECX
0068445a : JNZ 0x0068449b
0068445c : TEST EBX,EBX
0068445e : JZ 0x0068447a
00684460 : MOV dword ptr [EBX],EBP
00684462 : MOV ESI,dword ptr [EAX + 0x4]
00684465 : MOV dword ptr [EBX + 0x4],ESI
00684468 : MOV ESI,dword ptr [EAX + 0x8]
0068446b : MOV dword ptr [EBX + 0x8],ESI
0068446e : MOV ESI,dword ptr [EAX + 0xc]
00684471 : MOV dword ptr [EBX + 0xc],ESI
00684474 : MOV ESI,dword ptr [EAX + 0x10]
00684477 : MOV dword ptr [EBX + 0x10],ESI
0068447a : MOV ESI,dword ptr [ESP + 0x18]
0068447e : MOV EDI,dword ptr [ESI]
00684480 : MOV dword ptr [EAX + 0x8],EDI
00684483 : MOV EDI,dword ptr [ESI + 0x4]
00684486 : MOV dword ptr [EAX + 0xc],EDI
00684489 : MOV ESI,dword ptr [ESI + 0x8]
0068448c : POP EBX
0068448d : POP EDI
0068448e : MOV dword ptr [EAX + 0x10],ESI
00684491 : POP ESI
00684492 : MOV dword ptr [EAX],EDX
00684494 : MOV dword ptr [EAX + 0x4],ECX
00684497 : POP EBP
00684498 : RET 0xc
0068449b : LEA EDI,[EDI + EDI*0x4]
0068449e : CMP dword ptr [ESI + EDI*0x4 + 0x8],ECX
006844a2 : LEA EDI,[ESI + EDI*0x4 + 0x8]
006844a6 : JZ 0x006844bf
006844a8 : JMP 0x006844b0
006844b0 : MOV EDI,dword ptr [EDI]
006844b2 : LEA EDI,[EDI + EDI*0x4]
006844b5 : CMP dword ptr [ESI + EDI*0x4 + 0x8],ECX
006844b9 : LEA EDI,[ESI + EDI*0x4 + 0x8]
006844bd : JNZ 0x006844b0
006844bf : TEST EBX,EBX
006844c1 : JZ 0x006844dd
006844c3 : MOV dword ptr [EBX],EBP
006844c5 : MOV ESI,dword ptr [EAX + 0x4]
006844c8 : MOV dword ptr [EBX + 0x4],ESI
006844cb : MOV ESI,dword ptr [EAX + 0x8]
006844ce : MOV dword ptr [EBX + 0x8],ESI
006844d1 : MOV ESI,dword ptr [EAX + 0xc]
006844d4 : MOV dword ptr [EBX + 0xc],ESI
006844d7 : MOV ESI,dword ptr [EAX + 0x10]
006844da : MOV dword ptr [EBX + 0x10],ESI
006844dd : MOV dword ptr [EDI],EDX
006844df : MOV EDX,dword ptr [ESP + 0x18]
006844e3 : MOV ESI,dword ptr [EDX]
006844e5 : MOV dword ptr [EAX + 0x8],ESI
006844e8 : MOV ESI,dword ptr [EDX + 0x4]
006844eb : POP EBX
006844ec : MOV dword ptr [EAX + 0xc],ESI
006844ef : MOV EDX,dword ptr [EDX + 0x8]
006844f2 : POP EDI
006844f3 : POP ESI
006844f4 : MOV dword ptr [EAX + 0x10],EDX
006844f7 : MOV dword ptr [EAX],0xffffffff
006844fd : MOV dword ptr [EAX + 0x4],ECX
00684500 : POP EBP
00684501 : RET 0xc

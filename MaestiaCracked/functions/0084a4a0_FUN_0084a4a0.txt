PROGRAM  : Maestia.exe
FUNCTION : FUN_0084a4a0
ENTRY    : 0084a4a0
BODY     : [[0084a4a0, 0084aa5b]]

============================================================
DECOMPILED C CODE
============================================================

bool FUN_0084a4a0(uint *param_1,undefined4 param_2,uint *param_3,undefined1 *param_4,uint *param_5,
                 int param_6)

{
  short sVar1;
  uint uVar2;
  uint *puVar3;
  uint uVar4;
  int iVar5;
  undefined4 uVar6;
  int iVar7;
  int in_EDX;
  int iVar8;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  puVar3 = param_1;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b5f0bc;
  local_10 = ExceptionList;
  uVar4 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  uVar2 = *param_1;
  *param_1 = 0;
  FUN_004437f0(&param_1);
  if (((local_14 != *(int *)(in_EDX + 4)) && (iVar5 = *(int *)(local_14 + 0x10), iVar5 != 0)) &&
     (iVar8 = *(int *)(iVar5 + 4), iVar8 != 0)) {
    sVar1 = *(short *)(iVar5 + 8);
    param_1 = (uint *)iVar5;
    if (sVar1 == 2) {
      if ((*(int *)(iVar8 + 0xac) == 1) &&
         (iVar5 = FUN_004049b0(*(ushort *)(iVar8 + 0xb0) | 0x66000000,uVar4), iVar5 != 0)) {
        uVar6 = 0;
        *param_3 = CONCAT22(*(undefined2 *)(iVar5 + 4),*(undefined2 *)(iVar5 + 6));
        FUN_00443990(iVar5 + 0xe8);
        uVar6 = FUN_00824a20(DAT_0172491c,uVar6);
        local_8 = 7;
        FUN_00405d70(uVar6);
        local_8 = 0xffffffff;
        FUN_00406560();
        *puVar3 = 1;
        ExceptionList = local_10;
        return true;
      }
    }
    else if (sVar1 == 4) {
      param_5 = (uint *)0x0;
      param_4 = (undefined1 *)0xbc;
      iVar8 = 0xcc;
      do {
        if ((param_6 == -1) || (param_5 == (uint *)param_6)) {
          iVar7 = *(int *)((int)param_4 + *(int *)(iVar5 + 4));
          if (iVar7 == 1) {
            iVar7 = FUN_00703c00(0x500);
            iVar5 = (int)param_1;
            if (iVar7 != 0) {
              *param_3 = CONCAT22(*(undefined2 *)(iVar7 + 4),*(undefined2 *)(iVar7 + 6));
              uVar6 = FUN_00824a20(DAT_0172491c,0);
              local_8 = 2;
              FUN_00405eb0(uVar6,0,0xffffffff);
              local_8 = 0xffffffff;
              FUN_00406560();
              *puVar3 = 1;
              ExceptionList = local_10;
              return true;
            }
          }
          else {
            if (iVar7 == 5) {
              FUN_008497d0(1,*(undefined2 *)(DAT_00da93ec + 0x450),
                           *(undefined1 *)(*(int *)(iVar5 + 4) + 0xc0 + (int)param_5 * 2),uVar2,
                           puVar3,param_3,param_2);
              if (*puVar3 < uVar2) {
                FUN_008497d0(0,*(undefined2 *)(DAT_00da93ec + 0x450),
                             *(undefined1 *)(*(int *)(iVar5 + 4) + 0xc0 + (int)param_5 * 2),uVar2,
                             puVar3,param_3,param_2);
              }
              ExceptionList = local_10;
              return *puVar3 != 0;
            }
            if (iVar7 == 2) {
              iVar7 = FUN_00703c00(0x500);
              iVar5 = (int)param_1;
              if (iVar7 != 0) {
                *param_3 = CONCAT22(*(undefined2 *)(iVar7 + 4),*(undefined2 *)(iVar7 + 6));
                uVar6 = FUN_00824a20(DAT_0172491c,0);
                local_8 = 3;
                FUN_00405d70(uVar6);
                local_8 = 0xffffffff;
                FUN_00406560();
                *puVar3 = 1;
                ExceptionList = local_10;
                return true;
              }
            }
            else if (iVar7 == 0xb) {
              iVar7 = FUN_00703c00(0x500);
              iVar5 = (int)param_1;
              if (iVar7 != 0) {
                *param_3 = CONCAT22(*(undefined2 *)(iVar7 + 4),*(undefined2 *)(iVar7 + 6));
                uVar6 = FUN_00824a20(DAT_0172491c,0);
                local_8 = 4;
                FUN_00405d70(uVar6);
                local_8 = 0xffffffff;
                FUN_00406560();
                *puVar3 = 1;
                ExceptionList = local_10;
                return true;
              }
            }
            else if (iVar7 == 10) {
              iVar7 = FUN_00703c00(0x500);
              iVar5 = (int)param_1;
              if (iVar7 != 0) {
                *param_3 = CONCAT22(*(undefined2 *)(iVar7 + 4),*(undefined2 *)(iVar7 + 6));
                uVar6 = FUN_00824a20(DAT_0172491c,0);
                local_8 = 5;
                FUN_00405d70(uVar6);
                local_8 = 0xffffffff;
                FUN_00406560();
                *puVar3 = 1;
                ExceptionList = local_10;
                return true;
              }
            }
            else if ((iVar7 == 0) &&
                    (iVar7 = FUN_004049b0(*(ushort *)(*(int *)(iVar5 + 4) + 0xb8) | 0x66000000,uVar4
                                         ), iVar7 != 0)) {
              *param_3 = CONCAT22(*(undefined2 *)(iVar7 + 4),*(undefined2 *)(iVar7 + 6));
              uVar6 = FUN_00824a20(DAT_0172491c,0);
              local_8 = 6;
              FUN_00405d70(uVar6);
              local_8 = 0xffffffff;
              FUN_00406560();
              *puVar3 = 1;
              ExceptionList = local_10;
              return true;
            }
          }
        }
        param_4 = (undefined1 *)((int)param_4 + 4);
        param_5 = (uint *)((int)param_5 + 1);
        iVar8 = iVar8 + 2;
      } while (iVar8 < 0xce);
    }
    else if (sVar1 == 7) {
      if (*(int *)(iVar8 + 0xb4) == 1) {
        iVar5 = FUN_004049b0(*(ushort *)(iVar8 + 0xb8) | 0x66000000,uVar4);
        if (iVar5 != 0) {
          *param_3 = CONCAT22(*(undefined2 *)(iVar5 + 4),*(undefined2 *)(iVar5 + 6));
          uVar6 = FUN_00824a20(DAT_0172491c,0);
          local_8 = 0;
          FUN_00405d70(uVar6);
          local_8 = 0xffffffff;
          FUN_00406560();
          *puVar3 = 1;
          ExceptionList = local_10;
          return true;
        }
      }
      else if (*(int *)(iVar8 + 0xb4) == 3) {
        *param_3 = (uint)*(ushort *)(iVar8 + 0xc0);
        *param_4 = 1;
        *param_5 = (uint)*(ushort *)(*(int *)(iVar5 + 4) + 0xb8);
        uVar6 = FUN_00824120(DAT_0172491c);
        local_8 = 1;
        FUN_00405d70(uVar6);
        local_8 = 0xffffffff;
        FUN_00406560();
        *puVar3 = 1;
        ExceptionList = local_10;
        return true;
      }
    }
    else {
      FUN_008018d0(L"unknown Quest state type !!!");
    }
  }
  ExceptionList = local_10;
  return false;
}



============================================================
DISASSEMBLY
============================================================
0084a4a0 : PUSH EBP
0084a4a1 : MOV EBP,ESP
0084a4a3 : PUSH -0x1
0084a4a5 : PUSH 0xb5f0bc
0084a4aa : MOV EAX,FS:[0x0]
0084a4b0 : PUSH EAX
0084a4b1 : SUB ESP,0xec
0084a4b7 : PUSH EBX
0084a4b8 : PUSH ESI
0084a4b9 : PUSH EDI
0084a4ba : MOV EAX,[0x00d66fa0]
0084a4bf : XOR EAX,EBP
0084a4c1 : PUSH EAX
0084a4c2 : LEA EAX,[EBP + -0xc]
0084a4c5 : MOV FS:[0x0],EAX
0084a4cb : MOV EBX,dword ptr [EBP + 0x8]
0084a4ce : MOV EDI,EDX
0084a4d0 : MOV EAX,dword ptr [EBX]
0084a4d2 : LEA EDX,[EBP + 0x8]
0084a4d5 : MOV dword ptr [EBP + -0x14],EAX
0084a4d8 : MOV dword ptr [EBP + 0x8],ECX
0084a4db : PUSH EDX
0084a4dc : LEA EAX,[EBP + -0x10]
0084a4df : MOV ECX,EDI
0084a4e1 : MOV dword ptr [EBX],0x0
0084a4e7 : CALL 0x004437f0
0084a4ec : MOV EDI,dword ptr [EDI + 0x4]
0084a4ef : MOV EAX,dword ptr [EBP + -0x10]
0084a4f2 : CMP EAX,EDI
0084a4f4 : JZ 0x0084a535
0084a4f6 : MOV EDI,dword ptr [EAX + 0x10]
0084a4f9 : MOV dword ptr [EBP + 0x8],EDI
0084a4fc : TEST EDI,EDI
0084a4fe : JZ 0x0084a535
0084a500 : MOV EAX,dword ptr [EDI + 0x4]
0084a503 : TEST EAX,EAX
0084a505 : JZ 0x0084a535
0084a507 : MOVZX ECX,word ptr [EDI + 0x8]
0084a50b : SUB ECX,0x2
0084a50e : JZ 0x0084a9c2
0084a514 : SUB ECX,0x2
0084a517 : JZ 0x0084a64b
0084a51d : SUB ECX,0x3
0084a520 : JZ 0x0084a54b
0084a522 : MOV ESI,dword ptr [0x00da98e8]
0084a528 : PUSH 0xc3c0f0
0084a52d : CALL 0x008018d0
0084a532 : ADD ESP,0x4
0084a535 : XOR AL,AL
0084a537 : MOV ECX,dword ptr [EBP + -0xc]
0084a53a : MOV dword ptr FS:[0x0],ECX
0084a541 : POP ECX
0084a542 : POP EDI
0084a543 : POP ESI
0084a544 : POP EBX
0084a545 : MOV ESP,EBP
0084a547 : POP EBP
0084a548 : RET 0x18
0084a54b : MOV ECX,dword ptr [EAX + 0xb4]
0084a551 : CMP ECX,0x1
0084a554 : JNZ 0x0084a5d1
0084a556 : MOVZX EAX,word ptr [EAX + 0xb8]
0084a55d : OR EAX,0x66000000
0084a562 : PUSH EAX
0084a563 : CALL 0x004049b0
0084a568 : ADD ESP,0x4
0084a56b : TEST EAX,EAX
0084a56d : JZ 0x0084a535
0084a56f : MOVZX ECX,word ptr [EAX + 0x4]
0084a573 : MOVZX EDX,word ptr [EAX + 0x6]
0084a577 : SHL ECX,0x10
0084a57a : OR ECX,EDX
0084a57c : MOV EDX,dword ptr [EBP + 0x10]
0084a57f : MOV dword ptr [EDX],ECX
0084a581 : LEA EDX,[EAX + 0x18]
0084a584 : MOV EAX,[0x0172491c]
0084a589 : PUSH 0x0
0084a58b : PUSH EAX
0084a58c : LEA ESI,[EBP + 0xffffff28]
0084a592 : CALL 0x00824a20
0084a597 : MOV dword ptr [EBP + -0x4],0x0
0084a59e : MOV ECX,dword ptr [EBP + 0xc]
0084a5a1 : PUSH EAX
0084a5a2 : CALL 0x00405d70
0084a5a7 : MOV dword ptr [EBP + -0x4],0xffffffff
0084a5ae : MOV ECX,ESI
0084a5b0 : CALL 0x00406560
0084a5b5 : MOV dword ptr [EBX],0x1
0084a5bb : MOV AL,0x1
0084a5bd : MOV ECX,dword ptr [EBP + -0xc]
0084a5c0 : MOV dword ptr FS:[0x0],ECX
0084a5c7 : POP ECX
0084a5c8 : POP EDI
0084a5c9 : POP ESI
0084a5ca : POP EBX
0084a5cb : MOV ESP,EBP
0084a5cd : POP EBP
0084a5ce : RET 0x18
0084a5d1 : CMP ECX,0x3
0084a5d4 : JNZ 0x0084a535
0084a5da : MOV ECX,EAX
0084a5dc : MOVZX EDX,word ptr [ECX + 0xc0]
0084a5e3 : MOV EAX,dword ptr [EBP + 0x10]
0084a5e6 : MOV ECX,dword ptr [EBP + 0x14]
0084a5e9 : MOV dword ptr [EAX],EDX
0084a5eb : MOV byte ptr [ECX],0x1
0084a5ee : MOV EDX,dword ptr [EDI + 0x4]
0084a5f1 : MOVZX EAX,word ptr [EDX + 0xb8]
0084a5f8 : MOV ECX,dword ptr [EBP + 0x18]
0084a5fb : MOV dword ptr [ECX],EAX
0084a5fd : MOV EAX,[0x0172491c]
0084a602 : LEA EDX,[EDI + 0x90]
0084a608 : PUSH EAX
0084a609 : LEA EDI,[EBP + -0x68]
0084a60c : CALL 0x00824120
0084a611 : MOV dword ptr [EBP + -0x4],0x1
0084a618 : MOV ECX,dword ptr [EBP + 0xc]
0084a61b : PUSH EAX
0084a61c : CALL 0x00405d70
0084a621 : MOV dword ptr [EBP + -0x4],0xffffffff
0084a628 : MOV ECX,EDI
0084a62a : CALL 0x00406560
0084a62f : MOV AL,0x1
0084a631 : MOV dword ptr [EBX],0x1
0084a637 : MOV ECX,dword ptr [EBP + -0xc]
0084a63a : MOV dword ptr FS:[0x0],ECX
0084a641 : POP ECX
0084a642 : POP EDI
0084a643 : POP ESI
0084a644 : POP EBX
0084a645 : MOV ESP,EBP
0084a647 : POP EBP
0084a648 : RET 0x18
0084a64b : XOR EDX,EDX
0084a64d : MOV dword ptr [EBP + 0x18],EDX
0084a650 : MOV dword ptr [EBP + 0x14],0xbc
0084a657 : MOV ESI,0xcc
0084a65c : LEA ESP,[ESP]
0084a660 : MOV EAX,dword ptr [EBP + 0x1c]
0084a663 : CMP EAX,-0x1
0084a666 : JZ 0x0084a670
0084a668 : CMP EDX,EAX
0084a66a : JNZ 0x0084a73a
0084a670 : MOV EAX,dword ptr [EDI + 0x4]
0084a673 : MOV ECX,dword ptr [EBP + 0x14]
0084a676 : MOV ECX,dword ptr [ECX + EAX*0x1]
0084a679 : CMP ECX,0x1
0084a67c : JNZ 0x0084a6a0
0084a67e : MOV DI,word ptr [ESI + EAX*0x1 + -0xc]
0084a683 : PUSH 0x500
0084a688 : CALL 0x00703c00
0084a68d : ADD ESP,0x4
0084a690 : TEST EAX,EAX
0084a692 : JNZ 0x0084a759
0084a698 : MOV EDI,dword ptr [EBP + 0x8]
0084a69b : JMP 0x0084a73a
0084a6a0 : CMP ECX,0x5
0084a6a3 : JZ 0x0084a7bc
0084a6a9 : CMP ECX,0x2
0084a6ac : JNZ 0x0084a6cc
0084a6ae : MOV DI,word ptr [ESI + EAX*0x1]
0084a6b2 : PUSH 0x500
0084a6b7 : CALL 0x00703c00
0084a6bc : ADD ESP,0x4
0084a6bf : TEST EAX,EAX
0084a6c1 : JNZ 0x0084a83d
0084a6c7 : MOV EDI,dword ptr [EBP + 0x8]
0084a6ca : JMP 0x0084a73a
0084a6cc : CMP ECX,0xb
0084a6cf : JNZ 0x0084a6f2
0084a6d1 : MOV DI,word ptr [EAX + 0xb8]
0084a6d8 : PUSH 0x500
0084a6dd : CALL 0x00703c00
0084a6e2 : ADD ESP,0x4
0084a6e5 : TEST EAX,EAX
0084a6e7 : JNZ 0x0084a89f
0084a6ed : MOV EDI,dword ptr [EBP + 0x8]
0084a6f0 : JMP 0x0084a73a
0084a6f2 : CMP ECX,0xa
0084a6f5 : JNZ 0x0084a718
0084a6f7 : MOV DI,word ptr [EAX + 0xb8]
0084a6fe : PUSH 0x500
0084a703 : CALL 0x00703c00
0084a708 : ADD ESP,0x4
0084a70b : TEST EAX,EAX
0084a70d : JNZ 0x0084a8fe
0084a713 : MOV EDI,dword ptr [EBP + 0x8]
0084a716 : JMP 0x0084a73a
0084a718 : TEST ECX,ECX
0084a71a : JNZ 0x0084a73a
0084a71c : MOVZX EDX,word ptr [EAX + 0xb8]
0084a723 : OR EDX,0x66000000
0084a729 : PUSH EDX
0084a72a : CALL 0x004049b0
0084a72f : ADD ESP,0x4
0084a732 : TEST EAX,EAX
0084a734 : JNZ 0x0084a960
0084a73a : MOV EDX,dword ptr [EBP + 0x18]
0084a73d : ADD dword ptr [EBP + 0x14],0x4
0084a741 : INC EDX
0084a742 : ADD ESI,0x2
0084a745 : CMP ESI,0xce
0084a74b : MOV dword ptr [EBP + 0x18],EDX
0084a74e : JL 0x0084a660
0084a754 : JMP 0x0084a535
0084a759 : MOVZX ECX,word ptr [EAX + 0x4]
0084a75d : MOVZX EDX,word ptr [EAX + 0x6]
0084a761 : SHL ECX,0x10
0084a764 : OR ECX,EDX
0084a766 : MOV EDX,dword ptr [EBP + 0x10]
0084a769 : MOV dword ptr [EDX],ECX
0084a76b : LEA EDX,[EAX + 0x18]
0084a76e : MOV EAX,[0x0172491c]
0084a773 : PUSH 0x0
0084a775 : PUSH EAX
0084a776 : LEA ESI,[EBP + -0x30]
0084a779 : CALL 0x00824a20
0084a77e : MOV dword ptr [EBP + -0x4],0x2
0084a785 : MOV ECX,dword ptr [EBP + 0xc]
0084a788 : PUSH -0x1
0084a78a : PUSH 0x0
0084a78c : PUSH EAX
0084a78d : CALL 0x00405eb0
0084a792 : MOV dword ptr [EBP + -0x4],0xffffffff
0084a799 : MOV ECX,ESI
0084a79b : CALL 0x00406560
0084a7a0 : MOV dword ptr [EBX],0x1
0084a7a6 : MOV AL,0x1
0084a7a8 : MOV ECX,dword ptr [EBP + -0xc]
0084a7ab : MOV dword ptr FS:[0x0],ECX
0084a7b2 : POP ECX
0084a7b3 : POP EDI
0084a7b4 : POP ESI
0084a7b5 : POP EBX
0084a7b6 : MOV ESP,EBP
0084a7b8 : POP EBP
0084a7b9 : RET 0x18
0084a7bc : MOV ECX,dword ptr [EBP + 0xc]
0084a7bf : MOV EAX,dword ptr [EBP + 0x10]
0084a7c2 : MOV ESI,dword ptr [EBP + -0x14]
0084a7c5 : PUSH ECX
0084a7c6 : MOV ECX,dword ptr [EDI + 0x4]
0084a7c9 : MOVZX EDX,byte ptr [ECX + EDX*0x2 + 0xc0]
0084a7d1 : PUSH EAX
0084a7d2 : MOV EAX,[0x00da93ec]
0084a7d7 : MOVZX ECX,word ptr [EAX + 0x450]
0084a7de : PUSH EBX
0084a7df : PUSH ESI
0084a7e0 : PUSH EDX
0084a7e1 : PUSH ECX
0084a7e2 : PUSH 0x1
0084a7e4 : CALL 0x008497d0
0084a7e9 : ADD ESP,0x1c
0084a7ec : CMP dword ptr [EBX],ESI
0084a7ee : JNC 0x0084a821
0084a7f0 : MOV EDX,dword ptr [EBP + 0xc]
0084a7f3 : MOV EAX,dword ptr [EBP + 0x10]
0084a7f6 : MOV ECX,dword ptr [EDI + 0x4]
0084a7f9 : PUSH EDX
0084a7fa : MOV EDX,dword ptr [EBP + 0x18]
0084a7fd : PUSH EAX
0084a7fe : MOVZX EAX,byte ptr [ECX + EDX*0x2 + 0xc0]
0084a806 : MOV ECX,dword ptr [0x00da93ec]
0084a80c : MOVZX EDX,word ptr [ECX + 0x450]
0084a813 : PUSH EBX
0084a814 : PUSH ESI
0084a815 : PUSH EAX
0084a816 : PUSH EDX
0084a817 : PUSH 0x0
0084a819 : CALL 0x008497d0
0084a81e : ADD ESP,0x1c
0084a821 : XOR EAX,EAX
0084a823 : CMP EAX,dword ptr [EBX]
0084a825 : SBB EAX,EAX
0084a827 : NEG EAX
0084a829 : MOV ECX,dword ptr [EBP + -0xc]
0084a82c : MOV dword ptr FS:[0x0],ECX
0084a833 : POP ECX
0084a834 : POP EDI
0084a835 : POP ESI
0084a836 : POP EBX
0084a837 : MOV ESP,EBP
0084a839 : POP EBP
0084a83a : RET 0x18
0084a83d : MOVZX ECX,word ptr [EAX + 0x4]
0084a841 : MOVZX EDX,word ptr [EAX + 0x6]
0084a845 : SHL ECX,0x10
0084a848 : OR ECX,EDX
0084a84a : MOV EDX,dword ptr [EBP + 0x10]
0084a84d : MOV dword ptr [EDX],ECX
0084a84f : LEA EDX,[EAX + 0x18]
0084a852 : MOV EAX,[0x0172491c]
0084a857 : PUSH 0x0
0084a859 : PUSH EAX
0084a85a : LEA ESI,[EBP + 0xffffff60]
0084a860 : CALL 0x00824a20
0084a865 : MOV dword ptr [EBP + -0x4],0x3
0084a86c : MOV ECX,dword ptr [EBP + 0xc]
0084a86f : PUSH EAX
0084a870 : CALL 0x00405d70
0084a875 : MOV dword ptr [EBP + -0x4],0xffffffff
0084a87c : MOV ECX,ESI
0084a87e : CALL 0x00406560
0084a883 : MOV dword ptr [EBX],0x1
0084a889 : MOV AL,0x1
0084a88b : MOV ECX,dword ptr [EBP + -0xc]
0084a88e : MOV dword ptr FS:[0x0],ECX
0084a895 : POP ECX
0084a896 : POP EDI
0084a897 : POP ESI
0084a898 : POP EBX
0084a899 : MOV ESP,EBP
0084a89b : POP EBP
0084a89c : RET 0x18
0084a89f : MOVZX ECX,word ptr [EAX + 0x4]
0084a8a3 : MOVZX EDX,word ptr [EAX + 0x6]
0084a8a7 : SHL ECX,0x10
0084a8aa : OR ECX,EDX
0084a8ac : MOV EDX,dword ptr [EBP + 0x10]
0084a8af : MOV dword ptr [EDX],ECX
0084a8b1 : LEA EDX,[EAX + 0x18]
0084a8b4 : MOV EAX,[0x0172491c]
0084a8b9 : PUSH 0x0
0084a8bb : PUSH EAX
0084a8bc : LEA ESI,[EBP + -0x4c]
0084a8bf : CALL 0x00824a20
0084a8c4 : MOV dword ptr [EBP + -0x4],0x4
0084a8cb : MOV ECX,dword ptr [EBP + 0xc]
0084a8ce : PUSH EAX
0084a8cf : CALL 0x00405d70
0084a8d4 : MOV dword ptr [EBP + -0x4],0xffffffff
0084a8db : MOV ECX,ESI
0084a8dd : CALL 0x00406560
0084a8e2 : MOV dword ptr [EBX],0x1
0084a8e8 : MOV AL,0x1
0084a8ea : MOV ECX,dword ptr [EBP + -0xc]
0084a8ed : MOV dword ptr FS:[0x0],ECX
0084a8f4 : POP ECX
0084a8f5 : POP EDI
0084a8f6 : POP ESI
0084a8f7 : POP EBX
0084a8f8 : MOV ESP,EBP
0084a8fa : POP EBP
0084a8fb : RET 0x18
0084a8fe : MOVZX ECX,word ptr [EAX + 0x4]
0084a902 : MOVZX EDX,word ptr [EAX + 0x6]
0084a906 : SHL ECX,0x10
0084a909 : OR ECX,EDX
0084a90b : MOV EDX,dword ptr [EBP + 0x10]
0084a90e : MOV dword ptr [EDX],ECX
0084a910 : LEA EDX,[EAX + 0x18]
0084a913 : MOV EAX,[0x0172491c]
0084a918 : PUSH 0x0
0084a91a : PUSH EAX
0084a91b : LEA ESI,[EBP + 0xffffff7c]
0084a921 : CALL 0x00824a20
0084a926 : MOV dword ptr [EBP + -0x4],0x5
0084a92d : MOV ECX,dword ptr [EBP + 0xc]
0084a930 : PUSH EAX
0084a931 : CALL 0x00405d70
0084a936 : MOV dword ptr [EBP + -0x4],0xffffffff
0084a93d : MOV ECX,ESI
0084a93f : CALL 0x00406560
0084a944 : MOV dword ptr [EBX],0x1
0084a94a : MOV AL,0x1
0084a94c : MOV ECX,dword ptr [EBP + -0xc]
0084a94f : MOV dword ptr FS:[0x0],ECX
0084a956 : POP ECX
0084a957 : POP EDI
0084a958 : POP ESI
0084a959 : POP EBX
0084a95a : MOV ESP,EBP
0084a95c : POP EBP
0084a95d : RET 0x18
0084a960 : MOVZX ECX,word ptr [EAX + 0x4]
0084a964 : MOVZX EDX,word ptr [EAX + 0x6]
0084a968 : SHL ECX,0x10
0084a96b : OR ECX,EDX
0084a96d : MOV EDX,dword ptr [EBP + 0x10]
0084a970 : MOV dword ptr [EDX],ECX
0084a972 : LEA EDX,[EAX + 0x18]
0084a975 : MOV EAX,[0x0172491c]
0084a97a : PUSH 0x0
0084a97c : PUSH EAX
0084a97d : LEA ESI,[EBP + 0xffffff44]
0084a983 : CALL 0x00824a20
0084a988 : MOV dword ptr [EBP + -0x4],0x6
0084a98f : MOV ECX,dword ptr [EBP + 0xc]
0084a992 : PUSH EAX
0084a993 : CALL 0x00405d70
0084a998 : MOV dword ptr [EBP + -0x4],0xffffffff
0084a99f : MOV ECX,ESI
0084a9a1 : CALL 0x00406560
0084a9a6 : MOV dword ptr [EBX],0x1
0084a9ac : MOV AL,0x1
0084a9ae : MOV ECX,dword ptr [EBP + -0xc]
0084a9b1 : MOV dword ptr FS:[0x0],ECX
0084a9b8 : POP ECX
0084a9b9 : POP EDI
0084a9ba : POP ESI
0084a9bb : POP EBX
0084a9bc : MOV ESP,EBP
0084a9be : POP EBP
0084a9bf : RET 0x18
0084a9c2 : CMP dword ptr [EAX + 0xac],0x1
0084a9c9 : JNZ 0x0084a535
0084a9cf : MOVZX ECX,word ptr [EAX + 0xb0]
0084a9d6 : OR ECX,0x66000000
0084a9dc : PUSH ECX
0084a9dd : CALL 0x004049b0
0084a9e2 : ADD ESP,0x4
0084a9e5 : TEST EAX,EAX
0084a9e7 : JZ 0x0084a535
0084a9ed : MOVZX EDX,word ptr [EAX + 0x4]
0084a9f1 : MOVZX ECX,word ptr [EAX + 0x6]
0084a9f5 : SHL EDX,0x10
0084a9f8 : OR EDX,ECX
0084a9fa : MOV ECX,dword ptr [EBP + 0x10]
0084a9fd : PUSH 0x0
0084a9ff : ADD EAX,0xe8
0084aa04 : PUSH EAX
0084aa05 : MOV dword ptr [ECX],EDX
0084aa07 : CALL 0x00443990
0084aa0c : MOV EDX,EAX
0084aa0e : MOV EAX,[0x0172491c]
0084aa13 : ADD EDX,0x18
0084aa16 : PUSH EAX
0084aa17 : LEA ESI,[EBP + 0xffffff0c]
0084aa1d : CALL 0x00824a20
0084aa22 : MOV dword ptr [EBP + -0x4],0x7
0084aa29 : MOV ECX,dword ptr [EBP + 0xc]
0084aa2c : PUSH EAX
0084aa2d : CALL 0x00405d70
0084aa32 : MOV dword ptr [EBP + -0x4],0xffffffff
0084aa39 : MOV ECX,ESI
0084aa3b : CALL 0x00406560
0084aa40 : MOV AL,0x1
0084aa42 : MOV dword ptr [EBX],0x1
0084aa48 : MOV ECX,dword ptr [EBP + -0xc]
0084aa4b : MOV dword ptr FS:[0x0],ECX
0084aa52 : POP ECX
0084aa53 : POP EDI
0084aa54 : POP ESI
0084aa55 : POP EBX
0084aa56 : MOV ESP,EBP
0084aa58 : POP EBP
0084aa59 : RET 0x18

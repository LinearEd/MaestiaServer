PROGRAM  : Maestia.exe
FUNCTION : FUN_004044f0
ENTRY    : 004044f0
BODY     : [[004044f0, 004045a7]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_004044f0(void)

{
  wchar_t wVar1;
  wchar_t *pwVar2;
  int in_ECX;
  wchar_t *pwVar3;
  wchar_t local_108;
  undefined1 local_106 [254];
  uint local_8;
  
  local_8 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  FUN_00405eb0(in_ECX,0,0xffffffff);
  local_108 = L'\0';
  _memset(local_106,0,0xfe);
  if (*(uint *)(in_ECX + 0x18) < 8) {
    pwVar2 = (wchar_t *)(in_ECX + 4);
  }
  else {
    pwVar2 = *(wchar_t **)(in_ECX + 4);
  }
  _wcscpy_s(&local_108,0x80,pwVar2);
  pwVar2 = _wcsstr(&local_108,L"GM_");
  if (pwVar2 == (wchar_t *)0x0) {
    pwVar2 = &local_108;
  }
  else {
    pwVar2 = pwVar2 + 3;
  }
  pwVar3 = pwVar2;
  do {
    wVar1 = *pwVar3;
    pwVar3 = pwVar3 + 1;
  } while (wVar1 != L'\0');
  FUN_00406360(pwVar2,(int)pwVar3 - (int)(pwVar2 + 1) >> 1);
  __security_check_cookie(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
004044f0 : PUSH EBP
004044f1 : MOV EBP,ESP
004044f3 : SUB ESP,0x104
004044f9 : MOV EAX,[0x00d66fa0]
004044fe : XOR EAX,EBP
00404500 : MOV dword ptr [EBP + -0x4],EAX
00404503 : PUSH ESI
00404504 : PUSH -0x1
00404506 : MOV ESI,ECX
00404508 : PUSH 0x0
0040450a : PUSH ESI
0040450b : LEA ECX,[EDI + 0xc]
0040450e : CALL 0x00405eb0
00404513 : XOR EAX,EAX
00404515 : PUSH 0xfe
0040451a : PUSH EAX
0040451b : LEA ECX,[EBP + 0xfffffefe]
00404521 : PUSH ECX
00404522 : MOV word ptr [EBP + 0xfffffefc],AX
00404529 : CALL 0x0063b700
0040452e : ADD ESP,0xc
00404531 : CMP dword ptr [ESI + 0x18],0x8
00404535 : JC 0x0040453c
00404537 : MOV ESI,dword ptr [ESI + 0x4]
0040453a : JMP 0x0040453f
0040453c : ADD ESI,0x4
0040453f : PUSH ESI
00404540 : LEA EDX,[EBP + 0xfffffefc]
00404546 : PUSH 0x80
0040454b : PUSH EDX
0040454c : CALL 0x0063481b
00404551 : LEA EAX,[EBP + 0xfffffefc]
00404557 : PUSH 0xcca4a0
0040455c : PUSH EAX
0040455d : CALL 0x006347ba
00404562 : ADD ESP,0x14
00404565 : TEST EAX,EAX
00404567 : JZ 0x0040456e
00404569 : ADD EAX,0x6
0040456c : JMP 0x00404574
0040456e : LEA EAX,[EBP + 0xfffffefc]
00404574 : MOV ECX,EAX
00404576 : LEA ESI,[ECX + 0x2]
00404579 : LEA ESP,[ESP]
00404580 : MOV DX,word ptr [ECX]
00404583 : ADD ECX,0x2
00404586 : TEST DX,DX
00404589 : JNZ 0x00404580
0040458b : SUB ECX,ESI
0040458d : SAR ECX,0x1
0040458f : PUSH ECX
00404590 : PUSH EAX
00404591 : LEA ECX,[EDI + 0x28]
00404594 : CALL 0x00406360
00404599 : MOV ECX,dword ptr [EBP + -0x4]
0040459c : XOR ECX,EBP
0040459e : POP ESI
0040459f : CALL 0x00633e6b
004045a4 : MOV ESP,EBP
004045a6 : POP EBP
004045a7 : RET

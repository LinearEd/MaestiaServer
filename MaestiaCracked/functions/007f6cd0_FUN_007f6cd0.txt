PROGRAM  : Maestia.exe
FUNCTION : FUN_007f6cd0
ENTRY    : 007f6cd0
BODY     : [[007f6cd0, 007f6e7a]]

============================================================
DECOMPILED C CODE
============================================================

char * FUN_007f6cd0(int param_1,int param_2,undefined4 param_3)

{
  char cVar1;
  uint uVar2;
  char *pcVar3;
  undefined4 uStack_44;
  LPCRITICAL_SECTION p_Stack_40;
  undefined4 uStack_3c;
  int iStack_34;
  LPCRITICAL_SECTION p_Stack_30;
  LPCRITICAL_SECTION local_2c;
  char *local_28;
  int local_24;
  uint local_20;
  undefined4 local_1c;
  void *pvStack_18;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b0da8f;
  local_14 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xffffffb0;
  ExceptionList = &local_14;
  local_2c = (LPCRITICAL_SECTION)(param_1 + 0xc);
  local_20 = 0;
  local_28 = ".\\World\\AvaWorld.cpp";
  local_24 = 0x796;
  local_1c = 1;
  FUN_006ef1a0(&local_2c);
  local_c = 0;
  if (*(int *)(param_1 + 4) != 2) {
    local_c = 0xffffffff;
    if (local_20 != 0) {
      LeaveCriticalSection(local_2c);
    }
    ExceptionList = local_14;
    return "";
  }
  if ((*(int **)(param_1 + 0x54) != (int *)0x0) && (param_2 != 0)) {
    cVar1 = (**(code **)(**(int **)(param_1 + 0x54) + 0x28))(param_2,uVar2);
    if (cVar1 == '\0') {
      puStack_10 = (undefined1 *)0xffffffff;
      if (local_24 != 0) {
        LeaveCriticalSection(p_Stack_30);
      }
      ExceptionList = pvStack_18;
      return "";
    }
    uStack_44 = 0;
    p_Stack_40 = (LPCRITICAL_SECTION)0x84;
    uStack_3c = 0;
    puStack_10 = (undefined1 *)CONCAT31(puStack_10._1_3_,1);
    cVar1 = (**(code **)(**(int **)(param_1 + 0x54) + 0x60))
                      (param_2,&uStack_44,param_3,&stack0x00000010);
    if (cVar1 == '\0') {
      pcVar3 = "";
    }
    else {
      pcVar3 = (char *)FUN_0045ac60();
    }
    local_20 = local_20 & 0xffffff00;
    FUN_0045ac80();
    local_20 = 0xffffffff;
    if (iStack_34 != 0) {
      LeaveCriticalSection(p_Stack_40);
    }
    ExceptionList = local_28;
    return pcVar3;
  }
  local_c = 0xffffffff;
  if (local_20 != 0) {
    LeaveCriticalSection(local_2c);
  }
  ExceptionList = local_14;
  return "";
}



============================================================
DISASSEMBLY
============================================================
007f6cd0 : PUSH EBP
007f6cd1 : MOV EBP,ESP
007f6cd3 : AND ESP,0xfffffff8
007f6cd6 : PUSH -0x1
007f6cd8 : PUSH 0xb0da8f
007f6cdd : MOV EAX,FS:[0x0]
007f6ce3 : PUSH EAX
007f6ce4 : SUB ESP,0x30
007f6ce7 : PUSH EBX
007f6ce8 : PUSH ESI
007f6ce9 : PUSH EDI
007f6cea : MOV EAX,[0x00d66fa0]
007f6cef : XOR EAX,ESP
007f6cf1 : PUSH EAX
007f6cf2 : LEA EAX,[ESP + 0x40]
007f6cf6 : MOV FS:[0x0],EAX
007f6cfc : MOV ESI,dword ptr [EBP + 0x8]
007f6cff : LEA ECX,[ESP + 0x28]
007f6d03 : LEA EAX,[ESI + 0xc]
007f6d06 : XOR EBX,EBX
007f6d08 : PUSH ECX
007f6d09 : MOV dword ptr [ESP + 0x38],EBX
007f6d0d : MOV dword ptr [ESP + 0x2c],EAX
007f6d11 : MOV dword ptr [ESP + 0x30],0xc25694
007f6d19 : MOV dword ptr [ESP + 0x34],0x796
007f6d21 : MOV dword ptr [ESP + 0x3c],0x1
007f6d29 : CALL 0x006ef1a0
007f6d2e : MOV dword ptr [ESP + 0x48],EBX
007f6d32 : CMP dword ptr [ESI + 0x4],0x2
007f6d36 : JZ 0x007f6d6d
007f6d38 : MOV dword ptr [ESP + 0x48],0xffffffff
007f6d40 : CMP dword ptr [ESP + 0x34],EBX
007f6d44 : JZ 0x007f6d55
007f6d46 : MOV EDX,dword ptr [ESP + 0x28]
007f6d4a : PUSH EDX
007f6d4b : CALL dword ptr [0x00b8511c]
007f6d51 : MOV dword ptr [ESP + 0x34],EBX
007f6d55 : MOV EAX,0xbf1bf7
007f6d5a : MOV ECX,dword ptr [ESP + 0x40]
007f6d5e : MOV dword ptr FS:[0x0],ECX
007f6d65 : POP ECX
007f6d66 : POP EDI
007f6d67 : POP ESI
007f6d68 : POP EBX
007f6d69 : MOV ESP,EBP
007f6d6b : POP EBP
007f6d6c : RET
007f6d6d : MOV ECX,dword ptr [ESI + 0x54]
007f6d70 : CMP ECX,EBX
007f6d72 : JZ 0x007f6e46
007f6d78 : MOV EDI,dword ptr [EBP + 0xc]
007f6d7b : CMP EDI,EBX
007f6d7d : JZ 0x007f6e46
007f6d83 : MOV EAX,dword ptr [ECX]
007f6d85 : MOV EDX,dword ptr [EAX + 0x28]
007f6d88 : PUSH EDI
007f6d89 : CALL EDX
007f6d8b : TEST AL,AL
007f6d8d : JNZ 0x007f6dc4
007f6d8f : MOV dword ptr [ESP + 0x48],0xffffffff
007f6d97 : CMP dword ptr [ESP + 0x34],EBX
007f6d9b : JZ 0x007f6dac
007f6d9d : MOV EAX,dword ptr [ESP + 0x28]
007f6da1 : PUSH EAX
007f6da2 : CALL dword ptr [0x00b8511c]
007f6da8 : MOV dword ptr [ESP + 0x34],EBX
007f6dac : MOV EAX,0xbf1c8e
007f6db1 : MOV ECX,dword ptr [ESP + 0x40]
007f6db5 : MOV dword ptr FS:[0x0],ECX
007f6dbc : POP ECX
007f6dbd : POP EDI
007f6dbe : POP ESI
007f6dbf : POP EBX
007f6dc0 : MOV ESP,EBP
007f6dc2 : POP EBP
007f6dc3 : RET
007f6dc4 : MOV dword ptr [ESP + 0x14],EBX
007f6dc8 : MOV dword ptr [ESP + 0x18],0x84
007f6dd0 : MOV dword ptr [ESP + 0x1c],EBX
007f6dd4 : MOV byte ptr [ESP + 0x48],0x1
007f6dd9 : MOV ECX,dword ptr [ESI + 0x54]
007f6ddc : MOV EDX,dword ptr [ECX]
007f6dde : MOV EDX,dword ptr [EDX + 0x60]
007f6de1 : LEA EAX,[EBP + 0x14]
007f6de4 : PUSH EAX
007f6de5 : MOV EAX,dword ptr [EBP + 0x10]
007f6de8 : PUSH EAX
007f6de9 : LEA EAX,[ESP + 0x1c]
007f6ded : PUSH EAX
007f6dee : PUSH EDI
007f6def : CALL EDX
007f6df1 : CMP AL,BL
007f6df3 : JZ 0x007f6e02
007f6df5 : LEA ECX,[ESP + 0x14]
007f6df9 : CALL 0x0045ac60
007f6dfe : MOV ESI,EAX
007f6e00 : JMP 0x007f6e07
007f6e02 : MOV ESI,0xbf1c8f
007f6e07 : MOV byte ptr [ESP + 0x48],BL
007f6e0b : LEA ECX,[ESP + 0x14]
007f6e0f : CALL 0x0045ac80
007f6e14 : MOV dword ptr [ESP + 0x48],0xffffffff
007f6e1c : CMP dword ptr [ESP + 0x34],EBX
007f6e20 : JZ 0x007f6e31
007f6e22 : MOV EAX,dword ptr [ESP + 0x28]
007f6e26 : PUSH EAX
007f6e27 : CALL dword ptr [0x00b8511c]
007f6e2d : MOV dword ptr [ESP + 0x34],EBX
007f6e31 : MOV EAX,ESI
007f6e33 : MOV ECX,dword ptr [ESP + 0x40]
007f6e37 : MOV dword ptr FS:[0x0],ECX
007f6e3e : POP ECX
007f6e3f : POP EDI
007f6e40 : POP ESI
007f6e41 : POP EBX
007f6e42 : MOV ESP,EBP
007f6e44 : POP EBP
007f6e45 : RET
007f6e46 : MOV dword ptr [ESP + 0x48],0xffffffff
007f6e4e : CMP dword ptr [ESP + 0x34],EBX
007f6e52 : JZ 0x007f6e63
007f6e54 : MOV ECX,dword ptr [ESP + 0x28]
007f6e58 : PUSH ECX
007f6e59 : CALL dword ptr [0x00b8511c]
007f6e5f : MOV dword ptr [ESP + 0x34],EBX
007f6e63 : MOV EAX,0xbf1c8d
007f6e68 : MOV ECX,dword ptr [ESP + 0x40]
007f6e6c : MOV dword ptr FS:[0x0],ECX
007f6e73 : POP ECX
007f6e74 : POP EDI
007f6e75 : POP ESI
007f6e76 : POP EBX
007f6e77 : MOV ESP,EBP
007f6e79 : POP EBP
007f6e7a : RET

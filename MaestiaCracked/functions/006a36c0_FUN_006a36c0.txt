PROGRAM  : Maestia.exe
FUNCTION : FUN_006a36c0
ENTRY    : 006a36c0
BODY     : [[006a36c0, 006a3878] [006a3880, 006a3ab1]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006a36c0(int param_1,uint *param_2)

{
  char cVar1;
  byte bVar2;
  char *pcVar3;
  char *pcVar4;
  bool bVar5;
  undefined1 *puVar6;
  undefined4 uVar7;
  uint uVar8;
  int iVar9;
  uint uVar10;
  int iVar11;
  uint uVar12;
  uint uVar13;
  uint uStack_30;
  int local_2c;
  uint uStack_28;
  uint uStack_24;
  uint local_20;
  int iStack_1c;
  int iStack_18;
  byte *pbStack_14;
  char *local_10;
  int iStack_c;
  uint uStack_8;
  int iStack_4;
  
  local_20 = param_2[4];
  pcVar3 = (char *)param_2[2];
  uVar13 = 0;
  uVar12 = 0;
  local_2c = 0;
  bVar5 = false;
  local_10 = pcVar3;
  (*(code *)param_2[7])(param_2);
  pcVar4 = (char *)*param_2;
  if ((pcVar4 < pcVar3) && (cVar1 = *pcVar4, *param_2 = (uint)(pcVar4 + 1), cVar1 == '[')) {
    (*(code *)param_2[7])(param_2);
    uVar10 = 0;
    iStack_18 = 0;
    uStack_28 = 0;
    iStack_c = 0;
    uStack_24 = 0;
    if ((char *)*param_2 < local_10) {
      do {
        pbStack_14 = (byte *)*param_2;
        bVar2 = *pbStack_14;
        if (bVar2 == 0x5d) {
          *param_2 = *param_2 + 1;
          goto LAB_006a3a91;
        }
        if (bVar2 == 0x3c) {
          (*(code *)param_2[8])(param_2);
          if (param_2[3] != 0) goto LAB_006a3a91;
          iVar11 = (int)((*param_2 - (int)pbStack_14) + -1) / 2;
          local_2c = FUN_0068a220(local_20,1,iStack_c,iVar11,local_2c,&uStack_30);
          if (uStack_30 != 0) goto LAB_006a3a8e;
          *param_2 = (uint)pbStack_14;
          bVar5 = true;
          (*(code *)param_2[0xb])(param_2,local_2c,iVar11,&uStack_8,1);
          uStack_28 = uStack_8;
          uVar10 = uStack_24;
          iStack_c = iVar11;
        }
        else if (bVar2 - 0x30 < 10) {
          if (!bVar5) {
            uStack_28 = (*(code *)param_2[9])(param_2);
            (*(code *)param_2[8])(param_2);
            if (param_2[3] != 0) {
              return;
            }
            local_2c = *param_2 + 1;
            pcVar3 = (char *)(*param_2 + 1 + uStack_28);
            *param_2 = (uint)pcVar3;
            if (pcVar3 < local_10) goto LAB_006a3831;
          }
          uStack_30 = 3;
          goto LAB_006a3a8e;
        }
LAB_006a3831:
        if (local_2c == 0) {
LAB_006a3a81:
          uStack_30 = 3;
          goto LAB_006a3a8e;
        }
        if (*(char *)((uStack_28 - 1) + local_2c) == '\0') {
          uVar8 = uStack_28 & 0x80000001;
          if ((int)uVar8 < 0) {
            uVar8 = (uVar8 - 1 | 0xfffffffe) + 1;
          }
          if (uVar8 == 1) {
            uStack_28 = uStack_28 - 1;
          }
        }
        if (uStack_28 == 0) goto LAB_006a3a81;
        pbStack_14 = (byte *)0x0;
        if (0 < (int)uStack_28) {
          do {
            if (iStack_18 == 0) {
              iVar11 = *(int *)(param_1 + 0x1ec);
              if (0xb < uVar10) {
                uVar12 = (uint)*(byte *)(iVar11 + 4) * 0x10 + (uint)*(byte *)(iVar11 + 5);
                uVar13 = uVar12 * 0x10 + 0xc;
                iStack_18 = 1;
                uVar7 = FUN_0068a220(local_20,1,0xc,uVar13,iVar11,&uStack_30);
                *(undefined4 *)(param_1 + 0x1ec) = uVar7;
                if (uStack_30 == 0) goto LAB_006a3901;
                goto LAB_006a3a8e;
              }
              *(byte *)(uVar10 + iVar11) = pbStack_14[local_2c];
LAB_006a3a32:
              uVar10 = uVar10 + 1;
              uStack_24 = uVar10;
            }
            else {
              if (iStack_18 == 1) {
LAB_006a3901:
                if (uVar10 < uVar13) {
LAB_006a3a22:
                  *(byte *)(uVar10 + *(int *)(param_1 + 0x1ec)) = pbStack_14[local_2c];
                  goto LAB_006a3a32;
                }
                iVar11 = 0;
                iStack_18 = 0;
                iStack_1c = 0;
                if (1 < uVar12) {
                  puVar6 = (undefined1 *)(*(int *)(param_1 + 0x1ec) + 0x1a);
                  iVar9 = (uVar12 - 2 >> 1) + 1;
                  iVar11 = iVar9 * 2;
                  do {
                    iStack_18 = iStack_18 +
                                (CONCAT31(CONCAT21(CONCAT11(puVar6[-2],puVar6[-1]),*puVar6),
                                          puVar6[1]) + 3U & 0xfffffffc);
                    iStack_1c = iStack_1c +
                                (CONCAT31(CONCAT21(CONCAT11(puVar6[0xe],puVar6[0xf]),puVar6[0x10]),
                                          puVar6[0x11]) + 3U & 0xfffffffc);
                    puVar6 = puVar6 + 0x20;
                    iVar9 = iVar9 + -1;
                    uVar10 = uStack_24;
                    iStack_4 = iVar11;
                  } while (iVar9 != 0);
                }
                if (iVar11 < (int)uVar12) {
                  iVar9 = *(int *)(param_1 + 0x1ec) + 0x18 + iVar11 * 0x10;
                  uVar13 = uVar13 + (CONCAT31(CONCAT21(CONCAT11(*(undefined1 *)
                                                                 (*(int *)(param_1 + 0x1ec) + 0x18 +
                                                                 iVar11 * 0x10),
                                                                *(undefined1 *)(iVar9 + 1)),
                                                       *(undefined1 *)(iVar9 + 2)),
                                              *(undefined1 *)(iVar9 + 3)) + 3U & 0xfffffffc);
                }
                uVar13 = uVar13 + iStack_1c + iStack_18;
                iStack_18 = 2;
                *(uint *)(param_1 + 0x1f0) = uVar13;
                uVar7 = FUN_0068a220(local_20,1,uVar12 * 0x10 + 0xc,uVar13 + 1,
                                     *(undefined4 *)(param_1 + 0x1ec),&uStack_30);
                *(undefined4 *)(param_1 + 0x1ec) = uVar7;
                if (uStack_30 == 0) goto LAB_006a3a1e;
                goto LAB_006a3a8e;
              }
              if (iStack_18 == 2) {
LAB_006a3a1e:
                if (uVar10 < uVar13) goto LAB_006a3a22;
                goto LAB_006a3a81;
              }
            }
            pbStack_14 = pbStack_14 + 1;
          } while ((int)pbStack_14 < (int)uStack_28);
        }
        (*(code *)param_2[7])(param_2);
      } while ((char *)*param_2 < local_10);
    }
  }
  uStack_30 = 3;
LAB_006a3a8e:
  param_2[3] = uStack_30;
LAB_006a3a91:
  if (bVar5) {
    FUN_00687f30(local_20,local_2c);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
006a36c0 : SUB ESP,0x34
006a36c3 : PUSH EBX
006a36c4 : PUSH EBP
006a36c5 : PUSH ESI
006a36c6 : PUSH EDI
006a36c7 : MOV EDI,dword ptr [ESP + 0x4c]
006a36cb : MOV EAX,dword ptr [EDI + 0x10]
006a36ce : MOV EBX,dword ptr [EDI + 0x8]
006a36d1 : MOV ECX,dword ptr [EDI + 0x1c]
006a36d4 : XOR ESI,ESI
006a36d6 : PUSH EDI
006a36d7 : MOV dword ptr [ESP + 0x28],EAX
006a36db : MOV dword ptr [ESP + 0x38],EBX
006a36df : XOR EBP,EBP
006a36e1 : MOV dword ptr [ESP + 0x1c],ESI
006a36e5 : MOV byte ptr [ESP + 0x17],0x0
006a36ea : CALL ECX
006a36ec : MOV EAX,dword ptr [EDI]
006a36ee : ADD ESP,0x4
006a36f1 : CMP EAX,EBX
006a36f3 : JNC 0x006a3a65
006a36f9 : MOV DL,byte ptr [EAX]
006a36fb : INC EAX
006a36fc : MOV dword ptr [EDI],EAX
006a36fe : CMP DL,0x5b
006a3701 : JNZ 0x006a3a65
006a3707 : MOV EAX,dword ptr [EDI + 0x1c]
006a370a : PUSH EDI
006a370b : CALL EAX
006a370d : MOV ECX,dword ptr [ESP + 0x38]
006a3711 : XOR EBX,EBX
006a3713 : ADD ESP,0x4
006a3716 : MOV dword ptr [ESP + 0x2c],EBX
006a371a : MOV dword ptr [ESP + 0x1c],EBX
006a371e : MOV dword ptr [ESP + 0x38],EBX
006a3722 : MOV dword ptr [ESP + 0x20],EBX
006a3726 : CMP dword ptr [EDI],ECX
006a3728 : JNC 0x006a3a65
006a372e : MOV EDI,dword ptr [ESP + 0x48]
006a3732 : MOV ECX,dword ptr [ESP + 0x4c]
006a3736 : MOV EAX,dword ptr [ECX]
006a3738 : MOV dword ptr [ESP + 0x30],EAX
006a373c : MOV AL,byte ptr [EAX]
006a373e : CMP AL,0x5d
006a3740 : JZ 0x006a3a70
006a3746 : CMP AL,0x3c
006a3748 : JNZ 0x006a37d9
006a374e : MOV EDX,dword ptr [ECX + 0x20]
006a3751 : PUSH ECX
006a3752 : CALL EDX
006a3754 : MOV EAX,dword ptr [ESP + 0x50]
006a3758 : ADD ESP,0x4
006a375b : CMP dword ptr [EAX + 0xc],0x0
006a375f : JNZ 0x006a3a91
006a3765 : MOV EAX,dword ptr [EAX]
006a3767 : SUB EAX,dword ptr [ESP + 0x30]
006a376b : MOV ECX,dword ptr [ESP + 0x18]
006a376f : DEC EAX
006a3770 : CDQ
006a3771 : SUB EAX,EDX
006a3773 : MOV EDX,dword ptr [ESP + 0x38]
006a3777 : MOV EBX,EAX
006a3779 : LEA EAX,[ESP + 0x14]
006a377d : PUSH EAX
006a377e : MOV EAX,dword ptr [ESP + 0x28]
006a3782 : PUSH ECX
006a3783 : SAR EBX,0x1
006a3785 : PUSH EBX
006a3786 : PUSH EDX
006a3787 : PUSH 0x1
006a3789 : PUSH EAX
006a378a : CALL 0x0068a220
006a378f : MOV dword ptr [ESP + 0x30],EAX
006a3793 : MOV EAX,dword ptr [ESP + 0x2c]
006a3797 : ADD ESP,0x18
006a379a : TEST EAX,EAX
006a379c : JNZ 0x006a3a8a
006a37a2 : MOV EAX,dword ptr [ESP + 0x4c]
006a37a6 : MOV ECX,dword ptr [ESP + 0x30]
006a37aa : PUSH 0x1
006a37ac : LEA EDX,[ESP + 0x40]
006a37b0 : PUSH EDX
006a37b1 : MOV EDX,dword ptr [EAX + 0x2c]
006a37b4 : MOV dword ptr [EAX],ECX
006a37b6 : MOV ECX,dword ptr [ESP + 0x20]
006a37ba : PUSH EBX
006a37bb : PUSH ECX
006a37bc : PUSH EAX
006a37bd : MOV byte ptr [ESP + 0x27],0x1
006a37c2 : CALL EDX
006a37c4 : MOV EAX,dword ptr [ESP + 0x50]
006a37c8 : MOV dword ptr [ESP + 0x4c],EBX
006a37cc : MOV EBX,dword ptr [ESP + 0x34]
006a37d0 : ADD ESP,0x14
006a37d3 : MOV dword ptr [ESP + 0x1c],EAX
006a37d7 : JMP 0x006a3831
006a37d9 : MOVZX EDX,AL
006a37dc : SUB EDX,0x30
006a37df : CMP EDX,0xa
006a37e2 : JNC 0x006a3831
006a37e4 : CMP byte ptr [ESP + 0x13],0x0
006a37e9 : JNZ 0x006a3a74
006a37ef : MOV EAX,dword ptr [ECX + 0x24]
006a37f2 : PUSH ECX
006a37f3 : CALL EAX
006a37f5 : MOV dword ptr [ESP + 0x20],EAX
006a37f9 : MOV EAX,dword ptr [ESP + 0x50]
006a37fd : MOV ECX,dword ptr [EAX + 0x20]
006a3800 : PUSH EAX
006a3801 : CALL ECX
006a3803 : MOV ECX,dword ptr [ESP + 0x54]
006a3807 : ADD ESP,0x8
006a380a : CMP dword ptr [ECX + 0xc],0x0
006a380e : JNZ 0x006a3aaa
006a3814 : MOV EAX,dword ptr [ECX]
006a3816 : LEA EDX,[EAX + 0x1]
006a3819 : MOV dword ptr [ESP + 0x18],EDX
006a381d : MOV EDX,dword ptr [ESP + 0x1c]
006a3821 : LEA EAX,[EAX + EDX*0x1 + 0x1]
006a3825 : MOV dword ptr [ECX],EAX
006a3827 : CMP EAX,dword ptr [ESP + 0x34]
006a382b : JNC 0x006a3a74
006a3831 : MOV EDX,dword ptr [ESP + 0x18]
006a3835 : TEST EDX,EDX
006a3837 : JZ 0x006a3a81
006a383d : MOV EAX,dword ptr [ESP + 0x1c]
006a3841 : CMP byte ptr [EAX + EDX*0x1 + -0x1],0x0
006a3846 : JNZ 0x006a3861
006a3848 : MOV ECX,EAX
006a384a : AND ECX,0x80000001
006a3850 : JNS 0x006a3857
006a3852 : DEC ECX
006a3853 : OR ECX,0xfffffffe
006a3856 : INC ECX
006a3857 : CMP ECX,0x1
006a385a : JNZ 0x006a3861
006a385c : DEC EAX
006a385d : MOV dword ptr [ESP + 0x1c],EAX
006a3861 : TEST EAX,EAX
006a3863 : JZ 0x006a3a81
006a3869 : XOR ECX,ECX
006a386b : MOV dword ptr [ESP + 0x30],ECX
006a386f : TEST EAX,EAX
006a3871 : JLE 0x006a3a46
006a3877 : JMP 0x006a3884
006a3880 : MOV EDX,dword ptr [ESP + 0x18]
006a3884 : MOV EAX,dword ptr [ESP + 0x2c]
006a3888 : SUB EAX,0x0
006a388b : JZ 0x006a38a0
006a388d : SUB EAX,0x1
006a3890 : JZ 0x006a3901
006a3892 : SUB EAX,0x1
006a3895 : JZ 0x006a3a1e
006a389b : JMP 0x006a3a37
006a38a0 : MOV EAX,dword ptr [EDI + 0x1ec]
006a38a6 : CMP EBX,0xc
006a38a9 : JNC 0x006a38b6
006a38ab : MOV DL,byte ptr [ECX + EDX*0x1]
006a38ae : MOV byte ptr [EBX + EAX*0x1],DL
006a38b1 : JMP 0x006a3a32
006a38b6 : MOVZX EBP,byte ptr [EAX + 0x4]
006a38ba : MOVZX ECX,byte ptr [EAX + 0x5]
006a38be : SHL EBP,0x4
006a38c1 : ADD EBP,ECX
006a38c3 : LEA EDX,[ESP + 0x14]
006a38c7 : PUSH EDX
006a38c8 : PUSH EAX
006a38c9 : MOV EAX,dword ptr [ESP + 0x2c]
006a38cd : MOV ESI,EBP
006a38cf : SHL ESI,0x4
006a38d2 : ADD ESI,0xc
006a38d5 : PUSH ESI
006a38d6 : PUSH 0xc
006a38d8 : PUSH 0x1
006a38da : PUSH EAX
006a38db : MOV dword ptr [ESP + 0x44],0x1
006a38e3 : CALL 0x0068a220
006a38e8 : MOV dword ptr [EDI + 0x1ec],EAX
006a38ee : MOV EAX,dword ptr [ESP + 0x2c]
006a38f2 : ADD ESP,0x18
006a38f5 : TEST EAX,EAX
006a38f7 : JNZ 0x006a3a8a
006a38fd : MOV ECX,dword ptr [ESP + 0x30]
006a3901 : CMP EBX,ESI
006a3903 : JC 0x006a3a22
006a3909 : XOR EAX,EAX
006a390b : CMP EBP,0x2
006a390e : MOV dword ptr [ESP + 0x2c],EAX
006a3912 : MOV dword ptr [ESP + 0x28],EAX
006a3916 : JL 0x006a3991
006a3918 : MOV EAX,dword ptr [EDI + 0x1ec]
006a391e : LEA ECX,[EBP + -0x2]
006a3921 : SHR ECX,0x1
006a3923 : ADD EAX,0x1a
006a3926 : INC ECX
006a3927 : LEA EDX,[ECX + ECX*0x1]
006a392a : MOV dword ptr [ESP + 0x40],EDX
006a392e : MOV EDI,EDI
006a3930 : MOVZX EDX,byte ptr [EAX + -0x2]
006a3934 : MOVZX EBX,byte ptr [EAX + -0x1]
006a3938 : SHL EDX,0x8
006a393b : OR EDX,EBX
006a393d : MOVZX EBX,byte ptr [EAX]
006a3940 : SHL EDX,0x8
006a3943 : OR EDX,EBX
006a3945 : MOVZX EBX,byte ptr [EAX + 0x1]
006a3949 : SHL EDX,0x8
006a394c : OR EDX,EBX
006a394e : MOVZX EBX,byte ptr [EAX + 0xf]
006a3952 : ADD EDX,0x3
006a3955 : AND EDX,0xfffffffc
006a3958 : ADD dword ptr [ESP + 0x2c],EDX
006a395c : MOVZX EDX,byte ptr [EAX + 0xe]
006a3960 : SHL EDX,0x8
006a3963 : OR EDX,EBX
006a3965 : MOVZX EBX,byte ptr [EAX + 0x10]
006a3969 : SHL EDX,0x8
006a396c : OR EDX,EBX
006a396e : MOVZX EBX,byte ptr [EAX + 0x11]
006a3972 : SHL EDX,0x8
006a3975 : OR EDX,EBX
006a3977 : ADD EDX,0x3
006a397a : AND EDX,0xfffffffc
006a397d : ADD dword ptr [ESP + 0x28],EDX
006a3981 : ADD EAX,0x20
006a3984 : SUB ECX,0x1
006a3987 : JNZ 0x006a3930
006a3989 : MOV EAX,dword ptr [ESP + 0x40]
006a398d : MOV EBX,dword ptr [ESP + 0x20]
006a3991 : CMP EAX,EBP
006a3993 : JGE 0x006a39ca
006a3995 : MOV ECX,dword ptr [EDI + 0x1ec]
006a399b : SHL EAX,0x4
006a399e : MOVZX EDX,byte ptr [ECX + EAX*0x1 + 0x18]
006a39a3 : LEA EAX,[ECX + EAX*0x1 + 0x18]
006a39a7 : MOVZX ECX,byte ptr [EAX + 0x1]
006a39ab : SHL EDX,0x8
006a39ae : OR EDX,ECX
006a39b0 : MOVZX ECX,byte ptr [EAX + 0x2]
006a39b4 : MOVZX EAX,byte ptr [EAX + 0x3]
006a39b8 : SHL EDX,0x8
006a39bb : OR EDX,ECX
006a39bd : SHL EDX,0x8
006a39c0 : OR EDX,EAX
006a39c2 : ADD EDX,0x3
006a39c5 : AND EDX,0xfffffffc
006a39c8 : ADD ESI,EDX
006a39ca : MOV EDX,dword ptr [ESP + 0x2c]
006a39ce : MOV ECX,dword ptr [ESP + 0x28]
006a39d2 : ADD ECX,EDX
006a39d4 : ADD ESI,ECX
006a39d6 : MOV ECX,dword ptr [EDI + 0x1ec]
006a39dc : LEA EAX,[ESP + 0x14]
006a39e0 : PUSH EAX
006a39e1 : PUSH ECX
006a39e2 : MOV ECX,dword ptr [ESP + 0x2c]
006a39e6 : MOV EAX,EBP
006a39e8 : LEA EDX,[ESI + 0x1]
006a39eb : PUSH EDX
006a39ec : SHL EAX,0x4
006a39ef : ADD EAX,0xc
006a39f2 : PUSH EAX
006a39f3 : PUSH 0x1
006a39f5 : PUSH ECX
006a39f6 : MOV dword ptr [ESP + 0x44],0x2
006a39fe : MOV dword ptr [EDI + 0x1f0],ESI
006a3a04 : CALL 0x0068a220
006a3a09 : MOV dword ptr [EDI + 0x1ec],EAX
006a3a0f : MOV EAX,dword ptr [ESP + 0x2c]
006a3a13 : ADD ESP,0x18
006a3a16 : TEST EAX,EAX
006a3a18 : JNZ 0x006a3a8a
006a3a1a : MOV ECX,dword ptr [ESP + 0x30]
006a3a1e : CMP EBX,ESI
006a3a20 : JNC 0x006a3a81
006a3a22 : MOV EAX,dword ptr [ESP + 0x18]
006a3a26 : MOV EDX,dword ptr [EDI + 0x1ec]
006a3a2c : MOV AL,byte ptr [ECX + EAX*0x1]
006a3a2f : MOV byte ptr [EBX + EDX*0x1],AL
006a3a32 : INC EBX
006a3a33 : MOV dword ptr [ESP + 0x20],EBX
006a3a37 : INC ECX
006a3a38 : CMP ECX,dword ptr [ESP + 0x1c]
006a3a3c : MOV dword ptr [ESP + 0x30],ECX
006a3a40 : JL 0x006a3880
006a3a46 : MOV EAX,dword ptr [ESP + 0x4c]
006a3a4a : MOV ECX,dword ptr [EAX + 0x1c]
006a3a4d : PUSH EAX
006a3a4e : CALL ECX
006a3a50 : MOV EDX,dword ptr [ESP + 0x38]
006a3a54 : MOV EAX,dword ptr [ESP + 0x50]
006a3a58 : ADD ESP,0x4
006a3a5b : CMP dword ptr [EAX],EDX
006a3a5d : JC 0x006a3732
006a3a63 : MOV EDI,EAX
006a3a65 : MOV EAX,0x3
006a3a6a : MOV dword ptr [ESP + 0x14],EAX
006a3a6e : JMP 0x006a3a8e
006a3a70 : INC dword ptr [ECX]
006a3a72 : JMP 0x006a3a91
006a3a74 : MOV EAX,0x3
006a3a79 : MOV dword ptr [ESP + 0x14],EAX
006a3a7d : MOV EDI,ECX
006a3a7f : JMP 0x006a3a8e
006a3a81 : MOV EAX,0x3
006a3a86 : MOV dword ptr [ESP + 0x14],EAX
006a3a8a : MOV EDI,dword ptr [ESP + 0x4c]
006a3a8e : MOV dword ptr [EDI + 0xc],EAX
006a3a91 : CMP byte ptr [ESP + 0x13],0x0
006a3a96 : JZ 0x006a3aaa
006a3a98 : MOV ECX,dword ptr [ESP + 0x18]
006a3a9c : MOV EDX,dword ptr [ESP + 0x24]
006a3aa0 : PUSH ECX
006a3aa1 : PUSH EDX
006a3aa2 : CALL 0x00687f30
006a3aa7 : ADD ESP,0x8
006a3aaa : POP EDI
006a3aab : POP ESI
006a3aac : POP EBP
006a3aad : POP EBX
006a3aae : ADD ESP,0x34
006a3ab1 : RET

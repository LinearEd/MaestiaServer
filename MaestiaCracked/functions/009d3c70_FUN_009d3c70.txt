PROGRAM  : Maestia.exe
FUNCTION : FUN_009d3c70
ENTRY    : 009d3c70
BODY     : [[009d3c70, 009d3f39] [009d3fca, 009d3fed]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009d3c70(int param_1)

{
  undefined2 uVar1;
  ushort *puVar2;
  ushort *puVar3;
  int *piVar4;
  int iVar5;
  undefined4 uVar6;
  int iVar7;
  uint *puVar8;
  uint uVar9;
  undefined1 *puVar10;
  uint local_150;
  undefined1 local_d0 [8];
  undefined1 auStack_c8 [20];
  undefined2 local_b4;
  undefined4 local_a4;
  uint local_a0;
  uint uStack_7c;
  int iStack_78;
  undefined4 local_74;
  int local_70;
  int local_68;
  int local_64;
  int local_60;
  int iStack_5c;
  ushort *local_54;
  ushort *local_50;
  ushort *local_4c;
  int local_48;
  ushort *local_44;
  ushort *local_40;
  ushort *local_3c;
  uint local_38;
  undefined1 local_34 [28];
  uint local_18;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4e724;
  local_10 = ExceptionList;
  local_150 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&local_150;
  ExceptionList = &local_10;
  local_48 = param_1;
  local_64 = 0;
  local_18 = local_150;
  do {
    if (0xfffe < local_64) {
      ExceptionList = local_10;
      __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
      return;
    }
    piVar4 = (int *)FUN_00703c00(0x600);
    if ((piVar4 != (int *)0x0) && ((char)((ushort)(short)piVar4[1] >> 8) == '\x06')) {
      local_68 = piVar4[0x13];
      if ((piVar4[0x12] & 0x40U) == 0) {
        if ((piVar4[0x12] & 0x10U) == 0) {
LAB_009d3d3a:
          FUN_0040eef0(piVar4 + 6);
          local_8 = 0;
          FUN_00824120(DAT_0172491c);
          local_8 = CONCAT31(local_8._1_3_,2);
          if (7 < local_a0) {
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          local_a0 = 7;
          local_a4 = 0;
          local_b4 = 0;
          local_4c = (ushort *)0x0;
          local_54 = (ushort *)0x0;
          local_50 = (ushort *)0x0;
          local_8._0_1_ = 3;
          iVar5 = FUN_006f0300(0x30);
          local_8._0_1_ = 4;
          local_40 = (ushort *)iVar5;
          if (iVar5 == 0) {
            local_4c = (ushort *)0x0;
          }
          else {
            iVar7 = piVar4[1];
            uVar1 = *(undefined2 *)((int)piVar4 + 6);
            puVar10 = local_34;
            uVar6 = FUN_009d2a90(puVar10);
            local_4c = (ushort *)FUN_0041bdf0(iVar5,CONCAT22((short)iVar7,uVar1),uVar6,puVar10);
          }
          local_8._0_1_ = 3;
          local_3c = local_4c;
          iVar5 = FUN_006f0300(0x30);
          local_8._0_1_ = 5;
          local_40 = (ushort *)iVar5;
          if (iVar5 == 0) {
            local_44 = (ushort *)0x0;
          }
          else {
            iVar7 = piVar4[1];
            uVar1 = *(undefined2 *)((int)piVar4 + 6);
            puVar10 = local_34;
            uVar6 = FUN_009d2a90(puVar10);
            local_44 = (ushort *)FUN_0041bdf0(iVar5,CONCAT22((short)iVar7,uVar1),uVar6,puVar10);
          }
          local_8._0_1_ = 3;
          local_54 = local_44;
          iVar5 = FUN_006f0300(0x30);
          local_8 = CONCAT31(local_8._1_3_,6);
          local_68 = iVar5;
          if (iVar5 == 0) {
            local_40 = (ushort *)0x0;
          }
          else {
            iVar7 = piVar4[1];
            uVar1 = *(undefined2 *)((int)piVar4 + 6);
            puVar10 = local_34;
            uVar6 = FUN_009d2a90(puVar10);
            local_40 = (ushort *)FUN_0041bdf0(iVar5,CONCAT22((short)iVar7,uVar1),uVar6,puVar10);
          }
          puVar2 = local_40;
          local_8 = 2;
          local_50 = local_40;
          iVar7 = (**(code **)(*piVar4 + 0x3c))();
          puVar3 = local_3c;
          iVar5 = local_48;
          if (iVar7 != 0) {
            *puVar2 = (ushort)*(byte *)(piVar4 + 0x10);
            *local_3c = (ushort)*(byte *)(piVar4 + 0x10);
            *local_44 = (ushort)*(byte *)(piVar4 + 0x10);
          }
          local_3c = local_3c + 0x16;
          FUN_004437f0(local_3c);
          puVar2 = local_44;
          if (local_38 == *(uint *)(iVar5 + 0x140)) {
            local_60 = 0;
            local_8 = CONCAT31(local_8._1_3_,9);
            local_68 = FUN_006f0300(0x10);
            local_70 = 0;
            if (local_68 != 0) {
              *(undefined4 *)(local_68 + 4) = 0;
              *(undefined4 *)(local_68 + 8) = 0;
              *(undefined4 *)(local_68 + 0xc) = 0;
              local_70 = local_68;
            }
            local_8 = 2;
            local_60 = local_70;
            FUN_00449730();
            local_74 = *(undefined4 *)local_3c;
            FUN_00419ac0(local_d0,&local_74);
            FUN_009d3fee();
            return;
          }
          if (*(int *)(local_38 + 0x10) != 0) {
            FUN_00449730();
            FUN_009d3fee();
            return;
          }
          if (puVar3 != (ushort *)0x0) {
            FUN_00414770(puVar3);
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
          uVar9 = *(uint *)(local_44 + 0x16) >> 0x10 & 0xff;
          local_38 = uVar9;
          puVar8 = (uint *)FUN_004437f0(&local_38);
          local_38 = *puVar8;
          if (local_38 == *(uint *)(local_48 + 0x140)) {
            iStack_5c = 0;
            local_8 = CONCAT31(local_8._1_3_,0xd);
            local_68 = FUN_006f0300(0x10);
            iStack_78 = 0;
            if (local_68 != 0) {
              *(undefined4 *)(local_68 + 4) = 0;
              *(undefined4 *)(local_68 + 8) = 0;
              *(undefined4 *)(local_68 + 0xc) = 0;
              iStack_78 = local_68;
            }
            local_8 = 2;
            iStack_5c = iStack_78;
            FUN_00449730();
            uStack_7c = uVar9;
            FUN_00419ac0(auStack_c8,&uStack_7c);
            FUN_009d4136();
            return;
          }
          if (*(int *)(local_38 + 0x10) != 0) {
            FUN_00449730();
            FUN_009d4136();
            return;
          }
          FUN_00414770(puVar2);
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        if ((short)piVar4[1] == 0x674) {
          iVar5 = FUN_004049b0(*(ushort *)((int)piVar4 + 6) | 0x6740000);
          if ((iVar5 != 0) && (*(short *)(iVar5 + 0x180) == 0x23)) goto LAB_009d3d3a;
        }
      }
    }
    local_64 = local_64 + 1;
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
009d3c70 : PUSH EBP
009d3c71 : MOV EBP,ESP
009d3c73 : PUSH -0x1
009d3c75 : PUSH 0xb4e724
009d3c7a : MOV EAX,FS:[0x0]
009d3c80 : PUSH EAX
009d3c81 : SUB ESP,0x130
009d3c87 : MOV EAX,[0x00d66fa0]
009d3c8c : XOR EAX,EBP
009d3c8e : MOV dword ptr [EBP + -0x14],EAX
009d3c91 : PUSH EBX
009d3c92 : PUSH ESI
009d3c93 : PUSH EDI
009d3c94 : PUSH EAX
009d3c95 : LEA EAX,[EBP + -0xc]
009d3c98 : MOV FS:[0x0],EAX
009d3c9e : MOV dword ptr [EBP + -0x10],ESP
009d3ca1 : MOV EAX,dword ptr [EBP + 0x8]
009d3ca4 : MOV dword ptr [EBP + -0x44],EAX
009d3ca7 : XOR EDI,EDI
009d3ca9 : MOV dword ptr [EBP + -0x60],EDI
009d3cac : LEA ESP,[ESP]
009d3cb0 : CMP EDI,0xffff
009d3cb6 : JGE 0x009d4382
009d3cbc : PUSH 0x600
009d3cc1 : CALL 0x00703c00
009d3cc6 : ADD ESP,0x4
009d3cc9 : MOV EBX,EAX
009d3ccb : TEST EBX,EBX
009d3ccd : JZ 0x009d4377
009d3cd3 : MOVZX ESI,word ptr [EBX + 0x4]
009d3cd7 : MOV ECX,ESI
009d3cd9 : SHR ECX,0x8
009d3cdc : CMP CL,0x6
009d3cdf : JNZ 0x009d4377
009d3ce5 : MOV ECX,dword ptr [EBX + 0x48]
009d3ce8 : MOV EDX,dword ptr [EBX + 0x4c]
009d3ceb : MOV dword ptr [EBP + -0x64],EDX
009d3cee : MOV EAX,ECX
009d3cf0 : AND EAX,0x40
009d3cf3 : XOR EDX,EDX
009d3cf5 : OR EAX,EDX
009d3cf7 : JNZ 0x009d4377
009d3cfd : AND ECX,0x10
009d3d00 : OR ECX,EAX
009d3d02 : JZ 0x009d3d3a
009d3d04 : MOV EAX,0x674
009d3d09 : CMP SI,AX
009d3d0c : JNZ 0x009d4377
009d3d12 : MOVZX EAX,word ptr [EBX + 0x6]
009d3d16 : OR EAX,0x6740000
009d3d1b : PUSH EAX
009d3d1c : CALL 0x004049b0
009d3d21 : ADD ESP,0x4
009d3d24 : TEST EAX,EAX
009d3d26 : JZ 0x009d4377
009d3d2c : CMP word ptr [EAX + 0x180],0x23
009d3d34 : JNZ 0x009d4377
009d3d3a : LEA ECX,[EBX + 0x18]
009d3d3d : PUSH ECX
009d3d3e : LEA ESI,[EBP + 0xffffff4c]
009d3d44 : CALL 0x0040eef0
009d3d49 : ADD ESP,0x4
009d3d4c : MOV dword ptr [EBP + -0x4],0x0
009d3d53 : MOV EDX,dword ptr [0x0172491c]
009d3d59 : PUSH EDX
009d3d5a : MOV EDX,EAX
009d3d5c : LEA EDI,[EBP + -0x30]
009d3d5f : CALL 0x00824120
009d3d64 : MOV byte ptr [EBP + -0x4],0x2
009d3d68 : CMP dword ptr [EBP + 0xffffff64],0x8
009d3d6f : JC 0x009d3d7c
009d3d71 : MOV ECX,dword ptr [EBP + 0xffffff50]
009d3d77 : CALL 0x006f04e0
009d3d7c : MOV dword ptr [EBP + 0xffffff64],0x7
009d3d86 : XOR EDI,EDI
009d3d88 : MOV dword ptr [EBP + 0xffffff60],EDI
009d3d8e : XOR EAX,EAX
009d3d90 : MOV word ptr [EBP + 0xffffff50],AX
009d3d97 : MOV dword ptr [EBP + -0x48],EDI
009d3d9a : MOV dword ptr [EBP + -0x50],EDI
009d3d9d : MOV dword ptr [EBP + -0x4c],EDI
009d3da0 : MOV byte ptr [EBP + -0x4],0x3
009d3da4 : PUSH 0x30
009d3da6 : CALL 0x006f0300
009d3dab : ADD ESP,0x4
009d3dae : MOV ESI,EAX
009d3db0 : MOV dword ptr [EBP + -0x3c],ESI
009d3db3 : MOV byte ptr [EBP + -0x4],0x4
009d3db7 : CMP ESI,EDI
009d3db9 : JZ 0x009d3ddb
009d3dbb : MOVZX EDI,word ptr [EBX + 0x4]
009d3dbf : SHL EDI,0x10
009d3dc2 : MOVZX ECX,word ptr [EBX + 0x6]
009d3dc6 : OR EDI,ECX
009d3dc8 : LEA EDX,[EBP + -0x30]
009d3dcb : PUSH EDX
009d3dcc : CALL 0x009d2a90
009d3dd1 : PUSH EAX
009d3dd2 : PUSH EDI
009d3dd3 : PUSH ESI
009d3dd4 : CALL 0x0041bdf0
009d3dd9 : JMP 0x009d3ddd
009d3ddb : XOR EAX,EAX
009d3ddd : MOV dword ptr [EBP + -0x38],EAX
009d3de0 : MOV byte ptr [EBP + -0x4],0x3
009d3de4 : MOV dword ptr [EBP + -0x48],EAX
009d3de7 : PUSH 0x30
009d3de9 : CALL 0x006f0300
009d3dee : ADD ESP,0x4
009d3df1 : MOV ESI,EAX
009d3df3 : MOV dword ptr [EBP + -0x3c],ESI
009d3df6 : MOV byte ptr [EBP + -0x4],0x5
009d3dfa : TEST ESI,ESI
009d3dfc : JZ 0x009d3e21
009d3dfe : MOVZX EDI,word ptr [EBX + 0x4]
009d3e02 : SHL EDI,0x10
009d3e05 : MOVZX EAX,word ptr [EBX + 0x6]
009d3e09 : OR EDI,EAX
009d3e0b : LEA ECX,[EBP + -0x30]
009d3e0e : PUSH ECX
009d3e0f : CALL 0x009d2a90
009d3e14 : PUSH EAX
009d3e15 : PUSH EDI
009d3e16 : PUSH ESI
009d3e17 : CALL 0x0041bdf0
009d3e1c : MOV dword ptr [EBP + -0x40],EAX
009d3e1f : JMP 0x009d3e28
009d3e21 : MOV dword ptr [EBP + -0x40],0x0
009d3e28 : MOV byte ptr [EBP + -0x4],0x3
009d3e2c : MOV EDX,dword ptr [EBP + -0x40]
009d3e2f : MOV dword ptr [EBP + -0x50],EDX
009d3e32 : PUSH 0x30
009d3e34 : CALL 0x006f0300
009d3e39 : ADD ESP,0x4
009d3e3c : MOV ESI,EAX
009d3e3e : MOV dword ptr [EBP + -0x64],ESI
009d3e41 : MOV byte ptr [EBP + -0x4],0x6
009d3e45 : TEST ESI,ESI
009d3e47 : JZ 0x009d3e6e
009d3e49 : MOVZX EDI,word ptr [EBX + 0x4]
009d3e4d : SHL EDI,0x10
009d3e50 : MOVZX EAX,word ptr [EBX + 0x6]
009d3e54 : OR EDI,EAX
009d3e56 : LEA ECX,[EBP + -0x30]
009d3e59 : PUSH ECX
009d3e5a : CALL 0x009d2a90
009d3e5f : PUSH EAX
009d3e60 : PUSH EDI
009d3e61 : PUSH ESI
009d3e62 : CALL 0x0041bdf0
009d3e67 : MOV dword ptr [EBP + -0x3c],EAX
009d3e6a : MOV ESI,EAX
009d3e6c : JMP 0x009d3e73
009d3e6e : XOR ESI,ESI
009d3e70 : MOV dword ptr [EBP + -0x3c],ESI
009d3e73 : MOV byte ptr [EBP + -0x4],0x3
009d3e77 : MOV dword ptr [EBP + -0x4c],ESI
009d3e7a : MOV dword ptr [EBP + -0x4],0x2
009d3e81 : MOV EDX,dword ptr [EBX]
009d3e83 : MOV ECX,EBX
009d3e85 : MOV EAX,dword ptr [EDX + 0x3c]
009d3e88 : CALL EAX
009d3e8a : MOV EDI,dword ptr [EBP + -0x38]
009d3e8d : TEST EAX,EAX
009d3e8f : JZ 0x009d3eac
009d3e91 : MOVZX CX,byte ptr [EBX + 0x40]
009d3e96 : MOV word ptr [ESI],CX
009d3e99 : MOVZX DX,byte ptr [EBX + 0x40]
009d3e9e : MOV word ptr [EDI],DX
009d3ea1 : MOVZX AX,byte ptr [EBX + 0x40]
009d3ea6 : MOV ECX,dword ptr [EBP + -0x40]
009d3ea9 : MOV word ptr [ECX],AX
009d3eac : LEA EAX,[EDI + 0x2c]
009d3eaf : MOV dword ptr [EBP + -0x38],EAX
009d3eb2 : MOV EBX,dword ptr [EBP + -0x44]
009d3eb5 : LEA ESI,[EBX + 0x13c]
009d3ebb : PUSH EAX
009d3ebc : LEA EAX,[EBP + -0x34]
009d3ebf : MOV ECX,ESI
009d3ec1 : CALL 0x004437f0
009d3ec6 : MOV EBX,dword ptr [EBX + 0x140]
009d3ecc : MOV EAX,dword ptr [EBP + -0x34]
009d3ecf : CMP EAX,EBX
009d3ed1 : JNZ 0x009d3fca
009d3ed7 : XOR EBX,EBX
009d3ed9 : MOV dword ptr [EBP + -0x5c],EBX
009d3edc : MOV byte ptr [EBP + -0x4],0x9
009d3ee0 : PUSH 0x10
009d3ee2 : CALL 0x006f0300
009d3ee7 : ADD ESP,0x4
009d3eea : MOV dword ptr [EBP + -0x64],EAX
009d3eed : MOV byte ptr [EBP + -0x4],0xa
009d3ef1 : CMP EAX,EBX
009d3ef3 : JZ 0x009d3f00
009d3ef5 : MOV dword ptr [EAX + 0x4],EBX
009d3ef8 : MOV dword ptr [EAX + 0x8],EBX
009d3efb : MOV dword ptr [EAX + 0xc],EBX
009d3efe : MOV EBX,EAX
009d3f00 : MOV byte ptr [EBP + -0x4],0x9
009d3f04 : MOV dword ptr [EBP + -0x5c],EBX
009d3f07 : MOV dword ptr [EBP + -0x4],0x2
009d3f0e : LEA EDI,[EBP + -0x48]
009d3f11 : MOV EDX,EBX
009d3f13 : CALL 0x00449730
009d3f18 : MOV EDX,dword ptr [EBP + -0x38]
009d3f1b : MOV EAX,dword ptr [EDX]
009d3f1d : MOV dword ptr [EBP + -0x70],EAX
009d3f20 : MOV dword ptr [EBP + -0x6c],EBX
009d3f23 : LEA ECX,[EBP + -0x70]
009d3f26 : PUSH ECX
009d3f27 : LEA EDX,[EBP + 0xffffff34]
009d3f2d : PUSH EDX
009d3f2e : MOV EAX,ESI
009d3f30 : CALL 0x00419ac0
009d3f35 : JMP 0x009d3fee
009d3fca : MOV EAX,dword ptr [EAX + 0x10]
009d3fcd : TEST EAX,EAX
009d3fcf : JZ 0x009d3fdd
009d3fd1 : LEA EDI,[EBP + -0x48]
009d3fd4 : MOV EDX,EAX
009d3fd6 : CALL 0x00449730
009d3fdb : JMP 0x009d3fee
009d3fdd : TEST EDI,EDI
009d3fdf : JZ 0x009d3fee
009d3fe1 : PUSH EDI
009d3fe2 : CALL 0x00414770
009d3fe7 : MOV ECX,EDI
009d3fe9 : CALL 0x006f04e0

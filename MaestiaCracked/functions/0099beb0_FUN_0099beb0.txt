PROGRAM  : Maestia.exe
FUNCTION : FUN_0099beb0
ENTRY    : 0099beb0
BODY     : [[0099beb0, 0099c0ce]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0099beb0(undefined4 param_1,int param_2,undefined1 param_3,undefined4 param_4,
                 undefined2 param_5,undefined2 param_6,double param_7)

{
  undefined4 *puVar1;
  int *piVar2;
  int *piVar3;
  int iVar4;
  int in_ECX;
  int iVar5;
  _SYSTEMTIME local_220;
  int local_210;
  undefined2 local_20c;
  undefined1 local_20a [514];
  uint local_8;
  
  iVar5 = param_2;
  local_8 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  FUN_004437f0(&param_1);
  if (local_210 != *(int *)(in_ECX + 4)) {
    if (iVar5 == 0xffff) {
      iVar4 = *(int *)(local_210 + 0x10);
      if (*(int *)(iVar4 + 0x14) == 1) {
        if (*(uint *)(iVar4 + 0x40) < 8) {
          iVar4 = iVar4 + 0x2c;
        }
        else {
          iVar4 = *(int *)(iVar4 + 0x2c);
        }
        FUN_009adfc0(*(undefined4 *)(*DAT_00da9894 + 0x1a8),5,iVar4);
        *(undefined4 *)(*(int *)(local_210 + 0x10) + 0x14) = 0;
      }
    }
    else if ((iVar5 == 0xfffc) || (*(int *)(*(int *)(local_210 + 0x10) + 0x14) == 0)) {
      iVar4 = *(int *)(local_210 + 0x10);
      if (*(uint *)(iVar4 + 0x40) < 8) {
        iVar4 = iVar4 + 0x2c;
      }
      else {
        iVar4 = *(int *)(iVar4 + 0x2c);
      }
      FUN_009adfc0(*(undefined4 *)(*DAT_00da9894 + 0x1a8),5,iVar4);
      *(undefined4 *)(*(int *)(local_210 + 0x10) + 0x14) = 1;
    }
    *(int *)(*(int *)(local_210 + 0x10) + 0xc) = iVar5;
    *(undefined1 *)(*(int *)(local_210 + 0x10) + 10) = param_3;
    *(undefined4 *)(*(int *)(local_210 + 0x10) + 4) = param_4;
    *(undefined2 *)(*(int *)(local_210 + 0x10) + 8) = param_5;
    *(undefined2 *)(*(int *)(local_210 + 0x10) + 0x18) = param_6;
    if ((iVar5 == 0xffff) && (0.0 < param_7)) {
      VariantTimeToSystemTime(param_7,&local_220);
      local_20c = 0;
      _memset(local_20a,0,0x1fe);
      FUN_004214d0(L"%d-%d %d:%d",local_220.wMonth,local_220.wDay,local_220.wHour,local_220.wMinute)
      ;
      FUN_00405c00(*(int *)(local_210 + 0x10) + 0x44);
      *(double *)(*(int *)(local_210 + 0x10) + 0x20) = param_7;
    }
    piVar3 = DAT_00da9894;
    puVar1 = *(undefined4 **)(local_210 + 0x10);
    if (((puVar1[3] == 0xfffd) && (*(char *)((int)puVar1 + 0x61) == '\0')) &&
       (*(char *)(puVar1 + 0x18) != '\0')) {
      if (((*DAT_00da9894 != 0) && (piVar2 = *(int **)(*DAT_00da9894 + 0x150), piVar2 != (int *)0x0)
          ) && (*piVar2 != 0)) {
        FUN_0099ba50(*puVar1);
      }
      iVar5 = *(int *)(local_210 + 0x10);
      if (*(uint *)(iVar5 + 0x40) < 8) {
        iVar5 = iVar5 + 0x2c;
      }
      else {
        iVar5 = *(int *)(iVar5 + 0x2c);
      }
      FUN_009adfc0(*(undefined4 *)(*piVar3 + 0x1a8),3,iVar5);
    }
  }
  __security_check_cookie(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0099beb0 : PUSH EBP
0099beb1 : MOV EBP,ESP
0099beb3 : SUB ESP,0x21c
0099beb9 : MOV EAX,[0x00d66fa0]
0099bebe : XOR EAX,EBP
0099bec0 : MOV dword ptr [EBP + -0x4],EAX
0099bec3 : PUSH EBX
0099bec4 : MOV EBX,dword ptr [EBP + 0xc]
0099bec7 : PUSH ESI
0099bec8 : PUSH EDI
0099bec9 : LEA EAX,[EBP + 0x8]
0099becc : PUSH EAX
0099becd : LEA EAX,[EBP + 0xfffffdf4]
0099bed3 : MOV ESI,ECX
0099bed5 : CALL 0x004437f0
0099beda : MOV EDI,dword ptr [EBP + 0xfffffdf4]
0099bee0 : CMP EDI,dword ptr [ESI + 0x4]
0099bee3 : JZ 0x0099c0bc
0099bee9 : CMP EBX,0xffff
0099beef : JNZ 0x0099bf34
0099bef1 : MOV EAX,dword ptr [EDI + 0x10]
0099bef4 : CMP dword ptr [EAX + 0x14],0x1
0099bef8 : JNZ 0x0099bf81
0099befe : CMP dword ptr [EAX + 0x40],0x8
0099bf02 : JC 0x0099bf09
0099bf04 : MOV EAX,dword ptr [EAX + 0x2c]
0099bf07 : JMP 0x0099bf0c
0099bf09 : ADD EAX,0x2c
0099bf0c : MOV ECX,dword ptr [0x00da9894]
0099bf12 : MOV EDX,dword ptr [ECX]
0099bf14 : PUSH EAX
0099bf15 : MOV EAX,dword ptr [EDX + 0x1a8]
0099bf1b : PUSH 0x5
0099bf1d : PUSH EAX
0099bf1e : MOV ECX,0xc87f38
0099bf23 : CALL 0x009adfc0
0099bf28 : MOV ECX,dword ptr [EDI + 0x10]
0099bf2b : MOV dword ptr [ECX + 0x14],0x0
0099bf32 : JMP 0x0099bf7e
0099bf34 : CMP EBX,0xfffc
0099bf3a : JZ 0x0099bf45
0099bf3c : MOV EDX,dword ptr [EDI + 0x10]
0099bf3f : CMP dword ptr [EDX + 0x14],0x0
0099bf43 : JNZ 0x0099bf81
0099bf45 : MOV EAX,dword ptr [EDI + 0x10]
0099bf48 : ADD EAX,0x28
0099bf4b : CMP dword ptr [EAX + 0x18],0x8
0099bf4f : JC 0x0099bf56
0099bf51 : MOV EAX,dword ptr [EAX + 0x4]
0099bf54 : JMP 0x0099bf59
0099bf56 : ADD EAX,0x4
0099bf59 : PUSH EAX
0099bf5a : MOV EAX,[0x00da9894]
0099bf5f : MOV ECX,dword ptr [EAX]
0099bf61 : MOV EDX,dword ptr [ECX + 0x1a8]
0099bf67 : PUSH 0x5
0099bf69 : PUSH EDX
0099bf6a : MOV ECX,0xc87f6c
0099bf6f : CALL 0x009adfc0
0099bf74 : MOV EAX,dword ptr [EDI + 0x10]
0099bf77 : MOV dword ptr [EAX + 0x14],0x1
0099bf7e : ADD ESP,0xc
0099bf81 : MOV ECX,dword ptr [EDI + 0x10]
0099bf84 : MOV AL,byte ptr [EBP + 0x10]
0099bf87 : MOV dword ptr [ECX + 0xc],EBX
0099bf8a : MOV EDX,dword ptr [EDI + 0x10]
0099bf8d : MOV byte ptr [EDX + 0xa],AL
0099bf90 : MOV ECX,dword ptr [EDI + 0x10]
0099bf93 : MOV EDX,dword ptr [EBP + 0x14]
0099bf96 : MOV dword ptr [ECX + 0x4],EDX
0099bf99 : MOV EAX,dword ptr [EDI + 0x10]
0099bf9c : MOV CX,word ptr [EBP + 0x18]
0099bfa0 : MOV word ptr [EAX + 0x8],CX
0099bfa4 : MOV EDX,dword ptr [EDI + 0x10]
0099bfa7 : MOV AX,word ptr [EBP + 0x1c]
0099bfab : MOV word ptr [EDX + 0x18],AX
0099bfaf : CMP EBX,0xffff
0099bfb5 : JNZ 0x0099c051
0099bfbb : MOVSD XMM0,qword ptr [EBP + 0x20]
0099bfc0 : COMISD XMM0,qword ptr [0x00cdf338]
0099bfc8 : JBE 0x0099c051
0099bfce : FLD double ptr [EBP + 0x20]
0099bfd1 : LEA ECX,[EBP + 0xfffffde4]
0099bfd7 : PUSH ECX
0099bfd8 : SUB ESP,0x8
0099bfdb : FSTP double ptr [ESP]
0099bfde : CALL dword ptr [0x00b853d4]
0099bfe4 : XOR EDX,EDX
0099bfe6 : PUSH 0x1fe
0099bfeb : PUSH EDX
0099bfec : LEA EAX,[EBP + 0xfffffdfa]
0099bff2 : PUSH EAX
0099bff3 : MOV word ptr [EBP + 0xfffffdf8],DX
0099bffa : CALL 0x0063b700
0099bfff : MOVZX ECX,word ptr [EBP + 0xfffffdee]
0099c006 : MOVZX EDX,word ptr [EBP + 0xfffffdec]
0099c00d : MOVZX EAX,word ptr [EBP + 0xfffffdea]
0099c014 : PUSH ECX
0099c015 : MOVZX ECX,word ptr [EBP + 0xfffffde6]
0099c01c : PUSH EDX
0099c01d : PUSH EAX
0099c01e : PUSH ECX
0099c01f : PUSH 0xc87f9c
0099c024 : LEA EDX,[EBP + 0xfffffdf8]
0099c02a : CALL 0x004214d0
0099c02f : MOV EDX,dword ptr [EDI + 0x10]
0099c032 : ADD EDX,0x44
0099c035 : ADD ESP,0x20
0099c038 : PUSH EDX
0099c039 : LEA EDX,[EBP + 0xfffffdf8]
0099c03f : CALL 0x00405c00
0099c044 : MOV EAX,dword ptr [EDI + 0x10]
0099c047 : MOVSD XMM0,qword ptr [EBP + 0x20]
0099c04c : MOVSD qword ptr [EAX + 0x20],XMM0
0099c051 : MOV ECX,dword ptr [EDI + 0x10]
0099c054 : CMP dword ptr [ECX + 0xc],0xfffd
0099c05b : JNZ 0x0099c0bc
0099c05d : CMP byte ptr [ECX + 0x61],0x0
0099c061 : JNZ 0x0099c0bc
0099c063 : CMP byte ptr [ECX + 0x60],0x0
0099c067 : JZ 0x0099c0bc
0099c069 : MOV EBX,dword ptr [0x00da9894]
0099c06f : MOV EAX,dword ptr [EBX]
0099c071 : TEST EAX,EAX
0099c073 : JZ 0x0099c08f
0099c075 : MOV EAX,dword ptr [EAX + 0x150]
0099c07b : TEST EAX,EAX
0099c07d : JZ 0x0099c08f
0099c07f : MOV EAX,dword ptr [EAX]
0099c081 : TEST EAX,EAX
0099c083 : JZ 0x0099c08f
0099c085 : MOV ECX,dword ptr [ECX]
0099c087 : PUSH ECX
0099c088 : MOV ESI,EAX
0099c08a : CALL 0x0099ba50
0099c08f : MOV EDI,dword ptr [EDI + 0x10]
0099c092 : ADD EDI,0x28
0099c095 : CMP dword ptr [EDI + 0x18],0x8
0099c099 : JC 0x0099c0a0
0099c09b : MOV EDI,dword ptr [EDI + 0x4]
0099c09e : JMP 0x0099c0a3
0099c0a0 : ADD EDI,0x4
0099c0a3 : MOV EDX,dword ptr [EBX]
0099c0a5 : MOV EAX,dword ptr [EDX + 0x1a8]
0099c0ab : PUSH EDI
0099c0ac : PUSH 0x3
0099c0ae : PUSH EAX
0099c0af : MOV ECX,0xc87fb4
0099c0b4 : CALL 0x009adfc0
0099c0b9 : ADD ESP,0xc
0099c0bc : MOV ECX,dword ptr [EBP + -0x4]
0099c0bf : POP EDI
0099c0c0 : POP ESI
0099c0c1 : XOR ECX,EBP
0099c0c3 : POP EBX
0099c0c4 : CALL 0x00633e6b
0099c0c9 : MOV ESP,EBP
0099c0cb : POP EBP
0099c0cc : RET 0x20

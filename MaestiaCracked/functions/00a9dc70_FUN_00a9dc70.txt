PROGRAM  : Maestia.exe
FUNCTION : FUN_00a9dc70
ENTRY    : 00a9dc70
BODY     : [[00a9dc70, 00a9de3a]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00a9dc70(int param_1)

{
  undefined4 uVar1;
  int *piVar2;
  int iVar3;
  char cVar4;
  uint uVar5;
  int iVar6;
  uint local_34;
  undefined1 local_30 [4];
  undefined2 local_2c;
  undefined4 local_1c;
  uint local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  iVar3 = param_1;
  iVar6 = DAT_00d7c54c;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b23ddd;
  local_10 = ExceptionList;
  uVar5 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  uVar1 = *(undefined4 *)(param_1 + 0x10);
  param_1 = uVar1;
  FUN_004437f0(&param_1);
  if ((local_14 == *(int *)(iVar6 + 0x44)) ||
     (piVar2 = *(int **)(local_14 + 0x10), piVar2 == (int *)0x0)) {
    iVar6 = FUN_00404750(L"Invalide SkillData %d",uVar1);
    local_8 = 0;
    if (*(uint *)(iVar6 + 0x18) < 8) {
      iVar6 = iVar6 + 4;
    }
    else {
      iVar6 = *(int *)(iVar6 + 4);
    }
    FUN_00406460(iVar6);
    local_8._0_1_ = 1;
    if ((int *)*DAT_00da98e8 != (int *)0x0) {
      (**(code **)(*(int *)*DAT_00da98e8 + 0x14))(L"AvaSkill::CheckMovingCasting",0x6a,local_30);
    }
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c = 0;
    local_8 = 0xffffffff;
    if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  else {
    iVar6 = (**(code **)(*piVar2 + 0x38))(uVar5);
    if (iVar6 == 0) {
      ExceptionList = local_10;
      return 1;
    }
    param_1 = 0;
    iVar6 = FUN_008413b0(*(undefined4 *)(iVar3 + 0x10),0);
    if (iVar6 != 0) {
      uVar5 = (uint)*(byte *)(iVar6 + 0xb);
      if ((uint)*(ushort *)(piVar2 + 0x82) <= (uint)*(byte *)(iVar6 + 0xb)) {
        uVar5 = (uint)*(ushort *)(piVar2 + 0x82);
      }
      if ((uVar5 == 0) || (uVar5 = uVar5 - 1, -1 < (int)uVar5)) {
        FUN_00841330(*(undefined4 *)(iVar3 + 0x10),0x45,piVar2[uVar5 + 0xf7],&param_1);
        iVar6 = param_1 + piVar2[uVar5 + 0xf7];
        cVar4 = FUN_0040e000();
        if ((cVar4 != '\0') ||
           ((cVar4 = FUN_0040df60(), cVar4 != '\0' || (cVar4 = FUN_0040e9b0(), cVar4 != '\0')))) {
          if ((piVar2[0x10] & 0x400U) != 0) {
            ExceptionList = local_10;
            return 1;
          }
          if (iVar6 == 0) {
            ExceptionList = local_10;
            return 1;
          }
        }
      }
    }
  }
  ExceptionList = local_10;
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00a9dc70 : PUSH EBP
00a9dc71 : MOV EBP,ESP
00a9dc73 : PUSH -0x1
00a9dc75 : PUSH 0xb23ddd
00a9dc7a : MOV EAX,FS:[0x0]
00a9dc80 : PUSH EAX
00a9dc81 : SUB ESP,0x3c
00a9dc84 : PUSH EBX
00a9dc85 : PUSH ESI
00a9dc86 : PUSH EDI
00a9dc87 : MOV EAX,[0x00d66fa0]
00a9dc8c : XOR EAX,EBP
00a9dc8e : PUSH EAX
00a9dc8f : LEA EAX,[EBP + -0xc]
00a9dc92 : MOV FS:[0x0],EAX
00a9dc98 : MOV EBX,dword ptr [EBP + 0x8]
00a9dc9b : MOV EDI,dword ptr [0x00d7c54c]
00a9dca1 : MOV ESI,dword ptr [EBX + 0x10]
00a9dca4 : LEA EAX,[EBP + 0x8]
00a9dca7 : PUSH EAX
00a9dca8 : LEA ECX,[EDI + 0x40]
00a9dcab : LEA EAX,[EBP + -0x10]
00a9dcae : MOV dword ptr [EBP + 0x8],ESI
00a9dcb1 : CALL 0x004437f0
00a9dcb6 : MOV EDI,dword ptr [EDI + 0x44]
00a9dcb9 : MOV EAX,dword ptr [EBP + -0x10]
00a9dcbc : CMP EAX,EDI
00a9dcbe : JZ 0x00a9dccb
00a9dcc0 : MOV EDI,dword ptr [EAX + 0x10]
00a9dcc3 : TEST EDI,EDI
00a9dcc5 : JNZ 0x00a9dd76
00a9dccb : PUSH ESI
00a9dccc : PUSH 0xc9a0e8
00a9dcd1 : LEA ESI,[EBP + -0x48]
00a9dcd4 : CALL 0x00404750
00a9dcd9 : ADD ESP,0x8
00a9dcdc : XOR EDI,EDI
00a9dcde : MOV dword ptr [EBP + -0x4],EDI
00a9dce1 : MOV EBX,0x8
00a9dce6 : CMP dword ptr [EAX + 0x18],EBX
00a9dce9 : JC 0x00a9dcf0
00a9dceb : MOV EAX,dword ptr [EAX + 0x4]
00a9dcee : JMP 0x00a9dcf3
00a9dcf0 : ADD EAX,0x4
00a9dcf3 : PUSH EAX
00a9dcf4 : LEA ECX,[EBP + -0x2c]
00a9dcf7 : CALL 0x00406460
00a9dcfc : MOV byte ptr [EBP + -0x4],0x1
00a9dd00 : MOV ECX,dword ptr [0x00da98e8]
00a9dd06 : MOV ECX,dword ptr [ECX]
00a9dd08 : CMP ECX,EDI
00a9dd0a : JZ 0x00a9dd1e
00a9dd0c : MOV EDX,dword ptr [ECX]
00a9dd0e : MOV EDX,dword ptr [EDX + 0x14]
00a9dd11 : LEA EAX,[EBP + -0x2c]
00a9dd14 : PUSH EAX
00a9dd15 : PUSH 0x6a
00a9dd17 : PUSH 0xc9a114
00a9dd1c : CALL EDX
00a9dd1e : MOV byte ptr [EBP + -0x4],0x0
00a9dd22 : CMP dword ptr [EBP + -0x14],EBX
00a9dd25 : JC 0x00a9dd2f
00a9dd27 : MOV ECX,dword ptr [EBP + -0x28]
00a9dd2a : CALL 0x006f04e0
00a9dd2f : MOV ESI,0x7
00a9dd34 : XOR EAX,EAX
00a9dd36 : MOV dword ptr [EBP + -0x14],ESI
00a9dd39 : MOV dword ptr [EBP + -0x18],EDI
00a9dd3c : MOV word ptr [EBP + -0x28],AX
00a9dd40 : MOV dword ptr [EBP + -0x4],0xffffffff
00a9dd47 : CMP dword ptr [EBP + -0x30],EBX
00a9dd4a : JC 0x00a9dd54
00a9dd4c : MOV ECX,dword ptr [EBP + -0x44]
00a9dd4f : CALL 0x006f04e0
00a9dd54 : XOR ECX,ECX
00a9dd56 : MOV dword ptr [EBP + -0x30],ESI
00a9dd59 : MOV dword ptr [EBP + -0x34],EDI
00a9dd5c : MOV word ptr [EBP + -0x44],CX
00a9dd60 : XOR AL,AL
00a9dd62 : MOV ECX,dword ptr [EBP + -0xc]
00a9dd65 : MOV dword ptr FS:[0x0],ECX
00a9dd6c : POP ECX
00a9dd6d : POP EDI
00a9dd6e : POP ESI
00a9dd6f : POP EBX
00a9dd70 : MOV ESP,EBP
00a9dd72 : POP EBP
00a9dd73 : RET 0x4
00a9dd76 : MOV EDX,dword ptr [EDI]
00a9dd78 : MOV EAX,dword ptr [EDX + 0x38]
00a9dd7b : MOV ECX,EDI
00a9dd7d : CALL EAX
00a9dd7f : TEST EAX,EAX
00a9dd81 : JZ 0x00a9de25
00a9dd87 : MOV EAX,dword ptr [EBX + 0x10]
00a9dd8a : MOV ECX,dword ptr [0x01724910]
00a9dd90 : PUSH 0x0
00a9dd92 : PUSH EAX
00a9dd93 : MOV dword ptr [EBP + 0x8],0x0
00a9dd9a : CALL 0x008413b0
00a9dd9f : TEST EAX,EAX
00a9dda1 : JZ 0x00a9dd60
00a9dda3 : MOVZX ESI,byte ptr [EAX + 0xb]
00a9dda7 : MOVZX EAX,word ptr [EDI + 0x208]
00a9ddae : CMP ESI,EAX
00a9ddb0 : CMOVGE ESI,EAX
00a9ddb3 : TEST ESI,ESI
00a9ddb5 : JZ 0x00a9ddbc
00a9ddb7 : DEC ESI
00a9ddb8 : TEST ESI,ESI
00a9ddba : JL 0x00a9dd60
00a9ddbc : MOV EDX,dword ptr [EDI + ESI*0x4 + 0x3dc]
00a9ddc3 : MOV EAX,dword ptr [EBX + 0x10]
00a9ddc6 : LEA ECX,[EBP + 0x8]
00a9ddc9 : PUSH ECX
00a9ddca : MOV ECX,dword ptr [0x01724910]
00a9ddd0 : PUSH EDX
00a9ddd1 : PUSH 0x45
00a9ddd3 : PUSH EAX
00a9ddd4 : CALL 0x00841330
00a9ddd9 : MOV EBX,dword ptr [EBP + 0x8]
00a9dddc : MOV ECX,dword ptr [0x0172491c]
00a9dde2 : ADD EBX,dword ptr [EDI + ESI*0x4 + 0x3dc]
00a9dde9 : MOV ESI,dword ptr [ECX + 0x17c]
00a9ddef : MOV EAX,ESI
00a9ddf1 : CALL 0x0040e000
00a9ddf6 : TEST AL,AL
00a9ddf8 : JNZ 0x00a9de14
00a9ddfa : MOV EAX,ESI
00a9ddfc : CALL 0x0040df60
00a9de01 : TEST AL,AL
00a9de03 : JNZ 0x00a9de14
00a9de05 : MOV EAX,ESI
00a9de07 : CALL 0x0040e9b0
00a9de0c : TEST AL,AL
00a9de0e : JZ 0x00a9dd60
00a9de14 : TEST dword ptr [EDI + 0x40],0x400
00a9de1b : JNZ 0x00a9de25
00a9de1d : TEST EBX,EBX
00a9de1f : JNZ 0x00a9dd60
00a9de25 : MOV AL,0x1
00a9de27 : MOV ECX,dword ptr [EBP + -0xc]
00a9de2a : MOV dword ptr FS:[0x0],ECX
00a9de31 : POP ECX
00a9de32 : POP EDI
00a9de33 : POP ESI
00a9de34 : POP EBX
00a9de35 : MOV ESP,EBP
00a9de37 : POP EBP
00a9de38 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_00a8cac0
ENTRY    : 00a8cac0
BODY     : [[00a8cac0, 00a8ccbf]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00a8cac0(int param_1)

{
  int iVar1;
  uint uVar2;
  bool bVar3;
  int *piVar4;
  int iVar5;
  int iVar6;
  DWORD DVar7;
  uint uVar8;
  int *piVar9;
  int local_78;
  int local_74;
  uint local_70;
  uint local_6c;
  int *local_68;
  uint local_64;
  int *local_60;
  uint uStack_38;
  void *pvStack_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_00b6b2aa;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  iVar1 = *(int *)(*DAT_00da9894 + 0x130);
  if ((iVar1 != 0) && (*(int *)(iVar1 + 0x40) != 0)) {
    piVar9 = (int *)0x0;
    bVar3 = false;
    local_68 = (int *)0x0;
    local_60 = (int *)0x0;
    local_64 = 0;
    if (*(int *)(*DAT_00da9894 + 0x40) != 0) {
      do {
        piVar4 = (int *)FUN_008eb810();
        if ((piVar4 != (int *)0x0) && ((char)piVar4[0x19] != '\0')) {
          iVar1 = piVar4[0xf];
          if (iVar1 == 0) {
            ExceptionList = local_14;
            return 0;
          }
          uVar2 = *(uint *)(iVar1 + 0xc);
          if ((short)*(uint *)(iVar1 + 8) != 0) {
            local_6c = *(uint *)(iVar1 + 8) & 0xffff;
            local_74 = 0;
            do {
              if ((short)uVar2 != 0) {
                local_70 = uVar2 & 0xffff;
                local_78 = 0;
                do {
                  iVar5 = local_74 * *(int *)(iVar1 + 0xc) + local_78;
                  if (((((iVar5 < *(int *)(iVar1 + 8) * *(int *)(iVar1 + 0xc)) && (-1 < iVar5)) &&
                       (iVar5 = *(int *)(*(int *)(iVar1 + 0x10) + iVar5 * 4), iVar5 != 0)) &&
                      ((piVar9 = *(int **)(iVar5 + 8), piVar9 != (int *)0x0 &&
                       ((char)((uint)piVar9[4] >> 0x10) == 'I')))) &&
                     ((iVar5 = FUN_004049b0(), iVar5 != 0 && (iVar6 = FUN_009f2740(), iVar6 != 0))))
                  {
                    DVar7 = timeGetTime();
                    iVar6 = *(int *)(iVar6 + 0xd8);
                    if ((iVar6 == 0) || (uVar8 = FUN_009ea720(), uVar8 <= DVar7 - iVar6)) {
                      if ((*(uint *)(iVar5 + 0x4c) & 0x400) != 0) {
                        local_68 = piVar9;
                        local_60 = piVar4;
                      }
                    }
                    else {
                      bVar3 = true;
                    }
                  }
                  local_78 = local_78 + 1;
                  local_70 = local_70 - 1;
                } while (local_70 != 0);
              }
              local_74 = local_74 + 1;
              local_6c = local_6c - 1;
              piVar9 = local_68;
            } while (local_6c != 0);
          }
        }
        local_64 = local_64 + 1;
      } while (local_64 < *(uint *)(*DAT_00da9894 + 0x40));
      if (piVar9 != (int *)0x0) {
        (**(code **)(*local_60 + 0x18))();
        (**(code **)(*piVar9 + 0xb4))();
        ExceptionList = pvStack_1c;
        return 1;
      }
    }
    FUN_00406460(&DAT_00c6a058);
    uStack_c = 0xffffffff;
    FUN_008f37b0(2);
    *(undefined1 *)(param_1 + 0x54) = 1;
    if (bVar3) {
      FUN_00406460();
      uStack_c = 3;
      FUN_0081d120();
      uStack_c._0_1_ = 4;
      FUN_008ede80();
      uStack_c = CONCAT31(uStack_c._1_3_,3);
      if ((void *)0x7 < pvStack_1c) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      uStack_c = 0xffffffff;
      if (7 < uStack_38) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
    }
  }
  ExceptionList = local_14;
  return 0;
}



============================================================
DISASSEMBLY
============================================================
00a8cac0 : PUSH EBP
00a8cac1 : MOV EBP,ESP
00a8cac3 : AND ESP,0xfffffff8
00a8cac6 : PUSH -0x1
00a8cac8 : PUSH 0xb6b2aa
00a8cacd : MOV EAX,FS:[0x0]
00a8cad3 : PUSH EAX
00a8cad4 : SUB ESP,0x70
00a8cad7 : PUSH EBX
00a8cad8 : PUSH ESI
00a8cad9 : PUSH EDI
00a8cada : MOV EAX,[0x00d66fa0]
00a8cadf : XOR EAX,ESP
00a8cae1 : PUSH EAX
00a8cae2 : LEA EAX,[ESP + 0x80]
00a8cae9 : MOV FS:[0x0],EAX
00a8caef : MOV EAX,[0x00da9894]
00a8caf4 : MOV EAX,dword ptr [EAX]
00a8caf6 : MOV ECX,dword ptr [EAX + 0x130]
00a8cafc : XOR ESI,ESI
00a8cafe : CMP ECX,ESI
00a8cb00 : JZ 0x00a8cd9f
00a8cb06 : CMP dword ptr [ECX + 0x40],ESI
00a8cb09 : JZ 0x00a8cd9f
00a8cb0f : MOV ECX,dword ptr [EAX + 0x40]
00a8cb12 : XOR EBX,EBX
00a8cb14 : MOV byte ptr [ESP + 0x17],0x0
00a8cb19 : MOV dword ptr [ESP + 0x2c],EBX
00a8cb1d : MOV dword ptr [ESP + 0x34],ESI
00a8cb21 : MOV dword ptr [ESP + 0x30],ESI
00a8cb25 : CMP ECX,ESI
00a8cb27 : JBE 0x00a8ccc0
00a8cb2d : MOV ECX,ESI
00a8cb2f : CALL 0x008eb810
00a8cb34 : MOV dword ptr [ESP + 0x3c],EAX
00a8cb38 : TEST EAX,EAX
00a8cb3a : JZ 0x00a8cc6c
00a8cb40 : CMP byte ptr [EAX + 0x64],0x0
00a8cb44 : JZ 0x00a8cc6c
00a8cb4a : MOV EDI,dword ptr [EAX + 0x3c]
00a8cb4d : MOV dword ptr [ESP + 0x18],EDI
00a8cb51 : TEST EDI,EDI
00a8cb53 : JZ 0x00a8cd9f
00a8cb59 : MOV EAX,dword ptr [EDI + 0x8]
00a8cb5c : MOV ECX,dword ptr [EDI + 0xc]
00a8cb5f : XOR EDX,EDX
00a8cb61 : MOV dword ptr [ESP + 0x40],ECX
00a8cb65 : CMP DX,AX
00a8cb68 : JNC 0x00a8cc6c
00a8cb6e : MOVZX EAX,AX
00a8cb71 : MOV dword ptr [ESP + 0x20],EDX
00a8cb75 : MOV dword ptr [ESP + 0x28],EAX
00a8cb79 : XOR EDX,EDX
00a8cb7b : CMP DX,CX
00a8cb7e : JNC 0x00a8cc51
00a8cb84 : MOVZX EAX,CX
00a8cb87 : MOV dword ptr [ESP + 0x1c],EDX
00a8cb8b : MOV dword ptr [ESP + 0x24],EAX
00a8cb8f : MOV ECX,dword ptr [EDI + 0xc]
00a8cb92 : MOV EAX,dword ptr [ESP + 0x20]
00a8cb96 : MOV EDX,dword ptr [EDI + 0x8]
00a8cb99 : IMUL EAX,ECX
00a8cb9c : ADD EAX,dword ptr [ESP + 0x1c]
00a8cba0 : IMUL EDX,ECX
00a8cba3 : CMP EAX,EDX
00a8cba5 : JGE 0x00a8cc3a
00a8cbab : TEST EAX,EAX
00a8cbad : JL 0x00a8cc3a
00a8cbb3 : MOV ECX,dword ptr [EDI + 0x10]
00a8cbb6 : MOV EAX,dword ptr [ECX + EAX*0x4]
00a8cbb9 : TEST EAX,EAX
00a8cbbb : JZ 0x00a8cc3a
00a8cbbd : MOV EBX,dword ptr [EAX + 0x8]
00a8cbc0 : TEST EBX,EBX
00a8cbc2 : JZ 0x00a8cc3a
00a8cbc4 : MOV ESI,dword ptr [EBX + 0x10]
00a8cbc7 : MOV EAX,ESI
00a8cbc9 : SHR EAX,0x10
00a8cbcc : CMP AL,0x49
00a8cbce : JNZ 0x00a8cc3a
00a8cbd0 : PUSH ESI
00a8cbd1 : CALL 0x004049b0
00a8cbd6 : ADD ESP,0x4
00a8cbd9 : MOV dword ptr [ESP + 0x38],EAX
00a8cbdd : TEST EAX,EAX
00a8cbdf : JZ 0x00a8cc3a
00a8cbe1 : MOV ECX,dword ptr [0x017247f0]
00a8cbe7 : PUSH ESI
00a8cbe8 : CALL 0x009f2740
00a8cbed : MOV ESI,EAX
00a8cbef : TEST ESI,ESI
00a8cbf1 : JZ 0x00a8cc3a
00a8cbf3 : CALL dword ptr [0x00b85598]
00a8cbf9 : MOV ECX,dword ptr [ESI + 0xd8]
00a8cbff : SUB EAX,ECX
00a8cc01 : MOV EDI,EAX
00a8cc03 : TEST ECX,ECX
00a8cc05 : JZ 0x00a8cc17
00a8cc07 : CALL 0x009ea720
00a8cc0c : CMP EDI,EAX
00a8cc0e : JNC 0x00a8cc17
00a8cc10 : MOV byte ptr [ESP + 0x17],0x1
00a8cc15 : JMP 0x00a8cc36
00a8cc17 : MOV EDX,dword ptr [ESP + 0x38]
00a8cc1b : MOV ECX,dword ptr [EDX + 0x4c]
00a8cc1e : AND ECX,0x400
00a8cc24 : XOR EAX,EAX
00a8cc26 : OR EAX,ECX
00a8cc28 : JZ 0x00a8cc36
00a8cc2a : MOV EAX,dword ptr [ESP + 0x3c]
00a8cc2e : MOV dword ptr [ESP + 0x2c],EBX
00a8cc32 : MOV dword ptr [ESP + 0x34],EAX
00a8cc36 : MOV EDI,dword ptr [ESP + 0x18]
00a8cc3a : MOV EAX,0x1
00a8cc3f : ADD dword ptr [ESP + 0x1c],EAX
00a8cc43 : SUB dword ptr [ESP + 0x24],EAX
00a8cc47 : JNZ 0x00a8cb8f
00a8cc4d : MOV ECX,dword ptr [ESP + 0x40]
00a8cc51 : MOV EAX,0x1
00a8cc56 : ADD dword ptr [ESP + 0x20],EAX
00a8cc5a : SUB dword ptr [ESP + 0x28],EAX
00a8cc5e : JNZ 0x00a8cb79
00a8cc64 : MOV EBX,dword ptr [ESP + 0x2c]
00a8cc68 : MOV ESI,dword ptr [ESP + 0x30]
00a8cc6c : MOV ECX,dword ptr [0x00da9894]
00a8cc72 : MOV EAX,dword ptr [ECX]
00a8cc74 : INC ESI
00a8cc75 : MOV dword ptr [ESP + 0x30],ESI
00a8cc79 : CMP ESI,dword ptr [EAX + 0x40]
00a8cc7c : JC 0x00a8cb2d
00a8cc82 : XOR ESI,ESI
00a8cc84 : CMP EBX,ESI
00a8cc86 : JZ 0x00a8ccc0
00a8cc88 : MOV ECX,dword ptr [ESP + 0x34]
00a8cc8c : MOV EDX,dword ptr [ECX]
00a8cc8e : MOV EAX,dword ptr [EDX + 0x18]
00a8cc91 : PUSH 0x12c
00a8cc96 : PUSH 0x1
00a8cc98 : CALL EAX
00a8cc9a : MOV EDX,dword ptr [EBX]
00a8cc9c : MOV EAX,dword ptr [EDX + 0xb4]
00a8cca2 : MOV ECX,EBX
00a8cca4 : CALL EAX
00a8cca6 : MOV AL,0x1
00a8cca8 : MOV ECX,dword ptr [ESP + 0x80]
00a8ccaf : MOV dword ptr FS:[0x0],ECX
00a8ccb6 : POP ECX
00a8ccb7 : POP EDI
00a8ccb8 : POP ESI
00a8ccb9 : POP EBX
00a8ccba : MOV ESP,EBP
00a8ccbc : POP EBP
00a8ccbd : RET 0x4

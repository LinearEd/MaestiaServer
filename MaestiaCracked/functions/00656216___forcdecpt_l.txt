PROGRAM  : Maestia.exe
FUNCTION : __forcdecpt_l
ENTRY    : 00656216
BODY     : [[00656216, 00656288]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    __forcdecpt_l
   
   Library: Visual Studio 2008 Release */

void __cdecl __forcdecpt_l(char *_Buf,_locale_t _Locale)

{
  byte bVar1;
  byte bVar2;
  int iVar3;
  bool bVar4;
  int local_14 [2];
  int local_c;
  char local_8;
  
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_14,_Locale);
  iVar3 = _tolower((int)*_Buf);
  bVar4 = iVar3 == 0x65;
  while (!bVar4) {
    _Buf = (char *)((byte *)_Buf + 1);
    iVar3 = _isdigit((uint)(byte)*_Buf);
    bVar4 = iVar3 == 0;
  }
  iVar3 = _tolower((int)*_Buf);
  if (iVar3 == 0x78) {
    _Buf = (char *)((byte *)_Buf + 2);
  }
  bVar2 = *_Buf;
  *_Buf = *(byte *)**(undefined4 **)(local_14[0] + 0xbc);
  do {
    _Buf = (char *)((byte *)_Buf + 1);
    bVar1 = *_Buf;
    *_Buf = bVar2;
    bVar2 = bVar1;
  } while (*_Buf != 0);
  if (local_8 != '\0') {
    *(uint *)(local_c + 0x70) = *(uint *)(local_c + 0x70) & 0xfffffffd;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00656216 : MOV EDI,EDI
00656218 : PUSH EBP
00656219 : MOV EBP,ESP
0065621b : SUB ESP,0x10
0065621e : PUSH ESI
0065621f : PUSH dword ptr [EBP + 0xc]
00656222 : LEA ECX,[EBP + -0x10]
00656225 : CALL 0x00637880
0065622a : MOV ESI,dword ptr [EBP + 0x8]
0065622d : MOVSX EAX,byte ptr [ESI]
00656230 : PUSH EAX
00656231 : CALL 0x00637a1c
00656236 : CMP EAX,0x65
00656239 : JMP 0x00656247
0065623b : INC ESI
0065623c : MOVZX EAX,byte ptr [ESI]
0065623f : PUSH EAX
00656240 : CALL 0x006397a2
00656245 : TEST EAX,EAX
00656247 : POP ECX
00656248 : JNZ 0x0065623b
0065624a : MOVSX EAX,byte ptr [ESI]
0065624d : PUSH EAX
0065624e : CALL 0x00637a1c
00656253 : POP ECX
00656254 : CMP EAX,0x78
00656257 : JNZ 0x0065625b
00656259 : INC ESI
0065625a : INC ESI
0065625b : MOV ECX,dword ptr [EBP + -0x10]
0065625e : MOV ECX,dword ptr [ECX + 0xbc]
00656264 : MOV ECX,dword ptr [ECX]
00656266 : MOV AL,byte ptr [ESI]
00656268 : MOV CL,byte ptr [ECX]
0065626a : MOV byte ptr [ESI],CL
0065626c : INC ESI
0065626d : MOV CL,byte ptr [ESI]
0065626f : MOV byte ptr [ESI],AL
00656271 : MOV AL,CL
00656273 : MOV CL,byte ptr [ESI]
00656275 : INC ESI
00656276 : TEST CL,CL
00656278 : JNZ 0x0065626d
0065627a : POP ESI
0065627b : CMP byte ptr [EBP + -0x4],CL
0065627e : JZ 0x00656287
00656280 : MOV EAX,dword ptr [EBP + -0x8]
00656283 : AND dword ptr [EAX + 0x70],0xfffffffd
00656287 : LEAVE
00656288 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_009d3ae0
ENTRY    : 009d3ae0
BODY     : [[009d3ae0, 009d3c67]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009d3ae0(int param_1,ushort *param_2)

{
  undefined4 *puVar1;
  uint uVar2;
  undefined4 *puVar3;
  uint uVar4;
  int iVar5;
  __time64_t _Var6;
  undefined4 *local_20;
  int local_1c;
  int local_18;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4e688;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_1c = (*param_2 & 0x1fff) - 5;
  local_18 = (int)param_2 + 5;
  local_14 = 0;
  if ((char)param_2[2] != '\0') {
    do {
      puVar3 = (undefined4 *)FUN_006f0760(0xa8,"",0,(DAT_01725270 >> 3 & 1) == 0,uVar2);
      if (puVar3 == (undefined4 *)0x0) {
        puVar3 = (undefined4 *)0x0;
      }
      else {
        *puVar3 = 0;
        puVar3[1] = 0;
        puVar3[2] = 0;
        puVar3[3] = 0;
        puVar3[4] = 0;
        puVar3[6] = 0;
        puVar3[7] = 0;
        *(undefined1 *)(puVar3 + 8) = 0;
        puVar3[9] = 0;
        puVar3[10] = 0;
        puVar3[0xb] = 0;
        puVar3[0xc] = 0;
        puVar3[0xd] = 0;
        *(undefined2 *)(puVar3 + 0xe) = 0;
        *(undefined1 *)((int)puVar3 + 0x3a) = 0;
        *(undefined2 *)(puVar3 + 0xf) = 0;
        puVar3[0x24] = 0;
        puVar3[0x25] = 0;
        puVar3[0x26] = 0;
        *(undefined2 *)(puVar3 + 0x27) = 0;
        puVar3[0x28] = 0;
      }
      local_8 = 0xffffffff;
      local_20 = puVar3;
      if (puVar3 != (undefined4 *)0x0) {
        FUN_0041bb30(&local_18);
        if (*(char *)(puVar3 + 8) != 'h') {
          if (*(char *)(puVar3 + 8) == 'e') {
            _Var6 = __time64((__time64_t *)0x0);
            iVar5 = (int)((ulonglong)_Var6 >> 0x20);
            if (((int)puVar3[7] < iVar5) ||
               (((int)puVar3[7] <= iVar5 && ((uint)puVar3[6] <= (uint)_Var6)))) goto LAB_009d3c3e;
          }
          iVar5 = *(int *)(param_1 + 100);
          if (iVar5 == 0) {
            uVar4 = 0;
          }
          else {
            uVar4 = *(int *)(param_1 + 0x6c) - iVar5 >> 2;
          }
          puVar1 = *(undefined4 **)(param_1 + 0x68);
          if ((uint)((int)puVar1 - iVar5 >> 2) < uVar4) {
            *puVar1 = puVar3;
            *(undefined4 **)(param_1 + 0x68) = puVar1 + 1;
          }
          else {
            FUN_0042fe80(param_1 + 0x60,puVar1,&local_20);
          }
          FUN_009d39e0(param_1);
        }
      }
LAB_009d3c3e:
      local_14 = local_14 + 1;
    } while (local_14 < (int)(uint)(byte)param_2[2]);
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
009d3ae0 : PUSH EBP
009d3ae1 : MOV EBP,ESP
009d3ae3 : PUSH -0x1
009d3ae5 : PUSH 0xb4e688
009d3aea : MOV EAX,FS:[0x0]
009d3af0 : PUSH EAX
009d3af1 : SUB ESP,0x14
009d3af4 : PUSH EBX
009d3af5 : PUSH ESI
009d3af6 : PUSH EDI
009d3af7 : MOV EAX,[0x00d66fa0]
009d3afc : XOR EAX,EBP
009d3afe : PUSH EAX
009d3aff : LEA EAX,[EBP + -0xc]
009d3b02 : MOV FS:[0x0],EAX
009d3b08 : MOV EAX,dword ptr [EBP + 0xc]
009d3b0b : MOVZX EDX,word ptr [EAX]
009d3b0e : AND EDX,0x1fff
009d3b14 : XOR EBX,EBX
009d3b16 : SUB EDX,0x5
009d3b19 : LEA ECX,[EAX + 0x5]
009d3b1c : MOV dword ptr [EBP + -0x14],ECX
009d3b1f : MOV dword ptr [EBP + -0x18],EDX
009d3b22 : MOV dword ptr [EBP + -0x10],EBX
009d3b25 : CMP byte ptr [EAX + 0x4],BL
009d3b28 : JBE 0x009d3c54
009d3b2e : MOV EDI,EDI
009d3b30 : MOV EAX,[0x01725270]
009d3b35 : SHR EAX,0x3
009d3b38 : MOV ECX,0x0
009d3b3d : AND EAX,0x1
009d3b40 : SETZ CL
009d3b43 : PUSH ECX
009d3b44 : PUSH EBX
009d3b45 : PUSH 0xbf1a4a
009d3b4a : PUSH 0xa8
009d3b4f : CALL 0x006f0760
009d3b54 : ADD ESP,0x10
009d3b57 : MOV dword ptr [EBP + -0x1c],EAX
009d3b5a : MOV dword ptr [EBP + -0x4],EBX
009d3b5d : CMP EAX,EBX
009d3b5f : JZ 0x009d3bb9
009d3b61 : XOR EDX,EDX
009d3b63 : XOR ECX,ECX
009d3b65 : MOV dword ptr [EAX],EBX
009d3b67 : MOV dword ptr [EAX + 0x4],EBX
009d3b6a : MOV dword ptr [EAX + 0x8],EBX
009d3b6d : MOV dword ptr [EAX + 0xc],EBX
009d3b70 : MOV dword ptr [EAX + 0x10],EBX
009d3b73 : MOV dword ptr [EAX + 0x18],EBX
009d3b76 : MOV dword ptr [EAX + 0x1c],EBX
009d3b79 : MOV byte ptr [EAX + 0x20],BL
009d3b7c : MOV dword ptr [EAX + 0x24],EBX
009d3b7f : MOV dword ptr [EAX + 0x28],EBX
009d3b82 : MOV dword ptr [EAX + 0x2c],EBX
009d3b85 : MOV dword ptr [EAX + 0x30],EBX
009d3b88 : MOV dword ptr [EAX + 0x34],EBX
009d3b8b : MOV word ptr [EAX + 0x38],DX
009d3b8f : MOV byte ptr [EAX + 0x3a],BL
009d3b92 : MOV word ptr [EAX + 0x3c],CX
009d3b96 : MOV dword ptr [EAX + 0x90],EBX
009d3b9c : MOV dword ptr [EAX + 0x94],EBX
009d3ba2 : MOV dword ptr [EAX + 0x98],EBX
009d3ba8 : MOV word ptr [EAX + 0x9c],DX
009d3baf : MOV dword ptr [EAX + 0xa0],EBX
009d3bb5 : MOV EDI,EAX
009d3bb7 : JMP 0x009d3bbb
009d3bb9 : XOR EDI,EDI
009d3bbb : MOV dword ptr [EBP + -0x4],0xffffffff
009d3bc2 : MOV dword ptr [EBP + -0x1c],EDI
009d3bc5 : CMP EDI,EBX
009d3bc7 : JZ 0x009d3c3e
009d3bc9 : LEA EAX,[EBP + -0x14]
009d3bcc : PUSH EAX
009d3bcd : LEA ESI,[EBP + -0x18]
009d3bd0 : CALL 0x0041bb30
009d3bd5 : MOV AL,byte ptr [EDI + 0x20]
009d3bd8 : CMP AL,0x68
009d3bda : JZ 0x009d3c3e
009d3bdc : CMP AL,0x65
009d3bde : JNZ 0x009d3bf5
009d3be0 : PUSH EBX
009d3be1 : CALL 0x006381ab
009d3be6 : ADD ESP,0x4
009d3be9 : CMP EDX,dword ptr [EDI + 0x1c]
009d3bec : JG 0x009d3c3e
009d3bee : JL 0x009d3bf5
009d3bf0 : CMP EAX,dword ptr [EDI + 0x18]
009d3bf3 : JNC 0x009d3c3e
009d3bf5 : MOV EAX,dword ptr [EBP + 0x8]
009d3bf8 : MOV ESI,dword ptr [EAX + 0x64]
009d3bfb : ADD EAX,0x60
009d3bfe : CMP ESI,EBX
009d3c00 : JNZ 0x009d3c06
009d3c02 : XOR ECX,ECX
009d3c04 : JMP 0x009d3c0e
009d3c06 : MOV ECX,dword ptr [EAX + 0xc]
009d3c09 : SUB ECX,ESI
009d3c0b : SAR ECX,0x2
009d3c0e : MOV EDX,dword ptr [EAX + 0x8]
009d3c11 : MOV EBX,EDX
009d3c13 : SUB EBX,ESI
009d3c15 : SAR EBX,0x2
009d3c18 : CMP EBX,ECX
009d3c1a : JNC 0x009d3c26
009d3c1c : MOV dword ptr [EDX],EDI
009d3c1e : ADD EDX,0x4
009d3c21 : MOV dword ptr [EAX + 0x8],EDX
009d3c24 : JMP 0x009d3c31
009d3c26 : LEA ECX,[EBP + -0x1c]
009d3c29 : PUSH ECX
009d3c2a : PUSH EDX
009d3c2b : PUSH EAX
009d3c2c : CALL 0x0042fe80
009d3c31 : MOV EDX,dword ptr [EBP + 0x8]
009d3c34 : PUSH EDX
009d3c35 : MOV ECX,EDI
009d3c37 : CALL 0x009d39e0
009d3c3c : XOR EBX,EBX
009d3c3e : MOV ECX,dword ptr [EBP + 0xc]
009d3c41 : MOV EAX,dword ptr [EBP + -0x10]
009d3c44 : MOVZX EDX,byte ptr [ECX + 0x4]
009d3c48 : INC EAX
009d3c49 : CMP EAX,EDX
009d3c4b : MOV dword ptr [EBP + -0x10],EAX
009d3c4e : JL 0x009d3b30
009d3c54 : MOV ECX,dword ptr [EBP + -0xc]
009d3c57 : MOV dword ptr FS:[0x0],ECX
009d3c5e : POP ECX
009d3c5f : POP EDI
009d3c60 : POP ESI
009d3c61 : POP EBX
009d3c62 : MOV ESP,EBP
009d3c64 : POP EBP
009d3c65 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_006b8550
ENTRY    : 006b8550
BODY     : [[006b8550, 006b871c] [006b8720, 006b8771]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006b8550(void)

{
  int iVar1;
  int iVar2;
  short sVar3;
  int in_EAX;
  int iVar4;
  undefined4 uVar5;
  int iVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  int iStack_24;
  undefined4 local_20;
  int iStack_1c;
  int iStack_14;
  ushort uStack_10;
  ushort uStack_e;
  int iStack_c;
  ushort uStack_8;
  byte bStack_6;
  int iStack_4;
  
  iVar1 = *(int *)(in_EAX + 0x68);
  iVar2 = *(int *)(in_EAX + 0x2cc);
  uVar5 = *(undefined4 *)(iVar1 + 0x1c);
  local_20 = uVar5;
  iStack_24 = (**(code **)(in_EAX + 0x1fc))();
  if (iStack_24 == 0) {
    iVar4 = FUN_00687830(iVar1);
    iStack_1c = iVar4;
    iStack_24 = FUN_006889e0(iVar1,&DAT_00beb9f4,&iStack_14);
    if (iStack_24 == 0) {
      *(uint *)(iVar2 + 0x18) = (uint)uStack_e;
      *(uint *)(iVar2 + 0x20) = (uint)uStack_8;
      if ((iStack_14 != 0x10000) || (uStack_10 != **(ushort **)(iVar2 + 8))) {
        return 8;
      }
      uVar5 = FUN_0068a220(uVar5,4,0,uStack_8 + 1,0,&iStack_24);
      *(undefined4 *)(iVar2 + 0x24) = uVar5;
      if (iStack_24 == 0) {
        if ((bStack_6 & 1) == 0) {
          iVar6 = FUN_00688900(iVar1,*(int *)(iVar2 + 0x20) * 2 + 2);
          if (iVar6 != 0) {
            return iVar6;
          }
          uVar8 = 0;
          iStack_24 = 0;
          do {
            uVar7 = FUN_00687940(iVar1);
            *(uint *)(*(int *)(iVar2 + 0x24) + uVar8 * 4) = iVar4 + iStack_4 + (uVar7 & 0xffff) * 2;
            uVar8 = uVar8 + 1;
          } while (uVar8 <= *(uint *)(iVar2 + 0x20));
        }
        else {
          iVar6 = FUN_00688900(iVar1,*(int *)(iVar2 + 0x20) * 4 + 4);
          if (iVar6 != 0) {
            return iVar6;
          }
          uVar8 = 0;
          iStack_24 = 0;
          do {
            iVar6 = FUN_006879a0(iVar1);
            *(int *)(*(int *)(iVar2 + 0x24) + uVar8 * 4) = iVar6 + iVar4 + iStack_4;
            uVar8 = uVar8 + 1;
          } while (uVar8 <= *(uint *)(iVar2 + 0x20));
        }
        FUN_006889b0(iVar1);
        if (*(int *)(iVar2 + 0x18) != 0) {
          uVar5 = FUN_0068a220(local_20,4,0,(uint)uStack_10 * *(int *)(iVar2 + 0x18),0,&iStack_24);
          *(undefined4 *)(iVar2 + 0x1c) = uVar5;
          if (((iStack_24 == 0) &&
              (iStack_24 = FUN_006877c0(iVar1,iStack_c + iStack_1c), iStack_24 == 0)) &&
             (iStack_24 = FUN_00688900(iVar1,(uint)uStack_10 * *(int *)(iVar2 + 0x18) * 2),
             iStack_24 == 0)) {
            uVar8 = 0;
            if (*(int *)(iVar2 + 0x18) != 0) {
              uVar7 = (uint)uStack_10;
              do {
                uVar9 = 0;
                if (uVar7 != 0) {
                  do {
                    sVar3 = FUN_00687940(iVar1);
                    *(int *)(*(int *)(iVar2 + 0x1c) + (uStack_10 * uVar8 + uVar9) * 4) = sVar3 * 4;
                    uVar7 = (uint)uStack_10;
                    uVar9 = uVar9 + 1;
                  } while (uVar9 < uVar7);
                }
                uVar8 = uVar8 + 1;
              } while (uVar8 < *(uint *)(iVar2 + 0x18));
            }
            FUN_006889b0(iVar1);
          }
        }
      }
    }
  }
  return iStack_24;
}



============================================================
DISASSEMBLY
============================================================
006b8550 : SUB ESP,0x24
006b8553 : MOV EDX,dword ptr [EAX + 0x1fc]
006b8559 : PUSH EBX
006b855a : MOV EBX,dword ptr [EAX + 0x68]
006b855d : PUSH ESI
006b855e : MOV ESI,dword ptr [EAX + 0x2cc]
006b8564 : PUSH EDI
006b8565 : MOV EDI,dword ptr [EBX + 0x1c]
006b8568 : LEA ECX,[ESP + 0x18]
006b856c : PUSH ECX
006b856d : PUSH EBX
006b856e : PUSH 0x67766172
006b8573 : PUSH EAX
006b8574 : MOV dword ptr [ESP + 0x20],EDI
006b8578 : CALL EDX
006b857a : ADD ESP,0x10
006b857d : MOV dword ptr [ESP + 0xc],EAX
006b8581 : TEST EAX,EAX
006b8583 : JNZ 0x006b875e
006b8589 : PUSH EBP
006b858a : PUSH EBX
006b858b : CALL 0x00687830
006b8590 : MOV EBP,EAX
006b8592 : LEA EAX,[ESP + 0x24]
006b8596 : PUSH EAX
006b8597 : PUSH 0xbeb9f4
006b859c : PUSH EBX
006b859d : MOV dword ptr [ESP + 0x28],EBP
006b85a1 : CALL 0x006889e0
006b85a6 : ADD ESP,0x10
006b85a9 : MOV dword ptr [ESP + 0x10],EAX
006b85ad : TEST EAX,EAX
006b85af : JNZ 0x006b875d
006b85b5 : MOVZX ECX,word ptr [ESP + 0x26]
006b85ba : MOV dword ptr [ESI + 0x18],ECX
006b85bd : MOVZX EAX,word ptr [ESP + 0x2c]
006b85c2 : MOV dword ptr [ESI + 0x20],EAX
006b85c5 : MOV EDX,dword ptr [ESP + 0x30]
006b85c9 : ADD EBP,EDX
006b85cb : CMP dword ptr [ESP + 0x20],0x10000
006b85d3 : JNZ 0x006b8765
006b85d9 : MOV ECX,dword ptr [ESI + 0x8]
006b85dc : MOV DX,word ptr [ESP + 0x24]
006b85e1 : CMP DX,word ptr [ECX]
006b85e4 : JNZ 0x006b8765
006b85ea : LEA ECX,[ESP + 0x10]
006b85ee : PUSH ECX
006b85ef : PUSH 0x0
006b85f1 : INC EAX
006b85f2 : PUSH EAX
006b85f3 : PUSH 0x0
006b85f5 : PUSH 0x4
006b85f7 : PUSH EDI
006b85f8 : CALL 0x0068a220
006b85fd : MOV dword ptr [ESI + 0x24],EAX
006b8600 : MOV EAX,dword ptr [ESP + 0x28]
006b8604 : ADD ESP,0x18
006b8607 : TEST EAX,EAX
006b8609 : JNZ 0x006b875d
006b860f : TEST byte ptr [ESP + 0x2e],0x1
006b8614 : MOV EDX,dword ptr [ESI + 0x20]
006b8617 : JZ 0x006b8651
006b8619 : LEA EAX,[EDX*0x4 + 0x4]
006b8620 : PUSH EAX
006b8621 : PUSH EBX
006b8622 : CALL 0x00688900
006b8627 : ADD ESP,0x8
006b862a : MOV dword ptr [ESP + 0x10],EAX
006b862e : TEST EAX,EAX
006b8630 : JNZ 0x006b875d
006b8636 : XOR EDI,EDI
006b8638 : PUSH EBX
006b8639 : CALL 0x006879a0
006b863e : MOV ECX,dword ptr [ESI + 0x24]
006b8641 : ADD EAX,EBP
006b8643 : MOV dword ptr [ECX + EDI*0x4],EAX
006b8646 : INC EDI
006b8647 : ADD ESP,0x4
006b864a : CMP EDI,dword ptr [ESI + 0x20]
006b864d : JBE 0x006b8638
006b864f : JMP 0x006b868c
006b8651 : LEA EAX,[EDX + EDX*0x1 + 0x2]
006b8655 : PUSH EAX
006b8656 : PUSH EBX
006b8657 : CALL 0x00688900
006b865c : ADD ESP,0x8
006b865f : MOV dword ptr [ESP + 0x10],EAX
006b8663 : TEST EAX,EAX
006b8665 : JNZ 0x006b875d
006b866b : XOR EDI,EDI
006b866d : LEA ECX,[ECX]
006b8670 : PUSH EBX
006b8671 : CALL 0x00687940
006b8676 : MOVZX ECX,AX
006b8679 : MOV EAX,dword ptr [ESI + 0x24]
006b867c : LEA EDX,[EBP + ECX*0x2]
006b8680 : MOV dword ptr [EAX + EDI*0x4],EDX
006b8683 : INC EDI
006b8684 : ADD ESP,0x4
006b8687 : CMP EDI,dword ptr [ESI + 0x20]
006b868a : JBE 0x006b8670
006b868c : PUSH EBX
006b868d : CALL 0x006889b0
006b8692 : MOV EAX,dword ptr [ESI + 0x18]
006b8695 : ADD ESP,0x4
006b8698 : TEST EAX,EAX
006b869a : JZ 0x006b8759
006b86a0 : MOVZX EDX,word ptr [ESP + 0x24]
006b86a5 : IMUL EDX,EAX
006b86a8 : MOV EAX,dword ptr [ESP + 0x14]
006b86ac : LEA ECX,[ESP + 0x10]
006b86b0 : PUSH ECX
006b86b1 : PUSH 0x0
006b86b3 : PUSH EDX
006b86b4 : PUSH 0x0
006b86b6 : PUSH 0x4
006b86b8 : PUSH EAX
006b86b9 : CALL 0x0068a220
006b86be : MOV dword ptr [ESI + 0x1c],EAX
006b86c1 : MOV EAX,dword ptr [ESP + 0x28]
006b86c5 : ADD ESP,0x18
006b86c8 : TEST EAX,EAX
006b86ca : JNZ 0x006b875d
006b86d0 : MOV ECX,dword ptr [ESP + 0x28]
006b86d4 : MOV EDX,dword ptr [ESP + 0x18]
006b86d8 : ADD ECX,EDX
006b86da : PUSH ECX
006b86db : PUSH EBX
006b86dc : CALL 0x006877c0
006b86e1 : ADD ESP,0x8
006b86e4 : MOV dword ptr [ESP + 0x10],EAX
006b86e8 : TEST EAX,EAX
006b86ea : JNZ 0x006b875d
006b86ec : MOVZX EAX,word ptr [ESP + 0x24]
006b86f1 : IMUL EAX,dword ptr [ESI + 0x18]
006b86f5 : ADD EAX,EAX
006b86f7 : PUSH EAX
006b86f8 : PUSH EBX
006b86f9 : CALL 0x00688900
006b86fe : ADD ESP,0x8
006b8701 : MOV dword ptr [ESP + 0x10],EAX
006b8705 : TEST EAX,EAX
006b8707 : JNZ 0x006b875d
006b8709 : XOR EBP,EBP
006b870b : CMP dword ptr [ESI + 0x18],EBP
006b870e : JBE 0x006b8750
006b8710 : MOVZX EAX,word ptr [ESP + 0x24]
006b8715 : XOR EDI,EDI
006b8717 : TEST EAX,EAX
006b8719 : JBE 0x006b874a
006b871b : JMP 0x006b8720
006b8720 : PUSH EBX
006b8721 : CALL 0x00687940
006b8726 : MOVZX EDX,word ptr [ESP + 0x28]
006b872b : IMUL EDX,EBP
006b872e : MOVSX ECX,AX
006b8731 : MOV EAX,dword ptr [ESI + 0x1c]
006b8734 : ADD ECX,ECX
006b8736 : ADD EDX,EDI
006b8738 : ADD ECX,ECX
006b873a : MOV dword ptr [EAX + EDX*0x4],ECX
006b873d : MOVZX EAX,word ptr [ESP + 0x28]
006b8742 : INC EDI
006b8743 : ADD ESP,0x4
006b8746 : CMP EDI,EAX
006b8748 : JC 0x006b8720
006b874a : INC EBP
006b874b : CMP EBP,dword ptr [ESI + 0x18]
006b874e : JC 0x006b8715
006b8750 : PUSH EBX
006b8751 : CALL 0x006889b0
006b8756 : ADD ESP,0x4
006b8759 : MOV EAX,dword ptr [ESP + 0x10]
006b875d : POP EBP
006b875e : POP EDI
006b875f : POP ESI
006b8760 : POP EBX
006b8761 : ADD ESP,0x24
006b8764 : RET
006b8765 : POP EBP
006b8766 : POP EDI
006b8767 : POP ESI
006b8768 : MOV EAX,0x8
006b876d : POP EBX
006b876e : ADD ESP,0x24
006b8771 : RET

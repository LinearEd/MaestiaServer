PROGRAM  : Maestia.exe
FUNCTION : FUN_004111f0
ENTRY    : 004111f0
BODY     : [[004111f0, 0041126c] [00411270, 00411309]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Type propagation algorithm not settling */

void FUN_004111f0(int param_1)

{
  wchar_t wVar1;
  wchar_t *pwVar2;
  wchar_t *pwVar3;
  int in_ECX;
  int iVar4;
  wchar_t local_6c [34];
  wchar_t local_28;
  undefined1 auStack_26 [6];
  undefined2 local_20;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b7c599;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  _memset(local_6c,0,0x42);
  iVar4 = 0;
  pwVar3 = local_6c;
  do {
    _local_28 = 0;
    local_20 = 0;
    __itow_s((uint)*(byte *)(in_ECX + iVar4),&local_28,10,0x10);
    pwVar2 = &local_28;
    do {
      wVar1 = *pwVar2;
      pwVar2 = pwVar2 + 1;
    } while (wVar1 != L'\0');
    if ((int)pwVar2 - (int)auStack_26 >> 1 == 1) {
      wVar1 = local_28;
      *pwVar3 = L'0';
      pwVar3[1] = wVar1;
    }
    else {
      _wcsncpy(pwVar3,&local_28,2);
    }
    iVar4 = iVar4 + 1;
    pwVar3 = pwVar3 + 2;
  } while (iVar4 < 0x10);
  *(undefined4 *)(param_1 + 0x18) = 7;
  *(undefined4 *)(param_1 + 0x14) = 0;
  pwVar3 = local_6c;
  *(undefined2 *)(param_1 + 4) = 0;
  do {
    wVar1 = *pwVar3;
    pwVar3 = pwVar3 + 1;
  } while (wVar1 != L'\0');
  FUN_00406360(local_6c,(int)pwVar3 - (int)(local_6c + 1) >> 1);
  local_8 = 0;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
004111f0 : PUSH EBP
004111f1 : MOV EBP,ESP
004111f3 : PUSH -0x1
004111f5 : PUSH 0xb7c599
004111fa : MOV EAX,FS:[0x0]
00411200 : PUSH EAX
00411201 : SUB ESP,0x68
00411204 : MOV EAX,[0x00d66fa0]
00411209 : XOR EAX,EBP
0041120b : MOV dword ptr [EBP + -0x10],EAX
0041120e : PUSH EBX
0041120f : PUSH ESI
00411210 : PUSH EDI
00411211 : PUSH EAX
00411212 : LEA EAX,[EBP + -0xc]
00411215 : MOV FS:[0x0],EAX
0041121b : MOV EAX,dword ptr [EBP + 0x8]
0041121e : XOR EBX,EBX
00411220 : PUSH 0x42
00411222 : LEA EDX,[EBP + -0x68]
00411225 : PUSH EBX
00411226 : PUSH EDX
00411227 : MOV dword ptr [EBP + -0x70],EAX
0041122a : MOV dword ptr [EBP + -0x74],ECX
0041122d : MOV dword ptr [EBP + -0x6c],EBX
00411230 : CALL 0x0063b700
00411235 : ADD ESP,0xc
00411238 : XOR ESI,ESI
0041123a : LEA EDI,[EBP + -0x68]
0041123d : LEA ECX,[ECX]
00411240 : MOV EAX,dword ptr [EBP + -0x74]
00411243 : MOVZX EAX,byte ptr [EAX + ESI*0x1]
00411247 : PUSH 0x10
00411249 : PUSH 0xa
0041124b : LEA ECX,[EBP + -0x24]
0041124e : PUSH ECX
0041124f : PXOR XMM0,XMM0
00411253 : PUSH EAX
00411254 : MOVQ qword ptr [EBP + -0x24],XMM0
00411259 : MOV word ptr [EBP + -0x1c],BX
0041125d : CALL 0x0063706a
00411262 : LEA EAX,[EBP + -0x24]
00411265 : ADD ESP,0x10
00411268 : LEA EDX,[EAX + 0x2]
0041126b : JMP 0x00411270
00411270 : MOV CX,word ptr [EAX]
00411273 : ADD EAX,0x2
00411276 : CMP CX,BX
00411279 : JNZ 0x00411270
0041127b : SUB EAX,EDX
0041127d : SAR EAX,0x1
0041127f : CMP EAX,0x1
00411282 : JNZ 0x00411296
00411284 : MOV AX,word ptr [EBP + -0x24]
00411288 : MOV EDX,0x30
0041128d : MOV word ptr [EDI],DX
00411290 : MOV word ptr [EDI + 0x2],AX
00411294 : JMP 0x004112a5
00411296 : PUSH 0x2
00411298 : LEA ECX,[EBP + -0x24]
0041129b : PUSH ECX
0041129c : PUSH EDI
0041129d : CALL 0x00634e39
004112a2 : ADD ESP,0xc
004112a5 : INC ESI
004112a6 : ADD EDI,0x4
004112a9 : CMP ESI,0x10
004112ac : JL 0x00411240
004112ae : MOV ESI,dword ptr [EBP + -0x70]
004112b1 : XOR EDX,EDX
004112b3 : MOV dword ptr [ESI + 0x18],0x7
004112ba : MOV dword ptr [ESI + 0x14],EBX
004112bd : LEA EAX,[EBP + -0x68]
004112c0 : MOV word ptr [ESI + 0x4],DX
004112c4 : LEA EDX,[EAX + 0x2]
004112c7 : MOV CX,word ptr [EAX]
004112ca : ADD EAX,0x2
004112cd : CMP CX,BX
004112d0 : JNZ 0x004112c7
004112d2 : SUB EAX,EDX
004112d4 : SAR EAX,0x1
004112d6 : PUSH EAX
004112d7 : LEA EAX,[EBP + -0x68]
004112da : PUSH EAX
004112db : MOV ECX,ESI
004112dd : CALL 0x00406360
004112e2 : MOV dword ptr [EBP + -0x4],EBX
004112e5 : MOV dword ptr [EBP + -0x6c],0x1
004112ec : MOV EAX,ESI
004112ee : MOV ECX,dword ptr [EBP + -0xc]
004112f1 : MOV dword ptr FS:[0x0],ECX
004112f8 : POP ECX
004112f9 : POP EDI
004112fa : POP ESI
004112fb : POP EBX
004112fc : MOV ECX,dword ptr [EBP + -0x10]
004112ff : XOR ECX,EBP
00411301 : CALL 0x00633e6b
00411306 : MOV ESP,EBP
00411308 : POP EBP
00411309 : RET

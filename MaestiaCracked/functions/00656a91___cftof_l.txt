PROGRAM  : Maestia.exe
FUNCTION : __cftof_l
ENTRY    : 00656a91
BODY     : [[00656a91, 00656b4b]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    __cftof_l
   
   Library: Visual Studio 2008 Release */

void __cftof_l(double *param_1,undefined1 *param_2,int param_3,int param_4,undefined4 param_5)

{
  int *piVar1;
  size_t _SizeInBytes;
  errno_t eVar2;
  _strflt local_30;
  char local_20 [24];
  uint local_8;
  
  local_8 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  __fltout2((_CRT_DOUBLE)*param_1,&local_30,local_20,0x16);
  if ((param_2 == (undefined1 *)0x0) || (param_3 == 0)) {
    piVar1 = __errno();
    *piVar1 = 0x16;
    __invalid_parameter(0,0,0,0,0);
  }
  else {
    if (param_3 == -1) {
      _SizeInBytes = 0xffffffff;
    }
    else {
      _SizeInBytes = param_3 - (uint)(local_30.sign == 0x2d);
    }
    eVar2 = __fptostr(param_2 + (local_30.sign == 0x2d),_SizeInBytes,local_30.decpt + param_4,
                      &local_30);
    if (eVar2 == 0) {
      __cftof2_l(param_3,param_4,0,param_5);
    }
    else {
      *param_2 = 0;
    }
  }
  __security_check_cookie(local_8 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00656a91 : MOV EDI,EDI
00656a93 : PUSH EBP
00656a94 : MOV EBP,ESP
00656a96 : SUB ESP,0x2c
00656a99 : MOV EAX,[0x00d66fa0]
00656a9e : XOR EAX,EBP
00656aa0 : MOV dword ptr [EBP + -0x4],EAX
00656aa3 : MOV EAX,dword ptr [EBP + 0x8]
00656aa6 : PUSH EBX
00656aa7 : PUSH ESI
00656aa8 : PUSH EDI
00656aa9 : MOV EDI,dword ptr [EBP + 0xc]
00656aac : PUSH 0x16
00656aae : POP ESI
00656aaf : PUSH ESI
00656ab0 : LEA ECX,[EBP + -0x1c]
00656ab3 : PUSH ECX
00656ab4 : LEA ECX,[EBP + -0x2c]
00656ab7 : PUSH ECX
00656ab8 : PUSH dword ptr [EAX + 0x4]
00656abb : PUSH dword ptr [EAX]
00656abd : CALL 0x0065fc48
00656ac2 : XOR EBX,EBX
00656ac4 : ADD ESP,0x14
00656ac7 : CMP EDI,EBX
00656ac9 : JNZ 0x00656ae3
00656acb : CALL 0x0063ab82
00656ad0 : PUSH EBX
00656ad1 : PUSH EBX
00656ad2 : PUSH EBX
00656ad3 : PUSH EBX
00656ad4 : PUSH EBX
00656ad5 : MOV dword ptr [EAX],ESI
00656ad7 : CALL 0x006372b8
00656adc : ADD ESP,0x14
00656adf : MOV EAX,ESI
00656ae1 : JMP 0x00656b3d
00656ae3 : MOV EAX,dword ptr [EBP + 0x10]
00656ae6 : CMP EAX,EBX
00656ae8 : JBE 0x00656acb
00656aea : CMP EAX,-0x1
00656aed : JNZ 0x00656af3
00656aef : OR EAX,EAX
00656af1 : JMP 0x00656afe
00656af3 : XOR ECX,ECX
00656af5 : CMP dword ptr [EBP + -0x2c],0x2d
00656af9 : SETZ CL
00656afc : SUB EAX,ECX
00656afe : MOV ESI,dword ptr [EBP + 0x14]
00656b01 : LEA ECX,[EBP + -0x2c]
00656b04 : PUSH ECX
00656b05 : MOV ECX,dword ptr [EBP + -0x28]
00656b08 : ADD ECX,ESI
00656b0a : PUSH ECX
00656b0b : PUSH EAX
00656b0c : XOR EAX,EAX
00656b0e : CMP dword ptr [EBP + -0x2c],0x2d
00656b12 : SETZ AL
00656b15 : ADD EAX,EDI
00656b17 : PUSH EAX
00656b18 : CALL 0x0065fad1
00656b1d : ADD ESP,0x10
00656b20 : CMP EAX,EBX
00656b22 : JZ 0x00656b28
00656b24 : MOV byte ptr [EDI],BL
00656b26 : JMP 0x00656b3d
00656b28 : PUSH dword ptr [EBP + 0x18]
00656b2b : LEA EAX,[EBP + -0x2c]
00656b2e : PUSH EBX
00656b2f : PUSH ESI
00656b30 : PUSH dword ptr [EBP + 0x10]
00656b33 : MOV ECX,EDI
00656b35 : CALL 0x0065699a
00656b3a : ADD ESP,0x10
00656b3d : MOV ECX,dword ptr [EBP + -0x4]
00656b40 : POP EDI
00656b41 : POP ESI
00656b42 : XOR ECX,EBP
00656b44 : POP EBX
00656b45 : CALL 0x00633e6b
00656b4a : LEAVE
00656b4b : RET

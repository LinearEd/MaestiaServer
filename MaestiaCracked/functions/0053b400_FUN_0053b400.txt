PROGRAM  : Maestia.exe
FUNCTION : FUN_0053b400
ENTRY    : 0053b400
BODY     : [[0053b400, 0053b46f]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_0053b400(undefined4 param_1,int param_2,int param_3)

{
  uint uVar1;
  int iVar2;
  int *in_ECX;
  
  iVar2 = in_ECX[1];
  uVar1 = iVar2 + param_3;
  if ((uint)in_ECX[2] < uVar1) {
    if (*in_ECX == 0) {
      iVar2 = FUN_00515840(uVar1 * 2,0);
    }
    else {
      iVar2 = FUN_00515c80(*in_ECX,uVar1 * 2);
    }
    *in_ECX = iVar2;
    iVar2 = in_ECX[1];
    in_ECX[2] = iVar2 + param_3;
  }
  if (iVar2 - param_2 != 0) {
    _memmove((void *)(*in_ECX + (param_2 + param_3) * 2),(void *)(*in_ECX + param_2 * 2),
             (iVar2 - param_2) * 2);
  }
  in_ECX[1] = in_ECX[1] + param_3;
  return *in_ECX + param_2 * 2;
}



============================================================
DISASSEMBLY
============================================================
0053b400 : PUSH EBX
0053b401 : MOV EBX,dword ptr [ESP + 0x10]
0053b405 : PUSH ESI
0053b406 : MOV ESI,ECX
0053b408 : MOV EAX,dword ptr [ESI + 0x4]
0053b40b : LEA EDX,[EAX + EBX*0x1]
0053b40e : PUSH EDI
0053b40f : CMP dword ptr [ESI + 0x8],EDX
0053b412 : JNC 0x0053b442
0053b414 : MOV EAX,dword ptr [ESI]
0053b416 : TEST EAX,EAX
0053b418 : JNZ 0x0053b42d
0053b41a : MOV EAX,dword ptr [ESP + 0x10]
0053b41e : MOV ECX,dword ptr [EAX + 0x1c]
0053b421 : PUSH 0x0
0053b423 : ADD EDX,EDX
0053b425 : PUSH EDX
0053b426 : CALL 0x00515840
0053b42b : JMP 0x0053b437
0053b42d : LEA ECX,[EDX + EDX*0x1]
0053b430 : PUSH ECX
0053b431 : PUSH EAX
0053b432 : CALL 0x00515c80
0053b437 : MOV dword ptr [ESI],EAX
0053b439 : MOV EAX,dword ptr [ESI + 0x4]
0053b43c : LEA EDX,[EAX + EBX*0x1]
0053b43f : MOV dword ptr [ESI + 0x8],EDX
0053b442 : MOV EDI,dword ptr [ESP + 0x14]
0053b446 : SUB EAX,EDI
0053b448 : JZ 0x0053b462
0053b44a : MOV ECX,dword ptr [ESI]
0053b44c : ADD EAX,EAX
0053b44e : PUSH EAX
0053b44f : LEA EDX,[ECX + EDI*0x2]
0053b452 : LEA EAX,[EDI + EBX*0x1]
0053b455 : PUSH EDX
0053b456 : LEA ECX,[ECX + EAX*0x2]
0053b459 : PUSH ECX
0053b45a : CALL 0x00636880
0053b45f : ADD ESP,0xc
0053b462 : MOV EDX,dword ptr [ESI]
0053b464 : ADD dword ptr [ESI + 0x4],EBX
0053b467 : LEA EAX,[EDX + EDI*0x2]
0053b46a : POP EDI
0053b46b : POP ESI
0053b46c : POP EBX
0053b46d : RET 0xc

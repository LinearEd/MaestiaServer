PROGRAM  : Maestia.exe
FUNCTION : FUN_0040ce10
ENTRY    : 0040ce10
BODY     : [[0040ce10, 0040ce4c] [0040ce50, 0040d05d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0040ce10(undefined4 *param_1,undefined4 *param_2,undefined4 *param_3,code *param_4)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  int iVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  undefined4 *puVar8;
  undefined4 *puVar9;
  undefined4 *puVar10;
  undefined4 *puVar11;
  undefined4 *local_c;
  undefined4 *local_8;
  
  puVar9 = param_2 + (((int)param_3 - (int)param_2 >> 3) - ((int)param_3 - (int)param_2 >> 0x1f) >>
                     1) * 2;
  FUN_0040d3c0(param_2,puVar9,param_3 + -2,param_4);
  puVar1 = puVar9;
  while (puVar7 = puVar1, param_2 < puVar7) {
    puVar1 = puVar7 + -2;
    iVar5 = (*param_4)(puVar1,puVar7);
    if ((iVar5 != 0) || (iVar5 = (*param_4)(puVar7,puVar1), iVar5 != 0)) break;
  }
  do {
    puVar9 = puVar9 + 2;
    puVar1 = puVar9;
    local_c = puVar9;
    local_8 = puVar7;
    puVar10 = puVar7;
    if (param_3 <= puVar9) break;
    iVar5 = (*param_4)(puVar9,puVar7);
    if ((iVar5 != 0) || (iVar5 = (*param_4)(puVar7,puVar9), iVar5 != 0)) break;
  } while( true );
joined_r0x0040ceab:
  puVar8 = puVar10;
  puVar4 = puVar1;
  puVar1 = puVar7;
  if (param_3 <= puVar4) {
joined_r0x0040cefc:
    while (puVar6 = puVar7, puVar11 = puVar9, param_2 < puVar7) {
      puVar10 = puVar1 + -2;
      iVar5 = (*param_4)(puVar10,puVar8);
      puVar9 = puVar8;
      if (iVar5 == 0) {
        iVar5 = (*param_4)(puVar8,puVar10);
        puVar6 = local_8;
        puVar11 = local_c;
        if (iVar5 != 0) break;
        puVar9 = puVar8 + -2;
        if (puVar9 != puVar10) {
          uVar2 = *puVar9;
          uVar3 = puVar8[-1];
          *puVar9 = *puVar10;
          puVar8[-1] = puVar1[-1];
          *puVar10 = uVar2;
          puVar1[-1] = uVar3;
        }
      }
      local_8 = local_8 + -2;
      puVar1 = puVar10;
      puVar8 = puVar9;
      puVar9 = local_c;
      puVar7 = local_8;
    }
    if (puVar6 == param_2) {
      if (puVar4 == param_3) {
        param_1[1] = puVar11;
        *param_1 = puVar8;
        return;
      }
      if ((puVar11 != puVar4) && (puVar8 != puVar11)) {
        uVar2 = puVar8[1];
        uVar3 = *puVar8;
        *puVar8 = *puVar11;
        puVar8[1] = puVar11[1];
        *puVar11 = uVar3;
        puVar11[1] = uVar2;
      }
      puVar9 = puVar11 + 2;
      puVar7 = puVar6;
      puVar1 = puVar4 + 2;
      local_c = puVar9;
      puVar10 = puVar8 + 2;
      if (puVar8 != puVar4) {
        uVar2 = *puVar8;
        uVar3 = puVar8[1];
        *puVar8 = *puVar4;
        puVar8[1] = puVar4[1];
        *puVar4 = uVar2;
        puVar4[1] = uVar3;
      }
    }
    else {
      puVar7 = puVar6 + -2;
      local_8 = puVar7;
      if (puVar4 == param_3) {
        puVar10 = puVar8 + -2;
        if (puVar7 != puVar10) {
          uVar2 = puVar6[-1];
          uVar3 = *puVar7;
          *puVar7 = *puVar10;
          puVar6[-1] = puVar8[-1];
          *puVar10 = uVar3;
          puVar8[-1] = uVar2;
        }
        puVar9 = puVar11 + -2;
        puVar1 = puVar4;
        local_c = puVar9;
        if (puVar10 != puVar9) {
          uVar2 = puVar8[-1];
          uVar3 = *puVar10;
          *puVar10 = *puVar9;
          puVar8[-1] = puVar11[-1];
          *puVar9 = uVar3;
          puVar11[-1] = uVar2;
        }
      }
      else {
        puVar1 = puVar4 + 2;
        puVar9 = puVar11;
        puVar10 = puVar8;
        if (puVar4 != puVar7) {
          uVar2 = *puVar4;
          uVar3 = puVar4[1];
          *puVar4 = *puVar7;
          puVar4[1] = puVar6[-1];
          *puVar7 = uVar2;
          puVar6[-1] = uVar3;
        }
      }
    }
    goto joined_r0x0040ceab;
  }
  iVar5 = (*param_4)(puVar8,puVar4);
  puVar10 = puVar9;
  puVar7 = local_8;
  if (iVar5 == 0) {
    iVar5 = (*param_4)(puVar4,puVar8);
    puVar1 = local_8;
    if (iVar5 != 0) goto joined_r0x0040cefc;
    puVar10 = puVar9 + 2;
    local_c = puVar10;
    if (puVar9 != puVar4) {
      uVar2 = puVar9[1];
      uVar3 = *puVar9;
      *puVar9 = *puVar4;
      puVar9[1] = puVar4[1];
      *puVar4 = uVar3;
      puVar4[1] = uVar2;
    }
  }
  puVar1 = puVar4 + 2;
  puVar9 = puVar10;
  puVar10 = puVar8;
  goto joined_r0x0040ceab;
}



============================================================
DISASSEMBLY
============================================================
0040ce10 : PUSH EBP
0040ce11 : MOV EBP,ESP
0040ce13 : SUB ESP,0x3c
0040ce16 : MOV ECX,dword ptr [EBP + 0xc]
0040ce19 : PUSH EBX
0040ce1a : MOV EBX,dword ptr [EBP + 0x14]
0040ce1d : PUSH ESI
0040ce1e : PUSH EDI
0040ce1f : MOV EDI,dword ptr [EBP + 0x10]
0040ce22 : MOV EAX,EDI
0040ce24 : SUB EAX,ECX
0040ce26 : SAR EAX,0x3
0040ce29 : CDQ
0040ce2a : SUB EAX,EDX
0040ce2c : SAR EAX,0x1
0040ce2e : LEA ESI,[ECX + EAX*0x8]
0040ce31 : PUSH EBX
0040ce32 : LEA EAX,[EDI + -0x8]
0040ce35 : PUSH EAX
0040ce36 : PUSH ESI
0040ce37 : PUSH ECX
0040ce38 : CALL 0x0040d3c0
0040ce3d : ADD ESP,0x10
0040ce40 : LEA EDI,[ESI + 0x8]
0040ce43 : MOV dword ptr [EBP + -0x8],EDI
0040ce46 : CMP dword ptr [EBP + 0xc],ESI
0040ce49 : JNC 0x0040ce77
0040ce4b : JMP 0x0040ce50
0040ce50 : LEA EAX,[ESI + -0x8]
0040ce53 : PUSH ESI
0040ce54 : PUSH EAX
0040ce55 : MOV dword ptr [EBP + -0xc],EAX
0040ce58 : CALL EBX
0040ce5a : ADD ESP,0x8
0040ce5d : TEST EAX,EAX
0040ce5f : JNZ 0x0040ce77
0040ce61 : MOV EAX,dword ptr [EBP + -0xc]
0040ce64 : PUSH EAX
0040ce65 : PUSH ESI
0040ce66 : CALL EBX
0040ce68 : ADD ESP,0x8
0040ce6b : TEST EAX,EAX
0040ce6d : JNZ 0x0040ce77
0040ce6f : MOV ESI,dword ptr [EBP + -0xc]
0040ce72 : CMP dword ptr [EBP + 0xc],ESI
0040ce75 : JC 0x0040ce50
0040ce77 : CMP EDI,dword ptr [EBP + 0x10]
0040ce7a : JNC 0x0040cea1
0040ce7c : LEA ESP,[ESP]
0040ce80 : PUSH ESI
0040ce81 : PUSH EDI
0040ce82 : CALL EBX
0040ce84 : ADD ESP,0x8
0040ce87 : TEST EAX,EAX
0040ce89 : JNZ 0x0040cea1
0040ce8b : PUSH EDI
0040ce8c : PUSH ESI
0040ce8d : CALL EBX
0040ce8f : ADD ESP,0x8
0040ce92 : TEST EAX,EAX
0040ce94 : JNZ 0x0040cea1
0040ce96 : ADD EDI,0x8
0040ce99 : MOV dword ptr [EBP + -0x8],EDI
0040ce9c : CMP EDI,dword ptr [EBP + 0x10]
0040ce9f : JC 0x0040ce80
0040cea1 : MOV EAX,ESI
0040cea3 : MOV EBX,EDI
0040cea5 : MOV dword ptr [EBP + -0x4],EAX
0040cea8 : CMP EBX,dword ptr [EBP + 0x10]
0040ceab : JNC 0x0040cef9
0040cead : LEA ECX,[ECX]
0040ceb0 : PUSH EBX
0040ceb1 : PUSH ESI
0040ceb2 : CALL dword ptr [EBP + 0x14]
0040ceb5 : ADD ESP,0x8
0040ceb8 : TEST EAX,EAX
0040ceba : JNZ 0x0040ceee
0040cebc : PUSH ESI
0040cebd : PUSH EBX
0040cebe : CALL dword ptr [EBP + 0x14]
0040cec1 : ADD ESP,0x8
0040cec4 : TEST EAX,EAX
0040cec6 : JNZ 0x0040cef6
0040cec8 : MOV EAX,EDI
0040ceca : ADD EDI,0x8
0040cecd : MOV dword ptr [EBP + -0x8],EDI
0040ced0 : CMP EAX,EBX
0040ced2 : JZ 0x0040ceee
0040ced4 : MOV EDX,dword ptr [EAX + 0x4]
0040ced7 : MOV ECX,dword ptr [EAX]
0040ced9 : MOV dword ptr [EBP + -0x20],EDX
0040cedc : MOV EDX,dword ptr [EBX]
0040cede : MOV dword ptr [EAX],EDX
0040cee0 : MOV EDX,dword ptr [EBX + 0x4]
0040cee3 : MOV dword ptr [EAX + 0x4],EDX
0040cee6 : MOV EAX,dword ptr [EBP + -0x20]
0040cee9 : MOV dword ptr [EBX],ECX
0040ceeb : MOV dword ptr [EBX + 0x4],EAX
0040ceee : ADD EBX,0x8
0040cef1 : CMP EBX,dword ptr [EBP + 0x10]
0040cef4 : JC 0x0040ceb0
0040cef6 : MOV EAX,dword ptr [EBP + -0x4]
0040cef9 : CMP EAX,dword ptr [EBP + 0xc]
0040cefc : JBE 0x0040cf4e
0040cefe : LEA EDI,[EAX + -0x8]
0040cf01 : PUSH ESI
0040cf02 : PUSH EDI
0040cf03 : CALL dword ptr [EBP + 0x14]
0040cf06 : ADD ESP,0x8
0040cf09 : TEST EAX,EAX
0040cf0b : JNZ 0x0040cf34
0040cf0d : PUSH EDI
0040cf0e : PUSH ESI
0040cf0f : CALL dword ptr [EBP + 0x14]
0040cf12 : ADD ESP,0x8
0040cf15 : TEST EAX,EAX
0040cf17 : JNZ 0x0040cf45
0040cf19 : SUB ESI,0x8
0040cf1c : CMP ESI,EDI
0040cf1e : JZ 0x0040cf34
0040cf20 : MOV EDX,dword ptr [EDI]
0040cf22 : MOV EAX,dword ptr [ESI]
0040cf24 : MOV ECX,dword ptr [ESI + 0x4]
0040cf27 : MOV dword ptr [ESI],EDX
0040cf29 : MOV EDX,dword ptr [EDI + 0x4]
0040cf2c : MOV dword ptr [ESI + 0x4],EDX
0040cf2f : MOV dword ptr [EDI],EAX
0040cf31 : MOV dword ptr [EDI + 0x4],ECX
0040cf34 : MOV EAX,dword ptr [EBP + -0x4]
0040cf37 : SUB EAX,0x8
0040cf3a : SUB EDI,0x8
0040cf3d : MOV dword ptr [EBP + -0x4],EAX
0040cf40 : CMP dword ptr [EBP + 0xc],EAX
0040cf43 : JC 0x0040cf01
0040cf45 : MOV EAX,dword ptr [EBP + -0x4]
0040cf48 : MOV EDI,dword ptr [EBP + -0x8]
0040cf4b : CMP EAX,dword ptr [EBP + 0xc]
0040cf4e : JNZ 0x0040cfc4
0040cf50 : CMP EBX,dword ptr [EBP + 0x10]
0040cf53 : JZ 0x0040d04f
0040cf59 : CMP EDI,EBX
0040cf5b : JZ 0x0040cf7b
0040cf5d : CMP ESI,EDI
0040cf5f : JZ 0x0040cf7b
0040cf61 : MOV EDX,dword ptr [ESI + 0x4]
0040cf64 : MOV ECX,dword ptr [ESI]
0040cf66 : MOV dword ptr [EBP + -0x28],EDX
0040cf69 : MOV EDX,dword ptr [EDI]
0040cf6b : MOV dword ptr [ESI],EDX
0040cf6d : MOV EDX,dword ptr [EDI + 0x4]
0040cf70 : MOV dword ptr [ESI + 0x4],EDX
0040cf73 : MOV dword ptr [EDI],ECX
0040cf75 : MOV ECX,dword ptr [EBP + -0x28]
0040cf78 : MOV dword ptr [EDI + 0x4],ECX
0040cf7b : MOV EDX,EBX
0040cf7d : MOV ECX,ESI
0040cf7f : ADD EDI,0x8
0040cf82 : ADD EBX,0x8
0040cf85 : ADD ESI,0x8
0040cf88 : MOV dword ptr [EBP + -0x8],EDI
0040cf8b : MOV dword ptr [EBP + -0xc],EDX
0040cf8e : CMP ECX,EDX
0040cf90 : JZ 0x0040cea8
0040cf96 : MOV EDX,dword ptr [ECX]
0040cf98 : MOV dword ptr [EBP + -0x14],EDX
0040cf9b : MOV EDX,dword ptr [ECX + 0x4]
0040cf9e : MOV dword ptr [EBP + -0x10],EDX
0040cfa1 : MOV EDX,dword ptr [EBP + -0xc]
0040cfa4 : MOV EDX,dword ptr [EDX]
0040cfa6 : MOV dword ptr [ECX],EDX
0040cfa8 : MOV EDX,dword ptr [EBP + -0xc]
0040cfab : MOV EDX,dword ptr [EDX + 0x4]
0040cfae : MOV dword ptr [ECX + 0x4],EDX
0040cfb1 : MOV EDX,dword ptr [EBP + -0x14]
0040cfb4 : MOV ECX,dword ptr [EBP + -0xc]
0040cfb7 : MOV dword ptr [ECX],EDX
0040cfb9 : MOV EDX,dword ptr [EBP + -0x10]
0040cfbc : MOV dword ptr [ECX + 0x4],EDX
0040cfbf : JMP 0x0040cea8
0040cfc4 : SUB EAX,0x8
0040cfc7 : MOV dword ptr [EBP + -0x4],EAX
0040cfca : CMP EBX,dword ptr [EBP + 0x10]
0040cfcd : JNZ 0x0040d01d
0040cfcf : SUB ESI,0x8
0040cfd2 : CMP EAX,ESI
0040cfd4 : JZ 0x0040cff0
0040cfd6 : MOV EDX,dword ptr [EAX + 0x4]
0040cfd9 : MOV ECX,dword ptr [EAX]
0040cfdb : MOV dword ptr [EBP + -0x30],EDX
0040cfde : MOV EDX,dword ptr [ESI]
0040cfe0 : MOV dword ptr [EAX],EDX
0040cfe2 : MOV EDX,dword ptr [ESI + 0x4]
0040cfe5 : MOV dword ptr [EAX + 0x4],EDX
0040cfe8 : MOV dword ptr [ESI],ECX
0040cfea : MOV ECX,dword ptr [EBP + -0x30]
0040cfed : MOV dword ptr [ESI + 0x4],ECX
0040cff0 : SUB EDI,0x8
0040cff3 : MOV dword ptr [EBP + -0x8],EDI
0040cff6 : CMP ESI,EDI
0040cff8 : JZ 0x0040cea8
0040cffe : MOV EDX,dword ptr [ESI + 0x4]
0040d001 : MOV ECX,dword ptr [ESI]
0040d003 : MOV dword ptr [EBP + -0x38],EDX
0040d006 : MOV EDX,dword ptr [EDI]
0040d008 : MOV dword ptr [ESI],EDX
0040d00a : MOV EDX,dword ptr [EDI + 0x4]
0040d00d : MOV dword ptr [ESI + 0x4],EDX
0040d010 : MOV dword ptr [EDI],ECX
0040d012 : MOV ECX,dword ptr [EBP + -0x38]
0040d015 : MOV dword ptr [EDI + 0x4],ECX
0040d018 : JMP 0x0040cea8
0040d01d : MOV ECX,EBX
0040d01f : ADD EBX,0x8
0040d022 : CMP ECX,EAX
0040d024 : JZ 0x0040cea8
0040d02a : MOV EDX,dword ptr [ECX]
0040d02c : MOV dword ptr [EBP + -0x1c],EDX
0040d02f : MOV EDX,dword ptr [ECX + 0x4]
0040d032 : MOV dword ptr [EBP + -0x18],EDX
0040d035 : MOV EDX,dword ptr [EAX]
0040d037 : MOV dword ptr [ECX],EDX
0040d039 : MOV EDX,dword ptr [EAX + 0x4]
0040d03c : MOV dword ptr [ECX + 0x4],EDX
0040d03f : MOV ECX,dword ptr [EBP + -0x1c]
0040d042 : MOV EDX,dword ptr [EBP + -0x18]
0040d045 : MOV dword ptr [EAX],ECX
0040d047 : MOV dword ptr [EAX + 0x4],EDX
0040d04a : JMP 0x0040cea8
0040d04f : MOV EAX,dword ptr [EBP + 0x8]
0040d052 : MOV dword ptr [EAX + 0x4],EDI
0040d055 : POP EDI
0040d056 : MOV dword ptr [EAX],ESI
0040d058 : POP ESI
0040d059 : POP EBX
0040d05a : MOV ESP,EBP
0040d05c : POP EBP
0040d05d : RET

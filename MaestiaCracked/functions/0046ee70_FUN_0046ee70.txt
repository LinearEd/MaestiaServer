PROGRAM  : Maestia.exe
FUNCTION : FUN_0046ee70
ENTRY    : 0046ee70
BODY     : [[0046ee70, 0046ef3f]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_0046ee70(void)

{
  int *_Memory;
  int in_ECX;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  puStack_c = &LAB_00b74d51;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_8 = 2;
  if ((*(int *)(in_ECX + 0x44) != 0) &&
     (_Memory = (int *)(*(int *)(in_ECX + 0x44) + -4), _Memory != (int *)0x0)) {
    _DAT_00da98cc = _DAT_00da98cc + (-4 - *_Memory);
    if (DAT_00da98c8 == (int *)0x0) {
      _free(_Memory);
    }
    else {
      (**(code **)(*DAT_00da98c8 + 8))(_Memory,DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
    }
    *(undefined4 *)(in_ECX + 0x44) = 0;
  }
  local_8._0_1_ = 1;
  FUN_0046ee20();
  local_8 = (uint)local_8._1_3_ << 8;
  FUN_00475400();
  local_8 = 0xffffffff;
  *(undefined4 *)(in_ECX + 8) = &PTR_FUN_00cd63cc;
  if (*(char *)(in_ECX + 0x18) != '\0') {
    FUN_00471610((undefined4 *)(in_ECX + 8),0,0);
    if (*(char *)(in_ECX + 0x18) != '\0') goto LAB_0046ef2b;
  }
  FUN_004717c0();
  *(undefined4 *)(in_ECX + 0xc) = 0;
  *(undefined4 *)(in_ECX + 0x14) = 0;
LAB_0046ef2b:
  *(undefined4 *)(in_ECX + 0x10) = 0;
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
0046ee70 : PUSH EBP
0046ee71 : MOV EBP,ESP
0046ee73 : PUSH -0x1
0046ee75 : PUSH 0xb74d51
0046ee7a : MOV EAX,FS:[0x0]
0046ee80 : PUSH EAX
0046ee81 : PUSH ECX
0046ee82 : PUSH EBX
0046ee83 : PUSH ESI
0046ee84 : PUSH EDI
0046ee85 : MOV EAX,[0x00d66fa0]
0046ee8a : XOR EAX,EBP
0046ee8c : PUSH EAX
0046ee8d : LEA EAX,[EBP + -0xc]
0046ee90 : MOV FS:[0x0],EAX
0046ee96 : MOV ESI,ECX
0046ee98 : MOV dword ptr [EBP + -0x10],ESI
0046ee9b : MOV dword ptr [EBP + -0x4],0x2
0046eea2 : MOV EAX,dword ptr [ESI + 0x44]
0046eea5 : XOR EBX,EBX
0046eea7 : CMP EAX,EBX
0046eea9 : JZ 0x0046eede
0046eeab : ADD EAX,-0x4
0046eeae : CMP EAX,EBX
0046eeb0 : JZ 0x0046eede
0046eeb2 : MOV ECX,0xfffffffc
0046eeb7 : SUB ECX,dword ptr [EAX]
0046eeb9 : PUSH EAX
0046eeba : ADD dword ptr [0x00da98cc],ECX
0046eec0 : MOV ECX,dword ptr [0x00da98c8]
0046eec6 : CMP ECX,EBX
0046eec8 : JZ 0x0046eed3
0046eeca : MOV EDX,dword ptr [ECX]
0046eecc : MOV EAX,dword ptr [EDX + 0x8]
0046eecf : CALL EAX
0046eed1 : JMP 0x0046eedb
0046eed3 : CALL 0x0063610d
0046eed8 : ADD ESP,0x4
0046eedb : MOV dword ptr [ESI + 0x44],EBX
0046eede : MOV byte ptr [EBP + -0x4],0x1
0046eee2 : LEA ECX,[ESI + 0x30]
0046eee5 : CALL 0x0046ee20
0046eeea : MOV byte ptr [EBP + -0x4],BL
0046eeed : LEA ECX,[ESI + 0x1c]
0046eef0 : CALL 0x00475400
0046eef5 : MOV dword ptr [EBP + -0x4],0xffffffff
0046eefc : LEA EDI,[ESI + 0x8]
0046eeff : MOV dword ptr [EDI],0xcd63cc
0046ef05 : CMP byte ptr [EDI + 0x10],BL
0046ef08 : JZ 0x0046ef17
0046ef0a : PUSH EBX
0046ef0b : PUSH EBX
0046ef0c : PUSH EDI
0046ef0d : CALL 0x00471610
0046ef12 : CMP byte ptr [EDI + 0x10],BL
0046ef15 : JNZ 0x0046ef2b
0046ef17 : MOV ECX,dword ptr [EDI + 0x4]
0046ef1a : LEA ESI,[EBP + -0x10]
0046ef1d : MOV dword ptr [EBP + -0x10],ECX
0046ef20 : CALL 0x004717c0
0046ef25 : MOV dword ptr [EDI + 0x4],EBX
0046ef28 : MOV dword ptr [EDI + 0xc],EBX
0046ef2b : MOV dword ptr [EDI + 0x8],EBX
0046ef2e : MOV ECX,dword ptr [EBP + -0xc]
0046ef31 : MOV dword ptr FS:[0x0],ECX
0046ef38 : POP ECX
0046ef39 : POP EDI
0046ef3a : POP ESI
0046ef3b : POP EBX
0046ef3c : MOV ESP,EBP
0046ef3e : POP EBP
0046ef3f : RET

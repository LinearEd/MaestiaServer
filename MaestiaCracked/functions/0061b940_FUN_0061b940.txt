PROGRAM  : Maestia.exe
FUNCTION : FUN_0061b940
ENTRY    : 0061b940
BODY     : [[0061b940, 0061ba61]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_0061b940(int param_1,undefined4 param_2,undefined4 param_3,uint *param_4)

{
  uint uVar1;
  bool bVar2;
  uint *puVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  
  uVar5 = DAT_00d662d8 + -1 + param_1 & -DAT_00d662d8;
  uVar6 = uVar5 + 0x17 + DAT_00d662d8 * 2 & -DAT_00d662d8;
  bVar2 = false;
  puVar3 = (uint *)0x0;
  if ((*param_4 & 0x40000000) == 0) {
    do {
      if (bVar2) goto LAB_0061ba53;
      uVar1 = *param_4;
      uVar4 = uVar1 & 0x7fffffff;
      if ((int)uVar1 < 0) {
LAB_0061ba3f:
        param_4 = (uint *)((int)param_4 + uVar4 + 4);
      }
      else if (uVar4 == uVar6) {
        *param_4 = uVar1 | 0x80000000;
        puVar3 = (uint *)(DAT_00d662d8 + 3 + (int)param_4 & -DAT_00d662d8);
        puVar3[3] = (int)puVar3 - (int)param_4 & 0xffff;
        puVar3[1] = (uint)(puVar3 + 4);
        *puVar3 = uVar5;
        puVar3[2] = (uint)puVar3;
        *(uint *)((int)(puVar3 + 4) + *puVar3) = puVar3[2];
        uVar1 = puVar3[1];
        *(undefined4 *)(*(int *)(uVar1 - 0x10) + 4 + uVar1) = *(undefined4 *)(uVar1 - 0xc);
        bVar2 = true;
      }
      else {
        if (uVar4 <= uVar6 + 0x10) goto LAB_0061ba3f;
        *param_4 = uVar6 | 0x80000000;
        puVar3 = (uint *)(DAT_00d662d8 + 3 + (int)param_4 & -DAT_00d662d8);
        puVar3[3] = (int)puVar3 - (int)param_4 & 0xffff;
        *puVar3 = uVar5;
        puVar3[2] = (uint)puVar3;
        puVar3[1] = (uint)(puVar3 + 4);
        *(uint *)((int)(puVar3 + 4) + *puVar3) = puVar3[2];
        uVar1 = puVar3[1];
        *(undefined4 *)(*(int *)(uVar1 - 0x10) + 4 + uVar1) = *(undefined4 *)(uVar1 - 0xc);
        *(uint *)((int)param_4 + uVar6 + 4) = (uVar4 - uVar6) - 4 & 0x7fffffff;
        bVar2 = true;
      }
    } while ((*param_4 & 0x40000000) == 0);
    if (bVar2) {
LAB_0061ba53:
      return puVar3[1];
    }
  }
  return 0;
}



============================================================
DISASSEMBLY
============================================================
0061b940 : MOV EDX,dword ptr [0x00d662d8]
0061b946 : PUSH EBX
0061b947 : PUSH EBP
0061b948 : PUSH ESI
0061b949 : MOV ESI,dword ptr [ESP + 0x10]
0061b94d : MOV ECX,EDX
0061b94f : NEG ECX
0061b951 : LEA EBX,[EDX + ESI*0x1 + -0x1]
0061b955 : AND EBX,ECX
0061b957 : PUSH EDI
0061b958 : LEA EDI,[EBX + EDX*0x2 + 0x17]
0061b95c : AND EDI,ECX
0061b95e : MOV ECX,dword ptr [ESP + 0x20]
0061b962 : XOR EBP,EBP
0061b964 : XOR EAX,EAX
0061b966 : TEST dword ptr [ECX],0x40000000
0061b96c : MOV dword ptr [ESP + 0x14],EBX
0061b970 : JNZ 0x0061ba5b
0061b976 : TEST EBP,EBP
0061b978 : JNZ 0x0061ba53
0061b97e : MOV ESI,dword ptr [ECX]
0061b980 : MOV EDX,ESI
0061b982 : AND EDX,0x7fffffff
0061b988 : TEST ESI,ESI
0061b98a : JS 0x0061ba3f
0061b990 : CMP EDX,EDI
0061b992 : JNZ 0x0061b9dc
0061b994 : OR ESI,0x80000000
0061b99a : MOV dword ptr [ECX],ESI
0061b99c : MOV EDX,dword ptr [0x00d662d8]
0061b9a2 : LEA EAX,[EDX + ECX*0x1 + 0x3]
0061b9a6 : NEG EDX
0061b9a8 : AND EAX,EDX
0061b9aa : MOV EDX,EAX
0061b9ac : SUB EDX,ECX
0061b9ae : MOVZX EDX,DX
0061b9b1 : MOV dword ptr [EAX + 0xc],EDX
0061b9b4 : LEA EDX,[EAX + 0x10]
0061b9b7 : MOV dword ptr [EAX + 0x4],EDX
0061b9ba : MOV dword ptr [EAX],EBX
0061b9bc : MOV dword ptr [EAX + 0x8],EAX
0061b9bf : MOV ESI,dword ptr [EDX + -0x10]
0061b9c2 : MOV EBP,dword ptr [EDX + -0x8]
0061b9c5 : MOV dword ptr [EDX + ESI*0x1],EBP
0061b9c8 : MOV EDX,dword ptr [EAX + 0x4]
0061b9cb : MOV EBP,dword ptr [EDX + -0xc]
0061b9ce : MOV ESI,dword ptr [EDX + -0x10]
0061b9d1 : MOV dword ptr [ESI + EDX*0x1 + 0x4],EBP
0061b9d5 : MOV EBP,0x1
0061b9da : JMP 0x0061ba43
0061b9dc : LEA ESI,[EDI + 0x10]
0061b9df : CMP EDX,ESI
0061b9e1 : JBE 0x0061ba3f
0061b9e3 : MOV EAX,EDI
0061b9e5 : OR EAX,0x80000000
0061b9ea : MOV dword ptr [ECX],EAX
0061b9ec : MOV ESI,dword ptr [0x00d662d8]
0061b9f2 : LEA EAX,[ESI + ECX*0x1 + 0x3]
0061b9f6 : NEG ESI
0061b9f8 : AND EAX,ESI
0061b9fa : MOV ESI,EAX
0061b9fc : SUB ESI,ECX
0061b9fe : MOVZX ESI,SI
0061ba01 : MOV dword ptr [EAX + 0xc],ESI
0061ba04 : MOV dword ptr [EAX],EBX
0061ba06 : MOV dword ptr [EAX + 0x8],EAX
0061ba09 : LEA ESI,[EAX + 0x10]
0061ba0c : MOV dword ptr [EAX + 0x4],ESI
0061ba0f : MOV EBX,dword ptr [ESI + -0x10]
0061ba12 : MOV EBP,dword ptr [ESI + -0x8]
0061ba15 : MOV dword ptr [ESI + EBX*0x1],EBP
0061ba18 : MOV ESI,dword ptr [EAX + 0x4]
0061ba1b : MOV EBX,dword ptr [ESI + -0x10]
0061ba1e : MOV EBP,dword ptr [ESI + -0xc]
0061ba21 : SUB EDX,EDI
0061ba23 : SUB EDX,0x4
0061ba26 : MOV dword ptr [EBX + ESI*0x1 + 0x4],EBP
0061ba2a : MOV EBX,dword ptr [ESP + 0x14]
0061ba2e : AND EDX,0x7fffffff
0061ba34 : MOV dword ptr [ECX + EDI*0x1 + 0x4],EDX
0061ba38 : MOV EBP,0x1
0061ba3d : JMP 0x0061ba43
0061ba3f : LEA ECX,[ECX + EDX*0x1 + 0x4]
0061ba43 : TEST dword ptr [ECX],0x40000000
0061ba49 : JZ 0x0061b976
0061ba4f : TEST EBP,EBP
0061ba51 : JZ 0x0061ba5b
0061ba53 : MOV EAX,dword ptr [EAX + 0x4]
0061ba56 : POP EDI
0061ba57 : POP ESI
0061ba58 : POP EBP
0061ba59 : POP EBX
0061ba5a : RET
0061ba5b : POP EDI
0061ba5c : POP ESI
0061ba5d : POP EBP
0061ba5e : XOR EAX,EAX
0061ba60 : POP EBX
0061ba61 : RET

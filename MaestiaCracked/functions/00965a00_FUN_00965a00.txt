PROGRAM  : Maestia.exe
FUNCTION : FUN_00965a00
ENTRY    : 00965a00
BODY     : [[00965a00, 00965f2e]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00965a00(void)

{
  char cVar1;
  int iVar2;
  int *piVar3;
  int *piVar4;
  undefined4 uVar5;
  int in_ECX;
  undefined4 *puVar6;
  int *piVar7;
  int local_74;
  undefined1 local_70 [4];
  undefined2 local_6c;
  undefined4 local_5c;
  uint local_58;
  int local_54;
  int local_50;
  undefined1 local_4c [4];
  undefined4 local_48;
  undefined4 local_38;
  uint local_34;
  undefined1 local_30 [4];
  undefined4 local_2c;
  undefined4 local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  uint local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b60664;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar2 = *DAT_00da9894;
  local_54 = in_ECX;
  if ((iVar2 != 0) && (*(int *)(iVar2 + 0x114) != 0)) {
    (**(code **)(**(int **)(iVar2 + 0x114) + 4))
              (*(int **)(iVar2 + 0x114),"SetShopKind",&DAT_00c7a6a4,*(undefined1 *)(in_ECX + 0x8c),
               local_14);
  }
  iVar2 = *DAT_00da9894;
  if ((iVar2 != 0) && (*(int *)(iVar2 + 0x114) != 0)) {
    (**(code **)(**(int **)(iVar2 + 0x114) + 4))
              (*(int **)(iVar2 + 0x114),"SetNowPage",&DAT_00c7a6b4,*(undefined2 *)(in_ECX + 0x7e));
  }
  iVar2 = *DAT_00da9894;
  if ((iVar2 != 0) && (*(int *)(iVar2 + 0x114) != 0)) {
    (**(code **)(**(int **)(iVar2 + 0x114) + 4))
              (*(int **)(iVar2 + 0x114),"SetTotalPage",&DAT_00c7a6c4,*(undefined2 *)(in_ECX + 0x7c))
    ;
  }
  iVar2 = *DAT_00da9894;
  if ((iVar2 != 0) && (*(int *)(iVar2 + 0x114) != 0)) {
    (**(code **)(**(int **)(iVar2 + 0x114) + 4))
              (*(int **)(iVar2 + 0x114),"SetShopTabFocus",&DAT_00c7a6d8,
               *(undefined2 *)(in_ECX + 0x76));
  }
  iVar2 = DAT_00d7c54c;
  local_50 = *(int *)(in_ECX + 0x70);
  FUN_004437f0(&local_50);
  if (((local_74 != *(int *)(iVar2 + 0x44)) && (*(int *)(local_74 + 0x10) != 0)) &&
     (*(char *)(*(int *)(local_74 + 0x10) + 0x40) == '\x04')) {
    uVar5 = (**(code **)(**(int **)(DAT_00da93ec + 0xac) + 0x478))();
    iVar2 = *DAT_00da9894;
    if ((iVar2 != 0) && (*(int *)(iVar2 + 0x114) != 0)) {
      (**(code **)(**(int **)(iVar2 + 0x114) + 4))
                (*(int **)(iVar2 + 0x114),"SetMyKillPoint",&DAT_00c7a6ec,uVar5);
    }
    iVar2 = *DAT_00da9894;
    if ((iVar2 != 0) && (*(int *)(iVar2 + 0x114) != 0)) {
      (**(code **)(**(int **)(iVar2 + 0x114) + 4))
                (*(int **)(iVar2 + 0x114),"ShopClassrankIcon",&DAT_00c7a700,3);
    }
  }
  local_48 = (undefined4 *)((uint)local_48._2_2_ << 0x10);
  local_34 = 7;
  local_38 = 0;
  FUN_00406360(&DAT_00c7a718,0);
  local_8 = 0;
  local_50 = **(int **)(in_ECX + 0x54);
  if ((int *)local_50 != *(int **)(in_ECX + 0x54)) {
    do {
      uVar5 = FUN_00404750(&DAT_00c7a71c,*(undefined4 *)(local_50 + 0xc));
      local_8._0_1_ = 1;
      FUN_00405c30(uVar5,0,0xffffffff);
      local_8 = (uint)local_8._1_3_ << 8;
      if (7 < local_58) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_58 = 7;
      local_5c = 0;
      local_6c = 0;
      FUN_0045d060();
    } while (local_50 != *(int *)(in_ECX + 0x54));
  }
  uVar5 = FUN_0040e420(local_4c,local_70);
  local_8._0_1_ = 2;
  FUN_00405eb0(uVar5,0,0xffffffff);
  local_8._0_1_ = 0;
  if (7 < local_58) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_58 = 7;
  local_5c = 0;
  local_6c = 0;
  iVar2 = *DAT_00da9894;
  if ((iVar2 != 0) && (*(int *)(iVar2 + 0x114) != 0)) {
    puVar6 = local_48;
    if (local_34 < 8) {
      puVar6 = &local_48;
    }
    (**(code **)(**(int **)(iVar2 + 0x114) + 4))
              (*(int **)(iVar2 + 0x114),"SetShopFilter",&DAT_00c7a724,puVar6);
  }
  local_2c = (undefined4 *)((uint)local_2c._2_2_ << 0x10);
  local_18 = 7;
  local_1c = 0;
  FUN_00406360(&DAT_00c7a738,0);
  piVar7 = (int *)**(int **)(in_ECX + 0x60);
  if (piVar7 != *(int **)(in_ECX + 0x60)) {
    do {
      local_8._0_1_ = 3;
      uVar5 = FUN_00404750(&DAT_00c7a73c,piVar7[3]);
      local_8._0_1_ = 4;
      FUN_00405c30(uVar5,0,0xffffffff);
      local_8._0_1_ = 3;
      if (7 < local_58) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_58 = 7;
      local_5c = 0;
      local_6c = 0;
      if (*(char *)((int)piVar7 + 0x11) == '\0') {
        piVar3 = (int *)piVar7[2];
        if (*(char *)((int)piVar3 + 0x11) == '\0') {
          cVar1 = *(char *)(*piVar3 + 0x11);
          piVar7 = piVar3;
          piVar3 = (int *)*piVar3;
          while (cVar1 == '\0') {
            cVar1 = *(char *)(*piVar3 + 0x11);
            piVar7 = piVar3;
            piVar3 = (int *)*piVar3;
          }
        }
        else {
          cVar1 = *(char *)(piVar7[1] + 0x11);
          piVar4 = (int *)piVar7[1];
          piVar3 = piVar7;
          while ((piVar7 = piVar4, cVar1 == '\0' && (piVar3 == (int *)piVar7[2]))) {
            cVar1 = *(char *)(piVar7[1] + 0x11);
            piVar4 = (int *)piVar7[1];
            piVar3 = piVar7;
          }
        }
      }
    } while (piVar7 != *(int **)(local_54 + 0x60));
  }
  local_8._0_1_ = 3;
  uVar5 = FUN_0040e420(local_30,local_70);
  local_8._0_1_ = 5;
  FUN_00405eb0(uVar5,0,0xffffffff);
  local_8 = CONCAT31(local_8._1_3_,3);
  if (local_58 < 8) {
    local_58 = 7;
    local_5c = 0;
    local_6c = 0;
    iVar2 = *DAT_00da9894;
    if ((iVar2 != 0) && (*(int *)(iVar2 + 0x114) != 0)) {
      puVar6 = local_2c;
      if (local_18 < 8) {
        puVar6 = &local_2c;
      }
      (**(code **)(**(int **)(iVar2 + 0x114) + 4))
                (*(int **)(iVar2 + 0x114),"SetClassFilter",&DAT_00c7a744,puVar6);
    }
    if (*(char *)(local_54 + 0x8c) == '\0') {
      uVar5 = *(undefined4 *)(*(int *)(DAT_0172491c + 0x17c) + 0x1ed0);
    }
    else {
      uVar5 = (**(code **)(**(int **)(DAT_0172491c + 0x17c) + 0x46c))();
    }
    iVar2 = *DAT_00da9894;
    if ((iVar2 != 0) && (*(int *)(iVar2 + 0x114) != 0)) {
      (**(code **)(**(int **)(iVar2 + 0x114) + 4))
                (*(int **)(iVar2 + 0x114),"SetMyInfo","%d, %d, %d",
                 *(undefined4 *)(*(int *)(DAT_0172491c + 0x17c) + 0xa0),uVar5,
                 *(undefined1 *)(*(int *)(DAT_0172491c + 0x17c) + 0x18ca));
    }
    iVar2 = *DAT_00da9894;
    if ((iVar2 != 0) && (*(int *)(iVar2 + 0x114) != 0)) {
      (**(code **)**(undefined4 **)(iVar2 + 0x114))("ShopInitialize");
    }
    FUN_009646d0(local_54);
    local_8 = local_8 & 0xffffff00;
    if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_18 = 7;
    local_1c = 0;
    local_2c = (undefined4 *)((uint)local_2c & 0xffff0000);
    local_8 = 0xffffffff;
    if (7 < local_34) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_34 = 7;
    local_38 = 0;
    local_48 = (undefined4 *)((uint)local_48 & 0xffff0000);
    ExceptionList = local_10;
    __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
    return;
  }
                    /* WARNING: Subroutine does not return */
  FUN_006f04e0();
}



============================================================
DISASSEMBLY
============================================================
00965a00 : PUSH EBP
00965a01 : MOV EBP,ESP
00965a03 : PUSH -0x1
00965a05 : PUSH 0xb60664
00965a0a : MOV EAX,FS:[0x0]
00965a10 : PUSH EAX
00965a11 : SUB ESP,0x64
00965a14 : MOV EAX,[0x00d66fa0]
00965a19 : XOR EAX,EBP
00965a1b : MOV dword ptr [EBP + -0x10],EAX
00965a1e : PUSH EBX
00965a1f : PUSH ESI
00965a20 : PUSH EDI
00965a21 : PUSH EAX
00965a22 : LEA EAX,[EBP + -0xc]
00965a25 : MOV FS:[0x0],EAX
00965a2b : MOV EAX,[0x00da9894]
00965a30 : MOV EAX,dword ptr [EAX]
00965a32 : XOR EBX,EBX
00965a34 : MOV EDI,ECX
00965a36 : MOV dword ptr [EBP + -0x50],EDI
00965a39 : CMP EAX,EBX
00965a3b : JZ 0x00965a68
00965a3d : CMP dword ptr [EAX + 0x114],EBX
00965a43 : JZ 0x00965a68
00965a45 : MOVZX EDX,byte ptr [EDI + 0x8c]
00965a4c : MOV EAX,dword ptr [EAX + 0x114]
00965a52 : MOV ECX,dword ptr [EAX]
00965a54 : PUSH EDX
00965a55 : PUSH 0xc7a6a4
00965a5a : PUSH 0xc7a6a8
00965a5f : PUSH EAX
00965a60 : MOV EAX,dword ptr [ECX + 0x4]
00965a63 : CALL EAX
00965a65 : ADD ESP,0x10
00965a68 : MOV ECX,dword ptr [0x00da9894]
00965a6e : MOV EAX,dword ptr [ECX]
00965a70 : CMP EAX,EBX
00965a72 : JZ 0x00965a9c
00965a74 : CMP dword ptr [EAX + 0x114],EBX
00965a7a : JZ 0x00965a9c
00965a7c : MOVZX ECX,word ptr [EDI + 0x7e]
00965a80 : MOV EAX,dword ptr [EAX + 0x114]
00965a86 : MOV EDX,dword ptr [EAX]
00965a88 : MOV EDX,dword ptr [EDX + 0x4]
00965a8b : PUSH ECX
00965a8c : PUSH 0xc7a6b4
00965a91 : PUSH 0xc7a6b8
00965a96 : PUSH EAX
00965a97 : CALL EDX
00965a99 : ADD ESP,0x10
00965a9c : MOV EAX,[0x00da9894]
00965aa1 : MOV EAX,dword ptr [EAX]
00965aa3 : CMP EAX,EBX
00965aa5 : JZ 0x00965acf
00965aa7 : CMP dword ptr [EAX + 0x114],EBX
00965aad : JZ 0x00965acf
00965aaf : MOVZX EDX,word ptr [EDI + 0x7c]
00965ab3 : MOV EAX,dword ptr [EAX + 0x114]
00965ab9 : MOV ECX,dword ptr [EAX]
00965abb : PUSH EDX
00965abc : PUSH 0xc7a6c4
00965ac1 : PUSH 0xc7a6c8
00965ac6 : PUSH EAX
00965ac7 : MOV EAX,dword ptr [ECX + 0x4]
00965aca : CALL EAX
00965acc : ADD ESP,0x10
00965acf : MOV ECX,dword ptr [0x00da9894]
00965ad5 : MOV EAX,dword ptr [ECX]
00965ad7 : CMP EAX,EBX
00965ad9 : JZ 0x00965b03
00965adb : CMP dword ptr [EAX + 0x114],EBX
00965ae1 : JZ 0x00965b03
00965ae3 : MOVZX ECX,word ptr [EDI + 0x76]
00965ae7 : MOV EAX,dword ptr [EAX + 0x114]
00965aed : MOV EDX,dword ptr [EAX]
00965aef : MOV EDX,dword ptr [EDX + 0x4]
00965af2 : PUSH ECX
00965af3 : PUSH 0xc7a6d8
00965af8 : PUSH 0xc7a6dc
00965afd : PUSH EAX
00965afe : CALL EDX
00965b00 : ADD ESP,0x10
00965b03 : MOV EAX,dword ptr [EDI + 0x70]
00965b06 : MOV ESI,dword ptr [0x00d7c54c]
00965b0c : LEA ECX,[EBP + -0x4c]
00965b0f : MOV dword ptr [EBP + -0x4c],EAX
00965b12 : PUSH ECX
00965b13 : LEA ECX,[ESI + 0x40]
00965b16 : LEA EAX,[EBP + -0x70]
00965b19 : CALL 0x004437f0
00965b1e : MOV ESI,dword ptr [ESI + 0x44]
00965b21 : MOV EAX,dword ptr [EBP + -0x70]
00965b24 : CMP EAX,ESI
00965b26 : JZ 0x00965bb0
00965b2c : MOV EAX,dword ptr [EAX + 0x10]
00965b2f : CMP EAX,EBX
00965b31 : JZ 0x00965bb0
00965b33 : CMP byte ptr [EAX + 0x40],0x4
00965b37 : JNZ 0x00965bb0
00965b39 : MOV EDX,dword ptr [0x00da93ec]
00965b3f : MOV ECX,dword ptr [EDX + 0xac]
00965b45 : MOV EAX,dword ptr [ECX]
00965b47 : MOV EDX,dword ptr [EAX + 0x478]
00965b4d : CALL EDX
00965b4f : MOV ECX,dword ptr [0x00da9894]
00965b55 : MOV ECX,dword ptr [ECX]
00965b57 : CMP ECX,EBX
00965b59 : JZ 0x00965b7f
00965b5b : CMP dword ptr [ECX + 0x114],EBX
00965b61 : JZ 0x00965b7f
00965b63 : MOV ECX,dword ptr [ECX + 0x114]
00965b69 : MOV EDX,dword ptr [ECX]
00965b6b : PUSH EAX
00965b6c : MOV EAX,dword ptr [EDX + 0x4]
00965b6f : PUSH 0xc7a6ec
00965b74 : PUSH 0xc7a6f0
00965b79 : PUSH ECX
00965b7a : CALL EAX
00965b7c : ADD ESP,0x10
00965b7f : MOV ECX,dword ptr [0x00da9894]
00965b85 : MOV EAX,dword ptr [ECX]
00965b87 : CMP EAX,EBX
00965b89 : JZ 0x00965bb0
00965b8b : CMP dword ptr [EAX + 0x114],EBX
00965b91 : JZ 0x00965bb0
00965b93 : MOV EAX,dword ptr [EAX + 0x114]
00965b99 : MOV EDX,dword ptr [EAX]
00965b9b : PUSH 0x3
00965b9d : PUSH 0xc7a700
00965ba2 : PUSH 0xc7a704
00965ba7 : PUSH EAX
00965ba8 : MOV EAX,dword ptr [EDX + 0x4]
00965bab : CALL EAX
00965bad : ADD ESP,0x10
00965bb0 : XOR ECX,ECX
00965bb2 : PUSH EBX
00965bb3 : MOV word ptr [EBP + -0x44],CX
00965bb7 : MOV ESI,0x7
00965bbc : PUSH 0xc7a718
00965bc1 : LEA ECX,[EBP + -0x48]
00965bc4 : MOV dword ptr [EBP + -0x30],ESI
00965bc7 : MOV dword ptr [EBP + -0x34],EBX
00965bca : CALL 0x00406360
00965bcf : MOV dword ptr [EBP + -0x4],EBX
00965bd2 : MOV ECX,dword ptr [EDI + 0x54]
00965bd5 : MOV EAX,dword ptr [ECX]
00965bd7 : MOV dword ptr [EBP + -0x4c],EAX
00965bda : CMP EAX,ECX
00965bdc : JZ 0x00965c41
00965bde : MOV BL,0x1
00965be0 : MOV EDX,dword ptr [EAX + 0xc]
00965be3 : PUSH EDX
00965be4 : PUSH 0xc7a71c
00965be9 : LEA ESI,[EBP + -0x6c]
00965bec : CALL 0x00404750
00965bf1 : ADD ESP,0x8
00965bf4 : MOV byte ptr [EBP + -0x4],BL
00965bf7 : PUSH -0x1
00965bf9 : PUSH 0x0
00965bfb : PUSH EAX
00965bfc : LEA ECX,[EBP + -0x48]
00965bff : CALL 0x00405c30
00965c04 : MOV byte ptr [EBP + -0x4],0x0
00965c08 : CMP dword ptr [EBP + -0x54],0x8
00965c0c : JC 0x00965c16
00965c0e : MOV ECX,dword ptr [EBP + -0x68]
00965c11 : CALL 0x006f04e0
00965c16 : XOR EAX,EAX
00965c18 : LEA EDX,[EBP + -0x4c]
00965c1b : MOV dword ptr [EBP + -0x54],0x7
00965c22 : MOV dword ptr [EBP + -0x58],0x0
00965c29 : MOV word ptr [EBP + -0x68],AX
00965c2d : CALL 0x0045d060
00965c32 : MOV ECX,dword ptr [EDI + 0x54]
00965c35 : MOV EAX,dword ptr [EBP + -0x4c]
00965c38 : CMP EAX,ECX
00965c3a : JNZ 0x00965be0
00965c3c : MOV ESI,0x7
00965c41 : MOV ECX,dword ptr [EBP + -0x34]
00965c44 : LEA EDX,[EBP + -0x6c]
00965c47 : PUSH EDX
00965c48 : LEA EAX,[EBP + -0x48]
00965c4b : DEC ECX
00965c4c : PUSH EAX
00965c4d : XOR EDX,EDX
00965c4f : CALL 0x0040e420
00965c54 : MOV byte ptr [EBP + -0x4],0x2
00965c58 : PUSH -0x1
00965c5a : PUSH 0x0
00965c5c : PUSH EAX
00965c5d : LEA ECX,[EBP + -0x48]
00965c60 : CALL 0x00405eb0
00965c65 : MOV byte ptr [EBP + -0x4],0x0
00965c69 : MOV EBX,0x8
00965c6e : CMP dword ptr [EBP + -0x54],EBX
00965c71 : JC 0x00965c7b
00965c73 : MOV ECX,dword ptr [EBP + -0x68]
00965c76 : CALL 0x006f04e0
00965c7b : MOV EDX,dword ptr [0x00da9894]
00965c81 : XOR ECX,ECX
00965c83 : MOV dword ptr [EBP + -0x54],ESI
00965c86 : MOV dword ptr [EBP + -0x58],0x0
00965c8d : MOV word ptr [EBP + -0x68],CX
00965c91 : MOV EAX,dword ptr [EDX]
00965c93 : TEST EAX,EAX
00965c95 : JZ 0x00965cc6
00965c97 : CMP dword ptr [EAX + 0x114],ECX
00965c9d : JZ 0x00965cc6
00965c9f : MOV EAX,dword ptr [EAX + 0x114]
00965ca5 : MOV ECX,dword ptr [EBP + -0x44]
00965ca8 : CMP dword ptr [EBP + -0x30],EBX
00965cab : JNC 0x00965cb0
00965cad : LEA ECX,[EBP + -0x44]
00965cb0 : MOV EDX,dword ptr [EAX]
00965cb2 : PUSH ECX
00965cb3 : PUSH 0xc7a724
00965cb8 : PUSH 0xc7a728
00965cbd : PUSH EAX
00965cbe : MOV EAX,dword ptr [EDX + 0x4]
00965cc1 : CALL EAX
00965cc3 : ADD ESP,0x10
00965cc6 : XOR ECX,ECX
00965cc8 : PUSH ECX
00965cc9 : MOV word ptr [EBP + -0x28],CX
00965ccd : PUSH 0xc7a738
00965cd2 : LEA ECX,[EBP + -0x2c]
00965cd5 : MOV dword ptr [EBP + -0x14],ESI
00965cd8 : MOV dword ptr [EBP + -0x18],0x0
00965cdf : CALL 0x00406360
00965ce4 : MOV byte ptr [EBP + -0x4],0x3
00965ce8 : MOV EAX,dword ptr [EDI + 0x60]
00965ceb : MOV EDI,dword ptr [EAX]
00965ced : CMP EDI,EAX
00965cef : JZ 0x00965d93
00965cf5 : MOV EDX,dword ptr [EDI + 0xc]
00965cf8 : PUSH EDX
00965cf9 : PUSH 0xc7a73c
00965cfe : LEA ESI,[EBP + -0x6c]
00965d01 : CALL 0x00404750
00965d06 : ADD ESP,0x8
00965d09 : MOV byte ptr [EBP + -0x4],0x4
00965d0d : PUSH -0x1
00965d0f : PUSH 0x0
00965d11 : PUSH EAX
00965d12 : LEA ECX,[EBP + -0x2c]
00965d15 : CALL 0x00405c30
00965d1a : MOV byte ptr [EBP + -0x4],0x3
00965d1e : CMP dword ptr [EBP + -0x54],0x8
00965d22 : JC 0x00965d2c
00965d24 : MOV ECX,dword ptr [EBP + -0x68]
00965d27 : CALL 0x006f04e0
00965d2c : XOR EAX,EAX
00965d2e : MOV dword ptr [EBP + -0x54],0x7
00965d35 : MOV dword ptr [EBP + -0x58],0x0
00965d3c : MOV word ptr [EBP + -0x68],AX
00965d40 : CMP byte ptr [EDI + 0x11],AL
00965d43 : JNZ 0x00965d82
00965d45 : MOV EAX,dword ptr [EDI + 0x8]
00965d48 : CMP byte ptr [EAX + 0x11],0x0
00965d4c : JNZ 0x00965d64
00965d4e : MOV EDI,EAX
00965d50 : MOV EAX,dword ptr [EDI]
00965d52 : CMP byte ptr [EAX + 0x11],0x0
00965d56 : JNZ 0x00965d82
00965d58 : MOV EDI,EAX
00965d5a : MOV EAX,dword ptr [EDI]
00965d5c : CMP byte ptr [EAX + 0x11],0x0
00965d60 : JZ 0x00965d58
00965d62 : JMP 0x00965d82
00965d64 : MOV EAX,dword ptr [EDI + 0x4]
00965d67 : CMP byte ptr [EAX + 0x11],0x0
00965d6b : JNZ 0x00965d80
00965d6d : LEA ECX,[ECX]
00965d70 : CMP EDI,dword ptr [EAX + 0x8]
00965d73 : JNZ 0x00965d80
00965d75 : MOV EDI,EAX
00965d77 : MOV EAX,dword ptr [EAX + 0x4]
00965d7a : CMP byte ptr [EAX + 0x11],0x0
00965d7e : JZ 0x00965d70
00965d80 : MOV EDI,EAX
00965d82 : MOV ECX,dword ptr [EBP + -0x50]
00965d85 : CMP EDI,dword ptr [ECX + 0x60]
00965d88 : JNZ 0x00965cf5
00965d8e : MOV EBX,0x8
00965d93 : MOV ECX,dword ptr [EBP + -0x18]
00965d96 : LEA EDX,[EBP + -0x6c]
00965d99 : PUSH EDX
00965d9a : LEA EAX,[EBP + -0x2c]
00965d9d : DEC ECX
00965d9e : PUSH EAX
00965d9f : XOR EDX,EDX
00965da1 : CALL 0x0040e420
00965da6 : MOV byte ptr [EBP + -0x4],0x5
00965daa : PUSH -0x1
00965dac : PUSH 0x0
00965dae : PUSH EAX
00965daf : LEA ECX,[EBP + -0x2c]
00965db2 : CALL 0x00405eb0
00965db7 : MOV byte ptr [EBP + -0x4],0x3
00965dbb : CMP dword ptr [EBP + -0x54],EBX
00965dbe : JC 0x00965dc8
00965dc0 : MOV ECX,dword ptr [EBP + -0x68]
00965dc3 : CALL 0x006f04e0
00965dc8 : MOV EDX,dword ptr [0x00da9894]
00965dce : XOR ECX,ECX
00965dd0 : MOV EDI,0x7
00965dd5 : MOV dword ptr [EBP + -0x54],EDI
00965dd8 : MOV dword ptr [EBP + -0x58],0x0
00965ddf : MOV word ptr [EBP + -0x68],CX
00965de3 : MOV EAX,dword ptr [EDX]
00965de5 : TEST EAX,EAX
00965de7 : JZ 0x00965e18
00965de9 : CMP dword ptr [EAX + 0x114],ECX
00965def : JZ 0x00965e18
00965df1 : MOV EAX,dword ptr [EAX + 0x114]
00965df7 : MOV ECX,dword ptr [EBP + -0x28]
00965dfa : CMP dword ptr [EBP + -0x14],EBX
00965dfd : JNC 0x00965e02
00965dff : LEA ECX,[EBP + -0x28]
00965e02 : MOV EDX,dword ptr [EAX]
00965e04 : PUSH ECX
00965e05 : PUSH 0xc7a744
00965e0a : PUSH 0xc7a748
00965e0f : PUSH EAX
00965e10 : MOV EAX,dword ptr [EDX + 0x4]
00965e13 : CALL EAX
00965e15 : ADD ESP,0x10
00965e18 : MOV ECX,dword ptr [EBP + -0x50]
00965e1b : CMP byte ptr [ECX + 0x8c],0x0
00965e22 : JZ 0x00965e3e
00965e24 : MOV EDX,dword ptr [0x0172491c]
00965e2a : MOV ECX,dword ptr [EDX + 0x17c]
00965e30 : MOV EAX,dword ptr [ECX]
00965e32 : MOV EDX,dword ptr [EAX + 0x46c]
00965e38 : CALL EDX
00965e3a : MOV ESI,EAX
00965e3c : JMP 0x00965e4f
00965e3e : MOV EAX,[0x0172491c]
00965e43 : MOV EAX,dword ptr [EAX + 0x17c]
00965e49 : MOV ESI,dword ptr [EAX + 0x1ed0]
00965e4f : MOV ECX,dword ptr [0x00da9894]
00965e55 : MOV ECX,dword ptr [ECX]
00965e57 : XOR EBX,EBX
00965e59 : CMP ECX,EBX
00965e5b : JZ 0x00965ea1
00965e5d : CMP dword ptr [ECX + 0x114],EBX
00965e63 : JZ 0x00965ea1
00965e65 : MOV EDX,dword ptr [0x0172491c]
00965e6b : MOV EDX,dword ptr [EDX + 0x17c]
00965e71 : MOV AL,byte ptr [EDX + 0x18ca]
00965e77 : MOV EDX,dword ptr [EDX + 0xa0]
00965e7d : MOV ECX,dword ptr [ECX + 0x114]
00965e83 : MOV EDI,dword ptr [ECX]
00965e85 : MOVZX EAX,AL
00965e88 : PUSH EAX
00965e89 : PUSH ESI
00965e8a : PUSH EDX
00965e8b : PUSH 0xc7a758
00965e90 : PUSH 0xc7a764
00965e95 : PUSH ECX
00965e96 : MOV ECX,dword ptr [EDI + 0x4]
00965e99 : CALL ECX
00965e9b : ADD ESP,0x18
00965e9e : LEA EDI,[EBX + 0x7]
00965ea1 : MOV EDX,dword ptr [0x00da9894]
00965ea7 : MOV EAX,dword ptr [EDX]
00965ea9 : CMP EAX,EBX
00965eab : JZ 0x00965ec8
00965ead : CMP dword ptr [EAX + 0x114],EBX
00965eb3 : JZ 0x00965ec8
00965eb5 : MOV EAX,dword ptr [EAX + 0x114]
00965ebb : MOV EDX,dword ptr [EAX]
00965ebd : MOV ECX,EAX
00965ebf : MOV EAX,dword ptr [EDX]
00965ec1 : PUSH 0xc7a3d0
00965ec6 : CALL EAX
00965ec8 : MOV ECX,dword ptr [EBP + -0x50]
00965ecb : PUSH ECX
00965ecc : CALL 0x009646d0
00965ed1 : MOV byte ptr [EBP + -0x4],0x0
00965ed5 : MOV ESI,0x8
00965eda : CMP dword ptr [EBP + -0x14],ESI
00965edd : JC 0x00965ee7
00965edf : MOV ECX,dword ptr [EBP + -0x28]
00965ee2 : CALL 0x006f04e0
00965ee7 : XOR EDX,EDX
00965ee9 : MOV dword ptr [EBP + -0x14],EDI
00965eec : MOV dword ptr [EBP + -0x18],EBX
00965eef : MOV word ptr [EBP + -0x28],DX
00965ef3 : MOV dword ptr [EBP + -0x4],0xffffffff
00965efa : CMP dword ptr [EBP + -0x30],ESI
00965efd : JC 0x00965f07
00965eff : MOV ECX,dword ptr [EBP + -0x44]
00965f02 : CALL 0x006f04e0
00965f07 : XOR EAX,EAX
00965f09 : MOV dword ptr [EBP + -0x30],EDI
00965f0c : MOV dword ptr [EBP + -0x34],EBX
00965f0f : MOV word ptr [EBP + -0x44],AX
00965f13 : MOV ECX,dword ptr [EBP + -0xc]
00965f16 : MOV dword ptr FS:[0x0],ECX
00965f1d : POP ECX
00965f1e : POP EDI
00965f1f : POP ESI
00965f20 : POP EBX
00965f21 : MOV ECX,dword ptr [EBP + -0x10]
00965f24 : XOR ECX,EBP
00965f26 : CALL 0x00633e6b
00965f2b : MOV ESP,EBP
00965f2d : POP EBP
00965f2e : RET

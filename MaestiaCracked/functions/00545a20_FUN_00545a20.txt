PROGRAM  : Maestia.exe
FUNCTION : FUN_00545a20
ENTRY    : 00545a20
BODY     : [[00545a20, 00545caf]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00545a20(float *param_1,int param_2)

{
  float fVar1;
  float fVar2;
  float fVar3;
  uint uVar4;
  uint uVar5;
  char cVar6;
  uint uVar7;
  int in_ECX;
  byte bVar8;
  uint local_10;
  
  if ((((*(float *)(in_ECX + 0xf4) != *param_1) || (*(float *)(in_ECX + 0xfc) != param_1[2])) ||
      (*(float *)(in_ECX + 0xf8) != param_1[1])) || (*(float *)(in_ECX + 0x100) != param_1[3])) {
    local_10 = (uint)(longlong)ROUND(*(float *)(in_ECX + 0xfc) - *(float *)(in_ECX + 0xf4));
    uVar7 = local_10;
    local_10 = (uint)(longlong)ROUND(*(float *)(in_ECX + 0x100) - *(float *)(in_ECX + 0xf8));
    uVar4 = local_10;
    fVar1 = param_1[1];
    fVar2 = param_1[2];
    fVar3 = param_1[3];
    *(float *)(in_ECX + 0xf4) = *param_1;
    *(float *)(in_ECX + 0xf8) = fVar1;
    *(float *)(in_ECX + 0xfc) = fVar2;
    *(float *)(in_ECX + 0x100) = fVar3;
    *(float *)(in_ECX + 0x40) = *(float *)(in_ECX + 0xf4) + 40.0;
    *(float *)(in_ECX + 0x44) = *(float *)(in_ECX + 0xf8) + 40.0;
    *(float *)(in_ECX + 0x48) = *(float *)(in_ECX + 0xfc) - 40.0;
    *(float *)(in_ECX + 0x4c) = *(float *)(in_ECX + 0x100) - 40.0;
    if (param_2 == 1) {
      bVar8 = *(byte *)(in_ECX + 0x140);
      local_10 = (uint)(longlong)ROUND(*(float *)(in_ECX + 0xfc) - *(float *)(in_ECX + 0xf4));
      uVar5 = local_10;
      local_10 = (uint)(longlong)ROUND(*(float *)(in_ECX + 0x100) - *(float *)(in_ECX + 0xf8));
      if (((bVar8 & 0x30) == 0) &&
         (((uVar7 == uVar5 ||
           (((((*(byte *)(in_ECX + 0x141) & 8) == 0 &&
              ((uVar7 <= uVar5 || ((*(byte *)(in_ECX + 0x9c) & 0x20) == 0)))) && ((bVar8 & 3) == 0))
            && (cVar6 = FUN_005451c0(), cVar6 == '\0')))) &&
          ((uVar4 == local_10 ||
           (((bVar8 = bVar8 >> 2 & 3, bVar8 == 0 || (bVar8 == 1)) &&
            ((uVar4 <= local_10 || ((*(byte *)(in_ECX + 0x9c) & 0x20) == 0)))))))))) {
        *(short *)(in_ECX + 0x13c) = *(short *)(in_ECX + 0x13c) + 1;
        uVar7 = FUN_005452b0();
        if (uVar7 < *(uint *)(in_ECX + 0x50)) {
          FUN_005455c0(uVar7);
        }
        uVar7 = FUN_005452d0();
        if (uVar7 < *(uint *)(in_ECX + 0x3c)) {
          FUN_00545620(uVar7);
        }
        *(byte *)(in_ECX + 0x9c) = *(byte *)(in_ECX + 0x9c) | 1;
        return;
      }
      *(byte *)(in_ECX + 0x143) = *(byte *)(in_ECX + 0x143) | 2;
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00545a20 : SUB ESP,0x14
00545a23 : PUSH ESI
00545a24 : MOV ESI,ECX
00545a26 : MOV ECX,dword ptr [ESP + 0x1c]
00545a2a : FLD float ptr [ECX]
00545a2c : FLD float ptr [ESI + 0xf4]
00545a32 : FUCOMPP
00545a34 : FNSTSW AX
00545a36 : TEST AH,0x44
00545a39 : JP 0x00545a75
00545a3b : FLD float ptr [ECX + 0x8]
00545a3e : FLD float ptr [ESI + 0xfc]
00545a44 : FUCOMPP
00545a46 : FNSTSW AX
00545a48 : TEST AH,0x44
00545a4b : JP 0x00545a75
00545a4d : FLD float ptr [ECX + 0x4]
00545a50 : FLD float ptr [ESI + 0xf8]
00545a56 : FUCOMPP
00545a58 : FNSTSW AX
00545a5a : TEST AH,0x44
00545a5d : JP 0x00545a75
00545a5f : FLD float ptr [ECX + 0xc]
00545a62 : FLD float ptr [ESI + 0x100]
00545a68 : FUCOMPP
00545a6a : FNSTSW AX
00545a6c : TEST AH,0x44
00545a6f : JNP 0x00545ca9
00545a75 : FLD float ptr [ESI + 0xfc]
00545a7b : PUSH EBP
00545a7c : FSUB float ptr [ESI + 0xf4]
00545a82 : FSTP float ptr [ESP + 0x20]
00545a86 : FLD float ptr [ESP + 0x20]
00545a8a : FNSTCW word ptr [ESP + 0x20]
00545a8e : MOVZX EAX,word ptr [ESP + 0x20]
00545a93 : OR EAX,0xc00
00545a98 : MOV dword ptr [ESP + 0x8],EAX
00545a9c : FLDCW word ptr [ESP + 0x8]
00545aa0 : FISTP qword ptr [ESP + 0xc]
00545aa4 : MOV EDX,dword ptr [ESP + 0xc]
00545aa8 : FLDCW word ptr [ESP + 0x20]
00545aac : FLD float ptr [ESI + 0x100]
00545ab2 : FSUB float ptr [ESI + 0xf8]
00545ab8 : FSTP float ptr [ESP + 0x20]
00545abc : FLD float ptr [ESP + 0x20]
00545ac0 : FNSTCW word ptr [ESP + 0x20]
00545ac4 : MOVZX EAX,word ptr [ESP + 0x20]
00545ac9 : OR EAX,0xc00
00545ace : CMP dword ptr [ESP + 0x24],0x1
00545ad3 : MOV dword ptr [ESP + 0x8],EAX
00545ad7 : FLDCW word ptr [ESP + 0x8]
00545adb : FISTP qword ptr [ESP + 0xc]
00545adf : MOV EBP,dword ptr [ESP + 0xc]
00545ae3 : FLDCW word ptr [ESP + 0x20]
00545ae7 : FLD float ptr [ECX + 0x4]
00545aea : FSTP float ptr [ESP + 0x20]
00545aee : FLD float ptr [ECX + 0x8]
00545af1 : FSTP float ptr [ESP + 0x8]
00545af5 : FLD float ptr [ECX + 0xc]
00545af8 : FSTP float ptr [ESP + 0xc]
00545afc : FLD float ptr [ECX]
00545afe : FSTP float ptr [ESI + 0xf4]
00545b04 : FLD float ptr [ESP + 0x20]
00545b08 : FSTP float ptr [ESI + 0xf8]
00545b0e : FLD float ptr [ESP + 0x8]
00545b12 : FSTP float ptr [ESI + 0xfc]
00545b18 : FLD float ptr [ESP + 0xc]
00545b1c : FSTP float ptr [ESI + 0x100]
00545b22 : FLD float ptr [ESI + 0xf4]
00545b28 : FSTP float ptr [ESP + 0xc]
00545b2c : FLD float ptr [ESI + 0xf8]
00545b32 : FSTP float ptr [ESP + 0x10]
00545b36 : FLD float ptr [ESI + 0xfc]
00545b3c : FSTP float ptr [ESP + 0x14]
00545b40 : FLD float ptr [ESI + 0x100]
00545b46 : FSTP float ptr [ESP + 0x18]
00545b4a : FLD float ptr [ESP + 0xc]
00545b4e : FLD double ptr [0x00b8be30]
00545b54 : FADD ST1,ST0
00545b56 : FXCH
00545b58 : FSTP float ptr [ESP + 0xc]
00545b5c : FLD float ptr [ESP + 0x14]
00545b60 : FSUB ST0,ST1
00545b62 : FSTP float ptr [ESP + 0x14]
00545b66 : FLD float ptr [ESP + 0x10]
00545b6a : FADD ST0,ST1
00545b6c : FSTP float ptr [ESP + 0x10]
00545b70 : FSUBR float ptr [ESP + 0x18]
00545b74 : FSTP float ptr [ESP + 0x18]
00545b78 : FLD float ptr [ESP + 0xc]
00545b7c : FSTP float ptr [ESI + 0x40]
00545b7f : FLD float ptr [ESP + 0x10]
00545b83 : FSTP float ptr [ESI + 0x44]
00545b86 : FLD float ptr [ESP + 0x14]
00545b8a : FSTP float ptr [ESI + 0x48]
00545b8d : FLD float ptr [ESP + 0x18]
00545b91 : FSTP float ptr [ESI + 0x4c]
00545b94 : JNZ 0x00545ca8
00545b9a : FLD float ptr [ESI + 0xfc]
00545ba0 : PUSH EBX
00545ba1 : FSUB float ptr [ESI + 0xf4]
00545ba7 : MOV BL,byte ptr [ESI + 0x140]
00545bad : PUSH EDI
00545bae : FSTP float ptr [ESP + 0x28]
00545bb2 : FLD float ptr [ESP + 0x28]
00545bb6 : FNSTCW word ptr [ESP + 0x28]
00545bba : MOVZX EAX,word ptr [ESP + 0x28]
00545bbf : OR EAX,0xc00
00545bc4 : MOV dword ptr [ESP + 0x2c],EAX
00545bc8 : FLDCW word ptr [ESP + 0x2c]
00545bcc : FISTP qword ptr [ESP + 0x14]
00545bd0 : MOV ECX,dword ptr [ESP + 0x14]
00545bd4 : FLDCW word ptr [ESP + 0x28]
00545bd8 : FLD float ptr [ESI + 0x100]
00545bde : FSUB float ptr [ESI + 0xf8]
00545be4 : FSTP float ptr [ESP + 0x28]
00545be8 : FLD float ptr [ESP + 0x28]
00545bec : FNSTCW word ptr [ESP + 0x28]
00545bf0 : MOVZX EAX,word ptr [ESP + 0x28]
00545bf5 : OR EAX,0xc00
00545bfa : MOV dword ptr [ESP + 0x2c],EAX
00545bfe : FLDCW word ptr [ESP + 0x2c]
00545c02 : FISTP qword ptr [ESP + 0x14]
00545c06 : MOV EDI,dword ptr [ESP + 0x14]
00545c0a : FLDCW word ptr [ESP + 0x28]
00545c0e : TEST BL,0x30
00545c11 : JNZ 0x00545c9f
00545c17 : CMP EDX,ECX
00545c19 : JZ 0x00545c41
00545c1b : TEST byte ptr [ESI + 0x141],0x8
00545c22 : JNZ 0x00545c9f
00545c24 : CMP ECX,EDX
00545c26 : JNC 0x00545c31
00545c28 : TEST byte ptr [ESI + 0x9c],0x20
00545c2f : JNZ 0x00545c9f
00545c31 : TEST BL,0x3
00545c34 : JNZ 0x00545c9f
00545c36 : MOV ECX,ESI
00545c38 : CALL 0x005451c0
00545c3d : TEST AL,AL
00545c3f : JNZ 0x00545c9f
00545c41 : CMP EBP,EDI
00545c43 : JZ 0x00545c5f
00545c45 : SHR BL,0x2
00545c48 : AND BL,0x3
00545c4b : JZ 0x00545c52
00545c4d : CMP BL,0x1
00545c50 : JNZ 0x00545c9f
00545c52 : CMP EDI,EBP
00545c54 : JNC 0x00545c5f
00545c56 : TEST byte ptr [ESI + 0x9c],0x20
00545c5d : JNZ 0x00545c9f
00545c5f : INC word ptr [ESI + 0x13c]
00545c66 : MOV ECX,ESI
00545c68 : CALL 0x005452b0
00545c6d : CMP dword ptr [ESI + 0x50],EAX
00545c70 : JBE 0x00545c7a
00545c72 : PUSH EAX
00545c73 : MOV ECX,ESI
00545c75 : CALL 0x005455c0
00545c7a : MOV ECX,ESI
00545c7c : CALL 0x005452d0
00545c81 : CMP dword ptr [ESI + 0x3c],EAX
00545c84 : JBE 0x00545c8e
00545c86 : PUSH EAX
00545c87 : MOV ECX,ESI
00545c89 : CALL 0x00545620
00545c8e : OR byte ptr [ESI + 0x9c],0x1
00545c95 : POP EDI
00545c96 : POP EBX
00545c97 : POP EBP
00545c98 : POP ESI
00545c99 : ADD ESP,0x14
00545c9c : RET 0x8
00545c9f : OR byte ptr [ESI + 0x143],0x2
00545ca6 : POP EDI
00545ca7 : POP EBX
00545ca8 : POP EBP
00545ca9 : POP ESI
00545caa : ADD ESP,0x14
00545cad : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_00403c70
ENTRY    : 00403c70
BODY     : [[00403c70, 00403d03]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_00403c70(short *param_1,int param_2)

{
  int *piVar1;
  uint uVar2;
  int in_EAX;
  int *piVar3;
  int *piVar4;
  short *psVar5;
  short *psVar6;
  uint in_EDX;
  int iVar7;
  
  if ((param_2 != 0) && (in_EDX < *(uint *)(in_EAX + 0x14))) {
    uVar2 = *(uint *)(in_EAX + 0x18);
    piVar1 = (int *)(in_EAX + 4);
    piVar3 = piVar1;
    if (7 < uVar2) {
      piVar3 = (int *)*piVar1;
    }
    piVar4 = piVar1;
    if (7 < uVar2) {
      piVar4 = (int *)*piVar1;
    }
    for (psVar5 = (short *)((int)piVar4 + in_EDX * 2);
        psVar5 < (short *)((int)piVar3 + *(uint *)(in_EAX + 0x14) * 2); psVar5 = psVar5 + 1) {
      psVar6 = param_1;
      iVar7 = param_2;
      do {
        if (*psVar6 == *psVar5) {
          if (7 < uVar2) {
            return (int)psVar5 - *piVar1 >> 1;
          }
          return (int)psVar5 - (int)piVar1 >> 1;
        }
        psVar6 = psVar6 + 1;
        iVar7 = iVar7 + -1;
      } while (iVar7 != 0);
    }
  }
  return -1;
}



============================================================
DISASSEMBLY
============================================================
00403c70 : PUSH EBP
00403c71 : MOV EBP,ESP
00403c73 : PUSH ECX
00403c74 : CMP dword ptr [EBP + 0xc],0x0
00403c78 : PUSH EBX
00403c79 : PUSH ESI
00403c7a : PUSH EDI
00403c7b : JBE 0x00403cd4
00403c7d : MOV ECX,dword ptr [EAX + 0x14]
00403c80 : CMP EDX,ECX
00403c82 : JNC 0x00403cd4
00403c84 : MOV ESI,dword ptr [EAX + 0x18]
00403c87 : MOV dword ptr [EBP + -0x4],ESI
00403c8a : LEA EBX,[EAX + 0x4]
00403c8d : CMP ESI,0x8
00403c90 : JC 0x00403c96
00403c92 : MOV EAX,dword ptr [EBX]
00403c94 : JMP 0x00403c98
00403c96 : MOV EAX,EBX
00403c98 : LEA EDI,[EAX + ECX*0x2]
00403c9b : CMP ESI,0x8
00403c9e : JC 0x00403ca4
00403ca0 : MOV EAX,dword ptr [EBX]
00403ca2 : JMP 0x00403ca6
00403ca4 : MOV EAX,EBX
00403ca6 : LEA EAX,[EAX + EDX*0x2]
00403ca9 : CMP EAX,EDI
00403cab : JNC 0x00403cd4
00403cad : LEA ECX,[ECX]
00403cb0 : MOV EDX,dword ptr [EBP + 0xc]
00403cb3 : MOV ECX,dword ptr [EBP + 0x8]
00403cb6 : MOVZX ESI,word ptr [EAX]
00403cb9 : LEA ESP,[ESP]
00403cc0 : CMP word ptr [ECX],SI
00403cc3 : JZ 0x00403ce0
00403cc5 : ADD ECX,0x2
00403cc8 : SUB EDX,0x1
00403ccb : JNZ 0x00403cc0
00403ccd : ADD EAX,0x2
00403cd0 : CMP EAX,EDI
00403cd2 : JC 0x00403cb0
00403cd4 : POP EDI
00403cd5 : POP ESI
00403cd6 : OR EAX,0xffffffff
00403cd9 : POP EBX
00403cda : MOV ESP,EBP
00403cdc : POP EBP
00403cdd : RET 0x8
00403ce0 : CMP dword ptr [EBP + -0x4],0x8
00403ce4 : JC 0x00403cf5
00403ce6 : MOV ECX,dword ptr [EBX]
00403ce8 : POP EDI
00403ce9 : SUB EAX,ECX
00403ceb : POP ESI
00403cec : SAR EAX,0x1
00403cee : POP EBX
00403cef : MOV ESP,EBP
00403cf1 : POP EBP
00403cf2 : RET 0x8
00403cf5 : MOV ECX,EBX
00403cf7 : POP EDI
00403cf8 : SUB EAX,ECX
00403cfa : POP ESI
00403cfb : SAR EAX,0x1
00403cfd : POP EBX
00403cfe : MOV ESP,EBP
00403d00 : POP EBP
00403d01 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_0042b7e0
ENTRY    : 0042b7e0
BODY     : [[0042b7e0, 0042b855]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0042b7e0(void)

{
  wchar_t wVar1;
  wchar_t *_Dest;
  undefined4 in_ECX;
  ushort *unaff_ESI;
  
  _Dest = (wchar_t *)(unaff_ESI + 0xd);
  *unaff_ESI = 0;
  *(undefined1 *)(unaff_ESI + 1) = 0x46;
  *(undefined1 *)((int)unaff_ESI + 3) = 0x50;
  unaff_ESI[2] = 0;
  unaff_ESI[3] = 0;
  unaff_ESI[4] = 0;
  unaff_ESI[5] = 0;
  *(undefined4 *)(unaff_ESI + 6) = in_ECX;
  unaff_ESI[0xc] = 3;
  unaff_ESI[8] = 0;
  unaff_ESI[9] = 0;
  unaff_ESI[10] = 0;
  unaff_ESI[0xb] = 0;
  _wcsncpy(_Dest,L"",0xff);
  unaff_ESI[0x10c] = 0;
  do {
    wVar1 = *_Dest;
    _Dest = _Dest + 1;
  } while (wVar1 != L'\0');
  *unaff_ESI = *unaff_ESI ^
               ((short)((int)_Dest - (int)(unaff_ESI + 0xe) >> 1) * 2 + 0x1cU ^ *unaff_ESI) & 0x1fff
  ;
  return;
}



============================================================
DISASSEMBLY
============================================================
0042b7e0 : PUSH EBX
0042b7e1 : PUSH EDI
0042b7e2 : PUSH 0xff
0042b7e7 : XOR EBX,EBX
0042b7e9 : XOR EAX,EAX
0042b7eb : MOV EDX,0x3
0042b7f0 : LEA EDI,[ESI + 0x1a]
0042b7f3 : PUSH 0xc62bb4
0042b7f8 : PUSH EDI
0042b7f9 : MOV word ptr [ESI],AX
0042b7fc : MOV byte ptr [ESI + 0x2],0x46
0042b800 : MOV byte ptr [ESI + 0x3],0x50
0042b804 : MOV dword ptr [ESI + 0x4],EBX
0042b807 : MOV dword ptr [ESI + 0x8],EBX
0042b80a : MOV dword ptr [ESI + 0xc],ECX
0042b80d : MOV word ptr [ESI + 0x18],DX
0042b811 : MOV dword ptr [ESI + 0x10],EBX
0042b814 : MOV dword ptr [ESI + 0x14],EBX
0042b817 : CALL 0x00634e39
0042b81c : ADD ESP,0xc
0042b81f : XOR EAX,EAX
0042b821 : MOV word ptr [EDI + 0x1fe],AX
0042b828 : MOV EAX,EDI
0042b82a : LEA EDX,[EAX + 0x2]
0042b82d : LEA ECX,[ECX]
0042b830 : MOV CX,word ptr [EAX]
0042b833 : ADD EAX,0x2
0042b836 : CMP CX,BX
0042b839 : JNZ 0x0042b830
0042b83b : SUB EAX,EDX
0042b83d : SAR EAX,0x1
0042b83f : LEA ECX,[EAX + EAX*0x1 + 0x1c]
0042b843 : XOR CX,word ptr [ESI]
0042b846 : MOV EDX,0x1fff
0042b84b : AND CX,DX
0042b84e : XOR word ptr [ESI],CX
0042b851 : POP EDI
0042b852 : MOV EAX,ESI
0042b854 : POP EBX
0042b855 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_006c0250
ENTRY    : 006c0250
BODY     : [[006c0250, 006c03d5]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006c0250(uint param_1,undefined4 param_2,int param_3,int *param_4,int *param_5,
                undefined4 param_6,undefined4 param_7,undefined4 param_8)

{
  int iVar1;
  int iVar2;
  int unaff_EBX;
  undefined4 local_4;
  
  local_4 = 0;
  iVar1 = (**(code **)(unaff_EBX + 0x20))(*(undefined4 *)(unaff_EBX + 0x28),0x120,4);
  if (iVar1 == 0) {
    return -4;
  }
  iVar2 = FUN_006bfd20(param_3,param_1,0x101,&DAT_00bebef8,&DAT_00bebf78,param_6,param_4,param_8,
                       &local_4,iVar1);
  if (iVar2 == 0) {
    if (*param_4 != 0) {
      iVar2 = FUN_006bfd20(param_3 + param_1 * 4,param_2,0,&DAT_00bebff8,&DAT_00bec070,param_7,
                           param_5,param_8,&local_4,iVar1);
      if (iVar2 == 0) {
        if ((*param_5 != 0) || (param_1 < 0x102)) {
          (**(code **)(unaff_EBX + 0x24))(*(undefined4 *)(unaff_EBX + 0x28),iVar1);
          return 0;
        }
      }
      else {
        if (iVar2 == -3) {
          *(char **)(unaff_EBX + 0x18) = "oversubscribed distance tree";
          (**(code **)(unaff_EBX + 0x24))(*(undefined4 *)(unaff_EBX + 0x28),iVar1);
          return -3;
        }
        if (iVar2 == -5) {
          *(char **)(unaff_EBX + 0x18) = "incomplete distance tree";
          (**(code **)(unaff_EBX + 0x24))(*(undefined4 *)(unaff_EBX + 0x28),iVar1);
          return -3;
        }
        if (iVar2 == -4) goto LAB_006c037d;
      }
      *(char **)(unaff_EBX + 0x18) = "empty distance tree with lengths";
      iVar2 = -3;
LAB_006c037d:
      (**(code **)(unaff_EBX + 0x24))(*(undefined4 *)(unaff_EBX + 0x28),iVar1);
      return iVar2;
    }
  }
  else {
    if (iVar2 == -3) {
      *(char **)(unaff_EBX + 0x18) = "oversubscribed literal/length tree";
      (**(code **)(unaff_EBX + 0x24))(*(undefined4 *)(unaff_EBX + 0x28),iVar1);
      return -3;
    }
    if (iVar2 == -4) goto LAB_006c03c2;
  }
  *(char **)(unaff_EBX + 0x18) = "incomplete literal/length tree";
  iVar2 = -3;
LAB_006c03c2:
  (**(code **)(unaff_EBX + 0x24))(*(undefined4 *)(unaff_EBX + 0x28),iVar1);
  return iVar2;
}



============================================================
DISASSEMBLY
============================================================
006c0250 : PUSH ECX
006c0251 : MOV EAX,dword ptr [EBX + 0x28]
006c0254 : MOV ECX,dword ptr [EBX + 0x20]
006c0257 : PUSH EBP
006c0258 : MOV EBP,dword ptr [ESP + 0xc]
006c025c : PUSH ESI
006c025d : PUSH 0x4
006c025f : PUSH 0x120
006c0264 : PUSH EAX
006c0265 : MOV dword ptr [ESP + 0x14],0x0
006c026d : CALL ECX
006c026f : MOV ESI,EAX
006c0271 : ADD ESP,0xc
006c0274 : TEST ESI,ESI
006c0276 : JNZ 0x006c027f
006c0278 : LEA EAX,[ESI + -0x4]
006c027b : POP ESI
006c027c : POP EBP
006c027d : POP ECX
006c027e : RET
006c027f : MOV EAX,dword ptr [ESP + 0x2c]
006c0283 : MOV ECX,dword ptr [ESP + 0x1c]
006c0287 : PUSH EDI
006c0288 : PUSH ESI
006c0289 : LEA EDX,[ESP + 0x10]
006c028d : PUSH EDX
006c028e : MOV EDX,dword ptr [ESP + 0x30]
006c0292 : PUSH EAX
006c0293 : MOV EAX,dword ptr [ESP + 0x28]
006c0297 : PUSH ECX
006c0298 : PUSH EDX
006c0299 : PUSH 0xbebf78
006c029e : PUSH 0xbebef8
006c02a3 : PUSH 0x101
006c02a8 : PUSH EBP
006c02a9 : PUSH EAX
006c02aa : CALL 0x006bfd20
006c02af : MOV EDI,EAX
006c02b1 : ADD ESP,0x28
006c02b4 : TEST EDI,EDI
006c02b6 : JNZ 0x006c0391
006c02bc : MOV ECX,dword ptr [ESP + 0x20]
006c02c0 : CMP dword ptr [ECX],EAX
006c02c2 : JZ 0x006c03b6
006c02c8 : MOV EAX,dword ptr [ESP + 0x30]
006c02cc : MOV ECX,dword ptr [ESP + 0x24]
006c02d0 : PUSH ESI
006c02d1 : LEA EDX,[ESP + 0x10]
006c02d5 : PUSH EDX
006c02d6 : MOV EDX,dword ptr [ESP + 0x34]
006c02da : PUSH EAX
006c02db : MOV EAX,dword ptr [ESP + 0x24]
006c02df : PUSH ECX
006c02e0 : MOV ECX,dword ptr [ESP + 0x2c]
006c02e4 : PUSH EDX
006c02e5 : PUSH 0xbec070
006c02ea : PUSH 0xbebff8
006c02ef : PUSH EDI
006c02f0 : PUSH EAX
006c02f1 : LEA EDX,[ECX + EBP*0x4]
006c02f4 : PUSH EDX
006c02f5 : CALL 0x006bfd20
006c02fa : MOV EDI,EAX
006c02fc : ADD ESP,0x28
006c02ff : TEST EDI,EDI
006c0301 : JNZ 0x006c0327
006c0303 : MOV EAX,dword ptr [ESP + 0x24]
006c0307 : CMP dword ptr [EAX],EDI
006c0309 : JNZ 0x006c0313
006c030b : CMP EBP,0x101
006c0311 : JA 0x006c0371
006c0313 : MOV ECX,dword ptr [EBX + 0x28]
006c0316 : MOV EDX,dword ptr [EBX + 0x24]
006c0319 : PUSH ESI
006c031a : PUSH ECX
006c031b : CALL EDX
006c031d : ADD ESP,0x8
006c0320 : POP EDI
006c0321 : POP ESI
006c0322 : XOR EAX,EAX
006c0324 : POP EBP
006c0325 : POP ECX
006c0326 : RET
006c0327 : CMP EDI,-0x3
006c032a : JNZ 0x006c0347
006c032c : MOV EAX,dword ptr [EBX + 0x28]
006c032f : MOV ECX,dword ptr [EBX + 0x24]
006c0332 : PUSH ESI
006c0333 : PUSH EAX
006c0334 : MOV dword ptr [EBX + 0x18],0xbed34c
006c033b : CALL ECX
006c033d : ADD ESP,0x8
006c0340 : MOV EAX,EDI
006c0342 : POP EDI
006c0343 : POP ESI
006c0344 : POP EBP
006c0345 : POP ECX
006c0346 : RET
006c0347 : CMP EDI,-0x5
006c034a : JNZ 0x006c036c
006c034c : MOV EAX,dword ptr [EBX + 0x28]
006c034f : MOV ECX,dword ptr [EBX + 0x24]
006c0352 : PUSH ESI
006c0353 : PUSH EAX
006c0354 : MOV dword ptr [EBX + 0x18],0xbed330
006c035b : MOV EDI,0xfffffffd
006c0360 : CALL ECX
006c0362 : ADD ESP,0x8
006c0365 : MOV EAX,EDI
006c0367 : POP EDI
006c0368 : POP ESI
006c0369 : POP EBP
006c036a : POP ECX
006c036b : RET
006c036c : CMP EDI,-0x4
006c036f : JZ 0x006c037d
006c0371 : MOV dword ptr [EBX + 0x18],0xbed30c
006c0378 : MOV EDI,0xfffffffd
006c037d : MOV EAX,dword ptr [EBX + 0x28]
006c0380 : MOV ECX,dword ptr [EBX + 0x24]
006c0383 : PUSH ESI
006c0384 : PUSH EAX
006c0385 : CALL ECX
006c0387 : ADD ESP,0x8
006c038a : MOV EAX,EDI
006c038c : POP EDI
006c038d : POP ESI
006c038e : POP EBP
006c038f : POP ECX
006c0390 : RET
006c0391 : CMP EDI,-0x3
006c0394 : JNZ 0x006c03b1
006c0396 : MOV EDX,dword ptr [EBX + 0x28]
006c0399 : MOV EAX,dword ptr [EBX + 0x24]
006c039c : PUSH ESI
006c039d : PUSH EDX
006c039e : MOV dword ptr [EBX + 0x18],0xbed2e8
006c03a5 : CALL EAX
006c03a7 : ADD ESP,0x8
006c03aa : MOV EAX,EDI
006c03ac : POP EDI
006c03ad : POP ESI
006c03ae : POP EBP
006c03af : POP ECX
006c03b0 : RET
006c03b1 : CMP EDI,-0x4
006c03b4 : JZ 0x006c03c2
006c03b6 : MOV dword ptr [EBX + 0x18],0xbed2c8
006c03bd : MOV EDI,0xfffffffd
006c03c2 : MOV EDX,dword ptr [EBX + 0x28]
006c03c5 : MOV EAX,dword ptr [EBX + 0x24]
006c03c8 : PUSH ESI
006c03c9 : PUSH EDX
006c03ca : CALL EAX
006c03cc : ADD ESP,0x8
006c03cf : MOV EAX,EDI
006c03d1 : POP EDI
006c03d2 : POP ESI
006c03d3 : POP EBP
006c03d4 : POP ECX
006c03d5 : RET

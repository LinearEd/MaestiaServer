PROGRAM  : Maestia.exe
FUNCTION : FUN_00870e80
ENTRY    : 00870e80
BODY     : [[00870e80, 00871015]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00870e80(void)

{
  int iVar1;
  int *piVar2;
  int *piVar3;
  int *in_ECX;
  LPCRITICAL_SECTION local_28;
  char *local_24;
  undefined4 local_20;
  int local_1c;
  undefined4 local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b490ab;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  in_ECX[0x7e5] = 0;
  *(undefined1 *)((int)in_ECX + 0x4cb) = 0;
  *(undefined1 *)(in_ECX + 0x133) = 0;
  in_ECX[0x7e2] = 0;
  in_ECX[0x7e3] = 0;
  in_ECX[0x7e4] = 0;
  FUN_00854e20(local_14);
  FUN_00888de0();
  iVar1 = *(int *)(*DAT_00da9894 + 0x18c);
  (**(code **)**(undefined4 **)(*DAT_00da9894 + 0x114))("CastingClose");
  *(undefined1 *)(iVar1 + 0x38) = 0;
  *(undefined4 *)(iVar1 + 0x44) = 0;
  (**(code **)(*in_ECX + 0x200))();
  iVar1 = in_ECX[0xe3];
  local_28 = (LPCRITICAL_SECTION)(iVar1 + 0x70);
  local_1c = 0;
  local_24 = ".\\Objects\\AvaEffectMgr.cpp";
  local_20 = 0x22b;
  local_18 = 1;
  FUN_006ef1a0(&local_28);
  local_8 = 0xffffffff;
  if (local_1c != 0) {
    LeaveCriticalSection(local_28);
    local_1c = 0;
  }
  piVar2 = (int *)FUN_00a6bba0(0x65);
  if (piVar2 == (int *)0x0) {
    piVar2 = (int *)FUN_00a6bad0(0x65);
    if (piVar2 != (int *)0x0) {
      piVar3 = (int *)FUN_00a6b6b0();
      if (piVar3 == (int *)0x0) {
        FUN_00a6c940();
        piVar3 = piVar2;
      }
      if (((piVar3[0x5f] != 0) && (1000.0 <= *(float *)(piVar3[0x5f] + 0x24))) &&
         (*(char *)(iVar1 + 0x5c) != '\0')) {
        (**(code **)(*piVar3 + 0xd4))();
        FUN_00a6b5d0();
      }
    }
  }
  else {
    piVar3 = (int *)FUN_00a6b780();
    if (piVar3 == (int *)0x0) {
      FUN_00a6d020(iVar1,0);
      piVar3 = piVar2;
    }
    if ((*(char *)((int)piVar3 + 5) != '\0') && (*(char *)(iVar1 + 0x5c) != '\0')) {
      (**(code **)(*piVar3 + 0x24))();
      FUN_00a6c0d0();
    }
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00870e80 : PUSH EBP
00870e81 : MOV EBP,ESP
00870e83 : PUSH -0x1
00870e85 : PUSH 0xb490ab
00870e8a : MOV EAX,FS:[0x0]
00870e90 : PUSH EAX
00870e91 : SUB ESP,0x18
00870e94 : MOV EAX,[0x00d66fa0]
00870e99 : XOR EAX,EBP
00870e9b : MOV dword ptr [EBP + -0x10],EAX
00870e9e : PUSH EBX
00870e9f : PUSH ESI
00870ea0 : PUSH EDI
00870ea1 : PUSH EAX
00870ea2 : LEA EAX,[EBP + -0xc]
00870ea5 : MOV FS:[0x0],EAX
00870eab : MOV ESI,ECX
00870ead : XOR EDI,EDI
00870eaf : MOV dword ptr [ESI + 0x1f94],EDI
00870eb5 : MOV byte ptr [ESI + 0x4cb],0x0
00870ebc : MOV byte ptr [ESI + 0x4cc],0x0
00870ec3 : MOV dword ptr [ESI + 0x1f88],EDI
00870ec9 : MOV dword ptr [ESI + 0x1f8c],EDI
00870ecf : MOV dword ptr [ESI + 0x1f90],EDI
00870ed5 : CALL 0x00854e20
00870eda : MOV ECX,ESI
00870edc : CALL 0x00888de0
00870ee1 : MOV EAX,[0x00da9894]
00870ee6 : MOV EAX,dword ptr [EAX]
00870ee8 : MOV EBX,dword ptr [EAX + 0x18c]
00870eee : MOV EAX,dword ptr [EAX + 0x114]
00870ef4 : MOV EDX,dword ptr [EAX]
00870ef6 : MOV ECX,EAX
00870ef8 : MOV EAX,dword ptr [EDX]
00870efa : PUSH 0xc652d4
00870eff : CALL EAX
00870f01 : XORPS XMM0,XMM0
00870f04 : MOV byte ptr [EBX + 0x38],0x0
00870f08 : MOVSS dword ptr [EBX + 0x44],XMM0
00870f0d : MOV EDX,dword ptr [ESI]
00870f0f : MOV EAX,dword ptr [EDX + 0x200]
00870f15 : MOV ECX,ESI
00870f17 : CALL EAX
00870f19 : MOV EBX,dword ptr [ESI + 0x38c]
00870f1f : LEA EDX,[EBP + -0x24]
00870f22 : LEA ECX,[EBX + 0x70]
00870f25 : PUSH EDX
00870f26 : MOV dword ptr [EBP + -0x18],EDI
00870f29 : MOV dword ptr [EBP + -0x24],ECX
00870f2c : MOV dword ptr [EBP + -0x20],0xc43e84
00870f33 : MOV dword ptr [EBP + -0x1c],0x22b
00870f3a : MOV dword ptr [EBP + -0x14],0x1
00870f41 : CALL 0x006ef1a0
00870f46 : MOV dword ptr [EBP + -0x4],0xffffffff
00870f4d : CMP dword ptr [EBP + -0x18],EDI
00870f50 : JZ 0x00870f5f
00870f52 : MOV EAX,dword ptr [EBP + -0x24]
00870f55 : PUSH EAX
00870f56 : CALL dword ptr [0x00b8511c]
00870f5c : MOV dword ptr [EBP + -0x18],EDI
00870f5f : PUSH 0x65
00870f61 : MOV ECX,EBX
00870f63 : CALL 0x00a6bba0
00870f68 : MOV ESI,EAX
00870f6a : MOV ECX,EBX
00870f6c : CMP ESI,EDI
00870f6e : JZ 0x00870fa6
00870f70 : MOV EDI,ESI
00870f72 : CALL 0x00a6b780
00870f77 : MOV EDI,EAX
00870f79 : TEST EDI,EDI
00870f7b : JNZ 0x00870f86
00870f7d : PUSH EAX
00870f7e : PUSH EBX
00870f7f : MOV EDI,ESI
00870f81 : CALL 0x00a6d020
00870f86 : CMP byte ptr [EDI + 0x5],0x0
00870f8a : JZ 0x00870ffa
00870f8c : CMP byte ptr [EBX + 0x5c],0x0
00870f90 : JZ 0x00870ffa
00870f92 : MOV EDX,dword ptr [EDI]
00870f94 : MOV EAX,dword ptr [EDX + 0x24]
00870f97 : MOV ECX,EDI
00870f99 : CALL EAX
00870f9b : MOV ECX,EDI
00870f9d : MOV EDX,EBX
00870f9f : CALL 0x00a6c0d0
00870fa4 : JMP 0x00870ffa
00870fa6 : PUSH 0x65
00870fa8 : CALL 0x00a6bad0
00870fad : MOV EDI,EAX
00870faf : TEST EDI,EDI
00870fb1 : JZ 0x00870ffa
00870fb3 : MOV ECX,EBX
00870fb5 : CALL 0x00a6b6b0
00870fba : MOV ESI,EAX
00870fbc : TEST ESI,ESI
00870fbe : JNZ 0x00870fc9
00870fc0 : MOV ESI,EBX
00870fc2 : CALL 0x00a6c940
00870fc7 : MOV ESI,EDI
00870fc9 : MOV EAX,dword ptr [ESI + 0x17c]
00870fcf : TEST EAX,EAX
00870fd1 : JZ 0x00870ffa
00870fd3 : MOVSS XMM0,dword ptr [EAX + 0x24]
00870fd8 : COMISS XMM0,dword ptr [0x00cdf16c]
00870fdf : JC 0x00870ffa
00870fe1 : CMP byte ptr [EBX + 0x5c],0x0
00870fe5 : JZ 0x00870ffa
00870fe7 : MOV EDX,dword ptr [ESI]
00870fe9 : MOV EAX,dword ptr [EDX + 0xd4]
00870fef : MOV ECX,ESI
00870ff1 : CALL EAX
00870ff3 : MOV ECX,EBX
00870ff5 : CALL 0x00a6b5d0
00870ffa : MOV ECX,dword ptr [EBP + -0xc]
00870ffd : MOV dword ptr FS:[0x0],ECX
00871004 : POP ECX
00871005 : POP EDI
00871006 : POP ESI
00871007 : POP EBX
00871008 : MOV ECX,dword ptr [EBP + -0x10]
0087100b : XOR ECX,EBP
0087100d : CALL 0x00633e6b
00871012 : MOV ESP,EBP
00871014 : POP EBP
00871015 : RET

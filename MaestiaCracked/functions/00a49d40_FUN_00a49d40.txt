PROGRAM  : Maestia.exe
FUNCTION : FUN_00a49d40
ENTRY    : 00a49d40
BODY     : [[00a49d40, 00a49d5c] [00a49d60, 00a49d88] [00a49d90, 00a49e63]]

============================================================
DECOMPILED C CODE
============================================================

uint FUN_00a49d40(int param_1,int *param_2)

{
  char cVar1;
  int *piVar2;
  int *piVar3;
  int iVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  int in_ECX;
  
  piVar2 = *(int **)(in_ECX + 0x10c);
  piVar3 = (int *)*piVar2;
  while (piVar3 != piVar2) {
    iVar4 = piVar3[4];
    if (*(int *)(iVar4 + 4) == param_1) {
      if (iVar4 == 0) {
        *param_2 = 0;
        return 1;
      }
      iVar4 = *(int *)(*(int *)(iVar4 + 0x138) + 8) + 0x138 + iVar4;
      *param_2 = iVar4;
      return CONCAT31((int3)((uint)iVar4 >> 8),1);
    }
    FUN_00416210();
  }
  puVar6 = (undefined4 *)**(undefined4 **)(in_ECX + 0x204);
  while( true ) {
    if (puVar6 == *(undefined4 **)(in_ECX + 0x204)) {
      *param_2 = 0;
      return (uint)piVar3 & 0xffffff00;
    }
    piVar3 = (int *)puVar6[4];
    if (piVar3[1] == param_1) break;
    if (*(char *)((int)puVar6 + 0x15) == '\0') {
      puVar5 = (undefined4 *)puVar6[2];
      if (*(char *)((int)puVar5 + 0x15) == '\0') {
        cVar1 = *(char *)((int)*puVar5 + 0x15);
        piVar3 = (undefined4 *)*puVar5;
        while (puVar6 = puVar5, cVar1 == '\0') {
          cVar1 = *(char *)(*piVar3 + 0x15);
          puVar5 = piVar3;
          piVar3 = (undefined4 *)*piVar3;
        }
      }
      else {
        cVar1 = *(char *)((int)puVar6[1] + 0x15);
        puVar7 = (undefined4 *)puVar6[1];
        puVar5 = puVar6;
        while ((piVar3 = puVar7, puVar6 = piVar3, cVar1 == '\0' &&
               (puVar5 == (undefined4 *)piVar3[2]))) {
          cVar1 = *(char *)(piVar3[1] + 0x15);
          puVar7 = (undefined4 *)piVar3[1];
          puVar5 = piVar3;
        }
      }
    }
  }
  if (piVar3 == (undefined4 *)0x0) {
    *param_2 = 0;
    return 1;
  }
  iVar4 = *(int *)(piVar3[0x4e] + 8) + 0x138 + (int)piVar3;
  *param_2 = iVar4;
  return CONCAT31((int3)((uint)iVar4 >> 8),1);
}



============================================================
DISASSEMBLY
============================================================
00a49d40 : PUSH EBP
00a49d41 : MOV EBP,ESP
00a49d43 : PUSH ECX
00a49d44 : PUSH EBX
00a49d45 : MOV EBX,dword ptr [EBP + 0x8]
00a49d48 : PUSH ESI
00a49d49 : PUSH EDI
00a49d4a : MOV EDI,ECX
00a49d4c : MOV ESI,dword ptr [EDI + 0x10c]
00a49d52 : MOV EAX,dword ptr [ESI]
00a49d54 : MOV dword ptr [EBP + -0x4],EAX
00a49d57 : CMP EAX,ESI
00a49d59 : JZ 0x00a49d77
00a49d5b : JMP 0x00a49d60
00a49d60 : MOV ECX,dword ptr [EAX + 0x10]
00a49d63 : CMP dword ptr [ECX + 0x4],EBX
00a49d66 : JZ 0x00a49dc1
00a49d68 : LEA EDX,[EBP + -0x4]
00a49d6b : CALL 0x00416210
00a49d70 : MOV EAX,dword ptr [EBP + -0x4]
00a49d73 : CMP EAX,ESI
00a49d75 : JNZ 0x00a49d60
00a49d77 : MOV EDI,dword ptr [EDI + 0x204]
00a49d7d : MOV ECX,dword ptr [EDI]
00a49d7f : CMP ECX,EDI
00a49d81 : JZ 0x00a49e1a
00a49d87 : JMP 0x00a49d90
00a49d90 : MOV EAX,dword ptr [ECX + 0x10]
00a49d93 : CMP dword ptr [EAX + 0x4],EBX
00a49d96 : JZ 0x00a49e2e
00a49d9c : CMP byte ptr [ECX + 0x15],0x0
00a49da0 : JNZ 0x00a49e12
00a49da2 : MOV EAX,dword ptr [ECX + 0x8]
00a49da5 : CMP byte ptr [EAX + 0x15],0x0
00a49da9 : JNZ 0x00a49df7
00a49dab : MOV ECX,EAX
00a49dad : MOV EAX,dword ptr [ECX]
00a49daf : CMP byte ptr [EAX + 0x15],0x0
00a49db3 : JNZ 0x00a49e12
00a49db5 : MOV ECX,EAX
00a49db7 : MOV EAX,dword ptr [ECX]
00a49db9 : CMP byte ptr [EAX + 0x15],0x0
00a49dbd : JZ 0x00a49db5
00a49dbf : JMP 0x00a49e12
00a49dc1 : MOV EAX,ECX
00a49dc3 : TEST EAX,EAX
00a49dc5 : JNZ 0x00a49dd7
00a49dc7 : MOV EDX,dword ptr [EBP + 0xc]
00a49dca : POP EDI
00a49dcb : POP ESI
00a49dcc : MOV dword ptr [EDX],EAX
00a49dce : MOV AL,0x1
00a49dd0 : POP EBX
00a49dd1 : MOV ESP,EBP
00a49dd3 : POP EBP
00a49dd4 : RET 0x8
00a49dd7 : MOV EDX,dword ptr [EAX + 0x138]
00a49ddd : MOV ECX,dword ptr [EDX + 0x8]
00a49de0 : MOV EDX,dword ptr [EBP + 0xc]
00a49de3 : POP EDI
00a49de4 : LEA EAX,[ECX + EAX*0x1 + 0x138]
00a49deb : POP ESI
00a49dec : MOV dword ptr [EDX],EAX
00a49dee : MOV AL,0x1
00a49df0 : POP EBX
00a49df1 : MOV ESP,EBP
00a49df3 : POP EBP
00a49df4 : RET 0x8
00a49df7 : MOV EAX,dword ptr [ECX + 0x4]
00a49dfa : CMP byte ptr [EAX + 0x15],0x0
00a49dfe : JNZ 0x00a49e10
00a49e00 : CMP ECX,dword ptr [EAX + 0x8]
00a49e03 : JNZ 0x00a49e10
00a49e05 : MOV ECX,EAX
00a49e07 : MOV EAX,dword ptr [EAX + 0x4]
00a49e0a : CMP byte ptr [EAX + 0x15],0x0
00a49e0e : JZ 0x00a49e00
00a49e10 : MOV ECX,EAX
00a49e12 : CMP ECX,EDI
00a49e14 : JNZ 0x00a49d90
00a49e1a : MOV EDX,dword ptr [EBP + 0xc]
00a49e1d : POP EDI
00a49e1e : POP ESI
00a49e1f : MOV dword ptr [EDX],0x0
00a49e25 : XOR AL,AL
00a49e27 : POP EBX
00a49e28 : MOV ESP,EBP
00a49e2a : POP EBP
00a49e2b : RET 0x8
00a49e2e : MOV ECX,EAX
00a49e30 : TEST ECX,ECX
00a49e32 : JNZ 0x00a49e44
00a49e34 : MOV ECX,dword ptr [EBP + 0xc]
00a49e37 : POP EDI
00a49e38 : POP ESI
00a49e39 : MOV dword ptr [ECX],EAX
00a49e3b : MOV AL,0x1
00a49e3d : POP EBX
00a49e3e : MOV ESP,EBP
00a49e40 : POP EBP
00a49e41 : RET 0x8
00a49e44 : MOV EDX,dword ptr [ECX + 0x138]
00a49e4a : MOV EAX,dword ptr [EDX + 0x8]
00a49e4d : LEA EAX,[EAX + ECX*0x1 + 0x138]
00a49e54 : MOV ECX,dword ptr [EBP + 0xc]
00a49e57 : POP EDI
00a49e58 : POP ESI
00a49e59 : MOV dword ptr [ECX],EAX
00a49e5b : MOV AL,0x1
00a49e5d : POP EBX
00a49e5e : MOV ESP,EBP
00a49e60 : POP EBP
00a49e61 : RET 0x8

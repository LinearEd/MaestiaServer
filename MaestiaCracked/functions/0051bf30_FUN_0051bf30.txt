PROGRAM  : Maestia.exe
FUNCTION : FUN_0051bf30
ENTRY    : 0051bf30
BODY     : [[0051bf30, 0051bf6b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0051bf30(void)

{
  uint uVar1;
  LONG LVar2;
  uint *in_ECX;
  
  InterlockedExchangeAdd((LONG *)&DAT_00d65134,1);
  uVar1 = *in_ECX;
  LVar2 = InterlockedExchangeAdd((LONG *)((uVar1 & 0xfffffffc) + 4),-1);
  if (LVar2 == 1) {
    FUN_00515cf0(uVar1 & 0xfffffffc);
  }
  *in_ECX = *in_ECX & 3 | 0xd65130;
  return;
}



============================================================
DISASSEMBLY
============================================================
0051bf30 : PUSH EBX
0051bf31 : MOV EBX,dword ptr [0x00b851cc]
0051bf37 : PUSH ESI
0051bf38 : PUSH EDI
0051bf39 : PUSH 0x1
0051bf3b : PUSH 0xd65134
0051bf40 : MOV EDI,ECX
0051bf42 : CALL EBX
0051bf44 : MOV ESI,dword ptr [EDI]
0051bf46 : AND ESI,0xfffffffc
0051bf49 : PUSH -0x1
0051bf4b : LEA EAX,[ESI + 0x4]
0051bf4e : PUSH EAX
0051bf4f : CALL EBX
0051bf51 : SUB EAX,0x1
0051bf54 : JNZ 0x0051bf5c
0051bf56 : PUSH ESI
0051bf57 : CALL 0x00515cf0
0051bf5c : MOV EAX,dword ptr [EDI]
0051bf5e : AND EAX,0x3
0051bf61 : OR EAX,0xd65130
0051bf66 : MOV dword ptr [EDI],EAX
0051bf68 : POP EDI
0051bf69 : POP ESI
0051bf6a : POP EBX
0051bf6b : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00557010
ENTRY    : 00557010
BODY     : [[00557010, 005570a7] [005570b0, 005571d7] [005571e0, 00557248] [00557250, 005573a4]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00557010(void)

{
  uint uVar1;
  int *piVar2;
  ushort uVar3;
  int *in_ECX;
  int iVar4;
  int iVar5;
  int *piVar6;
  uint unaff_EDI;
  int iVar7;
  uint auStack_ec [2];
  int iStack_e4;
  int local_e0;
  undefined4 local_dc [2];
  ushort uStack_d4;
  uint uStack_d0;
  uint uStack_cc;
  int iStack_c0;
  int iStack_bc;
  ushort uStack_b0;
  uint uStack_ac;
  uint uStack_a8;
  int aiStack_a0 [7];
  uint uStack_84;
  uint uStack_80;
  int iStack_7c;
  int iStack_78;
  int iStack_6c;
  int iStack_68;
  float fStack_64;
  uint uStack_5c;
  uint uStack_58;
  int iStack_54;
  int iStack_50;
  int iStack_44;
  int iStack_40;
  float fStack_3c;
  undefined4 uStack_38;
  int iStack_28;
  undefined4 uStack_24;
  int iStack_14;
  int *piStack_4;
  
  local_dc[0] = 0;
  local_e0 = 0;
  (**(code **)(*in_ECX + 0x44))(local_dc);
  auStack_ec[0] = 0;
  (**(code **)(*piStack_4 + 0x44))(auStack_ec,&stack0xffffff10);
  if ((auStack_ec[0] != unaff_EDI) || (&stack0x00000000 != (undefined1 *)0xe0)) {
    return 0;
  }
  FUN_005548f0(in_ECX);
  FUN_005548f0(piStack_4);
  iVar5 = local_e0;
  iVar7 = iStack_bc;
  uVar3 = uStack_b0;
  if (uStack_d0 < uStack_cc) {
    do {
      if (uStack_a8 <= uStack_ac) {
        return 0;
      }
      FUN_00555ad0(0x4c,0x50,0x54);
      FUN_00555ad0(0x40,0x44,0x48);
      uVar1 = 0xc;
      iVar4 = 0;
      do {
        if (*(int *)(iVar4 + 0x4c) != *(int *)(iVar4 + 0x40)) {
          return 0;
        }
        uVar1 = uVar1 - 4;
        iVar4 = iVar4 + 4;
      } while (3 < uVar1);
      FUN_00555980(0xfffffff8);
      FUN_00555980(0x1c);
      if (fStack_64 * (float)iStack_7c != fStack_3c * (float)iStack_54) {
        return 0;
      }
      if ((float)iStack_78 * fStack_64 != (float)iStack_50 * fStack_3c) {
        return 0;
      }
      if (uStack_58 != uStack_80) {
        return 0;
      }
      if (uStack_5c < uStack_58) {
        do {
          if (uStack_80 <= uStack_84) {
            return 0;
          }
          FUN_005547c0(0xbc);
          FUN_005547c0(0xa8);
          if (iStack_14 != iStack_28) {
            return 0;
          }
          piVar2 = (int *)0xa8;
          piVar6 = (int *)0xbc;
          for (uVar1 = iStack_14 * 4; 3 < uVar1; uVar1 = uVar1 - 4) {
            if (*piVar6 != *piVar2) {
              return 0;
            }
            piVar2 = piVar2 + 1;
            piVar6 = piVar6 + 1;
          }
          if (uVar1 != 0) {
            if ((char)*piVar2 != (char)*piVar6) {
              return 0;
            }
            if (1 < uVar1) {
              if (*(char *)((int)piVar2 + 1) != *(char *)((int)piVar6 + 1)) {
                return 0;
              }
              if ((2 < uVar1) && (*(char *)((int)piVar2 + 2) != *(char *)((int)piVar6 + 2))) {
                return 0;
              }
            }
          }
        } while (uStack_5c < uStack_58);
      }
      iStack_e4 = iStack_44;
      if (iStack_44 == 0) {
        iStack_e4 = iStack_40;
      }
      piVar2 = (int *)(iVar5 - (uint)uStack_d4);
      uStack_d0 = uStack_d0 + 1;
      if (piVar2[1] <= (iStack_e4 - (int)piVar2) + -8) {
        iVar4 = *piVar2;
        if (iVar4 == 0) {
          iStack_e4 = 0;
        }
        else {
          iVar5 = iVar4 + 8;
          uStack_d4 = (short)iVar5 - (short)iVar4;
          iStack_e4 = iVar5;
          local_e0 = iVar5;
        }
      }
      if (uStack_80 <= uStack_84) {
        iStack_c0 = iStack_6c;
        if (iStack_6c == 0) {
          iStack_c0 = iStack_68;
        }
        uStack_ac = uStack_ac + 1;
        piVar2 = (int *)(iVar7 - (uint)uVar3);
        if (piVar2[1] <= (iStack_c0 - (int)piVar2) + -8) {
          iVar4 = *piVar2;
          if (iVar4 == 0) {
            iStack_c0 = 0;
          }
          else {
            iVar7 = iVar4 + 8;
            uVar3 = (short)iVar7 - (short)iVar4;
            iStack_c0 = iVar7;
            iStack_bc = iVar7;
            uStack_b0 = uVar3;
          }
        }
      }
    } while (uStack_d0 < uStack_cc);
  }
  return 1;
}



============================================================
DISASSEMBLY
============================================================
00557010 : SUB ESP,0xec
00557016 : PUSH ESI
00557017 : MOV ESI,ECX
00557019 : MOV EAX,dword ptr [ESI]
0055701b : MOV EAX,dword ptr [EAX + 0x44]
0055701e : PUSH EDI
0055701f : LEA ECX,[ESP + 0x14]
00557023 : PUSH ECX
00557024 : LEA EDX,[ESP + 0x1c]
00557028 : XOR EDI,EDI
0055702a : PUSH EDX
0055702b : MOV ECX,ESI
0055702d : MOV dword ptr [ESP + 0x20],EDI
00557031 : MOV dword ptr [ESP + 0x1c],EDI
00557035 : CALL EAX
00557037 : MOV dword ptr [ESP + 0x10],EDI
0055703b : MOV dword ptr [ESP + 0xc],EDI
0055703f : MOV EDI,dword ptr [ESP + 0xf8]
00557046 : MOV EDX,dword ptr [EDI]
00557048 : MOV EDX,dword ptr [EDX + 0x44]
0055704b : LEA EAX,[ESP + 0xc]
0055704f : PUSH EAX
00557050 : LEA ECX,[ESP + 0x14]
00557054 : PUSH ECX
00557055 : MOV ECX,EDI
00557057 : CALL EDX
00557059 : MOV EAX,dword ptr [ESP + 0x18]
0055705d : CMP EAX,dword ptr [ESP + 0x10]
00557061 : JNZ 0x00557398
00557067 : MOV ECX,dword ptr [ESP + 0x14]
0055706b : CMP ECX,dword ptr [ESP + 0xc]
0055706f : JNZ 0x00557398
00557075 : PUSH EBX
00557076 : PUSH EBP
00557077 : PUSH ESI
00557078 : LEA ECX,[ESP + 0x28]
0055707c : CALL 0x005548f0
00557081 : PUSH EDI
00557082 : LEA ECX,[ESP + 0x4c]
00557086 : CALL 0x005548f0
0055708b : MOV EDX,dword ptr [ESP + 0x3c]
0055708f : CMP EDX,dword ptr [ESP + 0x40]
00557093 : JNC 0x00557362
00557099 : MOV EBX,dword ptr [ESP + 0x2c]
0055709d : MOV BP,word ptr [ESP + 0x5c]
005570a2 : MOV EDI,dword ptr [ESP + 0x50]
005570a6 : JMP 0x005570b0
005570b0 : MOV EAX,dword ptr [ESP + 0x60]
005570b4 : CMP EAX,dword ptr [ESP + 0x64]
005570b8 : JNC 0x00557389
005570be : LEA ECX,[ESP + 0x80]
005570c5 : PUSH ECX
005570c6 : LEA EDX,[ESP + 0x80]
005570cd : PUSH EDX
005570ce : LEA EAX,[ESP + 0x80]
005570d5 : PUSH EAX
005570d6 : LEA ECX,[ESP + 0x30]
005570da : CALL 0x00555ad0
005570df : LEA ECX,[ESP + 0x74]
005570e3 : PUSH ECX
005570e4 : LEA EDX,[ESP + 0x74]
005570e8 : PUSH EDX
005570e9 : LEA EAX,[ESP + 0x74]
005570ed : PUSH EAX
005570ee : LEA ECX,[ESP + 0x54]
005570f2 : CALL 0x00555ad0
005570f7 : MOV EAX,0xc
005570fc : XOR ECX,ECX
005570fe : MOV EDI,EDI
00557100 : MOV EDX,dword ptr [ESP + ECX*0x1 + 0x78]
00557104 : CMP EDX,dword ptr [ESP + ECX*0x1 + 0x6c]
00557108 : JNZ 0x00557389
0055710e : SUB EAX,0x4
00557111 : ADD ECX,0x4
00557114 : CMP EAX,0x4
00557117 : JNC 0x00557100
00557119 : LEA EAX,[ESP + 0x24]
0055711d : PUSH EAX
0055711e : LEA ECX,[ESP + 0xb0]
00557125 : CALL 0x00555980
0055712a : LEA ECX,[ESP + 0x48]
0055712e : PUSH ECX
0055712f : LEA ECX,[ESP + 0x88]
00557136 : CALL 0x00555980
0055713b : FILD dword ptr [ESP + 0xb8]
00557142 : FLD float ptr [ESP + 0xd0]
00557149 : FLD ST0
0055714b : FMULP ST2
0055714d : FXCH
0055714f : FSTP float ptr [ESP + 0x10]
00557153 : FLD float ptr [ESP + 0x10]
00557157 : FILD dword ptr [ESP + 0x90]
0055715e : FLD float ptr [ESP + 0xa8]
00557165 : FLD ST0
00557167 : FMULP ST2
00557169 : FXCH
0055716b : FSTP float ptr [ESP + 0x10]
0055716f : FLD float ptr [ESP + 0x10]
00557173 : FUCOMP ST2
00557175 : FNSTSW AX
00557177 : FSTP ST1
00557179 : TEST AH,0x44
0055717c : JP 0x00557385
00557182 : FILD dword ptr [ESP + 0xbc]
00557189 : FMULP ST2
0055718b : FXCH
0055718d : FSTP float ptr [ESP + 0x10]
00557191 : FLD float ptr [ESP + 0x10]
00557195 : FILD dword ptr [ESP + 0x94]
0055719c : FMULP ST2
0055719e : FXCH
005571a0 : FSTP float ptr [ESP + 0x10]
005571a4 : FLD float ptr [ESP + 0x10]
005571a8 : FUCOMPP
005571aa : FNSTSW AX
005571ac : TEST AH,0x44
005571af : JP 0x00557389
005571b5 : MOV EAX,dword ptr [ESP + 0xb4]
005571bc : CMP EAX,dword ptr [ESP + 0x8c]
005571c3 : JNZ 0x00557389
005571c9 : CMP dword ptr [ESP + 0xb0],EAX
005571d0 : JNC 0x005572ac
005571d6 : JMP 0x005571e0
005571e0 : MOV EDX,dword ptr [ESP + 0x8c]
005571e7 : CMP dword ptr [ESP + 0x88],EDX
005571ee : JNC 0x00557389
005571f4 : LEA EAX,[ESP + 0xe8]
005571fb : PUSH EAX
005571fc : LEA ECX,[ESP + 0xb0]
00557203 : CALL 0x005547c0
00557208 : LEA ECX,[ESP + 0xd4]
0055720f : PUSH ECX
00557210 : LEA ECX,[ESP + 0x88]
00557217 : CALL 0x005547c0
0055721c : MOV EAX,dword ptr [ESP + 0xf8]
00557223 : CMP EAX,dword ptr [ESP + 0xe4]
0055722a : JNZ 0x00557389
00557230 : ADD EAX,EAX
00557232 : ADD EAX,EAX
00557234 : LEA ECX,[ESP + 0xd4]
0055723b : LEA ESI,[ESP + 0xe8]
00557242 : CMP EAX,0x4
00557245 : JC 0x00557268
00557247 : JMP 0x00557250
00557250 : MOV EDX,dword ptr [ESI]
00557252 : CMP EDX,dword ptr [ECX]
00557254 : JNZ 0x00557389
0055725a : SUB EAX,0x4
0055725d : ADD ECX,0x4
00557260 : ADD ESI,0x4
00557263 : CMP EAX,0x4
00557266 : JNC 0x00557250
00557268 : TEST EAX,EAX
0055726a : JZ 0x00557298
0055726c : MOV DL,byte ptr [ECX]
0055726e : CMP DL,byte ptr [ESI]
00557270 : JNZ 0x00557389
00557276 : CMP EAX,0x1
00557279 : JBE 0x00557298
0055727b : MOV DL,byte ptr [ECX + 0x1]
0055727e : CMP DL,byte ptr [ESI + 0x1]
00557281 : JNZ 0x00557389
00557287 : CMP EAX,0x2
0055728a : JBE 0x00557298
0055728c : MOV AL,byte ptr [ECX + 0x2]
0055728f : CMP AL,byte ptr [ESI + 0x2]
00557292 : JNZ 0x00557389
00557298 : MOV ECX,dword ptr [ESP + 0xb0]
0055729f : CMP ECX,dword ptr [ESP + 0xb4]
005572a6 : JC 0x005571e0
005572ac : MOV ECX,dword ptr [ESP + 0xc8]
005572b3 : TEST ECX,ECX
005572b5 : JNZ 0x005572be
005572b7 : MOV ECX,dword ptr [ESP + 0xcc]
005572be : MOVZX ESI,word ptr [ESP + 0x38]
005572c3 : MOV EAX,EBX
005572c5 : SUB EAX,ESI
005572c7 : MOV dword ptr [ESP + 0x28],ECX
005572cb : SUB ECX,EAX
005572cd : MOV EDX,0x1
005572d2 : ADD dword ptr [ESP + 0x3c],EDX
005572d6 : SUB ECX,0x8
005572d9 : CMP ECX,dword ptr [EAX + 0x4]
005572dc : JL 0x005572fc
005572de : MOV EAX,dword ptr [EAX]
005572e0 : TEST EAX,EAX
005572e2 : JZ 0x00557371
005572e8 : LEA ECX,[EAX + 0x8]
005572eb : MOV EBX,ECX
005572ed : MOV dword ptr [ESP + 0x28],ECX
005572f1 : SUB ECX,EAX
005572f3 : MOV dword ptr [ESP + 0x2c],EBX
005572f7 : MOV word ptr [ESP + 0x38],CX
005572fc : MOV EAX,dword ptr [ESP + 0x8c]
00557303 : CMP dword ptr [ESP + 0x88],EAX
0055730a : JC 0x00557354
0055730c : MOV ECX,dword ptr [ESP + 0xa0]
00557313 : TEST ECX,ECX
00557315 : JNZ 0x0055731e
00557317 : MOV ECX,dword ptr [ESP + 0xa4]
0055731e : ADD dword ptr [ESP + 0x60],EDX
00557322 : MOVZX EDX,BP
00557325 : MOV EAX,EDI
00557327 : SUB EAX,EDX
00557329 : MOV dword ptr [ESP + 0x4c],ECX
0055732d : SUB ECX,EAX
0055732f : SUB ECX,0x8
00557332 : CMP ECX,dword ptr [EAX + 0x4]
00557335 : JL 0x00557354
00557337 : MOV EAX,dword ptr [EAX]
00557339 : TEST EAX,EAX
0055733b : JZ 0x0055737b
0055733d : LEA ECX,[EAX + 0x8]
00557340 : MOV EDI,ECX
00557342 : MOV dword ptr [ESP + 0x4c],ECX
00557346 : SUB ECX,EAX
00557348 : MOV BP,CX
0055734b : MOV dword ptr [ESP + 0x50],EDI
0055734f : MOV word ptr [ESP + 0x5c],BP
00557354 : MOV EAX,dword ptr [ESP + 0x3c]
00557358 : CMP EAX,dword ptr [ESP + 0x40]
0055735c : JC 0x005570b0
00557362 : POP EBP
00557363 : POP EBX
00557364 : POP EDI
00557365 : MOV AL,0x1
00557367 : POP ESI
00557368 : ADD ESP,0xec
0055736e : RET 0x4
00557371 : MOV dword ptr [ESP + 0x28],0x0
00557379 : JMP 0x005572fc
0055737b : MOV dword ptr [ESP + 0x4c],0x0
00557383 : JMP 0x00557354
00557385 : FSTP ST1
00557387 : FSTP ST0
00557389 : POP EBP
0055738a : POP EBX
0055738b : POP EDI
0055738c : XOR AL,AL
0055738e : POP ESI
0055738f : ADD ESP,0xec
00557395 : RET 0x4
00557398 : POP EDI
00557399 : XOR AL,AL
0055739b : POP ESI
0055739c : ADD ESP,0xec
005573a2 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_009e285c
ENTRY    : 009e285c
BODY     : [[009e285c, 009e28ea] [009e297b, 009e29a3]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009e285c(void)

{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  int *piVar4;
  int iVar5;
  uint uVar6;
  int unaff_EBX;
  uint unaff_EBP;
  
  do {
    *(int *)(unaff_EBP - 0x60) = unaff_EBX;
    piVar4 = (int *)FUN_00413b60(unaff_EBP - 0x60);
    iVar5 = *piVar4;
    *(int *)(unaff_EBP - 0x80) = iVar5;
    if (iVar5 == *(int *)(*(int *)(unaff_EBP - 0x68) + 0x2c)) {
      *(int *)(unaff_EBP - 0x70) = unaff_EBX;
      *(undefined1 *)(unaff_EBP - 4) = 0xc;
      iVar5 = FUN_006f0300(0x10);
      *(int *)(unaff_EBP - 0x60) = iVar5;
      *(undefined1 *)(unaff_EBP - 4) = 0xd;
      if (iVar5 != unaff_EBX) {
        *(int *)(iVar5 + 4) = unaff_EBX;
        *(int *)(iVar5 + 8) = unaff_EBX;
        *(int *)(iVar5 + 0xc) = unaff_EBX;
        unaff_EBX = iVar5;
      }
      *(undefined1 *)(unaff_EBP - 4) = 0xc;
      *(int *)(unaff_EBP - 0x70) = unaff_EBX;
      *(undefined4 *)(unaff_EBP - 4) = 2;
      FUN_00449610();
      *(undefined2 *)(unaff_EBP - 0x98) = 0;
      *(int *)(unaff_EBP - 0x94) = unaff_EBX;
      FUN_0041ed30(unaff_EBP - 0x10c,unaff_EBP - 0x98);
      FUN_009e29a4();
      return;
    }
    if (*(int *)(iVar5 + 0x10) != unaff_EBX) {
      FUN_00449610();
      FUN_009e29a4();
      return;
    }
    if (*(int *)(unaff_EBP - 0x54) != unaff_EBX) {
      FUN_00414770(*(int *)(unaff_EBP - 0x54));
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    *(undefined4 *)(unaff_EBP - 4) = 0xffffffff;
    if (7 < *(uint *)(unaff_EBP - 0x38)) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    *(undefined4 *)(unaff_EBP - 0x38) = 7;
    *(int *)(unaff_EBP - 0x3c) = unaff_EBX;
    *(undefined2 *)(unaff_EBP - 0x4c) = 0;
    while( true ) {
      do {
        do {
          do {
            if (*(int *)(unaff_EBP - 0x7c) == 0) {
              ExceptionList = *(void **)(unaff_EBP - 0xc);
              __security_check_cookie(*(uint *)(unaff_EBP - 0x18) ^ unaff_EBP);
              return;
            }
          } while (DAT_017247ac == 0);
          *(undefined4 *)(unaff_EBP - 0x54) = 0;
          FUN_00404160(unaff_EBP - 0x7c,unaff_EBP - 0x5c,unaff_EBP - 0x54);
          iVar5 = *(int *)(unaff_EBP - 0x54);
        } while ((iVar5 == 0) || (*(short *)(iVar5 + 4) != 0x6600));
        piVar4 = *(int **)(iVar5 + 0xf0);
        *(int **)(unaff_EBP - 0x60) = piVar4;
      } while (piVar4 == (int *)0x0);
      if ((char)piVar4[0x10] == '\x02') break;
      if (((char)piVar4[0x10] == '\x03') || (iVar5 = (**(code **)(*piVar4 + 0x3c))(), iVar5 != 0)) {
        FUN_0040eef0(piVar4 + 6);
        *(undefined4 *)(unaff_EBP - 4) = 0x10;
        FUN_00824120(DAT_0172491c);
        *(undefined1 *)(unaff_EBP - 4) = 0x12;
        if (7 < *(uint *)(unaff_EBP - 0xdc)) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        *(undefined4 *)(unaff_EBP - 0xdc) = 7;
        *(undefined4 *)(unaff_EBP - 0xe0) = 0;
        *(undefined2 *)(unaff_EBP - 0xf0) = 0;
        *(undefined4 *)(unaff_EBP - 0x58) = 0;
        *(undefined4 *)(unaff_EBP - 0x5c) = 0;
        *(undefined1 *)(unaff_EBP - 4) = 0x13;
        iVar5 = FUN_006f0300(0x28);
        *(int *)(unaff_EBP - 0x6c) = iVar5;
        *(undefined1 *)(unaff_EBP - 4) = 0x14;
        if (iVar5 == 0) {
          iVar5 = 0;
        }
        else {
          iVar5 = FUN_00419170(iVar5,*(undefined2 *)(*(int *)(unaff_EBP - 0x54) + 6),
                               unaff_EBP - 0x34,*(undefined2 *)((int)piVar4 + 6));
        }
        *(undefined1 *)(unaff_EBP - 4) = 0x13;
        *(int *)(unaff_EBP - 0x58) = iVar5;
        iVar2 = FUN_006f0300(0x28);
        *(int *)(unaff_EBP - 0x6c) = iVar2;
        *(undefined1 *)(unaff_EBP - 4) = 0x15;
        if (iVar2 == 0) {
          uVar3 = 0;
        }
        else {
          uVar3 = FUN_00419170(iVar2,*(undefined2 *)(*(int *)(unaff_EBP - 0x54) + 6),
                               unaff_EBP - 0x34,*(undefined2 *)((int)piVar4 + 6));
        }
        *(undefined1 *)(unaff_EBP - 4) = 0x13;
        *(undefined4 *)(unaff_EBP - 0x5c) = uVar3;
        *(undefined4 *)(unaff_EBP - 4) = 0x12;
        *(undefined4 *)(unaff_EBP - 0x54) = 2;
        iVar2 = *(int *)(unaff_EBP - 0x68);
        FUN_00413b60(unaff_EBP - 0x54);
        iVar1 = *(int *)(unaff_EBP - 100);
        if (iVar1 == *(int *)(iVar2 + 0x2c)) {
          *(undefined4 *)(unaff_EBP - 0x78) = 0;
          *(undefined1 *)(unaff_EBP - 4) = 0x18;
          iVar2 = FUN_006f0300(0x10);
          *(int *)(unaff_EBP - 0x6c) = iVar2;
          *(undefined1 *)(unaff_EBP - 4) = 0x19;
          iVar5 = 0;
          if (iVar2 != 0) {
            *(undefined4 *)(iVar2 + 4) = 0;
            *(undefined4 *)(iVar2 + 8) = 0;
            *(undefined4 *)(iVar2 + 0xc) = 0;
            iVar5 = iVar2;
          }
          *(undefined1 *)(unaff_EBP - 4) = 0x18;
          *(int *)(unaff_EBP - 0x78) = iVar5;
          *(undefined4 *)(unaff_EBP - 4) = 0x12;
          FUN_00449610();
          *(undefined2 *)(unaff_EBP - 0x88) = 2;
          *(int *)(unaff_EBP - 0x84) = iVar5;
          FUN_0041ed30(unaff_EBP - 0xfc,unaff_EBP - 0x88);
          FUN_009e2d48();
          return;
        }
        if (*(int *)(iVar1 + 0x10) == 0) {
          if (iVar5 != 0) {
            FUN_00414770(iVar5);
            goto LAB_009e2d43;
          }
        }
        else {
          *(undefined4 *)(unaff_EBP - 0x54) = 0;
          if (*(int *)(*(int *)(iVar1 + 0x10) + 8) - *(int *)(*(int *)(iVar1 + 0x10) + 4) >> 2 == 0)
          {
LAB_009e2d17:
            FUN_00449610();
            FUN_009e2d48();
            return;
          }
          while( true ) {
            iVar2 = *(int *)(unaff_EBP - 0x54);
            iVar5 = *(int *)(unaff_EBP - 0x30);
            if (*(uint *)(unaff_EBP - 0x1c) < 8) {
              iVar5 = unaff_EBP - 0x30;
            }
            iVar5 = FUN_00405bb0(iVar5);
            if ((iVar5 == 0) &&
               (*(uint *)(*(int *)(*(int *)(*(int *)(iVar1 + 0x10) + 4) + iVar2 * 4) + 0x24) ==
                (uint)*(ushort *)(*(int *)(unaff_EBP - 0x60) + 6))) break;
            uVar6 = *(int *)(unaff_EBP - 0x54) + 1;
            *(uint *)(unaff_EBP - 0x54) = uVar6;
            if ((uint)(*(int *)(*(int *)(iVar1 + 0x10) + 8) - *(int *)(*(int *)(iVar1 + 0x10) + 4)
                      >> 2) <= uVar6) goto LAB_009e2d17;
          }
          if (*(int *)(unaff_EBP - 0x58) != 0) {
            FUN_00414770(*(undefined4 *)(unaff_EBP - 0x58));
LAB_009e2d43:
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
        }
        *(undefined4 *)(unaff_EBP - 100) = 0;
        iVar5 = *(int *)(unaff_EBP - 0x68);
        piVar4 = (int *)FUN_00413b60(unaff_EBP - 100);
        iVar2 = *piVar4;
        *(int *)(unaff_EBP - 100) = iVar2;
        if (iVar2 == *(int *)(iVar5 + 0x2c)) {
          iVar2 = FUN_006f0760(0x10,"",0,(DAT_01725270 >> 3 & 1) == 0);
          *(int *)(unaff_EBP - 0x6c) = iVar2;
          *(undefined1 *)(unaff_EBP - 4) = 0x1c;
          iVar5 = 0;
          if (iVar2 != 0) {
            *(undefined4 *)(iVar2 + 4) = 0;
            *(undefined4 *)(iVar2 + 8) = 0;
            *(undefined4 *)(iVar2 + 0xc) = 0;
            iVar5 = iVar2;
          }
          *(undefined1 *)(unaff_EBP - 4) = 0x12;
          FUN_00449610();
          *(undefined2 *)(unaff_EBP - 0x90) = 2;
          *(int *)(unaff_EBP - 0x8c) = iVar5;
          FUN_0041ed30(unaff_EBP - 0x114,unaff_EBP - 0x90);
        }
        else if (*(int *)(iVar2 + 0x10) == 0) {
          iVar5 = *(int *)(unaff_EBP - 0x5c);
          if (iVar5 != 0) {
LAB_009e2e87:
            FUN_00414770(iVar5);
                    /* WARNING: Subroutine does not return */
            FUN_006f04e0();
          }
        }
        else {
          *(undefined4 *)(unaff_EBP - 0x58) = 0;
          if (*(int *)(*(int *)(iVar2 + 0x10) + 8) - *(int *)(*(int *)(iVar2 + 0x10) + 4) >> 2 != 0)
          {
            do {
              iVar1 = *(int *)(unaff_EBP - 0x58);
              iVar5 = *(int *)(unaff_EBP - 0x30);
              if (*(uint *)(unaff_EBP - 0x1c) < 8) {
                iVar5 = unaff_EBP - 0x30;
              }
              iVar5 = FUN_00405bb0(iVar5);
              if ((iVar5 == 0) &&
                 (*(uint *)(*(int *)(*(int *)(*(int *)(iVar2 + 0x10) + 4) + iVar1 * 4) + 0x24) ==
                  (uint)*(ushort *)(*(int *)(unaff_EBP - 0x60) + 6))) {
                if (*(int *)(unaff_EBP - 0x5c) == 0) goto LAB_009e2e94;
                iVar5 = *(int *)(unaff_EBP - 0x5c);
                goto LAB_009e2e87;
              }
              uVar6 = *(int *)(unaff_EBP - 0x58) + 1;
              *(uint *)(unaff_EBP - 0x58) = uVar6;
            } while (uVar6 < (uint)(*(int *)(*(int *)(iVar2 + 0x10) + 8) -
                                    *(int *)(*(int *)(iVar2 + 0x10) + 4) >> 2));
          }
          FUN_00449610();
        }
LAB_009e2e94:
        *(undefined4 *)(unaff_EBP - 4) = 0xffffffff;
        if (7 < *(uint *)(unaff_EBP - 0x1c)) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        *(undefined4 *)(unaff_EBP - 0x1c) = 7;
        *(undefined4 *)(unaff_EBP - 0x20) = 0;
        *(undefined2 *)(unaff_EBP - 0x30) = 0;
      }
    }
    FUN_0040eef0(*(int *)(unaff_EBP - 0x54) + 0x18);
    *(undefined4 *)(unaff_EBP - 4) = 0;
    FUN_00824120(DAT_0172491c);
    *(undefined1 *)(unaff_EBP - 4) = 2;
    if (7 < *(uint *)(unaff_EBP - 0xc0)) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    *(undefined4 *)(unaff_EBP - 0xc0) = 7;
    *(undefined4 *)(unaff_EBP - 0xc4) = 0;
    *(undefined2 *)(unaff_EBP - 0xd4) = 0;
    *(undefined4 *)(unaff_EBP - 0x58) = 0;
    *(undefined4 *)(unaff_EBP - 0x5c) = 0;
    *(undefined1 *)(unaff_EBP - 4) = 3;
    iVar5 = FUN_006f0300(0x28);
    *(int *)(unaff_EBP - 0x60) = iVar5;
    *(undefined1 *)(unaff_EBP - 4) = 4;
    if (iVar5 == 0) {
      iVar5 = 0;
    }
    else {
      iVar5 = FUN_00419170(iVar5,*(undefined2 *)(*(int *)(unaff_EBP - 0x54) + 6),unaff_EBP - 0x50,
                           *(undefined2 *)((int)piVar4 + 6));
    }
    *(undefined1 *)(unaff_EBP - 4) = 3;
    *(int *)(unaff_EBP - 0x58) = iVar5;
    iVar2 = FUN_006f0300(0x28);
    *(int *)(unaff_EBP - 0x60) = iVar2;
    *(undefined1 *)(unaff_EBP - 4) = 5;
    if (iVar2 == 0) {
      *(undefined4 *)(unaff_EBP - 0x54) = 0;
    }
    else {
      uVar3 = FUN_00419170(iVar2,*(undefined2 *)(*(int *)(unaff_EBP - 0x54) + 6),unaff_EBP - 0x50,
                           *(undefined2 *)((int)piVar4 + 6));
      *(undefined4 *)(unaff_EBP - 0x54) = uVar3;
    }
    *(undefined1 *)(unaff_EBP - 4) = 3;
    *(undefined4 *)(unaff_EBP - 0x5c) = *(undefined4 *)(unaff_EBP - 0x54);
    *(undefined4 *)(unaff_EBP - 4) = 2;
    *(undefined4 *)(unaff_EBP - 0x60) = 1;
    iVar2 = *(int *)(unaff_EBP - 0x68);
    FUN_00413b60(unaff_EBP - 0x60);
    unaff_EBX = 0;
    if (*(int *)(unaff_EBP - 0x80) == *(int *)(iVar2 + 0x2c)) {
      *(undefined4 *)(unaff_EBP - 0x74) = 0;
      *(undefined1 *)(unaff_EBP - 4) = 8;
      iVar5 = FUN_006f0300(0x10);
      *(int *)(unaff_EBP - 0x60) = iVar5;
      *(undefined1 *)(unaff_EBP - 4) = 9;
      if (iVar5 != 0) {
        *(undefined4 *)(iVar5 + 4) = 0;
        *(undefined4 *)(iVar5 + 8) = 0;
        *(undefined4 *)(iVar5 + 0xc) = 0;
        unaff_EBX = iVar5;
      }
      *(undefined1 *)(unaff_EBP - 4) = 8;
      *(int *)(unaff_EBP - 0x74) = unaff_EBX;
      *(undefined4 *)(unaff_EBP - 4) = 2;
      FUN_00449610();
      *(undefined2 *)(unaff_EBP - 0xa0) = 1;
      *(int *)(unaff_EBP - 0x9c) = unaff_EBX;
      FUN_0041ed30(unaff_EBP - 0x104,unaff_EBP - 0xa0);
      FUN_009e285c();
      return;
    }
    if (*(int *)(*(int *)(unaff_EBP - 0x80) + 0x10) != 0) {
      FUN_00449610();
      FUN_009e285c();
      return;
    }
    if (iVar5 != 0) {
      FUN_00414770(iVar5);
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
009e285c : MOV dword ptr [EBP + -0x60],EBX
009e285f : LEA EAX,[EBP + -0x60]
009e2862 : PUSH EAX
009e2863 : LEA EAX,[EBP + 0xffffff58]
009e2869 : MOV ECX,ESI
009e286b : CALL 0x00413b60
009e2870 : MOV EAX,dword ptr [EAX]
009e2872 : MOV dword ptr [EBP + -0x80],EAX
009e2875 : MOV ECX,dword ptr [EBP + -0x68]
009e2878 : CMP EAX,dword ptr [ECX + 0x2c]
009e287b : JNZ 0x009e297b
009e2881 : MOV dword ptr [EBP + -0x70],EBX
009e2884 : MOV byte ptr [EBP + -0x4],0xc
009e2888 : PUSH 0x10
009e288a : CALL 0x006f0300
009e288f : ADD ESP,0x4
009e2892 : MOV dword ptr [EBP + -0x60],EAX
009e2895 : MOV byte ptr [EBP + -0x4],0xd
009e2899 : CMP EAX,EBX
009e289b : JZ 0x009e28a8
009e289d : MOV dword ptr [EAX + 0x4],EBX
009e28a0 : MOV dword ptr [EAX + 0x8],EBX
009e28a3 : MOV dword ptr [EAX + 0xc],EBX
009e28a6 : MOV EBX,EAX
009e28a8 : MOV byte ptr [EBP + -0x4],0xc
009e28ac : MOV dword ptr [EBP + -0x70],EBX
009e28af : MOV dword ptr [EBP + -0x4],0x2
009e28b6 : LEA EDI,[EBP + -0x5c]
009e28b9 : MOV EDX,EBX
009e28bb : CALL 0x00449610
009e28c0 : XOR EDX,EDX
009e28c2 : MOV word ptr [EBP + 0xffffff68],DX
009e28c9 : MOV dword ptr [EBP + 0xffffff6c],EBX
009e28cf : LEA EAX,[EBP + 0xffffff68]
009e28d5 : PUSH EAX
009e28d6 : LEA ECX,[EBP + 0xfffffef4]
009e28dc : PUSH ECX
009e28dd : MOV EAX,ESI
009e28df : CALL 0x0041ed30
009e28e4 : XOR EBX,EBX
009e28e6 : JMP 0x009e29a4
009e297b : MOV EAX,dword ptr [EAX + 0x10]
009e297e : CMP EAX,EBX
009e2980 : JZ 0x009e2990
009e2982 : LEA EDI,[EBP + -0x5c]
009e2985 : MOV EDX,EAX
009e2987 : CALL 0x00449610
009e298c : XOR EBX,EBX
009e298e : JMP 0x009e29a4
009e2990 : MOV ESI,dword ptr [EBP + -0x54]
009e2993 : CMP ESI,EBX
009e2995 : JZ 0x009e29a4
009e2997 : PUSH ESI
009e2998 : CALL 0x00414770
009e299d : MOV ECX,ESI
009e299f : CALL 0x006f04e0

PROGRAM  : Maestia.exe
FUNCTION : FUN_00687310
ENTRY    : 00687310
BODY     : [[00687310, 0068736c]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_00687310(short *param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  short *psVar6;
  
  if (param_1 != (short *)0x0) {
    iVar4 = (int)param_1[1];
    iVar5 = (int)*param_1;
    if (iVar4 == 0) {
      if (iVar5 == 0) {
        return 0;
      }
    }
    else if ((0 < iVar4) && (0 < iVar5)) {
      iVar1 = -1;
      iVar2 = 0;
      if (0 < iVar5) {
        psVar6 = *(short **)(param_1 + 6);
        iVar3 = -1;
        do {
          iVar1 = (int)*psVar6;
          if (iVar1 <= iVar3) {
            return 6;
          }
          if (iVar4 <= iVar1) {
            return 6;
          }
          iVar2 = iVar2 + 1;
          psVar6 = psVar6 + 1;
          iVar3 = iVar1;
        } while (iVar2 < iVar5);
      }
      if (iVar1 == iVar4 + -1) {
        return 0;
      }
    }
  }
  return 6;
}



============================================================
DISASSEMBLY
============================================================
00687310 : PUSH EBX
00687311 : PUSH ESI
00687312 : PUSH EDI
00687313 : MOV EDI,dword ptr [ESP + 0x10]
00687317 : TEST EDI,EDI
00687319 : JZ 0x00687364
0068731b : MOVSX EBX,word ptr [EDI + 0x2]
0068731f : MOVSX ESI,word ptr [EDI]
00687322 : TEST EBX,EBX
00687324 : JNZ 0x00687330
00687326 : TEST ESI,ESI
00687328 : JNZ 0x00687364
0068732a : POP EDI
0068732b : POP ESI
0068732c : XOR EAX,EAX
0068732e : POP EBX
0068732f : RET
00687330 : JLE 0x00687364
00687332 : TEST ESI,ESI
00687334 : JLE 0x00687364
00687336 : OR EAX,0xffffffff
00687339 : OR EDX,EAX
0068733b : XOR ECX,ECX
0068733d : TEST ESI,ESI
0068733f : JLE 0x00687359
00687341 : MOV EDI,dword ptr [EDI + 0xc]
00687344 : MOVSX EAX,word ptr [EDI]
00687347 : CMP EAX,EDX
00687349 : JLE 0x00687364
0068734b : CMP EAX,EBX
0068734d : JGE 0x00687364
0068734f : INC ECX
00687350 : ADD EDI,0x2
00687353 : CMP ECX,ESI
00687355 : MOV EDX,EAX
00687357 : JL 0x00687344
00687359 : DEC EBX
0068735a : CMP EAX,EBX
0068735c : JNZ 0x00687364
0068735e : POP EDI
0068735f : POP ESI
00687360 : XOR EAX,EAX
00687362 : POP EBX
00687363 : RET
00687364 : POP EDI
00687365 : POP ESI
00687366 : MOV EAX,0x6
0068736b : POP EBX
0068736c : RET

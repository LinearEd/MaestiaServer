PROGRAM  : Maestia.exe
FUNCTION : FUN_0078d5d0
ENTRY    : 0078d5d0
BODY     : [[0078d5d0, 0078d6ae]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0078d5d0(void)

{
  uint uVar1;
  int iVar2;
  int in_ECX;
  int *piVar3;
  undefined **local_9c [34];
  int *local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b0fe2c;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(int *)(in_ECX + 8) != 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  local_8 = 0;
  local_14 = *(int **)(in_ECX + 0x38);
  piVar3 = (int *)*local_14;
  if (piVar3 != local_14) {
    do {
      if ((int *)piVar3[9] != (int *)0x0) {
        iVar2 = (**(code **)(*(int *)piVar3[9] + 0x1c))(uVar1);
        if (iVar2 == 2) {
          FUN_0043d910(local_9c);
          local_8._0_1_ = 1;
          FUN_0079eab0();
          local_8 = (uint)local_8._1_3_ << 8;
          local_9c[0] = &PTR_FUN_00cd083c;
        }
        else if (iVar2 == 1) {
          FUN_0079eab0();
        }
      }
      piVar3 = (int *)*piVar3;
    } while (piVar3 != local_14);
  }
  local_8 = 0xffffffff;
  if (*(int *)(in_ECX + 8) != 0) {
    LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
0078d5d0 : PUSH EBP
0078d5d1 : MOV EBP,ESP
0078d5d3 : PUSH -0x1
0078d5d5 : PUSH 0xb0fe2c
0078d5da : MOV EAX,FS:[0x0]
0078d5e0 : PUSH EAX
0078d5e1 : SUB ESP,0x8c
0078d5e7 : PUSH ESI
0078d5e8 : PUSH EDI
0078d5e9 : MOV EAX,[0x00d66fa0]
0078d5ee : XOR EAX,EBP
0078d5f0 : PUSH EAX
0078d5f1 : LEA EAX,[EBP + -0xc]
0078d5f4 : MOV FS:[0x0],EAX
0078d5fa : MOV EDI,ECX
0078d5fc : MOV EAX,dword ptr [EDI + 0x8]
0078d5ff : MOV dword ptr [EBP + -0x14],EDI
0078d602 : TEST EAX,EAX
0078d604 : JZ 0x0078d610
0078d606 : ADD EAX,0x4
0078d609 : PUSH EAX
0078d60a : CALL dword ptr [0x00b85118]
0078d610 : MOV dword ptr [EBP + -0x4],0x0
0078d617 : MOV EAX,dword ptr [EDI + 0x38]
0078d61a : MOV ESI,dword ptr [EAX]
0078d61c : MOV dword ptr [EBP + -0x10],EAX
0078d61f : CMP ESI,EAX
0078d621 : JZ 0x0078d686
0078d623 : MOV ECX,dword ptr [ESI + 0x24]
0078d626 : TEST ECX,ECX
0078d628 : JZ 0x0078d67f
0078d62a : MOV EAX,dword ptr [ECX]
0078d62c : MOV EDX,dword ptr [EAX + 0x1c]
0078d62f : CALL EDX
0078d631 : CMP EAX,0x2
0078d634 : JNZ 0x0078d666
0078d636 : MOV ECX,dword ptr [ESI + 0x24]
0078d639 : LEA EAX,[EBP + 0xffffff68]
0078d63f : PUSH EAX
0078d640 : CALL 0x0043d910
0078d645 : MOV ECX,EAX
0078d647 : MOV byte ptr [EBP + -0x4],0x1
0078d64b : LEA EAX,[EDI + 0x1d8]
0078d651 : CALL 0x0079eab0
0078d656 : MOV byte ptr [EBP + -0x4],0x0
0078d65a : MOV dword ptr [EBP + 0xffffff68],0xcd083c
0078d664 : JMP 0x0078d67f
0078d666 : CMP EAX,0x1
0078d669 : JNZ 0x0078d67f
0078d66b : MOV EAX,dword ptr [ESI + 0x24]
0078d66e : LEA ECX,[EAX + 0x1d8]
0078d674 : LEA EAX,[EDI + 0x1d8]
0078d67a : CALL 0x0079eab0
0078d67f : MOV ESI,dword ptr [ESI]
0078d681 : CMP ESI,dword ptr [EBP + -0x10]
0078d684 : JNZ 0x0078d623
0078d686 : MOV dword ptr [EBP + -0x4],0xffffffff
0078d68d : MOV EDI,dword ptr [EDI + 0x8]
0078d690 : TEST EDI,EDI
0078d692 : JZ 0x0078d69e
0078d694 : ADD EDI,0x4
0078d697 : PUSH EDI
0078d698 : CALL dword ptr [0x00b8511c]
0078d69e : MOV ECX,dword ptr [EBP + -0xc]
0078d6a1 : MOV dword ptr FS:[0x0],ECX
0078d6a8 : POP ECX
0078d6a9 : POP EDI
0078d6aa : POP ESI
0078d6ab : MOV ESP,EBP
0078d6ad : POP EBP
0078d6ae : RET

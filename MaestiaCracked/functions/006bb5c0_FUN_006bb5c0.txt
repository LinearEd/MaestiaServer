PROGRAM  : Maestia.exe
FUNCTION : FUN_006bb5c0
ENTRY    : 006bb5c0
BODY     : [[006bb5c0, 006bb698]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006bb5c0(int param_1,int param_2,undefined4 param_3,undefined4 *param_4)

{
  short *psVar1;
  short *_Dst;
  undefined4 uVar2;
  int iVar3;
  int unaff_EBX;
  short *psVar4;
  short *psVar5;
  int iVar6;
  short *psVar7;
  short *psVar8;
  int local_4;
  
  iVar3 = *(int *)(unaff_EBX + 0x10);
  local_4 = 0;
  if (*(int *)(unaff_EBX + 0xc) < iVar3) {
LAB_006bb627:
    psVar1 = *(short **)(unaff_EBX + 0x14);
    psVar4 = psVar1 + *(int *)(unaff_EBX + 0xc) * 0x18;
    _Dst = psVar4;
    while (psVar1 < _Dst) {
      psVar4 = psVar4 + -0x18;
      if ((*psVar4 < param_1) || ((*psVar4 == param_1 && (param_2 == *(int *)(unaff_EBX + 0x18)))))
      break;
      psVar5 = _Dst + -0x18;
      psVar7 = psVar4;
      psVar8 = _Dst;
      for (iVar3 = 0xc; _Dst = psVar5, iVar3 != 0; iVar3 = iVar3 + -1) {
        *(undefined4 *)psVar8 = *(undefined4 *)psVar7;
        psVar7 = psVar7 + 2;
        psVar8 = psVar8 + 2;
      }
    }
    *(int *)(unaff_EBX + 0xc) = *(int *)(unaff_EBX + 0xc) + 1;
    _memset(_Dst,0,0x30);
    *_Dst = (short)param_1;
    *(undefined1 *)((int)_Dst + 0xd) = (undefined1)param_2;
    *param_4 = _Dst;
    return local_4;
  }
  if (iVar3 < 0x2aaaaaa) {
    iVar6 = (iVar3 >> 2) + 4 + iVar3;
    if ((iVar6 < iVar3) || (0x2aaaaaa < iVar6)) {
      iVar6 = 0x2aaaaaa;
    }
    uVar2 = FUN_0068a220(param_3,0x30,iVar3,iVar6,*(undefined4 *)(unaff_EBX + 0x14),&local_4);
    *(undefined4 *)(unaff_EBX + 0x14) = uVar2;
    if (local_4 == 0) {
      *(int *)(unaff_EBX + 0x10) = iVar6;
      goto LAB_006bb627;
    }
  }
  else {
    local_4 = 0x40;
  }
  *param_4 = 0;
  return local_4;
}



============================================================
DISASSEMBLY
============================================================
006bb5c0 : PUSH ECX
006bb5c1 : MOV EAX,dword ptr [EBX + 0x10]
006bb5c4 : PUSH ESI
006bb5c5 : PUSH EDI
006bb5c6 : XOR EDI,EDI
006bb5c8 : CMP dword ptr [EBX + 0xc],EAX
006bb5cb : MOV dword ptr [ESP + 0x8],EDI
006bb5cf : JL 0x006bb627
006bb5d1 : CMP EAX,0x2aaaaaa
006bb5d6 : JL 0x006bb5e5
006bb5d8 : LEA EAX,[EDI + 0x40]
006bb5db : MOV ECX,dword ptr [ESP + 0x1c]
006bb5df : MOV dword ptr [ECX],EDI
006bb5e1 : POP EDI
006bb5e2 : POP ESI
006bb5e3 : POP ECX
006bb5e4 : RET
006bb5e5 : MOV EDX,EAX
006bb5e7 : SAR EDX,0x2
006bb5ea : LEA ESI,[EDX + EAX*0x1 + 0x4]
006bb5ee : CMP ESI,EAX
006bb5f0 : JL 0x006bb5fa
006bb5f2 : CMP ESI,0x2aaaaaa
006bb5f8 : JLE 0x006bb5ff
006bb5fa : MOV ESI,0x2aaaaaa
006bb5ff : MOV EDX,dword ptr [EBX + 0x14]
006bb602 : LEA ECX,[ESP + 0x8]
006bb606 : PUSH ECX
006bb607 : PUSH EDX
006bb608 : PUSH ESI
006bb609 : PUSH EAX
006bb60a : MOV EAX,dword ptr [ESP + 0x28]
006bb60e : PUSH 0x30
006bb610 : PUSH EAX
006bb611 : CALL 0x0068a220
006bb616 : MOV dword ptr [EBX + 0x14],EAX
006bb619 : MOV EAX,dword ptr [ESP + 0x20]
006bb61d : ADD ESP,0x18
006bb620 : CMP EAX,EDI
006bb622 : JNZ 0x006bb5db
006bb624 : MOV dword ptr [EBX + 0x10],ESI
006bb627 : MOV EDX,dword ptr [EBX + 0x14]
006bb62a : PUSH EBP
006bb62b : MOV EBP,dword ptr [EBX + 0xc]
006bb62e : LEA EBP,[EBP + EBP*0x2]
006bb632 : SHL EBP,0x4
006bb635 : ADD EBP,EDX
006bb637 : CMP EBP,EDX
006bb639 : JBE 0x006bb66b
006bb63b : LEA EAX,[EBP + -0x30]
006bb63e : MOV EDI,EDI
006bb640 : MOVSX ECX,word ptr [EAX]
006bb643 : MOV ESI,dword ptr [ESP + 0x14]
006bb647 : CMP ECX,ESI
006bb649 : JL 0x006bb66f
006bb64b : JNZ 0x006bb656
006bb64d : MOV ECX,dword ptr [ESP + 0x18]
006bb651 : CMP ECX,dword ptr [EBX + 0x18]
006bb654 : JZ 0x006bb66f
006bb656 : MOV EDI,EBP
006bb658 : MOV ESI,EAX
006bb65a : SUB EBP,0x30
006bb65d : MOV ECX,0xc
006bb662 : SUB EAX,0x30
006bb665 : MOVSD.REP ES:EDI,ESI
006bb667 : CMP EBP,EDX
006bb669 : JA 0x006bb640
006bb66b : MOV ESI,dword ptr [ESP + 0x14]
006bb66f : INC dword ptr [EBX + 0xc]
006bb672 : PUSH 0x30
006bb674 : PUSH 0x0
006bb676 : PUSH EBP
006bb677 : CALL 0x0063b700
006bb67c : MOV DL,byte ptr [ESP + 0x24]
006bb680 : MOV EAX,dword ptr [ESP + 0x2c]
006bb684 : MOV word ptr [EBP],SI
006bb688 : ADD ESP,0xc
006bb68b : MOV byte ptr [EBP + 0xd],DL
006bb68e : MOV dword ptr [EAX],EBP
006bb690 : MOV EAX,dword ptr [ESP + 0xc]
006bb694 : POP EBP
006bb695 : POP EDI
006bb696 : POP ESI
006bb697 : POP ECX
006bb698 : RET

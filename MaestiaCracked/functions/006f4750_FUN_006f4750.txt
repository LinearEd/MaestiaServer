PROGRAM  : Maestia.exe
FUNCTION : FUN_006f4750
ENTRY    : 006f4750
BODY     : [[006f4750, 006f48cd]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_006f4750(void)

{
  int iVar1;
  uint *puVar2;
  uint *puVar3;
  uint uVar4;
  uint uVar5;
  BOOL BVar6;
  DWORD DVar7;
  undefined4 uVar8;
  LPOVERLAPPED local_10;
  int *local_c;
  DWORD local_8;
  
  local_8 = 0;
  local_10 = (LPOVERLAPPED)0x0;
  local_c = (int *)0x0;
  uVar5 = InterlockedIncrement((LONG *)&DAT_01725268);
  uVar5 = uVar5 & 0x8000000f;
  if ((int)uVar5 < 0) {
    uVar5 = (uVar5 - 1 | 0xfffffff0) + 1;
  }
  if (DAT_00d6a620 == (HANDLE)0xffffffff) {
    FUN_006ee470(L"ERR - [AvIoBase::AvIOCPWorkerThread] s_hIOCP == INVALID_HANDLE_VALUE\n");
    return 0xffffffff;
  }
  iVar1 = uVar5 * 8;
  puVar2 = (uint *)(&DAT_00d8bcc0 + iVar1);
  *puVar2 = 0;
  *(undefined4 *)(&DAT_00d8bcc4 + iVar1) = 0;
  do {
    while( true ) {
      BVar6 = GetQueuedCompletionStatus
                        (DAT_00d6a620,&local_8,(PULONG_PTR)&local_c,&local_10,0xffffffff);
      uVar4 = *puVar2;
      *puVar2 = *puVar2 + 1;
      *(uint *)(&DAT_00d8bcc4 + iVar1) =
           *(int *)(&DAT_00d8bcc4 + iVar1) + (uint)(0xfffffffe < uVar4);
      if (local_c == (int *)0x0) break;
      if (local_10 == (LPOVERLAPPED)0x0) {
        DVar7 = GetLastError();
        FUN_006ee470(L"[ERROR] - AvIoBase::IOCPWorkerThread() pOverlapped = NULL return (%d) (Error:%u)\n"
                     ,BVar6,DVar7);
      }
      else if (local_10[1].InternalHigh == 0x76091519) {
        if (local_c[1] == -0x67cdeec9) {
          if (local_10[1].Internal == 0x760917) {
            puVar3 = &DAT_00d8bdc0 + uVar5 * 2;
            uVar4 = *puVar3;
            *puVar3 = *puVar3 + local_8;
            (&DAT_00d8bdc4)[uVar5 * 2] = (&DAT_00d8bdc4)[uVar5 * 2] + (uint)CARRY4(uVar4,local_8);
            (**(code **)(*local_c + 4))(local_8,local_10);
          }
          else {
            if (local_10[1].Internal == 0x760916) {
              puVar3 = &DAT_00d8bd40 + uVar5 * 2;
              uVar4 = *puVar3;
              *puVar3 = *puVar3 + local_8;
              (&DAT_00d8bd44)[uVar5 * 2] = (&DAT_00d8bd44)[uVar5 * 2] + (uint)CARRY4(uVar4,local_8);
            }
            (**(code **)(*local_c + 4))(local_8,local_10);
          }
        }
      }
      else if (DAT_00d72ee4 != 0) {
        uVar8 = FUN_006ee420(".\\AvIoBase.cpp",600);
        FUN_006ee470(L"[ERROR] %s %d\n",uVar8);
        DAT_00d72ee4 = 0;
      }
    }
  } while (local_8 == 0x790625);
  FUN_006ee470(L"LOG - [AvIoBase::AvIOCPWorkerThread] Exit Thread (%I64d)\n",*puVar2,
               *(undefined4 *)(&DAT_00d8bcc4 + iVar1));
  return 0;
}



============================================================
DISASSEMBLY
============================================================
006f4750 : PUSH EBP
006f4751 : MOV EBP,ESP
006f4753 : SUB ESP,0x10
006f4756 : PUSH EDI
006f4757 : XOR EDI,EDI
006f4759 : PUSH 0x1725268
006f475e : MOV dword ptr [EBP + -0x4],EDI
006f4761 : MOV dword ptr [EBP + -0xc],EDI
006f4764 : MOV dword ptr [EBP + -0x8],EDI
006f4767 : CALL dword ptr [0x00b850dc]
006f476d : AND EAX,0x8000000f
006f4772 : JNS 0x006f4779
006f4774 : DEC EAX
006f4775 : OR EAX,0xfffffff0
006f4778 : INC EAX
006f4779 : CMP dword ptr [0x00d6a620],-0x1
006f4780 : MOV dword ptr [EBP + -0x10],EAX
006f4783 : JNZ 0x006f479c
006f4785 : PUSH 0xbf7850
006f478a : CALL 0x006ee470
006f478f : ADD ESP,0x4
006f4792 : OR EAX,0xffffffff
006f4795 : POP EDI
006f4796 : MOV ESP,EBP
006f4798 : POP EBP
006f4799 : RET 0x4
006f479c : PUSH EBX
006f479d : PUSH ESI
006f479e : LEA ESI,[EAX*0x8 + 0xd8bcc0]
006f47a5 : MOV dword ptr [ESI],EDI
006f47a7 : MOV dword ptr [ESI + 0x4],EDI
006f47aa : LEA EBX,[EBX]
006f47b0 : PUSH -0x1
006f47b2 : LEA EAX,[EBP + -0xc]
006f47b5 : PUSH EAX
006f47b6 : MOV EAX,[0x00d6a620]
006f47bb : LEA ECX,[EBP + -0x8]
006f47be : PUSH ECX
006f47bf : LEA EDX,[EBP + -0x4]
006f47c2 : PUSH EDX
006f47c3 : PUSH EAX
006f47c4 : CALL dword ptr [0x00b8537c]
006f47ca : ADD dword ptr [ESI],0x1
006f47cd : MOV ECX,dword ptr [EBP + -0x8]
006f47d0 : MOV EDI,EAX
006f47d2 : ADC dword ptr [ESI + 0x4],0x0
006f47d6 : TEST ECX,ECX
006f47d8 : JNZ 0x006f4802
006f47da : CMP dword ptr [EBP + -0x4],0x790625
006f47e1 : JZ 0x006f47b0
006f47e3 : MOV ECX,dword ptr [ESI + 0x4]
006f47e6 : MOV EDX,dword ptr [ESI]
006f47e8 : PUSH ECX
006f47e9 : PUSH EDX
006f47ea : PUSH 0xbf79c0
006f47ef : CALL 0x006ee470
006f47f4 : ADD ESP,0xc
006f47f7 : POP ESI
006f47f8 : POP EBX
006f47f9 : XOR EAX,EAX
006f47fb : POP EDI
006f47fc : MOV ESP,EBP
006f47fe : POP EBP
006f47ff : RET 0x4
006f4802 : MOV EBX,dword ptr [EBP + -0xc]
006f4805 : TEST EBX,EBX
006f4807 : JNZ 0x006f4820
006f4809 : CALL dword ptr [0x00b85128]
006f480f : PUSH EAX
006f4810 : PUSH EDI
006f4811 : PUSH 0xbf78e8
006f4816 : CALL 0x006ee470
006f481b : ADD ESP,0xc
006f481e : JMP 0x006f47b0
006f4820 : CMP dword ptr [EBX + 0x18],0x76091519
006f4827 : JZ 0x006f4865
006f4829 : CMP dword ptr [0x00d72ee4],0x0
006f4830 : JZ 0x006f47b0
006f4836 : PUSH 0x258
006f483b : PUSH 0xbf798c
006f4840 : CALL 0x006ee420
006f4845 : ADD ESP,0x4
006f4848 : PUSH EAX
006f4849 : PUSH 0xbf799c
006f484e : CALL 0x006ee470
006f4853 : ADD ESP,0xc
006f4856 : MOV dword ptr [0x00d72ee4],0x0
006f4860 : JMP 0x006f47b0
006f4865 : CMP dword ptr [ECX + 0x4],0x98321137
006f486c : JNZ 0x006f47b0
006f4872 : MOV EDX,dword ptr [EBX + 0x14]
006f4875 : MOV EAX,dword ptr [EBP + -0x4]
006f4878 : CMP EDX,0x760917
006f487e : JNZ 0x006f48a3
006f4880 : MOV EDX,dword ptr [EBP + -0x10]
006f4883 : ADD dword ptr [EDX*0x8 + 0xd8bdc0],EAX
006f488a : LEA EDX,[EDX*0x8 + 0xd8bdc0]
006f4891 : PUSH EBX
006f4892 : ADC dword ptr [EDX + 0x4],0x0
006f4896 : MOV EDX,dword ptr [ECX]
006f4898 : PUSH EAX
006f4899 : MOV EAX,dword ptr [EDX + 0x4]
006f489c : CALL EAX
006f489e : JMP 0x006f47b0
006f48a3 : CMP EDX,0x760916
006f48a9 : JNZ 0x006f48c0
006f48ab : MOV EDX,dword ptr [EBP + -0x10]
006f48ae : ADD dword ptr [EDX*0x8 + 0xd8bd40],EAX
006f48b5 : LEA EDX,[EDX*0x8 + 0xd8bd40]
006f48bc : ADC dword ptr [EDX + 0x4],0x0
006f48c0 : MOV EDX,dword ptr [ECX]
006f48c2 : PUSH EBX
006f48c3 : PUSH EAX
006f48c4 : MOV EAX,dword ptr [EDX + 0x4]
006f48c7 : CALL EAX
006f48c9 : JMP 0x006f47b0

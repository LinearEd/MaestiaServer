PROGRAM  : Maestia.exe
FUNCTION : FUN_0067e830
ENTRY    : 0067e830
BODY     : [[0067e830, 0067ebb2]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0067e830(int param_1,int param_2,int param_3)

{
  short sVar1;
  int iVar2;
  uint *puVar3;
  short *psVar4;
  undefined4 uVar5;
  GRefCountImpl *pGVar6;
  undefined4 uVar7;
  int iVar8;
  int in_ECX;
  short *psVar9;
  undefined1 auStack_48 [4];
  undefined1 auStack_44 [4];
  undefined4 uStack_40;
  undefined4 uStack_3c;
  undefined4 uStack_38;
  undefined4 uStack_34;
  undefined4 local_30;
  uint local_2c;
  undefined4 local_28;
  undefined4 uStack_20;
  undefined4 uStack_1c;
  undefined4 uStack_18;
  undefined4 uStack_14;
  undefined4 uStack_10;
  undefined4 uStack_c;
  
  local_30 = 0;
  local_2c = 0;
  if (((param_1 == 0x282) && (param_2 == 0xe)) && (param_3 == 0x12)) {
    if (*(short *)(in_ECX + 0x7c) == 8) {
      if ((*(int *)(in_ECX + 0x5c) == 4) || (*(int *)(in_ECX + 0x5c) == 0x40000)) {
        iVar2 = FUN_0051b1a0();
        if (iVar2 != 0) {
          puVar3 = (uint *)FUN_0051c6e0(&param_1,".RemoveInputWindow");
          FUN_00678eb0(*(undefined4 *)(in_ECX + 4),(*puVar3 & 0xfffffffc) + 8,0);
          FUN_0045b730();
        }
        iVar2 = FUN_0051b1a0();
        if (iVar2 == 0) {
          FUN_0045ac80();
          return;
        }
        psVar4 = *(short **)(in_ECX + 0x20);
        psVar9 = psVar4 + 1;
        do {
          sVar1 = *psVar4;
          psVar4 = psVar4 + 1;
        } while (sVar1 != 0);
        *(undefined2 *)(*(int *)(in_ECX + 0x20) + -2 + ((int)psVar4 - (int)psVar9 >> 1) * 2) = 0;
        iVar2 = FUN_0051aeb0(*(undefined4 *)(in_ECX + 0x20),0xffffffff);
        uVar5 = FUN_0045b5a0(iVar2 + 1);
        FUN_0051af70(uVar5,*(undefined4 *)(in_ECX + 0x20),0xffffffff);
        pGVar6 = (GRefCountImpl *)(**(code **)(*(int *)(*(int *)(in_ECX + 4) + 8) + 0xc))(0x1b);
        uStack_20 = 0;
        uStack_1c = 0;
        uStack_18 = 0;
        uStack_14 = 0;
        uStack_40 = 0;
        uStack_3c = 0;
        uStack_38 = 0;
        uStack_34 = 0;
        FUN_00597610(&uStack_20,&uStack_40,-*(int *)(in_ECX + 0x34));
        iVar2 = FUN_0051b1a0();
        if (iVar2 != 0) {
          puVar3 = (uint *)FUN_0051c6e0(&param_2,".DisplayInputWindow");
          uVar7 = FUN_0063b380(0);
          uVar7 = FUN_0063b380(uVar7);
          FUN_00678eb0(*(undefined4 *)(in_ECX + 4),(*puVar3 & 0xfffffffc) + 8,"%s %d %d %d",uVar5,
                       uVar7);
          FUN_0045b730();
        }
        FUN_00515cf0(uVar5);
        if (pGVar6 != (GRefCountImpl *)0x0) {
          GRefCountImpl::Release(pGVar6);
        }
      }
      if (*(int *)(in_ECX + 0x5c) == 2) {
        iVar2 = FUN_0051b1a0();
        if (iVar2 != 0) {
          puVar3 = (uint *)FUN_0051c6e0(&param_3,".RemoveInputWindow");
          FUN_00678eb0(*(undefined4 *)(in_ECX + 4),(*puVar3 & 0xfffffffc) + 8,0);
          FUN_0045b730();
        }
        iVar2 = 3;
        psVar9 = (short *)(*(int *)(in_ECX + 0x68) + 6);
        do {
          if (*psVar9 != 0x20) {
            if (-1 < iVar2) {
              *(undefined2 *)(*(int *)(in_ECX + 0x68) + iVar2 * 2) = 0x20;
            }
            break;
          }
          iVar2 = iVar2 + -1;
          psVar9 = psVar9 + -1;
        } while (-1 < iVar2);
        uStack_10 = 0;
        uStack_c = 0;
        iVar2 = FUN_0051aeb0(*(undefined4 *)(in_ECX + 0x68),0xffffffff);
        iVar2 = FUN_0045b5a0(iVar2 + 1);
        FUN_0051af70(iVar2,*(undefined4 *)(in_ECX + 0x68),0xffffffff);
        pGVar6 = (GRefCountImpl *)(**(code **)(*(int *)(*(int *)(in_ECX + 4) + 8) + 0xc))(0x1b);
        uStack_20 = 0;
        uStack_1c = 0;
        uStack_18 = 0;
        uStack_14 = 0;
        uStack_40 = 0;
        uStack_3c = 0;
        uStack_38 = 0;
        uStack_34 = 0;
        FUN_00597610(&uStack_20,&uStack_40,-*(int *)(in_ECX + 0x34));
        iVar8 = FUN_0051b1a0();
        if (iVar8 != 0) {
          puVar3 = (uint *)FUN_0051c6e0(auStack_48,".DisplayInputWindow");
          uVar5 = FUN_0063b380(0);
          uVar5 = FUN_0063b380(uVar5);
          FUN_00678eb0(*(undefined4 *)(in_ECX + 4),(*puVar3 & 0xfffffffc) + 8,"%s %d %d %d",iVar2,
                       uVar5);
          FUN_0045b730();
        }
        if (iVar2 != 0) {
          FUN_00515cf0(iVar2);
        }
        if (pGVar6 != (GRefCountImpl *)0x0) {
          GRefCountImpl::Release(pGVar6);
        }
        FUN_0045ac80();
      }
    }
    if ((*(short *)(in_ECX + 0x7c) == 0x20) && (*(int *)(in_ECX + 0x5c) == 4)) {
      iVar2 = FUN_0051b1a0();
      if (iVar2 != 0) {
        puVar3 = (uint *)FUN_0051c6e0(auStack_44,".RemoveInputWindow");
        FUN_00678eb0(*(undefined4 *)(in_ECX + 4),(*puVar3 & 0xfffffffc) + 8,0);
        FUN_0045b730();
      }
      **(undefined2 **)(in_ECX + 0x20) = 0;
    }
  }
  if ((local_2c >> 6 & 1) != 0) {
    FUN_00588b40(&local_30,local_28);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
0067e830 : SUB ESP,0x48
0067e833 : PUSH EBX
0067e834 : PUSH EBP
0067e835 : PUSH ESI
0067e836 : PUSH EDI
0067e837 : XOR EDI,EDI
0067e839 : CMP dword ptr [ESP + 0x5c],0x282
0067e841 : MOV ESI,ECX
0067e843 : MOV dword ptr [ESP + 0x28],EDI
0067e847 : MOV dword ptr [ESP + 0x2c],EDI
0067e84b : JNZ 0x0067eb8a
0067e851 : CMP dword ptr [ESP + 0x60],0xe
0067e856 : JNZ 0x0067eb8a
0067e85c : CMP dword ptr [ESP + 0x64],0x12
0067e861 : JNZ 0x0067eb8a
0067e867 : CMP word ptr [ESI + 0x7c],0x8
0067e86c : JNZ 0x0067eb36
0067e872 : MOV EAX,dword ptr [ESI + 0x5c]
0067e875 : CMP EAX,0x4
0067e878 : JZ 0x0067e885
0067e87a : CMP EAX,0x40000
0067e87f : JNZ 0x0067e9d4
0067e885 : LEA EBX,[ESI + 0x8]
0067e888 : MOV ECX,EBX
0067e88a : CALL 0x0051b1a0
0067e88f : TEST EAX,EAX
0067e891 : JBE 0x0067e8c3
0067e893 : PUSH 0xbd7f88
0067e898 : LEA EAX,[ESP + 0x60]
0067e89c : PUSH EAX
0067e89d : MOV ECX,EBX
0067e89f : CALL 0x0051c6e0
0067e8a4 : MOV ECX,dword ptr [EAX]
0067e8a6 : MOV EDX,dword ptr [ESI + 0x4]
0067e8a9 : AND ECX,0xfffffffc
0067e8ac : PUSH EDI
0067e8ad : ADD ECX,0x8
0067e8b0 : PUSH ECX
0067e8b1 : PUSH EDX
0067e8b2 : CALL 0x00678eb0
0067e8b7 : ADD ESP,0xc
0067e8ba : LEA ECX,[ESP + 0x5c]
0067e8be : CALL 0x0045b730
0067e8c3 : MOV ECX,EBX
0067e8c5 : CALL 0x0051b1a0
0067e8ca : TEST EAX,EAX
0067e8cc : JA 0x0067e8e1
0067e8ce : LEA ECX,[ESP + 0x28]
0067e8d2 : CALL 0x0045ac80
0067e8d7 : POP EDI
0067e8d8 : POP ESI
0067e8d9 : POP EBP
0067e8da : POP EBX
0067e8db : ADD ESP,0x48
0067e8de : RET 0xc
0067e8e1 : MOV EAX,dword ptr [ESI + 0x20]
0067e8e4 : LEA EDX,[EAX + 0x2]
0067e8e7 : MOV CX,word ptr [EAX]
0067e8ea : ADD EAX,0x2
0067e8ed : CMP CX,DI
0067e8f0 : JNZ 0x0067e8e7
0067e8f2 : MOV ECX,dword ptr [ESI + 0x20]
0067e8f5 : SUB EAX,EDX
0067e8f7 : SAR EAX,0x1
0067e8f9 : XOR EDX,EDX
0067e8fb : MOV word ptr [ECX + EAX*0x2 + -0x2],DX
0067e900 : MOV EAX,dword ptr [ESI + 0x20]
0067e903 : PUSH -0x1
0067e905 : PUSH EAX
0067e906 : CALL 0x0051aeb0
0067e90b : INC EAX
0067e90c : PUSH EAX
0067e90d : CALL 0x0045b5a0
0067e912 : MOV EDI,EAX
0067e914 : MOV EAX,dword ptr [ESI + 0x20]
0067e917 : PUSH -0x1
0067e919 : PUSH EAX
0067e91a : PUSH EDI
0067e91b : CALL 0x0051af70
0067e920 : MOV ECX,dword ptr [ESI + 0x4]
0067e923 : MOV EDX,dword ptr [ECX + 0x8]
0067e926 : MOV EAX,dword ptr [EDX + 0xc]
0067e929 : ADD ECX,0x8
0067e92c : PUSH 0x1b
0067e92e : CALL EAX
0067e930 : FLDZ
0067e932 : MOV ECX,dword ptr [ESI + 0x34]
0067e935 : FST float ptr [ESP + 0x38]
0067e939 : NEG ECX
0067e93b : FST float ptr [ESP + 0x3c]
0067e93f : PUSH ECX
0067e940 : FST float ptr [ESP + 0x44]
0067e944 : FST float ptr [ESP + 0x48]
0067e948 : MOV EBP,EAX
0067e94a : LEA EDX,[ESP + 0x1c]
0067e94e : FST float ptr [ESP + 0x1c]
0067e952 : FST float ptr [ESP + 0x20]
0067e956 : PUSH EDX
0067e957 : LEA EAX,[ESP + 0x40]
0067e95b : FST float ptr [ESP + 0x28]
0067e95f : PUSH EAX
0067e960 : FSTP float ptr [ESP + 0x30]
0067e964 : MOV ECX,EBP
0067e966 : CALL 0x00597610
0067e96b : MOV ECX,EBX
0067e96d : CALL 0x0051b1a0
0067e972 : TEST EAX,EAX
0067e974 : JBE 0x0067e9c3
0067e976 : PUSH 0xbd7fb8
0067e97b : LEA ECX,[ESP + 0x64]
0067e97f : PUSH ECX
0067e980 : MOV ECX,EBX
0067e982 : CALL 0x0051c6e0
0067e987 : FLD float ptr [ESP + 0x24]
0067e98b : PUSH 0x0
0067e98d : MOV EBX,EAX
0067e98f : CALL 0x0063b380
0067e994 : FLD float ptr [ESP + 0x1c]
0067e998 : PUSH EAX
0067e999 : CALL 0x0063b380
0067e99e : MOV EDX,dword ptr [EBX]
0067e9a0 : PUSH EAX
0067e9a1 : MOV EAX,dword ptr [ESI + 0x4]
0067e9a4 : PUSH EDI
0067e9a5 : AND EDX,0xfffffffc
0067e9a8 : PUSH 0xbd7fac
0067e9ad : ADD EDX,0x8
0067e9b0 : PUSH EDX
0067e9b1 : PUSH EAX
0067e9b2 : CALL 0x00678eb0
0067e9b7 : ADD ESP,0x1c
0067e9ba : LEA ECX,[ESP + 0x60]
0067e9be : CALL 0x0045b730
0067e9c3 : PUSH EDI
0067e9c4 : CALL 0x00515cf0
0067e9c9 : TEST EBP,EBP
0067e9cb : JZ 0x0067e9d4
0067e9cd : MOV ECX,EBP
0067e9cf : CALL 0x004ff7e0
0067e9d4 : CMP dword ptr [ESI + 0x5c],0x2
0067e9d8 : JNZ 0x0067eb36
0067e9de : LEA EBX,[ESI + 0x8]
0067e9e1 : MOV ECX,EBX
0067e9e3 : CALL 0x0051b1a0
0067e9e8 : TEST EAX,EAX
0067e9ea : JBE 0x0067ea1d
0067e9ec : PUSH 0xbd7f88
0067e9f1 : LEA ECX,[ESP + 0x68]
0067e9f5 : PUSH ECX
0067e9f6 : MOV ECX,EBX
0067e9f8 : CALL 0x0051c6e0
0067e9fd : MOV EDX,dword ptr [EAX]
0067e9ff : MOV EAX,dword ptr [ESI + 0x4]
0067ea02 : AND EDX,0xfffffffc
0067ea05 : PUSH 0x0
0067ea07 : ADD EDX,0x8
0067ea0a : PUSH EDX
0067ea0b : PUSH EAX
0067ea0c : CALL 0x00678eb0
0067ea11 : ADD ESP,0xc
0067ea14 : LEA ECX,[ESP + 0x64]
0067ea18 : CALL 0x0045b730
0067ea1d : MOV EDX,dword ptr [ESI + 0x68]
0067ea20 : MOV EAX,0x3
0067ea25 : LEA ECX,[EDX + 0x6]
0067ea28 : XOR EDI,EDI
0067ea2a : LEA EBX,[EBX]
0067ea30 : CMP word ptr [ECX],0x20
0067ea34 : JNZ 0x0067ea40
0067ea36 : DEC EAX
0067ea37 : SUB ECX,0x2
0067ea3a : CMP EAX,EDI
0067ea3c : JGE 0x0067ea30
0067ea3e : JMP 0x0067ea4d
0067ea40 : CMP EAX,EDI
0067ea42 : JL 0x0067ea4d
0067ea44 : MOV ECX,0x20
0067ea49 : MOV word ptr [EDX + EAX*0x2],CX
0067ea4d : MOV EAX,dword ptr [ESI + 0x68]
0067ea50 : PUSH -0x1
0067ea52 : PUSH EAX
0067ea53 : MOV dword ptr [ESP + 0x50],EDI
0067ea57 : MOV dword ptr [ESP + 0x54],EDI
0067ea5b : CALL 0x0051aeb0
0067ea60 : INC EAX
0067ea61 : PUSH EAX
0067ea62 : CALL 0x0045b5a0
0067ea67 : MOV EDX,dword ptr [ESI + 0x68]
0067ea6a : PUSH -0x1
0067ea6c : MOV EDI,EAX
0067ea6e : PUSH EDX
0067ea6f : PUSH EDI
0067ea70 : CALL 0x0051af70
0067ea75 : MOV ECX,dword ptr [ESI + 0x4]
0067ea78 : MOV EAX,dword ptr [ECX + 0x8]
0067ea7b : MOV EDX,dword ptr [EAX + 0xc]
0067ea7e : ADD ECX,0x8
0067ea81 : PUSH 0x1b
0067ea83 : CALL EDX
0067ea85 : FLDZ
0067ea87 : MOV EBP,EAX
0067ea89 : FST float ptr [ESP + 0x38]
0067ea8d : MOV EAX,dword ptr [ESI + 0x34]
0067ea90 : FST float ptr [ESP + 0x3c]
0067ea94 : NEG EAX
0067ea96 : FST float ptr [ESP + 0x40]
0067ea9a : PUSH EAX
0067ea9b : FST float ptr [ESP + 0x48]
0067ea9f : LEA ECX,[ESP + 0x1c]
0067eaa3 : FST float ptr [ESP + 0x1c]
0067eaa7 : PUSH ECX
0067eaa8 : FST float ptr [ESP + 0x24]
0067eaac : LEA EDX,[ESP + 0x40]
0067eab0 : FST float ptr [ESP + 0x28]
0067eab4 : PUSH EDX
0067eab5 : FSTP float ptr [ESP + 0x30]
0067eab9 : MOV ECX,EBP
0067eabb : CALL 0x00597610
0067eac0 : MOV ECX,EBX
0067eac2 : CALL 0x0051b1a0
0067eac7 : TEST EAX,EAX
0067eac9 : JBE 0x0067eb18
0067eacb : PUSH 0xbd7fb8
0067ead0 : LEA EAX,[ESP + 0x14]
0067ead4 : PUSH EAX
0067ead5 : MOV ECX,EBX
0067ead7 : CALL 0x0051c6e0
0067eadc : FLD float ptr [ESP + 0x24]
0067eae0 : PUSH 0x0
0067eae2 : MOV EBX,EAX
0067eae4 : CALL 0x0063b380
0067eae9 : FLD float ptr [ESP + 0x1c]
0067eaed : PUSH EAX
0067eaee : CALL 0x0063b380
0067eaf3 : MOV ECX,dword ptr [EBX]
0067eaf5 : MOV EDX,dword ptr [ESI + 0x4]
0067eaf8 : PUSH EAX
0067eaf9 : PUSH EDI
0067eafa : AND ECX,0xfffffffc
0067eafd : PUSH 0xbd7fac
0067eb02 : ADD ECX,0x8
0067eb05 : PUSH ECX
0067eb06 : PUSH EDX
0067eb07 : CALL 0x00678eb0
0067eb0c : ADD ESP,0x1c
0067eb0f : LEA ECX,[ESP + 0x10]
0067eb13 : CALL 0x0045b730
0067eb18 : TEST EDI,EDI
0067eb1a : JZ 0x0067eb22
0067eb1c : PUSH EDI
0067eb1d : CALL 0x00515cf0
0067eb22 : TEST EBP,EBP
0067eb24 : JZ 0x0067eb2d
0067eb26 : MOV ECX,EBP
0067eb28 : CALL 0x004ff7e0
0067eb2d : LEA ECX,[ESP + 0x48]
0067eb31 : CALL 0x0045ac80
0067eb36 : CMP word ptr [ESI + 0x7c],0x20
0067eb3b : JNZ 0x0067eb8a
0067eb3d : CMP dword ptr [ESI + 0x5c],0x4
0067eb41 : JNZ 0x0067eb8a
0067eb43 : LEA EDI,[ESI + 0x8]
0067eb46 : MOV ECX,EDI
0067eb48 : CALL 0x0051b1a0
0067eb4d : TEST EAX,EAX
0067eb4f : JBE 0x0067eb82
0067eb51 : PUSH 0xbd7f88
0067eb56 : LEA EAX,[ESP + 0x18]
0067eb5a : PUSH EAX
0067eb5b : MOV ECX,EDI
0067eb5d : CALL 0x0051c6e0
0067eb62 : MOV ECX,dword ptr [EAX]
0067eb64 : MOV EDX,dword ptr [ESI + 0x4]
0067eb67 : AND ECX,0xfffffffc
0067eb6a : PUSH 0x0
0067eb6c : ADD ECX,0x8
0067eb6f : PUSH ECX
0067eb70 : PUSH EDX
0067eb71 : CALL 0x00678eb0
0067eb76 : ADD ESP,0xc
0067eb79 : LEA ECX,[ESP + 0x14]
0067eb7d : CALL 0x0045b730
0067eb82 : MOV EAX,dword ptr [ESI + 0x20]
0067eb85 : XOR ECX,ECX
0067eb87 : MOV word ptr [EAX],CX
0067eb8a : MOV EDX,dword ptr [ESP + 0x2c]
0067eb8e : SHR EDX,0x6
0067eb91 : TEST DL,0x1
0067eb94 : JZ 0x0067eba9
0067eb96 : MOV EAX,dword ptr [ESP + 0x30]
0067eb9a : PUSH EAX
0067eb9b : LEA ECX,[ESP + 0x2c]
0067eb9f : PUSH ECX
0067eba0 : MOV ECX,dword ptr [ESP + 0x30]
0067eba4 : CALL 0x00588b40
0067eba9 : POP EDI
0067ebaa : POP ESI
0067ebab : POP EBP
0067ebac : POP EBX
0067ebad : ADD ESP,0x48
0067ebb0 : RET 0xc

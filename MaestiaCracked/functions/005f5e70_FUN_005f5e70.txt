PROGRAM  : Maestia.exe
FUNCTION : FUN_005f5e70
ENTRY    : 005f5e70
BODY     : [[005f5e70, 005f5efc]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_005f5e70(uint param_1)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  int *in_ECX;
  uint uVar4;
  int iVar5;
  uint uVar6;
  int local_4;
  
  iVar2 = *in_ECX;
  iVar5 = 0;
  uVar6 = 0xffffffff;
  if (iVar2 != 0) {
    local_4 = 0;
    uVar3 = param_1;
    while( true ) {
      uVar4 = param_1 - *(uint *)(iVar2 + 0x10);
      if (((*(uint *)(iVar2 + 0x10) <= param_1) && (uVar4 < uVar6)) &&
         (iVar5 = iVar2, uVar6 = uVar4, uVar4 == 0)) {
        return iVar2;
      }
      iVar1 = *(int *)(iVar2 + 4);
      iVar2 = *(int *)(iVar2 + 4 + ((int)uVar3 >> 0x1f) * -4);
      if ((iVar1 != 0) && (iVar1 != iVar2)) {
        local_4 = iVar1;
      }
      if (iVar2 == 0) break;
      uVar3 = uVar3 * 2;
    }
    for (; local_4 != 0; local_4 = *(int *)(local_4 + 4 + (uint)(*(int *)(local_4 + 8) != 0) * 4)) {
      uVar3 = param_1 - *(uint *)(local_4 + 0x10);
      if ((*(uint *)(local_4 + 0x10) <= param_1) && (uVar3 < uVar6)) {
        iVar5 = local_4;
        uVar6 = uVar3;
      }
    }
  }
  return iVar5;
}



============================================================
DISASSEMBLY
============================================================
005f5e70 : PUSH ECX
005f5e71 : MOV EAX,dword ptr [ECX]
005f5e73 : PUSH EBX
005f5e74 : PUSH EBP
005f5e75 : PUSH ESI
005f5e76 : PUSH EDI
005f5e77 : XOR EBP,EBP
005f5e79 : OR EDI,0xffffffff
005f5e7c : CMP EAX,EBP
005f5e7e : JZ 0x005f5ef3
005f5e80 : MOV ESI,dword ptr [ESP + 0x18]
005f5e84 : MOV dword ptr [ESP + 0x10],EBP
005f5e88 : MOV EBX,ESI
005f5e8a : LEA EBX,[EBX]
005f5e90 : MOV EDX,dword ptr [EAX + 0x10]
005f5e93 : MOV ECX,ESI
005f5e95 : SUB ECX,EDX
005f5e97 : CMP EDX,ESI
005f5e99 : JA 0x005f5ea7
005f5e9b : CMP ECX,EDI
005f5e9d : JNC 0x005f5ea7
005f5e9f : MOV EBP,EAX
005f5ea1 : MOV EDI,ECX
005f5ea3 : TEST ECX,ECX
005f5ea5 : JZ 0x005f5ef5
005f5ea7 : MOV ECX,dword ptr [EAX + 0x4]
005f5eaa : MOV EDX,EBX
005f5eac : SHR EDX,0x1f
005f5eaf : MOV EAX,dword ptr [EAX + EDX*0x4 + 0x4]
005f5eb3 : TEST ECX,ECX
005f5eb5 : JZ 0x005f5ebf
005f5eb7 : CMP ECX,EAX
005f5eb9 : JZ 0x005f5ebf
005f5ebb : MOV dword ptr [ESP + 0x10],ECX
005f5ebf : TEST EAX,EAX
005f5ec1 : JZ 0x005f5ec7
005f5ec3 : ADD EBX,EBX
005f5ec5 : JMP 0x005f5e90
005f5ec7 : MOV ECX,dword ptr [ESP + 0x10]
005f5ecb : TEST ECX,ECX
005f5ecd : JZ 0x005f5ef3
005f5ecf : NOP
005f5ed0 : MOV EDX,dword ptr [ECX + 0x10]
005f5ed3 : MOV EAX,ESI
005f5ed5 : SUB EAX,EDX
005f5ed7 : CMP EDX,ESI
005f5ed9 : JA 0x005f5ee3
005f5edb : CMP EAX,EDI
005f5edd : JNC 0x005f5ee3
005f5edf : MOV EDI,EAX
005f5ee1 : MOV EBP,ECX
005f5ee3 : XOR EAX,EAX
005f5ee5 : CMP dword ptr [ECX + 0x8],EAX
005f5ee8 : SETNZ AL
005f5eeb : MOV ECX,dword ptr [ECX + EAX*0x4 + 0x4]
005f5eef : TEST ECX,ECX
005f5ef1 : JNZ 0x005f5ed0
005f5ef3 : MOV EAX,EBP
005f5ef5 : POP EDI
005f5ef6 : POP ESI
005f5ef7 : POP EBP
005f5ef8 : POP EBX
005f5ef9 : POP ECX
005f5efa : RET 0x4

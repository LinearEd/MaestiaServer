PROGRAM  : Maestia.exe
FUNCTION : FUN_00855af0
ENTRY    : 00855af0
BODY     : [[00855af0, 00855e5b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00855af0(int param_1)

{
  int iVar1;
  int *piVar2;
  DWORD DVar3;
  float *pfVar4;
  int *in_ECX;
  int extraout_ECX;
  float fVar5;
  undefined1 auStack_98 [4];
  int local_94;
  int local_90;
  int local_8c;
  undefined4 local_88;
  int local_84;
  undefined4 local_80;
  float local_7c;
  float local_78;
  float local_74;
  float local_70;
  undefined4 local_6c;
  undefined4 local_68;
  undefined4 local_64;
  undefined4 local_60;
  undefined4 local_5c;
  int local_58;
  undefined4 local_54;
  int local_50;
  undefined4 local_4c;
  undefined4 local_48 [17];
  
  iVar1 = in_ECX[0x121];
  local_7c = 0.0;
  local_78 = 0.0;
  local_74 = 0.0;
  local_94 = 0;
  local_90 = 0;
  local_60 = 0;
  local_5c = 0;
  DVar3 = timeGetTime();
  in_ECX[0x121] = DVar3;
  local_70 = (float)(int)(DVar3 - iVar1);
  if ((int)(DVar3 - iVar1) < 0) {
    local_70 = local_70 + 4.2949673e+09;
  }
  local_70 = local_70 * (float)in_ECX[0x125];
  fVar5 = local_70;
  if (4.0 < local_70) {
    fVar5 = 4.0;
  }
  if (in_ECX == *(int **)(DAT_00da93ec + 0xac)) {
    if ((*(char *)(DAT_00da93ec + 0x21a) == '\0') || (*(int *)(DAT_017248cc + 0x20) == 0)) {
      FUN_007f1540(-(fVar5 * 0.017453292));
      piVar2 = *(int **)(extraout_ECX + 0x94);
      pfVar4 = (float *)(**(code **)(*piVar2 + 0x14))();
      local_7c = (float)piVar2[0x5c] - *pfVar4;
      local_78 = (float)piVar2[0x5d] - pfVar4[1];
      local_74 = (float)piVar2[0x5e] - pfVar4[2];
      D3DXVec3Normalize(&local_7c,&local_7c);
      in_ECX[0xee] = (int)local_7c;
      local_94 = in_ECX[0xee];
      in_ECX[0xef] = (int)local_74;
      local_90 = in_ECX[0xef];
    }
    else {
      local_58 = in_ECX[0xee];
      local_50 = in_ECX[0xef];
      local_48[0] = 0;
      local_8c = 0;
      local_88 = 0;
      local_84 = 0;
      local_80 = 0;
      local_54 = 0x3f800000;
      local_4c = 0x3f800000;
      local_6c = 0;
      local_68 = 0x3f800000;
      local_64 = 0;
      D3DXMatrixRotationAxis(local_48,&local_6c,-(fVar5 * 0.017453292));
      D3DXVec4Transform(auStack_98,&local_64,&local_54);
      local_94 = local_8c;
      local_90 = local_84;
      in_ECX[0xee] = local_8c;
      in_ECX[0xef] = local_84;
    }
  }
  else {
    FUN_00889560();
  }
  if (*(char *)((int)in_ECX + 0x1ea3) == '\0') {
    local_48[0] = 0;
    local_8c = 0;
    local_88 = 0;
    local_84 = 0;
    local_80 = 0;
    local_6c = 0;
    local_64 = 0;
    fVar5 = (float)param_1 * 0.017453292;
    local_58 = local_94;
    local_54 = 0x3f800000;
    local_50 = local_90;
    local_4c = 0x3f800000;
    local_68 = 0x3f800000;
    D3DXMatrixRotationAxis(local_48,&local_6c,fVar5);
    D3DXVec4Transform(auStack_98,&local_64,&local_54);
    local_78 = fVar5;
    FUN_007cc680();
    if ((((*(char *)((int)in_ECX + 0x1ea3) == '\0') && ((char)in_ECX[0x7a8] == '\0')) &&
        (*(char *)((int)in_ECX + 0x1ea1) == '\0')) && (*(char *)((int)in_ECX + 0x1ea2) == '\0')) {
      (**(code **)(*in_ECX + 0x188))(0xb,1,0,0,0,0x3f800000);
      (**(code **)(*in_ECX + 0x254))(1,in_ECX + 1,0);
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00855af0 : PUSH EBP
00855af1 : MOV EBP,ESP
00855af3 : AND ESP,0xfffffff8
00855af6 : SUB ESP,0x90
00855afc : XORPS XMM0,XMM0
00855aff : PUSH ESI
00855b00 : PUSH EDI
00855b01 : MOV EDI,ECX
00855b03 : MOV ESI,dword ptr [EDI + 0x484]
00855b09 : MOVSS dword ptr [ESP + 0x24],XMM0
00855b0f : MOVSS dword ptr [ESP + 0x28],XMM0
00855b15 : MOVSS dword ptr [ESP + 0x2c],XMM0
00855b1b : MOVSS dword ptr [ESP + 0xc],XMM0
00855b21 : MOVSS dword ptr [ESP + 0x10],XMM0
00855b27 : MOVSS dword ptr [ESP + 0x40],XMM0
00855b2d : MOVSS dword ptr [ESP + 0x44],XMM0
00855b33 : CALL dword ptr [0x00b85598]
00855b39 : MOV dword ptr [EDI + 0x484],EAX
00855b3f : SUB EAX,ESI
00855b41 : MOV dword ptr [ESP + 0x30],EAX
00855b45 : FILD dword ptr [ESP + 0x30]
00855b49 : TEST EAX,EAX
00855b4b : JGE 0x00855b53
00855b4d : FADD float ptr [0x00cdf0e0]
00855b53 : FMUL float ptr [EDI + 0x494]
00855b59 : FST float ptr [ESP + 0x30]
00855b5d : FLD float ptr [0x00cdf21c]
00855b63 : FXCH
00855b65 : FCOMIP ST0,ST1
00855b67 : FSTP ST0
00855b69 : JBE 0x00855b75
00855b6b : MOVSS XMM0,dword ptr [0x00cdf21c]
00855b73 : JMP 0x00855b7b
00855b75 : MOVSS XMM0,dword ptr [ESP + 0x30]
00855b7b : MOV EAX,[0x00da93ec]
00855b80 : MOVSS XMM2,dword ptr [0x00c10fc4]
00855b88 : MOVSS XMM3,dword ptr [0x00cdf170]
00855b90 : CMP EDI,dword ptr [EAX + 0xac]
00855b96 : JNZ 0x00855d20
00855b9c : CMP byte ptr [EAX + 0x21a],0x0
00855ba3 : JZ 0x00855c78
00855ba9 : MOV EAX,[0x017248cc]
00855bae : CMP dword ptr [EAX + 0x20],0x0
00855bb2 : JZ 0x00855c78
00855bb8 : XORPS XMM1,XMM1
00855bbb : MOVSS XMM4,dword ptr [EDI + 0x3b8]
00855bc3 : PUSH ECX
00855bc4 : MULSS XMM0,XMM3
00855bc8 : XORPS XMM0,xmmword ptr [0x00cdf0c0]
00855bcf : MOVSS dword ptr [ESP],XMM0
00855bd4 : LEA ECX,[ESP + 0x38]
00855bd8 : PUSH ECX
00855bd9 : LEA EDX,[ESP + 0x60]
00855bdd : MOVSS dword ptr [ESP + 0x50],XMM4
00855be3 : MOVSS XMM4,dword ptr [EDI + 0x3bc]
00855beb : PUSH EDX
00855bec : MOVSS dword ptr [ESP + 0x64],XMM1
00855bf2 : MOVSS dword ptr [ESP + 0x20],XMM1
00855bf8 : MOVSS dword ptr [ESP + 0x24],XMM1
00855bfe : MOVSS dword ptr [ESP + 0x28],XMM1
00855c04 : MOVSS dword ptr [ESP + 0x2c],XMM1
00855c0a : MOVSS dword ptr [ESP + 0x58],XMM2
00855c10 : MOVSS dword ptr [ESP + 0x5c],XMM4
00855c16 : MOVSS dword ptr [ESP + 0x60],XMM2
00855c1c : MOVSS dword ptr [ESP + 0x40],XMM1
00855c22 : MOVSS dword ptr [ESP + 0x44],XMM2
00855c28 : MOVSS dword ptr [ESP + 0x48],XMM1
00855c2e : CALL 0x004ff746
00855c33 : LEA EAX,[ESP + 0x58]
00855c37 : PUSH EAX
00855c38 : LEA ECX,[ESP + 0x4c]
00855c3c : PUSH ECX
00855c3d : LEA EDX,[ESP + 0x1c]
00855c41 : PUSH EDX
00855c42 : CALL 0x004ff74c
00855c47 : MOVSS XMM0,dword ptr [ESP + 0x14]
00855c4d : MOVSS dword ptr [ESP + 0xc],XMM0
00855c53 : MOVSS XMM0,dword ptr [ESP + 0x1c]
00855c59 : MOV EAX,dword ptr [ESP + 0xc]
00855c5d : MOVSS dword ptr [ESP + 0x10],XMM0
00855c63 : MOV ECX,dword ptr [ESP + 0x10]
00855c67 : MOV dword ptr [EDI + 0x3b8],EAX
00855c6d : MOV dword ptr [EDI + 0x3bc],ECX
00855c73 : JMP 0x00855d2b
00855c78 : MOV ECX,dword ptr [0x0172491c]
00855c7e : MOV EAX,dword ptr [ECX + 0x94]
00855c84 : MULSS XMM0,XMM3
00855c88 : XORPS XMM0,xmmword ptr [0x00cdf0c0]
00855c8f : PUSH ECX
00855c90 : MOVSS dword ptr [ESP],XMM0
00855c95 : CALL 0x007f1540
00855c9a : MOV ESI,dword ptr [ECX + 0x94]
00855ca0 : MOV EDX,dword ptr [ESI]
00855ca2 : MOV EAX,dword ptr [EDX + 0x14]
00855ca5 : MOV ECX,ESI
00855ca7 : CALL EAX
00855ca9 : MOVSS XMM0,dword ptr [ESI + 0x170]
00855cb1 : MOVSS XMM1,dword ptr [ESI + 0x174]
00855cb9 : MOVSS XMM2,dword ptr [ESI + 0x178]
00855cc1 : SUBSS XMM0,dword ptr [EAX]
00855cc5 : SUBSS XMM1,dword ptr [EAX + 0x4]
00855cca : SUBSS XMM2,dword ptr [EAX + 0x8]
00855ccf : LEA ECX,[ESP + 0x24]
00855cd3 : PUSH ECX
00855cd4 : MOV EDX,ECX
00855cd6 : PUSH EDX
00855cd7 : MOVSS dword ptr [ESP + 0x2c],XMM0
00855cdd : MOVSS dword ptr [ESP + 0x30],XMM1
00855ce3 : MOVSS dword ptr [ESP + 0x34],XMM2
00855ce9 : CALL 0x004ff722
00855cee : MOVSS XMM0,dword ptr [ESP + 0x24]
00855cf4 : MOVSS dword ptr [EDI + 0x3b8],XMM0
00855cfc : MOVSS XMM0,dword ptr [ESP + 0x2c]
00855d02 : MOV EAX,dword ptr [EDI + 0x3b8]
00855d08 : MOVSS dword ptr [EDI + 0x3bc],XMM0
00855d10 : MOV ECX,dword ptr [EDI + 0x3bc]
00855d16 : MOV dword ptr [ESP + 0xc],EAX
00855d1a : MOV dword ptr [ESP + 0x10],ECX
00855d1e : JMP 0x00855d2b
00855d20 : LEA ESI,[ESP + 0xc]
00855d24 : MOV EAX,EDI
00855d26 : CALL 0x00889560
00855d2b : CMP byte ptr [EDI + 0x1ea3],0x0
00855d32 : JNZ 0x00855e54
00855d38 : XORPS XMM0,XMM0
00855d3b : MOVSS XMM1,dword ptr [ESP + 0xc]
00855d41 : MOVSS XMM2,dword ptr [ESP + 0x10]
00855d47 : MOVSS dword ptr [ESP + 0x58],XMM0
00855d4d : MOVSS dword ptr [ESP + 0x14],XMM0
00855d53 : MOVSS dword ptr [ESP + 0x18],XMM0
00855d59 : MOVSS dword ptr [ESP + 0x1c],XMM0
00855d5f : MOVSS dword ptr [ESP + 0x20],XMM0
00855d65 : MOVSS dword ptr [ESP + 0x34],XMM0
00855d6b : MOVSS dword ptr [ESP + 0x3c],XMM0
00855d71 : CVTSI2SS XMM0,dword ptr [EBP + 0x8]
00855d76 : MULSS XMM0,dword ptr [0x00cdf170]
00855d7e : PUSH ECX
00855d7f : MOVSS dword ptr [ESP],XMM0
00855d84 : LEA EDX,[ESP + 0x38]
00855d88 : PUSH EDX
00855d89 : LEA EAX,[ESP + 0x60]
00855d8d : MOVSS dword ptr [ESP + 0x50],XMM1
00855d93 : MOVSS XMM1,dword ptr [0x00c10fc4]
00855d9b : PUSH EAX
00855d9c : MOVSS dword ptr [ESP + 0x58],XMM1
00855da2 : MOVSS dword ptr [ESP + 0x5c],XMM2
00855da8 : MOVSS dword ptr [ESP + 0x60],XMM1
00855dae : MOVSS dword ptr [ESP + 0x44],XMM1
00855db4 : CALL 0x004ff746
00855db9 : LEA ECX,[ESP + 0x58]
00855dbd : PUSH ECX
00855dbe : LEA EDX,[ESP + 0x4c]
00855dc2 : PUSH EDX
00855dc3 : LEA EAX,[ESP + 0x1c]
00855dc7 : PUSH EAX
00855dc8 : CALL 0x004ff74c
00855dcd : MOVSS XMM0,dword ptr [ESP + 0x14]
00855dd3 : MOVSS XMM1,dword ptr [ESP + 0x1c]
00855dd9 : MOV ESI,dword ptr [EDI + 0x3e8]
00855ddf : LEA EAX,[ESP + 0x40]
00855de3 : MOVSS dword ptr [ESP + 0x40],XMM0
00855de9 : MOVSS dword ptr [ESP + 0x44],XMM1
00855def : MOVSS dword ptr [ESP + 0xc],XMM0
00855df5 : MOVSS dword ptr [ESP + 0x10],XMM1
00855dfb : CALL 0x007cc680
00855e00 : CMP byte ptr [EDI + 0x1ea3],0x0
00855e07 : JNZ 0x00855e54
00855e09 : CMP byte ptr [EDI + 0x1ea0],0x0
00855e10 : JNZ 0x00855e54
00855e12 : CMP byte ptr [EDI + 0x1ea1],0x0
00855e19 : JNZ 0x00855e54
00855e1b : CMP byte ptr [EDI + 0x1ea2],0x0
00855e22 : JNZ 0x00855e54
00855e24 : FLD1
00855e26 : MOV EDX,dword ptr [EDI]
00855e28 : MOV EAX,dword ptr [EDX + 0x188]
00855e2e : PUSH ECX
00855e2f : FSTP float ptr [ESP]
00855e32 : PUSH 0x0
00855e34 : PUSH 0x0
00855e36 : PUSH 0x0
00855e38 : PUSH 0x1
00855e3a : PUSH 0xb
00855e3c : MOV ECX,EDI
00855e3e : CALL EAX
00855e40 : MOV EDX,dword ptr [EDI]
00855e42 : MOV EDX,dword ptr [EDX + 0x254]
00855e48 : PUSH 0x0
00855e4a : LEA EAX,[EDI + 0x4]
00855e4d : PUSH EAX
00855e4e : PUSH 0x1
00855e50 : MOV ECX,EDI
00855e52 : CALL EDX
00855e54 : POP EDI
00855e55 : POP ESI
00855e56 : MOV ESP,EBP
00855e58 : POP EBP
00855e59 : RET 0x4

PROGRAM  : Maestia.exe
FUNCTION : FUN_00550380
ENTRY    : 00550380
BODY     : [[00550380, 0055054b]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00550380(uint param_1)

{
  undefined1 *puVar1;
  uint uVar2;
  char *pcVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  int *piVar6;
  int local_38;
  int local_34;
  int local_30;
  byte local_2c;
  int local_28;
  int iStack_24;
  byte local_20;
  int local_1c;
  int local_18;
  byte local_14;
  undefined1 local_10 [16];
  
  uVar2 = param_1;
  if (*(int *)(param_1 + 0x1c) < 2) {
    puVar1 = *(undefined1 **)(param_1 + 4);
    FUN_00526400();
    *puVar1 = 2;
    puVar1[4] = 0;
  }
  else {
    uVar4 = *(undefined4 *)(param_1 + 0x18);
    FUN_00526260(0);
    FUN_005272e0(&local_38,uVar4,0xffffffff,0);
    uVar4 = *(undefined4 *)(uVar2 + 0x18);
    piVar6 = &local_28;
    FUN_00526260(1);
    FUN_00527140(piVar6,uVar4);
    if (local_28 == 0) {
      puVar1 = *(undefined1 **)(uVar2 + 4);
      FUN_00526400();
      *puVar1 = 2;
      puVar1[4] = 0;
    }
    else {
      local_2c = 0;
      local_34 = 0;
      local_30 = 0;
      if (2 < *(int *)(uVar2 + 0x1c)) {
        pcVar3 = (char *)FUN_00526260(2);
        if ((*pcVar3 == '\b') || (*pcVar3 == '\v')) {
          uVar4 = *(undefined4 *)(uVar2 + 0x18);
          piVar6 = &local_1c;
          FUN_00526260(2);
          uVar4 = FUN_00527140(piVar6,uVar4);
          FUN_00568a50(uVar4);
          if (((local_14 & 2) == 0) && (local_1c != 0)) {
            FUN_00503db0();
          }
          local_1c = 0;
          if (((local_14 & 1) == 0) && (local_18 != 0)) {
            FUN_00503db0();
          }
        }
      }
      uVar4 = *(undefined4 *)(*(int *)(*(int *)(uVar2 + 0x18) + 0x78) + 0x288);
      uVar5 = FUN_005296b0();
      FUN_00526b70(&local_28,&local_34,uVar4,uVar5);
      param_1 = param_1 & 0xffffff00;
      (**(code **)(**(int **)(uVar2 + 8) + 0x28))
                (*(int *)(uVar2 + 0x18) + 0x78,&local_38,local_10,&param_1);
      puVar1 = *(undefined1 **)(uVar2 + 4);
      FUN_00526400();
      *puVar1 = 2;
      puVar1[4] = 1;
      FUN_00526bc0();
      if (((local_2c & 2) == 0) && (local_34 != 0)) {
        FUN_00503db0();
      }
      local_34 = 0;
      if (((local_2c & 1) == 0) && (local_30 != 0)) {
        FUN_00503db0();
      }
    }
    if (((local_20 & 2) == 0) && (local_28 != 0)) {
      FUN_00503db0();
    }
    local_28 = 0;
    if (((local_20 & 1) == 0) && (iStack_24 != 0)) {
      FUN_00503db0();
    }
    iStack_24 = 0;
    *(int *)(local_38 + 8) = *(int *)(local_38 + 8) + -1;
    if (*(int *)(local_38 + 8) == 0) {
      FUN_00525340();
      return;
    }
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
00550380 : SUB ESP,0x38
00550383 : PUSH ESI
00550384 : MOV ESI,dword ptr [ESP + 0x40]
00550388 : CMP dword ptr [ESI + 0x1c],0x2
0055038c : JL 0x00550536
00550392 : PUSH EBX
00550393 : PUSH EDI
00550394 : MOV EDI,dword ptr [ESI + 0x18]
00550397 : XOR EBX,EBX
00550399 : PUSH EBX
0055039a : MOV ECX,ESI
0055039c : CALL 0x00526260
005503a1 : PUSH EBX
005503a2 : PUSH -0x1
005503a4 : PUSH EDI
005503a5 : LEA ECX,[ESP + 0x18]
005503a9 : PUSH ECX
005503aa : MOV ECX,EAX
005503ac : CALL 0x005272e0
005503b1 : MOV EDX,dword ptr [ESI + 0x18]
005503b4 : PUSH EDX
005503b5 : LEA EAX,[ESP + 0x20]
005503b9 : PUSH EAX
005503ba : PUSH 0x1
005503bc : MOV ECX,ESI
005503be : CALL 0x00526260
005503c3 : MOV ECX,EAX
005503c5 : CALL 0x00527140
005503ca : CMP dword ptr [ESP + 0x1c],EBX
005503ce : JZ 0x005504da
005503d4 : CMP dword ptr [ESI + 0x1c],0x3
005503d8 : MOV byte ptr [ESP + 0x18],BL
005503dc : MOV dword ptr [ESP + 0x10],EBX
005503e0 : MOV dword ptr [ESP + 0x14],EBX
005503e4 : JL 0x00550448
005503e6 : PUSH 0x2
005503e8 : MOV ECX,ESI
005503ea : CALL 0x00526260
005503ef : MOV AL,byte ptr [EAX]
005503f1 : CMP AL,0x8
005503f3 : JZ 0x005503f9
005503f5 : CMP AL,0xb
005503f7 : JNZ 0x00550448
005503f9 : MOV ECX,dword ptr [ESI + 0x18]
005503fc : PUSH ECX
005503fd : LEA EDX,[ESP + 0x2c]
00550401 : PUSH EDX
00550402 : PUSH 0x2
00550404 : MOV ECX,ESI
00550406 : CALL 0x00526260
0055040b : MOV ECX,EAX
0055040d : CALL 0x00527140
00550412 : PUSH EAX
00550413 : LEA ECX,[ESP + 0x14]
00550417 : CALL 0x00568a50
0055041c : TEST byte ptr [ESP + 0x30],0x2
00550421 : JNZ 0x00550430
00550423 : MOV ECX,dword ptr [ESP + 0x28]
00550427 : CMP ECX,EBX
00550429 : JZ 0x00550430
0055042b : CALL 0x00503db0
00550430 : TEST byte ptr [ESP + 0x30],0x1
00550435 : MOV dword ptr [ESP + 0x28],EBX
00550439 : JNZ 0x00550448
0055043b : MOV ECX,dword ptr [ESP + 0x2c]
0055043f : CMP ECX,EBX
00550441 : JZ 0x00550448
00550443 : CALL 0x00503db0
00550448 : MOV ECX,dword ptr [ESI + 0x18]
0055044b : MOV EAX,dword ptr [ECX + 0x78]
0055044e : MOV EDI,dword ptr [EAX + 0x288]
00550454 : CALL 0x005296b0
00550459 : PUSH EAX
0055045a : PUSH EDI
0055045b : LEA ECX,[ESP + 0x18]
0055045f : PUSH ECX
00550460 : LEA EDX,[ESP + 0x28]
00550464 : PUSH EDX
00550465 : LEA ECX,[ESP + 0x44]
00550469 : CALL 0x00526b70
0055046e : MOV ECX,dword ptr [ESI + 0x8]
00550471 : LEA EDX,[ESP + 0x48]
00550475 : PUSH EDX
00550476 : LEA EDX,[ESP + 0x38]
0055047a : PUSH EDX
0055047b : LEA EDX,[ESP + 0x14]
0055047f : PUSH EDX
00550480 : MOV EDX,dword ptr [ESI + 0x18]
00550483 : MOV byte ptr [ESP + 0x54],BL
00550487 : MOV EAX,dword ptr [ECX]
00550489 : MOV EAX,dword ptr [EAX + 0x28]
0055048c : ADD EDX,0x78
0055048f : PUSH EDX
00550490 : CALL EAX
00550492 : MOV ESI,dword ptr [ESI + 0x4]
00550495 : MOV ECX,ESI
00550497 : CALL 0x00526400
0055049c : LEA ECX,[ESP + 0x34]
005504a0 : MOV byte ptr [ESI],0x2
005504a3 : MOV byte ptr [ESI + 0x4],0x1
005504a7 : CALL 0x00526bc0
005504ac : TEST byte ptr [ESP + 0x18],0x2
005504b1 : JNZ 0x005504c0
005504b3 : MOV ECX,dword ptr [ESP + 0x10]
005504b7 : CMP ECX,EBX
005504b9 : JZ 0x005504c0
005504bb : CALL 0x00503db0
005504c0 : TEST byte ptr [ESP + 0x18],0x1
005504c5 : MOV dword ptr [ESP + 0x10],EBX
005504c9 : JNZ 0x005504ea
005504cb : MOV ECX,dword ptr [ESP + 0x14]
005504cf : CMP ECX,EBX
005504d1 : JZ 0x005504ea
005504d3 : CALL 0x00503db0
005504d8 : JMP 0x005504ea
005504da : MOV ESI,dword ptr [ESI + 0x4]
005504dd : MOV ECX,ESI
005504df : CALL 0x00526400
005504e4 : MOV byte ptr [ESI],0x2
005504e7 : MOV byte ptr [ESI + 0x4],BL
005504ea : TEST byte ptr [ESP + 0x24],0x2
005504ef : JNZ 0x005504fe
005504f1 : MOV ECX,dword ptr [ESP + 0x1c]
005504f5 : CMP ECX,EBX
005504f7 : JZ 0x005504fe
005504f9 : CALL 0x00503db0
005504fe : TEST byte ptr [ESP + 0x24],0x1
00550503 : MOV dword ptr [ESP + 0x1c],EBX
00550507 : JNZ 0x00550516
00550509 : MOV ECX,dword ptr [ESP + 0x20]
0055050d : CMP ECX,EBX
0055050f : JZ 0x00550516
00550511 : CALL 0x00503db0
00550516 : MOV EAX,dword ptr [ESP + 0xc]
0055051a : MOV dword ptr [ESP + 0x20],EBX
0055051e : DEC dword ptr [EAX + 0x8]
00550521 : MOV ECX,EAX
00550523 : ADD EAX,0x8
00550526 : CMP dword ptr [EAX],EBX
00550528 : POP EDI
00550529 : POP EBX
0055052a : JNZ 0x00550547
0055052c : CALL 0x00525340
00550531 : POP ESI
00550532 : ADD ESP,0x38
00550535 : RET
00550536 : MOV ESI,dword ptr [ESI + 0x4]
00550539 : MOV ECX,ESI
0055053b : CALL 0x00526400
00550540 : MOV byte ptr [ESI],0x2
00550543 : MOV byte ptr [ESI + 0x4],0x0
00550547 : POP ESI
00550548 : ADD ESP,0x38
0055054b : RET

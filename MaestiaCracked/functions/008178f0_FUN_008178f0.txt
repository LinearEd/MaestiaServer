PROGRAM  : Maestia.exe
FUNCTION : FUN_008178f0
ENTRY    : 008178f0
BODY     : [[008178f0, 00817d61]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x00817af4) */

void FUN_008178f0(void)

{
  char cVar1;
  wchar_t *_Str1;
  int iVar2;
  wchar_t ****_Str;
  uint uVar3;
  int in_ECX;
  uint uVar4;
  uint uVar5;
  undefined1 auStack_21c [4];
  undefined4 uStack_218;
  uint *puStack_214;
  uint *puStack_210;
  char *pcStack_20c;
  uint local_17c;
  char local_178 [4];
  int local_174;
  int local_170;
  undefined4 local_16c;
  wchar_t *local_168;
  int local_164;
  uint local_160;
  undefined1 *local_15c;
  int local_158;
  wchar_t ***local_150 [4];
  undefined4 local_140;
  uint local_13c;
  undefined4 local_134;
  undefined4 local_124;
  uint local_120;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b43a4c;
  local_10 = ExceptionList;
  local_14 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_164 = in_ECX;
  FUN_00452440();
  *(int *)(*(int *)(in_ECX + 0xd8) + 4) = *(int *)(in_ECX + 0xd8);
  *(undefined4 *)(in_ECX + 0xdc) = 0;
  *(undefined4 *)*(undefined4 *)(in_ECX + 0xd8) = *(undefined4 *)(in_ECX + 0xd8);
  *(int *)(*(int *)(in_ECX + 0xd8) + 8) = *(int *)(in_ECX + 0xd8);
  local_120 = 7;
  local_124 = 0;
  local_134._0_2_ = L'\0';
  FUN_00406360();
  local_8 = 0;
  FUN_0043acd0();
  local_8 = 0xffffffff;
  if (7 < local_120) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_120 = 7;
  local_124 = 0;
  local_134._0_2_ = L'\0';
  if (local_158 != *(int *)(in_ECX + 0x4c)) {
    do {
      local_134 = (wchar_t *)((uint)local_134._2_2_ << 0x10);
      local_120 = 7;
      local_124 = 0;
      pcStack_20c = (char *)0x817a07;
      FUN_00405eb0();
      local_8 = 1;
      _Str1 = local_134;
      if (local_120 < 8) {
        _Str1 = (wchar_t *)&local_134;
      }
      pcStack_20c = (char *)0x817a30;
      iVar2 = _wcsncmp(_Str1,L"helpcont",8);
      if (iVar2 == 0) {
        FUN_0040e420();
        local_8._0_1_ = 2;
        _Str = (wchar_t ****)local_150[0];
        if (local_13c < 8) {
          _Str = local_150;
        }
        local_168 = _wcsstr((wchar_t *)_Str,L"#");
        if (local_168 == (wchar_t *)0x0) {
          local_168 = L"";
        }
        else {
          *local_168 = L'\0';
          local_168 = local_168 + 1;
        }
        FUN_00406360();
        local_8._0_1_ = 3;
        pcStack_20c = local_178;
        puStack_210 = (uint *)0x817ae5;
        FUN_0070cd60();
        local_8._0_1_ = 5;
        if (2 < (uint)((local_170 - local_174) / 0x1c)) {
          iVar2 = FUN_00634f4d();
          local_15c = (undefined1 *)FUN_00634f4d();
          uVar3 = FUN_00634f4d();
          pcStack_20c = "help\\ger\\helpimage%d-%d-%d.png";
          uVar5 = 3;
          puStack_210 = (uint *)0x817bba;
          FUN_0044c810();
          puStack_210 = &local_17c;
          puStack_214 = &local_160;
          uStack_218 = 0x817bd3;
          cVar1 = FUN_007b43e0();
          if (cVar1 != '\0') {
            uVar5 = (local_17c < local_160) + 1;
          }
          uVar4 = iVar2 << 8 | (uint)local_15c;
          local_15c = auStack_21c;
          uVar5 = (uVar4 << 8 | uVar3) << 8 | uVar5;
          FUN_00453050(auStack_21c,uVar5);
          local_8._0_1_ = 5;
          FUN_00452e30(uVar5);
          local_8._0_1_ = 7;
          FUN_00452d60();
          local_8._0_1_ = 8;
          FUN_00452050();
          local_8._0_1_ = 7;
          FUN_004427d0();
          local_8._0_1_ = 5;
          FUN_004427d0();
        }
        local_8 = CONCAT31(local_8._1_3_,2);
        if (local_174 != 0) {
          FUN_00405450();
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_174 = 0;
        local_170 = 0;
        local_16c = 0;
        local_8 = CONCAT31(local_8._1_3_,1);
        if (7 < local_13c) {
                    /* WARNING: Subroutine does not return */
          FUN_006f04e0();
        }
        local_13c = 7;
        local_140 = 0;
        local_150[0] = (wchar_t ***)((uint)local_150[0] & 0xffff0000);
        in_ECX = local_164;
      }
      local_8 = 0xffffffff;
      if (7 < local_120) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      local_120 = 7;
      local_124 = 0;
      local_134._0_2_ = L'\0';
      FUN_00430160();
    } while (local_158 != *(int *)(in_ECX + 0x4c));
  }
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008178f0 : PUSH EBP
008178f1 : MOV EBP,ESP
008178f3 : PUSH -0x1
008178f5 : PUSH 0xb43a4c
008178fa : MOV EAX,FS:[0x0]
00817900 : PUSH EAX
00817901 : SUB ESP,0x1dc
00817907 : MOV EAX,[0x00d66fa0]
0081790c : XOR EAX,EBP
0081790e : MOV dword ptr [EBP + -0x10],EAX
00817911 : PUSH EBX
00817912 : PUSH ESI
00817913 : PUSH EDI
00817914 : PUSH EAX
00817915 : LEA EAX,[EBP + -0xc]
00817918 : MOV FS:[0x0],EAX
0081791e : MOV EDI,ECX
00817920 : MOV EAX,dword ptr [EDI + 0xd8]
00817926 : MOV ECX,dword ptr [EAX + 0x4]
00817929 : LEA ESI,[EDI + 0xd4]
0081792f : PUSH ECX
00817930 : MOV ECX,ESI
00817932 : MOV dword ptr [EBP + 0xfffffea0],EDI
00817938 : CALL 0x00452440
0081793d : MOV EAX,dword ptr [ESI + 0x4]
00817940 : MOV dword ptr [EAX + 0x4],EAX
00817943 : MOV EAX,dword ptr [ESI + 0x4]
00817946 : XOR EBX,EBX
00817948 : MOV dword ptr [ESI + 0x8],EBX
0081794b : MOV dword ptr [EAX],EAX
0081794d : MOV ESI,dword ptr [ESI + 0x4]
00817950 : PUSH 0x9
00817952 : XOR EDX,EDX
00817954 : PUSH 0xc2ead4
00817959 : LEA ECX,[EBP + 0xfffffecc]
0081795f : MOV dword ptr [ESI + 0x8],ESI
00817962 : MOV dword ptr [EBP + 0xfffffee4],0x7
0081796c : MOV dword ptr [EBP + 0xfffffee0],EBX
00817972 : MOV word ptr [EBP + 0xfffffed0],DX
00817979 : CALL 0x00406360
0081797e : MOV dword ptr [EBP + -0x4],EBX
00817981 : LEA EAX,[EBP + 0xfffffeac]
00817987 : PUSH EAX
00817988 : LEA ECX,[EDI + 0x48]
0081798b : PUSH ECX
0081798c : LEA ESI,[EBP + 0xfffffecc]
00817992 : CALL 0x0043acd0
00817997 : MOV dword ptr [EBP + -0x4],0xffffffff
0081799e : CMP dword ptr [EBP + 0xfffffee4],0x8
008179a5 : JC 0x008179b2
008179a7 : MOV ECX,dword ptr [EBP + 0xfffffed0]
008179ad : CALL 0x006f04e0
008179b2 : MOV ECX,dword ptr [EDI + 0x4c]
008179b5 : MOV EAX,dword ptr [EBP + 0xfffffeac]
008179bb : XOR EDX,EDX
008179bd : MOV ESI,0x7
008179c2 : MOV dword ptr [EBP + 0xfffffee4],ESI
008179c8 : MOV dword ptr [EBP + 0xfffffee0],EBX
008179ce : MOV word ptr [EBP + 0xfffffed0],DX
008179d5 : CMP EAX,ECX
008179d7 : JZ 0x00817d46
008179dd : LEA ECX,[ECX]
008179e0 : PUSH -0x1
008179e2 : XOR ECX,ECX
008179e4 : ADD EAX,0xc
008179e7 : PUSH EBX
008179e8 : MOV word ptr [EBP + 0xfffffed0],CX
008179ef : PUSH EAX
008179f0 : LEA ECX,[EBP + 0xfffffecc]
008179f6 : MOV dword ptr [EBP + 0xfffffee4],ESI
008179fc : MOV dword ptr [EBP + 0xfffffee0],EBX
00817a02 : CALL 0x00405eb0
00817a07 : MOV dword ptr [EBP + -0x4],0x1
00817a0e : CMP dword ptr [EBP + 0xfffffee4],0x8
00817a15 : MOV EAX,dword ptr [EBP + 0xfffffed0]
00817a1b : JNC 0x00817a23
00817a1d : LEA EAX,[EBP + 0xfffffed0]
00817a23 : PUSH 0x8
00817a25 : PUSH 0xc2eae8
00817a2a : PUSH EAX
00817a2b : CALL 0x006380ac
00817a30 : ADD ESP,0xc
00817a33 : TEST EAX,EAX
00817a35 : JNZ 0x00817cfc
00817a3b : MOV ECX,dword ptr [EBP + 0xfffffee0]
00817a41 : LEA EDX,[EBP + 0xfffffeb0]
00817a47 : PUSH EDX
00817a48 : LEA EAX,[EBP + 0xfffffecc]
00817a4e : MOV EDI,0x8
00817a53 : PUSH EAX
00817a54 : MOV EDX,EDI
00817a56 : CALL 0x0040e420
00817a5b : MOV byte ptr [EBP + -0x4],0x2
00817a5f : MOV EAX,dword ptr [EBP + 0xfffffeb4]
00817a65 : CMP dword ptr [EBP + 0xfffffec8],EDI
00817a6b : JNC 0x00817a73
00817a6d : LEA EAX,[EBP + 0xfffffeb4]
00817a73 : PUSH 0xc2eafc
00817a78 : PUSH EAX
00817a79 : CALL 0x006347ba
00817a7e : ADD ESP,0x8
00817a81 : CMP EAX,EBX
00817a83 : JZ 0x00817a95
00817a85 : XOR ECX,ECX
00817a87 : MOV word ptr [EAX],CX
00817a8a : ADD EAX,0x2
00817a8d : MOV dword ptr [EBP + 0xfffffe9c],EAX
00817a93 : JMP 0x00817a9f
00817a95 : MOV dword ptr [EBP + 0xfffffe9c],0xc2eb00
00817a9f : PUSH 0x1
00817aa1 : XOR EDX,EDX
00817aa3 : PUSH 0xc2eb04
00817aa8 : LEA ECX,[EBP + 0xfffffe6c]
00817aae : MOV dword ptr [EBP + 0xfffffe84],ESI
00817ab4 : MOV dword ptr [EBP + 0xfffffe80],EBX
00817aba : MOV word ptr [EBP + 0xfffffe70],DX
00817ac1 : CALL 0x00406360
00817ac6 : MOV byte ptr [EBP + -0x4],0x3
00817aca : PUSH EBX
00817acb : LEA EAX,[EBP + 0xfffffe6c]
00817ad1 : PUSH EAX
00817ad2 : LEA ECX,[EBP + 0xfffffeb0]
00817ad8 : PUSH ECX
00817ad9 : LEA EDX,[EBP + 0xfffffe8c]
00817adf : PUSH EDX
00817ae0 : CALL 0x0070cd60
00817ae5 : ADD ESP,0x10
00817ae8 : MOV byte ptr [EBP + -0x4],0x5
00817aec : CMP dword ptr [EBP + 0xfffffe84],EDI
00817af2 : JC 0x00817aff
00817af4 : MOV ECX,dword ptr [EBP + 0xfffffe70]
00817afa : CALL 0x006f04e0
00817aff : MOV ECX,dword ptr [EBP + 0xfffffe94]
00817b05 : MOV EDI,dword ptr [EBP + 0xfffffe90]
00817b0b : XOR EAX,EAX
00817b0d : SUB ECX,EDI
00817b0f : MOV word ptr [EBP + 0xfffffe70],AX
00817b16 : MOV EAX,0x92492493
00817b1b : IMUL ECX
00817b1d : ADD EDX,ECX
00817b1f : SAR EDX,0x4
00817b22 : MOV ECX,EDX
00817b24 : SHR ECX,0x1f
00817b27 : ADD ECX,EDX
00817b29 : MOV dword ptr [EBP + 0xfffffe84],ESI
00817b2f : MOV dword ptr [EBP + 0xfffffe80],EBX
00817b35 : CMP ECX,0x2
00817b38 : JBE 0x00817c82
00817b3e : CMP dword ptr [EDI + 0x18],0x8
00817b42 : JC 0x00817b49
00817b44 : MOV EDI,dword ptr [EDI + 0x4]
00817b47 : JMP 0x00817b4c
00817b49 : ADD EDI,0x4
00817b4c : PUSH EDI
00817b4d : CALL 0x00634f4d
00817b52 : MOV ESI,EAX
00817b54 : MOV EAX,dword ptr [EBP + 0xfffffe90]
00817b5a : MOV EDI,0x8
00817b5f : ADD ESP,0x4
00817b62 : CMP dword ptr [EAX + 0x34],EDI
00817b65 : JC 0x00817b6c
00817b67 : MOV EAX,dword ptr [EAX + 0x20]
00817b6a : JMP 0x00817b6f
00817b6c : ADD EAX,0x20
00817b6f : PUSH EAX
00817b70 : CALL 0x00634f4d
00817b75 : MOV dword ptr [EBP + 0xfffffea8],EAX
00817b7b : MOV EAX,dword ptr [EBP + 0xfffffe90]
00817b81 : ADD ESP,0x4
00817b84 : CMP dword ptr [EAX + 0x50],EDI
00817b87 : JC 0x00817b8e
00817b89 : MOV EAX,dword ptr [EAX + 0x3c]
00817b8c : JMP 0x00817b91
00817b8e : ADD EAX,0x3c
00817b91 : PUSH EAX
00817b92 : CALL 0x00634f4d
00817b97 : MOV EDX,dword ptr [EBP + 0xfffffea8]
00817b9d : ADD ESP,0x4
00817ba0 : MOV EBX,EAX
00817ba2 : PUSH EBX
00817ba3 : PUSH EDX
00817ba4 : PUSH ESI
00817ba5 : PUSH 0xc2eb08
00817baa : LEA EDX,[EBP + 0xfffffee8]
00817bb0 : MOV EDI,0x3
00817bb5 : CALL 0x0044c810
00817bba : LEA EAX,[EBP + 0xfffffe88]
00817bc0 : PUSH EAX
00817bc1 : LEA ECX,[EBP + 0xfffffea4]
00817bc7 : PUSH ECX
00817bc8 : LEA EDX,[EBP + 0xfffffee8]
00817bce : CALL 0x007b43e0
00817bd3 : ADD ESP,0x18
00817bd6 : TEST AL,AL
00817bd8 : JZ 0x00817beb
00817bda : MOV EDX,dword ptr [EBP + 0xfffffe88]
00817be0 : CMP EDX,dword ptr [EBP + 0xfffffea4]
00817be6 : SBB EDI,EDI
00817be8 : NEG EDI
00817bea : INC EDI
00817beb : SHL ESI,0x8
00817bee : OR ESI,dword ptr [EBP + 0xfffffea8]
00817bf4 : SUB ESP,0x20
00817bf7 : SHL ESI,0x8
00817bfa : OR ESI,EBX
00817bfc : SHL ESI,0x8
00817bff : OR ESI,EDI
00817c01 : MOV EDI,dword ptr [EBP + 0xfffffe9c]
00817c07 : MOV EAX,ESP
00817c09 : MOV dword ptr [EBP + 0xfffffea8],ESP
00817c0f : PUSH ESI
00817c10 : PUSH EAX
00817c11 : CALL 0x00453050
00817c16 : MOV byte ptr [EBP + -0x4],0x6
00817c1a : PUSH ESI
00817c1b : MOV byte ptr [EBP + -0x4],0x5
00817c1f : LEA ESI,[EBP + 0xfffffe1c]
00817c25 : CALL 0x00452e30
00817c2a : ADD ESP,0x24
00817c2d : MOV byte ptr [EBP + -0x4],0x7
00817c31 : PUSH EAX
00817c32 : LEA ECX,[EBP + 0xfffffe40]
00817c38 : PUSH ECX
00817c39 : CALL 0x00452d60
00817c3e : MOV byte ptr [EBP + -0x4],0x8
00817c42 : LEA EDX,[EBP + 0xfffffe40]
00817c48 : PUSH EDX
00817c49 : LEA EAX,[EBP + 0xfffffe64]
00817c4f : PUSH EAX
00817c50 : MOV EAX,dword ptr [EBP + 0xfffffea0]
00817c56 : ADD EAX,0xd4
00817c5b : CALL 0x00452050
00817c60 : MOV byte ptr [EBP + -0x4],0x7
00817c64 : LEA ECX,[EBP + 0xfffffe44]
00817c6a : PUSH ECX
00817c6b : CALL 0x004427d0
00817c70 : MOV byte ptr [EBP + -0x4],0x5
00817c74 : LEA EDX,[EBP + 0xfffffe20]
00817c7a : PUSH EDX
00817c7b : CALL 0x004427d0
00817c80 : XOR EBX,EBX
00817c82 : MOV byte ptr [EBP + -0x4],0x2
00817c86 : MOV EAX,dword ptr [EBP + 0xfffffe90]
00817c8c : CMP EAX,EBX
00817c8e : JZ 0x00817cb0
00817c90 : MOV ECX,dword ptr [EBP + 0xfffffea4]
00817c96 : MOV EDI,dword ptr [EBP + 0xfffffe94]
00817c9c : PUSH ECX
00817c9d : CALL 0x00405450
00817ca2 : MOV ECX,dword ptr [EBP + 0xfffffe90]
00817ca8 : ADD ESP,0x4
00817cab : CALL 0x006f04e0
00817cb0 : MOV dword ptr [EBP + 0xfffffe90],EBX
00817cb6 : MOV dword ptr [EBP + 0xfffffe94],EBX
00817cbc : MOV dword ptr [EBP + 0xfffffe98],EBX
00817cc2 : MOV byte ptr [EBP + -0x4],0x1
00817cc6 : CMP dword ptr [EBP + 0xfffffec8],0x8
00817ccd : JC 0x00817cda
00817ccf : MOV ECX,dword ptr [EBP + 0xfffffeb4]
00817cd5 : CALL 0x006f04e0
00817cda : MOV EDI,dword ptr [EBP + 0xfffffea0]
00817ce0 : XOR EDX,EDX
00817ce2 : MOV dword ptr [EBP + 0xfffffec8],0x7
00817cec : MOV dword ptr [EBP + 0xfffffec4],EBX
00817cf2 : MOV word ptr [EBP + 0xfffffeb4],DX
00817cf9 : LEA ESI,[EDX + 0x7]
00817cfc : MOV dword ptr [EBP + -0x4],0xffffffff
00817d03 : CMP dword ptr [EBP + 0xfffffee4],0x8
00817d0a : JC 0x00817d17
00817d0c : MOV ECX,dword ptr [EBP + 0xfffffed0]
00817d12 : CALL 0x006f04e0
00817d17 : XOR EAX,EAX
00817d19 : LEA EDX,[EBP + 0xfffffeac]
00817d1f : MOV dword ptr [EBP + 0xfffffee4],ESI
00817d25 : MOV dword ptr [EBP + 0xfffffee0],EBX
00817d2b : MOV word ptr [EBP + 0xfffffed0],AX
00817d32 : CALL 0x00430160
00817d37 : MOV EAX,dword ptr [EBP + 0xfffffeac]
00817d3d : CMP EAX,dword ptr [EDI + 0x4c]
00817d40 : JNZ 0x008179e0
00817d46 : MOV ECX,dword ptr [EBP + -0xc]
00817d49 : MOV dword ptr FS:[0x0],ECX
00817d50 : POP ECX
00817d51 : POP EDI
00817d52 : POP ESI
00817d53 : POP EBX
00817d54 : MOV ECX,dword ptr [EBP + -0x10]
00817d57 : XOR ECX,EBP
00817d59 : CALL 0x00633e6b
00817d5e : MOV ESP,EBP
00817d60 : POP EBP
00817d61 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_008acad0
ENTRY    : 008acad0
BODY     : [[008acad0, 008acbaa]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008acad0(int param_1)

{
  int iVar1;
  ulonglong uVar2;
  uint uVar3;
  LPCWSTR lpWideCharStr;
  uint8_t *packet;
  CHAR local_40 [39];
  undefined1 local_19;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3e26e;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  lpWideCharStr = (LPCWSTR)(param_1 + 4);
  if (7 < *(uint *)(param_1 + 0x18)) {
    lpWideCharStr = *(LPCWSTR *)lpWideCharStr;
  }
  local_18 = uVar3;
  WideCharToMultiByte(0,0,lpWideCharStr,-1,local_40,0x28,(LPCSTR)0x0,(LPBOOL)0x0);
  iVar1 = *(int *)ThreadLocalStoragePointer;
  uVar2 = (ulonglong)(*(byte *)(iVar1 + 0x18) + 1) % 3;
  local_19 = 0;
  *(char *)(iVar1 + 0x18) = (char)uVar2;
  packet = (uint8_t *)0x0;
  local_8 = 0;
  if ((int)uVar2 * 0x2000 + 0x122cb8 + iVar1 != 0) {
    packet = (uint8_t *)FUN_004208c0(uVar3);
  }
  local_8 = 0xffffffff;
  if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
    FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),0x54,packet);
  }
  ExceptionList = local_10;
  __security_check_cookie(local_18 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008acad0 : PUSH EBP
008acad1 : MOV EBP,ESP
008acad3 : PUSH -0x1
008acad5 : PUSH 0xb3e26e
008acada : MOV EAX,FS:[0x0]
008acae0 : PUSH EAX
008acae1 : SUB ESP,0x38
008acae4 : MOV EAX,[0x00d66fa0]
008acae9 : XOR EAX,EBP
008acaeb : MOV dword ptr [EBP + -0x14],EAX
008acaee : PUSH EBX
008acaef : PUSH ESI
008acaf0 : PUSH EDI
008acaf1 : PUSH EAX
008acaf2 : LEA EAX,[EBP + -0xc]
008acaf5 : MOV FS:[0x0],EAX
008acafb : MOV EBX,dword ptr [EBP + 0x8]
008acafe : CMP dword ptr [EBX + 0x18],0x8
008acb02 : LEA EDI,[EBX + 0x4]
008acb05 : JC 0x008acb0b
008acb07 : MOV EAX,dword ptr [EDI]
008acb09 : JMP 0x008acb0d
008acb0b : MOV EAX,EDI
008acb0d : PUSH 0x0
008acb0f : PUSH 0x0
008acb11 : PUSH 0x28
008acb13 : LEA ECX,[EBP + -0x3c]
008acb16 : PUSH ECX
008acb17 : PUSH -0x1
008acb19 : PUSH EAX
008acb1a : PUSH 0x0
008acb1c : PUSH 0x0
008acb1e : CALL dword ptr [0x00b85130]
008acb24 : MOV EDX,dword ptr FS:[0x2c]
008acb2b : MOV ECX,dword ptr [EDX]
008acb2d : MOVZX EAX,byte ptr [ECX + 0x18]
008acb31 : INC EAX
008acb32 : CDQ
008acb33 : MOV ESI,0x3
008acb38 : IDIV ESI
008acb3a : MOV byte ptr [EBP + -0x15],0x0
008acb3e : MOVZX EAX,DL
008acb41 : SHL EAX,0xd
008acb44 : LEA ESI,[EAX + ECX*0x1 + 0x122cb8]
008acb4b : MOV byte ptr [ECX + 0x18],DL
008acb4e : MOV dword ptr [EBP + -0x40],ESI
008acb51 : XOR EAX,EAX
008acb53 : MOV dword ptr [EBP + -0x4],EAX
008acb56 : CMP ESI,EAX
008acb58 : JZ 0x008acb6b
008acb5a : CMP dword ptr [EBX + 0x18],0x8
008acb5e : JC 0x008acb64
008acb60 : MOV ECX,dword ptr [EDI]
008acb62 : JMP 0x008acb66
008acb64 : MOV ECX,EDI
008acb66 : CALL 0x004208c0
008acb6b : MOV dword ptr [EBP + -0x4],0xffffffff
008acb72 : MOV EDX,dword ptr [0x017247d4]
008acb78 : MOV ECX,dword ptr [EDX + 0x4]
008acb7b : TEST ECX,ECX
008acb7d : JZ 0x008acb8f
008acb7f : CMP byte ptr [EDX + 0x8],0x0
008acb83 : JZ 0x008acb8f
008acb85 : PUSH 0x54
008acb87 : PUSH ECX
008acb88 : MOV EDI,EAX
008acb8a : CALL 0x00a0dd40
008acb8f : MOV ECX,dword ptr [EBP + -0xc]
008acb92 : MOV dword ptr FS:[0x0],ECX
008acb99 : POP ECX
008acb9a : POP EDI
008acb9b : POP ESI
008acb9c : POP EBX
008acb9d : MOV ECX,dword ptr [EBP + -0x14]
008acba0 : XOR ECX,EBP
008acba2 : CALL 0x00633e6b
008acba7 : MOV ESP,EBP
008acba9 : POP EBP
008acbaa : RET

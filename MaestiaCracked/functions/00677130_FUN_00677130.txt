PROGRAM  : Maestia.exe
FUNCTION : FUN_00677130
ENTRY    : 00677130
BODY     : [[00677130, 006771aa]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00677130(undefined4 param_1,int param_2)

{
  int iVar1;
  int *in_ECX;
  uint uVar2;
  
  if (param_2 == 0) {
    if (*in_ECX != 0) {
      FUN_00515cf0(*in_ECX);
      *in_ECX = 0;
    }
    in_ECX[2] = 0;
    return;
  }
  uVar2 = param_2 + 3U >> 2;
  if (*in_ECX != 0) {
    iVar1 = FUN_00515c80(*in_ECX,uVar2 * 0x20);
    in_ECX[2] = uVar2 * 4;
    *in_ECX = iVar1;
    return;
  }
  param_2 = 2;
  iVar1 = FUN_00515840(uVar2 * 0x20,&param_2);
  in_ECX[2] = uVar2 * 4;
  *in_ECX = iVar1;
  return;
}



============================================================
DISASSEMBLY
============================================================
00677130 : MOV EAX,dword ptr [ESP + 0x8]
00677134 : PUSH EDI
00677135 : MOV EDI,ECX
00677137 : TEST EAX,EAX
00677139 : JNZ 0x00677158
0067713b : MOV EAX,dword ptr [EDI]
0067713d : TEST EAX,EAX
0067713f : JZ 0x0067714d
00677141 : PUSH EAX
00677142 : CALL 0x00515cf0
00677147 : MOV dword ptr [EDI],0x0
0067714d : MOV dword ptr [EDI + 0x8],0x0
00677154 : POP EDI
00677155 : RET 0x8
00677158 : PUSH ESI
00677159 : LEA ESI,[EAX + 0x3]
0067715c : MOV EAX,dword ptr [EDI]
0067715e : SHR ESI,0x2
00677161 : ADD ESI,ESI
00677163 : ADD ESI,ESI
00677165 : TEST EAX,EAX
00677167 : JZ 0x00677181
00677169 : LEA ECX,[ESI*0x8 + 0x0]
00677170 : PUSH ECX
00677171 : PUSH EAX
00677172 : CALL 0x00515c80
00677177 : MOV dword ptr [EDI + 0x8],ESI
0067717a : POP ESI
0067717b : MOV dword ptr [EDI],EAX
0067717d : POP EDI
0067717e : RET 0x8
00677181 : MOV ECX,dword ptr [0x00d73250]
00677187 : LEA EDX,[ESP + 0x10]
0067718b : PUSH EDX
0067718c : LEA EAX,[ESI*0x8 + 0x0]
00677193 : PUSH EAX
00677194 : MOV dword ptr [ESP + 0x18],0x2
0067719c : CALL 0x00515840
006771a1 : MOV dword ptr [EDI + 0x8],ESI
006771a4 : POP ESI
006771a5 : MOV dword ptr [EDI],EAX
006771a7 : POP EDI
006771a8 : RET 0x8

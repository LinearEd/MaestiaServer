PROGRAM  : Maestia.exe
FUNCTION : FUN_006a58c0
ENTRY    : 006a58c0
BODY     : [[006a58c0, 006a5ad8]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006a58c0(int param_1,uint param_2,uint param_3,int *param_4)

{
  int iVar1;
  int iVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte *pbVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  byte bVar9;
  uint uVar10;
  int iVar11;
  int *piVar12;
  
  *param_4 = 0;
  param_4[1] = 0;
  if (param_2 != 0) {
    param_2 = param_2 - 1;
  }
  if (param_3 != 0) {
    param_3 = param_3 - 1;
  }
  if (*(uint *)(param_1 + 0x198) < param_2) {
    return 0;
  }
  if (*(uint *)(param_1 + 0x198) < param_3) {
    return 0;
  }
  piVar12 = *(int **)(param_1 + 0x1a8);
  iVar1 = *(int *)(param_1 + 0x68);
  uVar6 = *(int *)(param_2 * 0x10 + *(int *)(param_1 + 0x1a0)) << 0x10 |
          (uint)*(ushort *)(param_3 * 0x10 + *(int *)(param_1 + 0x1a0));
  if (piVar12 == (int *)0x0) {
    return 0;
  }
  while ((uVar6 < (uint)piVar12[4] || ((uint)piVar12[5] < uVar6))) {
    piVar12 = (int *)*piVar12;
    if (piVar12 == (int *)0x0) {
      return 0;
    }
  }
  iVar2 = FUN_006877c0(iVar1,piVar12[3]);
  if (iVar2 != 0) {
    return iVar2;
  }
  iVar2 = FUN_00688900(iVar1,(uint)*(byte *)(piVar12 + 1) * piVar12[2]);
  if (iVar2 != 0) {
    return iVar2;
  }
  bVar9 = *(byte *)(piVar12 + 1);
  uVar8 = piVar12[2];
  iVar2 = FUN_00688160((uint)bVar9);
  iVar11 = (uint)bVar9 - iVar2;
  uVar10 = iVar2 * uVar8;
  pbVar5 = *(byte **)(iVar1 + 0x20);
  bVar9 = *(byte *)((int)piVar12 + 5) & 1;
  param_1._0_1_ = *(byte *)((int)piVar12 + 5) & 2;
  if (iVar11 == 0) {
LAB_006a5a08:
    if (uVar8 <= uVar10 && uVar10 - uVar8 != 0) {
      do {
        uVar10 = uVar10 >> 1;
        pbVar3 = pbVar5 + uVar10;
        if (bVar9 == 0) {
          pbVar4 = pbVar3 + 2;
          uVar7 = (uint)*pbVar3 << 0x10;
        }
        else {
          pbVar4 = pbVar3 + 4;
          uVar7 = (uint)CONCAT21(CONCAT11(*pbVar3,pbVar3[1]),pbVar3[2]) << 8;
        }
        if ((uVar7 | pbVar4[-1]) == uVar6) goto LAB_006a5a97;
        if ((uVar7 | pbVar4[-1]) < uVar6) {
          pbVar5 = pbVar3;
        }
      } while (uVar8 < uVar10);
    }
    if (bVar9 == 0) {
      pbVar4 = pbVar5 + 2;
      uVar8 = (uint)*pbVar5 << 0x10;
    }
    else {
      pbVar4 = pbVar5 + 4;
      uVar8 = (uint)CONCAT21(CONCAT11(*pbVar5,pbVar5[1]),pbVar5[2]) << 8;
    }
    if ((uVar8 | pbVar4[-1]) != uVar6) goto LAB_006a5ac0;
  }
  else {
    pbVar3 = pbVar5 + iVar11 * uVar8;
    if (bVar9 == 0) {
      pbVar4 = pbVar3 + 2;
      uVar7 = (uint)*pbVar3 << 0x10;
    }
    else {
      pbVar4 = pbVar3 + 4;
      uVar7 = (uint)CONCAT21(CONCAT11(*pbVar3,pbVar3[1]),pbVar3[2]) << 8;
    }
    if ((uVar7 | pbVar4[-1]) != uVar6) {
      if ((uVar7 | pbVar4[-1]) < uVar6) {
        if ((byte)param_1 == 0) {
          pbVar5 = pbVar4 + 1;
        }
        else {
          pbVar5 = pbVar4 + 2;
        }
      }
      goto LAB_006a5a08;
    }
  }
LAB_006a5a97:
  if ((byte)param_1 == 0) {
    uVar6 = (uint)*pbVar4;
  }
  else {
    uVar6 = (int)(short)((short)(char)*pbVar4 << 8) | (uint)pbVar4[1];
  }
  *param_4 = (int)*(short *)((int)piVar12 + 6) + uVar6;
LAB_006a5ac0:
  FUN_006889b0(iVar1);
  return 0;
}



============================================================
DISASSEMBLY
============================================================
006a58c0 : MOV ECX,dword ptr [ESP + 0x10]
006a58c4 : XOR EAX,EAX
006a58c6 : SUB ESP,0xc
006a58c9 : MOV dword ptr [ECX],EAX
006a58cb : MOV dword ptr [ECX + 0x4],EAX
006a58ce : MOV ECX,dword ptr [ESP + 0x14]
006a58d2 : PUSH EBX
006a58d3 : MOV EBX,dword ptr [ESP + 0x14]
006a58d7 : PUSH ESI
006a58d8 : TEST ECX,ECX
006a58da : JBE 0x006a58dd
006a58dc : DEC ECX
006a58dd : MOV EDX,dword ptr [ESP + 0x20]
006a58e1 : TEST EDX,EDX
006a58e3 : JBE 0x006a58e6
006a58e5 : DEC EDX
006a58e6 : MOV ESI,dword ptr [EBX + 0x198]
006a58ec : CMP ECX,ESI
006a58ee : JA 0x006a5ad3
006a58f4 : CMP EDX,ESI
006a58f6 : JA 0x006a5ad3
006a58fc : MOV ESI,dword ptr [EBX + 0x1a0]
006a5902 : SHL ECX,0x4
006a5905 : MOV ECX,dword ptr [ECX + ESI*0x1]
006a5908 : SHL EDX,0x4
006a590b : MOVZX EDX,word ptr [EDX + ESI*0x1]
006a590f : SHL ECX,0x10
006a5912 : PUSH EDI
006a5913 : MOV EDI,dword ptr [EBX + 0x1a8]
006a5919 : MOV EBX,dword ptr [EBX + 0x68]
006a591c : OR ECX,EDX
006a591e : MOV dword ptr [ESP + 0x24],ECX
006a5922 : MOV dword ptr [ESP + 0xc],EBX
006a5926 : TEST EDI,EDI
006a5928 : JZ 0x006a5ad2
006a592e : MOV EDI,EDI
006a5930 : CMP ECX,dword ptr [EDI + 0x10]
006a5933 : JC 0x006a593a
006a5935 : CMP ECX,dword ptr [EDI + 0x14]
006a5938 : JBE 0x006a5947
006a593a : MOV EDI,dword ptr [EDI]
006a593c : TEST EDI,EDI
006a593e : JNZ 0x006a5930
006a5940 : POP EDI
006a5941 : POP ESI
006a5942 : POP EBX
006a5943 : ADD ESP,0xc
006a5946 : RET
006a5947 : MOV EAX,dword ptr [EDI + 0xc]
006a594a : PUSH EAX
006a594b : PUSH EBX
006a594c : CALL 0x006877c0
006a5951 : ADD ESP,0x8
006a5954 : TEST EAX,EAX
006a5956 : JNZ 0x006a5ad2
006a595c : MOVZX ECX,byte ptr [EDI + 0x4]
006a5960 : IMUL ECX,dword ptr [EDI + 0x8]
006a5964 : PUSH ECX
006a5965 : PUSH EBX
006a5966 : CALL 0x00688900
006a596b : ADD ESP,0x8
006a596e : MOV dword ptr [ESP + 0x14],EAX
006a5972 : TEST EAX,EAX
006a5974 : JNZ 0x006a5ad2
006a597a : MOVZX ESI,byte ptr [EDI + 0x4]
006a597e : MOV EBX,dword ptr [EDI + 0x8]
006a5981 : PUSH EBP
006a5982 : PUSH ESI
006a5983 : MOV dword ptr [ESP + 0x28],EBX
006a5987 : CALL 0x00688160
006a598c : MOV EDX,dword ptr [ESP + 0x14]
006a5990 : MOV CL,byte ptr [EDI + 0x5]
006a5993 : SUB ESI,EAX
006a5995 : MOV EBP,EAX
006a5997 : MOV EAX,ESI
006a5999 : IMUL EBP,EBX
006a599c : MOV ESI,dword ptr [EDX + 0x20]
006a599f : MOV DL,CL
006a59a1 : AND CL,0x2
006a59a4 : ADD ESP,0x4
006a59a7 : AND DL,0x1
006a59aa : MOV byte ptr [ESP + 0x20],CL
006a59ae : TEST EAX,EAX
006a59b0 : JBE 0x006a5a08
006a59b2 : IMUL EAX,EBX
006a59b5 : ADD EAX,ESI
006a59b7 : TEST DL,DL
006a59b9 : JZ 0x006a59d8
006a59bb : MOVZX ECX,byte ptr [EAX]
006a59be : MOVZX EBX,byte ptr [EAX + 0x1]
006a59c2 : ADD EAX,0x4
006a59c5 : SHL ECX,0x8
006a59c8 : OR ECX,EBX
006a59ca : MOVZX EBX,byte ptr [EAX + -0x2]
006a59ce : SHL ECX,0x8
006a59d1 : OR ECX,EBX
006a59d3 : SHL ECX,0x8
006a59d6 : JMP 0x006a59e1
006a59d8 : MOVZX ECX,byte ptr [EAX]
006a59db : ADD EAX,0x2
006a59de : SHL ECX,0x10
006a59e1 : MOVZX EBX,byte ptr [EAX + -0x1]
006a59e5 : OR ECX,EBX
006a59e7 : MOV EBX,dword ptr [ESP + 0x28]
006a59eb : CMP ECX,EBX
006a59ed : JZ 0x006a5a97
006a59f3 : JNC 0x006a5a04
006a59f5 : CMP byte ptr [ESP + 0x20],0x0
006a59fa : JZ 0x006a5a01
006a59fc : ADD EAX,0x2
006a59ff : JMP 0x006a5a02
006a5a01 : INC EAX
006a5a02 : MOV ESI,EAX
006a5a04 : MOV EBX,dword ptr [ESP + 0x24]
006a5a08 : CMP EBP,EBX
006a5a0a : JBE 0x006a5a5f
006a5a0c : LEA ESP,[ESP]
006a5a10 : SHR EBP,0x1
006a5a12 : LEA EAX,[ESI + EBP*0x1]
006a5a15 : MOV dword ptr [ESP + 0x14],EAX
006a5a19 : TEST DL,DL
006a5a1b : JZ 0x006a5a3a
006a5a1d : MOVZX ECX,byte ptr [EAX]
006a5a20 : MOVZX EBX,byte ptr [EAX + 0x1]
006a5a24 : ADD EAX,0x4
006a5a27 : SHL ECX,0x8
006a5a2a : OR ECX,EBX
006a5a2c : MOVZX EBX,byte ptr [EAX + -0x2]
006a5a30 : SHL ECX,0x8
006a5a33 : OR ECX,EBX
006a5a35 : SHL ECX,0x8
006a5a38 : JMP 0x006a5a43
006a5a3a : MOVZX ECX,byte ptr [EAX]
006a5a3d : ADD EAX,0x2
006a5a40 : SHL ECX,0x10
006a5a43 : MOVZX EBX,byte ptr [EAX + -0x1]
006a5a47 : OR ECX,EBX
006a5a49 : MOV EBX,dword ptr [ESP + 0x28]
006a5a4d : CMP ECX,EBX
006a5a4f : JZ 0x006a5a97
006a5a51 : JNC 0x006a5a57
006a5a53 : MOV ESI,dword ptr [ESP + 0x14]
006a5a57 : CMP EBP,dword ptr [ESP + 0x24]
006a5a5b : JA 0x006a5a10
006a5a5d : JMP 0x006a5a63
006a5a5f : MOV EBX,dword ptr [ESP + 0x28]
006a5a63 : TEST DL,DL
006a5a65 : JZ 0x006a5a84
006a5a67 : MOVZX ECX,byte ptr [ESI]
006a5a6a : MOVZX EDX,byte ptr [ESI + 0x1]
006a5a6e : LEA EAX,[ESI + 0x4]
006a5a71 : SHL ECX,0x8
006a5a74 : OR ECX,EDX
006a5a76 : MOVZX EDX,byte ptr [EAX + -0x2]
006a5a7a : SHL ECX,0x8
006a5a7d : OR ECX,EDX
006a5a7f : SHL ECX,0x8
006a5a82 : JMP 0x006a5a8d
006a5a84 : MOVZX ECX,byte ptr [ESI]
006a5a87 : LEA EAX,[ESI + 0x2]
006a5a8a : SHL ECX,0x10
006a5a8d : MOVZX EDX,byte ptr [EAX + -0x1]
006a5a91 : OR ECX,EDX
006a5a93 : CMP ECX,EBX
006a5a95 : JNZ 0x006a5ac0
006a5a97 : CMP byte ptr [ESP + 0x20],0x0
006a5a9c : JZ 0x006a5ab1
006a5a9e : MOVSX CX,byte ptr [EAX]
006a5aa2 : MOVZX EDX,byte ptr [EAX + 0x1]
006a5aa6 : SHL CX,0x8
006a5aaa : MOVSX ECX,CX
006a5aad : OR ECX,EDX
006a5aaf : JMP 0x006a5ab4
006a5ab1 : MOVZX ECX,byte ptr [EAX]
006a5ab4 : MOVSX EAX,word ptr [EDI + 0x6]
006a5ab8 : ADD EAX,ECX
006a5aba : MOV ECX,dword ptr [ESP + 0x2c]
006a5abe : MOV dword ptr [ECX],EAX
006a5ac0 : MOV EDX,dword ptr [ESP + 0x10]
006a5ac4 : PUSH EDX
006a5ac5 : CALL 0x006889b0
006a5aca : MOV EAX,dword ptr [ESP + 0x1c]
006a5ace : ADD ESP,0x4
006a5ad1 : POP EBP
006a5ad2 : POP EDI
006a5ad3 : POP ESI
006a5ad4 : POP EBX
006a5ad5 : ADD ESP,0xc
006a5ad8 : RET

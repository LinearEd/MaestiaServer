PROGRAM  : Maestia.exe
FUNCTION : FUN_00842dd0
ENTRY    : 00842dd0
BODY     : [[00842dd0, 00842faa]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00842dd0(uint param_1,uint8_t *param_2,char param_3)

{
  byte bVar1;
  char cVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  uint8_t *packet;
  byte bVar6;
  int local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b66277;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  bVar6 = (byte)param_2;
  iVar4 = FUN_008413b0(param_1,0);
  iVar5 = DAT_00d7c54c;
  if (iVar4 != 0) {
    param_2 = (uint8_t *)param_1;
    FUN_004437f0(&param_2);
    if ((local_14 == *(int *)(iVar5 + 0x44)) || (iVar5 = *(int *)(local_14 + 0x10), iVar5 == 0)) {
      FUN_008018d0(L"AvaSkillDataManager::OnLearnSkill Skill not found5");
      ExceptionList = local_10;
      return;
    }
    param_2 = (uint8_t *)((uint)param_2 & 0xffffff);
    if ((*(int *)(DAT_0172491c + 0x17c) != 0) &&
       (cVar2 = FUN_0088d930(*(int *)(DAT_0172491c + 0x17c)), cVar2 != '\0')) {
      param_2 = (uint8_t *)CONCAT13(1,param_2._0_3_);
    }
    *(byte *)(iVar4 + 8) = bVar6;
    *(char *)(iVar4 + 9) = param_3;
    bVar1 = *(byte *)(iVar5 + 0x208);
    *(byte *)(iVar4 + 10) = bVar1;
    if (bVar1 < bVar6) {
      *(byte *)(iVar4 + 8) = bVar1;
      bVar6 = bVar1;
    }
    *(byte *)(iVar4 + 0xb) = bVar6 + param_3;
    if (*(byte *)(iVar4 + 10) < (byte)(bVar6 + param_3)) {
      *(byte *)(iVar4 + 0xb) = *(byte *)(iVar4 + 10);
    }
    if ((*(char *)(iVar4 + 0x30) == '\0') && (*(char *)(iVar4 + 0x31) == '\0')) {
      FUN_00842810(uVar3);
    }
    if ((*DAT_00da9894 != 0) && (*(int *)(*DAT_00da9894 + 0x17c) != 0)) {
      FUN_0040e050(0);
      FUN_0090cc20();
      iVar5 = FUN_004049b0(param_1);
      if ((iVar5 != 0) && ((*(byte *)(iVar5 + 0x40) & 0x80) != 0)) {
        FUN_008c2030(*(undefined4 *)(*DAT_00da9894 + 0x1ec),bVar6);
      }
    }
    if (param_2._3_1_ != '\0') {
      iVar5 = *(int *)ThreadLocalStoragePointer;
      bVar6 = (byte)((ulonglong)(*(byte *)(iVar5 + 0x18) + 1) % 3);
      *(byte *)(iVar5 + 0x18) = bVar6;
      param_2 = (uint8_t *)((uint)bVar6 * 0x2000 + 0x122cb8 + iVar5);
      if (param_2 == (uint8_t *)0x0) {
        packet = (uint8_t *)0x0;
      }
      else {
        param_2[0] = '\0';
        param_2[1] = '\0';
        param_2[2] = ':';
        param_2[3] = '\x15';
        *(uint *)(param_2 + 4) = param_1;
        param_2[9] = 0xff;
        param_2[10] = 0xff;
        param_2[0xb] = 0xff;
        param_2[0xc] = 0xff;
        param_2[8] = '\0';
        packet = param_2;
      }
      local_8 = 0xffffffff;
      if ((*(int *)(DAT_017247d4 + 4) != 0) && (*(char *)(DAT_017247d4 + 8) != '\0')) {
        FUN_00a0dd40(*(int *)(DAT_017247d4 + 4),0x13,packet);
      }
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
00842dd0 : PUSH EBP
00842dd1 : MOV EBP,ESP
00842dd3 : PUSH -0x1
00842dd5 : PUSH 0xb66277
00842dda : MOV EAX,FS:[0x0]
00842de0 : PUSH EAX
00842de1 : SUB ESP,0x8
00842de4 : PUSH EBX
00842de5 : PUSH ESI
00842de6 : PUSH EDI
00842de7 : MOV EAX,[0x00d66fa0]
00842dec : XOR EAX,EBP
00842dee : PUSH EAX
00842def : LEA EAX,[EBP + -0xc]
00842df2 : MOV FS:[0x0],EAX
00842df8 : MOV BL,byte ptr [EBP + 0xc]
00842dfb : MOV EDI,dword ptr [EBP + 0x8]
00842dfe : PUSH 0x0
00842e00 : PUSH EDI
00842e01 : CALL 0x008413b0
00842e06 : MOV ESI,EAX
00842e08 : TEST ESI,ESI
00842e0a : JZ 0x00842f97
00842e10 : MOV dword ptr [EBP + 0xc],EDI
00842e13 : MOV EDI,dword ptr [0x00d7c54c]
00842e19 : LEA EAX,[EBP + 0xc]
00842e1c : PUSH EAX
00842e1d : LEA ECX,[EDI + 0x40]
00842e20 : LEA EAX,[EBP + -0x10]
00842e23 : CALL 0x004437f0
00842e28 : MOV EDI,dword ptr [EDI + 0x44]
00842e2b : MOV EAX,dword ptr [EBP + -0x10]
00842e2e : CMP EAX,EDI
00842e30 : JZ 0x00842e39
00842e32 : MOV EDI,dword ptr [EAX + 0x10]
00842e35 : TEST EDI,EDI
00842e37 : JNZ 0x00842e60
00842e39 : MOV ESI,dword ptr [0x00da98e8]
00842e3f : PUSH 0xc3ae58
00842e44 : CALL 0x008018d0
00842e49 : ADD ESP,0x4
00842e4c : MOV ECX,dword ptr [EBP + -0xc]
00842e4f : MOV dword ptr FS:[0x0],ECX
00842e56 : POP ECX
00842e57 : POP EDI
00842e58 : POP ESI
00842e59 : POP EBX
00842e5a : MOV ESP,EBP
00842e5c : POP EBP
00842e5d : RET 0xc
00842e60 : MOV ECX,dword ptr [0x0172491c]
00842e66 : MOV EAX,dword ptr [ECX + 0x17c]
00842e6c : MOV byte ptr [EBP + 0xf],0x0
00842e70 : TEST EAX,EAX
00842e72 : JZ 0x00842e85
00842e74 : MOV ECX,dword ptr [EBP + 0x8]
00842e77 : PUSH EAX
00842e78 : CALL 0x0088d930
00842e7d : TEST AL,AL
00842e7f : JZ 0x00842e85
00842e81 : MOV byte ptr [EBP + 0xf],0x1
00842e85 : MOV CL,byte ptr [EBP + 0x10]
00842e88 : MOV byte ptr [ESI + 0x8],BL
00842e8b : MOV byte ptr [ESI + 0x9],CL
00842e8e : MOV AL,byte ptr [EDI + 0x208]
00842e94 : MOV byte ptr [ESI + 0xa],AL
00842e97 : CMP AL,BL
00842e99 : JNC 0x00842ea0
00842e9b : MOV byte ptr [ESI + 0x8],AL
00842e9e : MOV BL,AL
00842ea0 : MOV AL,BL
00842ea2 : ADD AL,CL
00842ea4 : MOV CL,byte ptr [ESI + 0xa]
00842ea7 : MOV byte ptr [ESI + 0xb],AL
00842eaa : CMP CL,AL
00842eac : JNC 0x00842eb1
00842eae : MOV byte ptr [ESI + 0xb],CL
00842eb1 : CMP byte ptr [ESI + 0x30],0x0
00842eb5 : JNZ 0x00842ec4
00842eb7 : CMP byte ptr [ESI + 0x31],0x0
00842ebb : JNZ 0x00842ec4
00842ebd : MOV EDI,ESI
00842ebf : CALL 0x00842810
00842ec4 : MOV EDX,dword ptr [0x00da9894]
00842eca : MOV EAX,dword ptr [EDX]
00842ecc : TEST EAX,EAX
00842ece : JZ 0x00842f1e
00842ed0 : CMP dword ptr [EAX + 0x17c],0x0
00842ed7 : JZ 0x00842f1e
00842ed9 : PUSH 0x0
00842edb : CALL 0x0040e050
00842ee0 : MOV EDI,EAX
00842ee2 : MOV EAX,ESI
00842ee4 : CALL 0x0090cc20
00842ee9 : MOV ESI,dword ptr [EBP + 0x8]
00842eec : PUSH ESI
00842eed : CALL 0x004049b0
00842ef2 : ADD ESP,0x4
00842ef5 : TEST EAX,EAX
00842ef7 : JZ 0x00842f21
00842ef9 : TEST byte ptr [EAX + 0x40],0x80
00842efd : JZ 0x00842f21
00842eff : MOV EAX,[0x00da9894]
00842f04 : MOV EAX,dword ptr [EAX]
00842f06 : MOV EAX,dword ptr [EAX + 0x1ec]
00842f0c : MOVZX CX,BL
00842f10 : MOVZX EDX,CX
00842f13 : PUSH EDX
00842f14 : PUSH EAX
00842f15 : MOV EAX,ESI
00842f17 : CALL 0x008c2030
00842f1c : JMP 0x00842f21
00842f1e : MOV ESI,dword ptr [EBP + 0x8]
00842f21 : CMP byte ptr [EBP + 0xf],0x0
00842f25 : JZ 0x00842f97
00842f27 : MOV EAX,FS:[0x2c]
00842f2d : MOV ECX,dword ptr [EAX]
00842f2f : MOVZX EAX,byte ptr [ECX + 0x18]
00842f33 : INC EAX
00842f34 : CDQ
00842f35 : MOV EDI,0x3
00842f3a : IDIV EDI
00842f3c : MOV byte ptr [ECX + 0x18],DL
00842f3f : MOVZX EDX,DL
00842f42 : SHL EDX,0xd
00842f45 : LEA EAX,[EDX + ECX*0x1 + 0x122cb8]
00842f4c : MOV dword ptr [EBP + 0xc],EAX
00842f4f : MOV dword ptr [EBP + -0x4],0x0
00842f56 : OR ECX,0xffffffff
00842f59 : TEST EAX,EAX
00842f5b : JZ 0x00842f75
00842f5d : XOR EDX,EDX
00842f5f : MOV word ptr [EAX],DX
00842f62 : MOV byte ptr [EAX + 0x2],0x3a
00842f66 : MOV byte ptr [EAX + 0x3],0x15
00842f6a : MOV dword ptr [EAX + 0x4],ESI
00842f6d : MOV dword ptr [EAX + 0x9],ECX
00842f70 : MOV byte ptr [EAX + 0x8],DL
00842f73 : JMP 0x00842f77
00842f75 : XOR EAX,EAX
00842f77 : MOV dword ptr [EBP + -0x4],ECX
00842f7a : MOV EDX,dword ptr [0x017247d4]
00842f80 : MOV ECX,dword ptr [EDX + 0x4]
00842f83 : TEST ECX,ECX
00842f85 : JZ 0x00842f97
00842f87 : CMP byte ptr [EDX + 0x8],0x0
00842f8b : JZ 0x00842f97
00842f8d : PUSH 0x13
00842f8f : PUSH ECX
00842f90 : MOV EDI,EAX
00842f92 : CALL 0x00a0dd40
00842f97 : MOV ECX,dword ptr [EBP + -0xc]
00842f9a : MOV dword ptr FS:[0x0],ECX
00842fa1 : POP ECX
00842fa2 : POP EDI
00842fa3 : POP ESI
00842fa4 : POP EBX
00842fa5 : MOV ESP,EBP
00842fa7 : POP EBP
00842fa8 : RET 0xc

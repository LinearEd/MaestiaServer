PROGRAM  : Maestia.exe
FUNCTION : FUN_00417990
ENTRY    : 00417990
BODY     : [[00417990, 004179cc] [004179d0, 00417b8d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00417990(undefined4 *param_1,undefined4 *param_2,undefined4 *param_3,undefined4 param_4)

{
  undefined4 uVar1;
  undefined4 *puVar2;
  char cVar3;
  undefined4 *puVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  undefined4 *puVar8;
  undefined4 *local_c;
  undefined4 *local_8;
  
  puVar8 = param_2 + (((int)param_3 - (int)param_2 >> 2) - ((int)param_3 - (int)param_2 >> 0x1f) >>
                     1);
  FUN_00417f00(param_2,puVar8,param_3 + -1,param_4);
  puVar4 = puVar8;
  while (((param_2 < puVar4 && (cVar3 = FUN_00418de0(&param_4), cVar3 == '\0')) &&
         (cVar3 = FUN_00418de0(&param_4), cVar3 == '\0'))) {
    puVar4 = puVar4 + -1;
  }
  do {
    puVar8 = puVar8 + 1;
    puVar7 = puVar8;
    local_8 = puVar8;
    local_c = puVar4;
    puVar6 = puVar4;
    if ((param_3 <= puVar8) || (cVar3 = FUN_00418de0(&param_4), cVar3 != '\0')) break;
    cVar3 = FUN_00418de0(&param_4);
  } while (cVar3 == '\0');
joined_r0x00417a43:
  do {
    puVar5 = puVar6;
    puVar2 = puVar7;
    puVar7 = puVar4;
    if (param_3 <= puVar2) {
joined_r0x00417a89:
      while (param_2 < puVar4) {
        puVar7 = puVar7 + -1;
        cVar3 = FUN_00418de0(&param_4);
        puVar8 = local_8;
        if (cVar3 == '\0') {
          cVar3 = FUN_00418de0(&param_4);
          puVar4 = local_c;
          if (cVar3 != '\0') break;
          puVar5 = puVar5 + -1;
          if (puVar5 != puVar7) {
            uVar1 = *puVar5;
            *puVar5 = *puVar7;
            *puVar7 = uVar1;
          }
        }
        local_c = local_c + -1;
        puVar4 = local_c;
      }
      if (puVar4 == param_2) {
        if (puVar2 == param_3) {
          param_1[1] = puVar8;
          *param_1 = puVar5;
          return;
        }
        if ((puVar8 != puVar2) && (puVar5 != puVar8)) {
          uVar1 = *puVar5;
          *puVar5 = *puVar8;
          *puVar8 = uVar1;
        }
        puVar8 = puVar8 + 1;
        puVar7 = puVar2 + 1;
        local_8 = puVar8;
        puVar6 = puVar5 + 1;
        if (puVar5 != puVar2) {
          uVar1 = *puVar5;
          *puVar5 = *puVar2;
          *puVar2 = uVar1;
        }
      }
      else {
        puVar4 = puVar4 + -1;
        local_c = puVar4;
        if (puVar2 == param_3) {
          puVar6 = puVar5 + -1;
          if (puVar4 != puVar6) {
            uVar1 = *puVar4;
            *puVar4 = *puVar6;
            *puVar6 = uVar1;
          }
          puVar8 = puVar8 + -1;
          puVar7 = puVar2;
          local_8 = puVar8;
          if (puVar6 != puVar8) {
            uVar1 = *puVar6;
            *puVar6 = *puVar8;
            *puVar8 = uVar1;
          }
        }
        else {
          puVar7 = puVar2 + 1;
          puVar6 = puVar5;
          if (puVar2 != puVar4) {
            uVar1 = *puVar2;
            *puVar2 = *puVar4;
            *puVar4 = uVar1;
          }
        }
      }
      goto joined_r0x00417a43;
    }
    cVar3 = FUN_00418de0(&param_4);
    puVar6 = puVar8;
    puVar4 = local_c;
    if (cVar3 == '\0') {
      cVar3 = FUN_00418de0(&param_4);
      puVar7 = local_c;
      if (cVar3 != '\0') goto joined_r0x00417a89;
      puVar6 = puVar8 + 1;
      local_8 = puVar6;
      if (puVar8 != puVar2) {
        uVar1 = *puVar8;
        *puVar8 = *puVar2;
        *puVar2 = uVar1;
      }
    }
    puVar7 = puVar2 + 1;
    puVar8 = puVar6;
    puVar6 = puVar5;
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
00417990 : PUSH EBP
00417991 : MOV EBP,ESP
00417993 : SUB ESP,0x10
00417996 : MOV ECX,dword ptr [EBP + 0xc]
00417999 : PUSH EBX
0041799a : PUSH ESI
0041799b : PUSH EDI
0041799c : MOV EDI,dword ptr [EBP + 0x10]
0041799f : MOV EAX,EDI
004179a1 : SUB EAX,ECX
004179a3 : SAR EAX,0x2
004179a6 : CDQ
004179a7 : SUB EAX,EDX
004179a9 : MOV EDX,dword ptr [EBP + 0x14]
004179ac : SAR EAX,0x1
004179ae : LEA ESI,[ECX + EAX*0x4]
004179b1 : PUSH EDX
004179b2 : LEA EAX,[EDI + -0x4]
004179b5 : PUSH EAX
004179b6 : PUSH ESI
004179b7 : PUSH ECX
004179b8 : CALL 0x00417f00
004179bd : ADD ESP,0x10
004179c0 : LEA EDI,[ESI + 0x4]
004179c3 : MOV dword ptr [EBP + -0x4],EDI
004179c6 : CMP dword ptr [EBP + 0xc],ESI
004179c9 : JNC 0x004179fe
004179cb : JMP 0x004179d0
004179d0 : MOV EBX,dword ptr [ESI]
004179d2 : MOV EDX,dword ptr [ESI + -0x4]
004179d5 : LEA EAX,[EBP + 0x14]
004179d8 : PUSH EAX
004179d9 : MOV EAX,EBX
004179db : CALL 0x00418de0
004179e0 : TEST AL,AL
004179e2 : JNZ 0x004179fe
004179e4 : MOV EAX,dword ptr [ESI + -0x4]
004179e7 : LEA ECX,[EBP + 0x14]
004179ea : PUSH ECX
004179eb : MOV EDX,EBX
004179ed : CALL 0x00418de0
004179f2 : TEST AL,AL
004179f4 : JNZ 0x004179fe
004179f6 : ADD ESI,-0x4
004179f9 : CMP dword ptr [EBP + 0xc],ESI
004179fc : JC 0x004179d0
004179fe : CMP EDI,dword ptr [EBP + 0x10]
00417a01 : JNC 0x00417a32
00417a03 : MOV EBX,dword ptr [EDI]
00417a05 : MOV EAX,dword ptr [ESI]
00417a07 : LEA EDX,[EBP + 0x14]
00417a0a : PUSH EDX
00417a0b : MOV EDX,EBX
00417a0d : CALL 0x00418de0
00417a12 : TEST AL,AL
00417a14 : JNZ 0x00417a2f
00417a16 : MOV EDX,dword ptr [ESI]
00417a18 : LEA EAX,[EBP + 0x14]
00417a1b : PUSH EAX
00417a1c : MOV EAX,EBX
00417a1e : CALL 0x00418de0
00417a23 : TEST AL,AL
00417a25 : JNZ 0x00417a2f
00417a27 : ADD EDI,0x4
00417a2a : CMP EDI,dword ptr [EBP + 0x10]
00417a2d : JC 0x00417a03
00417a2f : MOV dword ptr [EBP + -0x4],EDI
00417a32 : MOV EAX,ESI
00417a34 : MOV EBX,EDI
00417a36 : MOV dword ptr [EBP + -0x8],EAX
00417a39 : LEA ESP,[ESP]
00417a40 : CMP EBX,dword ptr [EBP + 0x10]
00417a43 : JNC 0x00417a86
00417a45 : MOV EAX,dword ptr [EBX]
00417a47 : MOV EDX,dword ptr [ESI]
00417a49 : LEA ECX,[EBP + 0x14]
00417a4c : PUSH ECX
00417a4d : CALL 0x00418de0
00417a52 : TEST AL,AL
00417a54 : JNZ 0x00417a7b
00417a56 : MOV EAX,dword ptr [ESI]
00417a58 : LEA EDX,[EBP + 0x14]
00417a5b : PUSH EDX
00417a5c : MOV EDX,dword ptr [EBX]
00417a5e : CALL 0x00418de0
00417a63 : TEST AL,AL
00417a65 : JNZ 0x00417a83
00417a67 : MOV EAX,EDI
00417a69 : ADD EDI,0x4
00417a6c : MOV dword ptr [EBP + -0x4],EDI
00417a6f : CMP EAX,EBX
00417a71 : JZ 0x00417a7b
00417a73 : MOV EDX,dword ptr [EBX]
00417a75 : MOV ECX,dword ptr [EAX]
00417a77 : MOV dword ptr [EAX],EDX
00417a79 : MOV dword ptr [EBX],ECX
00417a7b : ADD EBX,0x4
00417a7e : CMP EBX,dword ptr [EBP + 0x10]
00417a81 : JC 0x00417a45
00417a83 : MOV EAX,dword ptr [EBP + -0x8]
00417a86 : CMP EAX,dword ptr [EBP + 0xc]
00417a89 : JBE 0x00417adb
00417a8b : LEA EDI,[EAX + -0x4]
00417a8e : MOV EDI,EDI
00417a90 : MOV EAX,dword ptr [ESI]
00417a92 : MOV EDX,dword ptr [EDI]
00417a94 : LEA ECX,[EBP + 0x14]
00417a97 : PUSH ECX
00417a98 : CALL 0x00418de0
00417a9d : TEST AL,AL
00417a9f : JNZ 0x00417ac1
00417aa1 : MOV EAX,dword ptr [EDI]
00417aa3 : LEA EDX,[EBP + 0x14]
00417aa6 : PUSH EDX
00417aa7 : MOV EDX,dword ptr [ESI]
00417aa9 : CALL 0x00418de0
00417aae : TEST AL,AL
00417ab0 : JNZ 0x00417ad2
00417ab2 : SUB ESI,0x4
00417ab5 : CMP ESI,EDI
00417ab7 : JZ 0x00417ac1
00417ab9 : MOV ECX,dword ptr [EDI]
00417abb : MOV EAX,dword ptr [ESI]
00417abd : MOV dword ptr [ESI],ECX
00417abf : MOV dword ptr [EDI],EAX
00417ac1 : MOV EAX,dword ptr [EBP + -0x8]
00417ac4 : SUB EAX,0x4
00417ac7 : SUB EDI,0x4
00417aca : MOV dword ptr [EBP + -0x8],EAX
00417acd : CMP dword ptr [EBP + 0xc],EAX
00417ad0 : JC 0x00417a90
00417ad2 : MOV EAX,dword ptr [EBP + -0x8]
00417ad5 : MOV EDI,dword ptr [EBP + -0x4]
00417ad8 : CMP EAX,dword ptr [EBP + 0xc]
00417adb : JNZ 0x00417b2a
00417add : CMP EBX,dword ptr [EBP + 0x10]
00417ae0 : JZ 0x00417b7f
00417ae6 : CMP EDI,EBX
00417ae8 : JZ 0x00417af6
00417aea : CMP ESI,EDI
00417aec : JZ 0x00417af6
00417aee : MOV EDX,dword ptr [EDI]
00417af0 : MOV ECX,dword ptr [ESI]
00417af2 : MOV dword ptr [ESI],EDX
00417af4 : MOV dword ptr [EDI],ECX
00417af6 : MOV EDX,EBX
00417af8 : MOV ECX,ESI
00417afa : ADD EDI,0x4
00417afd : ADD EBX,0x4
00417b00 : ADD ESI,0x4
00417b03 : MOV dword ptr [EBP + -0x4],EDI
00417b06 : MOV dword ptr [EBP + -0xc],EDX
00417b09 : CMP ECX,EDX
00417b0b : JZ 0x00417a40
00417b11 : MOV EDX,dword ptr [ECX]
00417b13 : MOV dword ptr [EBP + -0x10],EDX
00417b16 : MOV EDX,dword ptr [EBP + -0xc]
00417b19 : MOV EDX,dword ptr [EDX]
00417b1b : MOV dword ptr [ECX],EDX
00417b1d : MOV ECX,dword ptr [EBP + -0x10]
00417b20 : MOV EDX,dword ptr [EBP + -0xc]
00417b23 : MOV dword ptr [EDX],ECX
00417b25 : JMP 0x00417a40
00417b2a : SUB EAX,0x4
00417b2d : MOV dword ptr [EBP + -0x8],EAX
00417b30 : CMP EBX,dword ptr [EBP + 0x10]
00417b33 : JNZ 0x00417b5f
00417b35 : SUB ESI,0x4
00417b38 : CMP EAX,ESI
00417b3a : JZ 0x00417b44
00417b3c : MOV EDX,dword ptr [ESI]
00417b3e : MOV ECX,dword ptr [EAX]
00417b40 : MOV dword ptr [EAX],EDX
00417b42 : MOV dword ptr [ESI],ECX
00417b44 : SUB EDI,0x4
00417b47 : MOV dword ptr [EBP + -0x4],EDI
00417b4a : CMP ESI,EDI
00417b4c : JZ 0x00417a40
00417b52 : MOV EDX,dword ptr [EDI]
00417b54 : MOV ECX,dword ptr [ESI]
00417b56 : MOV dword ptr [ESI],EDX
00417b58 : MOV dword ptr [EDI],ECX
00417b5a : JMP 0x00417a40
00417b5f : MOV ECX,EBX
00417b61 : ADD EBX,0x4
00417b64 : CMP ECX,EAX
00417b66 : JZ 0x00417a40
00417b6c : MOV EDX,dword ptr [ECX]
00417b6e : MOV dword ptr [EBP + -0x10],EDX
00417b71 : MOV EDX,dword ptr [EAX]
00417b73 : MOV dword ptr [ECX],EDX
00417b75 : MOV ECX,dword ptr [EBP + -0x10]
00417b78 : MOV dword ptr [EAX],ECX
00417b7a : JMP 0x00417a40
00417b7f : MOV EAX,dword ptr [EBP + 0x8]
00417b82 : MOV dword ptr [EAX + 0x4],EDI
00417b85 : POP EDI
00417b86 : MOV dword ptr [EAX],ESI
00417b88 : POP ESI
00417b89 : POP EBX
00417b8a : MOV ESP,EBP
00417b8c : POP EBP
00417b8d : RET

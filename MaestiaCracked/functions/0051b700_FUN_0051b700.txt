PROGRAM  : Maestia.exe
FUNCTION : FUN_0051b700
ENTRY    : 0051b700
BODY     : [[0051b700, 0051b75b]]

============================================================
DECOMPILED C CODE
============================================================

uint * FUN_0051b700(undefined4 param_1,uint param_2,uint param_3,void *param_4,size_t param_5)

{
  uint *puVar1;
  
  if (param_2 == 0) {
    InterlockedExchangeAdd((LONG *)&DAT_00d65134,1);
    puVar1 = (uint *)&DAT_00d65130;
  }
  else {
    puVar1 = (uint *)FUN_00515840(param_2 + 0xc,0);
    *(undefined1 *)((int)puVar1 + param_2 + 8) = 0;
    puVar1[1] = 1;
    *puVar1 = param_2 | param_3;
  }
  _memcpy(puVar1 + 2,param_4,param_5);
  return puVar1;
}



============================================================
DISASSEMBLY
============================================================
0051b700 : PUSH ESI
0051b701 : MOV ESI,dword ptr [ESP + 0xc]
0051b705 : TEST ESI,ESI
0051b707 : JNZ 0x0051b71d
0051b709 : PUSH 0x1
0051b70b : PUSH 0xd65134
0051b710 : CALL dword ptr [0x00b851cc]
0051b716 : MOV ESI,0xd65130
0051b71b : JMP 0x0051b740
0051b71d : MOV ECX,dword ptr [ESP + 0x8]
0051b721 : PUSH 0x0
0051b723 : LEA EAX,[ESI + 0xc]
0051b726 : PUSH EAX
0051b727 : CALL 0x00515840
0051b72c : MOV byte ptr [EAX + ESI*0x1 + 0x8],0x0
0051b731 : OR ESI,dword ptr [ESP + 0x10]
0051b735 : MOV dword ptr [EAX + 0x4],0x1
0051b73c : MOV dword ptr [EAX],ESI
0051b73e : MOV ESI,EAX
0051b740 : MOV ECX,dword ptr [ESP + 0x18]
0051b744 : MOV EDX,dword ptr [ESP + 0x14]
0051b748 : PUSH ECX
0051b749 : PUSH EDX
0051b74a : LEA EAX,[ESI + 0x8]
0051b74d : PUSH EAX
0051b74e : CALL 0x0063ae40
0051b753 : ADD ESP,0xc
0051b756 : MOV EAX,ESI
0051b758 : POP ESI
0051b759 : RET 0x14

PROGRAM  : Maestia.exe
FUNCTION : FUN_004d1aa0
ENTRY    : 004d1aa0
BODY     : [[004d1aa0, 004d1cbc]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_004d1aa0(undefined4 param_1,undefined4 param_2,undefined4 param_3,int param_4,
                 undefined4 param_5,char param_6)

{
  undefined4 uVar1;
  undefined4 *puVar2;
  int *in_ECX;
  undefined4 local_64;
  int local_60 [2];
  int local_58;
  undefined1 local_54 [4];
  undefined1 uStack_50;
  undefined4 uStack_40;
  uint uStack_3c;
  uint local_34;
  undefined4 local_24;
  uint local_20;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b81270;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)&local_64;
  ExceptionList = &local_14;
  local_64 = param_1;
  local_58 = param_4;
  if ((*(uint *)(param_4 + 0x10) & 0x4000) == 0) {
    (**(code **)(*in_ECX + 0x1c))
              (param_1,param_2,param_3,param_4,param_5,param_6,DAT_00d66fa0 ^ (uint)&stack0xffffff90
              );
  }
  else {
    uVar1 = FUN_004d0b70(local_60);
    local_c = 0;
    FUN_004d4090(uVar1);
    local_c = 0xffffffff;
    if ((local_60[0] != 0) && (puVar2 = (undefined4 *)FUN_00451810(), puVar2 != (undefined4 *)0x0))
    {
      (**(code **)*puVar2)(1);
    }
    local_20 = 0xf;
    local_24 = 0;
    local_34 = local_34 & 0xffffff00;
    local_c = 1;
    if (param_6 == '\0') {
      uVar1 = FUN_004d3840(local_54);
      local_c._0_1_ = 3;
    }
    else {
      uVar1 = FUN_004d38a0(local_54);
      local_c._0_1_ = 2;
    }
    FUN_00405110(uVar1,0,0xffffffff);
    local_c = CONCAT31(local_c._1_3_,1);
    if (0xf < uStack_3c) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    uStack_50 = 0;
    uStack_40 = 0;
    uStack_3c = 0xf;
    if ((*(uint *)(param_4 + 0x10) & 0x1c0) != 0x40) {
      FUN_004d37d0();
    }
    FUN_004d3760();
    *(undefined4 *)(local_58 + 0x18) = 0;
    FUN_004d37d0();
    local_c = 0xffffffff;
    if (0xf < local_20) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_20 = 0xf;
    local_24 = 0;
    local_34 = local_34 & 0xffffff00;
  }
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)&local_64);
  return;
}



============================================================
DISASSEMBLY
============================================================
004d1aa0 : PUSH EBP
004d1aa1 : MOV EBP,ESP
004d1aa3 : AND ESP,0xfffffff8
004d1aa6 : PUSH -0x1
004d1aa8 : PUSH 0xb81270
004d1aad : MOV EAX,FS:[0x0]
004d1ab3 : PUSH EAX
004d1ab4 : SUB ESP,0x50
004d1ab7 : MOV EAX,[0x00d66fa0]
004d1abc : XOR EAX,ESP
004d1abe : MOV dword ptr [ESP + 0x48],EAX
004d1ac2 : PUSH EBX
004d1ac3 : PUSH ESI
004d1ac4 : PUSH EDI
004d1ac5 : MOV EAX,[0x00d66fa0]
004d1aca : XOR EAX,ESP
004d1acc : PUSH EAX
004d1acd : LEA EAX,[ESP + 0x60]
004d1ad1 : MOV FS:[0x0],EAX
004d1ad7 : MOV EBX,dword ptr [EBP + 0x14]
004d1ada : TEST dword ptr [EBX + 0x10],0x4000
004d1ae1 : MOV ESI,dword ptr [EBP + 0x8]
004d1ae4 : MOV EDI,ECX
004d1ae6 : MOV dword ptr [ESP + 0x10],ESI
004d1aea : MOV dword ptr [ESP + 0x1c],EBX
004d1aee : JNZ 0x004d1b11
004d1af0 : MOVZX ECX,byte ptr [EBP + 0x1c]
004d1af4 : MOV EDX,dword ptr [EBP + 0x18]
004d1af7 : MOV EAX,dword ptr [EDI]
004d1af9 : MOV EAX,dword ptr [EAX + 0x1c]
004d1afc : PUSH ECX
004d1afd : MOV ECX,dword ptr [EBP + 0x10]
004d1b00 : PUSH EDX
004d1b01 : MOV EDX,dword ptr [EBP + 0xc]
004d1b04 : PUSH EBX
004d1b05 : PUSH ECX
004d1b06 : PUSH EDX
004d1b07 : PUSH ESI
004d1b08 : MOV ECX,EDI
004d1b0a : CALL EAX
004d1b0c : JMP 0x004d1c9b
004d1b11 : LEA ECX,[ESP + 0x14]
004d1b15 : PUSH ECX
004d1b16 : MOV ECX,EBX
004d1b18 : CALL 0x004d0b70
004d1b1d : MOV dword ptr [ESP + 0x68],0x0
004d1b25 : PUSH EAX
004d1b26 : CALL 0x004d4090
004d1b2b : ADD ESP,0x4
004d1b2e : MOV ESI,EAX
004d1b30 : MOV dword ptr [ESP + 0x68],0xffffffff
004d1b38 : MOV ECX,dword ptr [ESP + 0x14]
004d1b3c : TEST ECX,ECX
004d1b3e : JZ 0x004d1b53
004d1b40 : CALL 0x00451810
004d1b45 : TEST EAX,EAX
004d1b47 : JZ 0x004d1b53
004d1b49 : MOV EDX,dword ptr [EAX]
004d1b4b : MOV ECX,EAX
004d1b4d : MOV EAX,dword ptr [EDX]
004d1b4f : PUSH 0x1
004d1b51 : CALL EAX
004d1b53 : MOV dword ptr [ESP + 0x54],0xf
004d1b5b : MOV dword ptr [ESP + 0x50],0x0
004d1b63 : MOV byte ptr [ESP + 0x40],0x0
004d1b68 : MOV dword ptr [ESP + 0x68],0x1
004d1b70 : CMP byte ptr [EBP + 0x1c],0x0
004d1b74 : JZ 0x004d1b89
004d1b76 : LEA ECX,[ESP + 0x20]
004d1b7a : PUSH ECX
004d1b7b : MOV ECX,ESI
004d1b7d : CALL 0x004d38a0
004d1b82 : MOV byte ptr [ESP + 0x68],0x2
004d1b87 : JMP 0x004d1b9a
004d1b89 : LEA EDX,[ESP + 0x20]
004d1b8d : PUSH EDX
004d1b8e : MOV ECX,ESI
004d1b90 : CALL 0x004d3840
004d1b95 : MOV byte ptr [ESP + 0x68],0x3
004d1b9a : PUSH -0x1
004d1b9c : PUSH 0x0
004d1b9e : PUSH EAX
004d1b9f : LEA ECX,[ESP + 0x48]
004d1ba3 : CALL 0x00405110
004d1ba8 : MOV byte ptr [ESP + 0x68],0x1
004d1bad : CMP dword ptr [ESP + 0x38],0x10
004d1bb2 : JC 0x004d1bbd
004d1bb4 : MOV ECX,dword ptr [ESP + 0x24]
004d1bb8 : CALL 0x006f04e0
004d1bbd : MOV EAX,dword ptr [EBX + 0x18]
004d1bc0 : MOV ECX,dword ptr [ESP + 0x50]
004d1bc4 : MOV byte ptr [ESP + 0x24],0x0
004d1bc9 : MOV dword ptr [ESP + 0x34],0x0
004d1bd1 : MOV dword ptr [ESP + 0x38],0xf
004d1bd9 : TEST EAX,EAX
004d1bdb : JLE 0x004d1be7
004d1bdd : CMP EAX,ECX
004d1bdf : JBE 0x004d1be7
004d1be1 : SUB EAX,ECX
004d1be3 : MOV ESI,EAX
004d1be5 : JMP 0x004d1be9
004d1be7 : XOR ESI,ESI
004d1be9 : MOV EAX,dword ptr [EBX + 0x10]
004d1bec : MOV EBX,dword ptr [EBP + 0x18]
004d1bef : AND EAX,0x1c0
004d1bf4 : CMP EAX,0x40
004d1bf7 : JZ 0x004d1c22
004d1bf9 : MOV EAX,dword ptr [EBP + 0x10]
004d1bfc : MOV ECX,dword ptr [EBP + 0xc]
004d1bff : PUSH ESI
004d1c00 : PUSH EBX
004d1c01 : PUSH EAX
004d1c02 : PUSH ECX
004d1c03 : LEA EDX,[ESP + 0x24]
004d1c07 : PUSH EDX
004d1c08 : PUSH EDI
004d1c09 : CALL 0x004d37d0
004d1c0e : MOV ECX,dword ptr [EAX]
004d1c10 : MOV dword ptr [EBP + 0xc],ECX
004d1c13 : MOV EDX,dword ptr [EAX + 0x4]
004d1c16 : MOV ECX,dword ptr [ESP + 0x68]
004d1c1a : ADD ESP,0x18
004d1c1d : MOV dword ptr [EBP + 0x10],EDX
004d1c20 : XOR ESI,ESI
004d1c22 : CMP dword ptr [ESP + 0x54],0x10
004d1c27 : MOV EAX,dword ptr [ESP + 0x40]
004d1c2b : JNC 0x004d1c31
004d1c2d : LEA EAX,[ESP + 0x40]
004d1c31 : PUSH ECX
004d1c32 : MOV ECX,dword ptr [EBP + 0xc]
004d1c35 : PUSH EAX
004d1c36 : MOV EAX,dword ptr [EBP + 0x10]
004d1c39 : PUSH EAX
004d1c3a : PUSH ECX
004d1c3b : LEA EDX,[ESP + 0x24]
004d1c3f : PUSH EDX
004d1c40 : PUSH EDI
004d1c41 : CALL 0x004d3760
004d1c46 : MOV ECX,dword ptr [EAX]
004d1c48 : MOV EDX,dword ptr [ESP + 0x34]
004d1c4c : PUSH ESI
004d1c4d : MOV ESI,dword ptr [ESP + 0x2c]
004d1c51 : PUSH EBX
004d1c52 : MOV dword ptr [EBP + 0xc],ECX
004d1c55 : MOV EAX,dword ptr [EAX + 0x4]
004d1c58 : PUSH EAX
004d1c59 : PUSH ECX
004d1c5a : PUSH ESI
004d1c5b : PUSH EDI
004d1c5c : MOV dword ptr [EBP + 0x10],EAX
004d1c5f : MOV dword ptr [EDX + 0x18],0x0
004d1c66 : CALL 0x004d37d0
004d1c6b : ADD ESP,0x30
004d1c6e : MOV dword ptr [ESP + 0x68],0xffffffff
004d1c76 : CMP dword ptr [ESP + 0x54],0x10
004d1c7b : JC 0x004d1c86
004d1c7d : MOV ECX,dword ptr [ESP + 0x40]
004d1c81 : CALL 0x006f04e0
004d1c86 : MOV dword ptr [ESP + 0x54],0xf
004d1c8e : MOV dword ptr [ESP + 0x50],0x0
004d1c96 : MOV byte ptr [ESP + 0x40],0x0
004d1c9b : MOV EAX,ESI
004d1c9d : MOV ECX,dword ptr [ESP + 0x60]
004d1ca1 : MOV dword ptr FS:[0x0],ECX
004d1ca8 : POP ECX
004d1ca9 : POP EDI
004d1caa : POP ESI
004d1cab : POP EBX
004d1cac : MOV ECX,dword ptr [ESP + 0x48]
004d1cb0 : XOR ECX,ESP
004d1cb2 : CALL 0x00633e6b
004d1cb7 : MOV ESP,EBP
004d1cb9 : POP EBP
004d1cba : RET 0x18

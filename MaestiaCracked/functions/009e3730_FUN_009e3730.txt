PROGRAM  : Maestia.exe
FUNCTION : FUN_009e3730
ENTRY    : 009e3730
BODY     : [[009e3730, 009e395f] [009e39ed, 009e3a15] [009e3a1d, 009e3a60] [009e3af1, 009e3b16]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_009e3730(int param_1)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  uint uStack_120;
  undefined1 local_b8 [8];
  undefined1 local_b0 [12];
  undefined2 local_a4;
  undefined4 local_94;
  uint local_90;
  undefined2 local_7c [2];
  int local_78;
  undefined4 local_74;
  int local_70;
  undefined2 local_6c [2];
  int local_68;
  int local_64;
  int local_60;
  undefined2 *local_5c;
  int local_58;
  int local_54;
  int local_50;
  int local_4c;
  int local_48;
  int local_44;
  int local_40;
  int local_3c;
  undefined1 local_38 [4];
  undefined2 uStack_34;
  undefined4 uStack_24;
  uint uStack_20;
  uint local_1c;
  undefined1 *local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4eea4;
  local_10 = ExceptionList;
  uStack_120 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_14 = (undefined1 *)&uStack_120;
  ExceptionList = &local_10;
  local_64 = param_1;
  local_60 = 0;
  local_1c = uStack_120;
  while( true ) {
    while( true ) {
      if (0xfffe < local_60) {
        ExceptionList = local_10;
        __security_check_cookie(local_1c ^ (uint)&stack0xfffffffc);
        return;
      }
      iVar1 = FUN_00703c00(0x700);
      if ((iVar1 != 0) && (local_5c = (undefined2 *)(iVar1 + 4), *(char *)(iVar1 + 5) == '\a'))
      break;
      local_60 = local_60 + 1;
    }
    FUN_0040eef0(iVar1 + 0x18);
    local_8 = 0;
    FUN_00824120(DAT_0172491c);
    local_8 = CONCAT31(local_8._1_3_,2);
    if (7 < local_90) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_90 = 7;
    local_94 = 0;
    local_a4 = 0;
    local_44 = 0;
    local_40 = 0;
    local_8._0_1_ = 3;
    local_3c = FUN_006f0300(0x24);
    local_8._0_1_ = 4;
    if (local_3c == 0) {
      local_54 = 0;
    }
    else {
      local_54 = FUN_00418f50(local_3c,*(undefined2 *)(iVar1 + 6),local_38);
    }
    iVar3 = local_54;
    local_8._0_1_ = 3;
    local_44 = local_54;
    local_3c = FUN_006f0300(0x24);
    local_8 = CONCAT31(local_8._1_3_,5);
    if (local_3c == 0) {
      local_48 = 0;
    }
    else {
      local_48 = FUN_00418f50(local_3c,*(undefined2 *)(iVar1 + 6),local_38);
    }
    iVar4 = local_48;
    iVar1 = local_64;
    local_8 = 2;
    local_3c = local_64 + 0x10;
    local_40 = local_48;
    FUN_00413b60(local_5c);
    if (local_4c == *(int *)(iVar1 + 0x14)) {
      local_50 = 0;
      local_8 = CONCAT31(local_8._1_3_,8);
      local_70 = FUN_006f0300(0x10);
      if (local_70 == 0) {
        iVar3 = 0;
      }
      else {
        *(undefined4 *)(local_70 + 4) = 0;
        *(undefined4 *)(local_70 + 8) = 0;
        *(undefined4 *)(local_70 + 0xc) = 0;
        iVar3 = local_70;
      }
      local_8 = 2;
      iVar4 = local_48;
      local_50 = iVar3;
      if ((iVar3 != 0) && (local_54 != 0)) {
        FUN_00449610();
        local_6c[0] = *local_5c;
        local_68 = iVar3;
        FUN_0041ed30(local_b8,local_6c);
        iVar4 = local_48;
      }
    }
    else if (*(int *)(local_4c + 0x10) == 0) {
      if (iVar3 != 0) {
        FUN_00414770(iVar3);
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
    }
    else {
      FUN_00449610();
    }
    local_4c = 0;
    piVar2 = (int *)FUN_00413b60(&local_4c);
    local_4c = *piVar2;
    if (local_4c == *(int *)(iVar1 + 0x14)) break;
    if (*(int *)(local_4c + 0x10) != 0) {
      FUN_00449610();
      FUN_009e3b17();
      return;
    }
    if (iVar4 != 0) {
      FUN_00414770(iVar4);
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_8 = 0xffffffff;
    if (7 < uStack_20) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    uStack_20 = 7;
    uStack_24 = 0;
    uStack_34 = 0;
    local_60 = local_60 + 1;
  }
  local_58 = 0;
  local_8._0_1_ = 0xc;
  local_70 = FUN_006f0300(0x10);
  if (local_70 == 0) {
    iVar1 = 0;
  }
  else {
    *(undefined4 *)(local_70 + 4) = 0;
    *(undefined4 *)(local_70 + 8) = 0;
    *(undefined4 *)(local_70 + 0xc) = 0;
    iVar1 = local_70;
  }
  local_8 = CONCAT31(local_8._1_3_,0xc);
  local_58 = iVar1;
  FUN_00449610();
  local_74 = 0;
  local_7c[0] = 0;
  local_78 = iVar1;
  FUN_0041ed30(local_b0,local_7c);
  local_8 = 2;
  FUN_009e3b17();
  return;
}



============================================================
DISASSEMBLY
============================================================
009e3730 : PUSH EBP
009e3731 : MOV EBP,ESP
009e3733 : PUSH -0x1
009e3735 : PUSH 0xb4eea4
009e373a : MOV EAX,FS:[0x0]
009e3740 : PUSH EAX
009e3741 : SUB ESP,0x100
009e3747 : MOV EAX,[0x00d66fa0]
009e374c : XOR EAX,EBP
009e374e : MOV dword ptr [EBP + -0x18],EAX
009e3751 : PUSH EBX
009e3752 : PUSH ESI
009e3753 : PUSH EDI
009e3754 : PUSH EAX
009e3755 : LEA EAX,[EBP + -0xc]
009e3758 : MOV FS:[0x0],EAX
009e375e : MOV dword ptr [EBP + -0x10],ESP
009e3761 : MOV EAX,dword ptr [EBP + 0x8]
009e3764 : MOV dword ptr [EBP + -0x60],EAX
009e3767 : XOR EDI,EDI
009e3769 : MOV dword ptr [EBP + -0x5c],EDI
009e376c : CMP EDI,0xffff
009e3772 : JGE 0x009e3bff
009e3778 : PUSH 0x700
009e377d : CALL 0x00703c00
009e3782 : ADD ESP,0x4
009e3785 : MOV EBX,EAX
009e3787 : TEST EBX,EBX
009e3789 : JZ 0x009e3bf6
009e378f : LEA EAX,[EBX + 0x4]
009e3792 : MOV dword ptr [EBP + -0x58],EAX
009e3795 : CMP byte ptr [EAX + 0x1],0x7
009e3799 : JNZ 0x009e3bf6
009e379f : LEA ECX,[EBX + 0x18]
009e37a2 : PUSH ECX
009e37a3 : LEA ESI,[EBP + 0xffffff5c]
009e37a9 : CALL 0x0040eef0
009e37ae : ADD ESP,0x4
009e37b1 : XOR ESI,ESI
009e37b3 : MOV dword ptr [EBP + -0x4],ESI
009e37b6 : MOV EDX,dword ptr [0x0172491c]
009e37bc : PUSH EDX
009e37bd : MOV EDX,EAX
009e37bf : LEA EDI,[EBP + -0x34]
009e37c2 : CALL 0x00824120
009e37c7 : MOV byte ptr [EBP + -0x4],0x2
009e37cb : CMP dword ptr [EBP + 0xffffff74],0x8
009e37d2 : JC 0x009e37df
009e37d4 : MOV ECX,dword ptr [EBP + 0xffffff60]
009e37da : CALL 0x006f04e0
009e37df : MOV dword ptr [EBP + 0xffffff74],0x7
009e37e9 : MOV dword ptr [EBP + 0xffffff70],ESI
009e37ef : XOR EAX,EAX
009e37f1 : MOV word ptr [EBP + 0xffffff60],AX
009e37f8 : MOV dword ptr [EBP + -0x40],ESI
009e37fb : MOV dword ptr [EBP + -0x3c],ESI
009e37fe : MOV byte ptr [EBP + -0x4],0x3
009e3802 : PUSH 0x24
009e3804 : CALL 0x006f0300
009e3809 : ADD ESP,0x4
009e380c : MOV dword ptr [EBP + -0x38],EAX
009e380f : MOV byte ptr [EBP + -0x4],0x4
009e3813 : CMP EAX,ESI
009e3815 : JZ 0x009e382d
009e3817 : LEA ECX,[EBP + -0x34]
009e381a : PUSH ECX
009e381b : MOVZX EDX,word ptr [EBX + 0x6]
009e381f : PUSH EDX
009e3820 : PUSH EAX
009e3821 : CALL 0x00418f50
009e3826 : MOV EDI,EAX
009e3828 : MOV dword ptr [EBP + -0x50],EDI
009e382b : JMP 0x009e3832
009e382d : MOV dword ptr [EBP + -0x50],ESI
009e3830 : MOV EDI,ESI
009e3832 : MOV byte ptr [EBP + -0x4],0x3
009e3836 : MOV dword ptr [EBP + -0x40],EDI
009e3839 : PUSH 0x24
009e383b : CALL 0x006f0300
009e3840 : ADD ESP,0x4
009e3843 : MOV dword ptr [EBP + -0x38],EAX
009e3846 : MOV byte ptr [EBP + -0x4],0x5
009e384a : CMP EAX,ESI
009e384c : JZ 0x009e3864
009e384e : LEA ECX,[EBP + -0x34]
009e3851 : PUSH ECX
009e3852 : MOVZX EDX,word ptr [EBX + 0x6]
009e3856 : PUSH EDX
009e3857 : PUSH EAX
009e3858 : CALL 0x00418f50
009e385d : MOV EBX,EAX
009e385f : MOV dword ptr [EBP + -0x44],EBX
009e3862 : JMP 0x009e3869
009e3864 : MOV dword ptr [EBP + -0x44],ESI
009e3867 : MOV EBX,ESI
009e3869 : MOV byte ptr [EBP + -0x4],0x3
009e386d : MOV dword ptr [EBP + -0x3c],EBX
009e3870 : MOV dword ptr [EBP + -0x4],0x2
009e3877 : MOV ESI,dword ptr [EBP + -0x60]
009e387a : LEA ECX,[ESI + 0x10]
009e387d : MOV dword ptr [EBP + -0x38],ECX
009e3880 : MOV EAX,dword ptr [EBP + -0x58]
009e3883 : PUSH EAX
009e3884 : LEA EAX,[EBP + -0x48]
009e3887 : CALL 0x00413b60
009e388c : MOV EAX,dword ptr [ESI + 0x14]
009e388f : MOV ECX,dword ptr [EBP + -0x48]
009e3892 : CMP ECX,EAX
009e3894 : JNZ 0x009e39ed
009e389a : XOR EDI,EDI
009e389c : MOV dword ptr [EBP + -0x4c],EDI
009e389f : MOV byte ptr [EBP + -0x4],0x8
009e38a3 : PUSH 0x10
009e38a5 : CALL 0x006f0300
009e38aa : ADD ESP,0x4
009e38ad : MOV dword ptr [EBP + -0x6c],EAX
009e38b0 : MOV byte ptr [EBP + -0x4],0x9
009e38b4 : CMP EAX,EDI
009e38b6 : JZ 0x009e38c5
009e38b8 : MOV dword ptr [EAX + 0x4],EDI
009e38bb : MOV dword ptr [EAX + 0x8],EDI
009e38be : MOV dword ptr [EAX + 0xc],EDI
009e38c1 : MOV EBX,EAX
009e38c3 : JMP 0x009e38c7
009e38c5 : XOR EBX,EBX
009e38c7 : MOV byte ptr [EBP + -0x4],0x8
009e38cb : MOV dword ptr [EBP + -0x4c],EBX
009e38ce : MOV dword ptr [EBP + -0x4],0x2
009e38d5 : CMP EBX,EDI
009e38d7 : JZ 0x009e390a
009e38d9 : CMP dword ptr [EBP + -0x50],EDI
009e38dc : JZ 0x009e390a
009e38de : LEA EDI,[EBP + -0x40]
009e38e1 : MOV EDX,EBX
009e38e3 : CALL 0x00449610
009e38e8 : MOV ECX,dword ptr [EBP + -0x58]
009e38eb : MOV DX,word ptr [ECX]
009e38ee : MOV word ptr [EBP + -0x68],DX
009e38f2 : MOV dword ptr [EBP + -0x64],EBX
009e38f5 : LEA EAX,[EBP + -0x68]
009e38f8 : PUSH EAX
009e38f9 : LEA ECX,[EBP + 0xffffff4c]
009e38ff : PUSH ECX
009e3900 : MOV EAX,dword ptr [EBP + -0x38]
009e3903 : CALL 0x0041ed30
009e3908 : XOR EDI,EDI
009e390a : MOV EBX,dword ptr [EBP + -0x44]
009e390d : MOV dword ptr [EBP + -0x48],EDI
009e3910 : LEA EAX,[EBP + -0x48]
009e3913 : PUSH EAX
009e3914 : LEA EAX,[EBP + 0xffffff7c]
009e391a : MOV ECX,dword ptr [EBP + -0x38]
009e391d : CALL 0x00413b60
009e3922 : MOV EAX,dword ptr [EAX]
009e3924 : MOV dword ptr [EBP + -0x48],EAX
009e3927 : CMP EAX,dword ptr [ESI + 0x14]
009e392a : JNZ 0x009e3af1
009e3930 : MOV dword ptr [EBP + -0x54],EDI
009e3933 : MOV byte ptr [EBP + -0x4],0xc
009e3937 : PUSH 0x10
009e3939 : CALL 0x006f0300
009e393e : ADD ESP,0x4
009e3941 : MOV dword ptr [EBP + -0x6c],EAX
009e3944 : MOV byte ptr [EBP + -0x4],0xd
009e3948 : CMP EAX,EDI
009e394a : JZ 0x009e3a1d
009e3950 : MOV dword ptr [EAX + 0x4],EDI
009e3953 : MOV dword ptr [EAX + 0x8],EDI
009e3956 : MOV dword ptr [EAX + 0xc],EDI
009e3959 : MOV EBX,EAX
009e395b : JMP 0x009e3a1f
009e39ed : MOV ECX,dword ptr [ECX + 0x10]
009e39f0 : TEST ECX,ECX
009e39f2 : JZ 0x009e3a05
009e39f4 : LEA EDI,[EBP + -0x40]
009e39f7 : MOV EDX,ECX
009e39f9 : CALL 0x00449610
009e39fe : XOR EDI,EDI
009e3a00 : JMP 0x009e390d
009e3a05 : TEST EDI,EDI
009e3a07 : JZ 0x009e39fe
009e3a09 : PUSH EDI
009e3a0a : CALL 0x00414770
009e3a0f : MOV ECX,EDI
009e3a11 : CALL 0x006f04e0
009e3a1d : XOR EBX,EBX
009e3a1f : MOV byte ptr [EBP + -0x4],0xc
009e3a23 : MOV dword ptr [EBP + -0x54],EBX
009e3a26 : LEA EDI,[EBP + -0x3c]
009e3a29 : MOV EDX,EBX
009e3a2b : CALL 0x00449610
009e3a30 : MOV dword ptr [EBP + -0x70],0x0
009e3a37 : XOR ECX,ECX
009e3a39 : MOV word ptr [EBP + -0x78],CX
009e3a3d : MOV dword ptr [EBP + -0x74],EBX
009e3a40 : LEA EDX,[EBP + -0x78]
009e3a43 : PUSH EDX
009e3a44 : LEA EAX,[EBP + 0xffffff54]
009e3a4a : PUSH EAX
009e3a4b : MOV EAX,dword ptr [EBP + -0x38]
009e3a4e : CALL 0x0041ed30
009e3a53 : MOV dword ptr [EBP + -0x4],0x2
009e3a5a : XOR EDI,EDI
009e3a5c : JMP 0x009e3b17
009e3af1 : MOV EAX,dword ptr [EAX + 0x10]
009e3af4 : CMP EAX,EDI
009e3af6 : JZ 0x009e3b06
009e3af8 : LEA EDI,[EBP + -0x3c]
009e3afb : MOV EDX,EAX
009e3afd : CALL 0x00449610
009e3b02 : XOR EDI,EDI
009e3b04 : JMP 0x009e3b17
009e3b06 : CMP EBX,EDI
009e3b08 : JZ 0x009e3b17
009e3b0a : PUSH EBX
009e3b0b : CALL 0x00414770
009e3b10 : MOV ECX,EBX
009e3b12 : CALL 0x006f04e0

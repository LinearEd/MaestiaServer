PROGRAM  : Maestia.exe
FUNCTION : FUN_00514280
ENTRY    : 00514280
BODY     : [[00514280, 005143d7]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00514280(void)

{
  GRefCountNTSImpl *this;
  int iVar1;
  undefined4 uVar2;
  int in_ECX;
  GRefCountNTSImpl *this_00;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  GRefCountNTSImpl *local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  undefined1 local_4;
  
  iVar1 = *(int *)(in_ECX + 0x10);
  uVar2 = *(undefined4 *)(*(int *)(iVar1 + 0x38) + 0x28);
  this_00 = (GRefCountNTSImpl *)0x0;
  this = (GRefCountNTSImpl *)
         FUN_005a2450(*(undefined4 *)(in_ECX + 0x1c),*(undefined4 *)(in_ECX + 0x20),1,
                      *(undefined4 *)(iVar1 + 0xc),*(undefined4 *)(iVar1 + 0x24),
                      *(undefined4 *)(iVar1 + 0x2c),uVar2);
  if (this != (GRefCountNTSImpl *)0x0) {
    iVar1 = *(int *)(in_ECX + 0x10);
    local_18 = *(undefined4 *)(iVar1 + 0x20);
    local_30 = 1;
    local_28 = 0;
    local_2c = 0;
    local_24 = 1;
    local_1c = 0;
    local_14 = 0;
    local_10 = 0;
    local_c = 0;
    if ((*(char *)(iVar1 + 0x44) != '\0') || (local_4 = 0, *(int *)(iVar1 + 0x18) != 0)) {
      local_4 = 1;
    }
    local_20 = this;
    local_8 = uVar2;
    this_00 = (GRefCountNTSImpl *)
              (**(code **)(**(int **)(*(int *)(iVar1 + 8) + 0x10) + 4))(&local_30);
    if (this_00 != (GRefCountNTSImpl *)0x0) {
      iVar1 = FUN_00515840(0x1c,0);
      if (iVar1 == 0) {
        uVar2 = 0;
      }
      else {
        uVar2 = FUN_00513610(this_00,1);
      }
      if (*(int *)(in_ECX + 0x24) != 0) {
        FUN_00524240();
      }
      *(undefined4 *)(in_ECX + 0x24) = uVar2;
    }
  }
  iVar1 = *(int *)(in_ECX + 0x24);
  if (iVar1 == 0) {
    uVar2 = 4;
  }
  else {
    uVar2 = (**(code **)(**(int **)(in_ECX + 0x1c) + 0x18))();
    FUN_00567910(uVar2,iVar1,1);
    uVar2 = (**(code **)(**(int **)(in_ECX + 0x14) + 0x40))
                      (*(undefined4 *)((*(int **)(in_ECX + 0x14))[8] + 0x28));
    FUN_00562e40(uVar2);
    uVar2 = 0x302;
  }
  FUN_00561ad0(uVar2);
  if (this_00 != (GRefCountNTSImpl *)0x0) {
    GRefCountNTSImpl::Release(this_00);
  }
  if (this == (GRefCountNTSImpl *)0x0) {
    return;
  }
  GRefCountNTSImpl::Release(this);
  return;
}



============================================================
DISASSEMBLY
============================================================
00514280 : SUB ESP,0x34
00514283 : PUSH EBX
00514284 : PUSH EBP
00514285 : PUSH ESI
00514286 : MOV ESI,ECX
00514288 : MOV EAX,dword ptr [ESI + 0x10]
0051428b : MOV ECX,dword ptr [EAX + 0x38]
0051428e : MOV EDX,dword ptr [EAX + 0x24]
00514291 : MOV EBP,dword ptr [ESI + 0x1c]
00514294 : PUSH EDI
00514295 : MOV EDI,dword ptr [ECX + 0x28]
00514298 : MOV ECX,dword ptr [EAX + 0x2c]
0051429b : MOV EAX,dword ptr [EAX + 0xc]
0051429e : PUSH EDI
0051429f : PUSH ECX
005142a0 : PUSH EDX
005142a1 : MOV EDX,dword ptr [ESI + 0x20]
005142a4 : PUSH EAX
005142a5 : PUSH 0x1
005142a7 : PUSH EDX
005142a8 : PUSH EBP
005142a9 : XOR EBX,EBX
005142ab : CALL 0x005a2450
005142b0 : MOV ECX,EAX
005142b2 : XOR EDX,EDX
005142b4 : ADD ESP,0x1c
005142b7 : MOV dword ptr [ESP + 0x10],ECX
005142bb : CMP ECX,EDX
005142bd : JZ 0x0051435c
005142c3 : MOV EAX,dword ptr [ESI + 0x10]
005142c6 : MOV EBX,dword ptr [EAX + 0x20]
005142c9 : MOV EBP,0x1
005142ce : MOV dword ptr [ESP + 0x14],EBP
005142d2 : MOV dword ptr [ESP + 0x24],ECX
005142d6 : MOV dword ptr [ESP + 0x1c],EDX
005142da : MOV dword ptr [ESP + 0x18],EDX
005142de : MOV dword ptr [ESP + 0x20],EBP
005142e2 : MOV dword ptr [ESP + 0x28],EDX
005142e6 : MOV dword ptr [ESP + 0x30],EDX
005142ea : MOV dword ptr [ESP + 0x34],EDX
005142ee : MOV dword ptr [ESP + 0x38],EDX
005142f2 : MOV dword ptr [ESP + 0x2c],EBX
005142f6 : MOV dword ptr [ESP + 0x3c],EDX
005142fa : MOV byte ptr [ESP + 0x40],DL
005142fe : CMP byte ptr [EAX + 0x44],DL
00514301 : JNZ 0x0051430c
00514303 : CMP dword ptr [EAX + 0x18],EDX
00514306 : MOV byte ptr [ESP + 0x40],DL
0051430a : JZ 0x00514311
0051430c : MOV byte ptr [ESP + 0x40],0x1
00514311 : MOV dword ptr [ESP + 0x3c],EDI
00514315 : MOV ECX,dword ptr [EAX + 0x8]
00514318 : MOV ECX,dword ptr [ECX + 0x10]
0051431b : MOV EDX,dword ptr [ECX]
0051431d : MOV EDX,dword ptr [EDX + 0x4]
00514320 : LEA EAX,[ESP + 0x14]
00514324 : PUSH EAX
00514325 : CALL EDX
00514327 : MOV EBX,EAX
00514329 : TEST EBX,EBX
0051432b : JZ 0x0051435a
0051432d : PUSH 0x0
0051432f : PUSH 0x1c
00514331 : MOV ECX,EDI
00514333 : CALL 0x00515840
00514338 : TEST EAX,EAX
0051433a : JZ 0x00514349
0051433c : PUSH EBP
0051433d : PUSH EBX
0051433e : MOV ECX,EAX
00514340 : CALL 0x00513610
00514345 : MOV EDI,EAX
00514347 : JMP 0x0051434b
00514349 : XOR EDI,EDI
0051434b : MOV ECX,dword ptr [ESI + 0x24]
0051434e : TEST ECX,ECX
00514350 : JZ 0x00514357
00514352 : CALL 0x00524240
00514357 : MOV dword ptr [ESI + 0x24],EDI
0051435a : XOR EDX,EDX
0051435c : MOV EBP,dword ptr [ESI + 0x24]
0051435f : CMP EBP,EDX
00514361 : JZ 0x005143a8
00514363 : MOV ECX,dword ptr [ESI + 0x1c]
00514366 : MOV EAX,dword ptr [ECX]
00514368 : MOV EDX,dword ptr [EAX + 0x18]
0051436b : MOV EDI,dword ptr [ESI + 0x14]
0051436e : CALL EDX
00514370 : MOV ECX,dword ptr [EDI + 0x20]
00514373 : PUSH 0x1
00514375 : PUSH EBP
00514376 : PUSH EAX
00514377 : CALL 0x00567910
0051437c : MOV ECX,dword ptr [ESI + 0x14]
0051437f : MOV EAX,dword ptr [ECX + 0x20]
00514382 : MOV EAX,dword ptr [EAX + 0x28]
00514385 : MOV EDX,dword ptr [ESI + 0x18]
00514388 : MOV EDI,dword ptr [EDX + 0x1c]
0051438b : PUSH EAX
0051438c : MOV EAX,dword ptr [ECX]
0051438e : MOV EDX,dword ptr [EAX + 0x40]
00514391 : CALL EDX
00514393 : PUSH EAX
00514394 : MOV ECX,EDI
00514396 : CALL 0x00562e40
0051439b : MOV EAX,dword ptr [ESI + 0x18]
0051439e : MOV ECX,dword ptr [EAX + 0x1c]
005143a1 : PUSH 0x302
005143a6 : JMP 0x005143b0
005143a8 : MOV ECX,dword ptr [ESI + 0x18]
005143ab : MOV ECX,dword ptr [ECX + 0x1c]
005143ae : PUSH 0x4
005143b0 : CALL 0x00561ad0
005143b5 : TEST EBX,EBX
005143b7 : JZ 0x005143c0
005143b9 : MOV ECX,EBX
005143bb : CALL 0x004ff7c0
005143c0 : MOV ECX,dword ptr [ESP + 0x10]
005143c4 : POP EDI
005143c5 : POP ESI
005143c6 : POP EBP
005143c7 : POP EBX
005143c8 : TEST ECX,ECX
005143ca : JZ 0x005143d4
005143cc : ADD ESP,0x34
005143cf : JMP 0x004ff7c0
005143d4 : ADD ESP,0x34
005143d7 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_0084ceb0
ENTRY    : 0084ceb0
BODY     : [[0084ceb0, 0084d054]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0084ceb0(int *param_1,int *param_2)

{
  int *piVar1;
  undefined4 uVar2;
  int *piVar3;
  int iVar4;
  uint uVar5;
  int *in_ECX;
  int local_1b4 [100];
  LPCRITICAL_SECTION local_24;
  char *local_20;
  undefined4 local_1c;
  int local_18;
  undefined4 local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  uVar2 = param_1;
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b1b98e;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  if (in_ECX[0x17] == 0) {
    FUN_008018d0(L"[AvaPlayerPart::AttachMeshBasicNode] Add a mesh node does not exist can not create mesh item."
                 ,DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
  }
  else {
    if (param_2 != (int *)0x0) {
      (**(code **)(*in_ECX + 0xc))(1);
    }
    FUN_00405eb0(uVar2,0,0xffffffff);
    iVar4 = FUN_00405bb0(&DAT_00c3cafc);
    if (iVar4 != 0) {
      local_24 = (LPCRITICAL_SECTION)(in_ECX + 4);
      local_18 = 0;
      local_20 = ".\\Objects\\AvaPlayerParts.cpp";
      local_1c = 0x177;
      local_14 = 1;
      FUN_006ef1a0(&local_24);
      local_8 = 0;
      *(undefined1 *)(in_ECX[0x17] + 0x2a1) = 1;
      (**(code **)(*(int *)in_ECX[0x17] + 0xe8))(uVar2,0,0,0,0,0,0);
      param_1 = (int *)0x0;
      FUN_007d38e0(&param_1);
      if (param_1 != (int *)0x0) {
        param_2 = param_1;
        param_1 = local_1b4;
        do {
          piVar3 = param_1;
          iVar4 = in_ECX[0x2f];
          if (iVar4 == 0) {
            uVar5 = 0;
          }
          else {
            uVar5 = in_ECX[0x31] - iVar4 >> 2;
          }
          piVar1 = (int *)in_ECX[0x30];
          if ((uint)((int)piVar1 - iVar4 >> 2) < uVar5) {
            *piVar1 = *param_1;
            in_ECX[0x30] = (int)(piVar1 + 1);
          }
          else {
            FUN_0042fe80(in_ECX + 0x2e,piVar1,param_1);
          }
          iVar4 = *piVar3;
          if (iVar4 != 0) {
            *(short *)(iVar4 + 0x2dc) = (short)in_ECX[0x56];
          }
          param_1 = piVar3 + 1;
          param_2 = (int *)((int)param_2 + -1);
        } while (param_2 != (int *)0x0);
      }
      *(undefined1 *)(in_ECX[0x17] + 0x2a1) = 0;
      local_8 = 0xffffffff;
      if (local_18 != 0) {
        LeaveCriticalSection(local_24);
        local_18 = 0;
      }
      FUN_0084c220();
      ExceptionList = local_10;
      return;
    }
  }
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
0084ceb0 : PUSH EBP
0084ceb1 : MOV EBP,ESP
0084ceb3 : PUSH -0x1
0084ceb5 : PUSH 0xb1b98e
0084ceba : MOV EAX,FS:[0x0]
0084cec0 : PUSH EAX
0084cec1 : SUB ESP,0x1a4
0084cec7 : PUSH EBX
0084cec8 : PUSH ESI
0084cec9 : PUSH EDI
0084ceca : MOV EAX,[0x00d66fa0]
0084cecf : XOR EAX,EBP
0084ced1 : PUSH EAX
0084ced2 : LEA EAX,[EBP + -0xc]
0084ced5 : MOV FS:[0x0],EAX
0084cedb : MOV EBX,dword ptr [EBP + 0x8]
0084cede : MOV ESI,ECX
0084cee0 : CMP dword ptr [ESI + 0x5c],0x0
0084cee4 : JZ 0x0084d02e
0084ceea : CMP dword ptr [EBP + 0xc],0x0
0084ceee : JZ 0x0084cef9
0084cef0 : MOV EAX,dword ptr [ESI]
0084cef2 : MOV EDX,dword ptr [EAX + 0xc]
0084cef5 : PUSH 0x1
0084cef7 : CALL EDX
0084cef9 : PUSH -0x1
0084cefb : PUSH 0x0
0084cefd : PUSH EBX
0084cefe : LEA ECX,[ESI + 0x7c]
0084cf01 : CALL 0x00405eb0
0084cf06 : MOV EAX,dword ptr [EBX + 0x14]
0084cf09 : PUSH 0xc3cafc
0084cf0e : XOR EDI,EDI
0084cf10 : MOV ECX,EBX
0084cf12 : CALL 0x00405bb0
0084cf17 : TEST EAX,EAX
0084cf19 : JZ 0x0084d041
0084cf1f : LEA ECX,[EBP + -0x20]
0084cf22 : LEA EAX,[ESI + 0x10]
0084cf25 : PUSH ECX
0084cf26 : MOV dword ptr [EBP + -0x14],EDI
0084cf29 : MOV dword ptr [EBP + -0x20],EAX
0084cf2c : MOV dword ptr [EBP + -0x1c],0xc3cb00
0084cf33 : MOV dword ptr [EBP + -0x18],0x177
0084cf3a : MOV dword ptr [EBP + -0x10],0x1
0084cf41 : CALL 0x006ef1a0
0084cf46 : MOV dword ptr [EBP + -0x4],EDI
0084cf49 : MOV EAX,dword ptr [ESI + 0x5c]
0084cf4c : PUSH EDI
0084cf4d : PUSH EDI
0084cf4e : PUSH EDI
0084cf4f : PUSH EDI
0084cf50 : MOV byte ptr [EAX + 0x2a1],0x1
0084cf57 : MOV ECX,dword ptr [ESI + 0x5c]
0084cf5a : MOV EDX,dword ptr [ECX]
0084cf5c : MOV EAX,dword ptr [EDX + 0xe8]
0084cf62 : PUSH EDI
0084cf63 : PUSH EDI
0084cf64 : PUSH EBX
0084cf65 : CALL EAX
0084cf67 : LEA ECX,[EBP + 0x8]
0084cf6a : MOV dword ptr [EBP + 0x8],EDI
0084cf6d : MOV EDI,dword ptr [ESI + 0x5c]
0084cf70 : PUSH ECX
0084cf71 : LEA EAX,[EBP + 0xfffffe50]
0084cf77 : CALL 0x007d38e0
0084cf7c : MOV EAX,dword ptr [EBP + 0x8]
0084cf7f : TEST EAX,EAX
0084cf81 : JBE 0x0084cfed
0084cf83 : LEA EDX,[EBP + 0xfffffe50]
0084cf89 : LEA EDI,[ESI + 0xb8]
0084cf8f : MOV dword ptr [EBP + 0x8],EDX
0084cf92 : MOV dword ptr [EBP + 0xc],EAX
0084cf95 : MOV EDX,dword ptr [EDI + 0x4]
0084cf98 : TEST EDX,EDX
0084cf9a : JNZ 0x0084cfa0
0084cf9c : XOR EAX,EAX
0084cf9e : JMP 0x0084cfa8
0084cfa0 : MOV EAX,dword ptr [EDI + 0xc]
0084cfa3 : SUB EAX,EDX
0084cfa5 : SAR EAX,0x2
0084cfa8 : MOV ECX,dword ptr [EDI + 0x8]
0084cfab : MOV EBX,ECX
0084cfad : SUB EBX,EDX
0084cfaf : SAR EBX,0x2
0084cfb2 : CMP EBX,EAX
0084cfb4 : MOV EBX,dword ptr [EBP + 0x8]
0084cfb7 : JNC 0x0084cfc5
0084cfb9 : MOV EAX,dword ptr [EBX]
0084cfbb : MOV dword ptr [ECX],EAX
0084cfbd : ADD ECX,0x4
0084cfc0 : MOV dword ptr [EDI + 0x8],ECX
0084cfc3 : JMP 0x0084cfcd
0084cfc5 : PUSH EBX
0084cfc6 : PUSH ECX
0084cfc7 : PUSH EDI
0084cfc8 : CALL 0x0042fe80
0084cfcd : MOV EAX,dword ptr [EBX]
0084cfcf : TEST EAX,EAX
0084cfd1 : JZ 0x0084cfe1
0084cfd3 : MOVZX ECX,word ptr [ESI + 0x158]
0084cfda : MOV word ptr [EAX + 0x2dc],CX
0084cfe1 : ADD EBX,0x4
0084cfe4 : SUB dword ptr [EBP + 0xc],0x1
0084cfe8 : MOV dword ptr [EBP + 0x8],EBX
0084cfeb : JNZ 0x0084cf95
0084cfed : MOV EAX,dword ptr [ESI + 0x5c]
0084cff0 : MOV byte ptr [EAX + 0x2a1],0x0
0084cff7 : MOV dword ptr [EBP + -0x4],0xffffffff
0084cffe : CMP dword ptr [EBP + -0x14],0x0
0084d002 : JZ 0x0084d015
0084d004 : MOV ECX,dword ptr [EBP + -0x20]
0084d007 : PUSH ECX
0084d008 : CALL dword ptr [0x00b8511c]
0084d00e : MOV dword ptr [EBP + -0x14],0x0
0084d015 : CALL 0x0084c220
0084d01a : MOV ECX,dword ptr [EBP + -0xc]
0084d01d : MOV dword ptr FS:[0x0],ECX
0084d024 : POP ECX
0084d025 : POP EDI
0084d026 : POP ESI
0084d027 : POP EBX
0084d028 : MOV ESP,EBP
0084d02a : POP EBP
0084d02b : RET 0x8
0084d02e : MOV ESI,dword ptr [0x00da98e8]
0084d034 : PUSH 0xc3cb20
0084d039 : CALL 0x008018d0
0084d03e : ADD ESP,0x4
0084d041 : MOV ECX,dword ptr [EBP + -0xc]
0084d044 : MOV dword ptr FS:[0x0],ECX
0084d04b : POP ECX
0084d04c : POP EDI
0084d04d : POP ESI
0084d04e : POP EBX
0084d04f : MOV ESP,EBP
0084d051 : POP EBP
0084d052 : RET 0x8

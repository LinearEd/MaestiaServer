PROGRAM  : Maestia.exe
FUNCTION : FUN_0079d240
ENTRY    : 0079d240
BODY     : [[0079d240, 0079d526]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x0079d4ab) */

void FUN_0079d240(int param_1)

{
  char cVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  int in_ECX;
  int local_38;
  int *local_34;
  undefined1 local_30 [4];
  undefined2 local_2c;
  int local_1c;
  undefined4 local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b16291;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_14 = uVar2;
  if (*(char *)(in_ECX + 300) == '\0') {
    if (*(int *)(in_ECX + 0xdc) != 0) {
      local_2c = 0;
      local_18 = 7;
      local_1c = 0;
      FUN_00405eb0(*(int *)(in_ECX + 0xdc) + 4,0,0xffffffff);
      local_8 = 1;
      if (*(uint *)(param_1 + 0x18) < 8) {
        iVar3 = param_1 + 4;
      }
      else {
        iVar3 = *(int *)(param_1 + 4);
      }
      iVar3 = FUN_00405bb0(iVar3);
      if (iVar3 == 0) goto LAB_0079d2d6;
      uVar4 = FUN_004139b0(local_30,L"_upper",6);
      if ((uVar4 != 0xffffffff) && (5 < uVar4)) {
        FUN_00405e10(uVar4 - 5,6);
        cVar1 = FUN_00404700();
        if (cVar1 != '\0') {
          local_8 = 0xffffffff;
          FUN_00406560();
          goto LAB_0079d4fb;
        }
      }
      local_8 = 0xffffffff;
      FUN_00406560();
    }
    if ((*(int *)(in_ECX + 0x10c) != 0) && (cVar1 = FUN_00404700(uVar2), cVar1 != '\0'))
    goto LAB_0079d4fb;
  }
  else if (*(int *)(in_ECX + 0xac) != 0) {
    local_2c = 0;
    local_18 = 7;
    local_1c = 0;
    FUN_00405eb0(*(int *)(in_ECX + 0xac) + 4,0,0xffffffff);
    local_8 = 0;
    if (*(uint *)(param_1 + 0x18) < 8) {
      iVar3 = param_1 + 4;
    }
    else {
      iVar3 = *(int *)(param_1 + 4);
    }
    iVar3 = FUN_00405bb0(iVar3);
    if (iVar3 == 0) {
LAB_0079d2d6:
      local_8 = 0xffffffff;
      FUN_00406560();
      goto LAB_0079d4fb;
    }
    local_34 = (int *)&DAT_0000002e;
    iVar3 = FUN_00407cc0(&local_34,1);
    if (iVar3 != -1) {
      FUN_00405e10(iVar3,local_1c - iVar3);
      FUN_00404980(local_30);
      cVar1 = FUN_00404700();
      if (cVar1 != '\0') {
        local_8 = 0xffffffff;
        FUN_00406560();
        goto LAB_0079d4fb;
      }
    }
    local_8 = 0xffffffff;
    FUN_00406560();
  }
  iVar3 = (*(int *)(in_ECX + 0x124) - *(int *)(in_ECX + 0x120)) / 0x30;
  local_38 = 0;
  if (0 < iVar3) {
    local_34 = (int *)(*(int *)(in_ECX + 0x120) + 0x20);
    do {
      if (*local_34 != 0) {
        iVar5 = *local_34;
        uVar2 = *(uint *)(param_1 + 0x14);
        uVar4 = *(uint *)(iVar5 + 0x18);
        if (*(uint *)(iVar5 + 0x1c) < 8) {
          iVar5 = iVar5 + 8;
        }
        else {
          iVar5 = *(int *)(iVar5 + 8);
        }
        iVar5 = FUN_00405b70(iVar5);
        if (((iVar5 == 0) && (uVar2 <= uVar4)) && (uVar4 == uVar2)) break;
      }
      local_38 = local_38 + 1;
      local_34 = local_34 + 0xc;
    } while (local_38 < iVar3);
  }
LAB_0079d4fb:
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
0079d240 : PUSH EBP
0079d241 : MOV EBP,ESP
0079d243 : PUSH -0x1
0079d245 : PUSH 0xb16291
0079d24a : MOV EAX,FS:[0x0]
0079d250 : PUSH EAX
0079d251 : SUB ESP,0x30
0079d254 : MOV EAX,[0x00d66fa0]
0079d259 : XOR EAX,EBP
0079d25b : MOV dword ptr [EBP + -0x10],EAX
0079d25e : PUSH EBX
0079d25f : PUSH ESI
0079d260 : PUSH EDI
0079d261 : PUSH EAX
0079d262 : LEA EAX,[EBP + -0xc]
0079d265 : MOV FS:[0x0],EAX
0079d26b : MOV EBX,dword ptr [EBP + 0x8]
0079d26e : MOV ESI,ECX
0079d270 : CMP byte ptr [ESI + 0x12c],0x0
0079d277 : JZ 0x0079d3ba
0079d27d : MOV EAX,dword ptr [ESI + 0xac]
0079d283 : XOR EDI,EDI
0079d285 : CMP EAX,EDI
0079d287 : JZ 0x0079d359
0079d28d : PUSH -0x1
0079d28f : XOR ECX,ECX
0079d291 : ADD EAX,0x4
0079d294 : PUSH EDI
0079d295 : MOV word ptr [EBP + -0x28],CX
0079d299 : PUSH EAX
0079d29a : LEA ECX,[EBP + -0x2c]
0079d29d : MOV dword ptr [EBP + -0x14],0x7
0079d2a4 : MOV dword ptr [EBP + -0x18],EDI
0079d2a7 : CALL 0x00405eb0
0079d2ac : MOV dword ptr [EBP + -0x4],EDI
0079d2af : CMP dword ptr [EBX + 0x18],0x8
0079d2b3 : MOV EDI,dword ptr [EBX + 0x14]
0079d2b6 : JC 0x0079d2bd
0079d2b8 : MOV EAX,dword ptr [EBX + 0x4]
0079d2bb : JMP 0x0079d2c0
0079d2bd : LEA EAX,[EBX + 0x4]
0079d2c0 : PUSH EAX
0079d2c1 : MOV EAX,dword ptr [EBP + -0x18]
0079d2c4 : LEA ECX,[EBP + -0x2c]
0079d2c7 : CALL 0x00405bb0
0079d2cc : TEST EAX,EAX
0079d2ce : JNZ 0x0079d2ec
0079d2d0 : ADD ESI,0x8c
0079d2d6 : MOV dword ptr [EBP + -0x4],0xffffffff
0079d2dd : LEA ECX,[EBP + -0x2c]
0079d2e0 : CALL 0x00406560
0079d2e5 : MOV EAX,ESI
0079d2e7 : JMP 0x0079d4fb
0079d2ec : PUSH 0x1
0079d2ee : LEA EDX,[EBP + -0x30]
0079d2f1 : PUSH EDX
0079d2f2 : OR ECX,0xffffffff
0079d2f5 : LEA EDI,[EBP + -0x2c]
0079d2f8 : MOV dword ptr [EBP + -0x30],0x2e
0079d2ff : CALL 0x00407cc0
0079d304 : OR EDI,0xffffffff
0079d307 : CMP EAX,EDI
0079d309 : JZ 0x0079d34e
0079d30b : MOV ECX,dword ptr [EBP + -0x18]
0079d30e : SUB ECX,EAX
0079d310 : PUSH ECX
0079d311 : PUSH EAX
0079d312 : LEA ECX,[EBP + -0x2c]
0079d315 : CALL 0x00405e10
0079d31a : LEA EDX,[EBP + -0x2c]
0079d31d : PUSH EDX
0079d31e : MOV EDX,0xc16328
0079d323 : CALL 0x00404980
0079d328 : MOV EAX,EBX
0079d32a : LEA ECX,[EBP + -0x2c]
0079d32d : CALL 0x00404700
0079d332 : TEST AL,AL
0079d334 : JZ 0x0079d34e
0079d336 : ADD ESI,0x8c
0079d33c : MOV dword ptr [EBP + -0x4],EDI
0079d33f : LEA ECX,[EBP + -0x2c]
0079d342 : CALL 0x00406560
0079d347 : MOV EAX,ESI
0079d349 : JMP 0x0079d4fb
0079d34e : MOV dword ptr [EBP + -0x4],EDI
0079d351 : LEA ECX,[EBP + -0x2c]
0079d354 : CALL 0x00406560
0079d359 : MOV ECX,dword ptr [ESI + 0x124]
0079d35f : SUB ECX,dword ptr [ESI + 0x120]
0079d365 : MOV EAX,0x2aaaaaab
0079d36a : IMUL ECX
0079d36c : SAR EDX,0x3
0079d36f : MOV EAX,EDX
0079d371 : SHR EAX,0x1f
0079d374 : ADD EAX,EDX
0079d376 : MOV dword ptr [EBP + -0x38],EAX
0079d379 : MOV dword ptr [EBP + -0x34],0x0
0079d380 : TEST EAX,EAX
0079d382 : JLE 0x0079d4f9
0079d388 : MOV ESI,dword ptr [ESI + 0x120]
0079d38e : LEA ECX,[ESI + 0x20]
0079d391 : MOV dword ptr [EBP + -0x3c],ESI
0079d394 : MOV dword ptr [EBP + -0x30],ECX
0079d397 : CMP dword ptr [ECX],0x0
0079d39a : JZ 0x0079d4e4
0079d3a0 : MOV EAX,dword ptr [ECX]
0079d3a2 : MOV EDI,dword ptr [EBX + 0x14]
0079d3a5 : ADD EAX,0x4
0079d3a8 : CMP dword ptr [EBX + 0x18],0x8
0079d3ac : JC 0x0079d4a1
0079d3b2 : MOV ECX,dword ptr [EBX + 0x4]
0079d3b5 : JMP 0x0079d4a4
0079d3ba : MOV EAX,dword ptr [ESI + 0xdc]
0079d3c0 : TEST EAX,EAX
0079d3c2 : JZ 0x0079d479
0079d3c8 : XOR ECX,ECX
0079d3ca : PUSH -0x1
0079d3cc : PUSH ECX
0079d3cd : ADD EAX,0x4
0079d3d0 : MOV word ptr [EBP + -0x28],CX
0079d3d4 : PUSH EAX
0079d3d5 : LEA ECX,[EBP + -0x2c]
0079d3d8 : MOV dword ptr [EBP + -0x14],0x7
0079d3df : MOV dword ptr [EBP + -0x18],0x0
0079d3e6 : CALL 0x00405eb0
0079d3eb : MOV dword ptr [EBP + -0x4],0x1
0079d3f2 : CMP dword ptr [EBX + 0x18],0x8
0079d3f6 : MOV EDI,dword ptr [EBX + 0x14]
0079d3f9 : JC 0x0079d400
0079d3fb : MOV EAX,dword ptr [EBX + 0x4]
0079d3fe : JMP 0x0079d403
0079d400 : LEA EAX,[EBX + 0x4]
0079d403 : PUSH EAX
0079d404 : MOV EAX,dword ptr [EBP + -0x18]
0079d407 : LEA ECX,[EBP + -0x2c]
0079d40a : CALL 0x00405bb0
0079d40f : TEST EAX,EAX
0079d411 : JNZ 0x0079d41e
0079d413 : ADD ESI,0xbc
0079d419 : JMP 0x0079d2d6
0079d41e : PUSH 0x6
0079d420 : PUSH 0xc16340
0079d425 : LEA EDX,[EBP + -0x2c]
0079d428 : PUSH EDX
0079d429 : CALL 0x004139b0
0079d42e : OR EDI,0xffffffff
0079d431 : CMP EAX,EDI
0079d433 : JZ 0x0079d46e
0079d435 : CMP EAX,0x5
0079d438 : JBE 0x0079d46e
0079d43a : PUSH 0x6
0079d43c : ADD EAX,-0x5
0079d43f : PUSH EAX
0079d440 : LEA ECX,[EBP + -0x2c]
0079d443 : CALL 0x00405e10
0079d448 : MOV EAX,EBX
0079d44a : LEA ECX,[EBP + -0x2c]
0079d44d : CALL 0x00404700
0079d452 : TEST AL,AL
0079d454 : JZ 0x0079d46e
0079d456 : ADD ESI,0xbc
0079d45c : MOV dword ptr [EBP + -0x4],EDI
0079d45f : LEA ECX,[EBP + -0x2c]
0079d462 : CALL 0x00406560
0079d467 : MOV EAX,ESI
0079d469 : JMP 0x0079d4fb
0079d46e : MOV dword ptr [EBP + -0x4],EDI
0079d471 : LEA ECX,[EBP + -0x2c]
0079d474 : CALL 0x00406560
0079d479 : MOV EAX,dword ptr [ESI + 0x10c]
0079d47f : TEST EAX,EAX
0079d481 : JZ 0x0079d359
0079d487 : LEA ECX,[EAX + 0x4]
0079d48a : MOV EAX,EBX
0079d48c : CALL 0x00404700
0079d491 : TEST AL,AL
0079d493 : JZ 0x0079d359
0079d499 : LEA EAX,[ESI + 0xec]
0079d49f : JMP 0x0079d4fb
0079d4a1 : LEA ECX,[EBX + 0x4]
0079d4a4 : MOV ESI,dword ptr [EAX + 0x14]
0079d4a7 : MOV EDX,ESI
0079d4a9 : CMP EDX,ESI
0079d4ab : CMOVC ESI,EDX
0079d4ae : MOV EDX,ESI
0079d4b0 : CMP ESI,EDI
0079d4b2 : JC 0x0079d4b6
0079d4b4 : MOV EDX,EDI
0079d4b6 : CMP dword ptr [EAX + 0x18],0x8
0079d4ba : JC 0x0079d4c1
0079d4bc : MOV EAX,dword ptr [EAX + 0x4]
0079d4bf : JMP 0x0079d4c4
0079d4c1 : ADD EAX,0x4
0079d4c4 : PUSH EAX
0079d4c5 : CALL 0x00405b70
0079d4ca : ADD ESP,0x4
0079d4cd : TEST EAX,EAX
0079d4cf : JNZ 0x0079d4de
0079d4d1 : CMP ESI,EDI
0079d4d3 : JC 0x0079d4de
0079d4d5 : CMP ESI,EDI
0079d4d7 : SETNZ AL
0079d4da : TEST EAX,EAX
0079d4dc : JZ 0x0079d519
0079d4de : MOV EAX,dword ptr [EBP + -0x38]
0079d4e1 : MOV ECX,dword ptr [EBP + -0x30]
0079d4e4 : MOV EDX,dword ptr [EBP + -0x34]
0079d4e7 : INC EDX
0079d4e8 : ADD ECX,0x30
0079d4eb : CMP EDX,EAX
0079d4ed : MOV dword ptr [EBP + -0x34],EDX
0079d4f0 : MOV dword ptr [EBP + -0x30],ECX
0079d4f3 : JL 0x0079d397
0079d4f9 : XOR EAX,EAX
0079d4fb : MOV ECX,dword ptr [EBP + -0xc]
0079d4fe : MOV dword ptr FS:[0x0],ECX
0079d505 : POP ECX
0079d506 : POP EDI
0079d507 : POP ESI
0079d508 : POP EBX
0079d509 : MOV ECX,dword ptr [EBP + -0x10]
0079d50c : XOR ECX,EBP
0079d50e : CALL 0x00633e6b
0079d513 : MOV ESP,EBP
0079d515 : POP EBP
0079d516 : RET 0x4
0079d519 : MOV EAX,dword ptr [EBP + -0x34]
0079d51c : LEA EAX,[EAX + EAX*0x2]
0079d51f : SHL EAX,0x4
0079d522 : ADD EAX,dword ptr [EBP + -0x3c]
0079d525 : JMP 0x0079d4fb

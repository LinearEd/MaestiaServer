PROGRAM  : Maestia.exe
FUNCTION : FUN_005862d0
ENTRY    : 005862d0
BODY     : [[005862d0, 00586657]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_005862d0(char *param_1,char *param_2)

{
  byte bVar1;
  undefined4 uVar2;
  char *pcVar3;
  undefined1 uVar4;
  char cVar5;
  undefined4 uVar6;
  byte *pbVar7;
  undefined4 *in_ECX;
  byte *pbVar8;
  int iVar9;
  char *pcVar10;
  int iVar11;
  uint *puVar12;
  bool bVar13;
  float10 fVar14;
  uint uVar15;
  uint local_50;
  double local_4c;
  double local_44 [2];
  char local_34 [8];
  int local_2c;
  undefined **local_24;
  double *local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined1 local_10;
  int local_c;
  undefined4 local_8;
  int local_4;
  
  local_34[0] = '\0';
  if (param_1 == (char *)0x0) {
    param_1 = local_34;
  }
  pcVar3 = param_1;
  pcVar10 = param_2;
  if (param_2 == (char *)0x0) {
    pcVar10 = local_34;
  }
  iVar11 = 0;
  if (in_ECX[2] != 0) {
    iVar11 = in_ECX[5];
    puVar12 = (uint *)(iVar11 + 8);
    local_44[0] = (double)((ulonglong)local_44[0] & 0xffffffffffffff00);
    *puVar12 = *puVar12 + 0x10;
    if (*(uint *)(iVar11 + 0x10) <= *puVar12) {
      FUN_00504050();
    }
    if (*puVar12 != 0) {
      FUN_005266c0(pcVar10);
    }
    iVar11 = in_ECX[5];
    *(int *)(iVar11 + 8) = *(int *)(iVar11 + 8) + 0x10;
    if (*(uint *)(iVar11 + 0x10) <= *(uint *)(iVar11 + 8)) {
      FUN_00504050();
    }
    if (*(int *)(iVar11 + 8) != 0) {
      FUN_005266c0(pcVar3);
    }
    local_c = in_ECX[5];
    local_4 = (*(int *)(local_c + 8) - *(int *)(local_c + 0xc) >> 4) + -0x20 +
              *(int *)(local_c + 0x1c) * 0x20;
    local_20 = local_44;
    local_1c = *in_ECX;
    local_18 = 0;
    local_14 = 0;
    iVar9 = 2;
    local_24 = &PTR_FUN_00b8ab5c;
    local_10 = 0;
    local_8 = 2;
    (**(code **)(*(int *)in_ECX[2] + 0x28))(&local_24,in_ECX[3],0);
    iVar11 = in_ECX[5];
    puVar12 = (uint *)(iVar11 + 8);
    do {
      FUN_00526bc0();
      *puVar12 = *puVar12 - 0x10;
      if (*puVar12 < *(uint *)(iVar11 + 0xc)) {
        FUN_00504f30();
      }
      iVar9 = iVar9 + -1;
    } while (iVar9 != 0);
    if (local_2c == 0) {
      FUN_0051fbd0();
      FUN_00526bc0();
      FUN_00526bc0();
      return 0;
    }
    FUN_00527730(in_ECX[5]);
    iVar11 = FUN_0063b380();
    if ((*(byte *)(in_ECX + 1) & 2) != 0) {
      iVar11 = -iVar11;
    }
    FUN_0051fbd0();
    FUN_00526bc0();
    FUN_00526bc0();
    return iVar11;
  }
  local_44[0] = 0.0;
  local_4c = 0.0;
  if ((*(byte *)(in_ECX + 1) & 0x10) != 0) {
    if ((*param_1 == '\x03') || (*param_1 == '\x04')) {
      fVar14 = (float10)FUN_00527730(in_ECX[5]);
      local_44[0] = (double)fVar14;
      param_2 = (char *)CONCAT31(param_2._1_3_,1);
    }
    else {
      FUN_005272e0(&local_50,in_ECX[5],0xffffffff,0);
      uVar4 = FUN_005845a0(local_44);
      param_2 = (char *)CONCAT31(param_2._1_3_,uVar4);
      *(int *)(local_50 + 8) = *(int *)(local_50 + 8) + -1;
      if (*(int *)(local_50 + 8) == 0) {
        FUN_00525340();
      }
    }
    if ((*pcVar10 == '\x03') || (*pcVar10 == '\x04')) {
      fVar14 = (float10)FUN_00527730(in_ECX[5]);
      cVar5 = '\x01';
    }
    else {
      FUN_005272e0(&local_50,in_ECX[5],0xffffffff,0);
      cVar5 = FUN_005845a0(&local_4c);
      *(int *)(local_50 + 8) = *(int *)(local_50 + 8) + -1;
      if (*(int *)(local_50 + 8) == 0) {
        FUN_00525340();
      }
      fVar14 = (float10)local_4c;
    }
    if (((char)param_2 != '\0') && (cVar5 != '\0')) {
      if ((float10)local_44[0] < fVar14) {
        iVar11 = -1;
      }
      if (fVar14 < (float10)local_44[0]) {
        iVar11 = 1;
      }
      if ((*(byte *)(in_ECX + 1) & 2) != 0) {
        iVar11 = -iVar11;
      }
      FUN_00526bc0();
      return iVar11;
    }
  }
  FUN_005272e0(&param_2,in_ECX[5],0xffffffff,0);
  FUN_005272e0(&param_1,in_ECX[5],0xffffffff,0);
  uVar15 = in_ECX[1];
  if ((uVar15 & 0x400) == 0) {
    if ((uVar15 & 1) == 0) {
      pbVar8 = *(byte **)param_1;
      pbVar7 = *(byte **)param_2;
      do {
        bVar1 = *pbVar7;
        bVar13 = bVar1 < *pbVar8;
        if (bVar1 != *pbVar8) {
LAB_00586608:
          iVar11 = (1 - (uint)bVar13) - (uint)(bVar13 != 0);
          goto LAB_0058660d;
        }
        if (bVar1 == 0) break;
        bVar1 = pbVar7[1];
        bVar13 = bVar1 < pbVar8[1];
        if (bVar1 != pbVar8[1]) goto LAB_00586608;
        pbVar7 = pbVar7 + 2;
        pbVar8 = pbVar8 + 2;
      } while (bVar1 != 0);
      iVar11 = 0;
    }
    else {
      iVar11 = FUN_0051b280(*(undefined4 *)param_2,*(undefined4 *)param_1);
    }
  }
  else {
    uVar2 = *(undefined4 *)param_1;
    local_50 = CONCAT31(local_50._1_3_,~(byte)uVar15) & 0xffffff01;
    uVar15 = local_50;
    uVar6 = FUN_00524bc0(local_50);
    iVar11 = FUN_00524c30(uVar2,uVar6,uVar15);
  }
LAB_0058660d:
  if ((*(byte *)(in_ECX + 1) & 2) != 0) {
    iVar11 = -iVar11;
  }
  *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + -1;
  if (*(int *)(param_1 + 8) == 0) {
    FUN_00525340();
  }
  *(int *)(param_2 + 8) = *(int *)(param_2 + 8) + -1;
  if (*(int *)(param_2 + 8) == 0) {
    FUN_00525340();
  }
  FUN_00526bc0();
  return iVar11;
}



============================================================
DISASSEMBLY
============================================================
005862d0 : SUB ESP,0x50
005862d3 : PUSH EBX
005862d4 : MOV EBX,dword ptr [ESP + 0x58]
005862d8 : PUSH EBP
005862d9 : PUSH ESI
005862da : PUSH EDI
005862db : MOV ESI,ECX
005862dd : MOV byte ptr [ESP + 0x2c],0x0
005862e2 : TEST EBX,EBX
005862e4 : JNZ 0x005862f0
005862e6 : LEA EAX,[ESP + 0x2c]
005862ea : MOV dword ptr [ESP + 0x64],EAX
005862ee : MOV EBX,EAX
005862f0 : MOV EBP,dword ptr [ESP + 0x68]
005862f4 : TEST EBP,EBP
005862f6 : JNZ 0x005862fc
005862f8 : LEA EBP,[ESP + 0x2c]
005862fc : XOR EDI,EDI
005862fe : CMP dword ptr [ESI + 0x8],EDI
00586301 : JZ 0x0058644b
00586307 : MOV EDI,dword ptr [ESI + 0x14]
0058630a : ADD EDI,0x8
0058630d : MOV byte ptr [ESP + 0x1c],0x0
00586312 : ADD dword ptr [EDI],0x10
00586315 : MOV EAX,dword ptr [EDI]
00586317 : CMP EAX,dword ptr [EDI + 0x8]
0058631a : JC 0x00586323
0058631c : MOV ECX,EDI
0058631e : CALL 0x00504050
00586323 : MOV EDI,dword ptr [EDI]
00586325 : TEST EDI,EDI
00586327 : JZ 0x00586331
00586329 : PUSH EBP
0058632a : MOV ECX,EDI
0058632c : CALL 0x005266c0
00586331 : MOV EDI,dword ptr [ESI + 0x14]
00586334 : ADD dword ptr [EDI + 0x8],0x10
00586338 : MOV EAX,dword ptr [EDI + 0x8]
0058633b : ADD EDI,0x8
0058633e : CMP EAX,dword ptr [EDI + 0x8]
00586341 : JC 0x0058634a
00586343 : MOV ECX,EDI
00586345 : CALL 0x00504050
0058634a : MOV EDI,dword ptr [EDI]
0058634c : TEST EDI,EDI
0058634e : JZ 0x00586358
00586350 : PUSH EBX
00586351 : MOV ECX,EDI
00586353 : CALL 0x005266c0
00586358 : MOV EAX,dword ptr [ESI + 0x14]
0058635b : MOV ECX,dword ptr [EAX + 0x8]
0058635e : SUB ECX,dword ptr [EAX + 0xc]
00586361 : MOV EDX,dword ptr [EAX + 0x1c]
00586364 : SHL EDX,0x5
00586367 : SAR ECX,0x4
0058636a : LEA ECX,[ECX + EDX*0x1 + -0x20]
0058636e : LEA EDX,[ESP + 0x1c]
00586372 : MOV dword ptr [ESP + 0x40],EDX
00586376 : MOV EDX,dword ptr [ESI]
00586378 : MOV dword ptr [ESP + 0x44],EDX
0058637c : XOR EDX,EDX
0058637e : PUSH EDX
0058637f : MOV dword ptr [ESP + 0x4c],EDX
00586383 : MOV dword ptr [ESP + 0x50],EDX
00586387 : MOV EDX,dword ptr [ESI + 0xc]
0058638a : MOV dword ptr [ESP + 0x60],ECX
0058638e : MOV ECX,dword ptr [ESI + 0x8]
00586391 : MOV dword ptr [ESP + 0x58],EAX
00586395 : MOV EBX,0x2
0058639a : PUSH EDX
0058639b : MOV dword ptr [ESP + 0x44],0xb8ab5c
005863a3 : MOV byte ptr [ESP + 0x58],0x0
005863a8 : MOV dword ptr [ESP + 0x60],EBX
005863ac : MOV EAX,dword ptr [ECX]
005863ae : MOV EAX,dword ptr [EAX + 0x28]
005863b1 : LEA EDX,[ESP + 0x44]
005863b5 : PUSH EDX
005863b6 : CALL EAX
005863b8 : MOV EDI,dword ptr [ESI + 0x14]
005863bb : ADD EDI,0x8
005863be : MOV EDI,EDI
005863c0 : MOV ECX,dword ptr [EDI]
005863c2 : CALL 0x00526bc0
005863c7 : ADD dword ptr [EDI],-0x10
005863ca : MOV EAX,dword ptr [EDI]
005863cc : CMP EAX,dword ptr [EDI + 0x4]
005863cf : JNC 0x005863d8
005863d1 : MOV ECX,EDI
005863d3 : CALL 0x00504f30
005863d8 : SUB EBX,0x1
005863db : JNZ 0x005863c0
005863dd : MOV ECX,dword ptr [ESP + 0x40]
005863e1 : TEST ECX,ECX
005863e3 : JZ 0x00586424
005863e5 : MOV EDX,dword ptr [ESI + 0x14]
005863e8 : PUSH EDX
005863e9 : CALL 0x00527730
005863ee : CALL 0x0063b380
005863f3 : TEST byte ptr [ESI + 0x4],0x2
005863f7 : JZ 0x005863fb
005863f9 : NEG EAX
005863fb : LEA ECX,[ESP + 0x3c]
005863ff : MOV ESI,EAX
00586401 : CALL 0x0051fbd0
00586406 : LEA ECX,[ESP + 0x1c]
0058640a : CALL 0x00526bc0
0058640f : LEA ECX,[ESP + 0x2c]
00586413 : CALL 0x00526bc0
00586418 : POP EDI
00586419 : MOV EAX,ESI
0058641b : POP ESI
0058641c : POP EBP
0058641d : POP EBX
0058641e : ADD ESP,0x50
00586421 : RET 0x8
00586424 : LEA ECX,[ESP + 0x3c]
00586428 : CALL 0x0051fbd0
0058642d : LEA ECX,[ESP + 0x1c]
00586431 : CALL 0x00526bc0
00586436 : LEA ECX,[ESP + 0x2c]
0058643a : CALL 0x00526bc0
0058643f : POP EDI
00586440 : POP ESI
00586441 : POP EBP
00586442 : XOR EAX,EAX
00586444 : POP EBX
00586445 : ADD ESP,0x50
00586448 : RET 0x8
0058644b : TEST byte ptr [ESI + 0x4],0x10
0058644f : FLDZ
00586451 : FST double ptr [ESP + 0x1c]
00586455 : FSTP double ptr [ESP + 0x14]
00586459 : JZ 0x00586569
0058645f : MOV AL,byte ptr [EBX]
00586461 : CMP AL,0x3
00586463 : JZ 0x00586469
00586465 : CMP AL,0x4
00586467 : JNZ 0x0058647f
00586469 : MOV EAX,dword ptr [ESI + 0x14]
0058646c : PUSH EAX
0058646d : MOV ECX,EBX
0058646f : CALL 0x00527730
00586474 : FSTP double ptr [ESP + 0x1c]
00586478 : MOV byte ptr [ESP + 0x68],0x1
0058647d : JMP 0x005864bf
0058647f : MOV ECX,dword ptr [ESI + 0x14]
00586482 : PUSH 0x0
00586484 : PUSH -0x1
00586486 : PUSH ECX
00586487 : LEA EDX,[ESP + 0x1c]
0058648b : PUSH EDX
0058648c : MOV ECX,EBX
0058648e : CALL 0x005272e0
00586493 : MOV EAX,dword ptr [ESP + 0x10]
00586497 : MOV ECX,dword ptr [EAX]
00586499 : LEA EDX,[ESP + 0x1c]
0058649d : PUSH EDX
0058649e : CALL 0x005845a0
005864a3 : MOV byte ptr [ESP + 0x6c],AL
005864a7 : MOV EAX,dword ptr [ESP + 0x14]
005864ab : DEC dword ptr [EAX + 0x8]
005864ae : MOV ECX,EAX
005864b0 : ADD EAX,0x8
005864b3 : ADD ESP,0x4
005864b6 : CMP dword ptr [EAX],EDI
005864b8 : JNZ 0x005864bf
005864ba : CALL 0x00525340
005864bf : MOV AL,byte ptr [EBP]
005864c2 : CMP AL,0x3
005864c4 : JZ 0x005864ca
005864c6 : CMP AL,0x4
005864c8 : JNZ 0x005864d9
005864ca : MOV EAX,dword ptr [ESI + 0x14]
005864cd : PUSH EAX
005864ce : MOV ECX,EBP
005864d0 : CALL 0x00527730
005864d5 : MOV BL,0x1
005864d7 : JMP 0x0058651b
005864d9 : MOV ECX,dword ptr [ESI + 0x14]
005864dc : PUSH 0x0
005864de : PUSH -0x1
005864e0 : PUSH ECX
005864e1 : LEA EDX,[ESP + 0x1c]
005864e5 : PUSH EDX
005864e6 : MOV ECX,EBP
005864e8 : CALL 0x005272e0
005864ed : MOV EAX,dword ptr [ESP + 0x10]
005864f1 : MOV ECX,dword ptr [EAX]
005864f3 : LEA EDX,[ESP + 0x14]
005864f7 : PUSH EDX
005864f8 : CALL 0x005845a0
005864fd : MOV BL,AL
005864ff : MOV EAX,dword ptr [ESP + 0x14]
00586503 : DEC dword ptr [EAX + 0x8]
00586506 : MOV ECX,EAX
00586508 : ADD EAX,0x8
0058650b : ADD ESP,0x4
0058650e : CMP dword ptr [EAX],EDI
00586510 : JNZ 0x00586517
00586512 : CALL 0x00525340
00586517 : FLD double ptr [ESP + 0x14]
0058651b : CMP byte ptr [ESP + 0x68],0x0
00586520 : JZ 0x00586563
00586522 : TEST BL,BL
00586524 : JZ 0x00586563
00586526 : FLD double ptr [ESP + 0x1c]
0058652a : FCOM
0058652c : FNSTSW AX
0058652e : TEST AH,0x5
00586531 : JP 0x00586536
00586533 : OR EDI,0xffffffff
00586536 : FCOMPP
00586538 : FNSTSW AX
0058653a : TEST AH,0x41
0058653d : JNZ 0x00586544
0058653f : MOV EDI,0x1
00586544 : TEST byte ptr [ESI + 0x4],0x2
00586548 : JZ 0x0058654c
0058654a : NEG EDI
0058654c : LEA ECX,[ESP + 0x2c]
00586550 : MOV ESI,EDI
00586552 : CALL 0x00526bc0
00586557 : POP EDI
00586558 : MOV EAX,ESI
0058655a : POP ESI
0058655b : POP EBP
0058655c : POP EBX
0058655d : ADD ESP,0x50
00586560 : RET 0x8
00586563 : MOV EBX,dword ptr [ESP + 0x64]
00586567 : FSTP ST0
00586569 : MOV EAX,dword ptr [ESI + 0x14]
0058656c : PUSH 0x0
0058656e : PUSH -0x1
00586570 : PUSH EAX
00586571 : LEA ECX,[ESP + 0x74]
00586575 : PUSH ECX
00586576 : MOV ECX,EBX
00586578 : CALL 0x005272e0
0058657d : MOV EDX,dword ptr [ESI + 0x14]
00586580 : PUSH 0x0
00586582 : PUSH -0x1
00586584 : PUSH EDX
00586585 : LEA EAX,[ESP + 0x70]
00586589 : PUSH EAX
0058658a : MOV ECX,EBP
0058658c : CALL 0x005272e0
00586591 : MOV EAX,dword ptr [ESI + 0x4]
00586594 : TEST EAX,0x400
00586599 : JZ 0x005865c7
0058659b : MOV EDX,dword ptr [ESP + 0x64]
0058659f : MOV EDI,dword ptr [EDX]
005865a1 : MOV CL,AL
005865a3 : NOT CL
005865a5 : AND CL,0x1
005865a8 : MOV byte ptr [ESP + 0x10],CL
005865ac : MOV EAX,dword ptr [ESP + 0x10]
005865b0 : PUSH EAX
005865b1 : LEA ECX,[ESP + 0x68]
005865b5 : CALL 0x00524bc0
005865ba : PUSH EAX
005865bb : PUSH EDI
005865bc : LEA ECX,[ESP + 0x74]
005865c0 : CALL 0x00524c30
005865c5 : JMP 0x0058660d
005865c7 : MOV EDX,dword ptr [ESP + 0x68]
005865cb : TEST AL,0x1
005865cd : JZ 0x005865e0
005865cf : MOV ECX,dword ptr [ESP + 0x64]
005865d3 : MOV EAX,dword ptr [ECX]
005865d5 : MOV ECX,dword ptr [EDX]
005865d7 : PUSH EAX
005865d8 : PUSH ECX
005865d9 : CALL 0x0051b280
005865de : JMP 0x0058660d
005865e0 : MOV EAX,dword ptr [ESP + 0x64]
005865e4 : MOV ECX,dword ptr [EAX]
005865e6 : MOV EAX,dword ptr [EDX]
005865e8 : MOV DL,byte ptr [EAX]
005865ea : CMP DL,byte ptr [ECX]
005865ec : JNZ 0x00586608
005865ee : TEST DL,DL
005865f0 : JZ 0x00586604
005865f2 : MOV DL,byte ptr [EAX + 0x1]
005865f5 : CMP DL,byte ptr [ECX + 0x1]
005865f8 : JNZ 0x00586608
005865fa : ADD EAX,0x2
005865fd : ADD ECX,0x2
00586600 : TEST DL,DL
00586602 : JNZ 0x005865e8
00586604 : XOR EAX,EAX
00586606 : JMP 0x0058660d
00586608 : SBB EAX,EAX
0058660a : SBB EAX,-0x1
0058660d : TEST byte ptr [ESI + 0x4],0x2
00586611 : JZ 0x00586615
00586613 : NEG EAX
00586615 : MOV ESI,EAX
00586617 : MOV EAX,dword ptr [ESP + 0x64]
0058661b : DEC dword ptr [EAX + 0x8]
0058661e : MOV ECX,EAX
00586620 : ADD EAX,0x8
00586623 : CMP dword ptr [EAX],0x0
00586626 : JNZ 0x0058662d
00586628 : CALL 0x00525340
0058662d : MOV EAX,dword ptr [ESP + 0x68]
00586631 : DEC dword ptr [EAX + 0x8]
00586634 : MOV ECX,EAX
00586636 : ADD EAX,0x8
00586639 : CMP dword ptr [EAX],0x0
0058663c : JNZ 0x00586643
0058663e : CALL 0x00525340
00586643 : LEA ECX,[ESP + 0x2c]
00586647 : CALL 0x00526bc0
0058664c : POP EDI
0058664d : MOV EAX,ESI
0058664f : POP ESI
00586650 : POP EBP
00586651 : POP EBX
00586652 : ADD ESP,0x50
00586655 : RET 0x8

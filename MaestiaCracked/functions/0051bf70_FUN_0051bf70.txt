PROGRAM  : Maestia.exe
FUNCTION : FUN_0051bf70
ENTRY    : 0051bf70
BODY     : [[0051bf70, 0051c0e6]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0051bf70(void)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  int local_18;
  uint local_14;
  uint local_10;
  int local_c;
  undefined1 local_8;
  undefined4 local_4;
  
  iVar2 = 0;
  uVar3 = 0;
  local_18 = 0;
  local_14 = 0;
  local_10 = 0;
  local_c = 0x200;
  local_8 = 0;
  local_4 = DAT_00d73250;
  iVar1 = FUN_0051aa70(&stack0x00000004);
  while (iVar1 != 0) {
    if (iVar1 == 0x3c) {
      uVar4 = uVar3 + 4;
      if (local_10 <= uVar4) {
        local_10 = local_c + uVar4 & ~(local_c - 1U);
        if (iVar2 == 0) {
          iVar2 = FUN_00515840(local_10,0);
          local_18 = iVar2;
        }
        else {
          iVar2 = FUN_00515c80(iVar2,local_10);
          local_18 = iVar2;
        }
      }
      local_8 = 0;
      if (iVar2 != 0) {
        *(undefined1 *)(uVar4 + iVar2) = 0;
      }
      *(undefined4 *)(iVar2 + uVar3) = 0x3b746c26;
      local_14 = uVar4;
    }
    else if (iVar1 == 0x3e) {
      FUN_0051b440(uVar3 + 4);
      *(undefined4 *)(uVar3 + local_18) = 0x3b746726;
      iVar2 = local_18;
    }
    else if (iVar1 == 0x22) {
      FUN_0051b440(uVar3 + 6);
      *(undefined4 *)(uVar3 + local_18) = 0x6f757126;
      *(undefined2 *)(uVar3 + 4 + local_18) = 0x3b74;
      iVar2 = local_18;
    }
    else if (iVar1 == 0x27) {
      FUN_0051b440(uVar3 + 6);
      *(undefined4 *)(uVar3 + local_18) = 0x6f706126;
      *(undefined2 *)(uVar3 + 4 + local_18) = 0x3b73;
      iVar2 = local_18;
    }
    else if (iVar1 == 0x26) {
      FUN_0051b440(uVar3 + 5);
      *(undefined4 *)(uVar3 + local_18) = 0x706d6126;
      *(undefined1 *)(uVar3 + 4 + local_18) = 0x3b;
      iVar2 = local_18;
    }
    else {
      FUN_0051b4e0(iVar1);
      iVar2 = local_18;
    }
    uVar3 = local_14;
    iVar1 = FUN_0051aa70(&stack0x00000004);
  }
  FUN_0051bcf0(&local_18);
  if (iVar2 != 0) {
    FUN_00515cf0(iVar2);
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
0051bf70 : SUB ESP,0x18
0051bf73 : MOV EAX,[0x00d73250]
0051bf78 : PUSH EBX
0051bf79 : PUSH ESI
0051bf7a : PUSH EDI
0051bf7b : LEA ECX,[ESP + 0x28]
0051bf7f : XOR EBX,EBX
0051bf81 : XOR ESI,ESI
0051bf83 : XOR EDI,EDI
0051bf85 : PUSH ECX
0051bf86 : MOV dword ptr [ESP + 0x10],ESI
0051bf8a : MOV dword ptr [ESP + 0x14],EDI
0051bf8e : MOV dword ptr [ESP + 0x18],EBX
0051bf92 : MOV dword ptr [ESP + 0x1c],0x200
0051bf9a : MOV byte ptr [ESP + 0x20],BL
0051bf9e : MOV dword ptr [ESP + 0x24],EAX
0051bfa2 : CALL 0x0051aa70
0051bfa7 : CMP EAX,EBX
0051bfa9 : JZ 0x0051c0c6
0051bfaf : PUSH EBP
0051bfb0 : CMP EAX,0x3c
0051bfb3 : JNZ 0x0051c00b
0051bfb5 : MOV EBP,EDI
0051bfb7 : ADD EDI,0x4
0051bfba : CMP EDI,dword ptr [ESP + 0x18]
0051bfbe : JC 0x0051bfee
0051bfc0 : MOV ECX,dword ptr [ESP + 0x1c]
0051bfc4 : LEA EAX,[ECX + EDI*0x1]
0051bfc7 : DEC ECX
0051bfc8 : NOT ECX
0051bfca : AND EAX,ECX
0051bfcc : MOV dword ptr [ESP + 0x18],EAX
0051bfd0 : CMP ESI,EBX
0051bfd2 : JNZ 0x0051bfe1
0051bfd4 : MOV ECX,dword ptr [ESP + 0x24]
0051bfd8 : PUSH EBX
0051bfd9 : PUSH EAX
0051bfda : CALL 0x00515840
0051bfdf : JMP 0x0051bfe8
0051bfe1 : PUSH EAX
0051bfe2 : PUSH ESI
0051bfe3 : CALL 0x00515c80
0051bfe8 : MOV ESI,EAX
0051bfea : MOV dword ptr [ESP + 0x10],ESI
0051bfee : MOV byte ptr [ESP + 0x20],BL
0051bff2 : MOV dword ptr [ESP + 0x14],EDI
0051bff6 : CMP ESI,EBX
0051bff8 : JZ 0x0051bffd
0051bffa : MOV byte ptr [EDI + ESI*0x1],BL
0051bffd : MOV EDX,dword ptr [0x00b872dc]
0051c003 : MOV dword ptr [ESI + EBP*0x1],EDX
0051c006 : JMP 0x0051c0b3
0051c00b : LEA ECX,[ESP + 0x10]
0051c00f : CMP EAX,0x3e
0051c012 : JNZ 0x0051c02f
0051c014 : LEA EAX,[EDI + 0x4]
0051c017 : PUSH EAX
0051c018 : CALL 0x0051b440
0051c01d : MOV ECX,dword ptr [0x00b872d4]
0051c023 : MOV ESI,dword ptr [ESP + 0x10]
0051c027 : MOV dword ptr [EDI + ESI*0x1],ECX
0051c02a : JMP 0x0051c0af
0051c02f : CMP EAX,0x22
0051c032 : JNZ 0x0051c057
0051c034 : LEA EDX,[EDI + 0x6]
0051c037 : PUSH EDX
0051c038 : CALL 0x0051b440
0051c03d : MOV ESI,dword ptr [ESP + 0x10]
0051c041 : MOV EAX,[0x00b872cc]
0051c046 : MOV dword ptr [EDI + ESI*0x1],EAX
0051c049 : MOV CX,word ptr [0x00b872d0]
0051c050 : MOV word ptr [EDI + ESI*0x1 + 0x4],CX
0051c055 : JMP 0x0051c0af
0051c057 : CMP EAX,0x27
0051c05a : JNZ 0x0051c07f
0051c05c : LEA EDX,[EDI + 0x6]
0051c05f : PUSH EDX
0051c060 : CALL 0x0051b440
0051c065 : MOV ESI,dword ptr [ESP + 0x10]
0051c069 : MOV EAX,[0x00b872c4]
0051c06e : MOV dword ptr [EDI + ESI*0x1],EAX
0051c071 : MOV CX,word ptr [0x00b872c8]
0051c078 : MOV word ptr [EDI + ESI*0x1 + 0x4],CX
0051c07d : JMP 0x0051c0af
0051c07f : CMP EAX,0x26
0051c082 : JNZ 0x0051c0a5
0051c084 : LEA EDX,[EDI + 0x5]
0051c087 : PUSH EDX
0051c088 : CALL 0x0051b440
0051c08d : MOV ESI,dword ptr [ESP + 0x10]
0051c091 : MOV EAX,[0x00b872bc]
0051c096 : MOV dword ptr [EDI + ESI*0x1],EAX
0051c099 : MOV CL,byte ptr [0x00b872c0]
0051c09f : MOV byte ptr [EDI + ESI*0x1 + 0x4],CL
0051c0a3 : JMP 0x0051c0af
0051c0a5 : PUSH EAX
0051c0a6 : CALL 0x0051b4e0
0051c0ab : MOV ESI,dword ptr [ESP + 0x10]
0051c0af : MOV EDI,dword ptr [ESP + 0x14]
0051c0b3 : LEA EDX,[ESP + 0x2c]
0051c0b7 : PUSH EDX
0051c0b8 : CALL 0x0051aa70
0051c0bd : CMP EAX,EBX
0051c0bf : JNZ 0x0051bfb0
0051c0c5 : POP EBP
0051c0c6 : MOV ECX,dword ptr [ESP + 0x30]
0051c0ca : LEA EAX,[ESP + 0xc]
0051c0ce : PUSH EAX
0051c0cf : CALL 0x0051bcf0
0051c0d4 : CMP ESI,EBX
0051c0d6 : JZ 0x0051c0de
0051c0d8 : PUSH ESI
0051c0d9 : CALL 0x00515cf0
0051c0de : POP EDI
0051c0df : POP ESI
0051c0e0 : POP EBX
0051c0e1 : ADD ESP,0x18
0051c0e4 : RET 0xc

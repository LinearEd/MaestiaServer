PROGRAM  : Maestia.exe
FUNCTION : FUN_00721f00
ENTRY    : 00721f00
BODY     : [[00721f00, 00721f48] [00721f50, 007220cc]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00721f00(int *param_1)

{
  short sVar1;
  char cVar2;
  uint uVar3;
  short *psVar4;
  int in_ECX;
  undefined1 auStack_24c [4];
  undefined4 uStack_248;
  undefined4 local_244;
  undefined4 uStack_240;
  undefined1 auStack_23c [4];
  undefined2 uStack_238;
  undefined4 uStack_228;
  uint uStack_224;
  short sStack_220;
  undefined1 auStack_21e [514];
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 uStack_c;
  
  uStack_c = 0xffffffff;
  puStack_10 = &LAB_00b17e53;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_24c;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffda8;
  ExceptionList = &local_14;
  do {
    if ((uint)param_1[8] <= (uint)param_1[9]) {
switchD_00721f8b_caseD_102:
      goto LAB_007220a7;
    }
    cVar2 = (**(code **)(*param_1 + 0x1c))(&local_244,uVar3);
    if (cVar2 == '\0') goto LAB_007220a7;
    switch(local_244) {
    case 0x10:
      FUN_0070d320(&sStack_220);
      psVar4 = &sStack_220;
      uStack_224 = 7;
      uStack_228 = 0;
      uStack_238 = 0;
      do {
        sVar1 = *psVar4;
        psVar4 = psVar4 + 1;
      } while (sVar1 != 0);
      FUN_00406360(&sStack_220,(int)psVar4 - (int)auStack_21e >> 1);
      uStack_c = 0;
      FUN_00405eb0(auStack_23c,0,0xffffffff);
      uStack_c = 0xffffffff;
      if (7 < uStack_224) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
      uStack_224 = 7;
      uStack_228 = 0;
      uStack_238 = 0;
      break;
    default:
      (**(code **)(*param_1 + 0x24))(uStack_240);
      break;
    case 0x13:
      uStack_248 = 0xffffffff;
      (**(code **)(*param_1 + 0xc))(&uStack_248,4,1);
      break;
    case 0x51:
      (**(code **)(*param_1 + 0xc))(in_ECX + 0x11,1,1);
      break;
    case 0x52:
      (**(code **)(*param_1 + 0xc))(in_ECX + 0x12,1,1);
      break;
    case 0x53:
      (**(code **)(*param_1 + 0xc))(in_ECX + 0x13,1,1);
      break;
    case 0x61:
      cVar2 = FUN_004cc990(param_1);
      if (cVar2 == '\0') {
LAB_007220a7:
        ExceptionList = local_14;
        __security_check_cookie(local_1c ^ (uint)auStack_24c);
        return;
      }
      break;
    case 0x102:
      goto switchD_00721f8b_caseD_102;
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
00721f00 : PUSH EBP
00721f01 : MOV EBP,ESP
00721f03 : AND ESP,0xfffffff8
00721f06 : PUSH -0x1
00721f08 : PUSH 0xb17e53
00721f0d : MOV EAX,FS:[0x0]
00721f13 : PUSH EAX
00721f14 : SUB ESP,0x238
00721f1a : MOV EAX,[0x00d66fa0]
00721f1f : XOR EAX,ESP
00721f21 : MOV dword ptr [ESP + 0x230],EAX
00721f28 : PUSH EBX
00721f29 : PUSH ESI
00721f2a : PUSH EDI
00721f2b : MOV EAX,[0x00d66fa0]
00721f30 : XOR EAX,ESP
00721f32 : PUSH EAX
00721f33 : LEA EAX,[ESP + 0x248]
00721f3a : MOV FS:[0x0],EAX
00721f40 : MOV ESI,dword ptr [EBP + 0x8]
00721f43 : MOV EDI,ECX
00721f45 : XOR EBX,EBX
00721f47 : JMP 0x00721f50
00721f50 : MOV EAX,dword ptr [ESI + 0x24]
00721f53 : CMP EAX,dword ptr [ESI + 0x20]
00721f56 : JNC 0x007220a5
00721f5c : MOV EDX,dword ptr [ESI]
00721f5e : MOV EDX,dword ptr [EDX + 0x1c]
00721f61 : LEA EAX,[ESP + 0x18]
00721f65 : PUSH EAX
00721f66 : MOV ECX,ESI
00721f68 : CALL EDX
00721f6a : TEST AL,AL
00721f6c : JZ 0x0072208e
00721f72 : MOV EAX,dword ptr [ESP + 0x18]
00721f76 : ADD EAX,-0x10
00721f79 : CMP EAX,0xf2
00721f7e : JA 0x00722092
00721f84 : MOVZX EAX,byte ptr [EAX + 0x7220f0]
00721f8b : JMP dword ptr [EAX*0x4 + 0x7220d0]
00721f92 : MOV EDX,dword ptr [ESI]
00721f94 : MOV EDX,dword ptr [EDX + 0xc]
00721f97 : PUSH 0x1
00721f99 : PUSH 0x4
00721f9b : LEA EAX,[ESP + 0x1c]
00721f9f : PUSH EAX
00721fa0 : MOV ECX,ESI
00721fa2 : MOV dword ptr [ESP + 0x20],0xffffffff
00721faa : CALL EDX
00721fac : JMP 0x00721f50
00721fae : LEA EAX,[ESP + 0x3c]
00721fb2 : PUSH EAX
00721fb3 : MOV ECX,ESI
00721fb5 : CALL 0x0070d320
00721fba : XOR ECX,ECX
00721fbc : LEA EAX,[ESP + 0x3c]
00721fc0 : MOV dword ptr [ESP + 0x38],0x7
00721fc8 : MOV dword ptr [ESP + 0x34],EBX
00721fcc : MOV word ptr [ESP + 0x24],CX
00721fd1 : LEA EDX,[EAX + 0x2]
00721fd4 : MOV CX,word ptr [EAX]
00721fd7 : ADD EAX,0x2
00721fda : CMP CX,BX
00721fdd : JNZ 0x00721fd4
00721fdf : SUB EAX,EDX
00721fe1 : SAR EAX,0x1
00721fe3 : PUSH EAX
00721fe4 : LEA EDX,[ESP + 0x40]
00721fe8 : PUSH EDX
00721fe9 : LEA ECX,[ESP + 0x28]
00721fed : CALL 0x00406360
00721ff2 : MOV dword ptr [ESP + 0x250],EBX
00721ff9 : PUSH -0x1
00721ffb : PUSH EBX
00721ffc : LEA EAX,[ESP + 0x28]
00722000 : PUSH EAX
00722001 : LEA ECX,[EDI + 0x14]
00722004 : CALL 0x00405eb0
00722009 : MOV dword ptr [ESP + 0x250],0xffffffff
00722014 : CMP dword ptr [ESP + 0x38],0x8
00722019 : JC 0x00722024
0072201b : MOV ECX,dword ptr [ESP + 0x24]
0072201f : CALL 0x006f04e0
00722024 : XOR ECX,ECX
00722026 : MOV dword ptr [ESP + 0x38],0x7
0072202e : MOV dword ptr [ESP + 0x34],EBX
00722032 : MOV word ptr [ESP + 0x24],CX
00722037 : JMP 0x00721f50
0072203c : MOV EDX,dword ptr [ESI]
0072203e : MOV EDX,dword ptr [EDX + 0xc]
00722041 : PUSH 0x1
00722043 : PUSH 0x1
00722045 : LEA EAX,[EDI + 0x11]
00722048 : PUSH EAX
00722049 : MOV ECX,ESI
0072204b : CALL EDX
0072204d : JMP 0x00721f50
00722052 : MOV EAX,dword ptr [ESI]
00722054 : MOV EDX,dword ptr [EAX + 0xc]
00722057 : PUSH 0x1
00722059 : PUSH 0x1
0072205b : LEA ECX,[EDI + 0x12]
0072205e : PUSH ECX
0072205f : MOV ECX,ESI
00722061 : CALL EDX
00722063 : JMP 0x00721f50
00722068 : MOV EAX,dword ptr [ESI]
0072206a : MOV EDX,dword ptr [EAX + 0xc]
0072206d : PUSH 0x1
0072206f : PUSH 0x1
00722071 : LEA ECX,[EDI + 0x13]
00722074 : PUSH ECX
00722075 : MOV ECX,ESI
00722077 : CALL EDX
00722079 : JMP 0x00721f50
0072207e : PUSH ESI
0072207f : MOV ECX,EDI
00722081 : CALL 0x004cc990
00722086 : TEST AL,AL
00722088 : JNZ 0x00721f50
0072208e : XOR AL,AL
00722090 : JMP 0x007220a7
00722092 : MOV ECX,dword ptr [ESP + 0x1c]
00722096 : MOV EAX,dword ptr [ESI]
00722098 : MOV EDX,dword ptr [EAX + 0x24]
0072209b : PUSH ECX
0072209c : MOV ECX,ESI
0072209e : CALL EDX
007220a0 : JMP 0x00721f50
007220a5 : MOV AL,0x1
007220a7 : MOV ECX,dword ptr [ESP + 0x248]
007220ae : MOV dword ptr FS:[0x0],ECX
007220b5 : POP ECX
007220b6 : POP EDI
007220b7 : POP ESI
007220b8 : POP EBX
007220b9 : MOV ECX,dword ptr [ESP + 0x230]
007220c0 : XOR ECX,ESP
007220c2 : CALL 0x00633e6b
007220c7 : MOV ESP,EBP
007220c9 : POP EBP
007220ca : RET 0x4

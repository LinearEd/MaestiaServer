PROGRAM  : Maestia.exe
FUNCTION : _wcsncpy_s
ENTRY    : 0063ba5b
BODY     : [[0063ba5b, 0063bb2d]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    _wcsncpy_s
   
   Library: Visual Studio 2008 Release */

errno_t __cdecl _wcsncpy_s(wchar_t *_Dst,rsize_t _SizeInWords,wchar_t *_Src,rsize_t _MaxCount)

{
  wchar_t wVar1;
  int *piVar2;
  wchar_t *pwVar3;
  rsize_t rVar4;
  errno_t eVar5;
  
  if (_MaxCount == 0) {
    if (_Dst == (wchar_t *)0x0) {
      if (_SizeInWords == 0) {
        return 0;
      }
    }
    else {
LAB_0063ba81:
      if (_SizeInWords != 0) {
        if (_MaxCount == 0) {
          *_Dst = L'\0';
          return 0;
        }
        if (_Src != (wchar_t *)0x0) {
          pwVar3 = _Dst;
          rVar4 = _SizeInWords;
          if (_MaxCount == 0xffffffff) {
            do {
              wVar1 = *_Src;
              *pwVar3 = wVar1;
              pwVar3 = pwVar3 + 1;
              _Src = _Src + 1;
              if (wVar1 == L'\0') break;
              rVar4 = rVar4 - 1;
            } while (rVar4 != 0);
          }
          else {
            do {
              wVar1 = *_Src;
              *pwVar3 = wVar1;
              pwVar3 = pwVar3 + 1;
              _Src = _Src + 1;
              if ((wVar1 == L'\0') || (rVar4 = rVar4 - 1, rVar4 == 0)) break;
              _MaxCount = _MaxCount - 1;
            } while (_MaxCount != 0);
            if (_MaxCount == 0) {
              *pwVar3 = L'\0';
            }
          }
          if (rVar4 != 0) {
            return 0;
          }
          if (_MaxCount == 0xffffffff) {
            _Dst[_SizeInWords - 1] = L'\0';
            return 0x50;
          }
          *_Dst = L'\0';
          piVar2 = __errno();
          eVar5 = 0x22;
          *piVar2 = 0x22;
          goto LAB_0063ba92;
        }
        *_Dst = L'\0';
      }
    }
  }
  else if (_Dst != (wchar_t *)0x0) goto LAB_0063ba81;
  piVar2 = __errno();
  eVar5 = 0x16;
  *piVar2 = 0x16;
LAB_0063ba92:
  __invalid_parameter(0,0,0,0,0);
  return eVar5;
}



============================================================
DISASSEMBLY
============================================================
0063ba5b : MOV EDI,EDI
0063ba5d : PUSH EBP
0063ba5e : MOV EBP,ESP
0063ba60 : PUSH EBX
0063ba61 : PUSH ESI
0063ba62 : MOV ESI,dword ptr [EBP + 0x8]
0063ba65 : PUSH EDI
0063ba66 : XOR EDI,EDI
0063ba68 : CMP dword ptr [EBP + 0x14],EDI
0063ba6b : JNZ 0x0063ba7d
0063ba6d : CMP ESI,EDI
0063ba6f : JNZ 0x0063ba81
0063ba71 : CMP dword ptr [EBP + 0xc],EDI
0063ba74 : JNZ 0x0063ba88
0063ba76 : XOR EAX,EAX
0063ba78 : POP EDI
0063ba79 : POP ESI
0063ba7a : POP EBX
0063ba7b : POP EBP
0063ba7c : RET
0063ba7d : CMP ESI,EDI
0063ba7f : JZ 0x0063ba88
0063ba81 : MOV EBX,dword ptr [EBP + 0xc]
0063ba84 : CMP EBX,EDI
0063ba86 : JA 0x0063baa3
0063ba88 : CALL 0x0063ab82
0063ba8d : PUSH 0x16
0063ba8f : POP ESI
0063ba90 : MOV dword ptr [EAX],ESI
0063ba92 : PUSH EDI
0063ba93 : PUSH EDI
0063ba94 : PUSH EDI
0063ba95 : PUSH EDI
0063ba96 : PUSH EDI
0063ba97 : CALL 0x006372b8
0063ba9c : ADD ESP,0x14
0063ba9f : MOV EAX,ESI
0063baa1 : JMP 0x0063ba78
0063baa3 : CMP dword ptr [EBP + 0x14],EDI
0063baa6 : JNZ 0x0063baaf
0063baa8 : XOR EAX,EAX
0063baaa : MOV word ptr [ESI],AX
0063baad : JMP 0x0063ba76
0063baaf : MOV EDX,dword ptr [EBP + 0x10]
0063bab2 : CMP EDX,EDI
0063bab4 : JNZ 0x0063babd
0063bab6 : XOR EAX,EAX
0063bab8 : MOV word ptr [ESI],AX
0063babb : JMP 0x0063ba88
0063babd : CMP dword ptr [EBP + 0x14],-0x1
0063bac1 : MOV EAX,ESI
0063bac3 : JNZ 0x0063bad9
0063bac5 : MOVZX ECX,word ptr [EDX]
0063bac8 : MOV word ptr [EAX],CX
0063bacb : INC EAX
0063bacc : INC EAX
0063bacd : INC EDX
0063bace : INC EDX
0063bacf : CMP CX,DI
0063bad2 : JZ 0x0063bafa
0063bad4 : DEC EBX
0063bad5 : JNZ 0x0063bac5
0063bad7 : JMP 0x0063bafa
0063bad9 : MOVZX ECX,word ptr [EDX]
0063badc : MOV word ptr [EAX],CX
0063badf : INC EAX
0063bae0 : INC EAX
0063bae1 : INC EDX
0063bae2 : INC EDX
0063bae3 : CMP CX,DI
0063bae6 : JZ 0x0063baf0
0063bae8 : DEC EBX
0063bae9 : JZ 0x0063baf0
0063baeb : DEC dword ptr [EBP + 0x14]
0063baee : JNZ 0x0063bad9
0063baf0 : CMP dword ptr [EBP + 0x14],EDI
0063baf3 : JNZ 0x0063bafa
0063baf5 : XOR ECX,ECX
0063baf7 : MOV word ptr [EAX],CX
0063bafa : CMP EBX,EDI
0063bafc : JNZ 0x0063ba76
0063bb02 : XOR EAX,EAX
0063bb04 : CMP dword ptr [EBP + 0x14],-0x1
0063bb08 : JNZ 0x0063bb1a
0063bb0a : MOV ECX,dword ptr [EBP + 0xc]
0063bb0d : PUSH 0x50
0063bb0f : MOV word ptr [ESI + ECX*0x2 + -0x2],AX
0063bb14 : POP EAX
0063bb15 : JMP 0x0063ba78
0063bb1a : MOV word ptr [ESI],AX
0063bb1d : CALL 0x0063ab82
0063bb22 : PUSH 0x22
0063bb24 : POP ECX
0063bb25 : MOV dword ptr [EAX],ECX
0063bb27 : MOV ESI,ECX
0063bb29 : JMP 0x0063ba92

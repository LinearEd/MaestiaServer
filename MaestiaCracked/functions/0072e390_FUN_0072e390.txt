PROGRAM  : Maestia.exe
FUNCTION : FUN_0072e390
ENTRY    : 0072e390
BODY     : [[0072e390, 0072e40c] [0072e410, 0072e421] [0072e428, 0072e4b0]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0072e390(LPCRITICAL_SECTION param_1)

{
  LONG *local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  puStack_c = &LAB_00b10448;
  local_10 = ExceptionList;
  ExceptionList = &local_10;
  local_8 = 7;
  FUN_0072de50(DAT_00d66fa0 ^ (uint)&stack0xfffffffc);
  SetEvent((HANDLE)param_1[5].LockCount);
  if ((HANDLE)param_1[5].RecursionCount != (HANDLE)0x0) {
    WaitForSingleObject((HANDLE)param_1[5].RecursionCount,0xffffffff);
    CloseHandle((HANDLE)param_1[5].RecursionCount);
    param_1[5].RecursionCount = 0;
  }
  local_14 = (LONG *)param_1[3].RecursionCount;
  if (local_14 != (LONG *)0x0) {
    FUN_00664a40(&local_14);
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  FUN_00664a00();
  local_8._0_1_ = 6;
  FUN_006648f0();
  local_8._0_1_ = 5;
  FUN_006648f0();
  local_8._0_1_ = 4;
  FUN_006648f0();
  local_8._0_1_ = 3;
  FUN_006648f0();
  local_8._0_1_ = 2;
  local_14 = &param_1[3].RecursionCount;
  FUN_00664be0();
  local_14 = &param_1[2].RecursionCount;
  local_8._0_1_ = 1;
  FUN_00664be0();
  local_8 = (uint)local_8._1_3_ << 8;
  DeleteCriticalSection((LPCRITICAL_SECTION)&param_1[1].LockCount);
  local_8 = 0xffffffff;
  DeleteCriticalSection(param_1);
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
0072e390 : PUSH EBP
0072e391 : MOV EBP,ESP
0072e393 : PUSH -0x1
0072e395 : PUSH 0xb10448
0072e39a : MOV EAX,FS:[0x0]
0072e3a0 : PUSH EAX
0072e3a1 : PUSH ECX
0072e3a2 : PUSH EBX
0072e3a3 : PUSH ESI
0072e3a4 : PUSH EDI
0072e3a5 : MOV EAX,[0x00d66fa0]
0072e3aa : XOR EAX,EBP
0072e3ac : PUSH EAX
0072e3ad : LEA EAX,[EBP + -0xc]
0072e3b0 : MOV FS:[0x0],EAX
0072e3b6 : MOV ESI,dword ptr [EBP + 0x8]
0072e3b9 : MOV dword ptr [EBP + -0x4],0x7
0072e3c0 : MOV ECX,ESI
0072e3c2 : CALL 0x0072de50
0072e3c7 : MOV EAX,dword ptr [ESI + 0x7c]
0072e3ca : LEA EBX,[ESI + 0x7c]
0072e3cd : PUSH EAX
0072e3ce : CALL dword ptr [0x00b851e8]
0072e3d4 : MOV EAX,dword ptr [ESI + 0x80]
0072e3da : TEST EAX,EAX
0072e3dc : JZ 0x0072e3fe
0072e3de : PUSH -0x1
0072e3e0 : PUSH EAX
0072e3e1 : CALL dword ptr [0x00b85100]
0072e3e7 : MOV ECX,dword ptr [ESI + 0x80]
0072e3ed : PUSH ECX
0072e3ee : CALL dword ptr [0x00b85104]
0072e3f4 : MOV dword ptr [ESI + 0x80],0x0
0072e3fe : MOV EAX,dword ptr [ESI + 0x50]
0072e401 : LEA EDI,[ESI + 0x50]
0072e404 : MOV dword ptr [EBP + -0x10],EAX
0072e407 : TEST EAX,EAX
0072e409 : JZ 0x0072e428
0072e40b : JMP 0x0072e410
0072e410 : LEA EDX,[EBP + -0x10]
0072e413 : PUSH EDX
0072e414 : MOV ECX,EDI
0072e416 : CALL 0x00664a40
0072e41b : MOV ECX,EAX
0072e41d : CALL 0x006f04e0
0072e428 : MOV ECX,EDI
0072e42a : CALL 0x00664a00
0072e42f : MOV byte ptr [EBP + -0x4],0x6
0072e433 : MOV ECX,EBX
0072e435 : CALL 0x006648f0
0072e43a : MOV byte ptr [EBP + -0x4],0x5
0072e43e : LEA ECX,[ESI + 0x78]
0072e441 : CALL 0x006648f0
0072e446 : MOV byte ptr [EBP + -0x4],0x4
0072e44a : LEA ECX,[ESI + 0x6c]
0072e44d : CALL 0x006648f0
0072e452 : MOV byte ptr [EBP + -0x4],0x3
0072e456 : LEA ECX,[ESI + 0x68]
0072e459 : CALL 0x006648f0
0072e45e : MOV AL,0x2
0072e460 : MOV byte ptr [EBP + -0x4],AL
0072e463 : MOV ECX,EDI
0072e465 : MOV dword ptr [EBP + -0x10],ECX
0072e468 : MOV byte ptr [EBP + -0x4],AL
0072e46b : CALL 0x00664be0
0072e470 : MOV AL,0x1
0072e472 : MOV byte ptr [EBP + -0x4],AL
0072e475 : LEA ECX,[ESI + 0x38]
0072e478 : MOV dword ptr [EBP + -0x10],ECX
0072e47b : MOV byte ptr [EBP + -0x4],AL
0072e47e : CALL 0x00664be0
0072e483 : MOV byte ptr [EBP + -0x4],0x0
0072e487 : MOV EDI,dword ptr [0x00b850fc]
0072e48d : LEA EAX,[ESI + 0x1c]
0072e490 : PUSH EAX
0072e491 : CALL EDI
0072e493 : MOV dword ptr [EBP + -0x4],0xffffffff
0072e49a : PUSH ESI
0072e49b : CALL EDI
0072e49d : MOV ECX,dword ptr [EBP + -0xc]
0072e4a0 : MOV dword ptr FS:[0x0],ECX
0072e4a7 : POP ECX
0072e4a8 : POP EDI
0072e4a9 : POP ESI
0072e4aa : POP EBX
0072e4ab : MOV ESP,EBP
0072e4ad : POP EBP
0072e4ae : RET 0x4

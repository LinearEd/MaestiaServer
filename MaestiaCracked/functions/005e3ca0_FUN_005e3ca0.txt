PROGRAM  : Maestia.exe
FUNCTION : FUN_005e3ca0
ENTRY    : 005e3ca0
BODY     : [[005e3ca0, 005e3e60]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 FUN_005e3ca0(undefined4 param_1)

{
  uint *puVar1;
  bool bVar2;
  int *in_EAX;
  int iVar3;
  uint uVar4;
  undefined1 *puVar5;
  undefined2 uVar6;
  ushort uVar7;
  uint uVar8;
  uint uVar9;
  uint uStack_10;
  int local_c;
  uint local_8;
  uint local_4;
  
  uVar9 = 0;
  uVar7 = 0;
  local_c = 0;
  local_8 = 0;
  local_4 = 0;
  uVar6 = 0;
  bVar2 = false;
  uVar8 = 0;
  iVar3 = (**(code **)(*in_EAX + 0x38))();
  uVar4 = uVar9;
  if (iVar3 == 0) goto LAB_005e3e24;
  do {
    puVar5 = (undefined1 *)(in_EAX[0xe] + uVar8 * 8 + *(int *)in_EAX[0xc]);
    if (bVar2) {
      if ((uint)uVar7 == CONCAT11(puVar5[1],*puVar5) - 1) goto LAB_005e3d0a;
      uVar9 = uVar9 + 1;
      uStack_10 = CONCAT22(uVar7,uVar6);
      if (uVar9 < local_8) {
        uVar4 = uVar9;
        if (uVar9 < local_4 >> 1) {
LAB_005e3dc1:
          FUN_0057c3a0(&local_c,uVar4);
        }
      }
      else if (local_4 <= uVar9) {
        uVar4 = (uVar9 >> 2) + uVar9;
        goto LAB_005e3dc1;
      }
      puVar1 = (uint *)(local_c + -4 + uVar9 * 4);
      if (puVar1 != (uint *)0x0) {
        *puVar1 = uStack_10;
      }
      bVar2 = false;
      local_8 = uVar9;
    }
    else {
      uVar6 = CONCAT11(puVar5[1],*puVar5);
      bVar2 = true;
LAB_005e3d0a:
      uVar7 = *(ushort *)(*(int *)in_EAX[0xc] + in_EAX[0xe] + uVar8 * 8);
      uVar8 = uVar8 + 1;
    }
    uVar4 = (**(code **)(*in_EAX + 0x38))();
  } while (uVar8 < uVar4);
  uVar4 = uVar9;
  if (!bVar2) goto LAB_005e3e24;
  uVar4 = uVar9 + 1;
  uStack_10 = CONCAT22(uVar7,uVar6);
  if (uVar4 < uVar9) {
    uVar8 = uVar4;
    if (uVar4 < local_4 >> 1) {
LAB_005e3e01:
      FUN_0057c3a0(&local_c,uVar8);
    }
  }
  else if (local_4 <= uVar4) {
    uVar8 = (uVar4 >> 2) + uVar4;
    goto LAB_005e3e01;
  }
  puVar1 = (uint *)(local_c + -4 + uVar4 * 4);
  local_8 = uVar4;
  if (puVar1 != (uint *)0x0) {
    *puVar1 = uStack_10;
  }
LAB_005e3e24:
  uStack_10 = uStack_10 & 0xffffff00;
  FUN_005df030(&local_c,0,uVar4,uStack_10);
  FUN_005e24e0();
  FUN_00515cf0(local_c);
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
005e3ca0 : SUB ESP,0x18
005e3ca3 : PUSH EBX
005e3ca4 : PUSH EBP
005e3ca5 : PUSH ESI
005e3ca6 : MOV ESI,EAX
005e3ca8 : MOV EAX,dword ptr [ESI]
005e3caa : MOV EDX,dword ptr [EAX + 0x38]
005e3cad : PUSH EDI
005e3cae : XOR EDI,EDI
005e3cb0 : XOR EBX,EBX
005e3cb2 : MOV ECX,ESI
005e3cb4 : MOV dword ptr [ESP + 0x1c],EDI
005e3cb8 : MOV dword ptr [ESP + 0x20],EDI
005e3cbc : MOV dword ptr [ESP + 0x24],EDI
005e3cc0 : MOV dword ptr [ESP + 0x14],EDI
005e3cc4 : MOV byte ptr [ESP + 0x13],BL
005e3cc8 : XOR EBP,EBP
005e3cca : CALL EDX
005e3ccc : TEST EAX,EAX
005e3cce : JBE 0x005e3e24
005e3cd4 : MOV ECX,dword ptr [ESI + 0x38]
005e3cd7 : MOV EDX,dword ptr [ESI + 0x30]
005e3cda : MOV EDX,dword ptr [EDX]
005e3cdc : LEA EAX,[EBP*0x8 + 0x0]
005e3ce3 : ADD ECX,EAX
005e3ce5 : ADD ECX,EDX
005e3ce7 : MOVZX DX,byte ptr [ECX + 0x1]
005e3cec : SHL DX,0x8
005e3cf0 : CMP byte ptr [ESP + 0x13],0x0
005e3cf5 : JNZ 0x005e3d76
005e3cf7 : MOVZX CX,byte ptr [ECX]
005e3cfb : OR DX,CX
005e3cfe : MOVZX EDX,DX
005e3d01 : MOV dword ptr [ESP + 0x14],EDX
005e3d05 : MOV byte ptr [ESP + 0x13],0x1
005e3d0a : MOV ECX,dword ptr [ESI + 0x38]
005e3d0d : ADD ECX,EAX
005e3d0f : MOV EAX,dword ptr [ESI + 0x30]
005e3d12 : MOV EDX,dword ptr [EAX]
005e3d14 : LEA EAX,[EDX + ECX*0x1]
005e3d17 : MOVZX CX,byte ptr [EAX + 0x1]
005e3d1c : MOVZX DX,byte ptr [EAX]
005e3d20 : SHL CX,0x8
005e3d24 : OR CX,DX
005e3d27 : MOVZX EBX,CX
005e3d2a : INC EBP
005e3d2b : MOV EAX,dword ptr [ESI]
005e3d2d : MOV EDX,dword ptr [EAX + 0x38]
005e3d30 : MOV ECX,ESI
005e3d32 : CALL EDX
005e3d34 : CMP EBP,EAX
005e3d36 : JC 0x005e3cd4
005e3d38 : CMP byte ptr [ESP + 0x13],0x0
005e3d3d : JZ 0x005e3e24
005e3d43 : MOV AX,word ptr [ESP + 0x14]
005e3d48 : LEA ESI,[EDI + 0x1]
005e3d4b : MOV word ptr [ESP + 0x18],AX
005e3d50 : MOV word ptr [ESP + 0x1a],BX
005e3d55 : CMP ESI,EDI
005e3d57 : JNC 0x005e3dee
005e3d5d : MOV EAX,dword ptr [ESP + 0x24]
005e3d61 : SHR EAX,0x1
005e3d63 : CMP ESI,EAX
005e3d65 : JNC 0x005e3e0a
005e3d6b : PUSH ESI
005e3d6c : LEA ECX,[ESP + 0x20]
005e3d70 : PUSH ECX
005e3d71 : JMP 0x005e3e01
005e3d76 : MOVZX ECX,byte ptr [ECX]
005e3d79 : MOVZX EDX,DX
005e3d7c : OR EDX,ECX
005e3d7e : MOVZX ECX,BX
005e3d81 : DEC EDX
005e3d82 : CMP ECX,EDX
005e3d84 : JZ 0x005e3d0a
005e3d86 : MOV DX,word ptr [ESP + 0x14]
005e3d8b : INC EDI
005e3d8c : MOV word ptr [ESP + 0x18],DX
005e3d91 : MOV word ptr [ESP + 0x1a],BX
005e3d96 : CMP EDI,dword ptr [ESP + 0x20]
005e3d9a : JNC 0x005e3dae
005e3d9c : MOV EAX,dword ptr [ESP + 0x24]
005e3da0 : SHR EAX,0x1
005e3da2 : CMP EDI,EAX
005e3da4 : JNC 0x005e3dca
005e3da6 : PUSH EDI
005e3da7 : LEA ECX,[ESP + 0x20]
005e3dab : PUSH ECX
005e3dac : JMP 0x005e3dc1
005e3dae : CMP EDI,dword ptr [ESP + 0x24]
005e3db2 : JC 0x005e3dca
005e3db4 : MOV EDX,EDI
005e3db6 : SHR EDX,0x2
005e3db9 : ADD EDX,EDI
005e3dbb : PUSH EDX
005e3dbc : LEA EAX,[ESP + 0x20]
005e3dc0 : PUSH EAX
005e3dc1 : LEA ECX,[ESP + 0x24]
005e3dc5 : CALL 0x0057c3a0
005e3dca : MOV ECX,dword ptr [ESP + 0x1c]
005e3dce : MOV dword ptr [ESP + 0x20],EDI
005e3dd2 : LEA EDI,[ECX + EDI*0x4 + -0x4]
005e3dd6 : TEST EDI,EDI
005e3dd8 : JZ 0x005e3de0
005e3dda : MOV EDX,dword ptr [ESP + 0x18]
005e3dde : MOV dword ptr [EDI],EDX
005e3de0 : MOV EDI,dword ptr [ESP + 0x20]
005e3de4 : MOV byte ptr [ESP + 0x13],0x0
005e3de9 : JMP 0x005e3d2b
005e3dee : CMP ESI,dword ptr [ESP + 0x24]
005e3df2 : JC 0x005e3e0a
005e3df4 : MOV EDX,ESI
005e3df6 : SHR EDX,0x2
005e3df9 : ADD EDX,ESI
005e3dfb : PUSH EDX
005e3dfc : LEA EAX,[ESP + 0x20]
005e3e00 : PUSH EAX
005e3e01 : LEA ECX,[ESP + 0x24]
005e3e05 : CALL 0x0057c3a0
005e3e0a : MOV ECX,dword ptr [ESP + 0x1c]
005e3e0e : MOV dword ptr [ESP + 0x20],ESI
005e3e12 : MOV EDI,dword ptr [ESP + 0x20]
005e3e16 : LEA ESI,[ECX + ESI*0x4 + -0x4]
005e3e1a : TEST ESI,ESI
005e3e1c : JZ 0x005e3e24
005e3e1e : MOV EDX,dword ptr [ESP + 0x18]
005e3e22 : MOV dword ptr [ESI],EDX
005e3e24 : MOV byte ptr [ESP + 0x18],0x0
005e3e29 : MOV EAX,dword ptr [ESP + 0x18]
005e3e2d : PUSH EAX
005e3e2e : PUSH EDI
005e3e2f : LEA ECX,[ESP + 0x24]
005e3e33 : PUSH 0x0
005e3e35 : PUSH ECX
005e3e36 : CALL 0x005df030
005e3e3b : MOV EDI,dword ptr [ESP + 0x3c]
005e3e3f : ADD ESP,0x10
005e3e42 : LEA ESI,[ESP + 0x1c]
005e3e46 : MOV ECX,EDI
005e3e48 : CALL 0x005e24e0
005e3e4d : MOV EDX,dword ptr [ESP + 0x1c]
005e3e51 : PUSH EDX
005e3e52 : CALL 0x00515cf0
005e3e57 : MOV EAX,EDI
005e3e59 : POP EDI
005e3e5a : POP ESI
005e3e5b : POP EBP
005e3e5c : POP EBX
005e3e5d : ADD ESP,0x18
005e3e60 : RET

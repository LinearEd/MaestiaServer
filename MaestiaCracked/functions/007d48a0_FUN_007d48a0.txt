PROGRAM  : Maestia.exe
FUNCTION : FUN_007d48a0
ENTRY    : 007d48a0
BODY     : [[007d48a0, 007d497e]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_007d48a0(undefined4 param_1,undefined4 param_2)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  uint uVar3;
  int iVar4;
  int in_ECX;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b0f178;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  if (*(int *)(in_ECX + 8) != 0) {
    EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  }
  local_8 = 0;
  puVar1 = *(undefined4 **)(in_ECX + 0x38);
  for (puVar2 = (undefined4 *)*puVar1; puVar2 != puVar1; puVar2 = (undefined4 *)*puVar2) {
    iVar4 = (**(code **)(*(int *)puVar2[9] + 0x1c))(uVar3);
    if (iVar4 - 2U < 8) {
      FUN_007d48a0(param_1,param_2);
    }
  }
  local_8 = 0xffffffff;
  if (*(int *)(in_ECX + 8) == 0) {
    *(undefined1 *)(in_ECX + 0x24c) = (undefined1)param_1;
    *(undefined1 *)(in_ECX + 0x24d) = (undefined1)param_2;
    ExceptionList = local_10;
    return;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(*(int *)(in_ECX + 8) + 4));
  *(undefined1 *)(in_ECX + 0x24c) = (undefined1)param_1;
  *(undefined1 *)(in_ECX + 0x24d) = (undefined1)param_2;
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
007d48a0 : PUSH EBP
007d48a1 : MOV EBP,ESP
007d48a3 : PUSH -0x1
007d48a5 : PUSH 0xb0f178
007d48aa : MOV EAX,FS:[0x0]
007d48b0 : PUSH EAX
007d48b1 : SUB ESP,0x8
007d48b4 : PUSH EBX
007d48b5 : PUSH ESI
007d48b6 : PUSH EDI
007d48b7 : MOV EAX,[0x00d66fa0]
007d48bc : XOR EAX,EBP
007d48be : PUSH EAX
007d48bf : LEA EAX,[EBP + -0xc]
007d48c2 : MOV FS:[0x0],EAX
007d48c8 : MOV EBX,ECX
007d48ca : MOV EAX,dword ptr [EBX + 0x8]
007d48cd : MOV dword ptr [EBP + -0x14],EBX
007d48d0 : TEST EAX,EAX
007d48d2 : JZ 0x007d48de
007d48d4 : ADD EAX,0x4
007d48d7 : PUSH EAX
007d48d8 : CALL dword ptr [0x00b85118]
007d48de : MOV dword ptr [EBP + -0x4],0x0
007d48e5 : MOV EAX,dword ptr [EBX + 0x38]
007d48e8 : MOV EDI,dword ptr [EAX]
007d48ea : MOV dword ptr [EBP + -0x10],EAX
007d48ed : CMP EDI,EAX
007d48ef : JZ 0x007d491b
007d48f1 : MOV ESI,dword ptr [EDI + 0x24]
007d48f4 : MOV EAX,dword ptr [ESI]
007d48f6 : MOV EDX,dword ptr [EAX + 0x1c]
007d48f9 : MOV ECX,ESI
007d48fb : CALL EDX
007d48fd : ADD EAX,-0x2
007d4900 : CMP EAX,0x7
007d4903 : JA 0x007d4914
007d4905 : MOV EAX,dword ptr [EBP + 0xc]
007d4908 : MOV ECX,dword ptr [EBP + 0x8]
007d490b : PUSH EAX
007d490c : PUSH ECX
007d490d : MOV ECX,ESI
007d490f : CALL 0x007d48a0
007d4914 : MOV EDI,dword ptr [EDI]
007d4916 : CMP EDI,dword ptr [EBP + -0x10]
007d4919 : JNZ 0x007d48f1
007d491b : MOV dword ptr [EBP + -0x4],0xffffffff
007d4922 : MOV EAX,dword ptr [EBX + 0x8]
007d4925 : TEST EAX,EAX
007d4927 : JZ 0x007d4959
007d4929 : ADD EAX,0x4
007d492c : PUSH EAX
007d492d : CALL dword ptr [0x00b8511c]
007d4933 : MOV DL,byte ptr [EBP + 0x8]
007d4936 : MOV AL,byte ptr [EBP + 0xc]
007d4939 : MOV byte ptr [EBX + 0x24c],DL
007d493f : MOV byte ptr [EBX + 0x24d],AL
007d4945 : MOV ECX,dword ptr [EBP + -0xc]
007d4948 : MOV dword ptr FS:[0x0],ECX
007d494f : POP ECX
007d4950 : POP EDI
007d4951 : POP ESI
007d4952 : POP EBX
007d4953 : MOV ESP,EBP
007d4955 : POP EBP
007d4956 : RET 0x8
007d4959 : MOV CL,byte ptr [EBP + 0x8]
007d495c : MOV DL,byte ptr [EBP + 0xc]
007d495f : MOV byte ptr [EBX + 0x24c],CL
007d4965 : MOV byte ptr [EBX + 0x24d],DL
007d496b : MOV ECX,dword ptr [EBP + -0xc]
007d496e : MOV dword ptr FS:[0x0],ECX
007d4975 : POP ECX
007d4976 : POP EDI
007d4977 : POP ESI
007d4978 : POP EBX
007d4979 : MOV ESP,EBP
007d497b : POP EBP
007d497c : RET 0x8

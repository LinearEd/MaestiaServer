PROGRAM  : Maestia.exe
FUNCTION : FUN_008fc070
ENTRY    : 008fc070
BODY     : [[008fc070, 008fc182]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_008fc070(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  uint uVar1;
  int iVar2;
  int in_ECX;
  int in_EDX;
  undefined4 local_34;
  undefined1 local_30 [4];
  undefined2 local_2c;
  int local_1c;
  uint local_18;
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b68a57;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_2c = 0;
  local_18 = 7;
  local_1c = 0;
  local_14 = uVar1;
  FUN_00405eb0(param_1,0,0xffffffff);
  local_8 = 0;
  if (in_EDX == 0) {
    if (local_1c != 0) {
      *(undefined4 *)(in_ECX + 8) = 0xe;
      local_34 = 0x3b;
      iVar2 = FUN_00407c10(&local_34,1);
      FUN_008f9b20(local_30,iVar2 != -1,param_3);
      *(undefined4 *)(in_ECX + 8) = 0xc;
    }
  }
  else {
    FUN_008fadd0(*(undefined4 *)(in_EDX + 0x10),local_30,0,param_2,in_EDX,param_3,0,0);
    *(undefined4 *)(in_ECX + 0x24) = *(undefined4 *)(in_EDX + 0xc);
  }
  local_8 = 0xffffffff;
  if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0(uVar1);
  }
  local_18 = 7;
  local_1c = 0;
  local_2c = 0;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
008fc070 : PUSH EBP
008fc071 : MOV EBP,ESP
008fc073 : PUSH -0x1
008fc075 : PUSH 0xb68a57
008fc07a : MOV EAX,FS:[0x0]
008fc080 : PUSH EAX
008fc081 : SUB ESP,0x24
008fc084 : MOV EAX,[0x00d66fa0]
008fc089 : XOR EAX,EBP
008fc08b : MOV dword ptr [EBP + -0x10],EAX
008fc08e : PUSH EBX
008fc08f : PUSH ESI
008fc090 : PUSH EDI
008fc091 : PUSH EAX
008fc092 : LEA EAX,[EBP + -0xc]
008fc095 : MOV FS:[0x0],EAX
008fc09b : MOV EBX,dword ptr [EBP + 0x10]
008fc09e : MOV EAX,dword ptr [EBP + 0x8]
008fc0a1 : MOV ESI,ECX
008fc0a3 : XOR ECX,ECX
008fc0a5 : PUSH -0x1
008fc0a7 : PUSH ECX
008fc0a8 : MOV word ptr [EBP + -0x28],CX
008fc0ac : PUSH EAX
008fc0ad : LEA ECX,[EBP + -0x2c]
008fc0b0 : MOV EDI,EDX
008fc0b2 : MOV dword ptr [EBP + -0x14],0x7
008fc0b9 : MOV dword ptr [EBP + -0x18],0x0
008fc0c0 : CALL 0x00405eb0
008fc0c5 : MOV dword ptr [EBP + -0x4],0x0
008fc0cc : TEST EDI,EDI
008fc0ce : JZ 0x008fc138
008fc0d0 : MOV EDX,dword ptr [EBP + 0xc]
008fc0d3 : MOV EAX,dword ptr [EDI + 0x10]
008fc0d6 : PUSH 0x0
008fc0d8 : PUSH 0x0
008fc0da : PUSH EBX
008fc0db : PUSH EDI
008fc0dc : PUSH EDX
008fc0dd : PUSH 0x0
008fc0df : LEA ECX,[EBP + -0x2c]
008fc0e2 : PUSH ECX
008fc0e3 : PUSH EAX
008fc0e4 : MOV ECX,ESI
008fc0e6 : CALL 0x008fadd0
008fc0eb : MOV EDI,dword ptr [EDI + 0xc]
008fc0ee : MOV dword ptr [ESI + 0x24],EDI
008fc0f1 : MOV dword ptr [EBP + -0x4],0xffffffff
008fc0f8 : CMP dword ptr [EBP + -0x14],0x8
008fc0fc : JC 0x008fc106
008fc0fe : MOV ECX,dword ptr [EBP + -0x28]
008fc101 : CALL 0x006f04e0
008fc106 : XOR ECX,ECX
008fc108 : MOV dword ptr [EBP + -0x14],0x7
008fc10f : MOV dword ptr [EBP + -0x18],0x0
008fc116 : MOV word ptr [EBP + -0x28],CX
008fc11a : MOV ECX,dword ptr [EBP + -0xc]
008fc11d : MOV dword ptr FS:[0x0],ECX
008fc124 : POP ECX
008fc125 : POP EDI
008fc126 : POP ESI
008fc127 : POP EBX
008fc128 : MOV ECX,dword ptr [EBP + -0x10]
008fc12b : XOR ECX,EBP
008fc12d : CALL 0x00633e6b
008fc132 : MOV ESP,EBP
008fc134 : POP EBP
008fc135 : RET 0xc
008fc138 : CMP dword ptr [EBP + -0x18],0x0
008fc13c : JZ 0x008fc0f1
008fc13e : PUSH 0x1
008fc140 : LEA EDX,[EBP + -0x30]
008fc143 : PUSH EDX
008fc144 : XOR EAX,EAX
008fc146 : LEA EDX,[EBP + -0x2c]
008fc149 : MOV dword ptr [ESI + 0x8],0xe
008fc150 : MOV dword ptr [EBP + -0x30],0x3b
008fc157 : CALL 0x00407c10
008fc15c : MOV ECX,dword ptr [ESI + 0xc]
008fc15f : CMP EAX,-0x1
008fc162 : SETZ AL
008fc165 : XOR EDX,EDX
008fc167 : TEST AL,AL
008fc169 : SETZ DL
008fc16c : PUSH EBX
008fc16d : LEA EAX,[EBP + -0x2c]
008fc170 : PUSH EDX
008fc171 : PUSH EAX
008fc172 : CALL 0x008f9b20
008fc177 : MOV dword ptr [ESI + 0x8],0xc
008fc17e : JMP 0x008fc0f1

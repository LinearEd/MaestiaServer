PROGRAM  : Maestia.exe
FUNCTION : FUN_0099a4c0
ENTRY    : 0099a4c0
BODY     : [[0099a4c0, 0099a7c0]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_0099a4c0(void)

{
  int iVar1;
  void **ppvVar2;
  uint uVar3;
  int iVar4;
  undefined4 uVar5;
  int in_ECX;
  undefined4 in_EDX;
  undefined1 uVar6;
  int *piVar7;
  undefined1 local_2c [28];
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b4101b;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  iVar1 = *(int *)(*(int *)(DAT_0172491c + 0x17c) + 0xa0);
  if (in_ECX == -1) {
    ppvVar2 = &local_10;
    if (iVar1 - 10U < 0x28) {
LAB_0099a703:
      ExceptionList = ppvVar2;
      FUN_009989b0(in_EDX,1);
      ExceptionList = local_10;
      return;
    }
    if (0x3b < iVar1) goto LAB_0099a722;
    if (*DAT_00da9894 == 0) {
      return;
    }
    if (*(int *)(*DAT_00da9894 + 0x1a8) == 0) {
      return;
    }
    ExceptionList = &local_10;
    FUN_00406460(L"IDS_INVALID_LEVEL_FOR_MENTOR_SYSTEM");
    uVar6 = 8;
    local_8 = 8;
    piVar7 = *(int **)(*DAT_00da9894 + 0x1a8);
    uVar5 = FUN_0081d120(local_2c);
    local_8._0_1_ = 9;
  }
  else {
    ExceptionList = &local_10;
    iVar4 = FUN_00a1a840(in_ECX);
    if (iVar4 == 0) {
      ExceptionList = local_10;
      return;
    }
    if (0x3b < iVar1) {
      ppvVar2 = ExceptionList;
      if (*(int *)(iVar4 + 0xa0) - 10U < 0x28) {
LAB_0099a722:
        ExceptionList = ppvVar2;
        FUN_009989b0(in_EDX,2);
        ExceptionList = local_10;
        return;
      }
      if (DAT_0172491c == 0) {
        ExceptionList = local_10;
        return;
      }
      if (*DAT_00da9894 == 0) {
        ExceptionList = local_10;
        return;
      }
      if (*(int *)(*DAT_00da9894 + 0x1a8) == 0) {
        ExceptionList = local_10;
        return;
      }
      FUN_00406460(L"IDS_BUDDY_INVALID_BUDDY_PUPIL_LEVEL");
      local_8 = 0;
      piVar7 = *(int **)(*DAT_00da9894 + 0x1a8);
      uVar5 = FUN_0081d120(local_2c);
      local_8._0_1_ = 1;
      (**(code **)(*piVar7 + 0x44))(uVar5,3,uVar3);
      local_8 = (uint)local_8._1_3_ << 8;
      goto LAB_0099a798;
    }
    if (*(int *)(iVar4 + 0xa0) < 0x3c) {
      if (iVar1 - 0xbU < 0x27) {
        if (DAT_0172491c == 0) {
          ExceptionList = local_10;
          return;
        }
        if (*DAT_00da9894 == 0) {
          ExceptionList = local_10;
          return;
        }
        if (*(int *)(*DAT_00da9894 + 0x1a8) == 0) {
          ExceptionList = local_10;
          return;
        }
        FUN_00406460(L"IDS_BUDDY_INVALID_BUDDY_MASTER_LEVEL");
        uVar6 = 4;
        local_8 = 4;
        piVar7 = *(int **)(*DAT_00da9894 + 0x1a8);
        uVar5 = FUN_0081d120(local_2c);
        local_8._0_1_ = 5;
      }
      else {
        if (DAT_0172491c == 0) {
          ExceptionList = local_10;
          return;
        }
        if (*DAT_00da9894 == 0) {
          ExceptionList = local_10;
          return;
        }
        if (*(int *)(*DAT_00da9894 + 0x1a8) == 0) {
          ExceptionList = local_10;
          return;
        }
        FUN_00406460(L"IDS_INVALID_LEVEL_FOR_MENTOR_SYSTEM");
        uVar6 = 6;
        local_8 = 6;
        piVar7 = *(int **)(*DAT_00da9894 + 0x1a8);
        uVar5 = FUN_0081d120(local_2c);
        local_8._0_1_ = 7;
      }
    }
    else {
      ppvVar2 = ExceptionList;
      if (iVar1 - 10U < 0x28) goto LAB_0099a703;
      if (DAT_0172491c == 0) {
        ExceptionList = local_10;
        return;
      }
      if (*DAT_00da9894 == 0) {
        ExceptionList = local_10;
        return;
      }
      if (*(int *)(*DAT_00da9894 + 0x1a8) == 0) {
        ExceptionList = local_10;
        return;
      }
      FUN_00406460(L"IDS_INVALID_LEVEL_FOR_MENTOR_SYSTEM");
      uVar6 = 2;
      local_8 = 2;
      piVar7 = *(int **)(*DAT_00da9894 + 0x1a8);
      uVar5 = FUN_0081d120(local_2c);
      local_8._0_1_ = 3;
    }
  }
  (**(code **)(*piVar7 + 0x44))(uVar5,3);
  local_8 = CONCAT31(local_8._1_3_,uVar6);
LAB_0099a798:
  FUN_00406560();
  local_8 = 0xffffffff;
  FUN_00406560();
  ExceptionList = local_10;
  return;
}



============================================================
DISASSEMBLY
============================================================
0099a4c0 : PUSH EBP
0099a4c1 : MOV EBP,ESP
0099a4c3 : PUSH -0x1
0099a4c5 : PUSH 0xb4101b
0099a4ca : MOV EAX,FS:[0x0]
0099a4d0 : PUSH EAX
0099a4d1 : SUB ESP,0x3c
0099a4d4 : PUSH EBX
0099a4d5 : PUSH ESI
0099a4d6 : PUSH EDI
0099a4d7 : MOV EAX,[0x00d66fa0]
0099a4dc : XOR EAX,EBP
0099a4de : PUSH EAX
0099a4df : LEA EAX,[EBP + -0xc]
0099a4e2 : MOV FS:[0x0],EAX
0099a4e8 : MOV EDI,EDX
0099a4ea : MOV EAX,[0x0172491c]
0099a4ef : MOV EAX,dword ptr [EAX + 0x17c]
0099a4f5 : MOV ESI,dword ptr [EAX + 0xa0]
0099a4fb : CMP ECX,-0x1
0099a4fe : JZ 0x0099a6fb
0099a504 : PUSH ECX
0099a505 : MOV ECX,dword ptr [0x00da93ec]
0099a50b : CALL 0x00a1a840
0099a510 : TEST EAX,EAX
0099a512 : JZ 0x0099a7af
0099a518 : CMP ESI,0x3c
0099a51b : MOV EAX,dword ptr [EAX + 0xa0]
0099a521 : JL 0x0099a5aa
0099a527 : ADD EAX,-0xa
0099a52a : CMP EAX,0x27
0099a52d : JBE 0x0099a722
0099a533 : CMP dword ptr [0x0172491c],0x0
0099a53a : JZ 0x0099a7af
0099a540 : MOV ECX,dword ptr [0x00da9894]
0099a546 : MOV EAX,dword ptr [ECX]
0099a548 : TEST EAX,EAX
0099a54a : JZ 0x0099a7af
0099a550 : CMP dword ptr [EAX + 0x1a8],0x0
0099a557 : JZ 0x0099a7af
0099a55d : PUSH 0xc87db0
0099a562 : LEA ECX,[EBP + -0x28]
0099a565 : CALL 0x00406460
0099a56a : MOV dword ptr [EBP + -0x4],0x0
0099a571 : MOV EDX,dword ptr [0x00da9894]
0099a577 : MOV EAX,dword ptr [EDX]
0099a579 : MOV ESI,dword ptr [EAX + 0x1a8]
0099a57f : MOV ECX,dword ptr [0x0172491c]
0099a585 : LEA EAX,[EBP + -0x28]
0099a588 : PUSH EAX
0099a589 : LEA EDI,[EBP + -0x44]
0099a58c : CALL 0x0081d120
0099a591 : MOV byte ptr [EBP + -0x4],0x1
0099a595 : MOV EDX,dword ptr [ESI]
0099a597 : PUSH 0x3
0099a599 : PUSH EAX
0099a59a : MOV EAX,dword ptr [EDX + 0x44]
0099a59d : MOV ECX,ESI
0099a59f : CALL EAX
0099a5a1 : MOV byte ptr [EBP + -0x4],0x0
0099a5a5 : JMP 0x0099a798
0099a5aa : CMP EAX,0x3c
0099a5ad : JL 0x0099a623
0099a5af : ADD ESI,-0xa
0099a5b2 : CMP ESI,0x27
0099a5b5 : JBE 0x0099a703
0099a5bb : CMP dword ptr [0x0172491c],0x0
0099a5c2 : JZ 0x0099a7af
0099a5c8 : MOV ECX,dword ptr [0x00da9894]
0099a5ce : MOV EAX,dword ptr [ECX]
0099a5d0 : TEST EAX,EAX
0099a5d2 : JZ 0x0099a7af
0099a5d8 : CMP dword ptr [EAX + 0x1a8],0x0
0099a5df : JZ 0x0099a7af
0099a5e5 : PUSH 0xc87df8
0099a5ea : LEA ECX,[EBP + -0x28]
0099a5ed : CALL 0x00406460
0099a5f2 : MOV EBX,0x2
0099a5f7 : MOV dword ptr [EBP + -0x4],EBX
0099a5fa : MOV EDX,dword ptr [0x00da9894]
0099a600 : MOV EAX,dword ptr [EDX]
0099a602 : MOV ESI,dword ptr [EAX + 0x1a8]
0099a608 : MOV ECX,dword ptr [0x0172491c]
0099a60e : LEA EAX,[EBP + -0x28]
0099a611 : PUSH EAX
0099a612 : LEA EDI,[EBP + -0x44]
0099a615 : CALL 0x0081d120
0099a61a : MOV byte ptr [EBP + -0x4],0x3
0099a61e : JMP 0x0099a789
0099a623 : ADD ESI,-0xb
0099a626 : CMP ESI,0x26
0099a629 : JA 0x0099a693
0099a62b : CMP dword ptr [0x0172491c],0x0
0099a632 : JZ 0x0099a7af
0099a638 : MOV ECX,dword ptr [0x00da9894]
0099a63e : MOV EAX,dword ptr [ECX]
0099a640 : TEST EAX,EAX
0099a642 : JZ 0x0099a7af
0099a648 : CMP dword ptr [EAX + 0x1a8],0x0
0099a64f : JZ 0x0099a7af
0099a655 : PUSH 0xc87e40
0099a65a : LEA ECX,[EBP + -0x28]
0099a65d : CALL 0x00406460
0099a662 : MOV EBX,0x4
0099a667 : MOV dword ptr [EBP + -0x4],EBX
0099a66a : MOV EDX,dword ptr [0x00da9894]
0099a670 : MOV EAX,dword ptr [EDX]
0099a672 : MOV ESI,dword ptr [EAX + 0x1a8]
0099a678 : MOV ECX,dword ptr [0x0172491c]
0099a67e : LEA EAX,[EBP + -0x28]
0099a681 : PUSH EAX
0099a682 : LEA EDI,[EBP + -0x44]
0099a685 : CALL 0x0081d120
0099a68a : MOV byte ptr [EBP + -0x4],0x5
0099a68e : JMP 0x0099a789
0099a693 : CMP dword ptr [0x0172491c],0x0
0099a69a : JZ 0x0099a7af
0099a6a0 : MOV ECX,dword ptr [0x00da9894]
0099a6a6 : MOV EAX,dword ptr [ECX]
0099a6a8 : TEST EAX,EAX
0099a6aa : JZ 0x0099a7af
0099a6b0 : CMP dword ptr [EAX + 0x1a8],0x0
0099a6b7 : JZ 0x0099a7af
0099a6bd : PUSH 0xc87e90
0099a6c2 : LEA ECX,[EBP + -0x28]
0099a6c5 : CALL 0x00406460
0099a6ca : MOV EBX,0x6
0099a6cf : MOV dword ptr [EBP + -0x4],EBX
0099a6d2 : MOV EDX,dword ptr [0x00da9894]
0099a6d8 : MOV EAX,dword ptr [EDX]
0099a6da : MOV ESI,dword ptr [EAX + 0x1a8]
0099a6e0 : MOV ECX,dword ptr [0x0172491c]
0099a6e6 : LEA EAX,[EBP + -0x28]
0099a6e9 : PUSH EAX
0099a6ea : LEA EDI,[EBP + -0x44]
0099a6ed : CALL 0x0081d120
0099a6f2 : MOV byte ptr [EBP + -0x4],0x7
0099a6f6 : JMP 0x0099a789
0099a6fb : LEA ECX,[ESI + -0xa]
0099a6fe : CMP ECX,0x27
0099a701 : JA 0x0099a71d
0099a703 : PUSH 0x1
0099a705 : PUSH EDI
0099a706 : CALL 0x009989b0
0099a70b : MOV ECX,dword ptr [EBP + -0xc]
0099a70e : MOV dword ptr FS:[0x0],ECX
0099a715 : POP ECX
0099a716 : POP EDI
0099a717 : POP ESI
0099a718 : POP EBX
0099a719 : MOV ESP,EBP
0099a71b : POP EBP
0099a71c : RET
0099a71d : CMP ESI,0x3c
0099a720 : JL 0x0099a73c
0099a722 : PUSH 0x2
0099a724 : PUSH EDI
0099a725 : CALL 0x009989b0
0099a72a : MOV ECX,dword ptr [EBP + -0xc]
0099a72d : MOV dword ptr FS:[0x0],ECX
0099a734 : POP ECX
0099a735 : POP EDI
0099a736 : POP ESI
0099a737 : POP EBX
0099a738 : MOV ESP,EBP
0099a73a : POP EBP
0099a73b : RET
0099a73c : MOV EDX,dword ptr [0x00da9894]
0099a742 : MOV EAX,dword ptr [EDX]
0099a744 : TEST EAX,EAX
0099a746 : JZ 0x0099a7af
0099a748 : CMP dword ptr [EAX + 0x1a8],0x0
0099a74f : JZ 0x0099a7af
0099a751 : PUSH 0xc87ed8
0099a756 : LEA ECX,[EBP + -0x28]
0099a759 : CALL 0x00406460
0099a75e : MOV EBX,0x8
0099a763 : MOV dword ptr [EBP + -0x4],EBX
0099a766 : MOV EAX,[0x00da9894]
0099a76b : MOV EAX,dword ptr [EAX]
0099a76d : MOV ESI,dword ptr [EAX + 0x1a8]
0099a773 : LEA ECX,[EBP + -0x28]
0099a776 : PUSH ECX
0099a777 : MOV ECX,dword ptr [0x0172491c]
0099a77d : LEA EDI,[EBP + -0x44]
0099a780 : CALL 0x0081d120
0099a785 : MOV byte ptr [EBP + -0x4],0x9
0099a789 : MOV EDX,dword ptr [ESI]
0099a78b : PUSH 0x3
0099a78d : PUSH EAX
0099a78e : MOV EAX,dword ptr [EDX + 0x44]
0099a791 : MOV ECX,ESI
0099a793 : CALL EAX
0099a795 : MOV byte ptr [EBP + -0x4],BL
0099a798 : LEA ECX,[EBP + -0x44]
0099a79b : CALL 0x00406560
0099a7a0 : MOV dword ptr [EBP + -0x4],0xffffffff
0099a7a7 : LEA ECX,[EBP + -0x28]
0099a7aa : CALL 0x00406560
0099a7af : MOV ECX,dword ptr [EBP + -0xc]
0099a7b2 : MOV dword ptr FS:[0x0],ECX
0099a7b9 : POP ECX
0099a7ba : POP EDI
0099a7bb : POP ESI
0099a7bc : POP EBX
0099a7bd : MOV ESP,EBP
0099a7bf : POP EBP
0099a7c0 : RET

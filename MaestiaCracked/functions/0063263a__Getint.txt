PROGRAM  : Maestia.exe
FUNCTION : _Getint
ENTRY    : 0063263a
BODY     : [[0063263a, 00632784]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    private: int __cdecl std::time_get<char,class std::istreambuf_iterator<char,struct
   std::char_traits<char> > >::_Getint(class std::istreambuf_iterator<char,struct
   std::char_traits<char> > &,class std::istreambuf_iterator<char,struct std::char_traits<char> >
   &,int,int,int &)const 
   
   Library: Visual Studio 2008 Release */

int __thiscall
std::time_get<char,class_std::istreambuf_iterator<char,struct_std::char_traits<char>_>_>::_Getint
          (time_get<char,class_std::istreambuf_iterator<char,struct_std::char_traits<char>_>_> *this
          ,istreambuf_iterator<char,struct_std::char_traits<char>_> *param_1,
          istreambuf_iterator<char,struct_std::char_traits<char>_> *param_2,int param_3,int param_4,
          int *param_5)

{
  bool bVar1;
  char cVar2;
  int iVar3;
  char *pcVar4;
  int *in_stack_00000018;
  char *local_3c;
  int *local_38;
  int local_34;
  uint local_30;
  char local_29;
  char local_28 [32];
  uint local_8;
  
  local_8 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  local_38 = in_stack_00000018;
  pcVar4 = local_28;
  bVar1 = istreambuf_iterator<char,struct_std::char_traits<char>_>::equal
                    (param_2,(istreambuf_iterator<char,struct_std::char_traits<char>_> *)param_3);
  if (!bVar1) {
    cVar2 = istreambuf_iterator<char,struct_std::char_traits<char>_>::operator*(param_2);
    if (cVar2 == '+') {
      local_28[0] = '+';
    }
    else {
      cVar2 = istreambuf_iterator<char,struct_std::char_traits<char>_>::operator*(param_2);
      if (cVar2 != '-') goto LAB_00632692;
      local_28[0] = '-';
    }
    pcVar4 = local_28 + 1;
    istreambuf_iterator<char,struct_std::char_traits<char>_>::_Inc(param_2);
  }
LAB_00632692:
  local_29 = '\0';
  bVar1 = operator!=<char,struct_std::char_traits<char>_>
                    (param_2,(istreambuf_iterator<char,struct_std::char_traits<char>_> *)param_3);
  if (bVar1) {
    do {
      cVar2 = istreambuf_iterator<char,struct_std::char_traits<char>_>::operator*(param_2);
      if (cVar2 != '0') break;
      local_29 = '\x01';
      istreambuf_iterator<char,struct_std::char_traits<char>_>::_Inc(param_2);
      bVar1 = operator!=<char,struct_std::char_traits<char>_>
                        (param_2,(istreambuf_iterator<char,struct_std::char_traits<char>_> *)param_3
                        );
    } while (bVar1);
    if (local_29 != '\0') {
      *pcVar4 = '0';
      pcVar4 = pcVar4 + 1;
    }
  }
  while( true ) {
    bVar1 = operator!=<char,struct_std::char_traits<char>_>
                      (param_2,(istreambuf_iterator<char,struct_std::char_traits<char>_> *)param_3);
    if (!bVar1) break;
    cVar2 = istreambuf_iterator<char,struct_std::char_traits<char>_>::operator*(param_2);
    if (cVar2 < '0') break;
    cVar2 = istreambuf_iterator<char,struct_std::char_traits<char>_>::operator*(param_2);
    if ('9' < cVar2) break;
    cVar2 = istreambuf_iterator<char,struct_std::char_traits<char>_>::operator*(param_2);
    *pcVar4 = cVar2;
    if (pcVar4 < local_28 + 0x1f) {
      pcVar4 = pcVar4 + 1;
    }
    local_29 = '\x01';
    istreambuf_iterator<char,struct_std::char_traits<char>_>::_Inc(param_2);
  }
  if (local_29 == '\0') {
    pcVar4 = local_28;
  }
  local_34 = 0;
  *pcVar4 = '\0';
  iVar3 = __Stolx(local_28,&local_3c,10,&local_34);
  local_30 = 0;
  bVar1 = istreambuf_iterator<char,struct_std::char_traits<char>_>::equal
                    (param_2,(istreambuf_iterator<char,struct_std::char_traits<char>_> *)param_3);
  if (bVar1) {
    local_30 = 1;
  }
  if ((((local_3c == local_28) || (local_34 != 0)) || (iVar3 < param_4)) || ((int)param_5 < iVar3))
  {
    local_30 = local_30 | 2;
  }
  else {
    *local_38 = iVar3;
  }
  iVar3 = __security_check_cookie(local_8 ^ (uint)&stack0xfffffffc);
  return iVar3;
}



============================================================
DISASSEMBLY
============================================================
0063263a : MOV EDI,EDI
0063263c : PUSH EBP
0063263d : MOV EBP,ESP
0063263f : SUB ESP,0x38
00632642 : MOV EAX,[0x00d66fa0]
00632647 : XOR EAX,EBP
00632649 : MOV dword ptr [EBP + -0x4],EAX
0063264c : MOV EAX,dword ptr [EBP + 0x1c]
0063264f : PUSH EBX
00632650 : MOV EBX,dword ptr [EBP + 0x10]
00632653 : PUSH ESI
00632654 : MOV ESI,dword ptr [EBP + 0xc]
00632657 : PUSH EDI
00632658 : PUSH EBX
00632659 : MOV ECX,ESI
0063265b : MOV dword ptr [EBP + -0x34],EAX
0063265e : LEA EDI,[EBP + -0x24]
00632661 : CALL 0x00623123
00632666 : TEST AL,AL
00632668 : JNZ 0x00632692
0063266a : MOV ECX,ESI
0063266c : CALL 0x0062317a
00632671 : MOV ECX,ESI
00632673 : CMP AL,0x2b
00632675 : JNZ 0x0063267c
00632677 : MOV byte ptr [EBP + -0x24],AL
0063267a : JMP 0x0063268a
0063267c : CALL 0x0062317a
00632681 : CMP AL,0x2d
00632683 : JNZ 0x00632692
00632685 : MOV byte ptr [EBP + -0x24],AL
00632688 : MOV ECX,ESI
0063268a : LEA EDI,[EBP + -0x23]
0063268d : CALL 0x006230d9
00632692 : PUSH EBX
00632693 : PUSH ESI
00632694 : MOV byte ptr [EBP + -0x25],0x0
00632698 : CALL 0x0062318f
0063269d : POP ECX
0063269e : POP ECX
0063269f : TEST AL,AL
006326a1 : JZ 0x00632704
006326a3 : MOV ECX,ESI
006326a5 : CALL 0x0062317a
006326aa : CMP AL,0x30
006326ac : JNZ 0x006326c6
006326ae : MOV ECX,ESI
006326b0 : MOV byte ptr [EBP + -0x25],0x1
006326b4 : CALL 0x006230d9
006326b9 : PUSH EBX
006326ba : PUSH ESI
006326bb : CALL 0x0062318f
006326c0 : POP ECX
006326c1 : POP ECX
006326c2 : TEST AL,AL
006326c4 : JNZ 0x006326a3
006326c6 : CMP byte ptr [EBP + -0x25],0x0
006326ca : JZ 0x00632704
006326cc : MOV byte ptr [EDI],0x30
006326cf : INC EDI
006326d0 : JMP 0x00632704
006326d2 : MOV ECX,ESI
006326d4 : CALL 0x0062317a
006326d9 : CMP AL,0x30
006326db : JL 0x00632711
006326dd : MOV ECX,ESI
006326df : CALL 0x0062317a
006326e4 : CMP AL,0x39
006326e6 : JG 0x00632711
006326e8 : MOV ECX,ESI
006326ea : CALL 0x0062317a
006326ef : MOV byte ptr [EDI],AL
006326f1 : LEA EAX,[EBP + -0x5]
006326f4 : CMP EDI,EAX
006326f6 : JNC 0x006326f9
006326f8 : INC EDI
006326f9 : MOV ECX,ESI
006326fb : MOV byte ptr [EBP + -0x25],0x1
006326ff : CALL 0x006230d9
00632704 : PUSH EBX
00632705 : PUSH ESI
00632706 : CALL 0x0062318f
0063270b : POP ECX
0063270c : POP ECX
0063270d : TEST AL,AL
0063270f : JNZ 0x006326d2
00632711 : CMP byte ptr [EBP + -0x25],0x0
00632715 : JNZ 0x0063271a
00632717 : LEA EDI,[EBP + -0x24]
0063271a : AND dword ptr [EBP + -0x30],0x0
0063271e : LEA EAX,[EBP + -0x30]
00632721 : PUSH EAX
00632722 : PUSH 0xa
00632724 : LEA EAX,[EBP + -0x38]
00632727 : PUSH EAX
00632728 : LEA EAX,[EBP + -0x24]
0063272b : PUSH EAX
0063272c : MOV byte ptr [EDI],0x0
0063272f : CALL 0x0063331c
00632734 : AND dword ptr [EBP + -0x2c],0x0
00632738 : ADD ESP,0x10
0063273b : PUSH EBX
0063273c : MOV ECX,ESI
0063273e : MOV EDI,EAX
00632740 : CALL 0x00623123
00632745 : TEST AL,AL
00632747 : JZ 0x00632750
00632749 : MOV dword ptr [EBP + -0x2c],0x1
00632750 : LEA EAX,[EBP + -0x24]
00632753 : CMP dword ptr [EBP + -0x38],EAX
00632756 : JZ 0x0063276f
00632758 : CMP dword ptr [EBP + -0x30],0x0
0063275c : JNZ 0x0063276f
0063275e : CMP EDI,dword ptr [EBP + 0x14]
00632761 : JL 0x0063276f
00632763 : CMP dword ptr [EBP + 0x18],EDI
00632766 : JL 0x0063276f
00632768 : MOV EAX,dword ptr [EBP + -0x34]
0063276b : MOV dword ptr [EAX],EDI
0063276d : JMP 0x00632773
0063276f : OR dword ptr [EBP + -0x2c],0x2
00632773 : MOV ECX,dword ptr [EBP + -0x4]
00632776 : MOV EAX,dword ptr [EBP + -0x2c]
00632779 : POP EDI
0063277a : POP ESI
0063277b : XOR ECX,EBP
0063277d : POP EBX
0063277e : CALL 0x00633e6b
00632783 : LEAVE
00632784 : RET

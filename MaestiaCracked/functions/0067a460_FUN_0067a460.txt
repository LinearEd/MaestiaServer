PROGRAM  : Maestia.exe
FUNCTION : FUN_0067a460
ENTRY    : 0067a460
BODY     : [[0067a460, 0067a4f2]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __alloca_probe replaced with injection: alloca_probe */

void FUN_0067a460(int param_1)

{
  int iVar1;
  int in_ECX;
  undefined1 local_1004 [4096];
  uint local_4;
  
  local_4 = DAT_00d66fa0 ^ (uint)local_1004;
  iVar1 = *(int *)(in_ECX + 0x40);
  if (param_1 < iVar1) {
    if (iVar1 - *(int *)(in_ECX + 0x54) <= param_1) {
      *(int *)(in_ECX + 0x4c) = param_1;
      goto LAB_0067a4da;
    }
    FUN_0067a140();
  }
  else if (iVar1 < param_1) {
    *(int *)(in_ECX + 0x4c) = iVar1;
  }
  iVar1 = *(int *)(in_ECX + 0x4c);
  while (iVar1 < param_1) {
    iVar1 = param_1 - *(int *)(in_ECX + 0x4c);
    if (0xfff < iVar1) {
      iVar1 = 0x1000;
    }
    iVar1 = FUN_0067a2e0(local_1004,iVar1);
    if (iVar1 == 0) break;
    iVar1 = *(int *)(in_ECX + 0x4c);
  }
LAB_0067a4da:
  __security_check_cookie(local_4 ^ (uint)local_1004);
  return;
}



============================================================
DISASSEMBLY
============================================================
0067a460 : MOV EAX,0x1004
0067a465 : CALL 0x0063b780
0067a46a : MOV EAX,[0x00d66fa0]
0067a46f : XOR EAX,ESP
0067a471 : MOV dword ptr [ESP + 0x1000],EAX
0067a478 : PUSH ESI
0067a479 : MOV ESI,ECX
0067a47b : MOV EAX,dword ptr [ESI + 0x40]
0067a47e : PUSH EDI
0067a47f : MOV EDI,dword ptr [ESP + 0x1010]
0067a486 : CMP EDI,EAX
0067a488 : JGE 0x0067a49f
0067a48a : SUB EAX,dword ptr [ESI + 0x54]
0067a48d : CMP EDI,EAX
0067a48f : JL 0x0067a498
0067a491 : MOV dword ptr [ESI + 0x4c],EDI
0067a494 : MOV EAX,EDI
0067a496 : JMP 0x0067a4da
0067a498 : CALL 0x0067a140
0067a49d : JMP 0x0067a4a4
0067a49f : JLE 0x0067a4a4
0067a4a1 : MOV dword ptr [ESI + 0x4c],EAX
0067a4a4 : CMP dword ptr [ESI + 0x4c],EDI
0067a4a7 : JGE 0x0067a4d7
0067a4a9 : LEA ESP,[ESP]
0067a4b0 : MOV EAX,EDI
0067a4b2 : SUB EAX,dword ptr [ESI + 0x4c]
0067a4b5 : CMP EAX,0x1000
0067a4ba : JL 0x0067a4c1
0067a4bc : MOV EAX,0x1000
0067a4c1 : PUSH EAX
0067a4c2 : LEA EAX,[ESP + 0xc]
0067a4c6 : PUSH EAX
0067a4c7 : MOV ECX,ESI
0067a4c9 : CALL 0x0067a2e0
0067a4ce : TEST EAX,EAX
0067a4d0 : JZ 0x0067a4d7
0067a4d2 : CMP dword ptr [ESI + 0x4c],EDI
0067a4d5 : JL 0x0067a4b0
0067a4d7 : MOV EAX,dword ptr [ESI + 0x4c]
0067a4da : MOV ECX,dword ptr [ESP + 0x1008]
0067a4e1 : POP EDI
0067a4e2 : POP ESI
0067a4e3 : XOR ECX,ESP
0067a4e5 : CALL 0x00633e6b
0067a4ea : ADD ESP,0x1004
0067a4f0 : RET 0x4

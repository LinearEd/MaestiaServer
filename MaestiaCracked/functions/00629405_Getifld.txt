PROGRAM  : Maestia.exe
FUNCTION : Getifld
ENTRY    : 00629405
BODY     : [[00629405, 00629754]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Function: __EH_prolog3_GS replaced with injection: EH_prolog3 */
/* Library Function - Multiple Matches With Same Base Name
    private: int __cdecl std::num_get<unsigned short,class std::istreambuf_iterator<unsigned
   short,struct std::char_traits<unsigned short> > >::_Getifld(char *,class
   std::istreambuf_iterator<unsigned short,struct std::char_traits<unsigned short> > &,class
   std::istreambuf_iterator<unsigned short,struct std::char_traits<unsigned short> > &,int,class
   std::locale const &)const 
    private: int __cdecl std::num_get<wchar_t,class std::istreambuf_iterator<wchar_t,struct
   std::char_traits<wchar_t> > >::_Getifld(char *,class std::istreambuf_iterator<wchar_t,struct
   std::char_traits<wchar_t> > &,class std::istreambuf_iterator<wchar_t,struct
   std::char_traits<wchar_t> > &,int,class std::locale const &)const 
   
   Library: Visual Studio 2008 Release */

void Getifld(int param_1,char *param_2,undefined4 param_3,undefined4 param_4,uint param_5,
            undefined4 param_6)

{
  bool bVar1;
  char cVar2;
  byte bVar3;
  short sVar4;
  short sVar5;
  short sVar6;
  short sVar7;
  undefined2 uVar8;
  int *piVar9;
  void *pvVar10;
  char *pcVar11;
  int iVar12;
  char ****ppppcVar13;
  size_t local_68;
  char local_5c;
  char *local_58;
  undefined1 local_4c [4];
  char ***local_48 [4];
  int local_38;
  uint local_34;
  undefined4 local_8;
  undefined4 uStack_4;
  
  uStack_4 = 100;
  local_8 = 0x629411;
  piVar9 = (int *)use_facet<>(param_6);
  grouping(local_4c);
  sVar4 = 0;
  local_8 = 0;
  if (local_38 != 0) {
    sVar4 = (**(code **)(*piVar9 + 8))();
  }
  param_1 = param_1 + 8;
  sVar5 = _Maklocchr<>(0x30,0,param_1);
  local_58 = param_2;
  cVar2 = equal(param_4);
  if (cVar2 == '\0') {
    sVar6 = _Maklocchr<>(0x2b,0,param_1);
    sVar7 = FID_conflict_operator_();
    if (sVar7 == sVar6) {
      *param_2 = '+';
    }
    else {
      sVar6 = _Maklocchr<>(0x2d,0,param_1);
      sVar7 = FID_conflict_operator_();
      if (sVar7 != sVar6) goto LAB_006294cd;
      *param_2 = '-';
    }
    local_58 = param_2 + 1;
    Inc();
  }
LAB_006294cd:
  param_5 = param_5 & 0xe00;
  if (param_5 == 0x400) {
    bVar3 = 8;
  }
  else if (param_5 == 0x800) {
    bVar3 = 0x10;
  }
  else {
    bVar3 = -(param_5 != 0) & 10;
  }
  local_5c = '\0';
  bVar1 = false;
  cVar2 = operator!=<>(param_3,param_4);
  if (cVar2 == '\0') {
LAB_006295ae:
    if (bVar3 != 0) {
LAB_006295b4:
      if (bVar3 != 10) goto LAB_006295ba;
    }
    local_68 = 10;
  }
  else {
    sVar6 = FID_conflict_operator_();
    if (sVar6 != sVar5) goto LAB_006295ae;
    local_5c = '\x01';
    Inc();
    cVar2 = operator!=<>(param_3,param_4);
    if (cVar2 == '\0') {
LAB_006295a1:
      if (bVar3 == 0) {
        bVar3 = 8;
        goto LAB_006295ae;
      }
      goto LAB_006295b4;
    }
    sVar5 = _Maklocchr<>(0x78,0,param_1);
    sVar6 = FID_conflict_operator_();
    if (sVar6 != sVar5) {
      sVar5 = _Maklocchr<>(0x58,0,param_1);
      sVar6 = FID_conflict_operator_();
      if (sVar6 != sVar5) goto LAB_006295a1;
    }
    if ((bVar3 != 0) && (bVar3 != 0x10)) goto LAB_006295a1;
    bVar3 = 0x10;
    local_5c = '\0';
    Inc();
LAB_006295ba:
    local_68 = ((bVar3 != 8) - 1 & 0xfffffff2) + 0x16;
  }
  FUN_004d1280(1,local_5c);
  local_8 = CONCAT31(local_8._1_3_,1);
  iVar12 = 0;
  cVar2 = operator!=<>(param_3,param_4);
  if (cVar2 != '\0') {
    do {
      uVar8 = FID_conflict_operator_(param_1);
      cVar2 = _Maklocbyte<>(uVar8);
      *local_58 = cVar2;
      pvVar10 = _memchr("0123456789abcdefABCDEF",(int)cVar2,local_68);
      if (pvVar10 == (void *)0x0) {
        pcVar11 = (char *)FUN_004d3b30(iVar12);
        if ((*pcVar11 == '\0') || (sVar4 == 0)) break;
        sVar5 = FID_conflict_operator_();
        if (sVar5 != sVar4) break;
        FUN_004d12b0(1,0);
        iVar12 = iVar12 + 1;
      }
      else {
        if (((bVar1) || (*local_58 != '0')) && (local_58 < param_2 + 0x1f)) {
          local_58 = local_58 + 1;
          bVar1 = true;
        }
        local_5c = '\x01';
        pcVar11 = (char *)FUN_004d3b30(iVar12);
        if (*pcVar11 != '\x7f') {
          pcVar11 = (char *)FUN_004d3b30(iVar12);
          *pcVar11 = *pcVar11 + '\x01';
        }
      }
      Inc();
      cVar2 = operator!=<>(param_3,param_4);
    } while (cVar2 != '\0');
    if (iVar12 != 0) {
      pcVar11 = (char *)FUN_004d3b30(iVar12);
      if (*pcVar11 < '\x01') {
        local_5c = '\0';
      }
      else {
        iVar12 = iVar12 + 1;
      }
    }
  }
  if (local_34 < 0x10) {
    local_48[0] = (char ***)local_48;
  }
  ppppcVar13 = (char ****)local_48[0];
  if (local_5c == '\0') {
LAB_00629728:
    local_58 = param_2;
  }
  else {
    while ((iVar12 != 0 && (*(char *)ppppcVar13 != '\x7f'))) {
      iVar12 = iVar12 + -1;
      if (iVar12 != 0) {
        pcVar11 = (char *)FUN_004d3b30(iVar12);
        if (*(char *)ppppcVar13 != *pcVar11) goto LAB_00629728;
      }
      if (iVar12 == 0) {
        pcVar11 = (char *)FUN_004d3b30(0);
        if (*(char *)ppppcVar13 < *pcVar11) goto LAB_00629728;
      }
      if ('\0' < *(char *)((int)ppppcVar13 + 1)) {
        ppppcVar13 = (char ****)((int)ppppcVar13 + 1);
      }
    }
    if (!bVar1) {
      *local_58 = '0';
      local_58 = local_58 + 1;
    }
  }
  *local_58 = '\0';
  FUN_00405260(1,0);
  FUN_00405260(1,0);
  FUN_00640ed0();
  return;
}



============================================================
DISASSEMBLY
============================================================
00629405 : PUSH 0x64
00629407 : MOV EAX,0xb0ba0b
0062940c : CALL 0x00640e86
00629411 : MOV EAX,dword ptr [EBP + 0xc]
00629414 : MOV ESI,dword ptr [EBP + 0x8]
00629417 : MOV EDI,dword ptr [EBP + 0x10]
0062941a : MOV dword ptr [EBP + -0x6c],EAX
0062941d : MOV EAX,dword ptr [EBP + 0x14]
00629420 : MOV dword ptr [EBP + -0x5c],EAX
00629423 : MOV EAX,dword ptr [EBP + 0x1c]
00629426 : PUSH EAX
00629427 : CALL 0x006284b1
0062942c : MOV EBX,EAX
0062942e : POP ECX
0062942f : LEA EAX,[EBP + -0x48]
00629432 : PUSH EAX
00629433 : MOV ECX,EBX
00629435 : CALL 0x006269c7
0062943a : XOR EAX,EAX
0062943c : MOV dword ptr [EBP + -0x4],EAX
0062943f : CMP dword ptr [EBP + -0x34],EAX
00629442 : JZ 0x0062944e
00629444 : MOV EAX,dword ptr [EBX]
00629446 : MOV ECX,EBX
00629448 : CALL dword ptr [EAX + 0x8]
0062944b : MOVZX EAX,AX
0062944e : LEA EBX,[ESI + 0x8]
00629451 : PUSH EBX
00629452 : PUSH 0x0
00629454 : PUSH 0x30
00629456 : MOV dword ptr [EBP + -0x68],EAX
00629459 : MOV dword ptr [EBP + -0x60],EBX
0062945c : CALL 0x00624d6c
00629461 : MOV ESI,dword ptr [EBP + -0x6c]
00629464 : ADD ESP,0xc
00629467 : PUSH dword ptr [EBP + -0x5c]
0062946a : MOVZX EAX,AX
0062946d : MOV ECX,EDI
0062946f : MOV dword ptr [EBP + -0x64],EAX
00629472 : MOV dword ptr [EBP + -0x54],ESI
00629475 : CALL 0x0062638a
0062947a : TEST AL,AL
0062947c : JNZ 0x006294cd
0062947e : PUSH EBX
0062947f : PUSH 0x0
00629481 : PUSH 0x2b
00629483 : CALL 0x00624d6c
00629488 : ADD ESP,0xc
0062948b : MOV ECX,EDI
0062948d : MOV BX,AX
00629490 : CALL 0x00626573
00629495 : CMP AX,BX
00629498 : JNZ 0x0062949f
0062949a : MOV byte ptr [ESI],0x2b
0062949d : JMP 0x006294c0
0062949f : PUSH dword ptr [EBP + -0x60]
006294a2 : PUSH 0x0
006294a4 : PUSH 0x2d
006294a6 : CALL 0x00624d6c
006294ab : ADD ESP,0xc
006294ae : MOV ECX,EDI
006294b0 : MOV BX,AX
006294b3 : CALL 0x00626573
006294b8 : CMP AX,BX
006294bb : JNZ 0x006294cd
006294bd : MOV byte ptr [ESI],0x2d
006294c0 : LEA EAX,[ESI + 0x1]
006294c3 : MOV ECX,EDI
006294c5 : MOV dword ptr [EBP + -0x54],EAX
006294c8 : CALL 0x006262d9
006294cd : MOV EAX,dword ptr [EBP + 0x18]
006294d0 : AND EAX,0xe00
006294d5 : CMP EAX,0x400
006294da : JNZ 0x006294e5
006294dc : MOV dword ptr [EBP + -0x50],0x8
006294e3 : JMP 0x006294ff
006294e5 : CMP EAX,0x800
006294ea : JNZ 0x006294f5
006294ec : MOV dword ptr [EBP + -0x50],0x10
006294f3 : JMP 0x006294ff
006294f5 : NEG EAX
006294f7 : SBB EAX,EAX
006294f9 : AND EAX,0xa
006294fc : MOV dword ptr [EBP + -0x50],EAX
006294ff : PUSH dword ptr [EBP + -0x5c]
00629502 : MOV byte ptr [EBP + -0x58],0x0
00629506 : PUSH EDI
00629507 : MOV byte ptr [EBP + -0x49],0x0
0062950b : CALL 0x0062685b
00629510 : POP ECX
00629511 : POP ECX
00629512 : TEST AL,AL
00629514 : JZ 0x006295ae
0062951a : MOV ECX,EDI
0062951c : CALL 0x00626573
00629521 : CMP AX,word ptr [EBP + -0x64]
00629525 : JNZ 0x006295ae
0062952b : MOV ECX,EDI
0062952d : MOV byte ptr [EBP + -0x58],0x1
00629531 : CALL 0x006262d9
00629536 : PUSH dword ptr [EBP + -0x5c]
00629539 : PUSH EDI
0062953a : CALL 0x0062685b
0062953f : POP ECX
00629540 : POP ECX
00629541 : TEST AL,AL
00629543 : JZ 0x006295a1
00629545 : PUSH dword ptr [EBP + -0x60]
00629548 : PUSH 0x0
0062954a : PUSH 0x78
0062954c : CALL 0x00624d6c
00629551 : ADD ESP,0xc
00629554 : MOV ECX,EDI
00629556 : MOV BX,AX
00629559 : CALL 0x00626573
0062955e : CMP AX,BX
00629561 : JZ 0x00629581
00629563 : PUSH dword ptr [EBP + -0x60]
00629566 : PUSH 0x0
00629568 : PUSH 0x58
0062956a : CALL 0x00624d6c
0062956f : ADD ESP,0xc
00629572 : MOV ECX,EDI
00629574 : MOV BX,AX
00629577 : CALL 0x00626573
0062957c : CMP AX,BX
0062957f : JNZ 0x006295a1
00629581 : CMP dword ptr [EBP + -0x50],0x0
00629585 : JZ 0x0062958d
00629587 : CMP dword ptr [EBP + -0x50],0x10
0062958b : JNZ 0x006295a1
0062958d : MOV ECX,EDI
0062958f : MOV dword ptr [EBP + -0x50],0x10
00629596 : MOV byte ptr [EBP + -0x58],0x0
0062959a : CALL 0x006262d9
0062959f : JMP 0x006295ba
006295a1 : CMP dword ptr [EBP + -0x50],0x0
006295a5 : JNZ 0x006295b4
006295a7 : MOV dword ptr [EBP + -0x50],0x8
006295ae : CMP dword ptr [EBP + -0x50],0x0
006295b2 : JZ 0x006295cf
006295b4 : CMP dword ptr [EBP + -0x50],0xa
006295b8 : JZ 0x006295cf
006295ba : XOR EAX,EAX
006295bc : CMP dword ptr [EBP + -0x50],0x8
006295c0 : SETNZ AL
006295c3 : DEC EAX
006295c4 : AND EAX,0xfffffff2
006295c7 : ADD EAX,0x16
006295ca : MOV dword ptr [EBP + -0x64],EAX
006295cd : JMP 0x006295d6
006295cf : MOV dword ptr [EBP + -0x64],0xa
006295d6 : PUSH dword ptr [EBP + -0x58]
006295d9 : LEA ECX,[EBP + -0x2c]
006295dc : PUSH 0x1
006295de : CALL 0x004d1280
006295e3 : PUSH dword ptr [EBP + -0x5c]
006295e6 : ADD ESI,0x1f
006295e9 : PUSH EDI
006295ea : MOV byte ptr [EBP + -0x4],0x1
006295ee : XOR EBX,EBX
006295f0 : MOV dword ptr [EBP + -0x70],ESI
006295f3 : CALL 0x0062685b
006295f8 : POP ECX
006295f9 : POP ECX
006295fa : TEST AL,AL
006295fc : JZ 0x006296cb
00629602 : PUSH dword ptr [EBP + -0x60]
00629605 : MOV ECX,EDI
00629607 : CALL 0x00626573
0062960c : MOVZX EAX,AX
0062960f : PUSH EAX
00629610 : CALL 0x00625942
00629615 : MOV ESI,dword ptr [EBP + -0x54]
00629618 : PUSH dword ptr [EBP + -0x64]
0062961b : MOV byte ptr [ESI],AL
0062961d : MOVSX EAX,AL
00629620 : PUSH EAX
00629621 : PUSH 0xb95a40
00629626 : CALL 0x00635250
0062962b : ADD ESP,0x14
0062962e : TEST EAX,EAX
00629630 : JZ 0x00629669
00629632 : CMP byte ptr [EBP + -0x49],0x0
00629636 : JNZ 0x0062963d
00629638 : CMP byte ptr [ESI],0x30
0062963b : JZ 0x0062964a
0062963d : CMP ESI,dword ptr [EBP + -0x70]
00629640 : JNC 0x0062964a
00629642 : INC ESI
00629643 : MOV dword ptr [EBP + -0x54],ESI
00629646 : MOV byte ptr [EBP + -0x49],0x1
0062964a : PUSH EBX
0062964b : LEA ECX,[EBP + -0x2c]
0062964e : MOV byte ptr [EBP + -0x58],0x1
00629652 : CALL 0x004d3b30
00629657 : CMP byte ptr [EAX],0x7f
0062965a : JZ 0x00629698
0062965c : PUSH EBX
0062965d : LEA ECX,[EBP + -0x2c]
00629660 : CALL 0x004d3b30
00629665 : INC byte ptr [EAX]
00629667 : JMP 0x00629698
00629669 : PUSH EBX
0062966a : LEA ECX,[EBP + -0x2c]
0062966d : CALL 0x004d3b30
00629672 : CMP byte ptr [EAX],0x0
00629675 : JZ 0x006296b2
00629677 : CMP word ptr [EBP + -0x68],0x0
0062967c : JZ 0x006296b2
0062967e : MOV ECX,EDI
00629680 : CALL 0x00626573
00629685 : CMP AX,word ptr [EBP + -0x68]
00629689 : JNZ 0x006296b2
0062968b : PUSH 0x0
0062968d : PUSH 0x1
0062968f : LEA ECX,[EBP + -0x2c]
00629692 : CALL 0x004d12b0
00629697 : INC EBX
00629698 : MOV ECX,EDI
0062969a : CALL 0x006262d9
0062969f : PUSH dword ptr [EBP + -0x5c]
006296a2 : PUSH EDI
006296a3 : CALL 0x0062685b
006296a8 : POP ECX
006296a9 : POP ECX
006296aa : TEST AL,AL
006296ac : JNZ 0x00629602
006296b2 : TEST EBX,EBX
006296b4 : JZ 0x006296cb
006296b6 : PUSH EBX
006296b7 : LEA ECX,[EBP + -0x2c]
006296ba : CALL 0x004d3b30
006296bf : CMP byte ptr [EAX],0x0
006296c2 : JLE 0x006296c7
006296c4 : INC EBX
006296c5 : JMP 0x006296cb
006296c7 : MOV byte ptr [EBP + -0x58],0x0
006296cb : CMP dword ptr [EBP + -0x30],0x10
006296cf : MOV ESI,dword ptr [EBP + -0x44]
006296d2 : JNC 0x006296d7
006296d4 : LEA ESI,[EBP + -0x44]
006296d7 : CMP byte ptr [EBP + -0x58],0x0
006296db : JZ 0x00629728
006296dd : TEST EBX,EBX
006296df : JBE 0x00629717
006296e1 : CMP byte ptr [ESI],0x7f
006296e4 : JZ 0x00629717
006296e6 : DEC EBX
006296e7 : JZ 0x006296f8
006296e9 : PUSH EBX
006296ea : LEA ECX,[EBP + -0x2c]
006296ed : CALL 0x004d3b30
006296f2 : MOV CL,byte ptr [ESI]
006296f4 : CMP CL,byte ptr [EAX]
006296f6 : JNZ 0x00629728
006296f8 : TEST EBX,EBX
006296fa : JNZ 0x0062970b
006296fc : PUSH EBX
006296fd : LEA ECX,[EBP + -0x2c]
00629700 : CALL 0x004d3b30
00629705 : MOV CL,byte ptr [ESI]
00629707 : CMP CL,byte ptr [EAX]
00629709 : JL 0x00629728
0062970b : LEA EAX,[ESI + 0x1]
0062970e : CMP byte ptr [EAX],0x0
00629711 : JLE 0x006296dd
00629713 : MOV ESI,EAX
00629715 : JMP 0x006296dd
00629717 : CMP byte ptr [EBP + -0x49],0x0
0062971b : JNZ 0x0062972e
0062971d : MOV EAX,dword ptr [EBP + -0x54]
00629720 : INC dword ptr [EBP + -0x54]
00629723 : MOV byte ptr [EAX],0x30
00629726 : JMP 0x0062972e
00629728 : MOV EAX,dword ptr [EBP + -0x6c]
0062972b : MOV dword ptr [EBP + -0x54],EAX
0062972e : MOV EAX,dword ptr [EBP + -0x54]
00629731 : PUSH 0x0
00629733 : PUSH 0x1
00629735 : LEA ECX,[EBP + -0x2c]
00629738 : MOV byte ptr [EAX],0x0
0062973b : CALL 0x00405260
00629740 : PUSH 0x0
00629742 : PUSH 0x1
00629744 : LEA ECX,[EBP + -0x48]
00629747 : CALL 0x00405260
0062974c : MOV EAX,dword ptr [EBP + -0x50]
0062974f : CALL 0x00640ed0
00629754 : RET

PROGRAM  : Maestia.exe
FUNCTION : FUN_00a0f1e0
ENTRY    : 00a0f1e0
BODY     : [[00a0f1e0, 00a0f4b8]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a0f1e0(int param_1,int param_2)

{
  short sVar1;
  uint uVar2;
  wchar_t *_FullPath;
  errno_t eVar3;
  short *psVar4;
  undefined4 *puVar5;
  int iVar6;
  DWORD DVar7;
  undefined4 *puVar8;
  undefined4 uVar9;
  short *psVar10;
  undefined4 *puVar11;
  undefined1 local_474 [4];
  undefined2 local_470;
  undefined4 local_460;
  uint local_45c;
  int local_458;
  int local_454;
  undefined4 *local_450;
  undefined1 local_44c [4];
  undefined4 local_448;
  undefined4 local_438;
  uint local_434;
  undefined1 local_430 [4];
  undefined2 local_42c;
  undefined4 local_41c;
  uint local_418;
  undefined1 local_414 [512];
  wchar_t local_214 [128];
  wchar_t local_114 [128];
  uint local_14;
  void *local_10;
  undefined1 *puStack_c;
  int local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b25f9c;
  local_10 = ExceptionList;
  uVar2 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  local_454 = param_1;
  local_458 = param_2;
  if (*(uint *)(param_2 + 0x18) < 8) {
    _FullPath = (wchar_t *)(param_2 + 4);
  }
  else {
    _FullPath = *(wchar_t **)(param_2 + 4);
  }
  local_450 = (undefined4 *)(param_2 + 4);
  local_14 = uVar2;
  __wsplitpath(_FullPath,(wchar_t *)0x0,(wchar_t *)0x0,local_114,local_214);
  eVar3 = _wcscat_s(local_114,0x80,local_214);
  psVar4 = (short *)(~-(uint)(eVar3 != 0) & (uint)local_114);
  local_42c = 0;
  local_418 = 7;
  local_41c = 0;
  psVar10 = psVar4;
  do {
    sVar1 = *psVar10;
    psVar10 = psVar10 + 1;
  } while (sVar1 != 0);
  FUN_00406360(psVar4,(int)psVar10 - (int)(psVar4 + 1) >> 1);
  local_8 = 0;
  FUN_00403510(local_474,uVar2);
  local_8._0_1_ = 1;
  FUN_00403450(local_44c,local_430);
  puVar8 = local_450;
  local_8._0_1_ = 3;
  if (7 < local_45c) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  local_45c = 7;
  local_460 = 0;
  local_470 = 0;
  puVar11 = local_448;
  if (local_434 < 8) {
    puVar11 = &local_448;
  }
  puVar5 = local_450;
  if (7 < *(uint *)(local_458 + 0x18)) {
    puVar5 = (undefined4 *)*local_450;
  }
  iVar6 = FtpPutFileW(*(undefined4 *)(local_454 + 8),puVar5,puVar11,0x80000002,0);
  if (iVar6 == 0) {
    local_454 = 0xff;
    InternetGetLastResponseInfoW(&local_450,local_414,&local_454);
    DVar7 = GetLastError();
    (*(code *)PTR_FUN_00d6d23c)(&DAT_00cbd85c,DVar7);
    if (7 < *(uint *)(local_458 + 0x18)) {
      puVar8 = (undefined4 *)*puVar8;
    }
    uVar9 = FUN_0070cf00(puVar8);
    (*(code *)PTR_FUN_00d6d23c)(&DAT_00cbd86c,uVar9);
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_434) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_434 = 7;
    local_438 = 0;
    local_448 = (undefined4 *)((uint)local_448._2_2_ << 0x10);
    local_8 = 0xffffffff;
    if (7 < local_418) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  else {
    (*(code *)PTR_FUN_00d6d23c)(&DAT_00cbd870);
    local_8 = (uint)local_8._1_3_ << 8;
    if (7 < local_434) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
    local_434 = 7;
    local_438 = 0;
    local_448 = (undefined4 *)((uint)local_448._2_2_ << 0x10);
    local_8 = 0xffffffff;
    if (7 < local_418) {
                    /* WARNING: Subroutine does not return */
      FUN_006f04e0();
    }
  }
  local_8 = 0xffffffff;
  local_42c = 0;
  local_434 = 7;
  local_438 = 0;
  local_41c = 0;
  local_418 = 7;
  ExceptionList = local_10;
  __security_check_cookie(local_14 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a0f1e0 : PUSH EBP
00a0f1e1 : MOV EBP,ESP
00a0f1e3 : PUSH -0x1
00a0f1e5 : PUSH 0xb25f9c
00a0f1ea : MOV EAX,FS:[0x0]
00a0f1f0 : PUSH EAX
00a0f1f1 : SUB ESP,0x464
00a0f1f7 : MOV EAX,[0x00d66fa0]
00a0f1fc : XOR EAX,EBP
00a0f1fe : MOV dword ptr [EBP + -0x10],EAX
00a0f201 : PUSH EBX
00a0f202 : PUSH ESI
00a0f203 : PUSH EDI
00a0f204 : PUSH EAX
00a0f205 : LEA EAX,[EBP + -0xc]
00a0f208 : MOV FS:[0x0],EAX
00a0f20e : MOV EAX,dword ptr [EBP + 0x8]
00a0f211 : MOV dword ptr [EBP + 0xfffffbb0],EAX
00a0f217 : MOV EAX,dword ptr [EBP + 0xc]
00a0f21a : CMP dword ptr [EAX + 0x18],0x8
00a0f21e : MOV EDI,ECX
00a0f220 : MOV dword ptr [EBP + 0xfffffbac],EAX
00a0f226 : JC 0x00a0f235
00a0f228 : ADD EAX,0x4
00a0f22b : MOV dword ptr [EBP + 0xfffffbb4],EAX
00a0f231 : MOV EAX,dword ptr [EAX]
00a0f233 : JMP 0x00a0f23e
00a0f235 : ADD EAX,0x4
00a0f238 : MOV dword ptr [EBP + 0xfffffbb4],EAX
00a0f23e : LEA ECX,[EBP + 0xfffffdf0]
00a0f244 : PUSH ECX
00a0f245 : LEA EDX,[EBP + 0xfffffef0]
00a0f24b : PUSH EDX
00a0f24c : XOR EBX,EBX
00a0f24e : PUSH EBX
00a0f24f : PUSH EBX
00a0f250 : PUSH EAX
00a0f251 : CALL 0x00636e00
00a0f256 : LEA EAX,[EBP + 0xfffffdf0]
00a0f25c : PUSH EAX
00a0f25d : LEA ECX,[EBP + 0xfffffef0]
00a0f263 : PUSH 0x80
00a0f268 : PUSH ECX
00a0f269 : CALL 0x006362c1
00a0f26e : ADD ESP,0x20
00a0f271 : NEG EAX
00a0f273 : SBB EAX,EAX
00a0f275 : NOT EAX
00a0f277 : LEA EDX,[EBP + 0xfffffef0]
00a0f27d : AND EAX,EDX
00a0f27f : XOR ECX,ECX
00a0f281 : MOV word ptr [EBP + 0xfffffbd8],CX
00a0f288 : MOV ECX,EAX
00a0f28a : MOV dword ptr [EBP + 0xfffffbec],0x7
00a0f294 : MOV dword ptr [EBP + 0xfffffbe8],EBX
00a0f29a : LEA ESI,[ECX + 0x2]
00a0f29d : LEA ECX,[ECX]
00a0f2a0 : MOV DX,word ptr [ECX]
00a0f2a3 : ADD ECX,0x2
00a0f2a6 : CMP DX,BX
00a0f2a9 : JNZ 0x00a0f2a0
00a0f2ab : SUB ECX,ESI
00a0f2ad : SAR ECX,0x1
00a0f2af : PUSH ECX
00a0f2b0 : PUSH EAX
00a0f2b1 : LEA ECX,[EBP + 0xfffffbd4]
00a0f2b7 : CALL 0x00406360
00a0f2bc : MOV dword ptr [EBP + -0x4],EBX
00a0f2bf : LEA EDX,[EBP + 0xfffffb90]
00a0f2c5 : PUSH EDX
00a0f2c6 : MOV EDX,0xcbd858
00a0f2cb : MOV ECX,EDI
00a0f2cd : CALL 0x00403510
00a0f2d2 : MOV byte ptr [EBP + -0x4],0x1
00a0f2d6 : LEA ECX,[EBP + 0xfffffbd4]
00a0f2dc : PUSH ECX
00a0f2dd : LEA EDX,[EBP + 0xfffffbb8]
00a0f2e3 : PUSH EDX
00a0f2e4 : MOV ECX,EAX
00a0f2e6 : CALL 0x00403450
00a0f2eb : ADD ESP,0xc
00a0f2ee : MOV byte ptr [EBP + -0x4],0x3
00a0f2f2 : MOV ESI,0x8
00a0f2f7 : CMP dword ptr [EBP + 0xfffffba8],ESI
00a0f2fd : JC 0x00a0f30a
00a0f2ff : MOV ECX,dword ptr [EBP + 0xfffffb94]
00a0f305 : CALL 0x006f04e0
00a0f30a : MOV ECX,dword ptr [EBP + 0xfffffbbc]
00a0f310 : XOR EAX,EAX
00a0f312 : MOV dword ptr [EBP + 0xfffffba8],0x7
00a0f31c : MOV dword ptr [EBP + 0xfffffba4],EBX
00a0f322 : MOV word ptr [EBP + 0xfffffb94],AX
00a0f329 : CMP dword ptr [EBP + 0xfffffbd0],ESI
00a0f32f : JNC 0x00a0f337
00a0f331 : LEA ECX,[EBP + 0xfffffbbc]
00a0f337 : MOV EDX,dword ptr [EBP + 0xfffffbac]
00a0f33d : MOV EDI,dword ptr [EBP + 0xfffffbb4]
00a0f343 : CMP dword ptr [EDX + 0x18],ESI
00a0f346 : JC 0x00a0f34c
00a0f348 : MOV EAX,dword ptr [EDI]
00a0f34a : JMP 0x00a0f352
00a0f34c : MOV EAX,dword ptr [EBP + 0xfffffbb4]
00a0f352 : PUSH EBX
00a0f353 : PUSH 0x80000002
00a0f358 : PUSH ECX
00a0f359 : PUSH EAX
00a0f35a : MOV EAX,dword ptr [EBP + 0xfffffbb0]
00a0f360 : MOV ECX,dword ptr [EAX + 0x8]
00a0f363 : PUSH ECX
00a0f364 : CALL dword ptr [0x00b85558]
00a0f36a : CMP EAX,EBX
00a0f36c : JNZ 0x00a0f429
00a0f372 : LEA EDX,[EBP + 0xfffffbb0]
00a0f378 : PUSH EDX
00a0f379 : LEA EAX,[EBP + 0xfffffbf0]
00a0f37f : PUSH EAX
00a0f380 : LEA ECX,[EBP + 0xfffffbb4]
00a0f386 : PUSH ECX
00a0f387 : MOV dword ptr [EBP + 0xfffffbb0],0xff
00a0f391 : CALL dword ptr [0x00b8555c]
00a0f397 : CALL dword ptr [0x00b85128]
00a0f39d : PUSH EAX
00a0f39e : PUSH 0xcbd85c
00a0f3a3 : CALL dword ptr [0x00d6d23c]
00a0f3a9 : MOV EDX,dword ptr [EBP + 0xfffffbac]
00a0f3af : ADD ESP,0x8
00a0f3b2 : CMP dword ptr [EDX + 0x18],ESI
00a0f3b5 : JC 0x00a0f3bb
00a0f3b7 : MOV EAX,dword ptr [EDI]
00a0f3b9 : JMP 0x00a0f3bd
00a0f3bb : MOV EAX,EDI
00a0f3bd : PUSH EAX
00a0f3be : CALL 0x0070cf00
00a0f3c3 : PUSH EAX
00a0f3c4 : PUSH 0xcbd86c
00a0f3c9 : CALL dword ptr [0x00d6d23c]
00a0f3cf : ADD ESP,0xc
00a0f3d2 : MOV byte ptr [EBP + -0x4],BL
00a0f3d5 : CMP dword ptr [EBP + 0xfffffbd0],ESI
00a0f3db : JC 0x00a0f3e8
00a0f3dd : MOV ECX,dword ptr [EBP + 0xfffffbbc]
00a0f3e3 : CALL 0x006f04e0
00a0f3e8 : MOV EDI,0x7
00a0f3ed : XOR EAX,EAX
00a0f3ef : MOV dword ptr [EBP + 0xfffffbd0],EDI
00a0f3f5 : MOV dword ptr [EBP + 0xfffffbcc],EBX
00a0f3fb : MOV word ptr [EBP + 0xfffffbbc],AX
00a0f402 : MOV dword ptr [EBP + -0x4],0xffffffff
00a0f409 : CMP dword ptr [EBP + 0xfffffbec],ESI
00a0f40f : JC 0x00a0f41c
00a0f411 : MOV ECX,dword ptr [EBP + 0xfffffbd8]
00a0f417 : CALL 0x006f04e0
00a0f41c : XOR ECX,ECX
00a0f41e : MOV word ptr [EBP + 0xfffffbd8],CX
00a0f425 : XOR EAX,EAX
00a0f427 : JMP 0x00a0f48f
00a0f429 : PUSH 0xcbd870
00a0f42e : CALL dword ptr [0x00d6d23c]
00a0f434 : ADD ESP,0x4
00a0f437 : MOV byte ptr [EBP + -0x4],BL
00a0f43a : CMP dword ptr [EBP + 0xfffffbd0],ESI
00a0f440 : JC 0x00a0f44d
00a0f442 : MOV ECX,dword ptr [EBP + 0xfffffbbc]
00a0f448 : CALL 0x006f04e0
00a0f44d : MOV EDI,0x7
00a0f452 : XOR EDX,EDX
00a0f454 : MOV dword ptr [EBP + 0xfffffbd0],EDI
00a0f45a : MOV dword ptr [EBP + 0xfffffbcc],EBX
00a0f460 : MOV word ptr [EBP + 0xfffffbbc],DX
00a0f467 : MOV dword ptr [EBP + -0x4],0xffffffff
00a0f46e : CMP dword ptr [EBP + 0xfffffbec],ESI
00a0f474 : JC 0x00a0f481
00a0f476 : MOV ECX,dword ptr [EBP + 0xfffffbd8]
00a0f47c : CALL 0x006f04e0
00a0f481 : XOR EAX,EAX
00a0f483 : MOV word ptr [EBP + 0xfffffbd8],AX
00a0f48a : MOV EAX,0x1
00a0f48f : MOV dword ptr [EBP + 0xfffffbe8],EBX
00a0f495 : MOV dword ptr [EBP + 0xfffffbec],EDI
00a0f49b : MOV ECX,dword ptr [EBP + -0xc]
00a0f49e : MOV dword ptr FS:[0x0],ECX
00a0f4a5 : POP ECX
00a0f4a6 : POP EDI
00a0f4a7 : POP ESI
00a0f4a8 : POP EBX
00a0f4a9 : MOV ECX,dword ptr [EBP + -0x10]
00a0f4ac : XOR ECX,EBP
00a0f4ae : CALL 0x00633e6b
00a0f4b3 : MOV ESP,EBP
00a0f4b5 : POP EBP
00a0f4b6 : RET 0x8

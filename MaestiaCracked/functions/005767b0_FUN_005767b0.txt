PROGRAM  : Maestia.exe
FUNCTION : FUN_005767b0
ENTRY    : 005767b0
BODY     : [[005767b0, 00576adb]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005767b0(int param_1,undefined4 param_2,int param_3)

{
  char cVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  int *piVar4;
  int iVar5;
  int iVar6;
  int *piVar7;
  int in_ECX;
  int *local_20;
  int *local_1c;
  int local_18 [2];
  int **local_10;
  int **local_c;
  int local_8;
  undefined1 local_4;
  
  local_8 = *(int *)(in_ECX + 0x9e8);
  local_4 = 8;
  local_20 = *(int **)(local_8 + 8);
  local_20[2] = local_20[2] + 1;
  local_18[0] = *(int *)(local_8 + 8);
  *(int *)(local_18[0] + 8) = *(int *)(local_18[0] + 8) + 1;
  cVar1 = FUN_0052a650(&local_8,param_1,&local_20,local_18);
  if (cVar1 == '\0') {
    if (*(int *)(local_18[0] + 0x10) == 0) goto LAB_00576aa1;
    piVar4 = *(int **)(local_8 + 0x108);
    piVar4[2] = piVar4[2] + 1;
    local_20[2] = local_20[2] + -1;
    if (local_20[2] == 0) {
      FUN_00525340();
    }
  }
  else {
    if (4 < (uint)local_20[4]) {
      if ((*(int *)*local_20 == 0x6f6f725f) && ((char)((int *)*local_20)[1] == 't')) {
        uVar2 = FUN_00524bc0();
        uVar2 = FUN_005257b0(&local_10,5,uVar2);
        puVar3 = (undefined4 *)FUN_00525a40(&param_1,uVar2);
        piVar7 = (int *)*puVar3;
        piVar7[2] = piVar7[2] + 1;
        local_20[2] = local_20[2] + -1;
        if (local_20[2] == 0) {
          FUN_00525340();
        }
        piVar4 = (int *)(param_1 + 8);
        *piVar4 = *piVar4 + -1;
        local_20 = piVar7;
        if (*piVar4 == 0) {
          FUN_00525340();
        }
        local_10[2] = (int *)((int)local_10[2] + -1);
        if (local_10[2] == (int *)0x0) {
          FUN_00525340();
        }
      }
      piVar7 = (int *)*local_20;
      if (((*piVar7 == 0x76656c5f) && ((char)piVar7[1] == 'e')) &&
         (piVar4 = local_20, *(char *)((int)piVar7 + 5) == 'l')) goto LAB_0057694a;
    }
    puVar3 = (undefined4 *)FUN_00525a40(&param_1,&local_20);
    piVar4 = (int *)*puVar3;
    piVar4[2] = piVar4[2] + 1;
    local_20[2] = local_20[2] + -1;
    if (local_20[2] == 0) {
      FUN_00525340();
    }
    piVar7 = (int *)(param_1 + 8);
    *piVar7 = *piVar7 + -1;
    if (*piVar7 == 0) {
      local_20 = piVar4;
      FUN_00525340();
      piVar4 = local_20;
    }
  }
LAB_0057694a:
  local_20 = piVar4;
  iVar6 = *(int *)(in_ECX + 0xa28);
  local_1c = (int *)0x0;
  if (((iVar6 == 0) ||
      (iVar5 = FUN_0051db50(&local_20,*(uint *)(iVar6 + 4) & local_20[3]), iVar5 < 0)) ||
     ((iVar6 = iVar6 + (iVar5 * 3 + 3) * 4, iVar6 == 0 ||
      (piVar7 = *(int **)(iVar6 + 4), piVar4 = piVar7, piVar7 == (int *)0x0)))) {
    piVar7 = (int *)FUN_00515840(0x1c,0);
    if (piVar7 != (int *)0x0) {
      *piVar7 = local_18[0];
      *(int *)(local_18[0] + 8) = *(int *)(local_18[0] + 8) + 1;
      FUN_005266c0(param_2);
      local_10 = &local_20;
      *(bool *)(piVar7 + 6) = param_3 == 2;
      local_c = &local_1c;
      piVar7[5] = 0;
      local_1c = piVar7;
      FUN_00575a40(in_ECX + 0xa28,&local_10);
      goto LAB_00576aa1;
    }
  }
  else {
    do {
      if (*piVar4 == local_18[0]) {
        local_1c = piVar4;
        FUN_005268b0(param_2);
        if ((char)local_1c[6] == '\0') {
          *(bool *)(local_1c + 6) = param_3 == 2;
        }
        goto LAB_00576aa1;
      }
      local_1c = (int *)piVar4[5];
      piVar4 = local_1c;
    } while (local_1c != (int *)0x0);
    iVar6 = FUN_00515840(0x1c,0);
    if (iVar6 != 0) {
      local_1c = (int *)FUN_0056a2d0(local_18,param_2,param_3 == 2);
      if (local_1c != (int *)0x0) {
        local_1c[5] = piVar7[5];
        piVar7[5] = (int)local_1c;
      }
      goto LAB_00576aa1;
    }
  }
  local_1c = (int *)0x0;
LAB_00576aa1:
  *(int *)(local_18[0] + 8) = *(int *)(local_18[0] + 8) + -1;
  if (*(int *)(local_18[0] + 8) == 0) {
    FUN_00525340();
  }
  local_20[2] = local_20[2] + -1;
  if (local_20[2] == 0) {
    FUN_00525340();
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005767b0 : SUB ESP,0x20
005767b3 : PUSH EBP
005767b4 : PUSH ESI
005767b5 : PUSH EDI
005767b6 : MOV EDI,ECX
005767b8 : MOV EAX,dword ptr [EDI + 0x9e8]
005767be : MOV dword ptr [ESP + 0x24],EAX
005767c2 : MOV byte ptr [ESP + 0x28],0x8
005767c7 : MOV EAX,dword ptr [EAX + 0x8]
005767ca : MOV dword ptr [ESP + 0xc],EAX
005767ce : MOV EBP,0x1
005767d3 : ADD dword ptr [EAX + 0x8],EBP
005767d6 : MOV EAX,dword ptr [ESP + 0x24]
005767da : MOV EAX,dword ptr [EAX + 0x8]
005767dd : LEA ECX,[ESP + 0x14]
005767e1 : PUSH ECX
005767e2 : MOV dword ptr [ESP + 0x18],EAX
005767e6 : ADD dword ptr [EAX + 0x8],EBP
005767e9 : MOV EAX,dword ptr [ESP + 0x34]
005767ed : LEA EDX,[ESP + 0x10]
005767f1 : PUSH EDX
005767f2 : PUSH EAX
005767f3 : LEA ECX,[ESP + 0x30]
005767f7 : PUSH ECX
005767f8 : MOV dword ptr [ESP + 0x28],EDI
005767fc : CALL 0x0052a650
00576801 : ADD ESP,0x10
00576804 : TEST AL,AL
00576806 : JNZ 0x00576842
00576808 : MOV EAX,dword ptr [ESP + 0x14]
0057680c : CMP dword ptr [EAX + 0x10],0x0
00576810 : JZ 0x00576aa1
00576816 : MOV EDX,dword ptr [ESP + 0x24]
0057681a : MOV ESI,dword ptr [EDX + 0x108]
00576820 : ADD dword ptr [ESI + 0x8],EBP
00576823 : MOV EAX,dword ptr [ESP + 0xc]
00576827 : DEC dword ptr [EAX + 0x8]
0057682a : MOV ECX,EAX
0057682c : ADD EAX,0x8
0057682f : CMP dword ptr [EAX],0x0
00576832 : JNZ 0x00576839
00576834 : CALL 0x00525340
00576839 : MOV dword ptr [ESP + 0xc],ESI
0057683d : JMP 0x0057694a
00576842 : MOV EAX,dword ptr [ESP + 0xc]
00576846 : CMP dword ptr [EAX + 0x10],0x5
0057684a : JC 0x005768fd
00576850 : MOV EAX,dword ptr [EAX]
00576852 : CMP dword ptr [EAX],0x6f6f725f
00576858 : JNZ 0x005768e1
0057685e : ADD EAX,0x4
00576861 : CMP byte ptr [EAX],0x74
00576864 : JNZ 0x005768e1
00576866 : MOV ESI,dword ptr [ESP + 0x24]
0057686a : LEA ECX,[ESP + 0xc]
0057686e : ADD ESI,0x108
00576874 : CALL 0x00524bc0
00576879 : PUSH EAX
0057687a : PUSH 0x5
0057687c : LEA EAX,[ESP + 0x24]
00576880 : PUSH EAX
00576881 : LEA ECX,[ESP + 0x18]
00576885 : CALL 0x005257b0
0057688a : PUSH EAX
0057688b : LEA ECX,[ESP + 0x34]
0057688f : PUSH ECX
00576890 : MOV ECX,ESI
00576892 : CALL 0x00525a40
00576897 : MOV ESI,dword ptr [EAX]
00576899 : ADD dword ptr [ESI + 0x8],EBP
0057689c : MOV EAX,dword ptr [ESP + 0xc]
005768a0 : DEC dword ptr [EAX + 0x8]
005768a3 : MOV ECX,EAX
005768a5 : ADD EAX,0x8
005768a8 : CMP dword ptr [EAX],0x0
005768ab : JNZ 0x005768b2
005768ad : CALL 0x00525340
005768b2 : MOV EAX,dword ptr [ESP + 0x30]
005768b6 : MOV ECX,EAX
005768b8 : ADD EAX,0x8
005768bb : MOV dword ptr [ESP + 0xc],ESI
005768bf : DEC dword ptr [EAX]
005768c1 : CMP dword ptr [EAX],0x0
005768c4 : JNZ 0x005768cb
005768c6 : CALL 0x00525340
005768cb : MOV EAX,dword ptr [ESP + 0x1c]
005768cf : DEC dword ptr [EAX + 0x8]
005768d2 : MOV ECX,EAX
005768d4 : ADD EAX,0x8
005768d7 : CMP dword ptr [EAX],0x0
005768da : JNZ 0x005768e1
005768dc : CALL 0x00525340
005768e1 : MOV EDX,dword ptr [ESP + 0xc]
005768e5 : MOV EAX,dword ptr [EDX]
005768e7 : CMP dword ptr [EAX],0x76656c5f
005768ed : JNZ 0x005768fd
005768ef : ADD EAX,0x4
005768f2 : CMP byte ptr [EAX],0x65
005768f5 : JNZ 0x005768fd
005768f7 : CMP byte ptr [EAX + 0x1],0x6c
005768fb : JZ 0x0057694a
005768fd : MOV ECX,dword ptr [ESP + 0x24]
00576901 : LEA EAX,[ESP + 0xc]
00576905 : PUSH EAX
00576906 : LEA EDX,[ESP + 0x34]
0057690a : ADD ECX,0x10c
00576910 : PUSH EDX
00576911 : CALL 0x00525a40
00576916 : MOV ESI,dword ptr [EAX]
00576918 : ADD dword ptr [ESI + 0x8],EBP
0057691b : MOV EAX,dword ptr [ESP + 0xc]
0057691f : DEC dword ptr [EAX + 0x8]
00576922 : MOV ECX,EAX
00576924 : ADD EAX,0x8
00576927 : CMP dword ptr [EAX],0x0
0057692a : JNZ 0x00576931
0057692c : CALL 0x00525340
00576931 : MOV EAX,dword ptr [ESP + 0x30]
00576935 : MOV ECX,EAX
00576937 : ADD EAX,0x8
0057693a : MOV dword ptr [ESP + 0xc],ESI
0057693e : DEC dword ptr [EAX]
00576940 : CMP dword ptr [EAX],0x0
00576943 : JNZ 0x0057694a
00576945 : CALL 0x00525340
0057694a : MOV ESI,dword ptr [EDI + 0xa28]
00576950 : ADD EDI,0xa28
00576956 : MOV dword ptr [ESP + 0x10],0x0
0057695e : TEST ESI,ESI
00576960 : JZ 0x00576a36
00576966 : MOV ECX,dword ptr [ESP + 0xc]
0057696a : MOV EAX,dword ptr [ESI + 0x4]
0057696d : AND EAX,dword ptr [ECX + 0xc]
00576970 : LEA EDX,[ESP + 0xc]
00576974 : PUSH EAX
00576975 : PUSH EDX
00576976 : MOV ECX,EDI
00576978 : CALL 0x0051db50
0057697d : TEST EAX,EAX
0057697f : JL 0x00576a36
00576985 : LEA EAX,[EAX + EAX*0x2 + 0x3]
00576989 : LEA EAX,[ESI + EAX*0x4]
0057698c : TEST EAX,EAX
0057698e : JZ 0x00576a36
00576994 : MOV ESI,dword ptr [EAX + 0x4]
00576997 : TEST ESI,ESI
00576999 : JZ 0x00576a36
0057699f : MOV ECX,dword ptr [ESP + 0x14]
005769a3 : MOV EAX,ESI
005769a5 : MOV dword ptr [ESP + 0x10],EAX
005769a9 : LEA ESP,[ESP]
005769b0 : CMP dword ptr [EAX],ECX
005769b2 : JZ 0x00576a12
005769b4 : MOV EAX,dword ptr [EAX + 0x14]
005769b7 : MOV dword ptr [ESP + 0x10],EAX
005769bb : TEST EAX,EAX
005769bd : JNZ 0x005769b0
005769bf : MOV EAX,dword ptr [ESP + 0x18]
005769c3 : MOV ECX,dword ptr [EAX + 0x14]
005769c6 : PUSH 0x0
005769c8 : PUSH 0x1c
005769ca : CALL 0x00515840
005769cf : TEST EAX,EAX
005769d1 : JZ 0x00576ad2
005769d7 : CMP dword ptr [ESP + 0x38],0x2
005769dc : SETZ CL
005769df : MOVZX EDX,CL
005769e2 : MOV ECX,dword ptr [ESP + 0x34]
005769e6 : PUSH EDX
005769e7 : PUSH ECX
005769e8 : LEA EDX,[ESP + 0x1c]
005769ec : PUSH EDX
005769ed : MOV ECX,EAX
005769ef : CALL 0x0056a2d0
005769f4 : MOV dword ptr [ESP + 0x10],EAX
005769f8 : TEST EAX,EAX
005769fa : JZ 0x00576a9d
00576a00 : MOV ECX,dword ptr [ESI + 0x14]
00576a03 : MOV dword ptr [EAX + 0x14],ECX
00576a06 : MOV EDX,dword ptr [ESP + 0x10]
00576a0a : MOV dword ptr [ESI + 0x14],EDX
00576a0d : JMP 0x00576a9d
00576a12 : MOV ECX,dword ptr [ESP + 0x34]
00576a16 : PUSH ECX
00576a17 : LEA ECX,[EAX + 0x4]
00576a1a : CALL 0x005268b0
00576a1f : MOV EAX,dword ptr [ESP + 0x10]
00576a23 : CMP byte ptr [EAX + 0x18],0x0
00576a27 : JNZ 0x00576a9d
00576a29 : CMP dword ptr [ESP + 0x38],0x2
00576a2e : SETZ DL
00576a31 : MOV byte ptr [EAX + 0x18],DL
00576a34 : JMP 0x00576a9d
00576a36 : MOV EAX,dword ptr [ESP + 0x18]
00576a3a : MOV ECX,dword ptr [EAX + 0x14]
00576a3d : PUSH 0x0
00576a3f : PUSH 0x1c
00576a41 : CALL 0x00515840
00576a46 : MOV ESI,EAX
00576a48 : TEST ESI,ESI
00576a4a : JZ 0x00576ad2
00576a50 : MOV ECX,dword ptr [ESP + 0x14]
00576a54 : MOV EDX,dword ptr [ESP + 0x34]
00576a58 : MOV dword ptr [ESI],ECX
00576a5a : MOV EAX,dword ptr [ESP + 0x14]
00576a5e : ADD dword ptr [EAX + 0x8],EBP
00576a61 : PUSH EDX
00576a62 : LEA ECX,[ESI + 0x4]
00576a65 : CALL 0x005266c0
00576a6a : CMP dword ptr [ESP + 0x38],0x2
00576a6f : LEA ECX,[ESP + 0xc]
00576a73 : SETZ AL
00576a76 : MOV byte ptr [ESI + 0x18],AL
00576a79 : LEA EAX,[ESP + 0x1c]
00576a7d : PUSH EAX
00576a7e : MOV dword ptr [ESP + 0x20],ECX
00576a82 : LEA EDX,[ESP + 0x14]
00576a86 : MOV dword ptr [ESI + 0x14],0x0
00576a8d : PUSH EDI
00576a8e : MOV ECX,EDI
00576a90 : MOV dword ptr [ESP + 0x18],ESI
00576a94 : MOV dword ptr [ESP + 0x28],EDX
00576a98 : CALL 0x00575a40
00576a9d : MOV EAX,dword ptr [ESP + 0x14]
00576aa1 : DEC dword ptr [EAX + 0x8]
00576aa4 : MOV ECX,EAX
00576aa6 : ADD EAX,0x8
00576aa9 : CMP dword ptr [EAX],0x0
00576aac : JNZ 0x00576ab3
00576aae : CALL 0x00525340
00576ab3 : MOV EAX,dword ptr [ESP + 0xc]
00576ab7 : DEC dword ptr [EAX + 0x8]
00576aba : MOV ECX,EAX
00576abc : ADD EAX,0x8
00576abf : CMP dword ptr [EAX],0x0
00576ac2 : JNZ 0x00576ac9
00576ac4 : CALL 0x00525340
00576ac9 : POP EDI
00576aca : POP ESI
00576acb : POP EBP
00576acc : ADD ESP,0x20
00576acf : RET 0xc
00576ad2 : MOV dword ptr [ESP + 0x10],0x0
00576ada : JMP 0x00576a9d

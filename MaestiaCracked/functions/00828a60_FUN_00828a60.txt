PROGRAM  : Maestia.exe
FUNCTION : FUN_00828a60
ENTRY    : 00828a60
BODY     : [[00828a60, 00828b8d]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00828a60(void)

{
  int in_ECX;
  undefined4 *in_EDX;
  undefined1 auStack_a8 [4];
  undefined2 local_a4;
  undefined1 local_a2;
  undefined1 local_a1;
  undefined4 local_a0;
  undefined4 local_9c;
  undefined4 local_98;
  undefined4 local_94;
  undefined1 local_90 [4];
  undefined4 local_8c;
  undefined4 local_84;
  undefined4 local_80;
  undefined4 local_28;
  uint local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  puStack_10 = &LAB_00b6a9e2;
  local_14 = ExceptionList;
  local_1c = DAT_00d66fa0 ^ (uint)auStack_a8;
  ExceptionList = &local_14;
  if (DAT_00da93ec != 0) {
    *(undefined2 *)(in_EDX + 1) = 0;
    FUN_00828750(0,0);
    *in_EDX = 0xffffffff;
    local_84 = 0;
    local_a4 = 0x2000;
    local_a0 = 0;
    local_9c = 0;
    local_a2 = 0x41;
    local_a1 = 2;
    if (*(int *)(in_ECX + 0x17c) != 0) {
      local_84 = *(undefined4 *)(*(int *)(in_ECX + 0x17c) + 4);
    }
    local_94 = 0xffff0000;
    local_98 = local_84;
    FUN_00a204c0(&local_a4);
    FUN_0040e250(local_90);
    local_c = 0;
    local_8c = 0x143ddb40;
    local_28 = 0xf;
    local_80 = local_84;
    FUN_00883670(DAT_017248e4);
    local_c = 0xffffffff;
    FUN_00406bd0(local_90);
  }
  ExceptionList = local_14;
  __security_check_cookie(local_1c ^ (uint)auStack_a8);
  return;
}



============================================================
DISASSEMBLY
============================================================
00828a60 : PUSH EBP
00828a61 : MOV EBP,ESP
00828a63 : AND ESP,0xfffffff8
00828a66 : PUSH -0x1
00828a68 : PUSH 0xb6a9e2
00828a6d : MOV EAX,FS:[0x0]
00828a73 : PUSH EAX
00828a74 : SUB ESP,0x94
00828a7a : MOV EAX,[0x00d66fa0]
00828a7f : XOR EAX,ESP
00828a81 : MOV dword ptr [ESP + 0x8c],EAX
00828a88 : PUSH ESI
00828a89 : PUSH EDI
00828a8a : MOV EAX,[0x00d66fa0]
00828a8f : XOR EAX,ESP
00828a91 : PUSH EAX
00828a92 : LEA EAX,[ESP + 0xa0]
00828a99 : MOV FS:[0x0],EAX
00828a9f : CMP dword ptr [0x00da93ec],0x0
00828aa6 : MOV EDI,ECX
00828aa8 : MOV ESI,EDX
00828aaa : JZ 0x00828b6b
00828ab0 : XOR EAX,EAX
00828ab2 : PUSH EAX
00828ab3 : PUSH EAX
00828ab4 : MOV ECX,ESI
00828ab6 : MOV EDX,EDI
00828ab8 : MOV word ptr [ESI + 0x4],AX
00828abc : CALL 0x00828750
00828ac1 : MOV dword ptr [ESI],0xffffffff
00828ac7 : MOV EDI,dword ptr [EDI + 0x17c]
00828acd : MOV ECX,0x2000
00828ad2 : XOR ESI,ESI
00828ad4 : MOV word ptr [ESP + 0x10],CX
00828ad9 : MOV dword ptr [ESP + 0x14],0x0
00828ae1 : MOV dword ptr [ESP + 0x18],0x0
00828ae9 : MOV byte ptr [ESP + 0x12],0x41
00828aee : MOV byte ptr [ESP + 0x13],0x2
00828af3 : TEST EDI,EDI
00828af5 : JZ 0x00828afa
00828af7 : MOV ESI,dword ptr [EDI + 0x4]
00828afa : MOV EDI,dword ptr [0x00da93ec]
00828b00 : LEA EDX,[ESP + 0x10]
00828b04 : PUSH EDX
00828b05 : MOV dword ptr [ESP + 0x20],ESI
00828b09 : MOV dword ptr [ESP + 0x24],0xffff0000
00828b11 : CALL 0x00a204c0
00828b16 : LEA EAX,[ESP + 0x24]
00828b1a : PUSH EAX
00828b1b : CALL 0x0040e250
00828b20 : MOV dword ptr [ESP + 0xa8],0x0
00828b2b : MOV ECX,dword ptr [0x017248e4]
00828b31 : PUSH ECX
00828b32 : LEA ECX,[ESP + 0x28]
00828b36 : MOV dword ptr [ESP + 0x34],ESI
00828b3a : MOV dword ptr [ESP + 0x38],ESI
00828b3e : MOV dword ptr [ESP + 0x2c],0x143ddb40
00828b46 : MOV dword ptr [ESP + 0x90],0xf
00828b51 : CALL 0x00883670
00828b56 : MOV dword ptr [ESP + 0xa8],0xffffffff
00828b61 : LEA EDX,[ESP + 0x24]
00828b65 : PUSH EDX
00828b66 : CALL 0x00406bd0
00828b6b : MOV ECX,dword ptr [ESP + 0xa0]
00828b72 : MOV dword ptr FS:[0x0],ECX
00828b79 : POP ECX
00828b7a : POP EDI
00828b7b : POP ESI
00828b7c : MOV ECX,dword ptr [ESP + 0x8c]
00828b83 : XOR ECX,ESP
00828b85 : CALL 0x00633e6b
00828b8a : MOV ESP,EBP
00828b8c : POP EBP
00828b8d : RET

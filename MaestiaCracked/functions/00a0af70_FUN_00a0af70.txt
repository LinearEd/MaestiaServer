PROGRAM  : Maestia.exe
FUNCTION : FUN_00a0af70
ENTRY    : 00a0af70
BODY     : [[00a0af70, 00a0b0dd]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a0af70(FILE *param_1)

{
  DWORD DVar1;
  BOOL BVar2;
  undefined4 uVar3;
  DWORD local_77c;
  _FILETIME local_778;
  _SYSTEM_INFO local_76c;
  undefined1 local_748 [104];
  undefined1 local_6e0 [104];
  undefined1 local_678 [200];
  WCHAR local_5b0 [200];
  WCHAR local_420 [522];
  uint local_c;
  
  local_c = DAT_00d66fa0 ^ (uint)&local_77c;
  GetSystemTimeAsFileTime(&local_778);
  FUN_00a0ae40(local_778.dwLowDateTime,local_778.dwHighDateTime);
  _fwprintf(param_1,L"Error occurred at %s.\r\n",local_678);
  _memset(local_420,0,0x410);
  DVar1 = GetModuleFileNameW((HMODULE)0x0,local_420,0x206);
  if (DVar1 == 0) {
    lstrcpyW(local_420,L"Unknown");
  }
  _memset(local_5b0,0,400);
  local_77c = 0xc6;
  BVar2 = GetUserNameW(local_5b0,&local_77c);
  if (BVar2 == 0) {
    lstrcpyW(local_5b0,L"Unknown");
  }
  _fwprintf(param_1,L"%s, run by %s.\r\n",local_420,local_5b0);
  FUN_00a0a250(local_748);
  _fwprintf(param_1,L"OS:  %s (%s).\r\n",local_6e0,local_748);
  GetSystemInfo(&local_76c);
  _fwprintf(param_1,L"Process: %d processor(s), type %d.\r\n",local_76c.dwNumberOfProcessors,
            local_76c.dwProcessorType);
  uVar3 = FUN_00a0aec0();
  _fwprintf(param_1,L"RemainMem: %d MB. \r\n",uVar3);
  __security_check_cookie(local_c ^ (uint)&local_77c);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a0af70 : PUSH EBP
00a0af71 : MOV EBP,ESP
00a0af73 : AND ESP,0xfffffff8
00a0af76 : SUB ESP,0x774
00a0af7c : MOV EAX,[0x00d66fa0]
00a0af81 : XOR EAX,ESP
00a0af83 : MOV dword ptr [ESP + 0x770],EAX
00a0af8a : PUSH EBX
00a0af8b : MOV EBX,dword ptr [EBP + 0x8]
00a0af8e : PUSH ESI
00a0af8f : PUSH EDI
00a0af90 : LEA EAX,[ESP + 0x10]
00a0af94 : PUSH EAX
00a0af95 : CALL dword ptr [0x00b85180]
00a0af9b : MOV ECX,dword ptr [ESP + 0x14]
00a0af9f : MOV EDX,dword ptr [ESP + 0x10]
00a0afa3 : PUSH ECX
00a0afa4 : PUSH EDX
00a0afa5 : LEA ESI,[ESP + 0x118]
00a0afac : CALL 0x00a0ae40
00a0afb1 : MOV EAX,ESI
00a0afb3 : PUSH EAX
00a0afb4 : PUSH 0xcabc80
00a0afb9 : PUSH EBX
00a0afba : CALL 0x006372ee
00a0afbf : ADD ESP,0x14
00a0afc2 : PUSH 0x410
00a0afc7 : LEA ECX,[ESP + 0x36c]
00a0afce : PUSH 0x0
00a0afd0 : PUSH ECX
00a0afd1 : CALL 0x0063b700
00a0afd6 : ADD ESP,0xc
00a0afd9 : PUSH 0x206
00a0afde : LEA EDX,[ESP + 0x36c]
00a0afe5 : PUSH EDX
00a0afe6 : PUSH 0x0
00a0afe8 : CALL dword ptr [0x00b85144]
00a0afee : MOV ESI,dword ptr [0x00b85174]
00a0aff4 : TEST EAX,EAX
00a0aff6 : JA 0x00a0b007
00a0aff8 : PUSH 0xcabcb0
00a0affd : LEA EAX,[ESP + 0x36c]
00a0b004 : PUSH EAX
00a0b005 : CALL ESI
00a0b007 : PUSH 0x190
00a0b00c : LEA ECX,[ESP + 0x1dc]
00a0b013 : PUSH 0x0
00a0b015 : PUSH ECX
00a0b016 : CALL 0x0063b700
00a0b01b : ADD ESP,0xc
00a0b01e : LEA EDX,[ESP + 0xc]
00a0b022 : PUSH EDX
00a0b023 : LEA EAX,[ESP + 0x1dc]
00a0b02a : PUSH EAX
00a0b02b : MOV dword ptr [ESP + 0x14],0xc6
00a0b033 : CALL dword ptr [0x00b8502c]
00a0b039 : TEST EAX,EAX
00a0b03b : JNZ 0x00a0b04c
00a0b03d : PUSH 0xcabcc0
00a0b042 : LEA ECX,[ESP + 0x1dc]
00a0b049 : PUSH ECX
00a0b04a : CALL ESI
00a0b04c : LEA EDX,[ESP + 0x1d8]
00a0b053 : PUSH EDX
00a0b054 : LEA EAX,[ESP + 0x36c]
00a0b05b : PUSH EAX
00a0b05c : PUSH 0xcabcd0
00a0b061 : PUSH EBX
00a0b062 : CALL 0x006372ee
00a0b067 : LEA ECX,[ESP + 0x50]
00a0b06b : PUSH ECX
00a0b06c : LEA EDI,[ESP + 0x2c]
00a0b070 : LEA ESI,[ESP + 0xbc]
00a0b077 : CALL 0x00a0a250
00a0b07c : ADD ESP,0x14
00a0b07f : LEA EDX,[ESP + 0x40]
00a0b083 : PUSH EDX
00a0b084 : MOV EAX,ESI
00a0b086 : PUSH EAX
00a0b087 : PUSH 0xcabcf4
00a0b08c : PUSH EBX
00a0b08d : CALL 0x006372ee
00a0b092 : ADD ESP,0x10
00a0b095 : LEA ECX,[ESP + 0x1c]
00a0b099 : PUSH ECX
00a0b09a : CALL dword ptr [0x00b85184]
00a0b0a0 : MOV EDX,dword ptr [ESP + 0x34]
00a0b0a4 : MOV EAX,dword ptr [ESP + 0x30]
00a0b0a8 : PUSH EDX
00a0b0a9 : PUSH EAX
00a0b0aa : PUSH 0xcabd40
00a0b0af : PUSH EBX
00a0b0b0 : CALL 0x006372ee
00a0b0b5 : CALL 0x00a0aec0
00a0b0ba : PUSH EAX
00a0b0bb : PUSH 0xcabd14
00a0b0c0 : PUSH EBX
00a0b0c1 : CALL 0x006372ee
00a0b0c6 : MOV ECX,dword ptr [ESP + 0x798]
00a0b0cd : ADD ESP,0x1c
00a0b0d0 : POP EDI
00a0b0d1 : POP ESI
00a0b0d2 : POP EBX
00a0b0d3 : XOR ECX,ESP
00a0b0d5 : CALL 0x00633e6b
00a0b0da : MOV ESP,EBP
00a0b0dc : POP EBP
00a0b0dd : RET

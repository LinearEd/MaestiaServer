PROGRAM  : Maestia.exe
FUNCTION : FUN_00404fa3
ENTRY    : 00404fa3
BODY     : [[00404fa3, 00404fd7] [00404fdb, 00405007]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00404fa3(void)

{
  void *_Src;
  undefined4 *puVar1;
  int iVar2;
  undefined4 *unaff_EBX;
  int unaff_EBP;
  uint unaff_ESI;
  int unaff_EDI;
  
  iVar2 = 0;
  if (*(rsize_t *)(unaff_EBP + 0xc) != 0) {
    if (*(uint *)(unaff_EDI + 0x18) < 0x10) {
      _Src = (void *)(unaff_EDI + 4);
    }
    else {
      _Src = *(void **)(unaff_EDI + 4);
    }
    _memcpy_s(unaff_EBX,unaff_ESI + 1,_Src,*(rsize_t *)(unaff_EBP + 0xc));
    iVar2 = *(int *)(unaff_EBP + 0xc);
  }
  if (0xf < *(uint *)(unaff_EDI + 0x18)) {
                    /* WARNING: Subroutine does not return */
    FUN_006f04e0();
  }
  puVar1 = (undefined4 *)(unaff_EDI + 4);
  *(undefined1 *)puVar1 = 0;
  *puVar1 = unaff_EBX;
  *(uint *)(unaff_EDI + 0x18) = unaff_ESI;
  *(int *)(unaff_EDI + 0x14) = iVar2;
  if (0xf < unaff_ESI) {
    puVar1 = unaff_EBX;
  }
  *(undefined1 *)((int)puVar1 + iVar2) = 0;
  ExceptionList = *(void **)(unaff_EBP + -0xc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00404fa3 : MOV ECX,dword ptr [EBP + 0xc]
00404fa6 : TEST ECX,ECX
00404fa8 : JBE 0x00404fca
00404faa : CMP dword ptr [EDI + 0x18],0x10
00404fae : JC 0x00404fb5
00404fb0 : MOV EAX,dword ptr [EDI + 0x4]
00404fb3 : JMP 0x00404fb8
00404fb5 : LEA EAX,[EDI + 0x4]
00404fb8 : PUSH ECX
00404fb9 : PUSH EAX
00404fba : LEA EDX,[ESI + 0x1]
00404fbd : PUSH EDX
00404fbe : PUSH EBX
00404fbf : CALL 0x00633ea4
00404fc4 : ADD ESP,0x10
00404fc7 : MOV ECX,dword ptr [EBP + 0xc]
00404fca : CMP dword ptr [EDI + 0x18],0x10
00404fce : JC 0x00404fdb
00404fd0 : MOV ECX,dword ptr [EDI + 0x4]
00404fd3 : CALL 0x006f04e0
00404fdb : LEA EAX,[EDI + 0x4]
00404fde : MOV byte ptr [EAX],0x0
00404fe1 : MOV dword ptr [EAX],EBX
00404fe3 : MOV dword ptr [EDI + 0x18],ESI
00404fe6 : MOV dword ptr [EDI + 0x14],ECX
00404fe9 : CMP ESI,0x10
00404fec : JC 0x00404ff0
00404fee : MOV EAX,EBX
00404ff0 : MOV byte ptr [EAX + ECX*0x1],0x0
00404ff4 : MOV ECX,dword ptr [EBP + -0xc]
00404ff7 : MOV dword ptr FS:[0x0],ECX
00404ffe : POP ECX
00404fff : POP EDI
00405000 : POP ESI
00405001 : POP EBX
00405002 : MOV ESP,EBP
00405004 : POP EBP
00405005 : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_00a3f240
ENTRY    : 00a3f240
BODY     : [[00a3f240, 00a3f521]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_00a3f240(int param_1,int param_2,undefined4 param_3)

{
  uint uVar1;
  int iVar2;
  int in_ECX;
  uint local_18;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b68186;
  local_10 = ExceptionList;
  uVar1 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  iVar2 = FUN_00a1a840();
  if (((iVar2 != 0) || (iVar2 = FUN_00a1a6d0(), iVar2 != 0)) || (iVar2 = FUN_00a1a780(), iVar2 != 0)
     ) {
    if ((*(int *)(*(int *)(in_ECX + 0xac) + 4) == param_1) || (param_2 == 0)) {
      FUN_004044f0();
      FUN_00857f90();
      FUN_00405eb0(param_3,0,0xffffffff);
      local_8 = 0xffffffff;
      FUN_009c04b0();
      iVar2 = *DAT_00da9894;
      if ((iVar2 != 0) && (*(int *)(iVar2 + 0x114) != 0)) {
        (**(code **)(**(int **)(iVar2 + 0x114) + 4))();
      }
      FUN_0095c4a0();
      FUN_00843b30();
      FUN_00406460();
      local_8 = 1;
      FUN_00acff80();
      local_8 = 0xffffffff;
      if (7 < local_18) {
                    /* WARNING: Subroutine does not return */
        FUN_006f04e0();
      }
    }
    else {
      FUN_004044f0();
      FUN_00857f90();
      if (*(int *)(in_ECX + 0x24c) == param_1) {
        FUN_00900a90();
      }
    }
    if (*(int *)(*(int *)(in_ECX + 0xac) + 0x1f54) != 0) {
      FUN_00ab77e0();
      FUN_00ab6f80();
    }
    if (*(int *)(in_ECX + 0x24c) == *(int *)(*(int *)(in_ECX + 0xac) + 4)) {
      FUN_00900a90();
    }
  }
  if (**(int **)(*DAT_00da9894 + 0x188) != 0) {
    FUN_00a73500();
  }
  if (*(char *)(*(int *)(*DAT_00da9894 + 0x1c8) + 0x32) != '\0') {
    FUN_008a7210();
  }
  if (*(char *)(*(int *)(*DAT_00da9894 + 0x24c) + 0x32) != '\0') {
    FUN_009bdf70();
  }
  if (*(char *)(*(int *)(*DAT_00da9894 + 0x1fc) + 0x32) == '\0') {
    *(undefined1 *)(*(int *)(*DAT_00da9894 + 0x1fc) + 0x49dc8) = 1;
  }
  else {
    FUN_00929210();
  }
  FUN_0099b060();
  ExceptionList = local_10;
  __security_check_cookie(uVar1 ^ (uint)&stack0xfffffffc);
  return;
}



============================================================
DISASSEMBLY
============================================================
00a3f240 : PUSH EBP
00a3f241 : MOV EBP,ESP
00a3f243 : PUSH -0x1
00a3f245 : PUSH 0xb68186
00a3f24a : MOV EAX,FS:[0x0]
00a3f250 : PUSH EAX
00a3f251 : SUB ESP,0x28
00a3f254 : MOV EAX,[0x00d66fa0]
00a3f259 : XOR EAX,EBP
00a3f25b : MOV dword ptr [EBP + -0x10],EAX
00a3f25e : PUSH EBX
00a3f25f : PUSH ESI
00a3f260 : PUSH EDI
00a3f261 : PUSH EAX
00a3f262 : LEA EAX,[EBP + -0xc]
00a3f265 : MOV FS:[0x0],EAX
00a3f26b : MOV EAX,dword ptr [EBP + 0x8]
00a3f26e : MOV EBX,dword ptr [EBP + 0x10]
00a3f271 : PUSH EAX
00a3f272 : MOV ESI,ECX
00a3f274 : CALL 0x00a1a840
00a3f279 : MOV EDI,EAX
00a3f27b : TEST EDI,EDI
00a3f27d : JNZ 0x00a3f2a5
00a3f27f : MOV ECX,dword ptr [EBP + 0x8]
00a3f282 : PUSH ECX
00a3f283 : MOV ECX,ESI
00a3f285 : CALL 0x00a1a6d0
00a3f28a : MOV EDI,EAX
00a3f28c : TEST EDI,EDI
00a3f28e : JNZ 0x00a3f2a5
00a3f290 : MOV EDX,dword ptr [EBP + 0x8]
00a3f293 : PUSH EDX
00a3f294 : MOV ECX,ESI
00a3f296 : CALL 0x00a1a780
00a3f29b : MOV EDI,EAX
00a3f29d : TEST EDI,EDI
00a3f29f : JZ 0x00a3f46c
00a3f2a5 : MOV EAX,dword ptr [ESI + 0xac]
00a3f2ab : MOV ECX,dword ptr [EBP + 0x8]
00a3f2ae : CMP dword ptr [EAX + 0x4],ECX
00a3f2b1 : JZ 0x00a3f2ef
00a3f2b3 : CMP dword ptr [EBP + 0xc],0x0
00a3f2b7 : JZ 0x00a3f2ef
00a3f2b9 : MOV ECX,EBX
00a3f2bb : CALL 0x004044f0
00a3f2c0 : PUSH EDI
00a3f2c1 : CALL 0x00857f90
00a3f2c6 : MOV EDI,dword ptr [EBP + 0x8]
00a3f2c9 : CMP dword ptr [ESI + 0x24c],EDI
00a3f2cf : JNZ 0x00a3f415
00a3f2d5 : MOV EDX,dword ptr [0x00da9894]
00a3f2db : MOV EAX,dword ptr [EDX]
00a3f2dd : MOV ECX,dword ptr [EAX + 0x16c]
00a3f2e3 : PUSH EBX
00a3f2e4 : PUSH ECX
00a3f2e5 : CALL 0x00900a90
00a3f2ea : JMP 0x00a3f415
00a3f2ef : MOV ECX,EBX
00a3f2f1 : MOV EDI,EAX
00a3f2f3 : CALL 0x004044f0
00a3f2f8 : MOV EDX,dword ptr [ESI + 0xac]
00a3f2fe : PUSH EDX
00a3f2ff : CALL 0x00857f90
00a3f304 : SUB ESP,0x1c
00a3f307 : MOV ECX,ESP
00a3f309 : MOV dword ptr [EBP + -0x30],ESP
00a3f30c : PUSH -0x1
00a3f30e : XOR EDI,EDI
00a3f310 : PUSH EDI
00a3f311 : XOR EAX,EAX
00a3f313 : MOV dword ptr [ECX + 0x18],0x7
00a3f31a : MOV dword ptr [ECX + 0x14],EDI
00a3f31d : PUSH EBX
00a3f31e : MOV word ptr [ECX + 0x4],AX
00a3f322 : CALL 0x00405eb0
00a3f327 : MOV dword ptr [EBP + -0x4],EDI
00a3f32a : MOV ECX,dword ptr [0x00da9894]
00a3f330 : MOV EAX,dword ptr [ECX]
00a3f332 : MOV EAX,dword ptr [EAX + 0x140]
00a3f338 : MOV EAX,dword ptr [EAX + 0x38]
00a3f33b : LEA EDX,[EAX + 0x38]
00a3f33e : MOV dword ptr [EBP + -0x4],0xffffffff
00a3f345 : CALL 0x009c04b0
00a3f34a : MOV EDX,dword ptr [0x00da9894]
00a3f350 : MOV EAX,dword ptr [EDX]
00a3f352 : CMP EAX,EDI
00a3f354 : JZ 0x00a3f38c
00a3f356 : CMP dword ptr [EAX + 0x114],EDI
00a3f35c : JZ 0x00a3f38c
00a3f35e : CMP dword ptr [EBX + 0x18],0x8
00a3f362 : MOV EAX,dword ptr [EAX + 0x114]
00a3f368 : JC 0x00a3f36f
00a3f36a : MOV ECX,dword ptr [EBX + 0x4]
00a3f36d : JMP 0x00a3f372
00a3f36f : LEA ECX,[EBX + 0x4]
00a3f372 : MOV EDX,dword ptr [EAX]
00a3f374 : MOV EDX,dword ptr [EDX + 0x4]
00a3f377 : PUSH ECX
00a3f378 : MOV ECX,dword ptr [EBP + 0x8]
00a3f37b : PUSH ECX
00a3f37c : PUSH 0xcc4c7c
00a3f381 : PUSH 0xcc4c84
00a3f386 : PUSH EAX
00a3f387 : CALL EDX
00a3f389 : ADD ESP,0x14
00a3f38c : MOV EAX,[0x00da9894]
00a3f391 : MOV EAX,dword ptr [EAX]
00a3f393 : MOV EAX,dword ptr [EAX + 0x12c]
00a3f399 : CMP EAX,EDI
00a3f39b : JNZ 0x00a3f3a1
00a3f39d : XOR ECX,ECX
00a3f39f : JMP 0x00a3f3a4
00a3f3a1 : MOV ECX,dword ptr [EAX + 0x8]
00a3f3a4 : PUSH EBX
00a3f3a5 : CALL 0x0095c4a0
00a3f3aa : MOV ECX,dword ptr [ESI + 0xac]
00a3f3b0 : MOV EDX,dword ptr [0x0172490c]
00a3f3b6 : PUSH ECX
00a3f3b7 : PUSH EDX
00a3f3b8 : CALL 0x00843b30
00a3f3bd : PUSH 0xcc4c90
00a3f3c2 : LEA ECX,[EBP + -0x2c]
00a3f3c5 : CALL 0x00406460
00a3f3ca : MOV dword ptr [EBP + -0x4],0x1
00a3f3d1 : MOV EAX,[0x00da9894]
00a3f3d6 : MOV EAX,dword ptr [EAX]
00a3f3d8 : MOV EAX,dword ptr [EAX + 0x148]
00a3f3de : LEA ECX,[EBP + -0x2c]
00a3f3e1 : PUSH ECX
00a3f3e2 : MOV EDI,EAX
00a3f3e4 : CALL 0x00acff80
00a3f3e9 : MOV dword ptr [EBP + -0x4],0xffffffff
00a3f3f0 : CMP dword ptr [EBP + -0x14],0x8
00a3f3f4 : JC 0x00a3f3fe
00a3f3f6 : MOV ECX,dword ptr [EBP + -0x28]
00a3f3f9 : CALL 0x006f04e0
00a3f3fe : MOV EDI,dword ptr [EBP + 0x8]
00a3f401 : XOR EDX,EDX
00a3f403 : MOV dword ptr [EBP + -0x14],0x7
00a3f40a : MOV dword ptr [EBP + -0x18],0x0
00a3f411 : MOV word ptr [EBP + -0x28],DX
00a3f415 : MOV EAX,dword ptr [ESI + 0xac]
00a3f41b : CMP dword ptr [EAX + 0x1f54],0x0
00a3f422 : JZ 0x00a3f446
00a3f424 : MOV ECX,dword ptr [EAX + 0x1f54]
00a3f42a : PUSH EBX
00a3f42b : MOV EDX,EDI
00a3f42d : CALL 0x00ab77e0
00a3f432 : MOV ECX,dword ptr [ESI + 0xac]
00a3f438 : MOV ECX,dword ptr [ECX + 0x1f54]
00a3f43e : PUSH EDI
00a3f43f : MOV EAX,EBX
00a3f441 : CALL 0x00ab6f80
00a3f446 : MOV EDX,dword ptr [ESI + 0xac]
00a3f44c : MOV EAX,dword ptr [ESI + 0x24c]
00a3f452 : CMP EAX,dword ptr [EDX + 0x4]
00a3f455 : JNZ 0x00a3f46c
00a3f457 : MOV ECX,dword ptr [0x00da9894]
00a3f45d : MOV EDX,dword ptr [ECX]
00a3f45f : MOV EAX,dword ptr [EDX + 0x16c]
00a3f465 : PUSH EBX
00a3f466 : PUSH EAX
00a3f467 : CALL 0x00900a90
00a3f46c : MOV ECX,dword ptr [0x00da9894]
00a3f472 : MOV EDX,dword ptr [ECX]
00a3f474 : MOV EAX,dword ptr [EDX + 0x188]
00a3f47a : CMP dword ptr [EAX],0x0
00a3f47d : JZ 0x00a3f48a
00a3f47f : MOV ECX,dword ptr [EBP + 0xc]
00a3f482 : PUSH EBX
00a3f483 : PUSH ECX
00a3f484 : PUSH EAX
00a3f485 : CALL 0x00a73500
00a3f48a : MOV EDX,dword ptr [0x00da9894]
00a3f490 : MOV EAX,dword ptr [EDX]
00a3f492 : MOV ECX,dword ptr [EAX + 0x1c8]
00a3f498 : CMP byte ptr [ECX + 0x32],0x0
00a3f49c : JZ 0x00a3f4a7
00a3f49e : MOV SI,word ptr [ECX + 0x3c]
00a3f4a2 : CALL 0x008a7210
00a3f4a7 : MOV ECX,dword ptr [0x00da9894]
00a3f4ad : MOV EDX,dword ptr [ECX]
00a3f4af : MOV EAX,dword ptr [EDX + 0x24c]
00a3f4b5 : CMP byte ptr [EAX + 0x32],0x0
00a3f4b9 : JZ 0x00a3f4ca
00a3f4bb : MOV ECX,dword ptr [EAX + 0x3c]
00a3f4be : MOVZX EDX,byte ptr [EAX + 0x38]
00a3f4c2 : PUSH ECX
00a3f4c3 : PUSH EDX
00a3f4c4 : PUSH EAX
00a3f4c5 : CALL 0x009bdf70
00a3f4ca : MOV EAX,[0x00da9894]
00a3f4cf : MOV ECX,dword ptr [EAX]
00a3f4d1 : MOV ECX,dword ptr [ECX + 0x1fc]
00a3f4d7 : CMP byte ptr [ECX + 0x32],0x0
00a3f4db : JZ 0x00a3f4e4
00a3f4dd : CALL 0x00929210
00a3f4e2 : JMP 0x00a3f4eb
00a3f4e4 : MOV byte ptr [ECX + 0x49dc8],0x1
00a3f4eb : MOV EAX,[0x00da9894]
00a3f4f0 : MOV EDX,dword ptr [EBP + 0xc]
00a3f4f3 : MOV ECX,dword ptr [EAX]
00a3f4f5 : PUSH EDX
00a3f4f6 : MOV EDX,dword ptr [ECX + 0x150]
00a3f4fc : PUSH EDX
00a3f4fd : MOV EAX,EBX
00a3f4ff : CALL 0x0099b060
00a3f504 : MOV ECX,dword ptr [EBP + -0xc]
00a3f507 : MOV dword ptr FS:[0x0],ECX
00a3f50e : POP ECX
00a3f50f : POP EDI
00a3f510 : POP ESI
00a3f511 : POP EBX
00a3f512 : MOV ECX,dword ptr [EBP + -0x10]
00a3f515 : XOR ECX,EBP
00a3f517 : CALL 0x00633e6b
00a3f51c : MOV ESP,EBP
00a3f51e : POP EBP
00a3f51f : RET 0xc

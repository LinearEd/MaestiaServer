PROGRAM  : Maestia.exe
FUNCTION : FUN_006b2ed0
ENTRY    : 006b2ed0
BODY     : [[006b2ed0, 006b3134]]

============================================================
DECOMPILED C CODE
============================================================

int FUN_006b2ed0(int param_1)

{
  char cVar1;
  ushort uVar2;
  char *pcVar3;
  int iVar4;
  int iVar5;
  uint *puVar6;
  int iVar7;
  uint uVar8;
  uint uVar9;
  char *pcVar10;
  char *pcVar11;
  char *pcVar12;
  char *pcVar13;
  uint uVar14;
  int local_20;
  uint local_18;
  ushort local_c;
  
  pcVar3 = *(char **)(param_1 + 0xcc);
  pcVar13 = *(char **)(param_1 + 200);
  iVar7 = *(int *)(param_1 + 0xc);
  iVar4 = 0;
  local_20 = 0;
  pcVar10 = pcVar13 + 4;
  do {
    iVar4 = iVar4 + 1;
    iVar5 = FUN_0068a450(iVar7,iVar4);
    if (iVar5 != 0) {
      return iVar5;
    }
    if (pcVar3 < pcVar10) {
      return 0x15;
    }
    puVar6 = (uint *)(*(int *)(iVar7 + 0x58) + local_20);
    puVar6[3] = 0;
    puVar6[2] = 0;
    *(ushort *)(puVar6 + 1) = CONCAT11(*pcVar13,pcVar13[1]);
    pcVar11 = pcVar13 + 4;
    *puVar6 = (uint)CONCAT11(pcVar13[2],pcVar13[3]);
    uVar2 = (ushort)puVar6[1];
    iVar5 = 2;
    if ((uVar2 & 1) != 0) {
      iVar5 = 4;
    }
    local_c = uVar2 & 8;
    if ((uVar2 & 8) == 0) {
      if ((uVar2 & 0x40) == 0) {
        if ((char)uVar2 < '\0') {
          iVar5 = iVar5 + 8;
        }
      }
      else {
        iVar5 = iVar5 + 4;
      }
    }
    else {
      iVar5 = iVar5 + 2;
    }
    if (pcVar3 < pcVar11 + iVar5) {
      return 0x15;
    }
    if ((uVar2 & 1) == 0) {
      pcVar12 = pcVar13 + 5;
      puVar6[2] = (int)*pcVar11;
      pcVar13 = pcVar13 + 6;
      puVar6[3] = (int)*pcVar12;
      pcVar10 = pcVar10 + 6;
    }
    else {
      puVar6[2] = (int)(short)((short)*pcVar11 << 8) | (uint)(byte)pcVar13[5];
      pcVar10 = pcVar10 + 8;
      puVar6[3] = (int)(short)((short)pcVar13[6] << 8) | (uint)(byte)pcVar13[7];
      pcVar13 = pcVar13 + 8;
    }
    uVar9 = 0;
    uVar14 = 0x10000;
    uVar8 = 0x10000;
    local_18 = 0;
    if (local_c == 0) {
      if ((uVar2 & 0x40) == 0) {
        if (-1 < (char)uVar2) goto LAB_006b30c3;
        uVar8 = (int)(short)((short)*pcVar13 << 8) | (uint)(byte)pcVar13[1];
        local_18 = ((int)(short)((short)pcVar13[4] << 8) | (uint)(byte)pcVar13[5]) * 4;
        pcVar10 = pcVar10 + 4;
        uVar9 = ((int)(short)((short)pcVar13[2] << 8) | (uint)(byte)pcVar13[3]) * 4;
        pcVar11 = pcVar13 + 8;
        cVar1 = pcVar13[6];
      }
      else {
        uVar8 = (int)(short)((short)*pcVar13 << 8) | (uint)(byte)pcVar13[1];
        cVar1 = pcVar13[2];
        pcVar11 = pcVar13 + 4;
      }
      uVar8 = uVar8 * 4;
      pcVar10 = pcVar10 + 4;
      uVar14 = ((int)(short)((short)cVar1 << 8) | (uint)(byte)pcVar11[-1]) * 4;
      pcVar13 = pcVar11;
    }
    else {
      pcVar10 = pcVar10 + 2;
      uVar8 = ((int)(short)((short)*pcVar13 << 8) | (uint)(byte)pcVar13[1]) * 4;
      pcVar13 = pcVar13 + 2;
      uVar14 = uVar8;
    }
LAB_006b30c3:
    puVar6[4] = uVar8;
    puVar6[5] = local_18;
    local_20 = local_20 + 0x20;
    puVar6[6] = uVar9;
    puVar6[7] = uVar14;
    if ((uVar2 & 0x20) == 0) {
      *(int *)(iVar7 + 0x54) = iVar4;
      iVar7 = FUN_00687830(*(undefined4 *)(param_1 + 0x18));
      *(char **)(param_1 + 0xa8) = pcVar13 + (iVar7 - (int)pcVar3);
      *(char **)(param_1 + 200) = pcVar13;
      return 0;
    }
  } while( true );
}



============================================================
DISASSEMBLY
============================================================
006b2ed0 : SUB ESP,0x20
006b2ed3 : MOV EAX,dword ptr [ESP + 0x24]
006b2ed7 : MOV ECX,dword ptr [EAX + 0xcc]
006b2edd : PUSH EBX
006b2ede : PUSH EBP
006b2edf : PUSH ESI
006b2ee0 : MOV ESI,dword ptr [EAX + 0xc8]
006b2ee6 : PUSH EDI
006b2ee7 : MOV EDI,dword ptr [EAX + 0xc]
006b2eea : XOR EBX,EBX
006b2eec : MOV dword ptr [ESP + 0x14],ECX
006b2ef0 : MOV dword ptr [ESP + 0x20],EDI
006b2ef4 : XOR EAX,EAX
006b2ef6 : MOV dword ptr [ESP + 0x10],EBX
006b2efa : LEA EBP,[ESI + 0x4]
006b2efd : LEA ECX,[ECX]
006b2f00 : INC EAX
006b2f01 : PUSH EAX
006b2f02 : PUSH EDI
006b2f03 : MOV dword ptr [ESP + 0x30],EAX
006b2f07 : CALL 0x0068a450
006b2f0c : ADD ESP,0x8
006b2f0f : MOV dword ptr [ESP + 0x2c],EAX
006b2f13 : CMP EAX,EBX
006b2f15 : JNZ 0x006b312d
006b2f1b : CMP EBP,dword ptr [ESP + 0x14]
006b2f1f : JA 0x006b30f1
006b2f25 : MOV EAX,dword ptr [EDI + 0x58]
006b2f28 : ADD EAX,dword ptr [ESP + 0x10]
006b2f2c : ADD ESI,0x2
006b2f2f : MOV dword ptr [EAX + 0xc],EBX
006b2f32 : MOV dword ptr [EAX + 0x8],EBX
006b2f35 : MOVZX EDX,byte ptr [ESI + -0x2]
006b2f39 : MOVZX CX,byte ptr [ESI + -0x1]
006b2f3e : SHL DX,0x8
006b2f42 : OR DX,CX
006b2f45 : MOV word ptr [EAX + 0x4],DX
006b2f49 : MOVZX EDX,byte ptr [ESI]
006b2f4c : ADD ESI,0x2
006b2f4f : SHL DX,0x8
006b2f53 : MOVZX ECX,DX
006b2f56 : MOVZX EDX,byte ptr [ESI + -0x1]
006b2f5a : OR ECX,EDX
006b2f5c : MOV dword ptr [EAX],ECX
006b2f5e : MOVZX ECX,word ptr [EAX + 0x4]
006b2f62 : ADD EBP,0x2
006b2f65 : MOV EDI,ECX
006b2f67 : ADD EBP,0x2
006b2f6a : AND EDI,0x1
006b2f6d : MOV EDX,0x2
006b2f72 : MOV dword ptr [ESP + 0x1c],ECX
006b2f76 : JZ 0x006b2f7d
006b2f78 : MOV EDX,0x4
006b2f7d : MOV EBX,ECX
006b2f7f : AND EBX,0x8
006b2f82 : MOV dword ptr [ESP + 0x24],EBX
006b2f86 : JZ 0x006b2f8d
006b2f88 : ADD EDX,0x2
006b2f8b : JMP 0x006b2f9e
006b2f8d : TEST CL,0x40
006b2f90 : JZ 0x006b2f97
006b2f92 : ADD EDX,0x4
006b2f95 : JMP 0x006b2f9e
006b2f97 : TEST CL,CL
006b2f99 : JNS 0x006b2f9e
006b2f9b : ADD EDX,0x8
006b2f9e : ADD EDX,ESI
006b2fa0 : CMP EDX,dword ptr [ESP + 0x14]
006b2fa4 : JA 0x006b30f1
006b2faa : TEST DI,DI
006b2fad : JZ 0x006b2fe6
006b2faf : MOVSX CX,byte ptr [ESI]
006b2fb3 : ADD ESI,0x2
006b2fb6 : SHL CX,0x8
006b2fba : MOVSX EDX,CX
006b2fbd : MOVZX ECX,byte ptr [ESI + -0x1]
006b2fc1 : OR EDX,ECX
006b2fc3 : ADD ESI,0x2
006b2fc6 : MOV dword ptr [EAX + 0x8],EDX
006b2fc9 : MOVSX DX,byte ptr [ESI + -0x2]
006b2fce : SHL DX,0x8
006b2fd2 : MOVSX ECX,DX
006b2fd5 : MOVZX EDX,byte ptr [ESI + -0x1]
006b2fd9 : ADD EBP,0x2
006b2fdc : ADD EBP,0x2
006b2fdf : OR ECX,EDX
006b2fe1 : MOV dword ptr [EAX + 0xc],ECX
006b2fe4 : JMP 0x006b2ff6
006b2fe6 : MOVSX ECX,byte ptr [ESI]
006b2fe9 : INC ESI
006b2fea : MOV dword ptr [EAX + 0x8],ECX
006b2fed : MOVSX EDX,byte ptr [ESI]
006b2ff0 : INC EBP
006b2ff1 : INC ESI
006b2ff2 : MOV dword ptr [EAX + 0xc],EDX
006b2ff5 : INC EBP
006b2ff6 : XOR EDX,EDX
006b2ff8 : MOV EDI,0x10000
006b2ffd : MOV ECX,EDI
006b2fff : MOV dword ptr [ESP + 0x18],EDX
006b3003 : CMP word ptr [ESP + 0x24],DX
006b3008 : JZ 0x006b302c
006b300a : MOVSX CX,byte ptr [ESI]
006b300e : MOVZX EDI,byte ptr [ESI + 0x1]
006b3012 : ADD ESI,0x2
006b3015 : SHL CX,0x8
006b3019 : MOVSX ECX,CX
006b301c : OR ECX,EDI
006b301e : ADD ECX,ECX
006b3020 : ADD EBP,0x2
006b3023 : ADD ECX,ECX
006b3025 : MOV EDI,ECX
006b3027 : JMP 0x006b30c3
006b302c : MOV BL,byte ptr [ESP + 0x1c]
006b3030 : TEST BL,0x40
006b3033 : JZ 0x006b3052
006b3035 : MOVSX CX,byte ptr [ESI]
006b3039 : MOVZX EDI,byte ptr [ESI + 0x1]
006b303d : ADD ESI,0x2
006b3040 : SHL CX,0x8
006b3044 : MOVSX ECX,CX
006b3047 : OR ECX,EDI
006b3049 : MOVSX DI,byte ptr [ESI]
006b304d : ADD ESI,0x2
006b3050 : JMP 0x006b30a8
006b3052 : TEST BL,BL
006b3054 : JNS 0x006b30c3
006b3056 : MOVSX EDX,byte ptr [ESI]
006b3059 : ADD ESI,0x2
006b305c : MOVZX EDI,byte ptr [ESI + 0x1]
006b3060 : SHL DX,0x8
006b3064 : MOVSX ECX,DX
006b3067 : MOVZX EDX,byte ptr [ESI + -0x1]
006b306b : OR ECX,EDX
006b306d : MOVSX EDX,byte ptr [ESI]
006b3070 : ADD ESI,0x2
006b3073 : MOVZX EBX,byte ptr [ESI + 0x1]
006b3077 : SHL DX,0x8
006b307b : MOVSX EDX,DX
006b307e : OR EDX,EDI
006b3080 : MOVSX EDI,byte ptr [ESI]
006b3083 : ADD ESI,0x2
006b3086 : SHL DI,0x8
006b308a : MOVSX EDI,DI
006b308d : OR EDI,EBX
006b308f : ADD EDI,EDI
006b3091 : ADD EBP,0x2
006b3094 : ADD EDX,EDX
006b3096 : ADD EDI,EDI
006b3098 : ADD EBP,0x2
006b309b : ADD EDX,EDX
006b309d : ADD ESI,0x2
006b30a0 : MOV dword ptr [ESP + 0x18],EDI
006b30a4 : MOVSX EDI,byte ptr [ESI + -0x2]
006b30a8 : MOVZX EBX,byte ptr [ESI + -0x1]
006b30ac : SHL DI,0x8
006b30b0 : MOVSX EDI,DI
006b30b3 : OR EDI,EBX
006b30b5 : ADD ECX,ECX
006b30b7 : ADD EBP,0x2
006b30ba : ADD EDI,EDI
006b30bc : ADD ECX,ECX
006b30be : ADD EBP,0x2
006b30c1 : ADD EDI,EDI
006b30c3 : MOV dword ptr [EAX + 0x10],ECX
006b30c6 : MOV ECX,dword ptr [ESP + 0x18]
006b30ca : MOV dword ptr [EAX + 0x14],ECX
006b30cd : MOV ECX,0x20
006b30d2 : ADD dword ptr [ESP + 0x10],ECX
006b30d6 : MOV dword ptr [EAX + 0x18],EDX
006b30d9 : MOV dword ptr [EAX + 0x1c],EDI
006b30dc : MOV EAX,dword ptr [ESP + 0x28]
006b30e0 : TEST byte ptr [ESP + 0x1c],CL
006b30e4 : JZ 0x006b30fe
006b30e6 : MOV EDI,dword ptr [ESP + 0x20]
006b30ea : XOR EBX,EBX
006b30ec : JMP 0x006b2f00
006b30f1 : POP EDI
006b30f2 : POP ESI
006b30f3 : POP EBP
006b30f4 : MOV EAX,0x15
006b30f9 : POP EBX
006b30fa : ADD ESP,0x20
006b30fd : RET
006b30fe : MOV EDX,dword ptr [ESP + 0x20]
006b3102 : MOV EDI,dword ptr [ESP + 0x34]
006b3106 : MOV dword ptr [EDX + 0x54],EAX
006b3109 : MOV EAX,dword ptr [EDI + 0x18]
006b310c : PUSH EAX
006b310d : CALL 0x00687830
006b3112 : MOV ECX,ESI
006b3114 : SUB ECX,dword ptr [ESP + 0x18]
006b3118 : ADD ESP,0x4
006b311b : ADD EAX,ECX
006b311d : MOV dword ptr [EDI + 0xa8],EAX
006b3123 : MOV EAX,dword ptr [ESP + 0x2c]
006b3127 : MOV dword ptr [EDI + 0xc8],ESI
006b312d : POP EDI
006b312e : POP ESI
006b312f : POP EBP
006b3130 : POP EBX
006b3131 : ADD ESP,0x20
006b3134 : RET

PROGRAM  : Maestia.exe
FUNCTION : __Getmonths_l
ENTRY    : 00643cbe
BODY     : [[00643cbe, 00643d5d] [00643d61, 00643d91] [00643d95, 00643dbd]]

============================================================
DECOMPILED C CODE
============================================================

/* Library Function - Single Match
    __Getmonths_l
   
   Library: Visual Studio 2008 Release */

char * __Getmonths_l(localeinfo_struct *param_1)

{
  int iVar1;
  size_t sVar2;
  char *pcVar3;
  errno_t eVar4;
  int iVar5;
  undefined4 *puVar6;
  int local_20 [2];
  int local_18;
  char local_14;
  size_t local_10;
  int local_c;
  char *local_8;
  
  iVar5 = 0;
  _LocaleUpdate::_LocaleUpdate((_LocaleUpdate *)local_20,param_1);
  iVar1 = *(int *)(local_20[0] + 0xd4);
  puVar6 = (undefined4 *)(iVar1 + 0x38);
  local_c = 0xc;
  do {
    local_8 = (char *)puVar6;
    local_10 = _strlen((char *)puVar6[0xc]);
    sVar2 = _strlen((char *)*puVar6);
    puVar6 = (undefined4 *)((int)local_8 + 4);
    local_c = local_c + -1;
    iVar5 = sVar2 + iVar5 + 2 + local_10;
  } while (local_c != 0);
  local_8 = (char *)puVar6;
  pcVar3 = __malloc_crt(iVar5 + 1);
  local_8 = pcVar3;
  if (pcVar3 != (char *)0x0) {
    puVar6 = (undefined4 *)(iVar1 + 0x68);
    local_c = 0xc;
    do {
      *pcVar3 = ':';
      pcVar3 = pcVar3 + 1;
      eVar4 = _strcpy_s(pcVar3,(rsize_t)(local_8 + iVar5 + (1 - (int)pcVar3)),(char *)puVar6[-0xc]);
      if (eVar4 != 0) {
                    /* WARNING: Subroutine does not return */
        __invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
      }
      sVar2 = _strlen(pcVar3);
      pcVar3[sVar2] = ':';
      pcVar3 = pcVar3 + sVar2 + 1;
      eVar4 = _strcpy_s(pcVar3,(rsize_t)(local_8 + iVar5 + (1 - (int)pcVar3)),(char *)*puVar6);
      if (eVar4 != 0) {
                    /* WARNING: Subroutine does not return */
        __invoke_watson((wchar_t *)0x0,(wchar_t *)0x0,(wchar_t *)0x0,0,0);
      }
      sVar2 = _strlen(pcVar3);
      pcVar3 = pcVar3 + sVar2;
      puVar6 = puVar6 + 1;
      local_c = local_c + -1;
    } while (local_c != 0);
    *pcVar3 = '\0';
  }
  if (local_14 != '\0') {
    *(uint *)(local_18 + 0x70) = *(uint *)(local_18 + 0x70) & 0xfffffffd;
  }
  return local_8;
}



============================================================
DISASSEMBLY
============================================================
00643cbe : MOV EDI,EDI
00643cc0 : PUSH EBP
00643cc1 : MOV EBP,ESP
00643cc3 : SUB ESP,0x1c
00643cc6 : PUSH EBX
00643cc7 : PUSH ESI
00643cc8 : PUSH EDI
00643cc9 : PUSH dword ptr [EBP + 0x8]
00643ccc : LEA ECX,[EBP + -0x1c]
00643ccf : XOR EBX,EBX
00643cd1 : CALL 0x00637880
00643cd6 : MOV EAX,dword ptr [EBP + -0x1c]
00643cd9 : MOV EDI,dword ptr [EAX + 0xd4]
00643cdf : LEA ESI,[EDI + 0x38]
00643ce2 : MOV dword ptr [EBP + -0x4],ESI
00643ce5 : MOV dword ptr [EBP + -0x8],0xc
00643cec : PUSH dword ptr [ESI + 0x30]
00643cef : CALL 0x00640960
00643cf4 : PUSH dword ptr [ESI]
00643cf6 : MOV dword ptr [EBP + -0xc],EAX
00643cf9 : CALL 0x00640960
00643cfe : MOV ESI,dword ptr [EBP + -0x4]
00643d01 : POP ECX
00643d02 : POP ECX
00643d03 : MOV ECX,dword ptr [EBP + -0xc]
00643d06 : ADD EAX,EBX
00643d08 : ADD ESI,0x4
00643d0b : DEC dword ptr [EBP + -0x8]
00643d0e : LEA EBX,[EAX + ECX*0x1 + 0x2]
00643d12 : MOV dword ptr [EBP + -0x4],ESI
00643d15 : JNZ 0x00643cec
00643d17 : LEA EAX,[EBX + 0x1]
00643d1a : PUSH EAX
00643d1b : CALL 0x0064255f
00643d20 : MOV ESI,EAX
00643d22 : POP ECX
00643d23 : MOV dword ptr [EBP + -0x4],ESI
00643d26 : TEST ESI,ESI
00643d28 : JZ 0x00643da9
00643d2a : ADD EDI,0x68
00643d2d : MOV dword ptr [EBP + -0x8],0xc
00643d34 : MOV EAX,dword ptr [EBP + -0x4]
00643d37 : MOV byte ptr [ESI],0x3a
00643d3a : PUSH dword ptr [EDI + -0x30]
00643d3d : INC ESI
00643d3e : SUB EAX,ESI
00643d40 : LEA EAX,[EAX + EBX*0x1 + 0x1]
00643d44 : PUSH EAX
00643d45 : PUSH ESI
00643d46 : CALL 0x00638300
00643d4b : ADD ESP,0xc
00643d4e : TEST EAX,EAX
00643d50 : JZ 0x00643d61
00643d52 : XOR EAX,EAX
00643d54 : PUSH EAX
00643d55 : PUSH EAX
00643d56 : PUSH EAX
00643d57 : PUSH EAX
00643d58 : PUSH EAX
00643d59 : CALL 0x00637169
00643d61 : PUSH ESI
00643d62 : CALL 0x00640960
00643d67 : ADD ESI,EAX
00643d69 : MOV EAX,dword ptr [EBP + -0x4]
00643d6c : MOV byte ptr [ESI],0x3a
00643d6f : PUSH dword ptr [EDI]
00643d71 : INC ESI
00643d72 : SUB EAX,ESI
00643d74 : LEA EAX,[EAX + EBX*0x1 + 0x1]
00643d78 : PUSH EAX
00643d79 : PUSH ESI
00643d7a : CALL 0x00638300
00643d7f : ADD ESP,0x10
00643d82 : TEST EAX,EAX
00643d84 : JZ 0x00643d95
00643d86 : XOR EAX,EAX
00643d88 : PUSH EAX
00643d89 : PUSH EAX
00643d8a : PUSH EAX
00643d8b : PUSH EAX
00643d8c : PUSH EAX
00643d8d : CALL 0x00637169
00643d95 : PUSH ESI
00643d96 : CALL 0x00640960
00643d9b : ADD ESI,EAX
00643d9d : ADD EDI,0x4
00643da0 : DEC dword ptr [EBP + -0x8]
00643da3 : POP ECX
00643da4 : JNZ 0x00643d34
00643da6 : MOV byte ptr [ESI],0x0
00643da9 : CMP byte ptr [EBP + -0x10],0x0
00643dad : POP EDI
00643dae : POP ESI
00643daf : POP EBX
00643db0 : JZ 0x00643db9
00643db2 : MOV EAX,dword ptr [EBP + -0x14]
00643db5 : AND dword ptr [EAX + 0x70],0xfffffffd
00643db9 : MOV EAX,dword ptr [EBP + -0x4]
00643dbc : LEAVE
00643dbd : RET

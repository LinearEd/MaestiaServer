PROGRAM  : Maestia.exe
FUNCTION : FUN_007087a0
ENTRY    : 007087a0
BODY     : [[007087a0, 007087b9] [007087c0, 0070881c] [00708820, 007088a1]]

============================================================
DECOMPILED C CODE
============================================================

/* WARNING: Removing unreachable block (ram,0x00708852) */

void FUN_007087a0(undefined4 param_1)

{
  byte *pbVar1;
  int iVar2;
  int iVar3;
  byte bVar4;
  int *in_ECX;
  uint uVar5;
  
  FUN_00707fd0(param_1);
  uVar5 = 0;
  *(undefined2 *)(in_ECX + 0xc) = 0;
  iVar3 = 0;
  do {
    pbVar1 = (byte *)(iVar3 + in_ECX[3]);
    bVar4 = (byte)uVar5;
    uVar5 = uVar5 + 8;
    iVar3 = iVar3 + 1;
    *(ushort *)(in_ECX + 0xc) = *(ushort *)(in_ECX + 0xc) | (ushort)*pbVar1 << (bVar4 & 0x1f);
  } while (uVar5 < 0x10);
  iVar3 = 0;
  *(undefined2 *)((int)in_ECX + 0x32) = 0;
  uVar5 = 0;
  do {
    iVar2 = iVar3 + 2;
    bVar4 = (byte)uVar5;
    uVar5 = uVar5 + 8;
    iVar3 = iVar3 + 1;
    *(ushort *)((int)in_ECX + 0x32) =
         *(ushort *)((int)in_ECX + 0x32) | (ushort)*(byte *)(iVar2 + in_ECX[3]) << (bVar4 & 0x1f);
  } while (uVar5 < 0x10);
  *(undefined1 *)(in_ECX + 0xd) = 0;
  *(undefined1 *)(in_ECX + 0xd) = *(undefined1 *)(in_ECX[3] + 4);
  *(undefined1 *)((int)in_ECX + 0x35) = 0;
  uVar5 = 0;
  *(undefined1 *)((int)in_ECX + 0x35) = *(undefined1 *)(in_ECX[3] + 5);
  *(undefined2 *)((int)in_ECX + 0x36) = 0;
  iVar3 = 0;
  do {
    iVar2 = iVar3 + 6;
    bVar4 = (byte)uVar5;
    uVar5 = uVar5 + 8;
    iVar3 = iVar3 + 1;
    *(ushort *)((int)in_ECX + 0x36) =
         *(ushort *)((int)in_ECX + 0x36) | (ushort)*(byte *)(iVar2 + in_ECX[3]) << (bVar4 & 0x1f);
  } while (uVar5 < 0x10);
  if (in_ECX[0xf] != in_ECX[0x10]) {
    in_ECX[0x10] = in_ECX[0xf];
  }
  FUN_004d0ff0();
  iVar3 = in_ECX[6];
  iVar2 = in_ECX[0xf];
  uVar5 = 0;
  if (iVar3 != 8) {
    do {
      *(undefined1 *)(uVar5 + iVar2) = 0;
      *(undefined1 *)(uVar5 + iVar2) = *(undefined1 *)(uVar5 + 8 + in_ECX[3]);
      uVar5 = uVar5 + 1;
    } while (uVar5 < iVar3 - 8U);
  }
  (**(code **)(*in_ECX + 0x10))();
  return;
}



============================================================
DISASSEMBLY
============================================================
007087a0 : PUSH EBP
007087a1 : MOV EBP,ESP
007087a3 : MOV EAX,dword ptr [EBP + 0x8]
007087a6 : PUSH ESI
007087a7 : PUSH EDI
007087a8 : PUSH EAX
007087a9 : MOV ESI,ECX
007087ab : CALL 0x00707fd0
007087b0 : XOR ECX,ECX
007087b2 : MOV word ptr [ESI + 0x30],CX
007087b6 : XOR EAX,EAX
007087b8 : JMP 0x007087c0
007087c0 : MOV EDX,dword ptr [ESI + 0xc]
007087c3 : MOVZX DX,byte ptr [EAX + EDX*0x1]
007087c8 : SHL DX,CL
007087cb : ADD ECX,0x8
007087ce : INC EAX
007087cf : OR word ptr [ESI + 0x30],DX
007087d3 : CMP ECX,0x10
007087d6 : JC 0x007087c0
007087d8 : XOR EAX,EAX
007087da : MOV word ptr [ESI + 0x32],AX
007087de : XOR ECX,ECX
007087e0 : MOV EDX,dword ptr [ESI + 0xc]
007087e3 : MOVZX DX,byte ptr [EAX + EDX*0x1 + 0x2]
007087e9 : SHL DX,CL
007087ec : ADD ECX,0x8
007087ef : INC EAX
007087f0 : OR word ptr [ESI + 0x32],DX
007087f4 : CMP ECX,0x10
007087f7 : JC 0x007087e0
007087f9 : MOV byte ptr [ESI + 0x34],0x0
007087fd : MOV EAX,dword ptr [ESI + 0xc]
00708800 : MOV CL,byte ptr [EAX + 0x4]
00708803 : MOV byte ptr [ESI + 0x34],CL
00708806 : MOV byte ptr [ESI + 0x35],0x0
0070880a : MOV EDX,dword ptr [ESI + 0xc]
0070880d : MOV AL,byte ptr [EDX + 0x5]
00708810 : XOR ECX,ECX
00708812 : MOV byte ptr [ESI + 0x35],AL
00708815 : MOV word ptr [ESI + 0x36],CX
00708819 : XOR EAX,EAX
0070881b : JMP 0x00708820
00708820 : MOV EDX,dword ptr [ESI + 0xc]
00708823 : MOVZX DX,byte ptr [EAX + EDX*0x1 + 0x6]
00708829 : SHL DX,CL
0070882c : ADD ECX,0x8
0070882f : INC EAX
00708830 : OR word ptr [ESI + 0x36],DX
00708834 : CMP ECX,0x10
00708837 : JC 0x00708820
00708839 : MOV EDX,dword ptr [ESI + 0x3c]
0070883c : MOV ECX,dword ptr [ESI + 0x40]
0070883f : LEA EDI,[ESI + 0x38]
00708842 : CMP EDX,ECX
00708844 : JZ 0x00708862
00708846 : MOV EAX,ECX
00708848 : SUB EAX,ECX
0070884a : PUSH EBX
0070884b : LEA EBX,[EAX + EDX*0x1]
0070884e : TEST EAX,EAX
00708850 : JLE 0x0070885e
00708852 : PUSH EAX
00708853 : PUSH ECX
00708854 : PUSH EAX
00708855 : PUSH EDX
00708856 : CALL 0x00634101
0070885b : ADD ESP,0x10
0070885e : MOV dword ptr [EDI + 0x8],EBX
00708861 : POP EBX
00708862 : MOV EAX,dword ptr [ESI + 0x18]
00708865 : SUB EAX,0x8
00708868 : CALL 0x004d0ff0
0070886d : MOV ECX,dword ptr [ESI + 0x18]
00708870 : SUB ECX,0x8
00708873 : MOV EDI,dword ptr [ESI + 0x3c]
00708876 : MOV EAX,0x0
0070887b : JZ 0x00708893
0070887d : LEA ECX,[ECX]
00708880 : MOV byte ptr [EAX + EDI*0x1],0x0
00708884 : MOV EDX,dword ptr [ESI + 0xc]
00708887 : MOV DL,byte ptr [EAX + EDX*0x1 + 0x8]
0070888b : MOV byte ptr [EAX + EDI*0x1],DL
0070888e : INC EAX
0070888f : CMP EAX,ECX
00708891 : JC 0x00708880
00708893 : MOV EAX,dword ptr [ESI]
00708895 : MOV EDX,dword ptr [EAX + 0x10]
00708898 : MOV ECX,ESI
0070889a : CALL EDX
0070889c : POP EDI
0070889d : POP ESI
0070889e : POP EBP
0070889f : RET 0x4

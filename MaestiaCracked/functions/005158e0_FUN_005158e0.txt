PROGRAM  : Maestia.exe
FUNCTION : FUN_005158e0
ENTRY    : 005158e0
BODY     : [[005158e0, 00515988]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_005158e0(undefined4 *param_1)

{
  undefined4 *in_ECX;
  uint unaff_EBX;
  undefined4 local_18;
  int local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  undefined4 local_4;
  
  *in_ECX = &PTR_LAB_00b870c4;
  FUN_005a9d50();
  in_ECX[0x28] = param_1;
  in_ECX[0x29] = param_1;
  in_ECX[0x2a] = 0x1000;
  in_ECX[0x2b] = 1;
  in_ECX[0x2c] = 0;
  local_18 = 0;
  local_14 = 0;
  local_10 = 0;
  local_c = 0;
  local_8 = 0;
  local_4 = 0;
  (**(code **)*param_1)(&local_18);
  if (local_14 != 0) {
    FUN_005a9d70(param_1);
    in_ECX[0x29] = in_ECX + 1;
    in_ECX[0x2a] = local_14;
  }
  if ((uint)in_ECX[0x2b] < unaff_EBX) {
    in_ECX[0x2b] = unaff_EBX;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
005158e0 : SUB ESP,0x18
005158e3 : PUSH EBX
005158e4 : PUSH ESI
005158e5 : MOV ESI,ECX
005158e7 : LEA EBX,[ESI + 0x4]
005158ea : PUSH EDI
005158eb : MOV ECX,EBX
005158ed : MOV dword ptr [ESI],0xb870c4
005158f3 : CALL 0x005a9d50
005158f8 : MOV EDI,dword ptr [ESP + 0x28]
005158fc : XOR EAX,EAX
005158fe : MOV dword ptr [ESI + 0xa0],EDI
00515904 : MOV dword ptr [ESI + 0xa4],EDI
0051590a : MOV dword ptr [ESI + 0xa8],0x1000
00515914 : MOV dword ptr [ESI + 0xac],0x1
0051591e : MOV dword ptr [ESI + 0xb0],0x0
00515928 : MOV dword ptr [ESP + 0xc],EAX
0051592c : MOV dword ptr [ESP + 0x10],EAX
00515930 : MOV dword ptr [ESP + 0x14],EAX
00515934 : MOV dword ptr [ESP + 0x18],EAX
00515938 : MOV dword ptr [ESP + 0x1c],EAX
0051593c : MOV dword ptr [ESP + 0x20],EAX
00515940 : MOV EAX,dword ptr [EDI]
00515942 : MOV EDX,dword ptr [EAX]
00515944 : LEA ECX,[ESP + 0xc]
00515948 : PUSH ECX
00515949 : MOV ECX,EDI
0051594b : CALL EDX
0051594d : CMP dword ptr [ESP + 0x14],0x0
00515952 : JZ 0x0051596c
00515954 : PUSH EDI
00515955 : MOV ECX,EBX
00515957 : CALL 0x005a9d70
0051595c : MOV EAX,dword ptr [ESP + 0x14]
00515960 : MOV dword ptr [ESI + 0xa4],EBX
00515966 : MOV dword ptr [ESI + 0xa8],EAX
0051596c : MOV EAX,dword ptr [ESP + 0xc]
00515970 : CMP dword ptr [ESI + 0xac],EAX
00515976 : JNC 0x0051597e
00515978 : MOV dword ptr [ESI + 0xac],EAX
0051597e : POP EDI
0051597f : MOV EAX,ESI
00515981 : POP ESI
00515982 : POP EBX
00515983 : ADD ESP,0x18
00515986 : RET 0x4

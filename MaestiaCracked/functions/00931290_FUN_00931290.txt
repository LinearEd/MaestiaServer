PROGRAM  : Maestia.exe
FUNCTION : FUN_00931290
ENTRY    : 00931290
BODY     : [[00931290, 00931358] [00931360, 009313df]]

============================================================
DECOMPILED C CODE
============================================================

undefined4 * FUN_00931290(undefined4 *param_1,undefined4 param_2)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  undefined8 *puVar4;
  int iVar5;
  int *piVar6;
  int iVar7;
  void *local_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_00b3fcef;
  local_10 = ExceptionList;
  uVar3 = DAT_00d66fa0 ^ (uint)&stack0xfffffffc;
  ExceptionList = &local_10;
  FUN_008f7400(param_1);
  iVar7 = 0;
  local_8 = 0;
  *param_1 = &PTR_LAB_00cce5f8;
  FUN_004357d0(param_1 + 0xe);
  local_8._0_1_ = 1;
  param_1[0x11] = param_2;
  uVar2 = DAT_01725270;
  *(undefined2 *)(param_1 + 0x17) = 0;
  param_1[0x12] = 0;
  *(undefined2 *)((int)param_1 + 0x5e) = 0;
  *(undefined1 *)(param_1 + 0x18) = 0;
  param_1[0x19] = 0;
  param_1[0x13] = 0;
  param_1[0x14] = 0;
  param_1[0x15] = 0;
  param_1[0x16] = 0;
  puVar4 = (undefined8 *)FUN_006f0760(0x1a,"",0,(uVar2 >> 3 & 1) == 0,uVar3);
  param_1[0x1c] = puVar4;
  *puVar4 = 0;
  puVar4[1] = 0;
  puVar4[2] = 0;
  *(undefined2 *)(puVar4 + 3) = 0;
  *(undefined1 *)(param_1[0x1c] + 9) = 1;
  *(undefined1 *)(param_1[0x1c] + 8) = 1;
  *(undefined1 *)(param_1[0x1c] + 0x18) = 0x32;
  *(undefined1 *)(param_1[0x1c] + 0x17) = 0x32;
  piVar6 = param_1 + 0x1a;
  do {
    iVar5 = FUN_006f0760(0x104,"",0,(DAT_01725270 >> 3 & 1) == 0,uVar3);
    local_8._0_1_ = 2;
    if (iVar5 == 0) {
      iVar5 = 0;
    }
    else {
      iVar5 = FUN_00908da0(iVar5);
    }
    local_8._0_1_ = 1;
    *piVar6 = iVar5;
    *(undefined4 *)(iVar5 + 0x18) = 0x80;
    iVar1 = *piVar6;
    iVar5 = iVar7 + 0x1e;
    iVar7 = iVar7 + 1;
    piVar6 = piVar6 + 1;
    *(int *)(iVar1 + 0x10) = iVar5;
  } while (iVar7 < 2);
  param_1[0x1d] = 1;
  ExceptionList = local_10;
  return param_1;
}



============================================================
DISASSEMBLY
============================================================
00931290 : PUSH EBP
00931291 : MOV EBP,ESP
00931293 : PUSH -0x1
00931295 : PUSH 0xb3fcef
0093129a : MOV EAX,FS:[0x0]
009312a0 : PUSH EAX
009312a1 : PUSH EBX
009312a2 : PUSH ESI
009312a3 : PUSH EDI
009312a4 : MOV EAX,[0x00d66fa0]
009312a9 : XOR EAX,EBP
009312ab : PUSH EAX
009312ac : LEA EAX,[EBP + -0xc]
009312af : MOV FS:[0x0],EAX
009312b5 : MOV ESI,dword ptr [EBP + 0x8]
009312b8 : PUSH ESI
009312b9 : CALL 0x008f7400
009312be : XOR EDI,EDI
009312c0 : MOV dword ptr [EBP + -0x4],EDI
009312c3 : LEA EAX,[ESI + 0x38]
009312c6 : PUSH EAX
009312c7 : MOV dword ptr [ESI],0xcce5f8
009312cd : CALL 0x004357d0
009312d2 : MOV byte ptr [EBP + -0x4],0x1
009312d6 : MOV ECX,dword ptr [EBP + 0xc]
009312d9 : MOV dword ptr [ESI + 0x44],ECX
009312dc : MOV ECX,dword ptr [0x01725270]
009312e2 : XOR EDX,EDX
009312e4 : MOV word ptr [ESI + 0x5c],DX
009312e8 : XOR EAX,EAX
009312ea : SHR ECX,0x3
009312ed : MOV EDX,EAX
009312ef : AND ECX,0x1
009312f2 : SETZ DL
009312f5 : MOV dword ptr [ESI + 0x48],EDI
009312f8 : MOV word ptr [ESI + 0x5e],AX
009312fc : MOV byte ptr [ESI + 0x60],AL
009312ff : MOV dword ptr [ESI + 0x64],EDI
00931302 : MOV dword ptr [ESI + 0x4c],EDI
00931305 : MOV dword ptr [ESI + 0x50],EDI
00931308 : PUSH EDX
00931309 : PUSH EDI
0093130a : PUSH 0xbf1a4b
0093130f : MOV dword ptr [ESI + 0x54],EDI
00931312 : PUSH 0x1a
00931314 : MOV dword ptr [ESI + 0x58],EDI
00931317 : CALL 0x006f0760
0093131c : MOV dword ptr [ESI + 0x70],EAX
0093131f : PXOR XMM0,XMM0
00931323 : MOVQ qword ptr [EAX],XMM0
00931327 : MOVQ qword ptr [EAX + 0x8],XMM0
0093132c : MOVQ qword ptr [EAX + 0x10],XMM0
00931331 : MOV word ptr [EAX + 0x18],DI
00931335 : MOV EAX,dword ptr [ESI + 0x70]
00931338 : MOV byte ptr [EAX + 0x9],0x1
0093133c : MOV ECX,dword ptr [ESI + 0x70]
0093133f : MOV byte ptr [ECX + 0x8],0x1
00931343 : MOV EDX,dword ptr [ESI + 0x70]
00931346 : MOV AL,0x32
00931348 : MOV byte ptr [EDX + 0x18],AL
0093134b : MOV ECX,dword ptr [ESI + 0x70]
0093134e : ADD ESP,0x10
00931351 : MOV byte ptr [ECX + 0x17],AL
00931354 : LEA EBX,[ESI + 0x68]
00931357 : JMP 0x00931360
00931360 : MOV EDX,dword ptr [0x01725270]
00931366 : SHR EDX,0x3
00931369 : MOV EAX,0x0
0093136e : AND EDX,0x1
00931371 : SETZ AL
00931374 : PUSH EAX
00931375 : PUSH 0x0
00931377 : PUSH 0xbf1a4a
0093137c : PUSH 0x104
00931381 : CALL 0x006f0760
00931386 : ADD ESP,0x10
00931389 : MOV dword ptr [EBP + 0xc],EAX
0093138c : MOV byte ptr [EBP + -0x4],0x2
00931390 : TEST EAX,EAX
00931392 : JZ 0x0093139c
00931394 : PUSH EAX
00931395 : CALL 0x00908da0
0093139a : JMP 0x0093139e
0093139c : XOR EAX,EAX
0093139e : MOV byte ptr [EBP + -0x4],0x1
009313a2 : MOV dword ptr [EBX],EAX
009313a4 : MOV dword ptr [EAX + 0x18],0x80
009313ab : MOV EAX,dword ptr [EBX]
009313ad : LEA ECX,[EDI + 0x1e]
009313b0 : INC EDI
009313b1 : ADD EBX,0x4
009313b4 : CMP EDI,0x2
009313b7 : MOV dword ptr [EAX + 0x10],ECX
009313ba : JL 0x00931360
009313bc : MOV dword ptr [ESI + 0x74],0x1
009313c3 : MOV dword ptr [EBP + -0x4],0xffffffff
009313ca : MOV EAX,ESI
009313cc : MOV ECX,dword ptr [EBP + -0xc]
009313cf : MOV dword ptr FS:[0x0],ECX
009313d6 : POP ECX
009313d7 : POP EDI
009313d8 : POP ESI
009313d9 : POP EBX
009313da : MOV ESP,EBP
009313dc : POP EBP
009313dd : RET 0x8

PROGRAM  : Maestia.exe
FUNCTION : FUN_006b6370
ENTRY    : 006b6370
BODY     : [[006b6370, 006b6593]]

============================================================
DECOMPILED C CODE
============================================================

void FUN_006b6370(void)

{
  ushort uVar1;
  int iVar2;
  int iVar3;
  ushort *in_EAX;
  int iVar4;
  int unaff_ESI;
  
  uVar1 = *in_EAX;
  if (((uVar1 < *(ushort *)(unaff_ESI + 0x50)) &&
      (*(int *)(in_EAX + 2) + 1U < *(int *)(unaff_ESI + 0x17c) + 1U)) &&
     (*(ushort *)(unaff_ESI + 0x11c) < *(ushort *)(unaff_ESI + 0x2c))) {
    if (*(int *)(in_EAX + 2) != -1) {
      (**(code **)(unaff_ESI + 0x250))();
    }
    if (*(short *)(unaff_ESI + 0x15a) == 0) {
      iVar3 = (uint)uVar1 * 8;
      iVar4 = FUN_006b3f10();
      *(int *)(iVar3 + *(int *)(unaff_ESI + 0x54)) =
           iVar4 + *(int *)(*(int *)(unaff_ESI + 0x30) + (uint)*(ushort *)(unaff_ESI + 0x11c) * 8);
      iVar4 = FUN_006b3f10();
      *(int *)(*(int *)(unaff_ESI + 0x54) + 4 + iVar3) =
           iVar4 + *(int *)(*(int *)(unaff_ESI + 0x30) + 4 +
                           (uint)*(ushort *)(unaff_ESI + 0x11c) * 8);
      iVar4 = *(int *)(unaff_ESI + 0x34);
      iVar2 = *(int *)(unaff_ESI + 0x58);
      *(undefined4 *)(iVar2 + iVar3) = *(undefined4 *)(iVar4 + iVar3);
      *(undefined4 *)(iVar2 + 4 + iVar3) = *(undefined4 *)(iVar4 + 4 + iVar3);
    }
    (**(code **)(unaff_ESI + 0x240))();
    (**(code **)(unaff_ESI + 0x23c))();
    if ((*(byte *)(unaff_ESI + 0x170) & 4) == 0) {
      FUN_006b4420();
    }
    else {
      (**(code **)(unaff_ESI + 0x238))();
    }
    (**(code **)(unaff_ESI + 0x248))();
    *(undefined2 *)(unaff_ESI + 0x11e) = *(undefined2 *)(unaff_ESI + 0x11c);
    if ((*(byte *)(unaff_ESI + 0x170) & 0x10) != 0) {
      *(ushort *)(unaff_ESI + 0x11c) = uVar1;
    }
    *(ushort *)(unaff_ESI + 0x120) = uVar1;
    return;
  }
  if (*(char *)(unaff_ESI + 0x231) != '\0') {
    *(undefined4 *)(unaff_ESI + 0xc) = 0x86;
  }
  return;
}



============================================================
DISASSEMBLY
============================================================
006b6370 : PUSH ECX
006b6371 : PUSH EBP
006b6372 : MOVZX EBP,word ptr [EAX]
006b6375 : MOV EAX,dword ptr [EAX + 0x4]
006b6378 : INC EAX
006b6379 : MOV dword ptr [ESP + 0x4],EBP
006b637d : CMP BP,word ptr [ESI + 0x50]
006b6381 : JNC 0x006b6581
006b6387 : MOV ECX,dword ptr [ESI + 0x17c]
006b638d : INC ECX
006b638e : CMP EAX,ECX
006b6390 : JNC 0x006b6581
006b6396 : MOV DX,word ptr [ESI + 0x11c]
006b639d : CMP DX,word ptr [ESI + 0x2c]
006b63a1 : JNC 0x006b6581
006b63a7 : PUSH EBX
006b63a8 : PUSH EDI
006b63a9 : TEST EAX,EAX
006b63ab : JNZ 0x006b63b1
006b63ad : XOR EBX,EBX
006b63af : JMP 0x006b63c1
006b63b1 : DEC EAX
006b63b2 : PUSH EAX
006b63b3 : MOV EAX,dword ptr [ESI + 0x250]
006b63b9 : PUSH ESI
006b63ba : CALL EAX
006b63bc : ADD ESP,0x8
006b63bf : MOV EBX,EAX
006b63c1 : MOV EAX,dword ptr [ESI + 0x148]
006b63c7 : MOV ECX,EBX
006b63c9 : SUB ECX,EAX
006b63cb : JNS 0x006b63d1
006b63cd : MOV ECX,EAX
006b63cf : SUB ECX,EBX
006b63d1 : CMP ECX,dword ptr [ESI + 0x144]
006b63d7 : JGE 0x006b63e1
006b63d9 : TEST EBX,EBX
006b63db : JGE 0x006b63df
006b63dd : NEG EAX
006b63df : MOV EBX,EAX
006b63e1 : CMP word ptr [ESI + 0x15a],0x0
006b63e9 : JNZ 0x006b644c
006b63eb : MOVSX EAX,word ptr [ESI + 0x12a]
006b63f2 : MOVZX EDI,BP
006b63f5 : ADD EDI,EDI
006b63f7 : ADD EDI,EDI
006b63f9 : MOV ECX,EBX
006b63fb : ADD EDI,EDI
006b63fd : CALL 0x006b3f10
006b6402 : MOVZX ECX,word ptr [ESI + 0x11c]
006b6409 : MOV EDX,dword ptr [ESI + 0x30]
006b640c : ADD EAX,dword ptr [EDX + ECX*0x8]
006b640f : MOV ECX,dword ptr [ESI + 0x54]
006b6412 : MOV dword ptr [EDI + ECX*0x1],EAX
006b6415 : MOVSX EAX,word ptr [ESI + 0x12c]
006b641c : MOV ECX,EBX
006b641e : CALL 0x006b3f10
006b6423 : MOVZX EDX,word ptr [ESI + 0x11c]
006b642a : MOV ECX,dword ptr [ESI + 0x30]
006b642d : ADD EAX,dword ptr [ECX + EDX*0x8 + 0x4]
006b6431 : MOV EDX,dword ptr [ESI + 0x54]
006b6434 : MOV dword ptr [EDX + EDI*0x1 + 0x4],EAX
006b6438 : MOV EAX,dword ptr [ESI + 0x34]
006b643b : MOV EDX,dword ptr [EAX + EDI*0x1]
006b643e : MOV ECX,dword ptr [ESI + 0x58]
006b6441 : MOV dword ptr [ECX + EDI*0x1],EDX
006b6444 : MOV EAX,dword ptr [EAX + EDI*0x1 + 0x4]
006b6448 : MOV dword ptr [ECX + EDI*0x1 + 0x4],EAX
006b644c : MOVZX ECX,word ptr [ESI + 0x11c]
006b6453 : MOV EDX,dword ptr [ESI + 0x30]
006b6456 : LEA EAX,[EDX + ECX*0x8]
006b6459 : MOV ECX,dword ptr [ESI + 0x54]
006b645c : MOVZX EDI,BP
006b645f : ADD EDI,EDI
006b6461 : ADD EDI,EDI
006b6463 : ADD EDI,EDI
006b6465 : MOV EDX,dword ptr [ECX + EDI*0x1 + 0x4]
006b6469 : SUB EDX,dword ptr [EAX + 0x4]
006b646c : ADD ECX,EDI
006b646e : MOV ECX,dword ptr [ECX]
006b6470 : SUB ECX,dword ptr [EAX]
006b6472 : PUSH EDX
006b6473 : MOV EDX,dword ptr [ESI + 0x240]
006b6479 : PUSH ECX
006b647a : PUSH ESI
006b647b : CALL EDX
006b647d : MOV EDX,dword ptr [ESI + 0x58]
006b6480 : MOV ECX,dword ptr [ESI + 0x34]
006b6483 : MOV EBP,EAX
006b6485 : MOVZX EAX,word ptr [ESI + 0x11c]
006b648c : LEA EAX,[ECX + EAX*0x8]
006b648f : MOV ECX,dword ptr [EDI + EDX*0x1 + 0x4]
006b6493 : SUB ECX,dword ptr [EAX + 0x4]
006b6496 : ADD EDI,EDX
006b6498 : MOV EDX,dword ptr [EDI]
006b649a : SUB EDX,dword ptr [EAX]
006b649c : MOV EAX,dword ptr [ESI + 0x23c]
006b64a2 : PUSH ECX
006b64a3 : PUSH EDX
006b64a4 : PUSH ESI
006b64a5 : CALL EAX
006b64a7 : ADD ESP,0x18
006b64aa : CMP byte ptr [ESI + 0x13c],0x0
006b64b1 : MOV EDI,EAX
006b64b3 : JZ 0x006b64bd
006b64b5 : MOV ECX,EBP
006b64b7 : XOR ECX,EBX
006b64b9 : JGE 0x006b64bd
006b64bb : NEG EBX
006b64bd : MOV CL,byte ptr [ESI + 0x170]
006b64c3 : TEST CL,0x4
006b64c6 : JZ 0x006b6506
006b64c8 : MOV DX,word ptr [ESI + 0x158]
006b64cf : CMP DX,word ptr [ESI + 0x15a]
006b64d6 : JNZ 0x006b64ec
006b64d8 : MOV EAX,EBX
006b64da : SUB EAX,EBP
006b64dc : JNS 0x006b64e2
006b64de : MOV EAX,EBP
006b64e0 : SUB EAX,EBX
006b64e2 : CMP EAX,dword ptr [ESI + 0x140]
006b64e8 : JL 0x006b64ec
006b64ea : MOV EBX,EBP
006b64ec : MOV EDX,dword ptr [ESI + 0x238]
006b64f2 : MOVZX EAX,CL
006b64f5 : AND EAX,0x3
006b64f8 : MOV ECX,dword ptr [ESI + EAX*0x4 + 0x108]
006b64ff : PUSH ECX
006b6500 : PUSH EBX
006b6501 : PUSH ESI
006b6502 : CALL EDX
006b6504 : JMP 0x006b651b
006b6506 : MOVZX EAX,CL
006b6509 : AND EAX,0x3
006b650c : MOV ECX,dword ptr [ESI + EAX*0x4 + 0x108]
006b6513 : PUSH ECX
006b6514 : PUSH EBX
006b6515 : PUSH ESI
006b6516 : CALL 0x006b4420
006b651b : ADD ESP,0xc
006b651e : TEST byte ptr [ESI + 0x170],0x8
006b6525 : JZ 0x006b653f
006b6527 : MOV ECX,dword ptr [ESI + 0x134]
006b652d : TEST EBP,EBP
006b652f : JL 0x006b6537
006b6531 : CMP EAX,ECX
006b6533 : JGE 0x006b653f
006b6535 : JMP 0x006b653d
006b6537 : NEG ECX
006b6539 : CMP EAX,ECX
006b653b : JLE 0x006b653f
006b653d : MOV EAX,ECX
006b653f : SUB EAX,EDI
006b6541 : MOV EDI,dword ptr [ESP + 0xc]
006b6545 : PUSH EAX
006b6546 : MOV EAX,dword ptr [ESI + 0x248]
006b654c : PUSH EDI
006b654d : LEA EDX,[ESI + 0x48]
006b6550 : PUSH EDX
006b6551 : PUSH ESI
006b6552 : CALL EAX
006b6554 : MOV CX,word ptr [ESI + 0x11c]
006b655b : ADD ESP,0x10
006b655e : TEST byte ptr [ESI + 0x170],0x10
006b6565 : MOV word ptr [ESI + 0x11e],CX
006b656c : JZ 0x006b6575
006b656e : MOV word ptr [ESI + 0x11c],DI
006b6575 : MOV word ptr [ESI + 0x120],DI
006b657c : POP EDI
006b657d : POP EBX
006b657e : POP EBP
006b657f : POP ECX
006b6580 : RET
006b6581 : CMP byte ptr [ESI + 0x231],0x0
006b6588 : JZ 0x006b6591
006b658a : MOV dword ptr [ESI + 0xc],0x86
006b6591 : POP EBP
006b6592 : POP ECX
006b6593 : RET
